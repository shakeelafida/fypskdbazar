(()=>{var e={6788:(e,t)=>{var n;t=e.exports=g,n="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var i=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,o=i-6,a=t.re=[],s=t.safeRe=[],u=t.src=[],c=t.tokens={},l=0;function d(e){c[e]=l++}var p="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",i],[p,o]];function h(e){for(var t=0;t<f.length;t++){var n=f[t][0],i=f[t][1];e=e.split(n+"*").join(n+"{0,"+i+"}").split(n+"+").join(n+"{1,"+i+"}")}return e}d("NUMERICIDENTIFIER"),u[c.NUMERICIDENTIFIER]="0|[1-9]\\d*",d("NUMERICIDENTIFIERLOOSE"),u[c.NUMERICIDENTIFIERLOOSE]="\\d+",d("NONNUMERICIDENTIFIER"),u[c.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-]"+p+"*",d("MAINVERSION"),u[c.MAINVERSION]="("+u[c.NUMERICIDENTIFIER]+")\\.("+u[c.NUMERICIDENTIFIER]+")\\.("+u[c.NUMERICIDENTIFIER]+")",d("MAINVERSIONLOOSE"),u[c.MAINVERSIONLOOSE]="("+u[c.NUMERICIDENTIFIERLOOSE]+")\\.("+u[c.NUMERICIDENTIFIERLOOSE]+")\\.("+u[c.NUMERICIDENTIFIERLOOSE]+")",d("PRERELEASEIDENTIFIER"),u[c.PRERELEASEIDENTIFIER]="(?:"+u[c.NUMERICIDENTIFIER]+"|"+u[c.NONNUMERICIDENTIFIER]+")",d("PRERELEASEIDENTIFIERLOOSE"),u[c.PRERELEASEIDENTIFIERLOOSE]="(?:"+u[c.NUMERICIDENTIFIERLOOSE]+"|"+u[c.NONNUMERICIDENTIFIER]+")",d("PRERELEASE"),u[c.PRERELEASE]="(?:-("+u[c.PRERELEASEIDENTIFIER]+"(?:\\."+u[c.PRERELEASEIDENTIFIER]+")*))",d("PRERELEASELOOSE"),u[c.PRERELEASELOOSE]="(?:-?("+u[c.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+u[c.PRERELEASEIDENTIFIERLOOSE]+")*))",d("BUILDIDENTIFIER"),u[c.BUILDIDENTIFIER]=p+"+",d("BUILD"),u[c.BUILD]="(?:\\+("+u[c.BUILDIDENTIFIER]+"(?:\\."+u[c.BUILDIDENTIFIER]+")*))",d("FULL"),d("FULLPLAIN"),u[c.FULLPLAIN]="v?"+u[c.MAINVERSION]+u[c.PRERELEASE]+"?"+u[c.BUILD]+"?",u[c.FULL]="^"+u[c.FULLPLAIN]+"$",d("LOOSEPLAIN"),u[c.LOOSEPLAIN]="[v=\\s]*"+u[c.MAINVERSIONLOOSE]+u[c.PRERELEASELOOSE]+"?"+u[c.BUILD]+"?",d("LOOSE"),u[c.LOOSE]="^"+u[c.LOOSEPLAIN]+"$",d("GTLT"),u[c.GTLT]="((?:<|>)?=?)",d("XRANGEIDENTIFIERLOOSE"),u[c.XRANGEIDENTIFIERLOOSE]=u[c.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",d("XRANGEIDENTIFIER"),u[c.XRANGEIDENTIFIER]=u[c.NUMERICIDENTIFIER]+"|x|X|\\*",d("XRANGEPLAIN"),u[c.XRANGEPLAIN]="[v=\\s]*("+u[c.XRANGEIDENTIFIER]+")(?:\\.("+u[c.XRANGEIDENTIFIER]+")(?:\\.("+u[c.XRANGEIDENTIFIER]+")(?:"+u[c.PRERELEASE]+")?"+u[c.BUILD]+"?)?)?",d("XRANGEPLAINLOOSE"),u[c.XRANGEPLAINLOOSE]="[v=\\s]*("+u[c.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+u[c.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+u[c.XRANGEIDENTIFIERLOOSE]+")(?:"+u[c.PRERELEASELOOSE]+")?"+u[c.BUILD]+"?)?)?",d("XRANGE"),u[c.XRANGE]="^"+u[c.GTLT]+"\\s*"+u[c.XRANGEPLAIN]+"$",d("XRANGELOOSE"),u[c.XRANGELOOSE]="^"+u[c.GTLT]+"\\s*"+u[c.XRANGEPLAINLOOSE]+"$",d("COERCE"),u[c.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",d("COERCERTL"),a[c.COERCERTL]=new RegExp(u[c.COERCE],"g"),s[c.COERCERTL]=new RegExp(h(u[c.COERCE]),"g"),d("LONETILDE"),u[c.LONETILDE]="(?:~>?)",d("TILDETRIM"),u[c.TILDETRIM]="(\\s*)"+u[c.LONETILDE]+"\\s+",a[c.TILDETRIM]=new RegExp(u[c.TILDETRIM],"g"),s[c.TILDETRIM]=new RegExp(h(u[c.TILDETRIM]),"g"),d("TILDE"),u[c.TILDE]="^"+u[c.LONETILDE]+u[c.XRANGEPLAIN]+"$",d("TILDELOOSE"),u[c.TILDELOOSE]="^"+u[c.LONETILDE]+u[c.XRANGEPLAINLOOSE]+"$",d("LONECARET"),u[c.LONECARET]="(?:\\^)",d("CARETTRIM"),u[c.CARETTRIM]="(\\s*)"+u[c.LONECARET]+"\\s+",a[c.CARETTRIM]=new RegExp(u[c.CARETTRIM],"g"),s[c.CARETTRIM]=new RegExp(h(u[c.CARETTRIM]),"g"),d("CARET"),u[c.CARET]="^"+u[c.LONECARET]+u[c.XRANGEPLAIN]+"$",d("CARETLOOSE"),u[c.CARETLOOSE]="^"+u[c.LONECARET]+u[c.XRANGEPLAINLOOSE]+"$",d("COMPARATORLOOSE"),u[c.COMPARATORLOOSE]="^"+u[c.GTLT]+"\\s*("+u[c.LOOSEPLAIN]+")$|^$",d("COMPARATOR"),u[c.COMPARATOR]="^"+u[c.GTLT]+"\\s*("+u[c.FULLPLAIN]+")$|^$",d("COMPARATORTRIM"),u[c.COMPARATORTRIM]="(\\s*)"+u[c.GTLT]+"\\s*("+u[c.LOOSEPLAIN]+"|"+u[c.XRANGEPLAIN]+")",a[c.COMPARATORTRIM]=new RegExp(u[c.COMPARATORTRIM],"g"),s[c.COMPARATORTRIM]=new RegExp(h(u[c.COMPARATORTRIM]),"g"),d("HYPHENRANGE"),u[c.HYPHENRANGE]="^\\s*("+u[c.XRANGEPLAIN]+")\\s+-\\s+("+u[c.XRANGEPLAIN]+")\\s*$",d("HYPHENRANGELOOSE"),u[c.HYPHENRANGELOOSE]="^\\s*("+u[c.XRANGEPLAINLOOSE]+")\\s+-\\s+("+u[c.XRANGEPLAINLOOSE]+")\\s*$",d("STAR"),u[c.STAR]="(<|>)?=?\\s*\\*";for(var v=0;v<l;v++)n(v,u[v]),a[v]||(a[v]=new RegExp(u[v]),s[v]=new RegExp(h(u[v])));function m(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof g)return e;if("string"!=typeof e)return null;if(e.length>i)return null;if(!(t.loose?s[c.LOOSE]:s[c.FULL]).test(e))return null;try{return new g(e,t)}catch(e){return null}}function g(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof g){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof g))return new g(e,t);n("SemVer",e,t),this.options=t,this.loose=!!t.loose;var o=e.trim().match(t.loose?s[c.LOOSE]:s[c.FULL]);if(!o)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}t.parse=m,t.valid=function(e,t){var n=m(e,t);return n?n.version:null},t.clean=function(e,t){var n=m(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=g,g.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},g.prototype.toString=function(){return this.version},g.prototype.compare=function(e){return n("SemVer.compare",this.version,this.options,e),e instanceof g||(e=new g(e,this.options)),this.compareMain(e)||this.comparePre(e)},g.prototype.compareMain=function(e){return e instanceof g||(e=new g(e,this.options)),y(this.major,e.major)||y(this.minor,e.minor)||y(this.patch,e.patch)},g.prototype.comparePre=function(e){if(e instanceof g||(e=new g(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var i=this.prerelease[t],r=e.prerelease[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return y(i,r)}while(++t)},g.prototype.compareBuild=function(e){e instanceof g||(e=new g(e,this.options));var t=0;do{var i=this.build[t],r=e.build[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return y(i,r)}while(++t)},g.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,i){"string"==typeof n&&(i=n,n=void 0);try{return new g(e,n).inc(t,i).version}catch(e){return null}},t.diff=function(e,t){if(A(e,t))return null;var n=m(e),i=m(t),r="";if(n.prerelease.length||i.prerelease.length){r="pre";var o="prerelease"}for(var a in n)if(("major"===a||"minor"===a||"patch"===a)&&n[a]!==i[a])return r+a;return o},t.compareIdentifiers=y;var S=/^[0-9]+$/;function y(e,t){var n=S.test(e),i=S.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1}function E(e,t,n){return new g(e,n).compare(new g(t,n))}function I(e,t,n){return E(e,t,n)>0}function T(e,t,n){return E(e,t,n)<0}function A(e,t,n){return 0===E(e,t,n)}function C(e,t,n){return 0!==E(e,t,n)}function w(e,t,n){return E(e,t,n)>=0}function b(e,t,n){return E(e,t,n)<=0}function R(e,t,n,i){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return A(e,n,i);case"!=":return C(e,n,i);case">":return I(e,n,i);case">=":return w(e,n,i);case"<":return T(e,n,i);case"<=":return b(e,n,i);default:throw new TypeError("Invalid operator: "+t)}}function O(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof O){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof O))return new O(e,t);e=e.trim().split(/\s+/).join(" "),n("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===P?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}t.rcompareIdentifiers=function(e,t){return y(t,e)},t.major=function(e,t){return new g(e,t).major},t.minor=function(e,t){return new g(e,t).minor},t.patch=function(e,t){return new g(e,t).patch},t.compare=E,t.compareLoose=function(e,t){return E(e,t,!0)},t.compareBuild=function(e,t,n){var i=new g(e,n),r=new g(t,n);return i.compare(r)||i.compareBuild(r)},t.rcompare=function(e,t,n){return E(t,e,n)},t.sort=function(e,n){return e.sort((function(e,i){return t.compareBuild(e,i,n)}))},t.rsort=function(e,n){return e.sort((function(e,i){return t.compareBuild(i,e,n)}))},t.gt=I,t.lt=T,t.eq=A,t.neq=C,t.gte=w,t.lte=b,t.cmp=R,t.Comparator=O;var P={};function k(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof k)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new k(e.raw,t);if(e instanceof O)return new k(e.value,t);if(!(this instanceof k))return new k(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}function N(e,t){for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every((function(e){return r.intersects(e,t)})),r=i.pop();return n}function x(e){return!e||"x"===e.toLowerCase()||"*"===e}function D(e,t,n,i,r,o,a,s,u,c,l,d,p){return((t=x(n)?"":x(i)?">="+n+".0.0":x(r)?">="+n+"."+i+".0":">="+t)+" "+(s=x(u)?"":x(c)?"<"+(+u+1)+".0.0":x(l)?"<"+u+"."+(+c+1)+".0":d?"<="+u+"."+c+"."+l+"-"+d:"<="+s)).trim()}function L(e,t,i){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(r=0;r<e.length;r++)if(n(e[r].semver),e[r].semver!==P&&e[r].semver.prerelease.length>0){var o=e[r].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function _(e,t,n){try{t=new k(t,n)}catch(e){return!1}return t.test(e)}function M(e,t,n,i){var r,o,a,s,u;switch(e=new g(e,i),t=new k(t,i),n){case">":r=I,o=b,a=T,s=">",u=">=";break;case"<":r=T,o=w,a=I,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(_(e,t,i))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],d=null,p=null;if(l.forEach((function(e){e.semver===P&&(e=new O(">=0.0.0")),d=d||e,p=p||e,r(e.semver,d.semver,i)?d=e:a(e.semver,p.semver,i)&&(p=e)})),d.operator===s||d.operator===u)return!1;if((!p.operator||p.operator===s)&&o(e,p.semver))return!1;if(p.operator===u&&a(e,p.semver))return!1}return!0}O.prototype.parse=function(e){var t=this.options.loose?s[c.COMPARATORLOOSE]:s[c.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new g(n[2],this.options.loose):this.semver=P},O.prototype.toString=function(){return this.value},O.prototype.test=function(e){if(n("Comparator.test",e,this.options.loose),this.semver===P||e===P)return!0;if("string"==typeof e)try{e=new g(e,this.options)}catch(e){return!1}return R(e,this.operator,this.semver,this.options)},O.prototype.intersects=function(e,t){if(!(e instanceof O))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new k(e.value,t),_(this.value,n,t));if(""===e.operator)return""===e.value||(n=new k(this.value,t),_(e.semver,n,t));var i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=R(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=R(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||r||o&&a||s||u},t.Range=k,k.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},k.prototype.toString=function(){return this.range},k.prototype.parseRange=function(e){var t=this.options.loose,i=t?s[c.HYPHENRANGELOOSE]:s[c.HYPHENRANGE];e=e.replace(i,D),n("hyphen replace",e),e=e.replace(s[c.COMPARATORTRIM],"$1$2$3"),n("comparator trim",e,s[c.COMPARATORTRIM]),e=(e=(e=e.replace(s[c.TILDETRIM],"$1~")).replace(s[c.CARETTRIM],"$1^")).split(/\s+/).join(" ");var r=t?s[c.COMPARATORLOOSE]:s[c.COMPARATOR],o=e.split(" ").map((function(e){return function(e,t){return n("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){n("caret",e,t);var i=t.loose?s[c.CARETLOOSE]:s[c.CARET];return e.replace(i,(function(t,i,r,o,a){var s;return n("caret",e,t,i,r,o,a),x(i)?s="":x(r)?s=">="+i+".0.0 <"+(+i+1)+".0.0":x(o)?s="0"===i?">="+i+"."+r+".0 <"+i+"."+(+r+1)+".0":">="+i+"."+r+".0 <"+(+i+1)+".0.0":a?(n("replaceCaret pr",a),s="0"===i?"0"===r?">="+i+"."+r+"."+o+"-"+a+" <"+i+"."+r+"."+(+o+1):">="+i+"."+r+"."+o+"-"+a+" <"+i+"."+(+r+1)+".0":">="+i+"."+r+"."+o+"-"+a+" <"+(+i+1)+".0.0"):(n("no pr"),s="0"===i?"0"===r?">="+i+"."+r+"."+o+" <"+i+"."+r+"."+(+o+1):">="+i+"."+r+"."+o+" <"+i+"."+(+r+1)+".0":">="+i+"."+r+"."+o+" <"+(+i+1)+".0.0"),n("caret return",s),s}))}(e,t)})).join(" ")}(e,t),n("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var i=t.loose?s[c.TILDELOOSE]:s[c.TILDE];return e.replace(i,(function(t,i,r,o,a){var s;return n("tilde",e,t,i,r,o,a),x(i)?s="":x(r)?s=">="+i+".0.0 <"+(+i+1)+".0.0":x(o)?s=">="+i+"."+r+".0 <"+i+"."+(+r+1)+".0":a?(n("replaceTilde pr",a),s=">="+i+"."+r+"."+o+"-"+a+" <"+i+"."+(+r+1)+".0"):s=">="+i+"."+r+"."+o+" <"+i+"."+(+r+1)+".0",n("tilde return",s),s}))}(e,t)})).join(" ")}(e,t),n("tildes",e),e=function(e,t){return n("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var i=t.loose?s[c.XRANGELOOSE]:s[c.XRANGE];return e.replace(i,(function(i,r,o,a,s,u){n("xRange",e,i,r,o,a,s,u);var c=x(o),l=c||x(a),d=l||x(s),p=d;return"="===r&&p&&(r=""),u=t.includePrerelease?"-0":"",c?i=">"===r||"<"===r?"<0.0.0-0":"*":r&&p?(l&&(a=0),s=0,">"===r?(r=">=",l?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):"<="===r&&(r="<",l?o=+o+1:a=+a+1),i=r+o+"."+a+"."+s+u):l?i=">="+o+".0.0"+u+" <"+(+o+1)+".0.0"+u:d&&(i=">="+o+"."+a+".0"+u+" <"+o+"."+(+a+1)+".0"+u),n("xRange return",i),i}))}(e,t)})).join(" ")}(e,t),n("xrange",e),e=function(e,t){return n("replaceStars",e,t),e.trim().replace(s[c.STAR],"")}(e,t),n("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(r)}))),o.map((function(e){return new O(e,this.options)}),this)},k.prototype.intersects=function(e,t){if(!(e instanceof k))throw new TypeError("a Range is required");return this.set.some((function(n){return N(n,t)&&e.set.some((function(e){return N(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new k(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},k.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new g(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(L(this.set[t],e,this.options))return!0;return!1},t.satisfies=_,t.maxSatisfying=function(e,t,n){var i=null,r=null;try{var o=new k(t,n)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(i&&-1!==r.compare(e)||(r=new g(i=e,n)))})),i},t.minSatisfying=function(e,t,n){var i=null,r=null;try{var o=new k(t,n)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(i&&1!==r.compare(e)||(r=new g(i=e,n)))})),i},t.minVersion=function(e,t){e=new k(e,t);var n=new g("0.0.0");if(e.test(n))return n;if(n=new g("0.0.0-0"),e.test(n))return n;n=null;for(var i=0;i<e.set.length;++i)e.set[i].forEach((function(e){var t=new g(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!I(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return n&&e.test(n)?n:null},t.validRange=function(e,t){try{return new k(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return M(e,t,"<",n)},t.gtr=function(e,t,n){return M(e,t,">",n)},t.outside=M,t.prerelease=function(e,t){var n=m(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new k(e,n),t=new k(t,n),e.intersects(t)},t.coerce=function(e,t){if(e instanceof g)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;var n=null;if((t=t||{}).rtl){for(var i;(i=s[c.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),s[c.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;s[c.COERCERTL].lastIndex=-1}else n=e.match(s[c.COERCE]);return null===n?null:m(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}},832:e=>{"use strict";e.exports={WU:"2.16.0"}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";class e{constructor(){this.registrations=new Map}addEventListener(e,t){this.registrations.set(e,t)}dispatchEvent(e,t){this.registrations.has(e)&&this.registrations.get(e)(t)}clearListeners(){this.registrations.clear()}}var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};function o(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const a=n(832).WU,s="appInitialization.appLoaded",u="appInitialization.expectedFailure",c="appInitialization.failure",l="appInitialization.success",d="authentication.getAuthToken",p="authentication.getUser",f="authentication.authenticate",h="authentication.authenticate.success",v="authentication.authenticate.failure",m="calendar.composeMeeting",g="calendar.openCalendarItem",S="clipboard.writeToClipboard",y="clipboard.readFromClipboard",E="conversations.openConversation",I="conversations.closeConversation",T="getChatMembers",A="tasks.startTask",C="tasks.completeTask",w={resize:"tasks.updateTask"},b="externalAppCardActions.processActionOpenUrl",R="externalAppCardActions.processActionSubmit",O="externalAppCommands.processActionCommand",P="externalAppAuthentication.authenticateAndResendRequest",k="externalAppAuthentication.authenticateWithSSO",N="externalAppAuthentication.authenticateWithSSOAndResendRequest",x="externalAppAuthentication.authenticateWithOauth2",D="files.addCloudStorageFolder",L="files.copyMoveFiles",_="files.deleteCloudStorageFolder",M="files.getCloudStorageFolders",F="openFilePreview",U="files.getExternalProviders",H="files.getCloudStorageFolderContents",z="getContext",V="initialize",j="location.getLocation",B={showLocation:"location.showLocation"},W="interactive.getFluidTenantInfo",G="interactive.getFluidToken",$="interactive.getFluidContainerId",q="interactive.setFluidContainerId",K="interactive.getNtpTime",X="interactive.registerClientId",J="interactive.getClientRoles",Q="interactive.getClientInfo",Y="mail.composeMail",Z="mail.openMailItem",ee="marketplace.getCart",te="marketplace.addOrUpdateCartItems",ne="marketplace.removeCartItems",ie="marketplace.updateCartStatus",re="captureImage",oe="getMedia",ae="selectMedia",se="viewImages",ue="meeting.getAppContentStageSharingCapabilities",ce="meeting.getAppContentStageSharingState",le="meeting.getAuthenticationTokenForAnonymousUser",de="getIncomingClientAudioState",pe="meeting.getLiveStreamState",fe="meeting.getMeetingDetails",he={setOptions:"meeting.appShareButton.setOptions"},ve="meeting.requestStartLiveStreaming",me="meeting.requestStopLiveStreaming",ge="meeting.shareAppContentToStage",Se="meeting.stopSharingAppContentToStage",ye="toggleIncomingClientAudio",Ee="meeting.requestAppAudioHandling",Ie="meeting.updateMicState",Te="meeting.joinMeeting",Ae="meetingRoom.getPairedMeetingRoomInfo",Ce="meetingRoom.sendCommandToPairedMeetingRoom",we="settings.getSettings",be="navigateCrossDomain",Re="pages.navigateToApp",Oe="returnFocus",Pe="setFrameContext",ke="shareDeepLink",Ne={navigateBack:"navigateBack"},xe={navigateTo:"pages.currentApp.navigateTo",navigateToDefaultPage:"pages.currentApp.navigateToDefaultPage"},De={getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",navigateToTab:"navigateToTab"},Le={setConfig:"settings.setSettings",setValidityState:"settings.setValidityState",save:{success:"settings.save.success",failure:"settings.save.failure"},remove:{success:"settings.remove.success",failure:"settings.remove.failure"}},_e={enterFullscreen:"enterFullscreen",exitFullscreen:"exitFullscreen"},Me={getPermissionStatus:"permissions.has"},Fe="permissions.request",Ue="remoteCamera.getCapableParticipants",He="remoteCamera.requestControl",ze="remoteCamera.sendControlCommand",Ve="remoteCamera.terminateSession",je="search.unregister",Be="search.closeSearch",We="teams.getTeamChannels",Ge="teams.refreshSiteUrl",$e={getConfigSetting:"getConfigSetting",joinedTeams:{getUserJoinedTeams:"getUserJoinedTeams"}};var qe,Ke,Xe;(Xe=qe||(qe={})).AuthFailed="AuthFailed",Xe.Timeout="Timeout",Xe.Other="Other",Xe.AppInitTimeout="AppInitTimeout",Xe.Validation="Validation",Xe.Validation_InvalidDomains="Validation_InvalidDomains",function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(Ke||(Ke={}));const Je={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain}([:/].*)?)$"},Qe=/^(\*\.)*[^*]+$/i,Ye=(new Set(["b5abf2ae-c16b-4310-8f8a-d3bcdb52f162","d870f6cd-4aa5-4d42-9626-ab690c041429"]),["com.example.microsoftteamstabs.test","com.example.m365testapp.test"]),Ze="Authorization code exceeds max length of 2048 characters",et="Authorization code contains unexpected characters. Allowed characters are a-z, A-Z, 0-9, ., _, +, /, =, ~, and -",tt="Desktop clients must provide implementation for externalAuthService on IAuthenticationService. External auth flows may not work as expected when externalAuthService is not provided.",nt="App does not have the required permissions for this operation";class it{constructor(e){this.listeners={},this.element=e}addListener(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)}removeListener(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e)}}var rt,ot=new Uint8Array(16);function at(){if(!rt&&!(rt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rt(ot)}const st=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var ut=[],ct=0;ct<256;++ct)ut.push((ct+256).toString(16).substr(1));const lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(ut[e[t+0]]+ut[e[t+1]]+ut[e[t+2]]+ut[e[t+3]]+"-"+ut[e[t+4]]+ut[e[t+5]]+"-"+ut[e[t+6]]+ut[e[t+7]]+"-"+ut[e[t+8]]+ut[e[t+9]]+"-"+ut[e[t+10]]+ut[e[t+11]]+ut[e[t+12]]+ut[e[t+13]]+ut[e[t+14]]+ut[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&st.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},dt=function(e,t,n){var i=(e=e||{}).random||(e.rng||at)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return lt(i)},pt="{authId}",ft="authId",ht="result",vt=(()=>{const e={};return{startNewExternalAuthSession:(t,n,i)=>{const r=(e=>{const t=new URL(e).searchParams.get(ft);return t&&t!==pt?t:dt()})(t);return t=t.replace("{oauthRedirectMethod}","deeplink").replace(pt,r).replace("{hostRedirectUrl}",i?((e,t)=>{const n=new URL(e);n.searchParams.delete(ft),n.searchParams.delete(ht);const i=decodeURIComponent(n.searchParams.toString()),r=""===i.trim();n.search="";const o=`${i}${r?"":"&"}`;return encodeURIComponent(`${n.toString()}?${o}${ft}=${t}&${ht}={result}`)})(i,r):""),e[r]={handler:n,url:t,timeoutId:window.setTimeout((()=>{n(!1,"OAuth session timeout"),delete e[r]}),12e4)},new URL(t)},completeAuth:(t,n)=>{if("string"==typeof t&&"string"==typeof n){const i=e[t];if(i){window.clearTimeout(i.timeoutId);const r=RegExp("^[-a-zA-Z0-9._~+/=]+$");n.length>2048?i.handler(!1,Ze):r.test(n)?i.handler(!0,n):i.handler(!1,et),delete e[t]}}}}})();var mt,gt,St,yt,Et,It,Tt,At,Ct,wt,bt,Rt,Ot,Pt,kt,Nt,xt,Dt,Lt,_t,Mt,Ft,Ut;(Ut=mt||(mt={})).Debug="Debug",Ut.Info="Info",Ut.Warn="Warn",Ut.Error="Error",(Ft=gt||(gt={})).Unknown="unknown",Ft.Loading="loading",Ft.WaitingForAppLoad="WaitingForAppLoad",Ft.Loaded="loaded",Ft.Failed="failed",Ft.Unloading="unloading",Ft.Unloaded="unloaded",Ft.Cached="cached",(Mt=St||(St={}))[Mt.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",Mt[Mt.INTERNAL_ERROR=500]="INTERNAL_ERROR",Mt[Mt.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",Mt[Mt.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",Mt[Mt.NETWORK_ERROR=2e3]="NETWORK_ERROR",Mt[Mt.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",Mt[Mt.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",Mt[Mt.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",Mt[Mt.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",Mt[Mt.THROTTLE=7e3]="THROTTLE",Mt[Mt.USER_ABORT=8e3]="USER_ABORT",Mt[Mt.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",Mt[Mt.OLD_PLATFORM=9e3]="OLD_PLATFORM",Mt[Mt.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",Mt[Mt.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED",function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(yt||(yt={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(Et||(Et={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(It||(It={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(Tt||(Tt={})),(_t=At||(At={})).Inline="inline",_t.Desktop="desktop",_t.Web="web",function(e){e.M365Content="m365content"}(Ct||(Ct={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(wt||(wt={})),function(e){e.Public="public",e.EUDB="eudb",e.DOD="dod",e.DOJ="doj"}(bt||(bt={})),function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(Rt||(Rt={})),function(e){e.bing="Bing",e.cmc="CMC",e.cmcMobile="CMCMobile",e.edge="Edge",e.edgeSidebar="EdgeSidebar",e.office="Office",e.orange="Orange",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.teams="Teams",e.teamsModern="TeamsModern",e.windowsCopilot="WindowsCopilot"}(Ot||(Ot={})),function(e){e.windows="windows",e.macOs="macos"}(Pt||(Pt={})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(kt||(kt={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Nt||(Nt={})),function(e){e.web="web",e.desktop="desktop"}(xt||(xt={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(Dt||(Dt={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(Lt||(Lt={}));var Ht,zt=(Ht=[],{fireEvent:function(e){Ht.forEach((function(t){return t(e)}))},addListener:function(e){e&&Ht.push(e)}});function Vt(e,t,n){zt.fireEvent({level:e,category:t,message:n})}function jt(e,t,n){Vt(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var Bt={};function Wt(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?Bt[e]?(t.ariaTenantToken&&(Bt[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(Bt[e].dnmToken=t.dnmToken)):Bt[e]=t:Vt(0,0,(function(){return"Namespace: ".concat(e)}))}function Gt(e,t){for(var n=e.length;n>0;){var i=e.substr(0,n);if(Bt[i]){var r=Bt[i];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var $t=9007199254740991,qt=-$t,Kt=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,Xt=/^[a-zA-Z0-9_\.]{1,95}$/;function Jt(e){return Xt.test(e)}function Qt(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!Jt(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<qt||e>$t)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function Yt(e,t,n){return tn(e,1,t,n)}function Zt(e,t,n){return tn(e,2,t,n)}function en(e,t,n){return tn(e,0,t,n)}function tn(e,t,n,i){return{name:e,dataType:t,value:n,classification:i||4}}function nn(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?r({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var rn,on,an,sn,un,cn,ln,dn=function(){function e(e,t,n){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=r(r({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(Zt("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=nn(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var i=n.ariaTenantToken;i||Gt(t.eventName,n)||i?this.sendTelemetryEventInternal(t,1):Vt(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=nn(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=nn(e),n=t.telemetryProperties,i=n.customerContentVersion;return(!i||i>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=nn(e),n=t.telemetryProperties;n.dnmToken||Gt(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):Vt(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Vt(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void jt(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else Vt(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,i,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(en("OTelJS.Version","4.18.2")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!Kt.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!Jt(n.name))throw new Error("Invalid eventContract");Qt(n.dataFields)}Qt(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i[0],o=i[1];this.sendTelemetryEventInternal(r,o)}},e.prototype.setTenantToken=function(e,t,n){Wt(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){Wt(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return nn(e)},e.prototype.getConfig=function(){return this.config},e}();!function(e){e.getFields=function(e,t){var n=[];return n.push(Zt("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push(en("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push(Zt("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push(Yt("".concat(e,".IsExpected"),t.isExpected)),n.push(en("zC.Activity.Result","Office.System.Result")),n}}(rn||(rn={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",i=[];return void 0!==t.cV&&i.push(en("".concat(n,".CV"),t.cV)),i.push(Zt("".concat(n,".Duration"),t.duration)),i.push(Zt("".concat(n,".Count"),t.count)),i.push(Zt("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&i.push(Yt("".concat(n,".Success"),t.success)),void 0!==t.result&&i.push.apply(i,rn.getFields("".concat(n,".Result"),t.result)),i.push(en("zC.Activity",e.contractName)),i}}(on||(on={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(en("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push(en("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push(en("".concat(e,".SessionId"),t.sessionId)),n}}(an||(an={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(en("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push(en("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(en("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(en("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push(en("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Yt("".concat(e,".IsAnonymous"),t.isAnonymous)),n}}(sn||(sn={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(en("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push(en("".concat(e,".State"),t.state)),n}}(un||(un={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Zt("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push(en("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push(en("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push(en("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push(en("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Zt("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n}}(cn||(cn={})),function(e){e.getFields=function(e,t){var n=[];return n.push(en("".concat(e,".ErrorGroup"),t.errorGroup)),n.push(Zt("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push(Zt("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push(Zt("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push(Zt("".concat(e,".Count"),t.count)),n}}(ln||(ln={}));var pn,fn=on,hn=rn,vn=ln,mn=un,gn=an,Sn=cn,yn=sn;function En(e,t){return e?e+"."+t:t}function In(e,t,n,i,r){void 0===r&&(r=4),i&&e.push(en("".concat(En(t,n)),i,r))}function Tn(e,t,n,i){"boolean"==typeof i&&e.push(Yt("".concat(En(t,n)),i))}function An(e,t,n,i){"number"==typeof i&&e.push(Zt("".concat(En(t,n)),i))}!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=fn,n.Result=hn,n.Error=vn,n.Funnel=mn,n.Host=gn,n.User=yn,n.UserAction=Sn}(pn||(pn={}));var Cn,wn={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return In(n,t,"CV",e.cV),An(n,t,"Duration",e.duration),An(n,t,"Count",e.count),An(n,t,"AggMode",e.aggMode),Tn(n,t,"Success",e.success),e.result&&n.push.apply(n,function(e){var t="Activity.Result",n=[];return An(n,t,"Code",e.code),In(n,t,"Type",e.type),An(n,t,"Tag",e.tag),Tn(n,t,"IsExpected",e.isExpected),n.push(en("zC.Activity.Result","Office.System.Result")),n}(e.result)),n.push(en("zC.Activity",this.contractName)),n}},bn=function(e){var t="User",n=[];return In(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),In(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),In(n,t,"TenantId",e.tenantId,1),In(n,t,"TenantGroup",e.tenantGroup,1),Tn(n,t,"IsAnonymous",e.isAnonymous),Tn(n,t,"IsSignedIn",e.isSignedIn),n};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(Cn||(Cn={}));var Rn,On=function(e){var t="App",n=[];return In(n,t,"Name",e.name,1),In(n,t,"Platform",e.platform,1),In(n,t,"Version",e.version,1),n},Pn=function(e){var t="Session",n=[];return In(n,t,"Id",e.id,1),In(n,t,"EcsETag",e.ecsETag,1),n};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(Rn||(Rn={}));var kn,Nn;!function(e){var t,n,i,r,o="Copilot";(r=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",r.IsSeen="IsSeen",r.IsTried="IsTried",r.IsKept="IsKept",r.IsRejected="IsRejected",(i=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",i.Commanding="Commanding",i.QAandSummaries="QA and Summaries",i.Collaboration="Collaboration",i.Suggestions="Suggestions",(n=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",n.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return In(t,o,"FeatureActionType",e.featureActionType),Tn(t,o,"IsUserInitiated",e.isUserInitiated),In(t,o,"FeatureName",e.featureName),In(t,o,"SubFeatureName",e.subFeatureName),In(t,o,"Capability",e.capability),Tn(t,o,"IsThumbsUp",e.isThumbsUp),In(t,o,"EntryPoint",e.entryPoint),In(t,o,"Verb",e.verb),t.push(en("zC.".concat(o),"Office.System.Copilot")),t}}(kn||(kn={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var n=[];return In(n,t,"EventType",e.eventType),In(n,t,"Pillar",e.pillar),In(n,t,"Scenario",e.scenario),In(n,t,"Veto",e.veto),In(n,t,"Error",e.error),Tn(n,t,"InStaging",e.inStaging),Tn(n,t,"IsSessionEndingError",e.isSessionEndingError),Tn(n,t,"IsIntentional",e.isIntentional),Tn(n,t,"IsInternal",e.isInternal),n.push(en("zC.".concat(t),"Office.System.Asha")),n}}(Nn||(Nn={}));var xn=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(xn=function(){return 1e3*Math.floor(window.performance.now())});var Dn,Ln=function(e){var t,n=xn(),i=nn(e.telemetryEvent);return r(r({cv:e.parentCv.getNext()},i),{createChildActivity:function(t){return Ln({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var i,r;if(!t){void 0===this.success&&void 0===this.result&&Vt(1,0,(function(){return"Activity does not have success or result set"}));var o=xn();t=!0;var a={duration:o-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},s=null!==(r=null===(i=this.eventContract)||void 0===i?void 0:i.dataFields)&&void 0!==r?r:[];return s.push.apply(s,wn.getFields(a)),this.eventContract={name:wn.contractName,dataFields:s},e.sendTelemetryEvent(this)}Vt(0,0,(function(){return"Already ended"}))}})},_n=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),Mn=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.baseCv=function(){if(!Dn){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));Dn=new _n(e.join(""))}return Dn}(),r}return i(t,e),t.prototype.createActivity=function(e){return Ln({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:wn.contractName,dataFields:wn.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push(en("".concat(t,".ErrorGroup"),e.errorGroup)),n.push(Zt("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push(Zt("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push(Zt("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push(Zt("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return Ln({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(dn),Fn="function",Un="object",Hn="undefined",zn="prototype",Vn="hasOwnProperty",jn=Object,Bn=jn[zn],Wn=jn.assign,Gn=jn.create,$n=jn.defineProperty,qn=Bn[Vn],Kn=null;function Xn(e){void 0===e&&(e=!0);var t=!1===e?null:Kn;return t||(typeof globalThis!==Hn&&(t=globalThis),t||typeof self===Hn||(t=self),t||typeof window===Hn||(t=window),t||typeof n.g===Hn||(t=n.g),Kn=t),t}function Jn(e){throw new TypeError(e)}function Qn(e){if(Gn)return Gn(e);if(null==e)return{};var t=typeof e;function n(){}return t!==Un&&t!==Fn&&Jn("Object prototype may only be an Object:"+e),n[zn]=e,new n}var Yn="initialize",Zn="name",ei="getNotifyMgr",ti="identifier",ni="push",ii="isInitialized",ri="config",oi="instrumentationKey",ai="logger",si="length",ui="time",ci="processNext",li="getProcessTelContext",di="addNotificationListener",pi="removeNotificationListener",fi="stopPollingInternalLogs",hi="onComplete",vi="getPlugin",mi="flush",gi="_extensions",Si="splice",yi="teardown",Ei="messageId",Ii="message",Ti="isAsync",Ai="_doTeardown",Ci="update",wi="getNext",bi="diagLog",Ri="setNextPlugin",Oi="createNew",Pi="cookieCfg",ki="indexOf",Ni="substring",xi="userAgent",Di="split",Li="setEnabled",_i="substr",Mi="nodeType",Fi="apply",Ui="replace",Hi="enableDebugExceptions",zi="toLowerCase",Vi="call",ji="type",Bi="handler",Wi="listeners",Gi="isChildEvt",$i="getCtx",qi="setCtx",Ki="complete",Xi="traceId",Ji="spanId",Qi="traceFlags",Yi="",Zi="channels",er="core",tr="createPerfMgr",nr="disabled",ir="extensionConfig",rr="processTelemetry",or="priority",ar="eventsSent",sr="eventsDiscarded",ur="eventsSendRequest",cr="perfEvent",lr="errorToConsole",dr="warnToConsole",pr="getPerfMgr",fr="toISOString",hr="endsWith",vr="startsWith",mr="indexOf",gr="trim",Sr="toString",yr="__proto__",Er="constructor",Ir=$n,Tr=jn.freeze,Ar=(jn.seal,jn.keys),Cr=String[zn],wr=Cr[gr],br=Cr[hr],Rr=Cr[vr],Or=Date[zn][fr],Pr=Array.isArray,kr=Bn[Sr],Nr=qn[Sr],xr=Nr[Vi](jn),Dr=/-([a-z])/g,Lr=/([^\w\d_$])/g,_r=/^(\d+[\w\d_$])/,Mr=Object.getPrototypeOf;function Fr(e){return void 0===e||typeof e===Hn}function Ur(e){return null===e||Fr(e)}function Hr(e){return!Ur(e)}function zr(e,t){return!(!e||!qn[Vi](e,t))}function Vr(e){return!(!e||typeof e!==Un)}function jr(e){return!(!e||typeof e!==Fn)}function Br(e){var t=e;return t&&Kr(t)&&(t=(t=(t=t[Ui](Dr,(function(e,t){return t.toUpperCase()})))[Ui](Lr,"_"))[Ui](_r,(function(e,t){return"_"+t}))),t}function Wr(e,t){if(e)for(var n in e)qn[Vi](e,n)&&t[Vi](e,n,e[n])}function Gr(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Rr?e[vr](t):function(e,t){var n=!1,i=t?t[si]:0;if(e&&i&&e[si]>=i&&!(n=e===t)){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;n=!0}return n}(e,t)),n}function $r(e,t){return!(!e||!t)&&-1!==e[ki](t)}var qr=Pr||function(e){return!(!e||"[object Array]"!==kr[Vi](e))};function Kr(e){return"string"==typeof e}function Xr(e){return"number"==typeof e}function Jr(e){return"boolean"==typeof e}function Qr(e){var t=!1;if(e&&"object"==typeof e){var n=Mr?Mr(e):function(e){if(e){if(Mr)return Mr(e);var t=e[yr]||e[zn]||e[Er];if(t)return t}return null}(e);n?(n[Er]&&qn[Vi](n,Er)&&(n=n[Er]),t=typeof n===Fn&&Nr[Vi](n)===xr):t=!0}return t}function Yr(e){if(e)return Or?e[fr]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[si]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Zr(e,t,n){var i=e[si];try{for(var r=0;r<i&&(!(r in e)||-1!==t[Vi](n||e,e[r],r,e));r++);}catch(e){}}function eo(e,t,n){if(e){if(e[mr])return e[mr](t,n);var i=e[si],r=n||0;try{for(var o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function to(e){return e&&(e=wr&&e[gr]?e[gr]():e[Ui]?e[Ui](/^\s+|(?=\s)\s+$/g,Yi):e),e}var no=!{toString:null}.propertyIsEnumerable("toString"),io=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function ro(e){var t=typeof e;if(t===Fn||t===Un&&null!==e||Jn("objKeys called on non-object"),!no&&Ar)return Ar(e);var n=[];for(var i in e)e&&qn[Vi](e,i)&&n[ni](i);if(no)for(var r=io[si],o=0;o<r;o++)e&&qn[Vi](e,io[o])&&n[ni](io[o]);return n}function oo(e,t,n,i){if(Ir)try{var r={enumerable:!0,configurable:!0};return n&&(r.get=n),i&&(r.set=i),Ir(e,t,r),!0}catch(e){}return!1}var ao=Tr||function(e){return e};function so(){var e=Date;return e.now?e.now():(new e).getTime()}function uo(e){return function(e){return!(!e||"[object Error]"!==kr[Vi](e))}(e)?e[Zn]:Yi}function co(e,t,n,i,r){var o=n;return e&&((o=e[t])===n||r&&!r(o)||i&&!i(n)||(o=n,e[t]=o)),o}function lo(e,t,n){var i;return e?!(i=e[t])&&Ur(i)&&(i=Fr(n)?{}:n,e[t]=i):i=Fr(n)?{}:n,i}function po(e,t){return Ur(e)?t:e}function fo(e){return!!e}function ho(e){throw new Error(e)}function vo(e,t,n,i,r){e&&t&&n&&(!1!==r||Fr(e[t]))&&(e[t]=function(e,t){var n=null,i=null;return jr(e)?n=e:i=e,function(){var e=arguments;if(n&&(i=n()),i)return i[t][Fi](i,e)}}(n,i))}function mo(e){return e&&Wn&&(e=jn(Wn({},e))),e}function go(e,t,n,i,r,o){var a=arguments,s=a[0]||{},u=a[si],c=!1,l=1;for(u>0&&Jr(s)&&(c=s,s=a[l]||{},l++),Vr(s)||(s={});l<u;l++){var d=a[l],p=qr(d),f=Vr(d);for(var h in d)if(p&&h in d||f&&qn[Vi](d,h)){var v=d[h],m=void 0;if(c&&v&&((m=qr(v))||Qr(v))){var g=s[h];m?qr(g)||(g=[]):Qr(g)||(g={}),v=go(c,g,v)}void 0!==v&&(s[h]=v)}}return s}var So,yo="Data.",Eo="User.PrimaryIdentityHash",Io="User.PrimaryIdentitySpace",To="User.TenantId",Ao="User.IsAnonymous",Co="User.IsSignedIn",wo="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405";function bo(e,t,n,i){var r=!0;if(t)for(var o=function(t){var o=t.classification,a=t.dataType,s=t.name;if(o&&!(4===o||1===o||2===i&&32===o||3===i&&2048===o))return r=!1,"break";if(3===i&&n&&3!==a&&1!==a&&2!==a&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return Vt(0,1,(function(){return"DNM: Invalid field type "+s})),r=!1,"break";var u;u=n?"zC."===s.substr(0,3)?"zC."+yo+s.substr(3):yo+s:s;var c=void 0;switch(a){case 3:c=6;break;case 2:c=4;break;case 4:c=8;break;case 0:return e[u]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[u]=t.value,"continue"}var l={value:t.value,propertyType:c};e[u]=l},a=0,s=t;a<s.length&&"break"!==o(s[a]);a++);return r}function Ro(e){Vt(0,1,(function(){return"Invalid "+e}))}function Oo(e){return Kr(e)&&""!==e}function Po(e,t){return Object.values(t).includes(e)}function ko(e){return Po(e,Cn)}function No(e){return Po(e,Rn)}function xo(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function Do(e){return!e||"Other"===e}function Lo(e,t){var n=!0;function i(t,i){i(e[t])||(Ro(t),n=!1)}function r(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return i("App.Name",Oo),i("App.Platform",t?ko:Oo),i("App.Version",Oo),i("Session.Id",r),t?(i("Release.AudienceGroup",No),i(Co,Jr),e[Co]?(i(Eo,Oo),i(Io,xo),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[Io])?i(To,r):i(To,Ur)):(i(Io,Do),i(To,Ur))):e[Ao]||!1===e[Co]||(i(Eo,Oo),i(Io,Oo),e[To]&&i(To,r)),Ur(e[Ao])||e[Co]!==e[Ao]||(Ro(Ao),n=!1),n}var _o,Mo="undefined",Fo="constructor",Uo="prototype",Ho="function",zo="_dynInstFuncs",Vo="_isDynProxy",jo="_dynClass",Bo="_dynInstChk",Wo=Bo,Go="_dfOpts",$o="_unknown_",qo="__proto__",Ko="_dyn"+qo,Xo="__dynProto$Gbl",Jo="_dynInstProto",Qo="useBaseInst",Yo="setInstFuncs",Zo=Object,ea=Zo.getPrototypeOf,ta=Zo.getOwnPropertyNames,na=(typeof globalThis!==Mo&&(_o=globalThis),_o||typeof self===Mo||(_o=self),_o||typeof window===Mo||(_o=window),_o||typeof n.g===Mo||(_o=n.g),_o||{}),ia=na[Xo]||(na[Xo]={o:(So={},So[Yo]=!0,So[Qo]=!0,So),n:1e3});function ra(e,t){return e&&Zo[Uo].hasOwnProperty.call(e,t)}function oa(e){return e&&(e===Zo[Uo]||e===Array[Uo])}function aa(e){return oa(e)||e===Function[Uo]}function sa(e){var t;if(e){if(ea)return ea(e);var n=e[qo]||e[Uo]||(e[Fo]?e[Fo][Uo]:null);t=e[Ko]||n,ra(e,Ko)||(delete e[Jo],t=e[Ko]=e[Jo]||e[Ko],e[Jo]=n)}return t}function ua(e,t){var n=[];if(ta)n=ta(e);else for(var i in e)"string"==typeof i&&ra(e,i)&&n.push(i);if(n&&n.length>0)for(var r=0;r<n.length;r++)t(n[r])}function ca(e,t,n){return t!==Fo&&typeof e[t]===Ho&&(n||ra(e,t))&&t!==qo&&t!==Uo}function la(e){throw new TypeError("DynamicProto: "+e)}function da(){return Object.create?(null,(e=Object.create)?e(null):{}):{};var e}function pa(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function fa(e,t,n,i,r){if(!oa(e)){var o=n[zo]=n[zo]||da();if(!oa(o)){var a=o[t]=o[t]||da();!1!==o[Wo]&&(o[Wo]=!!r),oa(a)||ua(n,(function(t){ca(n,t,!1)&&n[t]!==i[t]&&(a[t]=n[t],delete n[t],(!ra(e,t)||e[t]&&!e[t][Vo])&&(e[t]=function(e,t){var n=function(){var i=function(e,t,n,i){var r=null;if(e&&ra(n,jo)){var o=e[zo]||da();if((r=(o[n[jo]]||da())[t])||la("Missing ["+t+"] "+Ho),!r[Bo]&&!1!==o[Wo]){for(var a=!ra(e,t),s=sa(e),u=[];a&&s&&!aa(s)&&!pa(u,s);){var c=s[t];if(c){a=c===i;break}u.push(s),s=sa(s)}try{a&&(e[t]=r),r[Bo]=1}catch(e){o[Wo]=!1}}}return r}(this,t,e,n)||function(e,t,n){var i=t[e];return i===n&&(i=sa(t)[e]),typeof i!==Ho&&la("["+e+"] is not a "+Ho),i}(t,e,n);return i.apply(this,arguments)};return n[Vo]=1,n}(e,t)))}))}}}function ha(e,t){return ra(e,Uo)?e.name||t||$o:((e||{})[Fo]||{}).name||t||$o}function va(e,t,n,i){ra(e,Uo)||la("theClass is an invalid class definition.");var r=e[Uo];(function(e,t){if(ea){for(var n=[],i=sa(t);i&&!aa(i)&&!pa(n,i);){if(i===e)return!0;n.push(i),i=sa(i)}return!1}return!0})(r,t)||la("["+ha(e)+"] not in hierarchy of ["+ha(t)+"]");var o=null;ra(r,jo)?o=r[jo]:(o="_dynCls$"+ha(e,"_")+"$"+ia.n,ia.n++,r[jo]=o);var a=va[Go],s=!!a[Qo];s&&i&&void 0!==i[Qo]&&(s=!!i[Qo]);var u=function(e){var t=da();return ua(e,(function(n){!t[n]&&ca(e,n,!1)&&(t[n]=e[n])})),t}(t),c=function(e,t,n,i){function r(e,t,n){var r=t[n];if(r[Vo]&&i){var o=e[zo]||{};!1!==o[Wo]&&(r=(o[t[jo]]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o=da();ua(n,(function(e){o[e]=r(t,n,e)}));for(var a=sa(e),s=[];a&&!aa(a)&&!pa(s,a);)ua(a,(function(e){!o[e]&&ca(a,e,!ea)&&(o[e]=r(t,a,e))})),s.push(a),a=sa(a);return o}(r,t,u,s);n(t,c);var l=!!ea&&!!a[Yo];l&&i&&(l=!!i[Yo]),fa(r,o,t,u,!1!==l)}va[Go]=ia.o;var ma="window",ga="document",Sa="navigator",ya="location",Ea="performance",Ia="JSON",Ta="crypto",Aa="msCrypto",Ca="msie",wa="trident/",ba="XMLHttpRequest",Ra=null,Oa=null,Pa=!1,ka=null,Na=null;function xa(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[zn];i&&(n=t in i)}}catch(e){}if(!n)try{n=!Fr((new e)[t])}catch(e){}}return n}function Da(e){var t=Xn();return t&&t[e]?t[e]:e===ma&&La()?window:null}function La(){return Boolean(typeof window===Un&&window)}function _a(){return La()?window:Da(ma)}function Ma(){return Boolean(typeof document===Un&&document)?document:Da(ga)}function Fa(){return Boolean(typeof navigator===Un&&navigator)}function Ua(){return Fa()?navigator:Da(Sa)}function Ha(e){if(e&&Pa){var t=Da("__mockLocation");if(t)return t}return typeof location===Un&&location?location:Da(ya)}function za(){return Boolean(typeof JSON===Un&&JSON||null!==Da(Ia))}function Va(){return za()?JSON||Da(Ia):null}function ja(){var e=Ua();return!(!e||!e.product)&&"ReactNative"===e.product}function Ba(){var e=Ua();if(e&&(e[xi]!==Oa||null===Ra)){var t=((Oa=e[xi])||Yi)[zi]();Ra=$r(t,Ca)||$r(t,wa)}return Ra}function Wa(e){var t=Object[zn].toString[Vi](e),n=Yi;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[Zn]+"'":za()&&(n=Va().stringify(e)),t+n}function Ga(){return null===Na&&(Na=Fa()&&Boolean(Ua().sendBeacon)),Na}function $a(e){var t=!1;try{t=!!Da("fetch");var n=Da("Request");t&&e&&n&&(t=xa(n,"keepalive"))}catch(e){}return t}function qa(){var e=!1;try{e=!!Da(ba)}catch(e){}return e}var Ka,Xa=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ja=null;function Qa(e,t){return function(){var n=arguments,i=Ya(t);if(i){var r=i.listener;r&&r[e]&&r[e][Fi](r,n)}}}function Ya(e){var t,n=Ja;return n||!0===e.disableDbgExt||(n=Ja||((t=Da("Microsoft"))&&(Ja=t.ApplicationInsights),Ja)),n?n.ChromeDbgExt:null}function Za(e){if(!Ka){Ka={};for(var t=0;t<Xa[si];t++)Ka[Xa[t]]=Qa(Xa[t],e)}return Ka}function es(e){return e?'"'+e[Ui](/\"/g,Yi)+'"':Yi}function ts(e,t){var n=typeof console!==Hn?console:Da("console");if(n){var i="log";n[e]&&(i=e),jr(n[i])&&n[i](t)}}var ns=function(){function e(e,t,n,i){void 0===n&&(n=!1);var r=this;r[Ei]=e,r[Ii]=(n?"AI: ":"AI (Internal): ")+e;var o=Yi;za()&&(o=Va().stringify(i));var a=(t?" message:"+es(t):Yi)+(i?" props:"+es(o):Yi);r[Ii]+=a}return e.dataType="MessageData",e}(),is=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,i,r,o,a=0,s={};va(e,this,(function(e){function u(t,n){if(!(a>=r)){var o=!0,u="AITR_"+n[Ei];if(s[u]?o=!1:s[u]=!0,o&&(t<=i&&(e.queue[ni](n),a++,c(1===t?"error":"warn",n)),a===r)){var l="Internal events throttle limit per PageView reached for this app.",d=new ns(23,l,!1);e.queue[ni](d),1===t?e[lr](l):e[dr](l)}}}function c(e,n){var i=Ya(t||{});i&&i[bi]&&i[bi](e,n)}!function(e){n=po(e.loggingLevelConsole,0),i=po(e.loggingLevelTelemetry,1),r=po(e.maxMessageLimit,25),o=po(e.enableDebug,po(e[Hi],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return i},e.maxInternalMessageLimit=function(){return r},e[Hi]=function(){return o},e.throwInternal=function(t,i,r,a,l){void 0===l&&(l=!1);var d=new ns(i,r,l,a);if(o)throw Wa(d);var p=1===t?lr:dr;if(Fr(d[Ii]))c("throw"+(1===t?"Critical":"Warning"),d);else{if(l){var f=+d[Ei];!s[f]&&n>=t&&(e[p](d[Ii]),s[f]=!0)}else n>=t&&e[p](d[Ii]);u(t,d)}},e[dr]=function(e){ts("warn",e),c("warning",e)},e[lr]=function(e){ts("error",e),c("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=u}))}return e.__ieDyn=1,e}();function rs(e){return e||new is}function os(e,t,n,i,r,o){void 0===o&&(o=!1),rs(e).throwInternal(t,n,i,r,o)}function as(e,t){rs(e)[dr](t)}var ss="toGMTString",us="toUTCString",cs="cookie",ls="expires",ds="enabled",ps="isCookieUseDisabled",fs="disableCookiesUsage",hs="_ckMgr",vs=null,ms=null,gs=null,Ss=Ma(),ys={},Es={};function Is(e){return!e||e.isEnabled()}function Ts(e,t){return!!(t&&e&&qr(e.ignoreCookies))&&-1!==e.ignoreCookies[ki](t)}function As(e,t){var n,i=function(e){var t=e[Pi]=e[Pi]||{};if(co(t,"domain",e.cookieDomain,Hr,Ur),co(t,"path",e.cookiePath||"/",null,Ur),Ur(t[ds])){var n=void 0;Fr(e[ps])||(n=!e[ps]),Fr(e[fs])||(n=!e[fs]),t[ds]=n}return t}(e||Es),r=i.path||"/",o=i.domain,a=!1!==i[ds],s=((n={isEnabled:function(){var e=a&&Cs(t),n=Es[hs];return e&&n&&s!==n&&(e=Is(n)),e}})[Li]=function(e){a=!1!==e},n.set=function(e,t,n,a,u){var c,l=!1;if(Is(s)&&!function(e,t){return!!(t&&e&&qr(e.blockedCookies)&&-1!==e.blockedCookies[ki](t))||Ts(e,t)}(i,e)){var d={},p=to(t||Yi),f=p[ki](";");if(-1!==f&&(p=to(t[Ni](0,f)),d=ws(t[Ni](f+1))),co(d,"domain",a||o,fo,Fr),!Ur(n)){var h=Ba();if(Fr(d[ls])){var v=so()+1e3*n;if(v>0){var m=new Date;m.setTime(v),co(d,ls,bs(m,h?ss:us)||bs(m,h?ss:us)||Yi,fo)}}h||co(d,"max-age",Yi+n,null,Fr)}var g=Ha();g&&"https:"===g.protocol&&(co(d,"secure",null,null,Fr),null===ms&&(c=(Ua()||{})[xi],ms=!(Kr(c)&&($r(c,"CPU iPhone OS 12")||$r(c,"iPad; CPU OS 12")||$r(c,"Macintosh; Intel Mac OS X 10_14")&&$r(c,"Version/")&&$r(c,"Safari")||$r(c,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=br?e[hr](t):function(e,t){var n=!1,i=t?t[si]:0,r=e?e[si]:0;if(i&&r&&r>=i&&!(n=e===t)){for(var o=r-1,a=i-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}(c,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||$r(c,"Chrome/5")||$r(c,"Chrome/6")||$r(c,"UnrealEngine")&&!$r(c,"Chrome")||$r(c,"UCBrowser/12")||$r(c,"UCBrowser/11")))),ms&&co(d,"SameSite","None",null,Fr)),co(d,"path",u||r,null,Fr),(i.setCookie||Ps)(e,Rs(p,d)),l=!0}return l},n.get=function(e){var t=Yi;return Is(s)&&!Ts(i,e)&&(t=(i.getCookie||Os)(e)),t},n.del=function(e,t){var n=!1;return Is(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var r,o=!1;if(Cs(t)){var a=((r={}).path=n||"/",r[ls]="Thu, 01 Jan 1970 00:00:01 GMT",r);Ba()||(a["max-age"]="0"),(i.delCookie||Ps)(e,Rs(Yi,a)),o=!0}return o},n);return s[hs]=s,s}function Cs(e){if(null===vs){vs=!1;try{vs=void 0!==(Ss||{})[cs]}catch(t){os(e,2,68,"Cannot access document.cookie - "+uo(t),{exception:Wa(t)})}}return vs}function ws(e){var t={};return e&&e[si]&&Zr(to(e)[Di](";"),(function(e){if(e=to(e||Yi)){var n=e[ki]("=");-1===n?t[e]=null:t[to(e[Ni](0,n))]=to(e[Ni](n+1))}})),t}function bs(e,t){return jr(e[t])?e[t]():null}function Rs(e,t){var n=e||Yi;return Wr(t,(function(e,t){n+="; "+e+(Ur(t)?Yi:"="+t)})),n}function Os(e){var t=Yi;if(Ss){var n=Ss[cs]||Yi;gs!==n&&(ys=ws(n),gs=n),t=to(ys[e]||Yi)}return t}function Ps(e,t){Ss&&(Ss[cs]=e+"="+t)}var ks=4294967296,Ns=4294967295,xs=!1,Ds=123456789,Ls=987654321;function _s(){try{var e=2147483647&so();(t=(Math.random()*ks^e)+e)<0&&(t>>>=0),Ds=123456789+t&Ns,Ls=987654321-t&Ns,xs=!0}catch(e){}var t}function Ms(e){var t=0,n=Da(Ta)||Da(Aa);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Ns),0===t&&Ba()&&(xs||_s(),t=function(e){var t=((Ls=36969*(65535&Ls)+(Ls>>16)&Ns)<<16)+(65535&(Ds=18e3*(65535&Ds)+(Ds>>16)&Ns))>>>0&Ns|0;return e||(t>>>=0),t}()&Ns),0===t&&(t=Math.floor(ks*Math.random()|0)),e||(t>>>=0),t}var Fs=$n,Us="2.8.17",Hs="."+function(e){void 0===e&&(e=22);for(var t=Ms()>>>0,n=0,i=Yi;i[si]<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Ms()<<2&4294967295|3&t)>>>0,n=0);return i}(6),zs=0;function Vs(e){return 1===e[Mi]||9===e[Mi]||!+e[Mi]}function js(e,t){return void 0===t&&(t=!1),Br(e+zs+++(t?"."+Us:Yi)+Hs)}function Bs(e){var t={id:js("_aiData-"+(e||Yi)+"."+Us),accept:function(e){return Vs(e)},get:function(e,n,i,r){var o=e[t.id];return o?o[Br(n)]:(r&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{Vs(t)&&(function(e,t,n){if(Fs)try{return Fs(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[Br(n)]=i),i)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Ws="on",Gs="attachEvent",$s="addEventListener",qs="detachEvent",Ks="removeEventListener",Xs="events",Js="visibilitychange",Qs="pagehide",Ys="pageshow",Zs="unload",eu="beforeunload",tu=js("aiEvtPageHide"),nu=js("aiEvtPageShow"),iu=/\.[\.]+/g,ru=/[\.]+$/,ou=1,au=Bs("events"),su=/^([^.]*)(?:\.(.+)|)/;function uu(e){return e&&e[Ui]?e[Ui](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Yi):e}function cu(e,t){var n;if(t){var i=Yi;qr(t)?(i=Yi,Zr(t,(function(e){(e=uu(e))&&("."!==e[0]&&(e="."+e),i+=e)}))):i=uu(t),i&&("."!==i[0]&&(i="."+i),e=(e||Yi)+i)}var r=su.exec(e||Yi)||[];return(n={})[ji]=r[1],n.ns=(r[2]||Yi).replace(iu,".").replace(ru,Yi)[Di](".").sort().join("."),n}function lu(e,t,n){void 0===n&&(n=!0);var i=au.get(e,Xs,{},n),r=i[t];return r||(r=i[t]=[]),r}function du(e,t,n,i){e&&t&&t[ji]&&(e[Ks]?e[Ks](t[ji],n,i):e[qs]&&e[qs](Ws+t[ji],n))}function pu(e,t,n,i){for(var r=t[si];r--;){var o=t[r];o&&(n.ns&&n.ns!==o.evtName.ns||i&&!i(o)||(du(e,o.evtName,o[Bi],o.capture),t[Si](r,1)))}}function fu(e,t){return t?cu("xx",qr(t)?[e].concat(t):[e,t]).ns[Di]("."):e}function hu(e,t,n,i,r){var o;void 0===r&&(r=!1);var a=!1;if(e)try{var s=cu(t,i);if(a=function(e,t,n,i){var r=!1;return e&&t&&t[ji]&&n&&(e[$s]?(e[$s](t[ji],n,i),r=!0):e[Gs]&&(e[Gs](Ws+t[ji],n),r=!0)),r}(e,s,n,r),a&&au.accept(e)){var u=((o={guid:ou++,evtName:s})[Bi]=n,o.capture=r,o);lu(e,s.type)[ni](u)}}catch(e){}return a}function vu(e,t,n,i,r){if(void 0===r&&(r=!1),e)try{var o=cu(t,i),a=!1;!function(e,t,n){if(t[ji])pu(e,lu(e,t[ji]),t,n);else{var i=au.get(e,Xs,{});Wr(i,(function(i,r){pu(e,r,t,n)})),0===ro(i)[si]&&au.kill(e,Xs)}}(e,o,(function(e){return!((!o.ns||n)&&e[Bi]!==n||(a=!0,0))})),a||du(e,o,n,r)}catch(e){}}function mu(e,t,n,i){var r=!1;return t&&e&&e[si]>0&&Zr(e,(function(e){e&&(n&&-1!==eo(n,e)||(r=function(e,t,n){var i=!1,r=_a();r&&(i=hu(r,e,t,n),i=hu(r.body,e,t,n)||i);var o=Ma();return o&&(i=hu(o,e,t,n)||i),i}(e,t,i)||r))})),r}function gu(e,t,n){e&&qr(e)&&Zr(e,(function(e){e&&function(e,t,n){var i=_a();i&&(vu(i,e,t,n),vu(i.body,e,t,n));var r=Ma();r&&vu(r,e,t,n)}(e,t,n)}))}function Su(e,t,n){var i=fu(tu,n),r=mu([Qs],e,t,i);return t&&-1!==eo(t,Js)||(r=mu([Js],(function(t){var n=Ma();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,i)||r),!r&&t&&(r=Su(e,null,n)),r}function yu(e,t,n){var i=fu(nu,n),r=mu([Ys],e,t,i);return!(r=mu([Js],(function(t){var n=Ma();e&&n&&"visible"===n.visibilityState&&e(t)}),t,i)||r)&&t&&(r=yu(e,null,n)),r}function Eu(){var e=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Yi,i=0;i<4;i++)n+=t[15&(e=Ms())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+(3&Ms())|0];return n[_i](0,8)+n[_i](9,4)+"4"+n[_i](13,3)+r+n[_i](16,3)+n[_i](19,12)}();return e[Ni](0,8)+"-"+e[Ni](8,12)+"-"+e[Ni](12,16)+"-"+e[Ni](16,20)+"-"+e[Ni](20)}var Iu=((Xn()||{}).Symbol,(Xn()||{}).Reflect,function(e,t){return Iu=jn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[Vn](n)&&(e[n]=t[n])},Iu(e,t)});function Tu(e,t){function n(){this.constructor=e}typeof t!==Fn&&null!==t&&Jn("Class extends value "+String(t)+" is not a constructor or null"),Iu(e,t),e[zn]=null===t?Qn(t):(n[zn]=t[zn],new n)}function Au(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}var Cu="ctx",wu="ParentContextKey",bu="ChildrenContextKey",Ru=function(){function e(t,n,i){var r,o=this,a=!1;o.start=so(),o[Zn]=t,o[Ti]=i,o[Gi]=function(){return!1},jr(n)&&(a=oo(o,"payload",(function(){return!r&&jr(n)&&(r=n(),n=null),r}))),o[$i]=function(t){return t?t===e[wu]||t===e[bu]?o[t]:(o[Cu]||{})[t]:null},o[qi]=function(t,n){t&&(t===e[wu]?(o[t]||(o[Gi]=function(){return!0}),o[t]=n):t===e[bu]?o[t]=n:(o[Cu]=o[Cu]||{})[t]=n)},o[Ki]=function(){var t=0,i=o[$i](e[bu]);if(qr(i))for(var r=0;r<i[si];r++){var s=i[r];s&&(t+=s[ui])}o[ui]=so()-o.start,o.exTime=o[ui]-t,o[Ki]=function(){},!a&&jr(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Ou=function(){function e(t){this.ctx={},va(e,this,(function(e){e.create=function(e,t,n){return new Ru(e,t,n)},e.fire=function(e){e&&(e[Ki](),t&&jr(t[cr])&&t[cr](e))},e[qi]=function(t,n){t&&((e[Cu]=e[Cu]||{})[t]=n)},e[$i]=function(t){return(e[Cu]||{})[t]}}))}return e.__ieDyn=1,e}(),Pu="CoreUtils.doPerf";function ku(e,t,n,i,r){if(e){var o=e;if(o[pr]&&(o=o[pr]()),o){var a=void 0,s=o[$i](Pu);try{if(a=o.create(t(),i,r)){if(s&&a[qi]&&(a[qi](Ru[wu],s),s[$i]&&s[qi])){var u=s[$i](Ru[bu]);u||(u=[],s[qi](Ru[bu],u)),u[ni](a)}return o[qi](Pu,a),n(a)}}catch(e){a&&a[qi]&&a[qi]("exception",e)}finally{a&&o.fire(a),o[qi](Pu,s)}}}return n()}function Nu(e,t,n){return!(!e||e[si]!==t||e===n||!e.match(/^[\da-f]*$/i))}var xu=Bs("plugin");function Du(e){return xu.get(e,"state",{},!0)}function Lu(e,t){for(var n,i=[],r=null,o=e[wi]();o;){var a=o[vi]();a&&(r&&jr(r[Ri])&&jr(a[rr])&&r[Ri](a),(jr(a[ii])?a[ii]():(n=Du(a))[ii])||i[ni](a),r=a,o=o[wi]())}Zr(i,(function(i){var r=e[er]();i[Yn](e.getCfg(),r,t,e[wi]()),n=Du(i),i[er]||n[er]||(n[er]=r),n[ii]=!0,delete n[yi]}))}function _u(e){return e.sort((function(e,t){var n=0;if(t){var i=jr(t[rr]);jr(e[rr])?n=i?e[or]-t[or]:1:i&&(n=-1)}else n=e?1:-1;return n}))}var Mu="TelemetryPluginChain",Fu="_hasRun",Uu="_getTelCtx",Hu=0;function zu(e,t,n,i){var r=null,o=[];null!==i&&(r=i?function(e,t,n){for(;e;){if(e[vi]()===n)return e;e=e[wi]()}return Wu([n],t[ri]||{},t)}(e,n,i):e);var a={_next:function(){var e=r;if(r=e?e[wi]():null,!e){var t=o;t&&t[si]>0&&(Zr(t,(function(e){try{e.func[Vi](e.self,e.args)}catch(e){os(n[ai],2,73,"Unexpected Exception during onComplete - "+Wa(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[ai]||new is(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,i){void 0===i&&(i=!1);var r,o=s(e,null);return o&&!Ur(o[n])?r=o[n]:t&&!Ur(t[n])&&(r=t[n]),Ur(r)?i:r},hasNext:function(){return!!r},getNext:function(){return r},setNext:function(e){r=e},iterate:function(e){for(var t;t=a._next();){var n=t[vi]();n&&e(n)}},onComplete:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&o[ni]({func:e,self:Fr(t)?a.ctx:t,args:n})}}};function s(e,n,i){var r;if(void 0===n&&(n={}),void 0===i&&(i=0),t){var o=t[ir];o&&e&&(r=o[e])}if(r){if(Vr(n)&&0!==i){var a=go(!0,n,r);t&&2===i&&Wr(n,(function(e){if(Ur(a[e])){var n=t[e];Ur(n)||(a[e]=n)}})),r=a}}else r=n;return r}return a}function Vu(e,t,n,i){var r=zu(e,t,n,i),o=r.ctx;return o[ci]=function(e){var t=r._next();return t&&t[rr](e,o),!t},o[Oi]=function(e,i){return void 0===e&&(e=null),qr(e)&&(e=Wu(e,t,n,i)),Vu(e||o[wi](),t,n,i)},o}function ju(e,t,n){var i=t[ri]||{},r=zu(e,i,t,n),o=r.ctx;return o[ci]=function(e){var t=r._next();return t&&t.unload(o,e),!t},o[Oi]=function(e,n){return void 0===e&&(e=null),qr(e)&&(e=Wu(e,i,t,n)),ju(e||o[wi](),t,n)},o}function Bu(e,t,n){var i=t[ri]||{},r=zu(e,i,t,n).ctx;return r[ci]=function(e){return r.iterate((function(t){jr(t[Ci])&&t[Ci](r,e)}))},r[Oi]=function(e,n){return void 0===e&&(e=null),qr(e)&&(e=Wu(e,i,t,n)),Bu(e||r[wi](),t,n)},r}function Wu(e,t,n,i){var r=null,o=!i;if(qr(e)&&e[si]>0){var a=null;Zr(e,(function(e){if(o||i!==e||(o=!0),o&&e&&jr(e[rr])){var s=function(e,t,n){var i,r=null,o=jr(e[rr]),a=jr(e[Ri]),s={getPlugin:function(){return e},getNext:function(){return r},processTelemetry:function(i,c){u(c=c||function(){var i;return e&&jr(e[Uu])&&(i=e[Uu]()),i||(i=Vu(s,t,n)),i}(),(function(t){if(!e||!o)return!1;var n=Du(e);return!n[yi]&&!n[nr]&&(a&&e[Ri](r),e[rr](i,t),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||c[ci](i)},unload:function(t,n){u(t,(function(){var i=!1;if(e){var r=Du(e),o=e[er]||r[er];!e||o&&o!==t.core()||r[yi]||(r[er]=null,r[yi]=!0,r[ii]=!1,e[yi]&&!0===e[yi](t,n)&&(i=!0))}return i}),"unload",(function(){}),n[Ti])||t[ci](n)},update:function(t,n){u(t,(function(){var i=!1;if(e){var r=Du(e),o=e[er]||r[er];!e||o&&o!==t.core()||r[yi]||e[Ci]&&!0===e[Ci](t,n)&&(i=!0)}return i}),"update",(function(){}),!1)||t[ci](n)},_id:i=e?e[ti]+"-"+e[or]+"-"+Hu++:"Unknown-0-"+Hu++,_setNext:function(e){r=e}};function u(t,n,o,a,s){var u=!1,c=e?e[ti]:Mu,l=t[Fu];return l||(l=t[Fu]={}),t.setNext(r),e&&ku(t[er](),(function(){return c+":"+o}),(function(){l[i]=!0;try{var e=r?r._id:Yi;e&&(l[e]=!1),u=n(t)}catch(e){var a=!r||l[r._id];a&&(u=!0),r&&a||os(t[bi](),1,73,"Plugin ["+c+"] failed during "+o+" - "+Wa(e)+", run flags: "+Wa(l))}}),a,s),u}return ao(s)}(e,t,n);r||(r=s),a&&a._setNext(s),a=s}}))}return i&&!r?Wu([i],t,n):r}var Gu=500;function $u(e,t,n){t&&qr(t)&&t[si]>0&&(Zr(t=t.sort((function(e,t){return e[or]-t[or]})),(function(e){e[or]<Gu&&ho("Channel has invalid priority - "+e[ti])})),e[ni]({queue:ao(t),chain:Wu(t,n[ri],n)}))}function qu(){var e=[];return{add:function(t){t&&e[ni](t)},run:function(t,n){Zr(e,(function(e){try{e(t,n)}catch(e){os(t[bi](),2,73,"Unexpected error calling unload handler - "+Wa(e))}})),e=[]}}}var Ku="getPlugin",Xu=function(){function e(){var t,n,i,r,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var r=n||Vu(null,{},a[er]);t=i&&i[Ku]?r[Oi](null,i[Ku]):r[Oi](null,i)}return t}function u(e,t,r){e&&co(e,ir,[],null,Ur),!r&&t&&(r=t[li]()[wi]());var o=i;i&&i[Ku]&&(o=i[Ku]()),a[er]=t,n=Vu(r,e,t,o)}function c(){t=!1,a[er]=null,n=null,i=null,o=[],r=qu()}c(),va(e,a,(function(e){e[Yn]=function(e,n,i,r){u(e,n,r),t=!0},e[yi]=function(t,n){var a,s=e[er];if(s&&(!t||s===t[er]())){var u,l=!1,d=t||ju(null,s,i&&i[Ku]?i[Ku]():i),p=n||((a={reason:0})[Ti]=!1,a);return e[Ai]&&!0===e[Ai](d,p,f)?u=!0:f(),u}function f(){if(!l){l=!0,r.run(d,n);var e=o;o=[],Zr(e,(function(e){e.rm()})),!0===u&&d[ci](p),c()}}},e[Ci]=function(t,n){var r=e[er];if(r&&(!t||r===t[er]())){var o,a=!1,s=t||Bu(null,r,i&&i[Ku]?i[Ku]():i),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,l)?o=!0:l(),o}function l(){a||(a=!0,u(s.getCfg(),s.core(),s[wi]()))}},e._addHook=function(e){e&&(qr(e)?o=o.concat(e):o[ni](e))},vo(e,"_addUnloadCb",(function(){return r}),"add")})),a[bi]=function(e){return s(e)[bi]()},a[ii]=function(){return t},a.setInitialized=function(e){t=e},a[Ri]=function(e){i=e},a[ci]=function(e,t){t?t[ci](e):i&&jr(i[rr])&&i[rr](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),Ju=function(e){function t(){var n,i,r=e.call(this)||this;function o(){n=0,i=[]}return r.identifier="TelemetryInitializerPlugin",r.priority=199,o(),va(t,r,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return i[ni](t),{remove:function(){Zr(i,(function(e,n){if(e.id===t.id)return i[Si](n,1),-1}))}}},e[rr]=function(t,n){for(var r=!1,o=i[si],a=0;a<o;++a){var s=i[a];if(s)try{if(!1===s.fn[Fi](null,[t])){r=!0;break}}catch(e){os(n[bi](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+uo(e),{exception:Wa(e)},!0)}}r||e[ci](t,n)},e[Ai]=function(){o()}})),r}return Tu(t,e),t.__ieDyn=1,t}(Xu),Qu="Plugins must provide initialize method",Yu="_notificationManager",Zu="SDK is still unloading...",ec={loggingLevelConsole:1};function tc(e,t){return new Ou(t)}function nc(e,t){var n=!1;return Zr(t,(function(t){if(t===e)return n=!0,-1})),n}var ic=function(){function e(){var t,n,i,r,o,a,s,u,c,l,d,p,f,h,v,m,g,S,y,E,I=0,T=!1;va(e,this,(function(e){function A(n){if(!I&&!T&&(n||e[ai]&&e[ai].queue[si]>0)){var i=po(t.diagnosticLogInterval);i&&i>0||(i=1e4),I=setInterval((function(){clearInterval(I),I=0,k()}),i)}return I}function C(){n=!1,t=go(!0,{},ec),e[ri]=t,e[ai]=new is(t),e[gi]=[],v=new Ju,i=[],r=null,o=null,a=null,s=null,u=null,l=null,c=[],d=null,p=null,f=null,h=!1,m=null,g=js("AIBaseCore",!0),S=qu(),E=null}function w(){var n=Vu(O(),t,e);return n[hi](A),n}function b(n){var i=function(e,t,n){var i,r=[],o={};return Zr(n,(function(t){(Ur(t)||Ur(t[Yn]))&&ho(Qu);var n=t[or],i=t[ti];t&&n&&(Ur(o[n])?o[n]=i:as(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+i)),(!n||n<500)&&r[ni](t)})),(i={all:n})[er]=r,i}(e[ai],0,c);l=i[er],u=null;var r=i.all;if(f=ao(function(e,t,n){var i=[];if(e&&Zr(e,(function(e){return $u(i,e,n)})),t){var r=[];Zr(t,(function(e){e[or]>Gu&&r[ni](e)})),$u(i,r,n)}return i}(p,r,e)),d){var o=eo(r,d);-1!==o&&r[Si](o,1),-1!==(o=eo(l,d))&&l[Si](o,1),d._setQueue(f)}else d=function(e,t){function n(){return Vu(null,t[ri],t,null)}function i(e,t,n,i){var r=e?e[si]+1:1;function o(){0==--r&&(i&&i(),i=null)}r>0&&Zr(e,(function(e){if(e&&e.queue[si]>0){var i=e.chain,a=t[Oi](i);a[hi](o),n(a)}else r--})),o()}var r=!1,o={identifier:"ChannelControllerPlugin",priority:Gu,initialize:function(t,n,i,o){r=!0,Zr(e,(function(e){e&&e.queue[si]>0&&Lu(Vu(e.chain,t,n),i)}))},isInitialized:function(){return r},processTelemetry:function(t,r){i(e,r||n(),(function(e){e[ci](t)}),(function(){r[ci](t)}))},update:function(t,n){var r=n||{reason:0};return i(e,t,(function(e){e[ci](r)}),(function(){t[ci](r)})),!0},pause:function(){i(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){i(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return i(e,t,(function(e){e[ci](o)}),(function(){t[ci](o),r=!1})),!0},getChannel:function(t){var n=null;return e&&e[si]>0&&Zr(e,(function(e){if(e&&e.queue[si]>0&&(Zr(e.queue,(function(e){if(e[ti]===t)return n=e,-1})),n))return-1})),n},flush:function(t,r,o,a){var s=1,u=!1,c=null;function l(){s--,u&&0===s&&(c&&(clearTimeout(c),c=null),r&&r(u),r=null)}return a=a||5e3,i(e,n(),(function(e){e.iterate((function(e){if(e[mi]){s++;var n=!1;e[mi](t,(function(){n=!0,l()}),o)||n||(t&&null==c?c=setTimeout((function(){c=null,l()}),a):l())}}))}),(function(){u=!0,l()})),!0},_setQueue:function(t){e=t}};return o}(f,e);r[ni](d),l[ni](d),e[gi]=_u(r),d[Yn](t,e,r),Lu(w(),r),e[gi]=ao(_u(l||[])).slice(),n&&function(t){var n=Bu(O(),e);n[hi](A),e._updateHook&&!0===e._updateHook(n,t)||n[ci](t)}(n)}function R(t){var n,i=null,r=null;return Zr(e[gi],(function(e){if(e[ti]===t&&e!==d&&e!==v)return r=e,-1})),!r&&d&&(r=d.getChannel(t)),r&&((n={plugin:r})[Li]=function(e){Du(r)[nr]=!e},n.isEnabled=function(){var e=Du(r);return!e[yi]&&!e[nr]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var i=[r],o=((n={reason:1})[Ti]=e,n);P(i,o,(function(e){e&&b({reason:32,removed:i}),t&&t(e)}))},i=n),i}function O(){if(!u){var n=(l||[]).slice();-1===eo(n,v)&&n[ni](v),u=Wu(_u(n),t,e)}return u}function P(n,i,r){if(n&&n[si]>0){var o=ju(Wu(n,t,e),e);o[hi]((function(){var e=!1,t=[];Zr(c,(function(i,r){nc(i,n)?e=!0:t[ni](i)})),c=t;var i=[];p&&(Zr(p,(function(t,r){var o=[];Zr(t,(function(t){nc(t,n)?e=!0:o[ni](t)})),i[ni](o)})),p=i),r&&r(e),A()})),o[ci](i)}else r(!1)}function k(){if(e[ai]&&e[ai].queue){var n=e[ai].queue.slice(0);e[ai].queue[si]=0,Zr(n,(function(n){var i,r=((i={})[Zn]=m||"InternalMessageId: "+n[Ei],i.iKey=po(t[oi]),i.time=Yr(new Date),i.baseType=ns.dataType,i.baseData={message:n[Ii]},i);e.track(r)}))}}function N(e,t,n,i){return d?d[mi](e,t,n||6,i):(t&&t(!1),!0)}function x(t){var n=e[ai];n?(os(n,2,73,t),A()):ho(t)}var D,L,_,M;C(),e[ii]=function(){return n},e[Yn]=function(i,o,s,u){var l,d;h&&ho(Zu),e[ii]()&&ho("Core should not be initialized more than once"),t=i||{},e[ri]=t,Ur(i[oi])&&ho("Please provide instrumentation key"),r=u,e[Yu]=u,!0===(d=po(t.disableDbgExt))&&y&&(r[pi](y),y=null),r&&!y&&!0!==d&&(y=Za(t),r[di](y)),!(l=po(t.enablePerfMgr))&&a&&(a=null),l&&lo(t,tr,tc),lo(t,ir,{}).NotificationManager=r,s&&(e[ai]=s);var v=lo(t,"extensions",[]);(c=[])[ni].apply(c,Au(Au([],o),v)),p=lo(t,Zi,[]),b(null),f&&0!==f[si]||ho("No "+Zi+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return f&&Zr(f,(function(t){e[ni](t.queue)})),ao(e)},e.track=function(n){n.iKey=n.iKey||t[oi],n[ui]=n[ui]||Yr(new Date),n.ver=n.ver||"4.0",!h&&e[ii]()?w()[ci](n):i[ni](n)},e[li]=w,e[ei]=function(){return r||(r=function(){var e;return Qn(((e={})[di]=function(e){},e[pi]=function(e){},e[ar]=function(e){},e[sr]=function(e,t){},e[ur]=function(e,t){},e))}(),e[Yu]=r),r},e[di]=function(e){r&&r[di](e)},e[pi]=function(e){r&&r[pi](e)},e.getCookieMgr=function(){return s||(s=As(t,e[ai])),s},e.setCookieMgr=function(e){s=e},e[pr]=function(){if(!o&&!a&&po(t.enablePerfMgr)){var n=po(t[tr]);jr(n)&&(a=n(e,e[ei]()))}return o||a||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return i[si]},e.releaseQueue=function(){if(n&&i[si]>0){var e=i;i=[],Zr(e,(function(e){w()[ci](e)}))}},e.pollInternalLogs=function(e){return m=e||null,T=!1,I&&(clearInterval(I),I=null),A(!0)},e[fi]=function(){T=!0,I&&(clearInterval(I),I=0,k())},L=function(){return v},_=["addTelemetryInitializer"],(D=e)&&L&&Vr(D)&&qr(_)&&Zr(_,(function(e){Kr(e)&&vo(D,e,L,e,M)})),e.unload=function(t,i,r){var o;void 0===t&&(t=!0),n||ho("SDK is not initialized"),h&&ho(Zu);var a=((o={reason:50})[Ti]=t,o.flushComplete=!1,o),s=ju(O(),e);function u(t){a.flushComplete=t,h=!0,S.run(s,a),e[fi](),s[ci](a)}s[hi]((function(){C(),i&&i(a)}),e),k(),N(t,u,6,r)||u(!1)},e[vi]=R,e.addPlugin=function(e,t,n,i){if(!e)return i&&i(!1),void x(Qu);var r=R(e[ti]);if(r&&!t)return i&&i(!1),void x("Plugin ["+e[ti]+"] is already loaded!");var o={reason:16};function a(t){c[ni](e),o.added=[e],b(o),i&&i(!0)}if(r){var s=[r.plugin];P(s,{reason:2,isAsync:!!n},(function(e){e?(o.removed=s,o.reason|=32,a()):i&&i(!1)}))}else a()},e.evtNamespace=function(){return g},e[mi]=N,e.getTraceCtx=function(e){var t;return E||(t={},E={getName:function(){return t[Zn]},setName:function(e){t[Zn]=e},getTraceId:function(){return t[Xi]},setTraceId:function(e){Nu(e,32,"00000000000000000000000000000000")&&(t[Xi]=e)},getSpanId:function(){return t[Ji]},setSpanId:function(e){Nu(e,16,"0000000000000000")&&(t[Ji]=e)},getTraceFlags:function(){return t[Qi]},setTraceFlags:function(e){t[Qi]=e}}),E},e.setTraceCtx=function(e){E=e||null},vo(e,"addUnloadCb",(function(){return S}),"add")}))}return e.__ieDyn=1,e}();function rc(e,t,n,i){Zr(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return i(e)}),0);else try{i(e)}catch(e){}}))}var oc,ac=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;va(e,this,(function(e){e[di]=function(t){e.listeners[ni](t)},e[pi]=function(t){for(var n=eo(e[Wi],t);n>-1;)e.listeners[Si](n,1),n=eo(e[Wi],t)},e[ar]=function(t){rc(e[Wi],ar,!0,(function(e){e[ar](t)}))},e[sr]=function(t,n){rc(e[Wi],sr,!0,(function(e){e[sr](t,n)}))},e[ur]=function(t,n){rc(e[Wi],ur,n,(function(e){e[ur](t,n)}))},e[cr]=function(t){t&&(!n&&t[Gi]()||rc(e[Wi],cr,!1,(function(e){t[Ti]?setTimeout((function(){return e[cr](t)}),0):e[cr](t)})))}}))}return e.__ieDyn=1,e}(),sc=function(e){function t(){var n=e.call(this)||this;return va(t,n,(function(e,t){function n(t){var n=e[ei]();n&&n[sr]([t],2)}e[Yn]=function(e,n,i,r){t[Yn](e,n,i||new is(e),r||new ac(e))},e.track=function(i){ku(e[pr](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),ho("Invalid telemetry item")),function(e){Ur(e[Zn])&&(n(e),ho("telemetry name required"))}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)}})),n}return Tu(t,e),t.__ieDyn=1,t}(ic),uc="",cc="version",lc="properties",dc="1DS-Web-JS-3.2.16",pc="withCredentials",fc=((oc={})[0]=0,oc[2]=6,oc[1]=1,oc[3]=7,oc[4098]=6,oc[4097]=1,oc[4099]=7,oc);function hc(e){return!(e===uc||Ur(e))}function vc(e,t,n){var i=-1;if(!Fr(e))if(t>0&&(32===t?i=8192:t<=13&&(i=t<<5)),function(e){return e>=0&&e<=9}(n))-1===i&&(i=0),i|=n;else{var r=fc[yc(e)]||-1;-1!==i&&-1!==r?i|=r:6===r&&(i=r)}return i}function mc(e,t,n,i,r){var o={},a=!1,s=0,u=arguments.length,c=arguments;for("[object Boolean]"===Object[zn].toString.call(c[0])&&(a=c[0],s++);s<u;s++)Wr(c[s],(function(e,t){a&&t&&Vr(t)?qr(t)?(o[e]=o[e]||[],Zr(t,(function(t,n){t&&Vr(t)?o[e][n]=mc(!0,o[e][n],t):o[e][n]=t}))):o[e]=mc(!0,o[e],t):o[e]=t}));return o}Boolean(Ma()),Boolean(_a());var gc=function(){var e=Da(Ea);return e&&e.now?e.now():so()};function Sc(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=gc()}function yc(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Un&&(t=4,qr(e)?(t=4096,e.length>0&&(t|=yc(e[0]))):qn.call(e,"value")&&(t=8192|yc(e.value)))}return t}var Ec=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],va(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new is({loggingLevelConsole:1})),e.initialize=function(n,i,r,o){ku(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||ho("Invalid property storage override passed."),n.channels&&Zr(n.channels,(function(e){e&&Zr(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},i&&Zr(i,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,i,r,o),e.pollInternalLogs("InternalLog")}catch(t){var u=e.logger,c=Wa(t);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),os(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+c)}}),(function(){return{config:n,extensions:i,logger:r,notificationManager:o}}))},e.track=function(n){ku(e,(function(){return"AppInsightsCore.track"}),(function(){var i,r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=gc(),(i=r.latency)&&Xr(i)&&i>=1&&i<=4||(r.latency=1);var o=r.ext=r.ext||{};o.sdk=o.sdk||{},o.sdk.ver=dc;var a=r.baseData=r.baseData||{};a[lc]=a[lc]||{};var s=a[lc];s[cc]=s[cc]||e.pluginVersionString||uc}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Tu(t,e),t.__ieDyn=1,t}(sc);const Ic=Ec;var Tc,Ac,Cc=(Ac={},Wr({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){Ac[e]=t,Ac[t]=e})),Tc=Ac,Tr&&Wr(Tc,(function(e,t){(qr(t)||Vr(t))&&Tr(t)})),ao(Tc)),wc="REAL_TIME",bc="",Rc="POST",Oc="drop",Pc="requeue",kc="application/x-json-stream",Nc="cache-control",xc="content-type",Dc="kill-duration",Lc="time-delta-millis",_c="client-version",Mc="client-id",Fc="time-delta-to-apply-millis",Uc="upload-time",Hc="apikey",zc="AuthMsaDeviceTicket",Vc="AuthXToken",jc="msfpc",Bc="trace",Wc="user";function Gc(e){var t=(e.ext||{}).intweb;return t&&hc(t[jc])?t[jc]:null}function $c(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Gc(e[n]);return t}var qc=function(){function e(t,n){var i=n?[].concat(n):[],r=this,o=$c(i);r.iKey=function(){return t},r.Msfpc=function(){return o||bc},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(e){return!!e&&(i.push(e),o||(o=Gc(e)),!0)},r.split=function(n,r){var a;if(n<i.length){var s=i.length-n;Ur(r)||(s=r<s?r:s),a=i.splice(n,s),o=$c(i)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}();const Kc=function(){function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;va(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}();var Xc=function(){function e(){var t={};va(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=function(e){var t=[];return e&&Zr(e,(function(e){t.push(to(e))})),t}(e.split(","));if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)t[i[o]]=so()+r}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,i=to(e);return void 0!==n[i]&&n[i]>so()||(delete n[i],!1)}}))}return e.__ieDyn=1,e}();const Jc=Xc;function Qc(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Yc,Zc=2e6,el=Math.min(Zc,65e3),tl="metadata",nl="f",il=/\./,rl=function(){function e(t,n,i,r){var o="data",a="baseData",s=!!r,u=n,c={};va(e,this,(function(e){function n(e,t,r,o,a,l,d){Wr(e,(function(e,p){var f=null;if(p||hc(p)){var h=r,v=e,m=a,g=t;if(s&&!o&&il.test(e)){var S=e.split("."),y=S.length;if(y>1){m&&(m=m.slice());for(var E=0;E<y-1;E++){var I=S[E];g=g[I]=g[I]||{},h+="."+I,m&&m.push(I)}v=S[y-1]}}var T=o&&function(e,t){var n=c[e];return void 0===n&&(e.length>=7&&(n=Gr(e,"ext.metadata")||Gr(e,"ext.web")),c[e]=n),n}(h);if(f=!T&&u&&u.handleField(h,v)?u.value(h,v,p,i):function(e,t,n){if(!t&&!hc(t)||"string"!=typeof e)return null;var i=typeof t;if("string"===i||"number"===i||"boolean"===i||qr(t))t={value:t};else if("object"!==i||qn.call(t,"value")){if(Ur(t.value)||t.value===uc||!Kr(t.value)&&!Xr(t.value)&&!Jr(t.value)&&!qr(t.value))return null}else t={value:n?JSON.stringify(t):t};if(qr(t.value)&&!(t.value.length>0))return null;if(!Ur(t.kind)){if(qr(t.value)||!(0===(r=t.kind)||r>0&&r<=13||32===r))return null;t.value=t.value.toString()}var r;return t}(v,p,i)){var A=f.value;if(g[v]=A,l&&l(m,v,f),d&&"object"==typeof A&&!qr(A)){var C=m;C&&(C=C.slice()).push(v),n(p,A,h+"."+v,o,C,l,d)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:bc,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var o=n&&i&&!n.overflow;return o&&ku(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=[],l=n.isBeacon,d=l?65e3:3984588,p=l?el:Zc,f=0,h=0;f<t.length;){var v=t[f];if(v){if(a>=r){n.overflow=i.split(f);break}var m=e.getEventBlob(v);if(m&&m.length<=p){var g=m.length;if(o.length+g>d){n.overflow=i.split(f);break}o&&(o+="\n"),o+=m,++h>20&&(o.substr(0,1),h=0),s=!0,a++}else m?u.push(v):c.push(v),t.splice(f,1),f--}f++}if(u&&u.length>0&&n.sizeExceed.push(qc.create(i.iKey(),u)),c&&c.length>0&&n.failedEvts.push(qc.create(i.iKey(),c)),s){n.batches.push(i),n.payloadBlob=o,n.numEvents=a;var S=i.iKey();-1===eo(n.apiKeys,S)&&n.apiKeys.push(S)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return ku(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return uc}(e.iKey);var i={},r=e.ext;r&&(t.ext=i,Wr(r,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var s=t[o]={};s.baseType=e.baseType;var u=s[a]={};return n(e.baseData,u,a,!1,[a],(function(e,t,n){ol(i,e,t,n)}),!0),n(e.data,s,o,!1,[],(function(e,t,n){ol(i,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function ol(e,t,n,i){if(i&&e){var r=vc(i.value,i.kind,i.propertyType);if(r>-1){var o=e[tl];o||(o=e[tl]={f:{}});var a=o[nl];if(a||(a=o[nl]={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u][nl];c||(c=a[u][nl]={}),a=c}a=a[n]={},qr(i.value)?a.a={t:r}:a.t=r}}}var al="sendAttempt",sl="&NoResponseBody=true",ul=((Yc={})[1]=Pc,Yc[100]=Pc,Yc[200]="sent",Yc[8004]=Oc,Yc[8003]=Oc,Yc),cl={},ll={};function dl(e,t,n){cl[e]=t,!1!==n&&(ll[t]=e)}function pl(e){try{return e.responseText}catch(e){}return bc}function fl(e,t){var n=!1;if(e&&t){var i=ro(e);if(i&&i.length>0)for(var r=t.toLowerCase(),o=0;o<i.length;o++){var a=i[o];if(a&&zr(t,a)&&a.toLowerCase()===r){n=!0;break}}}return n}function hl(e,t,n,i){t&&n&&n.length>0&&(i&&cl[t]?(e.hdrs[cl[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function vl(e,t){return t&&(Xr(t)?e=[t].concat(e):qr(t)&&(e=t.concat(e))),e}dl(zc,zc,!1),dl(_c,_c),dl(Mc,"Client-Id"),dl(Hc,Hc),dl(Fc,Fc),dl(Uc,Uc),dl(Vc,Vc);var ml=function(){function e(t,n,i,r,o){this._responseHandlers=[];var a,s,u,c,l,d,p,f,h,v,m="?cors=true&"+xc.toLowerCase()+"="+kc,g=new Jc,S=!1,y=new Kc,E=!1,I=0,T=!0,A=[],C={},w=[],b=null,R=!1,O=!1,P=!1;va(e,this,(function(e){var k=!0;function N(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?(null===ka&&(ka=typeof XDomainRequest!==Hn)&&qa()&&(ka=ka&&!xa(Da(ba),"withCredentials")),ka?i=x:qa()&&(i=L)):2===n&&$a(t)&&(!t||t&&!f)?i=D:E&&3===n&&Ga()&&(i=M),r++;return i?{_transport:n,_isSync:t,sendPOST:i}:null}function x(e,t,n){var i=new XDomainRequest;i.open(Rc,e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=pl(i);_(t,200,{},e),q(e)},i.onerror=function(){_(t,400,{})},i.ontimeout=function(){_(t,500,{})},i.onprogress=function(){},n?i.send(e.data):o.set((function(){i.send(e.data)}),0)}function D(e,t,n){var i,r=e.urlString,a=!1,s=!1,u=((i={body:e.data,method:Rc}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(u.keepalive=!0,2===e._sendReason&&(a=!0,v&&(r+=sl))),k&&(u.credentials="include"),e.headers&&ro(e.headers).length>0&&(u.headers=e.headers),fetch(r,u).then((function(e){var n={},i=bc,r=e.headers;r&&r.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),s||(s=!0,_(t,e.status,n,i),q(i))})).catch((function(e){s||(s=!0,_(t,0,{}))})),a&&!s&&(s=!0,_(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,_(t,500,{}))}),e.timeout)}function L(e,t,n){var i=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=to(i))}return e}function o(e,n){_(t,e.status,function(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},Kr(t)&&Zr(to(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=to(e.substring(0,t)).toLowerCase(),r=to(e.substring(t+1));n[i]=r}else n[to(e)]=1}})),i=n):(i=r(i,e,Lc),i=r(i,e,Dc),i=r(i,e,"kill-duration-seconds")),i}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=function(e,t,n,i,r,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var s=new XMLHttpRequest;return i&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&a(s,pc,n),s.open(e,t,!r),n&&a(s,pc,n),!r&&o&&a(s,"timeout",o),s}(Rc,i,k,!0,n,e.timeout);Wr(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=pl(a);o(a,e),q(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function _(e,t,n,i){try{e(t,n,i)}catch(e){os(s,2,518,Wa(e))}}function M(e,t,n){var i=200,r=e._thePayload,o=e.urlString+(v?sl:bc);try{var a=Ua();if(!a.sendBeacon(o,e.data))if(r){var u=[];Zr(r.batches,(function(e){if(u&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,b.getEventBlob(t[n]))){u.push(e.split(n));break}}else u.push(e.split(0))})),K(u,8003,r.sendType,!0)}else i=0}catch(e){as(s,"Failed to send telemetry using sendBeacon API. Ex:"+Wa(e)),i=0}finally{_(t,i,{},bc)}}function F(e){return 2===e||3===e}function U(e){return O&&F(e)&&(e=2),e}function H(){return!S&&I<n}function z(){var e=w;return w=[],e}function V(e,t,n){var i=!1;return e&&e.length>0&&!S&&u[t]&&b&&(i=0!==t||H()&&(n>0||y.allowRequestSending())),i}function j(e){var t={};return e&&Zr(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function B(e,n,i,r,o){if(e&&0!==e.length)if(S)K(e,1,r);else{r=U(r);try{var a=e,l=0!==r;ku(c,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],c=null,d=gc(),p=u[r]||(l?u[1]:u[0]),f=p&&p._transport,v=h&&(O||F(r)||3===f||p._isSync&&2===f);V(e,r,n);){var m=e.shift();m&&m.count()>0&&(g.isTenantKilled(m.iKey())?s.push(m):(c=c||b.createPayload(n,i,l,v,o,r),b.appendPayload(c,m,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,G(c,d,gc(),o),d=gc(),c=null):(G(c,d,gc(),o),d=gc(),e=[m].concat(e),c=null)))}c&&G(c,d,gc(),o),e.length>0&&(w=e.concat(w)),K(s,8004,r)}),(function(){return{batches:j(a),retryCount:n,isTeardown:i,isSynchronous:l,sendReason:o,useSendBeacon:F(r),sendType:r}}),!l)}catch(e){os(s,2,48,"Unexpected Exception sending batch: "+Wa(e))}}}function W(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function G(t,n,r,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,h=u[t.sendType];!F(t.sendType)&&t.isBeacon&&2===t.sendReason&&(h=u[2]||u[3]||h);var v=P;(t.isBeacon||3===h._transport)&&(v=!1);var S=function(e,t){var n={url:m,hdrs:{},useHdrs:!1};t?(n.hdrs=mc(n.hdrs,C),n.useHdrs=ro(n.hdrs).length>0):Wr(C,(function(e,t){ll[e]?hl(n,ll[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),hl(n,Mc,"NO_AUTH",t),hl(n,_c,dc,t);var i=bc;Zr(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),hl(n,Hc,i,t),hl(n,Uc,so().toString(),t);var r=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return bc}(e);if(hc(r)&&(n.url+="&ext.intweb.msfpc="+r),y.shouldAddClockSkewHeaders()&&hl(n,Fc,y.getClockSkewHeaderValue(),t),c.getWParam){var o=c.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<A.length;a++)n.url+="&"+A[a].name+"="+A[a].value;return n}(t,v);v=v||S.useHdrs;var E=gc();ku(c,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var u=0;u<t.batches.length;u++)for(var m=t.batches[u].events(),A=0;A<m.length;A++){var C=m[A];if(R){var w=C.timings=C.timings||{};W(w,"sendEventStart",E),W(w,"serializationStart",n),W(w,"serializationCompleted",r)}C[al]>0?C[al]++:C[al]=1}K(t.batches,1e3+(o||0),t.sendType,!0);var b={data:t.payloadBlob,urlString:S.url,headers:S.hdrs,_thePayload:t,_sendReason:o,timeout:d,disableXhrSync:p,disableFetchKeepAlive:f};v&&(fl(b.headers,Nc)||(b.headers[Nc]="no-cache, no-store"),fl(b.headers,xc)||(b.headers[xc]=kc));var P=null;h&&(P=function(n){y.firstRequestSent();var r=function(n,r){!function(t,n,r,o){var s,u=9e3,c=null,l=!1,d=!1;try{var p=!0;if(typeof t!==Hn){if(n){y.setClockSkew(n[Lc]);var f=n[Dc]||n["kill-duration-seconds"];Zr(g.setKillSwitchTenants(n["kill-tokens"],f),(function(e){Zr(r.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);r.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(u=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||r.numEvents<=0)&&(p=!1),u=9e3+t%1e3}if(p){u=100;var h=r.retryCnt;0===r.sendType&&(h<i?(l=!0,$((function(){0===r.sendType&&I--,B(r.batches,h+1,r.isTeardown,O?2:r.sendType,5)}),O,Qc(h))):(d=!0,O&&(u=8001)))}}finally{l||(y.setClockSkew(),function(t,n,i,r){try{r&&a._backOffTransmission(),200===n&&(r||t.isSync||a._clearBackOff(),function(e){if(R){var t=gc();Zr(e,(function(e){e&&e.count()>0&&function(e,t){R&&Zr(e,(function(e){W(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),K(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(I--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(r,u,o,d)),K(c,8004,r.sendType)}}(n,r,t,o)},u=t.isTeardown||t.isSync;try{h.sendPOST(n,r,u),e.sendListener&&e.sendListener(b,n,u,t.isBeacon)}catch(e){as(s,"Unexpected exception sending payload. Ex:"+Wa(e)),_(r,0,{})}}),ku(c,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(P)if(0===t.sendType&&I++,l&&!t.isBeacon&&3!==h._transport){var n={data:b.data,urlString:b.urlString,headers:mc({},b.headers),timeout:b.timeout,disableXhrSync:b.disableXhrSync,disableFetchKeepAlive:b.disableFetchKeepAlive},i=!1;ku(c,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,T||e._thePayload||(e._thePayload=e._thePayload||b._thePayload,e._sendReason=e._sendReason||b._sendReason),P(e)}),t.isSync||t.isTeardown)}catch(e){i||P(b)}}))}else P(b)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&K(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&K(t.failedEvts,8002,t.sendType)}function $(e,t,n){t?e():o.set(e,n)}function q(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){os(s,1,519,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);hc(r.webResult)&&hc(r.webResult[jc])&&l.set("MSFPC",r.webResult[jc],31536e3)}}catch(e){}}function K(e,t,n,i){if(e&&e.length>0&&r){var o=r[(u=t,l=ul[u],hc(l)||(l="oth",u>=9e3&&u<=9999?l="rspFail":u>=8e3&&u<=8999?l=Oc:u>=1e3&&u<=1999&&(l="send")),l)];if(o){var a=0!==n;ku(c,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){$((function(){try{o.call(r,e,t,a,n)}catch(e){os(s,1,74,"send request notification failed: "+e)}}),i||a,0)}),(function(){return{batches:j(e),reason:t,isSync:a,sendSync:i,sendType:n}}),!a)}}var u,l}e.initialize=function(e,t,n,i,r){var o;r||(r={}),m=e+m,P=!!Fr(r.avoidOptions)||!r.avoidOptions,c=t,l=t.getCookieMgr(),R=!c.config.disableEventTimings;var g=!!c.config.enableCompoundKey;s=(a=n).diagLog();var S=r.valueSanitizer,y=r.stringifyObjects;Fr(r.enableCompoundKey)||(g=!!r.enableCompoundKey),d=r.xhrTimeout,p=!!r.disableXhrSync,f=!!r.disableFetchKeepAlive,v=!1!==r.addNoResponse,E=!ja(),b=new rl(c,S,y,g),Ur(r.useSendBeacon)||(E=!!r.useSendBeacon);var I=i,A=r.alwaysUseXhrOverride?i:null,C=r.alwaysUseXhrOverride?i:null,w=[3,2];if(!i){T=!1;var O=Ha();O&&O.protocol&&"file:"===O.protocol.toLowerCase()&&(k=!1);var x=[];ja()?(x=[2,1],w=[2,1,3]):x=[1,2,3],(i=N(x=vl(x,r.transports),!1))||as(s,"No available transport to send events"),I=N(x,!0)}A||(A=N(w=vl(w,r.unloadTransports),!0)),h=!T&&(E&&Ga()||!f&&$a(!0)),(o={})[0]=i,o[1]=I||N([1,2,3],!0),o[2]=A||I||N([1],!0),o[3]=C||N([2,3],!0)||I||N([1],!0),u=o},e._getDbgPlgTargets=function(){return[u[0],g,b,u]},e.addQueryStringParameter=function(e,t){for(var n=0;n<A.length;n++)if(A[n].name===e)return void(A[n].value=t);A.push({name:e,value:t})},e.addHeader=function(e,t){C[e]=t},e.canSendRequest=function(){return H()&&y.allowRequestSending()},e.sendQueuedRequests=function(e,t){Fr(e)&&(e=0),O&&(e=U(e),t=2),V(w,e,0)&&B(z(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!S&&0===I&&0===w.length},e.setUnloading=function(e){O=e},e.addBatch=function(e){if(e&&e.count()>0){if(g.isTenantKilled(e.iKey()))return!1;w.push(e)}return!0},e.teardown=function(){w.length>0&&B(z(),0,!0,2,2)},e.pause=function(){S=!0},e.resume=function(){S=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Ur(t)&&(t=1),O&&(t=U(t),n=2),B([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function gl(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout(e,t,n)}function Sl(e){clearTimeout(e)}function yl(e,t){return{set:e||gl,clear:t||Sl}}var El="eventsDiscarded",Il="overrideInstrumentationKey",Tl="maxEventRetryAttempts",Al="maxUnloadEventRetryAttempts";const Cl=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.16";var r,o,a,s,u,c,l,d=!1,p=[],f=null,h=!1,v=0,m=500,g=0,S=1e4,y={},E=wc,I=null,T=null,A=0,C=0,w={},b=-1,R=!0,O=!1,P=6,k=2;return va(t,i,(function(e,t){function i(e){"beforeunload"!==(e||_a().event).type&&(O=!0,o.setUnloading(O)),H(2,2)}function N(e){O=!1,o.setUnloading(O)}function x(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[Bc]&&delete e.ext[Bc],e.ext&&e.ext[Wc]&&e.ext[Wc].id&&delete e.ext[Wc].id,R&&(e.ext=mo(e.ext),e.baseData&&(e.baseData=mo(e.baseData)),e.data&&(e.data=mo(e.data))),e.sync)if(A||h)e.latency=3,e.sync=!1;else if(o)return R&&(e=mo(e)),void o.sendSynchronousBatch(qc.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=g,r=S;4===n&&(i=v,r=m);var a=!1;if(i<r)a=!j(e,t);else{var s=1,u=20;4===n&&(s=4,u=1),a=!0,function(e,t,n,i){for(;n<=t;){var r=z(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return 4===n?v-=a:g-=a,Q(El,[o],Cc.QueueFull),!0}n++}return B(),!1}(e.iKey,e.latency,s,u)&&(a=!j(e,t))}a&&J(El,[e],Cc.QueueFull)}function D(e,t,n){var i=W(e,t,n);return o.sendQueuedRequests(t,n),i}function L(){return g>0}function _(){if(b>=0&&W(b,0,u)&&o.sendQueuedRequests(0,u),v>0&&!T&&!h){var e=y[E][2];e>=0&&(T=F((function(){T=null,D(4,0,1),_()}),e))}var t=y[E][1];!I&&!f&&t>=0&&!h&&(L()?I=F((function(){I=null,D(0===C?3:1,0,1),C++,C%=2,_()}),t):C=0)}function M(){n=null,d=!1,p=[],f=null,h=!1,v=0,m=500,g=0,S=1e4,y={},E=wc,I=null,T=null,A=0,C=0,r=null,w={},a=void 0,s=0,b=-1,u=null,R=!0,O=!1,P=6,k=2,c=null,l=yl(),o=new ml(500,2,1,{requeue:K,send:Y,sent:Z,drop:ee,rspFail:te,oth:ne},l),q(),w[4]={batches:[],iKeyMap:{}},w[3]={batches:[],iKeyMap:{}},w[2]={batches:[],iKeyMap:{}},w[1]={batches:[],iKeyMap:{}},ie()}function F(e,t){0===t&&A&&(t=1);var n=1e3;return A&&(n=Qc(A-1)),l.set(e,t*n)}function U(){return null!==I&&(l.clear(I),I=null,C=0,!0)}function H(e,t){U(),f&&(l.clear(f),f=null),h||D(1,e,t)}function z(e,t,n){var i=w[t];i||(i=w[t=1]);var r=i.iKeyMap[e];return!r&&n&&(r=qc.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function V(t,n){o.canSendRequest()&&!A&&(a>0&&g>a&&(n=!0),n&&null==f&&e.flush(t,null,20))}function j(e,t){R&&(e=mo(e));var n=e.latency,i=z(e.iKey,n,!0);return!!i.addEvent(e)&&(4!==n?(g++,t&&0===e.sendAttempt&&V(!e.sync,s>0&&i.count()>=s)):v++,!0)}function B(){for(var e=0,t=0,n=function(n){var i=w[n];i&&i.batches&&Zr(i.batches,(function(i){4===n?e+=i.count():t+=i.count()}))},i=1;i<=4;i++)n(i);g=t,v=e}function W(t,n,i){var r=!1,a=0===n;return!a||o.canSendRequest()?ku(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var i=w[n];i&&i.batches&&i.batches.length>0&&(Zr(i.batches,(function(t){o.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),4===n?v-=t.count():g-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&J(El,e,Cc.KillSwitch),r&&b>=t&&(b=-1,u=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!a):(b=b>=0?Math.min(b,t):t,u=Math.max(u,i)),r}function G(e,t){D(1,0,t),B(),$((function(){e&&e(),p.length>0?f=F((function(){f=null,G(p.shift(),t)}),0):(f=null,_())}))}function $(e){o.isCompletelyIdle()?e():f=F((function(){f=null,$(e)}),.25)}function q(){(y={})[wc]=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function K(t,n){var i=[],r=P;O&&(r=k),Zr(t,(function(t){t&&t.count()>0&&Zr(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<r?(Sc(t,e.identifier),x(t,!1)):i.push(t))}))})),i.length>0&&J(El,i,Cc.NonRetryableStatus),O&&H(2,2)}function X(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){os(e.diagLog(),1,74,t+" notification failed: "+n)}}function J(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&X(e,[t].concat(n))}function Q(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&Zr(t,(function(t){t&&t.count()>0&&X(e,[t.events()].concat(n))}))}function Y(e,t,n){e&&e.length>0&&X("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Z(e,t){Q("eventsSent",e,t),_()}function ee(e,t){Q(El,e,t>=8e3&&t<=8999?t-8e3:Cc.Unknown)}function te(e){Q(El,e,Cc.NonRetryableStatus),_()}function ne(e,t){Q(El,e,Cc.Unknown),_()}function ie(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,S/6)}M(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,u,d){ku(u,(function(){return"PostChannel:initialize"}),(function(){var p=u;t.initialize(s,u,d);try{u.addUnloadCb,c=fu(js(e.identifier),u.evtNamespace&&u.evtNamespace());var f=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=f.getExtCfg(e.identifier),l=yl(n.setTimeoutOverride,n.clearTimeoutOverride),R=!n.disableOptimizeObj&&!!Da("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(p),n.eventsLimitInMem>0&&(S=n.eventsLimitInMem),n.immediateEventLimit>0&&(m=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),Xr(n[Tl])&&(P=n[Tl]),Xr(n[Al])&&(k=n[Al]),ie(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),hc(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var h=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=u.getNotifyMgr(),o.initialize(h,e.core,e,r,n);var v=s.disablePageUnloadEvents||[];(function(e,t,n,i){var r=!1;t&&e&&qr(e)&&!(r=mu(e,t,n,i))&&n&&n[si]>0&&(r=mu(e,t,null,i))})([eu,Zs,Qs],i,v,c),Su(i,v,c),yu(N,s.disablePageShowEvents,c)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:u,extensions:d}}))},e.processTelemetry=function(t,i){Sc(t,e.identifier);var r=(i=e._getTelCtx(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;r&&(o=o||!!r.disableTelemetry);var a=t;o||d||(n[Il]&&(a.iKey=n[Il]),r&&r[Il]&&(a.iKey=r[Il]),x(a,!0),O?H(2,2):_()),e.processNext(a,i)},e._doTeardown=function(e,t){var n;H(2,2),d=!0,o.teardown(),gu([eu,Zs,Qs],null,c),n=fu(tu,c),gu([Qs],null,n),gu([Js],null,n),function(e,t){var n=fu(nu,t);gu([Ys],null,n),gu([Js],null,n)}(0,c),M()},e.setEventQueueLimits=function(e,t){S=e>0?e:1e4,a=t>0?t:0,ie();var n=g>e;if(!n&&s>0)for(var i=1;!n&&i<=3;i++){var r=w[i];r&&r.batches&&Zr(r.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}V(!0,n)},e.pause=function(){U(),h=!0,o.pause()},e.resume=function(){h=!1,o.resume(),_()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){U(),q(),E=wc,_(),Wr(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),y[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!h)if(n=n||1,e)null==f?(U(),W(1,0,n),f=F((function(){f=null,G(t,n)}),0)):p.push(t);else{var i=U();D(1,1,n),null!=t&&t(),i&&_()}},e.setMsaAuthTicket=function(e){o.addHeader(zc,e)},e.hasEvents=L,e._setTransmitProfile=function(e){E!==e&&void 0!==y[e]&&(U(),E=e,_())},e._backOffTransmission=function(){A<4&&(A++,U(),_())},e._clearBackOff=function(){A&&(A=0,U(),_())},oo(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=yl(e,l.clear)})),oo(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=yl(l.set,e)}))})),i}return Tu(t,e),t.__ieDyn=1,t}(Xu);var wl="HttpManager:_sendBatches",bl="PrivacyGuard:_processTelemetry",Rl=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Ol=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===wl||e===bl?new Rl(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case wl:this.handleSendBatches(e);break;case bl:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var i in n.batches)t+=n.batches[i].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),Pl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Cl;var i=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=r(r({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Ic),kl=function(e){function t(t,n){var i,o=e.call(this,t,n)||this;o.sendTelemetryEvent=function(e){return function(t,n){try{return void((r=o.getOneDSTelemetryEvent(e))&&i&&i.track(r))}catch(e){return void jt(1,"1DS Sink",e)}var r}()},o.sendCustomerContent=function(e){},o.sendNonStandardEvent=function(e,t){var n=!1;u.forEach((function(i){i.canHandle(t)&&(i.processEvent(e),n=!0)})),n||Vt(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},o.flush=function(e){null==i||i.flush(e),u.forEach((function(t){t.flush(e)}))},o.shutdown=function(){try{null==i||i.shutdown(),u.forEach((function(e){e.shutdown()}))}catch(e){Vt(0,2,(function(){return"An error occurred on shutdown"}))}};var a,s,u=n.nonStandardEventHandlers||[];if(i=function(e,t){var n=e.httpXHROverride,i={instrumentationKey:t,endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:r({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var i,r=n||t;r.data&&(null===(i=e.stats)||void 0===i||i.networkStats(r.data.length))});var o=new Pl;return o.initialize(i,e.plugins),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Ol(e.stats)),o}(n,wo),u.forEach((function(e){e.initialize(o,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return n.disableStatsTracking||(a=o,(s=i)&&s.addNotificationListener({eventsSent:function(e){Vt(2,2,(function(){return"Successfully sent ".concat(e.length," event(s)")})),Vt(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){Vt(0,2,(function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)})),Vt(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsDiscarded+=e.length}})),o}return i(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var i=[],r=!1,o=!0,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return r||10===t||110===t||120===t}},s={},u=Eu();this.init=function(e){return Lo(s,!1)},this.begin=function(){return o=o&&Lo(s,!0)},this.getOneDSTelemetryEvent=function(e){return c(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return c(e,{eventType:2})};var c=function(e,t){if(o){var r,a=nn(e);if(function(e,t){for(var n=function(n){var i=t[n];if(!i.processEvent(e))return Vt(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(i.name)})),{value:!1}},i=0;i<t.length;i++){var r=n(i);if("object"==typeof r)return r.value}return!0}(a,i)){var c=(r=a,r.timestamp?new Date(r.timestamp):new Date).toISOString(),l={"Event.Name":a.eventName,"Event.Source":"OTelJS","Event.Time":{value:c,propertyType:9}};for(var d in n.eventsProcessed++,l["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},l["Event.Id"]=u+"."+n.eventsProcessed,s)l[d]=s[d];if(!bo(l,a.dataFields,!0,t.eventType))return void Vt(0,1,(function(){return"Dropping Event: "+a.eventName}));var p="custom";a.eventContract&&(a.eventContract.name&&(l["Event.Contract"]=a.eventContract.name,p+="."+a.eventContract.name.toLowerCase().replace(/\./g,"_")),bo(l,a.eventContract.dataFields,!1,t.eventType));var f=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void Vt(0,1,(function(){return"Missing Aria Token"}))}(a,t.eventType);if(!f)return;return{iKey:f,name:a.eventName,data:l,time:c,baseType:p,ext:{sdk:{seq:n.eventsProcessed}}}}}};this.addPreprocessor=function(e){i.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return i};var l=function(e){bo(s,e,!1,1)};this.addPersistentDataFields=l,this.setOptionalEventsEnabled=function(e){r=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(r=!0),l(e);var d,p=t.coreFields;if(p){l(On(p.app)),l(bn(p.user)),l(Pn(p.session));var f=p.release;f&&l((In(d=[],"Release","AudienceGroup",f.audienceGroup,1),d))}this.addPreprocessor(a)})),Nl="Office.Telemetry.OTelJS.EventThrottled";function xl(e){return"number"==typeof e}var Dl,Ll,_l=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if(t===Nl)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):xl(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),xl(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,i){return!(e>t&&(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[i]&&(this._eventThrottleReported[i]=!0,this._telemetrySink.sendTelemetryEvent({eventName:Nl,telemetryProperties:{ariaTenantToken:wo,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[en("SinkName",this._sinkName||""),en("ThrottledEvent.Name",i),Zt(n,t)]})),Vt(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(i)})),1))},e}();(Ll=Dl||(Dl={})).USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",Ll.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",Ll.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",Ll.CUSTOMER_CONTENT="",Ll.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/";var Ml=n(6788);const Fl=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,5}","g"),Ul=(new URL("https://teams.microsoft.com/l/"),e=>!!e&&void 0!==e.user.id),Hl=e=>{let t;return t=e===bt.Public?Rt.Public:e===bt.EUDB?Rt.EUDB:Rt.Other,t};function zl(e){return e?((t=e)&&(t=t.replace(Fl,"email_removed")),t):"";var t}let Vl=()=>1e3*Date.now();"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Vl=()=>1e3*Math.floor(window.performance.now()));class jl{constructor(e,t,n){var i,r,o;this.hubInfo=e,this.customTelemetryService=n,this.letterRegex=/[a-zA-Z]/,this.consumerTid="9188040d-6c67-4c5b-b112-36a304b66dad",this.telemetrySource="AppHostSdk",this.namespace="Office.AppHostingSdk",this.eventFieldPrefix="AppHost",this.ariaTenantToken="7ada8d16f9234e2093f080920f21dd7d-41cee27e-93c2-4a6b-a7aa-2001e852d387-7123",this.nexusTenantToken=-1,this.anonymousDataFields=[...pn.Office.System.User.getFields("User",{isAnonymous:!0})];let s=[en(`${this.eventFieldPrefix}.HostName`,this.hubInfo.name),en(`${this.eventFieldPrefix}.HostVersion`,this.hubInfo.version),en(`${this.eventFieldPrefix}.HostSdkVersion`,a),en(`${this.eventFieldPrefix}.HostSessionId`,this.hubInfo.sessionId),en(`${this.eventFieldPrefix}.TelemetrySource`,this.telemetrySource),en(`${this.eventFieldPrefix}.Platform`,t.app.host.clientType===xt.web?"Web":"Desktop"),en(`${this.eventFieldPrefix}.HostRingId`,null!==(r=null===(i=this.appContext)||void 0===i?void 0:i.app.host.ringId)&&void 0!==r?r:"")];this.telemetryLogger=new Mn,this.telemetryLogger.setTenantToken(this.namespace,this.ariaTenantToken,this.nexusTenantToken);const u=Gl(t.user.dataResidency);if(u){this.oneDsSink=new kl(s,{endpointUrl:u});const e=new _l("HubSDKServiceEventThrottler",this.oneDsSink);e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.getContext")}`,1),e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.registerHandler")}`,1),e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.getAuthToken")}`,1),this.oneDsSink.addPreprocessor(e),this.telemetryLogger.telemetrySinks=[this.oneDsSink]}let c=On({name:"OfficeAppHostingSdk"});null===(o=this.oneDsSink)||void 0===o||o.addPersistentDataFields(c),this.setAppContext(t),this.isTest=void 0!==window.Cypress||function(){var e;return"undefined"!=typeof process&&void 0!==(null===(e=null===process||void 0===process?void 0:process.env)||void 0===e?void 0:e.JEST_WORKER_ID)}(),this.enableExtendedInitializationTracking=(null==n?void 0:n.enableExtendedInitializationTracking)||!1}createScenario(e,t,n=Date.now(),i){var r,o,a,s,u,c,l,d,p;t=null!=t?t:null===(r=this.appDefinition)||void 0===r?void 0:r.id;const f=this.isTest?void 0:this.telemetryLogger.createActivity(this.createTelemetryEvent(e,n,t,i)),h=null===(o=this.customTelemetryService)||void 0===o?void 0:o.createScenario(e,t,n),v=this.shouldLogToAria(e);{let e=en(`${this.eventFieldPrefix}.ActionId`,null!==(u=null===(s=null===(a=this.appContext)||void 0===a?void 0:a.actionInfo)||void 0===s?void 0:s.actionId)&&void 0!==u?u:""),t=en("ManifestVersion",null!==(l=null===(c=this.appDefinition)||void 0===c?void 0:c.manifestVersion)&&void 0!==l?l:"");return null===(d=this.oneDsSink)||void 0===d||d.addPersistentDataFields([e,t]),new Wl(this,v,n,h,f,null===(p=this.appDefinition)||void 0===p?void 0:p.isFullTrust)}}static getApiVersionTagForTelemetry(e,t){if(null!=t){if(null==e&&(0,Ml.satisfies)(t,jl.TEAMS_JS_LIBRARY_V1))return"v1";if(null==e&&(0,Ml.satisfies)(t,`>${jl.TEAMS_JS_LIBRARY_V2_LOWEST_VERSION}`)&&(0,Ml.satisfies)(jl.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG,`>${t}`))return"unknown";if(e&&(0,Ml.satisfies)(t,`>=${jl.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG}`))return e}return null==e?"undefined_tag":e}setAppSdkVersion(e){this.appSdkVersion=e}setAppContext(e){var t,n,i,r,o,a,s;let u=this.appContext;if(this.appContext=e,this.oneDsSink){if(Ul(e)&&(!Ul(u)||e.user.id!==u.user.id)){let a,s=!e.user.id;if(s)a=this.anonymousDataFields;else{let u=(null===(n=null===(t=this.appContext.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.id)!==this.consumerTid;a=bn({primaryIdentityHash:null===(i=e.user)||void 0===i?void 0:i.id,primaryIdentitySpace:u?"UserObjectId":"MSAPuid",tenantId:null===(o=null===(r=this.appContext.user)||void 0===r?void 0:r.tenant)||void 0===o?void 0:o.id,tenantGroup:u?"Commercial":"Consumer",isAnonymous:s})}this.oneDsSink.addPersistentDataFields(a)}if(this.appContext.app.sessionId!==(null==u?void 0:u.app.sessionId)){let e=Pn({id:null!==(a=this.appContext.app.sessionId)&&void 0!==a?a:""});this.oneDsSink.addPersistentDataFields(e)}if(this.appContext.app.locale!==(null==u?void 0:u.app.locale)){let e=en("Culture.UiLanguage",null!==(s=this.appContext.app.locale)&&void 0!==s?s:"");this.oneDsSink.addPersistentDataFields([e])}}}setAppDefinition(e){this.appDefinition=e}isSessionIdSet(){var e;return!!(null===(e=this.appContext)||void 0===e?void 0:e.app.sessionId)}createTelemetryEvent(e,t,n,i){var r,o,a,s,u,c,l,d,p;return{eventName:`${this.namespace}.${this.sanitizeScenarioName(e)}`,eventFlags:{dataCategories:2,diagnosticLevel:110},dataFields:[en("HostedAppId",null!=n?n:""),en("HostedAppEntityId",null!==(a=null===(o=null===(r=this.appContext)||void 0===r?void 0:r.page)||void 0===o?void 0:o.id)&&void 0!==a?a:""),en(jl.APPSDK_VERSION_FIELD_NAME,null!==(s=this.appSdkVersion)&&void 0!==s?s:""),en(jl.APPSDK_API_VERSION_TAG_FIELD_NAME,jl.getApiVersionTagForTelemetry(i,this.appSdkVersion)),en("HostedAppFrameContext",null!==(l=null===(c=null===(u=this.appContext)||void 0===u?void 0:u.page)||void 0===c?void 0:c.frameContext)&&void 0!==l?l:""),en("HostedAppSessionId",null!==(p=null===(d=this.appContext)||void 0===d?void 0:d.app.sessionId)&&void 0!==p?p:"")],timestamp:t}}sanitizeScenarioName(e){let t="",n=!0;for(let i=0;i<e.length;i++){let r=e.charAt(i);"."===r&&0!==i&&"."!==t.charAt(t.length-1)?(t+=r,n=!0):this.letterRegex.test(r)?n?(n=!1,t+=r.toUpperCase()):t+=r:n=!0}return t}shouldLogToAria(e){return!e.startsWith("eventDispatch")&&"appInitializationExtended"!==e}}jl.TEAMS_JS_LIBRARY_V1="1.x",jl.TEAMS_JS_LIBRARY_V2_LOWEST_VERSION="2.0.0-beta.0",jl.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG="2.21.0",jl.APPSDK_VERSION_FIELD_NAME="HostedAppSdkVersion",jl.APPSDK_API_VERSION_TAG_FIELD_NAME="HostedAppSdkApiVersionTag";class Bl{constructor(e,t,n,i,r){this.logger=e,this.shouldLogToAria=t,this.clientTimestamp=n,this.customScenario=i,this.activity=r,this.lastMark=(e=>{const t=Date.now();return Vl()-1e3*(t-e)})(n)}addOrUpdateActivityStringDataField(e,t){var n,i,r;let o=null===(n=this.activity)||void 0===n?void 0:n.dataFields.find((t=>t.name==e));o?o.value=t:null===(r=null===(i=this.activity)||void 0===i?void 0:i.dataFields)||void 0===r||r.push(en(e,t))}markPhase(e){var t,n,i;const r=Vl(),o=r-this.lastMark;this.lastMark=r,null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(Zt(`Activity.Phase.${e}`,o)),null===(i=this.customScenario)||void 0===i||i.markPhase(e)}stop(){var e;this.endActivity(!0),null===(e=this.customScenario)||void 0===e||e.stop()}fail(e){var t,n,i;null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(en("ErrorMessage",zl(e))),this.endActivity(!1),null===(i=this.customScenario)||void 0===i||i.fail(e)}endActivity(e){this.shouldLogToAria&&this.activity&&this.logger.isSessionIdSet()&&(this.activity.success=e,this.activity.endNow())}}class Wl extends Bl{constructor(e,t,n,i,r,o){super(e,t,n,i,r),this.logger=e,this.shouldLogToAria=t,this.clientTimestamp=n,this.customScenario=i,this.activity=r,this.isFullTrust=o}fail(e,t){var n,i,r;null===(i=null===(n=this.activity)||void 0===n?void 0:n.dataFields)||void 0===i||i.push(en("ErrorMessage",zl(e))),this.endActivity(!1),null===(r=this.customScenario)||void 0===r||r.fail(this.isFullTrust&&t?e.concat(":",t):e)}}const Gl=e=>{switch(e){case bt.EUDB:return Dl.EUDB;case bt.DOD:return Dl.USGOV_DOD;case bt.DOJ:return Dl.USGOV_DOJ;case bt.Public:return Dl.PUBLIC;default:return}};var $l,ql,Kl,Xl,Jl,Ql;!function(e){e.Unknown="Unknown",e.Windows="Windows",e.iOS="iOS",e.Android="Android",e.Linux="Linux",e.tvOS="tvOS",e.MacOS="MacOS"}($l||($l={})),function(e){e.Unknown="Unknown",e.EXO="EXO",e.SPO="SPO",e.OXO="OXO",e.MileIQ="MileIQ",e.AFS="AFS",e.Teams="Teams",e.Stream="Stream",e.ODB="ODB",e.MicrosoftPowerBI="MicrosoftPowerBI",e.Yammer="Yammer"}(ql||(ql={})),function(e){e.NotSpecified="NotSpecified",e.User="User",e.System="System"}(Kl||(Kl={})),function(e){e.Unknown="Unknown",e.Anonymous="Anonymous",e.AAD="AAD",e.MSA="MSA",e.Self="Self"}(Xl||(Xl={})),function(e){e.Unknown="Unknown",e.AccessControlData="AccessControlData",e.CustomerContent="CustomerContent",e.EUII="EUII",e.OII="OII",e.AccountData="OII",e.SystemMetaData="SystemMetaData"}(Jl||(Jl={})),function(e){e.ApplicationEngaged="ApplicationEngaged"}(Ql||(Ql={}));class Yl{constructor(e,t,n){var i,r,s;this.appSdkHost=e,this.hubServices=t,this.appContext=n,this.getDefaultSignalAuthToken=()=>o(this,void 0,void 0,(function*(){var e;if(!(null===(e=this.hubServices.authenticationService)||void 0===e?void 0:e.acquireToken))throw new Error("Cancelled since service is not available.");const t=yield this.hubServices.authenticationService.acquireToken(Yl.DEFAULT_SIGS_RESOURCE_URL,void 0,!0);if(t&&t.token)return t.token;throw new Error("Empty token response.")})),this.delay=e=>new Promise((t=>{var n;setTimeout(t,Math.pow(null!==(n=this.jestDelay)&&void 0!==n?n:100,e))}));const u=this.appSdkHost.getAppDefinition();this.actorInfo={ActorId:Xl.Self,ActorIdType:Xl.Self,ActorType:Kl.User,AadTenantId:Xl.Self},this.applicationInfo={AppName:"",AadAppId:null!==(i=null==u?void 0:u.id)&&void 0!==i?i:"",Workload:this.getWorkLoad(null===(r=this.appContext)||void 0===r?void 0:r.app.host.name)},this.deviceInfo={Os:this.getOs(),UserAgent:window.navigator.userAgent},this.commonCustomProperties={HubName:null===(s=this.appContext)||void 0===s?void 0:s.app.host.name,MetaOSHubSDKVersion:a}}createSignal(e){return{SignalType:e.signalType,Compliance:Jl.CustomerContent,CV:this.appContext.app.sessionId,StartTime:this.getDateTime(e.startTime),EndTime:this.getDateTime(e.endTime),Application:Object.assign({},this.applicationInfo),Actor:Object.assign({},this.actorInfo),Device:Object.assign({},this.deviceInfo),CustomProperties:Object.assign(Object.assign({},this.commonCustomProperties),e.customProperties)}}getDateTime(e){return e&&e>0?new Date(e):new Date}getWorkLoad(e){switch(e){case Ot.office||Ot.outlookWin32||Ot.office:return ql.OXO;case Ot.teams||Ot.teamsModern:return ql.Teams;default:return ql.Unknown}}getOs(){let e="Unknown";if(window&&window.navigator.userAgent){let t=window.navigator.userAgent;-1!=t.indexOf("Windows")?e="Windows":-1!=t.indexOf("Mac OS")?e="MacOS":-1!=t.indexOf("Android")?e="Android":-1!=t.indexOf("Linux")?e="Linux":/iPad|iPhone|iPod/.test(t)&&(e="iOS")}return e}sendSignal(e,t){return new Promise(((n,i)=>o(this,void 0,void 0,(function*(){if(t)n(this.postSignalWithRetry(e,t,1));else try{const t=yield this.getDefaultSignalAuthToken();n(this.postSignalWithRetry(e,t,1))}catch(e){i(e)}}))))}postSignalWithRetry(e,t,n){return n>Yl.RETRY_LIMIT?Promise.reject("Retry Limit reached. Unable to send Signal."):fetch(Yl.SIGS_ENDPOINT,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json","X-SignalInstanceId":e.CV,Authorization:"Bearer "+t}}).catch((e=>Promise.reject(e))).then((i=>o(this,void 0,void 0,(function*(){return i&&i.ok?Promise.resolve(e.CV):i&&Yl.RETRY_CODES.has(i.status)?(yield this.delay(n),this.postSignalWithRetry(e,t,++n)):Promise.reject(i)}))))}}function Zl(e,t,n){return o(this,void 0,void 0,(function*(){try{let n=yield e.getAppContext();if(n.page.frameContext!=Dt.authentication){const i=new Yl(e,t,n),r=i.createSignal({signalType:Ql.ApplicationEngaged,startTime:e.getUserClickTime(),endTime:Date.now()});let o=yield i.sendSignal(r);e.getLogger().log(mt.Debug,"sendAppEngageSignal","Successfully posted the signal",o)}}catch(t){let i=t;if("status"in t){i=t.status+"";const e=null==n?void 0:n.createScenario("sigsSendSignalFailure");null==e||e.fail(i)}e.getLogger().log(mt.Error,"sendAppEngageSignal","Error occurred while sending substrate signal",i)}}))}Yl.SIGS_ENDPOINT="https://substrate.office.com/sigsapi/v1.0/Me/Signals",Yl.RETRY_LIMIT=2,Yl.RETRY_CODES=new Set([503]),Yl.DEFAULT_SIGS_RESOURCE_URL="https://outlook.office.com";class ed{constructor(){this.items=new Map,this.add=e=>{if(e){const t=e.toLowerCase();if(!this.items.has(t))return this.items.set(t,e),!0}return!1},this.values=()=>Array.from(this.items.values())}}let td={wildcardValidDomainRuleDetection:!0,extendedAppLoadTimeoutInMillis:void 0,authExtensionContextForUrlValidation:!0,escapeRegExSpecialCharactersInValidDomains:!0};function nd(){return td}const id=e=>e&&new URL(e).host,rd=/([\[\]\^\$\|\(\)\\\.\+\*\?\{\}\=\!\<\>\-])/gi,od=(e,t,n,i)=>{try{return void 0!==n&&pd(new URL(e),sd(n,i),t)}catch(e){return t.log(mt.Error,"isValidOriginForApp","Invalid origin",null),!1}},ad=e=>{let t=[];for(const n of e)n.match(Qe)||t.push(n);return t},sd=(e,t)=>{var n,i,r;const o=new ed;return e.validDomains&&e.validDomains.forEach((e=>o.add(dd(e,t)))),null===(n=e.pages.configurable)||void 0===n||n.forEach((e=>o.add(id(ld(e.configurationUrl,t))))),null===(i=e.pages.static)||void 0===i||i.forEach((e=>{e.contentUrl&&o.add(id(ld(e.contentUrl,t)))})),(null===(r=null==e?void 0:e.connector)||void 0===r?void 0:r.configurationUrl)&&o.add(id(e.connector.configurationUrl)),Array.from(o.values())},ud=(e,t)=>{const n="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",t);if(!new RegExp(n,"i").test(e))throw"Resource is not valid"},cd=(e,t,n,i,r)=>{let o=!0;return i?t.forEach((t=>{var r;if(o){const a=ld(t,n);let s=!1;null===(r=i.resources)||void 0===r||r.forEach((i=>{if(!s&&i){const r=ld(i.resource,n);if(a===r)if(i.requireOriginMatch){try{const n=new URL(e),i=new URL(t);n.hostname===i.hostname&&(s=!0)}catch(e){}e===r&&(s=!0)}else s=!0}})),s||(o=!1)}})):o=!1,o?(r&&ud(t[0],r),Promise.resolve(t)):Promise.reject("App resource defined in manifest and iframe origin do not match")},ld=(e,t)=>{var n,i,r,o,a,s,u,c,l,d,p,f;if(!t)return e;const h=void 0!==t.page?t:void 0,v={teamSiteDomain:(null===(n=null==h?void 0:h.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",teamSitePath:(null===(i=null==h?void 0:h.sharePointSite)||void 0===i?void 0:i.teamSitePath)||"",teamSiteUrl:(null===(r=null==h?void 0:h.sharePointSite)||void 0===r?void 0:r.teamSiteUrl)||"",mySiteDomain:(null===(o=null==h?void 0:h.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||"",mySitePath:(null===(a=null==h?void 0:h.sharePointSite)||void 0===a?void 0:a.mySitePath)||"",channelRelativeUrl:(null===(s=null==h?void 0:h.channel)||void 0===s?void 0:s.relativeUrl)||"",sharePointSite:{teamSiteDomain:(null===(u=null==h?void 0:h.sharePointSite)||void 0===u?void 0:u.teamSiteDomain)||"",teamSitePath:(null===(c=null==h?void 0:h.sharePointSite)||void 0===c?void 0:c.teamSitePath)||"",teamSiteUrl:(null===(l=null==h?void 0:h.sharePointSite)||void 0===l?void 0:l.teamSiteUrl)||"",mySiteDomain:(null===(d=null==h?void 0:h.sharePointSite)||void 0===d?void 0:d.mySiteDomain)||"",mySitePath:(null===(p=null==h?void 0:h.sharePointSite)||void 0===p?void 0:p.mySitePath)||""},channel:{relativeUrl:(null===(f=null==h?void 0:h.channel)||void 0===f?void 0:f.relativeUrl)||""}};return vd(e,v)},dd=(e,t)=>{var n,i,r,o;if(!t)return e;const a={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",mySiteDomain:(null===(i=t.sharePointSite)||void 0===i?void 0:i.mySiteDomain)||"",sharePointSite:{teamSiteDomain:(null===(r=t.sharePointSite)||void 0===r?void 0:r.teamSiteDomain)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||""}};return vd(e,a)},pd=(e,t,n)=>{const i=hd(e),r=new ed;let o=[...t];const a=ad([...t]);a.length>0&&(n.log(mt.Debug,"isUrlInDomainList",`Invalid domain detected with ${a}}`),nd().wildcardValidDomainRuleDetection&&(o=o.filter((e=>!a.includes(e)))));for(const e of o){if(!r.add(e))continue;const t=fd(e),n=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(i.match(n))return!0}return!1},fd=e=>{if(!0===nd().wildcardValidDomainRuleDetection&&ad([e]).length>0)throw new Error("The wildcardValidDomainRuleDetection flag is enabled and an improper wildcard domain segment was detected: "+e);return e.split(".").join("[.]").split("*").join("[^/^.]+")},hd=e=>e.href,vd=(e,t,n=[])=>{const i=e.indexOf("?");let r="",o="";return i>0?(r=e.substring(0,i),o=e.substring(i)):r=e,r&&(r=md(r,t,n,(e=>encodeURI(e)))),o&&(o=md(o,t,n,(e=>encodeURIComponent(e)))),r+o},md=(e,t,n=[],i)=>{if(void 0!==t)if("object"==typeof t)for(const r in t)e=md(e,t[r],n.concat(r),i);else{const r=n.join("."),o=new RegExp(`{${r.replace(".","\\.")}}`,"g");e=e.replace(o,i(t))}return e};const gd={"appInstallDialog.openAppInstallDialog":"api.appInstallDialog.openAppInstallDialog",[d]:"api.getAuthToken",[p]:"api.getUser",[f]:"api.authentication.authenticate",[v]:"api.authentication.notifyFailure",[h]:"api.authentication.notifySuccess","appEntity.selectAppEntity":"api.appEntity.selectAppEntity","media.scanBarCode":"api.barCode.scanBarCode",[m]:"api.calendar.composeMeeting",[g]:"api.calendar.openCalendarItem","call.startCall":"api.call.startCall","chat.openChat":"api.chat.openChat",[S]:"api.clipboard.writeToClipboard",[y]:"api.clipboard.readFromClipboard",[E]:"api.conversations.openConversation",[I]:"api.conversations.closeConversation",[T]:"api.conversations.getChatMembers",[A]:"api.dialogs.open",[C]:"api.dialogs.submit",[w.resize]:"api.dialogs.update.resize",[P]:"api.externalAppAuthentication.authenticateAndResendRequest",[k]:"api.externalAppAuthentication.authenticateWithSSO",[N]:"api.externalAppAuthentication.authenticateWithSSOAndResendRequest",[x]:"api.externalAppAuthentication.authenticateWithOauth2",[R]:"api.externalAppCardActions.processActionSubmit",[b]:"api.externalAppCardActions.processActionOpenUrl",[O]:"api.externalAppCommands.processActionCommand",[F]:"api.files.openFilePreview",[M]:"api.files.getCloudStorageFolders",[D]:"api.files.addCloudStorageFolder",[_]:"api.files.deleteCloudStorageFolder",[L]:"api.files.copyMoveFiles",[U]:"api.files.getExternalProviders",[H]:"api.files.getCloudStorageFolderContents",[z]:"api.getContext",[W]:"api.interactive.getFluidTenantInfo",[G]:"api.interactive.getFluidToken",[$]:"api.interactive.getFluidContainerId",[q]:"api.interactive.setFluidContainerId",[K]:"api.interactive.getNtpTime",[X]:"api.interactive.registerClientId",[J]:"api.interactive.getClientRoles",[Q]:"api.interactive.getClientInfo",executeDeepLink:"api.links.openLink",[j]:"api.location.getCurrentLocation",[B.showLocation]:"api.location.map.showLocation",[Z]:"api.mail.openMailItem",[Y]:"api.mail.composeMail",[ee]:"api.marketplace.getCart",[te]:"api.marketplace.addOrUpdateCartItems",[ne]:"api.marketplace.removeCartItems",[ie]:"api.marketplace.updateCartStatus",[re]:"api.media.captureImage",[oe]:"api.media.getMedia",[ae]:"api.media.selectMedia",[se]:"api.media.viewImages",[ue]:"api.meeting.getAppContentStageSharingCapabilities",[ce]:"api.meeting.getAppContentStageSharingState",[Te]:"api.meeting.joinMeeting",[le]:"api.meeting.getAuthenticationTokenForAnonymousUser",[de]:"api.meeting.getIncomingClientAudioState",[pe]:"api.meeting.getLiveStreamState",[fe]:"api.meeting.getMeetingDetails",[ve]:"api.meeting.requestStartLiveStreaming",[me]:"api.meeting.requestStopLiveStreaming",[ge]:"api.meeting.shareAppContentToStage",[Se]:"api.meeting.stopSharingAppContentToStage",[he.setOptions]:"api.meeting.appShareButton.setOptions",[ye]:"api.meeting.toggleIncomingClientAudio",[Ee]:"api.meeting.requestAppAudioHandling",[Ie]:"api.meeting.updateMicState","monetization.openPurchaseExperience":"api.monetization.openPurchaseExperience",[Ae]:"api.meetingRoom.getPairedMeetingRoomInfo",[Ce]:"api.meetingRoom.sendCommandToPairedMeetingRoom","notifications.showNotification":"api.notifications.showNotification",[Le.setConfig]:"api.pages.config.setConfig",[Le.remove.failure]:"api.pages.config.remove.failure",[Le.remove.success]:"api.pages.config.remove.success",[Le.save.failure]:"api.pages.config.save.failure",[Le.save.success]:"api.pages.config.save.success",[Le.setValidityState]:"api.pages.config.setValidityState",[xe.navigateTo]:"api.pages.currentApp.navigateTo",[xe.navigateToDefaultPage]:"api.pages.currentApp.navigateToDefaultPage",[Ne.navigateBack]:"api.pages.backStack.navigateBack",[_e.enterFullscreen]:"api.pages.fullTrust.enterFullscreen",[_e.exitFullscreen]:"api.pages.fullTrust.exitFullscreen",[we]:"api.pages.getConfig",[be]:"api.pages.navigateCrossDomain",[Re]:"api.pages.navigateToApp",[Oe]:"api.pages.returnFocus",[ke]:"api.pages.shareDeepLink",[Pe]:"api.pages.setCurrentFrame",[De.getMruTabInstances]:"api.pages.tabs.getMruTabInstances",[De.getTabInstances]:"api.pages.tabs.getTabInstances",[De.navigateToTab]:"api.pages.tabs.navigateToTab","people.selectPeople":"api.people.selectPeople",[Me.getPermissionStatus]:"api.permissions.storageService.getPermissionStatus",[Fe]:"api.permissions.requestUserConsentForPermission","profile.showProfile":"api.profile.showProfile",[Ue]:"api.remoteCamera.getCapableParticipants",[He]:"api.remoteCamera.requestControl",[ze]:"api.remoteCamera.sendControlCommand",[Ve]:"api.remoteCamera.terminateSession",registerHandler:"api.registerHandler",[je]:"api.search.unregister",[Be]:"api.search.closeSearch","stageView.open":"api.stageView.open",[We]:"api.teams.getTeamChannels",[Ge]:"api.teams.refreshSiteUrl",[$e.joinedTeams.getUserJoinedTeams]:"api.teams.fullTrust.joinedTeams.getUserJoinedTeams",[$e.getConfigSetting]:"api.teams.fullTrust.getConfigSetting"};St.INTERNAL_ERROR,yt.INTERNAL_ERROR;const Sd=(e,t)=>({errorCode:e,message:t}),yd=e=>o(void 0,void 0,void 0,(function*(){return null!=e?{kind:"appResponse",data:e}:{kind:"appResponse"}})),Ed={kind:"logResponse"},Id=(e,...t)=>o(void 0,void 0,void 0,(function*(){return yield e(...t),Ed})),Td=e=>{const t="An unknown error occurred that could not be converted into a string description.";return(e=>void 0!==(null==e?void 0:e.errorCode))(e)||e instanceof Error?e.message||t:"string"==typeof e?e:"object"==typeof e&&JSON.stringify(e)||t};class Ad{constructor(e,t){this.appSdkHost=e,this.telemetryService=t,this.handlers={},this.appDefinition=this.appSdkHost.getAppDefinition(),this.isTelemetryHandledByExecutor=!1}registerHandler(e,t,n){var i;this.handlers[e]={callback:t,scenarioName:null!==(i=null==n?void 0:n.scenarioName)&&void 0!==i?i:gd[e],errorCallback:null==n?void 0:n.errorCallback,isRestrictedToFullTrustApps:null==n?void 0:n.isRestrictedToFullTrustApps,isRestrictedToFullTrustOrLobApps:null==n?void 0:n.isRestrictedToFullTrustOrLobApps,isRestrictedToMicrosoftOwnedApps:null==n?void 0:n.isRestrictedToMicrosoftOwnedApps}}deleteMessageHandling(e){delete this.handlers[e]}canHandleMessage(e){return this.validateInitialization(e)&&void 0!==this.handlers[e]}isAnAuthUXScenario(e){return e===gd[P]||e===gd[x]}canPassScenarioToHandler(e){return e===gd[P]||e===gd[k]||e===gd[N]||e===gd[x]||e===gd[b]||e===gd[R]||e===gd[O]}handleMessage(e,t,n,i){var r,a,s,u,c;return o(this,void 0,void 0,(function*(){if(!this.validateInitialization(t))return Promise.reject("SDK context is not initialized");if(!this.canHandleMessage(t))return Promise.reject(`Handler cannot handle message: ${t}`);const o=this.handlers[t];let l;!this.isTelemetryHandledByExecutor&&o.scenarioName&&(l=this.telemetryService.createScenario(o.scenarioName,null===(r=this.appDefinition)||void 0===r?void 0:r.id,i,e),i&&l.markPhase("MessageDelay"),this.canPassScenarioToHandler(o.scenarioName)&&n.push(l));try{if(o.isRestrictedToFullTrustApps&&!(null===(a=this.appSdkHost.getAppDefinition())||void 0===a?void 0:a.isFullTrust))throw Sd(St.INTERNAL_ERROR,nt);if(o.isRestrictedToMicrosoftOwnedApps&&!(null===(s=this.appSdkHost.getAppDefinition())||void 0===s?void 0:s.isMicrosoftOwned))throw Sd(St.INTERNAL_ERROR,nt);if(o.isRestrictedToFullTrustOrLobApps&&!(null===(u=this.appSdkHost.getAppDefinition())||void 0===u?void 0:u.isFullTrust)&&!(null===(c=this.appSdkHost.getAppDefinition())||void 0===c?void 0:c.isLOB))throw Sd(St.INTERNAL_ERROR,nt);if(!this.appSdkHost.checkIfCachedAndRequestAllowed(t))throw"Request not allowed when cached";this.validateDependencies(t);const e=yield o.callback.apply(this,n);return this.isAnAuthUXScenario(o.scenarioName)||null==l||l.stop(),e}catch(e){const t=Td(e);return this.appSdkHost.getLogger().log(mt.Error,"handleMessage","Error in handling message",t),o.errorCallback?o.errorCallback(e,l):(null==l||l.fail(t),Promise.reject(e))}}))}validateInitialization(e){return e===V||this.appSdkHost.isInitialized()}validateDependencies(e){}cleanup(){}}function Cd(e,t){const n=e,i=t;return n[i],function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(n,["symbol"==typeof i?i:i+""])}const wd=[{versionToDowngradeFrom:3,downgradeToPreviousVersion:e=>({apiVersion:2,hostVersionsInfo:e.hostVersionsInfo,supports:Cd(e.supports,"clipboard")})},{versionToDowngradeFrom:2,downgradeToPreviousVersion:e=>{var t,n,i,r,o;return{apiVersion:1,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{bot:null===(i=null===(n=null===(t=e.supports)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.url)||void 0===i?void 0:i.bot,card:null===(r=e.supports.dialog)||void 0===r?void 0:r.card,update:null===(o=e.supports.dialog)||void 0===o?void 0:o.update}:void 0})}}}];class bd extends Ad{constructor(e,t,n,i,r,o){var a,s,u,c,l;super(e,n),this.appSdkHost=e,this.hubServices=t,this.telemetryService=n,this.hostVersionsInfo=i,this.usingCachedApp=r,this.isNAAChannelRecommended=o,this.initializationStatusReported=!1,this.setupAppLoadTimer=()=>{var e;const t=null!==(e=nd().extendedAppLoadTimeoutInMillis)&&void 0!==e?e:3e4;return this.usingCachedApp?window.setTimeout((()=>{var e;this.appSdkHost.setAppInitInfo({state:gt.Failed,reason:qe.AppInitTimeout}),this.failAppInitializationScenario("Cached app load timed out"),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.fail("Cached app load timed out")}),t):this.registerAppInitMessageHandlers?window.setTimeout((()=>{var e;this.appSdkHost.setAppInitInfo({state:gt.Failed,reason:qe.AppInitTimeout}),this.failAppInitializationScenario("App Load timed out"),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.fail("App Load timed out")}),t):window.setTimeout((()=>{var e;this.failAppInitializationScenario("SDK initialization timed out"),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.fail("SDK initialization timed out")}),15e3)},this.stopAppInitializationScenario=()=>{var e;this.clearTimeoutTimer(),null===(e=this.appInitializationScenario)||void 0===e||e.stop()},this.failAppInitializationScenario=(e,t)=>{var n;this.clearTimeoutTimer(),null===(n=this.appInitializationScenario)||void 0===n||n.fail(e,t)},this.clearTimeoutTimer=()=>{window.clearTimeout(this.appLoadTimerId)},this.appSdkHost.startAppInitializationScenario(),this.appInitializationScenario=null===(a=this.appSdkHost)||void 0===a?void 0:a.getAppInitializationScenario(),null===(s=this.appInitializationScenario)||void 0===s||s.markPhase("ClickToBeginLoad"),this.registerAppInitMessageHandlers=(null===(u=e.getAppDefinition())||void 0===u?void 0:u.showLoadingIndicator)||!1,(null==n?void 0:n.enableExtendedInitializationTracking)&&(this.extendedAppInitializationScenario=null===(c=this.telemetryService)||void 0===c?void 0:c.createScenario("appInitializationExtended"),null===(l=this.extendedAppInitializationScenario)||void 0===l||l.markPhase("ClickToBeginLoad")),this.appLoadTimerId=this.setupAppLoadTimer()}initHandlers(){this.registerHandler(V,this.initialize),this.registerHandler(z,this.getContext,{errorCallback:this.onGetContextError}),this.registerHandler("readyToUnload",this.readyToUnload),this.registerHandler(s,this.handleAppLoaded),this.registerHandler(l,this.handleSuccess),this.registerHandler(c,this.handleFailure),this.registerHandler(u,this.handleExpectedFailure)}updateAppSdkVersion(e,t){t.forEach((t=>{null==t||t.addOrUpdateActivityStringDataField(jl.APPSDK_VERSION_FIELD_NAME,e)}))}updateAppSdkApiVersionTag(e,t,n){const i=e.data.apiVersionTag;n.forEach((e=>{null==e||e.addOrUpdateActivityStringDataField(jl.APPSDK_API_VERSION_TAG_FIELD_NAME,jl.getApiVersionTagForTelemetry(t,i))}))}initialize(e,t,n){var i,r,o,a,s,u,c,l,d,p,f,h;n||(n=1),null===(i=this.appInitializationScenario)||void 0===i||i.markPhase("BeginLoadToInitialized"),null===(r=this.extendedAppInitializationScenario)||void 0===r||r.markPhase("BeginLoadToInitialized"),null===(o=this.telemetryService)||void 0===o||o.setAppSdkVersion(t),this.updateAppSdkVersion(t,[this.appInitializationScenario,this.extendedAppInitializationScenario]),this.updateAppSdkApiVersionTag(e,t,[this.appInitializationScenario,this.extendedAppInitializationScenario]),this.registerAppInitMessageHandlers||(this.appSdkHost.setAppInitInfo({state:gt.Loaded}),this.stopAppInitializationScenario(),Zl(this.appSdkHost,this.hubServices,this.telemetryService)),this.appSdkHost.setInitialized(!0);const v=this.appSdkHost.getHubInfo();let m={apiVersion:3,hostVersionsInfo:this.hostVersionsInfo,isNAAChannelRecommended:null!==(a=this.isNAAChannelRecommended)&&void 0!==a&&a,supports:{app:{},appInstallDialog:this.hubServices.appInstallDialogService?{}:void 0,appEntity:this.hubServices.appEntityService?{}:void 0,barCode:this.hubServices.barCodeService?{}:void 0,calendar:this.hubServices.calendarService?{}:void 0,call:this.hubServices.callService?{}:void 0,chat:this.hubServices.chatService?{}:void 0,clipboard:navigator&&navigator.clipboard?{}:void 0,conversations:this.hubServices.conversationsService?{}:void 0,dialog:this.hubServices.dialogService?{card:this.hubServices.dialogService.cardService&&this.hostVersionsInfo&&this.hostVersionsInfo.adaptiveCardSchemaVersion&&(g=this.hostVersionsInfo.adaptiveCardSchemaVersion,!(g.majorVersion<1||1==g.majorVersion&&g.minorVersion<5))?{bot:this.hubServices.dialogService.cardService.cardBotService?{}:void 0}:void 0,update:this.hubServices.dialogService.updateService?{}:void 0,url:this.hubServices.dialogService.urlService?{bot:this.hubServices.dialogService.urlService.urlBotService?{}:void 0}:void 0}:void 0,externalAppAuthentication:this.hubServices.externalAppChannelService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppCardActions:this.hubServices.externalAppCardActionsService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppCommands:this.hubServices.externalAppCommandsService&&this.hubServices.externalAppInfoService?{}:void 0,files:this.hubServices.filesService?{}:void 0,geoLocation:this.hubServices.locationService?{map:this.hubServices.locationService.mapService?{}:void 0}:void 0,interactive:this.hubServices.interactiveService?{}:void 0,location:this.hubServices.locationService&&this.hubServices.locationService.mapService?{}:void 0,logs:this.hubServices.logService?{}:void 0,mail:this.hubServices.mailService?{}:void 0,marketplace:this.hubServices.marketplaceService?{}:void 0,media:this.hubServices.mediaService?{}:void 0,meeting:this.hubServices.meetingService?{appShareButton:this.hubServices.meetingService.appShareButton?{}:void 0}:void 0,meetingRoom:this.hubServices.meetingRoomService?{}:void 0,messageChannels:this.hubServices.messageChannelsService?{}:void 0,monetization:this.hubServices.monetizationService?{}:void 0,nestedAppAuth:this.hubServices.nestedAppAuthService?{}:void 0,notifications:this.hubServices.notificationService?{}:void 0,otherAppStateChange:this.hubServices.otherAppStateChangeService?{}:void 0,pages:{appButton:(null===(s=this.hubServices.pageService)||void 0===s?void 0:s.appButtonService)?{}:void 0,backStack:(null===(u=this.hubServices.pageService)||void 0===u?void 0:u.backStackService)?{}:void 0,config:(null===(c=this.hubServices.pageService)||void 0===c?void 0:c.configService)?{}:void 0,fullTrust:(null===(l=this.hubServices.pageService)||void 0===l?void 0:l.fullTrustService)?{}:void 0,tabs:(null===(d=this.hubServices.pageService)||void 0===d?void 0:d.tabsService)?{}:void 0,currentApp:{}},people:this.hubServices.peopleService?{}:void 0,permissions:this.hubServices.devicePermissionService?{}:void 0,profile:this.hubServices.profileService?{}:void 0,remoteCamera:this.hubServices.remoteCameraService?{}:void 0,search:this.hubServices.searchService?{}:void 0,sharing:this.hubServices.sharingService?{history:this.hubServices.sharingService.historyService?{}:void 0}:void 0,stageView:this.hubServices.stageViewService?{}:void 0,teams:this.hubServices.teamsService?{fullTrust:(null===(p=this.hubServices.teamsService)||void 0===p?void 0:p.fullTrustService)?{joinedTeams:(null===(h=null===(f=this.hubServices.teamsService)||void 0===f?void 0:f.fullTrustService)||void 0===h?void 0:h.joinedTeamsService)?{}:void 0}:void 0}:void 0,teamsCore:v.name==Ot.teams||v.name==Ot.teamsModern?{}:void 0,thirdPartyCloudStorage:this.hubServices.thirdPartyCloudStorageService?{}:void 0,video:this.hubServices.videoExtensibilityService&&(this.hubServices.videoExtensibilityService.mediaStreamService||this.hubServices.videoExtensibilityService.sharedFrameService)?{mediaStream:this.hubServices.videoExtensibilityService.mediaStreamService?{}:void 0,sharedFrame:this.hubServices.videoExtensibilityService.sharedFrameService?{}:void 0}:void 0}};var g,S;S=n<m.apiVersion?((e,t,n=wd)=>{if(e.apiVersion<=t)return e;let i=e;for(let e of n)if(i.apiVersion===e.versionToDowngradeFrom&&(i=e.downgradeToPreviousVersion(i)),i.apiVersion<=t)break;return i})(m,n):m;const y=[this.appSdkHost.getFrameContext(),this.appSdkHost.getHubInfo().clientType,"2.0.0",JSON.stringify(S)];return yd(y)}getContext(){return o(this,void 0,void 0,(function*(){const e=function(e){var t,n;return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId||"",appLaunchId:e.app.launchId||"",theme:e.app.theme,appIconPosition:e.app.iconPositionVertical||0,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId||"",userClickTime:e.app.userClickTime||0,userFileOpenPreference:e.app.userFileOpenPreference||At.Inline,hostName:e.app.host.name,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId||"",ringId:e.app.host.ringId,entityId:e.page.id||"",frameContext:e.page.frameContext,subEntityId:e.page.subPageId||"",isFullScreen:e.page.isFullScreen||!1,isMultiWindow:e.page.isMultiWindow||!1,sourceOrigin:e.page.sourceOrigin||"",userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:"",loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,upn:void 0!==e.user?e.user.userPrincipalName:void 0,userDisplayName:void 0!==e.user?e.user.displayName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:(null===(n=null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.sku)||"",channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:"",meetingId:void 0!==e.meeting?e.meeting.id:"",sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.teamSiteId:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0,dialogParameters:e.dialogParameters}}(yield this.appSdkHost.getAppContext());return yd(e)}))}onGetContextError(e,t){return null==t||t.fail(Td(e)),yd({})}handleAppLoaded(){var e,t;return o(this,void 0,void 0,(function*(){return null===(e=this.appInitializationScenario)||void 0===e||e.markPhase("InitializedToAppLoadedInvoked"),null===(t=this.extendedAppInitializationScenario)||void 0===t||t.markPhase("InitializedToAppLoadedInvoked"),this.appSdkHost.setAppInitInfo({state:gt.Loaded}),Ed}))}handleSuccess(){var e;return o(this,void 0,void 0,(function*(){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:gt.Loaded}),(this.registerAppInitMessageHandlers||this.usingCachedApp)&&(Zl(this.appSdkHost,this.hubServices,this.telemetryService),this.stopAppInitializationScenario()),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.stop(),Ed):Ed}))}handleFailure(e,t,n){var i;return o(this,void 0,void 0,(function*(){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:gt.Failed,reason:t}),this.registerAppInitMessageHandlers&&this.failAppInitializationScenario(t,n),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.fail(t,n),Ed):Ed}))}handleExpectedFailure(e,t,n){var i;return o(this,void 0,void 0,(function*(){if(!this.markInitializationStatusAsReported())return Ed;this.appSdkHost.setAppInitInfo({state:gt.Loaded});const e="Expected."+t;return this.registerAppInitMessageHandlers&&this.failAppInitializationScenario(e,n),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.fail(e,n),Ed}))}markInitializationStatusAsReported(){return!this.initializationStatusReported&&(this.initializationStatusReported=!0,!0)}readyToUnload(){return o(this,void 0,void 0,(function*(){return this.appSdkHost.setAppInitInfo({state:gt.Unloaded}),Ed}))}cleanup(){this.clearTimeoutTimer()}}class Rd extends Ad{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.authenticationService=n,this.TAG="BaseAuthenticationMessageHandler"}initHandlers(){this.registerHandler(p,this.handleGetUser,{errorCallback:this.onGetUserError,isRestrictedToFullTrustApps:!0}),this.registerHandler(d,this.handleGetAuthToken,{errorCallback:this.onGetAuthTokenError})}validateDependencies(){if(!this.authenticationService)throw"No authentication service is available";this.appSdkHost.getContext().app.host.clientType!==xt.desktop||this.authenticationService.externalAuthService||this.appSdkHost.getLogger().log(mt.Warn,this.TAG,tt)}handleGetUser(){return o(this,void 0,void 0,(function*(){let e=yield this.authenticationService.getUser();if(e){let t=yield this.appSdkHost.getAppContext(),n=Object.assign(Object.assign({},e.profile),{dataResidency:Hl(t.user.dataResidency)});return yd([!0,n])}return Promise.reject("Failed to fetch the user profile")}))}onGetUserError(e,t){return null==t||t.fail(`GetUser failed ${Td(e)}`),yd([!1,e])}handleGetAuthToken(e,t,n,i,r){return o(this,void 0,void 0,(function*(){let o=yield this.appSdkHost.getAppContext(),a=yield((e,t,n,i,r,o=!1,a=!1)=>{var s,u,c;const l=a?(e=>{if((null==e?void 0:e.composeExtension)&&"BotBased"===e.composeExtension.type){const t=e.composeExtension.botId;if(!t)throw"botID cannot be undefined in BotBased composeExtension";return t}})(i):void 0;if((n.name===Ot.teams||n.name===Ot.teamsModern)&&t&&t.length>0&&(!i||i.isFullTrust||(d=i.id)&&-1!==Ye.indexOf(d.toLowerCase()))){if(i){const n=nd().restrictedFullTrustOverrides;if(n){let o;if(n.forEach((e=>{e.appId===i.id&&(o=e)})),o)return a?cd(e,t,r,o,l):cd(e,t,r,o)}}return a&&l&&ud(t[0],l),Promise.resolve(t)}var d;if(null===(s=null==i?void 0:i.webApplicationInfo)||void 0===s?void 0:s.resource){let n;return n=1===(null==t?void 0:t.length)&&("api://{teamSiteDomain}"===t[0]&&"https://{teamSiteDomain}"===(null===(u=null==i?void 0:i.webApplicationInfo)||void 0===u?void 0:u.resource)||"api://{mySiteDomain}"===t[0]&&"https://{mySiteDomain}"===(null===(c=null==i?void 0:i.webApplicationInfo)||void 0===c?void 0:c.resource))?ld(t[0],r):((e,t)=>{var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&ld(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)})(i,r),n&&(((e,t)=>{if(e&&t){if(e===t)return!0;{const i=nd().escapeRegExSpecialCharactersInValidDomains?(n=t)&&new URL(n).host.replace(rd,"\\$1"):id(t),r=Je.validResourcePattern.replace(Je.resourceDomainParameter,i);return new RegExp(r,"i").test(e)}}return!1;var n})(n,e)||o)?(a&&l&&ud(n,l),Promise.resolve([n])):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")})(e.origin,t,this.appSdkHost.getHubInfo(),this.appDefinition,o),s=yield this.authenticationService.acquireToken(a[0],n,i,r);return yd([!0,s.token])}))}onGetAuthTokenError(e,t){return null==t||t.fail(`GetAuthToken failed ${Td(e)}`),yd([!1,e])}}class Od extends Rd{constructor(e,t,n){super(e,t,n),this.appAuthSdkHost=e,this.telemetryService=t,this.authenticationService=n}initHandlers(){super.initHandlers(),this.registerHandler(h,this.handleNotifySuccess),this.registerHandler(v,this.handleNotifyFailure)}handleNotifySuccess(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Id(this.authenticationService.notifySuccess,t)}handleNotifyFailure(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Id(this.authenticationService.notifyFailure,t,Ld.Other)}}const Pd=e=>{if(null==e||null===typeof e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e.map((e=>Pd(e)));if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return"function"==typeof structuredClone?structuredClone(e):e.slice(0);if("object"==typeof e){const n={};for(var t of Object.getOwnPropertyNames(e)){const i=e[t];n[t]=Pd(i)}return n}throw Error("Provided type '"+typeof e+"' ("+Object.prototype.toString.call(e)+") can't be cloned using deepCopy.")};class kd{constructor(e){this.appSdkHost=e,this.messageHandlers=[],this.TAG="BaseMessageProcessor",this.ValidCustomApiHubs=[Ot.teams,Ot.teamsModern,Ot.orange]}process(e){var t,n;return o(this,void 0,void 0,(function*(){try{this.appSdkHost.getLogger().log(mt.Info,this.TAG,`Function name: ${e.data.func}`);const n=e.data;let i=n.args,r=n.apiVersionTag;i=n.args&&Array.isArray(n.args)?n.args.map((e=>{return t=e,"function"==typeof structuredClone?structuredClone(t):Pd(t);var t})):[],i.unshift(e);const o=yield this.callMessageHandler(r,n.func,i,n.timestamp);if(o)return"appResponse"===o.kind&&this.processHandlerResultHelper(n,o),Promise.resolve(!0);if((null===(t=this.appSdkHost.getAppDefinition())||void 0===t?void 0:t.isMicrosoftOwned)&&this.ValidCustomApiHubs.includes(this.appSdkHost.getHubInfo().name)&&(yield this.tryCustomProcessing(n)))return Promise.resolve(!0);throw Error("Unhandled message")}catch(t){this.appSdkHost.getLogger().log(mt.Error,this.TAG,`Error in processing request: ${null===(n=e.data)||void 0===n?void 0:n.func}`,t)}return Promise.resolve(!1)}))}callMessageHandler(e,t,n,i){for(const r of this.messageHandlers)if(r.canHandleMessage(t))return r.handleMessage(e,t,n,i);return Promise.resolve(void 0)}tryCustomProcessing(e){return Promise.resolve(!1)}processHandlerResultHelper(e,t){const n=e.id;let i=[];t.data&&(i=Array.isArray(t.data)?t.data:[t.data]),this.appSdkHost.postResponseToApp(n,i)}cleanup(){this.messageHandlers.forEach((e=>e.cleanup()))}}class Nd extends kd{constructor(e,t,n){super(e),this.appSdkHost=e,this.authService=t,this.telemetryService=n,this.messageHandlers.push(new Od(e,n,t)),this.messageHandlers.push(new bd(e,{},n)),this.messageHandlers.forEach((e=>e.initHandlers()))}}class xd{constructor(e,t,n,i,r,o){this.hostWindow=e,this.context=t,this.authenticationService=n,this.logger=i,this.customTelemetryService=r,this.onAppInitStateChanged=o,this.initialized=!1,this.initializeAuthenticationContext=e=>{var t;this.context=e,this.contextPromise=null===(t=this.authenticationService)||void 0===t?void 0:t.getUser().then((e=>{var t,n,i,r,o,a,s,u,c;const l=Object.assign(Object.assign({},null===(t=this.context)||void 0===t?void 0:t.user),{id:(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.oid)||"",displayName:(null===(i=null==e?void 0:e.profile)||void 0===i?void 0:i.displayName)||"",loginHint:(null===(r=null==e?void 0:e.profile)||void 0===r?void 0:r.loginHint)||"",userPrincipalName:(null===(o=null==e?void 0:e.profile)||void 0===o?void 0:o.upn)||"",tenant:{id:(null===(a=null==e?void 0:e.profile)||void 0===a?void 0:a.tid)||"",sku:null===(c=null===(u=null===(s=this.context)||void 0===s?void 0:s.user)||void 0===u?void 0:u.tenant)||void 0===c?void 0:c.sku}}),d=Object.assign(Object.assign({},this.context.app),{userClickTime:this.getUserClickTime()}),p=Object.assign(Object.assign({},this.context),{app:d,user:l});return this.telemetryService.setAppContext(p),p}))},this.getContext=()=>this.context,this.getAppContext=()=>this.contextPromise?this.contextPromise.then((e=>e)).catch((()=>this.context)):Promise.resolve(this.context),this.getAppDefinition=()=>this.appDefinition,this.checkIfCachedAndRequestAllowed=e=>!0,this.setAppInitInfo=e=>{this.onAppInitStateChanged&&this.onAppInitStateChanged(e)},this.getLogger=()=>this.logger,this.telemetryService=new jl(this.getHubInfo(),t,this.customTelemetryService),this.context.app.userClickTime&&(this.userClickTime=this.context.app.userClickTime)}getTelemetryService(){return this.telemetryService}isInitialized(){return this.initialized}setInitialized(e){this.initialized=e}getHubInfo(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}}unloadApp(e){this.telemetryService.createScenario("appTermination",e.id).stop()}getHostWindow(){return this.hostWindow}getFrameContext(){return this.context.page.frameContext}getUserClickTime(){return this.userClickTime}setUserClickTime(e){this.userClickTime=e}startAppInitializationScenario(){var e;this.appInitializationScenario=null===(e=this.telemetryService)||void 0===e?void 0:e.createScenario("appInitialization",void 0,this.getUserClickTime())}getAppInitializationScenario(){return this.appInitializationScenario}}const Dd="HostedWebContentAuthSdkService";var Ld;!function(e){e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.BlockedByBrowser="BlockedByBrowser",e.CancelledByUser="CancelledByUser",e.InvalidAuthUrl="InvalidAuthUrl",e.InvalidFrameContext="InvalidFrameContext",e.Other="Other"}(Ld||(Ld={}));class _d extends Error{constructor(e,t){super(e),this.failureReason=t,this.name="HostedWebContentAuthSdkServiceInternalError"}}class Md extends xd{constructor(e,t,n,i,r,a,s,u){super(e,r,i,a,s,void 0),this.hostWindow=e,this.openWindowInfo=t,this.appDefinition=n,this.authenticationService=i,this.context=r,this.logger=a,this.onExternalAuthenticationComplete=(e,t)=>{e?this.authenticationService.notifySuccess(t):(t!==Ze&&t!==et||this.logger.log(mt.Error,Dd,t),this.authenticationService.notifyFailure(t))},this.onAuthMessageReceived=e=>o(this,void 0,void 0,(function*(){if(!this.authWindow||this.authWindow!==e.source)return;const t=e.origin;t!==this.origin&&this.checkUrlIsValid(t)&&(this.origin=e.origin),this.origin===t&&this.messageProcessor&&(yield this.messageProcessor.process(e))})),this.setupAuthMessageHandlers=()=>{this.authenticationService&&(this.messageProcessor=new Nd(this,this.authenticationService,this.telemetryService))};try{this.passContextForUrlValidation=nd().authExtensionContextForUrlValidation,this.context.app.host.clientType!==xt.desktop||this.authenticationService.externalAuthService||this.logger.log(mt.Warn,Dd,tt),this.context.page.frameContext!==Dt.authentication&&this.notifyAsFailureAndThrowError("Invalid frame context for scenario",Ld.InvalidFrameContext),this.appDefinition||this.notifyAsFailureAndThrowError("App definition not available",Ld.AppDefinitionUnavailable),this.telemetryService.setAppDefinition(this.appDefinition),this.checkUrlIsValid(t.url)||this.notifyAsFailureAndThrowError("Auth url is not valid",Ld.InvalidAuthUrl),this.shouldUseExternalAuthenticationWorkflow(r.app.host.clientType,u)?this.launchExternalAuthenticationWorkflow(t.url):this.launchEmbeddedAuthenticationWorkflow(r,t)}catch(e){let t,n="",i=!1;if(e instanceof _d?(n=e.message,t=e.failureReason,i=!1):e instanceof Error?(n=e.message,t=Ld.Other,i=!1):(n="Unknown error",t=Ld.Other,i=!0),this.authenticationService&&this.authenticationService.notifyFailure(n,t),a.log(mt.Error,Dd,`Error in constructor: ${n}, failure reason: ${t}`),i)throw e}}launchEmbeddedAuthenticationWorkflow(e,t){const n=function(e){let t="";return e.width&&e.height&&(t=`width=${e.width},height=${e.height}`,void 0!==e.left&&void 0!==e.top&&(t=`${t},left=${e.left},top=${e.top}`)),t}(t);if(e.app.host.clientType===xt.desktop&&this.authenticationService.externalAuthService)try{this.authWindow=this.authenticationService.externalAuthService.openUrlInEmbeddedBrowser(new URL(t.url),n)}catch(e){null!==this.authWindow&&(this.logger.log(mt.Error,Dd,`openUrlInEmbeddedBrowser threw an error but still returned a non-null window object? Forcing window object to null. Error = ${e}`),this.authWindow=null)}else this.authWindow=this.hostWindow.open(t.url,"appAuthWindow",n);if(!this.authWindow)throw new _d("URL was unable to be opened in embedded browser",Ld.BlockedByBrowser);this.setupEmbeddedAuthWindow(t.url,e,this.hostWindow)}launchExternalAuthenticationWorkflow(e){const t=vt.startNewExternalAuthSession(e,this.onExternalAuthenticationComplete,this.authenticationService.externalAuthRedirectUrl);try{this.authenticationService.externalAuthService?this.authenticationService.externalAuthService.openUrlInExternalBrowser(t):this.hostWindow.open(t)}catch(e){throw new _d("Failed to open the URL in external browser",Ld.Other)}}shouldUseExternalAuthenticationWorkflow(e,t){return e===xt.desktop&&!0===t}notifyAsFailureAndThrowError(e,t){throw this.authenticationService&&this.authenticationService.notifyFailure(e,t),new _d(`Failure message: ${e}, failure reason: ${t}`)}setupEmbeddedAuthWindow(e,t,n){var i;this.origin=e,this.setUserClickTime(null!==(i=t.app.userClickTime)&&void 0!==i?i:Date.now()),this.setupAuthMessageHandlers(),this.globalWindowEventListener=new it(n),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor(),this.initializeAuthenticationContext(t)}checkUrlIsValid(e){return this.passContextForUrlValidation?od(e,this.logger,this.appDefinition,this.context):od(e,this.logger,this.appDefinition)}getHostWindow(){return this.authWindow||null}postResponseToApp(e,t){this.sendResponseMessage(e,t)}isWindowOpen(){return!!this.authWindow&&!this.authWindow.closed}closeWindow(){this.unloadApp(this.appDefinition)}sendResponseMessage(e,t){if(this.origin){const n={id:e,args:t,origin:this.origin};this.postMessage(n)}}sendRequestMessage(e,t){if(this.origin){const n={func:e,args:t};this.postMessage(n)}}startAuthWindowMonitor(){this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval((()=>{this.authWindowInterval()}),100)}authWindowInterval(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.HandleError("CancelledByUser",Ld.CancelledByUser),this.closeWindow(),this.stopAuthWindowMonitor())}stopAuthWindowMonitor(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)}unloadApp(e){var t;this.unloadSDK(),null===(t=this.authWindow)||void 0===t||t.close()}unloadSDK(){this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message")}postMessage(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))}HandleError(e,t){this.authenticationService&&this.authenticationService.notifyFailure(e,t)}}const Fd={Debug:console.debug,Info:console.log,Warn:console.warn,Error:console.error};class Ud{log(e,t,n,i){Fd[e](`[LoggerService] tag: ${t}, level: ${e}, message: ${n}, exception: `,i||"undefined")}}var Hd,zd,Vd=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};!function(e){e.Success="success",e.Failure="failure"}(Hd||(Hd={})),function(e){e.AuthConfig="AuthConfig"}(zd||(zd={}));const jd=window.chrome.webview;class Bd extends e{constructor(e){super(),this.data=e,this.getUser=()=>Vd(this,void 0,void 0,(function*(){return{profile:{oid:this.data.userObjectId||"",tid:this.data.tenantId||"",upn:this.data.userPrincipalName||"",loginHint:this.data.loginHint||""}}})),this.notifySuccess=e=>Vd(this,void 0,void 0,(function*(){Wd(this.data.type,Hd.Success,e)})),this.notifyFailure=e=>Vd(this,void 0,void 0,(function*(){Wd(this.data.type,Hd.Failure,e)})),this.acquireToken=(e,t,n)=>Vd(this,void 0,void 0,(function*(){return Wd(this.data.type,Hd.Failure,"acquireToken in MetaOSAuthExtension is not implemented"),{token:""}}))}}function Wd(e,t,n){null==jd||jd.postMessage({eventType:e,status:t,data:n})}null==jd||jd.addEventListener("message",(e=>{e.data&&e.data.type===zd.AuthConfig&&function(e){const t=e.validDomains?e.validDomains.split(","):[];new Md(window,{url:e.targetUrl,width:e.width,height:e.height,left:e.left,top:e.right},{id:e.appId||"",validDomains:t,showLoadingIndicator:e.showLoadingIndicator,version:e.appVersion||"",devicePermissions:[],isFullTrust:!1,isLOB:!1,pages:{configurable:[],static:[]},manifestVersion:""},new Bd(e),{app:{locale:e.locale||"en-US",theme:e.isDarkMode?kt.dark:kt.default,host:{name:Ot.outlookWin32,clientType:xt.desktop,version:e.clientVersion,sessionId:e.hostSessionId},sessionId:e.sessionId},page:{id:"defaultId",frameContext:Dt.authentication},user:{dataResidency:e.dataResidency}},new Ud)||Wd(e.type,Hd.Failure,"MetaOSAuthExtension is null")}(e.data)}))})()})();