/*! For license information please see chunkOffice1js.js.LICENSE.txt */
(window.webpackJsonpTypeScriptModule=window.webpackJsonpTypeScriptModule||[]).push([[2],{1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(32),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"verb",{get:function(){return this.getValue(t.verbProperty)},set:function(e){this.setValue(t.verbProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new o.n(o.s.v1_4,"verb"),t}(n(771).b)},1009:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return O}));var r=n(2),o=n(484),i=n(52),a=n(1130),s=n(1140),l=n(832),c=n(325),u=n(260),d=n(44),p=n(75),g=n(171),h=n(17),f=n(399),m="libbie-loader",v="https://admin.microsoft.com",b="https://admin-ignite.microsoft.com",y=null,C=function(){y=null},O=function(e,t,n){if(void 0===n&&(n=!1),y)return y;var r=[],o={origin:window.location.origin,columnSize:6,title:Object(d.T)(),copilotLabButtonText:Object(d.U)(),copilotLabLink:"https://copilot.cloud.microsoft/prompts",prompts:[],bookmarks:[],facets:{displayCategory:[]},selectedFacets:{},width:55,height:55,isDarkMode:n,locale:u.a.getLanguage(),isHeaderDisabled:!1,onDialogLaunched:function(){Object(i.c)("dialog launched!"),g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabDialogLaunched}])},onPromptClicked:function(t){Object(i.c)("prompt clicked",t),g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabPromptItemClicked},{key:h.g.ChatEventParameters,value:"".concat(t.DisplayCategory)}]),g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabDialogClosed}]),Object(f.b)(t.PromptId),e.current.setInputAreaText(t.CommandText)},onFavoriteToggled:function(e,t){Object(i.c)("favorited toggle favorited: ".concat(t,", prompt: "),e),c.a.getInstance().submitOperation(Object(a.a)(s.b.UserActivity,e.PromptId,t),l.a.getTypeName());var n=o.prompts.map((function(n){var r=n;return e.Id===n.Id&&((r=e).UserActivity.Favorite.IsFavorite=t),r}));o.prompts=n,g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabSavedPromptClicked},{key:h.g.ChatEventParameters,value:t?p.f.Favourite:p.f.Unfavourite}]),r.forEach((function(e){return e({prompts:n})}))},onDialogDismissed:function(){Object(i.c)("dialog dismissed"),g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabDialogClosed}]),t.current.setMenuButtonFocus()},onFilterChanged:function(e){Object(i.c)("filters changed",e)},onShowOnlyFavoriteToggled:function(e){Object(i.c)("show only favorited toggled ".concat(e))},onGoToCopilotLabClicked:function(){Object(i.c)("on go to copilot lab clicked"),g.a.getInstance().sendTelemetryChatEventData([{key:h.g.ChatEventType,value:h.f.CopilotLabGoToCopilotLabButtonClicked}])}};return y={register:function(e){return r.push(e),o},unregister:function(){},updateColumnSize:function(e){o.columnSize=e,r.forEach((function(t){return t({columnSize:e})}))},updateTitle:function(e){o.title=e,r.forEach((function(t){return t({title:e})}))},updateCopilotLabButtonText:function(e){o.copilotLabButtonText=e,r.forEach((function(t){return t({copilotLabButtonText:e})}))},updateCopilotLabLink:function(e){o.copilotLabLink=e,r.forEach((function(t){return t({copilotLabLink:e})}))},updatePrompts:function(e){o.prompts=e,r.forEach((function(t){return t({prompts:e})}))},updateBookmarks:function(e){o.bookmarks=e,r.forEach((function(t){return t({bookmarks:e})}))},updateFacets:function(e){o.facets=e,r.forEach((function(t){return t({facets:e})}))},updateSelectedFacets:function(e){o.selectedFacets=e,r.forEach((function(t){return t({selectedFacets:e})}))},updateDarkMode:function(e){o.isDarkMode=e,r.forEach((function(t){return t({isDarkMode:e})}))},updateLocale:function(e){o.locale=e,r.forEach((function(t){return t({locale:e})}))},updateIsHeaderDisabled:function(e){o.isHeaderDisabled=e,r.forEach((function(t){return t({isHeaderDisabled:e})}))}}},S=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return y.updateSelectedFacets(e?{displayCategory:[e]}:void 0),[4,Object(o.b)({centroEnvironmentBaseUrl:u.a.isDevbuild()?b:v,preConfig:{hostName:"SharedCopilot",locale:"en",perfPrefix:"SharedCopilot_"},enableUxVersionQueryParam:!0})];case 1:return r.sent(),t=function(e){e("centro.hvc.libbieloader",y)},[4,Object(o.c)({featureName:m,adapters:{dataSources:t},localMode:!!window.localStorage.getItem("centro.hvc-loader.localMode")})];case 2:return r.sent(),[4,Object(o.a)({featureName:m})];case 3:return n=r.sent(),i=document.createElement("div"),[4,n.main(i)];case 4:return r.sent(),[2]}}))}))}},1014:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return c}));var r=n(1),o=n.n(r),i=function(e){return o.a.createElement("svg",{className:e,width:"18",height:"19",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M7.25 2.2207H10.75C11.1642 2.2207 11.5 2.55649 11.5 2.9707V4.7207H6.5V2.9707C6.5 2.55649 6.83579 2.2207 7.25 2.2207ZM5 2.9707V4.7207H3.25C1.45507 4.7207 0 6.17578 0 7.9707V15.4707C0 17.2656 1.45507 18.7207 3.25 18.7207H14.75C16.5449 18.7207 18 17.2656 18 15.4707V7.9707C18 6.17578 16.5449 4.7207 14.75 4.7207H13V2.9707C13 1.72806 11.9926 0.720703 10.75 0.720703H7.25C6.00736 0.720703 5 1.72806 5 2.9707ZM16.5 7.9707V9.4707C16.5 10.4372 15.7165 11.2207 14.75 11.2207H11V10.7207C11 10.1684 10.5523 9.7207 10 9.7207H8C7.44772 9.7207 7 10.1684 7 10.7207V11.2207H3.25C2.2835 11.2207 1.5 10.4372 1.5 9.4707V7.9707C1.5 7.0042 2.2835 6.2207 3.25 6.2207H14.75C15.7165 6.2207 16.5 7.0042 16.5 7.9707ZM16.5 12.2098V15.4707C16.5 16.4372 15.7165 17.2207 14.75 17.2207H3.25C2.2835 17.2207 1.5 16.4372 1.5 15.4707V12.2098C2.00515 12.5332 2.60568 12.7207 3.25 12.7207H7C7 13.273 7.44772 13.7207 8 13.7207H10C10.5523 13.7207 11 13.273 11 12.7207H14.75C15.3943 12.7207 15.9949 12.5332 16.5 12.2098Z"}))},a=function(e){return o.a.createElement("svg",{className:e,width:"16",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M2 0.720703C0.89543 0.720703 0 1.61613 0 2.7207V18.7207C0 19.8253 0.895431 20.7207 2 20.7207H14C15.1046 20.7207 16 19.8253 16 18.7207V8.54847C16 8.01804 15.7893 7.50933 15.4142 7.13426L9.58645 1.30649C9.21137 0.931417 8.70267 0.720703 8.17223 0.720703H2ZM1.5 2.7207C1.5 2.44456 1.72386 2.2207 2 2.2207H8V6.7207C8 7.82527 8.89543 8.7207 10 8.7207H14.5V18.7207C14.5 18.9968 14.2761 19.2207 14 19.2207H2C1.72386 19.2207 1.5 18.9968 1.5 18.7207V2.7207ZM13.3793 7.2207H10C9.72386 7.2207 9.5 6.99685 9.5 6.7207V3.34136L13.3793 7.2207Z"}))},s=function(e){return o.a.createElement("svg",{className:e,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("g",{clipPath:"url(#clip0_741_74312)"},o.a.createElement("path",{d:"M10 18.4961C9.21875 18.4961 8.4668 18.3952 7.74414 18.1934C7.02148 17.9915 6.3444 17.7051 5.71289 17.334C5.08138 16.9629 4.50846 16.5202 3.99414 16.0059C3.47982 15.4915 3.03711 14.9186 2.66602 14.2871C2.29492 13.6556 2.00846 12.9785 1.80664 12.2559C1.60482 11.5332 1.50391 10.7812 1.50391 10C1.50391 9.21875 1.60482 8.4668 1.80664 7.74414C2.00846 7.02148 2.29492 6.3444 2.66602 5.71289C3.03711 5.08138 3.47982 4.50846 3.99414 3.99414C4.50846 3.47982 5.08138 3.03711 5.71289 2.66602C6.3444 2.29492 7.02148 2.00846 7.74414 1.80664C8.4668 1.60482 9.21875 1.50391 10 1.50391C10.7812 1.50391 11.5332 1.60482 12.2559 1.80664C12.9785 2.00846 13.6556 2.29492 14.2871 2.66602C14.9186 3.03711 15.4915 3.47982 16.0059 3.99414C16.5202 4.50846 16.9629 5.08138 17.334 5.71289C17.7051 6.3444 17.9915 7.02148 18.1934 7.74414C18.3952 8.4668 18.4961 9.21875 18.4961 10C18.4961 10.7812 18.3952 11.5332 18.1934 12.2559C17.9915 12.9785 17.7051 13.6556 17.334 14.2871C16.9629 14.9186 16.5202 15.4915 16.0059 16.0059C15.4915 16.5202 14.9186 16.9629 14.2871 17.334C13.6556 17.7051 12.9785 17.9915 12.2559 18.1934C11.5332 18.3952 10.7812 18.4961 10 18.4961Z",fill:"#FAFAFA"}),o.a.createElement("path",{d:"M19.0039 10C19.0039 10.8268 18.8965 11.6243 18.6816 12.3926C18.4668 13.1543 18.1641 13.8704 17.7734 14.541C17.3828 15.2051 16.9141 15.8105 16.3672 16.3574C15.8203 16.9043 15.2148 17.3763 14.5508 17.7734C13.8802 18.1641 13.1641 18.4668 12.4023 18.6816C11.6341 18.8965 10.8366 19.0039 10.0098 19.0039C9.18294 19.0039 8.38542 18.8965 7.61719 18.6816C6.84896 18.4668 6.13281 18.1641 5.46875 17.7734C4.79818 17.3828 4.18945 16.9141 3.64258 16.3672C3.08919 15.8203 2.61719 15.2148 2.22656 14.5508C1.83594 13.8802 1.5332 13.1608 1.31836 12.3926C1.10352 11.6243 0.996094 10.8268 0.996094 10C0.996094 9.17318 1.10352 8.37891 1.31836 7.61719C1.5332 6.84896 1.83594 6.13281 2.22656 5.46875C2.61719 4.79818 3.08919 4.18945 3.64258 3.64258C4.18945 3.08919 4.79818 2.61719 5.46875 2.22656C6.13281 1.83594 6.84896 1.5332 7.61719 1.31836C8.37891 1.10352 9.17318 0.996094 10 0.996094C10.8268 0.996094 11.6243 1.10352 12.3926 1.31836C13.1543 1.5332 13.8704 1.83594 14.541 2.22656C15.2051 2.61719 15.8138 3.08919 16.3672 3.64258C16.9141 4.18945 17.3828 4.79818 17.7734 5.46875C18.1641 6.13281 18.4668 6.84896 18.6816 7.61719C18.8965 8.37891 19.0039 9.17318 19.0039 10ZM10 17.998C10.2344 17.998 10.4883 17.8841 10.7617 17.6562C11.0286 17.4284 11.2891 17.0996 11.543 16.6699C11.7904 16.2402 12.0215 15.7161 12.2363 15.0977C12.4512 14.4792 12.6237 13.7793 12.7539 12.998H7.24609C7.3763 13.7793 7.54883 14.4792 7.76367 15.0977C7.97852 15.7161 8.21289 16.2402 8.4668 16.6699C8.71419 17.0996 8.97461 17.4284 9.24805 17.6562C9.51497 17.8841 9.76562 17.998 10 17.998ZM12.9004 12.002C12.9329 11.6829 12.959 11.3574 12.9785 11.0254C12.9915 10.6934 12.998 10.3516 12.998 10C12.998 9.64844 12.9915 9.30664 12.9785 8.97461C12.959 8.64258 12.9329 8.31706 12.9004 7.99805H7.09961C7.06706 8.31706 7.04427 8.64258 7.03125 8.97461C7.01172 9.30664 7.00195 9.64844 7.00195 10C7.00195 10.3516 7.01172 10.6934 7.03125 11.0254C7.04427 11.3574 7.06706 11.6829 7.09961 12.002H12.9004ZM2.00195 10C2.00195 10.6771 2.08659 11.3444 2.25586 12.002H6.10352C6.07096 11.6764 6.04492 11.3477 6.02539 11.0156C6.00586 10.6836 5.99609 10.3451 5.99609 10C5.99609 9.65495 6.00586 9.31641 6.02539 8.98438C6.04492 8.65234 6.07096 8.32357 6.10352 7.99805H2.25586C2.08659 8.6556 2.00195 9.32292 2.00195 10ZM10 2.00195C9.76562 2.00195 9.51497 2.11589 9.24805 2.34375C8.97461 2.57161 8.71419 2.90039 8.4668 3.33008C8.21289 3.75977 7.97852 4.28385 7.76367 4.90234C7.54883 5.52083 7.3763 6.2207 7.24609 7.00195H12.7539C12.6237 6.2207 12.4512 5.52083 12.2363 4.90234C12.0215 4.28385 11.7904 3.75977 11.543 3.33008C11.2891 2.90039 11.0286 2.57161 10.7617 2.34375C10.4883 2.11589 10.2344 2.00195 10 2.00195ZM13.8965 7.99805C13.929 8.32357 13.9551 8.65234 13.9746 8.98438C13.9941 9.31641 14.0039 9.65495 14.0039 10C14.0039 10.3451 13.9941 10.6836 13.9746 11.0156C13.9551 11.3477 13.929 11.6764 13.8965 12.002H17.7441C17.9134 11.3444 17.998 10.6771 17.998 10C17.998 9.32292 17.9134 8.6556 17.7441 7.99805H13.8965ZM17.4121 7.00195C17.1777 6.42253 16.8815 5.88216 16.5234 5.38086C16.1654 4.87305 15.7585 4.41732 15.3027 4.01367C14.8405 3.60352 14.3359 3.25195 13.7891 2.95898C13.2422 2.65951 12.6628 2.42839 12.0508 2.26562C12.4479 2.79948 12.7962 3.47331 13.0957 4.28711C13.3887 5.0944 13.6133 5.99935 13.7695 7.00195H17.4121ZM7.94922 2.26562C7.33724 2.42839 6.75781 2.65951 6.21094 2.95898C5.66406 3.25195 5.16276 3.60352 4.70703 4.01367C4.24479 4.41732 3.83464 4.87305 3.47656 5.38086C3.11849 5.88216 2.82227 6.42253 2.58789 7.00195H6.23047C6.38672 5.99935 6.61458 5.0944 6.91406 4.28711C7.20703 3.47331 7.55208 2.79948 7.94922 2.26562ZM2.58789 12.998C2.82227 13.5775 3.11849 14.1211 3.47656 14.6289C3.83464 15.1302 4.24479 15.5859 4.70703 15.9961C5.16276 16.3997 5.66406 16.7513 6.21094 17.0508C6.75781 17.3438 7.33724 17.5716 7.94922 17.7344C7.55208 17.2005 7.20703 16.5299 6.91406 15.7227C6.61458 14.9089 6.38672 14.0007 6.23047 12.998H2.58789ZM12.0508 17.7344C12.6628 17.5716 13.2422 17.3438 13.7891 17.0508C14.3359 16.7513 14.8405 16.3997 15.3027 15.9961C15.7585 15.5859 16.1654 15.1302 16.5234 14.6289C16.8815 14.1211 17.1777 13.5775 17.4121 12.998H13.7695C13.6133 14.0007 13.3887 14.9089 13.0957 15.7227C12.7962 16.5299 12.4479 17.2005 12.0508 17.7344Z",fill:"#3A3A38"})),o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"clip0_741_74312"},o.a.createElement("rect",{width:"20",height:"20",fill:"white"}))))},l=function(e){return o.a.createElement("svg",{className:e,width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("g",{clipPath:"url(#clip0_98326_1271)"},o.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint0_linear_98326_1271)"}),o.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint1_linear_98326_1271)"}),o.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint2_radial_98326_1271)"}),o.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint3_linear_98326_1271)"}),o.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint4_radial_98326_1271)"}),o.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint5_linear_98326_1271)"})),o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"paint0_linear_98326_1271",x1:"9.52494",y1:"5.71629",x2:"4.86462",y2:"20.1745",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#AE7FE2"}),o.a.createElement("stop",{offset:"1",stopColor:"#0078D4"})),o.a.createElement("linearGradient",{id:"paint1_linear_98326_1271",x1:"7.5417",y1:"16.3092",x2:"6.72169",y2:"14.7676",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),o.a.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),o.a.createElement("radialGradient",{id:"paint2_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.98808 16.3592) rotate(-13.1869) scale(13.9366 10.8259)"},o.a.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),o.a.createElement("stop",{offset:"1",stopColor:"#5E438F"})),o.a.createElement("linearGradient",{id:"paint3_linear_98326_1271",x1:"16.6314",y1:"10.9555",x2:"15.8357",y2:"12.2201",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),o.a.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),o.a.createElement("radialGradient",{id:"paint4_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9836 11.3541) rotate(-160.581) scale(16.4238 16.5011)"},o.a.createElement("stop",{stopColor:"#50E6FF"}),o.a.createElement("stop",{offset:"1",stopColor:"#436DCD"})),o.a.createElement("linearGradient",{id:"paint5_linear_98326_1271",x1:"5.49905",y1:"5.87339",x2:"8.12498",y2:"5.87339",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.9999",stopColor:"#2D3F80"}),o.a.createElement("stop",{offset:"1",stopColor:"#436DCD",stopOpacity:"0"})),o.a.createElement("clipPath",{id:"clip0_98326_1271"},o.a.createElement("rect",{y:"0.75",width:"20",height:"20",rx:"2",fill:"white"}))))},c=o.a.createElement("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},o.a.createElement("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM11 7h2v2h-2V7zm0 3h2v6h-2V10z"}))},1015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(241),o=n(206);function i(e,t){var n=Array.from(e),r=new Blob([new Uint8Array(n)],{type:t||"image/png"}),o=new FileReader;return o.readAsDataURL(r),new Promise((function(e,t){o.onload=function(){var t=o.result;e(t)},o.onerror=function(){t(o.error)}}))}var a=function(e){return e===o.e.iOS?{platform:"iOS"}:e===o.e.Web?{platform:"Web"}:e===o.e.MacOS?{platform:"MacOS"}:{platform:"Web"}},s=function(e,t,n,o){e===r.c.Like?o?null==t||t(o):null==t||t():e===r.c.Dislike&&(o?null==n||n(o):null==n||n())},l=function(e,t){return e.includes("%s")?e.replace("%s",t):e}},103:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.Designer=8]="Designer",e[e.CopilotWorkflowMessage=9]="CopilotWorkflowMessage",e[e.WarningMessage=10]="WarningMessage",e[e.PaginatedCard=11]="PaginatedCard",e[e.ProactiveSuggestionCard=12]="ProactiveSuggestionCard",e[e.ReviewerSummaryCard=13]="ReviewerSummaryCard",e[e.ReviewAgentCard=14]="ReviewAgentCard"}(r||(r={}))},105:function(e,t,n){"use strict";n.d(t,"g",(function(){return Cm})),n.d(t,"d",(function(){return Sm})),n.d(t,"i",(function(){return xm})),n.d(t,"h",(function(){return Im})),n.d(t,"j",(function(){return wm})),n.d(t,"a",(function(){return Tm})),n.d(t,"e",(function(){return km})),n.d(t,"c",(function(){return jm})),n.d(t,"b",(function(){return Pm})),n.d(t,"f",(function(){return Am}));var r=n(2),o=n(135),i=n(467),a=n(103),s=n(2173),l=n(2089),c=n(54),u=n(137),d=function(e){function t(t,n,r,o,i,a,s,l,c,u,d){var p=e.call(this,r,o,i,a,s,l,c,u,d)||this;return p.taskModuleLauncher=t,p.clientInfo=n,p}return Object(r.__extends)(t,e),t.prototype.launchModalDialogContainer=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t?[4,this.getAppDefinition(e.appId)]:[2,Promise.reject("Dialog content not found")];case 1:return(n=r.sent())?(o={dialogContent:t,appDefinition:n,cardData:JSON.stringify(e.cardData)},this.taskModuleLauncher?[4,this.taskModuleLauncher(o)]:[3,3]):[2,Promise.reject("App definition not found")];case 2:return r.sent(),[2,Promise.resolve({status:"Success"})];case 3:return[2,Promise.resolve({status:"Failure"})]}}))}))},t.prototype.openTaskModule=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t=this.getDialogFromTaskInfo(e.taskInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t.prototype.openStageView=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t=this.getDialogFromStageInfo(e.stageInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t}(n(1131).MsgExtPreviewHostService),p=function(){function e(){}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{type:e.type.toString(),tag:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",name:null!==(o=null===(r=e.name)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",source:null!==(a=null===(i=e.source)||void 0===i?void 0:i.toString())&&void 0!==a?a:"",duration:null!==(l=null===(s=e.duration)||void 0===s?void 0:s.toString())&&void 0!==l?l:"",success:null!==(u=null===(c=e.success)||void 0===c?void 0:c.toString())&&void 0!==u?u:"",correlationVector:null!==(p=null===(d=e.correlationVector)||void 0===d?void 0:d.toString())&&void 0!==p?p:""}},e.prototype.LogInfo=function(e){},e.prototype.LogError=function(e){},e.prototype.LogException=function(e){},e.prototype.LogWarning=function(e){},e.prototype.LogVerbose=function(e){},e.prototype.LogMetric=function(e){},e}(),g=function(){function e(e){this.cardProps=e}return e.prototype.getDisplayExternalUrlWarning=function(){return function(e){return new Promise((function(t,n){e?setTimeout((function(){return t()}),2e3):n("CardId is missing")}))}},e.prototype.isValidMessageForMsgExtCard=function(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((function(e){return!!e.cardJson}))},e.prototype.getCardReferences=function(e){var t,n,r=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];var o=new l.a({},null,null===(t=this.cardProps.clientInfo)||void 0===t?void 0:t.locale,"",null===(n=this.cardProps.clientInfo)||void 0===n?void 0:n.theme);return e.map((function(e,t){return{index:t+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:r,content:e.cardJson,config:o}}))},e.prototype.getCardServiceProps=function(){return this.cardProps},e.prototype.getMsgExtCardService=function(){var e,t=this.cardProps.tokenService,n=this.cardProps.appService,r=this.cardProps.channelService,o=this.cardProps.clientInfo,i=null===(e=this.cardProps)||void 0===e?void 0:e.telemetryService,a=this.cardProps.taskModuleLauncher,l={host:{clientType:o.clientType,name:o.hubName,sessionId:o.sessionId,version:u.K},locale:o.locale,sessionId:o.sessionId,theme:o.theme},g={dataResidency:c.d.Public,id:o.aadUserId,displayName:o.userName,userPrincipalName:o.userPrincipalName};i||(i=new p);var h=document.createElement("div"),f=new d(a,o,(function(){return h}),g,l,n,t,(function(){throw new Error("Not implemented")}),r,void 0,this.getDisplayExternalUrlWarning());return{hostService:f,tokenService:t,appService:n,cardService:new s.a(f,r,n),telemetryService:i,channelService:r}},e}(),h=n(3345),f=n(1),m=n.n(f),v=n(99);function b(e){var t=e.theme,n=e.dir,o=e.children,a=m.a.useMemo((function(){switch(Object(i.b)()){case i.a.defaultBlack:return Object(r.__assign)(Object(r.__assign)({},v.a),t);case i.a.defaultWhite:default:return Object(r.__assign)(Object(r.__assign)({},v.b),t)}}),[t]);return m.a.createElement(h.a,{theme:a,dir:n},o)}var y=n(1543),C=n(65),O=Object(y.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),S=function(e){var t=e.children,n=e.style,o=e.horizontal,i=void 0!==o&&o,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(C.a)(o,t)),n?o=r?Object(C.a)(o,e.horizontalReverse):Object(C.a)(o,e.horizontal):r&&(o=Object(C.a)(o,e.verticalReverse)),o}(O(),n,i,s);return f.createElement("div",Object(r.__assign)({className:c},l),t)},E=n(3360),x=n(3361),I=n(3362),w=n(1814),T=n(1026),k=n(3364),j=n(3365),P=n(3366),A=n(3358),_=n(3359),D=n(3334),L=n(1858),M=n(64),B=function(){return Object(M.m)()?OfficeaicopilotStrings.LikeButtonLabel:"Like"},R=function(){return Object(M.m)()?OfficeaicopilotStrings.DislikeButtonLabel:"Dislike"},F=function(){return Object(M.m)()?OfficeaicopilotStrings.SuggestionPaneLabel:"Suggested Prompts"};function N(){return Object(M.m)()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"}var H=Object(y.a)({item:{height:"auto",width:"auto",flexShrink:1}}),U=function(e){var t=e.children,n=e.style,r=Object(C.a)(H().item,n);return m.a.createElement("div",{className:r},t)},V=n(3363),z=function(e){var t=e.iconUrl,n=e.iconAltText||"MenuItemIcon";return m.a.createElement(V.a,{src:t,alt:n,fit:"contain"})},G=n(2823),W=n(335),Q=n(139),q={root:Object(r.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},W.a.margin("0px","16px","0px","16px")),menuWrapper:Object(r.__assign)({},W.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Q.a.colorNeutralForeground1,"&:hover":{color:Q.a.colorBrandBackground2Hover},"&:hover :active":{color:Q.a.colorBrandStroke2Hover}},iconButton:Object(r.__assign)(Object(r.__assign)({},W.a.border("none")),{color:Q.a.colorNeutralForeground1,backgroundColor:"transparent"}),label:Object(r.__assign)({},W.a.padding("4px","5px","4px","5px")),labelIcon:Object(r.__assign)(Object(r.__assign)({},W.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(r.__assign)(Object(r.__assign)({},W.a.margin("5px","0px","5px","0px")),{height:"100%"})},K=Object(y.a)(q),Y=Object(G.a)(v.b),Z={root:Object(r.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},W.a.margin("0px","16px","0px","16px")),menuWrapper:Object(r.__assign)({},W.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Y.neutralPrimary,"&:hover":{color:Y.themeMedium},"&:hover :active":{color:Y.themeDark}},iconButton:Object(r.__assign)(Object(r.__assign)({},W.a.border("none")),{color:Y.neutralPrimary,backgroundColor:"transparent"}),label:Object(r.__assign)({},W.a.padding("4px","5px","4px","5px")),labelIcon:Object(r.__assign)(Object(r.__assign)({},W.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(r.__assign)(Object(r.__assign)({},W.a.margin("5px","0px","5px","0px")),{height:"100%"})},J=Object(y.a)(Z),X=function(){var e=J(),t=K();return Object(i.g)()?t:e},$=function(e){var t=e.isMenuOpen,n=e.onMenuStateChange,r=e.handleCopilotChatChange,o=e.copilotList,i=e.showNewChatButtonOnTop,a=e.isExecuting,s=e.handleChangeTopicButtonClick,l=X(),c=o.find((function(e){return e.isSelected})),u=o.find((function(e){return e.isDefaultCopilot})),d=null==c?void 0:c.id,p=null==u?void 0:u.id,g=null==c?void 0:c.name,h=null==c?void 0:c.menuIcon,m=null==c?void 0:c.menuIconUrl,v=null==c?void 0:c.iconAltText,b=Object(A.a)(_.d,_.e);return f.createElement(S,{horizontal:!0,style:l.root},f.createElement(E.a,{open:t,onOpenChange:n},f.createElement(S,{horizontal:!0,style:l.menuWrapper},f.createElement(x.a,{withArrow:!0,positioning:"below",content:Object(M.m)()?OfficeaicopilotStrings.CopilotSwitcherMenuTriggerTitle:"Switch copilots",relationship:"label"},f.createElement(I.a,{disableButtonEnhancement:!0},f.createElement(w.a,{className:l.iconButton,icon:f.createElement(D.a,null)}))),d!==p&&f.createElement(S,{horizontal:!0},f.createElement(U,{style:l.labelIcon},m?f.createElement(z,{iconUrl:m,iconAltText:v}):h),f.createElement(T.a,{weight:"semibold",className:l.label},g))),f.createElement(k.a,{className:l.menu},f.createElement(j.a,null,o.map((function(e){return f.createElement(P.a,{key:e.id,icon:e.menuIconUrl?f.createElement(z,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon,onClick:function(){r(e.id)}},f.createElement(S,{horizontal:!0,style:l.menuItem},f.createElement(U,null,e.name),f.createElement(U,null,e.isSelected&&f.createElement(L.s,null))))}))))),p===d&&f.createElement(S,{horizontal:!0},i&&f.createElement(x.a,{withArrow:!0,positioning:"below",content:N(),relationship:"label"},f.createElement(w.a,{appearance:"transparent",disabled:a,className:l.menuAdjacentActionButtons,icon:f.createElement(b,null),onClick:s}))))},ee=function(e){var t=e.componentToRender,n=X();return m.a.createElement(S,{style:n.componentWrapper},t)},te=n(3370),ne={root:Object(r.__assign)({},W.a.margin("0px","16px","0px","16px"))},re=Object(y.a)(ne),oe=function(e){var t=e.label,n=e.checked,r=e.disabled,o=e.onChange,i=re();return m.a.createElement(te.a,{className:i.root,onChange:o,checked:n,label:t,disabled:r,labelPosition:"after"})},ie={buttonStack:Object(r.__assign)({},W.a.margin("0px","0px","0px","15px")),buttonStackItem:Object(r.__assign)({},W.a.margin("0px","5px","0px","0px"))};var ae,se,le,ce,ue=(le={buttonStack:null!==(ae=ie.buttonStack)&&void 0!==ae?ae:{},buttonStackItem:null!==(se=ie.buttonStackItem)&&void 0!==se?se:{}},Object(y.a)(le)),de=n(3599),pe=n(3371),ge=n(3372),he=n(3373),fe=n(2265),me=n(3374),ve=n(3375),be=n(3376),ye=n(3377),Ce=n(3378),Oe=n(3379),Se=n(576),Ee=(ce=Object(G.a)(v.b),{itemCell:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("5px")),W.a.borderBottom("1px","solid",ce.themePrimary)),{minHeight:"30px",boxSizing:"border-box",display:"flex",selectors:{"&:hover":{backgroundColor:ce.neutralLight}}}),itemContent:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.overflow("hidden")),W.a.margin("0px","0px","0px","5px")),{flexGrow:1}),itemName:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"},accordionBody:Object(r.__assign)({},W.a.margin("0px","10px")),metricAccordionHeaderText:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("auto")),{overflowWrap:"anywhere",fontSize:"16px",fontWeight:"500"})}),xe=function(){var e,t,n,r,o,i,a={itemCell:null!==(e=Ee.itemCell)&&void 0!==e?e:{},itemContent:null!==(t=Ee.itemContent)&&void 0!==t?t:{},itemName:null!==(n=Ee.itemName)&&void 0!==n?n:{},itemValue:null!==(r=Ee.itemValue)&&void 0!==r?r:{},accordionBody:null!==(o=Ee.accordionBody)&&void 0!==o?o:{},metricAccordionHeaderText:null!==(i=Ee.metricAccordionHeaderText)&&void 0!==i?i:{}};return Object(y.a)(a)}();var Ie,we=function(e){var t=Object(r.__read)(m.a.useState([]),2),n=t[0],o=t[1],i=Object(r.__read)(m.a.useState([]),2),a=i[0],s=i[1],l=Object(r.__read)(m.a.useState(""),2),c=l[0],u=l[1],d=xe();return Object(f.useEffect)((function(){!function(t){var n;if(u(t),""!==c){var r=null===(n=e.telemetry.metrics)||void 0===n?void 0:n.filter((function(e){return e.serviceName.toLowerCase().includes(c.toLowerCase())}));s(r)}else s(e.telemetry.metrics)}(e.searchValue)}),[e.searchValue]),m.a.createElement(ve.a,{openItems:n,onToggle:function(e,t){o(t.openItems)},multiple:!0,collapsible:!0,className:d.accordionBody},a.map((function(e,t){return m.a.createElement(be.a,{key:t,value:(t+1).toString()},m.a.createElement(ye.a,null,m.a.createElement(Ce.a,{className:d.metricAccordionHeaderText},"".concat(e.serviceName))),m.a.createElement(Oe.a,null,Object.keys(e).filter((function(e){return"serviceName"!==e})).map((function(t,n){return m.a.createElement("div",{key:n,className:d.itemCell,"data-is-focusable":!0},m.a.createElement("div",{className:d.itemContent},m.a.createElement(Ce.a,{block:!0,className:d.itemName},t.toString()),m.a.createElement(Ce.a,{block:!0,className:d.itemValue},String(e[t]))))}))))})))};!function(e){e.COPIED="Copied",e.COPY_ERROR="Copy Error",e.COPY_DEBUG_LOGS="Copy Debug Logs"}(Ie||(Ie={}));var Te=function(){return"Sydney Telemetry Debug Panel"},ke=function(){return"Query ID :"},je=function(){return"Show Telemetry Panel"},Pe=function(){return"Replay Conversation"},Ae=function(){return"Debug Tools"},_e=function(){return"https://sdf.cortana.ai/turingbot/ui?debug=true&enableDebugButton=&allowedMessageTypes=Any&variants=UseIc3ForConversationStorage&sourceConversationId="},De=function(){return"_blank"},Le=function(){return"Search Telemetry"},Me={dialogTitle:Object(r.__assign)({},W.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},searchBox:{width:"90%",marginLeft:"5%"},searchBoxContainer:{paddingBottom:"10px"}},Be=function(){var e,t,n,r,o,i={dialogTitle:null!==(e=Me.dialogTitle)&&void 0!==e?e:{},queryAccordionHeaderText:null!==(t=Me.queryAccordionHeaderText)&&void 0!==t?t:{},queryAccordionText:null!==(n=Me.queryAccordionText)&&void 0!==n?n:{},searchBox:null!==(r=Me.searchBox)&&void 0!==r?r:{},searchBoxContainer:null!==(o=Me.searchBoxContainer)&&void 0!==o?o:{}};return Object(y.a)(i)}();var Re=function(e){var t=Object(r.__read)(m.a.useState([]),2),n=t[0],o=t[1],i=Object(r.__read)(m.a.useState(""),2),a=i[0],s=i[1],l=Be();return m.a.createElement(de.a,{open:e.isModalOpen,onOpenChange:function(t,n){e.setIsModalOpen(n.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":"close",icon:m.a.createElement(Se.n,null)})),className:l.dialogTitle},Te()),m.a.createElement(me.a,null,m.a.createElement("div",{className:l.searchBoxContainer},m.a.createElement("input",{placeholder:Le(),onChange:function(e){return s(e.target.value)},className:l.searchBox})),m.a.createElement(ve.a,{openItems:n,onToggle:function(e,t){o(t.openItems)},multiple:!0,collapsible:!0},e.telemetryData.map((function(e,t){return m.a.createElement(be.a,{key:t,value:(t+1).toString()},m.a.createElement(ye.a,null,m.a.createElement(S,null,m.a.createElement(Ce.a,{block:!0,className:l.queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat(ke())),m.a.createElement(Ce.a,{className:l.queryAccordionText},e.queryId))),m.a.createElement(Oe.a,null,m.a.createElement(we,{telemetry:e.telemetry,searchValue:a})))})))))))};var Fe,Ne=function(e){var t=this,n=Object(r.__read)(Object(f.useState)(!1),2),o=n[0],i=n[1],a=Object(r.__read)(Object(f.useState)(!1),2),s=a[0],l=a[1],c=Object(r.__read)(Object(f.useState)(!1),2),u=c[0],d=c[1],p=Object(r.__read)(Object(f.useState)(!1),2),g=p[0],h=p[1],v=ue(),b=s?Ie.COPIED:u?Ie.COPY_ERROR:Ie.COPY_DEBUG_LOGS,y={checked:o,disabled:!1,onChange:function(e,t){var n=null==t?void 0:t.checked;i(null!=n&&n),n||(l(!1),d(!1))},label:Ae()};return m.a.createElement(S,null,m.a.createElement(oe,Object(r.__assign)({},y)),m.a.createElement(S,{horizontal:!0,style:v.buttonStack},m.a.createElement(U,{style:v.buttonStackItem},o&&m.a.createElement(w.a,{appearance:"outline",onClick:function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),(t=e.getLogs())?[4,navigator.clipboard.writeText(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return l(!0),[3,4];case 3:return n=r.sent(),console.log("An error occurred while copying text to clipboard:",n.message),d(!0),[3,4];case 4:return[2]}}))}))},size:"small",title:b},b)),m.a.createElement(U,{style:v.buttonStackItem},o&&""!=e.conversationId&&m.a.createElement(w.a,{appearance:"outline",onClick:function(){e.conversationId&&window.open(_e()+e.conversationId,De())},size:"small",title:Pe()},Pe())),m.a.createElement(U,{style:v.buttonStackItem},o&&e.telemetryData&&m.a.createElement(w.a,{appearance:"outline",onClick:function(){h(!g)},size:"small",title:je(),disabled:0===e.telemetryData.length},je()))),o&&e.telemetryData&&g&&m.a.createElement(Re,{telemetryData:e.telemetryData,isModalOpen:g,setIsModalOpen:h}))},He=n(3597),Ue=n(3367),Ve=n(3380),ze=n(1817),Ge=n(3369),We=n(3347),Qe=n(3381),qe={dialogTitle:Object(r.__assign)({},W.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},itemName:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"}},Ke=function(){var e,t,n,r,o,i={dialogTitle:null!==(e=qe.dialogTitle)&&void 0!==e?e:{},queryAccordionHeaderText:null!==(t=qe.queryAccordionHeaderText)&&void 0!==t?t:{},queryAccordionText:null!==(n=qe.queryAccordionText)&&void 0!==n?n:{},itemName:null!==(r=qe.itemName)&&void 0!==r?r:{},itemValue:null!==(o=qe.itemValue)&&void 0!==o?o:{}};return Object(y.a)(i)}(),Ye="Client Conversation Logs",Ze="Client Console Logs",Je="Performance",Xe="Session Info",$e="Augloop Workflow Logs",et="Chat Event Logs",tt="Session Id",nt="Option Sets",rt="AL Inspector Link",ot="App Name",it="App Platform",at="SDX Version",st="https://web.augloop-tools.officeppe.com/inspector/",lt="_blank",ct="Close",ut=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,o=e.conversationLogObject,i=Ke(),a=Object(r.__read)(m.a.useState([]),2),s=a[0],l=a[1],c=function(e,t){return m.a.createElement(be.a,{key:t,value:(t+1).toString()},m.a.createElement(ye.a,null,m.a.createElement(S,null,m.a.createElement(Ce.a,{block:!0,className:i.queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat("Query")))),m.a.createElement(Oe.a,null,(n=e,r=[],Object.keys(n).forEach((function(e){r.push(m.a.createElement("div",{className:i.itemName},e,":")),r.push(m.a.createElement("div",{className:i.itemValue},JSON.stringify(n[e])))})),r)));var n,r};return m.a.createElement(de.a,{open:t,onOpenChange:function(e,t){n(t.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":ct,icon:m.a.createElement(Se.n,null)}))},Ye),m.a.createElement(me.a,null,m.a.createElement(ve.a,{openItems:s,onToggle:function(e,t){l(t.openItems)},multiple:!0,collapsible:!0},null==o?void 0:o.map((function(e,t){return c(e,t)})))))))},dt=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.getLogs;return m.a.createElement(de.a,{open:t,onOpenChange:function(e,t){n(t.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":ct,icon:m.a.createElement(Se.n,null)}))},Ze),m.a.createElement(me.a,null,r?r():""))))},pt=function(e){var t,n,r=e.isModalOpen,o=e.setIsModalOpen,i=e.debugMessageInfoObject,a=Ke();return m.a.createElement(de.a,{open:r,onOpenChange:function(e,t){o(t.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":ct,icon:m.a.createElement(Se.n,null)}))},"Debug Info"),m.a.createElement(me.a,null,i?(t=i,n=[],Object.keys(t).forEach((function(e){n.push(m.a.createElement("div",{className:a.itemName},e,":")),n.push(m.a.createElement("div",{className:a.itemValue},JSON.stringify(t[e])))})),n):""))))},gt=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.chatPaneLoadTime,o=e.chatInputLoadTime,i=Ke();return m.a.createElement(de.a,{open:t,onOpenChange:function(e,t){n(t.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":ct,icon:m.a.createElement(Se.n,null)}))},Je),m.a.createElement(me.a,null,m.a.createElement("div",{className:i.itemName},"".concat("Chat Pane Load Time",": ")),m.a.createElement("div",{className:i.itemValue},"".concat(r,"s")),m.a.createElement("div",{className:i.itemName},"".concat("Ready to Interact",": ")),m.a.createElement("div",{className:i.itemValue},"".concat(o,"s"))))))},ht=n(3382),ft=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.sessionId,o=e.conversationLogObject,i=e.appName,a=e.appPlatform,s=e.augloopKustoQueryURL,l=e.clientKustoQueryURL,c=e.sdxVersion,u=Ke();return m.a.createElement(de.a,{open:t,onOpenChange:function(e,t){n(t.open)}},m.a.createElement(pe.a,null,m.a.createElement(ge.a,null,m.a.createElement(he.a,{action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":ct,icon:m.a.createElement(Se.n,null)}))},Xe),m.a.createElement(me.a,null,m.a.createElement("div",{className:u.itemName},"".concat(tt,": ")),m.a.createElement("div",{className:u.itemValue},r||""),m.a.createElement("div",{className:u.itemName},"".concat(ot,": ")),m.a.createElement("div",{className:u.itemValue},i||""),m.a.createElement("div",{className:u.itemName},"".concat(it,": ")),m.a.createElement("div",{className:u.itemValue},a||""),m.a.createElement("div",{className:u.itemName},"".concat(at,": ")),m.a.createElement("div",{className:u.itemValue},c||""),m.a.createElement("div",{className:u.itemName},"".concat(nt,": ")),m.a.createElement("div",{className:u.itemValue},o&&o.length>0&&o[0].optionSets?o[0].optionSets:[]),m.a.createElement("div",{className:u.itemName},"".concat(rt,": ")),m.a.createElement("div",{className:u.itemValue},m.a.createElement(ht.a,{onClick:function(){var e="".concat(st).concat(r);window.open(e,lt)}},"".concat(st).concat(r))),m.a.createElement("div",{className:u.itemName},"".concat($e,": ")),m.a.createElement("div",{className:u.itemValue},m.a.createElement(ht.a,{onClick:function(){window.open(s,lt)}},s)),m.a.createElement("div",{className:u.itemName},"".concat(et,": ")),m.a.createElement("div",{className:u.itemValue},m.a.createElement(ht.a,{onClick:function(){window.open(l,lt)}},l))))))},mt={toolbar:Object(r.__assign)({justifyContent:"space-between",marginRight:"5px"},W.a.padding("2px"))},vt=function(){var e,t={toolbar:null!==(e=mt.toolbar)&&void 0!==e?e:{}};return Object(y.a)(t)}(),bt=function(e){var t,n=Object(r.__read)(Object(f.useState)(!1),2),o=n[0],i=n[1],a=Object(r.__read)(Object(f.useState)(!1),2),s=a[0],l=a[1],c=Object(r.__read)(Object(f.useState)(!1),2),u=c[0],d=c[1],p=Object(r.__read)(Object(f.useState)(!1),2),g=p[0],h=p[1],v=Object(r.__read)(Object(f.useState)(!1),2),b=v[0],y=v[1],C=Object(r.__read)(Object(f.useState)(!1),2),O=C[0],S=C[1],x=Object(r.__read)(Object(f.useState)(!1),2),T=x[0],A=x[1],D=vt();return Object(f.useEffect)((function(){A(e.showDebugInfoMessage)}),[e.showDebugInfoMessage]),m.a.createElement("div",null,m.a.createElement(He.a,{className:D.toolbar},m.a.createElement(Ue.a,null,m.a.createElement(oe,{label:"Debug Menu",onChange:function(e,t){var n=null==t?void 0:t.checked;i(n)},checked:o,disabled:!1})),o&&m.a.createElement(Ue.a,null,m.a.createElement(Ve.a,{icon:m.a.createElement(_.b,null),onClick:function(){var t=e.conversationLogObject&&e.conversationLogObject[0].optionSets?e.conversationLogObject[0].optionSets:[],n="<ul> <li><strong>".concat(tt,":</strong> ").concat(e.sessionId," </li>\n    <li><strong>").concat(rt,":</strong> ").concat(st).concat(e.sessionId,"</li>\n    <li><strong>").concat(ot,":</strong> ").concat(e.appName,"</li>\n    <li><strong>").concat(it,": </strong> ").concat(e.appPlatform,"</li>\n    <li><strong>").concat(at,": </strong> ").concat(e.sdxVersion," </li>\n    <li><strong>").concat(nt,": </strong> ").concat(t," </li></ul>")+"<br/> ".concat("Please upload console and sydney logs from debug panel","<br/>"),r="https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[".concat(e.appName,"+Copilot]:&[System.Description]=").concat(n,"&[System.Area]=OC\\Office+AI+Exp\\Chat&[System.Tags]=UserFeedback");r=r.replace(/\n/g,""),window.open(r,lt)}}),m.a.createElement(E.a,null,m.a.createElement(I.a,{disableButtonEnhancement:!0},m.a.createElement(ze.a,{icon:m.a.createElement(Se.k,null),appearance:"subtle"})),m.a.createElement(k.a,null,m.a.createElement(j.a,null,m.a.createElement(P.a,{onClick:function(){h(!0)}},Xe),m.a.createElement(P.a,{onClick:function(){d(!0)}},Je)))),m.a.createElement(E.a,null,m.a.createElement(I.a,{disableButtonEnhancement:!0},m.a.createElement(ze.a,{icon:m.a.createElement(We.c,null),appearance:"subtle"})),m.a.createElement(k.a,null,m.a.createElement(j.a,null,m.a.createElement(Ge.a,null,m.a.createElement(P.a,null,Ze),m.a.createElement(w.a,{icon:m.a.createElement(Qe.h,null),appearance:"subtle",onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,a,s;return Object(r.__generator)(this,(function(r){return t=null===(a=e.getLogs)||void 0===a?void 0:a.call(e),n=new Blob([JSON.stringify(t)],{type:"application/json"}),o=window.URL.createObjectURL(n),(i=document.createElement("a")).href=o,i.download=null!==(s="consoleLogs-"+e.conversationId)&&void 0!==s?s:".json",i.click(),[2]}))}))}}),m.a.createElement(w.a,{icon:m.a.createElement(Se.a,null),appearance:"subtle",onClick:function(){l(!0)}})),m.a.createElement(Ge.a,null,m.a.createElement(P.a,null,Ye),m.a.createElement(w.a,{icon:m.a.createElement(Qe.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.conversationLogObject){var n=new Blob([JSON.stringify(e.conversationLogObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatConversationLogs-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),m.a.createElement(w.a,{icon:m.a.createElement(Se.a,null),appearance:"subtle",onClick:function(){y(!0)}})),m.a.createElement(Ge.a,null,m.a.createElement(P.a,null,"Sydney Conversation Logs"),m.a.createElement(w.a,{icon:m.a.createElement(Qe.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.sydneyConversationObject){var n=new Blob([JSON.stringify(e.sydneyConversationObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatHistory-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),m.a.createElement(w.a,{icon:m.a.createElement(Se.a,null),appearance:"subtle",onClick:function(){S(!O)}}))))),m.a.createElement(E.a,null,m.a.createElement(I.a,{disableButtonEnhancement:!0},m.a.createElement(ze.a,{icon:m.a.createElement(Se.g,null),appearance:"subtle"})),m.a.createElement(k.a,null,m.a.createElement(j.a,null,m.a.createElement(P.a,{onClick:function(){var t;window.open(null!==(t=e.augloopKustoQueryURL)&&void 0!==t?t:"",lt)}},$e),m.a.createElement(P.a,{onClick:function(){var t;window.open(null!==(t=e.clientKustoQueryURL)&&void 0!==t?t:"",lt)}},et)))))),O&&(null==e?void 0:e.telemetryData)&&m.a.createElement(Re,{telemetryData:null==e?void 0:e.telemetryData,isModalOpen:O,setIsModalOpen:S}),s&&m.a.createElement(dt,{isModalOpen:s,setIsModalOpen:l,getLogs:e.getLogs}),g&&m.a.createElement(ft,{isModalOpen:g,setIsModalOpen:h,sessionId:e.sessionId,conversationLogObject:e.conversationLogObject,appName:e.appName,appPlatform:e.appPlatform,augloopKustoQueryURL:e.augloopKustoQueryURL,clientKustoQueryURL:e.clientKustoQueryURL,sdxVersion:e.sdxVersion}),u&&m.a.createElement(gt,{isModalOpen:u,setIsModalOpen:d,chatInputLoadTime:e.chatInputLoadTime,chatPaneLoadTime:e.chatPaneLoadTime}),b&&m.a.createElement(ut,{isModalOpen:b,setIsModalOpen:y,conversationLogObject:e.conversationLogObject}),T&&m.a.createElement(pt,{isModalOpen:T,setIsModalOpen:null!==(t=null==e?void 0:e.setShowDebugInfoOnMessage)&&void 0!==t?t:A,debugMessageInfoObject:e.debugMessageInfoObject}))},yt=n(2790),Ct=n(552),Ot=n(3348),St=n(882);var Et,xt,It,wt=Object(G.a)(v.b),Tt=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},workflowStepStack:null!==(r=e.workflowStepStack)&&void 0!==r?r:{},cardHeader:null!==(o=e.cardHeader)&&void 0!==o?o:{},userContentButton:null!==(i=e.userContentButton)&&void 0!==i?i:{},userContentButtonItem:null!==(a=e.userContentButton)&&void 0!==a?a:{},userContentButtonDisabled:{},leftAlignedText:{},thumbnail:{},actionButtonStack:{}};return Object(y.a)(s)}({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({maxWidth:"288px"},W.a.padding(wt.spacingVerticalM,wt.spacingHorizontalL)),{fontFamily:"-apple-system"}),W.a.margin(wt.spacingVerticalNone,wt.spacingHorizontalL,wt.spacingVerticalS)),{boxShadow:wt.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(r.__assign)({},W.a.gap(wt.spacingVerticalS)),userContentButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding(wt.spacingVerticalL,wt.spacingHorizontalXL)),{minHeight:"40px"}),W.a.borderRadius(wt.borderRadiusXLarge)),(Fe={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},Fe["& .".concat(St.a.icon)]=Object(r.__assign)({},W.a.margin("0px","11px","0px","0px")),Fe))}),kt=Object(G.a)(v.b),jt={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("12px")),W.a.borderRadius("8px")),W.a.margin("16px")),{boxShadow:kt.shadow4,color:kt.neutralPrimary,backgroundColor:kt.neutralLight}),rootHighContrast:Object(r.__assign)({},W.a.border("1px","solid",kt.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},W.a.gap("4px")),{marginTop:"8px"}),workflowStepStack:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.gap("10px")),W.a.padding("10px","8px","20px","8px")),W.a.overflow("hidden")),cardHeader:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{whiteSpace:"pre-wrap"}),userContentButtonItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:kt.neutralLight},W.a.border("1px","solid",kt.neutralLighterAlt)),Ot.a.body1),(Et={},Et["&:hover .".concat(St.a.icon)]={color:kt.themePrimary},Et)),userContentButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},W.a.padding("0px","15px")),{backgroundColor:kt.neutralLight}),W.a.border("1px","solid",kt.neutralLighterAlt)),Ot.a.body1),(xt={},xt["&:hover .".concat(St.a.icon)]={color:kt.themePrimary},xt)),userContentButtonDisabled:(It={color:kt.neutralQuaternary},It["&:hover .".concat(St.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},It),leftAlignedText:Object(r.__assign)({textAlign:"left"},W.a.padding("0px","8px")),thumbnail:{paddingLeft:"10px"},actionButtonStack:Object(r.__assign)({marginTop:"8px"},W.a.gap("12px"))},Pt=Object(y.a)(jt),At=function(){var e=Pt(),t=Tt();if(Object(o.b)()===o.a.IOS)e=Object(M.k)(e,t);return e},_t=["Step 1","Step 2","Step 3","Step 4","Step 5"],Dt=m.a.memo((function(e){var t,n=e.overrideStyles,o=e.stages,i=e.gotoNextStageString,a=e.index,s=e.lastEnabledStep,l=e.handleButtonClick,c=e.allowForwardNavigation,u=void 0!==c&&c,d=e.displayStatusIcon,p=void 0===d||d,g=At();Object(M.k)(g,n);var h=Object(r.__read)(Object(f.useState)(0),2),v=h[0],b=h[1],y=Object(r.__read)(Object(f.useState)(!1),2),C=y[0],O=y[1],E=Object(r.__read)(Object(f.useState)(!0),2),x=E[0],I=E[1],T=o||_t,k=function(){O(!C)},j=function(e,t,n){void 0===n&&(n={});var r=Object(A.a)(t,e);return m.a.createElement(r,{style:n})};return Object(f.useEffect)((function(){b(a)}),[a]),m.a.createElement(yt.a,{className:g.root,"aria-labelledby":T[0],style:{backgroundColor:"#ecf3fc",margin:"0px",borderRadius:"0px",boxShadow:"none",position:"fixed",width:"-webkit-fill-available",zIndex:"2"}},m.a.createElement(S,null,m.a.createElement(w.a,{size:"large",role:M.a.MENU_ITEM,key:v,disabled:!1,"aria-posinset":1,"aria-setsize":null===(t=T[v])||void 0===t?void 0:t.length,className:g.userContentButton,style:{backgroundColor:"#ebf3fc",border:"none",padding:"0px 10px",height:"fit-content",display:"flex",justifyContent:"space-between"}},m.a.createElement("div",{style:{display:"flex",alignItems:"left"}},m.a.createElement("b",null," ",T[v]),m.a.createElement("div",{onClick:function(){k()},style:{paddingLeft:"8px"}},C?j(Ct.x,Ct.w):j(Ct.n,Ct.m))),x&&m.a.createElement("div",{style:{display:"flex",alignItems:"right"}},m.a.createElement(w.a,{onClick:function(){!function(e){b(e),l(e),e===T.length-1?I(!1):I(!0)}(v+1)}},i[v+1]?i[v+1]:"Go to next step",j(Ct.t,Ct.t))))),C&&m.a.createElement("div",{style:{overflow:"auto",maxHeight:"100vh"}},m.a.createElement(S,{style:g.workflowStepStack},T.map((function(e,t){return m.a.createElement(w.a,{size:"large",role:M.a.MENU_ITEM,key:t,disabled:!1,"aria-posinset":t+1,"aria-setsize":e.length,className:g.userContentButtonItem,onClick:function(){(t<=s||u)&&function(e){b(e),O(!C),l(e),e===T.length-1?I(!1):I(!0)}(t)},icon:p&&(t<s?j(Ct.i,Ct.i,{color:"green"}):t===s?j(Ct.C,Ct.B,{color:"black"}):j(Ct.A,Ct.z,{color:"black"})),style:{border:"none",borderRadius:"8px",boxShadow:t===v?"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)":"none",justifyContent:"flex-start"}},t===v?m.a.createElement("b",null,e):e)})))))})),Lt=n(3384),Mt=n(2461),Bt=function(){return Object(M.m)()?OfficeaicopilotStrings.StopGeneratingButtonLabel:"Stop generating"};var Rt,Ft,Nt,Ht=function(e){var t,n,r,o,i,a,s,l,c={root:null!==(t=e.root)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},loaderHighContrast:{},progressBarStyle:null!==(r=e.progressBarStyle)&&void 0!==r?r:{},headerStyle:null!==(o=e.headerStyle)&&void 0!==o?o:{},stopButtonStyle:null!==(i=e.stopButtonStyle)&&void 0!==i?i:{},stopButtonIconStyle:null!==(a=e.stopButtonIconStyle)&&void 0!==a?a:{},inlineStopIcon:null!==(s=e.inlineStopIcon)&&void 0!==s?s:{},stackStopText:null!==(l=e.stackStopText)&&void 0!==l?l:{}};return Object(y.a)(c)}({loader:Object(r.__assign)(Object(r.__assign)({display:"inline"},W.a.padding("0px")),W.a.borderRadius("12px")),progressBarStyle:{height:"4px"},stackStopText:{display:"flex"}}),Ut=Object(G.a)(v.b),Vt={root:Object(r.__assign)(Object(r.__assign)({alignItems:"center"},W.a.margin(Ut.spacingVerticalNone,Ut.spacingHorizontalL,Ut.spacingVerticalM)),W.a.gap(Ut.spacingVerticalM)),loader:Object(r.__assign)(Object(r.__assign)({minHeight:"48px",backgroundColor:Ut.neutralLight,boxShadow:Ut.shadow4,transformOrigin:"bottom",width:"100%"},W.a.overflow("hidden")),W.a.borderRadius(Ut.borderRadiusXLarge)),loaderHighContrast:Object(r.__assign)({},W.a.border("1px","solid",Ut.neutralLighterAlt)),progressBarStyle:{backgroundImage:"linear-gradient(90.5deg, ".concat(Ut.themeLight," 10%, ").concat(Ut.themeDarkAlt," 32%, ").concat(Ut.themeLighterAlt," 55%, ").concat(Ut.themeLighter," 72%, ").concat(Ut.neutralLighter," 100%)"),backgroundColor:Ut.neutralLight,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:Object(r.__assign)(Object(r.__assign)({fontWeight:Ut.fontWeightSemibold},W.a.padding(Ut.spacingVerticalM)),{lineHeight:"143%",color:Ut.neutralPrimary}),stopButtonStyle:(Rt={fontFamily:Ut.fontFamilyBase,fontSize:Ut.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},Rt["&:hover .".concat(St.a.icon)]={color:Ut.themePrimary},Rt["&:hover:active .".concat(St.a.icon)]={color:Ut.themePrimary},Rt),stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("10px")),W.a.margin(Ut.spacingVerticalNone,Ut.spacingHorizontalNone,Ut.spacingVerticalNone,Ut.spacingHorizontalS)),W.a.border("0px")),(Ft={height:"44px",width:"44px"},Ft["&:hover .".concat(St.a.icon)]={color:Ut.themePrimary},Ft["&:hover:active .".concat(St.a.icon)]={color:Ut.themePrimary},Ft["@media (forced-colors: none)"]={"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},Ft))},zt=Object(y.a)(Vt),Gt=m.a.memo((function(e){var t=e.stylesToOverride,n=e.loadingUiStrings,a=e.stringChangeIntervalDuration,s=void 0===a?3500:a,l=e.showStopButton,c=void 0!==l&&l,u=e.showInlineStopButton,d=void 0!==u&&u,p=e.handleStopButtonOnClick,g=function(){var e=zt(),t=Ht();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),h=Object(i.c)();Object(M.k)(g,t),g.loaderHighContrast=Object(C.a)(g.loader,g.loaderHighContrast);var v=Object(r.__read)(Object(f.useState)(0),2),b=v[0],y=v[1],O=m.a.useRef();return Object(f.useEffect)((function(){c&&null!==O.current&&O.current.focus()}),[c]),Object(f.useEffect)((function(){y(0)}),[JSON.stringify(n)]),Object(f.useEffect)((function(){var e=setInterval((function(){var t=b+1;t===n.length?clearInterval(e):y(t)}),s);return function(){return clearInterval(e)}}),[b,s,n.length]),m.a.createElement(S,{style:g.root},m.a.createElement(S,{style:h?g.loaderHighContrast:g.loader,customProperties:{role:M.a.ALERT,"aria-live":"assertive","aria-atomic":!0}},m.a.createElement(S,{horizontal:!0,style:g.stackStopText},d&&m.a.createElement(w.a,{appearance:"subtle",className:g.inlineStopIcon,icon:m.a.createElement(Se.o,null),onClick:p,"aria-label":Bt(),title:Bt()}),m.a.createElement(Ce.a,{id:Object(M.m)()?OfficeaicopilotStrings.LoadingUiTextLabel:"loadingUiText",className:g.headerStyle},n[b])),m.a.createElement(Lt.a,{bar:{className:g.progressBarStyle},role:"none",thickness:"large",shape:"rounded",title:"ProgressBar"})),c&&m.a.createElement(w.a,{appearance:"subtle",className:g.stopButtonStyle,icon:m.a.createElement(Mt.j,null),ref:O,onClick:p,size:"small","aria-live":"assertive"},Bt()))}));!function(e){e.NEXT_STAGE="NextStage",e.NEXT_CARD="NextCard",e.OPEN_EDITOR="OpenEditor",e.ADD_TOPIC="AddTopic"}(Nt||(Nt={}));var Wt=n(1820),Qt=n(3387),qt=function(){return Object(M.m)()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"wucHeaderText"},Kt=m.a.forwardRef((function(e,t){var n,o=e.overrideStyles,a=e.messageButtonContent,s=e.headerText,l=e.addActionButtonProps,c=e.handleEditorOpenButtonClick,u=e.buttonText,d=void 0===u?"Start Generating":u,p=e.buttonTextInEnabledState,g=void 0===p?"":p,h=e.buttonTextInDisabledState,v=void 0===h?"":h,b=e.buttonRole,y=e.enableCheckBox,O=void 0===y||y,E=e.cardIndex,x=void 0===E?0:E,I=(e.allowItemAddition,e.dialogTitle),T=void 0===I?"New Entry":I,k=e.onSelectCheckBox,j=void 0===k?function(e,t){}:k,P=e.handleOnClickItemAddition,_=void 0===P?function(e){}:P,D=e.handleButtonClick,L=void 0===D?function(e){}:D,B=e.handleClientButtonClick,R=void 0===B?function(e){}:B,F=e.shouldDisableButtonAtBottom,N=void 0!==F&&F,H=At(),V=Object(i.c)(),z=g||d,G=v||d;Object(M.k)(H,o),H.userContentButtonDisabled=Object(C.a)(H.userContentButton,H.userContentButtonDisabled),H.rootHighContrast=Object(C.a)(H.root,H.rootHighContrast);var W=Object(r.__read)(Object(f.useState)(a),2),Q=W[0],q=W[1],K=Object(r.__read)(Object(f.useState)(!0),2),Y=K[0],Z=K[1],J=Object(r.__read)(Object(f.useState)(z),2),X=J[0],$=J[1],ee=Object(r.__read)(Object(f.useState)(!1),2),te=ee[0],ne=ee[1],re=Object(r.__read)(Object(f.useState)(""),2),oe=re[0],ie=re[1],ae=function(e){ne(!0),_(e)},se=function(e,t){var n;void 0===t&&(t=!0);var o=Object(r.__spreadArray)([],Object(r.__read)(Q),!1),i=Object(r.__spreadArray)([],Object(r.__read)(ve),!1);o.length>0&&o[o.length-1].isAddItemButton?(o.splice(o.length-1,0,e),i.splice(i.length-1,0,t)):(o.push(e),i.push(t)),j(t,null!==(n=e.boldText)&&void 0!==n?n:""),q(o),be(i)};Object(f.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){void 0===t&&(t=!0),se(e,t)}}}));var le=function(e,t,n){void 0===n&&(n={});var r=Object(A.a)(t,e);return m.a.createElement(r,{style:n})},ce=new Array(null==a?void 0:a.length).fill(!1),ue=Object(r.__read)(Object(f.useState)(ce),2),ve=ue[0],be=ue[1];return m.a.createElement(yt.a,{className:V?H.rootHighContrast:H.root,"aria-labelledby":qt()},s&&m.a.createElement(U,null,m.a.createElement(Ce.a,{id:qt(),className:H.cardHeader},s)),Q&&m.a.createElement(S,{style:H.buttonStack,customProperties:{role:M.a.MENU}},Q.map((function(e,t){return m.a.createElement(w.a,{size:"large",role:M.a.MENU_ITEM,key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":Q.length,className:e.isDisabled?H.userContentButtonDisabled:H.userContentButton,style:e.isAddItemButton?{borderBlockStyle:"dashed"}:{},onClick:function(){e.onSelectButton&&e.onSelectButton(),e.isAddItemButton&&ae()}},m.a.createElement("div",{style:{display:"flex",alignItems:"center"}},O&&!e.isAddItemButton&&m.a.createElement("div",{onClick:function(){var n=function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(ve),!1);return t[e]=!t[e],be(t),Z(!0),$(z),t[e]}(t);e.onSelectCheckBox&&e.onSelectCheckBox(n,e.boldText),j&&j(n,e.boldText)}},ve[t]?le(Ct.j,Ct.j,{color:"green"}):le(Mt.i,Mt.i)),e.iconUrl&&m.a.createElement("img",{className:H.thumbnail,src:e.iconUrl,alt:"",height:20,width:20}),e.boldText?m.a.createElement("div",null,m.a.createElement("p",{className:H.leftAlignedText,title:e.buttonHyperLinkToolTip?e.buttonHyperLinkToolTip:"",onClick:e.buttonHyperLink?function(){return window.open(e.buttonHyperLink,"_blank")}:function(){return console.log("Link not available for button")}},m.a.createElement("b",null," ",e.boldText," ")," ",e.message)):m.a.createElement("p",null,e.message)))})),m.a.createElement(de.a,{modalType:"modal",open:te},m.a.createElement(pe.a,{className:H.root,tabIndex:0},m.a.createElement(ge.a,null,m.a.createElement(he.a,{className:H.buttonStack,action:m.a.createElement(fe.a,{action:"close"},m.a.createElement(w.a,{appearance:"subtle","aria-label":"close",icon:m.a.createElement(Se.n,null),onClick:function(){return ne(!1)}}))},null!=T?T:"Add Item"),m.a.createElement(me.a,null,m.a.createElement(Wt.a,{onChange:function(e,t){return ie(t)},className:H.root,styles:{fieldGroup:{borderColor:"transparent"}}})),m.a.createElement(Qt.a,{className:H.buttonStack},m.a.createElement(w.a,{className:H.buttonStack,appearance:"primary",onClick:function(){if(!(a.length-2<0||0===oe.length)){var e={boldText:oe};ne(!1),se(e,!0)}}},"Submit")))))),m.a.createElement(S,{horizontal:!0,style:H.actionButtonStack},l&&m.a.createElement(U,null,m.a.createElement(w.a,{appearance:null!==(n=l.appearance)&&void 0!==n?n:void 0,onClick:function(){l.isEditorNeedToOpen?c&&c():ae()}},l.text)),d.length>0&&m.a.createElement(U,null,m.a.createElement(w.a,{appearance:null!=b?b:void 0,disabled:!Y||(null==Q?void 0:Q.length)>0&&O&&!ve.some((function(e){return e})),onClick:function(){var e;N||(e=x,Z(!1),$(G),L&&L(e),R&&R(e))}},X))))})),Yt=m.a.memo(Kt),Zt=m.a.forwardRef((function(e,t){var n=e.onClickNextStage,o=void 0===n?function(e){}:n,i=e.onClickNext,a=void 0===i?function(e){}:i,s=e.stageIndex,l=void 0===s?1:s,c=e.data,u=void 0===c?{}:c,d=null==u?void 0:u.componentRenderData,p=Object(f.useRef)();return Object(f.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=p.current)||void 0===n||n.addUserContentMessageItem(e,t)}}})),m.a.createElement(S,null,d.map((function(e,t){return e.handleButtonClick=function(){a(l),o(l)},m.a.createElement(Yt,Object(r.__assign)({ref:p,key:t,cardIndex:1},e))})))})),Jt=Zt,Xt=f.forwardRef((function(e,t){e.stageHeader;var n=e.onClientInteractionData,o=void 0===n?function(e){}:n,i=(e.getComponentRenderData,e.shouldEnableNext,e.onClickNext),a=void 0===i?function(e){}:i,s=(e.isHTMLEditorUpdateRequired,e.stageIndex),l=void 0===s?0:s,c=e.onClickNextStage,u=void 0===c?function(e){}:c,d=e.data,p=void 0===d?{}:d,g=function(e){var t,n,o=0;try{for(var i=Object(r.__values)(e),a=i.next();!a.done;a=i.next()){if(a.value.buttonAction==Nt.NEXT_CARD)return o;o++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}(null==p?void 0:p.componentRenderData),h=new Set,m=f.useRef(),v=Object(r.__read)(f.useState(h),2),b=v[0],y=v[1];f.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=m.current)||void 0===n||n.addUserContentMessageItem(e,t)}}}));var C=Object(r.__read)(f.useState(g),2),O=C[0],E=C[1],x=function(e){if(E(e+1),o){var t=Object(r.__spreadArray)([],Object(r.__read)(b),!1);o(t)}},I=(null==p?void 0:p.componentRenderData)?null==p?void 0:p.componentRenderData:[];return f.createElement(S,null,I.map((function(e,t){var n=Object(r.__assign)({},e);if(n.onSelectCheckBox=function(e,t){!function(e,t){var n=new Set(b);n.has(t)&&!e?n.delete(t):!n.has(t)&&e&&n.add(t),y(n)}(e,t)},e.buttonAction===Nt.NEXT_STAGE?n.handleButtonClick=function(){a(l),u(l)}:e.buttonAction===Nt.NEXT_CARD&&(n.handleButtonClick=function(){return x(t)}),t<=O)return f.createElement(Yt,Object(r.__assign)({ref:m,key:t,cardIndex:l},n))})))})),$t=Xt,en=m.a.forwardRef((function(e,t){e.workflowName;var n=e.workflowStages,o=void 0===n?[]:n,i=e.handleEditorOpenButtonClick,a=e.enableALSession,s=void 0!==a&&a,l=e.workflowLoadingUiStrings,c=void 0===l?["Working on it..."]:l,u=e.allowForwardNavigation,d=void 0!==u&&u,p=e.displayStatusIconInStepper,g=void 0===p||p,h=Object(r.__read)(m.a.useState(0),2),f=h[0],v=h[1],b=Object(r.__read)(m.a.useState(!0),2),y=b[0],C=b[1],O=Object(r.__read)(m.a.useState(0),2),E=O[0],x=O[1],I=m.a.useRef(),w=m.a.useRef();m.a.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n,r;y?null===(n=I.current)||void 0===n||n.addUserContentMessageItem(e,t):null===(r=w.current)||void 0===r||r.addUserContentMessageItem(e,t)}}})),m.a.useEffect((function(){o.map((function(e,t){var n,r,o;(null===(n=e.data)||void 0===n?void 0:n.componentRenderData)&&(null===(o=null===(r=e.data)||void 0===r?void 0:r.componentRenderData)||void 0===o||o.map((function(e,t){var n;e.addActionButtonProps&&(null===(n=e.addActionButtonProps)||void 0===n?void 0:n.isEditorNeedToOpen)&&(e.handleEditorOpenButtonClick=i)})))}))})),m.a.useEffect((function(){f>E&&x(f)}),[f,E]),m.a.useEffect((function(){}),[f]);var T=Object(r.__read)(m.a.useState(!1),2),k=T[0],j=T[1];m.a.useEffect((function(){k&&(o[f].shouldEnableNext&&o[f].shouldEnableNext()?j(!1):s||setTimeout((function(){j(!1)}),2e3))}));var P=function(e){var t,n;j(!0),(null===(t=o[e+1])||void 0===t?void 0:t.getComponentRenderData)&&(null===(n=o[e+1])||void 0===n||n.getComponentRenderData()),v(e)},A={loadingUiStrings:c},_=o.slice(1),D=function(e){var t=[];return e.forEach((function(e,n){t.push(e.useCompleteStageHeader?e.stageHeader:"Step "+(n+1)+": "+e.stageHeader)})),t}(_),L=o.map((function(e){return e.gotoNextStageString})),M=o[0];return M.onClickNextStage=function(){C(!1)},M.stageIndex=0,y?m.a.createElement(S,null,m.a.createElement(Jt,Object(r.__assign)({ref:I},M))):m.a.createElement(S,null,m.a.createElement("div",{style:{height:"46px"}}),m.a.createElement(Dt,{stages:D,gotoNextStageString:L,handleButtonClick:function(e){var t,n,r;(null===(t=_[f])||void 0===t?void 0:t.onClickNext)&&_[f].onClickNext(e),e>f&&(j(!0),(null===(n=o[e+1])||void 0===n?void 0:n.getComponentRenderData)&&(null===(r=o[e+1])||void 0===r||r.getComponentRenderData())),v(e)},index:f,lastEnabledStep:E,allowForwardNavigation:d,displayStatusIcon:g}),_.map((function(e,t){if(t===f){if(k)return m.a.createElement(Gt,Object(r.__assign)({key:t},A));var n=e;return e.stageIndex=t+1,e.onClickNextStage=P,m.a.createElement($t,Object(r.__assign)({ref:w,key:t},n))}})))})),tn=n(3388),nn=n(3389),rn=n(3390),on=n(3600),an=n(3601),sn=n(1498),ln=function(){return Object(M.m)()?OfficeaicopilotStrings.RestrictiveSearchMessageTitleText:"Your organization's admin has restricted Copilot from accessing certain SharePoint sites."},cn=function(){return Object(M.m)()?OfficeaicopilotStrings.RestrictiveSearchMessageBodyText:"This limits the content Copilot can search and reference when responding to your prompts."},un=function(e){var t=e.handleRestrictiveMsgDismissClick,n=Object(r.__read)(m.a.useState(!0),2),o=n[0],i=n[1],a=m.a.useRef(null),s=function(){i(!o)};return m.a.createElement(rn.a,null,m.a.createElement(on.a,{intent:"info",ref:a},function(){var e;if(o){var t=Math.round(.2*(null===(e=a.current)||void 0===e?void 0:e.offsetWidth)),n=ln(),r=cn();if(n.length<t){var i=t-n.length;r=r.substring(0,i)+"..."}else n=n.substring(0,t),r="...";return m.a.createElement(tn.a,null,m.a.createElement(nn.a,null,n),r)}return m.a.createElement(tn.a,null,m.a.createElement(nn.a,null,ln()),cn()," ",m.a.createElement(ht.a,{href:"https://go.microsoft.com/fwlink/p/?linkid=2260808"},Object(M.m)()?OfficeaicopilotStrings.LearnMoreString:"Learn More"))}(),m.a.createElement(an.a,{containerAction:m.a.createElement("div",null,m.a.createElement(w.a,{appearance:"transparent",icon:o?m.a.createElement(Ct.n,null):m.a.createElement(Ct.x,null),onClick:s}),m.a.createElement(w.a,{appearance:"transparent",icon:m.a.createElement(sn.s,null),onClick:t}))})))},dn=n(3392),pn=n(3354);var gn,hn,fn=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},freCard:null!==(n=e.freCard)&&void 0!==n?n:{},freImage:null!==(r=e.freImage)&&void 0!==r?r:{},freHeaderText:null!==(o=e.freHeaderText)&&void 0!==o?o:{},freDescriptionText:null!==(i=e.freDescriptionText)&&void 0!==i?i:{},freButton:null!==(a=e.freButton)&&void 0!==a?a:{}};return Object(y.a)(s)}({freCard:Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("12px")),{maxWidth:"288px"}),freHeaderText:{fontFamily:"-apple-system",lineHeight:"normal"},freDescriptionText:{marginTop:"12px",fontFamily:"-apple-system",lineHeight:"normal"},freButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("16px")),W.a.borderRadius("12px")),{minHeight:"52px",height:"auto",fontFamily:"-apple-system",fontWeight:"600",fontSize:"17px",justifyContent:"center"})}),mn=Object(G.a)(v.b),vn={freCard:{},root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("12px","16px")),{alignItems:"center",textAlign:"center",color:mn.neutralPrimary,backgroundColor:mn.neutralLight,boxShadow:mn.shadow4}),W.a.margin("1px","16px","none")),W.a.border("1px","solid",mn.neutralLight)),W.a.borderRadius("8px")),freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:Object(r.__assign)(Object(r.__assign)({textAlign:"center",whiteSpace:"pre-wrap"},W.a.padding("1px")),W.a.margin("20px","0px","0px")),freButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:mn.neutralLight,width:"100%"},W.a.padding("5px","12px")),W.a.margin("20px","0px","0px")),W.a.borderRadius("4px")),{"@media (forced-colors: none)":Object(r.__assign)(Object(r.__assign)({backgroundColor:mn.themePrimary},W.a.border("none")),{":hover":Object(r.__assign)({color:mn.neutralLight,backgroundColor:mn.themePrimary},W.a.border("none")),":active":Object(r.__assign)({color:mn.neutralLight,backgroundColor:mn.themePrimary},W.a.border("none"))})})},bn=Object(y.a)(vn),yn=function(){return Object(M.m)()?OfficeaicopilotStrings.FREHeaderTextLabel:"freSharedHeaderText"},Cn=function(e){var t=e.headerText,n=void 0===t?Object(M.m)()?OfficeaicopilotStrings.FREHeaderText:"Copilot is here to help!":t,r=e.descriptionText,i=e.freImagePath,a=e.handleFreButtonClick,s=void 0===a?function(){}:a,l=e.shouldFocusOnComponentMount,c=void 0!==l&&l,u=e.hideGetStartedButton,d=void 0!==u&&u,p=e.overrideStyles,g=function(){var e=bn(),t=fn();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}();Object(M.k)(g,p);var h=" "+n+" ",v=" "+r+" ";return Object(f.useEffect)((function(){var e;c&&(null===(e=document.getElementById("FreSharedId"))||void 0===e||e.focus())})),m.a.createElement(S,{style:g.root,customProperties:{role:M.a.GROUP,"aria-labelledby":yn()}},m.a.createElement(V.a,{src:i,className:g.freImage,alt:""}),m.a.createElement(dn.a,{id:yn(),className:g.freHeaderText},h),m.a.createElement(pn.a,{id:Object(M.m)()?OfficeaicopilotStrings.FREDescriptionTextLabel:"freSharedDescription",className:g.freDescriptionText},v),d?null:m.a.createElement(w.a,{className:g.freButton,onClick:s},Object(M.m)()?OfficeaicopilotStrings.FREButtonText:"Get started"))},On=function(){return Object(M.m)()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"zqmHeaderText"};var Sn,En,xn,In,wn,Tn=Object(G.a)(v.b),kn=function(e){var t,n,r,o,i,a={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},cardHeader:null!==(r=e.cardHeader)&&void 0!==r?r:{},zeroQueryButton:null!==(o=e.zeroQueryButton)&&void 0!==o?o:{},zeroQueryButtonDisabled:{},zeroQuerySkillText:null!==(i=e.zeroQuerySkillText)&&void 0!==i?i:{}};return Object(y.a)(a)}({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({maxWidth:"288px"},W.a.padding(Tn.spacingVerticalM,Tn.spacingHorizontalL)),{fontFamily:"-apple-system"}),W.a.margin(Tn.spacingVerticalNone,Tn.spacingHorizontalL,Tn.spacingVerticalS)),{boxShadow:Tn.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(r.__assign)({},W.a.gap(Tn.spacingVerticalS)),zeroQueryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding(Tn.spacingVerticalL,Tn.spacingHorizontalXL)),{minHeight:"40px"}),W.a.borderRadius(Tn.borderRadiusXLarge)),(gn={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},gn["& .".concat(St.a.icon)]=Object(r.__assign)({},W.a.margin("0px","11px","0px","0px")),gn)),zeroQuerySkillText:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("4px")),{backgroundColor:Q.a.colorNeutralBackground3,color:Q.a.colorNeutralForeground2}),W.a.padding("3px")),(hn={},hn["&:hover"]={backgroundColor:Q.a.colorNeutralBackground2Hover,color:Q.a.colorNeutralForeground1Hover},hn))}),jn=Object(G.a)(v.b),Pn={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("12px")),W.a.borderRadius("8px")),W.a.margin("16px")),{boxShadow:jn.shadow4,color:jn.neutralPrimary,backgroundColor:jn.neutralLight}),rootHighContrast:Object(r.__assign)({},W.a.border("1px","solid",jn.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},W.a.gap("4px")),{marginTop:"8px"}),cardHeader:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{whiteSpace:"pre-wrap"}),zeroQueryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",height:"fit-content",textAlign:"start",backgroundColor:jn.neutralLight},W.a.border("1px","solid",jn.neutralLighterAlt)),Ot.a.body1),(Sn={},Sn["&:hover .".concat(St.a.icon)]={color:jn.themePrimary},Sn)),zeroQueryButtonDisabled:(En={color:jn.neutralQuaternary},En["&:hover .".concat(St.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},En),zeroQuerySkillText:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("4px")),{backgroundColor:Q.a.colorNeutralBackground3,color:Q.a.colorNeutralForeground2}),W.a.padding("3px")),(xn={},xn["&:hover"]={backgroundColor:Q.a.colorNeutralBackground2Hover,color:Q.a.colorNeutralForeground1Hover},xn))},An=Object(y.a)(Pn),_n=n(698),Dn=m.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.headerText,a=e.isHVCAppChatV2Enabled,s=e.hvcPromptStringsList,l=e.handleButtonClick,c=void 0===l?function(e){console.log("suggestion clicked:"+e)}:l,u=function(){var e=An(),t=kn();Object(o.b)()===o.a.IOS&&(e=Object(M.k)(e,t));return e}(),d=Object(i.c)();Object(M.k)(u,t),u.zeroQueryButtonDisabled=Object(C.a)(u.zeroQueryButton,u.zeroQueryButtonDisabled),u.rootHighContrast=Object(C.a)(u.root,u.rootHighContrast);return m.a.createElement(yt.a,{className:d?u.rootHighContrast:u.root,"aria-labelledby":On()},m.a.createElement(U,null,m.a.createElement(Ce.a,{id:On(),className:u.cardHeader},r)),m.a.createElement(S,{style:u.buttonStack,customProperties:{role:M.a.MENU}},n.map((function(e,t){var r,o,i,l=[];return a&&(null==s?void 0:s.length)>0&&(l=Object(M.g)(e.promptSuggestion,s)),m.a.createElement(w.a,{size:"large",role:M.a.MENU_ITEM,icon:(r=e.iconRegular,o=e.iconHover,i=Object(A.a)(o,r),m.a.createElement(i,null)),key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":n.length,className:e.isDisabled?u.zeroQueryButtonDisabled:u.zeroQueryButton,onClick:function(){c(e.promptSuggestion)}},a&&l.length>0?l.map((function(e,t){return e.promptType===_n.a.Skill?m.a.createElement("span",{className:u.zeroQuerySkillText,key:t},e.promptText):m.a.createElement("span",{key:t},e.promptText)})):e.promptSuggestion)}))))})),Ln=n(2809),Mn=n(1458),Bn=Object(G.a)(v.b),Rn={root:Object(r.__assign)(Object(r.__assign)({},W.a.margin("16px")),W.a.gap("8px")),zeroQueryV2Button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",height:"auto",textAlign:"start",backgroundColor:Q.a.colorNeutralBackground1},W.a.padding("12px","16px")),W.a.borderRadius("8px")),W.a.gap("8px")),Ot.a.body1),(In={boxShadow:Q.a.shadow2},In["&:hover"]={boxShadow:Q.a.shadow8,backgroundColor:Q.a.colorNeutralBackground1},In["& .".concat(Mn.a.prompt)]={gridColumnStart:"icon"},In)),zeroQuerySkillText:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("4px")),{backgroundColor:Q.a.colorNeutralBackground3,color:Q.a.colorNeutralForeground2}),W.a.padding("3px")),(wn={},wn["&:hover"]={backgroundColor:Q.a.colorNeutralBackground2Hover,color:Q.a.colorNeutralForeground1Hover},wn)),zeroQueryHintText:{color:Q.a.colorNeutralForeground4},zeroQueryIcon:{color:Bn.themePrimary}},Fn=Object(y.a)(Rn),Nn=m.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.isHVCAppChatV2Enabled,o=e.hvcPromptStringsList,i=e.handleButtonClick,a=Fn();Object(M.k)(a,t);return m.a.createElement(S,{style:a.root,customProperties:{role:M.a.MENU}},n.map((function(e,t){var s,l,c,u,d,p,g,h,f="",v="",b="",y="",C=[];if(r)if((null==o?void 0:o.length)>0)C=Object(M.g)(e.promptSuggestionText,o);else{var O=Object(M.c)(e.promptSuggestionText);b=null!==(s=null==O?void 0:O.prefixText)&&void 0!==s?s:"",y=null!==(l=null==O?void 0:O.skillText)&&void 0!==l?l:"",f=null!==(c=null==O?void 0:O.inputText)&&void 0!==c?c:"",v=null!==(u=null==O?void 0:O.hintText)&&void 0!==u?u:""}else{O=Object(M.b)(e.promptSuggestionText);f=null!==(d=null==O?void 0:O.inputText)&&void 0!==d?d:"",v=null!==(p=null==O?void 0:O.hintText)&&void 0!==p?p:""}return m.a.createElement(Ln.a,{role:M.a.MENU_ITEM,icon:(g=e.iconRegular,h=g,m.a.createElement(h,{className:a.zeroQueryIcon})),key:t,disabled:e.isDisabled||!1,"aria-posinset":t+1,"aria-setsize":n.length,className:a.zeroQueryV2Button,category:e.promptSuggestionCategory,prompt:0===C.length?m.a.createElement(pn.a,null,r&&b,r&&y.length>0&&m.a.createElement("span",{className:a.zeroQuerySkillText},y),f,m.a.createElement("span",{className:a.zeroQueryHintText},v)):m.a.createElement(pn.a,null,C.map((function(e,t){switch(e.promptType){case _n.a.Ghost:return m.a.createElement("span",{className:a.zeroQueryHintText},e.promptText);case _n.a.Skill:return m.a.createElement("span",{className:a.zeroQuerySkillText},e.promptText);case _n.a.Regular:default:return m.a.createElement("span",null,e.promptText)}}))),onClick:function(){var t=f;y.length>0&&(t=b+y+t),C.length>0&&(t=C.map((function(e){return e.promptType===_n.a.Ghost||e.promptType===_n.a.File?"":e.promptText})).join("")),i(t,e.promptSuggestionText)}})})))})),Hn=n(3333);function Un(){return Object(M.m)()?OfficeaicopilotStrings.DeleteAllChatHistoryButtonText:"Delete all Copilot history"}function Vn(){return Object(M.m)()?OfficeaicopilotStrings.NewConversationButtonText:"Create new conversation"}function zn(){return Object(M.m)()?OfficeaicopilotStrings.ShowChatHistoryButtonText:"Chat history"}var Gn,Wn=Object(G.a)(v.c),Qn={root:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("visible")),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:Wn.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:Wn.colorNeutralBackground3Hover}}})},qn={root:Object(r.__assign)({},W.a.border("none"))},Kn=Object(y.a)(Qn),Yn=Object(y.a)(qn),Zn={ShowChatHistoryAllButton:Object(r.__assign)({},W.a.margin("0px","16px"))},Jn=Object(y.a)(Zn),Xn=f.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return f.createElement(w.a,{className:Object(C.a)(Kn().root,Jn().ShowChatHistoryAllButton,n),icon:f.createElement(Hn.b,{className:r}),onClick:t,"aria-label":zn()},zn())})),$n=n(3570),er=n(3403),tr=n(3579),nr=n(2853),rr=function(e){var t,n,r=At();return m.a.createElement(S,{style:r.root,customProperties:{role:M.a.MENU}},m.a.createElement(er.a,{variant:"medium"},null!==(t=e.launchText)&&void 0!==t?t:"Would you like to use Copilot Workflows to generate the content based on the steps recommended by your organization?"),m.a.createElement(S,{horizontal:!0},m.a.createElement(U,null,m.a.createElement(w.a,{appearance:"primary",style:{marginTop:"5px",borderBlockStyle:"dashed"},onClick:function(){var t;null===(t=e.onLaunch)||void 0===t||t.call(e)}},m.a.createElement(tr.a,{style:{marginRight:"5px",paddingTop:"3px"}},function(e,t,n){void 0===n&&(n={});var r=Object(A.a)(t,e);return m.a.createElement(r,{style:n})}(nr.e,nr.e)),null!==(n=e.buttonText)&&void 0!==n?n:"Launch Copilot Workflows"))))},or=n(1564),ir=function(){return f.useContext(or.a)},ar=Object(G.a)(v.b),sr={stack:{},AccordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:ar.neutralPrimary,marginBottom:"8px"},AccordionCardButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"},W.a.margin("5px","6px","0px","4px")),W.a.border("1px","solid",ar.neutralLighterAlt)),W.a.borderRadius("4px")),W.a.padding("6px","10px","6px","6px")),(Gn={backgroundColor:"transparent",color:ar.neutralPrimary,top:"0",zIndex:"1",float:"right",height:"auto"},Gn["& .".concat(St.a.icon)]={fontSize:"inherit",height:"inherit",marginRight:"4px"},Gn["&:hover:enabled"]={color:ar.black},Gn["&:focus"]={color:ar.black},Gn["&:disabled"]=Object(r.__assign)(Object(r.__assign)({},W.a.borderColor(ar.neutralPrimaryAlt)),{color:ar.neutralQuaternary,backgroundColor:ar.neutralTertiary}),Gn))},lr=Object(y.a)(sr),cr=function(e){var t=e.styles,n=e.cardButtons,r=Object(M.k)(lr(),t);return m.a.createElement(tr.a,{horizontal:!0,wrap:!0},m.a.createElement(tr.a,{horizontal:!0,className:r.AccordionCardFooter},null==n?void 0:n.map((function(e,t){return m.a.createElement(w.a,{tabIndex:0,key:t,className:r.AccordionCardButton,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:null==e?void 0:e.handleOnMouseEnter,onMouseLeave:null==e?void 0:e.handleOnMouseLeave,onFocus:null==e?void 0:e.handleOnMouseEnter,onBlur:null==e?void 0:e.handleOnMouseLeave},e.buttonText)}))))},ur=Object(G.a)(v.b),dr={stack:{"> *":{marginBottom:"12px"}},contentCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",ur.neutralLighterAlt)),W.a.margin("8px","20px","8px","15px")),W.a.padding("8px")),{boxShadow:ur.shadow4,backgroundColor:ur.neutralLight}),W.a.borderRadius(ur.borderRadiusXLarge)),{overflowWrap:"anywhere",color:ur.neutralPrimary}),contentHeader:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{marginBottom:"12px"})},pr=Object(y.a)(dr);function gr(e,t){return m.a.createElement(cr,{styles:e,cardButtons:t})}var hr=function(e){var t,n,r=e.styles,o=e.body,i=Object(M.k)(pr(),r),a=o.renderHeader?o.renderHeader((function(){})):(null===(t=o.cardContent)||void 0===t?void 0:t.contentHeader)?m.a.createElement(Ce.a,{className:i.contentHeader},o.cardContent.contentHeader):void 0,s=function(){var e;return null===(e=o.cardContent)||void 0===e?void 0:e.contentBody},l=o.renderBody?o.renderBody((function(){return s(o.cardContent)})):s(o.cardContent),c=o.renderFooter?o.renderFooter((function(){var e;return gr(r,null===(e=o.cardContent)||void 0===e?void 0:e.cardButtons)})):gr(r,null===(n=o.cardContent)||void 0===n?void 0:n.cardButtons);return m.a.createElement(S,{style:i.contentCard,customProperties:{tabIndex:-1}},a,l,c)},fr=n(215),mr=function(e){return Object(y.a)({accordionCardRoot:{paddingTop:"5px",marginBottom:"8px",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",fontWeight:"400",lineHeight:"20px"},accordionCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({flexWrap:"wrap",backgroundColor:"".concat(e.palette.white)},W.a.border("1px","solid",e.palette.neutralLighterAlt)),W.a.borderRadius("8px")),{marginLeft:"15px",marginRight:"20px"}),W.a.gap("4px")),W.a.padding("8px")),{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)","> *":{marginBottom:"12px"}}),cardHeader:Object(r.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},W.a.margin("12px 12px 0 12px")),contentHeader:Object(r.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},W.a.margin("4px")),contentTitleGroup:{display:"block",width:"auto","> button":{marginLeft:"10px",marginTop:"5px",width:"16px",height:"16px",color:"".concat(e.palette.black),top:"0",zIndex:"1",float:"right",selectors:{":hover":{backgroundColor:"transparent",color:"".concat(e.palette.black)},":focus":{backgroundColor:"transparent",color:"".concat(e.palette.black)}},"> i":{fontSize:"12px"}}}})},vr=n(1852),br=function(e){var t=e.index,n=m.a.useRef(),o=Object(r.__read)(m.a.useState(!1),2),i=o[0],a=o[1],s=function(e){var t;a(!i),null===(t=n.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault()},l=ir(),c=mr(l)(),u={styles:e.styles,feedbackSectionPosition:fr.a.None,shouldShowAIGeneratedIndicator:!0,body:{cardContent:e.cardContent,renderHeader:function(n){if(void 0!==e.cardContent){var r=m.a.createElement(vr.a,{id:"RelatedQuestionExpand".concat(t),iconProps:{iconName:"ChevronDown"},onClick:s,"data-is-focusable":!1,tabIndex:-1,ariaLabel:""});return m.a.createElement(S,null,m.a.createElement(S,{style:Object(C.a)(c.contentTitleGroup,e.styles.contentTitleGroup)},m.a.createElement(er.a,{className:c.contentHeader},e.cardContent.contentHeader),r),i&&e.cardContent.contentBody?n():void 0)}},renderBody:function(t){if(i&&e.cardContent.contentBody)return t()},renderFooter:function(t){return i&&e.cardContent.contentBody?t():null}}};return m.a.createElement(hr,Object(r.__assign)({key:t,styles:e.styles},u))},yr=function(e,t){if(!t.cardContent.length)return null;try{if(1===t.cardContent.length){var n={styles:e,feedbackSectionPosition:fr.a.None,body:{cardContent:t.cardContent[0],renderHeader:function(){return m.a.createElement(er.a,{className:e.contentHeader},t.cardContent[0].contentHeader)}}};return m.a.createElement(S,null,m.a.createElement(hr,Object(r.__assign)({key:0},n)))}return m.a.createElement(S,null,t.cardContent.map((function(t,n){return m.a.createElement(br,{key:n,index:n,styles:e,cardContent:t})})))}catch(e){return null}},Cr=function(e){var t=e.styles,n=e.body,r=ir(),o=mr(r)(),i={role:M.a.LIST_ITEM,"aria-live":"assertive",tabIndex:0};return m.a.createElement(S,{style:Object(C.a)(o.accordionCardRoot,t.accordionCardRoot),customProperties:i},m.a.createElement(S,{style:Object(C.a)(o.accordionCard,t.accordionCard),customProperties:{tabIndex:-1}},m.a.createElement(S,null,m.a.createElement(er.a,{className:o.cardHeader},n.cardHeader),yr(o,n))))},Or=function(e){var t,n,r,o,i,a,s,l,c,u;return{buttonBarRoot:null!==(t=e.buttonBarRoot)&&void 0!==t?t:{},primaryButton:null!==(n=e.primaryButton)&&void 0!==n?n:{},defaultButton:null!==(r=e.defaultButton)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{},combinedButtonIcon:null!==(i=e.combinedButtonIcon)&&void 0!==i?i:{},iconButton:null!==(a=e.iconButton)&&void 0!==a?a:{},combinedButton:null!==(s=e.combinedButton)&&void 0!==s?s:{},minifiedButton:null!==(l=e.minifiedButton)&&void 0!==l?l:{},showMeButton:null!==(c=e.showMeButton)&&void 0!==c?c:{},showMeButtonBarRoot:null!==(u=e.showMebuttonBarRoot)&&void 0!==u?u:{}}};function Sr(e){var t=Or(e);return Object(y.a)(t)}var Er,xr,Ir,wr,Tr={combinedButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:"40px",minWidth:"40px"},W.a.padding("4px","8px")),Ot.a.caption1),{fontFamily:"-apple-system",lineHeight:"normal"})},kr=(Sr(Tr),Object(G.a)(v.b)),jr=Object(r.__assign)(Object(r.__assign)({backgroundColor:kr.neutralLight},W.a.border("1px","solid",kr.neutralLighterAlt)),W.a.borderRadius(kr.borderRadiusMedium)),Pr=Object(r.__assign)({height:"16px",width:"16px"},W.a.padding(0)),Ar=Object(r.__assign)(Object(r.__assign)({height:"24px",minWidth:"20px"},W.a.padding("4px","8px")),Ot.a.caption1),_r={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px",flexWrap:"wrap",rowGap:"8px"},showMeButtonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row"},primaryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",kr.themeSecondary)),W.a.borderRadius(kr.borderRadiusMedium)),{"@media (forced-colors: none)":{backgroundColor:kr.themeSecondary,"&:hover":Object(r.__assign)({backgroundColor:kr.themePrimary},W.a.border("1px","solid",kr.themePrimary)),"&:active":Object(r.__assign)({backgroundColor:kr.themePrimary},W.a.border("1px","solid",kr.themePrimary)),"&:disabled":Object(r.__assign)({backgroundColor:kr.neutralLighter},W.a.border("1px","solid",kr.neutralQuaternary)),"&:hover:active":Object(r.__assign)({backgroundColor:kr.themeTertiary},W.a.border("1px","solid",kr.themeTertiary))}}),defaultButton:Object(r.__assign)({},jr),showMeButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:kr.neutralLight},W.a.border("1px","solid",kr.neutralLighterAlt)),W.a.borderRadius(kr.borderRadiusMedium)),{"&:hover":{color:kr.themePrimary}}),icon:Object(r.__assign)(Object(r.__assign)({height:"24px",width:"24px"},W.a.padding(0)),(Er={},Er["&".concat(St.a.icon)]={height:"20px",width:"20px"},Er)),combinedButtonIcon:Object(r.__assign)(Object(r.__assign)({},Pr),(xr={},xr["&".concat(St.a.icon)]={height:"16px",width:"16px"},xr)),iconButton:Object(r.__assign)({height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},W.a.padding("2px")),combinedButton:Object(r.__assign)({},Ar),minifiedButton:(Ir={height:"40px",width:"44px",minWidth:"44px"},Ir["&".concat(St.a.icon)]={height:"24px",width:"24px"},Ir)},Dr=(Object(y.a)(_r),Object(y.a)({emptyIcon:{height:"0px",width:"0px"}}),Object(y.a)({authButton:Object(r.__assign)(Object(r.__assign)({},jr),Ar),appIcon:Object(r.__assign)({},Pr),title:Object(r.__assign)({},Ot.a.caption1)})),Lr=function(e){var t,n,r,o,i,a,s,l;return{footerBar:null!==(t=e.footerBar)&&void 0!==t?t:{},headerBar:null!==(n=e.headerBar)&&void 0!==n?n:{},feedbackButton:null!==(r=e.feedbackButton)&&void 0!==r?r:{},feedbackButtonsStack:null!==(o=e.feedbackButtonsStack)&&void 0!==o?o:{},feedbackText:null!==(i=e.feedbackText)&&void 0!==i?i:{},feedbackTextMinified:null!==(a=e.feedbackTextMinified)&&void 0!==a?a:{},feedbackDisclaimerStack:null!==(s=e.feedbackDisclaimerStack)&&void 0!==s?s:{},tooltipText:null!==(l=e.tooltipText)&&void 0!==l?l:{}}};var Mr,Br,Rr,Fr,Nr=Object(G.a)(v.b),Hr={feedbackTextMinified:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1),{color:Nr.neutralSecondaryAlt,fontFamily:"-apple-system",lineHeight:"normal"}),feedbackButton:Object(r.__assign)(Object(r.__assign)({width:"44px",height:"44px",maxWidth:"unset",lineHeight:"normal",backgroundColor:"transparent"},W.a.border("0px")),(wr={},wr["&:hover .".concat(St.a.icon)]={cursor:"pointer",color:Nr.themePrimary},wr)),tooltipText:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1),{color:Nr.neutralPrimary,fontFamily:"-apple-system",lineHeight:"normal"})},Ur=function(){return Hr},Vr=(Mr=Lr(Hr),Object(y.a)(Mr),Object(G.a)(v.b)),zr={footerBar:Object(r.__assign)(Object(r.__assign)({},W.a.padding("4px","0px")),{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}),headerBar:Object(r.__assign)({},W.a.padding("0px","4px")),feedbackText:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption2),{color:Vr.neutralSecondaryAlt}),feedbackTextMinified:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1),{color:Vr.neutralSecondaryAlt}),feedbackButtonsStack:Object(r.__assign)({alignItems:"center"},W.a.gap("2px")),feedbackButton:(Br={backgroundColor:"transparent"},Br["&:hover .".concat(St.a.icon)]={cursor:"pointer",color:Vr.themePrimary},Br),feedbackDisclaimerStack:Object(r.__assign)({alignItems:"center"},W.a.gap("2px")),tooltipText:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1),{color:Vr.neutralPrimary})},Gr=(Object(y.a)(zr),Sr({buttonBarRoot:{marginTop:"0px",width:"auto"},minifiedButton:Object(r.__assign)({},Ur().feedbackButton),icon:{}})),Wr=function(e){var t,n,o,i,a,s,l,c;return Object(r.__assign)(Object(r.__assign)({defaultRoot:null!==(t=e.defaultRoot)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},human:null!==(o=e.human)&&void 0!==o?o:{},humanContent:null!==(i=e.humanContent)&&void 0!==i?i:{},chat:null!==(a=e.chat)&&void 0!==a?a:{},chatContent:null!==(s=e.chatContent)&&void 0!==s?s:{},chatCard:null!==(l=e.chatCard)&&void 0!==l?l:{},text:null!==(c=e.text)&&void 0!==c?c:{},strikeThroughText:{},cardHighContrast:{}},Or(e)),Lr(e))},Qr={chatCard:Object(r.__assign)({width:"inherit"},W.a.padding("16px")),text:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{fontFamily:"-apple-system",lineHeight:"normal"})},qr=function(e){return Object(y.a)(Wr(e))}(Qr),Kr=Object(G.a)(v.b),Yr=Object(r.__assign)(Object(r.__assign)({defaultRoot:Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),{alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"}),loader:Object(r.__assign)({boxSizing:"border-box",display:"flex",width:"inherit"},W.a.gap("4px")),human:{alignSelf:"flex-end",maxWidth:"80%"},humanContent:{color:Kr.black,backgroundColor:Kr.themeLight},chat:{width:"100%",alignSelf:"flex-start",boxShadow:Kr.shadow2},chatContent:{backgroundColor:Kr.neutralLight},chatCard:Object(r.__assign)({width:"inherit"},W.a.padding("12px")),text:Object(r.__assign)({},Ot.a.body1),strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:Object(r.__assign)({},W.a.border("1px","solid",Kr.neutralLighterAlt))},(Rr=_r,Fr=Tr,Object(o.b)()===o.a.IOS?Object(r.__assign)(Object(r.__assign)({},Rr),Fr):Object(r.__assign)({},Rr))),function(){var e=zr,t=Ur();return Object(o.b)()===o.a.IOS?Object(r.__assign)(Object(r.__assign)({},e),t):Object(r.__assign)({},e)}()),Zr=function(){var e=Yr,t=Qr;return Object(o.b)()===o.a.IOS?Object(r.__assign)(Object(r.__assign)({},e),t):Object(r.__assign)({},e)},Jr=Object(y.a)(Yr),Xr={colorBrandFlair1:Kr.themeDarkAlt,colorBrandFlair2:Kr.themeLighterAlt,colorBrandFlair3:Kr.themeLighter,colorBrandFlair1Transparent:Kr.themeDarkAltTransparent,colorBrandFlair2Transparent:Kr.themeLighterAltTransparent,colorBrandFlair3Transparent:Kr.themeLighterTransparent},$r=Object(G.a)(v.b),eo=Object(r.__assign)({adaptiveCardRoot:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{color:$r.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":Object(r.__assign)({},W.a.border("1px","solid",$r.neutralQuaternaryAlt)),"& p":{display:"inline"},"& .ac-textBlock":{overflowWrap:"anywhere",display:"inline !important"},"& .ac-adaptiveCard":{display:"inline !important"}})},Zr()),to=Object(y.a)(eo);function no(e){var t=e.renderData,n=e.fallbackElement,o=e.customMessageRenderers;if(!t||!o)return m.a.createElement(m.a.Fragment,null,n);var i=o.renderers[t.component];return i?m.a.createElement(i,Object(r.__assign)({},t.props)):o.renderFallback(t)}var ro=n(224),oo=n(2807),io=n(1134),ao=function(e){var t,n,r,o;if(!e)return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0};try{var i=e.messageExtensionPluginInfo.errorType,a=(null===(n=null===(t=e.oAuthCard)||void 0===t?void 0:t.buttons)||void 0===n?void 0:n.length)&&(null===(o=null===(r=e.oAuthCard)||void 0===r?void 0:r.buttons[0])||void 0===o?void 0:o.value),s=JSON.parse(e.messageExtensionPluginInfo.failedActivity),l=null==s?void 0:s.request;if(!l)throw new Error("Failed to parse pluginAuthError");return{requestType:i,authUrl:a,botInvokeRequest:{botId:l.msaAppId,appId:l.metaOsAppId,requestBody:{name:l.name,value:l.value}},appId:l.metaOsAppId}}catch(e){return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0}}},so=n(3349),lo=n(3351),co=n(3352),uo=function(e){var t=e.children,n=e.popoverTitle,o=e.popoverDuration,i=Object(r.__read)(Object(f.useState)(!1),2),a=i[0],s=i[1],l=Object(f.useRef)(void 0);return Object(f.useEffect)((function(){a&&(l.current&&clearTimeout(l.current),l.current=window.setTimeout((function(){s(!1),l.current=void 0}),null!=o?o:2e3)),a||void 0===l.current||(clearTimeout(l.current),l.current=void 0)}),[o,a]),m.a.createElement(so.a,{withArrow:!0,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:a,onOpenChange:function(e,t){var n;s(null!==(n=t.open)&&void 0!==n&&n)}},m.a.createElement(lo.a,null,t),m.a.createElement(co.a,{"aria-live":"assertive"},n))},po=n(720),go=function(e,t,n,r,o,i){var a=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},s=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};console.log(e.text);var l,c,u,d=e.text?t.combinedButton:t.minifiedButton;return m.a.createElement(w.a,{tabIndex:0,key:o,appearance:e.type==po.b.Primary?"primary":void 0,className:e.type==po.b.Primary?Object(C.a)(d,t.primaryButton):d,icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(l=e.iconRegular,c=e.iconHover,u=Object(A.a)(c,l),m.a.createElement(u,null)):m.a.createElement(e.iconRegular,null),className:t.icon}:void 0,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:a,onMouseLeave:s,onFocus:a,onBlur:s,disabled:e.isDisabled},null==e?void 0:e.text)},ho=function(e){var t=e.actionBarButtons,n=e.styles,o=e.messageContentElementId,i=e.chatCardIndex,a=e.telemetryData,s=void 0===a?"":a;return m.a.createElement(S,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?m.a.createElement(uo,Object(r.__assign)({key:t},e.popoverProps),go(e,n,o,i,t,s)):go(e,n,o,i,t,s)})))},fo=n(3523),mo=function(e,t,n,r,o,i){var a,s,l,c=e.text?t.combinedButton:t.iconButton,u=e.type==po.b.Primary?t.primaryButton:t.defaultButton,d=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},p=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};return m.a.createElement(w.a,{tabIndex:0,key:o,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,appearance:e.type==po.b.Primary?"primary":void 0,className:Object(C.a)(c,u),icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(a=e.iconRegular,s=e.iconHover,l=Object(A.a)(s,a),m.a.createElement(l,null)):m.a.createElement(e.iconRegular,null),className:(null==e?void 0:e.text)?t.combinedButtonIcon:t.icon}:void 0,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:d,onMouseLeave:p,onFocus:d,onBlur:p,disabled:e.isDisabled},null==e?void 0:e.text)},vo=function(e){var t=e.actionBarButtons,n=e.styles,o=e.messageContentElementId,a=e.chatCardIndex,s=e.telemetryData,l=void 0===s?"":s,c=e.pluginAuthButtonProps,u=Object(i.b)();return m.a.createElement(S,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?m.a.createElement(uo,Object(r.__assign)({key:t},e.popoverProps),mo(e,n,o,a,t,l)):mo(e,n,o,a,t,l)})),c&&m.a.createElement(fo.a,Object(r.__assign)({},c,{customStyles:Dr,theme:u===i.a.defaultBlack?"dark":"light"})))},bo=function(e){return Object(o.c)()?m.a.createElement(ho,Object(r.__assign)({},e)):m.a.createElement(vo,Object(r.__assign)({},e))},yo=n(2817),Co=n(3401),Oo=n(2841),So=n(330),Eo=function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}};function xo(e){var t=Eo(e);return Object(y.a)(t)}var Io,wo=xo({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),To=Object(G.a)(v.b),ko=xo({tooltipText:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1),{color:To.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},W.a.padding("12px")),W.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),jo=function(e,t){if(t)for(var n in e)e[n]=Object(C.a)(e[n],t[n])},Po=function(e){switch(void 0===e&&(e=So.c.NonEncryption),e){case So.c.Encryption:return Object(o.c)()?m.a.createElement(We.q,null):m.a.createElement(We.o,null);case So.c.Warning:return Object(o.c)()?m.a.createElement(Oo.e,null):m.a.createElement(Oo.c,null);case So.c.NonEncryption:default:return Object(o.c)()?m.a.createElement(We.m,null):m.a.createElement(We.k,null)}},Ao=function(e,t){switch(void 0===e&&(e=So.c.NonEncryption),e){case So.c.Encryption:return Object(o.c)()?m.a.createElement(We.p,{primaryFill:t}):m.a.createElement(We.n,{primaryFill:t});case So.c.Warning:return Object(o.c)()?m.a.createElement(Oo.d,{primaryFill:t}):m.a.createElement(Oo.b,{primaryFill:t});case So.c.NonEncryption:default:return Object(o.c)()?m.a.createElement(We.l,{primaryFill:t}):m.a.createElement(We.j,{primaryFill:t})}},_o=function(e){var t,n,r=e.styles,i=e.clpSensitivityIndicatorData,a=function(){var e=ko(),t=wo();Object(o.b)()===o.a.IOS&&jo(e,t);return e}();return jo(a,r),m.a.createElement(so.a,{openOnHover:!0},m.a.createElement(lo.a,null,m.a.createElement("span",{className:a.icon},i.icon?m.a.createElement(i.icon,null):(t=i.iconType,n=i.color,void 0===t&&(t=So.c.NonEncryption),n?Ao(t,n):Po(t)))),m.a.createElement(co.a,{className:a.tooltipStack},m.a.createElement(S,null,i.badgeText&&m.a.createElement(pn.a,{className:a.badgeText},i.badgeText),m.a.createElement(pn.a,{className:a.tooltipText},i.tooltipText))))},Do=function(e,t){var n=Object(A.a)(t,e);return m.a.createElement(n,null)},Lo=function(e,t){return m.a.createElement(x.a,{content:m.a.createElement(Ce.a,{className:e.tooltipText},t?Object(u.c)():Object(u.a)()),relationship:"description"},m.a.createElement(Ce.a,{className:e.feedbackTextMinified},t?Object(u.d)():Object(u.b)()))},Mo=function(e,t){var n=t?Object(u.c)():Object(u.a)();return m.a.createElement(Ce.a,{className:e.feedbackText},n)},Bo=function(e){var t=e?Object(u.c)():Object(u.a)();return m.a.createElement(yo.a,null,t)},Ro=function(e){var t=e.styles,n=e.feedbackData,i=e.shouldShowAIGeneratedIndicator,a=void 0===i||i,s=e.shouldShowAIPoweredIndicator,l=e.displayPosition,c=e.shouldShowFeedbackButtons,u=void 0===c||c,d=e.handleThumbsUpClick,p=e.handleThumbsDownClick,g=e.showMinifiedUI,h=void 0!==g&&g,f=e.clpSensitivityIndicatorData,v=void 0===f?void 0:f,b=e.telemetryData,y=void 0===b?"":b,O=e.actionBarProps,E=e.useFluentAIGeneratedIndicator,x=void 0!==E&&E;t.headerBar=Object(C.a)(t.footerBar,t.headerBar);var I=Object(o.c)()?Co.d:Co.b,T=Object(o.c)()?Co.c:Co.a,k=Object(o.c)()?Co.h:Co.f,j=Object(o.c)()?Co.g:Co.e;return O.styles=Object(M.k)(O.styles,Gr()),m.a.createElement(S,{horizontal:!0,reverse:!0,customProperties:{tabIndex:-1},style:l===fr.a.Header?t.headerBar:t.footerBar},m.a.createElement(U,null,m.a.createElement(S,{horizontal:!0,style:t.feedbackButtonsStack},O&&m.a.createElement(bo,Object(r.__assign)({},O)),u&&m.a.createElement(m.a.Fragment,null,m.a.createElement(w.a,{title:B(),"aria-label":B(),appearance:"transparent",size:"small",className:t.feedbackButton,icon:Do(k,j),onClick:function(e){var t=e.target.closest("button");null==n?d(void 0,void 0,t):d(n,y,t)}}),m.a.createElement(w.a,{title:R(),className:t.feedbackButton,"aria-label":R(),appearance:"transparent",size:"small",icon:Do(I,T),onClick:function(e){var t=e.target.closest("button");null==n?p(void 0,void 0,t):p(n,y,t)}})))),m.a.createElement(U,null,m.a.createElement(S,{horizontal:!0,style:t.feedbackDisclaimerStack},v&&m.a.createElement(_o,{styles:t,clpSensitivityIndicatorData:v}),a&&(h?Lo(t,s):x?Bo(s):Mo(t,s)))))},Fo=n(3522),No=n(2806),Ho=n(2804),Uo=n(2799),Vo=n(1531),zo=n(1826),Go=n(724),Wo=n(3397),Qo=function(e){var t=e.referenceType,n=e.iconAppName,r=e.iconUrl,o=e.authorEmail,i=e.authorName;if(t===So.a.Internal){if(n===So.b.Word||n===So.b.OneNote)return m.a.createElement(Go.a,null);if(n===So.b.PowerPoint)return m.a.createElement(Mt.a,null)}else if(t===So.a.CrossApp){if(r)return m.a.createElement(V.a,{src:r,alt:null!=n?n:"",height:20,width:20});if(n)switch(n){case So.b.Word:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:n,height:20,width:20});case So.b.PowerPoint:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:n,height:20,width:20});case So.b.Excel:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:n,height:20,width:20});case So.b.OneNote:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg",alt:n,height:20,width:20});case So.b.Visio:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg",alt:n,height:20,width:20});case So.b.Loop:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg",alt:n,height:20,width:20});case So.b.Txt:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg",alt:n,height:20,width:20});case So.b.SharePoint:return m.a.createElement(V.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg",alt:n,height:20,width:20});case So.b.Event:case So.b.Meeting:return m.a.createElement(_.c,null);case So.b.Pdf:return m.a.createElement(Go.b,null);case So.b.Teams:case So.b.Outlook:return i||o?m.a.createElement(zo.a,{size:20,name:i||o}):m.a.createElement(Wo.a,null);case So.b.Topic:return m.a.createElement(V.a,{src:"../assets/topic-icon.svg",alt:n,height:20,width:20})}}return m.a.createElement(Wo.a,null)},qo=function(e){return{index:e.referenceIndex,label:m.a.createElement(ht.a,{appearance:"subtle",href:e.referenceProps.url,target:"_blank",onClick:function(){return Ko(e)}},e.referenceProps.title),primaryText:e.referenceProps.primarySubtitle,secondaryText:e.referenceProps.secondarySubtitle,excerpt:e.referenceProps.snippet,media:m.a.createElement(Qo,{referenceType:e.referenceProps.referenceType,iconAppName:e.referenceProps.iconAppName,iconUrl:e.referenceProps.iconUrl,authorEmail:e.referenceProps.authorEmail,authorName:e.referenceProps.authorName}),sensitivityLabel:void 0!==e.referenceProps.sensitivityLabel?m.a.createElement("span",null,e.referenceProps.sensitivityLabel):void 0}},Ko=function(e,t){e.referenceProps.onClickCitationLink&&e.referenceProps.onClickCitationLink(e.referenceIndex,e.referenceProps.path,t)},Yo=function(e){var t=e.references,n=e.msgExtCardReferences,o=void 0===n?[]:n,i=e.pluginServiceProvider,a=void 0===i?void 0:i,s=(e.telemetryData,e.styles,(t=Zo(t)).length>1?Object(M.m)()?OfficeaicopilotStrings.CitationTitleReferences:"References":Object(M.m)()?OfficeaicopilotStrings.CitationTitleReference:"Reference"),l=m.a.createElement(No.a,null,t.map((function(e,t){return function(e){return void 0!==o.find((function(t){return t.index===e&&t.card}))}(t+1)?function(e,t,n){var o,i,a=n.find((function(t){return t.index===e&&t.card}));if(a){var s={cardId:a.card.cardId,content:a.content,contentType:Vo.b.AdaptiveCard,appId:a.card.appId,botId:a.card.botId};return m.a.createElement(Fo.a,Object(r.__assign)({key:e,citationIndex:e,cardDetails:s,tokenService:null===(o=null==t?void 0:t.cardServices)||void 0===o?void 0:o.tokenService,theme:a.config.themeMode,appService:null===(i=null==t?void 0:t.cardServices)||void 0===i?void 0:i.appService},a))}return null}(e.referenceIndex,a,o):m.a.createElement(Ho.a,Object(r.__assign)({key:t},qo(e)))})));return l?m.a.createElement(S,null,m.a.createElement(Uo.a,{label:"".concat(t.length," ")+s},l)):null},Zo=function(e){var t,n,o=[],i=function(e){o.some((function(t){return t.referenceIndex===e.referenceIndex}))||o.push(e)};try{for(var a=Object(r.__values)(e),s=a.next();!s.done;s=a.next()){i(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},Jo=function(e){var t,n,a,s=e.styles,l=e.body,c=e.feedbackData,u=e.shouldShowAIGeneratedIndicator,d=void 0===u||u,p=e.shouldShowAIPoweredIndicator,g=e.shouldShowFeedbackButtons,h=void 0===g||g,v=e.feedbackSectionPosition,b=void 0===v?fr.a.None:v,y=e.showAnimation,O=void 0===y||y,S=e.handleThumbsDownClick,E=e.handleThumbsUpClick,x=e.actionBarButtons,I=e.chatCardIndex,w=e.showMinifiedUI,T=void 0!==w&&w,k=e.strikeThroughText,j=void 0!==k&&k,P=e.references,A=void 0===P?[]:P,_=e.clpSensitivityIndicatorData,D=void 0===_?void 0:_,L=e.telemetryData,M=void 0===L?"":L,B=e.pluginAuthError,R=void 0===B?void 0:B,F=e.pluginServiceProvider,N=void 0===F?void 0:F,H=e.msgExtCardProps,U=void 0===H?void 0:H,V=e.msgExtCardContextProvider,z=void 0===V?void 0:V,G=e.useFluentAIGeneratedIndicator,W=void 0!==G&&G,Q=null!==(t=l.user)&&void 0!==t?t:"chat",q="human"!==l.user&&O,K=Object(r.__read)(Object(f.useState)(q),2),Y=K[0],Z=K[1],J=m.a.useMemo((function(){return ao(R)}),[R]),X=J.requestType,$=J.authUrl,ee=J.botInvokeRequest,te=J.appId;Object(f.useEffect)((function(){q&&Z(!0)}),[q]),Object(f.useEffect)((function(){Y&&Z(!1)}),[Y]);var ne=Object(i.c)(),re=!!R&&X&&ee&&(null==N?void 0:N.activityProvider)&&(null===(n=null==N?void 0:N.cardServices)||void 0===n?void 0:n.appService),oe=((null==x?void 0:x.length)>0||re)&&"human"!==Q,ie=(b==fr.a.Header||b==fr.a.Footer&&Object(o.c)())&&"human"!==Q,ae=!ie&&b==fr.a.Footer&&"human"!==Q,se=(null==U?void 0:U.attributions.length)>0&&z,le=A.length>0,ce=Object(io.a)(),ue=null==x?void 0:x.filter((function(e){return e.position===po.a.FeedbackSection})),de={actionBarButtons:null==x?void 0:x.filter((function(e){return e.position!==po.a.FeedbackSection})),styles:s,messageContentElementId:ce,chatCardIndex:I,telemetryData:M,pluginAuthButtonProps:re?{requestType:X,url:$,appId:te,originalBotInvokeRequest:ee,activityProvider:null==N?void 0:N.activityProvider,appService:null===(a=null==N?void 0:N.cardServices)||void 0===a?void 0:a.appService}:void 0},pe={styles:s,feedbackData:c,shouldShowAIGeneratedIndicator:d,shouldShowAIPoweredIndicator:p,shouldShowFeedbackButtons:h,displayPosition:b,handleThumbsDownClick:S,handleThumbsUpClick:E,showMinifiedUI:!!Object(o.c)()||T,clpSensitivityIndicatorData:D,telemetryData:M,actionBarProps:{actionBarButtons:ue,styles:Object(r.__assign)({},s),messageContentElementId:ce,chatCardIndex:I,telemetryData:M},useFluentAIGeneratedIndicator:W},ge=function(e,t,n,r){var o={};return o.defaultRoot=Object(C.a)(e.defaultRoot,e[t]),n&&(o.defaultRoot=Object(C.a)(o.defaultRoot,e.cardHighContrast)),o.loader=e.loader,o.chatCard=Object(C.a)(e.chatCard,"human"===t?e.humanContent:e.chatContent),o.strikeThroughText=r?e.strikeThroughText:"",o}(s,Q,ne,j),he=[];se&&(he=z.getCardReferences(U.attributions));var fe=m.a.createElement(m.a.Fragment,null,ie&&m.a.createElement(Ro,Object(r.__assign)({},pe)),m.a.createElement("div",{id:"".concat(ce),className:ge.strikeThroughText},l.element),oe&&m.a.createElement(bo,Object(r.__assign)({},de)),ae&&m.a.createElement(Ro,Object(r.__assign)({},pe)),le&&m.a.createElement(Yo,{references:A,msgExtCardReferences:he,pluginServiceProvider:N,styles:s,telemetryData:M}));return m.a.createElement(ro.a,{className:ge.defaultRoot,themeExtension:Xr},"human"===Q?m.a.createElement(oo.a,{className:ge.chatCard},fe):m.a.createElement(yt.a,{isLoading:Y,"aria-live":"assertive",className:ge.chatCard},fe))},Xo=n(146),$o=function(e){var t=e.styles,n=e.onClickShowMeButton,r=e.onClickHelpButton,o=t.combinedButton,i=t.showMeButton;return m.a.createElement(S,{style:t.showMeButtonBarRoot,customProperties:{tabIndex:-1}},m.a.createElement(w.a,{tabIndex:0,"aria-label":Object(u.I)(),className:Object(C.a)(o,i),onClick:n},Object(u.I)()),r&&m.a.createElement(w.a,{tabIndex:0,"aria-label":u.o,className:Object(C.a)(o,i),icon:m.a.createElement(Xo.V,null),onClick:r},u.o))},ei=n(2805),ti=function(e){var t=e.referenceIndex,n=e.referenceProps,o=e.telemetryData,i=void 0===o?"":o,a=m.a.createElement(Ho.a,Object(r.__assign)({layout:"popover"},qo({referenceIndex:t,referenceProps:n})));return m.a.createElement(ei.a,{popover:a,onClick:function(){void 0!==n.url&&window.open(n.url,"_blank"),n.onClickCitationLink&&n.onClickCitationLink(t,n.path,i)},popoverSurface:{tabIndex:0,style:{overflowWrap:"anywhere"}}},t)},ni=function(e){var t,n,r,o,i,a,s=e.styles,l=e.richText,c=e.renderTextWithCitation,u=void 0===c?function(e){return null}:c,d=e.references,p=void 0===d?[]:d;l.linkText&&(null===(t=l.linkText.linkSuffix)||void 0===t?void 0:t.includes("%s"))&&(l.text+=l.linkText.linkSuffix.substring(0,l.linkText.linkSuffix.indexOf("%s")),l.linkText.linkSuffix=l.linkText.linkSuffix.substring(l.linkText.linkSuffix.indexOf("%s")+2));return m.a.createElement("span",null,m.a.createElement(Ce.a,{block:!0,className:Object(C.a)(s.text,s.richTextRoot)},l.text?Object(M.l)(l.text,p)?u(l.text):l.text:"",l.linkText&&m.a.createElement(ht.a,{target:l.linkText.linkUrl?"_blank":"",href:null!==(n=l.linkText.linkUrl)&&void 0!==n?n:"#",className:Object(C.a)(s.linkText,l.linkText.linkUrl?"":s.linkButton),onClick:function(){l.linkText.linkUrl||l.linkText.linkOnClick()}},l.linkText.text),(null===(r=l.linkText)||void 0===r?void 0:r.linkSuffix)?Object(M.l)(null===(o=l.linkText)||void 0===o?void 0:o.linkSuffix,p)?u(null===(i=l.linkText)||void 0===i?void 0:i.linkSuffix):null===(a=l.linkText)||void 0===a?void 0:a.linkSuffix:""))},ri=function(e){return Object(y.a)(function(e){var t,n,o,i,a,s,l,c,u,d,p,g,h;return Object(r.__assign)({rootStack:null!==(t=e.rootStack)&&void 0!==t?t:{},messageHeader:null!==(n=e.messageHeader)&&void 0!==n?n:{},messageFooter:null!==(o=e.messageFooter)&&void 0!==o?o:{},listStackStyle:null!==(i=e.listStackStyle)&&void 0!==i?i:{},pillsItem:null!==(a=e.listStackStyle)&&void 0!==a?a:{},pillsContainer:null!==(s=e.listStackStyle)&&void 0!==s?s:{},list:null!==(l=e.list)&&void 0!==l?l:{},listHeader:null!==(c=e.listHeader)&&void 0!==c?c:{},listFooter:null!==(u=e.listFooter)&&void 0!==u?u:{},linkText:null!==(d=e.linkText)&&void 0!==d?d:{},linkButton:null!==(p=e.linkButton)&&void 0!==p?p:{},listItemTitle:null!==(g=e.listItemTitle)&&void 0!==g?g:{},richTextRoot:null!==(h=e.richTextRoot)&&void 0!==h?h:{}},Wr(e))}(e))}({linkText:{fontFamily:"-apple-system",lineHeight:"normal"}}),oi=Object(G.a)(v.b),ii=Object(r.__assign)({rootStack:Object(r.__assign)({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},W.a.gap("12px")),messageHeader:{},messageFooter:{},listStackStyle:Object(r.__assign)(Object(r.__assign)({},W.a.gap("4px")),W.a.gap("12px")),pillsContainer:{alignItems:"flex-start"},pillsItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)((Io={backgroundColor:Q.a.colorNeutralBackground3,color:Q.a.colorNeutralForeground2},Io["&:hover"]={backgroundColor:Q.a.colorNeutralBackground2Hover,color:Q.a.colorNeutralForeground1Hover},Io.marginBottom="10px",Io),W.a.border("transparent")),W.a.borderColor(Q.a.colorNeutralBackground3)),{display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px"}),W.a.borderRadius("4px")),W.a.gap("4px")),W.a.gap("12px")),list:Object(r.__assign)(Object(r.__assign)({},W.a.margin("0px")),W.a.gap("4px")),listHeader:{fontWeight:600},listFooter:{},linkText:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{color:oi.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:oi.themePrimary}}}),linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"}},Zr()),ai=Object(y.a)(ii),si=function(){var e=ai(),t=ri();if(Object(o.b)()===o.a.IOS)Object(M.k)(e,t);return e},li=function(e){var t=e.styles,n=e.body,o=e.strikeThroughText,i=void 0!==o&&o,a=e.references,s=void 0===a?[]:a,l=e.pillsList,c=void 0===l?[]:l,u=e.handlePillOnClick,d=void 0===u?null:u,p=e.handleShowMeOnClick,g=void 0===p?null:p,h=e.telemetryData,f=void 0===h?"":h,v=Object(C.a)(t.text,t.rootStack);i&&(v=Object(C.a)(t.text,t.strikeThroughText,t.rootStack));var b=si(),y={styles:t,onClickShowMeButton:g,onClickHelpButton:null},O=function(e){return Object(M.i)(e,s).map((function(e,t){return m.a.createElement("span",{key:t},e.message,e.references&&e.references.map((function(e,t){return m.a.createElement(ti,Object(r.__assign)({},e,{key:t,telemetryData:f}))})))}))};return m.a.createElement(S,{style:v},n.messageHeader&&(n.messageHeader.text||n.messageHeader.linkText)&&m.a.createElement(S,{style:t.messageHeader},m.a.createElement(ni,{styles:t,richText:n.messageHeader,references:s,renderTextWithCitation:O})),n.embeddedLists&&n.embeddedLists.map((function(e,n){return m.a.createElement(S,{key:n,style:t.listStackStyle},e.listHeader&&m.a.createElement(Ce.a,{className:Object(C.a)(t.text,t.listHeader)},Object(M.l)(e.listHeader,s)?O(e.listHeader):e.listHeader),e.listItems&&e.listItems.length>0&&m.a.createElement("ul",{className:t.list},e.listItems.map((function(e,n){return m.a.createElement(Ce.a,{block:!0,key:n,className:t.text},m.a.createElement("li",null,e.title&&m.a.createElement("span",{className:t.listItemTitle},Object(M.l)(e.title,s)?O(e.title):e.title),Object(M.l)(e.text,s)?O(e.text):e.text))}))),e.listFooter&&(e.listFooter.text||e.listFooter.linkText)&&m.a.createElement(S,{style:t.listFooter},m.a.createElement(ni,{styles:t,richText:e.listFooter,references:s,renderTextWithCitation:O})))})),n.messageFooter&&(n.messageFooter.text||n.messageFooter.linkText)&&m.a.createElement(S,{style:t.messageFooter},m.a.createElement(ni,{styles:t,richText:n.messageFooter,references:s,renderTextWithCitation:O})),g&&m.a.createElement($o,Object(r.__assign)({},y)),c&&c.length>0&&m.a.createElement(S,{style:b.pillsContainer},c.map((function(e,t){return m.a.createElement(w.a,{key:t,className:b.pillsItem,onClick:function(){d&&d(e)}},e.data)}))))},ci=function(e){var t,n,r=e.body,o=e.styles,i=null!==(t=r.cardHeader)&&void 0!==t?t:Object(u.n)(),a=null!==(n=r.cardContent)&&void 0!==n?n:Object(u.l)(),s=r.imageSrc;return m.a.createElement(S,{style:o.feedbackNudgeRootStack},m.a.createElement(S,{style:o.msInternalContainer},m.a.createElement(Ce.a,{title:Object(u.k)(),className:o.msInternalHeader},Object(u.k)())),m.a.createElement(V.a,{src:s,className:o.cardIllustration}),m.a.createElement(Ce.a,{title:Object(u.n)(),className:o.feedbackCardHeader},i),m.a.createElement(Ce.a,{title:Object(u.m)(),className:Object(C.a)(o.text,o.feedbackCardContent)},a))},ui=function(e){var t,n,o,i,a;return Object(r.__assign)({feedbackNudgeRootStack:{},msInternalContainer:null!==(t=e.msInternalContainer)&&void 0!==t?t:{},msInternalHeader:null!==(n=e.msInternalHeader)&&void 0!==n?n:{},feedbackCardHeader:null!==(o=e.feedbackCardHeader)&&void 0!==o?o:{},feedbackCardContent:null!==(i=e.feedbackCardContent)&&void 0!==i?i:{},cardIllustration:null!==(a=e.cardIllustration)&&void 0!==a?a:{}},Wr(e))};var di=function(e){var t=ui(e);return Object(y.a)(t)}(Object(r.__assign)({msInternalHeader:{lineHeight:"normal"},feedbackCardHeader:{lineHeight:"14px"},feedbackCardContent:{lineHeight:"14px"}},Zr())),pi=Object(G.a)(v.b),gi=Object(r.__assign)({feedbackNudgeRootStack:Object(r.__assign)({alignItems:"center"},W.a.gap("4px")),msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:"16px"},W.a.borderRadius(pi.borderRadiusXLarge)),{backgroundColor:pi.neutralTertiary}),W.a.padding("0px","12px")),Ot.a.caption2Strong),{display:"flex",justifyContent:"center",alignItems:"center"}),feedbackCardHeader:Object(r.__assign)(Object(r.__assign)({marginTop:"12px",width:"100%",textAlign:"center"},Ot.a.subtitle2),{color:pi.themePrimary}),feedbackCardContent:{marginTop:"12px"},cardIllustration:{}},Zr()),hi=Object(y.a)(gi),fi=n(3589),mi=n(2164),vi=n(465),bi=n(3508),yi=n(2870),Ci=Object(yi.b)({MsgExtCardPreview:Object(y.a)({root:{maxWidth:"min(".concat(600,"px, 100%)"),minWidth:"min(".concat(0,"px, 100%)")}})}),Oi=Object(f.memo)((function(e){var t=e.card,n=e.context,r=e.config,o=m.a.useMemo((function(){return{appId:t.appId,cardId:t.cardId,botId:t.botId,content:JSON.stringify(t.content),contentType:Object(M.e)(t.contentType)}}),[t]);return m.a.createElement("div",null,m.a.createElement(Ci,null,m.a.createElement(bi.a,{cardDetails:o,serviceProvider:n,config:r})))}),(function(e,t){return e.card.cardId===t.card.cardId&&e.config.themeMode===t.config.themeMode})),Si=n(246),Ei=n(2851),xi=Object(yi.a)("MsgExtCitationControl",Object(y.a)({container:Object(r.__assign)({display:"inline-block",paddingBottom:"0px"},W.a.borderRadius("12px")),citationMountNode:{zIndex:999},popoverSurface:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.overflow("0px","0px")),W.a.padding("0px")),W.a.borderRadius("12px")),W.a.borderStyle("none")),{width:"min(".concat(450,"px, 100%)"),"& > div":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("12px")),W.a.borderWidth("0px")),W.a.borderStyle("none")),"&::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralForeground4},W.a.border("0px")),W.a.borderRadius(Q.a.borderRadiusMedium)),"&::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({width:Q.a.spacingHorizontalS},W.a.border("0px")),W.a.borderRadius(Q.a.borderRadiusMedium)),"&::-webkit-scrollbar-track":Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},W.a.border("0px")),W.a.borderRadius(Q.a.borderRadiusMedium)),"&::-webkit-scrollbar-corner":Object(r.__assign)(Object(r.__assign)({backGroundColor:Q.a.colorNeutralBackground5},W.a.border("0px")),W.a.borderRadius(Q.a.borderRadiusMedium))}),citationV2:Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground3,color:Q.a.colorNeutralForeground2},W.a.border("1px","solid",Q.a.colorNeutralStroke1))}));function Ii(e){var t,n,o,i,a=xi(),s=e.citation,l=e.cardDetails,c=e.serviceProvider,u=e.config,d=e.postActionExecute,p=e.isReferencesV2,g=e.viewModel,h=f.useMemo((function(){return new Ei.a(null==c?void 0:c.telemetryService,Si.h.CitationOrEntityControl,Si.g.MsgExtCitationOrEntityControl)}),[]),m=f.useMemo((function(){return f.createElement(bi.a,{cardDetails:l,serviceProvider:c,config:u,postActionExecute:d})}),[c,l]),v=null!=e.viewModel?"Entity":"Citation";f.useEffect((function(){h.logMetricEnd({props:{},diagnosticsData:"TypeOfCard: ".concat(l.contentType,",  cardId : ").concat(l.cardId,",  sourceType: ").concat(v)},l.cardId)}),[]);var b=[g&&!(null===(t=g.item)||void 0===t?void 0:t.cardDetails)?f.createElement(Ce.a,null,null===(n=g.item)||void 0===n?void 0:n.title):f.createElement(lo.a,{disableButtonEnhancement:!0},g&&(null===(o=g.item)||void 0===o?void 0:o.cardDetails)?f.createElement(ht.a,null,null===(i=g.item)||void 0===i?void 0:i.title):f.createElement(ei.a,{className:p?a.citationV2:void 0,"data-testid":"msgext-citation-pill"},s)),f.createElement("div",{"data-testid":"msgext-citation-popover"},f.createElement(co.a,{className:a.popoverSurface},m))],y=Object(r.__read)(f.useState(0),2),C=y[0],O=y[1],S=window.innerHeight;return f.createElement("div",{className:a.container,ref:function(e){e&&O(e.getBoundingClientRect().top)}},f.createElement(so.a,{openOnHover:!0,closeOnScroll:!0,positioning:{align:"center",position:C>S/2?"above":"below",autoSize:!0},trapFocus:!0,mountNode:{className:a.citationMountNode}},b))}var wi,Ti=function(e){var t=e.citation,n=e.card,r=e.context,o=e.config,i=m.a.useMemo((function(){return{appId:n.appId,cardId:n.cardId,botId:n.botId,content:JSON.stringify(n.content),contentType:Object(M.e)(n.contentType)}}),[n]);return m.a.createElement(Ii,{citation:t,cardDetails:i,serviceProvider:r,config:o})},ki=function(e){var t=e.styles,n=e.body,o=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=e.msgExtCardProps,u=void 0===c?void 0:c,d=e.msgExtCardContextProvider,p=void 0===d?void 0:d,g=e.pluginAuthError,h=void 0===g?void 0:g,f=[],v=p?p.getCardServiceProps():void 0;(null==u?void 0:u.attributions.length)>0&&p&&(f=p.getCardReferences(u.attributions));var b=m.a.useMemo((function(){return ao(h)}),[h]),y=b.requestType,O=b.appId,E=t.markdownRoot;o&&(E=Object(C.a)(t.markdownRoot,t.strikeThroughText)),n.shouldApplyInputLinkTheme&&(E=Object(C.a)(E,t.markdownInputLinkStyles));var x={a:function(e){e.node;return function(e,t){var n=e.children[0],o=Number(n),i=Number.isInteger(o)&&o>0;if(f.length,i){var s=f.find((function(e){return e.index===o&&e.card}));if(s)return m.a.createElement(Ti,Object(r.__assign)({citation:o},s,{context:null==s?void 0:s.context}));var c=a.length?a.find((function(e){return e.referenceIndex===o})):void 0;return a.length&&c?m.a.createElement(ti,Object(r.__assign)({},a.find((function(e){return e.referenceIndex===o})),{telemetryData:l})):m.a.createElement("span",null,"[",e.children,"](",e.href,")")}return t?m.a.createElement("a",Object(r.__assign)({},e,{rel:"noreferrer"}),e.children):m.a.createElement("span",null,"[",e.children,"](",e.href,")")}(Object(r.__rest)(e,["node"]),n.disableLinksProcessing)}};n.horizontalTableScroll&&(x.table=function(e){e.node;var n=Object(r.__rest)(e,["node"]);return m.a.createElement("div",{className:t.markdownHorizontalTableContainer},m.a.createElement("table",{className:t.markdownHorizontalTable},n.children))});var I=O&&v&&v.appService&&m.a.createElement(fi.a,{requestType:y,appId:O,appService:v.appService});return m.a.createElement(S,{style:E},m.a.createElement(mi.a,{linkTarget:"_blank",disallowedElements:["img"],unwrapDisallowed:!0,remarkPlugins:[vi.a],components:Object(r.__assign)(Object(r.__assign)({},x),n.componentsOverride)},0===a.length||a[0].isFlux?n.message:Object(M.f)(n.message,a)),I,function(){if(1===f.length){var e=f[0];return m.a.createElement(Oi,Object(r.__assign)({},e,{context:e.context,config:e.config}))}return null}())},ji=function(e){var t,n,o,i,a,s=Object(r.__assign)({markdownRoot:null!==(t=e.markdownRoot)&&void 0!==t?t:{},markdownElement:null!==(n=e.markdownElement)&&void 0!==n?n:{},markdownHorizontalTableContainer:null!==(o=e.markdownHorizontalTableContainer)&&void 0!==o?o:{},markdownHorizontalTable:null!==(i=e.markdownHorizontalTable)&&void 0!==i?i:{},markdownInputLinkStyles:null!==(a=e.markdownInputLinkStyles)&&void 0!==a?a:{}},Wr(e));return Object(y.a)(s)}({markdownRoot:{lineHeight:"inherit"}}),Pi=Object(G.a)(v.b),Ai=Object(r.__assign)({markdownRoot:Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{color:Pi.black,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",Pi.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(r.__assign)({backgroundColor:Pi.colorNeutralBackground1Hover},W.a.padding("1px","5px")),"& td":Object(r.__assign)(Object(r.__assign)({},W.a.borderBottom("1px","solid",Pi.colorNeutralBackground3Pressed)),W.a.padding("1px","5px")),"& p":Object(r.__assign)(Object(r.__assign)({},W.a.margin("0px")),{display:"inline"})}),markdownElement:{marginBottom:"10px"},markdownHorizontalTableContainer:{width:"100%",overflowX:"auto","::-webkit-scrollbar":Object(r.__assign)({height:"7px",backgroundColor:"transparent"},W.a.borderRadius(Pi.borderRadiusLarge)),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Pi.colorScrollbarOverlay},W.a.borderRadius(Pi.borderRadiusLarge)),W.a.border("1px","solid",Pi.colorNeutralBackground1)),{":hover":{backgroundColor:Pi.colorNeutralForeground3}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:"transparent"},W.a.borderRadius(Pi.borderRadiusLarge))},markdownHorizontalTable:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"100%",whiteSpace:"nowrap"},W.a.overflow("hidden")),W.a.borderRadius(Pi.borderRadiusMedium)),Ot.a.caption1),{"& th":Object(r.__assign)({},Ot.a.caption1Strong)}),markdownInputLinkStyles:{"& a":Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{color:Pi.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Pi.themePrimary}}})}},Zr()),_i=Object(y.a)(Ai),Di=n(3402),Li=function(e){var t=e.styles,n=e.handleApplyOnClick,o=e.handleApplyAllOnClick,i=Object(r.__read)(Object(f.useState)(!1),2),a=i[0],s=i[1],l=Object(r.__read)(Object(f.useState)(!1),2),c=l[0],d=l[1],p=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,o()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?m.a.createElement(x.a,{content:Object(u.L)(),relationship:"label"},m.a.createElement(w.a,{className:Object(C.a)(t.spinnerButton,t.combinedButton),onClick:p,disabled:!0,icon:m.a.createElement(Mt.e,{className:t.spinnerIcon})})):m.a.createElement(E.a,{positioning:"below-end"},m.a.createElement(I.a,{disableButtonEnhancement:!0},(function(e){return m.a.createElement(x.a,{content:Object(u.g)(),relationship:"label"},m.a.createElement(Di.a,{menuButton:e,primaryActionButton:{onClick:p},size:"small",className:t.applyButton},c?Object(u.e)():Object(u.f)()))})),m.a.createElement(k.a,null,m.a.createElement(j.a,null,m.a.createElement(P.a,{onClick:function(){d((function(e){return!e}))}},c?Object(u.f)():Object(u.e)()))))},Mi=function(e){var t=e.styles,n=e.body,o=Object(r.__read)(Object(f.useState)(0),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(Object(r.__spreadArray)([],Object(r.__read)(n.textIndices),!1)),2),l=s[0],c=s[1],d=Object(r.__read)(Object(f.useState)(!1),2),p=d[0],g=d[1];Object(f.useEffect)((function(){i>=l.length&&a(l.length-1)}),[l]);var h=function(){return a((function(e){return e-1}))},v=function(){return a((function(e){return e+1}))},b=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return g(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),g(!1),[2]}}))}))},y=function(){c((function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return t.splice(i,1),t}))},O={styles:t,handleApplyOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return m.a.createElement(S,{style:t.stack,customProperties:{tabIndex:-1}},l.length?m.a.createElement(m.a.Fragment,null,Object(u.h)(),m.a.createElement("div",{className:t.contentBox},m.a.createElement("div",{className:t.contentBoxButtonGroup},m.a.createElement("div",{className:p?t.disabledContentBoxIcon:t.contentBoxIcon},p?m.a.createElement(Mt.f,{className:t.spinnerIcon}):m.a.createElement(x.a,{content:Object(u.p)(),relationship:"label"},m.a.createElement(We.b,{onClick:b}))),p?m.a.createElement(m.a.Fragment,null):m.a.createElement("div",{className:Object(C.a)(t.contentBoxIcon,t.dismissIcon)},m.a.createElement(x.a,{content:Object(u.y)(),relationship:"label"},m.a.createElement(Se.h,{onClick:y})))),m.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.extractTextToDisplay(l[i]))),m.a.createElement("div",{className:t.footer},m.a.createElement("div",null,m.a.createElement(Li,Object(r.__assign)({},O))),m.a.createElement("div",{className:t.pagination},m.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),m.a.createElement("div",null,m.a.createElement(m.a.Fragment,null,m.a.createElement(x.a,{content:Object(u.s)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Co.i,null),onClick:h,disabled:0==i,className:t.paginationButton})),m.a.createElement(x.a,{content:Object(u.r)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Co.j,null),onClick:v,disabled:i+1>=l.length,className:t.paginationButton}))))))):m.a.createElement(m.a.Fragment,null,Object(u.q)()))},Bi=Object(G.a)(v.b),Ri=Object(r.__assign)({stack:Object(r.__assign)({textAlign:"start",textOverflow:"clip"},W.a.gap("12px")),contentBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Bi.neutralLight,minHeight:"50px",position:"relative"},W.a.padding("12px")),W.a.border("1px","solid",Bi.neutralLighterAlt)),W.a.borderRadius(Bi.borderRadiusMedium)),footer:Object(r.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},W.a.gap("12px")),pagination:Object(r.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},W.a.gap("10px")),paginationButton:Object(r.__assign)(Object(r.__assign)({backgroundColor:Bi.neutralLight,height:"24px"},W.a.border("none")),{"&:hover":{color:Bi.themePrimary}}),spinnerButton:{backgroundColor:Bi.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Bi.themePrimary}},paginationNumberBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"center",backgroundColor:Bi.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},W.a.border("1px","solid",Bi.neutralLighterAlt)),W.a.borderRadius(Bi.borderRadiusMedium)),Ot.a.caption1),W.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Bi.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Bi.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Bi.themePrimary},contentBoxText:{marginBottom:"20px"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Zr()),Fi=Object(y.a)(Ri),Ni=n(3393),Hi=function(e){var t=e.styles,n=e.body,o=Object(r.__read)(m.a.useState(!1),2),i=o[0],a=o[1];return m.a.createElement(S,{style:t.rootStack},m.a.createElement("div",{className:t.container,onMouseOver:function(){n.handleMouseOver()},onMouseLeave:function(){n.handleMouseLeave()},onFocus:function(){n.handleMouseLeave()}},m.a.createElement("div",null,m.a.createElement(Ce.a,{className:t.title},Object(u.x)()),m.a.createElement(Ni.a,{className:t.badge,size:"large",appearance:"outline",color:"subtle",icon:m.a.createElement(Mt.b,null)},Object(u.v)())),m.a.createElement(Ce.a,{className:t.body},Object(u.u)()),m.a.createElement(V.a,{className:t.image,bordered:!0,shadow:!0,shape:"rounded",alt:Object(u.w)(),src:n.imageSrc}),m.a.createElement(w.a,{disabled:i,className:t.applyButton,onClick:function(){a(!0),n.handleApplyClicked()},icon:m.a.createElement(Qe.c,null)},Object(u.t)())))},Ui=Object(G.a)(v.b),Vi=Object(r.__assign)({rootStack:Object(r.__assign)({},W.a.gap("4px")),container:{display:"flex",flexDirection:"column"},title:{fontWeight:"600"},badge:Object(r.__assign)({float:"right"},W.a.borderColor(Ui.themeMedium)),body:{marginTop:"15px"},image:{marginTop:"15px"},applyButton:{marginTop:"15px",width:"104px"}},Zr()),zi=Object(y.a)(Vi);!function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(wi||(wi={}));var Gi,Wi=n(3438),Qi=n(3439),qi=n(3395),Ki=function(e){var t=e.styles,n=(e.label,e.icon,e.text),r=e.disabled,o=e.isFormReadyForSubmission,i=e.onSubmit;return m.a.createElement("div",{className:t.buttonStyle},m.a.createElement(w.a,{appearance:"primary",icon:r?m.a.createElement(Ct.f,null):m.a.createElement(We.d,null),onClick:i,disabled:!o,size:"small",className:t.buttonItemsStyle},m.a.createElement(qi.a,null,r?Object(u.H)():n)))},Yi=(Object(G.a)(v.c),Object(r.__assign)({buttonTextStyle:{},buttonStyle:{display:"flex",flexDirection:"column",rowGap:"8px"},buttonItemsStyle:{width:"fit-content"}},Zr())),Zi=Object(y.a)(Yi),Ji=n(3603),Xi=n(3433),$i=n(3434),ea=function(e){e.styles;var t=e.label,n=e.selectedDate,r=e.disabled,o=e.onDateChange;return m.a.createElement(Xi.a,{label:m.a.createElement($i.a,null,t," ")},m.a.createElement(Ji.a,{showMonthPickerAsOverlay:!0,showGoToToday:!1,value:n,onSelectDate:function(e){o&&o(e)},disabled:r,minDate:new Date}))},ta=Object(G.a)(v.c),na=Object(r.__assign)({datePickerLabelStyle:{},datePickerInputStyle:Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",ta.colorNeutralStroke1)),W.a.borderRadius("4px")),datePickerIconStyle:{}},Zr()),ra=Object(y.a)(na),oa=n(3437),ia=n(3405),aa=function(e){var t=e.styles,n=e.label,r=e.selectedValue,o=e.options,i=e.disabled,a=e.onItemSelected;return m.a.createElement(S,null,m.a.createElement(Xi.a,{label:m.a.createElement($i.a,null,n)},m.a.createElement(oa.a,{onOptionSelect:function(e,t){return n=t.optionText,console.log(n),void(a&&a(n));var n},className:t.dropDownInputStyle,value:r,disabled:i},o.map((function(e){return m.a.createElement(ia.a,{key:e},e)})))))},sa=Object(G.a)(v.c),la=Object(r.__assign)({dropDownLabelStyle:{},dropDownInputStyle:Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",sa.colorNeutralStroke1)),W.a.borderRadius("4px")),dropDownFlyoutStyle:{}},Zr()),ca=Object(y.a)(la),ua=n(3435),da=n(3436),pa=function(e){var t=e.styles,n=e.label,r=e.suggestions,o=e.inputComponent,i=(e.onPeopleAdded,e.disabled),a=e.onPeopleRemoved;return m.a.createElement(S,null,m.a.createElement(Xi.a,{label:m.a.createElement($i.a,null,n)},m.a.createElement(S,{style:t.peoplePickerInputStyle},r&&r.length>0&&m.a.createElement(U,{style:t.peoplePickerInputContainerStyle},m.a.createElement(ua.a,{onDismiss:function(e,t){var n=t.value;a&&a({mail:n,displayName:n})},className:t.peoplePickerTagGroupStyle},r.map((function(e,t){return m.a.createElement(da.a,{shape:"circular",media:m.a.createElement(zo.a,{name:e.displayName,shape:"circular"}),dismissible:!e.isReadOnly,dismissIcon:e.isReadOnly?void 0:{"aria-label":"remove"},key:t,size:"extra-small",value:e.mail,disabled:i},e.displayName)})))),!i&&m.a.createElement(U,{style:t.peoplePickerInputContainerStyle},o))))},ga=Object(G.a)(v.c),ha=Object(r.__assign)({peoplePickerLabelStyle:{},peoplePickerInputStyle:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("4px")),W.a.border("1px","solid",ga.colorNeutralStroke1)),{display:"flex"}),peoplePickerInputContainerStyle:Object(r.__assign)({},W.a.margin("2px","8px","2px","8px")),peoplePickerTagGroupStyle:{flexWrap:"wrap",rowGap:"8px"},peoplePickerSwitchStyle:{}},Zr()),fa=Object(y.a)(ha);!function(e){e.PEOPLE_PICKER="PEOPLE_PICKER",e.TEXT_AREA="TEXT_AREA",e.DATE_PICKER="DATE_PICKER",e.DROP_DOWN="DROP_DOWN",e.SUBMIT="SUBMIT"}(Gi||(Gi={}));var ma=n(3425),va=function(e){e.styles;var t=e.label,n=e.message,o=e.disabled,i=e.onMessageChange,a=Object(r.__read)(m.a.useState(n),2),s=a[0],l=a[1];return m.a.createElement(S,null,m.a.createElement(Xi.a,{label:m.a.createElement($i.a,null,t)},m.a.createElement(ma.a,{value:s,onChange:function(e,t){i&&i(t.value),l(t.value)},disabled:o,rows:4},m.a.createElement(pn.a,null,s))))},ba=Object(G.a)(v.c),ya=Object(r.__assign)({textAreaLabelStyle:{},textAreaInputStyle:Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("4px")),W.a.border("1px","solid",ba.colorNeutralStroke1))},Zr()),Ca=Object(y.a)(ya),Oa=Object(G.a)(v.c),Sa=Object(r.__assign)({elementStyles:Object(r.__assign)({display:"flex",flexDirection:"column"},W.a.gap("16px")),footerAIGeneratedStyles:{color:Oa.neutralSecondaryAlt}},Zr()),Ea=Object(y.a)(Sa),xa=function(e){var t,n,o=e.styles,i=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,a=null!==(t=i.isCardSubmitted)&&void 0!==t&&t,s=Ea(),l=fa(),c=Ca(),d=ca(),p=ra(),g=Zi();return m.a.createElement(S,{style:s.elementStyles},m.a.createElement(Wi.a,null,null!==(n=i.headerText)&&void 0!==n?n:i.isEditDetailsRequest?u.B:u.A),i.individualComponentProps.map((function(e,t){return m.a.createElement(U,{key:t},function(e,t){var n,o,i;if(!e)return null;var s=null;switch(e.InvitationComponentType){case Gi.PEOPLE_PICKER:o=e.componentProps,i=Object(M.k)(l,t),s=pa;break;case Gi.TEXT_AREA:o=e.componentProps,i=Object(M.k)(c,t),s=va;break;case Gi.DROP_DOWN:o=e.componentProps,i=Object(M.k)(d,t),s=aa;break;case Gi.DATE_PICKER:o=e.componentProps,i=Object(M.k)(p,t),s=ea;break;case Gi.SUBMIT:(o=e.componentProps).isFormReadyForSubmission=null===(n=o.isFormReadyForSubmission)||void 0===n||n,i=Object(M.k)(g,t),s=Ki;break;default:return null}return m.a.createElement(s,Object(r.__assign)({},o,{styles:i,disabled:a}))}(e,o))})),m.a.createElement(Qi.a,{className:s.footerAIGeneratedStyles},Object(u.a)()))},Ia=n(3432),wa=function(){return m.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("rect",{width:"20",height:"20",rx:"10",fill:"url(#pattern0)"}),m.a.createElement("defs",null,m.a.createElement("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},m.a.createElement("use",{xlinkHref:"#image0_6409_5011",transform:"scale(0.0033557)"})),m.a.createElement("image",{id:"image0_6409_5011",width:"298",height:"298",xlinkHref:"data:image/png;base64,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"})))},Ta=function(e){var t,n,o,i,a,s,l,c,d=e.styles,p=e.body,g=Object(r.__read)(Object(f.useState)(!1),2),h=g[0],v=g[1],b=(null!==(t=p.reviewAgentIndividualCardProps)&&void 0!==t?t:{reviewAgentCardType:wi.EntryPointCard,reviewAgentInternalCardProps:{onAddDetailsButtonClick:function(){},onStartReviewButtonClick:function(){}}}).reviewAgentInternalCardProps,y=null!==(n=b.isTriggeredFromReviewerAgentPane)&&void 0!==n&&n;return m.a.createElement(S,{style:d.reviewAgentEntryCardStyle},y?null:m.a.createElement(pn.a,null,null!==(o=b.headerText)&&void 0!==o?o:Object(u.E)()),m.a.createElement(U,null,m.a.createElement(S,{horizontal:!0,style:d.reviewAgentEntryCardElementStyle},m.a.createElement(U,null,null!==(i=b.reviewAgentIcon)&&void 0!==i?i:m.a.createElement(wa,null)),m.a.createElement(Ia.a,null,null!==(a=b.reviewSyncText)&&void 0!==a?a:Object(u.F)()))),m.a.createElement(qi.a,null,null!==(s=b.reviewAgentDescriptionText)&&void 0!==s?s:Object(u.D)()),m.a.createElement(U,null,m.a.createElement(S,{horizontal:!0,style:d.reviewAgentEntryCardElementStyle},m.a.createElement(U,null,m.a.createElement(w.a,{onClick:function(){b.onStartReviewButtonClick(),v(!0)},size:"small",disabled:h},m.a.createElement(qi.a,null,null!==(l=b.buttonText)&&void 0!==l?l:Object(u.G)()))),m.a.createElement(U,null,m.a.createElement(w.a,{onClick:function(){b.onAddDetailsButtonClick(),v(!0)},size:"small",disabled:h},m.a.createElement(qi.a,null,null!==(c=b.buttonText)&&void 0!==c?c:Object(u.C)()))))))},ka=(Object(G.a)(v.c),Object(r.__assign)({reviewAgentEntryCardStyle:Object(r.__assign)({display:"flex",flexDirection:"column"},W.a.gap("16px")),reviewAgentEntryCardElementStyle:Object(r.__assign)({display:"flex",flexDirection:"row"},W.a.gap("8px")),reviewAgentEntryCardSecondHeaderStyle:{},reviewAgentEntryCardDescriptionStyle:{},reviewAgentEntryCardButtonStyle:{},reviewAgentEntryCardReviewSyncIcon:{},reviewAgentEntryCardContinueIcon:{}},Zr())),ja=Object(y.a)(ka),Pa=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,o=Object(r.__read)(Object(f.useState)(0),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(Object(r.__spreadArray)([],Object(r.__read)(n.suggestionIndices),!1)),2),l=s[0],c=s[1],d=n.suggestionIndices[i].changeType,p=Object(r.__read)(Object(f.useState)(!1),2);p[0],p[1];Object(f.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var g=function(){return a((function(e){return e-1}))},h=function(){return a((function(e){return e+1}))};return m.a.createElement(S,{style:t.stack,customProperties:{tabIndex:-1}},l.length?m.a.createElement(m.a.Fragment,null,m.a.createElement($i.a,null,"".concat(Object(u.z)()," ").concat(i+1," of ").concat(l.length)),m.a.createElement("div",null,m.a.createElement(pn.a,null,d," "),m.a.createElement(Ia.a,null,Object(u.J)()," "),m.a.createElement(pn.a,null,n.suggestionIndices[i].initialText," "," to"),m.a.createElement("br",null),m.a.createElement(Ia.a,null,n.suggestionIndices[i].suggestedText)),m.a.createElement("div",{className:t.footer},m.a.createElement(w.a,{disabled:n.suggestionIndices[i].disabled,size:"small",icon:m.a.createElement(Ct.f,null),key:i,onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return c((function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return t[i].disabled=!0,t})),[4,l[i].onApplySuggestion(l[i].commentId,l[i].suggestedText,l[i].changeType)];case 1:return e.sent(),[2]}}))}))}},Object(u.f)()),m.a.createElement("div",{className:t.pagination},m.a.createElement("div",null,m.a.createElement(m.a.Fragment,null,m.a.createElement(x.a,{content:Object(u.s)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Ct.r,null),onClick:g,disabled:0==i,className:t.paginationButton})),m.a.createElement(x.a,{content:Object(u.r)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Ct.u,null),onClick:h,disabled:i+1>=l.length,className:t.paginationButton})))))),m.a.createElement("div",{className:t.contentBoxIcon},Object(u.a)())):m.a.createElement(m.a.Fragment,null,Object(u.q)()))},Aa=Object(G.a)(v.b),_a=Object(r.__assign)({stack:Object(r.__assign)({},W.a.gap("16px")),header:{fontWeight:"600"},contentBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Aa.neutralLight,minHeight:"50px",position:"relative"},W.a.padding("12px")),W.a.border("1px","solid",Aa.neutralLighterAlt)),W.a.borderRadius(Aa.borderRadiusMedium)),footer:Object(r.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},W.a.gap("12px")),pagination:Object(r.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},W.a.gap("10px")),paginationButton:Object(r.__assign)(Object(r.__assign)({backgroundColor:Aa.neutralLight,height:"24px"},W.a.border("none")),{"&:hover":{color:Aa.themePrimary}}),spinnerButton:{backgroundColor:Aa.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Aa.themePrimary},"&:disabled":{color:Aa.neutralLighterAlt,"&:hover":{color:Aa.neutralLighterAlt}}},paginationNumberBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"center",backgroundColor:Aa.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},W.a.border("1px","solid",Aa.neutralLighterAlt)),W.a.borderRadius(Aa.borderRadiusMedium)),Ot.a.caption1),W.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:Object(r.__assign)(Object(r.__assign)({},Ot.a.caption2),{color:Aa.neutralSecondaryAlt}),disabledContentBoxIcon:{":hover":{color:Aa.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Aa.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Zr()),Da=Object(y.a)(_a),La=n(3440),Ma=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=n.headerText,o=n.reviewersWithAction,i=n.statusMessage,a=n.labelForReviewedPeople,s=n.labelForPendingPeople,l=n.commentsSummaryHeader,c=n.commentsSummaries,d=o.filter((function(e){return e.responded})).length,p=o.length-d;return m.a.createElement(S,{style:t.reviewStatusCardStyle},m.a.createElement(La.a,null,r),m.a.createElement(pn.a,null,i),d>0&&Ba(o,!0,a,t),p>0&&Ba(o,!1,s,t),c.length>0&&c[0].length>0&&m.a.createElement("div",null,m.a.createElement($i.a,null,l),c.map((function(e,t){return m.a.createElement("p",{key:t},m.a.createElement(pn.a,{key:t},e))}))),m.a.createElement(Qi.a,{className:t.footerAIGeneratedStyles},Object(u.a)()))},Ba=function(e,t,n,r){return m.a.createElement("div",{className:r.reviewSStatusReviewersListStyle},m.a.createElement($i.a,null,n),m.a.createElement(ua.a,{"aria-label":"Reviewers List",className:r.reviewStatusCardWrapperStyle},e.map((function(e,n){return e.responded===t&&m.a.createElement(da.a,{shape:"circular",media:m.a.createElement(zo.a,{name:e.suggestion.displayName,shape:"circular"}),dismissible:!1,key:n,size:"extra-small",value:e.suggestion.mail},e.suggestion.displayName)}))))},Ra=Object(G.a)(v.c),Fa=Object(r.__assign)({reviewStatusCardStyle:{rowGap:"17px",display:"flex",flexDirection:"column"},reviewSStatusReviewersListStyle:{rowGap:"8px",display:"flex",flexDirection:"column"},reviewStatusCardWrapperStyle:{flexWrap:"wrap",rowGap:"8px"},footerAIGeneratedStyles:{color:Ra.neutralSecondaryAlt}},Zr()),Na=Object(y.a)(Fa),Ha=function(e){var t,n,r=e.styles,o=e.body,i=o.reviewAgentIndividualCardProps.reviewAgentCardType,a=ja(),s=Da(),l=Na();switch(i){case wi.EntryPointCard:t=Object(M.k)(a,r),n=Ta;break;case wi.ConfirmInvitationCard:t=Object(M.k)({},r),n=xa;break;case wi.SuggestionCard:t=Object(M.k)(s,r),n=Pa;break;case wi.ReviewStatusCard:t=Object(M.k)(l,r),n=Ma;break;default:t=Object(M.k)({},r),n=function(){return m.a.createElement("div",null,"Invalid Card Type")}}return m.a.createElement(n,{body:o,styles:t})},Ua=n(3426),Va=n(3427),za=n(3428),Ga=n(3429),Wa=n(3430),Qa=n(3431),qa=n(3602),Ka=function(e){var t=e.styles,n=e.handleApplyOnClick,o=e.handleApplyAllOnClick,i=Object(r.__read)(Object(f.useState)(!1),2),a=i[0],s=i[1],l=Object(r.__read)(Object(f.useState)(!1),2),c=l[0],d=l[1],p=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,o()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?m.a.createElement(x.a,{content:Object(u.L)(),relationship:"label"},m.a.createElement(w.a,{className:Object(C.a)(t.spinnerButton,t.combinedButton),onClick:p,disabled:!0,icon:m.a.createElement(Mt.e,{className:t.spinnerIcon})})):m.a.createElement(E.a,{positioning:"below-end"},m.a.createElement(I.a,{disableButtonEnhancement:!0},(function(e){return m.a.createElement(x.a,{content:Object(u.g)(),relationship:"label"},m.a.createElement(Di.a,{menuButton:e,primaryActionButton:{onClick:p},size:"small",className:t.applyButton},c?Object(u.e)():Object(u.f)()))})),m.a.createElement(k.a,null,m.a.createElement(j.a,null,m.a.createElement(P.a,{onClick:function(){d((function(e){return!e}))}},c?Object(u.f)():Object(u.e)()))))},Ya=[{columnKey:"old",label:"Old Comment"},{columnKey:"new",label:"New Comment"}],Za=function(e){var t=e.styles,n=e.body,o=Object(r.__read)(Object(f.useState)(0),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(Object(r.__spreadArray)([],Object(r.__read)(n.commentIndices),!1)),2),l=s[0],c=s[1],d=Object(r.__read)(Object(f.useState)(!1),2),p=d[0],g=d[1];Object(f.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var h=function(){return a((function(e){return e-1}))},v=function(){return a((function(e){return e+1}))},b=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return g(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),g(!1),[2]}}))}))},y=function(){c((function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return t.splice(i,1),t}))},O={styles:t,handleApplyOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return m.a.createElement(S,{style:t.stack,customProperties:{tabIndex:-1}},l.length?m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:t.header},Object(u.i)()),m.a.createElement(Ua.a,{"aria-label":"2X2 table"},m.a.createElement("div",{className:t.header},m.a.createElement("p",null,"Author Email : ",n.commentIndices[i].authorEmail)),m.a.createElement(Va.a,null,m.a.createElement(za.a,null,Ya.map((function(e){return m.a.createElement(Ga.a,{key:e.columnKey,className:t.tableHeader},e.label)})))),m.a.createElement(Wa.a,null,m.a.createElement(za.a,null,m.a.createElement(Qa.a,null,m.a.createElement(qa.a,null,n.commentIndices[i].oldCommentText)),m.a.createElement(Qa.a,null,m.a.createElement(qa.a,null,n.commentIndices[i].newCommentText))))),m.a.createElement("div",{className:t.contentBox},m.a.createElement("div",{className:t.contentBoxButtonGroup},m.a.createElement("div",{className:p?t.disabledContentBoxIcon:t.contentBoxIcon},p?m.a.createElement(Mt.f,{className:t.spinnerIcon}):m.a.createElement(x.a,{content:Object(u.p)(),relationship:"label"},m.a.createElement(We.b,{onClick:b}))),p?m.a.createElement(m.a.Fragment,null):m.a.createElement("div",{className:Object(C.a)(t.contentBoxIcon,t.dismissIcon)},m.a.createElement(x.a,{content:Object(u.y)(),relationship:"label"},m.a.createElement(Se.h,{onClick:y})))),m.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.commentIndices[i].comment)),m.a.createElement("div",{className:t.footer},m.a.createElement("div",null,m.a.createElement(Ka,Object(r.__assign)({},O))),m.a.createElement("div",{className:t.pagination},m.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),m.a.createElement("div",null,m.a.createElement(m.a.Fragment,null,m.a.createElement(x.a,{content:Object(u.s)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Co.i,null),onClick:h,disabled:0==i,className:t.paginationButton})),m.a.createElement(x.a,{content:Object(u.r)(),relationship:"label"},m.a.createElement(w.a,{icon:m.a.createElement(Co.j,null),onClick:v,disabled:i+1>=l.length,className:t.paginationButton}))))))):m.a.createElement(m.a.Fragment,null,Object(u.q)()))},Ja=Object(G.a)(v.b),Xa=Object(r.__assign)({stack:Object(r.__assign)({textAlign:"start",textOverflow:"clip"},W.a.gap("12px")),header:{fontWeight:"bold"},contentBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Ja.neutralLight,minHeight:"50px",position:"relative"},W.a.padding("12px")),W.a.border("1px","solid",Ja.neutralLighterAlt)),W.a.borderRadius(Ja.borderRadiusMedium)),footer:Object(r.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},W.a.gap("12px")),pagination:Object(r.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},W.a.gap("10px")),paginationButton:Object(r.__assign)(Object(r.__assign)({backgroundColor:Ja.neutralLight,height:"24px"},W.a.border("none")),{"&:hover":{color:Ja.themePrimary}}),spinnerButton:{backgroundColor:Ja.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Ja.themePrimary}},paginationNumberBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"center",backgroundColor:Ja.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},W.a.border("1px","solid",Ja.neutralLighterAlt)),W.a.borderRadius(Ja.borderRadiusMedium)),Ot.a.caption1),W.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Ja.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Ja.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Ja.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Zr()),$a=Object(y.a)(Xa),es=n(98),ts=n(344),ns=n.n(ts),rs=Object(G.a)(v.b),os=Object(r.__assign)(Object(r.__assign)({},Zr()),{cardRoot:{color:rs.black,fontSize:Q.a.fontSizeBase300,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",Q.a.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Hover},W.a.padding("1px","5px")),"& td":Object(r.__assign)(Object(r.__assign)({},W.a.borderBottom("1px","solid",Q.a.colorNeutralBackground3Pressed)),W.a.padding("1px","5px")),"& a ":Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:Q.a.lineHeightBase200,gap:Q.a.spacingHorizontalXS,display:"inline-flex",alignItems:"flex-start",color:rs.colorBrandForegroundLink},W.a.padding("0px","0px",Q.a.spacingVerticalXXS)),{textDecorationLine:"none",cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(r.__assign)({color:rs.colorBrandForegroundLinkHover},W.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:active"]=Object(r.__assign)({color:rs.colorBrandForegroundLinkPressed},W.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:focus"]=Object(r.__assign)(Object(r.__assign)({color:rs.colorBrandForegroundLinkSelected},W.a.textDecoration("underline","solid",Q.a.colorStrokeFocus2)),W.a.borderBottom("1px","solid",Q.a.colorStrokeFocus2)),e}()),function(){var e;return(e={})["&:disabled"]={color:Q.a.colorNeutralForegroundDisabled,textDecorationLine:"none",cursor:"default"},e}())),"& button, .ac-pushButton":Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:Q.a.fontWeightRegular,color:Q.a.colorNeutralForeground1,fontSize:Q.a.fontSizeBase200},W.a.padding(Q.a.spacingVerticalXS,Q.a.spacingHorizontalS)),W.a.borderRadius(Q.a.borderRadiusMedium)),W.a.border("1px","solid",Q.a.colorNeutralStroke1)),{backgroundColor:Q.a.colorNeutralBackground1,cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(r.__assign)(Object(r.__assign)({},W.a.borderColor(Q.a.colorNeutralStroke1Hover)),{backgroundColor:Q.a.colorNeutralBackground1Hover,color:Q.a.colorNeutralForeground1Hover}),e["&:hover .".concat(St.a.icon)]={color:rs.themePrimary},e}()),function(){var e;return(e={})["&:hover:active"]=Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Pressed,color:Q.a.colorNeutralForeground1Pressed},W.a.borderColor(Q.a.colorNeutralStroke1Pressed)),e}()),function(){var e;return(e={})["&:disabled"]=Object(r.__assign)(Object(r.__assign)({},W.a.borderColor(Q.a.colorNeutralStrokeDisabled)),{color:Q.a.colorNeutralForegroundDisabled,backgroundColor:Q.a.colorNeutralBackgroundDisabled,cursor:"default"}),e}())),"& .ac-container":{"& ol, ul":{paddingInlineStart:Q.a.spacingVerticalXL}},"& .ac-image":{objectFit:"contain"}},decorativeBorder:Object(r.__assign)(Object(r.__assign)({},W.a.margin(Q.a.spacingVerticalS,Q.a.spacingVerticalNone,Q.a.spacingVerticalNone)),Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius(Q.a.borderRadiusMedium)),W.a.border("1px","solid",Q.a.colorNeutralStroke1))),adaptiveCardWrapper:Object(r.__assign)({},W.a.padding(Q.a.spacingVerticalS,Q.a.spacingVerticalM,Q.a.spacingVerticalM)),cardHeader:{},cardFooter:{},cardSourceLabel:{display:"flex",flexDirection:"row",width:"100%",height:Q.a.lineHeightBase300,marginBottom:Q.a.spacingVerticalM,color:Q.a.colorNeutralForeground4,"& label":{fontSize:Q.a.fontSizeBase100,marginLeft:Q.a.spacingVerticalXS,height:Q.a.lineHeightBase100}}}),is=Object(y.a)(os),as=function(e){var t=e.text,n=is(),r=Object(C.a)(null==n?void 0:n.cardFooter,null==n?void 0:n.footerBar);return t?m.a.createElement("div",{className:r},m.a.createElement("span",null,t)):null},ss=function(e){var t=e.text,n=is(),r=Object(C.a)(null==n?void 0:n.cardHeader,n.headerBar);return t?m.a.createElement("div",{className:r},m.a.createElement("span",null,t)):null},ls=n(1622),cs=function(e){var t=e.text,n=e.iconName,r=is();return t||n?m.a.createElement(S,{style:r.cardSourceLabel},n&&m.a.createElement(ls.a,{iconName:n}),t&&m.a.createElement("label",null,t)):null},us=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.isTelemetryEnabled=function(e){return e instanceof t||void 0!==e.executeWithTelemetry},t}(es.Action);es.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new ns.a).render(e),t.didProcess=!0};var ds=function(e){var t=e.styles,n=e.body,r=e.telemetryData,o=void 0===r?"":r,i=n.actionHandlers,a=n.customActions,s=n.cardData,l=n.headerText,c=n.footerText,u=n.sourceLabel,d=n.decorativeBorder,p=void 0===d||d,g=Object(C.a)(null==t?void 0:t.adaptiveCardWrapper,p?null==t?void 0:t.decorativeBorder:null);return m.a.createElement(S,{style:null==t?void 0:t.cardRoot},m.a.createElement(ss,{text:l}),m.a.createElement("div",{className:g},m.a.createElement(cs,{text:null==u?void 0:u.text,iconName:null==u?void 0:u.iconName}),m.a.createElement(ps,{element:gs(s,i,a,o)})),m.a.createElement(as,{text:c}))},ps=function(e){var t=e.element,n=Object(f.useRef)();return Object(f.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),m.a.createElement("span",{ref:n})},gs=function(e,t,n,r){var o=new es.CardObjectRegistry;for(var i in es.GlobalRegistry.populateWithDefaultActions(o),n)o.register(i,n[i]);var a=new es.SerializationContext;a.setActionRegistry(o);var s=new es.AdaptiveCard;return s.hostConfig=new es.HostConfig({spacing:{default:"12",padding:"0"},containerStyles:{default:{foregroundColors:{default:{default:rs.black}}}}}),s.parse(e,a),s.onExecuteAction=function(e){try{if(us.isTelemetryEnabled(e))e.executeWithTelemetry(r);else if(e instanceof es.OpenUrlAction)(null==t?void 0:t.openUrlActionHandler)&&t.openUrlActionHandler(e.url,r);else if(e instanceof es.ExecuteAction&&(null==t?void 0:t.executeActionHandlers)){var n=t.executeActionHandlers[e.verb];n&&n(e.data,r)}}catch(e){}},s.render()},hs=n(340),fs=n.n(hs);es.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new ns.a).render(e),t.didProcess=!0};var ms,vs,bs,ys=function(e){var t=e.cardData,n=new es.AdaptiveCard;n.hostConfig=new es.HostConfig({spacing:{padding:"0px"},containerStyles:{default:{foregroundColors:{default:{default:$r.black}}}}}),n.parse(t);var r=n.render();return m.a.createElement(Cs,{element:r})},Cs=function(e){var t=e.element,n=Object(f.useRef)();return Object(f.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),m.a.createElement("span",{ref:n})},Os=function(e){var t=e.styles,n=e.body,o=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=Object(f.useRef)(null),u=n.basin,d=n.uniqueId,p=n.accessPath,g=n.value;Object(f.useEffect)((function(){!function(){var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}()}),[g]);var h=t.adaptiveCardRoot;if(o&&(h=Object(C.a)(t.adaptiveCardRoot,t.strikeThroughText)),u.items&&d&&p){var v=fs()(u.items[d],p,null),b=[];if(a.length>0&&(b=Object(M.h)(v,a)),0===b.length&&v)return m.a.createElement(S,{style:h},m.a.createElement(ys,{cardData:v}),m.a.createElement("span",{ref:c}));if(v&&b.length>0)return m.a.createElement(S,{style:h},b.map((function(e,n){return m.a.createElement("span",{key:n,className:t.markdownRoot},m.a.createElement(ys,{cardData:e.adaptiveCard})," ",e.references.map((function(e,t){return m.a.createElement(ti,Object(r.__assign)({},e,{key:t,telemetryData:l}))})))})),m.a.createElement("span",{ref:c}))}return null},Ss=function(e){var t=e.styles,n=e.body,r=e.warningActionButtons,o=void 0===r?[]:r;return m.a.createElement(S,{style:t.warningMessageRootStack},m.a.createElement(Ce.a,{tabIndex:-1},n.warningPrefix,n.warningEmphasizedText&&m.a.createElement("span",{className:t.warningMessageBoldText},n.warningEmphasizedText),n.warningSuffix),o&&o.length>0&&o.map((function(e,n){return m.a.createElement(w.a,{key:n,className:t.warningActionButton,"aria-label":e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled},e.buttonText)})))},Es=Object(G.a)(v.b),xs=Object(r.__assign)({warningMessageRootStack:Object(r.__assign)({alignItems:"center"},W.a.gap("4px")),warningMessageBoldText:Object(r.__assign)({},Ot.a.body1Stronger),warningActionButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"100%",height:"28px",backgroundColor:Es.neutralLight},W.a.border("1px","solid",Es.neutralLighterAlt)),W.a.borderRadius(Es.borderRadiusMedium)),W.a.padding("0px","0px","4px","0px")),Ot.a.body1)},Zr()),Is=Object(y.a)(xs),ws=function(e){var t,n,i,s,l,c,u=e.chatMessage,d=e.chatCardIndex,p=e.shouldShowFeedbackButtons,g=e.handleChatCardThumbsDownClick,h=e.handleChatCardThumbsUpClick,f=e.designerProps,v=e.customMessageRenderers,b=e.pluginServiceProvider,y=e.msgExtCardContextProvider,C=e.useFluentAIGeneratedIndicator,O={handleThumbsDownClick:g,handleThumbsUpClick:h,shouldShowFeedbackButtons:p,chatCardIndex:d,feedbackSectionPosition:u.feedbackSectionPosition,shouldShowAIGeneratedIndicator:u.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:!1,useFluentAIGeneratedIndicator:C,actionBarButtons:u.actionBarButtons,feedbackData:u.feedbackData,showAnimation:u.showAnimation,strikeThroughText:u.strikeThroughText,showMinifiedUI:null!==(t=u.showMinifiedUI)&&void 0!==t&&t,references:u.references,pillsList:u.pillsList,handlePillOnClick:u.handlePillOnClick,handleShowMeOnClick:u.handleShowMeOnClick,warningActionButtons:null!==(n=u.warningActionButtons)&&void 0!==n?n:[],clpSensitivityIndicatorData:null!==(i=u.clpSensitivityIndicatorData)&&void 0!==i?i:void 0,telemetryData:null!==(s=u.telemetryData)&&void 0!==s?s:"",msgExtCardProps:u.msgExtCardProps,pluginAuthError:u.pluginAuthError},S=u.messageType,E=u.body,x=u.styles;switch(S){case a.a.Default:O.styles=Object(M.k)(si(),x),c=m.a.createElement(li,Object(r.__assign)({body:E},O));break;case a.a.PaginatedCard:O.styles=Object(M.k)(Fi(),x),c=m.a.createElement(Mi,Object(r.__assign)({body:E},O));break;case a.a.AccordionCard:c=m.a.createElement(Cr,Object(r.__assign)({styles:x,body:E},O));break;case a.a.ContentCard:O.styles=Object(M.k)(pr(),x),c=m.a.createElement(hr,Object(r.__assign)({body:E},O));break;case a.a.ChatCardWrapper:O.styles=Object(M.k)(function(){var e=Jr(),t=qr();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),x),c=m.a.createElement(no,{renderData:E.renderData,fallbackElement:E.element,customMessageRenderers:v});break;case a.a.FeedbackNudge:O.styles=Object(M.k)(function(){var e=hi(),t=di();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),x),c=m.a.createElement(ci,Object(r.__assign)({body:E},O));break;case a.a.MarkdownCard:O.styles=Object(M.k)(function(){var e=_i(),t=ji();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),x),c=m.a.createElement(ki,Object(r.__assign)({body:E},O,{msgExtCardContextProvider:y}));break;case a.a.SelfHelpAdaptiveCard:O.styles=Object(M.k)(is(),x),c=m.a.createElement(ds,Object(r.__assign)({body:E},O));break;case a.a.StreamingAdaptiveCard:O.styles=Object(M.k)(to(),x),c=m.a.createElement(Os,Object(r.__assign)({body:E},O));break;case a.a.Designer:var I=E,w=f.clientSettings;return E.clientSessionId&&(w.sessionId=E.clientSessionId),E.correlationId&&(w.correlationId=E.correlationId),m.a.createElement($n.a,Object(r.__assign)({key:E.message},f,{clientSettings:w,userInput:I.message,turnId:I.turnId,isRehydration:I.isRehydration,handleThumbsDownClick:function(){return g({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(w)}})},handleThumbsUpClick:function(){return h({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(f.clientSettings)}})},feedbackData:O.feedbackData,fileCacheInfo:I.fileCacheInfo,isStockQuery:I.isStockQuery,stockImages:I.stockImages,imageType:I.imageType,isAuthEnabled:I.isAuthEnabled,dimensions:I.dimensions,companyName:I.companyName}));case a.a.WarningMessage:O.styles=Object(M.k)(Is(),x),c=m.a.createElement(Ss,Object(r.__assign)({body:E},O));break;case a.a.ProactiveSuggestionCard:O.styles=Object(M.k)(zi(),x),c=m.a.createElement(Hi,Object(r.__assign)({body:E},O));break;case a.a.CopilotWorkflowMessage:return m.a.createElement(rr,{launchText:E.launchText,buttonText:E.buttonText,onLaunch:E.onLaunch});case a.a.ReviewerSummaryCard:O.styles=Object(M.k)($a(),x),c=m.a.createElement(Za,Object(r.__assign)({body:E},O));break;case a.a.ReviewAgentCard:O.styles=Object(M.k)({},x),c=m.a.createElement(Ha,Object(r.__assign)({body:E},O));break;default:c=null}return m.a.createElement(Jo,Object(r.__assign)({body:{user:null===(l=u.body)||void 0===l?void 0:l.user,element:c},pluginServiceProvider:b,msgExtCardContextProvider:y},O))},Ts=m.a.memo(ws,(function(e,t){var n,r;return t.chatMessage.messageType===a.a.Designer&&(null===(n=e.designerProps)||void 0===n?void 0:n.clientSettings.designerTheme)===(null===(r=t.designerProps)||void 0===r?void 0:r.clientSettings.designerTheme)})),ks={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:Object(r.__assign)({verticalAlign:"end"},W.a.gap("10px")),chatCardsStack:Object(r.__assign)(Object(r.__assign)({verticalAlign:"end"},W.a.padding("0px","16px")),W.a.gap("10px"))},js=Object(y.a)(ks),Ps=function(e){var t,n=e.children,r=e.chatLog,o=e.styles,i=e.elementsBeforeChatLog,a=e.shouldShowFeedbackButtons,s=void 0===a||a,l=e.handleChatCardThumbsDownClick,c=e.handleChatCardThumbsUpClick,u=e.designerProps,d=e.customMessageRenderers,p=e.pluginServiceProvider,g=e.msgExtCardContextProvider,h=e.useFluentAIGeneratedIndicator,f=Object(M.k)(js(),o),v=null!==(t=null==u?void 0:u.isDesignerEnabled)&&void 0!==t&&t,b=v?Ts:ws;return m.a.createElement(S,{style:f.root,reverse:!0},m.a.createElement(S,{style:f.elementStack},i,m.a.createElement(S,{style:f.chatCardsStack,customProperties:{role:M.a.LIST,"aria-label":Object(M.m)()?OfficeaicopilotStrings.ChatMessagesLabel:"Chat Messages","aria-setsize":r.length}},r.map((function(e,t){return m.a.createElement(b,{key:t,chatCardIndex:t,chatMessage:e,useFluentAIGeneratedIndicator:h,shouldShowFeedbackButtons:s,handleChatCardThumbsDownClick:l,handleChatCardThumbsUpClick:c,designerProps:v?u:void 0,customMessageRenderers:d,pluginServiceProvider:p,msgExtCardContextProvider:g})}))),n))},As=Object(G.a)(v.c),_s={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("10px")),W.a.margin(As.spacingVerticalNone,As.spacingHorizontalNone,As.spacingVerticalS,As.spacingHorizontalS)),{alignContent:"center"}),W.a.border("0px")),(ms={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},ms["&:hover .".concat(St.a.icon)]={color:As.themePrimary},ms["&:hover:active .".concat(St.a.icon)]={color:As.themePrimary},ms))},Ds=Object(y.a)(_s),Ls=function(e){var t=e.buttonText,n=e.icon,r=e.onClick;return m.a.createElement(w.a,{appearance:"subtle",className:Ds().root,icon:n,onClick:r,size:"small"},t)},Ms=Object(G.a)(v.c),Bs={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("10px")),W.a.margin(Ms.spacingVerticalNone,Ms.spacingHorizontalNone,Ms.spacingVerticalS,Ms.spacingHorizontalS)),{alignContent:"center"}),W.a.border("0px")),(vs={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},vs["&:hover .".concat(St.a.icon)]={color:Ms.themePrimary},vs["&:hover:active .".concat(St.a.icon)]={color:Ms.themePrimary},vs))},Rs=Object(y.a)(Bs),Fs=f.memo((function(e){var t=e.handleChangeTopicButtonClick;return f.createElement(w.a,{appearance:"subtle",className:Rs().root,icon:f.createElement(_.e,null),onClick:t,size:"small"},N())})),Ns=Object(G.a)(v.c),Hs={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("10px")),W.a.margin(Ns.spacingVerticalNone,Ns.spacingHorizontalNone,Ns.spacingVerticalS,Ns.spacingHorizontalS)),{alignContent:"center"}),W.a.border("0px")),(bs={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},bs["&:hover .".concat(St.a.icon)]={color:Ns.themePrimary},bs["&:hover:active .".concat(St.a.icon)]={color:Ns.themePrimary},bs))},Us=Object(y.a)(Hs);var Vs=f.memo((function(e){var t=e.handlePythonExitAnalysisButtonClick;return f.createElement(w.a,{appearance:"subtle",className:Us().root,icon:f.createElement(Qe.i,null),onClick:t,size:"small"},"Exit analysis mode")}));function zs(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},button:null!==(n=e.button)&&void 0!==n?n:{},suggestionContainer:null!==(r=e.suggestionContainer)&&void 0!==r?r:{},refreshButton:null!==(o=e.refreshButton)&&void 0!==o?o:{},refreshButtonIcon:null!==(i=e.refreshButtonIcon)&&void 0!==i?i:{},tooltip:null!==(a=e.tooltip)&&void 0!==a?a:{}};return Object(y.a)(s)}var Gs,Ws,Qs=Object(G.a)(v.b),qs=zs({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",flexWrap:"nowrap",backgroundColor:"transparent",minHeight:"67px"},W.a.padding("12px","0px")),W.a.margin(Qs.spacingVerticalNone)),{"> *:not(.ms-StackItem)":{flexShrink:0},overflowX:"auto",overflowY:"hidden"}),suggestionContainer:Object(r.__assign)(Object(r.__assign)({minHeight:"67px"},W.a.overflow("hidden")),W.a.padding("12px")),button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),{display:"flex"}),W.a.padding("0px","8px")),{fontFamily:"-apple-system",lineHeight:"normal",fontStyle:"normal",fontWeight:"400",fontSize:"14px",alignItems:"center",order:"0",textOverflow:"ellipsis",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",textAlign:"start"}),refreshButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",Qs.themeMedium)),{backgroundColor:"transparent"}),W.a.borderRadius("50%")),W.a.padding("2px")),W.a.margin("4px")),{verticalAlign:"middle",minWidth:"40px",height:"40px",order:-1}),tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}}),Ks=zs({root:Object(r.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},W.a.margin(Q.a.spacingHorizontalNone,Q.a.spacingHorizontalL,Q.a.spacingHorizontalNone)),suggestionContainer:{},button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"start",color:Q.a.colorNeutralForeground1,backgroundColor:"transparent"},W.a.border("1px","solid",Q.a.colorBrandBackground2Hover)),Ot.a.caption1),W.a.borderRadius(Q.a.borderRadiusXLarge)),W.a.padding(Q.a.spacingVerticalSNudge,Q.a.spacingHorizontalS)),W.a.margin(Q.a.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(r.__assign)({backgroundColor:Q.a.colorBrandBackground2},W.a.border("1px","solid",Q.a.colorBrandStroke2Hover)),"&:hover :active":Object(r.__assign)({backgroundColor:Q.a.colorBrandBackground2},W.a.border("1px","solid",Q.a.colorBrandStroke2Hover))}}),refreshButton:Object(r.__assign)(Object(r.__assign)({minWidth:"fit-content"},W.a.border("1px","solid",Q.a.colorBrandBackground2Hover)),{"@media (forced-colors: none)":(Gs={"&:hover":Object(r.__assign)({backgroundColor:Q.a.colorBrandBackground2},W.a.border("1px","solid",Q.a.colorBrandStroke2Hover))},Gs["&:hover .".concat(St.a.icon)]={color:Q.a.colorCompoundBrandForeground1},Gs)}),refreshButtonIcon:{width:"14px",height:"14px"}}),Ys=Object(G.a)(v.b),Zs=zs({root:Object(r.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},W.a.margin(Ys.spacingHorizontalNone,Ys.spacingHorizontalL,Ys.spacingHorizontalNone)),suggestionContainer:{},button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"start",color:Ys.neutralPrimary,backgroundColor:"transparent"},W.a.border("1px","solid",Ys.themeMedium)),Ot.a.caption1),W.a.borderRadius(Ys.borderRadiusXLarge)),W.a.padding(Ys.spacingVerticalSNudge,Ys.spacingHorizontalS)),W.a.margin(Ys.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(r.__assign)({backgroundColor:Ys.themeLight},W.a.border("1px","solid",Ys.themeDarker)),"&:hover :active":Object(r.__assign)({backgroundColor:Ys.themeLight},W.a.border("1px","solid",Ys.themeDarker))}}),refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":(Ws={},Ws["&:hover .".concat(St.a.icon)]={color:Ys.themePrimary},Ws)},refreshButtonIcon:{width:"14px",height:"14px"}}),Js=function(e){var t=e.stylesToOverride,n=e.suggestionList,r=e.handleSuggestionPillClick,a=e.showRefreshButton,s=void 0!==a&&a,l=e.handleRefreshButtonClick,c=void 0===l?function(){}:l,u=function(){var e=Zs(),t=Ks(),n=Object(i.g)()?t:e;n.refreshButton=Object(C.a)(n.button,n.refreshButton);var r=qs();Object(o.b)()===o.a.IOS&&Object(M.k)(n,r);return n}();Object(M.k)(u,t);return m.a.createElement("div",{className:u.suggestionContainer},m.a.createElement(S,{style:u.root,horizontal:!0,customProperties:{role:M.a.GROUP,tabIndex:0,"aria-label":F()}},n.map((function(e,t){return m.a.createElement(x.a,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},m.a.createElement(w.a,{size:"small",appearance:"subtle",className:u.button,onClick:function(){return r(e)},role:M.a.BUTTON,id:"".concat(F,"-").concat(t)},e))})),s&&m.a.createElement(x.a,{content:m.a.createElement("span",{className:u.tooltip},Object(M.m)()?OfficeaicopilotStrings.SuggestionPaneRefreshButtonLabel:"Refresh"),relationship:"label",positioning:"above"},m.a.createElement(w.a,{appearance:"subtle",className:u.refreshButton,onClick:function(){c();var e=document.getElementById("".concat(F,"-0"));e&&"function"==typeof e.focus&&e.focus()},icon:{className:u.refreshButtonIcon,children:m.a.createElement(Qe.g,null)},role:M.a.BUTTON}))))},Xs=function(){return Object(M.m)()?OfficeaicopilotStrings.HintCardHeaderTextLabel:"hintCardHeaderText"},$s=function(){return Object(M.m)()?OfficeaicopilotStrings.HintCardDescriptionTextLabel:"hintCardDescriptionText"};var el,tl,nl,rl=function(e){var t,n,r,o={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},headerText:null!==(n=e.headerText)&&void 0!==n?n:{},descriptionText:null!==(r=e.descriptionText)&&void 0!==r?r:{}};return Object(y.a)(o)}({root:{lineHeight:"normal"}}),ol=Object(G.a)(v.b),il={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({boxShadow:ol.shadow4,backgroundColor:ol.neutralLight},W.a.borderRadius(ol.borderRadiusXLarge)),W.a.margin(ol.spacingVerticalNone,ol.spacingHorizontalL,ol.spacingVerticalXXS)),W.a.padding(ol.spacingVerticalM)),rootHighContrast:Object(r.__assign)({},W.a.border("1px","solid",ol.neutralLighterAlt)),headerText:{fontWeight:ol.fontWeightSemibold,color:ol.themePrimary},descriptionText:{color:ol.neutralQuaternaryAlt}},al=Object(y.a)(il),sl=function(e,t){if(t)for(var n in e)e[n]=Object(C.a)(e[n],t[n]);e.rootHighContrast=Object(C.a)(e.root,e.rootHighContrast)},ll=m.a.memo((function(e){var t=e.overrideStyles,n=e.headerText,r=e.descriptionText,a=Object(i.c)(),s=function(){var e=al(),t=rl();Object(o.b)()===o.a.IOS&&sl(e,t);return e}();return sl(s,t),m.a.createElement(S,{style:a?s.rootHighContrast:s.root,customProperties:{role:M.a.GROUP,"aria-labelledby":Xs(),"aria-describedby":$s(),"aria-live":"polite"}},m.a.createElement(Ce.a,{id:Xs(),className:s.headerText},n),m.a.createElement(Ce.a,{id:$s(),className:s.descriptionText},r))})),cl=Object(G.a)(v.b),ul={chatInputRestShy:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px","solid",cl.neutralLighterAlt)),W.a.borderRadius("12px")),{backgroundColor:cl.neutralLight}),W.a.margin(cl.spacingHorizontalNone,cl.spacingHorizontalL,cl.spacingHorizontalL,cl.spacingHorizontalL)),W.a.padding("4px")),W.a.gap("12px")),{position:"relative",zIndex:"1",transform:"none",transformOrigin:"bottom","&selectors":{"&.chatInputLeftButtons":{"> button":{"&svg":{height:"18px",width:"18px"}}}}}),chatInputContainerRestShy:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding("6px","4px","0px")),{fontFamily:"-apple-system",fontStyle:"normal",fontWeight:"400",fontSize:"15px",cursor:"pointer",width:"min-content",lineHeight:"normal",display:"flex",alignItems:"center",letterSpacing:"-0.43px",color:cl.neutralSecondaryAlt}),W.a.flex("none")),{order:"1",flexGrow:"1"}),chatInputRestShyMenuButton:{height:"40px",width:"40px","&selectors":{"&svg":{height:"24px",width:"24px",fill:cl.themePrimary},"&hover":{backgroundColor:"transparent !important"}}}},dl=Object(y.a)(ul),pl=n(3441),gl=n(3442),hl=n(3443),fl=n(238),ml=n(862),vl=Object(y.a)({item:{fontSize:"16px",lineHeight:"normal",fontFamily:"-apple-system"},itemContent:Object(r.__assign)(Object(r.__assign)({display:"inline-block",whiteSpace:"nowrap"},W.a.overflow("hidden")),{textOverflow:"ellipsis"}),menuGroupHeader:{fontSize:"14px",fontFamily:"-apple-system",lineHeight:"normal"}}),bl=Object(G.a)(v.b),yl=Object(y.a)({item:(el={},el["&:hover .".concat(ml.a.icon)]={color:bl.themePrimary},el.paddingLeft="10px",el),itemContent:{},menuParent:Object(r.__assign)({width:"100%"},W.a.margin("0px","16px")),menuGroupHeader:{color:bl.black}}),Cl=function(){var e=yl(),t=vl();if(Object(o.b)()===o.a.IOS)Object(M.k)(e,t);return e},Ol=function(e){var t,n=Cl();return m.a.createElement(pl.a,{key:null!==(t=e.sectionHeader)&&void 0!==t?t:fl.h},e.showSectionTopDivider&&m.a.createElement(gl.a,null),e.sectionHeader!==fl.h&&m.a.createElement(hl.a,{className:n.menuGroupHeader},e.sectionHeader),e.starterPrompts.map((function(t){return Sl(t,e.sectionHeader)})))},Sl=function(e,t){var n=Object(A.a)(e.iconHover,e.iconRegular),r=Cl();return m.a.createElement(P.a,{key:e.text,className:r.item,icon:m.a.createElement(n,null),onClick:function(){return El(e.text)},"aria-label":t+" "+e.text,content:{className:r.itemContent}},e.text)},El=function(e){tl.handleOnClickStarterPromptMenuItem&&tl.handleOnClickStarterPromptMenuItem(e)},xl=Object(G.a)(v.b),Il=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent")),{width:"40px",height:"40px",maxWidth:"unset","&:hover":Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent"))})}),wl=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent"))})}),Tl=Object(y.a)({root:{color:xl.themePrimary}}),kl=Object(G.a)(v.b),jl=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:kl.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},W.a.borderColor(kl.neutralLight)),W.a.borderRadius(kl.borderRadiusXLarge)),{marginLeft:"4px",width:"32px",height:"32px","&:hover":{backgroundColor:kl.neutralTertiaryAlt}})}),Pl=Object(y.a)({root:{backgroundColor:kl.neutralLighter}}),Al=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:kl.neutralTertiary},W.a.borderColor(kl.neutralTertiary)),{"&:hover":Object(r.__assign)({backgroundColor:kl.neutralTertiary},W.a.borderColor(kl.neutralTertiary))})}),_l=Object(y.a)({root:{color:kl.neutralPrimary}}),Dl=Object(y.a)({root:{color:kl.themePrimary}}),Ll=Object(y.a)({root:{color:kl.neutralQuaternary}}),Ml=function(e){var t=e.title,n=e.isDisabled,i=e.isMenuOpen,a=e.setMenuOpen,s=(e.handleClick,e.positioningRef),l=e.menuProps,c=Object(f.useRef)(function(){var e=jl(),t=Il();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}()),u=Object(f.useRef)(Object(C.a)(c.current.root,Pl().root)),d=Object(f.useRef)(Object(C.a)(c.current.root,function(){var e=Al(),t=wl();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}().root)),p=Object(f.useRef)(function(){var e=_l(),t=Tl();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}()),g=Object(f.useRef)(Dl().root),h=Object(f.useRef)(Ll().root),v=Object(r.__read)(Object(f.useState)(c.current.root),2),b=v[0],y=v[1],O=Object(r.__read)(Object(f.useState)(p.current.root),2),S=O[0],x=O[1];Object(f.useEffect)((function(){n?(y(d.current),x(h.current)):i?(y(u.current),x(g.current)):(y(c.current.root),x(p.current.root))}),[n,i]);return m.a.createElement(m.a.Fragment,null,m.a.createElement(w.a,{className:b,title:t,"aria-haspopup":!0,"aria-expanded":i,role:"button",icon:{className:S,children:i?m.a.createElement(Mt.c,null):m.a.createElement(Mt.d,null)},disabled:n,onClick:function(){return a(!i)}}),m.a.createElement(E.a,{open:i,onOpenChange:function(e,t){a(t.open)},positioning:{positioningRef:s}},(tl=l,m.a.createElement(k.a,{className:Cl().menuParent},m.a.createElement(j.a,null,tl.sections.map((function(e){return Ol(e)})))))))},Bl=function(e){var t,n=e.handleClickAndUnMount,o=e.chatInputRestShyPlaceholder,i=e.isMenuButtonEnabled,a=void 0!==i&&i,s=e.isDisabled,l=e.menuButtonTitle,c=void 0===l?Object(fl.f)():l,u=e.handleMenuButtonClick,d=e.handleOnOpenMenu,p=e.menuProps,g=(e.overrideStyles,Object(f.useRef)()),h=Object(f.useRef)(null),v=dl(),b=Object(r.__read)(Object(f.useState)(!1),2),y=b[0],C=b[1];m.a.useEffect((function(){var e;g.current&&(null===(e=h.current)||void 0===e||e.setTarget(g.current))}),[h,g]);return s&&y&&C(!1),m.a.createElement(S,null,m.a.createElement("div",{id:"copilot-chat-input-shy",className:v.chatInputRestShy,ref:g},m.a.createElement(S,{horizontal:!0},m.a.createElement("div",{className:v.chatInputRestShyMenuButton},a&&m.a.createElement(Ml,{title:c,isDisabled:s||0===(null===(t=null==p?void 0:p.sections)||void 0===t?void 0:t.length),isMenuOpen:y,setMenuOpen:C,handleClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return u&&u(),y?(C(!1),[3,4]):[3,1];case 1:return d?[4,d()]:[3,3];case 2:e.sent(),e.label=3;case 3:C(!0),e.label=4;case 4:return[2]}}))}))},menuProps:p,positioningRef:h})),m.a.createElement("div",{className:v.chatInputContainerRestShy,onClick:n,role:"textbox",tabIndex:0,"aria-disabled":s},o))))},Rl=Object(G.a)(v.b),Fl={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Rl.neutralLight},W.a.borderRadius(Rl.borderRadiusXLarge)),W.a.margin(Rl.spacingHorizontalL)),W.a.padding(Rl.spacingVerticalM)),W.a.border("1px","double",Rl.colorTransparentStroke)),{backgroundImage:"linear-gradient(".concat(Rl.neutralLight,", ").concat(Rl.neutralLight,"), radial-gradient(circle at top left, ").concat(Rl.themePrimary,", ").concat(Rl.themeSecondary,")"),backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",rowGap:Rl.spacingVerticalXS}),rootHighContrast:Object(r.__assign)({},W.a.border("1px","solid",Rl.neutralLighterAlt)),headerWrapper:{flexDirection:"row",alignItems:"center"},headerText:{fontWeight:Rl.fontWeightSemibold,marginLeft:Rl.spacingHorizontalSNudge,lineHeight:Rl.lineHeightBase300,whiteSpace:"pre-line"},descriptionText:{color:Rl.neutralQuaternaryAlt,fontSize:Rl.fontSizeBase300,lineHeight:Rl.lineHeightBase300,whiteSpace:"pre-line",marginTop:Rl.spacingVerticalS},tipCardIcon:{color:Rl.themePrimary},actionButtonWrapper:Object(r.__assign)(Object(r.__assign)({},W.a.margin(0)),{marginTop:Rl.spacingVerticalS,color:Rl.neutralLight}),actionButton:Object(r.__assign)(Object(r.__assign)({float:"left",alignItems:"center",justifyContent:"center",width:"fit-content",height:Rl.spacingVerticalXXL,backgroundColor:Rl.themePrimary},W.a.borderRadius(Rl.borderRadiusMedium)),{paddingRight:Rl.spacingHorizontalS,paddingLeft:Rl.spacingHorizontalS,paddingTop:"3px",paddingBottom:"5px",fontSize:Rl.fontSizeBase200,lineHeight:Rl.lineHeightBase200,color:Rl.neutralLight,":hover":Object(r.__assign)(Object(r.__assign)({backgroundColor:Rl.themeTertiary,color:Rl.neutralLight},W.a.border("1px","solid",Rl.colorNeutralForegroundStaticInverted)),{":active":Object(r.__assign)({backgroundColor:Rl.themeDarker,color:Rl.neutralLight},W.a.border("1px","solid",Rl.colorNeutralForegroundStaticInverted))})})},Nl=Object(y.a)(Fl),Hl=m.a.memo((function(e){var t=e.headerText,n=e.descriptionTextList,r=e.buttonTitle,o=e.onClick,a=e.overrideStyles,s=e.icon,l=Object(i.c)(),c=Nl();!function(e,t){if(t)for(var n in e)e[n]=Object(C.a)(e[n],t[n]);e.rootHighContrast=Object(C.a)(e.root,e.rootHighContrast)}(c,a);var u;return m.a.createElement(S,{style:l?c.rootHighContrast:c.root,customProperties:{role:M.a.GROUP,"aria-labelledby":"tipCardHeaderText","aria-describedby":"tipCardDescriptionText"}},m.a.createElement(S,{style:c.headerWrapper},s&&(u=s,m.a.createElement(u,{className:c.tipCardIcon})),m.a.createElement(Ce.a,{id:"tipCardHeaderText",className:c.headerText},t)),m.a.createElement(S,null,(null!=n?n:[]).map((function(e,t){return m.a.createElement(Ce.a,{key:t,id:"tipCardDescriptionText",className:c.descriptionText},e)}))),r&&o?m.a.createElement("div",{className:c.actionButtonWrapper},m.a.createElement(w.a,{appearance:"primary",className:c.actionButton,onClick:o,title:r},r)):null)})),Ul=Object(y.a)({inputBanner:Object(r.__assign)(Object(r.__assign)({minHeight:"32px"},W.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"})}),Vl=function(e){var t=e.chatInputBannerString;return m.a.createElement(on.a,{className:Ul().inputBanner},m.a.createElement(tn.a,null,t))};!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(nl||(nl={}));var zl,Gl,Wl,Ql,ql={fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system"},Kl=Object(G.a)(v.b),Yl=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Kl.neutralSecondaryAlt,alignItems:"flex-start"},Ot.a.body1),{fontStyle:"normal"}),W.a.gap("1px")),{content:"attr(title)"}),Zl={color:Kl.neutralQuaternary},Jl=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),W.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(r.__assign)({},W.a.outline(0))}),Xl={userInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Jl),{paddingRight:"2px",fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system",outlineStyle:"none"}),{"&:focus":Object(r.__assign)({},W.a.outline(0)),"&:focus::after":Object(r.__assign)(Object(r.__assign)({},Yl),ql),"&::after":Object(r.__assign)(Object(r.__assign)({},Yl),ql)})},$l={userInput:{"&:focus::after":Zl,"&::after":Zl}},ec=Object(y.a)(Xl),tc=Object(y.a)($l),nc=m.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,i=e.placeholderText,a=e.chatInputTabIndex,s=e.isDisabled,l=e.handleKeyDown,c=e.handleKeyUp,u=e.handleOnPaste,d=e.handleOnBeforeInput,p=e.handleOnInput,g=e.handleOnCompositionEnd,h=e.handleOnChatInputControlMount,v=e.handleOnChatInputControlUnmount,b=Object(f.useRef)();Object(f.useImperativeHandle)(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){y(e)},updateInputText:function(e,t){switch(t){case nl.InsertAtCursor:S(e);break;case nl.Replace:y(e)}},getInputText:function(){return O()},getInputSpanElement:function(){return b.current},setFocus:function(){E()},getGhostText:function(){var e,t;return null!==(t=null===(e=b.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;return null===(t=b.current)||void 0===t?void 0:t.setAttribute("title",e)}}}));var y=function(e){var t=b.current;t&&(t.innerText=e)},O=function(){var e=fl.h,t=b.current;return t&&(e=t.innerText),e},S=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1)}},E=function(){if(!s){var e=b.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(f.useEffect)((function(){return h&&h(),function(){v&&v()}}),[]);var x=Object(f.useRef)(ec()),I=Object(f.useRef)(tc()),w=Object(r.__read)(Object(f.useState)(x.current.userInput),2),T=w[0],k=w[1];return Object(f.useEffect)((function(){n&&k(Object(C.a)(x.current.userInput,n))}),[n]),Object(f.useEffect)((function(){s&&k(Object(C.a)(x.current.userInput,I.current.userInput))}),[s]),m.a.createElement("span",{ref:b,className:T,title:i,"aria-label":i,role:"textbox",tabIndex:a,contentEditable:!s,suppressContentEditableWarning:!s,onKeyDown:l,onKeyUp:c,onPaste:u,onBeforeInput:d,onCompositionEnd:g,onInput:p,spellCheck:!Object(o.d)()})})),rc=n(3444),oc=Object(G.a)(v.b),ic=Object(y.a)({root:{backgroundColor:"transparent"}}),ac=Object(y.a)({root:Object(r.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:oc.neutralTertiaryAlt,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},W.a.padding("16px"))}),sc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px solid")),W.a.borderColor("transparent")),W.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),lc=Object(y.a)({root:{backgroundColor:oc.themePrimary,color:oc.neutralLight,"&:hover":{backgroundColor:"".concat(oc.themePrimary," !important")}}}),cc=Object(y.a)({root:{backgroundColor:oc.neutralLight,color:oc.black,"&:hover":Object(r.__assign)(Object(r.__assign)({},W.a.borderColor("".concat(oc.themePrimary))),{backgroundColor:"".concat(oc.neutralLight," !important")})}}),uc=Object(y.a)({root:{color:oc.themePrimary,"&:hover":{color:oc.themePrimary},fontSize:"12px"}}),dc=Object(y.a)({root:{height:"63px",bottom:"12px"}}),pc=Object(y.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),gc=Object(y.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:oc.neutralQuaternaryAlt,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),hc=Object(y.a)({root:{fontWeight:"bold",color:oc.black,fontSize:"12px",paddingBottom:"0px"}}),fc=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(C.a)(sc().root,lc().root),c=Object(C.a)(sc().root,cc().root),u=gc().root,d=Object(C.a)(u,hc().root),p=uc().root,g=dc().root,v=Object(f.useRef)(null);return Object(f.useEffect)((function(){var e;t&&(null===(e=v.current)||void 0===e||e.focus())}),[t]),m.a.createElement(h.a,{className:ic().root},m.a.createElement(de.a,{modalType:"modal",open:t},m.a.createElement(pe.a,{className:ac().root,tabIndex:0},m.a.createElement(ge.a,null,m.a.createElement(he.a,{className:d},n),m.a.createElement(me.a,null,o&&m.a.createElement(V.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),m.a.createElement(T.a,{className:u},r),i&&m.a.createElement(ht.a,{inline:!0,className:p,target:"_blank",href:fl.i},Object(fl.n)())),m.a.createElement(Qt.a,{className:pc().root},m.a.createElement(fe.a,{disableButtonEnhancement:!0},m.a.createElement(w.a,{ref:v,className:c,appearance:"secondary",onClick:s},Object(fl.o)())),m.a.createElement(w.a,{className:l,appearance:"primary",onClick:a},Object(fl.p)()))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(zl||(zl={}));var mc=Object(G.a)(v.b),vc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:mc.neutralLight,backgroundPositionX:"center",backgroundPositionY:"center"},W.a.borderRadius("8px")),W.a.borderColor(mc.neutralLight)),(Gl={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Gl["&:hover .".concat(St.a.icon)]={color:mc.themePrimary},Gl["&:hover:active .".concat(St.a.icon)]={color:mc.themePrimary},Gl.display="flow",Gl))}),bc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:mc.themePrimary,color:mc.neutralLight},W.a.borderRadius("50%")),(Wl={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(mc.themeLight)},"60%":{boxShadow:"0 0 0 8px ".concat(mc.themeLight)},"100%":{boxShadow:"0 0 0 0 ".concat(mc.themeLight)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Wl["&.".concat(St.a.icon)]={color:mc.neutralLight},Wl["&:hover .".concat(St.a.icon)]={color:mc.neutralLight},Wl["&:active .".concat(St.a.icon)]={color:mc.neutralLight},Wl["&:hover:active .".concat(St.a.icon)]={color:mc.neutralLight},Wl["&:hover"]={backgroundColor:mc.themePrimary,color:mc.neutralLight},Wl["&:hover:active"]={backgroundColor:mc.themePrimary,color:mc.neutralLight},Wl))}),yc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:mc.neutralTertiary},W.a.borderColor(mc.neutralTertiary)),(Ql={"&:hover":Object(r.__assign)({backgroundColor:mc.neutralTertiary},W.a.borderColor(mc.neutralTertiary))},Ql["&:hover .".concat(St.a.icon)]={color:mc.neutralQuaternary},Ql["&:hover:active .".concat(St.a.icon)]={color:"".concat(mc.neutralQuaternary," !important")},Ql))}),Cc=Object(y.a)({root:{position:"relative",marginRight:"8px"}}),Oc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:mc.neutralTertiary},W.a.borderRadius("50%")),{color:mc.themePrimary}),loader:Object(r.__assign)(Object(r.__assign)({color:mc.neutralLight},W.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:mc.themePrimary,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Sc=(Object(y.a)({root:{color:mc.neutralPrimary}}),Object(y.a)({root:{color:mc.themePrimary}}),Object(y.a)({root:{color:mc.neutralQuaternary}}),function(e){var t=e.isDisabled,n=e.microphoneButtonProps,o=Object(r.__read)(Object(f.useState)(!1),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(!1),2),l=s[0],c=s[1];Object(f.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(b.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(f.useEffect)((function(){t?g(h.current):n.isMicrophoneListening||g(u.current.root)}),[t]),Object(f.useEffect)((function(){n.microphoneState===zl.Loading?(a(!0),g(v.current)):(a(!1),n.microphoneState===zl.Uninitialized&&g(u.current.root))}),[n.microphoneState]);var u=Object(f.useRef)(vc()),d=Object(r.__read)(Object(f.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(f.useRef)(Object(C.a)(u.current.root,yc().root)),v=Object(f.useRef)(Object(C.a)(u.current.root,Oc().root)),b=Object(f.useRef)(Object(C.a)(u.current.root,bc().root));return m.a.createElement("div",{className:Cc().root},m.a.createElement(w.a,{className:p,title:n.title,"aria-label":n.title,role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?m.a.createElement(rc.a,null):m.a.createElement(rc.b,null),onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t}),i&&m.a.createElement("div",{className:Oc().loader}),m.a.createElement(fc,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))});function Ec(e){var t,n,r,o,i,a,s,l={chatInput:null!==(t=e.chatInput)&&void 0!==t?t:{},chatInputContainer:null!==(n=e.chatInputContainer)&&void 0!==n?n:{},userInput:null!==(r=e.userInput)&&void 0!==r?r:{},chatInputButtons:null!==(o=e.chatInputButtons)&&void 0!==o?o:{},chatInputLeftButtons:null!==(i=e.chatInputLeftButtons)&&void 0!==i?i:{},chatInputRightButtons:null!==(a=e.chatInputRightButtons)&&void 0!==a?a:{},contextualMenu:null!==(s=e.contextualMenu)&&void 0!==s?s:{}};return Object(y.a)(l)}var xc,Ic,wc,Tc=Object(G.a)(v.b),kc=Ec({chatInput:Object(r.__assign)({},W.a.borderRadius(Tc.borderRadiusXLarge)),contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.padding(0)),{maxWidth:"288px",backgroundColor:Tc.neutralLight,boxShadow:Tc.shadow16}),W.a.borderRadius("12px"))}),jc=Ec({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({left:"2",width:"97%",height:"4px"},W.a.borderRadius(0,0,"12px","12px")),{backgroundImage:"linear-gradient(to right, ".concat(Tc.themePrimary,", ").concat(Tc.themeSecondary,")")})}}}),Pc=Object(G.a)(v.b),Ac={chatInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Pc.neutralPrimary,backgroundColor:Pc.neutralLight},W.a.border("1px","solid",Pc.neutralLighterAlt)),W.a.borderRadius(Pc.borderRadiusXLarge)),W.a.margin(0,"16px","16px","16px")),W.a.padding("4px")),W.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(r.__assign)({},W.a.margin("12px","12px","4px","12px")),userInput:{},chatInputButtons:Object(r.__assign)(Object(r.__assign)({backgroundColor:Pc.neutralLight,width:"100%",flexDirection:"row",flexWrap:"wrap"},W.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{alignSelf:"flex-end",display:"flex"},contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},W.a.padding("6px")),{backgroundColor:Pc.neutralLight,boxShadow:Pc.shadow4}),W.a.borderRadius("8px"))},_c=Object(y.a)(Ac),Dc=Object(y.a)({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},W.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(Pc.themePrimary,", ").concat(Pc.themeSecondary,")")})}}}),Lc=Object(y.a)({chatInputRightButtons:{display:"contents"}}),Mc=Object(y.a)({chatInput:{backgroundColor:Pc.neutralTertiary},chatInputButtons:{backgroundColor:Pc.neutralTertiary}}),Bc=Object(G.a)(v.b),Rc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({width:"40px",height:"40px",maxWidth:"unset",backgroundColor:"transparent"},W.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent"))})}),Fc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},W.a.borderColor("transparent"))})}),Nc=Object(y.a)({root:{color:Bc.themePrimary}}),Hc=Object(G.a)(v.b),Uc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Hc.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},W.a.borderColor(Hc.neutralLight)),W.a.borderRadius(Hc.borderRadiusXLarge)),{marginRight:"2px",width:"32px",height:"32px","&:hover":{backgroundColor:Hc.neutralTertiaryAlt}})}),Vc=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Hc.neutralTertiary},W.a.borderColor(Hc.neutralTertiary)),{"&:hover":Object(r.__assign)({backgroundColor:Hc.neutralTertiary},W.a.borderColor(Hc.neutralTertiary))})}),zc=Object(y.a)({root:{color:Hc.neutralPrimary}}),Gc=Object(y.a)({root:{color:Hc.themePrimary}}),Wc=Object(y.a)({root:{color:Hc.neutralQuaternary}}),Qc=function(e){var t=e.title,n=e.isDisabled,i=e.handleClick,a=e.isInputEmpty,s=Object(r.__read)(m.a.useState(!1),2),l=s[0],c=s[1],u=Object(f.useRef)(function(){var e=Uc(),t=Rc();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}()),d=Object(f.useRef)(Object(C.a)(u.current.root,function(){var e=Vc(),t=Fc();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}().root)),p=Object(f.useRef)(zc()),g=Object(f.useRef)(Gc().root),h=Object(f.useRef)(Wc().root),v=Object(f.useRef)(function(){var e={root:""},t=Nc();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}().root),b=Object(r.__read)(Object(f.useState)(u.current.root),2),y=b[0],O=b[1],S=Object(r.__read)(Object(f.useState)(p.current.root),2),E=S[0],x=S[1];Object(f.useEffect)((function(){n?(O(d.current),x(h.current)):(x(l?g.current:a?p.current.root:v.current),O(u.current.root))}),[n,l,a]);var I,T,k,j=Object(o.c)()?We.f:We.h,P=Object(o.c)()?We.e:We.g;return m.a.createElement(w.a,{className:y,title:t,"aria-label":t,role:"button",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:{className:E,children:(I=j,T=P,k=Object(A.a)(T,I),m.a.createElement(k,null))},onClick:i,disabled:n})},qc=m.a.forwardRef((function(e,t){var n,i=e.isDisabled,a=e.overrideStyles,s=e.chatInputTabIndex,l=void 0===s?0:s,c=e.chatInputContainerTabIndex,u=void 0===c?-1:c,d=e.chatInputContainerTitle,p=void 0===d?Object(fl.b)():d,g=e.placeholderText,h=void 0===g?Object(fl.c)():g,v=e.maxInputCharLimit,b=void 0===v?fl.d:v,y=e.handleKeyDown,O=e.handleKeyUp,E=e.handleOnPaste,x=e.handleOnBeforeInput,I=e.handleOnInput,w=e.submitButtonTitle,T=void 0===w?Object(fl.g)():w,k=e.handleSubmitButtonClick,j=e.isMenuButtonEnabled,P=void 0!==j&&j,A=e.shouldOpenMenuOnEmptyInput,_=void 0!==A&&A,D=e.menuButtonTitle,L=void 0===D?Object(fl.f)():D,B=e.handleMenuButtonClick,R=e.handleOnOpenMenu,F=e.handleOnChatInputControlMount,N=e.handleOnChatInputControlUnmount,H=e.handleOnBlur,U=e.menuProps,V=e.microphoneProps,z=e.chatInputBannerProps,G=e.submitButtonFactory,W=Object(f.useRef)(),Q=Object(f.useRef)(),q=Object(f.useRef)(null);V&&!V.title&&(V.title=Object(fl.e)()),Object(f.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=W.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=W.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=W.current)||void 0===e?void 0:e.getImages()},setInputText:function(e){var t;null===(t=W.current)||void 0===t||t.setInputText(e),Object(o.c)()&&$(0==e.length)},updateInputText:function(e,t){var n;null===(n=W.current)||void 0===n||n.updateInputText(e,t)},getInputText:function(){var e;return null===(e=W.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=W.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){te(e)},getGhostText:function(){return ee()},setFocus:function(){var e;null===(e=W.current)||void 0===e||e.setFocus()},closeMenu:function(){P&&Y&&Z(!1)}}}));var K=Object(r.__read)(Object(f.useState)(!1),2),Y=K[0],Z=K[1],J=Object(r.__read)(Object(f.useState)(!0),2),X=J[0],$=J[1],ee=function(){var e;return null===(e=W.current)||void 0===e?void 0:e.getGhostText()},te=Object(f.useCallback)((function(e){var t;null===(t=W.current)||void 0===t||t.setGhostText(e)}),[]),ne=!1,re=!1,oe=function(e){var t,n;e.stopPropagation();var r=null===(t=W.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==fl.h&&(k(r),null===(n=W.current)||void 0===n||n.setInputText(fl.h),te(h))};Object(f.useEffect)((function(){te(h)}),[h,te]),m.a.useEffect((function(){var e;Q.current&&(null===(e=q.current)||void 0===e||e.setTarget(Q.current))}),[q,Q]);var ie=function(){var e=_c(),t=kc();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),ae=function(){var e=Dc(),t=jc();Object(o.b)()===o.a.IOS&&Object(M.k)(e,t);return e}(),se=Mc(),le=Lc(),ce=Object(f.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),ue=Object(f.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),de=Object(f.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),pe=Object(r.__read)(Object(f.useState)(ie),2),ge=pe[0],he=pe[1];Object(f.useEffect)((function(){for(var e in ie)ce.current[e]=Object(C.a)(ie[e],ae[e]);for(var e in ie)ue.current[e]=Object(C.a)(ie[e],se[e]);for(var e in ie)de.current[e]=Object(C.a)(ae[e],ie[e],le[e])}),[]),Object(f.useEffect)((function(){if(a)for(var e in ie)ce.current[e]=Object(C.a)(ie[e],a[e])}),[a]),Object(f.useEffect)((function(){he(i?ue.current:ce.current)}),[i,a]),Object(f.useEffect)((function(){(null==V?void 0:V.isMicrophoneListening)?he(de.current):he(ce.current)}),[null==V?void 0:V.isMicrophoneListening]);return m.a.createElement("div",null,m.a.createElement("div",{id:fl.a,className:ge.chatInput,title:p,tabIndex:u,onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i||document.activeElement===(null===(e=W.current)||void 0===e?void 0:e.getInputSpanElement())?[2]:_&&P&&(null===(t=W.current)||void 0===t?void 0:t.getInputText())==fl.h&&!Y?R?[4,R()]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return Z(!0),[3,4];case 3:Y&&Z(!1),r.label=4;case 4:return null===(n=W.current)||void 0===n||n.setFocus(),[2]}}))}))},onBlur:function(){var e;Object(o.c)()&&!Y&&(null===(e=W.current)||void 0===e?void 0:e.getInputText())===fl.h&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return H(),[2]}))}))}),100)},ref:Q},z&&m.a.createElement(Vl,Object(r.__assign)({},z)),m.a.createElement("div",{className:ge.chatInputContainer},m.a.createElement(nc,{ref:W,styleOverrideClassName:a?a.userInput:"",placeholderText:h,chatInputTabIndex:l,isDisabled:i,handleKeyDown:function(e){var t,n,r;ne="Process"===e.key,e.nativeEvent.isComposing||(re&&"Enter"===e.key?re=!1:y&&!y(e)||(Object(o.c)()&&("Backspace"===e.key?$((null===(t=W.current)||void 0===t?void 0:t.getInputText().length)<=1):$(!1)),"Enter"===e.key&&(e.preventDefault(),k(null===(n=W.current)||void 0===n?void 0:n.getInputText()),null===(r=W.current)||void 0===r||r.setInputText(fl.h),te(h))))},handleKeyUp:function(e){var t;O&&!O(e)||((null===(t=W.current)||void 0===t?void 0:t.getInputText())===fl.h?te(h):ee()===h&&te(fl.h))},handleOnPaste:function(e){var t;if(!E||E(e)){te(fl.h),e.preventDefault();var n=e.clipboardData.getData("Text"),r=n.length||0,o=null===(t=W.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(i.rangeCount){var a=i.toString(),s=o.length-a.length,l=n.substring(0,b-s);i.deleteFromDocument(),s+r>=b?i.getRangeAt(0).insertNode(document.createTextNode(l)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()}}},handleOnBeforeInput:function(e){x&&!x(e)||(Z(!1),te(fl.h))},handleOnInput:function(e){!I||I(e)},handleOnCompositionEnd:function(){ne||(re=!0)},handleOnChatInputControlMount:F,handleOnChatInputControlUnmount:N}),m.a.createElement("span",{"aria-hidden":!0},fl.q)),m.a.createElement(S,{style:ge.chatInputButtons},m.a.createElement("div",{className:ge.chatInputLeftButtons},P&&m.a.createElement(Ml,{title:L,isDisabled:i||0===(null===(n=null==U?void 0:U.sections)||void 0===n?void 0:n.length),isMenuOpen:Y,setMenuOpen:Z,handleClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return B&&B(),Y?(Z(!1),[3,4]):[3,1];case 1:return R?[4,R()]:[3,3];case 2:e.sent(),e.label=3;case 3:Z(!0),e.label=4;case 4:return[2]}}))}))},positioningRef:q,menuProps:U})),m.a.createElement("div",{className:ge.chatInputRightButtons},V&&m.a.createElement("span",{title:function(){switch(V.microphoneState){case zl.Enabled:return V.isMicrophoneListening?Object(fl.k)():Object(fl.m)();case zl.Disabled:return Object(fl.j)();case zl.Loading:return Object(fl.l)()}}()},m.a.createElement(Sc,{"aria-live":"assertive",isDisabled:i,microphoneButtonProps:V})),G?G({handleClick:oe,isDisabled:i,isInputEmpty:X,title:T}):m.a.createElement(Qc,{title:T,isDisabled:i,handleClick:oe,isInputEmpty:X})))))})),Kc=m.a.memo(qc),Yc=n(2803),Zc=n(284),Jc=n(1078),Xc=n(2153),$c=n(680),eu=n(550),tu=n(3569),nu=n(3447),ru=n(3399),ou=n(3357),iu=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return m.a.createElement(x.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},m.a.createElement(w.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=ou.e,n=ou.d,r=Object(A.a)(n,t),m.a.createElement(r,null))},onClick:a,disabled:i}))},au=Object(y.a)({inputBanner:Object(r.__assign)(Object(r.__assign)({minHeight:"32px"},W.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"}),inputBannerInInputV3:{minHeight:"32px",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomStyle:"none"}}),su=function(e){var t=au();return e?t.inputBannerInInputV3:t.inputBanner},lu=function(e){var t=e.chatInputBannerString,n=e.isInputV3Enabled,r=void 0!==n&&n;return m.a.createElement(on.a,{className:su(r)},m.a.createElement(tn.a,null,t))},cu=n(1447),uu={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",DIALOG:"dialog",TOOLTIP:"tooltip"},du=function(){return"undefined"!=typeof OfficeaicopilotStrings},pu=function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{augloopSession:t})},gu=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e?(Object(cu.b)(e),[4,Object(cu.a)()]):[2,null];case 1:return[2,t.sent().getSession()]}}))}))},hu=function(e,t,n,o,i){var a;void 0===o&&(o=!1),void 0===i&&(i=void 0);var s=null==n?void 0:n.current;if(!s)return"";var l=Object(r.__read)(function(e,t){var n=-1,r=t.find((function(t){var r=null==e?void 0:e.toLocaleLowerCase().indexOf(t().toLocaleLowerCase());return-1!==r&&(n=r,!0)}));return[r?r():"",n]}(e,t),2),c=l[0],u=l[1],d=Object(r.__read)(function(e,t,n){var r="",o="",i=e;return t.length>0&&-1!==n&&(r=n>0?e.slice(0,n):"",o=t,i=e.slice(n+t.length)),[r,o,i]}(e,c,u),3),p=d[0],g=d[1],h=d[2];if(o||c.length>0){if(s.innerText="",e.includes("{")&&e.includes("}"))a=Object(r.__read)(function(e){var t=e.match(/\{(.*?)\}/),n="",r="",o=e;if(t){var i=e.indexOf(t[0]);n=e.slice(0,i),r=t[1],o=e.slice(i+t[0].length)}return[n,r,o]}(e),3),p=a[0],g=a[1],h=a[2],0===c.length&&(c=g);else if(0===c.length)return void(s.innerText=e);!function(e,t,n,o,i){if(void 0===i&&(i=void 0),t.length>0){var a=document.createTextNode(t);e.appendChild(a)}var s=document.createElement("span"),l=document.createElement("span");l.style.backgroundColor=Q.a.colorNeutralBackground3,l.style.color=Q.a.colorNeutralForeground2,l.contentEditable="false",l.textContent=n,l.style.borderRadius=zu,l.style.padding=Gu,s.appendChild(l);var c=new MutationObserver((function(t,o){var a,l;try{for(var c=Object(r.__values)(t),u=c.next();!u.done;u=c.next())"childList"===u.value.type&&(Array.from(e.children).includes(s)||(i&&i(n,!1),o.disconnect()))}catch(e){a={error:e}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(a)throw a.error}}}));c.observe(e,{childList:!0}),e.appendChild(s),0===o.length&&(o=" ");var u=document.createTextNode(o);e.appendChild(u)}(s,p,g,h,i)}else s.innerText=e;return c},fu=function(){return du()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area"},mu=function(){return du()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},vu=function(){return du()?OfficeaicopilotStrings.SubmitButtonTitle:"Send"},bu=function(){return du()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own"},yu="",Cu="br",Ou="copilot-chat-input",Su=1e4,Eu=function(){return du()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},xu=" ",Iu=function(){return du()?OfficeaicopilotStrings.DefaultCIQButtonTitle:"Attach"},wu=function(){return du()?OfficeaicopilotStrings.DefaultGroundingButtonTitle:"Manage search and plugins"},Tu=function(){return du()?OfficeaicopilotStrings.GroundingSearchAndPlugins:"Search and plugins"},ku=function(){return du()?OfficeaicopilotStrings.PreviewFlagLabel:"Preview"},ju=function(){return du()?OfficeaicopilotStrings.GroundingPluginFlyoutInfo:"Plugins allow Copilot to reference apps on your behalf. Copilot may share some of your Microsoft 365 enterprise data with plugins you’ve turned on."},Pu=function(){return du()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoTooltip:"Microsoft 365 enterprise data includes Office applications, SharePoint sites, cloud files, communications, and more. All configured by your IT admin."},Au=function(){return du()?OfficeaicopilotStrings.AdminBlockedPluginInfoTooltipLabel:"The service required to use this plugin is turned off for your organization."},_u=function(){return du()?OfficeaicopilotStrings.WorkPluginLabel:"Microsoft 365 data"},Du=function(){return du()?OfficeaicopilotStrings.WebContentPluginLabel:"Web content"},Lu=function(){return du()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoLabel:"Info"},Mu=function(){return"Create a new presentation"},Bu=function(){return"Create the new presentation"},Ru=function(){return"Add a slide about"},Fu=function(){return"Add an agenda slide"},Nu=function(){return"Create a presentation"},Hu=function(){return"Organize the presentation"},Uu=function(){return"Organize this presentation"},Vu=function(){return"Add an image of"},zu="4px",Gu="0px 4px 4px 4px",Wu=n(890),Qu=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralForeground4,alignItems:"flex-start"},Ot.a.body1),{fontStyle:"normal"}),W.a.gap("1px")),{content:"attr(title)"}),qu={color:Q.a.colorNeutralForegroundDisabled,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},Ku=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Ot.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),W.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(r.__assign)({},W.a.outline(0))}),Yu={userInput:Object(r.__assign)(Object(r.__assign)({},Ku),{"&:focus":Object(r.__assign)({},W.a.outline(0)),"&:focus::after":Qu,"&::after":Qu})},Zu={userInput:Object(r.__assign)(Object(r.__assign)({},Ku),{"&:focus":Object(r.__assign)({},W.a.outline(0))})},Ju={userInput:{"&:focus::after":qu,"&::after":qu}},Xu=Object(y.a)(Zu),$u=Object(y.a)(Yu),ed=Object(y.a)(Ju),td=function(e){var t=Object(r.__read)(Object(f.useState)(!1),2),n=t[0],o=t[1];return m.a.createElement("div",{onMouseEnter:function(){o(!0)},onMouseLeave:function(){o(!1)},style:{position:"relative"}},m.a.createElement("button",{style:{position:"absolute",left:"40px",visibility:n?"visible":"hidden"},onClick:e.removeImageCallback},"X"),m.a.createElement("img",{src:e.imageDataUri,alt:"Visual part of the prompt",width:"50px"}))},nd=m.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,o=e.placeholderText,i=e.chatInputTabIndex,a=e.isDisabled,s=e.isHVCAppChatV2Enabled,l=e.hvcPromptStrings,c=e.onChatInputHVCPromptUpdated,u=e.handleKeyDown,d=e.handleKeyUp,p=e.handleOnPaste,g=e.handleOnBeforeInput,h=e.handleOnInput,v=e.handleOnCompositionEnd,b=e.handleOnFocusTextArea,y=e.handleOnChatInputControlMount,O=e.handleOnChatInputControlUnmount,S=Object(f.useRef)(),E=null!=l?l:[Mu,Bu,Ru,Fu,Nu,Hu,Uu,Vu];Object(f.useImperativeHandle)(t,(function(){return{setInputText:function(e,t){void 0===t&&(t=!1),I(e,t),x()},updateInputText:function(e,t){switch(t){case Wu.a.InsertAtCursor:w(e);break;case Wu.a.Replace:I(e)}},getInputText:function(){return T()},getInputSpanElement:function(){return S.current},setFocus:function(){k()},getGhostText:function(){var e,t;return null!==(t=null===(e=S.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;null===(t=S.current)||void 0===t||t.setAttribute("title",e),L(e===yu?j.current.userInput:A.current.userInput)},scrollToBottom:x,addImage:function(e){R([e])},removeImages:function(){R([])},getImages:function(){return B}}}));var x=function(){var e;null===(e=S.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},I=function(e,t){void 0===t&&(t=!1);var n=S.current;if(n)if(s&&e.length>0){var r=hu(e,E,S,t,c);c(r,!0)}else n.innerText=e},w=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1),x()}};var T=function(){var e,t,n=yu,r=S.current;return r&&(t=yu,(e=r).childNodes&&e.childNodes.length>0&&e.childNodes.forEach((function(e){e.tagName&&e.tagName.toLowerCase()===Cu?t+="\n":t+=e.textContent})),n=t),n},k=function(){if(!a){var e=S.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(f.useEffect)((function(){return y&&y(),function(){O&&O()}}),[]);var j=Object(f.useRef)(Xu()),P=Object(f.useRef)(ed()),A=Object(f.useRef)($u()),_=Object(r.__read)(Object(f.useState)(A.current.userInput),2),D=_[0],L=_[1];Object(f.useEffect)((function(){a&&L(Object(C.a)(A.current.userInput,P.current.userInput))}),[a]),Object(f.useEffect)((function(){n&&L(Object(C.a)(j.current.userInput,n))}),[n]);var M=Object(r.__read)(Object(f.useState)([]),2),B=M[0],R=M[1];return m.a.createElement(m.a.Fragment,null,B.map((function(e,t){return m.a.createElement(td,{imageDataUri:e,key:t,removeImageCallback:function(){B.splice(t,1),R(B)}})})),m.a.createElement("span",{ref:S,className:D,title:o,"aria-label":o,"aria-disabled":a,role:"textbox",tabIndex:i,contentEditable:!a,suppressContentEditableWarning:!a,onKeyDown:u,onKeyUp:d,onPaste:p,onBeforeInput:g,onInput:h,onCompositionEnd:v,onFocus:b}))})),rd=n(2793),od=n(3513),id=n(2421),ad=n(1618),sd=n(3445),ld=n(841),cd=n(1627),ud=n(2445),dd=Object(ld.a)({palette:Object(r.__assign)(Object(r.__assign)({},cd.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),pd=(Object(ld.a)({palette:Object(r.__assign)(Object(r.__assign)({},ud.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(){return xc}),gd=function(e){var t=e.themePalette,n=e.isDarkMode,o=e.dir,i=void 0===o?void 0:o,a=e.children,s=e.className,l=Object(r.__assign)(Object(r.__assign)({},dd.palette),t),c=Object(sd.a)(l),u=n?Object(id.a)(c):Object(ad.a)(c);return xc=u,f.createElement(h.a,{className:s,theme:u,dir:i},a)},hd=function(e,t){var n=Object(A.a)(t,e);return m.a.createElement(n,null)},fd=function(e){var t=e;return m.a.createElement(t,null)},md=n(682),vd=n(3595),bd=n(35),yd={popOver:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",maxHeight:"390px"},W.a.overflow("hidden","auto")),W.a.margin("right: 20")),{backgroundColor:Q.a.colorNeutralBackground1,paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"4px",":hover::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralForeground4},W.a.border("2px","solid",Q.a.colorNeutralBackground3)),W.a.borderRadius(Q.a.borderRadiusMedium)),"&::-webkit-scrollbar":{width:Q.a.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:Q.a.colorNeutralBackground5}}),menuItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1,maxWidth:"inherit"},W.a.padding("0px")),W.a.border("2px","solid","transparent")),W.a.borderRadius(Q.a.borderRadiusMedium)),(Ic={"> span":Object(r.__assign)({},W.a.overflow("hidden"))},Ic["&:focus-within"]=Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Hover},W.a.border("2px","solid",Q.a.colorNeutralBackground1Hover)),Ic[bd.m]={":hover":Object(r.__assign)({},W.a.border("2px","dashed","Highlight"))},Ic)),descriptionSection:{color:Q.a.colorNeutralForeground2Link,paddingBottom:"6px"},installedSection:Object(r.__assign)(Object(r.__assign)({display:"flex",paddingBottom:"10px",flexDirection:"column"},W.a.gap("2px")),{alignSelf:"stretch"}),description:{paddingBottom:"6px",fontFamily:"Segoe UI",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:Q.a.colorNeutralForeground2Link},titleContainer:Object(r.__assign)({display:"flex",flexDirection:"row"},W.a.gap("8px")),title:Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start"},W.a.gap("10px")),{alignSelf:"stretch"}),previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:Object(r.__assign)(Object(r.__assign)({height:"16px",color:Q.a.colorNeutralForeground2,backgroundColor:Q.a.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px"},W.a.borderRadius("8px")),{display:"flex",flexDirection:"row",alignSelf:"stretch",fontFamily:"Segoe UI",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"}),shimmerComponent:Object(r.__assign)({},W.a.padding("6px","6px","6px","0px")),labelInfo:(wc={backgroundColor:Q.a.colorNeutralBackground1},wc["&:focus-within"]=Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Hover},W.a.border("2px","solid",Q.a.colorNeutralBackground1Hover)),W.a.borderRadius(Q.a.borderRadiusMedium)),wc)};var Cd,Od=function(){var e,t,n,r,o,i,a,s,l,c,u,d={popOver:null!==(e=yd.popOver)&&void 0!==e?e:{},titleContainer:null!==(t=yd.titleContainer)&&void 0!==t?t:{},descriptionSection:null!==(n=yd.descriptionSection)&&void 0!==n?n:{},title:null!==(r=yd.title)&&void 0!==r?r:{},previewTitleContainer:null!==(o=yd.previewTitleContainer)&&void 0!==o?o:{},previewTitle:null!==(i=yd.previewTitle)&&void 0!==i?i:{},menuItem:null!==(a=yd.menuItem)&&void 0!==a?a:{},installedSection:null!==(s=yd.installedSection)&&void 0!==s?s:{},description:null!==(l=yd.description)&&void 0!==l?l:{},shimmerComponent:null!==(c=yd.shimmerComponent)&&void 0!==c?c:{},labelInfo:null!==(u=yd.labelInfo)&&void 0!==u?u:{}};return Object(y.a)(d)}(),Sd={shimmer:Q.a.colorNeutralStencil1,shimmerWave:Q.a.colorNeutralStencil2,background:Q.a.colorNeutralBackground1},Ed=n(1014),xd={tooltipText:{width:"216px",fontSize:"12px"},tooltip:{alignSelf:"center","> button":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:"none",minWidth:"0px",maxHeight:"18px",maxWidth:"18px"},W.a.padding("4px")),W.a.borderStyle("none")),W.a.borderRadius("18px"))},infoButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:"inherit",boxShadow:"none",lineHeight:"6px"},W.a.border("2px","solid","transparent")),W.a.borderColor(Q.a.borderRadiusCircular)),(Cd={"> span":{maxHeight:"18px",maxWidth:"18px"}},Cd["&:focus-within"]=Object(r.__assign)({},W.a.border("2px","solid",Q.a.colorNeutralBackground1Hover)),Cd[":hover"]={backgroundColor:Q.a.colorNeutralForeground2BrandHover,"> span > svg > path":{fill:Q.a.colorNeutralBackground2}},Cd[bd.m]={"> span > svg > path":{fill:"ButtonText"},":hover":{backgroundColor:"Highlight"}},Cd))};var Id=function(){var e,t,n,r={tooltipText:null!==(e=xd.tooltipText)&&void 0!==e?e:{},tooltip:null!==(t=xd.tooltip)&&void 0!==t?t:{},infoButton:null!==(n=xd.infoButton)&&void 0!==n?n:{}};return Object(y.a)(r)}();function wd(e){var t=e.infoMessage,n=Id();return f.createElement("span",{className:n.tooltip,role:uu.TOOLTIP},f.createElement(x.a,{content:t,relationship:"description"},f.createElement(w.a,{icon:Ed.c,size:"small",className:n.infoButton,"aria-label":Lu()})))}var Td=n(3604),kd={appIcon:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"20px",height:"fit-content",float:"left"},W.a.padding("4px","4px","4px","4px")),W.a.border("2px","solid",Q.a.colorNeutralBackground3Pressed)),W.a.borderRadius(Q.a.borderRadiusMedium)),appNameContainer:Object(r.__assign)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto"},W.a.overflow("hidden")),appNameTextContainer:Object(r.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto"},W.a.overflow("hidden")),appName:Object(r.__assign)(Object(r.__assign)({width:"auto",height:"auto",lineHeight:"36px",paddingLeft:"2px",paddingRight:"2px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:Q.a.colorNeutralForeground2Link,whiteSpace:"nowrap"},W.a.overflow("hidden")),{textOverflow:"ellipsis"}),appInfo:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.gap("4px")),{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),W.a.overflow("hidden")),{alignContent:"center",justifyItems:"left",alignItems:"center"}),blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",maxHeight:"100px"},W.a.gap("4px")),{justifyContent:"space-between","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right",height:"36px","@media (forced-colors: active)":{forcedColorAdjust:"none"}},spinner:{paddingTop:"8px",paddingInlineEnd:"20px"}};var jd=function(){var e,t,n,r,o,i,a,s,l,c,u={appIcon:null!==(e=kd.appIcon)&&void 0!==e?e:{},appNameContainer:null!==(t=kd.appNameContainer)&&void 0!==t?t:{},appNameTextContainer:null!==(n=kd.appNameTextContainer)&&void 0!==n?n:{},appName:null!==(r=kd.appName)&&void 0!==r?r:{},appInfo:null!==(o=kd.appInfo)&&void 0!==o?o:{},blocked:null!==(i=kd.blocked)&&void 0!==i?i:{},infoIcon:null!==(a=kd.infoIcon)&&void 0!==a?a:{},pluginItem:null!==(s=kd.pluginItem)&&void 0!==s?s:{},toggleControl:null!==(l=kd.toggleControl)&&void 0!==l?l:{},spinner:null!==(c=kd.spinner)&&void 0!==c?c:{}};return Object(y.a)(u)}();function Pd(e){var t=e.title,n=e.plugin,o=jd(),i=Object(r.__read)(f.useState(n.state==eu.a.Enabled),2),a=i[0],s=i[1],l=f.useCallback((function(e,t){c(t.checked)}),[]);f.useEffect((function(){s(n.state==eu.a.Enabled)}),[n.state]);var c=function(e){n.onToggle(e),s(e)},u=n.state===eu.a.Blocked?o.blocked:void 0,d=f.useMemo((function(){var e=n.state==eu.a.Blocked;return f.createElement("div",{className:o.toggleControl},n.state===eu.a.Loading&&f.createElement(Td.a,{className:o.spinner}),n.state!==eu.a.Loading&&f.createElement(te.a,{disabled:!!e,checked:a,onChange:l,tabIndex:-1,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c(!(n.state==eu.a.Enabled)))},role:"switch"}))}),[c]),p=n.state===eu.a.Blocked?f.createElement(wd,{infoMessage:Au()}):null,g=o.appName;g=Object(C.a)(g,u);var h,m=(h=n.id)===$c.a.Web?Object(Ed.e)(o.appIcon):h===$c.a.Work?Object(Ed.d)(o.appIcon):void 0,v=f.createElement("div",{className:o.appInfo},m,f.createElement("div",{className:o.appNameTextContainer},f.createElement(Ce.a,{className:g},t),p));return f.createElement("div",{className:o.pluginItem},v,d)}function Ad(e){var t=e.plugins,n=e.isPluginDataLoaded,o=Od(),i=f.useCallback((function(e){if(a.current.push(e),t.length===a.current.length)for(var n=O,r=function(e){if(!n[e].props.disabled)return requestAnimationFrame((function(){a.current[e].focus()})),"break"},o=0;o<n.length;o++){if("break"===r(o))break}}),[]),a=f.useRef([]),s=o.title,l=o.previewTitle,c=o.descriptionSection,u=o.description,d=f.createElement(wd,{infoMessage:Pu()}),p=f.createElement("div",{className:o.previewTitleContainer},f.createElement(Ce.a,{className:l},ku())),g=f.createElement("div",{className:c},f.createElement("div",{className:o.titleContainer},f.createElement(Ce.a,{role:uu.HEADING,"aria-level":1,"aria-label":Tu(),className:s},Tu()),e.isPreview&&p),f.createElement(Ce.a,{className:u},ju()),d),m=[{type:md.a.circle,height:22.7},{type:md.a.gap,width:10},{type:md.a.line,height:10,width:160},{type:md.a.gap,width:80},{type:md.a.line,height:10}],v=f.memo((function(){return f.createElement(vd.a,{className:o.shimmerComponent,shimmerElements:m,shimmerColors:Sd})}));v.displayName="ShimmerComponent";var b,y=function(e){var t,n=e.target,r=null===(t=e.currentTarget)||void 0===t?void 0:t.querySelector('[role="switch"]');n!==r&&(e.preventDefault(),null==r||r.click(),null==n||n.focus())},C=function(e){"Enter"!==e.key&&" "!==e.key||y(e)},O=f.useMemo((function(){return t.map((function(e,t){var n,r=e.state===eu.a.Blocked,a=(n=e.id)===$c.a.Work?_u():n===$c.a.Web?Du():void 0;return f.createElement(P.a,{role:"button",key:t,persistOnClick:!0,className:o.menuItem,tabIndex:r?-1:0,disabled:r,onKeyDown:C,onClick:y,"aria-label":a,"aria-pressed":e.state===eu.a.Enabled,ref:i},f.createElement(Pd,{title:a,plugin:e,key:e.id}))}))}),[t]),S=f.createElement("div",{className:o.installedSection},n?O:(b=t.length,f.createElement(f.Fragment,null,Object(r.__spreadArray)([],Object(r.__read)(Array(b)),!1).map((function(e,t){return f.createElement(v,{key:t})})))));return f.createElement(h.a,null,f.createElement(k.a,{role:uu.DIALOG,className:o.popOver},f.createElement(j.a,null,g,S)))}var _d,Dd,Ld,Md,Bd={color:Q.a.colorBrandForeground1},Rd=Object(y.a)({menuPopOver:Object(r.__assign)(Object(r.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",overflowX:"hidden",boxSizing:"border-box"},W.a.margin("right: 20")),{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",overflowY:"hidden"})}),Fd=function(e){var t=e.title,n=e.isDisabled,o=e.isMenuOpen,i=void 0!==o&&o,a=e.setMenuOpen,s=e.targetRef,l=e.shouldBlockGroundingButtonClick,c=void 0===l?function(){return!1}:l,u=e.groundingButtonPluginProps,d=Object(r.__read)(Object(f.useState)(i),2),p=d[0],g=d[1],v=m.a.useRef(null),b=Object(r.__read)(Object(f.useState)(!1),2),y=b[0],C=b[1],O=m.a.useRef(null),S=Rd();m.a.useEffect((function(){var e;s&&(null===(e=v.current)||void 0===e||e.setTarget(s))}),[s,v]),Object(f.useEffect)((function(){g(i)}),[i]),Object(f.useEffect)((function(){a(p)}),[p,a]);var T=m.a.useCallback((function(e,t){var n;c&&c()||(null===(n=u.onGroundingButtonClick)||void 0===n||n.call(u),a(null==t?void 0:t.open))}),[a,c]);Object(f.useEffect)((function(){var e;C(u.pluginBlockedInfo&&0===(null===(e=u.plugins)||void 0===e?void 0:e.filter((function(e){return e.state===eu.a.Shimmer})).length))}),[u]);var k=m.a.useMemo((function(){var e;if(!u.plugins)return[];if(!u.pluginBlockedInfo){var t=[];return u.plugins.forEach((function(e){var n=Object(r.__assign)(Object(r.__assign)({},e),{state:eu.a.Shimmer});t.push(n)})),t}if(!(null===(e=u.pluginBlockedInfo)||void 0===e?void 0:e.length))return u.plugins;var n=[];return u.plugins.forEach((function(e){var t=Object(r.__assign)(Object(r.__assign)({},e),{state:u.pluginBlockedInfo.includes(e.id)?eu.a.Blocked:e.state});n.push(t)})),n}),[u]),j=m.a.createElement(x.a,{content:t,relationship:"label",positioning:"above",withArrow:!0},m.a.createElement(w.a,{appearance:"transparent",disabled:n,icon:p?{children:fd(Qe.d),style:Bd}:{children:hd(Qe.e,Qe.d)},"aria-label":t}));if(u.copilotPluginFlyoutProps){var P={target:s,positioningRef:O,align:"center",position:"above"};return m.a.createElement(so.a,{open:p,onOpenChange:T,positioning:P,trapFocus:!0},m.a.createElement(lo.a,null,j),m.a.createElement(h.a,null,m.a.createElement(co.a,{className:S.menuPopOver},m.a.createElement(od.a,Object(r.__assign)({},u.copilotPluginFlyoutProps,{positioningRef:O,fluentTheme:pd(),mountTooltipToBody:!0})))))}var A={target:s,align:"center",position:"above"};return m.a.createElement(E.a,{open:p,onOpenChange:T,positioning:A},m.a.createElement(I.a,{disableButtonEnhancement:!0},j),m.a.createElement(Ad,{isPluginDataLoaded:y,plugins:k,isPreview:!0}))},Nd=n(836),Hd=n(393),Ud=n(195),Vd=n(1137),zd=n(2467),Gd={selectors:(_d={},_d[bd.m]={color:"ButtonText"},_d)},Wd=Object(Hd.c)((function(e,t,n,o){return Object(bd.db)({root:{direction:"inherit",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},container:{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",minWidth:"-webkit-fill-available",alignItems:"center",backgroundColor:Q.a.colorNeutralBackground4,borderBottom:n?void 0:"solid",borderWidth:"1px",borderColor:Q.a.colorNeutralStroke1,margin:n?void 0:"-4px",borderTopLeftRadius:o?void 0:"7px",borderTopRightRadius:o?void 0:"7px",borderLeftStyle:n?"solid":void 0,borderRightStyle:n?"solid":void 0,borderTopStyle:n||o?"solid":void 0},label:Object(r.__assign)({fontWeight:400,fontSize:bd.k.size12,lineHeight:"16px",textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:t?Q.a.colorNeutralForegroundDisabled:Q.a.colorNeutralForeground1,paddingInlineStart:e?void 0:"10px"},Gd),iconContainer:{display:"flex"},icon:{paddingInlineStart:"10px",paddingInlineEnd:"8px"},downChevron:Object(r.__assign)({fill:t?Q.a.colorNeutralForegroundDisabled:Q.a.colorNeutralForeground1,color:t?Q.a.colorNeutralForegroundDisabled:Q.a.colorNeutralForeground1},Gd)})})),Qd=Object(Hd.c)((function(e){return{root:{background:"transparent",border:"none",fontSize:bd.k.size12,padding:0},rootHovered:{border:"none",backgroundColor:"transparent"},rootPressed:{border:"none",backgroundColor:"transparent"},rootDisabled:{border:"none",backgroundColor:"transparent",fontWeight:400},textContainer:{color:e?Q.a.colorNeutralForegroundDisabled:Q.a.colorNeutralForeground1,fontWeight:400,fontSize:bd.k.size12,lineHeight:"16px",textAlign:"start",textDecoration:"underline",padding:"2px 0px 2px 0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},menuIcon:{margin:0,color:e?Q.a.colorNeutralForegroundDisabled:Q.a.colorNeutralForeground1,fontSize:"8px",paddingTop:"3px"},label:{fontWeight:"normal"}}})),qd=((Dd={})[bd.m]=Object(r.__assign)({backgroundColor:"Highlight",color:"HighlightText",outlineColor:"ButtonText"},Object(bd.S)()),{selectors:(Ld={},Ld[bd.m]=Object(r.__assign)({backgroundColor:"ButtonFace",color:"ButtonText",outlineColor:"inherit"},Object(bd.S)()),Ld)}),Kd={selectors:(Md={},Md[bd.m]=Object(r.__assign)({backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed"},Object(bd.S)()),Md)},Yd=Object(Hd.c)((function(){return{root:{padding:"6px",backgroundColor:"transparent",minWidth:"unset"},divider:{height:"1px"}}})),Zd=Object(Hd.c)((function(){var e;return{root:Object(r.__assign)({border:"none",minWidth:"-webkit-fill-available",minHeight:"48px",margin:"1px",padding:"0px",alignItems:"flex-start",fontWeight:400,backgroundColor:Q.a.colorNeutralBackground1,color:Q.a.colorNeutralForeground1,borderColor:Q.a.colorNeutralStroke1,borderRadius:"6px"},qd),rootHovered:Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Hover,color:Q.a.colorNeutralForeground1Hover},Kd),rootPressed:Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1Pressed,color:Q.a.colorNeutralForeground1Pressed},Kd),flexContainer:(e={},e[bd.m]=Object(r.__assign)({color:"HighlightText",foreground:"HighlightText",":hover label, :hover svg":{color:"HighlightText",fill:"HighlightText"}},Object(bd.S)()),e)}})),Jd=Object(Hd.c)((function(){return Object(bd.db)({root:{direction:"inherit",borderRadius:"7px",backgroundColor:Q.a.colorNeutralBackground1},buttonContainer:{paddingLeft:"8px",paddingRight:"8px",width:"100%",alignItems:"center"},icon:{alignSelf:"center",padding:"2px",alignItems:"center",lineHeight:24,color:Q.a.colorNeutralForeground1,fill:Q.a.colorNeutralForeground1},container:{paddingInlineStart:"8px",alignItems:"flex-start",alignSelf:"center",display:"inline-block"},primaryLabel:Object(r.__assign)(Object(r.__assign)({textAlign:"start",fontSize:bd.k.size14,fontWeight:400,lineHeight:"14px"},W.a.padding("0px")),{color:Q.a.colorNeutralForeground1}),secondaryLabel:Object(r.__assign)(Object(r.__assign)({textAlign:"start",fontSize:bd.k.size10,fontWeight:400,lineHeight:"14px"},W.a.padding("0px")),{color:Q.a.colorNeutralForeground2Link})})})),Xd=function(e,t){var n=e.key+"_desc";return f.createElement(h.a,{className:e.root},f.createElement(Vd.a,{onClick:function(n,r){e.onClick(),t(n,r)},styles:Zd(),role:"menuitem"},f.createElement(tr.a,{horizontal:!0,className:e.buttonContainerClass},Object($c.b)(e.iconClass)[e.iconId],f.createElement(tr.a,{className:e.containerClass},f.createElement(Nd.a,{className:e.primaryClass,"aria-describedby":n},e.text),f.createElement(Nd.a,{className:e.secondaryTextClass,id:n},e.secondaryText)))))},$d=Object(Hd.c)((function(e,t,n,r){var o,i=t.map((function(e){return function(e,t){var n=Jd();return{key:e.primary,text:e.primary,secondaryText:e.secondary,iconId:e.id,root:n.root,containerClass:n.container,buttonContainerClass:n.buttonContainer,primaryClass:n.primaryLabel,secondaryTextClass:n.secondaryLabel,iconClass:n.icon,onClick:function(n){t(e,n)},onRender:Xd}}(e,n)}));return{target:e,alignTargetEdge:!0,isBeakVisible:!1,gapSpace:4,directionalHint:Ud.a.topCenter,items:i,styles:Yd,focusZoneProps:$c.c,calloutProps:(o=null==e?void 0:e.offsetWidth,{setInitialFocus:!0,styles:{root:{width:o?o+16:364,borderRadius:"8px"},calloutMain:{backgroundColor:pd().colorNeutralBackground1,borderRadius:"8px"}}}),onDismiss:r}})),ep=function(e){var t=Object(r.__read)(f.useState(e.sourcesData[0]),2),n=t[0],o=t[1],i=Object(r.__read)(f.useState(!1),2),a=i[0],s=i[1],l=function(){s(!0)},c=function(t){s(!1),e.onMenuDismiss&&e.onMenuDismiss(t),window.requestAnimationFrame((function(){var e;return null===(e=d.querySelector("button[aria-haspopup]"))||void 0===e?void 0:e.focus()}))},u=Object(r.__read)(f.useState(void 0),2),d=u[0],p=u[1],g=Wd(!!e.infoTip,e.isDisabled,e.isChatInputV3Enabled,e.isChatInputBannerVisible);return f.createElement(h.a,{className:g.root},f.createElement("div",{className:g.container,ref:function(e){e&&p(e)}},e.infoTip&&f.createElement("div",{className:g.icon},f.createElement(wd,{infoMessage:e.infoTip})),f.createElement(Nd.a,{className:g.label},e.sourcePrefix),f.createElement(Vd.a,{text:n.primary.toLocaleLowerCase(),styles:Qd(e.isDisabled),onClick:l,disabled:e.isDisabled,"aria-label":e.sourcePrefix+n.primary,type:"button","aria-haspopup":"true"}),f.createElement(Ct.k,{className:g.downChevron,"aria-label":e.infoTip,cursor:"pointer",onClick:e.isDisabled?void 0:l}),a&&d&&f.createElement(zd.a,Object(r.__assign)({},$d(d,e.sourcesData,(function(t,r){t.id!=n.id&&(o(t),e.onSelection&&e.onSelection(t)),c(r)}),c)))))},tp=Object(y.a)({activeIcon:{color:Q.a.colorBrandForeground1},menuList:{minWidth:"100%",whiteSpace:"nowrap"},highlightedText:{color:Q.a.colorBrandForeground1},greyedText:{color:Q.a.colorNeutralForeground4},menuItem:{paddingLeft:"10px",paddingBottom:"8px",paddingTop:"8px",paddingRight:"10px",maxWidth:"none"},menuBackButtonContainer:{display:"flex",alignItems:"center","&:hover":{color:Q.a.colorNeutralForeground1}},menuBackButton:{textAlign:"left",paddingLeft:0},menuBackButtonText:{whiteSpace:"nowrap",fontWeight:"600",fontSize:"12px",paddingLeft:"8px"}}),np=function(e){e.title;var t,n=e.isDisabled,o=e.isMenuOpen,i=void 0!==o&&o,a=e.setMenuOpen,s=e.positioningRef,l=e.promptGuideMenuProps,c=tp(),u=Object(r.__read)(Object(f.useState)(""),2),d=u[0],p=u[1],g=Object(r.__read)(Object(f.useState)(l.promptGuideMenuData),2),h=g[0],v=g[1],b=Object(f.useRef)(""===d?h:null===(t=h.children)||void 0===t?void 0:t.find((function(e){return e.text===d})));Object(f.useEffect)((function(){v(l.promptGuideMenuData)}),[l.promptGuideMenuData]),Object(f.useEffect)((function(){var e;b.current=""===d?h:null===(e=h.children)||void 0===e?void 0:e.find((function(e){return e.text===d}))}),[h]);var y=Object(r.__read)(Object(f.useState)(i),2),C=y[0],O=y[1];Object(f.useEffect)((function(){O(i)}),[i]),Object(f.useEffect)((function(){a(C)}),[C,a]);var S=m.a.useCallback((function(e,t){(null==t?void 0:t.open)&&l.shouldBlockPromptGuideLaunch&&l.shouldBlockPromptGuideLaunch()||(O(null==t?void 0:t.open),(null==t?void 0:t.open)&&l.handleOnClickPromptGuideMenuButtonTelemetry(),p(""),b.current=h)}),[p,O,h,l.shouldBlockPromptGuideLaunch]),T=Object(f.useCallback)((function(e){var t,n;p(e),null===(t=s.current)||void 0===t||t.updatePosition(),b.current=""===e?h:null===(n=h.children)||void 0===n?void 0:n.find((function(t){return t.text===e}))}),[p,h]),j=Object(f.useRef)(null);return Object(f.useEffect)((function(){var e=document.getElementById(Ou);if(e){var t=new ResizeObserver((function(){var t,n=e.offsetWidth;if(j.current){var r={width:"".concat(n,"px"),maxWidth:"none",minHeight:"100px"};Object.assign(j.current.style,r)}null===(t=s.current)||void 0===t||t.updatePosition()}));return t.observe(e),function(){t.unobserve(e)}}}),[j,C,s]),m.a.createElement(E.a,{open:C,onOpenChange:S,persistOnItemClick:!0,positioning:{positioningRef:s}},m.a.createElement(I.a,{disableButtonEnhancement:!0},m.a.createElement(x.a,{content:du()?OfficeaicopilotStrings.DefaultMenuButtonTitle:"View prompts",relationship:"label",positioning:"above",withArrow:!0},m.a.createElement(w.a,{appearance:"transparent",disabled:n,icon:C?{children:fd(ou.j),className:c.activeIcon}:{children:hd(ou.k,ou.j)},"aria-label":C?"Close view prompts":"Open view prompts",id:"".concat("ViewPromptsID")}))),m.a.createElement(k.a,{ref:j},m.a.createElement(rp,{dataNode:b.current,updatePopoverOpen:O,updateDataNode:T,menuProps:l})))},rp=function(e){var t,n=e.dataNode,o=e.updatePopoverOpen,i=e.updateDataNode,a=e.menuProps,s=tp(),l=Object(r.__read)(m.a.useState(a),1)[0],c="Root"===(null==n?void 0:n.nodeType),u=m.a.useCallback((function(){i("")}),[i]),d=Object(f.useRef)(null),p=Object(f.useRef)(null);if(Object(f.useEffect)((function(){var e=c?p.current:d.current;e&&e.focus()}),[c]),!n)return m.a.createElement(m.a.Fragment,null);var g=c?{}:{paddingLeft:0},h=null==l?void 0:l.copilotLabProps;return m.a.createElement(j.a,{className:s.menuList},m.a.createElement(pl.a,null,m.a.createElement(hl.a,{style:g},c?m.a.createElement(Ce.a,{size:200,weight:"medium"},n.text):m.a.createElement("div",{className:s.menuBackButtonContainer},m.a.createElement(w.a,{ref:d,className:s.menuBackButton,appearance:"transparent",onClick:u,icon:m.a.createElement(Ct.r,null),"aria-label":"Back"}),m.a.createElement("div",{className:s.menuBackButtonText},n.text))),null===(t=n.children)||void 0===t?void 0:t.map((function(e,t){return m.a.createElement(op,{key:t,ref:0===t?p:void 0,dataNode:e,updatePopoverOpen:o,updateDataNode:i,menuProps:l})}))),(null==h?void 0:h.copilotLabMenuItemText)&&(c||"Category"===(null==n?void 0:n.nodeType))&&m.a.createElement(m.a.Fragment,null,m.a.createElement(gl.a,null),m.a.createElement(P.a,{className:s.menuItem,icon:h.iconRegular?h.iconHover?{children:hd(h.iconRegular,h.iconHover)}:{children:fd(h.iconRegular)}:null,onClick:function(e){e.stopPropagation(),o(!1),(null==h?void 0:h.handleOnClickCopilotLab)&&h.handleOnClickCopilotLab("Category"===n.nodeType?n.promptCategory:void 0)}},du()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts")))},op=Object(f.forwardRef)((function(e,t){var n=e.dataNode,r=e.updatePopoverOpen,o=e.updateDataNode,i=e.menuProps,a=tp(),s=n.text,l=void 0===s?"":s,c=n.data,u=n.iconHover,d=n.iconRegular,p=n.children,g=((null==p?void 0:p.length)||0)>0,h=function(e){var t=[],n=[],r=[],o=e.lastIndexOf(")"),i=e.lastIndexOf("(",o),a=e.lastIndexOf("]"),s=e.lastIndexOf("[",a);return o>i&&i>=0?(t.push(e.slice(0,i),e.slice(i,o+1),e.slice(o+1)),n.push(!1,!0,!1),r.push(!1,!1,!1)):a>s&&s>=0?(t.push(e.slice(0,s),e.slice(s,a+1),e.slice(a+1)),n.push(!1,!0,!1),r.push(!1,!0,!1)):(t.push(e),n.push(!1),r.push(!1)),{chunks:t,shouldHighlight:n,shouldGrey:r}}(l),f=h.chunks,v=h.shouldHighlight,b=h.shouldGrey,y=function(e,t,n){i.handleOnClickStarterPromptMenuItem&&i.handleOnClickStarterPromptMenuItem(e,t,n)},C=m.a.useCallback((function(){if(!p)return r(!1),void y(l,!0,null==c?void 0:c.ciqEntity);o(l||""),y(l,!1,null==c?void 0:c.ciqEntity)}),[c,p,r,o,l]);return m.a.createElement(P.a,{ref:t,icon:d?u?{children:hd(d,u)}:{children:fd(d)}:null,hasSubmenu:g,disabled:n.isDisabled,className:a.menuItem,"aria-label":l+(g?", sub menu":""),onClick:C},m.a.createElement("span",{style:{whiteSpace:"normal"}},f.map((function(e,t){return v[t]&&!n.isDisabled?m.a.createElement("span",{key:t,className:b[t]?a.greyedText:a.highlightedText},e):m.a.createElement(m.a.Fragment,{key:t},e)}))))}));op.displayName="ViewPromptsMenuItem";var ip,ap,sp,lp,cp=Object(y.a)({root:{backgroundColor:"transparent"}}),up=Object(y.a)({root:Object(r.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:Q.a.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},W.a.padding("16px"))}),dp=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.border("1px solid")),W.a.borderColor("transparent")),W.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),pp=Object(y.a)({root:{backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1,"&:hover":{backgroundColor:"".concat(Q.a.colorBrandForeground1," !important")}}}),gp=Object(y.a)({root:{backgroundColor:Q.a.colorNeutralBackground1,color:Q.a.colorStrokeFocus2,"&:hover":Object(r.__assign)(Object(r.__assign)({},W.a.borderColor("".concat(Q.a.colorBrandForeground1))),{backgroundColor:"".concat(Q.a.colorNeutralBackground1," !important")})}}),hp=Object(y.a)({root:{color:Q.a.colorBrandForeground1,"&:hover":{color:Q.a.colorBrandForeground1},fontSize:"12px"}}),fp=Object(y.a)({root:{height:"63px",bottom:"12px"}}),mp=Object(y.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),vp=Object(y.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:Q.a.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),bp=Object(y.a)({root:{fontWeight:"bold",color:Q.a.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),yp=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(C.a)(dp().root,pp().root),c=Object(C.a)(dp().root,gp().root),u=vp().root,d=Object(C.a)(u,bp().root),p=hp().root,g=fp().root,v=Object(f.useRef)(null);return Object(f.useEffect)((function(){var e;t&&(null===(e=v.current)||void 0===e||e.focus())}),[t]),m.a.createElement(h.a,{className:cp().root},m.a.createElement(de.a,{modalType:"modal",open:t},m.a.createElement(pe.a,{className:up().root,tabIndex:0},m.a.createElement(ge.a,null,m.a.createElement(he.a,{className:d},n),m.a.createElement(me.a,null,o&&m.a.createElement(V.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),m.a.createElement(T.a,{className:u},r),i&&m.a.createElement(ht.a,{inline:!0,className:p,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},du()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),m.a.createElement(Qt.a,{className:mp().root},m.a.createElement(fe.a,{disableButtonEnhancement:!0},m.a.createElement(w.a,{ref:v,className:c,appearance:"secondary",onClick:s},du()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),m.a.createElement(w.a,{className:l,appearance:"primary",onClick:a},du()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(ip||(ip={}));var Cp,Op=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},W.a.borderRadius("8px")),W.a.borderColor(Q.a.colorNeutralBackground1)),(ap={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},ap["&:hover .".concat(St.a.icon)]={color:Q.a.colorBrandForeground1},ap["&:hover:active .".concat(St.a.icon)]={color:Q.a.colorBrandForeground1},ap.display="flow",ap))}),Sp=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},W.a.borderRadius("50%")),(sp={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Q.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Q.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Q.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},sp["&.".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},sp["&:hover .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},sp["&:active .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},sp["&:hover:active .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},sp["&:hover"]={backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},sp["&:hover:active"]={backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},sp["@media (forced-colors: active)"]={forcedColorAdjust:"none"},sp))}),Ep=Object(y.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),xp=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground3},W.a.borderRadius("50%")),{color:Q.a.colorBrandForeground1}),loader:Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralBackground1},W.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Q.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Ip=Object(y.a)({root:(lp={},lp["&:hover .".concat(St.a.icon)]={color:Q.a.colorNeutralForegroundDisabled},lp["&:hover:active .".concat(St.a.icon)]={color:"".concat(Q.a.colorNeutralForegroundDisabled," !important")},lp)}),wp=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,o=Object(r.__read)(Object(f.useState)(!1),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(!1),2),l=s[0],c=s[1];Object(f.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(v.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(f.useEffect)((function(){n.microphoneState===ip.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===ip.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(f.useEffect)((function(){t?g(b.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(f.useRef)(Op()),d=Object(r.__read)(Object(f.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(f.useRef)(Object(C.a)(u.current.root,xp().root)),v=Object(f.useRef)(Object(C.a)(u.current.root,Sp().root)),b=Object(f.useRef)(Object(C.a)(u.current.root,Ip().root)),y=m.a.createElement(w.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case ip.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case ip.Disabled:case ip.Uninitialized:return"Microphone Disabled";case ip.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?m.a.createElement(rc.a,{title:"Mic-Filled"}):m.a.createElement(rc.b,{title:"Mic-Regular"}),onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return m.a.createElement("div",{className:Ep().root},n.isTooltipDisabled?y:m.a.createElement(x.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},y),i&&m.a.createElement("div",{className:xp().loader}),m.a.createElement(yp,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},Tp=n(892),kp=n(2800),jp=n(1466),Pp=n(2821),Ap=n(2822);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(Cp||(Cp={}));var _p,Dp,Lp,Mp,Bp=Cp.web,Rp=function(){return Bp===Cp.IOS},Fp=function(){function e(e,t){this.entityPluginRef=e,this.controlRef=t}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,o,i){var a,s=e.suggestion;s&&(null===(a=this.entityPluginRef.current)||void 0===a||a.insertChatInputEntity({text:s.text,data:s}))},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n,r=null===(t=this.controlRef.current)||void 0===t?void 0:t.getInputText().trim();if(r){var o=(null===(n=this.entityPluginRef.current)||void 0===n?void 0:n.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.url)})).map((function(e){var t=r.indexOf(e.text);return{type:"URL",range:[t,t+e.text.length-1],value:e.data.url}}));if(!(o.length<=0))return o}},e.prototype.generateQueryAnnotations=function(e){var t,n=(null===(t=this.entityPluginRef.current)||void 0===t?void 0:t.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.queryAnnotation)})).map((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.queryAnnotation}));if(!(n.length<=0))return n},e.prototype.setHVCAppChatV2Enabled=function(e){},e}(),Np=n(240),Hp=n(53),Up=n(2819),Vp=n(2820),zp=function(e){var t=Object(r.__read)(Object(Np.useLexicalComposerContext)(),1)[0],n=e.ciqPlaceholderText,o=e.entityPluginRef,i=e.queryCharacter,a=f.useCallback((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,o,a,s,l,c,u;return Object(r.__generator)(this,(function(r){return n?(e=Object(Hp.$getSelection)(),Object(Hp.$isRangeSelection)(e)&&e.isCollapsed()?(t=e.getNodes()[0],Object(Hp.$isTextNode)(t)&&t.isSimpleText()?(o=t.getTextContent(),a=e.getCharacterOffsets()[0],s=o[a-1]===i,l=1===a||""===(null===(u=o[a-2])||void 0===u?void 0:u.trim()),c=a===o.length||""===o[a].trim(),s&&l&&c?[2,"​‌"+n+"​‌"]:[2,void 0]):[2,void 0]):[2,void 0]):[2,void 0]}))}))}),[n,i]);return f.useEffect((function(){return t.registerNodeTransform(Hp.TextNode,(function(e){if(!e.getPreviousSibling()){var t=e.getTextContent();t.length>0&&t[0]===i&&e.insertBefore(Object(Hp.$createTextNode)(" "))}}))}),[t,i]),f.createElement(f.Fragment,null,f.createElement(Up.a,{id:"ciq",controlRef:o}),f.createElement(Vp.a,{id:"ciqGhostText",$getGhostText:a}))},Gp=n(1494),Wp=n(293),Qp=n(1088),qp=function(e){var t=e.closingMarker,n=void 0===t?"}":t,o=e.onChatInputTokenAdded,i=e.onChatInputTokenDeleted,a=e.openingMarker,s=void 0===a?"{":a,l=e.tokenPhrases,c=void 0===l?[]:l,u=e.tokenListPhrases,d=void 0===u?[]:u,p=e.useSortedTokenList,g=void 0!==p&&p,h=Object(r.__read)(Object(Np.useLexicalComposerContext)(),1)[0];g&&function(e){e.sort((function(e,t){var n=e.join(""),r=t.join("");return n<r?-1:n>r?1:n.length-r.length}))}(d);var m=f.useRef(!1),v=f.useCallback((function(e){var t,o,i=e.endIndex,a=e.node,l=e.startIndex,c=e.text;m.current=!0;var u=Object(kp.a)(c),d=a.splitText(l,i),p=0,g=a,h=0;try{for(var f=Object(r.__values)(d),v=f.next();!v.done;v=f.next()){var b=v.value;if(p++,h+=b.getTextContent().length,b.getTextContent().toLowerCase()===c.toLowerCase()||b.getTextContent().toLowerCase()===s+c.toLowerCase()+n){b.replace(u);break}}}catch(e){t={error:e}}finally{try{v&&!v.done&&(o=f.return)&&o.call(f)}finally{if(t)throw t.error}}return p<d.length&&(g=d[p]),Object(Hp.$isRootOrShadowRoot)(u.getParentOrThrow())&&Object(Wp.$wrapNodeInElement)(u,Hp.$createParagraphNode).selectEnd(),{updatedNode:g,nodeOffset:h}}),[n,s]);return Object(Qp.a)((function(){return Object(Wp.mergeRegister)(h.registerMutationListener(kp.c,(function(e,t){var n,a,s=function(e,n){"destroyed"===n?t.prevEditorState.read((function(){var t=Object(Hp.$getNodeByKey)(e);Object(kp.b)(t)&&(m.current=!1,null==i||i(t.getTextContent()),h.update((function(){var e,t=Object(Hp.$getRoot)().getFirstChild();Object(Hp.$isElementNode)(t)&&(null===(e=t.getChildren())||void 0===e||e.forEach((function(e){Object(kp.b)(e)&&e.replace(Object(Hp.$createTextNode)(e.getTextContent()))})))})),h.update((function(){Object(Hp.$getRoot)().getAllTextNodes().forEach((function(e){return e.markDirty()}))})))})):"created"===n&&h.getEditorState().read((function(){var t,n=Object(Hp.$getNodeByKey)(e);if(Object(kp.b)(n)){m.current=!0;var r="",i=Object(Hp.$getRoot)().getFirstChild();Object(Hp.$isElementNode)(i)&&(null===(t=i.getChildren())||void 0===t||t.forEach((function(e){Object(kp.b)(e)&&(r+=e.getTextContent())}))),null==o||o(r)}}))};try{for(var l=Object(r.__values)(e),c=l.next();!c.done;c=l.next()){var u=Object(r.__read)(c.value,2);s(u[0],u[1])}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}})))}),[h]),f.useEffect((function(){return h.registerNodeTransform(Hp.TextNode,(function(e){var t,o,i,a;if(!m.current){var l=e.getTextContent(),u=l.indexOf(s),p=l.indexOf(n,u);if(-1!==u&&-1!==p){var g=l.substring(u+1,p);""!==g&&v({node:e,startIndex:u,endIndex:p+1,text:g})}else if(d.length>0){var h=function(t){var n,o,i=0,a=t.every((function(e){var t=e(),n=l.toLocaleLowerCase().indexOf(t.toLocaleLowerCase(),i);return-1!==n&&(i=n+t.length,!0)}));if(a){var s=0,c=0;try{for(var u=(n=void 0,Object(r.__values)(t)),d=u.next();!d.done;d=u.next()){var p=(0,d.value)(),g=l.toLocaleLowerCase().indexOf(p.toLocaleLowerCase(),c);c=g+p.length-s;var h=v({node:e,startIndex:g-s,endIndex:c,text:p});e=h.updatedNode,s+=h.nodeOffset}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return{value:void 0}}};try{for(var f=Object(r.__values)(d),b=f.next();!b.done;b=f.next()){var y=h(b.value);if("object"==typeof y)return y.value}}catch(e){t={error:e}}finally{try{b&&!b.done&&(o=f.return)&&o.call(f)}finally{if(t)throw t.error}}}else try{for(var C=Object(r.__values)(c),O=C.next();!O.done;O=C.next()){var S=(0,O.value)(),E=l.toLocaleLowerCase().indexOf(S.toLocaleLowerCase());if(-1!==E)return void v({node:e,startIndex:E,endIndex:E+S.length,text:S})}}catch(e){i={error:e}}finally{try{O&&!O.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}}}))}),[v,n,h,s,c]),null},Kp=function(){},Yp=function(e,t){var n=e.chatInputContainerTitle,o=void 0===n?fu():n,i=e.ciqButtonTitle,a=void 0===i?Iu():i,s=e.copilotChatTheme,l=e.editorProps,c=e.groundingButtonPluginProps,u=e.groundingSourcePickerProps,d=e.handleChatInputLoad,p=void 0===d?Kp:d,g=e.handleFirstUserInput,h=void 0===g?Kp:g,m=e.handleOnBlur,v=e.handleOnChatInputControlMount,b=e.handleOnChatInputControlUnmount,y=e.handleOnInput,C=e.handleSubmitButtonClick,O=e.isCIQButtonEnabled,S=void 0!==O&&O,E=e.isDarkMode,x=e.isDisabled,I=e.isMenuButtonEnabled,w=void 0!==I&&I,T=e.isGroundingButtonEnabled,k=void 0!==T&&T,j=e.isSensitivityIndicatorLoading,P=e.isSubmitButtonDisabled,A=e.maxInputCharLimit,_=void 0===A?2e3:A,D=e.menuButtonTitle,L=void 0===D?mu():D,M=e.overrideStyles,B=e.placeholderText,R=void 0===B?bu():B,F=e.promptGuideMenuProps,N=e.shouldBlockGroundingButtonClick,H=void 0===N?function(){return!1}:N,U=e.shouldBlockSubmitButtonClick,V=void 0===U?function(){return!1}:U,z=e.submitButtonTitle,G=void 0===z?vu():z,W=e.voiceInputProps,Q=e.chatInputBannerProps,q=e.hvcPromptStrings,K=e.hvcPromptStringsList,Y=e.isHVCAppChatV2Enabled,Z=e.onChatInputHVCPromptUpdated,J=e.useSortedHVCTokenList,X=Object(r.__read)(f.useState(!1),2),$=X[0],ee=X[1],te=Object(r.__read)(f.useState(!1),2),ne=te[0],re=te[1],oe=Object(r.__read)(f.useState(!1),2),ie=oe[0],ae=oe[1],se=Object(r.__read)(f.useState(R),2),le=se[0],ce=se[1],ue=Object(r.__read)(f.useState(!0),2),de=ue[0],pe=ue[1],ge=f.useRef(),he=f.useRef(),fe=f.useRef(!0),me=f.useRef(!0),ve=f.useRef(null),be=f.useRef(null),ye=f.useRef(null);f.useImperativeHandle(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){var t;null===(t=be.current)||void 0===t||t.setInputText(e)},updateInputText:function(e,t){var n,r,o;switch(t){case Wu.a.InsertAtCursor:e!==Zc.a||fe.current||null===(n=be.current)||void 0===n||n.insertTextAtCursor(xu),null===(r=be.current)||void 0===r||r.insertTextAtCursor(e);break;case Wu.a.Replace:null===(o=be.current)||void 0===o||o.setInputText(e)}},getInputText:function(){var e;return null===(e=be.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){return ye.current},setGhostText:function(e){},getGhostText:function(){var e;return null===(e=Te.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=ye.current)||void 0===e||e.focus()},closeMenu:function(){w&&$&&ee(!1),k&&ne&&re(!1),ke&&je.current&&Ae(!1)},getCIQTextRef:function(){return Ee.current},getChatEditorInstance:function(){return Oe},getCIQResponseHandler:function(){return Se}}})),f.useEffect((function(){ce(R)}),[R]),f.useEffect((function(){var e;he.current&&(null===(e=ve.current)||void 0===e||e.setTarget(he.current))}),[ve,he]);var Ce=function(e){var t,n=e.chatInputRef,o=e.controlRef,i=e.copilotChatTheme,a=e.editorProps,s=e.isDarkMode,l=e.isSensitivityIndicatorLoading,c=e.languageSupportsSpace,u=Object(r.__read)(f.useState(void 0),2),d=u[0],p=u[1],g=Object(r.__read)(f.useState(void 0),2),h=g[0],m=g[1],v=Object(r.__read)(f.useState(!1),2),b=v[0],y=v[1],C=f.useRef(),O=f.useRef(),S=f.useRef();f.useEffect((function(){s?d&&d.updateCurrentTheme(Jc.a.dark):d&&d.updateCurrentTheme(Jc.a.light)}),[s,d]),f.useEffect((function(){(null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!C.current&&(null==a?void 0:a.alSession)&&y(!0)}),[null==a?void 0:a.alSession,null==a?void 0:a.handleInChatInput,null==a?void 0:a.editorConfig]),f.useEffect((function(){return function(){C.current&&C.current.shutdown().then((function(){C.current=void 0}))}}),[]),f.useEffect((function(){if(b){var e=(new Xc.a).createInstance();e.bootstrap(pu(a.editorConfig,a.alSession)).then((function(t){C.current=e,p(t)}))}}),[b]),f.useEffect((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!h&&d&&n.current){var e=new Fp(S,o);d.initializeCiq(n.current,{menuTitle:null==a?void 0:a.editorConfig.transformFileMenuTitle,menuSubtitle:(null==a?void 0:a.editorConfig.transformFilePlaceholderText)?null==a?void 0:a.editorConfig.transformFilePlaceholderText:yu,queryCharToUse:Zc.a,onItemSelected:function(t){var r,u;null===(r=n.current)||void 0===r||r.focus(),e.renderAndTrackSelectedSuggestion(t,null,l,i,s,O),c.current&&(null===(u=o.current)||void 0===u||u.insertTextAtCursor(xu)),a.postCIQItemSelectionHandler&&a.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==a?void 0:a.editorConfig.entitiesSupported,ExpanededECC:null==a?void 0:a.editorConfig.isExpandedECCEnabled}),m(e)}}),[d,h]);var E=d?f.createElement(zp,{queryCharacter:Zc.a,ciqPlaceholderText:null===(t=null==a?void 0:a.editorConfig)||void 0===t?void 0:t.ciqPlaceholderText,entityPluginRef:S}):null;return{chatEditor:d,ciqResponseHandler:h,ciqTextRef:O,ciqPlugin:E}}({chatInputRef:ye,controlRef:be,copilotChatTheme:s,editorProps:l,isDarkMode:E,isSensitivityIndicatorLoading:j,languageSupportsSpace:fe}),Oe=Ce.chatEditor,Se=Ce.ciqResponseHandler,Ee=Ce.ciqTextRef,xe=Ce.ciqPlugin,Ie=function(e){var t=e.chatInputRef,n=e.controlRef,o=e.handleChatInputLoad,i=e.isDisabled,a=e.languageSupportsSpace,s=e.maxInputCharLimit,l=e.placeholderText,c=e.voiceInputProps,u=Object(r.__read)(f.useState(!1),2),d=u[0],p=u[1],g=Object(r.__read)(f.useState(ip.Uninitialized),2),h=g[0],m=g[1],v=Object(r.__read)(f.useState(!1),2),b=v[0],y=v[1],C=f.useRef(null==c?void 0:c.alSession),O=f.useRef(!1),S=f.useRef(null),E=!(!(null==c?void 0:c.handleInChatInput)||!(null==c?void 0:c.alSession)&&!(null==c?void 0:c.alSessionConfig)),x=f.useCallback((function(e){var t,r,o,i,s,l;if(e){var c=(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>0&&a.current?xu:yu;null===(r=S.current)||void 0===r||r.setGhostText(c+Eu())}else{var u=null===(i=null===(o=S.current)||void 0===o?void 0:o.getGhostText())||void 0===i?void 0:i.trim();u&&""!==u&&u!==Eu()?null===(s=S.current)||void 0===s||s.commitGhostText(u):null===(l=S.current)||void 0===l||l.cancelGhostText()}p(e),O.current=e}),[l]);f.useEffect((function(){var e;d||Object(tu.d)(x).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=t.current)||void 0===e||e.focus()}),[d]);var I=f.useCallback((function(e){var r,o,l,c,u;if(O.current&&E&&!i&&!((null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>=s)){var d=(null===(o=n.current)||void 0===o?void 0:o.getInputText().length)>0&&a?xu:yu;null===(l=S.current)||void 0===l||l.commitGhostText(d+e),null===(c=t.current)||void 0===c||c.focus(),null===(u=n.current)||void 0===u||u.scrollToBottom()}}),[E,i,s]),w=f.useCallback((function(e){var t,r,o,l;if(O.current&&E&&!i&&!(null!=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>=s)){var c=(null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>0&&a?xu:yu;null===(o=S.current)||void 0===o||o.setGhostText(c+e),null===(l=n.current)||void 0===l||l.scrollToBottom(),e.trim()&&Object(tu.e)(Su,x)}}),[E,i,s,x]),T=f.useCallback((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null!=C.current?[3,4]:(e=C,null===(o=c.alSession)||void 0===o?[3,1]:(t=o,[3,3]));case 1:return[4,gu(null==c?void 0:c.alSessionConfig)];case 2:t=r.sent(),r.label=3;case 3:e.current=t,r.label=4;case 4:return C.current?(n=Object(nu.a)(c.voiceInputLocale),[4,Object(tu.a)(n,I,w,m,x,C.current)]):[3,6];case 5:r.sent(),a.current=Object(nu.b)(Object(nu.a)(n)),r.label=6;case 6:return[2]}}))}))}),[w,I,x,null==c?void 0:c.alSession,null==c?void 0:c.alSessionConfig,null==c?void 0:c.voiceInputLocale]);f.useEffect((function(){o()}),[]),f.useEffect((function(){E&&T()}),[E,T]);var k=E?{isMicrophoneListening:d,microphoneState:h,handleMicrophoneButtonOnClick:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,a,s,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),d?((null===(o=S.current)||void 0===o?void 0:o.getGhostText())!=yu&&(null===(i=S.current)||void 0===i?void 0:i.getGhostText())!=l&&(null===(s=null===(a=S.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Eu()&&(null===(c=S.current)||void 0===c||c.commitGhostText(null===(u=S.current)||void 0===u?void 0:u.getGhostText())),[4,Object(tu.d)(x)]):[3,3];case 2:return r.sent(),[3,6];case 3:return h===ip.Uninitialized&&m(ip.Loading),[4,Gp.a.GetInstance().Resume()];case 4:return r.sent(),y(!1),x(!d),m(ip.Enabled),[4,Object(tu.e)(Su,x)];case 5:r.sent(),r.label=6;case 6:return[3,10];case 7:return t=r.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Gp.a.GetInstance().Pause()];case 8:r.sent(),y(!0),r.label=9;case 9:return m(ip.Uninitialized),[2];case 10:return[2]}}))}))},micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:b,microphonePermissionErrorTitle:null==c?void 0:c.microphonePermissionErrorTitle,microphonePermissionErrorMessage:null==c?void 0:c.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){Object(tu.b)(d,Su,y,m,x)},notNowOnClickHandler:function(){y(!1)},microphonePermissionErrorImagePath:null==c?void 0:c.microphonePermissionImagePath,showHelpLink:null==c?void 0:c.showMicrophonePermissionHelpLink},isTooltipDisabled:!0}:null==c?void 0:c.microphoneButtonProps;return{getMicrophoneLiveRegionText:function(){if(k)switch(null==k?void 0:k.microphoneState){case ip.Enabled:return k.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case ip.Disabled:case ip.Uninitialized:return"Microphone Disabled";case ip.Loading:return"Microphone Loading";default:return}},ghostTextRef:S,handleVoiceInChatInput:E,isMicrophoneActive:O,microphoneProps:k,setMicrophoneListeningStatus:x}}({chatInputRef:ye,controlRef:be,handleChatInputLoad:p,isDisabled:x,languageSupportsSpace:fe,maxInputCharLimit:_,placeholderText:R,voiceInputProps:W}),we=Ie.getMicrophoneLiveRegionText,Te=Ie.ghostTextRef,ke=Ie.handleVoiceInChatInput,je=Ie.isMicrophoneActive,Pe=Ie.microphoneProps,Ae=Ie.setMicrophoneListeningStatus;return f.useEffect((function(){return v&&v(),function(){b&&b()}}),[v,b]),{isDisabled:x,isGroundingSourcePickerEnabled:!k&&void 0!==u,isPromptGuideMenuButtonEnabled:w&&void 0!==F,isCIQButtonEnabled:S,isGroundingButtonEnabled:k&&void 0!==c,isChatFooterDividerEnabled:w&&void 0!==F||S||k,isVoiceInputEnabled:void 0!==W,themeWrapper:{isDarkMode:E,themePalette:s},chatInputContainer:{id:Ou,onBlur:function(){var e;Rp()&&!$&&(null===(e=be.current)||void 0===e?void 0:e.getInputText())===yu&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return m(),[2]}))}))}),100)},ref:he},groundingSourcePicker:Object(r.__assign)(Object(r.__assign)({},u),{isChatInputV3Enabled:!0,isChatInputBannerVisible:void 0!==Q,isDisabled:!(null==u?void 0:u.alwaysEnable)&&x,onSelection:function(e){var t;ce(e.placeholderText),null===(t=null==u?void 0:u.onSelection)||void 0===t||t.call(u,e)}}),chatInputBannerProps:Q?Object(r.__assign)(Object(r.__assign)({},Q),{isInputV3Enabled:!0}):void 0,chatInputContainerTooltip:{content:o,onVisibleChange:function(e,t){e&&"focus"===e.type?ae(!1):ae(t.visible)},positioning:"above",relationship:"label",visible:ie,withArrow:!0},promptGuideMenuButton:{isDisabled:x,isMenuOpen:$,setMenuOpen:ee,positioningRef:ve,promptGuideMenuProps:F,title:L},ciqButton:{handleClick:function(){var e;null===(e=be.current)||void 0===e||e.setInputText("/")},isDisabled:x,title:a},groundingButton:{isDisabled:x,isMenuOpen:ne,groundingButtonPluginProps:c,setMenuOpen:re,shouldBlockGroundingButtonClick:H,targetRef:null==ge?void 0:ge.current,title:wu()},chatFooterDivider:{appearance:"strong",vertical:!0},voiceInputTooltip:{content:we(),positioning:"above",relationship:"label",withArrow:!0},ariaLiveSpan:{"aria-live":"assertive",role:"alert"},microphoneButton:{"aria-live":"assertive",isDisabled:x,microphoneButtonProps:Pe},faiChatInput:{actions:{ref:ge},className:null==M?void 0:M.userInput,customNodes:[Tp.c,kp.c,jp.c],disableSend:x||P||de,disabled:x,editor:{"aria-label":"Prompt"},maxLength:_,onChange:function(e,t){me.current&&(h(),me.current=!1);var n=t.value;pe(!n||""===n.trim())},onInput:y,onSubmit:function(e){var t,n,r,o;if(!(null==V?void 0:V())){e.stopPropagation(),ke&&Ae(!1);var i=null===(n=null===(t=be.current)||void 0===t?void 0:t.getInputText())||void 0===n?void 0:n.trim();if(void 0!==i&&i.trimStart()!==yu&&!x){var a=be.current?null==Se?void 0:Se.generateQueryAnnotations(ye.current):void 0;C(i,a),null===(r=be.current)||void 0===r||r.setInputText(yu),null===(o=Te.current)||void 0===o||o.cancelGhostText()}}},placeholderValue:le,ref:ye,send:{title:G},characterLimitErrorMessage:e.characterLimitErrorMessage,children:f.createElement(f.Fragment,null,f.createElement(Pp.a,{ref:be}),f.createElement(Ap.a,{id:"voiceInputGhostText",ref:Te}),xe,Y?f.createElement(qp,{languageSupportsSpace:fe,tokenPhrases:q,tokenListPhrases:K,useSortedTokenList:J,onChatInputTokenAdded:function(e){Z&&Z(e,!0)},onChatInputTokenDeleted:function(e){Z&&Z(e,!1)}}):void 0)}}},Zp={chatInputOuterContainer:Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius(Q.a.borderRadiusXLarge)),W.a.margin(0,"16px","16px","16px")),chatInputContainer:{color:Q.a.colorNeutralForeground1,position:"relative",zIndex:"1"},faiChatInputWithGrounding:{borderTopLeftRadius:0,borderTopRightRadius:0}},Jp=Object(y.a)(Zp),Xp=f.forwardRef((function(e,t){var n=Yp(e,t);return function(e){var t=Jp(),n=e.isDisabled,r=e.overrideStyles,o=e.isGroundingSourcePickerEnabled,i=e.chatInputBannerProps;e.themeWrapper.className=Object(C.a)(t.chatInputOuterContainer,!n&&(null==r?void 0:r.chatInputOuterContainer),e.themeWrapper.className),e.chatInputContainer.className=Object(C.a)(t.chatInputContainer,!n&&(null==r?void 0:r.chatInput),e.chatInputContainer.className),e.faiChatInput.className=Object(C.a)((o||i)&&t.faiChatInputWithGrounding,e.faiChatInput.className),e.ariaLiveSpan.className=Object(C.a)(!n&&(null==r?void 0:r.ariaLiveSpan),e.ariaLiveSpan.className)}(n),function(e){var t=e.ariaLiveSpan,n=e.chatFooterDivider,o=e.chatInputContainer,i=e.ciqButton,a=e.faiChatInput,s=e.groundingButton,l=e.groundingSourcePicker,c=e.isCIQButtonEnabled,u=e.isChatFooterDividerEnabled,d=e.isGroundingButtonEnabled,p=e.isGroundingSourcePickerEnabled,g=e.isPromptGuideMenuButtonEnabled,h=e.isVoiceInputEnabled,m=e.microphoneButton,v=e.promptGuideMenuButton,b=e.themeWrapper,y=e.voiceInputTooltip,C=e.chatInputBannerProps;return f.createElement(gd,Object(r.__assign)({},b),f.createElement("div",Object(r.__assign)({},o),C&&f.createElement(lu,Object(r.__assign)({},C)),p&&f.createElement(ep,Object(r.__assign)({},l)),f.createElement(rd.a,Object(r.__assign)({},a,{actions:Object(r.__assign)(Object(r.__assign)({},a.actions),{children:f.createElement("span",{style:{display:"flex",alignItems:"center"}},g&&f.createElement(np,Object(r.__assign)({},v)),c&&f.createElement(iu,Object(r.__assign)({},i)),d&&f.createElement(Fd,Object(r.__assign)({},s)),u&&f.createElement(ru.a,Object(r.__assign)({},n)),h&&f.createElement(x.a,Object(r.__assign)({},y),f.createElement("span",Object(r.__assign)({},t),f.createElement(wp,Object(r.__assign)({},m)))))})}))))}(n)}));Xp.displayName="ChatInput",function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(_p||(_p={}));var $p=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},W.a.borderRadius("8px")),W.a.borderColor(Q.a.colorNeutralBackground1)),(Dp={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Dp["&:hover .".concat(St.a.icon)]={color:Q.a.colorBrandForeground1},Dp["&:hover:active .".concat(St.a.icon)]={color:Q.a.colorBrandForeground1},Dp.display="flow",Dp))}),eg=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},W.a.borderRadius("50%")),(Lp={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Q.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Q.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Q.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Lp["&.".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},Lp["&:hover .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},Lp["&:active .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},Lp["&:hover:active .".concat(St.a.icon)]={color:Q.a.colorNeutralBackground1},Lp["&:hover"]={backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},Lp["&:hover:active"]={backgroundColor:Q.a.colorBrandForeground1,color:Q.a.colorNeutralBackground1},Lp["@media (forced-colors: active)"]={forcedColorAdjust:"none"},Lp))}),tg=Object(y.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),ng=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground3},W.a.borderRadius("50%")),{color:Q.a.colorBrandForeground1}),loader:Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralBackground1},W.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Q.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),rg=Object(y.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground4},W.a.borderColor(Q.a.colorNeutralBackground4)),(Mp={"&:hover":Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground4},W.a.borderColor(Q.a.colorNeutralBackground4))},Mp["&:hover .".concat(St.a.icon)]={color:Q.a.colorNeutralForegroundDisabled},Mp["&:hover:active .".concat(St.a.icon)]={color:"".concat(Q.a.colorNeutralForegroundDisabled," !important")},Mp))}),og=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,o=Object(r.__read)(Object(f.useState)(!1),2),i=o[0],a=o[1],s=Object(r.__read)(Object(f.useState)(!1),2),l=s[0],c=s[1];Object(f.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(v.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(f.useEffect)((function(){n.microphoneState===_p.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===_p.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(f.useEffect)((function(){t?g(b.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(f.useRef)($p()),d=Object(r.__read)(Object(f.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(f.useRef)(Object(C.a)(u.current.root,ng().root)),v=Object(f.useRef)(Object(C.a)(u.current.root,eg().root)),b=Object(f.useRef)(Object(C.a)(u.current.root,rg().root)),y=m.a.createElement(w.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case _p.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case _p.Disabled:case _p.Uninitialized:return"Microphone Disabled";case _p.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?m.a.createElement(rc.a,{title:"Mic-Filled"}):m.a.createElement(rc.b,{title:"Mic-Regular"}),onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return m.a.createElement("div",{className:tg().root},n.isTooltipDisabled?y:m.a.createElement(x.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},y),i&&m.a.createElement("div",{className:ng().loader}),m.a.createElement(yp,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},ig=Object(y.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),ag=function(e){var t=e.children,n=e.style,o=e.horizontal,i=void 0!==o&&o,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(C.a)(o,t)),n?o=r?Object(C.a)(o,e.horizontalReverse):Object(C.a)(o,e.horizontal):r&&(o=Object(C.a)(o,e.verticalReverse)),o}(ig(),n,i,s);return f.createElement("div",Object(r.__assign)({className:c},l),t)},sg={chatInputOuterContainer:Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius(Q.a.borderRadiusXLarge)),W.a.margin(0,"16px","16px","16px")),chatInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralForeground1,backgroundColor:Q.a.colorNeutralBackground1},W.a.border("1px","solid",Q.a.colorNeutralStroke1)),W.a.borderRadius(Q.a.borderRadiusXLarge)),W.a.padding("4px")),W.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(r.__assign)(Object(r.__assign)({},W.a.margin("12px","12px","4px","12px")),{maxHeight:"168px",overflowY:"auto"}),userInput:{},chatInputButtons:Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground1,width:"100%",flexDirection:"row",flexWrap:"wrap"},W.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputCharCount:{},chatInputLeftButtons:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Q.a.colorNeutralForeground4,alignSelf:"flex-start"},W.a.margin("12px","12px","4px","12px")),W.a.gap("6px")),{fontStyle:"normal",fontSize:"10px",justifyItems:"center"}),chatInputRightButtons:{display:"flex",flexDirection:"row",alignSelf:"flex-end"},contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},W.a.padding("6px")),{backgroundColor:Q.a.colorNeutralBackground1,boxShadow:Q.a.shadow4}),W.a.borderRadius("8px")),chatInputCharCountError:{position:"absolute",left:"-9999px"}},lg=Object(y.a)(sg),cg=Object(y.a)({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},W.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(Q.a.colorBrandForeground1,", ").concat(Q.a.colorCompoundBrandForeground1Hover,")")})}}}),ug=Object(y.a)({chatInput:{backgroundColor:Q.a.colorNeutralBackground4},chatInputButtons:{backgroundColor:Q.a.colorNeutralBackground4},chatInputCharCount:{userSelect:"none","@media (forced-colors: active)":{forcedColorAdjust:"none"}}});var dg,pg=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return m.a.createElement(x.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},m.a.createElement(w.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=We.h,n=We.g,r=Object(A.a)(n,t),m.a.createElement(r,null))},onClick:a,disabled:i}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(dg||(dg={}));var gg=function(){function e(e,t,n,o,i,a,s,l,c,u,d,p){var g=this;this.onTryAgainClicked=function(){(new Date).getTime(),Object(tu.b)(g.isMicrophoneListening,Su,g.setShouldShowMicrophonePermissionRetryDialog,g.setMicrophoneState,g.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(r.__awaiter)(g,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),this.isMicrophoneListening?((null===(o=this.chatInputRef.current)||void 0===o?void 0:o.getGhostText())!=yu&&(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=this.chatPlaceHolderMessage&&(null===(s=null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Eu()&&(null===(l=this.chatInputRef.current)||void 0===l||l.setInputText((null===(c=this.chatInputRef.current)||void 0===c?void 0:c.getInputText())+(null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getGhostText())),null===(d=this.chatInputRef.current)||void 0===d||d.setGhostText("")),[4,Object(tu.d)(this.setMicrophoneListeningStatus)]):[3,3];case 2:return r.sent(),[3,6];case 3:return this.microphoneState===dg.Uninitialized&&this.setMicrophoneState(dg.Loading),(new Date).getTime(),[4,Gp.a.GetInstance().Resume()];case 4:return r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(dg.Enabled),[4,Object(tu.e)(Su,this.setMicrophoneListeningStatus)];case 5:r.sent(),r.label=6;case 6:return[3,10];case 7:return t=r.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Gp.a.GetInstance().Pause()];case 8:r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),r.label=9;case 9:return this.setMicrophoneState(dg.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=o,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}();var hg=m.a.forwardRef((function(e,t){var n=e.isDisabled,o=e.isSubmitButtonDisabled,i=e.copilotChatTheme,a=void 0===i?dd.palette:i,s=e.isDarkMode,l=e.dir,c=void 0===l?void 0:l,u=e.overrideStyles,d=e.chatInputTabIndex,p=void 0===d?0:d,g=e.chatInputContainerTabIndex,h=void 0===g?-1:g,v=e.chatInputContainerTitle,b=void 0===v?fu():v,y=e.placeholderText,O=void 0===y?bu():y,S=e.maxInputCharLimit,E=void 0===S?2e3:S,I=e.isHVCAppChatV2Enabled,w=void 0!==I&&I,T=e.hvcPromptStrings,k=void 0===T?[]:T,j=e.onChatInputHVCPromptUpdated,P=void 0===j?function(e,t){}:j,A=e.handleKeyDown,_=e.handleKeyUp,D=e.handleOnPaste,L=e.handleOnBeforeInput,M=e.handleOnInput,B=e.submitButtonTitle,R=void 0===B?vu():B,F=e.handleSubmitButtonClick,N=e.isMenuButtonEnabled,H=void 0!==N&&N,U=(e.shouldOpenMenuOnEmptyInput,e.menuButtonTitle),V=void 0===U?mu():U,z=(e.handleMenuButtonClick,e.handleOnOpenMenu,e.handleOnChatInputControlMount),G=e.handleOnChatInputControlUnmount,W=e.handleOnBlur,Q=e.promptGuideMenuProps,q=e.voiceInputProps,K=e.isCIQButtonEnabled,Y=void 0!==K&&K,Z=e.ciqButtonTitle,J=void 0===Z?Iu():Z,X=e.isGroundingButtonEnabled,$=void 0!==X&&X,ee=e.groundingSourcePickerProps,te=e.groundingButtonPluginProps,ne=e.shouldBlockGroundingButtonClick,re=void 0===ne?function(){return!1}:ne,oe=e.shouldBlockSubmitButtonClick,ie=void 0===oe?function(){return!1}:oe,ae=e.handleFirstUserInput,se=void 0===ae?function(){}:ae,le=e.handleChatInputLoad,ce=void 0===le?function(){}:le,ue=e.editorProps,de=e.isSensitivityIndicatorLoading,pe=e.imageInputEnabled,ge=e.chatInputBannerProps,he=Object(f.useRef)(),fe=Object(f.useRef)(),me=Object(f.useRef)(null),ve=Object(f.useRef)(),be=m.a.useRef(),ye=Object(f.useRef)(),Ce=Object(f.useRef)(!1),Oe=Object(f.useRef)(!0),Se=Object(f.useRef)(!0),Ee=Object(f.useRef)(null==q?void 0:q.alSession),xe=!(!(null==q?void 0:q.handleInChatInput)||!(null==q?void 0:q.alSession)&&!(null==q?void 0:q.alSessionConfig)),Ie=Object(r.__read)(Object(f.useState)(void 0),2),we=Ie[0],Te=Ie[1],ke=Object(r.__read)(m.a.useState(void 0),2),je=ke[0],Pe=ke[1],Ae=Object(r.__read)(Object(f.useState)(0),2),_e=Ae[0],De=Ae[1];Object(f.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=he.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=he.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=he.current)||void 0===e?void 0:e.getImages()},setInputText:function(e,t){var n,r;void 0===t&&(t=!1),null===(n=he.current)||void 0===n||n.setInputText(e,t),De(null===(r=he.current)||void 0===r?void 0:r.getInputText().length)},updateInputText:function(e,t){var n,r;null===(n=he.current)||void 0===n||n.updateInputText(e,t),De(null===(r=he.current)||void 0===r?void 0:r.getInputText().length)},getInputText:function(){var e;return null===(e=he.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=he.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){var t;null===(t=he.current)||void 0===t||t.setGhostText(e)},getGhostText:function(){var e;return null===(e=he.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=he.current)||void 0===e||e.setFocus()},closeMenu:function(){H&&Me&&Be(!1),$&&Fe&&Ne(!1),xe&&Ce.current&&tt(!1)},getCIQTextRef:function(){return ye.current},getChatEditorInstance:function(){return je},getCIQResponseHandler:function(){return we},setMenuButtonFocus:function(){document.getElementById("ViewPromptsID").focus()}}}));var Le=Object(r.__read)(Object(f.useState)(!1),2),Me=Le[0],Be=Le[1],Re=Object(r.__read)(Object(f.useState)(!1),2),Fe=Re[0],Ne=Re[1],He=Object(r.__read)(Object(f.useState)(!1),2),Ue=He[0],Ve=He[1],ze=Object(r.__read)(Object(f.useState)(_p.Uninitialized),2),Ge=ze[0],We=ze[1],Qe=Object(r.__read)(Object(f.useState)(!1),2),qe=Qe[0],Ke=Qe[1],Ye=Object(r.__read)(Object(f.useState)(!1),2),Ze=Ye[0],Je=Ye[1],Xe=Object(r.__read)(Object(f.useState)(O),2),$e=Xe[0],et=Xe[1],tt=function(e){var t,n,r,o,i,a,s;if(e){var l=(null===(t=he.current)||void 0===t?void 0:t.getInputText().length)>0&&Se.current?xu:yu;null===(n=he.current)||void 0===n||n.setGhostText(l+Eu())}else(null===(r=he.current)||void 0===r?void 0:r.getInputText())===yu?null===(o=he.current)||void 0===o||o.setGhostText(O):(null===(a=null===(i=he.current)||void 0===i?void 0:i.getGhostText())||void 0===a?void 0:a.trim())===Eu()&&(null===(s=he.current)||void 0===s||s.setGhostText(yu));Je(e),Ce.current=e},nt=function(e){var t,r,o,i,a,s;if(Ce.current&&xe&&!n&&!(null!=he.current&&(null===(t=he.current)||void 0===t?void 0:t.getInputText().length)>=E)){var l=(null===(r=he.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?xu:yu,c=null!=he.current?(null===(o=he.current)||void 0===o?void 0:o.getInputText())+l+e:yu;null===(i=he.current)||void 0===i||i.setInputText(c),null===(a=he.current)||void 0===a||a.setGhostText(yu),null===(s=he.current)||void 0===s||s.setFocus()}},rt=function(e){var t,r,o;if(Ce.current&&xe&&!n&&!(null!=he.current&&(null===(t=he.current)||void 0===t?void 0:t.getInputText().length)>=E)){var i=(null===(r=he.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?xu:yu;null===(o=he.current)||void 0===o||o.setGhostText(i+e),e.trim()&&Object(tu.e)(Su,tt)}},ot=new gg(Ze,qe,Ge,null==q?void 0:q.microphonePermissionErrorTitle,null==q?void 0:q.microphonePermissionErrorMessage,Ke,We,tt,he,O,null==q?void 0:q.microphonePermissionImagePath,null==q?void 0:q.showMicrophonePermissionHelpLink),it=xe?ot.getMicrophoneButtonProps():null==q?void 0:q.microphoneButtonProps;it&&!it.title&&(it.title=du()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone");var at=!1,st=function(){var e;Oe.current&&(se(),Oe.current=!1);var t=null===(e=he.current)||void 0===e?void 0:e.getInputText();t=t.replace("\n",""),De(t.length)},lt=!1;Object(f.useEffect)((function(){var e;et(O),null===(e=he.current)||void 0===e||e.setGhostText(O)}),[O]),Object(f.useEffect)((function(){var e;fe.current&&(null===(e=me.current)||void 0===e||e.setTarget(fe.current))}),[me,fe]),Object(f.useEffect)((function(){s?je&&je.updateCurrentTheme(Jc.a.dark):je&&je.updateCurrentTheme(Jc.a.light)}),[s]),Object(f.useEffect)((function(){if((null==ue?void 0:ue.handleInChatInput)&&(null==ue?void 0:ue.editorConfig)&&!be.current&&(null==ue?void 0:ue.alSession)){var e=(new Xc.a).createInstance();e.bootstrap(pu(ue.editorConfig,ue.alSession)).then((function(t){be.current=e,Pe(t)}))}return function(){be.current&&be.current.shutdown().then((function(){be.current=void 0}))}}),[null==ue?void 0:ue.alSession]),Object(f.useEffect)((function(){if((null==ue?void 0:ue.handleInChatInput)&&(null==ue?void 0:ue.editorConfig)&&!we&&je&&he.current){var e=je.initializeCiq(he.current.getInputSpanElement(),{menuTitle:null==ue?void 0:ue.editorConfig.transformFileMenuTitle,menuSubtitle:(null==ue?void 0:ue.editorConfig.transformFilePlaceholderText)?null==ue?void 0:ue.editorConfig.transformFilePlaceholderText:yu,queryCharToUse:Zc.a,onItemSelected:function(t){var n,r;null===(n=he.current)||void 0===n||n.setGhostText(yu),null===(r=he.current)||void 0===r||r.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,de,a,s,ye),ue.postCIQItemSelectionHandler&&ue.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==ue?void 0:ue.editorConfig.entitiesSupported,ExpanededECC:null==ue?void 0:ue.editorConfig.isExpandedECCEnabled});Te(e)}}),[je,we]),Object(f.useEffect)((function(){var e;Ze||Object(tu.d)(tt).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=he.current)||void 0===e||e.setFocus()}),[Ze]);var ct=lg(),ut=cg(),dt=ug(),pt=Object(f.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),gt=Object(f.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),ht=Object(r.__read)(Object(f.useState)(ct),2),ft=ht[0],mt=ht[1];Object(f.useEffect)((function(){for(var e in ct)pt.current[e]=Object(C.a)(ct[e],ut[e]);for(var e in ct)gt.current[e]=Object(C.a)(ct[e],dt[e]);xe&&Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return null!=Ee.current?[3,2]:(e=Ee,[4,gu(null==q?void 0:q.alSessionConfig)]);case 1:e.current=n.sent(),n.label=2;case 2:return Ee.current?(t=Object(nu.a)(q.voiceInputLocale),[4,Object(tu.a)(t,nt,rt,We,tt,Ee.current)]):[3,4];case 3:n.sent(),Se.current=Object(nu.b)(Object(nu.a)(t)),n.label=4;case 4:return[2]}}))})),ce()}),[]),Object(f.useEffect)((function(){if(u)for(var e in ct)pt.current[e]=Object(C.a)(ct[e],u[e])}),[u]),Object(f.useEffect)((function(){var e;n?mt(gt.current):(mt(pt.current),null===(e=he.current)||void 0===e||e.setFocus())}),[n,u]);return m.a.createElement(gd,{className:ft.chatInputOuterContainer,themePalette:a,isDarkMode:s,dir:c},m.a.createElement("div",{id:Ou,className:ft.chatInput,tabIndex:h,onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(r){return n||document.activeElement===(null===(e=he.current)||void 0===e?void 0:e.getInputSpanElement())||null===(t=he.current)||void 0===t||t.setFocus(),[2]}))}))},onMouseDown:function(e){Rp()&&e.preventDefault()},onBlur:function(){var e;Rp()&&!Me&&(null===(e=he.current)||void 0===e?void 0:e.getInputText())===yu&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return W(),[2]}))}))}),100)},ref:fe},ge&&m.a.createElement(lu,Object(r.__assign)({},ge)),!$&&ee&&m.a.createElement(ep,Object(r.__assign)({},ee,{onSelection:function(e){et(e.placeholderText),ee&&ee.onSelection&&ee.onSelection(e)},isDisabled:!ee.alwaysEnable&&n,isChatInputBannerVisible:void 0!==ge})),m.a.createElement(x.a,{content:b,relationship:"label",positioning:"above",withArrow:!0,visible:Ue,onVisibleChange:function(e,t){e&&"focus"===e.type?Ve(!1):Ve(t.visible)}},m.a.createElement("div",null,m.a.createElement("div",{className:ft.chatInputContainer},m.a.createElement(nd,{ref:he,styleOverrideClassName:u?u.userInput:"",placeholderText:$e,chatInputTabIndex:p,isDisabled:n,isHVCAppChatV2Enabled:w,hvcPromptStrings:k,onChatInputHVCPromptUpdated:P,handleKeyDown:function(e){var t,r,o,i,a;if(at="Process"===e.key,!e.nativeEvent.isComposing)if(lt&&"Enter"===e.key)lt=!1;else if(!A||A(e)){var s;if("Backspace"===e.key)if((c=window.getSelection())&&c.isCollapsed&&0!==c.anchorOffset&&(" "===c.anchorNode.textContent||c.anchorNode.lastChild&&" "===c.anchorNode.lastChild.textContent)){var l=c.anchorNode.lastChild?c.anchorNode.lastChild.previousSibling:c.anchorNode.previousSibling;l&&((s=l.lastChild)&&s instanceof HTMLElement&&"false"===s.contentEditable)&&(e.preventDefault(),c.modify("move","backward","character"))}if("Enter"===e.key)if(e.preventDefault(),e.shiftKey){if(_e===E)return;var c;null===(t=he.current)||void 0===t||t.setGhostText(yu),(c=window.getSelection()).getRangeAt(0).insertNode(document.createElement("br")),c.collapseToEnd(),null===(r=he.current)||void 0===r||r.scrollToBottom(),st()}else if(!n){var u=he.current?null==we?void 0:we.generateQueryAnnotations(he.current.getInputSpanElement()):void 0;F(null===(o=he.current)||void 0===o?void 0:o.getInputText(),u),null===(i=he.current)||void 0===i||i.setInputText(yu),null===(a=he.current)||void 0===a||a.setGhostText($e)}}else xe&&"Enter"===e.key&&!e.shiftKey&&tt(!1)},handleKeyUp:function(e){var t,n,r,o;_&&!_(e)||((null===(t=he.current)||void 0===t?void 0:t.getInputText())===yu?null===(n=he.current)||void 0===n||n.setGhostText($e):(null===(r=he.current)||void 0===r?void 0:r.getGhostText())===$e&&(null===(o=he.current)||void 0===o||o.setGhostText(yu)))},handleOnPaste:function(e){var t,r,o;if(n)e.preventDefault();else if(!D||D(e)){if(e.preventDefault(),Ve(!1),null===(t=he.current)||void 0===t||t.setGhostText(yu),pe&&e.clipboardData.files.length>0){var i=new FileReader;i.addEventListener("load",(function(){var e;null===(e=he.current)||void 0===e||e.addImage(i.result)})),i.readAsDataURL(e.clipboardData.files[0])}var a=e.clipboardData.getData("Text"),s=a.length||0,l=null===(r=he.current)||void 0===r?void 0:r.getInputText(),c=window.getSelection();if(c.rangeCount){var u=c.toString(),d=l.length-u.length,p=a.substring(0,E-d);c.deleteFromDocument(),d+s>=E?c.getRangeAt(0).insertNode(document.createTextNode(p)):c.getRangeAt(0).insertNode(document.createTextNode(a)),c.collapseToEnd(),null===(o=he.current)||void 0===o||o.scrollToBottom(),st()}}},handleOnBeforeInput:function(e){var t;L&&!L(e)||(_e!==E?(Be(!1),Ne(!1),null===(t=he.current)||void 0===t||t.setGhostText(yu)):e.preventDefault())},handleOnInput:function(e){Ve(!1),st(),!M||M(e)},handleOnCompositionEnd:function(){at||(lt=!0)},handleOnFocusTextArea:function(){Ve(!1)},handleOnChatInputControlMount:z,handleOnChatInputControlUnmount:G}),m.a.createElement("span",{"aria-hidden":!0,onPaste:function(e){e.preventDefault()}},"‍")),m.a.createElement("div",{ref:ve},m.a.createElement(ag,{style:ft.chatInputButtons},m.a.createElement("div",{className:ft.chatInputLeftButtons},m.a.createElement("span",{contentEditable:!1,suppressContentEditableWarning:!1,className:ft.chatInputCharCount,"aria-live":"assertive"},_e,"/",E,_e>=E&&m.a.createElement("span",{className:ft.chatInputCharCountError},"Maximum character limit reached"))),m.a.createElement("div",{className:ft.chatInputRightButtons},H&&Q&&m.a.createElement(np,{title:V,isDisabled:n,isMenuOpen:Me,setMenuOpen:Be,positioningRef:me,promptGuideMenuProps:Q}),Y&&m.a.createElement(iu,{title:J,isDisabled:n,handleClick:function(){var e,t;null===(e=he.current)||void 0===e||e.updateInputText(Zc.a,Wu.a.InsertAtCursor),null===(t=he.current)||void 0===t||t.setGhostText(yu)}}),$&&te&&m.a.createElement(Fd,{title:wu(),isDisabled:n,isMenuOpen:Fe,setMenuOpen:Ne,targetRef:null==ve?void 0:ve.current,groundingButtonPluginProps:te,shouldBlockGroundingButtonClick:re}),(H&&Q||Y||$)&&m.a.createElement(ru.a,{vertical:!0,appearance:"strong"}),q&&m.a.createElement("span",{"aria-live":"assertive",role:"alert"},m.a.createElement(og,{"aria-live":"assertive",isDisabled:n,microphoneButtonProps:it})),m.a.createElement(pg,{title:R,isDisabled:n||o||0===_e,handleClick:function(e){var t,r,o;if(!ie||!ie()){e.stopPropagation(),xe&&tt(!1);var i=null===(t=he.current)||void 0===t?void 0:t.getInputText();if(i.trimStart()!==yu&&!n){var a=he.current?null==we?void 0:we.generateQueryAnnotations(he.current.getInputSpanElement()):void 0;F(i,a),null===(r=he.current)||void 0===r||r.setInputText(yu),null===(o=he.current)||void 0===o||o.setGhostText($e)}}}}))))))))})),fg=m.a.forwardRef((function(e,t){var n=e.isVersion3Enabled,o=void 0!==n&&n,i=Object(r.__rest)(e,["isVersion3Enabled"]);return o?m.a.createElement(Xp,Object(r.__assign)({},i,{ref:t})):m.a.createElement(hg,Object(r.__assign)({},i,{ref:t}))}));fg.displayName="ChatInput";var mg,vg=m.a.memo(fg),bg=n(207),yg=n(837),Cg=n(1158),Og=n(796),Sg=n(1139),Eg=n(3343),xg=n(485),Ig=n(325),wg=n(402),Tg=n(316),kg=n(721),jg=n(260),Pg=n(239),Ag=n(547),_g=n(17),Dg=n(52),Lg=null,Mg=null,Bg={},Rg=function(){function e(){}return e.getInstance=function(){return e.telemetryEventHandler||(e.telemetryEventHandler=new e),e.telemetryEventHandler},e.prototype.initTelemetryLatencyObject=function(){Lg=Object(Dg.l)()},e.prototype.initTelemetryChatEventObject=function(){Mg=Object(Dg.m)()},e.prototype.updateTelemetryLatencyData=function(e,t){null!=Lg&&(Object.keys(e).forEach((function(t){Lg[t]=e[t],Bg[t]=e[t]})),t&&this.sendTelemetryLatencyData(t))},e.prototype.updateTelemetryChatEventData=function(e,t){null===Mg&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(t){Mg[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)},e.prototype.updateTelemetryQueryDetailsEventData=function(e){Object.keys(e).forEach((function(t){Bg[t]=e[t]}))},e.prototype.sendTelemetryLatencyData=function(e){null!=e&&(e.logEvent(Object(Dg.i)(Lg)),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e))},e.prototype.sendTelemetryQueryDetailsObject=function(e){null==e||e.logEvent(Object(Dg.j)(Bg)),Bg={}},e.prototype.sendTelemetryChatEventData=function(e){if(null!=e){if(e.logEvent(Object(Dg.h)(Mg)),Mg[_g.g.ChatEventType]){var t=Object.keys(_g.f)[Object.values(_g.f).indexOf(Mg[_g.g.ChatEventType])];Bg[t]=0===Mg[_g.g.ChatEventParameters].length?"true":Mg[_g.g.ChatEventParameters]}this.initTelemetryChatEventObject()}},e}(),Fg=n(1086),Ng=n(48),Hg="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",Ug=function(){function e(){this.oTelLogger=new Fg.a,this.setupTelemetryLogger(this.oTelLogger),this.telemetryEventHandler=Rg.getInstance()}return e.getInstance=function(){return e.telemetryLogger||(e.telemetryLogger=new e),e.telemetryLogger},e.prototype.getDefaultEventFlags=function(){return{}},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logError=function(e,t){var n;this.logTelemetryErrorEvent(e,t),this.telemetryEventHandler.updateTelemetryQueryDetailsEventData(((n={})[_g.l.ErrorCategory]=e.eventType,n[_g.l.ErrorMessage]=e.errorMessage,n))},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:{ariaTenantToken:Hg,nexusTenantToken:1763},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Object(r.__assign)(Object(r.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)},e.prototype.logTelemetryErrorEvent=function(e,t){var n={eventName:"Office.Voice.ActionAI."+Ag.a.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Object(r.__assign)(Object(r.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:"CopilotChatSessionId",value:jg.a.getSessionId()}])};this.oTelLogger.sendError(n)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?Ng.b(e.key,e.value):"string"==typeof e.value?Ng.d(e.key,e.value):"boolean"==typeof e.value?Ng.a(e.key,e.value):Ng.d(e.key,e.value)}),[])},e.prototype.setupTelemetryLogger=function(e){e.setTenantToken("Office.Voice.ActionAI",Hg,1763)},e}(),Vg=n(44),zg=n(75),Gg=Object(r.__assign)(Object(r.__assign)({},cd.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),Wg=(Object(r.__assign)(Object(r.__assign)({},ud.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(ad.a)({10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"})),Qg=n(357),qg=n(1593),Kg=n(323),Yg=n(1009),Zg=n(399),Jg=function(e,t,n,o,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(){return{sections:p.menuProps.sections.map((function(e){return{sectionHeader:e.sectionHeader,showSectionTopDivider:e.showSectionTopDivider,starterPrompts:e.starterPrompts.map((function(e){return{text:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover}}))}})),handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem}},this.handleOnClickMenuItem=function(e){return Object(r.__awaiter)(p,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e,n=Vg.w,Object(Zg.b)(Vg.w),this.loggingEventHandler.sendLoggingEventToClient(Pg.g.MenuButtonItemClicked,{suggestionClicked:e}),this.isFreVisible&&this.setFreVisible(!1),e.endsWith(Vg.v)?[4,this.setChatInputStateExpanded()]:[3,2];case 1:r.sent(),t=t.slice(0,-Vg.v.length)+" ",r.label=2;case 2:return(null==(o=this.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:o.inputAreaText)&&(t=o.inputAreaText),this.immediateActionableQueries[e]?(null===(i=this.chatInputRef.current)||void 0===i||i.setInputText(Vg.w),null===(a=this.chatInputRef.current)||void 0===a||a.setGhostText(this.chatPlaceholderMessage),this.handleSubmit({text:t,telemetryData:_g.f.MenuItemClicked}),[3,8]):[3,3];case 3:return(null==o?void 0:o.copilotPromptLab)&&(null==o?void 0:o.copilotPromptLab.shouldOpenCopilotPromptLab)?this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(zg.h.IsSharedCopilotLabEnabled)?[4,Object(Yg.b)()]:[3,5]:[3,7];case 4:return r.sent(),[3,6];case 5:null==o||o.copilotPromptLab.launchCopilotPromptLab(),r.label=6;case 6:return[3,8];case 7:e===this.transformFileSuggestionText&&this.chatEditor&&(n=this.transformFilePlaceholderText),this.updateHintCard(e),null===(s=this.chatInputRef.current)||void 0===s||s.setInputText(t),null===(l=this.chatInputRef.current)||void 0===l||l.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Zc.a,Wu.a.InsertAtCursor)}),1),null===(c=this.chatInputRef.current)||void 0===c||c.setGhostText(n),r.label=8;case 8:return Object(Dg.c)("Suggestion clicked: "+e),[2]}}))}))},this.generateQueryMap=function(){var e={};p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e[t.suggestionText]=t.shouldSubmitQueryOnClick}))})),p.immediateActionableQueries=e},this.generatePromptSuggestionList=function(){var e=[];p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e.push(t)}))})),p.promptSuggestionList=e},this.getTransformFileSuggestionText=function(){var e,t,n,o;try{for(var i=Object(r.__values)(p.menuProps.sections),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(n=void 0,Object(r.__values)(s.starterPrompts)),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.shouldLaunchCIQOnSelection)return u.suggestionText}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return Vg.w},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=o,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=s,this.chatPlaceholderMessage=u,this.generateQueryMap(),this.generatePromptSuggestionList(),this.updateHintCard=d,this.isFreVisible=i,this.setFreVisible=a,this.loggingEventHandler=Kg.a.getInstance(),this.copilotCommunicationHandler=l,this.setChatInputStateExpanded=c};!function(e){e.Backspace="Backspace",e.Escape="Escape",e.Delete="Delete",e.V="V"}(mg||(mg={}));var Xg,$g=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){var m=this;this.handleOnInput=function(e){var t;return m.isFreVisible&&m.setFreVisible(!1),(null===(t=m.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Vg.w&&(m.updateHintCard(Vg.w),Object(Zg.b)(Vg.w),m.loggingEventHandler.sendLoggingEventToClient(Pg.g.InputAreaTextChangedToEmpty)),!0},this.getProps=function(e,t){var n={isDisabled:m.isDisabled,placeholderText:m.chatPlaceHolderMessage,isMenuButtonEnabled:!0,maxInputCharLimit:Vg.G,handleSubmitButtonClick:function(e){var t;m.loggingEventHandler.sendLoggingEventToClient(Pg.g.SubmitButtonClicked);var n=m.chatInputRef.current?null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement()):void 0;m.handleSubmit({text:e,links:n,telemetryData:_g.f.SubmitButtonClicked})},handleKeyDown:function(e){var t,n=m.chatInputRef.current;if(!n)return!1;var r=n.getInputText(),o=n.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===mg.V)n.setGhostText(Vg.w);else{if("Enter"===e.key){if(e.preventDefault(),r.trimStart()===Vg.w)return!1;var i=null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement());return n.setInputText(Vg.w),n.setGhostText(m.chatPlaceHolderMessage),m.handleSubmit({text:r,links:i}),!1}e.key===mg.Backspace?m.chatEditor&&r.length>1&&Object(Dg.v)()&&Object(Dg.f)()===r.length&&r.slice(-1)===Zc.a?(m.updateHintCard(m.menuBuilder.getTransformFileSuggestionText()),n.setGhostText(Zc.a+m.ciqPlaceholderText)):0!==Object(Dg.f)()&&o!==Vg.w&&n.setGhostText(Vg.w):(e.key===mg.Escape||e.key===mg.Delete&&Object(Dg.f)()!==r.length&&o!==Vg.w)&&n.setGhostText(Vg.w)}return!0},handleOnChatInputControlMount:function(){m.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){m.setChatInputControlMounted(!1)},menuProps:m.menuBuilder.getMenuProps(),handleOnInput:m.handleOnInput,microphoneProps:m.microphoneButtonProps,handleOnBlur:e,chatInputBannerProps:t};return n},this.chatInputRef=e,this.isDisabled=t,this.handleSubmit=i,this.isFreVisible=n,this.setFreVisible=r,this.updateHintCard=a,this.chatPlaceHolderMessage=h,this.transformFilePlaceholderText=c,this.ciqPlaceholderText=u,this.updateHintCard=a,this.ciqResponseHandler=p,this.copilotCommunicationHandler=g,this.menuBuilder=new Jg(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a),this.chatEditor=s,this.setChatInputControlMounted=d,this.microphoneButtonProps=f,this.loggingEventHandler=Kg.a.getInstance()},eh=n(171),th=function(e,t,n,o,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(e){var t={promptGuideMenuData:p.menuProps.promptGuideMenuData,copilotLabProps:p.menuProps.copilotLabProps,handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem,handleOnClickPromptGuideMenuButtonTelemetry:p.handleOnClickMenuButtonTelemetry,shouldBlockPromptGuideLaunch:p.shouldBlockPromptGuideLaunch};return p.copilotCommunicationHandler.isFeatureGateEnabledFromClient(zg.h.IsSharedCopilotLabEnabled)&&(!p.menuProps.copilotLabProps&&e.length>0&&(p.menuProps.copilotLabProps={copilotLabMenuItemText:Object(Vg.V)(),iconRegular:ou.i,iconHover:ou.h}),p.menuProps.copilotLabProps&&(p.menuProps.copilotLabProps.handleOnClickCopilotLab=function(e){return Object(r.__awaiter)(p,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(Yg.b)(e)];case 1:return t.sent(),[2]}}))}))})),t},this.shouldBlockPromptGuideLaunch=function(){return p.setPaneLoadMessageIfApplicable(zg.d.PromptGuide)},this.handleOnClickMenuButtonTelemetry=function(){p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MenuButtonClicked}])},this.handleOnClickMenuItem=function(e,t,n){var r,o,i,a,s,l=e,c=Vg.w;if(!t)return p.loggingEventHandler.sendLoggingEventToClient(Pg.g.MenuButtonItemClickedL1,{suggestionClicked:e}),void p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MenuL1SuggestionClicked},{key:_g.g.ChatEventParameters,value:e}]);Object(Zg.b)(Vg.w),p.loggingEventHandler.sendLoggingEventToClient(Pg.g.MenuButtonItemClicked,{suggestionClicked:e}),p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MenuL2SuggestionClicked}]),p.isFreVisible&&p.setFreVisible(!1),e.endsWith(Vg.v)&&(l=l.slice(0,-Vg.v.length)+" "),p.immediateActionableQueries[e]?(null===(r=p.chatInputRef.current)||void 0===r||r.setInputText(Vg.w),null===(o=p.chatInputRef.current)||void 0===o||o.setGhostText(p.chatPlaceholderMessage),p.handleSubmit({text:l})):(p.updateHintCard(e),n&&(l=l.replace(/ *\([^)]*\)/,Vg.O),c=p.transformFilePlaceholderText),l=l.replace(/ *\[[^\]]*]/,Vg.w),n||(l+=" "),n&&p.chatEditor&&p.chatEditor.setCurrentScope(n),null===(i=p.chatInputRef.current)||void 0===i||i.setInputText(l),null===(a=p.chatInputRef.current)||void 0===a||a.setFocus(),n&&p.chatEditor&&setTimeout((function(){var e;return null===(e=p.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Zc.a,Wu.a.InsertAtCursor)}),1),null===(s=p.chatInputRef.current)||void 0===s||s.setGhostText(c)),Object(Dg.c)("Suggestion clicked: "+e)},this.generateQueryMap=function(){var e,t={};null===(e=p.menuProps.promptGuideMenuData.children)||void 0===e||e.forEach((function(e){var n;null===(n=e.children)||void 0===n||n.forEach((function(e){var n;"ActionSet"===e.nodeType&&(t[e.text]=null===(n=e.data)||void 0===n?void 0:n.shouldSubmitQueryOnClick)}))})),p.immediateActionableQueries=t},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=o,this.chatPlaceholderMessage=c,this.generateQueryMap(),this.updateHintCard=u,this.isFreVisible=i,this.setFreVisible=a,this.transformFilePlaceholderText=l,this.copilotCommunicationHandler=s,this.loggingEventHandler=Kg.a.getInstance(),this.telemetryLoggerUtils=eh.a.getInstance(),this.setPaneLoadMessageIfApplicable=d},nh=n(448),rh=function(e,t,n,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L){var M,B,R=this;this.handleOnInput=function(e){var t;return R.isFreVisible&&R.setFreVisible(!1),(null===(t=R.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Vg.w&&(R.updateHintCard(Vg.w),Object(Zg.b)(Vg.w),R.loggingEventHandler.sendLoggingEventToClient(Pg.g.InputAreaTextChangedToEmpty)),!0},this.getGroundingSourcePickerProps=function(){if(R.groundingSourcePickerProps)return Object(r.__assign)(Object(r.__assign)({},R.groundingSourcePickerProps),{onSelection:function(e){Object(nh.c)(e.id),R.groundingSourcePickerProps.onSelection&&R.groundingSourcePickerProps.onSelection(e)}})},this.getProps=function(e,t){var n,r,o=null===(n=R.editorProps)||void 0===n?void 0:n.editorConfig;o&&void 0===o.ciqPlaceholderText&&(R.editorProps.editorConfig.ciqPlaceholderText=R.ciqPlaceholderText);var i={isDisabled:R.isExecuting,isSubmitButtonDisabled:R.isSubmitButtonDisabled,copilotChatTheme:R.copilotTheme,isDarkMode:R.isDarkModeEnabled,dir:R.dir,placeholderText:R.chatPlaceHolderMessage,isMenuButtonEnabled:!0,isCIQButtonEnabled:R.isCIQButtonEnabled,isGroundingButtonEnabled:R.isGroundingButtonEnabled,isVersion3Enabled:R.isVersion3Enabled,characterLimitErrorMessage:R.characterLimitErrorMessage,maxInputCharLimit:Vg.D,handleSubmitButtonClick:function(e,t){var n,r,o,i=t;R.loggingEventHandler.sendLoggingEventToClient(Pg.g.SubmitButtonClicked);var a=R.chatInputRef.current?null===(n=R.ciqResponseHandler)||void 0===n?void 0:n.generatCopilotOdslSignalLinks(R.chatInputRef.current.getInputSpanElement()):void 0;(null===(r=R.editorProps)||void 0===r?void 0:r.handleInChatInput)||(i=R.chatInputRef.current?null===(o=R.ciqResponseHandler)||void 0===o?void 0:o.generateQueryAnnotations(R.chatInputRef.current.getInputSpanElement()):void 0),R.handleSubmit({text:e,links:a,telemetryData:_g.f.SubmitButtonClicked,queryAnnotations:i})},handleKeyDown:function(e){var t,n,r=R.chatInputRef.current;if(!r)return!1;var o=null==r?void 0:r.getInputText(),i=null==r?void 0:r.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===mg.V)null==r||r.setGhostText(Vg.w);else{if("Enter"===e.key){if(e.preventDefault(),R.shouldBlockSubmitButtonClick())return;if(R.isSubmitButtonDisabled||R.isExecuting)return!1;if(e.shiftKey)return!0;if(o.trimStart()===Vg.w)return!1;var a=null===(t=R.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(R.chatInputRef.current.getInputSpanElement()),s=R.chatInputRef.current?null===(n=R.ciqResponseHandler)||void 0===n?void 0:n.generateQueryAnnotations(R.chatInputRef.current.getInputSpanElement()):void 0;return null==r||r.setInputText(Vg.w),null==r||r.setGhostText(R.chatPlaceHolderMessage),R.handleSubmit({text:o,links:a,queryAnnotations:s}),!1}e.key===mg.Backspace?R.chatEditor&&o.length>1&&Object(Dg.v)()&&Object(Dg.f)()===o.length&&o.slice(-1)===Zc.a?null==r||r.setGhostText(Zc.a+R.ciqPlaceholderText):0!==Object(Dg.f)()&&i!==Vg.w&&(null==r||r.setGhostText(Vg.w)):(e.key===mg.Escape||e.key===mg.Delete&&Object(Dg.f)()!==o.length&&i!==Vg.w)&&(null==r||r.setGhostText(Vg.w))}return!0},handleOnBeforeInput:function(e){var t=R.chatInputRef.current;return!(!t||e.data===Zc.a&&R.chatEditor&&(null==t||t.setGhostText(R.ciqPlaceholderText),1))},handleOnChatInputControlMount:function(){R.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){R.setChatInputControlMounted(!1)},promptGuideMenuProps:null===(r=R.menuBuilder)||void 0===r?void 0:r.getMenuProps(e),handleOnInput:R.handleOnInput,voiceInputProps:R.voiceInputProps,groundingSourcePickerProps:R.getGroundingSourcePickerProps(),groundingButtonPluginProps:R.groundingButtonPluginProps,shouldBlockGroundingButtonClick:R.shouldBlockGroundingButtonClick,shouldBlockSubmitButtonClick:R.shouldBlockSubmitButtonClick,handleFirstUserInput:R.handleFirstUserInput,handleChatInputLoad:R.handleChatInputLoad,editorProps:R.editorProps,isSensitivityIndicatorLoading:R.isSensitivityIndicatorLoading,imageInputEnabled:R.imageInputEnabled,isHVCAppChatV2Enabled:R.enableHVCAppChatV2,hvcPromptStrings:R.hvcPromptStrings,hvcPromptStringsList:R.hvcPromptStringsList,useSortedHVCTokenList:R.useSortedHVCTokenList,chatInputBannerProps:t,onChatInputHVCPromptUpdated:R.onChatInputHVCPromptUpdated};return i},this.shouldBlockGroundingButtonClick=function(){return R.setPaneLoadMessageIfApplicable(zg.d.GroundingButton)},this.shouldBlockSubmitButtonClick=function(){return R.setPaneLoadMessageIfApplicable(zg.d.SubmitButton)},this.handleFirstUserInput=function(){eh.a.getInstance().sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.FirstUserInputReceived},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}])},this.handleChatInputLoad=function(){eh.a.getInstance().sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatInputLoaded},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}])},this.chatInputRef=e,this.copilotTheme=t,this.isDarkModeEnabled=n,this.dir=o,this.isExecuting=i,this.isSubmitButtonDisabled=a,this.handleSubmit=d,this.isFreVisible=s,this.setFreVisible=l,this.copilotCommunicationHandler=c,this.updateHintCard=p,this.chatPlaceHolderMessage=b,this.ciqPlaceholderText=f,this.ciqResponseHandler=v,this.loggingEventHandler=Kg.a.getInstance(),this.setPaneLoadMessageIfApplicable=x,this.menuBuilder=u?new th(u,e,d,g,s,l,this.copilotCommunicationHandler,h,this.chatPlaceHolderMessage,p,this.setPaneLoadMessageIfApplicable):void 0,this.chatEditor=g,this.setChatInputControlMounted=m,this.voiceInputProps=y,this.isCIQButtonEnabled=C,this.isGroundingButtonEnabled=O,this.groundingSourcePickerProps=S;var F=null!==(B=null===(M=null==E?void 0:E.plugins)||void 0===M?void 0:M.map((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{onToggle:function(t){Object(nh.c)("".concat(e.id,":").concat(t?"On":"Off")),e.onToggle&&e.onToggle(t)}})})))&&void 0!==B?B:[];this.groundingButtonPluginProps=Object(r.__assign)(Object(r.__assign)({},E),{plugins:F}),this.editorProps=I,this.isSensitivityIndicatorLoading=w,this.isVersion3Enabled=T,this.characterLimitErrorMessage=k,this.imageInputEnabled=j,this.enableHVCAppChatV2=null!=P&&P,this.hvcPromptStrings=A,this.hvcPromptStringsList=_,this.useSortedHVCTokenList=L,this.onChatInputHVCPromptUpdated=D},oh=function(e,t,n,r,o,i,a,s,l,c,u,d){var p=this;this.handleClick=function(){},this.getProps=function(e){return{chatInputRestShyPlaceholder:p.chatPlaceHolderMessage,isDisabled:p.isDisabled,isMenuButtonEnabled:!0,handleMenuButtonClick:p.handleClick,menuProps:p.menuBuilder.getMenuProps(),handleClickAndUnMount:e}},this.isDisabled=t,this.handleSubmit=i,this.chatPlaceHolderMessage=d,this.transformFilePlaceholderText=c,this.copilotCommunicationHandler=u,this.menuBuilder=new Jg(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a)},ih=function(){function e(){}return e.prototype.getProps=function(e,t){return{headerText:t.headerText,descriptionText:t.descriptionText,freImagePath:t.freImagePath,handleFreButtonClick:function(){e()},hideGetStartedButton:t.hideGetStartedButton}},e}(),ah=function(){function e(e){var t;this.promptSuggestionHintCardMap=null!==(t=null==e?void 0:e.promptSuggestionHintCardMap)&&void 0!==t?t:{}}return e.prototype.shouldShowHintCard=function(e){return!!this.promptSuggestionHintCardMap[e]},e.prototype.getProps=function(e){var t={headerText:Vg.w,descriptionText:Vg.w};if(this.promptSuggestionHintCardMap[e]){var n=this.promptSuggestionHintCardMap[e].descriptionTextList;t.headerText=this.promptSuggestionHintCardMap[e].headerText,t.descriptionText=n[Math.floor(Math.random()*n.length)]}return t},e}(),sh=function(){return[Object(Vg.wb)(),Object(Vg.qb)(),Object(Vg.nb)(),Object(Vg.sb)(),Object(Vg.ob)(),Object(Vg.kb)(),Object(Vg.pb)(),Object(Vg.mb)()]},lh=function(){return[Object(Vg.rb)(),Object(Vg.lb)()]},ch=function(){function e(){}return e.prototype.getProps=function(e,t){return{loadingUiStrings:e.loadingUiStringList,stringChangeIntervalDuration:e.stringChangeIntervalDuration,showStopButton:e.showStopGeneratingButton,showInlineStopButton:e.showInlineStopGeneratingButton,handleStopButtonOnClick:t}},e}(),uh=n(125),dh=n(159),ph=function(){function e(e,t,n,r,o,i){var a=this;this.isCitationsSupportEnabled=!1,this.executeSuggestionPill=function(e){var t,n;if(null===(t=a.chatInputRef.current)||void 0===t||t.setInputText(Vg.w),null===(n=a.chatInputRef.current)||void 0===n||n.setGhostText(a.chatPlaceHolderMessage),!a.isCitationsSupportEnabled&&e in a.suggestedQnAsList)a.setSuggestionClickChatCardsFromCacheSuggestion(e,a.suggestedQnAsList[e]),a.setCachedSuggestionPillList(a.getSuggestionPillListFromCache());else if(a.isCitationsSupportEnabled&&e in a.suggestedQnAListV2){var r=a.suggestedQnAListV2[e],o=r.answer,i=r.citations;a.setSuggestionClickChatCardsFromCacheSuggestion(e,o,i),a.setCachedSuggestionPillList(a.getSuggestionPillListFromCache())}else a.handleSubmit({text:e,telemetryData:_g.f.SuggestionPaneSuggestionClicked})},this.chatInputRef=e,this.handleSubmit=t,this.chatPlaceHolderMessage=n,this.setChatMessage=r,this.loggingEventHandler=Kg.a.getInstance(),this.suggestedQnAsList={},this.suggestedQnAListV2={},this.isCitationsSupportEnabled=i,this.setCachedSuggestionPillList=o,this.telemetryLoggerUtils=eh.a.getInstance()}return e.prototype.setSuggestedQnAListV2=function(e){var t=this;this.suggestedQnAListV2={},e.forEach((function(e){t.suggestedQnAListV2[e.question]={answer:e.answer,citations:e.citations}})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],_g.p,_g.i.ChatQnA,_g.m.QAandSummaries,_g.o.Ask,_g.n.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.setSuggestedQnAList=function(e){var t=this;if(this.isCitationsSupportEnabled)return this.setSuggestedQnAListV2(e);this.suggestedQnAsList={},e.forEach((function(e){t.suggestedQnAsList[e.question]=e.answer})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],_g.p,_g.i.ChatQnA,_g.m.QAandSummaries,_g.o.Ask,_g.n.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.getSuggestedQnAsList=function(){return this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList)},e.prototype.getSuggestionPillListFromCache=function(){var e=this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList);return(e=Object(dh.f)(e)).slice(0,2)},e.prototype.setSuggestionClickChatCardsFromCacheSuggestion=function(e,t,n){var r,o=Object(xg.a)();this.telemetryLoggerUtils.setUserQueryGuid(o),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.SuggestionPaneSuggestionClicked}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.QuerySubmittedByUser}]),this.setChatMessage(a.a.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),this.setChatMessage(a.a.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:fr.a.Footer,isFailure:!1,actionButtonList:[uh.a.getInstance().getCopyButton()],references:n?uh.a.getInstance().getMarkdownReferences(n):void 0,feedbackData:uh.a.getInstance().getFeedbackData(),clpSensitivityIndicatorData:null===(r=uh.a.getInstance().getBasicChatProps())||void 0===r?void 0:r.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:o,featureName:_g.i.ChatQnA})}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.CachedBasicChatResponseShown},{key:_g.g.IsFromCache,value:!0}]),this.telemetryLoggerUtils.logTriedEvent([],_g.p,_g.i.ChatQnA,_g.m.QAandSummaries,void 0,_g.o.Ask,_g.n.BasicChat),this.telemetryLoggerUtils.setUserQueryGuid(Vg.w)},e.prototype.getProps=function(e,t){var n=this,o={suggestionList:e.suggestionList.length>0?e.suggestionList:t,showRefreshButton:null==e?void 0:e.showRefreshButton,handleSuggestionPillClick:function(e){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return this.loggingEventHandler.sendLoggingEventToClient(Pg.g.SuggestionPillClicked,{suggestionClicked:e}),Object(Zg.b)(Vg.w),this.executeSuggestionPill(e),Object(Dg.c)(e,"officeaicopilot-chat: onClickSuggestionPill"),[2]}))}))},handleRefreshButtonClick:function(){return Object(r.__awaiter)(n,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return this.getSuggestedQnAsList().length>0?(this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache()),this.telemetryLoggerUtils.logSeenEvent([],_g.p,_g.i.ChatQnA,_g.m.QAandSummaries,_g.o.Ask,_g.n.BasicChat)):null===(t=null==e?void 0:e.onRefreshButtonClicked)||void 0===t||t.call(e),Object(Dg.c)("officeaicopilot-chat: onClickRefreshButton"),[2]}))}))}};return o},e}(),gh=ph,hh=function(){function e(e,t,n,o,i,a,s,l,c){var u=this;this.getTransformFileSuggestionText=function(){var e,t;if(u.zqmProps)try{for(var n=Object(r.__values)(u.zqmProps.promptSuggestionList),o=n.next();!o.done;o=n.next()){var i=o.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Vg.w},this.chatInputRef=e,this.handleSubmit=t,this.updateHintCard=n,this.isExecuting=o,this.chatEditor=i,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=a,this.setChatInputStateExpanded=s,this.telemetryLoggerUtils=eh.a.getInstance(),this.isHVCAppChatV2Enabled=null!=l&&l,this.hvcPromptStringsList=null!=c?c:[]}return e.prototype.handleZQMButtonClick=function(e){var t,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.isExecuting?[2]:(Object(Zg.b)(Vg.w),Kg.a.getInstance().sendLoggingEventToClient(Pg.g.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ZQMButtonClicked}]),i=e,a=Vg.w,e.endsWith(Vg.v)?[4,this.setChatInputStateExpanded()]:[3,2]);case 1:r.sent(),i=i.slice(0,-Vg.v.length)+" ",r.label=2;case 2:return(null==(s=this.zqmProps.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:s.inputAreaText)&&(i=s.inputAreaText),(null==s?void 0:s.shouldSubmitQueryOnClick)?[4,this.handleSubmit({text:i,telemetryData:_g.f.ZQMButtonClicked})]:[3,4];case 3:return r.sent(),[2];case 4:return this.updateHintCard(e),e===this.transformFileSuggestionText&&(a=this.transformFilePlaceholderText),e===this.transformFileSuggestionText&&this.chatEditor&&this.chatEditor.setCurrentScope(Pg.e.File),null===(t=this.chatInputRef.current)||void 0===t||t.setInputText(i),null===(n=this.chatInputRef.current)||void 0===n||n.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=l.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Zc.a,Wu.a.InsertAtCursor)}),1),null===(o=this.chatInputRef.current)||void 0===o||o.setGhostText(a),[2]}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{headerText:this.zqmProps.headerText,promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestion:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t}})),handleButtonClick:this.handleZQMButtonClick,isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,hvcPromptStringsList:this.hvcPromptStringsList}},e}(),fh=function(){function e(){}return e.prototype.getTrySydneyProps=function(e,t,n){return{checked:e.trySydneyToggleChecked,disabled:t,onChange:e.trySydneyToggleOnChange,label:n}},e.prototype.getTryEnterpriseSearchProps=function(e,t,n){return{checked:e.tryEnterpriseSearchToggleChecked,disabled:t,onChange:e.tryEnterpriseSearchToggleOnChange,label:n}},e.prototype.getTryWebChatProps=function(e,t,n){return{checked:e,onChange:t,label:n,disabled:!1}},e.prototype.getTryReviewerAgentProps=function(e,t,n){return{checked:e.tryReviewerAgentToggleChecked,disabled:t,onChange:e.tryReviewerAgentToggleOnChange,label:n}},e}(),mh=n(829),vh=function(e,t,n,o,i,a,s,l,c){var u=this;this.isExecuting=!1,this.addResponseMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0===o||o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");u.chatContainerbuilder.setChatMessageData(t,n,r,p,u.getIsExecuting),s&&wg.a.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.updateLastMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;u.chatContainerbuilder.updateLastMessage(t,n,r,p),s&&wg.a.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.resendChatHistorySignal=function(e,t){Object(mh.e)(e,t)},this.updateMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;(null==r?void 0:r.messageId)?(u.chatContainerbuilder.updateMessage(t,n,r,p),s&&wg.a.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)):(Object(Dg.c)("updateMessage: messageId is missing in chatMessageBodyData"),u.addResponseMessage({chatCardType:t,chatMessageData:n,chatMessageBodyData:r,stopLoadingUi:i,startAugloopTimerForStreaming:s,workflowAnnotationTypeForAugloopTimer:c,addCardToChatHistory:p}))},this.deleteMessage=function(e){var t=e.chatCardType,n=e.messageIdToDelete;u.chatContainerbuilder.deleteMessage(t,n)},this.submitOperation=function(e){var t=e.operation,n=e.workflowAnnotationType;return Qg.a.getInstance().isWorkflowRegistered(n)&&Qg.a.getInstance().isAugloopResponseTimeoutRequired(n)&&wg.a.getInstance().setAugloopResponseTimer(n),Object(Dg.c)("operation submitted",t),Ig.a.getInstance().submitOperation(t,n),!0},this.updateLoadingComponentProps=function(e){u.setLoadingComponentProps((function(t){return Object(r.__assign)(Object(r.__assign)({},t),e)}))},this.addChatMessages=function(e,t){void 0===t&&(t=!0),u.chatContainerbuilder.addChatMessages(e),t&&u.setIsExecuting(!1)},this.getLastMessage=function(e){return u.chatContainerbuilder.getLastMessage(e)},this.clearMessages=function(){u.chatContainerbuilder.clearMessages()},this.startLoadingUi=function(){u.setIsExecuting(!0)},this.startReinitializeALSession=function(){u.setShouldReinitializeALSession(!0)},this.getInputText=function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.getInputText()},this.setInputAreaText=function(e){var t,n,r;Object(Dg.c)("setInputAreaText",e);var o=e,i=Object(Dg.s)(e),a=i.inputSpanText,s=i.isFileEntityPresent;o=a,Object(Dg.c)("inputSpanText: ".concat(a,", isFileEntityPresent:"),s);var l=Vg.w;a.endsWith(Vg.v)&&(o=a.slice(0,-Vg.v.length)+" "),s&&(l=u.ciqPlaceholderText?u.ciqPlaceholderText:Object(Vg.Y)()),null===(t=u.chatInputRef.current)||void 0===t||t.setInputText(o),null===(n=u.chatInputRef.current)||void 0===n||n.setFocus(),s&&u.getChatEditor()&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Zc.a,Wu.a.InsertAtCursor)}),1),null===(r=u.chatInputRef.current)||void 0===r||r.setGhostText(l)},this.submitUserQuery=function(e){var t=e.text,n=e.links,r=e.telemetryData,o=e.queryAnnotations;Object(Dg.c)("submitUserQuery called for query: ",t),u.isExecuting||u.isDisabled?Object(Dg.c)("Returning from submitting Query because isExecuting is: ".concat(u.isExecuting," and isDisabled is: ").concat(u.isDisabled)):u.handleSubmit({text:t,links:n,telemetryData:r,queryAnnotations:o})},this.setInputFocus=function(){var e;Object(Dg.c)("setInputFocus"),u.isDisabled||null===(e=u.chatInputRef.current)||void 0===e||e.setFocus()},this.setIsDisabled=function(e){Object(Dg.c)("setIsDisabled",e),u.isDisabled=e},this.setLocalIsExecuting=function(e){u.isExecuting=e},this.getIsExecuting=function(){return u.isExecuting},this.setIsExecuting=e,this.chatContainerbuilder=o,this.handleSubmit=n,this.setLoadingComponentProps=t,this.chatInputRef=i,this.getChatEditor=a,this.isDisabled=c,this.setShouldReinitializeALSession=s,this.ciqPlaceholderText=l},bh=Object(G.a)(Gg),yh={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:bh.themeBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:bh.themeBackground},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:bh.colorNeutralStroke1Selected},W.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:bh.colorNeutralForeground3},W.a.borderRadius("20px")),W.a.border("2px","solid",bh.colorNeutralBackground2Hover)),{":hover":{backgroundColor:bh.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:bh.colorNeutralBackground2Hover},W.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:bh.colorNeutralStroke1Selected},W.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:bh.colorNeutralForeground3},W.a.borderRadius("20px")),W.a.border("2px","solid",bh.colorNeutralBackground2Hover)),{":hover":{backgroundColor:bh.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:bh.colorNeutralBackground2Hover},W.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:bh.themeBackground},incomingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},W.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),W.a.margin("10px")),outgoingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},W.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),W.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),W.a.border("1px","solid","rgba(230, 230, 230, 1)")),W.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",backgroundColor:bh.colorNeutralBackground1,opacity:"0.6"}),outgoingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),W.a.border("1px","solid","rgba(230, 230, 230, 1)")),W.a.margin(0,"16px")),{height:"124px",backgroundColor:bh.colorNeutralBackground1,opacity:"0.8"})},Ch={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:Q.a.colorNeutralBackground1},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:Q.a.colorNeutralBackground1},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralStroke1Selected},W.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralForeground3},W.a.borderRadius("20px")),W.a.border("2px","solid",Q.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Q.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground2Hover},W.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralStroke1Selected},W.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Q.a.colorNeutralForeground3},W.a.borderRadius("20px")),W.a.border("2px","solid",Q.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Q.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:Q.a.colorNeutralBackground2Hover},W.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:Q.a.colorNeutralBackground1},incomingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},W.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),W.a.margin("10px")),outgoingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},W.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),W.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),W.a.border("1px","solid","rgba(230, 230, 230, 1)")),W.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Q.a.colorNeutralBackground1}),outgoingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},W.a.borderRadius("8px")),W.a.border("1px","solid","rgba(230, 230, 230, 1)")),W.a.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:Q.a.colorNeutralBackground1})},Oh=Object(y.a)(yh),Sh=Object(y.a)(Ch),Eh=function(e,t){if(t)for(var n in e)e[n]=Object(C.a)(e[n],t[n]);return e},xh=0,Ih=function(){function e(e,t,n,o,i,a,s,l,c,u,d,p,g){var h=this;this.onTryAgainClicked=function(){xh=(new Date).getTime(),Object(tu.b)(h.isMicrophoneListening,Vg.r,h.setShouldShowMicrophonePermissionRetryDialog,h.setMicrophoneState,h.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(r.__awaiter)(h,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u,d,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=eh.a.getInstance(),this.setPaneLoadMessageIfApplicable(zg.d.Microphone))return[2];null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),this.isMicrophoneListening?(t.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophonePauseClicked}]),(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=Vg.w&&(null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())!=this.chatPlaceHolderMessage&&(null===(l=null===(s=this.chatInputRef.current)||void 0===s?void 0:s.getGhostText())||void 0===l?void 0:l.trim())!=Object(Vg.tb)()&&(null===(c=this.chatInputRef.current)||void 0===c||c.setInputText((null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getInputText())+(null===(d=this.chatInputRef.current)||void 0===d?void 0:d.getGhostText())),null===(p=this.chatInputRef.current)||void 0===p||p.setGhostText("")),[4,Object(tu.d)(this.setMicrophoneListeningStatus)]):[3,3];case 2:return r.sent(),Object(Dg.c)("Microphone Paused"),[3,6];case 3:return t.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophonePlayClicked}]),this.microphoneState===zl.Uninitialized&&this.setMicrophoneState(zl.Loading),xh=(new Date).getTime(),[4,Gp.a.GetInstance().Resume()];case 4:return r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(zl.Enabled),[4,Object(tu.e)(Vg.r,this.setMicrophoneListeningStatus)];case 5:r.sent(),Object(Dg.c)("Microphone Resumed"),r.label=6;case 6:return[3,10];case 7:return n=r.sent(),o="Error occurred while fetching mic permissions - : ".concat(n),Object(Dg.c)(o),null==Cm||Cm.logError({eventType:Ag.a.Microphone,errorMessage:o}),"ErrorAudioPermissionDeniedError"!=n?[3,9]:[4,Gp.a.GetInstance().Pause()];case 8:r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),t.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophonePermissionDenied}]),r.label=9;case 9:return this.setMicrophoneState(zl.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=o,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p,this.setPaneLoadMessageIfApplicable=g}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}(),wh=n(1129),Th=n(697),kh=function(e,t,n,r,i){var s,l,c,u,d,p,g,h=null==e?void 0:e.body,f=null==h?void 0:h.answer,m=null==h?void 0:h.error,v=null==h?void 0:h.aiResponse,b=null==h?void 0:h.status,y=null==h?void 0:h.isBasicChat,C=null==h?void 0:h.queryId,O=null==h?void 0:h.citation,S=eh.a.getInstance(),E=Object(Th.b)(null==h?void 0:h.featureType);if(uh.a.getInstance().setFeatureName(E),S.setUserQueryGuid(C),uh.a.getInstance().setQueryID(C),uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Started,workflowAnnotationType:Og.a.getTypeName(),queryID:C,responseTime:Pm(r)}),S.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ResponseReceivedFromAL},{key:_g.g.ChatEventParameters,value:Og.a.getTypeName()},{key:_g.g.UserQueryGuid,value:C},{key:_g.g.Cv,value:i}]),S.logTriedEvent([{key:_g.q,value:C}],_g.p,E,Object(Th.c)(E),void 0,Object(Th.d)(E),Object(Th.a)(E)),S.sendTelemetryLatencyData([{key:_g.k.FeatureName,value:E}]),uh.a.getInstance().sendLoggingEventToClient(Pg.g.AugloopResponseReceived,{annotationName:Og.a.getTypeName(),timeInMs:Pm(r)}),Qg.a.getInstance().isAugloopResponseTimeoutRequired(null===(s=null==h?void 0:h.H_)||void 0===s?void 0:s.T_)&&wg.a.getInstance().clearAugloopResponseTimer(),!Object(dh.d)(m)&&!Object(dh.d)(null==m?void 0:m.category))return Object(wh.a)(m,b,t,n,Og.a.getTypeName()),S.sendTelemetryLatencyData([{key:_g.k.UserPerceivedLatency,value:jm(r)},{key:_g.k.QnAResponseTime,value:jm(r)},{key:_g.k.IsQuerySuccess,value:!1},{key:_g.k.UserQueryGuid,value:C}],!0),uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Finished,workflowAnnotationType:Og.a.getTypeName(),queryID:C,isSuccess:!1,responseTime:Pm(r)}),uh.a.getInstance().setQueryID(Vg.w),S.setUserQueryGuid(Vg.w),uh.a.getInstance().setFeatureName(_g.i.ChatQnA),void(uh.a.getInstance().getIsFluxFlowEnabled()||(Object(Dg.c)("Stopping loading UI"),n(!1)));var x={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:fr.a.Footer,showAnimation:!0,feedbackData:uh.a.getInstance().getFeedbackData(),isFailure:!1,actionButtonList:[{type:po.b.Default,title:Object(Vg.W)(),text:Object(o.c)()?"":Object(Vg.W)(),iconRegular:Object(o.c)()?Se.e:Se.c,iconHover:Object(o.c)()?Se.d:Se.b,position:Object(o.c)()?po.a.FeedbackSection:po.a.ActionButtonBar,popoverProps:{popoverTitle:Object(Vg.X)()},handleButtonOnClick:dh.c}],references:O&&O.length>0&&(null===(l=uh.a.getInstance().getBasicChatProps())||void 0===l?void 0:l.isCitationsEnabled)?uh.a.getInstance().getMarkdownReferences(O):void 0,clpSensitivityIndicatorData:null!==(u=null===(c=uh.a.getInstance().getBasicChatProps())||void 0===c?void 0:c.sensitivityIndicatorData)&&void 0!==u?u:void 0,telemetryData:JSON.stringify({correlationId:C,featureName:E})},I=y?a.a.MarkdownCard:a.a.Default,w=y?{markDownCardProps:{user:"chat",message:f}}:{defaultMessageProps:{user:"chat",messageHeader:{text:f}}};t.setChatMessageData(I,w,x),v&&"suggestions"===(null==v?void 0:v.type)&&(null===(p=null===(d=null==v?void 0:v.value)||void 0===d?void 0:d.suggestions)||void 0===p?void 0:p.length)>0&&uh.a.getInstance().sendBasicChatSuggestionPillsEvent(null===(g=null==v?void 0:v.value)||void 0===g?void 0:g.suggestions),uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Finished,workflowAnnotationType:Og.a.getTypeName(),queryID:C,isSuccess:!0,responseTime:Pm(r)}),S.sendTelemetryLatencyData([{key:_g.k.UserPerceivedLatency,value:jm(r)},{key:_g.k.QnAResponseTime,value:jm(r)},{key:_g.k.IsQuerySuccess,value:!0},{key:_g.k.UserQueryGuid,value:C}],!0),uh.a.getInstance().setQueryID(Vg.w),S.setUserQueryGuid(Vg.w),uh.a.getInstance().setFeatureName(_g.i.ChatQnA),uh.a.getInstance().getIsFluxFlowEnabled()||(Object(Dg.c)("Stopping loading UI"),n(!1))},jh=function(e,t,n,r,o){var i,s,l,c,u=null==e?void 0:e.body,d=null==u?void 0:u.answer,p=null==u?void 0:u.error,g=null==u?void 0:u.aiResponse,h=null==u?void 0:u.status,f=null==u?void 0:u.citations,m=null==u?void 0:u.isStreaming,v=null==u?void 0:u.isAnswerCompleted,b=null==u?void 0:u.queryId,y=eh.a.getInstance(),C=Object(Th.b)(null==u?void 0:u.featureType);if(Object(Dg.c)("Getting isStreaming boolean as : ".concat(m," and isAnswerCompleted as : ").concat(v," and answer as : ").concat(d," and featureType as : ").concat(C)),uh.a.getInstance().setFeatureName(C),y.setUserQueryGuid(b),uh.a.getInstance().setQueryID(b),uh.a.getInstance().getIsFirstStreamChunk()&&(uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Started,workflowAnnotationType:Og.b.getTypeName(),queryID:b,responseTime:Pm(r)}),y.logTriedEvent([{key:_g.q,value:b}],_g.p,C,Object(Th.c)(C),void 0,Object(Th.d)(C),Object(Th.a)(C)),y.sendTelemetryLatencyData([{key:_g.k.FeatureName,value:C}])),y.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ResponseReceivedFromAL},{key:_g.g.ChatEventParameters,value:Og.b.getTypeName()},{key:_g.g.UserQueryGuid,value:b},{key:_g.g.IsStreamingResponse,value:m.toString()},{key:_g.g.Cv,value:o}]),uh.a.getInstance().sendLoggingEventToClient(Pg.g.AugloopResponseReceived,{annotationName:Og.b.getTypeName(),timeInMs:Pm(r)}),wg.a.getInstance().clearAugloopResponseTimer(),!Object(dh.d)(p)&&!Object(dh.d)(null==p?void 0:p.category))return uh.a.getInstance().getIsFirstStreamChunk()||uh.a.getInstance().updateCardWithFooter(),Object(wh.a)(p,h,t,n,Og.b.getTypeName()),uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Finished,workflowAnnotationType:Og.b.getTypeName(),queryID:b,isSuccess:!1,responseTime:Pm(r)}),y.sendTelemetryLatencyData([{key:_g.k.UserPerceivedLatency,value:jm(r)}]),void uh.a.getInstance().resetBasicChatStreamingStates(!1,!uh.a.getInstance().getIsFluxFlowEnabled());m?(uh.a.getInstance().setIsBasicChatStreaming(!0),Ph(d,v,t,y)):uh.a.getInstance().resetBasicChatStreamingStates(!0,!uh.a.getInstance().getIsFluxFlowEnabled()),f&&f.length>0&&uh.a.getInstance().getBasicChatProps().isCitationsEnabled&&(y.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.CitationReceived},{key:_g.g.ChatEventParameters,value:f.length.toString()},{key:_g.g.UserQueryGuid,value:b}]),t.updateLastMessage(a.a.MarkdownCard,void 0,{references:uh.a.getInstance().getMarkdownReferences(f)},!1)),g&&"suggestions"===(null==g?void 0:g.type)&&(null===(s=null===(i=null==g?void 0:g.value)||void 0===i?void 0:i.suggestions)||void 0===s?void 0:s.length)>0&&uh.a.getInstance().sendBasicChatSuggestionPillsEvent(null===(l=null==g?void 0:g.value)||void 0===l?void 0:l.suggestions),m?wg.a.getInstance().setAugloopResponseTimer(null===(c=null==u?void 0:u.H_)||void 0===c?void 0:c.T_):(uh.a.getInstance().sendBasicChatProcessingEvent({status:Pg.b.Finished,workflowAnnotationType:Og.b.getTypeName(),queryID:b,isSuccess:!0,responseTime:Pm(r)}),uh.a.getInstance().getIsFluxFlowEnabled()||(Object(Dg.c)("Streaming finished. Stopping loading UI"),n(!1)))},Ph=function(e,t,n,o){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var i,s,l,c,u;return Object(r.__generator)(this,(function(r){return uh.a.getInstance().getIsFirstStreamChunk()&&""===e?(o.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.EmptyBasicChatResponse},{key:_g.g.UserQueryGuid,value:uh.a.getInstance().getQueryID()}]),[2]):(i=(i=e).replace("\\n","\n").replace("\\t","\t"),s=uh.a.getInstance().getParagraphChunks(),s+=i,uh.a.getInstance().setParagraphChunks(s),l={shouldShowAIGeneratedIndicator:!0,showAnimation:!1,feedbackData:uh.a.getInstance().getFeedbackData(),isFailure:!1,clpSensitivityIndicatorData:null!==(u=null===(c=uh.a.getInstance().getBasicChatProps())||void 0===c?void 0:c.sensitivityIndicatorData)&&void 0!==u?u:void 0,telemetryData:JSON.stringify({correlationId:uh.a.getInstance().getQueryID(),featureName:uh.a.getInstance().getFeatureName()})},uh.a.getInstance().updateStreamChunks({augloopResponseTime:jm(Sm)}),uh.a.getInstance().getIsFirstStreamChunk()?(n.setChatMessageData(a.a.MarkdownCard,{markDownCardProps:{user:"chat",message:i}},l,!1),uh.a.getInstance().setIsFirstStreamChunk(!1),o.sendTelemetryLatencyData([{key:_g.k.UserPerceivedLatency,value:jm(Sm)}])):n.updateLastMessage(a.a.MarkdownCard,{markDownCardProps:{user:"chat",message:s}},void 0,!1),t&&uh.a.getInstance().updateCardWithFooter(),[2])}))}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Xg||(Xg={}));var Ah=n(1150),_h=function(e,t,n){var r=null==e?void 0:e.body,o=r.suggestedQnAs,i=r.error,a=r.queryId,s=eh.a.getInstance(),l=uh.a.getInstance().getSuggestedQnaSignalSubmitTime();if(Object(Dg.c)("received suggestedQnaList",o),s.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ResponseReceivedFromAL},{key:_g.g.ChatEventParameters,value:Og.c.getTypeName()},{key:_g.g.UserQueryGuid,value:a},{key:_g.g.Cv,value:n}]),s.sendTelemetryLatencyData([{key:_g.k.SuggestedQnAResponseTime,value:jm(l)},{key:_g.g.UserQueryGuid,value:a}]),uh.a.getInstance().sendLoggingEventToClient(Pg.g.AugloopResponseReceived,{annotationName:Og.c.getTypeName(),timeInMs:Pm(l)}),!Object(dh.d)(i)&&!Object(dh.d)(null==i?void 0:i.category)){var c="",u=Og.c.getTypeName();if(!Object(dh.d)(i.errorDetailsJson))try{c=JSON.parse(i.errorDetailsJson).code}catch(e){Object(Dg.c)("Error parsing error code from basic chat error",e.message)}return Object(Dg.c)("Received error from DynamicQuestionGeneratorSuggestedQnAAnnotation Workflow"),uh.a.getInstance().sendLoggingEventToClient(Pg.g.AugloopErrorReceived,{annotationName:u,timeInMs:Pm(l),chatEventParams:JSON.stringify({errorCategory:i.category,errorCode:c})}),void s.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:"".concat(u,"_Error")},{key:_g.g.ChatEventParameters,value:"".concat(i.category,"_").concat(c)},{key:_g.g.ChatErrorType,value:_g.e.Server},{key:_g.g.UserQueryGuid,value:a}])}o&&t.setSuggestedQnAList(o)},Dh=n(326),Lh=n(1483),Mh=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n){return{conversationId:t,getLogs:e,telemetryData:n}},e}(),Bh=n(832),Rh=n(1130),Fh=n(1489),Nh=n(1151),Hh=n(2078),Uh=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i,a,s,l,c;return Object(r.__generator)(this,(function(r){return o=null===(c=null===(l=e.body)||void 0===l?void 0:l.H_)||void 0===c?void 0:c.T_,i=null==e?void 0:e.body,a=i.success,s=i.sensitivityLabel,eh.a.getInstance().sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ResponseReceivedFromAL},{key:_g.g.ChatEventParameters,value:"".concat(o)},{key:_g.g.Cv,value:n}]),Object(Dg.c)("received sensitivity label",s),t(a&&s?s:void 0),[2]}))}))},Vh=function(){this.getProps=function(e){return{handleChangeTopicButtonClick:e}}},zh=function(e){var t=e.children,n=Object(r.__rest)(e,["children"]);return n.shouldUseV9Tokens?m.a.createElement(h.a,{theme:n.theme,dir:n.dir},t):(console.log("Test app is using Custom tokens to render Theme"),m.a.createElement(m.a.Fragment,null,t))},Gh=function(e){if(!e.shouldUseFluentV9Tokens)return Object(Dg.c)("Fluent V8 Custom Tokens enabled"),m.a.createElement(b,{theme:e.theme,dir:e.dir},e.children);if(e.shouldUseFluentV9Tokens&&e.theme)return Object(Dg.c)("Fluent V9 supported tokens enabled"),m.a.createElement(zh,Object(r.__assign)({},Wh(e.theme,e.dir)),e.children);throw new Error("Exception: Please ensure a compatible V9 Theme is passed to the ThemeProvider")},Wh=function(e,t){return void 0===t&&(t=void 0),{shouldUseV9Tokens:!0,theme:e,dir:t}},Qh=n(3598),qh=n(3368),Kh=function(e){var t=e.className,n=Oh();return f.createElement(S,{style:t},f.createElement(Qh.a,null,f.createElement("div",{className:n.incomingShimmerCardWrapper},f.createElement("div",{className:n.incomingShimmerCard},f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}))),f.createElement("div",{className:n.outgoingShimmerCardWrapper},f.createElement("div",{className:n.outgoingShimmerCard},f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb}),f.createElement(qh.a,{size:Vg.yb})))))},Yh=n(89),Zh=n(1435),Jh=n(462);const Xh=800,$h=600;var ef=n(1434);class tf extends ef.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class nf extends tf{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class rf{constructor(e,t,n,r,o){this.userContext=e,this.hostContext=t,this.tokenService=n,this.telemetryService=r,this.hostWindow=o}authenticate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var o,i;const a={user:this.userContext,app:this.hostContext,page:{id:(null===(o=e.appDefinition)||void 0===o?void 0:o.id)||"",frameContext:Yh.b.authentication}},s=e=>(r,o)=>e?(t({code:r}),Promise.resolve()):(n(r),Promise.resolve()),l=new nf(s(!0),s(!1),this.tokenService,this.userContext);(function(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{var s,l;const c=Object(Zh.a)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(s=t.appDefinition.version)&&void 0!==s?s:"",appId:t.appDefinition.id,manifestVersion:null!==(l=t.appDefinition.manifestVersion)&&void 0!==l?l:""})),u={url:t.signInUrl,width:Xh,height:$h,left:e.screen.availWidth/2-Xh/2,top:e.screen.availHeight/2-$h/2};new Jh.b(e,u,c,n,o,{log:function(e,t,n,r){}},i)?r(void 0):a("Unable to initialize auth extension")}))}))})(null!==(i=this.hostWindow)&&void 0!==i?i:window,e,l,a,this.telemetryService).catch((e=>{}))}))}))}getToken(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.tokenService.getToken(e)}))}}var of=n(1170),af=n(2152),sf=n(1149);class lf{constructor(e,t,n){this.dataProvider=e,this.addPlugin=t,this.removePlugin=n}onToggle(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.plugin.isEnabled=e,e?null===(t=this.addPlugin)||void 0===t||t.call(this,this.plugin,!0):null===(n=this.removePlugin)||void 0===n||n.call(this,this.plugin,!0),yield this.dataProvider.setPlugin(this.plugin)}))}}class cf extends lf{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class uf extends lf{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class df extends lf{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}var pf=n(2217),gf=n(1555),hf=n(1477),ff=n(2859),mf=n(2681),vf=n(2680);let bf=0;var yf=n(2385);class Cf extends lf{constructor(e,t,n,r,o,i,a,s){var l;super(t,o,i),this.plugin=e,this.dataProvider=t,this.authActivityProvider=n,this.appService=r,this.addPlugin=o,this.removePlugin=i,this.telemetryService=a,this.correlationVector=s,this.pluginInfoForLogging="",this.authActivityProvider&&(this.authRuntime=new pf.a(this.authActivityProvider)),e.isEnabled&&(null===(l=this.addPlugin)||void 0===l||l.call(this,e)),this.pluginInfoForLogging=Object(yf.a)(e)?`, PluginId: ${this.plugin.id}, PluginName: ${this.plugin.name}, PluginSource: ${this.plugin.source}`:e.titleId?", LOB Plugin":", TitleId not found"}handleAuthLinkClick(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=this.plugin.authRequest)||void 0===t?void 0:t.type;try{"silentAuth"!==n&&bf++;const t=yield this.executeAuthRequest(!1);this.updatePluginStatus(t,e)}catch(e){}"silentAuth"!==n&&bf>0&&bf--}))}onToggle(e,t){var n,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)return void this.toggleAndUpdatePluginStatus("processed",e,t);if(!this.authRuntime||!this.plugin.metaOSAppId){const r=this.authRuntime?"metaOSAppId is undefined":"AuthRuntime is undefined";return null===(n=this.telemetryService)||void 0===n||n.LogError({type:of.b.LogError,tag:of.i.MsgExtViewModel,name:of.g.onToggle,message:of.a.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${r}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),void this.toggleAndUpdatePluginStatus("processed",e,t)}this.updatePluginStatus("processing",t),this.plugin.authRequest=yield this.getAuthRuntimeRequest();const r=yield this.executeAuthRequest(!0);if("pendingAuth"===r&&0===bf)return this.toggleAndUpdatePluginStatus(r,e,t),void(yield this.handleAuthLinkClick(t));this.toggleAndUpdatePluginStatus(r,e,t)}catch(n){null===(o=this.telemetryService)||void 0===o||o.LogError({type:of.b.LogError,tag:of.i.MsgExtViewModel,name:of.g.onToggle,message:of.a.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${(null==n?void 0:n.message)||n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),this.toggleAndUpdatePluginStatus("processed",e,t)}}))}executeAuthRequest(e){var t,n,o,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.plugin.authRequest){const r=new sf.a(of.d.AuthActivity,of.c.AuthActivity,this.telemetryService),a={};try{switch(this.plugin.authRequest.type){case"botInvoke":a[of.h.TypeOfAuthFlow]=of.j.BotInvokeForAuthCheck;break;case"silentAuth":a[of.h.TypeOfAuthFlow]=of.j.SilentAuth;break;case"auth":a[of.h.TypeOfAuthFlow]=of.j.Auth;break;case"config":a[of.h.TypeOfAuthFlow]=of.j.Config}a[of.h.isAuthFlowAutomatic]=e?1:0;const s=yield null===(t=this.authRuntime)||void 0===t?void 0:t.execute(this.plugin.authRequest);if(s)return r.logMetricEnd({props:a,message:of.a.None,diagnosticsData:`Auth request executed successfully${this.pluginInfoForLogging}`},this.correlationVector),this.plugin.authRequest=Object(gf.b)(this.plugin.authRequest,s),"auth"===(null===(n=this.plugin.authRequest)||void 0===n?void 0:n.type)||"config"===(null===(o=this.plugin.authRequest)||void 0===o?void 0:o.type)||"silentAuth"===(null===(i=this.plugin.authRequest)||void 0===i?void 0:i.type)?"pendingAuth":"processed";r.logMetricEndWithError({props:a,message:of.a.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: AuthSDK execute returned undefined response${this.pluginInfoForLogging}`},this.correlationVector)}catch(e){if(r.logMetricEndWithError({props:a,message:of.a.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: ${null==e?void 0:e.message}${this.pluginInfoForLogging}`},this.correlationVector),(null==e?void 0:e.message)===ff.a){const e=this.plugin.authRequest;return e&&(e.isSilent=!0,this.plugin.authRequest=e),"pendingAuth"}return Promise.reject(`Could not execute auth request as ${e.message||e}`)}}return Promise.reject("Could not execute auth request as auth request is not available")}))}getAuthRuntimeRequest(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.appService||!this.plugin.metaOSAppId)return Promise.reject("AppId or serviceProvider is undefined");const e=yield this.getAppDefinition(this.appService,this.plugin.metaOSAppId);if(!e)return Promise.reject("Could not find app definition");if(!Object(mf.a)(e))return Promise.reject("Could not find command with initial run enabled");const t=this.getBotInvokeRequest(e);if(!t)return Promise.reject("Could not find bot invoke request");const n=Object.assign(Object.assign({type:"botInvoke"},t),{onActivityCompletion:this.getOnAuthActivityCompletion(this.plugin)});return Promise.resolve(n)}))}getOnAuthActivityCompletion(e){return t=>{if("object"==typeof t){if(e.authRequest){const n=Object(hf.b)(t);if("auth"===n||"config"===n)return e.authRequest=Object(gf.b)(e.authRequest,t),e.status="pendingAuth",Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)}}onInstall(){throw new Error("Method not implemented.")}getAppDefinition(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getApp({id:t});if(!n||!n.appDefinition&&!n.titleInfo)return;let r;return(null==n?void 0:n.appDefinition)?r=n.appDefinition:(null==n?void 0:n.titleInfo)&&(r=Object(vf.a)(n.titleInfo)),r}))}getBotInvokeRequest(e){var t,n,r,o,i,a,s,l;const c=null!==(r=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)&&void 0!==r?r:null===(i=null===(o=e.inputExtensions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.botId,u=this.plugin.metaOSAppId,d=null===(l=null===(s=null===(a=e.inputExtensions)||void 0===a?void 0:a[0].commands)||void 0===s?void 0:s[0])||void 0===l?void 0:l.id;if(!c||!u||!d){throw new Error(`Could not construct bot invoke request. ErrorMessage: ${c?u?"CommandId is undefined":"AppId is undefined":"BotId is undefined"}`)}return{appId:u,botId:c,requestBody:{name:"composeExtension/query",appName:e.name,value:{commandId:d,parameters:[{name:"initialRun",value:"true"}],queryOptions:{skip:0,count:25}}}}}toggleAndUpdatePluginStatus(e,t,n){const o=Object.create(null,{onToggle:{get:()=>super.onToggle}});return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield o.onToggle.call(this,t),this.updatePluginStatus(e,n)}))}updatePluginStatus(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.plugin.status=e,null==t||t()}))}}class Of extends lf{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class Sf{constructor(e,t){this.dataProvider=e,this.plugin=t}onInstall(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.dataProvider.installStoreFrontPlugin(this.plugin)}))}}class Ef{constructor(e,t,n,r,o,i){this.dataProvider=e,this.authActivityProvider=t,this.addPlugin=n,this.removePlugin=r,this.telemetryService=o,this.appService=i,this.supportedPluginTypes=["MsgExt","FirstParty","PowerPlatform","DataVerse","Undefined"]}getPlugins(e,t,n,o){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(n)return this.getPluginsGrouped(e,t,o);const r=new sf.a(of.d.GetPluginsState,of.c.GetPlugins,this.telemetryService),a={};try{const n=this.getSupportedPluginTypes(e),o=yield null===(i=this.dataProvider)||void 0===i?void 0:i.getPlugins(t);let s=0,l=0,c=0,u=0,d=0,p=0;const g=null==o?void 0:o.reduce(((e,r)=>{var o;if(r.type&&n.includes(r.type))switch(r.isEnabled?s++:l++,(null===(o=r.titleId)||void 0===o?void 0:o.startsWith("P_"))&&(c++,r.isEnabled&&u++),r.type){case"MsgExt":d++,r.isEnabled&&p++,e.push(new Cf(r,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new uf(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new Of(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new cf(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new df(this.dataProvider,r,this.addPlugin,this.removePlugin))}return e}),[]);return a[of.h.TotalPluginCount]=g.length,a[of.h.TotalISVPluginCount]=c,a[of.h.SelectedPluginCount]=s,a[of.h.UnselectedPluginCount]=l,a[of.h.UnsupportedPluginCount]=o.length-g.length,a[of.h.SelectedISVPluginCount]=u,a[of.h.TotalMEPluginCount]=d,a[of.h.SelectedMEPluginCount]=p,r.logMetricEnd({props:a},t),g}catch(e){r.logMetricEndWithError({props:a,message:of.a.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getPluginsGrouped(e,t,n){var o,i,a,s,l;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const c=new sf.a(of.d.GetPluginsState,of.c.GetPlugins,this.telemetryService),u={};try{const h=this.getSupportedPluginTypes(e),f=[],m=yield null===(l=this.dataProvider)||void 0===l?void 0:l.getPluginsGrouped(t,n);let v=0,b=0,y=0,C=0,O=0,S=0,E=0;try{for(var d,p=!0,g=Object(r.__asyncValues)(m);d=yield g.next(),!(o=d.done);p=!0){s=d.value,p=!1;const e=s,n=e.groupHeaderPlugin;if(n.type&&h.includes(n.type)){let r,o=0,i=0,a=0,s=0,l=0,c=0;if("PowerPlatform"===n.type)r=new Of(this.dataProvider,n,this.addPlugin,this.removePlugin);else r=new uf(this.dataProvider,n,this.addPlugin,this.removePlugin);const u=e.plugins.reduce(((e,n)=>{var r;switch(E++,n.isEnabled?o++:i++,(null===(r=n.titleId)||void 0===r?void 0:r.startsWith("P_"))&&(a++,n.isEnabled&&s++),n.type){case"MsgExt":l++,n.isEnabled&&c++,e.push(new Cf(n,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new uf(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new Of(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new cf(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new df(this.dataProvider,n,this.addPlugin,this.removePlugin))}return e}),[]);v+=o,b+=i,y+=a,C+=s,O+=l,S+=c,f.push({groupPlugins:u,parentPlugin:r})}}}catch(e){i={error:e}}finally{try{p||o||!(a=g.return)||(yield a.call(g))}finally{if(i)throw i.error}}return u[of.h.TotalPluginCount]=f.length,u[of.h.TotalISVPluginCount]=y,u[of.h.SelectedPluginCount]=v,u[of.h.UnselectedPluginCount]=b,u[of.h.UnsupportedPluginCount]=E-f.length,u[of.h.SelectedISVPluginCount]=C,u[of.h.TotalMEPluginCount]=O,u[of.h.SelectedMEPluginCount]=S,c.logMetricEnd({props:u},t),f}catch(e){c.logMetricEndWithError({props:u,message:of.a.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getStoreFrontPlugins(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=new sf.a(of.d.GetStoreFrontPluginsState,of.c.GetStoreFrontPlugins,this.telemetryService),r={};try{const o=yield null===(t=this.dataProvider)||void 0===t?void 0:t.getStoreFrontPlugins(e),i=[];return o.forEach((e=>{const t=new Sf(this.dataProvider,e);i.push(t)})),r[of.h.TotalStoreFrontPluginsCount]=i.length,n.logMetricEnd({props:r},e),i}catch(t){n.logMetricEndWithError({props:r,message:of.a.StoreFrontPluginsFetchFailed,diagnosticsData:`Error: ${t.message||t}`},e)}}))}getSupportedPluginTypes(e){return e?Object(af.a)(this.supportedPluginTypes,e):this.supportedPluginTypes}}var xf=n(487);function If(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.botInvoke(e);return Object.assign({},n)}))}class wf{constructor(e){this.serviceProvider=e}execute(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e,n=yield this.executeConfigOrAuthRequest(t,this.serviceProvider.telemetryService),r=Object.assign({},t.originalInvokeRequest);return n&&(r.requestBody.value.state=n,delete r.requestBody.value.authentication),yield If(r,this.serviceProvider.channelService)}))}executeConfigOrAuthRequest(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.originalInvokeRequest.appId,r=yield this.serviceProvider.appService.getApp({id:n});let o;if(null==r?void 0:r.appDefinition)o=r.appDefinition;else{if(!(null==r?void 0:r.titleInfo))return null==t||t.LogError({type:xf.c.LogError,name:xf.f.ExecuteConfigOrAuthRequest,tag:xf.h.AuthConfigRuntimeActivity,success:!1,diagnosticsData:"App Definition not found"}),Promise.reject("App Definition not found");o=Object(vf.a)(r.titleInfo)}const i=yield this.serviceProvider.authService.authenticate({appDefinition:o,signInUrl:e.url});return null==i?void 0:i.code}))}}class Tf{constructor(e){this.serviceProvider=e}execute(e){var t,n,o,i,a,s,l,c;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=e;if(!r.resource){const e=yield this.serviceProvider.appService.getApp({id:r.originalInvokeRequest.appId});r.resource=null!==(i=null!==(t=r.resource)&&void 0!==t?t:null===(o=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.webApplicationInfo)||void 0===o?void 0:o.resource)&&void 0!==i?i:null===(l=null===(s=null===(a=null==e?void 0:e.titleInfo)||void 0===a?void 0:a.titleDefinition)||void 0===s?void 0:s.webApplicationInfo)||void 0===l?void 0:l.resource}const u=yield this.executeSilentAuthRequest(r);if(!u)return null===(c=this.serviceProvider.telemetryService)||void 0===c||c.LogError({type:xf.c.LogError,name:xf.f.Execute,tag:xf.h.SilentAuthRuntimeActivity,success:!1,diagnosticsData:"Failed to fetch Auth token for the request"}),Promise.reject("Failed to fetch Auth token for the request");const d=Object.assign({},r.originalInvokeRequest);return d.requestBody.value.authentication={token:u},yield If(d,this.serviceProvider.channelService)}))}executeSilentAuthRequest(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.resource)return Promise.reject("Resource is undefined");const t=yield this.serviceProvider.authService.getToken({resource:e.resource,claims:e.claims,isSilent:e.isSilent});return Promise.resolve(null==t?void 0:t.authToken)}))}}class kf{constructor(e){this.serviceProvider=e}execute(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e;return this.serviceProvider.channelService?yield If(n,this.serviceProvider.channelService):(null===(t=this.serviceProvider.telemetryService)||void 0===t||t.LogError({type:xf.c.LogError,name:xf.f.Execute,tag:xf.h.BotInvokeRuntimeActivity,success:!1,diagnosticsData:"Channel service is not available"}),Promise.reject("Channel service is not available"))}))}}class jf{constructor(e){this.serviceProvider=e}execute(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e;return Promise.reject({request:t,error:"Not implemented"})}))}}var Pf,Af=function(e,t,n,r){var o={authService:e,appService:t,channelService:n,telemetryService:r};this.authConfigActivity=new wf(o),this.silentAuthActivity=new Tf(o),this.botInvokeActivity=new kf(o),this.apiPluginAuthActivity=new jf(o)},_f=function(){function e(e){this.clientInfo=e}return e.prototype.getUserContext=function(){if(!this.userInfo){var e=this.clientInfo;this.userInfo={dataResidency:this.getDataResidency(e.physicalRing),id:e.aadUserId,displayName:e.userName}}return this.userInfo},e.prototype.getHostContext=function(){if(!this.hostInfo){var e=this.clientInfo;this.hostInfo={host:{clientType:Yh.c.web,name:Yh.d.office,sessionId:e.sessionId,version:"1.0"},locale:e.locale,sessionId:e.sessionId,theme:Yh.e.default}}return this.hostInfo},e.prototype.getDataResidency=function(e){switch(e){case"dod":return c.d.DOD;case"doj":return c.d.DOJ;default:return c.d.Public}},e}(),Df=n(2388),Lf=n(2389),Mf=n(2387),Bf=function(e,t,n,o,i){return void 0===o&&(o=!1),void 0===i&&(i=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var a,s,l,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.getOrLoadPlugins()];case 1:return a=null!==(u=r.sent())&&void 0!==u?u:[],s={pluginsInfo:a,workflowAnnotationType:Cg.a.getTypeName()},n(s),l=function(e){var t=a.filter((function(t){return t.id===function(e){switch(e){case $c.a.Work:return zg.j.ENTERPRISE_SEARCH;case $c.a.Web:return zg.j.WEB_SEARCH}return""}(e.id)})),n=t.length?t[0]:void 0;return n?"blocked"===n.state?eu.a.Blocked:n.isEnabled?eu.a.Enabled:eu.a.Disabled:eu.a.Disabled},c=[],null==e||e.map((function(e){var t=e.state,n=l(e);n!=eu.a.Blocked&&(e.id===$c.a.Work&&i||e.id===$c.a.Web&&o)&&(n=eu.a.Enabled),n===eu.a.Blocked?(t===eu.a.Enabled&&(Object(Dg.c)("Plugin is blocked by admin, turning off ".concat(e.id," plugin Ux")),e.onToggle(!1)),c.push(e.id),Object(nh.c)("".concat(e.id,":AdminBlocked"))):(e.onToggle(n===eu.a.Enabled),Object(nh.c)("".concat(e.id,":").concat(n===eu.a.Enabled?"AutoOn":"AutoOff")))})),[2,c]}}))}))},Rf=function(){function e(e,t,n,o,i,a,s,l){var c=this;this.getTransformFileSuggestionText=function(){var e,t;if(c.zqmProps)try{for(var n=Object(r.__values)(c.zqmProps.promptSuggestionList),o=n.next();!o.done;o=n.next()){var i=o.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Vg.w},this.chatInputRef=e,this.handleSubmit=t,this.isExecuting=n,this.chatEditor=o,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=i,this.setChatInputStateExpanded=a,this.isHVCAppChatV2Enabled=null!=s&&s,this.hvcPromptStringsList=null!=l?l:[],this.telemetryLoggerUtils=eh.a.getInstance()}return e.prototype.handleZQMButtonClick=function(e,t){var n,o,i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.isExecuting?[2]:(Object(Zg.b)(Vg.w),Kg.a.getInstance().sendLoggingEventToClient(Pg.g.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ZQMButtonV2Clicked}]),a=this.zqmProps.promptSuggestionList.find((function(e){return e.suggestionText==t})),s=e,l=Vg.w,[4,this.setChatInputStateExpanded()]);case 1:return r.sent(),(null==a?void 0:a.shouldSubmitQueryOnClick)?(this.isHVCAppChatV2Enabled&&(s=s.replace(/{|}/g,"")),this.handleSubmit({text:s,telemetryData:_g.f.ZQMButtonClicked}),[2]):(t===this.transformFileSuggestionText&&(l=this.transformFilePlaceholderText),null===(n=this.chatInputRef.current)||void 0===n||n.setInputText(s,!0),null===(o=this.chatInputRef.current)||void 0===o||o.setFocus(),t===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Zc.a,Wu.a.InsertAtCursor)}),1),null===(i=this.chatInputRef.current)||void 0===i||i.setGhostText(l),[2])}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t,iconRegular:e.iconRegular}})),isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,handleButtonClick:this.handleZQMButtonClick,hvcPromptStringsList:this.hvcPromptStringsList}},e}(),Ff=n(1848),Nf=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){return Object(Dg.c)("CopilotLicensingAnnotation received"),e=eh.a.getInstance(),Ig.a.getInstance().setLicenseAnnotationActivated(!0),e.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.CopilotLicensingAnnotationActivated},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}]),Ig.a.getInstance().resubmitOnLicenseAnnotationActivation(),[2]}))}))},Hf=function(){this.getProps=function(e){return{handleRestrictiveMsgDismissClick:e}}},Uf=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){return{conversationId:t,getLogs:e,telemetryData:n,sessionId:r,conversationLogObject:o,debugMessageInfoObject:i,showDebugInfoMessage:a,setShowDebugInfoOnMessage:s,chatPaneLoadTime:l,chatInputLoadTime:c,sydneyConversationObject:u,augloopKustoQueryURL:d,clientKustoQueryURL:p,appName:g,appPlatform:h,sdxVersion:f}},e}(),Vf=Object(y.a)({deleteAllButton:{width:"100%"}}),zf=f.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return f.createElement(w.a,{className:Object(C.a)(Kn().root,Vf().deleteAllButton,n),icon:f.createElement(Hn.k,{className:r}),onClick:t,"aria-label":Un()},Un())})),Gf=f.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return f.createElement(w.a,{className:Object(C.a)(Kn().root,Yn().root,n),icon:f.createElement(sn.d,{className:r}),onClick:t,"aria-label":Object(M.m)()?OfficeaicopilotStrings.BackButtonText:"Go back"})})),Wf=(f.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return f.createElement(w.a,{className:Object(C.a)(Kn().root,Yn().root,n),icon:f.createElement(L.p,{className:r}),onClick:t,"aria-label":Vn()})})),f.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return f.createElement(w.a,{className:Object(C.a)(Kn().root,n),icon:f.createElement(L.p,{className:r}),onClick:t,"aria-label":Vn(),size:"small"},Object(M.m)()?OfficeaicopilotStrings.NewChatButtonText:"New chat")}))),Qf={Root:Object(r.__assign)({justifyContent:"space-between"},W.a.padding("0px","16px","10px","0px")),label:Object(r.__assign)({},W.a.padding("3px")),icon:{fontSize:"16px"},toolbarGroup:{display:"flex"}},qf=Object(y.a)(Qf),Kf=f.memo((function(e){var t=e.title,n=e.backButtonProps,r=e.newConversationButtonProps,o=qf();return f.createElement(He.a,{"aria-label":Object(M.m)()?OfficeaicopilotStrings.ChatHistoryHeaderAriaLabel:"Tool bar",className:o.Root},f.createElement(Ue.a,{role:"presentation",className:o.toolbarGroup},f.createElement(Gf,{customIconStyles:o.icon,onClick:n.onClick}),f.createElement(T.a,{className:o.label,size:"large"},t)),f.createElement(Ue.a,{role:"presentation"},f.createElement(Wf,{customIconStyles:o.icon,onClick:r.onClick})))})),Yf=f.memo(Kf),Zf=Object(G.a)(v.b),Jf={Root:{overflowY:"auto",maxHeight:"100%"},TriggerButtonStyle:Object(r.__assign)(Object(r.__assign)({},W.a.border("none")),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:Zf.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:Zf.colorNeutralBackground3Hover}}}),SplitButtonGroupStyle:(Pf={},Pf["& .".concat(ml.a.icon)]={display:"none"},Pf["&:hover .".concat(ml.a.icon)]={display:"inline"},Pf["& > :nth-child(2) > :nth-child(2)"]={display:"inline"},Pf["&:hover > :nth-child(2) > :nth-child(2)"]={display:"none"},Pf),SplitButtonLeftButtonStyle:Object(r.__assign)(Object(r.__assign)({},W.a.overflow("hidden")),{textOverflow:"ellipsis",whiteSpace:"nowrap",flexShrink:1,display:"inline-block"}),SplitButtonRightButtonStyle:{paddingLeft:"6px !important","&:before":{display:"none"}},LoadingSkeletonStyle:Object(r.__assign)({width:"inherit",alignItems:"center",display:"flex",paddingTop:"5px",paddingBottom:"5px",position:"relative"},W.a.gap("5px")),SplitButtonAdditionalStyle:{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:Zf.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:Zf.colorNeutralBackground3Hover}},maxWidth:"100%"}},Xf=Object(y.a)(Jf),$f=f.forwardRef((function(e,t){var n=e.isChatHistoryListLoading,r=e.conversationOnClick,o=e.deleteOnClick,i=e.conversations,a=Xf();return f.createElement(j.a,{ref:t,className:a.Root},n?f.createElement(Qh.a,{role:"menuitem"},f.createElement("div",{className:a.LoadingSkeletonStyle},f.createElement(qh.a,{shape:"circle",size:16}),f.createElement(qh.a,{shape:"rectangle",size:16})),f.createElement("div",{className:a.LoadingSkeletonStyle},f.createElement(qh.a,{shape:"circle",size:16}),f.createElement(qh.a,{shape:"rectangle",size:16})),f.createElement("div",{className:a.LoadingSkeletonStyle},f.createElement(qh.a,{shape:"circle",size:16}),f.createElement(qh.a,{shape:"rectangle",size:16}))):i.map((function(e){return f.createElement(Ge.a,{key:e.conversationId,className:a.SplitButtonGroupStyle},f.createElement(P.a,{className:Object(C.a)(a.SplitButtonLeftButtonStyle,a.SplitButtonAdditionalStyle),onClick:function(){return r(e)}},e.conversationName),f.createElement(P.a,{className:Object(C.a)(a.SplitButtonRightButtonStyle,a.SplitButtonAdditionalStyle),onClick:function(){return o(e)},icon:f.createElement(sn.n,null)},f.createElement("span",null,e.timeOfCreation)))})))})),em=f.memo($f),tm={Root:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column"},W.a.padding("0px","3px")),{justifyContent:"space-between",height:"100%"}),ChatHistoryPanelBodyStyle:Object(r.__assign)({overflowY:"auto",flexGrow:1},W.a.padding("0px","13px")),DeleteButtonContainerStyle:Object(r.__assign)({alignSelf:"flex-end",width:"95%"},W.a.margin("10px","auto"))},nm=Object(y.a)(tm),rm=m.a.forwardRef((function(e,t){var n=e.headerProps,r=e.conversationListProps,o=e.deleteButtonProps,i=nm();return m.a.createElement("div",{className:i.Root},m.a.createElement(Yf,{title:n.title,backButtonProps:n.backButtonProps,newConversationButtonProps:n.newConversationButtonProps}),m.a.createElement("div",{className:i.ChatHistoryPanelBodyStyle},m.a.createElement(em,{ref:t,isChatHistoryListLoading:r.isChatHistoryListLoading,conversationOnClick:r.conversationOnClick,deleteOnClick:r.deleteOnClick,conversations:r.conversations})),m.a.createElement("div",{className:i.DeleteButtonContainerStyle},m.a.createElement(zf,{onClick:o.onClick})))})),om=m.a.memo(rm),im=function(e){var t=e.setChatLog,n=e.currentChatId,o=e.setIsExecuting,i=e.setLoadingComponentProps,a=e.suggestionPillsBuilderRef,s=e.createAndSubmitChatHistorySignal,l=e.resetToNewConversation,c=e.setChatHistoryMenuData,u=e.handleChatHistoryPanelClose,d=e.isSwitchingConversation,p=e.isChatHistoryMenuLoading,g=e.chatHistoryMenuData,h=e.isChatHistoryPanelFetchingMoreChats,v=e.setIsChatHistoryPanelFetchingMoreChats,b=e.isEndOfChatHistory,y=Object(f.useRef)(null),C=Object(f.useRef)(150);Object(f.useEffect)((function(){h&&!b&&s(bg.c.GetAllChatsOperation)}),[h]),Object(f.useEffect)((function(){var e=y.current;if(e)return e.addEventListener("scroll",O),function(){return e.removeEventListener("scroll",O)}}),[]);var O=function(e){!(e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight)<C.current)||h||b||v(!0)},S=m.a.useCallback((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return u(),Object(Dg.c)("Change Topic Button Clicked."),a.current.setSuggestedQnAList([]),Am(!0),i((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{loadingUiStringList:[lh()[1]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,s(bg.c.AddChatOperation)];case 1:return e.sent(),o(!0),[2]}}))}))}),[a,i,lh,s]),E=m.a.useCallback((function(e){n!==e.conversationId&&(d.current=!0,s(bg.c.GetMessagesOperation,void 0,void 0,void 0,e.conversationId),i((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{loadingUiStringList:[lh()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),o(!0)),u()}),[n,s,i,lh]),x=m.a.useCallback((function(e){s(bg.c.DeleteChatOperation,void 0,void 0,void 0,e.conversationId),c(g.filter((function(t){return t.sessionId!==e.conversationId}))),e.conversationId===n&&(l(),t([]))}),[s,g,n]);return m.a.createElement(om,{ref:y,headerProps:{title:Object(Vg.S)(),backButtonProps:{onClick:function(){return u()}},newConversationButtonProps:{onClick:S}},conversationListProps:{isChatHistoryListLoading:p,conversationOnClick:E,deleteOnClick:x,conversations:g.map((function(e){return{conversationName:e.chatName&&""!==e.chatName?e.chatName:Object(Vg.R)(),conversationId:e.sessionId,timeOfCreation:"".concat(String(new Date(e.createTimeUtc).getDate()).padStart(2,"0"),"/").concat(String(new Date(e.createTimeUtc).getMonth()+1).padStart(2,"0"),"/").concat(new Date(e.createTimeUtc).getFullYear())}}))},deleteButtonProps:{onClick:function(){return window.open(Vg.i,"_blank")}}})},am=function(){this.getProps=function(e){return{handlePythonExitAnalysisButtonClick:e}}},sm=n(2420),lm=function(){function e(){this.current=void 0,this.pending=void 0,this.resolvePending=void 0}return e.prototype.awaitChatHistoryPlugin=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){return this.current?[2,this.current]:(e=this.pending||this.initPendingPromise(),t=e.then((function(){return!0})),n=Object(dh.g)(Vg.k).then((function(){return!1})),[2,Promise.race([t,n]).then((function(t){return t?e:Promise.reject(new Error("Timeout during awaiting chat history plugins"))}))])}))}))},e.prototype.onChatHistoryPluginInfo=function(e){var t;this.current=e.map((function(e){return e.id})),null===(t=this.resolvePending)||void 0===t||t.call(this,this.current)},e.prototype.initPendingPromise=function(){var e=this;return this.pending=new Promise((function(t){e.resolvePending=t}))},e}(),cm=n(1810),um=n(298),dm=n(242),pm=function(){function e(e,t,n){var r=this;this.pluginConfigService=e,this.chatHistoryEnabledPluginsSource=t,this.pluginParams=n,this.plugins=void 0,this.pluginsLoadingPromise=void 0,this.telemetryLoggerUtils=eh.a.getInstance(),this.logFailure=function(e){r.telemetryLoggerUtils.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:e},{key:_g.h.ErrorType,value:_g.e.Server},{key:_g.h.ErrorCode,value:zg.g.AugloopPluginProviderFailure},{key:_g.h.ErrorCategory,value:dm.d.Augloop}])}}return e.prototype.getPlugins=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return[2,e.sent()]}}))}))},e.prototype.getStoreFrontPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.installStoreFrontPlugin=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.getPluginsGrouped=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return e=t.sent(),[2,e.map((function(e){return{groupHeaderPlugin:e,plugins:[e]}}))]}}))}))},e.prototype.setPlugin=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return this.plugins=Object(um.unionBy)(this.plugins,[e],"id"),this.pluginParams.logGroundingSourceEvent&&Object(nh.d)(e,e.isEnabled?"On":"Off"),[2,Promise.resolve()]}))}))},e.prototype.getEnabledPlugins=function(){return this.plugins?this.plugins.filter((function(e){return e.isEnabled})).map((function(e){return{id:e.id,source:e.source}})):[]},e.prototype.getOrLoadPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return this.plugins?[2,this.plugins]:this.pluginsLoadingPromise?[2,this.pluginsLoadingPromise]:(this.pluginsLoadingPromise=this.loadPlugins(),[4,this.pluginsLoadingPromise]);case 1:return e=t.sent(),this.plugins=e,this.pluginsLoadingPromise=void 0,[2,e]}}))}))},e.prototype.getRestrictedSearchMode=function(){var e;return null===(e=this.restrictedSearchConfigResponse)||void 0===e?void 0:e.RestrictedSearchMode},e.prototype.loadPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o=this;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.getInstalledPlugins(),this.getChatHistoryEnabledPlugins()])];case 1:return e=r.__read.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],t?(t.forEach((function(e){"acquired"===e.state?(n.has(e.id)&&(e.isEnabled=!0),e.id===zg.j.WEB_SEARCH&&o.pluginParams.isWebSearchDefaultOn&&(e.isEnabled=!0),o.pluginParams.logGroundingSourceEvent&&Object(nh.d)(e,e.isEnabled?"AutoOn":"AutoOff")):o.pluginParams.logGroundingSourceEvent&&Object(nh.d)(e,"AdminBlocked")})),[2,t]):[2,void 0]}}))}))},e.prototype.getInstalledPlugins=function(){var e,t,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.pluginConfigService.executeOperation({type:cm.a.GetPluginConfig})];case 1:return"Success"!==(null==(i=r.sent())?void 0:i.status)?(this.logFailure("GetPluginConfig operation failed"),[2,void 0]):((null===(e=i.installedPlugins)||void 0===e?void 0:e.PluginGroups.findIndex((function(e){var t;return!e.IsDisabledByAdmin&&(null===(t=e.PluginDescriptions)||void 0===t?void 0:t.findIndex((function(e){return e.CopilotPluginInfo.Id===zg.j.ENTERPRISE_SEARCH})))>=0})))>=0&&(this.restrictedSearchConfigResponse=null===(t=i.pluginProperties)||void 0===t?void 0:t.enterpriseRestrictedSearch),[2,null!==(o=null===(n=i.installedPlugins)||void 0===n?void 0:n.PluginGroups.flatMap(gm))&&void 0!==o?o:[]]);case 2:return a=r.sent(),this.logFailure("Exception in getInstalledPlugins: "+a.message),[2,void 0];case 3:return[2]}}))}))},e.prototype.getChatHistoryEnabledPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.chatHistoryEnabledPluginsSource.awaitChatHistoryPlugin()];case 1:return e=t.sent(),[2,new Set(e)];case 2:return t.sent(),[2,new Set];case 3:return[2]}}))}))},e}();function gm(e){return(null==e?void 0:e.PluginDescriptions)?e.PluginDescriptions.map((function(t){return function(e,t){var n,r,o,i,a,s;if(!t.CopilotPluginInfo.Id)return;var l=null!==(n=e.DisplayName)&&void 0!==n?n:t.DisplayName;if(!l)return;return{icon:null!==(i=null!==(o=null!==(r=e.IconUrl)&&void 0!==r?r:e.IconBase64)&&void 0!==o?o:t.IconUrl)&&void 0!==i?i:t.IconBase64,name:l,metaOSAppId:e.MetaOSAppId,id:null!==(a=t.CopilotPluginInfo.Id)&&void 0!==a?a:e.MetaOSAppId,state:e.IsDisabledByAdmin?"blocked":"acquired",source:null!==(s=t.CopilotPluginInfo.Source)&&void 0!==s?s:"",type:hm(t.CopilotPluginInfo.Id),isEnabled:!1,rank:0}}(e,t)})).filter((function(e){return!!e})):[]}function hm(e){return e?e.includes("MessageExtension")?"MsgExt":e.includes("BingWebSearch")?"FirstParty":e.includes("DataVerse")?"DataVerse":e.includes("PowerPlatform")?"PowerPlatform":"Unsupported":"Unsupported"}var fm=function(){this.getProps=function(e){return{buttonText:e.buttonText,icon:e.icon,onClick:e.onClick}}},mm=n(571),vm=n(752),bm=function(){function e(){this.telemetryLoggerUtils=eh.a.getInstance()}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d;return{tag:null!==(t=Si.h[e.tag].toString())&&void 0!==t?t:"",name:null!==(r=null===(n=Si.g[e.name])||void 0===n?void 0:n.toString())&&void 0!==r?r:"",source:null!==(i=null===(o=e.source)||void 0===o?void 0:o.toString())&&void 0!==i?i:"",duration:null!==(s=null===(a=e.duration)||void 0===a?void 0:a.toString())&&void 0!==s?s:"",success:null!==(c=null===(l=Si.j[e.success])||void 0===l?void 0:l.toString())&&void 0!==c?c:"",correlationVector:null!==(d=null===(u=e.correlationVector)||void 0===u?void 0:u.toString())&&void 0!==d?d:""}},e.prototype.LogEvent=function(e){if(Object(Dg.c)("MsgExtCardTelemetry Info: ",e),e.type&&e.tag&&e.name){var t=this.getRecord(e),n="";try{n=JSON.stringify(t)}catch(e){return void Object(Dg.c)("Error while stringifying chatEventData:",e)}switch(e.type){case vm.e.LogInfo:case vm.e.LogMetric:this.logInfo(n);break;case vm.e.LogError:case vm.e.LogException:this.logError(t)}}},e.prototype.logInfo=function(e){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MsgExtCardDataReceived},{key:_g.g.ChatEventParameters,value:e}])},e.prototype.logError=function(e){var t=(null==e?void 0:e.message)||"";this.telemetryLoggerUtils.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:t},{key:_g.h.ErrorType,value:_g.e.Server},{key:_g.h.ErrorCode,value:zg.g.MsgExtCardError},{key:_g.h.ErrorCategory,value:dm.d.ChatEvents}])},e}(),ym=function(){function e(){this.telemetryLogger=new bm}return e.prototype.LogInfo=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogError=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogException=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogWarning=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogVerbose=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogMetric=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e}(),Cm=null,Om=null,Sm=null,Em=!1,xm="",Im="",wm=0,Tm=f.forwardRef((function(e,t){var n,s,l,c,u,d,p,h,v,y,C,O,E,x,I,w,T,k,j,P,A,_,D,L,B,R,F,N,H,U,V,z,G,W,Q,q,K,Y=e.style,Z=e.platformType,J=void 0===Z?o.a.web:Z,X=e.copilotCommunicationHandler,te=e.copilotTelemetryHandler,ne=void 0===te?new Ah.b:te,re=e.theme,ie=void 0===re?Gg:re,ae=e.themeV2,se=void 0===ae?void 0:ae,le=e.useALRuntime,ce=void 0!==le&&le,ue=e.chatUiProps,de=e.designerProps,pe=e.basicChatProps,ge=e.debugProps,he=e.copilotPluginProps,fe=Object(f.useRef)((new Date).getTime());Object(o.e)(J);var me=null!==(n=ue.chatInputProps)&&void 0!==n?n:ue.chatInputV2Props,ve=ue.chatInputV2Props,be=null!==(s=me.isHVCAppChatV2Enabled)&&void 0!==s&&s,ye=null!==(l=me.hvcPromptStrings)&&void 0!==l?l:[],Ce=null!==(c=me.hvcPromptStringsList)&&void 0!==c?c:[],Oe=null!==(u=me.useSortedHVCTokenList)&&void 0!==u&&u,Se=me.onChatInputHVCPromptUpdated,Ee=null!==(d=me.onUserQuerySubmitted)&&void 0!==d?d:function(){},xe=ue.clientInfoProps?ue.clientInfoProps.clientInfo:Object(M.d)(),Ie=ue.clientInfoProps?null===(p=ue.clientInfoProps)||void 0===p?void 0:p.taskModuleLauncher:void 0,we=null!==(h=null==ve?void 0:ve.shouldInitializeEditorInChatInput)&&void 0!==h&&h,Te=Kg.a.getInstance(X),ke=eh.a.getInstance(),je=Object(r.__read)(Object(f.useState)(!1),2),Pe=je[0],Ae=je[1],_e=null===(v=null==he?void 0:he.copilotList.find((function(e){return e.isDefaultCopilot})))||void 0===v?void 0:v.id,De=null===(y=null==he?void 0:he.copilotList.find((function(e){return e.isSelected})))||void 0===y?void 0:y.id,Le=he&&he.copilotList.length>1,Me=null!==(C=(null==he?void 0:he.showNewChatButtonOnTop)&&Le)&&void 0!==C&&C,Be=Object(r.__read)(f.useState(f.createElement(f.Fragment,null)),2),Re=Be[0],Fe=Be[1],He=Object(r.__read)(f.useState(!1),2),Ue=He[0],Ve=He[1],ze=function(e,t){Ve(t.open);var n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};Te.sendLoggingEventToClient(Pg.g.CopilotSwitcherMenuStateChange,n)},Ge=void 0!==se,We=Oh(),Qe=Sh();Eh(Ge?Qe:We,Y);var qe=Object(r.__read)(Object(f.useState)([]),2),Ke=qe[0],Ye=qe[1],Ze=Object(r.__read)(Object(f.useState)(zg.c.Shy),2),Je=Ze[0],Xe=Ze[1],$e=Object(f.useRef)(),et=new qg.a(Ye,X,$e),tt=Object(f.useRef)(null),nt=Object(f.useRef)(null),rt=Object(f.useRef)(null),ot=Object(f.useRef)(!1),it=Object(r.__read)(Object(f.useState)(!1),2),at=it[0],st=it[1],lt=f.useCallback((function(){return at}),[at]),ct=Object(r.__read)(Object(f.useState)(),2),ut=ct[0],dt=ct[1],pt=Object(f.useRef)(0),gt=Object(f.useRef)(),ht=Object(r.__read)(Object(f.useState)(!1),2),ft=ht[0],mt=ht[1],vt=Object(r.__read)(Object(f.useState)(!1),2),yt=vt[0],Ct=vt[1],Ot=Object(r.__read)(Object(f.useState)(!1),2),St=Ot[0],Et=Ot[1],xt=Object(r.__read)(Object(f.useState)(!0),2),It=xt[0],wt=xt[1],Tt=Object(r.__read)(Object(f.useState)(!1),2),kt=Tt[0],jt=Tt[1],Pt=Object(r.__read)(Object(f.useState)([]),2),At=Pt[0],_t=Pt[1],Dt=Object(r.__read)(Object(f.useState)(!1),2),Lt=Dt[0],Mt=Dt[1],Bt=Object(r.__read)(Object(f.useState)(!1),2),Rt=Bt[0],Ft=Bt[1],Nt=Object(r.__read)(Object(f.useState)({loadingUiStringList:sh(),shouldShowLoadingUi:!0}),2),Ht=Nt[0],Ut=Nt[1],Vt=Object(r.__read)(Object(f.useState)({headerText:Vg.w,descriptionText:Vg.w}),2),zt=Vt[0],Wt=Vt[1],Qt=ue.tipCardProps,qt=Object(r.__read)(Object(f.useState)(!1),2),Kt=qt[0],Yt=qt[1],Zt=Object(r.__read)(Object(f.useState)(!1),2),Jt=Zt[0],Xt=Zt[1],$t=Object(r.__read)(Object(f.useState)(Gg),2),tn=$t[0],nn=$t[1],rn=Object(r.__read)(Object(f.useState)(Wg),2),on=rn[0],an=rn[1],sn=Object(r.__read)(Object(f.useState)(!1),2),ln=(sn[0],sn[1]),cn=Object(r.__read)(Object(f.useState)(void 0!==ue.freUiProps),2),dn=cn[0],pn=cn[1],gn=Object(r.__read)(Object(f.useState)(!1),2),hn=gn[0],fn=gn[1],mn=Object(r.__read)(Object(f.useState)(!1),2),vn=mn[0],bn=mn[1],yn=Object(r.__read)(Object(f.useState)(Xg.Uninitialized),2),On=yn[0],Sn=yn[1],En=Object(r.__read)(Object(f.useState)(!1),2),xn=En[0],In=En[1],wn=Object(r.__read)(Object(f.useState)(!1),2),Tn=wn[0],kn=wn[1],jn=Object(f.useRef)(!1),Pn=Object(f.useRef)(),An=Object(r.__read)(Object(f.useState)(!1),2),_n=An[0],Ln=An[1],Mn=ce,Bn=f.useRef(),Rn=Object(r.__read)(Object(f.useState)(),2),Fn=Rn[0],Hn=Rn[1],Un=Object(r.__read)(Object(f.useState)(),2),Vn=Un[0],zn=Un[1],Gn=Object(r.__read)(f.useState(!1),2),Wn=Gn[0],Qn=Gn[1],qn=Object(r.__read)(f.useState([]),2),Kn=qn[0],Yn=qn[1],Zn=Object(r.__read)(Object(f.useState)(!1),2),Jn=Zn[0],$n=Zn[1],er=Object(r.__read)(Object(f.useState)(!1),2),tr=er[0],nr=er[1],rr=Object(r.__read)(Object(f.useState)(),2),or=rr[0],ir=rr[1],ar=Object(r.__read)(Object(f.useState)(ue.copilotWorkflowProps),2),sr=ar[0],lr=ar[1],cr=Object(r.__read)(Object(f.useState)(0),2),ur=cr[0],dr=cr[1],pr=Object(r.__read)(Object(f.useState)(!1),2),gr=pr[0],hr=pr[1],fr=Object(r.__read)(Object(f.useState)(null),2),mr=fr[0],vr=fr[1],br=Object(r.__read)(Object(f.useState)(null),2),yr=br[0],Cr=br[1],Or=Object(f.useRef)(!1),Sr=Object(f.useRef)(),Er=Object(f.useRef)(!0),xr=Object(r.__read)(Object(f.useState)(!1),2),Ir=xr[0],wr=xr[1],Tr=Object(r.__read)(Object(f.useState)(!1),2),kr=Tr[0],jr=Tr[1],Pr=Object(r.__read)(Object(f.useState)([]),2),Ar=Pr[0],_r=Pr[1],Dr=Object(r.__read)(Object(f.useState)(!1),2),Lr=Dr[0],Mr=Dr[1],Br=Object(r.__read)(Object(f.useState)(!1),2),Rr=Br[0],Fr=Br[1],Nr=Object(r.__read)(Object(f.useState)(!1),2),Hr=Nr[0],Ur=Nr[1],Vr=f.useRef(!1),zr=f.useRef(!1),Gr=f.useRef(void 0),Wr=new ch,Qr=new ih,qr=null===(O=ue.toggleUiProps)||void 0===O?void 0:O.trySydneyToggleEnabled,Kr=null===(E=ue.toggleUiProps)||void 0===E?void 0:E.tryEnterpriseSearchToggleEnabled,Yr=null===(x=ue.toggleUiProps)||void 0===x?void 0:x.tryWebSearchToggleEnabled,Zr=null===(I=ue.toggleUiProps)||void 0===I?void 0:I.tryReviewerAgentToggleEnabled,Jr=new fh,Xr=new Mh,$r=new Uf,eo=new ah(ue.hintCardProps),to=new Vh,no=new am,ro=new Hf,oo=new fm,io=function(){var e;return we?null===(e=$e.current)||void 0===e?void 0:e.getChatEditorInstance():Fn},ao=!!(null===(w=ue.copilotWorkflowProps)||void 0===w?void 0:w.enableWorkflowPlugin)&&ue.copilotWorkflowProps.enableWorkflowPlugin,so=null!==(k=null===(T=null==me?void 0:me.voiceInputProps)||void 0===T?void 0:T.handleInChatInput)&&void 0!==k&&k,lo=null!==(j=ue.zeroQueryMessageProps)&&void 0!==j?j:ue.zeroQueryMessageV2Props,co=ue.copilotLabProps;ie=null!=ie?ie:se;var uo=-1,po=function(){var e,t,n,r,o;Object(Dg.c)("handleEditorOpenButtonClick"),Or.current=!0;var i=Zc.a,a=null!==(e=null==go?void 0:go.ciqPlaceholderText)&&void 0!==e?e:Object(Vg.Y)();null===(t=$e.current)||void 0===t||t.setInputText(i),null===(n=$e.current)||void 0===n||n.setGhostText(a),null===(r=$e.current)||void 0===r||r.setFocus(),null===(o=io())||void 0===o||o.forceInvokeCIQMenu(Zc.a)};(null==me?void 0:me.voiceInputProps)&&Object(Dg.n)()&&(me.voiceInputProps=void 0);var go=null==me?void 0:me.editorConfig,ho=function(){return X.isFeatureGateEnabledFromClient(zg.h.IsDebugSectionV2Enabled)};jg.a.isDevbuild()&&((null==ge?void 0:ge.isDebugToggleEnabled)||ho())&&Lh.a.initialize();var fo,mo=!0;Object(f.useImperativeHandle)(t,(function(){return{addResponseMessage:jo.current.addResponseMessage,updateMessage:jo.current.updateMessage,resendChatHistorySignal:jo.current.resendChatHistorySignal,updateLastMessage:jo.current.updateLastMessage,deleteMessage:jo.current.deleteMessage,submitOperation:jo.current.submitOperation,updateLoadingComponentProps:jo.current.updateLoadingComponentProps,addChatMessages:jo.current.addChatMessages,getLastMessage:function(e){if(pt.current>0)return Ke[Object(Dg.g)(Ke,e)]},clearMessages:jo.current.clearMessages,startLoadingUi:jo.current.startLoadingUi,startReinitializeALSession:jo.current.startReinitializeALSession,setInputAreaText:jo.current.setInputAreaText,setInputFocus:jo.current.setInputFocus,getInputText:jo.current.getInputText,submitUserQuery:jo.current.submitUserQuery}}));var vo=function(e,t,n){et.setChatMessageData(e,t,n)},bo=function(){var e;return we?null===(e=$e.current)||void 0===e?void 0:e.getCIQResponseHandler():Vn},yo=function(){var e;return we?null===(e=$e.current)||void 0===e?void 0:e.getCIQTextRef():Pn.current},Co=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return yo()?e?[4,go.getSensitivityInfo(e)]:[3,2]:[3,4];case 1:return n=r.sent(),[3,3];case 2:n=null,r.label=3;case 3:t=n,$n(!1),yo().setSensitivity(t),Et(!1),r.label=4;case 4:return[2]}}))}))},Oo=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return yo()?[4,go.getSensitivityInfo(null)]:[3,2];case 1:e=t.sent(),yo().setSensitivity(e),$n(!1),t.label=2;case 2:return[2]}}))}))},So=function(){var e;return(null===(e=$e.current)||void 0===e?void 0:e.getInputText())||""},Eo=function(){var e;null===(e=tt.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},xo=function(e){return void 0===e&&(e=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Fo(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),Object(Dg.c)("Exception occurred during initialization of AL"+t.message),[3,3];case 3:return[2]}}))}))},Io=function(e){var t,n,r,o,i,a,s,l;if(e){ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophoneLoadingTimeInMs},{key:_g.g.ChatEventParameters,value:Pm(xh)}]);var c=(null===(t=$e.current)||void 0===t?void 0:t.getInputText().length)>0&&mo?Vg.f:Vg.w;null===(n=$e.current)||void 0===n||n.setGhostText(c+Object(Vg.tb)())}else(null===(r=$e.current)||void 0===r?void 0:r.getInputText())===Vg.w?null===(o=$e.current)||void 0===o||o.setGhostText(null!==(i=null==me?void 0:me.chatPlaceholderMessage)&&void 0!==i?i:Vg.m):(null===(s=null===(a=$e.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())===Object(Vg.tb)()&&(null===(l=$e.current)||void 0===l||l.setGhostText(Vg.w));kn(e),jn.current=e};Object(f.useEffect)((function(){if(De!==_e){var e=null==he?void 0:he.copilotList.find((function(e){return e.id===De}));e&&e.copilotComponent&&Fe(e.copilotComponent)}}),[null==he?void 0:he.copilotList,_e,De]),Object(f.useEffect)((function(){if(X.isFeatureGateEnabledFromClient(zg.h.IsChatHistoryPaginationEnabled)){var e=rt.current;if(e){var t=0,n=!0,o=function(){rt.current.scrollHeight-Math.round(rt.current.scrollTop)-Vg.J<=rt.current.clientHeight?n=!1:!ot.current&&Tg.d&&!n&&Math.round(e.scrollTop)<=Math.round(rt.current.scrollHeight/Vg.C)&&t!=e.scrollHeight&&(nr(!0),t=e.scrollHeight,dr(t),Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(Tg.b)(bg.c.GetMessagesOperation,void 0,void 0,X)];case 1:return e.sent(),[2]}}))}))),Tg.d||e.removeEventListener("scroll",o)};e.addEventListener("scroll",o)}}}),[rt.current,It]),Object(f.useEffect)((function(){Object(Tg.j)(ue.documentSensitivityProps)}),[ue.documentSensitivityProps]),Object(f.useEffect)((function(){yo()||(Et(!1),$n(!1))}),[yo]),Object(f.useEffect)((function(){lr((function(e){return Object(r.__assign)(Object(r.__assign)({},e),ue.copilotWorkflowProps)}))}),[ue.copilotWorkflowProps]),Object(f.useEffect)((function(){Eo()}),[null===(P=ue.streamingUiProps)||void 0===P?void 0:P.cardDataValue,Kn,ft,Ht]),Object(f.useEffect)((function(){var e;if(ft)Te.sendLoggingEventToClient(Pg.g.QueryExecutionStarted);else{Object(Zg.b)(Vg.w),Te.sendLoggingEventToClient(Pg.g.QueryExecutionCompleted);var t=Vg.w;X.isFeatureGateEnabledFromClient(zg.h.EnableALCorrelationLogs)&&(t=mm.a.getInstance().getQueryCv()),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.QueryExecutionCompleted},{key:_g.g.Cv,value:t},{key:_g.g.ALSessionKey,value:mm.a.getInstance().getAlSessionKey()}]),xm="";try{uh.a.getInstance().getIsBasicChatStreaming()&&uh.a.getInstance().resetBasicChatStreamingStates()}catch(e){Object(Dg.c)("An error was thrown while trying to reset basic chat streaming. "+e)}}null===(e=jo.current)||void 0===e||e.setLocalIsExecuting(ft)}),[ft]),Object(f.useEffect)((function(){!dn&&(null==lo?void 0:lo.promptSuggestionList.length)>0&&(Te.sendLoggingEventToClient(Pg.g.ZQMLoaded),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ZQMLoaded}]))}),[dn]),Object(f.useEffect)((function(){return gt.current=new jg.a(X.getHostSettings()),Po.current.updateLocale(jg.a.getLanguage()),eh.a.setTelemetryHandler(ne),Cm=Ug.getInstance(),Rg.getInstance().initTelemetryLatencyObject(),Te.sendLoggingEventToClient(Pg.g.ChatPaneInitalized,{timestamp:(new Date).getTime()}),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatPaneInitialized},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}]),Qg.a.getInstance(X),Object(Dg.o)()?kg.a.getInstance(wt,wr):wt(!1),xo(),wm=0,X.updateCopilotState(Pg.d.IDLE),Gr.current=new gh($e,ko,null==me?void 0:me.chatPlaceholderMessage,vo,Yn,X.isFeatureGateEnabledFromClient(zg.h.IsSuggestedQnACitationsEnabled)),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatInputEarlyLoadEnabled},{key:_g.g.ChatEventParameters,value:X.isFeatureGateEnabledFromClient(zg.h.ChatInputEarlyLoadEnabled)?"true":"false"}]),Cr(jm(Om)),Object(i.f)(void 0!==se),function(){wg.a.getInstance().clearAugloopResponseTimer(),Ig.a.getInstance().releaseActiveAnnotations(),Object(Dg.t)(),Object(Dg.u)()}}),[]),Object(f.useEffect)((function(){kt&&(xo(!0),jt(!1))}),[kt]),Object(f.useEffect)((function(){var e;Tn||Object(tu.d)(Io).catch((function(e){Object(Dg.c)("pauseMicandStopTimer Error"+e),Dh.a.Instance.ErrorMessage="Error_PauseMic_StopTimer"})),null===(e=$e.current)||void 0===e||e.setFocus()}),[Tn]),Object(f.useEffect)((function(){window.addEventListener("blur",(function(){var e;null===(e=$e.current)||void 0===e||e.closeMenu(),hi(),(null==me?void 0:me.voiceInputProps)&&jn.current&&Io(!1)}))})),Object(f.useEffect)((function(){tr?ft||(rt.current.scrollTop=rt.current.scrollHeight-ur):Eo(),nr(!1),pt.current=Ke.length,dn&&Ke.length>0&&pn(!1)}),[Ke,dn]),Object(f.useEffect)((function(){It||(Eo(),at&&(ke.sendTelemetryLatencyData([{key:_g.k.ChatHistoryTimeInLoad,value:jm(Tg.e)}]),ke.sendTelemetryLatencyData([{key:_g.k.CopilotChatLoadTime,value:jm(fe.current)}]),X.sendEventToClient(Pg.c.CopilotChatLoaded),Te.sendLoggingEventToClient(Pg.g.ChatPaneLoaded,{timestamp:(new Date).getTime()}),vr(jm(Om)),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatPaneLoaded},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}]),!dn&&(null==lo?void 0:lo.promptSuggestionList.length)>0&&(Te.sendLoggingEventToClient(Pg.g.ZQMLoaded),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ZQMLoaded}]))))}),[It,at]),Object(f.useEffect)((function(){Ir&&(X.sendEventToClient(Pg.c.ChatHistoryHydrationFailed),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatHistoryHydrationFailed}]),ot.current=Ir,$o.onChatHistoryPluginInfo([]))}),[Ir]),Object(f.useEffect)((function(){var e;ie.isDarkModeEnabled?(Object(i.d)(i.a.defaultBlack),Fn&&Fn.updateCurrentTheme(Jc.a.dark)):(Object(i.d)(i.a.defaultWhite),Fn&&Fn.updateCurrentTheme(Jc.a.light)),ao&&Fn&&(null===(e=null==ue?void 0:ue.copilotWorkflowProps)||void 0===e?void 0:e.enableEditorForSelectFileStage)&&lr((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{handleEditorOpenButtonClick:po})})),ie.isHighContrastModeEnabled?Object(i.e)(!0):Object(i.e)(!1),nn(ie),an(se),Po.current.updateDarkMode(ie.isDarkModeEnabled)}),[ie,Fn]),Object(f.useEffect)((function(){var e,t;((null===(e=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===e?void 0:e.clearCacheSuggestionPills)||(null===(t=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===t?void 0:t.suggestionList.length)>0)&&Gr.current.setSuggestedQnAList([])}),[null==ue?void 0:ue.suggestionPillsUiProps]),Object(f.useEffect)((function(){et&&mt&&X&&(uh.a.getInstance(et,X,mt),uh.a.getInstance().setBasicChatProps(pe))}),[pe]),Object(f.useEffect)((function(){var e;_n&&ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.TrySydneyToggle},{key:_g.g.ChatEventParameters,value:(null===(e=ue.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[_n]),Object(f.useEffect)((function(){var e;ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.IsSydneyEnabled},{key:_g.g.ChatEventParameters,value:(null===(e=ue.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[null===(A=ue.toggleUiProps)||void 0===A?void 0:A.trySydneyToggleChecked]),Object(f.useEffect)((function(){if(!we&&go&&!Bn.current&&ut){var e=(new Xc.a).createInstance();go.telemLogger.logErrorTelemetry=function(e,t){ke.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:t},{key:_g.h.ErrorCategory,value:e}])},go.telemLogger.logSuccessTelemetry=function(e,t){t?ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:e},{key:_g.g.ChatEventParameters,value:t}]):ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:e}])},e.bootstrap(Object(Dg.d)(go,ut)).then((function(t){Bn.current=e,Hn(t)}))}return function(){Bn.current&&Bn.current.shutdown().then((function(){Bn.current=void 0}))}}),[ut,go]),Object(f.useEffect)((function(){Xt((null==Qt?void 0:Qt.isError)&&(null==Qt?void 0:Qt.headerText)&&!dn&&!ft)}),[Qt,dn,ft]),Object(f.useEffect)((function(){Ct(ft||(null==Qt?void 0:Qt.isError)||(null==me?void 0:me.isDisabled)||(null==ve?void 0:ve.isDisabled)||wo())}),[ft,Qt,me,ve]),Object(f.useEffect)((function(){var e;ve&&(null==ve?void 0:ve.groundingSourcePickerProps)&&!(null===(e=null==ve?void 0:ve.buttonProps)||void 0===e?void 0:e.groundingButtonEnabled)&&(hr(!0),Object(nh.g)(!0))}),[ve]),Object(f.useEffect)((function(){jo.current.setIsDisabled(yt)}),[yt]),Object(f.useEffect)((function(){(null==co?void 0:co.copilotLabLink)&&Po.current.updateCopilotLabLink(null==co?void 0:co.copilotLabLink),(null==co?void 0:co.isCopilotLabHeaderDisabled)&&Po.current.updateIsHeaderDisabled(null==co?void 0:co.isCopilotLabHeaderDisabled),(null==co?void 0:co.facets)&&Po.current.updateFacets(null==co?void 0:co.facets)}),[co]),Object(f.useEffect)((function(){if(Po.current.updatePrompts(At),!(null==co?void 0:co.facets)){var e=Object(dh.a)(At);Po.current.updateFacets({displayCategory:e})}}),[At]);var wo=function(){return X.isFeatureGateEnabledFromClient(zg.h.IsDisableChatInputWhenAlSessionCloseEnabled)&&vn};Object(f.useEffect)((function(){var e,t,n;X.isFeatureGateEnabledFromClient(zg.h.IsDisableChatInputWhenAlSessionCloseEnabled)&&(null===(e=$e.current)||void 0===e||e.setInputText(""),null===(t=$e.current)||void 0===t||t.setGhostText(null!==(n=null==me?void 0:me.chatPlaceholderMessage)&&void 0!==n?n:Vg.m),Ct(vn),vn&&ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatInputDisabledAndBannerShownForInActiveChatSession}]))}),[X,vn]);var To=function(e){return!!yi()&&(Object(Dg.c)("Setting pane load warning banner as chat history is still loading."),hn||fn(!0),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ChatPaneLoadMessageBarShown},{key:_g.g.ChatEventParameters,value:e.toString()}]),!0)},ko=function(e){var t=e.text,n=e.links,i=e.telemetryData,s=e.queryAnnotations;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,l,c,u,d,p,g,h;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return t&&0!==t.length||0!==So().length?(xm=Object(xg.a)(),wm++,Sm=(new Date).getTime(),Ee(),Er.current&&(Object(Dg.c)("First Query submitted by User"),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.FirstQuerySubmitted},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}]),eh.a.getInstance().sendTelemetryLatencyData([{key:_g.k.IsFirstSdxSessionQuery,value:!0}]),Er.current=!1),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:null!=i?i:_g.f.EnterKeyPressed},{key:_g.g.ChatEventParameters,value:(new Date).getTime().toString()}]),Object(Zg.a)()!==Vg.w&&ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.CopilotLabPromptSubmitted}]),(null==s?void 0:s.length)>0&&(e=s.map((function(e){return e.QueryAnnotationType})),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.PromptSubmittedWithCIQ},{key:_g.g.ChatEventParameters,value:JSON.stringify(e)}])),Ut((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),X.updateCopilotState(Pg.d.QUERY_ENTERED),X.sendEventToClient(Pg.c.QuerySubmitted),Dh.a.Instance.NewChatInitiated(),Ln(!0),(null==me?void 0:me.voiceInputProps)&&Io(!1),l=t?t.trim():So().trim(),Im=l,c=function(){var e,t,n=null!==(t=null===(e=$e.current)||void 0===e?void 0:e.getImages())&&void 0!==t?t:[];return Object(r.__spreadArray)([],Object(r.__read)(n),!1)}(),function(e){var t;null===(t=$e.current)||void 0===t||t.setGhostText(e)}(null!==(g=null==me?void 0:me.chatPlaceholderMessage)&&void 0!==g?g:Vg.m),function(){var e;null===(e=$e.current)||void 0===e||e.removeImages()}(),dn&&pn(!1),Object(Dg.c)("User query Entered : ".concat(l)),function(e){var t;null===(t=$e.current)||void 0===t||t.setInputText(e)}(Vg.w),J===o.a.IOS&&Xe(zg.c.Shy),Yt(!1),ln(!1),mt(!0),c.length>0&&vo(a.a.ContentCard,{contentCardProps:{user:zg.e.Chat,cardContent:{contentBody:f.createElement(f.Fragment,null,c.map((function(e,t){return f.createElement("img",{src:e,key:t,alt:"Visual content of chat prompt",width:"50px"})})))}}}),vo(a.a.MarkdownCard,{markDownCardProps:Object(Dg.a)(l,n)}),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.QuerySubmittedByUser},{key:_g.g.IsMicrophoneInvolvedInQueryInput,value:Dg.q.toString()}]),Object(Dg.x)(!1),[4,X.shouldSendRequestToAugloop(l,n,s,xm)]):[2];case 1:return m.sent()?l!==Object(Vg.Q)()||(null===(h=ue.changeTopicUiProps)||void 0===h?void 0:h.hideChangeTopicButton)?[3,3]:(Em=!0,Ut((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{loadingUiStringList:[sh()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,Object(Tg.b)(bg.c.AddChatOperation)]):(mt(!1),[2]);case 2:return m.sent(),[2];case 3:return m.trys.push([3,7,,8]),lt?[3,5]:[4,Vo()];case 4:m.sent(),m.label=5;case 5:return u=X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled)?ei.getEnabledPlugins():[],[4,X.getDefaultSignalOperation(l,xm,Tg.c,n,s,u,c)];case 6:return d=m.sent(),wg.a.getInstance().setAugloopResponseTimer(d.workflowAnnotationType),Ig.a.getInstance().submitOperation(d.operation,d.workflowAnnotationType),X.updateCopilotState(Pg.d.QUERY_SUBMITTED),Object(Dg.c)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(d.operation)+"\nat Time : "+new Date+"\n\n\n"),[3,8];case 7:return p=m.sent(),Object(Dg.c)("CopilotChat Log: Exception:"+JSON.stringify(p)+" Error message: "+p.message),Dh.a.Instance.ErrorMessage="Exception_Query_Submission_Failed",X.updateCopilotState(Pg.d.QUERY_SUBMITTED_FAILED),wg.a.getInstance().clearAugloopResponseTimer(),vo(a.a.Default,{defaultMessageProps:{user:zg.e.Chat,messageHeader:{text:"".concat(Vg.a)},embeddedLists:[]}}),X.updateCopilotState(Pg.d.IDLE),ke.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:"Error in handle submit: "+p.message},{key:_g.h.ErrorType,value:_g.e.Client},{key:_g.h.ErrorCode,value:zg.g.HandleSubmitError},{key:_g.h.ErrorCategory,value:Ag.a.ChatEvents}]),ke.sendTelemetryLatencyData([{key:_g.k.UserPerceivedLatency,value:jm(Sm)},{key:_g.k.IsQuerySuccess,value:!1}],!0),mt(!1),[3,8];case 8:return[2]}}))}))},jo=Object(f.useRef)(new vh(mt,Ut,ko,et,$e,io,jt,go?go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w:null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage,yt)),Po=Object(f.useRef)(Object(Yg.a)(jo,$e,ie.isDarkModeEnabled)),Ao=function(e){Wt(eo.getProps(e)),Yt(eo.shouldShowHintCard(e))},_o=function(){Ro()?Ye([]):X.sendEventToClient(Pg.c.ChatTopicChanged),Em=!1,mt(!1)},Do=function(){Object(Zg.b)(Vg.w),Object(Dg.c)("Change Topic Button Clicked."),Gr.current.setSuggestedQnAList([]),ko({text:Object(Vg.Q)()})},Lo=f.useCallback((function(e){e.length>0?_r((function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(e),!1)})):Ur(!0),jr(!1),Fr(!1)}),[]),Mo=f.useCallback((function(e){e&&Ye((function(t){return e(t)})),mt(!1),Vr.current=!1}),[]),Bo=f.useCallback((function(){Mr(!1),zr.current=!0}),[]),Ro=f.useCallback((function(){var e;return null===(e=ue.chatHistoryUiProps)||void 0===e?void 0:e.enableChatHistoryV2}),[ue]),Fo=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=(new Date).getTime(),Om=t,Mn?[3,2]:[4,X.getALSession()];case 1:return n=i.sent(),dt(n),[3,5];case 2:return[4,Object(Dg.e)(X.getAuthToken(),!1)];case 3:return[4,i.sent().getSession()];case 4:n=i.sent(),dt(n),i.label=5;case 5:Ig.a.getInstance(et,X,n,mt,bn),wg.a.getInstance(X,Oo),uh.a.getInstance(et,X,mt),uh.a.getInstance().setBasicChatProps(pe),ke.sendTelemetryLatencyData([{key:_g.k.AugloopInitializationTime,value:jm(t)}]),Te.sendLoggingEventToClient(Pg.g.ALSessionInitialized,{timeInMs:Pm(t)}),i.label=6;case 6:return i.trys.push([6,10,,11]),[4,Vo(e)];case 7:return i.sent(),so?[3,9]:[4,Ko(n)];case 8:i.sent(),i.label=9;case 9:return Object(Dg.c)("Augloop Initialized. Time Taken : ".concat(jm()," sec")),[3,11];case 10:throw o=i.sent(),Object(Dg.c)("Failure in Augloop Initialization: "+JSON.stringify(o)+" Error message: "+o.message),ke.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:"Failure in Augloop Initialization: "+o.message},{key:_g.h.ErrorType,value:_g.e.Client},{key:_g.h.ErrorCode,value:zg.g.AugloopInitializationError},{key:_g.h.ErrorCategory,value:Ag.a.Augloop}]),o;case 11:return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return ve&&(X.isFeatureGateEnabledFromClient(zg.h.IsPersistanceInPhase2UxEnabled)&&(null==ve?void 0:ve.pluginsInfo)&&(null===(o=null==ve?void 0:ve.pluginsInfo)||void 0===o?void 0:o.length)>0||X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled))?(e=function(e){var t,n,r;X.sendEventToClient(Pg.c.PluginsStateUpdated,e);var o=!1,i=e.pluginsInfo.findIndex((function(e){return e&&e.id===zg.j.ENTERPRISE_SEARCH&&e.state===Vg.E}))>=0;X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled)?o=e.pluginsInfo.findIndex((function(e){return e&&e.id===zg.j.WEB_SEARCH&&e.state===Vg.E&&e.isEnabled}))>=0:(i=null!==(n=(null===(t=null==ve?void 0:ve.pluginsInfo.find((function(e){return e.id===$c.a.Work})))||void 0===t?void 0:t.state)===eu.a.Enabled)&&void 0!==n?n:i,o=(null===(r=null==ve?void 0:ve.pluginsInfo.find((function(e){return e.id===$c.a.Web})))||void 0===r?void 0:r.state)===eu.a.Enabled),Object(nh.e)(i,o)},t=(new Date).getTime(),[4,Bf(null==ve?void 0:ve.pluginsInfo,ei,e,X.isFeatureGateEnabledFromClient(zg.h.IsWebSearchDefaultOn),X.isFeatureGateEnabledFromClient(zg.h.IsEnterpriseSearchDefaultOn))]):[2];case 1:return n=r.sent(),ke.sendTelemetryLatencyData([{key:_g.k.PluginsConfig3SFetchTime,value:jm(t)}]),Object(Dg.c)("resolved plugins initial state using copilot brokering WF annotations"),Ft(ei.getRestrictedSearchMode()===Vg.H||X.isFeatureGateEnabledFromClient(zg.h.ShowRestrictiveSearchBanner)),ir(n),uo=0,[2]}}))})),[2]}}))}))};function No(e,t){var n;return void 0===t&&(t=Vg.w),Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,l,c,u,d;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:Object(Dg.c)("sharedAugloopAnnotationHandler op: ",e),Object(Dg.c)("sharedAugloopAnnotationHandler cv: ",t),p.label=1;case 1:p.trys.push([1,22,23,24]),o=Object(r.__values)(e.items),i=o.next(),p.label=2;case 2:if(i.done)return[3,21];switch(a=i.value,Dh.a.Instance.Observe(a.body),(null==(s=null===(n=a.body)||void 0===n?void 0:n.H_)?void 0:s.T_)&&ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ALAnnotationReceived},{key:_g.g.ChatEventParameters,value:null==s?void 0:s.T_},{key:_g.g.Cv,value:t},{key:_g.g.ALSessionKey,value:mm.a.getInstance().getAlSessionKey()}]),null==s?void 0:s.T_){case yg.a.getTypeName():case yg.c.getTypeName():case yg.b.getTypeName():return[3,3];case Og.b.getTypeName():return[3,4];case Og.a.getTypeName():return[3,7];case Og.c.getTypeName():return[3,10];case Bh.a.getTypeName():return[3,13];case Sg.a.getTypeName():return[3,15];case Cg.a.getTypeName():return[3,17];case Ff.a.getTypeName():return[3,18]}return[3,20];case 3:return Object(Tg.a)(a,Ye,pt.current,X,Em?_o:void 0,(function(e){return $o.onChatHistoryPluginInfo(e)}),Lo,Vr.current?Mo:void 0,Ro(),t),[3,20];case 4:return[4,X.shouldIgnoreResponse(a)];case 5:return p.sent()?[2]:[4,jh(a,et,mt,Sm,t)];case 6:return p.sent(),[3,20];case 7:return[4,X.shouldIgnoreResponse(a)];case 8:return p.sent()?[2]:[4,kh(a,et,mt,Sm,t)];case 9:return p.sent(),[3,20];case 10:return[4,X.shouldIgnoreResponse(a)];case 11:return p.sent()?[2]:[4,_h(a,Gr.current,t)];case 12:return p.sent(),[3,20];case 13:return[4,Object(Rh.b)(a,_t,t)];case 14:return p.sent(),[3,20];case 15:return[4,Uh(a,Co,t)];case 16:return p.sent(),[3,20];case 17:return l=a.body,Xo.onOperationResponse(l.queryId,l.operationResponse),[3,20];case 18:return[4,Nf()];case 19:return p.sent(),[3,20];case 20:return i=o.next(),[3,2];case 21:return[3,24];case 22:return c=p.sent(),u={error:c},[3,24];case 23:try{i&&!i.done&&(d=o.return)&&d.call(o)}finally{if(u)throw u.error}return[7];case 24:return[2]}}))}))}function Ho(e,t){var n;return void 0===t&&(t=Vg.w),Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,l,c,u;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:Object(Dg.c)("clientSpecificAugloopAnnotationHandler op: ",e),Object(Dg.c)("clientSpecificAugloopAnnotationHandler cv: ",t),d.label=1;case 1:d.trys.push([1,7,8,9]),o=Object(r.__values)(e.items),i=o.next(),d.label=2;case 2:return i.done?[3,6]:(a=i.value,(null==(s=null===(n=a.body)||void 0===n?void 0:n.H_)?void 0:s.T_)&&ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.ALAnnotationReceived},{key:_g.g.ChatEventParameters,value:null==s?void 0:s.T_},{key:_g.g.Cv,value:t},{key:_g.g.ALSessionKey,value:mm.a.getInstance().getAlSessionKey()}]),Qg.a.getInstance().isWorkflowRegistered(null==s?void 0:s.T_)?Qg.a.getInstance().isAugloopResponseTimeoutRequired(null==s?void 0:s.T_)?[4,X.shouldIgnoreResponse(a)]:[3,4]:[3,5]);case 3:if(d.sent())return[2];wg.a.getInstance().clearAugloopResponseTimer(),d.label=4;case 4:Dh.a.Instance.Observe(a.body),X.sendResponseToClient(a,t),d.label=5;case 5:return i=o.next(),[3,2];case 6:return[3,9];case 7:return l=d.sent(),c={error:l},[3,9];case 8:try{i&&!i.done&&(u=o.return)&&u.call(o)}finally{if(c)throw c.error}return[7];case 9:return[2]}}))}))}var Uo,Vo=function(e){return void 0===e&&(e=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=(new Date).getTime(),Om=t,n=[],[4,null===(s=null===(a=X.getHostSettings())||void 0===a?void 0:a.getDocumentUrlAsync)||void 0===s?void 0:s.call(a)];case 1:return o=r.sent(),Qg.a.getInstance().getWorkflowDataMap(e).forEach((function(e){Object(Dg.c)("send activate annotation request for workflow: ",e.workflowInfo.workflowAnnotationType),n.push(Ig.a.getInstance().activateAnnotation(e.workflowInfo.workflowAnnotationType,e.workflowInfo.shouldHandleResponse?No:Ho,e.workflowInfo.config,o,e.workflowInfo.forceReturnCachedAnnotations))})),[4,Promise.all(n)];case 2:return r.sent(),ke.sendTelemetryLatencyData([{key:_g.k.AnnotationActivationTime,value:jm(t)}]),Te.sendLoggingEventToClient(Pg.g.AnnotationActivated,{timeInMs:Pm(t)}),Object(Dg.c)("AnnotationActivationTime. Time Taken :  ".concat(jm()," sec")),st(!0),[3,4];case 3:throw i=r.sent(),st(!1),Object(Dg.c)("Failed to activate annotations: ".concat(i.message)),ke.sendTelemetryErrorData([{key:_g.h.ErrorMessage,value:"Failure in Activating Annotation: "+i.message},{key:_g.h.ErrorType,value:_g.e.Server},{key:_g.h.ErrorCode,value:zg.g.ActivateAnnotationError},{key:_g.h.ErrorCategory,value:Ag.a.Augloop}]),i;case 4:return[2]}}))}))},zo=function(){return X.getPythonMode()&&!ft},Go=function(){var e;return Me&&Ke.length>0&&!(null===(e=ue.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Ro()},Wo=function(e){var t,n,r,o,i,a;if(!(!jn.current||ft||null!=$e.current&&(null===(t=$e.current)||void 0===t?void 0:t.getInputText().length)>=(ue.chatInputProps?Vg.G:Vg.D))){Object(Dg.x)(!0);var s=(null===(n=$e.current)||void 0===n?void 0:n.getInputText().length)>0&&mo?Vg.f:Vg.w,l=null!=$e.current?(null===(r=$e.current)||void 0===r?void 0:r.getInputText())+s+e:Vg.w;null===(o=$e.current)||void 0===o||o.setInputText(l),null===(i=$e.current)||void 0===i||i.setGhostText(Vg.w),null===(a=$e.current)||void 0===a||a.setFocus(),Object(Dg.c)("final text passing here: "+e)}},Qo=function(e){var t,n,r;if(!(!jn.current||ft||null!=$e.current&&(null===(t=$e.current)||void 0===t?void 0:t.getInputText().length)>=(ue.chatInputProps?Vg.G:Vg.D))){var o=(null===(n=$e.current)||void 0===n?void 0:n.getInputText().length)>0&&mo?Vg.f:Vg.w;null===(r=$e.current)||void 0===r||r.setGhostText(o+e),Object(Dg.c)("ghost text passing here: "+e),Object(Dg.x)(!0),e.trim()&&Object(tu.e)(Vg.r,Io),Object(Dg.c)("Voice response - Partial Text: "+e)}},qo=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){Xe(zg.c.Expanded),e()}))];case 1:return e.sent(),[2]}}))}))},Ko=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(null==me?void 0:me.voiceInputProps)?(t=(new Date).getTime(),n=Object(nu.a)(me.voiceInputProps.voiceInputLocale),[4,Object(tu.a)(n,Wo,Qo,Sn,Io,e)]):[3,2];case 1:r.sent(),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophoneInitializationTimeInMs},{key:_g.g.ChatEventParameters,value:Pm(t).toString()}]),mo=Object(nu.b)(Object(nu.a)(n)),ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.MicrophoneSuccessfullyInitialized}]),r.label=2;case 2:return[2]}}))}))},Yo=function(e){X.isFeatureGateEnabledFromClient(zg.h.IsClpSensitivityInChatInputEnabled)&&"File"===(null==e?void 0:e.type)&&($n(!0),Et(!0),function(e){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){return t=eh.a.getInstance(),n=new Hh.a({type:e.type,id:e.url}),o=new Fh.b({parentPath:["Signal",Hh.a.getTypeName()],items:[{id:Nh.a.generateId(),body:n}]}),Object(Dg.c)("Submitting signal to Augloop : ".concat(Hh.a.getTypeName()," signal: ").concat(JSON.stringify(n))),t.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.EntityLabelOperationSubmitted},{key:_g.g.ChatEventParameters,value:"".concat(Hh.a.getTypeName(),"_").concat(o)}]),Ig.a.getInstance().submitOperation(o,Hh.a.getTypeName()),[2]}))}))}(e))},Zo=new Ih(Tn,xn,On,null===(_=null==me?void 0:me.voiceInputProps)||void 0===_?void 0:_.microphonePermissionErrorTitle,null===(D=null==me?void 0:me.voiceInputProps)||void 0===D?void 0:D.microphonePermissionErrorMessage,In,Sn,Io,$e,null!==(L=null==me?void 0:me.chatPlaceholderMessage)&&void 0!==L?L:Vg.m,null===(B=null==me?void 0:me.voiceInputProps)||void 0===B?void 0:B.microphonePermissionImagePath,null===(R=null==me?void 0:me.voiceInputProps)||void 0===R?void 0:R.showMicrophonePermissionHelpLink,To),Jo=function(e){var t=e.isWebSearchDefaultOn,n=e.logGroundingSourceEvent,r=m.a.useMemo((function(){return new sm.a}),[]),o=m.a.useMemo((function(){return new lm}),[]),i=m.a.useMemo((function(){return new pm(r,o,{isWebSearchDefaultOn:t,logGroundingSourceEvent:n})}),[r,o]);return{pluginConfigService:r,chatHistoryEnabledPluginsSource:o,pluginDataProvider:i}}({isWebSearchDefaultOn:X.isFeatureGateEnabledFromClient(zg.h.IsWebSearchDefaultOn),logGroundingSourceEvent:!(null===(F=null==ve?void 0:ve.pluginsInfo)||void 0===F?void 0:F.length)}),Xo=Jo.pluginConfigService,$o=Jo.chatHistoryEnabledPluginsSource,ei=Jo.pluginDataProvider,ti=void 0,ni=void 0;if(X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled)){var ri=f.useMemo((function(){return new Mf.a(xe)}),[xe]),oi=f.useMemo((function(){return new _f(xe)}),[xe]),ii=f.useMemo((function(){return new rf(oi.getUserContext(),oi.getHostContext(),ri)}),[oi,ri]),ai=f.useMemo((function(){return new Df.a(Xo)}),[Xo]),si=f.useMemo((function(){return new Lf.a(Xo)}),[Xo]),li=f.useMemo((function(){return new Af(ii,ai,si)}),[ii,ai,si]);ni={cardServices:{appService:ai,channelService:si,tokenService:ri},activityProvider:li};ti=new Ef(ei,li,(function(e,t){t&&(null==he?void 0:he.showSystemMessageOnPluginEnabled)&&"FirstParty"!==e.type&&et.setChatMessageData(a.a.Default,{defaultMessageProps:{user:zg.e.Chat,messageHeader:{text:Object(Vg.vb)(e.name)}}})}),(function(){}),void 0,ai)}var ci=void 0;X.isFeatureGateEnabledFromClient(zg.h.EnableMsgExtCardTelemetry)&&(ci=new ym);var ui=f.useMemo((function(){var e,t,n;return{appService:null===(e=null==ni?void 0:ni.cardServices)||void 0===e?void 0:e.appService,tokenService:null===(t=null==ni?void 0:ni.cardServices)||void 0===t?void 0:t.tokenService,channelService:null===(n=null==ni?void 0:ni.cardServices)||void 0===n?void 0:n.channelService,clientInfo:xe,taskModuleLauncher:Ie,telemetryService:ci}}),[xe]);Uo=f.useMemo((function(){return new g(ui)}),[ui]);var di=(null==ve?void 0:ve.groundingSourcePickerProps)?Object(r.__assign)(Object(r.__assign)({},null==ve?void 0:ve.groundingSourcePickerProps),{onSelection:function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(nh.f)(t.id.toString()),null===(n=null==e?void 0:e.onSelection)||void 0===n||n.call(e,t),gr?[4,Object(Tg.b)(bg.c.AddChatOperation)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}}(null==ve?void 0:ve.groundingSourcePickerProps)}):void 0,pi=(null==ve?void 0:ve.pluginsInfo)&&(null==ve?void 0:ve.pluginsInfo.length)>0||X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled)?{plugins:null==ve?void 0:ve.pluginsInfo,pluginBlockedInfo:or,onGroundingButtonClick:function(){uo=void 0===or&&-1===uo?window.setTimeout((function(){void 0===or&&(Object(Dg.c)("Failed to timely resolve plugins initial state after ".concat(Vg.A,"ms of Grounding button click.")),ir([])),uo=0}),Vg.A):0},copilotPluginFlyoutProps:X.isFeatureGateEnabledFromClient(zg.h.IsCopilotPluginEnabled)?{pluginProvider:ti,isPreview:!0}:void 0}:void 0,gi=ue.chatInputProps?new $g($e,yt,dn,pn,ue.menuProps,ko,Ao,io(),qo,go&&go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w,go?go.ciqPlaceholderText?go.ciqPlaceholderText:Object(Vg.Y)():Vg.w,Qn,bo(),X,null==me?void 0:me.chatPlaceholderMessage,(null==me?void 0:me.voiceInputProps)?Zo.getMicrophoneButtonProps():void 0):new rh($e,Object(Dg.b)(tn),(on||tn).isDarkModeEnabled,null!==(N=(on||tn).dir)&&void 0!==N?N:void 0,yt,St,dn,pn,X,null==ve?void 0:ve.menuProps,ko,Ao,io(),go?go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w:(null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage)?null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage:Vg.w,go?go.ciqPlaceholderText?go.ciqPlaceholderText:Object(Vg.Y)():Vg.w,Qn,bo(),null==ve?void 0:ve.chatPlaceholderMessage,(null==ve?void 0:ve.voiceInputProps)?Object(r.__assign)(Object(r.__assign)({},null==ve?void 0:ve.voiceInputProps),{alSession:ut,microphoneButtonProps:Zo.getMicrophoneButtonProps()}):void 0,null===(H=null==ve?void 0:ve.buttonProps)||void 0===H?void 0:H.ciqButtonEnabled,null===(U=null==ve?void 0:ve.buttonProps)||void 0===U?void 0:U.groundingButtonEnabled,di,pi,To,we?{editorConfig:go,alSession:ut,handleInChatInput:we,postCIQItemSelectionHandler:Yo}:void 0,Jn,null==ve?void 0:ve.isVersion3Enabled,null==ve?void 0:ve.characterLimitErrorMessage,null==ve?void 0:ve.imageInputEnabled,be,ye,Ce,Se,Oe);J===o.a.IOS&&(fo=new oh($e,yt,dn,pn,ue.menuProps,ko,Ao,Fn,qo,go&&go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w,X,null!==(z=null!==(V=null==me?void 0:me.chatRestShyPlaceholderMessage)&&void 0!==V?V:null==ve?void 0:ve.chatRestShyPlaceholderMessage)&&void 0!==z?z:Vg.n));var hi=function(){var e;J===o.a.IOS&&(null===(e=$e.current)||void 0===e?void 0:e.getInputText())===Vg.w&&Xe(zg.c.Shy)};function fi(){if(J!==o.a.IOS)if(Pe)1==window.devicePixelRatio&&Ae(!1);else{var e=document.getElementById(Vg.o);if(e)e.getBoundingClientRect().height<=0&&Ae(!0)}}Object(f.useEffect)((function(){var e;null===(e=yo())||void 0===e||e.setLoading(Jn)}),[Jn]),Object(f.useEffect)((function(){if(J!==o.a.IOS)return fi(),window.addEventListener("resize",fi),function(){window.removeEventListener("resize",fi)}})),Object(f.useEffect)((function(){if(we||!Fn||!Vn||Wn||zr.current||(Fn.uninitialize(Zc.a),zn(void 0)),io()&&(jo.current=new vh(mt,Ut,ko,et,$e,io,jt,go?go.ciqPlaceholderText?go.ciqPlaceholderText:Object(Vg.Y)():null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage,yt)),!we&&go&&Wn&&!Vn&&Fn&&$e.current&&!zr.current){var e=Fn.initializeCiq($e.current.getInputSpanElement(),{menuTitle:go.transformFileMenuTitle,menuSubtitle:go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w,queryCharToUse:Zc.a,onItemSelected:function(t){var n,r,o,i,a,s,l,c;if(ke.sendTelemetryChatEventData([{key:_g.g.ChatEventType,value:_g.f.CIQSuggestionSelected},{key:_g.g.ChatEventParameters,value:null!==(o=null===(r=null===(n=t.suggestion)||void 0===n?void 0:n.queryAnnotation)||void 0===r?void 0:r.QueryAnnotationType)&&void 0!==o?o:Vg.w}]),Or.current)return null===(i=Sr.current)||void 0===i||i.addUserContentMessageItem(Object(Dg.k)(t.suggestion),!0),Or.current=!1,void(null===(a=$e.current)||void 0===a||a.setGhostText(null!==(s=null==me?void 0:me.chatPlaceholderMessage)&&void 0!==s?s:Vg.m));null===(l=$e.current)||void 0===l||l.setGhostText(Vg.w),null===(c=$e.current)||void 0===c||c.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,Jn,Object(Dg.b)(tn),(on||tn).isDarkModeEnabled,Pn),Yo(t.suggestion)},entitiesEnabled:go.entitiesSupported,ExpanededECC:go.isExpandedECCEnabled});e.setHVCAppChatV2Enabled(be),zn(e)}zr.current=!1}),[Fn,Vn,Wn]);var mi=function(){var e,t;return null!==(t=null===(e=Lh.a.getInstance())||void 0===e?void 0:e.getLogs())&&void 0!==t?t:""},vi=new hh($e,ko,Ao,yt,io(),go?go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w:(null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage)?null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage:Vg.w,qo,be,Ce),bi=new Rf($e,ko,yt,io(),go?go.transformFilePlaceholderText?go.transformFilePlaceholderText:Vg.w:(null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage)?null==ve?void 0:ve.transfromFileNonCIQPlaceholderMessage:Vg.w,qo,be,Ce),yi=function(){return X.isFeatureGateEnabledFromClient(zg.h.ChatInputEarlyLoadEnabled)&&(It||!at)},Ci=function(){return yi()&&hn||wo()&&!ft?{chatInputBannerString:wo()?Object(Vg.ib)():Object(Vg.ub)()}:void 0},Oi=function(){return!ft&&ue.showSuggestionButtonProps};return X.isFeatureGateEnabledFromClient(zg.h.ChatInputEarlyLoadEnabled)||!It&&at?he&&he.showCopilotSwitcherMenu&&Le&&De&&_e&&De!==_e?f.createElement(Gh,{theme:se?on:tn,shouldUseFluentV9Tokens:Ge,dir:se?on.dir:tn.dir},f.createElement(S,{style:Pe?We.chatUiStackZoom:We.chatUiStack},f.createElement($,{isMenuOpen:Ue,onMenuStateChange:ze,handleCopilotChatChange:he.handleCopilotChatChange,copilotList:he.copilotList,showNewChatButtonOnTop:Go(),isExecuting:ft,handleChangeTopicButtonClick:Do}),f.createElement(ee,{componentToRender:Re}))):Ro()&&Lr?f.createElement(Gh,{theme:se?on:tn,shouldUseFluentV9Tokens:Ge,dir:se?on.dir:tn.dir},f.createElement(S,{style:Pe?We.chatUiStackZoom:We.chatUiStack},f.createElement(im,{setChatLog:Ye,currentChatId:Tg.c,setIsExecuting:mt,setLoadingComponentProps:Ut,suggestionPillsBuilderRef:Gr,createAndSubmitChatHistorySignal:Tg.b,resetToNewConversation:Tg.h,setChatHistoryMenuData:_r,handleChatHistoryPanelClose:Bo,isSwitchingConversation:Vr,isChatHistoryMenuLoading:kr,chatHistoryMenuData:Ar,isChatHistoryPanelFetchingMoreChats:Rr,setIsChatHistoryPanelFetchingMoreChats:Fr,isEndOfChatHistory:Hr}))):f.createElement(Gh,{theme:se?on:tn,shouldUseFluentV9Tokens:Ge,dir:se?on.dir:tn.dir},f.createElement(S,{style:Pe?We.chatUiStackZoom:We.chatUiStack},he&&he.showCopilotSwitcherMenu&&Le&&f.createElement($,{isMenuOpen:Ue,onMenuStateChange:ze,handleCopilotChatChange:he.handleCopilotChatChange,copilotList:he.copilotList,showNewChatButtonOnTop:Go(),isExecuting:ft,handleChangeTopicButtonClick:Do}),yi()&&f.createElement(Kh,{className:Pe?We.chatFreStackZoom:We.chatFreStack}),Zr&&ue.toggleUiProps&&f.createElement(oe,Object(r.__assign)({},Jr.getTryReviewerAgentProps(ue.toggleUiProps,!1,"Reviewer"))),Yr&&f.createElement(oe,Object(r.__assign)({},Jr.getTryWebChatProps(Lt,(function(e,t){var n=null==t?void 0:t.checked;Object(Dg.c)("Toggling Try Web chat to "+(n?"on":"off")),Mt(null!=n&&n)}),"Try Web Chat"))),Lt&&f.createElement("iframe",{src:null!==(W=null===(G=null==ue?void 0:ue.toggleUiProps)||void 0===G?void 0:G.webSearchUrl)&&void 0!==W?W:Vg.d,title:Vg.e,height:"100%",allow:"clipboard-write;microphone;camera"}),!Lt&&f.createElement(f.Fragment,null,!It&&at&&f.createElement(f.Fragment,null,qr&&ue.toggleUiProps&&f.createElement(oe,Object(r.__assign)({},Jr.getTrySydneyProps(ue.toggleUiProps,_n,"Try Sydney"))),Kr&&ue.toggleUiProps&&f.createElement(oe,Object(r.__assign)({},Jr.getTryEnterpriseSearchProps(ue.toggleUiProps,!1,"Enterprise Search Mode"))),jg.a.isDevbuild()&&(null==ge?void 0:ge.isDebugToggleEnabled)&&!ho()&&f.createElement(Ne,Object(r.__assign)({},Xr.getDebugSectionProps(mi,null!==(Q=null==ge?void 0:ge.conversationId)&&void 0!==Q?Q:"",null==ge?void 0:ge.telemetryData))),jg.a.isDevbuild()&&ho()&&f.createElement(bt,Object(r.__assign)({},$r.getDebugSectionProps(mi,null!==(q=null==ge?void 0:ge.conversationId)&&void 0!==q?q:"",null==ge?void 0:ge.telemetryData,null==ge?void 0:ge.sessionId,null==ge?void 0:ge.conversationLogObject,null==ge?void 0:ge.debugMessageInfoObject,null==ge?void 0:ge.showDebugInfoMessage,null==ge?void 0:ge.setShowDebugInfoOnMessage,mr,yr,null==ge?void 0:ge.sydneyConversationObject,null==ge?void 0:ge.augloopKustoQueryURL,null==ge?void 0:ge.clientKustoQueryURL,X.getHostSettings().appName,J,null==ge?void 0:ge.sdxVersion))),f.createElement(Yc.a,{id:Vg.o,className:Pe?We.chatFreStackZoom:We.chatFreStack,ref:rt},ao&&f.createElement(en,Object(r.__assign)({ref:Sr},sr)),X.isFeatureGateEnabledFromClient(zg.h.EnableRestrictiveSearchBanner)&&Rt&&f.createElement(un,Object(r.__assign)({},ro.getProps((function(){Ft(!1)})))),dn?f.createElement(Cn,Object(r.__assign)({},Qr.getProps((function(){pn(!1)}),ue.freUiProps))):(null==lo?void 0:lo.promptSuggestionList.length)>0&&(ue.zeroQueryMessageProps?f.createElement(Dn,Object(r.__assign)({},vi.getProps(ue.zeroQueryMessageProps))):f.createElement(Nn,Object(r.__assign)({},bi.getProps(ue.zeroQueryMessageV2Props)))),Ro()&&f.createElement(Xn,{onClick:function(){Object(Tg.f)(),Object(Tg.b)(bg.c.GetAllChatsOperation),jr(!0),_r([]),Mr(!0),Ur(!1),Fr(!1)}}),f.createElement("div",{id:Vg.B,ref:nt}),Ke.length>0&&f.createElement(Ps,Object(r.__assign)({},et.getProps(Ke,ue.chatContainerUiProps),{designerProps:de,customMessageRenderers:ue.customMessageRenderers,pluginServiceProvider:ni,msgExtCardContextProvider:Uo})),Oi()&&f.createElement(Ls,Object(r.__assign)({},oo.getProps(ue.showSuggestionButtonProps))),function(){var e;return!ft&&Ke.length>0&&!(null===(e=ue.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Ro()}()&&!zo()&&!Oi()&&!Me&&f.createElement(Fs,Object(r.__assign)({},to.getProps(Do))),zo()&&f.createElement(Vs,Object(r.__assign)({},no.getProps((function(){mt(!1),X.sendEventToClient(Pg.c.PythonExitAnalysisButtonClicked),X.updateCopilotState(Pg.d.IDLE),Object(Dg.c)("Python Exit Analysis Button Clicked.")})))),ft&&(null===(K=Ht.shouldShowLoadingUi)||void 0===K||K)&&f.createElement(Gt,Object(r.__assign)({},Wr.getProps(Ht,(function(){uh.a.getInstance().getIsBasicChatStreaming()&&(uh.a.getInstance().updateCardWithFooter(),ke.logErrorWithAshaVetoAndError([],uh.a.getInstance().getFeatureName(),Vg.w,_g.c.BasicChatUserCancelledResponse,_g.a.UserAbortedQueryExecution),uh.a.getInstance().resetBasicChatStreamingStates(!0,!1)),Dh.a.Instance.ErrorMessage="Stop_Generation_Clicked",mt(!1),X.sendEventToClient(Pg.c.StopGeneratingButtonClicked),wg.a.getInstance().clearAugloopResponseTimer(),Ig.a.getInstance().clearOperationListForResubmit(),X.updateCopilotState(Pg.d.IDLE),Object(Dg.c)("Stop Generation Button Clicked.")})))),f.createElement("div",{ref:tt})),function(){var e,t;return!yt&&((null===(t=null===(e=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===e?void 0:e.suggestionList)||void 0===t?void 0:t.length)>0||Kn.length>0)&&(Object(Dg.c)("Suggestion Pills are shown"),!0)}()&&f.createElement(Js,Object(r.__assign)({},Gr.current.getProps(ue.suggestionPillsUiProps,Kn))),Kt&&f.createElement(ll,Object(r.__assign)({},zt)),J===o.a.IOS&&Je===zg.c.Shy&&!ft&&fo&&f.createElement(Bl,Object(r.__assign)({},fo.getProps((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,qo()];case 1:return t.sent(),null===(e=$e.current)||void 0===e||e.setFocus(),[2]}}))}))})))),Jt&&f.createElement(Hl,Object(r.__assign)({},Qt))),ue.chatInputProps?(J!=o.a.IOS||Je===zg.c.Expanded&&!ft)&&f.createElement(Kc,Object(r.__assign)({ref:$e},gi.getProps(hi,Ci()))):f.createElement(vg,Object(r.__assign)({ref:$e},gi.getProps(At,Ci())))))):f.createElement(b,{theme:tn},f.createElement("div",null,f.createElement(Eg.a,{appearance:"primary",className:We.spinner})))}));Tm.displayName=Vg.p;var km=function(){Cm=null,null,Om=null,Sm=null,Em=!1},jm=function(e){return((new Date).getTime()-(null!=e?e:Om))/1e3},Pm=function(e){return(new Date).getTime()-(null!=e?e:Om)},Am=function(e){Em=e}},1061:function(e,t,n){"use strict";n.r(t),n.d(t,"ChannelService",(function(){return d})),n.d(t,"MosAppService",(function(){return v})),n.d(t,"AppService",(function(){return b.a})),n.d(t,"CardService",(function(){return y.a})),n.d(t,"HttpStatusCode",(function(){return u.a})),n.d(t,"isStageViewActionSubmit",(function(){return C.a})),n.d(t,"isTaskModuleActionSubmit",(function(){return C.b})),n.d(t,"isBrokeredArchitecture",(function(){return O.a}));var r,o=n(2),i=n(2118),a=n(406),s=n(246),l=n(1811),c=n(2851),u=n(794);class d{constructor(e,t,n,r,o,i){this.tokenService=e,this.hostContext=t,this.telemetryService=o,this.sourceName=i,this.endpointUrl="https://substrate.office.com/search/api/v1/",this.tokenScope="https://substrate.office.com/search",n&&(this.endpointUrl=n),r&&(this.tokenScope=r)}botInvoke(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeRequest),r={};if(!(null===(t=this.hostContext)||void 0===t?void 0:t.locale))throw n.logMetricEndWithError({message:s.d.HostLocaleIsUndefined,diagnosticsData:`RequestName: ${e.requestBody.name}`}),new Error("host locale is undefined");const o=this.processRequest(e),a=`${this.endpointUrl}botinvoke?culture=${this.hostContext.locale}`,u=yield this.getInvokeRequestHeaders(),d=yield Object(i.a)(a,{method:"POST",headers:u,body:JSON.stringify(o)});if(!d.ok)throw n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),d;const p=yield d.json();return r[s.l.HttpStatusCode]=p.statusCode,p.error?(n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Error,value:{errorCode:p.error.httpCode,errorMessage:p.error.message}}):(n.logMetricEnd({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Result,value:p.response})}))}getInvokeRequestHeaders(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const e=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeFetchToken),t=new Headers;t.set("Content-Type","application/json");try{const n=yield this.tokenService.getToken({resource:this.tokenScope});n&&(null==n?void 0:n.authToken)&&t.set("Authorization",`Bearer ${n.authToken}`),e.logMetricEnd()}catch(t){e.logMetricEndWithError({diagnosticsData:`Error: ${null==t?void 0:t.message}`})}return t}))}processRequest(e){var t,n,r,o,i;const s={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(a.generateGuid)(),scenario:{name:this.getScenarioName()}};return e.requestBody.appName&&(s.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(s.request.imdisplayname=e.requestBody.imdisplayname),s}getScenarioName(){return"teamshub"===this.sourceName?u.b.TeamsHubCopilot3sInvoke:"officeweb"===this.sourceName?u.b.OfficeWebCopilot3sInvoke:"owahub"===this.sourceName?u.b.OutlookWebCopilot3sInvoke:"bing"===this.sourceName?u.b.CibCopilot3sInvoke:u.b.M365CardSDK}}class p{static getAndCacheAcquisitions(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o={},a=i&&new c.a(i,s.h.GetAndCacheAcquisition,s.g.GetAndCacheAcquisitionforMOS);try{const i=yield n.getToken({resource:t});let s=new URL("/catalog/v1/users/acquisitions/get",t);const l={method:"POST",headers:{Authorization:`Bearer ${i.authToken}`,Accept:"application/json","Accept-Language":r},body:JSON.stringify({Filter:{supportedElementTypes:["ComposeExtensions","Plugins"]}})};let c=yield fetch(s.toString(),l);if(c.ok&&200===c.status){const e=(yield c.json()).acquisitions;if(e)return this.createTime=Date.now(),this.cachedAcquisitions=e,e}if(s=new URL("/catalog/v1/users/titles/launchInfo",t),l.body=JSON.stringify({Id:e,Filter:{supportedElementTypes:["ComposeExtensions","Plugins"]}}),c=yield fetch(s.toString(),l),c.ok&&200===c.status){const e=(yield c.json()).acquisition;if(e)return this.cachedAcquisitions?this.cachedAcquisitions.push(e):(this.cachedAcquisitions=[e],this.createTime=Date.now()),this.cachedAcquisitions}return o.HttpStatusCode=c.status,null==a||a.logMetricEnd({props:o}),Promise.reject(`Error while fetching acquisitions: ${c.status}`)}catch(e){return null==a||a.logMetricEndWithError({props:o,diagnosticsData:`Error: fetching acquisitions failed, ${null==e?void 0:e.message}`}),Promise.reject(`fetching acquisitions failed, ${null==e?void 0:e.message}`)}}))}static findAcquisitionWithId(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n={},r=t&&new c.a(t,s.h.FindAcquisition,s.g.FindAcquisitionforMOS);if(this.cachedAcquisitions){const t=this.cachedAcquisitions.find((t=>t.appId===e));return null==r||r.logMetricEnd({props:n}),Promise.resolve(t)}return null==r||r.logMetricEndWithError({props:n,diagnosticsData:"Error: could not find app with id in acquisitions"}),Promise.reject(`couldn't find app with id, ${e}`)}))}}var g;r=p,p.cacheTimeInMs=36e5,p.cachedAcquisitions=void 0,p.createTime=0,p.getAcquisition=(e,t,n,i,a)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){return Date.now()-r.createTime>r.cacheTimeInMs&&(r.cachedAcquisitions=void 0),r.cachedAcquisitions&&0!=r.cachedAcquisitions.filter((t=>t.appId===e)).length||(yield r.getAndCacheAcquisitions(e,t,n,i,a)),yield r.findAcquisitionWithId(e,a)}));const h="https://titles.prod.mos.microsoft.com/config/v1/environment",f=36e5;class m{static getAndCacheUrlFromDiscoveryApi(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.getToken({resource:h});if(n&&n.authToken){const e=new URL(h),r={method:"GET",headers:{Authorization:`Bearer ${n.authToken}`,Accept:"application/json","Accept-Language":t}},o=yield fetch(e.toString(),r);if(o.ok&&200===o.status){const e=yield o.json();return this.cachedServiceUrl=e.titlesServiceUrl,this.cacheTimeInMs=e.cacheTimeInHrs?e.cacheTimeInHrs*f:f,this.createTime=Date.now(),e.titlesServiceUrl}return Promise.reject(`Error while fetching discovery environment info: ${o.status}`)}}catch(e){return Promise.reject(`discovery environment info failed, ${null==e?void 0:e.message}`)}}))}}g=m,m.cacheTimeInMs=0,m.cachedServiceUrl=void 0,m.createTime=0,m.getServiceUrl=(e,t)=>Date.now()-g.createTime<g.cacheTimeInMs&&g.cachedServiceUrl?Promise.resolve(g.cachedServiceUrl):g.getAndCacheUrlFromDiscoveryApi(e,t);class v{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.appPromiseCache={},this.locale=null!=t?t:"en-us"}getApp(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return{titleInfo:yield this.getAppFromMOS3(e.id)}}))}getAppFromMOS3(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.appPromiseCache[e])return this.appPromiseCache[e];const t=new c.a(this.telemetryService,s.h.GetApp,s.g.GetAppFromMOS3),n=(()=>Object(o.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield m.getServiceUrl(this.tokenService,this.locale),r=null!=n?n:"https://titles.prod.mos.microsoft.com",o=yield p.getAcquisition(e,r,this.tokenService,this.locale,this.telemetryService);return t.logMetricEnd({}),o}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error: getAppDefinition failed, ${null==e?void 0:e.message}`}),Promise.reject(`getAppDefinition failed, ${null==e?void 0:e.message}`)}})))();return this.appPromiseCache[e]=n,n.finally((()=>{delete this.appPromiseCache[e]})),n}))}}var b=n(2119),y=n(2173),C=n(1115),O=n(2120)},1062:function(e,t,n){"use strict";n.r(t),n.d(t,"OperationId",(function(){return o.a})),n.d(t,"TextToImage",(function(){return l})),n.d(t,"EnsureAugloopRuntimeManager",(function(){return r.a})),n.d(t,"StartInitializingRuntimeManage",(function(){return r.b})),n.d(t,"getAlSessionKey",(function(){return r.c})),n.d(t,"guid",(function(){return r.d}));var r=n(1448),o=n(2123),i=n(2),a=n(453),s=n(1154),l=function(){function e(){}return e.addImage=function(t){e.images.push(t)},e.getImages=function(){return e.images},e.findImageUrlFromDescription=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return[2,n.sent()]}}))}))},e.insertImage=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return(n=r.sent())?[3,2]:(Object(a.a)("insertImageFromAl: Could not find image matching description"),[2,void 0]);case 2:return r.trys.push([2,4,,5]),[4,Object(s.b)(n)];case 3:return[2,r.sent()];case 4:return r.sent(),Object(a.a)("failed to fetch image from url and encode it as base64"),[2,void 0];case 5:return[2]}}))}))},e.images=[],e}()},1063:function(e,t,n){"use strict";n.r(t),n.d(t,"OperationId",(function(){return o.a})),n.d(t,"TextToImage",(function(){return l})),n.d(t,"EnsureAugloopRuntimeManager",(function(){return r.a})),n.d(t,"StartInitializingRuntimeManage",(function(){return r.b})),n.d(t,"getAlSessionKey",(function(){return r.c})),n.d(t,"guid",(function(){return r.d}));var r=n(1449),o=n(2060),i=n(2),a=n(451),s=n(1148),l=function(){function e(){}return e.addImage=function(t){e.images.push(t)},e.getImages=function(){return e.images},e.findImageUrlFromDescription=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return[2,n.sent()]}}))}))},e.insertImage=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return(n=r.sent())?[3,2]:(Object(a.a)("insertImageFromAl: Could not find image matching description"),[2,void 0]);case 2:return r.trys.push([2,4,,5]),[4,Object(s.b)(n)];case 3:return[2,r.sent()];case 4:return r.sent(),Object(a.a)("failed to fetch image from url and encode it as base64"),[2,void 0];case 5:return[2]}}))}))},e.images=[],e}()},1064:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(181),o=n(32),i=n(1005),a=n(1110),s=n(771),l=n(1113);function c(){r.f.defaultActions.register(s.a.JsonTypeName,(function(e){return new s.a})),r.f.defaultActions.register(a.a.JsonTypeName,(function(e){return new a.a})),r.f.defaultActions.register(i.a.JsonTypeName,(function(e){return new i.a}),o.s.v1_4),r.f.defaultActions.register(l.a.JsonTypeName,(function(e){return new l.a}),o.s.v1_2)}},1065:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(1),i=n(161),a=n(28),s=n(32),l=n(175),c=n(188),u=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n._computedWeight=0,n.width=t,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.getValue(t.widthProperty)},set:function(e){this.setValue(t.widthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.adjustSize=function(e){this.isDesignMode()?(e.minWidth="20px",e.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.minWidth="0",this.minPixelHeight&&(e.minHeight="".concat(this.minPixelHeight,"px"))),"auto"===this.width?e.flex="0 1 auto":"stretch"===this.width?e.flex="1 1 50px":this.width instanceof i.c&&(this.width.unit===a.s.Pixel?(e.flex="0 0 auto",e.width="".concat(this.width.physicalSize,"px")):e.flex="1 1 ".concat(this._computedWeight>0?this._computedWeight:this.width.physicalSize,"%"))},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.p.Vertical},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof d)&&(!this.parent.isFirstElement(this)&&this.shouldRender())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new s.c(s.s.v1_0,"width",(function(e,t,n,r){var o=t.defaultValue,s=n[t.name],c=!1;if("number"!=typeof s||isNaN(s))if("auto"===s||"stretch"===s)o=s;else if("string"==typeof s)try{(o=i.c.parse(s)).unit===a.s.Pixel&&t.targetVersion.compareTo(r.targetVersion)>0&&(c=!0)}catch(e){c=!0}else c=!0;else o=new i.c(s,a.s.Weight);return c&&(r.logParseEvent(e,a.A.InvalidPropertyValue,l.a.errors.invalidColumnWidth(s)),o="auto"),o}),(function(e,t,n,r,o){r instanceof i.c?r.unit===a.s.Pixel?o.serializeValue(n,"width","".concat(r.physicalSize,"px")):o.serializeNumber(n,"width",r.physicalSize):o.serializeValue(n,"width",r)}),"stretch"),t}(c.b),d=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._columns=[],t}return Object(r.__extends)(t,e),t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return e&&"Column"!==e?void 0:new u}),(function(e,n){t.logParseEvent(void 0,a.A.ElementTypeNotAllowed,l.a.errors.elementTypeNotAllowed(e))}))},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(c.e.layoutsProperty)},t.prototype.getRawItems=function(){return this._columns},t.prototype.renderItems=function(){var e,t,n,s,l=this._columns.filter((function(e){return e.shouldRender()})),c=0;try{for(var u=Object(r.__values)(l),d=u.next();!d.done;d=u.next()){(f=d.value).width instanceof i.c&&f.width.unit===a.s.Weight&&(c+=f.width.physicalSize)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}var p=[];this._renderedColumns=[];try{for(var g=Object(r.__values)(l),h=g.next();!h.done;h=g.next()){var f;if((f=h.value).width instanceof i.c&&f.width.unit===a.s.Weight&&c>0){var m=100/c*f.width.physicalSize;f._computedWeight=m}var v=o.createElement(f.Render,{key:f.key});v&&(p.push(v),this._renderedColumns.push(f))}}catch(e){n={error:e}}finally{try{h&&!h.done&&(s=g.return)&&s.call(g)}finally{if(n)throw n.error}}return p},t.prototype.applyLayout=function(e){switch(e.style.display="flex",e.style.flexDirection="row",this.getEffectiveHorizontalAlignment()){case a.i.Center:e.style.justifyContent="center";break;case a.i.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}},t.prototype.internalParse=function(t,n){var o,i;e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var a=t[this.getItemsCollectionPropertyName()];if(Array.isArray(a))try{for(var s=Object(r.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=this.createColumnInstance(c,n);u&&this._columns.push(u)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getItemsCollectionPropertyName(),this._columns)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getItemsCollectionPropertyName(),valueType:new s.d(new u),isArray:!0}],!1)},t.prototype.getItemsCollectionPropertyName=function(){return"columns"},t.prototype.isFirstElement=function(e){var t,n;try{for(var o=Object(r.__values)(this._columns),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.shouldRender())return a===e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},t.prototype.isBleedingAtTop=function(){var e,t;if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)try{for(var n=Object(r.__values)(this._columns),o=n.next();!o.done;o=n.next()){if(o.value.isBleedingAtTop())return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.isBleedingAtBottom=function(){var e,t;if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)try{for(var n=Object(r.__values)(this._columns),o=n.next();!o.done;o=n.next()){if(o.value.isBleedingAtBottom())return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){var n,o;e.prototype.internalValidateProperties.call(this,t);var i=0,s=0;try{for(var c=Object(r.__values)(this._columns),u=c.next();!u.done;u=c.next()){var d=u.value;"number"==typeof d.width?i++:"stretch"===d.width&&s++}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}i>0&&s>0&&t.addFailure(this,a.A.Hint,l.a.hints.dontUseWeightedAndStretchedColumnsInSameSet())},t.prototype.addColumn=function(e){this.internalInsertItemAt(e,this._columns.length,!0)},t.prototype.removeItem=function(e){if(e instanceof u){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof u?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0===this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)===this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){var t,n,o;try{for(var i=Object(r.__values)(this._columns),a=i.next();!a.done;a=i.next()){if(o=a.value.getActionById(e))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(c.c)},1066:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(1),i=n(32),a=n(28),s=n(181),l=n(161),c=n(655),u=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.value=n,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new i.n(i.s.v1_0,"title"),t.valueProperty=new i.n(i.s.v1_0,"value"),t}(i.j),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"facts",{get:function(){return this.getValue(t.factsProperty)},set:function(e){this.setValue(t.factsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t=this,n=this.hostConfig,r=function(e){var n=new c.b;return n.setParent(t),n.text=e.value,n.size=e.style.size,n.color=e.style.color,n.isSubtle=e.style.isSubtle,n.weight=e.style.weight,n.wrap=e.style.wrap,n.spacing=a.t.None,o.createElement(n.Render,null)};if(this.facts.length>0){var i=Object(l.g)(this.hostWidth,n.factSet.layoutSwitchBreakpoint)<0,s=void 0!==n.factSet.title.maxWidth?n.factSet.title.maxWidth:150,u=n.makeCssClassName("ac-fact-title"),d=n.makeCssClassName("ac-fact-value");return o.createElement("div",{style:{display:"grid",gridTemplateColumns:i?"auto":"minmax(min-content, max-content) auto",gap:"".concat(i?n.factSet.stackLayout.rowGap:n.factSet.tableLayout.rowGap,"px ").concat(n.factSet.tableLayout.columnGap,"px")}},this.facts.map((function(e){var t=o.createElement(r,{value:e.name,style:n.factSet.title}),a=o.createElement(r,{value:e.value,style:n.factSet.value});return i?o.createElement("div",{key:e.key,style:{display:"grid",gridAutoColumns:"auto",gap:"".concat(n.factSet.stackLayout.titleValueGap,"px")}},o.createElement("div",{className:u},t),o.createElement("div",{className:d},a)):o.createElement(o.Fragment,null,o.createElement("div",{key:e.key+"_title",className:u,style:{maxWidth:"".concat(s,"px")}},t),o.createElement("div",{key:e.key+"_value",className:d,style:{gridColumn:2}},a))})))}return null},t.prototype.isResponsive=function(){return!0},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new i.k(i.s.v1_0,"facts",(function(e){return new u})),t}(s.d)},1071:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),o=n(773),i=n(161),a=n(147),s=n(28),l=n(175),c=n(32),u=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.allowVerticalOverflow=!1,t}return Object(r.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"_selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.getSpacings=function(t){e.prototype.getSpacings.call(this,t);var n=new i.d;this.getEffectivePadding()&&(n=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),t.padding={top:n.top,right:n.right,bottom:n.bottom,left:n.left}},t.prototype.applySelectAction=function(e){var t=this,n=this.hostConfig;this.allowVerticalOverflow&&(e.style.overflowX="hidden",e.style.overflowY="auto"),this.isSelectable&&this._selectAction&&n.supportsInteractivity&&(e.style.cursor="pointer",e.onClick=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t._selectAction.execute())},e.onKeyPress=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.stopPropagation(),t._selectAction.execute())},this._selectAction.setupElementForAccessibility(e),this._selectAction.isEffectivelyEnabled()&&Object(a.a)(e,n.makeCssClassName("ac-selectable")))},t.prototype.customizeProps=function(e){},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.forbiddenChildElements=function(){return[]},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this);for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).releaseDOMResources()},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var r=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&r.isInteractive&&t.addFailure(this,s.A.InteractivityNotAllowed,l.a.errors.interactivityNotAllowed()),this.isElementAllowed(r)||t.addFailure(this,s.A.InteractivityNotAllowed,l.a.errors.elementTypeNotAllowed(r.getJsonTypeName())),r.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++){var o=this.getItemAt(n);o.shouldRenderForTargetWidth()&&t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(o.getAllInputs(e)),!1))}return t},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getItemCount();n++){var o=this.getItemAt(n);o.shouldRenderForTargetWidth()&&t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(o.getAllActions()),!1))}return this._selectAction&&t.push(this._selectAction),t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(this.getItemAt(t).getResourceInformation()),!1));return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var r=0;r<this.getItemCount();r++){var o=this.getItemAt(r);if(o.shouldRenderForTargetWidth()&&(n=o.getElementById(t)),n)break}return n},t.prototype.isResponsive=function(){if(e.prototype.isResponsive.call(this))return!0;for(var t=0;t<this.getItemCount();t++){if(this.getItemAt(t).isResponsive())return!0}return!1},t.selectActionProperty=new o.a(c.s.v1_1,"selectAction",["Action.ShowCard"]),t}(n(181).d)},1078:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(r||(r={}))},1084:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(206),o=function(e){return void 0===e&&(e=r.d.Production),e===r.d.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):new URL("https://designerapp.officeapps.live.com")},i=function(){return new URL("https://designer.microsoft.com")},a=function(e,t){return void 0===e&&(e=r.d.Production),void 0===t&&(t=!0),e===r.d.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))},s="https://designerappservice.officeapps.live.com"},1087:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),o=n(2061),i=n(1159),a=n(1784),s=n(893),l=n(2062),c=n(396),u=n(1484),d=n(699),p=n(1594);o.a.dictationSettings={dictationLanguage:"en-US",useAutoPunctuation:"Intelligent",useCorrections:"true",properties:{"SpeechContext-PhraseOutput.interimResults.resultType":"Hypothesis",setFeature:"emailplm,offtrt,copilot",Profanity:"masked","SpeechConfig-Context.DataCollection.Mode":"0"}};class g{constructor(e,t,n){this.speechToTextClient=null,this.voiceSession=null,this.isVoiceSessionActive=!1,this.closeConnectionPromise=null,this.locale=null,this.attempt=0,this.fdSpeechClientObserver={onSpeechSessionStarted:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{null!=e&&console.log("Transcription speech session ID: ",e.speechSessionId)}catch(e){this.onError(e)}})),onSpeechSessionStopped:()=>{this.speechEventEmitter.emit("SpeechSessionStopped")},onFinalText:e=>this.OnFinalResult(e),onFragmentText:e=>this.OnPartialResult(e),onSpeechRecognitionStarted:()=>{},onError:e=>{if(-1==(null==e?void 0:e.toString().indexOf(d.a))||this.attempt>=3)try{if(e===i.a.ErrorAudioCaptureAsync||e===i.a.ErrorAudioDevicesNotFoundError||e===i.a.ErrorAudioNotReadableError||e===i.a.ErrorAudioPermissionDeniedError)return;const t=new Error("IAugloopSpeechObserverDecorator.onError: ");this.onError(t)}catch(e){this.onError(e)}},onSpeechEnd:()=>{},onEventUpdate:e=>{},showDictationWarning:()=>{},onWarning:e=>{},showPermissionPrompt:()=>{}},this.locale=n,this.onError=e=>{throw e},this.onAudioBuffer=e=>{},this.initPromise=this.PerformInitializeConnection(),this.speechEventEmitter=new c.EventEmitter,this.onTranscriptText=e,this.onTranscriptPartialText=t,o.a.dictationSettings.dictationLanguage=this.locale}PerformInitializeConnection(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.InitializeSpeechToTextClient(),this.voiceSession=new a.a(void 0,this.fdSpeechClientObserver,!0,void 0,void 0,l.a.Dictation,null===(e=u.a.getInstance())||void 0===e?void 0:e.getALSession())}))}SetAudioBufferCallback(e){this.onAudioBuffer=e}SetErrorCallback(e){this.onError=e}InitializeConnection(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.attempt=0,this.locale=e,this.initPromise}))}StartMicrophone(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.ResumeConnection()}))}ResumeConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.isVoiceSessionActive)return Promise.resolve();if(yield this.initPromise,this.isVoiceSessionActive=!0,null==this.locale)throw new Error("Reached resume connection without a locale. Did we really initilize AugloopRealTimeTranscriptionConnection?");o.a.dictationSettings.dictationLanguage=this.locale,yield this.voiceSession.startVoiceSessionFromMicrophoneInput((e=>this.OnAudioBufferCallback(e)),null,null)}))}PauseConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.isVoiceSessionActive)return Promise.resolve();yield this.initPromise,this.isVoiceSessionActive=!1,yield this.voiceSession.stopMicrophoneInputAsync(),yield this.voiceSession.stopVoiceSession()}))}CloseConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!=this.closeConnectionPromise||(this.closeConnectionPromise=new Promise(((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{this.voiceSession&&(this.voiceSession.endVoiceSession(),this.voiceSession.endVoiceSession(),yield this.WaitForSessionEnd()),this.speechToTextClient&&(yield this.speechToTextClient.uninitializeAsync()),this.closeConnectionPromise=null,e()}catch(e){t(e)}}))))),this.closeConnectionPromise}))}WaitForSessionEnd(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Promise(((e,t)=>{setTimeout((()=>{try{this.voiceSession&&this.voiceSession.endVoiceSession(),e()}catch(e){t(e)}}),d.b)})),t=new Promise(((e,t)=>{try{this.speechEventEmitter.once("SpeechSessionStopped",e)}catch(e){t(e)}}));yield Promise.race([e,t])}))}OnFinalResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("transcript text "+n),this.onTranscriptText(n)}catch(e){this.onError(e)}}OnPartialResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("RECOGNIZED: "+n),this.onTranscriptPartialText(""+n)}catch(e){this.onError(e)}}InitializeSpeechToTextClient(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){null!=this.closeConnectionPromise&&(yield this.closeConnectionPromise),this.speechToTextClient=new s.a(void 0,this.fdSpeechClientObserver,!0,!0,!0,l.a.Dictation,u.a.getInstance().getALSession());let e=0;do{e>0&&(yield Object(p.b)(d.f.retryWaitMilliseconds)),this.attempt++,yield this.speechToTextClient.initializeAsync([s.b.PartialResult,s.b.FinalResult])}while(!this.speechToTextClient.initialized&&e++<d.f.maxRetries)}))}OnAudioBufferCallback(e){this.onAudioBuffer(e)}}class h{static createInstance(e,t,n){null==this.instance&&(this.instance=new g(e,t,n))}static GetInstance(){return this.instance}}},1106:function(e,t,n){"use strict";n.r(t),n.d(t,"AppStatus",(function(){return u.a})),n.d(t,"CardActionabilityStatus",(function(){return u.b})),n.d(t,"CardOptions",(function(){return u.c})),n.d(t,"CardRefreshMode",(function(){return u.d})),n.d(t,"LogType",(function(){return u.e})),n.d(t,"MsgExtCardVerificationStatus",(function(){return u.f})),n.d(t,"RenderingMode",(function(){return u.g})),n.d(t,"ResultTypes",(function(){return u.h})),n.d(t,"ThemeMode",(function(){return u.i})),n.d(t,"TypeOfAuthFlow",(function(){return u.j})),n.d(t,"CustomTelemetryMessages",(function(){return r})),n.d(t,"PerfName",(function(){return s})),n.d(t,"PerfTag",(function(){return i})),n.d(t,"SuccessStatus",(function(){return l})),n.d(t,"TelemetryName",(function(){return a})),n.d(t,"TelemetryPropType",(function(){return c})),n.d(t,"TelemetryTag",(function(){return o}));var r,o,i,a,s,l,c,u=n(752);!function(e){e[e.None=0]="None",e[e.SendBotRequestFailed=1]="SendBotRequestFailed",e[e.UrlHandeledAsDeepLink=2]="UrlHandeledAsDeepLink",e[e.UrlNotOpenedForCard=3]="UrlNotOpenedForCard",e[e.UrlOpenedForCard=4]="UrlOpenedForCard",e[e.UnableToGetAppInfo=5]="UnableToGetAppInfo",e[e.CardContentIsNull=6]="CardContentIsNull",e[e.ActionTypeIsNotSupported=7]="ActionTypeIsNotSupported",e[e.CardActionabilityBlocked=8]="CardActionabilityBlocked",e[e.NoActionPerformed=9]="NoActionPerformed",e[e.CardIdOrRenderingModeUndefined=10]="CardIdOrRenderingModeUndefined",e[e.AuthOnExecuteActionFailed=11]="AuthOnExecuteActionFailed"}(r||(r={})),function(e){e[e.MsgExtExecuteActionV2=1]="MsgExtExecuteActionV2",e[e.ExecuteAction=2]="ExecuteAction",e[e.MsgExtOpenUrlActionV2=3]="MsgExtOpenUrlActionV2",e[e.MsgExtShowCardActionV2=4]="MsgExtShowCardActionV2",e[e.MsgExtSSOTokenNeeded=5]="MsgExtSSOTokenNeeded",e[e.MsgExtSubmitAction=6]="MsgExtSubmitAction",e[e.MsgExtToggleVisibilityActionV2=7]="MsgExtToggleVisibilityActionV2",e[e.UpdateAppInfoOrchestrator=8]="UpdateAppInfoOrchestrator",e[e.GetAppFromAppId=9]="GetAppFromAppId",e[e.HydrateCard=10]="HydrateCard",e[e.ThumbnailCardRenderer=11]="ThumbnailCardRenderer",e[e.CardVerificationUtils=12]="CardVerificationUtils",e[e.AdaptiveCardRenderer=13]="AdaptiveCardRenderer",e[e.CardActions=14]="CardActions",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.O365ConnectorCardRenderer=16]="O365ConnectorCardRenderer",e[e.O365ConnectorCardUtils=17]="O365ConnectorCardUtils",e[e.MsgExtSerializationContext=18]="MsgExtSerializationContext",e[e.MsgExtCardRenderer=19]="MsgExtCardRenderer"}(o||(o={})),function(e){e[e.Commands=1]="Commands",e[e.CardActionability=2]="CardActionability",e[e.CardRender=3]="CardRender",e[e.GetCardForLink=4]="GetCardForLink"}(i||(i={})),function(e){e[e.Execute=1]="Execute",e[e.ExecuteActionOpenUrl=2]="ExecuteActionOpenUrl",e[e.MsgExtExecuteActionV2=3]="MsgExtExecuteActionV2",e[e.MsgExtOpenUrlActionV2=4]="MsgExtOpenUrlActionV2",e[e.GetAppForAppId=5]="GetAppForAppId",e[e.UpdateAppInfoOrchestrator=6]="UpdateAppInfoOrchestrator",e[e.PreProcessingRequest=7]="PreProcessingRequest",e[e.GetMsgExtOnSSOTokenNeeded=8]="GetMsgExtOnSSOTokenNeeded",e[e.OnSSOTokenFetch=9]="OnSSOTokenFetch",e[e.ThumbnailCardRenderer=10]="ThumbnailCardRenderer",e[e.VerifyCard=11]="VerifyCard",e[e.TransformO365Action=12]="TransformO365Action",e[e.HydrateCard=13]="HydrateCard",e[e.O365ConnectorCardRenderer=14]="O365ConnectorCardRenderer",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.CardActionStubbed=16]="CardActionStubbed",e[e.CardActions=17]="CardActions",e[e.HandleTapAction=18]="HandleTapAction",e[e.ExecuteAction=19]="ExecuteAction",e[e.parseAction=20]="parseAction",e[e.MsgExtCardRendererBizApp=21]="MsgExtCardRendererBizApp"}(a||(a={})),function(e){e[e.SendBotRequest=1]="SendBotRequest",e[e.AppHeaderProcessing=2]="AppHeaderProcessing",e[e.MsgExtBaseCommand=3]="MsgExtBaseCommand",e[e.HydrateCard=4]="HydrateCard",e[e.UnfurlLink=5]="UnfurlLink",e[e.VerifyCard=6]="VerifyCard",e[e.GetApp=7]="GetApp",e[e.ExecuteAction=8]="ExecuteAction",e[e.SubmitAction=9]="SubmitAction",e[e.ShowCardAction=10]="ShowCardAction",e[e.ToggleVisibilityAction=11]="ToggleVisibilityAction",e[e.OpenUrlAction=12]="OpenUrlAction",e[e.AuthOnExecuteAction=13]="AuthOnExecuteAction"}(s||(s={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(l||(l={})),function(e){e.RenderingMode="RenderingMode",e.CardActionabilityStatus="CardActionabilityStatus",e.Trigger="Trigger",e.ActionType="ActionType",e.MessageType="MessageType",e.SourceType="SourceType",e.SilentAuthScenario="SilentAuthScenario",e.LinkUnfurlingErrorScenario="LinkUnfurlingErrorScenario",e.ResultType="ResultType",e.TypeOfCard="TypeOfCard",e.CardVerificationStatus="CardVerificationStatus",e.HttpStatus="HttpStatus",e.HasBotId="HasBotId",e.ModalTypes="ModalTypes",e.HasTaskURL="HasTaskURL",e.HasTaskCard="HasTaskCard",e.StageViewOrTaskModuleResult="StageViewOrTaskModuleResult",e.CardRendered="CardRendered",e.TypeOfAuthFlow="TypeOfAuthFlow"}(c||(c={}))},1109:function(e,t,n){"use strict";function r(e){var t,n,r,o,i;return"invoke"===(null===(t=e.msteams)||void 0===t?void 0:t.type)&&"tab/tabInfoAction"===(null===(r=null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.value)||void 0===r?void 0:r.type)&&!!(null===(i=null===(o=null==e?void 0:e.msteams)||void 0===o?void 0:o.value)||void 0===i?void 0:i.tabInfo)}function o(e){var t,n,r,o;return"task/fetch"===(null===(t=null==e?void 0:e.msteams)||void 0===t?void 0:t.type)||"invoke"===(null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.type)&&"task/fetch"===(null===(o=null===(r=null==e?void 0:e.msteams)||void 0===r?void 0:r.value)||void 0===o?void 0:o.type)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1110:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=n(28),i=n(175),a=n(32),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getEffectiveTooltip=function(){var t=e.prototype.getEffectiveTooltip.call(this);return t?"".concat(t,"\n").concat(this.getHref()):this.getHref()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,o.A.PropertyCantBeNull,i.a.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new a.n(a.s.v1_0,"url"),t.JsonTypeName="Action.OpenUrl",t}(n(181).a)},1111:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),o=n(1),i=n(175),a=n(147),s=n(28),l=n(181),c=n(822),u=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._inlines=[],t}return Object(r.__extends)(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(i.a.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!==this)throw new Error(i.a.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){var o,i;if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))try{for(var a=Object(r.__values)(t.inlines),s=a.next();!s.done;s=a.next()){var l=s.value,u=void 0;if("string"==typeof l){var d=new c.a;d.text=l,u=d}else u=n.parseElement(this,l,[],!1);u&&this.internalAddInline(u,!0)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){var o,i;if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){var a=[];try{for(var s=Object(r.__values)(this._inlines),l=s.next();!l.done;l=s.next()){var c=l.value;a.push(c.toJSON(n))}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}n.serializeValue(t,"inlines",a)}},t.prototype.internalRender=function(e){if(this._inlines.length>0){var t=Object(a.b)();switch(t.id=this.id,t.htmlFor=this.forElementId,t.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),t.style.margin=0,t.style.padding=0,this.getEffectiveHorizontalAlignment()){case s.i.Center:t.style.textAlign="center";break;case s.i.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this._inlines.map((function(e){return o.createElement(e.Render,{key:e.key})}));if(n.length>0)return o.createElement(this.forElementId?"label":"div",t,n)}return null},t.prototype.asString=function(){var e,t,n="";try{for(var o=Object(r.__values)(this._inlines),i=o.next();!i.done;i=o.next()){n+=i.value.asString()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(i.a.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new c.a(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(l.d)},1113:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(32),i=n(28),a=n(175),s=n(181),l=n(147),c=new o.f("TargetElement",[{name:"elementId",valueType:"string",isArray:!1},{name:"isVisible",valueType:"boolean",isArray:!1}]),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueType:["string",c],isArray:!0}},t}(o.c),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"targetElements",{get:function(){return this.getValue(t.targetElementsProperty)},set:function(e){this.setValue(t.targetElementsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);if(e.length>0)return e.join(" ")}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,i.A.PropertyCantBeNull,a.a.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.execute=function(){var t,n,o;e.prototype.execute.call(this);var i=null===(o=this.parent)||void 0===o?void 0:o.getRootObject();if(i&&i instanceof s.d)try{for(var a=Object(r.__values)(Object.keys(this.targetElements)),l=a.next();!l.done;l=a.next()){var c=l.value,u=i.getElementById(c);u&&("boolean"==typeof this.targetElements[c]?u.isVisible=this.targetElements[c]:u.isVisible=!u.isVisible)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t},t.prototype.removeTargetElement=function(e){delete this.targetElements[e]},t.targetElementsProperty=new u(o.s.v1_2,"targetElements",(function(e,t,n,o){var i,a,s={};if(Array.isArray(n[t.name]))try{for(var c=Object(r.__values)(n[t.name]),u=c.next();!u.done;u=c.next()){var d=u.value;if("string"==typeof d)s[d]=void 0;else if("object"==typeof d){var p=d.elementId;"string"==typeof p&&(s[p]=Object(l.g)(d.isVisible))}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}return s}),(function(e,t,n,o,i){var a,s,l=[];try{for(var c=Object(r.__values)(Object.keys(o)),u=c.next();!u.done;u=c.next()){var d=u.value;"boolean"==typeof o[d]?l.push({elementId:d,isVisible:o[d]}):l.push(d)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}i.serializeArray(n,t.name,l)}),{},(function(e){return{}})),t.JsonTypeName="Action.ToggleVisibility",t}(s.a)},1114:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(28),i=n(161),a=n(175),s=n(181),l=n(32),c=n(321),u=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.suppressStyle=!1,t}return Object(r.__extends)(t,e),t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),["$schema","version"],!1)},t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(c.a.$schemaProperty,c.a.versionProperty)},t.prototype.getDefaultPadding=function(){var e=this.suppressStyle?o.t.None:o.t.Padding;return new i.b(e,e,e,e)},t.prototype.getSpacings=function(t){if(e.prototype.getSpacings.call(this,t),!this.suppressStyle){var n=new i.b;this.getImmediateSurroundingPadding(n);var r=this.hostConfig.paddingDefinitionToSpacingDefinition(n);t.padding.left=r.left,t.padding.right=r.right,t.margin.left=-r.left,t.margin.right=-r.right,0!==r.bottom&&(t.padding.bottom=r.bottom,t.margin.bottom=-r.bottom)}},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t["aria-live"]="polite",t.tabIndex=void 0},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?o.f.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:o.f.Emphasis},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandableInlineElement",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(c.a),d=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.card=new u,t}return Object(r.__extends)(t,e),t.prototype.inlineCardExpanded=function(e){var t,n=null===(t=this.parent)||void 0===t?void 0:t.getRootObject(),r=n instanceof c.a&&n.onInlineCardExpanded?n.onInlineCardExpanded:c.a.onInlineCardExpanded;r&&r(this,e)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var r=t.card;r?this.card.parse(r,n):n.logParseEvent(this,o.A.PropertyCantBeNull,a.a.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"card",valueType:new l.d(this.card,"AdaptiveCard"),isArray:!1}],!1)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.card.suppressStyle=e,t&&this.inlineCardExpanded(!0)},t.prototype.collapse=function(){this.inlineCardExpanded(!1)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(this.card.getAllActions()),!1)),t},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(this.card.getResourceInformation()),!1)),t},t.prototype.getInlineContent=function(){return this.card},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);return n||(n=this.card.getElementById(t)),n},t.prototype.hasResponsiveElements=function(){return this.card.isResponsive()},t.prototype.shouldRaiseOnExecuteEvent=function(){return this.hostConfig.actions.showCard.actionMode===o.q.Popup},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),["card"],!1)},Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.JsonTypeName="Action.ShowCard",t}(s.a)},1115:function(e,t,n){"use strict";function r(e){var t,n,r,o,i;return"invoke"===(null===(t=e.msteams)||void 0===t?void 0:t.type)&&"tab/tabInfoAction"===(null===(r=null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.value)||void 0===r?void 0:r.type)&&!!(null===(i=null===(o=null==e?void 0:e.msteams)||void 0===o?void 0:o.value)||void 0===i?void 0:i.tabInfo)}function o(e){var t,n,r,o;return"task/fetch"===(null===(t=null==e?void 0:e.msteams)||void 0===t?void 0:t.type)||"invoke"===(null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.type)&&"task/fetch"===(null===(o=null===(r=null==e?void 0:e.msteams)||void 0===r?void 0:r.value)||void 0===o?void 0:o.type)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1116:function(e,t,n){"use strict";function r(e){var t,n,r,o,i;return"invoke"===(null===(t=e.msteams)||void 0===t?void 0:t.type)&&"tab/tabInfoAction"===(null===(r=null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.value)||void 0===r?void 0:r.type)&&!!(null===(i=null===(o=null==e?void 0:e.msteams)||void 0===o?void 0:o.value)||void 0===i?void 0:i.tabInfo)}function o(e){var t,n,r,o;return"task/fetch"===(null===(t=null==e?void 0:e.msteams)||void 0===t?void 0:t.type)||"invoke"===(null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.type)&&"task/fetch"===(null===(o=null===(r=null==e?void 0:e.msteams)||void 0===r?void 0:r.value)||void 0===o?void 0:o.type)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1120:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(32),i=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._capabilities={},t}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var r in t){var i=t[r];if("string"==typeof i)if("*"===i)this.addCapability(r,"*");else{var a=o.r.parse(i,n);(null==a?void 0:a.isValid)&&this.addCapability(r,a)}}},t.prototype.internalToJSON=function(t,n){for(var r in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[r]=this._capabilities[r]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(o.j)},1129:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n(2),o=n(75),i=n(103),a=n(215),s=n(125),l=n(52),c=n(239),u=n(105),d=n(17),p=n(171),g=n(44);function h(e,t,n,r,i){var a=p.a.getInstance();Object(l.c)("basicChatErrorHandler called with error : ".concat(e," and status : "),t);var h="";if(!Object(l.r)(e.errorDetailsJson))try{h=JSON.parse(e.errorDetailsJson).code}catch(e){Object(l.c)("Error parsing error code from basic chat error",e.message)}s.a.getInstance().sendLoggingEventToClient(c.g.AugloopErrorReceived,{annotationName:i,timeInMs:Object(u.b)(u.d),chatEventParams:JSON.stringify({errorCategory:e.category,errorCode:h})}),a.sendTelemetryChatEventData([{key:d.g.ChatEventType,value:"".concat(i,"_Error")},{key:d.g.ChatEventParameters,value:"".concat(e.category,"_").concat(h)},{key:d.g.ChatErrorType,value:d.e.Server},{key:d.g.UserQueryGuid,value:s.a.getInstance().getQueryID()}]),a.sendTelemetryLatencyData([{key:d.k.ErrorParameter,value:"".concat(e.category,"_").concat(h)},{key:d.k.ErrorType,value:d.e.Server}]);var v=e.category,b=d.a.Fallback,y=d.c.BasicChatUnclassifiedError;switch(v){case o.a.OffensiveContent:switch(y=d.c.BasicChatRAIFilterBlockedResponse,h){case o.b.OffensiveInputContent:b=d.a.OffensiveInput,f(n,Object(g.db)());break;case o.b.OffensiveOutputContent:b=d.a.OffensiveOutput,f(n,Object(g.eb)());break;case o.b.OutputBlockedByDynamicGuardList:b=d.a.OutputBlocked,f(n,Object(g.eb)());break;case o.b.InputBlockedByDynamicGuardList:b=d.a.InputBlocked,f(n,Object(g.Z)());break;default:f(n,Object(g.cb)())}break;case o.a.PromptInjection:if(h===o.b.Detected)y=d.c.BasicChatRAIFilterBlockedResponse,b=d.a.PromptInjection,f(n,Object(g.Z)());else f(n,Object(g.cb)());break;case o.a.InvalidSignal:switch(b=d.a.InvalidSignal,y=d.c.BasicChatUnclassifiedError,h){case o.b.Missing:b=d.a.SignalMissing,f(n,Object(g.cb)());break;case o.b.WrongType:b=d.a.SignalWrongType,f(n,Object(g.cb)());break;default:f(n,Object(g.cb)())}break;case o.a.InvalidLanguage:if(b=d.a.InvalidLanguage,y=d.c.BasicChatUnsupportedCopilotFunctionality,h===o.b.NotSupported){var C=s.a.getInstance().getBasicChatProps();(null==C?void 0:C.languageHelpLink)?m(n,Object(g.bb)(),Object(g.jb)(),C.languageHelpLink):f(n,Object(g.bb)())}else f(n,Object(g.cb)());break;case o.a.InferenceAPI:switch(h){case o.b.Timeout:y=d.c.BasicChatResponseTimedOut,b=d.a.Timeout,f(n,Object(g.gb)());break;case o.b.UserThrottled:b=d.a.UserThrottled,y=d.c.BasicChatCapacityIssues,f(n,Object(g.hb)());break;case o.b.Throttled:b=d.a.Throttled,y=d.c.BasicChatCapacityIssues,f(n,Object(g.fb)());break;case o.b.ScenarioThrottled:b=d.a.ScenarioThrottled,y=d.c.BasicChatCapacityIssues,f(n,Object(g.fb)());break;case o.b.NotAvailable:b=d.a.APIUnavailable,y=d.c.BasicChatBadResponse,f(n,Object(g.gb)());break;case o.b.InputRaiDependency:b=d.a.RAIOnInputError,y=d.c.BasicChatRAIFilterBlockedResponse,f(n,Object(g.db)());break;case o.b.OutputRaiDependency:b=d.a.RAIOnOutputError,y=d.c.BasicChatRAIFilterBlockedResponse,f(n,Object(g.cb)());break;case o.b.UnknownOpenAI:b=d.a.UnknownError,y=d.c.BasicChatBadResponse,f(n,Object(g.cb)());break;case o.b.BadResponse:b=d.a.BadResponse,y=d.c.BasicChatBadResponse,f(n,Object(g.cb)());break;case o.b.BadRequest:b=d.a.BadRequest,y=d.c.BasicChatUnclassifiedError,f(n,Object(g.cb)());break;case o.b.Unknown:b=d.a.Unknown,y=d.c.BasicChatUnclassifiedError,f(n,Object(g.cb)());break;default:f(n,Object(g.cb)())}break;case o.a.InvalidInput:if(h===o.b.TooLong)b=d.a.InputTooLong,y=d.c.BasicChatInputNotProcessed,f(n,Object(g.ab)());else f(n,Object(g.cb)());break;default:f(n,Object(g.cb)())}a.logErrorWithAshaVetoAndError([{key:d.g.UserQueryGuid,value:s.a.getInstance().getQueryID()}],s.a.getInstance().getFeatureName(),g.w,y,b),s.a.getInstance().getIsFluxFlowEnabled()||(Object(l.c)("Encountered Error. Stopping loading UI"),r(!1))}var f=function(e,t){e.setChatMessageData(i.a.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.a.Footer,isFailure:!0,showAnimation:!1,feedbackData:s.a.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:s.a.getInstance().getQueryID(),featureName:s.a.getInstance().getFeatureName()})},!0)},m=function(e,t,n,r){e.setChatMessageData(i.a.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t,linkText:{text:n,linkOnClick:v,linkUrl:r}}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.a.Footer,isFailure:!0,showAnimation:!1,feedbackData:s.a.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:s.a.getInstance().getQueryID(),featureName:s.a.getInstance().getFeatureName()})},!0)},v=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return window.open(e),[2]}))}))}},1130:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b}));var r,o=n(1489),i=n(1140),a=n(1541),s=n(832),l=n(1542),c=n(1151),u=n(52),d=n(105),p=n(485),g=n(260),h=n(44),f=n(171),m=n(17),v=function(e,t,n){var s,l,u=Object(p.a)(),d=i.a.POST;e===i.b.Suggestion?(s=y(u),l=O()):(s=C(t,n),l=S(u));var h={request:s,headers:l,httpMethod:d,type:e,queryId:u,scenario:g.a.getSubstrateScenarioName()},v=new o.a({parentPath:["Signal",a.a.getTypeName()],items:[{id:c.a.generateId(),body:new a.a(h)}]});return f.a.getInstance().sendTelemetryChatEventData([{key:m.g.ChatEventType,value:m.f.SubstrateAPIOperationSubmitted},{key:m.g.ChatEventParameters,value:e},{key:m.g.UserQueryGuid,value:u}]),r=(new Date).getTime(),v},b=function(e,t,n){var o,a,c;Object(u.c)("".concat(s.a.getTypeName()," response received\n Time Taken: ").concat(Object(d.c)(r),"s "));var p=e.body,g=p.queryId,h=p.status,v=p.results,b=p.error,y=p.httpStatus,C=p.type,O=f.a.getInstance();if(O.sendTelemetryChatEventData([{key:m.g.ChatEventType,value:m.f.ResponseReceivedFromAL},{key:m.g.ChatEventParameters,value:s.a.getTypeName()},{key:m.g.UserQueryGuid,value:g},{key:m.g.Cv,value:n}]),O.sendTelemetryLatencyData([{key:m.k.SubstrateAPIResponseTime,value:Object(d.c)(r)},{key:m.k.UserQueryGuid,value:g}]),g&&Object(u.c)("substrateAPIResponseAnnotationProcessor: queryID: ",g),y&&Object(u.c)("substrateAPIResponseAnnotationProcessor: httpStatus: ",y),v&&Object(u.c)("substrateAPIResponseAnnotationProcessor: results: ",v),h===l.a.Failed){var S="";return b?(Object(u.c)("substrateAPIResponseAnnotationProcessor: error: ",b),S=null!==(o=null==b?void 0:b.code)&&void 0!==o?o:""):S=null!==(a=null==y?void 0:y.toString())&&void 0!==a?a:"",void O.sendTelemetryChatEventData([{key:m.g.ChatEventType,value:"".concat(s.a.getTypeName(),"_Error")},{key:m.g.ChatEventParameters,value:S},{key:m.g.ChatErrorType,value:m.e.Server},{key:m.g.UserQueryGuid,value:g}])}if(h===l.a.Success&&C===i.b.Suggestion&&v)try{var E=JSON.parse(null!=v?v:""),x=null==E?void 0:E.Groups,I=null===(c=null==x?void 0:x[0])||void 0===c?void 0:c.Suggestions;(null==I?void 0:I.length)>0&&t(I)}catch(e){return void Object(u.c)("substrateAPIResponseAnnotationProcessor: failed to parse results")}},y=function(e){var t={EntityRequests:[{EntityType:h.N,Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:g.a.getAppName()}}]}]},Size:h.xb}],TimeZone:h.M,Cvid:e,Scenario:{Name:g.a.getSubstrateScenarioName(),Dimensions:[{DimensionName:h.t,DimensionValue:h.u}]}};return JSON.stringify(t)},C=function(e,t){void 0===t&&(t=!1);var n={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:t,ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(n)},O=function(){return[{key:h.L.XClientLanguage,value:g.a.getLanguage()},{key:h.L.XClientFlights,value:h.K}]},S=function(e){return[{key:h.L.ClientRequestId,value:e}]}},1131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"MsgExt3SChannelService",{enumerable:!0,get:function(){return o.MsgExt3SChannelService}}),Object.defineProperty(t,"MsgExtCardService",{enumerable:!0,get:function(){return r.MsgExtCardService}}),Object.defineProperty(t,"MsgExtHostService",{enumerable:!0,get:function(){return i.MsgExtHostService}}),Object.defineProperty(t,"MsgExtPreviewHostService",{enumerable:!0,get:function(){return a.MsgExtPreviewHostService}}),Object.defineProperty(t,"PerfMarker",{enumerable:!0,get:function(){return s.PerfMarker}});var r=n(2705),o=n(2706),i=n(2707),a=n(2712),s=n(2713)},1148:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),o=n(451);function i(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=0,r.label=1;case 1:if(!(i<t))return[3,8];r.label=2;case 2:return r.trys.push([2,6,,7]),i>0?[4,(s=n,new Promise((function(e,t){setTimeout((function(){e()}),s)})))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[4,e(i)];case 5:return[2,r.sent()];case 6:return a=r.sent(),o=a,[3,7];case 7:return i++,[3,1];case 8:throw o}var s}))}))}var a=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e)];case 1:if(!(t=r.sent())||t&&!t.ok)throw i="toDataUrl: Could not fetch image at ".concat(e),Object(o.a)(i),new Error(i);r.label=2;case 2:return r.trys.push([2,4,,5]),[4,t.blob()];case 3:return n=r.sent(),[2,new Promise((function(t,r){var o=new FileReader;o.onloadend=function(){null!==o.result?t(o.result.toString()):r(new Error("toDataUrl: Could not get base64 encoding of image at "+e))},o.onerror=function(){return r()},o.readAsDataURL(n)}))];case 4:throw r.sent(),i="toDataUrl: Could not get base64 encoding of image at ".concat(e),Object(o.a)(i),new Error(i);case 5:return[2]}}))}))}},1149:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1170);class o{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.b.LogMetric,tag:this.tag,name:this.name,success:r.f.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.b.LogMetric,tag:this.tag,name:this.name,success:r.f.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.b.LogMetric,tag:this.tag,name:this.name,success:r.f.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},1150:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(52),o=function(){},i=function(){function e(){}return e.prototype.LogTelemetryEvent=function(e){Object(r.c)("LogTelemetryEvent: EventName: "+e.GetEventName()+"\n EventType: "+e.GetEventType()+"\n EventLogs: ",e.GetLogs())},e}()},1151:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.generateId=function(){return e.operationId++,"AugLoopCopilotChat"+e.operationId.toString()},e.operationId=0,e}()},1152:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),o=n(452);function i(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=0,r.label=1;case 1:if(!(i<t))return[3,8];r.label=2;case 2:return r.trys.push([2,6,,7]),i>0?[4,(s=n,new Promise((function(e,t){setTimeout((function(){e()}),s)})))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[4,e(i)];case 5:return[2,r.sent()];case 6:return a=r.sent(),o=a,[3,7];case 7:return i++,[3,1];case 8:throw o}var s}))}))}var a=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e)];case 1:if(!(t=r.sent())||t&&!t.ok)throw i="toDataUrl: Could not fetch image at ".concat(e),Object(o.a)(i),new Error(i);r.label=2;case 2:return r.trys.push([2,4,,5]),[4,t.blob()];case 3:return n=r.sent(),[2,new Promise((function(t,r){var o=new FileReader;o.onloadend=function(){null!==o.result?t(o.result.toString()):r(new Error("toDataUrl: Could not get base64 encoding of image at "+e))},o.onerror=function(){return r()},o.readAsDataURL(n)}))];case 4:throw r.sent(),i="toDataUrl: Could not get base64 encoding of image at ".concat(e),Object(o.a)(i),new Error(i);case 5:return[2]}}))}))}},1154:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),o=n(453);function i(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=0,r.label=1;case 1:if(!(i<t))return[3,8];r.label=2;case 2:return r.trys.push([2,6,,7]),i>0?[4,(s=n,new Promise((function(e,t){setTimeout((function(){e()}),s)})))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[4,e(i)];case 5:return[2,r.sent()];case 6:return a=r.sent(),o=a,[3,7];case 7:return i++,[3,1];case 8:throw o}var s}))}))}var a=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e)];case 1:if(!(t=r.sent())||t&&!t.ok)throw i="toDataUrl: Could not fetch image at ".concat(e),Object(o.a)(i),new Error(i);r.label=2;case 2:return r.trys.push([2,4,,5]),[4,t.blob()];case 3:return n=r.sent(),[2,new Promise((function(t,r){var o=new FileReader;o.onloadend=function(){null!==o.result?t(o.result.toString()):r(new Error("toDataUrl: Could not get base64 encoding of image at "+e))},o.onerror=function(){return r()},o.readAsDataURL(n)}))];case 4:throw r.sent(),i="toDataUrl: Could not get base64 encoding of image at ".concat(e),Object(o.a)(i),new Error(i);case 5:return[2]}}))}))}},1155:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return o}));var o=function(e,t){return void 0===t&&(t=!1),r?r.getBooleanFeatureGate(e,t):t}},1157:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(1),i=n(175),a=function(e){function t(t){var n=e.call(this)||this;return n._actions=t,n.title=n.localizeString(i.a.overflowButtonText),n.tooltip=n.localizeString(i.a.overflowButtonTooltip),n}return Object(r.__extends)(t,e),t.prototype.shouldDisplayBuiltInOverflowActionMenu=function(){return!this.onShouldDisplayBuiltInOverflowActionMenu||this.onShouldDisplayBuiltInOverflowActionMenu(this)},t.prototype.displayOverflowActionMenu=function(e){this.onDisplayOverflowActionMenu&&this.onDisplayOverflowActionMenu(this,e)},t.prototype.getButtonMenuItems=function(){return this.shouldDisplayBuiltInOverflowActionMenu()?this._actions.map((function(e,t){return e.asMenuItem(t.toString())})):void 0},t.prototype.getActions=function(){return this._actions},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(this._actions),!1)),t},t.prototype.getJsonTypeName=function(){return"Internal_Action.Overflow"},t.prototype.execute=function(){this.shouldDisplayBuiltInOverflowActionMenu()||this.displayOverflowActionMenu(this.domElement)},t.prototype.setupElementForAccessibility=function(t,n){void 0===n&&(n=!1),e.prototype.setupElementForAccessibility.call(this,t,n),t["aria-label"]=this.localizeString(i.a.overflowButtonTooltip)},t.JsonTypeName="Action.Overflow",t}(n(181).a),s=n(28),l=n(32),c=n(161),u=n(147),d=function(){function e(e){this._items=[],this._renderedActions=[],this._owner=e}return e.getActionsPropertyDescriptor=function(e){for(var t=[],n=0;n<e.actionRegistry.getItemCount();n++){var r=e.actionRegistry.getItemAt(n),o=r.createInstance({context:e,typeName:r.typeName,targetVersion:e.targetVersion});t.push(new l.d(o))}return{name:"actions",valueType:t.sort((function(e,t){return e.name.localeCompare(t.name)})),isArray:!0}},e.prototype.renderInlineAdaptiveCard=function(e,t){return t?o.createElement(e.Render,null):o.createElement("div",{style:{marginTop:"".concat(this._owner.hostConfig.actions.showCard.inlineTopMargin,"px")},key:e.key},o.createElement(e.Render,null))},e.prototype.updateLayout=function(){this._owner.getRootObject().updateLayout()},e.prototype.collapseExpandedAction=function(){var e,t;try{for(var n=Object(r.__values)(this._renderedActions),o=n.next();!o.done;o=n.next()){o.value.state=s.b.Normal}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}var i=this._expandedAction;this._expandedAction=void 0,i&&(i.collapse(),this.updateLayout())},e.prototype.shouldDisplayBuiltInOverflowActionButton=function(e){return!this.onShouldDisplayBuiltInOverflowActionButton||this.onShouldDisplayBuiltInOverflowActionButton(e)},e.prototype.shouldDisplayBuiltInOverflowActionMenu=function(e){return!this.onShouldDisplayBuiltInOverflowActionMenu||this.onShouldDisplayBuiltInOverflowActionMenu(e)},e.prototype.displayOverflowActionMenu=function(e,t){this.onDisplayOverflowActionMenu&&this.onDisplayOverflowActionMenu(e,t)},e.prototype.releaseDOMResources=function(){var e,t;try{for(var n=Object(r.__values)(this._renderedActions),o=n.next();!o.done;o=n.next()){o.value.releaseDOMResources()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.actionExecuted=function(e){var t,n;if(e.isExpandable){if(e===this._expandedAction)this.collapseExpandedAction();else if(this._owner.hostConfig.actions.showCard.actionMode===s.q.Inline){try{for(var o=Object(r.__values)(this._renderedActions),i=o.next();!i.done;i=o.next()){var a=i.value;a.state=a!==e?s.b.Subdued:s.b.Expanded}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this._expandedAction=e,e.expand(!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),!0)}}else this.collapseExpandedAction();this.updateLayout()},e.prototype.parse=function(e,t){var n,o;if(this.clear(),Array.isArray(e))try{for(var i=Object(r.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value,l=t.parseAction(this._owner,s,[],!0);l&&this.addAction(l)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this._items)},e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){var t,n,o;try{for(var i=Object(r.__values)(this._items),a=i.next();!a.done;a=i.next()){if(o=a.value.getActionById(e))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e.prototype.getElementById=function(e){var t,n,o;try{for(var i=Object(r.__values)(this._items),a=i.next();!a.done;a=i.next()){if(o=a.value.getElementById(e))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e.prototype.validateProperties=function(e){var t,n;this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,s.A.TooManyActions,i.a.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,s.A.InteractivityNotAllowed,i.a.errors.interactivityNotAllowed());try{for(var o=Object(r.__values)(this._items),a=o.next();!a.done;a=o.next()){a.value.internalValidateProperties(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.render=function(e){var t,n,i=this,l=this._owner.hostConfig;if(!l.supportsInteractivity)return null;var d=l.actions.maxActions?Math.min(l.actions.maxActions,this._items.length):this._items.length;this._renderedActions=[];var p=[],g=1===d?this._items[0].getInlineContent():void 0;if(l.actions.preExpandSingleShowCardAction&&g)this._renderedActions.push(this._items[0]),p.push(this.renderInlineAdaptiveCard(g,!0));else{var h=Object(u.b)();if(h.className=l.makeCssClassName("ac-actionSet"),h.style.display="flex",h.style.gap=l.actions.buttonSpacing,e===s.p.Horizontal)if(h.style.flexDirection="row",l.actions.allowButtonsToWrap&&(h.style.flexWrap="wrap"),this._owner.horizontalAlignment&&l.actions.actionAlignment!==s.a.Stretch)switch(this._owner.horizontalAlignment){case s.i.Center:h.style.justifyContent="center";break;case s.i.Right:h.style.justifyContent="flex-end";break;default:h.style.justifyContent="flex-start"}else switch(l.actions.actionAlignment){case s.a.Center:h.style.justifyContent="center";break;case s.a.Right:h.style.justifyContent="flex-end";break;default:h.style.justifyContent="flex-start"}else if(h.style.flexDirection="column",this._owner.horizontalAlignment&&l.actions.actionAlignment!==s.a.Stretch)switch(this._owner.horizontalAlignment){case s.i.Center:h.style.alignItems="center";break;case s.i.Right:h.style.alignItems="flex-end";break;default:h.style.alignItems="flex-start"}else switch(l.actions.actionAlignment){case s.a.Center:h.style.alignItems="center";break;case s.a.Right:h.style.alignItems="flex-end";break;case s.a.Stretch:h.style.alignItems="stretch";break;default:h.style.alignItems="flex-start"}var f=[],m=[];if(this._owner.isDesignMode())f.push.apply(f,Object(r.__spreadArray)([],Object(r.__read)(this._items),!1));else{this._items.forEach((function(e){return e.mode===s.d.Secondary?m.push(e):f.push(e)}));var v=f.splice(l.actions.maxActions);c.a.allowMoreThanMaxActionsInOverflowMenu&&m.push.apply(m,Object(r.__spreadArray)([],Object(r.__read)(v),!1));var b=!0;m.length>0&&(this._overflowAction||(this._overflowAction=new a(m),this._overflowAction.onShouldDisplayBuiltInOverflowActionMenu=function(e){return i.shouldDisplayBuiltInOverflowActionMenu(e)},this._overflowAction.onDisplayOverflowActionMenu=function(e,t){i.displayOverflowActionMenu(e,t)},this._overflowAction.setParent(this._owner)),b=this.shouldDisplayBuiltInOverflowActionButton(this._overflowAction)),this._overflowAction&&b&&f.push(this._overflowAction)}var y=f.map((function(e){var t=o.createElement(e.Render,{key:e.key});if(t)return i._renderedActions.push(e),t})).filter((function(e){return void 0!==e}));y.length>0&&p.push(o.createElement("div",{style:{overflow:"hidden"},key:"buttonStripContainer"},o.createElement("div",h,y)))}try{for(var C=Object(r.__values)(this._renderedActions),O=C.next();!O.done;O=C.next()){var S=O.value;if(S.state===s.b.Expanded){var E=S.getInlineContent();E&&p.push(this.renderInlineAdaptiveCard(E,!1));break}}}catch(e){t={error:e}}finally{try{O&&!O.done&&(n=C.return)&&n.call(C)}finally{if(t)throw t.error}}return p.length>0?o.createElement(o.Fragment,null,p):null},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(i.a.errors.actionAlreadyParented());this._items.push(e),e._owner=this,e.parent||e.setParent(this._owner)},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction===e&&this.collapseExpandedAction();var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0);for(var n=0;n<this._renderedActions.length;n++)if(this._renderedActions[n]===e){this._renderedActions.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this._items=[],this._renderedActions=[],this._expandedAction=void 0},e.prototype.getAllInputs=function(e){var t,n;void 0===e&&(e=!0);var o=[];if(e)try{for(var i=Object(r.__values)(this._items),a=i.next();!a.done;a=i.next()){var s=a.value;o.push.apply(o,Object(r.__spreadArray)([],Object(r.__read)(s.getAllInputs()),!1))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e.prototype.getResourceInformation=function(){var e,t,n=[];try{for(var o=Object(r.__values)(this._items),i=o.next();!i.done;i=o.next()){var a=i.value;n.push.apply(n,Object(r.__spreadArray)([],Object(r.__read)(a.getResourceInformation()),!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},e.prototype.hasResponsiveElements=function(){var e,t;try{for(var n=Object(r.__values)(this._items),o=n.next();!o.done;o=n.next()){if(o.value.hasResponsiveElements())return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}()},1159:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ErrorAudioPermissionDeniedError="ErrorAudioPermissionDeniedError",e.ErrorAudioDevicesNotFoundError="ErrorAudioDevicesNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioCaptureAsync="ErrorAudioCaptureAsync"}(r||(r={}))},1170:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p,g;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return g})),function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed",e[e.MorePluginsClickHostHandled=9]="MorePluginsClickHostHandled",e[e.ManagePluginsClickFailed=10]="ManagePluginsClickFailed",e[e.ManagePluginsClickHostHandled=11]="ManagePluginsClickHostHandled",e[e.GetCopilotPluginsIdsFailed=12]="GetCopilotPluginsIdsFailed",e[e.StoreFrontPluginsFetchFailed=13]="StoreFrontPluginsFetchFailed",e[e.StoreFrontCopilotPluginPermissionsClickHostHandled=14]="StoreFrontCopilotPluginPermissionsClickHostHandled",e[e.StoreFrontCopilotPluginPermissionsClickFailed=15]="StoreFrontCopilotPluginPermissionsClickFailed",e[e.StoreFrontCopilotPluginItemInstallSucceeded=16]="StoreFrontCopilotPluginItemInstallSucceeded",e[e.StoreFrontCopilotPluginItemInstallFailed=17]="StoreFrontCopilotPluginItemInstallFailed",e[e.PowerPlatformConnectorFlyoutDismissed=18]="PowerPlatformConnectorFlyoutDismissed",e[e.PowerPlatformConnectorFlyoutOpen=19]="PowerPlatformConnectorFlyoutOpen"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI",e[e.CopilotPluginStoreFrontUI=4]="CopilotPluginStoreFrontUI"}(i||(i={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePlugins=10]="ManagePlugins",e[e.StoreFrontCopilotPluginPermissions=11]="StoreFrontCopilotPluginPermissions",e[e.StoreFrontCopilotPluginIds=12]="StoreFrontCopilotPluginIds",e[e.StoreFrontCopilotPlugins=13]="StoreFrontCopilotPlugins",e[e.GetStoreFrontPluginsState=14]="GetStoreFrontPluginsState",e[e.InstallStoreFrontCopilotPlugin=15]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginItem=16]="StoreFrontCopilotPluginItem",e[e.PowerPlatformConnector=17]="PowerPlatformConnector"}(a||(a={})),function(e){e[e.getHeader=0]="getHeader",e[e.getPlugins=2]="getPlugins",e[e.getAppDefinition=3]="getAppDefinition",e[e.getBotInvokeRequest=4]="getBotInvokeRequest",e[e.handleAuthLinkClick=5]="handleAuthLinkClick",e[e.onToggle=6]="onToggle",e[e.nextButtonClick=7]="nextButtonClick",e[e.gotItButtonClick=8]="gotItButtonClick",e[e.getStoreFrontPlugins=9]="getStoreFrontPlugins"}(s||(s={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.getInstalledPlugins=4]="getInstalledPlugins",e[e.getSelectedPlugins=5]="getSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePluginsClick=10]="ManagePluginsClick",e[e.GetStoreFrontCopilotPluginIds=11]="GetStoreFrontCopilotPluginIds",e[e.GetStoreFrontCopilotPlugins=12]="GetStoreFrontCopilotPlugins",e[e.GetStoreFrontPlugins=13]="GetStoreFrontPlugins",e[e.InstallStoreFrontCopilotPlugin=14]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginPermissionClick=15]="StoreFrontCopilotPluginPermissionClick",e[e.StoreFrontCopilotPluginItemClick=16]="StoreFrontCopilotPluginItemClick",e[e.PowerPlatformConnectorClick=17]="PowerPlatformConnectorClick"}(l||(l={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(c||(c={})),function(e){e.IsCached="IsCached",e.FetchByNetwork="FetchByNetwork",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.isAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount",e.IsStoreFrontCopilotPluginIdsAvailable="IsStoreFrontCopilotPluginIdsAvailable",e.IsStoreFrontPluginInstallSuccess="IsStoreFrontCopilotPluginInstallationSuccess",e.IsStoreFrontCopilotPluginsAvailable="IsStoreFrontCopilotPluginsAvailable",e.TotalStoreFrontPluginsCount="TotalStoreFrontPluginsCount"}(u||(u={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(d||(d={})),function(e){e[e.Auth=0]="Auth",e[e.Config=1]="Config",e[e.SilentAuth=2]="SilentAuth",e[e.BotInvokeForAuthCheck=3]="BotInvokeForAuthCheck",e[e.Unknown=4]="Unknown"}(p||(p={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(g||(g={}))},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(330),o=n(103),i=n(215),a=n(720),s=n(135),l=n(576),c=n(52),u=n(796),d=n(1540),p=n(44),g=n(75),h=n(239),f=n(1489),m=n(159),v=n(323),b=n(17),y=n(171),C=n(105),O=n(485),S=n(1151),E=n(260),x=n(448),I=n(326),w=function(){function e(t,n,a){var s=this;this.citationPathDataIndexMap=new Map,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.streamChunks=[],this.isAnswerCompleted=!1,this.isBasicChatStreaming=!1,this.queryID="",this.suggestedQnaSignalSubmitTime=0,this.featureName=b.i.ChatQnA,this.onClickCitationLink=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=""),Object(c.c)("onClickCitationLink called with referenceId : ".concat(e,"  ,path"),s.citationPathDataIndexMap.get(e));var r={correlationId:"",featureName:""};try{r=JSON.parse(n)}catch(e){Object(c.c)("Error parsing telemetry data on citation click",e.message)}s.telemetryLoggerUtils.sendTelemetryChatEventData([{key:b.g.ChatEventType,value:b.f.CitationClicked},{key:b.g.UserQueryGuid,value:r.correlationId||""}]);var o={referencePath:t.length>0?t:s.citationPathDataIndexMap.get(e),workflowAnnotationType:u.b.getTypeName()};s.copilotCommunicationHandler.sendEventToClient(h.c.CitationLinkClicked,o)},this.sendBasicChatSuggestionPillsEvent=function(e){var t={suggestionPills:e,workflowAnnotationType:u.b.getTypeName()};s.copilotCommunicationHandler.sendEventToClient(h.c.BasicChatSuggestionPills,t)},this.getMarkdownReferences=function(e){return void 0===e||e&&0===e.length||!s.basicChatProps.isCitationsEnabled?[]:(s.citationPathDataIndexMap.clear(),e.map((function(e){var t,n,o;s.citationPathDataIndexMap.set(e.contentIndex,e.path),e.content&&e.content.length>150&&(e.content=e.content.substring(0,150).trim()+"...");var i='"'+e.content.slice(0,18).trim()+'..."';return e.content='"'+e.content+'"',{referenceIndex:e.contentIndex,referenceProps:{title:i,primarySubtitle:null===(t=s.basicChatProps)||void 0===t?void 0:t.citationTitle,snippet:e.content,iconAppName:e.type,referenceType:r.a.Internal,citationPosition:e.position,onClickCitationLink:s.onClickCitationLink,sensitivityLabel:null===(o=null===(n=s.basicChatProps)||void 0===n?void 0:n.sensitivityIndicatorData)||void 0===o?void 0:o.badgeText,path:e.path}}})))},this.updateCardWithFooter=function(){var t,n;s.chatContainerBuilder.updateLastMessage(o.a.MarkdownCard,void 0,{feedbackSectionPosition:i.a.Footer,showAnimation:!0,actionButtonList:[s.getCopyButton()],clpSensitivityIndicatorData:null!==(n=null===(t=e.getInstance().getBasicChatProps())||void 0===t?void 0:t.sensitivityIndicatorData)&&void 0!==n?n:void 0},!0)},this.sendBasicChatProcessingEvent=function(e){s.copilotCommunicationHandler.sendEventToClient(h.c.BasicChatStatus,e)},this.getFeedbackData=function(){var e=s.copilotCommunicationHandler.getFeedbackData(),t=s.featureName;return e&&!e.feedbackArea&&(e={feedbackArea:t===b.i.Draft?g.i.DRAFT:g.i.BASIC_CHAT,contextData:{cardMetaData:JSON.stringify({prompt:C.h,promptId:s.queryID}),sydneyContextData:{conversationId:I.a.Instance.ConversationId,sydneyEndpoint:I.a.Instance.SydneyEndpoint,requestId:I.a.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:I.a.Instance.CurrentUserMessageId},feedbackContextData:{prompt:C.h,promptId:s.queryID},groundingSource:Object(x.a)(),entryPoint:"Chat"}}),e},this.handleTimeoutForBasicChatStreaming=function(){var t=s.getFeatureName();s.isFirstStreamChunk||(s.paragraphChunks.length>0&&(s.updateCardWithFooter(),s.resetBasicChatStreamingStates(!1)),s.isAnswerCompleted||s.chatContainerBuilder.setChatMessageData(o.a.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:p.b}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:i.a.Footer,isFailure:!0,showAnimation:!1,feedbackData:s.getFeedbackData(),telemetryData:JSON.stringify({correlationId:e.getInstance().getQueryID(),featureName:e.getInstance().getFeatureName()})},!0),s.setIsExecuting(!1)),s.sendBasicChatProcessingEvent({status:h.b.Finished,workflowAnnotationType:u.b.getTypeName(),queryID:s.queryID,isSuccess:!1}),s.telemetryLoggerUtils.sendTelemetryChatEventData([{key:b.g.ChatEventType,value:b.f.BasicChatStreamingResponseTimeout},{key:b.g.UserQueryGuid,value:s.queryID},{key:b.g.ChatErrorType,value:b.e.Server}]),s.telemetryLoggerUtils.logErrorWithAshaVetoAndError([{key:b.q,value:s.queryID}],t,"",b.c.BasicChatResponseTimedOut,b.a.Timeout),s.resetBasicChatStreamingStates(!1)},this.sendLoggingEventToClient=function(e,t){s.loggingEventHandler.sendLoggingEventToClient(e,t)},this.getIsFirstStreamChunk=function(){return s.isFirstStreamChunk},this.setIsFirstStreamChunk=function(e){s.isFirstStreamChunk=e},this.getParagraphChunks=function(){return s.paragraphChunks},this.setParagraphChunks=function(e){s.paragraphChunks=e},this.getIsAnswerCompleted=function(){return s.isAnswerCompleted},this.setIsAnswerCompleted=function(e){s.isAnswerCompleted=e},this.getIsBasicChatStreaming=function(){return s.isBasicChatStreaming},this.setIsBasicChatStreaming=function(e){s.isBasicChatStreaming=e},this.setQueryID=function(e){s.queryID=e},this.setFeatureName=function(e){s.featureName=e},this.getFeatureName=function(){return s.featureName},this.getQueryID=function(){return s.queryID},this.setBasicChatProps=function(e){s.basicChatProps=e},this.getIsFluxFlowEnabled=function(){var e;return null===(e=s.basicChatProps)||void 0===e?void 0:e.isFluxFlowEnabled},this.updateStreamChunks=function(e){s.streamChunks.push(e)},this.getStreamChunks=function(){return s.streamChunks},this.getBasicChatProps=function(){return s.basicChatProps},this.getSuggestedQnaSignalSubmitTime=function(){return s.suggestedQnaSignalSubmitTime},this.getSuggestedQnaScenarioSignalOperation=function(){var e={isBasicChat:!0,chatHistory:[],isStreaming:!0,queryId:Object(O.a)(),userLanguage:Object(m.b)(E.a.getLanguage()),isSuggestedQnAScenario:!0},t=new f.b({parentPath:["Signal",d.a.getTypeName()],items:[{id:S.a.generateId(),body:new d.a(e)}]});return s.telemetryLoggerUtils.sendTelemetryChatEventData([{key:b.g.ChatEventType,value:b.f.BasicChatOperationSubmitted},{key:b.g.UserQueryGuid,value:e.queryId}]),s.suggestedQnaSignalSubmitTime=(new Date).getTime(),t},this.resetBasicChatStreamingStates=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),s.streamChunks.length>0&&(s.telemetryLoggerUtils.sendTelemetryLatencyData([{key:b.k.QnAResponseTime,value:Object(C.c)(C.d)},{key:b.k.IsQuerySuccess,value:e},{key:b.k.QnAChunkInfo,value:JSON.stringify(s.getStreamChunks())},{key:b.k.UserQueryGuid,value:s.queryID},{key:b.k.AnnotationType,value:u.b.getTypeName()}],t),e&&s.telemetryLoggerUtils.sendTelemetryChatEventData([{key:b.g.ChatEventType,value:b.f.QuerySuccessful},{key:b.g.UserQueryGuid,value:s.queryID},{key:b.g.ChatEventParameters,value:u.b.getTypeName()}])),s.setIsFirstStreamChunk(!0),s.setParagraphChunks(p.w),s.setIsAnswerCompleted(!1),s.setIsBasicChatStreaming(!1),s.setQueryID(p.w),s.telemetryLoggerUtils.setUserQueryGuid(p.w),s.streamChunks=[],s.featureName=b.i.ChatQnA},this.chatContainerBuilder=t,this.copilotCommunicationHandler=n,this.setIsExecuting=a,this.loggingEventHandler=v.a.getInstance(),this.telemetryLoggerUtils=y.a.getInstance()}return e.getInstance=function(t,n,r){if(!e.instance){if(!t||!r||!n)throw new Error("BasicChat Utils is not initialized");e.instance=new e(t,n,r)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.getCopyButton=function(){return{type:a.b.Default,title:Object(p.W)(),text:Object(s.c)()?"":Object(p.W)(),iconRegular:Object(s.c)()?l.e:l.c,popoverProps:{popoverTitle:Object(p.X)()},position:Object(s.c)()?a.a.FeedbackSection:a.a.ActionButtonBar,handleButtonOnClick:m.c}},e}()},133:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},1337:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.doPseudoLocalization=t.disableDevModeForLocalization=t.enableDevModeForLocalization=t.enablePseudoLocalization=t.disablePseudoLocalization=t.togglePseudoLocalization=t.isTest=t.isDevLocalization=t.skipLocalization=t.isDev=void 0;var n=!1,r=!1;function o(){return"undefined"!=typeof __DEV__&&__DEV__&&!r}function i(){return"undefined"!=typeof __SKIP_LOC__&&__SKIP_LOC__}t.isDev=o,t.skipLocalization=i,t.isDevLocalization=function(){return o()||i()},t.isTest=function(){return Boolean(void 0!==e&&e.env&&!1)},t.togglePseudoLocalization=function(){n=!n},t.disablePseudoLocalization=function(){n=!0},t.enablePseudoLocalization=function(){n=!1},t.enableDevModeForLocalization=function(){r=!1},t.disableDevModeForLocalization=function(){r=!0},t.doPseudoLocalization=function(){return!("undefined"==typeof __DEV__||!__DEV__||r)&&!("undefined"!=typeof __DISABLE_PSEUDO_LOC__&&__DISABLE_PSEUDO_LOC__||n)}}).call(this,n(198))},135:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(r||(r={}));var o=r.web,i=function(e){o=e},a=function(){return o};function s(){return o===r.IOS}var l=function(){return o===r.MACOS}},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"x",(function(){return p})),n.d(t,"v",(function(){return g})),n.d(t,"u",(function(){return h})),n.d(t,"t",(function(){return f})),n.d(t,"w",(function(){return m})),n.d(t,"h",(function(){return v})),n.d(t,"y",(function(){return b})),n.d(t,"L",(function(){return y})),n.d(t,"g",(function(){return C})),n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return S})),n.d(t,"s",(function(){return E})),n.d(t,"r",(function(){return x})),n.d(t,"q",(function(){return I})),n.d(t,"p",(function(){return w})),n.d(t,"I",(function(){return T})),n.d(t,"o",(function(){return k})),n.d(t,"i",(function(){return j})),n.d(t,"z",(function(){return P})),n.d(t,"J",(function(){return A})),n.d(t,"K",(function(){return _})),n.d(t,"j",(function(){return D})),n.d(t,"E",(function(){return L})),n.d(t,"C",(function(){return M})),n.d(t,"G",(function(){return B})),n.d(t,"F",(function(){return R})),n.d(t,"D",(function(){return F})),n.d(t,"A",(function(){return N})),n.d(t,"H",(function(){return H})),n.d(t,"B",(function(){return U}));var r=n(64),o=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatCardFooterDisclaimer:"AI-generated content may be incorrect"},i=function(){return Object(r.m)()?OfficeaicopilotStrings.AIGenerated:"AI generated"},a=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatCardFooterDisclaimerPowered:"AI-powered suggestions may be inaccurate"},s=function(){return Object(r.m)()?OfficeaicopilotStrings.AIPowered:"AI-powered suggestion"},l=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContent:"Please help us learn and train our models by providing feedback through the thumbs up & down controls for each output the LLM generates."},c=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContentTitle:"Feedback Nudge Content"},u=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeader:"Provide feedback"},d=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeaderTitle:"MICROSOFT INTERNAL ONLY"},p=function(){return Object(r.m)()?OfficeaicopilotStrings.ProactiveSuggestionTitleText:"Highlight Data"},g=function(){return Object(r.m)()?OfficeaicopilotStrings.ProactiveSuggestionIconText:"Idea"},h=function(){return Object(r.m)()?OfficeaicopilotStrings.ProactiveSuggestionBodyText:"For a more engaging presentation, here’s a design that might better highlight the stats in your slide."},f=function(){return Object(r.m)()?OfficeaicopilotStrings.ProactiveSuggestionApplyBtnText:"Apply"},m=function(){return Object(r.m)()?OfficeaicopilotStrings.ProactiveSuggestionImageAltText:"proactive suggestion card img"},v=function(){return"Applying updates to following matches"},b=function(){return"Remove"},y=function(){return"Waiting to apply updates"},C=function(){return"Apply Updates"},O=function(){return"Apply"},S=function(){return"Apply All"},E=function(){return"Previous"},x=function(){return"Next"},I=function(){return"No results found for the search"},w=function(){return"Locate"},T=function(){return Object(r.m)()?OfficeaicopilotStrings.ShowMeButtonText:"Show Me"},k="Help",j=function(){return"Comments Summary"},P=function(){return"Suggestion"},A=function(){return"the line"},_="1.0",D=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm,L=function(){return"Sure, I suggest continuing with Reviewer agent:"},M=function(){return"Add Details"},B=function(){return"Start Review"},R=function(){return"Reviewer"},F=function(){return"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments."},N=function(){return"Confirm Invitation"},H=function(){return"Invitation Sent"},U=function(){return"Review Details"}},142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=t.stringExists=t.setLocalizationErrorHandler=t.setCurrentLocale=t.lookUpString=t.getCurrentLocale=t.flattenStringMap=t.clearStringMapLoaders=t.addStringMapLoader=t.addStringMap=t.makeGetStringMapLoader=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithOnlyKey=t.togglePseudoLocalization=t.isDevLocalization=t.isDev=t.enablePseudoLocalization=t.enableDevModeForLocalization=t.disablePseudoLocalization=t.disableDevModeForLocalization=t.setLocalizationErrorHandlerForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.lookupStringInDefaultStringProvider=t.getDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.lookupStringInStringProvider=t.declareStringWithPlaceholders=t.declareString=t.mapStringsWithPlaceholdersToStandardFormat=t.mapStringsToStandardFormat=t.declarePluralStringWithPlaceholders=t.declarePluralString=void 0;var r=n(2691);Object.defineProperty(t,"declarePluralString",{enumerable:!0,get:function(){return r.declarePluralString}}),Object.defineProperty(t,"declarePluralStringWithPlaceholders",{enumerable:!0,get:function(){return r.declarePluralStringWithPlaceholders}}),Object.defineProperty(t,"mapStringsToStandardFormat",{enumerable:!0,get:function(){return r.mapStringsToStandardFormat}}),Object.defineProperty(t,"mapStringsWithPlaceholdersToStandardFormat",{enumerable:!0,get:function(){return r.mapStringsWithPlaceholdersToStandardFormat}});var o=n(2090);Object.defineProperty(t,"declareString",{enumerable:!0,get:function(){return o.declareString}}),Object.defineProperty(t,"declareStringWithPlaceholders",{enumerable:!0,get:function(){return o.declareStringWithPlaceholders}}),Object.defineProperty(t,"lookupStringInStringProvider",{enumerable:!0,get:function(){return o.lookupStringInStringProvider}});var i=n(1746);Object.defineProperty(t,"addStringMapForDefaultStringProvider",{enumerable:!0,get:function(){return i.addStringMapForDefaultStringProvider}}),Object.defineProperty(t,"addStringMapLoaderForDefaultStringProvider",{enumerable:!0,get:function(){return i.addStringMapLoaderForDefaultStringProvider}}),Object.defineProperty(t,"clearStringMapLoadersForDefaultStringProvider",{enumerable:!0,get:function(){return i.clearStringMapLoadersForDefaultStringProvider}}),Object.defineProperty(t,"getCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return i.getCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"getDefaultStringProvider",{enumerable:!0,get:function(){return i.getDefaultStringProvider}}),Object.defineProperty(t,"lookupStringInDefaultStringProvider",{enumerable:!0,get:function(){return i.lookupStringInDefaultStringProvider}}),Object.defineProperty(t,"setCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return i.setCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"setLocalizationErrorHandlerForDefaultStringProvider",{enumerable:!0,get:function(){return i.setLocalizationErrorHandlerForDefaultStringProvider}});var a=n(1337);Object.defineProperty(t,"disableDevModeForLocalization",{enumerable:!0,get:function(){return a.disableDevModeForLocalization}}),Object.defineProperty(t,"disablePseudoLocalization",{enumerable:!0,get:function(){return a.disablePseudoLocalization}}),Object.defineProperty(t,"enableDevModeForLocalization",{enumerable:!0,get:function(){return a.enableDevModeForLocalization}}),Object.defineProperty(t,"enablePseudoLocalization",{enumerable:!0,get:function(){return a.enablePseudoLocalization}}),Object.defineProperty(t,"isDev",{enumerable:!0,get:function(){return a.isDev}}),Object.defineProperty(t,"isDevLocalization",{enumerable:!0,get:function(){return a.isDevLocalization}}),Object.defineProperty(t,"togglePseudoLocalization",{enumerable:!0,get:function(){return a.togglePseudoLocalization}});var s=n(1747);Object.defineProperty(t,"getStringDescriptionWithOnlyKey",{enumerable:!0,get:function(){return s.getStringDescriptionWithOnlyKey}}),Object.defineProperty(t,"getStringDescriptionWithPlaceholders",{enumerable:!0,get:function(){return s.getStringDescriptionWithPlaceholders}}),Object.defineProperty(t,"getStringDescriptionWithoutPlaceholders",{enumerable:!0,get:function(){return s.getStringDescriptionWithoutPlaceholders}});var l=n(2693);Object.defineProperty(t,"makeGetStringMapLoader",{enumerable:!0,get:function(){return l.makeGetStringMapLoader}});var c=n(1522);Object.defineProperty(t,"addStringMap",{enumerable:!0,get:function(){return c.addStringMap}}),Object.defineProperty(t,"addStringMapLoader",{enumerable:!0,get:function(){return c.addStringMapLoader}}),Object.defineProperty(t,"clearStringMapLoaders",{enumerable:!0,get:function(){return c.clearStringMapLoaders}}),Object.defineProperty(t,"flattenStringMap",{enumerable:!0,get:function(){return c.flattenStringMap}}),Object.defineProperty(t,"getCurrentLocale",{enumerable:!0,get:function(){return c.getCurrentLocale}}),Object.defineProperty(t,"lookUpString",{enumerable:!0,get:function(){return c.lookUpString}}),Object.defineProperty(t,"setCurrentLocale",{enumerable:!0,get:function(){return c.setCurrentLocale}}),Object.defineProperty(t,"setLocalizationErrorHandler",{enumerable:!0,get:function(){return c.setLocalizationErrorHandler}}),Object.defineProperty(t,"stringExists",{enumerable:!0,get:function(){return c.stringExists}});var u=n(2093);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return u.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return u.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return u.toSupportedLocale}})},143:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),o=new(function(){function e(){this.externalLogger=new r}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}())},144:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(r||(r={}))},1446:function(e,t,n){"use strict";n.r(t),n.d(t,"ChannelService",(function(){return d})),n.d(t,"MosAppService",(function(){return v})),n.d(t,"AppService",(function(){return b.a})),n.d(t,"CardService",(function(){return y.a})),n.d(t,"HttpStatusCode",(function(){return u.a})),n.d(t,"isStageViewActionSubmit",(function(){return C.a})),n.d(t,"isTaskModuleActionSubmit",(function(){return C.b})),n.d(t,"isBrokeredArchitecture",(function(){return O.a}));var r,o=n(2),i=n(2081),a=n(1469),s=n(246),l=n(1811),c=n(2845),u=n(791);class d{constructor(e,t,n,r,o,i){this.tokenService=e,this.hostContext=t,this.telemetryService=o,this.sourceName=i,this.endpointUrl="https://substrate.office.com/search/api/v1/",this.tokenScope="https://substrate.office.com/search",n&&(this.endpointUrl=n),r&&(this.tokenScope=r)}botInvoke(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeRequest),r={};if(!(null===(t=this.hostContext)||void 0===t?void 0:t.locale))throw n.logMetricEndWithError({message:s.d.HostLocaleIsUndefined,diagnosticsData:`RequestName: ${e.requestBody.name}`}),new Error("host locale is undefined");const o=this.processRequest(e),a=`${this.endpointUrl}botinvoke?culture=${this.hostContext.locale}`,u=yield this.getInvokeRequestHeaders(),d=yield Object(i.a)(a,{method:"POST",headers:u,body:JSON.stringify(o)});if(!d.ok)throw n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),d;const p=yield d.json();return r[s.l.HttpStatusCode]=p.statusCode,p.error?(n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Error,value:{errorCode:p.error.httpCode,errorMessage:p.error.message}}):(n.logMetricEnd({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Result,value:p.response})}))}getInvokeRequestHeaders(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const e=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeFetchToken),t=new Headers;t.set("Content-Type","application/json");try{const n=yield this.tokenService.getToken({resource:this.tokenScope});n&&(null==n?void 0:n.authToken)&&t.set("Authorization",`Bearer ${n.authToken}`),e.logMetricEnd()}catch(t){e.logMetricEndWithError({diagnosticsData:`Error: ${null==t?void 0:t.message}`})}return t}))}processRequest(e){var t,n,r,o,i;const s={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(a.generateGuid)(),scenario:{name:this.getScenarioName()}};return e.requestBody.appName&&(s.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(s.request.imdisplayname=e.requestBody.imdisplayname),s}getScenarioName(){return"teamshub"===this.sourceName?u.b.TeamsHubCopilot3sInvoke:"officeweb"===this.sourceName?u.b.OfficeWebCopilot3sInvoke:"owahub"===this.sourceName?u.b.OutlookWebCopilot3sInvoke:"bing"===this.sourceName?u.b.CibCopilot3sInvoke:u.b.M365CardSDK}}class p{static getAndCacheAcquisitions(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o={},i=new c.a(this.telemetryService,s.h.GetAndCacheAcquisition,s.g.GetAndCacheAcquisitionforMOS);try{const a=yield n.getToken({resource:t});let s=new URL("/catalog/v1/users/acquisitions/get",t);const l={method:"POST",headers:{Authorization:`Bearer ${a.authToken}`,Accept:"application/json","Accept-Language":r},body:JSON.stringify({Filter:{supportedElementTypes:["ComposeExtensions"]}})};let c=yield fetch(s.toString(),l);if(c.ok&&200===c.status){const e=(yield c.json()).acquisitions;if(e)return this.createTime=Date.now(),this.cachedAcquisitions=e,e}if(s=new URL("/catalog/v1/users/titles/launchInfo",t),l.body=JSON.stringify({Id:e,Filter:{supportedElementTypes:["ComposeExtensions"]}}),c=yield fetch(s.toString(),l),c.ok&&200===c.status){const e=(yield c.json()).acquisition;if(e)return this.cachedAcquisitions?this.cachedAcquisitions.push(e):(this.cachedAcquisitions=[e],this.createTime=Date.now()),this.cachedAcquisitions}return o.HttpStatusCode=c.status,i.logMetricEnd({props:o}),Promise.reject(`Error while fetching acquisitions: ${c.status}`)}catch(e){return i.logMetricEndWithError({props:o,diagnosticsData:`Error: fetching acquisitions failed, ${null==e?void 0:e.message}`}),Promise.reject(`fetching acquisitions failed, ${null==e?void 0:e.message}`)}}))}static findAcquisitionWithId(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t={},n=new c.a(this.telemetryService,s.h.FindAcquisition,s.g.FindAcquisitionforMOS);if(this.cachedAcquisitions){const r=this.cachedAcquisitions.find((t=>t.appId===e));return n.logMetricEnd({props:t}),Promise.resolve(r)}return n.logMetricEndWithError({props:t,diagnosticsData:"Error: could not find app with id in acquisitions"}),Promise.reject(`couldn't find app with id, ${e}`)}))}}var g;r=p,p.cacheTimeInMs=36e5,p.cachedAcquisitions=void 0,p.createTime=0,p.getAcquisition=(e,t,n,i)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){return Date.now()-r.createTime>r.cacheTimeInMs&&(r.cachedAcquisitions=void 0),r.cachedAcquisitions&&0!=r.cachedAcquisitions.filter((t=>t.appId===e)).length||(yield r.getAndCacheAcquisitions(e,t,n,i)),yield r.findAcquisitionWithId(e)}));const h="https://titles.prod.mos.microsoft.com/config/v1/environment",f=36e5;class m{static getAndCacheUrlFromDiscoveryApi(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.getToken({resource:h});if(n&&n.authToken){const e=new URL(h),r={method:"GET",headers:{Authorization:`Bearer ${n.authToken}`,Accept:"application/json","Accept-Language":t}},o=yield fetch(e.toString(),r);if(o.ok&&200===o.status){const e=yield o.json();return this.cachedServiceUrl=e.titlesServiceUrl,this.cacheTimeInMs=e.cacheTimeInHrs?e.cacheTimeInHrs*f:f,this.createTime=Date.now(),e.titlesServiceUrl}return Promise.reject(`Error while fetching discovery environment info: ${o.status}`)}}catch(e){return Promise.reject(`discovery environment info failed, ${null==e?void 0:e.message}`)}}))}}g=m,m.cacheTimeInMs=0,m.cachedServiceUrl=void 0,m.createTime=0,m.getServiceUrl=(e,t)=>Date.now()-g.createTime<g.cacheTimeInMs&&g.cachedServiceUrl?Promise.resolve(g.cachedServiceUrl):g.getAndCacheUrlFromDiscoveryApi(e,t);class v{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.appPromiseCache={},this.locale=null!=t?t:"en-us"}getApp(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return{titleInfo:yield this.getAppFromMOS3(e.id)}}))}getAppFromMOS3(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.appPromiseCache[e])return this.appPromiseCache[e];const t=new c.a(this.telemetryService,s.h.GetApp,s.g.GetAppFromMOS3),n=(()=>Object(o.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield m.getServiceUrl(this.tokenService,this.locale),r=null!=n?n:"https://titles.prod.mos.microsoft.com",o=yield p.getAcquisition(e,r,this.tokenService,this.locale);return t.logMetricEnd({}),o}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error: getAppDefinition failed, ${null==e?void 0:e.message}`}),Promise.reject(`getAppDefinition failed, ${null==e?void 0:e.message}`)}})))();return this.appPromiseCache[e]=n,n.finally((()=>{delete this.appPromiseCache[e]})),n}))}}var b=n(2082),y=n(2168),C=n(1109),O=n(2084)},1447:function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return T}));var r,o=n(2),i=n(2146),a=n(2113),s=n(2115),l=n(2116),c=n(396),u=n(485);!function(e){e.SessionConnect="SessionConnect",e.SessionDisconnect="SessionDisconnect",e.SessionReconnect="SessionReconnect",e.SessionClose="SessionClose",e.SessionReConnectFailed="SessionReConnectFailed"}(r||(r={}));var d,p=3e3,g=n(452),h=n(1152);!function(e){e[e.ReadyToConnect=0]="ReadyToConnect",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(d||(d={}));var f,m,v=10,b=d.ReadyToConnect,y=Object(u.a)(),C=Object(u.a)(),O=!1,S=function(){return null!=m?m:""},E=new c.EventEmitter;function x(e,t,n){var a=i.a.getAugLoopRuntimeManager();a.setRequestAuthTokenCallback({requestAuthTokenCallback:function(t){return e.getAuthToken?e.getAuthToken():Promise.resolve(e.authToken)}}),0==O&&(O=!0);var c={serviceUrl:e.serviceUrl,appName:e.appName,appVersion:e.appVersion,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseFork:e.releaseFork,sessionId:t,initSession:!0,flights:e.flights,sessionCreationOptions:{docSessionId:C,onSessionConnect:function(e,t,n,i){E.emit(r.SessionConnect),m=t.substring(t.lastIndexOf("/")+1),Object(g.a)("In AL Session onSessionConnect, isSeedingRequired: ".concat(e,", docSessionId: ").concat(C,", sessionKey: ").concat(S())),e&&function(e){Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.getSession()];case 1:return t=r.sent(),n=new s.a({parentPath:["session"],items:[{id:"doc",body:new l.a({isReadonly:!1})}]}),t.submitSeedOperations([n]),[2]}}))}))}(a)},onSessionDisconnect:function(e){Object(g.a)("In AL Session onSessionDisconnect"),E.emit(r.SessionDisconnect)},onSessionReconnect:function(){Object(g.a)("In AL Session onSessionReconnect"),E.emit(r.SessionReconnect)},onSessionClose:function(e){Object(g.a)("In AL Session onSessionClose"),E.emit(r.SessionClose);try{Object(g.a)("In AL Session onSessionClose: starting new session"),a.startNewSession()}catch(e){Object(g.a)("In AL Session onSessionClose: error in starting new session"),E.emit(r.SessionReConnectFailed);var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw new Error("Failure in starting new AL Session onSessionClose: ".concat(t))}}}};Object(g.a)("docSessionId: ".concat(C)),a.initialize(c)}function I(e){b==d.ReadyToConnect&&(b=d.Connecting,f=e,k().on(r.SessionConnect,(function(){0,b=d.Connected})),k().on(r.SessionDisconnect,(function(){b=d.ReadyToConnect})),k().on(r.SessionClose,(function(){b=d.ReadyToConnect})),k().on(r.SessionReconnect,(function(){0,b=d.Connected})),k().on(r.SessionReConnectFailed,(function(){b=d.ReadyToConnect})),x(e,y,0))}function w(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.getAugLoopRuntimeManager().getSession()];case 1:return e=t.sent(),Object(g.a)("Augloop session: isClosed: ".concat(e.isClosed,", hasConnected: ").concat(e.hasConnected,", isConnected: ").concat(e.isConnected," ")),e.hasConnected&&!e.isConnected&&(e.isClosed?Object(g.a)("Augloop connection is closed"):(Object(g.a)("Sending KeepAlive..."),e.submitCustomMessage(new a.h).then((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(g.a)("KeepAlive succeeded")})).catch((function(e){var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw Object(g.a)("KeepAlive failed: ".concat(t)),new Error("Failure in KeepAlive: ".concat(t))})))),[2,Object(h.a)((function(){return b==d.Connected?Promise.resolve():Promise.reject("Augloop connection not established. hasConnected: ".concat(e.hasConnected,", isConnected: ").concat(e.isConnected,", isClosed: ").concat(e.isClosed))}),v,p).catch((function(e){throw b=d.ReadyToConnect,e}))]}}))}))}function T(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:if(b!=d.ReadyToConnect||null==f.serviceUrl)return[3,4];b=d.Connecting,x(f,y,0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,w()];case 2:return r.sent(),[3,4];case 3:throw e=r.sent(),t=e instanceof Error&&null!=e.message?e.message:"Unknown error",Object(g.a)("".concat(t)),e;case 4:if(null==(n=i.a.getAugLoopRuntimeManager()))throw new Error("Augloop runtime manager is not initialized");return[2,n]}}))}))}function k(){return E}},1448:function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return T}));var r,o=n(2),i=n(2146),a=n(2113),s=n(2115),l=n(2116),c=n(396),u=n(485);!function(e){e.SessionConnect="SessionConnect",e.SessionDisconnect="SessionDisconnect",e.SessionReconnect="SessionReconnect",e.SessionClose="SessionClose",e.SessionReConnectFailed="SessionReConnectFailed"}(r||(r={}));var d,p=3e3,g=n(453),h=n(1154);!function(e){e[e.ReadyToConnect=0]="ReadyToConnect",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(d||(d={}));var f,m,v=10,b=d.ReadyToConnect,y=Object(u.a)(),C=Object(u.a)(),O=!1,S=function(){return null!=m?m:""},E=new c.EventEmitter;function x(e,t,n){var a=i.a.getAugLoopRuntimeManager();a.setRequestAuthTokenCallback({requestAuthTokenCallback:function(t){return Promise.resolve(e.authToken)}}),0==O&&(O=!0);var c={serviceUrl:e.serviceUrl,appName:e.appName,appVersion:e.appVersion,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseFork:e.releaseFork,sessionId:t,initSession:!0,flights:e.flights,sessionCreationOptions:{docSessionId:C,onSessionConnect:function(e,t,n,i){E.emit(r.SessionConnect),m=t.substring(t.lastIndexOf("/")+1),Object(g.a)("In AL Session onSessionConnect, isSeedingRequired: ".concat(e,", docSessionId: ").concat(C,", sessionKey: ").concat(S())),e&&function(e){Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.getSession()];case 1:return t=r.sent(),n=new s.a({parentPath:["session"],items:[{id:"doc",body:new l.a({isReadonly:!1})}]}),t.submitSeedOperations([n]),[2]}}))}))}(a)},onSessionDisconnect:function(e){Object(g.a)("In AL Session onSessionDisconnect"),E.emit(r.SessionDisconnect)},onSessionReconnect:function(){Object(g.a)("In AL Session onSessionReconnect"),E.emit(r.SessionReconnect)},onSessionClose:function(e){Object(g.a)("In AL Session onSessionClose"),E.emit(r.SessionClose);try{Object(g.a)("In AL Session onSessionClose: starting new session"),a.startNewSession()}catch(e){Object(g.a)("In AL Session onSessionClose: error in starting new session"),E.emit(r.SessionReConnectFailed);var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw new Error("Failure in starting new AL Session onSessionClose: ".concat(t))}}}};Object(g.a)("docSessionId: ".concat(C)),a.initialize(c)}function I(e){b==d.ReadyToConnect&&(b=d.Connecting,f=e,k().on(r.SessionConnect,(function(){0,b=d.Connected})),k().on(r.SessionDisconnect,(function(){b=d.ReadyToConnect})),k().on(r.SessionClose,(function(){b=d.ReadyToConnect})),k().on(r.SessionReconnect,(function(){0,b=d.Connected})),k().on(r.SessionReConnectFailed,(function(){b=d.ReadyToConnect})),x(e,y,0))}function w(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.getAugLoopRuntimeManager().getSession()];case 1:return e=t.sent(),Object(g.a)("Augloop session: isClosed: ".concat(e.isClosed,", hasConnected: ").concat(e.hasConnected,", isConnected: ").concat(e.isConnected," ")),e.hasConnected&&!e.isConnected&&(e.isClosed?Object(g.a)("Augloop connection is closed"):(Object(g.a)("Sending KeepAlive..."),e.submitCustomMessage(new a.h).then((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(g.a)("KeepAlive succeeded")})).catch((function(e){var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw Object(g.a)("KeepAlive failed: ".concat(t)),new Error("Failure in KeepAlive: ".concat(t))})))),[2,Object(h.a)((function(){return b==d.Connected?Promise.resolve():Promise.reject("Augloop connection not established. hasConnected: ".concat(e.hasConnected,", isConnected: ").concat(e.isConnected,", isClosed: ").concat(e.isClosed))}),v,p).catch((function(e){throw b=d.ReadyToConnect,e}))]}}))}))}function T(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:if(b!=d.ReadyToConnect||null==f.serviceUrl)return[3,4];b=d.Connecting,x(f,y,0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,w()];case 2:return r.sent(),[3,4];case 3:throw e=r.sent(),t=e instanceof Error&&null!=e.message?e.message:"Unknown error",Object(g.a)("".concat(t)),e;case 4:if(null==(n=i.a.getAugLoopRuntimeManager()))throw new Error("Augloop runtime manager is not initialized");return[2,n]}}))}))}function k(){return E}},1449:function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return T}));var r,o=n(2),i=n(2146),a=n(2113),s=n(2115),l=n(2116),c=n(396),u=n(485);!function(e){e.SessionConnect="SessionConnect",e.SessionDisconnect="SessionDisconnect",e.SessionReconnect="SessionReconnect",e.SessionClose="SessionClose",e.SessionReConnectFailed="SessionReConnectFailed"}(r||(r={}));var d,p=3e3,g=n(451),h=n(1148);!function(e){e[e.ReadyToConnect=0]="ReadyToConnect",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(d||(d={}));var f,m,v=10,b=d.ReadyToConnect,y=Object(u.a)(),C=Object(u.a)(),O=!1,S=function(){return null!=m?m:""},E=new c.EventEmitter;function x(e,t,n){var a=i.a.getAugLoopRuntimeManager();a.setRequestAuthTokenCallback({requestAuthTokenCallback:function(t){return e.getAuthToken?e.getAuthToken():Promise.resolve(e.authToken)}}),0==O&&(O=!0);var c={serviceUrl:e.serviceUrl,appName:e.appName,appVersion:e.appVersion,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseFork:e.releaseFork,sessionId:t,initSession:!0,flights:e.flights,sessionCreationOptions:{docSessionId:C,onSessionConnect:function(e,t,n,i){E.emit(r.SessionConnect),m=t.substring(t.lastIndexOf("/")+1),Object(g.a)("In AL Session onSessionConnect, isSeedingRequired: ".concat(e,", docSessionId: ").concat(C,", sessionKey: ").concat(S())),e&&function(e){Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.getSession()];case 1:return t=r.sent(),n=new s.a({parentPath:["session"],items:[{id:"doc",body:new l.a({isReadonly:!1})}]}),t.submitSeedOperations([n]),[2]}}))}))}(a)},onSessionDisconnect:function(e){Object(g.a)("In AL Session onSessionDisconnect"),E.emit(r.SessionDisconnect)},onSessionReconnect:function(){Object(g.a)("In AL Session onSessionReconnect"),E.emit(r.SessionReconnect)},onSessionClose:function(e){Object(g.a)("In AL Session onSessionClose"),E.emit(r.SessionClose);try{Object(g.a)("In AL Session onSessionClose: starting new session"),a.startNewSession()}catch(e){Object(g.a)("In AL Session onSessionClose: error in starting new session"),E.emit(r.SessionReConnectFailed);var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw new Error("Failure in starting new AL Session onSessionClose: ".concat(t))}}}};Object(g.a)("docSessionId: ".concat(C)),a.initialize(c)}function I(e){b==d.ReadyToConnect&&(b=d.Connecting,f=e,k().on(r.SessionConnect,(function(){0,b=d.Connected})),k().on(r.SessionDisconnect,(function(){b=d.ReadyToConnect})),k().on(r.SessionClose,(function(){b=d.ReadyToConnect})),k().on(r.SessionReconnect,(function(){0,b=d.Connected})),k().on(r.SessionReConnectFailed,(function(){b=d.ReadyToConnect})),x(e,y,0))}function w(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.getAugLoopRuntimeManager().getSession()];case 1:return e=t.sent(),Object(g.a)("Augloop session: isClosed: ".concat(e.isClosed,", hasConnected: ").concat(e.hasConnected,", isConnected: ").concat(e.isConnected," ")),e.hasConnected&&!e.isConnected&&(e.isClosed?Object(g.a)("Augloop connection is closed"):(Object(g.a)("Sending KeepAlive..."),e.submitCustomMessage(new a.h).then((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(g.a)("KeepAlive succeeded")})).catch((function(e){var t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw Object(g.a)("KeepAlive failed: ".concat(t)),new Error("Failure in KeepAlive: ".concat(t))})))),[2,Object(h.a)((function(){return b==d.Connected?Promise.resolve():Promise.reject("Augloop connection not established. hasConnected: ".concat(e.hasConnected,", isConnected: ").concat(e.isConnected,", isClosed: ").concat(e.isClosed))}),v,p).catch((function(e){throw b=d.ReadyToConnect,e}))]}}))}))}function T(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:if(b!=d.ReadyToConnect||null==f.serviceUrl)return[3,4];b=d.Connecting,x(f,y,0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,w()];case 2:return r.sent(),[3,4];case 3:throw e=r.sent(),t=e instanceof Error&&null!=e.message?e.message:"Unknown error",Object(g.a)("".concat(t)),e;case 4:if(null==(n=i.a.getAugLoopRuntimeManager()))throw new Error("Augloop runtime manager is not initialized");return[2,n]}}))}))}function k(){return E}},1451:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(1),i=n(181),a=n(28),s=n(1157),l=n(188),c=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new s.a(t),t._actionCollection.onShouldDisplayBuiltInOverflowActionButton=function(e){return t.shouldDisplayBuiltInOverflowActionButton(e)},t._actionCollection.onShouldDisplayBuiltInOverflowActionMenu=function(e){return t.shouldDisplayBuiltInOverflowActionMenu(e)},t._actionCollection.onDisplayOverflowActionMenu=function(e,n){t.displayOverflowActionMenu(e,n)},t}return Object(r.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.parseActions(t,n)},t.prototype.parseActions=function(e,t){this._actionCollection.parse(e.actions,t)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRenderActions=function(){var e=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return e?o.createElement(o.Fragment,{key:"actions".concat(this.key)},Object(i.i)(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},a.p.Horizontal,{padding:{},margin:{}}),e):null},t.prototype.getHasExpandedAction=function(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(l.b.maxHeightProperty)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0===this._actionCollection.getActionCount()||t.parent===this&&t.isExpandableInlineElement},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&n.push.apply(n,Object(r.__spreadArray)([],Object(r.__read)(this._actionCollection.getAllInputs(t)),!1)),n},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(this._actionCollection.getResourceInformation()),!1)),t},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);return n||(n=this._actionCollection.getElementById(t)),n},t.prototype.isResponsive=function(){var t=e.prototype.isResponsive.call(this);return t||(t=this._actionCollection.hasResponsiveElements()),t},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),["actions"],!1)},t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[s.a.getActionsPropertyDescriptor(t)],!1)},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(l.b)},1452:function(e,t,n){"use strict";n.r(t),n.d(t,"filterOutNull",(function(){return o}));var r=n(1530);function o(e){return e.filter(r.a)}},1453:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(181),o=n(32),i=n(1454),a=n(1065),s=n(188),l=n(1066),c=n(865),u=n(1455),d=n(354),p=n(1111),g=n(1114),h=n(692),f=n(655),m=n(822);function v(){r.f.defaultElements.register("Container",(function(e){return new s.b})),r.f.defaultElements.register("ActionSet",(function(e){return new i.a}),o.s.v1_2),r.f.defaultElements.register("ColumnSet",(function(e){return new a.a})),r.f.defaultElements.register("Media",(function(e){return new d.a}),o.s.v1_1),r.f.defaultElements.register("RichTextBlock",(function(e){return new p.a}),o.s.v1_2),r.f.defaultElements.register("Table",(function(e){return new h.a}),o.s.v1_5),r.f.defaultElements.register("TextBlock",(function(e){return new f.b})),r.f.defaultElements.register("TextRun",(function(e){return new m.a}),o.s.v1_2),r.f.defaultElements.register("FactSet",(function(e){return new l.a})),r.f.defaultElements.register("ImageSet",(function(e){return new u.a})),r.f.defaultElements.register("Image",(function(e){return new c.a})),r.f.defaultActions.register(g.a.JsonTypeName,(function(e){return new g.a}))}},1454:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=n(32),i=n(28),a=n(181),s=n(1157),l=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new s.a(t),t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"orientation",{get:function(){return this.getValue(t.orientationProperty)},set:function(e){this.setValue(t.orientationProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(e){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.getElementById=function(t){var n=this._actionCollection.getElementById(t);return n||e.prototype.getElementById.call(this,t)},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getActionCount();n++){var r=this.getActionAt(n);r&&t.push(r)}return t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),["actions"],!1)},t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[s.a.getActionsPropertyDescriptor(t)],!1)},t.prototype.isLastElement=function(e){return e.parent===this&&e.isExpandableInlineElement},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new o.e(o.s.v1_1,"orientation",i.p),t}(a.d)},1455:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(1),i=n(28),a=n(32),s=n(1071),l=n(865),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"_images",{get:function(){return this.getValue(t.imagesProperty)},set:function(e){this.setValue(t.imagesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageSize",{get:function(){return this.getValue(t.imageSizeProperty)},set:function(e){this.setValue(t.imageSizeProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t,n;if(this._images.length>0){var a=[];try{for(var s=Object(r.__values)(this._images),l=s.next();!l.done;l=s.next()){var c=l.value;switch(this.imageSize){case i.m.Small:c.size=i.r.Small;break;case i.m.Large:c.size=i.r.Large;break;default:c.size=i.r.Medium}c.maxHeight=this.hostConfig.imageSet.maxImageHeight,a.push(o.createElement(c.Render,{key:c.key}))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"}},a)}return null},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof l.a){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof l.a?this._images.indexOf(e):-1},t.imagesProperty=new a.k(a.s.v1_0,"images",(function(e){return new l.a}),(function(e,t){t.setParent(e)})),t.imageSizeProperty=new a.e(a.s.v1_0,"imageSize",i.m,i.m.Medium),t}(s.a)},1457:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,o=n(2),i=n(0),a=n(1),s=n(181),l=n(28),c=n(161),u=["12","16","20","24","28","32","40","48"],d=((r={})[l.k.xxSmall]="12",r[l.k.xSmall]="16",r[l.k.Small]="20",r[l.k.Standard]="24",r[l.k.Medium]="28",r[l.k.Large]="32",r[l.k.xLarge]="40",r[l.k.xxLarge]="48",r);function p(e){var t="".concat(e,"px");return a.createElement("div",{style:{width:t,height:t}})}var g=function(e){var t=Object(o.__read)(a.useState(m.getIconOrState(e.name,e.iconSize,e.iconStyle)),2),n=t[0],r=t[1];a.useEffect((function(){"notLoaded"===n&&m.getIcon(e.name,e.iconSize,e.iconStyle).then((function(e){r(null!=e?e:"unavailable")}))}),[n,e.name,e.iconSize,e.iconStyle]);var i=d[e.iconSize];switch(n){case"notLoaded":return void 0===e.showPlaceholder||e.showPlaceholder?p(i):null;case"unavailable":return void 0===e.allowFallback||e.allowFallback?s.f.imagePlaceholderRenderer?s.f.imagePlaceholderRenderer({width:i+"px",height:i+"px"}):i?p(i):null:null;default:return a.createElement(n,{style:{color:e.iconColor}})}};function h(e){return"object"==typeof e&&u.every((function(t){return function(e){return null==e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e[t])}))}function f(e,t,n){var r,a,s={};try{for(var l=Object(o.__values)(Object.entries(t)),c=l.next();!c.done;c=l.next()){var u=Object(o.__read)(c.value,2),d=u[0],p=u[1];s[d]=Object(i.a)(e,d,p,{flipInRtl:n})}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return s}var m=function(){function e(){}return e.getIconFromSet=function(e,t,n){return(n===l.l.Regular?e.regular:e.filled)[d[t]]},e.getIcon=function(t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(this._invalidIconNames.has(t))return[2,void 0];if(i="".concat(c.a.fluentIconCdnBasePath).concat(t,"/").concat(t,".json"),a=this._loadedIcons.get(t))return[3,6];o.label=1;case 1:return o.trys.push([1,5,,6]),[4,fetch(i)];case 2:return(s=o.sent()).ok?[4,s.json()]:[3,4];case 3:l=o.sent(),"object"==typeof(u=l)&&h(u.regular)&&h(u.filled)&&(a={regular:f(t,l.regular,l.flipInRtl),filled:f(t,l.filled,l.flipInRtl),flipInRtl:l.flipInRtl},this._loadedIcons.set(t,a)),o.label=4;case 4:return[3,6];case 5:return o.sent(),[3,6];case 6:return a?[2,e.getIconFromSet(a,n,r)]:(this._invalidIconNames.add(t),[2,void 0])}var u}))}))},e.getIconOrState=function(t,n,r){var o;if(this._invalidIconNames.has(t))return"unavailable";var i=this._loadedIcons.get(t);return i?null!==(o=e.getIconFromSet(i,n,r))&&void 0!==o?o:"unavailable":"notLoaded"},e._loadedIcons=new Map,e._invalidIconNames=new Set,e}()},1464:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.Conflict=409]="Conflict",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"}(r||(r={}))},1467:function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}n.r(t),n.d(t,"isGuidNullOrEmpty",(function(){return i})),n.d(t,"isValidGuid",(function(){return a})),n.d(t,"generateGuid",(function(){return s}));var o="00000000-0000-0000-0000-000000000000";function i(e){return!e||e===o}function a(e){return!i(e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function s(){for(var e=r(),t=0,n="",o=0;o<36;o++)switch(o){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[o-t]%4+8).toString(16);break;default:n+=(e[o-t]%16).toString(16)}return n}},1469:function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}n.r(t),n.d(t,"isGuidNullOrEmpty",(function(){return i})),n.d(t,"isValidGuid",(function(){return a})),n.d(t,"generateGuid",(function(){return s}));var o="00000000-0000-0000-0000-000000000000";function i(e){return!e||e===o}function a(e){return!i(e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function s(){for(var e=r(),t=0,n="",o=0;o<36;o++)switch(o){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[o-t]%4+8).toString(16);break;default:n+=(e[o-t]%16).toString(16)}return n}},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"l",(function(){return v})),n.d(t,"e",(function(){return b}));var r=n(2),o=n(675),i=n(161);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=e.className?e.className.split(/\s+/g):[];o.push.apply(o,Object(r.__spreadArray)([],Object(r.__read)(t),!1)),e.className=o.join(" ")}function s(){return{style:{}}}function l(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)}function c(){return"__ac-".concat(i.f.generate())}function u(e,t){return"string"==typeof e?e:t}function d(e,t){return"number"==typeof e?e:t}function p(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t}function g(e,t,n){for(var r=e;r.length<n;)r=t+r;return r}function h(e){var t=/^(\d{4})-(\d{2})-(\d{2})$/.exec(e);if(t&&4===t.length){var n=parseInt(t[1],10),r=parseInt(t[2],10)-1,o=parseInt(t[3],10);return new Date(n,r,o)}}function f(e){var t=e.getFullYear(),n=g((e.getMonth()+1).toString(),"0",2),r=g(e.getDate().toString(),"0",2);return"".concat(t,"-").concat(n,"-").concat(r)}function m(e,t,n){if(!t)return n;var r=Object(o.b)(e,t);return void 0!==r?r:n}function v(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255,r=parseInt(t[2],16),o=parseInt(t[3],16),i=parseInt(t[4],16);return"rgba(".concat(r,",").concat(o,",").concat(i,",").concat(n,")")}}return e}function b(e,t){return void 0===t&&(t={}),Object.entries(t).forEach((function(t){var n=Object(r.__read)(t,2),o=n[0],i=n[1],a=void 0!==i?i.toString():"";e=e.replace(new RegExp("{{".concat(o,"}}"),"g"),a)})),e}},1477:function(e,t,n){"use strict";function r(e,t,n,r){switch(n){case"auth":return{type:"auth",url:i(r),originalInvokeRequest:t};case"config":return{type:"config",url:i(r),originalInvokeRequest:t};case"silentAuth":return{type:"silentAuth",resource:a(r),originalInvokeRequest:t,isSilent:e.isSilent};default:return}}function o(e){return function(e){var t,n,r,o,i;return 200===e.value.statusCode||void 0!==(null===(t=e.value)||void 0===t?void 0:t.task)||"result"===(null===(r=null===(n=e.value)||void 0===n?void 0:n.composeExtension)||void 0===r?void 0:r.type)||"message"===(null===(i=null===(o=e.value)||void 0===o?void 0:o.composeExtension)||void 0===i?void 0:i.type)}(e)?"result":function(e){var t,n;return"config"===e.value.type||"config"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"config":function(e){var t,n;return 401===e.value.statusCode||"auth"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"auth":function(e){var t,n;return 401===e.value.statusCode||"silentAuth"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"silentAuth":void 0}function i(e){var t,n,r,o,i,a,s,l,c;return null!==(a=null===(i=null===(o=null===(r=null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.suggestedActions)||void 0===r?void 0:r.actions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.value)&&void 0!==a?a:null===(c=null===(l=null===(s=e.value)||void 0===s?void 0:s.value)||void 0===l?void 0:l.buttons[0])||void 0===c?void 0:c.value}function a(e){var t,n,r,o,i,a,s,l;return null!==(a=null===(i=null===(o=null===(r=null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.suggestedActions)||void 0===r?void 0:r.actions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.value)&&void 0!==a?a:null===(l=null===(s=e.value)||void 0===s?void 0:s.value)||void 0===l?void 0:l.tokenExchangeResource.uri}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1478:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(256),i=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._capabilities={},t}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var r in t){var i=t[r];if("string"==typeof i)if("*"===i)this.addCapability(r,"*");else{var a=o.j.parse(i,n);(null==a?void 0:a.isValid)&&this.addCapability(r,a)}}},t.prototype.internalToJSON=function(t,n){for(var r in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[r]=this._capabilities[r]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(o.e)},1483:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,o=n(2);try{r=n(1104)}catch(e){}var i=function(){function e(){this.debugLogs=""}return e.initialize=function(){e.debugLogManager||(e.debugLogManager=new e)},e.getInstance=function(){return e.debugLogManager},e.prototype.addLog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r?r.format.apply(r,Object(o.__spreadArray)([],Object(o.__read)(e),!1))+"\n":e.join(" ")+"\n";this.debugLogs+=n},e.prototype.getLogs=function(){return this.debugLogs},e.prototype.resetLogs=function(){this.debugLogs=""},e}()},1484:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){}static getInstance(){return r.instance||(r.instance=new r),r.instance}setALSession(e){this.alSession=e}getALSession(){return this.alSession}}},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);class o{constructor(e,t){this.realTimeConnection=e,this.realTimeConnection.SetErrorCallback(t),this.realTimeConnection.SetAudioBufferCallback((e=>this.OnAudioBufferCallback(e)))}Initialize(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.realTimeConnection.InitializeConnection(e)}))}StartMicrophone(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.StartMicrophone()}))}Pause(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.PauseConnection()}))}Resume(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.ResumeConnection()}))}Close(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.realTimeConnection.PauseConnection(),this.realTimeConnection.CloseConnection()}))}OnAudioBufferCallback(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){console.log("DevLog: OnAudioBufferCallback")}))}}var i=n(1087);class a{static GetInstance(){return null==this.instance&&(this.instance=new o(i.a.GetInstance(),(e=>{}))),this.instance}}},1522:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lookUpString=t.stringExists=t.flattenStringMap=t.clearStringMapLoaders=t.setCurrentLocale=t.getCurrentLocale=t.addStringMapLoader=t.addStringMap=t.handleLocalizationError=t.setLocalizationErrorHandler=void 0;var r=n(2),o=n(1525),i=n(1337);t.setLocalizationErrorHandler=function(e,t){return r.__assign(r.__assign({},t),{errorHandler:e})},t.handleLocalizationError=function(e,t){t.errorHandler(e)};var a,s=(0,o.memoizeFunction)((function(e,t){var n=c(t);return function(t){return Promise.resolve(e===t?n:{})}}));function l(e,t){return-1===t.loaders.indexOf(e)?r.__assign(r.__assign({},t),{loaders:t.loaders.concat(e)}):t}function c(e){var t={};return e&&function e(n,r){for(var i=0,a=(0,o.keys)(r);i<a.length;i++){var s=a[i];if("string"==typeof s){var l=r[s];"string"==typeof l?t[n+s]=l:"object"==typeof l&&e(n+s+".",l)}}}("",e),t}t.addStringMap=function(e,t,n){if(n.currentLocale===e||void 0===n.currentLocale){var o=c(t);return r.__assign(r.__assign({},n),{currentLocale:void 0===n.currentLocale?e:n.currentLocale,strings:r.__assign(r.__assign({},n.strings),o),stringMapInitialized:!0})}return l(s(e,t),n)},t.addStringMapLoader=l,t.getCurrentLocale=function(e){return a?a.then((function(e){return e.currentLocale})):Promise.resolve(e.currentLocale)},t.setCurrentLocale=function(e,t){var n=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,o,i=this;return r.__generator(this,(function(a){switch(a.label){case 0:return n=function(n){return r.__awaiter(i,void 0,void 0,(function(){var o,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,n(e)];case 1:return[2,r.sent()];case 2:return o=r.sent(),i=o.message||"unknown error",t.errorHandler("Async string map loader failed: ".concat(i)),[2,{}];case 3:return[2]}}))}))},o=t.loaders.map(n),[4,Promise.all(o)];case 1:return[2,a.sent().map(c).reduce((function(e,t){return r.__assign(r.__assign({},e),t)}),{})]}}))}))}(e,t).then((function(n){return r.__assign(r.__assign({},t),{strings:n,currentLocale:e,stringMapInitialized:!0})}));return a=a?a.then((function(){return n})):n},t.clearStringMapLoaders=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return a?[4,a]:[3,2];case 1:t.sent(),t.label=2;case 2:return a=void 0,[2,r.__assign(r.__assign({},e),{loaders:[],strings:{},currentLocale:void 0})]}}))}))},t.flattenStringMap=c,t.stringExists=function(e,t){return"string"==typeof t.strings[e]},t.lookUpString=function(e,t){var n=t.strings[e];if(!n||"string"!=typeof n){var r=(0,i.isDev)()||(0,i.isTest)()?e:"";return!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t.strings)?t.errorHandler("Key ".concat(e," does not exist in string map"),{stringsLoaded:!!t.stringMapInitialized}):!t.suppressEmptyStringMapErrors&&t.errorHandler("The current string map is empty. The string is probably resolved too early, at import time. Key: ".concat(e)),r}return n}},1525:function(e,t,n){"use strict";n.r(t),n.d(t,"memoizeFunction",(function(){return m})),n.d(t,"backfillUndefined",(function(){return b})),n.d(t,"countStringOccurrences",(function(){return y})),n.d(t,"filterOutNull",(function(){return C.filterOutNull})),n.d(t,"find",(function(){return O})),n.d(t,"flattenJoin",(function(){return E})),n.d(t,"areEqualNumbers",(function(){return B})),n.d(t,"cacheLatest",(function(){return _})),n.d(t,"createArrayAndFillWith",(function(){return L})),n.d(t,"defaultToEmptyArray",(function(){return w})),n.d(t,"hasOwnProperty",(function(){return A})),n.d(t,"identity",(function(){return M})),n.d(t,"neverGuard",(function(){return R})),n.d(t,"neverGuardDefault",(function(){return F})),n.d(t,"omitEmpty",(function(){return T})),n.d(t,"omitNull",(function(){return k})),n.d(t,"undefinedToNull",(function(){return D})),n.d(t,"updateWith",(function(){return P})),n.d(t,"generateGuid",(function(){return N})),n.d(t,"isDefined",(function(){return H.a})),n.d(t,"isEmpty",(function(){return V})),n.d(t,"isEqualish",(function(){return W})),n.d(t,"isSafeInteger",(function(){return Q.a})),n.d(t,"keys",(function(){return x})),n.d(t,"makeObject",(function(){return q})),n.d(t,"matchAll",(function(){return K})),n.d(t,"memoizeFunctionProperties",(function(){return Z})),n.d(t,"memoizeSelector",(function(){return $})),n.d(t,"merge",(function(){return ee})),n.d(t,"poll",(function(){return te})),n.d(t,"range",(function(){return ne})),n.d(t,"sortObjectBy",(function(){return re})),n.d(t,"endsWith",(function(){return le})),n.d(t,"isString",(function(){return oe})),n.d(t,"lowerFirst",(function(){return ae})),n.d(t,"safeJoinStrings",(function(){return ce})),n.d(t,"startsWith",(function(){return se})),n.d(t,"upperFirst",(function(){return ie})),n.d(t,"throwError",(function(){return ue.throwError})),n.d(t,"uniq",(function(){return pe})),n.d(t,"uniqBy",(function(){return de}));var r,o,i,a=n(2),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},l="undefined"!=typeof console?console:void 0,c={trace:(null!==(r=null==l?void 0:l.trace)&&void 0!==r?r:s).bind(l),warn:(null!==(o=null==l?void 0:l.warn)&&void 0!==o?o:s).bind(l),table:(null!==(i=null==l?void 0:l.table)&&void 0!==i?i:s).bind(l)},u=n(2091),d="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,p=0,g={empty:!0},h={},f="undefined"==typeof WeakMap?null:WeakMap,m=function(e,t){if(void 0===t&&(t=100),!f)return e;var n=v(),r=0,o=p,i=d?new Map:void 0,s=d?new Error("Memoized function defined").stack:"";return function(){for(var l,f,m,b,y=[],C=0;C<arguments.length;C++)y[C]=arguments[C];var O=n;(o!==p||t>0&&r>t)&&(n=v(),r=0,o=p,null==i||i.clear()),O=n;for(var S=function(e){var t=function(e){if(!e)return g;if("object"==typeof e||"function"==typeof e)return e;h[e]||(h[e]={val:e});return h[e]}(y[e]);if(!(null===(l=O.map)||void 0===l?void 0:l.has(t))&&(null===(f=O.map)||void 0===f||f.set(t,v()),d&&i)){var n=null!==(m=i.get(O))&&void 0!==m?m:[],r=n.filter((function(e){return e!==t&&Object(u.a)(e,t)}))[0];if(r){c.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var o=new Error("Indentical argument passed").stack,p=function(e,t){c.table(e),Object.keys(e).forEach((function(n){var r=e[n],o=t[n];r!==o&&Object(u.a)(r,o)&&(c.warn("Duplication present in child prop '".concat(n,"'")),p(r,o))}))};p(r,t),c.warn(o),c.warn(s)}i.set(O,Object(a.__spreadArray)(Object(a.__spreadArray)([],Object(a.__read)(n),!1),[t],!1))}O=null===(b=O.map)||void 0===b?void 0:b.get(t)},E=0;E<y.length;E++)S(E);return O.hasOwnProperty("value")||(O.value=e.apply(void 0,Object(a.__spreadArray)([],Object(a.__read)(y),!1)),r++),O.value}};function v(){return{map:f?new f:null}}function b(e,t){return void 0===e?t:e}function y(e){return e.reduce((function(e,t){var n;return Object(a.__assign)(Object(a.__assign)({},e),((n={})[t]=(e[t]||0)+1,n))}),{})}var C=n(1452);function O(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return r}}var S=n(2167);function E(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(S.a)(Object(C.filterOutNull)(e)).join(",")}function x(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}var I=[];function w(e){return e||I}function T(e){return j(e,(function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)}))}function k(e){return j(e,(function(e){return null!==e}))}function j(e,t){if(null==e)return e;for(var n={},r=0,o=x(e);r<o.length;r++){var i=o[r];t(e[i])&&(n[i]=e[i])}return n}function P(e,t){return Object.assign({},e,t)}function A(e,t){return e.hasOwnProperty(t)}function _(e){var t=void 0;return function(n){if(t&&n===t.arg)return t.result;var r=e(n);return t={arg:n,result:r},r}}function D(e){return void 0===e?null:e}function L(e,t){var n=[];if(e>0&&e<Number.MAX_VALUE)for(var r=0;r<e;r+=1)n.push(t(r));return n}function M(e){return e}function B(e,t,n){return void 0===n&&(n=1e-5),Math.abs(e-t)<n}function R(e){return e}function F(e,t){return t}var N=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},H=n(1530),U=n(2092);function V(e){return Object(U.a)(e)}function z(e){switch(typeof e){case"number":case"string":case"boolean":case"bigint":case"symbol":case"undefined":return!0;default:return!1}}function G(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=""),null===e?null:Object.entries(e).reduce((function(e,r){var o=r[0],i=r[1],a=n?"".concat(n,".").concat(o):o;return Array.isArray(i)?t?i.forEach((function(n,r){var o="".concat(a,".").concat(r);z(n)||null===n?e[o]=n:Object.assign(e,G(n,t,o))})):e[a]=i.map((function(e){return z(e)?e:G(e,t)})):z(i)||null==i?e[a]=i:Object.assign(e,G(i,t,a)),e}),{})}function W(e,t){var n=function(e){var t=G(e,!0);return null===t?null:T(t)},r=n(e),o=n(t);return Object(u.a)(r,o)}var Q=n(2171);function q(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r={};return t.forEach((function(t){return r[t]=e(t)})),r}function K(e,t){var n=[];if(!t.global)throw new Error("regular expression must have the global flag set");var r=null;do{(r=t.exec(e))&&n.push(r)}while(r&&r[0]);return n}var Y=Object.keys;function Z(e){var t,n,r={};try{for(var o=Object(a.__values)(Y(e)),i=o.next();!i.done;i=o.next()){var s=i.value,l=e[s];if("function"==typeof l){var c=l;r[s]=m(c.bind(r))}else r[s]=l}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}var J=Object.keys,X=function(e,t){if(!e||!t||e===t)return e===t;var n=J(e);return n.length===J(t).length&&n.every((function(n){return t.hasOwnProperty(n)&&e[n]===t[n]}))},$=function(e,t){var n,r,o=(n=t,r=[],function(e){var t=void 0;if(r.forEach((function(n){var r=Object(a.__read)(n,2),o=r[0],i=r[1];return X(o,e)&&(t=i)})),t)return t;var o=n(e);return r.unshift([e,o]),r=r.slice(0,25),o}),i=void 0;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=o(e.apply(void 0,Object(a.__spreadArray)([],Object(a.__read)(t),!1)));if(void 0!==i&&i!==r)if(Array.isArray(r)&&Array.isArray(i)){var s=i;if(r.length===s.length&&r.every((function(e,t){return e===s[t]})))return i}else if("object"==typeof r&&"object"==typeof i&&X(i,r))return i;return i=r,r}};function ee(e,t,n){if(0===t.length)return e;if(0===e.length)return t;for(var r=0,o=0,i=[];r<e.length&&o<t.length;)if(1===n(e[r],t[o]))i.push(t[o++]);else i.push(e[r++]);return r===e.length&&i.push.apply(i,t.slice(o)),o===t.length&&i.push.apply(i,e.slice(r)),i}function te(e){return new Promise((function(t,n){!function e(r,o){void 0===o&&(o=0);var i=r.condition,s=r.maxAttempts,l=r.baseIntervalInMs,c=r.additionalIntervalPerAttemptInMs;if(i())return t();if(!(++o<s))return n("".concat(s," attempts exhausted"));var u=Object(a.__assign)(Object(a.__assign)({},r),{baseIntervalInMs:l+(c||0)});setTimeout((function(){return e(u,o)}),l)}(e)}))}function ne(e,t,n){return Object(a.__spreadArray)([],Array(e),!0).map((function(e,r){return(t||0)+r*(n||1)}))}function re(e,t){var n=x(e).sort((function(e,n){return t(e.toString()).localeCompare(t(n.toString()))})),r={};return n.forEach((function(t){r[t]=e[t]})),r}function oe(e){return"string"==typeof e}function ie(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function ae(e){return e.length?e[0].toLowerCase()+e.slice(1):e}function se(e,t){return e.slice(0,t.length)===t}function le(e,t){return e.slice(0-t.length)===t}function ce(e,t){return e.join(t)}var ue=n(1745);function de(e,t){var n=e.map(t);return e.filter((function(e,r){return n.indexOf(t(e))===r}))}function pe(e){return de(e,(function(e){return e}))}},1526:function(e,t,n){"use strict";n.r(t),n.d(t,"ActivityRequestTrigger",(function(){return r.a})),n.d(t,"M365CardContentType",(function(){return r.b})),n.d(t,"BaseHostConfig",(function(){return o})),n.d(t,"SigninAction",(function(){return D})),n.d(t,"M365HostConfig",(function(){return L.a}));var r=n(1741);const o={choiceSetInputValueSeparator:",",supportsInteractivity:!0,fontFamily:"Segoe UI",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#E1E1E1"},fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},fontWeights:{lighter:300,default:400,bolder:500},imageSizes:{small:40,medium:160,large:320},containerStyles:{default:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F8F8F8"},accent:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#EBF6FF"},good:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F1FFF1"},warning:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF8E4"},attention:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF2F3"}},actions:{maxActions:5,spacing:"",buttonSpacing:8,showCard:{actionMode:"Inline",style:"default"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:102},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:8}};var i,a=n(2),s=n(1),l=n(718),c=n(59),u=n(0),d=n(389),p=["12","16","20","24","28","32","40","48"],g=((i={})[c.j.xxSmall]="12",i[c.j.xSmall]="16",i[c.j.Small]="20",i[c.j.Standard]="24",i[c.j.Medium]="28",i[c.j.Large]="32",i[c.j.xLarge]="40",i[c.j.xxLarge]="48",i);function h(e){var t="".concat(e,"px");return s.createElement("div",{style:{width:t,height:t}})}var f=function(e){var t=Object(a.__read)(s.useState(b.getIconOrState(e.name,e.iconSize,e.iconStyle)),2),n=t[0],r=t[1];s.useEffect((function(){"notLoaded"===n&&b.getIcon(e.name,e.iconSize,e.iconStyle).then((function(e){r(null!=e?e:"unavailable")}))}),[n,e.name,e.iconSize,e.iconStyle]);var o=g[e.iconSize];switch(n){case"notLoaded":return void 0===e.showPlaceholder||e.showPlaceholder?h(o):null;case"unavailable":return void 0===e.allowFallback||e.allowFallback?_.imagePlaceholderRenderer?_.imagePlaceholderRenderer({width:o+"px",height:o+"px"}):o?h(o):null:null;default:return s.createElement(n,{style:{color:e.iconColor}})}};function m(e){return"object"==typeof e&&p.every((function(t){return function(e){return null==e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e[t])}))}function v(e,t,n){var r,o,i={};try{for(var s=Object(a.__values)(Object.entries(t)),l=s.next();!l.done;l=s.next()){var c=Object(a.__read)(l.value,2),d=c[0],p=c[1];i[d]=Object(u.a)(e,d,p,{flipInRtl:n})}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}var b=function(){function e(){}return e.getIconFromSet=function(e,t,n){return(n===c.k.Regular?e.regular:e.filled)[g[t]]},e.getIcon=function(t,n,r){return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,i,s,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(this._invalidIconNames.has(t))return[2,void 0];if(o="".concat(d.a.fluentIconCdnBasePath).concat(t,"/").concat(t,".json"),i=this._loadedIcons.get(t))return[3,6];a.label=1;case 1:return a.trys.push([1,5,,6]),[4,fetch(o)];case 2:return(s=a.sent()).ok?[4,s.json()]:[3,4];case 3:l=a.sent(),"object"==typeof(c=l)&&m(c.regular)&&m(c.filled)&&(i={regular:v(t,l.regular,l.flipInRtl),filled:v(t,l.filled,l.flipInRtl),flipInRtl:l.flipInRtl},this._loadedIcons.set(t,i)),a.label=4;case 4:return[3,6];case 5:return a.sent(),[3,6];case 6:return i?[2,e.getIconFromSet(i,n,r)]:(this._invalidIconNames.add(t),[2,void 0])}var c}))}))},e.getIconOrState=function(t,n,r){var o;if(this._invalidIconNames.has(t))return"unavailable";var i=this._loadedIcons.get(t);return i?null!==(o=e.getIconFromSet(i,n,r))&&void 0!==o?o:"unavailable":"notLoaded"},e._loadedIcons=new Map,e._invalidIconNames=new Set,e}(),y=n(1478),C=n(1624),O=n(256),S=n(474),E=n(317),x=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:c.x.Validation,source:e,event:t,message:n})},e}(),I=function(e){function t(){var t=e.apply(this,Object(a.__spreadArray)([],Object(a.__read)(arguments),!1))||this;return t._shouldFallback=!1,t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.actionExecuted=function(e){},t.prototype.getDefaultSerializationContext=function(){return new P},t.prototype.mediaPlaybackStarted=function(e){this.onMediaPlaybackStarted?this.onMediaPlaybackStarted(e):this.parent&&this.parent.mediaPlaybackStarted(e)},t.prototype.getAdditionalPropertyDescriptors=function(e){return[{name:"type",valueType:"string",requiredValue:this.getJsonTypeName(),isArray:!1},{name:"requires",valueType:"object",description:'Keys are capability names and values are versions in the format "1.0" or "*" for any version',isArray:!1}]},t.prototype.getSerializationContext=function(){var e;return null!==(e=this._serializationContext)&&void 0!==e?e:this.getDefaultSerializationContext()},t.prototype.setSerializationContext=function(e){this._serializationContext=e},t.prototype.localizeString=function(e,t){var n;return this.onLocalizeString?n=this.onLocalizeString(e.key,t):this.parent&&(n=this.parent.localizeString(e,t)),void 0===n?Object(E.d)(e.defaultValue,t):n},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(d.a.allowPreProcessingPropertyValues){for(var r=this;r&&!r.onPreProcessPropertyValue;)r=r.parent;if(r&&r.onPreProcessPropertyValue)return r.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.hasAsParent=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,c.w.DuplicateId,S.a.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.isAtTheVeryLeft=function(){return!1},t.prototype.isAtTheVeryRight=function(){return!1},t.prototype.isAtTheVeryTop=function(){return!1},t.prototype.isAtTheVeryBottom=function(){return!1},t.prototype.isDesignMode=function(){return this.hostConfig.designMode},t.prototype.validateProperties=function(){var e=new x;return this.internalValidateProperties(e),e},t.prototype.releaseDOMResources=function(){},t.prototype.updateActionsEnabledState=function(){},t.prototype.updateLayout=function(e){void 0===e&&(e=!1)},t.prototype.renderAnchor=function(e,t){return this.parent?this.parent.renderAnchor(e,t):function(e,t){return s.createElement("a",t,null!=e?e:t.href)}(e,t)},t.prototype.renderImage=function(e,t){return this.parent?this.parent.renderImage(e,t):function(e,t){return s.createElement("img",Object(a.__assign)({},t))}(0,t)},t.prototype.formatDate=function(e){return this.parent?this.parent.formatDate(e):e.toLocaleDateString(void 0,{dateStyle:"long"})},t.prototype.processUrl=function(e){return!!this.parent&&this.parent.processUrl(e)},t.prototype.dataQuery=function(e){return!!this.parent&&this.parent.dataQuery(e)},Object.defineProperty(t.prototype,"groupId",{get:function(){return this._groupId?this._groupId:this.parent?this.parent.groupId:void 0},set:function(e){this._groupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent&&this.parent.isInSubCard},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.idProperty=new O.g(O.k.v1_0,"id"),t.requiresProperty=new O.f(O.k.v1_2,"requires",(function(e){return new y.a}),!1,new y.a),t}(O.h),w=function(e){function t(){var t=e.apply(this,Object(a.__spreadArray)([],Object(a.__read)(arguments),!1))||this;return t.Render=function(e){return t._state=s.useState(0),s.useEffect((function(){return t.mounted(),function(){t._state=void 0,t.unmounted()}}),[]),t.render(e.args)},t}return Object(a.__extends)(t,e),t.prototype.invalidate=function(){this._state&&this._state[1]((function(e){return e+1}))},t.prototype.afterParse=function(){e.prototype.afterParse.call(this),this.invalidate()},t.prototype.propertyChanged=function(t,n){e.prototype.propertyChanged.call(this,t,n),this.invalidate()},t.prototype.mounted=function(){},t.prototype.unmounted=function(){},t.prototype.updateLayout=function(t){void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),this.invalidate()},Object.defineProperty(t.prototype,"hasBeenRendered",{get:function(){return void 0!==this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){},enumerable:!1,configurable:!0}),t}(I);var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];return"string"==typeof r?d.e.parse(r):this.defaultValue},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toString():void 0,void 0,!0)},t.prototype.getDescriptor=function(e){var t=Object(l.a)(c.i),n=Object(a.__spreadArray)([],Object(a.__read)(t),!1);return t.forEach((function(e){n.push("atLeast:".concat(e),"atMost:".concat(e))})),{valueType:"string",values:n,defaultValue:void 0!==this.defaultValue?c.i[this.defaultValue]:void 0,isArray:!1}},t}(O.d),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.getValue(t.spacingProperty)},set:function(e){this.setValue(t.spacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this.getValue(t.separatorProperty)},set:function(e){this.setValue(t.separatorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getValue(t.heightProperty)},set:function(e){this.setValue(t.heightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.getRootElement().updateLayout(),this.elementVisibilityChanged(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.createPlaceholderElement=function(e){var t=this.getEffectiveStyleDefinition(),n=Object(E.i)(t.foregroundColors.default.subtle);return s.createElement("div",{style:{border:"1px dashed "+n,padding:"4px",minHeight:"32px",fontSize:"10px",color:n}},e)},t.prototype.providesDesignModeElement=function(){return!1},t.prototype.getSeparatorColor=function(e){var t=null!=e?e:this.getEffectiveStyleDefinition();return this.separator?d.a.useBorderColorForSeparator?t.borderColor:this.hostConfig.separator.lineColor:void 0},t.prototype.getAttachableProperties=function(t){return Object(a.__spreadArray)(Object(a.__spreadArray)([],Object(a.__read)(e.prototype.getAttachableProperties.call(this,t)),!1),Object(a.__read)(t.getAttachableElementProperties()),!1)},t.prototype.render=function(e){var t=this,n=this.isVisible||this.isDesignMode()?this.internalRender(e):null,r=null,o=!this.parent||this.parent.allowSpaceBetweenElements;if(n&&this.hasVisibleSeparator&&o){var i={padding:{},margin:{}};this.getSeparatorSpacings(i),r=function(e,t,n,r,o){if(t.spacing>0){var i=Object(E.b)();i.className=e.makeCssClassName("ac-".concat(n===c.l.Horizontal?"horizontal":"vertical","-separator")),i["aria-hidden"]=!0,i.style.overflow="hidden",i.style.flex="0 0 auto";var l=t.lineColor?Object(E.i)(t.lineColor):"";return n===c.l.Horizontal?(t.lineThickness?(i.style.paddingTop="".concat(t.spacing/2,"px"),i.style.marginBottom="".concat(t.spacing/2,"px"),i.style.borderBottom="".concat(t.lineThickness,"px solid ").concat(l)):i.style.height="".concat(t.spacing,"px"),i.style.marginLeft=r.margin.left,i.style.marginRight=r.margin.right):t.lineThickness?(i.style.paddingLeft="".concat(t.spacing/2,"px"),i.style.marginRight="".concat(t.spacing/2,"px"),i.style.borderRight="".concat(t.lineThickness,"px solid ").concat(l)):i.style.width="".concat(t.spacing,"px"),s.createElement("div",Object(a.__assign)({},i,{ref:o}))}return null}(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.getSeparatorColor()},this.separatorOrientation,i,this.isDesignMode()?function(e){return t._renderedSeparatorElement=null!=e?e:void 0}:void 0)}if(this.isDesignMode()&&this.isStandalone&&!this.providesDesignModeElement()){var l=Object(a.__assign)({},null==n?void 0:n.props.style);return this.adjustSize(l),s.createElement(s.Fragment,null,r,s.createElement("div",{style:l,ref:function(e){return t._renderedElement=null!=e?e:void 0}},n))}return(null==n?void 0:n.props.style)&&this.adjustSize(n.props.style),s.createElement(s.Fragment,null,r,n)},t.prototype.elementVisibilityChanged=function(e){this.getRootElement().elementVisibilityChanged(e)},t.prototype.adjustSize=function(e){"auto"===this.height?e.flex="0 0 auto":e.flex="1 1 auto"},t.prototype.getSpacings=function(e){},t.prototype.getSeparatorSpacings=function(e){if(this.separatorOrientation===c.l.Horizontal)if(d.a.alwaysBleedSeparators&&!this.isBleeding()){var t=new d.b;this.getImmediateSurroundingPadding(t);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t);e.margin.left=-n.left,e.margin.right=-n.right}else e.margin.right=0,e.margin.left=0},t.prototype.getDefaultPadding=function(){return new d.b},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return c.l.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return c.f.Default},enumerable:!1,configurable:!0}),t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getImmediateSurroundingPadding=function(e,t,n,r,o){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.parent){var i=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),s=r&&this.parent.isBottomElement(this),l=o&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(i&&u.top!==c.p.None&&(e.top=u.top,i=!1),a&&u.right!==c.p.None&&(e.right=u.right,a=!1),s&&u.bottom!==c.p.None&&(e.bottom=u.bottom,s=!1),l&&u.left!==c.p.None&&(e.left=u.left,l=!1)),(i||a||s||l)&&this.parent.getImmediateSurroundingPadding(e,i,a,s,l)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(S.a.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.updateActionsEnabledState=function(){var e,t,n=this.getRootElement().getAllActions();try{for(var r=Object(a.__values)(n),o=r.next();!o.done;o=r.next()){o.value.updateEnabledState()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.indexOf=function(e){return-1},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isResponsive=function(){return void 0!==this.targetWidth},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():c.h.Left},t.prototype.focusFirstFocusableElement=function(){var e,t,n,r,o=this.getAllInputs(!0);try{for(var i=Object(a.__values)(o),s=i.next();!s.done;s=i.next()){if(s.value.focus())return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}var l=this.getAllActions();try{for(var c=Object(a.__values)(l),u=c.next();!u.done;u=c.next()){return!!u.value.focus()}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return!1},t.prototype.shouldRender=function(e){return this.isDesignMode()||this.isVisible&&this.shouldRenderForTargetWidth(e)},t.prototype.shouldRenderForTargetWidth=function(e){var t=null!=e?e:this.hostWidth;return void 0===this.targetWidth||this.targetWidth.matches(t)},t.prototype.removeItem=function(e){return!1},t.prototype.remove=function(){return!!this.parent&&this.parent.removeItem(this)},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowChildContainersToBleed",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostWidth",{get:function(){return void 0!==this._hostWidth?this._hostWidth:this.parent?this.parent.hostWidth:c.i.Wide},set:function(e){this._hostWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:C.b},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme?this._theme:this.parent?this.parent.theme:c.u.Light},set:function(e){this._theme=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return void 0!==this._isEnabled?this._isEnabled:!this.parent||this.parent.isEnabled},set:function(e){this._isEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!this.parent&&(!this.parent.isFirstElement(this)&&this.shouldRender())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedSeparatorElement",{get:function(){return this._renderedSeparatorElement},enumerable:!1,configurable:!0}),t.langProperty=new O.g(O.k.v1_1,"lang",/^[a-z]{2,3}$/gi),t.isVisibleProperty=new O.b(O.k.v1_2,"isVisible",!0),t.separatorProperty=new O.b(O.k.v1_0,"separator",!1),t.heightProperty=new O.i(O.k.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new O.c(O.k.v1_0,"horizontalAlignment",c.h),t.spacingProperty=new O.c(O.k.v1_0,"spacing",c.p,c.p.Default),t.targetWidthProperty=new T(O.k.v1_0,"targetWidth"),t}(w),j=(function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}Object(a.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:["auto","none"],isArray:!1}}}(O.d),function(e){function t(){var t=e.apply(this,Object(a.__spreadArray)([],Object(a.__read)(arguments),!1))||this;return t._isFocusable=!0,t.state=c.b.Normal,t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUrl",{get:function(){return this.getValue(t.iconUrlProperty)},set:function(e){this.setValue(t.iconUrlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.getValue(t.modeProperty)},set:function(e){this.setValue(t.modeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.getValue(t.tooltipProperty)},set:function(e){this.setValue(t.tooltipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.getValue(t.isEnabledProperty)},set:function(e){this.setValue(t.isEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderTitle=function(){var e,t=this._actionButton&&null!==(e=this._actionButton.renderTitle(this.title))&&void 0!==e?e:void 0;if(t)return t;if(this.title){var n=this.hostConfig,r=Object(E.b)();return r.style.overflow="hidden",r.style.textOverflow="ellipsis",n.actions.iconPlacement===c.c.AboveTitle||n.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),s.createElement(s.Fragment,{key:"title"},s.createElement("div",r,this.title))}return null},t.prototype.renderIcon=function(){var e=null;if(this.iconUrl){var t=this.iconUrl.match(/^icon:([\w\d_-]+)(?:,(regular|filled)){0,1}$/i);if(t){if(d.a.enableIconSupportForActionButtons){var n=void 0!==t[2]&&"filled"===t[2].toLowerCase()?c.k.Filled:c.k.Regular;e=s.createElement(f,{name:t[1],iconSize:c.j.Small,iconStyle:n,showPlaceholder:!1,allowFallback:!1})}}else{var r=this.hostConfig,o={style:{}};o.src=this.iconUrl,o.style.width="".concat(r.actions.iconSize,"px"),o.style.height="".concat(r.actions.iconSize,"px"),o.style.flex="0 0 auto",r.actions.iconPlacement!==c.c.AboveTitle&&(o.style.maxHeight="100%"),e=this.renderImage({allowExpand:!1,isSelectable:!1},o)}}return s.createElement(s.Fragment,{key:"icon"},e)},t.prototype.renderButtonContent=function(e,t){void 0===t&&(t=!0);var n,r=this.hostConfig,o=Object(E.b)();switch(o.className="ac-pushButton-content",o.style.display="flex",o.style.gap="6px",o.style.alignItems="center",t&&(o.style.justifyContent="center"),o.style.minWidth="0",this.iconUrl?e?(Object(E.a)(o,"iconOnly"),n=[this.renderIcon()]):(r.actions.iconPlacement===c.c.AboveTitle?(Object(E.a)(o,"iconAbove"),o.style.flexDirection="column"):Object(E.a)(o,"iconLeft"),n=[this.renderIcon(),this.renderTitle()]):(Object(E.a)(o,"noIcon"),n=[this.renderTitle()]),r.actions.actionsOrientation===c.l.Horizontal&&r.actions.actionAlignment===c.a.Stretch?o.style.flex="0 1 100%":o.style.flex="0 1 auto",this.state){case c.b.Normal:break;case c.b.Expanded:Object(E.a)(o,r.makeCssClassName("expanded"));break;case c.b.Subdued:Object(E.a)(o,r.makeCssClassName("subdued"))}return this.style&&this.isEffectivelyEnabled()&&(this.style===c.e.Positive?E.a.apply(void 0,Object(a.__spreadArray)([o],Object(a.__read)(r.makeCssClassNames("primary","style-positive")),!1)):E.a.apply(void 0,Object(a.__spreadArray)([o],Object(a.__read)(r.makeCssClassNames("style-".concat(this.style.toLowerCase()))),!1))),this.isExpandable&&(Object(E.a)(o,this.hostConfig.makeCssClassName("expandable")),o["aria-expanded"]=this.state===c.b.Expanded),s.createElement("div",Object(a.__assign)({},o),n)},t.prototype.getButtonMenuItems=function(){},t.prototype.getAriaControlsAttribute=function(){},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t,n,r=[];if(e)try{for(var o=Object(a.__values)(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=e[i.value];s.validateValue()||r.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.getEffectiveTooltip=function(){return this.tooltip||this.hostConfig.actions.defaultActionTooltip},t.prototype.internalExecute=function(){this._owner&&this._owner.actionExecuted(this),this.prepareForExecution()&&(this.onExecute&&this.onExecute(this),this.getRootObject().actionExecuted(this)),this.internalAfterExecute()},t.prototype.internalAfterExecute=function(){this.getRootObject().updateActionsEnabledState()},t.prototype.render=function(e){var t=this,n={};this.setupElementForAccessibility(n);var r=!!e&&e.isInline,o={forcePrimary:!1,renderedContent:this.renderButtonContent(r),isInline:r,onClick:function(e){t.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.execute())}};return!this._actionButton&&_.actionButtonRenderer&&(this._actionButton=new _.actionButtonRenderer(this,this.getButtonMenuItems())),this._actionButton?this._actionButton.render(n,o):null},Object.defineProperty(t.prototype,"domElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.tabIndex=this.isEffectivelyEnabled()?0:-1,e.role=this.getAriaRole(),this.isEffectivelyEnabled()?n&&Object(E.a)(e,this.hostConfig.makeCssClassName("ac-selectable")):(e.disabled=!0,e["aria-disabled"]=!0),e["aria-label"]=this.title,e["aria-controls"]=this.getAriaControlsAttribute(),e.title=this.title;var r=this.getEffectiveTooltip();r&&(e[t?this.title?"aria-describedby":"aria-label":"aria-describedby"]=r,e.title=r)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new P)},t.prototype.execute=function(e){var t=this;null!=e&&null!=e&&e>0?(this._executeTimer&&clearTimeout(this._executeTimer),this._executeTimer=setTimeout((function(){return t.internalExecute()}),e)):this.internalExecute()},t.prototype.focus=function(){var e;return!(!this._isFocusable||!(null===(e=this._actionButton)||void 0===e?void 0:e.domElement))&&(this._actionButton.domElement.focus(),!0)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1)},t.prototype.collapse=function(){},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.asMenuItem=function(e){var t=this;return{key:e,text:this.title,tooltip:this.getEffectiveTooltip(),disabled:!this.isEffectivelyEnabled(),iconUrl:this.iconUrl,renderedContent:this.renderButtonContent(!1,!1),onClick:function(){t.execute()}}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getElementById=function(e){},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.getInlineContent=function(){},t.prototype.hasResponsiveElements=function(){return!1},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled&&(!this.parent||this.parent.isEnabled)},t.prototype.shouldRaiseOnExecuteEvent=function(){return!0},t.prototype.remove=function(){return!!this._owner&&this._owner.removeAction(this)},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===c.e.Positive},set:function(e){e?this.style=c.e.Positive:this.style===c.e.Positive&&(this.style=c.e.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:C.b},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.parent?this.parent.theme:c.u.Light},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this.state===c.b.Expanded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtRootLevel",{get:function(){var e;return!(null===(e=this.parent)||void 0===e?void 0:e.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.titleProperty=new O.g(O.k.v1_0,"title"),t.iconUrlProperty=new O.g(O.k.v1_1,"iconUrl"),t.styleProperty=new O.i(O.k.v1_2,"style",[{value:c.e.Default},{value:c.e.Positive},{value:c.e.Destructive}],c.e.Default),t.modeProperty=new O.i(O.k.v1_5,"mode",[{value:c.d.Primary},{value:c.d.Secondary}],c.d.Primary),t.tooltipProperty=new O.g(O.k.v1_5,"tooltip"),t.isEnabledProperty=new O.b(O.k.v1_5,"isEnabled",!0),t}(w)),P=function(e){function t(){var t=e.apply(this,Object(a.__spreadArray)([],Object(a.__read)(arguments),!1))||this;return t._forbiddenTypes=new Set,t}return Object(a.__extends)(t,e),t.prototype.internalParseCardObject=function(e,t,n,r,o,i){var a,s=this;if(t&&"object"==typeof t){var l=new Set;this._forbiddenTypes.forEach((function(e){l.add(e)})),n.forEach((function(e){s._forbiddenTypes.add(e)}));var u=Object(E.h)(t.type);if(u)if(this._forbiddenTypes.has(u))i(u,c.v.ForbiddenType);else{var p=!1;if((a=o(u))?(a.setParent(e),a.parse(t,this),p=d.a.enableFallback&&r&&a.shouldFallback()):(p=d.a.enableFallback&&r,i(u,c.v.UnknownType)),p){var g=t.fallback;void 0===g&&e&&e.setShouldFallback(!0),a="string"==typeof g&&"drop"===g.toLowerCase()?void 0:"object"==typeof g?this.internalParseCardObject(e,g,n,!0,o,i):void 0}}this._forbiddenTypes=l}return a},t.prototype.cardObjectParsed=function(e,t){e instanceof j&&this.onParseAction?this.onParseAction(e,t,this):e instanceof k&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof j?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof k)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,r,o,i){var a=new Set(n),s=this.internalParseCardObject(e,t,a,r,o,i);return void 0!==s&&this.cardObjectParsed(s,t),s},t.prototype.parseElement=function(e,n,r,o){var i=this;return this.parseCardObject(e,n,r,o,(function(e){var r=e===t.componentTypeName&&"name"in n&&"string"==typeof n.name?"".concat(e,".").concat(n.name):e;return i.elementRegistry.createInstance({context:i,typeName:r,payload:n,targetVersion:i.targetVersion})}),(function(e,t){t===c.v.UnknownType?i.logParseEvent(void 0,c.w.UnknownElementType,S.a.errors.unknownElementType(e)):i.logParseEvent(void 0,c.w.ElementTypeNotAllowed,S.a.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,r){var o=this;return this.parseCardObject(e,t,n,r,(function(e){return o.actionRegistry.createInstance({context:o,typeName:e,payload:t,targetVersion:o.targetVersion})}),(function(e,t){t===c.v.UnknownType?o.logParseEvent(void 0,c.w.UnknownActionType,S.a.errors.unknownActionType(e)):o.logParseEvent(void 0,c.w.ActionTypeNotAllowed,S.a.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:_.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:_.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t.prototype.getAttachableElementProperties=function(){return this.elementRegistry.getAttachableProperties()},t.prototype.getAttachableElementProperty=function(e){return this.elementRegistry.getAttachableProperty(e)},t.componentTypeName="Component",t}(O.a),A=function(){function e(){this._items={},this._attachableProperties=new Map}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){var t,n,r,o,i=Object.keys(this._items);try{for(var s=Object(a.__values)(i),l=s.next();!l.done;l=s.next()){var c=l.value,u=this._items[c];e.register(u.typeName,u.createInstance,u.schemaVersion)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var d=Object(a.__values)(this._attachableProperties),p=d.next();!p.done;p=d.next()){var g=Object(a.__read)(p.value,2)[1];e.registerAttachableProperty(g)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}},e.prototype.register=function(e,t,n){void 0===n&&(n=O.k.v1_0);var r=this.findByName(e);void 0!==r?r.createInstance=t:r={typeName:e,createInstance:t,schemaVersion:n},this._items[e]=r},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.registerAttachableProperty=function(e){this._attachableProperties.set(e.name,e)},e.prototype.unregisterAttachableProperty=function(e){this._attachableProperties.delete(e)},e.prototype.getAttachableProperty=function(e){return this._attachableProperties.get(e)},e.prototype.getAttachableProperties=function(){return Array.from(this._attachableProperties.values())},e.prototype.createInstance=function(e){var t=this.findByName(e.typeName);return t&&t.schemaVersion.compareTo(e.targetVersion)<=0?t.createInstance(e):void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}(),_=(function(){function e(e,t){this.action=e,this.menuItems=t}e.prototype.renderTitle=function(e){return null}}(),function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new A,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new A,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new A,e.defaultActions=new A,e}());class D extends j{get url(){return this.getValue(D.url)}set url(e){this.setValue(D.url,e)}get data(){return this.getValue(D.data)}set data(e){this.setValue(D.data,e)}getJsonTypeName(){return D.JsonTypeName}getHref(){return this.url}}D.url=new O.g(O.k.v1_0,"url"),D.data=new O.d(O.k.v1_0,"data"),D.JsonTypeName="Action.SignIn";var L=n(2080)},1530:function(e,t,n){"use strict";function r(e){return null!=e}n.d(t,"a",(function(){return r}))},1531:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Automatic="automatic",e.Manual="manual"}(r||(r={})),function(e){e.Error="error",e.HeroCard="application/vnd.microsoft.card.hero",e.ThumbnailCard="application/vnd.microsoft.card.thumbnail",e.ConnectorCard="application/vnd.microsoft.teams.card.o365connector",e.AdaptiveCard="application/vnd.microsoft.card.adaptive",e.SignInCard="signincard",e.AppInstallCard="appinstallcard"}(o||(o={}))},1544:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(143),i=n(144),a=n(133),s=n(894),l=n(472),c=n(1545),u=n(391),d=function(){function e(e){var t=this;this.tileSequence=0,this.releaseAnnotations=function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o.a.sendTraceTag(508151298,i.a.msoulscat_Wac_Dictation,a.a.Info,"Releasing annotation tokens: ".concat(e)),t=e.map((function(e){var t;return o.a.sendTraceTag(508151297,i.a.msoulscat_Wac_Dictation,a.a.Info,"Start to release annotation of: "+e),e?null===(t=n.alSession)||void 0===t?void 0:t.releaseAnnotation(e).catch((function(t){o.a.sendTraceTag(508151296,i.a.msoulscat_Wac_Dictation,a.a.Error,"Failed to release annotation ".concat(e,": ").concat(t.message))})):Promise.resolve()})),[4,Promise.all(t)];case 1:return r.sent(),[2]}}))}))},this.startAudioProcessor=function(e,n,r,c,u){var d=n.dictationLanguage,p=n.useAutoPunctuation,g=n.useCorrections,h=n.useVoiceCommands;o.a.sendTraceTag(508151267,i.a.msoulscat_Wac_Dictation,a.a.Info,"Sending empty warm-up tile, seq: ".concat(t.tileSequence,", dictationLanguage: ").concat(d,", useAutoPunctuation: ").concat(p,", useCorrections: ").concat(g,", useVoiceCommands: ").concat(h,", speechToTextProfile: ").concat(c));var f=new s.b({sampleRate:l.b,useFrontdoorWorkflow:e,seq:t.tileSequence,dictationSettings:n,responseVersion:r,speechToTextProfile:c,commandSet:["warm-up"]});t.submitMicroSync(f,u),t.tileSequence+=1},this.activateAnnotationAsync=function(e,n,s){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,l,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o.a.sendTraceTag(508151266,i.a.msoulscat_Wac_Dictation,a.a.Info,"Start to activate annotations of: "+e),s?[4,null===(c=this.alSession)||void 0===c?void 0:c.activateAnnotation(e,{callback:function(e){n&&n.onAnnotationResult(e)}})]:[3,2];case 1:return l=r.sent(),[3,4];case 2:return[4,null===(u=this.alSession)||void 0===u?void 0:u.activateAnnotation(e)];case 3:l=r.sent(),r.label=4;case 4:return(t=l)||o.a.sendTraceTag(508151265,i.a.msoulscat_Wac_Dictation,a.a.Error,"activateAnnotationAsync: Missing activationResult!"),[2,null==t?void 0:t.token]}}))}))},this.endAudioProcessor=function(e,n,r){o.a.sendTraceTag(508151264,i.a.msoulscat_Wac_Dictation,a.a.Info,"Sending empty tile with endVoiceSession:true, seq: ".concat(t.tileSequence));var c=new s.b({endVoiceSession:!0,sampleRate:l.b,useFrontdoorWorkflow:e,seq:t.tileSequence,dictationSettings:n});t.submitMicroSync(c,r),t.tileSequence+=1},this.submitVoiceTile=function(e,n,r,o,i,a,l,c){void 0===c&&(c=[]);var u=new s.b({sampleRate:n,useFrontdoorWorkflow:r,seq:t.tileSequence,dictationSettings:o,responseVersion:i,data:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),speechToTextProfile:a,commandSet:c});return t.submitMicroSync(u,l),t.tileSequence+=1,u},this.alSession=e}return e.prototype.submitMicroSync=function(e,t){var n,r=new c.a({item:{id:this.tileSequence.toString(),body:e}});null===(n=this.alSession)||void 0===n||n.submitCustomMessage(r).catch((function(e){Object(u.e)(e,t)}))},e}()},1555:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1477);function o(e,t){const n=i(e,t);if(n)return Object.assign(Object.assign({},n),{onActivityCompletion:e.onActivityCompletion})}function i(e,t){if("object"==typeof t){const n=function(e){if("botInvoke"===e.type)return e;if("auth"===e.type||"config"===e.type)return e.originalInvokeRequest;if("silentAuth"===e.type)return e.originalInvokeRequest;throw new Error("Unsupported activity request type")}(e),o=Object(r.b)(t);if(!o)throw new Error("Invalid bot invoke response type");const i=Object(r.a)(e,n,o,t);if(i)return Object.assign({},i)}}},1573:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2870),o=n(1543),i=n(139),a=n(335);const s=Object(r.a)("AuthButton",Object(o.a)({authButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({width:"auto",height:"32px",backgroundColor:i.a.colorNeutralBackground1},a.a.borderRadius("4px")),a.a.borderWidth("1px")),a.a.borderColor(i.a.colorNeutralStroke1)),a.a.gap("4px")),a.a.padding("5px 12px 5px 12px")),errorText:{marginBottom:"12px",lineHeight:"20px"}}))},1574:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(487);async function o(e,t,n){var o,i,a,s,l,c,u,d,p;try{const n={id:e},r=await t.getApp(n),g=null!==(s=null===(a=null===(i=null===(o=r.titleInfo)||void 0===o?void 0:o.titleDefinition)||void 0===i?void 0:i.iconLarge)||void 0===a?void 0:a.uri)&&void 0!==s?s:null===(u=null===(c=null===(l=r.titleInfo)||void 0===l?void 0:l.titleDefinition)||void 0===c?void 0:c.iconSmall)||void 0===u?void 0:u.uri;return{appName:null===(p=null===(d=r.titleInfo)||void 0===d?void 0:d.titleDefinition)||void 0===p?void 0:p.name,appIcon:g}}catch(e){return null==n||n.LogError({type:r.c.LogError,name:r.f.GetAppData,tag:r.h.GetAppData,success:!1,diagnosticsData:`Error while getting app data ${(null==e?void 0:e.message)||e}`}),{appName:void 0,appIcon:void 0}}}},159:function(e,t,n){"use strict";n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return v}));var r=n(2),o=n(64),i=n(323),a=n(239),s=n(171),l=n(17),c=n(52),u=n(697);function d(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function p(e){return null==e}var g=function(){return"undefined"!=typeof OfficeaicopilotStrings},h=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){i.a.getInstance().sendLoggingEventToClient(a.g.CopyButtonClicked,{chatEventParams:"Basic_Chat"}),t={correlationId:"",featureName:""};try{t=JSON.parse(n)}catch(e){Object(c.c)("Error parsing telemetry data on copy click",e.message)}return s.a.getInstance().logKeptEvent([{key:l.q,value:t.correlationId||""}],l.p,t.featureName,Object(u.c)(t.featureName),void 0,Object(u.d)(t.featureName)),s.a.getInstance().sendTelemetryChatEventData([{key:l.g.ChatEventType,value:l.f.CopyButtonClicked},{key:l.g.ChatEventParameters,value:t.featureName||""},{key:l.g.UserQueryGuid,value:t.correlationId||""}]),Object(o.j)(e),[2]}))}))},f=function(e){for(var t,n,o=e.length;0!=o;)n=Math.floor(Math.random()*o),o--,t=Object(r.__read)([e[n],e[o]],2),e[o]=t[0],e[n]=t[1];return e},m=function(e){return void 0===e&&(e="en"),e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e};function v(e){var t=[],n=[];return e.forEach((function(e){e.DisplayCategory&&!n.includes(e.DisplayCategory)&&n.push(e.DisplayCategory)})),n.forEach((function(e){t.push({value:e})})),t}},1593:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),o=n(215),i=n(103),a=n(895),s=n(829),l=n(239),c=n(75),u=n(105),d=n(52),p=n(326),g=n(448),h=n(890),f=n(284),m=function(){function e(e,t,n){var o=this;this.handleThumbsDownClick=function(e,t,n){Object(a.c)(e),o.copilotCommunicationHandler.feedbackButtonClicked(l.f.DISLIKE,e,t,n)},this.handleThumbsUpClick=function(e,t,n){Object(a.c)(e),o.copilotCommunicationHandler.feedbackButtonClicked(l.f.LIKE,e,t,n)},this.addChatMessages=function(e){e.length>0&&o.setChatLog((function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(e),!1)}))},this.getLastMessage=function(e){void 0===e&&(e=!0);var t=o.getChatLog();if(0!==t.length)return t[Object(d.g)(t,e)];Object(d.c)("No chat messages available")},this.clearMessages=function(){o.setChatLog((function(){return[]}))},this.getFeedbackData=function(){var e=o.copilotCommunicationHandler.getFeedbackData();return e&&(null==e?void 0:e.contextData)||(e={feedbackArea:e.feedbackArea,contextData:{cardMetaData:JSON.stringify({prompt:u.h,promptId:u.i}),sydneyContextData:{conversationId:p.a.Instance.ConversationId,sydneyEndpoint:p.a.Instance.SydneyEndpoint,requestId:p.a.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:p.a.Instance.CurrentUserMessageId},feedbackContextData:{prompt:u.h,promptId:u.i},groundingSource:Object(g.a)(),entryPoint:"Chat"}}),e},this.copilotCommunicationHandler=t,this.setChatLog=e,this.chatInputRef=n}var t;return e.convertResponseMessageToChatMessage=function(e,n,o,i,a){var s,l,c;void 0===i&&(i=null),void 0===a&&(a=function(){return!1});try{c=JSON.parse(o.telemetryData)}catch(e){Object(d.c)("Error parsing telemetry data in chat message builder",e.message)}var p={messageType:e,body:t.getChatMessageBody(e,n),feedbackData:o.feedbackData,shouldShowAIGeneratedIndicator:o.shouldShowAIGeneratedIndicator,feedbackSectionPosition:o.feedbackSectionPosition,showMinifiedUI:o.showMinifiedUI,showAnimation:o.showAnimation,actionBarButtons:o.actionButtonList,strikeThroughText:o.strikeThroughText,references:o.references,pillsList:o.pillsList,handlePillOnClick:function(e){var t,n,r;if(!a()&&i){null===(t=i.current)||void 0===t||t.setGhostText("");var s=e.data;null===(n=i.current)||void 0===n||n.setInputText(s),null===(r=i.current)||void 0===r||r.setFocus(),e.isCiq&&setTimeout((function(){var e;return null===(e=i.current)||void 0===e?void 0:e.updateInputText(f.a,h.a.InsertAtCursor)}),1)}o.handlePillOnClick(e)},handleShowMeOnClick:o.handleShowMeOnClick,warningActionButtons:null!==(s=o.warningActionButtons)&&void 0!==s?s:void 0,clpSensitivityIndicatorData:null!==(l=o.clpSensitivityIndicatorData)&&void 0!==l?l:void 0,telemetryData:JSON.stringify(void 0===c?{correlationId:u.i}:Object(r.__assign)(Object(r.__assign)({},c),{correlationId:c.correlationId||u.i})),messageId:o.messageId,msgExtCardProps:o.msgExtCardProps,pluginAuthError:o.pluginAuthError};return p},e.prototype.setChatMessageData=function(e,t,n,i,a){var s=this;void 0===n&&(n={shouldShowAIGeneratedIndicator:!1,showAnimation:!1,feedbackData:this.getFeedbackData(),isFailure:!1,showMinifiedUI:!1,feedbackSectionPosition:o.a.None,aiResponseMetadata:void 0,actionButtonList:void 0,strikeThroughText:!1,references:void 0,pillsList:void 0,handlePillOnClick:void 0,handleShowMeOnClick:void 0,warningActionButtons:void 0,clpSensitivityIndicatorData:void 0,telemetryData:void 0,messageId:void 0,msgExtCardProps:void 0,pluginAuthError:void 0}),void 0===i&&(i=!0),void 0===a&&(a=function(){return!1}),this.setChatLog((function(o){var l=Object(r.__spreadArray)([],Object(r.__read)(o),!1);return s.addChatMessage(l,e,t,n,i,a)}))},e.prototype.getProps=function(e,t){var n,r;return{chatLog:e,shouldShowFeedbackButtons:null===(n=null==t?void 0:t.showFeedbackButtons)||void 0===n||n,handleChatCardThumbsUpClick:this.handleThumbsUpClick,handleChatCardThumbsDownClick:this.handleThumbsDownClick,useFluentAIGeneratedIndicator:null!==(r=null==t?void 0:t.useFluentAIGeneratedIndicator)&&void 0!==r&&r}},e.prototype.updateLastMessage=function(e,t,n,o){var i=this;void 0===o&&(o=!0),this.setChatLog((function(a){var s=Object(r.__spreadArray)([],Object(r.__read)(a),!1),l=Object(d.g)(s);return-1===l?(Object(d.c)("Error: No chat message found to update."),s):i.updateChatMessage(s,e,t,n,o,l)}))},e.prototype.updateMessage=function(e,t,n,o){var i=this;void 0===o&&(o=!0),this.setChatLog((function(a){var s=Object(r.__spreadArray)([],Object(r.__read)(a),!1),l=s.findIndex((function(e){return e.messageId===n.messageId}));return-1===l?(Object(d.c)("chat message is not found with message id : ".concat(n.messageId)),s):i.updateChatMessage(s,e,t,n,o,l)}))},e.prototype.addChatMessage=function(e,n,o,a,l,u){var p;void 0===l&&(l=!0),void 0===u&&(u=function(){return!1});var g=t.convertResponseMessageToChatMessage(n,o,a,this.chatInputRef,u),h=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e),!1),[g],!1);return l&&Object(d.o)()&&n!==i.a.FeedbackNudge&&Object(s.a)(g,Object(s.b)(o,n),(null===(p=g.body)||void 0===p?void 0:p.user)===c.e.Human,a.isFailure,a.aiResponseMetadata),h},e.prototype.updateChatMessage=function(e,n,o,i,a,l){var u;void 0===a&&(a=!0);var p=Object(r.__spreadArray)([],Object(r.__read)(e),!1),g=p.at(l);return g&&(o&&void 0!==(null==g?void 0:g.body)&&(g.body=t.getChatMessageBody(n,o)),i&&Object.entries(i).forEach((function(e){var t=Object(r.__read)(e,2),n=t[0],o=t[1];"actionButtonList"===n?g.actionBarButtons=o:void 0!==o&&(g[n]=o)})),a&&Object(d.o)()&&(o||(o=this.getChatMessageData(g.body,n)),Object(s.a)(g,Object(s.b)(o,n),(null===(u=g.body)||void 0===u?void 0:u.user)===c.e.Human,null==i?void 0:i.isFailure,null==i?void 0:i.aiResponseMetadata))),p},e.prototype.deleteMessage=function(e,t){this.setChatLog((function(n){for(var o=Object(r.__spreadArray)([],Object(r.__read)(n),!1),i=o.length-1;i>=0;i--){var a=o[i];if(a.messageId===t&&a.messageType===e){o.splice(i,1);break}}return o}))},e.prototype.getChatMessageData=function(e,t){var n={};switch(t){case i.a.ContentCard:n.contentCardProps=e;break;case i.a.AccordionCard:n.accordionCardProps=e;break;case i.a.ChatCardWrapper:n.chatCardWrapperProps=e;break;case i.a.SelfHelpAdaptiveCard:n.selfHelpAdaptiveCardProps=e;break;case i.a.StreamingAdaptiveCard:n.streamingAdaptiveCardProps=e;break;case i.a.MarkdownCard:n.markDownCardProps=e;break;case i.a.Designer:n.designerCardProps=e;break;case i.a.WarningMessage:n.warningMessageCardProps=e;break;case i.a.ProactiveSuggestionCard:n.proactiveSuggestionCardProps=e;break;default:n.defaultMessageProps=e}return n},e.prototype.getChatLog=function(){var e=[];return this.setChatLog((function(t){return e=t})),e},t=e,e.getFeedBackNudgeMessageBody=function(e){return{imageSrc:e}},e.getChatMessageBody=function(e,o){var a;switch(e){case i.a.ContentCard:a=Object(r.__assign)({},o.contentCardProps);break;case i.a.AccordionCard:a=Object(r.__assign)({},o.accordionCardProps);break;case i.a.ChatCardWrapper:a=Object(r.__assign)({},o.chatCardWrapperProps);break;case i.a.FeedbackNudge:a=t.getFeedBackNudgeMessageBody(n(2703));break;case i.a.SelfHelpAdaptiveCard:a=Object(r.__assign)({},o.selfHelpAdaptiveCardProps);break;case i.a.StreamingAdaptiveCard:a=Object(r.__assign)({},o.streamingAdaptiveCardProps);break;case i.a.MarkdownCard:a=Object(r.__assign)({},o.markDownCardProps);break;case i.a.Designer:a=Object(r.__assign)({},o.designerCardProps);break;case i.a.CopilotWorkflowMessage:a=Object(r.__assign)({},o.copilotWorkflowsCardProps);break;case i.a.WarningMessage:a=Object(r.__assign)({},o.warningMessageCardProps);break;case i.a.PaginatedCard:a=Object(r.__assign)({},o.paginatedCardProps);break;case i.a.ProactiveSuggestionCard:a=Object(r.__assign)({},o.proactiveSuggestionCardProps);break;case i.a.ReviewerSummaryCard:a=Object(r.__assign)({},o.reviewerSummaryCardProps);break;case i.a.ReviewAgentCard:a=Object(r.__assign)({},o.reviewAgentCardProps);break;default:a=Object(r.__assign)({},o.defaultMessageProps)}return a},e}()},1594:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(2);function o(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}const i=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return yield null==e?void 0:e.ExecuteTaskListSequentially()}))},1595:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="graph-search-local-0.4.2811-0.14.3"},1596:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),o=n(1627),i=n(2445),a=Object(r.__assign)(Object(r.__assign)({},o.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"});Object(r.__assign)(Object(r.__assign)({},i.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(r.__assign)(Object(r.__assign)({},o.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"})},1606:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));n(353);var r="1.0",o=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm},1607:function(e,t,n){"use strict";function r(e){switch(e){case"af":return n.e(5).then(n.t.bind(null,2873,3));case"am":return n.e(6).then(n.t.bind(null,2874,3));case"ar":return n.e(7).then(n.t.bind(null,2875,3));case"as-in":return n.e(8).then(n.t.bind(null,2876,3));case"az-latn-az":return n.e(9).then(n.t.bind(null,2877,3));case"be-by":return n.e(10).then(n.t.bind(null,2878,3));case"bg":return n.e(11).then(n.t.bind(null,2879,3));case"bn-in":return n.e(13).then(n.t.bind(null,2880,3));case"bn-bd":return n.e(12).then(n.t.bind(null,2881,3));case"bs-latn-ba":return n.e(14).then(n.t.bind(null,2882,3));case"ca":return n.e(15).then(n.t.bind(null,2883,3));case"ca-es-valencia":return n.e(16).then(n.t.bind(null,2884,3));case"cs":return n.e(17).then(n.t.bind(null,2885,3));case"cy":return n.e(18).then(n.t.bind(null,2886,3));case"da":return n.e(19).then(n.t.bind(null,2887,3));case"de":return n.e(20).then(n.t.bind(null,2888,3));case"el":return n.e(21).then(n.t.bind(null,2889,3));case"en-gb":return n.e(22).then(n.t.bind(null,2890,3));case"en-us":return n.e(23).then(n.t.bind(null,2891,3));case"es":return n.e(24).then(n.t.bind(null,2892,3));case"es-mx":return n.e(25).then(n.t.bind(null,2893,3));case"et":return n.e(26).then(n.t.bind(null,2894,3));case"eu":return n.e(27).then(n.t.bind(null,2895,3));case"fa":return n.e(28).then(n.t.bind(null,2896,3));case"fi":return n.e(29).then(n.t.bind(null,2897,3));case"fil":return n.e(30).then(n.t.bind(null,2898,3));case"fr":return n.e(31).then(n.t.bind(null,2899,3));case"fr-ca":return n.e(32).then(n.t.bind(null,2900,3));case"ga-ie":return n.e(33).then(n.t.bind(null,2901,3));case"gd-gb":return n.e(34).then(n.t.bind(null,2902,3));case"gl":return n.e(35).then(n.t.bind(null,2903,3));case"gu":return n.e(36).then(n.t.bind(null,2904,3));case"ha-latn-ng":return n.e(37).then(n.t.bind(null,2905,3));case"he":return n.e(38).then(n.t.bind(null,2906,3));case"hi":return n.e(39).then(n.t.bind(null,2907,3));case"hr":return n.e(40).then(n.t.bind(null,2908,3));case"hu":return n.e(41).then(n.t.bind(null,2909,3));case"hy":return n.e(42).then(n.t.bind(null,2910,3));case"id":return n.e(43).then(n.t.bind(null,2911,3));case"is":return n.e(44).then(n.t.bind(null,2912,3));case"it":return n.e(45).then(n.t.bind(null,2913,3));case"ja":return n.e(46).then(n.t.bind(null,2914,3));case"ka":return n.e(47).then(n.t.bind(null,2915,3));case"kk":return n.e(48).then(n.t.bind(null,2916,3));case"km-kh":return n.e(49).then(n.t.bind(null,2917,3));case"kn":return n.e(50).then(n.t.bind(null,2918,3));case"ko":return n.e(51).then(n.t.bind(null,2919,3));case"kok":return n.e(52).then(n.t.bind(null,2920,3));case"ky":return n.e(53).then(n.t.bind(null,2921,3));case"lb-lu":return n.e(54).then(n.t.bind(null,2922,3));case"lo-la":return n.e(55).then(n.t.bind(null,2923,3));case"lt":return n.e(56).then(n.t.bind(null,2924,3));case"lv":return n.e(57).then(n.t.bind(null,2925,3));case"mi-nz":return n.e(58).then(n.t.bind(null,2926,3));case"mk":return n.e(59).then(n.t.bind(null,2927,3));case"ml":return n.e(60).then(n.t.bind(null,2928,3));case"mn-mn":return n.e(61).then(n.t.bind(null,2929,3));case"mr":return n.e(62).then(n.t.bind(null,2930,3));case"ms":return n.e(63).then(n.t.bind(null,2931,3));case"mt-mt":return n.e(64).then(n.t.bind(null,2932,3));case"ne-np":return n.e(65).then(n.t.bind(null,2933,3));case"nl":return n.e(66).then(n.t.bind(null,2934,3));case"nn-no":return n.e(67).then(n.t.bind(null,2935,3));case"no":return n.e(68).then(n.t.bind(null,2936,3));case"or":return n.e(69).then(n.t.bind(null,2937,3));case"pa-in":return n.e(70).then(n.t.bind(null,2938,3));case"pl":return n.e(71).then(n.t.bind(null,2939,3));case"prs":return n.e(72).then(n.t.bind(null,2940,3));case"pt":return n.e(73).then(n.t.bind(null,2941,3));case"pt-pt":return n.e(74).then(n.t.bind(null,2942,3));case"quz-pe":return n.e(75).then(n.t.bind(null,2943,3));case"ro":return n.e(76).then(n.t.bind(null,2944,3));case"ru":return n.e(77).then(n.t.bind(null,2945,3));case"sd-arab-pk":return n.e(78).then(n.t.bind(null,2946,3));case"si-lk":return n.e(79).then(n.t.bind(null,2947,3));case"sk":return n.e(80).then(n.t.bind(null,2948,3));case"sl":return n.e(81).then(n.t.bind(null,2949,3));case"sq":return n.e(82).then(n.t.bind(null,2950,3));case"sr":return n.e(83).then(n.t.bind(null,2951,3));case"sr-cyrl":return n.e(84).then(n.t.bind(null,2952,3));case"sr-cyrl-ba":return n.e(85).then(n.t.bind(null,2953,3));case"sv":return n.e(86).then(n.t.bind(null,2954,3));case"sw":return n.e(87).then(n.t.bind(null,2955,3));case"ta":return n.e(88).then(n.t.bind(null,2956,3));case"te":return n.e(89).then(n.t.bind(null,2957,3));case"th":return n.e(90).then(n.t.bind(null,2958,3));case"tk-tm":return n.e(91).then(n.t.bind(null,2959,3));case"tr":return n.e(92).then(n.t.bind(null,2960,3));case"tt":return n.e(93).then(n.t.bind(null,2961,3));case"ug-cn":return n.e(94).then(n.t.bind(null,2962,3));case"uk":return n.e(95).then(n.t.bind(null,2963,3));case"ur":return n.e(96).then(n.t.bind(null,2964,3));case"uz":return n.e(97).then(n.t.bind(null,2965,3));case"vi":return n.e(98).then(n.t.bind(null,2966,3));case"zh-hans":return n.e(99).then(n.t.bind(null,2967,3));case"zh-hant":return n.e(100).then(n.t.bind(null,2968,3));case"zu-za":return n.e(101).then(n.t.bind(null,2969,3));default:throw new Error(`Unsupported locale ${e}`)}}n.d(t,"a",(function(){return r}))},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var r=n(675),o=n(28),i=function(){function e(){}return e.useMarkdownInRadioButtonAndCheckbox=!0,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!0,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!1,e.defaultUnlocalizableStringFallback="Undefined",e.allowDelayedContainerRendering=!0,e.useBorderColorForSeparator=!1,e.failRenderingWhenUnknownPropertiesAreFound=!1,e.failRenderingWhenInvalidPropertyValuesAreFound=!1,e.fluentIconCdnBasePath="https://res-1.cdn.office.net/assets/fluentui-react-icons/2.0.226/",e.enableIconSupportForActionButtons=!1,e.allowSimultaneousVideoPlayback=!1,e}(),a=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r},s=function(e,t,n,r){void 0===e&&(e=o.t.None),void 0===t&&(t=o.t.None),void 0===n&&(n=o.t.None),void 0===r&&(r=o.t.None),this.top=o.t.None,this.right=o.t.None,this.bottom=o.t.None,this.left=o.t.None,this.top=e,this.right=t,this.bottom=n,this.left=r},l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,o.s.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var i=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(i&&i.length>=a)return r.physicalSize=parseInt(i[1],10),3===i.length&&"px"===i[2]&&(r.unit=o.s.Pixel),r}throw new Error("Invalid size: ".concat(t))},e}();function c(e,t){return e===t?0:e<t?-1:1}var u=function(){function e(e,t){void 0===e&&(e=o.j.Wide),this.width=e,this.condition=t}return e.parse=function(t){var n,i,a=Object(r.a)(o.u).join("|"),s=Object(r.a)(o.j).join("|"),l=new RegExp("^(?:(".concat(a,"):)?(").concat(s,")$"),"i").exec(t);if(l&&l.length>=3){var c=new e,u=null===(n=l[1])||void 0===n?void 0:n.toLowerCase();if(void 0!==u){var d=Object(r.b)(o.u,u);if(void 0===d)return;c.condition=d}var p=null===(i=l[2])||void 0===i?void 0:i.toLowerCase();if(void 0!==p){var g=Object(r.b)(o.j,p);if(void 0===g)return;return c.width=g,c}}},e.prototype.matches=function(e){return void 0===this.condition?this.width===e:this.condition===o.u.AtLeast?this.width<=e:e<=this.width},e.prototype.toString=function(){return void 0!==this.condition?"".concat(o.u[this.condition],":").concat(o.j[this.width]):o.j[this.width]},e}(),d=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&r|128]+e.lut[r>>8&255]+"-"+e.lut[r>>16&255]+e.lut[r>>24&255]+e.lut[255&o]+e.lut[o>>8&255]+e.lut[o>>16&255]+e.lut[o>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();d.initialize()},1611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),o=n(544),i=Object(o.a)("@1js/create-shared-react-context",{});function a(e,t){var n=i.get();return n[t]||(n[t]=r.createContext(e))}},1624:function(e,t,n){"use strict";n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return R}));var r=n(2),o=n(59),i=n(1478),a=n(389),s=n(317);function l(e,t,n){if("string"==typeof t){var r=Object(s.f)(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}var c=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}(),u=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.highlightColors=new c("#22000000","#11000000"),t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(c),d=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)},p=function(){function e(t){this.imageSize=o.n.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=Object(s.g)(t.maxImageHeight,e.defaultMaxImageHeight))}return e.prototype.toJSON=function(){return{imageSize:o.n[this.imageSize],maxImageHeight:this.maxImageHeight}},e.defaultMaxImageHeight=100,e}(),g=function(){function e(e){this.useHTML5PlayerAsFallback=!1,this.placeholderHeights={veryNarrow:120,narrow:175,standard:250,wide:300},e&&(this.defaultPoster=e.defaultPoster,this.useHTML5PlayerAsFallback=e.useHTML5PlayerAsFallback||this.useHTML5PlayerAsFallback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster}},e}(),h=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}(),f=function(){function e(e){this.size=o.s.Default,this.color=o.r.Default,this.isSubtle=!1,this.weight=o.t.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=l(o.s,e.size,this.size),this.color=l(o.r,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=l(o.t,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return o.t.Default},e.prototype.toJSON=function(){return{size:o.s[this.size],color:o.r[this.color],isSubtle:this.isSubtle,weight:o.t[this.weight]}},e}(),m=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.fontType=o.g.Default,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=l(o.g,t.fontType,this.fontType))},t}(f),v=function(){function e(e){this.default=new m,this.heading=new m({size:"Large",weight:"Bolder"}),this.columnHeader=new m({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}(),b=function(e){e&&(this.headingLevel=Object(s.g)(e.headingLevel))},y=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.suffix=" *",t.suffixColor=o.r.Attention,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=l(o.r,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=o.r[this.suffixColor],t},t}(f),C=function(e){this.inputSpacing=o.p.Small,this.requiredInputs=new y,this.optionalInputs=new f,e&&(this.inputSpacing=l(o.p,e.inputSpacing,this.inputSpacing),this.requiredInputs=new y(e.requiredInputs),this.optionalInputs=new f(e.optionalInputs))},O=function(e){this.label=new C,this.errorMessage=new f({color:o.r.Attention}),e&&(this.label=new C(e.label),this.errorMessage=new f(e.errorMessage))},S=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.wrap=!0,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(f),E=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.t.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=l(o.t,t.weight,o.t.Bolder)),n}return Object(r.__extends)(t,e),t.prototype.getDefaultWeight=function(){return o.t.Bolder},t}(S),x=function(e){this.rowGap=10,"object"==typeof e&&(this.rowGap="number"==typeof e.rowGap?Math.max(e.rowGap,0):this.rowGap)},I=function(e){function t(t){var n=e.call(this,t)||this;return n.columnGap=10,"object"==typeof t&&(n.columnGap="number"==typeof t.columnGap?Math.max(t.columnGap,0):n.columnGap),n}return Object(r.__extends)(t,e),t}(x),w=function(e){function t(t){var n=e.call(this,t)||this;return n.titleValueGap=0,"object"==typeof t&&(n.titleValueGap="number"==typeof t.titleValueGap?Math.max(t.titleValueGap,0):n.titleValueGap),n}return Object(r.__extends)(t,e),t}(x),T=function(e){this.title=new E,this.value=new S,this.tableLayout=new I,this.stackLayout=new w,this.layoutSwitchBreakpoint=o.i.Standard,"object"==typeof e&&(this.title=new E(e.title),this.value=new S(e.value),this.tableLayout=new I(e.tableLayout),this.stackLayout=new w(e.stackLayout),this.layoutSwitchBreakpoint=l(o.i,e.layoutSwitchBreakpoint,o.i.Standard))},k=function(){function e(e){this.actionMode=o.m.Inline,this.inlineTopMargin=16,this.style=o.f.Emphasis,e&&(this.actionMode=l(o.m,e.actionMode,o.m.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.f.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.m[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}(),j=function(){function e(e){if(this.maxActions=5,this.spacing=o.p.Default,this.buttonSpacing=20,this.showCard=new k,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.l.Horizontal,this.actionAlignment=o.a.Left,this.iconPlacement=o.c.LeftOfTitle,this.allowTitleToWrap=!1,this.allowButtonsToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=l(o.p,e.spacing&&e.spacing,o.p.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new k(e.showCard),this.preExpandSingleShowCardAction=Object(s.e)(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=l(o.l,e.actionsOrientation,o.l.Horizontal),this.actionAlignment=l(o.a,e.actionAlignment,o.a.Left),this.iconPlacement=l(o.c,e.iconPlacement,o.c.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap,this.allowButtonsToWrap=null!=e.allowButtonsToWrap?e.allowButtonsToWrap:this.allowTitleToWrap;try{var t=a.c.parse(e.iconSize);t.unit===o.o.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.p[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.l[this.actionsOrientation],actionAlignment:o.a[this.actionAlignment]}},e}(),P=function(){function e(e){this.default=new u,this.dark=new u,this.light=new u,this.accent=new u,this.good=new u,this.warning=new u,this.attention=new u,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e.prototype.getColorDefinition=function(e){switch(e){case o.r.Accent:return this.accent;case o.r.Dark:return this.dark;case o.r.Light:return this.light;case o.r.Good:return this.good;case o.r.Warning:return this.warning;case o.r.Attention:return this.attention;default:return this.default}},e}(),A=function(){function e(e){this.foregroundColors=new P({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(A),D=function(){function e(e){var t,n;if(this._allStyles={},this._allStyles[o.f.Default]=new _,this._allStyles[o.f.Emphasis]=new _,this._allStyles[o.f.Accent]=new _,this._allStyles[o.f.Good]=new _,this._allStyles[o.f.Attention]=new _,this._allStyles[o.f.Warning]=new _,e){this._allStyles[o.f.Default].parse(e[o.f.Default]),this._allStyles[o.f.Emphasis].parse(e[o.f.Emphasis]),this._allStyles[o.f.Accent].parse(e[o.f.Accent]),this._allStyles[o.f.Good].parse(e[o.f.Good]),this._allStyles[o.f.Attention].parse(e[o.f.Attention]),this._allStyles[o.f.Warning].parse(e[o.f.Warning]);var i=e.customStyles;if(i&&Array.isArray(i))try{for(var a=Object(r.__values)(i),s=a.next();!s.done;s=a.next()){var l=s.value;if(l){var c=l.name;c&&"string"==typeof c&&(this._allStyles.hasOwnProperty(c)?this._allStyles[c].parse(l.style):this._allStyles[c]=new A(l.style))}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[o.f.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.f.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.f.Emphasis]},enumerable:!1,configurable:!0}),e}(),L=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}(),M=function(){function e(e){this.default=new L,this.monospace=new L("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.g.Monospace:return this.monospace;case o.g.Default:default:return this.default}},e}(),B=function(){function e(e){this.hostCapabilities=new i.a,this.designMode=!1,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.hostWidthBreakpoints={veryNarrow:216,narrow:345,standard:500},this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.roundedCornerRadius=6,this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new D,this.inputs=new O,this.actions=new j,this.adaptiveCard=new d,this.imageSet=new p,this.media=new g,this.factSet=new T,this.table=new h,this.textStyles=new v,this.textBlock=new b,this.alwaysAllowBleed=!1,this._legacyFontType=new L,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new M(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new D(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new O(e.inputs||this.inputs),this.actions=new j(e.actions||this.actions),this.adaptiveCard=new d(e.adaptiveCard||this.adaptiveCard),this.imageSet=new p(e.imageSet),this.factSet=new T(e.factSet),this.textStyles=new v(e.textStyles),this.textBlock=new b(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===o.g.Monospace?L.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.p.Small:return this.spacing.small;case o.p.Default:return this.spacing.default;case o.p.Medium:return this.spacing.medium;case o.p.Large:return this.spacing.large;case o.p.ExtraLarge:return this.spacing.extraLarge;case o.p.Padding:return this.spacing.padding;default:return 0}},e.prototype.getHostWidthForPixelWidth=function(e){return e<=this.hostWidthBreakpoints.veryNarrow?o.i.VeryNarrow:e<=this.hostWidthBreakpoints.narrow?o.i.Narrow:e<=this.hostWidthBreakpoints.standard?o.i.Standard:o.i.Wide},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new a.d(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=[];try{for(var a=Object(r.__values)(n),s=a.next();!s.done;s=a.next()){var l=s.value;i.push((this.cssClassNamePrefix?"".concat(this.cssClassNamePrefix,"-"):"")+l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,Object(r.__spreadArray)([],Object(r.__read)(e),!1)).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}(),R=new B({preExpandSingleShowCardAction:!0,supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:40,medium:80,large:160},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{borderColor:"#CCCCCC",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{borderColor:"#666666",backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:"default",buttonSpacing:10,showCard:{actionMode:"inline",inlineTopMargin:16},actionsOrientation:"horizontal",actionAlignment:"left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"medium",maxImageHeight:100},factSet:{title:{color:"default",size:"default",isSubtle:!1,weight:"bolder",wrap:!0,maxWidth:150},value:{color:"default",size:"default",isSubtle:!1,weight:"default",wrap:!0},tableLayout:{columnGap:10,rowGap:6},stackLayout:{rowGap:10},layoutSwitchBreakpoint:"standard"}})},1639:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Rewrite="Rewrite",e.Insert="Insert",e.Reply="Reply"}(r||(r={}))},17:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return C}));var r,o,i,a,s,l=n(2);!function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.AugloopResponseTime="AugloopResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.ImageResponseTime="ImageResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.QnAResponseTime="QnAResponseTime",e.QnAChunkInfo="QnAChunkInfo",e.SuggestedQnAResponseTime="SuggestedQnAResponseTime",e.AnnotationType="AnnotationType",e.RequestSignalType="RequestSignalType",e.FeatureName="FeatureName",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.IsFirstSdxSessionQuery="IsFirstSdxSessionQuery",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.PluginsConfig3SFetchTime="PluginsConfig3SFetchTime",e.CopilotChatLoadTime="CopilotChatLoadTime",e.Cv="Cv"}(r||(r={})),function(e){e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorKey="ChatErrorKey",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorType="ChatErrorType",e.IsFromCache="IsFromCache",e.IsStreamingResponse="IsStreamingResponse",e.Cv="Cv"}(o||(o={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory"}(i||(i={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.SubmitButtonClicked="Submit_Button_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.ZQMButtonV2Clicked="ZQM_Button_V2_Clicked",e.ZQMLoaded="ZQM_Loaded",e.MenuItemClicked="Menu_Item_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.QueryResubmittedToAL="Query_Resubmitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.HintCardShownOnSubmission="Hint_Card_Shown",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.ALAnnotationReceived="AL_Annotation_Received",e.ChatHistoryTimeout="Chat_History_Timeout",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.EntityLabelOperationSubmitted="Entity_Label_Operation_Submitted",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.GetCurrentChatStatus="GetCurrentChat_Status",e.GetMessagesStatus="GetMessages_Status",e.DeleteMessageStatus="DeleteMessage_Status",e.GetAllChatStatus="GetAllChat_Status",e.AddMessageStatus="AddMessage_Status",e.FeedbackDataUploadOperationSubmitted="FeedbackDataUpload_Operation_Submitted",e.FeedbackDataSydneyDataMissing="FeedbackData_SydneyData_Missing",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionCompleted="Query_Execution_Completed",e.ChatPaneLoadMessageBarShown="ChatPaneLoad_MessageBar_Shown",e.FirstUserInputReceived="First_User_Input_Received",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.ChatInputLoaded="ChatInput_Loaded",e.FirstQuerySubmitted="First_Query_Submitted",e.CopilotLicensingAnnotationActivated="Copilot_Licensing_Annotation_Activated",e.ResetOperationListForResubmit="Reset_Operation_List_For_Resubmit",e.AddToOperationListForResubmit="Add_To_Operation_List_For_Resubmit",e.ChatInputDisabledAndBannerShownForInActiveChatSession="ChatInput_Disabled_And_Banner_Shown_For_InActive_Chat_Session",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TrySydneyToggle="Try_Sydney_Toggle",e.IsSydneyEnabled="Is_Sydney_Enabled",e.HubbleEnterprisePromptClicked="EnterpriseImagePrompt_Clicked",e.BasicChatOperationSubmitted="Basic_Chat_Operation_Submitted",e.BasicChatStreamingResponseTimeout="Basic_Chat_Streaming_Response_Timeout",e.CachedBasicChatResponseShown="Cached_Basic_Chat_Response_Shown",e.EmptyBasicChatResponse="Empty_Basic_Chat_Response",e.QuerySuccessful="Query_Successful",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CLPEncryptedLabelSent="CLP_Encrypted_Label_Sent",e.CLPNonEncryptedLabelSent="CLP_Non_Encrypted_Label_Sent",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabGoToCopilotLabButtonClicked="Copilot_Lab_GoToCopilotLab_Button_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.GroundingSourceUpdated="Grounding_Source_Updated",e.MenuButtonClicked="Menu_Button_Clicked",e.MenuL1SuggestionClicked="Menu_L1_Suggestion_Clicked",e.MenuL2SuggestionClicked="Menu_L2_Suggestion_Clicked",e.PluginConfigSignalSent="Plugin_Config_Signal_Sent",e.PromptSubmittedWithCIQ="Prompt_Submitted_With_CIQ",e.CIQSuggestionSelected="CIQ_Suggestion_Selected",e.SubstrateAPIOperationSubmitted="Substrate_API_Operation_Submitted",e.MsgExtCardDataReceived="MsgExtCard_Data_Received"}(a||(a={})),function(e){e.AugloopResponseTimeoutMessage="AugloopResponseTimeoutMessage"}(s||(s={}));var c,u,d,p,g,h,f,m,v,b=Object(l.__assign)(Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},a),r),i),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(c||(c={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(u||(u={})),function(e){e.BasicChat="Basic Chat",e.ContentCreation="Content Creation Skill in Chat"}(d||(d={})),function(e){e.Client="Client",e.Server="Server"}(p||(p={})),function(e){e.ChatQnA="Chat QnA",e.Draft="Draft",e.CopilotChat="CopilotChat"}(g||(g={})),function(e){e.BasicChatRAIFilterBlockedResponse="Ask Chat QnA Responsible AI Filter Blocked Response",e.ChatComposeDidNotGenerateContent="CopilotChatComposeDidNotGenerateContent",e.BasicChatUnsupportedCopilotFunctionality="Ask Chat QnA Unsupported Copilot Functionality",e.BasicChatMissingCopilotFunctionality="Ask Chat QnA Missing Copilot Functionality",e.BasicChatResponseTimedOut="Ask Chat QnA Response Delayed or Timed Out",e.BasicChatCapacityIssues="Ask Chat QnA Unable to Generate Response Due to Capacity Issue",e.BasicChatBadResponse="Ask Chat QnA LLM Service Side Issue Prevents Output",e.BasicChatInputNotProcessed="Ask Chat QnA User Input Could Not Be Processed",e.BasicChatTaskCompletionIssue="Ask Chat QnA Unable to Complete Task",e.BasicChatUnclassifiedError="Ask Chat QnA Unclassified ASHA Error",e.BasicChatUserCancelledResponse="Ask Chat QnA User Rejected or Cancelled Response"}(h||(h={})),function(e){e.UserAccessIssue="Unclear Intent CopilotChat User Access Issue for Copilot"}(f||(f={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.InputTooLong="Error occurred because input is too long",e.UserThrottled="Error occurred because user has issued too many requests",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.Timeout="Timeout waiting for server",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidSignal="Error occurred because signal/response is invalid",e.PromptInjection="Error occurred because prompt injection is detected",e.InputBlocked="Error occurred because input is blocked by filters",e.OutputBlocked="Error occurred because output is blocked by filters",e.OffensiveInput="Error occurred because user input is offensive",e.OffensiveOutput="Error occurred because offensive content is blocked in output",e.SignalMissing="Error occurred because signal is missing in workflow",e.SignalWrongType="Error occurred because signal is invalid",e.BadResponse="Error occured because of bad response",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.BadRequest="Error occured because of bad request",e.Unknown="Error is unknown",e.UserAbortedQueryExecution="User aborted query execution",e.APIUnavailable="Error occured because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated output",e.UnknownError="Unknown error from model"}(m||(m={})),function(e){e.Licensing="Error occured because copilot license couldn't be validated"}(v||(v={}));var y="UserQueryGuid",C="Chat"},171:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(2),o=n(131),i=n(48),a=n(105),s=n(242),l=n(17),c=n(52),u=n(1150),d=n(840),p=n(44),g=function(){function e(){var e=this;this.chatHistoryInfoLog=[],this.userQueryGuid=p.w,this.getTelemetryLatencyEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:l.k.CopilotChatHistoryInfoJson,value:JSON.stringify(e.chatHistoryInfoLog)}]))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),n&&e.setUserQueryGuid(p.w),new d.a(s.d.Latency,s.c.Latency,t,r,o,i,n)},this.getASHATelemetryErrorEvent=function(t,n,i,c,u,p,g){return(t=t.concat.apply(t,Object(r.__spreadArray)([],Object(r.__read)(c&&u?Object(r.__spreadArray)([],Object(r.__read)(o.c.getFields({eventType:o.c.EventType.Error,veto:c,error:u,inStaging:null==p||p})),!1):[]),!1))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),new d.a(s.d.Error,s.c.AshaError,t,n,i,g)},this.getASHAPillarTelemetryEvent=function(t,n,i,c,u){return(t=t.concat.apply(t,Object(r.__spreadArray)([],Object(r.__read)(c?Object(r.__spreadArray)([],Object(r.__read)(o.c.getFields({eventType:o.c.EventType.Pillar,pillar:c})),!1):[]),!1))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),new d.a(s.d.ChatEvents,s.c.ChatEvents,t,n,i,u)},this.getTelemetryErrorEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:l.g.UserQueryOrder,value:a.j}]))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),new d.a(s.d.Error,s.c.Error,t,r,o,i,n)},this.getTelemetryQueryDetailsEvent=function(t,n,r,o){return(t=t.concat(e.getDataFields([{key:l.l.UserQueryOrder,value:a.j}]))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),new d.a(s.d.QueryDetails,s.c.QueryDetails,t,n,r,o)},this.getTelemetryChatEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:l.g.UserQueryOrder,value:a.j}]))).find((function(e){return e.name===l.q}))||(t=t.concat(e.getDataFields([{key:l.q,value:e.userQueryGuid.length>0?e.userQueryGuid:a.i}]))),new d.a(s.d.ChatEvents,s.c.ChatEvents,t,r,o,i,n)},this.chatHistoryInfoLog=[]}return e.setTelemetryHandler=function(e){this.telemetryHandler=e},e.getTelemetryHandler=function(){return this.telemetryHandler},e.prototype.addChatHistoryInfoLog=function(e){this.chatHistoryInfoLog.push(e)},e.prototype.resetChatHistoryInfoLog=function(){this.chatHistoryInfoLog=[]},e.prototype.setUserQueryGuid=function(e){this.userQueryGuid=e},e.prototype.getUserQueryGuid=function(){return this.userQueryGuid},e.getInstance=function(){return e.telemetryHandler||this.setTelemetryHandler(new u.b),this.sInstance||(this.sInstance=new e),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.sendTelemetryLatencyData=function(t,n,r,o,i){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&(e.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEvent(this.getDataFields(t),n,r,o,i)),this.resetChatHistoryInfoLog())},e.prototype.sendTelemetryErrorData=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryErrorEvent(this.getDataFields(t),!0,n,r,o))},e.prototype.sendTelemetryQueryDetailsObject=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryQueryDetailsEvent(this.getDataFields(t),n,r,o))},e.prototype.sendTelemetryChatEventData=function(t,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryChatEvent(this.getDataFields(t),n,r,o,i))},e.prototype.getCopilotScorecardData=function(e,t,n,i,u,p,g,h){return(e=e.concat(Object(r.__spreadArray)([],Object(r.__read)(o.e.getFields({featureActionType:o.e.FeatureActionType[t],isUserInitiated:!0,capability:Object(c.r)(u)?"":o.e.Capability[u],verb:Object(c.r)(g)?"":o.e.Verb[g],featureName:Object(c.r)(i)?"Others":i,subFeatureName:Object(c.r)(h)?"":h,entryPoint:n,isThumbsUp:Object(c.r)(p)?null:p})),!1))).find((function(e){return e.name===l.q}))||(e=e.concat(this.getDataFields([{key:l.q,value:this.userQueryGuid.length>0?this.userQueryGuid:a.i}]))),new d.a(s.d.Chat,s.c.Chat,e,i,u,g,!0,!0,s.a.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,s.b.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?i.b(e.key,e.value,e.tag):"string"==typeof e.value?i.d(e.key,e.value,e.tag):"boolean"==typeof e.value?i.a(e.key,e.value,e.tag):i.d(e.key,e.value,e.tag)}),[])},e.prototype.logSeenEvent=function(t,n,r,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),o.e.FeatureActionType.IsSeen,n,r,i,void 0,a,s))},e.prototype.logTriedEvent=function(t,n,r,i,a,s,l){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),o.e.FeatureActionType.IsTried,n,r,i,a,s,l))},e.prototype.logKeptEvent=function(t,n,r,i,a,s,l){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),o.e.FeatureActionType.IsKept,n,r,i,a,s,l))},e.prototype.logEnabledEvent=function(t,n,r,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),o.e.FeatureActionType.IsSeen,n,r,i,void 0,a,s))},e.prototype.logEventWithAshaPillar=function(t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHAPillarTelemetryEvent(this.getDataFields(t),n,r,o,i))},e.prototype.logErrorWithAshaVetoAndError=function(t,n,r,o,i,a,s){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHATelemetryErrorEvent(this.getDataFields(t),n,r,o,i,a,s))},e}()},173:function(e,t,n){"use strict";n.r(t);var r=n(246);n.d(t,"ActionErrorType",(function(){return r.a})),n.d(t,"ActionExecuteResponseType",(function(){return r.b})),n.d(t,"ActionType",(function(){return r.c})),n.d(t,"CustomTelemetryMessages",(function(){return r.d})),n.d(t,"LogType",(function(){return r.e})),n.d(t,"ModalViewType",(function(){return r.f})),n.d(t,"PerfName",(function(){return r.g})),n.d(t,"PerfTag",(function(){return r.h})),n.d(t,"RuntimeActivityResponseMethod",(function(){return r.i})),n.d(t,"SuccessStatus",(function(){return r.j})),n.d(t,"TelemetryName",(function(){return r.k})),n.d(t,"TelemetryPropType",(function(){return r.l})),n.d(t,"TelemetryTag",(function(){return r.m})),n.d(t,"TypeOfCard",(function(){return r.n}));var o=n(2680);n.d(t,"convertTitleInfoToAppDefinition",(function(){return o.a}));var i=n(2681);n.d(t,"getCommandWithInitialRunEnabledInAppDefinition",(function(){return i.a}));var a=n(1743);n.d(t,"ActionExecuteAuthResponse",(function(){return a.a})),n.d(t,"ActionExecuteErrorResponse",(function(){return a.b})),n.d(t,"ActionExecuteSuccessResponse",(function(){return a.c}));var s=n(1811);n.d(t,"BotResponseType",(function(){return s.a}));var l=n(2083);n.d(t,"ResponseType",(function(){return l.a}))},1741:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Automatic="automatic",e.Manual="manual"}(r||(r={})),function(e){e.Error="error",e.HeroCard="application/vnd.microsoft.card.hero",e.ThumbnailCard="application/vnd.microsoft.card.thumbnail",e.ConnectorCard="application/vnd.microsoft.teams.card.o365connector",e.AdaptiveCard="application/vnd.microsoft.card.adaptive",e.SignInCard="signincard",e.AppInstallCard="appinstallcard"}(o||(o={}))},1743:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(321);class o{constructor(e,t){this.content=e,this.type=t}}class i{constructor(e,t){this.code=e,this.message=t,this.type="Error"}}class a{constructor(e,t){this._rawContent=e,this.type=t;try{const e=JSON.parse(this._rawContent);this._auth=new r.b,this._auth.parse(e);for(const e of this._auth.buttons)if("signin"===e.type&&e.value){new URL(e.value),this.signInButton=e;break}}catch(e){}}get tokenExchangeResource(){var e;return null===(e=this._auth)||void 0===e?void 0:e.tokenExchangeResource}}},1745:function(e,t,n){"use strict";function r(e){throw new Error(e)}n.r(t),n.d(t,"throwError",(function(){return r}))},1746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lookupStringInDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.setLocalizationErrorHandlerForDefaultStringProvider=t.getDefaultStringProvider=void 0;var r=n(2),o=n(1337),i=n(1522),a={currentLocale:void 0,strings:{},errorHandler:function(e){return console.error(e)},loaders:[],stringMapInitialized:!1,suppressEmptyStringMapErrors:(0,o.isTest)()};function s(){return a}t.getDefaultStringProvider=s,t.setLocalizationErrorHandlerForDefaultStringProvider=function(e){a=(0,i.setLocalizationErrorHandler)(e,a)},t.addStringMapForDefaultStringProvider=function(e,t){a=(0,i.addStringMap)(e,t,a)},t.addStringMapLoaderForDefaultStringProvider=function(e){a=(0,i.addStringMapLoader)(e,a)},t.getCurrentLocaleForDefaultStringProvider=function(){return(0,i.getCurrentLocale)(s())},t.setCurrentLocaleForDefaultStringProvider=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,(0,i.setCurrentLocale)(e,a)];case 1:return[2,(a=t.sent()).currentLocale]}}))}))},t.clearStringMapLoadersForDefaultStringProvider=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,(0,i.clearStringMapLoaders)(s())];case 1:return a=e.sent(),[2]}}))}))},t.lookupStringInDefaultStringProvider=function(e){return(0,i.lookUpString)(e,s())}},1747:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithOnlyKey=void 0;var r=n(2),o=n(1525),i=n(1452),a=n(1745);function s(e){return(e=(0,o.upperFirst)(e.trim()))&&!(0,o.endsWith)(e,".")&&(e+="."),e}t.getStringDescriptionWithOnlyKey=function(e){return{key:e,stringToBeLocalized:"",comment:"",placeholderNames:[]}},t.getStringDescriptionWithoutPlaceholders=function(e,t){return{key:e,stringToBeLocalized:t.text,comment:t.comment,placeholderNames:[]}},t.getStringDescriptionWithPlaceholders=function(e,t){for(var n=(0,o.keys)(t.placeholders).filter(o.isString).sort(),l={},c=0,u=(0,o.keys)(t.placeholders);c<u.length;c++){var d=u[c];l[d]=(0,o.isString)(d)?"{".concat(n.indexOf(d),"}"):(0,a.throwError)("Placeholder name ".concat(d," is not a string"))}var p=t.text(l),g=r.__spreadArray([t.comment],n.map((function(e,n){var r=t.placeholders[e].trim();return r?"{".concat(n,"} is a placeholder for ").concat((0,o.lowerFirst)(r)):null})),!0),h=(0,i.filterOutNull)(g).map(s).filter(Boolean).join(" ");return n.forEach((function(e,t){h=h.replace("{"+e+"}","{"+t+"}")})),{key:e,stringToBeLocalized:p,comment:h,placeholderNames:n}}},1748:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(2),o=n(32),i=n(28),a=n(175),s=n(181),l=n(693),c=function(e){function t(t,n){var r=e.call(this)||this;return r.title=t,r.value=n,r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new o.n(o.s.v1_0,"title"),t.valueProperty=new o.n(o.s.v1_0,"value"),t}(o.j),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"dataset",{get:function(){return this.getValue(t.datasetProperty)},set:function(e){this.setValue(t.datasetProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.getValue(t.countProperty)},set:function(e){this.setValue(t.countProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skip",{get:function(){return this.getValue(t.skipProperty)},set:function(e){this.setValue(t.skipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"associatedInputs",{get:function(){return this.getValue(t.associatedInputsProperty)},set:function(e){this.setValue(t.associatedInputsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Data.Query"},t.prototype.getAdditionalPropertyDescriptors=function(e){return[{name:"type",valueType:"string",requiredValue:this.getJsonTypeName(),isArray:!1}]},t.datasetProperty=new o.n(o.s.v1_0,"dataset"),t.associatedInputsProperty=new s.c(o.s.v1_0,"associatedInputs"),t.countProperty=new o.g(o.s.v1_0,"count"),t.skipProperty=new o.g(o.s.v1_0,"skip"),t}(o.o),d=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.selectedValues=new Set,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMultiSelect",{get:function(){return this.getValue(t.isMultiSelectProperty)},set:function(e){this.setValue(t.isMultiSelectProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.getValue(t.choicesProperty)},set:function(e){this.setValue(t.choicesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choicesData",{get:function(){return this.getValue(t.choicesDataProperty)},set:function(e){this.setValue(t.choicesDataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.propertyChanged=function(n,r){var o=this;if(e.prototype.propertyChanged.call(this,n,r),n===t.valueProperty){var i=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):[];this.selectedValues.clear(),i.forEach((function(e){return o.selectedValues.add(e)}))}},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.internalValidateProperties=function(t){var n,o;e.prototype.internalValidateProperties.call(this,t),0===this.choices.length&&t.addFailure(this,i.A.CollectionCantBeEmpty,a.a.errors.choiceSetMustHaveAtLeastOneChoice());try{for(var s=Object(r.__values)(this.choices),l=s.next();!l.done;l=s.next()){var c=l.value;c.title&&c.value||t.addFailure(this,i.A.PropertyCantBeNull,a.a.errors.choiceSetChoicesMustHaveTitleAndValue())}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){var e,t;if(this.choicesData)return!0;if(""===this.value||void 0===this.value)return!this.isRequired;var n=this.isMultiSelect?this.value.split(this.hostConfig.choiceSetInputValueSeparator):[this.value],o=this.choices.map((function(e){return e.value}));try{for(var i=Object(r.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;if(!o.includes(s))return!1}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!0},t.prototype.isValidValue=function(e){var t,n;if(this.choicesData)return!0;var o=this.isMultiSelect?e.split(this.hostConfig.choiceSetInputValueSeparator):[e],i=this.choices.map((function(e){return e.value}));try{for(var a=Object(r.__values)(o),s=a.next();!s.done;s=a.next()){var l=s.value;if(!i.includes(l))return!1}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!0},t.prototype.getAssociatedInputs=function(){return this.choicesData&&"none"!==this.choicesData.associatedInputs?this.getRootElement().getAllInputs():[]},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value===t||void 0!==t&&!this.isValidValue(t)||e.prototype.valueChanged.call(this,t)},enumerable:!1,configurable:!0}),t.valueProperty=new o.n(o.s.v1_0,"value"),t.choicesProperty=new o.k(o.s.v1_0,"choices",(function(e){return new c})),t.choicesDataProperty=new o.p(o.s.v1_5,"choices.data","Data.Query",(function(e){return new u}),!0),t.styleProperty=new o.q(o.s.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:o.s.v1_5}],"compact"),t.isMultiSelectProperty=new o.b(o.s.v1_0,"isMultiSelect",!1),t.placeholderProperty=new o.n(o.s.v1_0,"placeholder"),t.wrapProperty=new o.b(o.s.v1_2,"wrap",!0),t}(l.a)},175:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,r){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(r,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")},unknownProperty:function(e){return'Unknown property "'.concat(e,'"')}},e.hints={dontUseWeightedAndStretchedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.overflowButtonText={key:"overflowButtonText",defaultValue:"..."},e.overflowButtonTooltip={key:"overflowButtonTooltip",defaultValue:"More options"},e.mediaPlayerAriaLabel={key:"mediaPlayerAriaLabel",defaultValue:"Media content"},e.mediaPlayerPlayMedia={key:"mediaPlayerPlayMedia",defaultValue:"Play media"},e.youTubeVideoPlayer={key:"youTubeVideoPlayer",defaultValue:"YouTube video player"},e.vimeoVideoPlayer={key:"vimeoVideoPlayer",defaultValue:"Vimeo video player"},e.dailymotionVideoPlayer={key:"dailymotionVideoPlayer",defaultValue:"Dailymotion video player"},e.mediaPlayerPosterAltText={key:"mediaPlayerPosterAltText",defaultValue:"Video poster"},e.emptyElementText={key:"emptyElementText",defaultValue:"Empty {{elementType}}"},e}()},1776:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Automatic="automatic",e.Manual="manual"}(r||(r={})),function(e){e.Error="error",e.HeroCard="application/vnd.microsoft.card.hero",e.ThumbnailCard="application/vnd.microsoft.card.thumbnail",e.ConnectorCard="application/vnd.microsoft.teams.card.o365connector",e.AdaptiveCard="application/vnd.microsoft.card.adaptive",e.SignInCard="signincard",e.AppInstallCard="appinstallcard"}(o||(o={}))},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n(2),o=n(1611),i=n(65),a=n(1),s=Object(o.a)([],"ComponentStylingPureFluentOverrides");function l(e,t){function n(){var n=t(),o=Object(a.useContext)(s).map((function(t){return t[e]})).filter((function(e){return!!e})),l=Object(r.__assign)({},n),c=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],a=o.map((function(t){return t[e]})).filter((function(e){return!!e})),s=i.a.apply(void 0,Object(r.__spreadArray)([t],Object(r.__read)(a),!1));l[e]=s}};for(var u in n)c(u);return l}return n.componentName=e,n.__version="fluent",n}function c(e){var t=s.Consumer,n=s.Provider;return function(o){var i=o.children,s={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=e[l];c&&(s[l]=c())}return a.createElement(t,null,(function(e){var t=Object(r.__spreadArray)([s],Object(r.__read)(e),!1);return a.createElement(n,{value:t},i)}))}}},1781:function(e,t,n){"use strict";n.r(t),n.d(t,"ChannelService",(function(){return u})),n.d(t,"MosAppService",(function(){return m})),n.d(t,"AppService",(function(){return S})),n.d(t,"CardService",(function(){return T.a})),n.d(t,"HttpStatusCode",(function(){return k.a})),n.d(t,"isStageViewActionSubmit",(function(){return j.a})),n.d(t,"isTaskModuleActionSubmit",(function(){return j.b}));var r,o=n(2),i=n(2124),a=n(1467),s=n(246),l=n(1811),c=n(3487);class u{constructor(e,t,n,r,o){this.tokenService=e,this.hostContext=t,this.telemetryService=o,this.endpointUrl="https://substrate.office.com/search/api/v1/",this.tokenScope="https://substrate.office.com/search",n&&(this.endpointUrl=n),r&&(this.tokenScope=r)}botInvoke(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeRequest),r={};if(!(null===(t=this.hostContext)||void 0===t?void 0:t.locale))throw n.logMetricEndWithError({message:s.d.HostLocaleIsUndefined,diagnosticsData:`RequestName: ${e.requestBody.name}`}),new Error("host locale is undefined");const o=this.processRequest(e),a=`${this.endpointUrl}botinvoke?culture=${this.hostContext.locale}`,u=yield this.getInvokeRequestHeaders(),d=yield Object(i.a)(a,{method:"POST",headers:u,body:JSON.stringify(o)});if(!d.ok)throw n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),d;const p=yield d.json();return r[s.l.HttpStatusCode]=p.statusCode,p.error?(n.logMetricEndWithError({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Error,value:{errorCode:p.error.httpCode,errorMessage:p.error.message}}):(n.logMetricEnd({props:r,diagnosticsData:`RequestName: ${e.requestBody.name}`}),{type:l.a.Result,value:p.response})}))}getInvokeRequestHeaders(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const e=new c.a(this.telemetryService,s.h.BotInvoke,s.g.BotInvokeFetchToken),t=new Headers;t.set("Content-Type","application/json");try{const n=yield this.tokenService.getToken({resource:this.tokenScope});n&&(null==n?void 0:n.authToken)&&t.set("Authorization",`Bearer ${n.authToken}`),e.logMetricEnd()}catch(t){e.logMetricEndWithError({diagnosticsData:`Error: ${null==t?void 0:t.message}`})}return t}))}processRequest(e){var t,n,r,o,i;const s={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(a.generateGuid)(),scenario:{name:"M365CardSDK"}};return e.requestBody.appName&&(s.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(s.request.imdisplayname=e.requestBody.imdisplayname),s}}class d{static getAndCacheAcquisitions(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o={},i=new c.a(this.telemetryService,s.h.GetAndCacheAcquisition,s.g.GetAndCacheAcquisitionforMOS);try{const a=yield n.getToken({resource:t});let s=new URL("/catalog/v1/users/acquisitions/get",t);const l={method:"POST",headers:{Authorization:`Bearer ${a.authToken}`,Accept:"application/json","Accept-Language":r},body:JSON.stringify({Filter:{supportedElementTypes:["ComposeExtensions"]}})};let c=yield fetch(s.toString(),l);if(c.ok&&200===c.status){const e=(yield c.json()).acquisitions;if(e)return this.createTime=Date.now(),this.cachedAcquisitions=e,e}if(s=new URL("/catalog/v1/users/titles/launchInfo",t),l.body=JSON.stringify({Id:e,Filter:{supportedElementTypes:["ComposeExtensions"]}}),c=yield fetch(s.toString(),l),c.ok&&200===c.status){const e=(yield c.json()).acquisition;if(e)return this.cachedAcquisitions?this.cachedAcquisitions.push(e):(this.cachedAcquisitions=[e],this.createTime=Date.now()),this.cachedAcquisitions}return o.HttpStatusCode=c.status,i.logMetricEnd({props:o}),Promise.reject(`Error while fetching acquisitions: ${c.status}`)}catch(e){return i.logMetricEndWithError({props:o,diagnosticsData:`Error: fetching acquisitions failed, ${null==e?void 0:e.message}`}),Promise.reject(`fetching acquisitions failed, ${null==e?void 0:e.message}`)}}))}static findAcquisitionWithId(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t={},n=new c.a(this.telemetryService,s.h.FindAcquisition,s.g.FindAcquisitionforMOS);if(this.cachedAcquisitions){const r=this.cachedAcquisitions.find((t=>t.appId===e));return n.logMetricEnd({props:t}),Promise.resolve(r)}return n.logMetricEndWithError({props:t,diagnosticsData:"Error: could not find app with id in acquisitions"}),Promise.reject(`couldn't find app with id, ${e}`)}))}}var p;r=d,d.cacheTimeInMs=36e5,d.cachedAcquisitions=void 0,d.createTime=0,d.getAcquisition=(e,t,n,i)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){return Date.now()-r.createTime>r.cacheTimeInMs&&(r.cachedAcquisitions=void 0),r.cachedAcquisitions&&0!=r.cachedAcquisitions.filter((t=>t.appId===e)).length||(yield r.getAndCacheAcquisitions(e,t,n,i)),yield r.findAcquisitionWithId(e)}));const g="https://titles.prod.mos.microsoft.com/config/v1/environment",h=36e5;class f{static getAndCacheUrlFromDiscoveryApi(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.getToken({resource:g});if(n&&n.authToken){const e=new URL(g),r={method:"GET",headers:{Authorization:`Bearer ${n.authToken}`,Accept:"application/json","Accept-Language":t}},o=yield fetch(e.toString(),r);if(o.ok&&200===o.status){const e=yield o.json();return this.cachedServiceUrl=e.titlesServiceUrl,this.cacheTimeInMs=e.cacheTimeInHrs?e.cacheTimeInHrs*h:h,this.createTime=Date.now(),e.titlesServiceUrl}return Promise.reject(`Error while fetching discovery environment info: ${o.status}`)}}catch(e){return Promise.reject(`discovery environment info failed, ${null==e?void 0:e.message}`)}}))}}p=f,f.cacheTimeInMs=0,f.cachedServiceUrl=void 0,f.createTime=0,f.getServiceUrl=(e,t)=>Date.now()-p.createTime<p.cacheTimeInMs&&p.cachedServiceUrl?Promise.resolve(p.cachedServiceUrl):p.getAndCacheUrlFromDiscoveryApi(e,t);class m{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.locale=null!=t?t:"en-us"}getApp(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return{titleInfo:yield this.getAppFromMOS3(e.id)}}))}getAppFromMOS3(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=new c.a(this.telemetryService,s.h.GetApp,s.g.GetAppFromMOS3);try{const n=yield f.getServiceUrl(this.tokenService,this.locale),r=null!=n?n:"https://titles.prod.mos.microsoft.com",o=yield d.getAcquisition(e,r,this.tokenService,this.locale);return t.logMetricEnd({}),o}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error: getAppDefinition failed, ${null==e?void 0:e.message}`}),Promise.reject(`getAppDefinition failed, ${null==e?void 0:e.message}`)}}))}}var v=n(298);const b=["PluginDefinitions"],y="en-us";let C,O=0;class S{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.locale=null!=t?t:y}getApp(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=yield E(e,this.tokenService,this.locale,this.telemetryService);return null!=t?t:{titleInfo:void 0}}))}}const E=(e,t,n,r)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){return null==C?yield x(t,n,r):Date.now()-O>36e5&&x(t,n,r),yield I(e.id)})),x=(e,t,n)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){var r;const o=new c.a(n,s.h.GetUserConfig,s.g.GetUserConfigFrom3S),i={};try{const n=yield e.getToken({resource:"https://substrate.office.com/search"});if(n&&(null==n?void 0:n.authToken)){const e={method:"POST",headers:{Authorization:`Bearer ${n.authToken}`,"Content-Type":"application/json","Accept-Language":null!=t?t:y},body:JSON.stringify({RequestedConfigTypes:b,Scenario:{Name:"sydney"},TextDecorations:"Off",TimeZone:"UTC",Culture:null!=t?t:y})},a=yield fetch("https://substrate.office.com/search/api/v1/userconfig".toString(),e);if(i[s.l.HttpStatusCode]=null==a?void 0:a.status,a.ok&&200===a.status){const e=yield a.json();o.logMetricEnd({props:i});const t=w(null===(r=e.PluginDefinitionResponse)||void 0===r?void 0:r.Plugins);if(t)return O=Date.now(),C=t,t}return o.logMetricEndWithError({props:i}),Promise.reject(`Error while fetching userConfig: ${a.status}`)}}catch(e){return o.logMetricEndWithError({props:i,diagnosticsData:`Error: getUserConfig failed, ${null==e?void 0:e.message}`}),Promise.reject(`getUserConfig failed, ${null==e?void 0:e.message}`)}})),I=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){if(C){const t=C.find((t=>t.appId===e));return Promise.resolve({titleInfo:t})}return Promise.reject(`couldn't find app with id, ${e}`)})),w=e=>Array.isArray(e)?e.map((e=>w(e))):null!=e&&e.constructor===Object?Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[Object(v.camelCase)(n)]:w(e[n])})),{}):e;var T=n(2174),k=n(1464),j=n(1116)},1783:function(e,t,n){"use strict";n.r(t),n.d(t,"createFluentComponentStyles",(function(){return r.a})),n.d(t,"createFluentStyleOverridesProvider",(function(){return r.b})),n.d(t,"createComponentStyles",(function(){return d})),n.d(t,"createStyleOverridesProvider",(function(){return p})),n.d(t,"shorthands",(function(){return g.a}));var r=n(1778),o=n(2),i=n(1);var a=n(1611),s=n(139),l=n(1543),c=n(65),u={context:Object(a.a)([],"ComponentStylingFluentOverrides"),version:"fluentCompat",makeStyles:function(e){var t={};return Object.keys(e).forEach((function(n){var r=n,o=e[r];t[r]="function"==typeof o?o(s.a):o})),Object(l.a)(t)},mergeClasses:c.a},d=function(e,t){return function(e,t,n){var r=e.makeStyles(n);function a(){var n=r(),a=i.useContext(e.context).map((function(e){return e[t]})).filter(Boolean);if(a.length>0){var s=a.map((function(e){return e()})),l={};return Object.keys(n).forEach((function(t){l[t]=e.mergeClasses.apply(e,Object(o.__spreadArray)([n[t]],Object(o.__read)(s.map((function(e){return e[t]}))),!1))})),l}return n}return a.componentName=t,a.__version=e.version,a}(u,e,t)},p=function(e){return function(e,t){var n,r,a={};try{for(var s=Object(o.__values)(Object.keys(t)),l=s.next();!l.done;l=s.next()){var c=l.value,u=t[c];u&&(a[c]=e.makeStyles(u))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}var d=e.context,p=d.Consumer,g=d.Provider;return function(e){var t=e.children;return i.createElement(p,null,(function(e){var n=Object(o.__spreadArray)([a],Object(o.__read)(e),!1);return i.createElement(g,{value:n},t)}))}}(u,e)},g=n(335)},1784:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(2),o=n(391),i=n(472),a=n(2062),s=n(2063),l=n(2061),c=n(143),u=n(144),d=n(133),p=n(1159),g=n(1155),h=function(){function e(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}return e.prototype.add=function(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)},e.prototype.getAverages=function(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}},e}(),f=function(){function e(e,t){this.finals=new h,this.partials=new h,this.getNow=Date.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=null!=t?t:Date.now}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),e.prototype.getChunk=function(e){return this.list[e]},e.prototype.track=function(e,t,n){var r={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:n},o=this.list.length-1;if(-1===o||r.audioStart>=this.list[o].audioEnd)this.list.push(r);else if(r.audioEnd<=this.list[0].audioStart)this.list.unshift(r);else{for(;o>0&&r.audioEnd<this.list[o].audioStart;)o--;if(o>=0&&r.audioStart===this.list[o].audioStart)throw new Error("Why are we double tracking the same chunk of audio? newChunk: ".concat(JSON.stringify(r),", existing chunk: ").concat(JSON.stringify(this.list[o])));this.list.splice(o,0,r)}if(this.list.length>this.maxListLength){var i=this.list.length-this.maxListLength;this.list.splice(0,i),c.a.sendTraceTag(523568153,u.a.msoulscat_Wac_Dictation,d.a.Warning,"AudioStreamPerfTracker.track: list length has exceeded max by ".concat(i," items!"))}else this.list.length>=this.warnListLength&&c.a.sendTraceTag(523568154,u.a.msoulscat_Wac_Dictation,d.a.Warning,"AudioStreamPerfTracker.track: list length: ".concat(this.list.length," approaching max: ").concat(this.maxListLength))},e.prototype.trimBefore=function(e){if(0!==this.list.length){for(var t="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),n=0;n<this.list.length&&this.list[n].audioEnd<e;)n++;n===this.list.length&&c.a.sendTraceTag(523568156,u.a.msoulscat_Wac_Dictation,d.a.Warning,"AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ".concat(e,". List length: ").concat(this.list.length,", audio span: ").concat(t));var r=this.list.splice(0,n),o=r.length>0?"".concat(r[0].audioStart," to ").concat(r[r.length-1].audioEnd):"none",i=this.list.length>0?"".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd):"none";c.a.sendTraceTag(523568157,u.a.msoulscat_Wac_Dictation,d.a.Info,"AudioStreamPerfTracker.trimBefore: audioEnd: ".concat(e,", culling ").concat(r.length," chunks (audio span ").concat(o,"), new list.length: ").concat(this.list.length,". Audio span was: ").concat(t,", now: ").concat(i))}else c.a.sendTraceTag(523568155,u.a.msoulscat_Wac_Dictation,d.a.Info,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!")},e.prototype.getChunksFrom=function(e,t){for(var n,r,o=e+t,i=0;i<this.list.length&&(!n||!r);){var a=this.list[i];!n&&e>=a.audioStart&&e<=a.audioEnd&&(n=a),!r&&o>=a.audioStart&&o<=a.audioEnd&&(r=a),i++}return[n,r]},e.prototype.measureLatency=function(e,t,n){var r=this.getNow(),o=e+t,i=this.getChunksFrom(e,t),a=i[0],s=i[1];if(!a&&!s)return c.a.sendTraceTag(523568158,u.a.msoulscat_Wac_Dictation,d.a.Warning,"AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ".concat(o," (").concat(e," + ").concat(t,")")),{service:-1,perceived:-1};if(!a||!s){var l=a?"end":"start",p="none",g=NaN;this.list.length>0&&(p="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),g=a?o-this.list[this.list.length-1].audioEnd:o-this.list[0].audioStart),c.a.sendTraceTag(523568159,u.a.msoulscat_Wac_Dictation,d.a.Warning,"AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ".concat(l," of audio, for speechEnd: ").concat(o," (").concat(e," + ").concat(t,"), tracked audio span: ").concat(p,", delta: ").concat(g))}var h=r-Math.max((null==a?void 0:a.localEnd)||0,(null==s?void 0:s.localEnd)||0),f=a?this.getLatencyForChunk(a,e,t,r):-1,m=s?this.getLatencyForChunk(s,o,0,r):-1,v={service:h,perceived:Math.max(f,m)};return(n?this.finals:this.partials).add(v),v},e.prototype.getLatencyForChunk=function(e,t,n,r){return r-(e.localEnd-(e.audioEnd-t))-n},e}(),m=n(1544),v=function(){return Object(g.a)("Microsoft.Office.WordOnline.DictationUserPerceivedLatencies",!0)||Object(g.a)("Microsoft.Office.OneNoteOnline.DictationUserPerceivedLatencies",!0)};function b(e,t){return new Promise((function(n,r){t.decodeAudioData(e,n,r)}))}var y=function(){function e(e,t,n,r,o,i,l){void 0===n&&(n=!1),void 0===i&&(i=a.a.Dictation),this.audioContext=null,this.microphoneSessionState=null,this.responseVersion=s.c.version2,this.fileBytes=null,this._wavFileAudioChunkSize=16e3,this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,this.resolveSendVoiceTilesUsingVoicePacketsPromise=null,l&&(this.augloopSessionUtil=new m.a(l)),this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,v()?(this.audioPerfTracker=new f(1e3),o&&(this.sessionTelemetry=o,o.audioPerfTracker=this.audioPerfTracker)):o&&(this.sessionTelemetry=o),r&&(this.commandTelemetry=r),this.speechToTextProfile=i}return e.prototype.startVoiceSessionFromMicrophoneInput=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,[4,this.startAudioCaptureAsync((function(t){if(!a.endVoiceSessionCalled){e&&e(t.inputBuffer);var r,s=a.audioContext?a.audioContext.sampleRate:t.inputBuffer.sampleRate,c=Object(i.c)(t.inputBuffer.getChannelData(0),s);if(r=a.augloopSessionUtil?a.augloopSessionUtil.submitVoiceTile(c,i.b,a.useFrontdoorWorkflow,l.a.dictationSettings,a.responseVersion,a.speechToTextProfile,a.sessionTelemetry,null==n?void 0:n.getCommandSet()):o.i(a.runtimeManager,c,i.b,a.useFrontdoorWorkflow,l.a.dictationSettings,a.responseVersion,a.speechToTextProfile,a.sessionTelemetry,null==n?void 0:n.getCommandSet()),v()){var u=1e3*t.inputBuffer.duration;a.totalAudioInputDurationMs+=u,a.audioPerfTracker.track(a.totalAudioInputDurationMs,u,r.seq)}a.fdSpeechClientObserver.onAudioData&&a.fdSpeechClientObserver.onAudioData(new Int16Array(c.buffer))}}),t).catch((function(e){return Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))},e.prototype.sendVoiceTilesUsingVoicePackets=function(e,t){var n=this;return new Promise((function(a,s){return Object(r.__awaiter)(n,void 0,void 0,(function(){var n,c,u,d,p,g,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:r.trys.push([0,4,,5]),null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&s(new Error("Please finish sending an audio file (i.e. call endVoiceSession) before sending another one.")),this.resolveSendVoiceTilesUsingVoicePacketsPromise=a,n=this._wavFileAudioChunkSize,c=0,u=n,d=!1,r.label=1;case 1:return c<e.byteLength?this.endVoiceSessionCalled?[3,3]:(p=e.slice(c,u),g=new DataView(p),this.augloopSessionUtil?this.augloopSessionUtil.submitVoiceTile(g,i.b,this.useFrontdoorWorkflow,l.a.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry):o.i(this.runtimeManager,g,i.b,this.useFrontdoorWorkflow,l.a.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry),h=t&&t.audioFileStreamDelay||300,[4,this.wait(+h)]):[3,3];case 2:return r.sent(),d?[3,3]:(c=u,(u+=n)>e.byteLength&&(u=e.byteLength,d=!0),[3,1]);case 3:return null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null),[3,5];case 4:return f=r.sent(),s(f),[3,5];case 5:return[2]}}))}))}))},e.prototype.resendFileFromTimeOffset=function(e,t){if(!this.fileBytes)throw new Error("Can't resend a file if startVoiceSessionFromAudioFile (or equivalent) has not been called.");if(!this.endVoiceSessionCalled||null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise)throw new Error("Can't resend a file when we are currently sending one. End the voice session first.");var n=e/1e3*i.b*(i.a/8),r=t?t/1e3*i.b*(i.a/8):void 0;return this.fileBytes=this.fileBytes.slice(n,r),this.endVoiceSessionCalled=!1,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)},e.prototype.startVoiceSessionFromAudioFileFromServer=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.fileBytes=e,[2,this.sendVoiceTilesUsingVoicePackets(this.fileBytes,t)]}))}))},e.prototype.readAndSendFile=function(e,t,n){var o=this;void 0===t&&(t=!1);var a=new FileReader,s=new Promise((function(e,s){a.onload=function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){var o,l,c,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,4,,5]),this.fileBytes=a.result,!t)return[3,2];if(o=Date.now(),null==(l=new OfflineAudioContext(1,1,i.b)).decodeAudioData)throw new Error("Browser does not support decodeAudioData");return[4,b(this.fileBytes,l)];case 1:c=r.sent(),this.fileBytes=Object(i.c)(c.getChannelData(0),i.b).buffer,u=c.duration,n&&n(Date.now()-o,u),r.label=2;case 2:return[4,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)];case 3:return r.sent(),e(),[3,5];case 4:return d=r.sent(),s(d),[3,5];case 5:return[2]}}))}))},a.onabort=function(){s(new Error("Aborted fileReader"))},a.onerror=function(){s(a.error)}}));return a.readAsArrayBuffer(e),s},e.prototype.startVoiceSessionFromAudioFile=function(e,t,n){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),[2,this.readAndSendFile(e,t,n)]}))}))},e.prototype.stopVoiceSession=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.stopMicrophoneInputAsync()];case 1:return e.sent(),this.endVoiceSession(),[2]}}))}))},e.prototype.endVoiceSession=function(){this.augloopSessionUtil?this.augloopSessionUtil.endAudioProcessor(this.useFrontdoorWorkflow,l.a.dictationSettings,this.sessionTelemetry):o.c(this.runtimeManager,this.useFrontdoorWorkflow,l.a.dictationSettings,this.sessionTelemetry),this.endVoiceSessionCalled=!0,null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)},e.prototype.stopMicrophoneInputAsync=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:if(this.microphoneSessionState&&(this.microphoneSessionState.mediaStream.getAudioTracks().map((function(e){e.stop()})),this.microphoneSessionState=null),!this.audioContext||"closed"===this.audioContext.state)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.audioContext.close()];case 2:return t.sent(),[3,4];case 3:if(e=t.sent(),c.a.sendTraceTag(528871704,u.a.msoulscat_Wac_Dictation,d.a.Warning,"Error closing audioContext: ".concat(e)),"InvalidStateError"!==e.name)throw e;return[3,4];case 4:return[2]}}))}))},e.prototype.startAudioCaptureAsync=function(e,t){var n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l,g,h,f,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=Date.now(),a=!1,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,this.createAudioContextAndMicrophoneSessionState(t)];case 2:return s=r.sent(),l=s.context,g=s.sessionState,a=!0,null===(n=this.sessionTelemetry)||void 0===n||n.setRecordingStartTime(Date.now()),null===(o=this.commandTelemetry)||void 0===o||o.setRecordingStartTime(Date.now()),this.endVoiceSessionCalled?[3,5]:(this.audioContext=l,this.microphoneSessionState=g,g.processor.onaudioprocess=e,g.source.connect(g.processor),g.processor.connect(l.destination),window.self.document.hasFocus()?[3,4]:[4,this.waitForWindowFocus(20)]);case 3:r.sent(),r.label=4;case 4:return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),[3,6];case 5:c.a.sendTraceTag(573391628,u.a.msoulscat_Wac_Dictation,d.a.Warning,"Audio Capture is cancelled due to VoiceSession closed"),r.label=6;case 6:return[3,9];case 7:return h=r.sent(),f=this.parseMicrophoneErrorMessage(h),this.fdSpeechClientObserver.onError(f),f===p.a.ErrorAudioCaptureAsync?[2,Promise.reject(h)]:[2,Promise.reject(f)];case 8:return m=Date.now()-i,c.a.sendTraceTag(589886626,u.a.msoulscat_Wac_Dictation,d.a.Info,"Mic enablement - success: ".concat(a,", duration: ").concat(m)),[7];case 9:return[2]}}))}))},e.prototype.waitForWindowFocus=function(e){void 0===e&&(e=20);var t=Date.now(),n=e;return new Promise((function(e,r){var o=function(){if(n-=1,window.self.document.hasFocus()||n<0){var r=Date.now()-t;c.a.sendTraceTag(553747910,u.a.msoulscat_Wac_Dictation,d.a.Info,"waitForWindowFocus duration: ".concat(r,", count: ").concat(n,", window has focus: ").concat(window.self.document.hasFocus())),e()}else setTimeout(o,50)};o()}))},e.prototype.parseMicrophoneErrorMessage=function(e){var t=Object(o.h)(e);return t.startsWith("NotAllowedError")||t.endsWith("PermissionDeniedError")||t.startsWith("PermissionDeniedError")?p.a.ErrorAudioPermissionDeniedError:t.endsWith("NotFoundError")||t.startsWith("NotFoundError")||t.startsWith("DevicesNotFoundError")?p.a.ErrorAudioDevicesNotFoundError:t.endsWith("MediaDeviceNotSupported")||t.startsWith("NotSupportedError")||t.startsWith("NotReadableError")||t.startsWith("TrackStartError")?p.a.ErrorAudioNotReadableError:(c.a.sendTraceTag(538481308,u.a.msoulscat_Wac_Dictation,d.a.Error,"Unexpected microphone error: ".concat(t," (").concat(null==e?void 0:e.name,"-").concat(null==e?void 0:e.message,")")),p.a.ErrorAudioCaptureAsync)},e.prototype.wait=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},e.prototype.createAudioContextAndMicrophoneSessionState=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return r.trys.push([1,,3,4]),t=window.setTimeout((function(){t=0,s.fdSpeechClientObserver.showPermissionPrompt&&s.fdSpeechClientObserver.showPermissionPrompt()}),2e3),n=!e||{deviceId:e},[4,navigator.mediaDevices.getUserMedia({audio:n})];case 2:return o=r.sent(),null===(i=window.AudioContext||window.webkitAudioContext)?[2,Promise.reject("Browser doesn't support AudioContext")]:[2,{context:a=new i,sessionState:{mediaStream:o,source:a.createMediaStreamSource(o),processor:a.createScriptProcessor(16384,1,1)}}];case 3:return t>0&&window.clearTimeout(t),[7];case 4:return[2]}}))}))},e}()},1785:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(1),i=function(e,t){return o.createElement("img",Object(r.__assign)({},t))}},1786:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=function(){function e(){this._observedElements=new Map}return e.prototype.getResizeObserver=function(){var e=this;return this._resizeObserver||(this._resizeObserver=new ResizeObserver((function(t){return e.resizeObserverCallback(t)}))),this._resizeObserver},e.prototype.resizeObserverCallback=function(e){var t,n;try{for(var o=Object(r.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value,s=this._observedElements.get(a.target);s&&s(a.target,{left:a.contentRect.left,top:a.contentRect.top,width:a.contentRect.width,height:a.contentRect.height})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.observe=function(e,t){this.unobserve(e),this._observedElements.set(e,t),this.getResizeObserver().observe(e)},e.prototype.unobserve=function(e){var t=this.getResizeObserver();this._observedElements.has(e)&&(this._observedElements.delete(e),t.unobserve(e))},e.prototype.disconnect=function(){this.getResizeObserver().disconnect(),this._observedElements.clear()},e.prototype.setResizeObserver=function(e){this._resizeObserver!==e&&(this._resizeObserver&&this._resizeObserver.disconnect(),this._resizeObserver=e)},e}()},181:function(e,t,n){"use strict";n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"d",(function(){return C})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"b",(function(){return I})),n.d(t,"f",(function(){return w}));var r=n(2),o=n(1),i=n(675),a=n(28),s=n(1457),l=n(1120),c=n(307),u=n(1785),d=n(32),p=n(161),g=n(175),h=n(147),f=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:a.B.Validation,source:e,event:t,message:n})},e}(),m=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._shouldFallback=!1,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.actionExecuted=function(e){},t.prototype.getDefaultSerializationContext=function(){return new E},t.prototype.mediaPlaybackStarted=function(e){this.onMediaPlaybackStarted?this.onMediaPlaybackStarted(e):this.parent&&this.parent.mediaPlaybackStarted(e)},t.prototype.getAdditionalPropertyDescriptors=function(e){return[{name:"type",valueType:"string",requiredValue:this.getJsonTypeName(),isArray:!1},{name:"requires",valueType:"object",description:'Keys are capability names and values are versions in the format "1.0" or "*" for any version',isArray:!1}]},t.prototype.getSerializationContext=function(){var e;return null!==(e=this._serializationContext)&&void 0!==e?e:this.getDefaultSerializationContext()},t.prototype.setSerializationContext=function(e){this._serializationContext=e},t.prototype.localizeString=function(e,t){var n;return this.onLocalizeString?n=this.onLocalizeString(e.key,t):this.parent&&(n=this.parent.localizeString(e,t)),void 0===n?Object(h.e)(e.defaultValue,t):n},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(p.a.allowPreProcessingPropertyValues){for(var r=this;r&&!r.onPreProcessPropertyValue;)r=r.parent;if(r&&r.onPreProcessPropertyValue)return r.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.hasAsParent=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,a.A.DuplicateId,g.a.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.isAtTheVeryLeft=function(){return!1},t.prototype.isAtTheVeryRight=function(){return!1},t.prototype.isAtTheVeryTop=function(){return!1},t.prototype.isAtTheVeryBottom=function(){return!1},t.prototype.isDesignMode=function(){return this.hostConfig.designMode},t.prototype.validateProperties=function(){var e=new f;return this.internalValidateProperties(e),e},t.prototype.releaseDOMResources=function(){},t.prototype.updateActionsEnabledState=function(){},t.prototype.updateLayout=function(e){void 0===e&&(e=!1)},t.prototype.renderAnchor=function(e,t){return this.parent?this.parent.renderAnchor(e,t):function(e,t){return o.createElement("a",t,null!=e?e:t.href)}(e,t)},t.prototype.renderImage=function(e,t){return this.parent?this.parent.renderImage(e,t):Object(u.a)(e,t)},t.prototype.formatDate=function(e){return this.parent?this.parent.formatDate(e):e.toLocaleDateString(void 0,{dateStyle:"long"})},t.prototype.processUrl=function(e){return!!this.parent&&this.parent.processUrl(e)},t.prototype.dataQuery=function(e){return!!this.parent&&this.parent.dataQuery(e)},Object.defineProperty(t.prototype,"groupId",{get:function(){return this._groupId?this._groupId:this.parent?this.parent.groupId:void 0},set:function(e){this._groupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent&&this.parent.isInSubCard},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.idProperty=new d.n(d.s.v1_0,"id"),t.requiresProperty=new d.l(d.s.v1_2,"requires",(function(e){return new l.a}),!1,new l.a),t}(d.o),v=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.Render=function(e){return t._state=o.useState(0),o.useEffect((function(){return t.mounted(),function(){t._state=void 0,t.unmounted()}}),[]),t.render(e.args)},t}return Object(r.__extends)(t,e),t.prototype.invalidate=function(){this._state&&this._state[1]((function(e){return e+1}))},t.prototype.afterParse=function(){e.prototype.afterParse.call(this),this.invalidate()},t.prototype.propertyChanged=function(t,n){e.prototype.propertyChanged.call(this,t,n),this.invalidate()},t.prototype.mounted=function(){},t.prototype.unmounted=function(){},t.prototype.updateLayout=function(t){void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),this.invalidate()},Object.defineProperty(t.prototype,"hasBeenRendered",{get:function(){return void 0!==this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){},enumerable:!1,configurable:!0}),t}(m);function b(e,t,n,i,s){if(t.spacing>0){var l=Object(h.b)();l.className=e.makeCssClassName("ac-".concat(n===a.p.Horizontal?"horizontal":"vertical","-separator")),l["aria-hidden"]=!0,l.style.overflow="hidden",l.style.flex="0 0 auto";var c=t.lineColor?Object(h.l)(t.lineColor):"";return n===a.p.Horizontal?(t.lineThickness?(l.style.paddingTop="".concat(t.spacing/2,"px"),l.style.marginBottom="".concat(t.spacing/2,"px"),l.style.borderBottom="".concat(t.lineThickness,"px solid ").concat(c)):l.style.height="".concat(t.spacing,"px"),l.style.marginLeft=i.margin.left,l.style.marginRight=i.margin.right):t.lineThickness?(l.style.paddingLeft="".concat(t.spacing/2,"px"),l.style.marginRight="".concat(t.spacing/2,"px"),l.style.borderRight="".concat(t.lineThickness,"px solid ").concat(c)):l.style.width="".concat(t.spacing,"px"),o.createElement("div",Object(r.__assign)({},l,{ref:s}))}return null}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];return"string"==typeof r?p.e.parse(r):this.defaultValue},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toString():void 0,void 0,!0)},t.prototype.getDescriptor=function(e){var t=Object(i.a)(a.j),n=Object(r.__spreadArray)([],Object(r.__read)(t),!1);return t.forEach((function(e){n.push("atLeast:".concat(e),"atMost:".concat(e))})),{valueType:"string",values:n,defaultValue:void 0!==this.defaultValue?a.j[this.defaultValue]:void 0,isArray:!1}},t}(d.i),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.getValue(t.spacingProperty)},set:function(e){this.setValue(t.spacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this.getValue(t.separatorProperty)},set:function(e){this.setValue(t.separatorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getValue(t.heightProperty)},set:function(e){this.setValue(t.heightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.getRootElement().updateLayout(),this.elementVisibilityChanged(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.createPlaceholderElement=function(e){var t=this.getEffectiveStyleDefinition(),n=Object(h.l)(t.foregroundColors.default.subtle);return o.createElement("div",{style:{border:"1px dashed "+n,padding:"4px",minHeight:"32px",fontSize:"10px",color:n}},e)},t.prototype.providesDesignModeElement=function(){return!1},t.prototype.getSeparatorColor=function(e){var t=null!=e?e:this.getEffectiveStyleDefinition();return this.separator?p.a.useBorderColorForSeparator?t.borderColor:this.hostConfig.separator.lineColor:void 0},t.prototype.getAttachableProperties=function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAttachableProperties.call(this,t)),!1),Object(r.__read)(t.getAttachableElementProperties()),!1)},t.prototype.render=function(e){var t=this,n=this.isVisible||this.isDesignMode()?this.internalRender(e):null,i=null,a=!this.parent||this.parent.allowSpaceBetweenElements;if(n&&this.hasVisibleSeparator&&a){var s={padding:{},margin:{}};this.getSeparatorSpacings(s),i=b(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.getSeparatorColor()},this.separatorOrientation,s,this.isDesignMode()?function(e){return t._renderedSeparatorElement=null!=e?e:void 0}:void 0)}if(this.isDesignMode()&&this.isStandalone&&!this.providesDesignModeElement()){var l=Object(r.__assign)({},null==n?void 0:n.props.style);return this.adjustSize(l),o.createElement(o.Fragment,null,i,o.createElement("div",{style:l,ref:function(e){return t._renderedElement=null!=e?e:void 0}},n))}return(null==n?void 0:n.props.style)&&this.adjustSize(n.props.style),o.createElement(o.Fragment,null,i,n)},t.prototype.elementVisibilityChanged=function(e){this.getRootElement().elementVisibilityChanged(e)},t.prototype.adjustSize=function(e){"auto"===this.height?e.flex="0 0 auto":e.flex="1 1 auto"},t.prototype.getSpacings=function(e){},t.prototype.getSeparatorSpacings=function(e){if(this.separatorOrientation===a.p.Horizontal)if(p.a.alwaysBleedSeparators&&!this.isBleeding()){var t=new p.b;this.getImmediateSurroundingPadding(t);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t);e.margin.left=-n.left,e.margin.right=-n.right}else e.margin.right=0,e.margin.left=0},t.prototype.getDefaultPadding=function(){return new p.b},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.p.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return a.f.Default},enumerable:!1,configurable:!0}),t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getImmediateSurroundingPadding=function(e,t,n,r,o){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.parent){var i=t&&this.parent.isTopElement(this),s=n&&this.parent.isRightMostElement(this),l=r&&this.parent.isBottomElement(this),c=o&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(i&&u.top!==a.t.None&&(e.top=u.top,i=!1),s&&u.right!==a.t.None&&(e.right=u.right,s=!1),l&&u.bottom!==a.t.None&&(e.bottom=u.bottom,l=!1),c&&u.left!==a.t.None&&(e.left=u.left,c=!1)),(i||s||l||c)&&this.parent.getImmediateSurroundingPadding(e,i,s,l,c)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(g.a.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.updateActionsEnabledState=function(){var e,t,n=this.getRootElement().getAllActions();try{for(var o=Object(r.__values)(n),i=o.next();!i.done;i=o.next()){i.value.updateEnabledState()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.prototype.indexOf=function(e){return-1},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isResponsive=function(){return void 0!==this.targetWidth},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():a.i.Left},t.prototype.focusFirstFocusableElement=function(){var e,t,n,o,i=this.getAllInputs(!0);try{for(var a=Object(r.__values)(i),s=a.next();!s.done;s=a.next()){if(s.value.focus())return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}var l=this.getAllActions();try{for(var c=Object(r.__values)(l),u=c.next();!u.done;u=c.next()){return!!u.value.focus()}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return!1},t.prototype.shouldRender=function(e){return this.isDesignMode()||this.isVisible&&this.shouldRenderForTargetWidth(e)},t.prototype.shouldRenderForTargetWidth=function(e){var t=null!=e?e:this.hostWidth;return void 0===this.targetWidth||this.targetWidth.matches(t)},t.prototype.removeItem=function(e){return!1},t.prototype.remove=function(){return!!this.parent&&this.parent.removeItem(this)},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowChildContainersToBleed",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostWidth",{get:function(){return void 0!==this._hostWidth?this._hostWidth:this.parent?this.parent.hostWidth:a.j.Wide},set:function(e){this._hostWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:c.b},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme?this._theme:this.parent?this.parent.theme:a.y.Light},set:function(e){this._theme=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return void 0!==this._isEnabled?this._isEnabled:!this.parent||this.parent.isEnabled},set:function(e){this._isEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandableInlineElement",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!this.isInline&&(!!this.parent&&(!this.parent.isFirstElement(this)&&this.shouldRender()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedSeparatorElement",{get:function(){return this._renderedSeparatorElement},enumerable:!1,configurable:!0}),t.langProperty=new d.n(d.s.v1_1,"lang",/^[a-z]{2,3}$/gi),t.isVisibleProperty=new d.b(d.s.v1_2,"isVisible",!0),t.separatorProperty=new d.b(d.s.v1_0,"separator",!1),t.heightProperty=new d.q(d.s.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new d.e(d.s.v1_0,"horizontalAlignment",a.i),t.spacingProperty=new d.e(d.s.v1_0,"spacing",a.t,a.t.Default),t.targetWidthProperty=new y(d.s.v1_0,"targetWidth"),t}(v),O=function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:["auto","none"],isArray:!1}},t}(d.i),S=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._isFocusable=!0,t.state=a.b.Normal,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUrl",{get:function(){return this.getValue(t.iconUrlProperty)},set:function(e){this.setValue(t.iconUrlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.getValue(t.modeProperty)},set:function(e){this.setValue(t.modeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.getValue(t.tooltipProperty)},set:function(e){this.setValue(t.tooltipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.getValue(t.isEnabledProperty)},set:function(e){this.setValue(t.isEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderTitle=function(){var e,t=this._actionButton&&null!==(e=this._actionButton.renderTitle(this.title))&&void 0!==e?e:void 0;if(t)return t;if(this.title){var n=this.hostConfig,r=Object(h.b)();return r.style.overflow="hidden",r.style.textOverflow="ellipsis",n.actions.iconPlacement===a.c.AboveTitle||n.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),o.createElement(o.Fragment,{key:"title"},o.createElement("div",r,this.title))}return null},t.prototype.renderIcon=function(){var e=null;if(this.iconUrl){var t=this.iconUrl.match(/^icon:([\w\d_-]+)(?:,(regular|filled)){0,1}$/i);if(t){if(p.a.enableIconSupportForActionButtons){var n=void 0!==t[2]&&"filled"===t[2].toLowerCase()?a.l.Filled:a.l.Regular;e=o.createElement(s.a,{name:t[1],iconSize:a.k.Small,iconStyle:n,showPlaceholder:!1,allowFallback:!1})}}else{var r=this.hostConfig,i={style:{}};i.src=this.iconUrl,i.style.width="".concat(r.actions.iconSize,"px"),i.style.height="".concat(r.actions.iconSize,"px"),i.style.flex="0 0 auto",r.actions.iconPlacement!==a.c.AboveTitle&&(i.style.maxHeight="100%"),e=this.renderImage({allowExpand:!1,isSelectable:!1},i)}}return o.createElement(o.Fragment,{key:"icon"},e)},t.prototype.renderButtonContent=function(e,t){void 0===t&&(t=!0);var n,i=this.hostConfig,s=Object(h.b)();switch(s.className="ac-pushButton-content",s.style.display="flex",s.style.gap="6px",s.style.alignItems="center",t&&(s.style.justifyContent="center"),s.style.minWidth="0",this.iconUrl?e?(Object(h.a)(s,"iconOnly"),n=[this.renderIcon()]):(i.actions.iconPlacement===a.c.AboveTitle?(Object(h.a)(s,"iconAbove"),s.style.flexDirection="column"):Object(h.a)(s,"iconLeft"),n=[this.renderIcon(),this.renderTitle()]):(Object(h.a)(s,"noIcon"),n=[this.renderTitle()]),i.actions.actionsOrientation===a.p.Horizontal&&i.actions.actionAlignment===a.a.Stretch?s.style.flex="0 1 100%":s.style.flex="0 1 auto",this.state){case a.b.Normal:break;case a.b.Expanded:Object(h.a)(s,i.makeCssClassName("expanded"));break;case a.b.Subdued:Object(h.a)(s,i.makeCssClassName("subdued"))}return this.style&&this.isEffectivelyEnabled()&&(this.style===a.e.Positive?h.a.apply(void 0,Object(r.__spreadArray)([s],Object(r.__read)(i.makeCssClassNames("primary","style-positive")),!1)):h.a.apply(void 0,Object(r.__spreadArray)([s],Object(r.__read)(i.makeCssClassNames("style-".concat(this.style.toLowerCase()))),!1))),this.isExpandable&&(Object(h.a)(s,this.hostConfig.makeCssClassName("expandable")),s["aria-expanded"]=this.state===a.b.Expanded),o.createElement("div",Object(r.__assign)({},s),n)},t.prototype.getButtonMenuItems=function(){},t.prototype.getAriaControlsAttribute=function(){},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t,n,o=[];if(e)try{for(var i=Object(r.__values)(Object.keys(e)),a=i.next();!a.done;a=i.next()){var s=e[a.value];s.validateValue()||o.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.getEffectiveTooltip=function(){return this.tooltip||this.hostConfig.actions.defaultActionTooltip},t.prototype.internalExecute=function(){this._owner&&this._owner.actionExecuted(this),this.prepareForExecution()&&(this.onExecute&&this.onExecute(this),this.getRootObject().actionExecuted(this)),this.internalAfterExecute()},t.prototype.internalAfterExecute=function(){this.getRootObject().updateActionsEnabledState()},t.prototype.render=function(e){var t=this,n={};this.setupElementForAccessibility(n);var r=!!e&&e.isInline,o={forcePrimary:!1,renderedContent:this.renderButtonContent(r),isInline:r,onClick:function(e){t.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.execute())}};return!this._actionButton&&w.actionButtonRenderer&&(this._actionButton=new w.actionButtonRenderer(this,this.getButtonMenuItems())),this._actionButton?this._actionButton.render(n,o):null},Object.defineProperty(t.prototype,"domElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.tabIndex=this.isEffectivelyEnabled()?0:-1,e.role=this.getAriaRole(),this.isEffectivelyEnabled()?n&&Object(h.a)(e,this.hostConfig.makeCssClassName("ac-selectable")):(e.disabled=!0,e["aria-disabled"]=!0),e["aria-label"]=this.title,e["aria-controls"]=this.getAriaControlsAttribute(),e.title=this.title;var r=this.getEffectiveTooltip();r&&(e[t?this.title?"aria-describedby":"aria-label":"aria-describedby"]=r,e.title=r)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new E)},t.prototype.execute=function(e){var t=this;null!=e&&null!=e&&e>0?(this._executeTimer&&clearTimeout(this._executeTimer),this._executeTimer=setTimeout((function(){return t.internalExecute()}),e)):this.internalExecute()},t.prototype.focus=function(){var e;return!(!this._isFocusable||!(null===(e=this._actionButton)||void 0===e?void 0:e.domElement))&&(this._actionButton.domElement.focus(),!0)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1)},t.prototype.collapse=function(){},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.asMenuItem=function(e){var t=this;return{key:e,text:this.title,tooltip:this.getEffectiveTooltip(),disabled:!this.isEffectivelyEnabled(),iconUrl:this.iconUrl,renderedContent:this.renderButtonContent(!1,!1),onClick:function(){t.execute()}}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getElementById=function(e){},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.getInlineContent=function(){},t.prototype.hasResponsiveElements=function(){return!1},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled&&(!this.parent||this.parent.isEnabled)},t.prototype.shouldRaiseOnExecuteEvent=function(){return!0},t.prototype.remove=function(){return!!this._owner&&this._owner.removeAction(this)},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===a.e.Positive},set:function(e){e?this.style=a.e.Positive:this.style===a.e.Positive&&(this.style=a.e.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:c.b},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.parent?this.parent.theme:a.y.Light},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this.state===a.b.Expanded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtRootLevel",{get:function(){var e;return!(null===(e=this.parent)||void 0===e?void 0:e.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.titleProperty=new d.n(d.s.v1_0,"title"),t.iconUrlProperty=new d.n(d.s.v1_1,"iconUrl"),t.styleProperty=new d.q(d.s.v1_2,"style",[{value:a.e.Default},{value:a.e.Positive},{value:a.e.Destructive}],a.e.Default),t.modeProperty=new d.q(d.s.v1_5,"mode",[{value:a.d.Primary},{value:a.d.Secondary}],a.d.Primary),t.tooltipProperty=new d.n(d.s.v1_5,"tooltip"),t.isEnabledProperty=new d.b(d.s.v1_5,"isEnabled",!0),t}(v),E=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._forbiddenTypes=new Set,t}return Object(r.__extends)(t,e),t.prototype.internalParseCardObject=function(e,t,n,r,o,i){var s,l=this;if(t&&"object"==typeof t){var c=new Set;this._forbiddenTypes.forEach((function(e){c.add(e)})),n.forEach((function(e){l._forbiddenTypes.add(e)}));var u=Object(h.k)(t.type);if(u)if(this._forbiddenTypes.has(u))i(u,a.z.ForbiddenType);else{var d=!1;if((s=o(u))?(s.setParent(e),s.parse(t,this),d=p.a.enableFallback&&r&&s.shouldFallback()):(d=p.a.enableFallback&&r,i(u,a.z.UnknownType)),d){var g=t.fallback;void 0===g&&e&&e.setShouldFallback(!0),s="string"==typeof g&&"drop"===g.toLowerCase()?void 0:"object"==typeof g?this.internalParseCardObject(e,g,n,!0,o,i):void 0}}this._forbiddenTypes=c}return s},t.prototype.cardObjectParsed=function(e,t){e instanceof S&&this.onParseAction?this.onParseAction(e,t,this):e instanceof C&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof S?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof C)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,r,o,i){var a=new Set(n),s=this.internalParseCardObject(e,t,a,r,o,i);return void 0!==s&&this.cardObjectParsed(s,t),s},t.prototype.parseElement=function(e,n,r,o){var i=this;return this.parseCardObject(e,n,r,o,(function(e){var r=e===t.componentTypeName&&"name"in n&&"string"==typeof n.name?"".concat(e,".").concat(n.name):e;return i.elementRegistry.createInstance({context:i,typeName:r,payload:n,targetVersion:i.targetVersion})}),(function(e,t){t===a.z.UnknownType?i.logParseEvent(void 0,a.A.UnknownElementType,g.a.errors.unknownElementType(e)):i.logParseEvent(void 0,a.A.ElementTypeNotAllowed,g.a.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,r){var o=this;return this.parseCardObject(e,t,n,r,(function(e){return o.actionRegistry.createInstance({context:o,typeName:e,payload:t,targetVersion:o.targetVersion})}),(function(e,t){t===a.z.UnknownType?o.logParseEvent(void 0,a.A.UnknownActionType,g.a.errors.unknownActionType(e)):o.logParseEvent(void 0,a.A.ActionTypeNotAllowed,g.a.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:w.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:w.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t.prototype.getAttachableElementProperties=function(){return this.elementRegistry.getAttachableProperties()},t.prototype.getAttachableElementProperty=function(e){return this.elementRegistry.getAttachableProperty(e)},t.componentTypeName="Component",t}(d.a),x=function(){function e(){this._items={},this._attachableProperties=new Map}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){var t,n,o,i,a=Object.keys(this._items);try{for(var s=Object(r.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=this._items[c];e.register(u.typeName,u.createInstance,u.schemaVersion)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var d=Object(r.__values)(this._attachableProperties),p=d.next();!p.done;p=d.next()){var g=Object(r.__read)(p.value,2)[1];e.registerAttachableProperty(g)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}},e.prototype.register=function(e,t,n){void 0===n&&(n=d.s.v1_0);var r=this.findByName(e);void 0!==r?r.createInstance=t:r={typeName:e,createInstance:t,schemaVersion:n},this._items[e]=r},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.registerAttachableProperty=function(e){this._attachableProperties.set(e.name,e)},e.prototype.unregisterAttachableProperty=function(e){this._attachableProperties.delete(e)},e.prototype.getAttachableProperty=function(e){return this._attachableProperties.get(e)},e.prototype.getAttachableProperties=function(){return Array.from(this._attachableProperties.values())},e.prototype.createInstance=function(e){var t=this.findByName(e.typeName);return t&&t.schemaVersion.compareTo(e.targetVersion)<=0?t.createInstance(e):void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}(),I=function(){function e(e,t){this.action=e,this.menuItems=t}return e.prototype.renderTitle=function(e){return null},e}(),w=function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new x,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new x,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new x,e.defaultActions=new x,e}()},1811:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Result="result",e.Error="error"}(r||(r={}))},1828:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var r=t;null!=(n=this._regularExpression.exec(t));)r=r.replace(n[0],this.internalFormat(e,n));return r}return t},e}(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),r=void 0!==t[2]?t[2].toLowerCase():"compact";return"compact"!==r?n.toLocaleDateString(e,{day:"numeric",weekday:r,month:r,year:"numeric"}):n.toLocaleDateString()},t}(o),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(o);function s(e,t){var n,o,s=[new i(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],l=t;try{for(var c=Object(r.__values)(s),u=c.next();!u.done;u=c.next()){l=u.value.format(e,l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return l}},188:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return x})),n.d(t,"c",(function(){return I})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return k}));var r,o=n(2),i=n(1),a=n(28),s=n(32),l=n(181),c=n(161),u=n(147),d=n(175),p=n(1786),g=n(1071),h=function(e){function t(t,n,r,o){var i=e.call(this,t,n,[{value:a.f.Default},{value:a.f.Emphasis},{targetVersion:s.s.v1_2,value:a.f.Accent},{targetVersion:s.s.v1_2,value:a.f.Good},{targetVersion:s.s.v1_2,value:a.f.Attention},{targetVersion:s.s.v1_2,value:a.f.Warning}],r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(o.__extends)(t,e),t}(s.q),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"type",valueType:"string",isArray:!1,requiredValue:this.getSchemaKey()}],!1)},t.prototype.renderItem=function(e,t){return i.createElement(t.Render,{key:t.key})},t.prototype.isResponsive=function(){return void 0!==this.targetWidth},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!0},enumerable:!1,configurable:!0}),t.targetWidthProperty=new l.h(s.s.v1_5,"targetWidth"),t}(s.j),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getSchemaKey=function(){return t.jsonTypeName},t.prototype.apply=function(e,t){switch(t.style.display="flex",t.style.flexDirection="column",e.getEffectiveVerticalContentAlignment()){case a.C.Center:t.style.justifyContent="center";break;case a.C.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}},t.jsonTypeName="Layout.Stack",t}(f),v=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o}return Object(o.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=Object(o.__values)(s),u=l.next();!u.done;u=l.next()){var d=u.value;try{a.push(c.c.parse(d))}catch(e){"auto"!==d&&"stretch"!==d||a.push(d)}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return a},t.prototype.toJSON=function(e,t,n,r){var i,s,l=[];if(Array.isArray(n))try{for(var u=Object(o.__values)(n),d=u.next();!d.done;d=u.next()){var p=d.value;p instanceof c.c?p.unit===a.s.Pixel?l.push("".concat(p.physicalSize,"px")):l.push(p.physicalSize):"auto"!==p&&"stretch"!==p||l.push(p)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:["number","string"],isArray:!0}},t}(s.i),b=new s.n(s.s.v1_5,"grid.area"),y=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.nameProperty)},set:function(e){this.setValue(t.nameProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.getValue(t.columnProperty)},set:function(e){this.setValue(t.columnProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return this.getValue(t.columnSpanProperty)},set:function(e){this.setValue(t.columnSpanProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this.getValue(t.rowProperty)},set:function(e){this.setValue(t.rowProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return this.getValue(t.rowSpanProperty)},set:function(e){this.setValue(t.rowSpanProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return t.jsonTypeName},t.jsonTypeName="GridArea",t.nameProperty=new s.n(s.s.v1_5,"name"),t.columnProperty=new s.g(s.s.v1_5,"column",1),t.columnSpanProperty=new s.g(s.s.v1_5,"columnSpan",1),t.rowProperty=new s.g(s.s.v1_5,"row",1),t.rowSpanProperty=new s.g(s.s.v1_5,"rowSpan",1),t}(s.j),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"columns",{get:function(){return this.getValue(t.columnsProperty)},set:function(e){this.setValue(t.columnsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"areas",{get:function(){return this.getValue(t.areasProperty)},set:function(e){this.setValue(t.areasProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpacing",{get:function(){return this.getValue(t.columnSpacingProperty)},set:function(e){this.setValue(t.columnSpacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpacing",{get:function(){return this.getValue(t.rowSpacingProperty)},set:function(e){this.setValue(t.rowSpacingProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return t.jsonTypeName},t.prototype.getEffectiveAreas=function(){return 0===this.areas.length?[t.defaultArea]:this.areas},t.prototype.apply=function(e,n){var r,i,s,l;n.style.display="grid",n.style.columnGap=e.hostConfig.getEffectiveSpacing(this.columnSpacing)+"px",n.style.rowGap=e.hostConfig.getEffectiveSpacing(this.rowSpacing)+"px";var c=this.columns.map((function(e){return"auto"===e?e:e.physicalSize<=0?"auto":e.unit===a.s.Pixel?"minmax(0, ".concat(e.physicalSize,"px)"):"minmax(0, ".concat(Math.min(100,e.physicalSize),"%)")})),u=this.getEffectiveAreas(),d=1;u.forEach((function(e){var t=e.row+e.rowSpan-1;t>d&&(d=t)}));for(var p=[],g=0;g<d;g++)p.push(new Array(c.length).fill(t.defaultArea.name));try{for(var h=Object(o.__values)(u),f=h.next();!f.done;f=h.next()){var m=f.value;if(m.name){var v=m.row-1,b=v+m.rowSpan,y=m.column-1,C=y+m.columnSpan;for(g=v;g<b;g++)for(var O=y;O<C;O++)p[g][O]=m.name}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}var S="";try{for(var E=Object(o.__values)(p),x=E.next();!x.done;x=E.next()){var I=x.value;S+='"'.concat(I.join(" "),'"\n')}}catch(e){s={error:e}}finally{try{x&&!x.done&&(l=E.return)&&l.call(E)}finally{if(s)throw s.error}}n.style.gridTemplateColumns=c.join(" "),n.style.gridTemplateAreas=S},t.prototype.renderItem=function(e,t){var n,r=this.getEffectiveAreas(),o=t.getValue(b),a=null!==(n=this.areas.find((function(e){return e.name===o})))&&void 0!==n?n:r[0];return i.createElement("div",{style:{overflow:"hidden",display:"flex",flexDirection:"column",gridArea:a.name},key:t.key},i.createElement(t.Render,null))},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!1},enumerable:!1,configurable:!0}),t.defaultArea=new y("."),t.jsonTypeName="Layout.AreaGrid",t.columnsProperty=new v(s.s.v1_5,"columns",[]),t.areasProperty=new s.k(s.s.v1_5,"areas",(function(){return new y})),t.columnSpacingProperty=new s.e(s.s.v1_5,"columnSpacing",a.t,a.t.Default),t.rowSpacingProperty=new s.e(s.s.v1_5,"rowSpacing",a.t,a.t.Default),t}(f);!function(e){e[e.Fit=0]="Fit",e[e.Fill=1]="Fill"}(r||(r={}));var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalItemsAlignment",{get:function(){return this.getValue(t.horizontalItemsAlignmentProperty)},set:function(e){this.setValue(t.horizontalItemsAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemFit",{get:function(){return this.getValue(t.itemFitProperty)},set:function(e){this.setValue(t.itemFitProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minItemWidth",{get:function(){return this.getValue(t.minItemWidthProperty)},set:function(e){this.setValue(t.minItemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxItemWidth",{get:function(){return this.getValue(t.maxItemWidthProperty)},set:function(e){this.setValue(t.maxItemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemWidth",{get:function(){return this.getValue(t.itemWidthProperty)},set:function(e){this.setValue(t.itemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpacing",{get:function(){return this.getValue(t.columnSpacingProperty)},set:function(e){this.setValue(t.columnSpacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpacing",{get:function(){return this.getValue(t.rowSpacingProperty)},set:function(e){this.setValue(t.rowSpacingProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return t.jsonTypeName},t.prototype.renderItem=function(e,t){var n,o=Math.max(this.minItemWidth,0),a=void 0!==this.maxItemWidth&&this.maxItemWidth>o?this.maxItemWidth:void 0,s=void 0!==this.itemWidth&&this.itemWidth>o?this.itemWidth:void 0,l=this.minItemWidth?"calc(min(".concat(o,"px, 100%))"):"0";if(this.itemFit===r.Fill)n="1 1 auto";else n=void 0;return i.createElement("div",{style:{minWidth:l,maxWidth:a?"".concat(a,"px"):void 0,width:s?"".concat(s,"px"):void 0,overflow:"hidden",flex:n,display:"flex",flexDirection:"column"},key:t.key},i.createElement(t.Render,null))},t.prototype.apply=function(e,t){switch(t.style.display="flex",t.style.flexWrap="wrap",t.style.justifyContent="center",t.style.columnGap=e.hostConfig.getEffectiveSpacing(this.columnSpacing)+"px",t.style.rowGap=e.hostConfig.getEffectiveSpacing(this.rowSpacing)+"px",e.getEffectiveVerticalContentAlignment()){case a.C.Center:t.style.alignContent="center";break;case a.C.Bottom:t.style.alignContent="flex-end";break;default:t.style.alignContent="flex-start"}switch(this.horizontalItemsAlignment){case a.i.Center:t.style.justifyContent="center";break;case a.i.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!1},enumerable:!1,configurable:!0}),t.jsonTypeName="Layout.Flow",t.horizontalItemsAlignmentProperty=new s.e(s.s.v1_5,"horizontalItemsAlignment",a.i,a.i.Center),t.itemFitProperty=new s.e(s.s.v1_5,"itemFit",r,r.Fit),t.minItemWidthProperty=new s.h(s.s.v1_5,"minItemWidth",0),t.maxItemWidthProperty=new s.h(s.s.v1_5,"maxItemWidth"),t.itemWidthProperty=new s.h(s.s.v1_5,"itemWidth"),t.columnSpacingProperty=new s.e(s.s.v1_5,"columnSpacing",a.t,a.t.Default),t.rowSpacingProperty=new s.e(s.s.v1_5,"rowSpacing",a.t,a.t.Default),t}(f),S=new Map([[m.jsonTypeName,function(){return new m}],[O.jsonTypeName,function(){return new O}],[C.jsonTypeName,function(){return new C}]]),E=function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}return Object(o.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=Object(o.__values)(s),c=l.next();!c.done;c=l.next()){var u=c.value,d=S.get(u.type);if(d){var p=d();p.parse(u,n),a.push(p)}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return a.length>0?a:void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){var t,n,r=[];try{for(var i=Object(o.__values)(S.values()),a=i.next();!a.done;a=i.next()){var l=(0,a.value)(),c=new s.d(l);r.push(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{valueType:r,isArray:!0}},t}(s.i),x=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t._resizeManager=new p.a,t._isFirstRender=!0,t.enableAutomaticReflow=!1,t}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBorder",{get:function(){return this.getValue(t.showBorderProperty)},set:function(e){this.setValue(t.showBorderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundedCorners",{get:function(){return this.getValue(t.roundedCornersProperty)},set:function(e){this.setValue(t.roundedCornersProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layouts",{get:function(){return this.getValue(t.layoutsProperty)},set:function(e){this.setValue(t.layoutsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isResizeTracked",{get:function(){return this.enableAutomaticReflow&&this.isResponsive()},enumerable:!1,configurable:!0}),t.prototype.onRef=function(e){var t=this;this.resizeManager.disconnect(),this.isResizeTracked?(this._domElement=null!=e?e:void 0,this._domElement&&this.enableAutomaticReflow&&this.resizeManager.observe(this._domElement,(function(e,n){var r=t._isFirstRender,o=t.hostConfig.getHostWidthForPixelWidth(n.width);t._isFirstRender=!1,(t.hostWidth!==o||r&&c.a.allowDelayedContainerRendering)&&(t.hostWidth=o,t.updateLayout())}))):this._domElement=null!=e?e:void 0},Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),t.prototype.providesDesignModeElement=function(){return!0},t.prototype.getEffectiveLayout=function(){var e,n=this,r=null!==(e=this.layouts)&&void 0!==e?e:[],o=r.find((function(e){return!!e.targetWidth&&e.targetWidth.matches(n.hostWidth)}));return o||(o=r.find((function(e){return!e.targetWidth}))),null!=o?o:t._defaultLayout},t.prototype.applyBorder=function(e){if(this.getHasBorder()&&!this.isBleeding()){var t=this.getEffectiveStyleDefinition();t.borderColor&&(e.style.border="1px solid ".concat(Object(u.l)(t.borderColor)))}},t.prototype.applyRoundedCorners=function(e){this.getHasRoundedCorners()&&(e.style.borderRadius="".concat(this.hostConfig.roundedCornerRadius,"px"))},t.prototype.applyBackground=function(e){if(this.getHasBackground()){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(t.backgroundColor){var n=Object(u.l)(t.backgroundColor);n&&(e.style.backgroundColor=n)}}},t.prototype.getSpacings=function(t){if(e.prototype.getSpacings.call(this,t),this.getEffectivePadding()&&(t.padding=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.isBleeding()){var n=new c.b;this.getImmediateSurroundingPadding(n);var r=this.hostConfig.paddingDefinitionToSpacingDefinition(n);t.margin={right:-r.right,left:-r.left,top:this.isDesignMode()?void 0:-r.top,bottom:this.isDesignMode()?void 0:-r.bottom}}},t.prototype.getSeparatorSpacings=function(t){if(e.prototype.getSeparatorSpacings.call(this,t),this.isBleeding()){var n=new c.b;this.getImmediateSurroundingPadding(n);var r=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.separatorOrientation===a.p.Horizontal&&(t.margin.left=-r.left,t.margin.right=-r.right)}else this.separatorOrientation===a.p.Horizontal&&(t.margin.left=0,t.margin.right=0)},t.prototype.getSeparatorColor=function(t){return t||!this.parent?e.prototype.getSeparatorColor.call(this,t):e.prototype.getSeparatorColor.call(this,this.parent.getEffectiveStyleDefinition())},t.prototype.getHasBackground=function(e){void 0===e&&(e=!1);for(var n=this.parent;n;){var r=!1;if(r=!e&&(n instanceof k&&n.backgroundImage.isValid()),n instanceof t&&this.hasExplicitStyle&&(n.getEffectiveStyle()!==this.getEffectiveStyle()||r))return!0;n=n.parent}return!1},t.prototype.getHasBorder=function(){return"boolean"==typeof this.showBorder&&this.showBorder},t.prototype.getHasRoundedCorners=function(){return"boolean"==typeof this.roundedCorners&&this.roundedCorners},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new c.b(a.t.Padding,a.t.Padding,a.t.Padding,a.t.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.internalRenderActions=function(){return null},t.prototype.applyLayout=function(e){this.getEffectiveLayout().apply(this,e)},t.prototype.internalRender=function(e){var t=this,n=this.hostConfig,r=Object(u.b)();r.className=n.makeCssClassName("ac-container"),r.style.display="flex",r.style.flexDirection="column";var a=this.renderItems(),s={padding:{},margin:{}};if(this.getSpacings(s),r.style.paddingLeft=s.padding.left,r.style.paddingRight=s.padding.right,r.style.paddingTop=s.padding.top,r.style.paddingBottom=s.padding.bottom,r.style.marginLeft=s.margin.left,r.style.marginRight=s.margin.right,r.style.marginTop=s.margin.top,r.style.marginBottom=s.margin.bottom,this.applySelectAction(r),this.applyBackground(r),this.applyBorder(r),this.applyRoundedCorners(r),this.customizeProps(r),0===a.length&&!this.isDesignMode()&&!this.renderIfEmpty)return null;var l=null;a.length>0?l=this.isResizeTracked&&this._isFirstRender&&c.a.allowDelayedContainerRendering?null:a:this.isDesignMode()&&(l=this.createPlaceholderElement(this.localizeString(d.a.emptyElementText,{elementType:this.getJsonTypeName()})));var p=Object(u.b)();return p.style.flex="1",this.applyLayout(p),i.createElement("div",Object(o.__assign)({},r,{ref:this.isDesignMode()||this.isResizeTracked?function(e){return t.onRef(e)}:void 0}),i.createElement("div",Object(o.__assign)({},p),l),this.internalRenderActions())},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var r=this.getValue(t.styleProperty);void 0!==r&&(this.hostConfig.containerStyles.getStyleByName(r)||n.addFailure(this,a.A.InvalidPropertyValue,d.a.errors.invalidPropertyValue(r,"style")))},t.prototype.isResponsive=function(){var t,n;if(void 0!==this.layouts&&this.layouts.length>0)try{for(var r=Object(o.__values)(this.layouts),i=r.next();!i.done;i=r.next()){if(i.value.isResponsive())return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return e.prototype.isResponsive.call(this)},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){return a.C.Top},Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeManager",{get:function(){return this._resizeManager},enumerable:!1,configurable:!0}),t.styleProperty=new h(s.s.v1_0,"style"),t.showBorderProperty=new s.b(s.s.v1_5,"showBorder"),t.roundedCornersProperty=new s.b(s.s.v1_5,"roundedCorners"),t.layoutsProperty=new E(s.s.v1_5,"layouts"),t._defaultLayout=new m,t}(g.a),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"_bleed",{get:function(){return this.getValue(t.bleedProperty)},set:function(e){this.setValue(t.bleedProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minPixelHeight",{get:function(){return this.getValue(t.minHeightProperty)},set:function(e){this.setValue(t.minHeightProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalInsertItemAt=function(e,t,n){if(!n){if(e.parent)throw new Error(d.a.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(d.a.errors.elementTypeNotStandalone(e.getJsonTypeName()))}e.setParent(this);var r=this.getRawItems();t>=r.length||0===r.length?r.push(e):r.splice(t>=0?t:0,0,e)},t.prototype.adjustSize=function(t){e.prototype.adjustSize.call(this,t),void 0!==this.minPixelHeight&&(t.minHeight="".concat(this.minPixelHeight,"px"))},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return(!this.parent||this.parent.allowChildContainersToBleed)&&this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.addItem=function(e){this.internalInsertItemAt(e,this.getRawItems().length,!1)},t.prototype.insertItemAt=function(e,t){this.internalInsertItemAt(e,t,!1)},t.prototype.insertItemBefore=function(e,t){var n=this.getRawItems().indexOf(t);this.internalInsertItemAt(e,n,!1)},t.prototype.insertItemAfter=function(e,t){this.internalInsertItemAt(e,this.getRawItems().indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this.getRawItems(),n=t.indexOf(e);return n>=0&&(t.splice(n,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.isBleeding=function(){return(this.getHasBackground()||this.getHasBorder()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),[this.getItemsCollectionPropertyName()],!1)},t.bleedProperty=new s.b(s.s.v1_2,"bleed",!1),t.minHeightProperty=new s.h(s.s.v1_2,"minHeight"),t}(x),w=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t.isProcessed=!1,t}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this.getValue(t.fillModeProperty)},set:function(e){this.setValue(t.fillModeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{get:function(){return this.getValue(t.verticalAlignmentProperty)},set:function(e){this.setValue(t.verticalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"themedUrls",{get:function(){return this.getValue(t.themedUrlsProperty)},set:function(e){this.setValue(t.themedUrlsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.propertyChanged=function(n,r){e.prototype.propertyChanged.call(this,n,r),n===t.urlProperty&&(this.isProcessed=!1)},t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e,n){var r,i,s=this.url;if(this.themedUrls)try{for(var l=Object(o.__values)(this.themedUrls),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.url&&e.theme===u.theme){s=u.url;break}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}if(this.url){switch(n.style.backgroundImage="url('".concat(e.preProcessPropertyValue(t.urlProperty,s),"')"),this.fillMode){case a.g.Repeat:n.style.backgroundRepeat="repeat";break;case a.g.RepeatHorizontally:n.style.backgroundRepeat="repeat-x";break;case a.g.RepeatVertically:n.style.backgroundRepeat="repeat-y";break;case a.g.Cover:default:n.style.backgroundRepeat="no-repeat",n.style.backgroundSize="cover"}switch(this.horizontalAlignment){case a.i.Left:break;case a.i.Center:n.style.backgroundPositionX="center";break;case a.i.Right:n.style.backgroundPositionX="right"}switch(this.verticalAlignment){case a.C.Top:break;case a.C.Center:n.style.backgroundPositionY="center";break;case a.C.Bottom:n.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){var e,t;if(this.url)return!0;if(this.themedUrls)try{for(var n=Object(o.__values)(this.themedUrls),r=n.next();!r.done;r=n.next()){if(r.value.url)return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.urlProperty=new s.n(s.s.v1_0,"url"),t.fillModeProperty=new s.e(s.s.v1_2,"fillMode",a.g,a.g.Cover),t.horizontalAlignmentProperty=new s.e(s.s.v1_2,"horizontalAlignment",a.i,a.i.Left),t.verticalAlignmentProperty=new s.e(s.s.v1_2,"verticalAlignment",a.C,a.C.Top),t.themedUrlsProperty=new s.k(s.s.v1_5,"themedUrls",(function(e){return new T})),t}(s.j),T=function(e){function t(t,n){void 0===t&&(t=a.y.Light);var r=e.call(this)||this;return r.theme=t,r.url=n,r}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"theme",{get:function(){return this.getValue(t.themeProperty)},set:function(e){this.setValue(t.themeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"ThemedUrl"},t.themeProperty=new s.e(s.s.v1_5,"theme",a.y,a.y.Light),t.urlProperty=new s.n(s.s.v1_5,"url"),t}(s.j),k=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t._items=[],t._renderedItems=[],t}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalContentAlignment",{get:function(){return this.getValue(t.verticalContentAlignmentProperty)},set:function(e){this.setValue(t.verticalContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rtl",{get:function(){return this.getValue(t.rtlProperty)},set:function(e){this.setValue(t.rtlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxPixelHeight",{get:function(){return this.getValue(t.maxHeightProperty)},set:function(e){this.setValue(t.maxHeightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!(!this.minPixelHeight||!this.backgroundImage.isValid())},enumerable:!1,configurable:!0}),t.prototype.getRawItems=function(){return this._items},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(t){var n=this;this.backgroundImage.isValid()&&(!this.backgroundImage.isProcessed&&this.processUrl({unprocessedUrl:this.backgroundImage.url,setProcessedUrl:function(e){n.backgroundImage.url=e,n.backgroundImage.isProcessed=!0,n.updateLayout()}})||this.backgroundImage.apply(this,t));e.prototype.applyBackground.call(this,t)},t.prototype.renderItem=function(e){return this.getEffectiveLayout().renderItem(this,e)},t.prototype.renderItems=function(){var e,t,n=[];this._renderedItems=[];try{for(var r=Object(o.__values)(this._items),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.shouldRender()&&this.isElementAllowed(a)){var s=this.renderItem(a);s&&(n.push(s),this._renderedItems.push(a))}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t.dir=this.isRtl()?"rtl":"ltr"},t.prototype.getHasBackground=function(t){return void 0===t&&(t=!1),!t&&this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this,t)},t.prototype.internalParse=function(t,n){var r,i;e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var a=t[this.getItemsCollectionPropertyName()];if(Array.isArray(a))try{for(var s=Object(o.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=n.parseElement(this,c,this.forbiddenChildElements(),!this.isDesignMode());u&&this.internalInsertItemAt(u,this._items.length,!0)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);var r=this.getItemsCollectionPropertyName();n.serializeArray(t,r,this._items)},t.prototype.adjustSize=function(t){if(e.prototype.adjustSize.call(this,t),void 0!==this.maxPixelHeight){var n=void 0!==this.minPixelHeight?Math.max(this.minPixelHeight,this.maxPixelHeight):this.maxPixelHeight;t.maxHeight="".concat(n,"px"),t.overflowY="auto"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){for(var n=[],r=0;r<t.elementRegistry.getItemCount();r++){var i=t.elementRegistry.getItemAt(r),a=i.createInstance({context:t,typeName:i.typeName,targetVersion:t.targetVersion});n.push(new s.d(a))}return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getItemsCollectionPropertyName(),valueType:n.sort((function(e,t){return e.name.localeCompare(t.name)})),isArray:!0}],!1)},t.prototype.getEffectivePadding=function(){return c.a.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new c.b:e.prototype.getEffectivePadding.call(this)},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof t)return e;e=e.parent}},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;var e=this.getParentContainer();return e?e.getEffectiveVerticalContentAlignment():a.C.Top},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){var e,t;if(this._renderedItems&&this._renderedItems.length>0)try{for(var n=Object(o.__values)(this._renderedItems),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.isVisible)return i}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.getLastVisibleRenderedItem=function(){if(this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){var t,n;try{for(var r=Object(o.__values)(this._items),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.shouldRender())return a===e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!1},t.prototype.isLastElement=function(e){for(var t=this._items.length-1;t>=0;t--)if(this._items[t].shouldRender())return this._items[t]===e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n,r,i=e.prototype.getActionById.call(this,t);if(!i&&(this.selectAction&&(i=this.selectAction.getActionById(t)),!i))try{for(var a=Object(o.__values)(this._items),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.shouldRenderForTargetWidth()&&(i=l.getActionById(t)),i)break}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return this.getEffectiveLayout().allowSpaceBetweenElements},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowChildContainersToBleed",{get:function(){return this.getEffectiveLayout().allowContainersToBleed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new s.l(s.s.v1_0,"backgroundImage",(function(e){return new w})),t.verticalContentAlignmentProperty=new s.e(s.s.v1_1,"verticalContentAlignment",a.C),t.rtlProperty=new s.b(s.s.v1_0,"rtl"),t.maxHeightProperty=new s.h(s.s.v1_5,"maxHeight"),t}(I)},206:function(e,t,n){"use strict";var r;n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(r||(r={}));var o,i,a,s={Ack:"Ack",CloseEvent:"CloseEvent"};!function(e){e.Dogfood="dogfood",e.Production="production"}(o||(o={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.TestApp="TestApp"}(i||(i={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(a||(a={}));var l,c,u=function(){return"undefined"!=typeof OfficeaicopilotStrings},d=function(){return u()?OfficeaicopilotStrings.DesignerPreviewLabel:"Designer Preview"},p=function(){return u()?OfficeaicopilotStrings.ChatCardSourceStockContent:"From Microsoft 365 creative content library"},g=function(){return u()?OfficeaicopilotStrings.ChatCardSourceEnterprise:"From %s content library"},h=function(){return u()?OfficeaicopilotStrings.ChatCardSourceDALLE:"Powered by DALL-E 3"};!function(e){e.DallEImages="DallEImages",e.DesignSuggestions="DesignSuggestions"}(l||(l={})),function(e){e.Production="Production",e.Dogfood="Dogfood",e.Automation="Automation",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Other="Other"}(c||(c={}))},2060:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.generateId=function(){return e.operationId++,"AugLoopCopilotChat"+e.operationId.toString()},e.operationId=0,e}()},2080:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1624);class o extends r.a{constructor(e,t,n,r,o){super(t),this.featureFlags=e,this.locale=n,this.correlationId=r,this.themeMode=o}}},2081:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(881);const o=(e,t,n=9e4)=>new Promise(((o,i)=>{let a;"AbortController"in window&&(a=new AbortController,t.signal=a.signal);const s=window.setTimeout((()=>{a?a.abort():i(new Error("Unidentified error in fetchWithTimeout.ts"))}),n);fetch(e,t).then((e=>(null==e?void 0:e.status)&&-1!==[r.a.Ok,r.a.Created].indexOf(e.status)?o(e):i(e))).catch((e=>{i(e)})).finally((()=>{window.clearTimeout(s)}))}))},2082:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(246),i=n(2845),a=n(298);const s=["PluginDefinitions"],l="en-us";let c,u=0;class d{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.locale=null!=t?t:l}getApp(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield p(e,this.tokenService,this.locale,this.telemetryService);return null!=t?t:{titleInfo:void 0}}))}}const p=(e,t,n,o)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return null==c?yield g(t,n,o):Date.now()-u>36e5&&g(t,n,o),yield h(e.id)})),g=(e,t,n)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var r;const a=new i.a(n,o.h.GetUserConfig,o.g.GetUserConfigFrom3S),d={};try{const n=yield e.getToken({resource:"https://substrate.office.com/search"});if(n&&(null==n?void 0:n.authToken)){const e={method:"POST",headers:{Authorization:`Bearer ${n.authToken}`,"Content-Type":"application/json","Accept-Language":null!=t?t:l},body:JSON.stringify({RequestedConfigTypes:s,Scenario:{Name:"sydney"},TextDecorations:"Off",TimeZone:"UTC",Culture:null!=t?t:l})},i=yield fetch("https://substrate.office.com/search/api/v1/userconfig".toString(),e);if(d[o.l.HttpStatusCode]=null==i?void 0:i.status,i.ok&&200===i.status){const e=yield i.json();a.logMetricEnd({props:d});const t=f(null===(r=e.PluginDefinitionResponse)||void 0===r?void 0:r.Plugins);if(t)return u=Date.now(),c=t,t}return a.logMetricEndWithError({props:d}),Promise.reject(`Error while fetching userConfig: ${i.status}`)}}catch(e){return a.logMetricEndWithError({props:d,diagnosticsData:`Error: getUserConfig failed, ${null==e?void 0:e.message}`}),Promise.reject(`getUserConfig failed, ${null==e?void 0:e.message}`)}})),h=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(c){const t=c.find((t=>t.appId===e||t.titleId===e));return Promise.resolve({titleInfo:t})}return Promise.reject(`couldn't find app with id, ${e}`)})),f=e=>Array.isArray(e)?e.map((e=>f(e))):null!=e&&e.constructor===Object?Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[Object(a.camelCase)(n)]:f(e[n])})),{}):e},2083:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Success="Success",e.Failure="Failure",e.Error="Error",e.Unknown="Unknown"}(r||(r={}))},2084:function(e,t,n){"use strict";function r(e){return"teamshub"==e}n.d(t,"a",(function(){return r}))},2085:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"WebHostService",{enumerable:!0,get:function(){return r.WebHostService}});var r=n(2685)},2089:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(307);class o extends r.a{constructor(e,t,n,r,o){super(t),this.featureFlags=e,this.locale=n,this.correlationId=r,this.themeMode=o}}},2090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalizePluralWithPlaceholders=t.declareStringWithPlaceholders=t.declareString=t.lookupStringInStringProvider=t.resolveStringWithPlaceholders=t.resolveString=void 0;var r=n(1525),o=n(1746),i=n(1337),a=n(1747),s=n(2692),l=n(1522),c=/\\{\\d+\\}/g,u=(0,r.memoizeFunction)((function(e){return new RegExp("\\{".concat(e,"\\}"),"g")}));function d(e,t,n){try{return(0,i.isDevLocalization)()&&t?(0,i.doPseudoLocalization)()?function(e){var t={},n={};(e.match(/({.+?})/g)||[]).forEach((function(e,r){var o="".concat(h,"_").concat(r);t[e]=o,n[o]=e}));var r=Object.keys(t).reduce((function(e,n){return e.replace(n,t[n])}),v(e)),o=(0,s.pseudoLocalize)(r);return Object.keys(n).reduce((function(e,t){return e.replace(t,n[t])}),b(o))}(t.text):t.text:!(0,l.stringExists)(e,n)&&t?t.text:(0,l.lookUpString)(e,n)}catch(e){return(0,l.handleLocalizationError)(e,n),""}}t.resolveString=d;var p=function(e,t){return function(n){try{return e(n)}catch(e){return(0,l.handleLocalizationError)(e,t),""}}};function g(e,t,n,o){try{return(0,i.isDevLocalization)()&&t&&t.text&&!(null==o?void 0:o.alreadyPseudoLocalized)?p((function(e){return(0,i.doPseudoLocalization)()?function(e,t){var n={},o={};(0,r.keys)(t).forEach((function(e,r){var i="".concat(h,"_").concat(r);n[e]=i,o[i]=t[e]}));var i=(0,s.pseudoLocalize)(v(e.text(n)));return(0,r.keys)(o).reduce((function(e,t){return e.replace(new RegExp(y(t),"g"),o[t])}),b(i))}(t,e):t.text(e)}),n):!(0,l.stringExists)(e,n)&&t&&t.text?p(t.text,n):p((function(t){return(0,r.keys)(t).sort().reduce((function(e,n,r){var o=t[n],i=("string"==typeof o&&o||o&&o.toString&&o.toString()||"").replace(c,"");return(e||"").replace(u(r),i)}),(0,l.lookUpString)(e,n))}),n)}catch(e){return(0,l.handleLocalizationError)(e,n),function(){return""}}}t.resolveStringWithPlaceholders=g,t.lookupStringInStringProvider=function(e){return function(t){return function(n){return n?g(t,void 0,e)(n):d(t,void 0,e)}}},t.declareString=function(e,t){var n=function(n){return void 0===n&&(n=(0,o.getDefaultStringProvider)()),d(e,t,n)};return n.toString=n,n.key=e,n},t.declareStringWithPlaceholders=function(e,t){var n=function(n,r){return void 0===r&&(r=(0,o.getDefaultStringProvider)()),g(e,t,r)(n)};return n.toString=function(n){return void 0===n&&(n=(0,o.getDefaultStringProvider)()),(0,i.isDevLocalization)()&&t||!(0,l.stringExists)(e,n)&&t?(0,a.getStringDescriptionWithPlaceholders)(e,t).stringToBeLocalized:(0,l.lookUpString)(e,n)},n.key=e,n};var h="0.7059175321136157";var f="->INF::",m="".concat(h,"_-1");function v(e){return e.replace(new RegExp(f,"g"),m)}function b(e){return e.replace(new RegExp(m,"g"),f)}function y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}t.pseudoLocalizePluralWithPlaceholders=function(e,t){var n={},o={};(0,r.keys)(t).forEach((function(e,r){var i="".concat(h,"_").concat(r);n[e]=i,o[i]=t[e]}));var i=e(n);return(0,r.keys)(i).forEach((function(e){var t=(0,s.pseudoLocalize)(v(i[e]));i[e]=(0,r.keys)(o).reduce((function(e,t){return e.replace(new RegExp(y(t),"g"),o[t])}),b(t))})),i}},2093:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=void 0;var r=n(2816);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return r.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return r.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return r.toSupportedLocale}})},2094:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(181),o=n(32);class i extends r.a{get url(){return this.getValue(i.url)}set url(e){this.setValue(i.url,e)}get data(){return this.getValue(i.data)}set data(e){this.setValue(i.data,e)}getJsonTypeName(){return i.JsonTypeName}getHref(){return this.url}}i.url=new o.n(o.s.v1_0,"url"),i.data=new o.i(o.s.v1_0,"data"),i.JsonTypeName="Action.SignIn"},2101:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),o=n(147),i=n(28),a=n(175),s=n(32),l=n(693),c=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name],s=!1;if("string"!=typeof r)s=!0;else{var l=Object(o.h)(r);if(l)return l;s=!0}return s&&n.logParseEvent(e,i.A.InvalidPropertyValue,a.a.errors.invalidPropertyValue(r,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){r.serializeDate(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"string",description:'A date value in the format "YYYY-MM-DD"',isArray:!1}},t}(s.i),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return this.value?this.isValidValue(this.value):!this.isRequired},t.prototype.isValidValue=function(e){var t=!0;return this.min&&(t=t&&e>=this.min),this.max&&(t=t&&e<=this.max),t},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueAsString",{get:function(){if(void 0!==this.value)return Object(o.c)(this.value)},enumerable:!1,configurable:!0}),t.valueProperty=new c(s.s.v1_0,"value"),t.placeholderProperty=new s.n(s.s.v1_0,"placeholder"),t.minProperty=new c(s.s.v1_0,"min"),t.maxProperty=new c(s.s.v1_0,"max"),t}(l.a)},2103:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(2),o=n(32),i=n(693),a=function(e){function t(n,r){var o=e.call(this,n,r,(function(e,n,r,o){var i=r[n.name];if("string"==typeof i&&i&&t.validateTimeString(i))return i}),(function(e,t,n,r,o){o.serializeValue(n,t.name,r)}))||this;return o.targetVersion=n,o.name=r,o}return Object(r.__extends)(t,e),t.validateTimeString=function(e){return void 0===e||t.validationRegEx.test(e)},t.timeStringToDate=function(e){var n=t.validationRegEx.exec(e);if(null!==n){var r=parseInt(n[1],10),o=parseInt(n[2],10);return new Date(t.referenceDate.getFullYear(),t.referenceDate.getMonth(),t.referenceDate.getDay(),r,o,0,0)}},t.dateToTimeString=function(e){var t=e.getHours(),n=e.getMinutes();return"".concat(t<10?"0":"").concat(t,":").concat(n<10?"0":"").concat(n)},t.prototype.preProcessValue=function(e){return t.validateTimeString(e)?e:void 0},t.prototype.getDescriptor=function(e){return{valueType:"string",description:'A time value in the format "HH:MM"',isArray:!1}},t.referenceDate=new Date(1973,9,4,0,0,0,0),t.validationRegEx=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/,t}(o.c),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.valueChanged=function(t){e.prototype.valueChanged.call(this,t?a.dateToTimeString(t):void 0)},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return void 0===this.valueAsDate?!this.isRequired:this.isValidValue(this.valueAsDate)},t.prototype.isValidValue=function(e){var t="string"==typeof e?a.timeStringToDate(e):e;if(void 0===t)return!1;var n=!0;return this.minAsDate&&(n=n&&t>=this.minAsDate),this.maxAsDate&&(n=n&&t<=this.maxAsDate),n},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value===t||void 0!==t&&!this.isValidValue(t)||e.prototype.valueChanged.call(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueAsDate",{get:function(){return this.value?a.timeStringToDate(this.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minAsDate",{get:function(){return this.min?a.timeStringToDate(this.min):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxAsDate",{get:function(){return this.max?a.timeStringToDate(this.max):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new a(o.s.v1_0,"value"),t.placeholderProperty=new o.n(o.s.v1_0,"placeholder"),t.minProperty=new a(o.s.v1_0,"min"),t.maxProperty=new a(o.s.v1_0,"max"),t}(i.a)},2118:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(883);const o=(e,t,n=9e4)=>new Promise(((o,i)=>{let a;"AbortController"in window&&(a=new AbortController,t.signal=a.signal);const s=window.setTimeout((()=>{a?a.abort():i(new Error("Unidentified error in fetchWithTimeout.ts"))}),n);fetch(e,t).then((e=>(null==e?void 0:e.status)&&-1!==[r.a.Ok,r.a.Created].indexOf(e.status)?o(e):i(e))).catch((e=>{i(e)})).finally((()=>{window.clearTimeout(s)}))}))},2119:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(246),i=n(2851),a=n(298);const s=["PluginDefinitions"],l="en-us";let c,u=0;class d{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.locale=null!=t?t:l}getApp(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield p(e,this.tokenService,this.locale,this.telemetryService);return null!=t?t:{titleInfo:void 0}}))}}const p=(e,t,n,o)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return null==c?yield g(t,n,o):Date.now()-u>36e5&&g(t,n,o),yield h(e.id)})),g=(e,t,n)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var r;const a=new i.a(n,o.h.GetUserConfig,o.g.GetUserConfigFrom3S),d={};try{const n=yield e.getToken({resource:"https://substrate.office.com/search"});if(n&&(null==n?void 0:n.authToken)){const e={method:"POST",headers:{Authorization:`Bearer ${n.authToken}`,"Content-Type":"application/json","Accept-Language":null!=t?t:l},body:JSON.stringify({RequestedConfigTypes:s,Scenario:{Name:"sydney"},TextDecorations:"Off",TimeZone:"UTC",Culture:null!=t?t:l})},i=yield fetch("https://substrate.office.com/search/api/v1/userconfig".toString(),e);if(d[o.l.HttpStatusCode]=null==i?void 0:i.status,i.ok&&200===i.status){const e=yield i.json();a.logMetricEnd({props:d});const t=f(null===(r=e.PluginDefinitionResponse)||void 0===r?void 0:r.Plugins);if(t)return u=Date.now(),c=t,t}return a.logMetricEndWithError({props:d}),Promise.reject(`Error while fetching userConfig: ${i.status}`)}}catch(e){return a.logMetricEndWithError({props:d,diagnosticsData:`Error: getUserConfig failed, ${null==e?void 0:e.message}`}),Promise.reject(`getUserConfig failed, ${null==e?void 0:e.message}`)}})),h=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(c){const t=c.find((t=>t.appId===e||t.titleId===e));return Promise.resolve({titleInfo:t})}return Promise.reject(`couldn't find app with id, ${e}`)})),f=e=>Array.isArray(e)?e.map((e=>f(e))):null!=e&&e.constructor===Object?Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[Object(a.camelCase)(n)]:f(e[n])})),{}):e},2120:function(e,t,n){"use strict";function r(e){return"teamshub"==e}n.d(t,"a",(function(){return r}))},2121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"WebHostService",{enumerable:!0,get:function(){return r.WebHostService}});var r=n(2708)},2123:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.generateId=function(){return e.operationId++,"AugLoopCopilotChat"+e.operationId.toString()},e.operationId=0,e}()},2124:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(885);const o=(e,t,n=9e4)=>new Promise(((o,i)=>{let a;"AbortController"in window&&(a=new AbortController,t.signal=a.signal);const s=window.setTimeout((()=>{a?a.abort():i(new Error("Unidentified error in fetchWithTimeout.ts"))}),n);fetch(e,t).then((e=>(null==e?void 0:e.status)&&-1!==[r.a.Ok,r.a.Created].indexOf(e.status)?o(e):i(e))).catch((e=>{i(e)})).finally((()=>{window.clearTimeout(s)}))}))},2125:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"WebHostService",{enumerable:!0,get:function(){return r.WebHostService}});var r=n(2733)},2127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDialogHeight=function(e){var t;return null!==(t=r.DIM_SIZE_MAP.height.get(e))&&void 0!==t?t:"".concat(e,"px")},t.getDialogWidth=function(e){var t;return null!==(t=r.DIM_SIZE_MAP.width.get(e))&&void 0!==t?t:"".concat(e,"px")},t.sanitizeTaskInfo=function(e){e.width=o(e.width),e.height=o(e.height),e.card&&"string"!=typeof e.card&&(e.card=JSON.stringify(e.card))};var r=n(2128);function o(e){if(!e&&"string"!=typeof e&&"number"!=typeof e)return-1;if("string"==typeof e){var t=e,n=parseInt(t);if(!isNaN(n))return n;switch(t.toLowerCase()){case"large":return-3;case"medium":return-2;default:return-1}}return e}},2128:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=t.DefaultPlaceholderImage=t.DefaultImageProxyRelativeEndpoint=t.DIM_SIZE_MAP=t.BingImageProxyEndpoint=t.BingHub=void 0;t.Resource="https://outlook.office365.com/connectors";t.DefaultPlaceholderImage="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";t.DefaultImageProxyRelativeEndpoint="/actionsb2netcore";t.BingImageProxyEndpoint="https://outlook.office.com/actionsb2netcore";t.BingHub="Orange";var r={width:new Map([[-1,"20%"],[-2,"50%"],[-3,"60%"]]),height:new Map([[-1,"20vh"],[-2,"50vh"],[-3,"66vh"]])};t.DIM_SIZE_MAP=r},2129:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){o=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new T(r||[]);return i(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,s,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,s)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function o(i,a,s,l){var c=p(e[i],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,s,l)}),(function(e){o("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return o("throw",e,s,l)}))}l(c.arg)}var a;i(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,i(C,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,s,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,r,c,u,d=l(p);function p(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(n=d.call(this)).tokenService=e,n.userInfo=t,n}return t=p,n=[{key:"acquireToken",value:(c=o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenService.getToken({resource:t,claims:n,isSilent:r});case 2:return i=e.sent,a={token:null==i?void 0:i.authToken},e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})),u=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=c.apply(e,t);function a(e){i(o,n,r,a,s,"next",e)}function s(e){i(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e,t,n){return u.apply(this,arguments)})},{key:"getUser",value:function(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}],n&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),p}(n(270).EventService);t.AuthenticationService=u},215:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(r||(r={}))},2151:function(e,t,n){"use strict";n.r(t),n.d(t,"ActivityRequestTrigger",(function(){return r.a})),n.d(t,"M365CardContentType",(function(){return r.b})),n.d(t,"BaseHostConfig",(function(){return o})),n.d(t,"SigninAction",(function(){return it})),n.d(t,"M365HostConfig",(function(){return at}));var r=n(1776);const o={choiceSetInputValueSeparator:",",supportsInteractivity:!0,fontFamily:"Segoe UI",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#E1E1E1"},fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},fontWeights:{lighter:300,default:400,bolder:500},imageSizes:{small:40,medium:160,large:320},containerStyles:{default:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F8F8F8"},accent:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#EBF6FF"},good:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F1FFF1"},warning:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF8E4"},attention:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF2F3"}},actions:{maxActions:5,spacing:"",buttonSpacing:8,showCard:{actionMode:"Inline",style:"default"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:102},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:8}};var i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D=n(2),L=n(1),M=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();!function(e){e.Default="default",e.Positive="positive",e.Destructive="destructive"}(i||(i={})),function(e){e.Primary="primary",e.Secondary="secondary"}(a||(a={})),function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(s||(s={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(l||(l={})),function(e){e[e.xxSmall=0]="xxSmall",e[e.xSmall=1]="xSmall",e[e.Small=2]="Small",e[e.Standard=3]="Standard",e[e.Medium=4]="Medium",e[e.Large=5]="Large",e[e.xLarge=6]="xLarge",e[e.xxLarge=7]="xxLarge"}(c||(c={})),function(e){e[e.Regular=0]="Regular",e[e.Filled=1]="Filled"}(u||(u={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(d||(d={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(p||(p={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(g||(g={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(h||(h={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(f||(f={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(m||(m={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(v||(v={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(b||(b={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(y||(y={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person",e[e.RoundedCorners=2]="RoundedCorners"}(C||(C={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(O||(O={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(S||(S={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(E||(E={})),function(e){e[e.Normal=0]="Normal",e[e.Expanded=1]="Expanded",e[e.Subdued=2]="Subdued"}(x||(x={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(I||(I={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(w||(w={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(T||(T={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(k||(k={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(j||(j={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(P||(P={})),function(e){e[e.VeryNarrow=0]="VeryNarrow",e[e.Narrow=1]="Narrow",e[e.Standard=2]="Standard",e[e.Wide=3]="Wide"}(A||(A={})),function(e){e[e.AtLeast=0]="AtLeast",e[e.AtMost=1]="AtMost"}(_||(_={}));var B=n(0);function R(e,t){for(var n in e){var r=parseInt(n,10);if(r>=0){var o=e[n];if(o&&"string"==typeof o&&o.toLowerCase()===t.toLowerCase())return r}}}function F(e){var t=[];for(var n in e){if(parseInt(n,10)>=0){var r=e[n];r&&"string"==typeof r&&t.push(r)}}return t}var N=function(){function e(){}return e.useMarkdownInRadioButtonAndCheckbox=!0,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!0,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!0,e.defaultUnlocalizableStringFallback="Undefined",e.allowDelayedContainerRendering=!0,e.useBorderColorForSeparator=!1,e.fluentIconCdnBasePath="https://res-1.cdn.office.net/assets/fluentui-react-icons/2.0.226/",e.enableIconSupportForActionButtons=!1,e}(),H=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r},U=function(e,t,n,r){void 0===e&&(e=f.None),void 0===t&&(t=f.None),void 0===n&&(n=f.None),void 0===r&&(r=f.None),this.top=f.None,this.right=f.None,this.bottom=f.None,this.left=f.None,this.top=e,this.right=t,this.bottom=n,this.left=r},V=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,d.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t),i=n?3:2;if(o&&o.length>=i)return r.physicalSize=parseInt(o[1],10),3===o.length&&"px"===o[2]&&(r.unit=d.Pixel),r}throw new Error("Invalid size: ".concat(t))},e}();var z,G=function(){function e(e,t){void 0===e&&(e=A.Wide),this.width=e,this.condition=t}return e.parse=function(t){var n,r,o=F(_).join("|"),i=F(A).join("|"),a=new RegExp("^(?:(".concat(o,"):)?(").concat(i,")$"),"i").exec(t);if(a&&a.length>=3){var s=new e,l=null===(n=a[1])||void 0===n?void 0:n.toLowerCase();if(void 0!==l){var c=R(_,l);if(void 0===c)return;s.condition=c}var u=null===(r=a[2])||void 0===r?void 0:r.toLowerCase();if(void 0!==u){var d=R(A,u);if(void 0===d)return;return s.width=d,s}}},e.prototype.matches=function(e){return void 0===this.condition?this.width===e:this.condition===_.AtLeast?this.width<=e:e<=this.width},e.prototype.toString=function(){return void 0!==this.condition?"".concat(_[this.condition],":").concat(A[this.width]):A[this.width]},e}(),W=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&r|128]+e.lut[r>>8&255]+"-"+e.lut[r>>16&255]+e.lut[r>>24&255]+e.lut[255&o]+e.lut[o>>8&255]+e.lut[o>>16&255]+e.lut[o>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();W.initialize();var Q=["12","16","20","24","28","32","40","48"],q=((z={})[c.xxSmall]="12",z[c.xSmall]="16",z[c.Small]="20",z[c.Standard]="24",z[c.Medium]="28",z[c.Large]="32",z[c.xLarge]="40",z[c.xxLarge]="48",z);function K(e){var t="".concat(e,"px");return L.createElement("div",{style:{width:t,height:t}})}var Y=function(e){var t=Object(D.__read)(L.useState(X.getIconOrState(e.name,e.iconSize,e.iconStyle)),2),n=t[0],r=t[1];L.useEffect((function(){"notLoaded"===n&&X.getIcon(e.name,e.iconSize,e.iconStyle).then((function(e){r(null!=e?e:"unavailable")}))}),[n,e.name,e.iconSize,e.iconStyle]);var o=q[e.iconSize];switch(n){case"notLoaded":return void 0===e.showPlaceholder||e.showPlaceholder?K(o):null;case"unavailable":return void 0===e.allowFallback||e.allowFallback?ot.imagePlaceholderRenderer?ot.imagePlaceholderRenderer({width:o+"px",height:o+"px"}):o?K(o):null:null;default:return L.createElement(n,{style:{color:e.iconColor}})}};function Z(e){return"object"==typeof e&&Q.every((function(t){return function(e){return null==e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e[t])}))}function J(e,t,n){var r,o,i={};try{for(var a=Object(D.__values)(Object.entries(t)),s=a.next();!s.done;s=a.next()){var l=Object(D.__read)(s.value,2),c=l[0],u=l[1];i[c]=Object(B.a)(e,c,u,{flipInRtl:n})}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}var X=function(){function e(){}return e.getIconFromSet=function(e,t,n){return(n===u.Regular?e.regular:e.filled)[q[t]]},e.getIcon=function(t,n,r){return Object(D.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return Object(D.__generator)(this,(function(l){switch(l.label){case 0:if(this._invalidIconNames.has(t))return[2,void 0];if(o="".concat(N.fluentIconCdnBasePath).concat(t,"/").concat(t,".json"),i=this._loadedIcons.get(t))return[3,6];l.label=1;case 1:return l.trys.push([1,5,,6]),[4,fetch(o)];case 2:return(a=l.sent()).ok?[4,a.json()]:[3,4];case 3:s=l.sent(),"object"==typeof(c=s)&&Z(c.regular)&&Z(c.filled)&&(i={regular:J(t,s.regular,s.flipInRtl),filled:J(t,s.filled,s.flipInRtl),flipInRtl:s.flipInRtl},this._loadedIcons.set(t,i)),l.label=4;case 4:return[3,6];case 5:return l.sent(),[3,6];case 6:return i?[2,e.getIconFromSet(i,n,r)]:(this._invalidIconNames.add(t),[2,void 0])}var c}))}))},e.getIconOrState=function(t,n,r){var o;if(this._invalidIconNames.has(t))return"unavailable";var i=this._loadedIcons.get(t);return i?null!==(o=e.getIconFromSet(i,n,r))&&void 0!==o?o:"unavailable":"notLoaded"},e._loadedIcons=new Map,e._invalidIconNames=new Set,e}(),$=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,r){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(r,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")}},e.hints={dontUseWeightedAndStretchedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.overflowButtonText={key:"overflowButtonText",defaultValue:"..."},e.overflowButtonTooltip={key:"overflowButtonTooltip",defaultValue:"More options"},e.mediaPlayerAriaLabel={key:"mediaPlayerAriaLabel",defaultValue:"Media content"},e.mediaPlayerPlayMedia={key:"mediaPlayerPlayMedia",defaultValue:"Play media"},e.youTubeVideoPlayer={key:"youTubeVideoPlayer",defaultValue:"YouTube video player"},e.vimeoVideoPlayer={key:"vimeoVideoPlayer",defaultValue:"Vimeo video player"},e.dailymotionVideoPlayer={key:"dailymotionVideoPlayer",defaultValue:"Dailymotion video player"},e.mediaPlayerPosterAltText={key:"mediaPlayerPosterAltText",defaultValue:"Video poster"},e.emptyElementText={key:"emptyElementText",defaultValue:"Empty {{elementType}}"},e}();function ee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e.className?e.className.split(/\s+/g):[];r.push.apply(r,Object(D.__spreadArray)([],Object(D.__read)(t),!1)),e.className=r.join(" ")}function te(e,t){return"string"==typeof e?e:t}function ne(e,t){return"number"==typeof e?e:t}function re(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t}function oe(e,t,n){for(var r=e;r.length<n;)r=t+r;return r}function ie(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255,r=parseInt(t[2],16),o=parseInt(t[3],16),i=parseInt(t[4],16);return"rgba(".concat(r,",").concat(o,",").concat(i,",").concat(n,")")}}return e}var ae=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var r=new e;r._versionString=t;var o=/(\d+).(\d+)/gi.exec(t);return null!=o&&3===o.length?(r._major=parseInt(o[1],10),r._minor=parseInt(o[2],10)):r._isValid=!1,r._isValid||n.logParseEvent(void 0,k.InvalidPropertyValue,$.errors.invalidVersionString(r._versionString)),r}},e.prototype.toString=function(){return this._isValid?"".concat(this._major,".").concat(this._minor):this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}(),se=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=[];for(var n in e)if(n.match(/^v[0-9_]*$/))try{var r=e[n];r instanceof ae&&t.push(r)}catch(e){}return t.sort((function(e,t){return e.compareTo(t)}))},e.v1_0=new ae(1,0),e.v1_1=new ae(1,1),e.v1_2=new ae(1,2),e.v1_3=new ae(1,3),e.v1_4=new ae(1,4),e.v1_5=new ae(1,5),e.v1_6=new ae(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();var le=function(){function e(e){void 0===e&&(e=se.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.serializeValue=function(e,t,n,r,o){void 0===r&&(r=void 0),void 0===o&&(o=!1),null==n||n===r?o&&delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeDate=function(e,t,n,r){var o,i,a,s;null==n||n===r?delete e[t]:e[t]=(i=(o=n).getFullYear(),a=oe((o.getMonth()+1).toString(),"0",2),s=oe(o.getDate().toString(),"0",2),"".concat(i,"-").concat(a,"-").concat(s))},e.prototype.serializeBool=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,r){null==n||isNaN(n)||n===r?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,r,o){void 0===o&&(o=void 0),null==r||r===o?delete t[n]:t[n]=e[r]},e.prototype.serializeArray=function(e,t,n){var r,o,i=[];if(n)try{for(var a=Object(D.__values)(n),s=a.next();!s.done;s=a.next()){var l=s.value,c=void 0;void 0!==(c=l instanceof be?l.toJSON(this):l.toJSON?l.toJSON():l)&&i.push(c)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}0===i.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,i)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,T.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}(),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(D.__extends)(t,e),t}(le),ue=function(){function e(t,n,r,o){this.targetVersion=t,this.name=n,this.defaultValue=r,this.onGetInitialValue=o,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)},e.prototype.preProcessValue=function(e){return e},e._sequentialNumber=0,e}(),de=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.regEx=r,a.defaultValue=o,a.onGetInitialValue=i,a}return Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=te(t[this.name],this.defaultValue);if((""===r&&(r=void 0),r&&void 0!==this.regEx)&&!this.regEx.exec(r))return void n.logParseEvent(e,k.InvalidPropertyValue,$.errors.invalidPropertyValue(r,this.name));return r},t.prototype.toJSON=function(e,t,n,r){r.serializeString(t,this.name,""===n?void 0:n,this.defaultValue)},t}(ue),pe=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){return re(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t}(ue),ge=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){return ne(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)}}(ue),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o=t[this.name];if("string"==typeof o){var i=!1;try{var a=V.parse(o,!0);a.unit===d.Pixel&&(r=a.physicalSize,i=!0)}catch(e){}i||n.logParseEvent(e,k.InvalidPropertyValue,$.errors.invalidPropertyValue(t[this.name],"minHeight"))}return r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))}}(ue),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o,i=t[this.name];if(void 0===i||!Array.isArray(i))return this.defaultValue;var a=[];try{for(var s=Object(D.__values)(i),l=s.next();!l.done;l=s.next()){var c=l.value;"string"==typeof c?a.push(c):n.logParseEvent(e,k.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(c),'" of type "').concat(typeof c,'" ignored for "').concat(this.name,'".'))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return a},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)}}(ue),function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.values=r,a.defaultValue=o,a.onGetInitialValue=i,a}return Object(D.__extends)(t,e),t.prototype.isValidValue=function(e,t){var n,r;try{for(var o=Object(D.__values)(this.values),i=o.next();!i.done;i=o.next()){var a=i.value;if(e.toLowerCase()===a.value.toLowerCase())return(a.targetVersion?a.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},t.prototype.parse=function(e,t,n){var r,o,i=t[this.name];if(void 0===i)return this.defaultValue;if("string"==typeof i)try{for(var a=Object(D.__values)(this.values),s=a.next();!s.done;s=a.next()){var l=s.value;if(i.toLowerCase()===l.value.toLowerCase()){var c=l.targetVersion?l.targetVersion:this.targetVersion;return c.compareTo(n.targetVersion)<=0?l.value:(n.logParseEvent(e,k.InvalidPropertyValue,$.errors.propertyValueNotSupported(i,this.name,c.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return n.logParseEvent(e,k.InvalidPropertyValue,$.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var o,i,a=!1;if(void 0!==n){a=!0;try{for(var s=Object(D.__values)(this.values),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.value===n){var u=c.targetVersion?c.targetVersion:this.targetVersion;if(u.compareTo(r.targetVersion)<=0){a=!1;break}r.logEvent(e,T.ToJSON,k.InvalidPropertyValue,$.errors.propertyValueNotSupported(n,this.name,u.toString(),r.targetVersion.toString()))}}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}a||r.serializeValue(t,this.name,n,this.defaultValue,!0)},t}(ue)),he=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=r,s.defaultValue=o,s.onGetInitialValue=a,s._values=[],i)s._values=i;else for(var l in r){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o,i=t[this.name];if("string"!=typeof i)return this.defaultValue;var a=R(this.enumType,i);if(void 0!==a)try{for(var s=Object(D.__values)(this.values),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.value===a){var u=c.targetVersion?c.targetVersion:this.targetVersion;return u.compareTo(n.targetVersion)<=0?a:(n.logParseEvent(e,k.InvalidPropertyValue,$.errors.propertyValueNotSupported(i,this.name,u.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return n.logParseEvent(e,k.InvalidPropertyValue,$.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var o,i,a=!1;if(void 0!==n){a=!0;try{for(var s=Object(D.__values)(this.values),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.value===n){if((c.targetVersion?c.targetVersion:this.targetVersion).compareTo(r.targetVersion)<=0){a=!1;break}r.logEvent(e,T.ToJSON,k.InvalidPropertyValue,$.errors.invalidPropertyValue(n,this.name))}}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}a||r.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(ue),fe=function(e){function t(t,n,r,o,i){void 0===o&&(o=!1);var a=e.call(this,t,n,i,(function(e){return a.nullable?void 0:a.createInstance()}))||this;return a.targetVersion=t,a.name=n,a.createInstance=r,a.nullable=o,a}return Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var o=this.createInstance(t);return o.parse(r,n),o},t.prototype.toJSON=function(e,t,n,r){var o;void 0===n||n.hasAllDefaultValues()||(o=n.toJSON(r)),"object"==typeof o&&0===Object.keys(o).length&&(o=void 0),r.serializeValue(t,this.name,o,this.defaultValue,!0)},t}(ue),me=(function(e){function t(t,n,r,o,i,a){void 0===i&&(i=!1);var s=e.call(this,t,n,o,i,a)||this;return s.targetVersion=t,s.name=n,s.objectTypeName=r,s.createInstance=o,s.nullable=i,s}Object(D.__extends)(t,e),t.prototype.parse=function(t,n,r){var o=n[this.name];if("object"==typeof o&&"type"in o&&o.type===this.objectTypeName)return e.prototype.parse.call(this,t,n,r)}}(fe),function(e){function t(t,n,r,o){var i=e.call(this,t,n,void 0,(function(e){return[]}))||this;return i.targetVersion=t,i.name=n,i.createInstance=r,i.onItemAdded=o,i}Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o,i=[],a=t[this.name];if(Array.isArray(a))try{for(var s=Object(D.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=this.createInstance(c);u&&(u.parse(c,n),i.push(u),this.onItemAdded&&this.onItemAdded(e,u))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i.length>0?i:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)}}(ue),function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,i,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=r,s.onToJSON=o,s.defaultValue=i,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,r){this.onToJSON(e,this,t,n,r)},t}(ue)),ve=function(){function e(e){this.key=e,this._properties=[]}return e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1},e.prototype.add=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var o=Object(D.__values)(n),i=o.next();!i.done;i=o.next()){var a=i.value;-1===this.indexOf(a)&&this._properties.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.remove=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var o=Object(D.__values)(n),i=o.next();!i.done;i=o.next())for(var a=i.value;;){var s=this.indexOf(a);if(!(s>=0))break;this._properties.splice(s,1)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.getItemAt=function(e){return this._properties[e]},e.prototype.getCount=function(){return this._properties.length},e}(),be=function(){function e(){this._isParsing=!1,this._propertyBag={},this._rawProperties={},this.key=e.currentKey++,this.maxVersion=e.defaultMaxVersion;for(var t=this.getSchema(),n=0;n<t.getCount();n++){var r=t.getItemAt(n);r.onGetInitialValue&&this.setValue(r,r.onGetInitialValue(this))}}return e.prototype.propertyChanged=function(e,t){this.onPropertyChanged&&this.onPropertyChanged(this,e,t)},e.prototype.afterParse=function(){},e.prototype.getDefaultSerializationContext=function(){return new ce},e.prototype.populateSchema=function(t){var n=[];for(var r in this.constructor)try{var o=this.constructor[r];o instanceof ue&&n.push(o)}catch(e){}if(n.length>0){var i=n.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,Object(D.__spreadArray)([],Object(D.__read)(i),!1))}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.internalParse=function(e,t){if(!this._isParsing){this._isParsing=!0;try{if(this._propertyBag={},this._rawProperties=N.enableFullJsonRoundTrip&&e||{},e)for(var n=this.getSchema(),r=0;r<n.getCount();r++){var o=n.getItemAt(r);if(o.isSerializationEnabled){var i=o.onGetInitialValue?o.onGetInitialValue(this):void 0;e.hasOwnProperty(o.name)&&(o.targetVersion.compareTo(t.targetVersion)<=0?i=o.parse(this,e,t):t.logParseEvent(this,k.UnsupportedProperty,$.errors.propertyNotSupported(o.name,o.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(o,i)}}else this.resetDefaultValues()}finally{this._isParsing=!1,this.afterParse()}}},e.prototype.internalToJSON=function(e,t){for(var n=this.getSchema(),r=[],o=0;o<n.getCount();o++){var i=n.getItemAt(o);i.isSerializationEnabled&&i.targetVersion.compareTo(t.targetVersion)<=0&&-1===r.indexOf(i.name)&&(i.toJSON(this,e,this.getValue(i),t),r.push(i.name))}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){var n=this,r=function(e,t){n._isParsing||n.propertyChanged(e,t)};if(null==t)this._propertyBag.hasOwnProperty(e.getInternalName())&&(delete this._propertyBag[e.getInternalName()],r(e,t));else{var o=e.preProcessValue(t);this._propertyBag[e.getInternalName()]!==o&&(this._propertyBag[e.getInternalName()]=o,r(e,o))}},e.prototype.parse=function(e,t){var n=t||this.getDefaultSerializationContext();this.internalParse(e,n),n.onAfterObjectParsed&&n.onAfterObjectParsed(this,e)},e.prototype.toJSON=function(e){var t;if(e&&e instanceof le?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t)){var n=void 0;return n=N.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0},e.prototype.resetDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new ve(this.getSchemaKey()),this.populateSchema(t),e._schemaCache[t.key]=t),t},e.currentKey=0,e.defaultMaxVersion=se.latest,e._schemaCache={},e}(),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(D.__extends)(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},t.typeNameProperty=new de(se.v1_0,"type",void 0,void 0,(function(e){return e.getJsonTypeName()})),t}(be),Ce=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t._capabilities={},t}return Object(D.__extends)(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var r in t){var o=t[r];if("string"==typeof o)if("*"===o)this.addCapability(r,"*");else{var i=ae.parse(o,n);(null==i?void 0:i.isValid)&&this.addCapability(r,i)}}},t.prototype.internalToJSON=function(t,n){for(var r in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[r]=this._capabilities[r]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(be);function Oe(e,t,n){if("string"==typeof t){var r=function(e,t,n){if(!t)return n;var r=R(e,t);return void 0!==r?r:n}(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}var Se=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}(),Ee=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t.highlightColors=new Se("#22000000","#11000000"),t}return Object(D.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(Se),xe=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)},Ie=function(){function e(t){this.imageSize=s.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=ne(t.maxImageHeight,e.defaultMaxImageHeight))}return e.prototype.toJSON=function(){return{imageSize:s[this.imageSize],maxImageHeight:this.maxImageHeight}},e.defaultMaxImageHeight=100,e}(),we=function(){function e(e){this.allowInlinePlayback=!0,this.useHTML5PlayerAsFallback=!1,this.placeholderHeights={veryNarrow:120,narrow:175,standard:250,wide:300},e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}(),Te=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}(),ke=function(){function e(e){this.size=p.Default,this.color=m.Default,this.isSubtle=!1,this.weight=g.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=Oe(p,e.size,this.size),this.color=Oe(m,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=Oe(g,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return g.Default},e.prototype.toJSON=function(){return{size:p[this.size],color:m[this.color],isSubtle:this.isSubtle,weight:g[this.weight]}},e}(),je=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t.fontType=h.Default,t}return Object(D.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=Oe(h,t.fontType,this.fontType))},t}(ke),Pe=function(){function e(e){this.default=new je,this.heading=new je({size:"Large",weight:"Bolder"}),this.columnHeader=new je({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}(),Ae=function(e){e&&(this.headingLevel=ne(e.headingLevel))},_e=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t.suffix=" *",t.suffixColor=m.Attention,t}return Object(D.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=Oe(m,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=m[this.suffixColor],t},t}(ke),De=function(e){this.inputSpacing=f.Small,this.requiredInputs=new _e,this.optionalInputs=new ke,e&&(this.inputSpacing=Oe(f,e.inputSpacing,this.inputSpacing),this.requiredInputs=new _e(e.requiredInputs),this.optionalInputs=new ke(e.optionalInputs))},Le=function(e){this.label=new De,this.errorMessage=new ke({color:m.Attention}),e&&(this.label=new De(e.label),this.errorMessage=new ke(e.errorMessage))},Me=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t.wrap=!0,t}return Object(D.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(ke),Be=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=g.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=Oe(g,t.weight,g.Bolder)),n}return Object(D.__extends)(t,e),t.prototype.getDefaultWeight=function(){return g.Bolder},t}(Me),Re=function(e){this.rowGap=10,"object"==typeof e&&(this.rowGap="number"==typeof e.rowGap?Math.max(e.rowGap,0):this.rowGap)},Fe=function(e){function t(t){var n=e.call(this,t)||this;return n.columnGap=10,"object"==typeof t&&(n.columnGap="number"==typeof t.columnGap?Math.max(t.columnGap,0):n.columnGap),n}return Object(D.__extends)(t,e),t}(Re),Ne=function(e){function t(t){var n=e.call(this,t)||this;return n.titleValueGap=0,"object"==typeof t&&(n.titleValueGap="number"==typeof t.titleValueGap?Math.max(t.titleValueGap,0):n.titleValueGap),n}return Object(D.__extends)(t,e),t}(Re),He=function(e){this.title=new Be,this.value=new Me,this.tableLayout=new Fe,this.stackLayout=new Ne,this.layoutSwitchBreakpoint=A.Standard,"object"==typeof e&&(this.title=new Be(e.title),this.value=new Me(e.value),this.tableLayout=new Fe(e.tableLayout),this.stackLayout=new Ne(e.stackLayout),this.layoutSwitchBreakpoint=Oe(A,e.layoutSwitchBreakpoint,A.Standard))},Ue=function(){function e(e){this.actionMode=O.Inline,this.inlineTopMargin=16,this.style=M.Emphasis,e&&(this.actionMode=Oe(O,e.actionMode,O.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:M.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:O[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}(),Ve=function(){function e(e){if(this.maxActions=5,this.spacing=f.Default,this.buttonSpacing=20,this.showCard=new Ue,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=S.Horizontal,this.actionAlignment=y.Left,this.iconPlacement=I.LeftOfTitle,this.allowTitleToWrap=!1,this.allowButtonsToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=Oe(f,e.spacing&&e.spacing,f.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new Ue(e.showCard),this.preExpandSingleShowCardAction=re(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=Oe(S,e.actionsOrientation,S.Horizontal),this.actionAlignment=Oe(y,e.actionAlignment,y.Left),this.iconPlacement=Oe(I,e.iconPlacement,I.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap,this.allowButtonsToWrap=null!=e.allowButtonsToWrap?e.allowButtonsToWrap:this.allowTitleToWrap;try{var t=V.parse(e.iconSize);t.unit===d.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:f[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:S[this.actionsOrientation],actionAlignment:y[this.actionAlignment]}},e}(),ze=function(){function e(e){this.default=new Ee,this.dark=new Ee,this.light=new Ee,this.accent=new Ee,this.good=new Ee,this.warning=new Ee,this.attention=new Ee,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e.prototype.getColorDefinition=function(e){switch(e){case m.Accent:return this.accent;case m.Dark:return this.dark;case m.Light:return this.light;case m.Good:return this.good;case m.Warning:return this.warning;case m.Attention:return this.attention;default:return this.default}},e}(),Ge=function(){function e(e){this.foregroundColors=new ze({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(D.__extends)(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(Ge),Qe=function(){function e(e){var t,n;if(this._allStyles={},this._allStyles[M.Default]=new We,this._allStyles[M.Emphasis]=new We,this._allStyles[M.Accent]=new We,this._allStyles[M.Good]=new We,this._allStyles[M.Attention]=new We,this._allStyles[M.Warning]=new We,e){this._allStyles[M.Default].parse(e[M.Default]),this._allStyles[M.Emphasis].parse(e[M.Emphasis]),this._allStyles[M.Accent].parse(e[M.Accent]),this._allStyles[M.Good].parse(e[M.Good]),this._allStyles[M.Attention].parse(e[M.Attention]),this._allStyles[M.Warning].parse(e[M.Warning]);var r=e.customStyles;if(r&&Array.isArray(r))try{for(var o=Object(D.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value;if(a){var s=a.name;s&&"string"==typeof s&&(this._allStyles.hasOwnProperty(s)?this._allStyles[s].parse(a.style):this._allStyles[s]=new Ge(a.style))}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[M.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[M.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[M.Emphasis]},enumerable:!1,configurable:!0}),e}(),qe=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}(),Ke=function(){function e(e){this.default=new qe,this.monospace=new qe("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case h.Monospace:return this.monospace;case h.Default:default:return this.default}},e}(),Ye=function(){function e(e){this.hostCapabilities=new Ce,this.designMode=!1,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.hostWidthBreakpoints={veryNarrow:216,narrow:345,standard:500},this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.roundedCornerRadius=6,this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new Qe,this.inputs=new Le,this.actions=new Ve,this.adaptiveCard=new xe,this.imageSet=new Ie,this.media=new we,this.factSet=new He,this.table=new Te,this.textStyles=new Pe,this.textBlock=new Ae,this.alwaysAllowBleed=!1,this._legacyFontType=new qe,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new Ke(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new Qe(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new Le(e.inputs||this.inputs),this.actions=new Ve(e.actions||this.actions),this.adaptiveCard=new xe(e.adaptiveCard||this.adaptiveCard),this.imageSet=new Ie(e.imageSet),this.factSet=new He(e.factSet),this.textStyles=new Pe(e.textStyles),this.textBlock=new Ae(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===h.Monospace?qe.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case f.Small:return this.spacing.small;case f.Default:return this.spacing.default;case f.Medium:return this.spacing.medium;case f.Large:return this.spacing.large;case f.ExtraLarge:return this.spacing.extraLarge;case f.Padding:return this.spacing.padding;default:return 0}},e.prototype.getHostWidthForPixelWidth=function(e){return e<=this.hostWidthBreakpoints.veryNarrow?A.VeryNarrow:e<=this.hostWidthBreakpoints.narrow?A.Narrow:e<=this.hostWidthBreakpoints.standard?A.Standard:A.Wide},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new H(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=[];try{for(var i=Object(D.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;o.push((this.cssClassNamePrefix?"".concat(this.cssClassNamePrefix,"-"):"")+s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return o},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,Object(D.__spreadArray)([],Object(D.__read)(e),!1)).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}(),Ze=new Ye({preExpandSingleShowCardAction:!0,supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:40,medium:80,large:160},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{borderColor:"#CCCCCC",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{borderColor:"#666666",backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:"default",buttonSpacing:10,showCard:{actionMode:"inline",inlineTopMargin:16},actionsOrientation:"horizontal",actionAlignment:"left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"medium",maxImageHeight:100},factSet:{title:{color:"default",size:"default",isSubtle:!1,weight:"bolder",wrap:!0,maxWidth:150},value:{color:"default",size:"default",isSubtle:!1,weight:"default",wrap:!0},tableLayout:{columnGap:10,rowGap:6},stackLayout:{rowGap:10},layoutSwitchBreakpoint:"standard"}}),Je=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:T.Validation,source:e,event:t,message:n})},e}(),Xe=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t._shouldFallback=!1,t}return Object(D.__extends)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.actionExecuted=function(e){},t.prototype.getDefaultSerializationContext=function(){return new nt},t.prototype.localizeString=function(e,t){var n;return this.onLocalizeString?n=this.onLocalizeString(e.key,t):this.parent&&(n=this.parent.localizeString(e,t)),void 0===n?function(e,t){return void 0===t&&(t={}),Object.entries(t).forEach((function(t){var n=Object(D.__read)(t,2),r=n[0],o=n[1],i=void 0!==o?o.toString():"";e=e.replace(new RegExp("{{".concat(r,"}}"),"g"),i)})),e}(e.defaultValue,t):n},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(N.allowPreProcessingPropertyValues){for(var r=this;r&&!r.onPreProcessPropertyValue;)r=r.parent;if(r&&r.onPreProcessPropertyValue)return r.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,k.DuplicateId,$.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.isAtTheVeryLeft=function(){return!1},t.prototype.isAtTheVeryRight=function(){return!1},t.prototype.isAtTheVeryTop=function(){return!1},t.prototype.isAtTheVeryBottom=function(){return!1},t.prototype.isDesignMode=function(){return this.hostConfig.designMode},t.prototype.validateProperties=function(){var e=new Je;return this.internalValidateProperties(e),e},t.prototype.releaseDOMResources=function(){},t.prototype.updateActionsEnabledState=function(){},t.prototype.updateLayout=function(e){void 0===e&&(e=!1)},t.prototype.renderAnchor=function(e,t){return this.parent?this.parent.renderAnchor(e,t):function(e,t){return L.createElement("a",t,null!=e?e:t.href)}(e,t)},t.prototype.renderImage=function(e,t){return this.parent?this.parent.renderImage(e,t):function(e,t){return L.createElement("img",Object(D.__assign)({},t))}(0,t)},t.prototype.formatDate=function(e){return this.parent?this.parent.formatDate(e):e.toLocaleDateString(void 0,{dateStyle:"long"})},t.prototype.processUrl=function(e){return!!this.parent&&this.parent.processUrl(e)},t.prototype.dataQuery=function(e){return!!this.parent&&this.parent.dataQuery(e)},Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent&&this.parent.isInSubCard},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.idProperty=new de(se.v1_0,"id"),t.requiresProperty=new fe(se.v1_2,"requires",(function(e){return new Ce}),!1,new Ce),t}(ye),$e=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t.Render=function(e){return t._state=L.useState(0),L.useEffect((function(){return function(){t._state=void 0}}),[]),t.render(e.args)},t}return Object(D.__extends)(t,e),t.prototype.invalidate=function(){this._state&&this._state[1]((function(e){return e+1}))},t.prototype.afterParse=function(){e.prototype.afterParse.call(this),this.invalidate()},t.prototype.propertyChanged=function(t,n){e.prototype.propertyChanged.call(this,t,n),this.invalidate()},t.prototype.updateLayout=function(t){void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),this.invalidate()},Object.defineProperty(t.prototype,"hasBeenRendered",{get:function(){return void 0!==this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){},enumerable:!1,configurable:!0}),t}(Xe);var et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(D.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.getValue(t.spacingProperty)},set:function(e){this.setValue(t.spacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this.getValue(t.separatorProperty)},set:function(e){this.setValue(t.separatorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getValue(t.heightProperty)},set:function(e){this.setValue(t.heightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.getRootElement().updateLayout(),this.elementVisibilityChanged(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.createPlaceholderElement=function(e){var t=ie(this.getEffectiveStyleDefinition().foregroundColors.default.subtle);return L.createElement("div",{style:{border:"1px dashed "+t,padding:"4px",minHeight:"32px",fontSize:"10px",color:t}},e)},t.prototype.providesDesignModeElement=function(){return!1},t.prototype.getSeparatorColor=function(e){var t=null!=e?e:this.getEffectiveStyleDefinition();return this.separator?N.useBorderColorForSeparator?t.borderColor:this.hostConfig.separator.lineColor:void 0},t.prototype.render=function(e){var t=this,n=this.isVisible||this.isDesignMode()?this.internalRender(e):null,r=null;if(n&&this.hasVisibleSeparator){var o={padding:{},margin:{}};this.getSeparatorSpacings(o),r=function(e,t,n,r,o){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var i={style:{}};i.className=e.makeCssClassName("ac-".concat(n===S.Horizontal?"horizontal":"vertical","-separator")),i["aria-hidden"]=!0,i.style.overflow="hidden",i.style.flex="0 0 auto";var a=t.lineColor?ie(t.lineColor):"";return n===S.Horizontal?(t.lineThickness?(i.style.paddingTop="".concat(t.spacing/2,"px"),i.style.marginBottom="".concat(t.spacing/2,"px"),i.style.borderBottom="".concat(t.lineThickness,"px solid ").concat(a)):i.style.height="".concat(t.spacing,"px"),i.style.marginLeft=r.margin.left,i.style.marginRight=r.margin.right):t.lineThickness?(i.style.paddingLeft="".concat(t.spacing/2,"px"),i.style.marginRight="".concat(t.spacing/2,"px"),i.style.borderRight="".concat(t.lineThickness,"px solid ").concat(a)):i.style.width="".concat(t.spacing,"px"),L.createElement("div",Object(D.__assign)({},i,{ref:o}))}return null}(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.getSeparatorColor()},this.separatorOrientation,o,this.isDesignMode()?function(e){return t._renderedSeparatorElement=null!=e?e:void 0}:void 0)}if(this.isDesignMode()&&this.isStandalone&&!this.providesDesignModeElement()){var i=Object(D.__assign)({},null==n?void 0:n.props.style);return this.adjustSize(i),L.createElement(L.Fragment,null,r,L.createElement("div",{style:i,ref:function(e){return t._renderedElement=null!=e?e:void 0}},n))}return(null==n?void 0:n.props.style)&&this.adjustSize(n.props.style),L.createElement(L.Fragment,null,r,n)},t.prototype.getDefaultSerializationContext=function(){return new nt},t.prototype.elementVisibilityChanged=function(e){this.getRootElement().elementVisibilityChanged(e)},t.prototype.adjustSize=function(e){"auto"===this.height?e.flex="0 0 auto":e.flex="1 1 auto"},t.prototype.getSpacings=function(e){},t.prototype.getSeparatorSpacings=function(e){if(this.separatorOrientation===S.Horizontal)if(N.alwaysBleedSeparators&&!this.isBleeding()){var t=new U;this.getImmediateSurroundingPadding(t);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t);e.margin.left=-n.left,e.margin.right=-n.right}else e.margin.right=0,e.margin.left=0},t.prototype.getDefaultPadding=function(){return new U},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return S.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return M.Default},enumerable:!1,configurable:!0}),t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getImmediateSurroundingPadding=function(e,t,n,r,o){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.parent){var i=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),s=r&&this.parent.isBottomElement(this),l=o&&this.parent.isLeftMostElement(this),c=this.parent.getEffectivePadding();c&&(i&&c.top!==f.None&&(e.top=c.top,i=!1),a&&c.right!==f.None&&(e.right=c.right,a=!1),s&&c.bottom!==f.None&&(e.bottom=c.bottom,s=!1),l&&c.left!==f.None&&(e.left=c.left,l=!1)),(i||a||s||l)&&this.parent.getImmediateSurroundingPadding(e,i,a,s,l)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error($.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.updateActionsEnabledState=function(){var e,t,n=this.getRootElement().getAllActions();try{for(var r=Object(D.__values)(n),o=r.next();!o.done;o=r.next()){o.value.updateEnabledState()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.indexOf=function(e){return-1},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isResponsive=function(){return void 0!==this.targetWidth},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():v.Left},t.prototype.focusFirstFocusableElement=function(){var e,t,n,r,o=this.getAllInputs(!0);try{for(var i=Object(D.__values)(o),a=i.next();!a.done;a=i.next()){if(a.value.focus())return!0}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}var s=this.getAllActions();try{for(var l=Object(D.__values)(s),c=l.next();!c.done;c=l.next()){return!!c.value.focus()}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return!1},t.prototype.shouldRender=function(e){return this.isDesignMode()||this.isVisible&&this.shouldRenderForTargetWidth(e)},t.prototype.shouldRenderForTargetWidth=function(e){var t=null!=e?e:this.hostWidth;return void 0===this.targetWidth||this.targetWidth.matches(t)},t.prototype.removeItem=function(e){return!1},t.prototype.remove=function(){return!!this.parent&&this.parent.removeItem(this)},Object.defineProperty(t.prototype,"hostWidth",{get:function(){return void 0!==this._hostWidth?this._hostWidth:this.parent?this.parent.hostWidth:A.Wide},set:function(e){this._hostWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:Ze},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme?this._theme:this.parent?this.parent.theme:P.Light},set:function(e){this._theme=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return void 0!==this._isEnabled?this._isEnabled:!this.parent||this.parent.isEnabled},set:function(e){this._isEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!this.parent&&(!this.parent.isFirstElement(this)&&this.shouldRender())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedSeparatorElement",{get:function(){return this._renderedSeparatorElement},enumerable:!1,configurable:!0}),t.langProperty=new de(se.v1_1,"lang",/^[a-z]{2,3}$/gi),t.isVisibleProperty=new pe(se.v1_2,"isVisible",!0),t.separatorProperty=new pe(se.v1_0,"separator",!1),t.heightProperty=new ge(se.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new he(se.v1_0,"horizontalAlignment",v),t.spacingProperty=new he(se.v1_0,"spacing",f,f.Default),t.targetWidthProperty=new me(se.v1_0,"targetWidth",(function(e,t,n,r){var o=n[t.name];return"string"==typeof o?G.parse(o):t.defaultValue}),(function(e,t,n,r,o){o.serializeValue(n,"targetWidth",r?r.toString():void 0,void 0,!0)})),t}($e),tt=(function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}Object(D.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n)}}(ue),function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t._isFocusable=!0,t.state=x.Normal,t}return Object(D.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUrl",{get:function(){return this.getValue(t.iconUrlProperty)},set:function(e){this.setValue(t.iconUrlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.getValue(t.modeProperty)},set:function(e){this.setValue(t.modeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.getValue(t.tooltipProperty)},set:function(e){this.setValue(t.tooltipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.getValue(t.isEnabledProperty)},set:function(e){this.setValue(t.isEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderTitle=function(){var e,t=this._actionButton&&null!==(e=this._actionButton.renderTitle(this.title))&&void 0!==e?e:void 0;if(t)return t;if(this.title){var n=this.hostConfig,r={style:{}};return r.style.overflow="hidden",r.style.textOverflow="ellipsis",n.actions.iconPlacement===I.AboveTitle||n.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),L.createElement(L.Fragment,{key:"title"},L.createElement("div",r,this.title))}return null},t.prototype.renderIcon=function(){var e=null;if(this.iconUrl){var t=this.iconUrl.match(/^icon:([\w\d_-]+)(?:,(regular|filled)){0,1}$/i);if(t){if(N.enableIconSupportForActionButtons){var n=void 0!==t[2]&&"filled"===t[2].toLowerCase()?u.Filled:u.Regular;e=L.createElement(Y,{name:t[1],iconSize:c.Small,iconStyle:n,showPlaceholder:!1,allowFallback:!1})}}else{var r=this.hostConfig,o={style:{}};o.src=this.iconUrl,o.style.width="".concat(r.actions.iconSize,"px"),o.style.height="".concat(r.actions.iconSize,"px"),o.style.flex="0 0 auto",r.actions.iconPlacement!==I.AboveTitle&&(o.style.maxHeight="100%"),e=this.renderImage({allowExpand:!1,isSelectable:!1},o)}}return L.createElement(L.Fragment,{key:"icon"},e)},t.prototype.renderButtonContent=function(e,t){void 0===t&&(t=!0);var n,r=this.hostConfig,o={style:{}};switch(o.className="ac-pushButton-content",o.style.display="flex",o.style.gap="6px",o.style.alignItems="center",t&&(o.style.justifyContent="center"),o.style.minWidth="0",this.iconUrl?e?(ee(o,"iconOnly"),n=[this.renderIcon()]):(r.actions.iconPlacement===I.AboveTitle?(ee(o,"iconAbove"),o.style.flexDirection="column"):ee(o,"iconLeft"),n=[this.renderIcon(),this.renderTitle()]):(ee(o,"noIcon"),n=[this.renderTitle()]),r.actions.actionsOrientation===S.Horizontal&&r.actions.actionAlignment===y.Stretch?o.style.flex="0 1 100%":o.style.flex="0 1 auto",this.state){case x.Normal:break;case x.Expanded:ee(o,r.makeCssClassName("expanded"));break;case x.Subdued:ee(o,r.makeCssClassName("subdued"))}return this.style&&this.isEffectivelyEnabled()&&(this.style===i.Positive?ee.apply(void 0,Object(D.__spreadArray)([o],Object(D.__read)(r.makeCssClassNames("primary","style-positive")),!1)):ee.apply(void 0,Object(D.__spreadArray)([o],Object(D.__read)(r.makeCssClassNames("style-".concat(this.style.toLowerCase()))),!1))),this.isExpandable&&(ee(o,this.hostConfig.makeCssClassName("expandable")),o["aria-expanded"]=this.state===x.Expanded),L.createElement("div",Object(D.__assign)({},o),n)},t.prototype.getButtonMenuItems=function(){},t.prototype.getAriaControlsAttribute=function(){},t.prototype.getDefaultSerializationContext=function(){return new nt},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t,n,r=[];if(e)try{for(var o=Object(D.__values)(Object.keys(e)),i=o.next();!i.done;i=o.next()){var a=e[i.value];a.validateValue()||r.push(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.getEffectiveTooltip=function(){return this.tooltip||this.hostConfig.actions.defaultActionTooltip},t.prototype.internalExecute=function(){this._owner&&this._owner.actionExecuted(this),this.prepareForExecution()&&(this.onExecute&&this.onExecute(this),this.getRootObject().actionExecuted(this)),this.internalAfterExecute()},t.prototype.internalAfterExecute=function(){this.getRootObject().updateActionsEnabledState()},t.prototype.render=function(e){var t=this,n={};this.setupElementForAccessibility(n);var r=!!e&&e.isInline,o={forcePrimary:!1,renderedContent:this.renderButtonContent(r),isInline:r,onClick:function(e){t.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.execute())}};return!this._actionButton&&ot.actionButtonRenderer&&(this._actionButton=new ot.actionButtonRenderer(this,this.getButtonMenuItems())),this._actionButton?this._actionButton.render(n,o):null},Object.defineProperty(t.prototype,"domElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t){void 0===t&&(t=!1),e.tabIndex=this.isEffectivelyEnabled()?0:-1,e.role=this.getAriaRole(),this.isEffectivelyEnabled()?ee(e,this.hostConfig.makeCssClassName("ac-selectable")):(e.disabled=!0,e["aria-disabled"]=!0),e["aria-label"]=this.title,e["aria-controls"]=this.getAriaControlsAttribute(),e.title=this.title;var n=this.getEffectiveTooltip();n&&(e[t?this.title?"aria-describedby":"aria-label":"aria-describedby"]=n,e.title=n)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new nt)},t.prototype.execute=function(e){var t=this;null!=e&&null!=e&&e>0?(this._executeTimer&&clearTimeout(this._executeTimer),this._executeTimer=setTimeout((function(){return t.internalExecute()}),e)):this.internalExecute()},t.prototype.focus=function(){var e;return!(!this._isFocusable||!(null===(e=this._actionButton)||void 0===e?void 0:e.domElement))&&(this._actionButton.domElement.focus(),!0)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1)},t.prototype.collapse=function(){},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.asMenuItem=function(e){var t=this;return{key:e,text:this.title,tooltip:this.getEffectiveTooltip(),disabled:!this.isEffectivelyEnabled(),iconUrl:this.iconUrl,renderedContent:this.renderButtonContent(!1,!1),onClick:function(){t.execute()}}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getElementById=function(e){},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.getInlineContent=function(){},t.prototype.hasResponsiveElements=function(){return!1},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled&&(!this.parent||this.parent.isEnabled)},t.prototype.shouldRaiseOnExecuteEvent=function(){return!0},t.prototype.remove=function(){return!!this._owner&&this._owner.removeAction(this)},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===i.Positive},set:function(e){e?this.style=i.Positive:this.style===i.Positive&&(this.style=i.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:Ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.parent?this.parent.theme:P.Light},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this.state===x.Expanded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtRootLevel",{get:function(){var e;return!(null===(e=this.parent)||void 0===e?void 0:e.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.titleProperty=new de(se.v1_0,"title"),t.iconUrlProperty=new de(se.v1_1,"iconUrl"),t.styleProperty=new ge(se.v1_2,"style",[{value:i.Default},{value:i.Positive},{value:i.Destructive}],i.Default),t.modeProperty=new ge(se.v1_5,"mode",[{value:a.Primary},{value:a.Secondary}],a.Primary),t.tooltipProperty=new de(se.v1_5,"tooltip"),t.isEnabledProperty=new pe(se.v1_5,"isEnabled",!0),t}($e)),nt=function(e){function t(){var t=e.apply(this,Object(D.__spreadArray)([],Object(D.__read)(arguments),!1))||this;return t._forbiddenTypes=new Set,t}return Object(D.__extends)(t,e),t.prototype.internalParseCardObject=function(e,t,n,r,o,i){var a,s=this;if(t&&"object"==typeof t){var l=new Set;this._forbiddenTypes.forEach((function(e){l.add(e)})),n.forEach((function(e){s._forbiddenTypes.add(e)}));var c=te(t.type);if(c)if(this._forbiddenTypes.has(c))i(c,j.ForbiddenType);else{var u=!1;if((a=o(c))?(a.setParent(e),a.parse(t,this),u=N.enableFallback&&r&&a.shouldFallback()):(u=N.enableFallback&&r,i(c,j.UnknownType)),u){var d=t.fallback;void 0===d&&e&&e.setShouldFallback(!0),a="string"==typeof d&&"drop"===d.toLowerCase()?void 0:"object"==typeof d?this.internalParseCardObject(e,d,n,!0,o,i):void 0}}this._forbiddenTypes=l}return a},t.prototype.cardObjectParsed=function(e,t){e instanceof tt&&this.onParseAction?this.onParseAction(e,t,this):e instanceof et&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof tt?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof et)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,r,o,i){var a=new Set(n),s=this.internalParseCardObject(e,t,a,r,o,i);return void 0!==s&&this.cardObjectParsed(s,t),s},t.prototype.parseElement=function(e,n,r,o){var i=this;return this.parseCardObject(e,n,r,o,(function(e){var r=e===t.componentTypeName&&"name"in n&&"string"==typeof n.name?"".concat(e,".").concat(n.name):e;return i.elementRegistry.createInstance({context:i,typeName:r,payload:n,targetVersion:i.targetVersion})}),(function(e,t){t===j.UnknownType?i.logParseEvent(void 0,k.UnknownElementType,$.errors.unknownElementType(e)):i.logParseEvent(void 0,k.ElementTypeNotAllowed,$.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,r){var o=this;return this.parseCardObject(e,t,n,r,(function(e){return o.actionRegistry.createInstance({context:o,typeName:e,payload:t,targetVersion:o.targetVersion})}),(function(e,t){t===j.UnknownType?o.logParseEvent(void 0,k.UnknownActionType,$.errors.unknownActionType(e)):o.logParseEvent(void 0,k.ActionTypeNotAllowed,$.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:ot.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:ot.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t.componentTypeName="Component",t}(le),rt=function(){function e(){this._items={}}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){var t,n,r=Object.keys(this._items);try{for(var o=Object(D.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value,s=this._items[a];e.register(s.typeName,s.createInstance,s.schemaVersion)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.register=function(e,t,n){void 0===n&&(n=se.v1_0);var r=this.findByName(e);void 0!==r?r.createInstance=t:r={typeName:e,createInstance:t,schemaVersion:n},this._items[e]=r},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.createInstance=function(e){var t=this.findByName(e.typeName);return t&&t.schemaVersion.compareTo(e.targetVersion)<=0?t.createInstance(e):void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}(),ot=(function(){function e(e,t){this.action=e,this.menuItems=t}e.prototype.renderTitle=function(e){return null}}(),function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new rt,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new rt,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new rt,e.defaultActions=new rt,e}());class it extends tt{get url(){return this.getValue(it.url)}set url(e){this.setValue(it.url,e)}get data(){return this.getValue(it.data)}set data(e){this.setValue(it.data,e)}getJsonTypeName(){return it.JsonTypeName}getHref(){return this.url}}it.url=new de(se.v1_0,"url"),it.data=new ue(se.v1_0,"data"),it.JsonTypeName="Action.SignIn";class at extends Ye{constructor(e,t,n,r,o){super(t),this.featureFlags=e,this.locale=n,this.correlationId=r,this.themeMode=o}}},2153:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r,o,i=n(2),a=n(478),s=n(3446),l=n(1595),c=n(2073),u=n(183),d="".concat(Object(s.a)({environment:"Prod"})).concat(l.a),p=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-nudge","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-oa-email-ecc","mc-editor-enable-meeting-banner","mc-editor-expanded-ecc-responsive","mc-editor-oa-debug"],g=function(){function e(){this.staticSettings={isAggregatedLoggingEnabled:!0,controlIconSetName:"FabricMDL2Icons",showOptionsButton:!0,synonymsEndPoint:c.b.Prod,licenseType:u.b.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:4,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,oaSettings:{isContextualCardEnabled:!0,disableInlineSuggestionTooltips:!0,mockResults:!1,e2eMetric:!0,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:!0,bestMatchConfig:{enabled:!0,maxResults:h}}},this.getFlightsToTrack=function(e,t,n){var r=Object(i.__spreadArray)([],Object(i.__read)(p),!1);return(null==n?void 0:n.length)>0&&(r=r.concat.apply(r,Object(i.__spreadArray)([],Object(i.__read)(n),!1))),(null==t?void 0:t.enableChatCIQ)&&r.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&r.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&r.push("vivatopics"),e&&r.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&r.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&r.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableMeetingBanner)&&r.push("mc-editor-enable-meeting-banner"),(null==t?void 0:t.enableSearchBar)&&(r.push("mc-editor-enable-searchbar"),r.push("mc-editor-attachbutton-searchbar-position")),r}}return e.prototype.composeSettings=function(e,t){var n,r,o,i,a,s=Object.assign({},this.staticSettings.oaSettings,{enableOaClient:null===(n=e.featureFlags)||void 0===n?void 0:n.enableHybridWorkflow,customizedEmptyECCSuggestionsString:e.customizedEmptyECCSuggestionsString,updateResultsTimeout:e.resultTime?e.resultTime:6e3,entitiesEnabled:t,scopesConfig:e.enableAutomaticScoping?{enabled:!0,maxResults:h,enableAutomaticScoping:!0}:{enabled:!0,maxResults:h,enableAutomaticScoping:!1}});return Object.assign({},this.staticSettings,{appId:e.hostAppId,flightsToTrack:this.getFlightsToTrack(!!(null===(r=e.featureFlags)||void 0===r?void 0:r.enableHybridWorkflow),e.featureFlags,e.flightsToTrack),defaultLocale:e.hostDefaultLocale,editorEndPoint:e.isDogfoodEnvironment?c.a.Lab:c.a.Prod,hostMetadata:{appName:e.hostAppName,appPlatform:e.hostAppPlatform,appScenario:e.hostAppScenario,sessionId:e.sessionId,releaseAudienceGroup:e.isDogfoodEnvironment?"Dogfood":"Production"},orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:null!==(o=e.augloopEndPoint)&&void 0!==o?o:"https://augloop-dogfood.officeppe.com",augLoopAuthTokenCallback:e.augLoopAuthTokenCallback,substrateAuthTokenCallback:e.substrateAuthTokenCallback},oaSettings:s,serviceSettings:{hybridAugloop:{enabled:!!(null===(i=e.featureFlags)||void 0===i?void 0:i.enableHybridWorkflow),enableGraphSearchLocal:!!(null===(a=e.featureFlags)||void 0===a?void 0:a.enableHybridWorkflow),wasmConfig:{binaryPath:d,scriptPath:d}}},isDarkMode:e.isDarkMode})},e}(),h=15;function f(e,t){var n=new g,r=function(e){var t=[];return e.forEach((function(n){t.push({enabled:!0,entityType:n,maxResults:1===e.length?void 0:h})})),t}(t);return n.composeSettings(e,r)}!function(e){e.ChatECCInjectionError="Chat_ECC_Injection_Error",e.CIQForcedInvokeException="CIQ_Forced_Invoke_Exception",e.CIQThemeUpdateException="CIQ_Theme_Update_Exception",e.EditorBootstrapException="Editor_Bootstrap_Exception",e.EditorShutdownException="Editor_Shutdown_Exception",e.EmailECCInjectionError="Email_ECC_Injection_Error",e.EventECCInjectionError="Event_ECC_Injection_Error",e.FileECCInjectionError="File_ECC_Injection_Error",e.PeopleECCInjectionError="People_ECC_Injection_Error",e.UnsupportedSuggestionTypeError="Unsupported_Suggestion_Type_Error"}(r||(r={})),function(e){e.EditorShutdownSuccess="Editor_Shutdown_Success",e.EditorCIQForceInvoke="Editor_CIQ_Force_Invoke",e.EditorCIQThemeUpdate="Editor_CIQ_Theme_Update",e.EditorBootstrapSuccess="Editor_Bootstrap_Success"}(o||(o={}));var m=!1;var v=function(e,t){m&&(null==t?console.log("Chat Editor log:",e):console.log("Chat Editor log:",e,t))};function b(e){var t=null==e?void 0:e.message;return void 0!==t?t:""}var y=void 0;function C(e){y&&(y.logError(e),v(e))}function O(e,t){y&&y.logErrorTelemetry&&y.logErrorTelemetry(e,t)}function S(e,t){y&&y.logSuccessTelemetry&&y.logSuccessTelemetry(e,t)}var E=n(2077),x=n(1078),I=n(2076),w=n(1),T=n.n(w),k=n(107),j=n.n(k),P=n(2795),A=function(){function e(){this.ciqId=0,this.ciqUrls=new Map,this.isHVCAppChatV2Enabled=!1,this.queryAnnotationSet=new Map}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,o,a){if(e.suggestion&&e.queryRange){++this.ciqId;var s="userCIQSelectionId-"+this.ciqId;this.ciqUrls.set(s,e.suggestion.url),this.queryAnnotationSet.set(s,e.suggestion.queryAnnotation);var l={text:e.suggestion.text,id:s,clpSensitivityIndicatorData:t,isLoading:n,copilotChatTheme:r,isDarkModeEnabled:o},c=T.a.createElement(P.a,Object(i.__assign)(Object(i.__assign)({},l),{ref:a}),null),u=document.createElement("span");if(j.a.render(c,u),e.queryRange.endContainer){var d=e.queryRange.endContainer.textContent;d&&" "===d.charAt(d.length-1)&&(e.queryRange.endContainer.textContent=d.slice(0,-1),e.queryRange.setEndAfter(e.queryRange.endContainer),e.queryRange.collapse(!1))}e.queryRange.insertNode(u),u.insertAdjacentText("beforebegin"," "),e.queryRange.collapse(!1);var p=document.createTextNode(" ");e.queryRange.insertNode(p),e.queryRange.setEndAfter(p),e.queryRange.collapse(!1);var g=window.getSelection();null==g||g.removeAllRanges(),null==g||g.addRange(e.queryRange),v("renderAndTrackSelectedSuggestion: rendered suggestion")}else v("renderAndTrackSelectedSuggestion: nothing to render")},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n;if(this.ciqUrls.size<=0)v("generatCopilotOdslSignalLinks: nothing to generate");else{var r=Object(i.__spreadArray)([],Object(i.__read)(this.ciqUrls.keys()),!1);try{for(var o=Object(i.__values)(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.querySelector("span#".concat(s))||this.ciqUrls.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}if(!(this.ciqUrls.size<=0)){for(var l=[],c=0,u=e.childNodes,d=0;d<u.length;d++){var p=u[d];if(p.nodeType===Node.ELEMENT_NODE){var g=p.childNodes[0];if(g&&g.className.includes("user-ciq-selection-id")&&g.id){var h=g.textContent.length;this.ciqUrls.has(g.id)&&l.push({type:I.a.URL,range:[c,c+h],value:this.ciqUrls.get(g.id)}),c+=h}else"BR"===p.nodeName?c++:this.isHVCAppChatV2Enabled&&"SPAN"===p.nodeName&&(c+=p.textContent.length)}else(""!=p.textContent.trim()||c>0)&&(c+=p.textContent.length)}return v("generatCopilotOdslSignalLinks: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.value,", range: [").concat(t.range[0],", ").concat(t.range[1],"]")}),""))),l}v("generatCopilotOdslSignalLinks: nothing to generate after cleanup")}},e.prototype.generateQueryAnnotations=function(e){var t,n;if(this.queryAnnotationSet.size<=0)v("generateQueryAnnotations: nothing to generate");else{var r=Object(i.__spreadArray)([],Object(i.__read)(this.queryAnnotationSet.keys()),!1);try{for(var o=Object(i.__values)(r),a=o.next();!a.done;a=o.next()){var s=a.value;e.querySelector("span#".concat(s))||this.queryAnnotationSet.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}if(!(this.queryAnnotationSet.size<=0)){for(var l=[],c=e.childNodes,u=0;u<c.length;u++){var d=c[u];if(d.nodeType===Node.ELEMENT_NODE){var p=d.childNodes[0];p&&p.className.includes("user-ciq-selection-id")&&p.id&&this.queryAnnotationSet.has(p.id)&&l.push(this.queryAnnotationSet.get(p.id))}}return v("generateQueryAnnotations: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.id,", text: ").concat(t.text)}),""))),l}v("generateQueryAnnotations: nothing to generate after cleanup")}},e.prototype.setHVCAppChatV2Enabled=function(e){this.isHVCAppChatV2Enabled=e},e}(),_={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}},D={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},L=n(2074),M=n(2075);function B(e){var t,n,o,i,a,s,l;switch(e.type){case L.a.File:return a=(d=e).FileName,i=null!==(t=d.SpoId)&&void 0!==t?t:d.AccessUrl,"DownloadableUrl"===d.AccessUrlType&&(s=d.AccessUrl),s||"DownloadableUrl"!==d.AlternateAccessUrlType||(s=d.AlternateAccessUrl),s||(s=d.AccessUrl)||(s=d.AlternateAccessUrl),s?(l={QueryAnnotationType:M.a.File,text:a,id:i},{type:L.a.File,id:i,text:a,url:s,queryAnnotation:l}):(C("File ECC injection failed due to missing AccessUrl of type ".concat(d.AccessUrlType," and missing AlternateAccessUrl of type ").concat(d.AlternateAccessUrlType)),void O(r.FileECCInjectionError,"Missing AccessUrl of type ".concat(d.AccessUrlType," and missing AlternateAccessUrl of type ").concat(d.AlternateAccessUrlType)));case L.a.People:return(null==(d=e)?void 0:d.EmailAddresses)&&d.DisplayName?(a=d.DisplayName,i=d.EmailAddresses[0],s=d.EmailAddresses[0]?"mailto:".concat(d.EmailAddresses[0]):"",l={QueryAnnotationType:M.a.People,text:a,id:i},{type:L.a.People,id:i,text:a,url:s,queryAnnotation:l}):(C("People ECC injection failed due to missing EmailAddresses or DisplayName"),void O(r.PeopleECCInjectionError,"Missing EmailAddresses or DisplayName"));case L.a.Chat:if(!(null==(d=e)?void 0:d.ThreadId))return C("Chat ECC injection failed due to missing ThreadId"),void O(r.ChatECCInjectionError,"Missing ThreadId");if(void 0!==d.Name)a=d.Name;else if(d.ChatMembers){var c=d.ChatMembers.length-2,u=d.ChatMembers.slice(0,2).map((function(e){return e.DisplayName})).join(", ");c>0&&(u+=", +".concat(c)),a=u}else a="";return i=d.ThreadId,s="",l={QueryAnnotationType:M.a.Chat,text:a,id:i},{type:L.a.Chat,id:i,text:a,url:s,queryAnnotation:l};case L.a.Message:return(null==(d=e)?void 0:d.ImmutableId)?(a=d.Subject,i=null===(n=d.ImmutableId)||void 0===n?void 0:n.Id,s="",l={QueryAnnotationType:M.a.Message,text:a,id:i},{type:L.a.Message,id:i,text:a,url:s,queryAnnotation:l}):(C("Email ECC injection failed due to missing ImmutableId"),void O(r.EmailECCInjectionError,"Missing ImmutableId"));case L.a.Event:var d;return(null==(d=e)?void 0:d.OriginalId)?(a=d.Subject,i=d.OriginalId,s=null!==(o=d.WebLink)&&void 0!==o?o:"",l={QueryAnnotationType:M.a.Event,text:a,id:i},{type:L.a.Event,id:i,text:a,url:s,queryAnnotation:l}):(C("Event ECC injection failed due to missing OriginalId"),void O(r.EventECCInjectionError,"Missing OriginalId"));default:return C("onItemSelected called with unsupported suggestion type ".concat(e.type)),void O(r.UnsupportedSuggestionTypeError,"onItemSelected called with unsupported suggestion type ".concat(e.type))}}var R=function(){function e(e){this.editorProofingNode=void 0,this.editorClient=e}return e.prototype.shutdown=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),v("Shutting down Editor"),[4,this.editorClient.shutDown()];case 1:return t.sent(),v("Shutting down Editor completed successfully"),S(o.EditorShutdownSuccess),[3,3];case 2:return e=t.sent(),C("Exception shutting down Editor:"+JSON.stringify(e)+" Error message: "+b(e)),O(r.EditorShutdownException," Error message: "+b(e)),[3,3];case 3:return this.editorClient=null,[2]}}))}))},e.prototype.initializeCiq=function(e,t){var n=this;return this.editorProofingNode&&this.uninitialize(t.queryCharToUse),v("Initializing Editor for CIQ"),this.editorProofingNode=this.editorClient.spellCheck(e,".ignore-block"),this.editorClient.enableInlineSuggestionsMenu(t.entitiesEnabled,t.queryCharToUse,(function(e,n,r){v("Suggestion selected from CIQ: "+JSON.stringify(e)+" in range: "+JSON.stringify(n)),t.onItemSelected({suggestion:B(e),queryRange:n,parentHtmlElement:r})}),void 0,void 0,{fitToContent:!0},t.ExpanededECC?D:_,void 0,void 0,void 0,void 0,t.ExpanededECC?void 0:function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){var n,r,o,a,s;return Object(i.__generator)(this,(function(l){v("".concat(null==e?void 0:e.length," suggestions found")),t.onSuggestionsUpdated&&t.onSuggestionsUpdated(e.length);try{for(n=Object(i.__values)(e),r=n.next();!r.done;r=n.next())(o=r.value).groupTitle=t.menuTitle,o.groupSubtitle=t.menuSubtitle}catch(e){a={error:e}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,e]}))}))},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.ExpanededECC),new A},e.prototype.uninitialize=function(e){this.editorProofingNode&&(v("Uninitializing Editor"),this.editorClient.disableInlineSuggestionsMenu(e),this.editorClient.detach(this.editorProofingNode),this.editorProofingNode=void 0)},e.prototype.forceInvokeCIQMenu=function(e,t){if(this.editorProofingNode)try{v("Starting to show CIQ for force invoke"),t&&this.setCurrentScope(t),this.editorClient.showExistingMenuAtCursor(1,e,!0),v("Showing CIQ for force invoke"),S(o.EditorCIQForceInvoke)}catch(e){C("Exception showing CIQ for forced invoke:"+JSON.stringify(e)+" Error message: "+b(e)),O(r.CIQForcedInvokeException," Error message: "+b(e))}},e.prototype.updateCurrentTheme=function(e){try{switch(v("Starting to update theme for CIQ to ".concat(e)),e){case x.a.light:case x.a.dark:case x.a.highContrast:case x.a.custom:this.editorClient.updateCurrentTheme(e);break;default:throw"Unexpected themeType: ".concat(e)}v("Theme updated for CIQ"),S(o.EditorCIQThemeUpdate)}catch(e){C("Exception updating theme for CIQ:"+JSON.stringify(e)+" Error message: "+b(e)),O(r.CIQThemeUpdateException," Error message: "+b(e))}},e.prototype.normalizeCIQEntity=function(e){switch(!0){case/file/i.test(e):return E.a.File;case/(people)|(person)/i.test(e):return E.a.People;case/(event)|(meeting)/i.test(e):return E.a.Event;case/chat/i.test(e):return E.a.Chat;case/(message)|(email)/i.test(e):return E.a.Message;case/(topic)/i.test(e):return E.a.Topic;default:return}},e.prototype.setCurrentScope=function(e){if(this.editorClient){var t=this.normalizeCIQEntity(e);if(void 0!==t){var n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}else v("Invoked setEntityScope with unsupported entity type ".concat(e))}},e}(),F=function(){function e(){}return e.prototype.bootstrap=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:l=e.settings.isDogfoodEnvironment,m=l,s=e.telemLogger,y=s,v("bootstrapEditor called"),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,Object(a.a)(f(e.settings,e.entitiesSupported),e.telemSink,e.augloopSession)];case 2:return[4,(t=i.sent()).initializeSDK()];case 3:return i.sent(),[4,t.initializeUX(document)];case 4:return i.sent(),this.chatEditor=new R(t),v("bootstrapEditor completed successfully"),S(o.EditorBootstrapSuccess),[3,6];case 5:throw n=i.sent(),C("Exception bootstrapping Editor:"+JSON.stringify(n)+" Error message: "+b(n)),O(r.EditorBootstrapException," Error message: "+b(n)),n;case 6:return[2,this.chatEditor]}var s,l}))}))},e.prototype.shutdown=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,this.chatEditor.shutdown()]}))}))},e}(),N=function(){function e(){}return e.prototype.createInstance=function(){return new F},e}()},2156:function(e,t,n){"use strict";n.r(t),n.d(t,"HttpStatusCode",(function(){return r.a})),n.d(t,"constantBackOff",(function(){return i})),n.d(t,"exponentialBackOff",(function(){return a})),n.d(t,"linearBackOff",(function(){return o})),n.d(t,"fetchWithRetry",(function(){return d})),n.d(t,"fetchWithTimeout",(function(){return p.a})),n.d(t,"allow",(function(){return g})),n.d(t,"blacklist",(function(){return m})),n.d(t,"block",(function(){return h})),n.d(t,"whitelist",(function(){return f}));var r=n(883);function o(e){return t=>t*e}function i(e){return t=>e}function a(e){return t=>Math.pow(2,t)*e}var s=n(2);function l(e){return new Promise((t=>setTimeout((()=>t()),e)))}function c(e,t,n){return u(e,[],t,n)}function u(e,t,n,r){let o;const i=[e(t.length).then((e=>(o=e,!1)))];return n&&n.timeoutMs>0&&i.push(l(n.timeoutMs).then((()=>!0))),Promise.race(i).then((i=>(i&&n&&(o=n.onTimeout()),!r||!r.filter(o)||t.length>=r.maxRetries?{result:o,tries:t}:l(r.backOffFn(t.length)).then((()=>(t.push(o),u(e,t,n,r)))))))}function d(e,t,n=0,o){return c((()=>Object(s.__awaiter)(this,void 0,void 0,(function*(){const n=performance.now();try{const r=yield fetch(e,t);return r.durationMs=Math.round(performance.now()-n),r}catch(e){return{status:window.navigator.onLine?r.a.FetchFailureStatusCode:r.a.OfflineFetchFailureStatusCode,ok:!1,durationMs:Math.round(performance.now()-n)}}}))),{timeoutMs:n,onTimeout:()=>({status:r.a.FetchTimeoutStatusCode,ok:!1,durationMs:n})},o)}var p=n(2118);const g=f,h=m;function f(e){return t=>!!t&&(e instanceof Array?e.includes(t.status):e.min<=e.max&&(t.status>=e.min&&t.status<=e.max))}function m(e){return t=>!!t&&(e instanceof Array?!e.includes(t.status):e.min<=e.max&&!(t.status>=e.min&&t.status<=e.max))}},2157:function(e,t,n){"use strict";n.r(t),n.d(t,"HttpStatusCode",(function(){return r.a})),n.d(t,"constantBackOff",(function(){return i})),n.d(t,"exponentialBackOff",(function(){return a})),n.d(t,"linearBackOff",(function(){return o})),n.d(t,"fetchWithRetry",(function(){return d})),n.d(t,"fetchWithTimeout",(function(){return p.a})),n.d(t,"blacklist",(function(){return h})),n.d(t,"whitelist",(function(){return g}));var r=n(885);function o(e){return t=>t*e}function i(e){return t=>e}function a(e){return t=>Math.pow(2,t)*e}var s=n(2);function l(e){return new Promise((t=>setTimeout((()=>t()),e)))}function c(e,t,n){return u(e,[],t,n)}function u(e,t,n,r){let o;const i=[e(t.length).then((e=>(o=e,!1)))];return n&&n.timeoutMs>0&&i.push(l(n.timeoutMs).then((()=>!0))),Promise.race(i).then((i=>(i&&n&&(o=n.onTimeout()),!r||!r.filter(o)||t.length>=r.maxRetries?{result:o,tries:t}:l(r.backOffFn(t.length)).then((()=>(t.push(o),u(e,t,n,r)))))))}function d(e,t,n=0,o){return c((()=>Object(s.__awaiter)(this,void 0,void 0,(function*(){const n=performance.now();try{const r=yield fetch(e,t);return r.durationMs=Math.round(performance.now()-n),r}catch(e){return{status:window.navigator.onLine?r.a.FetchFailureStatusCode:r.a.OfflineFetchFailureStatusCode,ok:!1,durationMs:Math.round(performance.now()-n)}}}))),{timeoutMs:n,onTimeout:()=>({status:r.a.FetchTimeoutStatusCode,ok:!1,durationMs:n})},o)}var p=n(2124);function g(e){return t=>!!t&&(e instanceof Array?e.includes(t.status):e.min<=e.max&&(t.status>=e.min&&t.status<=e.max))}function h(e){return t=>!!t&&(e instanceof Array?!e.includes(t.status):e.min<=e.max&&!(t.status>=e.min&&t.status<=e.max))}},2159:function(e,t,n){"use strict";n.r(t),n.d(t,"HttpStatusCode",(function(){return r.a})),n.d(t,"constantBackOff",(function(){return i})),n.d(t,"exponentialBackOff",(function(){return a})),n.d(t,"linearBackOff",(function(){return o})),n.d(t,"fetchWithRetry",(function(){return d})),n.d(t,"fetchWithTimeout",(function(){return p.a})),n.d(t,"allow",(function(){return g})),n.d(t,"blacklist",(function(){return m})),n.d(t,"block",(function(){return h})),n.d(t,"whitelist",(function(){return f}));var r=n(881);function o(e){return t=>t*e}function i(e){return t=>e}function a(e){return t=>Math.pow(2,t)*e}var s=n(2);function l(e){return new Promise((t=>setTimeout((()=>t()),e)))}function c(e,t,n){return u(e,[],t,n)}function u(e,t,n,r){let o;const i=[e(t.length).then((e=>(o=e,!1)))];return n&&n.timeoutMs>0&&i.push(l(n.timeoutMs).then((()=>!0))),Promise.race(i).then((i=>(i&&n&&(o=n.onTimeout()),!r||!r.filter(o)||t.length>=r.maxRetries?{result:o,tries:t}:l(r.backOffFn(t.length)).then((()=>(t.push(o),u(e,t,n,r)))))))}function d(e,t,n=0,o){return c((()=>Object(s.__awaiter)(this,void 0,void 0,(function*(){const n=performance.now();try{const r=yield fetch(e,t);return r.durationMs=Math.round(performance.now()-n),r}catch(e){return{status:window.navigator.onLine?r.a.FetchFailureStatusCode:r.a.OfflineFetchFailureStatusCode,ok:!1,durationMs:Math.round(performance.now()-n)}}}))),{timeoutMs:n,onTimeout:()=>({status:r.a.FetchTimeoutStatusCode,ok:!1,durationMs:n})},o)}var p=n(2081);const g=f,h=m;function f(e){return t=>!!t&&(e instanceof Array?e.includes(t.status):e.min<=e.max&&(t.status>=e.min&&t.status<=e.max))}function m(e){return t=>!!t&&(e instanceof Array?!e.includes(t.status):e.min<=e.max&&!(t.status>=e.min&&t.status<=e.max))}},2168:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(2),o=n(246),i=n(2083),a=n(1811),s=n(1743),l=n(2845);const c={GlobalApp:"GlobalApp",UserApp:"UserApp",TenantApp:"TenantApp",Empty:""};function u(e,t){const n=function(e){return(null==e?void 0:e.startsWith("P_"))?c.GlobalApp:(null==e?void 0:e.startsWith("U_"))?c.UserApp:(null==e?void 0:e.startsWith("T_"))?c.TenantApp:c.Empty}(e);switch(n){case c.GlobalApp:return t;case c.UserApp:return c.UserApp;case c.TenantApp:return c.TenantApp;default:return c.Empty}}var d,p=n(359),g=n(791),h=n(1109);function f(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:d.Unhandled,params:{url:new URL(e)}};const t=new URL(e);if(!t.pathname)return{type:d.Unhandled,params:{url:new URL(e)}};return"https://teams.microsoft.com"===t.origin&&/^\/l\//.test(t.pathname)?function(e){var t,n,r,o,i,a;try{if(!e)return;const s=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==s?void 0:s.length)||!s[1])throw new Error("Invalid Teams url format for TaskModule");const l={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},c={url:null!==(r=e.searchParams.get("url"))&&void 0!==r?r:void 0,fallbackUrl:null!==(o=e.searchParams.get("fallbackUrl"))&&void 0!==o?o:void 0,card:e.searchParams.get("card")?JSON.stringify(e.searchParams.get("card")):void 0,width:l.width,height:l.height,title:null!==(i=e.searchParams.get("title"))&&void 0!==i?i:void 0,completionBotId:null!==(a=e.searchParams.get("completionBotId"))&&void 0!==a?a:void 0};return{type:d.TaskModule,params:{appId:s[1],taskInfo:c}}}catch(e){return}}(t)||v(t)||b(t)||m(t):{type:d.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(d||(d={}));const m=e=>({type:d.Unhandled,params:{url:e}});const v=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const r=t.searchParams.get("context");let o={};const i=decodeURIComponent(null!=r?r:"");return o=JSON.parse(i),{type:d.StageView,params:{appId:n[1],stageInfo:o}}}catch(e){return}},b=e=>{var t,n;try{const r=/^\/l\/entity\/([^/]+)\/([^/]+)$/,o=e,i=o.pathname.match(r);if(3!==(null==i?void 0:i.length))throw new Error("Invalid Teams url format for Tab");const a=i[1];let s;if(o.searchParams.has("context")){const e=o.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");s=JSON.parse(t)}const l={entityId:i[2],webUrl:null!==(t=o.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=o.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==s?void 0:s.subEntityId};return{type:d.LaunchPage,params:{appId:a,tabInfo:l}}}catch(e){return}};class y{constructor(e,t,n,r){this.hostService=e,this.channelService=t,this.appService=n,this.telemetryService=r}getAppDefinition(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.appService.getApp(e)}))}handleOpenUrl(e){var t,n,a,s,c,g,h,m,v,b,y,C,O,S,E;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new l.a(this.telemetryService,o.h.CardService,o.g.OpenUrl),x={};try{const i=f(null==e?void 0:e.url);let l;switch(i.type){case d.StageView:x[o.l.ModalViewType]=o.f.StageView,l={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:i.params.appId,stageInfo:i.params.stageInfo},yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(l);break;case d.TaskModule:x[o.l.ModalViewType]=o.f.TaskModule,l={cardData:e.cardData,botId:null!==(a=e.botId)&&void 0!==a?a:"",appId:i.params.appId,taskInfo:i.params.taskInfo},yield null===(s=this.hostService)||void 0===s?void 0:s.openTaskModule(l);break;default:l={cardData:e.cardData,url:e.url},yield this.hostService.openUrl(l)}r.logMetricEnd({props:x,diagnosticsData:`TypeOfCard: ${null===(c=null==e?void 0:e.cardData)||void 0===c?void 0:c.contentType}, cardId : ${null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.cardId}, cardsize: ${null===(m=null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.content)||void 0===m?void 0:m.length}, Appid: ${u(null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.titleId,null===(b=null==e?void 0:e.cardData)||void 0===b?void 0:b.appId)}, actionabilityStatus: ${Object(p.c)(null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.cardId)}`},null===(C=e.cardData)||void 0===C?void 0:C.cardId)}catch(t){return r.logMetricEndWithError({props:x,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${u(null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.titleId,null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.appId)}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),{status:i.a.Error}}return{status:i.a.Success}}))}handleActionExecute(e){var t,n,i,c,d,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new l.a(this.telemetryService,o.h.CardService,o.g.ActionExecute),L={},M={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.authCode&&(M.requestBody.value.state=e.authCode),e.authToken&&(M.requestBody.value.authentication={token:e.authToken});const B=yield null===(n=this.channelService)||void 0===n?void 0:n.botInvoke(M);let R;if((null==B?void 0:B.type)===a.a.Error||!(null==B?void 0:B.value)){const e=B.value;return new s.b(e.errorCode,e.errorMessage)}const F=B.value;switch(null==F?void 0:F.statusCode){case g.a.Ok:R=new s.c(JSON.stringify(F.value),F.type),L[o.l.ActionExecuteResponseType]=o.b.Result,r.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.contentType}, cardId : ${null===(c=null==e?void 0:e.cardData)||void 0===c?void 0:c.cardId}, cardsize: ${null===(h=null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.content)||void 0===h?void 0:h.length}, Appid: ${u(null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.titleId,null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.appId)}, actionabilityStatus: ${Object(p.c)(null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.cardId)}`},null===(b=e.cardData)||void 0===b?void 0:b.cardId);break;case g.a.Unauthorized:if(B.value){R=new s.a(JSON.stringify(F.value),F.type),L[o.l.ActionExecuteResponseType]=o.b.AuthError,r.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.contentType}, cardId : ${null===(C=null==e?void 0:e.cardData)||void 0===C?void 0:C.cardId}, cardsize: ${null===(S=null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.content)||void 0===S?void 0:S.length}, Appid: ${u(null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.titleId,null===(x=null==e?void 0:e.cardData)||void 0===x?void 0:x.appId)}, actionabilityStatus: ${Object(p.c)(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.cardId)}`},null===(w=e.cardData)||void 0===w?void 0:w.cardId);break}R=new s.b(500,"response is empty"),L[o.l.ActionExecuteResponseType]=o.b.Error,r.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response is empty or error, Appid: ${u(null===(T=null==e?void 0:e.cardData)||void 0===T?void 0:T.titleId,null===(k=null==e?void 0:e.cardData)||void 0===k?void 0:k.appId)}`},null===(j=e.cardData)||void 0===j?void 0:j.cardId);break;default:R=new s.b(null!==(P=null==F?void 0:F.statusCode)&&void 0!==P?P:500,JSON.stringify(null==F?void 0:F.value)),L[o.l.ActionExecuteResponseType]=o.b.Error,r.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response status code is not supported, Appid: ${u(null===(A=null==e?void 0:e.cardData)||void 0===A?void 0:A.titleId,null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.appId)}`},null===(D=e.cardData)||void 0===D?void 0:D.cardId)}return R}))}handleActionSubmit(e){var t,n,s,c,d,g,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B,R,F,N,H,U,V;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const z=new l.a(this.telemetryService,o.h.CardService,o.g.ActionSubmit),G={};try{if(!e.data||!e.appId)return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as data or appId is undefined, Appid: ${u(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(s=e.cardData)||void 0===s?void 0:s.cardId),Promise.reject("Data or appId is undefined");if(Object(h.a)(e.data)&&(null===(c=e.data)||void 0===c?void 0:c.msteams.value.tabInfo)){G[o.l.ModalViewType]=o.f.StageView;const t={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:e.data.msteams.value.tabInfo};yield this.hostService.openStageView(t)}else{if(!Object(h.b)(e.data))return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${u(null===(j=null==e?void 0:e.cardData)||void 0===j?void 0:j.titleId,null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.appId)}`},null===(A=e.cardData)||void 0===A?void 0:A.cardId),{status:i.a.Failure};{let t;if(G[o.l.ModalViewType]=o.f.TaskModule,null===(f=null===(g=null===(d=e.data)||void 0===d?void 0:d.msteams)||void 0===g?void 0:g.value)||void 0===f?void 0:f.tabInfo)t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:e.data.msteams.value.tabInfo};else if("task/fetch"===(null===(b=null===(v=null===(m=e.data)||void 0===m?void 0:m.msteams)||void 0===v?void 0:v.value)||void 0===b?void 0:b.type)||"task/fetch"===(null===(C=null===(y=e.data)||void 0===y?void 0:y.msteams)||void 0===C?void 0:C.type)){G[o.l.IsTaskFetch]=1;const n=e.data,{msteams:i}=n,s=Object(r.__rest)(n,["msteams"]),l={appId:e.appId,botId:e.botId,requestBody:{name:"task/fetch",value:{data:Object.assign(Object.assign({},null==i?void 0:i.value),s)}}},c=yield this.channelService.botInvoke(l);if(c.type===a.a.Error||!c.value)return z.logMetricEndWithError({props:G,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${u(null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.titleId,null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.appId)}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),Promise.reject("Bot invoke failed");if((null==c?void 0:c.type)===a.a.Result){const n=c.value;if(!(null===(x=n.task)||void 0===x?void 0:x.value))return z.logMetricEndWithError({props:G,diagnosticsData:`Error: Task info is not present in bot response, Appid: ${u(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.titleId,null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.appId)}`},null===(T=e.cardData)||void 0===T?void 0:T.cardId),Promise.reject("Task info is not present in bot response");t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:null===(k=n.task)||void 0===k?void 0:k.value}}}t&&(yield this.hostService.openTaskModule(t))}}z.logMetricEnd({props:G,diagnosticsData:`TypeOfCard: ${null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.contentType}, cardId : ${null===(D=null==e?void 0:e.cardData)||void 0===D?void 0:D.cardId}, cardsize: ${null===(M=null===(L=null==e?void 0:e.cardData)||void 0===L?void 0:L.content)||void 0===M?void 0:M.length}, Appid: ${u(null===(B=null==e?void 0:e.cardData)||void 0===B?void 0:B.titleId,null===(R=null==e?void 0:e.cardData)||void 0===R?void 0:R.appId)}, actionabilityStatus: ${Object(p.c)(null===(F=null==e?void 0:e.cardData)||void 0===F?void 0:F.cardId)}`},null===(N=e.cardData)||void 0===N?void 0:N.cardId)}catch(t){return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${u(null===(H=null==e?void 0:e.cardData)||void 0===H?void 0:H.titleId,null===(U=null==e?void 0:e.cardData)||void 0===U?void 0:U.appId)}`},null===(V=e.cardData)||void 0===V?void 0:V.cardId),{status:i.a.Error}}return{status:i.a.Success}}))}}},2173:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(2),i=n(246),a=n(2083),s=n(1811),l=n(1743),c=n(2851),u=n(3404),d=n(359),p=n(794),g=n(1115);function h(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:r.Unhandled,params:{url:new URL(e)}};const t=new URL(e);if(!t.pathname)return{type:r.Unhandled,params:{url:new URL(e)}};return"https://teams.microsoft.com"===t.origin&&/^\/l\//.test(t.pathname)?function(e){var t,n,o,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(o=e.searchParams.get("url"))&&void 0!==o?o:void 0,fallbackUrl:null!==(i=e.searchParams.get("fallbackUrl"))&&void 0!==i?i:void 0,card:e.searchParams.get("card")?JSON.stringify(e.searchParams.get("card")):void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:r.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(t)||m(t)||v(t)||f(t):{type:r.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(r||(r={}));const f=e=>({type:r.Unhandled,params:{url:e}});const m=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const o=t.searchParams.get("context");let i={};const a=decodeURIComponent(null!=o?o:"");return i=JSON.parse(a),{type:r.StageView,params:{appId:n[1],stageInfo:i}}}catch(e){return}},v=e=>{var t,n;try{const o=/^\/l\/entity\/([^/]+)\/([^/]+)$/,i=e,a=i.pathname.match(o);if(3!==(null==a?void 0:a.length))throw new Error("Invalid Teams url format for Tab");const s=a[1];let l;if(i.searchParams.has("context")){const e=i.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");l=JSON.parse(t)}const c={entityId:a[2],webUrl:null!==(t=i.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=i.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==l?void 0:l.subEntityId};return{type:r.LaunchPage,params:{appId:s,tabInfo:c}}}catch(e){return}};class b{constructor(e,t,n,r){this.hostService=e,this.channelService=t,this.appService=n,this.telemetryService=r}getAppDefinition(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return yield this.appService.getApp(e)}))}handleOpenUrl(e){var t,n,s,l,p,g,f,m,v,b,y,C,O,S,E;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=new c.a(this.telemetryService,i.h.CardService,i.g.OpenUrl),x={};try{const a=h(null==e?void 0:e.url);let c;switch(a.type){case r.StageView:x[i.l.ModalViewType]=i.f.StageView,c={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:a.params.appId,stageInfo:a.params.stageInfo},yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(c);break;case r.TaskModule:x[i.l.ModalViewType]=i.f.TaskModule,c={cardData:e.cardData,botId:null!==(s=e.botId)&&void 0!==s?s:"",appId:a.params.appId,taskInfo:a.params.taskInfo},yield null===(l=this.hostService)||void 0===l?void 0:l.openTaskModule(c);break;default:c={cardData:e.cardData,url:e.url},yield this.hostService.openUrl(c)}o.logMetricEnd({props:x,diagnosticsData:`TypeOfCard: ${null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.contentType}, cardId : ${null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.cardId}, cardsize: ${null===(m=null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.content)||void 0===m?void 0:m.length}, Appid: ${Object(u.a)(null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.titleId,null===(b=null==e?void 0:e.cardData)||void 0===b?void 0:b.appId)}, actionabilityStatus: ${Object(d.c)(null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.cardId)}`},null===(C=e.cardData)||void 0===C?void 0:C.cardId)}catch(t){return o.logMetricEndWithError({props:x,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${Object(u.a)(null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.titleId,null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.appId)}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),{status:a.a.Error}}return{status:a.a.Success}}))}handleActionExecute(e){var t,n,r,a,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=new c.a(this.telemetryService,i.h.CardService,i.g.ActionExecute),L={},M={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.authCode&&(M.requestBody.value.state=e.authCode),e.authToken&&(M.requestBody.value.authentication={token:e.authToken});const B=yield null===(n=this.channelService)||void 0===n?void 0:n.botInvoke(M);let R;if((null==B?void 0:B.type)===s.a.Error||!(null==B?void 0:B.value)){const e=B.value;return new l.b(e.errorCode,e.errorMessage)}const F=B.value;switch(null==F?void 0:F.statusCode){case p.a.Ok:R=new l.c(JSON.stringify(F.value),F.type),L[i.l.ActionExecuteResponseType]=i.b.Result,o.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(r=null==e?void 0:e.cardData)||void 0===r?void 0:r.contentType}, cardId : ${null===(a=null==e?void 0:e.cardData)||void 0===a?void 0:a.cardId}, cardsize: ${null===(h=null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.content)||void 0===h?void 0:h.length}, Appid: ${Object(u.a)(null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.titleId,null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.appId)}, actionabilityStatus: ${Object(d.c)(null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.cardId)}`},null===(b=e.cardData)||void 0===b?void 0:b.cardId);break;case p.a.Unauthorized:if(B.value){R=new l.a(JSON.stringify(F.value),F.type),L[i.l.ActionExecuteResponseType]=i.b.AuthError,o.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.contentType}, cardId : ${null===(C=null==e?void 0:e.cardData)||void 0===C?void 0:C.cardId}, cardsize: ${null===(S=null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.content)||void 0===S?void 0:S.length}, Appid: ${Object(u.a)(null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.titleId,null===(x=null==e?void 0:e.cardData)||void 0===x?void 0:x.appId)}, actionabilityStatus: ${Object(d.c)(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.cardId)}`},null===(w=e.cardData)||void 0===w?void 0:w.cardId);break}R=new l.b(500,"response is empty"),L[i.l.ActionExecuteResponseType]=i.b.Error,o.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response is empty or error, Appid: ${Object(u.a)(null===(T=null==e?void 0:e.cardData)||void 0===T?void 0:T.titleId,null===(k=null==e?void 0:e.cardData)||void 0===k?void 0:k.appId)}`},null===(j=e.cardData)||void 0===j?void 0:j.cardId);break;default:R=new l.b(null!==(P=null==F?void 0:F.statusCode)&&void 0!==P?P:500,JSON.stringify(null==F?void 0:F.value)),L[i.l.ActionExecuteResponseType]=i.b.Error,o.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response status code is not supported, Appid: ${Object(u.a)(null===(A=null==e?void 0:e.cardData)||void 0===A?void 0:A.titleId,null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.appId)}`},null===(D=e.cardData)||void 0===D?void 0:D.cardId)}return R}))}handleActionSubmit(e){var t,n,r,l,p,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B,R,F,N,H,U,V;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const z=new c.a(this.telemetryService,i.h.CardService,i.g.ActionSubmit),G={};try{if(!e.data||!e.appId)return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as data or appId is undefined, Appid: ${Object(u.a)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(r=e.cardData)||void 0===r?void 0:r.cardId),Promise.reject("Data or appId is undefined");if(Object(g.a)(e.data)&&(null===(l=e.data)||void 0===l?void 0:l.msteams.value.tabInfo)){G[i.l.ModalViewType]=i.f.StageView;const t={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:e.data.msteams.value.tabInfo};yield this.hostService.openStageView(t)}else{if(!Object(g.b)(e.data))return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${Object(u.a)(null===(j=null==e?void 0:e.cardData)||void 0===j?void 0:j.titleId,null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.appId)}`},null===(A=e.cardData)||void 0===A?void 0:A.cardId),{status:a.a.Failure};{let t;if(G[i.l.ModalViewType]=i.f.TaskModule,null===(f=null===(h=null===(p=e.data)||void 0===p?void 0:p.msteams)||void 0===h?void 0:h.value)||void 0===f?void 0:f.tabInfo)t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:e.data.msteams.value.tabInfo};else if("task/fetch"===(null===(b=null===(v=null===(m=e.data)||void 0===m?void 0:m.msteams)||void 0===v?void 0:v.value)||void 0===b?void 0:b.type)||"task/fetch"===(null===(C=null===(y=e.data)||void 0===y?void 0:y.msteams)||void 0===C?void 0:C.type)){G[i.l.IsTaskFetch]=1;const n=e.data,{msteams:r}=n,a=Object(o.__rest)(n,["msteams"]),l={appId:e.appId,botId:e.botId,requestBody:{name:"task/fetch",value:{data:Object.assign(Object.assign({},null==r?void 0:r.value),a)}}},c=yield this.channelService.botInvoke(l);if(c.type===s.a.Error||!c.value)return z.logMetricEndWithError({props:G,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${Object(u.a)(null===(O=null==e?void 0:e.cardData)||void 0===O?void 0:O.titleId,null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.appId)}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),Promise.reject("Bot invoke failed");if((null==c?void 0:c.type)===s.a.Result){const n=c.value;if(!(null===(x=n.task)||void 0===x?void 0:x.value))return z.logMetricEndWithError({props:G,diagnosticsData:`Error: Task info is not present in bot response, Appid: ${Object(u.a)(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.titleId,null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.appId)}`},null===(T=e.cardData)||void 0===T?void 0:T.cardId),Promise.reject("Task info is not present in bot response");t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:null===(k=n.task)||void 0===k?void 0:k.value}}}t&&(yield this.hostService.openTaskModule(t))}}z.logMetricEnd({props:G,diagnosticsData:`TypeOfCard: ${null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.contentType}, cardId : ${null===(D=null==e?void 0:e.cardData)||void 0===D?void 0:D.cardId}, cardsize: ${null===(M=null===(L=null==e?void 0:e.cardData)||void 0===L?void 0:L.content)||void 0===M?void 0:M.length}, Appid: ${Object(u.a)(null===(B=null==e?void 0:e.cardData)||void 0===B?void 0:B.titleId,null===(R=null==e?void 0:e.cardData)||void 0===R?void 0:R.appId)}, actionabilityStatus: ${Object(d.c)(null===(F=null==e?void 0:e.cardData)||void 0===F?void 0:F.cardId)}`},null===(N=e.cardData)||void 0===N?void 0:N.cardId)}catch(t){return z.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${Object(u.a)(null===(H=null==e?void 0:e.cardData)||void 0===H?void 0:H.titleId,null===(U=null==e?void 0:e.cardData)||void 0===U?void 0:U.appId)}`},null===(V=e.cardData)||void 0===V?void 0:V.cardId),{status:a.a.Error}}return{status:a.a.Success}}))}}},2174:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(2),i=n(246),a=n(2083),s=n(1811),l=n(1743),c=n(3487),u=n(1464),d=n(1116);function p(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:r.Unhandled,params:{url:new URL(e)}};const t=new URL(e);if(!t.pathname)return{type:r.Unhandled,params:{url:new URL(e)}};return"https://teams.microsoft.com"===t.origin&&/^\/l\//.test(t.pathname)?function(e){var t,n,o,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(o=e.searchParams.get("url"))&&void 0!==o?o:void 0,fallbackUrl:null!==(i=e.searchParams.get("fallbackUrl"))&&void 0!==i?i:void 0,card:e.searchParams.get("card")?JSON.stringify(e.searchParams.get("card")):void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:r.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(t)||h(t)||f(t)||g(t):{type:r.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(r||(r={}));const g=e=>({type:r.Unhandled,params:{url:e}});const h=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const o=t.searchParams.get("context");let i={};const a=decodeURIComponent(null!=o?o:"");return i=JSON.parse(a),{type:r.StageView,params:{appId:n[1],stageInfo:i}}}catch(e){return}},f=e=>{var t,n;try{const o=/^\/l\/entity\/([^/]+)\/([^/]+)$/,i=e,a=i.pathname.match(o);if(3!==(null==a?void 0:a.length))throw new Error("Invalid Teams url format for Tab");const s=a[1];let l;if(i.searchParams.has("context")){const e=i.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");l=JSON.parse(t)}const c={entityId:a[2],webUrl:null!==(t=i.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=i.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==l?void 0:l.subEntityId};return{type:r.LaunchPage,params:{appId:s,tabInfo:c}}}catch(e){return}};class m{constructor(e,t,n,r){this.hostService=e,this.channelService=t,this.appService=n,this.telemetryService=r}getAppDefinition(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return yield this.appService.getApp(e)}))}handleOpenUrl(e){var t,n,s,l,u,d;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=new c.a(this.telemetryService,i.h.CardService,i.g.OpenUrl),g={};try{const a=p(null==e?void 0:e.url);let c;switch(a.type){case r.StageView:g[i.l.ModalViewType]=i.f.StageView,c={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:a.params.appId,stageInfo:a.params.stageInfo},yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(c);break;case r.TaskModule:g[i.l.ModalViewType]=i.f.TaskModule,c={cardData:e.cardData,botId:null!==(s=e.botId)&&void 0!==s?s:"",appId:a.params.appId,taskInfo:a.params.taskInfo},yield null===(l=this.hostService)||void 0===l?void 0:l.openTaskModule(c);break;default:c={cardData:e.cardData,url:e.url},yield this.hostService.openUrl(c)}o.logMetricEnd({props:g},null===(u=e.cardData)||void 0===u?void 0:u.cardId)}catch(t){return o.logMetricEndWithError({props:g,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t}`},null===(d=e.cardData)||void 0===d?void 0:d.cardId),{status:a.a.Error}}return{status:a.a.Success}}))}handleActionExecute(e){var t,n,r,a,d,p,g;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=new c.a(this.telemetryService,i.h.CardService,i.g.ActionExecute),h={},f={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.authCode&&(f.requestBody.value.state=e.authCode),e.authToken&&(f.requestBody.value.authentication={token:e.authToken});const m=yield null===(n=this.channelService)||void 0===n?void 0:n.botInvoke(f);let v;if((null==m?void 0:m.type)===s.a.Error||!(null==m?void 0:m.value)){const e=m.value;return new l.b(e.errorCode,e.errorMessage)}const b=m.value;switch(null==b?void 0:b.statusCode){case u.a.Ok:v=new l.c(JSON.stringify(b.value),b.type),h[i.l.ActionExecuteResponseType]=i.b.Result,o.logMetricEnd({props:h},null===(r=e.cardData)||void 0===r?void 0:r.cardId);break;case u.a.Unauthorized:if(m.value){v=new l.a(JSON.stringify(b.value),b.type),h[i.l.ActionExecuteResponseType]=i.b.AuthError,o.logMetricEnd({props:h},null===(a=e.cardData)||void 0===a?void 0:a.cardId);break}v=new l.b(500,"response is empty"),h[i.l.ActionExecuteResponseType]=i.b.Error,o.logMetricEndWithError({props:h,diagnosticsData:"Error: Action Execute failed. Bot response is empty or error"},null===(d=e.cardData)||void 0===d?void 0:d.cardId);break;default:v=new l.b(null!==(p=null==b?void 0:b.statusCode)&&void 0!==p?p:500,JSON.stringify(null==b?void 0:b.value)),h[i.l.ActionExecuteResponseType]=i.b.Error,o.logMetricEndWithError({props:h,diagnosticsData:"Error: Action Execute failed. Bot response status code is not supported"},null===(g=e.cardData)||void 0===g?void 0:g.cardId)}return v}))}handleActionSubmit(e){var t,n,r,l,u,p,g,h,f,m,v,b,y,C,O,S,E;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const x=new c.a(this.telemetryService,i.h.CardService,i.g.OpenUrl),I={};try{if(!e.data||!e.appId)return x.logMetricEndWithError({props:I,diagnosticsData:"Error: ActionSubmit failed as data or appId is undefined"},null===(t=e.cardData)||void 0===t?void 0:t.cardId),Promise.reject("Data or appId is undefined");if(Object(d.a)(e.data)&&(null===(n=e.data)||void 0===n?void 0:n.msteams.value.tabInfo)){I[i.l.ModalViewType]=i.f.StageView;const t={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:e.data.msteams.value.tabInfo};yield this.hostService.openStageView(t)}else{if(!Object(d.b)(e.data))return x.logMetricEndWithError({props:I,diagnosticsData:"Error: ActionSubmit failed as passed action submit type is not supported"},null===(O=e.cardData)||void 0===O?void 0:O.cardId),{status:a.a.Failure};{let t;if(I[i.l.ModalViewType]=i.f.TaskModule,null===(u=null===(l=null===(r=e.data)||void 0===r?void 0:r.msteams)||void 0===l?void 0:l.value)||void 0===u?void 0:u.tabInfo)t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:e.data.msteams.value.tabInfo};else if("task/fetch"===(null===(h=null===(g=null===(p=e.data)||void 0===p?void 0:p.msteams)||void 0===g?void 0:g.value)||void 0===h?void 0:h.type)||"task/fetch"===(null===(m=null===(f=e.data)||void 0===f?void 0:f.msteams)||void 0===m?void 0:m.type)){I[i.l.IsTaskFetch]=1;const n=e.data,{msteams:r}=n,a=Object(o.__rest)(n,["msteams"]),l={appId:e.appId,botId:e.botId,requestBody:{name:"task/fetch",value:{data:Object.assign(Object.assign({},null==r?void 0:r.value),a)}}},c=yield this.channelService.botInvoke(l);if(c.type===s.a.Error||!c.value)return x.logMetricEndWithError({props:I,diagnosticsData:"Error: Bot invoke failed. Bot response is empty or error"},null===(v=e.cardData)||void 0===v?void 0:v.cardId),Promise.reject("Bot invoke failed");if((null==c?void 0:c.type)===s.a.Result){const n=c.value;if(!(null===(b=n.task)||void 0===b?void 0:b.value))return x.logMetricEndWithError({props:I,diagnosticsData:"Error: Task info is not present in bot response"},null===(y=e.cardData)||void 0===y?void 0:y.cardId),Promise.reject("Task info is not present in bot response");t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:null===(C=n.task)||void 0===C?void 0:C.value}}}t&&(yield this.hostService.openTaskModule(t))}}x.logMetricEnd({props:I},null===(S=e.cardData)||void 0===S?void 0:S.cardId)}catch(t){return x.logMetricEndWithError({props:I,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),{status:a.a.Error}}return{status:a.a.Success}}))}}},2217:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(487),o=n(1555);class i{constructor(e,t){this.activityProvider=e,this.telemetryService=t}async executeActivity(e){var t,n,o;try{switch(e.type){case"auth":case"config":return this.activityProvider.authConfigActivity.execute(e);case"silentAuth":return this.activityProvider.silentAuthActivity.execute(e);case"botInvoke":return this.activityProvider.botInvokeActivity.execute(e);case"APIPluginAuth":return this.activityProvider.apiPluginAuthActivity.execute(e);default:return null===(t=this.telemetryService)||void 0===t||t.LogError({type:r.c.LogError,name:r.f.ExecuteActivity,tag:r.h.AuthRuntime,success:!1,diagnosticsData:"Invalid auth request type"}),Promise.reject({code:"UnsupportedRequestType",errorMessage:"Invalid request type"})}}catch(e){return null===(n=this.telemetryService)||void 0===n||n.LogError({type:r.c.LogError,name:r.f.ExecuteActivity,tag:r.h.AuthRuntime,success:!1,diagnosticsData:`Error while executing auth activity ${(null==e?void 0:e.message)||e}`}),Promise.reject({code:"ActivityExecutionError",errorMessage:null!==(o=null==e?void 0:e.message)&&void 0!==o?o:"Error executing activity"})}}async execute(e){var t,n,i;try{let i,a=e,s=3;for(;a&&"result"!==a.type&&s-- >0;){if(i=await this.executeActivity(a),"object"!=typeof i)return;if(!i)return null===(t=this.telemetryService)||void 0===t||t.LogError({type:r.c.LogError,name:r.f.Execute,tag:r.h.AuthRuntime,success:!1,diagnosticsData:"Activity response is undefined"}),Promise.reject({code:"ActivityExecutionError",errorMessage:"Activity response is undefined"});if(e.onActivityCompletion){if(await e.onActivityCompletion(i))return i}a=Object(o.b)(a,i)}return i||(null===(n=this.telemetryService)||void 0===n||n.LogError({type:r.c.LogError,name:r.f.Execute,tag:r.h.AuthRuntime,success:!1,diagnosticsData:"Activity response is undefined"}),Promise.reject("Activity response is undefined"))}catch(e){return null===(i=this.telemetryService)||void 0===i||i.LogError({type:r.c.LogError,name:r.f.Execute,tag:r.h.AuthRuntime,success:!1,diagnosticsData:`Error while getting auth activity response ${e}`}),Promise.reject(e)}}}},2218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"MsgExt3SChannelService",{enumerable:!0,get:function(){return o.MsgExt3SChannelService}}),Object.defineProperty(t,"MsgExtCardService",{enumerable:!0,get:function(){return r.MsgExtCardService}}),Object.defineProperty(t,"MsgExtHostService",{enumerable:!0,get:function(){return i.MsgExtHostService}}),Object.defineProperty(t,"MsgExtPreviewHostService",{enumerable:!0,get:function(){return a.MsgExtPreviewHostService}}),Object.defineProperty(t,"PerfMarker",{enumerable:!0,get:function(){return s.PerfMarker}});var r=n(2682),o=n(2683),i=n(2684),a=n(2689),s=n(2690)},238:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"q",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"l",(function(){return C}));var r=n(64),o=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area"},i=function(){return Object(r.m)()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},a=function(){return Object(r.m)()?OfficeaicopilotStrings.SubmitButtonTitle:"Send"},s=function(){return Object(r.m)()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own"},l="",c="‍",u="copilot-chat-input",d=300,p=function(){return Object(r.m)()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone"},g=function(){return Object(r.m)()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?"},h=function(){return Object(r.m)()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now"},f=function(){return Object(r.m)()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"},m="https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b",v=function(){return Object(r.m)()?OfficeaicopilotStrings.MicrophoneListeningStatus:"Microphone Listening"},b=function(){return Object(r.m)()?OfficeaicopilotStrings.MicrophonePausedStatus:"Microphone Paused"},y=function(){return Object(r.m)()?OfficeaicopilotStrings.MicrophoneDisabledStatus:"Microphone Disabled"},C=function(){return Object(r.m)()?OfficeaicopilotStrings.MicrophoneLoadingStatus:"Microphone Loading"}},2385:function(e,t,n){"use strict";function r(e){var t,n;return null!==(n=null===(t=e.titleId)||void 0===t?void 0:t.startsWith("P_"))&&void 0!==n&&n}n.d(t,"a",(function(){return r}))},2387:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=n(1790),i=n(300),a=n(2859),s=function(){function e(e){this.clientInfo=e,this.selectedAccount=null;var t=e&&(null==e?void 0:e.clientId)?e.clientId:"3068386c-7a16-4f6a-a664-043b6b232816",n=e&&(null==e?void 0:e.redirectUri)?e.redirectUri:"/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.13003/en-us_web/login.html";this.msalApp=new o.a({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}return e.prototype.getToken=function(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,s,l,c,u,d=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,9]),[4,this.msalApp.initialize()];case 1:return r.sent(),(null==(s=this.msalApp.getAllAccounts())?void 0:s.length)>=1&&(this.clientInfo?this.selectedAccount=null!==(t=s.find((function(e){var t;return e.username===(null===(t=d.clientInfo)||void 0===t?void 0:t.userPrincipalName)})))&&void 0!==t?t:null:this.selectedAccount=s[0]),this.selectedAccount||this.signInRequestPromise||(l=this.clientInfo?{loginHint:this.clientInfo.userPrincipalName}:void 0,this.signInRequestPromise=this.msalApp.loginPopup(l)),this.signInRequestPromise?[4,this.signInRequestPromise]:[3,3];case 2:(c=r.sent())&&(this.selectedAccount=c.account),this.signInRequestPromise=void 0,r.label=3;case 3:if(!this.selectedAccount)throw new Error("Failed to acquire token - No account found.");return n={scopes:["".concat(e.resource,"/.default")],account:this.selectedAccount},[4,this.msalApp.acquireTokenSilent(n)];case 4:return(u=r.sent())?[2,{authToken:u.accessToken}]:[3,9];case 5:return r.sent()instanceof i.a?e.isSilent&&n?[4,this.msalApp.acquireTokenPopup(n)]:[3,7]:[3,8];case 6:return o=r.sent(),[3,8];case 7:throw new Error(a.a);case 8:return this.signInRequestPromise=void 0,[3,9];case 9:if(o)return[2,{authToken:o.accessToken}];throw new Error("Failed to acquire token.")}}))}))},e}()},2388:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=n(1810),i=n(1158),a=n(298),s=function(){function e(e){this.pluginConfigService=e,this.cachedApps=new Map,this.appsLoadingPromise=void 0}return e.prototype.getApp=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrLoadAppById(e.id)];case 1:return[2,(t=n.sent())?{titleInfo:t}:void 0]}}))}))},e.prototype.getOrLoadAppById=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return this.cachedApps.size&&(t=this.cachedApps.get(e))?[2,t]:[4,this.fetchAndCacheApps()];case 1:return[2,n.sent().get(e)]}}))}))},e.prototype.fetchAndCacheApps=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return this.appsLoadingPromise?[2,this.appsLoadingPromise]:(this.appsLoadingPromise=this.fetchApps(),e=this,[4,this.appsLoadingPromise]);case 1:return e.cachedApps=t.sent(),this.appsLoadingPromise=void 0,[2,this.cachedApps]}}))}))},e.prototype.fetchApps=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.pluginConfigService.executeOperation({type:o.a.GetPluginDefinition})];case 1:return"Success"===(null==(e=n.sent())?void 0:e.status)&&i.b.typeGuard(e)?(t=l(e.pluginDefinitions),[2,new Map(t.map((function(e){return[e.appId,e]})))]):[2,new Map]}}))}))},e}(),l=function(e){return Array.isArray(e)?e.map((function(e){return l(e)})):null!=e&&e.constructor===Object?Object.keys(e).reduce((function(t,n){var o;return Object(r.__assign)(Object(r.__assign)({},t),((o={})[Object(a.camelCase)(n)]=l(e[n]),o))}),{}):e}},2389:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=n(406),i=n(1811),a=n(1810),s=function(){function e(e){this.pluginConfigService=e}return e.prototype.botInvoke=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this.processRequest(e),n={type:a.a.GetBotResult,botRequest:t},[4,this.pluginConfigService.executeOperation(n)];case 1:return"Success"!==(null==(o=r.sent())?void 0:o.status)?[2,void 0]:(s=o.botResult,o.botResult.Error?[2,{type:i.a.Error,value:{errorCode:s.Error.HttpCode,errorMessage:s.Error.Message}}]:[2,{type:i.a.Result,value:s.response}]);case 2:return r.sent(),[2,void 0];case 3:return[2]}}))}))},e.prototype.processRequest=function(e){var t,n,r,i,a,s={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(a=null===(i=e.requestBody.extension)||void 0===i?void 0:i.generateFallbackHtml)&&void 0!==a&&a}},logicalId:Object(o.generateGuid)(),scenario:{name:"M365CardSDK"}};return e.requestBody.appName&&(s.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(s.request.imDisplayName=e.requestBody.imdisplayname),s},e}()},239:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d;n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(r||(r={})),function(e){e[e.ACTION_AI=0]="ACTION_AI",e[e.COPILOT_ODSL=1]="COPILOT_ODSL"}(o||(o={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(i||(i={})),function(e){e[e.QUERY_ENTERED=0]="QUERY_ENTERED",e[e.QUERY_SUBMITTED=1]="QUERY_SUBMITTED",e[e.QUERY_SUBMITTED_FAILED=2]="QUERY_SUBMITTED_FAILED",e[e.RESPONSE_RECEIVED=3]="RESPONSE_RECEIVED",e[e.RESPONSE_SENT=4]="RESPONSE_SENT",e[e.EXECUTION_COMPLETE=5]="EXECUTION_COMPLETE",e[e.IDLE=6]="IDLE"}(a||(a={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(s||(s={})),function(e){e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.PARTIAL_SUCCESS="PARTIAL"}(l||(l={})),function(e){e[e.AnnotationActivated=0]="AnnotationActivated",e[e.AugloopResponseTimeout=1]="AugloopResponseTimeout",e[e.StopGeneratingButtonClicked=2]="StopGeneratingButtonClicked",e[e.CopilotChatLoaded=3]="CopilotChatLoaded",e[e.CitationLinkClicked=4]="CitationLinkClicked",e[e.BasicChatSuggestionPills=5]="BasicChatSuggestionPills",e[e.BasicChatStatus=6]="BasicChatStatus",e[e.ChatTopicChanged=7]="ChatTopicChanged",e[e.ChatHistoryHydrationFailed=8]="ChatHistoryHydrationFailed",e[e.QuerySubmitted=9]="QuerySubmitted",e[e.UpdateChatClpFromChatHistory=10]="UpdateChatClpFromChatHistory",e[e.PluginsStateUpdated=11]="PluginsStateUpdated",e[e.ResetContextId=12]="ResetContextId",e[e.PythonExitAnalysisButtonClicked=13]="PythonExitAnalysisButtonClicked"}(c||(c={})),function(e){e.ALSessionInitialized="AL_Session_Initialized",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.ChatHistoryResponseReceived="Chat_History_Response_Received",e.ChatPaneInitalized="Chat_Pane_Initialized",e.ChatPaneLoaded="Chat_Pane_Loaded",e.MenuButtonItemClicked="Menu_Button_Item_Clicked",e.MenuButtonItemClickedL1="Menu_Button_Item_Clicked_L1",e.ZQMButtonItemClicked="ZQM_Button_Item_Clicked",e.InputAreaTextChangedToEmpty="Input_Area_Text_Changed_Empty",e.ZQMLoaded="ZQM_Loaded",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.AugloopResponseReceived="Augloop_Response_Received",e.AugloopErrorReceived="Augloop_Error_Received",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionStarted="Query_Execution_Started",e.QueryExecutionCompleted="Query_Execution_Completed",e.CopilotSwitcherMenuStateChange="Copilot_Switcher_Menu_State_Change"}(u||(u={})),function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(d||(d={}))},2398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"MsgExt3SChannelService",{enumerable:!0,get:function(){return o.MsgExt3SChannelService}}),Object.defineProperty(t,"MsgExtCardService",{enumerable:!0,get:function(){return r.MsgExtCardService}}),Object.defineProperty(t,"MsgExtHostService",{enumerable:!0,get:function(){return i.MsgExtHostService}}),Object.defineProperty(t,"MsgExtPreviewHostService",{enumerable:!0,get:function(){return a.MsgExtPreviewHostService}}),Object.defineProperty(t,"PerfMarker",{enumerable:!0,get:function(){return s.PerfMarker}});var r=n(2730),o=n(2731),i=n(2732),a=n(2747),s=n(2748)},242:function(e,t,n){"use strict";var r,o,i,a,s,l;n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=3]="SystemMetadata",e[e.OrganizationIdentifiableInformation=4]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=5]="EndUserIdentifiableInformation",e[e.CustomerContent=6]="CustomerContent",e[e.AccessControl=7]="AccessControl",e[e.PublicNonPersonalData=8]="PublicNonPersonalData",e[e.EndUserPseudonymousInformation=9]="EndUserPseudonymousInformation",e[e.PublicPersonalData=10]="PublicPersonalData",e[e.SupportData=11]="SupportData",e[e.Everything=12]="Everything"}(r||(r={})),function(e){e[e.CP_EVENT_TYPE_NOT_SET=1]="CP_EVENT_TYPE_NOT_SET",e[e.CP_EVENT_TYPE_CRITICAL=2]="CP_EVENT_TYPE_CRITICAL"}(o||(o={})),function(e){e[e.CP_DATA_CATEGORY_NOT_SET=1]="CP_DATA_CATEGORY_NOT_SET",e[e.CP_DATA_CATEGORY_SOFTWARE_SETUP=2]="CP_DATA_CATEGORY_SOFTWARE_SETUP",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE=3]="CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE=4]="CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE",e[e.CP_DATA_CATEGORY_DEVICE_CONFIGURATION=5]="CP_DATA_CATEGORY_DEVICE_CONFIGURATION",e[e.CP_DATA_CATEGORY_INKING_TYPING_SPEECH=6]="CP_DATA_CATEGORY_INKING_TYPING_SPEECH"}(i||(i={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.QueryDetails="QueryDetails",e.Chat="Chat"}(a||(a={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone",e.AshaError="AshaError"}(s||(s={})),function(e){e[e.CP_DIAGNOSTIC_LEVEL_OPTIONAL=1]="CP_DIAGNOSTIC_LEVEL_OPTIONAL",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED=2]="CP_DIAGNOSTIC_LEVEL_REQUIRED",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES=3]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA=4]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA"}(l||(l={}))},2420:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),o=n(159),i=n(1489),a=n(1151),s=n(52),l=n(2679),c=n(1158),u=n(325),d=n(485),p=n(171),g=n(17),h=function(){function e(){this.requestByQueryId=new Map}return e.prototype.executeOperation=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,h,m,v=this;return Object(r.__generator)(this,(function(r){return t=function(e){var t=new l.a({operation:e,queryId:Object(d.a)()}),n=p.a.getInstance(),r=new i.b({parentPath:["Signal",l.a.getTypeName()],items:[{id:a.a.generateId(),body:t}]}),o=e.type;return n.sendTelemetryChatEventData([{key:g.g.ChatEventType,value:g.f.PluginConfigSignalSent},{key:g.g.ChatEventParameters,value:"".concat(l.a.getTypeName(),"_").concat(o)}]),Object(s.c)("Submitting signal to Augloop : ".concat(l.a.getTypeName()," signal: ").concat(JSON.stringify(t))),u.a.getInstance().submitOperation(r,c.a.getTypeName()),t}(e),n=new f,this.requestByQueryId.set(t.queryId,n),h=n.completion.then((function(){return!0})),m=Object(o.g)(6e4).then((function(){return!1})),[2,Promise.race([h,m]).then((function(r){return r?n.completion:(v.requestByQueryId.delete(t.queryId),Promise.reject(new Error("Timeout executing operation ".concat(e.type))))}))]}))}))},e.prototype.onOperationResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e}(),f=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}()},246:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p,g,h,f,m;n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"m",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return m})),function(e){e[e.None=0]="None",e[e.AppDefinitionIsUndefined=1]="AppDefinitionIsUndefined",e[e.AttributedDataNotFound=2]="AttributedDataNotFound",e[e.UserPrincipalNameIsNotAvailable=3]="UserPrincipalNameIsNotAvailable",e[e.HostLocaleIsUndefined=4]="HostLocaleIsUndefined",e[e.cardContentParseError=5]="cardContentParseError"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.None=0]="None",e[e.MsgExtCardHeader=1]="MsgExtCardHeader",e[e.getAppDataException=2]="getAppDataException",e[e.verifyCardException=3]="verifyCardException"}(i||(i={})),function(e){e[e.None=0]="None",e[e.CardRender=1]="CardRender",e[e.CardActions=2]="CardActions",e[e.BotInvoke=3]="BotInvoke",e[e.GetApp=4]="GetApp",e[e.GetImage=5]="GetImage",e[e.OpenDialog=6]="OpenDialog",e[e.CitationOrEntityControl=7]="CitationOrEntityControl",e[e.ReferenceContainer=8]="ReferenceContainer",e[e.GetUserConfig=9]="GetUserConfig",e[e.FindAcquisition=10]="FindAcquisition",e[e.GetAndCacheAcquisition=11]="GetAndCacheAcquisition",e[e.CardService=12]="CardService",e[e.BrokeredCardService=13]="BrokeredCardService"}(a||(a={})),function(e){e[e.None=0]="None",e[e.getHeaderOptions=1]="getHeaderOptions",e[e.MsgExtCardReference=2]="MsgExtCardReference",e[e.MsgExtCard=3]="MsgExtCard"}(s||(s={})),function(e){e[e.None=0]="None",e[e.M365CardRenderer=1]="M365CardRenderer",e[e.OpenUrlActivityRequest=2]="OpenUrlActivityRequest",e[e.ActionExecuteActivityRequest=3]="ActionExecuteActivityRequest",e[e.SigninActionActivityRequest=4]="SigninActionActivityRequest",e[e.SubmitActionActivityRequest=5]="SubmitActionActivityRequest",e[e.BotInvokeRequest=6]="BotInvokeRequest",e[e.BotInvokeFetchToken=7]="BotInvokeFetchToken",e[e.GetAppFromMOS3=8]="GetAppFromMOS3",e[e.GetImageProxyUrl=9]="GetImageProxyUrl",e[e.OpenStageView=10]="OpenStageView",e[e.OpenTaskModule=11]="OpenTaskModule",e[e.MsgExtCardPreview=12]="MsgExtCardPreview",e[e.MsgExtCitationOrEntityControl=13]="MsgExtCitationOrEntityControl",e[e.MsgExtCardReferenceContainer=14]="MsgExtCardReferenceContainer",e[e.GetUserConfigFrom3S=15]="GetUserConfigFrom3S",e[e.FindAcquisitionforMOS=16]="FindAcquisitionforMOS",e[e.GetAndCacheAcquisitionforMOS=17]="GetAndCacheAcquisitionforMOS",e[e.M365CardParser=18]="M365CardParser",e[e.OpenUrl=19]="OpenUrl",e[e.ActionSubmit=20]="ActionSubmit",e[e.ActionExecute=21]="ActionExecute"}(l||(l={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(c||(c={})),function(e){e.Intent="Intent",e.Client="Client",e.AppId="AppId",e.ActionType="ActionType",e.RetryCount="RetryCount",e.RuntimeActivityResponseMethod="RuntimeActivityResponseMethod",e.RequestName="RequestName",e.HttpStatusCode="HttpStatusCode",e.DialogContentType="DialogContentType",e.HasURL="HasURL",e.citationIndex="citationIndex",e.ActionErrorType="ActionErrorType",e.ModalViewType="ModalViewType",e.IsTaskFetch="IsTaskFetch",e.ActionExecuteResponseType="ActionExecuteResponseType"}(u||(u={})),function(e){e[e.HeroCard=0]="HeroCard",e[e.ThumbnailCard=1]="ThumbnailCard",e[e.ConnectorCard=2]="ConnectorCard",e[e.AdaptiveCard=3]="AdaptiveCard",e[e.SignInCard=5]="SignInCard",e[e.ConfigCard=6]="ConfigCard",e[e.ErrorCard=7]="ErrorCard"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.OpenUrl=1]="OpenUrl",e[e.Execute=2]="Execute",e[e.SignIn=3]="SignIn",e[e.Submit=4]="Submit"}(p||(p={})),function(e){e[e.Execute=0]="Execute",e[e.OnCompletion=1]="OnCompletion"}(g||(g={})),function(e){e[e.Others=0]="Others",e[e.BotInvokeError=1]="BotInvokeError"}(h||(h={})),function(e){e[e.Unknown=0]="Unknown",e[e.StageView=1]="StageView",e[e.TaskModule=2]="TaskModule"}(f||(f={})),function(e){e[e.Result=0]="Result",e[e.AuthError=1]="AuthError",e[e.Error=2]="Error"}(m||(m={}))},2465:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(r||(r={}))},256:function(e,t,n){"use strict";n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"c",(function(){return v})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return C})),n.d(t,"h",(function(){return O}));var r=n(2),o=n(718),i=n(59),a=n(389),s=n(474),l=n(317),c=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var r=new e;r._versionString=t;var o=/(\d+).(\d+)/gi.exec(t);return null!=o&&3===o.length?(r._major=parseInt(o[1],10),r._minor=parseInt(o[2],10)):r._isValid=!1,r._isValid||n.logParseEvent(void 0,i.w.InvalidPropertyValue,s.a.errors.invalidVersionString(r._versionString)),r}},e.prototype.toString=function(){return this._isValid?"".concat(this._major,".").concat(this._minor):this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}(),u=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=[];for(var n in e)if(n.match(/^v[0-9_]*$/))try{var r=e[n];r instanceof c&&t.push(r)}catch(e){}return t.sort((function(e,t){return e.compareTo(t)}))},e.v1_0=new c(1,0),e.v1_1=new c(1,1),e.v1_2=new c(1,2),e.v1_3=new c(1,3),e.v1_4=new c(1,4),e.v1_5=new c(1,5),e.v1_6=new c(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();var d=function(){function e(e){void 0===e&&(e=u.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.serializeValue=function(e,t,n,r,o){void 0===r&&(r=void 0),void 0===o&&(o=!1),null==n||n===r?o&&delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeDate=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=Object(l.c)(n)},e.prototype.serializeBool=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,r){null==n||isNaN(n)||n===r?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,r,o){void 0===o&&(o=void 0),null==r||r===o?delete t[n]:t[n]=e[r]},e.prototype.serializeArray=function(e,t,n){var o,i,a=[];if(n)try{for(var s=Object(r.__values)(n),l=s.next();!l.done;l=s.next()){var c=l.value,u=void 0;void 0!==(u=c instanceof C?c.toJSON(this):c.toJSON?c.toJSON():c)&&a.push(u)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}0===a.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,a)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,i.x.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e.prototype.shouldFailRendering=function(){return a.a.failRenderingWhenUnknownPropertiesAreFound&&this._validationEvents.some((function(e){return e.event===i.w.UnknownProperty}))||a.a.failRenderingWhenInvalidPropertyValuesAreFound&&this._validationEvents.some((function(e){return e.event===i.w.InvalidPropertyValue}))},e.prototype.hasEvent=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._validationEvents.some((function(t){return e.includes(t.event)}))},e.prototype.getAttachableElementProperties=function(){return[]},e.prototype.getAttachableElementProperty=function(e){},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(d),g=function(){function e(t,n,r,o){this.targetVersion=t,this.name=n,this.defaultValue=r,this.onGetInitialValue=o,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)},e.prototype.preProcessValue=function(e){return e},e.prototype.getDescriptor=function(e){return{valueType:"any",isArray:!1,defaultValue:this.defaultValue}},e._sequentialNumber=0,e}(),h=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.regEx=r,a.defaultValue=o,a.onGetInitialValue=i,a.isImageUrl=!1,a}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=Object(l.h)(t[this.name],this.defaultValue);if((""===r&&(r=void 0),r&&void 0!==this.regEx)&&!this.regEx.exec(r))return void n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.invalidPropertyValue(r,this.name));return r},t.prototype.toJSON=function(e,t,n,r){r.serializeString(t,this.name,""===n?void 0:n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"string",defaultValue:this.defaultValue,isArray:!1,isImageUrl:this.isImageUrl}},t}(g),f=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return Object(l.e)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"boolean",defaultValue:this.defaultValue,isArray:!1}},t}(g),m=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return Object(l.g)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"number",defaultValue:this.defaultValue,isArray:!1}}}(g),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o=t[this.name];if("string"==typeof o){var l=!1;try{var c=a.c.parse(o,!0);c.unit===i.o.Pixel&&(r=c.physicalSize,l=!0)}catch(e){}l||n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.invalidPropertyValue(t[this.name],"minHeight"))}return r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))},t.prototype.getDescriptor=function(e){return{valueType:"string",description:'Format is "<number>px"',defaultValue:this.defaultValue,isArray:!1}}}(g),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,a,s=t[this.name];if(void 0===s||!Array.isArray(s))return this.defaultValue;var l=[];try{for(var c=Object(r.__values)(s),u=c.next();!u.done;u=c.next()){var d=u.value;"string"==typeof d?l.push(d):n.logParseEvent(e,i.w.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(d),'" of type "').concat(typeof d,'" ignored for "').concat(this.name,'".'))}}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return l},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:"string",defaultValue:this.defaultValue,isArray:!0}}}(g),function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.values=r,a.defaultValue=o,a.onGetInitialValue=i,a}return Object(r.__extends)(t,e),t.prototype.isValidValue=function(e,t){var n,o;try{for(var i=Object(r.__values)(this.values),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.toLowerCase()===s.value.toLowerCase())return(s.targetVersion?s.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.parse=function(e,t,n){var o,a,l=t[this.name];if(void 0===l)return this.defaultValue;if("string"==typeof l)try{for(var c=Object(r.__values)(this.values),u=c.next();!u.done;u=c.next()){var d=u.value;if(l.toLowerCase()===d.value.toLowerCase()){var p=d.targetVersion?d.targetVersion:this.targetVersion;return p.compareTo(n.targetVersion)<=0?d.value:(n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(l,this.name,p.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.invalidPropertyValue(l,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,o){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=Object(r.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){var g=p.targetVersion?p.targetVersion:this.targetVersion;if(g.compareTo(o.targetVersion)<=0){c=!1;break}o.logEvent(e,i.x.ToJSON,i.w.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(n,this.name,g.toString(),o.targetVersion.toString()))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||o.serializeValue(t,this.name,n,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:this.values.map((function(e){return e.value})),defaultValue:this.defaultValue,isArray:!1}},t}(g)),v=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=r,s.defaultValue=o,s.onGetInitialValue=a,s._values=[],i)s._values=i;else for(var l in r){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var a,l,c=t[this.name];if("string"!=typeof c)return this.defaultValue;var u=Object(o.b)(this.enumType,c);if(void 0!==u)try{for(var d=Object(r.__values)(this.values),p=d.next();!p.done;p=d.next()){var g=p.value;if(g.value===u){var h=g.targetVersion?g.targetVersion:this.targetVersion;return h.compareTo(n.targetVersion)<=0?u:(n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(c,this.name,h.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){a={error:e}}finally{try{p&&!p.done&&(l=d.return)&&l.call(d)}finally{if(a)throw a.error}}return n.logParseEvent(e,i.w.InvalidPropertyValue,s.a.errors.invalidPropertyValue(c,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,o){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=Object(r.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){if((p.targetVersion?p.targetVersion:this.targetVersion).compareTo(o.targetVersion)<=0){c=!1;break}o.logEvent(e,i.x.ToJSON,i.w.InvalidPropertyValue,s.a.errors.invalidPropertyValue(n,this.name))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||o.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:Object(o.a)(this.enumType),defaultValue:void 0!==this.defaultValue?this.enumType[this.defaultValue]:void 0,isArray:!1}},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(g),b=function(e){function t(t,n,r,o,i){void 0===o&&(o=!1);var a=e.call(this,t,n,i,(function(e){return a.nullable?void 0:a.createInstance()}))||this;return a.targetVersion=t,a.name=n,a.createInstance=r,a.nullable=o,a}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var o=this.createInstance(t);return o.parse(r,n),o},t.prototype.toJSON=function(e,t,n,r){var o;void 0===n||n.hasAllDefaultValues()||(o=n.toJSON(r)),"object"==typeof o&&0===Object.keys(o).length&&(o=void 0),r.serializeValue(t,this.name,o,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueType:new E(this.createInstance()),defaultValue:this.defaultValue,isArray:!1}},t}(g),y=(function(e){function t(t,n,r,o,i,a){void 0===i&&(i=!1);var s=e.call(this,t,n,o,i,a)||this;return s.targetVersion=t,s.name=n,s.objectTypeName=r,s.createInstance=o,s.nullable=i,s}Object(r.__extends)(t,e),t.prototype.parse=function(t,n,r){var o=n[this.name];if("object"==typeof o&&"type"in o&&o.type===this.objectTypeName)return e.prototype.parse.call(this,t,n,r)}}(b),function(e){function t(t,n,r,o){var i=e.call(this,t,n,void 0,(function(e){return[]}))||this;return i.targetVersion=t,i.name=n,i.createInstance=r,i.onItemAdded=o,i}Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=Object(r.__values)(s),c=l.next();!c.done;c=l.next()){var u=c.value,d=this.createInstance(u);d&&(d.parse(u,n),a.push(d),this.onItemAdded&&this.onItemAdded(e,d))}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return a.length>0?a:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){var t=this.createInstance();return{valueType:t?new E(t):"object",defaultValue:this.defaultValue,isArray:!0}}}(g),function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,i,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=r,s.onToJSON=o,s.defaultValue=i,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,r){this.onToJSON(e,this,t,n,r)}}(g),function(){function e(e){this.key=e,this._properties=new Map}return e.prototype.add=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=Object(r.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)||this._properties.set(s.name,s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.remove=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=Object(r.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)&&this._properties.delete(s.name)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.getItem=function(e){return this._properties.get(e)},Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties.values()},enumerable:!1,configurable:!0}),e}()),C=function(){function e(){var t,n;this._isParsing=!1,this._propertyBag={},this._rawProperties={},this.key=e.currentKey++,this.maxVersion=e.defaultMaxVersion;var o=this.getSchema();try{for(var i=Object(r.__values)(o.properties),a=i.next();!a.done;a=i.next()){var s=a.value;s.onGetInitialValue&&this.setValue(s,s.onGetInitialValue(this))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return e.prototype.propertyChanged=function(e,t){this.onPropertyChanged&&this.onPropertyChanged(this,e,t)},e.prototype.afterParse=function(){},e.prototype.getDefaultSerializationContext=function(){return new p},e.prototype.populateSchema=function(t){var n=[];for(var o in this.constructor)try{var i=this.constructor[o];i instanceof g&&n.push(i)}catch(e){}if(n.length>0){var a=n.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,Object(r.__spreadArray)([],Object(r.__read)(a),!1))}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getAttachableProperties=function(e){return[]},e.prototype.internalParse=function(e,t){var n,o;if(!this._isParsing){this._isParsing=!0;try{if(this._propertyBag={},this._rawProperties=a.a.enableFullJsonRoundTrip&&e||{},e){var l=this.getSchema(),c=this.getAdditionalValidSchemaProperties();for(var u in e)l.getItem(u)||c.includes(u)||t.getAttachableElementProperty(u)||t.logParseEvent(this,i.w.UnknownProperty,s.a.errors.unknownProperty(u));var d=Array.from(l.properties).concat(this.getAttachableProperties(t));try{for(var p=Object(r.__values)(d),g=p.next();!g.done;g=p.next()){var h=g.value;if(h.isSerializationEnabled){var f=h.onGetInitialValue?h.onGetInitialValue(this):void 0;e.hasOwnProperty(h.name)&&(h.targetVersion.compareTo(t.targetVersion)<=0?f=h.parse(this,e,t):t.logParseEvent(this,i.w.UnsupportedProperty,s.a.errors.propertyNotSupported(h.name,h.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(h,f)}}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}else this.resetDefaultValues()}finally{this._isParsing=!1,this.afterParse()}}},e.prototype.internalToJSON=function(e,t){var n,o,i=this.getSchema(),a=[];try{for(var s=Object(r.__values)(i.properties),l=s.next();!l.done;l=s.next()){var c=l.value;c.isSerializationEnabled&&c.targetVersion.compareTo(t.targetVersion)<=0&&-1===a.indexOf(c.name)&&(c.toJSON(this,e,this.getValue(c),t),a.push(c.name))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.getAdditionalPropertyDescriptors=function(e){return[]},e.prototype.reflect=function(e){var t,n,o,i,a=this.getSchema(),s=this.getAdditionalPropertyDescriptors(e),l=new Map,c=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(a.properties),!1),Object(r.__read)(this.getAttachableProperties(e)),!1);try{for(var u=Object(r.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value;l.set(p.name,Object(r.__assign)({name:p.name},p.getDescriptor(e)))}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}try{for(var g=Object(r.__values)(s),h=g.next();!h.done;h=g.next()){p=h.value;l.set(p.name,p)}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}return Object(r.__spreadArray)([],Object(r.__read)(l.values()),!1)},e.prototype.getAdditionalValidSchemaProperties=function(){return[]},e.prototype.getSerializationContext=function(){return this.getDefaultSerializationContext()},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){var n=this,r=function(e,t){n._isParsing||n.propertyChanged(e,t)};if(null==t)this._propertyBag.hasOwnProperty(e.getInternalName())&&(delete this._propertyBag[e.getInternalName()],r(e,t));else{var o=e.preProcessValue(t);this._propertyBag[e.getInternalName()]!==o&&(this._propertyBag[e.getInternalName()]=o,r(e,o))}},e.prototype.parse=function(e,t){var n=null!=t?t:this.getSerializationContext();this.internalParse(e,n),n.onAfterObjectParsed&&n.onAfterObjectParsed(this,e)},e.prototype.toJSON=function(e){var t=null!=e?e:this.getSerializationContext();if(this.shouldSerialize(t)){var n=void 0;return n=a.a.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){var e,t,n=this.getSchema();try{for(var o=Object(r.__values)(n.properties),i=o.next();!i.done;i=o.next()){var a=i.value;if(!this.hasDefaultValue(a))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!0},e.prototype.resetDefaultValues=function(){var e,t,n=this.getSchema();try{for(var o=Object(r.__values)(n.properties),i=o.next();!i.done;i=o.next()){var a=i.value;this.setValue(a,a.defaultValue)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new y(this.getSchemaKey()),this.populateSchema(t),e._schemaCache[t.key]=t),t},e.currentKey=0,e.defaultMaxVersion=u.latest,e._schemaCache={},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},t.typeNameProperty=new h(u.v1_0,"type",void 0,void 0,(function(e){return e.getJsonTypeName()})),t}(C),S=function(){},E=(function(e){function t(t,n){var r=e.call(this)||this;return r._name=t,r._properties=n,r}Object(r.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0})}(S),function(e){function t(t,n){var r=e.call(this)||this;return r._objectToReflect=t,r._name=n,r}return Object(r.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties||(this._properties=this._objectToReflect.reflect(e)),this._properties},Object.defineProperty(t.prototype,"name",{get:function(){var e;return null!==(e=this._name)&&void 0!==e?e:this._objectToReflect.getSchemaKey()},enumerable:!1,configurable:!0}),t}(S))},260:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44),o=n(239),i=function(){function e(t){var n,i,a,s,l,c,u,d,p;e.appName=t.appName,e.augloopUrl=null!==(n=t.augloopUrl)&&void 0!==n?n:r.s,e.devBuild=null!==(i=t.devBuild)&&void 0!==i&&i,e.environment=t.environment,e.sessionId=t.sessionId,e.workflow=null!==(a=t.workflow)&&void 0!==a?a:o.h.ACTION_AI,e.appVersion=null!==(s=t.appVersion)&&void 0!==s?s:"",e.appInternalName=null!==(l=t.appInternalName)&&void 0!==l?l:"",e.appPlatform=null!==(c=t.appPlatform)&&void 0!==c?c:"",e.augloopFlights=null!==(u=t.augloopFlights)&&void 0!==u?u:"",e.language=null!==(d=t.language)&&void 0!==d?d:"en-US",e.substrateScenarioName=null!==(p=t.substrateScenarioName)&&void 0!==p?p:"",e.feedbackSettings=t.feedbackSettings}return e.getAppName=function(){return e.appName},e.getAugloopUrl=function(){return e.augloopUrl},e.isDevbuild=function(){return e.devBuild},e.getEnvironment=function(){return e.environment},e.getSessionId=function(){return e.sessionId},e.getWorkflowType=function(){return e.workflow},e.getAppVersion=function(){return e.appVersion},e.getAppInternalName=function(){return e.appInternalName},e.getAppPlatform=function(){return e.appPlatform},e.getAugloopFlights=function(){return e.augloopFlights},e.getLanguage=function(){return e.language},e.getSubstrateScenarioName=function(){return e.substrateScenarioName},e.getFeedbackSettings=function(){return e.feedbackSettings},e}()},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1064),o=n(771),i=n(181),a=n(1453),s=n(188),l=!1;function c(){l||(Object(r.a)(),Object(a.a)(),i.f.defaultElements.registerAttachableProperty(s.f),s.f.isSerializationEnabled=!1,s.a.themedUrlsProperty.isSerializationEnabled=!1,s.e.layoutsProperty.isSerializationEnabled=!1,s.e.showBorderProperty.isSerializationEnabled=!1,s.e.roundedCornersProperty.isSerializationEnabled=!1,o.b.conditionallyEnabledProperty.isSerializationEnabled=!1,l=!0)}},2678:function(e,t,n){e.exports=n.p+"assets/feedback-nudge.svg"},2680:function(e,t,n){"use strict";function r(e){var t,n,r,o,i,a;const s=null!==(t=e.titleDefinition)&&void 0!==t?t:e.unfurlingTitlePreviewDefinition;let l,c,u;if(Array.isArray(null==s?void 0:s.elementDefinitions)){const e=null===(n=null==s?void 0:s.elementDefinitions)||void 0===n?void 0:n.find((e=>"ComposeExtensions"===e.elementType));e&&e.definition&&(l=JSON.parse(e.definition),Array.isArray(l)||(l=[l]))}else l=null===(r=s.elementDefinitions)||void 0===r?void 0:r.composeExtensions,c=null===(o=s.elementDefinitions)||void 0===o?void 0:o.plugins;switch(e.acquisitionState.toLowerCase()){case"acquired":u="Installed";break;case"blocked":u="Blocked";break;case"needsconsentforupgrade":u="RequireConsent";break;default:u="NotInstalled"}return{id:e.appId,name:null==s?void 0:s.name,manifestVersion:s.manifestVersion,developerName:s.developerName,isFullTrust:s.isFullTrust,devicePermissions:s.devicePermissions,inputExtensions:l,webApplicationInfo:s.webApplicationInfo,showLoadingIndicator:s.showLoadingIndicator,shortDescription:s.shortDescription,largeImageUrl:null===(i=s.iconLarge)||void 0===i?void 0:i.uri,smallImageUrl:null===(a=s.iconSmall)||void 0===a?void 0:a.uri,state:u,version:s.version,validDomains:s.validDomains,privacyUrl:s.privacyUrl,plugins:c}}n.d(t,"a",(function(){return r}))},2681:function(e,t,n){"use strict";function r(e){const t=e.inputExtensions;if(!t||0===t.length)return;let n;return t.forEach((e=>{var t;const r=null===(t=null==e?void 0:e.commands)||void 0===t?void 0:t.find((e=>e.initialRun));r&&(n=r.id)})),n}n.d(t,"a",(function(){return r}))},2682:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtCardService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.apply(this,arguments)}return t=l,(n=[{key:"handleMentions",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}},{key:"handleMentionClick",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(1446).CardService);t.MsgExtCardService=l},2683:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExt3SChannelService=void 0;var o=n(2159),i=n(1446),a=n(1469);function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(r||[]);return o(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,a)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(o,a,s,l){var c=p(e[o],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,o(C,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,a,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,n,r,i,p,g=d(h);function h(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(r=g.call(this,e,t)).tokenService=e,r.hostContext=t,r.conversationId=n,r.endpointUrl="https://substrate.office.com/search/api/v1/",r.tokenScope="https://substrate.office.com/search/SubstrateSearch-Internal.ReadWrite",r}return t=h,n=[{key:"verifyCard",value:(i=s().mark((function e(t){var n,r,i,l,c,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.endpointUrl,"verifyCards"),e.next=3,this.getInvokeRequestHeaders();case 3:return r=e.sent,i={method:"POST",headers:r,body:JSON.stringify({Cvid:this.conversationId,LogicalId:(0,a.generateGuid)(),Request:[{cardId:t.cardDetails.cardId,content:t.cardDetails.content,signature:t.cardDetails.signature,extension:{updateExtendedProps:{mailId:this.conversationId,cardId:t.cardDetails.cardId,contentType:t.cardDetails.contentType,appName:t.cardDetails.appName,appIcon:t.cardDetails.appIcon}}}]})},e.next=7,(0,o.fetchWithTimeout)(n,i);case 7:if((l=e.sent).ok){e.next=10;break}throw l;case 10:return e.next=12,l.json();case 12:if(!((c=e.sent).cards instanceof Array)){e.next=16;break}return u={cardId:c.cards[0].cardId,verificationStatus:c.cards[0].verificationStatus},e.abrupt("return",Promise.resolve(u));case 16:return e.abrupt("return",Promise.reject(new Error("Invalid response from verifyCard API")));case 17:case"end":return e.stop()}}),e,this)})),p=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){l(o,n,r,a,s,"next",e)}function s(e){l(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return p.apply(this,arguments)})}],n&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(i.ChannelService);t.MsgExt3SChannelService=g},2684:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtHostService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(e,t,n,r,o,i,a,c,u,d,p){var g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(g=s.call(this,e,t,n,r,o,i,d,p)).getContainer=e,g.userContext=t,g.hostContext=n,g.appService=r,g.tokenService=o,g.openLaunchPage=i,g.copyCard=a,g.deleteCard=c,g.embedCard=u,g.channelService=d,g.telemetryService=p,g}return t=l,(n=[{key:"makeCustomAnnouncement",value:function(e){var t=document.createElement("div"),n="SearchMEAnnounce-"+String(Date.now());t.setAttribute("id",n),t.setAttribute("aria-live","assertive"),t.classList.add("visually-hidden"),document.body.appendChild(t),window.setTimeout((function(){var t=document.getElementById(n);t&&(t.textContent=e.text)}),100),window.setTimeout((function(){var e=document.getElementById(n);e&&document.body.removeChild(e)}),1e3)}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(2085).WebHostService);t.MsgExtHostService=l},2685:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHostService=void 0;var r=n(2792),o=n(173),i=n(270),a=n(2686),s=n(2687),l=n(2688);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(){u=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};l(v,i,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,i)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function o(r,i,a,s){var l=p(e[r],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==c(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),l(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),l(C,s,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function d(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===c(i)?i:String(i)),r)}var o,i}var h=function(){function e(t,n,r,o,i,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getContainer=t,this.userContext=n,this.hostContext=r,this.appService=o,this.tokenService=i,this.openLaunchPage=a,this.channelService=s,this.telemetryService=l}var t,n,c,d,h,f,m,v,b;return t=e,n=[{key:"getImage",value:(b=p(u().mark((function e(t){var n,r,o,i,s,l,c,d,p,g,h,f,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.hostContext.host.name===a.BingHub?a.BingImageProxyEndpoint:a.DefaultImageProxyRelativeEndpoint,e.next=3,caches.open("image-cache");case 3:return i=e.sent,s=this.getCacheKey(t),e.next=7,i.match(s);case 7:if(!(l=e.sent)){e.next=15;break}return e.t0=URL,e.next=12,l.blob();case 12:return e.t1=e.sent,c=e.t0.createObjectURL.call(e.t0,e.t1),e.abrupt("return",Promise.resolve({url:c}));case 15:if(void 0!==(null===(n=this.userContext)||void 0===n?void 0:n.userPrincipalName)){e.next=17;break}return e.abrupt("return",Promise.reject(new Error("User principal name is not available")));case 17:return d=this.userContext.userPrincipalName?"".concat(o,"/").concat(this.userContext.userPrincipalName,"/th?u=").concat(encodeURIComponent(t.url)):"".concat(o,"/th?u=").concat(encodeURIComponent(t.url)),p=new Headers,e.next=21,this.tokenService.getToken({resource:a.Resource});case 21:return(g=e.sent)&&(null==g?void 0:g.authToken)&&p.set("Authorization","Bearer ".concat(g.authToken)),this.userContext.userPrincipalName&&(p.set("X-RoutingParameter-SessionKey",this.userContext.userPrincipalName),p.set("X-AnchorMailbox",this.userContext.userPrincipalName)),h={method:"GET",headers:p},e.prev=25,e.next=28,fetch(d,h);case 28:if(!(f=e.sent).ok||0!==(null===(r=f.headers.get("Content-Type"))||void 0===r?void 0:r.indexOf("image"))){e.next=40;break}return e.next=32,i.put(s,f.clone());case 32:return e.t2=URL,e.next=35,f.blob();case 35:return e.t3=e.sent,m=e.t2.createObjectURL.call(e.t2,e.t3),e.abrupt("return",Promise.resolve({url:m}));case 40:return e.abrupt("return",Promise.resolve({url:a.DefaultPlaceholderImage}));case 41:e.next=46;break;case 43:return e.prev=43,e.t4=e.catch(25),e.abrupt("return",Promise.reject(new Error("Failed to get image. Error: "+String(e.t4))));case 46:case"end":return e.stop()}}),e,this,[[25,43]])}))),function(e){return b.apply(this,arguments)})},{key:"openUrl",value:function(e){return window.open(e.url),Promise.resolve({status:"Success"})}},{key:"handleAuth",value:(v=p(u().mark((function e(t){var n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var a,l={user:n.userContext,app:n.hostContext,page:{id:(null===(a=t.appDefinition)||void 0===a?void 0:a.id)||"",frameContext:i.FrameContexts.authentication}},c=function(t){return function(n,r){return t?(e({code:n}),Promise.resolve()):(o(n),Promise.resolve())}},u=new r.WindowAuthenticationService(c(!0),c(!1),n.tokenService,n.userContext);(0,s.handleAuth)(n.getContainer(),t,u,l,n.telemetryService).catch((function(e){}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"handleJITInstall",value:function(e){throw new Error("Method not implemented.")}},{key:"openTaskModule",value:(m=p(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,l.sanitizeTaskInfo)(t.taskInfo),!(n=this.getDialogFromTaskInfo(t.taskInfo))){e.next=6;break}return e.next=5,this.openDialog(n,t.appId);case 5:return e.abrupt("return",Promise.resolve({status:"Success"}));case 6:return e.abrupt("return",Promise.reject());case 7:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"openStageView",value:(f=p(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getDialogFromStageInfo(t.stageInfo))){e.next=5;break}return e.next=4,this.openDialog(n,t.appId);case 4:return e.abrupt("return",Promise.resolve({status:"Success"}));case 5:return e.abrupt("return",Promise.reject());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"logTelemetry",value:function(e){throw new Error("Method not implemented.")}},{key:"getHostContext",value:function(){var e,t,n={locale:this.hostContext.locale,timeZone:null===(e=this.hostContext.osLocaleInfo)||void 0===e?void 0:e.longDate,timeOffset:null===(t=this.hostContext.osLocaleInfo)||void 0===t?void 0:t.regionalFormat,theme:this.hostContext.theme==i.Themes.dark?i.Themes.dark:i.Themes.default};return Promise.resolve(n)}},{key:"getCacheKey",value:function(e){return e.url}},{key:"getDialogFromTaskInfo",value:function(e){return e.card?Object.assign({type:i.DialogContentType.Card},e):e.url?Object.assign({type:i.DialogContentType.Url},e):void 0}},{key:"getDialogFromStageInfo",value:function(e){var t,n,r=null!==(t=e.contentUrl)&&void 0!==t?t:e.websiteUrl;if(r)return{type:i.DialogContentType.Url,width:.9*window.innerWidth,height:.9*window.innerHeight,title:null!==(n=e.name)&&void 0!==n?n:"",url:r}}},{key:"openDialog",value:(h=p(u().mark((function e(t,n){var o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAppDefinition(n);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject("App definition not found"));case 5:t&&(0,r.openDialog)(t,this.getContainer(),this.channelService,o,this.tokenService,this.userContext,this.hostContext);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getAppDefinition",value:(d=p(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.appService.getApp({id:t});case 2:return n=e.sent,!(r=null==n?void 0:n.appDefinition)&&(null==n?void 0:n.titleInfo)&&(r=(0,o.convertTitleInfoToAppDefinition)(n.titleInfo)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})}],n&&g(t.prototype,n),c&&g(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.WebHostService=h},2686:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=t.DefaultPlaceholderImage=t.DefaultImageProxyRelativeEndpoint=t.BingImageProxyEndpoint=t.BingHub=void 0;t.Resource="https://outlook.office365.com/connectors";t.DefaultPlaceholderImage="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";t.DefaultImageProxyRelativeEndpoint="/actionsb2netcore";t.BingImageProxyEndpoint="https://outlook.office.com/actionsb2netcore";t.BingHub="Orange"},2687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAuth=function(e,t,n,r,o){return c.apply(this,arguments)};var r=n(270);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,s,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,s)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(r,a,s,l){var c=p(e[r],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==o(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,s,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}var s=800,l=600;function c(){var e;return e=i().mark((function e(t,n,o,a,c){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var u,d=t.ownerDocument.defaultView;if(d){var p=(0,r.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n.appDefinition),{version:null!==(u=n.appDefinition.version)&&void 0!==u?u:"",appId:n.appDefinition.id})),g={url:n.signInUrl,width:s,height:l,left:d.screen.availWidth/2-s/2,top:d.screen.availHeight/2-l/2};new r.MetaOSAuthExtension(d,g,p,o,a,c)?e(void 0):i("Unable to initialize auth extension")}else i("Window object is null")})));case 1:case"end":return e.stop()}}),e)})),c=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))},c.apply(this,arguments)}},2688:function(e,t,n){"use strict";function r(e){if(!e&&"string"!=typeof e&&"number"!=typeof e)return-1;if("string"==typeof e){var t=e,n=parseInt(t);if(!isNaN(n))return n;switch(t.toLowerCase()){case"large":return-3;case"medium":return-2;default:return-1}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeTaskInfo=function(e){e.width=r(e.width),e.height=r(e.height),e.card&&"string"!=typeof e.card&&(e.card=JSON.stringify(e.card))}},2689:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtPreviewHostService=void 0;var o=n(2812),i=n(2085),a=n(1526),s=n(270);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,r,i=u(d);function d(e,t,n,r,o,a,s,l,c){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(u=i.call(this,e,t,n,r,o,a,s,l)).displayExternalUrlWarning=c,u}return t=d,(n=[{key:"openUrl",value:function(e){var t,n,r=this;if(null===(t=e.cardData)||void 0===t?void 0:t.appId){var o=e.cardData.appId;return new Promise((function(t,n){r.getAppDefinition(o).then((function(n){var o,i;if(n){var a=(0,s.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n),{version:null!==(o=n.version)&&void 0!==o?o:"",appId:n.id}));if((0,s.isValidUrlForApp)(e.url,a))return window.open(e.url),Promise.resolve({status:"Success"})}t(r.openUrlWithWarning(e.url,null===(i=e.cardData)||void 0===i?void 0:i.cardId))})).catch((function(){var n;t(r.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId))}))}))}return this.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId)}},{key:"openUrlWithWarning",value:function(e,t){var n,r;return null!==(r=null===(n=this.displayExternalUrlWarning)||void 0===n?void 0:n.call(this,t).then((function(){return window.open(e),Promise.resolve({status:"Success"})})).catch((function(e){return Promise.reject(e)})))&&void 0!==r?r:Promise.reject("Unable to display open external url warning")}},{key:"copyCard",value:function(e){var t,n=e.cardDetails;if(n&&n.contentType==a.M365CardContentType.AdaptiveCard){var r=JSON.parse(n.content);if(r){var i=null===(t=r.metadata)||void 0===t?void 0:t.webUrl;i&&(0,o.copyTextToClipboard)(i,document)}}}},{key:"deleteCard",value:function(e){throw new Error("Method not implemented.")}},{key:"embedCard",value:function(e){throw new Error("Method not implemented.")}},{key:"makeCustomAnnouncement",value:function(e){throw new Error("Method not implemented.")}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.WebHostService);t.MsgExtPreviewHostService=p},2690:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerfMarker=void 0;var r=n(2813);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}var a=6e4,s=function(){function e(t,n,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=t,this.name=n,this.telemetryService=o,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((function(){i.log({type:r.LogType.LogMetric,tag:i.tag,name:i.name,success:r.SuccessStatus.Timeout,duration:a,diagnosticsData:"Ended with Timeout",source:-1}),i.isTimeout=!0}),a)}var t,n,o;return t=e,(n=[{key:"logMetricEnd",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Successful,duration:n,correlationVector:t,source:-1}))}}},{key:"logMetricEndWithError",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Failure,duration:n,correlationVector:t,source:-1}))}}},{key:"log",value:function(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PerfMarker=s},2691:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapStringsWithPlaceholdersToStandardFormat=t.mapStringsToStandardFormat=t.declarePluralStringWithPlaceholders=t.declarePluralString=void 0;var r=n(2815),o=n(2090),i=n(1746),a=n(1337),s=n(1747),l=n(1522);function c(e){var t=e.comment,n=e.placeholders,i=e.strings,s={comment:t,placeholders:n,text:function(e){return(0,r.createICUString)((0,a.doPseudoLocalization)()?(0,o.pseudoLocalizePluralWithPlaceholders)(i,e):i(e))}};return s}t.declarePluralString=function(e,t){var n=t&&{text:(0,r.createICUString)(t.strings),comment:t.comment},a=function(t){return void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,o.resolveString)(e,n,t)};return a.toString=a,a.key=e,a},t.declarePluralStringWithPlaceholders=function(e,t){var n=t&&c(t),r=function(t,r){return void 0===r&&(r=(0,i.getDefaultStringProvider)()),(0,o.resolveStringWithPlaceholders)(e,n,r,{alreadyPseudoLocalized:!0})(t)};return r.toString=function(t){return void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,a.isDevLocalization)()&&n||!(0,l.stringExists)(e,t)&&n?(0,s.getStringDescriptionWithPlaceholders)(e,n).stringToBeLocalized:(0,l.lookUpString)(e,t)},r.key=e,r},t.mapStringsToStandardFormat=function(e){var t=e.comment,n=e.strings;return{text:(0,r.createICUString)(n),comment:t}},t.mapStringsWithPlaceholdersToStandardFormat=c},2692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalize=void 0;var r={a:"ȧ",A:"Ȧ",b:"ƀ",B:"Ɓ",c:"ƈ",C:"Ƈ",d:"ḓ",D:"Ḓ",e:"ḗ",E:"Ḗ",f:"ƒ",F:"Ƒ",g:"ɠ",G:"Ɠ",h:"ħ",H:"Ħ",i:"ī",I:"Ī",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"ŀ",L:"Ŀ",m:"ḿ",M:"Ḿ",n:"ƞ",N:"Ƞ",o:"ǿ",O:"Ǿ",p:"ƥ",P:"Ƥ",q:"ɋ",Q:"Ɋ",r:"ř",R:"Ř",s:"ş",S:"Ş",t:"ŧ",T:"Ŧ",v:"ṽ",V:"Ṽ",u:"ŭ",U:"Ŭ",w:"ẇ",W:"Ẇ",x:"ẋ",X:"Ẋ",y:"ẏ",Y:"Ẏ",z:"ẑ",Z:"Ẑ"};t.pseudoLocalize=function(e){return e.split("").reduce((function(e,t){var n=r[t]||t,o=n+(function(e){return"aeiou".indexOf(e.toLowerCase())>=0}(t)?n:"");return e+o}),"")}},2693:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetStringMapLoader=void 0;var r=n(2093);t.makeGetStringMapLoader=function(e){return function(t){var n=function(t){return e((0,r.toSupportedLocale)(t,"en-us"))};return t?e((0,r.toSupportedLocale)(t,"en-us")).catch((function(){})).then((function(){return n})):Promise.resolve(n)}}},2694:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=n(147),i=n(32),a=n(693),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];return"string"==typeof r?Number(r):Object(o.j)(r,this.defaultValue)},t}(i.g),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){return void 0===this.value?!this.isRequired:this.isValidValue(this.value)},t.prototype.isValidValue=function(e){var t=!0;return void 0!==this.min&&(t=t&&e>=this.min),void 0!==this.max&&(t=t&&e<=this.max),t},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueProperty=new s(i.s.v1_0,"value"),t.placeholderProperty=new i.n(i.s.v1_0,"placeholder"),t.minProperty=new i.g(i.s.v1_0,"min"),t.maxProperty=new i.g(i.s.v1_0,"max"),t}(a.a)},2695:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=n(1),i=n(773),a=n(32),s=n(28),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{get:function(){return this.getValue(t.maxLengthProperty)},set:function(e){this.setValue(t.maxLengthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMultiline",{get:function(){return this.getValue(t.isMultilineProperty)},set:function(e){this.setValue(t.isMultilineProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inlineAction",{get:function(){return this.getValue(t.inlineActionProperty)},set:function(e){this.setValue(t.inlineActionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"regex",{get:function(){return this.getValue(t.regexProperty)},set:function(e){this.setValue(t.regexProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderExtraContent=function(){return this.inlineAction?o.createElement(this.inlineAction.Render,{args:{isInline:!0}}):null},t.prototype.executeValueChangedAction=function(){var e;null===(e=this.valueChangedAction)||void 0===e||e.execute(t.valueChangedActionExecutionDelay)},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.inlineAction&&t.push(this.inlineAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isDirty=function(){var e=""!==this.value?this.value:void 0,t=""!==this._oldValue?this._oldValue:void 0;return this.isSet()&&e!==t},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return this.value?this.isValidValue(this.value):!this.isRequired},t.prototype.isValidValue=function(e){return!this.regex||new RegExp(this.regex,"g").test(e)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueChangedActionExecutionDelay=1e3,t.valueProperty=new a.n(a.s.v1_0,"value"),t.maxLengthProperty=new a.g(a.s.v1_0,"maxLength"),t.isMultilineProperty=new a.b(a.s.v1_0,"isMultiline",!1),t.placeholderProperty=new a.n(a.s.v1_0,"placeholder"),t.styleProperty=new a.e(a.s.v1_0,"style",s.o,s.o.Text,[{value:s.o.Text},{value:s.o.Tel},{value:s.o.Url},{value:s.o.Email},{value:s.o.Password,targetVersion:a.s.v1_5}]),t.inlineActionProperty=new i.a(a.s.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new a.n(a.s.v1_3,"regex"),t}(n(693).a)},2696:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=n(32),i=n(693),a="true",s="false",l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueOn",{get:function(){return this.getValue(t.valueOnProperty)},set:function(e){this.setValue(t.valueOnProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueOff",{get:function(){return this.getValue(t.valueOffProperty)},set:function(e){this.setValue(t.valueOffProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.isValidValue=function(e){return e===this.valueOn||e===this.valueOff},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueProperty=new o.n(o.s.v1_0,"value",void 0,s),t.titleProperty=new o.n(o.s.v1_0,"title"),t.valueOnProperty=new o.n(o.s.v1_0,"valueOn",void 0,a,(function(e){return a})),t.valueOffProperty=new o.n(o.s.v1_0,"valueOff",void 0,s,(function(e){return s})),t.wrapProperty=new o.b(o.s.v1_2,"wrap",!0),t}(i.a)},2697:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(133),o=n(144),i=function(){function e(){this.correlationId=""}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.prototype.getLogMessage=function(t,n,r){var i="tag_".concat(e.tagIntToString(t)," [").concat(o.a[n],"] ").concat(r);return this.correlationId&&""!==this.correlationId&&(i+="\t\t".concat(this.correlationId)),i},e.prototype.sendTraceTag=function(e,t,n,o){var i=this.logMessage;switch(n){case r.a.Error:i=this.logError;break;case r.a.Warning:i=this.logWarning;break;case r.a.Info:i=this.logInfo;break;case r.a.Verbose:i=this.logVerbose;break;case r.a.Spam:default:i=this.logMessage}try{i(this.getLogMessage(e,t,o))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(e,t,n,r){console.assert(n,this.getLogMessage(e,t,r))},e.prototype.debugAssertTag=function(e,t,n,r){this.shipAssertTag(e,t,n,r)},e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}()},27:function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.WordRibbonStrings=void 0,t.WordRibbonStrings={About:"About",AboutFollowUps:"about Follow-ups",AboutFollowUpsLearnMore:"Learn more",AboutKeytip:"D",Above:"Above",AcceptAllChanges:"Accept All Changes",AcceptAllChangesKeytip:"B",AcceptChange:"Accept",AcceptChangeKeytip:"A2",AcceptChangeAndMoveToNext:"Accept And Move To Next",AcceptChangeAndMoveToNextKeytip:"A",Accessibility:"Accessibility",AccessibilityHelp:"Accessibility Help (Alt+Shift+A)",AccessibilityHelpDescription:"Find out about accessibility features in Word Online.",AccessibilityHelpKeytip:"A",AccessibilityMode:"Accessibility Mode",AccessibilityTab:"Accessibility",AccessibilityTabKeyTip:"A",Acronyms:"Acronyms",AcronymsKeytip:"AC",AppHomeButtonAriaLabel:"Word, click to open Word home page",AppHomeButtonTooltip:"Word home",Citation:"Citations",CitationAndBibliography:"Citation & Bibliography",CitationKeytip:"C",Activity:"Edit Activity",ActivityContextMenuLabel:"Show new changes",AdaptiveGroupTitle:"Current Selection",AddCentreTabStop:"Add centre tab stop",AddInsKeytipPrefix:"Y",AdditionalControls:"Additional Controls",AddLeftTabStop:"Add left tab stop",AddRightTabStop:"Add right tab stop",AddSpaceAfterParagraph:"Add Space After Paragraph",AddSpaceAfterParagraphKeytip:"A",AddSpaceBeforeParagraph:"Add Space Before Paragraph",AddSpaceBeforeParagraphKeytip:"B",AddSpacingAfter:"Add Spacing After",AddSpacingBefore:"Add Spacing Before",AddToHeaderOrFooter:"Add to Header or Footer",AlignLeft:"Align Left",AlignLeftKeytip:"AL",AlignRight:"Align Right",AlignRightKeytip:"AR",AlignTextLeft:"Align Text Left",AlignTextLeftKeytip:"AL",AlignTextRight:"Align Text Right",AlignTextRightKeytip:"AR",AlignmentMenuLabel:"Alignment",AllBookmarks:"All Bookmarks",AllBookmarksKeytip:"A",AllBorders:"All Borders",AllBordersKeyTip:"A",AltText:"Alt Text",AltTextPictureStandalone:"Edit Picture Alt Text",AltTextTableStandalone:"Edit Table Alt Text",AltTextKeytip:"E",ApplyStyle:"Apply Style",ApplyStyleSelection:"Apply to selection",UpdateStyleSelection:"Update to match selection",ApplyStyleSelectionKeytip:"AS",UpdateStyleSelectionKeytip:"U",ApplyStylesKeytip:"A",AtAGlance:"At a glance",AtAGlanceKeytip:"AG",AutoCorrectOptions:"AutoCorrect Options",AutoCorrectOptionsKeytip:"A",AutoDetectedHeadingsFeatureName:"Automatically detected headings",AutoDetectedHeadingsShow:"Show",AutoDetectedHeadingsHide:"Hide",AutoDetectedHeadingsMoreInfo:"If this is turned on, the outline will include headings that are automatically detected based on your formatting.",AutoDetectedHeadingsDisabledMoreInfo:"This is turned off because Word didn’t automatically detect any headings that could be added to the outline.",AutoDetectedHeadingsLearnMore:"Learn more",AutomaticFontColor:"Automatic",BarTab:"Bar Tab",BarTabStop:"Bar tab stop",Below:"Below",BevelEdgeRectangle:"Bevel Rectangle",BeveledMatteWhite:"Beveled Matte, White",BeveledOvalBlack:"Beveled Oval, Black",BevelPerspective:"Bevel Perspective",BevelPerspectiveLeftWhite:"Bevel Perspective Left, White",Bing:"Bing Pictures",BlankDocument:"Blank document",BlankDocumentKeytip:"B",Bold:"Bold",BoldKeytip:"1",Bookmarks:"Bookmarks",BookmarksKeytip:"K",BorderColor:"Border Color",BorderColorKeytip:"C",BorderLineStyle:"Style",BorderLineStyleKeyTip:"Y",BorderLineWeight:"Weight",BorderLineWeightKeyTip:"W",BorderSelection:"Border Selection",BorderSelectionKeytip:"B",BottomBorder:"Bottom Border",BottomBorderKeyTip:"B",BottomMargin:"Bottom Margin",BrowseTemplates:"Browse templates",BrowseTemplatesKeytip:"B",BtnHeaderFooter:"Header & Footer",BtnHeaderFooterKeytip:"H",BulletLibraryTitle:"Bullet Library",BulletsInDocumentTitle:"Document Bullets",BulletStyle1:"Solid Bullet",BulletStyle1Keytip:"S",BulletStyle2:"Hollow Bullet",BulletStyle2Keytip:"H",BulletStyle3:"Square Bullet",BulletStyle3Keytip:"B",BusinessBarCompatMessage:"Functionality is currently limited.",BusinessBarCompatTitle:"Compatibility Mode",BusinessBarContainsMalformedHyperlinkUris:"This document contains malformed hyperlink URIs. Editing this document will cause those hyperlinks to be removed.",BusinessBarMarkedAsFinal:"This document has been marked as final. Saving changes will remove that status.",BusinessBarODTDocument:"Some compatibility issues could occur if you edit this file.",BusinessBarODTDocumentDetailsLink:"Details...",BusinessBarODTDocumentTitle:"ODT Document",BusinessBarReadOnlyRecommended:"The author of this document suggests that you don't edit it.",BusinessBarSigned:"This document was digitally signed. Saving changes will invalidate the digital signature.",ButtonOfficeAddins:"Add-ins",ButtonOfficeAddins1:"Apps",ButtonOfficeAddins2:"All Apps",ButtonOfficeAddinsKeytip:"A",ButtonAddinsHomeEntryKeytip:"AP",Cancel:"Cancel",CatchUpActivity:"Catch up",CatchUpActivityKeytip:"ZA",Cell:"Cell",CenterTab:"Center Tab",CenterTabStop:"Center tab stop",CenterShadowRectangle:"Center Shadow Rectangle",CentimeterUnitPlaceholder:"{0} cm",ChangeCase:"Change Case",ChangeCaseKeytip:"7",ChangeCaseCapitalizeEachWord:"Capitalize Each Word",ChangeCaseLower:"lower case",ChangeCaseSentence:"Sentence case.",ChangeCaseToggle:"tOGGLE cASE",ChangeCaseUpper:"UPPER CASE",ChangePicture:"Change Picture",ChangePictureKeytip:"PC",ChangePictureFromBingPicture:"From Web",ChangePictureFromBingPictureKeytip:"F",ChangePictureFromHost:"From {0}",ChangePictureFromHostKeytip:"G",ChangePictureFromLocalDevice:"From This Device",ChangePictureFromLocalDeviceKeytip:"P",ChangePictureFromMobileDevice:"From Mobile Device",ChangePictureFromMobileDeviceKeytip:"M",ChangePictureFromOneDrive:"From OneDrive",ChangePictureFromOneDriveKeytip:"O",ChangePictureFromOnlineM365Picture:"From Stock Images",ChangePictureFromOnlineM365PictureKeytip:"S",CharacterUnitPlaceholder:"{0} ch",Checklist:"Loop Checklist",ChecklistKeytip:"C",ClassicView:"Classic View",ClassicViewKeytip:"C",Clear:"Clear",ClearAllTabStops:"Clear all tab stops",ClearButtonTooltip:"Clear search and other search options",ClearButtonTooltipV2:"Clear search",ClearFormattingOfSelection:"Clear Formatting of Selection",ClearFormatting:"Clear Formatting",ClearFormattingKeytip:"E",ClearFormattingOneLineRibbonKeytip:"C",ClearPictureStyle:"Clear Style",ClearPictureStyleStandalone:"Clear Picture Style",ClearReplace:"Clear replace",ClearSearch:"Clear search",ClearTableFormatting:"Clear",ClearTableFormattingStandalone:"Clear Table Style",ClearTableFormattingKeytip:"C",ClipArt:"Clip Art",ClipArtKeytip:"C",ClipboardKeytip:"C",Close:"Close",CloseMenu:"Close Menu",CloseHeadersFooters:"Close Preview",CloseHeadersFootersKeytip:"C",CoauthorGalleryGroupChat:"Join group chat",CoauthorGalleryGroupChatKeytip:"C",CoauthorGalleryKeytip:"Z",CoauthorGalleryStatusLabel:"{0} other people are here",CoauthorGalleryOverflowTitle:"Also here: {0}",CoauthorGalleryTooltip:"Everyone who has this document open",CoauthorEnterString:"{0} is editing the document",CollapseAllHeadings:"Collapse All Headings",CollapseHeading:"Collapse Heading",Column:"Column",ColumnSpacing:"Column Spacing",ContentCredentials:"Content Credentials",ContentCredentialsUnavailable:"No valid content credentials available",ContentCredentialsDynamicDescription:"Created with {0} {1}",ContentCredentialsDefaultDescription:"Content credentials provide confident information about the image's history and its origin.",ContentCredentialsKeytip:"CR",ContinueNumbering:"Continue Numbering",ContractEntitiesExplanation:"Discovered named entities will be listed here.",ContractEntitiesTab:"Entities",Conversation:"Conversation",Comment:"Comment",CommentKeytip:"L",Comments:"Comments",CommentsKeytip:"ZC",CommentsTooltip:"More Comment Options",CompoundFrameBlack:"Compound Frame, Black",ContactCardButton:"Open contact card",ContactCardButtonKeytip:"I",ContactSupport:"Contact Support",ContactSupportKeytip:"C",ContinuousView:"Continuous View",ContinuousViewKeytip:"C",ConvertToPresentationKeytip:"D",Syntex:"Syntex",SyntexTabKeyTip:"S",SyntexManageTemplates:"Manage templates",SyntexManageTemplatesKeyTip:"ST",SyntexManageSnippets:"Manage snippets",SyntexManageSnippetsKeyTip:"SS",SyntexDocumentGeneration:"Generate documents",SyntexDocumentGenerationKeyTip:"SD",SyntexGroupKeyTip:"SG",Copilot:"Copilot",CopilotChat:"Copilot",CopilotChatKeyTip:"FX",CopilotComposeDraftContentMenuItemLabel:"Draft with Copilot",CopilotComposeDraftWithSelectionContentMenuItemLabel:"Write a prompt...",CopilotComposeRewriteContentMenuItemLabel:"Rewrite with Copilot",CopilotComposeVisualizeAsTableContentMenuItemLabel:"Visualize as a Table",CopilotComposeVisualizeAsListContentMenuItemLabel:"Visualize as List",CopilotComposeDraftContentMenuItemShortcutDefault:"Alt+I",CopilotComposeDraftContentMenuItemShortcutMac:"Cmd+\\",Copy:"Copy",CopyHeadingLink:"Copy Link to Heading",CopyHyperlink:"Copy Link",CopyKeyboardShortcutMac:"⌘+C",CopyKeyboardShortcutWindows:"Ctrl+C",CopyKeytip:"C",CopyDocumentLink:"Copy link to this document",CopyDocumentLinkKeytip:"C",CopyLinkKeytip:"ZL",CopyLinkMenuButtonKeytip:"C",CopyTo:"Copy To",Corrections:"Corrections",CreateACopy:"Create a Copy",CreateACopyKeytip:"C",CreateACopyOnline:"Create a copy online",CreateACopyOnlineKeytip:"C",CreateNewStyleFromSelection:"Create New Style from Selection",CreateNewStyle:"Create New Style from Formatting...",CreateNewStyleKeytip:"S",CreatePullQuote:"Add visual emphasis to text",Crop:"Crop",CropKeytip:"V",CropMoreOptions:"More Crop Options...",CropMoreOptionsKeytip:"M",CropOptions:"Crop Options...",CustomTables:"Custom Tables",CustomTabStop:"Custom tab stop",Cut:"Cut",CutKeyboardShortcutMac:"⌘+X",CutKeyboardShortcutWindows:"Ctrl+X",CutKeytip:"X",DarkModeGroupTitle:"Dark Mode",DarkModeGroupTitleTooltip:"More Theme Options",DarkModeToggle:"Dark Mode",DarkModeToggleKeytip:"D",DarkModeSwitchBackground:"Switch Background",DarkModeSwitchBackgroundAriaLabel:"Switch Background: dark mode",DarkModeSwitchBackgroundKeytip:"M1",DarkModeSwitchBackgroundTooltipDark:"Switch to dark background",DarkModeSwitchBackgroundTooltipLight:"Switch to light background",DecimalTab:"Decimal Tab",DecimalTabStop:"Decimal tab stop",DecreaseIndent:"Decrease Indent",DecreaseIndentKeytip:"AO",DefineNewBullet:"Define New Bullet",DefineNewBulletKeytip:"D",DefaultTableBorderLineStyle:"Solid",DegreeUnitPlaceholder:"{0}°",Delete:"Delete",DeleteAllComments:"Delete All Comments in Document",DeleteAllCommentsKeytip:"O",DeleteAllResolvedComments:"Delete All Resolved Comments",DeleteAllResolvedCommentsKeytip:"R",DeleteBookmark:"Remove Bookmark",DeleteBookmarkFloatieLabel:"Remove",DeleteCells:"Delete Cells",DeleteCellsKeytip:"DD",DeleteColumn:"Delete Column",DeleteColumnKeytip:"DC",DeleteComment:"Delete",DeleteCommentStandalone:"Delete Comment",DeleteCommentKeytip:"D",DeleteKeytip:"DD",DeleteEntireColumn:"Delete Entire Column",DeleteEntireRow:"Delete Entire Row",DeleteRepeatedWord:"Delete Repeated Word",DeleteCell:"Delete Cell",DeleteRow:"Delete Row",DeleteRowKeytip:"DR",DeleteStyles:"Delete Styles..",DeleteStyle:"Delete Style",DeleteStylesKeytip:"D",DeleteSavedStyles:"Delete Saved Styles",DeleteSavedStylesKeytip:"D",DeleteTable:"Delete Table",DeleteTableKeytip:"DT",DeleteTableMenuKeytip:"D",DeleteTooltip:"Move this file to your recycle bin",DeleteDocument:"Move to Recycle Bin",DeleteDocumentKeytip:"D",DeleteDocumentOneDriveDescription:"You can recover it from Recycle Bin in OneDrive",DeleteDocumentDescription:"You'll be able to recover this file from the Recycle Bin",DeleteDocumentDisableDescription:"This is a shared file, only the owner of the file can delete it",DesignIdeas:"Style suggestions with Design Ideas",Designer:"Designer",DesignerKeytip:"WD",DesignerTooltip:"Fix and restyle formatting",DesignerInStylesGallery:"Open Designer to create a more polished-looking document",DesignerInStylesGalleryKeytip:"DS",DesignerProactiveTitle:"Try Designer",DesignerProactiveMessage:"Fix inconsistencies and restyle your document with just one click.",DesignerFullPaneErrorMessage:"Word Designer is not supported for this type of document yet.",DesignerUnsupportedWarningTitle:"Please note",DesignerUnsupportedWarningMessage:"Your document may have some elements that aren't supported by Designer … yet!",DesignerDocumentTooLongWarningTitle:"Not supported",DesignerDocumentTooLongWarningMessage:"Designer doesn't currently support documents of this length.",DesignerMultipleAuthorsErrorTitle:"Someone else is editing",DesignerMultipleAuthorsErrorMessage:"To avoid conflicts, we won't offer you Designer suggestions while another person is editing the document.",DesignerTryAnywayLabel:"Try it anyway",DesignerLearnMoreLabel:"Learn more",DesignerShowAllLabel:"Show all",DesignerFRETitle:"Give your document a design makeover",DesignerFREMessage:"Fix formatting and add the right amount of visual interest to your document.",DesignerSuggestionCardHeader:"Suggestions",DesignerFixAndReviewAllTextFormattingLabel:"Fix text formatting in {0} {1} so your document looks more cohesive",DesignerReviewLabel:"Review",DesignerReviewAllAfterApplyingThemeLabel:"{0} text formatting {1} were applied with the new theme",DesignerParagraphSingular:"paragraph",DesignerParagraphPlural:"paragraphs",DesignerSuggestionSingular:"suggestion",DesignerSuggestionPlural:"suggestions",DesignerOKLabel:"OK",DesignerNoSuggestionsLabel:"No suggestions. Looks good!",DesignerFixSingular:"fix",DesignerFixPlural:"fixes",DesignerIssueSingular:"issue",DesignerIssuePlural:"issues",DesignerFixAndReviewAllLabel:"Fix and review {0} formatting {1}",DesignerFixAllLabel:"Apply {0} formatting {1}",DesignerReviewAllLabel:"Review {0} formatting {1}",DesignerReviewAllTooltip:"Designer made adjustments you may want to restyle.",DesignerReviewingLabel:"Reviewing {0} formatting {1}",DesignerNoIssuesFoundLabel:"No issues found",DesignerKeepAllLabel:"Keep all",DesignerUndoAllLabel:"Undo all",DesignerAcceptAllLabel:"Accept all",DesignerRejectAllLabel:"Reject all",DesignerTitleFontText:"A",DesignerSubtitleFontText:"a",DesignerHeadingFontText:"123",DesignerBodyFontText:"Abc",DesignerTitlePreviewText:"An Example Title Could Look Like This",DesignerHeadingPreviewText:"Lorem ipsum",DesignerBodyPreviewText1:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Praesent semper feugiat nibh sed pulvinar proin. Placerat duis ultricies lacus sed turpis tincidunt id aliquet. Purus in mollis nunc sed id semper risus in hendrerit. Nunc aliquet bibendum enim facilisis gravida neque. Et netus et malesuada fames ac turpis egestas integer. Aliquam sem et tortor consequat id porta nibh. Dolor purus non enim praesent elementum facilisis leo. Enim ut tellus elementum sagittis vitae et. Arcu felis bibendum ut tristique et egestas quis ipsum. Non diam phasellus vestibulum lorem. Ornare aenean euismod elementum nisi quis. Tristique senectus et netus et malesuada fames. Gravida in fermentum et sollicitudin ac orci. Id eu nisl nunc mi. Eget arcu dictum varius duis at. Sed vulputate odio ut enim blandit. Ac turpis egestas integer eget aliquet nibh.",DesignerBodyPreviewText2:"Tellus orci ac auctor augue mauris augue neque gravida. Mi proin sed libero enim sed faucibus turpis. Ultrices in iaculis nunc sed augue lacus viverra vitae congue. Viverra nibh cras pulvinar mattis nunc. Aliquam sem fringilla ut morbi tincidunt. In nibh mauris cursus mattis. Turpis massa tincidunt dui ut ornare lectus sit. Viverra aliquet eget sit amet tellus cras adipiscing enim. Massa tempor nec feugiat nisl pretium fusce id velit ut. Massa tincidunt dui ut ornare. Purus in massa tempor nec feugiat.",DesignerTitlePreviewText_V2:"This is a title",DesignerSubtitlePreviewText_V2:"This is a Subtitle",DesignerHeading1PreviewText_V2:"Heading 1",DesignerHeading2PreviewText_V2:"Heading 2",DesignerHeading3PreviewText_V2:"Heading 3",DesignerBodyPreviewText1_V2:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.",DesignerBodyPreviewText2_V2:"Quisque sagittis purus sit amet volutpat consequat mauris nunc. Eget mauris pharetra et ultrices. Nascetur ridiculus mus mauris vitae ultricies leo integer malesuada nunc. Tortor pretium viverra suspendisse potenti nullam. In hac habitasse platea dictumst vestibulum rhoncus est pellentesque. Fringilla urna porttitor rhoncus dolor purus. Consectetur adipiscing elit duis tristique sollicitudin nibh sit. Enim lobortis scelerisque fermentum dui faucibus in.",DesignerAuthorPreviewText:"Author name",DesignerCompanyInstitutionPreviewText:"Company or institution name",DesignerCompanyInstitutionPreviewText_V2:"Company or Institution",DesignerDatePreviewText:"Date",DesignerFavoritesSectionHeader:"My favorites",DesignerFavoriteItTooltip:"Add to favorites",DesignerUnFavoriteItTooltip:"Remove from favorites",DesignerFavoritesFullTooltip:"You can favorite up to {0} ideas",DesignerFavoritesDisabledTooltip:"Ideas customized for this content can't be added to favorites",DesignerThemesSectionHeader:"All ideas",DesignerCoverPagesSectionHeader:"Ideas with cover page",DesignerThemesWithText2ImageSectionHeader:"Ideas with image based on content",DesignerTemplatesSectionHeader:"Cover page templates",DesignerGeneralDocumentTemplatesSectionHeader:"General",DesignerToDoListTemplatesSectionHeader:"To-do list",DesignerResumeTemplatesSectionHeader:"Resume",DesignerCoverLetterTemplatesSectionHeader:"Cover letter",DesignerNoteTemplatesSectionHeader:"Note taking",DesignerJournalTemplatesSectionHeader:"Journal",DesignerLetterheadTemplatesSectionHeader:"Letter",DesignerReportTemplatesSectionHeader:"Report",DesignerArticleTemplatesSectionHeader:"Article",DesignerInvoiceTemplatesSectionHeader:"Invoice",DesignerOtherSectionHeader:"Other",DesignerFontAndColorsHeader:"Apply different fonts & colors",DesignerTextToImageNoSuggestions:"We couldn't find any images related to your title. Try adding an image of your own.",DesignerShowMoreThemesLabel:"Show more themes",DesignerMoreThemesLoadedAlert:"More themes loaded",DesignerSendFeedbackHeadingLabel:"Give feedback to Microsoft",DesignerSendFeedbackLabel:"Tell us what you think about Designer",DesignerBlankDocumentExperienceSendFeedbackHeadingLabel:"Give feedback to Microsoft",DesignerBlankDocumentExperienceSendFeedbackLabel:"Tell us what you think about starting a new document with a Designer template",DesignerSendFeedbackTooltip:"We appreciate your feedback.",DesignerJoinTestingGroupHeadingLabel:"Join a customer testing group for Designer",DesignerJoinTestingGroupLabel:"Click to sign up at ux.microsoft.com",DesignerJoinTestingGroupTooltip:"We'd love your input.",DesignerFeedbackCallout:"We'd love your feedback on Designer. Click to answer two questions.",DesignerStyleAriaLabel:"Theme {0}, heading font {1}, accent color {2}",DesignerStyleThemeWithDecoratorAriaLabel:"Theme {0}, {1}, heading font {2}, accent color {3}",DesignerStyleTabularTitleDecoratorAriaLabel:"Styled Title",DesignerStyleThemeImageDecoratorAriaLabel:"Decorative Image",DesignerText2ImageDecoratorAriaLabel:"Decorative image based on title",DesignerStyleCoverPageDecoratorAriaLabel:"Cover page",DesignerStyleTabularTitleDecoratorAltTextTitle:"Title in decorative table",DesignerStyleImageD10TIAltTextTitle:"Horizontal rectangle header image of geometrical elements in blue and teal",DesignerStyleImageD1TIAltTextTitle:"Three circle images of geometric and textural patterns in black and white",DesignerStyleImageD6TIAltTextTitle:"Horizontal ellipse header image of linear patterns in yellow, orange, and red",DesignerLoadingStyleAriaLabel:"Theme {0}, still loading",DesignerStyleFontAvenir:"Avenir Next LT Pro",DesignerStyleFontCentury:"Century Gothic",DesignerStyleFontSitka:"Sitka",DesignerStyleFontWalbaum:"Walbaum",DesignerStyleFontRockwellNova:"Rockwell Nova",DesignerStyleFontUnivers:"Univers",DesignerStyleFontSagona:"Sagona",DesignerStyleFontFranklin:"Franklin Gothic",DesignerStyleFontPerpetua:"Perpetua",DesignerStyleFontAmasisMTPro:"Amasis MT Pro",DesignerStyleFontSabonNextLT:"Sabon Next LT",DesignerStyleFontTradeGothicNext:"Trade Gothic Next",DesignerStyleFontCooperBlack:"Cooper Black",DesignerStyleFontNeueHaasGroteskTextPro:"Neue Haas Grotesk Text Pro",DesignerStyleFontTisaOffcSerifPro:"Tisa Offc Serif Pro",DesignerStyleFontQuireSans:"Quire Sans",DesignerStyleFontGillSansNova:"Gill Sans Nova",DesignerStyleFontSagonaBook:"Sagona Book",DesignerStyleFontAvenirNextDemiBold:"Avenir Next Demi Bold",DesignerStyleFontTheHand:"The Hand",DesignerStyleFontGoudyType:"Goudy Type",DesignerStyleFontPlantagenetCherokee:"Plantagenet Cherokee",DesignerStyleFontFootlightMTLight:"Footlight MT Light",DesignerStyleFontBaskervilleOldFace:"Baskerville Old Face",DesignerStyleFontLucidaCalligraphy:"Lucida Calligraphy",DesignerStyleFontEbrima:"Ebrima",DesignerStyleFontCorbel:"Corbel",DesignerStyleFontElephantPro:"Elephant Pro",DesignerStyleFontDaytona:"Daytona",DesignerStyleFontBierstadt:"Bierstadt",DesignerStyleFontSitkaBanner:"Sitka Banner",DesignerStyleFontGrandview:"Grandview",DesignerStyleFontSkeenaDisplay:"Skeena Display",DesignerStyleFontTenorite:"Tenorite",DesignerStyleFontGadugi:"Gadugi",DesignerStyleFontSeaford:"Seaford",DesignerStyleFontWalbaumDisplay:"Walbaum Display",DesignerStyleFontAgencyFB:"Agency FB",DesignerStyleFontAharoni:"Aharoni",DesignerStyleFontArial:"Arial",DesignerStyleFontArialNova:"Arial Nova",DesignerStyleFontArialNovaBold:"Arial Nova Bold",DesignerStyleFontArialNovaCondBold:"Arial Nova Cond Bold",DesignerStyleFontAvenirNextLTProBold:"Avenir Next LT Pro Bold",DesignerStyleFontAvenirNextLTProDemi:"Avenir Next LT Pro Demi",DesignerStyleFontBaguetScript:"Baguet Script",DesignerStyleFontBaguetScriptRegular:"Baguet Script Regular",DesignerStyleFontBahnschrifr:"Bahnschrifr",DesignerStyleFontBahnschrift:"Bahnschrift",DesignerStyleFontBierstadtRegular:"Bierstadt Regular",DesignerStyleFontBiome:"Biome",DesignerStyleFontBodoniMT:"Bodoni MT",DesignerStyleFontBritannic:"Britannic",DesignerStyleFontCalibri:"Calibri",DesignerStyleFontCalistoMT:"Calisto MT",DesignerStyleFontCavolini:"Cavolini",DesignerStyleFontDubai:"Dubai",DesignerStyleFontElephantProRegular:"Elephant Pro Regular",DesignerStyleFontErasBoldITC:"Eras Bold ITC",DesignerStyleFontGeorgia:"Georgia",DesignerStyleFontGeorgiaPro:"Georgia Pro",DesignerStyleFontJumble:"Jumble",DesignerStyleFontMVBoli:"MV Boli",DesignerStyleFontNewsGothicMT:"News Gothic MT",DesignerStyleFontPerpetuaBoldItalic:"Perpetua Bold Italic",DesignerStyleFontPerpetuaItalic:"Perpetua Italic",DesignerStyleFontRastantyCortez:"Rastanty Cortez",DesignerStyleFontSegoe:"Segoe",DesignerStyleFontSegoeScript:"Segoe Script",DesignerStyleFontSegoeUI:"Segoe UI",DesignerStyleFontSegoeUIBold:"Segoe UI Bold",DesignerStyleFontSitkaHeading:"Sitka Heading",DesignerStyleFontSitkaText:"Sitka Text",DesignerStyleFontTenoriteBold:"Tenorite Bold",DesignerStyleFontTenoriteRegular:"Tenorite Regular",DesignerStyleFontTradeGothic:"Trade Gothic",DesignerStyleFontTradeGothicInline:"Trade Gothic Inline",DesignerStyleFontVijaya:"Vijaya",DesignerStyleFontWideLatin:"Wide Latin",DesignerStyleFontNordiqueInlineRegular:"Nordique Inline Regular",DesignerStyleColorBlueAccent:"Blue",DesignerStyleColorOrangeAccent:"Orange",DesignerStyleColorGreenAccent:"Green",DesignerStyleColorMediumSlateBlue:"Light blue",DesignerStyleColorRoyalBlue:"Blue",DesignerStyleColorPacificBlue:"Turquoise",DesignerErrorStateTitle:"Hmm...",DesignerErrorStateMessage:"Something went wrong and we can't open Designer right now. Please try again later.",DesignerTemporaryIssueTitle:"Temporary issue",DesignerTrackChangeUnsupportedMessage:"Sorry, Designer doesn't work with tracked changes turned on at this moment. We are working on a fix. If you want to try Designer, please turn off tracked changes and try again.",DesignerErrorStateTryAgainButton:"Try again",DesignerRevertButtonLabel:"Undo",DesignerApplyThemeDialogMessage:"In progress...",DesignerNextThemeButtonLabel:"Next",DesignerPreviousThemeButtonLabel:"Previous",DesignerEnableContextualSuggestions:"Show suggestions",DesignerEnableContextualSuggestionsKeytip:"S",DesignerDisableContextualSuggestionsForSession:"Disable suggestions for session",DesignerDisableContextualSuggestionsTemporary:"Disable suggestions temporary",DesignerDisableContextualSuggestionsPermanently:"Disable suggestions permanently",DesignerDisableContextualSuggestionsUntilUpdate:"Hide suggestions until next update",DesignerDisableContextualSuggestionsUntilUpdateKeytip:"H",DesignerEnableAutomaticShowTemplates:"Automatically show templates",DesignerEnableAutomaticShowTemplatesKeytip:"TE",DesignerDisableAutomaticShowTemplates:"Stop automatically showing templates",DesignerDisableAutomaticShowTemplatesKeytip:"TD",Diagnostics:"Diagnostics",DiagnosticsBuild:"Build",DiagnosticsDescription:"The following session details may be requested by technical support.",DiagnosticsSessionId:"Session ID",DialogMove:"Move",DictationLabel:"Dictate",DictationKeytip:"D",DigitalPrintKeytip:"W",DirectPrintJewelButton:"Print",DirectPrintJewelButtonKeytip:"P",DirectPrintJewelDescription:"Print this document.",DistributeColumns:"Distribute Columns",DistributeColumnsTooltip:"Distribute column width equally",DistributeColumnsKeytip:"UC",DistributeMenu:"Distribute",DistributeTooltip:"Distribute rows and columns equally",DistributeMenuKeytip:"U",DistributeRows:"Distribute Rows",DistributeRowsTooltip:"Distribute row height equally",DistributeRowsKeytip:"UR",DocChatLabel:"Chat",DocChatKeytip:"ZH",DoNotCheckForThisIssue:"Don't Check for This Issue",DoNotCheckSpellingOrGrammar:"Don't check spelling or grammar",DoubleFrameBlack:"Double Frame, Black",Download:"Download",DownloadACopy:"Download a copy",DownloadACopyKeytip:"C",DownloadACopyTooltip:"Download as a Word document to this device.",DownloadAsODT:"Download as ODT",DownloadAsODTDescription:"Download a copy of this document to your computer as an ODT file.",DownloadAsODTKeytip:"T",DownloadAsPDF:"Download as PDF",DownloadAsPDFDescription:"Download a copy of this document to your computer as a PDF file.",DownloadAsPDFKeytip:"P",DownloadAsPDFWithoutComments:"Download as PDF",DownloadAsPDFWithoutCommentsDescription:"Download a copy to your computer without comments.",DownloadAsPDFWithoutCommentsKeytip:"P",DownloadAsPDFWithComments:"Download as PDF with comments",DownloadAsPDFWithCommentsDescription:"Download a copy to your computer including comments.",DownloadAsPDFWithCommentsKeytip:"W",DownloadDescription:"Download a copy to your computer.",DownloadErrorReport:"Download Error Report",DownloadingPDFToastMessage:"Downloading PDF",DownloadPDFErrorMessage:"Document not converted to PDF. Please try later or go to print and save as PDF file.",DraftView:"Draft View",DraftViewKeytip:"DR",Drawing:"Drawing",DrawingKeytip:"D",Draw:"Draw",DropShadowRectangle:"Drop Shadow Rectangle",FormatTableOfContents:"Format Table of Contents",Edit:"Edit",EditNew:"Stay on Web",EditBookmark:"Edit Bookmark",EditBookmarkFloatieLabel:"Edit",EditDocument:"Edit Document",EditHyperlink:"Edit Link",EditIllustration:"Draw and Annotate",EditDrawing:"Edit Drawing",EditInWord:"Open in Word",EditInWordFileMenu:"Edit In Word",EditInWordFileMenuDescription:"Use the full functionality of Microsoft Word.",EditInWordKeytip:"T",EditInWordOneLineRibbonKeytip:"O",EditInWordWebAppDescription:"Make quick changes right here using Word.",Editor:"Editor",EditorKeytip:"SU",EditorScoreInStatusBarTooltip:"Some suggestions only show when Editor is open. Click to see how to increase your score to 100%.",EditorScorePercent:"Editor Score: {0}%",EditorSettings:"Editor Settings",EditView:"Editing View",EditViewKeytip:"E",EmailLink:"Email Link",EmailLinkKeytip:"E",Embed:"Embed",EmbedDescription:"Embed this document in your blog or website.",EmbedKeytip:"E",EmbedDocument:"Embed this document",EmbedDocumentKeytip:"E",EmbedDocumentTooltip:"Embed this document in your blog or website.",EmojiPlural:"Emojis",EmojiSingle:"Emoji",EmojiSingleKeytip:"EM",Endnote:"Insert Endnote",EndnoteKeytip:"RE",Endnotes:"Endnotes",EndnotesKeytip:"SE",Enterlink:"Enter Link",EnterlinkKeytip:"E",EquationTools:"Equation Tools",EquationToolsKeyTip:"ET",EquationToolsGroup:"Equation Tools",EquationToolsShortHandName:"Equation",Error:"Error",Exit:"Exit",ExitKeytip:"X",ExpandAllHeadings:"Expand All Headings",ExpandCollapseSplitButtonLabel:"Expand/Collapse",ExpandHeading:"Expand Heading",Explore:"Explore all templates",Export:"Export",ExportKeytip:"E",ExportToKindle:"Export to Kindle",ExportToKindleKeytip:"K",ExportToPowerPoint:"Export to PowerPoint",ExportToPowerPointKeytip:"E",ExportToPowerPointTooltip:"Export your document into a multi-slide presentation.",ExportToPresentation:"Export to PowerPoint presentation (preview)",ExportToPresentationDescription:"Export your document into a multi-slide presentation with a design theme.",ExternalContentChangeDefaultDialogDescription:"Display web links as:",ExternalContentChangeDefaultDialogInformation:"Content from some of our supported sources, like Microsoft Stream, YouTube, and others may display automatically as embedded content when you paste the link.",ExternalContentChangeDefaultDialogTitle:"Change Default",ExternalContentGalleryChangeDefault:"Change default",ExternalContentGalleryContent:"Embedded content",ExternalContentGalleryHyperLink:"Hyperlink",ExternalContentGalleryLabel:"Display as",FileAboutKeytip:"D",FileGetAddinsButton:"Get Add-ins",VisitAddinStore:"Visit the add-in store",VisitAddinStoreDescription:"Extend Word capabilities with add-ins",FidelityCompatibilityView:"Review with Comments Only",FidelityCompatibilityViewKeytip:"RC",FileHomeKeytip:"H",FileInfoKeytip:"I",FileIOCtrlSToastMessageString1:"We're saving your changes as you go.",FileIOCtrlSToastMessageString2:"Word for the web saves as you go.",FileIOCtrlSToastMessageString3:"You're good to go: your changes are being autosaved.",FileIOCtrlSToastMessageString4:"Your changes are always autosaved on Word for the web.",FileMenuBackButton:"Close",FileMenuBackButtonAriaLabel:"Close menu",FileMenuBlankDocument:"Blank Document",FileMenuPrintToWeb:"Print to Web",FileMenuPrintToWebDescription:"Print your Word document to an interactive and easy-to-share web page taht looks great on any device",FileNewKeytip:"N",FileOpenKeytip:"O",FilePrintKeytip:"P",FileSaveAsKeytip:"S",FileDeleteKeytip:"W",FileDownloadKeytip:"L",FileShareKeytip:"Z",FileTransformKeytip:"M",FileProperties:"File properties",Filter:"Filter",FilterKeytip:"X",FilterBy:"Filter by",FilterByKeytip:"FB",FilterByActiveOnly:"Active only",FilterByActiveOnlyKeytip:"AO",FilterByMentionsMe:"@mentions me",FilterByMentionsMeKeytip:"MM",FilterByResolvedOnly:"Resolved only",FilterByResolvedOnlyKeytip:"RO",Find:"Find",FindKeytip:"FD",FindReplace:"Find & Replace",FindTooltip:"Find",FindReplaceToolTip:"More Editing Options",FindResultText:"Result {0} of {1}",FindWholeWords:"Find whole words only",FindWholeWordsV2:"Whole words only",FirstLineIndent:"First Line Indent",Fit:"Fit",FlipHorizontalKeytip:"H",FlipVerticalKeytip:"V",FollowPresenter:"Follow Presenter",FontColorAutomaticKeytip:"A",FontColorYellow:"Yellow",FontColorGreen:"Green",FontColorCyan:"Cyan",FontColorMagenta:"Magenta",FontColorBlue:"Blue",FontColorRed:"Red",FontColorDarkBlue:"Dark Blue",FontColorDarkCyan:"Dark Cyan",FontColorDarkGreen:"Dark Green",FontColorDarkMagenta:"Dark Magenta",FontColorDarkRed:"Dark Red",FontColorDarkYellow:"Dark Yellow",FontColorGrey:"Grey",FontColorLightGrey:"Light Grey",FontColorBlack:"Black",FontName:"Font Name",FontNameKeytip:"FF",FontPickerFreeFontsSection:"Free Fonts",FontPickerPremiumFontsSection:"Premium Fonts",FontPickerShowMoreButtonLabel:"+show more",FontPickerAllFontsSection:"Office Fonts",FontPickerPinnedFontsSection:"Pinned Fonts",FontPickerMruSection:"Most Recently Used",FontPickerOrganizationSection:"Organizational Fonts",FontPickerInfoCommand:"About This Font...",FontPickerPinnedTooltip:"Unpin font",FontPickerUnpinnedTooltip:"Pin font",FontPickerThemeFontTooltip:"Theme font",FontPickerEmbeddedFontTooltip:"Embedded font",FontPickerPremiumFontTooltip:"Premium font",FontPickerMissingFontTooltip:"Missing font",FontPickerCompatibilityFontTooltip:"Compatibility font",FontPickerNewFontHeader:"{0} New Fonts",FontPickerSearchNoResult:"No results found for {0}.",FontPickerNoActionLabel:"No action available.",FontPickerPremiumFontsTitle:"Premium Fonts",FontPickerPremiumFontsBody:"Premium fonts is a collection of fonts available across Office web, desktop and mobile apps with a paid Microsoft 365 subscription. See {0}",FontPickerPremiumFontsBody2:"The free versions of Office web apps only display a small set of fonts.",FontPickerHelpContentTitle:"Help article",FontPickerPinnedFontAnnouncement:"Pinned font {0}",FontPickerUnPinnedFontAnnouncement:"Unpinned font {0}",FontPickerNumberOfSuggestionsAnnouncement:"{0} suggestions available for {1}",FontPickerNoSuggestionsAnnouncement:"No suggestions available for {0}",FontPickerNumberOfSuggestionsInGroupAnnouncement:"{0} in {1}",FontPickerPinnedDescription:"Pinned font",FontPickerUnpinnedDescription:"Unpinned font",FontPickerFontPinningTooltip:"(Shift+Enter to pin/unpin font)",FontPickerFontMissingFontTooltip:"Missing Font (Shift+Enter for more info)",FontPickerFontOtherActionTooltip:"(Shift+Enter for more info)",FontSize:"Font Size",FontSizeKeytip:"FS",FontSize8:"8",FontSize9:"9",FontSize10:"10",FontSize11:"11",FontSize12:"12",FontSize14:"14",FontSize16:"16",FontSize18:"18",FontSize20:"20",FontSize24:"24",FontSize26:"26",FontSize28:"28",FontSize36:"36",FontSize48:"48",FontSize72:"72",Footnote:"Insert Footnote",FootnoteKeytip:"RF",FootnotesMenu:"Footnote",FormatPainter:"Format Painter",FormatOptions:"Format Options",PageNumberControlLabel:"Page numbers",TabLeaderControlLabel:"Tab leaders",HeadingLinksControlLabel:"Heading links",OutlineLevelControlLabel:"Outline level",TabLeaderToolTipText:"To enable Tab leaders, turn on right-aligned page numbers",SettingsLabel:"Settings",HeadingsToShowLabel:"Show headings up to",StickyFormatPainterTooltip:"To apply the formatting in multiple places, double-click Format Painter.",FormatPainterKeytip:"FP",FormatPicture:"Format Picture",FormatPictureTransparencySectionTitle:"Transparency",FormatPictureTransparencyLabel:"Transparency",FormatPictureAltSectionTitle:"Alternative Text",FormatPictureAltDescriptionLabel:"Description",FormatPictureAltTitleLabel:"Title",FormatPictureCropSectionTitle:"Crop",FormatPictureCropBottomLabel:"Bottom",FormatPictureCropLeftLabel:"Left",FormatPictureCropRightLabel:"Right",FormatPictureCropTopLabel:"Top",FormatPictureKeytip:"O",FormatPictureEllipses:"Format Picture...",FormatPictureRotationSectionTitle:"Rotation",FormatPictureRotationDegreeLabel:"Degree",FrenchAccessibilityStatementLinkText:"Accessibilité: partiellement conforme",FullJustify:"Justify",FullJustifyKeytip:"AJ",GetLink:"Get Link",GrammarSettings:"Grammar Settings...",GrammarSettingsKeytip:"R",GiveFeedback:"Give Feedback to Microsoft",GiveFeedbackShort:"Feedback",GiveFeedbackDescription:"Tell us what you think.",GiveFeedbackKeytip:"K",GoToLocation:"Go to location",GoToLocationKeytip:"L",GridTables:"Grid Tables",GroupAlignment:"Align",GroupAlignmentStandalone:"Align Cell",GroupApps:"Add-ins",GroupArrange:"Arrange",GroupClipboard:"Undo/Clipboard",GroupChanges:"Changes",GroupCommentsKeytip:"ZC",GroupData:"Data",GroupDelete:"Delete",GroupDictation:"Voice",GroupDocumentViews:"Document Views",GroupDocumentViewsTooltip:"More Document View Options",GroupEditing:"Editing",GroupFindReplaceKeytip:"ZN",GroupFont:"Font",GroupFontKeytip:"ZF",GroupFormattingTooltip:"More Formatting Options",GroupFootnoteEndnote:"Footnotes",GroupHeaderFooter:"Header & Footer",GroupHeaderFooterKeytip:"ZH",GroupHomeParagraphKeytip:"ZP",GroupImageAdjust:"Adjust",GroupImageSize:"Size",GroupImageSizeFlyout:"Size",GroupImageSizeKeytip:"ZZ",GroupImageText:"Image Text",GroupInsert:"Insert",GroupInsertTabTableOfContentsKeytip:"O",GroupInsertTooltip:"More Insert Options",GroupLanguage:"Language",GroupLinks:"Links",GroupMedia:"Pictures",GroupMerge:"Merge",GroupMergeKeytip:"ZM",GroupCellSize:"Cell Size",GroupMultimedia:"Media",GroupPageBreak:"Pages",GroupPageLayoutParagraph:"Paragraph",GroupPageLayoutParagraphKeytip:"PG",GroupPageSetup:"Page Setup",GroupPageSetupTooltip:"More Page Setup Options",GroupParagraph:"Paragraph",GroupParagraphTooltip:"More Paragraph Options",GroupParagraphKeytip:"PG",GroupPictureFormat:"Picture Format",GroupPictureFormatTooltip:"More Picture Format Options",GroupPictureKeytip:"ZI",GroupProofing:"Review Tools",GroupProofingTooltip:"More Review Tools Options",GroupRename:"Rename",GroupRowsAndColumns:"Rows and Columns",GroupSelect:"Select",GroupShading:"Shading",GroupSpelling:"Spelling",GroupStyles:"Styles",GroupStylesTooltip:"More Style Options",GroupStylesKeytip:"FY",GroupTable:"Table",GroupTableBorders:"Borders And Shading",GroupTableDeleteKeytip:"ZD",GroupTableTooltip:"More Table Options",GroupTableOfContents:"Table of Contents",GroupTableOfContentsKeytip:"T",GroupTableOptionsKeytip:"ZL",GroupTables:"Tables",GroupTableSelectKeytip:"ZT",GroupTableStyleOptions:"Table Style Options",GroupTableStyles:"Table Styles",GroupTracking:"Tracking",GroupTrackingKeytip:"ZH",GroupTrackMarkup:"Markup",GroupTrackMarkupKeytip:"ZK",GroupUndoRedo:"Undo",GroupUndoRedoTooltip:"More Undo Options",GroupWordCount:"Word Count",Grow:"Grow",GrowFont:"Grow Font Size",GrowFontSize:"Grow Font",GrowFontSizeKeytip:"FG",GrowKeytip:"G",HangingIndent:"Hanging Indent",HeaderFooter:"Header & Footer",HeaderFooterOptions:"Options",TabHeaderFooterKeytip:"JH",Heading:"Heading",HeadingDetectionInIdeas:"Enable Navigation",HeadingsExplanationFirst:"Create an interactive outline of your document using headings & bookmarks present in the document.",HeadingsExplanationSecond:"It's a great way to keep track of where you are and navigate quickly to different parts.",HeadingsExplanationFirstV2:"Add headings ({0}) and bookmarks ({1}) to create an interactive outline of your document.",HeadingsExplanationSecondV2:"It'll help you keep track of where you are and navigate quickly through your document.",HeadingsExplanationWithContextualHelp:"This document doesn't have any headings. To add headings for creating an interactive outline, go to {0}.",HeadingsTab:"Headings",Help:"Help",HelpButtonDescription:"Get answers to your Word questions.",HelpButtonKeytip:"H",HelpButtonTitle:"Help",HelpButtonTitleKeytip:"L",HelpImproveOffice:"Help Improve Office",HelpKeytip:"L",HelpTabKeytip:"E",HideRuler:"Hide ruler",HighContrastColorPicker:"High-contrast only",HighContrastColorPickerKeytip:"H",Highlight:"Highlight",HighlightColor:"Highlight Color",Hyperlink:"Link",HyperlinkKeytip:"I",Ideas:"Ideas",IdeasKeytip:"SU",Ignore:"Ignore",IgnoreAll:"Ignore All",IgnoreOnce:"Ignore Once",Illustrations:"Illustrations",IllustrationsKeytip:"I",ImmersiveReaderKeytip:"I",ImmersiveView:"Immersive Reader",InchUnitPlaceholder:'{0}"',IncludePageCount:"Include Page Count",IncludePageCountKeytip:"I",IncreaseIndent:"Increase Indent",IncreaseIndentKeytip:"AI",Info:"Info",InfoKeytip:"I",Information:"Information",InsertAbove:"Insert Above",InsertAboveStandalone:"Insert Row Above",InsertAboveKeytip:"A",InsertBelow:"Insert Below",InsertBelowStandalone:"Insert Row Below",InsertBelowKeytip:"BE",InsertBookmark:"New Bookmark",InsertBookmarkKeytip:"K",InsertFilesLink:"Search for Files",InsertFilesLinkKeyTip:"IF",InsertHyperlink:"Insert Link",InsertHyperlinkKeytip:"I",InsertIntelligentPlaceholder:"New Follow-up",InsertLeft:"Insert Left",InsertLeftStandalone:"Insert Column Left",InsertLeftKeytip:"L",InsertPictureFrom:"Insert Picture From",InsertRight:"Insert Right",InsertRightStandalone:"Insert Column Right",InsertRightKeytip:"R",InsertSnippet:"Insert snippet",InsertTableMenuKeytip:"I",InsertTableDialogKeytip:"I",InsertTableOfContents:"Insert Table of Contents",InsertTableOfContentsKeytip:"T",InsertTableOfContentsInInsertTabKeytip:"A",InsertTabStop:"Insert tab stop",InsertRowAbove:"Insert Row Above",InsertRowBelow:"Insert Row Below",InsertColumnLeft:"Insert Column Left",InsertColumnRight:"Insert Column Right",InsideBorders:"Inside Borders",InsideBordersKeyTip:"I",InsideHorizontalBorder:"Inside Horizontal Border",InsideHorizontalBorderKeyTip:"H",InsideVerticalBorder:"Inside Vertical Border",InsideVerticalBorderKeyTip:"V",Insights:"Insights",InsightsDictionary:"Define",InsightsMenu:"Search",InsightsMenuKeytip:"L",InsightsMenuSimplification:"Search",IntelligentPlaceholderTabExplanationFirst:"To create a Follow-up",IntelligentPlaceholderTabExplanationSecond:"Right click in your document and choose New Follow-up.",IntelligentPlaceholderTabExplanationThird:"Follow-ups you create in the document will be shown here.",IntelligentPlaceholderTabKeyboardShortcut:"Keyboard shortcut: [ ] Spacebar​",IntelligentPlaceholderTab:"Follow-ups",Italic:"Italic",ItalicKeytip:"2",JewelText:"File",JewelTextKeytip:"F",JustifyBottomCenter:"Align Bottom Center",JustifyBottomCenterKeytip:"BC",JustifyBottomLeft:"Align Bottom Left",JustifyBottomLeftKeytip:"BL",JustifyBottomRight:"Align Bottom Right",JustifyBottomRightKeytip:"BR",JustifyCenter:"Center",JustifyCenterKeytip:"AC",JustifyMiddleCenter:"Align Center",JustifyMiddleCenterKeytip:"CC",JustifyMiddleLeft:"Align Center Left",JustifyMiddleLeftKeytip:"CL",JustifyMiddleRight:"Align Center Right",JustifyMiddleRightKeytip:"CR",JustifyTopCenter:"Align Top Center",JustifyTopCenterKeytip:"TC",JustifyTopLeft:"Align Top Left",JustifyTopLeftKeytip:"TL",JustifyTopRight:"Align Top Right",JustifyTopRightKeytip:"TR",KeyboardShortcuts:"Keyboard Shortcuts",KeyboardShortcutsDialogSearchBoxPlaceholder:"Search Shortcuts",KeyboardShortcutsDialogEmptyList:"No shortcuts found",KeyboardShortcutsKeytip:"S",KeypointsInIdeas:"Emphasize Highlights",KeytipStartSequence:"Alt {0}",KeytipStartKeyMac:"Ctrl",KeytipStartKeyWindows:"Windows",LabelIndent:"Indent",LabelIndentAfterLtr:"Right:",LabelIndentBeforeLtr:"Left:",LabelSpacing:"Spacing",LabelSpacingAfter:"After:",LabelSpacingBefore:"Before:",LanguageDialogDescription:"The speller and other proofing tools automatically use dictionaries of the selected language, if available.",LearnMore:"Learn More",Left:"Left",LeftBorder:"Left Border",LeftBorderKeyTip:"L",LeftIndent:"Left Indent",LeftMargin:"Left Margin",LeftTab:"Left Tab",LeftTabStop:"Left tab stop",LegacyView:"Legacy View",LegacyViewKeytip:"L",LineSpacing:"Line Spacing",LineSpacing_1_0:"Line Spacing 1.0",LineSpacing_1_15:"Line Spacing 1.15",LineSpacing_1_5:"Line Spacing 1.5",LineSpacing_2_0:"Line Spacing 2.0",LineSpacing_2_5:"Line Spacing 2.5",LineSpacing_3_0:"Line Spacing 3.0",LineSpacingKeytip:"K",LineSpacingOptions:"Line Spacing Options",LineSpacingOptionsKeytip:"L",LineUnitPlaceholder:"{0} line",ListLibraryTitle:"List Library",ListTables:"List Tables",LiveViewInBrowser:"Live View in Browser",LoadingMessage:"We're still loading the document",Location:"Location",LockAspectRatio:"Lock aspect ratio",LockAspectRatioKeytip:"X",LoopComponent:"Loop Components",LoopComponentKeytip:"L",LoopComponentLearnMoreKeyTip:"I",LoopComponentPoll:"Polls",LoopComponentPollKeytip:"P",ManageAccess:"Manage Access",ManageAccessKeytip:"M",ManageDefaultStyle:"Manage Default Styles",ManageDefaultStyleKeytip:"M",MarkAsRead:"Mark All as Read",MarkAsReadTooltip:"Mark changes as read",MarkAsReadKeytip:"R1",MarkSelectedText:"Mark selected text as:",MarkupOnPage:"Markup view",MarkupOnPageKeytip:"MV",MarkupOnPageTooltip:"Display for review",MarkupOnPageAllMarkup:"Markup on page (All Markup)",MarkupOnPageAllMarkupDescription:"See suggestions on the page",MarkupOnPageAllMarkupKeytip:"A",MarkupOnPageAllMarkupTooltip:"All Markup",MarkupOnPageSimpleMarkupDescription:"See suggestions in the margin",MarkupOnPageSimpleMarkup:"Markup in margin (Simple Markup)",MarkupOnPageSimpleMarkupKeytip:"S",MarkupOnPageSimpleMarkupTooltip:"All Markup",MatchCase:"Match case",MenuBullets:"Bullets",MenuClipboard:"Clipboard",MenuClipboardTooltip:"More Clipboard Options",MenuBulletsKeytip:"U",MenuFootnoteKeytip:"F",MenuFontColor:"Font Color",MenuFontColorFullDesc:"Font Color {0}",MenuFontColorKeytip:"FC",MenuHighlightColor:"Text Highlight Color",MenuHighlightColorKeytip:"I",MenuInsertTable:"Table",MenuInsertTableDialog:"Insert Table...",MenuInsertTableDialogButton:"Choose row and column",MenuCreateTableWithCopilotButton:"Create Table with Copilot",MenuInsertTableFull:"Insert Table",MenuInsertTableGrid:"{0}x{1} Table",MarkIntelligentPlaceholderComplete:"Resolve Follow-up",MenuMoreStyles:"More Styles",HeadingsAndOtherStyles:"Headings and Other Styles",MenuMoreStylesKeytip:"L",MenuMultilevelList:"Multilevel List",MenuMultilevelListKeytip:"M",MenuNumbering:"Numbering",MenuNumberingKeytip:"N",MenuPageColor:"Page Color",MenuPageColorFullDesc:"Page Color {0}",MenuPageColorKeytip:"PC",MenuShadingColor:"Cell Shading",MenuShadingColorKeytip:"L",MenuSpellingAndGrammarKeytip:"S",MenuSpellingAndGrammarProofingKeytip:"Q",MenuStyles:"Styles",MenuTableAlignKeytip:"A",MenuTableTheme_ToBeDeprecated:"Change Colors",MenuTableTheme:"Table Color",MenuTableThemeKeytip:"C",MergeCells_ToBeDeprecated:"Merge Cells",MergeCells:"Merge",MergeCellsKeytip:"M",MetalFrame:"Metal Frame",MetalOval:"Metal Oval",MetalRoundedRectangle:"Metal Rounded Rectangle",MiniTemplateApplyBrainstorming:"Brainstorming",MiniTemplateApplyJournalEntry:"Journal Entry",MiniTemplateApplyToDoList:"To do List",MiniTemplateApplyTaskList:"Task List",MiniTemplateTitle:"Mini Template",MiniTemplateTooltip:"Mini Template",MobileDevice:"Mobile Device",MobileDeviceKeytip:"M",ModerateFrameBlack:"Moderate Frame, Black",ModerateFrameWhite:"Moderate Frame, White",ModernUXOptIn:"Preview the new version",More:"More",MoreDocuments:"More documents",MoreTemplates:"More templates",MoreFontsDialogNoFont:"No fonts found",MoreFontDialogTitle:"Explore Fonts",MoreFontsDialogScriptFilterLabel:"Script",MoreFontsDialogTypeFilterLabel:"Type",AllTypeLabelFilter:"All Types",AllScriptLabelFilter:"All Scripts",ModernTranslator:"Translate",ModernTranslatorDocumentTitle:"Translate Document",ModernTranslatorDocumentKeytip:"T",ModernTranslatorKeytip:"T",ModernTranslatorSelectionTitle:"Translate Selection",ModernTranslatorSelectionKeytip:"S",ModernTranslatorSettingsTitle:"Translator Preferences",ModernTranslatorSettingsKeytip:"P",ModernTranslatorTaskPaneTitle:"Translator",ModeSwitcherCalloutTextMarkedAsFinal:"An author has marked this document as final to discourage editing.",ModeSwitcherCalloutTextOpenReadOnly:"To prevent accidental changes, the author has set this file to open as view-only.",ModeSwitcherCalloutTextViewOnly:"You can only view this document. You don't have permission to edit it.",ModeSwitcherCalloutTextIsReviewer:"This document has been shared with you for reviewing. You can leave comments and suggest edits for the author to approve.",ModeSwitcherCalloutTextTrackChangeForEveryoneEnabled:"This document has track changes on for everyone. Edits you make will be tracked as suggestions.​",ModeSwitcherCalloutTitleMarkedAsFinal:"Marked as Final",ModeSwitcherCalloutTitleOpenReadOnly:"Always open view-only",ModeSwitcherCalloutTitleViewOnly:"View-only",ModeSwitcherCalloutTitleIsReviewer:"Reviewing​",ModeSwitcherCalloutTitleTrackChangeForEveryoneEnabled:"Track Changes Enabled​",ModeSwitcherEditModeInMenuDescription:"Make any changes",ModeSwitcherEditModeInMenuLabel:"Editing",ModeSwitcherEditModeLabel:"Editing",ModeSwitcherEditModeKeytip:"E",ModeSwitcherEditModeTooltip:"Mode Menu: Editing",ModeSwitcherFlyoutAnchorKeytip:"ZM",ModeSwitcherMenuTitle:"Mode",ModeSwitcherSuggestModeInMenuDescription:"Add comments and suggest changes",ModeSwitcherSuggestModeInMenuLabel:"Reviewing",ModeSwitcherSuggestModeLabel:"Reviewing",ModeSwitcherSuggestModeKeytip:"R",ModeSwitcherSuggestModeTooltip:"Mode Menu: Reviewing",ModeSwitcherViewModeInMenuDescription:"View the file, but make no changes",ModeSwitcherViewModeInMenuLabel:"Viewing",ModeSwitcherViewModeLabel:"Viewing",ModeSwitcherViewModeKeytip:"V",ModeSwitcherViewModeTooltip:"Mode Menu: Viewing",ModeSwitcherWarningPromptTrackChangesOff:"Editing this document will turn off track changes for everyone. Do you want to continue?",ModeSwitchSuggestingContextMenu:"Leave a Suggestion",MoreEmojis:"More Emojis",MoreEmojisKeytip:"M",MoreColors:"More Colors",MoreColorsKeytip:"M",MorePanes:"More Panes",SeeMoreStyles:"See More Styles",MoreStyles:"Apply Styles...",MoreStylesKeytip:"S",MoreSymbols:"More Symbols",MoreSymbolsKeytip:"M",MoreTabs:"More Tabs",MoveFile:"Move File",MoveFileKeytip:"M",MoveTableColumn:"Move Table Column",MoveTo:"Move to",MRUErrorMessage:"We can't get the list of your recent files right now. Please try again later.",MRUMoreLink:"View more files",MultilevelList:"Multi-Level List",MultilevelListLabelNumericalStyle:"Level 1, 1; Level 2, 1.1; Level 3, 1.1.1",MultilevelListLabelAlphanumericalStyle:"Level 1, 1; Level 2, a; Level 3, i",MultilevelListLabelBulletedStyle:"Level 1 bulleted four small diamonds; Level 2 bulleted hollow arrow; Level 3 bulleted solid square.",Navigation:"Navigation",NavigationStandalone:"View Navigation Pane",NavigationFloatie:"Show Navigation Pane",NavigationPaneCloseLabel:"Hide Navigation Pane",NavigationPaneButtonText:"Navigation Pane",NavigationPaneButtonTextKeytip:"K",NegativeSign:"-",New:"New",NewBlankDocument:"New blank document",NewComment:"New Comment",NewCommentKeytip:"C",NewKeytip:"N",NextChange:"Next",NextChangeStandalone:"Next Change",NextChangeKeytip:"H",NextComment:"Next",NextCommentStandalone:"Next Comment",NextCommentKeytip:"N",NewDocument:"New Document",NewDocumentKeytip:"ND",NewDocuments:"New documents are saved to:",ProTipSuggestionText:"Pro Tip: Type word.new in the browser tab to quickly create new documents",NextProofingError:"Spelling and Grammar",NextSearchResult:"Next Search Result",NextSpellingError:"Spelling",NextSpellingErrorKeytip:"S",No:"No",NoBorder:"No Border",NoBorderKeyTip:"N",NoHighlight:"No Color",NoHighlightKeytip:"N",NoPageColor:"No Color",NoPageColorKeytip:"N",NoSuggestions:"No Suggestions",NoneListStyle:"None",NoneListStyleKeytip:"N",NumberDecimalDigits:"2",NumberDecimalSeparator:".",NumberNegativePattern:"1",NumberGroupSeparator:",",NumberGroupSizes:"3",NumberingLibraryTitle:"Numbering Library",NumberingInDocumentTitle:"Document Number Formats",NumberStyle1:"1., 2., 3., 4.,",NumberStyle2:"a., b., c., d.,",NumberStyle3:"i., ii., iii., iv.,",NumberStyle4:"A., B., C., D.,",NumberStyle5:"I., II., III., IV.,",Ok:"OK",OneDrive:"OneDrive",OneDriveKeytip:"O",OnlinePicture:"Online Pictures",OnlinePictureFromBing:"Pictures from Bing",OnlinePictureFromBingKeytip:"F",OnlinePictureFromBingSingular:"Picture from Bing",OnlinePictureFromHost:"Pictures from {0}",OnlinePictureFromHostKeytip:"G",OnlinePictureFromHostSingular:"Picture from {0}",OnlinePictureKeytip:"F",OnlineVideo:"Online Video",OnlineVideoKeytip:"NV",Open:"Open",OpenAccessibilityCheckerPane:"Check Accessibility",OpenAccessibilityCheckerPaneKeytip:"A1",OpenCommentPane:"Show Comments",OpenCommentPaneKeytip:"K",ToggleContextualComments:"Contextual",ToggleContextualCommentsKeytip:"C",ToggleCommentsPane:"List",ToggleCommentsPaneKeytip:"L",ToggleHeaderFooterDifferentFirstPage:"Different First Page",ToggleHeaderFooterDifferentFirstPageKeytip:"TF",ToggleHeaderFooterDifferentEvenOddPages:"Different Odd & Even Pages",ToggleHeaderFooterDifferentEvenOddPagesKeytip:"TE",OpenFilesFromDevice:"Open files from this device",OpenFilesFromDeviceDescription:"Your file will be uploaded to 'My Files' in One Drive",OpenHyperlink:"Open Link",OpenHyperlinkInSidebar:"Open Link in Sidebar",OpenInApp:"Open in App",OpenInBrowser:"Open in Browser",OpenInDesktop:"Open in Desktop App",OpenInDesktopButton:"Open in desktop app",OpenInDesktopButtonKeytip:"D",OpenInRichClientDescription:"Use the full functionality of Microsoft Word.",OpenKeytip:"O",OpenNavPaneIntelligentPlaceholderTab:"See all Follow-ups",Options:"Options",OutsideBorders:"Outside Borders",OutsideBordersKeyTip:"S",OverflowWell0Keytip:"00",OverflowWell1Keytip:"01",OverflowWell2Keytip:"02",OverflowWell3Keytip:"03",OverflowWell4Keytip:"04",OverflowWell5Keytip:"05",OverflowWell6Keytip:"06",OverflowWell7Keytip:"07",OverflowWellLabel:"More Options",PageA4:"A4",PageA5:"A5",PageCountTooltip:"The current page number in the document. Click or tap to open the Navigation Pane.",PageCustomMargins:"Custom Margins",PageCustomMarginsDescription:"Define custom margins",PageCustomMarginsKeytip:"A",PageCustomSizes:"Custom Page Size",PageCustomSizesDescription:"Define custom page size",PageCustomSizesKeytip:"A",PageEnds:"Page Ends",PageExecutive:"Executive",PageLabel:"Page {0} of {1}",PageLandscape:"Landscape",PageLandscapeKeytip:"L",PageLegal:"Legal",PageLetter:"Letter",PageMargins:"Margins",PageMarginsKeytip:"M",PageMarginsTop:"Top:",PageMarginsBottom:"Bottom:",PageMarginsLeft:"Left:",PageMarginsRight:"Right:",PageModerate:"Moderate",PageNarrow:"Narrow",PageNormal:"Normal",PageNumbers:"Page Numbers",PageNumbersKeytip:"NU",PageOffice2003:"Office 2003 Default",PageOrientation:"Orientation",PageOrientationKeytip:"O",PagePortrait:"Portrait",PagePortraitKeytip:"P",PageSize:"Size",PageSizeKeytip:"SZ",PageLayoutColumns:"Columns",PageLayoutColumnsKeytip:"C",ParagraphBordersMenu:"Border Options",ParagraphBorderColor:"Color",ParagraphBorderPadding:"Padding",ParagraphBorderPaddingKeytip:"P",ParagraphBorderTopBorderKeytip:"T",ParagraphBorderOutsideBorderKeytip:"O",ParagraphBorderStyleKeytip:"S",TextColumnOne:"One",TextColumnTwo:"Two",TextColumnThree:"Three",TextColumnLeft:"Left",TextColumnRight:"Right",CustomColumns:"More Columns",CustomColumnsKeytip:"A",PageBackgroundGroupTitle:"Page Background",PageBackgroundGroupTitleTooltip:"More Theme Options",PageWide:"Wide",PaginationGroupTitle:"Show",PaginationGroupTitleTooltip:"More View Options",ParagraphOptionsText:"Paragraph Options",ParagraphOptions:"Paragraph Options...",ParagraphOptionsToolTip:"Paragraph Options",ParagraphShading:"Paragraph Shading",ParagraphShadingKeytip:"PS",ParagraphShadingNoColor:"No Color",ParagraphShadingNoColorKeytip:"N",Paste:"Paste",PasteFloatieFlyout:"(ctrl)",PasteKeyboardShortcutMac:"⌘+V",PasteKeyboardShortcutWindows:"Ctrl+V",PasteKeepFormatting:"Paste Keep Formatting",PasteKeytip:"V",PasteOptions:"Paste Options:",PasteTextOnly:"Paste Text Only",PasteTextOnlyKeyboardShortcutMac:"⌘+Shift+V",PasteTextOnlyKeyboardShortcutWindows:"Ctrl+Shift+V",PasteTextOnlyKeytip:"T",PasteWithMergedFormatting:"Merge Formatting",PeopleWellFlyoutLabel:"Select someone's name to go where they are editing",Percent:"Percent",PeripheralCommentsButton:"Comments",PersonalDictionaryLabel:"Personal Dictionary",PerspectiveShadowWhite:"Perspective Shadow, White",Picture:"Picture",PictureBorder:"Border",PictureBorderDashes:"Dashes",PictureBorderDashesKeytip:"D",PictureBorderKeytip:"B",PictureBorderNoOutline:"No Outline",PictureBorderNoOutlineKeytip:"N",PictureBorderStyleSolid:"Solid",PictureBorderStyleRoundDot:"Round Dot",PictureBorderStyleDash:"Dash",PictureBorderWeight:"Weight",PictureBorderWeightKeytip:"W",PictureBorderWeightFourPointFive:"4.5 pt",PictureBorderWeightOne:"1 pt",PictureBorderWeightOnePointFive:"1.5 pt",PictureBorderWeightThree:"3 pt",PictureBorderWeightTwoPointTwoFive:"2.25 pt",PictureBorderWeightZeroPointFive:"0.5 pt",PictureBorderWeightZeroPointSevenFive:"0.75 pt",PictureBorderWeightZeroPointTwoFive:"0.25 pt",PictureStandalone:"Insert Picture",PictureFromDevice:"Picture from Device",PictureHeightLabel:"Height:",PictureHeightTooltip:"Height",PictureHeightTooltipKeytip:"H",PictureKeytip:"P",PictureScaleLabel:"Scale:",PictureScaleTooltip:"Scale",PictureScaleTooltipKeytip:"S",PictureSizeDialogLauncherKeytip:"SZ",PictureStyles:"Picture Styles",PictureWidthLabel:"Width: ",PictureWidthTooltip:"Width",PictureWidthTooltipKeytip:"W",PinRibbonTooltip:"Expand the Ribbon",PixelsUnitPlaceholder:"{0} px",PlainTables:"Plain Tables",PointUnitPlaceholder:"{0} pt",PreviousChange:"Previous",PreviousChangeStandalone:"Previous Change",PreviousChangeKeytip:"F",PreviousComment:"Previous",PreviousCommentStandalone:"Previous Comment",PreviousCommentKeytip:"V",PreviousSearchResult:"Previous Search Result",PreviousVersions:"Previous Versions",PreviousVersionsDescription:"View, restore, or download older versions of this document.",PreviousVersionsKeytip:"P",Print:"Print",PrintKeytip:"P",PrintToPdf:"Print to PDF",PrintToPdfDescription:"Create a printable PDF of this document.",PrintToPdfKeytip:"R",Privacy:"Privacy and cookies",PrivacyDescription:"Learn how Microsoft protects your privacy.",PrivacyKeytip:"P",ProofingSplitButton:"Spelling & Grammar",ProtectDocument:"Protect Document",ProtectDocumentKeytip:"D",ProtectDocumentButton:"Always open view-only",ProtectDocumentButtonKeytip:"VO",ProtectDocumentTooltip:"Always open view-only to prevent accidental changes.",PublishKeytip:"X",Question:"Question",QuickFormat:"Quick Format",QuickStyles:"Quick Styles",QuickStylesKeytip:"K",ReadingTimeToggle:"Show Time To Read",ReadView:"Reading View",ReadViewKeytip:"F",Recent:"Recent",RecentColors:"Recent Colors",RecentDocuments:"Recent Documents",RecentLinks:"Recent Links",RecentLinksError:"No links available right now",RecentLinksKeyTip:"R",Recommended:"Recommended",Redo:"Redo",RedoKeytip:"O",References:"References",Refinements:"Refinements",ReflectedBevelBlack:"Reflected Bevel, Black",ReflectedBevelWhite:"Reflected Bevel, White",ReflectedPerspectiveRight:"Reflected Perspective Right",ReflectedRoundedRectangle:"Reflected Rounded Rectangle",RejectAllChanges:"Reject All Changes",RejectAllChangesKeytip:"B",RejectChange:"Reject",RejectChangeKeytip:"J",RejectChangeAndMoveToNext:"Reject And Move To Next",RejectChangeAndMoveToNextKeytip:"A",RelaxedPerspectiveWhite:"Relaxed Perspective, White",Remove:"Remove",RemoveContentControl:"Remove Content Control",RemoveHeaders:"Remove Headers",RemoveHeadersKeytip:"RH",RemoveFooters:"Remove Footers",RemoveFootersKeytip:"RF",RemoveHyperlink:"Remove Link",RemovePageNumbers:"Remove Page Numbers",RemovePageNumbersKeytip:"R",RemoveSpaceAfterParagraph:"Remove Space After Paragraph",RemoveSpaceAfterParagraphKeytip:"A",RemoveSpaceBeforeParagraph:"Remove Space Before Paragraph",RemoveSpaceBeforeParagraphKeytip:"B",RemoveTableOfContents:"Remove Table of Contents",RemoveTableOfContentsKeytip:"RT",RenameButtonDescription:"Rename this file.",RenameButtonTitle:"Rename",RenameButtonTitleKeytip:"R",Repeat:"Repeat",RepeatKeytip:"O",Replace:"Replace",ReplaceAll:"Replace All",ReplaceBoxPlaceholder:"Replace with...",ReplaceBoxPlaceholderV2:"Replace with",ReplaceKeytip:"R",ReplaceTooltip:"Replace",ReplyWithChanges:"Reply with Changes",ReplyWithChangesDescription:"Reply by email with a link to this document.",ReplyWithChangesKeytip:"R",ReportAbuse:"Report Abuse",ReportAbuseDescription:"Report this document as having inappropriate content.",ReportAbuseKeytip:"R",Reset:"Reset",ResetAllCommentFilters:"Reset all",ResetAllCommentFiltersKeytip:"RA",ResetPicture:"Reset Picture",ResetPictureKeytip:"QR",Resize:"Resize",ResizeCurrentValue:"Task Pane is now {0} pixels wide",ResizeMaxValue:"Maximum width reached, can't resize further",ResizeMinValue:"Minimum width reached, can't resize further",ResizeModeOff:"Resize mode off",ResizeModeOn:"Resize mode on, press the left and right arrow keys to adjust width",ResumeAssistantAsCV:"CV Assistant",ResumeAssistantAsCVKeytip:"C2",ResumeAssistantAsResume:"Resume Assistant",ResumeAssistantAsResumeKeytip:"R2",ResetToMSDefault:"Reset Document to Word Default Styles",ResetToMSDefaultKeytip:"R",Retry:"Retry",Rewrite:"Rewrite",RewriteKeytip:"Get suggested rewrites for this word or phrase",RewriteSuggestionsString:"Rewrite Suggestions",RibbonInsertPageBreak:"Page Break",RibbonInsertPageBreakKeytip:"B",RibbonLabel:"Ribbon",RibbonOptionTextDirection:"ltr",RibbonScalingData:" ",RibbonToggleKeytip:"ZR",Right:"Right",RightBorder:"Right Border",RightBorderKeyTip:"R",RightIndent:"Right Indent",RightMargin:"Right Margin",RightTab:"Right Tab",RightTabStop:"Right tab stop",Rotate:"Rotate",RotatedWhite:"Rotated, White",RotateFlipHorizontal:"Flip Horizontal",RotateFlipVertical:"Flip Vertical",RotateLeft90:"Rotate Left 90°",RotateLeft90Keytip:"L",RotateMoreOptions:"More Rotation Options...",RotateMoreOptionsKeytip:"M",RotateOptions:"Rotate Options...",RotateRight90:"Rotate Right 90°",RotateRight90Keytip:"R",RotateShapeKeytip:"AY",RoundedDiagonalCornerWhite:"Rounded Diagonal Corner, White",Row:"Row",Ruler:"Ruler",RulerTextKeytip:"R",Save:"Save",SaveACopyOnline:"Save a copy online.",SaveAs:"Save as",SaveAsButtonDescription:"Save a copy to OneDrive.",SaveAsKeytip:"A",SaveStyles:"Save Current Styles as Default",SaveStylesKeytip:"SS",SaveATranslatedCopyAndEditDescription:"Save a copy of the translated document and edit in the current browser tab.",SearchableMenuRegionLabel:"Search results",SearchableMenuSearchBoxLabel:"Finds commands",SearchAgain:"Search again",SearchAgainExplanation:"Document content has changed. Search again to make sure the results are current.",SearchAgainExplanationV2:"You have changed this document's content since your last search. Search again to make sure the results are updated.",SearchButtonTooltip:"Search and other search options",SearchOnWeb:"Search on Web",SearchPlaceholder:"Search for...",SearchDocumentFor:"Search the document for...",SearchDocumentForV2:"Search in document",SectionRegionLabel:"Sections",Select:"Select",NewEditingSelectKeytip:"SE",SelectAll:"Select All",SelectAllKeytip:"SA",SelectCell:"Select Cell",SelectCellKeytip:"KL",SelectColumn:"Select Column",SelectColumnKeytip:"KC",SelectHyperlink:"Select Link",SelectKeytip:"K",SelectRow:"Select Row",SelectRowKeytip:"KR",SelectTable:"Select Table",SelectTableKeytip:"KT",SendDocumentsToKindle:"Send documents to Kindle",SendToKindle:"Send to Kindle",SendToKindleDescription:"Send documents to your Kindle device to read and annotate your documents.",SendToKindleKeytip:"S",SendToKindleTooltip:"Send this document to your Amazon account to read it with a Kindle or the Kindle app.",Sensitivity:"Sensitivity",SensitivityKeytip:"SY",EditorProofing:"Proofing",EditorProofingTooltip:"More Proofing Options",SeparatePagesToggle:"Separate Pages",SeparatePagesToggleKeytip:"P",SetLanguageMenu:"Set Proofing Language",SetLanguageMenuKeytip:"L",SetNumberingValue:"Set Numbering Value",Share:"Share",ShareAccessGroupTitle:"Manage Access",ShareCompoundSectionSubtitle:"Sharing your document is free! No subscription or sign-in necessary",ShareGroupTitle:"Share",SharedNotes:"Shared Meeting Notes",ShareKeytip:"H",ShareMenuButtonKeytip:"S",SharePeripheralKeytip:"ZS",ShareWithPeople:"Share with people",ShareWithPeopleDescription:"Invite other people to view or edit this document.",ShareWithPeopleKeytip:"S",ShareWithSummary:"Share with Summary",InvitePeople:"Invite Others",InvitePeopleDescription:"Send an invitation or a link for viewing or editing this document.",ShiftCellsLeft:"Shift Cells Left",ShiftCellsUp:"Shift Cells Up",ShiftCellsRight:"Shift Cells Right",ShowActivity:"Show Edit Activity",ShowActivityKeytip:"AA",ShowBookmarks:"Show on Document",ShowBookmarksKeytip:"S",ShowEndnotes:"Show Endnotes",ShowEndnotesKeytip:"SE",ShowFootnotes:"Show Footnotes",ShowFootnotesKeytip:"SF",ShowHideFormattingMarks:"Show/Hide ¶",ShowHideFormattingMarksKeytip:"FM",ShowIntentSuggestion:"Open Suggestion",ShowIntentSuggestionShortcut:"Alt+Down",ShowWordCountKeytip:"C",ShowReadingTimeKeytip:"T",ShowSuggestionsOnClick:"Show Suggestions On Click",ShowSuggestionsOnClickKeyTip:"H",ShowSuggestionsOnHover:"Show Suggestions On Hover",ShowSuggestionsOnHoverKeyTip:"H",Shrink:"Shrink",ShrinkFont:"Shrink Font Size",ShrinkFontSize:"Shrink Font",ShrinkFontSizeKeytip:"FK",ShrinkKeytip:"R",SimpleFrameBlack:"Simple Frame, Black",SimpleFrameWhite:"Simple Frame, White",SkittleDoNotShowAgain:"Don`t show this again",SnipDiagonalCornerWhite:"Snip Diagonal Corner, White",SmartLookup:"Smart Lookup",SmartLookupKeytip:"L",SmartLookupContextMenuSearchZeroTerm:"Open the Search Pane",SmartLookupSynonyms:"Synonyms",SoftEdgeOval:"Soft Edge Oval",SoftEdgeRectangle:"Soft Edge Rectangle",SpbWordCountAlt:"Word Count",SpbWordCountLabel:"Word Count",SpbWordCountTip:"Turn word count on and off",SpecialIndent:"Special Indent",SpecialIndentFirstLine:"First Line",SpecialIndentFirstLineKeytip:"F",SpecialIndentHanging:"Hanging",SpecialIndentHangingKeytip:"H",SpecialIndentNone:"None",SpecialIndentNoneKeytip:"N",SpecialIndentTooltip:"Special Indent",SpecialIndentTooltipKeytip:"SI",SpinnerAuto:"Auto",SpinnerDecrementButtonAriaLabel:"Less",SpinnerIncrementButtonAriaLabel:"More",SpinnerIndentAfterLtr:"Indent Right",SpinnerIndentAfterLtrKeytip:"IR",SpinnerIndentBeforeLtr:"Indent Left",SpinnerIndentBeforeLtrKeytip:"IL",SpinnerSpacingAfter:"Spacing After",SpinnerSpacingAfterKeytip:"SA",SpinnerSpacingBefore:"Spacing Before",SpinnerSpacingBeforeKeytip:"SB",SplitButtonRoleDescription:"Split Button",SplitCells:"Split",SplitCells_ToBeDeprecated:"Split Cells",SplitCellsKeytip:"P",StandardColors:"Standard Colors",StartNewList:"Start New List",StatsInIdeas:"Stats",StockImages:"Stock Images",StockImagesKeytip:"S",Strikethrough:"Strikethrough",StrikethroughKeytip:"4",StyleOptions:"Style Options",SubmitFailed:"Submit Failed",SubmitFailedDetails:"Unfortunately, something went wrong while submitting the error report.",SubmitSucceeded:"Submit Succeeded",SubmitSucceededDetails:"The error report was successfully submitted. Thank you for helping improve Word.",Subscript:"Subscript",SubscriptKeytip:"5",Superscript:"Superscript",SuperscriptKeytip:"6",SwitchToClassicViewMode:"Switch to classic view",SwitchToClassicViewModeKeytip:"CV",SwitchToUnifiedReadMode:"Switch to new view",SwitchToUnifiedReadModeKeytip:"NV",SymbolPlural:"Symbols",SymbolSingle:"Symbol",SymbolSingleKeytip:"U",TabDesign:"Design",TabDesignKeytip:"JT",TabDesignOneLineRibbonKeytip:"G",TabDeveloper:"Developer",TabDeveloperKeytip:"L",TabFileKeytip:"F",TabFormatPicture:"Format",TabFormatPictureKeytip:"JP",TabForYou:"For You",TabForYouKeytip:"FY",TabHome:"Home",TabHomeKeytip:"H",TabInsert:"Insert",TabInsertKeytip:"N",TabLayout:"Layout",TabLayoutKeytip:"JL",TabReferencesKeytip:"S",TableBorder:"Table Border",TableBorders:"Table Borders",Borders:"Borders",TableBorderColor:"Color",Table:"Table",TableDesignGroupName:"Table Design",TableDesignOverflowName:"More Table Design Options",TableKeytip:"T",TableColumnWidthKeytip:"W",TableRowHeightKeytip:"H",TabTableKeytip:"JT",TableLayoutGroupName:"Table Layout",TableLayoutOverflowName:"More Table Layout Options",TableStyleOptionBandedColumn:"Banded Columns",TableStyleOptionBandedColumnKeytip:"U",TableStyleOptionBandedRow:"Banded Rows",TableStyleOptionBandedRowKeytip:"R",TableStyleOptionFirstColumn:"First Column",TableStyleOptionFirstColumnKeytip:"M",TableStyleOptionFirstRow:"Header Row",TableStyleOptionFirstRowKeytip:"A",TableStyleOptionLastColumn:"Last Column",TableStyleOptionLastColumnKeytip:"N",TableStyleOptionLastRow:"Total Row",TableStyleOptionLastRowKeytip:"T",TableStyleOptionsKeytip:"O",TableStyles:"Table Styles",TableStylesMenu:"More Table Styles",TableStylesKeytip:"S",TabMailings:"Mailings",TabMailingsKeytip:"M",TabPageLayout:"Page Layout",TabPageLayoutKeytip:"P",TabPictureTools:"Picture Tools",TabReview:"Review",TabReviewKeytip:"R",TabShare:"Share",TabShareKeytip:"T",TabTableTools:"Table Tools",TabView:"View",TabViewKeytip:"W",TaskPaneRoleDescription:"pane",TaskPaneTabs:"Task Pane Tabs",TaskPaneOpening:"Opening {0} Pane",TaskList:"Task list",TaskListKeytip:"T",TermsOfUse:"Terms of use",TellMeCopilotLabel:"Chat with Copilot",TellMeSearchPlaceholder:"Search (Alt + {0})",TellMeSearchPlaceholderOnMac:"Search (Option + {0})",TellMeSearchPlaceholderV2:"Search for tools, help, and more (Alt + {0})",TellMeSearchPlaceholderOnMacV2:"Search for tools, help, and more (Option + {0})",TellMeSearchUnifiedAppPlaceholderWord:"Search Word",TellMeAlternativePlaceholder:"Search",TellMeActivationPlaceholder:"Search for actions, text, help, and more",TellMeDeactivationPlaceholder:"Looking for something? Search for it!",TellMeAnswerForSearchLabel:"Answer",TellMeDefinition:"Definitions",TellMeKeytip:"Q",TellMeLabel:"Tell me what you want to do (Alt+Q)",TellMePlaceholder:"Tell me what you want to do",TellMeSuggestedQuery1:'"leave a comment"',TellMeSuggestedQuery2:'"add a table"',TellMeSuggestedQuery3:'"insert header"',TellMeSuggestedQuery4:'"check my spelling"',TellMeSuggestedQuery5:'"change font color"',TellMeGetHelpLabel:'Get Help on "{query}"',TellMeSelectAll:"Select All",TellMeSmartLookupLabel:'Smart Lookup on "{query}"',TellMeSynonym:"Synonyms",TellMeUpsellTrackChanges:"Looking for Track Changes?",TellMeUpsellInsertShapes:"Looking for Insert Shapes?",TellMeUpsellLabels:"Looking for Labels?",TellMeUpsellInsertCitations:"Looking for Insert Citation?",TellMeUpsellTextBox:"Looking for Text Box?",TellMeUpsellTableOfContents:"Looking for Table of Contents?",TellMeUpsellSmartArt:"Looking for SmartArt?",TellMeUpsellWordArt:"Looking for WordArt?",TellMeUpsellMultiColumnLayout:"Looking for Add or Remove Columns?",TellMeUpsellInsertEquations:"Looking for Insert Equation?",TellMeDesktopFeature:"Feature available in Word",TellMeOpenInWord:"Open in Word",TellMeOpenInDesktopDescription:"Use the full functionality of Microsoft Word",TellMeUpsellDesktopTitle:"Don't have Word?",TellMeUpsellDesktopDescription:"Get the latest version now - try Office 365 for free!",TemplateMoreLink:"View more templates",TemplateSectionErrorMessage:"We can't get the list of available templates right now. Please try again later.",TermsOfUseDescription:"Read the terms and conditions of using Word.",TermsOfUseKeytip:"T",TextAlignment:"Text Alignment",TextAlignmentAnchorKeytip:"AT",TextDirLTR:"Left-to-Right",TextDirLTRKeytip:"TL",TextDirLTRTooltip:"Left-to-Right Text Direction",TextDirRTL:"Right-to-Left",TextDirRTLKeytip:"TR",TextDirRTLTooltip:"Right-to-Left Text Direction",TextHighlightColor:"Text Highlight Color {0}",ThemeColors:"Theme Color Variations",ThemeColorsMCU:" Theme Colors",ThickMatteBlack:"Thick Matte, Black",ThisDevice:"This Device",ThirdPartyNotices:"Third-party notices",ThirdPartyNoticesDescription:"Read the Third-Party Notices for Word.",ThirdPartyNoticesKeytip:"N",TimeToReadTooltip:"Estimated time to read the document. Click or tap here to learn how the estimate is calculated.",ToggleProofingOn:"Editor Suggestions: Showing",ToggleProofingOff:"Editor Suggestions: Hidden",ToggleProofingTooltipOn:"Editor is underlining text when it has a suggestion. Click underlined words to see suggestions for spelling, grammar, and more.",ToggleProofingTooltipOff:"Editor suggestions are currently hidden. Click to show underlines, or open the Editor pane to get suggestions for spelling, grammar, and more.",ToggleProofingInRibbonEnable:"Show Suggestions",ToggleProofingInRibbonDisable:"Hide Suggestions",ToggleProofingOnExpB:"Editor Markup: On",ToggleProofingOffExpB:"Editor Markup: Off",ToggleProofingTooltipOnExpB:"Editor is marking text when it has a suggestion. Click underlined words to see suggestions for spelling, grammar, and more.",ToggleProofingTooltipOffExpB:"Editor markup is currently hidden. Click to show markup, or open the Editor pane to get suggestions for spelling, grammar, and more.",ToggleProofingInRibbonEnableExpB:"Show Markup",ToggleProofingInRibbonDisableExpB:"Hide Markup",ToggleRibbonControl:"Single Line Ribbon",ToggleRibbonControlKeytip:"R",ToggleRibbonGroup:"Ribbon",TopBorder:"Top Border",TopBorderKeyTip:"P",TopMargin:"Top Margin",Transform:"Transform",TransformToWeb:"Transform to Web Page",TransformToWebPage:"Transform to webpage",TransformToWebPageKeytip:"W",TransformToWebPageTooltip:"Transform your document into an interactive, easy-to-share web page.",TransformDescription:"Transform your document into an interactive, easy-to-share web page that looks great on any device.",ReviewDesignerSuggestion:"Review Designer Suggestion",RibbonTabsGroupLabel:"Ribbon Tabs",TrackChanges:"Track Changes",TrackChangesModeDropDown:"Markup view:",TrackChangesModeDropDownSimpleMarkup:"Simple Markup",TrackChangesModeDropDownAllMarkup:"All Markup",TrackChangesModeKeytip:"MV",TrackChangesModeHideTrackChanges:"Hide tracked changes.",TrackChangesModeShowTrackChanges:"Show tracked changes.",TrackChangesLabel:"Track Changes:",TrackChangesTooltip:"More Track Changes Options",TrackChangesForEveryone:"For Everyone",TrackChangesForEveryoneKeytip:"F",TrackChangesJustMine:"Just Mine",TrackChangesJustMineKeytip:"J",TrackChangesKeytip:"G",TrackChangesOff:"Off",TrackChangesOffFullDescriptionLabel:"Set Track Changes: Off",TrackChangesOffKeytip:"O",Training:"Training",TrainingKeytip:"S",TranscriptionLabel:"Transcribe",TranscriptionKeytip:"TS",TrustCenter:"Privacy settings",TrustCenterDescription:"Manage your privacy settings.",TrustCenterKeytip:"S",TryMacOffice:"Try Mac Office",TryMacOfficeDescription:"Try the latest full version of Microsoft Office for Mac for free.",TryMacOfficeKeytip:"O",TryOffice:"Try Microsoft Office",TryOfficeDescription:"Try the latest full version of Microsoft Office for free.",TryOfficeKeytip:"M",Underline:"Underline",UnderlineKeytip:"3",Undo:"Undo",UndoKeytip:"ZZ",UnpinRibbonTooltip:"Collapse the Ribbon",Update:"Update",UpdateTableOfContents:"Update Table of Contents",UpdateTableOfContentsKeytip:"U",UpgradeOffice:"Upgrade to Office 365",UpgradeOfficeDescription:"Get the premium, always up-to-date Microsoft Office experience.",UserInterfaceFontName:"'Segoe UI','Segoe UI Web',Arial,Verdana,sans-serif",UserInterfaceFontSize:"14px",VersionHistory:"Version History",VersionHistoryKeytip:"V",ViewAllFiles:"View all files",ViewMoreOptionsGroupName:"More Options",ViewOriginal:"View the Original",ViewPrevious:"View previous versions.",Warning:"Warning",WhatsNew:"What's New",WhatsNewKeytip:"W",WheresTheSaveButton:"Where's the Save Button?",WheresTheSaveButtonDescription:"There's no Save button because we're automatically saving your document.",WheresTheSaveButtonKeytip:"W",WordAppLogoAriaLabel:"Word, Click to open Word home page on microsoft365.com",WordAppLogoTooltip:"Word home",WordChecklist:"Checklist",WordChecklistKeytip:"CL",WordCountKeytip:"W",WordCountMenuItem:"Word Count",WordCountToggle:"Show Word Count",WordCountTooltip:"The number of words in the selection or document. Click or tap to open the word count dialog box.",WordPrediction:"Text Predictions",WordPredictionKeytip:"WP",WordPredictionButtonToolTip:"Switch text predictions on or off. Click or tap here to open settings for text predictions.",WordPredictionDialogTitle:"Type Ahead Settings",WordPredictionDialogButtonDescription:"Suggest words or phrases as I type",WordPredictionDialogDescription:"Editor type ahead predicts and suggests words or phrases to help accelerate your writing.",WordPredictionDialogSubDescription:"on recent suggestions.",WordPredictionDialogLearnMore:"Learn more",WordPredictionDialogFeedback:"give feedback",WordPredictionDialogSeparator:"or",WordTestFeature:"Test Feature",WrapText:"Wrap Text",WrapTextBehindText:"Behind Text",WrapTextBehindTextKeytip:"D",WrapTextInFrontOfText:"In Front of Text",WrapTextInFrontOfTextKeytip:"N",WrapTextInLine:"In Line with Text",WrapTextInLineKeytip:"I",WrapTextKeytip:"TW",WrapTextSquareLeft:"Square Left",WrapTextSquareLeftKeytip:"SL",WrapTextSquareRight:"Square Right",WrapTextSquareRightKeytip:"SR",Yes:"Yes",Zoom:"Zoom",ZoomLabel:"Zoom:",ZoomInTooltip:"Zoom In",ZoomKeytip:"Q",ZoomLevel:"Zoom Level",ZoomOutTooltip:"Zoom Out",ZoomTo100:"100%",ZoomTo100Keytip:"J",TrackChangesForEveryoneLabel:"Set Track Changes: Everyone",TrackChangesJustMineLabel:"Set Track Changes: Just Mine",ZoomTo100Label:"Zoom to 100%",ZoomToFitPageWidthTooltip:"Zoom to fit page width",NeedDesktopAppLabel:"Need Desktop App?",TellMeUpsellBibliography:"Looking for Bibliography?",TellMeUpsellWatermark:"Looking for Watermark?",TellMeUpsellSignature:"Looking for Signature?",TellMeUpsellMailMerge:"Looking for Mail Merge?",TellMeUpsellTabStop:"Looking for Tab Stop?",TellMeUpsellEnvelope:"Looking for Envelope Options?",TellMeUpsellBookmark:"Looking for Bookmark?",CommentPaneLabel:"List",CommentContextualLabel:"Contextual",LikeSelectionLabel:"Like",LikeSelectionKeytip:"LS",SortTable:"Sort",SortTableKeytip:"TS",SortTableAscending:"Sort Ascending",SortTableAscending_ToBeDeprecated:"Sort Table Ascending",SortTableAscendingKeytip:"TA",SortTableDescending:"Sort Descending",SortTableDescending_ToBeDeprecated:"Sort Table Descending",SortTableDescendingKeytip:"TD",ApplyTemplateErrorDialogTitle:"We're unable to apply this template",ApplyTemplateErrorDialogMessage:"Please wait a few minutes and then try again. You can also try refreshing the page.",TableWidthLabel:"Width: ",TableWidthTooltip:"Table Column Width",TableHeightLabel:"Height: ",TableHeightTooltip:"Minimum Table Row Height",PinRows:"Pin Rows",PinRowsTooltip:"Pin up to this row",PinRowsKeytip:"JP",PinUptoThisRow:"Pin Up To This Row",UnpinRows:"Unpin Rows",UnpinRowsTooltip:"Unpin from this row",UnpinRowsKeytip:"JU",UnpinFromThisRow:"Unpin From This Row",UnpinFromThisRowTooltip:"Unpin from this row",LineNumbering:"Line Numbers",LineNumberingKeytip:"LN",LineNumberingNone:"None",LineNumberingNoneKeytip:"N",LineNumberingContinuous:"Continuous",LineNumberingContinuousKeytip:"C",LineNumberingRestartEachPage:"Restart Each Page",LineNumberingRestartEachPageKeytip:"RP",LineNumberingRestartEachSection:"Restart Each Section",LineNumberingRestartEachSectionKeytip:"RS",LineNumberingSuppressForCurrentParagraph:"Suppress for Current Paragraph",LineNumberingSuppressForCurrentParagraphKeytip:"SP",ExpandedHeadingCollapseButtonTooltip:"Collapse Heading",CollapsedHeadingExpandButtonTooltip:"Expand Heading",ShowMeContentAccessibilityHelp:"Keep it inclusive.\n\nLet us make sure that your file follows accessibility best practices. We'll help you fix issues quickly with easy-to-follow directions or recommendations.",ShowMeContentAcronyms:"Displays definitions found for acronyms in the document.",ShowMeContentAlignCenter:"Center your content.",ShowMeContentAlignLeft:"Align your content to the left.",ShowMeContentAlignRight:"Align your content to the right.",ShowMeContentApplyStyle:"Styles give your document a consistent, polished look.\n\nThe also allow you to use the Navigation Pane and add a table of contents.",ShowMeContentBold:"Make your text bold.",ShowMeContentBulletLibrary:"Start a bulleted list.",ShowMeContentChangeCase:"Change the selected text to uppercase, lowercase, or other common capitalizations.",ShowMeContentCheckAccessibility:"Keep it inclusive.\n\nLet us make sure that your file follows accessibility best practices. We'll help you fix issues quickly with easy-to-follow directions or recommendations.",ShowMeContentClearFormatting:"Remove all formatting from the selection, leaving only the normal, unformatted text.",ShowMeContentClearTableFormatting:"Remove all formatting from the selection, leaving only the normal, unformatted text.",ShowMeContentClipboard:"Add content on the Clipboard to your document.",ShowMeContentColumns:"Split your text into two or more columns.\n\nYou can also choose the width and spacing of your columns, or use one of the preset formats.",ShowMeContentContactSupport:"Get help from an Office support agent.",ShowMeContentDarkModeSwitchBackground:"Dark Mode can help reduce eye strain.\n\nThe dark page background does not convey how your document will print and does not affect the view your collaborators will see when they open the document.",ShowMeContentDarkModeToggle:"Dark Mode can help reduce eye strain.\n\nThe dark page background does not convey how your document will print and does not affect the view your collaborators will see when they open the document.",ShowMeContentDecreaseIndent:"Decrease the indent level of the paragraph.",ShowMeContentDeleteAllComments:"Delete all the comments.",ShowMeContentDictation:"For a more hands-off experience, use your voice for commanding  and to author content.\n\nPowered by Microsoft Speech Services",ShowMeContentDictationTranscriptionSplit:"For a more hands-off experience, use your voice for commanding  and to author content.\n\nPowered by Microsoft Speech Services",ShowMeContentDraw:"Insert or update a drawing.",ShowMeContentEditing:"Just start typing here to bring features to your fingertips and get help.",ShowMeContentEditorProofing:"Check for spelling, grammar, and writing suggestions.",ShowMeContentFindReplace:"Find and replace text in the document.",ShowMeContentFontColor:"Change the color of your text.",ShowMeContentFontPicker:"Quickly change the text in your document by picking a new font set.\n\nThis is an easy way to change all of your text at once. For this to work, your text must be formatted using the 'body' and 'heading' fonts.",ShowMeContentFontSize:"Change the size of your text.",ShowMeContentFormatPainter:"Like the look of a particular selection? You can apply that look to other content in the document.\n\nTo get started: \n1. Select content with the formatting you like\n2. Click Format Painter\n3. Select something else to automatically apply the formatting\n\nFYI: To apply the formatting in multiple places, double-click Format Painter.",ShowMeContentGiveFeedback:"Give a compliment, report a problem, or make a suggestion.",ShowMeContentGraphicsEditor:"Fill the selected graphic with color.",ShowMeContentGrowFontSize:"Make your text a bit bigger.",ShowMeContentHighlighter:"Change the color behind the selected text, paragraph or table cell.\n\nThis is especially useful when you want information to jump off the page.",ShowMeContentImmersiveReader:"Open a focused reading and editing experience that lets you adjust text size, spacing, and more. You can also listen to your text read aloud.",ShowMeContentIncreaseIndent:"Move your paragraph farther away from the margin.",ShowMeContentIndentLeft:"Choose how far to move the paragraph away from the left margin.\n\nTo change the margins for the whole document, click the Margins button.",ShowMeContentIndentRight:"Choose how far to move the paragraph away from the right margin.\n\nTo change the margins for the whole document, click the Margins button.",ShowMeContentInsertAddIns:"Manage the add-ins available for use with this file.",ShowMeContentInsertBookmark:"Bookmarks work with hyperlinks to let you jump to a specific place in your document.\n\nHere's how it works:\n1) Select the content you want to jump to\n2) Insert a bookmark\n3) Add a hyperlink that points to your bookmark",ShowMeContentInsertEmoji:"Choose from a collection of smileys, or to see the full set of emojis, select More Emojis.",ShowMeContentInsertEndNote:"Add a note, like a comment or citation, providing more info about something in your document.\n\nSuperscript numbers referring to endnotes are added to your text.",ShowMeContentInsertEndnote:"Add a note, like a comment or citation, providing more info about something in your document.\n\nSuperscript numbers referring to endnotes are added to your text.",ShowMeContentInsertFootnote:"Add a note at the bottom of the page providing more info about something in your document.",ShowMeContentInsertHeaderFooter:"re useful for showcasing information, like title, author, and page number.",ShowMeContentInsertHyperlink:"Create a link in your document for quick access to webpages and files.\n\nHyperlinks can also take you to places in your document.",ShowMeContentInsertOnlineVideo:"Insert videos from a variety of online sources.",ShowMeContentInsertPageBreak:"End the current page here and move to the next page.",ShowMeContentInsertPageNumber:"Number the pages in your document.\n\nYou can choose from a variety of pre-defined looks or select your own format.",ShowMeContentInsertPicture:"Insert pictures from your computer, stock image library or online sources.",ShowMeContentInsertSymbol:"Add symbols that are not on your keyboard.\n\nChoose from a variety of options including mathematical, currency, and copyright symbols.",ShowMeContentInsertTableOfContents:"Provide an overview of your document by adding a table of contents.\n\nText using a heading style will be included automatically. To include more entries, select the text and click Add Text. The table will be refreshed when you click Update Table.",ShowMeContentInvokeFilesSerplet:"Search files for content to reuse.",ShowMeContentItalic:"Italicize your text.",ShowMeContentJustify:"Distribute your text evenly between the margins.\n\nJustified text gives your document clean, crisp edges so it looks more polished.",ShowMeContentKeyboardShortcuts:"Get a list of keyboard shortcuts for Word, categorized and completely searchable.",ShowMeContentLeftToRightTextDirection:"Set the text direction.",ShowMeContentLineSpacing:"Change the spacing between lines.",ShowMeContentLoopComponent:"Loop components are live, interactive, collaborative objects that can be updated wherever they are embedded, such as a Word doc, Teams chat, or email.",ShowMeContentMargins:"Set the margin sizes for the entire document or the current section.\n\nChoose from several commonly-used margin formats, or customize your own.",ShowMeContentModernTranslateDocument:"Send a copy of your document to an online translation service. The translation will appear in a new window.",ShowMeContentModernTranslateSelection:"Translate content into a different language using the Microsoft Translator online service.",ShowMeContentMultiLevelListMenu:"Create a multilevel list to organize items or create an outline.\n\nYou can also change the look of individual levels in your list or add numbering to headings in your document.",ShowMeContentNavigationPane:"It's like a tour guide for your document.\n\nClick a heading, a page, or a search result and it'll take you right there.",ShowMeContentNewComment:"Add a note about this part of the document.",ShowMeContentNumberingLibrary:"Start a numbered list.",ShowMeContentOrientation:"Give your pages a portrait or landscape layout.",ShowMeContentPageColor:"Add a splash of color to your document by changing the color of the page.",ShowMeContentPageSize:"Choose a paper size for your document.",ShowMeContentParagraphOptions:"Fine-tune the layout of the current paragraph, including spacing, indentation, and more.",ShowMeContentParagraphShading:"Change the color behind the selected text, paragraph or table cell.\n\nThis is especially useful when you want information to jump off the page.",ShowMeContentPasteSplitButton:"Add content on the Clipboard to your document",ShowMeContentReadingView:"The best way to read a document, including some tools designed for reading instead of writing.",ShowMeContentReferencesEndnotes:"Jump to the endnotes in your document.",ShowMeContentReferencesInsertFootnote:"Add a note at the bottom of the page providing more info about something in your document.",ShowMeContentReferencesSmartLookUp:"Just start typing here to bring features to your fingertips and get help.",ShowMeContentRemoveTableOfContents:"Deletes the selected table of contents.",ShowMeContentRightToLeftTextDirection:"Set the text direction.",ShowMeContentSelectZoomOption:"Zoom to the level that's right for you.\n\nFor zoomier zooming, use the controls in the status bar.",ShowMeContentSensitivity:"Apply a sensitivity label to your content to keep it compliant with your organization's information protection policies.",ShowMeContentSeparatePagesToggle:"Edit your document in page layout.",ShowMeContentShowComments:"Show/hide the comments alongside the document.",ShowMeContentShowHideEquationToolsPane:"Add common mathematical equations to your document, such as the area of a circle or the quadratic formula.\n\nYou can also build your own equations using the library of math symbols and structures.",ShowMeContentShowHideRuler:"Show rulers next to your document.\n\nYou can see and set tab stops, move table borders, and line up objects in the document. Also, you can measure stuff.",ShowMeContentShowMarkup:"Choose what types of markup to show in your document.\n\nFor example, you can hide comments or formatting changes.",ShowMeContentShrinkFontSize:"Make your text a bit smaller.",ShowMeContentSpacingAfter:"Change how much space appears below the selected paragraphs.",ShowMeContentSpacingBefore:"Change how much space appears above the selected paragraphs.",ShowMeContentSubscript:"Type very small letters just below the line of text.",ShowMeContentSuperscript:"Type very small letters just above the line of text.",ShowMeContentTable:"A table is a great way to organize information within your document.",ShowMeContentTrackChanges:"Keep track of changes made to this document.\n\nThis is especially useful if the document is almost done, and you're working with others to make revisions or give feedback.",ShowMeContentTrackChangesModeDropDown:"Choose what types of markup to show in your document.\n\nFor example, you can hide comments or formatting changes.",ShowMeContentUnderline:"Underline the selected text.",ShowMeContentRedo:"Redo the last action.",ShowMeContentUndoRedo:"Undo the last action.",ShowMeContentUndo:"Undo the last action.",ShowMeContentWhatsNew:"Find out about the latest features and updates to Word on the web.",ShowMeContentWordCount:"Words, characters, lines...\nWe count them so you don't have to.\n\nFYI: To see the word count at a glance, check out the status bar.",ShowMeContentWordCountSplitButton:"Words, characters, lines...\nWe count them so you don't have to.\n\nFYI: To see the word count at a glance, check out the status bar.",ContextualHelpShowMeHowApplyStyle:"Show me how"},r||("undefined"!=typeof window&&!0===window.g_NewStringsInfra?(r=Object.keys(t.WordRibbonStrings).reduce((function(e,t,n){return e[t]=n,e}),{}),o||(o=Object.values(t.WordRibbonStrings))):r=t.WordRibbonStrings)},2703:function(e,t,n){e.exports=n.p+"assets/feedback-nudge.svg"},2705:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtCardService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.apply(this,arguments)}return t=l,(n=[{key:"handleMentions",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}},{key:"handleMentionClick",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(1061).CardService);t.MsgExtCardService=l},2706:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExt3SChannelService=void 0;var o=n(2156),i=n(1061),a=n(406);function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(r||[]);return o(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,a)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(o,a,s,l){var c=p(e[o],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,o(C,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,a,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,n,r,i,p,g=d(h);function h(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(r=g.call(this,e,t)).tokenService=e,r.hostContext=t,r.conversationId=n,r.endpointUrl="https://substrate.office.com/search/api/v1/",r.tokenScope="https://substrate.office.com/search/SubstrateSearch-Internal.ReadWrite",r}return t=h,n=[{key:"verifyCard",value:(i=s().mark((function e(t){var n,r,i,l,c,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.endpointUrl,"verifyCards"),e.next=3,this.getInvokeRequestHeaders();case 3:return r=e.sent,i={method:"POST",headers:r,body:JSON.stringify({Cvid:this.conversationId,LogicalId:(0,a.generateGuid)(),Request:[{cardId:t.cardDetails.cardId,content:t.cardDetails.content,signature:t.cardDetails.signature,extension:{updateExtendedProps:{mailId:this.conversationId,cardId:t.cardDetails.cardId,contentType:t.cardDetails.contentType,appName:t.cardDetails.appName,appIcon:t.cardDetails.appIcon}}}]})},e.next=7,(0,o.fetchWithTimeout)(n,i);case 7:if((l=e.sent).ok){e.next=10;break}throw l;case 10:return e.next=12,l.json();case 12:if(!((c=e.sent).cards instanceof Array)){e.next=16;break}return u={cardId:c.cards[0].cardId,verificationStatus:c.cards[0].verificationStatus},e.abrupt("return",Promise.resolve(u));case 16:return e.abrupt("return",Promise.reject(new Error("Invalid response from verifyCard API")));case 17:case"end":return e.stop()}}),e,this)})),p=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){l(o,n,r,a,s,"next",e)}function s(e){l(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return p.apply(this,arguments)})}],n&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(i.ChannelService);t.MsgExt3SChannelService=g},2707:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtHostService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(e,t,n,r,o,i,a,c,u,d,p){var g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(g=s.call(this,e,t,n,r,o,i,d,p)).getContainer=e,g.userContext=t,g.hostContext=n,g.appService=r,g.tokenService=o,g.openLaunchPage=i,g.copyCard=a,g.deleteCard=c,g.embedCard=u,g.channelService=d,g.telemetryService=p,g}return t=l,(n=[{key:"makeCustomAnnouncement",value:function(e){var t=document.createElement("div"),n="SearchMEAnnounce-"+String(Date.now());t.setAttribute("id",n),t.setAttribute("aria-live","assertive"),t.classList.add("visually-hidden"),document.body.appendChild(t),window.setTimeout((function(){var t=document.getElementById(n);t&&(t.textContent=e.text)}),100),window.setTimeout((function(){var e=document.getElementById(n);e&&document.body.removeChild(e)}),1e3)}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(2121).WebHostService);t.MsgExtHostService=l},2708:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHostService=void 0;var r=n(2791),o=n(173),i=n(319),a=n(2709),s=n(2710),l=n(2711);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(){u=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};l(v,i,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,i)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function o(r,i,a,s){var l=p(e[r],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==c(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),l(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),l(C,s,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function d(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===c(i)?i:String(i)),r)}var o,i}var h=function(){function e(t,n,r,o,i,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getContainer=t,this.userContext=n,this.hostContext=r,this.appService=o,this.tokenService=i,this.openLaunchPage=a,this.channelService=s,this.telemetryService=l}var t,n,c,d,h,f,m,v,b;return t=e,n=[{key:"getImage",value:(b=p(u().mark((function e(t){var n,r,o,i,s,l,c,d,p,g,h,f,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.hostContext.host.name===a.BingHub?a.BingImageProxyEndpoint:a.DefaultImageProxyRelativeEndpoint,e.next=3,caches.open("image-cache");case 3:return i=e.sent,s=this.getCacheKey(t),e.next=7,i.match(s);case 7:if(!(l=e.sent)){e.next=15;break}return e.t0=URL,e.next=12,l.blob();case 12:return e.t1=e.sent,c=e.t0.createObjectURL.call(e.t0,e.t1),e.abrupt("return",Promise.resolve({url:c}));case 15:if(void 0!==(null===(n=this.userContext)||void 0===n?void 0:n.userPrincipalName)){e.next=17;break}return e.abrupt("return",Promise.reject(new Error("User principal name is not available")));case 17:return d=this.userContext.userPrincipalName?"".concat(o,"/").concat(this.userContext.userPrincipalName,"/th?u=").concat(encodeURIComponent(t.url)):"".concat(o,"/th?u=").concat(encodeURIComponent(t.url)),p=new Headers,e.next=21,this.tokenService.getToken({resource:a.Resource});case 21:return(g=e.sent)&&(null==g?void 0:g.authToken)&&p.set("Authorization","Bearer ".concat(g.authToken)),this.userContext.userPrincipalName&&(p.set("X-RoutingParameter-SessionKey",this.userContext.userPrincipalName),p.set("X-AnchorMailbox",this.userContext.userPrincipalName)),h={method:"GET",headers:p},e.prev=25,e.next=28,fetch(d,h);case 28:if(!(f=e.sent).ok||0!==(null===(r=f.headers.get("Content-Type"))||void 0===r?void 0:r.indexOf("image"))){e.next=40;break}return e.next=32,i.put(s,f.clone());case 32:return e.t2=URL,e.next=35,f.blob();case 35:return e.t3=e.sent,m=e.t2.createObjectURL.call(e.t2,e.t3),e.abrupt("return",Promise.resolve({url:m}));case 40:return e.abrupt("return",Promise.resolve({url:a.DefaultPlaceholderImage}));case 41:e.next=46;break;case 43:return e.prev=43,e.t4=e.catch(25),e.abrupt("return",Promise.reject(new Error("Failed to get image. Error: "+String(e.t4))));case 46:case"end":return e.stop()}}),e,this,[[25,43]])}))),function(e){return b.apply(this,arguments)})},{key:"openUrl",value:function(e){return window.open(e.url),Promise.resolve({status:"Success"})}},{key:"handleAuth",value:(v=p(u().mark((function e(t){var n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var a,l={user:n.userContext,app:n.hostContext,page:{id:(null===(a=t.appDefinition)||void 0===a?void 0:a.id)||"",frameContext:i.FrameContexts.authentication}},c=function(t){return function(n,r){return t?(e({code:n}),Promise.resolve()):(o(n),Promise.resolve())}},u=new r.WindowAuthenticationService(c(!0),c(!1),n.tokenService,n.userContext);(0,s.handleAuth)(n.getContainer(),t,u,l,n.telemetryService).catch((function(e){}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"handleJITInstall",value:function(e){throw new Error("Method not implemented.")}},{key:"openTaskModule",value:(m=p(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,l.sanitizeTaskInfo)(t.taskInfo),!(n=this.getDialogFromTaskInfo(t.taskInfo))){e.next=6;break}return e.next=5,this.openDialog(n,t.appId);case 5:return e.abrupt("return",Promise.resolve({status:"Success"}));case 6:return e.abrupt("return",Promise.reject());case 7:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"openStageView",value:(f=p(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getDialogFromStageInfo(t.stageInfo))){e.next=5;break}return e.next=4,this.openDialog(n,t.appId);case 4:return e.abrupt("return",Promise.resolve({status:"Success"}));case 5:return e.abrupt("return",Promise.reject());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"logTelemetry",value:function(e){throw new Error("Method not implemented.")}},{key:"getHostContext",value:function(){var e,t,n={locale:this.hostContext.locale,timeZone:null===(e=this.hostContext.osLocaleInfo)||void 0===e?void 0:e.longDate,timeOffset:null===(t=this.hostContext.osLocaleInfo)||void 0===t?void 0:t.regionalFormat,theme:this.hostContext.theme==i.Themes.dark?i.Themes.dark:i.Themes.default};return Promise.resolve(n)}},{key:"getCacheKey",value:function(e){return e.url}},{key:"getDialogFromTaskInfo",value:function(e){return e.card?Object.assign({type:i.DialogContentType.Card},e):e.url?Object.assign({type:i.DialogContentType.Url},e):void 0}},{key:"getDialogFromStageInfo",value:function(e){var t,n,r=null!==(t=e.contentUrl)&&void 0!==t?t:e.websiteUrl;if(r)return{type:i.DialogContentType.Url,width:.9*window.innerWidth,height:.9*window.innerHeight,title:null!==(n=e.name)&&void 0!==n?n:"",url:r}}},{key:"openDialog",value:(h=p(u().mark((function e(t,n){var o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAppDefinition(n);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject("App definition not found"));case 5:t&&(0,r.openDialog)(t,this.getContainer(),this.channelService,o,this.tokenService,this.userContext,this.hostContext);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getAppDefinition",value:(d=p(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.appService.getApp({id:t});case 2:return n=e.sent,!(r=null==n?void 0:n.appDefinition)&&(null==n?void 0:n.titleInfo)&&(r=(0,o.convertTitleInfoToAppDefinition)(n.titleInfo)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})}],n&&g(t.prototype,n),c&&g(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.WebHostService=h},2709:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=t.DefaultPlaceholderImage=t.DefaultImageProxyRelativeEndpoint=t.BingImageProxyEndpoint=t.BingHub=void 0;t.Resource="https://outlook.office365.com/connectors";t.DefaultPlaceholderImage="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";t.DefaultImageProxyRelativeEndpoint="/actionsb2netcore";t.BingImageProxyEndpoint="https://outlook.office.com/actionsb2netcore";t.BingHub="Orange"},2710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAuth=function(e,t,n,r,o){return c.apply(this,arguments)};var r=n(319);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,s,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,s)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(r,a,s,l){var c=p(e[r],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==o(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,s,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}var s=800,l=600;function c(){var e;return e=i().mark((function e(t,n,o,a,c){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var u,d,p=t.ownerDocument.defaultView;if(p){var g=(0,r.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n.appDefinition),{version:null!==(u=n.appDefinition.version)&&void 0!==u?u:"",appId:n.appDefinition.id,manifestVersion:null!==(d=n.appDefinition.manifestVersion)&&void 0!==d?d:""})),h={url:n.signInUrl,width:s,height:l,left:p.screen.availWidth/2-s/2,top:p.screen.availHeight/2-l/2};new r.MetaOSAuthExtension(p,h,g,o,a,{log:function(e,t,n,r){}},c)?e(void 0):i("Unable to initialize auth extension")}else i("Window object is null")})));case 1:case"end":return e.stop()}}),e)})),c=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))},c.apply(this,arguments)}},2711:function(e,t,n){"use strict";function r(e){if(!e&&"string"!=typeof e&&"number"!=typeof e)return-1;if("string"==typeof e){var t=e,n=parseInt(t);if(!isNaN(n))return n;switch(t.toLowerCase()){case"large":return-3;case"medium":return-2;default:return-1}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeTaskInfo=function(e){e.width=r(e.width),e.height=r(e.height),e.card&&"string"!=typeof e.card&&(e.card=JSON.stringify(e.card))}},2712:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtPreviewHostService=void 0;var o=n(2810),i=n(2121),a=n(540),s=n(319);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,r,i=u(d);function d(e,t,n,r,o,a,s,l,c){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(u=i.call(this,e,t,n,r,o,a,s,l)).displayExternalUrlWarning=c,u}return t=d,(n=[{key:"openUrl",value:function(e){var t,n,r=this;if(null===(t=e.cardData)||void 0===t?void 0:t.appId){var o=e.cardData.appId;return new Promise((function(t,n){r.getAppDefinition(o).then((function(n){var o,i,a;if(n){var l=(0,s.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n),{version:null!==(o=n.version)&&void 0!==o?o:"",appId:n.id,manifestVersion:null!==(i=n.manifestVersion)&&void 0!==i?i:""}));if((0,s.isValidOriginForApp)(e.url,{log:function(e,t,n,r){}},l))return window.open(e.url),Promise.resolve({status:"Success"})}t(r.openUrlWithWarning(e.url,null===(a=e.cardData)||void 0===a?void 0:a.cardId))})).catch((function(){var n;t(r.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId))}))}))}return this.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId)}},{key:"openUrlWithWarning",value:function(e,t){var n,r;return null!==(r=null===(n=this.displayExternalUrlWarning)||void 0===n?void 0:n.call(this,t).then((function(){return window.open(e),Promise.resolve({status:"Success"})})).catch((function(e){return Promise.reject(e)})))&&void 0!==r?r:Promise.reject("Unable to display open external url warning")}},{key:"copyCard",value:function(e){var t,n=e.cardDetails;if(n&&n.contentType==a.M365CardContentType.AdaptiveCard){var r=JSON.parse(n.content);if(r){var i=null===(t=r.metadata)||void 0===t?void 0:t.webUrl;i&&(0,o.copyTextToClipboard)(i,document)}}}},{key:"deleteCard",value:function(e){throw new Error("Method not implemented.")}},{key:"embedCard",value:function(e){throw new Error("Method not implemented.")}},{key:"makeCustomAnnouncement",value:function(e){throw new Error("Method not implemented.")}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.WebHostService);t.MsgExtPreviewHostService=p},2713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerfMarker=void 0;var r=n(1106);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}var a=6e4,s=function(){function e(t,n,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=t,this.name=n,this.telemetryService=o,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((function(){i.log({type:r.LogType.LogMetric,tag:i.tag,name:i.name,success:r.SuccessStatus.Timeout,duration:a,diagnosticsData:"Ended with Timeout",source:-1}),i.isTimeout=!0}),a)}var t,n,o;return t=e,(n=[{key:"logMetricEnd",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Successful,duration:n,correlationVector:t,source:-1}))}}},{key:"logMetricEndWithError",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Failure,duration:n,correlationVector:t,source:-1}))}}},{key:"log",value:function(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PerfMarker=s},2718:function(e,t,n){e.exports=n.p+"assets/feedback-nudge.svg"},2723:function(e,t,n){e.exports=n.p+"assets/fre-reviewer-agent-illustration.svg"},2729:function(e,t,n){e.exports=n.p+"assets/feedback-nudge.svg"},2730:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtCardService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.apply(this,arguments)}return t=l,(n=[{key:"handleMentions",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}},{key:"handleMentionClick",value:function(e){throw new Error("Method not implemented. Request: "+String(e))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(1781).CardService);t.MsgExtCardService=l},2731:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExt3SChannelService=void 0;var o=n(2157),i=n(1781),a=n(1467);function s(){s=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(r||[]);return o(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,a)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(o,a,s,l){var c=p(e[o],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,o(C,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,a,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,n,r,i,p,g=d(h);function h(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(r=g.call(this,e,t)).tokenService=e,r.hostContext=t,r.conversationId=n,r.endpointUrl="https://substrate.office.com/search/api/v1/",r.tokenScope="https://substrate.office.com/search/SubstrateSearch-Internal.ReadWrite",r}return t=h,n=[{key:"verifyCard",value:(i=s().mark((function e(t){var n,r,i,l,c,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.endpointUrl,"verifyCards"),e.next=3,this.getInvokeRequestHeaders();case 3:return r=e.sent,i={method:"POST",headers:r,body:JSON.stringify({Cvid:this.conversationId,LogicalId:(0,a.generateGuid)(),Request:[{cardId:t.cardDetails.cardId,content:t.cardDetails.content,signature:t.cardDetails.signature,extension:{updateExtendedProps:{mailId:this.conversationId,cardId:t.cardDetails.cardId,contentType:t.cardDetails.contentType,appName:t.cardDetails.appName,appIcon:t.cardDetails.appIcon}}}]})},e.next=7,(0,o.fetchWithTimeout)(n,i);case 7:if((l=e.sent).ok){e.next=10;break}throw l;case 10:return e.next=12,l.json();case 12:if(!((c=e.sent).cards instanceof Array)){e.next=16;break}return u={cardId:c.cards[0].cardId,verificationStatus:c.cards[0].verificationStatus},e.abrupt("return",Promise.resolve(u));case 16:return e.abrupt("return",Promise.reject(new Error("Invalid response from verifyCard API")));case 17:case"end":return e.stop()}}),e,this)})),p=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){l(o,n,r,a,s,"next",e)}function s(e){l(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return p.apply(this,arguments)})}],n&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(i.ChannelService);t.MsgExt3SChannelService=g},2732:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtHostService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(e,t,n,r,o,i,a,c,u,d,p){var g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(g=s.call(this,e,t,n,r,o,i,d,p)).getContainer=e,g.userContext=t,g.hostContext=n,g.appService=r,g.tokenService=o,g.openLaunchPage=i,g.copyCard=a,g.deleteCard=c,g.embedCard=u,g.channelService=d,g.telemetryService=p,g}return t=l,(n=[{key:"makeCustomAnnouncement",value:function(e){var t=document.createElement("div"),n="SearchMEAnnounce-"+String(Date.now());t.setAttribute("id",n),t.setAttribute("aria-live","assertive"),t.classList.add("visually-hidden"),document.body.appendChild(t),window.setTimeout((function(){var t=document.getElementById(n);t&&(t.textContent=e.text)}),100),window.setTimeout((function(){var e=document.getElementById(n);e&&document.body.removeChild(e)}),1e3)}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(2125).WebHostService);t.MsgExtHostService=l},2733:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHostService=void 0;var r=n(173),o=n(270),i=n(2734),a=n(2745),s=n(2128),l=n(2746),c=n(2127);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){d=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var g={};function h(){}function f(){}function m(){}var v={};l(v,i,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,i)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function o(r,i,a,s){var l=p(e[r],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==u(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return o("throw",e,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),l(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),l(C,s,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===u(i)?i:String(i)),r)}var o,i}var f=function(){function e(t,n,r,o,i,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getContainer=t,this.userContext=n,this.hostContext=r,this.appService=o,this.tokenService=i,this.openLaunchPage=a,this.channelService=s,this.telemetryService=l}var t,n,u,p,f,m,v,b,y;return t=e,n=[{key:"getImage",value:(y=g(d().mark((function e(t){var n,r,o,i,a,l,c,u,p,g,h,f,m;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.hostContext.host.name===s.BingHub?s.BingImageProxyEndpoint:s.DefaultImageProxyRelativeEndpoint,e.next=3,caches.open("image-cache");case 3:return i=e.sent,a=this.getCacheKey(t),e.next=7,i.match(a);case 7:if(!(l=e.sent)){e.next=15;break}return e.t0=URL,e.next=12,l.blob();case 12:return e.t1=e.sent,c=e.t0.createObjectURL.call(e.t0,e.t1),e.abrupt("return",Promise.resolve({url:c}));case 15:if(void 0!==(null===(n=this.userContext)||void 0===n?void 0:n.userPrincipalName)){e.next=17;break}return e.abrupt("return",Promise.reject(new Error("User principal name is not available")));case 17:return u=this.userContext.userPrincipalName?"".concat(o,"/").concat(this.userContext.userPrincipalName,"/th?u=").concat(encodeURIComponent(t.url)):"".concat(o,"/th?u=").concat(encodeURIComponent(t.url)),p=new Headers,e.next=21,this.tokenService.getToken({resource:s.Resource});case 21:return(g=e.sent)&&(null==g?void 0:g.authToken)&&p.set("Authorization","Bearer ".concat(g.authToken)),this.userContext.userPrincipalName&&(p.set("X-RoutingParameter-SessionKey",this.userContext.userPrincipalName),p.set("X-AnchorMailbox",this.userContext.userPrincipalName)),h={method:"GET",headers:p},e.prev=25,e.next=28,fetch(u,h);case 28:if(!(f=e.sent).ok||0!==(null===(r=f.headers.get("Content-Type"))||void 0===r?void 0:r.indexOf("image"))){e.next=40;break}return e.next=32,i.put(a,f.clone());case 32:return e.t2=URL,e.next=35,f.blob();case 35:return e.t3=e.sent,m=e.t2.createObjectURL.call(e.t2,e.t3),e.abrupt("return",Promise.resolve({url:m}));case 40:return e.abrupt("return",Promise.resolve({url:s.DefaultPlaceholderImage}));case 41:e.next=46;break;case 43:return e.prev=43,e.t4=e.catch(25),e.abrupt("return",Promise.reject(new Error("Failed to get image. Error: "+String(e.t4))));case 46:case"end":return e.stop()}}),e,this,[[25,43]])}))),function(e){return y.apply(this,arguments)})},{key:"openUrl",value:function(e){return window.open(e.url),Promise.resolve({status:"Success"})}},{key:"handleAuth",value:(b=g(d().mark((function e(t){var n=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var i,s={user:n.userContext,app:n.hostContext,page:{id:(null===(i=t.appDefinition)||void 0===i?void 0:i.id)||"",frameContext:o.FrameContexts.authentication}},c=function(t){return function(n,o){return t?(e({code:n}),Promise.resolve()):(r(n),Promise.resolve())}},u=new a.WindowAuthenticationService(c(!0),c(!1),n.tokenService,n.userContext);(0,l.handleAuth)(n.getContainer(),t,u,s,n.telemetryService).catch((function(e){}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)})},{key:"handleJITInstall",value:function(e){throw new Error("Method not implemented.")}},{key:"openTaskModule",value:(v=g(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.sanitizeTaskInfo)(t.taskInfo),!(n=this.getDialogFromTaskInfo(t.taskInfo))){e.next=6;break}return e.next=5,this.openDialog(n,t.appId);case 5:return e.abrupt("return",Promise.resolve({status:"Success"}));case 6:return e.abrupt("return",Promise.reject());case 7:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"openStageView",value:(m=g(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getDialogFromStageInfo(t.stageInfo))){e.next=5;break}return e.next=4,this.openDialog(n,t.appId);case 4:return e.abrupt("return",Promise.resolve({status:"Success"}));case 5:return e.abrupt("return",Promise.reject());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"logTelemetry",value:function(e){throw new Error("Method not implemented.")}},{key:"getHostContext",value:function(){var e,t,n={locale:this.hostContext.locale,timeZone:null===(e=this.hostContext.osLocaleInfo)||void 0===e?void 0:e.longDate,timeOffset:null===(t=this.hostContext.osLocaleInfo)||void 0===t?void 0:t.regionalFormat,theme:this.hostContext.theme==o.Themes.dark?o.Themes.dark:o.Themes.default};return Promise.resolve(n)}},{key:"getCacheKey",value:function(e){return e.url}},{key:"getDialogFromTaskInfo",value:function(e){return e.card?Object.assign({type:o.DialogContentType.Card},e):e.url?Object.assign({type:o.DialogContentType.Url},e):void 0}},{key:"getDialogFromStageInfo",value:function(e){var t,n,r=null!==(t=e.contentUrl)&&void 0!==t?t:e.websiteUrl;if(r)return{type:o.DialogContentType.Url,width:.9*window.innerWidth,height:.9*window.innerHeight,title:null!==(n=e.name)&&void 0!==n?n:"",url:r}}},{key:"openDialog",value:(f=g(d().mark((function e(t,n){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAppDefinition(n);case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject("App definition not found"));case 5:t&&(0,i.openDialog)(t,this.getContainer(),this.channelService,r,this.tokenService,this.userContext,this.hostContext);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"getAppDefinition",value:(p=g(d().mark((function e(t){var n,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.appService.getApp({id:t});case 2:return n=e.sent,!(o=null==n?void 0:n.appDefinition)&&(null==n?void 0:n.titleInfo)&&(o=(0,r.convertTitleInfoToAppDefinition)(n.titleInfo)),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})}],n&&h(t.prototype,n),u&&h(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.WebHostService=f},2734:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.openDialog=function(e,t,n,r,s,l,c){i.render(o.createElement(a.DialogContainer,{dialogContent:e,botService:n,appDefinition:r,hostContext:c,tokenService:s,userContext:l}),t)};var o=l(n(1)),i=l(n(107)),a=n(2735);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=i?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=e[a]}return o.default=e,n&&n.set(e,o),o}},2735:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DialogContainer=function(e){var t=e.dialogContent,n=e.botService,r=e.appDefinition,o=e.tokenService,d=e.userContext,g=e.hostContext,h=(v=a.useState(t),b=2,function(e){if(Array.isArray(e))return e}(v)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(v,b)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(v,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=h[0],m=h[1];var v,b;a.useMemo((function(){m(t)}),[t]);var y=a.useMemo((function(){var e={close:function(){return m(void 0)},update:m};return Object.assign({submit:(0,c.getDialogSubmit)(n,e)},e)}),[n]);if(!f)return null;var C=function(e,t,n,r,o,s){var l,c=(0,i.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n),{version:null!==(l=n.version)&&void 0!==l?l:"",appId:n.id}));switch(e.type){case i.DialogContentType.Card:return null;case i.DialogContentType.Url:return a.createElement(u.DialogWebContent,{dialogActions:t,content:e,appDefinition:c,hostContext:o,tokenService:r,userContext:s})}}(f,y,r,o,g,d),O=a.createElement(s.DialogHeader,{appDefinition:r,dialogActions:y,title:f.title});return a.createElement(l.DialogRenderer,{contentView:C,dialogActions:y,appDefinition:r,headerView:O,dialogSize:t})};var o=n(1777),i=n(270),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(o,a,s):o[a]=e[a]}o.default=e,n&&n.set(e,o);return o}(n(1)),s=n(2736),l=n(2738),c=n(2740),u=n(2741);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,o.initializeIcons)()},2736:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DialogHeader=function(e){var t=(0,a.useStyles)(),n=e.appDefinition,r=e.dialogActions,s=e.title,c=i.useMemo((function(){return{src:n.largeImageUrl,imageFit:o.ImageFit.contain}}),[n.largeImageUrl]);return i.createElement(o.Stack.Item,{className:t.dialogHeader},i.createElement(o.ImageIcon,{className:t.dialogIcon,imageProps:c}),i.createElement(o.Stack,{verticalAlign:"center"},i.createElement(o.Stack.Item,{className:s?t.appName:t.appNameLarge},n.name),s?i.createElement(o.Stack.Item,{className:t.title},s):null),i.createElement(o.Icon,{title:l,"aria-label":l,onClick:r.close,iconName:"Cancel",className:t.cancelIcon}))};var o=n(80),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=i?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=e[a]}o.default=e,n&&n.set(e,o);return o}(n(1)),a=n(2737);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var l="Close"},2737:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStyles=void 0;var r=n(1783),o=n(8),i=(0,r.createFluentComponentStyles)("DialogHeader",(0,o.makeStyles)({dialogHeader:{display:"flex",flexDirection:"row",marginBottom:"6px",paddingTop:"24px",paddingRight:"24px",paddingBottom:"0px",paddingLeft:"32px",width:"auto"},appNameLarge:{fontWeight:"bold",fontSize:"18px"},appName:{fontWeight:"bold",fontSize:"14px"},title:{fontSize:"12px"},dialogIcon:{minWidth:"24px",minHeight:"24px",maxHeight:"32px",maxWidth:"32px",marginRight:"16px"},cancelIcon:{marginLeft:"auto"}}));t.useStyles=i},2738:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DialogRenderer=function(e){var t=e.dialogActions,n=e.contentView,r=e.headerView,l=e.dialogSize,c=(0,s.useStyles)(),u=void 0;l&&(u=Object.assign(Object.assign({},c),{main:{width:(0,a.getDialogWidth)(l.width),height:(0,a.getDialogHeight)(l.height)}}));return n?i.createElement(o.Modal,{styles:null!=u?u:c,scrollableContentClassName:c.modal,onDismiss:t.close,isOpen:!0},i.createElement(o.Stack,{className:c.dialogContainer},r,i.createElement(o.Stack.Item,{className:c.dialogBody},n))):null};var o=n(80),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(o,a,s):o[a]=e[a]}o.default=e,n&&n.set(e,o);return o}(n(1)),a=n(2127),s=n(2739);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}},2739:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStyles=void 0;var r=n(1783),o=n(8),i=(0,r.createFluentComponentStyles)("DialogRenderer",(0,o.makeStyles)({main:{width:"auto",height:"auto",maxWidth:"90%",maxHeight:"90%",minWidth:"20%",minHeight:"20%"},modal:{height:"100%",width:"100%",overflowY:"hidden"},dialogContainer:{height:"100%"},dialogBody:{height:"100%",alignItems:"center",display:"flex",flexDirection:"column",overflowY:"auto",paddingTop:"0",paddingRight:"16px",paddingBottom:"16px",paddingLeft:"16px","&::-webkit-scrollbar-button:horizontal:start:increment":{},"&::-webkit-scrollbar-button:horizontal:end:decrement":{},"&::-webkit-scrollbar-button:vertical:start:increment":{},"&::-webkit-scrollbar-button:vertical:end:decrement":{display:"none"},"&::-webkit-scrollbar-button:start:increment":{},"&::-webkit-scrollbar-button:start:decrement":{display:"none"}}}));t.useStyles=i},2740:function(e,t,n){"use strict";function r(e,t){e&&0===Object.keys(e).length&&t.close()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDialogSubmit=function(e,t){return function(n){if(n){var o={botId:"",appId:"",requestBody:{name:"task/submit",value:{data:n}}};e.botInvoke(o).then((function(e){return r(e,t)})).catch((function(e){}))}else t.close()}},t.handleTaskSubmitResponse=r},2741:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DialogWebContent=function(e){var t,n={authenticationService:new a.AuthenticationService(e.tokenService,e.userContext),hubUiService:new l.HubUiService,linkService:new c.LinkService,dialogService:new s.DialogService(e.dialogActions)},r={user:e.userContext,app:e.hostContext,page:{id:(null===(t=e.appDefinition)||void 0===t?void 0:t.id)||"",frameContext:o.FrameContexts.content}};return i.createElement(o.MetaOsAppContainer,{hostWindow:window,hubServices:n,contentUrl:e.content.url,appDefinition:e.appDefinition,context:r})};var o=n(270),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(o,a,s):o[a]=e[a]}o.default=e,n&&n.set(e,o);return o}(n(1)),a=n(2129),s=n(2742),l=n(2743),c=n(2744);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}},2742:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DialogService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this)).dialogActions=e,t}return t=l,(n=[{key:"open",value:function(e){throw new Error("Method not implemented.")}},{key:"submit",value:function(e,t){return this.dialogActions.submit(e),Promise.resolve()}},{key:"messageForParent",value:function(e){throw new Error("Method not implemented.")}},{key:"messageForChild",value:function(e){throw new Error("Method not implemented.")}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(270).EventService);t.DialogService=l},2743:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HubUiService=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=a?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(r,s,l):r[s]=e[s]}r.default=e,n&&n.set(e,r);return r}(n(1));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===i(a)?a:String(a)),r)}var o,a}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"getLoadingUi",value:function(){return r.createElement(r.Fragment,null)}},{key:"getErrorUi",value:function(e){return r.createElement(r.Fragment,null)}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.HubUiService=s},2744:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkService=void 0;var r=n(2814);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"openLink",value:function(e){return(0,r.deepLinkParser)(e)?Promise.resolve():Promise.reject()}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.LinkService=a},2745:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.WindowAuthenticationService=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,s=a(l);function l(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(o=s.call(this,n,r)).notifySuccess=e,o.notifyFailure=t,o}return t=l,n&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(n(2129).AuthenticationService);t.WindowAuthenticationService=l},2746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAuth=function(e,t,n,r,o){return c.apply(this,arguments)};var r=n(270);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var g={};function h(){}function f(){}function m(){}var v={};u(v,s,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(k([])));y&&y!==t&&n.call(y,s)&&(v=y);var C=m.prototype=h.prototype=Object.create(v);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function i(r,a,s,l){var c=p(e[r],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==o(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,l)}),(function(e){i("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,l)}))}l(c.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=p(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return f.prototype=m,r(C,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},O(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(C),u(C,c,"Generator"),u(C,s,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),g}},e}function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}var s=800,l=600;function c(){var e;return e=i().mark((function e(t,n,o,a,c){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var u,d=t.ownerDocument.defaultView;if(d){var p=(0,r.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n.appDefinition),{version:null!==(u=n.appDefinition.version)&&void 0!==u?u:"",appId:n.appDefinition.id})),g={url:n.signInUrl,width:s,height:l,left:d.screen.availWidth/2-s/2,top:d.screen.availHeight/2-l/2};new r.MetaOSAuthExtension(d,g,p,o,a,c)?e(void 0):i("Unable to initialize auth extension")}else i("Window object is null")})));case 1:case"end":return e.stop()}}),e)})),c=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))},c.apply(this,arguments)}},2747:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgExtPreviewHostService=void 0;var o=n(2808),i=n(2125),a=n(2151),s=n(270);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,r,i=u(d);function d(e,t,n,r,o,a,s,l,c){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(u=i.call(this,e,t,n,r,o,a,s,l)).displayExternalUrlWarning=c,u}return t=d,(n=[{key:"openUrl",value:function(e){var t,n,r=this;if(null===(t=e.cardData)||void 0===t?void 0:t.appId){var o=e.cardData.appId;return new Promise((function(t,n){r.getAppDefinition(o).then((function(n){var o,i;if(n){var a=(0,s.convertManifestDefinitionToAppDefinition)(Object.assign(Object.assign({},n),{version:null!==(o=n.version)&&void 0!==o?o:"",appId:n.id}));if((0,s.isValidUrlForApp)(e.url,a))return window.open(e.url),Promise.resolve({status:"Success"})}t(r.openUrlWithWarning(e.url,null===(i=e.cardData)||void 0===i?void 0:i.cardId))})).catch((function(){var n;t(r.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId))}))}))}return this.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId)}},{key:"openUrlWithWarning",value:function(e,t){var n,r;return null!==(r=null===(n=this.displayExternalUrlWarning)||void 0===n?void 0:n.call(this,t).then((function(){return window.open(e),Promise.resolve({status:"Success"})})).catch((function(e){return Promise.reject(e)})))&&void 0!==r?r:Promise.reject("Unable to display open external url warning")}},{key:"copyCard",value:function(e){var t,n=e.cardDetails;if(n&&n.contentType==a.M365CardContentType.AdaptiveCard){var r=JSON.parse(n.content);if(r){var i=null===(t=r.metadata)||void 0===t?void 0:t.webUrl;i&&(0,o.copyTextToClipboard)(i,document)}}}},{key:"deleteCard",value:function(e){throw new Error("Method not implemented.")}},{key:"embedCard",value:function(e){throw new Error("Method not implemented.")}},{key:"makeCustomAnnouncement",value:function(e){throw new Error("Method not implemented.")}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.WebHostService);t.MsgExtPreviewHostService=p},2748:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerfMarker=void 0;var r=n(2811);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}var a=6e4,s=function(){function e(t,n,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=t,this.name=n,this.telemetryService=o,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((function(){i.log({type:r.LogType.LogMetric,tag:i.tag,name:i.name,success:r.SuccessStatus.Timeout,duration:a,diagnosticsData:"Ended with Timeout",source:-1}),i.isTimeout=!0}),a)}var t,n,o;return t=e,(n=[{key:"logMetricEnd",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Successful,duration:n,correlationVector:t,source:-1}))}}},{key:"logMetricEndWithError",value:function(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){var n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogType.LogMetric,tag:this.tag,name:this.name,success:r.SuccessStatus.Failure,duration:n,correlationVector:t,source:-1}))}}},{key:"log",value:function(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.PerfMarker=s},2791:function(e,t,n){"use strict";n.r(t),n.d(t,"DialogHeader",(function(){return C})),n.d(t,"getDialogSubmit",(function(){return O})),n.d(t,"DialogWebContent",(function(){return N})),n.d(t,"openDialog",(function(){return ee})),n.d(t,"WindowAuthenticationService",(function(){return k}));var r=n(3583),o=n(302),i=n(2835),a=n(3372),s=n(3373),l=n(2265),c=n(1814),u=n(3378),d=n(3358),p=n(576),g=n(1),h=n(2870),f=n(1543),m=n(335);const v=Object(h.a)("DialogHeader",Object(f.a)({dialogHeader:Object.assign({display:"flex",flexDirection:"row",justifyContent:"space-between"},m.a.padding("12px","12px","12px","24px")),appNameLarge:{fontWeight:"bold",fontSize:"18px"},appName:{fontWeight:"bold",fontSize:"14px"},title:{fontSize:"12px"},dialogIcon:{minWidth:"24px",minHeight:"24px",maxHeight:"32px",maxWidth:"32px",marginRight:"16px",alignSelf:"center"},dialogIconContainer:{display:"flex",flexDirection:"row"},dialogTitleContainer:{display:"flex",flexDirection:"column"}}));var b=n(142);const y=Object(b.declareString)("m365-ext-dialog.m365chat.closeButton");function C(e){const t=v(),n=Object(r.b)({DialogCloseButtonTitle:y}),h=Object(d.a)(p.l,p.m),{appDefinition:f,dialogActions:m,title:b}=e,C=g.useMemo((()=>({src:f.largeImageUrl,imageFit:o.b.contain})),[f.largeImageUrl]);return g.createElement(a.a,{className:t.dialogHeader},g.createElement(s.a,{action:g.createElement(l.a,{disableButtonEnhancement:!0,action:"close"},g.createElement(c.a,{tabIndex:0,appearance:"transparent","aria-label":n.DialogCloseButtonTitle(),icon:g.createElement(h,null),onClick:()=>m.close()}))},g.createElement("div",{className:t.dialogIconContainer},g.createElement(i.a,{className:t.dialogIcon,imageProps:C}),g.createElement("div",{className:t.dialogTitleContainer},g.createElement(u.a,{className:b?t.appName:t.appNameLarge},f.name),b&&g.createElement(u.a,{className:t.title},b)))))}function O(e,t,n){return r=>{var o,i,a;if(!r)return void t.close();const s={botId:null!==(i=null===(o=n.webApplicationInfo)||void 0===o?void 0:o.id)&&void 0!==i?i:"",appId:null!==(a=n.id)&&void 0!==a?a:"",requestBody:{name:"task/submit",value:{data:r}}};e.botInvoke(s).then((e=>function(e,t){e&&0===Object.keys(e).length&&t.close()}(e,t))).catch((e=>{})),t.close()}}var S,E=n(89),x=n(1445),I=n(2),w=n(1434);class T extends w.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(I.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class k extends T{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class j{constructor(e){this.dialogActions=e,this.urlService=new P(e)}}class P extends w.a{constructor(e){super(),this.dialogActions=e,this.open=e=>{throw new Error("Method not implemented.")},this.submit=(e,t)=>(this.dialogActions.submit(e),Promise.resolve()),this.messageForParent=e=>{throw new Error("Method not implemented.")},this.messageForChild=e=>{throw new Error("Method not implemented.")}}}class A{getLoadingUi(){return g.createElement(g.Fragment,null)}getErrorUi(e){return g.createElement(g.Fragment,null)}}function _(e,t){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:S.Unhandled,params:{url:new URL(e)}};const n=new URL(e);return n.pathname&&"https://teams.microsoft.com"===n.origin?function(e,t){try{if(t===E.d.office){const[t,n,r,o]=e.pathname.split("/");if(""!==t||"m365Apps"!==n)throw new Error("Invalid Teams url format for App");if(!r)throw new Error("Invalid appId");return L(e,r,o)}{const[t,n,r,o,i]=e.pathname.split("/");if(""!==t||"l"!==n||"entity"!==r&&"app"!==r)throw new Error("Invalid Teams url format for App");if(!o)throw new Error("Invalid appId");return L(e,o,i)}}catch(e){return}}(n,t)||function(e){var t,n,r,o,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(r=e.searchParams.get("url"))&&void 0!==r?r:void 0,fallbackUrl:null!==(o=e.searchParams.get("fallbackUrl"))&&void 0!==o?o:void 0,card:null!==(i=JSON.stringify(e.searchParams.get("card")))&&void 0!==i?i:void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:S.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(n)||M(n)||B(n)||D(n):{type:S.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.NavigateToApp="app",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(S||(S={}));const D=e=>({type:S.Unhandled,params:{url:e}});function L(e,t,n){var r;const o=null!==(r=new URLSearchParams(e.search).get("webUrl"))&&void 0!==r?r:void 0;return{type:S.NavigateToApp,params:{appId:t,pageId:null!=n?n:"",webUrl:o}}}const M=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const r=t.searchParams.get("context");let o={};const i=decodeURIComponent(null!=r?r:"");return o=JSON.parse(i),{type:S.StageView,params:{appId:n[1],stageInfo:o}}}catch(e){return}},B=e=>{var t,n;try{const r=/^\/l\/entity\/([^/]+)\/([^/]+)$/,o=e,i=o.pathname.match(r);if(3!==(null==i?void 0:i.length))throw new Error("Invalid Teams url format for Tab");const a=i[1];let s;if(o.searchParams.has("context")){const e=o.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");s=JSON.parse(t)}const l={entityId:i[2],webUrl:null!==(t=o.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=o.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==s?void 0:s.subEntityId};return{type:S.LaunchPage,params:{appId:a,tabInfo:l}}}catch(e){return}};class R{constructor(e,t,n){this.hubName=e,this.actions=t,this.onNavigateToApp=n}openLink(e){var t,n;const r=_(e,this.hubName);return r?((null==r?void 0:r.type)===S.NavigateToApp&&(this.actions.close(),null===(t=this.onNavigateToApp)||void 0===t||t.call(this,null!==(n=r.params.appId)&&void 0!==n?n:"")),Promise.resolve()):Promise.reject()}}class F extends w.a{returnFocus(e){throw new Error("Method not implemented.")}setCurrentFrame(e){throw new Error("Method not implemented.")}navigateToApp(e){throw new Error("Method not implemented.")}shareDeepLink(e){throw new Error("Method not implemented.")}getConfig(){throw new Error("Method not implemented.")}}function N(e){var t;const n={authenticationService:new k((()=>Promise.resolve()),(()=>Promise.resolve()),e.tokenService,e.userContext),hubUiService:new A,linkService:new R(e.hostContext.host.name,e.dialogActions,e.onNavigateToApp),pageService:new F,dialogService:new j(e.dialogActions),logger:{log:function(e,t,n,r){}}},r={user:e.userContext,app:e.hostContext,page:{id:(null===(t=e.appDefinition)||void 0===t?void 0:t.id)||"",frameContext:E.b.content,sourceOrigin:"https://teams.microsoft.com",subPageId:e.subEntityId}};return g.createElement(x.a,{hostWindow:window,hubServices:n,contentUrl:e.content.url,appDefinition:e.appDefinition,context:r})}var H=n(107),U=n(2445),V=n(1627),z=n(3345),G=n(1435),W=n(1439),Q=n(3599),q=n(3371);const K={width:new Map([[-1,"20%"],[-2,"50%"],[-3,"60%"]]),height:new Map([[-1,"20vh"],[-2,"50vh"],[-3,"66vh"]])};function Y(e){var t;return null!==(t=K.height.get(e))&&void 0!==t?t:`${e}px`}var Z=n(139);const J=Object(h.a)("DialogRenderer",Object(f.a)({dialogContainer:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({width:"60%",height:"80%",maxWidth:"80%",maxHeight:"80%",minWidth:"20%",minHeight:"20%"},m.a.padding("0px")),m.a.borderRadius(Z.a.borderRadiusMedium)),m.a.border("none")),m.a.outline("3px","solid",Z.a.colorTransparentBackground)),{display:"block"}),dialogBody:Object.assign(Object.assign({alignItems:"left",colorScheme:"none",width:"100%",height:"90%",maxHeight:"85%",display:"flex",flexDirection:"column"},m.a.padding("0px","12px","0px","12px")),{"&::-webkit-scrollbar-button:horizontal:start:increment":{},"&::-webkit-scrollbar-button:horizontal:end:decrement":{},"&::-webkit-scrollbar-button:vertical:start:increment":{},"&::-webkit-scrollbar-button:vertical:end:decrement":{display:"none"},"&::-webkit-scrollbar-button:start:increment":{},"&::-webkit-scrollbar-button:start:decrement":{display:"none"}})}));function X(e){const{contentView:t,headerView:n,dialogSize:r,isOpen:o}=e,i=J();let s={};var l,c;return r&&(s={width:(l=r.width,null!==(c=K.width.get(l))&&void 0!==c?c:`${l}px`),height:Y(r.height)}),t?g.createElement(Q.a,{open:o},g.createElement(q.a,{className:i.dialogContainer,style:s},n,g.createElement(a.a,{className:i.dialogBody},t))):null}function $(e){const{dialogContent:t,botService:n,appDefinition:r,tokenService:o,userContext:i,hostContext:a,subEntityId:s,onNavigateToApp:l}=e,[c,u]=g.useState(t);g.useMemo((()=>{u(t)}),[t]);const d=g.useMemo((()=>{const e={close:()=>u(void 0),update:u};return n?Object.assign({submit:O(n,e,r)},e):Object.assign({},e)}),[n]);if(!c)return null;const p=function(e,t,n,r,o,i,a,s){var l,c;const u=Object(G.a)(Object.assign(Object.assign({},n),{version:null!==(l=n.version)&&void 0!==l?l:"",appId:n.id,manifestVersion:null!==(c=n.manifestVersion)&&void 0!==c?c:""}));switch(e.type){case W.a.Card:return null;case W.a.Url:return g.createElement(N,{dialogActions:t,content:e,appDefinition:u,hostContext:o,tokenService:r,userContext:i,subEntityId:a,onNavigateToApp:s})}}(c,d,r,o,a,i,s,l),h=g.createElement(C,{appDefinition:r,dialogActions:d,title:c.title}),f=a.theme==E.e.dark?U.a:V.a;return g.createElement(z.a,{theme:f},g.createElement(X,{contentView:p,appDefinition:r,headerView:h,dialogSize:t,isOpen:!0}))}function ee(e,t,n,r,o,i,a,s,l){H.render(g.createElement($,{dialogContent:e,botService:n,appDefinition:r,hostContext:a,tokenService:o,userContext:i,subEntityId:s,onNavigateToApp:l}),t)}},2792:function(e,t,n){"use strict";n.r(t),n.d(t,"DialogHeader",(function(){return p})),n.d(t,"getDialogSubmit",(function(){return g})),n.d(t,"DialogWebContent",(function(){return j})),n.d(t,"openDialog",(function(){return H})),n.d(t,"WindowAuthenticationService",(function(){return C}));var r=n(302),o=n(3579),i=n(2835),a=n(798),s=n(1),l=n(3612),c=n(1543);const u=Object(l.a)("DialogHeader",Object(c.a)({dialogHeader:{display:"flex",flexDirection:"row",marginBottom:"6px",paddingTop:"24px",paddingRight:"24px",paddingBottom:"0px",paddingLeft:"32px",width:"auto"},appNameLarge:{fontWeight:"bold",fontSize:"18px"},appName:{fontWeight:"bold",fontSize:"14px"},title:{fontSize:"12px"},dialogIcon:{minWidth:"24px",minHeight:"24px",maxHeight:"32px",maxWidth:"32px",marginRight:"16px"},cancelIcon:{marginLeft:"auto"}})),d="Close";function p(e){const t=u(),{appDefinition:n,dialogActions:l,title:c}=e,p=s.useMemo((()=>({src:n.largeImageUrl,imageFit:r.b.contain})),[n.largeImageUrl]);return s.createElement(o.a.Item,{className:t.dialogHeader},s.createElement(i.a,{className:t.dialogIcon,imageProps:p}),s.createElement(o.a,{verticalAlign:"center"},s.createElement(o.a.Item,{className:c?t.appName:t.appNameLarge},n.name),c?s.createElement(o.a.Item,{className:t.title},c):null),s.createElement(a.a,{title:d,"aria-label":d,onClick:l.close,iconName:"Cancel",className:t.cancelIcon}))}function g(e,t,n){return r=>{var o,i,a;if(!r)return void t.close();const s={botId:null!==(i=null===(o=n.webApplicationInfo)||void 0===o?void 0:o.id)&&void 0!==i?i:"",appId:null!==(a=n.id)&&void 0!==a?a:"",requestBody:{name:"task/submit",value:{data:r}}};e.botInvoke(s).then((e=>function(e,t){e&&0===Object.keys(e).length&&t.close()}(e,t))).catch((e=>{})),t.close()}}var h,f=n(138),m=n(975),v=n(2),b=n(951);class y extends b.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(v.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class C extends y{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class O extends b.a{constructor(e){super(),this.dialogActions=e}open(e){throw new Error("Method not implemented.")}submit(e,t){return this.dialogActions.submit(e),Promise.resolve()}messageForParent(e){throw new Error("Method not implemented.")}messageForChild(e){throw new Error("Method not implemented.")}}class S{getLoadingUi(){return s.createElement(s.Fragment,null)}getErrorUi(e){return s.createElement(s.Fragment,null)}}function E(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:h.Unhandled,params:{url:new URL(e)}};const t=new URL(e);return t.pathname&&"https://teams.microsoft.com"===t.origin?function(e){var t;try{const[n,r,o,i]=e.pathname.split("/");if(""!==n||"m365Apps"!==r)throw new Error("Invalid Teams url format for App");if(!o)throw new Error("Invalid appId");const a=null!==(t=new URLSearchParams(e.search).get("webUrl"))&&void 0!==t?t:void 0;return{type:h.NavigateToApp,params:{appId:o,pageId:null!=i?i:"",webUrl:a}}}catch(e){return}}(t)||function(e){var t,n,r,o,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(r=e.searchParams.get("url"))&&void 0!==r?r:void 0,fallbackUrl:null!==(o=e.searchParams.get("fallbackUrl"))&&void 0!==o?o:void 0,card:null!==(i=JSON.stringify(e.searchParams.get("card")))&&void 0!==i?i:void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:h.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(t)||I(t)||w(t)||x(t):{type:h.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.NavigateToApp="app",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(h||(h={}));const x=e=>({type:h.Unhandled,params:{url:e}});const I=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const r=t.searchParams.get("context");let o={};const i=decodeURIComponent(null!=r?r:"");return o=JSON.parse(i),{type:h.StageView,params:{appId:n[1],stageInfo:o}}}catch(e){return}},w=e=>{var t,n;try{const r=/^\/l\/entity\/([^/]+)\/([^/]+)$/,o=e,i=o.pathname.match(r);if(3!==(null==i?void 0:i.length))throw new Error("Invalid Teams url format for Tab");const a=i[1];let s;if(o.searchParams.has("context")){const e=o.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");s=JSON.parse(t)}const l={entityId:i[2],webUrl:null!==(t=o.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=o.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==s?void 0:s.subEntityId};return{type:h.LaunchPage,params:{appId:a,tabInfo:l}}}catch(e){return}};class T{constructor(e,t){this.actions=e,this.onNavigateToApp=t}openLink(e){var t,n;const r=E(e);return r?((null==r?void 0:r.type)===h.NavigateToApp&&(this.actions.close(),null===(t=this.onNavigateToApp)||void 0===t||t.call(this,null!==(n=r.params.appId)&&void 0!==n?n:"")),Promise.resolve()):Promise.reject()}}class k extends b.a{returnFocus(e){throw new Error("Method not implemented.")}setCurrentFrame(e){throw new Error("Method not implemented.")}navigateToApp(e){throw new Error("Method not implemented.")}shareDeepLink(e){throw new Error("Method not implemented.")}getConfig(){throw new Error("Method not implemented.")}}function j(e){var t;const n={authenticationService:new C((()=>Promise.resolve()),(()=>Promise.resolve()),e.tokenService,e.userContext),hubUiService:new S,linkService:new T(e.dialogActions,e.onNavigateToApp),pageService:new k,dialogService:new O(e.dialogActions)},r={user:e.userContext,app:e.hostContext,page:{id:(null===(t=e.appDefinition)||void 0===t?void 0:t.id)||"",frameContext:f.a.content,sourceOrigin:"https://teams.microsoft.com",subPageId:e.subEntityId}};return s.createElement(m.a,{hostWindow:window,hubServices:n,contentUrl:e.content.url,appDefinition:e.appDefinition,context:r})}var P=n(107),A=n(2150),_=n(952),D=n(954),L=n(3355);const M={width:new Map([[-1,"20%"],[-2,"50%"],[-3,"60%"]]),height:new Map([[-1,"20vh"],[-2,"50vh"],[-3,"66vh"]])};function B(e){var t;return null!==(t=M.height.get(e))&&void 0!==t?t:`${e}px`}const R=Object(l.a)("DialogRenderer",Object(c.a)({main:{width:"auto",height:"auto",maxWidth:"90%",maxHeight:"90%",minWidth:"20%",minHeight:"20%"},modal:{height:"100%",width:"100%",overflowY:"hidden"},dialogContainer:{height:"100%"},dialogBody:{height:"100%",alignItems:"center",display:"flex",flexDirection:"column",overflowY:"auto",paddingTop:"0",paddingRight:"16px",paddingBottom:"16px",paddingLeft:"16px","&::-webkit-scrollbar-button:horizontal:start:increment":{},"&::-webkit-scrollbar-button:horizontal:end:decrement":{},"&::-webkit-scrollbar-button:vertical:start:increment":{},"&::-webkit-scrollbar-button:vertical:end:decrement":{display:"none"},"&::-webkit-scrollbar-button:start:increment":{},"&::-webkit-scrollbar-button:start:decrement":{display:"none"}}}));function F(e){const{dialogActions:t,contentView:n,headerView:r,dialogSize:i}=e,a=R();let l;var c,u;return i&&(l=Object.assign(Object.assign({},a),{main:{width:(c=i.width,null!==(u=M.width.get(c))&&void 0!==u?u:`${c}px`),height:B(i.height)}})),n?s.createElement(L.a,{styles:null!=l?l:a,scrollableContentClassName:a.modal,onDismiss:t.close,isOpen:!0},s.createElement(o.a,{className:a.dialogContainer},r,s.createElement(o.a.Item,{className:a.dialogBody},n))):null}function N(e){const{dialogContent:t,botService:n,appDefinition:r,tokenService:o,userContext:i,hostContext:a,subEntityId:l,onNavigateToApp:c}=e,[u,d]=s.useState(t);s.useMemo((()=>{d(t)}),[t]);const h=s.useMemo((()=>{const e={close:()=>d(void 0),update:d};return n?Object.assign({submit:g(n,e,r)},e):Object.assign({},e)}),[n]);if(!u)return null;const f=function(e,t,n,r,o,i,a,l){var c;const u=Object(_.a)(Object.assign(Object.assign({},n),{version:null!==(c=n.version)&&void 0!==c?c:"",appId:n.id}));switch(e.type){case D.a.Card:return null;case D.a.Url:return s.createElement(j,{dialogActions:t,content:e,appDefinition:u,hostContext:o,tokenService:r,userContext:i,subEntityId:a,onNavigateToApp:l})}}(u,h,r,o,a,i,l,c),m=s.createElement(p,{appDefinition:r,dialogActions:h,title:u.title});return s.createElement(F,{contentView:f,dialogActions:h,appDefinition:r,headerView:m,dialogSize:t})}function H(e,t,n,r,o,i,a,l,c){P.render(s.createElement(N,{dialogContent:e,botService:n,appDefinition:r,hostContext:a,tokenService:o,userContext:i,subEntityId:l,onNavigateToApp:c}),t)}Object(A.a)()},2795:function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var r,o=n(2),i=n(3349),a=n(3351),s=n(3352),l=n(3354),c=n(3347),u=n(2841),d=n(1),p=n.n(d);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(r||(r={}));var g=r.web;function h(){return g===r.IOS}var f,m,v;!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(f||(f={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(m||(m={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(v||(v={}));var b=n(1543),y=n(65),C=Object(b.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),O=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(y.a)(o,t)),n?o=r?Object(y.a)(o,e.horizontalReverse):Object(y.a)(o,e.horizontal):r&&(o=Object(y.a)(o,e.verticalReverse)),o}(C(),n,i,s);return d.createElement("div",Object(o.__assign)({className:c},l),t)},S=n(2823),E=n(3348),x=n(335),I=n(1596),w=function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}};function T(e){var t=w(e);return Object(b.a)(t)}var k=T({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),j=Object(S.a)(I.a),P=T({tooltipText:Object(o.__assign)(Object(o.__assign)({},E.a.caption1),{color:j.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(o.__assign)(Object(o.__assign)({},E.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},x.a.padding("12px")),x.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),A=function(){var e=P(),t=k();if(g===r.IOS)_(e,t);return e},_=function(e,t){if(t)for(var n in e)e[n]=Object(y.a)(e[n],t[n])},D=function(e){switch(void 0===e&&(e=v.NonEncryption),e){case v.Encryption:return h()?p.a.createElement(c.q,null):p.a.createElement(c.o,null);case v.Warning:return h()?p.a.createElement(u.e,null):p.a.createElement(u.c,null);case v.NonEncryption:default:return h()?p.a.createElement(c.m,null):p.a.createElement(c.k,null)}},L=function(e,t){switch(void 0===e&&(e=v.NonEncryption),e){case v.Encryption:return h()?p.a.createElement(c.p,{primaryFill:t}):p.a.createElement(c.n,{primaryFill:t});case v.Warning:return h()?p.a.createElement(u.d,{primaryFill:t}):p.a.createElement(u.b,{primaryFill:t});case v.NonEncryption:default:return h()?p.a.createElement(c.l,{primaryFill:t}):p.a.createElement(c.j,{primaryFill:t})}},M=function(e){var t,n,r=e.styles,o=e.clpSensitivityIndicatorData,c=A();return _(c,r),p.a.createElement(i.a,{openOnHover:!0},p.a.createElement(a.a,null,p.a.createElement("span",{className:c.icon},o.icon?p.a.createElement(o.icon,null):(t=o.iconType,n=o.color,void 0===t&&(t=v.NonEncryption),n?L(t,n):D(t)))),p.a.createElement(s.a,{className:c.tooltipStack},p.a.createElement(O,null,o.badgeText&&p.a.createElement(l.a,{className:c.badgeText},o.badgeText),p.a.createElement(l.a,{className:c.tooltipText},o.tooltipText))))},B=n(3343),R=n(2421),F=n(1618),N=n(3345),H=n(3344),U=n(841),V=n(1627),z=n(2445),G=Object(U.a)({palette:Object(o.__assign)(Object(o.__assign)({},V.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),W=(Object(U.a)({palette:Object(o.__assign)(Object(o.__assign)({},z.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(e){var t=e.themePalette,n=e.isDarkMode,r=e.children,i=e.className,a=Object(o.__assign)(Object(o.__assign)({},G.palette),t),s=Object(H.a)(a),l=n?Object(R.a)(s):Object(F.a)(s);return d.createElement(N.a,{className:i,theme:l},r)}),Q=n(139),q=Object(b.a)({ciqInputText:{color:Q.a.colorBrandForeground1}}),K=p.a.forwardRef((function(e,t){var n=e.text,r=e.id,i=e.copilotChatTheme,a=e.isDarkModeEnabled,s=Object(o.__read)(Object(d.useState)(e.isLoading),2),l=s[0],c=s[1],u=Object(o.__read)(Object(d.useState)(e.clpSensitivityIndicatorData),2),g=u[0],h=u[1],f=q();return Object(d.useImperativeHandle)(t,(function(){return{setLoading:function(e){c(e)},setSensitivity:function(e){h(e)}}})),p.a.createElement("span",{contentEditable:!1,className:"user-ciq-selection-id",id:r,style:{display:"inline"}},p.a.createElement("span",{className:f.ciqInputText},n),p.a.createElement("span",{style:{display:"inline-block",verticalAlign:"text-bottom"}},l?p.a.createElement(B.a,{size:"extra-tiny"}):p.a.createElement(W,{themePalette:i,isDarkMode:a},g&&p.a.createElement(M,{clpSensitivityIndicatorData:g}))))}))},28:function(e,t,n){"use strict";n.d(t,"f",(function(){return A})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"r",(function(){return i})),n.d(t,"m",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"s",(function(){return c})),n.d(t,"w",(function(){return u})),n.d(t,"x",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"t",(function(){return g})),n.d(t,"v",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"C",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return C})),n.d(t,"g",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return E})),n.d(t,"o",(function(){return x})),n.d(t,"B",(function(){return I})),n.d(t,"A",(function(){return w})),n.d(t,"z",(function(){return T})),n.d(t,"y",(function(){return k})),n.d(t,"j",(function(){return j})),n.d(t,"u",(function(){return P}));var r,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();!function(e){e.Default="default",e.Positive="positive",e.Destructive="destructive"}(r||(r={})),function(e){e.Primary="primary",e.Secondary="secondary"}(o||(o={})),function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(i||(i={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(a||(a={})),function(e){e[e.xxSmall=0]="xxSmall",e[e.xSmall=1]="xSmall",e[e.Small=2]="Small",e[e.Standard=3]="Standard",e[e.Medium=4]="Medium",e[e.Large=5]="Large",e[e.xLarge=6]="xLarge",e[e.xxLarge=7]="xxLarge"}(s||(s={})),function(e){e[e.Regular=0]="Regular",e[e.Filled=1]="Filled"}(l||(l={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(c||(c={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(u||(u={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(d||(d={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(p||(p={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(g||(g={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(h||(h={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(f||(f={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(m||(m={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(v||(v={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person",e[e.RoundedCorners=2]="RoundedCorners"}(b||(b={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(y||(y={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(C||(C={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(O||(O={})),function(e){e[e.Normal=0]="Normal",e[e.Expanded=1]="Expanded",e[e.Subdued=2]="Subdued"}(S||(S={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(E||(E={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(x||(x={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(I||(I={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other",e[e.UnknownProperty=18]="UnknownProperty"}(w||(w={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(T||(T={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(k||(k={})),function(e){e[e.VeryNarrow=0]="VeryNarrow",e[e.Narrow=1]="Narrow",e[e.Standard=2]="Standard",e[e.Wide=3]="Wide"}(j||(j={})),function(e){e[e.AtLeast=0]="AtLeast",e[e.AtMost=1]="AtMost"}(P||(P={}))},2808:function(e,t,n){"use strict";n.r(t),n.d(t,"copyMarkdownTextToClipboard",(function(){return i})),n.d(t,"copyTextToClipboard",(function(){return o})),n.d(t,"CopyState",(function(){return r})),n.d(t,"useClipboardState",(function(){return d}));var r,o=function(e,t,n){return Promise.reject(!1)},i=function(e,t,n){return Promise.reject(!1)},a=n(2),s=n(1),l=n(991),c="MidgardClipboardUtilsHiddenInput",u=function(e,t,n){var r=t.activeElement,o=t.createElement("textarea");o.tabIndex=-1,o.readOnly=!0,o.style.opacity="0",o.style.position="fixed",o.style.right="-9999px",o.style.bottom="-9999px",o.id=c;var i=t.createElement("div");i.onselectstart=function(e){return e.stopPropagation()},i.appendChild(o);var a,s=n||t.body;s.appendChild(i),o.value=e,o.focus(),o.select();try{t.execCommand("copy"),a=!0}catch(e){a=!1}return r&&r.focus&&r.focus(),s.removeChild(i),Promise.resolve(a)};!function(e){e[e.Default=0]="Default",e[e.Success=1]="Success",e[e.Error=2]="Error"}(r||(r={}));var d=function(e){var t=Object(a.__read)(s.useState(r.Default),2),n=t[0],o=t[1];return{copyState:n,copyText:function(t){var n;null===(n=e.onCopy)||void 0===n||n.call(e),function(e,t,n){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var r,o,i,s,c,d,p;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(r=t||document,o=new l.Converter,i=o.makeHtml(e),s=new Blob([i],{type:"text/html"}),c=new Blob([e],{type:"text/plain"}),!navigator.clipboard)return[3,7];a.label=1;case 1:return a.trys.push([1,6,,7]),"undefined"==typeof ClipboardItem?[3,3]:(d=[new ClipboardItem((p={},p["text/plain"]=c,p["text/html"]=s,p))],[4,navigator.clipboard.write(d)]);case 2:return a.sent(),[3,5];case 3:return[4,navigator.clipboard.writeText(e)];case 4:a.sent(),a.label=5;case 5:return[2,!0];case 6:return a.sent(),[2,u(e,r,n)];case 7:return[2,u(e,r,n)]}}))}))}((null==t?void 0:t.replace(/\[(.+)\]\(quote:\/\/.+\)/gi,"$1"))||"",document).then((function(e){o(e?r.Success:r.Error),setTimeout((function(){o(r.Default)}),1500)})).catch((function(e){return console.error(e)}))}}}},2810:function(e,t,n){"use strict";n.r(t),n.d(t,"copyMarkdownTextToClipboard",(function(){return l})),n.d(t,"copyTextToClipboard",(function(){return s})),n.d(t,"CopyState",(function(){return r})),n.d(t,"useClipboardState",(function(){return d}));var r,o=n(2),i=n(991),a="MidgardClipboardUtilsHiddenInput",s=function(e,t,n){var r=t||document;return navigator.clipboard?navigator.clipboard.writeText(e).then((function(){return!0})).catch((function(){return c(e,r,n)})):c(e,r,n)},l=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var r,a,s,l,u,d,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(r=t||document,a=new i.Converter({tables:!0}),s=a.makeHtml(e),l=new Blob([s],{type:"text/html"}),u=new Blob([e],{type:"text/plain"}),!navigator.clipboard)return[3,7];o.label=1;case 1:return o.trys.push([1,6,,7]),"undefined"==typeof ClipboardItem?[3,3]:(d=[new ClipboardItem((p={},p["text/plain"]=u,p["text/html"]=l,p))],[4,navigator.clipboard.write(d)]);case 2:return o.sent(),[3,5];case 3:return[4,navigator.clipboard.writeText(e)];case 4:o.sent(),o.label=5;case 5:return[2,!0];case 6:return o.sent(),[2,c(e,r,n)];case 7:return[2,c(e,r,n)]}}))}))},c=function(e,t,n){var r=t.activeElement,o=t.createElement("textarea");o.tabIndex=-1,o.readOnly=!0,o.style.opacity="0",o.style.position="fixed",o.style.right="-9999px",o.style.bottom="-9999px",o.id=a;var i=t.createElement("div");i.onselectstart=function(e){return e.stopPropagation()},i.appendChild(o);var s,l=n||t.body;l.appendChild(i),o.value=e,o.focus(),o.select();try{t.execCommand("copy"),s=!0}catch(e){s=!1}return r&&r.focus&&r.focus(),l.removeChild(i),Promise.resolve(s)},u=n(1);!function(e){e[e.Default=0]="Default",e[e.Success=1]="Success",e[e.Error=2]="Error"}(r||(r={}));var d=function(e){var t=Object(o.__read)(u.useState(r.Default),2),n=t[0],i=t[1];return{copyState:n,copyText:function(t){var n;null===(n=e.onCopy)||void 0===n||n.call(e);var o=null==t?void 0:t.replace(/\[(.+)\]\(quote:\/\/.+\)/gi,"$1");l(o||"",document).then((function(e){i(e?r.Success:r.Error),setTimeout((function(){i(r.Default)}),1500)})).catch((function(e){return console.error(e)}))},copyHtmlLinkAndText:function(t,n){var a;null===(a=e.onCopy)||void 0===a||a.call(e);var s=null==t?void 0:t.replace(/\[(.+)\]\(quote:\/\/.+\)/gi,"$1"),l=function(e,t){return'<a href="'.concat(e,'">').concat(t,"</a>")}(s||"",n);(function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(i=n||document,a=new Blob([t],{type:"text/html"}),s=new Blob([e],{type:"text/plain"}),!navigator.clipboard)return[3,7];o.label=1;case 1:return o.trys.push([1,6,,7]),"undefined"==typeof ClipboardItem?[3,3]:(l=[new ClipboardItem((u={},u["text/plain"]=s,u["text/html"]=a,u))],[4,navigator.clipboard.write(l)]);case 2:return o.sent(),[3,5];case 3:return[4,navigator.clipboard.writeText(e)];case 4:o.sent(),o.label=5;case 5:return[2,!0];case 6:return o.sent(),[2,c(e,i,r)];case 7:return[2,c(e,i,r)]}}))}))})(s||"",l,document).then((function(e){i(e?r.Success:r.Error),setTimeout((function(){i(r.Default)}),1500)})).catch((function(e){return console.error(e)}))}}}},2811:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y;n.r(t),n.d(t,"AppStatus",(function(){return s})),n.d(t,"CardActionabilityStatus",(function(){return u})),n.d(t,"CardOptions",(function(){return a})),n.d(t,"CardRefreshMode",(function(){return i})),n.d(t,"LogType",(function(){return o})),n.d(t,"MsgExtCardVerificationStatus",(function(){return r})),n.d(t,"RenderingMode",(function(){return l})),n.d(t,"ResultTypes",(function(){return d})),n.d(t,"ThemeMode",(function(){return c})),n.d(t,"TypeOfAuthFlow",(function(){return p})),n.d(t,"CustomTelemetryMessages",(function(){return g})),n.d(t,"PerfName",(function(){return v})),n.d(t,"PerfTag",(function(){return f})),n.d(t,"SuccessStatus",(function(){return b})),n.d(t,"TelemetryName",(function(){return m})),n.d(t,"TelemetryPropType",(function(){return y})),n.d(t,"TelemetryTag",(function(){return h})),function(e){e.Unknown="Unknown",e.Success="Success",e.Partial="Partial",e.Failed="Failed",e.Error="Error"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(i||(i={})),function(e){e.DeleteCard="DeleteCard",e.CopyCard="CopyCard",e.ManualRefresh="ManualRefresh",e.GetApp="GetApp",e.CardCopied="CardCopied"}(a||(a={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.NeedsConsentForUpgrade=3]="NeedsConsentForUpgrade"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MailEditor=1]="MailEditor",e[e.MailReadingPane=2]="MailReadingPane",e[e.MailEditorReplyForward=3]="MailEditorReplyForward",e[e.MailReadingPaneFromExProp=4]="MailReadingPaneFromExProp"}(l||(l={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(c||(c={})),function(e){e[e.Full=0]="Full",e[e.Limited=1]="Limited",e[e.None=2]="None",e[e.Unknown=3]="Unknown"}(u||(u={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth"}(p||(p={})),function(e){e[e.None=0]="None",e[e.SendBotRequestFailed=1]="SendBotRequestFailed",e[e.UrlHandeledAsDeepLink=2]="UrlHandeledAsDeepLink",e[e.UrlNotOpenedForCard=3]="UrlNotOpenedForCard",e[e.UrlOpenedForCard=4]="UrlOpenedForCard",e[e.UnableToGetAppInfo=5]="UnableToGetAppInfo",e[e.CardContentIsNull=6]="CardContentIsNull",e[e.ActionTypeIsNotSupported=7]="ActionTypeIsNotSupported",e[e.CardActionabilityBlocked=8]="CardActionabilityBlocked",e[e.NoActionPerformed=9]="NoActionPerformed",e[e.CardIdOrRenderingModeUndefined=10]="CardIdOrRenderingModeUndefined",e[e.AuthOnExecuteActionFailed=11]="AuthOnExecuteActionFailed"}(g||(g={})),function(e){e[e.MsgExtExecuteActionV2=1]="MsgExtExecuteActionV2",e[e.ExecuteAction=2]="ExecuteAction",e[e.MsgExtOpenUrlActionV2=3]="MsgExtOpenUrlActionV2",e[e.MsgExtShowCardActionV2=4]="MsgExtShowCardActionV2",e[e.MsgExtSSOTokenNeeded=5]="MsgExtSSOTokenNeeded",e[e.MsgExtSubmitAction=6]="MsgExtSubmitAction",e[e.MsgExtToggleVisibilityActionV2=7]="MsgExtToggleVisibilityActionV2",e[e.UpdateAppInfoOrchestrator=8]="UpdateAppInfoOrchestrator",e[e.GetAppFromAppId=9]="GetAppFromAppId",e[e.HydrateCard=10]="HydrateCard",e[e.ThumbnailCardRenderer=11]="ThumbnailCardRenderer",e[e.CardVerificationUtils=12]="CardVerificationUtils",e[e.AdaptiveCardRenderer=13]="AdaptiveCardRenderer",e[e.CardActions=14]="CardActions",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.O365ConnectorCardRenderer=16]="O365ConnectorCardRenderer",e[e.O365ConnectorCardUtils=17]="O365ConnectorCardUtils",e[e.MsgExtSerializationContext=18]="MsgExtSerializationContext",e[e.MsgExtCardRenderer=19]="MsgExtCardRenderer"}(h||(h={})),function(e){e[e.Commands=1]="Commands",e[e.CardActionability=2]="CardActionability",e[e.CardRender=3]="CardRender",e[e.GetCardForLink=4]="GetCardForLink"}(f||(f={})),function(e){e[e.Execute=1]="Execute",e[e.ExecuteActionOpenUrl=2]="ExecuteActionOpenUrl",e[e.MsgExtExecuteActionV2=3]="MsgExtExecuteActionV2",e[e.MsgExtOpenUrlActionV2=4]="MsgExtOpenUrlActionV2",e[e.GetAppForAppId=5]="GetAppForAppId",e[e.UpdateAppInfoOrchestrator=6]="UpdateAppInfoOrchestrator",e[e.PreProcessingRequest=7]="PreProcessingRequest",e[e.GetMsgExtOnSSOTokenNeeded=8]="GetMsgExtOnSSOTokenNeeded",e[e.OnSSOTokenFetch=9]="OnSSOTokenFetch",e[e.ThumbnailCardRenderer=10]="ThumbnailCardRenderer",e[e.VerifyCard=11]="VerifyCard",e[e.TransformO365Action=12]="TransformO365Action",e[e.HydrateCard=13]="HydrateCard",e[e.O365ConnectorCardRenderer=14]="O365ConnectorCardRenderer",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.CardActionStubbed=16]="CardActionStubbed",e[e.CardActions=17]="CardActions",e[e.HandleTapAction=18]="HandleTapAction",e[e.ExecuteAction=19]="ExecuteAction",e[e.parseAction=20]="parseAction",e[e.MsgExtCardRendererBizApp=21]="MsgExtCardRendererBizApp"}(m||(m={})),function(e){e[e.SendBotRequest=1]="SendBotRequest",e[e.AppHeaderProcessing=2]="AppHeaderProcessing",e[e.MsgExtBaseCommand=3]="MsgExtBaseCommand",e[e.HydrateCard=4]="HydrateCard",e[e.UnfurlLink=5]="UnfurlLink",e[e.VerifyCard=6]="VerifyCard",e[e.GetApp=7]="GetApp",e[e.ExecuteAction=8]="ExecuteAction",e[e.SubmitAction=9]="SubmitAction",e[e.ShowCardAction=10]="ShowCardAction",e[e.ToggleVisibilityAction=11]="ToggleVisibilityAction",e[e.OpenUrlAction=12]="OpenUrlAction",e[e.AuthOnExecuteAction=13]="AuthOnExecuteAction"}(v||(v={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(b||(b={})),function(e){e.RenderingMode="RenderingMode",e.CardActionabilityStatus="CardActionabilityStatus",e.Trigger="Trigger",e.ActionType="ActionType",e.MessageType="MessageType",e.SourceType="SourceType",e.SilentAuthScenario="SilentAuthScenario",e.LinkUnfurlingErrorScenario="LinkUnfurlingErrorScenario",e.ResultType="ResultType",e.TypeOfCard="TypeOfCard",e.CardVerificationStatus="CardVerificationStatus",e.HttpStatus="HttpStatus",e.HasBotId="HasBotId",e.ModalTypes="ModalTypes",e.HasTaskURL="HasTaskURL",e.HasTaskCard="HasTaskCard",e.StageViewOrTaskModuleResult="StageViewOrTaskModuleResult",e.CardRendered="CardRendered",e.TypeOfAuthFlow="TypeOfAuthFlow"}(y||(y={}))},2812:function(e,t,n){"use strict";n.r(t),n.d(t,"copyMarkdownTextToClipboard",(function(){return l})),n.d(t,"copyTextToClipboard",(function(){return s})),n.d(t,"CopyState",(function(){return r})),n.d(t,"useClipboardState",(function(){return d}));var r,o=n(2),i=n(991),a="MidgardClipboardUtilsHiddenInput",s=function(e,t,n){var r=t||document;return navigator.clipboard?navigator.clipboard.writeText(e).then((function(){return!0})).catch((function(){return c(e,r,n)})):c(e,r,n)},l=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var r,a,s,l,u,d,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(r=t||document,a=new i.Converter({tables:!0}),s=a.makeHtml(e),l=new Blob([s],{type:"text/html"}),u=new Blob([e],{type:"text/plain"}),!navigator.clipboard)return[3,7];o.label=1;case 1:return o.trys.push([1,6,,7]),"undefined"==typeof ClipboardItem?[3,3]:(d=[new ClipboardItem((p={},p["text/plain"]=u,p["text/html"]=l,p))],[4,navigator.clipboard.write(d)]);case 2:return o.sent(),[3,5];case 3:return[4,navigator.clipboard.writeText(e)];case 4:o.sent(),o.label=5;case 5:return[2,!0];case 6:return o.sent(),[2,c(e,r,n)];case 7:return[2,c(e,r,n)]}}))}))},c=function(e,t,n){var r=t.activeElement,o=t.createElement("textarea");o.tabIndex=-1,o.readOnly=!0,o.style.opacity="0",o.style.position="fixed",o.style.right="-9999px",o.style.bottom="-9999px",o.id=a;var i=t.createElement("div");i.onselectstart=function(e){return e.stopPropagation()},i.appendChild(o);var s,l=n||t.body;l.appendChild(i),o.value=e,o.focus(),o.select();try{t.execCommand("copy"),s=!0}catch(e){s=!1}return r&&r.focus&&r.focus(),l.removeChild(i),Promise.resolve(s)},u=n(1);!function(e){e[e.Default=0]="Default",e[e.Success=1]="Success",e[e.Error=2]="Error"}(r||(r={}));var d=function(e){var t=Object(o.__read)(u.useState(r.Default),2),n=t[0],i=t[1];return{copyState:n,copyText:function(t){var n;null===(n=e.onCopy)||void 0===n||n.call(e);var o=null==t?void 0:t.replace(/\[(.+)\]\(quote:\/\/.+\)/gi,"$1");l(o||"",document).then((function(e){i(e?r.Success:r.Error),setTimeout((function(){i(r.Default)}),1500)})).catch((function(e){return console.error(e)}))},copyHtmlLinkAndText:function(t){var n;null===(n=e.onCopy)||void 0===n||n.call(e);var a=null==t?void 0:t.replace(/\[(.+)\]\(quote:\/\/.+\)/gi,"$1");(function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(i=n||document,a=new Blob([t],{type:"text/html"}),s=new Blob([e],{type:"text/plain"}),!navigator.clipboard)return[3,7];o.label=1;case 1:return o.trys.push([1,6,,7]),"undefined"==typeof ClipboardItem?[3,3]:(l=[new ClipboardItem((u={},u["text/plain"]=s,u["text/html"]=a,u))],[4,navigator.clipboard.write(l)]);case 2:return o.sent(),[3,5];case 3:return[4,navigator.clipboard.writeText(e)];case 4:o.sent(),o.label=5;case 5:return[2,!0];case 6:return o.sent(),[2,c(e,i,r)];case 7:return[2,c(e,i,r)]}}))}))})(a||"",'<a href="'.concat(a||"",'">Check out this prompt I made in Copilot!</a>'),document).then((function(e){i(e?r.Success:r.Error),setTimeout((function(){i(r.Default)}),1500)})).catch((function(e){return console.error(e)}))}}}},2813:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y;n.r(t),n.d(t,"AppStatus",(function(){return s})),n.d(t,"CardActionabilityStatus",(function(){return u})),n.d(t,"CardOptions",(function(){return a})),n.d(t,"CardRefreshMode",(function(){return i})),n.d(t,"LogType",(function(){return o})),n.d(t,"MsgExtCardVerificationStatus",(function(){return r})),n.d(t,"RenderingMode",(function(){return l})),n.d(t,"ResultTypes",(function(){return d})),n.d(t,"ThemeMode",(function(){return c})),n.d(t,"TypeOfAuthFlow",(function(){return p})),n.d(t,"CustomTelemetryMessages",(function(){return g})),n.d(t,"PerfName",(function(){return v})),n.d(t,"PerfTag",(function(){return f})),n.d(t,"SuccessStatus",(function(){return b})),n.d(t,"TelemetryName",(function(){return m})),n.d(t,"TelemetryPropType",(function(){return y})),n.d(t,"TelemetryTag",(function(){return h})),function(e){e.Unknown="Unknown",e.Success="Success",e.Partial="Partial",e.Failed="Failed",e.Error="Error"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(i||(i={})),function(e){e.DeleteCard="DeleteCard",e.CopyCard="CopyCard",e.ManualRefresh="ManualRefresh",e.GetApp="GetApp",e.CardCopied="CardCopied"}(a||(a={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.NeedsConsentForUpgrade=3]="NeedsConsentForUpgrade"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MailEditor=1]="MailEditor",e[e.MailReadingPane=2]="MailReadingPane",e[e.MailEditorReplyForward=3]="MailEditorReplyForward",e[e.MailReadingPaneFromExProp=4]="MailReadingPaneFromExProp"}(l||(l={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(c||(c={})),function(e){e[e.Full=0]="Full",e[e.Limited=1]="Limited",e[e.None=2]="None",e[e.Unknown=3]="Unknown"}(u||(u={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth"}(p||(p={})),function(e){e[e.None=0]="None",e[e.SendBotRequestFailed=1]="SendBotRequestFailed",e[e.UrlHandeledAsDeepLink=2]="UrlHandeledAsDeepLink",e[e.UrlNotOpenedForCard=3]="UrlNotOpenedForCard",e[e.UrlOpenedForCard=4]="UrlOpenedForCard",e[e.UnableToGetAppInfo=5]="UnableToGetAppInfo",e[e.CardContentIsNull=6]="CardContentIsNull",e[e.ActionTypeIsNotSupported=7]="ActionTypeIsNotSupported",e[e.CardActionabilityBlocked=8]="CardActionabilityBlocked",e[e.NoActionPerformed=9]="NoActionPerformed",e[e.CardIdOrRenderingModeUndefined=10]="CardIdOrRenderingModeUndefined",e[e.AuthOnExecuteActionFailed=11]="AuthOnExecuteActionFailed"}(g||(g={})),function(e){e[e.MsgExtExecuteActionV2=1]="MsgExtExecuteActionV2",e[e.ExecuteAction=2]="ExecuteAction",e[e.MsgExtOpenUrlActionV2=3]="MsgExtOpenUrlActionV2",e[e.MsgExtShowCardActionV2=4]="MsgExtShowCardActionV2",e[e.MsgExtSSOTokenNeeded=5]="MsgExtSSOTokenNeeded",e[e.MsgExtSubmitAction=6]="MsgExtSubmitAction",e[e.MsgExtToggleVisibilityActionV2=7]="MsgExtToggleVisibilityActionV2",e[e.UpdateAppInfoOrchestrator=8]="UpdateAppInfoOrchestrator",e[e.GetAppFromAppId=9]="GetAppFromAppId",e[e.HydrateCard=10]="HydrateCard",e[e.ThumbnailCardRenderer=11]="ThumbnailCardRenderer",e[e.CardVerificationUtils=12]="CardVerificationUtils",e[e.AdaptiveCardRenderer=13]="AdaptiveCardRenderer",e[e.CardActions=14]="CardActions",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.O365ConnectorCardRenderer=16]="O365ConnectorCardRenderer",e[e.O365ConnectorCardUtils=17]="O365ConnectorCardUtils",e[e.MsgExtSerializationContext=18]="MsgExtSerializationContext",e[e.MsgExtCardRenderer=19]="MsgExtCardRenderer"}(h||(h={})),function(e){e[e.Commands=1]="Commands",e[e.CardActionability=2]="CardActionability",e[e.CardRender=3]="CardRender",e[e.GetCardForLink=4]="GetCardForLink"}(f||(f={})),function(e){e[e.Execute=1]="Execute",e[e.ExecuteActionOpenUrl=2]="ExecuteActionOpenUrl",e[e.MsgExtExecuteActionV2=3]="MsgExtExecuteActionV2",e[e.MsgExtOpenUrlActionV2=4]="MsgExtOpenUrlActionV2",e[e.GetAppForAppId=5]="GetAppForAppId",e[e.UpdateAppInfoOrchestrator=6]="UpdateAppInfoOrchestrator",e[e.PreProcessingRequest=7]="PreProcessingRequest",e[e.GetMsgExtOnSSOTokenNeeded=8]="GetMsgExtOnSSOTokenNeeded",e[e.OnSSOTokenFetch=9]="OnSSOTokenFetch",e[e.ThumbnailCardRenderer=10]="ThumbnailCardRenderer",e[e.VerifyCard=11]="VerifyCard",e[e.TransformO365Action=12]="TransformO365Action",e[e.HydrateCard=13]="HydrateCard",e[e.O365ConnectorCardRenderer=14]="O365ConnectorCardRenderer",e[e.HeroCardRenderer=15]="HeroCardRenderer",e[e.CardActionStubbed=16]="CardActionStubbed",e[e.CardActions=17]="CardActions",e[e.HandleTapAction=18]="HandleTapAction",e[e.ExecuteAction=19]="ExecuteAction",e[e.parseAction=20]="parseAction",e[e.MsgExtCardRendererBizApp=21]="MsgExtCardRendererBizApp"}(m||(m={})),function(e){e[e.SendBotRequest=1]="SendBotRequest",e[e.AppHeaderProcessing=2]="AppHeaderProcessing",e[e.MsgExtBaseCommand=3]="MsgExtBaseCommand",e[e.HydrateCard=4]="HydrateCard",e[e.UnfurlLink=5]="UnfurlLink",e[e.VerifyCard=6]="VerifyCard",e[e.GetApp=7]="GetApp",e[e.ExecuteAction=8]="ExecuteAction",e[e.SubmitAction=9]="SubmitAction",e[e.ShowCardAction=10]="ShowCardAction",e[e.ToggleVisibilityAction=11]="ToggleVisibilityAction",e[e.OpenUrlAction=12]="OpenUrlAction",e[e.AuthOnExecuteAction=13]="AuthOnExecuteAction"}(v||(v={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(b||(b={})),function(e){e.RenderingMode="RenderingMode",e.CardActionabilityStatus="CardActionabilityStatus",e.Trigger="Trigger",e.ActionType="ActionType",e.MessageType="MessageType",e.SourceType="SourceType",e.SilentAuthScenario="SilentAuthScenario",e.LinkUnfurlingErrorScenario="LinkUnfurlingErrorScenario",e.ResultType="ResultType",e.TypeOfCard="TypeOfCard",e.CardVerificationStatus="CardVerificationStatus",e.HttpStatus="HttpStatus",e.HasBotId="HasBotId",e.ModalTypes="ModalTypes",e.HasTaskURL="HasTaskURL",e.HasTaskCard="HasTaskCard",e.StageViewOrTaskModuleResult="StageViewOrTaskModuleResult",e.CardRendered="CardRendered",e.TypeOfAuthFlow="TypeOfAuthFlow"}(y||(y={}))},2814:function(e,t,n){"use strict";var r;function o(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:r.Unhandled,params:{url:new URL(e)}};const t=new URL(e);if(!t.pathname)return{type:r.Unhandled,params:{url:new URL(e)}};return"https://teams.microsoft.com"===t.origin&&/^\/l\//.test(t.pathname)?function(e){var t,n,o,i,a,s,l;try{if(!e)return;const c=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==c?void 0:c.length)||!c[1])throw new Error("Invalid Teams url format for TaskModule");const u={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},d={url:null!==(o=e.searchParams.get("url"))&&void 0!==o?o:void 0,fallbackUrl:null!==(i=e.searchParams.get("fallbackUrl"))&&void 0!==i?i:void 0,card:null!==(a=JSON.stringify(e.searchParams.get("card")))&&void 0!==a?a:void 0,width:u.width,height:u.height,title:null!==(s=e.searchParams.get("title"))&&void 0!==s?s:void 0,completionBotId:null!==(l=e.searchParams.get("completionBotId"))&&void 0!==l?l:void 0};return{type:r.TaskModule,params:{appId:c[1],taskInfo:d}}}catch(e){return}}(t)||a(t)||s(t)||i(t):{type:r.Unhandled,params:{url:new URL(e)}}}n.r(t),n.d(t,"deepLinkParser",(function(){return o})),n.d(t,"DeepLinkPayloadType",(function(){return r})),function(e){e.TaskModule="taskModule",e.StageView="stageView",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(r||(r={}));const i=e=>({type:r.Unhandled,params:{url:e}});const a=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const o=t.searchParams.get("context");let i={};const a=decodeURIComponent(null!=o?o:"");return i=JSON.parse(a),{type:r.StageView,params:{appId:n[1],stageInfo:i}}}catch(e){return}},s=e=>{var t,n;try{const o=/^\/l\/entity\/([^/]+)\/([^/]+)$/,i=e,a=i.pathname.match(o);if(3!==(null==a?void 0:a.length))throw new Error("Invalid Teams url format for Tab");const s=a[1];let l;if(i.searchParams.has("context")){const e=i.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");l=JSON.parse(t)}const c={entityId:a[2],webUrl:null!==(t=i.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=i.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==l?void 0:l.subEntityId};return{type:r.LaunchPage,params:{appId:s,tabInfo:c}}}catch(e){return}}},2815:function(e,t,n){"use strict";n.r(t),n.d(t,"mapMidgardLocaleToCLDRLocale",(function(){return c})),n.d(t,"getStringForRange",(function(){return u})),n.d(t,"mapNumberToRangeForLocale",(function(){return d})),n.d(t,"createICUString",(function(){return p})),n.d(t,"parsePluralString",(function(){return g})),n.d(t,"getPluralStringUnsafe",(function(){return h})),n.d(t,"getPluralString",(function(){return f}));var r=n(2),o=n(2171),i=n(1529),a=n.n(i),s=["zero","one","two","few","many","other"],l={zero:/zero\s*{([^}]+)}/,one:/one\s*{([^}]+)}/,two:/two\s*{([^}]+)}/,few:/few\s*{([^}]+)}/,many:/many\s*{([^}]+)}/,other:/other\s*{([^}]+)}/};function c(e){return e.split("-")[0]}function u(e,t){var n=Object(r.__read)(l[t].exec(e)||[],2)[1];return void 0===n?"":n}function d(e,t){return a()(t,e)}function p(e){var t="";return s.forEach((function(n){e[n]&&(t+=" ".concat(n,"{").concat(e[n],"}"))})),"".concat("{count, plural,").concat(t).concat("}")}function g(e,t,n){return u(e,d(t,n)||"other")}function h(e,t,n){if(t<0||t!==1/0&&!Object(o.a)(t))throw new Error("count must be a positive integer or Infinity");return g(e,t,n)}function f(e,t,n){if(void 0===t)return e;try{return h(e,t,n||"en")}catch(t){return e}}},2816:function(e,t,n){"use strict";n.r(t),n.d(t,"isSupportedLocale",(function(){return o})),n.d(t,"supportedLocales",(function(){return r})),n.d(t,"toSupportedLocale",(function(){return i}));var r=["af","am","ar","as-in","az-latn-az","be-by","bg","bn-in","bn-bd","bs-latn-ba","ca","ca-es-valencia","cs","cy","da","de","el","en-gb","en-us","es","es-mx","et","eu","fa","fi","fil","fr","fr-ca","ga-ie","gd-gb","gl","gu","ha-latn-ng","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","ky","lb-lu","lo-la","lt","lv","mi-nz","mk","ml","mn-mn","mr","ms","mt-mt","ne-np","nl","nn-no","no","or","pa-in","pl","prs","pt","pt-pt","quz-pe","ro","ru","sd-arab-pk","si-lk","sk","sl","sq","sr","sr-cyrl","sr-cyrl-ba","sv","sw","ta","te","th","tk-tm","tr","tt","ug-cn","uk","ur","uz","vi","zh-hans","zh-hant","zu-za"];function o(e){return r.indexOf(e)>=0}function i(e,t){if(e){var n=e.toLowerCase().replace("_","-"),i=a(n);if(i)return i;if(o(n))return n;var s=n.split("-");if(s.length>2){var l=s.slice(0,s.length-1).join("-");if(o(l))return l;var c=a(l);if(c)return c}if(s.length>1){var u=s[0];if(o(u))return u}var d=n.substr(0,2);if(o(d))return d;var p=a(d);if(p)return p;for(var g=0,h=r;g<h.length;g++){var f=h[g];if(0===f.indexOf(d))return f}}if(t)return t;throw new Error("".concat(e," cannot be mapped to a supported locale"))}function a(e){if(0===e.indexOf("es-")&&"es-es"!==e)return"es-mx";if(0===e.indexOf("en-")&&"en-us"!==e)return"en-gb";if(0===e.indexOf("ja-"))return"ja";switch(e){case"zh-hk":case"zh-mo":case"zh-rhk":case"zh-rtw":case"zh-sg":case"zh-tw":return"zh-hant";case"zh-rcn":return"zh-hans";case"be":return"nl";case"ga":return"ga-ie";case"in":return"id";case"iw":return"he";case"nb":return"no";default:return}}},284:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="/"},2845:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(246);class o{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isLoggingDone=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},2851:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(246);class o{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isLoggingDone=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},2858:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(723);function o(){var e=i();return Object(r.a)(e,"OPR/")||Object(r.a)(e,"Opera")?"Opera":Object(r.a)(e,"PhantomJS")?"PhantomJS":Object(r.a)(e,"Edg")?"Edge":Object(r.a)(e,"Electron")?"Electron":Object(r.a)(e,"Chrome")?"Chrome":Object(r.a)(e,"Trident")?"MSIE":Object(r.a)(e,"Firefox")?"Firefox":Object(r.a)(e,"Safari")?"Safari":Object(r.a)(e,"SkypeShell")?"SkypeShell":"Unknown"}var i=function(){var e;return null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent}},2859:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="InteractionRequiredAuthErrorFromMSAL"},2863:function(e,t,n){"use strict";n.d(t,"a",(function(){return pC}));var r=n(2),o=n(1),i=n.n(o),a=Object(o.createContext)(void 0),s=Object(o.createContext)((function(){}));function l(e){var t=e.children,n=Object(r.__read)(Object(o.useState)(void 0),2),s=n[0],l=n[1],c=Object(r.__read)(Object(o.useState)(void 0),2),u=c[0],d=c[1];return i.a.createElement(a.Provider,{value:{operaState:s,setOperaState:l,operaStepperLabelIndex:u,setOperaStepperLabelIndex:d}},t)}var c,u=n(3357),d=n(3397),p=n(725),g=n(3381),h={"Build Context":{icon:u.g,iconSelected:u.f},"Choose Audience":{icon:d.d,iconSelected:d.c},"Target Audience":{icon:d.d,iconSelected:d.c},"Generate Outline":{icon:p.d,iconSelected:p.c},Outline:{icon:p.d,iconSelected:p.c},"Generate Topics":{icon:p.d,iconSelected:p.c},"Publish Draft":{icon:p.f,iconSelected:p.e},"Review & Publish":{icon:p.f,iconSelected:p.e},"Draft & Edit":{icon:p.f,iconSelected:p.e},Review:{icon:p.j,iconSelected:p.i},Export:{icon:g.k,iconSelected:g.j}},f={choose_input_files:"FilePicker",choose_audience:"PillsList",choose_topic:"CheckboxList",publish_draft:"PillsList",draft_and_edit:"RadioGroup"},m=n(3345),v=n(1627),b=n(2445),y=Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),C=Object(r.__assign)(Object(r.__assign)({},b.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),O=Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"});!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(c||(c={}));var S=c.defaultWhite,E=!1,x=!1,I=function(e){S=e},w=function(){return S},T=function(){return E},k=function(e){E=e};function j(e){var t=e.theme,n=e.dir,o=e.children,a=i.a.useMemo((function(){switch(w()){case c.defaultBlack:return Object(r.__assign)(Object(r.__assign)({},C),t);case c.defaultWhite:default:return Object(r.__assign)(Object(r.__assign)({},y),t)}}),[t]);return i.a.createElement(m.a,{theme:a,dir:n},o)}var P,A,_,D,L,M,B=function(e){var t=e.children,n=Object(r.__rest)(e,["children"]);return n.shouldUseV9Tokens?i.a.createElement(m.a,{theme:n.theme,dir:n.dir},t):(console.log("Test app is using Custom tokens to render Theme"),i.a.createElement(i.a.Fragment,null,t))},R=n(1153);!function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.Designer=8]="Designer",e[e.CopilotWorkflowMessage=9]="CopilotWorkflowMessage",e[e.WarningMessage=10]="WarningMessage",e[e.PaginatedCard=11]="PaginatedCard",e[e.ProactiveSuggestionCard=12]="ProactiveSuggestionCard"}(P||(P={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.QueryDetails="QueryDetails",e.Microphone="Microphone"}(A||(A={})),function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.AugloopResponseTime="AugloopResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.ImageResponseTime="ImageResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.QnAResponseTime="QnAResponseTime",e.QnAChunkInfo="QnAChunkInfo",e.SuggestedQnAResponseTime="SuggestedQnAResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.IsFirstSdxSessionQuery="IsFirstSdxSessionQuery",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad"}(_||(_={})),function(e){e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorType="ChatErrorType",e.IsFromCache="IsFromCache",e.IsStreamingResponse="IsStreamingResponse"}(D||(D={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory"}(L||(L={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.SubmitButtonClicked="Submit_Button_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.ZQMLoaded="ZQM_Loaded",e.MenuItemClicked="Menu_Item_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.HintCardShownOnSubmission="Hint_Card_Shown",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.ALAnnotationReceived="AL_Annotation_Received",e.ChatHistoryTimeout="Chat_History_Timeout",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.EntityLabelOperationSubmitted="Entity_Label_Operation_Submitted",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.GetCurrentChatStatus="GetCurrentChat_Status",e.GetMessagesStatus="GetMessages_Status",e.FeedbackDataUploadOperationSubmitted="FeedbackDataUpload_Operation_Submitted",e.FeedbackDataSydneyDataMissing="FeedbackData_SydneyData_Missing",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionCompleted="Query_Execution_Completed",e.ChatPaneLoadMessageBarShown="ChatPaneLoad_MessageBar_Shown",e.FirstUserInputReceived="First_User_Input_Received",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.ChatInputLoaded="ChatInput_Loaded",e.FirstQuerySubmitted="First_Query_Submitted",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TrySydneyToggle="Try_Sydney_Toggle",e.IsSydneyEnabled="Is_Sydney_Enabled",e.HubbleEnterprisePromptClicked="EnterpriseImagePrompt_Clicked",e.BasicChatOperationSubmitted="Basic_Chat_Operation_Submitted",e.BasicChatStreamingResponseTimeout="Basic_Chat_Streaming_Response_Timeout",e.CachedBasicChatResponseShown="Cached_Basic_Chat_Response_Shown",e.EmptyBasicChatResponse="Empty_Basic_Chat_Response",e.QuerySuccessful="Query_Successful",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CLPEncryptedLabelSent="CLP_Encrypted_Label_Sent",e.CLPNonEncryptedLabelSent="CLP_Non_Encrypted_Label_Sent",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabGoToCopilotLabButtonClicked="Copilot_Lab_GoToCopilotLab_Button_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.GroundingSourceUpdated="Grounding_Source_Updated",e.MenuButtonClicked="Menu_Button_Clicked",e.MenuL1SuggestionClicked="Menu_L1_Suggestion_Clicked",e.MenuL2SuggestionClicked="Menu_L2_Suggestion_Clicked",e.PluginConfigSignalSent="Plugin_Config_Signal_Sent",e.PromptSubmittedWithCIQ="Prompt_Submitted_With_CIQ",e.CIQSuggestionSelected="CIQ_Suggestion_Selected"}(M||(M={}));var F,N,H,U,V,z,G,W=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},M),_),L),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(F||(F={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(N||(N={})),function(e){e.BasicChat="Basic Chat",e.ContentCreation="Content Creation Skill in Chat"}(H||(H={})),function(e){e.Client="Client",e.Server="Server"}(U||(U={})),function(e){e.ChatQnA="Chat QnA",e.Draft="Draft"}(V||(V={})),function(e){e.BasicChatDidNotGenerateAnswer="CopilotBasicChatDidNotGenerateAnswer",e.ChatComposeDidNotGenerateContent="CopilotChatComposeDidNotGenerateContent",e.BasicChatMissingCopilotFunctionality="Ask ChatQnA Missing Copilot Functionality",e.BasicChatCapacityIssues="Ask ChatQnA Unable to Generate Response Due to Capacity Issue",e.BasicChatBadResponse="Ask ChatQnA LLM Service Side Issue Prevents Output",e.BasicChatTaskCompletionIssue="Ask ChatQnA Unable to Complete Task",e.BasicChatUnclassifiedError="Ask ChatQnA Unclassified ASHA Error"}(z||(z={})),function(e){e.Fallback="No response as there is a service side error",e.InputTooLong="No response as input is too long",e.UserThrottled="No response as user has issued too many requests",e.Timeout="No response as service timed out",e.InvalidLanguage="No response as language is not supported",e.InvalidSignal="No response as signal/response is invalid",e.PromptInjection="No response as prompt injection is detected",e.InputBlocked="No response as input blocked by dynamic guard list",e.OutputBlocked="No response as output blocked by dynamic guard list",e.OffensiveInput="No response as input content is offensive",e.OffensiveOutput="No response as output content is offensive",e.SignalMissing="No response as signal is missing in workflow",e.SignalWrongType="No response as signal has wrong type",e.BadResponse="Error occured because of bad response",e.ScenarioThrottled="No response as scenario has issued too many requests",e.BadRequest="Error occured because of bad request",e.Unknown="Error is unknown"}(G||(G={}));var Q,q="UserQueryGuid",K="Chat";!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(Q||(Q={}));var Y=Q.web,Z=function(){return Y};function J(){return Y===Q.IOS}var X=n(1543),$=n(65),ee=Object(X.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),te=function(e){var t=e.children,n=e.style,i=e.horizontal,a=void 0!==i&&i,s=e.reverse,l=void 0!==s&&s,c=e.customProperties,u=function(e,t,n,r){var o=e.root;return t&&(o=Object($.a)(o,t)),n?o=r?Object($.a)(o,e.horizontalReverse):Object($.a)(o,e.horizontal):r&&(o=Object($.a)(o,e.verticalReverse)),o}(ee(),n,a,l);return o.createElement("div",Object(r.__assign)({className:u},c),t)},ne=n(3370),re=n(335),oe={root:Object(r.__assign)({},re.a.margin("0px","16px","0px","16px"))},ie=Object(X.a)(oe),ae=function(e){var t=e.label,n=e.checked,r=e.disabled,o=e.onChange,a=ie();return i.a.createElement(ne.a,{className:a.root,onChange:o,checked:n,label:t,disabled:r,labelPosition:"after"})},se=n(1814),le=Object(X.a)({item:{height:"auto",width:"auto",flexShrink:1}}),ce=function(e){var t=e.children,n=e.style,r=Object($.a)(le().item,n);return i.a.createElement("div",{className:r},t)},ue={buttonStack:Object(r.__assign)({},re.a.margin("0px","0px","0px","15px")),buttonStackItem:Object(r.__assign)({},re.a.margin("0px","5px","0px","0px"))};var de,pe,ge,he=(ge={buttonStack:null!==(de=ue.buttonStack)&&void 0!==de?de:{},buttonStackItem:null!==(pe=ue.buttonStackItem)&&void 0!==pe?pe:{}},Object(X.a)(ge)),fe=n(3599),me=n(3371),ve=n(3372),be=n(3373),ye=n(2265),Ce=n(3374),Oe=n(3375),Se=n(3376),Ee=n(3377),xe=n(3378),Ie=n(3379),we=n(576),Te=n(2823),ke=function(e){var t=Object(Te.a)(e);return Object(X.a)({itemCell:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("5px")),re.a.borderBottom("1px","solid",t.themePrimary)),{minHeight:"30px",boxSizing:"border-box",display:"flex",selectors:{"&:hover":{backgroundColor:t.neutralLight}}}),itemContent:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.overflow("hidden")),re.a.margin("0px","0px","0px","5px")),{flexGrow:1}),itemName:Object(r.__assign)(Object(r.__assign)({},re.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"},accordionBody:Object(r.__assign)({},re.a.margin("0px","10px")),metricAccordionHeaderText:Object(r.__assign)(Object(r.__assign)({},re.a.overflow("auto")),{overflowWrap:"anywhere",fontSize:"16px",fontWeight:"500"})})};var je,Pe=function(e){var t=Object(r.__read)(i.a.useState([]),2),n=t[0],o=t[1],a=ke(y);return i.a.createElement(Oe.a,{openItems:n,onToggle:function(e,t){o(t.openItems)},multiple:!0,collapsible:!0,className:a().accordionBody},e.telemetry.metrics.map((function(e,t){return i.a.createElement(Se.a,{key:t,value:(t+1).toString()},i.a.createElement(Ee.a,null,i.a.createElement(xe.a,{className:a().metricAccordionHeaderText},"".concat(e.serviceName))),i.a.createElement(Ie.a,null,Object.keys(e).filter((function(e){return"serviceName"!==e})).map((function(t,n){return i.a.createElement("div",{key:n,className:a().itemCell,"data-is-focusable":!0},i.a.createElement("div",{className:a().itemContent},i.a.createElement(xe.a,{block:!0,className:a().itemName},t.toString()),i.a.createElement(xe.a,{block:!0,className:a().itemValue},String(e[t]))))}))))})))};!function(e){e.COPIED="Copied",e.COPY_ERROR="Copy Error",e.COPY_DEBUG_LOGS="Copy Debug Logs"}(je||(je={}));var Ae=function(){return"Sydney Telemetry Debug Panel"},_e=function(){return"Query ID :"},De=function(){return"Show Telemetry Panel"},Le=function(){return"Replay Conversation"},Me=function(){return"Debug Tools"},Be=function(){return"https://sdf.cortana.ai/turingbot/ui?debug=true&enableDebugButton=&allowedMessageTypes=Any&variants=UseIc3ForConversationStorage&sourceConversationId="},Re=function(){return"_blank"},Fe=function(){return Object(X.a)({dialogTitle:Object(r.__assign)({},re.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(r.__assign)(Object(r.__assign)({},re.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"}})};var Ne=function(e){var t=Object(r.__read)(i.a.useState([]),2),n=t[0],o=t[1],a=Fe();return i.a.createElement(fe.a,{open:e.isModalOpen,onOpenChange:function(t,n){e.setIsModalOpen(n.open)}},i.a.createElement(me.a,null,i.a.createElement(ve.a,null,i.a.createElement(be.a,{action:i.a.createElement(ye.a,{action:"close"},i.a.createElement(se.a,{appearance:"subtle","aria-label":"close",icon:i.a.createElement(we.n,null)})),className:a().dialogTitle},Ae()),i.a.createElement(Ce.a,null,i.a.createElement(Oe.a,{openItems:n,onToggle:function(e,t){o(t.openItems)},multiple:!0,collapsible:!0},e.telemetryData.map((function(e,t){return i.a.createElement(Se.a,{key:t,value:(t+1).toString()},i.a.createElement(Ee.a,null,i.a.createElement(te,null,i.a.createElement(xe.a,{block:!0,className:a().queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat(_e())),i.a.createElement(xe.a,{className:a().queryAccordionText},e.queryId))),i.a.createElement(Ie.a,null,i.a.createElement(Pe,{telemetry:e.telemetry})))})))))))};var He=function(e){var t=this,n=Object(r.__read)(Object(o.useState)(!1),2),a=n[0],s=n[1],l=Object(r.__read)(Object(o.useState)(!1),2),c=l[0],u=l[1],d=Object(r.__read)(Object(o.useState)(!1),2),p=d[0],g=d[1],h=Object(r.__read)(Object(o.useState)(!1),2),f=h[0],m=h[1],v=he(),b=c?je.COPIED:p?je.COPY_ERROR:je.COPY_DEBUG_LOGS,y={checked:a,disabled:!1,onChange:function(e,t){var n=null==t?void 0:t.checked;s(null!=n&&n),n||(u(!1),g(!1))},label:Me()};return i.a.createElement(te,null,i.a.createElement(ae,Object(r.__assign)({},y)),i.a.createElement(te,{horizontal:!0,style:v.buttonStack},i.a.createElement(ce,{style:v.buttonStackItem},a&&i.a.createElement(se.a,{appearance:"outline",onClick:function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),(t=e.getLogs())?[4,navigator.clipboard.writeText(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return u(!0),[3,4];case 3:return n=r.sent(),console.log("An error occurred while copying text to clipboard:",n.message),g(!0),[3,4];case 4:return[2]}}))}))},size:"small",title:b},b)),i.a.createElement(ce,{style:v.buttonStackItem},a&&""!=e.conversationId&&i.a.createElement(se.a,{appearance:"outline",onClick:function(){e.conversationId&&window.open(Be()+e.conversationId,Re())},size:"small",title:Le()},Le())),i.a.createElement(ce,{style:v.buttonStackItem},a&&e.telemetryData&&i.a.createElement(se.a,{appearance:"outline",onClick:function(){m(!f)},size:"small",title:De(),disabled:0===e.telemetryData.length},De()))),a&&e.telemetryData&&f&&i.a.createElement(Ne,{telemetryData:e.telemetryData,isModalOpen:f,setIsModalOpen:m}))},Ue=n(3514),Ve=n(3358),ze=n(552),Ge=n(1776),We=n(138),Qe=function(){return lt()?OfficeaicopilotStrings.ChatCardFooterDisclaimer:"AI-generated content may be incorrect"},qe=function(){return lt()?OfficeaicopilotStrings.ChatCardFooterDisclaimerPowered:"AI-powered suggestions may be inaccurate"},Ke=function(){return lt()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeader:"Provide feedback"},Ye=function(){return lt()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeaderTitle:"MICROSOFT INTERNAL ONLY"},Ze=function(){return lt()?OfficeaicopilotStrings.ShowMeButtonText:"Show Me"},Je="Help",Xe=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm,$e=function(){return lt()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},et="",tt=Object(Te.a)(y),nt="group",rt="list",ot="listitem",it="menu",at="menuitem",st="button",lt=function(){return"undefined"!=typeof OfficeaicopilotStrings},ct=function(e){var t;return null===(t=Object.values(Ge.b).filter((function(t){return t===e})))||void 0===t?void 0:t[0]},ut=function(e){var t,n=document.getElementById(e),r=n.cloneNode(!0);dt(n,r);var o=r.outerHTML.replace(Xe,"");return null===(t=r.parentNode)||void 0===t||t.removeChild(r),o};function dt(e,t){var n=document.createElement("div");document.body.appendChild(n);for(var r=getComputedStyle(e),o=getComputedStyle(n),i=[],a=0;a<r.length;a++){var s=r[a],l=r.getPropertyValue(s),u=o.getPropertyValue(s),d=w();d!==c.defaultBlack&&d!==c.defaultDarkGrey||"color"===s&&(l=tt.black),l!==u&&i.push("".concat(s,": ").concat(l))}t.setAttribute("style",i.join(";"));for(var p=e.children,g=t.children,h=0;h<p.length;h++){dt(p[h],g[h])}n.remove()}var pt,gt=function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n]);return e},ht=function(e,t){var n=[],o=e.body,i=function(e){var t,n,o=e.split(/(\[.*?\]\(.*?\))/g),i=[];try{for(var a=Object(r.__values)(o),s=a.next();!s.done;s=a.next()){var l=s.value;if(!l.startsWith("[")||!l.endsWith(")")){var c=l.trim();c.startsWith(".")&&(c=c.substring(1).trim(),i.length>0&&(i[i.length-1]=i[i.length-1]+". ")),i.push(c)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}(o[0].text);return i.forEach((function(i,a){i.length>0?n.push({adaptiveCard:Object(r.__assign)(Object(r.__assign)({},e),{body:[Object(r.__assign)(Object(r.__assign)({},o[0]),{text:i})]}),references:t[a]?[t[a]]:[]}):t[a]&&n.length>0&&n[n.length-1].references.push(t[a])})),n},ft=function(e,t){if(0===t.length)return!1;var n=e.search("%c");if(-1===n)return!1;var r=e.slice(n+2).search("%c");if(-1===r)return!1;r=r+n+2;var o=parseInt(e.slice(n+2,r));return t.some((function(e){return e.referenceIndex===o}))},mt=function(){return{aadUserId:"",clientType:We.b.web,hubName:We.c.office,locale:"en-US",physicalRing:"",sessionId:"",theme:We.d.default,userName:"",userPrincipalName:""}},vt=n(3348),bt=n(882);var yt,Ct,Ot,St=Object(Te.a)(y),Et=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},workflowStepStack:null!==(r=e.workflowStepStack)&&void 0!==r?r:{},cardHeader:null!==(o=e.cardHeader)&&void 0!==o?o:{},userContentButton:null!==(i=e.userContentButton)&&void 0!==i?i:{},userContentButtonItem:null!==(a=e.userContentButton)&&void 0!==a?a:{},userContentButtonDisabled:{},leftAlignedText:{},thumbnail:{},actionButtonStack:{}};return Object(X.a)(s)}({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({maxWidth:"288px"},re.a.padding(St.spacingVerticalM,St.spacingHorizontalL)),{fontFamily:"-apple-system"}),re.a.margin(St.spacingVerticalNone,St.spacingHorizontalL,St.spacingVerticalS)),{boxShadow:St.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(r.__assign)({},re.a.gap(St.spacingVerticalS)),userContentButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding(St.spacingVerticalL,St.spacingHorizontalXL)),{minHeight:"40px"}),re.a.borderRadius(St.borderRadiusXLarge)),(pt={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},pt["& .".concat(bt.a.icon)]=Object(r.__assign)({},re.a.margin("0px","11px","0px","0px")),pt))}),xt=Object(Te.a)(y),It={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{boxShadow:xt.shadow4,color:xt.neutralPrimary,backgroundColor:xt.neutralLight}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",xt.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),workflowStepStack:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.gap("10px")),re.a.padding("10px","8px","20px","8px")),re.a.overflow("hidden")),cardHeader:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{whiteSpace:"pre-wrap"}),userContentButtonItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:xt.neutralLight},re.a.border("1px","solid",xt.neutralLighterAlt)),vt.a.body1),(yt={},yt["&:hover .".concat(bt.a.icon)]={color:xt.themePrimary},yt)),userContentButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},re.a.padding("0px","15px")),{backgroundColor:xt.neutralLight}),re.a.border("1px","solid",xt.neutralLighterAlt)),vt.a.body1),(Ct={},Ct["&:hover .".concat(bt.a.icon)]={color:xt.themePrimary},Ct)),userContentButtonDisabled:(Ot={color:xt.neutralQuaternary},Ot["&:hover .".concat(bt.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},Ot),leftAlignedText:Object(r.__assign)({textAlign:"left"},re.a.padding("0px","8px")),thumbnail:{paddingLeft:"10px"},actionButtonStack:Object(r.__assign)({marginTop:"8px"},re.a.gap("12px"))},wt=Object(X.a)(It),Tt=function(){var e=wt(),t=Et();if(Z()===Q.IOS)e=gt(e,t);return e},kt=["Step 1","Step 2","Step 3","Step 4","Step 5"],jt=i.a.memo((function(e){var t,n=e.overrideStyles,a=e.stages,s=e.gotoNextStageString,l=e.index,c=e.lastEnabledStep,u=e.handleButtonClick,d=e.allowForwardNavigation,p=void 0!==d&&d,g=e.displayStatusIcon,h=void 0===g||g,f=Tt();gt(f,n);var m=Object(r.__read)(Object(o.useState)(0),2),v=m[0],b=m[1],y=Object(r.__read)(Object(o.useState)(!1),2),C=y[0],O=y[1],S=Object(r.__read)(Object(o.useState)(!0),2),E=S[0],x=S[1],I=a||kt,w=function(){O(!C)},T=function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})};return Object(o.useEffect)((function(){b(l)}),[l]),i.a.createElement(Ue.a,{className:f.root,"aria-labelledby":I[0],style:{backgroundColor:"#ecf3fc",margin:"0px",borderRadius:"0px",boxShadow:"none",position:"fixed",width:"-webkit-fill-available",zIndex:"2"}},i.a.createElement(te,null,i.a.createElement(se.a,{size:"large",role:at,key:v,disabled:!1,"aria-posinset":1,"aria-setsize":null===(t=I[v])||void 0===t?void 0:t.length,className:f.userContentButton,style:{backgroundColor:"#ebf3fc",border:"none",padding:"0px 10px",height:"fit-content",display:"flex",justifyContent:"space-between"}},i.a.createElement("div",{style:{display:"flex",alignItems:"left"}},i.a.createElement("b",null," ",I[v]),i.a.createElement("div",{onClick:function(){w()},style:{paddingLeft:"8px"}},C?T(ze.x,ze.w):T(ze.n,ze.m))),E&&i.a.createElement("div",{style:{display:"flex",alignItems:"right"}},i.a.createElement(se.a,{onClick:function(){!function(e){b(e),u(e),e===I.length-1?x(!1):x(!0)}(v+1)}},s[v+1]?s[v+1]:"Go to next step",T(ze.t,ze.t))))),C&&i.a.createElement("div",{style:{overflow:"auto",maxHeight:"100vh"}},i.a.createElement(te,{style:f.workflowStepStack},I.map((function(e,t){return i.a.createElement(se.a,{size:"large",role:at,key:t,disabled:!1,"aria-posinset":t+1,"aria-setsize":e.length,className:f.userContentButtonItem,onClick:function(){(t<=c||p)&&function(e){b(e),O(!C),u(e),e===I.length-1?x(!1):x(!0)}(t)},icon:h&&(t<c?T(ze.i,ze.i,{color:"green"}):t===c?T(ze.C,ze.B,{color:"black"}):T(ze.A,ze.z,{color:"black"})),style:{border:"none",borderRadius:"8px",boxShadow:t===v?"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)":"none",justifyContent:"flex-start"}},t===v?i.a.createElement("b",null,e):e)})))))})),Pt=n(3384),At=n(2461),_t=function(){return lt()?OfficeaicopilotStrings.StopGeneratingButtonLabel:"Stop generating"};var Dt,Lt,Mt,Bt=function(e){var t,n,r,o,i,a,s,l,c={root:null!==(t=e.root)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},loaderHighContrast:{},progressBarStyle:null!==(r=e.progressBarStyle)&&void 0!==r?r:{},headerStyle:null!==(o=e.headerStyle)&&void 0!==o?o:{},stopButtonStyle:null!==(i=e.stopButtonStyle)&&void 0!==i?i:{},stopButtonIconStyle:null!==(a=e.stopButtonIconStyle)&&void 0!==a?a:{},inlineStopIcon:null!==(s=e.inlineStopIcon)&&void 0!==s?s:{},stackStopText:null!==(l=e.stackStopText)&&void 0!==l?l:{}};return Object(X.a)(c)}({loader:Object(r.__assign)(Object(r.__assign)({display:"inline"},re.a.padding("0px")),re.a.borderRadius("12px")),progressBarStyle:{height:"4px"},stackStopText:{display:"flex"}}),Rt=Object(Te.a)(y),Ft={root:Object(r.__assign)(Object(r.__assign)({alignItems:"center"},re.a.margin(Rt.spacingVerticalNone,Rt.spacingHorizontalL,Rt.spacingVerticalM)),re.a.gap(Rt.spacingVerticalM)),loader:Object(r.__assign)(Object(r.__assign)({minHeight:"48px",backgroundColor:Rt.neutralLight,boxShadow:Rt.shadow4,transformOrigin:"bottom",width:"100%"},re.a.overflow("hidden")),re.a.borderRadius(Rt.borderRadiusXLarge)),loaderHighContrast:Object(r.__assign)({},re.a.border("1px","solid",Rt.neutralLighterAlt)),progressBarStyle:{backgroundImage:"linear-gradient(90.5deg, ".concat(Rt.themeLight," 10%, ").concat(Rt.themeDarkAlt," 32%, ").concat(Rt.themeLighterAlt," 55%, ").concat(Rt.themeLighter," 72%, ").concat(Rt.neutralLighter," 100%)"),backgroundColor:Rt.neutralLight,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:Object(r.__assign)(Object(r.__assign)({fontWeight:Rt.fontWeightSemibold},re.a.padding(Rt.spacingVerticalM)),{lineHeight:"143%",color:Rt.neutralPrimary}),stopButtonStyle:(Dt={fontFamily:Rt.fontFamilyBase,fontSize:Rt.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},Dt["&:hover .".concat(bt.a.icon)]={color:Rt.themePrimary},Dt["&:hover:active .".concat(bt.a.icon)]={color:Rt.themePrimary},Dt),stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("10px")),re.a.margin(Rt.spacingVerticalNone,Rt.spacingHorizontalNone,Rt.spacingVerticalNone,Rt.spacingHorizontalS)),re.a.border("0px")),(Lt={height:"44px",width:"44px"},Lt["&:hover .".concat(bt.a.icon)]={color:Rt.themePrimary},Lt["&:hover:active .".concat(bt.a.icon)]={color:Rt.themePrimary},Lt["@media (forced-colors: none)"]={"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},Lt))},Nt=Object(X.a)(Ft),Ht=i.a.memo((function(e){var t=e.stylesToOverride,n=e.loadingUiStrings,a=e.stringChangeIntervalDuration,s=void 0===a?3500:a,l=e.showStopButton,c=void 0!==l&&l,u=e.showInlineStopButton,d=void 0!==u&&u,p=e.handleStopButtonOnClick,g=function(){var e=Nt(),t=Bt();Z()===Q.IOS&&gt(e,t);return e}(),h=T();gt(g,t),g.loaderHighContrast=Object($.a)(g.loader,g.loaderHighContrast);var f=Object(r.__read)(Object(o.useState)(0),2),m=f[0],v=f[1];return Object(o.useEffect)((function(){v(0)}),[JSON.stringify(n)]),Object(o.useEffect)((function(){var e=setInterval((function(){var t=m+1;t===n.length?clearInterval(e):v(t)}),s);return function(){return clearInterval(e)}}),[m,s,n.length]),i.a.createElement(te,{style:g.root},i.a.createElement(te,{style:h?g.loaderHighContrast:g.loader,customProperties:{role:nt,"aria-live":"assertive"}},i.a.createElement(te,{horizontal:!0,style:g.stackStopText},d&&i.a.createElement(se.a,{appearance:"subtle",className:g.inlineStopIcon,icon:i.a.createElement(we.o,null),onClick:p,"aria-label":_t(),title:_t()}),i.a.createElement(xe.a,{id:lt()?OfficeaicopilotStrings.LoadingUiTextLabel:"loadingUiText",className:g.headerStyle},n[m])),i.a.createElement(Pt.a,{bar:{className:g.progressBarStyle},thickness:"large",shape:"rounded"})),c&&i.a.createElement(se.a,{appearance:"subtle",className:g.stopButtonStyle,icon:i.a.createElement(At.j,null),onClick:p,size:"small","aria-live":"assertive"},_t()))}));!function(e){e.NEXT_STAGE="NextStage",e.NEXT_CARD="NextCard",e.OPEN_EDITOR="OpenEditor",e.ADD_TOPIC="AddTopic"}(Mt||(Mt={}));var Ut=n(1820),Vt=n(3387),zt=function(){return lt()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"wucHeaderText"},Gt=i.a.forwardRef((function(e,t){var n,a=e.overrideStyles,s=e.messageButtonContent,l=e.headerText,c=e.addActionButtonProps,u=e.handleEditorOpenButtonClick,d=e.buttonText,p=void 0===d?"Start Generating":d,g=e.buttonTextInEnabledState,h=void 0===g?"":g,f=e.buttonTextInDisabledState,m=void 0===f?"":f,v=e.buttonRole,b=e.enableCheckBox,y=void 0===b||b,C=e.cardIndex,O=void 0===C?0:C,S=(e.allowItemAddition,e.dialogTitle),E=void 0===S?"New Entry":S,x=e.onSelectCheckBox,I=void 0===x?function(e,t){}:x,w=e.handleOnClickItemAddition,k=void 0===w?function(e){}:w,j=e.handleButtonClick,P=void 0===j?function(e){}:j,A=e.handleClientButtonClick,_=void 0===A?function(e){}:A,D=e.shouldDisableButtonAtBottom,L=void 0!==D&&D,M=Tt(),B=T(),R=h||p,F=m||p;gt(M,a),M.userContentButtonDisabled=Object($.a)(M.userContentButton,M.userContentButtonDisabled),M.rootHighContrast=Object($.a)(M.root,M.rootHighContrast);var N=Object(r.__read)(Object(o.useState)(s),2),H=N[0],U=N[1],V=Object(r.__read)(Object(o.useState)(!0),2),z=V[0],G=V[1],W=Object(r.__read)(Object(o.useState)(R),2),Q=W[0],q=W[1],K=Object(r.__read)(Object(o.useState)(!1),2),Y=K[0],Z=K[1],J=Object(r.__read)(Object(o.useState)(""),2),X=J[0],ee=J[1],ne=function(e){Z(!0),k(e)},re=function(e,t){var n;void 0===t&&(t=!0);var o=Object(r.__spreadArray)([],Object(r.__read)(H),!1),i=Object(r.__spreadArray)([],Object(r.__read)(le),!1);o.length>0&&o[o.length-1].isAddItemButton?(o.splice(o.length-1,0,e),i.splice(i.length-1,0,t)):(o.push(e),i.push(t)),I(t,null!==(n=e.boldText)&&void 0!==n?n:""),U(o),ue(i)};Object(o.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){void 0===t&&(t=!0),re(e,t)}}}));var oe=function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})},ie=new Array(null==s?void 0:s.length).fill(!1),ae=Object(r.__read)(Object(o.useState)(ie),2),le=ae[0],ue=ae[1];return i.a.createElement(Ue.a,{className:B?M.rootHighContrast:M.root,"aria-labelledby":zt()},l&&i.a.createElement(ce,null,i.a.createElement(xe.a,{id:zt(),className:M.cardHeader},l)),H&&i.a.createElement(te,{style:M.buttonStack,customProperties:{role:it}},H.map((function(e,t){return i.a.createElement(se.a,{size:"large",role:at,key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":H.length,className:e.isDisabled?M.userContentButtonDisabled:M.userContentButton,style:e.isAddItemButton?{borderBlockStyle:"dashed"}:{},onClick:function(){e.onSelectButton&&e.onSelectButton(),e.isAddItemButton&&ne()}},i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},y&&!e.isAddItemButton&&i.a.createElement("div",{onClick:function(){var n=function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(le),!1);return t[e]=!t[e],ue(t),G(!0),q(R),t[e]}(t);e.onSelectCheckBox&&e.onSelectCheckBox(n,e.boldText),I&&I(n,e.boldText)}},le[t]?oe(ze.j,ze.j,{color:"green"}):oe(At.i,At.i)),e.iconUrl&&i.a.createElement("img",{className:M.thumbnail,src:e.iconUrl,alt:"",height:20,width:20}),e.boldText?i.a.createElement("div",null,i.a.createElement("p",{className:M.leftAlignedText,title:e.buttonHyperLinkToolTip?e.buttonHyperLinkToolTip:"",onClick:e.buttonHyperLink?function(){return window.open(e.buttonHyperLink,"_blank")}:function(){return console.log("Link not available for button")}},i.a.createElement("b",null," ",e.boldText," ")," ",e.message)):i.a.createElement("p",null,e.message)))})),i.a.createElement(fe.a,{modalType:"modal",open:Y},i.a.createElement(me.a,{className:M.root,tabIndex:0},i.a.createElement(ve.a,null,i.a.createElement(be.a,{className:M.buttonStack,action:i.a.createElement(ye.a,{action:"close"},i.a.createElement(se.a,{appearance:"subtle","aria-label":"close",icon:i.a.createElement(we.n,null),onClick:function(){return Z(!1)}}))},null!=E?E:"Add Item"),i.a.createElement(Ce.a,null,i.a.createElement(Ut.a,{onChange:function(e,t){return ee(t)},className:M.root,styles:{fieldGroup:{borderColor:"transparent"}}})),i.a.createElement(Vt.a,{className:M.buttonStack},i.a.createElement(se.a,{className:M.buttonStack,appearance:"primary",onClick:function(){if(!(s.length-2<0||0===X.length)){var e={boldText:X};Z(!1),re(e,!0)}}},"Submit")))))),i.a.createElement(te,{horizontal:!0,style:M.actionButtonStack},c&&i.a.createElement(ce,null,i.a.createElement(se.a,{appearance:null!==(n=c.appearance)&&void 0!==n?n:void 0,onClick:function(){c.isEditorNeedToOpen?u&&u():ne()}},c.text)),p.length>0&&i.a.createElement(ce,null,i.a.createElement(se.a,{appearance:null!=v?v:void 0,disabled:!z||(null==H?void 0:H.length)>0&&y&&!le.some((function(e){return e})),onClick:function(){var e;L||(e=O,G(!1),q(F),P&&P(e),_&&_(e))}},Q))))})),Wt=i.a.memo(Gt),Qt=i.a.forwardRef((function(e,t){var n=e.onClickNextStage,a=void 0===n?function(e){}:n,s=e.onClickNext,l=void 0===s?function(e){}:s,c=e.stageIndex,u=void 0===c?1:c,d=e.data,p=void 0===d?{}:d,g=null==p?void 0:p.componentRenderData,h=Object(o.useRef)();return Object(o.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=h.current)||void 0===n||n.addUserContentMessageItem(e,t)}}})),i.a.createElement(te,null,g.map((function(e,t){return e.handleButtonClick=function(){l(u),a(u)},i.a.createElement(Wt,Object(r.__assign)({ref:h,key:t,cardIndex:1},e))})))})),qt=Qt,Kt=o.forwardRef((function(e,t){e.stageHeader;var n=e.onClientInteractionData,i=void 0===n?function(e){}:n,a=(e.getComponentRenderData,e.shouldEnableNext,e.onClickNext),s=void 0===a?function(e){}:a,l=(e.isHTMLEditorUpdateRequired,e.stageIndex),c=void 0===l?0:l,u=e.onClickNextStage,d=void 0===u?function(e){}:u,p=e.data,g=void 0===p?{}:p,h=function(e){var t,n,o=0;try{for(var i=Object(r.__values)(e),a=i.next();!a.done;a=i.next()){if(a.value.buttonAction==Mt.NEXT_CARD)return o;o++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}(null==g?void 0:g.componentRenderData),f=new Set,m=o.useRef(),v=Object(r.__read)(o.useState(f),2),b=v[0],y=v[1];o.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=m.current)||void 0===n||n.addUserContentMessageItem(e,t)}}}));var C=Object(r.__read)(o.useState(h),2),O=C[0],S=C[1],E=function(e){if(S(e+1),i){var t=Object(r.__spreadArray)([],Object(r.__read)(b),!1);i(t)}},x=(null==g?void 0:g.componentRenderData)?null==g?void 0:g.componentRenderData:[];return o.createElement(te,null,x.map((function(e,t){var n=Object(r.__assign)({},e);if(n.onSelectCheckBox=function(e,t){!function(e,t){var n=new Set(b);n.has(t)&&!e?n.delete(t):!n.has(t)&&e&&n.add(t),y(n)}(e,t)},e.buttonAction===Mt.NEXT_STAGE?n.handleButtonClick=function(){s(c),d(c)}:e.buttonAction===Mt.NEXT_CARD&&(n.handleButtonClick=function(){return E(t)}),t<=O)return o.createElement(Wt,Object(r.__assign)({ref:m,key:t,cardIndex:c},n))})))})),Yt=Kt,Zt=i.a.forwardRef((function(e,t){e.workflowName;var n=e.workflowStages,o=void 0===n?[]:n,a=e.handleEditorOpenButtonClick,s=e.enableALSession,l=void 0!==s&&s,c=e.workflowLoadingUiStrings,u=void 0===c?["Working on it..."]:c,d=e.allowForwardNavigation,p=void 0!==d&&d,g=e.displayStatusIconInStepper,h=void 0===g||g,f=Object(r.__read)(i.a.useState(0),2),m=f[0],v=f[1],b=Object(r.__read)(i.a.useState(!0),2),y=b[0],C=b[1],O=Object(r.__read)(i.a.useState(0),2),S=O[0],E=O[1],x=i.a.useRef(),I=i.a.useRef();i.a.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n,r;y?null===(n=x.current)||void 0===n||n.addUserContentMessageItem(e,t):null===(r=I.current)||void 0===r||r.addUserContentMessageItem(e,t)}}})),i.a.useEffect((function(){o.map((function(e,t){var n,r,o;(null===(n=e.data)||void 0===n?void 0:n.componentRenderData)&&(null===(o=null===(r=e.data)||void 0===r?void 0:r.componentRenderData)||void 0===o||o.map((function(e,t){var n;e.addActionButtonProps&&(null===(n=e.addActionButtonProps)||void 0===n?void 0:n.isEditorNeedToOpen)&&(e.handleEditorOpenButtonClick=a)})))}))})),i.a.useEffect((function(){m>S&&E(m)}),[m,S]),i.a.useEffect((function(){}),[m]);var w=Object(r.__read)(i.a.useState(!1),2),T=w[0],k=w[1];i.a.useEffect((function(){T&&(o[m].shouldEnableNext&&o[m].shouldEnableNext()?k(!1):l||setTimeout((function(){k(!1)}),2e3))}));var j=function(e){var t,n;k(!0),(null===(t=o[e+1])||void 0===t?void 0:t.getComponentRenderData)&&(null===(n=o[e+1])||void 0===n||n.getComponentRenderData()),v(e)},P={loadingUiStrings:u},A=o.slice(1),_=function(e){var t=[];return e.forEach((function(e,n){t.push(e.useCompleteStageHeader?e.stageHeader:"Step "+(n+1)+": "+e.stageHeader)})),t}(A),D=o.map((function(e){return e.gotoNextStageString})),L=o[0];return L.onClickNextStage=function(){C(!1)},L.stageIndex=0,y?i.a.createElement(te,null,i.a.createElement(qt,Object(r.__assign)({ref:x},L))):i.a.createElement(te,null,i.a.createElement("div",{style:{height:"46px"}}),i.a.createElement(jt,{stages:_,gotoNextStageString:D,handleButtonClick:function(e){var t,n,r;(null===(t=A[m])||void 0===t?void 0:t.onClickNext)&&A[m].onClickNext(e),e>m&&(k(!0),(null===(n=o[e+1])||void 0===n?void 0:n.getComponentRenderData)&&(null===(r=o[e+1])||void 0===r||r.getComponentRenderData())),v(e)},index:m,lastEnabledStep:S,allowForwardNavigation:p,displayStatusIcon:h}),A.map((function(e,t){if(t===m){if(T)return i.a.createElement(Ht,Object(r.__assign)({key:t},P));var n=e;return e.stageIndex=t+1,e.onClickNextStage=j,i.a.createElement(Yt,Object(r.__assign)({ref:I,key:t},n))}})))})),Jt=n(3363),Xt=n(3392),$t=n(3354);var en,tn=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},freCard:null!==(n=e.freCard)&&void 0!==n?n:{},freImage:null!==(r=e.freImage)&&void 0!==r?r:{},freHeaderText:null!==(o=e.freHeaderText)&&void 0!==o?o:{},freDescriptionText:null!==(i=e.freDescriptionText)&&void 0!==i?i:{},freButton:null!==(a=e.freButton)&&void 0!==a?a:{}};return Object(X.a)(s)}({freCard:Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("12px")),{maxWidth:"288px"}),freHeaderText:{fontFamily:"-apple-system",lineHeight:"normal"},freDescriptionText:{marginTop:"12px",fontFamily:"-apple-system",lineHeight:"normal"},freButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("16px")),re.a.borderRadius("12px")),{minHeight:"52px",height:"auto",fontFamily:"-apple-system",fontWeight:"600",fontSize:"17px",justifyContent:"center"})}),nn=Object(Te.a)(y),rn={freCard:{},root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px","16px")),{alignItems:"center",textAlign:"center",color:nn.neutralPrimary,backgroundColor:nn.neutralLight,boxShadow:nn.shadow4}),re.a.margin("1px","16px","none")),re.a.border("1px","solid",nn.neutralLight)),re.a.borderRadius("8px")),freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:Object(r.__assign)(Object(r.__assign)({textAlign:"center",whiteSpace:"pre-wrap"},re.a.padding("1px")),re.a.margin("20px","0px","0px")),freButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:nn.neutralLight,width:"100%"},re.a.padding("5px","12px")),re.a.margin("20px","0px","0px")),re.a.borderRadius("4px")),{"@media (forced-colors: none)":Object(r.__assign)(Object(r.__assign)({backgroundColor:nn.themePrimary},re.a.border("none")),{":hover":Object(r.__assign)({color:nn.neutralLight,backgroundColor:nn.themePrimary},re.a.border("none")),":active":Object(r.__assign)({color:nn.neutralLight,backgroundColor:nn.themePrimary},re.a.border("none"))})})},on=Object(X.a)(rn),an=function(){return lt()?OfficeaicopilotStrings.FREHeaderTextLabel:"freSharedHeaderText"},sn=function(e){var t=e.headerText,n=void 0===t?lt()?OfficeaicopilotStrings.FREHeaderText:"Copilot is here to help!":t,r=e.descriptionText,a=e.freImagePath,s=e.handleFreButtonClick,l=void 0===s?function(){}:s,c=e.shouldFocusOnComponentMount,u=void 0!==c&&c,d=e.overrideStyles,p=function(){var e=on(),t=tn();Z()===Q.IOS&&gt(e,t);return e}();gt(p,d);var g=" "+n+" ",h=" "+r+" ";return Object(o.useEffect)((function(){var e;u&&(null===(e=document.getElementById("FreSharedId"))||void 0===e||e.focus())})),i.a.createElement(te,{style:p.root,customProperties:{role:nt,"aria-labelledby":an()}},i.a.createElement(Jt.a,{src:a,className:p.freImage,alt:""}),i.a.createElement(Xt.a,{id:an(),className:p.freHeaderText},g),i.a.createElement($t.a,{id:lt()?OfficeaicopilotStrings.FREDescriptionTextLabel:"freSharedDescription",className:p.freDescriptionText},h),i.a.createElement(se.a,{className:p.freButton,onClick:l},lt()?OfficeaicopilotStrings.FREButtonText:"Get started"))},ln=function(){return lt()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"zqmHeaderText"};var cn,un,dn,pn,gn=Object(Te.a)(y),hn=function(e){var t,n,r,o,i={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},cardHeader:null!==(r=e.cardHeader)&&void 0!==r?r:{},zeroQueryButton:null!==(o=e.zeroQueryButton)&&void 0!==o?o:{},zeroQueryButtonDisabled:{}};return Object(X.a)(i)}({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({maxWidth:"288px"},re.a.padding(gn.spacingVerticalM,gn.spacingHorizontalL)),{fontFamily:"-apple-system"}),re.a.margin(gn.spacingVerticalNone,gn.spacingHorizontalL,gn.spacingVerticalS)),{boxShadow:gn.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(r.__assign)({},re.a.gap(gn.spacingVerticalS)),zeroQueryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding(gn.spacingVerticalL,gn.spacingHorizontalXL)),{minHeight:"40px"}),re.a.borderRadius(gn.borderRadiusXLarge)),(en={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},en["& .".concat(bt.a.icon)]=Object(r.__assign)({},re.a.margin("0px","11px","0px","0px")),en))}),fn=Object(Te.a)(y),mn={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{boxShadow:fn.shadow4,color:fn.neutralPrimary,backgroundColor:fn.neutralLight}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",fn.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),cardHeader:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{whiteSpace:"pre-wrap"}),zeroQueryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",height:"40px",textAlign:"start",backgroundColor:fn.neutralLight},re.a.border("1px","solid",fn.neutralLighterAlt)),vt.a.body1),(cn={},cn["&:hover .".concat(bt.a.icon)]={color:fn.themePrimary},cn)),zeroQueryButtonDisabled:(un={color:fn.neutralQuaternary},un["&:hover .".concat(bt.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},un)},vn=Object(X.a)(mn),bn=i.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.headerText,o=e.handleButtonClick,a=void 0===o?function(e){console.log("suggestion clicked:"+e)}:o,s=function(){var e=vn(),t=hn();Z()===Q.IOS&&(e=gt(e,t));return e}(),l=T();gt(s,t),s.zeroQueryButtonDisabled=Object($.a)(s.zeroQueryButton,s.zeroQueryButtonDisabled),s.rootHighContrast=Object($.a)(s.root,s.rootHighContrast);return i.a.createElement(Ue.a,{className:l?s.rootHighContrast:s.root,"aria-labelledby":ln()},i.a.createElement(ce,null,i.a.createElement(xe.a,{id:ln(),className:s.cardHeader},r)),i.a.createElement(te,{style:s.buttonStack,customProperties:{role:it}},n.map((function(e,t){return i.a.createElement(se.a,{size:"large",role:at,icon:(r=e.iconRegular,o=e.iconHover,l=Object(Ve.a)(o,r),i.a.createElement(l,null)),key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":n.length,className:e.isDisabled?s.zeroQueryButtonDisabled:s.zeroQueryButton,onClick:function(){a(e.promptSuggestion)}},e.promptSuggestion);var r,o,l}))))})),yn=n(3581),Cn=n(2396),On=n(139),Sn=Object(Te.a)(y),En={root:Object(r.__assign)(Object(r.__assign)({},re.a.margin("16px")),re.a.gap("8px")),zeroQueryV2Button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",height:"auto",textAlign:"start",backgroundColor:On.a.colorNeutralBackground1},re.a.padding("12px","16px")),re.a.borderRadius("8px")),re.a.gap("8px")),vt.a.body1),(dn={boxShadow:On.a.shadow2},dn["&:hover"]={boxShadow:On.a.shadow8,backgroundColor:On.a.colorNeutralBackground1},dn["& .".concat(Cn.a.prompt)]={gridColumnStart:"icon"},dn)),zeroQueryHintText:{color:On.a.colorNeutralForeground4},zeroQueryIcon:{color:Sn.themePrimary}},xn=Object(X.a)(En),In=i.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.handleButtonClick,o=xn();gt(o,t);return i.a.createElement(te,{style:o.root,customProperties:{role:it}},n.map((function(e,t){var a,s,l=function(e){var t=et,n=et,r=e.lastIndexOf("]"),o=e.lastIndexOf("[",r);return r>o&&o>=0?(t=e.slice(0,o),n=e.slice(o,r+1)):t=e,{inputText:t,hintText:n}}(e.promptSuggestionText),c=l.inputText,u=l.hintText;return i.a.createElement(yn.a,{role:at,icon:(a=e.iconRegular,s=a,i.a.createElement(s,{className:o.zeroQueryIcon})),key:t,disabled:e.isDisabled||!1,"aria-posinset":t+1,"aria-setsize":n.length,className:o.zeroQueryV2Button,category:e.promptSuggestionCategory,prompt:i.a.createElement($t.a,null,c,i.a.createElement("span",{className:o.zeroQueryHintText},u)),onClick:function(){r(c,e.promptSuggestionText)}})})))})),wn=function(){return lt()?OfficeaicopilotStrings.LikeButtonLabel:"Like"},Tn=function(){return lt()?OfficeaicopilotStrings.DislikeButtonLabel:"Dislike"},kn=function(){return lt()?OfficeaicopilotStrings.SuggestionPaneLabel:"Suggested Prompts"},jn=n(831),Pn=n(1134);!function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(pn||(pn={}));var An,_n,Dn;!function(e){e.Dogfood="dogfood",e.Production="production"}(An||(An={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.TestApp="TestApp"}(_n||(_n={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(Dn||(Dn={}));var Ln=function(){return"undefined"!=typeof OfficeaicopilotStrings};function Mn(e,t){var n=Array.from(e),r=new Blob([new Uint8Array(n)],{type:t||"image/png"}),o=new FileReader;return o.readAsDataURL(r),new Promise((function(e,t){o.onload=function(){var t=o.result;e(t)},o.onerror=function(){t(o.error)}}))}var Bn,Rn=function(e){var t,n,i=e.clientSettings,a=e.hostTokenProvider,s=e.isAuthEnabled,l=e.isRehydration,c=e.turnId,u=e.hostCallback,d=e.fileCacheInfo,p=function(e,t){return void 0===e&&(e=An.Production),void 0===t&&(t=!0),e===An.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))}(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,s),g=(void 0===(n=null==i?void 0:i.selectedDesignerEnv)&&(n=An.Production),n===An.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):new URL("https://designerapp.officeapps.live.com")),h=(null==i?void 0:i.clientId)||Object(Pn.a)(),f=(null==i?void 0:i.sessionId)||Object(Pn.a)(),m=Object(Pn.a)(),v=null==i?void 0:i.hostAppName,b="".concat(v,"-").concat(f),y=null==i?void 0:i.platformType,C=null==i?void 0:i.hostBuildVersion,O="".concat(v,"-").concat(y),S=e.parentContainerIdentifier,E=o.useMemo((function(){var t,n,r,o,s,l;return{miniURL:p,serviceBaseURL:g,viewConfig:{view:jn.e.Chat,theme:null!==(t=null==i?void 0:i.designerTheme)&&void 0!==t?t:jn.d.Light,showFeedbackFooter:!0},fileCacheInfoConfig:{hostCallback:null!=u?u:function(e){console.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:d},telemetryConfig:{audienceGroup:"Other",clientId:h,clientName:null!=v?v:"unknown",hostBuildVersion:null!=C?C:"unknown",hostEnvironment:O,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:f,correlationId:m,platform:(l=null!==(n=null==i?void 0:i.platformType)&&void 0!==n?n:Dn.Web,l===Dn.iOS?{platform:"iOS"}:l===Dn.Web?{platform:"Web"}:l===Dn.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform},container:document.getElementById(S),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(r=e.preferredCtaButtonLabel)&&void 0!==r?r:jn.a.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(o=e.preferredImageFormat)&&void 0!==o?o:"png",hostTokenProvider:a,lng:null!==(s=null==i?void 0:i.uiLanguage)&&void 0!==s?s:"en-US"}}),[p,g,null==i?void 0:i.designerTheme,null==i?void 0:i.platformType,null==i?void 0:i.uiLanguage,u,d,h,v,C,O,f,m,S,e.preferredCtaButtonLabel,e.preferredImageFormat,a]),x=o.useCallback((function(e,t,n,o,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return[4,(s=new jn.b(Object(r.__assign)(Object(r.__assign)({},E),{container:document.getElementById(e)}))).initialize(Object(r.__assign)({turnId:c,isRehydration:l,scenario:b,minCount:3,maxCount:4},null!=t?t:{}))];case 1:return u.sent(),n&&s.on("done",n),o&&s.on("customize",o),a&&s.on("feedback",a),i&&s.on("AnswerCardResize",i),[2,s]}}))}))}),[E,l,b,c]);return{designerMiniSettings:E,initializeDesignerMini:x}},Fn=n(35),Nn=Object(Fn.db)({container:{borderRadius:"8px",height:"400px",padding:"6px 0px",gap:"4px",alignItems:"flex-start",position:"relative",zIndex:"1",overflowWrap:"anywhere"},lightThemePalette:{backgroundColor:"#FFFFFF",boxShadow:"0px 1px 2px  #00000024, 0px 0px 2px #0000001f"},darkThemePalette:{backgroundColor:"#292929",boxShadow:"0px 1px 2px  #FFFFFF24, 0px 0px 2px #FFFFFF1f"}}),Hn=function(e){var t,n,i=o.useMemo((function(){return Object(Pn.a)()}),[]),a=o.useRef(),s=o.useRef(!1),l=Ln()?OfficeaicopilotStrings.DesignerPreviewLabel:"Designer Preview",c=Rn({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:i,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo}),u=c.initializeDesignerMini,d=c.designerMiniSettings,p=o.useCallback((function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o,i,a,s;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return(null===(o=t.options)||void 0===o?void 0:o.isUrl)&&t.uri?(null===(i=e.insertImagesInCanvas)||void 0===i||i.call(e,t.uri,Object(r.__assign)(Object(r.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri})),[3,3]):[3,1];case 1:return[4,Mn(t.media,t.mimeType)];case 2:n=l.sent(),null===(a=e.insertImagesInCanvas)||void 0===a||a.call(e,n,Object(r.__assign)(Object(r.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(s=t.options)||void 0===s?void 0:s.isUrl)?t.uri:void 0})),l.label=3;case 3:return[2]}}))}))}),[e]),g=o.useCallback((function(e){var t=document.getElementById(i);t&&(t.style.height="".concat(e.height,"px"))}),[i]),h=o.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,d)}),[d,e]),f=o.useCallback((function(t){!function(e,t,n,r){e===jn.c.Like?r?null==t||t(r):null==t||t():e===jn.c.Dislike&&(r?null==n||n(r):null==n||n())}(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),m=o.useMemo((function(){return e.isStockQuery?{stockContent:e.stockImages,sourceDescription:e.imageType&&"enterprise"===e.imageType.toLowerCase()?(t=Ln()?OfficeaicopilotStrings.ChatCardSourceEnterprise:"From %s content library",n="enterprise",t.includes("%s")?t.replace("%s",n):t):Ln()?OfficeaicopilotStrings.ChatCardSourceStockContent:"From Microsoft 365 creative content library"}:e.dimensions?{dimensions:e.dimensions,text:e.userInput.trim()}:{text:e.userInput.trim(),sourceDescription:Ln()?OfficeaicopilotStrings.ChatCardSourceDALLE:"Powered by DALL-E 3"};var t,n}),[e.dimensions,e.isStockQuery,e.stockImages,e.userInput]);return o.useEffect((function(){s.current||u(i,m,p,h,g,f).then((function(e){a.current=e,s.current=!0})).catch((function(e){console.error(e)}))}),[m,u,g,h,p,f,i]),o.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&a.current&&a.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),o.createElement(o.Fragment,null,o.createElement("div",{id:i,key:i,className:"".concat(Nn.container," ").concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===jn.d.Dark?Nn.darkThemePalette:Nn.lightThemePalette),tabIndex:0,"aria-label":l}))},Un=n(3403),Vn=function(e){var t,n,r=Tt();return i.a.createElement(te,{style:r.root,customProperties:{role:it}},i.a.createElement(Un.a,{variant:"medium"},null!==(t=e.launchText)&&void 0!==t?t:"Welcome to Copilot Workflows! "),i.a.createElement(te,{horizontal:!0},i.a.createElement(ce,null,i.a.createElement(se.a,{appearance:"primary",style:{marginTop:"5px",borderBlockStyle:"dashed"},onClick:function(){var t;null===(t=e.onLaunch)||void 0===t||t.call(e)}},null!==(n=e.buttonText)&&void 0!==n?n:"Create Blog Post"))))},zn=n(1564),Gn=function(){return o.useContext(zn.a)},Wn=n(3579),Qn=Object(Te.a)(y),qn={stack:{},AccordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:Qn.neutralPrimary,marginBottom:"8px"},AccordionCardButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"},re.a.margin("5px","6px","0px","4px")),re.a.border("1px","solid",Qn.neutralLighterAlt)),re.a.borderRadius("4px")),re.a.padding("6px","10px","6px","6px")),(Bn={backgroundColor:"transparent",color:Qn.neutralPrimary,top:"0",zIndex:"1",float:"right",height:"auto"},Bn["& .".concat(bt.a.icon)]={fontSize:"inherit",height:"inherit",marginRight:"4px"},Bn["&:hover:enabled"]={color:Qn.black},Bn["&:focus"]={color:Qn.black},Bn["&:disabled"]=Object(r.__assign)(Object(r.__assign)({},re.a.borderColor(Qn.neutralPrimaryAlt)),{color:Qn.neutralQuaternary,backgroundColor:Qn.neutralTertiary}),Bn))},Kn=Object(X.a)(qn),Yn=function(e){var t=e.styles,n=e.cardButtons,r=gt(Kn(),t);return i.a.createElement(Wn.a,{horizontal:!0,wrap:!0},i.a.createElement(Wn.a,{horizontal:!0,className:r.AccordionCardFooter},null==n?void 0:n.map((function(e,t){return i.a.createElement(se.a,{tabIndex:0,key:t,className:r.AccordionCardButton,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:null==e?void 0:e.handleOnMouseEnter,onMouseLeave:null==e?void 0:e.handleOnMouseLeave,onFocus:null==e?void 0:e.handleOnMouseEnter,onBlur:null==e?void 0:e.handleOnMouseLeave},e.buttonText)}))))},Zn=Object(Te.a)(y),Jn={stack:{"> *":{marginBottom:"12px"}},contentCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",Zn.neutralLighterAlt)),re.a.margin("8px","20px","8px","15px")),re.a.padding("8px")),{boxShadow:Zn.shadow4,backgroundColor:Zn.neutralLight}),re.a.borderRadius(Zn.borderRadiusXLarge)),{overflowWrap:"anywhere",color:Zn.neutralPrimary}),contentHeader:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{marginBottom:"12px"})},Xn=Object(X.a)(Jn);function $n(e,t){return i.a.createElement(Yn,{styles:e,cardButtons:t})}var er,tr=function(e){var t,n,r=e.styles,o=e.body,a=gt(Xn(),r),s=o.renderHeader?o.renderHeader((function(){})):(null===(t=o.cardContent)||void 0===t?void 0:t.contentHeader)?i.a.createElement(xe.a,{className:a.contentHeader},o.cardContent.contentHeader):void 0,l=function(){var e;return null===(e=o.cardContent)||void 0===e?void 0:e.contentBody},c=o.renderBody?o.renderBody((function(){return l(o.cardContent)})):l(o.cardContent),u=o.renderFooter?o.renderFooter((function(){var e;return $n(r,null===(e=o.cardContent)||void 0===e?void 0:e.cardButtons)})):$n(r,null===(n=o.cardContent)||void 0===n?void 0:n.cardButtons);return i.a.createElement(te,{style:a.contentCard,customProperties:{tabIndex:-1}},s,c,u)};!function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(er||(er={}));var nr=function(e){return Object(X.a)({accordionCardRoot:{paddingTop:"5px",marginBottom:"8px",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",fontWeight:"400",lineHeight:"20px"},accordionCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({flexWrap:"wrap",backgroundColor:"".concat(e.palette.white)},re.a.border("1px","solid",e.palette.neutralLighterAlt)),re.a.borderRadius("8px")),{marginLeft:"15px",marginRight:"20px"}),re.a.gap("4px")),re.a.padding("8px")),{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)","> *":{marginBottom:"12px"}}),cardHeader:Object(r.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},re.a.margin("12px 12px 0 12px")),contentHeader:Object(r.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},re.a.margin("4px")),contentTitleGroup:{display:"block",width:"auto","> button":{marginLeft:"10px",marginTop:"5px",width:"16px",height:"16px",color:"".concat(e.palette.black),top:"0",zIndex:"1",float:"right",selectors:{":hover":{backgroundColor:"transparent",color:"".concat(e.palette.black)},":focus":{backgroundColor:"transparent",color:"".concat(e.palette.black)}},"> i":{fontSize:"12px"}}}})},rr=n(1852),or=function(e){var t=e.index,n=i.a.useRef(),o=Object(r.__read)(i.a.useState(!1),2),a=o[0],s=o[1],l=function(e){var t;s(!a),null===(t=n.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault()},c=Gn(),u=nr(c)(),d={styles:e.styles,feedbackSectionPosition:er.None,shouldShowAIGeneratedIndicator:!0,body:{cardContent:e.cardContent,renderHeader:function(n){if(void 0!==e.cardContent){var r=i.a.createElement(rr.a,{id:"RelatedQuestionExpand".concat(t),iconProps:{iconName:"ChevronDown"},onClick:l,"data-is-focusable":!1,tabIndex:-1,ariaLabel:""});return i.a.createElement(te,null,i.a.createElement(te,{style:Object($.a)(u.contentTitleGroup,e.styles.contentTitleGroup)},i.a.createElement(Un.a,{className:u.contentHeader},e.cardContent.contentHeader),r),a&&e.cardContent.contentBody?n():void 0)}},renderBody:function(t){if(a&&e.cardContent.contentBody)return t()},renderFooter:function(t){return a&&e.cardContent.contentBody?t():null}}};return i.a.createElement(tr,Object(r.__assign)({key:t,styles:e.styles},d))},ir=function(e,t){if(!t.cardContent.length)return null;try{if(1===t.cardContent.length){var n={styles:e,feedbackSectionPosition:er.None,body:{cardContent:t.cardContent[0],renderHeader:function(){return i.a.createElement(Un.a,{className:e.contentHeader},t.cardContent[0].contentHeader)}}};return i.a.createElement(te,null,i.a.createElement(tr,Object(r.__assign)({key:0},n)))}return i.a.createElement(te,null,t.cardContent.map((function(t,n){return i.a.createElement(or,{key:n,index:n,styles:e,cardContent:t})})))}catch(e){return null}},ar=function(e){var t=e.styles,n=e.body,r=Gn(),o=nr(r)(),a={role:ot,"aria-live":"assertive",tabIndex:0};return i.a.createElement(te,{style:Object($.a)(o.accordionCardRoot,t.accordionCardRoot),customProperties:a},i.a.createElement(te,{style:Object($.a)(o.accordionCard,t.accordionCard),customProperties:{tabIndex:-1}},i.a.createElement(te,null,i.a.createElement(Un.a,{className:o.cardHeader},n.cardHeader),ir(o,n))))},sr=function(e){var t,n,r,o,i,a,s,l,c,u;return{buttonBarRoot:null!==(t=e.buttonBarRoot)&&void 0!==t?t:{},primaryButton:null!==(n=e.primaryButton)&&void 0!==n?n:{},defaultButton:null!==(r=e.defaultButton)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{},combinedButtonIcon:null!==(i=e.combinedButtonIcon)&&void 0!==i?i:{},iconButton:null!==(a=e.iconButton)&&void 0!==a?a:{},combinedButton:null!==(s=e.combinedButton)&&void 0!==s?s:{},minifiedButton:null!==(l=e.minifiedButton)&&void 0!==l?l:{},showMeButton:null!==(c=e.showMeButton)&&void 0!==c?c:{},showMeButtonBarRoot:null!==(u=e.showMebuttonBarRoot)&&void 0!==u?u:{}}};function lr(e){var t=sr(e);return Object(X.a)(t)}var cr,ur,dr,pr,gr={combinedButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:"40px",minWidth:"40px"},re.a.padding("4px","8px")),vt.a.caption1),{fontFamily:"-apple-system",lineHeight:"normal"})},hr=(lr(gr),Object(Te.a)(y)),fr=Object(r.__assign)(Object(r.__assign)({backgroundColor:hr.neutralLight},re.a.border("1px","solid",hr.neutralLighterAlt)),re.a.borderRadius(hr.borderRadiusMedium)),mr=Object(r.__assign)({height:"16px",width:"16px"},re.a.padding(0)),vr=Object(r.__assign)(Object(r.__assign)({height:"24px",minWidth:"20px"},re.a.padding("4px","8px")),vt.a.caption1),br={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px"},showMeButtonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row"},primaryButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",hr.themeSecondary)),re.a.borderRadius(hr.borderRadiusMedium)),{"@media (forced-colors: none)":{backgroundColor:hr.themeSecondary,"&:hover":Object(r.__assign)({backgroundColor:hr.themePrimary},re.a.border("1px","solid",hr.themePrimary)),"&:active":Object(r.__assign)({backgroundColor:hr.themePrimary},re.a.border("1px","solid",hr.themePrimary)),"&:disabled":Object(r.__assign)({backgroundColor:hr.neutralLighter},re.a.border("1px","solid",hr.neutralQuaternary)),"&:hover:active":Object(r.__assign)({backgroundColor:hr.themeTertiary},re.a.border("1px","solid",hr.themeTertiary))}}),defaultButton:Object(r.__assign)({},fr),showMeButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:hr.neutralLight},re.a.border("1px","solid",hr.neutralLighterAlt)),re.a.borderRadius(hr.borderRadiusMedium)),{"&:hover":{color:hr.themePrimary}}),icon:Object(r.__assign)(Object(r.__assign)({height:"24px",width:"24px"},re.a.padding(0)),(cr={},cr["&".concat(bt.a.icon)]={height:"20px",width:"20px"},cr)),combinedButtonIcon:Object(r.__assign)(Object(r.__assign)({},mr),(ur={},ur["&".concat(bt.a.icon)]={height:"16px",width:"16px"},ur)),iconButton:Object(r.__assign)({height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},re.a.padding("2px")),combinedButton:Object(r.__assign)({},vr),minifiedButton:(dr={height:"40px",width:"44px",minWidth:"44px"},dr["&".concat(bt.a.icon)]={height:"24px",width:"24px"},dr)},yr=(Object(X.a)(br),Object(X.a)({emptyIcon:{height:"0px",width:"0px"}}),Object(X.a)({authButton:Object(r.__assign)(Object(r.__assign)({},fr),vr),appIcon:Object(r.__assign)({},mr),title:Object(r.__assign)({},vt.a.caption1)})),Cr=function(e){var t,n,r,o,i,a,s,l;return{footerBar:null!==(t=e.footerBar)&&void 0!==t?t:{},headerBar:null!==(n=e.headerBar)&&void 0!==n?n:{},feedbackButton:null!==(r=e.feedbackButton)&&void 0!==r?r:{},feedbackButtonsStack:null!==(o=e.feedbackButtonsStack)&&void 0!==o?o:{},feedbackText:null!==(i=e.feedbackText)&&void 0!==i?i:{},feedbackTextMinified:null!==(a=e.feedbackTextMinified)&&void 0!==a?a:{},feedbackDisclaimerStack:null!==(s=e.feedbackDisclaimerStack)&&void 0!==s?s:{},tooltipText:null!==(l=e.tooltipText)&&void 0!==l?l:{}}};var Or,Sr,Er,xr,Ir=Object(Te.a)(y),wr={feedbackTextMinified:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:Ir.neutralSecondaryAlt,fontFamily:"-apple-system",lineHeight:"normal"}),feedbackButton:Object(r.__assign)(Object(r.__assign)({width:"44px",height:"44px",maxWidth:"unset",lineHeight:"normal",backgroundColor:"transparent"},re.a.border("0px")),(pr={},pr["&:hover .".concat(bt.a.icon)]={cursor:"pointer",color:Ir.themePrimary},pr)),tooltipText:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:Ir.neutralPrimary,fontFamily:"-apple-system",lineHeight:"normal"})},Tr=function(){return wr},kr=(Or=Cr(wr),Object(X.a)(Or),Object(Te.a)(y)),jr={footerBar:Object(r.__assign)(Object(r.__assign)({},re.a.padding("4px","0px")),{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}),headerBar:Object(r.__assign)({},re.a.padding("0px","4px")),feedbackText:Object(r.__assign)(Object(r.__assign)({},vt.a.caption2),{color:kr.neutralSecondaryAlt}),feedbackTextMinified:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:kr.neutralSecondaryAlt}),feedbackButtonsStack:Object(r.__assign)({alignItems:"center"},re.a.gap("2px")),feedbackButton:(Sr={backgroundColor:"transparent"},Sr["&:hover .".concat(bt.a.icon)]={cursor:"pointer",color:kr.themePrimary},Sr),feedbackDisclaimerStack:Object(r.__assign)({alignItems:"center"},re.a.gap("2px")),tooltipText:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:kr.neutralPrimary})},Pr=(Object(X.a)(jr),lr({buttonBarRoot:{marginTop:"0px",width:"auto"},minifiedButton:Object(r.__assign)({},Tr().feedbackButton),icon:{}})),Ar=function(e){var t,n,o,i,a,s,l,c;return Object(r.__assign)(Object(r.__assign)({defaultRoot:null!==(t=e.defaultRoot)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},human:null!==(o=e.human)&&void 0!==o?o:{},humanContent:null!==(i=e.humanContent)&&void 0!==i?i:{},chat:null!==(a=e.chat)&&void 0!==a?a:{},chatContent:null!==(s=e.chatContent)&&void 0!==s?s:{},chatCard:null!==(l=e.chatCard)&&void 0!==l?l:{},text:null!==(c=e.text)&&void 0!==c?c:{},strikeThroughText:{},cardHighContrast:{}},sr(e)),Cr(e))},_r={chatCard:Object(r.__assign)({width:"inherit"},re.a.padding("16px")),text:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{fontFamily:"-apple-system",lineHeight:"normal"})},Dr=function(e){return Object(X.a)(Ar(e))}(_r),Lr=Object(Te.a)(y),Mr=Object(r.__assign)(Object(r.__assign)({defaultRoot:Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),{alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"}),loader:Object(r.__assign)({boxSizing:"border-box",display:"flex",width:"inherit"},re.a.gap("4px")),human:{alignSelf:"flex-end",maxWidth:"80%"},humanContent:{color:Lr.black,backgroundColor:Lr.themeLight},chat:{width:"100%",alignSelf:"flex-start",boxShadow:Lr.shadow2},chatContent:{backgroundColor:Lr.neutralLight},chatCard:Object(r.__assign)({width:"inherit"},re.a.padding("12px")),text:Object(r.__assign)({},vt.a.body1),strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:Object(r.__assign)({},re.a.border("1px","solid",Lr.neutralLighterAlt))},(Er=br,xr=gr,Z()===Q.IOS?Object(r.__assign)(Object(r.__assign)({},Er),xr):Object(r.__assign)({},Er))),function(){var e=jr,t=Tr();return Z()===Q.IOS?Object(r.__assign)(Object(r.__assign)({},e),t):Object(r.__assign)({},e)}()),Br=function(){var e=Mr,t=_r;return Z()===Q.IOS?Object(r.__assign)(Object(r.__assign)({},e),t):Object(r.__assign)({},e)},Rr=Object(X.a)(Mr),Fr={colorBrandFlair1:Lr.themeDarkAlt,colorBrandFlair2:Lr.themeLighterAlt,colorBrandFlair3:Lr.themeLighter,colorBrandFlair1Transparent:Lr.themeDarkAltTransparent,colorBrandFlair2Transparent:Lr.themeLighterAltTransparent,colorBrandFlair3Transparent:Lr.themeLighterTransparent},Nr=Object(Te.a)(y),Hr=Object(r.__assign)({adaptiveCardRoot:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{color:Nr.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":Object(r.__assign)({},re.a.border("1px","solid",Nr.neutralQuaternaryAlt)),"& p":{display:"inline"},"& .ac-textBlock":{overflowWrap:"anywhere",display:"inline !important"},"& .ac-adaptiveCard":{display:"inline !important"}})},Br()),Ur=Object(X.a)(Hr);function Vr(e){var t=e.renderData,n=e.fallbackElement,o=e.customMessageRenderers;if(!t||!o)return i.a.createElement(i.a.Fragment,null,n);var a=o.renderers[t.component];return a?i.a.createElement(a,Object(r.__assign)({},t.props)):o.renderFallback(t)}var zr,Gr,Wr=n(2419),Qr=n(3563),qr=function(e){if(!e)return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0};try{var t=e.messageExtensionPluginInfo.errorType,n=e.oAuthCard.buttons.length&&e.oAuthCard.buttons[0].value,r=JSON.parse(e.messageExtensionPluginInfo.failedActivity),o=null==r?void 0:r.request;if(!o)throw new Error("Failed to parse pluginAuthError");return{requestType:t,authUrl:n,botInvokeRequest:{botId:o.msaAppId,appId:o.metaOsAppId,requestBody:{name:o.name,value:o.value}},appId:o.metaOsAppId}}catch(e){return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0}}},Kr=n(3349),Yr=n(3351),Zr=n(3352),Jr=function(e){var t=e.children,n=e.popoverTitle,a=e.popoverDuration,s=Object(r.__read)(Object(o.useState)(!1),2),l=s[0],c=s[1],u=Object(o.useRef)(void 0);return Object(o.useEffect)((function(){l&&(u.current&&clearTimeout(u.current),u.current=window.setTimeout((function(){c(!1),u.current=void 0}),null!=a?a:2e3)),l||void 0===u.current||(clearTimeout(u.current),u.current=void 0)}),[a,l]),i.a.createElement(Kr.a,{withArrow:!0,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:l,onOpenChange:function(e,t){var n;c(null!==(n=t.open)&&void 0!==n&&n)}},i.a.createElement(Yr.a,null,t),i.a.createElement(Zr.a,{"aria-live":"assertive"},n))};!function(e){e.Primary="Primary",e.Default="Default"}(zr||(zr={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(Gr||(Gr={}));var Xr,$r,eo,to=function(e,t,n,r,o,a){var s=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},l=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};console.log(e.text);var c,u,d,p=e.text?t.combinedButton:t.minifiedButton;return i.a.createElement(se.a,{tabIndex:0,key:o,appearance:e.type==zr.Primary?"primary":void 0,className:e.type==zr.Primary?Object($.a)(p,t.primaryButton):p,icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(c=e.iconRegular,u=e.iconHover,d=Object(Ve.a)(u,c),i.a.createElement(d,null)):i.a.createElement(e.iconRegular,null),className:t.icon}:void 0,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,a)},onMouseEnter:s,onMouseLeave:l,onFocus:s,onBlur:l,disabled:e.isDisabled},null==e?void 0:e.text)},no=function(e){var t=e.actionBarButtons,n=e.styles,o=e.messageContentElementId,a=e.chatCardIndex,s=e.telemetryData,l=void 0===s?"":s;return i.a.createElement(te,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?i.a.createElement(Jr,Object(r.__assign)({key:t},e.popoverProps),to(e,n,o,a,t,l)):to(e,n,o,a,t,l)})))},ro=n(3523),oo=function(e,t,n,r,o,a){var s,l,c,u=e.text?t.combinedButton:t.iconButton,d=e.type==zr.Primary?t.primaryButton:t.defaultButton,p=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},g=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};return i.a.createElement(se.a,{tabIndex:0,key:o,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,appearance:e.type==zr.Primary?"primary":void 0,className:Object($.a)(u,d),icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(s=e.iconRegular,l=e.iconHover,c=Object(Ve.a)(l,s),i.a.createElement(c,null)):i.a.createElement(e.iconRegular,null),className:(null==e?void 0:e.text)?t.combinedButtonIcon:t.icon}:void 0,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,a)},onMouseEnter:p,onMouseLeave:g,onFocus:p,onBlur:g,disabled:e.isDisabled},null==e?void 0:e.text)},io=function(e){var t=e.actionBarButtons,n=e.styles,o=e.messageContentElementId,a=e.chatCardIndex,s=e.telemetryData,l=void 0===s?"":s,c=e.pluginAuthButtonProps;return i.a.createElement(te,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?i.a.createElement(Jr,Object(r.__assign)({key:t},e.popoverProps),oo(e,n,o,a,t,l)):oo(e,n,o,a,t,l)})),c&&i.a.createElement(ro.a,Object(r.__assign)({},c,{customStyles:yr})))},ao=function(e){return J()?i.a.createElement(no,Object(r.__assign)({},e)):i.a.createElement(io,Object(r.__assign)({},e))},so=n(3361),lo=n(3401),co=n(3393),uo=n(3347),po=n(2841);!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(Xr||(Xr={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}($r||($r={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(eo||(eo={}));var go=function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}};function ho(e){var t=go(e);return Object(X.a)(t)}var fo=ho({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),mo=Object(Te.a)(y),vo=ho({tooltipText:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:mo.neutralPrimary}),badgeText:Object(r.__assign)({},vt.a.caption2Strong),tooltipStack:Object(r.__assign)({},re.a.gap("6px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),bo=function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n])},yo=function(e){var t=e.styles,n=e.clpSensitivityIndicatorData,r=function(){var e=vo(),t=fo();Z()===Q.IOS&&bo(e,t);return e}();return bo(r,t),i.a.createElement(so.a,{content:i.a.createElement(te,{style:r.tooltipStack},i.a.createElement("span",{className:r.tooltipText},n.tooltipText),n.badgeText&&i.a.createElement(co.a,{shape:"rounded",appearance:"filled",color:"informative",className:r.badgeText},n.badgeText)),relationship:"label"},i.a.createElement("span",{className:r.icon,tabIndex:0},n.icon?i.a.createElement(n.icon,null):function(e){switch(void 0===e&&(e=eo.NonEncryption),e){case eo.Encryption:return J()?i.a.createElement(uo.q,null):i.a.createElement(uo.o,null);case eo.Warning:return J()?i.a.createElement(po.e,null):i.a.createElement(po.c,null);case eo.NonEncryption:default:return J()?i.a.createElement(uo.m,null):i.a.createElement(uo.k,null)}}(n.iconType)))},Co=function(e,t){var n=Object(Ve.a)(t,e);return i.a.createElement(n,null)},Oo=function(e,t){return i.a.createElement(so.a,{content:i.a.createElement(xe.a,{className:e.tooltipText},t?qe():Qe()),relationship:"description"},i.a.createElement(xe.a,{className:e.feedbackTextMinified},t?lt()?OfficeaicopilotStrings.AIPowered:"AI-powered suggestion":lt()?OfficeaicopilotStrings.AIGenerated:"AI generated"))},So=function(e,t){return i.a.createElement(xe.a,{className:e.feedbackText},t?qe():Qe())},Eo=function(e){var t=e.styles,n=e.feedbackData,o=e.shouldShowAIGeneratedIndicator,a=void 0===o||o,s=e.shouldShowAIPoweredIndicator,l=e.displayPosition,c=e.shouldShowFeedbackButtons,u=void 0===c||c,d=e.handleThumbsUpClick,p=e.handleThumbsDownClick,g=e.showMinifiedUI,h=void 0!==g&&g,f=e.clpSensitivityIndicatorData,m=void 0===f?void 0:f,v=e.telemetryData,b=void 0===v?"":v,y=e.actionBarProps;t.headerBar=Object($.a)(t.footerBar,t.headerBar);var C=J()?lo.d:lo.b,O=J()?lo.c:lo.a,S=J()?lo.h:lo.f,E=J()?lo.g:lo.e;return y.styles=gt(y.styles,Pr()),i.a.createElement(te,{horizontal:!0,reverse:!0,customProperties:{tabIndex:-1},style:l===er.Header?t.headerBar:t.footerBar},i.a.createElement(ce,null,i.a.createElement(te,{horizontal:!0,style:t.feedbackButtonsStack},y&&i.a.createElement(ao,Object(r.__assign)({},y)),u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(se.a,{title:wn(),"aria-label":wn(),appearance:"transparent",size:"small",className:t.feedbackButton,icon:Co(S,E),onClick:function(e){var t=e.target.closest("button");null==n?d():d(n,b,t)}}),i.a.createElement(se.a,{title:Tn(),className:t.feedbackButton,"aria-label":Tn(),appearance:"transparent",size:"small",icon:Co(C,O),onClick:function(e){var t=e.target.closest("button");null==n?p():p(n,b,t)}})))),i.a.createElement(ce,null,i.a.createElement(te,{horizontal:!0,style:t.feedbackDisclaimerStack},m&&i.a.createElement(yo,{styles:t,clpSensitivityIndicatorData:m}),a&&(h?Oo(t,s):So(t,s)))))},xo=n(3551),Io=n(3562),wo=n(3561),To=n(3382),ko=n(1826),jo=n(724),Po=n(3359),Ao=function(e){var t=e.referenceType,n=e.iconAppName,r=e.iconUrl,o=e.authorEmail,a=e.authorName;if(t===Xr.Internal){if(n===$r.Word||n===$r.OneNote)return i.a.createElement(jo.a,null);if(n===$r.PowerPoint)return i.a.createElement(At.a,null)}else if(t===Xr.CrossApp){if(r)return i.a.createElement(Jt.a,{src:r,alt:null!=n?n:"",height:20,width:20});if(n)switch(n){case $r.Word:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:n,height:20,width:20});case $r.PowerPoint:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:n,height:20,width:20});case $r.Excel:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:n,height:20,width:20});case $r.OneNote:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg",alt:n,height:20,width:20});case $r.Visio:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg",alt:n,height:20,width:20});case $r.Loop:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg",alt:n,height:20,width:20});case $r.Txt:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg",alt:n,height:20,width:20});case $r.SharePoint:return i.a.createElement(Jt.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg",alt:n,height:20,width:20});case $r.Event:case $r.Meeting:return i.a.createElement(Po.c,null);case $r.Pdf:return i.a.createElement(jo.b,null);case $r.Teams:case $r.Outlook:return a||o?i.a.createElement(ko.a,{size:20,name:a||o}):i.a.createElement(d.a,null);case $r.Topic:return i.a.createElement(Jt.a,{src:"../assets/topic-icon.svg",alt:n,height:20,width:20})}}return i.a.createElement(d.a,null)},_o=function(e){return{index:e.referenceIndex,label:i.a.createElement(To.a,{appearance:"subtle",href:e.referenceProps.url,target:"_blank",onClick:function(){return Do(e)}},e.referenceProps.title),primaryText:e.referenceProps.primarySubtitle,secondaryText:e.referenceProps.secondarySubtitle,excerpt:e.referenceProps.snippet,media:i.a.createElement(Ao,{referenceType:e.referenceProps.referenceType,iconAppName:e.referenceProps.iconAppName,iconUrl:e.referenceProps.iconUrl,authorEmail:e.referenceProps.authorEmail,authorName:e.referenceProps.authorName}),sensitivityLabel:void 0!==e.referenceProps.sensitivityLabel?i.a.createElement("span",null,e.referenceProps.sensitivityLabel):void 0}},Do=function(e,t){e.referenceProps.onClickCitationLink&&e.referenceProps.onClickCitationLink(e.referenceIndex,e.referenceProps.path,t)},Lo=function(e){var t=e.references,n=(e.telemetryData,e.styles,(t=Mo(t)).length>1?lt()?OfficeaicopilotStrings.CitationTitleReferences:"References":lt()?OfficeaicopilotStrings.CitationTitleReference:"Reference");return i.a.createElement(te,null,i.a.createElement(xo.a,{label:"".concat(t.length," ")+n},i.a.createElement(Io.a,null,t.map((function(e,t){return i.a.createElement(wo.a,Object(r.__assign)({key:t},_o(e)))})))))},Mo=function(e){var t,n,o=[],i=function(e){o.some((function(t){return t.referenceIndex===e.referenceIndex}))||o.push(e)};try{for(var a=Object(r.__values)(e),s=a.next();!s.done;s=a.next()){i(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},Bo=function(e){var t,n,a,s=e.styles,l=e.body,c=e.feedbackData,u=e.shouldShowAIGeneratedIndicator,d=void 0===u||u,p=e.shouldShowAIPoweredIndicator,g=e.shouldShowFeedbackButtons,h=void 0===g||g,f=e.feedbackSectionPosition,m=void 0===f?er.None:f,v=e.showAnimation,b=void 0===v||v,y=e.handleThumbsDownClick,C=e.handleThumbsUpClick,O=e.actionBarButtons,S=e.chatCardIndex,E=e.showMinifiedUI,x=void 0!==E&&E,I=e.strikeThroughText,w=void 0!==I&&I,k=e.references,j=void 0===k?[]:k,P=e.clpSensitivityIndicatorData,A=void 0===P?void 0:P,_=e.telemetryData,D=void 0===_?"":_,L=e.pluginAuthError,M=void 0===L?void 0:L,B=e.pluginServiceProvider,R=void 0===B?void 0:B,F=null!==(t=l.user)&&void 0!==t?t:"chat",N="human"!==l.user&&b,H=Object(r.__read)(Object(o.useState)(N),2),U=H[0],V=H[1],z=i.a.useMemo((function(){return qr(M)}),[M]),G=z.requestType,W=z.authUrl,Q=z.botInvokeRequest;Object(o.useEffect)((function(){N&&V(!0)}),[N]),Object(o.useEffect)((function(){U&&V(!1)}),[U]);var q=T(),K=!!M&&G&&W&&Q&&(null==R?void 0:R.activityProvider)&&(null===(n=null==R?void 0:R.cardServices)||void 0===n?void 0:n.appService),Y=((null==O?void 0:O.length)>0||K)&&"human"!==F,Z=(m==er.Header||m==er.Footer&&J())&&"human"!==F,X=!Z&&m==er.Footer&&"human"!==F,ee=j.length>0,te=Object(Pn.a)(),ne=null==O?void 0:O.filter((function(e){return e.position===Gr.FeedbackSection})),re={actionBarButtons:null==O?void 0:O.filter((function(e){return e.position!==Gr.FeedbackSection})),styles:s,messageContentElementId:te,chatCardIndex:S,telemetryData:D,pluginAuthButtonProps:K?{requestType:G,url:W,originalBotInvokeRequest:Q,activityProvider:null==R?void 0:R.activityProvider,appService:null===(a=null==R?void 0:R.cardServices)||void 0===a?void 0:a.appService}:void 0},oe={styles:s,feedbackData:c,shouldShowAIGeneratedIndicator:d,shouldShowAIPoweredIndicator:p,shouldShowFeedbackButtons:h,displayPosition:m,handleThumbsDownClick:y,handleThumbsUpClick:C,showMinifiedUI:!!J()||x,clpSensitivityIndicatorData:A,telemetryData:D,actionBarProps:{actionBarButtons:ne,styles:Object(r.__assign)({},s),messageContentElementId:te,chatCardIndex:S,telemetryData:D}},ie=function(e,t,n,r){var o={};return o.defaultRoot=Object($.a)(e.defaultRoot,e[t]),n&&(o.defaultRoot=Object($.a)(o.defaultRoot,e.cardHighContrast)),o.loader=e.loader,o.chatCard=Object($.a)(e.chatCard,"human"===t?e.humanContent:e.chatContent),o.strikeThroughText=r?e.strikeThroughText:"",o}(s,F,q,w),ae=i.a.createElement(i.a.Fragment,null,Z&&i.a.createElement(Eo,Object(r.__assign)({},oe)),i.a.createElement("div",{id:"".concat(te),className:ie.strikeThroughText},l.element),Y&&i.a.createElement(ao,Object(r.__assign)({},re)),X&&i.a.createElement(Eo,Object(r.__assign)({},oe)),ee&&i.a.createElement(Lo,{references:j,styles:s,telemetryData:D}));return i.a.createElement(Wr.a,{className:ie.defaultRoot,themeExtension:Fr},"human"===F?i.a.createElement(Qr.a,{className:ie.chatCard},ae):i.a.createElement(Ue.a,{isLoading:U,"aria-live":"assertive",className:ie.chatCard},ae))},Ro=n(146),Fo=function(e){var t=e.styles,n=e.onClickShowMeButton,r=e.onClickHelpButton,o=t.combinedButton,a=t.showMeButton;return i.a.createElement(te,{style:t.showMeButtonBarRoot,customProperties:{tabIndex:-1}},i.a.createElement(se.a,{tabIndex:0,"aria-label":Ze(),className:Object($.a)(o,a),onClick:n},Ze()),r&&i.a.createElement(se.a,{tabIndex:0,"aria-label":Je,className:Object($.a)(o,a),icon:i.a.createElement(Ro.V,null),onClick:r},Je))},No=n(3550),Ho=function(e){var t=e.referenceIndex,n=e.referenceProps,o=e.telemetryData,a=void 0===o?"":o,s=i.a.createElement(wo.a,Object(r.__assign)({layout:"popover"},_o({referenceIndex:t,referenceProps:n})));return i.a.createElement(No.a,{popover:s,onClick:function(){void 0!==n.url&&window.open(n.url,"_blank"),n.onClickCitationLink&&n.onClickCitationLink(t,n.path,a)},popoverSurface:{tabIndex:0,style:{overflowWrap:"anywhere"}}},t)},Uo=function(e){var t,n,r,o,a,s,l=e.styles,c=e.richText,u=e.renderTextWithCitation,d=void 0===u?function(e){return null}:u,p=e.references,g=void 0===p?[]:p;c.linkText&&(null===(t=c.linkText.linkSuffix)||void 0===t?void 0:t.includes("%s"))&&(c.text+=c.linkText.linkSuffix.substring(0,c.linkText.linkSuffix.indexOf("%s")),c.linkText.linkSuffix=c.linkText.linkSuffix.substring(c.linkText.linkSuffix.indexOf("%s")+2));return i.a.createElement("span",null,i.a.createElement(xe.a,{block:!0,className:Object($.a)(l.text,l.richTextRoot)},c.text?ft(c.text,g)?d(c.text):c.text:"",c.linkText&&i.a.createElement(To.a,{target:c.linkText.linkUrl?"_blank":"",href:null!==(n=c.linkText.linkUrl)&&void 0!==n?n:"#",className:Object($.a)(l.linkText,c.linkText.linkUrl?"":l.linkButton),onClick:function(){c.linkText.linkUrl||c.linkText.linkOnClick()}},c.linkText.text),(null===(r=c.linkText)||void 0===r?void 0:r.linkSuffix)?ft(null===(o=c.linkText)||void 0===o?void 0:o.linkSuffix,g)?d(null===(a=c.linkText)||void 0===a?void 0:a.linkSuffix):null===(s=c.linkText)||void 0===s?void 0:s.linkSuffix:""))},Vo=function(e){var t=e.styles,n=e.body,o=e.strikeThroughText,a=void 0!==o&&o,s=e.references,l=void 0===s?[]:s,c=e.handleShowMeOnClick,u=void 0===c?null:c,d=e.telemetryData,p=void 0===d?"":d,g=Object($.a)(t.text,t.rootStack);a&&(g=Object($.a)(t.text,t.strikeThroughText,t.rootStack));var h={styles:t,onClickShowMeButton:u,onClickHelpButton:null},f=function(e){var t=function(e,t){for(var n=[],r=e.search("%c"),o=function(){var o=e.slice(r+2).search("%c");if(-1===o)return"break";o+=r+2;var i=parseInt(e.slice(r+2,o));n.push({message:e.slice(0,r),references:[t.find((function(e){return e.referenceIndex===i}))]}),e=e.slice(o+2),r=e.search("%c")};-1!==r&&"break"!==o(););return n}(e,l);return t.map((function(e,t){return i.a.createElement("span",{key:t},e.message,e.references&&e.references.map((function(e,t){return i.a.createElement(Ho,Object(r.__assign)({},e,{key:t,telemetryData:p}))})))}))};return i.a.createElement(te,{style:g},n.messageHeader&&(n.messageHeader.text||n.messageHeader.linkText)&&i.a.createElement(te,{style:t.messageHeader},i.a.createElement(Uo,{styles:t,richText:n.messageHeader,references:l,renderTextWithCitation:f})),n.embeddedLists&&n.embeddedLists.map((function(e,n){return i.a.createElement(te,{key:n,style:t.listStackStyle},e.listHeader&&i.a.createElement(xe.a,{className:Object($.a)(t.text,t.listHeader)},ft(e.listHeader,l)?f(e.listHeader):e.listHeader),e.listItems&&e.listItems.length>0&&i.a.createElement("ul",{className:t.list},e.listItems.map((function(e,n){return i.a.createElement(xe.a,{block:!0,key:n,className:t.text},i.a.createElement("li",null,e.title&&i.a.createElement("span",{className:t.listItemTitle},ft(e.title,l)?f(e.title):e.title),ft(e.text,l)?f(e.text):e.text))}))),e.listFooter&&(e.listFooter.text||e.listFooter.linkText)&&i.a.createElement(te,{style:t.listFooter},i.a.createElement(Uo,{styles:t,richText:e.listFooter,references:l,renderTextWithCitation:f})))})),n.messageFooter&&(n.messageFooter.text||n.messageFooter.linkText)&&i.a.createElement(te,{style:t.messageFooter},i.a.createElement(Uo,{styles:t,richText:n.messageFooter,references:l,renderTextWithCitation:f})),u&&i.a.createElement(Fo,Object(r.__assign)({},h)))},zo=function(e){return Object(X.a)(function(e){var t,n,o,i,a,s,l,c,u,d,p;return Object(r.__assign)({rootStack:null!==(t=e.rootStack)&&void 0!==t?t:{},messageHeader:null!==(n=e.messageHeader)&&void 0!==n?n:{},messageFooter:null!==(o=e.messageFooter)&&void 0!==o?o:{},listStackStyle:null!==(i=e.listStackStyle)&&void 0!==i?i:{},list:null!==(a=e.list)&&void 0!==a?a:{},listHeader:null!==(s=e.listHeader)&&void 0!==s?s:{},listFooter:null!==(l=e.listFooter)&&void 0!==l?l:{},linkText:null!==(c=e.linkText)&&void 0!==c?c:{},linkButton:null!==(u=e.linkButton)&&void 0!==u?u:{},listItemTitle:null!==(d=e.listItemTitle)&&void 0!==d?d:{},richTextRoot:null!==(p=e.richTextRoot)&&void 0!==p?p:{}},Ar(e))}(e))}({linkText:{fontFamily:"-apple-system",lineHeight:"normal"}}),Go=Object(Te.a)(y),Wo=Object(r.__assign)({rootStack:Object(r.__assign)({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},re.a.gap("12px")),messageHeader:{},messageFooter:{},listStackStyle:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),re.a.gap("12px")),list:Object(r.__assign)(Object(r.__assign)({},re.a.margin("0px")),re.a.gap("4px")),listHeader:{fontWeight:600},listFooter:{},linkText:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{color:Go.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Go.themePrimary}}}),linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"}},Br()),Qo=Object(X.a)(Wo),qo=function(e){var t,n,r=e.body,o=e.styles,a=null!==(t=r.cardHeader)&&void 0!==t?t:Ke(),s=null!==(n=r.cardContent)&&void 0!==n?n:lt()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContent:"Please help us learn and train our models by providing feedback through the thumbs up & down controls for each output the LLM generates.",l=r.imageSrc;return i.a.createElement(te,{style:o.feedbackNudgeRootStack},i.a.createElement(te,{style:o.msInternalContainer},i.a.createElement(xe.a,{title:Ye(),className:o.msInternalHeader},Ye())),i.a.createElement(Jt.a,{src:l,className:o.cardIllustration}),i.a.createElement(xe.a,{title:Ke(),className:o.feedbackCardHeader},a),i.a.createElement(xe.a,{title:lt()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContentTitle:"Feedback Nudge Content",className:Object($.a)(o.text,o.feedbackCardContent)},s))},Ko=function(e){var t,n,o,i,a;return Object(r.__assign)({feedbackNudgeRootStack:{},msInternalContainer:null!==(t=e.msInternalContainer)&&void 0!==t?t:{},msInternalHeader:null!==(n=e.msInternalHeader)&&void 0!==n?n:{},feedbackCardHeader:null!==(o=e.feedbackCardHeader)&&void 0!==o?o:{},feedbackCardContent:null!==(i=e.feedbackCardContent)&&void 0!==i?i:{},cardIllustration:null!==(a=e.cardIllustration)&&void 0!==a?a:{}},Ar(e))};var Yo=function(e){var t=Ko(e);return Object(X.a)(t)}(Object(r.__assign)({msInternalHeader:{lineHeight:"normal"},feedbackCardHeader:{lineHeight:"14px"},feedbackCardContent:{lineHeight:"14px"}},Br())),Zo=Object(Te.a)(y),Jo=Object(r.__assign)({feedbackNudgeRootStack:Object(r.__assign)({alignItems:"center"},re.a.gap("4px")),msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:"16px"},re.a.borderRadius(Zo.borderRadiusXLarge)),{backgroundColor:Zo.neutralTertiary}),re.a.padding("0px","12px")),vt.a.caption2Strong),{display:"flex",justifyContent:"center",alignItems:"center"}),feedbackCardHeader:Object(r.__assign)(Object(r.__assign)({marginTop:"12px",width:"100%",textAlign:"center"},vt.a.subtitle2),{color:Zo.themePrimary}),feedbackCardContent:{marginTop:"12px"},cardIllustration:{}},Br()),Xo=Object(X.a)(Jo),$o=n(3589),ei=n(2164),ti=n(465),ni=n(2174),ri=n(2398),oi=n(62),ii=function(){function e(){}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{type:e.type.toString(),tag:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",name:null!==(o=null===(r=e.name)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",source:null!==(a=null===(i=e.source)||void 0===i?void 0:i.toString())&&void 0!==a?a:"",duration:null!==(l=null===(s=e.duration)||void 0===s?void 0:s.toString())&&void 0!==l?l:"",success:null!==(u=null===(c=e.success)||void 0===c?void 0:c.toString())&&void 0!==u?u:"",correlationVector:null!==(p=null===(d=e.correlationVector)||void 0===d?void 0:d.toString())&&void 0!==p?p:""}},e.prototype.LogInfo=function(e){},e.prototype.LogError=function(e){},e.prototype.LogException=function(e){},e.prototype.LogWarning=function(e){},e.prototype.LogVerbose=function(e){},e.prototype.LogMetric=function(e){},e}(),ai=function(){function e(e){this.cardProps=e}return e.prototype.getDisplayExternalUrlWarning=function(){return function(e){return new Promise((function(t,n){e?setTimeout((function(){return t()}),2e3):n("CardId is missing")}))}},e.prototype.getCardReferences=function(e){var t=this.getCardService();return e&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService?e.map((function(e){return{card:JSON.parse(e.cardJson),context:t}})):[]},e.prototype.getCardService=function(){var e=this.cardProps.tokenService,t=this.cardProps.appService,n=this.cardProps.channelService,r=this.cardProps.clientInfo,o={host:{clientType:r.clientType,name:r.hubName,sessionId:r.sessionId,version:"1.0"},locale:r.locale,sessionId:r.sessionId,theme:We.d.default},i={dataResidency:oi.d.Public,id:r.aadUserId,displayName:r.userName,userPrincipalName:r.userPrincipalName},a=new ii,s=document.createElement("div"),l=new ri.MsgExtPreviewHostService((function(){return s}),i,o,t,e,(function(){throw new Error("Not implemented")}),n,void 0,this.getDisplayExternalUrlWarning());return{hostService:l,tokenService:e,appService:t,cardService:new ni.a(l,n,t),telemetryService:a,channelService:n}},e}(),si=n(3508),li=n(1778),ci=Object(li.b)({MsgExtCardPreview:Object(X.a)({root:{maxWidth:"min(".concat(600,"px, 100%)"),minWidth:"min(".concat(0,"px, 100%)")}})}),ui=function(e){var t=e.card,n=e.context,r=i.a.useMemo((function(){return{appId:t.appId,cardId:t.cardId,botId:t.botId,content:JSON.stringify(t.content),contentType:ct(t.contentType)}}),[t]);return i.a.createElement("div",null,i.a.createElement(ci,null,i.a.createElement(si.a,{cardDetails:r,serviceProvider:n})))},di=n(3567),pi=n(246);class gi{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:pi.e.LogMetric,tag:this.tag,name:this.name,success:pi.j.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:pi.e.LogMetric,tag:this.tag,name:this.name,success:pi.j.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:pi.e.LogMetric,tag:this.tag,name:this.name,success:pi.j.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}var hi=n(544),fi=Object(hi.a)("@1js/create-shared-react-context",{});var mi=function(e,t){var n=fi.get();return n[t]||(n[t]=o.createContext(e))}([],"ComponentStylingPureFluentOverrides");var vi=function(e,t){function n(){var n=t(),i=Object(o.useContext)(mi).map((function(t){return t[e]})).filter((function(e){return!!e})),a=Object(r.__assign)({},n),s=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],o=i.map((function(t){return t[e]})).filter((function(e){return!!e})),s=$.a.apply(void 0,Object(r.__spreadArray)([t],Object(r.__read)(o),!1));a[e]=s}};for(var l in n)s(l);return a}return n.componentName=e,n.__version="fluent",n}("MsgExtCitationControl",Object(X.a)({container:Object(r.__assign)({display:"inline-block",paddingBottom:"0px"},re.a.borderRadius("12px")),citationMountNode:{zIndex:999},popoverSurface:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.overflow("0px","0px")),re.a.padding("0px")),re.a.borderRadius("12px")),re.a.borderStyle("none")),{width:"min(".concat(450,"px, 100%)"),"& > div":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("12px")),re.a.borderWidth("0px")),re.a.borderStyle("none")),"&::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralForeground4},re.a.border("0px")),re.a.borderRadius(On.a.borderRadiusMedium)),"&::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({width:On.a.spacingHorizontalS},re.a.border("0px")),re.a.borderRadius(On.a.borderRadiusMedium)),"&::-webkit-scrollbar-track":Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},re.a.border("0px")),re.a.borderRadius(On.a.borderRadiusMedium)),"&::-webkit-scrollbar-corner":Object(r.__assign)(Object(r.__assign)({backGroundColor:On.a.colorNeutralBackground5},re.a.border("0px")),re.a.borderRadius(On.a.borderRadiusMedium))})}));function bi(e){var t=vi(),n=e.citation,i=e.cardDetails,a=e.serviceProvider,s=e.config,l=e.postActionExecute,c=o.useMemo((function(){return new gi(null==a?void 0:a.telemetryService,pi.h.CitationControl,pi.g.MsgExtCitationControl)}),[]),u=o.useMemo((function(){return o.createElement(si.a,{cardDetails:i,serviceProvider:a,config:s,postActionExecute:l})}),[a,i]);o.useEffect((function(){c.logMetricEnd({props:{},diagnosticsData:"TypeOfCard: ".concat(i.contentType,",  cardId : ").concat(i.cardId," }")},i.cardId)}),[]);var d=[o.createElement(Yr.a,{disableButtonEnhancement:!0},o.createElement(di.a,{"data-testid":"msgext-citation-pill"},n)),o.createElement("div",{"data-testid":"msgext-citation-popover"},o.createElement(Zr.a,{className:t.popoverSurface},u))],p=Object(r.__read)(o.useState(0),2),g=p[0],h=p[1],f=window.innerHeight;return o.createElement("div",{className:t.container,ref:function(e){e&&h(e.getBoundingClientRect().top)}},o.createElement(Kr.a,{openOnHover:!0,closeOnScroll:!0,positioning:{align:"center",position:g>f/2?"above":"below",autoSize:!0},trapFocus:!0,mountNode:{className:t.citationMountNode}},d))}var yi=function(e){var t=e.citation,n=e.card,r=e.context,o=i.a.useMemo((function(){return{appId:n.appId,cardId:n.cardId,botId:n.botId,content:JSON.stringify(n.content),contentType:ct(n.contentType)}}),[n]);return i.a.createElement(bi,{citation:t,cardDetails:o,serviceProvider:r})},Ci=function(e){var t,n=e.styles,o=e.body,a=e.strikeThroughText,s=e.references,l=void 0===s?[]:s,c=e.telemetryData,u=void 0===c?"":c,d=e.msgExtCardProps,p=void 0===d?void 0:d,g=e.cardServices,h=void 0===g?void 0:g,f=e.pluginAuthError,m=void 0===f?void 0:f,v=i.a.useMemo((function(){return function(e){return e||{attributions:[],clientInfo:mt()}}(p)}),[p]),b=v.attributions,y=v.clientInfo,C=i.a.useMemo((function(){return{appService:null==h?void 0:h.appService,tokenService:null==h?void 0:h.tokenService,channelService:null==h?void 0:h.channelService,clientInfo:y}}),[h,y]),O=i.a.useMemo((function(){return new ai(C)}),[C]);t=i.a.useMemo((function(){return O.getCardReferences(b)}),[b,O]);var S=i.a.useMemo((function(){return qr(m)}),[m]),E=S.requestType,x=S.appId,I=n.markdownRoot;a&&(I=Object($.a)(n.markdownRoot,n.strikeThroughText));var w=function(){if(1===t.length){var e=t[0];return i.a.createElement(ui,Object(r.__assign)({},e,{context:e.context}))}return null},T={};T=0===l.length?{a:function(e){e.node;var t=Object(r.__rest)(e,["node"]);return o.disableLinksProcessing?i.a.createElement("a",Object(r.__assign)({},t,{rel:"noreferrer"}),t.children):i.a.createElement("span",null,"[",t.children,"](",t.href,")")}}:{a:function(e){e.node;return function(e){var n=e.children[0],o=Number(n),a=Number.isInteger(o)&&o>0,s=null==p?void 0:p.attributions.length;if(a){if(s>1&&o>=1&&o<=s){var c=t[o-1];return i.a.createElement(yi,Object(r.__assign)({citation:o},c,{context:c.context}))}return i.a.createElement(Ho,Object(r.__assign)({},l.find((function(e){return e.referenceIndex===o})),{telemetryData:u}))}return i.a.createElement("span",null,"[",e.children,"](",e.href,")")}(Object(r.__rest)(e,["node"]))}},o.horizontalTableScroll&&(T.table=function(e){e.node;var t=Object(r.__rest)(e,["node"]);return i.a.createElement("div",{className:n.markdownHorizontalTableContainer},i.a.createElement("table",{className:n.markdownHorizontalTable},t.children))});var k=x&&h&&h.appService&&i.a.createElement($o.a,{requestType:E,appId:x,appService:h.appService});return 0===l.length?i.a.createElement(te,{style:I},i.a.createElement(ei.a,{linkTarget:"_blank",disallowedElements:["img"],unwrapDisallowed:!0,remarkPlugins:[ti.a],components:T},o.message),k,w()):i.a.createElement(te,{style:I},i.a.createElement(ei.a,{linkTarget:"_blank",disallowedElements:["img"],unwrapDisallowed:!0,remarkPlugins:[ti.a],components:T},l[0].isFlux?o.message:function(e,t){t.sort((function(e,t){return e.referenceIndex-t.referenceIndex}));var n=0;return t.forEach((function(t){var r=t.referenceProps.citationPosition+n,o="["+t.referenceIndex.toString()+"]()";e=e.substring(0,r)+o+e.substring(r),n+=o.length})),e}(o.message,l)),k,w())},Oi=function(e){var t,n,o,i,a=Object(r.__assign)({markdownRoot:null!==(t=e.markdownRoot)&&void 0!==t?t:{},markdownElement:null!==(n=e.markdownElement)&&void 0!==n?n:{},markdownHorizontalTableContainer:null!==(o=e.markdownHorizontalTableContainer)&&void 0!==o?o:{},markdownHorizontalTable:null!==(i=e.markdownHorizontalTable)&&void 0!==i?i:{}},Ar(e));return Object(X.a)(a)}({markdownRoot:{lineHeight:"inherit"}}),Si=Object(Te.a)(y),Ei=Object(r.__assign)({markdownRoot:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{color:Si.black,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",Si.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(r.__assign)({backgroundColor:Si.colorNeutralBackground1Hover},re.a.padding("1px","5px")),"& td":Object(r.__assign)(Object(r.__assign)({},re.a.borderBottom("1px","solid",Si.colorNeutralBackground3Pressed)),re.a.padding("1px","5px")),"& p":{display:"inline"}}),markdownElement:{marginBottom:"10px"},markdownHorizontalTableContainer:{width:"100%",overflowX:"auto","::-webkit-scrollbar":Object(r.__assign)({height:"7px",backgroundColor:"transparent"},re.a.borderRadius(Si.borderRadiusLarge)),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Si.colorScrollbarOverlay},re.a.borderRadius(Si.borderRadiusLarge)),re.a.border("1px","solid",Si.colorNeutralBackground1)),{":hover":{backgroundColor:Si.colorNeutralForeground3}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:"transparent"},re.a.borderRadius(Si.borderRadiusLarge))},markdownHorizontalTable:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"100%",whiteSpace:"nowrap"},re.a.overflow("hidden")),re.a.borderRadius(Si.borderRadiusMedium)),vt.a.caption1),{"& th":Object(r.__assign)({},vt.a.caption1Strong)})},Br()),xi=Object(X.a)(Ei),Ii=n(3360),wi=n(3362),Ti=n(3402),ki=n(3364),ji=n(3365),Pi=n(3366),Ai=function(e){var t=e.styles,n=e.handleApplyOnClick,a=e.handleApplyAllOnClick,s=Object(r.__read)(Object(o.useState)(!1),2),l=s[0],c=s[1],u=Object(r.__read)(Object(o.useState)(!1),2),d=u[0],p=u[1],g=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return c(!0),d?[4,a()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return c(!1),[2]}}))}))};return l?i.a.createElement(so.a,{content:"Waiting to apply updates",relationship:"label"},i.a.createElement(se.a,{className:Object($.a)(t.spinnerButton,t.combinedButton),onClick:g,disabled:!0,icon:i.a.createElement(At.e,{className:t.spinnerIcon})})):i.a.createElement(Ii.a,{positioning:"below-end"},i.a.createElement(wi.a,{disableButtonEnhancement:!0},(function(e){return i.a.createElement(so.a,{content:"Apply Updates",relationship:"label"},i.a.createElement(Ti.a,{menuButton:e,primaryActionButton:{onClick:g},size:"small",className:t.applyButton},d?"Apply All":"Apply"))})),i.a.createElement(ki.a,null,i.a.createElement(ji.a,null,i.a.createElement(Pi.a,{onClick:function(){p((function(e){return!e}))}},d?"Apply":"Apply All"))))},_i=function(e){var t=e.styles,n=e.body,a=Object(r.__read)(Object(o.useState)(0),2),s=a[0],l=a[1],c=Object(r.__read)(Object(o.useState)(Object(r.__spreadArray)([],Object(r.__read)(n.textIndices),!1)),2),u=c[0],d=c[1],p=Object(r.__read)(Object(o.useState)(!1),2),g=p[0],h=p[1];Object(o.useEffect)((function(){s>=u.length&&l(u.length-1)}),[u]);var f=function(){return l((function(e){return e-1}))},m=function(){return l((function(e){return e+1}))},v=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return h(!0),[4,n.locateTextIndex(u[s])];case 1:return e.sent(),h(!1),[2]}}))}))},b=function(){d((function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return t.splice(s,1),t}))},y={styles:t,handleApplyOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(u[s])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(u)];case 1:return e.sent(),[2]}}))}))}};return i.a.createElement(te,{style:t.stack,customProperties:{tabIndex:-1}},u.length?i.a.createElement(i.a.Fragment,null,"Applying updates to following matches",i.a.createElement("div",{className:t.contentBox},i.a.createElement("div",{className:t.contentBoxButtonGroup},i.a.createElement("div",{className:g?t.disabledContentBoxIcon:t.contentBoxIcon},g?i.a.createElement(At.f,{className:t.spinnerIcon}):i.a.createElement(so.a,{content:"Locate",relationship:"label"},i.a.createElement(uo.b,{onClick:v}))),g?i.a.createElement(i.a.Fragment,null):i.a.createElement("div",{className:Object($.a)(t.contentBoxIcon,t.dismissIcon)},i.a.createElement(so.a,{content:"Remove",relationship:"label"},i.a.createElement(we.h,{onClick:b})))),i.a.createElement("div",{className:t.contentBoxText},s<u.length&&n.extractTextToDisplay(u[s]))),i.a.createElement("div",{className:t.footer},i.a.createElement("div",null,i.a.createElement(Ai,Object(r.__assign)({},y))),i.a.createElement("div",{className:t.pagination},i.a.createElement("div",{className:t.paginationNumberBox},s+1,"/",u.length),i.a.createElement("div",null,i.a.createElement(i.a.Fragment,null,i.a.createElement(so.a,{content:"Previous",relationship:"label"},i.a.createElement(se.a,{icon:i.a.createElement(lo.i,null),onClick:f,disabled:0==s,className:t.paginationButton})),i.a.createElement(so.a,{content:"Next",relationship:"label"},i.a.createElement(se.a,{icon:i.a.createElement(lo.j,null),onClick:m,disabled:s+1>=u.length,className:t.paginationButton}))))))):i.a.createElement(i.a.Fragment,null,"No results found for the search"))},Di=Object(Te.a)(y),Li=Object(r.__assign)({stack:Object(r.__assign)({textAlign:"start",textOverflow:"clip"},re.a.gap("12px")),contentBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Di.neutralLight,minHeight:"50px",position:"relative"},re.a.padding("12px")),re.a.border("1px","solid",Di.neutralLighterAlt)),re.a.borderRadius(Di.borderRadiusMedium)),footer:Object(r.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},re.a.gap("12px")),pagination:Object(r.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},re.a.gap("10px")),paginationButton:Object(r.__assign)(Object(r.__assign)({backgroundColor:Di.neutralLight,height:"24px"},re.a.border("none")),{"&:hover":{color:Di.themePrimary}}),spinnerButton:{backgroundColor:Di.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Di.themePrimary}},paginationNumberBox:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"center",backgroundColor:Di.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},re.a.border("1px","solid",Di.neutralLighterAlt)),re.a.borderRadius(Di.borderRadiusMedium)),vt.a.caption1),re.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Di.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Di.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Di.themePrimary},contentBoxText:{marginBottom:"20px"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Br()),Mi=Object(X.a)(Li),Bi=function(e){var t=e.styles,n=e.body,o=Object(r.__read)(i.a.useState(!1),2),a=o[0],s=o[1];return i.a.createElement(te,{style:t.rootStack},i.a.createElement("div",{className:t.container,onMouseOver:function(){n.handleMouseOver()},onMouseLeave:function(){n.handleMouseLeave()},onFocus:function(){n.handleMouseLeave()}},i.a.createElement("div",null,i.a.createElement(xe.a,{className:t.title},lt()?OfficeaicopilotStrings.ProactiveSuggestionTitleText:"Highlight Data"),i.a.createElement(co.a,{className:t.badge,size:"large",appearance:"outline",color:"subtle",icon:i.a.createElement(At.b,null)},lt()?OfficeaicopilotStrings.ProactiveSuggestionIconText:"Idea")),i.a.createElement(xe.a,{className:t.body},lt()?OfficeaicopilotStrings.ProactiveSuggestionBodyText:"For a more engaging presentation, here’s a design that might better highlight the stats in your slide."),i.a.createElement(Jt.a,{className:t.image,bordered:!0,shadow:!0,shape:"rounded",alt:lt()?OfficeaicopilotStrings.ProactiveSuggestionImageAltText:"proactive suggestion card img",src:n.imageSrc}),i.a.createElement(se.a,{disabled:a,className:t.applyButton,onClick:function(){s(!0),n.handleApplyClicked()},icon:i.a.createElement(g.c,null)},lt()?OfficeaicopilotStrings.ProactiveSuggestionApplyBtnText:"Apply")))},Ri=Object(Te.a)(y),Fi=Object(r.__assign)({rootStack:Object(r.__assign)({},re.a.gap("4px")),container:{display:"flex",flexDirection:"column"},title:{fontWeight:"600"},badge:Object(r.__assign)({float:"right"},re.a.borderColor(Ri.themeMedium)),body:{marginTop:"15px"},image:{marginTop:"15px"},applyButton:{marginTop:"15px",width:"104px"}},Br()),Ni=Object(X.a)(Fi),Hi=n(98),Ui=n(344),Vi=n.n(Ui),zi=Object(Te.a)(y),Gi=Object(r.__assign)(Object(r.__assign)({},Br()),{cardRoot:{color:zi.black,fontSize:On.a.fontSizeBase300,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",On.a.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Hover},re.a.padding("1px","5px")),"& td":Object(r.__assign)(Object(r.__assign)({},re.a.borderBottom("1px","solid",On.a.colorNeutralBackground3Pressed)),re.a.padding("1px","5px")),"& a ":Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({height:On.a.lineHeightBase200,gap:On.a.spacingHorizontalXS,display:"inline-flex",alignItems:"flex-start",color:zi.colorBrandForegroundLink},re.a.padding("0px","0px",On.a.spacingVerticalXXS)),{textDecorationLine:"none",cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(r.__assign)({color:zi.colorBrandForegroundLinkHover},re.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:active"]=Object(r.__assign)({color:zi.colorBrandForegroundLinkPressed},re.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:focus"]=Object(r.__assign)(Object(r.__assign)({color:zi.colorBrandForegroundLinkSelected},re.a.textDecoration("underline","solid",On.a.colorStrokeFocus2)),re.a.borderBottom("1px","solid",On.a.colorStrokeFocus2)),e}()),function(){var e;return(e={})["&:disabled"]={color:On.a.colorNeutralForegroundDisabled,textDecorationLine:"none",cursor:"default"},e}())),"& button, .ac-pushButton":Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:On.a.fontWeightRegular,color:On.a.colorNeutralForeground1,fontSize:On.a.fontSizeBase200},re.a.padding(On.a.spacingVerticalXS,On.a.spacingHorizontalS)),re.a.borderRadius(On.a.borderRadiusMedium)),re.a.border("1px","solid",On.a.colorNeutralStroke1)),{backgroundColor:On.a.colorNeutralBackground1,cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(r.__assign)(Object(r.__assign)({},re.a.borderColor(On.a.colorNeutralStroke1Hover)),{backgroundColor:On.a.colorNeutralBackground1Hover,color:On.a.colorNeutralForeground1Hover}),e["&:hover .".concat(bt.a.icon)]={color:zi.themePrimary},e}()),function(){var e;return(e={})["&:hover:active"]=Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Pressed,color:On.a.colorNeutralForeground1Pressed},re.a.borderColor(On.a.colorNeutralStroke1Pressed)),e}()),function(){var e;return(e={})["&:disabled"]=Object(r.__assign)(Object(r.__assign)({},re.a.borderColor(On.a.colorNeutralStrokeDisabled)),{color:On.a.colorNeutralForegroundDisabled,backgroundColor:On.a.colorNeutralBackgroundDisabled,cursor:"default"}),e}())),"& .ac-container":{"& ol, ul":{paddingInlineStart:On.a.spacingVerticalXL}},"& .ac-image":{objectFit:"contain"}},decorativeBorder:Object(r.__assign)(Object(r.__assign)({},re.a.margin(On.a.spacingVerticalS,On.a.spacingVerticalNone,On.a.spacingVerticalNone)),Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius(On.a.borderRadiusMedium)),re.a.border("1px","solid",On.a.colorNeutralStroke1))),adaptiveCardWrapper:Object(r.__assign)({},re.a.padding(On.a.spacingVerticalS,On.a.spacingVerticalM,On.a.spacingVerticalM)),cardHeader:{},cardFooter:{},cardSourceLabel:{display:"flex",flexDirection:"row",width:"100%",height:On.a.lineHeightBase300,marginBottom:On.a.spacingVerticalM,color:On.a.colorNeutralForeground4,"& label":{fontSize:On.a.fontSizeBase100,marginLeft:On.a.spacingVerticalXS,height:On.a.lineHeightBase100}}}),Wi=Object(X.a)(Gi),Qi=function(e){var t=e.text,n=Wi(),r=Object($.a)(null==n?void 0:n.cardFooter,null==n?void 0:n.footerBar);return t?i.a.createElement("div",{className:r},i.a.createElement("span",null,t)):null},qi=function(e){var t=e.text,n=Wi(),r=Object($.a)(null==n?void 0:n.cardHeader,n.headerBar);return t?i.a.createElement("div",{className:r},i.a.createElement("span",null,t)):null},Ki=n(1622),Yi=function(e){var t=e.text,n=e.iconName,r=Wi();return t||n?i.a.createElement(te,{style:r.cardSourceLabel},n&&i.a.createElement(Ki.a,{iconName:n}),t&&i.a.createElement("label",null,t)):null},Zi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(Hi.Action);Hi.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new Vi.a).render(e),t.didProcess=!0};var Ji=function(e){var t=e.styles,n=e.body,r=e.telemetryData,o=void 0===r?"":r,a=n.actionHandlers,s=n.customActions,l=n.cardData,c=n.headerText,u=n.footerText,d=n.sourceLabel,p=n.decorativeBorder,g=void 0===p||p,h=Object($.a)(null==t?void 0:t.adaptiveCardWrapper,g?null==t?void 0:t.decorativeBorder:null);return i.a.createElement(te,{style:null==t?void 0:t.cardRoot},i.a.createElement(qi,{text:c}),i.a.createElement("div",{className:h},i.a.createElement(Yi,{text:null==d?void 0:d.text,iconName:null==d?void 0:d.iconName}),i.a.createElement(Xi,{element:$i(l,a,s,o)})),i.a.createElement(Qi,{text:u}))},Xi=function(e){var t=e.element,n=Object(o.useRef)();return Object(o.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),i.a.createElement("span",{ref:n})},$i=function(e,t,n,r){var o=new Hi.CardObjectRegistry;for(var i in Hi.GlobalRegistry.populateWithDefaultActions(o),n)o.register(i,n[i]);var a=new Hi.SerializationContext;a.setActionRegistry(o);var s=new Hi.AdaptiveCard;return s.hostConfig=new Hi.HostConfig({spacing:{default:"12",padding:"0"},containerStyles:{default:{foregroundColors:{default:{default:zi.black}}}}}),s.parse(e,a),s.onExecuteAction=function(e){try{if(e instanceof Zi)e.executeWithTelemetry(r);else if(e instanceof Hi.OpenUrlAction)(null==t?void 0:t.openUrlActionHandler)&&t.openUrlActionHandler(e.url,r);else if(e instanceof Hi.ExecuteAction&&(null==t?void 0:t.executeActionHandlers)){var n=t.executeActionHandlers[e.verb];n&&n(e.data,r)}}catch(e){}},s.render()},ea=n(340),ta=n.n(ea);Hi.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new Vi.a).render(e),t.didProcess=!0};var na,ra=function(e){var t=e.cardData,n=new Hi.AdaptiveCard;n.hostConfig=new Hi.HostConfig({spacing:{padding:"0px"},containerStyles:{default:{foregroundColors:{default:{default:Nr.black}}}}}),n.parse(t);var r=n.render();return i.a.createElement(oa,{element:r})},oa=function(e){var t=e.element,n=Object(o.useRef)();return Object(o.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),i.a.createElement("span",{ref:n})},ia=function(e){var t=e.styles,n=e.body,a=e.strikeThroughText,s=e.references,l=void 0===s?[]:s,c=e.telemetryData,u=void 0===c?"":c,d=Object(o.useRef)(null),p=n.basin,g=n.uniqueId,h=n.accessPath,f=n.value;Object(o.useEffect)((function(){!function(){var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}()}),[f]);var m=t.adaptiveCardRoot;if(a&&(m=Object($.a)(t.adaptiveCardRoot,t.strikeThroughText)),p.items&&g&&h){var v=ta()(p.items[g],h,null),b=[];if(l.length>0&&(b=ht(v,l)),0===b.length&&v)return i.a.createElement(te,{style:m},i.a.createElement(ra,{cardData:v}),i.a.createElement("span",{ref:d}));if(v&&b.length>0)return i.a.createElement(te,{style:m},b.map((function(e,n){return i.a.createElement("span",{key:n,className:t.markdownRoot},i.a.createElement(ra,{cardData:e.adaptiveCard})," ",e.references.map((function(e,t){return i.a.createElement(Ho,Object(r.__assign)({},e,{key:t,telemetryData:u}))})))})),i.a.createElement("span",{ref:d}))}return null},aa=function(e){var t=e.styles,n=e.body,r=e.warningActionButtons,o=void 0===r?[]:r;return i.a.createElement(te,{style:t.warningMessageRootStack},i.a.createElement(xe.a,{tabIndex:-1},n.warningPrefix,n.warningEmphasizedText&&i.a.createElement("span",{className:t.warningMessageBoldText},n.warningEmphasizedText),n.warningSuffix),o&&o.length>0&&o.map((function(e,n){return i.a.createElement(se.a,{key:n,className:t.warningActionButton,"aria-label":e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled},e.buttonText)})))},sa=Object(Te.a)(y),la=Object(r.__assign)({warningMessageRootStack:Object(r.__assign)({alignItems:"center"},re.a.gap("4px")),warningMessageBoldText:Object(r.__assign)({},vt.a.body1Stronger),warningActionButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"100%",height:"28px",backgroundColor:sa.neutralLight},re.a.border("1px","solid",sa.neutralLighterAlt)),re.a.borderRadius(sa.borderRadiusMedium)),re.a.padding("0px","0px","4px","0px")),vt.a.body1)},Br()),ca=Object(X.a)(la),ua=function(e){var t,n,o,a,s,l,c,u=e.chatMessage,d=e.chatCardIndex,p=e.shouldShowFeedbackButtons,g=e.handleChatCardThumbsDownClick,h=e.handleChatCardThumbsUpClick,f=e.designerProps,m=e.customMessageRenderers,v=e.pluginServiceProvider,b={handleThumbsDownClick:g,handleThumbsUpClick:h,shouldShowFeedbackButtons:p,chatCardIndex:d,feedbackSectionPosition:u.feedbackSectionPosition,shouldShowAIGeneratedIndicator:u.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:!1,actionBarButtons:u.actionBarButtons,feedbackData:u.feedbackData,showAnimation:u.showAnimation,strikeThroughText:u.strikeThroughText,showMinifiedUI:null!==(t=u.showMinifiedUI)&&void 0!==t&&t,references:u.references,handleShowMeOnClick:u.handleShowMeOnClick,warningActionButtons:null!==(n=u.warningActionButtons)&&void 0!==n?n:[],clpSensitivityIndicatorData:null!==(o=u.clpSensitivityIndicatorData)&&void 0!==o?o:void 0,telemetryData:null!==(a=u.telemetryData)&&void 0!==a?a:"",msgExtCardProps:u.msgExtCardProps,pluginAuthError:u.pluginAuthError},y=u.messageType,C=u.body,O=u.styles;switch(y){case P.Default:b.styles=gt(function(){var e=Qo(),t=zo();Z()===Q.IOS&&gt(e,t);return e}(),O),c=i.a.createElement(Vo,Object(r.__assign)({body:C},b));break;case P.PaginatedCard:b.styles=gt(Mi(),O),c=i.a.createElement(_i,Object(r.__assign)({body:C},b));break;case P.AccordionCard:c=i.a.createElement(ar,Object(r.__assign)({styles:O,body:C},b));break;case P.ContentCard:b.styles=gt(Xn(),O),c=i.a.createElement(tr,Object(r.__assign)({body:C},b));break;case P.ChatCardWrapper:b.styles=gt(function(){var e=Rr(),t=Dr();Z()===Q.IOS&&gt(e,t);return e}(),O),c=i.a.createElement(Vr,{renderData:C.renderData,fallbackElement:C.element,customMessageRenderers:m});break;case P.FeedbackNudge:b.styles=gt(function(){var e=Xo(),t=Yo();Z()===Q.IOS&&gt(e,t);return e}(),O),c=i.a.createElement(qo,Object(r.__assign)({body:C},b));break;case P.MarkdownCard:b.styles=gt(function(){var e=xi(),t=Oi();Z()===Q.IOS&&gt(e,t);return e}(),O),c=i.a.createElement(Ci,Object(r.__assign)({body:C},b,{cardServices:null==v?void 0:v.cardServices}));break;case P.SelfHelpAdaptiveCard:b.styles=gt(Wi(),O),c=i.a.createElement(Ji,Object(r.__assign)({body:C},b));break;case P.StreamingAdaptiveCard:b.styles=gt(Ur(),O),c=i.a.createElement(ia,Object(r.__assign)({body:C},b));break;case P.Designer:var S=C;return i.a.createElement(Hn,Object(r.__assign)({key:C.message},f,{userInput:S.message,turnId:S.turnId,isRehydration:S.isRehydration,handleThumbsDownClick:function(){return g({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(f.clientSettings)}})},handleThumbsUpClick:function(){return h({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(f.clientSettings)}})},feedbackData:b.feedbackData,fileCacheInfo:S.fileCacheInfo,isStockQuery:S.isStockQuery,stockImages:S.stockImages,imageType:S.imageType,isAuthEnabled:S.isAuthEnabled,dimensions:S.dimensions,shouldShowAIPoweredIndicator:null===(s=u.body)||void 0===s?void 0:s.isStockQuery}));case P.WarningMessage:b.styles=gt(ca(),O),c=i.a.createElement(aa,Object(r.__assign)({body:C},b));break;case P.ProactiveSuggestionCard:b.styles=gt(Ni(),O),c=i.a.createElement(Bi,Object(r.__assign)({body:C},b));break;case P.CopilotWorkflowMessage:return i.a.createElement(Vn,{launchText:C.launchText,buttonText:C.buttonText,onLaunch:C.onLaunch});default:c=null}return i.a.createElement(Bo,Object(r.__assign)({body:{user:null===(l=u.body)||void 0===l?void 0:l.user,element:c},pluginServiceProvider:v},b))},da=i.a.memo(ua,(function(e,t){var n,r;return t.chatMessage.messageType===P.Designer&&(null===(n=e.designerProps)||void 0===n?void 0:n.clientSettings.designerTheme)===(null===(r=t.designerProps)||void 0===r?void 0:r.clientSettings.designerTheme)})),pa={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:Object(r.__assign)({verticalAlign:"end"},re.a.gap("10px")),chatCardsStack:Object(r.__assign)(Object(r.__assign)({verticalAlign:"end"},re.a.padding("0px","16px")),re.a.gap("10px"))},ga=Object(X.a)(pa),ha=function(e){var t,n=e.children,r=e.chatLog,o=e.styles,a=e.elementsBeforeChatLog,s=e.shouldShowFeedbackButtons,l=void 0===s||s,c=e.handleChatCardThumbsDownClick,u=e.handleChatCardThumbsUpClick,d=e.designerProps,p=e.customMessageRenderers,g=e.pluginServiceProvider,h=gt(ga(),o),f=null!==(t=null==d?void 0:d.isDesignerEnabled)&&void 0!==t&&t,m=f?da:ua;return i.a.createElement(te,{style:h.root,reverse:!0},i.a.createElement(te,{style:h.elementStack},a,i.a.createElement(te,{style:h.chatCardsStack,customProperties:{role:rt,"aria-label":lt()?OfficeaicopilotStrings.ChatMessagesLabel:"Chat Messages","aria-setsize":r.length}},r.map((function(e,t){return i.a.createElement(m,{key:t,chatCardIndex:t,chatMessage:e,shouldShowFeedbackButtons:l,handleChatCardThumbsDownClick:c,handleChatCardThumbsUpClick:u,designerProps:f?d:void 0,customMessageRenderers:p,pluginServiceProvider:g})}))),n))},fa=Object(Te.a)(O),ma={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("10px")),re.a.margin(fa.spacingVerticalNone,fa.spacingHorizontalNone,fa.spacingVerticalS,fa.spacingHorizontalS)),{alignContent:"center"}),re.a.border("0px")),(na={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},na["&:hover .".concat(bt.a.icon)]={color:fa.themePrimary},na["&:hover:active .".concat(bt.a.icon)]={color:fa.themePrimary},na))},va=Object(X.a)(ma);var ba=o.memo((function(e){var t=e.handleChangeTopicButtonClick;return o.createElement(se.a,{appearance:"subtle",className:va().root,icon:o.createElement(Po.e,null),onClick:t,size:"small"},lt()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic")}));function ya(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},button:null!==(n=e.button)&&void 0!==n?n:{},suggestionContainer:null!==(r=e.suggestionContainer)&&void 0!==r?r:{},refreshButton:null!==(o=e.refreshButton)&&void 0!==o?o:{},refreshButtonIcon:null!==(i=e.refreshButtonIcon)&&void 0!==i?i:{},tooltip:null!==(a=e.tooltip)&&void 0!==a?a:{}};return Object(X.a)(s)}var Ca,Oa,Sa=Object(Te.a)(y),Ea=ya({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"flex-start",flexWrap:"nowrap",backgroundColor:"transparent",minHeight:"67px"},re.a.padding("12px","0px")),re.a.margin(Sa.spacingVerticalNone)),{"> *:not(.ms-StackItem)":{flexShrink:0},overflowX:"auto",overflowY:"hidden"}),suggestionContainer:Object(r.__assign)(Object(r.__assign)({minHeight:"67px"},re.a.overflow("hidden")),re.a.padding("12px")),button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),{display:"flex"}),re.a.padding("0px","8px")),{fontFamily:"-apple-system",lineHeight:"normal",fontStyle:"normal",fontWeight:"400",fontSize:"14px",alignItems:"center",order:"0",textOverflow:"ellipsis",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",textAlign:"start"}),refreshButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",Sa.themeMedium)),{backgroundColor:"transparent"}),re.a.borderRadius("50%")),re.a.padding("2px")),re.a.margin("4px")),{verticalAlign:"middle",minWidth:"40px",height:"40px",order:-1}),tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}}),xa=ya({root:Object(r.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},re.a.margin(On.a.spacingHorizontalNone,On.a.spacingHorizontalL,On.a.spacingHorizontalNone)),suggestionContainer:{},button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"start",color:On.a.colorNeutralForeground1,backgroundColor:"transparent"},re.a.border("1px","solid",On.a.colorBrandBackground2Hover)),vt.a.caption1),re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.padding(On.a.spacingVerticalSNudge,On.a.spacingHorizontalS)),re.a.margin(On.a.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(r.__assign)({backgroundColor:On.a.colorBrandBackground2},re.a.border("1px","solid",On.a.colorBrandStroke2Hover)),"&:hover :active":Object(r.__assign)({backgroundColor:On.a.colorBrandBackground2},re.a.border("1px","solid",On.a.colorBrandStroke2Hover))}}),refreshButton:Object(r.__assign)(Object(r.__assign)({minWidth:"fit-content"},re.a.border("1px","solid",On.a.colorBrandBackground2Hover)),{"@media (forced-colors: none)":(Ca={"&:hover":Object(r.__assign)({backgroundColor:On.a.colorBrandBackground2},re.a.border("1px","solid",On.a.colorBrandStroke2Hover))},Ca["&:hover .".concat(bt.a.icon)]={color:On.a.colorCompoundBrandForeground1},Ca)}),refreshButtonIcon:{width:"14px",height:"14px"}}),Ia=Object(Te.a)(y),wa=ya({root:Object(r.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},re.a.margin(Ia.spacingHorizontalNone,Ia.spacingHorizontalL,Ia.spacingHorizontalNone)),suggestionContainer:{},button:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({textAlign:"start",color:Ia.neutralPrimary,backgroundColor:"transparent"},re.a.border("1px","solid",Ia.themeMedium)),vt.a.caption1),re.a.borderRadius(Ia.borderRadiusXLarge)),re.a.padding(Ia.spacingVerticalSNudge,Ia.spacingHorizontalS)),re.a.margin(Ia.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(r.__assign)({backgroundColor:Ia.themeLight},re.a.border("1px","solid",Ia.themeDarker)),"&:hover :active":Object(r.__assign)({backgroundColor:Ia.themeLight},re.a.border("1px","solid",Ia.themeDarker))}}),refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":(Oa={},Oa["&:hover .".concat(bt.a.icon)]={color:Ia.themePrimary},Oa)},refreshButtonIcon:{width:"14px",height:"14px"}}),Ta=function(){var e=wa(),t=xa(),n=x?t:e;n.refreshButton=Object($.a)(n.button,n.refreshButton);var r=Ea();if(Z()===Q.IOS)gt(n,r);return n},ka=function(e){var t=e.stylesToOverride,n=e.suggestionList,r=e.handleSuggestionPillClick,o=e.showRefreshButton,a=void 0!==o&&o,s=e.handleRefreshButtonClick,l=void 0===s?function(){}:s,c=Ta();gt(c,t);return i.a.createElement("div",{className:c.suggestionContainer},i.a.createElement(te,{style:c.root,horizontal:!0,customProperties:{role:nt,tabIndex:0,"aria-label":kn()}},n.map((function(e,t){return i.a.createElement(so.a,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},i.a.createElement(se.a,{size:"small",appearance:"subtle",className:c.button,onClick:function(){return r(e)},role:st,id:"".concat(kn,"-").concat(t)},e))})),a&&i.a.createElement(so.a,{content:i.a.createElement("span",{className:c.tooltip},lt()?OfficeaicopilotStrings.SuggestionPaneRefreshButtonLabel:"Refresh"),relationship:"label",positioning:"above"},i.a.createElement(se.a,{appearance:"subtle",className:c.refreshButton,onClick:function(){l();var e=document.getElementById("".concat(kn,"-0"));e&&"function"==typeof e.focus&&e.focus()},icon:{className:c.refreshButtonIcon,children:i.a.createElement(g.g,null)},role:st}))))},ja=function(){return lt()?OfficeaicopilotStrings.HintCardHeaderTextLabel:"hintCardHeaderText"},Pa=function(){return lt()?OfficeaicopilotStrings.HintCardDescriptionTextLabel:"hintCardDescriptionText"};var Aa,_a,Da,La=function(e){var t,n,r,o={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},headerText:null!==(n=e.headerText)&&void 0!==n?n:{},descriptionText:null!==(r=e.descriptionText)&&void 0!==r?r:{}};return Object(X.a)(o)}({root:{lineHeight:"normal"}}),Ma=Object(Te.a)(y),Ba={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({boxShadow:Ma.shadow4,backgroundColor:Ma.neutralLight},re.a.borderRadius(Ma.borderRadiusXLarge)),re.a.margin(Ma.spacingVerticalNone,Ma.spacingHorizontalL,Ma.spacingVerticalXXS)),re.a.padding(Ma.spacingVerticalM)),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",Ma.neutralLighterAlt)),headerText:{fontWeight:Ma.fontWeightSemibold,color:Ma.themePrimary},descriptionText:{color:Ma.neutralQuaternaryAlt}},Ra=Object(X.a)(Ba),Fa=function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n]);e.rootHighContrast=Object($.a)(e.root,e.rootHighContrast)},Na=i.a.memo((function(e){var t=e.overrideStyles,n=e.headerText,r=e.descriptionText,o=T(),a=function(){var e=Ra(),t=La();Z()===Q.IOS&&Fa(e,t);return e}();return Fa(a,t),i.a.createElement(te,{style:o?a.rootHighContrast:a.root,customProperties:{role:nt,"aria-labelledby":ja(),"aria-describedby":Pa(),"aria-live":"polite"}},i.a.createElement(xe.a,{id:ja(),className:a.headerText},n),i.a.createElement(xe.a,{id:Pa(),className:a.descriptionText},r))})),Ha=Object(Te.a)(y),Ua={chatInputRestShy:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","solid",Ha.neutralLighterAlt)),re.a.borderRadius("12px")),{backgroundColor:Ha.neutralLight}),re.a.margin(Ha.spacingHorizontalNone,Ha.spacingHorizontalL,Ha.spacingHorizontalL,Ha.spacingHorizontalL)),re.a.padding("4px")),re.a.gap("12px")),{position:"relative",zIndex:"1",transform:"none",transformOrigin:"bottom","&selectors":{"&.chatInputLeftButtons":{"> button":{"&svg":{height:"18px",width:"18px"}}}}}),chatInputContainerRestShy:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("6px","4px","0px")),{fontFamily:"-apple-system",fontStyle:"normal",fontWeight:"400",fontSize:"15px",cursor:"pointer",width:"min-content",lineHeight:"normal",display:"flex",alignItems:"center",letterSpacing:"-0.43px",color:Ha.neutralSecondaryAlt}),re.a.flex("none")),{order:"1",flexGrow:"1"}),chatInputRestShyMenuButton:{height:"40px",width:"40px","&selectors":{"&svg":{height:"24px",width:"24px",fill:Ha.themePrimary},"&hover":{backgroundColor:"transparent !important"}}}},Va=Object(X.a)(Ua),za=n(3441),Ga=n(3442),Wa=n(3443),Qa=n(862),qa=Object(X.a)({item:{fontSize:"16px",lineHeight:"normal",fontFamily:"-apple-system"},itemContent:Object(r.__assign)(Object(r.__assign)({display:"inline-block",whiteSpace:"nowrap"},re.a.overflow("hidden")),{textOverflow:"ellipsis"}),menuGroupHeader:{fontSize:"14px",fontFamily:"-apple-system",lineHeight:"normal"}}),Ka=Object(Te.a)(y),Ya=Object(X.a)({item:(Aa={},Aa["&:hover .".concat(Qa.a.icon)]={color:Ka.themePrimary},Aa.paddingLeft="10px",Aa),itemContent:{},menuParent:Object(r.__assign)({width:"100%"},re.a.margin("0px","16px")),menuGroupHeader:{color:Ka.black}}),Za=function(){var e=Ya(),t=qa();if(Z()===Q.IOS)gt(e,t);return e},Ja=function(e){var t,n=Za();return i.a.createElement(za.a,{key:null!==(t=e.sectionHeader)&&void 0!==t?t:et},e.showSectionTopDivider&&i.a.createElement(Ga.a,null),e.sectionHeader!==et&&i.a.createElement(Wa.a,{className:n.menuGroupHeader},e.sectionHeader),e.starterPrompts.map((function(t){return Xa(t,e.sectionHeader)})))},Xa=function(e,t){var n=Object(Ve.a)(e.iconHover,e.iconRegular),r=Za();return i.a.createElement(Pi.a,{key:e.text,className:r.item,icon:i.a.createElement(n,null),onClick:function(){return $a(e.text)},"aria-label":t+" "+e.text,content:{className:r.itemContent}},e.text)},$a=function(e){_a.handleOnClickStarterPromptMenuItem&&_a.handleOnClickStarterPromptMenuItem(e)},es=Object(Te.a)(y),ts=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent")),{width:"40px",height:"40px",maxWidth:"unset","&:hover":Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent"))})}),ns=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent"))})}),rs=Object(X.a)({root:{color:es.themePrimary}}),os=Object(Te.a)(y),is=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:os.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},re.a.borderColor(os.neutralLight)),re.a.borderRadius(os.borderRadiusXLarge)),{marginLeft:"4px",width:"32px",height:"32px","&:hover":{backgroundColor:os.neutralTertiaryAlt}})}),as=Object(X.a)({root:{backgroundColor:os.neutralLighter}}),ss=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:os.neutralTertiary},re.a.borderColor(os.neutralTertiary)),{"&:hover":Object(r.__assign)({backgroundColor:os.neutralTertiary},re.a.borderColor(os.neutralTertiary))})}),ls=Object(X.a)({root:{color:os.neutralPrimary}}),cs=Object(X.a)({root:{color:os.themePrimary}}),us=Object(X.a)({root:{color:os.neutralQuaternary}}),ds=function(e){var t=e.title,n=e.isDisabled,a=e.isMenuOpen,s=e.setMenuOpen,l=(e.handleClick,e.positioningRef),c=e.menuProps,u=Object(o.useRef)(function(){var e=is(),t=ts();Z()===Q.IOS&&gt(e,t);return e}()),d=Object(o.useRef)(Object($.a)(u.current.root,as().root)),p=Object(o.useRef)(Object($.a)(u.current.root,function(){var e=ss(),t=ns();Z()===Q.IOS&&gt(e,t);return e}().root)),g=Object(o.useRef)(function(){var e=ls(),t=rs();Z()===Q.IOS&&gt(e,t);return e}()),h=Object(o.useRef)(cs().root),f=Object(o.useRef)(us().root),m=Object(r.__read)(Object(o.useState)(u.current.root),2),v=m[0],b=m[1],y=Object(r.__read)(Object(o.useState)(g.current.root),2),C=y[0],O=y[1];Object(o.useEffect)((function(){n?(b(p.current),O(f.current)):a?(b(d.current),O(h.current)):(b(u.current.root),O(g.current.root))}),[n,a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(se.a,{className:v,title:t,"aria-haspopup":!0,"aria-expanded":a,role:"button",icon:{className:C,children:a?i.a.createElement(At.c,null):i.a.createElement(At.d,null)},disabled:n,onClick:function(){return s(!a)}}),i.a.createElement(Ii.a,{open:a,onOpenChange:function(e,t){s(t.open)},positioning:{positioningRef:l}},(_a=c,i.a.createElement(ki.a,{className:Za().menuParent},i.a.createElement(ji.a,null,_a.sections.map((function(e){return Ja(e)})))))))},ps=function(e){var t,n=e.handleClickAndUnMount,a=e.chatInputRestShyPlaceholder,s=e.isMenuButtonEnabled,l=void 0!==s&&s,c=e.isDisabled,u=e.menuButtonTitle,d=void 0===u?$e():u,p=e.handleMenuButtonClick,g=e.handleOnOpenMenu,h=e.menuProps,f=(e.overrideStyles,Object(o.useRef)()),m=Object(o.useRef)(null),v=Va(),b=Object(r.__read)(Object(o.useState)(!1),2),y=b[0],C=b[1];i.a.useEffect((function(){var e;f.current&&(null===(e=m.current)||void 0===e||e.setTarget(f.current))}),[m,f]);return c&&y&&C(!1),i.a.createElement(te,null,i.a.createElement("div",{id:"copilot-chat-input-shy",className:v.chatInputRestShy,ref:f},i.a.createElement(te,{horizontal:!0},i.a.createElement("div",{className:v.chatInputRestShyMenuButton},l&&i.a.createElement(ds,{title:d,isDisabled:c||0===(null===(t=null==h?void 0:h.sections)||void 0===t?void 0:t.length),isMenuOpen:y,setMenuOpen:C,handleClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return p&&p(),y?(C(!1),[3,4]):[3,1];case 1:return g?[4,g()]:[3,3];case 2:e.sent(),e.label=3;case 3:C(!0),e.label=4;case 4:return[2]}}))}))},menuProps:h,positioningRef:m})),i.a.createElement("div",{className:v.chatInputContainerRestShy,onClick:n,role:"textbox",tabIndex:0,"aria-disabled":c},a))))},gs=Object(Te.a)(y),hs={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:gs.neutralLight},re.a.borderRadius(gs.borderRadiusXLarge)),re.a.margin(gs.spacingHorizontalL)),re.a.padding(gs.spacingVerticalM)),re.a.border("1px","double",gs.colorTransparentStroke)),{backgroundImage:"linear-gradient(".concat(gs.neutralLight,", ").concat(gs.neutralLight,"), radial-gradient(circle at top left, ").concat(gs.themePrimary,", ").concat(gs.themeSecondary,")"),backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",rowGap:gs.spacingVerticalXS}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",gs.neutralLighterAlt)),headerWrapper:{flexDirection:"row",alignItems:"center"},headerText:{fontWeight:gs.fontWeightSemibold,marginLeft:gs.spacingHorizontalSNudge,lineHeight:gs.lineHeightBase300,whiteSpace:"pre-line"},descriptionText:{color:gs.neutralQuaternaryAlt,fontSize:gs.fontSizeBase300,lineHeight:gs.lineHeightBase300,whiteSpace:"pre-line",marginTop:gs.spacingVerticalS},tipCardIcon:{color:gs.themePrimary},actionButtonWrapper:Object(r.__assign)(Object(r.__assign)({},re.a.margin(0)),{marginTop:gs.spacingVerticalS,color:gs.neutralLight}),actionButton:Object(r.__assign)(Object(r.__assign)({float:"left",alignItems:"center",justifyContent:"center",width:"fit-content",height:gs.spacingVerticalXXL,backgroundColor:gs.themePrimary},re.a.borderRadius(gs.borderRadiusMedium)),{paddingRight:gs.spacingHorizontalS,paddingLeft:gs.spacingHorizontalS,paddingTop:"3px",paddingBottom:"5px",fontSize:gs.fontSizeBase200,lineHeight:gs.lineHeightBase200,color:gs.neutralLight,":hover":Object(r.__assign)(Object(r.__assign)({backgroundColor:gs.themeTertiary,color:gs.neutralLight},re.a.border("1px","solid",gs.colorNeutralForegroundStaticInverted)),{":active":Object(r.__assign)({backgroundColor:gs.themeDarker,color:gs.neutralLight},re.a.border("1px","solid",gs.colorNeutralForegroundStaticInverted))})})},fs=Object(X.a)(hs),ms=i.a.memo((function(e){var t=e.headerText,n=e.descriptionTextList,r=e.buttonTitle,o=e.onClick,a=e.overrideStyles,s=e.icon,l=T(),c=fs();!function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n]);e.rootHighContrast=Object($.a)(e.root,e.rootHighContrast)}(c,a);var u;return i.a.createElement(te,{style:l?c.rootHighContrast:c.root,customProperties:{role:nt,"aria-labelledby":"tipCardHeaderText","aria-describedby":"tipCardDescriptionText"}},i.a.createElement(te,{style:c.headerWrapper},s&&(u=s,i.a.createElement(u,{className:c.tipCardIcon})),i.a.createElement(xe.a,{id:"tipCardHeaderText",className:c.headerText},t)),i.a.createElement(te,null,(null!=n?n:[]).map((function(e,t){return i.a.createElement(xe.a,{key:t,id:"tipCardDescriptionText",className:c.descriptionText},e)}))),r&&o?i.a.createElement("div",{className:c.actionButtonWrapper},i.a.createElement(se.a,{appearance:"primary",className:c.actionButton,onClick:o,title:r},r)):null)}));!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(Da||(Da={}));var vs,bs,ys,Cs,Os={fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system"},Ss=Object(Te.a)(y),Es=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:Ss.neutralSecondaryAlt,alignItems:"flex-start"},vt.a.body1),{fontStyle:"normal"}),re.a.gap("1px")),{content:"attr(title)"}),xs={color:Ss.neutralQuaternary},Is=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),re.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(r.__assign)({},re.a.outline(0))}),ws={userInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Is),{paddingRight:"2px",fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system",outlineStyle:"none"}),{"&:focus":Object(r.__assign)({},re.a.outline(0)),"&:focus::after":Object(r.__assign)(Object(r.__assign)({},Es),Os),"&::after":Object(r.__assign)(Object(r.__assign)({},Es),Os)})},Ts={userInput:{"&:focus::after":xs,"&::after":xs}},ks=Object(X.a)(ws),js=Object(X.a)(Ts),Ps=i.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,a=e.placeholderText,s=e.chatInputTabIndex,l=e.isDisabled,c=e.handleKeyDown,u=e.handleKeyUp,d=e.handleOnPaste,p=e.handleOnBeforeInput,g=e.handleOnInput,h=e.handleOnChatInputControlMount,f=e.handleOnChatInputControlUnmount,m=Object(o.useRef)();Object(o.useImperativeHandle)(t,(function(){return{setInputText:function(e){v(e)},updateInputText:function(e,t){switch(t){case Da.InsertAtCursor:y(e);break;case Da.Replace:v(e)}},getInputText:function(){return b()},getInputSpanElement:function(){return m.current},setFocus:function(){C()},getGhostText:function(){var e,t;return null!==(t=null===(e=m.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;return null===(t=m.current)||void 0===t?void 0:t.setAttribute("title",e)}}}));var v=function(e){var t=m.current;t&&(t.innerText=e)},b=function(){var e=et,t=m.current;return t&&(e=t.innerText),e},y=function(e){var t=window.getSelection();t.rangeCount&&(t.deleteFromDocument(),t.getRangeAt(0).insertNode(document.createTextNode(e)),t.collapseToEnd())},C=function(){if(!l){var e=m.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(o.useEffect)((function(){return h&&h(),function(){f&&f()}}),[]);var O=Object(o.useRef)(ks()),S=Object(o.useRef)(js()),E=Object(r.__read)(Object(o.useState)(O.current.userInput),2),x=E[0],I=E[1];return Object(o.useEffect)((function(){n&&I(Object($.a)(O.current.userInput,n))}),[n]),Object(o.useEffect)((function(){l&&I(Object($.a)(O.current.userInput,S.current.userInput))}),[l]),i.a.createElement("span",{ref:m,className:x,title:a,"aria-label":a,role:"textbox",tabIndex:s,contentEditable:!l,suppressContentEditableWarning:!l,onKeyDown:c,onKeyUp:u,onPaste:d,onBeforeInput:p,onInput:g,spellCheck:!(Y===Q.MACOS)})})),As=n(3444),_s=n(1026),Ds=Object(Te.a)(y),Ls=Object(X.a)({root:{backgroundColor:"transparent"}}),Ms=Object(X.a)({root:Object(r.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:Ds.neutralTertiaryAlt,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},re.a.padding("16px"))}),Bs=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px solid")),re.a.borderColor("transparent")),re.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),Rs=Object(X.a)({root:{backgroundColor:Ds.themePrimary,color:Ds.neutralLight,"&:hover":{backgroundColor:"".concat(Ds.themePrimary," !important")}}}),Fs=Object(X.a)({root:{backgroundColor:Ds.neutralLight,color:Ds.black,"&:hover":Object(r.__assign)(Object(r.__assign)({},re.a.borderColor("".concat(Ds.themePrimary))),{backgroundColor:"".concat(Ds.neutralLight," !important")})}}),Ns=Object(X.a)({root:{color:Ds.themePrimary,"&:hover":{color:Ds.themePrimary},fontSize:"12px"}}),Hs=Object(X.a)({root:{height:"63px",bottom:"12px"}}),Us=Object(X.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),Vs=Object(X.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:Ds.neutralQuaternaryAlt,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),zs=Object(X.a)({root:{fontWeight:"bold",color:Ds.black,fontSize:"12px",paddingBottom:"0px"}}),Gs=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,a=e.microphonePermissionErrorImagePath,s=e.showHelpLink,l=e.tryAgainOnClickHandler,c=e.notNowOnClickHandler,u=Object($.a)(Bs().root,Rs().root),d=Object($.a)(Bs().root,Fs().root),p=Vs().root,g=Object($.a)(p,zs().root),h=Ns().root,f=Hs().root,v=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e;t&&(null===(e=v.current)||void 0===e||e.focus())}),[t]),i.a.createElement(m.a,{className:Ls().root},i.a.createElement(fe.a,{modalType:"modal",open:t},i.a.createElement(me.a,{className:Ms().root,tabIndex:0},i.a.createElement(ve.a,null,i.a.createElement(be.a,{className:g},n),i.a.createElement(Ce.a,null,a&&i.a.createElement(Jt.a,{className:f,alt:"",src:a,width:"252px",height:"51px"}),i.a.createElement(_s.a,{className:p},r),s&&i.a.createElement(To.a,{inline:!0,className:h,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},lt()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),i.a.createElement(Vt.a,{className:Us().root},i.a.createElement(ye.a,{disableButtonEnhancement:!0},i.a.createElement(se.a,{ref:v,className:d,appearance:"secondary",onClick:c},lt()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),i.a.createElement(se.a,{className:u,appearance:"primary",onClick:l},lt()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(vs||(vs={}));var Ws=Object(Te.a)(y),Qs=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:Ws.neutralLight,backgroundPositionX:"center",backgroundPositionY:"center"},re.a.borderRadius("8px")),re.a.borderColor(Ws.neutralLight)),(bs={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},bs["&:hover .".concat(bt.a.icon)]={color:Ws.themePrimary},bs["&:hover:active .".concat(bt.a.icon)]={color:Ws.themePrimary},bs.display="flow",bs))}),qs=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Ws.themePrimary,color:Ws.neutralLight},re.a.borderRadius("50%")),(ys={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Ws.themeLight)},"60%":{boxShadow:"0 0 0 8px ".concat(Ws.themeLight)},"100%":{boxShadow:"0 0 0 0 ".concat(Ws.themeLight)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},ys["&.".concat(bt.a.icon)]={color:Ws.neutralLight},ys["&:hover .".concat(bt.a.icon)]={color:Ws.neutralLight},ys["&:active .".concat(bt.a.icon)]={color:Ws.neutralLight},ys["&:hover:active .".concat(bt.a.icon)]={color:Ws.neutralLight},ys["&:hover"]={backgroundColor:Ws.themePrimary,color:Ws.neutralLight},ys["&:hover:active"]={backgroundColor:Ws.themePrimary,color:Ws.neutralLight},ys))}),Ks=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Ws.neutralTertiary},re.a.borderColor(Ws.neutralTertiary)),(Cs={"&:hover":Object(r.__assign)({backgroundColor:Ws.neutralTertiary},re.a.borderColor(Ws.neutralTertiary))},Cs["&:hover .".concat(bt.a.icon)]={color:Ws.neutralQuaternary},Cs["&:hover:active .".concat(bt.a.icon)]={color:"".concat(Ws.neutralQuaternary," !important")},Cs))}),Ys=Object(X.a)({root:{position:"relative",marginRight:"8px"}}),Zs=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:Ws.neutralTertiary},re.a.borderRadius("50%")),{color:Ws.themePrimary}),loader:Object(r.__assign)(Object(r.__assign)({color:Ws.neutralLight},re.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Ws.themePrimary,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Js=(Object(X.a)({root:{color:Ws.neutralPrimary}}),Object(X.a)({root:{color:Ws.themePrimary}}),Object(X.a)({root:{color:Ws.neutralQuaternary}}),function(e){var t=e.isDisabled,n=e.microphoneButtonProps,a=Object(r.__read)(Object(o.useState)(!1),2),s=a[0],l=a[1],c=Object(r.__read)(Object(o.useState)(!1),2),u=c[0],d=c[1];Object(o.useEffect)((function(){n.isMicrophoneListening?(l(!1),f(b.current)):f(p.current.root)}),[n.isMicrophoneListening]),Object(o.useEffect)((function(){t?f(m.current):n.isMicrophoneListening||f(p.current.root)}),[t]),Object(o.useEffect)((function(){n.microphoneState===vs.Loading?(l(!0),f(v.current)):(l(!1),n.microphoneState===vs.Uninitialized&&f(p.current.root))}),[n.microphoneState]);var p=Object(o.useRef)(Qs()),g=Object(r.__read)(Object(o.useState)(p.current.root),2),h=g[0],f=g[1],m=Object(o.useRef)(Object($.a)(p.current.root,Ks().root)),v=Object(o.useRef)(Object($.a)(p.current.root,Zs().root)),b=Object(o.useRef)(Object($.a)(p.current.root,qs().root));return i.a.createElement("div",{className:Ys().root},i.a.createElement(se.a,{className:h,title:n.title,"aria-label":n.title,role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},icon:n.isMicrophoneListening||u||s?i.a.createElement(As.a,null):i.a.createElement(As.b,null),onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t}),s&&i.a.createElement("div",{className:Zs().loader}),i.a.createElement(Gs,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))});function Xs(e){var t,n,r,o,i,a,s,l={chatInput:null!==(t=e.chatInput)&&void 0!==t?t:{},chatInputContainer:null!==(n=e.chatInputContainer)&&void 0!==n?n:{},userInput:null!==(r=e.userInput)&&void 0!==r?r:{},chatInputButtons:null!==(o=e.chatInputButtons)&&void 0!==o?o:{},chatInputLeftButtons:null!==(i=e.chatInputLeftButtons)&&void 0!==i?i:{},chatInputRightButtons:null!==(a=e.chatInputRightButtons)&&void 0!==a?a:{},contextualMenu:null!==(s=e.contextualMenu)&&void 0!==s?s:{}};return Object(X.a)(l)}var $s,el=Object(Te.a)(y),tl=Xs({chatInput:Object(r.__assign)({},re.a.borderRadius(el.borderRadiusXLarge)),contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding(0)),{maxWidth:"288px",backgroundColor:el.neutralLight,boxShadow:el.shadow16}),re.a.borderRadius("12px"))}),nl=Xs({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({left:"2",width:"97%",height:"4px"},re.a.borderRadius(0,0,"12px","12px")),{backgroundImage:"linear-gradient(to right, ".concat(el.themePrimary,", ").concat(el.themeSecondary,")")})}}}),rl=Object(Te.a)(y),ol={chatInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:rl.neutralPrimary,backgroundColor:rl.neutralLight},re.a.border("1px","solid",rl.neutralLighterAlt)),re.a.borderRadius(rl.borderRadiusXLarge)),re.a.margin(0,"16px","16px","16px")),re.a.padding("4px")),re.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(r.__assign)({},re.a.margin("12px","12px","4px","12px")),userInput:{},chatInputButtons:Object(r.__assign)(Object(r.__assign)({backgroundColor:rl.neutralLight,width:"100%",flexDirection:"row",flexWrap:"wrap"},re.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{alignSelf:"flex-end",display:"flex"},contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},re.a.padding("6px")),{backgroundColor:rl.neutralLight,boxShadow:rl.shadow4}),re.a.borderRadius("8px"))},il=Object(X.a)(ol),al=Object(X.a)({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},re.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(rl.themePrimary,", ").concat(rl.themeSecondary,")")})}}}),sl=Object(X.a)({chatInputRightButtons:{display:"contents"}}),ll=Object(X.a)({chatInput:{backgroundColor:rl.neutralTertiary},chatInputButtons:{backgroundColor:rl.neutralTertiary}}),cl=Object(Te.a)(y),ul=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({width:"40px",height:"40px",maxWidth:"unset",backgroundColor:"transparent"},re.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent"))})}),dl=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent")),{"&:hover":Object(r.__assign)({backgroundColor:"transparent"},re.a.borderColor("transparent"))})}),pl=Object(X.a)({root:{color:cl.themePrimary}}),gl=Object(Te.a)(y),hl=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:gl.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},re.a.borderColor(gl.neutralLight)),re.a.borderRadius(gl.borderRadiusXLarge)),{marginRight:"2px",width:"32px",height:"32px","&:hover":{backgroundColor:gl.neutralTertiaryAlt}})}),fl=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:gl.neutralTertiary},re.a.borderColor(gl.neutralTertiary)),{"&:hover":Object(r.__assign)({backgroundColor:gl.neutralTertiary},re.a.borderColor(gl.neutralTertiary))})}),ml=Object(X.a)({root:{color:gl.neutralPrimary}}),vl=Object(X.a)({root:{color:gl.themePrimary}}),bl=Object(X.a)({root:{color:gl.neutralQuaternary}}),yl=function(e){var t=e.title,n=e.isDisabled,a=e.handleClick,s=e.isInputEmpty,l=Object(r.__read)(i.a.useState(!1),2),c=l[0],u=l[1],d=Object(o.useRef)(function(){var e=hl(),t=ul();Z()===Q.IOS&&gt(e,t);return e}()),p=Object(o.useRef)(Object($.a)(d.current.root,function(){var e=fl(),t=dl();Z()===Q.IOS&&gt(e,t);return e}().root)),g=Object(o.useRef)(ml()),h=Object(o.useRef)(vl().root),f=Object(o.useRef)(bl().root),m=Object(o.useRef)(function(){var e={root:""},t=pl();Z()===Q.IOS&&gt(e,t);return e}().root),v=Object(r.__read)(Object(o.useState)(d.current.root),2),b=v[0],y=v[1],C=Object(r.__read)(Object(o.useState)(g.current.root),2),O=C[0],S=C[1];Object(o.useEffect)((function(){n?(y(p.current),S(f.current)):(S(c?h.current:s?g.current.root:m.current),y(d.current.root))}),[n,c,s]);var E,x,I,w=J()?uo.f:uo.h,T=J()?uo.e:uo.g;return i.a.createElement(se.a,{className:b,title:t,"aria-label":t,role:"button",onMouseEnter:function(){return u(!0)},onMouseLeave:function(){return u(!1)},icon:{className:O,children:(E=w,x=T,I=Object(Ve.a)(x,E),i.a.createElement(I,null))},onClick:a,disabled:n})},Cl=i.a.forwardRef((function(e,t){var n,a=e.isDisabled,s=e.overrideStyles,l=e.chatInputTabIndex,c=void 0===l?0:l,u=e.chatInputContainerTabIndex,d=void 0===u?-1:u,p=e.chatInputContainerTitle,g=void 0===p?lt()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area":p,h=e.placeholderText,f=void 0===h?lt()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own":h,m=e.maxInputCharLimit,v=void 0===m?300:m,b=e.handleKeyDown,y=e.handleKeyUp,C=e.handleOnPaste,O=e.handleOnBeforeInput,S=e.handleOnInput,E=e.submitButtonTitle,x=void 0===E?lt()?OfficeaicopilotStrings.SubmitButtonTitle:"Send":E,I=e.handleSubmitButtonClick,w=e.isMenuButtonEnabled,T=void 0!==w&&w,k=e.shouldOpenMenuOnEmptyInput,j=void 0!==k&&k,P=e.menuButtonTitle,A=void 0===P?$e():P,_=e.handleMenuButtonClick,D=e.handleOnOpenMenu,L=e.handleOnChatInputControlMount,M=e.handleOnChatInputControlUnmount,B=e.handleOnBlur,R=e.menuProps,F=e.microphoneProps,N=Object(o.useRef)(),H=Object(o.useRef)(),U=Object(o.useRef)(null);F&&!F.title&&(F.title=lt()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone"),Object(o.useImperativeHandle)(t,(function(){return{setInputText:function(e){var t;null===(t=N.current)||void 0===t||t.setInputText(e),J()&&K(0==e.length)},updateInputText:function(e,t){var n;null===(n=N.current)||void 0===n||n.updateInputText(e,t)},getInputText:function(){var e;return null===(e=N.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=N.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){X(e)},getGhostText:function(){return Y()},setFocus:function(){var e;null===(e=N.current)||void 0===e||e.setFocus()},closeMenu:function(){T&&z&&G(!1)}}}));var V=Object(r.__read)(Object(o.useState)(!1),2),z=V[0],G=V[1],W=Object(r.__read)(Object(o.useState)(!0),2),q=W[0],K=W[1],Y=function(){var e;return null===(e=N.current)||void 0===e?void 0:e.getGhostText()},X=Object(o.useCallback)((function(e){var t;null===(t=N.current)||void 0===t||t.setGhostText(e)}),[]);Object(o.useEffect)((function(){X(f)}),[f,X]),i.a.useEffect((function(){var e;H.current&&(null===(e=U.current)||void 0===e||e.setTarget(H.current))}),[U,H]);var ee=function(){var e=il(),t=tl();Z()===Q.IOS&&gt(e,t);return e}(),ne=function(){var e=al(),t=nl();Z()===Q.IOS&&gt(e,t);return e}(),re=ll(),oe=sl(),ie=Object(o.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),ae=Object(o.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),se=Object(o.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),le=Object(r.__read)(Object(o.useState)(ee),2),ce=le[0],ue=le[1];Object(o.useEffect)((function(){for(var e in ee)ie.current[e]=Object($.a)(ee[e],ne[e]);for(var e in ee)ae.current[e]=Object($.a)(ee[e],re[e]);for(var e in ee)se.current[e]=Object($.a)(ne[e],ee[e],oe[e])}),[]),Object(o.useEffect)((function(){if(s)for(var e in ee)ie.current[e]=Object($.a)(ee[e],s[e])}),[s]),Object(o.useEffect)((function(){ue(a?ae.current:ie.current)}),[a,s]),Object(o.useEffect)((function(){(null==F?void 0:F.isMicrophoneListening)?ue(se.current):ue(ie.current)}),[null==F?void 0:F.isMicrophoneListening]);return i.a.createElement("div",null,i.a.createElement("div",{id:"copilot-chat-input",className:ce.chatInput,title:g,tabIndex:d,onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a||document.activeElement===(null===(e=N.current)||void 0===e?void 0:e.getInputSpanElement())?[2]:j&&T&&(null===(t=N.current)||void 0===t?void 0:t.getInputText())==et&&!z?D?[4,D()]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return G(!0),[3,4];case 3:z&&G(!1),r.label=4;case 4:return null===(n=N.current)||void 0===n||n.setFocus(),[2]}}))}))},onBlur:function(){var e;J()&&!z&&(null===(e=N.current)||void 0===e?void 0:e.getInputText())===et&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return B(),[2]}))}))}),100)},ref:H},i.a.createElement("div",{className:ce.chatInputContainer},i.a.createElement(Ps,{ref:N,styleOverrideClassName:s?s.userInput:"",placeholderText:f,chatInputTabIndex:c,isDisabled:a,handleKeyDown:function(e){var t,n,r;b&&!b(e)||(J()&&("Backspace"===e.key?K((null===(t=N.current)||void 0===t?void 0:t.getInputText().length)<=1):K(!1)),"Enter"===e.key&&(e.preventDefault(),I(null===(n=N.current)||void 0===n?void 0:n.getInputText()),null===(r=N.current)||void 0===r||r.setInputText(et),X(f)))},handleKeyUp:function(e){var t;y&&!y(e)||((null===(t=N.current)||void 0===t?void 0:t.getInputText())===et?X(f):Y()===f&&X(et))},handleOnPaste:function(e){var t;if(!C||C(e)){X(et),e.preventDefault();var n=e.clipboardData.getData("Text"),r=n.length||0,o=null===(t=N.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(i.rangeCount){var a=i.toString(),s=o.length-a.length,l=n.substring(0,v-s);i.deleteFromDocument(),s+r>=v?i.getRangeAt(0).insertNode(document.createTextNode(l)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()}}},handleOnBeforeInput:function(e){O&&!O(e)||(G(!1),X(et))},handleOnInput:function(e){!S||S(e)},handleOnChatInputControlMount:L,handleOnChatInputControlUnmount:M}),i.a.createElement("span",{"aria-hidden":!0},"‍")),i.a.createElement(te,{style:ce.chatInputButtons},i.a.createElement("div",{className:ce.chatInputLeftButtons},T&&i.a.createElement(ds,{title:A,isDisabled:a||0===(null===(n=null==R?void 0:R.sections)||void 0===n?void 0:n.length),isMenuOpen:z,setMenuOpen:G,handleClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return _&&_(),z?(G(!1),[3,4]):[3,1];case 1:return D?[4,D()]:[3,3];case 2:e.sent(),e.label=3;case 3:G(!0),e.label=4;case 4:return[2]}}))}))},positioningRef:U,menuProps:R})),i.a.createElement("div",{className:ce.chatInputRightButtons},F&&i.a.createElement("span",{title:function(){switch(F.microphoneState){case vs.Enabled:return F.isMicrophoneListening?lt()?OfficeaicopilotStrings.MicrophoneListeningStatus:"Microphone Listening":lt()?OfficeaicopilotStrings.MicrophonePausedStatus:"Microphone Paused";case vs.Disabled:return lt()?OfficeaicopilotStrings.MicrophoneDisabledStatus:"Microphone Disabled";case vs.Loading:return lt()?OfficeaicopilotStrings.MicrophoneLoadingStatus:"Microphone Loading"}}()},i.a.createElement(Js,{"aria-live":"assertive",isDisabled:a,microphoneButtonProps:F})),i.a.createElement(yl,{title:x,isDisabled:a,handleClick:function(e){var t,n;e.stopPropagation();var r=null===(t=N.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==et&&(I(r),null===(n=N.current)||void 0===n||n.setInputText(et),X(f))},isInputEmpty:q})))))})),Ol=i.a.memo(Cl),Sl=n(3560),El="/";!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}($s||($s={}));var xl=n(478),Il="https://",wl=Il+"outlook-1-cdn.azureedge.",Tl="midgard/",kl="/agsc-"+Tl,jl="versionless/",Pl=Il+"res.cdn.office.net/"+Tl;var Al,_l,Dl,Ll=n(2073),Ml=n(183),Bl="".concat((Al={environment:"Prod"},Al?Al.publicPath?Al.publicPath:function(e){switch(e.environment){case"Gallatin":return Il+"res-1.cdn.partner.office365.cn/"+Tl;case"AG08":return wl+"eaglex.ic.gov"+kl;case"AG09":return wl+"microsoft.scloud"+kl;case"GccHigh":return Il+"res-gcch.cdn.office.net/"+Tl;case"DoD":return Il+"res-dod.cdn.office.net/"+Tl;default:return Pl}}(Al)+jl:Pl+jl)).concat("graph-search-local-0.4.2594-0.14.3"),Rl=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-nudge","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-oa-email-ecc","mc-editor-enable-meeting-banner","mc-editor-expanded-ecc-responsive","mc-editor-oa-debug"],Fl=function(){function e(){this.staticSettings={isAggregatedLoggingEnabled:!0,controlIconSetName:"FabricMDL2Icons",showOptionsButton:!0,synonymsEndPoint:Ll.b.Prod,licenseType:Ml.b.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:4,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,oaSettings:{isContextualCardEnabled:!0,disableInlineSuggestionTooltips:!0,mockResults:!1,e2eMetric:!0,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:!0,bestMatchConfig:{enabled:!0,maxResults:Nl}}},this.getFlightsToTrack=function(e,t,n){var o=Object(r.__spreadArray)([],Object(r.__read)(Rl),!1);return(null==n?void 0:n.length)>0&&(o=o.concat.apply(o,Object(r.__spreadArray)([],Object(r.__read)(n),!1))),(null==t?void 0:t.enableChatCIQ)&&o.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&o.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&o.push("vivatopics"),e&&o.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&o.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&o.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableMeetingBanner)&&o.push("mc-editor-enable-meeting-banner"),(null==t?void 0:t.enableSearchBar)&&o.push("mc-editor-enable-searchbar"),o}}return e.prototype.composeSettings=function(e,t){var n,r,o,i,a,s=Object.assign({},this.staticSettings.oaSettings,{enableOaClient:null===(n=e.featureFlags)||void 0===n?void 0:n.enableHybridWorkflow,customizedEmptyECCSuggestionsString:e.customizedEmptyECCSuggestionsString,updateResultsTimeout:e.resultTime?e.resultTime:6e3,entitiesEnabled:t,scopesConfig:e.enableAutomaticScoping?{enabled:!0,maxResults:Nl,enableAutomaticScoping:!0}:{enabled:!0,maxResults:Nl,enableAutomaticScoping:!1}});return Object.assign({},this.staticSettings,{appId:e.hostAppId,flightsToTrack:this.getFlightsToTrack(!!(null===(r=e.featureFlags)||void 0===r?void 0:r.enableHybridWorkflow),e.featureFlags,e.flightsToTrack),defaultLocale:e.hostDefaultLocale,editorEndPoint:e.isDogfoodEnvironment?Ll.a.Lab:Ll.a.Prod,hostMetadata:{appName:e.hostAppName,appPlatform:e.hostAppPlatform,appScenario:e.hostAppScenario,sessionId:e.sessionId,releaseAudienceGroup:e.isDogfoodEnvironment?"Dogfood":"Production"},orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:null!==(o=e.augloopEndPoint)&&void 0!==o?o:"https://augloop-dogfood.officeppe.com",augLoopAuthTokenCallback:e.augLoopAuthTokenCallback,substrateAuthTokenCallback:e.substrateAuthTokenCallback},oaSettings:s,serviceSettings:{hybridAugloop:{enabled:!!(null===(i=e.featureFlags)||void 0===i?void 0:i.enableHybridWorkflow),enableGraphSearchLocal:!!(null===(a=e.featureFlags)||void 0===a?void 0:a.enableHybridWorkflow),wasmConfig:{binaryPath:Bl,scriptPath:Bl}}},isDarkMode:e.isDarkMode})},e}(),Nl=15;function Hl(e,t){var n=new Fl,r=function(e){var t=[];return e.forEach((function(n){t.push({enabled:!0,entityType:n,maxResults:1===e.length?void 0:Nl})})),t}(t);return n.composeSettings(e,r)}!function(e){e.ChatECCInjectionError="Chat_ECC_Injection_Error",e.CIQForcedInvokeException="CIQ_Forced_Invoke_Exception",e.CIQThemeUpdateException="CIQ_Theme_Update_Exception",e.EditorBootstrapException="Editor_Bootstrap_Exception",e.EditorShutdownException="Editor_Shutdown_Exception",e.EmailECCInjectionError="Email_ECC_Injection_Error",e.EventECCInjectionError="Event_ECC_Injection_Error",e.FileECCInjectionError="File_ECC_Injection_Error",e.PeopleECCInjectionError="People_ECC_Injection_Error",e.UnsupportedSuggestionTypeError="Unsupported_Suggestion_Type_Error"}(_l||(_l={})),function(e){e.EditorShutdownSuccess="Editor_Shutdown_Success",e.EditorCIQForceInvoke="Editor_CIQ_Force_Invoke",e.EditorCIQThemeUpdate="Editor_CIQ_Theme_Update",e.EditorBootstrapSuccess="Editor_Bootstrap_Success"}(Dl||(Dl={}));var Ul=!1;var Vl=function(e,t){Ul&&(null==t?console.log("Chat Editor log:",e):console.log("Chat Editor log:",e,t))};function zl(e){var t=null==e?void 0:e.message;return void 0!==t?t:""}var Gl=void 0;function Wl(e){Gl&&(Gl.logError(e),Vl(e))}function Ql(e,t){Gl&&Gl.logErrorTelemetry&&Gl.logErrorTelemetry(e,t)}function ql(e,t){Gl&&Gl.logSuccessTelemetry&&Gl.logSuccessTelemetry(e,t)}var Kl,Yl=n(2077),Zl=n(2076),Jl=n(107),Xl=n.n(Jl);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(Kl||(Kl={}));var $l=Kl.web;function ec(){return $l===Kl.IOS}var tc,nc,rc;!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(tc||(tc={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(nc||(nc={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(rc||(rc={}));var oc=Object(X.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),ic=function(e){var t=e.children,n=e.style,i=e.horizontal,a=void 0!==i&&i,s=e.reverse,l=void 0!==s&&s,c=e.customProperties,u=function(e,t,n,r){var o=e.root;return t&&(o=Object($.a)(o,t)),n?o=r?Object($.a)(o,e.horizontalReverse):Object($.a)(o,e.horizontal):r&&(o=Object($.a)(o,e.verticalReverse)),o}(oc(),n,a,l);return o.createElement("div",Object(r.__assign)({className:u},c),t)},ac=Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),sc=(Object(r.__assign)(Object(r.__assign)({},b.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}});function lc(e){var t=sc(e);return Object(X.a)(t)}var cc=lc({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),uc=Object(Te.a)(ac),dc=lc({tooltipText:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{color:uc.neutralPrimary}),badgeText:Object(r.__assign)({},vt.a.caption2Strong),tooltipStack:Object(r.__assign)({},re.a.gap("6px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),pc=function(){var e=dc(),t=cc();if($l===Kl.IOS)gc(e,t);return e},gc=function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n])},hc=function(e){var t=e.styles,n=e.clpSensitivityIndicatorData,r=pc();return gc(r,t),i.a.createElement(so.a,{content:i.a.createElement(ic,{style:r.tooltipStack},i.a.createElement("span",{className:r.tooltipText},n.tooltipText),n.badgeText&&i.a.createElement(co.a,{shape:"rounded",appearance:"filled",color:"informative",className:r.badgeText},n.badgeText)),relationship:"label"},i.a.createElement("span",{className:r.icon,tabIndex:0},n.icon?i.a.createElement(n.icon,null):function(e){switch(void 0===e&&(e=rc.NonEncryption),e){case rc.Encryption:return ec()?i.a.createElement(uo.q,null):i.a.createElement(uo.o,null);case rc.Warning:return ec()?i.a.createElement(po.e,null):i.a.createElement(po.c,null);case rc.NonEncryption:default:return ec()?i.a.createElement(uo.m,null):i.a.createElement(uo.k,null)}}(n.iconType)))},fc=n(3343),mc=n(2421),vc=n(1618),bc=n(3344),yc=n(841),Cc=Object(yc.a)({palette:Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),Oc=(Object(yc.a)({palette:Object(r.__assign)(Object(r.__assign)({},b.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(e){var t=e.themePalette,n=e.isDarkMode,i=e.children,a=e.className,s=Object(r.__assign)(Object(r.__assign)({},Cc.palette),t),l=Object(bc.a)(s),c=n?Object(mc.a)(l):Object(vc.a)(l);return o.createElement(m.a,{className:a,theme:c},i)}),Sc=Object(X.a)({ciqInputText:{color:On.a.colorBrandForeground1}}),Ec=i.a.forwardRef((function(e,t){var n=e.text,a=e.id,s=e.copilotChatTheme,l=e.isDarkModeEnabled,c=Object(r.__read)(Object(o.useState)(e.isLoading),2),u=c[0],d=c[1],p=Object(r.__read)(Object(o.useState)(e.clpSensitivityIndicatorData),2),g=p[0],h=p[1],f=Sc();return Object(o.useImperativeHandle)(t,(function(){return{setLoading:function(e){d(e)},setSensitivity:function(e){h(e)}}})),i.a.createElement("span",{contentEditable:!1,className:"user-ciq-selection-id",id:a,style:{display:"inline"}},i.a.createElement("span",{className:f.ciqInputText},n),i.a.createElement("span",{style:{display:"inline-block",verticalAlign:"text-bottom"}},u?i.a.createElement(fc.a,{size:"extra-tiny"}):i.a.createElement(Oc,{themePalette:s,isDarkMode:l},g&&i.a.createElement(hc,{clpSensitivityIndicatorData:g}))))})),xc=function(){function e(){this.ciqId=0,this.ciqUrls=new Map,this.queryAnnotationSet=new Map}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,o,a,s){if(e.suggestion&&e.queryRange){++this.ciqId;var l="userCIQSelectionId-"+this.ciqId;this.ciqUrls.set(l,e.suggestion.url),this.queryAnnotationSet.set(l,e.suggestion.queryAnnotation);var c={text:e.suggestion.text,id:l,clpSensitivityIndicatorData:t,isLoading:n,copilotChatTheme:o,isDarkModeEnabled:a},u=i.a.createElement(Ec,Object(r.__assign)(Object(r.__assign)({},c),{ref:s}),null),d=document.createElement("span");if(Xl.a.render(u,d),e.queryRange.endContainer){var p=e.queryRange.endContainer.textContent;p&&" "===p.charAt(p.length-1)&&(e.queryRange.endContainer.textContent=p.slice(0,-1),e.queryRange.setEndAfter(e.queryRange.endContainer),e.queryRange.collapse(!1))}e.queryRange.insertNode(d),d.insertAdjacentText("beforebegin"," "),e.queryRange.collapse(!1);var g=document.createTextNode(" ");e.queryRange.insertNode(g),e.queryRange.setEndAfter(g),e.queryRange.collapse(!1);var h=window.getSelection();null==h||h.removeAllRanges(),null==h||h.addRange(e.queryRange),Vl("renderAndTrackSelectedSuggestion: rendered suggestion")}else Vl("renderAndTrackSelectedSuggestion: nothing to render")},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n;if(this.ciqUrls.size<=0)Vl("generatCopilotOdslSignalLinks: nothing to generate");else{var o=Object(r.__spreadArray)([],Object(r.__read)(this.ciqUrls.keys()),!1);try{for(var i=Object(r.__values)(o),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.ciqUrls.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.ciqUrls.size<=0)){for(var l=[],c=0,u=e.childNodes,d=0;d<u.length;d++){var p=u[d];if(p.nodeType===Node.ELEMENT_NODE){var g=p.childNodes[0];if(g&&g.className.includes("user-ciq-selection-id")&&g.id){var h=g.textContent.length;this.ciqUrls.has(g.id)&&l.push({type:Zl.a.URL,range:[c,c+h],value:this.ciqUrls.get(g.id)}),c+=h}}else(""!=p.textContent.trim()||c>0)&&(c+=p.textContent.length)}return Vl("generatCopilotOdslSignalLinks: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.value,", range: [").concat(t.range[0],", ").concat(t.range[1],"]")}),""))),l}Vl("generatCopilotOdslSignalLinks: nothing to generate after cleanup")}},e.prototype.generateQueryAnnotations=function(e){var t,n;if(this.queryAnnotationSet.size<=0)Vl("generateQueryAnnotations: nothing to generate");else{var o=Object(r.__spreadArray)([],Object(r.__read)(this.queryAnnotationSet.keys()),!1);try{for(var i=Object(r.__values)(o),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.queryAnnotationSet.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.queryAnnotationSet.size<=0)){for(var l=[],c=e.childNodes,u=0;u<c.length;u++){var d=c[u];if(d.nodeType===Node.ELEMENT_NODE){var p=d.childNodes[0];p&&p.className.includes("user-ciq-selection-id")&&p.id&&this.queryAnnotationSet.has(p.id)&&l.push(this.queryAnnotationSet.get(p.id))}}return Vl("generateQueryAnnotations: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.id,", text: ").concat(t.text)}),""))),l}Vl("generateQueryAnnotations: nothing to generate after cleanup")}},e}(),Ic={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}},wc={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Tc=n(2074),kc=n(2075);function jc(e){var t,n,r,o,i,a,s;switch(e.type){case Tc.a.File:return i=(u=e).FileName,o=null!==(t=u.SpoId)&&void 0!==t?t:u.AccessUrl,"DownloadableUrl"===u.AccessUrlType&&(a=u.AccessUrl),a||"DownloadableUrl"!==u.AlternateAccessUrlType||(a=u.AlternateAccessUrl),a||(a=u.AccessUrl)||(a=u.AlternateAccessUrl),a?(s={QueryAnnotationType:kc.a.File,text:i,id:o},{type:Tc.a.File,id:o,text:i,url:a,queryAnnotation:s}):(Wl("File ECC injection failed due to missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)),void Ql(_l.FileECCInjectionError,"Missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)));case Tc.a.People:return(null==(u=e)?void 0:u.EmailAddresses)&&u.DisplayName?(i=u.DisplayName,o=u.EmailAddresses[0],a=u.EmailAddresses[0]?"mailto:".concat(u.EmailAddresses[0]):"",s={QueryAnnotationType:kc.a.People,text:i,id:o},{type:Tc.a.People,id:o,text:i,url:a,queryAnnotation:s}):(Wl("People ECC injection failed due to missing EmailAddresses or DisplayName"),void Ql(_l.PeopleECCInjectionError,"Missing EmailAddresses or DisplayName"));case Tc.a.Chat:if(!(null==(u=e)?void 0:u.ThreadId))return Wl("Chat ECC injection failed due to missing ThreadId"),void Ql(_l.ChatECCInjectionError,"Missing ThreadId");if(void 0!==u.Name)i=u.Name;else if(u.ChatMembers){var l=u.ChatMembers.length-2,c=u.ChatMembers.slice(0,2).map((function(e){return e.DisplayName})).join(", ");l>0&&(c+=", +".concat(l)),i=c}else i="";return o=u.ThreadId,a="",s={QueryAnnotationType:kc.a.Chat,text:i,id:o},{type:Tc.a.Chat,id:o,text:i,url:a,queryAnnotation:s};case Tc.a.Message:return(null==(u=e)?void 0:u.ImmutableId)?(i=u.Subject,o=null===(n=u.ImmutableId)||void 0===n?void 0:n.Id,a="",s={QueryAnnotationType:kc.a.Message,text:i,id:o},{type:Tc.a.Message,id:o,text:i,url:a,queryAnnotation:s}):(Wl("Email ECC injection failed due to missing ImmutableId"),void Ql(_l.EmailECCInjectionError,"Missing ImmutableId"));case Tc.a.Event:var u;return(null==(u=e)?void 0:u.OriginalId)?(i=u.Subject,o=u.OriginalId,a=null!==(r=u.WebLink)&&void 0!==r?r:"",s={QueryAnnotationType:kc.a.Event,text:i,id:o},{type:Tc.a.Event,id:o,text:i,url:a,queryAnnotation:s}):(Wl("Event ECC injection failed due to missing OriginalId"),void Ql(_l.EventECCInjectionError,"Missing OriginalId"));default:return Wl("onItemSelected called with unsupported suggestion type ".concat(e.type)),void Ql(_l.UnsupportedSuggestionTypeError,"onItemSelected called with unsupported suggestion type ".concat(e.type))}}var Pc,Ac=function(){function e(e){this.editorProofingNode=void 0,this.editorClient=e}return e.prototype.shutdown=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),Vl("Shutting down Editor"),[4,this.editorClient.shutDown()];case 1:return t.sent(),Vl("Shutting down Editor completed successfully"),ql(Dl.EditorShutdownSuccess),[3,3];case 2:return e=t.sent(),Wl("Exception shutting down Editor:"+JSON.stringify(e)+" Error message: "+zl(e)),Ql(_l.EditorShutdownException," Error message: "+zl(e)),[3,3];case 3:return this.editorClient=null,[2]}}))}))},e.prototype.initializeCiq=function(e,t){var n=this;return this.editorProofingNode&&this.uninitialize(t.queryCharToUse),Vl("Initializing Editor for CIQ"),this.editorProofingNode=this.editorClient.spellCheck(e,".ignore-block"),this.editorClient.enableInlineSuggestionsMenu(t.entitiesEnabled,t.queryCharToUse,(function(e,n,r){Vl("Suggestion selected from CIQ: "+JSON.stringify(e)+" in range: "+JSON.stringify(n)),t.onItemSelected({suggestion:jc(e),queryRange:n,parentHtmlElement:r})}),void 0,void 0,{fitToContent:!0},t.ExpanededECC?wc:Ic,void 0,void 0,void 0,void 0,t.ExpanededECC?void 0:function(e){return Object(r.__awaiter)(n,void 0,void 0,(function(){var n,o,i,a,s;return Object(r.__generator)(this,(function(l){Vl("".concat(null==e?void 0:e.length," suggestions found")),t.onSuggestionsUpdated&&t.onSuggestionsUpdated(e.length);try{for(n=Object(r.__values)(e),o=n.next();!o.done;o=n.next())(i=o.value).groupTitle=t.menuTitle,i.groupSubtitle=t.menuSubtitle}catch(e){a={error:e}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,e]}))}))},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.ExpanededECC),new xc},e.prototype.uninitialize=function(e){this.editorProofingNode&&(Vl("Uninitializing Editor"),this.editorClient.disableInlineSuggestionsMenu(e),this.editorClient.detach(this.editorProofingNode),this.editorProofingNode=void 0)},e.prototype.forceInvokeCIQMenu=function(e,t){if(this.editorProofingNode)try{Vl("Starting to show CIQ for force invoke"),t&&this.setCurrentScope(t),this.editorClient.showExistingMenuAtCursor(1,e,!0),Vl("Showing CIQ for force invoke"),ql(Dl.EditorCIQForceInvoke)}catch(e){Wl("Exception showing CIQ for forced invoke:"+JSON.stringify(e)+" Error message: "+zl(e)),Ql(_l.CIQForcedInvokeException," Error message: "+zl(e))}},e.prototype.updateCurrentTheme=function(e){try{switch(Vl("Starting to update theme for CIQ to ".concat(e)),e){case $s.light:case $s.dark:case $s.highContrast:case $s.custom:this.editorClient.updateCurrentTheme(e);break;default:throw"Unexpected themeType: ".concat(e)}Vl("Theme updated for CIQ"),ql(Dl.EditorCIQThemeUpdate)}catch(e){Wl("Exception updating theme for CIQ:"+JSON.stringify(e)+" Error message: "+zl(e)),Ql(_l.CIQThemeUpdateException," Error message: "+zl(e))}},e.prototype.normalizeCIQEntity=function(e){switch(!0){case/file/i.test(e):return Yl.a.File;case/(people)|(person)/i.test(e):return Yl.a.People;case/(event)|(meeting)/i.test(e):return Yl.a.Event;case/chat/i.test(e):return Yl.a.Chat;case/(message)|(email)/i.test(e):return Yl.a.Message;case/(topic)/i.test(e):return Yl.a.Topic;default:return}},e.prototype.setCurrentScope=function(e){if(this.editorClient){var t=this.normalizeCIQEntity(e);if(void 0!==t){var n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}else Vl("Invoked setEntityScope with unsupported entity type ".concat(e))}},e}(),_c=function(){function e(){}return e.prototype.bootstrap=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=e.settings.isDogfoodEnvironment,Ul=i,o=e.telemLogger,Gl=o,Vl("bootstrapEditor called"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,Object(xl.a)(Hl(e.settings,e.entitiesSupported),e.telemSink,e.augloopSession)];case 2:return[4,(t=r.sent()).initializeSDK()];case 3:return r.sent(),[4,t.initializeUX(document)];case 4:return r.sent(),this.chatEditor=new Ac(t),Vl("bootstrapEditor completed successfully"),ql(Dl.EditorBootstrapSuccess),[3,6];case 5:throw n=r.sent(),Wl("Exception bootstrapping Editor:"+JSON.stringify(n)+" Error message: "+zl(n)),Ql(_l.EditorBootstrapException," Error message: "+zl(n)),n;case 6:return[2,this.chatEditor]}var o,i}))}))},e.prototype.shutdown=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,this.chatEditor.shutdown()]}))}))},e}(),Dc=function(){function e(){}return e.prototype.createInstance=function(){return new _c},e}();!function(e){e.Shimmer="shimmer",e.Blocked="blocked",e.Enabled="enabled",e.Disabled="disabled",e.Loading="loading"}(Pc||(Pc={}));class Lc{constructor(){}static getInstance(){return Lc.instance||(Lc.instance=new Lc),Lc.instance}setALSession(e){this.alSession=e}getALSession(){return this.alSession}}class Mc{constructor(e,t){this.realTimeConnection=e,this.realTimeConnection.SetErrorCallback(t),this.realTimeConnection.SetAudioBufferCallback((e=>this.OnAudioBufferCallback(e)))}Initialize(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.realTimeConnection.InitializeConnection(e)}))}StartMicrophone(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.StartMicrophone()}))}Pause(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.PauseConnection()}))}Resume(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.ResumeConnection()}))}Close(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.realTimeConnection.PauseConnection(),this.realTimeConnection.CloseConnection()}))}OnAudioBufferCallback(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){console.log("DevLog: OnAudioBufferCallback")}))}}var Bc=n(2061),Rc=n(1159),Fc=n(1784),Nc=n(893),Hc=n(2062),Uc=n(396);const Vc=3,zc=5e3,Gc="granted";var Wc;function Qc(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Wc||(Wc={}));Bc.a.dictationSettings={dictationLanguage:"en-US",useAutoPunctuation:"Intelligent",useCorrections:"true",properties:{"SpeechContext-PhraseOutput.interimResults.resultType":"Hypothesis",setFeature:"emailplm,offtrt,copilot",Profanity:"masked","SpeechConfig-Context.DataCollection.Mode":"0"}};class qc{constructor(e,t,n){this.speechToTextClient=null,this.voiceSession=null,this.isVoiceSessionActive=!1,this.closeConnectionPromise=null,this.locale=null,this.attempt=0,this.fdSpeechClientObserver={onSpeechSessionStarted:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{null!=e&&console.log("Transcription speech session ID: ",e.speechSessionId)}catch(e){this.onError(e)}})),onSpeechSessionStopped:()=>{this.speechEventEmitter.emit("SpeechSessionStopped")},onFinalText:e=>this.OnFinalResult(e),onFragmentText:e=>this.OnPartialResult(e),onSpeechRecognitionStarted:()=>{},onError:e=>{if(-1==(null==e?void 0:e.toString().indexOf("ErrorAugloopActivateAnnotations"))||this.attempt>=3)try{if(e===Rc.a.ErrorAudioCaptureAsync||e===Rc.a.ErrorAudioDevicesNotFoundError||e===Rc.a.ErrorAudioNotReadableError||e===Rc.a.ErrorAudioPermissionDeniedError)return;const t=new Error("IAugloopSpeechObserverDecorator.onError: ");this.onError(t)}catch(e){this.onError(e)}},onSpeechEnd:()=>{},onEventUpdate:e=>{},showDictationWarning:()=>{},onWarning:e=>{},showPermissionPrompt:()=>{}},this.locale=n,this.onError=e=>{throw e},this.onAudioBuffer=e=>{},this.initPromise=this.PerformInitializeConnection(),this.speechEventEmitter=new Uc.EventEmitter,this.onTranscriptText=e,this.onTranscriptPartialText=t,Bc.a.dictationSettings.dictationLanguage=this.locale}PerformInitializeConnection(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.InitializeSpeechToTextClient(),this.voiceSession=new Fc.a(void 0,this.fdSpeechClientObserver,!0,void 0,void 0,Hc.a.Dictation,null===(e=Lc.getInstance())||void 0===e?void 0:e.getALSession())}))}SetAudioBufferCallback(e){this.onAudioBuffer=e}SetErrorCallback(e){this.onError=e}InitializeConnection(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.attempt=0,this.locale=e,this.initPromise}))}StartMicrophone(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.ResumeConnection()}))}ResumeConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.isVoiceSessionActive)return Promise.resolve();if(yield this.initPromise,this.isVoiceSessionActive=!0,null==this.locale)throw new Error("Reached resume connection without a locale. Did we really initilize AugloopRealTimeTranscriptionConnection?");Bc.a.dictationSettings.dictationLanguage=this.locale,yield this.voiceSession.startVoiceSessionFromMicrophoneInput((e=>this.OnAudioBufferCallback(e)),null,null)}))}PauseConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.isVoiceSessionActive)return Promise.resolve();yield this.initPromise,this.isVoiceSessionActive=!1,yield this.voiceSession.stopMicrophoneInputAsync(),yield this.voiceSession.stopVoiceSession()}))}CloseConnection(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!=this.closeConnectionPromise||(this.closeConnectionPromise=new Promise(((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{this.voiceSession&&(this.voiceSession.endVoiceSession(),this.voiceSession.endVoiceSession(),yield this.WaitForSessionEnd()),this.speechToTextClient&&(yield this.speechToTextClient.uninitializeAsync()),this.closeConnectionPromise=null,e()}catch(e){t(e)}}))))),this.closeConnectionPromise}))}WaitForSessionEnd(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Promise(((e,t)=>{setTimeout((()=>{try{this.voiceSession&&this.voiceSession.endVoiceSession(),e()}catch(e){t(e)}}),3e4)})),t=new Promise(((e,t)=>{try{this.speechEventEmitter.once("SpeechSessionStopped",e)}catch(e){t(e)}}));yield Promise.race([e,t])}))}OnFinalResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("transcript text "+n),this.onTranscriptText(n)}catch(e){this.onError(e)}}OnPartialResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("RECOGNIZED: "+n),this.onTranscriptPartialText(""+n)}catch(e){this.onError(e)}}InitializeSpeechToTextClient(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){null!=this.closeConnectionPromise&&(yield this.closeConnectionPromise),this.speechToTextClient=new Nc.a(void 0,this.fdSpeechClientObserver,!0,!0,!0,Hc.a.Dictation,Lc.getInstance().getALSession());let e=0;do{e>0&&(yield Qc(zc)),this.attempt++,yield this.speechToTextClient.initializeAsync([Nc.b.PartialResult,Nc.b.FinalResult])}while(!this.speechToTextClient.initialized&&e++<Vc)}))}OnAudioBufferCallback(e){this.onAudioBuffer(e)}}class Kc{static createInstance(e,t,n){null==this.instance&&(this.instance=new qc(e,t,n))}static GetInstance(){return this.instance}}class Yc{static GetInstance(){return null==this.instance&&(this.instance=new Mc(Kc.GetInstance(),(e=>{}))),this.instance}}var Zc;!function(e){e[e.Completed=0]="Completed",e[e.Canceled=1]="Canceled"}(Zc||(Zc={}));class Jc{constructor(e){this.isCanceled=!1,this.tasks=e}ExecuteTaskListSequentially(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.isCanceled)return{status:Zc.Canceled};let e=null;if(this.tasks)for(const t of this.tasks)try{if(e=yield t(e),this.isCanceled)return{status:Zc.Canceled}}catch(e){if(this.isCanceled)return{status:Zc.Canceled};throw e}return{status:Zc.Completed,result:e}}))}Cancel(){this.isCanceled=!0}}class Xc{static getInstance(){return Xc._instance||(Xc._instance=new Xc),Xc._instance}startVoiceInputTimer(e,t){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield nu(t),console.log("Voice input timed out")}))),e)}stopVoiceInputTimer(){this.timerId&&clearTimeout(this.timerId)}}const $c=(e,t,n,o,i,a)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(Lc.getInstance().setALSession(a),Kc.createInstance(t,n,e),null==Kc.GetInstance())throw new Error("realTimeTranscriptionConnection is null");const s=new Jc([()=>Yc.GetInstance().Initialize(e),()=>tu(o)]);var l;yield(l=s,Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return yield null==l?void 0:l.ExecuteTaskListSequentially()}))),i(!1)}));function eu(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let e=null;if(navigator.permissions)try{e=yield navigator.permissions.query({name:"microphone"})}catch(e){}return e}))}const tu=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield eu();console.log("Microphone Permission Status = "+(null==t?void 0:t.state)),"denied"===(null==t?void 0:t.state)?e(Wc.Uninitialized):(null==t?void 0:t.state)===Gc&&e(Wc.Enabled)})),nu=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield Yc.GetInstance().Pause(),e(!1)})),ru=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){null!=Kc.GetInstance()&&(yield nu(e),Xc.getInstance().stopVoiceInputTimer())})),ou=(e,t,n,o,i)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){try{yield Yc.GetInstance().Resume(),n(!1),o(Wc.Enabled),i(!e),Xc.getInstance().startVoiceInputTimer(t,i)}catch(e){console.error("Error occurred - "+e),"ErrorAudioPermissionDeniedError"===e&&(yield Yc.GetInstance().Pause(),n(!0)),o(Wc.Uninitialized)}})),iu=(e,t)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){null!=Kc.GetInstance()&&Xc.getInstance().startVoiceInputTimer(e,t)})),au="en-US",su=["ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-OM","ar-QA","ar-SA","ar-SY","ar-AE","bg-BG","ca-ES","zh-HK","zh-CN","zh-TW","hr-HR","cs-CZ","da-DK","nl-NL","en-AU","en-CA","en-HK","en-IN","en-IE","en-NZ","en-PH","en-SG","en-ZA","en-GB","en-US","et-EE","fi-FI","fr-CA","fr-FR","de-DE","el-GR","gu-IN","hi-IN","hu-HU","ga-IE","it-IT","ja-JP","ko-KR","lv-LV","lt-LT","mt-MT","mr-IN","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-US","es-VE","sv-SE","ta-IN","te-IN","th-TH","tr-TR","af-ZA","am-ET","bn-IN","cy-GB","eu-ES","fa-IR","fil-PH","gl-ES","he-IL","hy-AM","id-ID","is-IS","ka-GE","kk-KZ","km-KH","kn-IN","lo-LA","mk-MK","ml-IN","ms-MY","ne-NP","pa-IN","sq-AL","uk-UA","vi-VN"];function lu(e){let t="en-US";return t=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}}(function(e){const t=e.split("-");if(1==t.length)return t[0].toLowerCase();t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase());if(t.length>2)for(let e=1;e<t.length-1;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1).toLowerCase();return t.join("-")}(e)),-1==su.indexOf(t)&&(t=function(e){const t=e.split("-");for(let e=0;e<su.length;e++){const n=su[e];if(t[0]==n.split("-")[0])return n}return e}(t)),-1==su.indexOf(t)&&(t=au),console.log("STT Language is "+t),t}const cu=e=>{switch(e.toLowerCase()){case"zh-hk":case"zh-cn":case"zh-tw":case"ja-jp":return!1;default:return!0}};var uu,du=n(3399),pu=function(e){var t,n,r,o=e.title,a=e.isDisabled,s=e.handleClick;return i.a.createElement(so.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},i.a.createElement(se.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=u.e,n=u.d,r=Object(Ve.a)(n,t),i.a.createElement(r,null))},onClick:s,disabled:a}))},gu=n(1448),hu={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",DIALOG:"dialog",TOOLTIP:"tooltip"},fu=function(){return"undefined"!=typeof OfficeaicopilotStrings},mu=function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{augloopSession:t})},vu=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e?(Object(gu.b)(e),[4,Object(gu.a)()]):[2,null];case 1:return[2,t.sent().getSession()]}}))}))},bu=function(){return fu()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area"},yu=function(){return fu()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},Cu=function(){return fu()?OfficeaicopilotStrings.SubmitButtonTitle:"Send"},Ou=function(){return fu()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own"},Su="",Eu="copilot-chat-input",xu=1e4,Iu=function(){return fu()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},wu=" ",Tu=function(){return fu()?OfficeaicopilotStrings.DefaultCIQButtonTitle:"Attach"},ku=function(){return fu()?OfficeaicopilotStrings.DefaultGroundingButtonTitle:"Manage search and plugins"},ju=function(){return fu()?OfficeaicopilotStrings.GroundingSearchAndPlugins:"Search and plugins"},Pu=function(){return fu()?OfficeaicopilotStrings.PreviewFlagLabel:"Preview"},Au=function(){return fu()?OfficeaicopilotStrings.GroundingPluginFlyoutInfo:"Plugins allow Copilot to reference apps on your behalf. Copilot may share some of your Microsoft 365 enterprise data with plugins you’ve turned on."},_u=function(){return fu()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoTooltip:"Microsoft 365 enterprise data includes Office applications, SharePoint sites, cloud files, communications, and more. All configured by your IT admin."},Du=function(){return fu()?OfficeaicopilotStrings.AdminBlockedPluginInfoTooltipLabel:"The service required to use this plugin is turned off for your organization."},Lu=function(){return fu()?OfficeaicopilotStrings.WorkPluginLabel:"Microsoft 365 data"},Mu=function(){return fu()?OfficeaicopilotStrings.WebContentPluginLabel:"Web content"},Bu=function(){return fu()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoLabel:"Info"};!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(uu||(uu={}));var Ru,Fu,Nu=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:On.a.colorNeutralForeground4,alignItems:"flex-start"},vt.a.body1),{fontStyle:"normal"}),re.a.gap("1px")),{content:"attr(title)"}),Hu={color:On.a.colorNeutralForegroundDisabled},Uu=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),re.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(r.__assign)({},re.a.outline(0))}),Vu={userInput:Object(r.__assign)(Object(r.__assign)({},Uu),{"&:focus":Object(r.__assign)({},re.a.outline(0)),"&:focus::after":Nu,"&::after":Nu})},zu={userInput:Object(r.__assign)(Object(r.__assign)({},Uu),{"&:focus":Object(r.__assign)({},re.a.outline(0))})},Gu={userInput:{"&:focus::after":Hu,"&::after":Hu}},Wu=Object(X.a)(zu),Qu=Object(X.a)(Vu),qu=Object(X.a)(Gu),Ku=i.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,a=e.placeholderText,s=e.chatInputTabIndex,l=e.isDisabled,c=e.handleKeyDown,u=e.handleKeyUp,d=e.handleOnPaste,p=e.handleOnBeforeInput,g=e.handleOnInput,h=e.handleOnFocusTextArea,f=e.handleOnChatInputControlMount,m=e.handleOnChatInputControlUnmount,v=Object(o.useRef)();Object(o.useImperativeHandle)(t,(function(){return{setInputText:function(e){y(e),b()},updateInputText:function(e,t){switch(t){case uu.InsertAtCursor:C(e);break;case uu.Replace:y(e)}},getInputText:function(){return O()},getInputSpanElement:function(){return v.current},setFocus:function(){S()},getGhostText:function(){var e,t;return null!==(t=null===(e=v.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;null===(t=v.current)||void 0===t||t.setAttribute("title",e),k(e===Su?E.current.userInput:I.current.userInput)},scrollToBottom:b}}));var b=function(){var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},y=function(e){var t=v.current;t&&(t.innerText=e)},C=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1),b()}},O=function(){var e=Su,t=v.current;return t&&(e=t.innerText),e},S=function(){if(!l){var e=v.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(o.useEffect)((function(){return f&&f(),function(){m&&m()}}),[]);var E=Object(o.useRef)(Wu()),x=Object(o.useRef)(qu()),I=Object(o.useRef)(Qu()),w=Object(r.__read)(Object(o.useState)(I.current.userInput),2),T=w[0],k=w[1];return Object(o.useEffect)((function(){l&&k(Object($.a)(I.current.userInput,x.current.userInput))}),[l]),Object(o.useEffect)((function(){n&&k(Object($.a)(E.current.userInput,n))}),[n]),i.a.createElement("span",{ref:v,className:T,title:a,"aria-label":a,"aria-disabled":l,role:"textbox",tabIndex:s,contentEditable:!l,suppressContentEditableWarning:!l,onKeyDown:c,onKeyUp:u,onPaste:d,onBeforeInput:p,onInput:g,onFocus:h})})),Yu=n(3520),Zu=n(3513),Ju=n(3445),Xu=Object(yc.a)({palette:Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),$u=(Object(yc.a)({palette:Object(r.__assign)(Object(r.__assign)({},b.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(){return Ru}),ed=function(e){var t=e.themePalette,n=e.isDarkMode,i=e.dir,a=void 0===i?void 0:i,s=e.children,l=e.className,c=Object(r.__assign)(Object(r.__assign)({},Xu.palette),t),u=Object(Ju.a)(c),d=n?Object(mc.a)(u):Object(vc.a)(u);return Ru=d,o.createElement(m.a,{className:l,theme:d,dir:a},s)},td=function(e,t){var n=Object(Ve.a)(t,e);return i.a.createElement(n,null)},nd=function(e){var t=e;return i.a.createElement(t,null)},rd=n(682),od=n(3595),id=n(573),ad=function(e){return i.a.createElement("svg",{className:e,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("g",{clipPath:"url(#clip0_741_74312)"},i.a.createElement("path",{d:"M10 18.4961C9.21875 18.4961 8.4668 18.3952 7.74414 18.1934C7.02148 17.9915 6.3444 17.7051 5.71289 17.334C5.08138 16.9629 4.50846 16.5202 3.99414 16.0059C3.47982 15.4915 3.03711 14.9186 2.66602 14.2871C2.29492 13.6556 2.00846 12.9785 1.80664 12.2559C1.60482 11.5332 1.50391 10.7812 1.50391 10C1.50391 9.21875 1.60482 8.4668 1.80664 7.74414C2.00846 7.02148 2.29492 6.3444 2.66602 5.71289C3.03711 5.08138 3.47982 4.50846 3.99414 3.99414C4.50846 3.47982 5.08138 3.03711 5.71289 2.66602C6.3444 2.29492 7.02148 2.00846 7.74414 1.80664C8.4668 1.60482 9.21875 1.50391 10 1.50391C10.7812 1.50391 11.5332 1.60482 12.2559 1.80664C12.9785 2.00846 13.6556 2.29492 14.2871 2.66602C14.9186 3.03711 15.4915 3.47982 16.0059 3.99414C16.5202 4.50846 16.9629 5.08138 17.334 5.71289C17.7051 6.3444 17.9915 7.02148 18.1934 7.74414C18.3952 8.4668 18.4961 9.21875 18.4961 10C18.4961 10.7812 18.3952 11.5332 18.1934 12.2559C17.9915 12.9785 17.7051 13.6556 17.334 14.2871C16.9629 14.9186 16.5202 15.4915 16.0059 16.0059C15.4915 16.5202 14.9186 16.9629 14.2871 17.334C13.6556 17.7051 12.9785 17.9915 12.2559 18.1934C11.5332 18.3952 10.7812 18.4961 10 18.4961Z",fill:"#FAFAFA"}),i.a.createElement("path",{d:"M19.0039 10C19.0039 10.8268 18.8965 11.6243 18.6816 12.3926C18.4668 13.1543 18.1641 13.8704 17.7734 14.541C17.3828 15.2051 16.9141 15.8105 16.3672 16.3574C15.8203 16.9043 15.2148 17.3763 14.5508 17.7734C13.8802 18.1641 13.1641 18.4668 12.4023 18.6816C11.6341 18.8965 10.8366 19.0039 10.0098 19.0039C9.18294 19.0039 8.38542 18.8965 7.61719 18.6816C6.84896 18.4668 6.13281 18.1641 5.46875 17.7734C4.79818 17.3828 4.18945 16.9141 3.64258 16.3672C3.08919 15.8203 2.61719 15.2148 2.22656 14.5508C1.83594 13.8802 1.5332 13.1608 1.31836 12.3926C1.10352 11.6243 0.996094 10.8268 0.996094 10C0.996094 9.17318 1.10352 8.37891 1.31836 7.61719C1.5332 6.84896 1.83594 6.13281 2.22656 5.46875C2.61719 4.79818 3.08919 4.18945 3.64258 3.64258C4.18945 3.08919 4.79818 2.61719 5.46875 2.22656C6.13281 1.83594 6.84896 1.5332 7.61719 1.31836C8.37891 1.10352 9.17318 0.996094 10 0.996094C10.8268 0.996094 11.6243 1.10352 12.3926 1.31836C13.1543 1.5332 13.8704 1.83594 14.541 2.22656C15.2051 2.61719 15.8138 3.08919 16.3672 3.64258C16.9141 4.18945 17.3828 4.79818 17.7734 5.46875C18.1641 6.13281 18.4668 6.84896 18.6816 7.61719C18.8965 8.37891 19.0039 9.17318 19.0039 10ZM10 17.998C10.2344 17.998 10.4883 17.8841 10.7617 17.6562C11.0286 17.4284 11.2891 17.0996 11.543 16.6699C11.7904 16.2402 12.0215 15.7161 12.2363 15.0977C12.4512 14.4792 12.6237 13.7793 12.7539 12.998H7.24609C7.3763 13.7793 7.54883 14.4792 7.76367 15.0977C7.97852 15.7161 8.21289 16.2402 8.4668 16.6699C8.71419 17.0996 8.97461 17.4284 9.24805 17.6562C9.51497 17.8841 9.76562 17.998 10 17.998ZM12.9004 12.002C12.9329 11.6829 12.959 11.3574 12.9785 11.0254C12.9915 10.6934 12.998 10.3516 12.998 10C12.998 9.64844 12.9915 9.30664 12.9785 8.97461C12.959 8.64258 12.9329 8.31706 12.9004 7.99805H7.09961C7.06706 8.31706 7.04427 8.64258 7.03125 8.97461C7.01172 9.30664 7.00195 9.64844 7.00195 10C7.00195 10.3516 7.01172 10.6934 7.03125 11.0254C7.04427 11.3574 7.06706 11.6829 7.09961 12.002H12.9004ZM2.00195 10C2.00195 10.6771 2.08659 11.3444 2.25586 12.002H6.10352C6.07096 11.6764 6.04492 11.3477 6.02539 11.0156C6.00586 10.6836 5.99609 10.3451 5.99609 10C5.99609 9.65495 6.00586 9.31641 6.02539 8.98438C6.04492 8.65234 6.07096 8.32357 6.10352 7.99805H2.25586C2.08659 8.6556 2.00195 9.32292 2.00195 10ZM10 2.00195C9.76562 2.00195 9.51497 2.11589 9.24805 2.34375C8.97461 2.57161 8.71419 2.90039 8.4668 3.33008C8.21289 3.75977 7.97852 4.28385 7.76367 4.90234C7.54883 5.52083 7.3763 6.2207 7.24609 7.00195H12.7539C12.6237 6.2207 12.4512 5.52083 12.2363 4.90234C12.0215 4.28385 11.7904 3.75977 11.543 3.33008C11.2891 2.90039 11.0286 2.57161 10.7617 2.34375C10.4883 2.11589 10.2344 2.00195 10 2.00195ZM13.8965 7.99805C13.929 8.32357 13.9551 8.65234 13.9746 8.98438C13.9941 9.31641 14.0039 9.65495 14.0039 10C14.0039 10.3451 13.9941 10.6836 13.9746 11.0156C13.9551 11.3477 13.929 11.6764 13.8965 12.002H17.7441C17.9134 11.3444 17.998 10.6771 17.998 10C17.998 9.32292 17.9134 8.6556 17.7441 7.99805H13.8965ZM17.4121 7.00195C17.1777 6.42253 16.8815 5.88216 16.5234 5.38086C16.1654 4.87305 15.7585 4.41732 15.3027 4.01367C14.8405 3.60352 14.3359 3.25195 13.7891 2.95898C13.2422 2.65951 12.6628 2.42839 12.0508 2.26562C12.4479 2.79948 12.7962 3.47331 13.0957 4.28711C13.3887 5.0944 13.6133 5.99935 13.7695 7.00195H17.4121ZM7.94922 2.26562C7.33724 2.42839 6.75781 2.65951 6.21094 2.95898C5.66406 3.25195 5.16276 3.60352 4.70703 4.01367C4.24479 4.41732 3.83464 4.87305 3.47656 5.38086C3.11849 5.88216 2.82227 6.42253 2.58789 7.00195H6.23047C6.38672 5.99935 6.61458 5.0944 6.91406 4.28711C7.20703 3.47331 7.55208 2.79948 7.94922 2.26562ZM2.58789 12.998C2.82227 13.5775 3.11849 14.1211 3.47656 14.6289C3.83464 15.1302 4.24479 15.5859 4.70703 15.9961C5.16276 16.3997 5.66406 16.7513 6.21094 17.0508C6.75781 17.3438 7.33724 17.5716 7.94922 17.7344C7.55208 17.2005 7.20703 16.5299 6.91406 15.7227C6.61458 14.9089 6.38672 14.0007 6.23047 12.998H2.58789ZM12.0508 17.7344C12.6628 17.5716 13.2422 17.3438 13.7891 17.0508C14.3359 16.7513 14.8405 16.3997 15.3027 15.9961C15.7585 15.5859 16.1654 15.1302 16.5234 14.6289C16.8815 14.1211 17.1777 13.5775 17.4121 12.998H13.7695C13.6133 14.0007 13.3887 14.9089 13.0957 15.7227C12.7962 16.5299 12.4479 17.2005 12.0508 17.7344Z",fill:"#3A3A38"})),i.a.createElement("defs",null,i.a.createElement("clipPath",{id:"clip0_741_74312"},i.a.createElement("rect",{width:"20",height:"20",fill:"white"}))))},sd=function(e){return i.a.createElement("svg",{className:e,width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("g",{clipPath:"url(#clip0_98326_1271)"},i.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint0_linear_98326_1271)"}),i.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint1_linear_98326_1271)"}),i.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint2_radial_98326_1271)"}),i.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint3_linear_98326_1271)"}),i.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint4_radial_98326_1271)"}),i.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint5_linear_98326_1271)"})),i.a.createElement("defs",null,i.a.createElement("linearGradient",{id:"paint0_linear_98326_1271",x1:"9.52494",y1:"5.71629",x2:"4.86462",y2:"20.1745",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#AE7FE2"}),i.a.createElement("stop",{offset:"1",stopColor:"#0078D4"})),i.a.createElement("linearGradient",{id:"paint1_linear_98326_1271",x1:"7.5417",y1:"16.3092",x2:"6.72169",y2:"14.7676",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),i.a.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),i.a.createElement("radialGradient",{id:"paint2_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.98808 16.3592) rotate(-13.1869) scale(13.9366 10.8259)"},i.a.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),i.a.createElement("stop",{offset:"1",stopColor:"#5E438F"})),i.a.createElement("linearGradient",{id:"paint3_linear_98326_1271",x1:"16.6314",y1:"10.9555",x2:"15.8357",y2:"12.2201",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),i.a.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),i.a.createElement("radialGradient",{id:"paint4_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9836 11.3541) rotate(-160.581) scale(16.4238 16.5011)"},i.a.createElement("stop",{stopColor:"#50E6FF"}),i.a.createElement("stop",{offset:"1",stopColor:"#436DCD"})),i.a.createElement("linearGradient",{id:"paint5_linear_98326_1271",x1:"5.49905",y1:"5.87339",x2:"8.12498",y2:"5.87339",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.9999",stopColor:"#2D3F80"}),i.a.createElement("stop",{offset:"1",stopColor:"#436DCD",stopOpacity:"0"})),i.a.createElement("clipPath",{id:"clip0_98326_1271"},i.a.createElement("rect",{y:"0.75",width:"20",height:"20",rx:"2",fill:"white"}))))},ld=i.a.createElement("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},i.a.createElement("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM11 7h2v2h-2V7zm0 3h2v6h-2V10z"}));!function(e){e.CurrentContext="CurrentContext",e.Work="Work",e.Web="Web"}(Fu||(Fu={}));var cd,ud,dd=function(e){var t;return(t={})[Fu.CurrentContext]=function(e){return i.a.createElement("svg",{className:e,width:"16",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"M2 0.720703C0.89543 0.720703 0 1.61613 0 2.7207V18.7207C0 19.8253 0.895431 20.7207 2 20.7207H14C15.1046 20.7207 16 19.8253 16 18.7207V8.54847C16 8.01804 15.7893 7.50933 15.4142 7.13426L9.58645 1.30649C9.21137 0.931417 8.70267 0.720703 8.17223 0.720703H2ZM1.5 2.7207C1.5 2.44456 1.72386 2.2207 2 2.2207H8V6.7207C8 7.82527 8.89543 8.7207 10 8.7207H14.5V18.7207C14.5 18.9968 14.2761 19.2207 14 19.2207H2C1.72386 19.2207 1.5 18.9968 1.5 18.7207V2.7207ZM13.3793 7.2207H10C9.72386 7.2207 9.5 6.99685 9.5 6.7207V3.34136L13.3793 7.2207Z"}))}(e),t[Fu.Work]=function(e){return i.a.createElement("svg",{className:e,width:"18",height:"19",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"M7.25 2.2207H10.75C11.1642 2.2207 11.5 2.55649 11.5 2.9707V4.7207H6.5V2.9707C6.5 2.55649 6.83579 2.2207 7.25 2.2207ZM5 2.9707V4.7207H3.25C1.45507 4.7207 0 6.17578 0 7.9707V15.4707C0 17.2656 1.45507 18.7207 3.25 18.7207H14.75C16.5449 18.7207 18 17.2656 18 15.4707V7.9707C18 6.17578 16.5449 4.7207 14.75 4.7207H13V2.9707C13 1.72806 11.9926 0.720703 10.75 0.720703H7.25C6.00736 0.720703 5 1.72806 5 2.9707ZM16.5 7.9707V9.4707C16.5 10.4372 15.7165 11.2207 14.75 11.2207H11V10.7207C11 10.1684 10.5523 9.7207 10 9.7207H8C7.44772 9.7207 7 10.1684 7 10.7207V11.2207H3.25C2.2835 11.2207 1.5 10.4372 1.5 9.4707V7.9707C1.5 7.0042 2.2835 6.2207 3.25 6.2207H14.75C15.7165 6.2207 16.5 7.0042 16.5 7.9707ZM16.5 12.2098V15.4707C16.5 16.4372 15.7165 17.2207 14.75 17.2207H3.25C2.2835 17.2207 1.5 16.4372 1.5 15.4707V12.2098C2.00515 12.5332 2.60568 12.7207 3.25 12.7207H7C7 13.273 7.44772 13.7207 8 13.7207H10C10.5523 13.7207 11 13.273 11 12.7207H14.75C15.3943 12.7207 15.9949 12.5332 16.5 12.2098Z"}))}(e),t},pd={direction:id.a.bidirectional,isCircularNavigation:!0,handleTabKey:id.b.all},gd={popOver:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",maxHeight:"390px"},re.a.overflow("hidden","auto")),re.a.margin("right: 20")),{backgroundColor:On.a.colorNeutralBackground1,paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"4px",":hover::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralForeground4},re.a.border("2px","solid",On.a.colorNeutralBackground3)),re.a.borderRadius(On.a.borderRadiusMedium)),"&::-webkit-scrollbar":{width:On.a.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:On.a.colorNeutralBackground5}}),menuItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1,maxWidth:"inherit"},re.a.padding("0px")),re.a.border("2px","solid","transparent")),re.a.borderRadius(On.a.borderRadiusMedium)),(cd={"> span":Object(r.__assign)({},re.a.overflow("hidden"))},cd["&:focus-within"]=Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Hover},re.a.border("2px","solid",On.a.colorNeutralBackground1Hover)),cd[Fn.m]={":hover":Object(r.__assign)({},re.a.border("2px","dashed","Highlight"))},cd)),descriptionSection:{color:On.a.colorNeutralForeground2Link,paddingBottom:"6px"},installedSection:Object(r.__assign)(Object(r.__assign)({display:"flex",paddingBottom:"10px",flexDirection:"column"},re.a.gap("2px")),{alignSelf:"stretch"}),description:{paddingBottom:"6px",fontFamily:"Segoe UI",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:On.a.colorNeutralForeground2Link},titleContainer:Object(r.__assign)({display:"flex",flexDirection:"row"},re.a.gap("8px")),title:Object(r.__assign)(Object(r.__assign)({color:On.a.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start"},re.a.gap("10px")),{alignSelf:"stretch"}),previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:Object(r.__assign)(Object(r.__assign)({height:"16px",color:On.a.colorNeutralForeground2,backgroundColor:On.a.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px"},re.a.borderRadius("8px")),{display:"flex",flexDirection:"row",alignSelf:"stretch",fontFamily:"Segoe UI",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"}),shimmerComponent:Object(r.__assign)({},re.a.padding("6px","6px","6px","0px")),labelInfo:(ud={backgroundColor:On.a.colorNeutralBackground1},ud["&:focus-within"]=Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Hover},re.a.border("2px","solid",On.a.colorNeutralBackground1Hover)),re.a.borderRadius(On.a.borderRadiusMedium)),ud)};var hd,fd=function(){var e,t,n,r,o,i,a,s,l,c,u,d={popOver:null!==(e=gd.popOver)&&void 0!==e?e:{},titleContainer:null!==(t=gd.titleContainer)&&void 0!==t?t:{},descriptionSection:null!==(n=gd.descriptionSection)&&void 0!==n?n:{},title:null!==(r=gd.title)&&void 0!==r?r:{},previewTitleContainer:null!==(o=gd.previewTitleContainer)&&void 0!==o?o:{},previewTitle:null!==(i=gd.previewTitle)&&void 0!==i?i:{},menuItem:null!==(a=gd.menuItem)&&void 0!==a?a:{},installedSection:null!==(s=gd.installedSection)&&void 0!==s?s:{},description:null!==(l=gd.description)&&void 0!==l?l:{},shimmerComponent:null!==(c=gd.shimmerComponent)&&void 0!==c?c:{},labelInfo:null!==(u=gd.labelInfo)&&void 0!==u?u:{}};return Object(X.a)(d)}(),md={shimmer:On.a.colorNeutralStencil1,shimmerWave:On.a.colorNeutralStencil2,background:On.a.colorNeutralBackground1},vd={tooltipText:{width:"216px",fontSize:"12px"},tooltip:{alignSelf:"center","> button":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:"none",minWidth:"0px",maxHeight:"18px",maxWidth:"18px"},re.a.padding("4px")),re.a.borderStyle("none")),re.a.borderRadius("18px"))},infoButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:"inherit",boxShadow:"none",lineHeight:"6px"},re.a.border("2px","solid","transparent")),re.a.borderColor(On.a.borderRadiusCircular)),(hd={"> span":{maxHeight:"18px",maxWidth:"18px"}},hd["&:focus-within"]=Object(r.__assign)({},re.a.border("2px","solid",On.a.colorNeutralBackground1Hover)),hd[":hover"]={backgroundColor:On.a.colorNeutralForeground2BrandHover,"> span > svg > path":{fill:On.a.colorNeutralBackground2}},hd[Fn.m]={"> span > svg > path":{fill:"ButtonText"},":hover":{backgroundColor:"Highlight"}},hd))};var bd=function(){var e,t,n,r={tooltipText:null!==(e=vd.tooltipText)&&void 0!==e?e:{},tooltip:null!==(t=vd.tooltip)&&void 0!==t?t:{},infoButton:null!==(n=vd.infoButton)&&void 0!==n?n:{}};return Object(X.a)(r)}();function yd(e){var t=e.infoMessage,n=bd();return o.createElement("span",{className:n.tooltip,role:hu.TOOLTIP},o.createElement(so.a,{content:t,relationship:"description"},o.createElement(se.a,{icon:ld,size:"small",className:n.infoButton,"aria-label":Bu()})))}var Cd=n(3604),Od={appIcon:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"20px",height:"fit-content",float:"left"},re.a.padding("4px","4px","4px","4px")),re.a.border("2px","solid",On.a.colorNeutralBackground3Pressed)),re.a.borderRadius(On.a.borderRadiusMedium)),appNameContainer:Object(r.__assign)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto"},re.a.overflow("hidden")),appNameTextContainer:Object(r.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto"},re.a.overflow("hidden")),appName:Object(r.__assign)(Object(r.__assign)({width:"auto",height:"auto",lineHeight:"36px",paddingLeft:"2px",paddingRight:"2px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:On.a.colorNeutralForeground2Link,whiteSpace:"nowrap"},re.a.overflow("hidden")),{textOverflow:"ellipsis"}),appInfo:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),re.a.overflow("hidden")),{alignContent:"center",justifyItems:"left",alignItems:"center"}),blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",maxHeight:"100px"},re.a.gap("4px")),{justifyContent:"space-between","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right",height:"36px"},spinner:{paddingTop:"8px",paddingInlineEnd:"20px"}};var Sd=function(){var e,t,n,r,o,i,a,s,l,c,u={appIcon:null!==(e=Od.appIcon)&&void 0!==e?e:{},appNameContainer:null!==(t=Od.appNameContainer)&&void 0!==t?t:{},appNameTextContainer:null!==(n=Od.appNameTextContainer)&&void 0!==n?n:{},appName:null!==(r=Od.appName)&&void 0!==r?r:{},appInfo:null!==(o=Od.appInfo)&&void 0!==o?o:{},blocked:null!==(i=Od.blocked)&&void 0!==i?i:{},infoIcon:null!==(a=Od.infoIcon)&&void 0!==a?a:{},pluginItem:null!==(s=Od.pluginItem)&&void 0!==s?s:{},toggleControl:null!==(l=Od.toggleControl)&&void 0!==l?l:{},spinner:null!==(c=Od.spinner)&&void 0!==c?c:{}};return Object(X.a)(u)}();function Ed(e){var t=e.title,n=e.plugin,i=Sd(),a=Object(r.__read)(o.useState(n.state==Pc.Enabled),2),s=a[0],l=a[1],c=o.useCallback((function(e,t){u(t.checked)}),[]),u=function(e){n.onToggle(e),l(e)},d=n.state===Pc.Blocked?i.blocked:void 0,p=o.useMemo((function(){var e=n.state==Pc.Blocked;return o.createElement("div",{className:i.toggleControl},n.state===Pc.Loading&&o.createElement(Cd.a,{className:i.spinner}),n.state!==Pc.Loading&&o.createElement(ne.a,{disabled:!!e,checked:s,onChange:c,tabIndex:-1,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),u(!(n.state==Pc.Enabled)))},role:"switch"}))}),[u]),g=n.state===Pc.Blocked?o.createElement(yd,{infoMessage:Du()}):null,h=i.appName;h=Object($.a)(h,d);var f,m=(f=n.id)===Fu.Web?ad(i.appIcon):f===Fu.Work?sd(i.appIcon):void 0,v=o.createElement("div",{className:i.appInfo},m,o.createElement("div",{className:i.appNameTextContainer},o.createElement(xe.a,{className:h},t),g));return o.createElement("div",{className:i.pluginItem},v,p)}function xd(e){var t=e.plugins,n=e.isPluginDataLoaded,i=fd(),a=i.title,s=i.previewTitle,l=i.descriptionSection,c=i.description,u=o.createElement(yd,{infoMessage:_u()}),d=o.createElement("div",{className:i.previewTitleContainer},o.createElement(xe.a,{className:s},Pu())),p=o.createElement("div",{className:l},o.createElement("div",{className:i.titleContainer},o.createElement(xe.a,{role:hu.HEADING,"aria-level":1,"aria-label":ju(),className:a},ju()),e.isPreview&&d),o.createElement(xe.a,{className:c},Au()),u),g=[{type:rd.a.circle,height:22.7},{type:rd.a.gap,width:10},{type:rd.a.line,height:10,width:160},{type:rd.a.gap,width:80},{type:rd.a.line,height:10}],h=o.memo((function(){return o.createElement(od.a,{className:i.shimmerComponent,shimmerElements:g,shimmerColors:md})}));h.displayName="ShimmerComponent";var f,v=function(e){var t;e.preventDefault();var n=e.target,r=null===(t=e.currentTarget)||void 0===t?void 0:t.querySelector('[role="switch"]');null==r||r.click(),null==n||n.focus()},b=function(e){"Enter"!==e.key&&" "!==e.key||v(e)},y=o.createElement("div",{className:i.installedSection},n?t.map((function(e,t){var n,r=e.state===Pc.Blocked,a=(n=e.id)===Fu.Work?Lu():n===Fu.Web?Mu():void 0;return o.createElement(Pi.a,{role:"button",key:t,persistOnClick:!0,className:i.menuItem,tabIndex:r?-1:0,disabled:r,onKeyDown:b,onClick:v,"aria-label":a,"aria-pressed":e.state===Pc.Enabled},o.createElement(Ed,{title:a,plugin:e,key:e.id}))})):(f=t.length,o.createElement(o.Fragment,null,Object(r.__spreadArray)([],Object(r.__read)(Array(f)),!1).map((function(e,t){return o.createElement(h,{key:t})})))));return o.createElement(m.a,null,o.createElement(ki.a,{role:hu.DIALOG,className:i.popOver},o.createElement(ji.a,null,p,y)))}var Id={color:On.a.colorBrandForeground1},wd=Object(X.a)({menuPopOver:{overflowX:"hidden",width:"272px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",overflowY:"hidden"}}),Td=function(e){var t=e.title,n=e.isDisabled,a=e.isMenuOpen,s=void 0!==a&&a,l=e.setMenuOpen,c=e.targetRef,u=e.plugins,d=e.shouldBlockGroundingButtonClick,p=void 0===d?function(){return!1}:d,h=e.copilotPluginFlyoutProps,f=Object(r.__read)(Object(o.useState)(s),2),m=f[0],v=f[1],b=i.a.useRef(null),y=Object(r.__read)(Object(o.useState)(!1),2),C=y[0],O=y[1],S=i.a.useRef(null),E=wd();i.a.useEffect((function(){var e;c&&(null===(e=b.current)||void 0===e||e.setTarget(c))}),[c,b]),Object(o.useEffect)((function(){v(s)}),[s]),Object(o.useEffect)((function(){l(m)}),[m,l]);var x=i.a.useCallback((function(e,t){p&&p()||l(null==t?void 0:t.open)}),[l,p]);Object(o.useEffect)((function(){O(0===u.filter((function(e){return e.state===Pc.Shimmer})).length)}),[u]);var I=h?i.a.createElement(ki.a,{role:"dialog",className:E.menuPopOver},i.a.createElement(Zu.a,Object(r.__assign)({},h,{positioningRef:S,fluentTheme:$u()}))):i.a.createElement(xd,{isPluginDataLoaded:C,plugins:u,isPreview:!0}),w=h?{positioningRef:S,position:"above"}:{target:c,align:"center",position:"above"};return i.a.createElement(Ii.a,{open:m,onOpenChange:x,positioning:w},i.a.createElement(wi.a,{disableButtonEnhancement:!0},i.a.createElement(so.a,{content:t,relationship:"label",positioning:"above",withArrow:!0},i.a.createElement(se.a,{appearance:"transparent",disabled:n,icon:m?{children:nd(g.d),style:Id}:{children:td(g.e,g.d)},"aria-label":t}))),I)},kd=Object(X.a)({activeIcon:{color:On.a.colorBrandForeground1},menuList:{minWidth:"100%",whiteSpace:"nowrap"},highlightedText:{color:On.a.colorBrandForeground1},greyedText:{color:On.a.colorNeutralForeground4},menuItem:{paddingLeft:"10px",paddingBottom:"8px",paddingTop:"8px",paddingRight:"10px",maxWidth:"none"},menuBackButtonContainer:{display:"flex",alignItems:"center","&:hover":{color:On.a.colorNeutralForeground1}},menuBackButton:{textAlign:"left",paddingLeft:0},menuBackButtonText:{whiteSpace:"nowrap",fontWeight:"600",fontSize:"12px",paddingLeft:"8px"}}),jd=function(e){e.title;var t,n=e.isDisabled,a=e.isMenuOpen,s=void 0!==a&&a,l=e.setMenuOpen,c=e.positioningRef,d=e.promptGuideMenuProps,p=kd(),g=Object(r.__read)(Object(o.useState)(""),2),h=g[0],f=g[1],m=Object(r.__read)(Object(o.useState)(d.promptGuideMenuData),2),v=m[0],b=m[1],y=Object(o.useRef)(""===h?v:null===(t=v.children)||void 0===t?void 0:t.find((function(e){return e.text===h})));Object(o.useEffect)((function(){b(d.promptGuideMenuData)}),[d.promptGuideMenuData]),Object(o.useEffect)((function(){var e;y.current=""===h?v:null===(e=v.children)||void 0===e?void 0:e.find((function(e){return e.text===h}))}),[v]);var C=Object(r.__read)(Object(o.useState)(s),2),O=C[0],S=C[1];Object(o.useEffect)((function(){S(s)}),[s]),Object(o.useEffect)((function(){l(O)}),[O,l]);var E=i.a.useCallback((function(e,t){(null==t?void 0:t.open)&&d.shouldBlockPromptGuideLaunch&&d.shouldBlockPromptGuideLaunch()||(S(null==t?void 0:t.open),(null==t?void 0:t.open)&&d.handleOnClickPromptGuideMenuButtonTelemetry(),f(""),y.current=v)}),[f,S,v,d.shouldBlockPromptGuideLaunch]),x=Object(o.useCallback)((function(e){var t,n;f(e),null===(t=c.current)||void 0===t||t.updatePosition(),y.current=""===e?v:null===(n=v.children)||void 0===n?void 0:n.find((function(t){return t.text===e}))}),[f,v]),I=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e=document.getElementById(Eu);if(e){var t=new ResizeObserver((function(){var t=e.offsetWidth;if(I.current){var n={width:"".concat(t,"px"),maxWidth:"none",minHeight:"100px"};Object.assign(I.current.style,n)}}));return t.observe(e),function(){t.unobserve(e)}}}),[I,O]),i.a.createElement(Ii.a,{open:O,onOpenChange:E,persistOnItemClick:!0,positioning:{positioningRef:c}},i.a.createElement(wi.a,{disableButtonEnhancement:!0},i.a.createElement(so.a,{content:fu()?OfficeaicopilotStrings.DefaultMenuButtonTitle:"View prompts",relationship:"label",positioning:"above",withArrow:!0},i.a.createElement(se.a,{appearance:"transparent",disabled:n,icon:O?{children:nd(u.j),className:p.activeIcon}:{children:td(u.k,u.j)},"aria-label":O?"Close view prompts":"Open view prompts",id:"".concat("ViewPromptsID")}))),i.a.createElement(ki.a,{ref:I},i.a.createElement(Pd,{dataNode:y.current,updatePopoverOpen:S,updateDataNode:x,menuProps:d})))},Pd=function(e){var t,n,a=e.dataNode,s=e.updatePopoverOpen,l=e.updateDataNode,c=e.menuProps,u=kd(),d=Object(r.__read)(i.a.useState(c),1)[0],p="Root"===(null==a?void 0:a.nodeType),g=i.a.useCallback((function(){l("")}),[l]),h=Object(o.useRef)(null),f=Object(o.useRef)(null);if(Object(o.useEffect)((function(){var e=p?f.current:h.current;e&&e.focus()}),[p]),!a)return i.a.createElement(i.a.Fragment,null);var m,v,b=p?{}:{paddingLeft:0},y=null==d?void 0:d.copilotLabProps;return i.a.createElement(ji.a,{className:u.menuList},i.a.createElement(za.a,null,i.a.createElement(Wa.a,{style:b},p?i.a.createElement(xe.a,{size:200,weight:"medium"},a.text):i.a.createElement("div",{className:u.menuBackButtonContainer},i.a.createElement(se.a,{ref:h,className:u.menuBackButton,appearance:"transparent",onClick:g,icon:i.a.createElement(ze.r,null),"aria-label":"Back"}),i.a.createElement("div",{className:u.menuBackButtonText},(m=fu()?OfficeaicopilotStrings.PromptGuideMenuSectionHeader:"Examples to help you %s",v=null===(t=a.text)||void 0===t?void 0:t.toLowerCase(),m.replace("%s",v))))),null===(n=a.children)||void 0===n?void 0:n.map((function(e,t){return i.a.createElement(Ad,{key:t,ref:0===t?f:void 0,dataNode:e,updatePopoverOpen:s,updateDataNode:l,menuProps:d})}))),(null==y?void 0:y.copilotLabMenuItemText)&&(p||"Category"===(null==a?void 0:a.nodeType))&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ga.a,null),i.a.createElement(Pi.a,{className:u.menuItem,icon:y.iconRegular?y.iconHover?{children:td(y.iconRegular,y.iconHover)}:{children:nd(y.iconRegular)}:null,onClick:function(e){e.stopPropagation(),s(!1),(null==y?void 0:y.handleOnClickCopilotLab)&&y.handleOnClickCopilotLab("Category"===a.nodeType?a.promptCategory:void 0)}},fu()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts")))},Ad=Object(o.forwardRef)((function(e,t){var n=e.dataNode,r=e.updatePopoverOpen,o=e.updateDataNode,a=e.menuProps,s=kd(),l=n.text,c=void 0===l?"":l,u=n.data,d=n.iconHover,p=n.iconRegular,g=n.children,h=((null==g?void 0:g.length)||0)>0,f=function(e){var t=[],n=[],r=[],o=e.lastIndexOf(")"),i=e.lastIndexOf("(",o),a=e.lastIndexOf("]"),s=e.lastIndexOf("[",a);return o>i&&i>=0?(t.push(e.slice(0,i),e.slice(i,o+1),e.slice(o+1)),n.push(!1,!0,!1),r.push(!1,!1,!1)):a>s&&s>=0?(t.push(e.slice(0,s),e.slice(s,a+1),e.slice(a+1)),n.push(!1,!0,!1),r.push(!1,!0,!1)):(t.push(e),n.push(!1),r.push(!1)),{chunks:t,shouldHighlight:n,shouldGrey:r}}(c),m=f.chunks,v=f.shouldHighlight,b=f.shouldGrey,y=function(e,t,n){a.handleOnClickStarterPromptMenuItem&&a.handleOnClickStarterPromptMenuItem(e,t,n)},C=i.a.useCallback((function(){if(!g)return r(!1),void y(c,!0,null==u?void 0:u.ciqEntity);o(c||""),y(c,!1,null==u?void 0:u.ciqEntity)}),[u,g,r,o,c]);return i.a.createElement(Pi.a,{ref:t,icon:p?d?{children:td(p,d)}:{children:nd(p)}:null,hasSubmenu:h,disabled:n.isDisabled,className:s.menuItem,"aria-label":c+(h?", sub menu":""),onClick:C},i.a.createElement("span",{style:{whiteSpace:"normal"}},m.map((function(e,t){return v[t]&&!n.isDisabled?i.a.createElement("span",{key:t,className:b[t]?s.greyedText:s.highlightedText},e):i.a.createElement(i.a.Fragment,{key:t},e)}))))}));Ad.displayName="ViewPromptsMenuItem";var _d,Dd,Ld,Md,Bd=Object(X.a)({root:{backgroundColor:"transparent"}}),Rd=Object(X.a)({root:Object(r.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:On.a.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},re.a.padding("16px"))}),Fd=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px solid")),re.a.borderColor("transparent")),re.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),Nd=Object(X.a)({root:{backgroundColor:On.a.colorBrandForeground1,color:On.a.colorNeutralBackground1,"&:hover":{backgroundColor:"".concat(On.a.colorBrandForeground1," !important")}}}),Hd=Object(X.a)({root:{backgroundColor:On.a.colorNeutralBackground1,color:On.a.colorStrokeFocus2,"&:hover":Object(r.__assign)(Object(r.__assign)({},re.a.borderColor("".concat(On.a.colorBrandForeground1))),{backgroundColor:"".concat(On.a.colorNeutralBackground1," !important")})}}),Ud=Object(X.a)({root:{color:On.a.colorBrandForeground1,"&:hover":{color:On.a.colorBrandForeground1},fontSize:"12px"}}),Vd=Object(X.a)({root:{height:"63px",bottom:"12px"}}),zd=Object(X.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),Gd=Object(X.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:On.a.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),Wd=Object(X.a)({root:{fontWeight:"bold",color:On.a.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),Qd=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,a=e.microphonePermissionErrorImagePath,s=e.showHelpLink,l=e.tryAgainOnClickHandler,c=e.notNowOnClickHandler,u=Object($.a)(Fd().root,Nd().root),d=Object($.a)(Fd().root,Hd().root),p=Gd().root,g=Object($.a)(p,Wd().root),h=Ud().root,f=Vd().root,v=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e;t&&(null===(e=v.current)||void 0===e||e.focus())}),[t]),i.a.createElement(m.a,{className:Bd().root},i.a.createElement(fe.a,{modalType:"modal",open:t},i.a.createElement(me.a,{className:Rd().root,tabIndex:0},i.a.createElement(ve.a,null,i.a.createElement(be.a,{className:g},n),i.a.createElement(Ce.a,null,a&&i.a.createElement(Jt.a,{className:f,alt:"",src:a,width:"252px",height:"51px"}),i.a.createElement(_s.a,{className:p},r),s&&i.a.createElement(To.a,{inline:!0,className:h,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},fu()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),i.a.createElement(Vt.a,{className:zd().root},i.a.createElement(ye.a,{disableButtonEnhancement:!0},i.a.createElement(se.a,{ref:v,className:d,appearance:"secondary",onClick:c},fu()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),i.a.createElement(se.a,{className:u,appearance:"primary",onClick:l},fu()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(_d||(_d={}));var qd,Kd,Yd,Zd,Jd,Xd=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},re.a.borderRadius("8px")),re.a.borderColor(On.a.colorNeutralBackground1)),(Dd={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Dd["&:hover .".concat(bt.a.icon)]={color:On.a.colorBrandForeground1},Dd["&:hover:active .".concat(bt.a.icon)]={color:On.a.colorBrandForeground1},Dd.display="flow",Dd))}),$d=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorBrandForeground1,color:On.a.colorNeutralBackground1},re.a.borderRadius("50%")),(Ld={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(On.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(On.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(On.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Ld["&.".concat(bt.a.icon)]={color:On.a.colorNeutralBackground1},Ld["&:hover .".concat(bt.a.icon)]={color:On.a.colorNeutralBackground1},Ld["&:active .".concat(bt.a.icon)]={color:On.a.colorNeutralBackground1},Ld["&:hover:active .".concat(bt.a.icon)]={color:On.a.colorNeutralBackground1},Ld["&:hover"]={backgroundColor:On.a.colorBrandForeground1,color:On.a.colorNeutralBackground1},Ld["&:hover:active"]={backgroundColor:On.a.colorBrandForeground1,color:On.a.colorNeutralBackground1},Ld["@media (forced-colors: active)"]={forcedColorAdjust:"none"},Ld))}),ep=Object(X.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),tp=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground3},re.a.borderRadius("50%")),{color:On.a.colorBrandForeground1}),loader:Object(r.__assign)(Object(r.__assign)({color:On.a.colorNeutralBackground1},re.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:On.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),np=Object(X.a)({root:Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground4},re.a.borderColor(On.a.colorNeutralBackground4)),(Md={"&:hover":Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground4},re.a.borderColor(On.a.colorNeutralBackground4))},Md["&:hover .".concat(bt.a.icon)]={color:On.a.colorNeutralForegroundDisabled},Md["&:hover:active .".concat(bt.a.icon)]={color:"".concat(On.a.colorNeutralForegroundDisabled," !important")},Md))}),rp=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,a=Object(r.__read)(Object(o.useState)(!1),2),s=a[0],l=a[1],c=Object(r.__read)(Object(o.useState)(!1),2),u=c[0],d=c[1];Object(o.useEffect)((function(){n.isMicrophoneListening?(l(!1),f(v.current)):f(p.current.root)}),[n.isMicrophoneListening]),Object(o.useEffect)((function(){n.microphoneState===_d.Loading?(l(!0),f(m.current)):(l(!1),n.microphoneState===_d.Uninitialized&&f(p.current.root))}),[n.microphoneState]),Object(o.useEffect)((function(){t?f(b.current):n.isMicrophoneListening||f(p.current.root)}),[t]);var p=Object(o.useRef)(Xd()),g=Object(r.__read)(Object(o.useState)(p.current.root),2),h=g[0],f=g[1],m=Object(o.useRef)(Object($.a)(p.current.root,tp().root)),v=Object(o.useRef)(Object($.a)(p.current.root,$d().root)),b=Object(o.useRef)(Object($.a)(p.current.root,np().root)),y=i.a.createElement(se.a,{className:h,"aria-label":n.title,role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},icon:n.isMicrophoneListening||u||s?i.a.createElement(As.a,{title:"Mic-Filled"}):i.a.createElement(As.b,{title:"Mic-Regular"}),onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return i.a.createElement("div",{className:ep().root},n.isTooltipDisabled?y:i.a.createElement(so.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},y),s&&i.a.createElement("div",{className:tp().loader}),i.a.createElement(Qd,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},op=n(836),ip=n(393),ap=n(195),sp=n(1137),lp=n(2467),cp={selectors:(qd={},qd[Fn.m]={color:"ButtonText"},qd)},up=Object(ip.c)((function(e,t,n){return Object(Fn.db)({root:{direction:"inherit",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},container:{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",minWidth:"-webkit-fill-available",alignItems:"center",backgroundColor:On.a.colorNeutralBackground4,borderBottom:n?void 0:"solid",borderWidth:"1px",borderColor:On.a.colorNeutralStroke1,margin:n?void 0:"-4px",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderLeftStyle:n?"solid":void 0,borderRightStyle:n?"solid":void 0,borderTopStyle:n?"solid":void 0},label:Object(r.__assign)({fontWeight:400,fontSize:Fn.k.size12,lineHeight:"16px",textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:t?On.a.colorNeutralForegroundDisabled:On.a.colorNeutralForeground1,paddingInlineStart:e?void 0:"10px"},cp),iconContainer:{display:"flex"},icon:{paddingInlineStart:"10px",paddingInlineEnd:"8px"},downChevron:Object(r.__assign)({fill:t?On.a.colorNeutralForegroundDisabled:On.a.colorNeutralForeground1,color:t?On.a.colorNeutralForegroundDisabled:On.a.colorNeutralForeground1},cp)})})),dp=Object(ip.c)((function(e){return{root:{background:"transparent",border:"none",fontSize:Fn.k.size12,padding:0},rootHovered:{border:"none",backgroundColor:"transparent"},rootPressed:{border:"none",backgroundColor:"transparent"},rootDisabled:{border:"none",backgroundColor:"transparent",fontWeight:400},textContainer:{color:e?On.a.colorNeutralForegroundDisabled:On.a.colorNeutralForeground1,fontWeight:400,fontSize:Fn.k.size12,lineHeight:"16px",textAlign:"start",textDecoration:"underline",padding:"2px 0px 2px 0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},menuIcon:{margin:0,color:e?On.a.colorNeutralForegroundDisabled:On.a.colorNeutralForeground1,fontSize:"8px",paddingTop:"3px"},label:{fontWeight:"normal"}}})),pp=((Kd={})[Fn.m]=Object(r.__assign)({backgroundColor:"Highlight",color:"HighlightText",outlineColor:"ButtonText"},Object(Fn.S)()),{selectors:(Yd={},Yd[Fn.m]=Object(r.__assign)({backgroundColor:"ButtonFace",color:"ButtonText",outlineColor:"inherit"},Object(Fn.S)()),Yd)}),gp={selectors:(Zd={},Zd[Fn.m]=Object(r.__assign)({backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed"},Object(Fn.S)()),Zd)},hp=Object(ip.c)((function(){return{root:{padding:"6px",backgroundColor:"transparent",minWidth:"unset"},divider:{height:"1px"}}})),fp=Object(ip.c)((function(){var e;return{root:Object(r.__assign)({border:"none",minWidth:"-webkit-fill-available",minHeight:"48px",margin:"1px",padding:"0px",alignItems:"flex-start",fontWeight:400,backgroundColor:On.a.colorNeutralBackground1,color:On.a.colorNeutralForeground1,borderColor:On.a.colorNeutralStroke1,borderRadius:"6px"},pp),rootHovered:Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Hover,color:On.a.colorNeutralForeground1Hover},gp),rootPressed:Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1Pressed,color:On.a.colorNeutralForeground1Pressed},gp),flexContainer:(e={},e[Fn.m]=Object(r.__assign)({color:"HighlightText",foreground:"HighlightText",":hover label, :hover svg":{color:"HighlightText",fill:"HighlightText"}},Object(Fn.S)()),e)}})),mp=Object(ip.c)((function(){return Object(Fn.db)({root:{direction:"inherit",borderRadius:"7px",backgroundColor:On.a.colorNeutralBackground1},buttonContainer:{paddingLeft:"8px",paddingRight:"8px",width:"100%",alignItems:"center"},icon:{alignSelf:"center",padding:"2px",alignItems:"center",lineHeight:24,color:On.a.colorNeutralForeground1,fill:On.a.colorNeutralForeground1},container:{paddingInlineStart:"8px",alignItems:"flex-start",alignSelf:"center",display:"inline-block"},primaryLabel:Object(r.__assign)(Object(r.__assign)({textAlign:"start",fontSize:Fn.k.size14,fontWeight:400,lineHeight:"14px"},re.a.padding("0px")),{color:On.a.colorNeutralForeground1}),secondaryLabel:Object(r.__assign)(Object(r.__assign)({textAlign:"start",fontSize:Fn.k.size10,fontWeight:400,lineHeight:"14px"},re.a.padding("0px")),{color:On.a.colorNeutralForeground2Link})})})),vp=function(e,t){var n=e.key+"_desc";return o.createElement(m.a,{className:e.root},o.createElement(sp.a,{onClick:function(n,r){e.onClick(),t(n,r)},styles:fp(),role:"menuitem"},o.createElement(Wn.a,{horizontal:!0,className:e.buttonContainerClass},dd(e.iconClass)[e.iconId],o.createElement(Wn.a,{className:e.containerClass},o.createElement(op.a,{className:e.primaryClass,"aria-describedby":n},e.text),o.createElement(op.a,{className:e.secondaryTextClass,id:n},e.secondaryText)))))},bp=Object(ip.c)((function(e,t,n,r){var o,i=t.map((function(e){return function(e,t){var n=mp();return{key:e.primary,text:e.primary,secondaryText:e.secondary,iconId:e.id,root:n.root,containerClass:n.container,buttonContainerClass:n.buttonContainer,primaryClass:n.primaryLabel,secondaryTextClass:n.secondaryLabel,iconClass:n.icon,onClick:function(n){t(e,n)},onRender:vp}}(e,n)}));return{target:e,alignTargetEdge:!0,isBeakVisible:!1,gapSpace:4,directionalHint:ap.a.topCenter,items:i,styles:hp,focusZoneProps:pd,calloutProps:(o=null==e?void 0:e.offsetWidth,{setInitialFocus:!0,styles:{root:{width:o?o+16:364,borderRadius:"8px"},calloutMain:{backgroundColor:$u().colorNeutralBackground1,borderRadius:"8px"}}}),onDismiss:r}})),yp=function(e){var t=Object(r.__read)(o.useState(e.sourcesData[0]),2),n=t[0],i=t[1],a=Object(r.__read)(o.useState(!1),2),s=a[0],l=a[1],c=function(){l(!0)},u=function(t){l(!1),e.onMenuDismiss&&e.onMenuDismiss(t),window.requestAnimationFrame((function(){var e;return null===(e=p.querySelector("button[aria-haspopup]"))||void 0===e?void 0:e.focus()}))},d=Object(r.__read)(o.useState(void 0),2),p=d[0],g=d[1],h=up(!!e.infoTip,e.isDisabled,e.isChatInputV3Enabled);return o.createElement(m.a,{className:h.root},o.createElement("div",{className:h.container,ref:function(e){e&&g(e)}},e.infoTip&&o.createElement("div",{className:h.icon},o.createElement(yd,{infoMessage:e.infoTip})),o.createElement(op.a,{className:h.label},e.sourcePrefix),o.createElement(sp.a,{text:n.primary.toLocaleLowerCase(),styles:dp(e.isDisabled),onClick:c,disabled:e.isDisabled,"aria-label":e.sourcePrefix+n.primary,type:"button","aria-haspopup":"true"}),o.createElement(ze.k,{className:h.downChevron,"aria-label":e.infoTip,cursor:"pointer",onClick:e.isDisabled?void 0:c}),s&&p&&o.createElement(lp.a,Object(r.__assign)({},bp(p,e.sourcesData,(function(t,r){t.id!=n.id&&(i(t),e.onSelection&&e.onSelection(t)),u(r)}),u)))))},Cp=n(1166),Op=n(1095),Sp=n(3494),Ep=n(3495),xp=n(3496),Ip=n(3497);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(Jd||(Jd={}));var wp=Jd.web,Tp=function(){return wp===Jd.IOS},kp=n(53),jp=function(){function e(e){this.entityPluginRef=e}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,o,i){var a,s=e.suggestion;s&&(null===(a=this.entityPluginRef.current)||void 0===a||a.insertChatInputEntity(s.id,s.text,"".concat(s.type,"​").concat(s.url)))},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n=e.innerText.trim();return null===(t=this.entityPluginRef.current)||void 0===t?void 0:t.getActiveEntities().map((function(e){var t=e.entityType.split("​")[1],r=n.indexOf(e.text);return{type:"URL",range:[r,r+e.text.length-1],value:t}}))},e.prototype.generateQueryAnnotations=function(e){var t;return null===(t=this.entityPluginRef.current)||void 0===t?void 0:t.getActiveEntities().map((function(e){var t=e.entityType.split("​"),n=t[0],r=t[1];return{id:e.id,QueryAnnotationType:n,text:e.text,url:r}}))},e}(),Pp=function(){},Ap=function(e,t){var n=e.chatInputContainerTitle,i=void 0===n?bu():n,a=e.ciqButtonTitle,s=void 0===a?Tu():a,l=e.copilotChatTheme,c=e.copilotPluginFlyoutProps,u=e.editorProps,d=e.groundingSourcePickerProps,p=e.handleChatInputLoad,g=void 0===p?Pp:p,h=e.handleFirstUserInput,f=void 0===h?Pp:h,m=e.handleOnBlur,v=e.handleOnChatInputControlMount,b=e.handleOnChatInputControlUnmount,y=e.handleOnInput,C=e.handleSubmitButtonClick,O=e.isCIQButtonEnabled,S=void 0!==O&&O,E=e.isDarkMode,x=e.isDisabled,I=e.isMenuButtonEnabled,w=void 0!==I&&I,T=e.isGroundingButtonEnabled,k=void 0!==T&&T,j=e.isSensitivityIndicatorLoading,P=e.isSubmitButtonDisabled,A=e.maxInputCharLimit,_=void 0===A?2e3:A,D=e.menuButtonTitle,L=void 0===D?yu():D,M=e.overrideStyles,B=e.placeholderText,R=void 0===B?Ou():B,F=e.pluginsInfo,N=e.promptGuideMenuProps,H=e.shouldBlockGroundingButtonClick,U=void 0===H?function(){return!1}:H,V=e.shouldBlockSubmitButtonClick,z=void 0===V?function(){return!1}:V,G=e.submitButtonTitle,W=void 0===G?Cu():G,Q=e.voiceInputProps,q=Object(r.__read)(o.useState(!1),2),K=q[0],Y=q[1],Z=Object(r.__read)(o.useState(!1),2),J=Z[0],X=Z[1],$=Object(r.__read)(o.useState(!1),2),ee=$[0],te=$[1],ne=Object(r.__read)(o.useState(R),2),re=ne[0],oe=ne[1],ie=o.useRef(),ae=o.useRef(),se=o.useRef(!0),le=o.useRef(!0),ce=o.useRef(null),ue=o.useRef(null),de=o.useRef(null),pe=o.useRef(null);o.useImperativeHandle(t,(function(){return{setInputText:function(e){var t;null===(t=ue.current)||void 0===t||t.setInputText(e)},updateInputText:function(e,t){var n,r;switch(t){case uu.InsertAtCursor:null===(n=ue.current)||void 0===n||n.insertTextAtCursor(e);break;case uu.Replace:null===(r=ue.current)||void 0===r||r.setInputText(e)}},getInputText:function(){var e;return null===(e=ue.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){return de.current},setGhostText:function(e){},getGhostText:function(){var e;return null===(e=Ce.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=de.current)||void 0===e||e.focus()},closeMenu:function(){w&&K&&Y(!1),k&&J&&X(!1),Oe&&Se.current&&xe(!1)},getCIQTextRef:function(){return me.current},getChatEditorInstance:function(){return he},getCIQResponseHandler:function(){return fe}}})),o.useEffect((function(){oe(R)}),[R]),o.useEffect((function(){var e;ae.current&&(null===(e=ce.current)||void 0===e||e.setTarget(ae.current))}),[ce,ae]);var ge=function(e){var t=e.chatInputRef,n=e.controlRef,i=e.copilotChatTheme,a=e.entityPluginRef,s=e.editorProps,l=e.isDarkMode,c=e.isSensitivityIndicatorLoading,u=Object(r.__read)(o.useState(void 0),2),d=u[0],p=u[1],g=Object(r.__read)(o.useState(void 0),2),h=g[0],f=g[1],m=o.useRef(),v=o.useRef();o.useEffect((function(){l?d&&d.updateCurrentTheme($s.dark):d&&d.updateCurrentTheme($s.light)}),[l]),o.useEffect((function(){if((null==s?void 0:s.handleInChatInput)&&(null==s?void 0:s.editorConfig)&&!m.current&&(null==s?void 0:s.alSession)){var e=(new Dc).createInstance();e.bootstrap(mu(s.editorConfig,s.alSession)).then((function(t){m.current=e,p(t)}))}return function(){m.current&&m.current.shutdown().then((function(){m.current=void 0}))}}),[null==s?void 0:s.alSession]),o.useEffect((function(){if((null==s?void 0:s.handleInChatInput)&&(null==s?void 0:s.editorConfig)&&!h&&d&&t.current){var e=new jp(a);d.initializeCiq(t.current,{menuTitle:null==s?void 0:s.editorConfig.transformFileMenuTitle,menuSubtitle:(null==s?void 0:s.editorConfig.transformFilePlaceholderText)?null==s?void 0:s.editorConfig.transformFilePlaceholderText:Su,queryCharToUse:El,onItemSelected:function(r){var o,a;null===(o=t.current)||void 0===o||o.focus(),null===(a=n.current)||void 0===a||a.selectQueryText(El),e.renderAndTrackSelectedSuggestion(r,null,c,i,l,v),s.postCIQItemSelectionHandler&&s.postCIQItemSelectionHandler(r.suggestion)},entitiesEnabled:null==s?void 0:s.editorConfig.entitiesSupported,ExpanededECC:null==s?void 0:s.editorConfig.isExpandedECCEnabled}),f(e)}}),[d,h]);var b=o.useCallback((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o,i,a,l,c,u,d;return Object(r.__generator)(this,(function(r){return s.editorConfig.ciqPlaceholderText?(e=Object(kp.$getSelection)(),Object(kp.$isRangeSelection)(e)&&e.isCollapsed()?(t=e.getNodes()[0],Object(kp.$isTextNode)(t)&&t.isSimpleText()?(n=t.getTextContent(),o=e.getCharacterOffsets()[0],i=n[o-1]===El,a=1===o||""===(null===(d=n[o-2])||void 0===d?void 0:d.trim()),l=o===n.length||""===n[o].trim(),c=t.getNextSibling(),u=o===n.length&&(!c||Object(Op.b)(c)&&!c.getNextSibling()),i&&a&&l?[2,"​‌"+s.editorConfig.ciqPlaceholderText+(u?"":"​‌")]:[2,void 0]):[2,void 0]):[2,void 0]):[2,void 0]}))}))}),[s.editorConfig.ciqPlaceholderText]);return{chatEditor:d,ciqResponseHandler:h,ciqTextRef:v,$getGhostText:b}}({chatInputRef:de,controlRef:ue,copilotChatTheme:l,entityPluginRef:pe,editorProps:u,isDarkMode:E,isSensitivityIndicatorLoading:j}),he=ge.chatEditor,fe=ge.ciqResponseHandler,me=ge.ciqTextRef,ve=ge.$getGhostText,be=function(e){var t=e.chatInputRef,n=e.controlRef,i=e.handleChatInputLoad,a=e.isDisabled,s=e.languageSupportsSpace,l=e.maxInputCharLimit,c=e.placeholderText,u=e.voiceInputProps,d=Object(r.__read)(o.useState(!1),2),p=d[0],g=d[1],h=Object(r.__read)(o.useState(_d.Uninitialized),2),f=h[0],m=h[1],v=Object(r.__read)(o.useState(!1),2),b=v[0],y=v[1],C=o.useRef(null==u?void 0:u.alSession),O=o.useRef(!1),S=o.useRef(null),E=!(!(null==u?void 0:u.handleInChatInput)||!(null==u?void 0:u.alSession)&&!(null==u?void 0:u.alSessionConfig)),x=o.useCallback((function(e){var t,r,o,i,a,l;if(e){var c=(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>0&&s.current?wu:Su;null===(r=S.current)||void 0===r||r.setGhostText(c+Iu())}else{var u=null===(i=null===(o=S.current)||void 0===o?void 0:o.getGhostText())||void 0===i?void 0:i.trim();u&&""!==u&&u!==Iu()?null===(a=S.current)||void 0===a||a.commitGhostText(u):null===(l=S.current)||void 0===l||l.cancelGhostText()}g(e),O.current=e}),[c]);o.useEffect((function(){var e;p||ru(x).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=t.current)||void 0===e||e.focus()}),[p]);var I=o.useCallback((function(e){var r,o,i,c,u;if(O.current&&E&&!a&&!((null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>=l)){var d=(null===(o=n.current)||void 0===o?void 0:o.getInputText().length)>0&&s?wu:Su;null===(i=S.current)||void 0===i||i.commitGhostText(d+e),null===(c=t.current)||void 0===c||c.focus(),null===(u=n.current)||void 0===u||u.scrollToBottom()}}),[E,a,l]),w=o.useCallback((function(e){var t,r,o,i;if(O.current&&E&&!a&&!(null!=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>=l)){var c=(null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>0&&s?wu:Su;null===(o=S.current)||void 0===o||o.setGhostText(c+e),null===(i=n.current)||void 0===i||i.scrollToBottom(),e.trim()&&iu(xu,x)}}),[E,a,l,x]),T=o.useCallback((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null!=C.current?[3,4]:(e=C,null===(o=u.alSession)||void 0===o?[3,1]:(t=o,[3,3]));case 1:return[4,vu(null==u?void 0:u.alSessionConfig)];case 2:t=r.sent(),r.label=3;case 3:e.current=t,r.label=4;case 4:return C.current?(n=lu(u.voiceInputLocale),[4,$c(n,I,w,m,x,C.current)]):[3,6];case 5:r.sent(),s.current=cu(lu(n)),r.label=6;case 6:return[2]}}))}))}),[w,I,x,null==u?void 0:u.alSession,null==u?void 0:u.alSessionConfig,null==u?void 0:u.voiceInputLocale]);o.useEffect((function(){i()}),[]),o.useEffect((function(){E&&T()}),[E,T]);var k=E?{isMicrophoneListening:p,microphoneState:f,handleMicrophoneButtonOnClick:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,a,s,l,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),p?((null===(o=S.current)||void 0===o?void 0:o.getGhostText())!=Su&&(null===(i=S.current)||void 0===i?void 0:i.getGhostText())!=c&&(null===(s=null===(a=S.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Iu()&&(null===(l=S.current)||void 0===l||l.commitGhostText(null===(u=S.current)||void 0===u?void 0:u.getGhostText())),[4,ru(x)]):[3,3];case 2:return r.sent(),[3,6];case 3:return f===_d.Uninitialized&&m(_d.Loading),[4,Yc.GetInstance().Resume()];case 4:return r.sent(),y(!1),x(!p),m(_d.Enabled),[4,iu(xu,x)];case 5:r.sent(),r.label=6;case 6:return[3,10];case 7:return t=r.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Yc.GetInstance().Pause()];case 8:r.sent(),y(!0),r.label=9;case 9:return m(_d.Uninitialized),[2];case 10:return[2]}}))}))},micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:b,microphonePermissionErrorTitle:null==u?void 0:u.microphonePermissionErrorTitle,microphonePermissionErrorMessage:null==u?void 0:u.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){ou(p,xu,y,m,x)},notNowOnClickHandler:function(){y(!1)},microphonePermissionErrorImagePath:null==u?void 0:u.microphonePermissionImagePath,showHelpLink:null==u?void 0:u.showMicrophonePermissionHelpLink},isTooltipDisabled:!0}:null==u?void 0:u.microphoneButtonProps;return{getMicrophoneLiveRegionText:function(){switch(k.microphoneState){case _d.Enabled:return k.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case _d.Disabled:case _d.Uninitialized:return"Microphone Disabled";case _d.Loading:return"Microphone Loading"}},ghostTextRef:S,handleVoiceInChatInput:E,isMicrophoneActive:O,microphoneProps:k,setMicrophoneListeningStatus:x}}({chatInputRef:de,controlRef:ue,handleChatInputLoad:g,isDisabled:x,languageSupportsSpace:se,maxInputCharLimit:_,placeholderText:R,voiceInputProps:Q}),ye=be.getMicrophoneLiveRegionText,Ce=be.ghostTextRef,Oe=be.handleVoiceInChatInput,Se=be.isMicrophoneActive,Ee=be.microphoneProps,xe=be.setMicrophoneListeningStatus;return o.useEffect((function(){return v&&v(),function(){b&&b()}}),[v,b]),{isDisabled:x,isGroundingSourcePickerEnabled:!k&&void 0!==d,isPromptGuideMenuButtonEnabled:w&&void 0!==N,isCIQButtonEnabled:S,isGroundingButtonEnabled:k&&void 0!==F,isChatFooterDividerEnabled:w&&void 0!==N||S||k,isVoiceInputEnabled:void 0!==Q,themeWrapper:{isDarkMode:E,themePalette:l},chatInputContainer:{id:Eu,onBlur:function(){var e;Tp()&&!K&&(null===(e=ue.current)||void 0===e?void 0:e.getInputText())===Su&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return m(),[2]}))}))}),100)},ref:ae},groundingSourcePicker:Object(r.__assign)(Object(r.__assign)({},d),{isChatInputV3Enabled:!0,isDisabled:!(null==d?void 0:d.alwaysEnable)&&x,onSelection:function(e){var t;oe(e.placeholderText),null===(t=null==d?void 0:d.onSelection)||void 0===t||t.call(d,e)}}),chatInputContainerTooltip:{content:i,onVisibleChange:function(e,t){e&&"focus"===e.type?te(!1):te(t.visible)},positioning:"above",relationship:"label",visible:ee,withArrow:!0},promptGuideMenuButton:{isDisabled:x,isMenuOpen:K,setMenuOpen:Y,positioningRef:ce,promptGuideMenuProps:N,title:L},ciqButton:{handleClick:function(){var e;null===(e=ue.current)||void 0===e||e.setInputText("/")},isDisabled:x,title:s},groundingButton:{copilotPluginFlyoutProps:c,isDisabled:x,isMenuOpen:J,plugins:F,setMenuOpen:X,shouldBlockGroundingButtonClick:U,targetRef:null==ie?void 0:ie.current,title:ku()},chatFooterDivider:{appearance:"strong",vertical:!0},voiceInputTooltip:{content:ye(),positioning:"above",relationship:"label",withArrow:!0},ariaLiveSpan:{"aria-live":"assertive",role:"alert"},microphoneButton:{"aria-live":"assertive",isDisabled:x,microphoneButtonProps:Ee},faiChatInput:{actions:{ref:ie},className:null==M?void 0:M.userInput,customNodes:[Cp.c,Op.c],disableSend:x||P,disabled:x,maxLength:_,onChange:function(){le.current&&(f(),le.current=!1)},onInput:y,onSubmit:function(e){var t,n,r;if(!(null==z?void 0:z())){e.stopPropagation(),Oe&&xe(!1);var o=null===(t=ue.current)||void 0===t?void 0:t.getInputText();if(o.trimStart()!==Su&&!x){var i=ue.current?null==fe?void 0:fe.generateQueryAnnotations(de.current):void 0;C(o,i),null===(n=ue.current)||void 0===n||n.setInputText(Su),null===(r=Ce.current)||void 0===r||r.cancelGhostText()}}},placeholderValue:re,ref:de,send:{title:W},children:o.createElement(o.Fragment,null,o.createElement(Sp.a,{ref:ue}),o.createElement(Ep.a,{id:"voiceInputGhostText",ref:Ce}),o.createElement(xp.a,{ref:pe}),o.createElement(Ip.a,{id:"ciqGhostText",$getGhostText:ve}))}}},_p={chatInputOuterContainer:Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.margin(0,"16px","16px","16px")),chatInputContainer:{color:On.a.colorNeutralForeground1,position:"relative",zIndex:"1"},faiChatInputWithGrounding:{borderTopLeftRadius:0,borderTopRightRadius:0}},Dp=Object(X.a)(_p),Lp=o.forwardRef((function(e,t){var n=Ap(e,t);return function(e){var t=Dp(),n=e.isDisabled,r=e.overrideStyles,o=e.isGroundingSourcePickerEnabled;e.themeWrapper.className=Object($.a)(t.chatInputOuterContainer,!n&&(null==r?void 0:r.chatInputOuterContainer),e.themeWrapper.className),e.chatInputContainer.className=Object($.a)(t.chatInputContainer,!n&&(null==r?void 0:r.chatInput),e.chatInputContainer.className),e.faiChatInput.className=Object($.a)(o&&t.faiChatInputWithGrounding,e.faiChatInput.className),e.ariaLiveSpan.className=Object($.a)(!n&&(null==r?void 0:r.ariaLiveSpan),e.ariaLiveSpan.className)}(n),function(e){var t=e.ariaLiveSpan,n=e.chatFooterDivider,i=e.chatInputContainer,a=e.ciqButton,s=e.faiChatInput,l=e.groundingButton,c=e.groundingSourcePicker,u=e.isCIQButtonEnabled,d=e.isChatFooterDividerEnabled,p=e.isGroundingButtonEnabled,g=e.isGroundingSourcePickerEnabled,h=e.isPromptGuideMenuButtonEnabled,f=e.isVoiceInputEnabled,m=e.microphoneButton,v=e.promptGuideMenuButton,b=e.themeWrapper,y=e.voiceInputTooltip;return o.createElement(ed,Object(r.__assign)({},b),o.createElement("div",Object(r.__assign)({},i),g&&o.createElement(yp,Object(r.__assign)({},c)),o.createElement(Yu.a,Object(r.__assign)({},s,{actions:Object(r.__assign)(Object(r.__assign)({},s.actions),{children:o.createElement("span",{style:{display:"flex",alignItems:"center"}},h&&o.createElement(jd,Object(r.__assign)({},v)),u&&o.createElement(pu,Object(r.__assign)({},a)),p&&o.createElement(Td,Object(r.__assign)({},l)),d&&o.createElement(du.a,Object(r.__assign)({},n)),f&&o.createElement(so.a,Object(r.__assign)({},y),o.createElement("span",Object(r.__assign)({},t),o.createElement(rp,Object(r.__assign)({},m)))))})}))))}(n)}));Lp.displayName="ChatInput";var Mp=Object(X.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),Bp=function(e){var t=e.children,n=e.style,i=e.horizontal,a=void 0!==i&&i,s=e.reverse,l=void 0!==s&&s,c=e.customProperties,u=function(e,t,n,r){var o=e.root;return t&&(o=Object($.a)(o,t)),n?o=r?Object($.a)(o,e.horizontalReverse):Object($.a)(o,e.horizontal):r&&(o=Object($.a)(o,e.verticalReverse)),o}(Mp(),n,a,l);return o.createElement("div",Object(r.__assign)({className:u},c),t)},Rp={chatInputOuterContainer:Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.margin(0,"16px","16px","16px")),chatInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:On.a.colorNeutralForeground1,backgroundColor:On.a.colorNeutralBackground1},re.a.border("1px","solid",On.a.colorNeutralStroke1)),re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.padding("4px")),re.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(r.__assign)(Object(r.__assign)({},re.a.margin("12px","12px","4px","12px")),{maxHeight:"168px",overflowY:"auto"}),userInput:{},chatInputButtons:Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground1,width:"100%",flexDirection:"row",flexWrap:"wrap"},re.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputCharCount:{},chatInputLeftButtons:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({color:On.a.colorNeutralForeground4,alignSelf:"flex-start"},re.a.margin("12px","12px","4px","12px")),re.a.gap("6px")),{fontStyle:"normal",fontSize:"10px",justifyItems:"center"}),chatInputRightButtons:{display:"flex",flexDirection:"row",alignSelf:"flex-end"},contextualMenu:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},re.a.padding("6px")),{backgroundColor:On.a.colorNeutralBackground1,boxShadow:On.a.shadow4}),re.a.borderRadius("8px"))},Fp=Object(X.a)(Rp),Np=Object(X.a)({chatInput:{":focus-within":{"::after":Object(r.__assign)(Object(r.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},re.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(On.a.colorBrandForeground1,", ").concat(On.a.colorCompoundBrandForeground1Hover,")")})}}}),Hp=Object(X.a)({chatInput:{backgroundColor:On.a.colorNeutralBackground4},chatInputButtons:{backgroundColor:On.a.colorNeutralBackground4},chatInputCharCount:{userSelect:"none"}});var Up,Vp=function(e){var t,n,r,o=e.title,a=e.isDisabled,s=e.handleClick;return i.a.createElement(so.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},i.a.createElement(se.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=uo.h,n=uo.g,r=Object(Ve.a)(n,t),i.a.createElement(r,null))},onClick:s,disabled:a}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Up||(Up={}));var zp=function(){function e(e,t,n,o,i,a,s,l,c,u,d,p){var g=this;this.onTryAgainClicked=function(){(new Date).getTime(),ou(g.isMicrophoneListening,xu,g.setShouldShowMicrophonePermissionRetryDialog,g.setMicrophoneState,g.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(r.__awaiter)(g,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),this.isMicrophoneListening?((null===(o=this.chatInputRef.current)||void 0===o?void 0:o.getGhostText())!=Su&&(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=this.chatPlaceHolderMessage&&(null===(s=null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Iu()&&(null===(l=this.chatInputRef.current)||void 0===l||l.setInputText((null===(c=this.chatInputRef.current)||void 0===c?void 0:c.getInputText())+(null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getGhostText())),null===(d=this.chatInputRef.current)||void 0===d||d.setGhostText("")),[4,ru(this.setMicrophoneListeningStatus)]):[3,3];case 2:return r.sent(),[3,6];case 3:return this.microphoneState===Up.Uninitialized&&this.setMicrophoneState(Up.Loading),(new Date).getTime(),[4,Yc.GetInstance().Resume()];case 4:return r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(Up.Enabled),[4,iu(xu,this.setMicrophoneListeningStatus)];case 5:r.sent(),r.label=6;case 6:return[3,10];case 7:return t=r.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Yc.GetInstance().Pause()];case 8:r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),r.label=9;case 9:return this.setMicrophoneState(Up.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=o,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}();var Gp=i.a.forwardRef((function(e,t){var n=e.isDisabled,a=e.isSubmitButtonDisabled,s=e.copilotChatTheme,l=void 0===s?Xu.palette:s,c=e.isDarkMode,u=e.dir,d=void 0===u?void 0:u,p=e.overrideStyles,g=e.chatInputTabIndex,h=void 0===g?0:g,f=e.chatInputContainerTabIndex,m=void 0===f?-1:f,v=e.chatInputContainerTitle,b=void 0===v?bu():v,y=e.placeholderText,C=void 0===y?Ou():y,O=e.maxInputCharLimit,S=void 0===O?2e3:O,E=e.handleKeyDown,x=e.handleKeyUp,I=e.handleOnPaste,w=e.handleOnBeforeInput,T=e.handleOnInput,k=e.submitButtonTitle,j=void 0===k?Cu():k,P=e.handleSubmitButtonClick,A=e.isMenuButtonEnabled,_=void 0!==A&&A,D=(e.shouldOpenMenuOnEmptyInput,e.menuButtonTitle),L=void 0===D?yu():D,M=(e.handleMenuButtonClick,e.handleOnOpenMenu,e.handleOnChatInputControlMount),B=e.handleOnChatInputControlUnmount,R=e.handleOnBlur,F=e.promptGuideMenuProps,N=e.voiceInputProps,H=e.isCIQButtonEnabled,U=void 0!==H&&H,V=e.ciqButtonTitle,z=void 0===V?Tu():V,G=e.isGroundingButtonEnabled,W=void 0!==G&&G,Q=e.pluginsInfo,q=e.groundingSourcePickerProps,K=e.shouldBlockGroundingButtonClick,Y=void 0===K?function(){return!1}:K,Z=e.shouldBlockSubmitButtonClick,J=void 0===Z?function(){return!1}:Z,X=e.handleFirstUserInput,ee=void 0===X?function(){}:X,te=e.handleChatInputLoad,ne=void 0===te?function(){}:te,re=e.copilotPluginFlyoutProps,oe=e.editorProps,ie=e.isSensitivityIndicatorLoading,ae=Object(o.useRef)(),se=Object(o.useRef)(),le=Object(o.useRef)(null),ce=Object(o.useRef)(),ue=i.a.useRef(),de=Object(o.useRef)(),pe=Object(o.useRef)(!1),ge=Object(o.useRef)(!0),he=Object(o.useRef)(!0),fe=Object(o.useRef)(null==N?void 0:N.alSession),me=!(!(null==N?void 0:N.handleInChatInput)||!(null==N?void 0:N.alSession)&&!(null==N?void 0:N.alSessionConfig)),ve=Object(r.__read)(Object(o.useState)(void 0),2),be=ve[0],ye=ve[1],Ce=Object(r.__read)(i.a.useState(void 0),2),Oe=Ce[0],Se=Ce[1],Ee=Object(r.__read)(Object(o.useState)(0),2),xe=Ee[0],Ie=Ee[1];Object(o.useImperativeHandle)(t,(function(){return{setInputText:function(e){var t,n;null===(t=ae.current)||void 0===t||t.setInputText(e),Ie(null===(n=ae.current)||void 0===n?void 0:n.getInputText().length)},updateInputText:function(e,t){var n,r;null===(n=ae.current)||void 0===n||n.updateInputText(e,t),Ie(null===(r=ae.current)||void 0===r?void 0:r.getInputText().length)},getInputText:function(){var e;return null===(e=ae.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=ae.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){var t;null===(t=ae.current)||void 0===t||t.setGhostText(e)},getGhostText:function(){var e;return null===(e=ae.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=ae.current)||void 0===e||e.setFocus()},closeMenu:function(){_&&Te&&ke(!1),W&&Pe&&Ae(!1),me&&pe.current&&qe(!1)},getCIQTextRef:function(){return de.current},getChatEditorInstance:function(){return Oe},getCIQResponseHandler:function(){return be},setMenuButtonFocus:function(){document.getElementById("ViewPromptsID").focus()}}}));var we=Object(r.__read)(Object(o.useState)(!1),2),Te=we[0],ke=we[1],je=Object(r.__read)(Object(o.useState)(!1),2),Pe=je[0],Ae=je[1],_e=Object(r.__read)(Object(o.useState)(!1),2),De=_e[0],Le=_e[1],Me=Object(r.__read)(Object(o.useState)(_d.Uninitialized),2),Be=Me[0],Re=Me[1],Fe=Object(r.__read)(Object(o.useState)(!1),2),Ne=Fe[0],He=Fe[1],Ue=Object(r.__read)(Object(o.useState)(!1),2),Ve=Ue[0],ze=Ue[1],Ge=Object(r.__read)(Object(o.useState)(C),2),We=Ge[0],Qe=Ge[1],qe=function(e){var t,n,r,o,i,a,s;if(e){var l=(null===(t=ae.current)||void 0===t?void 0:t.getInputText().length)>0&&he.current?wu:Su;null===(n=ae.current)||void 0===n||n.setGhostText(l+Iu())}else(null===(r=ae.current)||void 0===r?void 0:r.getInputText())===Su?null===(o=ae.current)||void 0===o||o.setGhostText(C):(null===(a=null===(i=ae.current)||void 0===i?void 0:i.getGhostText())||void 0===a?void 0:a.trim())===Iu()&&(null===(s=ae.current)||void 0===s||s.setGhostText(Su));ze(e),pe.current=e},Ke=function(e){var t,r,o,i,a,s;if(pe.current&&me&&!n&&!(null!=ae.current&&(null===(t=ae.current)||void 0===t?void 0:t.getInputText().length)>=S)){var l=(null===(r=ae.current)||void 0===r?void 0:r.getInputText().length)>0&&he?wu:Su,c=null!=ae.current?(null===(o=ae.current)||void 0===o?void 0:o.getInputText())+l+e:Su;null===(i=ae.current)||void 0===i||i.setInputText(c),null===(a=ae.current)||void 0===a||a.setGhostText(Su),null===(s=ae.current)||void 0===s||s.setFocus()}},Ye=function(e){var t,r,o;if(pe.current&&me&&!n&&!(null!=ae.current&&(null===(t=ae.current)||void 0===t?void 0:t.getInputText().length)>=S)){var i=(null===(r=ae.current)||void 0===r?void 0:r.getInputText().length)>0&&he?wu:Su;null===(o=ae.current)||void 0===o||o.setGhostText(i+e),e.trim()&&iu(xu,qe)}},Ze=new zp(Ve,Ne,Be,null==N?void 0:N.microphonePermissionErrorTitle,null==N?void 0:N.microphonePermissionErrorMessage,He,Re,qe,ae,C,null==N?void 0:N.microphonePermissionImagePath,null==N?void 0:N.showMicrophonePermissionHelpLink),Je=me?Ze.getMicrophoneButtonProps():null==N?void 0:N.microphoneButtonProps;Je&&!Je.title&&(Je.title=fu()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone");var Xe=function(){var e;ge.current&&(ee(),ge.current=!1);var t=null===(e=ae.current)||void 0===e?void 0:e.getInputText();t=t.replace("\n",""),Ie(t.length)};Object(o.useEffect)((function(){var e;Qe(C),null===(e=ae.current)||void 0===e||e.setGhostText(C)}),[C]),Object(o.useEffect)((function(){var e;se.current&&(null===(e=le.current)||void 0===e||e.setTarget(se.current))}),[le,se]),Object(o.useEffect)((function(){c?Oe&&Oe.updateCurrentTheme($s.dark):Oe&&Oe.updateCurrentTheme($s.light)}),[c]),Object(o.useEffect)((function(){if((null==oe?void 0:oe.handleInChatInput)&&(null==oe?void 0:oe.editorConfig)&&!ue.current&&(null==oe?void 0:oe.alSession)){var e=(new Dc).createInstance();e.bootstrap(mu(oe.editorConfig,oe.alSession)).then((function(t){ue.current=e,Se(t)}))}return function(){ue.current&&ue.current.shutdown().then((function(){ue.current=void 0}))}}),[null==oe?void 0:oe.alSession]),Object(o.useEffect)((function(){if((null==oe?void 0:oe.handleInChatInput)&&(null==oe?void 0:oe.editorConfig)&&!be&&Oe&&ae.current){var e=Oe.initializeCiq(ae.current.getInputSpanElement(),{menuTitle:null==oe?void 0:oe.editorConfig.transformFileMenuTitle,menuSubtitle:(null==oe?void 0:oe.editorConfig.transformFilePlaceholderText)?null==oe?void 0:oe.editorConfig.transformFilePlaceholderText:Su,queryCharToUse:El,onItemSelected:function(t){var n,r;null===(n=ae.current)||void 0===n||n.setGhostText(Su),null===(r=ae.current)||void 0===r||r.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,ie,l,c,de),oe.postCIQItemSelectionHandler&&oe.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==oe?void 0:oe.editorConfig.entitiesSupported,ExpanededECC:null==oe?void 0:oe.editorConfig.isExpandedECCEnabled});ye(e)}}),[Oe,be]),Object(o.useEffect)((function(){var e;Ve||ru(qe).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=ae.current)||void 0===e||e.setFocus()}),[Ve]);var $e=Fp(),et=Np(),tt=Hp(),nt=Object(o.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),rt=Object(o.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),ot=Object(r.__read)(Object(o.useState)($e),2),it=ot[0],at=ot[1];Object(o.useEffect)((function(){for(var e in $e)nt.current[e]=Object($.a)($e[e],et[e]);for(var e in $e)rt.current[e]=Object($.a)($e[e],tt[e]);me&&Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return null!=fe.current?[3,2]:(e=fe,[4,vu(null==N?void 0:N.alSessionConfig)]);case 1:e.current=n.sent(),n.label=2;case 2:return fe.current?(t=lu(N.voiceInputLocale),[4,$c(t,Ke,Ye,Re,qe,fe.current)]):[3,4];case 3:n.sent(),he.current=cu(lu(t)),n.label=4;case 4:return[2]}}))})),ne()}),[]),Object(o.useEffect)((function(){if(p)for(var e in $e)nt.current[e]=Object($.a)($e[e],p[e])}),[p]),Object(o.useEffect)((function(){at(n?rt.current:nt.current)}),[n,p]);return i.a.createElement(ed,{className:it.chatInputOuterContainer,themePalette:l,isDarkMode:c,dir:d},i.a.createElement("div",{id:Eu,className:it.chatInput,tabIndex:m,onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(r){return n||document.activeElement===(null===(e=ae.current)||void 0===e?void 0:e.getInputSpanElement())||null===(t=ae.current)||void 0===t||t.setFocus(),[2]}))}))},onMouseDown:function(e){Tp()&&e.preventDefault()},onBlur:function(){var e;Tp()&&!Te&&(null===(e=ae.current)||void 0===e?void 0:e.getInputText())===Su&&setTimeout((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return R(),[2]}))}))}),100)},ref:se},!W&&q&&i.a.createElement(yp,Object(r.__assign)({},q,{onSelection:function(e){Qe(e.placeholderText),q&&q.onSelection&&q.onSelection(e)},isDisabled:!q.alwaysEnable&&n})),i.a.createElement(so.a,{content:b,relationship:"label",positioning:"above",withArrow:!0,visible:De,onVisibleChange:function(e,t){e&&"focus"===e.type?Le(!1):Le(t.visible)}},i.a.createElement("div",null,i.a.createElement("div",{className:it.chatInputContainer},i.a.createElement(Ku,{ref:ae,styleOverrideClassName:p?p.userInput:"",placeholderText:We,chatInputTabIndex:h,isDisabled:n,handleKeyDown:function(e){var t,r,o,i,a;if(!E||E(e)){var s;if("Backspace"===e.key)if((c=window.getSelection())&&c.isCollapsed&&0!==c.anchorOffset&&(" "===c.anchorNode.textContent||c.anchorNode.lastChild&&" "===c.anchorNode.lastChild.textContent)){var l=c.anchorNode.lastChild?c.anchorNode.lastChild.previousSibling:c.anchorNode.previousSibling;l&&((s=l.lastChild)&&s instanceof HTMLElement&&"false"===s.contentEditable)&&(e.preventDefault(),c.modify("move","backward","character"))}if("Enter"===e.key)if(e.preventDefault(),e.shiftKey){if(xe===S)return;var c;null===(t=ae.current)||void 0===t||t.setGhostText(Su),(c=window.getSelection()).getRangeAt(0).insertNode(document.createElement("br")),c.collapseToEnd(),null===(r=ae.current)||void 0===r||r.scrollToBottom(),Xe()}else if(!n){var u=ae.current?null==be?void 0:be.generateQueryAnnotations(ae.current.getInputSpanElement()):void 0;P(null===(o=ae.current)||void 0===o?void 0:o.getInputText(),u),null===(i=ae.current)||void 0===i||i.setInputText(Su),null===(a=ae.current)||void 0===a||a.setGhostText(We)}}else me&&"Enter"===e.key&&!e.shiftKey&&qe(!1)},handleKeyUp:function(e){var t,n,r,o;x&&!x(e)||((null===(t=ae.current)||void 0===t?void 0:t.getInputText())===Su?null===(n=ae.current)||void 0===n||n.setGhostText(We):(null===(r=ae.current)||void 0===r?void 0:r.getGhostText())===We&&(null===(o=ae.current)||void 0===o||o.setGhostText(Su)))},handleOnPaste:function(e){var t,r,o;if(n)e.preventDefault();else if(!I||I(e)){e.preventDefault(),Le(!1),null===(t=ae.current)||void 0===t||t.setGhostText(Su);var i=e.clipboardData.getData("Text"),a=i.length||0,s=null===(r=ae.current)||void 0===r?void 0:r.getInputText(),l=window.getSelection();if(l.rangeCount){var c=l.toString(),u=s.length-c.length,d=i.substring(0,S-u);l.deleteFromDocument(),u+a>=S?l.getRangeAt(0).insertNode(document.createTextNode(d)):l.getRangeAt(0).insertNode(document.createTextNode(i)),l.collapseToEnd(),null===(o=ae.current)||void 0===o||o.scrollToBottom(),Xe()}}},handleOnBeforeInput:function(e){var t;w&&!w(e)||(xe!==S?(ke(!1),Ae(!1),null===(t=ae.current)||void 0===t||t.setGhostText(Su)):e.preventDefault())},handleOnInput:function(e){Le(!1),Xe(),!T||T(e)},handleOnFocusTextArea:function(){Le(!1)},handleOnChatInputControlMount:M,handleOnChatInputControlUnmount:B}),i.a.createElement("span",{"aria-hidden":!0,onPaste:function(e){e.preventDefault()}},"‍")),i.a.createElement("div",{ref:ce},i.a.createElement(Bp,{style:it.chatInputButtons},i.a.createElement("div",{className:it.chatInputLeftButtons},i.a.createElement("span",{contentEditable:!1,suppressContentEditableWarning:!1,className:it.chatInputCharCount},xe,"/",S)),i.a.createElement("div",{className:it.chatInputRightButtons},_&&F&&i.a.createElement(jd,{title:L,isDisabled:n,isMenuOpen:Te,setMenuOpen:ke,positioningRef:le,promptGuideMenuProps:F}),U&&i.a.createElement(pu,{title:z,isDisabled:n,handleClick:function(){var e,t;null===(e=ae.current)||void 0===e||e.updateInputText(El,uu.InsertAtCursor),null===(t=ae.current)||void 0===t||t.setGhostText(Su)}}),W&&Q&&i.a.createElement(Td,{title:ku(),isDisabled:n,isMenuOpen:Pe,setMenuOpen:Ae,targetRef:null==ce?void 0:ce.current,plugins:Q,shouldBlockGroundingButtonClick:Y,copilotPluginFlyoutProps:re}),(_&&F||U||W)&&i.a.createElement(du.a,{vertical:!0,appearance:"strong"}),N&&i.a.createElement(so.a,{content:function(){switch(Je.microphoneState){case _d.Enabled:return Je.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case _d.Disabled:case _d.Uninitialized:return"Microphone Disabled";case _d.Loading:return"Microphone Loading"}}(),relationship:"label",positioning:"above",withArrow:!0},i.a.createElement("span",{"aria-live":"assertive",role:"alert"},i.a.createElement(rp,{"aria-live":"assertive",isDisabled:n,microphoneButtonProps:Je}))),i.a.createElement(Vp,{title:j,isDisabled:n||a,handleClick:function(e){var t,r,o;if(!J||!J()){e.stopPropagation(),me&&qe(!1);var i=null===(t=ae.current)||void 0===t?void 0:t.getInputText();if(i.trimStart()!==Su&&!n){var a=ae.current?null==be?void 0:be.generateQueryAnnotations(ae.current.getInputSpanElement()):void 0;P(i,a),null===(r=ae.current)||void 0===r||r.setInputText(Su),null===(o=ae.current)||void 0===o||o.setGhostText(We)}}}}))))))))})),Wp=i.a.forwardRef((function(e,t){var n=e.isVersion3Enabled,o=void 0!==n&&n,a=Object(r.__rest)(e,["isVersion3Enabled"]);return o?i.a.createElement(Lp,Object(r.__assign)({},a,{ref:t})):i.a.createElement(Gp,Object(r.__assign)({},a,{ref:t}))}));Wp.displayName="ChatInput";var Qp,qp,Kp,Yp,Zp,Jp,Xp,$p,eg,tg=i.a.memo(Wp),ng=n(3469),rg=n(3471),og=n(796),ig=n(1139),ag=n(485);!function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(Qp||(Qp={})),function(e){e[e.ACTION_AI=0]="ACTION_AI",e[e.COPILOT_ODSL=1]="COPILOT_ODSL"}(qp||(qp={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(Kp||(Kp={})),function(e){e[e.QUERY_ENTERED=0]="QUERY_ENTERED",e[e.QUERY_SUBMITTED=1]="QUERY_SUBMITTED",e[e.QUERY_SUBMITTED_FAILED=2]="QUERY_SUBMITTED_FAILED",e[e.RESPONSE_RECEIVED=3]="RESPONSE_RECEIVED",e[e.RESPONSE_SENT=4]="RESPONSE_SENT",e[e.EXECUTION_COMPLETE=5]="EXECUTION_COMPLETE",e[e.IDLE=6]="IDLE"}(Yp||(Yp={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(Zp||(Zp={})),function(e){e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.PARTIAL_SUCCESS="PARTIAL"}(Jp||(Jp={})),function(e){e[e.AnnotationActivated=0]="AnnotationActivated",e[e.AugloopResponseTimeout=1]="AugloopResponseTimeout",e[e.StopGeneratingButtonClicked=2]="StopGeneratingButtonClicked",e[e.CopilotChatLoaded=3]="CopilotChatLoaded",e[e.CitationLinkClicked=4]="CitationLinkClicked",e[e.BasicChatSuggestionPills=5]="BasicChatSuggestionPills",e[e.BasicChatStatus=6]="BasicChatStatus",e[e.ChatTopicChanged=7]="ChatTopicChanged",e[e.ChatHistoryHydrationFailed=8]="ChatHistoryHydrationFailed",e[e.QuerySubmitted=9]="QuerySubmitted",e[e.UpdateChatClpFromChatHistory=10]="UpdateChatClpFromChatHistory"}(Xp||(Xp={})),function(e){e.ALSessionInitialized="AL_Session_Initialized",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.ChatHistoryResponseReceived="Chat_History_Response_Received",e.ChatPaneInitalized="Chat_Pane_Initialized",e.ChatPaneLoaded="Chat_Pane_Loaded",e.MenuButtonItemClicked="Menu_Button_Item_Clicked",e.MenuButtonItemClickedL1="Menu_Button_Item_Clicked_L1",e.ZQMButtonItemClicked="ZQM_Button_Item_Clicked",e.InputAreaTextChangedToEmpty="Input_Area_Text_Changed_Empty",e.ZQMLoaded="ZQM_Loaded",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.AugloopResponseReceived="Augloop_Response_Received",e.AugloopErrorReceived="Augloop_Error_Received",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionStarted="Query_Execution_Started",e.QueryExecutionCompleted="Query_Execution_Completed"}($p||($p={})),function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(eg||(eg={}));var sg,lg,cg,ug,dg,pg,gg=function(){function e(e){this.copilotCommunicationHandler=e}return e.getInstance=function(t){if(void 0===e.instance){if(void 0===t)throw new Error("copilotCommunicationHandler is undefined");e.instance=new e(t)}return e.instance},e.prototype.sendLoggingEventToClient=function(e,t){this.copilotCommunicationHandler.sendLoggingEventToClient(e,t)},e}(),hg=gg,fg=n(131),mg=n(48);!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=3]="SystemMetadata",e[e.OrganizationIdentifiableInformation=4]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=5]="EndUserIdentifiableInformation",e[e.CustomerContent=6]="CustomerContent",e[e.AccessControl=7]="AccessControl",e[e.PublicNonPersonalData=8]="PublicNonPersonalData",e[e.EndUserPseudonymousInformation=9]="EndUserPseudonymousInformation",e[e.PublicPersonalData=10]="PublicPersonalData",e[e.SupportData=11]="SupportData",e[e.Everything=12]="Everything"}(sg||(sg={})),function(e){e[e.CP_EVENT_TYPE_NOT_SET=1]="CP_EVENT_TYPE_NOT_SET",e[e.CP_EVENT_TYPE_CRITICAL=2]="CP_EVENT_TYPE_CRITICAL"}(lg||(lg={})),function(e){e[e.CP_DATA_CATEGORY_NOT_SET=1]="CP_DATA_CATEGORY_NOT_SET",e[e.CP_DATA_CATEGORY_SOFTWARE_SETUP=2]="CP_DATA_CATEGORY_SOFTWARE_SETUP",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE=3]="CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE=4]="CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE",e[e.CP_DATA_CATEGORY_DEVICE_CONFIGURATION=5]="CP_DATA_CATEGORY_DEVICE_CONFIGURATION",e[e.CP_DATA_CATEGORY_INKING_TYPING_SPEECH=6]="CP_DATA_CATEGORY_INKING_TYPING_SPEECH"}(cg||(cg={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.QueryDetails="QueryDetails",e.Chat="Chat"}(ug||(ug={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone",e.AshaError="AshaError"}(dg||(dg={})),function(e){e[e.CP_DIAGNOSTIC_LEVEL_OPTIONAL=1]="CP_DIAGNOSTIC_LEVEL_OPTIONAL",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED=2]="CP_DIAGNOSTIC_LEVEL_REQUIRED",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES=3]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA=4]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA"}(pg||(pg={}));var vg=function(){function e(){}return e.prototype.LogTelemetryEvent=function(e){nb("LogTelemetryEvent: EventName: "+e.GetEventName()+"\n EventType: "+e.GetEventType()+"\n EventLogs: ",e.GetLogs())},e}(),bg=function(){function e(e,t,n,r,o,i,a,s,l,c){this.logs=n,this.isRequired=s||!1,this.shouldLog=null==a||a,this.eventType=e,this.eventName=t,this.diagnosticLevel=c||pg.CP_DIAGNOSTIC_LEVEL_OPTIONAL,this.dataCategory=l||cg.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,this.scenarioName=r,this.capability=o,this.verb=i||""}return e.prototype.GetLogs=function(){return this.logs},e.prototype.SetLogs=function(e){this.logs=e},e.prototype.AddLog=function(e){this.logs.push(e)},e.prototype.IsRequired=function(){return this.isRequired},e.prototype.SetIsRequired=function(e){this.isRequired=e},e.prototype.SetEventType=function(e){this.eventType=e},e.prototype.GetEventType=function(){return this.eventType},e.prototype.SetEventName=function(e){this.eventName=e},e.prototype.GetEventName=function(){return this.eventName},e.prototype.SetDataCategory=function(e){this.dataCategory=e},e.prototype.GetDataCategory=function(){return this.dataCategory},e.prototype.SetDiagnosticLevel=function(e){this.diagnosticLevel=e},e.prototype.GetDiagnosticLevel=function(){return this.diagnosticLevel},e.prototype.SetScenarioName=function(e){this.scenarioName=e},e.prototype.GetScenarioName=function(){return this.scenarioName},e.prototype.SetCapability=function(e){this.capability=e},e.prototype.GetCapability=function(){return this.capability},e.prototype.GetShouldLog=function(){return this.shouldLog},e.prototype.SetShouldLog=function(e){this.shouldLog=e},e.prototype.GetVerb=function(){return this.verb},e.prototype.SetVerb=function(e){this.verb=e},e}(),yg=function(){function e(){var e=this;this.chatHistoryInfoLog=[],this.userQueryGuid=Bg,this.getTelemetryLatencyEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:_.CopilotChatHistoryInfoJson,value:JSON.stringify(e.chatHistoryInfoLog)}]))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.Latency,dg.Latency,t,r,o,i,n)},this.getASHATelemetryErrorEvent=function(t,n,o,i,a,s,l){return(t=t.concat.apply(t,Object(r.__spreadArray)([],Object(r.__read)(i&&a?Object(r.__spreadArray)([],Object(r.__read)(fg.c.getFields({eventType:fg.c.EventType.Error,veto:i,error:a,inStaging:null==s||s})),!1):[]),!1))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.Error,dg.AshaError,t,n,o,l)},this.getASHAPillarTelemetryEvent=function(t,n,o,i,a){return(t=t.concat.apply(t,Object(r.__spreadArray)([],Object(r.__read)(i?Object(r.__spreadArray)([],Object(r.__read)(fg.c.getFields({eventType:fg.c.EventType.Pillar,pillar:i})),!1):[]),!1))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.ChatEvents,dg.ChatEvents,t,n,o,a)},this.getTelemetryErrorEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:D.UserQueryOrder,value:qv}]))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.Error,dg.Error,t,r,o,i,n)},this.getTelemetryQueryDetailsEvent=function(t,n,r,o){return(t=t.concat(e.getDataFields([{key:W.UserQueryOrder,value:qv}]))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.QueryDetails,dg.QueryDetails,t,n,r,o)},this.getTelemetryChatEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:D.UserQueryOrder,value:qv}]))).find((function(e){return e.name===q}))||(t=t.concat(e.getDataFields([{key:q,value:e.userQueryGuid.length>0?e.userQueryGuid:Wv}]))),new bg(ug.ChatEvents,dg.ChatEvents,t,r,o,i,n)},this.chatHistoryInfoLog=[]}return e.setTelemetryHandler=function(e){this.telemetryHandler=e},e.getTelemetryHandler=function(){return this.telemetryHandler},e.prototype.addChatHistoryInfoLog=function(e){this.chatHistoryInfoLog.push(e)},e.prototype.resetChatHistoryInfoLog=function(){this.chatHistoryInfoLog=[]},e.prototype.setUserQueryGuid=function(e){this.userQueryGuid=e},e.getInstance=function(){return e.telemetryHandler||this.setTelemetryHandler(new vg),this.sInstance||(this.sInstance=new e),this.sInstance},e.prototype.sendTelemetryLatencyData=function(t,n,r,o,i){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&(e.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEvent(this.getDataFields(t),n,r,o,i)),this.resetChatHistoryInfoLog())},e.prototype.sendTelemetryErrorData=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryErrorEvent(this.getDataFields(t),!0,n,r,o))},e.prototype.sendTelemetryQueryDetailsObject=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryQueryDetailsEvent(this.getDataFields(t),n,r,o))},e.prototype.sendTelemetryChatEventData=function(t,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryChatEvent(this.getDataFields(t),n,r,o,i))},e.prototype.getCopilotScorecardData=function(e,t,n,o,i,a,s,l){return(e=e.concat(Object(r.__spreadArray)([],Object(r.__read)(fg.e.getFields({featureActionType:fg.e.FeatureActionType[t],isUserInitiated:!0,capability:gb(i)?"":fg.e.Capability[i],verb:gb(s)?"":fg.e.Verb[s],featureName:gb(o)?"Others":o,subFeatureName:gb(l)?"":l,entryPoint:n,isThumbsUp:gb(a)?null:a})),!1))).find((function(e){return e.name===q}))||(e=e.concat(this.getDataFields([{key:q,value:this.userQueryGuid.length>0?this.userQueryGuid:Wv}]))),new bg(ug.Chat,dg.Chat,e,o,i,s,!0,!0,cg.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,pg.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?mg.b(e.key,e.value,e.tag):"string"==typeof e.value?mg.d(e.key,e.value,e.tag):"boolean"==typeof e.value?mg.a(e.key,e.value,e.tag):mg.d(e.key,e.value,e.tag)}),[])},e.prototype.logSeenEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),fg.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logTriedEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),fg.e.FeatureActionType.IsTried,n,r,o,i,a,s))},e.prototype.logKeptEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),fg.e.FeatureActionType.IsKept,n,r,o,i,a,s))},e.prototype.logEnabledEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),fg.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logEventWithAshaPillar=function(t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHAPillarTelemetryEvent(this.getDataFields(t),n,r,o,i))},e.prototype.logErrorWithAshaVetoAndError=function(t,n,r,o,i,a,s){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHATelemetryErrorEvent(this.getDataFields(t),n,r,o,i,a,s))},e}(),Cg=function(e){return"ChatCompose"===e?V.Draft:V.ChatQnA},Og=function(e){switch(e){case V.Draft:return z.ChatComposeDidNotGenerateContent;case V.ChatQnA:return z.BasicChatDidNotGenerateAnswer;default:return}},Sg=function(e){switch(e){case V.Draft:return F.ContentGeneration;case V.ChatQnA:return F.QAandSummaries;default:return}},Eg=function(e){switch(e){case V.Draft:return N.Create;case V.ChatQnA:return N.Ask;default:return}},xg=function(e){switch(e){case V.Draft:return H.ContentCreation;case V.ChatQnA:return H.BasicChat;default:return}};function Ig(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function wg(e){return null==e}var Tg=function(){return"undefined"!=typeof OfficeaicopilotStrings},kg=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(o){hg.getInstance().sendLoggingEventToClient($p.CopyButtonClicked,{chatEventParams:"Basic_Chat"}),t={correlationId:"",featureName:""};try{t=JSON.parse(n)}catch(e){nb("Error parsing telemetry data on copy click",e.message)}var i;return yg.getInstance().logKeptEvent([{key:q,value:t.correlationId||""}],K,t.featureName,Sg(t.featureName),void 0,Eg(t.featureName)),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopyButtonClicked},{key:D.ChatEventParameters,value:t.featureName||""},{key:D.UserQueryGuid,value:t.correlationId||""}]),i=e,Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=ut(i),t=document.getElementById(i).innerText,n=new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([t],{type:"text/plain"})}),e?[4,navigator.clipboard.write([n])]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return o=r.sent(),console.log("Error copying html to clipboard",o.message),[3,4];case 4:return[2]}}))})),[2]}))}))},jg=function(e){return void 0===e&&(e="en"),e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e};var Pg,Ag=6e4,_g=5e3,Dg="Sorry, something went wrong. I'm working on it.",Lg=200,Mg=2e3,Bg="",Rg=" ",Fg="...",Ng="https://augloop-dogfood.officeppe.com",Hg="Choose a starter prompt from the suggestions menu to get started",Ug="Augloop Response Timed Out",Vg="Chat History Response Timed Out",zg=1e4,Gg=function(){return Tg()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},Wg=function(){return Tg()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"},Qg=function(){return Tg()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},qg=function(){return Tg()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts"},Kg=function(){return Tg()?OfficeaicopilotStrings.ErrorOffensiveInputContent:"Sorry, I can't work with that. Try making a new request."},Yg=function(){return Tg()?OfficeaicopilotStrings.ErrorOffensiveOutputContent:"Sorry, I can't generate content for this. Try making a new request."},Zg=function(){return Tg()?OfficeaicopilotStrings.ErrorInputBlockedByDynamicGuardList:"It looks like there's some content here I can't work with. Try asking me to do something else."},Jg=function(){return Tg()?OfficeaicopilotStrings.ErrorInvalidSignal:"Something went wrong. Please try again in a moment."},Xg=function(){return Tg()?OfficeaicopilotStrings.ErrorTimeout:"I can't process your request right now. Try again in a little while. "},$g=function(){return Tg()?OfficeaicopilotStrings.ErrorThrottled:"The maximum number of requests per hour has been reached. Try again in a little while."},eh=function(){return Tg()?OfficeaicopilotStrings.ErrorUserThrottled:"You're only allowed a certain number of requests per second. Try again in a little while."},th=function(){return Tg()?OfficeaicopilotStrings.ErrorInputTooLong:"This is too much information for me to process. Try again with a request that's less than 15,000 words."},nh=function(){return Tg()?OfficeaicopilotStrings.ErrorInvalidLanguage:"Your request includes a language I don't currently support."},rh=function(){return Tg()?OfficeaicopilotStrings.LearnMoreString:"Learn More"};!function(e){e.Opera="Opera",e.Safari="Safari",e.PhantomJS="PhantomJS",e.Edge="Edge",e.Electron="Electron",e.Chrome="Chrome",e.MSIE="MSIE",e.Firefox="Firefox",e.SkypeShell="SkypeShell",e.Unknown="Unknown"}(Pg||(Pg={}));var oh,ih=16;!function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(oh||(oh={}));var ah,sh,lh,ch,uh,dh,ph,gh,hh,fh,mh,vh,bh=function(){return Tg()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},yh=Tg()?OfficeaicopilotStrings.CIQDefaultPlaceholder:"Start typing to search",Ch="ChatWrapperId",Oh="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",Sh=n(832);!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS"}(ah||(ah={})),function(e){e.Chat="chat",e.Human="human"}(sh||(sh={})),function(e){e.BASIC_CHAT="BasicChat",e.DRAFT="Draft"}(lh||(lh={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(ch||(ch={})),function(e){e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsApplyClpFromHydratedMessagedEnabled="IsApplyClpFromHydratedMessagedEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled",e.HydratedMessagesSquashingEnabled="HydratedMessagesSquashingEnabled",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.IsChatHistoryPaginationEnabled="IsChatHistoryPaginationEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.DisableXPIAMitigationFix="DisableXPIAMitigationFix",e.DisableChatHistoryPaginationFix="DisableChatHistoryPaginationFix",e.ChatHistoryDuplicateLoggingFix="ChatHistoryDuplicateLoggingFix",e.EnableSendTenantFeedback="EnableSendTenantFeedback"}(uh||(uh={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(dh||(dh={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(ph||(ph={})),function(e){e.HandleSubmitError="handle-submit-error",e.AugloopInitializationError="augloop-initialization-error",e.ActivateAnnotationError="activate-annotation-error",e.AugloopResponseTimeout="augloop-response-timeout",e.ChatHistoryResponseTimeout="chat-history-response-timeout",e.AugloopPluginProviderFailure="augloop-plugin-provider-failure"}(gh||(gh={})),function(e){e.Shy="Shy",e.Expanded="Expanded"}(hh||(hh={})),function(e){e.Favourite="Favourite",e.Unfavourite="Unfavourite"}(fh||(fh={})),function(e){e.PromptGuide="PromptGuide",e.Microphone="Microphone",e.SubmitButton="SubmitButton",e.GroundingButton="GroundingButton"}(mh||(mh={})),function(e){e.ENTERPRISE_SEARCH="EnterpriseSearch",e.WEB_SEARCH="BingWebSearch"}(vh||(vh={}));var Eh,xh,Ih=function(){function e(e){this.workflowDataMap=new Map,this.copilotCommunicationHandler=e,this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())}return e.getInstance=function(t){if(!e.instance){if(!t)throw new Error("WorkflowDataMap has not been initialized");e.instance=new e(t)}return e.instance},e.prototype.populateWorkflowDataMap=function(e){var t,n;try{for(var o=Object(r.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value,s={workflowInfo:a};this.workflowDataMap.set(a.workflowAnnotationType,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsQnASuggestionPillCachingEnabled)&&!this.workflowDataMap.has(og.c.getTypeName())&&this.workflowDataMap.set(og.c.getTypeName(),{workflowInfo:{workflowAnnotationType:og.c.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsSharedCopilotLabEnabled)&&(this.workflowDataMap.has(Sh.a.getTypeName())?this.workflowDataMap.get(Sh.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(Sh.a.getTypeName(),{workflowInfo:{workflowAnnotationType:Sh.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}})),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsClpSensitivityInChatInputEnabled)&&!this.workflowDataMap.has(ig.a.getTypeName())&&this.workflowDataMap.set(ig.a.getTypeName(),{workflowInfo:{workflowAnnotationType:ig.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:15e3}}),(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsCopilotPluginEnabled)||this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsPersistanceInPhase2UxEnabled))&&(this.workflowDataMap.has(rg.a.getTypeName())?this.workflowDataMap.get(rg.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(rg.a.getTypeName(),{workflowInfo:{workflowAnnotationType:rg.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}))},e.prototype.getWorkflowDataMap=function(e){return void 0===e&&(e=!1),e&&(this.workflowDataMap.clear(),this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())),this.workflowDataMap},e.prototype.isWorkflowRegistered=function(e){return this.workflowDataMap.has(e)},e.prototype.getWorkflowAugloopTimeoutValue=function(e){return this.isWorkflowRegistered(e)?this.workflowDataMap.get(e).workflowInfo.augloopResponseTimeout:Ag},e.prototype.isAugloopResponseTimeoutRequired=function(e){return!!this.isWorkflowRegistered(e)&&this.workflowDataMap.get(e).workflowInfo.augloopResponseTimerRequired},e}(),wh=Ih,Th=n(1540),kh=n(1605),jh=n(2123),Ph=function(){function e(t){var n,r,o,i,a,s,l,c,u;e.appName=t.appName,e.augloopUrl=null!==(n=t.augloopUrl)&&void 0!==n?n:Ng,e.devBuild=null!==(r=t.devBuild)&&void 0!==r&&r,e.environment=t.environment,e.sessionId=t.sessionId,e.workflow=null!==(o=t.workflow)&&void 0!==o?o:qp.ACTION_AI,e.appVersion=null!==(i=t.appVersion)&&void 0!==i?i:"",e.appInternalName=null!==(a=t.appInternalName)&&void 0!==a?a:"",e.appPlatform=null!==(s=t.appPlatform)&&void 0!==s?s:"",e.augloopFlights=null!==(l=t.augloopFlights)&&void 0!==l?l:"",e.language=null!==(c=t.language)&&void 0!==c?c:"en-US",e.substrateScenarioName=null!==(u=t.substrateScenarioName)&&void 0!==u?u:"",e.feedbackSettings=t.feedbackSettings}return e.getAppName=function(){return e.appName},e.getAugloopUrl=function(){return e.augloopUrl},e.isDevbuild=function(){return e.devBuild},e.getEnvironment=function(){return e.environment},e.getSessionId=function(){return e.sessionId},e.getWorkflowType=function(){return e.workflow},e.getAppVersion=function(){return e.appVersion},e.getAppInternalName=function(){return e.appInternalName},e.getAppPlatform=function(){return e.appPlatform},e.getAugloopFlights=function(){return e.augloopFlights},e.getLanguage=function(){return e.language},e.getSubstrateScenarioName=function(){return e.substrateScenarioName},e.getFeedbackSettings=function(){return e.feedbackSettings},e}(),Ah=Fu.CurrentContext.toString(),_h=!1,Dh=function(){return Ah},Lh=function(){function e(){this.messageRequestIdMap={}}return e.prototype.updateMessageIdMap=function(){this.currentUserMessageId&&this.requestId&&!this.messageRequestIdMap[this.requestId]&&(this.messageRequestIdMap[this.requestId]=this.currentUserMessageId)},Object.defineProperty(e.prototype,"ConversationId",{get:function(){return this.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RequestId",{get:function(){return this.requestId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SydneyEndpoint",{get:function(){return this.sydneyEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ChatTimestamp",{get:function(){return this.chatTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return this.locale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ErrorMessage",{get:function(){return this.errorMessage},set:function(e){this.errorMessage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentUserMessageId",{get:function(){return this.currentUserMessageId},set:function(e){this.currentUserMessageId=e},enumerable:!1,configurable:!0}),e.prototype.GetMessageIdForRequestId=function(e){return this.messageRequestIdMap[e]},Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.Observe=function(e){var t,n,r,o,i,a;if(e)try{if(e.conversationId&&e.conversationId!==this.conversationId&&(this.conversationId=e.conversationId,nb("ChatStateObserver ConversationId: "+e.conversationId)),e.sydneyEndpoint&&!this.sydneyEndpoint&&(this.sydneyEndpoint=null!==(t=e.sydneyEndpoint)&&void 0!==t?t:this.sydneyEndpoint),this.requestId=null!==(n=e.queryId)&&void 0!==n?n:this.requestId,this.requestId&&this.updateMessageIdMap(),this.chatTimestamp=null!==(r=e.timestamp)&&void 0!==r?r:(new Date).toISOString(),!this.locale&&(null===(o=e.chatResponse)||void 0===o?void 0:o.messages)){var s=null===(a=null===(i=e.chatResponse)||void 0===i?void 0:i.messages)||void 0===a?void 0:a.find((function(e){return e.locale}));(null==s?void 0:s.locale)&&(this.locale=null==s?void 0:s.locale)}}catch(e){nb("Exception ocurred in ChatStateObserver "+e)}},e.prototype.NewChatInitiated=function(){this.currentUserMessageId=void 0,this.requestId=void 0,this.chatTimestamp=void 0,this.errorMessage=void 0},e}(),Mh=function(){function e(t,n,r){var o=this;this.citationPathDataIndexMap=new Map,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.streamChunks=[],this.isAnswerCompleted=!1,this.isBasicChatStreaming=!1,this.queryID="",this.suggestedQnaSignalSubmitTime=0,this.featureName=V.ChatQnA,this.onClickCitationLink=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=""),nb("onClickCitationLink called with referenceId : ".concat(e,"  ,path"),o.citationPathDataIndexMap.get(e));var r={correlationId:"",featureName:""};try{r=JSON.parse(n)}catch(e){nb("Error parsing telemetry data on citation click",e.message)}o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CitationClicked},{key:D.UserQueryGuid,value:r.correlationId||""}]);var i={referencePath:t.length>0?t:o.citationPathDataIndexMap.get(e),workflowAnnotationType:og.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(Xp.CitationLinkClicked,i)},this.sendBasicChatSuggestionPillsEvent=function(e){var t={suggestionPills:e,workflowAnnotationType:og.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(Xp.BasicChatSuggestionPills,t)},this.getMarkdownReferences=function(e){return void 0===e||e&&0===e.length||!o.basicChatProps.isCitationsEnabled?[]:(o.citationPathDataIndexMap.clear(),e.map((function(e){var t,n,r;o.citationPathDataIndexMap.set(e.contentIndex,e.path),e.content&&e.content.length>150&&(e.content=e.content.substring(0,150).trim()+"...");var i='"'+e.content.slice(0,18).trim()+'..."';return e.content='"'+e.content+'"',{referenceIndex:e.contentIndex,referenceProps:{title:i,primarySubtitle:null===(t=o.basicChatProps)||void 0===t?void 0:t.citationTitle,snippet:e.content,iconAppName:e.type,referenceType:Xr.Internal,citationPosition:e.position,onClickCitationLink:o.onClickCitationLink,sensitivityLabel:null===(r=null===(n=o.basicChatProps)||void 0===n?void 0:n.sensitivityIndicatorData)||void 0===r?void 0:r.badgeText,path:e.path}}})))},this.updateCardWithFooter=function(){var t,n;o.chatContainerBuilder.updateLastMessage(P.MarkdownCard,void 0,{feedbackSectionPosition:er.Footer,showAnimation:!0,actionButtonList:[o.getCopyButton()],clpSensitivityIndicatorData:null!==(n=null===(t=e.getInstance().getBasicChatProps())||void 0===t?void 0:t.sensitivityIndicatorData)&&void 0!==n?n:void 0},!0)},this.sendBasicChatProcessingEvent=function(e){o.copilotCommunicationHandler.sendEventToClient(Xp.BasicChatStatus,e)},this.getFeedbackData=function(){var e=o.copilotCommunicationHandler.getFeedbackData(),t=o.featureName;return e&&!e.feedbackArea&&(e={feedbackArea:t===V.Draft?lh.DRAFT:lh.BASIC_CHAT,contextData:{cardMetaData:JSON.stringify({prompt:Qv,promptId:o.queryID,utteranceTimestamp:(new Date).toISOString(),groundingSource:Dh(),feedbackMessageId:Lh.Instance.CurrentUserMessageId})}}),e},this.handleTimeoutForBasicChatStreaming=function(){var e=o.getFeatureName();o.isFirstStreamChunk||(o.paragraphChunks.length>0&&(o.updateCardWithFooter(),o.resetBasicChatStreamingStates(!1)),o.isAnswerCompleted||o.chatContainerBuilder.setChatMessageData(P.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:Dg}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:er.Footer,isFailure:!0,showAnimation:!1,feedbackData:o.getFeedbackData()},!0),o.setIsExecuting(!1)),o.sendBasicChatProcessingEvent({status:eg.Finished,workflowAnnotationType:og.b.getTypeName(),queryID:o.queryID,isSuccess:!1}),o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.BasicChatStreamingResponseTimeout},{key:D.UserQueryGuid,value:o.queryID},{key:D.ChatErrorType,value:U.Server}]),o.telemetryLoggerUtils.logErrorWithAshaVetoAndError([],e,"",Og(e),G.Timeout),o.resetBasicChatStreamingStates(!1)},this.sendLoggingEventToClient=function(e,t){o.loggingEventHandler.sendLoggingEventToClient(e,t)},this.getIsFirstStreamChunk=function(){return o.isFirstStreamChunk},this.setIsFirstStreamChunk=function(e){o.isFirstStreamChunk=e},this.getParagraphChunks=function(){return o.paragraphChunks},this.setParagraphChunks=function(e){o.paragraphChunks=e},this.getIsAnswerCompleted=function(){return o.isAnswerCompleted},this.setIsAnswerCompleted=function(e){o.isAnswerCompleted=e},this.getIsBasicChatStreaming=function(){return o.isBasicChatStreaming},this.setIsBasicChatStreaming=function(e){o.isBasicChatStreaming=e},this.setQueryID=function(e){o.queryID=e},this.setFeatureName=function(e){o.featureName=e},this.getFeatureName=function(){return o.featureName},this.getQueryID=function(){return o.queryID},this.setBasicChatProps=function(e){o.basicChatProps=e},this.getIsFluxFlowEnabled=function(){var e;return null===(e=o.basicChatProps)||void 0===e?void 0:e.isFluxFlowEnabled},this.updateStreamChunks=function(e){o.streamChunks.push(e)},this.getStreamChunks=function(){return o.streamChunks},this.getBasicChatProps=function(){return o.basicChatProps},this.getSuggestedQnaSignalSubmitTime=function(){return o.suggestedQnaSignalSubmitTime},this.getSuggestedQnaScenarioSignalOperation=function(){var e={isBasicChat:!0,chatHistory:[],isStreaming:!0,queryId:Object(ag.a)(),userLanguage:jg(Ph.getLanguage()),isSuggestedQnAScenario:!0},t=new kh.b({parentPath:["Signal",Th.a.getTypeName()],items:[{id:jh.a.generateId(),body:new Th.a(e)}]});return o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.BasicChatOperationSubmitted},{key:D.UserQueryGuid,value:e.queryId}]),o.suggestedQnaSignalSubmitTime=(new Date).getTime(),t},this.resetBasicChatStreamingStates=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),o.streamChunks.length>0&&(o.telemetryLoggerUtils.sendTelemetryLatencyData([{key:_.QnAResponseTime,value:Yv(Vv)},{key:_.IsQuerySuccess,value:e},{key:_.QnAChunkInfo,value:JSON.stringify(o.getStreamChunks())},{key:_.UserQueryGuid,value:o.queryID},{key:_.AnnotationType,value:og.b.getTypeName()}],t),e&&o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.QuerySuccessful},{key:D.UserQueryGuid,value:o.queryID},{key:D.ChatEventParameters,value:og.b.getTypeName()}])),o.setIsFirstStreamChunk(!0),o.setParagraphChunks(""),o.setIsAnswerCompleted(!1),o.setIsBasicChatStreaming(!1),o.setQueryID(""),o.streamChunks=[],o.featureName=V.ChatQnA},this.chatContainerBuilder=t,this.copilotCommunicationHandler=n,this.setIsExecuting=r,this.loggingEventHandler=hg.getInstance(),this.telemetryLoggerUtils=yg.getInstance()}return e.getInstance=function(t,n,r){if(!e.instance){if(!t||!r||!n)throw new Error("BasicChat Utils is not initialized");e.instance=new e(t,n,r)}return e.instance},e.prototype.getCopyButton=function(){return{type:zr.Default,title:Gg(),text:J()?"":Gg(),iconRegular:J()?we.e:we.c,popoverProps:{popoverTitle:Qg()},position:J()?Gr.FeedbackSection:Gr.ActionButtonBar,handleButtonOnClick:kg}},e}(),Bh=function(){function e(e,t){var n=this;this.augloopResponseTimerID=null,this.augloopResponseTimeout=Ag,this.telemetryLoggerUtils=yg.getInstance(),this.augloopResponseTimeoutInternal=function(){n.augloopResponseTimerID=null,nb("Augloop Response Timed Out for workflow",n.workflowAnnotationType),Of.getInstance().clearOperationListForResubmit(),n.augloopResponseTimeout=Ag;var e=!0;n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:_.ErrorParameter,value:M.AugloopResponseTimeout},{key:_.ErrorType,value:U.Server}]),Mh.getInstance().getIsBasicChatStreaming()&&n.workflowAnnotationType===og.b.getTypeName()?(Mh.getInstance().handleTimeoutForBasicChatStreaming(),e=!1):n.workflowAnnotationType===ig.a.getTypeName()?n.setSensitivityWarningInfo():(n.copilotCommunicationHandler.sendEventToClient(Xp.AugloopResponseTimeout,{workflowAnnotationType:n.workflowAnnotationType}),Lh.Instance.ErrorMessage="Augloop_Response_TimedOut_"+n.workflowAnnotationType),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.AugloopResponseTimeout},{key:D.ChatErrorType,value:U.Server},{key:D.ChatEventParameters,value:n.workflowAnnotationType}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:L.ErrorMessage,value:Ug},{key:L.ErrorType,value:U.Server},{key:L.ErrorCode,value:gh.AugloopResponseTimeout},{key:L.ErrorCategory,value:A.ChatEvents}]),e&&n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(Vv)},{key:_.IsQuerySuccess,value:!1}],!0)},this.copilotCommunicationHandler=e,this.setSensitivityWarningInfo=t}return e.getInstance=function(t,n){if(!e.sInstance){if(!t||!n)throw new Error("AugloopResponseTimeoutHandler has not been initialized");e.sInstance=new e(t,n)}return e.sInstance},e.prototype.setAugloopResponseTimer=function(e){var t;nb("Setting augloop response Timer for workflow ".concat(e)),this.clearAugloopResponseTimer(),wg(e)||(this.workflowAnnotationType=e),wg(this.workflowAnnotationType)||(this.augloopResponseTimeout=wh.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)),this.augloopResponseTimeout=null!==(t=this.augloopResponseTimeout)&&void 0!==t?t:Ag,this.augloopResponseTimerID=window.setTimeout(this.augloopResponseTimeoutInternal,this.augloopResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(){null!==this.augloopResponseTimerID&&(nb("Clear augloop response Timer"),clearTimeout(this.augloopResponseTimerID),this.augloopResponseTimerID=null,this.augloopResponseTimeout=Ag)},e.prototype.isAugloopResponseTimerSet=function(){return!wg(this.augloopResponseTimerID)},e}(),Rh=n(3470),Fh=n(1141),Nh=function(e){Eh=e};!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(xh||(xh={}));var Hh=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k;return Object(r.__generator)(this,(function(j){try{if(o=JSON.parse(e),i=(new Date).toISOString(),a=function(e){var t,n,o,i,a,s=null!==(i=null===(o=null==e?void 0:e.elements)||void 0===o?void 0:o.options)&&void 0!==i?i:[],l="CopilotChatFeedback",c=0;try{for(var u=Object(r.__values)(s),d=u.next();!d.done;d=u.next())switch(null===(a=d.value.displayedText)||void 0===a?void 0:a.toLowerCase()){case xh.INACCURATE_OR_IRRELEVANT:c=33554432;break;case xh.OFFENSIVE:l="CopilotChatReportHarm",c=32;break;case xh.OTHER:c=64}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return{AnswerType:l,FeedbackReasonType:c}}(null==o?void 0:o.responseContent),s=a.AnswerType,l=a.FeedbackReasonType,c=Lh.Instance,u=null!==(C=c.ConversationId)&&void 0!==C?C:af,d=null!==(E=null===(S=null===(O=null==o?void 0:o.responseContent)||void 0===O?void 0:O.elements.find((function(e){return e.userVerbatim})))||void 0===S?void 0:S.userVerbatim)&&void 0!==E?E:(null==o?void 0:o.responseContent)?JSON.stringify(o.responseContent):"",p=function(e){var t,n;try{var r=(null===(t=null==e?void 0:e.contextData)||void 0===t?void 0:t.cardMetaData)?JSON.parse(null===(n=null==e?void 0:e.contextData)||void 0===n?void 0:n.cardMetaData):void 0;if(r)return{feedbackTraceId:null==r?void 0:r.promptId,utteranceTimestamp:null==r?void 0:r.utteranceTimestamp,feedbackMessageId:null==r?void 0:r.feedbackMessageId}}catch(e){nb("Error parsing feedbackData",e.message)}return{feedbackTraceId:void 0,utteranceTimestamp:void 0,feedbackMessageId:void 0}}(Eh),g=p.feedbackTraceId,h=p.utteranceTimestamp,f=p.feedbackMessageId,m=g||c.RequestId,!(v=null!=f?f:c.GetMessageIdForRequestId(m))&&!n||!u||!c.SydneyEndpoint||!c.SydneyEndpoint.length)return yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.FeedbackDataSydneyDataMissing}]),[2];b=Object.assign(new Fh.a,{responseData:{AnswerType:s,ClientName:t+"CopilotOCV",CorrelationId:Object(ag.a)(),Date:i,Description:d,FeedbackId:null!==(x=null==o?void 0:o.diagnosticsUploadId)&&void 0!==x?x:Object(ag.a)(),FeedbackRating:"Frown"===(null==o?void 0:o.feedbackType)?1:2,FeedbackReasonType:l,UserConsentGiven:null===(I=null==o?void 0:o.hostManagedContextDataConsent)||void 0===I||I,OptionalFields:{ConvId:u||"!CONVID_NA_"+(c.ErrorMessage?"[".concat(c.ErrorMessage,"]"):""),Endpoint:(null===(w=c.SydneyEndpoint)||void 0===w?void 0:w.length)?c.SydneyEndpoint:"https://substrate.office.com/m365chat/SecuredChatHub",Locale:null!==(T=c.Locale)&&void 0!==T?T:"en-us",TraceId:null!=v?v:(null==m?void 0:m.length)?m:"!TRACE_ID_NA",FeedbackSourceType:"OCV",UtteranceHappenTime:null!=h?h:(null===(k=c.ChatTimestamp)||void 0===k?void 0:k.length)?c.ChatTimestamp:i,ContactMe:!!(null==o?void 0:o.userEmail)}}}),y=new kh.b({parentPath:["Signal",Fh.a.getTypeName()],items:[{id:jh.a.generateId(),body:b}]}),nb("Submitting FeedbackDiagnosticDataSignal to Augloop : ".concat(Fh.a.getTypeName()," with signal: ").concat(JSON.stringify(y))),Of.getInstance().submitOperation(y,Fh.a.getTypeName()),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.FeedbackDataUploadOperationSubmitted}])}catch(e){nb("Error parsing feedback response data",e.message)}return[2]}))}))},Uh=function(){function e(e,t){var n=this;this.handleThumbsDownClick=function(e,t,r){Nh(e),n.copilotCommunicationHandler.feedbackButtonClicked(Zp.DISLIKE,e,t,r)},this.handleThumbsUpClick=function(e,t,r){Nh(e),n.copilotCommunicationHandler.feedbackButtonClicked(Zp.LIKE,e,t,r)},this.addChatMessages=function(e){e.length>0&&n.setChatLog((function(t){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(e),!1)}))},this.getLastMessage=function(e){var t;return void 0===e&&(e=!0),n.setChatLog((function(n){return t=n[pb(n,e)],n})),t},this.clearMessages=function(){n.setChatLog((function(){return[]}))},this.getFeedbackData=function(){var e=n.copilotCommunicationHandler.getFeedbackData();return e&&(null==e?void 0:e.contextData)||(e={feedbackArea:e.feedbackArea,contextData:{cardMetaData:JSON.stringify({prompt:Qv,promptId:Wv,utteranceTimestamp:(new Date).toISOString(),groundingSource:Dh(),feedbackMessageId:Lh.Instance.CurrentUserMessageId})}}),e},this.copilotCommunicationHandler=t,this.setChatLog=e}var t;return e.convertResponseMessageToChatMessage=function(e,n,o){var i,a,s;try{s=JSON.parse(o.telemetryData)}catch(e){nb("Error parsing telemetry data in chat message builder",e.message)}return{messageType:e,body:t.getChatMessageBody(e,n),feedbackData:o.feedbackData,shouldShowAIGeneratedIndicator:o.shouldShowAIGeneratedIndicator,feedbackSectionPosition:o.feedbackSectionPosition,showMinifiedUI:o.showMinifiedUI,showAnimation:o.showAnimation,actionBarButtons:o.actionButtonList,strikeThroughText:o.strikeThroughText,references:o.references,handleShowMeOnClick:o.handleShowMeOnClick,warningActionButtons:null!==(i=o.warningActionButtons)&&void 0!==i?i:void 0,clpSensitivityIndicatorData:null!==(a=o.clpSensitivityIndicatorData)&&void 0!==a?a:void 0,telemetryData:JSON.stringify(void 0===s?{correlationId:Wv}:Object(r.__assign)(Object(r.__assign)({},s),{correlationId:s.correlationId||Wv})),messageId:o.messageId,msgExtCardProps:o.msgExtCardProps,pluginAuthError:o.pluginAuthError}},e.prototype.setChatMessageData=function(e,n,o,i,a){var s;void 0===o&&(o={shouldShowAIGeneratedIndicator:!1,showAnimation:!1,feedbackData:this.getFeedbackData(),isFailure:!1,showMinifiedUI:!1,feedbackSectionPosition:er.None,aiResponseMetadata:void 0,actionButtonList:void 0,strikeThroughText:!1,references:void 0,handleShowMeOnClick:void 0,warningActionButtons:void 0,clpSensitivityIndicatorData:void 0,telemetryData:void 0,messageId:void 0,msgExtCardProps:void 0,pluginAuthError:void 0}),void 0===i&&(i=!0),void 0===a&&(a=!1);var l=t.convertResponseMessageToChatMessage(e,n,o);this.setChatLog((function(e){var t=Object(r.__spreadArray)([],Object(r.__read)(e),!1);if(a&&void 0!==o.messageId){var n=e.findIndex((function(e){return e.messageId===o.messageId}));if(-1!==n)return t[n]=l,t}return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),[l],!1)})),i&&hb()&&e!==P.FeedbackNudge&&qh(l,Yh(n,e),(null===(s=l.body)||void 0===s?void 0:s.user)===sh.Human,o.isFailure,o.aiResponseMetadata)},e.prototype.getProps=function(e,t){var n;return{chatLog:e,shouldShowFeedbackButtons:null===(n=null==t?void 0:t.showFeedbackButtons)||void 0===n||n,handleChatCardThumbsUpClick:this.handleThumbsUpClick,handleChatCardThumbsDownClick:this.handleThumbsDownClick}},e.prototype.updateLastMessage=function(e,n,o,i){var a=this;void 0===i&&(i=!0),this.setChatLog((function(s){var l,c=Object(r.__spreadArray)([],Object(r.__read)(s),!1);if(0!==c.length){var u=c[pb(c)];n&&void 0!==(null==u?void 0:u.body)&&(u.body=t.getChatMessageBody(e,n)),o&&Object.entries(o).forEach((function(e){var t=Object(r.__read)(e,2),n=t[0],o=t[1];"actionButtonList"===n?u.actionBarButtons=o:void 0!==o&&(u[n]=o)})),i&&hb()&&(n||(n=a.getChatMessageData(u.body,e)),qh(u,Yh(n,e),(null===(l=u.body)||void 0===l?void 0:l.user)===sh.Human,null==o?void 0:o.isFailure,null==o?void 0:o.aiResponseMetadata))}return c}))},e.prototype.deleteMessage=function(e,t){this.setChatLog((function(n){for(var o=Object(r.__spreadArray)([],Object(r.__read)(n),!1),i=o.length-1;i>=0;i--){var a=o[i];if(a.messageId===t&&a.messageType===e){o.splice(i,1);break}}return o}))},e.prototype.getChatMessageData=function(e,t){var n={};switch(t){case P.ContentCard:n.contentCardProps=e;break;case P.AccordionCard:n.accordionCardProps=e;break;case P.ChatCardWrapper:n.chatCardWrapperProps=e;break;case P.SelfHelpAdaptiveCard:n.selfHelpAdaptiveCardProps=e;break;case P.StreamingAdaptiveCard:n.streamingAdaptiveCardProps=e;break;case P.MarkdownCard:n.markDownCardProps=e;break;case P.Designer:n.designerCardProps=e;break;case P.WarningMessage:n.warningMessageCardProps=e;break;case P.ProactiveSuggestionCard:n.proactiveSuggestionCardProps=e;break;default:n.defaultMessageProps=e}return n},t=e,e.getFeedBackNudgeMessageBody=function(e){return{imageSrc:e}},e.getChatMessageBody=function(e,o){var i;switch(e){case P.ContentCard:i=Object(r.__assign)({},o.contentCardProps);break;case P.AccordionCard:i=Object(r.__assign)({},o.accordionCardProps);break;case P.ChatCardWrapper:i=Object(r.__assign)({},o.chatCardWrapperProps);break;case P.FeedbackNudge:i=t.getFeedBackNudgeMessageBody(n(2729));break;case P.SelfHelpAdaptiveCard:i=Object(r.__assign)({},o.selfHelpAdaptiveCardProps);break;case P.StreamingAdaptiveCard:i=Object(r.__assign)({},o.streamingAdaptiveCardProps);break;case P.MarkdownCard:i=Object(r.__assign)({},o.markDownCardProps);break;case P.Designer:i=Object(r.__assign)({},o.designerCardProps);break;case P.CopilotWorkflowMessage:i=Object(r.__assign)({},o.copilotWorkflowsCardProps);break;case P.WarningMessage:i=Object(r.__assign)({},o.warningMessageCardProps);break;case P.PaginatedCard:i=Object(r.__assign)({},o.paginatedCardProps);break;case P.ProactiveSuggestionCard:i=Object(r.__assign)({},o.proactiveSuggestionCardProps);break;default:i=Object(r.__assign)({},o.defaultMessageProps)}return i},e}(),Vh=void 0,zh=void 0;function Gh(e,t,n){if(e.isFeatureGateEnabledFromClient(uh.SkipHydrateEnabled))nb("hydrateMessages: Skipping hydrating chat pane with history messages");else{nb("hydrateMessages: Hydrating ".concat(t.length," messages"));var o=Wh(t);n((function(t){var n=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(o),!1);if(!e.isFeatureGateEnabledFromClient(uh.HydratedMessagesSquashingEnabled))return n;var i=function(e,t){void 0===t&&(t=function(e){return e.messageId});var n=new Map,o=new Map,i=e.map((function(e){return[e,t(e)]}));i.forEach((function(e,t){var i=Object(r.__read)(e,2),a=i[0],s=i[1];void 0!==s&&(o.set(s,a),n.has(s)||n.set(s,t))}));var a=[];return i.forEach((function(e,t){var i=Object(r.__read)(e,2),s=i[0],l=i[1];void 0===l?a.push(s):t===n.get(l)&&a.push(o.get(l))})),a}(n);if(nb("hydrateMessages: Squashing reduced ".concat(n.length," messages to ").concat(i.length)),e.isFeatureGateEnabledFromClient(uh.IsApplyClpFromHydratedMessagedEnabled)&&i&&i.length>0){var a=Object(r.__spreadArray)([],Object(r.__read)(new Set(i.map((function(e){var t;return null===(t=e.clpSensitivityIndicatorData)||void 0===t?void 0:t.labelId})).filter(Boolean))),!1),s={messagesClpLabels:a,workflowAnnotationType:"UpdateChatClpFromChatHistory"};e.sendEventToClient(Xp.UpdateChatClpFromChatHistory,s)}return i}))}}function Wh(e){var t,n,o=[];try{for(var i=Object(r.__values)(e.slice().reverse()),a=i.next();!a.done;a=i.next()){var s=Qh(a.value);s&&o.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}function Qh(e){return e.richTextJson?function(e){var t;nb("parsing rich text and display message");try{t=JSON.parse(e)}catch(e){return void nb("error parsing rich text from chat history",e.message)}if(t.messageType===P.ChatCardWrapper&&!t.body.renderData)return void nb("No render data found for ChatCardWrapper");t.showAnimation=!1,t.clpSensitivityIndicatorData&&(t=Object(r.__assign)(Object(r.__assign)({},t),{clpSensitivityIndicatorData:Object(r.__assign)(Object(r.__assign)({},t.clpSensitivityIndicatorData),{icon:void 0})}));if(!wg(t)&&t.body)return t;return}(e.richTextJson):e.content?function(e){var t,n=e.format,r=e.userRole,o=e.content;if(n===ng.b.PlainText){var i=r===ng.f.User;t={messageType:P.Default,body:{user:i?"human":"chat",messageHeader:{text:o}},shouldShowAIGeneratedIndicator:!i,showAnimation:!i,feedbackSectionPosition:i?er.None:er.Footer}}else t={messageType:P.MarkdownCard,body:{user:"chat",message:o},shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:er.Footer};if(!wg(t)&&t.body)return t;return}(e):void 0}function qh(e,t,n,r,o){var i=Kh(e,t,n,r,o);e.messageType===P.ChatCardWrapper&&(Vh=i,zh=e.messageId),uf(ng.c.AddMessageOperation,i)}function Kh(e,t,n,o,i){var a;if((a=e.actionBarButtons?Object(r.__assign)(Object(r.__assign)({},e),{actionBarButtons:void 0}):e.warningActionButtons?Object(r.__assign)(Object(r.__assign)({},e),{warningActionButtons:void 0}):e.messageType===P.Designer?Object(r.__assign)(Object(r.__assign)({},e),{actionBarButtons:void 0,feedbackSectionPosition:er.None,body:Object(r.__assign)(Object(r.__assign)({},e.body),{isRehydration:!0})}):e).messageType===P.ChatCardWrapper){var s=a.body;s.renderData&&s.element&&(a=Object(r.__assign)(Object(r.__assign)({},a),{body:Object(r.__assign)(Object(r.__assign)({},s),{element:void 0})}))}var l="";try{l=JSON.stringify(a)}catch(e){nb("error while stringify chat card props error:",e.message)}var c=n?ng.f.User:o?ng.f.System:ng.f.Copilot;return function(e,t,n,r,o,i,a,s,l){var c={content:e,entry:t,userRole:n,format:r,timestamp:Date.now(),messageId:Object(ag.a)(),status:o,richTextJson:i,messageMetadata:a,userId:s,rephrasedMessage:l};n==ng.f.User&&(Lh.Instance.CurrentUserMessageId=c.messageId);return c}(t,ng.a.Pane,c,ng.b.RichText,o?ng.e.Failure:ng.e.Success,l,i)}function Yh(e,t){var n,o,i,a,s,l,c,u,d="";switch(t){case P.Default:d=function(e){var t,n,o,i,a="";(null==e?void 0:e.messageHeader)&&(a=a+Zh(e.messageHeader)+"\n");if(null==e?void 0:e.embeddedLists)try{for(var s=Object(r.__values)(e.embeddedLists),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.listHeader&&(a=a+c.listHeader+"\n"),c.listItems)try{for(var u=(o=void 0,Object(r.__values)(c.listItems)),d=u.next();!d.done;d=u.next()){var p=d.value;a+=p.title?"".concat(p.title,": ").concat(p.text+"\n"):"".concat(p.text+"\n")}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}c.listFooter&&(a=a+Zh(c.listFooter)+"\n")}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}(null==e?void 0:e.messageFooter)&&(a+=Zh(e.messageFooter));return a}(e.defaultMessageProps);break;case P.MarkdownCard:d=null!==(o=null===(n=e.markDownCardProps)||void 0===n?void 0:n.message)&&void 0!==o?o:"";break;case P.WarningMessage:d=(null===(i=e.warningMessageCardProps)||void 0===i?void 0:i.warningPrefix)+(null!==(s=null===(a=e.warningMessageCardProps)||void 0===a?void 0:a.warningEmphasizedText)&&void 0!==s?s:"")+(null!==(c=null===(l=e.warningMessageCardProps)||void 0===l?void 0:l.warningSuffix)&&void 0!==c?c:"");break;case P.ChatCardWrapper:d=null!==(u=e.chatCardWrapperProps.textContent)&&void 0!==u?u:"";break;case P.StreamingAdaptiveCard:d=function(e){if(!e)return"";var t=e.basin,n=e.uniqueId,r=e.accessPath;if((null==t?void 0:t.items)&&n&&r){var o=ta()(e.basin.items[e.uniqueId],e.accessPath);return(null==o?void 0:o.body)?o.body.map((function(e){return e.text})).join("\n"):""}}(e.streamingAdaptiveCardProps);case P.ContentCard:case P.AccordionCard:case P.ProactiveSuggestionCard:case P.SelfHelpAdaptiveCard:}return d}function Zh(e){var t,n="";return(null==e?void 0:e.text)&&(n+=e.text),(null==e?void 0:e.linkText)&&(n=null!==(t=n+e.linkText.text+e.linkText.linkSuffix)&&void 0!==t?t:""),n}var Jh,Xh,$h,ef,tf,nf=function(){function e(e,t){var n=this;this.chatHistoryResponseTimerID=null,this.workflowAnnotationType=R.c.getTypeName(),this.chatHistoryResponseTimeout=_g,this.hasExistingChat=!0,this.telemetryLoggerUtils=yg.getInstance(),this.chatHistoryResponseTimeoutInternal=function(){n.chatHistoryResponseTimerID=null,nb("Chat History Augloop Response Timed Out for workflow",n.workflowAnnotationType),Of.getInstance().clearOperationListForResubmit(),n.setIsChatHistoryLoading(!1),n.hasExistingChat&&n.setIsChatHistoryTimedOut(!0),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatHistoryTimeout},{key:D.ChatEventParameters,value:(new Date).getTime().toString()},{key:D.ChatErrorType,value:U.Server}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:L.ErrorMessage,value:Vg},{key:L.ErrorType,value:U.Server},{key:L.ErrorCode,value:gh.ChatHistoryResponseTimeout},{key:L.ErrorCategory,value:A.ChatEvents}]),n.hasExistingChat=!0},this.setIsChatHistoryLoading=e,this.setIsChatHistoryTimedOut=t,this.workflowAnnotationType=this.getChatHistoryWorkflowType(),this.chatHistoryResponseTimeout=this.getChatHistoryResponseTimeout()}return e.getInstance=function(t,n){if(!e.sInstance){if(wg(t))throw new Error("setIsChatSessionIdSet is null or undefined");e.sInstance=new e(t,n)}return e.sInstance},e.prototype.setAugloopResponseTimer=function(){nb("Setting chat history augloop response Timer"),this.clearAugloopResponseTimer(!1),this.setIsChatHistoryLoading(!0),this.setIsChatHistoryTimedOut(!1),this.chatHistoryResponseTimerID=window.setTimeout(this.chatHistoryResponseTimeoutInternal,this.chatHistoryResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(e){void 0===e&&(e=!0),null!==this.chatHistoryResponseTimerID&&(nb("Clear chat history augloop response Timer"),clearTimeout(this.chatHistoryResponseTimerID),this.chatHistoryResponseTimerID=null,e&&this.setIsChatHistoryLoading(!1))},Object.defineProperty(e.prototype,"isAugloopResponseTimerSet",{get:function(){return null!==this.chatHistoryResponseTimerID},enumerable:!1,configurable:!0}),e.prototype.setHasExistingChat=function(e){this.hasExistingChat=e},e.prototype.getChatHistoryWorkflowType=function(){return wh.getInstance().isWorkflowRegistered(R.c.getTypeName())?R.c.getTypeName():wh.getInstance().isWorkflowRegistered(R.a.getTypeName())?R.a.getTypeName():R.b.getTypeName()},e.prototype.getChatHistoryResponseTimeout=function(){var e;return null!==(e=wh.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType))&&void 0!==e?e:_g},e}(),rf=[],of=null,af=null,sf=null,lf=!0,cf=!1,uf=function(e,t,n,o){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,c,u,d,p;return Object(r.__generator)(this,(function(r){switch(i={},a=new Rh.a,s=Date.now(),l=yg.getInstance(),c=function(){if(_h){var e=Ah===Fu.Work?ng.d.Enterprise:ng.d.Document;return nb("Orchestrator grounding mode used for Chat:",e),e}}(),e){case ng.c.AddChatOperation:"dummyUserId","dummyDocId",u={userId:"dummyUserId",documentId:"dummyDocId",sessionId:Object(ag.a)(),messages:[]},i={newChat:u,type:ng.c.AddChatOperation},a=new Rh.a({operation:i,documentURLOrLocalPath:n,timestamp:s,documentSensitivity:$h,orchestratorGroundingMode:c,isFluxChatHistoryAnnotationActivated:cf});break;case ng.c.GetAllChatsOperation:i={type:ng.c.GetAllChatsOperation},a=new Rh.a({operation:i,documentURLOrLocalPath:n,timestamp:s,documentSensitivity:$h,orchestratorGroundingMode:c,isFluxChatHistoryAnnotationActivated:cf});break;case ng.c.GetCurrentChatOperation:d={pageSize:10},i={type:ng.c.GetCurrentChatOperation,paging:o&&o.isFeatureGateEnabledFromClient(uh.IsChatHistoryPaginationEnabled)?d:void 0},a=new Rh.a({operation:i,documentURLOrLocalPath:n,timestamp:s,documentSensitivity:$h,orchestratorGroundingMode:c,isFluxChatHistoryAnnotationActivated:cf});break;case ng.c.GetMessagesOperation:d={pageSize:10,syncState:sf},i={type:ng.c.GetMessagesOperation,chatSessionId:of,paging:d},a=new Rh.a({operation:i,documentURLOrLocalPath:n,timestamp:s,documentSensitivity:$h,orchestratorGroundingMode:c,isFluxChatHistoryAnnotationActivated:cf});break;case ng.c.AddMessageOperation:rf.push(t.messageId),i={newMessage:t,type:ng.c.AddMessageOperation,chatSessionId:of},a=new Rh.a({operation:i,documentURLOrLocalPath:n,timestamp:s,documentSensitivity:$h,orchestratorGroundingMode:c,isFluxChatHistoryAnnotationActivated:cf})}return p=new kh.b({parentPath:["Signal",Rh.a.getTypeName()],items:[{id:jh.a.generateId(),body:a}]}),hg.getInstance().sendLoggingEventToClient($p.ChatHistorySignalSent,{timestamp:(new Date).getTime(),signalName:Rh.a.getTypeName(),operationType:e}),l.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatHistorySignalSent},{key:D.ChatEventParameters,value:"".concat(Rh.a.getTypeName(),"_").concat(e)}]),nb("Submitting signal to Augloop : ".concat(Rh.a.getTypeName()," with operation type: ").concat(e," and signal: ").concat(JSON.stringify(a))),(null==t?void 0:t.content)&&nb("sending message: ".concat(t.content)),Of.getInstance().submitOperation(p,Rh.a.getTypeName()),Jh=(new Date).getTime(),e===ng.c.GetCurrentChatOperation&&nf.getInstance().setAugloopResponseTimer(),[2]}))}))},df=function(e,t,n,o,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T;return Object(r.__generator)(this,(function(k){switch(k.label){case 0:switch(s=null===(O=null===(C=e.body)||void 0===C?void 0:C.H_)||void 0===O?void 0:O.T_,nb("".concat(Rh.a.getTypeName()," response. Time Taken : ").concat(Yv(Jh)," sec \n")),l=null==e?void 0:e.body,c=null==l?void 0:l.operationResponse,u=yg.getInstance(),hg.getInstance().sendLoggingEventToClient($p.ChatHistoryResponseReceived,{timeInMs:Zv(Jh),annotationName:s,operationType:c.type}),u.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ResponseReceivedFromAL},{key:D.ChatEventParameters,value:"".concat(s,"_").concat(c.type)}]),d={operationType:ng.c.GetChatOperation,augloopResponseTime:-1},p=Yv(Jh),c.type){case ng.c.GetCurrentChatOperation:return[3,1];case ng.c.GetMessagesOperation:return[3,5];case ng.c.GetAllChatsOperation:return[3,6];case ng.c.GetChatOperation:return[3,7];case ng.c.GetMessagesInCurrentChatSession:return[3,8];case ng.c.AddChatOperation:return[3,9];case ng.c.AddMessageOperation:return[3,10]}return[3,11];case 1:return g=c,d={operationType:ng.c.GetCurrentChatOperation,augloopResponseTime:p},sf=null===(S=g.paging)||void 0===S?void 0:S.syncState,g.chat?[3,3]:(nf.getInstance().setHasExistingChat(!1),[4,uf(ng.c.AddChatOperation)]);case 2:return k.sent(),[3,4];case 3:of=null===(E=g.chat)||void 0===E?void 0:E.sessionId,af=of,nb("chatSessionId from GetCurrentChatOperation: "+of),u.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatHistorySessionLoaded},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),0===n&&g.chat&&nf.getInstance().isAugloopResponseTimerSet&&Gh(o,g.chat.messages,t),u.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.GetCurrentChatStatus},{key:D.ChatEventParameters,value:c.status}]),c.status!==ng.e.Success&&nf.getInstance().isAugloopResponseTimerSet&&(o.sendEventToClient(Xp.ChatHistoryHydrationFailed),u.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatHistoryHydrationFailed}])),nf.getInstance().clearAugloopResponseTimer(),k.label=4;case 4:return null==a||a(null!==(I=null===(x=g.chat)||void 0===x?void 0:x.plugins)&&void 0!==I?I:[]),[3,11];case 5:if(sf=null===(w=(g=c).paging)||void 0===w?void 0:w.syncState,(null===(T=g.messages)||void 0===T?void 0:T.length)>0){h=[];try{for(f=Object(r.__values)(g.messages),m=f.next();!m.done;m=f.next())v=m.value,o.isFeatureGateEnabledFromClient(uh.DisableChatHistoryPaginationFix)||rf.includes(v.messageId)||(h.push(v),rf.push(v.messageId))}catch(e){b={error:e}}finally{try{m&&!m.done&&(y=f.return)&&y.call(f)}finally{if(b)throw b.error}}(null==h?void 0:h.length)>0&&(lf=!0,t((function(e){var t=Wh(h);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(e),!1)})))}else g.status!==ng.e.Failure&&(lf=!1);return u.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.GetMessagesStatus},{key:D.ChatEventParameters,value:g.status}]),[3,11];case 6:case 7:case 8:return[3,11];case 9:return d={operationType:ng.c.AddChatOperation,augloopResponseTime:p},c.status===ng.e.Success&&(of=c.chats[0].sessionId,af=of,nb("chatSessionId from AddChatOperation: "+of)),nf.getInstance().clearAugloopResponseTimer(),i&&i(),[3,11];case 10:return d={operationType:ng.c.AddMessageOperation,augloopResponseTime:p},c.status,ng.e.Success,[3,11];case 11:return-1!==d.augloopResponseTime&&(yg.getInstance().addChatHistoryInfoLog(d),yg.getInstance().sendTelemetryLatencyData([])),[2]}}))}))},pf=n(1140),gf=n(1541),hf=n(1542),ff=function(e,t,n){var r,o,i=Object(ag.a)(),a=pf.a.POST;e===pf.b.Suggestion?(r=vf(i),o=yf()):(r=bf(t,n),o=Cf(i));var s={request:r,headers:o,httpMethod:a,type:e,queryId:i,scenario:Ph.getSubstrateScenarioName()},l=new kh.a({parentPath:["Signal",gf.a.getTypeName()],items:[{id:jh.a.generateId(),body:new gf.a(s)}]});return ef=(new Date).getTime(),l},mf=function(e,t){var n;nb("substrateAPIResponseAnnotationProcessor",e),nb("".concat(Sh.a.getTypeName()," response received\n Time Taken: ").concat(Yv(ef),"s "));var r=e.body,o=r.queryId,i=r.status,a=r.results,s=r.error,l=r.httpStatus,c=r.type;if(o&&nb("substrateAPIResponseAnnotationProcessor: queryID: ",o),l&&nb("substrateAPIResponseAnnotationProcessor: httpStatus: ",l),a&&nb("substrateAPIResponseAnnotationProcessor: results: ",a),i!==hf.a.Failed){if(i===hf.a.Success&&c===pf.b.Suggestion&&a)try{var u=JSON.parse(null!=a?a:""),d=null==u?void 0:u.Groups,p=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.Suggestions;(null==p?void 0:p.length)>0&&t(p)}catch(e){return void nb("substrateAPIResponseAnnotationProcessor: failed to parse results")}}else s&&nb("substrateAPIResponseAnnotationProcessor: error: ",s)},vf=function(e){var t={EntityRequests:[{EntityType:"Prompt",Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:Ph.getAppName()}}]}]},Size:25}],TimeZone:"UTC",Cvid:e,Scenario:{Name:Ph.getSubstrateScenarioName(),Dimensions:[{DimensionName:"UserExperience",DimensionValue:"PromptLibrary"}]}};return JSON.stringify(t)},bf=function(e,t){void 0===t&&(t=!1);var n={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:t,ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(n)},yf=function(){return[{key:oh.XClientLanguage,value:Ph.getLanguage()},{key:oh.XClientFlights,value:"EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion"}]},Cf=function(e){return[{key:oh.ClientRequestId,value:e}]},Of=function(){function e(e,t){this.isSessionConnected=!0,this.isSessionClosed=!1,this.operationListForResubmit=new Map,this.callbackTokens=[],this.annotationTokens=[],this.copilotCommunicationHandler=e,this.alSession=t,this.isSessionClosed=this.alSession.isClosed,this.isSessionConnected=this.alSession.isConnected,this.loggingEventHandler=hg.getInstance(e),this.telemetryLoggerUtils=yg.getInstance()}return e.getInstance=function(t,n){return void 0===this.sInstance?(this.sInstance=new e(t,n),this.sInstance.registerCallbacks()):void 0!==n&&this.sInstance.alSession!==n&&(this.sInstance.releaseActiveAnnotations(),this.sInstance.removeCallbacks(),this.sInstance.alSession=n,this.sInstance.isSessionClosed=n.isClosed,this.sInstance.isSessionConnected=n.isConnected,this.sInstance.registerCallbacks()),this.sInstance},e.prototype.removeCallbacks=function(){var e=this;this.callbackTokens.forEach((function(t){e.alSession.removeSessionStateCallback(t)})),this.callbackTokens=[]},e.prototype.releaseActiveAnnotations=function(){var e=this;this.isSessionClosed||this.annotationTokens.forEach((function(t){e.alSession.releaseAnnotation(t).then((function(e){nb("Annotation deactivated: "+e)})).catch((function(e){nb("error in deactivating: ",e)}))})),this.annotationTokens=[]},e.prototype.registerCallbacks=function(){this.registerOnConnectCallback(),this.registerOnDisconnectCallback(),this.registerOnReconnectCallback(),this.registerOnCloseCallback()},e.prototype.registerOnConnectCallback=function(){var e=this,t=this.alSession.setConnectCallback((function(t,n,r,o){var i=n.substring(n.lastIndexOf("/")+1);nb("AL Session onSessionConnect, isSeedingRequired: ".concat(t,", sessionKey: ").concat(i)),e.isSessionConnected=!0,t&&e.operationListForResubmit.forEach((function(t,n){e.submitOperation(n,t),wh.getInstance().isAugloopResponseTimeoutRequired(t)&&Bh.getInstance().setAugloopResponseTimer(t)})),e.loggingEventHandler.sendLoggingEventToClient($p.ALSessionConnected,{chatEventParams:t.toString()}),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALSessionConnected},{key:D.ChatEventParameters,value:"isSeedingRequired: "+t.toString()},{key:D.ALSessionKey,value:i}]),e.operationListForResubmit.clear()}));this.callbackTokens.push(t)},e.prototype.registerOnDisconnectCallback=function(){var e=this,t=this.alSession.setDisconnectCallback((function(t){nb("AL Session Disconnected",t),e.isSessionConnected=!1,e.loggingEventHandler.sendLoggingEventToClient($p.ALSessionDisconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALSessionDisconnected},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}])}));this.callbackTokens.push(t)},e.prototype.registerOnReconnectCallback=function(){var e=this,t=this.alSession.setReconnectCallback((function(){e.isSessionConnected=!0,e.loggingEventHandler.sendLoggingEventToClient($p.ALSessionReconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALSessionReconnected},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),nb("AL Session Reconnected")}));this.callbackTokens.push(t)},e.prototype.registerOnCloseCallback=function(){var e=this,t=this.alSession.setSessionCloseCallback((function(t){e.isSessionClosed=!0,e.loggingEventHandler.sendLoggingEventToClient($p.ALSessionClosed),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALSessionClosed}]),nb("AL Session Closed",t)}));this.callbackTokens.push(t)},e.prototype.activateAnnotation=function(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a=this;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.alSession.activateAnnotation(e,{callback:t,config:n,forceReturnCachedAnnotations:i}).then((function(t){return Object(r.__awaiter)(a,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(i){return nb("Annotation Token: "+t.token),this.annotationTokens.push(t.token),e===R.c.getTypeName()||e===R.b.getTypeName()||e===R.a.getTypeName()||t.token.includes(R.c.getTypeName())||t.token.includes(R.b.getTypeName())||t.token.includes(R.a.getTypeName())?(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.ChatHistoryDuplicateLoggingFix)&&e===R.b.getTypeName()&&(cf=!0),function(e,t){Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CurrentChatHistoryStart},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),Xh=(new Date).getTime(),[4,uf(ng.c.GetCurrentChatOperation,void 0,e,t)];case 1:return n.sent(),[2]}}))}))}(o,this.copilotCommunicationHandler)):(e===og.c.getTypeName()||t.token.includes(og.c.getTypeName()))&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsQnASuggestionPillCachingEnabled)?this.submitOperation(Mh.getInstance().getSuggestedQnaScenarioSignalOperation(),og.c.getTypeName()):e===Sh.a.getTypeName()&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsSharedCopilotLabEnabled)&&this.submitOperation(ff(pf.b.Suggestion),Sh.a.getTypeName()),n={workflowAnnotationType:e,responseToken:t.token},this.copilotCommunicationHandler.sendEventToClient(Xp.AnnotationActivated,n),[2]}))}))})).catch((function(e){nb("error in activating: ",e)}))];case 1:return s.sent(),[2]}}))}))},e.prototype.submitOperation=function(e,t){var n,r;!1!==this.isSessionConnected&&!0!==this.isSessionClosed||(nb("Session is not connected"),this.operationListForResubmit.set(e,t)),this.alSession.submitOperation(e);var o=e.items.length>0?null===(r=null===(n=e.items[0])||void 0===n?void 0:n.body)||void 0===r?void 0:r.H_.T_:"";this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.QuerySubmittedToAL},{key:D.ChatEventParameters,value:o}])},e.prototype.clearOperationListForResubmit=function(){this.operationListForResubmit.clear()},e}(),Sf=null,Ef=null,xf={},If=function(){function e(){}return e.getInstance=function(){return e.telemetryEventHandler||(e.telemetryEventHandler=new e),e.telemetryEventHandler},e.prototype.initTelemetryLatencyObject=function(){Sf=ob()},e.prototype.initTelemetryChatEventObject=function(){Ef=lb()},e.prototype.updateTelemetryLatencyData=function(e,t){null!=Sf&&(Object.keys(e).forEach((function(t){Sf[t]=e[t],xf[t]=e[t]})),t&&this.sendTelemetryLatencyData(t))},e.prototype.updateTelemetryChatEventData=function(e,t){null===Ef&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(t){Ef[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)},e.prototype.updateTelemetryQueryDetailsEventData=function(e){Object.keys(e).forEach((function(t){xf[t]=e[t]}))},e.prototype.sendTelemetryLatencyData=function(e){null!=e&&(e.logEvent(ib(Sf)),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e))},e.prototype.sendTelemetryQueryDetailsObject=function(e){null==e||e.logEvent(sb(xf)),xf={}},e.prototype.sendTelemetryChatEventData=function(e){if(null!=e){if(e.logEvent(ab(Ef)),Ef[D.ChatEventType]){var t=Object.keys(M)[Object.values(M).indexOf(Ef[D.ChatEventType])];xf[t]=0===Ef[D.ChatEventParameters].length?"true":Ef[D.ChatEventParameters]}this.initTelemetryChatEventObject()}},e}(),wf=n(1086),Tf="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",kf=function(){function e(){this.oTelLogger=new wf.a,this.setupTelemetryLogger(this.oTelLogger),this.telemetryEventHandler=If.getInstance()}return e.getInstance=function(){return e.telemetryLogger||(e.telemetryLogger=new e),e.telemetryLogger},e.prototype.getDefaultEventFlags=function(){return{}},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logError=function(e,t){var n;this.logTelemetryErrorEvent(e,t),this.telemetryEventHandler.updateTelemetryQueryDetailsEventData(((n={})[W.ErrorCategory]=e.eventType,n[W.ErrorMessage]=e.errorMessage,n))},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:{ariaTenantToken:Tf,nexusTenantToken:1763},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Object(r.__assign)(Object(r.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)},e.prototype.logTelemetryErrorEvent=function(e,t){var n={eventName:"Office.Voice.ActionAI."+A.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Object(r.__assign)(Object(r.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:"CopilotChatSessionId",value:Ph.getSessionId()}])};this.oTelLogger.sendError(n)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?mg.b(e.key,e.value):"string"==typeof e.value?mg.d(e.key,e.value):"boolean"==typeof e.value?mg.a(e.key,e.value):mg.d(e.key,e.value)}),[])},e.prototype.setupTelemetryLogger=function(e){e.setTenantToken("Office.Voice.ActionAI",Tf,1763)},e}(),jf=Object(r.__assign)(Object(r.__assign)({},v.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),Pf=(Object(r.__assign)(Object(r.__assign)({},b.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(vc.a)({10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"})),Af=n(484),_f=Bg,Df=function(e){_f=e},Lf="libbie-loader",Mf="https://admin.microsoft.com",Bf="https://admin-ignite.microsoft.com",Rf=null,Ff=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Rf.updateSelectedFacets(e?{displayCategory:[e]}:void 0),[4,Object(Af.b)({centroEnvironmentBaseUrl:Ph.isDevbuild()?Bf:Mf,preConfig:{hostName:"SharedCopilot",locale:"en",perfPrefix:"SharedCopilot_"},enableUxVersionQueryParam:!0})];case 1:return r.sent(),t=function(e){e("centro.hvc.libbieloader",Rf)},[4,Object(Af.c)({featureName:Lf,adapters:{dataSources:t},localMode:!!window.localStorage.getItem("centro.hvc-loader.localMode")})];case 2:return r.sent(),[4,Object(Af.a)({featureName:Lf})];case 3:return n=r.sent(),o=document.createElement("div"),[4,n.main(o)];case 4:return r.sent(),[2]}}))}))},Nf=function(e,t,n,o,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(){return{sections:p.menuProps.sections.map((function(e){return{sectionHeader:e.sectionHeader,showSectionTopDivider:e.showSectionTopDivider,starterPrompts:e.starterPrompts.map((function(e){return{text:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover}}))}})),handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem}},this.handleOnClickMenuItem=function(e){return Object(r.__awaiter)(p,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e,n=Bg,Df(Bg),this.loggingEventHandler.sendLoggingEventToClient($p.MenuButtonItemClicked,{suggestionClicked:e}),this.isFreVisible&&this.setFreVisible(!1),e.endsWith(Fg)?[4,this.setChatInputStateExpanded()]:[3,2];case 1:r.sent(),t=t.slice(0,-Fg.length)+" ",r.label=2;case 2:return(null==(o=this.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:o.inputAreaText)&&(t=o.inputAreaText),this.immediateActionableQueries[e]?(null===(i=this.chatInputRef.current)||void 0===i||i.setInputText(Bg),null===(a=this.chatInputRef.current)||void 0===a||a.setGhostText(this.chatPlaceholderMessage),this.handleSubmit({text:t,telemetryData:M.MenuItemClicked}),[3,8]):[3,3];case 3:return(null==o?void 0:o.copilotPromptLab)&&(null==o?void 0:o.copilotPromptLab.shouldOpenCopilotPromptLab)?this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsSharedCopilotLabEnabled)?[4,Ff()]:[3,5]:[3,7];case 4:return r.sent(),[3,6];case 5:null==o||o.copilotPromptLab.launchCopilotPromptLab(),r.label=6;case 6:return[3,8];case 7:e===this.transformFileSuggestionText&&this.chatEditor&&(n=this.transformFilePlaceholderText),this.updateHintCard(e),null===(s=this.chatInputRef.current)||void 0===s||s.setInputText(t),null===(l=this.chatInputRef.current)||void 0===l||l.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText(El,uu.InsertAtCursor)}),1),null===(c=this.chatInputRef.current)||void 0===c||c.setGhostText(n),r.label=8;case 8:return nb("Suggestion clicked: "+e),[2]}}))}))},this.generateQueryMap=function(){var e={};p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e[t.suggestionText]=t.shouldSubmitQueryOnClick}))})),p.immediateActionableQueries=e},this.generatePromptSuggestionList=function(){var e=[];p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e.push(t)}))})),p.promptSuggestionList=e},this.getTransformFileSuggestionText=function(){var e,t,n,o;try{for(var i=Object(r.__values)(p.menuProps.sections),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(n=void 0,Object(r.__values)(s.starterPrompts)),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.shouldLaunchCIQOnSelection)return u.suggestionText}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return Bg},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=o,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=s,this.chatPlaceholderMessage=u,this.generateQueryMap(),this.generatePromptSuggestionList(),this.updateHintCard=d,this.isFreVisible=i,this.setFreVisible=a,this.loggingEventHandler=hg.getInstance(),this.copilotCommunicationHandler=l,this.setChatInputStateExpanded=c};!function(e){e.Backspace="Backspace",e.Escape="Escape",e.Delete="Delete",e.V="V"}(tf||(tf={}));var Hf=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){var m=this;this.handleOnInput=function(e){var t;return m.isFreVisible&&m.setFreVisible(!1),(null===(t=m.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Bg&&(m.updateHintCard(Bg),Df(Bg),m.loggingEventHandler.sendLoggingEventToClient($p.InputAreaTextChangedToEmpty)),!0},this.getProps=function(e){var t={isDisabled:m.isDisabled,placeholderText:m.chatPlaceHolderMessage,isMenuButtonEnabled:!0,maxInputCharLimit:Lg,handleSubmitButtonClick:function(e){var t;m.loggingEventHandler.sendLoggingEventToClient($p.SubmitButtonClicked);var n=m.chatInputRef.current?null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement()):void 0;m.handleSubmit({text:e,links:n,telemetryData:M.SubmitButtonClicked})},handleKeyDown:function(e){var t,n=m.chatInputRef.current;if(!n)return!1;var r=n.getInputText(),o=n.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===tf.V)n.setGhostText(Bg);else{if("Enter"===e.key){if(e.preventDefault(),r.trimStart()===Bg)return!1;var i=null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement());return n.setInputText(Bg),n.setGhostText(m.chatPlaceHolderMessage),m.handleSubmit({text:r,links:i}),!1}e.key===tf.Backspace?m.chatEditor&&r.length>1&&ub()&&cb()===r.length&&r.slice(-1)===El?(m.updateHintCard(m.menuBuilder.getTransformFileSuggestionText()),n.setGhostText(El+m.ciqPlaceholderText)):0!==cb()&&o!==Bg&&n.setGhostText(Bg):(e.key===tf.Escape||e.key===tf.Delete&&cb()!==r.length&&o!==Bg)&&n.setGhostText(Bg)}return!0},handleOnChatInputControlMount:function(){m.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){m.setChatInputControlMounted(!1)},menuProps:m.menuBuilder.getMenuProps(),handleOnInput:m.handleOnInput,microphoneProps:m.microphoneButtonProps,handleOnBlur:e};return t},this.chatInputRef=e,this.isDisabled=t,this.handleSubmit=i,this.isFreVisible=n,this.setFreVisible=r,this.updateHintCard=a,this.chatPlaceHolderMessage=h,this.transformFilePlaceholderText=c,this.ciqPlaceholderText=u,this.updateHintCard=a,this.ciqResponseHandler=p,this.copilotCommunicationHandler=g,this.menuBuilder=new Nf(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a),this.chatEditor=s,this.setChatInputControlMounted=d,this.microphoneButtonProps=f,this.loggingEventHandler=hg.getInstance()},Uf=function(e,t,n,o,i,a,s,l,c,d,p){var g=this;this.getMenuProps=function(e){var t={promptGuideMenuData:g.menuProps.promptGuideMenuData,copilotLabProps:g.menuProps.copilotLabProps,handleOnClickStarterPromptMenuItem:g.handleOnClickMenuItem,handleOnClickPromptGuideMenuButtonTelemetry:g.handleOnClickMenuButtonTelemetry,shouldBlockPromptGuideLaunch:g.shouldBlockPromptGuideLaunch};return g.copilotCommunicationHandler.isFeatureGateEnabledFromClient(uh.IsSharedCopilotLabEnabled)&&(!g.menuProps.copilotLabProps&&e.length>0&&(g.menuProps.copilotLabProps={copilotLabMenuItemText:qg(),iconRegular:u.i,iconHover:u.h}),g.menuProps.copilotLabProps&&(g.menuProps.copilotLabProps.handleOnClickCopilotLab=function(e){return Object(r.__awaiter)(g,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ff(e)];case 1:return t.sent(),[2]}}))}))})),t},this.shouldBlockPromptGuideLaunch=function(){return g.setPaneLoadMessageIfApplicable(mh.PromptGuide)},this.handleOnClickMenuButtonTelemetry=function(){g.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MenuButtonClicked}])},this.handleOnClickMenuItem=function(e,t,n){var r,o,i,a,s,l=e,c=Bg;if(!t)return g.loggingEventHandler.sendLoggingEventToClient($p.MenuButtonItemClickedL1,{suggestionClicked:e}),void g.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MenuL1SuggestionClicked},{key:D.ChatEventParameters,value:e}]);Df(Bg),g.loggingEventHandler.sendLoggingEventToClient($p.MenuButtonItemClicked,{suggestionClicked:e}),g.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MenuL2SuggestionClicked}]),g.isFreVisible&&g.setFreVisible(!1),e.endsWith(Fg)&&(l=l.slice(0,-Fg.length)+" "),g.immediateActionableQueries[e]?(null===(r=g.chatInputRef.current)||void 0===r||r.setInputText(Bg),null===(o=g.chatInputRef.current)||void 0===o||o.setGhostText(g.chatPlaceholderMessage),g.handleSubmit({text:l})):(g.updateHintCard(e),n&&(l=l.replace(/ *\([^)]*\)/,Rg),c=g.transformFilePlaceholderText),l=l.replace(/ *\[[^\]]*]/,Bg),n||(l+=" "),n&&g.chatEditor&&g.chatEditor.setCurrentScope(n),null===(i=g.chatInputRef.current)||void 0===i||i.setInputText(l),null===(a=g.chatInputRef.current)||void 0===a||a.setFocus(),n&&g.chatEditor&&setTimeout((function(){var e;return null===(e=g.chatInputRef.current)||void 0===e?void 0:e.updateInputText(El,uu.InsertAtCursor)}),1),null===(s=g.chatInputRef.current)||void 0===s||s.setGhostText(c)),nb("Suggestion clicked: "+e)},this.generateQueryMap=function(){var e,t={};null===(e=g.menuProps.promptGuideMenuData.children)||void 0===e||e.forEach((function(e){var n;null===(n=e.children)||void 0===n||n.forEach((function(e){var n;"ActionSet"===e.nodeType&&(t[e.text]=null===(n=e.data)||void 0===n?void 0:n.shouldSubmitQueryOnClick)}))})),g.immediateActionableQueries=t},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=o,this.chatPlaceholderMessage=c,this.generateQueryMap(),this.updateHintCard=d,this.isFreVisible=i,this.setFreVisible=a,this.transformFilePlaceholderText=l,this.copilotCommunicationHandler=s,this.loggingEventHandler=hg.getInstance(),this.telemetryLoggerUtils=yg.getInstance(),this.setPaneLoadMessageIfApplicable=p},Vf=function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.getOrLoadPlugins()];case 1:return(o=r.sent())?o.length?(i=function(e){var t=o.filter((function(t){return t.id===function(e){switch(e){case Fu.Work:return vh.ENTERPRISE_SEARCH;case Fu.Web:return vh.WEB_SEARCH}return""}(e.id)})),n=t.length?t[0]:void 0;return n?"blocked"===n.state?Pc.Blocked:n.isEnabled?Pc.Enabled:Pc.Disabled:Pc.Disabled},a=[],[4,t.getChatHistoryEnabledPlugins()]):[3,3]:[2,[]];case 2:return s=r.sent(),e.map((function(e){var t=Pc.Disabled;(t=e.id===Fu.Work?n||s.has(vh.ENTERPRISE_SEARCH)?Pc.Enabled:Pc.Disabled:i(e))===Pc.Blocked?(a.push(e.id),zf("".concat(e.id,":AdminBlocked"))):(e.onToggle(t===Pc.Enabled),zf("".concat(e.id,":").concat(t===Pc.Enabled?"AutoOn":"AutoOff")))})),[2,a];case 3:return[2,[]]}}))}))},zf=function(e){yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.GroundingSourceUpdated},{key:D.ChatEventParameters,value:e}])},Gf=function(e,t,n,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k){var j=this;this.copilotPluginFlyoutProps=I,this.handleOnInput=function(e){var t;return j.isFreVisible&&j.setFreVisible(!1),(null===(t=j.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Bg&&(j.updateHintCard(Bg),Df(Bg),j.loggingEventHandler.sendLoggingEventToClient($p.InputAreaTextChangedToEmpty)),!0},this.getGroundingSourcePickerProps=function(){if(j.groundingSourcePickerProps)return Object(r.__assign)(Object(r.__assign)({},j.groundingSourcePickerProps),{onSelection:function(e){zf(e.id),j.groundingSourcePickerProps.onSelection&&j.groundingSourcePickerProps.onSelection(e)}})},this.getPluginInfoProps=function(){if(j.pluginsInfo)return j.pluginsInfo.map((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{onToggle:function(t){zf("".concat(e.id,":").concat(t?"On":"Off")),e.onToggle&&e.onToggle(t)}})}))},this.getProps=function(e){var t,n;j.editorProps&&void 0===(null===(t=j.editorProps.editorConfig)||void 0===t?void 0:t.ciqPlaceholderText)&&(j.editorProps.editorConfig.ciqPlaceholderText=j.ciqPlaceholderText);var r={isDisabled:j.isExecuting,isSubmitButtonDisabled:j.isSubmitButtonDisabled,copilotChatTheme:j.copilotTheme,isDarkMode:j.isDarkModeEnabled,dir:j.dir,placeholderText:j.chatPlaceHolderMessage,isMenuButtonEnabled:!0,isCIQButtonEnabled:j.isCIQButtonEnabled,isGroundingButtonEnabled:j.isGroundingButtonEnabled,isVersion3Enabled:j.isVersion3Enabled,maxInputCharLimit:Mg,handleSubmitButtonClick:function(e,t){var n,r,o,i=t;j.loggingEventHandler.sendLoggingEventToClient($p.SubmitButtonClicked);var a=j.chatInputRef.current?null===(n=j.ciqResponseHandler)||void 0===n?void 0:n.generatCopilotOdslSignalLinks(j.chatInputRef.current.getInputSpanElement()):void 0;(null===(r=j.editorProps)||void 0===r?void 0:r.handleInChatInput)||(i=j.chatInputRef.current?null===(o=j.ciqResponseHandler)||void 0===o?void 0:o.generateQueryAnnotations(j.chatInputRef.current.getInputSpanElement()):void 0),j.handleSubmit({text:e,links:a,telemetryData:M.SubmitButtonClicked,queryAnnotations:i})},handleKeyDown:function(e){var t,n,r=j.chatInputRef.current;if(!r)return!1;var o=null==r?void 0:r.getInputText(),i=null==r?void 0:r.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===tf.V)null==r||r.setGhostText(Bg);else{if("Enter"===e.key){if(e.preventDefault(),j.shouldBlockSubmitButtonClick())return;if(j.isSubmitButtonDisabled||j.isExecuting)return!1;if(e.shiftKey)return!0;if(o.trimStart()===Bg)return!1;var a=null===(t=j.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(j.chatInputRef.current.getInputSpanElement()),s=j.chatInputRef.current?null===(n=j.ciqResponseHandler)||void 0===n?void 0:n.generateQueryAnnotations(j.chatInputRef.current.getInputSpanElement()):void 0;return null==r||r.setInputText(Bg),null==r||r.setGhostText(j.chatPlaceHolderMessage),j.handleSubmit({text:o,links:a,queryAnnotations:s}),!1}e.key===tf.Backspace?j.chatEditor&&o.length>1&&ub()&&cb()===o.length&&o.slice(-1)===El?null==r||r.setGhostText(El+j.ciqPlaceholderText):0!==cb()&&i!==Bg&&(null==r||r.setGhostText(Bg)):(e.key===tf.Escape||e.key===tf.Delete&&cb()!==o.length&&i!==Bg)&&(null==r||r.setGhostText(Bg))}return!0},handleOnBeforeInput:function(e){var t=j.chatInputRef.current;return!(!t||e.data===El&&j.chatEditor&&(null==t||t.setGhostText(j.ciqPlaceholderText),1))},handleOnChatInputControlMount:function(){j.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){j.setChatInputControlMounted(!1)},promptGuideMenuProps:null===(n=j.menuBuilder)||void 0===n?void 0:n.getMenuProps(e),handleOnInput:j.handleOnInput,voiceInputProps:j.voiceInputProps,groundingSourcePickerProps:j.getGroundingSourcePickerProps(),pluginsInfo:j.getPluginInfoProps(),shouldBlockGroundingButtonClick:j.shouldBlockGroundingButtonClick,shouldBlockSubmitButtonClick:j.shouldBlockSubmitButtonClick,handleFirstUserInput:j.handleFirstUserInput,handleChatInputLoad:j.handleChatInputLoad,copilotPluginFlyoutProps:j.copilotPluginFlyoutProps,editorProps:j.editorProps,isSensitivityIndicatorLoading:j.isSensitivityIndicatorLoading};return r},this.shouldBlockGroundingButtonClick=function(){return j.setPaneLoadMessageIfApplicable(mh.GroundingButton)},this.shouldBlockSubmitButtonClick=function(){return j.setPaneLoadMessageIfApplicable(mh.SubmitButton)},this.handleFirstUserInput=function(){yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.FirstUserInputReceived},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}])},this.handleChatInputLoad=function(){yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatInputLoaded},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}])},this.chatInputRef=e,this.copilotTheme=t,this.isDarkModeEnabled=n,this.dir=o,this.isExecuting=i,this.isSubmitButtonDisabled=a,this.handleSubmit=d,this.isFreVisible=s,this.setFreVisible=l,this.copilotCommunicationHandler=c,this.updateHintCard=p,this.chatPlaceHolderMessage=b,this.ciqPlaceholderText=f,this.ciqResponseHandler=v,this.loggingEventHandler=hg.getInstance(),this.setPaneLoadMessageIfApplicable=x,this.menuBuilder=u?new Uf(u,e,d,g,s,l,this.copilotCommunicationHandler,h,this.chatPlaceHolderMessage,p,this.setPaneLoadMessageIfApplicable):void 0,this.chatEditor=g,this.setChatInputControlMounted=m,this.voiceInputProps=y,this.isCIQButtonEnabled=C,this.isGroundingButtonEnabled=O,this.groundingSourcePickerProps=S,this.pluginsInfo=E,this.editorProps=w,this.isSensitivityIndicatorLoading=T,this.isVersion3Enabled=k},Wf=function(e,t,n,r,o,i,a,s,l,c,u,d){var p=this;this.handleClick=function(){},this.getProps=function(e){return{chatInputRestShyPlaceholder:p.chatPlaceHolderMessage,isDisabled:p.isDisabled,isMenuButtonEnabled:!0,handleMenuButtonClick:p.handleClick,menuProps:p.menuBuilder.getMenuProps(),handleClickAndUnMount:e}},this.isDisabled=t,this.handleSubmit=i,this.chatPlaceHolderMessage=d,this.transformFilePlaceholderText=c,this.copilotCommunicationHandler=u,this.menuBuilder=new Nf(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a)},Qf=function(){function e(){}return e.prototype.getProps=function(e,t){return{headerText:t.headerText,descriptionText:t.descriptionText,freImagePath:t.freImagePath,handleFreButtonClick:function(){e()}}},e}(),qf=function(){function e(e){var t;this.promptSuggestionHintCardMap=null!==(t=null==e?void 0:e.promptSuggestionHintCardMap)&&void 0!==t?t:{}}return e.prototype.shouldShowHintCard=function(e){return!!this.promptSuggestionHintCardMap[e]},e.prototype.getProps=function(e){var t={headerText:Bg,descriptionText:Bg};if(this.promptSuggestionHintCardMap[e]){var n=this.promptSuggestionHintCardMap[e].descriptionTextList;t.headerText=this.promptSuggestionHintCardMap[e].headerText,t.descriptionText=n[Math.floor(Math.random()*n.length)]}return t},e}(),Kf=function(){return[Tg()?OfficeaicopilotStrings.WorkingOnItString:"Working on it...",Tg()?OfficeaicopilotStrings.LoadingUIStringGettingReady:"Getting ready...",Tg()?OfficeaicopilotStrings.LoadingUIStringFinishingUp:"Finishing up...",Tg()?OfficeaicopilotStrings.LoadingUIStringWorkingOnRequest:"Working on your request...",Tg()?OfficeaicopilotStrings.LoadingUIStringGatheringResources:"Gathering resources...",Tg()?OfficeaicopilotStrings.LoadingUIStringCraftingContent:"Crafting your content...",Tg()?OfficeaicopilotStrings.LoadingUIStringGettingEverythingReady:"Getting everything ready...",Tg()?OfficeaicopilotStrings.LoadingUIStringFinishingTouches:"Applying the finishing touches..."]},Yf=function(){function e(){}return e.prototype.getProps=function(e,t){return{loadingUiStrings:e.loadingUiStringList,stringChangeIntervalDuration:e.stringChangeIntervalDuration,showStopButton:e.showStopGeneratingButton,showInlineStopButton:e.showInlineStopGeneratingButton,handleStopButtonOnClick:t}},e}(),Zf=function(){function e(e,t,n,r,o){var i=this;this.executeSuggestionPill=function(e){var t,n;null===(t=i.chatInputRef.current)||void 0===t||t.setInputText(Bg),null===(n=i.chatInputRef.current)||void 0===n||n.setGhostText(i.chatPlaceHolderMessage),e in i.suggestedQnAsList?i.setSuggestionClickChatCardsFromCacheSuggestion(e,i.suggestedQnAsList[e]):i.handleSubmit({text:e,telemetryData:M.SuggestionPaneSuggestionClicked})},this.chatInputRef=e,this.handleSubmit=t,this.chatPlaceHolderMessage=n,this.setChatMessage=r,this.loggingEventHandler=hg.getInstance(),this.suggestedQnAsList={},this.setCachedSuggestionPillList=o,this.telemetryLoggerUtils=yg.getInstance()}return e.prototype.setSuggestedQnAList=function(e){var t=this;this.suggestedQnAsList={},e.forEach((function(e){t.suggestedQnAsList[e.question]=e.answer})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],K,V.ChatQnA,F.QAandSummaries,N.Ask,H.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.getSuggestedQnAsList=function(){return Object.keys(this.suggestedQnAsList)},e.prototype.getSuggestionPillListFromCache=function(){var e=Object.keys(this.suggestedQnAsList);return e=function(e){for(var t,n,o=e.length;0!=o;)n=Math.floor(Math.random()*o),o--,t=Object(r.__read)([e[n],e[o]],2),e[o]=t[0],e[n]=t[1];return e}(e),e.slice(0,2)},e.prototype.setSuggestionClickChatCardsFromCacheSuggestion=function(e,t){var n,r=Object(ag.a)();this.telemetryLoggerUtils.setUserQueryGuid(r),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.SuggestionPaneSuggestionClicked}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.QuerySubmittedByUser}]),this.setChatMessage(P.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),this.setChatMessage(P.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:er.Footer,isFailure:!1,actionButtonList:[Mh.getInstance().getCopyButton()],feedbackData:Mh.getInstance().getFeedbackData(),clpSensitivityIndicatorData:null===(n=Mh.getInstance().getBasicChatProps())||void 0===n?void 0:n.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:r,featureName:V.ChatQnA})}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CachedBasicChatResponseShown},{key:D.IsFromCache,value:!0}]),this.telemetryLoggerUtils.logTriedEvent([],K,V.ChatQnA,F.QAandSummaries,void 0,N.Ask,H.BasicChat),this.telemetryLoggerUtils.setUserQueryGuid(Bg)},e.prototype.getProps=function(e,t){var n=this,o={suggestionList:e.suggestionList.length>0?e.suggestionList:t,showRefreshButton:null==e?void 0:e.showRefreshButton,handleSuggestionPillClick:function(e){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return this.loggingEventHandler.sendLoggingEventToClient($p.SuggestionPillClicked,{suggestionClicked:e}),Df(Bg),this.executeSuggestionPill(e),nb(e,"officeaicopilot-chat: onClickSuggestionPill"),[2]}))}))},handleRefreshButtonClick:function(){return Object(r.__awaiter)(n,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return Object.keys(this.suggestedQnAsList).length>0?(this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache()),this.telemetryLoggerUtils.logSeenEvent([],K,V.ChatQnA,F.QAandSummaries,N.Ask,H.BasicChat)):null===(t=null==e?void 0:e.onRefreshButtonClicked)||void 0===t||t.call(e),nb("officeaicopilot-chat: onClickRefreshButton"),[2]}))}))}};return o},e}(),Jf=Zf,Xf=function(){function e(e,t,n,o,i,a,s){var l=this;this.getTransformFileSuggestionText=function(){var e,t;if(l.zqmProps)try{for(var n=Object(r.__values)(l.zqmProps.promptSuggestionList),o=n.next();!o.done;o=n.next()){var i=o.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Bg},this.chatInputRef=e,this.handleSubmit=t,this.updateHintCard=n,this.isExecuting=o,this.chatEditor=i,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=a,this.setChatInputStateExpanded=s}return e.prototype.handleZQMButtonClick=function(e){var t,n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.isExecuting?[2]:(Df(Bg),hg.getInstance().sendLoggingEventToClient($p.ZQMButtonItemClicked),i=e,a=Bg,e.endsWith(Fg)?[4,this.setChatInputStateExpanded()]:[3,2]);case 1:r.sent(),i=i.slice(0,-Fg.length)+" ",r.label=2;case 2:return(null==(s=this.zqmProps.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:s.inputAreaText)&&(i=s.inputAreaText),(null==s?void 0:s.shouldSubmitQueryOnClick)?[4,this.handleSubmit({text:i,telemetryData:M.ZQMButtonClicked})]:[3,4];case 3:return r.sent(),[2];case 4:return this.updateHintCard(e),e===this.transformFileSuggestionText&&(a=this.transformFilePlaceholderText),e===this.transformFileSuggestionText&&this.chatEditor&&this.chatEditor.setCurrentScope(Qp.File),null===(t=this.chatInputRef.current)||void 0===t||t.setInputText(i),null===(n=this.chatInputRef.current)||void 0===n||n.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=l.chatInputRef.current)||void 0===e?void 0:e.updateInputText(El,uu.InsertAtCursor)}),1),null===(o=this.chatInputRef.current)||void 0===o||o.setGhostText(a),[2]}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{headerText:this.zqmProps.headerText,promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestion:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t}})),handleButtonClick:this.handleZQMButtonClick}},e}(),$f=function(){function e(){}return e.prototype.getTrySydneyProps=function(e,t,n){return{checked:e.trySydneyToggleChecked,disabled:t,onChange:e.trySydneyToggleOnChange,label:n}},e.prototype.getTryEnterpriseSearchProps=function(e,t,n){return{checked:e.tryEnterpriseSearchToggleChecked,disabled:t,onChange:e.tryEnterpriseSearchToggleOnChange,label:n}},e.prototype.getTryWebChatProps=function(e,t,n){return{checked:e,onChange:t,label:n,disabled:!1}},e}(),em=function(e,t,n,o,i,a,s,l){var c=this;this.addResponseMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0===o||o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,u=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");c.chatContainerbuilder.setChatMessageData(t,n,r,p,!1),s&&Bh.getInstance().setAugloopResponseTimer(u),i&&c.setIsExecuting(!1)},this.updateLastMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,u=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;c.chatContainerbuilder.updateLastMessage(t,n,r,p),s&&Bh.getInstance().setAugloopResponseTimer(u),i&&c.setIsExecuting(!1)},this.resendChatHistorySignal=function(e,t){!function(e,t){if(Vh){nb("resendCopilotMessage got key ".concat(e,", and found a message with key ").concat(zh));var n=t(Vh);n&&uf(ng.c.AddMessageOperation,n)}}(e,t)},this.updateMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0===o||o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,u=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");(null==r?void 0:r.messageId)||nb("updateMessage: messageId is missing in chatMessageBodyData"),c.chatContainerbuilder.setChatMessageData(t,n,r,p,!0),s&&Bh.getInstance().setAugloopResponseTimer(u),i&&c.setIsExecuting(!1)},this.deleteMessage=function(e){var t=e.chatCardType,n=e.messageIdToDelete;c.chatContainerbuilder.deleteMessage(t,n)},this.submitOperation=function(e){var t=e.operation,n=e.workflowAnnotationType;return wh.getInstance().isWorkflowRegistered(n)&&wh.getInstance().isAugloopResponseTimeoutRequired(n)&&Bh.getInstance().setAugloopResponseTimer(n),nb("operation submitted",t),Of.getInstance().submitOperation(t,n),!0},this.updateLoadingComponentProps=function(e){c.setLoadingComponentProps((function(t){return Object(r.__assign)(Object(r.__assign)({},t),e)}))},this.addChatMessages=function(e,t){void 0===t&&(t=!0),c.chatContainerbuilder.addChatMessages(e),t&&c.setIsExecuting(!1)},this.getLastMessage=function(e){return c.chatContainerbuilder.getLastMessage(e)},this.clearMessages=function(){c.chatContainerbuilder.clearMessages()},this.startLoadingUi=function(){c.setIsExecuting(!0)},this.startReinitializeALSession=function(){c.setShouldReinitializeALSession(!0)},this.getInputText=function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.getInputText()},this.setInputAreaText=function(e){var t,n,r;nb("setInputAreaText",e);var o=e,i=kb(e),a=i.inputSpanText,s=i.isFileEntityPresent;o=a,nb("inputSpanText: ".concat(a,", isFileEntityPresent:"),s);var l=Bg;a.endsWith(Fg)&&(o=a.slice(0,-Fg.length)+" "),s&&(l=c.ciqPlaceholderText?c.ciqPlaceholderText:yh),null===(t=c.chatInputRef.current)||void 0===t||t.setInputText(o),null===(n=c.chatInputRef.current)||void 0===n||n.setFocus(),s&&c.chatEditor&&setTimeout((function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.updateInputText(El,uu.InsertAtCursor)}),1),null===(r=c.chatInputRef.current)||void 0===r||r.setGhostText(l)},this.setInputFocus=function(){var e;nb("setInputFocus"),c.isDisabled||null===(e=c.chatInputRef.current)||void 0===e||e.setFocus()},this.setIsDisabled=function(e){nb("setIsDisabled",e),c.isDisabled=e},this.setIsExecuting=e,this.chatContainerbuilder=n,this.setLoadingComponentProps=t,this.chatInputRef=o,this.chatEditor=i,this.isDisabled=l,this.setShouldReinitializeALSession=a,this.ciqPlaceholderText=s},tm=Object(Te.a)(jf),nm={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:tm.themeBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:tm.themeBackground},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:tm.colorNeutralStroke1Selected},re.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:tm.colorNeutralForeground3},re.a.borderRadius("20px")),re.a.border("2px","solid",tm.colorNeutralBackground2Hover)),{":hover":{backgroundColor:tm.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:tm.colorNeutralBackground2Hover},re.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:tm.colorNeutralStroke1Selected},re.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:tm.colorNeutralForeground3},re.a.borderRadius("20px")),re.a.border("2px","solid",tm.colorNeutralBackground2Hover)),{":hover":{backgroundColor:tm.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:tm.colorNeutralBackground2Hover},re.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:tm.themeBackground},incomingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},re.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),re.a.margin("10px")),outgoingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},re.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),re.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),re.a.border("1px","solid","rgba(230, 230, 230, 1)")),re.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",backgroundColor:tm.colorNeutralBackground1,opacity:"0.6"}),outgoingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),re.a.border("1px","solid","rgba(230, 230, 230, 1)")),re.a.margin(0,"16px")),{height:"124px",backgroundColor:tm.colorNeutralBackground1,opacity:"0.8"}),paneLoadMessageContainer:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.margin(0,"16px")),re.a.border("2px","solid","rgba(230, 230, 230, 1)")),{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",alignItems:"center",backgroundColor:On.a.colorNeutralBackground4,borderTopLeftRadius:"7px",borderTopRightRadius:"7px",position:"relative"}),paneLoadWarningIcon:{paddingInlineStart:"10px",paddingInlineEnd:"8px",height:"16px",width:"16px"},paneLoadWarningLabel:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis"})},rm={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:On.a.colorNeutralBackground1},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:On.a.colorNeutralBackground1},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralStroke1Selected},re.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralForeground3},re.a.borderRadius("20px")),re.a.border("2px","solid",On.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:On.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground2Hover},re.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralStroke1Selected},re.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:On.a.colorNeutralForeground3},re.a.borderRadius("20px")),re.a.border("2px","solid",On.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:On.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(r.__assign)({backgroundColor:On.a.colorNeutralBackground2Hover},re.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:On.a.colorNeutralBackground1},incomingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},re.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),re.a.margin("10px")),outgoingShimmerCard:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},re.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),re.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),re.a.border("1px","solid","rgba(230, 230, 230, 1)")),re.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:On.a.colorNeutralBackground1}),outgoingShimmerCardWrapper:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("8px")),re.a.border("1px","solid","rgba(230, 230, 230, 1)")),re.a.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:On.a.colorNeutralBackground1}),paneLoadMessageContainer:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius(On.a.borderRadiusXLarge)),re.a.margin(0,"16px")),re.a.border("2px","solid","rgba(230, 230, 230, 1)")),{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",alignItems:"center",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",position:"relative",backgroundColor:On.a.colorNeutralBackground4}),paneLoadWarningIcon:{paddingInlineStart:"10px",paddingInlineEnd:"8px",height:"16px",width:"16px"},paneLoadWarningLabel:Object(r.__assign)(Object(r.__assign)({},vt.a.caption1),{textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis"})},om=Object(X.a)(nm),im=Object(X.a)(rm),am=function(e,t){if(t)for(var n in e)e[n]=Object($.a)(e[n],t[n]);return e},sm=0,lm=function(){function e(e,t,n,o,i,a,s,l,c,u,d,p,g){var h=this;this.onTryAgainClicked=function(){sm=(new Date).getTime(),ou(h.isMicrophoneListening,zg,h.setShouldShowMicrophonePermissionRetryDialog,h.setMicrophoneState,h.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(r.__awaiter)(h,void 0,void 0,(function(){var t,n,o,i,a,s,l,c,u,d,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=yg.getInstance(),this.setPaneLoadMessageIfApplicable(mh.Microphone))return[2];null==e||e.stopPropagation(),r.label=1;case 1:return r.trys.push([1,7,,10]),this.isMicrophoneListening?(t.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophonePauseClicked}]),(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=Bg&&(null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())!=this.chatPlaceHolderMessage&&(null===(l=null===(s=this.chatInputRef.current)||void 0===s?void 0:s.getGhostText())||void 0===l?void 0:l.trim())!=bh()&&(null===(c=this.chatInputRef.current)||void 0===c||c.setInputText((null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getInputText())+(null===(d=this.chatInputRef.current)||void 0===d?void 0:d.getGhostText())),null===(p=this.chatInputRef.current)||void 0===p||p.setGhostText("")),[4,ru(this.setMicrophoneListeningStatus)]):[3,3];case 2:return r.sent(),nb("Microphone Paused"),[3,6];case 3:return t.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophonePlayClicked}]),this.microphoneState===vs.Uninitialized&&this.setMicrophoneState(vs.Loading),sm=(new Date).getTime(),[4,Yc.GetInstance().Resume()];case 4:return r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(vs.Enabled),[4,iu(zg,this.setMicrophoneListeningStatus)];case 5:r.sent(),nb("Microphone Resumed"),r.label=6;case 6:return[3,10];case 7:return n=r.sent(),o="Error occurred while fetching mic permissions - : ".concat(n),nb(o),null==Hv||Hv.logError({eventType:A.Microphone,errorMessage:o}),"ErrorAudioPermissionDeniedError"!=n?[3,9]:[4,Yc.GetInstance().Pause()];case 8:r.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),t.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophonePermissionDenied}]),r.label=9;case 9:return this.setMicrophoneState(vs.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=o,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p,this.setPaneLoadMessageIfApplicable=g}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}();function cm(e,t,n,r,o){var i=yg.getInstance();nb("basicChatErrorHandler called with error : ".concat(e," and status : "),t);var a="";if(!gb(e.errorDetailsJson))try{a=JSON.parse(e.errorDetailsJson).code}catch(e){nb("Error parsing error code from basic chat error",e.message)}Mh.getInstance().sendLoggingEventToClient($p.AugloopErrorReceived,{annotationName:o,timeInMs:Zv(Vv),chatEventParams:JSON.stringify({errorCategory:e.category,errorCode:a})}),i.sendTelemetryChatEventData([{key:D.ChatEventType,value:"".concat(o,"_Error")},{key:D.ChatEventParameters,value:"".concat(e.category,"_").concat(a)},{key:D.ChatErrorType,value:U.Server},{key:D.UserQueryGuid,value:Mh.getInstance().getQueryID()}]),i.sendTelemetryLatencyData([{key:_.ErrorParameter,value:"".concat(e.category,"_").concat(a)},{key:_.ErrorType,value:U.Server}]);var s=e.category,l=G.Fallback,c=Og(Mh.getInstance().getFeatureName());switch(s){case ph.OffensiveContent:switch(a){case dh.OffensiveInputContent:l=G.OffensiveInput,dm(n,Kg());break;case dh.OffensiveOutputContent:l=G.OffensiveOutput,dm(n,Yg());break;case dh.OutputBlockedByDynamicGuardList:l=G.OutputBlocked,dm(n,Yg());break;case dh.InputBlockedByDynamicGuardList:l=G.InputBlocked,dm(n,Zg());break;default:dm(n,Jg())}break;case ph.PromptInjection:if(a===dh.Detected)l=G.PromptInjection,dm(n,Zg());else dm(n,Jg());break;case ph.InvalidSignal:switch(l=G.InvalidSignal,a){case dh.Missing:l=G.SignalMissing,c=z.BasicChatMissingCopilotFunctionality,dm(n,Jg());break;case dh.WrongType:l=G.SignalWrongType,c=z.BasicChatMissingCopilotFunctionality,dm(n,Jg());break;default:dm(n,Jg())}break;case ph.InvalidLanguage:if(l=G.InvalidLanguage,a===dh.NotSupported){var u=Mh.getInstance().getBasicChatProps();u.languageHelpLink?pm(n,nh(),rh(),u.languageHelpLink):dm(n,nh())}else dm(n,Jg());break;case ph.InferenceAPI:switch(a){case dh.Timeout:l=G.Timeout,dm(n,Xg());break;case dh.UserThrottled:l=G.UserThrottled,c=z.BasicChatCapacityIssues,dm(n,eh());break;case dh.Throttled:case dh.ScenarioThrottled:l=G.ScenarioThrottled,c=z.BasicChatCapacityIssues,dm(n,$g());break;case dh.NotAvailable:dm(n,Xg());break;case dh.InputRaiDependency:l=G.OffensiveInput,dm(n,Kg());break;case dh.OutputRaiDependency:dm(n,Jg());break;case dh.BadResponse:l=G.BadResponse,c=z.BasicChatBadResponse,dm(n,Jg());break;case dh.BadRequest:l=G.BadRequest,c=z.BasicChatTaskCompletionIssue,dm(n,Jg());break;case dh.Unknown:l=G.Unknown,c=z.BasicChatUnclassifiedError,dm(n,Jg());break;default:dm(n,Jg())}break;case ph.InvalidInput:if(a===dh.TooLong)l=G.InputTooLong,dm(n,th());else dm(n,Jg());break;default:dm(n,Jg())}Mh.getInstance().getIsFluxFlowEnabled()||(nb("Encountered Error. Stopping loading UI"),r(!1)),i.logErrorWithAshaVetoAndError([{key:D.UserQueryGuid,value:Mh.getInstance().getQueryID()}],Mh.getInstance().getFeatureName(),Bg,c,l)}var um,dm=function(e,t){e.setChatMessageData(P.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:er.Footer,isFailure:!0,showAnimation:!1,feedbackData:Mh.getInstance().getFeedbackData()},!0)},pm=function(e,t,n,r){e.setChatMessageData(P.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t,linkText:{text:n,linkOnClick:gm,linkUrl:r}}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:er.Footer,isFailure:!0,showAnimation:!1,feedbackData:Mh.getInstance().getFeedbackData()},!0)},gm=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return window.open(e),[2]}))}))},hm=function(e,t,n,r){var o,i,a,s,l,c,u,d=null==e?void 0:e.body,p=null==d?void 0:d.answer,g=null==d?void 0:d.error,h=null==d?void 0:d.aiResponse,f=null==d?void 0:d.status,m=null==d?void 0:d.isBasicChat,v=null==d?void 0:d.queryId,b=null==d?void 0:d.citation,y=yg.getInstance(),C=Cg(null==d?void 0:d.featureType);if(Mh.getInstance().setFeatureName(C),Mh.getInstance().setQueryID(v),Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Started,workflowAnnotationType:og.a.getTypeName(),queryID:v,responseTime:Zv(r)}),y.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ResponseReceivedFromAL},{key:D.ChatEventParameters,value:og.a.getTypeName()},{key:D.UserQueryGuid,value:v}]),y.logTriedEvent([{key:q,value:v}],K,C,Sg(C),void 0,Eg(C),xg(C)),y.sendTelemetryLatencyData([{key:_.FeatureName,value:C}]),Mh.getInstance().sendLoggingEventToClient($p.AugloopResponseReceived,{annotationName:og.a.getTypeName(),timeInMs:Zv(r)}),wh.getInstance().isAugloopResponseTimeoutRequired(null===(o=null==d?void 0:d.H_)||void 0===o?void 0:o.T_)&&Bh.getInstance().clearAugloopResponseTimer(),Mh.getInstance().getIsFluxFlowEnabled()||(nb("Stopping loading UI"),n(!1)),!wg(g)&&!wg(null==g?void 0:g.category))return cm(g,f,t,n,og.a.getTypeName()),y.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(r)},{key:_.QnAResponseTime,value:Yv(r)},{key:_.IsQuerySuccess,value:!1},{key:_.UserQueryGuid,value:v}],!0),void Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Finished,workflowAnnotationType:og.a.getTypeName(),queryID:v,isSuccess:!1,responseTime:Zv(r)});var O={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:er.Footer,showAnimation:!0,feedbackData:Mh.getInstance().getFeedbackData(),isFailure:!1,actionButtonList:[{type:zr.Default,title:Gg(),text:J()?"":Gg(),iconRegular:J()?we.e:we.c,iconHover:J()?we.d:we.b,position:J()?Gr.FeedbackSection:Gr.ActionButtonBar,popoverProps:{popoverTitle:Qg()},handleButtonOnClick:kg}],references:b&&b.length>0&&(null===(i=Mh.getInstance().getBasicChatProps())||void 0===i?void 0:i.isCitationsEnabled)?Mh.getInstance().getMarkdownReferences(b):void 0,clpSensitivityIndicatorData:null!==(s=null===(a=Mh.getInstance().getBasicChatProps())||void 0===a?void 0:a.sensitivityIndicatorData)&&void 0!==s?s:void 0,telemetryData:JSON.stringify({correlationId:v,featureName:C})},S=m?P.MarkdownCard:P.Default,E=m?{markDownCardProps:{user:"chat",message:p}}:{defaultMessageProps:{user:"chat",messageHeader:{text:p}}};t.setChatMessageData(S,E,O),h&&"suggestions"===(null==h?void 0:h.type)&&(null===(c=null===(l=null==h?void 0:h.value)||void 0===l?void 0:l.suggestions)||void 0===c?void 0:c.length)>0&&Mh.getInstance().sendBasicChatSuggestionPillsEvent(null===(u=null==h?void 0:h.value)||void 0===u?void 0:u.suggestions),Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Finished,workflowAnnotationType:og.a.getTypeName(),queryID:v,isSuccess:!0,responseTime:Zv(r)}),y.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(r)},{key:_.QnAResponseTime,value:Yv(r)},{key:_.IsQuerySuccess,value:!0},{key:_.UserQueryGuid,value:v}],!0)},fm=function(e,t,n,r){var o,i,a,s,l=null==e?void 0:e.body,c=null==l?void 0:l.answer,u=null==l?void 0:l.error,d=null==l?void 0:l.aiResponse,p=null==l?void 0:l.status,g=null==l?void 0:l.citations,h=null==l?void 0:l.isStreaming,f=null==l?void 0:l.isAnswerCompleted,m=null==l?void 0:l.queryId,v=yg.getInstance(),b=Cg(null==l?void 0:l.featureType);if(nb("Getting isStreaming boolean as : ".concat(h," and isAnswerCompleted as : ").concat(f," and answer as : ").concat(c," and featureType as : ").concat(b)),Mh.getInstance().setFeatureName(b),Mh.getInstance().setQueryID(m),Mh.getInstance().getIsFirstStreamChunk()&&(Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Started,workflowAnnotationType:og.b.getTypeName(),queryID:m,responseTime:Zv(r)}),v.logTriedEvent([{key:q,value:m}],K,b,Sg(b),void 0,Eg(b),xg(b)),v.sendTelemetryLatencyData([{key:_.FeatureName,value:b}])),v.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ResponseReceivedFromAL},{key:D.ChatEventParameters,value:og.b.getTypeName()},{key:D.UserQueryGuid,value:m},{key:D.IsStreamingResponse,value:h.toString()}]),Mh.getInstance().sendLoggingEventToClient($p.AugloopResponseReceived,{annotationName:og.b.getTypeName(),timeInMs:Zv(r)}),Bh.getInstance().clearAugloopResponseTimer(),!wg(u)&&!wg(null==u?void 0:u.category))return Mh.getInstance().getIsFirstStreamChunk()||Mh.getInstance().updateCardWithFooter(),cm(u,p,t,n,og.b.getTypeName()),Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Finished,workflowAnnotationType:og.b.getTypeName(),queryID:m,isSuccess:!1,responseTime:Zv(r)}),v.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(r)}]),void Mh.getInstance().resetBasicChatStreamingStates(!1,!Mh.getInstance().getIsFluxFlowEnabled());h?(Mh.getInstance().setIsBasicChatStreaming(!0),mm(c,f,t,v)):Mh.getInstance().resetBasicChatStreamingStates(!0,!Mh.getInstance().getIsFluxFlowEnabled()),g&&g.length>0&&Mh.getInstance().getBasicChatProps().isCitationsEnabled&&(v.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CitationReceived},{key:D.ChatEventParameters,value:g.length.toString()},{key:D.UserQueryGuid,value:m}]),t.updateLastMessage(P.MarkdownCard,void 0,{references:Mh.getInstance().getMarkdownReferences(g)},!1)),d&&"suggestions"===(null==d?void 0:d.type)&&(null===(i=null===(o=null==d?void 0:d.value)||void 0===o?void 0:o.suggestions)||void 0===i?void 0:i.length)>0&&Mh.getInstance().sendBasicChatSuggestionPillsEvent(null===(a=null==d?void 0:d.value)||void 0===a?void 0:a.suggestions),h?Bh.getInstance().setAugloopResponseTimer(null===(s=null==l?void 0:l.H_)||void 0===s?void 0:s.T_):(Mh.getInstance().sendBasicChatProcessingEvent({status:eg.Finished,workflowAnnotationType:og.b.getTypeName(),queryID:m,isSuccess:!0,responseTime:Zv(r)}),Mh.getInstance().getIsFluxFlowEnabled()||(nb("Streaming finished. Stopping loading UI"),n(!1)))},mm=function(e,t,n,o){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,c;return Object(r.__generator)(this,(function(r){return Mh.getInstance().getIsFirstStreamChunk()&&""===e?(o.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.EmptyBasicChatResponse},{key:D.UserQueryGuid,value:Mh.getInstance().getQueryID()}]),[2]):(i=(i=e).replace("\\n","\n").replace("\\t","\t"),a=Mh.getInstance().getParagraphChunks(),a+=i,Mh.getInstance().setParagraphChunks(a),s={shouldShowAIGeneratedIndicator:!0,showAnimation:!1,feedbackData:Mh.getInstance().getFeedbackData(),isFailure:!1,clpSensitivityIndicatorData:null!==(c=null===(l=Mh.getInstance().getBasicChatProps())||void 0===l?void 0:l.sensitivityIndicatorData)&&void 0!==c?c:void 0,telemetryData:JSON.stringify({correlationId:Mh.getInstance().getQueryID(),featureName:Mh.getInstance().getFeatureName()})},Mh.getInstance().updateStreamChunks({augloopResponseTime:Yv(Vv)}),Mh.getInstance().getIsFirstStreamChunk()?(n.setChatMessageData(P.MarkdownCard,{markDownCardProps:{user:"chat",message:i}},s,!1),Mh.getInstance().setIsFirstStreamChunk(!1),o.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(Vv)}])):n.updateLastMessage(P.MarkdownCard,{markDownCardProps:{user:"chat",message:a}},void 0,!1),t&&Mh.getInstance().updateCardWithFooter(),[2])}))}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(um||(um={}));var vm,bm=function(e,t){var n=null==e?void 0:e.body,r=n.suggestedQnAs,o=n.error,i=n.queryId,a=yg.getInstance(),s=Mh.getInstance().getSuggestedQnaSignalSubmitTime();if(nb("received suggestedQnaList",r),a.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ResponseReceivedFromAL},{key:D.ChatEventParameters,value:og.c.getTypeName()},{key:D.UserQueryGuid,value:i}]),a.sendTelemetryLatencyData([{key:_.SuggestedQnAResponseTime,value:Yv(s)}]),Mh.getInstance().sendLoggingEventToClient($p.AugloopResponseReceived,{annotationName:og.c.getTypeName(),timeInMs:Zv(s)}),!wg(o)&&!wg(null==o?void 0:o.category)){var l="",c=og.c.getTypeName();if(!wg(o.errorDetailsJson))try{l=JSON.parse(o.errorDetailsJson).code}catch(e){nb("Error parsing error code from basic chat error",e.message)}return nb("Received error from DynamicQuestionGeneratorSuggestedQnAAnnotation Workflow"),Mh.getInstance().sendLoggingEventToClient($p.AugloopErrorReceived,{annotationName:c,timeInMs:Zv(s),chatEventParams:JSON.stringify({errorCategory:o.category,errorCode:l})}),void a.sendTelemetryChatEventData([{key:D.ChatEventType,value:"".concat(c,"_Error")},{key:D.ChatEventParameters,value:"".concat(o.category,"_").concat(l)},{key:D.ChatErrorType,value:U.Server},{key:D.UserQueryGuid,value:i}])}r&&t.setSuggestedQnAList(r)};try{vm=n(1104)}catch(de){}var ym=function(){function e(){this.debugLogs=""}return e.initialize=function(){e.debugLogManager||(e.debugLogManager=new e)},e.getInstance=function(){return e.debugLogManager},e.prototype.addLog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=vm?vm.format.apply(vm,Object(r.__spreadArray)([],Object(r.__read)(e),!1))+"\n":e.join(" ")+"\n";this.debugLogs+=n},e.prototype.getLogs=function(){return this.debugLogs},e.prototype.resetLogs=function(){this.debugLogs=""},e}(),Cm=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n){return{conversationId:t,getLogs:e,telemetryData:n}},e}(),Om=n(2078),Sm=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o,i,a,s,l;return Object(r.__generator)(this,(function(r){return n=null===(l=null===(s=e.body)||void 0===s?void 0:s.H_)||void 0===l?void 0:l.T_,o=null==e?void 0:e.body,i=o.success,a=o.sensitivityLabel,yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ResponseReceivedFromAL},{key:D.ChatEventParameters,value:"".concat(n)}]),nb("received sensitivity label",a),t(i&&a?a:void 0),[2]}))}))},Em=function(){this.getProps=function(e){return{handleChangeTopicButtonClick:e}}},xm=n(1638),Im=n(3598),wm=n(3368),Tm=function(e){var t=e.className,n=om();return o.createElement(te,{style:t},o.createElement(Im.a,null,o.createElement("div",{className:n.incomingShimmerCardWrapper},o.createElement("div",{className:n.incomingShimmerCard},o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}))),o.createElement("div",{className:n.outgoingShimmerCardWrapper},o.createElement("div",{className:n.outgoingShimmerCard},o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih}),o.createElement(wm.a,{size:ih})))))},km=n(952),jm=n(506);const Pm=800,Am=600;var _m,Dm,Lm,Mm,Bm,Rm,Fm,Nm,Hm,Um,Vm,zm=n(951);class Gm extends zm.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class Wm extends Gm{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class Qm{constructor(e,t,n,r,o){this.userContext=e,this.hostContext=t,this.tokenService=n,this.telemetryService=r,this.hostWindow=o}authenticate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var o,i;const a={user:this.userContext,app:this.hostContext,page:{id:(null===(o=e.appDefinition)||void 0===o?void 0:o.id)||"",frameContext:We.a.authentication}},s=e=>(r,o)=>e?(t({code:r}),Promise.resolve()):(n(r),Promise.resolve()),l=new Wm(s(!0),s(!1),this.tokenService,this.userContext);(function(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{var s;const l=Object(km.a)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(s=t.appDefinition.version)&&void 0!==s?s:"",appId:t.appDefinition.id})),c={url:t.signInUrl,width:Pm,height:Am,left:e.screen.availWidth/2-Pm/2,top:e.screen.availHeight/2-Am/2};new jm.b(e,c,l,n,o,i)?r(void 0):a("Unable to initialize auth extension")}))}))})(null!==(i=this.hostWindow)&&void 0!==i?i:window,e,l,a,this.telemetryService).catch((e=>{}))}))}))}getToken(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.tokenService.getToken(e)}))}}!function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed"}(_m||(_m={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(Dm||(Dm={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI"}(Lm||(Lm={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9"}(Mm||(Mm={})),function(e){e[e.getHeader=0]="getHeader",e[e.getPlugins=2]="getPlugins",e[e.getAppDefinition=3]="getAppDefinition",e[e.getBotInvokeRequest=4]="getBotInvokeRequest",e[e.handleAuthLinkClick=5]="handleAuthLinkClick",e[e.onToggle=6]="onToggle",e[e.nextButtonClick=7]="nextButtonClick",e[e.gotItButtonClick=8]="gotItButtonClick"}(Bm||(Bm={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.getInstalledPlugins=4]="getInstalledPlugins",e[e.getSelectedPlugins=5]="getSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9"}(Rm||(Rm={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(Fm||(Fm={})),function(e){e.IsCached="IsCached",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.isAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount"}(Nm||(Nm={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(Hm||(Hm={})),function(e){e[e.Auth=0]="Auth",e[e.Config=1]="Config",e[e.SilentAuth=2]="SilentAuth",e[e.BotInvokeForAuthCheck=3]="BotInvokeForAuthCheck",e[e.Unknown=4]="Unknown"}(Um||(Um={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(Vm||(Vm={}));var qm=n(2152);class Km{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:Dm.LogMetric,tag:this.tag,name:this.name,success:Fm.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:Dm.LogMetric,tag:this.tag,name:this.name,success:Fm.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:Dm.LogMetric,tag:this.tag,name:this.name,success:Fm.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}class Ym{constructor(e,t,n){this.dataProvider=e,this.addPlugin=t,this.removePlugin=n}onToggle(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.plugin.isEnabled=e,e?null===(t=this.addPlugin)||void 0===t||t.call(this,this.plugin):null===(n=this.removePlugin)||void 0===n||n.call(this,this.plugin),yield this.dataProvider.setPlugin(this.plugin)}))}}class Zm extends Ym{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class Jm extends Ym{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class Xm extends Ym{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}var $m=n(2217),ev=n(1555),tv=n(1477),nv=n(2681),rv=n(2680);let ov=0;class iv extends Ym{constructor(e,t,n,r,o,i,a,s){var l;super(t,o,i),this.plugin=e,this.dataProvider=t,this.authActivityProvider=n,this.appService=r,this.addPlugin=o,this.removePlugin=i,this.telemetryService=a,this.correlationVector=s,this.pluginInfoForLogging="",this.authActivityProvider&&(this.authRuntime=new $m.a(this.authActivityProvider)),e.isEnabled&&(null===(l=this.addPlugin)||void 0===l||l.call(this,e)),this.pluginInfoForLogging=function(e){var t,n;return null!==(n=null===(t=e.titleId)||void 0===t?void 0:t.startsWith("P_"))&&void 0!==n&&n}(e)?`, PluginId: ${this.plugin.id}, PluginName: ${this.plugin.name}, PluginSource: ${this.plugin.source}`:e.titleId?", LOB Plugin":", TitleId not found"}handleAuthLinkClick(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{ov++;const t=yield this.executeAuthRequest(!1);this.updatePluginStatus(t,e)}catch(e){}ov>0&&ov--}))}onToggle(e,t){var n,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)return void this.toggleAndUpdatePluginStatus("processed",e,t);if(!this.authRuntime||!this.plugin.metaOSAppId){const r=this.authRuntime?"metaOSAppId is undefined":"AuthRuntime is undefined";return null===(n=this.telemetryService)||void 0===n||n.LogError({type:Dm.LogError,tag:Lm.MsgExtViewModel,name:Bm.onToggle,message:_m.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${r}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),void this.toggleAndUpdatePluginStatus("processed",e,t)}this.updatePluginStatus("processing",t),this.plugin.authRequest=yield this.getAuthRuntimeRequest();const r=yield this.executeAuthRequest(!0);if("pendingAuth"===r&&0===ov)return this.toggleAndUpdatePluginStatus(r,e,t),void(yield this.handleAuthLinkClick(t));this.toggleAndUpdatePluginStatus(r,e,t)}catch(n){null===(o=this.telemetryService)||void 0===o||o.LogError({type:Dm.LogError,tag:Lm.MsgExtViewModel,name:Bm.onToggle,message:_m.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${(null==n?void 0:n.message)||n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),this.toggleAndUpdatePluginStatus("processed",e,t)}}))}executeAuthRequest(e){var t,n,o,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.plugin.authRequest){const r=new Km(Mm.AuthActivity,Rm.AuthActivity,this.telemetryService),a={};try{switch(this.plugin.authRequest.type){case"botInvoke":a[Nm.TypeOfAuthFlow]=Um.BotInvokeForAuthCheck;break;case"silentAuth":a[Nm.TypeOfAuthFlow]=Um.SilentAuth;break;case"auth":a[Nm.TypeOfAuthFlow]=Um.Auth;break;case"config":a[Nm.TypeOfAuthFlow]=Um.Config}a[Nm.isAuthFlowAutomatic]=e?1:0;const s=yield null===(t=this.authRuntime)||void 0===t?void 0:t.execute(this.plugin.authRequest);if(s)return r.logMetricEnd({props:a,message:_m.None,diagnosticsData:`Auth request executed successfully${this.pluginInfoForLogging}`},this.correlationVector),this.plugin.authRequest=Object(ev.b)(this.plugin.authRequest,s),"auth"===(null===(n=this.plugin.authRequest)||void 0===n?void 0:n.type)||"config"===(null===(o=this.plugin.authRequest)||void 0===o?void 0:o.type)||"silentAuth"===(null===(i=this.plugin.authRequest)||void 0===i?void 0:i.type)?"pendingAuth":"processed";r.logMetricEndWithError({props:a,message:_m.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: AuthSDK execute returned undefined response${this.pluginInfoForLogging}`},this.correlationVector)}catch(e){return r.logMetricEndWithError({props:a,message:_m.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: ${null==e?void 0:e.message}${this.pluginInfoForLogging}`},this.correlationVector),Promise.reject(`Could not execute auth request as ${e.message||e}`)}}return Promise.reject("Could not execute auth request as auth request is not available")}))}getAuthRuntimeRequest(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.appService||!this.plugin.metaOSAppId)return Promise.reject("AppId or serviceProvider is undefined");const e=yield this.getAppDefinition(this.appService,this.plugin.metaOSAppId);if(!e)return Promise.reject("Could not find app definition");if(!Object(nv.a)(e))return Promise.reject("Could not find command with initial run enabled");const t=this.getBotInvokeRequest(e);if(!t)return Promise.reject("Could not find bot invoke request");const n=Object.assign(Object.assign({type:"botInvoke"},t),{onActivityCompletion:this.getOnAuthActivityCompletion(this.plugin)});return Promise.resolve(n)}))}getOnAuthActivityCompletion(e){return t=>{if(e.authRequest){const n=Object(tv.b)(t);if("auth"===n||"config"===n)return e.authRequest=Object(ev.b)(e.authRequest,t),e.status="pendingAuth",Promise.resolve(!0)}return Promise.resolve(!1)}}onInstall(){throw new Error("Method not implemented.")}getAppDefinition(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getApp({id:t});if(!n||!n.appDefinition&&!n.titleInfo)return;let r;return(null==n?void 0:n.appDefinition)?r=n.appDefinition:(null==n?void 0:n.titleInfo)&&(r=Object(rv.a)(n.titleInfo)),r}))}getBotInvokeRequest(e){var t,n,r,o,i,a,s,l;const c=null!==(r=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)&&void 0!==r?r:null===(i=null===(o=e.inputExtensions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.botId,u=this.plugin.metaOSAppId,d=null===(l=null===(s=null===(a=e.inputExtensions)||void 0===a?void 0:a[0].commands)||void 0===s?void 0:s[0])||void 0===l?void 0:l.id;if(!c||!u||!d){throw new Error(`Could not construct bot invoke request. ErrorMessage: ${c?u?"CommandId is undefined":"AppId is undefined":"BotId is undefined"}`)}return{appId:u,botId:c,requestBody:{name:"composeExtension/query",appName:e.name,value:{commandId:d,parameters:[{name:"initialRun",value:"true"}],queryOptions:{skip:0,count:25}}}}}toggleAndUpdatePluginStatus(e,t,n){const o=Object.create(null,{onToggle:{get:()=>super.onToggle}});return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield o.onToggle.call(this,t),this.updatePluginStatus(e,n)}))}updatePluginStatus(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.plugin.status=e,null==t||t()}))}}class av extends Ym{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class sv{constructor(e,t,n,r,o,i){this.dataProvider=e,this.authActivityProvider=t,this.addPlugin=n,this.removePlugin=r,this.telemetryService=o,this.appService=i,this.supportedPluginTypes=["MsgExt","FirstParty","PowerPlatform","DataVerse","Undefined"]}getPlugins(e,t,n){var o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(n)return this.getPluginsGrouped(e,t);const r=new Km(Mm.GetPluginsState,Rm.GetPlugins,this.telemetryService),i={};try{const n=this.getSupportedPluginTypes(e),a=yield null===(o=this.dataProvider)||void 0===o?void 0:o.getPlugins(t);let s=0,l=0,c=0,u=0,d=0,p=0;const g=null==a?void 0:a.reduce(((e,r)=>{var o;if(r.type&&n.includes(r.type))switch(r.isEnabled?s++:l++,(null===(o=r.titleId)||void 0===o?void 0:o.startsWith("P_"))&&(c++,r.isEnabled&&u++),r.type){case"MsgExt":d++,r.isEnabled&&p++,e.push(new iv(r,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new Jm(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new av(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new Zm(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new Xm(this.dataProvider,r,this.addPlugin,this.removePlugin))}return e}),[]);return i[Nm.TotalPluginCount]=g.length,i[Nm.TotalISVPluginCount]=c,i[Nm.SelectedPluginCount]=s,i[Nm.UnselectedPluginCount]=l,i[Nm.UnsupportedPluginCount]=a.length-g.length,i[Nm.SelectedISVPluginCount]=u,i[Nm.TotalMEPluginCount]=d,i[Nm.SelectedMEPluginCount]=p,r.logMetricEnd({props:i},t),g}catch(e){r.logMetricEndWithError({props:i,message:_m.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getPluginsGrouped(e,t){var n,o,i,a,s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const l=new Km(Mm.GetPluginsState,Rm.GetPlugins,this.telemetryService),c={};try{const g=this.getSupportedPluginTypes(e),h=[],f=yield null===(s=this.dataProvider)||void 0===s?void 0:s.getPluginsGrouped(t);let m=0,v=0,b=0,y=0,C=0,O=0,S=0;try{for(var u,d=!0,p=Object(r.__asyncValues)(f);u=yield p.next(),!(n=u.done);d=!0){a=u.value,d=!1;const e=a,n=e.groupHeaderPlugin;if(n.type&&g.includes(n.type)){let r=0,o=0,i=0,a=0,s=0,l=0;const c=new Jm(this.dataProvider,n,this.addPlugin,this.removePlugin),u=e.plugins.reduce(((e,n)=>{var c;switch(S++,n.isEnabled?r++:o++,(null===(c=n.titleId)||void 0===c?void 0:c.startsWith("P_"))&&(i++,n.isEnabled&&a++),n.type){case"MsgExt":s++,n.isEnabled&&l++,e.push(new iv(n,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new Jm(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new av(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new Zm(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new Xm(this.dataProvider,n,this.addPlugin,this.removePlugin))}return e}),[]);m+=r,v+=o,b+=i,y+=a,C+=s,O+=l,h.push({groupPlugins:u,parentPlugin:c})}}}catch(e){o={error:e}}finally{try{d||n||!(i=p.return)||(yield i.call(p))}finally{if(o)throw o.error}}return c[Nm.TotalPluginCount]=h.length,c[Nm.TotalISVPluginCount]=b,c[Nm.SelectedPluginCount]=m,c[Nm.UnselectedPluginCount]=v,c[Nm.UnsupportedPluginCount]=S-h.length,c[Nm.SelectedISVPluginCount]=y,c[Nm.TotalMEPluginCount]=C,c[Nm.SelectedMEPluginCount]=O,l.logMetricEnd({props:c},t),h}catch(e){l.logMetricEndWithError({props:c,message:_m.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getSupportedPluginTypes(e){return e?Object(qm.a)(this.supportedPluginTypes,e):this.supportedPluginTypes}}var lv,cv,uv,dv,pv,gv,hv,fv,mv;function vv(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.botInvoke(e);return Object.assign({},n)}))}!function(e){e[e.None=0]="None",e[e.PartialAuthSuccess=1]="PartialAuthSuccess"}(lv||(lv={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(cv||(cv={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.AuthRuntime=2]="AuthRuntime",e[e.AuthConfigRuntimeActivity=3]="AuthConfigRuntimeActivity",e[e.BotInvokeRuntimeActivity=4]="BotInvokeRuntimeActivity",e[e.SilentAuthRuntimeActivity=5]="SilentAuthRuntimeActivity",e[e.GetAppData=6]="GetAppData"}(uv||(uv={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(dv||(dv={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.ExecuteActivity=2]="ExecuteActivity",e[e.Execute=3]="Execute",e[e.ExecuteConfigOrAuthRequest=4]="ExecuteConfigOrAuthRequest",e[e.GetAppData=5]="GetAppData"}(pv||(pv={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(gv||(gv={})),function(e){e[e.PluginFlyout=1]="PluginFlyout",e[e.InChat=2]="InChat",e[e.CardAction=3]="CardAction",e[e.Unknown=4]="Unknown"}(hv||(hv={})),function(e){e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth",e[e.BotInvoke=4]="BotInvoke",e[e.Unknown=5]="Unknown"}(fv||(fv={})),function(e){e.AuthScenario="AuthScenario",e.AuthType="AuthType"}(mv||(mv={}));class bv{constructor(e){this.serviceProvider=e}execute(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e,n=yield this.executeConfigOrAuthRequest(t,this.serviceProvider.telemetryService),r=Object.assign({},t.originalInvokeRequest);return n&&(r.requestBody.value.state=n),yield vv(r,this.serviceProvider.channelService)}))}executeConfigOrAuthRequest(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.originalInvokeRequest.appId,r=yield this.serviceProvider.appService.getApp({id:n});let o;if(null==r?void 0:r.appDefinition)o=r.appDefinition;else{if(!(null==r?void 0:r.titleInfo))return null==t||t.LogError({type:cv.LogError,name:pv.ExecuteConfigOrAuthRequest,tag:uv.AuthConfigRuntimeActivity,success:!1,diagnosticsData:"App Definition not found"}),Promise.reject("App Definition not found");o=Object(rv.a)(r.titleInfo)}const i=yield this.serviceProvider.authService.authenticate({appDefinition:o,signInUrl:e.url});return null==i?void 0:i.code}))}}class yv{constructor(e){this.serviceProvider=e}execute(e){var t,n,o,i,a,s,l,c;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=e;if(!r.resource){const e=yield this.serviceProvider.appService.getApp({id:r.originalInvokeRequest.appId});r.resource=null!==(i=null!==(t=r.resource)&&void 0!==t?t:null===(o=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.webApplicationInfo)||void 0===o?void 0:o.resource)&&void 0!==i?i:null===(l=null===(s=null===(a=null==e?void 0:e.titleInfo)||void 0===a?void 0:a.titleDefinition)||void 0===s?void 0:s.webApplicationInfo)||void 0===l?void 0:l.resource}const u=yield this.executeSilentAuthRequest(r);if(!u)return null===(c=this.serviceProvider.telemetryService)||void 0===c||c.LogError({type:cv.LogError,name:pv.Execute,tag:uv.SilentAuthRuntimeActivity,success:!1,diagnosticsData:"Failed to fetch Auth token for the request"}),Promise.reject("Failed to fetch Auth token for the request");const d=Object.assign({},r.originalInvokeRequest);return d.requestBody.value.authentication={token:u},yield vv(d,this.serviceProvider.channelService)}))}executeSilentAuthRequest(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.serviceProvider.authService.getToken({resource:e.resource,claims:e.claims,isSilent:e.isSilent});return Promise.resolve(null==t?void 0:t.authToken)}))}}class Cv{constructor(e){this.serviceProvider=e}execute(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e;return this.serviceProvider.channelService?yield vv(n,this.serviceProvider.channelService):(null===(t=this.serviceProvider.telemetryService)||void 0===t||t.LogError({type:cv.LogError,name:pv.Execute,tag:uv.BotInvokeRuntimeActivity,success:!1,diagnosticsData:"Channel service is not available"}),Promise.reject("Channel service is not available"))}))}}var Ov=function(e,t,n,r){var o={authService:e,appService:t,channelService:n,telemetryService:r};this.authConfigActivity=new bv(o),this.silentAuthActivity=new yv(o),this.botInvokeActivity=new Cv(o)},Sv=function(){function e(e){this.clientInfo=e}return e.prototype.getUserContext=function(){if(!this.userInfo){var e=this.clientInfo;this.userInfo={dataResidency:this.getDataResidency(e.physicalRing),id:e.aadUserId,displayName:e.userName}}return this.userInfo},e.prototype.getHostContext=function(){if(!this.hostInfo){var e=this.clientInfo;this.hostInfo={host:{clientType:We.b.web,name:We.c.office,sessionId:e.sessionId,version:"1.0"},locale:e.locale,sessionId:e.sessionId,theme:We.d.default}}return this.hostInfo},e.prototype.getDataResidency=function(e){switch(e){case"dod":return oi.d.DOD;case"doj":return oi.d.DOJ;default:return oi.d.Public}},e}(),Ev=n(3473),xv=n(298),Iv=function(){function e(e){this.pluginConfigService=e}return e.prototype.getApp=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.pluginConfigService.executeOperation({type:Ev.a.GetPluginDefinition})];case 1:return"Success"!==(null==(t=r.sent())?void 0:t.status)?[2,void 0]:(n=wv(t.pluginDefinitions),[2,{titleInfo:null==n?void 0:n.find((function(t){return t.appId===e.id}))}]);case 2:return r.sent(),[2,void 0];case 3:return[2]}}))}))},e}(),wv=function(e){return Array.isArray(e)?e.map((function(e){return wv(e)})):null!=e&&e.constructor===Object?Object.keys(e).reduce((function(t,n){var o;return Object(r.__assign)(Object(r.__assign)({},t),((o={})[Object(xv.camelCase)(n)]=wv(e[n]),o))}),{}):e},Tv=n(1467),kv=n(1811),jv=function(){function e(e){this.pluginConfigService=e}return e.prototype.botInvoke=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this.processRequest(e),n={type:Ev.a.GetBotResult,botRequest:t},[4,this.pluginConfigService.executeOperation(n)];case 1:return"Success"!==(null==(o=r.sent())?void 0:o.status)?[2,void 0]:(i=o.botResult,o.botResult.Error?[2,{type:kv.a.Error,value:{errorCode:i.Error.HttpCode,errorMessage:i.Error.Message}}]:[2,{type:kv.a.Result,value:i.response}]);case 2:return r.sent(),[2,void 0];case 3:return[2]}}))}))},e.prototype.processRequest=function(e){var t,n,r,o,i,a={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(Tv.generateGuid)(),scenario:{name:"M365CardSDK"}};return e.requestBody.appName&&(a.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(a.request.imDisplayName=e.requestBody.imdisplayname),a},e}(),Pv=n(1790),Av=function(){function e(e){this.clientInfo=e,this.selectedAccount=null,this.msalApp=new Pv.a({auth:{clientId:"d2eb9fef-f34c-40ec-b6a3-4bf524065158",authority:"https://login.microsoftonline.com/common",redirectUri:new URL("/owa/extSSO.aspx",window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}return e.prototype.getToken=function(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a,s,l=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),(null==(n=this.msalApp.getAllAccounts())?void 0:n.length)>=1&&(this.clientInfo?this.selectedAccount=null!==(t=n.find((function(e){var t;return e.username===(null===(t=l.clientInfo)||void 0===t?void 0:t.userPrincipalName)})))&&void 0!==t?t:null:this.selectedAccount=n[0]),this.selectedAccount||this.signInRequestPromise||(o=this.clientInfo?{loginHint:this.clientInfo.userPrincipalName}:void 0,this.signInRequestPromise=this.msalApp.loginPopup(o)),this.signInRequestPromise?[4,this.signInRequestPromise]:[3,2];case 1:(i=r.sent())&&(this.selectedAccount=i.account),this.signInRequestPromise=void 0,r.label=2;case 2:if(!this.selectedAccount)throw new Error("Failed to acquire token - No account found.");return a={scopes:["".concat(e.resource,"/.default")],account:this.selectedAccount},[4,this.msalApp.acquireTokenSilent(a)];case 3:return(s=r.sent())?[2,{authToken:s.accessToken}]:[3,5];case 4:return r.sent(),this.signInRequestPromise=void 0,[3,5];case 5:return[2]}}))}))},e}(),_v=function(){function e(e,t){var n=this;this.pluginConfigService=e,this.chatHistoryEnabledPluginsSource=t,this.plugins=void 0,this.pluginsLoadingPromise=void 0,this.telemetryLoggerUtils=yg.getInstance(),this.logFailure=function(e){n.telemetryLoggerUtils.sendTelemetryErrorData([{key:L.ErrorMessage,value:e},{key:L.ErrorType,value:U.Server},{key:L.ErrorCode,value:gh.AugloopPluginProviderFailure},{key:L.ErrorCategory,value:ug.Augloop}])}}return e.prototype.getPlugins=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return[2,e.sent()]}}))}))},e.prototype.getPluginsGrouped=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return e=t.sent(),[2,e.map((function(e){return{groupHeaderPlugin:e,plugins:[e]}}))]}}))}))},e.prototype.setPlugin=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return this.plugins=Object(xv.unionBy)(this.plugins,[e],"id"),[2,Promise.resolve()]}))}))},e.prototype.getEnabledPlugins=function(){return this.plugins?this.plugins.filter((function(e){return e.isEnabled})).map((function(e){return{id:e.id,source:e.source}})):[]},e.prototype.getOrLoadPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return this.plugins?[2,this.plugins]:this.pluginsLoadingPromise?[2,this.pluginsLoadingPromise]:(this.pluginsLoadingPromise=this.loadPlugins(),[4,this.pluginsLoadingPromise]);case 1:return e=t.sent(),this.plugins=e,this.pluginsLoadingPromise=void 0,[2,e]}}))}))},e.prototype.loadPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.getInstalledPlugins(),this.getChatHistoryEnabledPlugins()])];case 1:return e=r.__read.apply(void 0,[o.sent(),2]),t=e[0],n=e[1],t?(t.forEach((function(e){e.isEnabled=n.has(e.id)})),[2,t]):[2,void 0]}}))}))},e.prototype.getInstalledPlugins=function(){var e,t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.pluginConfigService.executeOperation({type:Ev.a.GetPluginConfig})];case 1:return"Success"!==(null==(n=r.sent())?void 0:n.status)?(this.logFailure("GetPluginConfig operation failed"),[2,void 0]):[2,null!==(t=null===(e=n.installedPlugins)||void 0===e?void 0:e.PluginGroups.flatMap(Dv))&&void 0!==t?t:[]];case 2:return o=r.sent(),this.logFailure("Exception in getInstalledPlugins: "+o.message),[2,void 0];case 3:return[2]}}))}))},e.prototype.getChatHistoryEnabledPlugins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.chatHistoryEnabledPluginsSource.awaitChatHistoryPlugin()];case 1:return e=n.sent(),[2,new Set(e)];case 2:return t=n.sent(),this.logFailure("Exception in getChatHistoryEnabledPlugins: "+t.message),[2,new Set];case 3:return[2]}}))}))},e}();function Dv(e){return(null==e?void 0:e.PluginDescriptions)?e.PluginDescriptions.map((function(t){return function(e,t){var n,r,o,i,a,s;if(!t.CopilotPluginInfo.Id)return;var l=null!==(n=e.DisplayName)&&void 0!==n?n:t.DisplayName;if(!l)return;return{icon:null!==(i=null!==(o=null!==(r=e.IconUrl)&&void 0!==r?r:e.IconBase64)&&void 0!==o?o:t.IconUrl)&&void 0!==i?i:t.IconBase64,name:l,metaOSAppId:e.MetaOSAppId,id:null!==(a=t.CopilotPluginInfo.Id)&&void 0!==a?a:e.MetaOSAppId,state:e.IsDisabledByAdmin?"blocked":"acquired",source:null!==(s=t.CopilotPluginInfo.Source)&&void 0!==s?s:"",type:Lv(t.CopilotPluginInfo.Id),isEnabled:!1,rank:0}}(e,t)})).filter((function(e){return!!e})):[]}function Lv(e){return e?e.includes("MessageExtension")?"MsgExt":e.includes("BingWebSearch")?"FirstParty":e.includes("DataVerse")?"DataVerse":e.includes("PowerPlatform")?"PowerPlatform":"Unsupported":"Unsupported"}var Mv=n(3472),Bv=function(){function e(){this.requestByQueryId=new Map}return e.prototype.executeOperation=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a=this;return Object(r.__generator)(this,(function(r){return t=function(e){var t=new Mv.a({operation:e,queryId:Object(ag.a)()}),n=yg.getInstance(),r=new kh.b({parentPath:["Signal",Mv.a.getTypeName()],items:[{id:jh.a.generateId(),body:t}]}),o=e.type;return n.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.PluginConfigSignalSent},{key:D.ChatEventParameters,value:"".concat(Mv.a.getTypeName(),"_").concat(o)}]),nb("Submitting signal to Augloop : ".concat(Mv.a.getTypeName()," signal: ").concat(JSON.stringify(t))),Of.getInstance().submitOperation(r,rg.a.getTypeName()),t}(e),n=new Rv,this.requestByQueryId.set(t.queryId,n),o=n.completion.then((function(){return!0})),i=Ig(6e4).then((function(){return!1})),[2,Promise.race([o,i]).then((function(r){return r?n.completion:(a.requestByQueryId.delete(t.queryId),Promise.reject("Timeout executing operation ".concat(e.type)))}))]}))}))},e.prototype.onOperationResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e}(),Rv=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),Fv=function(){function e(){this.current=void 0,this.pending=void 0,this.resolvePending=void 0}return e.prototype.awaitChatHistoryPlugin=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){return this.current?[2,this.current]:(e=this.pending||this.initPendingPromise(),t=e.then((function(){return!0})),n=Ig(6e4).then((function(){return!1})),[2,Promise.race([t,n]).then((function(t){return t?e:Promise.reject("Timeout during awaiting chat history plugins")}))])}))}))},e.prototype.onChatHistoryPluginInfo=function(e){var t;this.current=e.map((function(e){return e.id})),null===(t=this.resolvePending)||void 0===t||t.call(this,this.current)},e.prototype.initPendingPromise=function(){var e=this;return this.pending=new Promise((function(t){e.resolvePending=t}))},e}(),Nv=function(){function e(e,t,n,o,i,a){var s=this;this.getTransformFileSuggestionText=function(){var e,t;if(s.zqmProps)try{for(var n=Object(r.__values)(s.zqmProps.promptSuggestionList),o=n.next();!o.done;o=n.next()){var i=o.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Bg},this.chatInputRef=e,this.handleSubmit=t,this.isExecuting=n,this.chatEditor=o,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=i,this.setChatInputStateExpanded=a}return e.prototype.handleZQMButtonClick=function(e,t){var n,o,i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.isExecuting?[2]:(Df(Bg),hg.getInstance().sendLoggingEventToClient($p.ZQMButtonItemClicked),a=this.zqmProps.promptSuggestionList.find((function(e){return e.suggestionText==t})),s=e,l=Bg,[4,this.setChatInputStateExpanded()]);case 1:return r.sent(),(null==a?void 0:a.shouldSubmitQueryOnClick)?(this.handleSubmit({text:s,telemetryData:M.ZQMButtonClicked}),[2]):(t===this.transformFileSuggestionText&&(l=this.transformFilePlaceholderText),null===(n=this.chatInputRef.current)||void 0===n||n.setInputText(s),null===(o=this.chatInputRef.current)||void 0===o||o.setFocus(),t===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.updateInputText(El,uu.InsertAtCursor)}),1),null===(i=this.chatInputRef.current)||void 0===i||i.setGhostText(l),[2])}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t,iconRegular:e.iconRegular}})),handleButtonClick:this.handleZQMButtonClick}},e}(),Hv=null,Uv=null,Vv=null,zv=!1,Gv=!1,Wv="",Qv="",qv=0,Kv=o.forwardRef((function(e,t){var n,i,a,s,l,u,d,p,g,h,f,m,v,b,y,C,O,S,E,w,T,B,F,N,H,V=e.style,z=e.platformType,G=void 0===z?Q.web:z,W=e.copilotCommunicationHandler,q=e.copilotTelemetryHandler,K=void 0===q?new vg:q,Z=e.theme,J=void 0===Z?jf:Z,X=e.themeV2,$=void 0===X?void 0:X,ee=e.useALRuntime,ne=void 0!==ee&&ee,re=e.chatUiProps,oe=e.designerProps,ie=e.basicChatProps,se=e.debugProps;Y=G;var le=null!==(n=re.chatInputProps)&&void 0!==n?n:re.chatInputV2Props,ce=re.chatInputV2Props,ue=re.clientInfoProps?re.clientInfoProps.clientInfo:mt(),de=null!==(i=null==ce?void 0:ce.shouldInitializeEditorInChatInput)&&void 0!==i&&i,pe=hg.getInstance(W),ge=yg.getInstance(),he=Object(r.__read)(Object(o.useState)(!1),2),fe=he[0],me=he[1],ve=void 0!==$,be=om(),ye=im();am(ve?ye:be,V);var Ce=Object(r.__read)(Object(o.useState)([]),2),Oe=Ce[0],Se=Ce[1],Ee=Object(r.__read)(Object(o.useState)(hh.Shy),2),xe=Ee[0],Ie=Ee[1],we=new Uh(Se,W),Te=Object(o.useRef)(),ke=Object(o.useRef)(null),je=Object(o.useRef)(null),Pe=Object(o.useRef)(null),Ae=Object(o.useRef)(!1),_e=Object(r.__read)(Object(o.useState)(),2),De=_e[0],Le=_e[1],Me=Object(o.useRef)(0),Be=Object(o.useRef)(),Re=Object(r.__read)(Object(o.useState)(!1),2),Fe=Re[0],Ne=Re[1],Ue=Object(r.__read)(Object(o.useState)(!1),2),Ve=Ue[0],ze=Ue[1],Ge=Object(r.__read)(Object(o.useState)(!1),2),We=Ge[0],Qe=Ge[1],qe=Object(r.__read)(Object(o.useState)(!0),2),Ke=qe[0],Ye=qe[1],Ze=Object(r.__read)(Object(o.useState)(!1),2),Je=Ze[0],Xe=Ze[1],$e=Object(r.__read)(Object(o.useState)([]),2),et=$e[0],tt=$e[1],nt=Object(r.__read)(Object(o.useState)(!1),2),rt=nt[0],ot=nt[1],it=Object(r.__read)(Object(o.useState)({loadingUiStringList:Kf(),shouldShowLoadingUi:!0}),2),at=it[0],st=it[1],lt=Object(r.__read)(Object(o.useState)({headerText:Bg,descriptionText:Bg}),2),ct=lt[0],ut=lt[1],dt=re.tipCardProps,pt=Object(r.__read)(Object(o.useState)(!1),2),gt=pt[0],ht=pt[1],ft=Object(r.__read)(Object(o.useState)(!1),2),vt=ft[0],bt=ft[1],yt=Object(r.__read)(Object(o.useState)(jf),2),Ct=yt[0],Ot=yt[1],St=Object(r.__read)(Object(o.useState)(Pf),2),Et=St[0],xt=St[1],It=Object(r.__read)(Object(o.useState)(!1),2),wt=(It[0],It[1]),Tt=Object(r.__read)(Object(o.useState)(void 0!==re.freUiProps),2),kt=Tt[0],jt=Tt[1],Pt=Object(r.__read)(Object(o.useState)(!1),2),At=Pt[0],_t=Pt[1],Dt=Object(r.__read)(Object(o.useState)(um.Uninitialized),2),Lt=Dt[0],Mt=Dt[1],Bt=Object(r.__read)(Object(o.useState)(!1),2),Rt=Bt[0],Ft=Bt[1],Nt=Object(r.__read)(Object(o.useState)(!1),2),Ut=Nt[0],Vt=Nt[1],zt=Object(o.useRef)(!1),Gt=Object(o.useRef)(),Wt=Object(r.__read)(Object(o.useState)(!1),2),Qt=Wt[0],qt=Wt[1],Kt=ne,Yt=o.useRef(),Jt=Object(r.__read)(Object(o.useState)(),2),Xt=Jt[0],$t=Jt[1],en=Object(r.__read)(Object(o.useState)(),2),tn=en[0],nn=en[1],rn=Object(r.__read)(o.useState(!1),2),on=rn[0],an=rn[1],ln=Object(r.__read)(o.useState([]),2),cn=ln[0],un=ln[1],dn=Object(r.__read)(Object(o.useState)(!1),2),pn=dn[0],gn=dn[1],hn=Object(r.__read)(Object(o.useState)(!1),2),fn=hn[0],mn=hn[1],vn=Object(r.__read)(Object(o.useState)(!1),2),yn=vn[0],Cn=vn[1],On=Object(r.__read)(Object(o.useState)([]),2),Sn=On[0],En=On[1],xn=Object(r.__read)(Object(o.useState)(re.copilotWorkflowProps),2),wn=xn[0],Tn=xn[1],kn=Object(r.__read)(Object(o.useState)(0),2),jn=kn[0],Pn=kn[1],An=Object(r.__read)(Object(o.useState)(!1),2),_n=An[0],Dn=An[1],Ln=Object(o.useRef)(!1),Mn=Object(o.useRef)(),Bn=Object(o.useRef)(!0),Rn=o.useRef(void 0),Fn=new Yf,Nn=new Qf,Hn=null===(a=re.toggleUiProps)||void 0===a?void 0:a.trySydneyToggleEnabled,Un=null===(s=re.toggleUiProps)||void 0===s?void 0:s.tryEnterpriseSearchToggleEnabled,Vn=null===(l=re.toggleUiProps)||void 0===l?void 0:l.tryWebSearchToggleEnabled,zn=new $f,Gn=new Cm,Wn=new qf(re.hintCardProps),Qn=new Em,qn=function(){var e;return de?null===(e=Te.current)||void 0===e?void 0:e.getChatEditorInstance():Xt},Kn=!!(null===(u=re.copilotWorkflowProps)||void 0===u?void 0:u.enableWorkflowPlugin)&&re.copilotWorkflowProps.enableWorkflowPlugin,Yn=null!==(p=null===(d=null==le?void 0:le.voiceInputProps)||void 0===d?void 0:d.handleInChatInput)&&void 0!==p&&p,Zn=null!==(g=re.zeroQueryMessageProps)&&void 0!==g?g:re.zeroQueryMessageV2Props,Jn=re.copilotLabProps;J=null!=J?J:$;var Xn=function(){var e,t,n,r,o;nb("handleEditorOpenButtonClick"),Ln.current=!0;var i=El,a=null!==(e=null==$n?void 0:$n.ciqPlaceholderText)&&void 0!==e?e:yh;null===(t=Te.current)||void 0===t||t.setInputText(i),null===(n=Te.current)||void 0===n||n.setGhostText(a),null===(r=Te.current)||void 0===r||r.setFocus(),null===(o=qn())||void 0===o||o.forceInvokeCIQMenu(El)};(null==le?void 0:le.voiceInputProps)&&Tb()&&(le.voiceInputProps=void 0);var $n=null==le?void 0:le.editorConfig,er=Object(o.useRef)(new em(Ne,st,we,Te,qn(),Xe,$n?$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg:null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage,Ve));Ph.isDevbuild()&&(null==se?void 0:se.isDebugToggleEnabled)&&ym.initialize();var tr,nr=!0,rr=Object(o.useRef)(function(e,t,n){if(void 0===n&&(n=!1),Rf)return Rf;var r=[],o={origin:window.location.origin,columnSize:6,title:Tg()?OfficeaicopilotStrings.CopilotPromptLibraryHeader:"Copilot Lab",copilotLabButtonText:Tg()?OfficeaicopilotStrings.CopilotLabLaunchertext:"Go to Copilot Lab",copilotLabLink:"https://copilot.cloud.microsoft/prompts",prompts:[],bookmarks:[],facets:{displayCategory:[]},selectedFacets:{},width:55,height:55,isDarkMode:n,locale:Ph.getLanguage(),isHeaderDisabled:!1,onDialogLaunched:function(){nb("dialog launched!"),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabDialogLaunched}])},onPromptClicked:function(t){nb("prompt clicked",t),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabPromptItemClicked},{key:D.ChatEventParameters,value:"".concat(t.DisplayCategory)}]),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabDialogClosed}]),Df(t.PromptId),e.current.setInputAreaText(t.CommandText)},onFavoriteToggled:function(e,t){nb("favorited toggle favorited: ".concat(t,", prompt: "),e),Of.getInstance().submitOperation(ff(pf.b.UserActivity,e.PromptId,t),Sh.a.getTypeName());var n=o.prompts.map((function(n){var r=n;return e.Id===n.Id&&((r=e).UserActivity.Favorite.IsFavorite=t),r}));o.prompts=n,yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabSavedPromptClicked},{key:D.ChatEventParameters,value:t?fh.Favourite:fh.Unfavourite}]),r.forEach((function(e){return e({prompts:n})}))},onDialogDismissed:function(){nb("dialog dismissed"),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabDialogClosed}]),t.current.setMenuButtonFocus()},onFilterChanged:function(e){nb("filters changed",e)},onShowOnlyFavoriteToggled:function(e){nb("show only favorited toggled ".concat(e))},onGoToCopilotLabClicked:function(){nb("on go to copilot lab clicked"),yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabGoToCopilotLabButtonClicked}])}};return Rf={register:function(e){return r.push(e),o},unregister:function(){},updateColumnSize:function(e){o.columnSize=e,r.forEach((function(t){return t({columnSize:e})}))},updateTitle:function(e){o.title=e,r.forEach((function(t){return t({title:e})}))},updateCopilotLabButtonText:function(e){o.copilotLabButtonText=e,r.forEach((function(t){return t({copilotLabButtonText:e})}))},updateCopilotLabLink:function(e){o.copilotLabLink=e,r.forEach((function(t){return t({copilotLabLink:e})}))},updatePrompts:function(e){o.prompts=e,r.forEach((function(t){return t({prompts:e})}))},updateBookmarks:function(e){o.bookmarks=e,r.forEach((function(t){return t({bookmarks:e})}))},updateFacets:function(e){o.facets=e,r.forEach((function(t){return t({facets:e})}))},updateSelectedFacets:function(e){o.selectedFacets=e,r.forEach((function(t){return t({selectedFacets:e})}))},updateDarkMode:function(e){o.isDarkMode=e,r.forEach((function(t){return t({isDarkMode:e})}))},updateLocale:function(e){o.locale=e,r.forEach((function(t){return t({locale:e})}))},updateIsHeaderDisabled:function(e){o.isHeaderDisabled=e,r.forEach((function(t){return t({isHeaderDisabled:e})}))}}}(er,Te,J.isDarkModeEnabled));Object(o.useImperativeHandle)(t,(function(){return{addResponseMessage:er.current.addResponseMessage,updateMessage:er.current.updateMessage,resendChatHistorySignal:er.current.resendChatHistorySignal,updateLastMessage:er.current.updateLastMessage,deleteMessage:er.current.deleteMessage,submitOperation:er.current.submitOperation,updateLoadingComponentProps:er.current.updateLoadingComponentProps,addChatMessages:er.current.addChatMessages,getLastMessage:function(e){if(Me.current>0)return Oe[pb(Oe,e)]},clearMessages:er.current.clearMessages,startLoadingUi:er.current.startLoadingUi,startReinitializeALSession:er.current.startReinitializeALSession,setInputAreaText:er.current.setInputAreaText,setInputFocus:er.current.setInputFocus,getInputText:er.current.getInputText}}));var or=function(e,t,n){we.setChatMessageData(e,t,n)},ir=function(){var e;return de?null===(e=Te.current)||void 0===e?void 0:e.getCIQResponseHandler():tn},ar=function(){var e;return de?null===(e=Te.current)||void 0===e?void 0:e.getCIQTextRef():Gt.current},sr=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return ar()?e?[4,$n.getSensitivityInfo(e)]:[3,2]:[3,4];case 1:return n=r.sent(),[3,3];case 2:n=null,r.label=3;case 3:t=n,gn(!1),ar().setSensitivity(t),Qe(!1),r.label=4;case 4:return[2]}}))}))},lr=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return ar()?[4,$n.getSensitivityInfo(null)]:[3,2];case 1:e=t.sent(),ar().setSensitivity(e),gn(!1),t.label=2;case 2:return[2]}}))}))},cr=function(){var e;return(null===(e=Te.current)||void 0===e?void 0:e.getInputText())||""},ur=function(){var e;null===(e=ke.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},dr=function(e){return void 0===e&&(e=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,vr(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),nb("Exception occurred during initialization of AL"+t.message),[3,3];case 3:return[2]}}))}))},pr=function(e){var t,n,r,o,i,a,s,l;if(e){ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophoneLoadingTimeInMs},{key:D.ChatEventParameters,value:Zv(sm)}]);var c=(null===(t=Te.current)||void 0===t?void 0:t.getInputText().length)>0&&nr?" ":Bg;null===(n=Te.current)||void 0===n||n.setGhostText(c+bh())}else(null===(r=Te.current)||void 0===r?void 0:r.getInputText())===Bg?null===(o=Te.current)||void 0===o||o.setGhostText(null!==(i=null==le?void 0:le.chatPlaceholderMessage)&&void 0!==i?i:Hg):(null===(s=null===(a=Te.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())===bh()&&(null===(l=Te.current)||void 0===l||l.setGhostText(Bg));Vt(e),zt.current=e};Object(o.useEffect)((function(){if(W.isFeatureGateEnabledFromClient(uh.IsChatHistoryPaginationEnabled)){var e=Pe.current;if(e){var t=0,n=!0,o=function(){Pe.current.scrollHeight-Math.round(Pe.current.scrollTop)-10<=Pe.current.clientHeight?n=!1:!Ae.current&&lf&&!n&&Math.round(e.scrollTop)<=Math.round(Pe.current.scrollHeight/3)&&t!=e.scrollHeight&&(Cn(!0),t=e.scrollHeight,Pn(t),Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,uf(ng.c.GetMessagesOperation,void 0,void 0,W)];case 1:return e.sent(),[2]}}))}))),lf||e.removeEventListener("scroll",o)};e.addEventListener("scroll",o)}}}),[Pe.current,Ke]),Object(o.useEffect)((function(){var e;(null==(e=re.documentSensitivityProps)?void 0:e.isEncrypted)?yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CLPEncryptedLabelSent}]):yg.getInstance().sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CLPNonEncryptedLabelSent}]),$h=e}),[re.documentSensitivityProps]),Object(o.useEffect)((function(){ar()||(Qe(!1),gn(!1))}),[ar]),Object(o.useEffect)((function(){Tn((function(e){return Object(r.__assign)(Object(r.__assign)({},e),re.copilotWorkflowProps)}))}),[re.copilotWorkflowProps]),Object(o.useEffect)((function(){ur()}),[null===(h=re.streamingUiProps)||void 0===h?void 0:h.cardDataValue,cn,Fe,at]),Object(o.useEffect)((function(){Fe?pe.sendLoggingEventToClient($p.QueryExecutionStarted):(Df(Bg),pe.sendLoggingEventToClient($p.QueryExecutionCompleted),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.QueryExecutionCompleted}]),Wv="")}),[Fe]),Object(o.useEffect)((function(){!kt&&(null==Zn?void 0:Zn.promptSuggestionList.length)>0&&(pe.sendLoggingEventToClient($p.ZQMLoaded),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ZQMLoaded}]))}),[kt]),Object(o.useEffect)((function(){return Be.current=new Ph(W.getHostSettings()),rr.current.updateLocale(Ph.getLanguage()),yg.setTelemetryHandler(K),Hv=kf.getInstance(),If.getInstance().initTelemetryLatencyObject(),pe.sendLoggingEventToClient($p.ChatPaneInitalized,{timestamp:(new Date).getTime()}),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatPaneInitialized},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),wh.getInstance(W),hb()?nf.getInstance(Ye,mn):Ye(!1),dr(),qv=0,W.updateCopilotState(Yp.IDLE),Rn.current=new Jf(Te,hr,null==le?void 0:le.chatPlaceholderMessage,or,un),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatInputEarlyLoadEnabled},{key:D.ChatEventParameters,value:W.isFeatureGateEnabledFromClient(uh.ChatInputEarlyLoadEnabled)?"true":"false"}]),function(e){x=e}(void 0!==$),function(){Bh.getInstance().clearAugloopResponseTimer()}}),[]),Object(o.useEffect)((function(){Je&&(dr(!0),Xe(!1))}),[Je]),Object(o.useEffect)((function(){var e;Ut||ru(pr).catch((function(e){nb("pauseMicandStopTimer Error"+e),Lh.Instance.ErrorMessage="Error_PauseMic_StopTimer"})),null===(e=Te.current)||void 0===e||e.setFocus()}),[Ut]),Object(o.useEffect)((function(){window.addEventListener("blur",(function(){var e;null===(e=Te.current)||void 0===e||e.closeMenu(),Hr(),(null==le?void 0:le.voiceInputProps)&&zt.current&&pr(!1)}))})),Object(o.useEffect)((function(){yn?Fe||(Pe.current.scrollTop=Pe.current.scrollHeight-jn):ur(),Cn(!1),Me.current=Oe.length,kt&&Oe.length>0&&jt(!1)}),[Oe,kt]),Object(o.useEffect)((function(){Ke||(ur(),zv&&(ge.sendTelemetryLatencyData([{key:_.ChatHistoryTimeInLoad,value:Yv(Xh)}]),W.sendEventToClient(Xp.CopilotChatLoaded),pe.sendLoggingEventToClient($p.ChatPaneLoaded,{timestamp:(new Date).getTime()}),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatPaneLoaded},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}])),!kt&&(null==Zn?void 0:Zn.promptSuggestionList.length)>0&&(pe.sendLoggingEventToClient($p.ZQMLoaded),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ZQMLoaded}])))}),[Ke]),Object(o.useEffect)((function(){fn&&(W.sendEventToClient(Xp.ChatHistoryHydrationFailed),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatHistoryHydrationFailed}]),Ae.current=fn)}),[fn]),Object(o.useEffect)((function(){var e;J.isDarkModeEnabled?(I(c.defaultBlack),Xt&&Xt.updateCurrentTheme($s.dark)):(I(c.defaultWhite),Xt&&Xt.updateCurrentTheme($s.light)),Kn&&Xt&&(null===(e=null==re?void 0:re.copilotWorkflowProps)||void 0===e?void 0:e.enableEditorForSelectFileStage)&&Tn((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{handleEditorOpenButtonClick:Xn})})),J.isHighContrastModeEnabled?k(!0):k(!1),Ot(J),xt($),rr.current.updateDarkMode(J.isDarkModeEnabled)}),[J,Xt]),Object(o.useEffect)((function(){var e,t;((null===(e=null==re?void 0:re.suggestionPillsUiProps)||void 0===e?void 0:e.clearCacheSuggestionPills)||(null===(t=null==re?void 0:re.suggestionPillsUiProps)||void 0===t?void 0:t.suggestionList.length)>0)&&Rn.current.setSuggestedQnAList([])}),[null==re?void 0:re.suggestionPillsUiProps]),Object(o.useEffect)((function(){we&&Ne&&W&&(Mh.getInstance(we,W,Ne),Mh.getInstance().setBasicChatProps(ie))}),[ie]),Object(o.useEffect)((function(){var e;Qt&&ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.TrySydneyToggle},{key:D.ChatEventParameters,value:(null===(e=re.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[Qt]),Object(o.useEffect)((function(){var e;ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.IsSydneyEnabled},{key:D.ChatEventParameters,value:(null===(e=re.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[null===(f=re.toggleUiProps)||void 0===f?void 0:f.trySydneyToggleChecked]),Object(o.useEffect)((function(){if(!de&&$n&&!Yt.current&&De){var e=(new Dc).createInstance();$n.telemLogger.logErrorTelemetry=function(e,t){ge.sendTelemetryErrorData([{key:L.ErrorMessage,value:t},{key:L.ErrorCategory,value:e}])},$n.telemLogger.logSuccessTelemetry=function(e,t){t?ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:e},{key:D.ChatEventParameters,value:t}]):ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:e}])},e.bootstrap(rb($n,De)).then((function(t){Yt.current=e,$t(t)}))}return function(){Yt.current&&Yt.current.shutdown().then((function(){Yt.current=void 0}))}}),[De]),Object(o.useEffect)((function(){bt((null==dt?void 0:dt.isError)&&(null==dt?void 0:dt.headerText)&&!kt&&!Fe)}),[dt,kt,Fe]),Object(o.useEffect)((function(){ze(Fe||(null==dt?void 0:dt.isError)||(null==le?void 0:le.isDisabled)||(null==ce?void 0:ce.isDisabled))}),[Fe,dt,le,ce]),Object(o.useEffect)((function(){var e;ce&&(null==ce?void 0:ce.groundingSourcePickerProps)&&!(null===(e=null==ce?void 0:ce.buttonProps)||void 0===e?void 0:e.groundingButtonEnabled)&&(Dn(!0),W.isFeatureGateEnabledFromClient(uh.DisableXPIAMitigationFix)||(_h=!0))}),[ce]),Object(o.useEffect)((function(){er.current.setIsDisabled(Ve)}),[Ve]),Object(o.useEffect)((function(){(null==Jn?void 0:Jn.copilotLabLink)&&rr.current.updateCopilotLabLink(null==Jn?void 0:Jn.copilotLabLink),(null==Jn?void 0:Jn.isCopilotLabHeaderDisabled)&&rr.current.updateIsHeaderDisabled(null==Jn?void 0:Jn.isCopilotLabHeaderDisabled),(null==Jn?void 0:Jn.facets)&&rr.current.updateFacets(null==Jn?void 0:Jn.facets)}),[Jn]),Object(o.useEffect)((function(){if(rr.current.updatePrompts(et),!(null==Jn?void 0:Jn.facets)){var e=(t=[],n=[],et.forEach((function(e){e.DisplayCategory&&!n.includes(e.DisplayCategory)&&n.push(e.DisplayCategory)})),n.forEach((function(e){t.push({value:e})})),t);rr.current.updateFacets({displayCategory:e})}var t,n}),[et]);var gr=function(e){return!!Gr()&&(nb("Setting pane load warning banner as chat history is still loading."),At||_t(!0),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ChatPaneLoadMessageBarShown},{key:D.ChatEventParameters,value:e.toString()}]),!0)},hr=function(e){var t=e.text,n=e.links,o=e.telemetryData,i=e.queryAnnotations;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,a,s,l,c,u,d;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return t&&0!==t.length||0!==cr().length?(Wv=Object(ag.a)(),qv++,Vv=(new Date).getTime(),Bn.current&&(nb("First Query submitted by User"),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.FirstQuerySubmitted},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),yg.getInstance().sendTelemetryLatencyData([{key:_.IsFirstSdxSessionQuery,value:!0}]),Bn.current=!1),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:null!=o?o:M.EnterKeyPressed},{key:D.ChatEventParameters,value:(new Date).getTime().toString()}]),_f!==Bg&&ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CopilotLabPromptSubmitted}]),(null==i?void 0:i.length)>0&&(e=i.map((function(e){return e.QueryAnnotationType})),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.PromptSubmittedWithCIQ},{key:D.ChatEventParameters,value:JSON.stringify(e)}])),st((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),W.updateCopilotState(Yp.QUERY_ENTERED),W.sendEventToClient(Xp.QuerySubmitted),Lh.Instance.NewChatInitiated(),qt(!0),(null==le?void 0:le.voiceInputProps)&&pr(!1),a=t?t.trim():cr().trim(),Qv=a,function(e){var t;null===(t=Te.current)||void 0===t||t.setGhostText(e)}(null!==(u=null==le?void 0:le.chatPlaceholderMessage)&&void 0!==u?u:Hg),kt&&jt(!1),nb("User query Entered : ".concat(a)),function(e){var t;null===(t=Te.current)||void 0===t||t.setInputText(e)}(Bg),G===Q.IOS&&Ie(hh.Shy),ht(!1),wt(!1),Ne(!0),or(P.Default,{defaultMessageProps:fb(a,n)}),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.QuerySubmittedByUser},{key:D.IsMicrophoneInvolvedInQueryInput,value:eb.toString()}]),tb(!1),[4,W.shouldSendRequestToAugloop(a,n,i)]):[2];case 1:return p.sent()?a!==Wg()||(null===(d=re.changeTopicUiProps)||void 0===d?void 0:d.hideChangeTopicButton)?[3,3]:(Gv=!0,st((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{loadingUiStringList:[Kf()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,uf(ng.c.AddChatOperation)]):(Ne(!1),[2]);case 2:return p.sent(),[2];case 3:return p.trys.push([3,7,,8]),zv?[3,5]:[4,Cr()];case 4:p.sent(),p.label=5;case 5:return s=W.isFeatureGateEnabledFromClient(uh.IsCopilotPluginEnabled)?jr.getEnabledPlugins():[],[4,W.getDefaultSignalOperation(a,Wv,af,n,i,s)];case 6:return l=p.sent(),Bh.getInstance().setAugloopResponseTimer(l.workflowAnnotationType),Of.getInstance().submitOperation(l.operation,l.workflowAnnotationType),W.updateCopilotState(Yp.QUERY_SUBMITTED),nb("successfully submitted operation to AL : \n\n\n"+JSON.stringify(l.operation)+"\nat Time : "+new Date+"\n\n\n"),[3,8];case 7:return c=p.sent(),nb("CopilotChat Log: Exception:"+JSON.stringify(c)+" Error message: "+c.message),Ne(!1),Lh.Instance.ErrorMessage="Exception_Query_Submission_Failed",W.updateCopilotState(Yp.QUERY_SUBMITTED_FAILED),Bh.getInstance().clearAugloopResponseTimer(),or(P.Default,{defaultMessageProps:{user:sh.Chat,messageHeader:{text:"".concat("I'm still learning and can't do this just yet. Is there something else I can do to help")},embeddedLists:[]}}),W.updateCopilotState(Yp.IDLE),ge.sendTelemetryErrorData([{key:L.ErrorMessage,value:"Error in handle submit: "+c.message},{key:L.ErrorType,value:U.Client},{key:L.ErrorCode,value:gh.HandleSubmitError},{key:L.ErrorCategory,value:A.ChatEvents}]),ge.sendTelemetryLatencyData([{key:_.UserPerceivedLatency,value:Yv(Vv)},{key:_.IsQuerySuccess,value:!1}],!0),[3,8];case 8:return[2]}}))}))},fr=function(e){ut(Wn.getProps(e)),ht(Wn.shouldShowHintCard(e))},mr=function(){W.sendEventToClient(Xp.ChatTopicChanged),Gv=!1,Ne(!1)},vr=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=(new Date).getTime(),Uv=t,Kt?[3,2]:[4,W.getALSession()];case 1:return n=i.sent(),Le(n),[3,5];case 2:return[4,db(W.getAuthToken(),!1)];case 3:return[4,i.sent().getSession()];case 4:n=i.sent(),Le(n),i.label=5;case 5:Of.getInstance(W,n),Bh.getInstance(W,lr),Mh.getInstance(we,W,Ne),Mh.getInstance().setBasicChatProps(ie),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return ce&&W.isFeatureGateEnabledFromClient(uh.IsPersistanceInPhase2UxEnabled)&&ce.pluginsInfo&&ce.pluginsInfo.length?[4,Vf(ce.pluginsInfo,jr,W.isFeatureGateEnabledFromClient(uh.IsEnterpriseSearchDefaultOn))]:[2];case 1:return e=t.sent(),En(e),[2]}}))})),ge.sendTelemetryLatencyData([{key:_.AugloopInitializationTime,value:Yv(t)}]),pe.sendLoggingEventToClient($p.ALSessionInitialized,{timeInMs:Zv(t)}),i.label=6;case 6:return i.trys.push([6,10,,11]),[4,Cr(e)];case 7:return i.sent(),Yn?[3,9]:[4,xr(n)];case 8:i.sent(),i.label=9;case 9:return nb("Augloop Initialized. Time Taken : ".concat(Yv()," sec")),[3,11];case 10:throw o=i.sent(),nb("Failure in Augloop Initialization: "+JSON.stringify(o)+" Error message: "+o.message),ge.sendTelemetryErrorData([{key:L.ErrorMessage,value:"Failure in Augloop Initialization: "+o.message},{key:L.ErrorType,value:U.Client},{key:L.ErrorCode,value:gh.AugloopInitializationError},{key:L.ErrorCategory,value:A.Augloop}]),o;case 11:return[2]}}))}))};function br(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,l,c,u,d;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:nb("sharedAugloopAnnotationHandler op: ",e),p.label=1;case 1:p.trys.push([1,20,21,22]),o=Object(r.__values)(e.items),i=o.next(),p.label=2;case 2:if(i.done)return[3,19];switch(a=i.value,Lh.Instance.Observe(a.body),s=null===(t=a.body)||void 0===t?void 0:t.H_,ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALAnnotationReceived},{key:D.ChatEventParameters,value:null!==(n=null==s?void 0:s.T_)&&void 0!==n?n:Bg}]),null==s?void 0:s.T_){case R.a.getTypeName():case R.c.getTypeName():case R.b.getTypeName():return[3,3];case og.b.getTypeName():return[3,4];case og.a.getTypeName():return[3,7];case og.c.getTypeName():return[3,10];case Sh.a.getTypeName():return[3,13];case ig.a.getTypeName():return[3,15];case rg.a.getTypeName():return[3,17]}return[3,18];case 3:return df(a,Se,Me.current,W,Gv?mr:void 0,(function(e){return kr.onChatHistoryPluginInfo(e)})),[3,18];case 4:return[4,W.shouldIgnoreResponse(a)];case 5:return p.sent()?[2]:[4,fm(a,we,Ne,Vv)];case 6:return p.sent(),[3,18];case 7:return[4,W.shouldIgnoreResponse(a)];case 8:return p.sent()?[2]:[4,hm(a,we,Ne,Vv)];case 9:return p.sent(),[3,18];case 10:return[4,W.shouldIgnoreResponse(a)];case 11:return p.sent()?[2]:[4,bm(a,Rn.current)];case 12:return p.sent(),[3,18];case 13:return[4,mf(a,tt)];case 14:return p.sent(),[3,18];case 15:return[4,Sm(a,sr)];case 16:return p.sent(),[3,18];case 17:l=a.body,Tr.onOperationResponse(l.queryId,l.operationResponse),p.label=18;case 18:return i=o.next(),[3,2];case 19:return[3,22];case 20:return c=p.sent(),u={error:c},[3,22];case 21:try{i&&!i.done&&(d=o.return)&&d.call(o)}finally{if(u)throw u.error}return[7];case 22:return[2]}}))}))}function yr(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,l,c,u;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:nb("clientSpecificAugloopAnnotationHandler op: ",e),d.label=1;case 1:d.trys.push([1,7,8,9]),o=Object(r.__values)(e.items),i=o.next(),d.label=2;case 2:return i.done?[3,6]:(a=i.value,s=null===(t=a.body)||void 0===t?void 0:t.H_,ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.ALAnnotationReceived},{key:D.ChatEventParameters,value:null!==(n=null==s?void 0:s.T_)&&void 0!==n?n:Bg}]),wh.getInstance().isWorkflowRegistered(null==s?void 0:s.T_)?wh.getInstance().isAugloopResponseTimeoutRequired(null==s?void 0:s.T_)?[4,W.shouldIgnoreResponse(a)]:[3,4]:[3,5]);case 3:if(d.sent())return[2];Bh.getInstance().clearAugloopResponseTimer(),d.label=4;case 4:Lh.Instance.Observe(a.body),W.sendResponseToClient(a),d.label=5;case 5:return i=o.next(),[3,2];case 6:return[3,9];case 7:return l=d.sent(),c={error:l},[3,9];case 8:try{i&&!i.done&&(u=o.return)&&u.call(o)}finally{if(c)throw c.error}return[7];case 9:return[2]}}))}))}var Cr=function(e){return void 0===e&&(e=!1),Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=(new Date).getTime(),Uv=t,n=[],[4,null===(s=null===(a=W.getHostSettings())||void 0===a?void 0:a.getDocumentUrlAsync)||void 0===s?void 0:s.call(a)];case 1:return o=r.sent(),wh.getInstance().getWorkflowDataMap(e).forEach((function(e){nb("send activate annotation request for workflow: ",e.workflowInfo.workflowAnnotationType),n.push(Of.getInstance().activateAnnotation(e.workflowInfo.workflowAnnotationType,e.workflowInfo.shouldHandleResponse?br:yr,e.workflowInfo.config,o,e.workflowInfo.forceReturnCachedAnnotations))})),[4,Promise.all(n)];case 2:return r.sent(),zv=!0,Ke||W.sendEventToClient(Xp.CopilotChatLoaded),ge.sendTelemetryLatencyData([{key:_.AnnotationActivationTime,value:Yv(t)}]),pe.sendLoggingEventToClient($p.AnnotationActivated,{timeInMs:Zv(t)}),nb("AnnotationActivationTime. Time Taken :  ".concat(Yv()," sec")),[3,4];case 3:throw i=r.sent(),zv=!1,nb("Failed to activate annotations: ".concat(i.message)),ge.sendTelemetryErrorData([{key:L.ErrorMessage,value:"Failure in Activating Annotation: "+i.message},{key:L.ErrorType,value:U.Server},{key:L.ErrorCode,value:gh.ActivateAnnotationError},{key:L.ErrorCategory,value:A.Augloop}]),i;case 4:return[2]}}))}))},Or=function(e){var t,n,r,o,i,a;if(!(!zt.current||Fe||null!=Te.current&&(null===(t=Te.current)||void 0===t?void 0:t.getInputText().length)>=(re.chatInputProps?Lg:Mg))){tb(!0);var s=(null===(n=Te.current)||void 0===n?void 0:n.getInputText().length)>0&&nr?" ":Bg,l=null!=Te.current?(null===(r=Te.current)||void 0===r?void 0:r.getInputText())+s+e:Bg;null===(o=Te.current)||void 0===o||o.setInputText(l),null===(i=Te.current)||void 0===i||i.setGhostText(Bg),null===(a=Te.current)||void 0===a||a.setFocus(),nb("final text passing here: "+e)}},Sr=function(e){var t,n,r;if(!(!zt.current||Fe||null!=Te.current&&(null===(t=Te.current)||void 0===t?void 0:t.getInputText().length)>=(re.chatInputProps?Lg:Mg))){var o=(null===(n=Te.current)||void 0===n?void 0:n.getInputText().length)>0&&nr?" ":Bg;null===(r=Te.current)||void 0===r||r.setGhostText(o+e),nb("ghost text passing here: "+e),tb(!0),e.trim()&&iu(zg,pr),nb("Voice response - Partial Text: "+e)}},Er=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){Ie(hh.Expanded),e()}))];case 1:return e.sent(),[2]}}))}))},xr=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(null==le?void 0:le.voiceInputProps)?(t=(new Date).getTime(),n=lu(le.voiceInputProps.voiceInputLocale),[4,$c(n,Or,Sr,Mt,pr,e)]):[3,2];case 1:r.sent(),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophoneInitializationTimeInMs},{key:D.ChatEventParameters,value:Zv(t).toString()}]),nr=cu(lu(n)),ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.MicrophoneSuccessfullyInitialized}]),r.label=2;case 2:return[2]}}))}))},Ir=function(e){W.isFeatureGateEnabledFromClient(uh.IsClpSensitivityInChatInputEnabled)&&"File"===(null==e?void 0:e.type)&&(gn(!0),Qe(!0),function(e){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){return t=yg.getInstance(),n=new Om.a({type:e.type,id:e.url}),o=new kh.b({parentPath:["Signal",Om.a.getTypeName()],items:[{id:jh.a.generateId(),body:n}]}),nb("Submitting signal to Augloop : ".concat(Om.a.getTypeName()," signal: ").concat(JSON.stringify(n))),t.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.EntityLabelOperationSubmitted},{key:D.ChatEventParameters,value:"".concat(Om.a.getTypeName(),"_").concat(o)}]),Of.getInstance().submitOperation(o,Om.a.getTypeName()),[2]}))}))}(e))},wr=new lm(Ut,Rt,Lt,null===(m=null==le?void 0:le.voiceInputProps)||void 0===m?void 0:m.microphonePermissionErrorTitle,null===(v=null==le?void 0:le.voiceInputProps)||void 0===v?void 0:v.microphonePermissionErrorMessage,Ft,Mt,pr,Te,null!==(b=null==le?void 0:le.chatPlaceholderMessage)&&void 0!==b?b:Hg,null===(y=null==le?void 0:le.voiceInputProps)||void 0===y?void 0:y.microphonePermissionImagePath,null===(C=null==le?void 0:le.voiceInputProps)||void 0===C?void 0:C.showMicrophonePermissionHelpLink,gr),Tr=o.useMemo((function(){return new Bv}),[]),kr=o.useMemo((function(){return new Fv}),[]),jr=o.useMemo((function(){return new _v(Tr,kr)}),[Tr,kr]),Pr=void 0,Ar=void 0;if(W.isFeatureGateEnabledFromClient(uh.IsCopilotPluginEnabled)){var _r=o.useMemo((function(){return new Av(ue)}),[ue]),Dr=o.useMemo((function(){return new Sv(ue)}),[ue]),Lr=o.useMemo((function(){return new Qm(Dr.getUserContext(),Dr.getHostContext(),_r)}),[Dr,_r]),Mr=o.useMemo((function(){return new Iv(Tr)}),[Tr]),Br=o.useMemo((function(){return new jv(Tr)}),[Tr]),Rr=o.useMemo((function(){return new Ov(Lr,Mr,Br)}),[Lr,Mr,Br]);Ar={cardServices:{appService:Mr,channelService:Br,tokenService:_r},activityProvider:Rr},Pr=new sv(jr,Rr,(function(){}),(function(){}),void 0,Mr)}var Fr=(null==ce?void 0:ce.groundingSourcePickerProps)?Object(r.__assign)(Object(r.__assign)({},null==ce?void 0:ce.groundingSourcePickerProps),{onSelection:function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return function(e){Ah=e}(t.id.toString()),null===(n=null==e?void 0:e.onSelection)||void 0===n||n.call(e,t),!_n||W.isFeatureGateEnabledFromClient(uh.DisableXPIAMitigationFix)?[3,2]:[4,uf(ng.c.AddChatOperation)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}}(null==ce?void 0:ce.groundingSourcePickerProps)}):void 0,Nr=re.chatInputProps?new Hf(Te,Ve,kt,jt,re.menuProps,hr,fr,qn(),Er,$n&&$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg,$n?$n.ciqPlaceholderText?$n.ciqPlaceholderText:yh:Bg,an,ir(),W,null==le?void 0:le.chatPlaceholderMessage,(null==le?void 0:le.voiceInputProps)?wr.getMicrophoneButtonProps():void 0):new Gf(Te,vb(Ct),(Et||Ct).isDarkModeEnabled,null!==(O=(Et||Ct).dir)&&void 0!==O?O:void 0,Ve,We,kt,jt,W,null==ce?void 0:ce.menuProps,hr,fr,qn(),$n?$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg:(null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage)?null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage:Bg,$n?$n.ciqPlaceholderText?$n.ciqPlaceholderText:yh:Bg,an,ir(),null==ce?void 0:ce.chatPlaceholderMessage,(null==ce?void 0:ce.voiceInputProps)?Object(r.__assign)(Object(r.__assign)({},null==ce?void 0:ce.voiceInputProps),{alSession:De,microphoneButtonProps:wr.getMicrophoneButtonProps()}):void 0,null===(S=null==ce?void 0:ce.buttonProps)||void 0===S?void 0:S.ciqButtonEnabled,null===(E=null==ce?void 0:ce.buttonProps)||void 0===E?void 0:E.groundingButtonEnabled,Fr,function(){var e;if(ce&&ce.pluginsInfo)return(null==Sn?void 0:Sn.length)?null===(e=ce.pluginsInfo)||void 0===e?void 0:e.map((function(e){return e.state=Sn.includes(e.id)?Pc.Blocked:e.state,e})):ce.pluginsInfo}(),gr,W.isFeatureGateEnabledFromClient(uh.IsCopilotPluginEnabled)?{pluginProvider:Pr}:void 0,de?{editorConfig:$n,alSession:De,handleInChatInput:de,postCIQItemSelectionHandler:Ir}:void 0,pn,null==ce?void 0:ce.isVersion3Enabled);G===Q.IOS&&(tr=new Wf(Te,Ve,kt,jt,re.menuProps,hr,fr,Xt,Er,$n&&$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg,W,null!==(T=null!==(w=null==le?void 0:le.chatRestShyPlaceholderMessage)&&void 0!==w?w:null==ce?void 0:ce.chatRestShyPlaceholderMessage)&&void 0!==T?T:"Ask a question"));var Hr=function(){var e;G===Q.IOS&&(null===(e=Te.current)||void 0===e?void 0:e.getInputText())===Bg&&Ie(hh.Shy)};function Ur(){if(fe)1==window.devicePixelRatio&&me(!1);else{var e=document.getElementById(Ch);if(e)e.getBoundingClientRect().height<=0&&me(!0)}}Object(o.useEffect)((function(){var e;null===(e=ar())||void 0===e||e.setLoading(pn)}),[pn]),Object(o.useEffect)((function(){return Ur(),window.addEventListener("resize",Ur),function(){window.removeEventListener("resize",Ur)}})),Object(o.useEffect)((function(){if(!de&&Xt&&tn&&!on&&(Xt.uninitialize(El),nn(void 0)),qn()&&(er.current=new em(Ne,st,we,Te,qn(),Xe,$n?$n.ciqPlaceholderText?$n.ciqPlaceholderText:yh:null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage,Ve)),!de&&$n&&on&&!tn&&Xt&&Te.current){var e=Xt.initializeCiq(Te.current.getInputSpanElement(),{menuTitle:$n.transformFileMenuTitle,menuSubtitle:$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg,queryCharToUse:El,onItemSelected:function(t){var n,r,o,i,a,s,l,c;if(ge.sendTelemetryChatEventData([{key:D.ChatEventType,value:M.CIQSuggestionSelected},{key:D.ChatEventParameters,value:null!==(o=null===(r=null===(n=t.suggestion)||void 0===n?void 0:n.queryAnnotation)||void 0===r?void 0:r.QueryAnnotationType)&&void 0!==o?o:Bg}]),Ln.current)return null===(i=Mn.current)||void 0===i||i.addUserContentMessageItem(jb(t.suggestion),!0),Ln.current=!1,void(null===(a=Te.current)||void 0===a||a.setGhostText(null!==(s=null==le?void 0:le.chatPlaceholderMessage)&&void 0!==s?s:Hg));null===(l=Te.current)||void 0===l||l.setGhostText(Bg),null===(c=Te.current)||void 0===c||c.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,pn,vb(Ct),(Et||Ct).isDarkModeEnabled,Gt),Ir(t.suggestion)},entitiesEnabled:$n.entitiesSupported,ExpanededECC:$n.isExpandedECCEnabled});nn(e)}}),[Xt,tn,on]);var Vr=new Xf(Te,hr,fr,Ve,qn(),$n?$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg:(null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage)?null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage:Bg,Er),zr=new Nv(Te,hr,Ve,Xt,$n?$n.transformFilePlaceholderText?$n.transformFilePlaceholderText:Bg:(null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage)?null==ce?void 0:ce.transfromFileNonCIQPlaceholderMessage:Bg,Er),Gr=function(){return W.isFeatureGateEnabledFromClient(uh.ChatInputEarlyLoadEnabled)&&Ke};return!W.isFeatureGateEnabledFromClient(uh.ChatInputEarlyLoadEnabled)&&Ke?o.createElement(j,{theme:Ct},o.createElement("div",null,o.createElement(fc.a,{appearance:"primary",className:be.spinner}))):o.createElement(Pb,{theme:$?Et:Ct,shouldUseFluentV9Tokens:ve,dir:$?Et.dir:Ct.dir},o.createElement(te,{style:fe?be.chatUiStackZoom:be.chatUiStack},Gr()&&o.createElement(Tm,{className:fe?be.chatFreStackZoom:be.chatFreStack}),Vn&&o.createElement(ae,Object(r.__assign)({},zn.getTryWebChatProps(rt,(function(e,t){var n=null==t?void 0:t.checked;nb("Toggling Try Web chat to "+(n?"on":"off")),ot(null!=n&&n)}),"Try Web Chat"))),rt&&o.createElement("iframe",{src:null!==(F=null===(B=null==re?void 0:re.toggleUiProps)||void 0===B?void 0:B.webSearchUrl)&&void 0!==F?F:"https://edgeservices.bing.com/edgesvc/chat?udsframed=1&form=SHORUN&clientscopes=chat,noheader,udsedgeshop,channelcanary,ntpquery,devtoolsapi,udsinwin11,clipboardcontext,udsdlpconsent,udscstart,cspgrd&lightschemeovr=1",title:"Web Chat",height:"100%",allow:"clipboard-write;microphone;camera"}),!rt&&o.createElement(o.Fragment,null,!Ke&&o.createElement(o.Fragment,null,Hn&&re.toggleUiProps&&o.createElement(ae,Object(r.__assign)({},zn.getTrySydneyProps(re.toggleUiProps,Qt,"Try Sydney"))),Un&&re.toggleUiProps&&o.createElement(ae,Object(r.__assign)({},zn.getTryEnterpriseSearchProps(re.toggleUiProps,!1,"Enterprise Search Mode"))),Ph.isDevbuild()&&(null==se?void 0:se.isDebugToggleEnabled)&&o.createElement(He,Object(r.__assign)({},Gn.getDebugSectionProps((function(){var e,t;return null!==(t=null===(e=ym.getInstance())||void 0===e?void 0:e.getLogs())&&void 0!==t?t:""}),null!==(N=null==se?void 0:se.conversationId)&&void 0!==N?N:"",null==se?void 0:se.telemetryData))),o.createElement(Sl.a,{id:Ch,className:fe?be.chatFreStackZoom:be.chatFreStack,ref:Pe},Kn&&o.createElement(Zt,Object(r.__assign)({ref:Mn},wn)),kt?o.createElement(sn,Object(r.__assign)({},Nn.getProps((function(){jt(!1)}),re.freUiProps))):(null==Zn?void 0:Zn.promptSuggestionList.length)>0&&(re.zeroQueryMessageProps?o.createElement(bn,Object(r.__assign)({},Vr.getProps(re.zeroQueryMessageProps))):o.createElement(In,Object(r.__assign)({},zr.getProps(re.zeroQueryMessageV2Props)))),o.createElement("div",{ref:je}),Oe.length>0&&o.createElement(ha,Object(r.__assign)({},we.getProps(Oe,re.chatContainerUiProps),{designerProps:oe,customMessageRenderers:re.customMessageRenderers,pluginServiceProvider:Ar})),function(){var e;return!Fe&&Oe.length>0&&!(null===(e=re.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)}()&&o.createElement(ba,Object(r.__assign)({},Qn.getProps((function(){Df(Bg),nb("Change Topic Button Clicked."),Rn.current.setSuggestedQnAList([]),hr({text:Wg()})})))),Fe&&(null===(H=at.shouldShowLoadingUi)||void 0===H||H)&&o.createElement(Ht,Object(r.__assign)({},Fn.getProps(at,(function(){Mh.getInstance().getIsBasicChatStreaming()&&(Mh.getInstance().updateCardWithFooter(),Mh.getInstance().resetBasicChatStreamingStates(!0,!1)),Lh.Instance.ErrorMessage="Stop_Generation_Clicked",Ne(!1),W.sendEventToClient(Xp.StopGeneratingButtonClicked),Bh.getInstance().clearAugloopResponseTimer(),Of.getInstance().clearOperationListForResubmit(),W.updateCopilotState(Yp.IDLE),nb("Stop Generation Button Clicked.")})))),o.createElement("div",{ref:ke})),function(){var e,t;return!Ve&&((null===(t=null===(e=null==re?void 0:re.suggestionPillsUiProps)||void 0===e?void 0:e.suggestionList)||void 0===t?void 0:t.length)>0||cn.length>0)&&(nb("Suggestion Pills are shown"),!0)}()&&o.createElement(ka,Object(r.__assign)({},Rn.current.getProps(re.suggestionPillsUiProps,cn))),gt&&o.createElement(Na,Object(r.__assign)({},ct)),G===Q.IOS&&xe===hh.Shy&&!Fe&&tr&&o.createElement(ps,Object(r.__assign)({},tr.getProps((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Er()];case 1:return t.sent(),null===(e=Te.current)||void 0===e||e.setFocus(),[2]}}))}))})))),vt&&o.createElement(ms,Object(r.__assign)({},dt))),Gr()&&At&&o.createElement("div",{className:be.paneLoadMessageContainer},o.createElement(xm.c,{className:be.paneLoadWarningIcon}),o.createElement("div",{className:be.paneLoadWarningLabel},Tg()?OfficeaicopilotStrings.PaneLoadingUIString:"Please wait for the pane to finish loading")),re.chatInputProps?(G!=Q.IOS||xe===hh.Expanded&&!Fe)&&o.createElement(Ol,Object(r.__assign)({ref:Te},Nr.getProps(Hr))):o.createElement(tg,Object(r.__assign)({ref:Te},Nr.getProps(et))))))}));Kv.displayName="CopilotChat";var Yv=function(e){return((new Date).getTime()-(null!=e?e:Uv))/1e3},Zv=function(e){return(new Date).getTime()-(null!=e?e:Uv)},Jv=n(723);function Xv(){var e=$v();return Object(Jv.a)(e,"OPR/")||Object(Jv.a)(e,"Opera")?"Opera":Object(Jv.a)(e,"PhantomJS")?"PhantomJS":Object(Jv.a)(e,"Edg")?"Edge":Object(Jv.a)(e,"Electron")?"Electron":Object(Jv.a)(e,"Chrome")?"Chrome":Object(Jv.a)(e,"Trident")?"MSIE":Object(Jv.a)(e,"Firefox")?"Firefox":Object(Jv.a)(e,"Safari")?"Safari":Object(Jv.a)(e,"SkypeShell")?"SkypeShell":"Unknown"}var $v=function(){var e;return null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent},eb=!1,tb=function(e){eb=e},nb=function(e,t){if(Ph.isDevbuild()){var n=ym.getInstance();null==t?(console.log("CopilotChat Log:",e),null==n||n.addLog("CopilotChat Log:",e)):(console.log("CopilotChat Log:",e,t),null==n||n.addLog("CopilotChat Log:",e,t))}},rb=function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{augloopSession:t})},ob=function(){var e={};return Object.keys(_).forEach((function(t){e[t]=0})),e},ib=function(e){return e[_.UserQueryGuid]=Wv,e[_.CopilotChatSessionId]=Ph.getSessionId(),{eventType:A.Latency,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},ab=function(e){return e[D.UserQueryGuid]=Wv,e[D.CopilotChatSessionId]=Ph.getSessionId(),e[D.UserQueryOrder]=qv,{eventType:A.ChatEvents,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},sb=function(e){return e[W.UserQueryGuid]=Wv,e[W.HostSDXSessionID]=Ph.getSessionId(),e[W.UserQueryOrder]=qv,{eventType:A.QueryDetails,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},lb=function(){var e={};return Object.keys(D).forEach((function(t){e[t]=""})),e},cb=function(){var e,t,n,r=null===(n=null===(e=window.getSelection)||void 0===e?void 0:(t=e.call(window)).getRangeAt)||void 0===n?void 0:n.call(t,0).startOffset;return r||0===r?r:-1},ub=function(){var e=window.getSelection();return e?e.isCollapsed:(nb("window.getSelection() returned null"),!1)},db=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.e(2).then(n.bind(null,1062))];case 1:return o=r.sent(),t||(i={serviceUrl:Ph.getAugloopUrl(),appName:Ph.getAppName(),appVersion:Ph.getAppVersion(),authToken:e,releaseAudienceGroup:null,releaseChannel:null,releaseFork:null,flights:Ph.getAugloopFlights()},o.StartInitializingRuntimeManage(i)),[4,o.EnsureAugloopRuntimeManager()];case 2:return[2,r.sent()]}}))}))},pb=function(e,t){var n,r;void 0===t&&(t=!0);var o=e.length-1;return e.length>=2&&(e[o].messageType===P.FeedbackNudge||"human"===(null===(r=null===(n=t&&e[o])||void 0===n?void 0:n.body)||void 0===r?void 0:r.user))&&(o=e.length-2),o};function gb(e){return null==e}var hb=function(){return wh.getInstance().isWorkflowRegistered(R.c.getTypeName())||wh.getInstance().isWorkflowRegistered(R.b.getTypeName())||wh.getInstance().isWorkflowRegistered(R.a.getTypeName())},fb=function(e,t){var n={user:sh.Human,messageHeader:{}};if(null==t?void 0:t.length){var o=t[0],i=0,a=Object(r.__read)(o.range,2),s=a[0],l=a[1];s+=i,l+=i,i+=4,n.messageHeader={text:e.slice(0,s),linkText:{text:e.slice(s,l+1),linkSuffix:e.slice(l+1),linkUrl:o.value,linkOnClick:mb}}}else n.messageHeader={text:"".concat(e)};return n},mb=function(e){e&&window.open(e,"_blank")};function vb(e){var t=Object.keys(e).filter((function(e){return"themeBackground"!==e})).reduce((function(t,n){var r;return Object.assign(t,((r={})[n]=e[n],r))}),{});return t}var bb,yb,Cb,Ob,Sb,Eb,xb,Ib,wb,Tb=function(){return Pg[Xv()]===Pg.Safari},kb=function(e){var t=e,n=!1;return e.includes("<entity")?(t=e.slice(0,e.indexOf("<entity")),n=!0):e.includes("<placeholder")&&(t=e.slice(0,e.indexOf("<placeholder"))),{inputSpanText:t,isFileEntityPresent:n}},jb=function(e){var t=Oh;return(null==e?void 0:e.url)&&((null==e?void 0:e.url.includes("docx"))?t=Oh:(null==e?void 0:e.url.includes("pptx"))?t="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg":(null==e?void 0:e.url.includes("xlsx"))&&(t="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg")),{iconUrl:t,boldText:null==e?void 0:e.text}},Pb=function(e){if(!e.shouldUseFluentV9Tokens)return nb("Fluent V8 Custom Tokens enabled"),i.a.createElement(j,{theme:e.theme,dir:e.dir},e.children);if(e.shouldUseFluentV9Tokens&&e.theme)return nb("Fluent V9 supported tokens enabled"),i.a.createElement(B,Object(r.__assign)({},Ab(e.theme,e.dir)),e.children);throw new Error("Exception: Please ensure a compatible V9 Theme is passed to the ThemeProvider")},Ab=function(e,t){return void 0===t&&(t=void 0),{shouldUseV9Tokens:!0,theme:e,dir:t}},_b=Object(Te.a)(y),Db={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{boxShadow:_b.shadow4,color:_b.neutralPrimary,backgroundColor:_b.neutralLight}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",_b.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),stepperRoot:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:"#ecf3fc"},re.a.margin("10px")),re.a.borderRadius("0px")),{boxShadow:"none",maxHeight:"100vh"}),re.a.flex("0 0 2%")),{position:"relative",display:"flex",flexDirection:"column",height:"95%"}),stepperListRoot:{position:"relative",height:"95%",paddingTop:"15px"},selectionIndicator:{height:"60%",width:"3px",backgroundColor:"#494eee",marginRight:"10px",marginBottom:"12px"},stepperListItem:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"row",alignItems:"center"},re.a.border("none")),{boxShadow:"none",justifyContent:"space-between",backgroundColor:"transparent",height:"40px"}),textAndIcon:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"row",alignItems:"left"},re.a.border("none")),{boxShadow:"none",justifyContent:"flex-start",backgroundColor:"transparent",height:"40px"}),text:{whiteSpace:"nowrap",minWidth:"105px",paddingLeft:"12px",paddingRight:"12px",cursor:"default"},checkmark:{paddingBottom:"12px",paddingRight:"10px"},panelIcon:{position:"relative",bottom:0,left:0,alignContent:"bottom"}},Lb=Object(X.a)(Db),Mb=Object(Fn.eb)({padding:2,margin:"10px 0"}),Bb=[{type:rd.a.line,width:140,height:24}],Rb=function(){return i.a.createElement("div",null,i.a.createElement(od.a,{className:Mb,shimmerElements:Bb}),i.a.createElement(od.a,{className:Mb,shimmerElements:Bb}),i.a.createElement(od.a,{className:Mb,shimmerElements:Bb}),i.a.createElement(od.a,{className:Mb,shimmerElements:Bb}))},Fb=function(){var e,t=Lb(),n=i.a.useContext(a),s=null==n?void 0:n.operaState,l=(null==n||n.setOperaState,null==n?void 0:n.operaStepperLabelIndex);console.log("StepperMenu: operaState: ",s);var c=Object(r.__read)(Object(o.useState)(!0),2),u=c[0],p=c[1],g=null==s?void 0:s.currentSkillName,f=null!==(e=null==l?void 0:l[g])&&void 0!==e?e:0,m=f,v=function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})};return i.a.createElement("div",{"aria-labelledby":"Stepper-Menu",className:t.stepperRoot},i.a.createElement("div",{className:t.stepperListRoot},s?i.a.createElement(i.a.Fragment,null,s.operaStepsData.map((function(e,n){var r,o,a,s,l;return i.a.createElement("div",{key:n,onClick:function(){},className:t.stepperListItem,style:n==f?{}:{paddingLeft:"15px"}},n==f&&i.a.createElement("div",{className:t.selectionIndicator}),i.a.createElement("div",{className:t.textAndIcon},i.a.createElement("div",null,(null!==(r=e.stepperIcon)&&void 0!==r?r:h[e.stepperLabel])&&(n==f?v(null!==(o=e.stepperIconSelected)&&void 0!==o?o:h[e.stepperLabel].iconSelected,null!==(a=e.stepperIconSelected)&&void 0!==a?a:h[e.stepperLabel].iconSelected):v(null!==(s=e.stepperIcon)&&void 0!==s?s:h[e.stepperLabel].icon,null!==(l=e.stepperIcon)&&void 0!==l?l:h[e.stepperLabel].icon))),u&&i.a.createElement("div",{className:t.text},n===f?i.a.createElement("b",null,e.stepperLabel):e.stepperLabel)),i.a.createElement("div",{className:t.checkmark},u&&n<m&&v(ze.i,ze.i,{color:"green"})))}))):i.a.createElement(Rb,null)),i.a.createElement("div",{onClick:function(){p(!u)},className:t.panelIcon},v(d.b,d.b)))},Nb=Object(Te.a)(y),Hb={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{boxShadow:Nb.shadow4,color:Nb.neutralPrimary,backgroundColor:Nb.neutralLight,width:"100%"}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",Nb.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),fileItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px",display:"flex",backgroundColor:"#e9f2ff"}),re.a.borderRadius("8px")),re.a.padding("0px","10px","0px","10px")),{boxShadow:Nb.shadow4}),addFileButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("4px")),{backgroundColor:Nb.neutralLight}),re.a.border("1px","dotted","#4FC3F7")),addFileButtonText:Object(r.__assign)({},re.a.gap("4px")),fileCheckBox:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px")),fileIcon:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px")),workflowStepStack:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.gap("10px")),re.a.padding("10px","8px","20px","8px")),re.a.overflow("hidden")),cardHeader:Object(r.__assign)(Object(r.__assign)({},vt.a.largeTitle),{fontSize:"24px",whiteSpace:"pre-wrap",fontWeight:"bold"}),cardContent:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{whiteSpace:"pre-wrap"}),filePickerButtonItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:Nb.neutralLight},re.a.border("1px","solid",Nb.neutralLighterAlt)),vt.a.body1),(bb={},bb["&:hover .".concat(bt.a.icon)]={color:Nb.themePrimary},bb)),filePickerButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},re.a.padding("0px","15px")),{backgroundColor:Nb.neutralLight}),re.a.border("1px","solid",Nb.neutralLighterAlt)),vt.a.body1),(yb={},yb["&:hover .".concat(bt.a.icon)]={color:Nb.themePrimary},yb)),filePickerFilesList:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center"},re.a.gap("20px")),{height:"fit-content"}),re.a.padding("0px","15px")),re.a.border("none")),vt.a.body1),(Cb={},Cb["&:hover .".concat(bt.a.icon)]={color:Nb.themePrimary},Cb.display="flex",Cb.flexWrap="wrap",Cb.paddingTop="24px",Cb)),filePickerButtonDisabled:(Ob={color:Nb.neutralQuaternary},Ob["&:hover .".concat(bt.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},Ob),leftAlignedText:Object(r.__assign)({textAlign:"left"},re.a.padding("0px","8px")),thumbnail:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px")),actionButtonStack:Object(r.__assign)({marginTop:"8px"},re.a.gap("12px"))},Ub=Object(X.a)(Hb),Vb=function(){return Ub()},zb="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",Gb="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",Wb="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",Qb="#e9f2ff",qb="#fef5f3",Kb="#ebf9f0",Yb=new Map([["Word",{iconUrl:zb,itemColor:Qb}],["docx",{iconUrl:zb,itemColor:Qb}],["xlsx",{iconUrl:Wb,itemColor:Kb}],["Excel",{iconUrl:Wb,itemColor:Kb}],["pptx",{iconUrl:Gb,itemColor:qb}],["PowerPoint",{iconUrl:Gb,itemColor:qb}],["OneNote",{iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg",itemColor:"#eee7e8"}],["Visio",{iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg",itemColor:Qb}],["Loop",{iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg",itemColor:"#f4f0ff"}],["SharePoint",{iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg",itemColor:Qb}],["Txt",{iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg",itemColor:Qb}]]),Zb=Object(Fn.eb)({padding:2,margin:"10px 0"}),Jb=[{type:rd.a.line,width:"100%",height:24}],Xb=[{type:rd.a.line,width:50,height:24}],$b=[{type:rd.a.line,width:"35%",height:30},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"35%",height:30},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"25%",height:30}],ey=[{type:rd.a.line,width:"25%",height:30},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"35%",height:30},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"35%",height:30}],ty=function(){return i.a.createElement("div",null,i.a.createElement(od.a,{className:Zb,shimmerElements:Jb}),i.a.createElement(od.a,{className:Zb,style:{marginBottom:"20px"},shimmerElements:Xb}),i.a.createElement(od.a,{className:Zb,shimmerElements:$b}),i.a.createElement(od.a,{className:Zb,shimmerElements:ey}))},ny="File Picker",ry="Pills Container",oy=function(){var e=i.a.useContext(a),t=null==e?void 0:e.operaState,n=null==e?void 0:e.setOperaState,o=i.a.useContext(s),l=null==t?void 0:t.operaStepsData.find((function(e){return e.skillName===t.currentSkillName})),c=null==l?void 0:l.component,d=null==c?void 0:c.componentData,p=null==d?void 0:d.list,h=Vb(),f=null==d?void 0:d.title,m=null==d?void 0:d.description,v=null==d?void 0:d.addButtonText,b=null==d?void 0:d.nextButtonText,y=function(){console.log("")};h.filePickerButtonDisabled=Object($.a)(h.filePickerButton,h.filePickerButtonDisabled),h.rootHighContrast=Object($.a)(h.root,h.rootHighContrast);var C=function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})};return i.a.createElement(Ue.a,{className:h.root,"aria-labelledby":ny},f&&i.a.createElement("div",{style:{minWidth:"800px"}},i.a.createElement(xe.a,{id:ny,className:h.cardHeader},f)),(null==l?void 0:l.isALDataAvailable)?i.a.createElement(i.a.Fragment,null,m&&i.a.createElement(ce,null,i.a.createElement(xe.a,{id:ny,className:h.cardContent},m)),i.a.createElement("div",{style:{minHeight:"300px"}},i.a.createElement("div",{key:0,className:h.filePickerFilesList},null==p?void 0:p.map((function(e,t){var o,a;return i.a.createElement("div",{className:h.fileItem,key:t,style:(null===(o=Yb.get(e.contentType))||void 0===o?void 0:o.itemColor)?{backgroundColor:Yb.get(e.contentType).itemColor}:{}},i.a.createElement("div",{onClick:function(){!function(e){n((function(t){for(var n=Object(r.__assign)({},t),o=n.currentSkillName,i=0;i<n.operaStepsData.length;i++)n.operaStepsData[i].skillName===o&&(n.operaStepsData[i].component.componentData.list[e].checked=!n.operaStepsData[i].component.componentData.list[e].checked);return n}))}(t)},className:h.fileCheckBox},e.checked?C(ze.j,ze.j,{color:"green"}):C(At.i,At.i)),(null===(a=Yb.get(e.contentType))||void 0===a?void 0:a.iconUrl)&&i.a.createElement("img",{className:h.thumbnail,src:Yb.get(e.contentType).iconUrl,alt:"",height:20,width:20}),i.a.createElement("div",{className:h.buttonStack},i.a.createElement("b",{style:{cursor:"default"}},i.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit"}},e.name))))}))),v&&i.a.createElement("div",{style:{paddingTop:"20px",paddingBottom:"20px"}},i.a.createElement(se.a,{className:h.addFileButton,onClick:function(){y&&y()}},i.a.createElement("div",{className:h.fileCheckBox},C(u.c,u.c)),i.a.createElement(xe.a,{id:ny,className:h.addFileButtonText},v)))),b&&i.a.createElement("div",null,i.a.createElement(se.a,{appearance:"primary",onClick:function(){o()}},i.a.createElement(xe.a,{id:ny,style:{paddingRight:"5px"}},b),C(g.m,g.m)))):i.a.createElement(ty,null))},iy=Object(Te.a)(y),ay={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{boxShadow:iy.shadow4,color:iy.neutralPrimary,backgroundColor:iy.neutralLight,width:"100%"}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",iy.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),pillItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px",minHeight:"40px",display:"flex",backgroundColor:"#ecefff"}),re.a.borderRadius("1px")),re.a.padding("2px","15px","0px","15px")),{boxShadow:iy.shadow4}),addPillButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.borderRadius("4px")),{backgroundColor:iy.neutralLight}),re.a.border("1px","dotted","#4FC3F7")),addPillButtonText:Object(r.__assign)({},re.a.gap("4px")),pillCheckBox:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px")),pillIcon:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px")),cardHeader:Object(r.__assign)(Object(r.__assign)({},vt.a.largeTitle),{fontSize:"24px",whiteSpace:"pre-wrap",fontWeight:"bold"}),cardContent:Object(r.__assign)(Object(r.__assign)({},vt.a.body1),{whiteSpace:"pre-wrap"}),pillsContainerButtonItem:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:iy.neutralLight},re.a.border("1px","solid",iy.neutralLighterAlt)),vt.a.body1),(Sb={},Sb["&:hover .".concat(bt.a.icon)]={color:iy.themePrimary},Sb)),pillsContainerButton:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},re.a.padding("0px","15px")),{backgroundColor:iy.neutralLight}),re.a.border("1px","solid",iy.neutralLighterAlt)),vt.a.body1),(Eb={},Eb["&:hover .".concat(bt.a.icon)]={color:iy.themePrimary},Eb)),pillsContainerList:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({alignItems:"center"},re.a.gap("20px")),{height:"fit-content"}),re.a.padding("0px","15px")),re.a.border("none")),vt.a.body1),(xb={},xb["&:hover .".concat(bt.a.icon)]={color:iy.themePrimary},xb.display="flex",xb.flexWrap="wrap",xb.paddingTop="24px",xb)),pillsContainerButtonDisabled:(Ib={color:iy.neutralQuaternary},Ib["&:hover .".concat(bt.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},Ib),thumbnail:Object(r.__assign)({},re.a.padding("4px","0px","0px","0px"))},sy=Object(X.a)(ay),ly=Object(Fn.eb)({padding:2,margin:"10px 0"}),cy=[{type:rd.a.line,width:"100%",height:24}],uy=[{type:rd.a.line,width:"50%",height:24}],dy=[{type:rd.a.line,width:"20%",height:40},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"20%",height:40},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"20%",height:40},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"20%",height:40},{type:rd.a.gap,width:"4%"},{type:rd.a.line,width:"20%",height:40}],py=function(){return i.a.createElement("div",null,i.a.createElement(od.a,{className:ly,shimmerElements:cy}),i.a.createElement(od.a,{className:ly,style:{marginBottom:"20px"},shimmerElements:uy}),i.a.createElement(od.a,{className:ly,shimmerElements:dy}),i.a.createElement(od.a,{className:ly,shimmerElements:dy}))},gy=function(){var e=sy(),t=i.a.useContext(a),n=null==t?void 0:t.operaState,o=null==t?void 0:t.setOperaState,l=null==n?void 0:n.operaStepsData.find((function(e){return e.skillName===n.currentSkillName})),c=null==l?void 0:l.component,u=null==c?void 0:c.componentData,d=null==u?void 0:u.list,p=null==u?void 0:u.title,h=null==u?void 0:u.description,f=null==u?void 0:u.addButtonText,m=null==u?void 0:u.nextButtonText,v=i.a.useContext(s),b=function(){console.log("")};return i.a.createElement(Ue.a,{className:e.root,"aria-labelledby":ry},p&&i.a.createElement("div",{style:{minWidth:"800px"}},i.a.createElement(xe.a,{id:ry,className:e.cardHeader},p)),(null==l?void 0:l.isALDataAvailable)?i.a.createElement(i.a.Fragment,null,h&&i.a.createElement(ce,null,i.a.createElement(xe.a,{id:ry,className:e.cardContent},h)),i.a.createElement("div",{style:{minHeight:"300px"}},i.a.createElement("div",{key:0,className:e.pillsContainerList},null==d?void 0:d.map((function(t,n){return i.a.createElement("div",{className:e.pillItem,key:n,style:t.checked?{borderColor:"#4d51e3",borderWidth:"1px",borderStyle:"solid"}:{},onClick:function(){!function(e){o((function(t){for(var n=Object(r.__assign)({},t),o=n.currentSkillName,i=0;i<n.operaStepsData.length;i++)n.operaStepsData[i].skillName===o&&(n.operaStepsData[i].component.componentData.list[e].checked=!n.operaStepsData[i].component.componentData.list[e].checked);return n}))}(n)}},i.a.createElement("div",{className:e.buttonStack},i.a.createElement("b",{style:t.checked?{color:"#4d51e3",cursor:"default"}:{cursor:"default"}},t.name)))}))),f&&i.a.createElement("div",{style:{paddingTop:"20px",paddingBottom:"20px"}},i.a.createElement(se.a,{className:e.addPillButton,onClick:function(){b&&b()}},i.a.createElement(xe.a,{id:ry,className:e.addPillButtonText},f)))),m&&i.a.createElement("div",null,i.a.createElement(se.a,{appearance:"primary",onClick:function(){v()}},i.a.createElement(xe.a,{id:"File",style:{paddingRight:"5px"}},m),function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})}(g.m,g.m)))):i.a.createElement(py,null))},hy=Object(Te.a)(y),fy={root:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.padding("12px")),re.a.borderRadius("8px")),re.a.margin("16px")),{color:hy.neutralPrimary,backgroundColor:"#ecf3fc"}),re.a.margin("0px")),re.a.borderRadius("0px")),{position:"fixed",paddingLeft:"0px"}),re.a.flex("0 0 75%")),{minWidth:0,width:"74%"}),re.a.borderRadius("8px")),{boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"}),rootHighContrast:Object(r.__assign)({},re.a.border("1px","solid",hy.neutralLighterAlt)),buttonStack:Object(r.__assign)(Object(r.__assign)({},re.a.gap("4px")),{marginTop:"8px"}),containerRoot:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",width:"-webkit-fill-available"},re.a.gap("8px")),re.a.margin("0px 4px")),{height:"100%"}),stepperRoot:Object(r.__assign)({minWidth:0},re.a.borderRadius("8px")),componentRoot:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",width:"100%",minWidth:0},re.a.overflow("hidden")),{position:"relative",height:"98vh",marginRight:"4px"}),re.a.borderRadius("8px"))},my=Object(X.a)(fy),vy=n(3408),by=n(3424),yy={fontFamily:"Segoe UI",fontSize:"16px",fontStyle:"normal",fontWeight:"400",lineHeight:"22px"},Cy={checkBoxContainer:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({boxShadow:"0px 0px 2px 0px rgba(0, 0, 0, 0.12), 0px 2px 4px 0px rgba(0, 0, 0, 0.14)"},re.a.border("1px","solid","#e6e6e6")),{backgroundColor:"#fff"}),re.a.padding("12px","15px")),re.a.borderRadius("4px")),{marginBottom:"15px",alignItems:"center",justifyContent:"space-between"}),addMoreContainer:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.a.border("1px","dashed","#9177fa")),{backgroundColor:"#fff"}),re.a.borderRadius("4px")),{marginBottom:"50px"}),addMoreInput:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({width:"100%"},re.a.border("none")),yy),{fontWeight:"600"}),re.a.padding("0","15px")),{"&::after":{display:"none"},"& input":{height:"45px"}}),headerContent:Object(r.__assign)(Object(r.__assign)({},yy),{fontSize:"24px",fontWeight:"600",lineHeight:"32px"}),checkboxItem:Object(r.__assign)(Object(r.__assign)({},yy),{fontWeight:"600",color:"#242424"}),descriptionContent:Object(r.__assign)({},yy)},Oy=Object(X.a)(Cy),Sy=function(){var e,t=i.a.useContext(a),n=null==t?void 0:t.operaState,o=i.a.useContext(s),l=null==t?void 0:t.setOperaState,c=null==n?void 0:n.operaStepsData.find((function(e){return e.skillName===n.currentSkillName})),u=null==c?void 0:c.component,d=null==u?void 0:u.componentData,p=null!==(e=null==d?void 0:d.list)&&void 0!==e?e:[],h=null==d?void 0:d.title,f=null==d?void 0:d.description,m=null==d?void 0:d.nextButtonText,v=Object(r.__read)(i.a.useState(""),2),b=v[0],y=v[1],C=Oy(),O=Vb(),S=p.map((function(e,t){return i.a.createElement(te,{horizontal:!0,style:C.checkBoxContainer,key:"".concat(e.name,"-").concat(t)},i.a.createElement("div",null,i.a.createElement(vy.a,{label:i.a.createElement("span",{className:C.checkboxItem},e.name),name:"".concat(name,"-").concat(t),size:"large",onChange:function(){return function(e){l((function(t){for(var n=Object(r.__assign)({},t),o=n.currentSkillName,i=0;i<n.operaStepsData.length;i++)n.operaStepsData[i].skillName===o&&(n.operaStepsData[i].component.componentData.list[e].checked=!n.operaStepsData[i].component.componentData.list[e].checked);return n}))}(t)},checked:e.checked})),i.a.createElement("div",null,i.a.createElement(Ro.W,null)))}));return i.a.createElement(Ue.a,{className:O.root,"aria-labelledby":"Checkbox Item"},i.a.createElement("h2",{className:C.headerContent},h),(null==c?void 0:c.isALDataAvailable)?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:C.descriptionContent},f),i.a.createElement("div",{style:{minHeight:"300px",overflowY:"auto"}},S,i.a.createElement("div",{className:C.addMoreContainer},i.a.createElement("div",null,i.a.createElement(by.a,{placeholder:"Add More...",className:C.addMoreInput,type:"text",onKeyDown:function(e){"Enter"===e.key&&l((function(e){for(var t=Object(r.__assign)({},e),n=t.currentSkillName,o=0;o<t.operaStepsData.length;o++)t.operaStepsData[o].skillName===n&&t.operaStepsData[o].component.componentData.list.push({name:b,checked:!1});return y(""),t}))},value:b,onChange:function(e,t){y(t.value)}})))),m&&i.a.createElement("div",null,i.a.createElement(se.a,{appearance:"primary",onClick:function(){o()}},i.a.createElement(xe.a,null,m),function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})}(g.m,g.m)))):i.a.createElement(ty,null))},Ey=n(3410),xy=n(3433),Iy=n(3409),wy={fontFamily:"Segoe UI",fontSize:"16px",fontStyle:"normal",fontWeight:"400",lineHeight:"22px"},Ty={headerContent:Object(r.__assign)(Object(r.__assign)({},wy),{fontSize:"24px",fontWeight:"600",color:"#242424"}),descriptionContent:Object(r.__assign)({},wy),radioGroup:{marginBottom:"50px"}},ky=Object(X.a)(Ty),jy=function(){var e=i.a.useContext(a),t=null==e?void 0:e.operaState,n=null==e?void 0:e.setOperaState,o=null==t?void 0:t.operaStepsData.find((function(e){return e.skillName===t.currentSkillName})),l=null==o?void 0:o.component,c=null==l?void 0:l.componentData,u=null==c?void 0:c.list,d=null==c?void 0:c.title,p=null==c?void 0:c.description,h=null==c?void 0:c.nextButtonText,f=i.a.useContext(s),m=Vb(),v=ky(),b=u.map((function(e,t){return i.a.createElement(Ey.a,{value:e.name,label:e.name,key:"radio-form-".concat(t)})}));return i.a.createElement(Ue.a,{className:m.root,"aria-labelledby":"Radio Form"},i.a.createElement("h2",{className:v.headerContent},d),(null==o?void 0:o.isALDataAvailable)?i.a.createElement(i.a.Fragment,null,i.a.createElement(xy.a,{label:i.a.createElement("span",{className:v.descriptionContent},p),style:{marginBottom:"50px"}},i.a.createElement(Iy.a,{onChange:function(e,t){n((function(e){for(var n=Object(r.__assign)({},e),o=n.currentSkillName,i=0;i<n.operaStepsData.length;i++)if(n.operaStepsData[i].skillName===o)for(var a=n.operaStepsData[i].component.componentData.list,s=0;s<a.length;s++)a[s].name===t.value&&(n.operaStepsData[i].component.componentData.list[s].checked=!a[s].checked);return n}))}},b)),h&&i.a.createElement("div",null,i.a.createElement(se.a,{appearance:"primary",onClick:f},i.a.createElement(xe.a,null,h),function(e,t,n){void 0===n&&(n={});var r=Object(Ve.a)(t,e);return i.a.createElement(r,{style:n})}(g.m,g.m)))):i.a.createElement(ty,null))},Py=n(2406),Ay=n.n(Py),_y=function(){return o.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M11.4142 3.63601C11.6095 3.44074 11.6095 3.12416 11.4142 2.9289L9.29289 0.807579C9.09763 0.612317 8.78104 0.612317 8.58578 0.807579C8.39052 1.00284 8.39052 1.31942 8.58578 1.51469L9.58264 2.51154C7.80518 2.61008 6.05488 3.33851 4.69671 4.69668C1.76776 7.62561 1.76776 12.3743 4.69671 15.3033C4.95359 15.5602 5.2247 15.7947 5.50757 16.0068C5.72852 16.1724 6.04191 16.1276 6.20756 15.9066C6.3732 15.6857 6.32838 15.3723 6.10743 15.2067C5.86235 15.0229 5.6271 14.8194 5.40382 14.5962C2.8654 12.0578 2.8654 7.94219 5.40382 5.40378C6.68997 4.11764 8.38002 3.48321 10.0664 3.50031C10.0915 3.50057 10.1162 3.49897 10.1404 3.49564L8.58578 5.05022C8.39052 5.24548 8.39052 5.56206 8.58578 5.75733C8.78104 5.95259 9.09763 5.95259 9.29289 5.75733L11.4142 3.63601ZM8.58578 16.3639C8.39052 16.5592 8.39052 16.8758 8.58578 17.071L10.7071 19.1924C10.9024 19.3876 11.219 19.3876 11.4142 19.1924C11.6095 18.9971 11.6095 18.6805 11.4142 18.4853L10.4174 17.4884C12.1948 17.3899 13.9451 16.6614 15.3033 15.3033C18.2322 12.3743 18.2322 7.6256 15.3033 4.69666C15.0464 4.43978 14.7753 4.20526 14.4924 3.99318C14.2715 3.82754 13.9581 3.87236 13.7924 4.09331C13.6268 4.31425 13.6716 4.62764 13.8926 4.79329C14.1377 4.97703 14.3729 5.18049 14.5962 5.40377C17.1346 7.94218 17.1346 12.0578 14.5962 14.5962C13.31 15.8823 11.62 16.5167 9.9336 16.4996C9.90849 16.4994 9.88379 16.501 9.85963 16.5043L11.4142 14.9497C11.6095 14.7545 11.6095 14.4379 11.4142 14.2426C11.219 14.0474 10.9024 14.0474 10.7071 14.2426L8.58578 16.3639Z",fill:"#242424"}))},Dy=function(){return o.createElement("svg",{width:"19",height:"24",viewBox:"0 0 19 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("g",{filter:"url(#filter0_dd_3337_533)"},o.createElement("path",{d:"M4.63564 3.28753C3.98325 2.75037 3 3.21445 3 4.05952V18.0583C3 18.9844 4.15025 19.413 4.75622 18.7127L8.27991 14.6402C8.56483 14.3109 8.97879 14.1217 9.41424 14.1217L15.0061 14.1217C15.9444 14.1217 16.3661 12.9461 15.6418 12.3497L4.63564 3.28753Z",fill:"url(#paint0_linear_3337_533)"}),o.createElement("path",{d:"M4.95345 2.90154C3.97487 2.09579 2.5 2.79191 2.5 4.05952V18.0583C2.5 19.4475 4.22538 20.0903 5.13433 19.0398L8.65802 14.9674C8.84796 14.7478 9.12394 14.6217 9.41424 14.6217L15.0061 14.6217C16.4135 14.6217 17.0461 12.8583 15.9596 11.9637L4.95345 2.90154Z",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"})),o.createElement("defs",null,o.createElement("filter",{id:"filter0_dd_3337_533",x:"0",y:"0.0556641",width:"19.01",height:"23.0068",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},o.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),o.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),o.createElement("feOffset",null),o.createElement("feGaussianBlur",{stdDeviation:"1"}),o.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),o.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),o.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3337_533"}),o.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),o.createElement("feOffset",{dy:"1"}),o.createElement("feGaussianBlur",{stdDeviation:"1"}),o.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),o.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.14 0"}),o.createElement("feBlend",{mode:"normal",in2:"effect1_dropShadow_3337_533",result:"effect2_dropShadow_3337_533"}),o.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow_3337_533",result:"shape"})),o.createElement("linearGradient",{id:"paint0_linear_3337_533",x1:"3",y1:"11.059",x2:"16.0081",y2:"11.059",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#0078D4"}),o.createElement("stop",{offset:"0.415684",stopColor:"#2DB4FF"}),o.createElement("stop",{offset:"0.866289",stopColor:"#D660FF"}),o.createElement("stop",{offset:"1",stopColor:"#FEA874"}))))},Ly=function(){return o.createElement("svg",{width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M9.5 4C8.73745 4 8.02474 4.21338 7.41832 4.58369C7.35042 4.23521 7.23892 3.91747 7.07907 3.62413C7.79636 3.22644 8.62174 3 9.5 3C12.2614 3 14.5 5.23858 14.5 8H17C17.8284 8 18.5 8.67157 18.5 9.5V15.5C18.5 16.3284 17.8284 17 17 17H11C10.1716 17 9.5 16.3284 9.5 15.5V13C8.78132 13 8.09805 12.8484 7.48044 12.5754C7.49327 12.2357 7.5 11.8776 7.5 11.5L7.5 11.4649C8.08835 11.8052 8.77143 12 9.5 12V9.5C9.5 8.67157 10.1716 8 11 8H13.5C13.5 5.79086 11.7091 4 9.5 4ZM14.4 9C14.0023 10.9591 12.4591 12.5023 10.5 12.9V15.5C10.5 15.7761 10.7239 16 11 16H17C17.2761 16 17.5 15.7761 17.5 15.5V9.5C17.5 9.22386 17.2761 9 17 9H14.4ZM13.374 9H11C10.7239 9 10.5 9.22386 10.5 9.5V11.874C11.9056 11.5122 13.0122 10.4056 13.374 9ZM5.0809 2.12516C5.24705 2.27184 5.2964 2.50986 5.20381 2.7099C5.20296 2.71223 5.20137 2.71679 5.19951 2.7233C5.19403 2.74248 5.1875 2.77386 5.1875 2.8125C5.1875 2.87632 5.20345 2.99635 5.35355 3.14645C5.42656 3.21945 5.48278 3.27129 5.54403 3.32777C5.5937 3.37356 5.6467 3.42243 5.7147 3.48817C5.84326 3.61244 5.98131 3.75807 6.10353 3.9414C6.35878 4.32428 6.5 4.80266 6.5 5.5C6.5 6.35341 6.18386 7.07986 5.69132 7.52619C5.71306 7.55015 5.73421 7.57477 5.75477 7.6C6.03518 7.94407 6.19833 8.38978 6.29975 8.83013C6.50007 9.69992 6.50003 10.7457 6.5 11.4746L6.5 11.5C6.5 14.2873 6.12117 15.8681 5.70398 16.772C5.49389 17.2272 5.27136 17.5165 5.07769 17.6994C4.98105 17.7907 4.89315 17.854 4.8202 17.8974C4.78383 17.9191 4.75153 17.9356 4.72413 17.9481C4.71045 17.9543 4.69803 17.9595 4.68698 17.9638C4.68698 17.9638 4.57437 18 4.5 18C4.42563 18 4.31303 17.9638 4.31303 17.9638C4.30198 17.9595 4.28956 17.9543 4.27587 17.9481C4.24848 17.9356 4.21618 17.9191 4.17981 17.8974C4.10685 17.854 4.01895 17.7907 3.92232 17.6994C3.72865 17.5165 3.50612 17.2272 3.29602 16.772C2.87883 15.8681 2.5 14.2873 2.5 11.5V11.4746C2.49997 10.7457 2.49994 9.69992 2.70026 8.83013C2.80168 8.38978 2.96482 7.94407 3.24523 7.6C3.2658 7.57477 3.28695 7.55015 3.30869 7.52619C2.81614 7.07986 2.5 6.35341 2.5 5.5C2.5 5.17432 2.58733 4.78457 2.70709 4.42621C2.82741 4.06616 2.9953 3.6937 3.18863 3.39408C3.42008 3.00387 3.74542 2.67734 3.99671 2.45654C4.12622 2.34275 4.2425 2.25148 4.32717 2.18811C4.36961 2.15634 4.40443 2.13135 4.42936 2.11381L4.45916 2.09311L4.46805 2.08707L4.4709 2.08515L4.47265 2.08398C4.66129 1.95822 4.91094 1.97512 5.0809 2.12516ZM4.50165 7C4.88648 6.99878 5.5 6.57082 5.5 5.5C5.5 4.94735 5.39123 4.67573 5.27148 4.4961C5.2062 4.39818 5.12549 4.30944 5.01968 4.20715C4.98866 4.17717 4.94485 4.1364 4.89601 4.09093C4.81493 4.01546 4.71995 3.92706 4.64645 3.85356C4.52697 3.73408 4.43558 3.6111 4.36702 3.48854C4.2454 3.61965 4.13177 3.76281 4.04503 3.91047C4.04119 3.91701 4.0372 3.92346 4.03307 3.92981C3.8939 4.14378 3.75712 4.43917 3.65553 4.74317C3.55209 5.05267 3.5 5.32672 3.5 5.5C3.5 6.57235 4.11528 7 4.5 7L4.50165 7ZM4.0204 8.23176C3.87893 8.40534 3.76083 8.6808 3.67475 9.05457C3.50241 9.80286 3.5 10.7428 3.5 11.5C3.5 14.2127 3.87117 15.6319 4.20398 16.353C4.31319 16.5896 4.41694 16.7482 4.5 16.8524C4.58307 16.7482 4.68682 16.5896 4.79602 16.353C5.12883 15.6319 5.5 14.2127 5.5 11.5C5.5 10.7428 5.4976 9.80286 5.32526 9.05457C5.23918 8.6808 5.12107 8.40534 4.97961 8.23176C4.85446 8.0782 4.71077 8 4.5 8L4.49805 8C4.28835 8.00048 4.14516 8.07868 4.0204 8.23176Z",fill:"#242424"}))},My=function(){return o.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M3 5.5C3 4.11929 4.11929 3 5.5 3H14.5C15.8807 3 17 4.11929 17 5.5V14.5C17 15.8807 15.8807 17 14.5 17H5.5C4.11929 17 3 15.8807 3 14.5V5.5ZM4 10.5V14.5C4 15.3284 4.67157 16 5.5 16H9.5V10.5H4ZM9.5 9.5V4H5.5C4.67157 4 4 4.67157 4 5.5V9.5H9.5ZM10.5 10.5V16H14.5C15.3284 16 16 15.3284 16 14.5V10.5H10.5ZM16 9.5V5.5C16 4.67157 15.3284 4 14.5 4H10.5V9.5H16Z",fill:"#242424"}))},By=function(){return o.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H16.5C16.7761 6 17 5.77614 17 5.5C17 5.22386 16.7761 5 16.5 5H3.5ZM3.5 8C3.22386 8 3 8.22386 3 8.5C3 8.77614 3.22386 9 3.5 9H16.5C16.7761 9 17 8.77614 17 8.5C17 8.22386 16.7761 8 16.5 8H3.5ZM3 11.5C3 11.2239 3.22386 11 3.5 11H16.5C16.7761 11 17 11.2239 17 11.5C17 11.7761 16.7761 12 16.5 12H3.5C3.22386 12 3 11.7761 3 11.5ZM3.5 14C3.22386 14 3 14.2239 3 14.5C3 14.7761 3.22386 15 3.5 15H16.5C16.7761 15 17 14.7761 17 14.5C17 14.2239 16.7761 14 16.5 14H3.5Z",fill:"#242424"}))},Ry=function(){return o.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M5 3.5C5 3.22386 5.22386 3 5.5 3H17.5C17.7761 3 18 3.22386 18 3.5C18 3.77614 17.7761 4 17.5 4H5.5C5.22386 4 5 3.77614 5 3.5ZM5 15.5C5 15.2239 5.22386 15 5.5 15H17.5C17.7761 15 18 15.2239 18 15.5C18 15.7761 17.7761 16 17.5 16H5.5C5.22386 16 5 15.7761 5 15.5ZM11 7.5C11 7.22386 11.2239 7 11.5 7H17.5C17.7761 7 18 7.22386 18 7.5C18 7.77614 17.7761 8 17.5 8H11.5C11.2239 8 11 7.77614 11 7.5ZM11 11.5C11 11.2239 11.2239 11 11.5 11H17.5C17.7761 11 18 11.2239 18 11.5C18 11.7761 17.7761 12 17.5 12H11.5C11.2239 12 11 11.7761 11 11.5ZM9 9.5C9 11.433 7.433 13 5.5 13C3.567 13 2 11.433 2 9.5C2 7.567 3.567 6 5.5 6C7.433 6 9 7.567 9 9.5ZM3.5 9C3.22386 9 3 9.22386 3 9.5C3 9.77614 3.22386 10 3.5 10H7.5C7.77614 10 8 9.77614 8 9.5C8 9.22386 7.77614 9 7.5 9H3.5Z",fill:"#242424"}))},Fy=function(){return o.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M17.1813 2.92689C16.0291 1.71505 14.1047 1.69077 12.9222 2.87317L3.54741 12.2475C3.21958 12.5754 2.99204 12.9899 2.89148 13.4424L2.01387 17.3923C1.97678 17.5592 2.02754 17.7335 2.14844 17.8544C2.26934 17.9753 2.44362 18.026 2.6105 17.9889L6.53689 17.1157C7.00432 17.0118 7.43243 16.7767 7.77103 16.4381L17.129 7.08003C18.27 5.939 18.2933 4.09631 17.1813 2.92689ZM13.6293 3.58029C14.4143 2.79538 15.6917 2.8115 16.4566 3.61596C17.1948 4.39225 17.1793 5.61548 16.4219 6.37293L15.7507 7.04418L12.958 4.25155L13.6293 3.58029ZM12.2509 4.95864L15.0436 7.7513L7.06391 15.731C6.85976 15.9352 6.60164 16.0769 6.31982 16.1396L3.1605 16.8421L3.86768 13.6593C3.92698 13.3924 4.06117 13.148 4.2545 12.9547L12.2509 4.95864Z",fill:"#242424"}))},Ny={position:"fixed",zIndex:"10",pointerEvents:"none",cursor:"none",alignItems:"center"},Hy=i.a.memo((function(e){var t=e.editorAreaRef,n=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e=t.current,r=n.current,o=function(t){r&&(r.style.left=t.pageX-8+"px",r.style.top=t.pageY-8+"px","none"===r.style.display&&t.target===e&&(r.style.display="inline-block"))},i=function(){r&&(r.style.display="inline-block")},a=function(){r&&(r.style.display="none")};return null==e||e.addEventListener("mousemove",o),null==e||e.addEventListener("mouseenter",i),null==e||e.addEventListener("mouseleave",a),function(){null==e||e.removeEventListener("mousemove",o),null==e||e.removeEventListener("mouseenter",i),null==e||e.removeEventListener("mouseleave",a)}}),[t]),i.a.createElement("div",{ref:n,style:Ny},i.a.createElement(Dy,null))})),Uy={position:"relative",zIndex:1,borderRadius:"0px 9px 9px 9px",overflow:"hidden",background:"white",cursor:"none"},Vy={backgroundColor:"transparent",border:"none",font:"Segoe UI",fontSize:"14px",display:"inline-block",whiteSpace:"nowrap",cursor:"none"},zy={color:"rgb(43, 121, 215)",margin:"5px",whiteSpace:"nowrap",cursor:"none"},Gy=function(e){var t=e.props,n=e.containerId;return i.a.createElement(Wn.a,{horizontal:!0},i.a.createElement("button",{style:Object(r.__assign)(Object(r.__assign)({},Vy),zy),onClick:function(){var e;return null===(e=t.onClick)||void 0===e?void 0:e.call(t,n)}},i.a.createElement("strong",null,t.text)))},Wy=function(e){var t,n=e.item,r=e.index,o=e.hoveredIndex,a=e.handleMouseEnter,s=e.handleMouseLeave;return i.a.createElement(Wn.a,{key:r,style:(t=o===r,{backgroundColor:t?"lightgray":"white",padding:"5px 15px 5px 20px"}),onMouseEnter:function(){return a(r)},onMouseLeave:s},i.a.createElement(Wn.a,{horizontal:!0,verticalAlign:"center"},n.icon&&i.a.createElement(n.icon,null),i.a.createElement("button",{style:Vy,onClick:function(){n.onClick&&n.value&&n.onClick(n.value)}},n.value)))},Qy=function(e){var t=e.isSuggestionsAvailable,n=e.shouldPopulateSuggestions,a=e.suggestions,s=Object(r.__read)(Object(o.useState)(-1),2),l=s[0],c=s[1],u=function(e){c(e)},d=function(){c(-1)};return i.a.createElement(Wn.a,{verticalAlign:"center"},t&&n&&(null==a?void 0:a.map((function(e,t){return i.a.createElement(Wy,{key:t,item:e,index:t,hoveredIndex:l,handleMouseEnter:u,handleMouseLeave:d})}))))},qy=function(e){var t=e.isSuggestionsAvailable,n=e.shouldPopulateSuggestions,o=e.containerId,a=e.askCopilotProps,s=Object(r.__rest)(e,["isSuggestionsAvailable","shouldPopulateSuggestions","containerId","askCopilotProps"]);return i.a.createElement(Wn.a,{style:Uy},a&&a.isAskCopilotAvailable&&i.a.createElement(Gy,{props:a,containerId:o}),t&&i.a.createElement(Qy,Object(r.__assign)({isSuggestionsAvailable:t,shouldPopulateSuggestions:n},s)))},Ky={display:"none",fontFamily:"Arial, sans-serif",textAlign:"center",position:"fixed",padding:"1px",borderRadius:"0px 10px 10px 10px",background:"linear-gradient(90deg, #0078D4 0%, #2DB4FF 41.5684%, #D660FF 86.6289%, #FEA874 100%)"},Yy={width:"100%",height:"100%",padding:"10px",cursor:"none"},Zy=function(e){var t=e.editorAreaRef,n=e.TagIdToCursorContentMap,a=Object(o.useRef)(null),s=Object(o.useRef)(null),l=null,c=Object(r.__read)(Object(o.useState)({containerId:"",suggestionProps:{isSuggestionsAvailable:!1,shouldPopulateSuggestions:!1}}),2),u=c[0],d=c[1],p=function(){a.current&&(a.current.style.display="none")},g=function(e,t){var n=document.getElementById(e);n&&(n.style.background=t)},h=function(e){e&&d({containerId:e,suggestionProps:{suggestions:n[e].suggestions,isSuggestionsAvailable:!0,shouldPopulateSuggestions:!0,askCopilotProps:{isAskCopilotAvailable:!0,text:"Ask Copilot to...",onClick:h}}})};return Object(o.useEffect)((function(){var e=function(e){var t,r=null===(t=e.target)||void 0===t?void 0:t.id;p(),l&&g(l.id,"none"),g(r,"linear-gradient(\n        to right,\n        rgba(0, 120, 212, 0.15) 0%,\n        rgba(45, 180, 255, 0.15) 41.5684%,\n        rgba(214, 96, 255, 0.15) 86.6289%,\n        rgba(254, 168, 116, 0.15) 100%\n      )"),a.current&&(a.current.style.display="inline-block",a.current.style.left=e.pageX+"px",a.current.style.top=e.pageY+"px"),d({containerId:r,suggestionProps:{suggestions:n[r].suggestions,isSuggestionsAvailable:!1,shouldPopulateSuggestions:!1,askCopilotProps:{isAskCopilotAvailable:!0,text:"Ask Copilot to...",onClick:h}}}),l=e.target},t=function(e){(function(e){if(e.relatedTarget)for(var t=e.relatedTarget;t;){if(t===s.current)return!0;t=t.parentNode}return!1})(e)||(p(),g(e.target.id,"none"))};return n&&Object.entries(n).length>0&&Object.entries(n).forEach((function(n){var o=Object(r.__read)(n,1)[0],i=document.getElementById(o);i&&(i.addEventListener("mouseenter",e),i.addEventListener("mouseleave",t))})),function(){n&&Object.entries(n).length>0&&Object.entries(n).forEach((function(n){var o=Object(r.__read)(n,1)[0],i=document.getElementById(o);i&&(i.removeEventListener("mouseenter",e),i.removeEventListener("mouseleave",t))}))}}),[]),i.a.createElement("div",{style:{position:"absolute"},ref:s},n&&Object.keys(n).length>0&&i.a.createElement("div",{ref:a,style:Ky},i.a.createElement(qy,{suggestions:u.suggestionProps.suggestions,isSuggestionsAvailable:u.suggestionProps.isSuggestionsAvailable||!1,shouldPopulateSuggestions:u.suggestionProps.shouldPopulateSuggestions||!1,containerId:u.containerId,askCopilotProps:u.suggestionProps.askCopilotProps})),i.a.createElement(Hy,{editorAreaRef:t}))},Jy=function(){var e=Object(o.useRef)(null),t=i.a.useContext(a),n=null==t?void 0:t.operaState,s=null==n?void 0:n.operaStepsData.find((function(e){return e.skillName===n.currentSkillName})),l=null==s?void 0:s.component,c=null==l?void 0:l.componentData,u=null==c?void 0:c.editorProps,d=Object(r.__read)(Object(o.useState)(u.htmlContentData||""),1)[0],p=Vb();function g(e){console.log("Edit Clicked")}return i.a.createElement(Ue.a,{className:p.root,style:{overflowX:"hidden",overflowY:"auto",cursor:"none"}},i.a.createElement("div",{ref:e,style:Yy},i.a.createElement(Zy,{editorAreaRef:e,TagIdToCursorContentMap:function(e){var t,n,o={};if(!e)return o;var i=function(e,t){var n=[],r={isSuggestionsAvailable:!1,shouldPopulateSuggestions:!1};t.forEach((function(e){"Edit"===e?n.push({value:e,onClick:g,icon:Fy}):"Rewrite"===e?n.push({value:e,onClick:function(){},icon:_y}):"Shorten"===e?n.push({value:e,onClick:function(){},icon:Ry}):"Elaborate"===e?n.push({value:e,onClick:function(){},icon:By}):"Add a banner"===e?n.push({value:e,onClick:function(){},icon:Ly}):"Visualize as table"===e&&n.push({value:e,onClick:function(){},icon:My})})),r.isSuggestionsAvailable=n.length>0,r.containerId=e,r.askCopilotProps={isAskCopilotAvailable:!0,text:"Ask Copilot to...",onClick:function(){}},r.suggestions=n,o[e]=r};try{for(var a=Object(r.__values)(Object.entries(e)),s=a.next();!s.done;s=a.next()){var l=Object(r.__read)(s.value,2);i(l[0],l[1])}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}(null==u?void 0:u.magicCursorProps)}),i.a.createElement("div",null,Ay()(d))))},Xy=function(){var e,t,n,r,o=my(),s=i.a.useContext(a),l=null==s?void 0:s.operaState,c=null==s?void 0:s.operaStepperLabelIndex,u=null==l?void 0:l.currentSkillName,d=null!==(e=null==c?void 0:c[u])&&void 0!==e?e:0,p=null===(n=null===(t=null==l?void 0:l.operaStepsData[d])||void 0===t?void 0:t.component)||void 0===n?void 0:n.componentType;return p||(p=null!==(r=f[u])&&void 0!==r?r:"FilePicker"),i.a.createElement(Wn.a,{className:o.root,"aria-labelledby":"Opera-UI-Container"},i.a.createElement("div",{className:o.containerRoot},i.a.createElement("div",{className:o.stepperRoot,style:{minWidth:0,borderRadius:"8px"}},i.a.createElement(Fb,null)),i.a.createElement("div",{className:o.componentRoot},function(){switch(p){case"FilePicker":return i.a.createElement(oy,null);case"PillsList":return i.a.createElement(gy,null);case"CheckboxList":return i.a.createElement(Sy,null);case"RadioGroup":return i.a.createElement(jy,null);case"MagicCursorCanvas":return i.a.createElement(Jy,null);default:return null}}())))},$y=n(1527);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(wb||(wb={}));var eC=n(1023),tC=function(e){var t,n="inapp-feedback-element-id";return e&&(t=document.getElementById(e)),t||(t=document.getElementById(n)),t||((t=document.createElement("div")).id=n,document.body.appendChild(t)),t},nC=function(){function e(){}return e.prototype.isFeatureGateEnabledFromClient=function(e){return console.log("Feature gate: ",e),!1},e.prototype.sendLoggingEventToClient=function(e,t){console.log("sendLoggingEventToClient: ",e),console.log("loggingEventArgs: ",t)},e.prototype.updateCopilotState=function(e){console.log("updateCopilotState: "+e)},e.prototype.feedbackButtonClicked=function(e,t,n,o){var i,a=Ph.getFeedbackSettings(),s=Mh.getInstance().getIsFluxFlowEnabled();a&&(null===(i=a.feedbackInitOptions)||void 0===i?void 0:i.appId)&&function(e){var t=e.appData,n=e.featureAreaName,o=void 0===n?"Copilot":n,i=e.inAppFeedbackRef,a=e.specificHvcVersion,s=e.majorVersion,l=e.feedbackInitOptions,c=e.ocvFeedbackHost,u=e.appEnvironment,d=void 0===u?wb.DEV:u,p=e.language,g=void 0===p?"en":p,h=e.feedbackType,f=e.feedbackData,m=e.buttonTarget,v=e.isSydneyEnabled,b=e.createAndSubmitFeedbackDataUploadSignal;Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,n,u,p,y,C,O,S,E;return Object(r.__generator)(this,(function(x){switch(x.label){case 0:return e=Object(Pn.a)(),(l=Object(r.__assign)(Object(r.__assign)({},l),{authenticationType:null!==(p=null==l?void 0:l.authenticationType)&&void 0!==p?p:eC.a.Unauthenticated,clientFeedbackId:e,clientName:c})).themeOptions||(l.themeOptions={baseTheme:"WindowsLight"}),void 0!==l.isProduction&&null!==l.isProduction||(l.isProduction=d===wb.PRODUCTION),l.telemetry=Object(r.__assign)(Object(r.__assign)({},l.telemetry),{featureArea:o,sourceContext:v?"CopilotChatFeedback":null===(y=l.telemetry)||void 0===y?void 0:y.sourceContext}),l.feedbackConfig=Object(r.__assign)(Object(r.__assign)({},l.feedbackConfig),{appData:null!==(O=null===(C=l.feedbackConfig)||void 0===C?void 0:C.appData)&&void 0!==O?O:JSON.stringify(t),calloutTarget:m,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:eC.c.CallOut,initialFeedbackType:h,invocationTimeStamp:Date.now(),isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isScreenRecordingEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:h==eC.b.Smile?eC.d.AIThumbsUp:eC.d.AIThumbsDown},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0}),n=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){return e=new File([null===(t=null==f?void 0:f.contextData)||void 0===t?void 0:t.cardMetaData],"contextData.json",{type:"text/json"}),[2,new Promise((function(t){t([e])}))]}))}))},l.feedbackConfig.diagnosticsConfig=Object(r.__assign)(Object(r.__assign)({},l.feedbackConfig.diagnosticsConfig),{diagnosticsEndPoint:"ODS",diagnosticsUploadId:e,diagnosticsExplanationUrl:void 0,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:null!==(E=null===(S=l.feedbackConfig.diagnosticsConfig)||void 0===S?void 0:S.getContextData)&&void 0!==E?E:n}),b&&(l.feedbackConfig.diagnosticsConfig=Object(r.__assign)(Object(r.__assign)({},l.feedbackConfig.diagnosticsConfig),{extractFeedbackDataForHost:function(e){b(JSON.stringify(e),c)},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0})),u={hostName:"AppChatCopilot",locale:g,inAppFeedbackRef:tC(i),specificHvcVersion:a,majorVersion:s},[4,Object(eC.e)(u)];case 1:return x.sent(),Object(eC.f)(l),[2]}}))}))}(Object(r.__assign)(Object(r.__assign)({},a),{feedbackData:t,ocvFeedbackHost:Ph.getAppName(),language:Ph.getLanguage(),appEnvironment:Ph.getEnvironment(),feedbackType:e==Zp.LIKE?$y.b.Smile:$y.b.Frown,appData:null!=n?n:a.appData,buttonTarget:o,isSydneyEnabled:s,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(uh.EnableSendTenantFeedback)?Hh:void 0})),console.log("feedbackButtonClicked: "+e),console.log("feedbackData: "+t),console.log("telemetryData: "+n)},e.prototype.getALSession=function(){throw new Error("Method not implemented.")},e.prototype.getHostSettings=function(){throw new Error("Method not implemented.")},e.prototype.getAuthToken=function(){throw new Error("Method not implemented.")},e.prototype.shouldIgnoreResponse=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,!1]}))}))},e.prototype.shouldSendRequestToAugloop=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return nb("shouldSendRequestToAugloop"),[2,!0]}))}))},e.prototype.getFeedbackData=function(){return{}},e.prototype.getOnClickHandler=function(e){return function(){}},e}(),rC=n(3501),oC=n(3502);class iC{static generateId(){return iC.operationId++,"AugLoopChatOpera"+iC.operationId.toString()}}iC.operationId=0;const aC=(e,t,n)=>{const r={query:e,queryId:t};return n&&(r.workflowType=n),r},sC="start the workflow on Shared Copilot";class lC extends nC{constructor(e,t,n,r){super(),this.initialSignalSent=!1,this.copilotChatRef=e,this.updateCurrentStep=t,this.workflowType=null!=n?n:"blog",this.userQuery=null!=r?r:sC}setOperaState(e){console.log("CopilotOpera:: Setting the opera state.",e),this.operaState=e}sendInitialSignal(){var e;console.log(`CopilotOpera:: Sending the initial Opera signal: ${this.userQuery}, Workflow type in Opera signal: ${this.workflowType}`);const t=new rC.a(aC(this.userQuery,"0",this.workflowType));null===(e=this.copilotChatRef.current)||void 0===e||e.submitOperation({operation:new kh.b({parentPath:["Signal",rC.a.getTypeName()],items:[{id:iC.generateId(),body:t}]}),workflowAnnotationType:oC.a.getTypeName()})}static getInstance(e,t,n,r){return lC.instance||(lC.instance=new lC(e,t,n,null!=r?r:sC)),lC.instance}getWorkflowsToRegister(){console.log("CopilotOpera:: getWorkflowsToRegister.");const e=[];return e.push({workflowAnnotationType:oC.a.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}),e}getPayload(e){var t;console.log("CopilotOpera::  getPayload.",e);const n=null===(t=JSON.parse(e))||void 0===t?void 0:t.payload;return console.log("CopilotOpera:: payload: ",n),n}processRenderCardRequest(e){console.log("CopilotOpera::  processRenderCardRequest.",e);const t=this.getPayload(e);if(t&&t.skillName&&t.component){const e=(e=>({component:null==e?void 0:e.component,stepId:null==e?void 0:e.stepId,skillName:null==e?void 0:e.skillName,isHtmlCanvasOutputOnFirstRender:null==e?void 0:e.isHtmlCanvasOutputOnFirstRender,workflowMetaData:null==e?void 0:e.workflowMetaData}))(t);this.updateCurrentStep(e)}}sendClientUISyncRequest(e,t=!0){var n,r;console.log("CopilotOpera::  sendClientUISyncRequest.",e);const o=JSON.stringify(e),i=e.payload.skillName;console.log("CopilotOpera::  responseMessageText: ",o);const a=new rC.b({workflowType:this.workflowType,renderCardRequestData:o,stepId:i});if(console.log("CopilotOpera::  uiStateSyncSignal: ",a),null===(n=this.copilotChatRef.current)||void 0===n||n.submitOperation({operation:new kh.b({parentPath:["Signal",rC.b.getTypeName()],items:[{id:iC.generateId(),body:a}]}),workflowAnnotationType:oC.a.getTypeName()}),t){const e=new rC.a(aC("go to next step","0",this.workflowType));console.log("CopilotOpera::  inputSignal: ",e),null===(r=this.copilotChatRef.current)||void 0===r||r.submitOperation({operation:new kh.b({parentPath:["Signal",rC.a.getTypeName()],items:[{id:iC.generateId(),body:e}]}),workflowAnnotationType:oC.a.getTypeName()})}}doesResponseContainPayload(e){var t;console.log("CopilotOpera::  doesResponseContainPayload.",e);return void 0!==(null===(t=JSON.parse(e))||void 0===t?void 0:t.payload)}sendResponseToClient(e){var t,n,r,o,i;if(console.log("CopilotOpera::  sendResponseToClient.",e),0===(null===(t=e.body.chatResponse)||void 0===t?void 0:t.status)){const t=null===(o=null===(r=null===(n=e.body)||void 0===n?void 0:n.chatResponse)||void 0===r?void 0:r.messages[1])||void 0===o?void 0:o.text;this.doesResponseContainPayload(t)||null===(i=this.copilotChatRef.current)||void 0===i||i.addResponseMessage({chatCardType:P.MarkdownCard,chatMessageData:{markDownCardProps:{message:t}},stopLoadingUi:!0}),this.processRenderCardRequest(t)}}sendEventToClient(e,t){!1===this.initialSignalSent&&(this.sendInitialSignal(),this.initialSignalSent=!0)}getDefaultSignalOperation(e,t,n,r,o){console.log("CopilotOpera::  getDefaultSignalOperation.",e,t);const i=aC(e,t,this.workflowType),a={operation:new kh.b({parentPath:["Signal",rC.a.getTypeName()],items:[{id:iC.generateId(),body:new rC.a(i)}]}),workflowAnnotationType:oC.a.getTypeName()},s=this.getRenderCardRequestPayloadFromOperaStep();return this.sendClientUISyncRequest(s,!1),Promise.resolve(a)}getHostSettings(){return{appName:"Testing",appPlatform:"All",devBuild:!0,environment:Kp.DEV,sessionId:"",augloopUrl:"http://localhost:20080"}}getRenderCardRequestPayloadFromOperaStep(){return console.log("CopilotOpera::  getRenderCardRequestPayloadFromOperaStep.",this.operaState),(e=>{var t,n,r,o,i,a;console.log("CopilotOpera::  getRenderCardRequestPayloadFromOperaStep.",e);const s=null==e?void 0:e.currentSkillName,l=null==e?void 0:e.operaStepsData.findIndex((e=>e.skillName===s));if(void 0===l||-1===l)return{};const c=null===(r=null===(n=null===(t=null==e?void 0:e.operaStepsData)||void 0===t?void 0:t[l])||void 0===n?void 0:n.component)||void 0===r?void 0:r.componentData,u={skillName:s,component:{componentType:null===(a=null===(i=null===(o=null==e?void 0:e.operaStepsData)||void 0===o?void 0:o[l+1])||void 0===i?void 0:i.component)||void 0===a?void 0:a.componentType,componentData:{title:null==c?void 0:c.title,description:null==c?void 0:c.description,list:null==c?void 0:c.list,addButtonText:null==c?void 0:c.addButtonText,nextButtonText:null==c?void 0:c.nextButtonText}}};return{skillName:s,payload:u}})(this.operaState)}getAuthToken(){return console.log("CopilotOpera:: token in getauthtoken"),Promise.resolve("")}}var cC=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{chatUiStack:null!==(t=e.chatUiStack)&&void 0!==t?t:{},chatFreStack:null!==(n=e.chatFreStack)&&void 0!==n?n:{},chatUiStackZoom:null!==(r=e.chatUiStackZoom)&&void 0!==r?r:{},chatFreStackZoom:null!==(o=e.chatFreStackZoom)&&void 0!==o?o:{},spinner:null!==(i=e.spinner)&&void 0!==i?i:{},incomingShimmerCard:null!==(a=e.incomingShimmerCard)&&void 0!==a?a:{},outgoingShimmerCard:null!==(s=e.outgoingShimmerCard)&&void 0!==s?s:{},incomingShimmerCardWrapper:null!==(l=e.incomingShimmerCardWrapper)&&void 0!==l?l:{},outgoingShimmerCardWrapper:null!==(c=e.outgoingShimmerCardWrapper)&&void 0!==c?c:{},paneLoadMessageContainer:null!==(u=e.paneLoadMessageContainer)&&void 0!==u?u:{},paneLoadWarningIcon:null!==(d=e.paneLoadWarningIcon)&&void 0!==d?d:{},paneLoadWarningLabel:null!==(p=e.paneLoadWarningLabel)&&void 0!==p?p:{}}};const uC=function(e){var t=cC(e);return Object(X.a)(t)}({chatFreStack:{height:"calc(100vh - 50px)"}}),dC=({workflowType:e,userQuery:t,token:n})=>{const r=o.useContext(a),i=null==r?void 0:r.operaState,l=null==r?void 0:r.setOperaState,c=null==r?void 0:r.operaStepperLabelIndex,u=null==r?void 0:r.setOperaStepperLabelIndex,[d,p]=o.useState(!1),g=o.useRef(d);o.useEffect((()=>{g.current=d}),[d]);const h=o.useRef(null),m=lC.getInstance(h,(e=>{g.current?((e,t=!1)=>{l((n=>{var r,o;const i=Object.assign({},n),a=null!==(r=null==c?void 0:c[e.skillName])&&void 0!==r?r:0;i.currentStepId=a,i.currentSkillName=e.skillName,i.currentComponentType=null===(o=e.component)||void 0===o?void 0:o.componentType;for(let n=0;n<i.operaStepsData.length;n++)e.skillName===i.operaStepsData[n].skillName&&(i.operaStepsData[n].component=e.component,i.operaStepsData[n].isALDataAvailable=t);return i}))})(e,!0):(l((()=>{var t,n,r,o,i,a,s,l,c,u,d,p,g;const h=[];let m=0;for(let g=0;g<(null!==(r=null===(n=null===(t=null==e?void 0:e.workflowMetaData)||void 0===t?void 0:t.steps)||void 0===n?void 0:n.length)&&void 0!==r?r:0);g++){const t=null===(o=null==e?void 0:e.workflowMetaData)||void 0===o?void 0:o.steps[g];let n=t.skillName===e.skillName?null===(i=e.component)||void 0===i?void 0:i.componentType:void 0;if(!n){const e=null!==(a=f[t.skillName])&&void 0!==a?a:void 0;e&&(n=null!=e?e:void 0)}const r={componentType:n,componentData:{title:null==t?void 0:t.stepTitle,description:null==t?void 0:t.stepDescription}};t.skillName===e.skillName&&(m=g,r.componentData.list=null===(l=null===(s=e.component)||void 0===s?void 0:s.componentData)||void 0===l?void 0:l.list,r.componentData.addButtonText=null===(u=null===(c=null==e?void 0:e.component)||void 0===c?void 0:c.componentData)||void 0===u?void 0:u.addButtonText,r.componentData.nextButtonText=null===(p=null===(d=null==e?void 0:e.component)||void 0===d?void 0:d.componentData)||void 0===p?void 0:p.nextButtonText);const v={skillName:t.skillName,component:r,isALDataAvailable:t.skillName===e.skillName,stepperLabel:null==t?void 0:t.stepLabel};h.push(v)}return{currentSkillName:e.skillName,currentComponentType:null===(g=null==e?void 0:e.component)||void 0===g?void 0:g.componentType,currentStepId:m,operaStepsData:h}})),u((()=>{var t,n,r;const o={},i=null!==(n=null===(t=null==e?void 0:e.workflowMetaData)||void 0===t?void 0:t.steps)&&void 0!==n?n:[];for(let e=0;e<i.length;e++)o[null!==(r=i[e].skillName)&&void 0!==r?r:""]=e;return o})),p(!0),g.current=!0)}),e,t);o.useEffect((()=>{m.setOperaState(i)}),[i]);const v={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"Copilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,resultTime:1e4},telemLogger:{logError:e=>{console.log("Shared Copilot CIQ Error Log: ",e)}},entitiesSupported:[],isExpandedECCEnabled:!1};return o.createElement("div",{className:"ms-welcome",style:{display:"flex",gap:"8px",margin:"0px 4px"}},o.createElement("div",{style:{flex:"0 0 75%",width:"74%",minWidth:0,borderRadius:"8px",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"}},o.createElement(Pb,{theme:jf},o.createElement(s.Provider,{value:()=>{var e,t,n,r,o,a,s,u,d;console.log("CopilotOpera:: handleNextButtonClick :",i);const p=null==i?void 0:i.currentSkillName;let g=null!==(e=null==c?void 0:c[p])&&void 0!==e?e:-1;if(-1===g)for(let e=0;e<(null==i?void 0:i.operaStepsData.length);e++)if((null==i?void 0:i.operaStepsData[e].skillName)===p){g=e;break}if(g>(null==i?void 0:i.operaStepsData.length)-1||g<0)return;const h=null===(r=null===(n=null===(t=null==i?void 0:i.operaStepsData)||void 0===t?void 0:t[g])||void 0===n?void 0:n.component)||void 0===r?void 0:r.componentData,f=null===(a=null===(o=null==i?void 0:i.operaStepsData)||void 0===o?void 0:o[g+1])||void 0===a?void 0:a.skillName,v={skillName:p,payload:{skillName:p,component:{componentType:null===(d=null===(u=null===(s=null==i?void 0:i.operaStepsData)||void 0===s?void 0:s[g+1])||void 0===u?void 0:u.component)||void 0===d?void 0:d.componentType,componentData:{title:null==h?void 0:h.title,description:null==h?void 0:h.description,list:null==h?void 0:h.list,addButtonText:null==h?void 0:h.addButtonText,nextButtonText:null==h?void 0:h.nextButtonText}}}};m.sendClientUISyncRequest(v),l((e=>{var t,n;const r=Object.assign({},e);return r.currentSkillName=f,r.currentStepId=g+1,r.currentComponentType=null===(n=null===(t=null==i?void 0:i.operaStepsData)||void 0===t?void 0:t[g+1].component)||void 0===n?void 0:n.componentType,r.operaStepsData[g+1].isALDataAvailable=!1,r}))}},o.createElement(Xy,null)))),o.createElement("div",{style:{display:"flex",width:"calc(40% - 12px)",minWidth:0,overflow:"hidden",position:"relative",height:"100vh",marginRight:"4px",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)",borderRadius:"8px"}},o.createElement(Kv,{style:uC(),chatUiProps:{chatInputV2Props:{pluginsInfo:[],chatPlaceholderMessage:"Type a message",editorConfig:v}},copilotCommunicationHandler:m,useALRuntime:!0,ref:h})))};function pC(e){var t;return o.createElement(l,null,o.createElement(dC,{workflowType:null!==(t=e.workflowType)&&void 0!==t?t:"blog",userQuery:e.userQuery,token:e.token}))}dC.displayName="CopilotOpera"},2866:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),o=n(1846),i=n(1),a=n.n(i),s=n(1134),l=n(1084),c=n(1015),u=n(35),d=Object(u.db)({container:{overflow:"hidden",height:"100%"},body:{flex:"4 4 auto",height:"95vh",overflow:"hidden"}}),p=function(e){var t=o.a.ImageWithDocument,n=a.a.useRef(null),i=e.designerMiniConfig,u=(null==i?void 0:i.telemetryConfig.clientName)||"DesignerCopilotClient",p=(null==i?void 0:i.telemetryConfig.sessionId)||Object(s.a)(),g="".concat(u,"-").concat(p),h=a.a.useMemo((function(){var o,a,c;return{baseAppURL:Object(l.b)(),clientName:(null==i?void 0:i.telemetryConfig.clientName)||"DesignerCopilotClient",clientId:(null==i?void 0:i.telemetryConfig.clientId)||"DesignerCopilotClientId",container:n.current,sessionId:(null==i?void 0:i.telemetryConfig.sessionId)||Object(s.a)(),correlationId:(null==i?void 0:i.telemetryConfig.correlationId)||Object(s.a)(),platform:(null==i?void 0:i.telemetryConfig.platform)||"Web",copyOnDone:!0,insertMode:!0,hideSizeSelector:!0,suggestionsConfig:{dimension:{width:1080,height:1080},scenario:g,enableMotionDesigns:!0},forwardedConfig:Object(r.__assign)({},Object(r.__assign)({},null!==(o=null==e?void 0:e.forwardedAppConfig)&&void 0!==o?o:{documentContent:"{}"})),enableSandboxing:!0,doneMessageOptions:t,useEnterpriseTOULink:!0,hostBuildVersion:null!==(a=null==i?void 0:i.telemetryConfig.hostBuildVersion)&&void 0!==a?a:"unknown",hostEnvironment:null!==(c=null==i?void 0:i.telemetryConfig.hostEnvironment)&&void 0!==c?c:"unknown",hostScenario:g}}),[null==i?void 0:i.telemetryConfig.clientId,null==i?void 0:i.telemetryConfig.clientName,null==i?void 0:i.telemetryConfig.correlationId,null==i?void 0:i.telemetryConfig.hostBuildVersion,null==i?void 0:i.telemetryConfig.hostEnvironment,null==i?void 0:i.telemetryConfig.platform,null==i?void 0:i.telemetryConfig.sessionId,t,null==e?void 0:e.forwardedAppConfig,g]);return a.a.useEffect((function(){var t=new o.b(Object(r.__assign)(Object(r.__assign)({},h),{container:n.current}));t.initialize(),t.on("cancel",(function(t){e.onClosed&&e.onClosed(t)})),t.on("done",(function(t){e.onDone&&Object(c.a)(t.media,t.mimeType).then((function(t){var n;null===(n=e.onDone)||void 0===n||n.call(e,t)}))}))}),[e,h]),a.a.createElement("div",{className:d.body},a.a.createElement("div",{id:"designer-container",ref:n,className:d.container,tabIndex:0}))}},2870:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(2),o=n(1),i=n(544),a=Object(i.a)("@1js/create-shared-react-context",{});var s=n(65),l=function(e,t){var n=a.get();return n[t]||(n[t]=o.createContext(e))}([],"ComponentStylingPureFluentOverrides");function c(e,t){function n(){var n=t(),i=Object(o.useContext)(l).map((function(t){return t[e]})).filter((function(e){return!!e})),a=Object(r.__assign)({},n),c=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],o=i.map((function(t){return t[e]})).filter((function(e){return!!e})),l=s.a.apply(void 0,Object(r.__spreadArray)([t],Object(r.__read)(o),!1));a[e]=l}};for(var u in n)c(u);return a}return n.componentName=e,n.__version="fluent",n}function u(e){var t=l.Consumer,n=l.Provider;return function(i){var a=i.children,s={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=e[l];c&&(s[l]=c())}return o.createElement(t,null,(function(e){var t=Object(r.__spreadArray)([s],Object(r.__read)(e),!1);return o.createElement(n,{value:t},a)}))}}},307:function(e,t,n){"use strict";n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return R}));var r=n(2),o=n(28),i=n(1120),a=n(161),s=n(147);function l(e,t,n){if("string"==typeof t){var r=Object(s.i)(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}var c=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}(),u=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.highlightColors=new c("#22000000","#11000000"),t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(c),d=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)},p=function(){function e(t){this.imageSize=o.r.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=Object(s.j)(t.maxImageHeight,e.defaultMaxImageHeight))}return e.prototype.toJSON=function(){return{imageSize:o.r[this.imageSize],maxImageHeight:this.maxImageHeight}},e.defaultMaxImageHeight=100,e}(),g=function(){function e(e){this.useHTML5PlayerAsFallback=!1,this.placeholderHeights={veryNarrow:120,narrow:175,standard:250,wide:300},e&&(this.defaultPoster=e.defaultPoster,this.useHTML5PlayerAsFallback=e.useHTML5PlayerAsFallback||this.useHTML5PlayerAsFallback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster}},e}(),h=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}(),f=function(){function e(e){this.size=o.w.Default,this.color=o.v.Default,this.isSubtle=!1,this.weight=o.x.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=l(o.w,e.size,this.size),this.color=l(o.v,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=l(o.x,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return o.x.Default},e.prototype.toJSON=function(){return{size:o.w[this.size],color:o.v[this.color],isSubtle:this.isSubtle,weight:o.x[this.weight]}},e}(),m=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.fontType=o.h.Default,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=l(o.h,t.fontType,this.fontType))},t}(f),v=function(){function e(e){this.default=new m,this.heading=new m({size:"Large",weight:"Bolder"}),this.columnHeader=new m({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}(),b=function(e){e&&(this.headingLevel=Object(s.j)(e.headingLevel))},y=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.suffix=" *",t.suffixColor=o.v.Attention,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=l(o.v,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=o.v[this.suffixColor],t},t}(f),C=function(e){this.inputSpacing=o.t.Small,this.requiredInputs=new y,this.optionalInputs=new f,e&&(this.inputSpacing=l(o.t,e.inputSpacing,this.inputSpacing),this.requiredInputs=new y(e.requiredInputs),this.optionalInputs=new f(e.optionalInputs))},O=function(e){this.label=new C,this.errorMessage=new f({color:o.v.Attention}),e&&(this.label=new C(e.label),this.errorMessage=new f(e.errorMessage))},S=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.wrap=!0,t}return Object(r.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(f),E=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.x.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=l(o.x,t.weight,o.x.Bolder)),n}return Object(r.__extends)(t,e),t.prototype.getDefaultWeight=function(){return o.x.Bolder},t}(S),x=function(e){this.rowGap=10,"object"==typeof e&&(this.rowGap="number"==typeof e.rowGap?Math.max(e.rowGap,0):this.rowGap)},I=function(e){function t(t){var n=e.call(this,t)||this;return n.columnGap=10,"object"==typeof t&&(n.columnGap="number"==typeof t.columnGap?Math.max(t.columnGap,0):n.columnGap),n}return Object(r.__extends)(t,e),t}(x),w=function(e){function t(t){var n=e.call(this,t)||this;return n.titleValueGap=0,"object"==typeof t&&(n.titleValueGap="number"==typeof t.titleValueGap?Math.max(t.titleValueGap,0):n.titleValueGap),n}return Object(r.__extends)(t,e),t}(x),T=function(e){this.title=new E,this.value=new S,this.tableLayout=new I,this.stackLayout=new w,this.layoutSwitchBreakpoint=o.j.Standard,"object"==typeof e&&(this.title=new E(e.title),this.value=new S(e.value),this.tableLayout=new I(e.tableLayout),this.stackLayout=new w(e.stackLayout),this.layoutSwitchBreakpoint=l(o.j,e.layoutSwitchBreakpoint,o.j.Standard))},k=function(){function e(e){this.actionMode=o.q.Inline,this.inlineTopMargin=16,this.style=o.f.Emphasis,e&&(this.actionMode=l(o.q,e.actionMode,o.q.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.f.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.q[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}(),j=function(){function e(e){if(this.maxActions=5,this.spacing=o.t.Default,this.buttonSpacing=20,this.showCard=new k,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.p.Horizontal,this.actionAlignment=o.a.Left,this.iconPlacement=o.c.LeftOfTitle,this.allowTitleToWrap=!1,this.allowButtonsToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=l(o.t,e.spacing&&e.spacing,o.t.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new k(e.showCard),this.preExpandSingleShowCardAction=Object(s.g)(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=l(o.p,e.actionsOrientation,o.p.Horizontal),this.actionAlignment=l(o.a,e.actionAlignment,o.a.Left),this.iconPlacement=l(o.c,e.iconPlacement,o.c.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap,this.allowButtonsToWrap=null!=e.allowButtonsToWrap?e.allowButtonsToWrap:this.allowTitleToWrap;try{var t=a.c.parse(e.iconSize);t.unit===o.s.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.t[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.p[this.actionsOrientation],actionAlignment:o.a[this.actionAlignment]}},e}(),P=function(){function e(e){this.default=new u,this.dark=new u,this.light=new u,this.accent=new u,this.good=new u,this.warning=new u,this.attention=new u,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e.prototype.getColorDefinition=function(e){switch(e){case o.v.Accent:return this.accent;case o.v.Dark:return this.dark;case o.v.Light:return this.light;case o.v.Good:return this.good;case o.v.Warning:return this.warning;case o.v.Attention:return this.attention;default:return this.default}},e}(),A=function(){function e(e){this.foregroundColors=new P({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(A),D=function(){function e(e){var t,n;if(this._allStyles={},this._allStyles[o.f.Default]=new _,this._allStyles[o.f.Emphasis]=new _,this._allStyles[o.f.Accent]=new _,this._allStyles[o.f.Good]=new _,this._allStyles[o.f.Attention]=new _,this._allStyles[o.f.Warning]=new _,e){this._allStyles[o.f.Default].parse(e[o.f.Default]),this._allStyles[o.f.Emphasis].parse(e[o.f.Emphasis]),this._allStyles[o.f.Accent].parse(e[o.f.Accent]),this._allStyles[o.f.Good].parse(e[o.f.Good]),this._allStyles[o.f.Attention].parse(e[o.f.Attention]),this._allStyles[o.f.Warning].parse(e[o.f.Warning]);var i=e.customStyles;if(i&&Array.isArray(i))try{for(var a=Object(r.__values)(i),s=a.next();!s.done;s=a.next()){var l=s.value;if(l){var c=l.name;c&&"string"==typeof c&&(this._allStyles.hasOwnProperty(c)?this._allStyles[c].parse(l.style):this._allStyles[c]=new A(l.style))}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[o.f.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.f.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.f.Emphasis]},enumerable:!1,configurable:!0}),e}(),L=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}(),M=function(){function e(e){this.default=new L,this.monospace=new L("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.h.Monospace:return this.monospace;case o.h.Default:default:return this.default}},e}(),B=function(){function e(e){this.hostCapabilities=new i.a,this.designMode=!1,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.hostWidthBreakpoints={veryNarrow:216,narrow:345,standard:500},this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.roundedCornerRadius=6,this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new D,this.inputs=new O,this.actions=new j,this.adaptiveCard=new d,this.imageSet=new p,this.media=new g,this.factSet=new T,this.table=new h,this.textStyles=new v,this.textBlock=new b,this.alwaysAllowBleed=!1,this._legacyFontType=new L,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new M(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new D(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new O(e.inputs||this.inputs),this.actions=new j(e.actions||this.actions),this.adaptiveCard=new d(e.adaptiveCard||this.adaptiveCard),this.imageSet=new p(e.imageSet),this.factSet=new T(e.factSet),this.textStyles=new v(e.textStyles),this.textBlock=new b(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===o.h.Monospace?L.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.t.Small:return this.spacing.small;case o.t.Default:return this.spacing.default;case o.t.Medium:return this.spacing.medium;case o.t.Large:return this.spacing.large;case o.t.ExtraLarge:return this.spacing.extraLarge;case o.t.Padding:return this.spacing.padding;default:return 0}},e.prototype.getHostWidthForPixelWidth=function(e){return e<=this.hostWidthBreakpoints.veryNarrow?o.j.VeryNarrow:e<=this.hostWidthBreakpoints.narrow?o.j.Narrow:e<=this.hostWidthBreakpoints.standard?o.j.Standard:o.j.Wide},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new a.d(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=[];try{for(var a=Object(r.__values)(n),s=a.next();!s.done;s=a.next()){var l=s.value;i.push((this.cssClassNamePrefix?"".concat(this.cssClassNamePrefix,"-"):"")+l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,Object(r.__spreadArray)([],Object(r.__read)(e),!1)).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}(),R=new B({preExpandSingleShowCardAction:!0,supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:40,medium:80,large:160},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{borderColor:"#CCCCCC",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{borderColor:"#666666",backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:"default",buttonSpacing:10,showCard:{actionMode:"inline",inlineTopMargin:16},actionsOrientation:"horizontal",actionAlignment:"left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"medium",maxImageHeight:100},factSet:{title:{color:"default",size:"default",isSubtle:!1,weight:"bolder",wrap:!0,maxWidth:150},value:{color:"default",size:"default",isSubtle:!1,weight:"default",wrap:!0},tableLayout:{columnGap:10,rowGap:6},stackLayout:{rowGap:10},layoutSwitchBreakpoint:"standard"}})},316:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"i",(function(){return A})),n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return D})),n.d(t,"j",(function(){return L})),n.d(t,"k",(function(){return M})),n.d(t,"g",(function(){return B})),n.d(t,"h",(function(){return R})),n.d(t,"f",(function(){return F}));var r,o,i,a=n(2),s=n(207),l=n(681),c=n(1489),u=n(485),d=n(1151),p=n(105),g=n(829),h=n(721),f=n(325),m=n(52),v=n(239),b=n(323),y=n(171),C=n(17),O=n(75),S=n(44),E=n(448),x=[],I=null,w=null,T=null,k=null,j=!0,P=!1,A=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return y.a.getInstance().sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.CurrentChatHistoryStart},{key:C.g.ChatEventParameters,value:(new Date).getTime().toString()}]),o=(new Date).getTime(),[4,_(s.c.GetCurrentChatOperation,void 0,e,t)];case 1:return n.sent(),[2]}}))}))},_=function(e,t,n,o,p){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var g,w,j,A,_,D,L,M;return Object(a.__generator)(this,(function(a){switch(g={},w=new l.a,j=Date.now(),A=y.a.getInstance(),_=Object(E.b)(),e){case s.c.AddChatOperation:"dummyUserId","dummyDocId",D={userId:"dummyUserId",documentId:"dummyDocId",sessionId:Object(u.a)(),messages:[]},g={newChat:D,type:s.c.AddChatOperation},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P});break;case s.c.GetAllChatsOperation:L={pageSize:S.h,syncState:p?void 0:k},g={type:s.c.GetAllChatsOperation,paging:L},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P});break;case s.c.GetCurrentChatOperation:L={pageSize:S.j},g={type:s.c.GetCurrentChatOperation,paging:o&&o.isFeatureGateEnabledFromClient(O.h.IsChatHistoryPaginationEnabled)?L:void 0},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P});break;case s.c.GetMessagesOperation:L={pageSize:S.j,syncState:p?void 0:T},I=null!=p?p:I,g={type:s.c.GetMessagesOperation,chatSessionId:I,paging:L,setSessionAsCurrent:!!p},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P});break;case s.c.AddMessageOperation:x.push(t.messageId),g={newMessage:t,type:s.c.AddMessageOperation,chatSessionId:I},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P});break;case s.c.DeleteChatOperation:g={type:s.c.DeleteChatOperation,chatSessionId:p},w=new l.a({operation:g,documentURLOrLocalPath:n,timestamp:j,documentSensitivity:i,orchestratorGroundingMode:_,isFluxChatHistoryAnnotationActivated:P})}return M=new c.b({parentPath:["Signal",l.a.getTypeName()],items:[{id:d.a.generateId(),body:w}]}),b.a.getInstance().sendLoggingEventToClient(v.g.ChatHistorySignalSent,{timestamp:(new Date).getTime(),signalName:l.a.getTypeName(),operationType:e}),A.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.ChatHistorySignalSent},{key:C.g.ChatEventParameters,value:"".concat(l.a.getTypeName(),"_").concat(e)}]),Object(m.c)("Submitting signal to Augloop : ".concat(l.a.getTypeName()," with operation type: ").concat(e," and signal: ").concat(JSON.stringify(w))),(null==t?void 0:t.content)&&Object(m.c)("sending message: ".concat(t.content)),f.a.getInstance().submitOperation(M,l.a.getTypeName()),r=(new Date).getTime(),e===s.c.GetCurrentChatOperation&&h.a.getInstance().setAugloopResponseTimer(),[2]}))}))},D=function(e,t,n,o,i,c,u,d,f,S){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var E,P,A,D,L,M,B,F,N,H,U,V,z,G,W,Q,q,K,Y,Z,J,X,$,ee,te,ne;return Object(a.__generator)(this,(function(re){switch(re.label){case 0:switch(E=null===(Q=null===(W=e.body)||void 0===W?void 0:W.H_)||void 0===Q?void 0:Q.T_,Object(m.c)("".concat(l.a.getTypeName()," response. Time Taken : ").concat(Object(p.c)(r)," sec \n")),P=null==e?void 0:e.body,A=null==P?void 0:P.operationResponse,D=y.a.getInstance(),b.a.getInstance().sendLoggingEventToClient(v.g.ChatHistoryResponseReceived,{timeInMs:Object(p.b)(r),annotationName:E,operationType:A.type}),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.ResponseReceivedFromAL},{key:C.g.ChatEventParameters,value:"".concat(E,"_").concat(A.type)},{key:C.g.Cv,value:S}]),L={operationType:s.c.GetChatOperation,augloopResponseTime:-1},M=Object(p.c)(r),A.type){case s.c.GetCurrentChatOperation:return[3,1];case s.c.GetMessagesOperation:return[3,7];case s.c.GetAllChatsOperation:return[3,8];case s.c.GetChatOperation:return[3,9];case s.c.GetMessagesInCurrentChatSession:return[3,10];case s.c.AddChatOperation:return[3,11];case s.c.AddMessageOperation:return[3,12];case s.c.DeleteChatOperation:return[3,13]}return[3,14];case 1:return V=A,L={operationType:s.c.GetCurrentChatOperation,augloopResponseTime:M},T=null===(q=V.paging)||void 0===q?void 0:q.syncState,V.chat?[3,5]:(h.a.getInstance().setHasExistingChat(!1),f?[3,3]:[4,_(s.c.AddChatOperation)]);case 2:return re.sent(),[3,4];case 3:h.a.getInstance().clearAugloopResponseTimer(),re.label=4;case 4:return[3,6];case 5:I=null===(K=V.chat)||void 0===K?void 0:K.sessionId,w=I,Object(m.c)("chatSessionId from GetCurrentChatOperation: "+I),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.ChatHistorySessionLoaded},{key:C.g.ChatEventParameters,value:(new Date).getTime().toString()}]),0===n&&V.chat&&h.a.getInstance().isAugloopResponseTimerSet&&Object(g.c)(o,V.chat.messages,t),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.GetCurrentChatStatus},{key:C.g.ChatEventParameters,value:A.status}]),A.status!==s.e.Success&&h.a.getInstance().isAugloopResponseTimerSet&&(o.sendEventToClient(v.c.ChatHistoryHydrationFailed),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.ChatHistoryHydrationFailed}])),h.a.getInstance().clearAugloopResponseTimer(),re.label=6;case 6:return null==c||c(null!==(Z=null===(Y=V.chat)||void 0===Y?void 0:Y.plugins)&&void 0!==Z?Z:[]),[3,14];case 7:if(T=null===(J=(V=A).paging)||void 0===J?void 0:J.syncState,d&&(V.status===s.e.Success?(x=[],j=!0,w=I,0===(null===(X=V.messages)||void 0===X?void 0:X.length)&&(null==d||d((function(){return[]})))):(I=w,null==d||d())),(null===($=V.messages)||void 0===$?void 0:$.length)>0){B=[];try{for(F=Object(a.__values)(V.messages),N=F.next();!N.done;N=F.next())H=N.value,o.isFeatureGateEnabledFromClient(O.h.DisableChatHistoryPaginationFix)||x.includes(H.messageId)||(B.push(H),x.push(H.messageId))}catch(e){z={error:e}}finally{try{N&&!N.done&&(G=F.return)&&G.call(F)}finally{if(z)throw z.error}}(null==B?void 0:B.length)>0&&(j=!0,U=function(e){var t=d?[]:e,n=Object(g.d)(B);return Object(a.__spreadArray)(Object(a.__spreadArray)([],Object(a.__read)(n),!1),Object(a.__read)(t),!1)},d?d(U):t(U))}else V.status!==s.e.Failure&&(j=!1);return D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.GetMessagesStatus},{key:C.g.ChatEventParameters,value:V.status}]),[3,14];case 8:return A.status===s.e.Success&&(k=null!==(te=null===(ee=A.paging)||void 0===ee?void 0:ee.syncState)&&void 0!==te?te:k,null==u||u(A.chats)),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.GetAllChatStatus},{key:C.g.ChatEventParameters,value:A.status}]),[3,14];case 9:case 10:return[3,14];case 11:return L={operationType:s.c.AddChatOperation,augloopResponseTime:M},A.status===s.e.Success&&(f?R():(I=null===(ne=A.chats)||void 0===ne?void 0:ne[0].sessionId,w=I),Object(m.c)("chatSessionId from AddChatOperation: "+I)),h.a.getInstance().clearAugloopResponseTimer(),i&&i(),[3,14];case 12:return L={operationType:s.c.AddMessageOperation,augloopResponseTime:M},f&&A.status===s.e.Success&&(I=A.chat.sessionId,w=I,Object(m.c)("chatSessionId from AddMessageOperation: "+I)),D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.AddMessageStatus},{key:C.g.ChatEventParameters,value:A.status}]),[3,14];case 13:return V=A,D.sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.DeleteMessageStatus},{key:C.g.ChatEventParameters,value:V.status}]),[3,14];case 14:return-1!==L.augloopResponseTime&&(y.a.getInstance().addChatHistoryInfoLog(L),y.a.getInstance().sendTelemetryLatencyData([])),[2]}}))}))},L=function(e){(null==e?void 0:e.isEncrypted)?y.a.getInstance().sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.CLPEncryptedLabelSent}]):y.a.getInstance().sendTelemetryChatEventData([{key:C.g.ChatEventType,value:C.f.CLPNonEncryptedLabelSent}]),i=e},M=function(e){P=e},B=function(){r=void 0,I=null,w=null,T=null,x=[],j=!0,i=void 0,P=!1,k=null},R=function(){I="",w="",T=null,k=null,x=[],j=!0},F=function(){k=null}},317:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"d",(function(){return h}));var r=n(2),o=n(718);n(389);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=e.className?e.className.split(/\s+/g):[];o.push.apply(o,Object(r.__spreadArray)([],Object(r.__read)(t),!1)),e.className=o.join(" ")}function a(){return{style:{}}}function s(e,t){return"string"==typeof e?e:t}function l(e,t){return"number"==typeof e?e:t}function c(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t}function u(e,t,n){for(var r=e;r.length<n;)r=t+r;return r}function d(e){var t=e.getFullYear(),n=u((e.getMonth()+1).toString(),"0",2),r=u(e.getDate().toString(),"0",2);return"".concat(t,"-").concat(n,"-").concat(r)}function p(e,t,n){if(!t)return n;var r=Object(o.b)(e,t);return void 0!==r?r:n}function g(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255,r=parseInt(t[2],16),o=parseInt(t[3],16),i=parseInt(t[4],16);return"rgba(".concat(r,",").concat(o,",").concat(i,",").concat(n,")")}}return e}function h(e,t){return void 0===t&&(t={}),Object.entries(t).forEach((function(t){var n=Object(r.__read)(t,2),o=n[0],i=n[1],a=void 0!==i?i.toString():"";e=e.replace(new RegExp("{{".concat(o,"}}"),"g"),a)})),e}},32:function(e,t,n){"use strict";n.d(t,"r",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"e",(function(){return C})),n.d(t,"l",(function(){return O})),n.d(t,"p",(function(){return S})),n.d(t,"k",(function(){return E})),n.d(t,"c",(function(){return x})),n.d(t,"j",(function(){return w})),n.d(t,"o",(function(){return T})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return P}));var r=n(2),o=n(675),i=n(28),a=n(161),s=n(175),l=n(147),c=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var r=new e;r._versionString=t;var o=/(\d+).(\d+)/gi.exec(t);return null!=o&&3===o.length?(r._major=parseInt(o[1],10),r._minor=parseInt(o[2],10)):r._isValid=!1,r._isValid||n.logParseEvent(void 0,i.A.InvalidPropertyValue,s.a.errors.invalidVersionString(r._versionString)),r}},e.prototype.toString=function(){return this._isValid?"".concat(this._major,".").concat(this._minor):this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}(),u=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=[];for(var n in e)if(n.match(/^v[0-9_]*$/))try{var r=e[n];r instanceof c&&t.push(r)}catch(e){}return t.sort((function(e,t){return e.compareTo(t)}))},e.v1_0=new c(1,0),e.v1_1=new c(1,1),e.v1_2=new c(1,2),e.v1_3=new c(1,3),e.v1_4=new c(1,4),e.v1_5=new c(1,5),e.v1_6=new c(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();var d=function(){function e(e){void 0===e&&(e=u.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.serializeValue=function(e,t,n,r,o){void 0===r&&(r=void 0),void 0===o&&(o=!1),null==n||n===r?o&&delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeDate=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=Object(l.c)(n)},e.prototype.serializeBool=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,r){null==n||isNaN(n)||n===r?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,r,o){void 0===o&&(o=void 0),null==r||r===o?delete t[n]:t[n]=e[r]},e.prototype.serializeArray=function(e,t,n){var o,i,a=[];if(n)try{for(var s=Object(r.__values)(n),l=s.next();!l.done;l=s.next()){var c=l.value,u=void 0;void 0!==(u=c instanceof w?c.toJSON(this):c.toJSON?c.toJSON():c)&&a.push(u)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}0===a.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,a)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,i.B.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e.prototype.shouldFailRendering=function(){return a.a.failRenderingWhenUnknownPropertiesAreFound&&this._validationEvents.some((function(e){return e.event===i.A.UnknownProperty}))||a.a.failRenderingWhenInvalidPropertyValuesAreFound&&this._validationEvents.some((function(e){return e.event===i.A.InvalidPropertyValue}))},e.prototype.hasEvent=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._validationEvents.some((function(t){return e.includes(t.event)}))},e.prototype.getAttachableElementProperties=function(){return[]},e.prototype.getAttachableElementProperty=function(e){},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(d),g=function(){function e(t,n,r,o){this.targetVersion=t,this.name=n,this.defaultValue=r,this.onGetInitialValue=o,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)},e.prototype.preProcessValue=function(e){return e},e.prototype.getDescriptor=function(e){return{valueType:"any",isArray:!1,defaultValue:this.defaultValue}},e._sequentialNumber=0,e}(),h=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.regEx=r,a.defaultValue=o,a.onGetInitialValue=i,a.isImageUrl=!1,a}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=Object(l.k)(t[this.name],this.defaultValue);if((""===r&&(r=void 0),r&&void 0!==this.regEx)&&!this.regEx.exec(r))return void n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.invalidPropertyValue(r,this.name));return r},t.prototype.toJSON=function(e,t,n,r){r.serializeString(t,this.name,""===n?void 0:n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"string",defaultValue:this.defaultValue,isArray:!1,isImageUrl:this.isImageUrl}},t}(g),f=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return Object(l.g)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"boolean",defaultValue:this.defaultValue,isArray:!1}},t}(g),m=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return Object(l.j)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"number",defaultValue:this.defaultValue,isArray:!1}},t}(g),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,o=t[this.name];if("string"==typeof o){var l=!1;try{var c=a.c.parse(o,!0);c.unit===i.s.Pixel&&(r=c.physicalSize,l=!0)}catch(e){}l||n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.invalidPropertyValue(t[this.name],"minHeight"))}return r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))},t.prototype.getDescriptor=function(e){return{valueType:"string",description:'Format is "<number>px"',defaultValue:this.defaultValue,isArray:!1}},t}(g),b=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,a,s=t[this.name];if(void 0===s||!Array.isArray(s))return this.defaultValue;var l=[];try{for(var c=Object(r.__values)(s),u=c.next();!u.done;u=c.next()){var d=u.value;"string"==typeof d?l.push(d):n.logParseEvent(e,i.A.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(d),'" of type "').concat(typeof d,'" ignored for "').concat(this.name,'".'))}}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return l},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:"string",defaultValue:this.defaultValue,isArray:!0}},t}(g),y=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.values=r,a.defaultValue=o,a.onGetInitialValue=i,a}return Object(r.__extends)(t,e),t.prototype.isValidValue=function(e,t){var n,o;try{for(var i=Object(r.__values)(this.values),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.toLowerCase()===s.value.toLowerCase())return(s.targetVersion?s.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.parse=function(e,t,n){var o,a,l=t[this.name];if(void 0===l)return this.defaultValue;if("string"==typeof l)try{for(var c=Object(r.__values)(this.values),u=c.next();!u.done;u=c.next()){var d=u.value;if(l.toLowerCase()===d.value.toLowerCase()){var p=d.targetVersion?d.targetVersion:this.targetVersion;return p.compareTo(n.targetVersion)<=0?d.value:(n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(l,this.name,p.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.invalidPropertyValue(l,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,o){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=Object(r.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){var g=p.targetVersion?p.targetVersion:this.targetVersion;if(g.compareTo(o.targetVersion)<=0){c=!1;break}o.logEvent(e,i.B.ToJSON,i.A.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(n,this.name,g.toString(),o.targetVersion.toString()))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||o.serializeValue(t,this.name,n,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:this.values.map((function(e){return e.value})),defaultValue:this.defaultValue,isArray:!1}},t}(g),C=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=r,s.defaultValue=o,s.onGetInitialValue=a,s._values=[],i)s._values=i;else for(var l in r){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var a,l,c=t[this.name];if("string"!=typeof c)return this.defaultValue;var u=Object(o.b)(this.enumType,c);if(void 0!==u)try{for(var d=Object(r.__values)(this.values),p=d.next();!p.done;p=d.next()){var g=p.value;if(g.value===u){var h=g.targetVersion?g.targetVersion:this.targetVersion;return h.compareTo(n.targetVersion)<=0?u:(n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.propertyValueNotSupported(c,this.name,h.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){a={error:e}}finally{try{p&&!p.done&&(l=d.return)&&l.call(d)}finally{if(a)throw a.error}}return n.logParseEvent(e,i.A.InvalidPropertyValue,s.a.errors.invalidPropertyValue(c,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,o){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=Object(r.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){if((p.targetVersion?p.targetVersion:this.targetVersion).compareTo(o.targetVersion)<=0){c=!1;break}o.logEvent(e,i.B.ToJSON,i.A.InvalidPropertyValue,s.a.errors.invalidPropertyValue(n,this.name))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||o.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueType:"string",values:Object(o.a)(this.enumType),defaultValue:void 0!==this.defaultValue?this.enumType[this.defaultValue]:void 0,isArray:!1}},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(g),O=function(e){function t(t,n,r,o,i){void 0===o&&(o=!1);var a=e.call(this,t,n,i,(function(e){return a.nullable?void 0:a.createInstance()}))||this;return a.targetVersion=t,a.name=n,a.createInstance=r,a.nullable=o,a}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var o=this.createInstance(t);return o.parse(r,n),o},t.prototype.toJSON=function(e,t,n,r){var o;void 0===n||n.hasAllDefaultValues()||(o=n.toJSON(r)),"object"==typeof o&&0===Object.keys(o).length&&(o=void 0),r.serializeValue(t,this.name,o,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueType:new P(this.createInstance()),defaultValue:this.defaultValue,isArray:!1}},t}(g),S=function(e){function t(t,n,r,o,i,a){void 0===i&&(i=!1);var s=e.call(this,t,n,o,i,a)||this;return s.targetVersion=t,s.name=n,s.objectTypeName=r,s.createInstance=o,s.nullable=i,s}return Object(r.__extends)(t,e),t.prototype.parse=function(t,n,r){var o=n[this.name];if("object"==typeof o&&"type"in o&&o.type===this.objectTypeName)return e.prototype.parse.call(this,t,n,r)},t}(O),E=function(e){function t(t,n,r,o){var i=e.call(this,t,n,void 0,(function(e){return[]}))||this;return i.targetVersion=t,i.name=n,i.createInstance=r,i.onItemAdded=o,i}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=Object(r.__values)(s),c=l.next();!c.done;c=l.next()){var u=c.value,d=this.createInstance(u);d&&(d.parse(u,n),a.push(d),this.onItemAdded&&this.onItemAdded(e,d))}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return a.length>0?a:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){var t=this.createInstance();return{valueType:t?new P(t):"object",defaultValue:this.defaultValue,isArray:!0}},t}(g),x=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,i,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=r,s.onToJSON=o,s.defaultValue=i,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,r){this.onToJSON(e,this,t,n,r)},t}(g),I=function(){function e(e){this.key=e,this._properties=new Map}return e.prototype.add=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=Object(r.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)||this._properties.set(s.name,s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.remove=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=Object(r.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)&&this._properties.delete(s.name)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.getItem=function(e){return this._properties.get(e)},Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties.values()},enumerable:!1,configurable:!0}),e}(),w=function(){function e(){var t,n;this._isParsing=!1,this._propertyBag={},this._rawProperties={},this.key=e.currentKey++,this.maxVersion=e.defaultMaxVersion;var o=this.getSchema();try{for(var i=Object(r.__values)(o.properties),a=i.next();!a.done;a=i.next()){var s=a.value;s.onGetInitialValue&&this.setValue(s,s.onGetInitialValue(this))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return e.prototype.propertyChanged=function(e,t){this.onPropertyChanged&&this.onPropertyChanged(this,e,t)},e.prototype.afterParse=function(){},e.prototype.getDefaultSerializationContext=function(){return new p},e.prototype.populateSchema=function(t){var n=[];for(var o in this.constructor)try{var i=this.constructor[o];i instanceof g&&n.push(i)}catch(e){}if(n.length>0){var a=n.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,Object(r.__spreadArray)([],Object(r.__read)(a),!1))}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getAttachableProperties=function(e){return[]},e.prototype.internalParse=function(e,t){var n,o;if(!this._isParsing){this._isParsing=!0;try{if(this._propertyBag={},this._rawProperties=a.a.enableFullJsonRoundTrip&&e||{},e){var l=this.getSchema(),c=this.getAdditionalValidSchemaProperties();for(var u in e)l.getItem(u)||c.includes(u)||t.getAttachableElementProperty(u)||t.logParseEvent(this,i.A.UnknownProperty,s.a.errors.unknownProperty(u));var d=Array.from(l.properties).concat(this.getAttachableProperties(t));try{for(var p=Object(r.__values)(d),g=p.next();!g.done;g=p.next()){var h=g.value;if(h.isSerializationEnabled){var f=h.onGetInitialValue?h.onGetInitialValue(this):void 0;e.hasOwnProperty(h.name)&&(h.targetVersion.compareTo(t.targetVersion)<=0?f=h.parse(this,e,t):t.logParseEvent(this,i.A.UnsupportedProperty,s.a.errors.propertyNotSupported(h.name,h.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(h,f)}}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}else this.resetDefaultValues()}finally{this._isParsing=!1,this.afterParse()}}},e.prototype.internalToJSON=function(e,t){var n,o,i=this.getSchema(),a=[];try{for(var s=Object(r.__values)(i.properties),l=s.next();!l.done;l=s.next()){var c=l.value;c.isSerializationEnabled&&c.targetVersion.compareTo(t.targetVersion)<=0&&-1===a.indexOf(c.name)&&(c.toJSON(this,e,this.getValue(c),t),a.push(c.name))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.getAdditionalPropertyDescriptors=function(e){return[]},e.prototype.reflect=function(e){var t,n,o,i,a=this.getSchema(),s=this.getAdditionalPropertyDescriptors(e),l=new Map,c=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(a.properties),!1),Object(r.__read)(this.getAttachableProperties(e)),!1);try{for(var u=Object(r.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value;l.set(p.name,Object(r.__assign)({name:p.name},p.getDescriptor(e)))}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}try{for(var g=Object(r.__values)(s),h=g.next();!h.done;h=g.next()){p=h.value;l.set(p.name,p)}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}return Object(r.__spreadArray)([],Object(r.__read)(l.values()),!1)},e.prototype.getAdditionalValidSchemaProperties=function(){return[]},e.prototype.getSerializationContext=function(){return this.getDefaultSerializationContext()},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){var n=this,r=function(e,t){n._isParsing||n.propertyChanged(e,t)};if(null==t)this._propertyBag.hasOwnProperty(e.getInternalName())&&(delete this._propertyBag[e.getInternalName()],r(e,t));else{var o=e.preProcessValue(t);this._propertyBag[e.getInternalName()]!==o&&(this._propertyBag[e.getInternalName()]=o,r(e,o))}},e.prototype.parse=function(e,t){var n=null!=t?t:this.getSerializationContext();this.internalParse(e,n),n.onAfterObjectParsed&&n.onAfterObjectParsed(this,e)},e.prototype.toJSON=function(e){var t=e&&e instanceof d?e:this.getSerializationContext();if(this.shouldSerialize(t)){var n=void 0;return n=a.a.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){var e,t,n=this.getSchema();try{for(var o=Object(r.__values)(n.properties),i=o.next();!i.done;i=o.next()){var a=i.value;if(!this.hasDefaultValue(a))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!0},e.prototype.resetDefaultValues=function(){var e,t,n=this.getSchema();try{for(var o=Object(r.__values)(n.properties),i=o.next();!i.done;i=o.next()){var a=i.value;this.setValue(a,a.defaultValue)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new I(this.getSchemaKey()),this.populateSchema(t),e._schemaCache[t.key]=t),t},e.currentKey=0,e.defaultMaxVersion=u.latest,e._schemaCache={},e}(),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},t.typeNameProperty=new h(u.v1_0,"type",void 0,void 0,(function(e){return e.getJsonTypeName()})),t}(w),k=function(){},j=function(e){function t(t,n){var r=e.call(this)||this;return r._name=t,r._properties=n,r}return Object(r.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}(k),P=function(e){function t(t,n){var r=e.call(this)||this;return r._objectToReflect=t,r._name=n,r}return Object(r.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties||(this._properties=this._objectToReflect.reflect(e)),this._properties},Object.defineProperty(t.prototype,"name",{get:function(){var e;return null!==(e=this._name)&&void 0!==e?e:this._objectToReflect.getSchemaKey()},enumerable:!1,configurable:!0}),t}(k)},321:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b}));var r=n(2),o=n(1005),i=n(28),a=n(175),s=n(32),l=n(147),c=n(181),u=n(161),d=n(1451),p=function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==r){if(r instanceof o.a)return r;n.logParseEvent(e,i.A.ActionTypeNotAllowed,a.a.errors.actionTypeNotAllowed(r.getJsonTypeName()))}n.logParseEvent(e,i.A.PropertyCantBeNull,a.a.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t.prototype.getDescriptor=function(e){return{valueType:new s.d(new o.a),isArray:!1}},t}(s.i),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userIds",{get:function(){return this.getValue(t.userIdsProperty)},set:function(e){this.setValue(t.userIdsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new p(s.s.v1_4,"action"),t.userIdsProperty=new s.m(s.s.v1_4,"userIds"),t}(s.j),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},Object.defineProperty(t.prototype,"type",{get:function(){return this.getValue(t.typeProperty)},set:function(e){this.setValue(t.typeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this.getValue(t.imageProperty)},set:function(e){this.setValue(t.imageProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.typeProperty=new s.n(s.s.v1_4,"type"),t.titleProperty=new s.n(s.s.v1_4,"title"),t.imageProperty=new s.n(s.s.v1_4,"image"),t.valueProperty=new s.n(s.s.v1_4,"value"),t}(s.j),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uri",{get:function(){return this.getValue(t.uriProperty)},set:function(e){this.setValue(t.uriProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"providerId",{get:function(){return this.getValue(t.providerIdProperty)},set:function(e){this.setValue(t.providerIdProperty,e)},enumerable:!1,configurable:!0}),t.idProperty=new s.n(s.s.v1_4,"id"),t.uriProperty=new s.n(s.s.v1_4,"uri"),t.providerIdProperty=new s.n(s.s.v1_4,"providerId"),t}(s.j),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setValue(t.textProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionName",{get:function(){return this.getValue(t.connectionNameProperty)},set:function(e){this.setValue(t.connectionNameProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buttons",{get:function(){return this.getValue(t.buttonsProperty)},set:function(e){this.setValue(t.buttonsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this.getValue(t.tokenExchangeResourceProperty)},set:function(e){this.setValue(t.tokenExchangeResourceProperty,e)},enumerable:!1,configurable:!0}),t.textProperty=new s.n(s.s.v1_4,"text"),t.connectionNameProperty=new s.n(s.s.v1_4,"connectionName"),t.buttonsProperty=new s.k(s.s.v1_4,"buttons",(function(e){return new h})),t.tokenExchangeResourceProperty=new s.l(s.s.v1_4,"tokenExchangeResource",(function(e){return new f}),!0),t}(s.j),v=function(e){function t(t,n){var r=e.call(this,t,n,s.s.v1_0)||this;return r.targetVersion=t,r.name=n,r}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=s.r.parse(t[this.name],n);return void 0===r&&(r=s.s.latest,n.logParseEvent(e,i.A.InvalidPropertyValue,a.a.errors.invalidCardVersion(r.toString()))),r},t.prototype.toJSON=function(e,t,n,r){void 0!==n&&r.serializeValue(t,this.name,n.toString())},t.prototype.getDescriptor=function(e){return{valueType:"string",values:s.s.getAllDeclaredVersions().map((function(e){return e.toString()})),defaultValue:this.defaultValue.toString(),isArray:!1}},t}(s.i),b=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.isFocusable=!0,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return this.getValue(t.versionProperty)},set:function(e){this.setValue(t.versionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fallbackText",{get:function(){return this.getValue(t.fallbackTextProperty)},set:function(e){this.setValue(t.fallbackTextProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speak",{get:function(){return this.getValue(t.speakProperty)},set:function(e){this.setValue(t.speakProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authentication",{get:function(){return this.getValue(t.authenticationProperty)},set:function(e){this.setValue(t.authenticationProperty,e)},enumerable:!1,configurable:!0}),t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getRootCard=function(){if(!this.parent)return this;var e=this.getRootObject();return e instanceof t?e:this},t.prototype.shouldDisplayBuiltInOverflowActionButton=function(e){var n,r=null!==(n=this.getRootCard().onShouldDisplayBuiltInOverflowActionButton)&&void 0!==n?n:t.onShouldDisplayBuiltInOverflowActionButton;return void 0===r||r(e.getActions(),e.isAtRootLevel)},t.prototype.shouldDisplayBuiltInOverflowActionMenu=function(e){var n,r=null!==(n=this.getRootCard().onShouldDisplayBuiltInOverflowActionMenu)&&void 0!==n?n:t.onShouldDisplayBuiltInOverflowActionMenu;return void 0===r||r(e.isAtRootLevel)},t.prototype.displayOverflowActionMenu=function(e,n){var r,o=null!==(r=this.getRootCard().onDisplayOverflowActionMenu)&&void 0!==r?r:t.onDisplayOverflowActionMenu;void 0!==o&&o(e.getActions(),n)},t.prototype.actionExecuted=function(e){var n,r=null!==(n=this.getRootCard().onExecuteAction)&&void 0!==n?n:t.onExecuteAction;r&&r(e)},t.prototype.elementVisibilityChanged=function(e){var n,r=null!==(n=this.getRootCard().onElementVisibilityChanged)&&void 0!==n?n:t.onElementVisibilityChanged;r&&r(e)},t.prototype.internalRender=function(t){return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,this._fallbackCard.render()):e.prototype.internalRender.call(this)},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),Object(l.a)(t,this.hostConfig.makeCssClassName("ac-adaptiveCard")),this.isFocusable&&(t.tabIndex=0),this.speak&&(t["aria-label"]=this.speak)},t.prototype.getDefaultSerializationContext=function(){return new c.g(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.internalParse=function(n,r){this._fallbackCard=void 0;var o=r.parseElement(void 0,n.fallback,this.forbiddenChildElements(),!this.isDesignMode());o&&(this._fallbackCard=new t,this._fallbackCard.addItem(o)),e.prototype.internalParse.call(this,n,r)},t.prototype.internalToJSON=function(n,r){this.setValue(t.versionProperty,r.targetVersion),e.prototype.internalToJSON.call(this,n,r)},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!0},t.prototype.getHasBorder=function(){return!1},t.prototype.getHasRoundedCorners=function(){return!1},t.prototype.getDefaultPadding=function(){return new u.b(i.t.Padding,i.t.Padding,i.t.Padding,i.t.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.getAdditionalPropertyDescriptors=function(n){return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,n)),!1),[{name:"$schema",valueType:"string",defaultValue:t.schemaUrl,isArray:!1}],!1)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(c.d.typeNameProperty)&&t.addFailure(this,i.A.MissingCardType,a.a.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,i.A.UnsupportedCardVersion,a.a.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,i.A.PropertyCantBeNull,a.a.errors.propertyMustBeSet("version"))},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},t.prototype.renderImage=function(n,r){var o;if(this.parent)return this.parent.renderImage(n,r);var i=null!==(o=this.onRenderImage)&&void 0!==o?o:t.onRenderImage;return i?i(n,r):e.prototype.renderImage.call(this,n,r)},t.prototype.renderAnchor=function(n,r){var o;if(this.parent)return this.parent.renderAnchor(n,r);var i=null!==(o=this.onRenderAnchor)&&void 0!==o?o:t.onRenderAnchor;return i?i(n,r):e.prototype.renderAnchor.call(this,n,r)},t.prototype.formatDate=function(n){var r;if(this.parent)return this.parent.formatDate(n);var o=null!==(r=this.onFormatDate)&&void 0!==r?r:t.onFormatDate;return o?o(n):e.prototype.formatDate.call(this,n)},t.prototype.processUrl=function(n){var r;if(this.parent)return this.parent.processUrl(n);var o=null!==(r=this.onProcessUrl)&&void 0!==r?r:t.onProcessUrl;return o?o(n):e.prototype.processUrl.call(this,n)},t.prototype.dataQuery=function(n){var r;if(this.parent)return this.parent.dataQuery(n);var o=null!==(r=this.onDataQuery)&&void 0!==r?r:t.onDataQuery;return o?o(n):e.prototype.dataQuery.call(this,n)},Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="https://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new s.c(s.s.v1_0,"$schema",(function(e,n,r,o){return t.schemaUrl}),(function(e,n,r,o,i){i.serializeValue(r,n.name,t.schemaUrl)})),t.versionProperty=new v(s.s.v1_0,"version"),t.fallbackTextProperty=new s.n(s.s.v1_0,"fallbackText"),t.speakProperty=new s.n(s.s.v1_0,"speak"),t.refreshProperty=new s.l(s.s.v1_4,"refresh",(function(e){return new g}),!0),t.authenticationProperty=new s.l(s.s.v1_4,"authentication",(function(e){return new m}),!0),t}(d.a)},323:function(e,t,n){"use strict";var r=function(){function e(e){this.copilotCommunicationHandler=e}return e.getInstance=function(t){if(void 0===e.instance){if(void 0===t)throw new Error("copilotCommunicationHandler is undefined");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.sendLoggingEventToClient=function(e,t){this.copilotCommunicationHandler.sendLoggingEventToClient(e,t)},e}();t.a=r},325:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n(2),o=n(52),i=n(239),a=n(402),s=n(357),l=n(837),c=n(316),u=n(323),d=n(171),p=n(17),g=n(75),h=n(796),f=n(125),m=n(1130),v=n(832),b=n(1140),y=n(44),C=n(1129),O=n(1848),S=n(571),E=22;function x(){return"object"==typeof window&&window.crypto&&function(){var e=new Uint8Array(E);window.crypto.getRandomValues(e);for(var t=new Array(E),n=0;n<E;n++)t[n]=e[n]/256;return t}()||function(){for(var e=new Array(E),t=0;t<E;t++)e[t]=Math.random();return e}()}var I=function(){function e(e,t,n,r,o){this.isSessionConnected=!0,this.isSessionClosed=!1,this.isLicenseAnnotationActivated=!0,this.operationListForResubmit=new Map,this.callbackTokens=[],this.annotationTokens=[],this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.alSession=n,this.isSessionClosed=this.alSession.isClosed,this.isSessionConnected=this.alSession.isConnected,this.loggingEventHandler=u.a.getInstance(t),this.telemetryLoggerUtils=d.a.getInstance(),this.setIsExecuting=r,this.setALSessionClosed=o}return e.getInstance=function(t,n,r,o,i){return void 0===this.sInstance?(this.sInstance=new e(t,n,r,o,i),this.sInstance.registerCallbacks()):void 0!==r&&this.sInstance.alSession!==r&&(this.sInstance.releaseActiveAnnotations(),this.sInstance.removeCallbacks(),this.sInstance.alSession=r,this.sInstance.isSessionClosed=r.isClosed,this.sInstance.isSessionConnected=r.isConnected,this.sInstance.setALSessionClosed(this.sInstance.isSessionClosed),this.sInstance.registerCallbacks()),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.removeCallbacks=function(){var e=this;this.callbackTokens.forEach((function(t){e.alSession.removeSessionStateCallback(t)})),this.callbackTokens=[]},e.prototype.releaseActiveAnnotations=function(){var e=this;this.isSessionClosed||this.annotationTokens.forEach((function(t){e.alSession.releaseAnnotation(t).then((function(e){Object(o.c)("Annotation deactivated: "+e)})).catch((function(e){Object(o.c)("error in deactivating: ",e)}))})),this.annotationTokens=[]},e.prototype.registerCallbacks=function(){this.registerOnConnectCallback(),this.registerOnDisconnectCallback(),this.registerOnReconnectCallback(),this.registerOnCloseCallback()},e.prototype.registerOnConnectCallback=function(){var e=this,t=this.alSession.setConnectCallback((function(t,n,r,s){var l=n.substring(n.lastIndexOf("/")+1);e.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.h.EnableALCorrelationLogs)&&(Object(o.c)("Setting AL session key in CorrelationUtils from connect callback: ".concat(l)),S.a.getInstance().setAlSessionKey(l)),Object(o.c)("AL Session onSessionConnect, isSeedingRequired: ".concat(t,", sessionKey: ").concat(l)),e.isSessionConnected=!0,e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.ALSessionConnected},{key:p.g.ChatEventParameters,value:"isSeedingRequired: "+t.toString()},{key:p.g.ALSessionKey,value:l}]),e.loggingEventHandler.sendLoggingEventToClient(i.g.ALSessionConnected,{chatEventParams:t.toString()}),t?Object(o.p)()?e.resubmitTimerId=setTimeout((function(){e.isLicenseAnnotationActivated||(Object(o.c)("License annotation is not activated, so not re-submitting signal and showing error"),Object(C.b)(e.chatContainerBuilder,Object(y.z)()),a.a.getInstance().clearAugloopResponseTimer(),Object(o.w)(O.a.getTypeName(),"License annotation is not activated",p.e.Client,p.j.UserAccessIssue,p.b.Licensing,p.i.CopilotChat),e.setIsExecuting(!1),e.copilotCommunicationHandler.sendEventToClient(i.c.ResetContextId)),e.clearOperationListForResubmit()}),y.I):e.resubmitOnLicenseAnnotationActivation():(e.clearOperationListForResubmit(),e.setLicenseAnnotationActivated(!0))}));this.callbackTokens.push(t)},e.prototype.registerOnDisconnectCallback=function(){var e=this,t=this.alSession.setDisconnectCallback((function(t){Object(o.c)("AL Session Disconnected",t),e.isSessionConnected=!1,Object(o.p)()&&e.setLicenseAnnotationActivated(!1),e.loggingEventHandler.sendLoggingEventToClient(i.g.ALSessionDisconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.ALSessionDisconnected},{key:p.g.ChatEventParameters,value:(new Date).getTime().toString()}])}));this.callbackTokens.push(t)},e.prototype.registerOnReconnectCallback=function(){var e=this,t=this.alSession.setReconnectCallback((function(){e.isSessionConnected=!0,e.loggingEventHandler.sendLoggingEventToClient(i.g.ALSessionReconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.ALSessionReconnected},{key:p.g.ChatEventParameters,value:(new Date).getTime().toString()}]),Object(o.c)("AL Session Reconnected")}));this.callbackTokens.push(t)},e.prototype.registerOnCloseCallback=function(){var e=this,t=this.alSession.setSessionCloseCallback((function(t){e.isSessionClosed=!0,e.setALSessionClosed(e.isSessionClosed),e.loggingEventHandler.sendLoggingEventToClient(i.g.ALSessionClosed),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.ALSessionClosed}]),Object(o.c)("AL Session Closed",t)}));this.callbackTokens.push(t)},e.prototype.activateAnnotation=function(e,t,n,a,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u=this;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return[4,this.alSession.activateAnnotation(e,{callback:t,config:n,forceReturnCachedAnnotations:s}).then((function(t){return Object(r.__awaiter)(u,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return Object(o.c)("Annotation Token: "+t.token),this.annotationTokens.push(t.token),e===l.c.getTypeName()||e===l.b.getTypeName()||e===l.a.getTypeName()||t.token.includes(l.c.getTypeName())||t.token.includes(l.b.getTypeName())||t.token.includes(l.a.getTypeName())?(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.h.ChatHistoryDuplicateLoggingFix)&&e===l.b.getTypeName()&&Object(c.k)(!0),Object(c.i)(a,this.copilotCommunicationHandler)):(e===h.c.getTypeName()||t.token.includes(h.c.getTypeName()))&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.h.IsQnASuggestionPillCachingEnabled)?this.submitOperation(f.a.getInstance().getSuggestedQnaScenarioSignalOperation(),h.c.getTypeName()):e===v.a.getTypeName()&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.h.IsSharedCopilotLabEnabled)&&this.submitOperation(Object(m.a)(b.b.Suggestion),v.a.getTypeName()),n={workflowAnnotationType:e,responseToken:t.token},this.copilotCommunicationHandler.sendEventToClient(i.c.AnnotationActivated,n),[2]}))}))})).catch((function(e){Object(o.c)("error in activating: ",e)}))];case 1:return d.sent(),[2]}}))}))},e.prototype.submitOperation=function(e,t){var n,r,a;(!1===this.isSessionConnected||!0===this.isSessionClosed||Object(o.p)()&&!1===this.isLicenseAnnotationActivated)&&(Object(o.c)("Session is not connected, adding operation to resubmit list."),this.operationListForResubmit.set(e,t),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.AddToOperationListForResubmit},{key:p.g.ChatEventParameters,value:t}]));var s=function(){for(var e=x(),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<E;r++)n.push(t.charAt(Math.floor(e[r]*t.length)));return n.join("")}();if(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.h.EnableALCorrelationLogs)){s=S.a.getInstance().getQueryCv();var l=null===(n=this.alSession.getConnectParams())||void 0===n?void 0:n.sessionUrl;if(l){var c=l.substring(l.lastIndexOf("/")+1);S.a.getInstance().getAlSessionKey()||(Object(o.c)("Setting AL session key in CorrelationUtils from submitOperation: ".concat(c)),S.a.getInstance().setAlSessionKey(c))}}var u=e.items.length>0?null===(a=null===(r=e.items[0])||void 0===r?void 0:r.body)||void 0===a?void 0:a.H_.T_:"";Object(o.c)("Submitting operation to AL: ".concat(e,", signalName: ").concat(u,", cv: ").concat(s)),this.alSession.submitOperation(e,s);var d={workflowAnnotationType:t,cv:s,operation:JSON.stringify(e)};this.copilotCommunicationHandler.sendEventToClient(i.c.QuerySubmitted,d),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.QuerySubmittedToAL},{key:p.g.ChatEventParameters,value:u},{key:p.g.Cv,value:s},{key:p.g.ALSessionKey,value:S.a.getInstance().getAlSessionKey()}]),this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:p.k.RequestSignalType,value:u},{key:p.k.Cv,value:s},{key:p.g.ALSessionKey,value:S.a.getInstance().getAlSessionKey()}])},e.prototype.clearOperationListForResubmit=function(){this.operationListForResubmit.clear(),Object(o.c)("Operation list for resubmit is cleared"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.ResetOperationListForResubmit},{key:p.g.ChatEventParameters,value:(new Date).getTime().toString()}])},e.prototype.setLicenseAnnotationActivated=function(e){this.isLicenseAnnotationActivated=e,Object(o.c)("License Annotation Activated: "+e)},e.prototype.resubmitOnLicenseAnnotationActivation=function(){var e=this;Object(o.c)("operationListForResubmit: ",this.operationListForResubmit),this.operationListForResubmit.forEach((function(t,n){var r,i;e.submitOperation(n,t),Object(o.c)("Resubmitting signal for operation: ",n);var l=n.items.length>0?null===(i=null===(r=n.items[0])||void 0===r?void 0:r.body)||void 0===i?void 0:i.H_.T_:"";e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:p.g.ChatEventType,value:p.f.QueryResubmittedToAL},{key:p.g.ChatEventParameters,value:l}]),s.a.getInstance().isAugloopResponseTimeoutRequired(t)&&a.a.getInstance().setAugloopResponseTimer(t)})),clearTimeout(this.resubmitTimerId),Object(o.c)("Resubmitting signals for operations in operation list for resubmit is completed. Cleared resubmit timer."),this.clearOperationListForResubmit()},e}()},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(52),o=function(){function e(){this.messageRequestIdMap={}}return e.prototype.updateMessageIdMap=function(){this.currentUserMessageId&&this.requestId&&!this.messageRequestIdMap[this.requestId]&&(this.messageRequestIdMap[this.requestId]=this.currentUserMessageId)},Object.defineProperty(e.prototype,"ConversationId",{get:function(){return this.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RequestId",{get:function(){return this.requestId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SydneyEndpoint",{get:function(){return this.sydneyEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ChatTimestamp",{get:function(){return this.chatTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return this.locale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ErrorMessage",{get:function(){return this.errorMessage},set:function(e){this.errorMessage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentUserMessageId",{get:function(){return this.currentUserMessageId},set:function(e){this.currentUserMessageId=e},enumerable:!1,configurable:!0}),e.prototype.GetMessageIdForRequestId=function(e){return this.messageRequestIdMap[e]},Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.resetInstance=function(){var e;null===(e=this._instance)||void 0===e||e.NewChatInitiated(),this._instance=void 0},e.prototype.Observe=function(e){var t,n,o,i,a,s;if(e)try{if(e.conversationId&&e.conversationId!==this.conversationId&&(this.conversationId=e.conversationId,Object(r.c)("ChatStateObserver ConversationId: "+e.conversationId)),e.sydneyEndpoint&&!this.sydneyEndpoint&&(this.sydneyEndpoint=null!==(t=e.sydneyEndpoint)&&void 0!==t?t:this.sydneyEndpoint),this.requestId=null!==(n=e.queryId)&&void 0!==n?n:this.requestId,this.requestId&&this.updateMessageIdMap(),this.chatTimestamp=null!==(o=e.timestamp)&&void 0!==o?o:(new Date).toISOString(),!this.locale&&(null===(i=e.chatResponse)||void 0===i?void 0:i.messages)){var l=null===(s=null===(a=e.chatResponse)||void 0===a?void 0:a.messages)||void 0===s?void 0:s.find((function(e){return e.locale}));(null==l?void 0:l.locale)&&(this.locale=null==l?void 0:l.locale)}}catch(e){Object(r.c)("Exception ocurred in ChatStateObserver "+e)}},e.prototype.NewChatInitiated=function(){this.currentUserMessageId=void 0,this.requestId=void 0,this.chatTimestamp=void 0,this.errorMessage=void 0},e}()},330:function(e,t,n){"use strict";var r,o,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(r||(r={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(o||(o={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(i||(i={}))},3404:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r={GlobalApp:"GlobalApp",UserApp:"UserApp",TenantApp:"TenantApp",Empty:""};function o(e,t){const n=function(e){return(null==e?void 0:e.startsWith("P_"))?r.GlobalApp:(null==e?void 0:e.startsWith("U_"))?r.UserApp:(null==e?void 0:e.startsWith("T_"))?r.TenantApp:r.Empty}(e);switch(n){case r.GlobalApp:return t;case r.UserApp:return r.UserApp;case r.TenantApp:return r.TenantApp;default:return r.Empty}}},3446:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r="https://",o=r+"outlook-1-cdn.azureedge.",i="midgard/",a="/agsc-"+i,s="versionless/",l=r+"res.cdn.office.net/"+i;function c(e){return e?e.publicPath?e.publicPath:function(e){switch(e.environment){case"Gallatin":return r+"res-1.cdn.partner.office365.cn/"+i;case"AG08":return o+"eaglex.ic.gov"+a;case"AG09":return o+"microsoft.scloud"+a;case"GccHigh":return r+"res-gcch.cdn.office.net/"+i;case"DoD":return r+"res-dod.cdn.office.net/"+i;default:return l}}(e)+s:l+s}},3447:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));const r="en-US",o=["ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-OM","ar-QA","ar-SA","ar-SY","ar-AE","bg-BG","ca-ES","zh-HK","zh-CN","zh-TW","hr-HR","cs-CZ","da-DK","nl-NL","en-AU","en-CA","en-HK","en-IN","en-IE","en-NZ","en-PH","en-SG","en-ZA","en-GB","en-US","et-EE","fi-FI","fr-CA","fr-FR","de-DE","el-GR","gu-IN","hi-IN","hu-HU","ga-IE","it-IT","ja-JP","ko-KR","lv-LV","lt-LT","mt-MT","mr-IN","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-US","es-VE","sv-SE","ta-IN","te-IN","th-TH","tr-TR","af-ZA","am-ET","bn-IN","cy-GB","eu-ES","fa-IR","fil-PH","gl-ES","he-IL","hy-AM","id-ID","is-IS","ka-GE","kk-KZ","km-KH","kn-IN","lo-LA","mk-MK","ml-IN","ms-MY","ne-NP","pa-IN","sq-AL","uk-UA","vi-VN"];function i(e){let t="en-US";return t=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}}(function(e){const t=e.split("-");if(1==t.length)return t[0].toLowerCase();t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase());if(t.length>2)for(let e=1;e<t.length-1;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1).toLowerCase();return t.join("-")}(e)),-1==o.indexOf(t)&&(t=function(e){const t=e.split("-");for(let e=0;e<o.length;e++){const n=o[e];if(t[0]==n.split("-")[0])return n}return e}(t)),-1==o.indexOf(t)&&(t=r),console.log("STT Language is "+t),t}const a=e=>{switch(e.toLowerCase()){case"zh-hk":case"zh-cn":case"zh-tw":case"ja-jp":return!1;default:return!0}}},3454:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.Designer=8]="Designer",e[e.WarningMessage=9]="WarningMessage"}(r||(r={}))},3455:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u;n.d(t,"a",(function(){return o})),function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS"}(r||(r={})),function(e){e.Chat="chat",e.Human="human"}(o||(o={})),function(e){e.BASIC_CHAT="BasicChat"}(i||(i={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(a||(a={})),function(e){e.IsPersistentChatHistoryEnabled="IsPersistentChatHistoryEnabled",e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled"}(s||(s={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(l||(l={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(c||(c={})),function(e){e.Shy="Shy",e.Expanded="Expanded"}(u||(u={}))},3456:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(r||(r={}))},3464:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(98),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.isTelemetryEnabled=function(e){return e instanceof t||void 0!==e.executeWithTelemetry},t}(o.Action)},3465:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1543),o=function(e){var t,n,r,o,i,a,s,l,c;return{chatUiStack:null!==(t=e.chatUiStack)&&void 0!==t?t:{},chatFreStack:null!==(n=e.chatFreStack)&&void 0!==n?n:{},chatUiStackZoom:null!==(r=e.chatUiStackZoom)&&void 0!==r?r:{},chatFreStackZoom:null!==(o=e.chatFreStackZoom)&&void 0!==o?o:{},spinner:null!==(i=e.spinner)&&void 0!==i?i:{},incomingShimmerCard:null!==(a=e.incomingShimmerCard)&&void 0!==a?a:{},outgoingShimmerCard:null!==(s=e.outgoingShimmerCard)&&void 0!==s?s:{},incomingShimmerCardWrapper:null!==(l=e.incomingShimmerCardWrapper)&&void 0!==l?l:{},outgoingShimmerCardWrapper:null!==(c=e.outgoingShimmerCardWrapper)&&void 0!==c?c:{}}};function i(e){var t=o(e);return Object(r.a)(t)}},3466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(899);function i(e){var t=e.lookupString,n=e.children,i=Object(o.b)(),a=r.useMemo((function(){return{lookupString:(e=t,n=i.lookupString,function(t){return function(r){var o=e(t)(r);if(o!==t)return o;var i=n(t)(r);return i!==t?i:t}})};var e,n}),[t,i]);return r.createElement(o.a,{value:a},n)}},3487:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(246);class o{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.e.LogMetric,tag:this.tag,name:this.name,success:r.j.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},3503:function(e,t,n){"use strict";function r(e,t,n){return r=>{var o,i,a;if(!r)return void t.close();const s={botId:null!==(i=null===(o=n.webApplicationInfo)||void 0===o?void 0:o.id)&&void 0!==i?i:"",appId:null!==(a=n.id)&&void 0!==a?a:"",requestBody:{name:"task/submit",value:{data:r}}};e.botInvoke(s).then((e=>function(e,t){e&&0===Object.keys(e).length&&t.close()}(e,t))).catch((e=>{})),t.close()}}n.d(t,"a",(function(){return r}))},3506:function(e,t,n){"use strict";n.d(t,"f",(function(){return pS})),n.d(t,"c",(function(){return hS})),n.d(t,"h",(function(){return mS})),n.d(t,"g",(function(){return vS})),n.d(t,"i",(function(){return bS})),n.d(t,"d",(function(){return CS})),n.d(t,"b",(function(){return OS})),n.d(t,"a",(function(){return SS})),n.d(t,"e",(function(){return ES}));var r,o=n(2);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(r||(r={}));var i=r.web,a=function(){return i};function s(){return i===r.IOS}var l;!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(l||(l={}));var c,u=l.defaultWhite,d=!1,p=!1,g=function(e){u=e},h=function(){return u},f=function(){return d},m=function(e){d=e},v=function(){return p};!function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.Designer=8]="Designer",e[e.CopilotWorkflowMessage=9]="CopilotWorkflowMessage",e[e.WarningMessage=10]="WarningMessage",e[e.PaginatedCard=11]="PaginatedCard",e[e.ProactiveSuggestionCard=12]="ProactiveSuggestionCard",e[e.ReviewerSummaryCard=13]="ReviewerSummaryCard",e[e.ReviewAgentCard=14]="ReviewAgentCard"}(c||(c={}));var b,y=n(2168),C=n(62),O=n(1741),S=n(2823),E=n(65),x=n(138);!function(e){e[e.Regular=0]="Regular",e[e.Ghost=1]="Ghost",e[e.File=2]="File",e[e.Skill=3]="Skill"}(b||(b={}));var I=function(){return H()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},w="",T=n(1627),k=n(2445),j=Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),P=Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),A=Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),_=Object(S.a)(j),D="group",L="list",M="listitem",B="menu",R="menuitem",F="button",N="alert",H=function(){return"undefined"!=typeof OfficeaicopilotStrings},U=function(e){var t;return null===(t=Object.values(O.b).filter((function(t){return t===e})))||void 0===t?void 0:t[0]},V=function(e){var t,n=document.getElementById(e),r=n.cloneNode(!0);z(n,r);var o=r.outerHTML.replace(ee,"");return null===(t=r.parentNode)||void 0===t||t.removeChild(r),o};function z(e,t){var n=document.createElement("div");document.body.appendChild(n);for(var r=getComputedStyle(e),o=getComputedStyle(n),i=[],a=0;a<r.length;a++){var s=r[a],c=r.getPropertyValue(s),u=o.getPropertyValue(s),d=h();d!==l.defaultBlack&&d!==l.defaultDarkGrey||"color"===s&&(c=_.black),c!==u&&i.push("".concat(s,": ").concat(c))}t.setAttribute("style",i.join(";"));for(var p=e.children,g=t.children,f=0;f<p.length;f++){z(p[f],g[f])}n.remove()}var G=function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n]);return e},W=function(e,t){var n=[],r=e.body;return function(e){var t,n,r=e.split(/(\[.*?\]\(.*?\))/g),i=[];try{for(var a=Object(o.__values)(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(!l.startsWith("[")||!l.endsWith(")")){var c=l.trim();c.startsWith(".")&&(c=c.substring(1).trim(),i.length>0&&(i[i.length-1]=i[i.length-1]+". ")),i.push(c)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}(r[0].text).forEach((function(i,a){i.length>0?n.push({adaptiveCard:Object(o.__assign)(Object(o.__assign)({},e),{body:[Object(o.__assign)(Object(o.__assign)({},r[0]),{text:i})]}),references:t[a]?[t[a]]:[]}):t[a]&&n.length>0&&n[n.length-1].references.push(t[a])})),n},Q=function(e,t){if(0===t.length)return!1;var n=e.search("%c");if(-1===n)return!1;var r=e.slice(n+2).search("%c");if(-1===r)return!1;r=r+n+2;var o=parseInt(e.slice(n+2,r));return t.some((function(e){return e.referenceIndex===o}))},q=function(){return{aadUserId:"",clientType:x.b.web,hubName:x.c.orange,locale:"en-US",physicalRing:"",sessionId:"",theme:x.d.default,userName:"",userPrincipalName:""}},K=function(){return H()?OfficeaicopilotStrings.ChatCardFooterDisclaimer:"AI-generated content may be incorrect"},Y=function(){return H()?OfficeaicopilotStrings.ChatCardFooterDisclaimerPowered:"AI-powered suggestions may be inaccurate"},Z=function(){return H()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeader:"Provide feedback"},J=function(){return H()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeaderTitle:"MICROSOFT INTERNAL ONLY"},X=function(){return H()?OfficeaicopilotStrings.ShowMeButtonText:"Show Me"},$="Help",ee=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm,te=function(){return"Confirm Invitation"},ne=function(e){function t(t,n,r,o,i,a,s,l,c,u,d){var p=e.call(this,r,o,i,a,s,l,c,u,d)||this;return p.taskModuleLauncher=t,p.clientInfo=n,p}return Object(o.__extends)(t,e),t.prototype.launchModalDialogContainer=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t?[4,this.getAppDefinition(e.appId)]:[2,Promise.reject("Dialog content not found")];case 1:return(n=o.sent())?(r={dialogContent:t,appDefinition:n,cardData:JSON.stringify(e.cardData)},this.taskModuleLauncher?[4,this.taskModuleLauncher(r)]:[3,3]):[2,Promise.reject("App definition not found")];case 2:return o.sent(),[2,Promise.resolve({status:"Success"})];case 3:return[2,Promise.resolve({status:"Failure"})]}}))}))},t.prototype.openTaskModule=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return t=this.getDialogFromTaskInfo(e.taskInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t.prototype.openStageView=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return t=this.getDialogFromStageInfo(e.stageInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t}(n(2218).MsgExtPreviewHostService),re=function(){function e(){}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{type:e.type.toString(),tag:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",name:null!==(o=null===(r=e.name)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",source:null!==(a=null===(i=e.source)||void 0===i?void 0:i.toString())&&void 0!==a?a:"",duration:null!==(l=null===(s=e.duration)||void 0===s?void 0:s.toString())&&void 0!==l?l:"",success:null!==(u=null===(c=e.success)||void 0===c?void 0:c.toString())&&void 0!==u?u:"",correlationVector:null!==(p=null===(d=e.correlationVector)||void 0===d?void 0:d.toString())&&void 0!==p?p:""}},e.prototype.LogInfo=function(e){},e.prototype.LogError=function(e){},e.prototype.LogException=function(e){},e.prototype.LogWarning=function(e){},e.prototype.LogVerbose=function(e){},e.prototype.LogMetric=function(e){},e}(),oe=n(2080),ie=function(){function e(e){this.cardProps=e}return e.prototype.getDisplayExternalUrlWarning=function(){return function(e){return new Promise((function(t,n){e?setTimeout((function(){return t()}),2e3):n("CardId is missing")}))}},e.prototype.isValidMessageForMsgExtCard=function(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((function(e){return!!e.cardJson}))},e.prototype.getCardReferences=function(e){var t,n,r=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];var o=new oe.a({},null,null===(t=this.cardProps.clientInfo)||void 0===t?void 0:t.locale,"",null===(n=this.cardProps.clientInfo)||void 0===n?void 0:n.theme);return e.map((function(e,t){return{index:t+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:r,content:e.cardJson,config:o}}))},e.prototype.getCardServiceProps=function(){return this.cardProps},e.prototype.getMsgExtCardService=function(){var e=this.cardProps.tokenService,t=this.cardProps.appService,n=this.cardProps.channelService,r=this.cardProps.clientInfo,o=this.cardProps.taskModuleLauncher,i={host:{clientType:r.clientType,name:r.hubName,sessionId:r.sessionId,version:"1.0"},locale:r.locale,sessionId:r.sessionId,theme:r.theme},a={dataResidency:C.d.Public,id:r.aadUserId,displayName:r.userName,userPrincipalName:r.userPrincipalName},s=new re,l=document.createElement("div"),c=new ne(o,r,(function(){return l}),a,i,t,e,(function(){throw new Error("Not implemented")}),n,void 0,this.getDisplayExternalUrlWarning());return{hostService:c,tokenService:e,appService:t,cardService:new y.a(c,n,t),telemetryService:s,channelService:n}},e}(),ae=n(3345),se=n(1),le=n.n(se);function ce(e){var t=e.theme,n=e.dir,r=e.children,i=le.a.useMemo((function(){switch(h()){case l.defaultBlack:return Object(o.__assign)(Object(o.__assign)({},P),t);case l.defaultWhite:default:return Object(o.__assign)(Object(o.__assign)({},j),t)}}),[t]);return le.a.createElement(ae.a,{theme:i,dir:n},r)}var ue=n(1543),de=Object(ue.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),pe=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(E.a)(o,t)),n?o=r?Object(E.a)(o,e.horizontalReverse):Object(E.a)(o,e.horizontal):r&&(o=Object(E.a)(o,e.verticalReverse)),o}(de(),n,i,s);return se.createElement("div",Object(o.__assign)({className:c},l),t)},ge=n(3360),he=n(3361),fe=n(3362),me=n(1814),ve=n(1026),be=n(3364),ye=n(3365),Ce=n(3366),Oe=n(3358),Se=n(3359),Ee=n(3334),xe=n(1858),Ie=function(){return H()?OfficeaicopilotStrings.LikeButtonLabel:"Like"},we=function(){return H()?OfficeaicopilotStrings.DislikeButtonLabel:"Dislike"},Te=function(){return H()?OfficeaicopilotStrings.SuggestionPaneLabel:"Suggested Prompts"};function ke(){return H()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"}var je=Object(ue.a)({item:{height:"auto",width:"auto",flexShrink:1}}),Pe=function(e){var t=e.children,n=e.style,r=Object(E.a)(je().item,n);return le.a.createElement("div",{className:r},t)},Ae=n(3363),_e=function(e){var t=e.iconUrl,n=e.iconAltText||"MenuItemIcon";return le.a.createElement(Ae.a,{src:t,alt:n,fit:"contain"})},De=n(335),Le=n(139),Me={root:Object(o.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},De.a.margin("0px","16px","0px","16px")),menuWrapper:Object(o.__assign)({},De.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Le.a.colorNeutralForeground1,"&:hover":{color:Le.a.colorBrandBackground2Hover},"&:hover :active":{color:Le.a.colorBrandStroke2Hover}},iconButton:Object(o.__assign)(Object(o.__assign)({},De.a.border("none")),{color:Le.a.colorNeutralForeground1,backgroundColor:"transparent"}),label:Object(o.__assign)({},De.a.padding("4px","5px","4px","5px")),labelIcon:Object(o.__assign)(Object(o.__assign)({},De.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(o.__assign)(Object(o.__assign)({},De.a.margin("5px","0px","5px","0px")),{height:"100%"})},Be=Object(ue.a)(Me),Re=Object(S.a)(j),Fe={root:Object(o.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},De.a.margin("0px","16px","0px","16px")),menuWrapper:Object(o.__assign)({},De.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Re.neutralPrimary,"&:hover":{color:Re.themeMedium},"&:hover :active":{color:Re.themeDark}},iconButton:Object(o.__assign)(Object(o.__assign)({},De.a.border("none")),{color:Re.neutralPrimary,backgroundColor:"transparent"}),label:Object(o.__assign)({},De.a.padding("4px","5px","4px","5px")),labelIcon:Object(o.__assign)(Object(o.__assign)({},De.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(o.__assign)(Object(o.__assign)({},De.a.margin("5px","0px","5px","0px")),{height:"100%"})},Ne=Object(ue.a)(Fe),He=function(){var e=Ne(),t=Be();return v()?t:e},Ue=function(e){var t=e.isMenuOpen,n=e.onMenuStateChange,r=e.handleCopilotChatChange,o=e.copilotList,i=e.showNewChatButtonOnTop,a=e.isExecuting,s=e.handleChangeTopicButtonClick,l=He(),c=o.find((function(e){return e.isSelected})),u=o.find((function(e){return e.isDefaultCopilot})),d=null==c?void 0:c.id,p=null==u?void 0:u.id,g=null==c?void 0:c.name,h=null==c?void 0:c.menuIcon,f=null==c?void 0:c.menuIconUrl,m=null==c?void 0:c.iconAltText,v=Object(Oe.a)(Se.d,Se.e);return se.createElement(pe,{horizontal:!0,style:l.root},se.createElement(ge.a,{open:t,onOpenChange:n},se.createElement(pe,{horizontal:!0,style:l.menuWrapper},se.createElement(he.a,{withArrow:!0,positioning:"below",content:H()?OfficeaicopilotStrings.CopilotSwitcherMenuTriggerTitle:"Switch copilots",relationship:"label"},se.createElement(fe.a,{disableButtonEnhancement:!0},se.createElement(me.a,{className:l.iconButton,icon:se.createElement(Ee.a,null)}))),d!==p&&se.createElement(pe,{horizontal:!0},se.createElement(Pe,{style:l.labelIcon},f?se.createElement(_e,{iconUrl:f,iconAltText:m}):h),se.createElement(ve.a,{weight:"semibold",className:l.label},g))),se.createElement(be.a,{className:l.menu},se.createElement(ye.a,null,o.map((function(e){return se.createElement(Ce.a,{key:e.id,icon:e.menuIconUrl?se.createElement(_e,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon,onClick:function(){r(e.id)}},se.createElement(pe,{horizontal:!0,style:l.menuItem},se.createElement(Pe,null,e.name),se.createElement(Pe,null,e.isSelected&&se.createElement(xe.s,null))))}))))),p===d&&se.createElement(pe,{horizontal:!0},i&&se.createElement(he.a,{withArrow:!0,positioning:"below",content:ke(),relationship:"label"},se.createElement(me.a,{appearance:"transparent",disabled:a,className:l.menuAdjacentActionButtons,icon:se.createElement(v,null),onClick:s}))))},Ve=function(e){var t=e.componentToRender,n=He();return le.a.createElement(pe,{style:n.componentWrapper},t)},ze=n(3370),Ge={root:Object(o.__assign)({},De.a.margin("0px","16px","0px","16px"))},We=Object(ue.a)(Ge),Qe=function(e){var t=e.label,n=e.checked,r=e.disabled,o=e.onChange,i=We();return le.a.createElement(ze.a,{className:i.root,onChange:o,checked:n,label:t,disabled:r,labelPosition:"after"})},qe={buttonStack:Object(o.__assign)({},De.a.margin("0px","0px","0px","15px")),buttonStackItem:Object(o.__assign)({},De.a.margin("0px","5px","0px","0px"))};var Ke,Ye,Ze,Je=(Ze={buttonStack:null!==(Ke=qe.buttonStack)&&void 0!==Ke?Ke:{},buttonStackItem:null!==(Ye=qe.buttonStackItem)&&void 0!==Ye?Ye:{}},Object(ue.a)(Ze)),Xe=n(3599),$e=n(3371),et=n(3372),tt=n(3373),nt=n(2265),rt=n(3374),ot=n(3375),it=n(3376),at=n(3377),st=n(3378),lt=n(3379),ct=n(576),ut=function(e){var t=Object(S.a)(e);return Object(ue.a)({itemCell:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("5px")),De.a.borderBottom("1px","solid",t.themePrimary)),{minHeight:"30px",boxSizing:"border-box",display:"flex",selectors:{"&:hover":{backgroundColor:t.neutralLight}}}),itemContent:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.overflow("hidden")),De.a.margin("0px","0px","0px","5px")),{flexGrow:1}),itemName:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"},accordionBody:Object(o.__assign)({},De.a.margin("0px","10px")),metricAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("auto")),{overflowWrap:"anywhere",fontSize:"16px",fontWeight:"500"})})};var dt,pt=function(e){var t=Object(o.__read)(le.a.useState([]),2),n=t[0],r=t[1],i=Object(o.__read)(le.a.useState([]),2),a=i[0],s=i[1],l=Object(o.__read)(le.a.useState(""),2),c=l[0],u=l[1],d=ut(j);return Object(se.useEffect)((function(){!function(t){var n;if(u(t),""!==c){var r=null===(n=e.telemetry.metrics)||void 0===n?void 0:n.filter((function(e){return e.serviceName.toLowerCase().includes(c.toLowerCase())}));s(r)}else s(e.telemetry.metrics)}(e.searchValue)}),[e.searchValue]),le.a.createElement(ot.a,{openItems:n,onToggle:function(e,t){r(t.openItems)},multiple:!0,collapsible:!0,className:d().accordionBody},a.map((function(e,t){return le.a.createElement(it.a,{key:t,value:(t+1).toString()},le.a.createElement(at.a,null,le.a.createElement(st.a,{className:d().metricAccordionHeaderText},"".concat(e.serviceName))),le.a.createElement(lt.a,null,Object.keys(e).filter((function(e){return"serviceName"!==e})).map((function(t,n){return le.a.createElement("div",{key:n,className:d().itemCell,"data-is-focusable":!0},le.a.createElement("div",{className:d().itemContent},le.a.createElement(st.a,{block:!0,className:d().itemName},t.toString()),le.a.createElement(st.a,{block:!0,className:d().itemValue},String(e[t]))))}))))})))};!function(e){e.COPIED="Copied",e.COPY_ERROR="Copy Error",e.COPY_DEBUG_LOGS="Copy Debug Logs"}(dt||(dt={}));var gt=function(){return"Sydney Telemetry Debug Panel"},ht=function(){return"Query ID :"},ft=function(){return"Show Telemetry Panel"},mt=function(){return"Replay Conversation"},vt=function(){return"Debug Tools"},bt=function(){return"https://sdf.cortana.ai/turingbot/ui?debug=true&enableDebugButton=&allowedMessageTypes=Any&variants=UseIc3ForConversationStorage&sourceConversationId="},yt=function(){return"_blank"},Ct=function(){return"Search Telemetry"},Ot=function(){return Object(ue.a)({dialogTitle:Object(o.__assign)({},De.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},searchBox:{width:"90%",marginLeft:"5%"},searchBoxContainer:{paddingBottom:"10px"}})};var St=function(e){var t=Object(o.__read)(le.a.useState([]),2),n=t[0],r=t[1],i=Object(o.__read)(le.a.useState(""),2),a=i[0],s=i[1],l=Ot();return le.a.createElement(Xe.a,{open:e.isModalOpen,onOpenChange:function(t,n){e.setIsModalOpen(n.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":"close",icon:le.a.createElement(ct.n,null)})),className:l().dialogTitle},gt()),le.a.createElement(rt.a,null,le.a.createElement("div",{className:l().searchBoxContainer},le.a.createElement("input",{placeholder:Ct(),onChange:function(e){return s(e.target.value)},className:l().searchBox})),le.a.createElement(ot.a,{openItems:n,onToggle:function(e,t){r(t.openItems)},multiple:!0,collapsible:!0},e.telemetryData.map((function(e,t){return le.a.createElement(it.a,{key:t,value:(t+1).toString()},le.a.createElement(at.a,null,le.a.createElement(pe,null,le.a.createElement(st.a,{block:!0,className:l().queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat(ht())),le.a.createElement(st.a,{className:l().queryAccordionText},e.queryId))),le.a.createElement(lt.a,null,le.a.createElement(pt,{telemetry:e.telemetry,searchValue:a})))})))))))};var Et,xt=function(e){var t=this,n=Object(o.__read)(Object(se.useState)(!1),2),r=n[0],i=n[1],a=Object(o.__read)(Object(se.useState)(!1),2),s=a[0],l=a[1],c=Object(o.__read)(Object(se.useState)(!1),2),u=c[0],d=c[1],p=Object(o.__read)(Object(se.useState)(!1),2),g=p[0],h=p[1],f=Je(),m=s?dt.COPIED:u?dt.COPY_ERROR:dt.COPY_DEBUG_LOGS,v={checked:r,disabled:!1,onChange:function(e,t){var n=null==t?void 0:t.checked;i(null!=n&&n),n||(l(!1),d(!1))},label:vt()};return le.a.createElement(pe,null,le.a.createElement(Qe,Object(o.__assign)({},v)),le.a.createElement(pe,{horizontal:!0,style:f.buttonStack},le.a.createElement(Pe,{style:f.buttonStackItem},r&&le.a.createElement(me.a,{appearance:"outline",onClick:function(){return Object(o.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),(t=e.getLogs())?[4,navigator.clipboard.writeText(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return l(!0),[3,4];case 3:return n=r.sent(),console.log("An error occurred while copying text to clipboard:",n.message),d(!0),[3,4];case 4:return[2]}}))}))},size:"small",title:m},m)),le.a.createElement(Pe,{style:f.buttonStackItem},r&&""!=e.conversationId&&le.a.createElement(me.a,{appearance:"outline",onClick:function(){e.conversationId&&window.open(bt()+e.conversationId,yt())},size:"small",title:mt()},mt())),le.a.createElement(Pe,{style:f.buttonStackItem},r&&e.telemetryData&&le.a.createElement(me.a,{appearance:"outline",onClick:function(){h(!g)},size:"small",title:ft(),disabled:0===e.telemetryData.length},ft()))),r&&e.telemetryData&&g&&le.a.createElement(St,{telemetryData:e.telemetryData,isModalOpen:g,setIsModalOpen:h}))},It=n(3597),wt=n(3367),Tt=n(3380),kt=n(1817),jt=n(3369),Pt=n(3347),At=n(3381),_t={dialogTitle:Object(o.__assign)({},De.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},itemName:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"}},Dt=function(){var e,t,n,r,o,i={dialogTitle:null!==(e=_t.dialogTitle)&&void 0!==e?e:{},queryAccordionHeaderText:null!==(t=_t.queryAccordionHeaderText)&&void 0!==t?t:{},queryAccordionText:null!==(n=_t.queryAccordionText)&&void 0!==n?n:{},itemName:null!==(r=_t.itemName)&&void 0!==r?r:{},itemValue:null!==(o=_t.itemValue)&&void 0!==o?o:{}};return Object(ue.a)(i)}(),Lt="Client Conversation Logs",Mt="Client Console Logs",Bt="Performance",Rt="Session Info",Ft="Augloop Workflow Logs",Nt="Chat Event Logs",Ht="Session Id",Ut="Option Sets",Vt="AL Inspector Link",zt="App Name",Gt="App Platform",Wt="SDX Version",Qt="https://web.augloop-tools.officeppe.com/inspector/",qt="_blank",Kt="Close",Yt=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.conversationLogObject,i=Dt(),a=Object(o.__read)(le.a.useState([]),2),s=a[0],l=a[1],c=function(e,t){return le.a.createElement(it.a,{key:t,value:(t+1).toString()},le.a.createElement(at.a,null,le.a.createElement(pe,null,le.a.createElement(st.a,{block:!0,className:i.queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat("Query")))),le.a.createElement(lt.a,null,(n=e,r=[],Object.keys(n).forEach((function(e){r.push(le.a.createElement("div",{className:i.itemName},e,":")),r.push(le.a.createElement("div",{className:i.itemValue},JSON.stringify(n[e])))})),r)));var n,r};return le.a.createElement(Xe.a,{open:t,onOpenChange:function(e,t){n(t.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":Kt,icon:le.a.createElement(ct.n,null)}))},Lt),le.a.createElement(rt.a,null,le.a.createElement(ot.a,{openItems:s,onToggle:function(e,t){l(t.openItems)},multiple:!0,collapsible:!0},null==r?void 0:r.map((function(e,t){return c(e,t)})))))))},Zt=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.getLogs;return le.a.createElement(Xe.a,{open:t,onOpenChange:function(e,t){n(t.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":Kt,icon:le.a.createElement(ct.n,null)}))},Mt),le.a.createElement(rt.a,null,r?r():""))))},Jt=function(e){var t,n,r=e.isModalOpen,o=e.setIsModalOpen,i=e.debugMessageInfoObject,a=Dt();return le.a.createElement(Xe.a,{open:r,onOpenChange:function(e,t){o(t.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":Kt,icon:le.a.createElement(ct.n,null)}))},"Debug Info"),le.a.createElement(rt.a,null,i?(t=i,n=[],Object.keys(t).forEach((function(e){n.push(le.a.createElement("div",{className:a.itemName},e,":")),n.push(le.a.createElement("div",{className:a.itemValue},JSON.stringify(t[e])))})),n):""))))},Xt=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.chatPaneLoadTime,o=e.chatInputLoadTime,i=Dt();return le.a.createElement(Xe.a,{open:t,onOpenChange:function(e,t){n(t.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":Kt,icon:le.a.createElement(ct.n,null)}))},Bt),le.a.createElement(rt.a,null,le.a.createElement("div",{className:i.itemName},"".concat("Chat Pane Load Time",": ")),le.a.createElement("div",{className:i.itemValue},"".concat(r,"s")),le.a.createElement("div",{className:i.itemName},"".concat("Ready to Interact",": ")),le.a.createElement("div",{className:i.itemValue},"".concat(o,"s"))))))},$t=n(3382),en=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.sessionId,o=e.conversationLogObject,i=e.appName,a=e.appPlatform,s=e.augloopKustoQueryURL,l=e.clientKustoQueryURL,c=e.sdxVersion,u=Dt();return le.a.createElement(Xe.a,{open:t,onOpenChange:function(e,t){n(t.open)}},le.a.createElement($e.a,null,le.a.createElement(et.a,null,le.a.createElement(tt.a,{action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":Kt,icon:le.a.createElement(ct.n,null)}))},Rt),le.a.createElement(rt.a,null,le.a.createElement("div",{className:u.itemName},"".concat(Ht,": ")),le.a.createElement("div",{className:u.itemValue},r||""),le.a.createElement("div",{className:u.itemName},"".concat(zt,": ")),le.a.createElement("div",{className:u.itemValue},i||""),le.a.createElement("div",{className:u.itemName},"".concat(Gt,": ")),le.a.createElement("div",{className:u.itemValue},a||""),le.a.createElement("div",{className:u.itemName},"".concat(Wt,": ")),le.a.createElement("div",{className:u.itemValue},c||""),le.a.createElement("div",{className:u.itemName},"".concat(Ut,": ")),le.a.createElement("div",{className:u.itemValue},o&&o.length>0&&o[0].optionSets?o[0].optionSets:[]),le.a.createElement("div",{className:u.itemName},"".concat(Vt,": ")),le.a.createElement("div",{className:u.itemValue},le.a.createElement($t.a,{onClick:function(){var e="".concat(Qt).concat(r);window.open(e,qt)}},"".concat(Qt).concat(r))),le.a.createElement("div",{className:u.itemName},"".concat(Ft,": ")),le.a.createElement("div",{className:u.itemValue},le.a.createElement($t.a,{onClick:function(){window.open(s,qt)}},s)),le.a.createElement("div",{className:u.itemName},"".concat(Nt,": ")),le.a.createElement("div",{className:u.itemValue},le.a.createElement($t.a,{onClick:function(){window.open(l,qt)}},l))))))},tn=function(e){var t,n=Object(o.__read)(Object(se.useState)(!1),2),r=n[0],i=n[1],a=Object(o.__read)(Object(se.useState)(!1),2),s=a[0],l=a[1],c=Object(o.__read)(Object(se.useState)(!1),2),u=c[0],d=c[1],p=Object(o.__read)(Object(se.useState)(!1),2),g=p[0],h=p[1],f=Object(o.__read)(Object(se.useState)(!1),2),m=f[0],v=f[1],b=Object(o.__read)(Object(se.useState)(!1),2),y=b[0],C=b[1],O=Object(o.__read)(Object(se.useState)(!1),2),S=O[0],E=O[1],x=Object(ue.a)({container:Object(o.__assign)({justifyContent:"space-between",marginRight:"10px"},De.a.padding("2px"))})();return Object(se.useEffect)((function(){E(e.showDebugInfoMessage)}),[e.showDebugInfoMessage]),le.a.createElement("div",null,le.a.createElement(It.a,{className:x.container},le.a.createElement(wt.a,null,le.a.createElement(Qe,{label:"Debug Menu",onChange:function(e,t){var n=null==t?void 0:t.checked;i(n)},checked:r,disabled:!1})),r&&le.a.createElement(wt.a,null,le.a.createElement(Tt.a,{icon:le.a.createElement(Se.b,null),onClick:function(){var t=e.conversationLogObject&&e.conversationLogObject[0].optionSets?e.conversationLogObject[0].optionSets:[],n="<ul> <li><strong>".concat(Ht,":</strong> ").concat(e.sessionId," </li>\n    <li><strong>").concat(Vt,":</strong> ").concat(Qt).concat(e.sessionId,"</li>\n    <li><strong>").concat(zt,":</strong> ").concat(e.appName,"</li>\n    <li><strong>").concat(Gt,": </strong> ").concat(e.appPlatform,"</li>\n    <li><strong>").concat(Wt,": </strong> ").concat(e.sdxVersion," </li>\n    <li><strong>").concat(Ut,": </strong> ").concat(t," </li></ul>")+"<br/> ".concat("Please upload console and sydney logs from debug panel","<br/>"),r="https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[Copilot]:&[System.Description]=".concat(n,"&[System.Area]=OC\\Office+AI+Exp\\Chat&[System.Tags]=UserFeedback");window.open(r,qt)}}),le.a.createElement(ge.a,null,le.a.createElement(fe.a,{disableButtonEnhancement:!0},le.a.createElement(kt.a,{icon:le.a.createElement(ct.k,null),appearance:"subtle"})),le.a.createElement(be.a,null,le.a.createElement(ye.a,null,le.a.createElement(Ce.a,{onClick:function(){h(!0)}},Rt),le.a.createElement(Ce.a,{onClick:function(){d(!0)}},Bt)))),le.a.createElement(ge.a,null,le.a.createElement(fe.a,{disableButtonEnhancement:!0},le.a.createElement(kt.a,{icon:le.a.createElement(Pt.c,null),appearance:"subtle"})),le.a.createElement(be.a,null,le.a.createElement(ye.a,null,le.a.createElement(jt.a,null,le.a.createElement(Ce.a,null,Mt),le.a.createElement(me.a,{icon:le.a.createElement(At.h,null),appearance:"subtle",onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s;return Object(o.__generator)(this,(function(o){return t=null===(a=e.getLogs)||void 0===a?void 0:a.call(e),n=new Blob([JSON.stringify(t)],{type:"application/json"}),r=window.URL.createObjectURL(n),(i=document.createElement("a")).href=r,i.download=null!==(s="consoleLogs-"+e.conversationId)&&void 0!==s?s:".json",i.click(),[2]}))}))}}),le.a.createElement(me.a,{icon:le.a.createElement(ct.a,null),appearance:"subtle",onClick:function(){l(!0)}})),le.a.createElement(jt.a,null,le.a.createElement(Ce.a,null,Lt),le.a.createElement(me.a,{icon:le.a.createElement(At.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.conversationLogObject){var n=new Blob([JSON.stringify(e.conversationLogObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatConversationLogs-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),le.a.createElement(me.a,{icon:le.a.createElement(ct.a,null),appearance:"subtle",onClick:function(){v(!0)}})),le.a.createElement(jt.a,null,le.a.createElement(Ce.a,null,"Sydney Conversation Logs"),le.a.createElement(me.a,{icon:le.a.createElement(At.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.sydneyConversationObject){var n=new Blob([JSON.stringify(e.sydneyConversationObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatHistory-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),le.a.createElement(me.a,{icon:le.a.createElement(ct.a,null),appearance:"subtle",onClick:function(){C(!y)}}))))),le.a.createElement(ge.a,null,le.a.createElement(fe.a,{disableButtonEnhancement:!0},le.a.createElement(kt.a,{icon:le.a.createElement(ct.g,null),appearance:"subtle"})),le.a.createElement(be.a,null,le.a.createElement(ye.a,null,le.a.createElement(Ce.a,{onClick:function(){var t;window.open(null!==(t=e.augloopKustoQueryURL)&&void 0!==t?t:"",qt)}},Ft),le.a.createElement(Ce.a,{onClick:function(){var t;window.open(null!==(t=e.clientKustoQueryURL)&&void 0!==t?t:"",qt)}},Nt)))))),y&&(null==e?void 0:e.telemetryData)&&le.a.createElement(St,{telemetryData:null==e?void 0:e.telemetryData,isModalOpen:y,setIsModalOpen:C}),s&&le.a.createElement(Zt,{isModalOpen:s,setIsModalOpen:l,getLogs:e.getLogs}),g&&le.a.createElement(en,{isModalOpen:g,setIsModalOpen:h,sessionId:e.sessionId,conversationLogObject:e.conversationLogObject,appName:e.appName,appPlatform:e.appPlatform,augloopKustoQueryURL:e.augloopKustoQueryURL,clientKustoQueryURL:e.clientKustoQueryURL,sdxVersion:e.sdxVersion}),u&&le.a.createElement(Xt,{isModalOpen:u,setIsModalOpen:d,chatInputLoadTime:e.chatInputLoadTime,chatPaneLoadTime:e.chatPaneLoadTime}),m&&le.a.createElement(Yt,{isModalOpen:m,setIsModalOpen:v,conversationLogObject:e.conversationLogObject}),S&&le.a.createElement(Jt,{isModalOpen:S,setIsModalOpen:null!==(t=null==e?void 0:e.setShowDebugInfoOnMessage)&&void 0!==t?t:E,debugMessageInfoObject:e.debugMessageInfoObject}))},nn=n(2790),rn=n(552),on=n(3348),an=n(882);var sn,ln,cn,un=Object(S.a)(j),dn=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},workflowStepStack:null!==(r=e.workflowStepStack)&&void 0!==r?r:{},cardHeader:null!==(o=e.cardHeader)&&void 0!==o?o:{},userContentButton:null!==(i=e.userContentButton)&&void 0!==i?i:{},userContentButtonItem:null!==(a=e.userContentButton)&&void 0!==a?a:{},userContentButtonDisabled:{},leftAlignedText:{},thumbnail:{},actionButtonStack:{}};return Object(ue.a)(s)}({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({maxWidth:"288px"},De.a.padding(un.spacingVerticalM,un.spacingHorizontalL)),{fontFamily:"-apple-system"}),De.a.margin(un.spacingVerticalNone,un.spacingHorizontalL,un.spacingVerticalS)),{boxShadow:un.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(o.__assign)({},De.a.gap(un.spacingVerticalS)),userContentButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding(un.spacingVerticalL,un.spacingHorizontalXL)),{minHeight:"40px"}),De.a.borderRadius(un.borderRadiusXLarge)),(Et={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},Et["& .".concat(an.a.icon)]=Object(o.__assign)({},De.a.margin("0px","11px","0px","0px")),Et))}),pn=Object(S.a)(j),gn={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("12px")),De.a.borderRadius("8px")),De.a.margin("16px")),{boxShadow:pn.shadow4,color:pn.neutralPrimary,backgroundColor:pn.neutralLight}),rootHighContrast:Object(o.__assign)({},De.a.border("1px","solid",pn.neutralLighterAlt)),buttonStack:Object(o.__assign)(Object(o.__assign)({},De.a.gap("4px")),{marginTop:"8px"}),workflowStepStack:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.gap("10px")),De.a.padding("10px","8px","20px","8px")),De.a.overflow("hidden")),cardHeader:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{whiteSpace:"pre-wrap"}),userContentButtonItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:pn.neutralLight},De.a.border("1px","solid",pn.neutralLighterAlt)),on.a.body1),(sn={},sn["&:hover .".concat(an.a.icon)]={color:pn.themePrimary},sn)),userContentButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},De.a.padding("0px","15px")),{backgroundColor:pn.neutralLight}),De.a.border("1px","solid",pn.neutralLighterAlt)),on.a.body1),(ln={},ln["&:hover .".concat(an.a.icon)]={color:pn.themePrimary},ln)),userContentButtonDisabled:(cn={color:pn.neutralQuaternary},cn["&:hover .".concat(an.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},cn),leftAlignedText:Object(o.__assign)({textAlign:"left"},De.a.padding("0px","8px")),thumbnail:{paddingLeft:"10px"},actionButtonStack:Object(o.__assign)({marginTop:"8px"},De.a.gap("12px"))},hn=Object(ue.a)(gn),fn=function(){var e=hn(),t=dn();if(a()===r.IOS)e=G(e,t);return e},mn=["Step 1","Step 2","Step 3","Step 4","Step 5"],vn=le.a.memo((function(e){var t,n=e.overrideStyles,r=e.stages,i=e.gotoNextStageString,a=e.index,s=e.lastEnabledStep,l=e.handleButtonClick,c=e.allowForwardNavigation,u=void 0!==c&&c,d=e.displayStatusIcon,p=void 0===d||d,g=fn();G(g,n);var h=Object(o.__read)(Object(se.useState)(0),2),f=h[0],m=h[1],v=Object(o.__read)(Object(se.useState)(!1),2),b=v[0],y=v[1],C=Object(o.__read)(Object(se.useState)(!0),2),O=C[0],S=C[1],E=r||mn,x=function(){y(!b)},I=function(e,t,n){void 0===n&&(n={});var r=Object(Oe.a)(t,e);return le.a.createElement(r,{style:n})};return Object(se.useEffect)((function(){m(a)}),[a]),le.a.createElement(nn.a,{className:g.root,"aria-labelledby":E[0],style:{backgroundColor:"#ecf3fc",margin:"0px",borderRadius:"0px",boxShadow:"none",position:"fixed",width:"-webkit-fill-available",zIndex:"2"}},le.a.createElement(pe,null,le.a.createElement(me.a,{size:"large",role:R,key:f,disabled:!1,"aria-posinset":1,"aria-setsize":null===(t=E[f])||void 0===t?void 0:t.length,className:g.userContentButton,style:{backgroundColor:"#ebf3fc",border:"none",padding:"0px 10px",height:"fit-content",display:"flex",justifyContent:"space-between"}},le.a.createElement("div",{style:{display:"flex",alignItems:"left"}},le.a.createElement("b",null," ",E[f]),le.a.createElement("div",{onClick:function(){x()},style:{paddingLeft:"8px"}},b?I(rn.x,rn.w):I(rn.n,rn.m))),O&&le.a.createElement("div",{style:{display:"flex",alignItems:"right"}},le.a.createElement(me.a,{onClick:function(){!function(e){m(e),l(e),e===E.length-1?S(!1):S(!0)}(f+1)}},i[f+1]?i[f+1]:"Go to next step",I(rn.t,rn.t))))),b&&le.a.createElement("div",{style:{overflow:"auto",maxHeight:"100vh"}},le.a.createElement(pe,{style:g.workflowStepStack},E.map((function(e,t){return le.a.createElement(me.a,{size:"large",role:R,key:t,disabled:!1,"aria-posinset":t+1,"aria-setsize":e.length,className:g.userContentButtonItem,onClick:function(){(t<=s||u)&&function(e){m(e),y(!b),l(e),e===E.length-1?S(!1):S(!0)}(t)},icon:p&&(t<s?I(rn.i,rn.i,{color:"green"}):t===s?I(rn.C,rn.B,{color:"black"}):I(rn.A,rn.z,{color:"black"})),style:{border:"none",borderRadius:"8px",boxShadow:t===f?"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)":"none",justifyContent:"flex-start"}},t===f?le.a.createElement("b",null,e):e)})))))})),bn=n(3384),yn=n(2461),Cn=function(){return H()?OfficeaicopilotStrings.StopGeneratingButtonLabel:"Stop generating"};var On,Sn,En,xn=function(e){var t,n,r,o,i,a,s,l,c={root:null!==(t=e.root)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},loaderHighContrast:{},progressBarStyle:null!==(r=e.progressBarStyle)&&void 0!==r?r:{},headerStyle:null!==(o=e.headerStyle)&&void 0!==o?o:{},stopButtonStyle:null!==(i=e.stopButtonStyle)&&void 0!==i?i:{},stopButtonIconStyle:null!==(a=e.stopButtonIconStyle)&&void 0!==a?a:{},inlineStopIcon:null!==(s=e.inlineStopIcon)&&void 0!==s?s:{},stackStopText:null!==(l=e.stackStopText)&&void 0!==l?l:{}};return Object(ue.a)(c)}({loader:Object(o.__assign)(Object(o.__assign)({display:"inline"},De.a.padding("0px")),De.a.borderRadius("12px")),progressBarStyle:{height:"4px"},stackStopText:{display:"flex"}}),In=Object(S.a)(j),wn={root:Object(o.__assign)(Object(o.__assign)({alignItems:"center"},De.a.margin(In.spacingVerticalNone,In.spacingHorizontalL,In.spacingVerticalM)),De.a.gap(In.spacingVerticalM)),loader:Object(o.__assign)(Object(o.__assign)({minHeight:"48px",backgroundColor:In.neutralLight,boxShadow:In.shadow4,transformOrigin:"bottom",width:"100%"},De.a.overflow("hidden")),De.a.borderRadius(In.borderRadiusXLarge)),loaderHighContrast:Object(o.__assign)({},De.a.border("1px","solid",In.neutralLighterAlt)),progressBarStyle:{backgroundImage:"linear-gradient(90.5deg, ".concat(In.themeLight," 10%, ").concat(In.themeDarkAlt," 32%, ").concat(In.themeLighterAlt," 55%, ").concat(In.themeLighter," 72%, ").concat(In.neutralLighter," 100%)"),backgroundColor:In.neutralLight,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:Object(o.__assign)(Object(o.__assign)({fontWeight:In.fontWeightSemibold},De.a.padding(In.spacingVerticalM)),{lineHeight:"143%",color:In.neutralPrimary}),stopButtonStyle:(On={fontFamily:In.fontFamilyBase,fontSize:In.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},On["&:hover .".concat(an.a.icon)]={color:In.themePrimary},On["&:hover:active .".concat(an.a.icon)]={color:In.themePrimary},On),stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("10px")),De.a.margin(In.spacingVerticalNone,In.spacingHorizontalNone,In.spacingVerticalNone,In.spacingHorizontalS)),De.a.border("0px")),(Sn={height:"44px",width:"44px"},Sn["&:hover .".concat(an.a.icon)]={color:In.themePrimary},Sn["&:hover:active .".concat(an.a.icon)]={color:In.themePrimary},Sn["@media (forced-colors: none)"]={"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},Sn))},Tn=Object(ue.a)(wn),kn=le.a.memo((function(e){var t=e.stylesToOverride,n=e.loadingUiStrings,i=e.stringChangeIntervalDuration,s=void 0===i?3500:i,l=e.showStopButton,c=void 0!==l&&l,u=e.showInlineStopButton,d=void 0!==u&&u,p=e.handleStopButtonOnClick,g=function(){var e=Tn(),t=xn();a()===r.IOS&&G(e,t);return e}(),h=f();G(g,t),g.loaderHighContrast=Object(E.a)(g.loader,g.loaderHighContrast);var m=Object(o.__read)(Object(se.useState)(0),2),v=m[0],b=m[1];return Object(se.useEffect)((function(){b(0)}),[JSON.stringify(n)]),Object(se.useEffect)((function(){var e=setInterval((function(){var t=v+1;t===n.length?clearInterval(e):b(t)}),s);return function(){return clearInterval(e)}}),[v,s,n.length]),le.a.createElement(pe,{style:g.root},le.a.createElement(pe,{style:h?g.loaderHighContrast:g.loader,customProperties:{role:N,"aria-live":"assertive","aria-atomic":!0}},le.a.createElement(pe,{horizontal:!0,style:g.stackStopText},d&&le.a.createElement(me.a,{appearance:"subtle",className:g.inlineStopIcon,icon:le.a.createElement(ct.o,null),onClick:p,"aria-label":Cn(),title:Cn()}),le.a.createElement(st.a,{id:H()?OfficeaicopilotStrings.LoadingUiTextLabel:"loadingUiText",className:g.headerStyle},n[v])),le.a.createElement(bn.a,{bar:{className:g.progressBarStyle},role:"none",thickness:"large",shape:"rounded",title:"ProgressBar"})),c&&le.a.createElement(me.a,{appearance:"subtle",className:g.stopButtonStyle,icon:le.a.createElement(yn.j,null),onClick:p,size:"small","aria-live":"assertive"},Cn()))}));!function(e){e.NEXT_STAGE="NextStage",e.NEXT_CARD="NextCard",e.OPEN_EDITOR="OpenEditor",e.ADD_TOPIC="AddTopic"}(En||(En={}));var jn=n(1820),Pn=n(3387),An=function(){return H()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"wucHeaderText"},_n=le.a.forwardRef((function(e,t){var n,r=e.overrideStyles,i=e.messageButtonContent,a=e.headerText,s=e.addActionButtonProps,l=e.handleEditorOpenButtonClick,c=e.buttonText,u=void 0===c?"Start Generating":c,d=e.buttonTextInEnabledState,p=void 0===d?"":d,g=e.buttonTextInDisabledState,h=void 0===g?"":g,m=e.buttonRole,v=e.enableCheckBox,b=void 0===v||v,y=e.cardIndex,C=void 0===y?0:y,O=(e.allowItemAddition,e.dialogTitle),S=void 0===O?"New Entry":O,x=e.onSelectCheckBox,I=void 0===x?function(e,t){}:x,w=e.handleOnClickItemAddition,T=void 0===w?function(e){}:w,k=e.handleButtonClick,j=void 0===k?function(e){}:k,P=e.handleClientButtonClick,A=void 0===P?function(e){}:P,_=e.shouldDisableButtonAtBottom,D=void 0!==_&&_,L=fn(),M=f(),F=p||u,N=h||u;G(L,r),L.userContentButtonDisabled=Object(E.a)(L.userContentButton,L.userContentButtonDisabled),L.rootHighContrast=Object(E.a)(L.root,L.rootHighContrast);var H=Object(o.__read)(Object(se.useState)(i),2),U=H[0],V=H[1],z=Object(o.__read)(Object(se.useState)(!0),2),W=z[0],Q=z[1],q=Object(o.__read)(Object(se.useState)(F),2),K=q[0],Y=q[1],Z=Object(o.__read)(Object(se.useState)(!1),2),J=Z[0],X=Z[1],$=Object(o.__read)(Object(se.useState)(""),2),ee=$[0],te=$[1],ne=function(e){X(!0),T(e)},re=function(e,t){var n;void 0===t&&(t=!0);var r=Object(o.__spreadArray)([],Object(o.__read)(U),!1),i=Object(o.__spreadArray)([],Object(o.__read)(ce),!1);r.length>0&&r[r.length-1].isAddItemButton?(r.splice(r.length-1,0,e),i.splice(i.length-1,0,t)):(r.push(e),i.push(t)),I(t,null!==(n=e.boldText)&&void 0!==n?n:""),V(r),ue(i)};Object(se.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){void 0===t&&(t=!0),re(e,t)}}}));var oe=function(e,t,n){void 0===n&&(n={});var r=Object(Oe.a)(t,e);return le.a.createElement(r,{style:n})},ie=new Array(null==i?void 0:i.length).fill(!1),ae=Object(o.__read)(Object(se.useState)(ie),2),ce=ae[0],ue=ae[1];return le.a.createElement(nn.a,{className:M?L.rootHighContrast:L.root,"aria-labelledby":An()},a&&le.a.createElement(Pe,null,le.a.createElement(st.a,{id:An(),className:L.cardHeader},a)),U&&le.a.createElement(pe,{style:L.buttonStack,customProperties:{role:B}},U.map((function(e,t){return le.a.createElement(me.a,{size:"large",role:R,key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":U.length,className:e.isDisabled?L.userContentButtonDisabled:L.userContentButton,style:e.isAddItemButton?{borderBlockStyle:"dashed"}:{},onClick:function(){e.onSelectButton&&e.onSelectButton(),e.isAddItemButton&&ne()}},le.a.createElement("div",{style:{display:"flex",alignItems:"center"}},b&&!e.isAddItemButton&&le.a.createElement("div",{onClick:function(){var n=function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(ce),!1);return t[e]=!t[e],ue(t),Q(!0),Y(F),t[e]}(t);e.onSelectCheckBox&&e.onSelectCheckBox(n,e.boldText),I&&I(n,e.boldText)}},ce[t]?oe(rn.j,rn.j,{color:"green"}):oe(yn.i,yn.i)),e.iconUrl&&le.a.createElement("img",{className:L.thumbnail,src:e.iconUrl,alt:"",height:20,width:20}),e.boldText?le.a.createElement("div",null,le.a.createElement("p",{className:L.leftAlignedText,title:e.buttonHyperLinkToolTip?e.buttonHyperLinkToolTip:"",onClick:e.buttonHyperLink?function(){return window.open(e.buttonHyperLink,"_blank")}:function(){return console.log("Link not available for button")}},le.a.createElement("b",null," ",e.boldText," ")," ",e.message)):le.a.createElement("p",null,e.message)))})),le.a.createElement(Xe.a,{modalType:"modal",open:J},le.a.createElement($e.a,{className:L.root,tabIndex:0},le.a.createElement(et.a,null,le.a.createElement(tt.a,{className:L.buttonStack,action:le.a.createElement(nt.a,{action:"close"},le.a.createElement(me.a,{appearance:"subtle","aria-label":"close",icon:le.a.createElement(ct.n,null),onClick:function(){return X(!1)}}))},null!=S?S:"Add Item"),le.a.createElement(rt.a,null,le.a.createElement(jn.a,{onChange:function(e,t){return te(t)},className:L.root,styles:{fieldGroup:{borderColor:"transparent"}}})),le.a.createElement(Pn.a,{className:L.buttonStack},le.a.createElement(me.a,{className:L.buttonStack,appearance:"primary",onClick:function(){if(!(i.length-2<0||0===ee.length)){var e={boldText:ee};X(!1),re(e,!0)}}},"Submit")))))),le.a.createElement(pe,{horizontal:!0,style:L.actionButtonStack},s&&le.a.createElement(Pe,null,le.a.createElement(me.a,{appearance:null!==(n=s.appearance)&&void 0!==n?n:void 0,onClick:function(){s.isEditorNeedToOpen?l&&l():ne()}},s.text)),u.length>0&&le.a.createElement(Pe,null,le.a.createElement(me.a,{appearance:null!=m?m:void 0,disabled:!W||(null==U?void 0:U.length)>0&&b&&!ce.some((function(e){return e})),onClick:function(){var e;D||(e=C,Q(!1),Y(N),j&&j(e),A&&A(e))}},K))))})),Dn=le.a.memo(_n),Ln=le.a.forwardRef((function(e,t){var n=e.onClickNextStage,r=void 0===n?function(e){}:n,i=e.onClickNext,a=void 0===i?function(e){}:i,s=e.stageIndex,l=void 0===s?1:s,c=e.data,u=void 0===c?{}:c,d=null==u?void 0:u.componentRenderData,p=Object(se.useRef)();return Object(se.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=p.current)||void 0===n||n.addUserContentMessageItem(e,t)}}})),le.a.createElement(pe,null,d.map((function(e,t){return e.handleButtonClick=function(){a(l),r(l)},le.a.createElement(Dn,Object(o.__assign)({ref:p,key:t,cardIndex:1},e))})))})),Mn=Ln,Bn=se.forwardRef((function(e,t){e.stageHeader;var n=e.onClientInteractionData,r=void 0===n?function(e){}:n,i=(e.getComponentRenderData,e.shouldEnableNext,e.onClickNext),a=void 0===i?function(e){}:i,s=(e.isHTMLEditorUpdateRequired,e.stageIndex),l=void 0===s?0:s,c=e.onClickNextStage,u=void 0===c?function(e){}:c,d=e.data,p=void 0===d?{}:d,g=function(e){var t,n,r=0;try{for(var i=Object(o.__values)(e),a=i.next();!a.done;a=i.next()){if(a.value.buttonAction==En.NEXT_CARD)return r;r++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(null==p?void 0:p.componentRenderData),h=new Set,f=se.useRef(),m=Object(o.__read)(se.useState(h),2),v=m[0],b=m[1];se.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=f.current)||void 0===n||n.addUserContentMessageItem(e,t)}}}));var y=Object(o.__read)(se.useState(g),2),C=y[0],O=y[1],S=function(e){if(O(e+1),r){var t=Object(o.__spreadArray)([],Object(o.__read)(v),!1);r(t)}},E=(null==p?void 0:p.componentRenderData)?null==p?void 0:p.componentRenderData:[];return se.createElement(pe,null,E.map((function(e,t){var n=Object(o.__assign)({},e);if(n.onSelectCheckBox=function(e,t){!function(e,t){var n=new Set(v);n.has(t)&&!e?n.delete(t):!n.has(t)&&e&&n.add(t),b(n)}(e,t)},e.buttonAction===En.NEXT_STAGE?n.handleButtonClick=function(){a(l),u(l)}:e.buttonAction===En.NEXT_CARD&&(n.handleButtonClick=function(){return S(t)}),t<=C)return se.createElement(Dn,Object(o.__assign)({ref:f,key:t,cardIndex:l},n))})))})),Rn=Bn,Fn=le.a.forwardRef((function(e,t){e.workflowName;var n=e.workflowStages,r=void 0===n?[]:n,i=e.handleEditorOpenButtonClick,a=e.enableALSession,s=void 0!==a&&a,l=e.workflowLoadingUiStrings,c=void 0===l?["Working on it..."]:l,u=e.allowForwardNavigation,d=void 0!==u&&u,p=e.displayStatusIconInStepper,g=void 0===p||p,h=Object(o.__read)(le.a.useState(0),2),f=h[0],m=h[1],v=Object(o.__read)(le.a.useState(!0),2),b=v[0],y=v[1],C=Object(o.__read)(le.a.useState(0),2),O=C[0],S=C[1],E=le.a.useRef(),x=le.a.useRef();le.a.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n,r;b?null===(n=E.current)||void 0===n||n.addUserContentMessageItem(e,t):null===(r=x.current)||void 0===r||r.addUserContentMessageItem(e,t)}}})),le.a.useEffect((function(){r.map((function(e,t){var n,r,o;(null===(n=e.data)||void 0===n?void 0:n.componentRenderData)&&(null===(o=null===(r=e.data)||void 0===r?void 0:r.componentRenderData)||void 0===o||o.map((function(e,t){var n;e.addActionButtonProps&&(null===(n=e.addActionButtonProps)||void 0===n?void 0:n.isEditorNeedToOpen)&&(e.handleEditorOpenButtonClick=i)})))}))})),le.a.useEffect((function(){f>O&&S(f)}),[f,O]),le.a.useEffect((function(){}),[f]);var I=Object(o.__read)(le.a.useState(!1),2),w=I[0],T=I[1];le.a.useEffect((function(){w&&(r[f].shouldEnableNext&&r[f].shouldEnableNext()?T(!1):s||setTimeout((function(){T(!1)}),2e3))}));var k=function(e){var t,n;T(!0),(null===(t=r[e+1])||void 0===t?void 0:t.getComponentRenderData)&&(null===(n=r[e+1])||void 0===n||n.getComponentRenderData()),m(e)},j={loadingUiStrings:c},P=r.slice(1),A=function(e){var t=[];return e.forEach((function(e,n){t.push(e.useCompleteStageHeader?e.stageHeader:"Step "+(n+1)+": "+e.stageHeader)})),t}(P),_=r.map((function(e){return e.gotoNextStageString})),D=r[0];return D.onClickNextStage=function(){y(!1)},D.stageIndex=0,b?le.a.createElement(pe,null,le.a.createElement(Mn,Object(o.__assign)({ref:E},D))):le.a.createElement(pe,null,le.a.createElement("div",{style:{height:"46px"}}),le.a.createElement(vn,{stages:A,gotoNextStageString:_,handleButtonClick:function(e){var t,n,o;(null===(t=P[f])||void 0===t?void 0:t.onClickNext)&&P[f].onClickNext(e),e>f&&(T(!0),(null===(n=r[e+1])||void 0===n?void 0:n.getComponentRenderData)&&(null===(o=r[e+1])||void 0===o||o.getComponentRenderData())),m(e)},index:f,lastEnabledStep:O,allowForwardNavigation:d,displayStatusIcon:g}),P.map((function(e,t){if(t===f){if(w)return le.a.createElement(kn,Object(o.__assign)({key:t},j));var n=e;return e.stageIndex=t+1,e.onClickNextStage=k,le.a.createElement(Rn,Object(o.__assign)({ref:x,key:t},n))}})))})),Nn=n(3388),Hn=n(3389),Un=n(3390),Vn=n(3600),zn=n(3601),Gn=n(1498),Wn=function(){return H()?OfficeaicopilotStrings.RestrictiveSearchMessageTitleText:"Your organization's admin has restricted Copilot from accessing certain SharePoint sites."},Qn=function(){return H()?OfficeaicopilotStrings.RestrictiveSearchMessageBodyText:"This limits the content Copilot can search and reference when responding to your prompts."},qn=function(e){var t=e.handleRestrictiveMsgDismissClick,n=Object(o.__read)(le.a.useState(!0),2),r=n[0],i=n[1],a=le.a.useRef(null),s=function(){i(!r)};return le.a.createElement(Un.a,null,le.a.createElement(Vn.a,{intent:"info",ref:a},function(){var e;if(r){var t=Math.round(.2*(null===(e=a.current)||void 0===e?void 0:e.offsetWidth)),n=Wn(),o=Qn();if(n.length<t){var i=t-n.length;o=o.substring(0,i)+"..."}else n=n.substring(0,t),o="...";return le.a.createElement(Nn.a,null,le.a.createElement(Hn.a,null,n),o)}return le.a.createElement(Nn.a,null,le.a.createElement(Hn.a,null,Wn()),Qn()," ",le.a.createElement($t.a,{href:"https://go.microsoft.com/fwlink/p/?linkid=2260808"},H()?OfficeaicopilotStrings.LearnMoreString:"Learn More"))}(),le.a.createElement(zn.a,{containerAction:le.a.createElement("div",null,le.a.createElement(me.a,{appearance:"transparent",icon:r?le.a.createElement(rn.n,null):le.a.createElement(rn.x,null),onClick:s}),le.a.createElement(me.a,{appearance:"transparent",icon:le.a.createElement(Gn.s,null),onClick:t}))})))},Kn=n(3392),Yn=n(3354);var Zn,Jn=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},freCard:null!==(n=e.freCard)&&void 0!==n?n:{},freImage:null!==(r=e.freImage)&&void 0!==r?r:{},freHeaderText:null!==(o=e.freHeaderText)&&void 0!==o?o:{},freDescriptionText:null!==(i=e.freDescriptionText)&&void 0!==i?i:{},freButton:null!==(a=e.freButton)&&void 0!==a?a:{}};return Object(ue.a)(s)}({freCard:Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("12px")),{maxWidth:"288px"}),freHeaderText:{fontFamily:"-apple-system",lineHeight:"normal"},freDescriptionText:{marginTop:"12px",fontFamily:"-apple-system",lineHeight:"normal"},freButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("16px")),De.a.borderRadius("12px")),{minHeight:"52px",height:"auto",fontFamily:"-apple-system",fontWeight:"600",fontSize:"17px",justifyContent:"center"})}),Xn=Object(S.a)(j),$n={freCard:{},root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("12px","16px")),{alignItems:"center",textAlign:"center",color:Xn.neutralPrimary,backgroundColor:Xn.neutralLight,boxShadow:Xn.shadow4}),De.a.margin("1px","16px","none")),De.a.border("1px","solid",Xn.neutralLight)),De.a.borderRadius("8px")),freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:Object(o.__assign)(Object(o.__assign)({textAlign:"center",whiteSpace:"pre-wrap"},De.a.padding("1px")),De.a.margin("20px","0px","0px")),freButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Xn.neutralLight,width:"100%"},De.a.padding("5px","12px")),De.a.margin("20px","0px","0px")),De.a.borderRadius("4px")),{"@media (forced-colors: none)":Object(o.__assign)(Object(o.__assign)({backgroundColor:Xn.themePrimary},De.a.border("none")),{":hover":Object(o.__assign)({color:Xn.neutralLight,backgroundColor:Xn.themePrimary},De.a.border("none")),":active":Object(o.__assign)({color:Xn.neutralLight,backgroundColor:Xn.themePrimary},De.a.border("none"))})})},er=Object(ue.a)($n),tr=function(){return H()?OfficeaicopilotStrings.FREHeaderTextLabel:"freSharedHeaderText"},nr=function(e){var t=e.headerText,n=void 0===t?H()?OfficeaicopilotStrings.FREHeaderText:"Copilot is here to help!":t,o=e.descriptionText,i=e.freImagePath,s=e.handleFreButtonClick,l=void 0===s?function(){}:s,c=e.shouldFocusOnComponentMount,u=void 0!==c&&c,d=e.overrideStyles,p=function(){var e=er(),t=Jn();a()===r.IOS&&G(e,t);return e}();G(p,d);var g=" "+n+" ",h=" "+o+" ";return Object(se.useEffect)((function(){var e;u&&(null===(e=document.getElementById("FreSharedId"))||void 0===e||e.focus())})),le.a.createElement(pe,{style:p.root,customProperties:{role:D,"aria-labelledby":tr()}},le.a.createElement(Ae.a,{src:i,className:p.freImage,alt:""}),le.a.createElement(Kn.a,{id:tr(),className:p.freHeaderText},g),le.a.createElement(Yn.a,{id:H()?OfficeaicopilotStrings.FREDescriptionTextLabel:"freSharedDescription",className:p.freDescriptionText},h),le.a.createElement(me.a,{className:p.freButton,onClick:l},H()?OfficeaicopilotStrings.FREButtonText:"Get started"))},rr=function(){return H()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"zqmHeaderText"};var or,ir,ar,sr,lr=Object(S.a)(j),cr=function(e){var t,n,r,o,i={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},cardHeader:null!==(r=e.cardHeader)&&void 0!==r?r:{},zeroQueryButton:null!==(o=e.zeroQueryButton)&&void 0!==o?o:{},zeroQueryButtonDisabled:{}};return Object(ue.a)(i)}({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({maxWidth:"288px"},De.a.padding(lr.spacingVerticalM,lr.spacingHorizontalL)),{fontFamily:"-apple-system"}),De.a.margin(lr.spacingVerticalNone,lr.spacingHorizontalL,lr.spacingVerticalS)),{boxShadow:lr.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(o.__assign)({},De.a.gap(lr.spacingVerticalS)),zeroQueryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding(lr.spacingVerticalL,lr.spacingHorizontalXL)),{minHeight:"40px"}),De.a.borderRadius(lr.borderRadiusXLarge)),(Zn={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},Zn["& .".concat(an.a.icon)]=Object(o.__assign)({},De.a.margin("0px","11px","0px","0px")),Zn))}),ur=Object(S.a)(j),dr={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("12px")),De.a.borderRadius("8px")),De.a.margin("16px")),{boxShadow:ur.shadow4,color:ur.neutralPrimary,backgroundColor:ur.neutralLight}),rootHighContrast:Object(o.__assign)({},De.a.border("1px","solid",ur.neutralLighterAlt)),buttonStack:Object(o.__assign)(Object(o.__assign)({},De.a.gap("4px")),{marginTop:"8px"}),cardHeader:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{whiteSpace:"pre-wrap"}),zeroQueryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",height:"fit-content",textAlign:"start",backgroundColor:ur.neutralLight},De.a.border("1px","solid",ur.neutralLighterAlt)),on.a.body1),(or={},or["&:hover .".concat(an.a.icon)]={color:ur.themePrimary},or)),zeroQueryButtonDisabled:(ir={color:ur.neutralQuaternary},ir["&:hover .".concat(an.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},ir)},pr=Object(ue.a)(dr),gr=le.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,o=e.headerText,i=e.handleButtonClick,s=void 0===i?function(e){console.log("suggestion clicked:"+e)}:i,l=function(){var e=pr(),t=cr();a()===r.IOS&&(e=G(e,t));return e}(),c=f();G(l,t),l.zeroQueryButtonDisabled=Object(E.a)(l.zeroQueryButton,l.zeroQueryButtonDisabled),l.rootHighContrast=Object(E.a)(l.root,l.rootHighContrast);return le.a.createElement(nn.a,{className:c?l.rootHighContrast:l.root,"aria-labelledby":rr()},le.a.createElement(Pe,null,le.a.createElement(st.a,{id:rr(),className:l.cardHeader},o)),le.a.createElement(pe,{style:l.buttonStack,customProperties:{role:B}},n.map((function(e,t){return le.a.createElement(me.a,{size:"large",role:R,icon:(r=e.iconRegular,o=e.iconHover,i=Object(Oe.a)(o,r),le.a.createElement(i,null)),key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":n.length,className:e.isDisabled?l.zeroQueryButtonDisabled:l.zeroQueryButton,onClick:function(){s(e.promptSuggestion)}},e.promptSuggestion);var r,o,i}))))})),hr=n(2809),fr=n(1458),mr=Object(S.a)(j),vr={root:Object(o.__assign)(Object(o.__assign)({},De.a.margin("16px")),De.a.gap("8px")),zeroQueryV2Button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",height:"auto",textAlign:"start",backgroundColor:Le.a.colorNeutralBackground1},De.a.padding("12px","16px")),De.a.borderRadius("8px")),De.a.gap("8px")),on.a.body1),(ar={boxShadow:Le.a.shadow2},ar["&:hover"]={boxShadow:Le.a.shadow8,backgroundColor:Le.a.colorNeutralBackground1},ar["& .".concat(fr.a.prompt)]={gridColumnStart:"icon"},ar)),zeroQuerySkillText:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("4px")),{backgroundColor:Le.a.colorNeutralBackground3,color:Le.a.colorNeutralForeground2}),De.a.padding("3px")),(sr={},sr["&:hover"]={backgroundColor:Le.a.colorNeutralBackground2Hover,color:Le.a.colorNeutralForeground1Hover},sr)),zeroQueryHintText:{color:Le.a.colorNeutralForeground4},zeroQueryIcon:{color:mr.themePrimary}},br=Object(ue.a)(vr),yr=le.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.isHVCAppChatV2Enabled,o=e.hvcPromptStringsList,i=e.handleButtonClick,a=br();G(a,t);return le.a.createElement(pe,{style:a.root,customProperties:{role:B}},n.map((function(e,t){var s,l,c,u,d,p,g,h,f="",m="",v="",y="",C=[];if(r)if((null==o?void 0:o.length)>0)C=function(e,t){for(var n=[],r=e,o=0,i=function(e,t){return t.find((function(t){return t.every((function(t){return e.includes(t())}))}))}(r,t);r.length>0;){var a=!1,s=-1;if((null==i?void 0:i.length)>0&&o<(null==i?void 0:i.length)){var l=i;0===(s=r.indexOf(l[o]()))&&(a=!0,n.push({promptType:b.Skill,promptText:l[o]()}),r=r.substring(l[o]().length))}if(a)o++;else{var c=r.indexOf("["),u=r.indexOf("]"),d=r.indexOf("("),p=r.indexOf(")"),g=-1,h=b.Regular;c>=0&&u>=0&&0===(g=c)&&(h=b.Ghost,g=u+1),d>=0&&p>=0&&(-1===g||d<g)&&0===(g=d)&&(h=b.File,g=p+1),-1===g&&(g=s>0?s:r.length),n.push({promptType:h,promptText:r.substring(0,g)}),r=r.substring(g)}}return n}(e.promptSuggestionText,o);else{var O=function(e){var t=w,n=w,r=w,o=w;if(!e||0===e.length)return{prefixText:r,skillText:o,inputText:t,hintText:n};var i=e.lastIndexOf("}"),a=e.lastIndexOf("{",i);i>a&&a>=0&&(o=e.slice(a+1,i),r=e.slice(0,a),e=e.slice(i+1));var s=e.lastIndexOf("]"),l=e.lastIndexOf("[",s);return s>l&&l>=0?(t=e.slice(0,l),n=e.slice(l,s+1)):t=e,{prefixText:r,skillText:o,inputText:t,hintText:n}}(e.promptSuggestionText);v=null!==(s=null==O?void 0:O.prefixText)&&void 0!==s?s:"",y=null!==(l=null==O?void 0:O.skillText)&&void 0!==l?l:"",f=null!==(c=null==O?void 0:O.inputText)&&void 0!==c?c:"",m=null!==(u=null==O?void 0:O.hintText)&&void 0!==u?u:""}else{O=function(e){var t=w,n=w,r=e.lastIndexOf("]"),o=e.lastIndexOf("[",r);return r>o&&o>=0?(t=e.slice(0,o),n=e.slice(o,r+1)):t=e,{inputText:t,hintText:n}}(e.promptSuggestionText);f=null!==(d=null==O?void 0:O.inputText)&&void 0!==d?d:"",m=null!==(p=null==O?void 0:O.hintText)&&void 0!==p?p:""}return le.a.createElement(hr.a,{role:R,icon:(g=e.iconRegular,h=g,le.a.createElement(h,{className:a.zeroQueryIcon})),key:t,disabled:e.isDisabled||!1,"aria-posinset":t+1,"aria-setsize":n.length,className:a.zeroQueryV2Button,category:e.promptSuggestionCategory,prompt:0===C.length?le.a.createElement(Yn.a,null,r&&v,r&&y.length>0&&le.a.createElement("span",{className:a.zeroQuerySkillText},y),f,le.a.createElement("span",{className:a.zeroQueryHintText},m)):le.a.createElement(Yn.a,null,C.map((function(e,t){switch(e.promptType){case b.Ghost:return le.a.createElement("span",{className:a.zeroQueryHintText},e.promptText);case b.Skill:return le.a.createElement("span",{className:a.zeroQuerySkillText},e.promptText);case b.Regular:default:return le.a.createElement("span",null,e.promptText)}}))),onClick:function(){var t=f;y.length>0&&(t=v+y+t),C.length>0&&(t=C.map((function(e){return e.promptType===b.Ghost||e.promptType===b.File?"":e.promptText})).join("")),i(t,e.promptSuggestionText)}})})))})),Cr=n(3333);function Or(){return H()?OfficeaicopilotStrings.DeleteAllChatHistoryButtonText:"Delete all Copilot history"}function Sr(){return H()?OfficeaicopilotStrings.NewConversationButtonText:"Create new conversation"}function Er(){return H()?OfficeaicopilotStrings.ShowChatHistoryButtonText:"Chat history"}var xr,Ir=Object(S.a)(A),wr=function(e){return Object(ue.a)((void 0===(t=e)&&(t=!0),{root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.overflow("visible")),t?De.a.border("none"):{}),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:Ir.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:Ir.colorNeutralBackground3Hover}}})}));var t},Tr={ShowChatHistoryAllButton:Object(o.__assign)({},De.a.margin("0px","16px"))},kr=Object(ue.a)(Tr),jr=se.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles,o=wr(!1);return se.createElement(me.a,{className:Object(E.a)(o().root,kr().ShowChatHistoryAllButton,n),icon:se.createElement(Cr.b,{className:r}),onClick:t,"aria-label":Er()},Er())})),Pr=n(241),Ar=n(1134);!function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(xr||(xr={}));var _r,Dr,Lr;!function(e){e.Dogfood="dogfood",e.Production="production"}(_r||(_r={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.TestApp="TestApp"}(Dr||(Dr={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(Lr||(Lr={}));var Mr,Br,Rr=function(){return"undefined"!=typeof OfficeaicopilotStrings};function Fr(e,t){var n=Array.from(e),r=new Blob([new Uint8Array(n)],{type:t||"image/png"}),o=new FileReader;return o.readAsDataURL(r),new Promise((function(e,t){o.onload=function(){var t=o.result;e(t)},o.onerror=function(){t(o.error)}}))}!function(e){e.DallEImages="DallEImages",e.DesignSuggestions="DesignSuggestions"}(Mr||(Mr={})),function(e){e.Production="Production",e.Dogfood="Dogfood",e.Automation="Automation",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Other="Other"}(Br||(Br={}));var Nr,Hr=function(e){var t,n,r=e.clientSettings,i=e.hostTokenProvider,a=e.isAuthEnabled,s=e.isRehydration,l=e.turnId,c=e.hostCallback,u=e.fileCacheInfo,d=function(e,t){return void 0===e&&(e=_r.Production),void 0===t&&(t=!0),e===_r.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))}(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,a),p=(void 0===(n=null==r?void 0:r.selectedDesignerEnv)&&(n=_r.Production),n===_r.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):new URL("https://designerapp.officeapps.live.com")),g=(null==r?void 0:r.clientId)||Object(Ar.a)(),h=(null==r?void 0:r.sessionId)||Object(Ar.a)(),f=(null==r?void 0:r.correlationId)||Object(Ar.a)(),m=null==r?void 0:r.hostAppName,v=(null==r?void 0:r.scenarioName)||"Other",b=null==r?void 0:r.platformType,y=null==r?void 0:r.hostBuildVersion,C="".concat(m,"-").concat(b),O=null==r?void 0:r.audienceGroup,S=e.parentContainerIdentifier,E=se.useMemo((function(){var t,n,o,a,s,l;return{miniURL:d,serviceBaseURL:p,viewConfig:{view:Pr.e.Chat,theme:null!==(t=null==r?void 0:r.designerTheme)&&void 0!==t?t:Pr.d.Light,showFeedbackSection:!0},fileCacheInfoConfig:{hostCallback:null!=c?c:function(e){console.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:u},telemetryConfig:{audienceGroup:null!=O?O:Br.Other,clientId:g,clientName:null!=m?m:"unknown",hostBuildVersion:null!=y?y:"unknown",hostEnvironment:C,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:h,correlationId:f,platform:(l=null!==(n=null==r?void 0:r.platformType)&&void 0!==n?n:Lr.Web,l===Lr.iOS?{platform:"iOS"}:l===Lr.Web?{platform:"Web"}:l===Lr.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform},container:document.getElementById(S),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(o=e.preferredCtaButtonLabel)&&void 0!==o?o:Pr.a.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(a=e.preferredImageFormat)&&void 0!==a?a:"png",hostTokenProvider:i,lng:null!==(s=null==r?void 0:r.uiLanguage)&&void 0!==s?s:"en-US"}}),[d,p,null==r?void 0:r.designerTheme,null==r?void 0:r.platformType,null==r?void 0:r.uiLanguage,c,u,g,m,y,C,h,f,S,e.preferredCtaButtonLabel,e.preferredImageFormat,i]),x=se.useCallback((function(e,t,n,r,i,a){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var c;return Object(o.__generator)(this,(function(u){switch(u.label){case 0:return[4,(c=new Pr.b(Object(o.__assign)(Object(o.__assign)({},E),{container:document.getElementById(e)}))).initialize(Object(o.__assign)({turnId:l,isRehydration:s,scenario:v,minCount:3,maxCount:4},null!=t?t:{}))];case 1:return u.sent(),n&&c.on("done",n),r&&c.on("customize",r),a&&c.on("feedback",a),i&&c.on("AnswerCardResize",i),[2,c]}}))}))}),[E,s,v,l]);return{designerMiniSettings:E,initializeDesignerMini:x}},Ur=n(35),Vr=Object(Ur.db)({container:{borderRadius:"8px",height:"400px",padding:"6px 0px",gap:"4px",alignItems:"flex-start",position:"relative",zIndex:"1",overflowWrap:"anywhere"},lightThemePalette:{backgroundColor:"#FFFFFF",boxShadow:"0px 1px 2px  #00000024, 0px 0px 2px #0000001f"},darkThemePalette:{backgroundColor:"#292929",boxShadow:"0px 1px 2px  #FFFFFF24, 0px 0px 2px #FFFFFF1f"}}),zr=function(e){var t,n,r=se.useMemo((function(){return Object(Ar.a)()}),[]),i=se.useRef(),a=se.useRef(!1),s=Rr()?OfficeaicopilotStrings.DesignerPreviewLabel:"Designer Preview",l=Hr({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:r,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo}),c=l.initializeDesignerMini,u=l.designerMiniSettings,d=se.useCallback((function(t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n,r,i,a,s;return Object(o.__generator)(this,(function(l){switch(l.label){case 0:return(null===(r=t.options)||void 0===r?void 0:r.isUrl)&&t.uri?(null===(i=e.insertImagesInCanvas)||void 0===i||i.call(e,t.uri,Object(o.__assign)(Object(o.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri})),[3,3]):[3,1];case 1:return[4,Fr(t.media,t.mimeType)];case 2:n=l.sent(),null===(a=e.insertImagesInCanvas)||void 0===a||a.call(e,n,Object(o.__assign)(Object(o.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(s=t.options)||void 0===s?void 0:s.isUrl)?t.uri:void 0})),l.label=3;case 3:return[2]}}))}))}),[e]),p=se.useCallback((function(e){var t=document.getElementById(r);t&&(t.style.height="".concat(e.height,"px"))}),[r]),g=se.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,u)}),[u,e]),h=se.useCallback((function(t){!function(e,t,n,r){e===Pr.c.Like?r?null==t||t(r):null==t||t():e===Pr.c.Dislike&&(r?null==n||n(r):null==n||n())}(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),f=se.useMemo((function(){if(e.isStockQuery){var t=void 0;return t=e.imageType&&"enterprise"===e.imageType.toLowerCase()?e.companyName&&e.companyName.length>0?(n=Rr()?OfficeaicopilotStrings.ChatCardSourceEnterprise:"From %s content library",r=e.companyName,n.includes("%s")?n.replace("%s",r):n):"From your organization's asset library":Rr()?OfficeaicopilotStrings.ChatCardSourceStockContent:"From Microsoft 365 creative content library",Object(o.__assign)({stockContent:e.stockImages},void 0!==t&&{sourceDescription:t,artifactType:Mr.DesignSuggestions})}return e.dimensions?{dimensions:e.dimensions,text:e.userInput.trim(),artifactType:Mr.DesignSuggestions}:{text:e.userInput.trim(),sourceDescription:Rr()?OfficeaicopilotStrings.ChatCardSourceDALLE:"Powered by DALL-E 3",artifactType:Mr.DallEImages};var n,r}),[e.dimensions,e.isStockQuery,e.stockImages,e.userInput]);return se.useEffect((function(){a.current||c(r,f,d,g,p,h).then((function(e){i.current=e,a.current=!0})).catch((function(e){console.error(e)}))}),[f,c,p,g,d,h,r]),se.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&i.current&&i.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),se.createElement(se.Fragment,null,se.createElement("div",{id:r,key:r,className:"".concat(Vr.container," ").concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===Pr.d.Dark?Vr.darkThemePalette:Vr.lightThemePalette),tabIndex:0,"aria-label":s}))},Gr=n(3403),Wr=n(3579),Qr=n(2853),qr=function(e){var t,n,r=fn();return le.a.createElement(pe,{style:r.root,customProperties:{role:B}},le.a.createElement(Gr.a,{variant:"medium"},null!==(t=e.launchText)&&void 0!==t?t:"Would you like to use Copilot Workflows to generate the content based on the steps recommended by your organization?"),le.a.createElement(pe,{horizontal:!0},le.a.createElement(Pe,null,le.a.createElement(me.a,{appearance:"primary",style:{marginTop:"5px",borderBlockStyle:"dashed"},onClick:function(){var t;null===(t=e.onLaunch)||void 0===t||t.call(e)}},le.a.createElement(Wr.a,{style:{marginRight:"5px",paddingTop:"3px"}},function(e,t,n){void 0===n&&(n={});var r=Object(Oe.a)(t,e);return le.a.createElement(r,{style:n})}(Qr.e,Qr.e)),null!==(n=e.buttonText)&&void 0!==n?n:"Launch Copilot Workflows"))))},Kr=n(1564),Yr=function(){return se.useContext(Kr.a)},Zr=Object(S.a)(j),Jr={stack:{},AccordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:Zr.neutralPrimary,marginBottom:"8px"},AccordionCardButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"},De.a.margin("5px","6px","0px","4px")),De.a.border("1px","solid",Zr.neutralLighterAlt)),De.a.borderRadius("4px")),De.a.padding("6px","10px","6px","6px")),(Nr={backgroundColor:"transparent",color:Zr.neutralPrimary,top:"0",zIndex:"1",float:"right",height:"auto"},Nr["& .".concat(an.a.icon)]={fontSize:"inherit",height:"inherit",marginRight:"4px"},Nr["&:hover:enabled"]={color:Zr.black},Nr["&:focus"]={color:Zr.black},Nr["&:disabled"]=Object(o.__assign)(Object(o.__assign)({},De.a.borderColor(Zr.neutralPrimaryAlt)),{color:Zr.neutralQuaternary,backgroundColor:Zr.neutralTertiary}),Nr))},Xr=Object(ue.a)(Jr),$r=function(e){var t=e.styles,n=e.cardButtons,r=G(Xr(),t);return le.a.createElement(Wr.a,{horizontal:!0,wrap:!0},le.a.createElement(Wr.a,{horizontal:!0,className:r.AccordionCardFooter},null==n?void 0:n.map((function(e,t){return le.a.createElement(me.a,{tabIndex:0,key:t,className:r.AccordionCardButton,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:null==e?void 0:e.handleOnMouseEnter,onMouseLeave:null==e?void 0:e.handleOnMouseLeave,onFocus:null==e?void 0:e.handleOnMouseEnter,onBlur:null==e?void 0:e.handleOnMouseLeave},e.buttonText)}))))},eo=Object(S.a)(j),to={stack:{"> *":{marginBottom:"12px"}},contentCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",eo.neutralLighterAlt)),De.a.margin("8px","20px","8px","15px")),De.a.padding("8px")),{boxShadow:eo.shadow4,backgroundColor:eo.neutralLight}),De.a.borderRadius(eo.borderRadiusXLarge)),{overflowWrap:"anywhere",color:eo.neutralPrimary}),contentHeader:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{marginBottom:"12px"})},no=Object(ue.a)(to);function ro(e,t){return le.a.createElement($r,{styles:e,cardButtons:t})}var oo,io=function(e){var t,n,r=e.styles,o=e.body,i=G(no(),r),a=o.renderHeader?o.renderHeader((function(){})):(null===(t=o.cardContent)||void 0===t?void 0:t.contentHeader)?le.a.createElement(st.a,{className:i.contentHeader},o.cardContent.contentHeader):void 0,s=function(){var e;return null===(e=o.cardContent)||void 0===e?void 0:e.contentBody},l=o.renderBody?o.renderBody((function(){return s(o.cardContent)})):s(o.cardContent),c=o.renderFooter?o.renderFooter((function(){var e;return ro(r,null===(e=o.cardContent)||void 0===e?void 0:e.cardButtons)})):ro(r,null===(n=o.cardContent)||void 0===n?void 0:n.cardButtons);return le.a.createElement(pe,{style:i.contentCard,customProperties:{tabIndex:-1}},a,l,c)};!function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(oo||(oo={}));var ao=function(e){return Object(ue.a)({accordionCardRoot:{paddingTop:"5px",marginBottom:"8px",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",fontWeight:"400",lineHeight:"20px"},accordionCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({flexWrap:"wrap",backgroundColor:"".concat(e.palette.white)},De.a.border("1px","solid",e.palette.neutralLighterAlt)),De.a.borderRadius("8px")),{marginLeft:"15px",marginRight:"20px"}),De.a.gap("4px")),De.a.padding("8px")),{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)","> *":{marginBottom:"12px"}}),cardHeader:Object(o.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},De.a.margin("12px 12px 0 12px")),contentHeader:Object(o.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},De.a.margin("4px")),contentTitleGroup:{display:"block",width:"auto","> button":{marginLeft:"10px",marginTop:"5px",width:"16px",height:"16px",color:"".concat(e.palette.black),top:"0",zIndex:"1",float:"right",selectors:{":hover":{backgroundColor:"transparent",color:"".concat(e.palette.black)},":focus":{backgroundColor:"transparent",color:"".concat(e.palette.black)}},"> i":{fontSize:"12px"}}}})},so=n(1852),lo=function(e){var t=e.index,n=le.a.useRef(),r=Object(o.__read)(le.a.useState(!1),2),i=r[0],a=r[1],s=function(e){var t;a(!i),null===(t=n.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault()},l=Yr(),c=ao(l)(),u={styles:e.styles,feedbackSectionPosition:oo.None,shouldShowAIGeneratedIndicator:!0,body:{cardContent:e.cardContent,renderHeader:function(n){if(void 0!==e.cardContent){var r=le.a.createElement(so.a,{id:"RelatedQuestionExpand".concat(t),iconProps:{iconName:"ChevronDown"},onClick:s,"data-is-focusable":!1,tabIndex:-1,ariaLabel:""});return le.a.createElement(pe,null,le.a.createElement(pe,{style:Object(E.a)(c.contentTitleGroup,e.styles.contentTitleGroup)},le.a.createElement(Gr.a,{className:c.contentHeader},e.cardContent.contentHeader),r),i&&e.cardContent.contentBody?n():void 0)}},renderBody:function(t){if(i&&e.cardContent.contentBody)return t()},renderFooter:function(t){return i&&e.cardContent.contentBody?t():null}}};return le.a.createElement(io,Object(o.__assign)({key:t,styles:e.styles},u))},co=function(e,t){if(!t.cardContent.length)return null;try{if(1===t.cardContent.length){var n={styles:e,feedbackSectionPosition:oo.None,body:{cardContent:t.cardContent[0],renderHeader:function(){return le.a.createElement(Gr.a,{className:e.contentHeader},t.cardContent[0].contentHeader)}}};return le.a.createElement(pe,null,le.a.createElement(io,Object(o.__assign)({key:0},n)))}return le.a.createElement(pe,null,t.cardContent.map((function(t,n){return le.a.createElement(lo,{key:n,index:n,styles:e,cardContent:t})})))}catch(e){return null}},uo=function(e){var t=e.styles,n=e.body,r=Yr(),o=ao(r)(),i={role:M,"aria-live":"assertive",tabIndex:0};return le.a.createElement(pe,{style:Object(E.a)(o.accordionCardRoot,t.accordionCardRoot),customProperties:i},le.a.createElement(pe,{style:Object(E.a)(o.accordionCard,t.accordionCard),customProperties:{tabIndex:-1}},le.a.createElement(pe,null,le.a.createElement(Gr.a,{className:o.cardHeader},n.cardHeader),co(o,n))))},po=function(e){var t,n,r,o,i,a,s,l,c,u;return{buttonBarRoot:null!==(t=e.buttonBarRoot)&&void 0!==t?t:{},primaryButton:null!==(n=e.primaryButton)&&void 0!==n?n:{},defaultButton:null!==(r=e.defaultButton)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{},combinedButtonIcon:null!==(i=e.combinedButtonIcon)&&void 0!==i?i:{},iconButton:null!==(a=e.iconButton)&&void 0!==a?a:{},combinedButton:null!==(s=e.combinedButton)&&void 0!==s?s:{},minifiedButton:null!==(l=e.minifiedButton)&&void 0!==l?l:{},showMeButton:null!==(c=e.showMeButton)&&void 0!==c?c:{},showMeButtonBarRoot:null!==(u=e.showMebuttonBarRoot)&&void 0!==u?u:{}}};function go(e){var t=po(e);return Object(ue.a)(t)}var ho,fo,mo,vo,bo={combinedButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:"40px",minWidth:"40px"},De.a.padding("4px","8px")),on.a.caption1),{fontFamily:"-apple-system",lineHeight:"normal"})},yo=(go(bo),Object(S.a)(j)),Co=Object(o.__assign)(Object(o.__assign)({backgroundColor:yo.neutralLight},De.a.border("1px","solid",yo.neutralLighterAlt)),De.a.borderRadius(yo.borderRadiusMedium)),Oo=Object(o.__assign)({height:"16px",width:"16px"},De.a.padding(0)),So=Object(o.__assign)(Object(o.__assign)({height:"24px",minWidth:"20px"},De.a.padding("4px","8px")),on.a.caption1),Eo={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px"},showMeButtonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row"},primaryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",yo.themeSecondary)),De.a.borderRadius(yo.borderRadiusMedium)),{"@media (forced-colors: none)":{backgroundColor:yo.themeSecondary,"&:hover":Object(o.__assign)({backgroundColor:yo.themePrimary},De.a.border("1px","solid",yo.themePrimary)),"&:active":Object(o.__assign)({backgroundColor:yo.themePrimary},De.a.border("1px","solid",yo.themePrimary)),"&:disabled":Object(o.__assign)({backgroundColor:yo.neutralLighter},De.a.border("1px","solid",yo.neutralQuaternary)),"&:hover:active":Object(o.__assign)({backgroundColor:yo.themeTertiary},De.a.border("1px","solid",yo.themeTertiary))}}),defaultButton:Object(o.__assign)({},Co),showMeButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:yo.neutralLight},De.a.border("1px","solid",yo.neutralLighterAlt)),De.a.borderRadius(yo.borderRadiusMedium)),{"&:hover":{color:yo.themePrimary}}),icon:Object(o.__assign)(Object(o.__assign)({height:"24px",width:"24px"},De.a.padding(0)),(ho={},ho["&".concat(an.a.icon)]={height:"20px",width:"20px"},ho)),combinedButtonIcon:Object(o.__assign)(Object(o.__assign)({},Oo),(fo={},fo["&".concat(an.a.icon)]={height:"16px",width:"16px"},fo)),iconButton:Object(o.__assign)({height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},De.a.padding("2px")),combinedButton:Object(o.__assign)({},So),minifiedButton:(mo={height:"40px",width:"44px",minWidth:"44px"},mo["&".concat(an.a.icon)]={height:"24px",width:"24px"},mo)},xo=(Object(ue.a)(Eo),Object(ue.a)({emptyIcon:{height:"0px",width:"0px"}}),Object(ue.a)({authButton:Object(o.__assign)(Object(o.__assign)({},Co),So),appIcon:Object(o.__assign)({},Oo),title:Object(o.__assign)({},on.a.caption1)})),Io=function(e){var t,n,r,o,i,a,s,l;return{footerBar:null!==(t=e.footerBar)&&void 0!==t?t:{},headerBar:null!==(n=e.headerBar)&&void 0!==n?n:{},feedbackButton:null!==(r=e.feedbackButton)&&void 0!==r?r:{},feedbackButtonsStack:null!==(o=e.feedbackButtonsStack)&&void 0!==o?o:{},feedbackText:null!==(i=e.feedbackText)&&void 0!==i?i:{},feedbackTextMinified:null!==(a=e.feedbackTextMinified)&&void 0!==a?a:{},feedbackDisclaimerStack:null!==(s=e.feedbackDisclaimerStack)&&void 0!==s?s:{},tooltipText:null!==(l=e.tooltipText)&&void 0!==l?l:{}}};var wo,To,ko,jo,Po=Object(S.a)(j),Ao={feedbackTextMinified:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:Po.neutralSecondaryAlt,fontFamily:"-apple-system",lineHeight:"normal"}),feedbackButton:Object(o.__assign)(Object(o.__assign)({width:"44px",height:"44px",maxWidth:"unset",lineHeight:"normal",backgroundColor:"transparent"},De.a.border("0px")),(vo={},vo["&:hover .".concat(an.a.icon)]={cursor:"pointer",color:Po.themePrimary},vo)),tooltipText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:Po.neutralPrimary,fontFamily:"-apple-system",lineHeight:"normal"})},_o=function(){return Ao},Do=(wo=Io(Ao),Object(ue.a)(wo),Object(S.a)(j)),Lo={footerBar:Object(o.__assign)(Object(o.__assign)({},De.a.padding("4px","0px")),{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}),headerBar:Object(o.__assign)({},De.a.padding("0px","4px")),feedbackText:Object(o.__assign)(Object(o.__assign)({},on.a.caption2),{color:Do.neutralSecondaryAlt}),feedbackTextMinified:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:Do.neutralSecondaryAlt}),feedbackButtonsStack:Object(o.__assign)({alignItems:"center"},De.a.gap("2px")),feedbackButton:(To={backgroundColor:"transparent"},To["&:hover .".concat(an.a.icon)]={cursor:"pointer",color:Do.themePrimary},To),feedbackDisclaimerStack:Object(o.__assign)({alignItems:"center"},De.a.gap("2px")),tooltipText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:Do.neutralPrimary})},Mo=(Object(ue.a)(Lo),go({buttonBarRoot:{marginTop:"0px",width:"auto"},minifiedButton:Object(o.__assign)({},_o().feedbackButton),icon:{}})),Bo=function(e){var t,n,r,i,a,s,l,c;return Object(o.__assign)(Object(o.__assign)({defaultRoot:null!==(t=e.defaultRoot)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},human:null!==(r=e.human)&&void 0!==r?r:{},humanContent:null!==(i=e.humanContent)&&void 0!==i?i:{},chat:null!==(a=e.chat)&&void 0!==a?a:{},chatContent:null!==(s=e.chatContent)&&void 0!==s?s:{},chatCard:null!==(l=e.chatCard)&&void 0!==l?l:{},text:null!==(c=e.text)&&void 0!==c?c:{},strikeThroughText:{},cardHighContrast:{}},po(e)),Io(e))},Ro={chatCard:Object(o.__assign)({width:"inherit"},De.a.padding("16px")),text:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{fontFamily:"-apple-system",lineHeight:"normal"})},Fo=function(e){return Object(ue.a)(Bo(e))}(Ro),No=Object(S.a)(j),Ho=Object(o.__assign)(Object(o.__assign)({defaultRoot:Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),{alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"}),loader:Object(o.__assign)({boxSizing:"border-box",display:"flex",width:"inherit"},De.a.gap("4px")),human:{alignSelf:"flex-end",maxWidth:"80%"},humanContent:{color:No.black,backgroundColor:No.themeLight},chat:{width:"100%",alignSelf:"flex-start",boxShadow:No.shadow2},chatContent:{backgroundColor:No.neutralLight},chatCard:Object(o.__assign)({width:"inherit"},De.a.padding("12px")),text:Object(o.__assign)({},on.a.body1),strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:Object(o.__assign)({},De.a.border("1px","solid",No.neutralLighterAlt))},(ko=Eo,jo=bo,a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},ko),jo):Object(o.__assign)({},ko))),function(){var e=Lo,t=_o();return a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},e),t):Object(o.__assign)({},e)}()),Uo=function(){var e=Ho,t=Ro;return a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},e),t):Object(o.__assign)({},e)},Vo=Object(ue.a)(Ho),zo={colorBrandFlair1:No.themeDarkAlt,colorBrandFlair2:No.themeLighterAlt,colorBrandFlair3:No.themeLighter,colorBrandFlair1Transparent:No.themeDarkAltTransparent,colorBrandFlair2Transparent:No.themeLighterAltTransparent,colorBrandFlair3Transparent:No.themeLighterTransparent},Go=Object(S.a)(j),Wo=Object(o.__assign)({adaptiveCardRoot:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{color:Go.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":Object(o.__assign)({},De.a.border("1px","solid",Go.neutralQuaternaryAlt)),"& p":{display:"inline"},"& .ac-textBlock":{overflowWrap:"anywhere",display:"inline !important"},"& .ac-adaptiveCard":{display:"inline !important"}})},Uo()),Qo=Object(ue.a)(Wo);function qo(e){var t=e.renderData,n=e.fallbackElement,r=e.customMessageRenderers;if(!t||!r)return le.a.createElement(le.a.Fragment,null,n);var i=r.renderers[t.component];return i?le.a.createElement(i,Object(o.__assign)({},t.props)):r.renderFallback(t)}var Ko,Yo,Zo=n(224),Jo=n(2807),Xo=function(e){var t,n,r,o;if(!e)return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0};try{var i=e.messageExtensionPluginInfo.errorType,a=(null===(n=null===(t=e.oAuthCard)||void 0===t?void 0:t.buttons)||void 0===n?void 0:n.length)&&(null===(o=null===(r=e.oAuthCard)||void 0===r?void 0:r.buttons[0])||void 0===o?void 0:o.value),s=JSON.parse(e.messageExtensionPluginInfo.failedActivity),l=null==s?void 0:s.request;if(!l)throw new Error("Failed to parse pluginAuthError");return{requestType:i,authUrl:a,botInvokeRequest:{botId:l.msaAppId,appId:l.metaOsAppId,requestBody:{name:l.name,value:l.value}},appId:l.metaOsAppId}}catch(e){return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0}}},$o=n(3349),ei=n(3351),ti=n(3352),ni=function(e){var t=e.children,n=e.popoverTitle,r=e.popoverDuration,i=Object(o.__read)(Object(se.useState)(!1),2),a=i[0],s=i[1],l=Object(se.useRef)(void 0);return Object(se.useEffect)((function(){a&&(l.current&&clearTimeout(l.current),l.current=window.setTimeout((function(){s(!1),l.current=void 0}),null!=r?r:2e3)),a||void 0===l.current||(clearTimeout(l.current),l.current=void 0)}),[r,a]),le.a.createElement($o.a,{withArrow:!0,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:a,onOpenChange:function(e,t){var n;s(null!==(n=t.open)&&void 0!==n&&n)}},le.a.createElement(ei.a,null,t),le.a.createElement(ti.a,{"aria-live":"assertive"},n))};!function(e){e.Primary="Primary",e.Default="Default"}(Ko||(Ko={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(Yo||(Yo={}));var ri=function(e,t,n,r,o,i){var a=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},s=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};console.log(e.text);var l,c,u,d=e.text?t.combinedButton:t.minifiedButton;return le.a.createElement(me.a,{tabIndex:0,key:o,appearance:e.type==Ko.Primary?"primary":void 0,className:e.type==Ko.Primary?Object(E.a)(d,t.primaryButton):d,icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(l=e.iconRegular,c=e.iconHover,u=Object(Oe.a)(c,l),le.a.createElement(u,null)):le.a.createElement(e.iconRegular,null),className:t.icon}:void 0,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:a,onMouseLeave:s,onFocus:a,onBlur:s,disabled:e.isDisabled},null==e?void 0:e.text)},oi=function(e){var t=e.actionBarButtons,n=e.styles,r=e.messageContentElementId,i=e.chatCardIndex,a=e.telemetryData,s=void 0===a?"":a;return le.a.createElement(pe,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?le.a.createElement(ni,Object(o.__assign)({key:t},e.popoverProps),ri(e,n,r,i,t,s)):ri(e,n,r,i,t,s)})))},ii=n(3523),ai=function(e,t,n,r,o,i){var a,s,l,c=e.text?t.combinedButton:t.iconButton,u=e.type==Ko.Primary?t.primaryButton:t.defaultButton,d=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},p=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};return le.a.createElement(me.a,{tabIndex:0,key:o,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,appearance:e.type==Ko.Primary?"primary":void 0,className:Object(E.a)(c,u),icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(a=e.iconRegular,s=e.iconHover,l=Object(Oe.a)(s,a),le.a.createElement(l,null)):le.a.createElement(e.iconRegular,null),className:(null==e?void 0:e.text)?t.combinedButtonIcon:t.icon}:void 0,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:d,onMouseLeave:p,onFocus:d,onBlur:p,disabled:e.isDisabled},null==e?void 0:e.text)},si=function(e){var t=e.actionBarButtons,n=e.styles,r=e.messageContentElementId,i=e.chatCardIndex,a=e.telemetryData,s=void 0===a?"":a,c=e.pluginAuthButtonProps,u=h();return le.a.createElement(pe,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?le.a.createElement(ni,Object(o.__assign)({key:t},e.popoverProps),ai(e,n,r,i,t,s)):ai(e,n,r,i,t,s)})),c&&le.a.createElement(ii.a,Object(o.__assign)({},c,{customStyles:xo,theme:u===l.defaultBlack?"dark":"light"})))},li=function(e){return s()?le.a.createElement(oi,Object(o.__assign)({},e)):le.a.createElement(si,Object(o.__assign)({},e))},ci=n(3401),ui=n(2841),di=n(455),pi=function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}};function gi(e){var t=pi(e);return Object(ue.a)(t)}var hi=gi({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),fi=Object(S.a)(j),mi=gi({tooltipText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:fi.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},De.a.padding("12px")),De.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),vi=function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n])},bi=function(e){switch(void 0===e&&(e=di.c.NonEncryption),e){case di.c.Encryption:return s()?le.a.createElement(Pt.q,null):le.a.createElement(Pt.o,null);case di.c.Warning:return s()?le.a.createElement(ui.e,null):le.a.createElement(ui.c,null);case di.c.NonEncryption:default:return s()?le.a.createElement(Pt.m,null):le.a.createElement(Pt.k,null)}},yi=function(e,t){switch(void 0===e&&(e=di.c.NonEncryption),e){case di.c.Encryption:return s()?le.a.createElement(Pt.p,{primaryFill:t}):le.a.createElement(Pt.n,{primaryFill:t});case di.c.Warning:return s()?le.a.createElement(ui.d,{primaryFill:t}):le.a.createElement(ui.b,{primaryFill:t});case di.c.NonEncryption:default:return s()?le.a.createElement(Pt.l,{primaryFill:t}):le.a.createElement(Pt.j,{primaryFill:t})}},Ci=function(e){var t,n,o=e.styles,i=e.clpSensitivityIndicatorData,s=function(){var e=mi(),t=hi();a()===r.IOS&&vi(e,t);return e}();return vi(s,o),le.a.createElement($o.a,{openOnHover:!0},le.a.createElement(ei.a,null,le.a.createElement("span",{className:s.icon},i.icon?le.a.createElement(i.icon,null):(t=i.iconType,n=i.color,void 0===t&&(t=di.c.NonEncryption),n?yi(t,n):bi(t)))),le.a.createElement(ti.a,{className:s.tooltipStack},le.a.createElement(pe,null,i.badgeText&&le.a.createElement(Yn.a,{className:s.badgeText},i.badgeText),le.a.createElement(Yn.a,{className:s.tooltipText},i.tooltipText))))},Oi=function(e,t){var n=Object(Oe.a)(t,e);return le.a.createElement(n,null)},Si=function(e,t){return le.a.createElement(he.a,{content:le.a.createElement(st.a,{className:e.tooltipText},t?Y():K()),relationship:"description"},le.a.createElement(st.a,{className:e.feedbackTextMinified},t?H()?OfficeaicopilotStrings.AIPowered:"AI-powered suggestion":H()?OfficeaicopilotStrings.AIGenerated:"AI generated"))},Ei=function(e,t){return le.a.createElement(st.a,{className:e.feedbackText},t?Y():K())},xi=function(e){var t=e.styles,n=e.feedbackData,r=e.shouldShowAIGeneratedIndicator,i=void 0===r||r,a=e.shouldShowAIPoweredIndicator,l=e.displayPosition,c=e.shouldShowFeedbackButtons,u=void 0===c||c,d=e.handleThumbsUpClick,p=e.handleThumbsDownClick,g=e.showMinifiedUI,h=void 0!==g&&g,f=e.clpSensitivityIndicatorData,m=void 0===f?void 0:f,v=e.telemetryData,b=void 0===v?"":v,y=e.actionBarProps;t.headerBar=Object(E.a)(t.footerBar,t.headerBar);var C=s()?ci.d:ci.b,O=s()?ci.c:ci.a,S=s()?ci.h:ci.f,x=s()?ci.g:ci.e;return y.styles=G(y.styles,Mo()),le.a.createElement(pe,{horizontal:!0,reverse:!0,customProperties:{tabIndex:-1},style:l===oo.Header?t.headerBar:t.footerBar},le.a.createElement(Pe,null,le.a.createElement(pe,{horizontal:!0,style:t.feedbackButtonsStack},y&&le.a.createElement(li,Object(o.__assign)({},y)),u&&le.a.createElement(le.a.Fragment,null,le.a.createElement(me.a,{title:Ie(),"aria-label":Ie(),appearance:"transparent",size:"small",className:t.feedbackButton,icon:Oi(S,x),onClick:function(e){var t=e.target.closest("button");null==n?d(void 0,void 0,t):d(n,b,t)}}),le.a.createElement(me.a,{title:we(),className:t.feedbackButton,"aria-label":we(),appearance:"transparent",size:"small",icon:Oi(C,O),onClick:function(e){var t=e.target.closest("button");null==n?p(void 0,void 0,t):p(n,b,t)}})))),le.a.createElement(Pe,null,le.a.createElement(pe,{horizontal:!0,style:t.feedbackDisclaimerStack},m&&le.a.createElement(Ci,{styles:t,clpSensitivityIndicatorData:m}),i&&(h?Si(t,a):Ei(t,a)))))},Ii=n(246),wi=n(2845),Ti=n(2082);var ki=Object(o.__assign)({},T.a),ji=Object(o.__assign)({},k.a);function Pi(e){if(!e)return"";if(/<([A-Za-z][A-Za-z0-9]*)\b[^>]*>(.*?)<\/\1>/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}return e}var Ai=n(2804),_i=n(2084),Di=n(168),Li=n(2170),Mi=n(3398),Bi=n(3399),Ri=n(3612),Fi=Object(Ri.a)("ReferenceItem",Object(ue.a)({link:Object(o.__assign)(Object(o.__assign)({},De.a.textDecoration("none")),{cursor:"pointer",":hover":Object(o.__assign)({},De.a.textDecoration("none")),":active":Object(o.__assign)({},De.a.textDecoration("none"))}),flexHorizontal:{display:"flex",flexDirection:"row",alignItems:"center",boxSizing:"border-box",justifyContent:"flex-start"},content:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground3,maxWidth:"168px",width:"fit-content"},De.a.padding("2px","8px","2px","0px")),De.a.overflow("hidden")),De.a.borderRadius("4px")),leftContainer:Object(o.__assign)({width:"20px",justifyContent:"center"},De.a.overflow("hidden")),dividerStyle:{height:"100%",flexGrow:0},rightContainer:{paddingLeft:"6px"},citationIndexText:{color:Le.a.colorNeutralForeground2},text:Object(o.__assign)({color:Le.a.colorNeutralForeground2,fontSize:Le.a.fontSizeBase200,maxWidth:"115px",marginLeft:"4px"},De.a.overflow("hidden")),referenceIconContainer:{height:"16px"}})),Ni=n(115),Hi=function(e){var t,n=e.name,r=e.url,i=e.referenceIndex,a=e.onLinkClick,s=e.slots,l=e.ariaLabel,c=e.ariaDescription,u=e.onRender,d=Fi(),p=(t=s,{components:{referenceIcon:"div"},referenceIcon:Ni.a.optional(null==t?void 0:t.referenceIcon,{elementType:"div",renderByDefault:!0,defaultProps:{children:se.createElement(Cr.a,{fontSize:16})}})});Object(Di.a)(p);var g=Object(Li.a)(p),h=g.slots,f=g.slotProps;return se.useEffect((function(){null==u||u()}),[]),se.createElement(he.a,{content:n,relationship:"label",positioning:"above"},se.createElement("a",{"aria-label":l,"aria-describedby":c,className:Object(E.a)(d.link,d.flexHorizontal,d.content),href:r,onClick:a,onKeyDown:function(e){return function(e,t){("Enter"===e.key||" "===e.key)&&(null==t||t(e))}(e,a)},target:"_blank","data-testid":"reference-item-url",rel:"noreferrer"},se.createElement("div",{className:Object(E.a)(d.flexHorizontal,d.leftContainer)},se.createElement(Mi.a,{wrap:!1,truncate:!0,className:d.citationIndexText},i)),se.createElement(Bi.a,{vertical:!0,className:d.dividerStyle}),se.createElement("div",{className:Object(E.a)(d.flexHorizontal,d.rightContainer)},se.createElement("div",{className:d.referenceIconContainer},se.createElement(h.referenceIcon,Object(o.__assign)({},f.referenceIcon))),se.createElement(st.a,{wrap:!1,truncate:!0,className:d.text},n))))},Ui=n(577),Vi=n(1826),zi=n(2796),Gi=n(2802);var Wi,Qi=Object(Ri.a)("MsgExtCardReference",Object(ue.a)({root:{marginBottom:"5px",marginTop:"5px"},rootV2:{marginTop:"0px",marginBottom:"0px"},appIcon:Object(o.__assign)({width:"20px",height:"20px"},De.a.borderRadius(Le.a.borderRadiusMedium)),appIconV2:{verticalAlign:"text-top"},title:{fontWeight:600,fontSize:"14px"},metaData:{fontSize:"12px",color:Le.a.colorNeutralForeground1,colorbackground:Le.a.colorNeutralBackground1,fontWeight:400},citationLink:{textDecorationLine:"none"}})),qi=function(e,t){if(e&&t){var n=t.filter((function(e){return function(e){if(!e)return!1;var t=e.split("/")[0].split(".");if(t.length<=1)return!1;var n=t[t.length-1],r=t[t.length-2];return!n.includes("*")&&!r.includes("*")}(e)})),r=Object(o.__read)(Object(zi.a)(n,(function(e){return e.includes("/")})),2),i=r[0];if(function(e,t){var n,r;try{for(var i=Object(o.__values)(Object(Gi.a)(t,(function(e){return e.toLowerCase()}))),a=i.next();!a.done;a=i.next()){for(var s=a.value,l="",c=s.split("."),u=0;u<c.length;u++)l+=(u>0?"[.]":"")+c[u].replace("*","[^/^.]+");var d=new RegExp("^".concat(l,"((/|\\?).*)?$"),"i"),p=new RegExp("^https://".concat(l,"((/|\\?).*)?$"),"i");if(e.match(d)||e.match(p))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}(e,r[1])||function(e,t){return!!t.some((function(t){var n=t.replace(new RegExp("[*]","g"),"(.*)"),r=new RegExp(n);return e.match(r)}))}(e,i))return!0}return!1},Ki=function(e){var t=e.cardUrl,n=e.cardTitle,r=e.citationIndex,i=e.appName,a=e.appIcon,s=e.idxRenderOnBcb,l=e.validDomains,c=e.sourceName,u=Object(Ui.c)(),d=Qi(),p=Object(o.__read)(se.useState(!1),2),g=p[0],h=p[1],f=function(n){t&&g&&(e.onLinkClickHandler?e.onLinkClickHandler(t):window.open(t)),null==n||n.preventDefault()};se.useEffect((function(){(Object(_i.a)(c)||function(e){var t=new RegExp("https://nam.+.safelinks.protection.+/?url=.+");return!(!e||!e.match(t))}(t)||qi(t,l))&&h(!0)}),[t,c,l]);var m=g?se.createElement($t.a,{appearance:"subtle",href:t,onClick:t?f:void 0},se.createElement("div",{className:d.title,"data-testid":"msgext-reference-title"},n)):se.createElement("div",null,n),v=se.createElement("a",{href:t,className:d.citationLink,target:"_blank",rel:"noopener noreferrer"},r),b=se.createElement("span",{className:d.metaData,"data-testid":"msgext-reference-primary-text"},i),y=se.createElement("span",{className:d.metaData,"data-testid":"msgext-reference-secondary-text"},e.cardSubText);return se.createElement("div",{className:e.isReferencesV2?d.rootV2:d.root,"data-testid":"msgext-reference-container"},e.isReferencesV2?se.createElement(Hi,{name:n,url:g?t:void 0,referenceIndex:e.citationIndex,onLinkClick:t?f:void 0,slots:{referenceIcon:se.createElement(Vi.a,{size:16,className:d.appIconV2,image:{src:a}})}}):se.createElement(Ai.a,{media:se.createElement(Vi.a,{className:d.appIcon,"data-testid":"appIcon",image:{src:a}}),label:m,primaryText:b,secondaryText:y,referenceId:u,index:e.citationIndex,citation:s?v:void 0}))},Yi=function(e){var t,n,r={},i=e.cardDetails,a=e.citationIndex,s=e.tokenService,l=e.telemetryService,c=e.onLinkClickHandler,u=e.isReferencesV2,d=e.sourceName,p=Object(o.__read)(se.useState(i.appName),2),g=p[0],h=p[1],f=Object(o.__read)(se.useState(i.appIcon),2),m=f[0],v=f[1],b=Object(o.__read)(se.useState(void 0),2),y=b[0],C=b[1];se.useEffect((function(){!s||null!=g&&null!=m&&null!=y||function(e,t){var n,r,i,a,s,l,c;return Object(o.__awaiter)(this,void 0,void 0,(function(){var u,d,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),u=new Ti.a(t),d={id:e},[4,u.getApp(d)];case 1:return p=o.sent(),[2,{appName:null===(r=null===(n=p.titleInfo)||void 0===n?void 0:n.titleDefinition)||void 0===r?void 0:r.name,appIcon:null===(s=null===(a=null===(i=p.titleInfo)||void 0===i?void 0:i.titleDefinition)||void 0===a?void 0:a.iconLarge)||void 0===s?void 0:s.uri,validDomains:null===(c=null===(l=p.titleInfo)||void 0===l?void 0:l.titleDefinition)||void 0===c?void 0:c.validDomains}];case 2:return o.sent(),[2,{appName:void 0,appIcon:void 0,validDomains:void 0}];case 3:return[2]}}))}))}(i.appId,s).then((function(e){(null==e?void 0:e.appName)!==g&&h(null==e?void 0:e.appName),(null==e?void 0:e.appIcon)!==m&&v(null==e?void 0:e.appIcon),(null==e?void 0:e.validDomains)!==y&&C(null==e?void 0:e.validDomains)})).catch((function(e){null==l||l.LogException({type:Ii.e.LogException,name:Ii.k.MsgExtCardReference,tag:Ii.m.getAppDataException,success:Ii.j.Failure,props:r,diagnosticsData:"Error while getting the app data ".concat(e)})}))}),[i]);var O=se.useMemo((function(){return new wi.a(l,Ii.h.ReferenceContainer,Ii.g.MsgExtCardReferenceContainer)}),[]),S=se.useMemo((function(){return JSON.parse(i.content)}),[i.content]),E=se.useMemo((function(){return function(e){var t,n,r;return e?Pi(null!==(r=null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.title)&&void 0!==r?r:""):""}(S)}),[S]),x=se.useMemo((function(){return function(e){var t,n,r,o,i,a,s,l,c,u;return e?(null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.subtitle)?Pi(null!==(i=null===(o=null===(r=e.preview)||void 0===r?void 0:r.content)||void 0===o?void 0:o.subtitle)&&void 0!==i?i:""):(null===(s=null===(a=e.preview)||void 0===a?void 0:a.content)||void 0===s?void 0:s.text)?Pi(null!==(u=null===(c=null===(l=e.preview)||void 0===l?void 0:l.content)||void 0===c?void 0:c.text)&&void 0!==u?u:""):void 0:""}(S)}),[S]),I=se.useMemo((function(){return function(e){var t,n;return e?null===(n=null===(t=e.content)||void 0===t?void 0:t.metadata)||void 0===n?void 0:n.webUrl:""}(S)}),[S]),w=function(e){var t=void 0;return e&&(t="dark"===e?ji:ki),null!=t?t:ki}(null!==(t=e.theme)&&void 0!==t?t:"light");return se.useEffect((function(){var e={};e[Ii.l.citationIndex]=a,e[Ii.l.HasURL]=1,null!=I&&null!=I||(e[Ii.l.HasURL]=0),O.logMetricEnd({props:e,diagnosticsData:"TypeOfCard: ".concat(i.contentType,",  cardId : ").concat(i.cardId," }, isReferencesV2: ").concat(u)})}),[]),se.createElement(ae.a,{theme:w},se.createElement(Ki,{citationIndex:a,cardTitle:null!=E?E:"",appIcon:null!=m?m:"",appName:null!=g?g:"",cardSubText:x,cardUrl:I,onLinkClickHandler:c,idxRenderOnBcb:null!==(n=e.idxRenderOnBcb)&&void 0!==n&&n,isReferencesV2:u,validDomains:y,sourceName:d}))},Zi=n(2806),Ji=n(2799),Xi=n(724),$i=n(3397),ea=function(e){var t=e.referenceType,n=e.iconAppName,r=e.iconUrl,o=e.authorEmail,i=e.authorName;if(t===di.a.Internal){if(n===di.b.Word||n===di.b.OneNote)return le.a.createElement(Xi.a,null);if(n===di.b.PowerPoint)return le.a.createElement(yn.a,null)}else if(t===di.a.CrossApp){if(r)return le.a.createElement(Ae.a,{src:r,alt:null!=n?n:"",height:20,width:20});if(n)switch(n){case di.b.Word:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:n,height:20,width:20});case di.b.PowerPoint:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:n,height:20,width:20});case di.b.Excel:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:n,height:20,width:20});case di.b.OneNote:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg",alt:n,height:20,width:20});case di.b.Visio:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg",alt:n,height:20,width:20});case di.b.Loop:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg",alt:n,height:20,width:20});case di.b.Txt:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg",alt:n,height:20,width:20});case di.b.SharePoint:return le.a.createElement(Ae.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg",alt:n,height:20,width:20});case di.b.Event:case di.b.Meeting:return le.a.createElement(Se.c,null);case di.b.Pdf:return le.a.createElement(Xi.b,null);case di.b.Teams:case di.b.Outlook:return i||o?le.a.createElement(Vi.a,{size:20,name:i||o}):le.a.createElement($i.a,null);case di.b.Topic:return le.a.createElement(Ae.a,{src:"../assets/topic-icon.svg",alt:n,height:20,width:20})}}return le.a.createElement($i.a,null)},ta=function(e){return{index:e.referenceIndex,label:le.a.createElement($t.a,{appearance:"subtle",href:e.referenceProps.url,target:"_blank",onClick:function(){return na(e)}},e.referenceProps.title),primaryText:e.referenceProps.primarySubtitle,secondaryText:e.referenceProps.secondarySubtitle,excerpt:e.referenceProps.snippet,media:le.a.createElement(ea,{referenceType:e.referenceProps.referenceType,iconAppName:e.referenceProps.iconAppName,iconUrl:e.referenceProps.iconUrl,authorEmail:e.referenceProps.authorEmail,authorName:e.referenceProps.authorName}),sensitivityLabel:void 0!==e.referenceProps.sensitivityLabel?le.a.createElement("span",null,e.referenceProps.sensitivityLabel):void 0}},na=function(e,t){e.referenceProps.onClickCitationLink&&e.referenceProps.onClickCitationLink(e.referenceIndex,e.referenceProps.path,t)},ra=function(e){var t=e.references,n=e.msgExtCardReferences,r=void 0===n?[]:n,i=e.pluginServiceProvider,a=void 0===i?void 0:i,s=(e.telemetryData,e.styles,(t=oa(t)).length>1?H()?OfficeaicopilotStrings.CitationTitleReferences:"References":H()?OfficeaicopilotStrings.CitationTitleReference:"Reference"),l=le.a.createElement(Zi.a,null,t.map((function(e,t){return function(e){return void 0!==r.find((function(t){return t.index===e&&t.card}))}(t+1)?function(e,t,n){var r,i=n.find((function(t){return t.index===e&&t.card}));if(i){var a={cardId:i.card.cardId,content:i.content,contentType:O.b.AdaptiveCard,appId:i.card.appId,botId:i.card.botId};return le.a.createElement(Yi,Object(o.__assign)({key:e,citationIndex:e,cardDetails:a,tokenService:null===(r=null==t?void 0:t.cardServices)||void 0===r?void 0:r.tokenService,theme:i.config.themeMode},i))}return null}(e.referenceIndex,a,r):le.a.createElement(Ai.a,Object(o.__assign)({key:t},ta(e)))})));return l?le.a.createElement(pe,null,le.a.createElement(Ji.a,{label:"".concat(t.length," ")+s},l)):null},oa=function(e){var t,n,r=[],i=function(e){r.some((function(t){return t.referenceIndex===e.referenceIndex}))||r.push(e)};try{for(var a=Object(o.__values)(e),s=a.next();!s.done;s=a.next()){i(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},ia=function(e){var t,n,r,i=e.styles,a=e.body,l=e.feedbackData,c=e.shouldShowAIGeneratedIndicator,u=void 0===c||c,d=e.shouldShowAIPoweredIndicator,p=e.shouldShowFeedbackButtons,g=void 0===p||p,h=e.feedbackSectionPosition,m=void 0===h?oo.None:h,v=e.showAnimation,b=void 0===v||v,y=e.handleThumbsDownClick,C=e.handleThumbsUpClick,O=e.actionBarButtons,S=e.chatCardIndex,x=e.showMinifiedUI,I=void 0!==x&&x,w=e.strikeThroughText,T=void 0!==w&&w,k=e.references,j=void 0===k?[]:k,P=e.clpSensitivityIndicatorData,A=void 0===P?void 0:P,_=e.telemetryData,D=void 0===_?"":_,L=e.pluginAuthError,M=void 0===L?void 0:L,B=e.pluginServiceProvider,R=void 0===B?void 0:B,F=e.msgExtCardProps,N=void 0===F?void 0:F,H=e.msgExtCardContextProvider,U=void 0===H?void 0:H,V=null!==(t=a.user)&&void 0!==t?t:"chat",z="human"!==a.user&&b,G=Object(o.__read)(Object(se.useState)(z),2),W=G[0],Q=G[1],q=le.a.useMemo((function(){return Xo(M)}),[M]),K=q.requestType,Y=q.authUrl,Z=q.botInvokeRequest,J=q.appId;Object(se.useEffect)((function(){z&&Q(!0)}),[z]),Object(se.useEffect)((function(){W&&Q(!1)}),[W]);var X=f(),$=!!M&&K&&Z&&(null==R?void 0:R.activityProvider)&&(null===(n=null==R?void 0:R.cardServices)||void 0===n?void 0:n.appService),ee=((null==O?void 0:O.length)>0||$)&&"human"!==V,te=(m==oo.Header||m==oo.Footer&&s())&&"human"!==V,ne=!te&&m==oo.Footer&&"human"!==V,re=(null==N?void 0:N.attributions.length)>0&&U,oe=j.length>0,ie=Object(Ar.a)(),ae=null==O?void 0:O.filter((function(e){return e.position===Yo.FeedbackSection})),ce={actionBarButtons:null==O?void 0:O.filter((function(e){return e.position!==Yo.FeedbackSection})),styles:i,messageContentElementId:ie,chatCardIndex:S,telemetryData:D,pluginAuthButtonProps:$?{requestType:K,url:Y,appId:J,originalBotInvokeRequest:Z,activityProvider:null==R?void 0:R.activityProvider,appService:null===(r=null==R?void 0:R.cardServices)||void 0===r?void 0:r.appService}:void 0},ue={styles:i,feedbackData:l,shouldShowAIGeneratedIndicator:u,shouldShowAIPoweredIndicator:d,shouldShowFeedbackButtons:g,displayPosition:m,handleThumbsDownClick:y,handleThumbsUpClick:C,showMinifiedUI:!!s()||I,clpSensitivityIndicatorData:A,telemetryData:D,actionBarProps:{actionBarButtons:ae,styles:Object(o.__assign)({},i),messageContentElementId:ie,chatCardIndex:S,telemetryData:D}},de=function(e,t,n,r){var o={};return o.defaultRoot=Object(E.a)(e.defaultRoot,e[t]),n&&(o.defaultRoot=Object(E.a)(o.defaultRoot,e.cardHighContrast)),o.loader=e.loader,o.chatCard=Object(E.a)(e.chatCard,"human"===t?e.humanContent:e.chatContent),o.strikeThroughText=r?e.strikeThroughText:"",o}(i,V,X,T),pe=[];re&&(pe=U.getCardReferences(N.attributions));var ge=le.a.createElement(le.a.Fragment,null,te&&le.a.createElement(xi,Object(o.__assign)({},ue)),le.a.createElement("div",{id:"".concat(ie),className:de.strikeThroughText},a.element),ee&&le.a.createElement(li,Object(o.__assign)({},ce)),ne&&le.a.createElement(xi,Object(o.__assign)({},ue)),oe&&le.a.createElement(ra,{references:j,msgExtCardReferences:pe,pluginServiceProvider:R,styles:i,telemetryData:D}));return le.a.createElement(Zo.a,{className:de.defaultRoot,themeExtension:zo},"human"===V?le.a.createElement(Jo.a,{className:de.chatCard},ge):le.a.createElement(nn.a,{isLoading:W,"aria-live":"assertive",className:de.chatCard},ge))},aa=n(146),sa=function(e){var t=e.styles,n=e.onClickShowMeButton,r=e.onClickHelpButton,o=t.combinedButton,i=t.showMeButton;return le.a.createElement(pe,{style:t.showMeButtonBarRoot,customProperties:{tabIndex:-1}},le.a.createElement(me.a,{tabIndex:0,"aria-label":X(),className:Object(E.a)(o,i),onClick:n},X()),r&&le.a.createElement(me.a,{tabIndex:0,"aria-label":$,className:Object(E.a)(o,i),icon:le.a.createElement(aa.V,null),onClick:r},$))},la=n(2805),ca=function(e){var t=e.referenceIndex,n=e.referenceProps,r=e.telemetryData,i=void 0===r?"":r,a=le.a.createElement(Ai.a,Object(o.__assign)({layout:"popover"},ta({referenceIndex:t,referenceProps:n})));return le.a.createElement(la.a,{popover:a,onClick:function(){void 0!==n.url&&window.open(n.url,"_blank"),n.onClickCitationLink&&n.onClickCitationLink(t,n.path,i)},popoverSurface:{tabIndex:0,style:{overflowWrap:"anywhere"}}},t)},ua=function(e){var t,n,r,o,i,a,s=e.styles,l=e.richText,c=e.renderTextWithCitation,u=void 0===c?function(e){return null}:c,d=e.references,p=void 0===d?[]:d;l.linkText&&(null===(t=l.linkText.linkSuffix)||void 0===t?void 0:t.includes("%s"))&&(l.text+=l.linkText.linkSuffix.substring(0,l.linkText.linkSuffix.indexOf("%s")),l.linkText.linkSuffix=l.linkText.linkSuffix.substring(l.linkText.linkSuffix.indexOf("%s")+2));return le.a.createElement("span",null,le.a.createElement(st.a,{block:!0,className:Object(E.a)(s.text,s.richTextRoot)},l.text?Q(l.text,p)?u(l.text):l.text:"",l.linkText&&le.a.createElement($t.a,{target:l.linkText.linkUrl?"_blank":"",href:null!==(n=l.linkText.linkUrl)&&void 0!==n?n:"#",className:Object(E.a)(s.linkText,l.linkText.linkUrl?"":s.linkButton),onClick:function(){l.linkText.linkUrl||l.linkText.linkOnClick()}},l.linkText.text),(null===(r=l.linkText)||void 0===r?void 0:r.linkSuffix)?Q(null===(o=l.linkText)||void 0===o?void 0:o.linkSuffix,p)?u(null===(i=l.linkText)||void 0===i?void 0:i.linkSuffix):null===(a=l.linkText)||void 0===a?void 0:a.linkSuffix:""))},da=function(e){return Object(ue.a)(function(e){var t,n,r,i,a,s,l,c,u,d,p,g,h;return Object(o.__assign)({rootStack:null!==(t=e.rootStack)&&void 0!==t?t:{},messageHeader:null!==(n=e.messageHeader)&&void 0!==n?n:{},messageFooter:null!==(r=e.messageFooter)&&void 0!==r?r:{},listStackStyle:null!==(i=e.listStackStyle)&&void 0!==i?i:{},pillsItem:null!==(a=e.listStackStyle)&&void 0!==a?a:{},pillsContainer:null!==(s=e.listStackStyle)&&void 0!==s?s:{},list:null!==(l=e.list)&&void 0!==l?l:{},listHeader:null!==(c=e.listHeader)&&void 0!==c?c:{},listFooter:null!==(u=e.listFooter)&&void 0!==u?u:{},linkText:null!==(d=e.linkText)&&void 0!==d?d:{},linkButton:null!==(p=e.linkButton)&&void 0!==p?p:{},listItemTitle:null!==(g=e.listItemTitle)&&void 0!==g?g:{},richTextRoot:null!==(h=e.richTextRoot)&&void 0!==h?h:{}},Bo(e))}(e))}({linkText:{fontFamily:"-apple-system",lineHeight:"normal"}}),pa=Object(S.a)(j),ga=Object(o.__assign)({rootStack:Object(o.__assign)({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},De.a.gap("12px")),messageHeader:{},messageFooter:{},listStackStyle:Object(o.__assign)(Object(o.__assign)({},De.a.gap("4px")),De.a.gap("12px")),pillsContainer:{alignItems:"flex-start"},pillsItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)((Wi={backgroundColor:Le.a.colorNeutralBackground3,color:Le.a.colorNeutralForeground2},Wi["&:hover"]={backgroundColor:Le.a.colorNeutralBackground2Hover,color:Le.a.colorNeutralForeground1Hover},Wi.marginBottom="10px",Wi),De.a.border("transparent")),De.a.borderColor(Le.a.colorNeutralBackground3)),{display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px"}),De.a.borderRadius("4px")),De.a.gap("4px")),De.a.gap("12px")),list:Object(o.__assign)(Object(o.__assign)({},De.a.margin("0px")),De.a.gap("4px")),listHeader:{fontWeight:600},listFooter:{},linkText:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{color:pa.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:pa.themePrimary}}}),linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"}},Uo()),ha=Object(ue.a)(ga),fa=function(){var e=ha(),t=da();if(a()===r.IOS)G(e,t);return e},ma=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=void 0!==r&&r,a=e.references,s=void 0===a?[]:a,l=e.pillsList,c=void 0===l?[]:l,u=e.handlePillOnClick,d=void 0===u?null:u,p=e.handleShowMeOnClick,g=void 0===p?null:p,h=e.telemetryData,f=void 0===h?"":h,m=Object(E.a)(t.text,t.rootStack);i&&(m=Object(E.a)(t.text,t.strikeThroughText,t.rootStack));var v=fa(),b={styles:t,onClickShowMeButton:g,onClickHelpButton:null},y=function(e){var t=function(e,t){for(var n=[],r=e.search("%c"),o=function(){var o=e.slice(r+2).search("%c");if(-1===o)return"break";o+=r+2;var i=parseInt(e.slice(r+2,o));n.push({message:e.slice(0,r),references:[t.find((function(e){return e.referenceIndex===i}))]}),e=e.slice(o+2),r=e.search("%c")};-1!==r&&"break"!==o(););return n}(e,s);return t.map((function(e,t){return le.a.createElement("span",{key:t},e.message,e.references&&e.references.map((function(e,t){return le.a.createElement(ca,Object(o.__assign)({},e,{key:t,telemetryData:f}))})))}))};return le.a.createElement(pe,{style:m},n.messageHeader&&(n.messageHeader.text||n.messageHeader.linkText)&&le.a.createElement(pe,{style:t.messageHeader},le.a.createElement(ua,{styles:t,richText:n.messageHeader,references:s,renderTextWithCitation:y})),n.embeddedLists&&n.embeddedLists.map((function(e,n){return le.a.createElement(pe,{key:n,style:t.listStackStyle},e.listHeader&&le.a.createElement(st.a,{className:Object(E.a)(t.text,t.listHeader)},Q(e.listHeader,s)?y(e.listHeader):e.listHeader),e.listItems&&e.listItems.length>0&&le.a.createElement("ul",{className:t.list},e.listItems.map((function(e,n){return le.a.createElement(st.a,{block:!0,key:n,className:t.text},le.a.createElement("li",null,e.title&&le.a.createElement("span",{className:t.listItemTitle},Q(e.title,s)?y(e.title):e.title),Q(e.text,s)?y(e.text):e.text))}))),e.listFooter&&(e.listFooter.text||e.listFooter.linkText)&&le.a.createElement(pe,{style:t.listFooter},le.a.createElement(ua,{styles:t,richText:e.listFooter,references:s,renderTextWithCitation:y})))})),n.messageFooter&&(n.messageFooter.text||n.messageFooter.linkText)&&le.a.createElement(pe,{style:t.messageFooter},le.a.createElement(ua,{styles:t,richText:n.messageFooter,references:s,renderTextWithCitation:y})),g&&le.a.createElement(sa,Object(o.__assign)({},b)),c&&c.length>0&&le.a.createElement(pe,{style:v.pillsContainer},c.map((function(e,t){return le.a.createElement(me.a,{key:t,className:v.pillsItem,onClick:function(){d&&d(e)}},e.data)}))))},va=function(e){var t,n,r=e.body,o=e.styles,i=null!==(t=r.cardHeader)&&void 0!==t?t:Z(),a=null!==(n=r.cardContent)&&void 0!==n?n:H()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContent:"Please help us learn and train our models by providing feedback through the thumbs up & down controls for each output the LLM generates.",s=r.imageSrc;return le.a.createElement(pe,{style:o.feedbackNudgeRootStack},le.a.createElement(pe,{style:o.msInternalContainer},le.a.createElement(st.a,{title:J(),className:o.msInternalHeader},J())),le.a.createElement(Ae.a,{src:s,className:o.cardIllustration}),le.a.createElement(st.a,{title:Z(),className:o.feedbackCardHeader},i),le.a.createElement(st.a,{title:H()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContentTitle:"Feedback Nudge Content",className:Object(E.a)(o.text,o.feedbackCardContent)},a))},ba=function(e){var t,n,r,i,a;return Object(o.__assign)({feedbackNudgeRootStack:{},msInternalContainer:null!==(t=e.msInternalContainer)&&void 0!==t?t:{},msInternalHeader:null!==(n=e.msInternalHeader)&&void 0!==n?n:{},feedbackCardHeader:null!==(r=e.feedbackCardHeader)&&void 0!==r?r:{},feedbackCardContent:null!==(i=e.feedbackCardContent)&&void 0!==i?i:{},cardIllustration:null!==(a=e.cardIllustration)&&void 0!==a?a:{}},Bo(e))};var ya=function(e){var t=ba(e);return Object(ue.a)(t)}(Object(o.__assign)({msInternalHeader:{lineHeight:"normal"},feedbackCardHeader:{lineHeight:"14px"},feedbackCardContent:{lineHeight:"14px"}},Uo())),Ca=Object(S.a)(j),Oa=Object(o.__assign)({feedbackNudgeRootStack:Object(o.__assign)({alignItems:"center"},De.a.gap("4px")),msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:"16px"},De.a.borderRadius(Ca.borderRadiusXLarge)),{backgroundColor:Ca.neutralTertiary}),De.a.padding("0px","12px")),on.a.caption2Strong),{display:"flex",justifyContent:"center",alignItems:"center"}),feedbackCardHeader:Object(o.__assign)(Object(o.__assign)({marginTop:"12px",width:"100%",textAlign:"center"},on.a.subtitle2),{color:Ca.themePrimary}),feedbackCardContent:{marginTop:"12px"},cardIllustration:{}},Uo()),Sa=Object(ue.a)(Oa),Ea=n(3589),xa=n(2164),Ia=n(465),wa=n(3508),Ta=Object(Ri.b)({MsgExtCardPreview:Object(ue.a)({root:{maxWidth:"min(".concat(600,"px, 100%)"),minWidth:"min(".concat(0,"px, 100%)")}})}),ka=Object(se.memo)((function(e){var t=e.card,n=e.context,r=e.config,o=le.a.useMemo((function(){return{appId:t.appId,cardId:t.cardId,botId:t.botId,content:JSON.stringify(t.content),contentType:U(t.contentType)}}),[t]);return le.a.createElement("div",null,le.a.createElement(Ta,null,le.a.createElement(wa.a,{cardDetails:o,serviceProvider:n,config:r})))}),(function(e,t){return e.card.cardId===t.card.cardId&&e.config.themeMode===t.config.themeMode})),ja=Object(Ri.a)("MsgExtCitationControl",Object(ue.a)({container:Object(o.__assign)({display:"inline-block",paddingBottom:"0px"},De.a.borderRadius("12px")),citationMountNode:{zIndex:999},popoverSurface:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.overflow("0px","0px")),De.a.padding("0px")),De.a.borderRadius("12px")),De.a.borderStyle("none")),{width:"min(".concat(450,"px, 100%)"),"& > div":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("12px")),De.a.borderWidth("0px")),De.a.borderStyle("none")),"&::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralForeground4},De.a.border("0px")),De.a.borderRadius(Le.a.borderRadiusMedium)),"&::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({width:Le.a.spacingHorizontalS},De.a.border("0px")),De.a.borderRadius(Le.a.borderRadiusMedium)),"&::-webkit-scrollbar-track":Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},De.a.border("0px")),De.a.borderRadius(Le.a.borderRadiusMedium)),"&::-webkit-scrollbar-corner":Object(o.__assign)(Object(o.__assign)({backGroundColor:Le.a.colorNeutralBackground5},De.a.border("0px")),De.a.borderRadius(Le.a.borderRadiusMedium))}),citationV2:Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground3,color:Le.a.colorNeutralForeground2},De.a.border("1px","solid",Le.a.colorNeutralStroke1))}));function Pa(e){var t,n,r,i,a=ja(),s=e.citation,l=e.cardDetails,c=e.serviceProvider,u=e.config,d=e.postActionExecute,p=e.isReferencesV2,g=e.viewModel,h=se.useMemo((function(){return new wi.a(null==c?void 0:c.telemetryService,Ii.h.CitationControl,Ii.g.MsgExtCitationControl)}),[]),f=se.useMemo((function(){return se.createElement(wa.a,{cardDetails:l,serviceProvider:c,config:u,postActionExecute:d})}),[c,l]);se.useEffect((function(){h.logMetricEnd({props:{},diagnosticsData:"TypeOfCard: ".concat(l.contentType,",  cardId : ").concat(l.cardId," }")},l.cardId)}),[]);var m=[g&&!(null===(t=g.item)||void 0===t?void 0:t.cardDetails)?se.createElement(st.a,null,null===(n=g.item)||void 0===n?void 0:n.title):se.createElement(ei.a,{disableButtonEnhancement:!0},g&&(null===(r=g.item)||void 0===r?void 0:r.cardDetails)?se.createElement($t.a,null,null===(i=g.item)||void 0===i?void 0:i.title):se.createElement(la.a,{className:p?a.citationV2:void 0,"data-testid":"msgext-citation-pill"},s)),se.createElement("div",{"data-testid":"msgext-citation-popover"},se.createElement(ti.a,{className:a.popoverSurface},f))],v=Object(o.__read)(se.useState(0),2),b=v[0],y=v[1],C=window.innerHeight;return se.createElement("div",{className:a.container,ref:function(e){e&&y(e.getBoundingClientRect().top)}},se.createElement($o.a,{openOnHover:!0,closeOnScroll:!0,positioning:{align:"center",position:b>C/2?"above":"below",autoSize:!0},trapFocus:!0,mountNode:{className:a.citationMountNode}},m))}var Aa,_a=function(e){var t=e.citation,n=e.card,r=e.context,o=e.config,i=le.a.useMemo((function(){return{appId:n.appId,cardId:n.cardId,botId:n.botId,content:JSON.stringify(n.content),contentType:U(n.contentType)}}),[n]);return le.a.createElement(Pa,{citation:t,cardDetails:i,serviceProvider:r,config:o})},Da=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=e.msgExtCardProps,u=void 0===c?void 0:c,d=e.msgExtCardContextProvider,p=void 0===d?void 0:d,g=e.pluginAuthError,h=void 0===g?void 0:g,f=[],m=p?p.getCardServiceProps():void 0;(null==u?void 0:u.attributions.length)>0&&p&&(f=p.getCardReferences(u.attributions));var v=le.a.useMemo((function(){return Xo(h)}),[h]),b=v.requestType,y=v.appId,C=t.markdownRoot;r&&(C=Object(E.a)(t.markdownRoot,t.strikeThroughText));var O={a:function(e){e.node;return function(e,t){var n=e.children[0],r=Number(n),i=Number.isInteger(r)&&r>0;if(f.length,i){var s=f.find((function(e){return e.index===r&&e.card}));if(s)return le.a.createElement(_a,Object(o.__assign)({citation:r},s,{context:null==s?void 0:s.context}));var c=a.length?a.find((function(e){return e.referenceIndex===r})):void 0;return a.length&&c?le.a.createElement(ca,Object(o.__assign)({},a.find((function(e){return e.referenceIndex===r})),{telemetryData:l})):le.a.createElement("span",null,"[",e.children,"](",e.href,")")}return t?le.a.createElement("a",Object(o.__assign)({},e,{rel:"noreferrer"}),e.children):le.a.createElement("span",null,"[",e.children,"](",e.href,")")}(Object(o.__rest)(e,["node"]),n.disableLinksProcessing)}};n.horizontalTableScroll&&(O.table=function(e){e.node;var n=Object(o.__rest)(e,["node"]);return le.a.createElement("div",{className:t.markdownHorizontalTableContainer},le.a.createElement("table",{className:t.markdownHorizontalTable},n.children))});var S=y&&m&&m.appService&&le.a.createElement(Ea.a,{requestType:b,appId:y,appService:m.appService});return le.a.createElement(pe,{style:C},le.a.createElement(xa.a,{linkTarget:"_blank",disallowedElements:["img"],unwrapDisallowed:!0,remarkPlugins:[Ia.a],components:Object(o.__assign)(Object(o.__assign)({},O),n.componentsOverride)},0===a.length||a[0].isFlux?n.message:function(e,t){t.sort((function(e,t){return e.referenceIndex-t.referenceIndex}));var n=0;return t.forEach((function(t){var r=t.referenceProps.citationPosition+n,o="["+t.referenceIndex.toString()+"]()";e=e.substring(0,r)+o+e.substring(r),n+=o.length})),e}(n.message,a)),S,function(){if(1===f.length){var e=f[0];return le.a.createElement(ka,Object(o.__assign)({},e,{context:e.context,config:e.config}))}return null}())},La=function(e){var t,n,r,i,a=Object(o.__assign)({markdownRoot:null!==(t=e.markdownRoot)&&void 0!==t?t:{},markdownElement:null!==(n=e.markdownElement)&&void 0!==n?n:{},markdownHorizontalTableContainer:null!==(r=e.markdownHorizontalTableContainer)&&void 0!==r?r:{},markdownHorizontalTable:null!==(i=e.markdownHorizontalTable)&&void 0!==i?i:{}},Bo(e));return Object(ue.a)(a)}({markdownRoot:{lineHeight:"inherit"}}),Ma=Object(S.a)(j),Ba=Object(o.__assign)({markdownRoot:Object(o.__assign)(Object(o.__assign)({},on.a.body1),{color:Ma.black,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",Ma.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(o.__assign)({backgroundColor:Ma.colorNeutralBackground1Hover},De.a.padding("1px","5px")),"& td":Object(o.__assign)(Object(o.__assign)({},De.a.borderBottom("1px","solid",Ma.colorNeutralBackground3Pressed)),De.a.padding("1px","5px")),"& p":Object(o.__assign)(Object(o.__assign)({},De.a.margin("0px")),{display:"inline"})}),markdownElement:{marginBottom:"10px"},markdownHorizontalTableContainer:{width:"100%",overflowX:"auto","::-webkit-scrollbar":Object(o.__assign)({height:"7px",backgroundColor:"transparent"},De.a.borderRadius(Ma.borderRadiusLarge)),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Ma.colorScrollbarOverlay},De.a.borderRadius(Ma.borderRadiusLarge)),De.a.border("1px","solid",Ma.colorNeutralBackground1)),{":hover":{backgroundColor:Ma.colorNeutralForeground3}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:"transparent"},De.a.borderRadius(Ma.borderRadiusLarge))},markdownHorizontalTable:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"100%",whiteSpace:"nowrap"},De.a.overflow("hidden")),De.a.borderRadius(Ma.borderRadiusMedium)),on.a.caption1),{"& th":Object(o.__assign)({},on.a.caption1Strong)})},Uo()),Ra=Object(ue.a)(Ba),Fa=n(3402),Na=function(e){var t=e.styles,n=e.handleApplyOnClick,r=e.handleApplyAllOnClick,i=Object(o.__read)(Object(se.useState)(!1),2),a=i[0],s=i[1],l=Object(o.__read)(Object(se.useState)(!1),2),c=l[0],u=l[1],d=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,r()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?le.a.createElement(he.a,{content:"Waiting to apply updates",relationship:"label"},le.a.createElement(me.a,{className:Object(E.a)(t.spinnerButton,t.combinedButton),onClick:d,disabled:!0,icon:le.a.createElement(yn.e,{className:t.spinnerIcon})})):le.a.createElement(ge.a,{positioning:"below-end"},le.a.createElement(fe.a,{disableButtonEnhancement:!0},(function(e){return le.a.createElement(he.a,{content:"Apply Updates",relationship:"label"},le.a.createElement(Fa.a,{menuButton:e,primaryActionButton:{onClick:d},size:"small",className:t.applyButton},c?"Apply All":"Apply"))})),le.a.createElement(be.a,null,le.a.createElement(ye.a,null,le.a.createElement(Ce.a,{onClick:function(){u((function(e){return!e}))}},c?"Apply":"Apply All"))))},Ha=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(Object(se.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.textIndices),!1)),2),l=s[0],c=s[1],u=Object(o.__read)(Object(se.useState)(!1),2),d=u[0],p=u[1];Object(se.useEffect)((function(){i>=l.length&&a(l.length-1)}),[l]);var g=function(){return a((function(e){return e-1}))},h=function(){return a((function(e){return e+1}))},f=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return p(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),p(!1),[2]}}))}))},m=function(){c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t.splice(i,1),t}))},v={styles:t,handleApplyOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return le.a.createElement(pe,{style:t.stack,customProperties:{tabIndex:-1}},l.length?le.a.createElement(le.a.Fragment,null,"Applying updates to following matches",le.a.createElement("div",{className:t.contentBox},le.a.createElement("div",{className:t.contentBoxButtonGroup},le.a.createElement("div",{className:d?t.disabledContentBoxIcon:t.contentBoxIcon},d?le.a.createElement(yn.f,{className:t.spinnerIcon}):le.a.createElement(he.a,{content:"Locate",relationship:"label"},le.a.createElement(Pt.b,{onClick:f}))),d?le.a.createElement(le.a.Fragment,null):le.a.createElement("div",{className:Object(E.a)(t.contentBoxIcon,t.dismissIcon)},le.a.createElement(he.a,{content:"Remove",relationship:"label"},le.a.createElement(ct.h,{onClick:m})))),le.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.extractTextToDisplay(l[i]))),le.a.createElement("div",{className:t.footer},le.a.createElement("div",null,le.a.createElement(Na,Object(o.__assign)({},v))),le.a.createElement("div",{className:t.pagination},le.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),le.a.createElement("div",null,le.a.createElement(le.a.Fragment,null,le.a.createElement(he.a,{content:"Previous",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(ci.i,null),onClick:g,disabled:0==i,className:t.paginationButton})),le.a.createElement(he.a,{content:"Next",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(ci.j,null),onClick:h,disabled:i+1>=l.length,className:t.paginationButton}))))))):le.a.createElement(le.a.Fragment,null,"No results found for the search"))},Ua=Object(S.a)(j),Va=Object(o.__assign)({stack:Object(o.__assign)({textAlign:"start",textOverflow:"clip"},De.a.gap("12px")),contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Ua.neutralLight,minHeight:"50px",position:"relative"},De.a.padding("12px")),De.a.border("1px","solid",Ua.neutralLighterAlt)),De.a.borderRadius(Ua.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},De.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},De.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ua.neutralLight,height:"24px"},De.a.border("none")),{"&:hover":{color:Ua.themePrimary}}),spinnerButton:{backgroundColor:Ua.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Ua.themePrimary}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:Ua.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},De.a.border("1px","solid",Ua.neutralLighterAlt)),De.a.borderRadius(Ua.borderRadiusMedium)),on.a.caption1),De.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Ua.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Ua.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Ua.themePrimary},contentBoxText:{marginBottom:"20px"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Uo()),za=Object(ue.a)(Va),Ga=n(3393),Wa=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(le.a.useState(!1),2),i=r[0],a=r[1];return le.a.createElement(pe,{style:t.rootStack},le.a.createElement("div",{className:t.container,onMouseOver:function(){n.handleMouseOver()},onMouseLeave:function(){n.handleMouseLeave()},onFocus:function(){n.handleMouseLeave()}},le.a.createElement("div",null,le.a.createElement(st.a,{className:t.title},H()?OfficeaicopilotStrings.ProactiveSuggestionTitleText:"Highlight Data"),le.a.createElement(Ga.a,{className:t.badge,size:"large",appearance:"outline",color:"subtle",icon:le.a.createElement(yn.b,null)},H()?OfficeaicopilotStrings.ProactiveSuggestionIconText:"Idea")),le.a.createElement(st.a,{className:t.body},H()?OfficeaicopilotStrings.ProactiveSuggestionBodyText:"For a more engaging presentation, here’s a design that might better highlight the stats in your slide."),le.a.createElement(Ae.a,{className:t.image,bordered:!0,shadow:!0,shape:"rounded",alt:H()?OfficeaicopilotStrings.ProactiveSuggestionImageAltText:"proactive suggestion card img",src:n.imageSrc}),le.a.createElement(me.a,{disabled:i,className:t.applyButton,onClick:function(){a(!0),n.handleApplyClicked()},icon:le.a.createElement(At.c,null)},H()?OfficeaicopilotStrings.ProactiveSuggestionApplyBtnText:"Apply")))},Qa=Object(S.a)(j),qa=Object(o.__assign)({rootStack:Object(o.__assign)({},De.a.gap("4px")),container:{display:"flex",flexDirection:"column"},title:{fontWeight:"600"},badge:Object(o.__assign)({float:"right"},De.a.borderColor(Qa.themeMedium)),body:{marginTop:"15px"},image:{marginTop:"15px"},applyButton:{marginTop:"15px",width:"104px"}},Uo()),Ka=Object(ue.a)(qa);!function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(Aa||(Aa={}));var Ya,Za=n(3438),Ja=n(3439),Xa=n(3408),$a=n(3395),es=function(e){var t=e.styles,n=(e.label,e.icon,e.text),r=e.disabled,i=e.onSubmit,a=Object(o.__read)(le.a.useState(!1),2),s=a[0],l=a[1];return le.a.createElement("div",{className:t.buttonStyle},le.a.createElement(Xa.a,{label:"Confirm that the file is shared with all reviewers",onChange:function(e){l(e.target.checked)},disabled:r,style:{marginLeft:"-8px"}}),le.a.createElement(me.a,{appearance:"primary",icon:r?le.a.createElement(rn.f,null):le.a.createElement(Pt.d,null),onClick:i,disabled:!s||r,size:"small",className:t.buttonItemsStyle},le.a.createElement($a.a,null,s&&r?"Invitation Sent":n)))},ts=(Object(S.a)(A),Object(o.__assign)({buttonTextStyle:{},buttonStyle:{display:"flex",flexDirection:"column"},buttonItemsStyle:{width:"fit-content"}},Uo())),ns=Object(ue.a)(ts),rs=n(3603),os=n(3433),is=n(3434),as=function(e){e.styles;var t=e.label,n=e.selectedDate,r=e.disabled,o=e.onDateChange;return le.a.createElement(os.a,{label:le.a.createElement(is.a,null,t," ")},le.a.createElement(rs.a,{showMonthPickerAsOverlay:!0,showGoToToday:!1,value:n,onSelectDate:function(e){o&&o(e)},disabled:r}))},ss=Object(S.a)(A),ls=Object(o.__assign)({datePickerLabelStyle:{},datePickerInputStyle:Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",ss.colorNeutralStroke1)),De.a.borderRadius("4px")),datePickerIconStyle:{}},Uo()),cs=Object(ue.a)(ls),us=n(3437),ds=n(3405),ps=function(e){var t=e.styles,n=e.label,r=e.selectedValue,i=e.options,a=e.disabled,s=e.onItemSelected,l=Object(o.__read)(le.a.useState(r),2),c=l[0],u=l[1],d=Object(o.__read)(le.a.useState(i),2),p=d[0];d[1];return le.a.createElement(pe,null,le.a.createElement(os.a,{label:le.a.createElement(is.a,null,n)},le.a.createElement(us.a,{onOptionSelect:function(e,t){return n=t.optionText,console.log(n),u(n),void(s&&s(n));var n},className:t.dropDownInputStyle,value:c,disabled:a},p.map((function(e){return le.a.createElement(ds.a,{key:e},e)})))))},gs=Object(S.a)(A),hs=Object(o.__assign)({dropDownLabelStyle:{},dropDownInputStyle:Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",gs.colorNeutralStroke1)),De.a.borderRadius("4px")),dropDownFlyoutStyle:{}},Uo()),fs=Object(ue.a)(hs),ms=n(3435),vs=n(3436),bs=function(e){var t=e.styles,n=e.label,r=e.suggestions,o=e.inputComponent,i=(e.onPeopleAdded,e.disabled),a=e.onPeopleRemoved;return le.a.createElement(pe,null,le.a.createElement(os.a,{label:le.a.createElement(is.a,null,n)},le.a.createElement(pe,{style:t.peoplePickerInputStyle},r&&r.length>0&&le.a.createElement(Pe,{style:t.peoplePickerInputContainerStyle},le.a.createElement(ms.a,{onDismiss:function(e,t){var n=t.value;a&&a({mail:n,displayName:n})},className:t.peoplePickerTagGroupStyle},r.map((function(e,t){return le.a.createElement(vs.a,{shape:"circular",media:le.a.createElement(Vi.a,{name:e.displayName,shape:"circular"}),dismissible:!0,dismissIcon:{"aria-label":"remove"},key:t,size:"extra-small",value:e.mail,disabled:i},e.displayName)})))),!i&&le.a.createElement(Pe,{style:t.peoplePickerInputContainerStyle},o))))},ys=Object(S.a)(A),Cs=Object(o.__assign)({peoplePickerLabelStyle:{},peoplePickerInputStyle:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("4px")),De.a.border("1px","solid",ys.colorNeutralStroke1)),{display:"flex"}),peoplePickerInputContainerStyle:Object(o.__assign)({},De.a.margin("2px","8px","2px","8px")),peoplePickerTagGroupStyle:{flexWrap:"wrap",rowGap:"8px"}},Uo()),Os=Object(ue.a)(Cs);!function(e){e.PEOPLE_PICKER="PEOPLE_PICKER",e.TEXT_AREA="TEXT_AREA",e.DATE_PICKER="DATE_PICKER",e.DROP_DOWN="DROP_DOWN",e.SUBMIT="SUBMIT"}(Ya||(Ya={}));var Ss=n(3425),Es=function(e){e.styles;var t=e.label,n=e.message,r=e.disabled,i=e.onMessageChange,a=Object(o.__read)(le.a.useState(n),2),s=a[0],l=a[1];return le.a.createElement(pe,null,le.a.createElement(os.a,{label:le.a.createElement(is.a,null,t)},le.a.createElement(Ss.a,{value:s,onChange:function(e,t){i&&i(t.value),l(t.value)},disabled:r,rows:4},le.a.createElement(Yn.a,null,s))))},xs=Object(S.a)(A),Is=Object(o.__assign)({textAreaLabelStyle:{},textAreaInputStyle:Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("4px")),De.a.border("1px","solid",xs.colorNeutralStroke1))},Uo()),ws=Object(ue.a)(Is),Ts=Object(S.a)(A),ks=Object(o.__assign)({elementStyles:Object(o.__assign)({display:"flex",flexDirection:"column"},De.a.gap("16px")),footerAIGeneratedStyles:{color:Ts.neutralSecondaryAlt}},Uo()),js=Object(ue.a)(ks),Ps=function(e){var t,n,r=e.styles,i=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,a=null!==(t=i.isCardSubmitted)&&void 0!==t&&t,s=js(),l=Os(),c=ws(),u=fs(),d=cs(),p=ns();return le.a.createElement(pe,{style:s.elementStyles},le.a.createElement(Za.a,null,null!==(n=i.headerText)&&void 0!==n?n:te),i.individualComponentProps.map((function(e,t){return le.a.createElement(Pe,{key:t},function(e,t){if(!e)return null;var n,r,i=null;switch(e.InvitationComponentType){case Ya.PEOPLE_PICKER:n=e.componentProps,r=G(l,t),i=bs;break;case Ya.TEXT_AREA:n=e.componentProps,r=G(c,t),i=Es;break;case Ya.DROP_DOWN:n=e.componentProps,r=G(u,t),i=ps;break;case Ya.DATE_PICKER:n=e.componentProps,r=G(d,t),i=as;break;case Ya.SUBMIT:n=e.componentProps,r=G(p,t),i=es;break;default:return null}return le.a.createElement(i,Object(o.__assign)({},n,{styles:r,disabled:a}))}(e,r))})),le.a.createElement(Ja.a,{className:s.footerAIGeneratedStyles},K()))},As=n(3432),_s=function(){return le.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},le.a.createElement("rect",{width:"20",height:"20",rx:"10",fill:"url(#pattern0)"}),le.a.createElement("defs",null,le.a.createElement("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},le.a.createElement("use",{xlinkHref:"#image0_6409_5011",transform:"scale(0.0033557)"})),le.a.createElement("image",{id:"image0_6409_5011",width:"298",height:"298",xlinkHref:"data:image/png;base64,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"})))},Ds=function(e){var t,n,r,o,i,a,s=e.styles,l=(null!==(t=e.body.reviewAgentIndividualCardProps)&&void 0!==t?t:{reviewAgentCardType:Aa.EntryPointCard,reviewAgentInternalCardProps:{}}).reviewAgentInternalCardProps;return le.a.createElement(pe,{style:s.reviewAgentEntryCardStyle},le.a.createElement(Yn.a,null,null!==(n=l.headerText)&&void 0!==n?n:"Sure, I suggest continuing with ReviewSync agent:"),le.a.createElement(Pe,null,le.a.createElement(pe,{horizontal:!0,style:s.reviewAgentEntryCardElementStyle},le.a.createElement(Pe,null,null!==(r=l.reviewAgentIcon)&&void 0!==r?r:le.a.createElement(_s,null)),le.a.createElement(As.a,null,null!==(o=l.reviewSyncText)&&void 0!==o?o:"ReviewSync"))),le.a.createElement($a.a,null,null!==(i=l.reviewAgentDescriptionText)&&void 0!==i?i:"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments."),le.a.createElement(Pe,null,le.a.createElement(me.a,{onClick:l.onLaunch,size:"small",icon:le.a.createElement(At.l,null)},le.a.createElement($a.a,null,null!==(a=l.buttonText)&&void 0!==a?a:"Continue with ReviewSync"))))},Ls=(Object(S.a)(A),Object(o.__assign)({reviewAgentEntryCardStyle:Object(o.__assign)({display:"flex",flexDirection:"column"},De.a.gap("16px")),reviewAgentEntryCardElementStyle:Object(o.__assign)({display:"flex",flexDirection:"row"},De.a.gap("8px")),reviewAgentEntryCardSecondHeaderStyle:{},reviewAgentEntryCardDescriptionStyle:{},reviewAgentEntryCardButtonStyle:{},reviewAgentEntryCardReviewSyncIcon:{},reviewAgentEntryCardContinueIcon:{}},Uo())),Ms=Object(ue.a)(Ls),Bs=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=Object(o.__read)(Object(se.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.suggestionIndices),!1)),2),l=s[0],c=s[1],u=n.suggestionIndices[i].changeType,d=Object(o.__read)(Object(se.useState)(!1),2);d[0],d[1];Object(se.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var p=function(){return a((function(e){return e-1}))},g=function(){return a((function(e){return e+1}))};return le.a.createElement(pe,{style:t.stack,customProperties:{tabIndex:-1}},l.length?le.a.createElement(le.a.Fragment,null,le.a.createElement(is.a,null,"".concat("Suggestion"," ").concat(i+1," of ").concat(l.length)),le.a.createElement("div",null,le.a.createElement(Yn.a,null,u," "),le.a.createElement(As.a,null,"the line"," "),le.a.createElement(Yn.a,null,n.suggestionIndices[i].initialText," "," to"),le.a.createElement("br",null),le.a.createElement(As.a,null,n.suggestionIndices[i].suggestedText)),le.a.createElement("div",{className:t.footer},le.a.createElement(me.a,{disabled:n.suggestionIndices[i].disabled,size:"small",icon:le.a.createElement(rn.f,null),key:i,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t[i].disabled=!0,t})),[4,l[i].onApplySuggestion(l[i].commentId,l[i].suggestedText,l[i].changeType)];case 1:return e.sent(),[2]}}))}))}},"Apply"),le.a.createElement("div",{className:t.pagination},le.a.createElement("div",null,le.a.createElement(le.a.Fragment,null,le.a.createElement(he.a,{content:"Previous",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(rn.r,null),onClick:p,disabled:0==i,className:t.paginationButton})),le.a.createElement(he.a,{content:"Next",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(rn.u,null),onClick:g,disabled:i+1>=l.length,className:t.paginationButton})))))),le.a.createElement("div",{className:t.contentBoxIcon},K())):le.a.createElement(le.a.Fragment,null,"No results found for the search"))},Rs=Object(S.a)(j),Fs=Object(o.__assign)({stack:Object(o.__assign)({},De.a.gap("16px")),header:{fontWeight:"600"},contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Rs.neutralLight,minHeight:"50px",position:"relative"},De.a.padding("12px")),De.a.border("1px","solid",Rs.neutralLighterAlt)),De.a.borderRadius(Rs.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},De.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},De.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:Rs.neutralLight,height:"24px"},De.a.border("none")),{"&:hover":{color:Rs.themePrimary}}),spinnerButton:{backgroundColor:Rs.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Rs.themePrimary},"&:disabled":{color:Rs.neutralLighterAlt,"&:hover":{color:Rs.neutralLighterAlt}}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:Rs.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},De.a.border("1px","solid",Rs.neutralLighterAlt)),De.a.borderRadius(Rs.borderRadiusMedium)),on.a.caption1),De.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:Object(o.__assign)(Object(o.__assign)({},on.a.caption2),{color:Rs.neutralSecondaryAlt}),disabledContentBoxIcon:{":hover":{color:Rs.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Rs.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Uo()),Ns=Object(ue.a)(Fs),Hs=n(3440),Us=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=n.headerText,o=n.reviewersWithAction,i=n.statusMessage,a=n.labelForReviewedPeople,s=n.labelForPendingPeople,l=n.commentsSummaryHeader,c=n.commentsSummaries,u=o.filter((function(e){return e.responded})).length,d=o.length-u;return le.a.createElement(pe,{style:t.reviewStatusCardStyle},le.a.createElement(Hs.a,null,r),le.a.createElement(Yn.a,null,i),u>0&&Vs(o,!0,a,t),d>0&&Vs(o,!1,s,t),c.length>0&&c[0].length>0&&le.a.createElement("div",null,le.a.createElement(is.a,null,l),c.map((function(e,t){return le.a.createElement("p",{key:t},le.a.createElement(Yn.a,{key:t},e))}))),le.a.createElement(Ja.a,{className:t.footerAIGeneratedStyles},K()))},Vs=function(e,t,n,r){return le.a.createElement("div",{className:r.reviewSStatusReviewersListStyle},le.a.createElement(is.a,null,n),le.a.createElement(ms.a,{"aria-label":"Reviewers List",className:r.reviewStatusCardWrapperStyle},e.map((function(e,n){return e.responded===t&&le.a.createElement(vs.a,{shape:"circular",media:le.a.createElement(Vi.a,{name:e.suggestion.displayName,shape:"circular"}),dismissible:!1,key:n,size:"extra-small",value:e.suggestion.mail},e.suggestion.displayName)}))))},zs=Object(S.a)(A),Gs=Object(o.__assign)({reviewStatusCardStyle:{rowGap:"17px",display:"flex",flexDirection:"column"},reviewSStatusReviewersListStyle:{rowGap:"8px",display:"flex",flexDirection:"column"},reviewStatusCardWrapperStyle:{flexWrap:"wrap",rowGap:"8px"},footerAIGeneratedStyles:{color:zs.neutralSecondaryAlt}},Uo()),Ws=Object(ue.a)(Gs),Qs=function(e){var t,n,r=e.styles,o=e.body,i=o.reviewAgentIndividualCardProps.reviewAgentCardType,a=Ms(),s=Ns(),l=Ws();switch(i){case Aa.EntryPointCard:t=G(a,r),n=Ds;break;case Aa.ConfirmInvitationCard:t=G({},r),n=Ps;break;case Aa.SuggestionCard:t=G(s,r),n=Bs;break;case Aa.ReviewStatusCard:t=G(l,r),n=Us;break;default:t=G({},r),n=function(){return le.a.createElement("div",null,"Invalid Card Type")}}return le.a.createElement(n,{body:o,styles:t})},qs=n(3426),Ks=n(3427),Ys=n(3428),Zs=n(3429),Js=n(3430),Xs=n(3431),$s=n(3602),el=function(e){var t=e.styles,n=e.handleApplyOnClick,r=e.handleApplyAllOnClick,i=Object(o.__read)(Object(se.useState)(!1),2),a=i[0],s=i[1],l=Object(o.__read)(Object(se.useState)(!1),2),c=l[0],u=l[1],d=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,r()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?le.a.createElement(he.a,{content:"Waiting to apply updates",relationship:"label"},le.a.createElement(me.a,{className:Object(E.a)(t.spinnerButton,t.combinedButton),onClick:d,disabled:!0,icon:le.a.createElement(yn.e,{className:t.spinnerIcon})})):le.a.createElement(ge.a,{positioning:"below-end"},le.a.createElement(fe.a,{disableButtonEnhancement:!0},(function(e){return le.a.createElement(he.a,{content:"Apply Updates",relationship:"label"},le.a.createElement(Fa.a,{menuButton:e,primaryActionButton:{onClick:d},size:"small",className:t.applyButton},c?"Apply All":"Apply"))})),le.a.createElement(be.a,null,le.a.createElement(ye.a,null,le.a.createElement(Ce.a,{onClick:function(){u((function(e){return!e}))}},c?"Apply":"Apply All"))))},tl=[{columnKey:"old",label:"Old Comment"},{columnKey:"new",label:"New Comment"}],nl=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(Object(se.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.commentIndices),!1)),2),l=s[0],c=s[1],u=Object(o.__read)(Object(se.useState)(!1),2),d=u[0],p=u[1];Object(se.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var g=function(){return a((function(e){return e-1}))},h=function(){return a((function(e){return e+1}))},f=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return p(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),p(!1),[2]}}))}))},m=function(){c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t.splice(i,1),t}))},v={styles:t,handleApplyOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return le.a.createElement(pe,{style:t.stack,customProperties:{tabIndex:-1}},l.length?le.a.createElement(le.a.Fragment,null,le.a.createElement("div",{className:t.header},"Comments Summary"),le.a.createElement(qs.a,{"aria-label":"2X2 table"},le.a.createElement("div",{className:t.header},le.a.createElement("p",null,"Author Email : ",n.commentIndices[i].authorEmail)),le.a.createElement(Ks.a,null,le.a.createElement(Ys.a,null,tl.map((function(e){return le.a.createElement(Zs.a,{key:e.columnKey,className:t.tableHeader},e.label)})))),le.a.createElement(Js.a,null,le.a.createElement(Ys.a,null,le.a.createElement(Xs.a,null,le.a.createElement($s.a,null,n.commentIndices[i].oldCommentText)),le.a.createElement(Xs.a,null,le.a.createElement($s.a,null,n.commentIndices[i].newCommentText))))),le.a.createElement("div",{className:t.contentBox},le.a.createElement("div",{className:t.contentBoxButtonGroup},le.a.createElement("div",{className:d?t.disabledContentBoxIcon:t.contentBoxIcon},d?le.a.createElement(yn.f,{className:t.spinnerIcon}):le.a.createElement(he.a,{content:"Locate",relationship:"label"},le.a.createElement(Pt.b,{onClick:f}))),d?le.a.createElement(le.a.Fragment,null):le.a.createElement("div",{className:Object(E.a)(t.contentBoxIcon,t.dismissIcon)},le.a.createElement(he.a,{content:"Remove",relationship:"label"},le.a.createElement(ct.h,{onClick:m})))),le.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.commentIndices[i].comment)),le.a.createElement("div",{className:t.footer},le.a.createElement("div",null,le.a.createElement(el,Object(o.__assign)({},v))),le.a.createElement("div",{className:t.pagination},le.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),le.a.createElement("div",null,le.a.createElement(le.a.Fragment,null,le.a.createElement(he.a,{content:"Previous",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(ci.i,null),onClick:g,disabled:0==i,className:t.paginationButton})),le.a.createElement(he.a,{content:"Next",relationship:"label"},le.a.createElement(me.a,{icon:le.a.createElement(ci.j,null),onClick:h,disabled:i+1>=l.length,className:t.paginationButton}))))))):le.a.createElement(le.a.Fragment,null,"No results found for the search"))},rl=Object(S.a)(j),ol=Object(o.__assign)({stack:Object(o.__assign)({textAlign:"start",textOverflow:"clip"},De.a.gap("12px")),header:{fontWeight:"bold"},contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:rl.neutralLight,minHeight:"50px",position:"relative"},De.a.padding("12px")),De.a.border("1px","solid",rl.neutralLighterAlt)),De.a.borderRadius(rl.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},De.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},De.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:rl.neutralLight,height:"24px"},De.a.border("none")),{"&:hover":{color:rl.themePrimary}}),spinnerButton:{backgroundColor:rl.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:rl.themePrimary}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:rl.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},De.a.border("1px","solid",rl.neutralLighterAlt)),De.a.borderRadius(rl.borderRadiusMedium)),on.a.caption1),De.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:rl.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:rl.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:rl.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Uo()),il=Object(ue.a)(ol),al=n(98),sl=n(344),ll=n.n(sl),cl=Object(S.a)(j),ul=Object(o.__assign)(Object(o.__assign)({},Uo()),{cardRoot:{color:cl.black,fontSize:Le.a.fontSizeBase300,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",Le.a.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Hover},De.a.padding("1px","5px")),"& td":Object(o.__assign)(Object(o.__assign)({},De.a.borderBottom("1px","solid",Le.a.colorNeutralBackground3Pressed)),De.a.padding("1px","5px")),"& a ":Object(o.__assign)({},Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:Le.a.lineHeightBase200,gap:Le.a.spacingHorizontalXS,display:"inline-flex",alignItems:"flex-start",color:cl.colorBrandForegroundLink},De.a.padding("0px","0px",Le.a.spacingVerticalXXS)),{textDecorationLine:"none",cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(o.__assign)({color:cl.colorBrandForegroundLinkHover},De.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:active"]=Object(o.__assign)({color:cl.colorBrandForegroundLinkPressed},De.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:focus"]=Object(o.__assign)(Object(o.__assign)({color:cl.colorBrandForegroundLinkSelected},De.a.textDecoration("underline","solid",Le.a.colorStrokeFocus2)),De.a.borderBottom("1px","solid",Le.a.colorStrokeFocus2)),e}()),function(){var e;return(e={})["&:disabled"]={color:Le.a.colorNeutralForegroundDisabled,textDecorationLine:"none",cursor:"default"},e}())),"& button, .ac-pushButton":Object(o.__assign)({},Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:Le.a.fontWeightRegular,color:Le.a.colorNeutralForeground1,fontSize:Le.a.fontSizeBase200},De.a.padding(Le.a.spacingVerticalXS,Le.a.spacingHorizontalS)),De.a.borderRadius(Le.a.borderRadiusMedium)),De.a.border("1px","solid",Le.a.colorNeutralStroke1)),{backgroundColor:Le.a.colorNeutralBackground1,cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(o.__assign)(Object(o.__assign)({},De.a.borderColor(Le.a.colorNeutralStroke1Hover)),{backgroundColor:Le.a.colorNeutralBackground1Hover,color:Le.a.colorNeutralForeground1Hover}),e["&:hover .".concat(an.a.icon)]={color:cl.themePrimary},e}()),function(){var e;return(e={})["&:hover:active"]=Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Pressed,color:Le.a.colorNeutralForeground1Pressed},De.a.borderColor(Le.a.colorNeutralStroke1Pressed)),e}()),function(){var e;return(e={})["&:disabled"]=Object(o.__assign)(Object(o.__assign)({},De.a.borderColor(Le.a.colorNeutralStrokeDisabled)),{color:Le.a.colorNeutralForegroundDisabled,backgroundColor:Le.a.colorNeutralBackgroundDisabled,cursor:"default"}),e}())),"& .ac-container":{"& ol, ul":{paddingInlineStart:Le.a.spacingVerticalXL}},"& .ac-image":{objectFit:"contain"}},decorativeBorder:Object(o.__assign)(Object(o.__assign)({},De.a.margin(Le.a.spacingVerticalS,Le.a.spacingVerticalNone,Le.a.spacingVerticalNone)),Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius(Le.a.borderRadiusMedium)),De.a.border("1px","solid",Le.a.colorNeutralStroke1))),adaptiveCardWrapper:Object(o.__assign)({},De.a.padding(Le.a.spacingVerticalS,Le.a.spacingVerticalM,Le.a.spacingVerticalM)),cardHeader:{},cardFooter:{},cardSourceLabel:{display:"flex",flexDirection:"row",width:"100%",height:Le.a.lineHeightBase300,marginBottom:Le.a.spacingVerticalM,color:Le.a.colorNeutralForeground4,"& label":{fontSize:Le.a.fontSizeBase100,marginLeft:Le.a.spacingVerticalXS,height:Le.a.lineHeightBase100}}}),dl=Object(ue.a)(ul),pl=function(e){var t=e.text,n=dl(),r=Object(E.a)(null==n?void 0:n.cardFooter,null==n?void 0:n.footerBar);return t?le.a.createElement("div",{className:r},le.a.createElement("span",null,t)):null},gl=function(e){var t=e.text,n=dl(),r=Object(E.a)(null==n?void 0:n.cardHeader,n.headerBar);return t?le.a.createElement("div",{className:r},le.a.createElement("span",null,t)):null},hl=n(1622),fl=function(e){var t=e.text,n=e.iconName,r=dl();return t||n?le.a.createElement(pe,{style:r.cardSourceLabel},n&&le.a.createElement(hl.a,{iconName:n}),t&&le.a.createElement("label",null,t)):null},ml=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.isTelemetryEnabled=function(e){return e instanceof t||void 0!==e.executeWithTelemetry},t}(al.Action);al.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new ll.a).render(e),t.didProcess=!0};var vl=function(e){var t=e.styles,n=e.body,r=e.telemetryData,o=void 0===r?"":r,i=n.actionHandlers,a=n.customActions,s=n.cardData,l=n.headerText,c=n.footerText,u=n.sourceLabel,d=n.decorativeBorder,p=void 0===d||d,g=Object(E.a)(null==t?void 0:t.adaptiveCardWrapper,p?null==t?void 0:t.decorativeBorder:null);return le.a.createElement(pe,{style:null==t?void 0:t.cardRoot},le.a.createElement(gl,{text:l}),le.a.createElement("div",{className:g},le.a.createElement(fl,{text:null==u?void 0:u.text,iconName:null==u?void 0:u.iconName}),le.a.createElement(bl,{element:yl(s,i,a,o)})),le.a.createElement(pl,{text:c}))},bl=function(e){var t=e.element,n=Object(se.useRef)();return Object(se.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),le.a.createElement("span",{ref:n})},yl=function(e,t,n,r){var o=new al.CardObjectRegistry;for(var i in al.GlobalRegistry.populateWithDefaultActions(o),n)o.register(i,n[i]);var a=new al.SerializationContext;a.setActionRegistry(o);var s=new al.AdaptiveCard;return s.hostConfig=new al.HostConfig({spacing:{default:"12",padding:"0"},containerStyles:{default:{foregroundColors:{default:{default:cl.black}}}}}),s.parse(e,a),s.onExecuteAction=function(e){try{if(ml.isTelemetryEnabled(e))e.executeWithTelemetry(r);else if(e instanceof al.OpenUrlAction)(null==t?void 0:t.openUrlActionHandler)&&t.openUrlActionHandler(e.url,r);else if(e instanceof al.ExecuteAction&&(null==t?void 0:t.executeActionHandlers)){var n=t.executeActionHandlers[e.verb];n&&n(e.data,r)}}catch(e){}},s.render()},Cl=n(340),Ol=n.n(Cl);al.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new ll.a).render(e),t.didProcess=!0};var Sl,El,xl,Il=function(e){var t=e.cardData,n=new al.AdaptiveCard;n.hostConfig=new al.HostConfig({spacing:{padding:"0px"},containerStyles:{default:{foregroundColors:{default:{default:Go.black}}}}}),n.parse(t);var r=n.render();return le.a.createElement(wl,{element:r})},wl=function(e){var t=e.element,n=Object(se.useRef)();return Object(se.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),le.a.createElement("span",{ref:n})},Tl=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=Object(se.useRef)(null),u=n.basin,d=n.uniqueId,p=n.accessPath,g=n.value;Object(se.useEffect)((function(){!function(){var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}()}),[g]);var h=t.adaptiveCardRoot;if(r&&(h=Object(E.a)(t.adaptiveCardRoot,t.strikeThroughText)),u.items&&d&&p){var f=Ol()(u.items[d],p,null),m=[];if(a.length>0&&(m=W(f,a)),0===m.length&&f)return le.a.createElement(pe,{style:h},le.a.createElement(Il,{cardData:f}),le.a.createElement("span",{ref:c}));if(f&&m.length>0)return le.a.createElement(pe,{style:h},m.map((function(e,n){return le.a.createElement("span",{key:n,className:t.markdownRoot},le.a.createElement(Il,{cardData:e.adaptiveCard})," ",e.references.map((function(e,t){return le.a.createElement(ca,Object(o.__assign)({},e,{key:t,telemetryData:l}))})))})),le.a.createElement("span",{ref:c}))}return null},kl=function(e){var t=e.styles,n=e.body,r=e.warningActionButtons,o=void 0===r?[]:r;return le.a.createElement(pe,{style:t.warningMessageRootStack},le.a.createElement(st.a,{tabIndex:-1},n.warningPrefix,n.warningEmphasizedText&&le.a.createElement("span",{className:t.warningMessageBoldText},n.warningEmphasizedText),n.warningSuffix),o&&o.length>0&&o.map((function(e,n){return le.a.createElement(me.a,{key:n,className:t.warningActionButton,"aria-label":e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled},e.buttonText)})))},jl=Object(S.a)(j),Pl=Object(o.__assign)({warningMessageRootStack:Object(o.__assign)({alignItems:"center"},De.a.gap("4px")),warningMessageBoldText:Object(o.__assign)({},on.a.body1Stronger),warningActionButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"100%",height:"28px",backgroundColor:jl.neutralLight},De.a.border("1px","solid",jl.neutralLighterAlt)),De.a.borderRadius(jl.borderRadiusMedium)),De.a.padding("0px","0px","4px","0px")),on.a.body1)},Uo()),Al=Object(ue.a)(Pl),_l=function(e){var t,n,i,s,l,u,d=e.chatMessage,p=e.chatCardIndex,g=e.shouldShowFeedbackButtons,h=e.handleChatCardThumbsDownClick,f=e.handleChatCardThumbsUpClick,m=e.designerProps,v=e.customMessageRenderers,b=e.pluginServiceProvider,y=e.msgExtCardContextProvider,C={handleThumbsDownClick:h,handleThumbsUpClick:f,shouldShowFeedbackButtons:g,chatCardIndex:p,feedbackSectionPosition:d.feedbackSectionPosition,shouldShowAIGeneratedIndicator:d.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:!1,actionBarButtons:d.actionBarButtons,feedbackData:d.feedbackData,showAnimation:d.showAnimation,strikeThroughText:d.strikeThroughText,showMinifiedUI:null!==(t=d.showMinifiedUI)&&void 0!==t&&t,references:d.references,pillsList:d.pillsList,handlePillOnClick:d.handlePillOnClick,handleShowMeOnClick:d.handleShowMeOnClick,warningActionButtons:null!==(n=d.warningActionButtons)&&void 0!==n?n:[],clpSensitivityIndicatorData:null!==(i=d.clpSensitivityIndicatorData)&&void 0!==i?i:void 0,telemetryData:null!==(s=d.telemetryData)&&void 0!==s?s:"",msgExtCardProps:d.msgExtCardProps,pluginAuthError:d.pluginAuthError},O=d.messageType,S=d.body,E=d.styles;switch(O){case c.Default:C.styles=G(fa(),E),u=le.a.createElement(ma,Object(o.__assign)({body:S},C));break;case c.PaginatedCard:C.styles=G(za(),E),u=le.a.createElement(Ha,Object(o.__assign)({body:S},C));break;case c.AccordionCard:u=le.a.createElement(uo,Object(o.__assign)({styles:E,body:S},C));break;case c.ContentCard:C.styles=G(no(),E),u=le.a.createElement(io,Object(o.__assign)({body:S},C));break;case c.ChatCardWrapper:C.styles=G(function(){var e=Vo(),t=Fo();a()===r.IOS&&G(e,t);return e}(),E),u=le.a.createElement(qo,{renderData:S.renderData,fallbackElement:S.element,customMessageRenderers:v});break;case c.FeedbackNudge:C.styles=G(function(){var e=Sa(),t=ya();a()===r.IOS&&G(e,t);return e}(),E),u=le.a.createElement(va,Object(o.__assign)({body:S},C));break;case c.MarkdownCard:C.styles=G(function(){var e=Ra(),t=La();a()===r.IOS&&G(e,t);return e}(),E),u=le.a.createElement(Da,Object(o.__assign)({body:S},C,{msgExtCardContextProvider:y}));break;case c.SelfHelpAdaptiveCard:C.styles=G(dl(),E),u=le.a.createElement(vl,Object(o.__assign)({body:S},C));break;case c.StreamingAdaptiveCard:C.styles=G(Qo(),E),u=le.a.createElement(Tl,Object(o.__assign)({body:S},C));break;case c.Designer:var x=S,I=m.clientSettings;return S.clientSessionId&&(I.sessionId=S.clientSessionId),S.correlationId&&(I.correlationId=S.correlationId),le.a.createElement(zr,Object(o.__assign)({key:S.message},m,{clientSettings:I,userInput:x.message,turnId:x.turnId,isRehydration:x.isRehydration,handleThumbsDownClick:function(){return h({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(I)}})},handleThumbsUpClick:function(){return f({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(m.clientSettings)}})},feedbackData:C.feedbackData,fileCacheInfo:x.fileCacheInfo,isStockQuery:x.isStockQuery,stockImages:x.stockImages,imageType:x.imageType,isAuthEnabled:x.isAuthEnabled,dimensions:x.dimensions,companyName:x.companyName}));case c.WarningMessage:C.styles=G(Al(),E),u=le.a.createElement(kl,Object(o.__assign)({body:S},C));break;case c.ProactiveSuggestionCard:C.styles=G(Ka(),E),u=le.a.createElement(Wa,Object(o.__assign)({body:S},C));break;case c.CopilotWorkflowMessage:return le.a.createElement(qr,{launchText:S.launchText,buttonText:S.buttonText,onLaunch:S.onLaunch});case c.ReviewerSummaryCard:C.styles=G(il(),E),u=le.a.createElement(nl,Object(o.__assign)({body:S},C));break;case c.ReviewAgentCard:C.styles=G({},E),u=le.a.createElement(Qs,Object(o.__assign)({body:S},C));break;default:u=null}return le.a.createElement(ia,Object(o.__assign)({body:{user:null===(l=d.body)||void 0===l?void 0:l.user,element:u},pluginServiceProvider:b,msgExtCardContextProvider:y},C))},Dl=le.a.memo(_l,(function(e,t){var n,r;return t.chatMessage.messageType===c.Designer&&(null===(n=e.designerProps)||void 0===n?void 0:n.clientSettings.designerTheme)===(null===(r=t.designerProps)||void 0===r?void 0:r.clientSettings.designerTheme)})),Ll={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:Object(o.__assign)({verticalAlign:"end"},De.a.gap("10px")),chatCardsStack:Object(o.__assign)(Object(o.__assign)({verticalAlign:"end"},De.a.padding("0px","16px")),De.a.gap("10px"))},Ml=Object(ue.a)(Ll),Bl=function(e){var t,n=e.children,r=e.chatLog,o=e.styles,i=e.elementsBeforeChatLog,a=e.shouldShowFeedbackButtons,s=void 0===a||a,l=e.handleChatCardThumbsDownClick,c=e.handleChatCardThumbsUpClick,u=e.designerProps,d=e.customMessageRenderers,p=e.pluginServiceProvider,g=e.msgExtCardContextProvider,h=G(Ml(),o),f=null!==(t=null==u?void 0:u.isDesignerEnabled)&&void 0!==t&&t,m=f?Dl:_l;return le.a.createElement(pe,{style:h.root,reverse:!0},le.a.createElement(pe,{style:h.elementStack},i,le.a.createElement(pe,{style:h.chatCardsStack,customProperties:{role:L,"aria-label":H()?OfficeaicopilotStrings.ChatMessagesLabel:"Chat Messages","aria-setsize":r.length}},r.map((function(e,t){return le.a.createElement(m,{key:t,chatCardIndex:t,chatMessage:e,shouldShowFeedbackButtons:s,handleChatCardThumbsDownClick:l,handleChatCardThumbsUpClick:c,designerProps:f?u:void 0,customMessageRenderers:d,pluginServiceProvider:p,msgExtCardContextProvider:g})}))),n))},Rl=Object(S.a)(A),Fl={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("10px")),De.a.margin(Rl.spacingVerticalNone,Rl.spacingHorizontalNone,Rl.spacingVerticalS,Rl.spacingHorizontalS)),{alignContent:"center"}),De.a.border("0px")),(Sl={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},Sl["&:hover .".concat(an.a.icon)]={color:Rl.themePrimary},Sl["&:hover:active .".concat(an.a.icon)]={color:Rl.themePrimary},Sl))},Nl=Object(ue.a)(Fl),Hl=function(e){var t=e.buttonText,n=e.icon,r=e.onClick;return le.a.createElement(me.a,{appearance:"subtle",className:Nl().root,icon:n,onClick:r,size:"small"},t)},Ul=Object(S.a)(A),Vl={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("10px")),De.a.margin(Ul.spacingVerticalNone,Ul.spacingHorizontalNone,Ul.spacingVerticalS,Ul.spacingHorizontalS)),{alignContent:"center"}),De.a.border("0px")),(El={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},El["&:hover .".concat(an.a.icon)]={color:Ul.themePrimary},El["&:hover:active .".concat(an.a.icon)]={color:Ul.themePrimary},El))},zl=Object(ue.a)(Vl),Gl=se.memo((function(e){var t=e.handleChangeTopicButtonClick;return se.createElement(me.a,{appearance:"subtle",className:zl().root,icon:se.createElement(Se.e,null),onClick:t,size:"small"},ke())})),Wl=Object(S.a)(A),Ql={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("10px")),De.a.margin(Wl.spacingVerticalNone,Wl.spacingHorizontalNone,Wl.spacingVerticalS,Wl.spacingHorizontalS)),{alignContent:"center"}),De.a.border("0px")),(xl={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},xl["&:hover .".concat(an.a.icon)]={color:Wl.themePrimary},xl["&:hover:active .".concat(an.a.icon)]={color:Wl.themePrimary},xl))},ql=Object(ue.a)(Ql);var Kl=se.memo((function(e){var t=e.handlePythonExitAnalysisButtonClick;return se.createElement(me.a,{appearance:"subtle",className:ql().root,icon:se.createElement(At.i,null),onClick:t,size:"small"},"Exit analysis mode")}));function Yl(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},button:null!==(n=e.button)&&void 0!==n?n:{},suggestionContainer:null!==(r=e.suggestionContainer)&&void 0!==r?r:{},refreshButton:null!==(o=e.refreshButton)&&void 0!==o?o:{},refreshButtonIcon:null!==(i=e.refreshButtonIcon)&&void 0!==i?i:{},tooltip:null!==(a=e.tooltip)&&void 0!==a?a:{}};return Object(ue.a)(s)}var Zl,Jl,Xl=Object(S.a)(j),$l=Yl({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",flexWrap:"nowrap",backgroundColor:"transparent",minHeight:"67px"},De.a.padding("12px","0px")),De.a.margin(Xl.spacingVerticalNone)),{"> *:not(.ms-StackItem)":{flexShrink:0},overflowX:"auto",overflowY:"hidden"}),suggestionContainer:Object(o.__assign)(Object(o.__assign)({minHeight:"67px"},De.a.overflow("hidden")),De.a.padding("12px")),button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),{display:"flex"}),De.a.padding("0px","8px")),{fontFamily:"-apple-system",lineHeight:"normal",fontStyle:"normal",fontWeight:"400",fontSize:"14px",alignItems:"center",order:"0",textOverflow:"ellipsis",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",textAlign:"start"}),refreshButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",Xl.themeMedium)),{backgroundColor:"transparent"}),De.a.borderRadius("50%")),De.a.padding("2px")),De.a.margin("4px")),{verticalAlign:"middle",minWidth:"40px",height:"40px",order:-1}),tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}}),ec=Yl({root:Object(o.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},De.a.margin(Le.a.spacingHorizontalNone,Le.a.spacingHorizontalL,Le.a.spacingHorizontalNone)),suggestionContainer:{},button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"start",color:Le.a.colorNeutralForeground1,backgroundColor:"transparent"},De.a.border("1px","solid",Le.a.colorBrandBackground2Hover)),on.a.caption1),De.a.borderRadius(Le.a.borderRadiusXLarge)),De.a.padding(Le.a.spacingVerticalSNudge,Le.a.spacingHorizontalS)),De.a.margin(Le.a.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(o.__assign)({backgroundColor:Le.a.colorBrandBackground2},De.a.border("1px","solid",Le.a.colorBrandStroke2Hover)),"&:hover :active":Object(o.__assign)({backgroundColor:Le.a.colorBrandBackground2},De.a.border("1px","solid",Le.a.colorBrandStroke2Hover))}}),refreshButton:Object(o.__assign)(Object(o.__assign)({minWidth:"fit-content"},De.a.border("1px","solid",Le.a.colorBrandBackground2Hover)),{"@media (forced-colors: none)":(Zl={"&:hover":Object(o.__assign)({backgroundColor:Le.a.colorBrandBackground2},De.a.border("1px","solid",Le.a.colorBrandStroke2Hover))},Zl["&:hover .".concat(an.a.icon)]={color:Le.a.colorCompoundBrandForeground1},Zl)}),refreshButtonIcon:{width:"14px",height:"14px"}}),tc=Object(S.a)(j),nc=Yl({root:Object(o.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},De.a.margin(tc.spacingHorizontalNone,tc.spacingHorizontalL,tc.spacingHorizontalNone)),suggestionContainer:{},button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"start",color:tc.neutralPrimary,backgroundColor:"transparent"},De.a.border("1px","solid",tc.themeMedium)),on.a.caption1),De.a.borderRadius(tc.borderRadiusXLarge)),De.a.padding(tc.spacingVerticalSNudge,tc.spacingHorizontalS)),De.a.margin(tc.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(o.__assign)({backgroundColor:tc.themeLight},De.a.border("1px","solid",tc.themeDarker)),"&:hover :active":Object(o.__assign)({backgroundColor:tc.themeLight},De.a.border("1px","solid",tc.themeDarker))}}),refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":(Jl={},Jl["&:hover .".concat(an.a.icon)]={color:tc.themePrimary},Jl)},refreshButtonIcon:{width:"14px",height:"14px"}}),rc=function(e){var t=e.stylesToOverride,n=e.suggestionList,o=e.handleSuggestionPillClick,i=e.showRefreshButton,s=void 0!==i&&i,l=e.handleRefreshButtonClick,c=void 0===l?function(){}:l,u=function(){var e=nc(),t=ec(),n=v()?t:e;n.refreshButton=Object(E.a)(n.button,n.refreshButton);var o=$l();a()===r.IOS&&G(n,o);return n}();G(u,t);return le.a.createElement("div",{className:u.suggestionContainer},le.a.createElement(pe,{style:u.root,horizontal:!0,customProperties:{role:D,tabIndex:0,"aria-label":Te()}},n.map((function(e,t){return le.a.createElement(he.a,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},le.a.createElement(me.a,{size:"small",appearance:"subtle",className:u.button,onClick:function(){return o(e)},role:F,id:"".concat(Te,"-").concat(t)},e))})),s&&le.a.createElement(he.a,{content:le.a.createElement("span",{className:u.tooltip},H()?OfficeaicopilotStrings.SuggestionPaneRefreshButtonLabel:"Refresh"),relationship:"label",positioning:"above"},le.a.createElement(me.a,{appearance:"subtle",className:u.refreshButton,onClick:function(){c();var e=document.getElementById("".concat(Te,"-0"));e&&"function"==typeof e.focus&&e.focus()},icon:{className:u.refreshButtonIcon,children:le.a.createElement(At.g,null)},role:F}))))},oc=function(){return H()?OfficeaicopilotStrings.HintCardHeaderTextLabel:"hintCardHeaderText"},ic=function(){return H()?OfficeaicopilotStrings.HintCardDescriptionTextLabel:"hintCardDescriptionText"};var ac,sc,lc,cc=function(e){var t,n,r,o={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},headerText:null!==(n=e.headerText)&&void 0!==n?n:{},descriptionText:null!==(r=e.descriptionText)&&void 0!==r?r:{}};return Object(ue.a)(o)}({root:{lineHeight:"normal"}}),uc=Object(S.a)(j),dc={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({boxShadow:uc.shadow4,backgroundColor:uc.neutralLight},De.a.borderRadius(uc.borderRadiusXLarge)),De.a.margin(uc.spacingVerticalNone,uc.spacingHorizontalL,uc.spacingVerticalXXS)),De.a.padding(uc.spacingVerticalM)),rootHighContrast:Object(o.__assign)({},De.a.border("1px","solid",uc.neutralLighterAlt)),headerText:{fontWeight:uc.fontWeightSemibold,color:uc.themePrimary},descriptionText:{color:uc.neutralQuaternaryAlt}},pc=Object(ue.a)(dc),gc=function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n]);e.rootHighContrast=Object(E.a)(e.root,e.rootHighContrast)},hc=le.a.memo((function(e){var t=e.overrideStyles,n=e.headerText,o=e.descriptionText,i=f(),s=function(){var e=pc(),t=cc();a()===r.IOS&&gc(e,t);return e}();return gc(s,t),le.a.createElement(pe,{style:i?s.rootHighContrast:s.root,customProperties:{role:D,"aria-labelledby":oc(),"aria-describedby":ic(),"aria-live":"polite"}},le.a.createElement(st.a,{id:oc(),className:s.headerText},n),le.a.createElement(st.a,{id:ic(),className:s.descriptionText},o))})),fc=Object(S.a)(j),mc={chatInputRestShy:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px","solid",fc.neutralLighterAlt)),De.a.borderRadius("12px")),{backgroundColor:fc.neutralLight}),De.a.margin(fc.spacingHorizontalNone,fc.spacingHorizontalL,fc.spacingHorizontalL,fc.spacingHorizontalL)),De.a.padding("4px")),De.a.gap("12px")),{position:"relative",zIndex:"1",transform:"none",transformOrigin:"bottom","&selectors":{"&.chatInputLeftButtons":{"> button":{"&svg":{height:"18px",width:"18px"}}}}}),chatInputContainerRestShy:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding("6px","4px","0px")),{fontFamily:"-apple-system",fontStyle:"normal",fontWeight:"400",fontSize:"15px",cursor:"pointer",width:"min-content",lineHeight:"normal",display:"flex",alignItems:"center",letterSpacing:"-0.43px",color:fc.neutralSecondaryAlt}),De.a.flex("none")),{order:"1",flexGrow:"1"}),chatInputRestShyMenuButton:{height:"40px",width:"40px","&selectors":{"&svg":{height:"24px",width:"24px",fill:fc.themePrimary},"&hover":{backgroundColor:"transparent !important"}}}},vc=Object(ue.a)(mc),bc=n(3441),yc=n(3442),Cc=n(3443),Oc=n(862),Sc=Object(ue.a)({item:{fontSize:"16px",lineHeight:"normal",fontFamily:"-apple-system"},itemContent:Object(o.__assign)(Object(o.__assign)({display:"inline-block",whiteSpace:"nowrap"},De.a.overflow("hidden")),{textOverflow:"ellipsis"}),menuGroupHeader:{fontSize:"14px",fontFamily:"-apple-system",lineHeight:"normal"}}),Ec=Object(S.a)(j),xc=Object(ue.a)({item:(ac={},ac["&:hover .".concat(Oc.a.icon)]={color:Ec.themePrimary},ac.paddingLeft="10px",ac),itemContent:{},menuParent:Object(o.__assign)({width:"100%"},De.a.margin("0px","16px")),menuGroupHeader:{color:Ec.black}}),Ic=function(){var e=xc(),t=Sc();if(a()===r.IOS)G(e,t);return e},wc=function(e){var t,n=Ic();return le.a.createElement(bc.a,{key:null!==(t=e.sectionHeader)&&void 0!==t?t:w},e.showSectionTopDivider&&le.a.createElement(yc.a,null),e.sectionHeader!==w&&le.a.createElement(Cc.a,{className:n.menuGroupHeader},e.sectionHeader),e.starterPrompts.map((function(t){return Tc(t,e.sectionHeader)})))},Tc=function(e,t){var n=Object(Oe.a)(e.iconHover,e.iconRegular),r=Ic();return le.a.createElement(Ce.a,{key:e.text,className:r.item,icon:le.a.createElement(n,null),onClick:function(){return kc(e.text)},"aria-label":t+" "+e.text,content:{className:r.itemContent}},e.text)},kc=function(e){sc.handleOnClickStarterPromptMenuItem&&sc.handleOnClickStarterPromptMenuItem(e)},jc=Object(S.a)(j),Pc=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent")),{width:"40px",height:"40px",maxWidth:"unset","&:hover":Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent"))})}),Ac=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent"))})}),_c=Object(ue.a)({root:{color:jc.themePrimary}}),Dc=Object(S.a)(j),Lc=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Dc.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},De.a.borderColor(Dc.neutralLight)),De.a.borderRadius(Dc.borderRadiusXLarge)),{marginLeft:"4px",width:"32px",height:"32px","&:hover":{backgroundColor:Dc.neutralTertiaryAlt}})}),Mc=Object(ue.a)({root:{backgroundColor:Dc.neutralLighter}}),Bc=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Dc.neutralTertiary},De.a.borderColor(Dc.neutralTertiary)),{"&:hover":Object(o.__assign)({backgroundColor:Dc.neutralTertiary},De.a.borderColor(Dc.neutralTertiary))})}),Rc=Object(ue.a)({root:{color:Dc.neutralPrimary}}),Fc=Object(ue.a)({root:{color:Dc.themePrimary}}),Nc=Object(ue.a)({root:{color:Dc.neutralQuaternary}}),Hc=function(e){var t=e.title,n=e.isDisabled,i=e.isMenuOpen,s=e.setMenuOpen,l=(e.handleClick,e.positioningRef),c=e.menuProps,u=Object(se.useRef)(function(){var e=Lc(),t=Pc();a()===r.IOS&&G(e,t);return e}()),d=Object(se.useRef)(Object(E.a)(u.current.root,Mc().root)),p=Object(se.useRef)(Object(E.a)(u.current.root,function(){var e=Bc(),t=Ac();a()===r.IOS&&G(e,t);return e}().root)),g=Object(se.useRef)(function(){var e=Rc(),t=_c();a()===r.IOS&&G(e,t);return e}()),h=Object(se.useRef)(Fc().root),f=Object(se.useRef)(Nc().root),m=Object(o.__read)(Object(se.useState)(u.current.root),2),v=m[0],b=m[1],y=Object(o.__read)(Object(se.useState)(g.current.root),2),C=y[0],O=y[1];Object(se.useEffect)((function(){n?(b(p.current),O(f.current)):i?(b(d.current),O(h.current)):(b(u.current.root),O(g.current.root))}),[n,i]);return le.a.createElement(le.a.Fragment,null,le.a.createElement(me.a,{className:v,title:t,"aria-haspopup":!0,"aria-expanded":i,role:"button",icon:{className:C,children:i?le.a.createElement(yn.c,null):le.a.createElement(yn.d,null)},disabled:n,onClick:function(){return s(!i)}}),le.a.createElement(ge.a,{open:i,onOpenChange:function(e,t){s(t.open)},positioning:{positioningRef:l}},(sc=c,le.a.createElement(be.a,{className:Ic().menuParent},le.a.createElement(ye.a,null,sc.sections.map((function(e){return wc(e)})))))))},Uc=function(e){var t,n=e.handleClickAndUnMount,r=e.chatInputRestShyPlaceholder,i=e.isMenuButtonEnabled,a=void 0!==i&&i,s=e.isDisabled,l=e.menuButtonTitle,c=void 0===l?I():l,u=e.handleMenuButtonClick,d=e.handleOnOpenMenu,p=e.menuProps,g=(e.overrideStyles,Object(se.useRef)()),h=Object(se.useRef)(null),f=vc(),m=Object(o.__read)(Object(se.useState)(!1),2),v=m[0],b=m[1];le.a.useEffect((function(){var e;g.current&&(null===(e=h.current)||void 0===e||e.setTarget(g.current))}),[h,g]);return s&&v&&b(!1),le.a.createElement(pe,null,le.a.createElement("div",{id:"copilot-chat-input-shy",className:f.chatInputRestShy,ref:g},le.a.createElement(pe,{horizontal:!0},le.a.createElement("div",{className:f.chatInputRestShyMenuButton},a&&le.a.createElement(Hc,{title:c,isDisabled:s||0===(null===(t=null==p?void 0:p.sections)||void 0===t?void 0:t.length),isMenuOpen:v,setMenuOpen:b,handleClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return u&&u(),v?(b(!1),[3,4]):[3,1];case 1:return d?[4,d()]:[3,3];case 2:e.sent(),e.label=3;case 3:b(!0),e.label=4;case 4:return[2]}}))}))},menuProps:p,positioningRef:h})),le.a.createElement("div",{className:f.chatInputContainerRestShy,onClick:n,role:"textbox",tabIndex:0,"aria-disabled":s},r))))},Vc=Object(S.a)(j),zc={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Vc.neutralLight},De.a.borderRadius(Vc.borderRadiusXLarge)),De.a.margin(Vc.spacingHorizontalL)),De.a.padding(Vc.spacingVerticalM)),De.a.border("1px","double",Vc.colorTransparentStroke)),{backgroundImage:"linear-gradient(".concat(Vc.neutralLight,", ").concat(Vc.neutralLight,"), radial-gradient(circle at top left, ").concat(Vc.themePrimary,", ").concat(Vc.themeSecondary,")"),backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",rowGap:Vc.spacingVerticalXS}),rootHighContrast:Object(o.__assign)({},De.a.border("1px","solid",Vc.neutralLighterAlt)),headerWrapper:{flexDirection:"row",alignItems:"center"},headerText:{fontWeight:Vc.fontWeightSemibold,marginLeft:Vc.spacingHorizontalSNudge,lineHeight:Vc.lineHeightBase300,whiteSpace:"pre-line"},descriptionText:{color:Vc.neutralQuaternaryAlt,fontSize:Vc.fontSizeBase300,lineHeight:Vc.lineHeightBase300,whiteSpace:"pre-line",marginTop:Vc.spacingVerticalS},tipCardIcon:{color:Vc.themePrimary},actionButtonWrapper:Object(o.__assign)(Object(o.__assign)({},De.a.margin(0)),{marginTop:Vc.spacingVerticalS,color:Vc.neutralLight}),actionButton:Object(o.__assign)(Object(o.__assign)({float:"left",alignItems:"center",justifyContent:"center",width:"fit-content",height:Vc.spacingVerticalXXL,backgroundColor:Vc.themePrimary},De.a.borderRadius(Vc.borderRadiusMedium)),{paddingRight:Vc.spacingHorizontalS,paddingLeft:Vc.spacingHorizontalS,paddingTop:"3px",paddingBottom:"5px",fontSize:Vc.fontSizeBase200,lineHeight:Vc.lineHeightBase200,color:Vc.neutralLight,":hover":Object(o.__assign)(Object(o.__assign)({backgroundColor:Vc.themeTertiary,color:Vc.neutralLight},De.a.border("1px","solid",Vc.colorNeutralForegroundStaticInverted)),{":active":Object(o.__assign)({backgroundColor:Vc.themeDarker,color:Vc.neutralLight},De.a.border("1px","solid",Vc.colorNeutralForegroundStaticInverted))})})},Gc=Object(ue.a)(zc),Wc=le.a.memo((function(e){var t=e.headerText,n=e.descriptionTextList,r=e.buttonTitle,o=e.onClick,i=e.overrideStyles,a=e.icon,s=f(),l=Gc();!function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n]);e.rootHighContrast=Object(E.a)(e.root,e.rootHighContrast)}(l,i);var c;return le.a.createElement(pe,{style:s?l.rootHighContrast:l.root,customProperties:{role:D,"aria-labelledby":"tipCardHeaderText","aria-describedby":"tipCardDescriptionText"}},le.a.createElement(pe,{style:l.headerWrapper},a&&(c=a,le.a.createElement(c,{className:l.tipCardIcon})),le.a.createElement(st.a,{id:"tipCardHeaderText",className:l.headerText},t)),le.a.createElement(pe,null,(null!=n?n:[]).map((function(e,t){return le.a.createElement(st.a,{key:t,id:"tipCardDescriptionText",className:l.descriptionText},e)}))),r&&o?le.a.createElement("div",{className:l.actionButtonWrapper},le.a.createElement(me.a,{appearance:"primary",className:l.actionButton,onClick:o,title:r},r)):null)})),Qc=Object(ue.a)({inputBanner:Object(o.__assign)(Object(o.__assign)({minHeight:"32px"},De.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"})}),qc=function(e){var t=e.chatInputBannerString;return le.a.createElement(Vn.a,{className:Qc().inputBanner},le.a.createElement(Nn.a,null,t))};!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(lc||(lc={}));var Kc,Yc,Zc,Jc,Xc={fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system"},$c=Object(S.a)(j),eu=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:$c.neutralSecondaryAlt,alignItems:"flex-start"},on.a.body1),{fontStyle:"normal"}),De.a.gap("1px")),{content:"attr(title)"}),tu={color:$c.neutralQuaternary},nu=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},on.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),De.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(o.__assign)({},De.a.outline(0))}),ru={userInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},nu),{paddingRight:"2px",fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system",outlineStyle:"none"}),{"&:focus":Object(o.__assign)({},De.a.outline(0)),"&:focus::after":Object(o.__assign)(Object(o.__assign)({},eu),Xc),"&::after":Object(o.__assign)(Object(o.__assign)({},eu),Xc)})},ou={userInput:{"&:focus::after":tu,"&::after":tu}},iu=Object(ue.a)(ru),au=Object(ue.a)(ou),su=le.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,a=e.placeholderText,s=e.chatInputTabIndex,l=e.isDisabled,c=e.handleKeyDown,u=e.handleKeyUp,d=e.handleOnPaste,p=e.handleOnBeforeInput,g=e.handleOnInput,h=e.handleOnCompositionEnd,f=e.handleOnChatInputControlMount,m=e.handleOnChatInputControlUnmount,v=Object(se.useRef)();Object(se.useImperativeHandle)(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){b(e)},updateInputText:function(e,t){switch(t){case lc.InsertAtCursor:C(e);break;case lc.Replace:b(e)}},getInputText:function(){return y()},getInputSpanElement:function(){return v.current},setFocus:function(){O()},getGhostText:function(){var e,t;return null!==(t=null===(e=v.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;return null===(t=v.current)||void 0===t?void 0:t.setAttribute("title",e)}}}));var b=function(e){var t=v.current;t&&(t.innerText=e)},y=function(){var e=w,t=v.current;return t&&(e=t.innerText),e},C=function(e){var t=window.getSelection();t.rangeCount&&(t.deleteFromDocument(),t.getRangeAt(0).insertNode(document.createTextNode(e)),t.collapseToEnd())},O=function(){if(!l){var e=v.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(se.useEffect)((function(){return f&&f(),function(){m&&m()}}),[]);var S=Object(se.useRef)(iu()),x=Object(se.useRef)(au()),I=Object(o.__read)(Object(se.useState)(S.current.userInput),2),T=I[0],k=I[1];return Object(se.useEffect)((function(){n&&k(Object(E.a)(S.current.userInput,n))}),[n]),Object(se.useEffect)((function(){l&&k(Object(E.a)(S.current.userInput,x.current.userInput))}),[l]),le.a.createElement("span",{ref:v,className:T,title:a,"aria-label":a,role:"textbox",tabIndex:s,contentEditable:!l,suppressContentEditableWarning:!l,onKeyDown:c,onKeyUp:u,onPaste:d,onBeforeInput:p,onCompositionEnd:h,onInput:g,spellCheck:!(i===r.MACOS)})})),lu=n(3444),cu=Object(S.a)(j),uu=Object(ue.a)({root:{backgroundColor:"transparent"}}),du=Object(ue.a)({root:Object(o.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:cu.neutralTertiaryAlt,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},De.a.padding("16px"))}),pu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px solid")),De.a.borderColor("transparent")),De.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),gu=Object(ue.a)({root:{backgroundColor:cu.themePrimary,color:cu.neutralLight,"&:hover":{backgroundColor:"".concat(cu.themePrimary," !important")}}}),hu=Object(ue.a)({root:{backgroundColor:cu.neutralLight,color:cu.black,"&:hover":Object(o.__assign)(Object(o.__assign)({},De.a.borderColor("".concat(cu.themePrimary))),{backgroundColor:"".concat(cu.neutralLight," !important")})}}),fu=Object(ue.a)({root:{color:cu.themePrimary,"&:hover":{color:cu.themePrimary},fontSize:"12px"}}),mu=Object(ue.a)({root:{height:"63px",bottom:"12px"}}),vu=Object(ue.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),bu=Object(ue.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:cu.neutralQuaternaryAlt,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),yu=Object(ue.a)({root:{fontWeight:"bold",color:cu.black,fontSize:"12px",paddingBottom:"0px"}}),Cu=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(E.a)(pu().root,gu().root),c=Object(E.a)(pu().root,hu().root),u=bu().root,d=Object(E.a)(u,yu().root),p=fu().root,g=mu().root,h=Object(se.useRef)(null);return Object(se.useEffect)((function(){var e;t&&(null===(e=h.current)||void 0===e||e.focus())}),[t]),le.a.createElement(ae.a,{className:uu().root},le.a.createElement(Xe.a,{modalType:"modal",open:t},le.a.createElement($e.a,{className:du().root,tabIndex:0},le.a.createElement(et.a,null,le.a.createElement(tt.a,{className:d},n),le.a.createElement(rt.a,null,o&&le.a.createElement(Ae.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),le.a.createElement(ve.a,{className:u},r),i&&le.a.createElement($t.a,{inline:!0,className:p,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},H()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),le.a.createElement(Pn.a,{className:vu().root},le.a.createElement(nt.a,{disableButtonEnhancement:!0},le.a.createElement(me.a,{ref:h,className:c,appearance:"secondary",onClick:s},H()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),le.a.createElement(me.a,{className:l,appearance:"primary",onClick:a},H()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Kc||(Kc={}));var Ou=Object(S.a)(j),Su=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Ou.neutralLight,backgroundPositionX:"center",backgroundPositionY:"center"},De.a.borderRadius("8px")),De.a.borderColor(Ou.neutralLight)),(Yc={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Yc["&:hover .".concat(an.a.icon)]={color:Ou.themePrimary},Yc["&:hover:active .".concat(an.a.icon)]={color:Ou.themePrimary},Yc.display="flow",Yc))}),Eu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ou.themePrimary,color:Ou.neutralLight},De.a.borderRadius("50%")),(Zc={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Ou.themeLight)},"60%":{boxShadow:"0 0 0 8px ".concat(Ou.themeLight)},"100%":{boxShadow:"0 0 0 0 ".concat(Ou.themeLight)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Zc["&.".concat(an.a.icon)]={color:Ou.neutralLight},Zc["&:hover .".concat(an.a.icon)]={color:Ou.neutralLight},Zc["&:active .".concat(an.a.icon)]={color:Ou.neutralLight},Zc["&:hover:active .".concat(an.a.icon)]={color:Ou.neutralLight},Zc["&:hover"]={backgroundColor:Ou.themePrimary,color:Ou.neutralLight},Zc["&:hover:active"]={backgroundColor:Ou.themePrimary,color:Ou.neutralLight},Zc))}),xu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ou.neutralTertiary},De.a.borderColor(Ou.neutralTertiary)),(Jc={"&:hover":Object(o.__assign)({backgroundColor:Ou.neutralTertiary},De.a.borderColor(Ou.neutralTertiary))},Jc["&:hover .".concat(an.a.icon)]={color:Ou.neutralQuaternary},Jc["&:hover:active .".concat(an.a.icon)]={color:"".concat(Ou.neutralQuaternary," !important")},Jc))}),Iu=Object(ue.a)({root:{position:"relative",marginRight:"8px"}}),wu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ou.neutralTertiary},De.a.borderRadius("50%")),{color:Ou.themePrimary}),loader:Object(o.__assign)(Object(o.__assign)({color:Ou.neutralLight},De.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Ou.themePrimary,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Tu=(Object(ue.a)({root:{color:Ou.neutralPrimary}}),Object(ue.a)({root:{color:Ou.themePrimary}}),Object(ue.a)({root:{color:Ou.neutralQuaternary}}),function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(se.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(!1),2),l=s[0],c=s[1];Object(se.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(m.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(se.useEffect)((function(){t?g(h.current):n.isMicrophoneListening||g(u.current.root)}),[t]),Object(se.useEffect)((function(){n.microphoneState===Kc.Loading?(a(!0),g(f.current)):(a(!1),n.microphoneState===Kc.Uninitialized&&g(u.current.root))}),[n.microphoneState]);var u=Object(se.useRef)(Su()),d=Object(o.__read)(Object(se.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(se.useRef)(Object(E.a)(u.current.root,xu().root)),f=Object(se.useRef)(Object(E.a)(u.current.root,wu().root)),m=Object(se.useRef)(Object(E.a)(u.current.root,Eu().root));return le.a.createElement("div",{className:Iu().root},le.a.createElement(me.a,{className:p,title:n.title,"aria-label":n.title,role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?le.a.createElement(lu.a,null):le.a.createElement(lu.b,null),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t}),i&&le.a.createElement("div",{className:wu().loader}),le.a.createElement(Cu,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))});function ku(e){var t,n,r,o,i,a,s,l={chatInput:null!==(t=e.chatInput)&&void 0!==t?t:{},chatInputContainer:null!==(n=e.chatInputContainer)&&void 0!==n?n:{},userInput:null!==(r=e.userInput)&&void 0!==r?r:{},chatInputButtons:null!==(o=e.chatInputButtons)&&void 0!==o?o:{},chatInputLeftButtons:null!==(i=e.chatInputLeftButtons)&&void 0!==i?i:{},chatInputRightButtons:null!==(a=e.chatInputRightButtons)&&void 0!==a?a:{},contextualMenu:null!==(s=e.contextualMenu)&&void 0!==s?s:{}};return Object(ue.a)(l)}var ju,Pu=Object(S.a)(j),Au=ku({chatInput:Object(o.__assign)({},De.a.borderRadius(Pu.borderRadiusXLarge)),contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.padding(0)),{maxWidth:"288px",backgroundColor:Pu.neutralLight,boxShadow:Pu.shadow16}),De.a.borderRadius("12px"))}),_u=ku({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({left:"2",width:"97%",height:"4px"},De.a.borderRadius(0,0,"12px","12px")),{backgroundImage:"linear-gradient(to right, ".concat(Pu.themePrimary,", ").concat(Pu.themeSecondary,")")})}}}),Du=Object(S.a)(j),Lu={chatInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Du.neutralPrimary,backgroundColor:Du.neutralLight},De.a.border("1px","solid",Du.neutralLighterAlt)),De.a.borderRadius(Du.borderRadiusXLarge)),De.a.margin(0,"16px","16px","16px")),De.a.padding("4px")),De.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(o.__assign)({},De.a.margin("12px","12px","4px","12px")),userInput:{},chatInputButtons:Object(o.__assign)(Object(o.__assign)({backgroundColor:Du.neutralLight,width:"100%",flexDirection:"row",flexWrap:"wrap"},De.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{alignSelf:"flex-end",display:"flex"},contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},De.a.padding("6px")),{backgroundColor:Du.neutralLight,boxShadow:Du.shadow4}),De.a.borderRadius("8px"))},Mu=Object(ue.a)(Lu),Bu=Object(ue.a)({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},De.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(Du.themePrimary,", ").concat(Du.themeSecondary,")")})}}}),Ru=Object(ue.a)({chatInputRightButtons:{display:"contents"}}),Fu=Object(ue.a)({chatInput:{backgroundColor:Du.neutralTertiary},chatInputButtons:{backgroundColor:Du.neutralTertiary}}),Nu=Object(S.a)(j),Hu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({width:"40px",height:"40px",maxWidth:"unset",backgroundColor:"transparent"},De.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent"))})}),Uu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},De.a.borderColor("transparent"))})}),Vu=Object(ue.a)({root:{color:Nu.themePrimary}}),zu=Object(S.a)(j),Gu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:zu.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},De.a.borderColor(zu.neutralLight)),De.a.borderRadius(zu.borderRadiusXLarge)),{marginRight:"2px",width:"32px",height:"32px","&:hover":{backgroundColor:zu.neutralTertiaryAlt}})}),Wu=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:zu.neutralTertiary},De.a.borderColor(zu.neutralTertiary)),{"&:hover":Object(o.__assign)({backgroundColor:zu.neutralTertiary},De.a.borderColor(zu.neutralTertiary))})}),Qu=Object(ue.a)({root:{color:zu.neutralPrimary}}),qu=Object(ue.a)({root:{color:zu.themePrimary}}),Ku=Object(ue.a)({root:{color:zu.neutralQuaternary}}),Yu=function(e){var t=e.title,n=e.isDisabled,i=e.handleClick,l=e.isInputEmpty,c=Object(o.__read)(le.a.useState(!1),2),u=c[0],d=c[1],p=Object(se.useRef)(function(){var e=Gu(),t=Hu();a()===r.IOS&&G(e,t);return e}()),g=Object(se.useRef)(Object(E.a)(p.current.root,function(){var e=Wu(),t=Uu();a()===r.IOS&&G(e,t);return e}().root)),h=Object(se.useRef)(Qu()),f=Object(se.useRef)(qu().root),m=Object(se.useRef)(Ku().root),v=Object(se.useRef)(function(){var e={root:""},t=Vu();a()===r.IOS&&G(e,t);return e}().root),b=Object(o.__read)(Object(se.useState)(p.current.root),2),y=b[0],C=b[1],O=Object(o.__read)(Object(se.useState)(h.current.root),2),S=O[0],x=O[1];Object(se.useEffect)((function(){n?(C(g.current),x(m.current)):(x(u?f.current:l?h.current.root:v.current),C(p.current.root))}),[n,u,l]);var I,w,T,k=s()?Pt.f:Pt.h,j=s()?Pt.e:Pt.g;return le.a.createElement(me.a,{className:y,title:t,"aria-label":t,role:"button",onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},icon:{className:S,children:(I=k,w=j,T=Object(Oe.a)(w,I),le.a.createElement(T,null))},onClick:i,disabled:n})},Zu=le.a.forwardRef((function(e,t){var n,i=e.isDisabled,l=e.overrideStyles,c=e.chatInputTabIndex,u=void 0===c?0:c,d=e.chatInputContainerTabIndex,p=void 0===d?-1:d,g=e.chatInputContainerTitle,h=void 0===g?H()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area":g,f=e.placeholderText,m=void 0===f?H()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own":f,v=e.maxInputCharLimit,b=void 0===v?300:v,y=e.handleKeyDown,C=e.handleKeyUp,O=e.handleOnPaste,S=e.handleOnBeforeInput,x=e.handleOnInput,T=e.submitButtonTitle,k=void 0===T?H()?OfficeaicopilotStrings.SubmitButtonTitle:"Send":T,j=e.handleSubmitButtonClick,P=e.isMenuButtonEnabled,A=void 0!==P&&P,_=e.shouldOpenMenuOnEmptyInput,D=void 0!==_&&_,L=e.menuButtonTitle,M=void 0===L?I():L,B=e.handleMenuButtonClick,R=e.handleOnOpenMenu,F=e.handleOnChatInputControlMount,N=e.handleOnChatInputControlUnmount,U=e.handleOnBlur,V=e.menuProps,z=e.microphoneProps,W=e.chatInputBannerProps,Q=e.submitButtonFactory,q=Object(se.useRef)(),K=Object(se.useRef)(),Y=Object(se.useRef)(null);z&&!z.title&&(z.title=H()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone"),Object(se.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=q.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=q.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getImages()},setInputText:function(e){var t;null===(t=q.current)||void 0===t||t.setInputText(e),s()&&te(0==e.length)},updateInputText:function(e,t){var n;null===(n=q.current)||void 0===n||n.updateInputText(e,t)},getInputText:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){re(e)},getGhostText:function(){return ne()},setFocus:function(){var e;null===(e=q.current)||void 0===e||e.setFocus()},closeMenu:function(){A&&J&&X(!1)}}}));var Z=Object(o.__read)(Object(se.useState)(!1),2),J=Z[0],X=Z[1],$=Object(o.__read)(Object(se.useState)(!0),2),ee=$[0],te=$[1],ne=function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getGhostText()},re=Object(se.useCallback)((function(e){var t;null===(t=q.current)||void 0===t||t.setGhostText(e)}),[]),oe=!1,ie=!1,ae=function(e){var t,n;e.stopPropagation();var r=null===(t=q.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==w&&(j(r),null===(n=q.current)||void 0===n||n.setInputText(w),re(m))};Object(se.useEffect)((function(){re(m)}),[m,re]),le.a.useEffect((function(){var e;K.current&&(null===(e=Y.current)||void 0===e||e.setTarget(K.current))}),[Y,K]);var ce=function(){var e=Mu(),t=Au();a()===r.IOS&&G(e,t);return e}(),ue=function(){var e=Bu(),t=_u();a()===r.IOS&&G(e,t);return e}(),de=Fu(),ge=Ru(),he=Object(se.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),fe=Object(se.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),me=Object(se.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),ve=Object(o.__read)(Object(se.useState)(ce),2),be=ve[0],ye=ve[1];Object(se.useEffect)((function(){for(var e in ce)he.current[e]=Object(E.a)(ce[e],ue[e]);for(var e in ce)fe.current[e]=Object(E.a)(ce[e],de[e]);for(var e in ce)me.current[e]=Object(E.a)(ue[e],ce[e],ge[e])}),[]),Object(se.useEffect)((function(){if(l)for(var e in ce)he.current[e]=Object(E.a)(ce[e],l[e])}),[l]),Object(se.useEffect)((function(){ye(i?fe.current:he.current)}),[i,l]),Object(se.useEffect)((function(){(null==z?void 0:z.isMicrophoneListening)?ye(me.current):ye(he.current)}),[null==z?void 0:z.isMicrophoneListening]);return le.a.createElement("div",null,le.a.createElement("div",{id:"copilot-chat-input",className:be.chatInput,title:h,tabIndex:p,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return i||document.activeElement===(null===(e=q.current)||void 0===e?void 0:e.getInputSpanElement())?[2]:D&&A&&(null===(t=q.current)||void 0===t?void 0:t.getInputText())==w&&!J?R?[4,R()]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return X(!0),[3,4];case 3:J&&X(!1),r.label=4;case 4:return null===(n=q.current)||void 0===n||n.setFocus(),[2]}}))}))},onBlur:function(){var e;s()&&!J&&(null===(e=q.current)||void 0===e?void 0:e.getInputText())===w&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return U(),[2]}))}))}),100)},ref:K},W&&le.a.createElement(qc,Object(o.__assign)({},W)),le.a.createElement("div",{className:be.chatInputContainer},le.a.createElement(su,{ref:q,styleOverrideClassName:l?l.userInput:"",placeholderText:m,chatInputTabIndex:u,isDisabled:i,handleKeyDown:function(e){var t,n,r;oe="Process"===e.key,e.nativeEvent.isComposing||(ie&&"Enter"===e.key?ie=!1:y&&!y(e)||(s()&&("Backspace"===e.key?te((null===(t=q.current)||void 0===t?void 0:t.getInputText().length)<=1):te(!1)),"Enter"===e.key&&(e.preventDefault(),j(null===(n=q.current)||void 0===n?void 0:n.getInputText()),null===(r=q.current)||void 0===r||r.setInputText(w),re(m))))},handleKeyUp:function(e){var t;C&&!C(e)||((null===(t=q.current)||void 0===t?void 0:t.getInputText())===w?re(m):ne()===m&&re(w))},handleOnPaste:function(e){var t;if(!O||O(e)){re(w),e.preventDefault();var n=e.clipboardData.getData("Text"),r=n.length||0,o=null===(t=q.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(i.rangeCount){var a=i.toString(),s=o.length-a.length,l=n.substring(0,b-s);i.deleteFromDocument(),s+r>=b?i.getRangeAt(0).insertNode(document.createTextNode(l)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()}}},handleOnBeforeInput:function(e){S&&!S(e)||(X(!1),re(w))},handleOnInput:function(e){!x||x(e)},handleOnCompositionEnd:function(){oe||(ie=!0)},handleOnChatInputControlMount:F,handleOnChatInputControlUnmount:N}),le.a.createElement("span",{"aria-hidden":!0},"‍")),le.a.createElement(pe,{style:be.chatInputButtons},le.a.createElement("div",{className:be.chatInputLeftButtons},A&&le.a.createElement(Hc,{title:M,isDisabled:i||0===(null===(n=null==V?void 0:V.sections)||void 0===n?void 0:n.length),isMenuOpen:J,setMenuOpen:X,handleClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return B&&B(),J?(X(!1),[3,4]):[3,1];case 1:return R?[4,R()]:[3,3];case 2:e.sent(),e.label=3;case 3:X(!0),e.label=4;case 4:return[2]}}))}))},positioningRef:Y,menuProps:V})),le.a.createElement("div",{className:be.chatInputRightButtons},z&&le.a.createElement("span",{title:function(){switch(z.microphoneState){case Kc.Enabled:return z.isMicrophoneListening?H()?OfficeaicopilotStrings.MicrophoneListeningStatus:"Microphone Listening":H()?OfficeaicopilotStrings.MicrophonePausedStatus:"Microphone Paused";case Kc.Disabled:return H()?OfficeaicopilotStrings.MicrophoneDisabledStatus:"Microphone Disabled";case Kc.Loading:return H()?OfficeaicopilotStrings.MicrophoneLoadingStatus:"Microphone Loading"}}()},le.a.createElement(Tu,{"aria-live":"assertive",isDisabled:i,microphoneButtonProps:z})),Q?Q({handleClick:ae,isDisabled:i,isInputEmpty:ee,title:k}):le.a.createElement(Yu,{title:k,isDisabled:i,handleClick:ae,isInputEmpty:ee})))))})),Ju=le.a.memo(Zu),Xu=n(2803),$u="/";!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(ju||(ju={}));var ed=n(478),td="https://",nd=td+"outlook-1-cdn.azureedge.",rd="midgard/",od="/agsc-"+rd,id="versionless/",ad=td+"res.cdn.office.net/"+rd;var sd,ld,cd,ud=n(2073),dd=n(183),pd="".concat((sd={environment:"Prod"},sd?sd.publicPath?sd.publicPath:function(e){switch(e.environment){case"Gallatin":return td+"res-1.cdn.partner.office365.cn/"+rd;case"AG08":return nd+"eaglex.ic.gov"+od;case"AG09":return nd+"microsoft.scloud"+od;case"GccHigh":return td+"res-gcch.cdn.office.net/"+rd;case"DoD":return td+"res-dod.cdn.office.net/"+rd;default:return ad}}(sd)+id:ad+id)).concat("graph-search-local-0.4.2781-0.14.3"),gd=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-nudge","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-oa-email-ecc","mc-editor-enable-meeting-banner","mc-editor-expanded-ecc-responsive","mc-editor-oa-debug"],hd=function(){function e(){this.staticSettings={isAggregatedLoggingEnabled:!0,controlIconSetName:"FabricMDL2Icons",showOptionsButton:!0,synonymsEndPoint:ud.b.Prod,licenseType:dd.b.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:4,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,oaSettings:{isContextualCardEnabled:!0,disableInlineSuggestionTooltips:!0,mockResults:!1,e2eMetric:!0,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:!0,bestMatchConfig:{enabled:!0,maxResults:fd}}},this.getFlightsToTrack=function(e,t,n){var r=Object(o.__spreadArray)([],Object(o.__read)(gd),!1);return(null==n?void 0:n.length)>0&&(r=r.concat.apply(r,Object(o.__spreadArray)([],Object(o.__read)(n),!1))),(null==t?void 0:t.enableChatCIQ)&&r.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&r.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&r.push("vivatopics"),e&&r.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&r.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&r.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableMeetingBanner)&&r.push("mc-editor-enable-meeting-banner"),(null==t?void 0:t.enableSearchBar)&&(r.push("mc-editor-enable-searchbar"),r.push("mc-editor-attachbutton-searchbar-position")),r}}return e.prototype.composeSettings=function(e,t){var n,r,o,i,a,s=Object.assign({},this.staticSettings.oaSettings,{enableOaClient:null===(n=e.featureFlags)||void 0===n?void 0:n.enableHybridWorkflow,customizedEmptyECCSuggestionsString:e.customizedEmptyECCSuggestionsString,updateResultsTimeout:e.resultTime?e.resultTime:6e3,entitiesEnabled:t,scopesConfig:e.enableAutomaticScoping?{enabled:!0,maxResults:fd,enableAutomaticScoping:!0}:{enabled:!0,maxResults:fd,enableAutomaticScoping:!1}});return Object.assign({},this.staticSettings,{appId:e.hostAppId,flightsToTrack:this.getFlightsToTrack(!!(null===(r=e.featureFlags)||void 0===r?void 0:r.enableHybridWorkflow),e.featureFlags,e.flightsToTrack),defaultLocale:e.hostDefaultLocale,editorEndPoint:e.isDogfoodEnvironment?ud.a.Lab:ud.a.Prod,hostMetadata:{appName:e.hostAppName,appPlatform:e.hostAppPlatform,appScenario:e.hostAppScenario,sessionId:e.sessionId,releaseAudienceGroup:e.isDogfoodEnvironment?"Dogfood":"Production"},orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:null!==(o=e.augloopEndPoint)&&void 0!==o?o:"https://augloop-dogfood.officeppe.com",augLoopAuthTokenCallback:e.augLoopAuthTokenCallback,substrateAuthTokenCallback:e.substrateAuthTokenCallback},oaSettings:s,serviceSettings:{hybridAugloop:{enabled:!!(null===(i=e.featureFlags)||void 0===i?void 0:i.enableHybridWorkflow),enableGraphSearchLocal:!!(null===(a=e.featureFlags)||void 0===a?void 0:a.enableHybridWorkflow),wasmConfig:{binaryPath:pd,scriptPath:pd}}},isDarkMode:e.isDarkMode})},e}(),fd=15;function md(e,t){var n=new hd,r=function(e){var t=[];return e.forEach((function(n){t.push({enabled:!0,entityType:n,maxResults:1===e.length?void 0:fd})})),t}(t);return n.composeSettings(e,r)}!function(e){e.ChatECCInjectionError="Chat_ECC_Injection_Error",e.CIQForcedInvokeException="CIQ_Forced_Invoke_Exception",e.CIQThemeUpdateException="CIQ_Theme_Update_Exception",e.EditorBootstrapException="Editor_Bootstrap_Exception",e.EditorShutdownException="Editor_Shutdown_Exception",e.EmailECCInjectionError="Email_ECC_Injection_Error",e.EventECCInjectionError="Event_ECC_Injection_Error",e.FileECCInjectionError="File_ECC_Injection_Error",e.PeopleECCInjectionError="People_ECC_Injection_Error",e.UnsupportedSuggestionTypeError="Unsupported_Suggestion_Type_Error"}(ld||(ld={})),function(e){e.EditorShutdownSuccess="Editor_Shutdown_Success",e.EditorCIQForceInvoke="Editor_CIQ_Force_Invoke",e.EditorCIQThemeUpdate="Editor_CIQ_Theme_Update",e.EditorBootstrapSuccess="Editor_Bootstrap_Success"}(cd||(cd={}));var vd=!1;var bd=function(e,t){vd&&(null==t?console.log("Chat Editor log:",e):console.log("Chat Editor log:",e,t))};function yd(e){var t=null==e?void 0:e.message;return void 0!==t?t:""}var Cd=void 0;function Od(e){Cd&&(Cd.logError(e),bd(e))}function Sd(e,t){Cd&&Cd.logErrorTelemetry&&Cd.logErrorTelemetry(e,t)}function Ed(e,t){Cd&&Cd.logSuccessTelemetry&&Cd.logSuccessTelemetry(e,t)}var xd,Id=n(2077),wd=n(2076),Td=n(107),kd=n.n(Td);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(xd||(xd={}));var jd=xd.web;function Pd(){return jd===xd.IOS}var Ad,_d,Dd;!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(Ad||(Ad={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(_d||(_d={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(Dd||(Dd={}));var Ld=Object(ue.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),Md=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(E.a)(o,t)),n?o=r?Object(E.a)(o,e.horizontalReverse):Object(E.a)(o,e.horizontal):r&&(o=Object(E.a)(o,e.verticalReverse)),o}(Ld(),n,i,s);return se.createElement("div",Object(o.__assign)({className:c},l),t)},Bd=Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),Rd=(Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}});function Fd(e){var t=Rd(e);return Object(ue.a)(t)}var Nd=Fd({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),Hd=Object(S.a)(Bd),Ud=Fd({tooltipText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1),{color:Hd.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(o.__assign)(Object(o.__assign)({},on.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},De.a.padding("12px")),De.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),Vd=function(){var e=Ud(),t=Nd();if(jd===xd.IOS)zd(e,t);return e},zd=function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n])},Gd=function(e){switch(void 0===e&&(e=Dd.NonEncryption),e){case Dd.Encryption:return Pd()?le.a.createElement(Pt.q,null):le.a.createElement(Pt.o,null);case Dd.Warning:return Pd()?le.a.createElement(ui.e,null):le.a.createElement(ui.c,null);case Dd.NonEncryption:default:return Pd()?le.a.createElement(Pt.m,null):le.a.createElement(Pt.k,null)}},Wd=function(e,t){switch(void 0===e&&(e=Dd.NonEncryption),e){case Dd.Encryption:return Pd()?le.a.createElement(Pt.p,{primaryFill:t}):le.a.createElement(Pt.n,{primaryFill:t});case Dd.Warning:return Pd()?le.a.createElement(ui.d,{primaryFill:t}):le.a.createElement(ui.b,{primaryFill:t});case Dd.NonEncryption:default:return Pd()?le.a.createElement(Pt.l,{primaryFill:t}):le.a.createElement(Pt.j,{primaryFill:t})}},Qd=function(e){var t,n,r=e.styles,o=e.clpSensitivityIndicatorData,i=Vd();return zd(i,r),le.a.createElement($o.a,{openOnHover:!0},le.a.createElement(ei.a,null,le.a.createElement("span",{className:i.icon},o.icon?le.a.createElement(o.icon,null):(t=o.iconType,n=o.color,void 0===t&&(t=Dd.NonEncryption),n?Wd(t,n):Gd(t)))),le.a.createElement(ti.a,{className:i.tooltipStack},le.a.createElement(Md,null,o.badgeText&&le.a.createElement(Yn.a,{className:i.badgeText},o.badgeText),le.a.createElement(Yn.a,{className:i.tooltipText},o.tooltipText))))},qd=n(3343),Kd=n(2421),Yd=n(1618),Zd=n(3344),Jd=n(841),Xd=Object(Jd.a)({palette:Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),$d=(Object(Jd.a)({palette:Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(e){var t=e.themePalette,n=e.isDarkMode,r=e.children,i=e.className,a=Object(o.__assign)(Object(o.__assign)({},Xd.palette),t),s=Object(Zd.a)(a),l=n?Object(Kd.a)(s):Object(Yd.a)(s);return se.createElement(ae.a,{className:i,theme:l},r)}),ep=Object(ue.a)({ciqInputText:{color:Le.a.colorBrandForeground1}}),tp=le.a.forwardRef((function(e,t){var n=e.text,r=e.id,i=e.copilotChatTheme,a=e.isDarkModeEnabled,s=Object(o.__read)(Object(se.useState)(e.isLoading),2),l=s[0],c=s[1],u=Object(o.__read)(Object(se.useState)(e.clpSensitivityIndicatorData),2),d=u[0],p=u[1],g=ep();return Object(se.useImperativeHandle)(t,(function(){return{setLoading:function(e){c(e)},setSensitivity:function(e){p(e)}}})),le.a.createElement("span",{contentEditable:!1,className:"user-ciq-selection-id",id:r,style:{display:"inline"}},le.a.createElement("span",{className:g.ciqInputText},n),le.a.createElement("span",{style:{display:"inline-block",verticalAlign:"text-bottom"}},l?le.a.createElement(qd.a,{size:"extra-tiny"}):le.a.createElement($d,{themePalette:i,isDarkMode:a},d&&le.a.createElement(Qd,{clpSensitivityIndicatorData:d}))))})),np=function(){function e(){this.ciqId=0,this.ciqUrls=new Map,this.isHVCAppChatV2Enabled=!1,this.queryAnnotationSet=new Map}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,i,a){if(e.suggestion&&e.queryRange){++this.ciqId;var s="userCIQSelectionId-"+this.ciqId;this.ciqUrls.set(s,e.suggestion.url),this.queryAnnotationSet.set(s,e.suggestion.queryAnnotation);var l={text:e.suggestion.text,id:s,clpSensitivityIndicatorData:t,isLoading:n,copilotChatTheme:r,isDarkModeEnabled:i},c=le.a.createElement(tp,Object(o.__assign)(Object(o.__assign)({},l),{ref:a}),null),u=document.createElement("span");if(kd.a.render(c,u),e.queryRange.endContainer){var d=e.queryRange.endContainer.textContent;d&&" "===d.charAt(d.length-1)&&(e.queryRange.endContainer.textContent=d.slice(0,-1),e.queryRange.setEndAfter(e.queryRange.endContainer),e.queryRange.collapse(!1))}e.queryRange.insertNode(u),u.insertAdjacentText("beforebegin"," "),e.queryRange.collapse(!1);var p=document.createTextNode(" ");e.queryRange.insertNode(p),e.queryRange.setEndAfter(p),e.queryRange.collapse(!1);var g=window.getSelection();null==g||g.removeAllRanges(),null==g||g.addRange(e.queryRange),bd("renderAndTrackSelectedSuggestion: rendered suggestion")}else bd("renderAndTrackSelectedSuggestion: nothing to render")},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n;if(this.ciqUrls.size<=0)bd("generatCopilotOdslSignalLinks: nothing to generate");else{var r=Object(o.__spreadArray)([],Object(o.__read)(this.ciqUrls.keys()),!1);try{for(var i=Object(o.__values)(r),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.ciqUrls.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.ciqUrls.size<=0)){for(var l=[],c=0,u=e.childNodes,d=0;d<u.length;d++){var p=u[d];if(p.nodeType===Node.ELEMENT_NODE){var g=p.childNodes[0];if(g&&g.className.includes("user-ciq-selection-id")&&g.id){var h=g.textContent.length;this.ciqUrls.has(g.id)&&l.push({type:wd.a.URL,range:[c,c+h],value:this.ciqUrls.get(g.id)}),c+=h}else"BR"===p.nodeName?c++:this.isHVCAppChatV2Enabled&&"SPAN"===p.nodeName&&(c+=p.textContent.length)}else(""!=p.textContent.trim()||c>0)&&(c+=p.textContent.length)}return bd("generatCopilotOdslSignalLinks: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.value,", range: [").concat(t.range[0],", ").concat(t.range[1],"]")}),""))),l}bd("generatCopilotOdslSignalLinks: nothing to generate after cleanup")}},e.prototype.generateQueryAnnotations=function(e){var t,n;if(this.queryAnnotationSet.size<=0)bd("generateQueryAnnotations: nothing to generate");else{var r=Object(o.__spreadArray)([],Object(o.__read)(this.queryAnnotationSet.keys()),!1);try{for(var i=Object(o.__values)(r),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.queryAnnotationSet.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.queryAnnotationSet.size<=0)){for(var l=[],c=e.childNodes,u=0;u<c.length;u++){var d=c[u];if(d.nodeType===Node.ELEMENT_NODE){var p=d.childNodes[0];p&&p.className.includes("user-ciq-selection-id")&&p.id&&this.queryAnnotationSet.has(p.id)&&l.push(this.queryAnnotationSet.get(p.id))}}return bd("generateQueryAnnotations: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.id,", text: ").concat(t.text)}),""))),l}bd("generateQueryAnnotations: nothing to generate after cleanup")}},e.prototype.setHVCAppChatV2Enabled=function(e){this.isHVCAppChatV2Enabled=e},e}(),rp={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}},op={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},ip=n(2074),ap=n(2075);function sp(e){var t,n,r,o,i,a,s;switch(e.type){case ip.a.File:return i=(u=e).FileName,o=null!==(t=u.SpoId)&&void 0!==t?t:u.AccessUrl,"DownloadableUrl"===u.AccessUrlType&&(a=u.AccessUrl),a||"DownloadableUrl"!==u.AlternateAccessUrlType||(a=u.AlternateAccessUrl),a||(a=u.AccessUrl)||(a=u.AlternateAccessUrl),a?(s={QueryAnnotationType:ap.a.File,text:i,id:o},{type:ip.a.File,id:o,text:i,url:a,queryAnnotation:s}):(Od("File ECC injection failed due to missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)),void Sd(ld.FileECCInjectionError,"Missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)));case ip.a.People:return(null==(u=e)?void 0:u.EmailAddresses)&&u.DisplayName?(i=u.DisplayName,o=u.EmailAddresses[0],a=u.EmailAddresses[0]?"mailto:".concat(u.EmailAddresses[0]):"",s={QueryAnnotationType:ap.a.People,text:i,id:o},{type:ip.a.People,id:o,text:i,url:a,queryAnnotation:s}):(Od("People ECC injection failed due to missing EmailAddresses or DisplayName"),void Sd(ld.PeopleECCInjectionError,"Missing EmailAddresses or DisplayName"));case ip.a.Chat:if(!(null==(u=e)?void 0:u.ThreadId))return Od("Chat ECC injection failed due to missing ThreadId"),void Sd(ld.ChatECCInjectionError,"Missing ThreadId");if(void 0!==u.Name)i=u.Name;else if(u.ChatMembers){var l=u.ChatMembers.length-2,c=u.ChatMembers.slice(0,2).map((function(e){return e.DisplayName})).join(", ");l>0&&(c+=", +".concat(l)),i=c}else i="";return o=u.ThreadId,a="",s={QueryAnnotationType:ap.a.Chat,text:i,id:o},{type:ip.a.Chat,id:o,text:i,url:a,queryAnnotation:s};case ip.a.Message:return(null==(u=e)?void 0:u.ImmutableId)?(i=u.Subject,o=null===(n=u.ImmutableId)||void 0===n?void 0:n.Id,a="",s={QueryAnnotationType:ap.a.Message,text:i,id:o},{type:ip.a.Message,id:o,text:i,url:a,queryAnnotation:s}):(Od("Email ECC injection failed due to missing ImmutableId"),void Sd(ld.EmailECCInjectionError,"Missing ImmutableId"));case ip.a.Event:var u;return(null==(u=e)?void 0:u.OriginalId)?(i=u.Subject,o=u.OriginalId,a=null!==(r=u.WebLink)&&void 0!==r?r:"",s={QueryAnnotationType:ap.a.Event,text:i,id:o},{type:ip.a.Event,id:o,text:i,url:a,queryAnnotation:s}):(Od("Event ECC injection failed due to missing OriginalId"),void Sd(ld.EventECCInjectionError,"Missing OriginalId"));default:return Od("onItemSelected called with unsupported suggestion type ".concat(e.type)),void Sd(ld.UnsupportedSuggestionTypeError,"onItemSelected called with unsupported suggestion type ".concat(e.type))}}var lp,cp=function(){function e(e){this.editorProofingNode=void 0,this.editorClient=e}return e.prototype.shutdown=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),bd("Shutting down Editor"),[4,this.editorClient.shutDown()];case 1:return t.sent(),bd("Shutting down Editor completed successfully"),Ed(cd.EditorShutdownSuccess),[3,3];case 2:return e=t.sent(),Od("Exception shutting down Editor:"+JSON.stringify(e)+" Error message: "+yd(e)),Sd(ld.EditorShutdownException," Error message: "+yd(e)),[3,3];case 3:return this.editorClient=null,[2]}}))}))},e.prototype.initializeCiq=function(e,t){var n=this;return this.editorProofingNode&&this.uninitialize(t.queryCharToUse),bd("Initializing Editor for CIQ"),this.editorProofingNode=this.editorClient.spellCheck(e,".ignore-block"),this.editorClient.enableInlineSuggestionsMenu(t.entitiesEnabled,t.queryCharToUse,(function(e,n,r){bd("Suggestion selected from CIQ: "+JSON.stringify(e)+" in range: "+JSON.stringify(n)),t.onItemSelected({suggestion:sp(e),queryRange:n,parentHtmlElement:r})}),void 0,void 0,{fitToContent:!0},t.ExpanededECC?op:rp,void 0,void 0,void 0,void 0,t.ExpanededECC?void 0:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){var n,r,i,a,s;return Object(o.__generator)(this,(function(l){bd("".concat(null==e?void 0:e.length," suggestions found")),t.onSuggestionsUpdated&&t.onSuggestionsUpdated(e.length);try{for(n=Object(o.__values)(e),r=n.next();!r.done;r=n.next())(i=r.value).groupTitle=t.menuTitle,i.groupSubtitle=t.menuSubtitle}catch(e){a={error:e}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,e]}))}))},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.ExpanededECC),new np},e.prototype.uninitialize=function(e){this.editorProofingNode&&(bd("Uninitializing Editor"),this.editorClient.disableInlineSuggestionsMenu(e),this.editorClient.detach(this.editorProofingNode),this.editorProofingNode=void 0)},e.prototype.forceInvokeCIQMenu=function(e,t){if(this.editorProofingNode)try{bd("Starting to show CIQ for force invoke"),t&&this.setCurrentScope(t),this.editorClient.showExistingMenuAtCursor(1,e,!0),bd("Showing CIQ for force invoke"),Ed(cd.EditorCIQForceInvoke)}catch(e){Od("Exception showing CIQ for forced invoke:"+JSON.stringify(e)+" Error message: "+yd(e)),Sd(ld.CIQForcedInvokeException," Error message: "+yd(e))}},e.prototype.updateCurrentTheme=function(e){try{switch(bd("Starting to update theme for CIQ to ".concat(e)),e){case ju.light:case ju.dark:case ju.highContrast:case ju.custom:this.editorClient.updateCurrentTheme(e);break;default:throw"Unexpected themeType: ".concat(e)}bd("Theme updated for CIQ"),Ed(cd.EditorCIQThemeUpdate)}catch(e){Od("Exception updating theme for CIQ:"+JSON.stringify(e)+" Error message: "+yd(e)),Sd(ld.CIQThemeUpdateException," Error message: "+yd(e))}},e.prototype.normalizeCIQEntity=function(e){switch(!0){case/file/i.test(e):return Id.a.File;case/(people)|(person)/i.test(e):return Id.a.People;case/(event)|(meeting)/i.test(e):return Id.a.Event;case/chat/i.test(e):return Id.a.Chat;case/(message)|(email)/i.test(e):return Id.a.Message;case/(topic)/i.test(e):return Id.a.Topic;default:return}},e.prototype.setCurrentScope=function(e){if(this.editorClient){var t=this.normalizeCIQEntity(e);if(void 0!==t){var n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}else bd("Invoked setEntityScope with unsupported entity type ".concat(e))}},e}(),up=function(){function e(){}return e.prototype.bootstrap=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:i=e.settings.isDogfoodEnvironment,vd=i,o=e.telemLogger,Cd=o,bd("bootstrapEditor called"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,Object(ed.a)(md(e.settings,e.entitiesSupported),e.telemSink,e.augloopSession)];case 2:return[4,(t=r.sent()).initializeSDK()];case 3:return r.sent(),[4,t.initializeUX(document)];case 4:return r.sent(),this.chatEditor=new cp(t),bd("bootstrapEditor completed successfully"),Ed(cd.EditorBootstrapSuccess),[3,6];case 5:throw n=r.sent(),Od("Exception bootstrapping Editor:"+JSON.stringify(n)+" Error message: "+yd(n)),Sd(ld.EditorBootstrapException," Error message: "+yd(n)),n;case 6:return[2,this.chatEditor]}var o,i}))}))},e.prototype.shutdown=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,this.chatEditor.shutdown()]}))}))},e}(),dp=function(){function e(){}return e.prototype.createInstance=function(){return new up},e}(),pp=n(573),gp=function(e){return le.a.createElement("svg",{className:e,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},le.a.createElement("g",{clipPath:"url(#clip0_741_74312)"},le.a.createElement("path",{d:"M10 18.4961C9.21875 18.4961 8.4668 18.3952 7.74414 18.1934C7.02148 17.9915 6.3444 17.7051 5.71289 17.334C5.08138 16.9629 4.50846 16.5202 3.99414 16.0059C3.47982 15.4915 3.03711 14.9186 2.66602 14.2871C2.29492 13.6556 2.00846 12.9785 1.80664 12.2559C1.60482 11.5332 1.50391 10.7812 1.50391 10C1.50391 9.21875 1.60482 8.4668 1.80664 7.74414C2.00846 7.02148 2.29492 6.3444 2.66602 5.71289C3.03711 5.08138 3.47982 4.50846 3.99414 3.99414C4.50846 3.47982 5.08138 3.03711 5.71289 2.66602C6.3444 2.29492 7.02148 2.00846 7.74414 1.80664C8.4668 1.60482 9.21875 1.50391 10 1.50391C10.7812 1.50391 11.5332 1.60482 12.2559 1.80664C12.9785 2.00846 13.6556 2.29492 14.2871 2.66602C14.9186 3.03711 15.4915 3.47982 16.0059 3.99414C16.5202 4.50846 16.9629 5.08138 17.334 5.71289C17.7051 6.3444 17.9915 7.02148 18.1934 7.74414C18.3952 8.4668 18.4961 9.21875 18.4961 10C18.4961 10.7812 18.3952 11.5332 18.1934 12.2559C17.9915 12.9785 17.7051 13.6556 17.334 14.2871C16.9629 14.9186 16.5202 15.4915 16.0059 16.0059C15.4915 16.5202 14.9186 16.9629 14.2871 17.334C13.6556 17.7051 12.9785 17.9915 12.2559 18.1934C11.5332 18.3952 10.7812 18.4961 10 18.4961Z",fill:"#FAFAFA"}),le.a.createElement("path",{d:"M19.0039 10C19.0039 10.8268 18.8965 11.6243 18.6816 12.3926C18.4668 13.1543 18.1641 13.8704 17.7734 14.541C17.3828 15.2051 16.9141 15.8105 16.3672 16.3574C15.8203 16.9043 15.2148 17.3763 14.5508 17.7734C13.8802 18.1641 13.1641 18.4668 12.4023 18.6816C11.6341 18.8965 10.8366 19.0039 10.0098 19.0039C9.18294 19.0039 8.38542 18.8965 7.61719 18.6816C6.84896 18.4668 6.13281 18.1641 5.46875 17.7734C4.79818 17.3828 4.18945 16.9141 3.64258 16.3672C3.08919 15.8203 2.61719 15.2148 2.22656 14.5508C1.83594 13.8802 1.5332 13.1608 1.31836 12.3926C1.10352 11.6243 0.996094 10.8268 0.996094 10C0.996094 9.17318 1.10352 8.37891 1.31836 7.61719C1.5332 6.84896 1.83594 6.13281 2.22656 5.46875C2.61719 4.79818 3.08919 4.18945 3.64258 3.64258C4.18945 3.08919 4.79818 2.61719 5.46875 2.22656C6.13281 1.83594 6.84896 1.5332 7.61719 1.31836C8.37891 1.10352 9.17318 0.996094 10 0.996094C10.8268 0.996094 11.6243 1.10352 12.3926 1.31836C13.1543 1.5332 13.8704 1.83594 14.541 2.22656C15.2051 2.61719 15.8138 3.08919 16.3672 3.64258C16.9141 4.18945 17.3828 4.79818 17.7734 5.46875C18.1641 6.13281 18.4668 6.84896 18.6816 7.61719C18.8965 8.37891 19.0039 9.17318 19.0039 10ZM10 17.998C10.2344 17.998 10.4883 17.8841 10.7617 17.6562C11.0286 17.4284 11.2891 17.0996 11.543 16.6699C11.7904 16.2402 12.0215 15.7161 12.2363 15.0977C12.4512 14.4792 12.6237 13.7793 12.7539 12.998H7.24609C7.3763 13.7793 7.54883 14.4792 7.76367 15.0977C7.97852 15.7161 8.21289 16.2402 8.4668 16.6699C8.71419 17.0996 8.97461 17.4284 9.24805 17.6562C9.51497 17.8841 9.76562 17.998 10 17.998ZM12.9004 12.002C12.9329 11.6829 12.959 11.3574 12.9785 11.0254C12.9915 10.6934 12.998 10.3516 12.998 10C12.998 9.64844 12.9915 9.30664 12.9785 8.97461C12.959 8.64258 12.9329 8.31706 12.9004 7.99805H7.09961C7.06706 8.31706 7.04427 8.64258 7.03125 8.97461C7.01172 9.30664 7.00195 9.64844 7.00195 10C7.00195 10.3516 7.01172 10.6934 7.03125 11.0254C7.04427 11.3574 7.06706 11.6829 7.09961 12.002H12.9004ZM2.00195 10C2.00195 10.6771 2.08659 11.3444 2.25586 12.002H6.10352C6.07096 11.6764 6.04492 11.3477 6.02539 11.0156C6.00586 10.6836 5.99609 10.3451 5.99609 10C5.99609 9.65495 6.00586 9.31641 6.02539 8.98438C6.04492 8.65234 6.07096 8.32357 6.10352 7.99805H2.25586C2.08659 8.6556 2.00195 9.32292 2.00195 10ZM10 2.00195C9.76562 2.00195 9.51497 2.11589 9.24805 2.34375C8.97461 2.57161 8.71419 2.90039 8.4668 3.33008C8.21289 3.75977 7.97852 4.28385 7.76367 4.90234C7.54883 5.52083 7.3763 6.2207 7.24609 7.00195H12.7539C12.6237 6.2207 12.4512 5.52083 12.2363 4.90234C12.0215 4.28385 11.7904 3.75977 11.543 3.33008C11.2891 2.90039 11.0286 2.57161 10.7617 2.34375C10.4883 2.11589 10.2344 2.00195 10 2.00195ZM13.8965 7.99805C13.929 8.32357 13.9551 8.65234 13.9746 8.98438C13.9941 9.31641 14.0039 9.65495 14.0039 10C14.0039 10.3451 13.9941 10.6836 13.9746 11.0156C13.9551 11.3477 13.929 11.6764 13.8965 12.002H17.7441C17.9134 11.3444 17.998 10.6771 17.998 10C17.998 9.32292 17.9134 8.6556 17.7441 7.99805H13.8965ZM17.4121 7.00195C17.1777 6.42253 16.8815 5.88216 16.5234 5.38086C16.1654 4.87305 15.7585 4.41732 15.3027 4.01367C14.8405 3.60352 14.3359 3.25195 13.7891 2.95898C13.2422 2.65951 12.6628 2.42839 12.0508 2.26562C12.4479 2.79948 12.7962 3.47331 13.0957 4.28711C13.3887 5.0944 13.6133 5.99935 13.7695 7.00195H17.4121ZM7.94922 2.26562C7.33724 2.42839 6.75781 2.65951 6.21094 2.95898C5.66406 3.25195 5.16276 3.60352 4.70703 4.01367C4.24479 4.41732 3.83464 4.87305 3.47656 5.38086C3.11849 5.88216 2.82227 6.42253 2.58789 7.00195H6.23047C6.38672 5.99935 6.61458 5.0944 6.91406 4.28711C7.20703 3.47331 7.55208 2.79948 7.94922 2.26562ZM2.58789 12.998C2.82227 13.5775 3.11849 14.1211 3.47656 14.6289C3.83464 15.1302 4.24479 15.5859 4.70703 15.9961C5.16276 16.3997 5.66406 16.7513 6.21094 17.0508C6.75781 17.3438 7.33724 17.5716 7.94922 17.7344C7.55208 17.2005 7.20703 16.5299 6.91406 15.7227C6.61458 14.9089 6.38672 14.0007 6.23047 12.998H2.58789ZM12.0508 17.7344C12.6628 17.5716 13.2422 17.3438 13.7891 17.0508C14.3359 16.7513 14.8405 16.3997 15.3027 15.9961C15.7585 15.5859 16.1654 15.1302 16.5234 14.6289C16.8815 14.1211 17.1777 13.5775 17.4121 12.998H13.7695C13.6133 14.0007 13.3887 14.9089 13.0957 15.7227C12.7962 16.5299 12.4479 17.2005 12.0508 17.7344Z",fill:"#3A3A38"})),le.a.createElement("defs",null,le.a.createElement("clipPath",{id:"clip0_741_74312"},le.a.createElement("rect",{width:"20",height:"20",fill:"white"}))))},hp=function(e){return le.a.createElement("svg",{className:e,width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},le.a.createElement("g",{clipPath:"url(#clip0_98326_1271)"},le.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint0_linear_98326_1271)"}),le.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint1_linear_98326_1271)"}),le.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint2_radial_98326_1271)"}),le.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint3_linear_98326_1271)"}),le.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint4_radial_98326_1271)"}),le.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint5_linear_98326_1271)"})),le.a.createElement("defs",null,le.a.createElement("linearGradient",{id:"paint0_linear_98326_1271",x1:"9.52494",y1:"5.71629",x2:"4.86462",y2:"20.1745",gradientUnits:"userSpaceOnUse"},le.a.createElement("stop",{stopColor:"#AE7FE2"}),le.a.createElement("stop",{offset:"1",stopColor:"#0078D4"})),le.a.createElement("linearGradient",{id:"paint1_linear_98326_1271",x1:"7.5417",y1:"16.3092",x2:"6.72169",y2:"14.7676",gradientUnits:"userSpaceOnUse"},le.a.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),le.a.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),le.a.createElement("radialGradient",{id:"paint2_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.98808 16.3592) rotate(-13.1869) scale(13.9366 10.8259)"},le.a.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),le.a.createElement("stop",{offset:"1",stopColor:"#5E438F"})),le.a.createElement("linearGradient",{id:"paint3_linear_98326_1271",x1:"16.6314",y1:"10.9555",x2:"15.8357",y2:"12.2201",gradientUnits:"userSpaceOnUse"},le.a.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),le.a.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),le.a.createElement("radialGradient",{id:"paint4_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9836 11.3541) rotate(-160.581) scale(16.4238 16.5011)"},le.a.createElement("stop",{stopColor:"#50E6FF"}),le.a.createElement("stop",{offset:"1",stopColor:"#436DCD"})),le.a.createElement("linearGradient",{id:"paint5_linear_98326_1271",x1:"5.49905",y1:"5.87339",x2:"8.12498",y2:"5.87339",gradientUnits:"userSpaceOnUse"},le.a.createElement("stop",{offset:"0.9999",stopColor:"#2D3F80"}),le.a.createElement("stop",{offset:"1",stopColor:"#436DCD",stopOpacity:"0"})),le.a.createElement("clipPath",{id:"clip0_98326_1271"},le.a.createElement("rect",{y:"0.75",width:"20",height:"20",rx:"2",fill:"white"}))))},fp=le.a.createElement("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},le.a.createElement("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM11 7h2v2h-2V7zm0 3h2v6h-2V10z"}));!function(e){e.CurrentContext="CurrentContext",e.Work="Work",e.Web="Web"}(lp||(lp={}));var mp,vp=function(e){var t;return(t={})[lp.CurrentContext]=function(e){return le.a.createElement("svg",{className:e,width:"16",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},le.a.createElement("path",{d:"M2 0.720703C0.89543 0.720703 0 1.61613 0 2.7207V18.7207C0 19.8253 0.895431 20.7207 2 20.7207H14C15.1046 20.7207 16 19.8253 16 18.7207V8.54847C16 8.01804 15.7893 7.50933 15.4142 7.13426L9.58645 1.30649C9.21137 0.931417 8.70267 0.720703 8.17223 0.720703H2ZM1.5 2.7207C1.5 2.44456 1.72386 2.2207 2 2.2207H8V6.7207C8 7.82527 8.89543 8.7207 10 8.7207H14.5V18.7207C14.5 18.9968 14.2761 19.2207 14 19.2207H2C1.72386 19.2207 1.5 18.9968 1.5 18.7207V2.7207ZM13.3793 7.2207H10C9.72386 7.2207 9.5 6.99685 9.5 6.7207V3.34136L13.3793 7.2207Z"}))}(e),t[lp.Work]=function(e){return le.a.createElement("svg",{className:e,width:"18",height:"19",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},le.a.createElement("path",{d:"M7.25 2.2207H10.75C11.1642 2.2207 11.5 2.55649 11.5 2.9707V4.7207H6.5V2.9707C6.5 2.55649 6.83579 2.2207 7.25 2.2207ZM5 2.9707V4.7207H3.25C1.45507 4.7207 0 6.17578 0 7.9707V15.4707C0 17.2656 1.45507 18.7207 3.25 18.7207H14.75C16.5449 18.7207 18 17.2656 18 15.4707V7.9707C18 6.17578 16.5449 4.7207 14.75 4.7207H13V2.9707C13 1.72806 11.9926 0.720703 10.75 0.720703H7.25C6.00736 0.720703 5 1.72806 5 2.9707ZM16.5 7.9707V9.4707C16.5 10.4372 15.7165 11.2207 14.75 11.2207H11V10.7207C11 10.1684 10.5523 9.7207 10 9.7207H8C7.44772 9.7207 7 10.1684 7 10.7207V11.2207H3.25C2.2835 11.2207 1.5 10.4372 1.5 9.4707V7.9707C1.5 7.0042 2.2835 6.2207 3.25 6.2207H14.75C15.7165 6.2207 16.5 7.0042 16.5 7.9707ZM16.5 12.2098V15.4707C16.5 16.4372 15.7165 17.2207 14.75 17.2207H3.25C2.2835 17.2207 1.5 16.4372 1.5 15.4707V12.2098C2.00515 12.5332 2.60568 12.7207 3.25 12.7207H7C7 13.273 7.44772 13.7207 8 13.7207H10C10.5523 13.7207 11 13.273 11 12.7207H14.75C15.3943 12.7207 15.9949 12.5332 16.5 12.2098Z"}))}(e),t},bp={direction:pp.a.bidirectional,isCircularNavigation:!0,handleTabKey:pp.b.all};!function(e){e.Shimmer="shimmer",e.Blocked="blocked",e.Enabled="enabled",e.Disabled="disabled",e.Loading="loading"}(mp||(mp={}));class yp{constructor(){}static getInstance(){return yp.instance||(yp.instance=new yp),yp.instance}setALSession(e){this.alSession=e}getALSession(){return this.alSession}}class Cp{constructor(e,t){this.realTimeConnection=e,this.realTimeConnection.SetErrorCallback(t),this.realTimeConnection.SetAudioBufferCallback((e=>this.OnAudioBufferCallback(e)))}Initialize(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){yield this.realTimeConnection.InitializeConnection(e)}))}StartMicrophone(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.StartMicrophone()}))}Pause(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.PauseConnection()}))}Resume(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.realTimeConnection.ResumeConnection()}))}Close(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return yield this.realTimeConnection.PauseConnection(),this.realTimeConnection.CloseConnection()}))}OnAudioBufferCallback(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){console.log("DevLog: OnAudioBufferCallback")}))}}var Op=n(2061),Sp=n(1159),Ep=n(1784),xp=n(893),Ip=n(2062),wp=n(396);const Tp=3,kp=5e3,jp="granted";var Pp;function Ap(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Pp||(Pp={}));Op.a.dictationSettings={dictationLanguage:"en-US",useAutoPunctuation:"Intelligent",useCorrections:"true",properties:{"SpeechContext-PhraseOutput.interimResults.resultType":"Hypothesis",setFeature:"emailplm,offtrt,copilot",Profanity:"masked","SpeechConfig-Context.DataCollection.Mode":"0"}};class _p{constructor(e,t,n){this.speechToTextClient=null,this.voiceSession=null,this.isVoiceSessionActive=!1,this.closeConnectionPromise=null,this.locale=null,this.attempt=0,this.fdSpeechClientObserver={onSpeechSessionStarted:e=>Object(o.__awaiter)(this,void 0,void 0,(function*(){try{null!=e&&console.log("Transcription speech session ID: ",e.speechSessionId)}catch(e){this.onError(e)}})),onSpeechSessionStopped:()=>{this.speechEventEmitter.emit("SpeechSessionStopped")},onFinalText:e=>this.OnFinalResult(e),onFragmentText:e=>this.OnPartialResult(e),onSpeechRecognitionStarted:()=>{},onError:e=>{if(-1==(null==e?void 0:e.toString().indexOf("ErrorAugloopActivateAnnotations"))||this.attempt>=3)try{if(e===Sp.a.ErrorAudioCaptureAsync||e===Sp.a.ErrorAudioDevicesNotFoundError||e===Sp.a.ErrorAudioNotReadableError||e===Sp.a.ErrorAudioPermissionDeniedError)return;const t=new Error("IAugloopSpeechObserverDecorator.onError: ");this.onError(t)}catch(e){this.onError(e)}},onSpeechEnd:()=>{},onEventUpdate:e=>{},showDictationWarning:()=>{},onWarning:e=>{},showPermissionPrompt:()=>{}},this.locale=n,this.onError=e=>{throw e},this.onAudioBuffer=e=>{},this.initPromise=this.PerformInitializeConnection(),this.speechEventEmitter=new wp.EventEmitter,this.onTranscriptText=e,this.onTranscriptPartialText=t,Op.a.dictationSettings.dictationLanguage=this.locale}PerformInitializeConnection(){var e;return Object(o.__awaiter)(this,void 0,void 0,(function*(){yield this.InitializeSpeechToTextClient(),this.voiceSession=new Ep.a(void 0,this.fdSpeechClientObserver,!0,void 0,void 0,Ip.a.Dictation,null===(e=yp.getInstance())||void 0===e?void 0:e.getALSession())}))}SetAudioBufferCallback(e){this.onAudioBuffer=e}SetErrorCallback(e){this.onError=e}InitializeConnection(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.attempt=0,this.locale=e,this.initPromise}))}StartMicrophone(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.ResumeConnection()}))}ResumeConnection(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.isVoiceSessionActive)return Promise.resolve();if(yield this.initPromise,this.isVoiceSessionActive=!0,null==this.locale)throw new Error("Reached resume connection without a locale. Did we really initilize AugloopRealTimeTranscriptionConnection?");Op.a.dictationSettings.dictationLanguage=this.locale,yield this.voiceSession.startVoiceSessionFromMicrophoneInput((e=>this.OnAudioBufferCallback(e)),null,null)}))}PauseConnection(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(!this.isVoiceSessionActive)return Promise.resolve();yield this.initPromise,this.isVoiceSessionActive=!1,yield this.voiceSession.stopMicrophoneInputAsync(),yield this.voiceSession.stopVoiceSession()}))}CloseConnection(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return null!=this.closeConnectionPromise||(this.closeConnectionPromise=new Promise(((e,t)=>Object(o.__awaiter)(this,void 0,void 0,(function*(){try{this.voiceSession&&(this.voiceSession.endVoiceSession(),this.voiceSession.endVoiceSession(),yield this.WaitForSessionEnd()),this.speechToTextClient&&(yield this.speechToTextClient.uninitializeAsync()),this.closeConnectionPromise=null,e()}catch(e){t(e)}}))))),this.closeConnectionPromise}))}WaitForSessionEnd(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const e=new Promise(((e,t)=>{setTimeout((()=>{try{this.voiceSession&&this.voiceSession.endVoiceSession(),e()}catch(e){t(e)}}),3e4)})),t=new Promise(((e,t)=>{try{this.speechEventEmitter.once("SpeechSessionStopped",e)}catch(e){t(e)}}));yield Promise.race([e,t])}))}OnFinalResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("transcript text "+n),this.onTranscriptText(n)}catch(e){this.onError(e)}}OnPartialResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);console.log("RECOGNIZED: "+n),this.onTranscriptPartialText(""+n)}catch(e){this.onError(e)}}InitializeSpeechToTextClient(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){null!=this.closeConnectionPromise&&(yield this.closeConnectionPromise),this.speechToTextClient=new xp.a(void 0,this.fdSpeechClientObserver,!0,!0,!0,Ip.a.Dictation,yp.getInstance().getALSession());let e=0;do{e>0&&(yield Ap(kp)),this.attempt++,yield this.speechToTextClient.initializeAsync([xp.b.PartialResult,xp.b.FinalResult])}while(!this.speechToTextClient.initialized&&e++<Tp)}))}OnAudioBufferCallback(e){this.onAudioBuffer(e)}}class Dp{static createInstance(e,t,n){null==this.instance&&(this.instance=new _p(e,t,n))}static GetInstance(){return this.instance}}class Lp{static GetInstance(){return null==this.instance&&(this.instance=new Cp(Dp.GetInstance(),(e=>{}))),this.instance}}var Mp;!function(e){e[e.Completed=0]="Completed",e[e.Canceled=1]="Canceled"}(Mp||(Mp={}));class Bp{constructor(e){this.isCanceled=!1,this.tasks=e}ExecuteTaskListSequentially(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.isCanceled)return{status:Mp.Canceled};let e=null;if(this.tasks)for(const t of this.tasks)try{if(e=yield t(e),this.isCanceled)return{status:Mp.Canceled}}catch(e){if(this.isCanceled)return{status:Mp.Canceled};throw e}return{status:Mp.Completed,result:e}}))}Cancel(){this.isCanceled=!0}}class Rp{static getInstance(){return Rp._instance||(Rp._instance=new Rp),Rp._instance}startVoiceInputTimer(e,t){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((()=>Object(o.__awaiter)(this,void 0,void 0,(function*(){yield Up(t),console.log("Voice input timed out")}))),e)}stopVoiceInputTimer(){this.timerId&&clearTimeout(this.timerId)}}const Fp=(e,t,n,r,i,a)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){if(yp.getInstance().setALSession(a),Dp.createInstance(t,n,e),null==Dp.GetInstance())throw new Error("realTimeTranscriptionConnection is null");const s=new Bp([()=>Lp.GetInstance().Initialize(e),()=>Hp(r)]);var l;yield(l=s,Object(o.__awaiter)(void 0,void 0,void 0,(function*(){return yield null==l?void 0:l.ExecuteTaskListSequentially()}))),i(!1)}));function Np(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){let e=null;if(navigator.permissions)try{e=yield navigator.permissions.query({name:"microphone"})}catch(e){}return e}))}const Hp=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield Np();console.log("Microphone Permission Status = "+(null==t?void 0:t.state)),"denied"===(null==t?void 0:t.state)?e(Pp.Uninitialized):(null==t?void 0:t.state)===jp&&e(Pp.Enabled)})),Up=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){yield Lp.GetInstance().Pause(),e(!1)})),Vp=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){null!=Dp.GetInstance()&&(yield Up(e),Rp.getInstance().stopVoiceInputTimer())})),zp=(e,t,n,r,i)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){try{yield Lp.GetInstance().Resume(),n(!1),r(Pp.Enabled),i(!e),Rp.getInstance().startVoiceInputTimer(t,i)}catch(e){console.error("Error occurred - "+e),"ErrorAudioPermissionDeniedError"===e&&(yield Lp.GetInstance().Pause(),n(!0)),r(Pp.Uninitialized)}})),Gp=(e,t)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){null!=Dp.GetInstance()&&Rp.getInstance().startVoiceInputTimer(e,t)})),Wp="en-US",Qp=["ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-OM","ar-QA","ar-SA","ar-SY","ar-AE","bg-BG","ca-ES","zh-HK","zh-CN","zh-TW","hr-HR","cs-CZ","da-DK","nl-NL","en-AU","en-CA","en-HK","en-IN","en-IE","en-NZ","en-PH","en-SG","en-ZA","en-GB","en-US","et-EE","fi-FI","fr-CA","fr-FR","de-DE","el-GR","gu-IN","hi-IN","hu-HU","ga-IE","it-IT","ja-JP","ko-KR","lv-LV","lt-LT","mt-MT","mr-IN","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-US","es-VE","sv-SE","ta-IN","te-IN","th-TH","tr-TR","af-ZA","am-ET","bn-IN","cy-GB","eu-ES","fa-IR","fil-PH","gl-ES","he-IL","hy-AM","id-ID","is-IS","ka-GE","kk-KZ","km-KH","kn-IN","lo-LA","mk-MK","ml-IN","ms-MY","ne-NP","pa-IN","sq-AL","uk-UA","vi-VN"];function qp(e){let t="en-US";return t=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}}(function(e){const t=e.split("-");if(1==t.length)return t[0].toLowerCase();t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase());if(t.length>2)for(let e=1;e<t.length-1;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1).toLowerCase();return t.join("-")}(e)),-1==Qp.indexOf(t)&&(t=function(e){const t=e.split("-");for(let e=0;e<Qp.length;e++){const n=Qp[e];if(t[0]==n.split("-")[0])return n}return e}(t)),-1==Qp.indexOf(t)&&(t=Wp),console.log("STT Language is "+t),t}const Kp=e=>{switch(e.toLowerCase()){case"zh-hk":case"zh-cn":case"zh-tw":case"ja-jp":return!1;default:return!0}};var Yp,Zp=n(3357),Jp=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return le.a.createElement(he.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},le.a.createElement(me.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=Zp.e,n=Zp.d,r=Object(Oe.a)(n,t),le.a.createElement(r,null))},onClick:a,disabled:i}))},Xp=Object(ue.a)({inputBanner:Object(o.__assign)(Object(o.__assign)({minHeight:"32px"},De.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"}),inputBannerInInputV3:{minHeight:"32px",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomStyle:"none"}}),$p=function(e){var t=Xp();return e?t.inputBannerInInputV3:t.inputBanner},eg=function(e){var t=e.chatInputBannerString,n=e.isInputV3Enabled,r=void 0!==n&&n;return le.a.createElement(Vn.a,{className:$p(r)},le.a.createElement(Nn.a,null,t))},tg=n(1449),ng={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",DIALOG:"dialog",TOOLTIP:"tooltip"},rg=function(){return"undefined"!=typeof OfficeaicopilotStrings},og=function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{augloopSession:t})},ig=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return e?(Object(tg.b)(e),[4,Object(tg.a)()]):[2,null];case 1:return[2,t.sent().getSession()]}}))}))},ag=function(e,t,n,r,i){var a;void 0===r&&(r=!1),void 0===i&&(i=void 0);var s=null==n?void 0:n.current;if(!s)return"";var l=Object(o.__read)(function(e,t){var n=-1,r=t.find((function(t){var r=null==e?void 0:e.toLocaleLowerCase().indexOf(t().toLocaleLowerCase());return-1!==r&&(n=r,!0)}));return[r?r():"",n]}(e,t),2),c=l[0],u=l[1],d=Object(o.__read)(function(e,t,n){var r="",o="",i=e;return t.length>0&&-1!==n&&(r=n>0?e.slice(0,n):"",o=t,i=e.slice(n+t.length)),[r,o,i]}(e,c,u),3),p=d[0],g=d[1],h=d[2];if(r||c.length>0){if(s.innerText="",e.includes("{")&&e.includes("}"))a=Object(o.__read)(function(e){var t=e.match(/\{(.*?)\}/),n="",r="",o=e;if(t){var i=e.indexOf(t[0]);n=e.slice(0,i),r=t[1],o=e.slice(i+t[0].length)}return[n,r,o]}(e),3),p=a[0],g=a[1],h=a[2],0===c.length&&(c=g);else if(0===c.length)return void(s.innerText=e);!function(e,t,n,r,i){if(void 0===i&&(i=void 0),t.length>0){var a=document.createTextNode(t);e.appendChild(a)}var s=document.createElement("span"),l=document.createElement("span");l.style.backgroundColor=Le.a.colorNeutralBackground3,l.style.color=Le.a.colorNeutralForeground2,l.contentEditable="false",l.textContent=n,l.style.borderRadius=Mg,l.style.padding=Bg,s.appendChild(l);var c=new MutationObserver((function(t,r){var a,l;try{for(var c=Object(o.__values)(t),u=c.next();!u.done;u=c.next())"childList"===u.value.type&&(Array.from(e.children).includes(s)||(i&&i(n,!1),r.disconnect()))}catch(e){a={error:e}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(a)throw a.error}}}));c.observe(e,{childList:!0}),e.appendChild(s),0===r.length&&(r=" ");var u=document.createTextNode(r);e.appendChild(u)}(s,p,g,h,i)}else s.innerText=e;return c},sg=function(){return rg()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area"},lg=function(){return rg()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},cg=function(){return rg()?OfficeaicopilotStrings.SubmitButtonTitle:"Send"},ug=function(){return rg()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own"},dg="",pg="br",gg="copilot-chat-input",hg=1e4,fg=function(){return rg()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},mg=" ",vg=function(){return rg()?OfficeaicopilotStrings.DefaultCIQButtonTitle:"Attach"},bg=function(){return rg()?OfficeaicopilotStrings.DefaultGroundingButtonTitle:"Manage search and plugins"},yg=function(){return rg()?OfficeaicopilotStrings.GroundingSearchAndPlugins:"Search and plugins"},Cg=function(){return rg()?OfficeaicopilotStrings.PreviewFlagLabel:"Preview"},Og=function(){return rg()?OfficeaicopilotStrings.GroundingPluginFlyoutInfo:"Plugins allow Copilot to reference apps on your behalf. Copilot may share some of your Microsoft 365 enterprise data with plugins you’ve turned on."},Sg=function(){return rg()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoTooltip:"Microsoft 365 enterprise data includes Office applications, SharePoint sites, cloud files, communications, and more. All configured by your IT admin."},Eg=function(){return rg()?OfficeaicopilotStrings.AdminBlockedPluginInfoTooltipLabel:"The service required to use this plugin is turned off for your organization."},xg=function(){return rg()?OfficeaicopilotStrings.WorkPluginLabel:"Microsoft 365 data"},Ig=function(){return rg()?OfficeaicopilotStrings.WebContentPluginLabel:"Web content"},wg=function(){return rg()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoLabel:"Info"},Tg=function(){return"Create a new presentation"},kg=function(){return"Create the new presentation"},jg=function(){return"Add a slide about"},Pg=function(){return"Add an agenda slide"},Ag=function(){return"Create a presentation"},_g=function(){return"Organize the presentation"},Dg=function(){return"Organize this presentation"},Lg=function(){return"Add an image of"},Mg="4px",Bg="0px 4px 4px 4px";!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(Yp||(Yp={}));var Rg,Fg,Ng,Hg=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralForeground4,alignItems:"flex-start"},on.a.body1),{fontStyle:"normal"}),De.a.gap("1px")),{content:"attr(title)"}),Ug={color:Le.a.colorNeutralForegroundDisabled,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},Vg=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},on.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),De.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(o.__assign)({},De.a.outline(0))}),zg={userInput:Object(o.__assign)(Object(o.__assign)({},Vg),{"&:focus":Object(o.__assign)({},De.a.outline(0)),"&:focus::after":Hg,"&::after":Hg})},Gg={userInput:Object(o.__assign)(Object(o.__assign)({},Vg),{"&:focus":Object(o.__assign)({},De.a.outline(0))})},Wg={userInput:{"&:focus::after":Ug,"&::after":Ug}},Qg=Object(ue.a)(Gg),qg=Object(ue.a)(zg),Kg=Object(ue.a)(Wg),Yg=function(e){var t=Object(o.__read)(Object(se.useState)(!1),2),n=t[0],r=t[1];return le.a.createElement("div",{onMouseEnter:function(){r(!0)},onMouseLeave:function(){r(!1)},style:{position:"relative"}},le.a.createElement("button",{style:{position:"absolute",left:"40px",visibility:n?"visible":"hidden"},onClick:e.removeImageCallback},"X"),le.a.createElement("img",{src:e.imageDataUri,alt:"Visual part of the prompt",width:"50px"}))},Zg=le.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,r=e.placeholderText,i=e.chatInputTabIndex,a=e.isDisabled,s=e.isHVCAppChatV2Enabled,l=e.hvcPromptStrings,c=e.onChatInputHVCPromptUpdated,u=e.handleKeyDown,d=e.handleKeyUp,p=e.handleOnPaste,g=e.handleOnBeforeInput,h=e.handleOnInput,f=e.handleOnCompositionEnd,m=e.handleOnFocusTextArea,v=e.handleOnChatInputControlMount,b=e.handleOnChatInputControlUnmount,y=Object(se.useRef)(),C=null!=l?l:[Tg,kg,jg,Pg,Ag,_g,Dg,Lg];Object(se.useImperativeHandle)(t,(function(){return{setInputText:function(e,t){void 0===t&&(t=!1),S(e,t),O()},updateInputText:function(e,t){switch(t){case Yp.InsertAtCursor:x(e);break;case Yp.Replace:S(e)}},getInputText:function(){return I()},getInputSpanElement:function(){return y.current},setFocus:function(){w()},getGhostText:function(){var e,t;return null!==(t=null===(e=y.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;null===(t=y.current)||void 0===t||t.setAttribute("title",e),_(e===dg?T.current.userInput:j.current.userInput)},scrollToBottom:O,addImage:function(e){M([e])},removeImages:function(){M([])},getImages:function(){return L}}}));var O=function(){var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},S=function(e,t){void 0===t&&(t=!1);var n=y.current;if(n)if(s&&e.length>0){var r=ag(e,C,y,t,c);c(r,!0)}else n.innerText=e},x=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1),O()}};var I=function(){var e,t,n=dg,r=y.current;return r&&(t=dg,(e=r).childNodes&&e.childNodes.length>0&&e.childNodes.forEach((function(e){e.tagName&&e.tagName.toLowerCase()===pg?t+="\n":t+=e.textContent})),n=t),n},w=function(){if(!a){var e=y.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(se.useEffect)((function(){return v&&v(),function(){b&&b()}}),[]);var T=Object(se.useRef)(Qg()),k=Object(se.useRef)(Kg()),j=Object(se.useRef)(qg()),P=Object(o.__read)(Object(se.useState)(j.current.userInput),2),A=P[0],_=P[1];Object(se.useEffect)((function(){a&&_(Object(E.a)(j.current.userInput,k.current.userInput))}),[a]),Object(se.useEffect)((function(){n&&_(Object(E.a)(T.current.userInput,n))}),[n]);var D=Object(o.__read)(Object(se.useState)([]),2),L=D[0],M=D[1];return le.a.createElement(le.a.Fragment,null,L.map((function(e,t){return le.a.createElement(Yg,{imageDataUri:e,key:t,removeImageCallback:function(){L.splice(t,1),M(L)}})})),le.a.createElement("span",{ref:y,className:A,title:r,"aria-label":r,"aria-disabled":a,role:"textbox",tabIndex:i,contentEditable:!a,suppressContentEditableWarning:!a,onKeyDown:u,onKeyUp:d,onPaste:p,onBeforeInput:g,onInput:h,onCompositionEnd:f,onFocus:m}))})),Jg=n(2797),Xg=n(3513),$g=n(3445),eh=Object(Jd.a)({palette:Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),th=(Object(Jd.a)({palette:Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(){return Rg}),nh=function(e){var t=e.themePalette,n=e.isDarkMode,r=e.dir,i=void 0===r?void 0:r,a=e.children,s=e.className,l=Object(o.__assign)(Object(o.__assign)({},eh.palette),t),c=Object($g.a)(l),u=n?Object(Kd.a)(c):Object(Yd.a)(c);return Rg=u,se.createElement(ae.a,{className:s,theme:u,dir:i},a)},rh=function(e,t){var n=Object(Oe.a)(t,e);return le.a.createElement(n,null)},oh=function(e){var t=e;return le.a.createElement(t,null)},ih=n(682),ah=n(3595),sh={popOver:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",maxHeight:"390px"},De.a.overflow("hidden","auto")),De.a.margin("right: 20")),{backgroundColor:Le.a.colorNeutralBackground1,paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"4px",":hover::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralForeground4},De.a.border("2px","solid",Le.a.colorNeutralBackground3)),De.a.borderRadius(Le.a.borderRadiusMedium)),"&::-webkit-scrollbar":{width:Le.a.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:Le.a.colorNeutralBackground5}}),menuItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1,maxWidth:"inherit"},De.a.padding("0px")),De.a.border("2px","solid","transparent")),De.a.borderRadius(Le.a.borderRadiusMedium)),(Fg={"> span":Object(o.__assign)({},De.a.overflow("hidden"))},Fg["&:focus-within"]=Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Hover},De.a.border("2px","solid",Le.a.colorNeutralBackground1Hover)),Fg[Ur.m]={":hover":Object(o.__assign)({},De.a.border("2px","dashed","Highlight"))},Fg)),descriptionSection:{color:Le.a.colorNeutralForeground2Link,paddingBottom:"6px"},installedSection:Object(o.__assign)(Object(o.__assign)({display:"flex",paddingBottom:"10px",flexDirection:"column"},De.a.gap("2px")),{alignSelf:"stretch"}),description:{paddingBottom:"6px",fontFamily:"Segoe UI",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:Le.a.colorNeutralForeground2Link},titleContainer:Object(o.__assign)({display:"flex",flexDirection:"row"},De.a.gap("8px")),title:Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start"},De.a.gap("10px")),{alignSelf:"stretch"}),previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:Object(o.__assign)(Object(o.__assign)({height:"16px",color:Le.a.colorNeutralForeground2,backgroundColor:Le.a.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px"},De.a.borderRadius("8px")),{display:"flex",flexDirection:"row",alignSelf:"stretch",fontFamily:"Segoe UI",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"}),shimmerComponent:Object(o.__assign)({},De.a.padding("6px","6px","6px","0px")),labelInfo:(Ng={backgroundColor:Le.a.colorNeutralBackground1},Ng["&:focus-within"]=Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Hover},De.a.border("2px","solid",Le.a.colorNeutralBackground1Hover)),De.a.borderRadius(Le.a.borderRadiusMedium)),Ng)};var lh,ch=function(){var e,t,n,r,o,i,a,s,l,c,u,d={popOver:null!==(e=sh.popOver)&&void 0!==e?e:{},titleContainer:null!==(t=sh.titleContainer)&&void 0!==t?t:{},descriptionSection:null!==(n=sh.descriptionSection)&&void 0!==n?n:{},title:null!==(r=sh.title)&&void 0!==r?r:{},previewTitleContainer:null!==(o=sh.previewTitleContainer)&&void 0!==o?o:{},previewTitle:null!==(i=sh.previewTitle)&&void 0!==i?i:{},menuItem:null!==(a=sh.menuItem)&&void 0!==a?a:{},installedSection:null!==(s=sh.installedSection)&&void 0!==s?s:{},description:null!==(l=sh.description)&&void 0!==l?l:{},shimmerComponent:null!==(c=sh.shimmerComponent)&&void 0!==c?c:{},labelInfo:null!==(u=sh.labelInfo)&&void 0!==u?u:{}};return Object(ue.a)(d)}(),uh={shimmer:Le.a.colorNeutralStencil1,shimmerWave:Le.a.colorNeutralStencil2,background:Le.a.colorNeutralBackground1},dh={tooltipText:{width:"216px",fontSize:"12px"},tooltip:{alignSelf:"center","> button":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:"none",minWidth:"0px",maxHeight:"18px",maxWidth:"18px"},De.a.padding("4px")),De.a.borderStyle("none")),De.a.borderRadius("18px"))},infoButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:"inherit",boxShadow:"none",lineHeight:"6px"},De.a.border("2px","solid","transparent")),De.a.borderColor(Le.a.borderRadiusCircular)),(lh={"> span":{maxHeight:"18px",maxWidth:"18px"}},lh["&:focus-within"]=Object(o.__assign)({},De.a.border("2px","solid",Le.a.colorNeutralBackground1Hover)),lh[":hover"]={backgroundColor:Le.a.colorNeutralForeground2BrandHover,"> span > svg > path":{fill:Le.a.colorNeutralBackground2}},lh[Ur.m]={"> span > svg > path":{fill:"ButtonText"},":hover":{backgroundColor:"Highlight"}},lh))};var ph=function(){var e,t,n,r={tooltipText:null!==(e=dh.tooltipText)&&void 0!==e?e:{},tooltip:null!==(t=dh.tooltip)&&void 0!==t?t:{},infoButton:null!==(n=dh.infoButton)&&void 0!==n?n:{}};return Object(ue.a)(r)}();function gh(e){var t=e.infoMessage,n=ph();return se.createElement("span",{className:n.tooltip,role:ng.TOOLTIP},se.createElement(he.a,{content:t,relationship:"description"},se.createElement(me.a,{icon:fp,size:"small",className:n.infoButton,"aria-label":wg()})))}var hh=n(3604),fh={appIcon:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"20px",height:"fit-content",float:"left"},De.a.padding("4px","4px","4px","4px")),De.a.border("2px","solid",Le.a.colorNeutralBackground3Pressed)),De.a.borderRadius(Le.a.borderRadiusMedium)),appNameContainer:Object(o.__assign)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto"},De.a.overflow("hidden")),appNameTextContainer:Object(o.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto"},De.a.overflow("hidden")),appName:Object(o.__assign)(Object(o.__assign)({width:"auto",height:"auto",lineHeight:"36px",paddingLeft:"2px",paddingRight:"2px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:Le.a.colorNeutralForeground2Link,whiteSpace:"nowrap"},De.a.overflow("hidden")),{textOverflow:"ellipsis"}),appInfo:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.gap("4px")),{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),De.a.overflow("hidden")),{alignContent:"center",justifyItems:"left",alignItems:"center"}),blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",maxHeight:"100px"},De.a.gap("4px")),{justifyContent:"space-between","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right",height:"36px","@media (forced-colors: active)":{forcedColorAdjust:"none"}},spinner:{paddingTop:"8px",paddingInlineEnd:"20px"}};var mh=function(){var e,t,n,r,o,i,a,s,l,c,u={appIcon:null!==(e=fh.appIcon)&&void 0!==e?e:{},appNameContainer:null!==(t=fh.appNameContainer)&&void 0!==t?t:{},appNameTextContainer:null!==(n=fh.appNameTextContainer)&&void 0!==n?n:{},appName:null!==(r=fh.appName)&&void 0!==r?r:{},appInfo:null!==(o=fh.appInfo)&&void 0!==o?o:{},blocked:null!==(i=fh.blocked)&&void 0!==i?i:{},infoIcon:null!==(a=fh.infoIcon)&&void 0!==a?a:{},pluginItem:null!==(s=fh.pluginItem)&&void 0!==s?s:{},toggleControl:null!==(l=fh.toggleControl)&&void 0!==l?l:{},spinner:null!==(c=fh.spinner)&&void 0!==c?c:{}};return Object(ue.a)(u)}();function vh(e){var t=e.title,n=e.plugin,r=mh(),i=Object(o.__read)(se.useState(n.state==mp.Enabled),2),a=i[0],s=i[1],l=se.useCallback((function(e,t){c(t.checked)}),[]);se.useEffect((function(){s(n.state==mp.Enabled)}),[n.state]);var c=function(e){n.onToggle(e),s(e)},u=n.state===mp.Blocked?r.blocked:void 0,d=se.useMemo((function(){var e=n.state==mp.Blocked;return se.createElement("div",{className:r.toggleControl},n.state===mp.Loading&&se.createElement(hh.a,{className:r.spinner}),n.state!==mp.Loading&&se.createElement(ze.a,{disabled:!!e,checked:a,onChange:l,tabIndex:-1,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c(!(n.state==mp.Enabled)))},role:"switch"}))}),[c]),p=n.state===mp.Blocked?se.createElement(gh,{infoMessage:Eg()}):null,g=r.appName;g=Object(E.a)(g,u);var h,f=(h=n.id)===lp.Web?gp(r.appIcon):h===lp.Work?hp(r.appIcon):void 0,m=se.createElement("div",{className:r.appInfo},f,se.createElement("div",{className:r.appNameTextContainer},se.createElement(st.a,{className:g},t),p));return se.createElement("div",{className:r.pluginItem},m,d)}function bh(e){var t=e.plugins,n=e.isPluginDataLoaded,r=ch(),i=se.useCallback((function(e){if(a.current.push(e),t.length===a.current.length)for(var n=y,r=function(e){if(!n[e].props.disabled)return requestAnimationFrame((function(){a.current[e].focus()})),"break"},o=0;o<n.length;o++){if("break"===r(o))break}}),[]),a=se.useRef([]),s=r.title,l=r.previewTitle,c=r.descriptionSection,u=r.description,d=se.createElement(gh,{infoMessage:Sg()}),p=se.createElement("div",{className:r.previewTitleContainer},se.createElement(st.a,{className:l},Cg())),g=se.createElement("div",{className:c},se.createElement("div",{className:r.titleContainer},se.createElement(st.a,{role:ng.HEADING,"aria-level":1,"aria-label":yg(),className:s},yg()),e.isPreview&&p),se.createElement(st.a,{className:u},Og()),d),h=[{type:ih.a.circle,height:22.7},{type:ih.a.gap,width:10},{type:ih.a.line,height:10,width:160},{type:ih.a.gap,width:80},{type:ih.a.line,height:10}],f=se.memo((function(){return se.createElement(ah.a,{className:r.shimmerComponent,shimmerElements:h,shimmerColors:uh})}));f.displayName="ShimmerComponent";var m,v=function(e){var t,n=e.target,r=null===(t=e.currentTarget)||void 0===t?void 0:t.querySelector('[role="switch"]');n!==r&&(e.preventDefault(),null==r||r.click(),null==n||n.focus())},b=function(e){"Enter"!==e.key&&" "!==e.key||v(e)},y=se.useMemo((function(){return t.map((function(e,t){var n,o=e.state===mp.Blocked,a=(n=e.id)===lp.Work?xg():n===lp.Web?Ig():void 0;return se.createElement(Ce.a,{role:"button",key:t,persistOnClick:!0,className:r.menuItem,tabIndex:o?-1:0,disabled:o,onKeyDown:b,onClick:v,"aria-label":a,"aria-pressed":e.state===mp.Enabled,ref:i},se.createElement(vh,{title:a,plugin:e,key:e.id}))}))}),[t]),C=se.createElement("div",{className:r.installedSection},n?y:(m=t.length,se.createElement(se.Fragment,null,Object(o.__spreadArray)([],Object(o.__read)(Array(m)),!1).map((function(e,t){return se.createElement(f,{key:t})})))));return se.createElement(ae.a,null,se.createElement(be.a,{role:ng.DIALOG,className:r.popOver},se.createElement(ye.a,null,g,C)))}var yh,Ch,Oh,Sh,Eh={color:Le.a.colorBrandForeground1},xh=Object(ue.a)({menuPopOver:{overflowX:"hidden",width:"272px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",overflowY:"hidden"}}),Ih=function(e){var t=e.title,n=e.isDisabled,r=e.isMenuOpen,i=void 0!==r&&r,a=e.setMenuOpen,s=e.targetRef,l=e.shouldBlockGroundingButtonClick,c=void 0===l?function(){return!1}:l,u=e.groundingButtonPluginProps,d=Object(o.__read)(Object(se.useState)(i),2),p=d[0],g=d[1],h=le.a.useRef(null),f=Object(o.__read)(Object(se.useState)(!1),2),m=f[0],v=f[1],b=le.a.useRef(null),y=xh();le.a.useEffect((function(){var e;s&&(null===(e=h.current)||void 0===e||e.setTarget(s))}),[s,h]),Object(se.useEffect)((function(){g(i)}),[i]),Object(se.useEffect)((function(){a(p)}),[p,a]);var C=le.a.useCallback((function(e,t){var n;c&&c()||(null===(n=u.onGroundingButtonClick)||void 0===n||n.call(u),a(null==t?void 0:t.open))}),[a,c]);Object(se.useEffect)((function(){var e;v(u.pluginBlockedInfo&&0===(null===(e=u.plugins)||void 0===e?void 0:e.filter((function(e){return e.state===mp.Shimmer})).length))}),[u]);var O=le.a.useMemo((function(){var e;if(!u.plugins)return[];if(!u.pluginBlockedInfo){var t=[];return u.plugins.forEach((function(e){var n=Object(o.__assign)(Object(o.__assign)({},e),{state:mp.Shimmer});t.push(n)})),t}if(!(null===(e=u.pluginBlockedInfo)||void 0===e?void 0:e.length))return u.plugins;var n=[];return u.plugins.forEach((function(e){var t=Object(o.__assign)(Object(o.__assign)({},e),{state:u.pluginBlockedInfo.includes(e.id)?mp.Blocked:e.state});n.push(t)})),n}),[u]),S=le.a.createElement(he.a,{content:t,relationship:"label",positioning:"above",withArrow:!0},le.a.createElement(me.a,{appearance:"transparent",disabled:n,icon:p?{children:oh(At.d),style:Eh}:{children:rh(At.e,At.d)},"aria-label":t}));if(u.copilotPluginFlyoutProps){var E={positioningRef:b,position:"above",align:"start"};return le.a.createElement($o.a,{open:p,onOpenChange:C,positioning:E,trapFocus:!0},le.a.createElement(ei.a,null,S),le.a.createElement(ti.a,{className:y.menuPopOver},le.a.createElement(Xg.a,Object(o.__assign)({},u.copilotPluginFlyoutProps,{positioningRef:b,fluentTheme:th()}))))}var x={target:s,align:"center",position:"above"};return le.a.createElement(ge.a,{open:p,onOpenChange:C,positioning:x},le.a.createElement(fe.a,{disableButtonEnhancement:!0},S),le.a.createElement(bh,{isPluginDataLoaded:m,plugins:O,isPreview:!0}))},wh=n(836),Th=n(393),kh=n(195),jh=n(1137),Ph=n(2467),Ah={selectors:(yh={},yh[Ur.m]={color:"ButtonText"},yh)},_h=Object(Th.c)((function(e,t,n,r){return Object(Ur.db)({root:{direction:"inherit",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},container:{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",minWidth:"-webkit-fill-available",alignItems:"center",backgroundColor:Le.a.colorNeutralBackground4,borderBottom:n?void 0:"solid",borderWidth:"1px",borderColor:Le.a.colorNeutralStroke1,margin:n?void 0:"-4px",borderTopLeftRadius:r?void 0:"7px",borderTopRightRadius:r?void 0:"7px",borderLeftStyle:n?"solid":void 0,borderRightStyle:n?"solid":void 0,borderTopStyle:n||r?"solid":void 0},label:Object(o.__assign)({fontWeight:400,fontSize:Ur.k.size12,lineHeight:"16px",textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:t?Le.a.colorNeutralForegroundDisabled:Le.a.colorNeutralForeground1,paddingInlineStart:e?void 0:"10px"},Ah),iconContainer:{display:"flex"},icon:{paddingInlineStart:"10px",paddingInlineEnd:"8px"},downChevron:Object(o.__assign)({fill:t?Le.a.colorNeutralForegroundDisabled:Le.a.colorNeutralForeground1,color:t?Le.a.colorNeutralForegroundDisabled:Le.a.colorNeutralForeground1},Ah)})})),Dh=Object(Th.c)((function(e){return{root:{background:"transparent",border:"none",fontSize:Ur.k.size12,padding:0},rootHovered:{border:"none",backgroundColor:"transparent"},rootPressed:{border:"none",backgroundColor:"transparent"},rootDisabled:{border:"none",backgroundColor:"transparent",fontWeight:400},textContainer:{color:e?Le.a.colorNeutralForegroundDisabled:Le.a.colorNeutralForeground1,fontWeight:400,fontSize:Ur.k.size12,lineHeight:"16px",textAlign:"start",textDecoration:"underline",padding:"2px 0px 2px 0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},menuIcon:{margin:0,color:e?Le.a.colorNeutralForegroundDisabled:Le.a.colorNeutralForeground1,fontSize:"8px",paddingTop:"3px"},label:{fontWeight:"normal"}}})),Lh=((Ch={})[Ur.m]=Object(o.__assign)({backgroundColor:"Highlight",color:"HighlightText",outlineColor:"ButtonText"},Object(Ur.S)()),{selectors:(Oh={},Oh[Ur.m]=Object(o.__assign)({backgroundColor:"ButtonFace",color:"ButtonText",outlineColor:"inherit"},Object(Ur.S)()),Oh)}),Mh={selectors:(Sh={},Sh[Ur.m]=Object(o.__assign)({backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed"},Object(Ur.S)()),Sh)},Bh=Object(Th.c)((function(){return{root:{padding:"6px",backgroundColor:"transparent",minWidth:"unset"},divider:{height:"1px"}}})),Rh=Object(Th.c)((function(){var e;return{root:Object(o.__assign)({border:"none",minWidth:"-webkit-fill-available",minHeight:"48px",margin:"1px",padding:"0px",alignItems:"flex-start",fontWeight:400,backgroundColor:Le.a.colorNeutralBackground1,color:Le.a.colorNeutralForeground1,borderColor:Le.a.colorNeutralStroke1,borderRadius:"6px"},Lh),rootHovered:Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Hover,color:Le.a.colorNeutralForeground1Hover},Mh),rootPressed:Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1Pressed,color:Le.a.colorNeutralForeground1Pressed},Mh),flexContainer:(e={},e[Ur.m]=Object(o.__assign)({color:"HighlightText",foreground:"HighlightText",":hover label, :hover svg":{color:"HighlightText",fill:"HighlightText"}},Object(Ur.S)()),e)}})),Fh=Object(Th.c)((function(){return Object(Ur.db)({root:{direction:"inherit",borderRadius:"7px",backgroundColor:Le.a.colorNeutralBackground1},buttonContainer:{paddingLeft:"8px",paddingRight:"8px",width:"100%",alignItems:"center"},icon:{alignSelf:"center",padding:"2px",alignItems:"center",lineHeight:24,color:Le.a.colorNeutralForeground1,fill:Le.a.colorNeutralForeground1},container:{paddingInlineStart:"8px",alignItems:"flex-start",alignSelf:"center",display:"inline-block"},primaryLabel:Object(o.__assign)(Object(o.__assign)({textAlign:"start",fontSize:Ur.k.size14,fontWeight:400,lineHeight:"14px"},De.a.padding("0px")),{color:Le.a.colorNeutralForeground1}),secondaryLabel:Object(o.__assign)(Object(o.__assign)({textAlign:"start",fontSize:Ur.k.size10,fontWeight:400,lineHeight:"14px"},De.a.padding("0px")),{color:Le.a.colorNeutralForeground2Link})})})),Nh=function(e,t){var n=e.key+"_desc";return se.createElement(ae.a,{className:e.root},se.createElement(jh.a,{onClick:function(n,r){e.onClick(),t(n,r)},styles:Rh(),role:"menuitem"},se.createElement(Wr.a,{horizontal:!0,className:e.buttonContainerClass},vp(e.iconClass)[e.iconId],se.createElement(Wr.a,{className:e.containerClass},se.createElement(wh.a,{className:e.primaryClass,"aria-describedby":n},e.text),se.createElement(wh.a,{className:e.secondaryTextClass,id:n},e.secondaryText)))))},Hh=Object(Th.c)((function(e,t,n,r){var o,i=t.map((function(e){return function(e,t){var n=Fh();return{key:e.primary,text:e.primary,secondaryText:e.secondary,iconId:e.id,root:n.root,containerClass:n.container,buttonContainerClass:n.buttonContainer,primaryClass:n.primaryLabel,secondaryTextClass:n.secondaryLabel,iconClass:n.icon,onClick:function(n){t(e,n)},onRender:Nh}}(e,n)}));return{target:e,alignTargetEdge:!0,isBeakVisible:!1,gapSpace:4,directionalHint:kh.a.topCenter,items:i,styles:Bh,focusZoneProps:bp,calloutProps:(o=null==e?void 0:e.offsetWidth,{setInitialFocus:!0,styles:{root:{width:o?o+16:364,borderRadius:"8px"},calloutMain:{backgroundColor:th().colorNeutralBackground1,borderRadius:"8px"}}}),onDismiss:r}})),Uh=function(e){var t=Object(o.__read)(se.useState(e.sourcesData[0]),2),n=t[0],r=t[1],i=Object(o.__read)(se.useState(!1),2),a=i[0],s=i[1],l=function(){s(!0)},c=function(t){s(!1),e.onMenuDismiss&&e.onMenuDismiss(t),window.requestAnimationFrame((function(){var e;return null===(e=d.querySelector("button[aria-haspopup]"))||void 0===e?void 0:e.focus()}))},u=Object(o.__read)(se.useState(void 0),2),d=u[0],p=u[1],g=_h(!!e.infoTip,e.isDisabled,e.isChatInputV3Enabled,e.isChatInputBannerVisible);return se.createElement(ae.a,{className:g.root},se.createElement("div",{className:g.container,ref:function(e){e&&p(e)}},e.infoTip&&se.createElement("div",{className:g.icon},se.createElement(gh,{infoMessage:e.infoTip})),se.createElement(wh.a,{className:g.label},e.sourcePrefix),se.createElement(jh.a,{text:n.primary.toLocaleLowerCase(),styles:Dh(e.isDisabled),onClick:l,disabled:e.isDisabled,"aria-label":e.sourcePrefix+n.primary,type:"button","aria-haspopup":"true"}),se.createElement(rn.k,{className:g.downChevron,"aria-label":e.infoTip,cursor:"pointer",onClick:e.isDisabled?void 0:l}),a&&d&&se.createElement(Ph.a,Object(o.__assign)({},Hh(d,e.sourcesData,(function(t,o){t.id!=n.id&&(r(t),e.onSelection&&e.onSelection(t)),c(o)}),c)))))},Vh=Object(ue.a)({activeIcon:{color:Le.a.colorBrandForeground1},menuList:{minWidth:"100%",whiteSpace:"nowrap"},highlightedText:{color:Le.a.colorBrandForeground1},greyedText:{color:Le.a.colorNeutralForeground4},menuItem:{paddingLeft:"10px",paddingBottom:"8px",paddingTop:"8px",paddingRight:"10px",maxWidth:"none"},menuBackButtonContainer:{display:"flex",alignItems:"center","&:hover":{color:Le.a.colorNeutralForeground1}},menuBackButton:{textAlign:"left",paddingLeft:0},menuBackButtonText:{whiteSpace:"nowrap",fontWeight:"600",fontSize:"12px",paddingLeft:"8px"}}),zh=function(e){e.title;var t,n=e.isDisabled,r=e.isMenuOpen,i=void 0!==r&&r,a=e.setMenuOpen,s=e.positioningRef,l=e.promptGuideMenuProps,c=Vh(),u=Object(o.__read)(Object(se.useState)(""),2),d=u[0],p=u[1],g=Object(o.__read)(Object(se.useState)(l.promptGuideMenuData),2),h=g[0],f=g[1],m=Object(se.useRef)(""===d?h:null===(t=h.children)||void 0===t?void 0:t.find((function(e){return e.text===d})));Object(se.useEffect)((function(){f(l.promptGuideMenuData)}),[l.promptGuideMenuData]),Object(se.useEffect)((function(){var e;m.current=""===d?h:null===(e=h.children)||void 0===e?void 0:e.find((function(e){return e.text===d}))}),[h]);var v=Object(o.__read)(Object(se.useState)(i),2),b=v[0],y=v[1];Object(se.useEffect)((function(){y(i)}),[i]),Object(se.useEffect)((function(){a(b)}),[b,a]);var C=le.a.useCallback((function(e,t){(null==t?void 0:t.open)&&l.shouldBlockPromptGuideLaunch&&l.shouldBlockPromptGuideLaunch()||(y(null==t?void 0:t.open),(null==t?void 0:t.open)&&l.handleOnClickPromptGuideMenuButtonTelemetry(),p(""),m.current=h)}),[p,y,h,l.shouldBlockPromptGuideLaunch]),O=Object(se.useCallback)((function(e){var t,n;p(e),null===(t=s.current)||void 0===t||t.updatePosition(),m.current=""===e?h:null===(n=h.children)||void 0===n?void 0:n.find((function(t){return t.text===e}))}),[p,h]),S=Object(se.useRef)(null);return Object(se.useEffect)((function(){var e=document.getElementById(gg);if(e){var t=new ResizeObserver((function(){var t,n=e.offsetWidth;if(S.current){var r={width:"".concat(n,"px"),maxWidth:"none",minHeight:"100px"};Object.assign(S.current.style,r)}null===(t=s.current)||void 0===t||t.updatePosition()}));return t.observe(e),function(){t.unobserve(e)}}}),[S,b,s]),le.a.createElement(ge.a,{open:b,onOpenChange:C,persistOnItemClick:!0,positioning:{positioningRef:s}},le.a.createElement(fe.a,{disableButtonEnhancement:!0},le.a.createElement(he.a,{content:rg()?OfficeaicopilotStrings.DefaultMenuButtonTitle:"View prompts",relationship:"label",positioning:"above",withArrow:!0},le.a.createElement(me.a,{appearance:"transparent",disabled:n,icon:b?{children:oh(Zp.j),className:c.activeIcon}:{children:rh(Zp.k,Zp.j)},"aria-label":b?"Close view prompts":"Open view prompts",id:"".concat("ViewPromptsID")}))),le.a.createElement(be.a,{ref:S},le.a.createElement(Gh,{dataNode:m.current,updatePopoverOpen:y,updateDataNode:O,menuProps:l})))},Gh=function(e){var t,n=e.dataNode,r=e.updatePopoverOpen,i=e.updateDataNode,a=e.menuProps,s=Vh(),l=Object(o.__read)(le.a.useState(a),1)[0],c="Root"===(null==n?void 0:n.nodeType),u=le.a.useCallback((function(){i("")}),[i]),d=Object(se.useRef)(null),p=Object(se.useRef)(null);if(Object(se.useEffect)((function(){var e=c?p.current:d.current;e&&e.focus()}),[c]),!n)return le.a.createElement(le.a.Fragment,null);var g=c?{}:{paddingLeft:0},h=null==l?void 0:l.copilotLabProps;return le.a.createElement(ye.a,{className:s.menuList},le.a.createElement(bc.a,null,le.a.createElement(Cc.a,{style:g},c?le.a.createElement(st.a,{size:200,weight:"medium"},n.text):le.a.createElement("div",{className:s.menuBackButtonContainer},le.a.createElement(me.a,{ref:d,className:s.menuBackButton,appearance:"transparent",onClick:u,icon:le.a.createElement(rn.r,null),"aria-label":"Back"}),le.a.createElement("div",{className:s.menuBackButtonText},n.text))),null===(t=n.children)||void 0===t?void 0:t.map((function(e,t){return le.a.createElement(Wh,{key:t,ref:0===t?p:void 0,dataNode:e,updatePopoverOpen:r,updateDataNode:i,menuProps:l})}))),(null==h?void 0:h.copilotLabMenuItemText)&&(c||"Category"===(null==n?void 0:n.nodeType))&&le.a.createElement(le.a.Fragment,null,le.a.createElement(yc.a,null),le.a.createElement(Ce.a,{className:s.menuItem,icon:h.iconRegular?h.iconHover?{children:rh(h.iconRegular,h.iconHover)}:{children:oh(h.iconRegular)}:null,onClick:function(e){e.stopPropagation(),r(!1),(null==h?void 0:h.handleOnClickCopilotLab)&&h.handleOnClickCopilotLab("Category"===n.nodeType?n.promptCategory:void 0)}},rg()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts")))},Wh=Object(se.forwardRef)((function(e,t){var n=e.dataNode,r=e.updatePopoverOpen,o=e.updateDataNode,i=e.menuProps,a=Vh(),s=n.text,l=void 0===s?"":s,c=n.data,u=n.iconHover,d=n.iconRegular,p=n.children,g=((null==p?void 0:p.length)||0)>0,h=function(e){var t=[],n=[],r=[],o=e.lastIndexOf(")"),i=e.lastIndexOf("(",o),a=e.lastIndexOf("]"),s=e.lastIndexOf("[",a);return o>i&&i>=0?(t.push(e.slice(0,i),e.slice(i,o+1),e.slice(o+1)),n.push(!1,!0,!1),r.push(!1,!1,!1)):a>s&&s>=0?(t.push(e.slice(0,s),e.slice(s,a+1),e.slice(a+1)),n.push(!1,!0,!1),r.push(!1,!0,!1)):(t.push(e),n.push(!1),r.push(!1)),{chunks:t,shouldHighlight:n,shouldGrey:r}}(l),f=h.chunks,m=h.shouldHighlight,v=h.shouldGrey,b=function(e,t,n){i.handleOnClickStarterPromptMenuItem&&i.handleOnClickStarterPromptMenuItem(e,t,n)},y=le.a.useCallback((function(){if(!p)return r(!1),void b(l,!0,null==c?void 0:c.ciqEntity);o(l||""),b(l,!1,null==c?void 0:c.ciqEntity)}),[c,p,r,o,l]);return le.a.createElement(Ce.a,{ref:t,icon:d?u?{children:rh(d,u)}:{children:oh(d)}:null,hasSubmenu:g,disabled:n.isDisabled,className:a.menuItem,"aria-label":l+(g?", sub menu":""),onClick:y},le.a.createElement("span",{style:{whiteSpace:"normal"}},f.map((function(e,t){return m[t]&&!n.isDisabled?le.a.createElement("span",{key:t,className:v[t]?a.greyedText:a.highlightedText},e):le.a.createElement(le.a.Fragment,{key:t},e)}))))}));Wh.displayName="ViewPromptsMenuItem";var Qh,qh,Kh,Yh,Zh=Object(ue.a)({root:{backgroundColor:"transparent"}}),Jh=Object(ue.a)({root:Object(o.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:Le.a.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},De.a.padding("16px"))}),Xh=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.border("1px solid")),De.a.borderColor("transparent")),De.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),$h=Object(ue.a)({root:{backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1,"&:hover":{backgroundColor:"".concat(Le.a.colorBrandForeground1," !important")}}}),ef=Object(ue.a)({root:{backgroundColor:Le.a.colorNeutralBackground1,color:Le.a.colorStrokeFocus2,"&:hover":Object(o.__assign)(Object(o.__assign)({},De.a.borderColor("".concat(Le.a.colorBrandForeground1))),{backgroundColor:"".concat(Le.a.colorNeutralBackground1," !important")})}}),tf=Object(ue.a)({root:{color:Le.a.colorBrandForeground1,"&:hover":{color:Le.a.colorBrandForeground1},fontSize:"12px"}}),nf=Object(ue.a)({root:{height:"63px",bottom:"12px"}}),rf=Object(ue.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),of=Object(ue.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:Le.a.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),af=Object(ue.a)({root:{fontWeight:"bold",color:Le.a.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),sf=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(E.a)(Xh().root,$h().root),c=Object(E.a)(Xh().root,ef().root),u=of().root,d=Object(E.a)(u,af().root),p=tf().root,g=nf().root,h=Object(se.useRef)(null);return Object(se.useEffect)((function(){var e;t&&(null===(e=h.current)||void 0===e||e.focus())}),[t]),le.a.createElement(ae.a,{className:Zh().root},le.a.createElement(Xe.a,{modalType:"modal",open:t},le.a.createElement($e.a,{className:Jh().root,tabIndex:0},le.a.createElement(et.a,null,le.a.createElement(tt.a,{className:d},n),le.a.createElement(rt.a,null,o&&le.a.createElement(Ae.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),le.a.createElement(ve.a,{className:u},r),i&&le.a.createElement($t.a,{inline:!0,className:p,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},rg()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),le.a.createElement(Pn.a,{className:rf().root},le.a.createElement(nt.a,{disableButtonEnhancement:!0},le.a.createElement(me.a,{ref:h,className:c,appearance:"secondary",onClick:s},rg()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),le.a.createElement(me.a,{className:l,appearance:"primary",onClick:a},rg()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Qh||(Qh={}));var lf,cf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},De.a.borderRadius("8px")),De.a.borderColor(Le.a.colorNeutralBackground1)),(qh={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},qh["&:hover .".concat(an.a.icon)]={color:Le.a.colorBrandForeground1},qh["&:hover:active .".concat(an.a.icon)]={color:Le.a.colorBrandForeground1},qh.display="flow",qh))}),uf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},De.a.borderRadius("50%")),(Kh={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Le.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Le.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Le.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Kh["&.".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Kh["&:hover .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Kh["&:active .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Kh["&:hover:active .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Kh["&:hover"]={backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},Kh["&:hover:active"]={backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},Kh["@media (forced-colors: active)"]={forcedColorAdjust:"none"},Kh))}),df=Object(ue.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),pf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground3},De.a.borderRadius("50%")),{color:Le.a.colorBrandForeground1}),loader:Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralBackground1},De.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Le.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),gf=Object(ue.a)({root:(Yh={},Yh["&:hover .".concat(an.a.icon)]={color:Le.a.colorNeutralForegroundDisabled},Yh["&:hover:active .".concat(an.a.icon)]={color:"".concat(Le.a.colorNeutralForegroundDisabled," !important")},Yh)}),hf=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(se.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(!1),2),l=s[0],c=s[1];Object(se.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(f.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(se.useEffect)((function(){n.microphoneState===Qh.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===Qh.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(se.useEffect)((function(){t?g(m.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(se.useRef)(cf()),d=Object(o.__read)(Object(se.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(se.useRef)(Object(E.a)(u.current.root,pf().root)),f=Object(se.useRef)(Object(E.a)(u.current.root,uf().root)),m=Object(se.useRef)(Object(E.a)(u.current.root,gf().root)),v=le.a.createElement(me.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case Qh.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case Qh.Disabled:case Qh.Uninitialized:return"Microphone Disabled";case Qh.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?le.a.createElement(lu.a,{title:"Mic-Filled"}):le.a.createElement(lu.b,{title:"Mic-Regular"}),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return le.a.createElement("div",{className:df().root},n.isTooltipDisabled?v:le.a.createElement(he.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},v),i&&le.a.createElement("div",{className:pf().loader}),le.a.createElement(sf,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},ff=n(473),mf=n(2801),vf=n(575),bf=n(2700),yf=n(2701);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(lf||(lf={}));var Cf,Of,Sf,Ef,xf=lf.web,If=function(){return xf===lf.IOS},wf=function(){function e(e,t){this.entityPluginRef=e,this.controlRef=t}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,o,i){var a,s=e.suggestion;s&&(null===(a=this.entityPluginRef.current)||void 0===a||a.insertChatInputEntity({text:s.text,data:s}))},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n,r=null===(t=this.controlRef.current)||void 0===t?void 0:t.getInputText().trim();if(r){var o=(null===(n=this.entityPluginRef.current)||void 0===n?void 0:n.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.url)})).map((function(e){var t=r.indexOf(e.text);return{type:"URL",range:[t,t+e.text.length-1],value:e.data.url}}));if(!(o.length<=0))return o}},e.prototype.generateQueryAnnotations=function(e){var t,n=(null===(t=this.entityPluginRef.current)||void 0===t?void 0:t.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.queryAnnotation)})).map((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.queryAnnotation}));if(!(n.length<=0))return n},e.prototype.setHVCAppChatV2Enabled=function(e){},e}(),Tf=n(240),kf=n(53),jf=n(2698),Pf=n(2699),Af=function(e){var t=Object(o.__read)(Object(Tf.useLexicalComposerContext)(),1)[0],n=e.ciqPlaceholderText,r=e.entityPluginRef,i=e.queryCharacter,a=se.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,a,s,l,c,u,d,p;return Object(o.__generator)(this,(function(o){return n?(e=Object(kf.$getSelection)(),Object(kf.$isRangeSelection)(e)&&e.isCollapsed()?(t=e.getNodes()[0],Object(kf.$isTextNode)(t)&&t.isSimpleText()?(r=t.getTextContent(),a=e.getCharacterOffsets()[0],s=r[a-1]===i,l=1===a||""===(null===(p=r[a-2])||void 0===p?void 0:p.trim()),c=a===r.length||""===r[a].trim(),u=t.getNextSibling(),d=a===r.length&&(!u||Object(vf.b)(u)&&!u.getNextSibling()),s&&l&&c?[2,"​‌"+n+(d?"":"​‌")]:[2,void 0]):[2,void 0]):[2,void 0]):[2,void 0]}))}))}),[n,i]);return se.useEffect((function(){return t.registerNodeTransform(kf.TextNode,(function(e){if(!e.getPreviousSibling()){var t=e.getTextContent();t.length>0&&t[0]===i&&e.insertBefore(Object(kf.$createTextNode)(" "))}}))}),[t,i]),se.createElement(se.Fragment,null,se.createElement(jf.a,{id:"ciq",controlRef:r}),se.createElement(Pf.a,{id:"ciqGhostText",$getGhostText:a}))},_f=n(293),Df=n(1088),Lf=function(e){var t=e.closingMarker,n=void 0===t?"}":t,r=e.languageSupportsSpace,i=e.onChatInputTokenAdded,a=e.onChatInputTokenDeleted,s=e.openingMarker,l=void 0===s?"{":s,c=e.tokenPhrases,u=void 0===c?[]:c,d=e.tokenListPhrases,p=void 0===d?[]:d,g=Object(o.__read)(Object(Tf.useLexicalComposerContext)(),1)[0],h=se.useRef(!1),f=se.useCallback((function(e){var t,i,a=e.endIndex,s=e.node,c=e.startIndex,u=e.text;h.current=!0;var d=Object(mf.a)(u),p=s.splitText(c,a),g=0,f=s,m=0;try{for(var v=Object(o.__values)(p),b=v.next();!b.done;b=v.next()){var y=b.value;if(g++,m+=y.getTextContent().length,y.getTextContent().toLowerCase()===u.toLowerCase()||y.getTextContent().toLowerCase()===l+u.toLowerCase()+n){y.replace(d);break}}}catch(e){t={error:e}}finally{try{b&&!b.done&&(i=v.return)&&i.call(v)}finally{if(t)throw t.error}}g<p.length&&(f=p[g]);var C=d.getNextSibling();if(r.current&&(!C||Object(kf.$isDecoratorNode)(C)||Object(kf.$isTextNode)(C)&&0===C.getTextContent().length)){var O=Object(kf.$createTextNode)(" ");d.insertAfter(O)}return Object(kf.$isRootOrShadowRoot)(d.getParentOrThrow())&&Object(_f.$wrapNodeInElement)(d,kf.$createParagraphNode).selectEnd(),{updatedNode:f,nodeOffset:m}}),[n,r,l]);return Object(Df.a)((function(){return Object(_f.mergeRegister)(g.registerMutationListener(mf.c,(function(e,t){var n,r,s=function(e,n){"destroyed"===n?t.prevEditorState.read((function(){var t=Object(kf.$getNodeByKey)(e);Object(mf.b)(t)&&(h.current=!1,null==a||a(t.getTextContent()),g.update((function(){var e,t=Object(kf.$getRoot)().getFirstChild();Object(kf.$isElementNode)(t)&&(null===(e=t.getChildren())||void 0===e||e.forEach((function(e){Object(mf.b)(e)&&e.replace(Object(kf.$createTextNode)(e.getTextContent()))})))})),g.update((function(){Object(kf.$getRoot)().getAllTextNodes().forEach((function(e){return e.markDirty()}))})))})):"created"===n&&g.getEditorState().read((function(){var t,n=Object(kf.$getNodeByKey)(e);if(Object(mf.b)(n)){h.current=!0;var r="",o=Object(kf.$getRoot)().getFirstChild();Object(kf.$isElementNode)(o)&&(null===(t=o.getChildren())||void 0===t||t.forEach((function(e){Object(mf.b)(e)&&(r+=e.getTextContent())}))),null==i||i(r)}}))};try{for(var l=Object(o.__values)(e),c=l.next();!c.done;c=l.next()){var u=Object(o.__read)(c.value,2);s(u[0],u[1])}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}})))}),[g]),se.useEffect((function(){return g.registerNodeTransform(kf.TextNode,(function(e){var t,r,i,a;if(!h.current){var s=e.getTextContent(),c=s.indexOf(l),d=s.indexOf(n,c);if(-1!==c&&-1!==d){var g=s.substring(c+1,d);""!==g&&f({node:e,startIndex:c,endIndex:d+1,text:g})}else if(p.length>0){var m=function(t){var n,r,i=0,a=t.every((function(e){var t=e(),n=s.toLocaleLowerCase().indexOf(t.toLocaleLowerCase(),i);return-1!==n&&(i=n+t.length,!0)}));if(a){var l=0,c=0;try{for(var u=(n=void 0,Object(o.__values)(t)),d=u.next();!d.done;d=u.next()){var p=(0,d.value)(),g=s.toLocaleLowerCase().indexOf(p.toLocaleLowerCase(),c);c=g+p.length-l;var h=f({node:e,startIndex:g-l,endIndex:c,text:p});e=h.updatedNode,l+=h.nodeOffset}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return{value:void 0}}};try{for(var v=Object(o.__values)(p),b=v.next();!b.done;b=v.next()){var y=m(b.value);if("object"==typeof y)return y.value}}catch(e){t={error:e}}finally{try{b&&!b.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}}else try{for(var C=Object(o.__values)(u),O=C.next();!O.done;O=C.next()){var S=(0,O.value)(),E=s.toLocaleLowerCase().indexOf(S.toLocaleLowerCase());if(-1!==E)return void f({node:e,startIndex:E,endIndex:E+S.length,text:S})}}catch(e){i={error:e}}finally{try{O&&!O.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}}}))}),[f,n,g,l,u]),null},Mf=function(){},Bf=function(e,t){var n=e.chatInputContainerTitle,r=void 0===n?sg():n,i=e.ciqButtonTitle,a=void 0===i?vg():i,s=e.copilotChatTheme,l=e.editorProps,c=e.groundingButtonPluginProps,u=e.groundingSourcePickerProps,d=e.handleChatInputLoad,p=void 0===d?Mf:d,g=e.handleFirstUserInput,h=void 0===g?Mf:g,f=e.handleOnBlur,m=e.handleOnChatInputControlMount,v=e.handleOnChatInputControlUnmount,b=e.handleOnInput,y=e.handleSubmitButtonClick,C=e.isCIQButtonEnabled,O=void 0!==C&&C,S=e.isDarkMode,E=e.isDisabled,x=e.isMenuButtonEnabled,I=void 0!==x&&x,w=e.isGroundingButtonEnabled,T=void 0!==w&&w,k=e.isSensitivityIndicatorLoading,j=e.isSubmitButtonDisabled,P=e.maxInputCharLimit,A=void 0===P?2e3:P,_=e.menuButtonTitle,D=void 0===_?lg():_,L=e.overrideStyles,M=e.placeholderText,B=void 0===M?ug():M,R=e.promptGuideMenuProps,F=e.shouldBlockGroundingButtonClick,N=void 0===F?function(){return!1}:F,H=e.shouldBlockSubmitButtonClick,U=void 0===H?function(){return!1}:H,V=e.submitButtonTitle,z=void 0===V?cg():V,G=e.voiceInputProps,W=e.chatInputBannerProps,Q=e.hvcPromptStrings,q=e.hvcPromptStringsList,K=e.isHVCAppChatV2Enabled,Y=e.onChatInputHVCPromptUpdated,Z=Object(o.__read)(se.useState(!1),2),J=Z[0],X=Z[1],$=Object(o.__read)(se.useState(!1),2),ee=$[0],te=$[1],ne=Object(o.__read)(se.useState(!1),2),re=ne[0],oe=ne[1],ie=Object(o.__read)(se.useState(B),2),ae=ie[0],le=ie[1],ce=Object(o.__read)(se.useState(!0),2),ue=ce[0],de=ce[1],pe=se.useRef(),ge=se.useRef(),he=se.useRef(!0),fe=se.useRef(!0),me=se.useRef(null),ve=se.useRef(null),be=se.useRef(null);se.useImperativeHandle(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){var t;null===(t=ve.current)||void 0===t||t.setInputText(e)},updateInputText:function(e,t){var n,r;switch(t){case Yp.InsertAtCursor:null===(n=ve.current)||void 0===n||n.insertTextAtCursor(e);break;case Yp.Replace:null===(r=ve.current)||void 0===r||r.setInputText(e)}},getInputText:function(){var e;return null===(e=ve.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){return be.current},setGhostText:function(e){},getGhostText:function(){var e;return null===(e=we.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=be.current)||void 0===e||e.focus()},closeMenu:function(){I&&J&&X(!1),T&&ee&&te(!1),Te&&ke.current&&Pe(!1)},getCIQTextRef:function(){return Se.current},getChatEditorInstance:function(){return Ce},getCIQResponseHandler:function(){return Oe}}})),se.useEffect((function(){le(B)}),[B]),se.useEffect((function(){var e;ge.current&&(null===(e=me.current)||void 0===e||e.setTarget(ge.current))}),[me,ge]);var ye=function(e){var t,n=e.chatInputRef,r=e.controlRef,i=e.copilotChatTheme,a=e.editorProps,s=e.isDarkMode,l=e.isSensitivityIndicatorLoading,c=e.languageSupportsSpace,u=Object(o.__read)(se.useState(void 0),2),d=u[0],p=u[1],g=Object(o.__read)(se.useState(void 0),2),h=g[0],f=g[1],m=se.useRef(),v=se.useRef(),b=se.useRef();se.useEffect((function(){s?d&&d.updateCurrentTheme(ju.dark):d&&d.updateCurrentTheme(ju.light)}),[s]),se.useEffect((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!m.current&&(null==a?void 0:a.alSession)){var e=(new dp).createInstance();e.bootstrap(og(a.editorConfig,a.alSession)).then((function(t){m.current=e,p(t)}))}return function(){m.current&&m.current.shutdown().then((function(){m.current=void 0}))}}),[null==a?void 0:a.alSession,null==a?void 0:a.handleInChatInput,null==a?void 0:a.editorConfig]),se.useEffect((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!h&&d&&n.current){var e=new wf(b,r);d.initializeCiq(n.current,{menuTitle:null==a?void 0:a.editorConfig.transformFileMenuTitle,menuSubtitle:(null==a?void 0:a.editorConfig.transformFilePlaceholderText)?null==a?void 0:a.editorConfig.transformFilePlaceholderText:dg,queryCharToUse:$u,onItemSelected:function(t){var o,u;null===(o=n.current)||void 0===o||o.focus(),e.renderAndTrackSelectedSuggestion(t,null,l,i,s,v),c.current&&(null===(u=r.current)||void 0===u||u.insertTextAtCursor(mg)),a.postCIQItemSelectionHandler&&a.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==a?void 0:a.editorConfig.entitiesSupported,ExpanededECC:null==a?void 0:a.editorConfig.isExpandedECCEnabled}),f(e)}}),[d,h]);var y=d?se.createElement(Af,{queryCharacter:$u,ciqPlaceholderText:null===(t=null==a?void 0:a.editorConfig)||void 0===t?void 0:t.ciqPlaceholderText,entityPluginRef:b}):null;return{chatEditor:d,ciqResponseHandler:h,ciqTextRef:v,ciqPlugin:y}}({chatInputRef:be,controlRef:ve,copilotChatTheme:s,editorProps:l,isDarkMode:S,isSensitivityIndicatorLoading:k,languageSupportsSpace:he}),Ce=ye.chatEditor,Oe=ye.ciqResponseHandler,Se=ye.ciqTextRef,Ee=ye.ciqPlugin,xe=function(e){var t=e.chatInputRef,n=e.controlRef,r=e.handleChatInputLoad,i=e.isDisabled,a=e.languageSupportsSpace,s=e.maxInputCharLimit,l=e.placeholderText,c=e.voiceInputProps,u=Object(o.__read)(se.useState(!1),2),d=u[0],p=u[1],g=Object(o.__read)(se.useState(Qh.Uninitialized),2),h=g[0],f=g[1],m=Object(o.__read)(se.useState(!1),2),v=m[0],b=m[1],y=se.useRef(null==c?void 0:c.alSession),C=se.useRef(!1),O=se.useRef(null),S=!(!(null==c?void 0:c.handleInChatInput)||!(null==c?void 0:c.alSession)&&!(null==c?void 0:c.alSessionConfig)),E=se.useCallback((function(e){var t,r,o,i,s,l;if(e){var c=(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>0&&a.current?mg:dg;null===(r=O.current)||void 0===r||r.setGhostText(c+fg())}else{var u=null===(i=null===(o=O.current)||void 0===o?void 0:o.getGhostText())||void 0===i?void 0:i.trim();u&&""!==u&&u!==fg()?null===(s=O.current)||void 0===s||s.commitGhostText(u):null===(l=O.current)||void 0===l||l.cancelGhostText()}p(e),C.current=e}),[l]);se.useEffect((function(){var e;d||Vp(E).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=t.current)||void 0===e||e.focus()}),[d]);var x=se.useCallback((function(e){var r,o,l,c,u;if(C.current&&S&&!i&&!((null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>=s)){var d=(null===(o=n.current)||void 0===o?void 0:o.getInputText().length)>0&&a?mg:dg;null===(l=O.current)||void 0===l||l.commitGhostText(d+e),null===(c=t.current)||void 0===c||c.focus(),null===(u=n.current)||void 0===u||u.scrollToBottom()}}),[S,i,s]),I=se.useCallback((function(e){var t,r,o,l;if(C.current&&S&&!i&&!(null!=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>=s)){var c=(null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>0&&a?mg:dg;null===(o=O.current)||void 0===o||o.setGhostText(c+e),null===(l=n.current)||void 0===l||l.scrollToBottom(),e.trim()&&Gp(hg,E)}}),[S,i,s,E]),w=se.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return null!=y.current?[3,4]:(e=y,null===(r=c.alSession)||void 0===r?[3,1]:(t=r,[3,3]));case 1:return[4,ig(null==c?void 0:c.alSessionConfig)];case 2:t=o.sent(),o.label=3;case 3:e.current=t,o.label=4;case 4:return y.current?(n=qp(c.voiceInputLocale),[4,Fp(n,x,I,f,E,y.current)]):[3,6];case 5:o.sent(),a.current=Kp(qp(n)),o.label=6;case 6:return[2]}}))}))}),[I,x,E,null==c?void 0:c.alSession,null==c?void 0:c.alSessionConfig,null==c?void 0:c.voiceInputLocale]);se.useEffect((function(){r()}),[]),se.useEffect((function(){S&&w()}),[S,w]);var T=S?{isMicrophoneListening:d,microphoneState:h,handleMicrophoneButtonOnClick:function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s,c,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),d?((null===(r=O.current)||void 0===r?void 0:r.getGhostText())!=dg&&(null===(i=O.current)||void 0===i?void 0:i.getGhostText())!=l&&(null===(s=null===(a=O.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=fg()&&(null===(c=O.current)||void 0===c||c.commitGhostText(null===(u=O.current)||void 0===u?void 0:u.getGhostText())),[4,Vp(E)]):[3,3];case 2:return o.sent(),[3,6];case 3:return h===Qh.Uninitialized&&f(Qh.Loading),[4,Lp.GetInstance().Resume()];case 4:return o.sent(),b(!1),E(!d),f(Qh.Enabled),[4,Gp(hg,E)];case 5:o.sent(),o.label=6;case 6:return[3,10];case 7:return t=o.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Lp.GetInstance().Pause()];case 8:o.sent(),b(!0),o.label=9;case 9:return f(Qh.Uninitialized),[2];case 10:return[2]}}))}))},micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:v,microphonePermissionErrorTitle:null==c?void 0:c.microphonePermissionErrorTitle,microphonePermissionErrorMessage:null==c?void 0:c.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){zp(d,hg,b,f,E)},notNowOnClickHandler:function(){b(!1)},microphonePermissionErrorImagePath:null==c?void 0:c.microphonePermissionImagePath,showHelpLink:null==c?void 0:c.showMicrophonePermissionHelpLink},isTooltipDisabled:!0}:null==c?void 0:c.microphoneButtonProps;return{getMicrophoneLiveRegionText:function(){if(T)switch(null==T?void 0:T.microphoneState){case Qh.Enabled:return T.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case Qh.Disabled:case Qh.Uninitialized:return"Microphone Disabled";case Qh.Loading:return"Microphone Loading";default:return}},ghostTextRef:O,handleVoiceInChatInput:S,isMicrophoneActive:C,microphoneProps:T,setMicrophoneListeningStatus:E}}({chatInputRef:be,controlRef:ve,handleChatInputLoad:p,isDisabled:E,languageSupportsSpace:he,maxInputCharLimit:A,placeholderText:B,voiceInputProps:G}),Ie=xe.getMicrophoneLiveRegionText,we=xe.ghostTextRef,Te=xe.handleVoiceInChatInput,ke=xe.isMicrophoneActive,je=xe.microphoneProps,Pe=xe.setMicrophoneListeningStatus;se.useEffect((function(){return m&&m(),function(){v&&v()}}),[m,v]);var Ae=e.characterLimitErrorMessage?se.createElement(se.Fragment,null,se.createElement(Qr.b,null),e.characterLimitErrorMessage):void 0;return{isDisabled:E,isGroundingSourcePickerEnabled:!T&&void 0!==u,isPromptGuideMenuButtonEnabled:I&&void 0!==R,isCIQButtonEnabled:O,isGroundingButtonEnabled:T&&void 0!==c,isChatFooterDividerEnabled:I&&void 0!==R||O||T,isVoiceInputEnabled:void 0!==G,themeWrapper:{isDarkMode:S,themePalette:s},chatInputContainer:{id:gg,onBlur:function(){var e;If()&&!J&&(null===(e=ve.current)||void 0===e?void 0:e.getInputText())===dg&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return f(),[2]}))}))}),100)},ref:ge},groundingSourcePicker:Object(o.__assign)(Object(o.__assign)({},u),{isChatInputV3Enabled:!0,isChatInputBannerVisible:void 0!==W,isDisabled:!(null==u?void 0:u.alwaysEnable)&&E,onSelection:function(e){var t;le(e.placeholderText),null===(t=null==u?void 0:u.onSelection)||void 0===t||t.call(u,e)}}),chatInputBannerProps:W?Object(o.__assign)(Object(o.__assign)({},W),{isInputV3Enabled:!0}):void 0,chatInputContainerTooltip:{content:r,onVisibleChange:function(e,t){e&&"focus"===e.type?oe(!1):oe(t.visible)},positioning:"above",relationship:"label",visible:re,withArrow:!0},promptGuideMenuButton:{isDisabled:E,isMenuOpen:J,setMenuOpen:X,positioningRef:me,promptGuideMenuProps:R,title:D},ciqButton:{handleClick:function(){var e;null===(e=ve.current)||void 0===e||e.setInputText("/")},isDisabled:E,title:a},groundingButton:{isDisabled:E,isMenuOpen:ee,groundingButtonPluginProps:c,setMenuOpen:te,shouldBlockGroundingButtonClick:N,targetRef:null==pe?void 0:pe.current,title:bg()},chatFooterDivider:{appearance:"strong",vertical:!0},voiceInputTooltip:{content:Ie(),positioning:"above",relationship:"label",withArrow:!0},ariaLiveSpan:{"aria-live":"assertive",role:"alert"},microphoneButton:{"aria-live":"assertive",isDisabled:E,microphoneButtonProps:je},faiChatInput:{actions:{ref:pe},className:null==L?void 0:L.userInput,customNodes:[ff.c,mf.c,vf.c],disableSend:E||j||ue,disabled:E,editor:{"aria-label":"Prompt"},maxLength:A,onChange:function(e,t){fe.current&&(h(),fe.current=!1);var n=t.value;de(!n||""===n.trim())},onInput:b,onSubmit:function(e){var t,n,r,o;if(!(null==U?void 0:U())){e.stopPropagation(),Te&&Pe(!1);var i=null===(n=null===(t=ve.current)||void 0===t?void 0:t.getInputText())||void 0===n?void 0:n.trim();if(void 0!==i&&i.trimStart()!==dg&&!E){var a=ve.current?null==Oe?void 0:Oe.generateQueryAnnotations(be.current):void 0;y(i,a),null===(r=ve.current)||void 0===r||r.setInputText(dg),null===(o=we.current)||void 0===o||o.cancelGhostText()}}},placeholderValue:ae,ref:be,send:{title:z},errorMessage:Ae,children:se.createElement(se.Fragment,null,se.createElement(bf.a,{ref:ve}),se.createElement(yf.a,{id:"voiceInputGhostText",ref:we}),Ee,K?se.createElement(Lf,{languageSupportsSpace:he,tokenPhrases:Q,tokenListPhrases:q,onChatInputTokenAdded:function(e){Y&&Y(e,!0)},onChatInputTokenDeleted:function(e){Y&&Y(e,!1)}}):void 0)}}},Rf={chatInputOuterContainer:Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius(Le.a.borderRadiusXLarge)),De.a.margin(0,"16px","16px","16px")),chatInputContainer:{color:Le.a.colorNeutralForeground1,position:"relative",zIndex:"1"},faiChatInputWithGrounding:{borderTopLeftRadius:0,borderTopRightRadius:0}},Ff=Object(ue.a)(Rf),Nf=se.forwardRef((function(e,t){var n=Bf(e,t);return function(e){var t=Ff(),n=e.isDisabled,r=e.overrideStyles,o=e.isGroundingSourcePickerEnabled,i=e.chatInputBannerProps;e.themeWrapper.className=Object(E.a)(t.chatInputOuterContainer,!n&&(null==r?void 0:r.chatInputOuterContainer),e.themeWrapper.className),e.chatInputContainer.className=Object(E.a)(t.chatInputContainer,!n&&(null==r?void 0:r.chatInput),e.chatInputContainer.className),e.faiChatInput.className=Object(E.a)((o||i)&&t.faiChatInputWithGrounding,e.faiChatInput.className),e.ariaLiveSpan.className=Object(E.a)(!n&&(null==r?void 0:r.ariaLiveSpan),e.ariaLiveSpan.className)}(n),function(e){var t=e.ariaLiveSpan,n=e.chatFooterDivider,r=e.chatInputContainer,i=e.ciqButton,a=e.faiChatInput,s=e.groundingButton,l=e.groundingSourcePicker,c=e.isCIQButtonEnabled,u=e.isChatFooterDividerEnabled,d=e.isGroundingButtonEnabled,p=e.isGroundingSourcePickerEnabled,g=e.isPromptGuideMenuButtonEnabled,h=e.isVoiceInputEnabled,f=e.microphoneButton,m=e.promptGuideMenuButton,v=e.themeWrapper,b=e.voiceInputTooltip,y=e.chatInputBannerProps;return se.createElement(nh,Object(o.__assign)({},v),se.createElement("div",Object(o.__assign)({},r),y&&se.createElement(eg,Object(o.__assign)({},y)),p&&se.createElement(Uh,Object(o.__assign)({},l)),se.createElement(Jg.a,Object(o.__assign)({},a,{actions:Object(o.__assign)(Object(o.__assign)({},a.actions),{children:se.createElement("span",{style:{display:"flex",alignItems:"center"}},g&&se.createElement(zh,Object(o.__assign)({},m)),c&&se.createElement(Jp,Object(o.__assign)({},i)),d&&se.createElement(Ih,Object(o.__assign)({},s)),u&&se.createElement(Bi.a,Object(o.__assign)({},n)),h&&se.createElement(he.a,Object(o.__assign)({},b),se.createElement("span",Object(o.__assign)({},t),se.createElement(hf,Object(o.__assign)({},f)))))})}))))}(n)}));Nf.displayName="ChatInput",function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Cf||(Cf={}));var Hf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},De.a.borderRadius("8px")),De.a.borderColor(Le.a.colorNeutralBackground1)),(Of={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Of["&:hover .".concat(an.a.icon)]={color:Le.a.colorBrandForeground1},Of["&:hover:active .".concat(an.a.icon)]={color:Le.a.colorBrandForeground1},Of.display="flow",Of))}),Uf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},De.a.borderRadius("50%")),(Sf={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Le.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Le.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Le.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Sf["&.".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Sf["&:hover .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Sf["&:active .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Sf["&:hover:active .".concat(an.a.icon)]={color:Le.a.colorNeutralBackground1},Sf["&:hover"]={backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},Sf["&:hover:active"]={backgroundColor:Le.a.colorBrandForeground1,color:Le.a.colorNeutralBackground1},Sf["@media (forced-colors: active)"]={forcedColorAdjust:"none"},Sf))}),Vf=Object(ue.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),zf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground3},De.a.borderRadius("50%")),{color:Le.a.colorBrandForeground1}),loader:Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralBackground1},De.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Le.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Gf=Object(ue.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground4},De.a.borderColor(Le.a.colorNeutralBackground4)),(Ef={"&:hover":Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground4},De.a.borderColor(Le.a.colorNeutralBackground4))},Ef["&:hover .".concat(an.a.icon)]={color:Le.a.colorNeutralForegroundDisabled},Ef["&:hover:active .".concat(an.a.icon)]={color:"".concat(Le.a.colorNeutralForegroundDisabled," !important")},Ef))}),Wf=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(se.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(se.useState)(!1),2),l=s[0],c=s[1];Object(se.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(f.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(se.useEffect)((function(){n.microphoneState===Cf.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===Cf.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(se.useEffect)((function(){t?g(m.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(se.useRef)(Hf()),d=Object(o.__read)(Object(se.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(se.useRef)(Object(E.a)(u.current.root,zf().root)),f=Object(se.useRef)(Object(E.a)(u.current.root,Uf().root)),m=Object(se.useRef)(Object(E.a)(u.current.root,Gf().root)),v=le.a.createElement(me.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case Cf.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case Cf.Disabled:case Cf.Uninitialized:return"Microphone Disabled";case Cf.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?le.a.createElement(lu.a,{title:"Mic-Filled"}):le.a.createElement(lu.b,{title:"Mic-Regular"}),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return le.a.createElement("div",{className:Vf().root},n.isTooltipDisabled?v:le.a.createElement(he.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},v),i&&le.a.createElement("div",{className:zf().loader}),le.a.createElement(sf,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},Qf=Object(ue.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),qf=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(E.a)(o,t)),n?o=r?Object(E.a)(o,e.horizontalReverse):Object(E.a)(o,e.horizontal):r&&(o=Object(E.a)(o,e.verticalReverse)),o}(Qf(),n,i,s);return se.createElement("div",Object(o.__assign)({className:c},l),t)},Kf={chatInputOuterContainer:Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius(Le.a.borderRadiusXLarge)),De.a.margin(0,"16px","16px","16px")),chatInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralForeground1,backgroundColor:Le.a.colorNeutralBackground1},De.a.border("1px","solid",Le.a.colorNeutralStroke1)),De.a.borderRadius(Le.a.borderRadiusXLarge)),De.a.padding("4px")),De.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(o.__assign)(Object(o.__assign)({},De.a.margin("12px","12px","4px","12px")),{maxHeight:"168px",overflowY:"auto"}),userInput:{},chatInputButtons:Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground1,width:"100%",flexDirection:"row",flexWrap:"wrap"},De.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputCharCount:{},chatInputLeftButtons:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Le.a.colorNeutralForeground4,alignSelf:"flex-start"},De.a.margin("12px","12px","4px","12px")),De.a.gap("6px")),{fontStyle:"normal",fontSize:"10px",justifyItems:"center"}),chatInputRightButtons:{display:"flex",flexDirection:"row",alignSelf:"flex-end"},contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},De.a.padding("6px")),{backgroundColor:Le.a.colorNeutralBackground1,boxShadow:Le.a.shadow4}),De.a.borderRadius("8px")),chatInputCharCountError:{position:"absolute",left:"-9999px"}},Yf=Object(ue.a)(Kf),Zf=Object(ue.a)({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},De.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(Le.a.colorBrandForeground1,", ").concat(Le.a.colorCompoundBrandForeground1Hover,")")})}}}),Jf=Object(ue.a)({chatInput:{backgroundColor:Le.a.colorNeutralBackground4},chatInputButtons:{backgroundColor:Le.a.colorNeutralBackground4},chatInputCharCount:{userSelect:"none","@media (forced-colors: active)":{forcedColorAdjust:"none"}}});var Xf,$f=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return le.a.createElement(he.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},le.a.createElement(me.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=Pt.h,n=Pt.g,r=Object(Oe.a)(n,t),le.a.createElement(r,null))},onClick:a,disabled:i}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Xf||(Xf={}));var em=function(){function e(e,t,n,r,i,a,s,l,c,u,d,p){var g=this;this.onTryAgainClicked=function(){(new Date).getTime(),zp(g.isMicrophoneListening,hg,g.setShouldShowMicrophonePermissionRetryDialog,g.setMicrophoneState,g.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(o.__awaiter)(g,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u,d;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),this.isMicrophoneListening?((null===(r=this.chatInputRef.current)||void 0===r?void 0:r.getGhostText())!=dg&&(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=this.chatPlaceHolderMessage&&(null===(s=null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=fg()&&(null===(l=this.chatInputRef.current)||void 0===l||l.setInputText((null===(c=this.chatInputRef.current)||void 0===c?void 0:c.getInputText())+(null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getGhostText())),null===(d=this.chatInputRef.current)||void 0===d||d.setGhostText("")),[4,Vp(this.setMicrophoneListeningStatus)]):[3,3];case 2:return o.sent(),[3,6];case 3:return this.microphoneState===Xf.Uninitialized&&this.setMicrophoneState(Xf.Loading),(new Date).getTime(),[4,Lp.GetInstance().Resume()];case 4:return o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(Xf.Enabled),[4,Gp(hg,this.setMicrophoneListeningStatus)];case 5:o.sent(),o.label=6;case 6:return[3,10];case 7:return t=o.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Lp.GetInstance().Pause()];case 8:o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),o.label=9;case 9:return this.setMicrophoneState(Xf.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=r,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}();var tm=le.a.forwardRef((function(e,t){var n=e.isDisabled,r=e.isSubmitButtonDisabled,i=e.copilotChatTheme,a=void 0===i?eh.palette:i,s=e.isDarkMode,l=e.dir,c=void 0===l?void 0:l,u=e.overrideStyles,d=e.chatInputTabIndex,p=void 0===d?0:d,g=e.chatInputContainerTabIndex,h=void 0===g?-1:g,f=e.chatInputContainerTitle,m=void 0===f?sg():f,v=e.placeholderText,b=void 0===v?ug():v,y=e.maxInputCharLimit,C=void 0===y?2e3:y,O=e.isHVCAppChatV2Enabled,S=void 0!==O&&O,x=e.hvcPromptStrings,I=void 0===x?[]:x,w=e.onChatInputHVCPromptUpdated,T=void 0===w?function(e,t){}:w,k=e.handleKeyDown,j=e.handleKeyUp,P=e.handleOnPaste,A=e.handleOnBeforeInput,_=e.handleOnInput,D=e.submitButtonTitle,L=void 0===D?cg():D,M=e.handleSubmitButtonClick,B=e.isMenuButtonEnabled,R=void 0!==B&&B,F=(e.shouldOpenMenuOnEmptyInput,e.menuButtonTitle),N=void 0===F?lg():F,H=(e.handleMenuButtonClick,e.handleOnOpenMenu,e.handleOnChatInputControlMount),U=e.handleOnChatInputControlUnmount,V=e.handleOnBlur,z=e.promptGuideMenuProps,G=e.voiceInputProps,W=e.isCIQButtonEnabled,Q=void 0!==W&&W,q=e.ciqButtonTitle,K=void 0===q?vg():q,Y=e.isGroundingButtonEnabled,Z=void 0!==Y&&Y,J=e.groundingSourcePickerProps,X=e.groundingButtonPluginProps,$=e.shouldBlockGroundingButtonClick,ee=void 0===$?function(){return!1}:$,te=e.shouldBlockSubmitButtonClick,ne=void 0===te?function(){return!1}:te,re=e.handleFirstUserInput,oe=void 0===re?function(){}:re,ie=e.handleChatInputLoad,ae=void 0===ie?function(){}:ie,ce=e.editorProps,ue=e.isSensitivityIndicatorLoading,de=e.imageInputEnabled,pe=e.chatInputBannerProps,ge=Object(se.useRef)(),fe=Object(se.useRef)(),me=Object(se.useRef)(null),ve=Object(se.useRef)(),be=le.a.useRef(),ye=Object(se.useRef)(),Ce=Object(se.useRef)(!1),Oe=Object(se.useRef)(!0),Se=Object(se.useRef)(!0),Ee=Object(se.useRef)(null==G?void 0:G.alSession),xe=!(!(null==G?void 0:G.handleInChatInput)||!(null==G?void 0:G.alSession)&&!(null==G?void 0:G.alSessionConfig)),Ie=Object(o.__read)(Object(se.useState)(void 0),2),we=Ie[0],Te=Ie[1],ke=Object(o.__read)(le.a.useState(void 0),2),je=ke[0],Pe=ke[1],Ae=Object(o.__read)(Object(se.useState)(0),2),_e=Ae[0],De=Ae[1];Object(se.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=ge.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=ge.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getImages()},setInputText:function(e,t){var n,r;void 0===t&&(t=!1),null===(n=ge.current)||void 0===n||n.setInputText(e,t),De(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)},updateInputText:function(e,t){var n,r;null===(n=ge.current)||void 0===n||n.updateInputText(e,t),De(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)},getInputText:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){var t;null===(t=ge.current)||void 0===t||t.setGhostText(e)},getGhostText:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=ge.current)||void 0===e||e.setFocus()},closeMenu:function(){R&&Me&&Be(!1),Z&&Fe&&Ne(!1),xe&&Ce.current&&tt(!1)},getCIQTextRef:function(){return ye.current},getChatEditorInstance:function(){return je},getCIQResponseHandler:function(){return we},setMenuButtonFocus:function(){document.getElementById("ViewPromptsID").focus()}}}));var Le=Object(o.__read)(Object(se.useState)(!1),2),Me=Le[0],Be=Le[1],Re=Object(o.__read)(Object(se.useState)(!1),2),Fe=Re[0],Ne=Re[1],He=Object(o.__read)(Object(se.useState)(!1),2),Ue=He[0],Ve=He[1],ze=Object(o.__read)(Object(se.useState)(Cf.Uninitialized),2),Ge=ze[0],We=ze[1],Qe=Object(o.__read)(Object(se.useState)(!1),2),qe=Qe[0],Ke=Qe[1],Ye=Object(o.__read)(Object(se.useState)(!1),2),Ze=Ye[0],Je=Ye[1],Xe=Object(o.__read)(Object(se.useState)(b),2),$e=Xe[0],et=Xe[1],tt=function(e){var t,n,r,o,i,a,s;if(e){var l=(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>0&&Se.current?mg:dg;null===(n=ge.current)||void 0===n||n.setGhostText(l+fg())}else(null===(r=ge.current)||void 0===r?void 0:r.getInputText())===dg?null===(o=ge.current)||void 0===o||o.setGhostText(b):(null===(a=null===(i=ge.current)||void 0===i?void 0:i.getGhostText())||void 0===a?void 0:a.trim())===fg()&&(null===(s=ge.current)||void 0===s||s.setGhostText(dg));Je(e),Ce.current=e},nt=function(e){var t,r,o,i,a,s;if(Ce.current&&xe&&!n&&!(null!=ge.current&&(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>=C)){var l=(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?mg:dg,c=null!=ge.current?(null===(o=ge.current)||void 0===o?void 0:o.getInputText())+l+e:dg;null===(i=ge.current)||void 0===i||i.setInputText(c),null===(a=ge.current)||void 0===a||a.setGhostText(dg),null===(s=ge.current)||void 0===s||s.setFocus()}},rt=function(e){var t,r,o;if(Ce.current&&xe&&!n&&!(null!=ge.current&&(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>=C)){var i=(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?mg:dg;null===(o=ge.current)||void 0===o||o.setGhostText(i+e),e.trim()&&Gp(hg,tt)}},ot=new em(Ze,qe,Ge,null==G?void 0:G.microphonePermissionErrorTitle,null==G?void 0:G.microphonePermissionErrorMessage,Ke,We,tt,ge,b,null==G?void 0:G.microphonePermissionImagePath,null==G?void 0:G.showMicrophonePermissionHelpLink),it=xe?ot.getMicrophoneButtonProps():null==G?void 0:G.microphoneButtonProps;it&&!it.title&&(it.title=rg()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone");var at=!1,st=function(){var e;Oe.current&&(oe(),Oe.current=!1);var t=null===(e=ge.current)||void 0===e?void 0:e.getInputText();t=t.replace("\n",""),De(t.length)},lt=!1;Object(se.useEffect)((function(){var e;et(b),null===(e=ge.current)||void 0===e||e.setGhostText(b)}),[b]),Object(se.useEffect)((function(){var e;fe.current&&(null===(e=me.current)||void 0===e||e.setTarget(fe.current))}),[me,fe]),Object(se.useEffect)((function(){s?je&&je.updateCurrentTheme(ju.dark):je&&je.updateCurrentTheme(ju.light)}),[s]),Object(se.useEffect)((function(){if((null==ce?void 0:ce.handleInChatInput)&&(null==ce?void 0:ce.editorConfig)&&!be.current&&(null==ce?void 0:ce.alSession)){var e=(new dp).createInstance();e.bootstrap(og(ce.editorConfig,ce.alSession)).then((function(t){be.current=e,Pe(t)}))}return function(){be.current&&be.current.shutdown().then((function(){be.current=void 0}))}}),[null==ce?void 0:ce.alSession]),Object(se.useEffect)((function(){if((null==ce?void 0:ce.handleInChatInput)&&(null==ce?void 0:ce.editorConfig)&&!we&&je&&ge.current){var e=je.initializeCiq(ge.current.getInputSpanElement(),{menuTitle:null==ce?void 0:ce.editorConfig.transformFileMenuTitle,menuSubtitle:(null==ce?void 0:ce.editorConfig.transformFilePlaceholderText)?null==ce?void 0:ce.editorConfig.transformFilePlaceholderText:dg,queryCharToUse:$u,onItemSelected:function(t){var n,r;null===(n=ge.current)||void 0===n||n.setGhostText(dg),null===(r=ge.current)||void 0===r||r.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,ue,a,s,ye),ce.postCIQItemSelectionHandler&&ce.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==ce?void 0:ce.editorConfig.entitiesSupported,ExpanededECC:null==ce?void 0:ce.editorConfig.isExpandedECCEnabled});Te(e)}}),[je,we]),Object(se.useEffect)((function(){var e;Ze||Vp(tt).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=ge.current)||void 0===e||e.setFocus()}),[Ze]);var ct=Yf(),ut=Zf(),dt=Jf(),pt=Object(se.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),gt=Object(se.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),ht=Object(o.__read)(Object(se.useState)(ct),2),ft=ht[0],mt=ht[1];Object(se.useEffect)((function(){for(var e in ct)pt.current[e]=Object(E.a)(ct[e],ut[e]);for(var e in ct)gt.current[e]=Object(E.a)(ct[e],dt[e]);xe&&Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return null!=Ee.current?[3,2]:(e=Ee,[4,ig(null==G?void 0:G.alSessionConfig)]);case 1:e.current=n.sent(),n.label=2;case 2:return Ee.current?(t=qp(G.voiceInputLocale),[4,Fp(t,nt,rt,We,tt,Ee.current)]):[3,4];case 3:n.sent(),Se.current=Kp(qp(t)),n.label=4;case 4:return[2]}}))})),ae()}),[]),Object(se.useEffect)((function(){if(u)for(var e in ct)pt.current[e]=Object(E.a)(ct[e],u[e])}),[u]),Object(se.useEffect)((function(){var e;n?mt(gt.current):(mt(pt.current),null===(e=ge.current)||void 0===e||e.setFocus())}),[n,u]);return le.a.createElement(nh,{className:ft.chatInputOuterContainer,themePalette:a,isDarkMode:s,dir:c},le.a.createElement("div",{id:gg,className:ft.chatInput,tabIndex:h,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){return n||document.activeElement===(null===(e=ge.current)||void 0===e?void 0:e.getInputSpanElement())||null===(t=ge.current)||void 0===t||t.setFocus(),[2]}))}))},onMouseDown:function(e){If()&&e.preventDefault()},onBlur:function(){var e;If()&&!Me&&(null===(e=ge.current)||void 0===e?void 0:e.getInputText())===dg&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return V(),[2]}))}))}),100)},ref:fe},pe&&le.a.createElement(eg,Object(o.__assign)({},pe)),!Z&&J&&le.a.createElement(Uh,Object(o.__assign)({},J,{onSelection:function(e){et(e.placeholderText),J&&J.onSelection&&J.onSelection(e)},isDisabled:!J.alwaysEnable&&n,isChatInputBannerVisible:void 0!==pe})),le.a.createElement(he.a,{content:m,relationship:"label",positioning:"above",withArrow:!0,visible:Ue,onVisibleChange:function(e,t){e&&"focus"===e.type?Ve(!1):Ve(t.visible)}},le.a.createElement("div",null,le.a.createElement("div",{className:ft.chatInputContainer},le.a.createElement(Zg,{ref:ge,styleOverrideClassName:u?u.userInput:"",placeholderText:$e,chatInputTabIndex:p,isDisabled:n,isHVCAppChatV2Enabled:S,hvcPromptStrings:I,onChatInputHVCPromptUpdated:T,handleKeyDown:function(e){var t,r,o,i,a;if(at="Process"===e.key,!e.nativeEvent.isComposing)if(lt&&"Enter"===e.key)lt=!1;else if(!k||k(e)){var s;if("Backspace"===e.key)if((c=window.getSelection())&&c.isCollapsed&&0!==c.anchorOffset&&(" "===c.anchorNode.textContent||c.anchorNode.lastChild&&" "===c.anchorNode.lastChild.textContent)){var l=c.anchorNode.lastChild?c.anchorNode.lastChild.previousSibling:c.anchorNode.previousSibling;l&&((s=l.lastChild)&&s instanceof HTMLElement&&"false"===s.contentEditable)&&(e.preventDefault(),c.modify("move","backward","character"))}if("Enter"===e.key)if(e.preventDefault(),e.shiftKey){if(_e===C)return;var c;null===(t=ge.current)||void 0===t||t.setGhostText(dg),(c=window.getSelection()).getRangeAt(0).insertNode(document.createElement("br")),c.collapseToEnd(),null===(r=ge.current)||void 0===r||r.scrollToBottom(),st()}else if(!n){var u=ge.current?null==we?void 0:we.generateQueryAnnotations(ge.current.getInputSpanElement()):void 0;M(null===(o=ge.current)||void 0===o?void 0:o.getInputText(),u),null===(i=ge.current)||void 0===i||i.setInputText(dg),null===(a=ge.current)||void 0===a||a.setGhostText($e)}}else xe&&"Enter"===e.key&&!e.shiftKey&&tt(!1)},handleKeyUp:function(e){var t,n,r,o;j&&!j(e)||((null===(t=ge.current)||void 0===t?void 0:t.getInputText())===dg?null===(n=ge.current)||void 0===n||n.setGhostText($e):(null===(r=ge.current)||void 0===r?void 0:r.getGhostText())===$e&&(null===(o=ge.current)||void 0===o||o.setGhostText(dg)))},handleOnPaste:function(e){var t,r,o;if(n)e.preventDefault();else if(!P||P(e)){if(e.preventDefault(),Ve(!1),null===(t=ge.current)||void 0===t||t.setGhostText(dg),de&&e.clipboardData.files.length>0){var i=new FileReader;i.addEventListener("load",(function(){var e;null===(e=ge.current)||void 0===e||e.addImage(i.result)})),i.readAsDataURL(e.clipboardData.files[0])}var a=e.clipboardData.getData("Text"),s=a.length||0,l=null===(r=ge.current)||void 0===r?void 0:r.getInputText(),c=window.getSelection();if(c.rangeCount){var u=c.toString(),d=l.length-u.length,p=a.substring(0,C-d);c.deleteFromDocument(),d+s>=C?c.getRangeAt(0).insertNode(document.createTextNode(p)):c.getRangeAt(0).insertNode(document.createTextNode(a)),c.collapseToEnd(),null===(o=ge.current)||void 0===o||o.scrollToBottom(),st()}}},handleOnBeforeInput:function(e){var t;A&&!A(e)||(_e!==C?(Be(!1),Ne(!1),null===(t=ge.current)||void 0===t||t.setGhostText(dg)):e.preventDefault())},handleOnInput:function(e){Ve(!1),st(),!_||_(e)},handleOnCompositionEnd:function(){at||(lt=!0)},handleOnFocusTextArea:function(){Ve(!1)},handleOnChatInputControlMount:H,handleOnChatInputControlUnmount:U}),le.a.createElement("span",{"aria-hidden":!0,onPaste:function(e){e.preventDefault()}},"‍")),le.a.createElement("div",{ref:ve},le.a.createElement(qf,{style:ft.chatInputButtons},le.a.createElement("div",{className:ft.chatInputLeftButtons},le.a.createElement("span",{contentEditable:!1,suppressContentEditableWarning:!1,className:ft.chatInputCharCount,"aria-live":"assertive"},_e,"/",C,_e>=C&&le.a.createElement("span",{className:ft.chatInputCharCountError},"Maximum character limit reached"))),le.a.createElement("div",{className:ft.chatInputRightButtons},R&&z&&le.a.createElement(zh,{title:N,isDisabled:n,isMenuOpen:Me,setMenuOpen:Be,positioningRef:me,promptGuideMenuProps:z}),Q&&le.a.createElement(Jp,{title:K,isDisabled:n,handleClick:function(){var e,t;null===(e=ge.current)||void 0===e||e.updateInputText($u,Yp.InsertAtCursor),null===(t=ge.current)||void 0===t||t.setGhostText(dg)}}),Z&&X&&le.a.createElement(Ih,{title:bg(),isDisabled:n,isMenuOpen:Fe,setMenuOpen:Ne,targetRef:null==ve?void 0:ve.current,groundingButtonPluginProps:X,shouldBlockGroundingButtonClick:ee}),(R&&z||Q||Z)&&le.a.createElement(Bi.a,{vertical:!0,appearance:"strong"}),G&&le.a.createElement("span",{"aria-live":"assertive",role:"alert"},le.a.createElement(Wf,{"aria-live":"assertive",isDisabled:n,microphoneButtonProps:it})),le.a.createElement($f,{title:L,isDisabled:n||r||0===_e,handleClick:function(e){var t,r,o;if(!ne||!ne()){e.stopPropagation(),xe&&tt(!1);var i=null===(t=ge.current)||void 0===t?void 0:t.getInputText();if(i.trimStart()!==dg&&!n){var a=ge.current?null==we?void 0:we.generateQueryAnnotations(ge.current.getInputSpanElement()):void 0;M(i,a),null===(r=ge.current)||void 0===r||r.setInputText(dg),null===(o=ge.current)||void 0===o||o.setGhostText($e)}}}}))))))))})),nm=le.a.forwardRef((function(e,t){var n=e.isVersion3Enabled,r=void 0!==n&&n,i=Object(o.__rest)(e,["isVersion3Enabled"]);return r?le.a.createElement(Nf,Object(o.__assign)({},i,{ref:t})):le.a.createElement(tm,Object(o.__assign)({},i,{ref:t}))}));nm.displayName="ChatInput";var rm,om,im,am,sm,lm,cm=le.a.memo(nm),um=n(207),dm=n(837),pm=n(1158),gm=n(796),hm=n(1139),fm=n(485);!function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.QueryDetails="QueryDetails",e.Microphone="Microphone"}(rm||(rm={})),function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.AugloopResponseTime="AugloopResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.ImageResponseTime="ImageResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.QnAResponseTime="QnAResponseTime",e.QnAChunkInfo="QnAChunkInfo",e.SuggestedQnAResponseTime="SuggestedQnAResponseTime",e.AnnotationType="AnnotationType",e.RequestSignalType="RequestSignalType",e.FeatureName="FeatureName",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.IsFirstSdxSessionQuery="IsFirstSdxSessionQuery",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.PluginsConfig3SFetchTime="PluginsConfig3SFetchTime",e.CopilotChatLoadTime="CopilotChatLoadTime"}(om||(om={})),function(e){e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorKey="ChatErrorKey",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorType="ChatErrorType",e.IsFromCache="IsFromCache",e.IsStreamingResponse="IsStreamingResponse",e.Cv="Cv"}(im||(im={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory"}(am||(am={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.SubmitButtonClicked="Submit_Button_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.ZQMButtonV2Clicked="ZQM_Button_V2_Clicked",e.ZQMLoaded="ZQM_Loaded",e.MenuItemClicked="Menu_Item_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.QueryResubmittedToAL="Query_Resubmitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.HintCardShownOnSubmission="Hint_Card_Shown",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.ALAnnotationReceived="AL_Annotation_Received",e.ChatHistoryTimeout="Chat_History_Timeout",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.EntityLabelOperationSubmitted="Entity_Label_Operation_Submitted",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.GetCurrentChatStatus="GetCurrentChat_Status",e.GetMessagesStatus="GetMessages_Status",e.DeleteMessageStatus="DeleteMessage_Status",e.GetAllChatStatus="GetAllChat_Status",e.AddMessageStatus="AddMessage_Status",e.FeedbackDataUploadOperationSubmitted="FeedbackDataUpload_Operation_Submitted",e.FeedbackDataSydneyDataMissing="FeedbackData_SydneyData_Missing",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionCompleted="Query_Execution_Completed",e.ChatPaneLoadMessageBarShown="ChatPaneLoad_MessageBar_Shown",e.FirstUserInputReceived="First_User_Input_Received",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.ChatInputLoaded="ChatInput_Loaded",e.FirstQuerySubmitted="First_Query_Submitted",e.CopilotLicensingAnnotationActivated="Copilot_Licensing_Annotation_Activated",e.ResetOperationListForResubmit="Reset_Operation_List_For_Resubmit",e.AddToOperationListForResubmit="Add_To_Operation_List_For_Resubmit",e.ChatInputDisabledAndBannerShownForInActiveChatSession="ChatInput_Disabled_And_Banner_Shown_For_InActive_Chat_Session",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TrySydneyToggle="Try_Sydney_Toggle",e.IsSydneyEnabled="Is_Sydney_Enabled",e.HubbleEnterprisePromptClicked="EnterpriseImagePrompt_Clicked",e.BasicChatOperationSubmitted="Basic_Chat_Operation_Submitted",e.BasicChatStreamingResponseTimeout="Basic_Chat_Streaming_Response_Timeout",e.CachedBasicChatResponseShown="Cached_Basic_Chat_Response_Shown",e.EmptyBasicChatResponse="Empty_Basic_Chat_Response",e.QuerySuccessful="Query_Successful",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CLPEncryptedLabelSent="CLP_Encrypted_Label_Sent",e.CLPNonEncryptedLabelSent="CLP_Non_Encrypted_Label_Sent",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabGoToCopilotLabButtonClicked="Copilot_Lab_GoToCopilotLab_Button_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.GroundingSourceUpdated="Grounding_Source_Updated",e.MenuButtonClicked="Menu_Button_Clicked",e.MenuL1SuggestionClicked="Menu_L1_Suggestion_Clicked",e.MenuL2SuggestionClicked="Menu_L2_Suggestion_Clicked",e.PluginConfigSignalSent="Plugin_Config_Signal_Sent",e.PromptSubmittedWithCIQ="Prompt_Submitted_With_CIQ",e.CIQSuggestionSelected="CIQ_Suggestion_Selected",e.SubstrateAPIOperationSubmitted="Substrate_API_Operation_Submitted"}(sm||(sm={})),function(e){e.AugloopResponseTimeoutMessage="AugloopResponseTimeoutMessage"}(lm||(lm={}));var mm,vm,bm,ym,Cm,Om,Sm,Em,xm,Im=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},sm),om),am),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(mm||(mm={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(vm||(vm={})),function(e){e.BasicChat="Basic Chat",e.ContentCreation="Content Creation Skill in Chat"}(bm||(bm={})),function(e){e.Client="Client",e.Server="Server"}(ym||(ym={})),function(e){e.ChatQnA="Chat QnA",e.Draft="Draft",e.CopilotChat="CopilotChat"}(Cm||(Cm={})),function(e){e.BasicChatRAIFilterBlockedResponse="Ask Chat QnA Responsible AI Filter Blocked Response",e.ChatComposeDidNotGenerateContent="CopilotChatComposeDidNotGenerateContent",e.BasicChatUnsupportedCopilotFunctionality="Ask Chat QnA Unsupported Copilot Functionality",e.BasicChatMissingCopilotFunctionality="Ask Chat QnA Missing Copilot Functionality",e.BasicChatResponseTimedOut="Ask Chat QnA Response Delayed or Timed Out",e.BasicChatCapacityIssues="Ask Chat QnA Unable to Generate Response Due to Capacity Issue",e.BasicChatBadResponse="Ask Chat QnA LLM Service Side Issue Prevents Output",e.BasicChatInputNotProcessed="Ask Chat QnA User Input Could Not Be Processed",e.BasicChatTaskCompletionIssue="Ask Chat QnA Unable to Complete Task",e.BasicChatUnclassifiedError="Ask Chat QnA Unclassified ASHA Error",e.BasicChatUserCancelledResponse="Ask Chat QnA User Rejected or Cancelled Response"}(Om||(Om={})),function(e){e.UserAccessIssue="Unclear Intent CopilotChat User Access Issue for Copilot"}(Sm||(Sm={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.InputTooLong="Error occurred because input is too long",e.UserThrottled="Error occurred because user has issued too many requests",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.Timeout="Timeout waiting for server",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidSignal="Error occurred because signal/response is invalid",e.PromptInjection="Error occurred because prompt injection is detected",e.InputBlocked="Error occurred because input is blocked by filters",e.OutputBlocked="Error occurred because output is blocked by filters",e.OffensiveInput="Error occurred because user input is offensive",e.OffensiveOutput="Error occurred because offensive content is blocked in output",e.SignalMissing="Error occurred because signal is missing in workflow",e.SignalWrongType="Error occurred because signal is invalid",e.BadResponse="Error occured because of bad response",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.BadRequest="Error occured because of bad request",e.Unknown="Error is unknown",e.UserAbortedQueryExecution="User aborted query execution",e.APIUnavailable="Error occured because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated output",e.UnknownError="Unknown error from model"}(Em||(Em={})),function(e){e.Licensing="Error occured because copilot license couldn't be validated"}(xm||(xm={}));var wm,Tm,km,jm,Pm,Am,_m,Dm,Lm,Mm="UserQueryGuid",Bm="Chat",Rm=function(){function e(e){this.copilotCommunicationHandler=e}return e.getInstance=function(t){if(void 0===e.instance){if(void 0===t)throw new Error("copilotCommunicationHandler is undefined");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.sendLoggingEventToClient=function(e,t){this.copilotCommunicationHandler.sendLoggingEventToClient(e,t)},e}(),Fm=Rm;!function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(wm||(wm={})),function(e){e[e.ACTION_AI=0]="ACTION_AI",e[e.COPILOT_ODSL=1]="COPILOT_ODSL"}(Tm||(Tm={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(km||(km={})),function(e){e[e.QUERY_ENTERED=0]="QUERY_ENTERED",e[e.QUERY_SUBMITTED=1]="QUERY_SUBMITTED",e[e.QUERY_SUBMITTED_FAILED=2]="QUERY_SUBMITTED_FAILED",e[e.RESPONSE_RECEIVED=3]="RESPONSE_RECEIVED",e[e.RESPONSE_SENT=4]="RESPONSE_SENT",e[e.EXECUTION_COMPLETE=5]="EXECUTION_COMPLETE",e[e.IDLE=6]="IDLE"}(jm||(jm={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(Pm||(Pm={})),function(e){e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.PARTIAL_SUCCESS="PARTIAL"}(Am||(Am={})),function(e){e[e.AnnotationActivated=0]="AnnotationActivated",e[e.AugloopResponseTimeout=1]="AugloopResponseTimeout",e[e.StopGeneratingButtonClicked=2]="StopGeneratingButtonClicked",e[e.CopilotChatLoaded=3]="CopilotChatLoaded",e[e.CitationLinkClicked=4]="CitationLinkClicked",e[e.BasicChatSuggestionPills=5]="BasicChatSuggestionPills",e[e.BasicChatStatus=6]="BasicChatStatus",e[e.ChatTopicChanged=7]="ChatTopicChanged",e[e.ChatHistoryHydrationFailed=8]="ChatHistoryHydrationFailed",e[e.QuerySubmitted=9]="QuerySubmitted",e[e.UpdateChatClpFromChatHistory=10]="UpdateChatClpFromChatHistory",e[e.PluginsStateUpdated=11]="PluginsStateUpdated",e[e.ResetContextId=12]="ResetContextId",e[e.PythonExitAnalysisButtonClicked=13]="PythonExitAnalysisButtonClicked"}(_m||(_m={})),function(e){e.ALSessionInitialized="AL_Session_Initialized",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.ChatHistoryResponseReceived="Chat_History_Response_Received",e.ChatPaneInitalized="Chat_Pane_Initialized",e.ChatPaneLoaded="Chat_Pane_Loaded",e.MenuButtonItemClicked="Menu_Button_Item_Clicked",e.MenuButtonItemClickedL1="Menu_Button_Item_Clicked_L1",e.ZQMButtonItemClicked="ZQM_Button_Item_Clicked",e.InputAreaTextChangedToEmpty="Input_Area_Text_Changed_Empty",e.ZQMLoaded="ZQM_Loaded",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.AugloopResponseReceived="Augloop_Response_Received",e.AugloopErrorReceived="Augloop_Error_Received",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionStarted="Query_Execution_Started",e.QueryExecutionCompleted="Query_Execution_Completed",e.CopilotSwitcherMenuStateChange="Copilot_Switcher_Menu_State_Change"}(Dm||(Dm={})),function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(Lm||(Lm={}));var Nm,Hm,Um,Vm,zm,Gm,Wm=n(131),Qm=n(48);!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=3]="SystemMetadata",e[e.OrganizationIdentifiableInformation=4]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=5]="EndUserIdentifiableInformation",e[e.CustomerContent=6]="CustomerContent",e[e.AccessControl=7]="AccessControl",e[e.PublicNonPersonalData=8]="PublicNonPersonalData",e[e.EndUserPseudonymousInformation=9]="EndUserPseudonymousInformation",e[e.PublicPersonalData=10]="PublicPersonalData",e[e.SupportData=11]="SupportData",e[e.Everything=12]="Everything"}(Nm||(Nm={})),function(e){e[e.CP_EVENT_TYPE_NOT_SET=1]="CP_EVENT_TYPE_NOT_SET",e[e.CP_EVENT_TYPE_CRITICAL=2]="CP_EVENT_TYPE_CRITICAL"}(Hm||(Hm={})),function(e){e[e.CP_DATA_CATEGORY_NOT_SET=1]="CP_DATA_CATEGORY_NOT_SET",e[e.CP_DATA_CATEGORY_SOFTWARE_SETUP=2]="CP_DATA_CATEGORY_SOFTWARE_SETUP",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE=3]="CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE=4]="CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE",e[e.CP_DATA_CATEGORY_DEVICE_CONFIGURATION=5]="CP_DATA_CATEGORY_DEVICE_CONFIGURATION",e[e.CP_DATA_CATEGORY_INKING_TYPING_SPEECH=6]="CP_DATA_CATEGORY_INKING_TYPING_SPEECH"}(Um||(Um={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.QueryDetails="QueryDetails",e.Chat="Chat"}(Vm||(Vm={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone",e.AshaError="AshaError"}(zm||(zm={})),function(e){e[e.CP_DIAGNOSTIC_LEVEL_OPTIONAL=1]="CP_DIAGNOSTIC_LEVEL_OPTIONAL",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED=2]="CP_DIAGNOSTIC_LEVEL_REQUIRED",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES=3]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA=4]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA"}(Gm||(Gm={}));var qm=function(){function e(){}return e.prototype.LogTelemetryEvent=function(e){gy("LogTelemetryEvent: EventName: "+e.GetEventName()+"\n EventType: "+e.GetEventType()+"\n EventLogs: ",e.GetLogs())},e}(),Km=function(){function e(e,t,n,r,o,i,a,s,l,c){this.logs=n,this.isRequired=s||!1,this.shouldLog=null==a||a,this.eventType=e,this.eventName=t,this.diagnosticLevel=c||Gm.CP_DIAGNOSTIC_LEVEL_OPTIONAL,this.dataCategory=l||Um.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,this.scenarioName=r,this.capability=o,this.verb=i||""}return e.prototype.GetLogs=function(){return this.logs},e.prototype.SetLogs=function(e){this.logs=e},e.prototype.AddLog=function(e){this.logs.push(e)},e.prototype.IsRequired=function(){return this.isRequired},e.prototype.SetIsRequired=function(e){this.isRequired=e},e.prototype.SetEventType=function(e){this.eventType=e},e.prototype.GetEventType=function(){return this.eventType},e.prototype.SetEventName=function(e){this.eventName=e},e.prototype.GetEventName=function(){return this.eventName},e.prototype.SetDataCategory=function(e){this.dataCategory=e},e.prototype.GetDataCategory=function(){return this.dataCategory},e.prototype.SetDiagnosticLevel=function(e){this.diagnosticLevel=e},e.prototype.GetDiagnosticLevel=function(){return this.diagnosticLevel},e.prototype.SetScenarioName=function(e){this.scenarioName=e},e.prototype.GetScenarioName=function(){return this.scenarioName},e.prototype.SetCapability=function(e){this.capability=e},e.prototype.GetCapability=function(){return this.capability},e.prototype.GetShouldLog=function(){return this.shouldLog},e.prototype.SetShouldLog=function(e){this.shouldLog=e},e.prototype.GetVerb=function(){return this.verb},e.prototype.SetVerb=function(e){this.verb=e},e}(),Ym=function(){function e(){var e=this;this.chatHistoryInfoLog=[],this.userQueryGuid=dv,this.getTelemetryLatencyEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:om.CopilotChatHistoryInfoJson,value:JSON.stringify(e.chatHistoryInfoLog)}]))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),n&&e.setUserQueryGuid(dv),new Km(Vm.Latency,zm.Latency,t,r,o,i,n)},this.getASHATelemetryErrorEvent=function(t,n,r,i,a,s,l){return(t=t.concat.apply(t,Object(o.__spreadArray)([],Object(o.__read)(i&&a?Object(o.__spreadArray)([],Object(o.__read)(Wm.c.getFields({eventType:Wm.c.EventType.Error,veto:i,error:a,inStaging:null==s||s})),!1):[]),!1))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),new Km(Vm.Error,zm.AshaError,t,n,r,l)},this.getASHAPillarTelemetryEvent=function(t,n,r,i,a){return(t=t.concat.apply(t,Object(o.__spreadArray)([],Object(o.__read)(i?Object(o.__spreadArray)([],Object(o.__read)(Wm.c.getFields({eventType:Wm.c.EventType.Pillar,pillar:i})),!1):[]),!1))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),new Km(Vm.ChatEvents,zm.ChatEvents,t,n,r,a)},this.getTelemetryErrorEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:im.UserQueryOrder,value:bS}]))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),new Km(Vm.Error,zm.Error,t,r,o,i,n)},this.getTelemetryQueryDetailsEvent=function(t,n,r,o){return(t=t.concat(e.getDataFields([{key:Im.UserQueryOrder,value:bS}]))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),new Km(Vm.QueryDetails,zm.QueryDetails,t,n,r,o)},this.getTelemetryChatEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:im.UserQueryOrder,value:bS}]))).find((function(e){return e.name===Mm}))||(t=t.concat(e.getDataFields([{key:Mm,value:e.userQueryGuid.length>0?e.userQueryGuid:mS}]))),new Km(Vm.ChatEvents,zm.ChatEvents,t,r,o,i,n)},this.chatHistoryInfoLog=[]}return e.setTelemetryHandler=function(e){this.telemetryHandler=e},e.getTelemetryHandler=function(){return this.telemetryHandler},e.prototype.addChatHistoryInfoLog=function(e){this.chatHistoryInfoLog.push(e)},e.prototype.resetChatHistoryInfoLog=function(){this.chatHistoryInfoLog=[]},e.prototype.setUserQueryGuid=function(e){this.userQueryGuid=e},e.prototype.getUserQueryGuid=function(){return this.userQueryGuid},e.getInstance=function(){return e.telemetryHandler||this.setTelemetryHandler(new qm),this.sInstance||(this.sInstance=new e),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.sendTelemetryLatencyData=function(t,n,r,o,i){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&(e.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEvent(this.getDataFields(t),n,r,o,i)),this.resetChatHistoryInfoLog())},e.prototype.sendTelemetryErrorData=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryErrorEvent(this.getDataFields(t),!0,n,r,o))},e.prototype.sendTelemetryQueryDetailsObject=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryQueryDetailsEvent(this.getDataFields(t),n,r,o))},e.prototype.sendTelemetryChatEventData=function(t,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryChatEvent(this.getDataFields(t),n,r,o,i))},e.prototype.getCopilotScorecardData=function(e,t,n,r,i,a,s,l){return(e=e.concat(Object(o.__spreadArray)([],Object(o.__read)(Wm.e.getFields({featureActionType:Wm.e.FeatureActionType[t],isUserInitiated:!0,capability:vy(i)?"":Wm.e.Capability[i],verb:vy(s)?"":Wm.e.Verb[s],featureName:vy(r)?"Others":r,subFeatureName:vy(l)?"":l,entryPoint:n,isThumbsUp:vy(a)?null:a})),!1))).find((function(e){return e.name===Mm}))||(e=e.concat(this.getDataFields([{key:Mm,value:this.userQueryGuid.length>0?this.userQueryGuid:mS}]))),new Km(Vm.Chat,zm.Chat,e,r,i,s,!0,!0,Um.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,Gm.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?Qm.b(e.key,e.value,e.tag):"string"==typeof e.value?Qm.d(e.key,e.value,e.tag):"boolean"==typeof e.value?Qm.a(e.key,e.value,e.tag):Qm.d(e.key,e.value,e.tag)}),[])},e.prototype.logSeenEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),Wm.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logTriedEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),Wm.e.FeatureActionType.IsTried,n,r,o,i,a,s))},e.prototype.logKeptEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),Wm.e.FeatureActionType.IsKept,n,r,o,i,a,s))},e.prototype.logEnabledEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),Wm.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logEventWithAshaPillar=function(t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHAPillarTelemetryEvent(this.getDataFields(t),n,r,o,i))},e.prototype.logErrorWithAshaVetoAndError=function(t,n,r,o,i,a,s){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHATelemetryErrorEvent(this.getDataFields(t),n,r,o,i,a,s))},e}(),Zm=function(e){return"ChatCompose"===e?Cm.Draft:Cm.ChatQnA},Jm=function(e){switch(e){case Cm.Draft:return mm.ContentGeneration;case Cm.ChatQnA:return mm.QAandSummaries;default:return}},Xm=function(e){switch(e){case Cm.Draft:return vm.Create;case Cm.ChatQnA:return vm.Ask;default:return}},$m=function(e){switch(e){case Cm.Draft:return bm.ContentCreation;case Cm.ChatQnA:return bm.BasicChat;default:return}};function ev(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function tv(e){return null==e}var nv=function(){return"undefined"!=typeof OfficeaicopilotStrings},rv=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(r){Fm.getInstance().sendLoggingEventToClient(Dm.CopyButtonClicked,{chatEventParams:"Basic_Chat"}),t={correlationId:"",featureName:""};try{t=JSON.parse(n)}catch(e){gy("Error parsing telemetry data on copy click",e.message)}var i;return Ym.getInstance().logKeptEvent([{key:Mm,value:t.correlationId||""}],Bm,t.featureName,Jm(t.featureName),void 0,Xm(t.featureName)),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopyButtonClicked},{key:im.ChatEventParameters,value:t.featureName||""},{key:im.UserQueryGuid,value:t.correlationId||""}]),i=e,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e=V(i),t=document.getElementById(i).innerText,n=new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([t],{type:"text/plain"})}),e?[4,navigator.clipboard.write([n])]:[3,2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:return r=o.sent(),console.log("Error copying html to clipboard",r.message),[3,4];case 4:return[2]}}))})),[2]}))}))},ov=function(e){return void 0===e&&(e="en"),e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e};var iv,av=6e4,sv=5e3,lv="Sorry, something went wrong. I'm working on it.",cv=200,uv=2e3,dv="",pv=" ",gv="...",hv="https://augloop-dogfood.officeppe.com",fv="Choose a starter prompt from the suggestions menu to get started",mv="Augloop Response Timed Out",vv="Chat History Response Timed Out",bv=1e4,yv=function(){return nv()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},Cv=function(){return nv()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"},Ov=function(){return nv()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},Sv=function(){return nv()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts"},Ev=function(){return nv()?OfficeaicopilotStrings.ErrorOffensiveInputContent:"Sorry, I can't work with that. Try making a new request."},xv=function(){return nv()?OfficeaicopilotStrings.ErrorOffensiveOutputContent:"Sorry, I can't generate content for this. Try making a new request."},Iv=function(){return nv()?OfficeaicopilotStrings.ErrorInputBlockedByDynamicGuardList:"It looks like there's some content here I can't work with. Try asking me to do something else."},wv=function(){return nv()?OfficeaicopilotStrings.ErrorInvalidSignal:"Something went wrong. Please try again in a moment."},Tv=function(){return nv()?OfficeaicopilotStrings.ErrorTimeout:"I can't process your request right now. Try again in a little while. "},kv=function(){return nv()?OfficeaicopilotStrings.ErrorThrottled:"The maximum number of requests per hour has been reached. Try again in a little while."},jv=function(){return nv()?OfficeaicopilotStrings.ErrorUserThrottled:"You're only allowed a certain number of requests per second. Try again in a little while."},Pv=function(){return nv()?OfficeaicopilotStrings.ErrorInputTooLong:"This is too much information for me to process. Try again with a request that's less than 15,000 words."},Av=function(){return nv()?OfficeaicopilotStrings.ErrorInvalidLanguage:"Your request includes a language I don't currently support."},_v=function(){return nv()?OfficeaicopilotStrings.LearnMoreString:"Learn More"};!function(e){e.Opera="Opera",e.Safari="Safari",e.PhantomJS="PhantomJS",e.Edge="Edge",e.Electron="Electron",e.Chrome="Chrome",e.MSIE="MSIE",e.Firefox="Firefox",e.SkypeShell="SkypeShell",e.Unknown="Unknown"}(iv||(iv={}));var Dv,Lv=16;!function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(Dv||(Dv={}));var Mv,Bv,Rv,Fv,Nv,Hv,Uv,Vv,zv,Gv,Wv,Qv,qv=function(){return nv()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},Kv=function(){return nv()?OfficeaicopilotStrings.CIQDefaultPlaceholder:"Start typing to search"},Yv="ChatWrapperId",Zv="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",Jv="acquired",Xv=function(){function e(t){var n,r,o,i,a,s,l,c,u;e.appName=t.appName,e.augloopUrl=null!==(n=t.augloopUrl)&&void 0!==n?n:hv,e.devBuild=null!==(r=t.devBuild)&&void 0!==r&&r,e.environment=t.environment,e.sessionId=t.sessionId,e.workflow=null!==(o=t.workflow)&&void 0!==o?o:Tm.ACTION_AI,e.appVersion=null!==(i=t.appVersion)&&void 0!==i?i:"",e.appInternalName=null!==(a=t.appInternalName)&&void 0!==a?a:"",e.appPlatform=null!==(s=t.appPlatform)&&void 0!==s?s:"",e.augloopFlights=null!==(l=t.augloopFlights)&&void 0!==l?l:"",e.language=null!==(c=t.language)&&void 0!==c?c:"en-US",e.substrateScenarioName=null!==(u=t.substrateScenarioName)&&void 0!==u?u:"",e.feedbackSettings=t.feedbackSettings}return e.getAppName=function(){return e.appName},e.getAugloopUrl=function(){return e.augloopUrl},e.isDevbuild=function(){return e.devBuild},e.getEnvironment=function(){return e.environment},e.getSessionId=function(){return e.sessionId},e.getWorkflowType=function(){return e.workflow},e.getAppVersion=function(){return e.appVersion},e.getAppInternalName=function(){return e.appInternalName},e.getAppPlatform=function(){return e.appPlatform},e.getAugloopFlights=function(){return e.augloopFlights},e.getLanguage=function(){return e.language},e.getSubstrateScenarioName=function(){return e.substrateScenarioName},e.getFeedbackSettings=function(){return e.feedbackSettings},e}(),$v=n(832);!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS"}(Mv||(Mv={})),function(e){e.Chat="chat",e.Human="human"}(Bv||(Bv={})),function(e){e.BASIC_CHAT="BasicChat",e.DRAFT="Draft"}(Rv||(Rv={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(Fv||(Fv={})),function(e){e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsApplyClpFromHydratedMessagedEnabled="IsApplyClpFromHydratedMessagedEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled",e.HydratedMessagesSquashingEnabled="HydratedMessagesSquashingEnabled",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.IsChatHistoryPaginationEnabled="IsChatHistoryPaginationEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.DisableChatHistoryPaginationFix="DisableChatHistoryPaginationFix",e.ChatHistoryDuplicateLoggingFix="ChatHistoryDuplicateLoggingFix",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.ShowRestrictiveSearchBanner="ShowRestrictiveSearchBanner",e.EnableRestrictiveSearchBanner="EnableRestrictiveSearchBanner",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.IsLicenseAnnotationEnabled="IsLicenseAnnotationEnabled",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsDisableChatInputWhenAlSessionCloseEnabled="IsDisableChatInputWhenAlSessionCloseEnabled"}(Nv||(Nv={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.UnknownOpenAI="unknown-openai",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(Hv||(Hv={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(Uv||(Uv={})),function(e){e.HandleSubmitError="handle-submit-error",e.AugloopInitializationError="augloop-initialization-error",e.ActivateAnnotationError="activate-annotation-error",e.AugloopResponseTimeout="augloop-response-timeout",e.ChatHistoryResponseTimeout="chat-history-response-timeout",e.AugloopPluginProviderFailure="augloop-plugin-provider-failure"}(Vv||(Vv={})),function(e){e.Shy="Shy",e.Expanded="Expanded"}(zv||(zv={})),function(e){e.Favourite="Favourite",e.Unfavourite="Unfavourite"}(Gv||(Gv={})),function(e){e.PromptGuide="PromptGuide",e.Microphone="Microphone",e.SubmitButton="SubmitButton",e.GroundingButton="GroundingButton"}(Wv||(Wv={})),function(e){e.ENTERPRISE_SEARCH="EnterpriseSearch",e.WEB_SEARCH="BingWebSearch"}(Qv||(Qv={}));var eb=function(){function e(e){this.workflowDataMap=new Map,this.copilotCommunicationHandler=e,this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())}return e.getInstance=function(t){if(!e.instance){if(!t)throw new Error("WorkflowDataMap has not been initialized");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.populateWorkflowDataMap=function(e){var t,n;try{for(var r=Object(o.__values)(e),i=r.next();!i.done;i=r.next()){var a=i.value,s={workflowInfo:a};this.workflowDataMap.set(a.workflowAnnotationType,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsQnASuggestionPillCachingEnabled)&&!this.workflowDataMap.has(gm.c.getTypeName())&&this.workflowDataMap.set(gm.c.getTypeName(),{workflowInfo:{workflowAnnotationType:gm.c.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsSharedCopilotLabEnabled)&&(this.workflowDataMap.has($v.a.getTypeName())?this.workflowDataMap.get($v.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set($v.a.getTypeName(),{workflowInfo:{workflowAnnotationType:$v.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}})),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsClpSensitivityInChatInputEnabled)&&!this.workflowDataMap.has(hm.a.getTypeName())&&this.workflowDataMap.set(hm.a.getTypeName(),{workflowInfo:{workflowAnnotationType:hm.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:15e3}}),(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)||this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsPersistanceInPhase2UxEnabled))&&(this.workflowDataMap.has(pm.a.getTypeName())?this.workflowDataMap.get(pm.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(pm.a.getTypeName(),{workflowInfo:{workflowAnnotationType:pm.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}))},e.prototype.getWorkflowDataMap=function(e){return void 0===e&&(e=!1),e&&(this.workflowDataMap.clear(),this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())),this.workflowDataMap},e.prototype.isWorkflowRegistered=function(e){return this.workflowDataMap.has(e)},e.prototype.getWorkflowAugloopTimeoutValue=function(e){return this.isWorkflowRegistered(e)?this.workflowDataMap.get(e).workflowInfo.augloopResponseTimeout:av},e.prototype.isAugloopResponseTimeoutRequired=function(e){return!!this.isWorkflowRegistered(e)&&this.workflowDataMap.get(e).workflowInfo.augloopResponseTimerRequired},e}(),tb=eb,nb=n(723);function rb(){var e=ib();return Object(nb.a)(e,"OPR/")||Object(nb.a)(e,"Opera")?"Opera":Object(nb.a)(e,"PhantomJS")?"PhantomJS":Object(nb.a)(e,"Edg")?"Edge":Object(nb.a)(e,"Electron")?"Electron":Object(nb.a)(e,"Chrome")?"Chrome":Object(nb.a)(e,"Trident")?"MSIE":Object(nb.a)(e,"Firefox")?"Firefox":Object(nb.a)(e,"Safari")?"Safari":Object(nb.a)(e,"SkypeShell")?"SkypeShell":"Unknown"}var ob,ib=function(){var e;return null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent};try{ob=n(1104)}catch(Ke){}var ab,sb=function(){function e(){this.debugLogs=""}return e.initialize=function(){e.debugLogManager||(e.debugLogManager=new e)},e.getInstance=function(){return e.debugLogManager},e.prototype.addLog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ob?ob.format.apply(ob,Object(o.__spreadArray)([],Object(o.__read)(e),!1))+"\n":e.join(" ")+"\n";this.debugLogs+=n},e.prototype.getLogs=function(){return this.debugLogs},e.prototype.resetLogs=function(){this.debugLogs=""},e}(),lb=n(1848),cb=n(681),ub=n(1489),db=n(2060),pb=function(){function e(){this.messageRequestIdMap={}}return e.prototype.updateMessageIdMap=function(){this.currentUserMessageId&&this.requestId&&!this.messageRequestIdMap[this.requestId]&&(this.messageRequestIdMap[this.requestId]=this.currentUserMessageId)},Object.defineProperty(e.prototype,"ConversationId",{get:function(){return this.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RequestId",{get:function(){return this.requestId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SydneyEndpoint",{get:function(){return this.sydneyEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ChatTimestamp",{get:function(){return this.chatTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return this.locale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ErrorMessage",{get:function(){return this.errorMessage},set:function(e){this.errorMessage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentUserMessageId",{get:function(){return this.currentUserMessageId},set:function(e){this.currentUserMessageId=e},enumerable:!1,configurable:!0}),e.prototype.GetMessageIdForRequestId=function(e){return this.messageRequestIdMap[e]},Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.resetInstance=function(){var e;null===(e=this._instance)||void 0===e||e.NewChatInitiated(),this._instance=void 0},e.prototype.Observe=function(e){var t,n,r,o,i,a;if(e)try{if(e.conversationId&&e.conversationId!==this.conversationId&&(this.conversationId=e.conversationId,gy("ChatStateObserver ConversationId: "+e.conversationId)),e.sydneyEndpoint&&!this.sydneyEndpoint&&(this.sydneyEndpoint=null!==(t=e.sydneyEndpoint)&&void 0!==t?t:this.sydneyEndpoint),this.requestId=null!==(n=e.queryId)&&void 0!==n?n:this.requestId,this.requestId&&this.updateMessageIdMap(),this.chatTimestamp=null!==(r=e.timestamp)&&void 0!==r?r:(new Date).toISOString(),!this.locale&&(null===(o=e.chatResponse)||void 0===o?void 0:o.messages)){var s=null===(a=null===(i=e.chatResponse)||void 0===i?void 0:i.messages)||void 0===a?void 0:a.find((function(e){return e.locale}));(null==s?void 0:s.locale)&&(this.locale=null==s?void 0:s.locale)}}catch(e){gy("Exception ocurred in ChatStateObserver "+e)}},e.prototype.NewChatInitiated=function(){this.currentUserMessageId=void 0,this.requestId=void 0,this.chatTimestamp=void 0,this.errorMessage=void 0},e}(),gb=(n(1141),function(e){e});!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(ab||(ab={}));var hb=lp.CurrentContext.toString(),fb=!1,mb=function(){return hb},vb=function(e,t){yb("".concat(bb(e.id),":").concat(t))},bb=function(e){switch(e){case Qv.ENTERPRISE_SEARCH:return lp.Work;case Qv.WEB_SEARCH:return lp.Web;default:return e}},yb=function(e){Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.GroundingSourceUpdated},{key:im.ChatEventParameters,value:e}])},Cb=function(){function e(e,t,n){var r=this;this.handleThumbsDownClick=function(e,t,n){gb(e),r.copilotCommunicationHandler.feedbackButtonClicked(Pm.DISLIKE,e,t,n)},this.handleThumbsUpClick=function(e,t,n){gb(e),r.copilotCommunicationHandler.feedbackButtonClicked(Pm.LIKE,e,t,n)},this.addChatMessages=function(e){e.length>0&&r.setChatLog((function(t){return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(e),!1)}))},this.getLastMessage=function(e){void 0===e&&(e=!0);var t=r.getChatLog();if(0!==t.length)return t[my(t,e)];gy("No chat messages available")},this.clearMessages=function(){r.setChatLog((function(){return[]}))},this.getFeedbackData=function(){var e=r.copilotCommunicationHandler.getFeedbackData();return e&&(null==e?void 0:e.contextData)||(e={feedbackArea:e.feedbackArea,contextData:{cardMetaData:JSON.stringify({prompt:vS,promptId:mS}),sydneyContextData:{conversationId:pb.Instance.ConversationId,sydneyEndpoint:pb.Instance.SydneyEndpoint,requestId:pb.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:pb.Instance.CurrentUserMessageId},feedbackContextData:{prompt:vS,promptId:mS},groundingSource:mb(),entryPoint:"Chat"}}),e},this.copilotCommunicationHandler=t,this.setChatLog=e,this.chatInputRef=n}var t;return e.convertResponseMessageToChatMessage=function(e,n,r,i,a){var s,l,c;void 0===i&&(i=null),void 0===a&&(a=function(){return!1});try{c=JSON.parse(r.telemetryData)}catch(e){gy("Error parsing telemetry data in chat message builder",e.message)}var u={messageType:e,body:t.getChatMessageBody(e,n),feedbackData:r.feedbackData,shouldShowAIGeneratedIndicator:r.shouldShowAIGeneratedIndicator,feedbackSectionPosition:r.feedbackSectionPosition,showMinifiedUI:r.showMinifiedUI,showAnimation:r.showAnimation,actionBarButtons:r.actionButtonList,strikeThroughText:r.strikeThroughText,references:r.references,pillsList:r.pillsList,handlePillOnClick:function(e){var t,n,o;if(!a()&&i){null===(t=i.current)||void 0===t||t.setGhostText("");var s=e.data;null===(n=i.current)||void 0===n||n.setInputText(s),null===(o=i.current)||void 0===o||o.setFocus(),e.isCiq&&setTimeout((function(){var e;return null===(e=i.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1)}r.handlePillOnClick(e)},handleShowMeOnClick:r.handleShowMeOnClick,warningActionButtons:null!==(s=r.warningActionButtons)&&void 0!==s?s:void 0,clpSensitivityIndicatorData:null!==(l=r.clpSensitivityIndicatorData)&&void 0!==l?l:void 0,telemetryData:JSON.stringify(void 0===c?{correlationId:mS}:Object(o.__assign)(Object(o.__assign)({},c),{correlationId:c.correlationId||mS})),messageId:r.messageId,msgExtCardProps:r.msgExtCardProps,pluginAuthError:r.pluginAuthError};return u},e.prototype.setChatMessageData=function(e,t,n,r,i){var a=this;void 0===n&&(n={shouldShowAIGeneratedIndicator:!1,showAnimation:!1,feedbackData:this.getFeedbackData(),isFailure:!1,showMinifiedUI:!1,feedbackSectionPosition:oo.None,aiResponseMetadata:void 0,actionButtonList:void 0,strikeThroughText:!1,references:void 0,pillsList:void 0,handlePillOnClick:void 0,handleShowMeOnClick:void 0,warningActionButtons:void 0,clpSensitivityIndicatorData:void 0,telemetryData:void 0,messageId:void 0,msgExtCardProps:void 0,pluginAuthError:void 0}),void 0===r&&(r=!0),void 0===i&&(i=function(){return!1}),this.setChatLog((function(s){var l=Object(o.__spreadArray)([],Object(o.__read)(s),!1);return a.addChatMessage(l,e,t,n,r,i)}))},e.prototype.getProps=function(e,t){var n;return{chatLog:e,shouldShowFeedbackButtons:null===(n=null==t?void 0:t.showFeedbackButtons)||void 0===n||n,handleChatCardThumbsUpClick:this.handleThumbsUpClick,handleChatCardThumbsDownClick:this.handleThumbsDownClick}},e.prototype.updateLastMessage=function(e,t,n,r){var i=this;void 0===r&&(r=!0),this.setChatLog((function(a){var s=Object(o.__spreadArray)([],Object(o.__read)(a),!1),l=my(s);return-1===l?(gy("Error: No chat message found to update."),s):i.updateChatMessage(s,e,t,n,r,l)}))},e.prototype.updateMessage=function(e,t,n,r){var i=this;void 0===r&&(r=!0),this.setChatLog((function(a){var s=Object(o.__spreadArray)([],Object(o.__read)(a),!1),l=s.findIndex((function(e){return e.messageId===n.messageId}));return-1===l?(gy("chat message is not found with message id : ".concat(n.messageId)),s):i.updateChatMessage(s,e,t,n,r,l)}))},e.prototype.addChatMessage=function(e,n,r,i,a,s){var l;void 0===a&&(a=!0),void 0===s&&(s=function(){return!1});var u=t.convertResponseMessageToChatMessage(n,r,i,this.chatInputRef,s),d=Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(e),!1),[u],!1);return a&&by()&&n!==c.FeedbackNudge&&wb(u,kb(r,n),(null===(l=u.body)||void 0===l?void 0:l.user)===Bv.Human,i.isFailure,i.aiResponseMetadata),d},e.prototype.updateChatMessage=function(e,n,r,i,a,s){var l;void 0===a&&(a=!0);var c=Object(o.__spreadArray)([],Object(o.__read)(e),!1),u=c.at(s);return u&&(r&&void 0!==(null==u?void 0:u.body)&&(u.body=t.getChatMessageBody(n,r)),i&&Object.entries(i).forEach((function(e){var t=Object(o.__read)(e,2),n=t[0],r=t[1];"actionButtonList"===n?u.actionBarButtons=r:void 0!==r&&(u[n]=r)})),a&&by()&&(r||(r=this.getChatMessageData(u.body,n)),wb(u,kb(r,n),(null===(l=u.body)||void 0===l?void 0:l.user)===Bv.Human,null==i?void 0:i.isFailure,null==i?void 0:i.aiResponseMetadata))),c},e.prototype.deleteMessage=function(e,t){this.setChatLog((function(n){for(var r=Object(o.__spreadArray)([],Object(o.__read)(n),!1),i=r.length-1;i>=0;i--){var a=r[i];if(a.messageId===t&&a.messageType===e){r.splice(i,1);break}}return r}))},e.prototype.getChatMessageData=function(e,t){var n={};switch(t){case c.ContentCard:n.contentCardProps=e;break;case c.AccordionCard:n.accordionCardProps=e;break;case c.ChatCardWrapper:n.chatCardWrapperProps=e;break;case c.SelfHelpAdaptiveCard:n.selfHelpAdaptiveCardProps=e;break;case c.StreamingAdaptiveCard:n.streamingAdaptiveCardProps=e;break;case c.MarkdownCard:n.markDownCardProps=e;break;case c.Designer:n.designerCardProps=e;break;case c.WarningMessage:n.warningMessageCardProps=e;break;case c.ProactiveSuggestionCard:n.proactiveSuggestionCardProps=e;break;default:n.defaultMessageProps=e}return n},e.prototype.getChatLog=function(){var e=[];return this.setChatLog((function(t){return e=t})),e},t=e,e.getFeedBackNudgeMessageBody=function(e){return{imageSrc:e}},e.getChatMessageBody=function(e,r){var i;switch(e){case c.ContentCard:i=Object(o.__assign)({},r.contentCardProps);break;case c.AccordionCard:i=Object(o.__assign)({},r.accordionCardProps);break;case c.ChatCardWrapper:i=Object(o.__assign)({},r.chatCardWrapperProps);break;case c.FeedbackNudge:i=t.getFeedBackNudgeMessageBody(n(2678));break;case c.SelfHelpAdaptiveCard:i=Object(o.__assign)({},r.selfHelpAdaptiveCardProps);break;case c.StreamingAdaptiveCard:i=Object(o.__assign)({},r.streamingAdaptiveCardProps);break;case c.MarkdownCard:i=Object(o.__assign)({},r.markDownCardProps);break;case c.Designer:i=Object(o.__assign)({},r.designerCardProps);break;case c.CopilotWorkflowMessage:i=Object(o.__assign)({},r.copilotWorkflowsCardProps);break;case c.WarningMessage:i=Object(o.__assign)({},r.warningMessageCardProps);break;case c.PaginatedCard:i=Object(o.__assign)({},r.paginatedCardProps);break;case c.ProactiveSuggestionCard:i=Object(o.__assign)({},r.proactiveSuggestionCardProps);break;case c.ReviewerSummaryCard:i=Object(o.__assign)({},r.reviewerSummaryCardProps);break;case c.ReviewAgentCard:i=Object(o.__assign)({},r.reviewAgentCardProps);break;default:i=Object(o.__assign)({},r.defaultMessageProps)}return i},e}(),Ob=void 0,Sb=void 0;function Eb(e,t,n){if(e.isFeatureGateEnabledFromClient(Nv.SkipHydrateEnabled))gy("hydrateMessages: Skipping hydrating chat pane with history messages");else{gy("hydrateMessages: Hydrating ".concat(t.length," messages"));var r=xb(t);n((function(t){var n=Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(r),!1);if(!e.isFeatureGateEnabledFromClient(Nv.HydratedMessagesSquashingEnabled))return n;var i=function(e,t){void 0===t&&(t=function(e){return e.messageId});var n=new Map,r=new Map,i=e.map((function(e){return[e,t(e)]}));i.forEach((function(e,t){var i=Object(o.__read)(e,2),a=i[0],s=i[1];void 0!==s&&(r.set(s,a),n.has(s)||n.set(s,t))}));var a=[];return i.forEach((function(e,t){var i=Object(o.__read)(e,2),s=i[0],l=i[1];void 0===l?a.push(s):t===n.get(l)&&a.push(r.get(l))})),a}(n);if(gy("hydrateMessages: Squashing reduced ".concat(n.length," messages to ").concat(i.length)),e.isFeatureGateEnabledFromClient(Nv.IsApplyClpFromHydratedMessagedEnabled)&&i&&i.length>0){var a=Object(o.__spreadArray)([],Object(o.__read)(new Set(i.map((function(e){var t;return null===(t=e.clpSensitivityIndicatorData)||void 0===t?void 0:t.labelId})).filter(Boolean))),!1),s={messagesClpLabels:a,workflowAnnotationType:"UpdateChatClpFromChatHistory"};e.sendEventToClient(_m.UpdateChatClpFromChatHistory,s)}return i}))}}function xb(e){var t,n,r=[];try{for(var i=Object(o.__values)(e.slice().reverse()),a=i.next();!a.done;a=i.next()){var s=Ib(a.value);s&&r.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Ib(e){return e.richTextJson?function(e){var t;gy("parsing rich text and display message");try{t=JSON.parse(e)}catch(e){return void gy("error parsing rich text from chat history",e.message)}if(t.messageType===c.ChatCardWrapper&&!t.body.renderData)return void gy("No render data found for ChatCardWrapper");t.showAnimation=!1,t.clpSensitivityIndicatorData&&(t=Object(o.__assign)(Object(o.__assign)({},t),{clpSensitivityIndicatorData:Object(o.__assign)(Object(o.__assign)({},t.clpSensitivityIndicatorData),{icon:void 0})}));if(!tv(t)&&t.body)return t;return}(e.richTextJson):e.content?function(e){var t,n=e.format,r=e.userRole,o=e.content;if(n===um.b.PlainText){var i=r===um.f.User;t={messageType:c.Default,body:{user:i?"human":"chat",messageHeader:{text:o}},shouldShowAIGeneratedIndicator:!i,showAnimation:!i,feedbackSectionPosition:i?oo.None:oo.Footer}}else t={messageType:c.MarkdownCard,body:{user:"chat",message:o},shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:oo.Footer};if(!tv(t)&&t.body)return t;return}(e):void 0}function wb(e,t,n,r,o){var i=Tb(e,t,n,r,o);e.messageType===c.ChatCardWrapper&&(Ob=i,Sb=e.messageId),Vb(um.c.AddMessageOperation,i)}function Tb(e,t,n,r,i){var a;if((a=e.actionBarButtons?Object(o.__assign)(Object(o.__assign)({},e),{actionBarButtons:void 0}):e.warningActionButtons?Object(o.__assign)(Object(o.__assign)({},e),{warningActionButtons:void 0}):e.messageType===c.Designer?Object(o.__assign)(Object(o.__assign)({},e),{actionBarButtons:void 0,feedbackSectionPosition:oo.None,body:Object(o.__assign)(Object(o.__assign)({},e.body),{isRehydration:!0})}):e).messageType===c.ChatCardWrapper){var s=a.body;s.renderData&&s.element&&(a=Object(o.__assign)(Object(o.__assign)({},a),{body:Object(o.__assign)(Object(o.__assign)({},s),{element:void 0})}))}var l="";try{l=JSON.stringify(a)}catch(e){gy("error while stringify chat card props error:",e.message)}var u=n?um.f.User:r?um.f.System:um.f.Copilot;return function(e,t,n,r,o,i,a,s,l){var c={content:e,entry:t,userRole:n,format:r,timestamp:Date.now(),messageId:Object(fm.a)(),status:o,richTextJson:i,messageMetadata:a,userId:s,rephrasedMessage:l};n==um.f.User&&(pb.Instance.CurrentUserMessageId=c.messageId);return c}(t,um.a.Pane,u,um.b.RichText,r?um.e.Failure:um.e.Success,l,i)}function kb(e,t){var n,r,i,a,s,l,u,d,p="";switch(t){case c.Default:p=function(e){var t,n,r,i,a="";(null==e?void 0:e.messageHeader)&&(a=a+jb(e.messageHeader)+"\n");if(null==e?void 0:e.embeddedLists)try{for(var s=Object(o.__values)(e.embeddedLists),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.listHeader&&(a=a+c.listHeader+"\n"),c.listItems)try{for(var u=(r=void 0,Object(o.__values)(c.listItems)),d=u.next();!d.done;d=u.next()){var p=d.value;a+=p.title?"".concat(p.title,": ").concat(p.text+"\n"):"".concat(p.text+"\n")}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}c.listFooter&&(a=a+jb(c.listFooter)+"\n")}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}(null==e?void 0:e.messageFooter)&&(a+=jb(e.messageFooter));return a}(e.defaultMessageProps);break;case c.MarkdownCard:p=null!==(r=null===(n=e.markDownCardProps)||void 0===n?void 0:n.message)&&void 0!==r?r:"";break;case c.WarningMessage:p=(null===(i=e.warningMessageCardProps)||void 0===i?void 0:i.warningPrefix)+(null!==(s=null===(a=e.warningMessageCardProps)||void 0===a?void 0:a.warningEmphasizedText)&&void 0!==s?s:"")+(null!==(u=null===(l=e.warningMessageCardProps)||void 0===l?void 0:l.warningSuffix)&&void 0!==u?u:"");break;case c.ChatCardWrapper:p=null!==(d=e.chatCardWrapperProps.textContent)&&void 0!==d?d:"";break;case c.StreamingAdaptiveCard:p=function(e){if(!e)return"";var t=e.basin,n=e.uniqueId,r=e.accessPath;if((null==t?void 0:t.items)&&n&&r){var o=Ol()(e.basin.items[e.uniqueId],e.accessPath);return(null==o?void 0:o.body)?o.body.map((function(e){return e.text})).join("\n"):""}}(e.streamingAdaptiveCardProps);case c.ContentCard:case c.AccordionCard:case c.ProactiveSuggestionCard:case c.SelfHelpAdaptiveCard:}return p}function jb(e){var t,n="";return(null==e?void 0:e.text)&&(n+=e.text),(null==e?void 0:e.linkText)&&(n=null!==(t=n+e.linkText.text+e.linkText.linkSuffix)&&void 0!==t?t:""),n}var Pb,Ab,_b,Db,Lb=function(){function e(e,t){var n=this;this.chatHistoryResponseTimerID=null,this.workflowAnnotationType=dm.c.getTypeName(),this.chatHistoryResponseTimeout=sv,this.hasExistingChat=!0,this.telemetryLoggerUtils=Ym.getInstance(),this.chatHistoryResponseTimeoutInternal=function(){n.chatHistoryResponseTimerID=null,gy("Chat History Augloop Response Timed Out for workflow",n.workflowAnnotationType),Ay.getInstance().clearOperationListForResubmit(),n.setIsChatHistoryLoading(!1),n.hasExistingChat&&n.setIsChatHistoryTimedOut(!0),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatHistoryTimeout},{key:im.ChatEventParameters,value:(new Date).getTime().toString()},{key:im.ChatErrorType,value:ym.Server}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:am.ErrorMessage,value:vv},{key:am.ErrorType,value:ym.Server},{key:am.ErrorCode,value:Vv.ChatHistoryResponseTimeout},{key:am.ErrorCategory,value:rm.ChatEvents}]),n.hasExistingChat=!0},this.setIsChatHistoryLoading=e,this.setIsChatHistoryTimedOut=t,this.workflowAnnotationType=this.getChatHistoryWorkflowType(),this.chatHistoryResponseTimeout=this.getChatHistoryResponseTimeout()}return e.getInstance=function(t,n){if(!e.sInstance){if(tv(t))throw new Error("setIsChatSessionIdSet is null or undefined");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(){gy("Setting chat history augloop response Timer"),this.clearAugloopResponseTimer(!1),this.setIsChatHistoryLoading(!0),this.setIsChatHistoryTimedOut(!1),this.chatHistoryResponseTimerID=window.setTimeout(this.chatHistoryResponseTimeoutInternal,this.chatHistoryResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(e){void 0===e&&(e=!0),null!==this.chatHistoryResponseTimerID&&(gy("Clear chat history augloop response Timer"),clearTimeout(this.chatHistoryResponseTimerID),this.chatHistoryResponseTimerID=null,e&&this.setIsChatHistoryLoading(!1))},Object.defineProperty(e.prototype,"isAugloopResponseTimerSet",{get:function(){return null!==this.chatHistoryResponseTimerID},enumerable:!1,configurable:!0}),e.prototype.setHasExistingChat=function(e){this.hasExistingChat=e},e.prototype.getChatHistoryWorkflowType=function(){return tb.getInstance().isWorkflowRegistered(dm.c.getTypeName())?dm.c.getTypeName():tb.getInstance().isWorkflowRegistered(dm.a.getTypeName())?dm.a.getTypeName():dm.b.getTypeName()},e.prototype.getChatHistoryResponseTimeout=function(){var e;return null!==(e=tb.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType))&&void 0!==e?e:sv},e}(),Mb=[],Bb=null,Rb=null,Fb=null,Nb=null,Hb=!0,Ub=!1,Vb=function(e,t,n,r,i){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var a,s,l,c,u,d,p,g;return Object(o.__generator)(this,(function(o){switch(a={},s=new cb.a,l=Date.now(),c=Ym.getInstance(),u=function(){if(fb){var e=hb===lp.Work?um.d.Enterprise:um.d.Document;return gy("Orchestrator grounding mode used for Chat:",e),e}}(),e){case um.c.AddChatOperation:"dummyUserId","dummyDocId",d={userId:"dummyUserId",documentId:"dummyDocId",sessionId:Object(fm.a)(),messages:[]},a={newChat:d,type:um.c.AddChatOperation},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub});break;case um.c.GetAllChatsOperation:p={pageSize:40,syncState:i?void 0:Nb},a={type:um.c.GetAllChatsOperation,paging:p},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub});break;case um.c.GetCurrentChatOperation:p={pageSize:10},a={type:um.c.GetCurrentChatOperation,paging:r&&r.isFeatureGateEnabledFromClient(Nv.IsChatHistoryPaginationEnabled)?p:void 0},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub});break;case um.c.GetMessagesOperation:p={pageSize:10,syncState:i?void 0:Fb},Bb=null!=i?i:Bb,a={type:um.c.GetMessagesOperation,chatSessionId:Bb,paging:p,setSessionAsCurrent:!!i},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub});break;case um.c.AddMessageOperation:Mb.push(t.messageId),a={newMessage:t,type:um.c.AddMessageOperation,chatSessionId:Bb},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub});break;case um.c.DeleteChatOperation:a={type:um.c.DeleteChatOperation,chatSessionId:i},s=new cb.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:_b,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Ub})}return g=new ub.b({parentPath:["Signal",cb.a.getTypeName()],items:[{id:db.a.generateId(),body:s}]}),Fm.getInstance().sendLoggingEventToClient(Dm.ChatHistorySignalSent,{timestamp:(new Date).getTime(),signalName:cb.a.getTypeName(),operationType:e}),c.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatHistorySignalSent},{key:im.ChatEventParameters,value:"".concat(cb.a.getTypeName(),"_").concat(e)}]),gy("Submitting signal to Augloop : ".concat(cb.a.getTypeName()," with operation type: ").concat(e," and signal: ").concat(JSON.stringify(s))),(null==t?void 0:t.content)&&gy("sending message: ".concat(t.content)),Ay.getInstance().submitOperation(g,cb.a.getTypeName()),Pb=(new Date).getTime(),e===um.c.GetCurrentChatOperation&&Lb.getInstance().setAugloopResponseTimer(),[2]}))}))},zb=function(e,t,n,r,i,a,s,l,c){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M;return Object(o.__generator)(this,(function(B){switch(B.label){case 0:switch(u=null===(I=null===(x=e.body)||void 0===x?void 0:x.H_)||void 0===I?void 0:I.T_,gy("".concat(cb.a.getTypeName()," response. Time Taken : ").concat(OS(Pb)," sec \n")),d=null==e?void 0:e.body,p=null==d?void 0:d.operationResponse,g=Ym.getInstance(),Fm.getInstance().sendLoggingEventToClient(Dm.ChatHistoryResponseReceived,{timeInMs:SS(Pb),annotationName:u,operationType:p.type}),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:"".concat(u,"_").concat(p.type)}]),h={operationType:um.c.GetChatOperation,augloopResponseTime:-1},f=OS(Pb),p.type){case um.c.GetCurrentChatOperation:return[3,1];case um.c.GetMessagesOperation:return[3,6];case um.c.GetAllChatsOperation:return[3,7];case um.c.GetChatOperation:return[3,8];case um.c.GetMessagesInCurrentChatSession:return[3,9];case um.c.AddChatOperation:return[3,10];case um.c.AddMessageOperation:return[3,11];case um.c.DeleteChatOperation:return[3,12]}return[3,13];case 1:return O=p,h={operationType:um.c.GetCurrentChatOperation,augloopResponseTime:f},Fb=null===(w=O.paging)||void 0===w?void 0:w.syncState,O.chat?[3,4]:(Lb.getInstance().setHasExistingChat(!1),c?[3,3]:[4,Vb(um.c.AddChatOperation)]);case 2:B.sent(),B.label=3;case 3:return[3,5];case 4:Bb=null===(T=O.chat)||void 0===T?void 0:T.sessionId,Rb=Bb,gy("chatSessionId from GetCurrentChatOperation: "+Bb),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatHistorySessionLoaded},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),0===n&&O.chat&&Lb.getInstance().isAugloopResponseTimerSet&&Eb(r,O.chat.messages,t),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.GetCurrentChatStatus},{key:im.ChatEventParameters,value:p.status}]),p.status!==um.e.Success&&Lb.getInstance().isAugloopResponseTimerSet&&(r.sendEventToClient(_m.ChatHistoryHydrationFailed),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatHistoryHydrationFailed}])),Lb.getInstance().clearAugloopResponseTimer(),B.label=5;case 5:return null==a||a(null!==(j=null===(k=O.chat)||void 0===k?void 0:k.plugins)&&void 0!==j?j:[]),[3,13];case 6:if(Fb=null===(P=(O=p).paging)||void 0===P?void 0:P.syncState,l&&(O.status===um.e.Success?(Mb=[],Hb=!0,Rb=Bb,0===(null===(A=O.messages)||void 0===A?void 0:A.length)&&(null==l||l((function(){return[]})))):(Bb=Rb,null==l||l())),(null===(_=O.messages)||void 0===_?void 0:_.length)>0){m=[];try{for(v=Object(o.__values)(O.messages),b=v.next();!b.done;b=v.next())y=b.value,r.isFeatureGateEnabledFromClient(Nv.DisableChatHistoryPaginationFix)||Mb.includes(y.messageId)||(m.push(y),Mb.push(y.messageId))}catch(e){S={error:e}}finally{try{b&&!b.done&&(E=v.return)&&E.call(v)}finally{if(S)throw S.error}}(null==m?void 0:m.length)>0&&(Hb=!0,C=function(e){var t=l?[]:e,n=xb(m);return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(n),!1),Object(o.__read)(t),!1)},l?l(C):t(C))}else O.status!==um.e.Failure&&(Hb=!1);return g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.GetMessagesStatus},{key:im.ChatEventParameters,value:O.status}]),[3,13];case 7:return p.status===um.e.Success&&(Nb=null!==(L=null===(D=p.paging)||void 0===D?void 0:D.syncState)&&void 0!==L?L:Nb,null==s||s(p.chats)),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.GetAllChatStatus},{key:im.ChatEventParameters,value:p.status}]),[3,13];case 8:case 9:return[3,13];case 10:return h={operationType:um.c.AddChatOperation,augloopResponseTime:f},p.status===um.e.Success&&(c?Gb():(Bb=null===(M=p.chats)||void 0===M?void 0:M[0].sessionId,Rb=Bb),gy("chatSessionId from AddChatOperation: "+Bb)),Lb.getInstance().clearAugloopResponseTimer(),i&&i(),[3,13];case 11:return h={operationType:um.c.AddMessageOperation,augloopResponseTime:f},c&&p.status===um.e.Success&&(Bb=p.chat.sessionId,Rb=Bb,gy("chatSessionId from AddMessageOperation: "+Bb)),g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.AddMessageStatus},{key:im.ChatEventParameters,value:p.status}]),[3,13];case 12:return O=p,g.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.DeleteMessageStatus},{key:im.ChatEventParameters,value:O.status}]),[3,13];case 13:return-1!==h.augloopResponseTime&&(Ym.getInstance().addChatHistoryInfoLog(h),Ym.getInstance().sendTelemetryLatencyData([])),[2]}}))}))},Gb=function(){Bb="",Rb="",Fb=null,Nb=null,Mb=[],Hb=!0},Wb=n(484),Qb=n(1140),qb=n(1541),Kb=n(1542),Yb=function(e,t,n){var r,o,i=Object(fm.a)(),a=Qb.a.POST;e===Qb.b.Suggestion?(r=Jb(i),o=$b()):(r=Xb(t,n),o=ey(i));var s={request:r,headers:o,httpMethod:a,type:e,queryId:i,scenario:Xv.getSubstrateScenarioName()},l=new ub.a({parentPath:["Signal",qb.a.getTypeName()],items:[{id:db.a.generateId(),body:new qb.a(s)}]});return Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.SubstrateAPIOperationSubmitted},{key:im.ChatEventParameters,value:e},{key:im.UserQueryGuid,value:i}]),Db=(new Date).getTime(),l},Zb=function(e,t){var n,r,o;gy("substrateAPIResponseAnnotationProcessor",e),gy("".concat($v.a.getTypeName()," response received\n Time Taken: ").concat(OS(Db),"s "));var i=e.body,a=i.queryId,s=i.status,l=i.results,c=i.error,u=i.httpStatus,d=i.type,p=Ym.getInstance();if(p.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:$v.a.getTypeName()},{key:im.UserQueryGuid,value:a}]),p.sendTelemetryLatencyData([{key:om.SubstrateAPIResponseTime,value:OS(Db)},{key:om.UserQueryGuid,value:a}]),a&&gy("substrateAPIResponseAnnotationProcessor: queryID: ",a),u&&gy("substrateAPIResponseAnnotationProcessor: httpStatus: ",u),l&&gy("substrateAPIResponseAnnotationProcessor: results: ",l),s===Kb.a.Failed){var g="";return c?(gy("substrateAPIResponseAnnotationProcessor: error: ",c),g=null!==(n=null==c?void 0:c.code)&&void 0!==n?n:""):g=null!==(r=null==u?void 0:u.toString())&&void 0!==r?r:"",void p.sendTelemetryChatEventData([{key:im.ChatEventType,value:"".concat($v.a.getTypeName(),"_Error")},{key:im.ChatEventParameters,value:g},{key:im.ChatErrorType,value:ym.Server},{key:im.UserQueryGuid,value:a}])}if(s===Kb.a.Success&&d===Qb.b.Suggestion&&l)try{var h=JSON.parse(null!=l?l:""),f=null==h?void 0:h.Groups,m=null===(o=null==f?void 0:f[0])||void 0===o?void 0:o.Suggestions;(null==m?void 0:m.length)>0&&t(m)}catch(e){return void gy("substrateAPIResponseAnnotationProcessor: failed to parse results")}},Jb=function(e){var t={EntityRequests:[{EntityType:"Prompt",Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:Xv.getAppName()}}]}]},Size:100}],TimeZone:"UTC",Cvid:e,Scenario:{Name:Xv.getSubstrateScenarioName(),Dimensions:[{DimensionName:"UserExperience",DimensionValue:"PromptLibrary"}]}};return JSON.stringify(t)},Xb=function(e,t){void 0===t&&(t=!1);var n={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:t,ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(n)},$b=function(){return[{key:Dv.XClientLanguage,value:Xv.getLanguage()},{key:Dv.XClientFlights,value:"EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion"}]},ey=function(e){return[{key:Dv.ClientRequestId,value:e}]},ty=dv,ny=function(e){ty=e},ry="libbie-loader",oy="https://admin.microsoft.com",iy="https://admin-ignite.microsoft.com",ay=null,sy=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return ay.updateSelectedFacets(e?{displayCategory:[e]}:void 0),[4,Object(Wb.b)({centroEnvironmentBaseUrl:Xv.isDevbuild()?iy:oy,preConfig:{hostName:"SharedCopilot",locale:"en",perfPrefix:"SharedCopilot_"},enableUxVersionQueryParam:!0})];case 1:return o.sent(),t=function(e){e("centro.hvc.libbieloader",ay)},[4,Object(Wb.c)({featureName:ry,adapters:{dataSources:t},localMode:!!window.localStorage.getItem("centro.hvc-loader.localMode")})];case 2:return o.sent(),[4,Object(Wb.a)({featureName:ry})];case 3:return n=o.sent(),r=document.createElement("div"),[4,n.main(r)];case 4:return o.sent(),[2]}}))}))},ly=n(1540),cy=function(){function e(t,n,r){var o=this;this.citationPathDataIndexMap=new Map,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.streamChunks=[],this.isAnswerCompleted=!1,this.isBasicChatStreaming=!1,this.queryID="",this.suggestedQnaSignalSubmitTime=0,this.featureName=Cm.ChatQnA,this.onClickCitationLink=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=""),gy("onClickCitationLink called with referenceId : ".concat(e,"  ,path"),o.citationPathDataIndexMap.get(e));var r={correlationId:"",featureName:""};try{r=JSON.parse(n)}catch(e){gy("Error parsing telemetry data on citation click",e.message)}o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CitationClicked},{key:im.UserQueryGuid,value:r.correlationId||""}]);var i={referencePath:t.length>0?t:o.citationPathDataIndexMap.get(e),workflowAnnotationType:gm.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(_m.CitationLinkClicked,i)},this.sendBasicChatSuggestionPillsEvent=function(e){var t={suggestionPills:e,workflowAnnotationType:gm.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(_m.BasicChatSuggestionPills,t)},this.getMarkdownReferences=function(e){return void 0===e||e&&0===e.length||!o.basicChatProps.isCitationsEnabled?[]:(o.citationPathDataIndexMap.clear(),e.map((function(e){var t,n,r;o.citationPathDataIndexMap.set(e.contentIndex,e.path),e.content&&e.content.length>150&&(e.content=e.content.substring(0,150).trim()+"...");var i='"'+e.content.slice(0,18).trim()+'..."';return e.content='"'+e.content+'"',{referenceIndex:e.contentIndex,referenceProps:{title:i,primarySubtitle:null===(t=o.basicChatProps)||void 0===t?void 0:t.citationTitle,snippet:e.content,iconAppName:e.type,referenceType:di.a.Internal,citationPosition:e.position,onClickCitationLink:o.onClickCitationLink,sensitivityLabel:null===(r=null===(n=o.basicChatProps)||void 0===n?void 0:n.sensitivityIndicatorData)||void 0===r?void 0:r.badgeText,path:e.path}}})))},this.updateCardWithFooter=function(){var t,n;o.chatContainerBuilder.updateLastMessage(c.MarkdownCard,void 0,{feedbackSectionPosition:oo.Footer,showAnimation:!0,actionButtonList:[o.getCopyButton()],clpSensitivityIndicatorData:null!==(n=null===(t=e.getInstance().getBasicChatProps())||void 0===t?void 0:t.sensitivityIndicatorData)&&void 0!==n?n:void 0},!0)},this.sendBasicChatProcessingEvent=function(e){o.copilotCommunicationHandler.sendEventToClient(_m.BasicChatStatus,e)},this.getFeedbackData=function(){var e=o.copilotCommunicationHandler.getFeedbackData(),t=o.featureName;return e&&!e.feedbackArea&&(e={feedbackArea:t===Cm.Draft?Rv.DRAFT:Rv.BASIC_CHAT,contextData:{cardMetaData:JSON.stringify({prompt:vS,promptId:o.queryID}),sydneyContextData:{conversationId:pb.Instance.ConversationId,sydneyEndpoint:pb.Instance.SydneyEndpoint,requestId:pb.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:pb.Instance.CurrentUserMessageId},feedbackContextData:{prompt:vS,promptId:o.queryID},groundingSource:mb(),entryPoint:"Chat"}}),e},this.handleTimeoutForBasicChatStreaming=function(){var t=o.getFeatureName();o.isFirstStreamChunk||(o.paragraphChunks.length>0&&(o.updateCardWithFooter(),o.resetBasicChatStreamingStates(!1)),o.isAnswerCompleted||o.chatContainerBuilder.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:lv}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:oo.Footer,isFailure:!0,showAnimation:!1,feedbackData:o.getFeedbackData(),telemetryData:JSON.stringify({correlationId:e.getInstance().getQueryID(),featureName:e.getInstance().getFeatureName()})},!0),o.setIsExecuting(!1)),o.sendBasicChatProcessingEvent({status:Lm.Finished,workflowAnnotationType:gm.b.getTypeName(),queryID:o.queryID,isSuccess:!1}),o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.BasicChatStreamingResponseTimeout},{key:im.UserQueryGuid,value:o.queryID},{key:im.ChatErrorType,value:ym.Server}]),o.telemetryLoggerUtils.logErrorWithAshaVetoAndError([{key:Mm,value:o.queryID}],t,"",Om.BasicChatResponseTimedOut,Em.Timeout),o.resetBasicChatStreamingStates(!1)},this.sendLoggingEventToClient=function(e,t){o.loggingEventHandler.sendLoggingEventToClient(e,t)},this.getIsFirstStreamChunk=function(){return o.isFirstStreamChunk},this.setIsFirstStreamChunk=function(e){o.isFirstStreamChunk=e},this.getParagraphChunks=function(){return o.paragraphChunks},this.setParagraphChunks=function(e){o.paragraphChunks=e},this.getIsAnswerCompleted=function(){return o.isAnswerCompleted},this.setIsAnswerCompleted=function(e){o.isAnswerCompleted=e},this.getIsBasicChatStreaming=function(){return o.isBasicChatStreaming},this.setIsBasicChatStreaming=function(e){o.isBasicChatStreaming=e},this.setQueryID=function(e){o.queryID=e},this.setFeatureName=function(e){o.featureName=e},this.getFeatureName=function(){return o.featureName},this.getQueryID=function(){return o.queryID},this.setBasicChatProps=function(e){o.basicChatProps=e},this.getIsFluxFlowEnabled=function(){var e;return null===(e=o.basicChatProps)||void 0===e?void 0:e.isFluxFlowEnabled},this.updateStreamChunks=function(e){o.streamChunks.push(e)},this.getStreamChunks=function(){return o.streamChunks},this.getBasicChatProps=function(){return o.basicChatProps},this.getSuggestedQnaSignalSubmitTime=function(){return o.suggestedQnaSignalSubmitTime},this.getSuggestedQnaScenarioSignalOperation=function(){var e={isBasicChat:!0,chatHistory:[],isStreaming:!0,queryId:Object(fm.a)(),userLanguage:ov(Xv.getLanguage()),isSuggestedQnAScenario:!0},t=new ub.b({parentPath:["Signal",ly.a.getTypeName()],items:[{id:db.a.generateId(),body:new ly.a(e)}]});return o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.BasicChatOperationSubmitted},{key:im.UserQueryGuid,value:e.queryId}]),o.suggestedQnaSignalSubmitTime=(new Date).getTime(),t},this.resetBasicChatStreamingStates=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),o.streamChunks.length>0&&(o.telemetryLoggerUtils.sendTelemetryLatencyData([{key:om.QnAResponseTime,value:OS(hS)},{key:om.IsQuerySuccess,value:e},{key:om.QnAChunkInfo,value:JSON.stringify(o.getStreamChunks())},{key:om.UserQueryGuid,value:o.queryID},{key:om.AnnotationType,value:gm.b.getTypeName()}],t),e&&o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QuerySuccessful},{key:im.UserQueryGuid,value:o.queryID},{key:im.ChatEventParameters,value:gm.b.getTypeName()}])),o.setIsFirstStreamChunk(!0),o.setParagraphChunks(dv),o.setIsAnswerCompleted(!1),o.setIsBasicChatStreaming(!1),o.setQueryID(dv),o.telemetryLoggerUtils.setUserQueryGuid(dv),o.streamChunks=[],o.featureName=Cm.ChatQnA},this.chatContainerBuilder=t,this.copilotCommunicationHandler=n,this.setIsExecuting=r,this.loggingEventHandler=Fm.getInstance(),this.telemetryLoggerUtils=Ym.getInstance()}return e.getInstance=function(t,n,r){if(!e.instance){if(!t||!r||!n)throw new Error("BasicChat Utils is not initialized");e.instance=new e(t,n,r)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.getCopyButton=function(){return{type:Ko.Default,title:yv(),text:s()?"":yv(),iconRegular:s()?ct.e:ct.c,popoverProps:{popoverTitle:Ov()},position:s()?Yo.FeedbackSection:Yo.ActionButtonBar,handleButtonOnClick:rv}},e}(),uy=function(){function e(e,t){var n=this;this.augloopResponseTimerID=null,this.augloopResponseTimeout=av,this.telemetryLoggerUtils=Ym.getInstance(),this.augloopResponseTimeoutInternal=function(){n.augloopResponseTimerID=null,gy("Augloop Response Timed Out for workflow",n.workflowAnnotationType),Ay.getInstance().clearOperationListForResubmit(),n.augloopResponseTimeout=av;var e=!0;n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:om.ErrorParameter,value:sm.AugloopResponseTimeout},{key:om.ErrorType,value:ym.Server}]),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.AugloopResponseTimeout},{key:im.ChatErrorType,value:ym.Server},{key:im.ChatEventParameters,value:n.workflowAnnotationType},{key:im.ChatErrorKey,value:lm.AugloopResponseTimeoutMessage}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:am.ErrorMessage,value:mv},{key:am.ErrorType,value:ym.Server},{key:am.ErrorCode,value:Vv.AugloopResponseTimeout},{key:am.ErrorCategory,value:rm.ChatEvents}]),n.workflowAnnotationType===hm.a.getTypeName()?n.setSensitivityWarningInfo():(cy.getInstance().getIsBasicChatStreaming()&&n.workflowAnnotationType===gm.b.getTypeName()&&(cy.getInstance().handleTimeoutForBasicChatStreaming(),e=!1),n.copilotCommunicationHandler.sendEventToClient(_m.AugloopResponseTimeout,{workflowAnnotationType:n.workflowAnnotationType}),pb.Instance.ErrorMessage="Augloop_Response_TimedOut_"+n.workflowAnnotationType),e&&n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(hS)},{key:om.IsQuerySuccess,value:!1}],!0)},this.copilotCommunicationHandler=e,this.setSensitivityWarningInfo=t}return e.getInstance=function(t,n){if(!e.sInstance){if(!t||!n)throw new Error("AugloopResponseTimeoutHandler has not been initialized");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(e){var t;gy("Setting augloop response Timer for workflow ".concat(e)),this.clearAugloopResponseTimer(),tv(e)||(this.workflowAnnotationType=e),tv(this.workflowAnnotationType)||(this.augloopResponseTimeout=tb.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)),this.augloopResponseTimeout=null!==(t=this.augloopResponseTimeout)&&void 0!==t?t:av,this.augloopResponseTimerID=window.setTimeout(this.augloopResponseTimeoutInternal,this.augloopResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(){null!==this.augloopResponseTimerID&&(gy("Clear augloop response Timer"),clearTimeout(this.augloopResponseTimerID),this.augloopResponseTimerID=null,this.augloopResponseTimeout=av)},e.prototype.isAugloopResponseTimerSet=function(){return!tv(this.augloopResponseTimerID)},e}(),dy=!1,py=function(e){dy=e},gy=function(e,t){if(Xv.isDevbuild()){var n=sb.getInstance();null==t?(console.log("CopilotChat Log:",e),null==n||n.addLog("CopilotChat Log:",e)):(console.log("CopilotChat Log:",e,t),null==n||n.addLog("CopilotChat Log:",e,t))}},hy=function(){var e,t,n,r=null===(n=null===(e=window.getSelection)||void 0===e?void 0:(t=e.call(window)).getRangeAt)||void 0===n?void 0:n.call(t,0).startOffset;return r||0===r?r:-1},fy=function(){var e=window.getSelection();return e?e.isCollapsed:(gy("window.getSelection() returned null"),!1)},my=function(e,t){var n,r;if(void 0===t&&(t=!0),0===e.length)return-1;var o=e.length-1;return e.length>=2&&(e[o].messageType===c.FeedbackNudge||"human"===(null===(r=null===(n=t&&e[o])||void 0===n?void 0:n.body)||void 0===r?void 0:r.user))&&(o=e.length-2),o};function vy(e){return null==e}var by=function(){return tb.getInstance().isWorkflowRegistered(dm.c.getTypeName())||tb.getInstance().isWorkflowRegistered(dm.b.getTypeName())||tb.getInstance().isWorkflowRegistered(dm.a.getTypeName())},yy=function(){return tb.getInstance().isWorkflowRegistered(lb.a.getTypeName())&&tb.getInstance().getWorkflowDataMap().get(lb.a.getTypeName()).workflowInfo.shouldHandleResponse},Cy=function(e,t){var n=e;return(null==t?void 0:t.length)&&t.reverse().forEach((function(t){var r=Object(o.__read)(t.range,2),i=r[0],a=r[1],s=e.slice(i,a+1),l="[".concat(s,"](").concat(t.value,")");n=n.slice(0,i)+l+n.slice(a+1)})),{user:Bv.Human,message:n,disableLinksProcessing:!0}};function Oy(e){var t=Object.keys(e).filter((function(e){return"themeBackground"!==e})).reduce((function(t,n){var r;return Object.assign(t,((r={})[n]=e[n],r))}),{});return t}var Sy=function(e){var t=e,n=!1;return e.includes("<entity")?(t=e.slice(0,e.indexOf("<entity")),n=!0):e.includes("<placeholder")&&(t=e.slice(0,e.indexOf("<placeholder"))),{inputSpanText:t,isFileEntityPresent:n}},Ey=function(){dy=!1,Pb=void 0,Bb=null,Rb=null,Fb=null,Mb=[],Hb=!0,_b=void 0,Ub=!1,Nb=null,ay=null,CS(),ny(dv)};function xy(e,t,n,r,o){var i=Ym.getInstance();gy("basicChatErrorHandler called with error : ".concat(e," and status : "),t);var a="";if(!vy(e.errorDetailsJson))try{a=JSON.parse(e.errorDetailsJson).code}catch(e){gy("Error parsing error code from basic chat error",e.message)}cy.getInstance().sendLoggingEventToClient(Dm.AugloopErrorReceived,{annotationName:o,timeInMs:SS(hS),chatEventParams:JSON.stringify({errorCategory:e.category,errorCode:a})}),i.sendTelemetryChatEventData([{key:im.ChatEventType,value:"".concat(o,"_Error")},{key:im.ChatEventParameters,value:"".concat(e.category,"_").concat(a)},{key:im.ChatErrorType,value:ym.Server},{key:im.UserQueryGuid,value:cy.getInstance().getQueryID()}]),i.sendTelemetryLatencyData([{key:om.ErrorParameter,value:"".concat(e.category,"_").concat(a)},{key:om.ErrorType,value:ym.Server}]);var s=e.category,l=Em.Fallback,c=Om.BasicChatUnclassifiedError;switch(s){case Uv.OffensiveContent:switch(c=Om.BasicChatRAIFilterBlockedResponse,a){case Hv.OffensiveInputContent:l=Em.OffensiveInput,Iy(n,Ev());break;case Hv.OffensiveOutputContent:l=Em.OffensiveOutput,Iy(n,xv());break;case Hv.OutputBlockedByDynamicGuardList:l=Em.OutputBlocked,Iy(n,xv());break;case Hv.InputBlockedByDynamicGuardList:l=Em.InputBlocked,Iy(n,Iv());break;default:Iy(n,wv())}break;case Uv.PromptInjection:if(a===Hv.Detected)c=Om.BasicChatRAIFilterBlockedResponse,l=Em.PromptInjection,Iy(n,Iv());else Iy(n,wv());break;case Uv.InvalidSignal:switch(l=Em.InvalidSignal,c=Om.BasicChatUnclassifiedError,a){case Hv.Missing:l=Em.SignalMissing,Iy(n,wv());break;case Hv.WrongType:l=Em.SignalWrongType,Iy(n,wv());break;default:Iy(n,wv())}break;case Uv.InvalidLanguage:if(l=Em.InvalidLanguage,c=Om.BasicChatUnsupportedCopilotFunctionality,a===Hv.NotSupported){var u=cy.getInstance().getBasicChatProps();(null==u?void 0:u.languageHelpLink)?wy(n,Av(),_v(),u.languageHelpLink):Iy(n,Av())}else Iy(n,wv());break;case Uv.InferenceAPI:switch(a){case Hv.Timeout:c=Om.BasicChatResponseTimedOut,l=Em.Timeout,Iy(n,Tv());break;case Hv.UserThrottled:l=Em.UserThrottled,c=Om.BasicChatCapacityIssues,Iy(n,jv());break;case Hv.Throttled:l=Em.Throttled,c=Om.BasicChatCapacityIssues,Iy(n,kv());break;case Hv.ScenarioThrottled:l=Em.ScenarioThrottled,c=Om.BasicChatCapacityIssues,Iy(n,kv());break;case Hv.NotAvailable:l=Em.APIUnavailable,c=Om.BasicChatBadResponse,Iy(n,Tv());break;case Hv.InputRaiDependency:l=Em.RAIOnInputError,c=Om.BasicChatRAIFilterBlockedResponse,Iy(n,Ev());break;case Hv.OutputRaiDependency:l=Em.RAIOnOutputError,c=Om.BasicChatRAIFilterBlockedResponse,Iy(n,wv());break;case Hv.UnknownOpenAI:l=Em.UnknownError,c=Om.BasicChatBadResponse,Iy(n,wv());break;case Hv.BadResponse:l=Em.BadResponse,c=Om.BasicChatBadResponse,Iy(n,wv());break;case Hv.BadRequest:l=Em.BadRequest,c=Om.BasicChatUnclassifiedError,Iy(n,wv());break;case Hv.Unknown:l=Em.Unknown,c=Om.BasicChatUnclassifiedError,Iy(n,wv());break;default:Iy(n,wv())}break;case Uv.InvalidInput:if(a===Hv.TooLong)l=Em.InputTooLong,c=Om.BasicChatInputNotProcessed,Iy(n,Pv());else Iy(n,wv());break;default:Iy(n,wv())}i.logErrorWithAshaVetoAndError([{key:im.UserQueryGuid,value:cy.getInstance().getQueryID()}],cy.getInstance().getFeatureName(),dv,c,l),cy.getInstance().getIsFluxFlowEnabled()||(gy("Encountered Error. Stopping loading UI"),r(!1))}var Iy=function(e,t){e.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:oo.Footer,isFailure:!0,showAnimation:!1,feedbackData:cy.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:cy.getInstance().getQueryID(),featureName:cy.getInstance().getFeatureName()})},!0)},wy=function(e,t,n,r){e.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t,linkText:{text:n,linkOnClick:Ty,linkUrl:r}}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:oo.Footer,isFailure:!0,showAnimation:!1,feedbackData:cy.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:cy.getInstance().getQueryID(),featureName:cy.getInstance().getFeatureName()})},!0)},Ty=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return window.open(e),[2]}))}))},ky=22;function jy(){return"object"==typeof window&&window.crypto&&function(){var e=new Uint8Array(ky);window.crypto.getRandomValues(e);for(var t=new Array(ky),n=0;n<ky;n++)t[n]=e[n]/256;return t}()||function(){for(var e=new Array(ky),t=0;t<ky;t++)e[t]=Math.random();return e}()}var Py,Ay=function(){function e(e,t,n,r,o){this.isSessionConnected=!0,this.isSessionClosed=!1,this.isLicenseAnnotationActivated=!0,this.operationListForResubmit=new Map,this.callbackTokens=[],this.annotationTokens=[],this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.alSession=n,this.isSessionClosed=this.alSession.isClosed,this.isSessionConnected=this.alSession.isConnected,this.loggingEventHandler=Fm.getInstance(t),this.telemetryLoggerUtils=Ym.getInstance(),this.setIsExecuting=r,this.setALSessionClosed=o}return e.getInstance=function(t,n,r,o,i){return void 0===this.sInstance?(this.sInstance=new e(t,n,r,o,i),this.sInstance.registerCallbacks()):void 0!==r&&this.sInstance.alSession!==r&&(this.sInstance.releaseActiveAnnotations(),this.sInstance.removeCallbacks(),this.sInstance.alSession=r,this.sInstance.isSessionClosed=r.isClosed,this.sInstance.isSessionConnected=r.isConnected,this.sInstance.setALSessionClosed(this.sInstance.isSessionClosed),this.sInstance.registerCallbacks()),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.removeCallbacks=function(){var e=this;this.callbackTokens.forEach((function(t){e.alSession.removeSessionStateCallback(t)})),this.callbackTokens=[]},e.prototype.releaseActiveAnnotations=function(){var e=this;this.isSessionClosed||this.annotationTokens.forEach((function(t){e.alSession.releaseAnnotation(t).then((function(e){gy("Annotation deactivated: "+e)})).catch((function(e){gy("error in deactivating: ",e)}))})),this.annotationTokens=[]},e.prototype.registerCallbacks=function(){this.registerOnConnectCallback(),this.registerOnDisconnectCallback(),this.registerOnReconnectCallback(),this.registerOnCloseCallback()},e.prototype.registerOnConnectCallback=function(){var e=this,t=this.alSession.setConnectCallback((function(t,n,r,o){var i=n.substring(n.lastIndexOf("/")+1);gy("AL Session onSessionConnect, isSeedingRequired: ".concat(t,", sessionKey: ").concat(i)),e.isSessionConnected=!0,e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALSessionConnected},{key:im.ChatEventParameters,value:"isSeedingRequired: "+t.toString()},{key:im.ALSessionKey,value:i}]),e.loggingEventHandler.sendLoggingEventToClient(Dm.ALSessionConnected,{chatEventParams:t.toString()}),t?yy()?e.resubmitTimerId=setTimeout((function(){var t,n,r,o,i,a,s;e.isLicenseAnnotationActivated||(gy("License annotation is not activated, so not re-submitting signal and showing error"),Iy(e.chatContainerBuilder,nv()?OfficeaicopilotStrings.LicenseValidationErrorMessage:"We encountered a problem validating your Copilot license. For more information, see https://aka.ms/copilotlicensecheck"),uy.getInstance().clearAugloopResponseTimer(),t=lb.a.getTypeName(),n="License annotation is not activated",r=ym.Client,o=Sm.UserAccessIssue,i=xm.Licensing,a=Cm.CopilotChat,(s=Ym.getInstance()).sendTelemetryChatEventData([{key:im.ChatEventType,value:"".concat(t,"_Error")},{key:im.ChatEventParameters,value:n},{key:im.ChatErrorType,value:r}]),s.sendTelemetryLatencyData([{key:om.ErrorParameter,value:n},{key:om.ErrorType,value:r},{key:om.UserPerceivedLatency,value:OS(hS)},{key:om.IsQuerySuccess,value:!1},{key:om.FeatureName,value:a}],!0),s.logErrorWithAshaVetoAndError([],a,dv,o,i),e.setIsExecuting(!1),e.copilotCommunicationHandler.sendEventToClient(_m.ResetContextId)),e.clearOperationListForResubmit()}),6e3):e.resubmitOnLicenseAnnotationActivation():(e.clearOperationListForResubmit(),e.setLicenseAnnotationActivated(!0))}));this.callbackTokens.push(t)},e.prototype.registerOnDisconnectCallback=function(){var e=this,t=this.alSession.setDisconnectCallback((function(t){gy("AL Session Disconnected",t),e.isSessionConnected=!1,yy()&&e.setLicenseAnnotationActivated(!1),e.loggingEventHandler.sendLoggingEventToClient(Dm.ALSessionDisconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALSessionDisconnected},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}])}));this.callbackTokens.push(t)},e.prototype.registerOnReconnectCallback=function(){var e=this,t=this.alSession.setReconnectCallback((function(){e.isSessionConnected=!0,e.loggingEventHandler.sendLoggingEventToClient(Dm.ALSessionReconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALSessionReconnected},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),gy("AL Session Reconnected")}));this.callbackTokens.push(t)},e.prototype.registerOnCloseCallback=function(){var e=this,t=this.alSession.setSessionCloseCallback((function(t){e.isSessionClosed=!0,e.setALSessionClosed(e.isSessionClosed),e.loggingEventHandler.sendLoggingEventToClient(Dm.ALSessionClosed),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALSessionClosed}]),gy("AL Session Closed",t)}));this.callbackTokens.push(t)},e.prototype.activateAnnotation=function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a=this;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.alSession.activateAnnotation(e,{callback:t,config:n,forceReturnCachedAnnotations:i}).then((function(t){return Object(o.__awaiter)(a,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(i){return gy("Annotation Token: "+t.token),this.annotationTokens.push(t.token),e===dm.c.getTypeName()||e===dm.b.getTypeName()||e===dm.a.getTypeName()||t.token.includes(dm.c.getTypeName())||t.token.includes(dm.b.getTypeName())||t.token.includes(dm.a.getTypeName())?(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.ChatHistoryDuplicateLoggingFix)&&e===dm.b.getTypeName()&&(Ub=!0),function(e,t){Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CurrentChatHistoryStart},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),Ab=(new Date).getTime(),[4,Vb(um.c.GetCurrentChatOperation,void 0,e,t)];case 1:return n.sent(),[2]}}))}))}(r,this.copilotCommunicationHandler)):(e===gm.c.getTypeName()||t.token.includes(gm.c.getTypeName()))&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsQnASuggestionPillCachingEnabled)?this.submitOperation(cy.getInstance().getSuggestedQnaScenarioSignalOperation(),gm.c.getTypeName()):e===$v.a.getTypeName()&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsSharedCopilotLabEnabled)&&this.submitOperation(Yb(Qb.b.Suggestion),$v.a.getTypeName()),n={workflowAnnotationType:e,responseToken:t.token},this.copilotCommunicationHandler.sendEventToClient(_m.AnnotationActivated,n),[2]}))}))})).catch((function(e){gy("error in activating: ",e)}))];case 1:return s.sent(),[2]}}))}))},e.prototype.submitOperation=function(e,t){var n,r;(!1===this.isSessionConnected||!0===this.isSessionClosed||yy()&&!1===this.isLicenseAnnotationActivated)&&(gy("Session is not connected, adding operation to resubmit list."),this.operationListForResubmit.set(e,t),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.AddToOperationListForResubmit},{key:im.ChatEventParameters,value:t}]));var o=function(){for(var e=jy(),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<ky;r++)n.push(t.charAt(Math.floor(e[r]*t.length)));return n.join("")}(),i=e.items.length>0?null===(r=null===(n=e.items[0])||void 0===n?void 0:n.body)||void 0===r?void 0:r.H_.T_:"";gy("Submitting operation to AL: ".concat(e,", signalName: ").concat(i,", cv: ").concat(o)),this.alSession.submitOperation(e,o);var a={workflowAnnotationType:t,cv:o,operation:JSON.stringify(e)};this.copilotCommunicationHandler.sendEventToClient(_m.QuerySubmitted,a),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QuerySubmittedToAL},{key:im.ChatEventParameters,value:i},{key:im.Cv,value:o}]),this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:om.RequestSignalType,value:i}])},e.prototype.clearOperationListForResubmit=function(){this.operationListForResubmit.clear(),gy("Operation list for resubmit is cleared"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResetOperationListForResubmit},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}])},e.prototype.setLicenseAnnotationActivated=function(e){this.isLicenseAnnotationActivated=e,gy("License Annotation Activated: "+e)},e.prototype.resubmitOnLicenseAnnotationActivation=function(){var e=this;gy("operationListForResubmit: ",this.operationListForResubmit),this.operationListForResubmit.forEach((function(t,n){var r,o;e.submitOperation(n,t),gy("Resubmitting signal for operation: ",n);var i=n.items.length>0?null===(o=null===(r=n.items[0])||void 0===r?void 0:r.body)||void 0===o?void 0:o.H_.T_:"";e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QueryResubmittedToAL},{key:im.ChatEventParameters,value:i}]),tb.getInstance().isAugloopResponseTimeoutRequired(t)&&uy.getInstance().setAugloopResponseTimer(t)})),clearTimeout(this.resubmitTimerId),gy("Resubmitting signals for operations in operation list for resubmit is completed. Cleared resubmit timer."),this.clearOperationListForResubmit()},e}(),_y=null,Dy=null,Ly={},My=function(){function e(){}return e.getInstance=function(){return e.telemetryEventHandler||(e.telemetryEventHandler=new e),e.telemetryEventHandler},e.prototype.initTelemetryLatencyObject=function(){var e;e={},Object.keys(om).forEach((function(t){e[t]=0})),_y=e},e.prototype.initTelemetryChatEventObject=function(){var e;e={},Object.keys(im).forEach((function(t){e[t]=""})),Dy=e},e.prototype.updateTelemetryLatencyData=function(e,t){null!=_y&&(Object.keys(e).forEach((function(t){_y[t]=e[t],Ly[t]=e[t]})),t&&this.sendTelemetryLatencyData(t))},e.prototype.updateTelemetryChatEventData=function(e,t){null===Dy&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(t){Dy[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)},e.prototype.updateTelemetryQueryDetailsEventData=function(e){Object.keys(e).forEach((function(t){Ly[t]=e[t]}))},e.prototype.sendTelemetryLatencyData=function(e){var t;null!=e&&(e.logEvent(((t=_y)[om.UserQueryGuid]=mS,t[om.CopilotChatSessionId]=Xv.getSessionId(),{eventType:rm.Latency,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e))},e.prototype.sendTelemetryQueryDetailsObject=function(e){var t;null==e||e.logEvent(((t=Ly)[Im.UserQueryGuid]=mS,t[Im.HostSDXSessionID]=Xv.getSessionId(),t[Im.UserQueryOrder]=bS,{eventType:rm.QueryDetails,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),Ly={}},e.prototype.sendTelemetryChatEventData=function(e){if(null!=e){if(e.logEvent(((n=Dy)[im.UserQueryGuid]=mS,n[im.CopilotChatSessionId]=Xv.getSessionId(),n[im.UserQueryOrder]=bS,{eventType:rm.ChatEvents,eventData:Object.keys(n).map((function(e){return{key:e,value:n[e]}}))})),Dy[im.ChatEventType]){var t=Object.keys(sm)[Object.values(sm).indexOf(Dy[im.ChatEventType])];Ly[t]=0===Dy[im.ChatEventParameters].length?"true":Dy[im.ChatEventParameters]}this.initTelemetryChatEventObject()}var n},e}(),By=n(1086),Ry="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",Fy=function(){function e(){this.oTelLogger=new By.a,this.setupTelemetryLogger(this.oTelLogger),this.telemetryEventHandler=My.getInstance()}return e.getInstance=function(){return e.telemetryLogger||(e.telemetryLogger=new e),e.telemetryLogger},e.prototype.getDefaultEventFlags=function(){return{}},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logError=function(e,t){var n;this.logTelemetryErrorEvent(e,t),this.telemetryEventHandler.updateTelemetryQueryDetailsEventData(((n={})[Im.ErrorCategory]=e.eventType,n[Im.ErrorMessage]=e.errorMessage,n))},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:{ariaTenantToken:Ry,nexusTenantToken:1763},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Object(o.__assign)(Object(o.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)},e.prototype.logTelemetryErrorEvent=function(e,t){var n={eventName:"Office.Voice.ActionAI."+rm.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Object(o.__assign)(Object(o.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:"CopilotChatSessionId",value:Xv.getSessionId()}])};this.oTelLogger.sendError(n)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?Qm.b(e.key,e.value):"string"==typeof e.value?Qm.d(e.key,e.value):"boolean"==typeof e.value?Qm.a(e.key,e.value):Qm.d(e.key,e.value)}),[])},e.prototype.setupTelemetryLogger=function(e){e.setTenantToken("Office.Voice.ActionAI",Ry,1763)},e}(),Ny=Object(o.__assign)(Object(o.__assign)({},T.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),Hy=(Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(Yd.a)({10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"})),Uy=function(e,t,n,r,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(){return{sections:p.menuProps.sections.map((function(e){return{sectionHeader:e.sectionHeader,showSectionTopDivider:e.showSectionTopDivider,starterPrompts:e.starterPrompts.map((function(e){return{text:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover}}))}})),handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem}},this.handleOnClickMenuItem=function(e){return Object(o.__awaiter)(p,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t=e,n=dv,ny(dv),this.loggingEventHandler.sendLoggingEventToClient(Dm.MenuButtonItemClicked,{suggestionClicked:e}),this.isFreVisible&&this.setFreVisible(!1),e.endsWith(gv)?[4,this.setChatInputStateExpanded()]:[3,2];case 1:o.sent(),t=t.slice(0,-gv.length)+" ",o.label=2;case 2:return(null==(r=this.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:r.inputAreaText)&&(t=r.inputAreaText),this.immediateActionableQueries[e]?(null===(i=this.chatInputRef.current)||void 0===i||i.setInputText(dv),null===(a=this.chatInputRef.current)||void 0===a||a.setGhostText(this.chatPlaceholderMessage),this.handleSubmit({text:t,telemetryData:sm.MenuItemClicked}),[3,8]):[3,3];case 3:return(null==r?void 0:r.copilotPromptLab)&&(null==r?void 0:r.copilotPromptLab.shouldOpenCopilotPromptLab)?this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsSharedCopilotLabEnabled)?[4,sy()]:[3,5]:[3,7];case 4:return o.sent(),[3,6];case 5:null==r||r.copilotPromptLab.launchCopilotPromptLab(),o.label=6;case 6:return[3,8];case 7:e===this.transformFileSuggestionText&&this.chatEditor&&(n=this.transformFilePlaceholderText),this.updateHintCard(e),null===(s=this.chatInputRef.current)||void 0===s||s.setInputText(t),null===(l=this.chatInputRef.current)||void 0===l||l.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1),null===(c=this.chatInputRef.current)||void 0===c||c.setGhostText(n),o.label=8;case 8:return gy("Suggestion clicked: "+e),[2]}}))}))},this.generateQueryMap=function(){var e={};p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e[t.suggestionText]=t.shouldSubmitQueryOnClick}))})),p.immediateActionableQueries=e},this.generatePromptSuggestionList=function(){var e=[];p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e.push(t)}))})),p.promptSuggestionList=e},this.getTransformFileSuggestionText=function(){var e,t,n,r;try{for(var i=Object(o.__values)(p.menuProps.sections),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(n=void 0,Object(o.__values)(s.starterPrompts)),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.shouldLaunchCIQOnSelection)return u.suggestionText}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return dv},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=r,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=s,this.chatPlaceholderMessage=u,this.generateQueryMap(),this.generatePromptSuggestionList(),this.updateHintCard=d,this.isFreVisible=i,this.setFreVisible=a,this.loggingEventHandler=Fm.getInstance(),this.copilotCommunicationHandler=l,this.setChatInputStateExpanded=c};!function(e){e.Backspace="Backspace",e.Escape="Escape",e.Delete="Delete",e.V="V"}(Py||(Py={}));var Vy,zy=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){var m=this;this.handleOnInput=function(e){var t;return m.isFreVisible&&m.setFreVisible(!1),(null===(t=m.chatInputRef.current)||void 0===t?void 0:t.getInputText())===dv&&(m.updateHintCard(dv),ny(dv),m.loggingEventHandler.sendLoggingEventToClient(Dm.InputAreaTextChangedToEmpty)),!0},this.getProps=function(e,t){var n={isDisabled:m.isDisabled,placeholderText:m.chatPlaceHolderMessage,isMenuButtonEnabled:!0,maxInputCharLimit:cv,handleSubmitButtonClick:function(e){var t;m.loggingEventHandler.sendLoggingEventToClient(Dm.SubmitButtonClicked);var n=m.chatInputRef.current?null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement()):void 0;m.handleSubmit({text:e,links:n,telemetryData:sm.SubmitButtonClicked})},handleKeyDown:function(e){var t,n=m.chatInputRef.current;if(!n)return!1;var r=n.getInputText(),o=n.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===Py.V)n.setGhostText(dv);else{if("Enter"===e.key){if(e.preventDefault(),r.trimStart()===dv)return!1;var i=null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement());return n.setInputText(dv),n.setGhostText(m.chatPlaceHolderMessage),m.handleSubmit({text:r,links:i}),!1}e.key===Py.Backspace?m.chatEditor&&r.length>1&&fy()&&hy()===r.length&&r.slice(-1)===$u?(m.updateHintCard(m.menuBuilder.getTransformFileSuggestionText()),n.setGhostText($u+m.ciqPlaceholderText)):0!==hy()&&o!==dv&&n.setGhostText(dv):(e.key===Py.Escape||e.key===Py.Delete&&hy()!==r.length&&o!==dv)&&n.setGhostText(dv)}return!0},handleOnChatInputControlMount:function(){m.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){m.setChatInputControlMounted(!1)},menuProps:m.menuBuilder.getMenuProps(),handleOnInput:m.handleOnInput,microphoneProps:m.microphoneButtonProps,handleOnBlur:e,chatInputBannerProps:t};return n},this.chatInputRef=e,this.isDisabled=t,this.handleSubmit=i,this.isFreVisible=n,this.setFreVisible=r,this.updateHintCard=a,this.chatPlaceHolderMessage=h,this.transformFilePlaceholderText=c,this.ciqPlaceholderText=u,this.updateHintCard=a,this.ciqResponseHandler=p,this.copilotCommunicationHandler=g,this.menuBuilder=new Uy(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a),this.chatEditor=s,this.setChatInputControlMounted=d,this.microphoneButtonProps=f,this.loggingEventHandler=Fm.getInstance()},Gy=function(e,t,n,r,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(e){var t={promptGuideMenuData:p.menuProps.promptGuideMenuData,copilotLabProps:p.menuProps.copilotLabProps,handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem,handleOnClickPromptGuideMenuButtonTelemetry:p.handleOnClickMenuButtonTelemetry,shouldBlockPromptGuideLaunch:p.shouldBlockPromptGuideLaunch};return p.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Nv.IsSharedCopilotLabEnabled)&&(!p.menuProps.copilotLabProps&&e.length>0&&(p.menuProps.copilotLabProps={copilotLabMenuItemText:Sv(),iconRegular:Zp.i,iconHover:Zp.h}),p.menuProps.copilotLabProps&&(p.menuProps.copilotLabProps.handleOnClickCopilotLab=function(e){return Object(o.__awaiter)(p,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,sy(e)];case 1:return t.sent(),[2]}}))}))})),t},this.shouldBlockPromptGuideLaunch=function(){return p.setPaneLoadMessageIfApplicable(Wv.PromptGuide)},this.handleOnClickMenuButtonTelemetry=function(){p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MenuButtonClicked}])},this.handleOnClickMenuItem=function(e,t,n){var r,o,i,a,s,l=e,c=dv;if(!t)return p.loggingEventHandler.sendLoggingEventToClient(Dm.MenuButtonItemClickedL1,{suggestionClicked:e}),void p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MenuL1SuggestionClicked},{key:im.ChatEventParameters,value:e}]);ny(dv),p.loggingEventHandler.sendLoggingEventToClient(Dm.MenuButtonItemClicked,{suggestionClicked:e}),p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MenuL2SuggestionClicked}]),p.isFreVisible&&p.setFreVisible(!1),e.endsWith(gv)&&(l=l.slice(0,-gv.length)+" "),p.immediateActionableQueries[e]?(null===(r=p.chatInputRef.current)||void 0===r||r.setInputText(dv),null===(o=p.chatInputRef.current)||void 0===o||o.setGhostText(p.chatPlaceholderMessage),p.handleSubmit({text:l})):(p.updateHintCard(e),n&&(l=l.replace(/ *\([^)]*\)/,pv),c=p.transformFilePlaceholderText),l=l.replace(/ *\[[^\]]*]/,dv),n||(l+=" "),n&&p.chatEditor&&p.chatEditor.setCurrentScope(n),null===(i=p.chatInputRef.current)||void 0===i||i.setInputText(l),null===(a=p.chatInputRef.current)||void 0===a||a.setFocus(),n&&p.chatEditor&&setTimeout((function(){var e;return null===(e=p.chatInputRef.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1),null===(s=p.chatInputRef.current)||void 0===s||s.setGhostText(c)),gy("Suggestion clicked: "+e)},this.generateQueryMap=function(){var e,t={};null===(e=p.menuProps.promptGuideMenuData.children)||void 0===e||e.forEach((function(e){var n;null===(n=e.children)||void 0===n||n.forEach((function(e){var n;"ActionSet"===e.nodeType&&(t[e.text]=null===(n=e.data)||void 0===n?void 0:n.shouldSubmitQueryOnClick)}))})),p.immediateActionableQueries=t},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=r,this.chatPlaceholderMessage=c,this.generateQueryMap(),this.updateHintCard=u,this.isFreVisible=i,this.setFreVisible=a,this.transformFilePlaceholderText=l,this.copilotCommunicationHandler=s,this.loggingEventHandler=Fm.getInstance(),this.telemetryLoggerUtils=Ym.getInstance(),this.setPaneLoadMessageIfApplicable=d},Wy=function(e,t,n,r,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D){var L,M,B=this;this.handleOnInput=function(e){var t;return B.isFreVisible&&B.setFreVisible(!1),(null===(t=B.chatInputRef.current)||void 0===t?void 0:t.getInputText())===dv&&(B.updateHintCard(dv),ny(dv),B.loggingEventHandler.sendLoggingEventToClient(Dm.InputAreaTextChangedToEmpty)),!0},this.getGroundingSourcePickerProps=function(){if(B.groundingSourcePickerProps)return Object(o.__assign)(Object(o.__assign)({},B.groundingSourcePickerProps),{onSelection:function(e){yb(e.id),B.groundingSourcePickerProps.onSelection&&B.groundingSourcePickerProps.onSelection(e)}})},this.getProps=function(e,t){var n,r,o=null===(n=B.editorProps)||void 0===n?void 0:n.editorConfig;o&&void 0===o.ciqPlaceholderText&&(B.editorProps.editorConfig.ciqPlaceholderText=B.ciqPlaceholderText);var i={isDisabled:B.isExecuting,isSubmitButtonDisabled:B.isSubmitButtonDisabled,copilotChatTheme:B.copilotTheme,isDarkMode:B.isDarkModeEnabled,dir:B.dir,placeholderText:B.chatPlaceHolderMessage,isMenuButtonEnabled:!0,isCIQButtonEnabled:B.isCIQButtonEnabled,isGroundingButtonEnabled:B.isGroundingButtonEnabled,isVersion3Enabled:B.isVersion3Enabled,characterLimitErrorMessage:B.characterLimitErrorMessage,maxInputCharLimit:uv,handleSubmitButtonClick:function(e,t){var n,r,o,i=t;B.loggingEventHandler.sendLoggingEventToClient(Dm.SubmitButtonClicked);var a=B.chatInputRef.current?null===(n=B.ciqResponseHandler)||void 0===n?void 0:n.generatCopilotOdslSignalLinks(B.chatInputRef.current.getInputSpanElement()):void 0;(null===(r=B.editorProps)||void 0===r?void 0:r.handleInChatInput)||(i=B.chatInputRef.current?null===(o=B.ciqResponseHandler)||void 0===o?void 0:o.generateQueryAnnotations(B.chatInputRef.current.getInputSpanElement()):void 0),B.handleSubmit({text:e,links:a,telemetryData:sm.SubmitButtonClicked,queryAnnotations:i})},handleKeyDown:function(e){var t,n,r=B.chatInputRef.current;if(!r)return!1;var o=null==r?void 0:r.getInputText(),i=null==r?void 0:r.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===Py.V)null==r||r.setGhostText(dv);else{if("Enter"===e.key){if(e.preventDefault(),B.shouldBlockSubmitButtonClick())return;if(B.isSubmitButtonDisabled||B.isExecuting)return!1;if(e.shiftKey)return!0;if(o.trimStart()===dv)return!1;var a=null===(t=B.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(B.chatInputRef.current.getInputSpanElement()),s=B.chatInputRef.current?null===(n=B.ciqResponseHandler)||void 0===n?void 0:n.generateQueryAnnotations(B.chatInputRef.current.getInputSpanElement()):void 0;return null==r||r.setInputText(dv),null==r||r.setGhostText(B.chatPlaceHolderMessage),B.handleSubmit({text:o,links:a,queryAnnotations:s}),!1}e.key===Py.Backspace?B.chatEditor&&o.length>1&&fy()&&hy()===o.length&&o.slice(-1)===$u?null==r||r.setGhostText($u+B.ciqPlaceholderText):0!==hy()&&i!==dv&&(null==r||r.setGhostText(dv)):(e.key===Py.Escape||e.key===Py.Delete&&hy()!==o.length&&i!==dv)&&(null==r||r.setGhostText(dv))}return!0},handleOnBeforeInput:function(e){var t=B.chatInputRef.current;return!(!t||e.data===$u&&B.chatEditor&&(null==t||t.setGhostText(B.ciqPlaceholderText),1))},handleOnChatInputControlMount:function(){B.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){B.setChatInputControlMounted(!1)},promptGuideMenuProps:null===(r=B.menuBuilder)||void 0===r?void 0:r.getMenuProps(e),handleOnInput:B.handleOnInput,voiceInputProps:B.voiceInputProps,groundingSourcePickerProps:B.getGroundingSourcePickerProps(),groundingButtonPluginProps:B.groundingButtonPluginProps,shouldBlockGroundingButtonClick:B.shouldBlockGroundingButtonClick,shouldBlockSubmitButtonClick:B.shouldBlockSubmitButtonClick,handleFirstUserInput:B.handleFirstUserInput,handleChatInputLoad:B.handleChatInputLoad,editorProps:B.editorProps,isSensitivityIndicatorLoading:B.isSensitivityIndicatorLoading,imageInputEnabled:B.imageInputEnabled,isHVCAppChatV2Enabled:B.enableHVCAppChatV2,hvcPromptStrings:B.hvcPromptStrings,hvcPromptStringsList:B.hvcPromptStringsList,chatInputBannerProps:t,onChatInputHVCPromptUpdated:B.onChatInputHVCPromptUpdated};return i},this.shouldBlockGroundingButtonClick=function(){return B.setPaneLoadMessageIfApplicable(Wv.GroundingButton)},this.shouldBlockSubmitButtonClick=function(){return B.setPaneLoadMessageIfApplicable(Wv.SubmitButton)},this.handleFirstUserInput=function(){Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.FirstUserInputReceived},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}])},this.handleChatInputLoad=function(){Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatInputLoaded},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}])},this.chatInputRef=e,this.copilotTheme=t,this.isDarkModeEnabled=n,this.dir=r,this.isExecuting=i,this.isSubmitButtonDisabled=a,this.handleSubmit=d,this.isFreVisible=s,this.setFreVisible=l,this.copilotCommunicationHandler=c,this.updateHintCard=p,this.chatPlaceHolderMessage=b,this.ciqPlaceholderText=f,this.ciqResponseHandler=v,this.loggingEventHandler=Fm.getInstance(),this.setPaneLoadMessageIfApplicable=x,this.menuBuilder=u?new Gy(u,e,d,g,s,l,this.copilotCommunicationHandler,h,this.chatPlaceHolderMessage,p,this.setPaneLoadMessageIfApplicable):void 0,this.chatEditor=g,this.setChatInputControlMounted=m,this.voiceInputProps=y,this.isCIQButtonEnabled=C,this.isGroundingButtonEnabled=O,this.groundingSourcePickerProps=S;var R=null!==(M=null===(L=null==E?void 0:E.plugins)||void 0===L?void 0:L.map((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{onToggle:function(t){yb("".concat(e.id,":").concat(t?"On":"Off")),e.onToggle&&e.onToggle(t)}})})))&&void 0!==M?M:[];this.groundingButtonPluginProps=Object(o.__assign)(Object(o.__assign)({},E),{plugins:R}),this.editorProps=I,this.isSensitivityIndicatorLoading=w,this.isVersion3Enabled=T,this.characterLimitErrorMessage=k,this.imageInputEnabled=j,this.enableHVCAppChatV2=null!=P&&P,this.hvcPromptStrings=A,this.hvcPromptStringsList=_,this.onChatInputHVCPromptUpdated=D},Qy=function(e,t,n,r,o,i,a,s,l,c,u,d){var p=this;this.handleClick=function(){},this.getProps=function(e){return{chatInputRestShyPlaceholder:p.chatPlaceHolderMessage,isDisabled:p.isDisabled,isMenuButtonEnabled:!0,handleMenuButtonClick:p.handleClick,menuProps:p.menuBuilder.getMenuProps(),handleClickAndUnMount:e}},this.isDisabled=t,this.handleSubmit=i,this.chatPlaceHolderMessage=d,this.transformFilePlaceholderText=c,this.copilotCommunicationHandler=u,this.menuBuilder=new Uy(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a)},qy=function(){function e(){}return e.prototype.getProps=function(e,t){return{headerText:t.headerText,descriptionText:t.descriptionText,freImagePath:t.freImagePath,handleFreButtonClick:function(){e()}}},e}(),Ky=function(){function e(e){var t;this.promptSuggestionHintCardMap=null!==(t=null==e?void 0:e.promptSuggestionHintCardMap)&&void 0!==t?t:{}}return e.prototype.shouldShowHintCard=function(e){return!!this.promptSuggestionHintCardMap[e]},e.prototype.getProps=function(e){var t={headerText:dv,descriptionText:dv};if(this.promptSuggestionHintCardMap[e]){var n=this.promptSuggestionHintCardMap[e].descriptionTextList;t.headerText=this.promptSuggestionHintCardMap[e].headerText,t.descriptionText=n[Math.floor(Math.random()*n.length)]}return t},e}(),Yy=function(){return[nv()?OfficeaicopilotStrings.WorkingOnItString:"Working on it...",nv()?OfficeaicopilotStrings.LoadingUIStringGettingReady:"Getting ready...",nv()?OfficeaicopilotStrings.LoadingUIStringFinishingUp:"Finishing up...",nv()?OfficeaicopilotStrings.LoadingUIStringWorkingOnRequest:"Working on your request...",nv()?OfficeaicopilotStrings.LoadingUIStringGatheringResources:"Gathering resources...",nv()?OfficeaicopilotStrings.LoadingUIStringCraftingContent:"Crafting your content...",nv()?OfficeaicopilotStrings.LoadingUIStringGettingEverythingReady:"Getting everything ready...",nv()?OfficeaicopilotStrings.LoadingUIStringFinishingTouches:"Applying the finishing touches..."]},Zy=function(){return[nv()?OfficeaicopilotStrings.LoadingUIStringLoadingConversation:"Loading conversation...",nv()?OfficeaicopilotStrings.LoadingUIStringCreateNewConversation:"Creating a new conversation..."]},Jy=function(){function e(){}return e.prototype.getProps=function(e,t){return{loadingUiStrings:e.loadingUiStringList,stringChangeIntervalDuration:e.stringChangeIntervalDuration,showStopButton:e.showStopGeneratingButton,showInlineStopButton:e.showInlineStopGeneratingButton,handleStopButtonOnClick:t}},e}(),Xy=function(){function e(e,t,n,r,o){var i=this;this.executeSuggestionPill=function(e){var t,n;null===(t=i.chatInputRef.current)||void 0===t||t.setInputText(dv),null===(n=i.chatInputRef.current)||void 0===n||n.setGhostText(i.chatPlaceHolderMessage),e in i.suggestedQnAsList?(i.setSuggestionClickChatCardsFromCacheSuggestion(e,i.suggestedQnAsList[e]),i.setCachedSuggestionPillList(i.getSuggestionPillListFromCache())):i.handleSubmit({text:e,telemetryData:sm.SuggestionPaneSuggestionClicked})},this.chatInputRef=e,this.handleSubmit=t,this.chatPlaceHolderMessage=n,this.setChatMessage=r,this.loggingEventHandler=Fm.getInstance(),this.suggestedQnAsList={},this.setCachedSuggestionPillList=o,this.telemetryLoggerUtils=Ym.getInstance()}return e.prototype.setSuggestedQnAList=function(e){var t=this;this.suggestedQnAsList={},e.forEach((function(e){t.suggestedQnAsList[e.question]=e.answer})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],Bm,Cm.ChatQnA,mm.QAandSummaries,vm.Ask,bm.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.getSuggestedQnAsList=function(){return Object.keys(this.suggestedQnAsList)},e.prototype.getSuggestionPillListFromCache=function(){var e=Object.keys(this.suggestedQnAsList);return e=function(e){for(var t,n,r=e.length;0!=r;)n=Math.floor(Math.random()*r),r--,t=Object(o.__read)([e[n],e[r]],2),e[r]=t[0],e[n]=t[1];return e}(e),e.slice(0,2)},e.prototype.setSuggestionClickChatCardsFromCacheSuggestion=function(e,t){var n,r=Object(fm.a)();this.telemetryLoggerUtils.setUserQueryGuid(r),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.SuggestionPaneSuggestionClicked}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QuerySubmittedByUser}]),this.setChatMessage(c.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),this.setChatMessage(c.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:oo.Footer,isFailure:!1,actionButtonList:[cy.getInstance().getCopyButton()],feedbackData:cy.getInstance().getFeedbackData(),clpSensitivityIndicatorData:null===(n=cy.getInstance().getBasicChatProps())||void 0===n?void 0:n.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:r,featureName:Cm.ChatQnA})}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CachedBasicChatResponseShown},{key:im.IsFromCache,value:!0}]),this.telemetryLoggerUtils.logTriedEvent([],Bm,Cm.ChatQnA,mm.QAandSummaries,void 0,vm.Ask,bm.BasicChat),this.telemetryLoggerUtils.setUserQueryGuid(dv)},e.prototype.getProps=function(e,t){var n=this,r={suggestionList:e.suggestionList.length>0?e.suggestionList:t,showRefreshButton:null==e?void 0:e.showRefreshButton,handleSuggestionPillClick:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.loggingEventHandler.sendLoggingEventToClient(Dm.SuggestionPillClicked,{suggestionClicked:e}),ny(dv),this.executeSuggestionPill(e),gy(e,"officeaicopilot-chat: onClickSuggestionPill"),[2]}))}))},handleRefreshButtonClick:function(){return Object(o.__awaiter)(n,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return Object.keys(this.suggestedQnAsList).length>0?(this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache()),this.telemetryLoggerUtils.logSeenEvent([],Bm,Cm.ChatQnA,mm.QAandSummaries,vm.Ask,bm.BasicChat)):null===(t=null==e?void 0:e.onRefreshButtonClicked)||void 0===t||t.call(e),gy("officeaicopilot-chat: onClickRefreshButton"),[2]}))}))}};return r},e}(),$y=Xy,eC=function(){function e(e,t,n,r,i,a,s){var l=this;this.getTransformFileSuggestionText=function(){var e,t;if(l.zqmProps)try{for(var n=Object(o.__values)(l.zqmProps.promptSuggestionList),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return dv},this.chatInputRef=e,this.handleSubmit=t,this.updateHintCard=n,this.isExecuting=r,this.chatEditor=i,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=a,this.setChatInputStateExpanded=s,this.telemetryLoggerUtils=Ym.getInstance()}return e.prototype.handleZQMButtonClick=function(e){var t,n,r;return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return this.isExecuting?[2]:(ny(dv),Fm.getInstance().sendLoggingEventToClient(Dm.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ZQMButtonClicked}]),i=e,a=dv,e.endsWith(gv)?[4,this.setChatInputStateExpanded()]:[3,2]);case 1:o.sent(),i=i.slice(0,-gv.length)+" ",o.label=2;case 2:return(null==(s=this.zqmProps.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:s.inputAreaText)&&(i=s.inputAreaText),(null==s?void 0:s.shouldSubmitQueryOnClick)?[4,this.handleSubmit({text:i,telemetryData:sm.ZQMButtonClicked})]:[3,4];case 3:return o.sent(),[2];case 4:return this.updateHintCard(e),e===this.transformFileSuggestionText&&(a=this.transformFilePlaceholderText),e===this.transformFileSuggestionText&&this.chatEditor&&this.chatEditor.setCurrentScope(wm.File),null===(t=this.chatInputRef.current)||void 0===t||t.setInputText(i),null===(n=this.chatInputRef.current)||void 0===n||n.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=l.chatInputRef.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1),null===(r=this.chatInputRef.current)||void 0===r||r.setGhostText(a),[2]}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{headerText:this.zqmProps.headerText,promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestion:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t}})),handleButtonClick:this.handleZQMButtonClick}},e}(),tC=function(){function e(){}return e.prototype.getTrySydneyProps=function(e,t,n){return{checked:e.trySydneyToggleChecked,disabled:t,onChange:e.trySydneyToggleOnChange,label:n}},e.prototype.getTryEnterpriseSearchProps=function(e,t,n){return{checked:e.tryEnterpriseSearchToggleChecked,disabled:t,onChange:e.tryEnterpriseSearchToggleOnChange,label:n}},e.prototype.getTryWebChatProps=function(e,t,n){return{checked:e,onChange:t,label:n,disabled:!1}},e.prototype.getTryReviewerAgentProps=function(e,t,n){return{checked:e.tryReviewerAgentToggleChecked,disabled:t,onChange:e.tryReviewerAgentToggleOnChange,label:n}},e}(),nC=function(e,t,n,r,i,a,s,l,c){var u=this;this.isExecuting=!1,this.addResponseMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0===o||o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");u.chatContainerbuilder.setChatMessageData(t,n,r,p,u.getIsExecuting),s&&uy.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.updateLastMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;u.chatContainerbuilder.updateLastMessage(t,n,r,p),s&&uy.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.resendChatHistorySignal=function(e,t){!function(e,t){if(Ob){gy("resendCopilotMessage got key ".concat(e,", and found a message with key ").concat(Sb));var n=t(Ob);n&&Vb(um.c.AddMessageOperation,n)}}(e,t)},this.updateMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;(null==r?void 0:r.messageId)?(u.chatContainerbuilder.updateMessage(t,n,r,p),s&&uy.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)):(gy("updateMessage: messageId is missing in chatMessageBodyData"),u.addResponseMessage({chatCardType:t,chatMessageData:n,chatMessageBodyData:r,stopLoadingUi:i,startAugloopTimerForStreaming:s,workflowAnnotationTypeForAugloopTimer:c,addCardToChatHistory:p}))},this.deleteMessage=function(e){var t=e.chatCardType,n=e.messageIdToDelete;u.chatContainerbuilder.deleteMessage(t,n)},this.submitOperation=function(e){var t=e.operation,n=e.workflowAnnotationType;return tb.getInstance().isWorkflowRegistered(n)&&tb.getInstance().isAugloopResponseTimeoutRequired(n)&&uy.getInstance().setAugloopResponseTimer(n),gy("operation submitted",t),Ay.getInstance().submitOperation(t,n),!0},this.updateLoadingComponentProps=function(e){u.setLoadingComponentProps((function(t){return Object(o.__assign)(Object(o.__assign)({},t),e)}))},this.addChatMessages=function(e,t){void 0===t&&(t=!0),u.chatContainerbuilder.addChatMessages(e),t&&u.setIsExecuting(!1)},this.getLastMessage=function(e){return u.chatContainerbuilder.getLastMessage(e)},this.clearMessages=function(){u.chatContainerbuilder.clearMessages()},this.startLoadingUi=function(){u.setIsExecuting(!0)},this.startReinitializeALSession=function(){u.setShouldReinitializeALSession(!0)},this.getInputText=function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.getInputText()},this.setInputAreaText=function(e){var t,n,r;gy("setInputAreaText",e);var o=e,i=Sy(e),a=i.inputSpanText,s=i.isFileEntityPresent;o=a,gy("inputSpanText: ".concat(a,", isFileEntityPresent:"),s);var l=dv;a.endsWith(gv)&&(o=a.slice(0,-gv.length)+" "),s&&(l=u.ciqPlaceholderText?u.ciqPlaceholderText:Kv()),null===(t=u.chatInputRef.current)||void 0===t||t.setInputText(o),null===(n=u.chatInputRef.current)||void 0===n||n.setFocus(),s&&u.getChatEditor()&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1),null===(r=u.chatInputRef.current)||void 0===r||r.setGhostText(l)},this.submitUserQuery=function(e){var t=e.text,n=e.links,r=e.telemetryData,o=e.queryAnnotations;gy("submitUserQuery called for query: ",t),u.isExecuting||u.isDisabled?gy("Returning from submitting Query because isExecuting is: ".concat(u.isExecuting," and isDisabled is: ").concat(u.isDisabled)):u.handleSubmit({text:t,links:n,telemetryData:r,queryAnnotations:o})},this.setInputFocus=function(){var e;gy("setInputFocus"),u.isDisabled||null===(e=u.chatInputRef.current)||void 0===e||e.setFocus()},this.setIsDisabled=function(e){gy("setIsDisabled",e),u.isDisabled=e},this.setLocalIsExecuting=function(e){u.isExecuting=e},this.getIsExecuting=function(){return u.isExecuting},this.setIsExecuting=e,this.chatContainerbuilder=r,this.handleSubmit=n,this.setLoadingComponentProps=t,this.chatInputRef=i,this.getChatEditor=a,this.isDisabled=c,this.setShouldReinitializeALSession=s,this.ciqPlaceholderText=l},rC=Object(S.a)(Ny),oC={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:rC.themeBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:rC.themeBackground},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:rC.colorNeutralStroke1Selected},De.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:rC.colorNeutralForeground3},De.a.borderRadius("20px")),De.a.border("2px","solid",rC.colorNeutralBackground2Hover)),{":hover":{backgroundColor:rC.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:rC.colorNeutralBackground2Hover},De.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:rC.colorNeutralStroke1Selected},De.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:rC.colorNeutralForeground3},De.a.borderRadius("20px")),De.a.border("2px","solid",rC.colorNeutralBackground2Hover)),{":hover":{backgroundColor:rC.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:rC.colorNeutralBackground2Hover},De.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:rC.themeBackground},incomingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},De.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),De.a.margin("10px")),outgoingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},De.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),De.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),De.a.border("1px","solid","rgba(230, 230, 230, 1)")),De.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",backgroundColor:rC.colorNeutralBackground1,opacity:"0.6"}),outgoingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),De.a.border("1px","solid","rgba(230, 230, 230, 1)")),De.a.margin(0,"16px")),{height:"124px",backgroundColor:rC.colorNeutralBackground1,opacity:"0.8"})},iC={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:Le.a.colorNeutralBackground1},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:Le.a.colorNeutralBackground1},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralStroke1Selected},De.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralForeground3},De.a.borderRadius("20px")),De.a.border("2px","solid",Le.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Le.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground2Hover},De.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralStroke1Selected},De.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Le.a.colorNeutralForeground3},De.a.borderRadius("20px")),De.a.border("2px","solid",Le.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Le.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:Le.a.colorNeutralBackground2Hover},De.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:Le.a.colorNeutralBackground1},incomingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},De.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),De.a.margin("10px")),outgoingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},De.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),De.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),De.a.border("1px","solid","rgba(230, 230, 230, 1)")),De.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Le.a.colorNeutralBackground1}),outgoingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},De.a.borderRadius("8px")),De.a.border("1px","solid","rgba(230, 230, 230, 1)")),De.a.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:Le.a.colorNeutralBackground1})},aC=Object(ue.a)(oC),sC=Object(ue.a)(iC),lC=function(e,t){if(t)for(var n in e)e[n]=Object(E.a)(e[n],t[n]);return e},cC=0,uC=function(){function e(e,t,n,r,i,a,s,l,c,u,d,p,g){var h=this;this.onTryAgainClicked=function(){cC=(new Date).getTime(),zp(h.isMicrophoneListening,bv,h.setShouldShowMicrophonePermissionRetryDialog,h.setMicrophoneState,h.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(o.__awaiter)(h,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u,d,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(t=Ym.getInstance(),this.setPaneLoadMessageIfApplicable(Wv.Microphone))return[2];null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),this.isMicrophoneListening?(t.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophonePauseClicked}]),(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=dv&&(null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())!=this.chatPlaceHolderMessage&&(null===(l=null===(s=this.chatInputRef.current)||void 0===s?void 0:s.getGhostText())||void 0===l?void 0:l.trim())!=qv()&&(null===(c=this.chatInputRef.current)||void 0===c||c.setInputText((null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getInputText())+(null===(d=this.chatInputRef.current)||void 0===d?void 0:d.getGhostText())),null===(p=this.chatInputRef.current)||void 0===p||p.setGhostText("")),[4,Vp(this.setMicrophoneListeningStatus)]):[3,3];case 2:return o.sent(),gy("Microphone Paused"),[3,6];case 3:return t.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophonePlayClicked}]),this.microphoneState===Kc.Uninitialized&&this.setMicrophoneState(Kc.Loading),cC=(new Date).getTime(),[4,Lp.GetInstance().Resume()];case 4:return o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(Kc.Enabled),[4,Gp(bv,this.setMicrophoneListeningStatus)];case 5:o.sent(),gy("Microphone Resumed"),o.label=6;case 6:return[3,10];case 7:return n=o.sent(),r="Error occurred while fetching mic permissions - : ".concat(n),gy(r),null==pS||pS.logError({eventType:rm.Microphone,errorMessage:r}),"ErrorAudioPermissionDeniedError"!=n?[3,9]:[4,Lp.GetInstance().Pause()];case 8:o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),t.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophonePermissionDenied}]),o.label=9;case 9:return this.setMicrophoneState(Kc.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=r,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p,this.setPaneLoadMessageIfApplicable=g}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}(),dC=function(e,t,n,r){var o,i,a,l,u,d,p,g=null==e?void 0:e.body,h=null==g?void 0:g.answer,f=null==g?void 0:g.error,m=null==g?void 0:g.aiResponse,v=null==g?void 0:g.status,b=null==g?void 0:g.isBasicChat,y=null==g?void 0:g.queryId,C=null==g?void 0:g.citation,O=Ym.getInstance(),S=Zm(null==g?void 0:g.featureType);if(cy.getInstance().setFeatureName(S),O.setUserQueryGuid(y),cy.getInstance().setQueryID(y),cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Started,workflowAnnotationType:gm.a.getTypeName(),queryID:y,responseTime:SS(r)}),O.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:gm.a.getTypeName()},{key:im.UserQueryGuid,value:y}]),O.logTriedEvent([{key:Mm,value:y}],Bm,S,Jm(S),void 0,Xm(S),$m(S)),O.sendTelemetryLatencyData([{key:om.FeatureName,value:S}]),cy.getInstance().sendLoggingEventToClient(Dm.AugloopResponseReceived,{annotationName:gm.a.getTypeName(),timeInMs:SS(r)}),tb.getInstance().isAugloopResponseTimeoutRequired(null===(o=null==g?void 0:g.H_)||void 0===o?void 0:o.T_)&&uy.getInstance().clearAugloopResponseTimer(),!tv(f)&&!tv(null==f?void 0:f.category))return xy(f,v,t,n,gm.a.getTypeName()),O.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(r)},{key:om.QnAResponseTime,value:OS(r)},{key:om.IsQuerySuccess,value:!1},{key:om.UserQueryGuid,value:y}],!0),cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Finished,workflowAnnotationType:gm.a.getTypeName(),queryID:y,isSuccess:!1,responseTime:SS(r)}),cy.getInstance().setQueryID(dv),O.setUserQueryGuid(dv),cy.getInstance().setFeatureName(Cm.ChatQnA),void(cy.getInstance().getIsFluxFlowEnabled()||(gy("Stopping loading UI"),n(!1)));var E={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:oo.Footer,showAnimation:!0,feedbackData:cy.getInstance().getFeedbackData(),isFailure:!1,actionButtonList:[{type:Ko.Default,title:yv(),text:s()?"":yv(),iconRegular:s()?ct.e:ct.c,iconHover:s()?ct.d:ct.b,position:s()?Yo.FeedbackSection:Yo.ActionButtonBar,popoverProps:{popoverTitle:Ov()},handleButtonOnClick:rv}],references:C&&C.length>0&&(null===(i=cy.getInstance().getBasicChatProps())||void 0===i?void 0:i.isCitationsEnabled)?cy.getInstance().getMarkdownReferences(C):void 0,clpSensitivityIndicatorData:null!==(l=null===(a=cy.getInstance().getBasicChatProps())||void 0===a?void 0:a.sensitivityIndicatorData)&&void 0!==l?l:void 0,telemetryData:JSON.stringify({correlationId:y,featureName:S})},x=b?c.MarkdownCard:c.Default,I=b?{markDownCardProps:{user:"chat",message:h}}:{defaultMessageProps:{user:"chat",messageHeader:{text:h}}};t.setChatMessageData(x,I,E),m&&"suggestions"===(null==m?void 0:m.type)&&(null===(d=null===(u=null==m?void 0:m.value)||void 0===u?void 0:u.suggestions)||void 0===d?void 0:d.length)>0&&cy.getInstance().sendBasicChatSuggestionPillsEvent(null===(p=null==m?void 0:m.value)||void 0===p?void 0:p.suggestions),cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Finished,workflowAnnotationType:gm.a.getTypeName(),queryID:y,isSuccess:!0,responseTime:SS(r)}),O.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(r)},{key:om.QnAResponseTime,value:OS(r)},{key:om.IsQuerySuccess,value:!0},{key:om.UserQueryGuid,value:y}],!0),cy.getInstance().setQueryID(dv),O.setUserQueryGuid(dv),cy.getInstance().setFeatureName(Cm.ChatQnA),cy.getInstance().getIsFluxFlowEnabled()||(gy("Stopping loading UI"),n(!1))},pC=function(e,t,n,r){var o,i,a,s,l=null==e?void 0:e.body,u=null==l?void 0:l.answer,d=null==l?void 0:l.error,p=null==l?void 0:l.aiResponse,g=null==l?void 0:l.status,h=null==l?void 0:l.citations,f=null==l?void 0:l.isStreaming,m=null==l?void 0:l.isAnswerCompleted,v=null==l?void 0:l.queryId,b=Ym.getInstance(),y=Zm(null==l?void 0:l.featureType);if(gy("Getting isStreaming boolean as : ".concat(f," and isAnswerCompleted as : ").concat(m," and answer as : ").concat(u," and featureType as : ").concat(y)),cy.getInstance().setFeatureName(y),b.setUserQueryGuid(v),cy.getInstance().setQueryID(v),cy.getInstance().getIsFirstStreamChunk()&&(cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Started,workflowAnnotationType:gm.b.getTypeName(),queryID:v,responseTime:SS(r)}),b.logTriedEvent([{key:Mm,value:v}],Bm,y,Jm(y),void 0,Xm(y),$m(y)),b.sendTelemetryLatencyData([{key:om.FeatureName,value:y}])),b.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:gm.b.getTypeName()},{key:im.UserQueryGuid,value:v},{key:im.IsStreamingResponse,value:f.toString()}]),cy.getInstance().sendLoggingEventToClient(Dm.AugloopResponseReceived,{annotationName:gm.b.getTypeName(),timeInMs:SS(r)}),uy.getInstance().clearAugloopResponseTimer(),!tv(d)&&!tv(null==d?void 0:d.category))return cy.getInstance().getIsFirstStreamChunk()||cy.getInstance().updateCardWithFooter(),xy(d,g,t,n,gm.b.getTypeName()),cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Finished,workflowAnnotationType:gm.b.getTypeName(),queryID:v,isSuccess:!1,responseTime:SS(r)}),b.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(r)}]),void cy.getInstance().resetBasicChatStreamingStates(!1,!cy.getInstance().getIsFluxFlowEnabled());f?(cy.getInstance().setIsBasicChatStreaming(!0),gC(u,m,t,b)):cy.getInstance().resetBasicChatStreamingStates(!0,!cy.getInstance().getIsFluxFlowEnabled()),h&&h.length>0&&cy.getInstance().getBasicChatProps().isCitationsEnabled&&(b.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CitationReceived},{key:im.ChatEventParameters,value:h.length.toString()},{key:im.UserQueryGuid,value:v}]),t.updateLastMessage(c.MarkdownCard,void 0,{references:cy.getInstance().getMarkdownReferences(h)},!1)),p&&"suggestions"===(null==p?void 0:p.type)&&(null===(i=null===(o=null==p?void 0:p.value)||void 0===o?void 0:o.suggestions)||void 0===i?void 0:i.length)>0&&cy.getInstance().sendBasicChatSuggestionPillsEvent(null===(a=null==p?void 0:p.value)||void 0===a?void 0:a.suggestions),f?uy.getInstance().setAugloopResponseTimer(null===(s=null==l?void 0:l.H_)||void 0===s?void 0:s.T_):(cy.getInstance().sendBasicChatProcessingEvent({status:Lm.Finished,workflowAnnotationType:gm.b.getTypeName(),queryID:v,isSuccess:!0,responseTime:SS(r)}),cy.getInstance().getIsFluxFlowEnabled()||(gy("Streaming finished. Stopping loading UI"),n(!1)))},gC=function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,u;return Object(o.__generator)(this,(function(o){return cy.getInstance().getIsFirstStreamChunk()&&""===e?(r.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.EmptyBasicChatResponse},{key:im.UserQueryGuid,value:cy.getInstance().getQueryID()}]),[2]):(i=(i=e).replace("\\n","\n").replace("\\t","\t"),a=cy.getInstance().getParagraphChunks(),a+=i,cy.getInstance().setParagraphChunks(a),s={shouldShowAIGeneratedIndicator:!0,showAnimation:!1,feedbackData:cy.getInstance().getFeedbackData(),isFailure:!1,clpSensitivityIndicatorData:null!==(u=null===(l=cy.getInstance().getBasicChatProps())||void 0===l?void 0:l.sensitivityIndicatorData)&&void 0!==u?u:void 0,telemetryData:JSON.stringify({correlationId:cy.getInstance().getQueryID(),featureName:cy.getInstance().getFeatureName()})},cy.getInstance().updateStreamChunks({augloopResponseTime:OS(hS)}),cy.getInstance().getIsFirstStreamChunk()?(n.setChatMessageData(c.MarkdownCard,{markDownCardProps:{user:"chat",message:i}},s,!1),cy.getInstance().setIsFirstStreamChunk(!1),r.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(hS)}])):n.updateLastMessage(c.MarkdownCard,{markDownCardProps:{user:"chat",message:a}},void 0,!1),t&&cy.getInstance().updateCardWithFooter(),[2])}))}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Vy||(Vy={}));var hC=function(e,t){var n=null==e?void 0:e.body,r=n.suggestedQnAs,o=n.error,i=n.queryId,a=Ym.getInstance(),s=cy.getInstance().getSuggestedQnaSignalSubmitTime();if(gy("received suggestedQnaList",r),a.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:gm.c.getTypeName()},{key:im.UserQueryGuid,value:i}]),a.sendTelemetryLatencyData([{key:om.SuggestedQnAResponseTime,value:OS(s)},{key:im.UserQueryGuid,value:i}]),cy.getInstance().sendLoggingEventToClient(Dm.AugloopResponseReceived,{annotationName:gm.c.getTypeName(),timeInMs:SS(s)}),!tv(o)&&!tv(null==o?void 0:o.category)){var l="",c=gm.c.getTypeName();if(!tv(o.errorDetailsJson))try{l=JSON.parse(o.errorDetailsJson).code}catch(e){gy("Error parsing error code from basic chat error",e.message)}return gy("Received error from DynamicQuestionGeneratorSuggestedQnAAnnotation Workflow"),cy.getInstance().sendLoggingEventToClient(Dm.AugloopErrorReceived,{annotationName:c,timeInMs:SS(s),chatEventParams:JSON.stringify({errorCategory:o.category,errorCode:l})}),void a.sendTelemetryChatEventData([{key:im.ChatEventType,value:"".concat(c,"_Error")},{key:im.ChatEventParameters,value:"".concat(o.category,"_").concat(l)},{key:im.ChatErrorType,value:ym.Server},{key:im.UserQueryGuid,value:i}])}r&&t.setSuggestedQnAList(r)},fC=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n){return{conversationId:t,getLogs:e,telemetryData:n}},e}(),mC=n(2078),vC=function(e,t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n,r,i,a,s,l;return Object(o.__generator)(this,(function(o){return n=null===(l=null===(s=e.body)||void 0===s?void 0:s.H_)||void 0===l?void 0:l.T_,r=null==e?void 0:e.body,i=r.success,a=r.sensitivityLabel,Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ResponseReceivedFromAL},{key:im.ChatEventParameters,value:"".concat(n)}]),gy("received sensitivity label",a),t(i&&a?a:void 0),[2]}))}))},bC=function(){this.getProps=function(e){return{handleChangeTopicButtonClick:e}}},yC=function(e){var t=e.children,n=Object(o.__rest)(e,["children"]);return n.shouldUseV9Tokens?le.a.createElement(ae.a,{theme:n.theme,dir:n.dir},t):(console.log("Test app is using Custom tokens to render Theme"),le.a.createElement(le.a.Fragment,null,t))},CC=function(e){if(!e.shouldUseFluentV9Tokens)return gy("Fluent V8 Custom Tokens enabled"),le.a.createElement(ce,{theme:e.theme,dir:e.dir},e.children);if(e.shouldUseFluentV9Tokens&&e.theme)return gy("Fluent V9 supported tokens enabled"),le.a.createElement(yC,Object(o.__assign)({},OC(e.theme,e.dir)),e.children);throw new Error("Exception: Please ensure a compatible V9 Theme is passed to the ThemeProvider")},OC=function(e,t){return void 0===t&&(t=void 0),{shouldUseV9Tokens:!0,theme:e,dir:t}},SC=n(3598),EC=n(3368),xC=function(e){var t=e.className,n=aC();return se.createElement(pe,{style:t},se.createElement(SC.a,null,se.createElement("div",{className:n.incomingShimmerCardWrapper},se.createElement("div",{className:n.incomingShimmerCard},se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}))),se.createElement("div",{className:n.outgoingShimmerCardWrapper},se.createElement("div",{className:n.outgoingShimmerCard},se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv}),se.createElement(EC.a,{size:Lv})))))},IC=n(952),wC=n(506);const TC=800,kC=600;var jC,PC,AC,_C,DC,LC,MC,BC,RC,FC,NC,HC=n(951);class UC extends HC.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class VC extends UC{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class zC{constructor(e,t,n,r,o){this.userContext=e,this.hostContext=t,this.tokenService=n,this.telemetryService=r,this.hostWindow=o}authenticate(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var r,i;const a={user:this.userContext,app:this.hostContext,page:{id:(null===(r=e.appDefinition)||void 0===r?void 0:r.id)||"",frameContext:x.a.authentication}},s=e=>(r,o)=>e?(t({code:r}),Promise.resolve()):(n(r),Promise.resolve()),l=new VC(s(!0),s(!1),this.tokenService,this.userContext);(function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((o,a)=>{var s;const l=Object(IC.a)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(s=t.appDefinition.version)&&void 0!==s?s:"",appId:t.appDefinition.id})),c={url:t.signInUrl,width:TC,height:kC,left:e.screen.availWidth/2-TC/2,top:e.screen.availHeight/2-kC/2};new wC.b(e,c,l,n,r,i)?o(void 0):a("Unable to initialize auth extension")}))}))})(null!==(i=this.hostWindow)&&void 0!==i?i:window,e,l,a,this.telemetryService).catch((e=>{}))}))}))}getToken(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.tokenService.getToken(e)}))}}!function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed",e[e.MorePluginsClickHostHandled=9]="MorePluginsClickHostHandled",e[e.ManagePluginsClickFailed=10]="ManagePluginsClickFailed",e[e.ManagePluginsClickHostHandled=11]="ManagePluginsClickHostHandled",e[e.GetCopilotPluginsIdsFailed=12]="GetCopilotPluginsIdsFailed",e[e.StoreFrontPluginsFetchFailed=13]="StoreFrontPluginsFetchFailed",e[e.StoreFrontCopilotPluginPermissionsClickHostHandled=14]="StoreFrontCopilotPluginPermissionsClickHostHandled",e[e.StoreFrontCopilotPluginPermissionsClickFailed=15]="StoreFrontCopilotPluginPermissionsClickFailed",e[e.StoreFrontCopilotPluginItemInstallSucceeded=16]="StoreFrontCopilotPluginItemInstallSucceeded",e[e.StoreFrontCopilotPluginItemInstallFailed=17]="StoreFrontCopilotPluginItemInstallFailed"}(jC||(jC={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(PC||(PC={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI",e[e.CopilotPluginStoreFrontUI=4]="CopilotPluginStoreFrontUI"}(AC||(AC={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePlugins=10]="ManagePlugins",e[e.StoreFrontCopilotPluginPermissions=11]="StoreFrontCopilotPluginPermissions",e[e.StoreFrontCopilotPluginIds=12]="StoreFrontCopilotPluginIds",e[e.StoreFrontCopilotPlugins=13]="StoreFrontCopilotPlugins",e[e.GetStoreFrontPluginsState=14]="GetStoreFrontPluginsState",e[e.InstallStoreFrontCopilotPlugin=15]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginItem=16]="StoreFrontCopilotPluginItem"}(_C||(_C={})),function(e){e[e.getHeader=0]="getHeader",e[e.getPlugins=2]="getPlugins",e[e.getAppDefinition=3]="getAppDefinition",e[e.getBotInvokeRequest=4]="getBotInvokeRequest",e[e.handleAuthLinkClick=5]="handleAuthLinkClick",e[e.onToggle=6]="onToggle",e[e.nextButtonClick=7]="nextButtonClick",e[e.gotItButtonClick=8]="gotItButtonClick",e[e.getStoreFrontPlugins=9]="getStoreFrontPlugins"}(DC||(DC={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.getInstalledPlugins=4]="getInstalledPlugins",e[e.getSelectedPlugins=5]="getSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePluginsClick=10]="ManagePluginsClick",e[e.GetStoreFrontCopilotPluginIds=11]="GetStoreFrontCopilotPluginIds",e[e.GetStoreFrontCopilotPlugins=12]="GetStoreFrontCopilotPlugins",e[e.GetStoreFrontPlugins=13]="GetStoreFrontPlugins",e[e.InstallStoreFrontCopilotPlugin=14]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginPermissionClick=15]="StoreFrontCopilotPluginPermissionClick",e[e.StoreFrontCopilotPluginItemClick=16]="StoreFrontCopilotPluginItemClick"}(LC||(LC={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(MC||(MC={})),function(e){e.IsCached="IsCached",e.FetchByNetwork="FetchByNetwork",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.isAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount",e.IsStoreFrontCopilotPluginIdsAvailable="IsStoreFrontCopilotPluginIdsAvailable",e.IsStoreFrontPluginInstallSuccess="IsStoreFrontCopilotPluginInstallationSuccess",e.IsStoreFrontCopilotPluginsAvailable="IsStoreFrontCopilotPluginsAvailable",e.TotalStoreFrontPluginsCount="TotalStoreFrontPluginsCount"}(BC||(BC={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(RC||(RC={})),function(e){e[e.Auth=0]="Auth",e[e.Config=1]="Config",e[e.SilentAuth=2]="SilentAuth",e[e.BotInvokeForAuthCheck=3]="BotInvokeForAuthCheck",e[e.Unknown=4]="Unknown"}(FC||(FC={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(NC||(NC={}));var GC=n(2152);class WC{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:PC.LogMetric,tag:this.tag,name:this.name,success:MC.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:PC.LogMetric,tag:this.tag,name:this.name,success:MC.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:PC.LogMetric,tag:this.tag,name:this.name,success:MC.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}class QC{constructor(e,t,n){this.dataProvider=e,this.addPlugin=t,this.removePlugin=n}onToggle(e){var t,n;return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.plugin.isEnabled=e,e?null===(t=this.addPlugin)||void 0===t||t.call(this,this.plugin,!0):null===(n=this.removePlugin)||void 0===n||n.call(this,this.plugin,!0),yield this.dataProvider.setPlugin(this.plugin)}))}}class qC extends QC{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class KC extends QC{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class YC extends QC{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}var ZC=n(2217),JC=n(1555),XC=n(1477),$C="InteractionRequiredAuthErrorFromMSAL",eO=n(2681),tO=n(2680);let nO=0;class rO extends QC{constructor(e,t,n,r,o,i,a,s){var l;super(t,o,i),this.plugin=e,this.dataProvider=t,this.authActivityProvider=n,this.appService=r,this.addPlugin=o,this.removePlugin=i,this.telemetryService=a,this.correlationVector=s,this.pluginInfoForLogging="",this.authActivityProvider&&(this.authRuntime=new ZC.a(this.authActivityProvider)),e.isEnabled&&(null===(l=this.addPlugin)||void 0===l||l.call(this,e)),this.pluginInfoForLogging=function(e){var t,n;return null!==(n=null===(t=e.titleId)||void 0===t?void 0:t.startsWith("P_"))&&void 0!==n&&n}(e)?`, PluginId: ${this.plugin.id}, PluginName: ${this.plugin.name}, PluginSource: ${this.plugin.source}`:e.titleId?", LOB Plugin":", TitleId not found"}handleAuthLinkClick(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=this.plugin.authRequest)||void 0===t?void 0:t.type;try{"silentAuth"!==n&&nO++;const t=yield this.executeAuthRequest(!1);this.updatePluginStatus(t,e)}catch(e){}"silentAuth"!==n&&nO>0&&nO--}))}onToggle(e,t){var n,r;return Object(o.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)return void this.toggleAndUpdatePluginStatus("processed",e,t);if(!this.authRuntime||!this.plugin.metaOSAppId){const r=this.authRuntime?"metaOSAppId is undefined":"AuthRuntime is undefined";return null===(n=this.telemetryService)||void 0===n||n.LogError({type:PC.LogError,tag:AC.MsgExtViewModel,name:DC.onToggle,message:jC.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${r}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),void this.toggleAndUpdatePluginStatus("processed",e,t)}this.updatePluginStatus("processing",t),this.plugin.authRequest=yield this.getAuthRuntimeRequest();const r=yield this.executeAuthRequest(!0);if("pendingAuth"===r&&0===nO)return this.toggleAndUpdatePluginStatus(r,e,t),void(yield this.handleAuthLinkClick(t));this.toggleAndUpdatePluginStatus(r,e,t)}catch(n){null===(r=this.telemetryService)||void 0===r||r.LogError({type:PC.LogError,tag:AC.MsgExtViewModel,name:DC.onToggle,message:jC.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${(null==n?void 0:n.message)||n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),this.toggleAndUpdatePluginStatus("processed",e,t)}}))}executeAuthRequest(e){var t,n,r,i;return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.plugin.authRequest){const o=new WC(_C.AuthActivity,LC.AuthActivity,this.telemetryService),a={};try{switch(this.plugin.authRequest.type){case"botInvoke":a[BC.TypeOfAuthFlow]=FC.BotInvokeForAuthCheck;break;case"silentAuth":a[BC.TypeOfAuthFlow]=FC.SilentAuth;break;case"auth":a[BC.TypeOfAuthFlow]=FC.Auth;break;case"config":a[BC.TypeOfAuthFlow]=FC.Config}a[BC.isAuthFlowAutomatic]=e?1:0;const s=yield null===(t=this.authRuntime)||void 0===t?void 0:t.execute(this.plugin.authRequest);if(s)return o.logMetricEnd({props:a,message:jC.None,diagnosticsData:`Auth request executed successfully${this.pluginInfoForLogging}`},this.correlationVector),this.plugin.authRequest=Object(JC.b)(this.plugin.authRequest,s),"auth"===(null===(n=this.plugin.authRequest)||void 0===n?void 0:n.type)||"config"===(null===(r=this.plugin.authRequest)||void 0===r?void 0:r.type)||"silentAuth"===(null===(i=this.plugin.authRequest)||void 0===i?void 0:i.type)?"pendingAuth":"processed";o.logMetricEndWithError({props:a,message:jC.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: AuthSDK execute returned undefined response${this.pluginInfoForLogging}`},this.correlationVector)}catch(e){if(o.logMetricEndWithError({props:a,message:jC.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: ${null==e?void 0:e.message}${this.pluginInfoForLogging}`},this.correlationVector),(null==e?void 0:e.message)===$C){const e=this.plugin.authRequest;return e&&(e.isSilent=!0,this.plugin.authRequest=e),"pendingAuth"}return Promise.reject(`Could not execute auth request as ${e.message||e}`)}}return Promise.reject("Could not execute auth request as auth request is not available")}))}getAuthRuntimeRequest(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(!this.appService||!this.plugin.metaOSAppId)return Promise.reject("AppId or serviceProvider is undefined");const e=yield this.getAppDefinition(this.appService,this.plugin.metaOSAppId);if(!e)return Promise.reject("Could not find app definition");if(!Object(eO.a)(e))return Promise.reject("Could not find command with initial run enabled");const t=this.getBotInvokeRequest(e);if(!t)return Promise.reject("Could not find bot invoke request");const n=Object.assign(Object.assign({type:"botInvoke"},t),{onActivityCompletion:this.getOnAuthActivityCompletion(this.plugin)});return Promise.resolve(n)}))}getOnAuthActivityCompletion(e){return t=>{if("object"==typeof t){if(e.authRequest){const n=Object(XC.b)(t);if("auth"===n||"config"===n)return e.authRequest=Object(JC.b)(e.authRequest,t),e.status="pendingAuth",Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)}}onInstall(){throw new Error("Method not implemented.")}getAppDefinition(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getApp({id:t});if(!n||!n.appDefinition&&!n.titleInfo)return;let r;return(null==n?void 0:n.appDefinition)?r=n.appDefinition:(null==n?void 0:n.titleInfo)&&(r=Object(tO.a)(n.titleInfo)),r}))}getBotInvokeRequest(e){var t,n,r,o,i,a,s,l;const c=null!==(r=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)&&void 0!==r?r:null===(i=null===(o=e.inputExtensions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.botId,u=this.plugin.metaOSAppId,d=null===(l=null===(s=null===(a=e.inputExtensions)||void 0===a?void 0:a[0].commands)||void 0===s?void 0:s[0])||void 0===l?void 0:l.id;if(!c||!u||!d){throw new Error(`Could not construct bot invoke request. ErrorMessage: ${c?u?"CommandId is undefined":"AppId is undefined":"BotId is undefined"}`)}return{appId:u,botId:c,requestBody:{name:"composeExtension/query",appName:e.name,value:{commandId:d,parameters:[{name:"initialRun",value:"true"}],queryOptions:{skip:0,count:25}}}}}toggleAndUpdatePluginStatus(e,t,n){const r=Object.create(null,{onToggle:{get:()=>super.onToggle}});return Object(o.__awaiter)(this,void 0,void 0,(function*(){yield r.onToggle.call(this,t),this.updatePluginStatus(e,n)}))}updatePluginStatus(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.plugin.status=e,null==t||t()}))}}class oO extends QC{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class iO{constructor(e,t){this.dataProvider=e,this.plugin=t}onInstall(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.dataProvider.installStoreFrontPlugin(this.plugin)}))}}class aO{constructor(e,t,n,r,o,i){this.dataProvider=e,this.authActivityProvider=t,this.addPlugin=n,this.removePlugin=r,this.telemetryService=o,this.appService=i,this.supportedPluginTypes=["MsgExt","FirstParty","PowerPlatform","DataVerse","Undefined"]}getPlugins(e,t,n,r){var i;return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(n)return this.getPluginsGrouped(e,t,r);const o=new WC(_C.GetPluginsState,LC.GetPlugins,this.telemetryService),a={};try{const n=this.getSupportedPluginTypes(e),r=yield null===(i=this.dataProvider)||void 0===i?void 0:i.getPlugins(t);let s=0,l=0,c=0,u=0,d=0,p=0;const g=null==r?void 0:r.reduce(((e,r)=>{var o;if(r.type&&n.includes(r.type))switch(r.isEnabled?s++:l++,(null===(o=r.titleId)||void 0===o?void 0:o.startsWith("P_"))&&(c++,r.isEnabled&&u++),r.type){case"MsgExt":d++,r.isEnabled&&p++,e.push(new rO(r,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new KC(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new oO(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new qC(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new YC(this.dataProvider,r,this.addPlugin,this.removePlugin))}return e}),[]);return a[BC.TotalPluginCount]=g.length,a[BC.TotalISVPluginCount]=c,a[BC.SelectedPluginCount]=s,a[BC.UnselectedPluginCount]=l,a[BC.UnsupportedPluginCount]=r.length-g.length,a[BC.SelectedISVPluginCount]=u,a[BC.TotalMEPluginCount]=d,a[BC.SelectedMEPluginCount]=p,o.logMetricEnd({props:a},t),g}catch(e){o.logMetricEndWithError({props:a,message:jC.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getPluginsGrouped(e,t,n){var r,i,a,s,l;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const c=new WC(_C.GetPluginsState,LC.GetPlugins,this.telemetryService),u={};try{const h=this.getSupportedPluginTypes(e),f=[],m=yield null===(l=this.dataProvider)||void 0===l?void 0:l.getPluginsGrouped(t,n);let v=0,b=0,y=0,C=0,O=0,S=0,E=0;try{for(var d,p=!0,g=Object(o.__asyncValues)(m);d=yield g.next(),!(r=d.done);p=!0){s=d.value,p=!1;const e=s,n=e.groupHeaderPlugin;if(n.type&&h.includes(n.type)){let r=0,o=0,i=0,a=0,s=0,l=0;const c=new KC(this.dataProvider,n,this.addPlugin,this.removePlugin),u=e.plugins.reduce(((e,n)=>{var c;switch(E++,n.isEnabled?r++:o++,(null===(c=n.titleId)||void 0===c?void 0:c.startsWith("P_"))&&(i++,n.isEnabled&&a++),n.type){case"MsgExt":s++,n.isEnabled&&l++,e.push(new rO(n,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new KC(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new oO(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new qC(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new YC(this.dataProvider,n,this.addPlugin,this.removePlugin))}return e}),[]);v+=r,b+=o,y+=i,C+=a,O+=s,S+=l,f.push({groupPlugins:u,parentPlugin:c})}}}catch(e){i={error:e}}finally{try{p||r||!(a=g.return)||(yield a.call(g))}finally{if(i)throw i.error}}return u[BC.TotalPluginCount]=f.length,u[BC.TotalISVPluginCount]=y,u[BC.SelectedPluginCount]=v,u[BC.UnselectedPluginCount]=b,u[BC.UnsupportedPluginCount]=E-f.length,u[BC.SelectedISVPluginCount]=C,u[BC.TotalMEPluginCount]=O,u[BC.SelectedMEPluginCount]=S,c.logMetricEnd({props:u},t),f}catch(e){c.logMetricEndWithError({props:u,message:jC.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getStoreFrontPlugins(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=new WC(_C.GetStoreFrontPluginsState,LC.GetStoreFrontPlugins,this.telemetryService),r={};try{const o=yield null===(t=this.dataProvider)||void 0===t?void 0:t.getStoreFrontPlugins(e),i=[];return o.forEach((e=>{const t=new iO(this.dataProvider,e);i.push(t)})),r[BC.TotalStoreFrontPluginsCount]=i.length,n.logMetricEnd({props:r},e),i}catch(t){n.logMetricEndWithError({props:r,message:jC.StoreFrontPluginsFetchFailed,diagnosticsData:`Error: ${t.message||t}`},e)}}))}getSupportedPluginTypes(e){return e?Object(GC.a)(this.supportedPluginTypes,e):this.supportedPluginTypes}}var sO,lO,cO,uO,dO,pO,gO,hO,fO;function mO(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.botInvoke(e);return Object.assign({},n)}))}!function(e){e[e.None=0]="None",e[e.PartialAuthSuccess=1]="PartialAuthSuccess"}(sO||(sO={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(lO||(lO={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.AuthRuntime=2]="AuthRuntime",e[e.AuthConfigRuntimeActivity=3]="AuthConfigRuntimeActivity",e[e.BotInvokeRuntimeActivity=4]="BotInvokeRuntimeActivity",e[e.SilentAuthRuntimeActivity=5]="SilentAuthRuntimeActivity",e[e.GetAppData=6]="GetAppData",e[e.GetAppDataForRuntime=7]="GetAppDataForRuntime"}(cO||(cO={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(uO||(uO={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.ExecuteActivity=2]="ExecuteActivity",e[e.Execute=3]="Execute",e[e.ExecuteConfigOrAuthRequest=4]="ExecuteConfigOrAuthRequest",e[e.GetAppData=5]="GetAppData",e[e.GetAppDataForRuntime=6]="GetAppDataForRuntime"}(dO||(dO={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(pO||(pO={})),function(e){e[e.PluginFlyout=1]="PluginFlyout",e[e.InChat=2]="InChat",e[e.CardAction=3]="CardAction",e[e.Unknown=4]="Unknown"}(gO||(gO={})),function(e){e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth",e[e.BotInvoke=4]="BotInvoke",e[e.Unknown=5]="Unknown"}(hO||(hO={})),function(e){e.AuthScenario="AuthScenario",e.AuthType="AuthType"}(fO||(fO={}));class vO{constructor(e){this.serviceProvider=e}execute(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=e,n=yield this.executeConfigOrAuthRequest(t,this.serviceProvider.telemetryService),r=Object.assign({},t.originalInvokeRequest);return n&&(r.requestBody.value.state=n),yield mO(r,this.serviceProvider.channelService)}))}executeConfigOrAuthRequest(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=e.originalInvokeRequest.appId,r=yield this.serviceProvider.appService.getApp({id:n});let o;if(null==r?void 0:r.appDefinition)o=r.appDefinition;else{if(!(null==r?void 0:r.titleInfo))return null==t||t.LogError({type:lO.LogError,name:dO.ExecuteConfigOrAuthRequest,tag:cO.AuthConfigRuntimeActivity,success:!1,diagnosticsData:"App Definition not found"}),Promise.reject("App Definition not found");o=Object(tO.a)(r.titleInfo)}const i=yield this.serviceProvider.authService.authenticate({appDefinition:o,signInUrl:e.url});return null==i?void 0:i.code}))}}class bO{constructor(e){this.serviceProvider=e}execute(e){var t,n,r,i,a,s,l,c;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=e;if(!o.resource){const e=yield this.serviceProvider.appService.getApp({id:o.originalInvokeRequest.appId});o.resource=null!==(i=null!==(t=o.resource)&&void 0!==t?t:null===(r=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.webApplicationInfo)||void 0===r?void 0:r.resource)&&void 0!==i?i:null===(l=null===(s=null===(a=null==e?void 0:e.titleInfo)||void 0===a?void 0:a.titleDefinition)||void 0===s?void 0:s.webApplicationInfo)||void 0===l?void 0:l.resource}const u=yield this.executeSilentAuthRequest(o);if(!u)return null===(c=this.serviceProvider.telemetryService)||void 0===c||c.LogError({type:lO.LogError,name:dO.Execute,tag:cO.SilentAuthRuntimeActivity,success:!1,diagnosticsData:"Failed to fetch Auth token for the request"}),Promise.reject("Failed to fetch Auth token for the request");const d=Object.assign({},o.originalInvokeRequest);return d.requestBody.value.authentication={token:u},yield mO(d,this.serviceProvider.channelService)}))}executeSilentAuthRequest(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(!e.resource)return Promise.reject("Resource is undefined");const t=yield this.serviceProvider.authService.getToken({resource:e.resource,claims:e.claims,isSilent:e.isSilent});return Promise.resolve(null==t?void 0:t.authToken)}))}}class yO{constructor(e){this.serviceProvider=e}execute(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=e;return this.serviceProvider.channelService?yield mO(n,this.serviceProvider.channelService):(null===(t=this.serviceProvider.telemetryService)||void 0===t||t.LogError({type:lO.LogError,name:dO.Execute,tag:cO.BotInvokeRuntimeActivity,success:!1,diagnosticsData:"Channel service is not available"}),Promise.reject("Channel service is not available"))}))}}class CO{constructor(e){this.serviceProvider=e}execute(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=e;return Promise.reject({request:t,error:"Not implemented"})}))}}var OO,SO=function(e,t,n,r){var o={authService:e,appService:t,channelService:n,telemetryService:r};this.authConfigActivity=new vO(o),this.silentAuthActivity=new bO(o),this.botInvokeActivity=new yO(o),this.apiPluginAuthActivity=new CO(o)},EO=function(){function e(e){this.clientInfo=e}return e.prototype.getUserContext=function(){if(!this.userInfo){var e=this.clientInfo;this.userInfo={dataResidency:this.getDataResidency(e.physicalRing),id:e.aadUserId,displayName:e.userName}}return this.userInfo},e.prototype.getHostContext=function(){if(!this.hostInfo){var e=this.clientInfo;this.hostInfo={host:{clientType:x.b.web,name:x.c.office,sessionId:e.sessionId,version:"1.0"},locale:e.locale,sessionId:e.sessionId,theme:x.d.default}}return this.hostInfo},e.prototype.getDataResidency=function(e){switch(e){case"dod":return C.d.DOD;case"doj":return C.d.DOJ;default:return C.d.Public}},e}(),xO=n(1810),IO=n(298),wO=function(){function e(e){this.pluginConfigService=e,this.cachedApps=new Map,this.appsLoadingPromise=void 0}return e.prototype.getApp=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrLoadAppById(e.id)];case 1:return[2,(t=n.sent())?{titleInfo:t}:void 0]}}))}))},e.prototype.getOrLoadAppById=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return this.cachedApps.size&&(t=this.cachedApps.get(e))?[2,t]:[4,this.fetchAndCacheApps()];case 1:return[2,n.sent().get(e)]}}))}))},e.prototype.fetchAndCacheApps=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this.appsLoadingPromise?[2,this.appsLoadingPromise]:(this.appsLoadingPromise=this.fetchApps(),e=this,[4,this.appsLoadingPromise]);case 1:return e.cachedApps=t.sent(),this.appsLoadingPromise=void 0,[2,this.cachedApps]}}))}))},e.prototype.fetchApps=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.pluginConfigService.executeOperation({type:xO.a.GetPluginDefinition})];case 1:return"Success"===(null==(e=n.sent())?void 0:e.status)&&pm.b.typeGuard(e)?(t=TO(e.pluginDefinitions),[2,new Map(t.map((function(e){return[e.appId,e]})))]):[2,new Map]}}))}))},e}(),TO=function(e){return Array.isArray(e)?e.map((function(e){return TO(e)})):null!=e&&e.constructor===Object?Object.keys(e).reduce((function(t,n){var r;return Object(o.__assign)(Object(o.__assign)({},t),((r={})[Object(IO.camelCase)(n)]=TO(e[n]),r))}),{}):e},kO=n(1469),jO=n(1811),PO=function(){function e(e){this.pluginConfigService=e}return e.prototype.botInvoke=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.processRequest(e),n={type:xO.a.GetBotResult,botRequest:t},[4,this.pluginConfigService.executeOperation(n)];case 1:return"Success"!==(null==(r=o.sent())?void 0:r.status)?[2,void 0]:(i=r.botResult,r.botResult.Error?[2,{type:jO.a.Error,value:{errorCode:i.Error.HttpCode,errorMessage:i.Error.Message}}]:[2,{type:jO.a.Result,value:i.response}]);case 2:return o.sent(),[2,void 0];case 3:return[2]}}))}))},e.prototype.processRequest=function(e){var t,n,r,o,i,a={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(kO.generateGuid)(),scenario:{name:"M365CardSDK"}};return e.requestBody.appName&&(a.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(a.request.imDisplayName=e.requestBody.imdisplayname),a},e}(),AO=n(1790),_O=n(300),DO=function(){function e(e){this.clientInfo=e,this.selectedAccount=null;var t=e&&(null==e?void 0:e.clientId)?e.clientId:"3068386c-7a16-4f6a-a664-043b6b232816",n=e&&(null==e?void 0:e.redirectUri)?e.redirectUri:"/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.13003/en-us_web/login.html";this.msalApp=new AO.a({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}return e.prototype.getToken=function(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,s,l,c=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,9]),[4,this.msalApp.initialize()];case 1:return o.sent(),(null==(i=this.msalApp.getAllAccounts())?void 0:i.length)>=1&&(this.clientInfo?this.selectedAccount=null!==(t=i.find((function(e){var t;return e.username===(null===(t=c.clientInfo)||void 0===t?void 0:t.userPrincipalName)})))&&void 0!==t?t:null:this.selectedAccount=i[0]),this.selectedAccount||this.signInRequestPromise||(a=this.clientInfo?{loginHint:this.clientInfo.userPrincipalName}:void 0,this.signInRequestPromise=this.msalApp.loginPopup(a)),this.signInRequestPromise?[4,this.signInRequestPromise]:[3,3];case 2:(s=o.sent())&&(this.selectedAccount=s.account),this.signInRequestPromise=void 0,o.label=3;case 3:if(!this.selectedAccount)throw new Error("Failed to acquire token - No account found.");return n={scopes:["".concat(e.resource,"/.default")],account:this.selectedAccount},[4,this.msalApp.acquireTokenSilent(n)];case 4:return(l=o.sent())?[2,{authToken:l.accessToken}]:[3,9];case 5:return o.sent()instanceof _O.a?e.isSilent&&n?[4,this.msalApp.acquireTokenPopup(n)]:[3,7]:[3,8];case 6:return r=o.sent(),[3,8];case 7:throw new Error($C);case 8:return this.signInRequestPromise=void 0,[3,9];case 9:if(r)return[2,{authToken:r.accessToken}];throw new Error("Failed to acquire token.")}}))}))},e}(),LO=function(e,t,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var a,s,l,c,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,t.getOrLoadPlugins()];case 1:return a=null!==(u=o.sent())&&void 0!==u?u:[],s={pluginsInfo:a,workflowAnnotationType:pm.a.getTypeName()},n(s),l=function(e){var t=a.filter((function(t){return t.id===function(e){switch(e){case lp.Work:return Qv.ENTERPRISE_SEARCH;case lp.Web:return Qv.WEB_SEARCH}return""}(e.id)})),n=t.length?t[0]:void 0;return n?"blocked"===n.state?mp.Blocked:n.isEnabled?mp.Enabled:mp.Disabled:mp.Disabled},c=[],null==e||e.map((function(e){var t=e.state,n=l(e);n!=mp.Blocked&&(e.id===lp.Work&&i||e.id===lp.Web&&r)&&(n=mp.Enabled),n===mp.Blocked?(t===mp.Enabled&&(gy("Plugin is blocked by admin, turning off ".concat(e.id," plugin Ux")),e.onToggle(!1)),c.push(e.id),yb("".concat(e.id,":AdminBlocked"))):(e.onToggle(n===mp.Enabled),yb("".concat(e.id,":").concat(n===mp.Enabled?"AutoOn":"AutoOff")))})),[2,c]}}))}))},MO=function(){function e(e,t,n,r,i,a,s,l){var c=this;this.getTransformFileSuggestionText=function(){var e,t;if(c.zqmProps)try{for(var n=Object(o.__values)(c.zqmProps.promptSuggestionList),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return dv},this.chatInputRef=e,this.handleSubmit=t,this.isExecuting=n,this.chatEditor=r,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=i,this.setChatInputStateExpanded=a,this.isHVCAppChatV2Enabled=null!=s&&s,this.hvcPromptStringsList=null!=l?l:[],this.telemetryLoggerUtils=Ym.getInstance()}return e.prototype.handleZQMButtonClick=function(e,t){var n,r,i;return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return this.isExecuting?[2]:(ny(dv),Fm.getInstance().sendLoggingEventToClient(Dm.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ZQMButtonV2Clicked}]),a=this.zqmProps.promptSuggestionList.find((function(e){return e.suggestionText==t})),s=e,l=dv,[4,this.setChatInputStateExpanded()]);case 1:return o.sent(),(null==a?void 0:a.shouldSubmitQueryOnClick)?(this.isHVCAppChatV2Enabled&&(s=s.replace(/{|}/g,"")),this.handleSubmit({text:s,telemetryData:sm.ZQMButtonClicked}),[2]):(t===this.transformFileSuggestionText&&(l=this.transformFilePlaceholderText),null===(n=this.chatInputRef.current)||void 0===n||n.setInputText(s,!0),null===(r=this.chatInputRef.current)||void 0===r||r.setFocus(),t===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.updateInputText($u,Yp.InsertAtCursor)}),1),null===(i=this.chatInputRef.current)||void 0===i||i.setGhostText(l),[2])}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t,iconRegular:e.iconRegular}})),isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,handleButtonClick:this.handleZQMButtonClick,hvcPromptStringsList:this.hvcPromptStringsList}},e}(),BO=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){return gy("CopilotLicensingAnnotation received"),e=Ym.getInstance(),Ay.getInstance().setLicenseAnnotationActivated(!0),e.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLicensingAnnotationActivated},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),Ay.getInstance().resubmitOnLicenseAnnotationActivation(),[2]}))}))},RO=function(){this.getProps=function(e){return{handleRestrictiveMsgDismissClick:e}}},FO=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){return{conversationId:t,getLogs:e,telemetryData:n,sessionId:r,conversationLogObject:o,debugMessageInfoObject:i,showDebugInfoMessage:a,setShowDebugInfoOnMessage:s,chatPaneLoadTime:l,chatInputLoadTime:c,sydneyConversationObject:u,augloopKustoQueryURL:d,clientKustoQueryURL:p,appName:g,appPlatform:h,sdxVersion:f}},e}(),NO=Object(ue.a)({deleteAllButton:{width:"100%"}}),HO=se.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles,o=wr(!1);return se.createElement(me.a,{className:Object(E.a)(o().root,NO().deleteAllButton,n),icon:se.createElement(Cr.k,{className:r}),onClick:t,"aria-label":Or()},Or())})),UO=se.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles,o=wr();return se.createElement(me.a,{className:Object(E.a)(o().root,n),icon:se.createElement(Gn.d,{className:r}),onClick:t,"aria-label":H()?OfficeaicopilotStrings.BackButtonText:"Go back"})})),VO=(se.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles,o=wr();return se.createElement(me.a,{className:Object(E.a)(o().root,n),icon:se.createElement(xe.p,{className:r}),onClick:t,"aria-label":Sr()})})),se.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles,o=wr(!1);return se.createElement(me.a,{className:Object(E.a)(o().root,n),icon:se.createElement(xe.p,{className:r}),onClick:t,"aria-label":Sr(),size:"small"},H()?OfficeaicopilotStrings.NewChatButtonText:"New chat")}))),zO={Root:Object(o.__assign)({justifyContent:"space-between"},De.a.padding("0px","16px","10px","0px")),label:Object(o.__assign)({},De.a.padding("3px")),icon:{fontSize:"16px"},toolbarGroup:{display:"flex"}},GO=Object(ue.a)(zO),WO=se.memo((function(e){var t=e.title,n=e.backButtonProps,r=e.newConversationButtonProps,o=GO();return se.createElement(It.a,{"aria-label":H()?OfficeaicopilotStrings.ChatHistoryHeaderAriaLabel:"Tool bar",className:o.Root},se.createElement(wt.a,{role:"presentation",className:o.toolbarGroup},se.createElement(UO,{customIconStyles:o.icon,onClick:n.onClick}),se.createElement(ve.a,{className:o.label,size:"large"},t)),se.createElement(wt.a,{role:"presentation"},se.createElement(VO,{customIconStyles:o.icon,onClick:r.onClick})))})),QO=se.memo(WO),qO=Object(S.a)(j),KO={Root:{overflowY:"auto",maxHeight:"100%"},TriggerButtonStyle:Object(o.__assign)(Object(o.__assign)({},De.a.border("none")),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:qO.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:qO.colorNeutralBackground3Hover}}}),SplitButtonGroupStyle:(OO={},OO["& .".concat(Oc.a.icon)]={display:"none"},OO["&:hover .".concat(Oc.a.icon)]={display:"inline"},OO["& > :nth-child(2) > :nth-child(2)"]={display:"inline"},OO["&:hover > :nth-child(2) > :nth-child(2)"]={display:"none"},OO),SplitButtonLeftButtonStyle:Object(o.__assign)(Object(o.__assign)({},De.a.overflow("hidden")),{textOverflow:"ellipsis",whiteSpace:"nowrap",flexShrink:1,display:"inline-block"}),SplitButtonRightButtonStyle:{paddingLeft:"6px !important","&:before":{display:"none"}},LoadingSkeletonStyle:Object(o.__assign)({width:"inherit",alignItems:"center",display:"flex",paddingTop:"5px",paddingBottom:"5px",position:"relative"},De.a.gap("5px")),SplitButtonAdditionalStyle:{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:qO.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:qO.colorNeutralBackground3Hover}},maxWidth:"100%"}},YO=Object(ue.a)(KO),ZO=se.forwardRef((function(e,t){var n=e.isChatHistoryListLoading,r=e.conversationOnClick,o=e.deleteOnClick,i=e.conversations,a=YO();return se.createElement(ye.a,{ref:t,className:a.Root},n?se.createElement(SC.a,{role:"menuitem"},se.createElement("div",{className:a.LoadingSkeletonStyle},se.createElement(EC.a,{shape:"circle",size:16}),se.createElement(EC.a,{shape:"rectangle",size:16})),se.createElement("div",{className:a.LoadingSkeletonStyle},se.createElement(EC.a,{shape:"circle",size:16}),se.createElement(EC.a,{shape:"rectangle",size:16})),se.createElement("div",{className:a.LoadingSkeletonStyle},se.createElement(EC.a,{shape:"circle",size:16}),se.createElement(EC.a,{shape:"rectangle",size:16}))):i.map((function(e){return se.createElement(jt.a,{key:e.conversationId,className:a.SplitButtonGroupStyle},se.createElement(Ce.a,{className:Object(E.a)(a.SplitButtonLeftButtonStyle,a.SplitButtonAdditionalStyle),onClick:function(){return r(e)}},e.conversationName),se.createElement(Ce.a,{className:Object(E.a)(a.SplitButtonRightButtonStyle,a.SplitButtonAdditionalStyle),onClick:function(){return o(e)},icon:se.createElement(Gn.n,null)},se.createElement("span",null,e.timeOfCreation)))})))})),JO=se.memo(ZO),XO={Root:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column"},De.a.padding("0px","3px")),{justifyContent:"space-between",height:"100%"}),ChatHistoryPanelBodyStyle:Object(o.__assign)({overflowY:"auto",flexGrow:1},De.a.padding("0px","13px")),DeleteButtonContainerStyle:Object(o.__assign)({alignSelf:"flex-end",width:"95%"},De.a.margin("10px","auto"))},$O=Object(ue.a)(XO),eS=le.a.forwardRef((function(e,t){var n=e.headerProps,r=e.conversationListProps,o=e.deleteButtonProps,i=$O();return le.a.createElement("div",{className:i.Root},le.a.createElement(QO,{title:n.title,backButtonProps:n.backButtonProps,newConversationButtonProps:n.newConversationButtonProps}),le.a.createElement("div",{className:i.ChatHistoryPanelBodyStyle},le.a.createElement(JO,{ref:t,isChatHistoryListLoading:r.isChatHistoryListLoading,conversationOnClick:r.conversationOnClick,deleteOnClick:r.deleteOnClick,conversations:r.conversations})),le.a.createElement("div",{className:i.DeleteButtonContainerStyle},le.a.createElement(HO,{onClick:o.onClick})))})),tS=le.a.memo(eS),nS=function(e){var t=e.setChatLog,n=e.currentChatId,r=e.setIsExecuting,i=e.setLoadingComponentProps,a=e.suggestionPillsBuilderRef,s=e.createAndSubmitChatHistorySignal,l=e.resetToNewConversation,c=e.setChatHistoryMenuData,u=e.handleChatHistoryPanelClose,d=e.isSwitchingConversation,p=e.isChatHistoryMenuLoading,g=e.chatHistoryMenuData,h=e.isChatHistoryPanelFetchingMoreChats,f=e.setIsChatHistoryPanelFetchingMoreChats,m=e.isEndOfChatHistory,v=Object(se.useRef)(null),b=Object(se.useRef)(150);Object(se.useEffect)((function(){h&&!m&&s(um.c.GetAllChatsOperation)}),[h]),Object(se.useEffect)((function(){var e=v.current;if(e)return e.addEventListener("scroll",y),function(){return e.removeEventListener("scroll",y)}}),[]);var y=function(e){!(e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight)<b.current)||h||m||f(!0)},C=le.a.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return u(),gy("Change Topic Button Clicked."),a.current.setSuggestedQnAList([]),ES(!0),i((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[Zy()[1]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,s(um.c.AddChatOperation)];case 1:return e.sent(),r(!0),[2]}}))}))}),[a,i,Zy,s]),O=le.a.useCallback((function(e){n!==e.conversationId&&(d.current=!0,s(um.c.GetMessagesOperation,void 0,void 0,void 0,e.conversationId),i((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[Zy()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),r(!0)),u()}),[n,s,i,Zy]),S=le.a.useCallback((function(e){s(um.c.DeleteChatOperation,void 0,void 0,void 0,e.conversationId),c(g.filter((function(t){return t.sessionId!==e.conversationId}))),e.conversationId===n&&(l(),t([]))}),[s,g,n]);return le.a.createElement(tS,{ref:v,headerProps:{title:nv()?OfficeaicopilotStrings.ChatHistoryPanelTitle:"Copilot Chats",backButtonProps:{onClick:function(){return u()}},newConversationButtonProps:{onClick:C}},conversationListProps:{isChatHistoryListLoading:p,conversationOnClick:O,deleteOnClick:S,conversations:g.map((function(e){return{conversationName:e.chatName&&""!==e.chatName?e.chatName:nv()?OfficeaicopilotStrings.ChatHistoryPanelEmptyConversationName:"Empty chat",conversationId:e.sessionId,timeOfCreation:"".concat(String(new Date(e.createTimeUtc).getDate()).padStart(2,"0"),"/").concat(String(new Date(e.createTimeUtc).getMonth()+1).padStart(2,"0"),"/").concat(new Date(e.createTimeUtc).getFullYear())}}))},deleteButtonProps:{onClick:function(){return window.open("https://go.microsoft.com/fwlink/?linkid=2259761","_blank")}}})},rS=function(){this.getProps=function(e){return{handlePythonExitAnalysisButtonClick:e}}},oS=n(2679),iS=function(){function e(){this.requestByQueryId=new Map}return e.prototype.executeOperation=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Object(o.__generator)(this,(function(o){return t=function(e){var t=new oS.a({operation:e,queryId:Object(fm.a)()}),n=Ym.getInstance(),r=new ub.b({parentPath:["Signal",oS.a.getTypeName()],items:[{id:db.a.generateId(),body:t}]}),o=e.type;return n.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.PluginConfigSignalSent},{key:im.ChatEventParameters,value:"".concat(oS.a.getTypeName(),"_").concat(o)}]),gy("Submitting signal to Augloop : ".concat(oS.a.getTypeName()," signal: ").concat(JSON.stringify(t))),Ay.getInstance().submitOperation(r,pm.a.getTypeName()),t}(e),n=new aS,this.requestByQueryId.set(t.queryId,n),r=n.completion.then((function(){return!0})),i=ev(6e4).then((function(){return!1})),[2,Promise.race([r,i]).then((function(r){return r?n.completion:(a.requestByQueryId.delete(t.queryId),Promise.reject(new Error("Timeout executing operation ".concat(e.type))))}))]}))}))},e.prototype.onOperationResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e}(),aS=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),sS=function(){function e(){this.current=void 0,this.pending=void 0,this.resolvePending=void 0}return e.prototype.awaitChatHistoryPlugin=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){return this.current?[2,this.current]:(e=this.pending||this.initPendingPromise(),t=e.then((function(){return!0})),n=ev(sv).then((function(){return!1})),[2,Promise.race([t,n]).then((function(t){return t?e:Promise.reject(new Error("Timeout during awaiting chat history plugins"))}))])}))}))},e.prototype.onChatHistoryPluginInfo=function(e){var t;this.current=e.map((function(e){return e.id})),null===(t=this.resolvePending)||void 0===t||t.call(this,this.current)},e.prototype.initPendingPromise=function(){var e=this;return this.pending=new Promise((function(t){e.resolvePending=t}))},e}(),lS=function(){function e(e,t,n){var r=this;this.pluginConfigService=e,this.chatHistoryEnabledPluginsSource=t,this.pluginParams=n,this.plugins=void 0,this.pluginsLoadingPromise=void 0,this.telemetryLoggerUtils=Ym.getInstance(),this.logFailure=function(e){r.telemetryLoggerUtils.sendTelemetryErrorData([{key:am.ErrorMessage,value:e},{key:am.ErrorType,value:ym.Server},{key:am.ErrorCode,value:Vv.AugloopPluginProviderFailure},{key:am.ErrorCategory,value:Vm.Augloop}])}}return e.prototype.getPlugins=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return[2,e.sent()]}}))}))},e.prototype.getStoreFrontPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.installStoreFrontPlugin=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.getPluginsGrouped=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return e=t.sent(),[2,e.map((function(e){return{groupHeaderPlugin:e,plugins:[e]}}))]}}))}))},e.prototype.setPlugin=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.plugins=Object(IO.unionBy)(this.plugins,[e],"id"),this.pluginParams.logGroundingSourceEvent&&vb(e,e.isEnabled?"On":"Off"),[2,Promise.resolve()]}))}))},e.prototype.getEnabledPlugins=function(){return this.plugins?this.plugins.filter((function(e){return e.isEnabled})).map((function(e){return{id:e.id,source:e.source}})):[]},e.prototype.getOrLoadPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this.plugins?[2,this.plugins]:this.pluginsLoadingPromise?[2,this.pluginsLoadingPromise]:(this.pluginsLoadingPromise=this.loadPlugins(),[4,this.pluginsLoadingPromise]);case 1:return e=t.sent(),this.plugins=e,this.pluginsLoadingPromise=void 0,[2,e]}}))}))},e.prototype.getRestrictedSearchMode=function(){var e;return null===(e=this.restrictedSearchConfigResponse)||void 0===e?void 0:e.RestrictedSearchMode},e.prototype.loadPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.getInstalledPlugins(),this.getChatHistoryEnabledPlugins()])];case 1:return e=o.__read.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],t?(t.forEach((function(e){"acquired"===e.state?(n.has(e.id)&&(e.isEnabled=!0),e.id===Qv.WEB_SEARCH&&r.pluginParams.isWebSearchDefaultOn&&(e.isEnabled=!0),r.pluginParams.logGroundingSourceEvent&&vb(e,e.isEnabled?"AutoOn":"AutoOff")):r.pluginParams.logGroundingSourceEvent&&vb(e,"AdminBlocked")})),[2,t]):[2,void 0]}}))}))},e.prototype.getInstalledPlugins=function(){var e,t,n,r;return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.pluginConfigService.executeOperation({type:xO.a.GetPluginConfig})];case 1:return"Success"!==(null==(i=o.sent())?void 0:i.status)?(this.logFailure("GetPluginConfig operation failed"),[2,void 0]):((null===(e=i.installedPlugins)||void 0===e?void 0:e.PluginGroups.findIndex((function(e){var t;return!e.IsDisabledByAdmin&&(null===(t=e.PluginDescriptions)||void 0===t?void 0:t.findIndex((function(e){return e.CopilotPluginInfo.Id===Qv.ENTERPRISE_SEARCH})))>=0})))>=0&&(this.restrictedSearchConfigResponse=null===(t=i.pluginProperties)||void 0===t?void 0:t.enterpriseRestrictedSearch),[2,null!==(r=null===(n=i.installedPlugins)||void 0===n?void 0:n.PluginGroups.flatMap(cS))&&void 0!==r?r:[]]);case 2:return a=o.sent(),this.logFailure("Exception in getInstalledPlugins: "+a.message),[2,void 0];case 3:return[2]}}))}))},e.prototype.getChatHistoryEnabledPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.chatHistoryEnabledPluginsSource.awaitChatHistoryPlugin()];case 1:return e=t.sent(),[2,new Set(e)];case 2:return t.sent(),[2,new Set];case 3:return[2]}}))}))},e}();function cS(e){return(null==e?void 0:e.PluginDescriptions)?e.PluginDescriptions.map((function(t){return function(e,t){var n,r,o,i,a,s;if(!t.CopilotPluginInfo.Id)return;var l=null!==(n=e.DisplayName)&&void 0!==n?n:t.DisplayName;if(!l)return;return{icon:null!==(i=null!==(o=null!==(r=e.IconUrl)&&void 0!==r?r:e.IconBase64)&&void 0!==o?o:t.IconUrl)&&void 0!==i?i:t.IconBase64,name:l,metaOSAppId:e.MetaOSAppId,id:null!==(a=t.CopilotPluginInfo.Id)&&void 0!==a?a:e.MetaOSAppId,state:e.IsDisabledByAdmin?"blocked":"acquired",source:null!==(s=t.CopilotPluginInfo.Source)&&void 0!==s?s:"",type:uS(t.CopilotPluginInfo.Id),isEnabled:!1,rank:0}}(e,t)})).filter((function(e){return!!e})):[]}function uS(e){return e?e.includes("MessageExtension")?"MsgExt":e.includes("BingWebSearch")?"FirstParty":e.includes("DataVerse")?"DataVerse":e.includes("PowerPlatform")?"PowerPlatform":"Unsupported":"Unsupported"}var dS=function(){this.getProps=function(e){return{buttonText:e.buttonText,icon:e.icon,onClick:e.onClick}}},pS=null,gS=null,hS=null,fS=!1,mS="",vS="",bS=0,yS=se.forwardRef((function(e,t){var a,s,u,d,h,f,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B,R,F,N,H,U,V,z,G,W,Q,K=e.style,Y=e.platformType,Z=void 0===Y?r.web:Y,J=e.copilotCommunicationHandler,X=e.copilotTelemetryHandler,$=void 0===X?new qm:X,ee=e.theme,te=void 0===ee?Ny:ee,ne=e.themeV2,re=void 0===ne?void 0:ne,oe=e.useALRuntime,ae=void 0!==oe&&oe,ue=e.chatUiProps,de=e.designerProps,ge=e.basicChatProps,he=e.debugProps,fe=e.copilotPluginProps,me=Object(se.useRef)((new Date).getTime());i=Z;var ve=null!==(a=ue.chatInputProps)&&void 0!==a?a:ue.chatInputV2Props,be=ue.chatInputV2Props,ye=null!==(s=ve.isHVCAppChatV2Enabled)&&void 0!==s&&s,Ce=null!==(u=ve.hvcPromptStrings)&&void 0!==u?u:[],Oe=null!==(d=ve.hvcPromptStringsList)&&void 0!==d?d:[],Se=ve.onChatInputHVCPromptUpdated,Ee=null!==(h=ve.onUserQuerySubmitted)&&void 0!==h?h:function(){},xe=ue.clientInfoProps?ue.clientInfoProps.clientInfo:q(),Ie=ue.clientInfoProps?null===(f=ue.clientInfoProps)||void 0===f?void 0:f.taskModuleLauncher:void 0,we=null!==(v=null==be?void 0:be.shouldInitializeEditorInChatInput)&&void 0!==v&&v,Te=Fm.getInstance(J),ke=Ym.getInstance(),je=Object(o.__read)(Object(se.useState)(!1),2),Pe=je[0],Ae=je[1],_e=null===(b=null==fe?void 0:fe.copilotList.find((function(e){return e.isDefaultCopilot})))||void 0===b?void 0:b.id,De=null===(y=null==fe?void 0:fe.copilotList.find((function(e){return e.isSelected})))||void 0===y?void 0:y.id,Le=fe&&fe.copilotList.length>1,Me=null!==(C=(null==fe?void 0:fe.showNewChatButtonOnTop)&&Le)&&void 0!==C&&C,Be=Object(o.__read)(se.useState(se.createElement(se.Fragment,null)),2),Re=Be[0],Fe=Be[1],Ne=Object(o.__read)(se.useState(!1),2),He=Ne[0],ze=Ne[1],Ge=function(e,t){ze(t.open);var n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};Te.sendLoggingEventToClient(Dm.CopilotSwitcherMenuStateChange,n)},We=void 0!==re,qe=aC(),Ke=sC();lC(We?Ke:qe,K);var Ye=Object(o.__read)(Object(se.useState)([]),2),Ze=Ye[0],Je=Ye[1],Xe=Object(o.__read)(Object(se.useState)(zv.Shy),2),$e=Xe[0],et=Xe[1],tt=Object(se.useRef)(),nt=new Cb(Je,J,tt),rt=Object(se.useRef)(null),ot=Object(se.useRef)(null),it=Object(se.useRef)(null),at=Object(se.useRef)(!1),st=Object(o.__read)(Object(se.useState)(!1),2),lt=st[0],ct=st[1],ut=se.useCallback((function(){return lt}),[lt]),dt=Object(o.__read)(Object(se.useState)(),2),pt=dt[0],gt=dt[1],ht=Object(se.useRef)(0),ft=Object(se.useRef)(),mt=Object(o.__read)(Object(se.useState)(!1),2),vt=mt[0],bt=mt[1],yt=Object(o.__read)(Object(se.useState)(!1),2),Ct=yt[0],Ot=yt[1],St=Object(o.__read)(Object(se.useState)(!1),2),Et=St[0],It=St[1],wt=Object(o.__read)(Object(se.useState)(!0),2),Tt=wt[0],kt=wt[1],jt=Object(o.__read)(Object(se.useState)(!1),2),Pt=jt[0],At=jt[1],_t=Object(o.__read)(Object(se.useState)([]),2),Dt=_t[0],Lt=_t[1],Mt=Object(o.__read)(Object(se.useState)(!1),2),Bt=Mt[0],Rt=Mt[1],Ft=Object(o.__read)(Object(se.useState)(!1),2),Nt=Ft[0],Ht=Ft[1],Ut=Object(o.__read)(Object(se.useState)({loadingUiStringList:Yy(),shouldShowLoadingUi:!0}),2),Vt=Ut[0],zt=Ut[1],Gt=Object(o.__read)(Object(se.useState)({headerText:dv,descriptionText:dv}),2),Wt=Gt[0],Qt=Gt[1],qt=ue.tipCardProps,Kt=Object(o.__read)(Object(se.useState)(!1),2),Yt=Kt[0],Zt=Kt[1],Jt=Object(o.__read)(Object(se.useState)(!1),2),Xt=Jt[0],$t=Jt[1],en=Object(o.__read)(Object(se.useState)(Ny),2),nn=en[0],rn=en[1],on=Object(o.__read)(Object(se.useState)(Hy),2),an=on[0],sn=on[1],ln=Object(o.__read)(Object(se.useState)(!1),2),cn=(ln[0],ln[1]),un=Object(o.__read)(Object(se.useState)(void 0!==ue.freUiProps),2),dn=un[0],pn=un[1],gn=Object(o.__read)(Object(se.useState)(!1),2),hn=gn[0],fn=gn[1],mn=Object(o.__read)(Object(se.useState)(!1),2),vn=mn[0],bn=mn[1],yn=Object(o.__read)(Object(se.useState)(Vy.Uninitialized),2),Cn=yn[0],On=yn[1],Sn=Object(o.__read)(Object(se.useState)(!1),2),En=Sn[0],xn=Sn[1],In=Object(o.__read)(Object(se.useState)(!1),2),wn=In[0],Tn=In[1],jn=Object(se.useRef)(!1),Pn=Object(se.useRef)(),An=Object(o.__read)(Object(se.useState)(!1),2),_n=An[0],Dn=An[1],Ln=ae,Mn=se.useRef(),Bn=Object(o.__read)(Object(se.useState)(),2),Rn=Bn[0],Nn=Bn[1],Hn=Object(o.__read)(Object(se.useState)(),2),Un=Hn[0],Vn=Hn[1],zn=Object(o.__read)(se.useState(!1),2),Gn=zn[0],Wn=zn[1],Qn=Object(o.__read)(se.useState([]),2),Kn=Qn[0],Yn=Qn[1],Zn=Object(o.__read)(Object(se.useState)(!1),2),Jn=Zn[0],Xn=Zn[1],$n=Object(o.__read)(Object(se.useState)(!1),2),er=$n[0],tr=$n[1],rr=Object(o.__read)(Object(se.useState)(),2),or=rr[0],ir=rr[1],ar=Object(o.__read)(Object(se.useState)(ue.copilotWorkflowProps),2),sr=ar[0],lr=ar[1],cr=Object(o.__read)(Object(se.useState)(0),2),ur=cr[0],dr=cr[1],pr=Object(o.__read)(Object(se.useState)(!1),2),hr=pr[0],fr=pr[1],mr=Object(o.__read)(Object(se.useState)(null),2),vr=mr[0],br=mr[1],Cr=Object(o.__read)(Object(se.useState)(null),2),Or=Cr[0],Sr=Cr[1],Er=Object(se.useRef)(!1),xr=Object(se.useRef)(),Ir=Object(se.useRef)(!0),wr=Object(o.__read)(Object(se.useState)(!1),2),Tr=wr[0],kr=wr[1],Pr=Object(o.__read)(Object(se.useState)(!1),2),Ar=Pr[0],_r=Pr[1],Dr=Object(o.__read)(Object(se.useState)([]),2),Lr=Dr[0],Mr=Dr[1],Br=Object(o.__read)(Object(se.useState)(!1),2),Rr=Br[0],Fr=Br[1],Nr=Object(o.__read)(Object(se.useState)(!1),2),Hr=Nr[0],Ur=Nr[1],Vr=Object(o.__read)(Object(se.useState)(!1),2),zr=Vr[0],Gr=Vr[1],Wr=se.useRef(!1),Qr=se.useRef(!1),qr=se.useRef(void 0),Kr=new Jy,Yr=new qy,Zr=null===(O=ue.toggleUiProps)||void 0===O?void 0:O.trySydneyToggleEnabled,Jr=null===(S=ue.toggleUiProps)||void 0===S?void 0:S.tryEnterpriseSearchToggleEnabled,Xr=null===(E=ue.toggleUiProps)||void 0===E?void 0:E.tryWebSearchToggleEnabled,$r=null===(x=ue.toggleUiProps)||void 0===x?void 0:x.tryReviewerAgentToggleEnabled,eo=new tC,to=new fC,no=new FO,ro=new Ky(ue.hintCardProps),oo=new bC,io=new rS,ao=new RO,so=new dS,lo=function(){var e;return we?null===(e=tt.current)||void 0===e?void 0:e.getChatEditorInstance():Rn},co=!!(null===(I=ue.copilotWorkflowProps)||void 0===I?void 0:I.enableWorkflowPlugin)&&ue.copilotWorkflowProps.enableWorkflowPlugin,uo=null!==(T=null===(w=null==ve?void 0:ve.voiceInputProps)||void 0===w?void 0:w.handleInChatInput)&&void 0!==T&&T,po=null!==(k=ue.zeroQueryMessageProps)&&void 0!==k?k:ue.zeroQueryMessageV2Props,go=ue.copilotLabProps;te=null!=te?te:re;var ho=-1,fo=function(){var e,t,n,r,o;gy("handleEditorOpenButtonClick"),Er.current=!0;var i=$u,a=null!==(e=null==mo?void 0:mo.ciqPlaceholderText)&&void 0!==e?e:Kv();null===(t=tt.current)||void 0===t||t.setInputText(i),null===(n=tt.current)||void 0===n||n.setGhostText(a),null===(r=tt.current)||void 0===r||r.setFocus(),null===(o=lo())||void 0===o||o.forceInvokeCIQMenu($u)};(null==ve?void 0:ve.voiceInputProps)&&iv[rb()]===iv.Safari&&(ve.voiceInputProps=void 0);var mo=null==ve?void 0:ve.editorConfig,vo=function(){return J.isFeatureGateEnabledFromClient(Nv.IsDebugSectionV2Enabled)};Xv.isDevbuild()&&((null==he?void 0:he.isDebugToggleEnabled)||vo())&&sb.initialize();var bo,yo=!0;Object(se.useImperativeHandle)(t,(function(){return{addResponseMessage:_o.current.addResponseMessage,updateMessage:_o.current.updateMessage,resendChatHistorySignal:_o.current.resendChatHistorySignal,updateLastMessage:_o.current.updateLastMessage,deleteMessage:_o.current.deleteMessage,submitOperation:_o.current.submitOperation,updateLoadingComponentProps:_o.current.updateLoadingComponentProps,addChatMessages:_o.current.addChatMessages,getLastMessage:function(e){if(ht.current>0)return Ze[my(Ze,e)]},clearMessages:_o.current.clearMessages,startLoadingUi:_o.current.startLoadingUi,startReinitializeALSession:_o.current.startReinitializeALSession,setInputAreaText:_o.current.setInputAreaText,setInputFocus:_o.current.setInputFocus,getInputText:_o.current.getInputText,submitUserQuery:_o.current.submitUserQuery}}));var Co=function(e,t,n){nt.setChatMessageData(e,t,n)},Oo=function(){var e;return we?null===(e=tt.current)||void 0===e?void 0:e.getCIQResponseHandler():Un},So=function(){var e;return we?null===(e=tt.current)||void 0===e?void 0:e.getCIQTextRef():Pn.current},Eo=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return So()?e?[4,mo.getSensitivityInfo(e)]:[3,2]:[3,4];case 1:return n=r.sent(),[3,3];case 2:n=null,r.label=3;case 3:t=n,Xn(!1),So().setSensitivity(t),It(!1),r.label=4;case 4:return[2]}}))}))},xo=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return So()?[4,mo.getSensitivityInfo(null)]:[3,2];case 1:e=t.sent(),So().setSensitivity(e),Xn(!1),t.label=2;case 2:return[2]}}))}))},Io=function(){var e;return(null===(e=tt.current)||void 0===e?void 0:e.getInputText())||""},wo=function(){var e;null===(e=rt.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},To=function(e){return void 0===e&&(e=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Vo(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),gy("Exception occurred during initialization of AL"+t.message),[3,3];case 3:return[2]}}))}))},ko=function(e){var t,n,r,o,i,a,s,l;if(e){ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophoneLoadingTimeInMs},{key:im.ChatEventParameters,value:SS(cC)}]);var c=(null===(t=tt.current)||void 0===t?void 0:t.getInputText().length)>0&&yo?" ":dv;null===(n=tt.current)||void 0===n||n.setGhostText(c+qv())}else(null===(r=tt.current)||void 0===r?void 0:r.getInputText())===dv?null===(o=tt.current)||void 0===o||o.setGhostText(null!==(i=null==ve?void 0:ve.chatPlaceholderMessage)&&void 0!==i?i:fv):(null===(s=null===(a=tt.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())===qv()&&(null===(l=tt.current)||void 0===l||l.setGhostText(dv));Tn(e),jn.current=e};Object(se.useEffect)((function(){if(De!==_e){var e=null==fe?void 0:fe.copilotList.find((function(e){return e.id===De}));e&&e.copilotComponent&&Fe(e.copilotComponent)}}),[null==fe?void 0:fe.copilotList,_e,De]),Object(se.useEffect)((function(){if(J.isFeatureGateEnabledFromClient(Nv.IsChatHistoryPaginationEnabled)){var e=it.current;if(e){var t=0,n=!0,r=function(){it.current.scrollHeight-Math.round(it.current.scrollTop)-10<=it.current.clientHeight?n=!1:!at.current&&Hb&&!n&&Math.round(e.scrollTop)<=Math.round(it.current.scrollHeight/3)&&t!=e.scrollHeight&&(tr(!0),t=e.scrollHeight,dr(t),Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Vb(um.c.GetMessagesOperation,void 0,void 0,J)];case 1:return e.sent(),[2]}}))}))),Hb||e.removeEventListener("scroll",r)};e.addEventListener("scroll",r)}}}),[it.current,Tt]),Object(se.useEffect)((function(){var e;(null==(e=ue.documentSensitivityProps)?void 0:e.isEncrypted)?Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CLPEncryptedLabelSent}]):Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CLPNonEncryptedLabelSent}]),_b=e}),[ue.documentSensitivityProps]),Object(se.useEffect)((function(){So()||(It(!1),Xn(!1))}),[So]),Object(se.useEffect)((function(){lr((function(e){return Object(o.__assign)(Object(o.__assign)({},e),ue.copilotWorkflowProps)}))}),[ue.copilotWorkflowProps]),Object(se.useEffect)((function(){wo()}),[null===(j=ue.streamingUiProps)||void 0===j?void 0:j.cardDataValue,Kn,vt,Vt]),Object(se.useEffect)((function(){var e;if(vt)Te.sendLoggingEventToClient(Dm.QueryExecutionStarted);else{ny(dv),Te.sendLoggingEventToClient(Dm.QueryExecutionCompleted),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QueryExecutionCompleted}]),mS="";try{cy.getInstance().getIsBasicChatStreaming()&&cy.getInstance().resetBasicChatStreamingStates()}catch(e){gy("An error was thrown while trying to reset basic chat streaming. "+e)}}null===(e=_o.current)||void 0===e||e.setLocalIsExecuting(vt)}),[vt]),Object(se.useEffect)((function(){!dn&&(null==po?void 0:po.promptSuggestionList.length)>0&&(Te.sendLoggingEventToClient(Dm.ZQMLoaded),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ZQMLoaded}]))}),[dn]),Object(se.useEffect)((function(){return ft.current=new Xv(J.getHostSettings()),Do.current.updateLocale(Xv.getLanguage()),Ym.setTelemetryHandler($),pS=Fy.getInstance(),My.getInstance().initTelemetryLatencyObject(),Te.sendLoggingEventToClient(Dm.ChatPaneInitalized,{timestamp:(new Date).getTime()}),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatPaneInitialized},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),tb.getInstance(J),by()?Lb.getInstance(kt,kr):kt(!1),To(),bS=0,J.updateCopilotState(jm.IDLE),qr.current=new $y(tt,Ao,null==ve?void 0:ve.chatPlaceholderMessage,Co,Yn),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatInputEarlyLoadEnabled},{key:im.ChatEventParameters,value:J.isFeatureGateEnabledFromClient(Nv.ChatInputEarlyLoadEnabled)?"true":"false"}]),Sr(OS(gS)),function(e){p=e}(void 0!==re),function(){uy.getInstance().clearAugloopResponseTimer(),Ay.getInstance().releaseActiveAnnotations(),Ey(),Lb.resetInstance(),Ay.resetInstance(),uy.resetInstance(),tb.resetInstance(),Fm.resetInstance(),pb.resetInstance(),cy.resetInstance(),Ym.resetInstance()}}),[]),Object(se.useEffect)((function(){Pt&&(To(!0),At(!1))}),[Pt]),Object(se.useEffect)((function(){var e;wn||Vp(ko).catch((function(e){gy("pauseMicandStopTimer Error"+e),pb.Instance.ErrorMessage="Error_PauseMic_StopTimer"})),null===(e=tt.current)||void 0===e||e.setFocus()}),[wn]),Object(se.useEffect)((function(){window.addEventListener("blur",(function(){var e;null===(e=tt.current)||void 0===e||e.closeMenu(),vi(),(null==ve?void 0:ve.voiceInputProps)&&jn.current&&ko(!1)}))})),Object(se.useEffect)((function(){er?vt||(it.current.scrollTop=it.current.scrollHeight-ur):wo(),tr(!1),ht.current=Ze.length,dn&&Ze.length>0&&pn(!1)}),[Ze,dn]),Object(se.useEffect)((function(){Tt||(wo(),lt&&(ke.sendTelemetryLatencyData([{key:om.ChatHistoryTimeInLoad,value:OS(Ab)}]),ke.sendTelemetryLatencyData([{key:om.CopilotChatLoadTime,value:OS(me.current)}]),J.sendEventToClient(_m.CopilotChatLoaded),Te.sendLoggingEventToClient(Dm.ChatPaneLoaded,{timestamp:(new Date).getTime()}),br(OS(gS)),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatPaneLoaded},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),!dn&&(null==po?void 0:po.promptSuggestionList.length)>0&&(Te.sendLoggingEventToClient(Dm.ZQMLoaded),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ZQMLoaded}]))))}),[Tt,lt]),Object(se.useEffect)((function(){Tr&&(J.sendEventToClient(_m.ChatHistoryHydrationFailed),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatHistoryHydrationFailed}]),at.current=Tr,ri.onChatHistoryPluginInfo([]))}),[Tr]),Object(se.useEffect)((function(){var e;te.isDarkModeEnabled?(g(l.defaultBlack),Rn&&Rn.updateCurrentTheme(ju.dark)):(g(l.defaultWhite),Rn&&Rn.updateCurrentTheme(ju.light)),co&&Rn&&(null===(e=null==ue?void 0:ue.copilotWorkflowProps)||void 0===e?void 0:e.enableEditorForSelectFileStage)&&lr((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{handleEditorOpenButtonClick:fo})})),te.isHighContrastModeEnabled?m(!0):m(!1),rn(te),sn(re),Do.current.updateDarkMode(te.isDarkModeEnabled)}),[te,Rn]),Object(se.useEffect)((function(){var e,t;((null===(e=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===e?void 0:e.clearCacheSuggestionPills)||(null===(t=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===t?void 0:t.suggestionList.length)>0)&&qr.current.setSuggestedQnAList([])}),[null==ue?void 0:ue.suggestionPillsUiProps]),Object(se.useEffect)((function(){nt&&bt&&J&&(cy.getInstance(nt,J,bt),cy.getInstance().setBasicChatProps(ge))}),[ge]),Object(se.useEffect)((function(){var e;_n&&ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.TrySydneyToggle},{key:im.ChatEventParameters,value:(null===(e=ue.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[_n]),Object(se.useEffect)((function(){var e;ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.IsSydneyEnabled},{key:im.ChatEventParameters,value:(null===(e=ue.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[null===(P=ue.toggleUiProps)||void 0===P?void 0:P.trySydneyToggleChecked]),Object(se.useEffect)((function(){if(!we&&mo&&!Mn.current&&pt){var e=(new dp).createInstance();mo.telemLogger.logErrorTelemetry=function(e,t){ke.sendTelemetryErrorData([{key:am.ErrorMessage,value:t},{key:am.ErrorCategory,value:e}])},mo.telemLogger.logSuccessTelemetry=function(e,t){t?ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:e},{key:im.ChatEventParameters,value:t}]):ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:e}])},e.bootstrap(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{augloopSession:t})}(mo,pt)).then((function(t){Mn.current=e,Nn(t)}))}return function(){Mn.current&&Mn.current.shutdown().then((function(){Mn.current=void 0}))}}),[pt,mo]),Object(se.useEffect)((function(){$t((null==qt?void 0:qt.isError)&&(null==qt?void 0:qt.headerText)&&!dn&&!vt)}),[qt,dn,vt]),Object(se.useEffect)((function(){Ot(vt||(null==qt?void 0:qt.isError)||(null==ve?void 0:ve.isDisabled)||(null==be?void 0:be.isDisabled)||jo())}),[vt,qt,ve,be]),Object(se.useEffect)((function(){var e;be&&(null==be?void 0:be.groundingSourcePickerProps)&&!(null===(e=null==be?void 0:be.buttonProps)||void 0===e?void 0:e.groundingButtonEnabled)&&(fr(!0),fb=!0)}),[be]),Object(se.useEffect)((function(){_o.current.setIsDisabled(Ct)}),[Ct]),Object(se.useEffect)((function(){(null==go?void 0:go.copilotLabLink)&&Do.current.updateCopilotLabLink(null==go?void 0:go.copilotLabLink),(null==go?void 0:go.isCopilotLabHeaderDisabled)&&Do.current.updateIsHeaderDisabled(null==go?void 0:go.isCopilotLabHeaderDisabled),(null==go?void 0:go.facets)&&Do.current.updateFacets(null==go?void 0:go.facets)}),[go]),Object(se.useEffect)((function(){if(Do.current.updatePrompts(Dt),!(null==go?void 0:go.facets)){var e=(t=[],n=[],Dt.forEach((function(e){e.DisplayCategory&&!n.includes(e.DisplayCategory)&&n.push(e.DisplayCategory)})),n.forEach((function(e){t.push({value:e})})),t);Do.current.updateFacets({displayCategory:e})}var t,n}),[Dt]);var jo=function(){return J.isFeatureGateEnabledFromClient(Nv.IsDisableChatInputWhenAlSessionCloseEnabled)&&vn};Object(se.useEffect)((function(){var e,t,n;J.isFeatureGateEnabledFromClient(Nv.IsDisableChatInputWhenAlSessionCloseEnabled)&&(null===(e=tt.current)||void 0===e||e.setInputText(""),null===(t=tt.current)||void 0===t||t.setGhostText(null!==(n=null==ve?void 0:ve.chatPlaceholderMessage)&&void 0!==n?n:fv),Ot(vn),vn&&ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatInputDisabledAndBannerShownForInActiveChatSession}]))}),[J,vn]);var Po=function(e){return!!Si()&&(gy("Setting pane load warning banner as chat history is still loading."),hn||fn(!0),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ChatPaneLoadMessageBarShown},{key:im.ChatEventParameters,value:e.toString()}]),!0)},Ao=function(e){var t=e.text,n=e.links,i=e.telemetryData,a=e.queryAnnotations;return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,s,l,u,d,p,g,h;return Object(o.__generator)(this,(function(f){switch(f.label){case 0:return t&&0!==t.length||0!==Io().length?(mS=Object(fm.a)(),bS++,hS=(new Date).getTime(),Ee(),Ir.current&&(gy("First Query submitted by User"),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.FirstQuerySubmitted},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),Ym.getInstance().sendTelemetryLatencyData([{key:om.IsFirstSdxSessionQuery,value:!0}]),Ir.current=!1),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:null!=i?i:sm.EnterKeyPressed},{key:im.ChatEventParameters,value:(new Date).getTime().toString()}]),ty!==dv&&ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabPromptSubmitted}]),(null==a?void 0:a.length)>0&&(e=a.map((function(e){return e.QueryAnnotationType})),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.PromptSubmittedWithCIQ},{key:im.ChatEventParameters,value:JSON.stringify(e)}])),zt((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),J.updateCopilotState(jm.QUERY_ENTERED),J.sendEventToClient(_m.QuerySubmitted),pb.Instance.NewChatInitiated(),Dn(!0),(null==ve?void 0:ve.voiceInputProps)&&ko(!1),s=t?t.trim():Io().trim(),vS=s,l=function(){var e,t,n=null!==(t=null===(e=tt.current)||void 0===e?void 0:e.getImages())&&void 0!==t?t:[];return Object(o.__spreadArray)([],Object(o.__read)(n),!1)}(),function(e){var t;null===(t=tt.current)||void 0===t||t.setGhostText(e)}(null!==(g=null==ve?void 0:ve.chatPlaceholderMessage)&&void 0!==g?g:fv),function(){var e;null===(e=tt.current)||void 0===e||e.removeImages()}(),dn&&pn(!1),gy("User query Entered : ".concat(s)),function(e){var t;null===(t=tt.current)||void 0===t||t.setInputText(e)}(dv),Z===r.IOS&&et(zv.Shy),Zt(!1),cn(!1),bt(!0),l.length>0&&Co(c.ContentCard,{contentCardProps:{user:Bv.Chat,cardContent:{contentBody:se.createElement(se.Fragment,null,l.map((function(e,t){return se.createElement("img",{src:e,key:t,alt:"Visual content of chat prompt",width:"50px"})})))}}}),Co(c.MarkdownCard,{markDownCardProps:Cy(s,n)}),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.QuerySubmittedByUser},{key:im.IsMicrophoneInvolvedInQueryInput,value:dy.toString()}]),py(!1),[4,J.shouldSendRequestToAugloop(s,n,a,mS)]):[2];case 1:return f.sent()?s!==Cv()||(null===(h=ue.changeTopicUiProps)||void 0===h?void 0:h.hideChangeTopicButton)?[3,3]:(fS=!0,zt((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[Yy()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,Vb(um.c.AddChatOperation)]):(bt(!1),[2]);case 2:return f.sent(),[2];case 3:return f.trys.push([3,7,,8]),ut?[3,5]:[4,Qo()];case 4:f.sent(),f.label=5;case 5:return u=J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)?oi.getEnabledPlugins():[],[4,J.getDefaultSignalOperation(s,mS,Rb,n,a,u,l)];case 6:return d=f.sent(),uy.getInstance().setAugloopResponseTimer(d.workflowAnnotationType),Ay.getInstance().submitOperation(d.operation,d.workflowAnnotationType),J.updateCopilotState(jm.QUERY_SUBMITTED),gy("successfully submitted operation to AL : \n\n\n"+JSON.stringify(d.operation)+"\nat Time : "+new Date+"\n\n\n"),[3,8];case 7:return p=f.sent(),gy("CopilotChat Log: Exception:"+JSON.stringify(p)+" Error message: "+p.message),pb.Instance.ErrorMessage="Exception_Query_Submission_Failed",J.updateCopilotState(jm.QUERY_SUBMITTED_FAILED),uy.getInstance().clearAugloopResponseTimer(),Co(c.Default,{defaultMessageProps:{user:Bv.Chat,messageHeader:{text:"".concat("I'm still learning and can't do this just yet. Is there something else I can do to help")},embeddedLists:[]}}),J.updateCopilotState(jm.IDLE),ke.sendTelemetryErrorData([{key:am.ErrorMessage,value:"Error in handle submit: "+p.message},{key:am.ErrorType,value:ym.Client},{key:am.ErrorCode,value:Vv.HandleSubmitError},{key:am.ErrorCategory,value:rm.ChatEvents}]),ke.sendTelemetryLatencyData([{key:om.UserPerceivedLatency,value:OS(hS)},{key:om.IsQuerySuccess,value:!1}],!0),bt(!1),[3,8];case 8:return[2]}}))}))},_o=Object(se.useRef)(new nC(bt,zt,Ao,nt,tt,lo,At,mo?mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv:null==be?void 0:be.transfromFileNonCIQPlaceholderMessage,Ct)),Do=Object(se.useRef)(function(e,t,n){if(void 0===n&&(n=!1),ay)return ay;var r=[],o={origin:window.location.origin,columnSize:6,title:nv()?OfficeaicopilotStrings.CopilotPromptLibraryHeader:"Prompts from Copilot Lab",copilotLabButtonText:nv()?OfficeaicopilotStrings.CopilotLabLaunchertext:"See all prompts in Copilot Lab",copilotLabLink:"https://copilot.cloud.microsoft/prompts",prompts:[],bookmarks:[],facets:{displayCategory:[]},selectedFacets:{},width:55,height:55,isDarkMode:n,locale:Xv.getLanguage(),isHeaderDisabled:!1,onDialogLaunched:function(){gy("dialog launched!"),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabDialogLaunched}])},onPromptClicked:function(t){gy("prompt clicked",t),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabPromptItemClicked},{key:im.ChatEventParameters,value:"".concat(t.DisplayCategory)}]),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabDialogClosed}]),ny(t.PromptId),e.current.setInputAreaText(t.CommandText)},onFavoriteToggled:function(e,t){gy("favorited toggle favorited: ".concat(t,", prompt: "),e),Ay.getInstance().submitOperation(Yb(Qb.b.UserActivity,e.PromptId,t),$v.a.getTypeName());var n=o.prompts.map((function(n){var r=n;return e.Id===n.Id&&((r=e).UserActivity.Favorite.IsFavorite=t),r}));o.prompts=n,Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabSavedPromptClicked},{key:im.ChatEventParameters,value:t?Gv.Favourite:Gv.Unfavourite}]),r.forEach((function(e){return e({prompts:n})}))},onDialogDismissed:function(){gy("dialog dismissed"),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabDialogClosed}]),t.current.setMenuButtonFocus()},onFilterChanged:function(e){gy("filters changed",e)},onShowOnlyFavoriteToggled:function(e){gy("show only favorited toggled ".concat(e))},onGoToCopilotLabClicked:function(){gy("on go to copilot lab clicked"),Ym.getInstance().sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CopilotLabGoToCopilotLabButtonClicked}])}};return ay={register:function(e){return r.push(e),o},unregister:function(){},updateColumnSize:function(e){o.columnSize=e,r.forEach((function(t){return t({columnSize:e})}))},updateTitle:function(e){o.title=e,r.forEach((function(t){return t({title:e})}))},updateCopilotLabButtonText:function(e){o.copilotLabButtonText=e,r.forEach((function(t){return t({copilotLabButtonText:e})}))},updateCopilotLabLink:function(e){o.copilotLabLink=e,r.forEach((function(t){return t({copilotLabLink:e})}))},updatePrompts:function(e){o.prompts=e,r.forEach((function(t){return t({prompts:e})}))},updateBookmarks:function(e){o.bookmarks=e,r.forEach((function(t){return t({bookmarks:e})}))},updateFacets:function(e){o.facets=e,r.forEach((function(t){return t({facets:e})}))},updateSelectedFacets:function(e){o.selectedFacets=e,r.forEach((function(t){return t({selectedFacets:e})}))},updateDarkMode:function(e){o.isDarkMode=e,r.forEach((function(t){return t({isDarkMode:e})}))},updateLocale:function(e){o.locale=e,r.forEach((function(t){return t({locale:e})}))},updateIsHeaderDisabled:function(e){o.isHeaderDisabled=e,r.forEach((function(t){return t({isHeaderDisabled:e})}))}}}(_o,tt,te.isDarkModeEnabled)),Lo=function(e){Qt(ro.getProps(e)),Zt(ro.shouldShowHintCard(e))},Mo=function(){Ho()?Je([]):J.sendEventToClient(_m.ChatTopicChanged),fS=!1,bt(!1)},Bo=function(){ny(dv),gy("Change Topic Button Clicked."),qr.current.setSuggestedQnAList([]),Ao({text:Cv()})},Ro=se.useCallback((function(e){e.length>0?Mr((function(t){return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(e),!1)})):Gr(!0),_r(!1),Ur(!1)}),[]),Fo=se.useCallback((function(e){e&&Je((function(t){return e(t)})),bt(!1),Wr.current=!1}),[]),No=se.useCallback((function(){Fr(!1),Qr.current=!0}),[]),Ho=se.useCallback((function(){var e;return null===(e=ue.chatHistoryUiProps)||void 0===e?void 0:e.enableChatHistoryV2}),[ue]),Uo=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return be&&(J.isFeatureGateEnabledFromClient(Nv.IsPersistanceInPhase2UxEnabled)&&(null==be?void 0:be.pluginsInfo)&&(null===(r=null==be?void 0:be.pluginsInfo)||void 0===r?void 0:r.length)>0||J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled))?(e=function(e){var t,n,r;J.sendEventToClient(_m.PluginsStateUpdated,e);var o,i,a,s=!1,l=e.pluginsInfo.findIndex((function(e){return e&&e.id===Qv.ENTERPRISE_SEARCH&&e.state===Jv}))>=0;J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)?s=e.pluginsInfo.findIndex((function(e){return e&&e.id===Qv.WEB_SEARCH&&e.state===Jv&&e.isEnabled}))>=0:(l=null!==(n=(null===(t=null==be?void 0:be.pluginsInfo.find((function(e){return e.id===lp.Work})))||void 0===t?void 0:t.state)===mp.Enabled)&&void 0!==n?n:l,s=(null===(r=null==be?void 0:be.pluginsInfo.find((function(e){return e.id===lp.Web})))||void 0===r?void 0:r.state)===mp.Enabled),o=l,i=s,a=lp.CurrentContext.toString(),o&&(a+="+Work"),i&&(a+="+Web"),hb=a},t=(new Date).getTime(),[4,LO(null==be?void 0:be.pluginsInfo,oi,e,J.isFeatureGateEnabledFromClient(Nv.IsWebSearchDefaultOn),J.isFeatureGateEnabledFromClient(Nv.IsEnterpriseSearchDefaultOn))]):[2];case 1:return n=o.sent(),ke.sendTelemetryLatencyData([{key:om.PluginsConfig3SFetchTime,value:OS(t)}]),gy("resolved plugins initial state using copilot brokering WF annotations"),Ht("OnWithAllowList"===oi.getRestrictedSearchMode()||J.isFeatureGateEnabledFromClient(Nv.ShowRestrictiveSearchBanner)),ir(n),ho=0,[2]}}))}))},Vo=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,r,i;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return t=(new Date).getTime(),gS=t,Ln?[3,2]:[4,J.getALSession()];case 1:return r=a.sent(),gt(r),[3,5];case 2:return[4,(s=J.getAuthToken(),l=!1,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.e(2).then(n.bind(null,1063))];case 1:return e=r.sent(),l||(t={serviceUrl:Xv.getAugloopUrl(),appName:Xv.getAppName(),appVersion:Xv.getAppVersion(),authToken:s,releaseAudienceGroup:null,releaseChannel:null,releaseFork:null,flights:Xv.getAugloopFlights()},e.StartInitializingRuntimeManage(t)),[4,e.EnsureAugloopRuntimeManager()];case 2:return[2,r.sent()]}}))})))];case 3:return[4,a.sent().getSession()];case 4:r=a.sent(),gt(r),a.label=5;case 5:Ay.getInstance(nt,J,r,bt,bn),uy.getInstance(J,xo),cy.getInstance(nt,J,bt),cy.getInstance().setBasicChatProps(ge),ke.sendTelemetryLatencyData([{key:om.AugloopInitializationTime,value:OS(t)}]),Te.sendLoggingEventToClient(Dm.ALSessionInitialized,{timeInMs:SS(t)}),a.label=6;case 6:return a.trys.push([6,10,,11]),[4,Qo(e)];case 7:return a.sent(),uo?[3,9]:[4,Xo(r)];case 8:a.sent(),a.label=9;case 9:return gy("Augloop Initialized. Time Taken : ".concat(OS()," sec")),[3,11];case 10:throw i=a.sent(),gy("Failure in Augloop Initialization: "+JSON.stringify(i)+" Error message: "+i.message),ke.sendTelemetryErrorData([{key:am.ErrorMessage,value:"Failure in Augloop Initialization: "+i.message},{key:am.ErrorType,value:ym.Client},{key:am.ErrorCode,value:Vv.AugloopInitializationError},{key:am.ErrorCategory,value:rm.Augloop}]),i;case 11:return Uo(),[2]}var s,l}))}))};function zo(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,s,l,c,u;return Object(o.__generator)(this,(function(d){switch(d.label){case 0:gy("sharedAugloopAnnotationHandler op: ",e),d.label=1;case 1:d.trys.push([1,22,23,24]),n=Object(o.__values)(e.items),r=n.next(),d.label=2;case 2:if(r.done)return[3,21];switch(i=r.value,pb.Instance.Observe(i.body),(null==(a=null===(t=i.body)||void 0===t?void 0:t.H_)?void 0:a.T_)&&ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALAnnotationReceived},{key:im.ChatEventParameters,value:null==a?void 0:a.T_}]),null==a?void 0:a.T_){case dm.a.getTypeName():case dm.c.getTypeName():case dm.b.getTypeName():return[3,3];case gm.b.getTypeName():return[3,4];case gm.a.getTypeName():return[3,7];case gm.c.getTypeName():return[3,10];case $v.a.getTypeName():return[3,13];case hm.a.getTypeName():return[3,15];case pm.a.getTypeName():return[3,17];case lb.a.getTypeName():return[3,18]}return[3,20];case 3:return zb(i,Je,ht.current,J,fS?Mo:void 0,(function(e){return ri.onChatHistoryPluginInfo(e)}),Ro,Wr.current?Fo:void 0,Ho()),[3,20];case 4:return[4,J.shouldIgnoreResponse(i)];case 5:return d.sent()?[2]:[4,pC(i,nt,bt,hS)];case 6:return d.sent(),[3,20];case 7:return[4,J.shouldIgnoreResponse(i)];case 8:return d.sent()?[2]:[4,dC(i,nt,bt,hS)];case 9:return d.sent(),[3,20];case 10:return[4,J.shouldIgnoreResponse(i)];case 11:return d.sent()?[2]:[4,hC(i,qr.current)];case 12:return d.sent(),[3,20];case 13:return[4,Zb(i,Lt)];case 14:return d.sent(),[3,20];case 15:return[4,vC(i,Eo)];case 16:return d.sent(),[3,20];case 17:return s=i.body,ni.onOperationResponse(s.queryId,s.operationResponse),[3,20];case 18:return[4,BO()];case 19:return d.sent(),[3,20];case 20:return r=n.next(),[3,2];case 21:return[3,24];case 22:return l=d.sent(),c={error:l},[3,24];case 23:try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 24:return[2]}}))}))}function Go(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,s,l,c;return Object(o.__generator)(this,(function(u){switch(u.label){case 0:gy("clientSpecificAugloopAnnotationHandler op: ",e),u.label=1;case 1:u.trys.push([1,7,8,9]),n=Object(o.__values)(e.items),r=n.next(),u.label=2;case 2:return r.done?[3,6]:(i=r.value,(null==(a=null===(t=i.body)||void 0===t?void 0:t.H_)?void 0:a.T_)&&ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.ALAnnotationReceived},{key:im.ChatEventParameters,value:null==a?void 0:a.T_}]),tb.getInstance().isWorkflowRegistered(null==a?void 0:a.T_)?tb.getInstance().isAugloopResponseTimeoutRequired(null==a?void 0:a.T_)?[4,J.shouldIgnoreResponse(i)]:[3,4]:[3,5]);case 3:if(u.sent())return[2];uy.getInstance().clearAugloopResponseTimer(),u.label=4;case 4:pb.Instance.Observe(i.body),J.sendResponseToClient(i),u.label=5;case 5:return r=n.next(),[3,2];case 6:return[3,9];case 7:return s=u.sent(),l={error:s},[3,9];case 8:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(l)throw l.error}return[7];case 9:return[2]}}))}))}var Wo,Qo=function(e){return void 0===e&&(e=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=(new Date).getTime(),gS=t,n=[],[4,null===(s=null===(a=J.getHostSettings())||void 0===a?void 0:a.getDocumentUrlAsync)||void 0===s?void 0:s.call(a)];case 1:return r=o.sent(),tb.getInstance().getWorkflowDataMap(e).forEach((function(e){gy("send activate annotation request for workflow: ",e.workflowInfo.workflowAnnotationType),n.push(Ay.getInstance().activateAnnotation(e.workflowInfo.workflowAnnotationType,e.workflowInfo.shouldHandleResponse?zo:Go,e.workflowInfo.config,r,e.workflowInfo.forceReturnCachedAnnotations))})),[4,Promise.all(n)];case 2:return o.sent(),ke.sendTelemetryLatencyData([{key:om.AnnotationActivationTime,value:OS(t)}]),Te.sendLoggingEventToClient(Dm.AnnotationActivated,{timeInMs:SS(t)}),gy("AnnotationActivationTime. Time Taken :  ".concat(OS()," sec")),ct(!0),[3,4];case 3:throw i=o.sent(),ct(!1),gy("Failed to activate annotations: ".concat(i.message)),ke.sendTelemetryErrorData([{key:am.ErrorMessage,value:"Failure in Activating Annotation: "+i.message},{key:am.ErrorType,value:ym.Server},{key:am.ErrorCode,value:Vv.ActivateAnnotationError},{key:am.ErrorCategory,value:rm.Augloop}]),i;case 4:return[2]}}))}))},qo=function(){return J.getPythonMode()&&!vt},Ko=function(){var e;return Me&&Ze.length>0&&!(null===(e=ue.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Ho()},Yo=function(e){var t,n,r,o,i,a;if(!(!jn.current||vt||null!=tt.current&&(null===(t=tt.current)||void 0===t?void 0:t.getInputText().length)>=(ue.chatInputProps?cv:uv))){py(!0);var s=(null===(n=tt.current)||void 0===n?void 0:n.getInputText().length)>0&&yo?" ":dv,l=null!=tt.current?(null===(r=tt.current)||void 0===r?void 0:r.getInputText())+s+e:dv;null===(o=tt.current)||void 0===o||o.setInputText(l),null===(i=tt.current)||void 0===i||i.setGhostText(dv),null===(a=tt.current)||void 0===a||a.setFocus(),gy("final text passing here: "+e)}},Zo=function(e){var t,n,r;if(!(!jn.current||vt||null!=tt.current&&(null===(t=tt.current)||void 0===t?void 0:t.getInputText().length)>=(ue.chatInputProps?cv:uv))){var o=(null===(n=tt.current)||void 0===n?void 0:n.getInputText().length)>0&&yo?" ":dv;null===(r=tt.current)||void 0===r||r.setGhostText(o+e),gy("ghost text passing here: "+e),py(!0),e.trim()&&Gp(bv,ko),gy("Voice response - Partial Text: "+e)}},Jo=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){et(zv.Expanded),e()}))];case 1:return e.sent(),[2]}}))}))},Xo=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return(null==ve?void 0:ve.voiceInputProps)?(t=(new Date).getTime(),n=qp(ve.voiceInputProps.voiceInputLocale),[4,Fp(n,Yo,Zo,On,ko,e)]):[3,2];case 1:r.sent(),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophoneInitializationTimeInMs},{key:im.ChatEventParameters,value:SS(t).toString()}]),yo=Kp(qp(n)),ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.MicrophoneSuccessfullyInitialized}]),r.label=2;case 2:return[2]}}))}))},$o=function(e){J.isFeatureGateEnabledFromClient(Nv.IsClpSensitivityInChatInputEnabled)&&"File"===(null==e?void 0:e.type)&&(Xn(!0),It(!0),function(e){Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(o.__generator)(this,(function(o){return t=Ym.getInstance(),n=new mC.a({type:e.type,id:e.url}),r=new ub.b({parentPath:["Signal",mC.a.getTypeName()],items:[{id:db.a.generateId(),body:n}]}),gy("Submitting signal to Augloop : ".concat(mC.a.getTypeName()," signal: ").concat(JSON.stringify(n))),t.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.EntityLabelOperationSubmitted},{key:im.ChatEventParameters,value:"".concat(mC.a.getTypeName(),"_").concat(r)}]),Ay.getInstance().submitOperation(r,mC.a.getTypeName()),[2]}))}))}(e))},ei=new uC(wn,En,Cn,null===(A=null==ve?void 0:ve.voiceInputProps)||void 0===A?void 0:A.microphonePermissionErrorTitle,null===(_=null==ve?void 0:ve.voiceInputProps)||void 0===_?void 0:_.microphonePermissionErrorMessage,xn,On,ko,tt,null!==(D=null==ve?void 0:ve.chatPlaceholderMessage)&&void 0!==D?D:fv,null===(L=null==ve?void 0:ve.voiceInputProps)||void 0===L?void 0:L.microphonePermissionImagePath,null===(M=null==ve?void 0:ve.voiceInputProps)||void 0===M?void 0:M.showMicrophonePermissionHelpLink,Po),ti=function(e){var t=e.isWebSearchDefaultOn,n=e.logGroundingSourceEvent,r=le.a.useMemo((function(){return new iS}),[]),o=le.a.useMemo((function(){return new sS}),[]),i=le.a.useMemo((function(){return new lS(r,o,{isWebSearchDefaultOn:t,logGroundingSourceEvent:n})}),[r,o]);return{pluginConfigService:r,chatHistoryEnabledPluginsSource:o,pluginDataProvider:i}}({isWebSearchDefaultOn:J.isFeatureGateEnabledFromClient(Nv.IsWebSearchDefaultOn),logGroundingSourceEvent:!(null===(B=null==be?void 0:be.pluginsInfo)||void 0===B?void 0:B.length)}),ni=ti.pluginConfigService,ri=ti.chatHistoryEnabledPluginsSource,oi=ti.pluginDataProvider,ii=void 0,ai=void 0;if(J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)){var si=se.useMemo((function(){return new DO(xe)}),[xe]),li=se.useMemo((function(){return new EO(xe)}),[xe]),ci=se.useMemo((function(){return new zC(li.getUserContext(),li.getHostContext(),si)}),[li,si]),ui=se.useMemo((function(){return new wO(ni)}),[ni]),di=se.useMemo((function(){return new PO(ni)}),[ni]),pi=se.useMemo((function(){return new SO(ci,ui,di)}),[ci,ui,di]);ai={cardServices:{appService:ui,channelService:di,tokenService:si},activityProvider:pi};ii=new aO(oi,pi,(function(e,t){var n;t&&(null==fe?void 0:fe.showSystemMessageOnPluginEnabled)&&"FirstParty"!==e.type&&nt.setChatMessageData(c.Default,{defaultMessageProps:{user:Bv.Chat,messageHeader:{text:(n=e.name,"Great! ".concat(n," has been successfully added and is ready to improve your Copilot experience."))}}})}),(function(){}),void 0,ui)}var gi=se.useMemo((function(){var e,t,n;return{appService:null===(e=null==ai?void 0:ai.cardServices)||void 0===e?void 0:e.appService,tokenService:null===(t=null==ai?void 0:ai.cardServices)||void 0===t?void 0:t.tokenService,channelService:null===(n=null==ai?void 0:ai.cardServices)||void 0===n?void 0:n.channelService,clientInfo:xe,taskModuleLauncher:Ie}}),[xe]);Wo=se.useMemo((function(){return new ie(gi)}),[gi]);var hi=(null==be?void 0:be.groundingSourcePickerProps)?Object(o.__assign)(Object(o.__assign)({},null==be?void 0:be.groundingSourcePickerProps),{onSelection:function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return function(e){hb=e}(t.id.toString()),null===(n=null==e?void 0:e.onSelection)||void 0===n||n.call(e,t),hr?[4,Vb(um.c.AddChatOperation)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}}(null==be?void 0:be.groundingSourcePickerProps)}):void 0,fi=(null==be?void 0:be.pluginsInfo)&&(null==be?void 0:be.pluginsInfo.length)>0||J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)?{plugins:null==be?void 0:be.pluginsInfo,pluginBlockedInfo:or,onGroundingButtonClick:function(){ho=void 0===or&&-1===ho?window.setTimeout((function(){void 0===or&&(gy("Failed to timely resolve plugins initial state after ".concat(4e3,"ms of Grounding button click.")),ir([])),ho=0}),4e3):0},copilotPluginFlyoutProps:J.isFeatureGateEnabledFromClient(Nv.IsCopilotPluginEnabled)?{pluginProvider:ii,isPreview:!0}:void 0}:void 0,mi=ue.chatInputProps?new zy(tt,Ct,dn,pn,ue.menuProps,Ao,Lo,lo(),Jo,mo&&mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv,mo?mo.ciqPlaceholderText?mo.ciqPlaceholderText:Kv():dv,Wn,Oo(),J,null==ve?void 0:ve.chatPlaceholderMessage,(null==ve?void 0:ve.voiceInputProps)?ei.getMicrophoneButtonProps():void 0):new Wy(tt,Oy(nn),(an||nn).isDarkModeEnabled,null!==(R=(an||nn).dir)&&void 0!==R?R:void 0,Ct,Et,dn,pn,J,null==be?void 0:be.menuProps,Ao,Lo,lo(),mo?mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv:(null==be?void 0:be.transfromFileNonCIQPlaceholderMessage)?null==be?void 0:be.transfromFileNonCIQPlaceholderMessage:dv,mo?mo.ciqPlaceholderText?mo.ciqPlaceholderText:Kv():dv,Wn,Oo(),null==be?void 0:be.chatPlaceholderMessage,(null==be?void 0:be.voiceInputProps)?Object(o.__assign)(Object(o.__assign)({},null==be?void 0:be.voiceInputProps),{alSession:pt,microphoneButtonProps:ei.getMicrophoneButtonProps()}):void 0,null===(F=null==be?void 0:be.buttonProps)||void 0===F?void 0:F.ciqButtonEnabled,null===(N=null==be?void 0:be.buttonProps)||void 0===N?void 0:N.groundingButtonEnabled,hi,fi,Po,we?{editorConfig:mo,alSession:pt,handleInChatInput:we,postCIQItemSelectionHandler:$o}:void 0,Jn,null==be?void 0:be.isVersion3Enabled,null==be?void 0:be.characterLimitErrorMessage,null==be?void 0:be.imageInputEnabled,ye,Ce,Oe,Se);Z===r.IOS&&(bo=new Qy(tt,Ct,dn,pn,ue.menuProps,Ao,Lo,Rn,Jo,mo&&mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv,J,null!==(U=null!==(H=null==ve?void 0:ve.chatRestShyPlaceholderMessage)&&void 0!==H?H:null==be?void 0:be.chatRestShyPlaceholderMessage)&&void 0!==U?U:"Ask a question"));var vi=function(){var e;Z===r.IOS&&(null===(e=tt.current)||void 0===e?void 0:e.getInputText())===dv&&et(zv.Shy)};function bi(){if(Z!==r.IOS)if(Pe)1==window.devicePixelRatio&&Ae(!1);else{var e=document.getElementById(Yv);if(e)e.getBoundingClientRect().height<=0&&Ae(!0)}}Object(se.useEffect)((function(){var e;null===(e=So())||void 0===e||e.setLoading(Jn)}),[Jn]),Object(se.useEffect)((function(){if(Z!==r.IOS)return bi(),window.addEventListener("resize",bi),function(){window.removeEventListener("resize",bi)}})),Object(se.useEffect)((function(){if(we||!Rn||!Un||Gn||Qr.current||(Rn.uninitialize($u),Vn(void 0)),lo()&&(_o.current=new nC(bt,zt,Ao,nt,tt,lo,At,mo?mo.ciqPlaceholderText?mo.ciqPlaceholderText:Kv():null==be?void 0:be.transfromFileNonCIQPlaceholderMessage,Ct)),!we&&mo&&Gn&&!Un&&Rn&&tt.current&&!Qr.current){var e=Rn.initializeCiq(tt.current.getInputSpanElement(),{menuTitle:mo.transformFileMenuTitle,menuSubtitle:mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv,queryCharToUse:$u,onItemSelected:function(t){var n,r,o,i,a,s,l,c,u,d;if(ke.sendTelemetryChatEventData([{key:im.ChatEventType,value:sm.CIQSuggestionSelected},{key:im.ChatEventParameters,value:null!==(o=null===(r=null===(n=t.suggestion)||void 0===n?void 0:n.queryAnnotation)||void 0===r?void 0:r.QueryAnnotationType)&&void 0!==o?o:dv}]),Er.current)return null===(i=xr.current)||void 0===i||i.addUserContentMessageItem((u=t.suggestion,d=Zv,(null==u?void 0:u.url)&&((null==u?void 0:u.url.includes("docx"))?d=Zv:(null==u?void 0:u.url.includes("pptx"))?d="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg":(null==u?void 0:u.url.includes("xlsx"))&&(d="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg")),{iconUrl:d,boldText:null==u?void 0:u.text}),!0),Er.current=!1,void(null===(a=tt.current)||void 0===a||a.setGhostText(null!==(s=null==ve?void 0:ve.chatPlaceholderMessage)&&void 0!==s?s:fv));null===(l=tt.current)||void 0===l||l.setGhostText(dv),null===(c=tt.current)||void 0===c||c.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,Jn,Oy(nn),(an||nn).isDarkModeEnabled,Pn),$o(t.suggestion)},entitiesEnabled:mo.entitiesSupported,ExpanededECC:mo.isExpandedECCEnabled});e.setHVCAppChatV2Enabled(ye),Vn(e)}Qr.current=!1}),[Rn,Un,Gn]);var yi=function(){var e,t;return null!==(t=null===(e=sb.getInstance())||void 0===e?void 0:e.getLogs())&&void 0!==t?t:""},Ci=new eC(tt,Ao,Lo,Ct,lo(),mo?mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv:(null==be?void 0:be.transfromFileNonCIQPlaceholderMessage)?null==be?void 0:be.transfromFileNonCIQPlaceholderMessage:dv,Jo),Oi=new MO(tt,Ao,Ct,lo(),mo?mo.transformFilePlaceholderText?mo.transformFilePlaceholderText:dv:(null==be?void 0:be.transfromFileNonCIQPlaceholderMessage)?null==be?void 0:be.transfromFileNonCIQPlaceholderMessage:dv,Jo,ye,Oe),Si=function(){return J.isFeatureGateEnabledFromClient(Nv.ChatInputEarlyLoadEnabled)&&(Tt||!lt)},Ei=function(){return jo()?nv()?OfficeaicopilotStrings.InActiveChatSessionErrorString:"This chat session has ended. Please close and reopen this app for a new session.":nv()?OfficeaicopilotStrings.PaneLoadingUIString:"Please wait for the pane to finish loading"},xi=function(){return Si()&&hn||jo()&&!vt?{chatInputBannerString:Ei()}:void 0},Ii=function(){return!vt&&ue.showSuggestionButtonProps};return J.isFeatureGateEnabledFromClient(Nv.ChatInputEarlyLoadEnabled)||!Tt&&lt?fe&&fe.showCopilotSwitcherMenu&&Le&&De&&_e&&De!==_e?se.createElement(CC,{theme:re?an:nn,shouldUseFluentV9Tokens:We,dir:re?an.dir:nn.dir},se.createElement(pe,{style:Pe?qe.chatUiStackZoom:qe.chatUiStack},se.createElement(Ue,{isMenuOpen:He,onMenuStateChange:Ge,handleCopilotChatChange:fe.handleCopilotChatChange,copilotList:fe.copilotList,showNewChatButtonOnTop:Ko(),isExecuting:vt,handleChangeTopicButtonClick:Bo}),se.createElement(Ve,{componentToRender:Re}))):Ho()&&Rr?se.createElement(CC,{theme:re?an:nn,shouldUseFluentV9Tokens:We,dir:re?an.dir:nn.dir},se.createElement(pe,{style:Pe?qe.chatUiStackZoom:qe.chatUiStack},se.createElement(nS,{setChatLog:Je,currentChatId:Rb,setIsExecuting:bt,setLoadingComponentProps:zt,suggestionPillsBuilderRef:qr,createAndSubmitChatHistorySignal:Vb,resetToNewConversation:Gb,setChatHistoryMenuData:Mr,handleChatHistoryPanelClose:No,isSwitchingConversation:Wr,isChatHistoryMenuLoading:Ar,chatHistoryMenuData:Lr,isChatHistoryPanelFetchingMoreChats:Hr,setIsChatHistoryPanelFetchingMoreChats:Ur,isEndOfChatHistory:zr}))):se.createElement(CC,{theme:re?an:nn,shouldUseFluentV9Tokens:We,dir:re?an.dir:nn.dir},se.createElement(pe,{style:Pe?qe.chatUiStackZoom:qe.chatUiStack},fe&&fe.showCopilotSwitcherMenu&&se.createElement(Ue,{isMenuOpen:He,onMenuStateChange:Ge,handleCopilotChatChange:fe.handleCopilotChatChange,copilotList:fe.copilotList,showNewChatButtonOnTop:Ko(),isExecuting:vt,handleChangeTopicButtonClick:Bo}),Si()&&se.createElement(xC,{className:Pe?qe.chatFreStackZoom:qe.chatFreStack}),$r&&ue.toggleUiProps&&se.createElement(Qe,Object(o.__assign)({},eo.getTryReviewerAgentProps(ue.toggleUiProps,!1,"Reviewer Agent"))),Xr&&se.createElement(Qe,Object(o.__assign)({},eo.getTryWebChatProps(Bt,(function(e,t){var n=null==t?void 0:t.checked;gy("Toggling Try Web chat to "+(n?"on":"off")),Rt(null!=n&&n)}),"Try Web Chat"))),Bt&&se.createElement("iframe",{src:null!==(z=null===(V=null==ue?void 0:ue.toggleUiProps)||void 0===V?void 0:V.webSearchUrl)&&void 0!==z?z:"https://edgeservices.bing.com/edgesvc/chat?udsframed=1&form=SHORUN&clientscopes=chat,noheader,udsedgeshop,channelcanary,ntpquery,devtoolsapi,udsinwin11,clipboardcontext,udsdlpconsent,udscstart,cspgrd&lightschemeovr=1",title:"Web Chat",height:"100%",allow:"clipboard-write;microphone;camera"}),!Bt&&se.createElement(se.Fragment,null,!Tt&&lt&&se.createElement(se.Fragment,null,Zr&&ue.toggleUiProps&&se.createElement(Qe,Object(o.__assign)({},eo.getTrySydneyProps(ue.toggleUiProps,_n,"Try Sydney"))),Jr&&ue.toggleUiProps&&se.createElement(Qe,Object(o.__assign)({},eo.getTryEnterpriseSearchProps(ue.toggleUiProps,!1,"Enterprise Search Mode"))),Xv.isDevbuild()&&(null==he?void 0:he.isDebugToggleEnabled)&&!vo()&&se.createElement(xt,Object(o.__assign)({},to.getDebugSectionProps(yi,null!==(G=null==he?void 0:he.conversationId)&&void 0!==G?G:"",null==he?void 0:he.telemetryData))),Xv.isDevbuild()&&vo()&&se.createElement(tn,Object(o.__assign)({},no.getDebugSectionProps(yi,null!==(W=null==he?void 0:he.conversationId)&&void 0!==W?W:"",null==he?void 0:he.telemetryData,null==he?void 0:he.sessionId,null==he?void 0:he.conversationLogObject,null==he?void 0:he.debugMessageInfoObject,null==he?void 0:he.showDebugInfoMessage,null==he?void 0:he.setShowDebugInfoOnMessage,vr,Or,null==he?void 0:he.sydneyConversationObject,null==he?void 0:he.augloopKustoQueryURL,null==he?void 0:he.clientKustoQueryURL,J.getHostSettings().appName,Z,null==he?void 0:he.sdxVersion))),se.createElement(Xu.a,{id:Yv,className:Pe?qe.chatFreStackZoom:qe.chatFreStack,ref:it},co&&se.createElement(Fn,Object(o.__assign)({ref:xr},sr)),J.isFeatureGateEnabledFromClient(Nv.EnableRestrictiveSearchBanner)&&Nt&&se.createElement(qn,Object(o.__assign)({},ao.getProps((function(){Ht(!1)})))),dn?se.createElement(nr,Object(o.__assign)({},Yr.getProps((function(){pn(!1)}),ue.freUiProps))):(null==po?void 0:po.promptSuggestionList.length)>0&&(ue.zeroQueryMessageProps?se.createElement(gr,Object(o.__assign)({},Ci.getProps(ue.zeroQueryMessageProps))):se.createElement(yr,Object(o.__assign)({},Oi.getProps(ue.zeroQueryMessageV2Props)))),Ho()&&se.createElement(jr,{onClick:function(){Nb=null,Vb(um.c.GetAllChatsOperation),_r(!0),Mr([]),Fr(!0),Gr(!1),Ur(!1)}}),se.createElement("div",{id:"messagesStartID",ref:ot}),Ze.length>0&&se.createElement(Bl,Object(o.__assign)({},nt.getProps(Ze,ue.chatContainerUiProps),{designerProps:de,customMessageRenderers:ue.customMessageRenderers,pluginServiceProvider:ai,msgExtCardContextProvider:Wo})),Ii()&&se.createElement(Hl,Object(o.__assign)({},so.getProps(ue.showSuggestionButtonProps))),function(){var e;return!vt&&Ze.length>0&&!(null===(e=ue.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Ho()}()&&!qo()&&!Ii()&&!Me&&se.createElement(Gl,Object(o.__assign)({},oo.getProps(Bo))),qo()&&se.createElement(Kl,Object(o.__assign)({},io.getProps((function(){bt(!1),J.sendEventToClient(_m.PythonExitAnalysisButtonClicked),J.updateCopilotState(jm.IDLE),gy("Python Exit Analysis Button Clicked.")})))),vt&&(null===(Q=Vt.shouldShowLoadingUi)||void 0===Q||Q)&&se.createElement(kn,Object(o.__assign)({},Kr.getProps(Vt,(function(){cy.getInstance().getIsBasicChatStreaming()&&(cy.getInstance().updateCardWithFooter(),ke.logErrorWithAshaVetoAndError([],cy.getInstance().getFeatureName(),dv,Om.BasicChatUserCancelledResponse,Em.UserAbortedQueryExecution),cy.getInstance().resetBasicChatStreamingStates(!0,!1)),pb.Instance.ErrorMessage="Stop_Generation_Clicked",bt(!1),J.sendEventToClient(_m.StopGeneratingButtonClicked),uy.getInstance().clearAugloopResponseTimer(),Ay.getInstance().clearOperationListForResubmit(),J.updateCopilotState(jm.IDLE),gy("Stop Generation Button Clicked.")})))),se.createElement("div",{ref:rt})),function(){var e,t;return!Ct&&((null===(t=null===(e=null==ue?void 0:ue.suggestionPillsUiProps)||void 0===e?void 0:e.suggestionList)||void 0===t?void 0:t.length)>0||Kn.length>0)&&(gy("Suggestion Pills are shown"),!0)}()&&se.createElement(rc,Object(o.__assign)({},qr.current.getProps(ue.suggestionPillsUiProps,Kn))),Yt&&se.createElement(hc,Object(o.__assign)({},Wt)),Z===r.IOS&&$e===zv.Shy&&!vt&&bo&&se.createElement(Uc,Object(o.__assign)({},bo.getProps((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,Jo()];case 1:return t.sent(),null===(e=tt.current)||void 0===e||e.setFocus(),[2]}}))}))})))),Xt&&se.createElement(Wc,Object(o.__assign)({},qt))),ue.chatInputProps?(Z!=r.IOS||$e===zv.Expanded&&!vt)&&se.createElement(Ju,Object(o.__assign)({ref:tt},mi.getProps(vi,xi()))):se.createElement(cm,Object(o.__assign)({ref:tt},mi.getProps(Dt,xi())))))):se.createElement(ce,{theme:nn},se.createElement("div",null,se.createElement(qd.a,{appearance:"primary",className:qe.spinner})))}));yS.displayName="CopilotChat";var CS=function(){pS=null,null,gS=null,hS=null,fS=!1},OS=function(e){return((new Date).getTime()-(null!=e?e:gS))/1e3},SS=function(e){return(new Date).getTime()-(null!=e?e:gS)},ES=function(e){fS=e}},3507:function(e,t,n){"use strict";n.d(t,"a",(function(){return TS}));var r,o=n(2);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(r||(r={}));var i=r.web,a=function(){return i};function s(){return i===r.IOS}var l;!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(l||(l={}));var c,u=l.defaultWhite,d=!1,p=!1,g=function(e){u=e},h=function(){return u},f=function(){return d},m=function(e){d=e},v=function(){return p};!function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.Designer=8]="Designer",e[e.CopilotWorkflowMessage=9]="CopilotWorkflowMessage",e[e.WarningMessage=10]="WarningMessage",e[e.PaginatedCard=11]="PaginatedCard",e[e.ProactiveSuggestionCard=12]="ProactiveSuggestionCard",e[e.ReviewerSummaryCard=13]="ReviewerSummaryCard",e[e.ReviewAgentCard=14]="ReviewAgentCard"}(c||(c={}));var b,y=n(2173),C=n(2089),O=n(54),S=n(1531),E=n(2823),x=n(65),I=n(89),w=function(){return U()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},T="",k=n(1627),j=n(2445),P=Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),A=Object(o.__assign)(Object(o.__assign)({},j.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),_=Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"});!function(e){e[e.Regular=0]="Regular",e[e.Ghost=1]="Ghost",e[e.File=2]="File",e[e.Skill=3]="Skill"}(b||(b={}));var D=Object(E.a)(P),L="group",M="list",B="listitem",R="menu",F="menuitem",N="button",H="alert",U=function(){return"undefined"!=typeof OfficeaicopilotStrings},V=function(e){var t;return null===(t=Object.values(S.b).filter((function(t){return t===e})))||void 0===t?void 0:t[0]},z=function(e){var t,n=document.getElementById(e),r=n.cloneNode(!0);G(n,r);var o=r.outerHTML.replace(ne,"");return null===(t=r.parentNode)||void 0===t||t.removeChild(r),o};function G(e,t){var n=document.createElement("div");document.body.appendChild(n);for(var r=getComputedStyle(e),o=getComputedStyle(n),i=[],a=0;a<r.length;a++){var s=r[a],c=r.getPropertyValue(s),u=o.getPropertyValue(s),d=h();d!==l.defaultBlack&&d!==l.defaultDarkGrey||"color"===s&&(c=D.black),c!==u&&i.push("".concat(s,": ").concat(c))}t.setAttribute("style",i.join(";"));for(var p=e.children,g=t.children,f=0;f<p.length;f++){G(p[f],g[f])}n.remove()}var W=function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n]);return e},Q=function(e,t){var n=[],r=e.body;return function(e){var t,n,r=e.split(/(\[.*?\]\(.*?\))/g),i=[];try{for(var a=Object(o.__values)(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(!l.startsWith("[")||!l.endsWith(")")){var c=l.trim();c.startsWith(".")&&(c=c.substring(1).trim(),i.length>0&&(i[i.length-1]=i[i.length-1]+". ")),i.push(c)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}(r[0].text).forEach((function(i,a){i.length>0?n.push({adaptiveCard:Object(o.__assign)(Object(o.__assign)({},e),{body:[Object(o.__assign)(Object(o.__assign)({},r[0]),{text:i})]}),references:t[a]?[t[a]]:[]}):t[a]&&n.length>0&&n[n.length-1].references.push(t[a])})),n},q=function(e,t){if(0===t.length)return!1;var n=e.search("%c");if(-1===n)return!1;var r=e.slice(n+2).search("%c");if(-1===r)return!1;r=r+n+2;var o=parseInt(e.slice(n+2,r));return t.some((function(e){return e.referenceIndex===o}))},K=function(){return{aadUserId:"",clientType:I.c.web,hubName:I.d.orange,locale:"en-US",physicalRing:"",sessionId:"",theme:I.e.default,userName:"",userPrincipalName:""}},Y=function(e,t){for(var n=[],r=e,o=0,i=function(e,t){return t.find((function(t){return t.every((function(t){return e.includes(t())}))}))}(r,t);r.length>0;){var a=!1,s=-1;if((null==i?void 0:i.length)>0&&o<(null==i?void 0:i.length)){var l=i;0===(s=r.indexOf(l[o]()))&&(a=!0,n.push({promptType:b.Skill,promptText:l[o]()}),r=r.substring(l[o]().length))}if(a)o++;else{var c=r.indexOf("["),u=r.indexOf("]"),d=r.indexOf("("),p=r.indexOf(")"),g=-1,h=b.Regular;c>=0&&u>=0&&0===(g=c)&&(h=b.Ghost,g=u+1),d>=0&&p>=0&&(-1===g||d<g)&&0===(g=d)&&(h=b.File,g=p+1),-1===g&&(g=s>0?s:r.length),n.push({promptType:h,promptText:r.substring(0,g)}),r=r.substring(g)}}return n},Z=function(){return U()?OfficeaicopilotStrings.ChatCardFooterDisclaimer:"AI-generated content may be incorrect"},J=function(){return U()?OfficeaicopilotStrings.ChatCardFooterDisclaimerPowered:"AI-powered suggestions may be inaccurate"},X=function(){return U()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeader:"Provide feedback"},$=function(){return U()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeHeaderTitle:"MICROSOFT INTERNAL ONLY"},ee=function(){return U()?OfficeaicopilotStrings.ShowMeButtonText:"Show Me"},te="Help",ne=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm,re=function(){return"Confirm Invitation"},oe=function(){return"Review Details"},ie=function(e){function t(t,n,r,o,i,a,s,l,c,u,d){var p=e.call(this,r,o,i,a,s,l,c,u,d)||this;return p.taskModuleLauncher=t,p.clientInfo=n,p}return Object(o.__extends)(t,e),t.prototype.launchModalDialogContainer=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t?[4,this.getAppDefinition(e.appId)]:[2,Promise.reject("Dialog content not found")];case 1:return(n=o.sent())?(r={dialogContent:t,appDefinition:n,cardData:JSON.stringify(e.cardData)},this.taskModuleLauncher?[4,this.taskModuleLauncher(r)]:[3,3]):[2,Promise.reject("App definition not found")];case 2:return o.sent(),[2,Promise.resolve({status:"Success"})];case 3:return[2,Promise.resolve({status:"Failure"})]}}))}))},t.prototype.openTaskModule=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return t=this.getDialogFromTaskInfo(e.taskInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t.prototype.openStageView=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return t=this.getDialogFromStageInfo(e.stageInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t}(n(1131).MsgExtPreviewHostService),ae=function(){function e(){}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{type:e.type.toString(),tag:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",name:null!==(o=null===(r=e.name)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",source:null!==(a=null===(i=e.source)||void 0===i?void 0:i.toString())&&void 0!==a?a:"",duration:null!==(l=null===(s=e.duration)||void 0===s?void 0:s.toString())&&void 0!==l?l:"",success:null!==(u=null===(c=e.success)||void 0===c?void 0:c.toString())&&void 0!==u?u:"",correlationVector:null!==(p=null===(d=e.correlationVector)||void 0===d?void 0:d.toString())&&void 0!==p?p:""}},e.prototype.LogInfo=function(e){},e.prototype.LogError=function(e){},e.prototype.LogException=function(e){},e.prototype.LogWarning=function(e){},e.prototype.LogVerbose=function(e){},e.prototype.LogMetric=function(e){},e}(),se=function(){function e(e){this.cardProps=e}return e.prototype.getDisplayExternalUrlWarning=function(){return function(e){return new Promise((function(t,n){e?setTimeout((function(){return t()}),2e3):n("CardId is missing")}))}},e.prototype.isValidMessageForMsgExtCard=function(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((function(e){return!!e.cardJson}))},e.prototype.getCardReferences=function(e){var t,n,r=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];var o=new C.a({},null,null===(t=this.cardProps.clientInfo)||void 0===t?void 0:t.locale,"",null===(n=this.cardProps.clientInfo)||void 0===n?void 0:n.theme);return e.map((function(e,t){return{index:t+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:r,content:e.cardJson,config:o}}))},e.prototype.getCardServiceProps=function(){return this.cardProps},e.prototype.getMsgExtCardService=function(){var e,t=this.cardProps.tokenService,n=this.cardProps.appService,r=this.cardProps.channelService,o=this.cardProps.clientInfo,i=null===(e=this.cardProps)||void 0===e?void 0:e.telemetryService,a=this.cardProps.taskModuleLauncher,s={host:{clientType:o.clientType,name:o.hubName,sessionId:o.sessionId,version:"1.0"},locale:o.locale,sessionId:o.sessionId,theme:o.theme},l={dataResidency:O.d.Public,id:o.aadUserId,displayName:o.userName,userPrincipalName:o.userPrincipalName};i||(i=new ae);var c=document.createElement("div"),u=new ie(a,o,(function(){return c}),l,s,n,t,(function(){throw new Error("Not implemented")}),r,void 0,this.getDisplayExternalUrlWarning());return{hostService:u,tokenService:t,appService:n,cardService:new y.a(u,r,n),telemetryService:i,channelService:r}},e}(),le=n(3345),ce=n(1),ue=n.n(ce);function de(e){var t=e.theme,n=e.dir,r=e.children,i=ue.a.useMemo((function(){switch(h()){case l.defaultBlack:return Object(o.__assign)(Object(o.__assign)({},A),t);case l.defaultWhite:default:return Object(o.__assign)(Object(o.__assign)({},P),t)}}),[t]);return ue.a.createElement(le.a,{theme:i,dir:n},r)}var pe=n(1543),ge=Object(pe.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),he=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(x.a)(o,t)),n?o=r?Object(x.a)(o,e.horizontalReverse):Object(x.a)(o,e.horizontal):r&&(o=Object(x.a)(o,e.verticalReverse)),o}(ge(),n,i,s);return ce.createElement("div",Object(o.__assign)({className:c},l),t)},fe=n(3360),me=n(3361),ve=n(3362),be=n(1814),ye=n(1026),Ce=n(3364),Oe=n(3365),Se=n(3366),Ee=n(3358),xe=n(3359),Ie=n(3334),we=n(1858),Te=function(){return U()?OfficeaicopilotStrings.LikeButtonLabel:"Like"},ke=function(){return U()?OfficeaicopilotStrings.DislikeButtonLabel:"Dislike"},je=function(){return U()?OfficeaicopilotStrings.SuggestionPaneLabel:"Suggested Prompts"};function Pe(){return U()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"}var Ae=Object(pe.a)({item:{height:"auto",width:"auto",flexShrink:1}}),_e=function(e){var t=e.children,n=e.style,r=Object(x.a)(Ae().item,n);return ue.a.createElement("div",{className:r},t)},De=n(3363),Le=function(e){var t=e.iconUrl,n=e.iconAltText||"MenuItemIcon";return ue.a.createElement(De.a,{src:t,alt:n,fit:"contain"})},Me=n(335),Be=n(139),Re={root:Object(o.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},Me.a.margin("0px","16px","0px","16px")),menuWrapper:Object(o.__assign)({},Me.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Be.a.colorNeutralForeground1,"&:hover":{color:Be.a.colorBrandBackground2Hover},"&:hover :active":{color:Be.a.colorBrandStroke2Hover}},iconButton:Object(o.__assign)(Object(o.__assign)({},Me.a.border("none")),{color:Be.a.colorNeutralForeground1,backgroundColor:"transparent"}),label:Object(o.__assign)({},Me.a.padding("4px","5px","4px","5px")),labelIcon:Object(o.__assign)(Object(o.__assign)({},Me.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(o.__assign)(Object(o.__assign)({},Me.a.margin("5px","0px","5px","0px")),{height:"100%"})},Fe=Object(pe.a)(Re),Ne=Object(E.a)(P),He={root:Object(o.__assign)({flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},Me.a.margin("0px","16px","0px","16px")),menuWrapper:Object(o.__assign)({},Me.a.margin("0px","16px","0px","0px")),menuAdjacentActionButtons:{color:Ne.neutralPrimary,"&:hover":{color:Ne.themeMedium},"&:hover :active":{color:Ne.themeDark}},iconButton:Object(o.__assign)(Object(o.__assign)({},Me.a.border("none")),{color:Ne.neutralPrimary,backgroundColor:"transparent"}),label:Object(o.__assign)({},Me.a.padding("4px","5px","4px","5px")),labelIcon:Object(o.__assign)(Object(o.__assign)({},Me.a.padding("4px","1px","4px","5px")),{maxWidth:"20px",maxHeight:"20px"}),menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:Object(o.__assign)(Object(o.__assign)({},Me.a.margin("5px","0px","5px","0px")),{height:"100%"})},Ue=Object(pe.a)(He),Ve=function(){var e=Ue(),t=Fe();return v()?t:e},ze=function(e){var t=e.isMenuOpen,n=e.onMenuStateChange,r=e.handleCopilotChatChange,o=e.copilotList,i=e.showNewChatButtonOnTop,a=e.isExecuting,s=e.handleChangeTopicButtonClick,l=Ve(),c=o.find((function(e){return e.isSelected})),u=o.find((function(e){return e.isDefaultCopilot})),d=null==c?void 0:c.id,p=null==u?void 0:u.id,g=null==c?void 0:c.name,h=null==c?void 0:c.menuIcon,f=null==c?void 0:c.menuIconUrl,m=null==c?void 0:c.iconAltText,v=Object(Ee.a)(xe.d,xe.e);return ce.createElement(he,{horizontal:!0,style:l.root},ce.createElement(fe.a,{open:t,onOpenChange:n},ce.createElement(he,{horizontal:!0,style:l.menuWrapper},ce.createElement(me.a,{withArrow:!0,positioning:"below",content:U()?OfficeaicopilotStrings.CopilotSwitcherMenuTriggerTitle:"Switch copilots",relationship:"label"},ce.createElement(ve.a,{disableButtonEnhancement:!0},ce.createElement(be.a,{className:l.iconButton,icon:ce.createElement(Ie.a,null)}))),d!==p&&ce.createElement(he,{horizontal:!0},ce.createElement(_e,{style:l.labelIcon},f?ce.createElement(Le,{iconUrl:f,iconAltText:m}):h),ce.createElement(ye.a,{weight:"semibold",className:l.label},g))),ce.createElement(Ce.a,{className:l.menu},ce.createElement(Oe.a,null,o.map((function(e){return ce.createElement(Se.a,{key:e.id,icon:e.menuIconUrl?ce.createElement(Le,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon,onClick:function(){r(e.id)}},ce.createElement(he,{horizontal:!0,style:l.menuItem},ce.createElement(_e,null,e.name),ce.createElement(_e,null,e.isSelected&&ce.createElement(we.s,null))))}))))),p===d&&ce.createElement(he,{horizontal:!0},i&&ce.createElement(me.a,{withArrow:!0,positioning:"below",content:Pe(),relationship:"label"},ce.createElement(be.a,{appearance:"transparent",disabled:a,className:l.menuAdjacentActionButtons,icon:ce.createElement(v,null),onClick:s}))))},Ge=function(e){var t=e.componentToRender,n=Ve();return ue.a.createElement(he,{style:n.componentWrapper},t)},We=n(3370),Qe={root:Object(o.__assign)({},Me.a.margin("0px","16px","0px","16px"))},qe=Object(pe.a)(Qe),Ke=function(e){var t=e.label,n=e.checked,r=e.disabled,o=e.onChange,i=qe();return ue.a.createElement(We.a,{className:i.root,onChange:o,checked:n,label:t,disabled:r,labelPosition:"after"})},Ye={buttonStack:Object(o.__assign)({},Me.a.margin("0px","0px","0px","15px")),buttonStackItem:Object(o.__assign)({},Me.a.margin("0px","5px","0px","0px"))};var Ze,Je,Xe,$e,et=(Xe={buttonStack:null!==(Ze=Ye.buttonStack)&&void 0!==Ze?Ze:{},buttonStackItem:null!==(Je=Ye.buttonStackItem)&&void 0!==Je?Je:{}},Object(pe.a)(Xe)),tt=n(3599),nt=n(3371),rt=n(3372),ot=n(3373),it=n(2265),at=n(3374),st=n(3375),lt=n(3376),ct=n(3377),ut=n(3378),dt=n(3379),pt=n(576),gt=($e=Object(E.a)(P),{itemCell:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("5px")),Me.a.borderBottom("1px","solid",$e.themePrimary)),{minHeight:"30px",boxSizing:"border-box",display:"flex",selectors:{"&:hover":{backgroundColor:$e.neutralLight}}}),itemContent:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("hidden")),Me.a.margin("0px","0px","0px","5px")),{flexGrow:1}),itemName:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"},accordionBody:Object(o.__assign)({},Me.a.margin("0px","10px")),metricAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("auto")),{overflowWrap:"anywhere",fontSize:"16px",fontWeight:"500"})}),ht=function(){var e,t,n,r,o,i,a={itemCell:null!==(e=gt.itemCell)&&void 0!==e?e:{},itemContent:null!==(t=gt.itemContent)&&void 0!==t?t:{},itemName:null!==(n=gt.itemName)&&void 0!==n?n:{},itemValue:null!==(r=gt.itemValue)&&void 0!==r?r:{},accordionBody:null!==(o=gt.accordionBody)&&void 0!==o?o:{},metricAccordionHeaderText:null!==(i=gt.metricAccordionHeaderText)&&void 0!==i?i:{}};return Object(pe.a)(a)}();var ft,mt=function(e){var t=Object(o.__read)(ue.a.useState([]),2),n=t[0],r=t[1],i=Object(o.__read)(ue.a.useState([]),2),a=i[0],s=i[1],l=Object(o.__read)(ue.a.useState(""),2),c=l[0],u=l[1],d=ht();return Object(ce.useEffect)((function(){!function(t){var n;if(u(t),""!==c){var r=null===(n=e.telemetry.metrics)||void 0===n?void 0:n.filter((function(e){return e.serviceName.toLowerCase().includes(c.toLowerCase())}));s(r)}else s(e.telemetry.metrics)}(e.searchValue)}),[e.searchValue]),ue.a.createElement(st.a,{openItems:n,onToggle:function(e,t){r(t.openItems)},multiple:!0,collapsible:!0,className:d.accordionBody},a.map((function(e,t){return ue.a.createElement(lt.a,{key:t,value:(t+1).toString()},ue.a.createElement(ct.a,null,ue.a.createElement(ut.a,{className:d.metricAccordionHeaderText},"".concat(e.serviceName))),ue.a.createElement(dt.a,null,Object.keys(e).filter((function(e){return"serviceName"!==e})).map((function(t,n){return ue.a.createElement("div",{key:n,className:d.itemCell,"data-is-focusable":!0},ue.a.createElement("div",{className:d.itemContent},ue.a.createElement(ut.a,{block:!0,className:d.itemName},t.toString()),ue.a.createElement(ut.a,{block:!0,className:d.itemValue},String(e[t]))))}))))})))};!function(e){e.COPIED="Copied",e.COPY_ERROR="Copy Error",e.COPY_DEBUG_LOGS="Copy Debug Logs"}(ft||(ft={}));var vt=function(){return"Sydney Telemetry Debug Panel"},bt=function(){return"Query ID :"},yt=function(){return"Show Telemetry Panel"},Ct=function(){return"Replay Conversation"},Ot=function(){return"Debug Tools"},St=function(){return"https://sdf.cortana.ai/turingbot/ui?debug=true&enableDebugButton=&allowedMessageTypes=Any&variants=UseIc3ForConversationStorage&sourceConversationId="},Et=function(){return"_blank"},xt=function(){return"Search Telemetry"},It={dialogTitle:Object(o.__assign)({},Me.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},searchBox:{width:"90%",marginLeft:"5%"},searchBoxContainer:{paddingBottom:"10px"}},wt=function(){var e,t,n,r,o,i={dialogTitle:null!==(e=It.dialogTitle)&&void 0!==e?e:{},queryAccordionHeaderText:null!==(t=It.queryAccordionHeaderText)&&void 0!==t?t:{},queryAccordionText:null!==(n=It.queryAccordionText)&&void 0!==n?n:{},searchBox:null!==(r=It.searchBox)&&void 0!==r?r:{},searchBoxContainer:null!==(o=It.searchBoxContainer)&&void 0!==o?o:{}};return Object(pe.a)(i)}();var Tt=function(e){var t=Object(o.__read)(ue.a.useState([]),2),n=t[0],r=t[1],i=Object(o.__read)(ue.a.useState(""),2),a=i[0],s=i[1],l=wt();return ue.a.createElement(tt.a,{open:e.isModalOpen,onOpenChange:function(t,n){e.setIsModalOpen(n.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":"close",icon:ue.a.createElement(pt.n,null)})),className:l.dialogTitle},vt()),ue.a.createElement(at.a,null,ue.a.createElement("div",{className:l.searchBoxContainer},ue.a.createElement("input",{placeholder:xt(),onChange:function(e){return s(e.target.value)},className:l.searchBox})),ue.a.createElement(st.a,{openItems:n,onToggle:function(e,t){r(t.openItems)},multiple:!0,collapsible:!0},e.telemetryData.map((function(e,t){return ue.a.createElement(lt.a,{key:t,value:(t+1).toString()},ue.a.createElement(ct.a,null,ue.a.createElement(he,null,ue.a.createElement(ut.a,{block:!0,className:l.queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat(bt())),ue.a.createElement(ut.a,{className:l.queryAccordionText},e.queryId))),ue.a.createElement(dt.a,null,ue.a.createElement(mt,{telemetry:e.telemetry,searchValue:a})))})))))))};var kt,jt=function(e){var t=this,n=Object(o.__read)(Object(ce.useState)(!1),2),r=n[0],i=n[1],a=Object(o.__read)(Object(ce.useState)(!1),2),s=a[0],l=a[1],c=Object(o.__read)(Object(ce.useState)(!1),2),u=c[0],d=c[1],p=Object(o.__read)(Object(ce.useState)(!1),2),g=p[0],h=p[1],f=et(),m=s?ft.COPIED:u?ft.COPY_ERROR:ft.COPY_DEBUG_LOGS,v={checked:r,disabled:!1,onChange:function(e,t){var n=null==t?void 0:t.checked;i(null!=n&&n),n||(l(!1),d(!1))},label:Ot()};return ue.a.createElement(he,null,ue.a.createElement(Ke,Object(o.__assign)({},v)),ue.a.createElement(he,{horizontal:!0,style:f.buttonStack},ue.a.createElement(_e,{style:f.buttonStackItem},r&&ue.a.createElement(be.a,{appearance:"outline",onClick:function(){return Object(o.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),(t=e.getLogs())?[4,navigator.clipboard.writeText(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return l(!0),[3,4];case 3:return n=r.sent(),console.log("An error occurred while copying text to clipboard:",n.message),d(!0),[3,4];case 4:return[2]}}))}))},size:"small",title:m},m)),ue.a.createElement(_e,{style:f.buttonStackItem},r&&""!=e.conversationId&&ue.a.createElement(be.a,{appearance:"outline",onClick:function(){e.conversationId&&window.open(St()+e.conversationId,Et())},size:"small",title:Ct()},Ct())),ue.a.createElement(_e,{style:f.buttonStackItem},r&&e.telemetryData&&ue.a.createElement(be.a,{appearance:"outline",onClick:function(){h(!g)},size:"small",title:yt(),disabled:0===e.telemetryData.length},yt()))),r&&e.telemetryData&&g&&ue.a.createElement(Tt,{telemetryData:e.telemetryData,isModalOpen:g,setIsModalOpen:h}))},Pt=n(3597),At=n(3367),_t=n(3380),Dt=n(1817),Lt=n(3369),Mt=n(3347),Bt=n(3381),Rt={dialogTitle:Object(o.__assign)({},Me.a.padding("5px","0px","5px","10px")),queryAccordionHeaderText:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("auto")),{fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"}),queryAccordionText:{fontSize:"16px",fontWeight:"400"},itemName:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"}),itemValue:{fontSize:"14px",fontWeight:"400"}},Ft=function(){var e,t,n,r,o,i={dialogTitle:null!==(e=Rt.dialogTitle)&&void 0!==e?e:{},queryAccordionHeaderText:null!==(t=Rt.queryAccordionHeaderText)&&void 0!==t?t:{},queryAccordionText:null!==(n=Rt.queryAccordionText)&&void 0!==n?n:{},itemName:null!==(r=Rt.itemName)&&void 0!==r?r:{},itemValue:null!==(o=Rt.itemValue)&&void 0!==o?o:{}};return Object(pe.a)(i)}(),Nt="Client Conversation Logs",Ht="Client Console Logs",Ut="Performance",Vt="Session Info",zt="Augloop Workflow Logs",Gt="Chat Event Logs",Wt="Session Id",Qt="Option Sets",qt="AL Inspector Link",Kt="App Name",Yt="App Platform",Zt="SDX Version",Jt="https://web.augloop-tools.officeppe.com/inspector/",Xt="_blank",$t="Close",en=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.conversationLogObject,i=Ft(),a=Object(o.__read)(ue.a.useState([]),2),s=a[0],l=a[1],c=function(e,t){return ue.a.createElement(lt.a,{key:t,value:(t+1).toString()},ue.a.createElement(ct.a,null,ue.a.createElement(he,null,ue.a.createElement(ut.a,{block:!0,className:i.queryAccordionHeaderText},"[ ".concat((t+1).toString()," ] ").concat("Query")))),ue.a.createElement(dt.a,null,(n=e,r=[],Object.keys(n).forEach((function(e){r.push(ue.a.createElement("div",{className:i.itemName},e,":")),r.push(ue.a.createElement("div",{className:i.itemValue},JSON.stringify(n[e])))})),r)));var n,r};return ue.a.createElement(tt.a,{open:t,onOpenChange:function(e,t){n(t.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":$t,icon:ue.a.createElement(pt.n,null)}))},Nt),ue.a.createElement(at.a,null,ue.a.createElement(st.a,{openItems:s,onToggle:function(e,t){l(t.openItems)},multiple:!0,collapsible:!0},null==r?void 0:r.map((function(e,t){return c(e,t)})))))))},tn=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.getLogs;return ue.a.createElement(tt.a,{open:t,onOpenChange:function(e,t){n(t.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":$t,icon:ue.a.createElement(pt.n,null)}))},Ht),ue.a.createElement(at.a,null,r?r():""))))},nn=function(e){var t,n,r=e.isModalOpen,o=e.setIsModalOpen,i=e.debugMessageInfoObject,a=Ft();return ue.a.createElement(tt.a,{open:r,onOpenChange:function(e,t){o(t.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":$t,icon:ue.a.createElement(pt.n,null)}))},"Debug Info"),ue.a.createElement(at.a,null,i?(t=i,n=[],Object.keys(t).forEach((function(e){n.push(ue.a.createElement("div",{className:a.itemName},e,":")),n.push(ue.a.createElement("div",{className:a.itemValue},JSON.stringify(t[e])))})),n):""))))},rn=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.chatPaneLoadTime,o=e.chatInputLoadTime,i=Ft();return ue.a.createElement(tt.a,{open:t,onOpenChange:function(e,t){n(t.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":$t,icon:ue.a.createElement(pt.n,null)}))},Ut),ue.a.createElement(at.a,null,ue.a.createElement("div",{className:i.itemName},"".concat("Chat Pane Load Time",": ")),ue.a.createElement("div",{className:i.itemValue},"".concat(r,"s")),ue.a.createElement("div",{className:i.itemName},"".concat("Ready to Interact",": ")),ue.a.createElement("div",{className:i.itemValue},"".concat(o,"s"))))))},on=n(3382),an=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,r=e.sessionId,o=e.conversationLogObject,i=e.appName,a=e.appPlatform,s=e.augloopKustoQueryURL,l=e.clientKustoQueryURL,c=e.sdxVersion,u=Ft();return ue.a.createElement(tt.a,{open:t,onOpenChange:function(e,t){n(t.open)}},ue.a.createElement(nt.a,null,ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":$t,icon:ue.a.createElement(pt.n,null)}))},Vt),ue.a.createElement(at.a,null,ue.a.createElement("div",{className:u.itemName},"".concat(Wt,": ")),ue.a.createElement("div",{className:u.itemValue},r||""),ue.a.createElement("div",{className:u.itemName},"".concat(Kt,": ")),ue.a.createElement("div",{className:u.itemValue},i||""),ue.a.createElement("div",{className:u.itemName},"".concat(Yt,": ")),ue.a.createElement("div",{className:u.itemValue},a||""),ue.a.createElement("div",{className:u.itemName},"".concat(Zt,": ")),ue.a.createElement("div",{className:u.itemValue},c||""),ue.a.createElement("div",{className:u.itemName},"".concat(Qt,": ")),ue.a.createElement("div",{className:u.itemValue},o&&o.length>0&&o[0].optionSets?o[0].optionSets:[]),ue.a.createElement("div",{className:u.itemName},"".concat(qt,": ")),ue.a.createElement("div",{className:u.itemValue},ue.a.createElement(on.a,{onClick:function(){var e="".concat(Jt).concat(r);window.open(e,Xt)}},"".concat(Jt).concat(r))),ue.a.createElement("div",{className:u.itemName},"".concat(zt,": ")),ue.a.createElement("div",{className:u.itemValue},ue.a.createElement(on.a,{onClick:function(){window.open(s,Xt)}},s)),ue.a.createElement("div",{className:u.itemName},"".concat(Gt,": ")),ue.a.createElement("div",{className:u.itemValue},ue.a.createElement(on.a,{onClick:function(){window.open(l,Xt)}},l))))))},sn={toolbar:Object(o.__assign)({justifyContent:"space-between",marginRight:"5px"},Me.a.padding("2px"))},ln=function(){var e,t={toolbar:null!==(e=sn.toolbar)&&void 0!==e?e:{}};return Object(pe.a)(t)}(),cn=function(e){var t,n=Object(o.__read)(Object(ce.useState)(!1),2),r=n[0],i=n[1],a=Object(o.__read)(Object(ce.useState)(!1),2),s=a[0],l=a[1],c=Object(o.__read)(Object(ce.useState)(!1),2),u=c[0],d=c[1],p=Object(o.__read)(Object(ce.useState)(!1),2),g=p[0],h=p[1],f=Object(o.__read)(Object(ce.useState)(!1),2),m=f[0],v=f[1],b=Object(o.__read)(Object(ce.useState)(!1),2),y=b[0],C=b[1],O=Object(o.__read)(Object(ce.useState)(!1),2),S=O[0],E=O[1],x=ln();return Object(ce.useEffect)((function(){E(e.showDebugInfoMessage)}),[e.showDebugInfoMessage]),ue.a.createElement("div",null,ue.a.createElement(Pt.a,{className:x.toolbar},ue.a.createElement(At.a,null,ue.a.createElement(Ke,{label:"Debug Menu",onChange:function(e,t){var n=null==t?void 0:t.checked;i(n)},checked:r,disabled:!1})),r&&ue.a.createElement(At.a,null,ue.a.createElement(_t.a,{icon:ue.a.createElement(xe.b,null),onClick:function(){var t=e.conversationLogObject&&e.conversationLogObject[0].optionSets?e.conversationLogObject[0].optionSets:[],n="<ul> <li><strong>".concat(Wt,":</strong> ").concat(e.sessionId," </li>\n    <li><strong>").concat(qt,":</strong> ").concat(Jt).concat(e.sessionId,"</li>\n    <li><strong>").concat(Kt,":</strong> ").concat(e.appName,"</li>\n    <li><strong>").concat(Yt,": </strong> ").concat(e.appPlatform,"</li>\n    <li><strong>").concat(Zt,": </strong> ").concat(e.sdxVersion," </li>\n    <li><strong>").concat(Qt,": </strong> ").concat(t," </li></ul>")+"<br/> ".concat("Please upload console and sydney logs from debug panel","<br/>"),r="https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[".concat(e.appName,"+Copilot]:&[System.Description]=").concat(n,"&[System.Area]=OC\\Office+AI+Exp\\Chat&[System.Tags]=UserFeedback");r=r.replace(/\n/g,""),window.open(r,Xt)}}),ue.a.createElement(fe.a,null,ue.a.createElement(ve.a,{disableButtonEnhancement:!0},ue.a.createElement(Dt.a,{icon:ue.a.createElement(pt.k,null),appearance:"subtle"})),ue.a.createElement(Ce.a,null,ue.a.createElement(Oe.a,null,ue.a.createElement(Se.a,{onClick:function(){h(!0)}},Vt),ue.a.createElement(Se.a,{onClick:function(){d(!0)}},Ut)))),ue.a.createElement(fe.a,null,ue.a.createElement(ve.a,{disableButtonEnhancement:!0},ue.a.createElement(Dt.a,{icon:ue.a.createElement(Mt.c,null),appearance:"subtle"})),ue.a.createElement(Ce.a,null,ue.a.createElement(Oe.a,null,ue.a.createElement(Lt.a,null,ue.a.createElement(Se.a,null,Ht),ue.a.createElement(be.a,{icon:ue.a.createElement(Bt.h,null),appearance:"subtle",onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s;return Object(o.__generator)(this,(function(o){return t=null===(a=e.getLogs)||void 0===a?void 0:a.call(e),n=new Blob([JSON.stringify(t)],{type:"application/json"}),r=window.URL.createObjectURL(n),(i=document.createElement("a")).href=r,i.download=null!==(s="consoleLogs-"+e.conversationId)&&void 0!==s?s:".json",i.click(),[2]}))}))}}),ue.a.createElement(be.a,{icon:ue.a.createElement(pt.a,null),appearance:"subtle",onClick:function(){l(!0)}})),ue.a.createElement(Lt.a,null,ue.a.createElement(Se.a,null,Nt),ue.a.createElement(be.a,{icon:ue.a.createElement(Bt.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.conversationLogObject){var n=new Blob([JSON.stringify(e.conversationLogObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatConversationLogs-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),ue.a.createElement(be.a,{icon:ue.a.createElement(pt.a,null),appearance:"subtle",onClick:function(){v(!0)}})),ue.a.createElement(Lt.a,null,ue.a.createElement(Se.a,null,"Sydney Conversation Logs"),ue.a.createElement(be.a,{icon:ue.a.createElement(Bt.h,null),appearance:"subtle",onClick:function(){var t;if(null==e?void 0:e.sydneyConversationObject){var n=new Blob([JSON.stringify(e.sydneyConversationObject)],{type:"application/json"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=null!==(t="chatHistory-"+e.conversationId)&&void 0!==t?t:".json",o.click()}}}),ue.a.createElement(be.a,{icon:ue.a.createElement(pt.a,null),appearance:"subtle",onClick:function(){C(!y)}}))))),ue.a.createElement(fe.a,null,ue.a.createElement(ve.a,{disableButtonEnhancement:!0},ue.a.createElement(Dt.a,{icon:ue.a.createElement(pt.g,null),appearance:"subtle"})),ue.a.createElement(Ce.a,null,ue.a.createElement(Oe.a,null,ue.a.createElement(Se.a,{onClick:function(){var t;window.open(null!==(t=e.augloopKustoQueryURL)&&void 0!==t?t:"",Xt)}},zt),ue.a.createElement(Se.a,{onClick:function(){var t;window.open(null!==(t=e.clientKustoQueryURL)&&void 0!==t?t:"",Xt)}},Gt)))))),y&&(null==e?void 0:e.telemetryData)&&ue.a.createElement(Tt,{telemetryData:null==e?void 0:e.telemetryData,isModalOpen:y,setIsModalOpen:C}),s&&ue.a.createElement(tn,{isModalOpen:s,setIsModalOpen:l,getLogs:e.getLogs}),g&&ue.a.createElement(an,{isModalOpen:g,setIsModalOpen:h,sessionId:e.sessionId,conversationLogObject:e.conversationLogObject,appName:e.appName,appPlatform:e.appPlatform,augloopKustoQueryURL:e.augloopKustoQueryURL,clientKustoQueryURL:e.clientKustoQueryURL,sdxVersion:e.sdxVersion}),u&&ue.a.createElement(rn,{isModalOpen:u,setIsModalOpen:d,chatInputLoadTime:e.chatInputLoadTime,chatPaneLoadTime:e.chatPaneLoadTime}),m&&ue.a.createElement(en,{isModalOpen:m,setIsModalOpen:v,conversationLogObject:e.conversationLogObject}),S&&ue.a.createElement(nn,{isModalOpen:S,setIsModalOpen:null!==(t=null==e?void 0:e.setShowDebugInfoOnMessage)&&void 0!==t?t:E,debugMessageInfoObject:e.debugMessageInfoObject}))},un=n(2790),dn=n(552),pn=n(3348),gn=n(882);var hn,fn,mn,vn=Object(E.a)(P),bn=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},workflowStepStack:null!==(r=e.workflowStepStack)&&void 0!==r?r:{},cardHeader:null!==(o=e.cardHeader)&&void 0!==o?o:{},userContentButton:null!==(i=e.userContentButton)&&void 0!==i?i:{},userContentButtonItem:null!==(a=e.userContentButton)&&void 0!==a?a:{},userContentButtonDisabled:{},leftAlignedText:{},thumbnail:{},actionButtonStack:{}};return Object(pe.a)(s)}({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({maxWidth:"288px"},Me.a.padding(vn.spacingVerticalM,vn.spacingHorizontalL)),{fontFamily:"-apple-system"}),Me.a.margin(vn.spacingVerticalNone,vn.spacingHorizontalL,vn.spacingVerticalS)),{boxShadow:vn.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(o.__assign)({},Me.a.gap(vn.spacingVerticalS)),userContentButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding(vn.spacingVerticalL,vn.spacingHorizontalXL)),{minHeight:"40px"}),Me.a.borderRadius(vn.borderRadiusXLarge)),(kt={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},kt["& .".concat(gn.a.icon)]=Object(o.__assign)({},Me.a.margin("0px","11px","0px","0px")),kt))}),yn=Object(E.a)(P),Cn={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("12px")),Me.a.borderRadius("8px")),Me.a.margin("16px")),{boxShadow:yn.shadow4,color:yn.neutralPrimary,backgroundColor:yn.neutralLight}),rootHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",yn.neutralLighterAlt)),buttonStack:Object(o.__assign)(Object(o.__assign)({},Me.a.gap("4px")),{marginTop:"8px"}),workflowStepStack:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.gap("10px")),Me.a.padding("10px","8px","20px","8px")),Me.a.overflow("hidden")),cardHeader:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{whiteSpace:"pre-wrap"}),userContentButtonItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"space-between",alignItems:"center",height:"40px",backgroundColor:yn.neutralLight},Me.a.border("1px","solid",yn.neutralLighterAlt)),pn.a.body1),(hn={},hn["&:hover .".concat(gn.a.icon)]={color:yn.themePrimary},hn)),userContentButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"space-between",alignItems:"center",height:"fit-content"},Me.a.padding("0px","15px")),{backgroundColor:yn.neutralLight}),Me.a.border("1px","solid",yn.neutralLighterAlt)),pn.a.body1),(fn={},fn["&:hover .".concat(gn.a.icon)]={color:yn.themePrimary},fn)),userContentButtonDisabled:(mn={color:yn.neutralQuaternary},mn["&:hover .".concat(gn.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},mn),leftAlignedText:Object(o.__assign)({textAlign:"left"},Me.a.padding("0px","8px")),thumbnail:{paddingLeft:"10px"},actionButtonStack:Object(o.__assign)({marginTop:"8px"},Me.a.gap("12px"))},On=Object(pe.a)(Cn),Sn=function(){var e=On(),t=bn();if(a()===r.IOS)e=W(e,t);return e},En=["Step 1","Step 2","Step 3","Step 4","Step 5"],xn=ue.a.memo((function(e){var t,n=e.overrideStyles,r=e.stages,i=e.gotoNextStageString,a=e.index,s=e.lastEnabledStep,l=e.handleButtonClick,c=e.allowForwardNavigation,u=void 0!==c&&c,d=e.displayStatusIcon,p=void 0===d||d,g=Sn();W(g,n);var h=Object(o.__read)(Object(ce.useState)(0),2),f=h[0],m=h[1],v=Object(o.__read)(Object(ce.useState)(!1),2),b=v[0],y=v[1],C=Object(o.__read)(Object(ce.useState)(!0),2),O=C[0],S=C[1],E=r||En,x=function(){y(!b)},I=function(e,t,n){void 0===n&&(n={});var r=Object(Ee.a)(t,e);return ue.a.createElement(r,{style:n})};return Object(ce.useEffect)((function(){m(a)}),[a]),ue.a.createElement(un.a,{className:g.root,"aria-labelledby":E[0],style:{backgroundColor:"#ecf3fc",margin:"0px",borderRadius:"0px",boxShadow:"none",position:"fixed",width:"-webkit-fill-available",zIndex:"2"}},ue.a.createElement(he,null,ue.a.createElement(be.a,{size:"large",role:F,key:f,disabled:!1,"aria-posinset":1,"aria-setsize":null===(t=E[f])||void 0===t?void 0:t.length,className:g.userContentButton,style:{backgroundColor:"#ebf3fc",border:"none",padding:"0px 10px",height:"fit-content",display:"flex",justifyContent:"space-between"}},ue.a.createElement("div",{style:{display:"flex",alignItems:"left"}},ue.a.createElement("b",null," ",E[f]),ue.a.createElement("div",{onClick:function(){x()},style:{paddingLeft:"8px"}},b?I(dn.x,dn.w):I(dn.n,dn.m))),O&&ue.a.createElement("div",{style:{display:"flex",alignItems:"right"}},ue.a.createElement(be.a,{onClick:function(){!function(e){m(e),l(e),e===E.length-1?S(!1):S(!0)}(f+1)}},i[f+1]?i[f+1]:"Go to next step",I(dn.t,dn.t))))),b&&ue.a.createElement("div",{style:{overflow:"auto",maxHeight:"100vh"}},ue.a.createElement(he,{style:g.workflowStepStack},E.map((function(e,t){return ue.a.createElement(be.a,{size:"large",role:F,key:t,disabled:!1,"aria-posinset":t+1,"aria-setsize":e.length,className:g.userContentButtonItem,onClick:function(){(t<=s||u)&&function(e){m(e),y(!b),l(e),e===E.length-1?S(!1):S(!0)}(t)},icon:p&&(t<s?I(dn.i,dn.i,{color:"green"}):t===s?I(dn.C,dn.B,{color:"black"}):I(dn.A,dn.z,{color:"black"})),style:{border:"none",borderRadius:"8px",boxShadow:t===f?"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)":"none",justifyContent:"flex-start"}},t===f?ue.a.createElement("b",null,e):e)})))))})),In=n(3384),wn=n(2461),Tn=function(){return U()?OfficeaicopilotStrings.StopGeneratingButtonLabel:"Stop generating"};var kn,jn,Pn,An=function(e){var t,n,r,o,i,a,s,l,c={root:null!==(t=e.root)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},loaderHighContrast:{},progressBarStyle:null!==(r=e.progressBarStyle)&&void 0!==r?r:{},headerStyle:null!==(o=e.headerStyle)&&void 0!==o?o:{},stopButtonStyle:null!==(i=e.stopButtonStyle)&&void 0!==i?i:{},stopButtonIconStyle:null!==(a=e.stopButtonIconStyle)&&void 0!==a?a:{},inlineStopIcon:null!==(s=e.inlineStopIcon)&&void 0!==s?s:{},stackStopText:null!==(l=e.stackStopText)&&void 0!==l?l:{}};return Object(pe.a)(c)}({loader:Object(o.__assign)(Object(o.__assign)({display:"inline"},Me.a.padding("0px")),Me.a.borderRadius("12px")),progressBarStyle:{height:"4px"},stackStopText:{display:"flex"}}),_n=Object(E.a)(P),Dn={root:Object(o.__assign)(Object(o.__assign)({alignItems:"center"},Me.a.margin(_n.spacingVerticalNone,_n.spacingHorizontalL,_n.spacingVerticalM)),Me.a.gap(_n.spacingVerticalM)),loader:Object(o.__assign)(Object(o.__assign)({minHeight:"48px",backgroundColor:_n.neutralLight,boxShadow:_n.shadow4,transformOrigin:"bottom",width:"100%"},Me.a.overflow("hidden")),Me.a.borderRadius(_n.borderRadiusXLarge)),loaderHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",_n.neutralLighterAlt)),progressBarStyle:{backgroundImage:"linear-gradient(90.5deg, ".concat(_n.themeLight," 10%, ").concat(_n.themeDarkAlt," 32%, ").concat(_n.themeLighterAlt," 55%, ").concat(_n.themeLighter," 72%, ").concat(_n.neutralLighter," 100%)"),backgroundColor:_n.neutralLight,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:Object(o.__assign)(Object(o.__assign)({fontWeight:_n.fontWeightSemibold},Me.a.padding(_n.spacingVerticalM)),{lineHeight:"143%",color:_n.neutralPrimary}),stopButtonStyle:(kn={fontFamily:_n.fontFamilyBase,fontSize:_n.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},kn["&:hover .".concat(gn.a.icon)]={color:_n.themePrimary},kn["&:hover:active .".concat(gn.a.icon)]={color:_n.themePrimary},kn),stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("10px")),Me.a.margin(_n.spacingVerticalNone,_n.spacingHorizontalNone,_n.spacingVerticalNone,_n.spacingHorizontalS)),Me.a.border("0px")),(jn={height:"44px",width:"44px"},jn["&:hover .".concat(gn.a.icon)]={color:_n.themePrimary},jn["&:hover:active .".concat(gn.a.icon)]={color:_n.themePrimary},jn["@media (forced-colors: none)"]={"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},jn))},Ln=Object(pe.a)(Dn),Mn=ue.a.memo((function(e){var t=e.stylesToOverride,n=e.loadingUiStrings,i=e.stringChangeIntervalDuration,s=void 0===i?3500:i,l=e.showStopButton,c=void 0!==l&&l,u=e.showInlineStopButton,d=void 0!==u&&u,p=e.handleStopButtonOnClick,g=function(){var e=Ln(),t=An();a()===r.IOS&&W(e,t);return e}(),h=f();W(g,t),g.loaderHighContrast=Object(x.a)(g.loader,g.loaderHighContrast);var m=Object(o.__read)(Object(ce.useState)(0),2),v=m[0],b=m[1],y=ue.a.useRef();return Object(ce.useEffect)((function(){c&&null!==y.current&&y.current.focus()}),[c]),Object(ce.useEffect)((function(){b(0)}),[JSON.stringify(n)]),Object(ce.useEffect)((function(){var e=setInterval((function(){var t=v+1;t===n.length?clearInterval(e):b(t)}),s);return function(){return clearInterval(e)}}),[v,s,n.length]),ue.a.createElement(he,{style:g.root},ue.a.createElement(he,{style:h?g.loaderHighContrast:g.loader,customProperties:{role:H,"aria-live":"assertive","aria-atomic":!0}},ue.a.createElement(he,{horizontal:!0,style:g.stackStopText},d&&ue.a.createElement(be.a,{appearance:"subtle",className:g.inlineStopIcon,icon:ue.a.createElement(pt.o,null),onClick:p,"aria-label":Tn(),title:Tn()}),ue.a.createElement(ut.a,{id:U()?OfficeaicopilotStrings.LoadingUiTextLabel:"loadingUiText",className:g.headerStyle},n[v])),ue.a.createElement(In.a,{bar:{className:g.progressBarStyle},role:"none",thickness:"large",shape:"rounded",title:"ProgressBar"})),c&&ue.a.createElement(be.a,{appearance:"subtle",className:g.stopButtonStyle,icon:ue.a.createElement(wn.j,null),ref:y,onClick:p,size:"small","aria-live":"assertive"},Tn()))}));!function(e){e.NEXT_STAGE="NextStage",e.NEXT_CARD="NextCard",e.OPEN_EDITOR="OpenEditor",e.ADD_TOPIC="AddTopic"}(Pn||(Pn={}));var Bn=n(1820),Rn=n(3387),Fn=function(){return U()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"wucHeaderText"},Nn=ue.a.forwardRef((function(e,t){var n,r=e.overrideStyles,i=e.messageButtonContent,a=e.headerText,s=e.addActionButtonProps,l=e.handleEditorOpenButtonClick,c=e.buttonText,u=void 0===c?"Start Generating":c,d=e.buttonTextInEnabledState,p=void 0===d?"":d,g=e.buttonTextInDisabledState,h=void 0===g?"":g,m=e.buttonRole,v=e.enableCheckBox,b=void 0===v||v,y=e.cardIndex,C=void 0===y?0:y,O=(e.allowItemAddition,e.dialogTitle),S=void 0===O?"New Entry":O,E=e.onSelectCheckBox,I=void 0===E?function(e,t){}:E,w=e.handleOnClickItemAddition,T=void 0===w?function(e){}:w,k=e.handleButtonClick,j=void 0===k?function(e){}:k,P=e.handleClientButtonClick,A=void 0===P?function(e){}:P,_=e.shouldDisableButtonAtBottom,D=void 0!==_&&_,L=Sn(),M=f(),B=p||u,N=h||u;W(L,r),L.userContentButtonDisabled=Object(x.a)(L.userContentButton,L.userContentButtonDisabled),L.rootHighContrast=Object(x.a)(L.root,L.rootHighContrast);var H=Object(o.__read)(Object(ce.useState)(i),2),U=H[0],V=H[1],z=Object(o.__read)(Object(ce.useState)(!0),2),G=z[0],Q=z[1],q=Object(o.__read)(Object(ce.useState)(B),2),K=q[0],Y=q[1],Z=Object(o.__read)(Object(ce.useState)(!1),2),J=Z[0],X=Z[1],$=Object(o.__read)(Object(ce.useState)(""),2),ee=$[0],te=$[1],ne=function(e){X(!0),T(e)},re=function(e,t){var n;void 0===t&&(t=!0);var r=Object(o.__spreadArray)([],Object(o.__read)(U),!1),i=Object(o.__spreadArray)([],Object(o.__read)(se),!1);r.length>0&&r[r.length-1].isAddItemButton?(r.splice(r.length-1,0,e),i.splice(i.length-1,0,t)):(r.push(e),i.push(t)),I(t,null!==(n=e.boldText)&&void 0!==n?n:""),V(r),le(i)};Object(ce.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){void 0===t&&(t=!0),re(e,t)}}}));var oe=function(e,t,n){void 0===n&&(n={});var r=Object(Ee.a)(t,e);return ue.a.createElement(r,{style:n})},ie=new Array(null==i?void 0:i.length).fill(!1),ae=Object(o.__read)(Object(ce.useState)(ie),2),se=ae[0],le=ae[1];return ue.a.createElement(un.a,{className:M?L.rootHighContrast:L.root,"aria-labelledby":Fn()},a&&ue.a.createElement(_e,null,ue.a.createElement(ut.a,{id:Fn(),className:L.cardHeader},a)),U&&ue.a.createElement(he,{style:L.buttonStack,customProperties:{role:R}},U.map((function(e,t){return ue.a.createElement(be.a,{size:"large",role:F,key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":U.length,className:e.isDisabled?L.userContentButtonDisabled:L.userContentButton,style:e.isAddItemButton?{borderBlockStyle:"dashed"}:{},onClick:function(){e.onSelectButton&&e.onSelectButton(),e.isAddItemButton&&ne()}},ue.a.createElement("div",{style:{display:"flex",alignItems:"center"}},b&&!e.isAddItemButton&&ue.a.createElement("div",{onClick:function(){var n=function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(se),!1);return t[e]=!t[e],le(t),Q(!0),Y(B),t[e]}(t);e.onSelectCheckBox&&e.onSelectCheckBox(n,e.boldText),I&&I(n,e.boldText)}},se[t]?oe(dn.j,dn.j,{color:"green"}):oe(wn.i,wn.i)),e.iconUrl&&ue.a.createElement("img",{className:L.thumbnail,src:e.iconUrl,alt:"",height:20,width:20}),e.boldText?ue.a.createElement("div",null,ue.a.createElement("p",{className:L.leftAlignedText,title:e.buttonHyperLinkToolTip?e.buttonHyperLinkToolTip:"",onClick:e.buttonHyperLink?function(){return window.open(e.buttonHyperLink,"_blank")}:function(){return console.log("Link not available for button")}},ue.a.createElement("b",null," ",e.boldText," ")," ",e.message)):ue.a.createElement("p",null,e.message)))})),ue.a.createElement(tt.a,{modalType:"modal",open:J},ue.a.createElement(nt.a,{className:L.root,tabIndex:0},ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{className:L.buttonStack,action:ue.a.createElement(it.a,{action:"close"},ue.a.createElement(be.a,{appearance:"subtle","aria-label":"close",icon:ue.a.createElement(pt.n,null),onClick:function(){return X(!1)}}))},null!=S?S:"Add Item"),ue.a.createElement(at.a,null,ue.a.createElement(Bn.a,{onChange:function(e,t){return te(t)},className:L.root,styles:{fieldGroup:{borderColor:"transparent"}}})),ue.a.createElement(Rn.a,{className:L.buttonStack},ue.a.createElement(be.a,{className:L.buttonStack,appearance:"primary",onClick:function(){if(!(i.length-2<0||0===ee.length)){var e={boldText:ee};X(!1),re(e,!0)}}},"Submit")))))),ue.a.createElement(he,{horizontal:!0,style:L.actionButtonStack},s&&ue.a.createElement(_e,null,ue.a.createElement(be.a,{appearance:null!==(n=s.appearance)&&void 0!==n?n:void 0,onClick:function(){s.isEditorNeedToOpen?l&&l():ne()}},s.text)),u.length>0&&ue.a.createElement(_e,null,ue.a.createElement(be.a,{appearance:null!=m?m:void 0,disabled:!G||(null==U?void 0:U.length)>0&&b&&!se.some((function(e){return e})),onClick:function(){var e;D||(e=C,Q(!1),Y(N),j&&j(e),A&&A(e))}},K))))})),Hn=ue.a.memo(Nn),Un=ue.a.forwardRef((function(e,t){var n=e.onClickNextStage,r=void 0===n?function(e){}:n,i=e.onClickNext,a=void 0===i?function(e){}:i,s=e.stageIndex,l=void 0===s?1:s,c=e.data,u=void 0===c?{}:c,d=null==u?void 0:u.componentRenderData,p=Object(ce.useRef)();return Object(ce.useImperativeHandle)(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=p.current)||void 0===n||n.addUserContentMessageItem(e,t)}}})),ue.a.createElement(he,null,d.map((function(e,t){return e.handleButtonClick=function(){a(l),r(l)},ue.a.createElement(Hn,Object(o.__assign)({ref:p,key:t,cardIndex:1},e))})))})),Vn=Un,zn=ce.forwardRef((function(e,t){e.stageHeader;var n=e.onClientInteractionData,r=void 0===n?function(e){}:n,i=(e.getComponentRenderData,e.shouldEnableNext,e.onClickNext),a=void 0===i?function(e){}:i,s=(e.isHTMLEditorUpdateRequired,e.stageIndex),l=void 0===s?0:s,c=e.onClickNextStage,u=void 0===c?function(e){}:c,d=e.data,p=void 0===d?{}:d,g=function(e){var t,n,r=0;try{for(var i=Object(o.__values)(e),a=i.next();!a.done;a=i.next()){if(a.value.buttonAction==Pn.NEXT_CARD)return r;r++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(null==p?void 0:p.componentRenderData),h=new Set,f=ce.useRef(),m=Object(o.__read)(ce.useState(h),2),v=m[0],b=m[1];ce.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n;null===(n=f.current)||void 0===n||n.addUserContentMessageItem(e,t)}}}));var y=Object(o.__read)(ce.useState(g),2),C=y[0],O=y[1],S=function(e){if(O(e+1),r){var t=Object(o.__spreadArray)([],Object(o.__read)(v),!1);r(t)}},E=(null==p?void 0:p.componentRenderData)?null==p?void 0:p.componentRenderData:[];return ce.createElement(he,null,E.map((function(e,t){var n=Object(o.__assign)({},e);if(n.onSelectCheckBox=function(e,t){!function(e,t){var n=new Set(v);n.has(t)&&!e?n.delete(t):!n.has(t)&&e&&n.add(t),b(n)}(e,t)},e.buttonAction===Pn.NEXT_STAGE?n.handleButtonClick=function(){a(l),u(l)}:e.buttonAction===Pn.NEXT_CARD&&(n.handleButtonClick=function(){return S(t)}),t<=C)return ce.createElement(Hn,Object(o.__assign)({ref:f,key:t,cardIndex:l},n))})))})),Gn=zn,Wn=ue.a.forwardRef((function(e,t){e.workflowName;var n=e.workflowStages,r=void 0===n?[]:n,i=e.handleEditorOpenButtonClick,a=e.enableALSession,s=void 0!==a&&a,l=e.workflowLoadingUiStrings,c=void 0===l?["Working on it..."]:l,u=e.allowForwardNavigation,d=void 0!==u&&u,p=e.displayStatusIconInStepper,g=void 0===p||p,h=Object(o.__read)(ue.a.useState(0),2),f=h[0],m=h[1],v=Object(o.__read)(ue.a.useState(!0),2),b=v[0],y=v[1],C=Object(o.__read)(ue.a.useState(0),2),O=C[0],S=C[1],E=ue.a.useRef(),x=ue.a.useRef();ue.a.useImperativeHandle(t,(function(){return{addUserContentMessageItem:function(e,t){var n,r;b?null===(n=E.current)||void 0===n||n.addUserContentMessageItem(e,t):null===(r=x.current)||void 0===r||r.addUserContentMessageItem(e,t)}}})),ue.a.useEffect((function(){r.map((function(e,t){var n,r,o;(null===(n=e.data)||void 0===n?void 0:n.componentRenderData)&&(null===(o=null===(r=e.data)||void 0===r?void 0:r.componentRenderData)||void 0===o||o.map((function(e,t){var n;e.addActionButtonProps&&(null===(n=e.addActionButtonProps)||void 0===n?void 0:n.isEditorNeedToOpen)&&(e.handleEditorOpenButtonClick=i)})))}))})),ue.a.useEffect((function(){f>O&&S(f)}),[f,O]),ue.a.useEffect((function(){}),[f]);var I=Object(o.__read)(ue.a.useState(!1),2),w=I[0],T=I[1];ue.a.useEffect((function(){w&&(r[f].shouldEnableNext&&r[f].shouldEnableNext()?T(!1):s||setTimeout((function(){T(!1)}),2e3))}));var k=function(e){var t,n;T(!0),(null===(t=r[e+1])||void 0===t?void 0:t.getComponentRenderData)&&(null===(n=r[e+1])||void 0===n||n.getComponentRenderData()),m(e)},j={loadingUiStrings:c},P=r.slice(1),A=function(e){var t=[];return e.forEach((function(e,n){t.push(e.useCompleteStageHeader?e.stageHeader:"Step "+(n+1)+": "+e.stageHeader)})),t}(P),_=r.map((function(e){return e.gotoNextStageString})),D=r[0];return D.onClickNextStage=function(){y(!1)},D.stageIndex=0,b?ue.a.createElement(he,null,ue.a.createElement(Vn,Object(o.__assign)({ref:E},D))):ue.a.createElement(he,null,ue.a.createElement("div",{style:{height:"46px"}}),ue.a.createElement(xn,{stages:A,gotoNextStageString:_,handleButtonClick:function(e){var t,n,o;(null===(t=P[f])||void 0===t?void 0:t.onClickNext)&&P[f].onClickNext(e),e>f&&(T(!0),(null===(n=r[e+1])||void 0===n?void 0:n.getComponentRenderData)&&(null===(o=r[e+1])||void 0===o||o.getComponentRenderData())),m(e)},index:f,lastEnabledStep:O,allowForwardNavigation:d,displayStatusIcon:g}),P.map((function(e,t){if(t===f){if(w)return ue.a.createElement(Mn,Object(o.__assign)({key:t},j));var n=e;return e.stageIndex=t+1,e.onClickNextStage=k,ue.a.createElement(Gn,Object(o.__assign)({ref:x,key:t},n))}})))})),Qn=n(3388),qn=n(3389),Kn=n(3390),Yn=n(3600),Zn=n(3601),Jn=n(1498),Xn=function(){return U()?OfficeaicopilotStrings.RestrictiveSearchMessageTitleText:"Your organization's admin has restricted Copilot from accessing certain SharePoint sites."},$n=function(){return U()?OfficeaicopilotStrings.RestrictiveSearchMessageBodyText:"This limits the content Copilot can search and reference when responding to your prompts."},er=function(e){var t=e.handleRestrictiveMsgDismissClick,n=Object(o.__read)(ue.a.useState(!0),2),r=n[0],i=n[1],a=ue.a.useRef(null),s=function(){i(!r)};return ue.a.createElement(Kn.a,null,ue.a.createElement(Yn.a,{intent:"info",ref:a},function(){var e;if(r){var t=Math.round(.2*(null===(e=a.current)||void 0===e?void 0:e.offsetWidth)),n=Xn(),o=$n();if(n.length<t){var i=t-n.length;o=o.substring(0,i)+"..."}else n=n.substring(0,t),o="...";return ue.a.createElement(Qn.a,null,ue.a.createElement(qn.a,null,n),o)}return ue.a.createElement(Qn.a,null,ue.a.createElement(qn.a,null,Xn()),$n()," ",ue.a.createElement(on.a,{href:"https://go.microsoft.com/fwlink/p/?linkid=2260808"},U()?OfficeaicopilotStrings.LearnMoreString:"Learn More"))}(),ue.a.createElement(Zn.a,{containerAction:ue.a.createElement("div",null,ue.a.createElement(be.a,{appearance:"transparent",icon:r?ue.a.createElement(dn.n,null):ue.a.createElement(dn.x,null),onClick:s}),ue.a.createElement(be.a,{appearance:"transparent",icon:ue.a.createElement(Jn.s,null),onClick:t}))})))},tr=n(3392),nr=n(3354);var rr,or,ir=function(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},freCard:null!==(n=e.freCard)&&void 0!==n?n:{},freImage:null!==(r=e.freImage)&&void 0!==r?r:{},freHeaderText:null!==(o=e.freHeaderText)&&void 0!==o?o:{},freDescriptionText:null!==(i=e.freDescriptionText)&&void 0!==i?i:{},freButton:null!==(a=e.freButton)&&void 0!==a?a:{}};return Object(pe.a)(s)}({freCard:Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("12px")),{maxWidth:"288px"}),freHeaderText:{fontFamily:"-apple-system",lineHeight:"normal"},freDescriptionText:{marginTop:"12px",fontFamily:"-apple-system",lineHeight:"normal"},freButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("16px")),Me.a.borderRadius("12px")),{minHeight:"52px",height:"auto",fontFamily:"-apple-system",fontWeight:"600",fontSize:"17px",justifyContent:"center"})}),ar=Object(E.a)(P),sr={freCard:{},root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("12px","16px")),{alignItems:"center",textAlign:"center",color:ar.neutralPrimary,backgroundColor:ar.neutralLight,boxShadow:ar.shadow4}),Me.a.margin("1px","16px","none")),Me.a.border("1px","solid",ar.neutralLight)),Me.a.borderRadius("8px")),freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:Object(o.__assign)(Object(o.__assign)({textAlign:"center",whiteSpace:"pre-wrap"},Me.a.padding("1px")),Me.a.margin("20px","0px","0px")),freButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:ar.neutralLight,width:"100%"},Me.a.padding("5px","12px")),Me.a.margin("20px","0px","0px")),Me.a.borderRadius("4px")),{"@media (forced-colors: none)":Object(o.__assign)(Object(o.__assign)({backgroundColor:ar.themePrimary},Me.a.border("none")),{":hover":Object(o.__assign)({color:ar.neutralLight,backgroundColor:ar.themePrimary},Me.a.border("none")),":active":Object(o.__assign)({color:ar.neutralLight,backgroundColor:ar.themePrimary},Me.a.border("none"))})})},lr=Object(pe.a)(sr),cr=function(){return U()?OfficeaicopilotStrings.FREHeaderTextLabel:"freSharedHeaderText"},ur=function(e){var t=e.headerText,n=void 0===t?U()?OfficeaicopilotStrings.FREHeaderText:"Copilot is here to help!":t,o=e.descriptionText,i=e.freImagePath,s=e.handleFreButtonClick,l=void 0===s?function(){}:s,c=e.shouldFocusOnComponentMount,u=void 0!==c&&c,d=e.hideGetStartedButton,p=void 0!==d&&d,g=e.overrideStyles,h=function(){var e=lr(),t=ir();a()===r.IOS&&W(e,t);return e}();W(h,g);var f=" "+n+" ",m=" "+o+" ";return Object(ce.useEffect)((function(){var e;u&&(null===(e=document.getElementById("FreSharedId"))||void 0===e||e.focus())})),ue.a.createElement(he,{style:h.root,customProperties:{role:L,"aria-labelledby":cr()}},ue.a.createElement(De.a,{src:i,className:h.freImage,alt:""}),ue.a.createElement(tr.a,{id:cr(),className:h.freHeaderText},f),ue.a.createElement(nr.a,{id:U()?OfficeaicopilotStrings.FREDescriptionTextLabel:"freSharedDescription",className:h.freDescriptionText},m),p?null:ue.a.createElement(be.a,{className:h.freButton,onClick:l},U()?OfficeaicopilotStrings.FREButtonText:"Get started"))},dr=function(){return U()?OfficeaicopilotStrings.ZQMHeaderTextLabel:"zqmHeaderText"};var pr,gr,hr,fr,mr,vr=Object(E.a)(P),br=function(e){var t,n,r,o,i,a={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},buttonStack:null!==(n=e.buttonStack)&&void 0!==n?n:{},cardHeader:null!==(r=e.cardHeader)&&void 0!==r?r:{},zeroQueryButton:null!==(o=e.zeroQueryButton)&&void 0!==o?o:{},zeroQueryButtonDisabled:{},zeroQuerySkillText:null!==(i=e.zeroQuerySkillText)&&void 0!==i?i:{}};return Object(pe.a)(a)}({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({maxWidth:"288px"},Me.a.padding(vr.spacingVerticalM,vr.spacingHorizontalL)),{fontFamily:"-apple-system"}),Me.a.margin(vr.spacingVerticalNone,vr.spacingHorizontalL,vr.spacingVerticalS)),{boxShadow:vr.shadow2}),cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:Object(o.__assign)({},Me.a.gap(vr.spacingVerticalS)),zeroQueryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding(vr.spacingVerticalL,vr.spacingHorizontalXL)),{minHeight:"40px"}),Me.a.borderRadius(vr.borderRadiusXLarge)),(rr={fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal"},rr["& .".concat(gn.a.icon)]=Object(o.__assign)({},Me.a.margin("0px","11px","0px","0px")),rr)),zeroQuerySkillText:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("4px")),{backgroundColor:Be.a.colorNeutralBackground3,color:Be.a.colorNeutralForeground2}),Me.a.padding("3px")),(or={},or["&:hover"]={backgroundColor:Be.a.colorNeutralBackground2Hover,color:Be.a.colorNeutralForeground1Hover},or))}),yr=Object(E.a)(P),Cr={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("12px")),Me.a.borderRadius("8px")),Me.a.margin("16px")),{boxShadow:yr.shadow4,color:yr.neutralPrimary,backgroundColor:yr.neutralLight}),rootHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",yr.neutralLighterAlt)),buttonStack:Object(o.__assign)(Object(o.__assign)({},Me.a.gap("4px")),{marginTop:"8px"}),cardHeader:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{whiteSpace:"pre-wrap"}),zeroQueryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",height:"fit-content",textAlign:"start",backgroundColor:yr.neutralLight},Me.a.border("1px","solid",yr.neutralLighterAlt)),pn.a.body1),(pr={},pr["&:hover .".concat(gn.a.icon)]={color:yr.themePrimary},pr)),zeroQueryButtonDisabled:(gr={color:yr.neutralQuaternary},gr["&:hover .".concat(gn.a.icon)]={filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"},gr),zeroQuerySkillText:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("4px")),{backgroundColor:Be.a.colorNeutralBackground3,color:Be.a.colorNeutralForeground2}),Me.a.padding("3px")),(hr={},hr["&:hover"]={backgroundColor:Be.a.colorNeutralBackground2Hover,color:Be.a.colorNeutralForeground1Hover},hr))},Or=Object(pe.a)(Cr),Sr=ue.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,o=e.headerText,i=e.isHVCAppChatV2Enabled,s=e.hvcPromptStringsList,l=e.handleButtonClick,c=void 0===l?function(e){console.log("suggestion clicked:"+e)}:l,u=function(){var e=Or(),t=br();a()===r.IOS&&(e=W(e,t));return e}(),d=f();W(u,t),u.zeroQueryButtonDisabled=Object(x.a)(u.zeroQueryButton,u.zeroQueryButtonDisabled),u.rootHighContrast=Object(x.a)(u.root,u.rootHighContrast);return ue.a.createElement(un.a,{className:d?u.rootHighContrast:u.root,"aria-labelledby":dr()},ue.a.createElement(_e,null,ue.a.createElement(ut.a,{id:dr(),className:u.cardHeader},o)),ue.a.createElement(he,{style:u.buttonStack,customProperties:{role:R}},n.map((function(e,t){var r,o,a,l=[];return i&&(null==s?void 0:s.length)>0&&(l=Y(e.promptSuggestion,s)),ue.a.createElement(be.a,{size:"large",role:F,icon:(r=e.iconRegular,o=e.iconHover,a=Object(Ee.a)(o,r),ue.a.createElement(a,null)),key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":n.length,className:e.isDisabled?u.zeroQueryButtonDisabled:u.zeroQueryButton,onClick:function(){c(e.promptSuggestion)}},i&&l.length>0?l.map((function(e,t){return e.promptType===b.Skill?ue.a.createElement("span",{className:u.zeroQuerySkillText,key:t},e.promptText):ue.a.createElement("span",{key:t},e.promptText)})):e.promptSuggestion)}))))})),Er=n(2809),xr=n(1458),Ir=Object(E.a)(P),wr={root:Object(o.__assign)(Object(o.__assign)({},Me.a.margin("16px")),Me.a.gap("8px")),zeroQueryV2Button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",height:"auto",textAlign:"start",backgroundColor:Be.a.colorNeutralBackground1},Me.a.padding("12px","16px")),Me.a.borderRadius("8px")),Me.a.gap("8px")),pn.a.body1),(fr={boxShadow:Be.a.shadow2},fr["&:hover"]={boxShadow:Be.a.shadow8,backgroundColor:Be.a.colorNeutralBackground1},fr["& .".concat(xr.a.prompt)]={gridColumnStart:"icon"},fr)),zeroQuerySkillText:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("4px")),{backgroundColor:Be.a.colorNeutralBackground3,color:Be.a.colorNeutralForeground2}),Me.a.padding("3px")),(mr={},mr["&:hover"]={backgroundColor:Be.a.colorNeutralBackground2Hover,color:Be.a.colorNeutralForeground1Hover},mr)),zeroQueryHintText:{color:Be.a.colorNeutralForeground4},zeroQueryIcon:{color:Ir.themePrimary}},Tr=Object(pe.a)(wr),kr=ue.a.memo((function(e){var t=e.overrideStyles,n=e.promptSuggestions,r=e.isHVCAppChatV2Enabled,o=e.hvcPromptStringsList,i=e.handleButtonClick,a=Tr();W(a,t);return ue.a.createElement(he,{style:a.root,customProperties:{role:R}},n.map((function(e,t){var s,l,c,u,d,p,g,h,f="",m="",v="",y="",C=[];if(r)if((null==o?void 0:o.length)>0)C=Y(e.promptSuggestionText,o);else{var O=function(e){var t=T,n=T,r=T,o=T;if(!e||0===e.length)return{prefixText:r,skillText:o,inputText:t,hintText:n};var i=e.lastIndexOf("}"),a=e.lastIndexOf("{",i);i>a&&a>=0&&(o=e.slice(a+1,i),r=e.slice(0,a),e=e.slice(i+1));var s=e.lastIndexOf("]"),l=e.lastIndexOf("[",s);return s>l&&l>=0?(t=e.slice(0,l),n=e.slice(l,s+1)):t=e,{prefixText:r,skillText:o,inputText:t,hintText:n}}(e.promptSuggestionText);v=null!==(s=null==O?void 0:O.prefixText)&&void 0!==s?s:"",y=null!==(l=null==O?void 0:O.skillText)&&void 0!==l?l:"",f=null!==(c=null==O?void 0:O.inputText)&&void 0!==c?c:"",m=null!==(u=null==O?void 0:O.hintText)&&void 0!==u?u:""}else{O=function(e){var t=T,n=T,r=e.lastIndexOf("]"),o=e.lastIndexOf("[",r);return r>o&&o>=0?(t=e.slice(0,o),n=e.slice(o,r+1)):t=e,{inputText:t,hintText:n}}(e.promptSuggestionText);f=null!==(d=null==O?void 0:O.inputText)&&void 0!==d?d:"",m=null!==(p=null==O?void 0:O.hintText)&&void 0!==p?p:""}return ue.a.createElement(Er.a,{role:F,icon:(g=e.iconRegular,h=g,ue.a.createElement(h,{className:a.zeroQueryIcon})),key:t,disabled:e.isDisabled||!1,"aria-posinset":t+1,"aria-setsize":n.length,className:a.zeroQueryV2Button,category:e.promptSuggestionCategory,prompt:0===C.length?ue.a.createElement(nr.a,null,r&&v,r&&y.length>0&&ue.a.createElement("span",{className:a.zeroQuerySkillText},y),f,ue.a.createElement("span",{className:a.zeroQueryHintText},m)):ue.a.createElement(nr.a,null,C.map((function(e,t){switch(e.promptType){case b.Ghost:return ue.a.createElement("span",{className:a.zeroQueryHintText},e.promptText);case b.Skill:return ue.a.createElement("span",{className:a.zeroQuerySkillText},e.promptText);case b.Regular:default:return ue.a.createElement("span",null,e.promptText)}}))),onClick:function(){var t=f;y.length>0&&(t=v+y+t),C.length>0&&(t=C.map((function(e){return e.promptType===b.Ghost||e.promptType===b.File?"":e.promptText})).join("")),i(t,e.promptSuggestionText)}})})))})),jr=n(3333);function Pr(){return U()?OfficeaicopilotStrings.DeleteAllChatHistoryButtonText:"Delete all Copilot history"}function Ar(){return U()?OfficeaicopilotStrings.NewConversationButtonText:"Create new conversation"}function _r(){return U()?OfficeaicopilotStrings.ShowChatHistoryButtonText:"Chat history"}var Dr,Lr=Object(E.a)(_),Mr={root:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("visible")),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:Lr.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:Lr.colorNeutralBackground3Hover}}})},Br={root:Object(o.__assign)({},Me.a.border("none"))},Rr=Object(pe.a)(Mr),Fr=Object(pe.a)(Br),Nr={ShowChatHistoryAllButton:Object(o.__assign)({},Me.a.margin("0px","16px"))},Hr=Object(pe.a)(Nr),Ur=ce.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return ce.createElement(be.a,{className:Object(x.a)(Rr().root,Hr().ShowChatHistoryAllButton,n),icon:ce.createElement(jr.b,{className:r}),onClick:t,"aria-label":_r()},_r())})),Vr=n(3570),zr=n(3403),Gr=n(3579),Wr=n(2853),Qr=function(e){var t,n,r=Sn();return ue.a.createElement(he,{style:r.root,customProperties:{role:R}},ue.a.createElement(zr.a,{variant:"medium"},null!==(t=e.launchText)&&void 0!==t?t:"Would you like to use Copilot Workflows to generate the content based on the steps recommended by your organization?"),ue.a.createElement(he,{horizontal:!0},ue.a.createElement(_e,null,ue.a.createElement(be.a,{appearance:"primary",style:{marginTop:"5px",borderBlockStyle:"dashed"},onClick:function(){var t;null===(t=e.onLaunch)||void 0===t||t.call(e)}},ue.a.createElement(Gr.a,{style:{marginRight:"5px",paddingTop:"3px"}},function(e,t,n){void 0===n&&(n={});var r=Object(Ee.a)(t,e);return ue.a.createElement(r,{style:n})}(Wr.e,Wr.e)),null!==(n=e.buttonText)&&void 0!==n?n:"Launch Copilot Workflows"))))},qr=n(1564),Kr=function(){return ce.useContext(qr.a)},Yr=Object(E.a)(P),Zr={stack:{},AccordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:Yr.neutralPrimary,marginBottom:"8px"},AccordionCardButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"},Me.a.margin("5px","6px","0px","4px")),Me.a.border("1px","solid",Yr.neutralLighterAlt)),Me.a.borderRadius("4px")),Me.a.padding("6px","10px","6px","6px")),(Dr={backgroundColor:"transparent",color:Yr.neutralPrimary,top:"0",zIndex:"1",float:"right",height:"auto"},Dr["& .".concat(gn.a.icon)]={fontSize:"inherit",height:"inherit",marginRight:"4px"},Dr["&:hover:enabled"]={color:Yr.black},Dr["&:focus"]={color:Yr.black},Dr["&:disabled"]=Object(o.__assign)(Object(o.__assign)({},Me.a.borderColor(Yr.neutralPrimaryAlt)),{color:Yr.neutralQuaternary,backgroundColor:Yr.neutralTertiary}),Dr))},Jr=Object(pe.a)(Zr),Xr=function(e){var t=e.styles,n=e.cardButtons,r=W(Jr(),t);return ue.a.createElement(Gr.a,{horizontal:!0,wrap:!0},ue.a.createElement(Gr.a,{horizontal:!0,className:r.AccordionCardFooter},null==n?void 0:n.map((function(e,t){return ue.a.createElement(be.a,{tabIndex:0,key:t,className:r.AccordionCardButton,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:null==e?void 0:e.handleOnMouseEnter,onMouseLeave:null==e?void 0:e.handleOnMouseLeave,onFocus:null==e?void 0:e.handleOnMouseEnter,onBlur:null==e?void 0:e.handleOnMouseLeave},e.buttonText)}))))},$r=Object(E.a)(P),eo={stack:{"> *":{marginBottom:"12px"}},contentCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",$r.neutralLighterAlt)),Me.a.margin("8px","20px","8px","15px")),Me.a.padding("8px")),{boxShadow:$r.shadow4,backgroundColor:$r.neutralLight}),Me.a.borderRadius($r.borderRadiusXLarge)),{overflowWrap:"anywhere",color:$r.neutralPrimary}),contentHeader:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{marginBottom:"12px"})},to=Object(pe.a)(eo);function no(e,t){return ue.a.createElement(Xr,{styles:e,cardButtons:t})}var ro,oo=function(e){var t,n,r=e.styles,o=e.body,i=W(to(),r),a=o.renderHeader?o.renderHeader((function(){})):(null===(t=o.cardContent)||void 0===t?void 0:t.contentHeader)?ue.a.createElement(ut.a,{className:i.contentHeader},o.cardContent.contentHeader):void 0,s=function(){var e;return null===(e=o.cardContent)||void 0===e?void 0:e.contentBody},l=o.renderBody?o.renderBody((function(){return s(o.cardContent)})):s(o.cardContent),c=o.renderFooter?o.renderFooter((function(){var e;return no(r,null===(e=o.cardContent)||void 0===e?void 0:e.cardButtons)})):no(r,null===(n=o.cardContent)||void 0===n?void 0:n.cardButtons);return ue.a.createElement(he,{style:i.contentCard,customProperties:{tabIndex:-1}},a,l,c)};!function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(ro||(ro={}));var io=function(e){return Object(pe.a)({accordionCardRoot:{paddingTop:"5px",marginBottom:"8px",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",fontWeight:"400",lineHeight:"20px"},accordionCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({flexWrap:"wrap",backgroundColor:"".concat(e.palette.white)},Me.a.border("1px","solid",e.palette.neutralLighterAlt)),Me.a.borderRadius("8px")),{marginLeft:"15px",marginRight:"20px"}),Me.a.gap("4px")),Me.a.padding("8px")),{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)","> *":{marginBottom:"12px"}}),cardHeader:Object(o.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},Me.a.margin("12px 12px 0 12px")),contentHeader:Object(o.__assign)({fontWeight:"600",fontSize:"16px",lineHeight:"22px"},Me.a.margin("4px")),contentTitleGroup:{display:"block",width:"auto","> button":{marginLeft:"10px",marginTop:"5px",width:"16px",height:"16px",color:"".concat(e.palette.black),top:"0",zIndex:"1",float:"right",selectors:{":hover":{backgroundColor:"transparent",color:"".concat(e.palette.black)},":focus":{backgroundColor:"transparent",color:"".concat(e.palette.black)}},"> i":{fontSize:"12px"}}}})},ao=n(1852),so=function(e){var t=e.index,n=ue.a.useRef(),r=Object(o.__read)(ue.a.useState(!1),2),i=r[0],a=r[1],s=function(e){var t;a(!i),null===(t=n.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault()},l=Kr(),c=io(l)(),u={styles:e.styles,feedbackSectionPosition:ro.None,shouldShowAIGeneratedIndicator:!0,body:{cardContent:e.cardContent,renderHeader:function(n){if(void 0!==e.cardContent){var r=ue.a.createElement(ao.a,{id:"RelatedQuestionExpand".concat(t),iconProps:{iconName:"ChevronDown"},onClick:s,"data-is-focusable":!1,tabIndex:-1,ariaLabel:""});return ue.a.createElement(he,null,ue.a.createElement(he,{style:Object(x.a)(c.contentTitleGroup,e.styles.contentTitleGroup)},ue.a.createElement(zr.a,{className:c.contentHeader},e.cardContent.contentHeader),r),i&&e.cardContent.contentBody?n():void 0)}},renderBody:function(t){if(i&&e.cardContent.contentBody)return t()},renderFooter:function(t){return i&&e.cardContent.contentBody?t():null}}};return ue.a.createElement(oo,Object(o.__assign)({key:t,styles:e.styles},u))},lo=function(e,t){if(!t.cardContent.length)return null;try{if(1===t.cardContent.length){var n={styles:e,feedbackSectionPosition:ro.None,body:{cardContent:t.cardContent[0],renderHeader:function(){return ue.a.createElement(zr.a,{className:e.contentHeader},t.cardContent[0].contentHeader)}}};return ue.a.createElement(he,null,ue.a.createElement(oo,Object(o.__assign)({key:0},n)))}return ue.a.createElement(he,null,t.cardContent.map((function(t,n){return ue.a.createElement(so,{key:n,index:n,styles:e,cardContent:t})})))}catch(e){return null}},co=function(e){var t=e.styles,n=e.body,r=Kr(),o=io(r)(),i={role:B,"aria-live":"assertive",tabIndex:0};return ue.a.createElement(he,{style:Object(x.a)(o.accordionCardRoot,t.accordionCardRoot),customProperties:i},ue.a.createElement(he,{style:Object(x.a)(o.accordionCard,t.accordionCard),customProperties:{tabIndex:-1}},ue.a.createElement(he,null,ue.a.createElement(zr.a,{className:o.cardHeader},n.cardHeader),lo(o,n))))},uo=function(e){var t,n,r,o,i,a,s,l,c,u;return{buttonBarRoot:null!==(t=e.buttonBarRoot)&&void 0!==t?t:{},primaryButton:null!==(n=e.primaryButton)&&void 0!==n?n:{},defaultButton:null!==(r=e.defaultButton)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{},combinedButtonIcon:null!==(i=e.combinedButtonIcon)&&void 0!==i?i:{},iconButton:null!==(a=e.iconButton)&&void 0!==a?a:{},combinedButton:null!==(s=e.combinedButton)&&void 0!==s?s:{},minifiedButton:null!==(l=e.minifiedButton)&&void 0!==l?l:{},showMeButton:null!==(c=e.showMeButton)&&void 0!==c?c:{},showMeButtonBarRoot:null!==(u=e.showMebuttonBarRoot)&&void 0!==u?u:{}}};function po(e){var t=uo(e);return Object(pe.a)(t)}var go,ho,fo,mo,vo={combinedButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:"40px",minWidth:"40px"},Me.a.padding("4px","8px")),pn.a.caption1),{fontFamily:"-apple-system",lineHeight:"normal"})},bo=(po(vo),Object(E.a)(P)),yo=Object(o.__assign)(Object(o.__assign)({backgroundColor:bo.neutralLight},Me.a.border("1px","solid",bo.neutralLighterAlt)),Me.a.borderRadius(bo.borderRadiusMedium)),Co=Object(o.__assign)({height:"16px",width:"16px"},Me.a.padding(0)),Oo=Object(o.__assign)(Object(o.__assign)({height:"24px",minWidth:"20px"},Me.a.padding("4px","8px")),pn.a.caption1),So={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px",flexWrap:"wrap",rowGap:"8px"},showMeButtonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row"},primaryButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",bo.themeSecondary)),Me.a.borderRadius(bo.borderRadiusMedium)),{"@media (forced-colors: none)":{backgroundColor:bo.themeSecondary,"&:hover":Object(o.__assign)({backgroundColor:bo.themePrimary},Me.a.border("1px","solid",bo.themePrimary)),"&:active":Object(o.__assign)({backgroundColor:bo.themePrimary},Me.a.border("1px","solid",bo.themePrimary)),"&:disabled":Object(o.__assign)({backgroundColor:bo.neutralLighter},Me.a.border("1px","solid",bo.neutralQuaternary)),"&:hover:active":Object(o.__assign)({backgroundColor:bo.themeTertiary},Me.a.border("1px","solid",bo.themeTertiary))}}),defaultButton:Object(o.__assign)({},yo),showMeButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:bo.neutralLight},Me.a.border("1px","solid",bo.neutralLighterAlt)),Me.a.borderRadius(bo.borderRadiusMedium)),{"&:hover":{color:bo.themePrimary}}),icon:Object(o.__assign)(Object(o.__assign)({height:"24px",width:"24px"},Me.a.padding(0)),(go={},go["&".concat(gn.a.icon)]={height:"20px",width:"20px"},go)),combinedButtonIcon:Object(o.__assign)(Object(o.__assign)({},Co),(ho={},ho["&".concat(gn.a.icon)]={height:"16px",width:"16px"},ho)),iconButton:Object(o.__assign)({height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},Me.a.padding("2px")),combinedButton:Object(o.__assign)({},Oo),minifiedButton:(fo={height:"40px",width:"44px",minWidth:"44px"},fo["&".concat(gn.a.icon)]={height:"24px",width:"24px"},fo)},Eo=(Object(pe.a)(So),Object(pe.a)({emptyIcon:{height:"0px",width:"0px"}}),Object(pe.a)({authButton:Object(o.__assign)(Object(o.__assign)({},yo),Oo),appIcon:Object(o.__assign)({},Co),title:Object(o.__assign)({},pn.a.caption1)})),xo=function(e){var t,n,r,o,i,a,s,l;return{footerBar:null!==(t=e.footerBar)&&void 0!==t?t:{},headerBar:null!==(n=e.headerBar)&&void 0!==n?n:{},feedbackButton:null!==(r=e.feedbackButton)&&void 0!==r?r:{},feedbackButtonsStack:null!==(o=e.feedbackButtonsStack)&&void 0!==o?o:{},feedbackText:null!==(i=e.feedbackText)&&void 0!==i?i:{},feedbackTextMinified:null!==(a=e.feedbackTextMinified)&&void 0!==a?a:{},feedbackDisclaimerStack:null!==(s=e.feedbackDisclaimerStack)&&void 0!==s?s:{},tooltipText:null!==(l=e.tooltipText)&&void 0!==l?l:{}}};var Io,wo,To,ko,jo=Object(E.a)(P),Po={feedbackTextMinified:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:jo.neutralSecondaryAlt,fontFamily:"-apple-system",lineHeight:"normal"}),feedbackButton:Object(o.__assign)(Object(o.__assign)({width:"44px",height:"44px",maxWidth:"unset",lineHeight:"normal",backgroundColor:"transparent"},Me.a.border("0px")),(mo={},mo["&:hover .".concat(gn.a.icon)]={cursor:"pointer",color:jo.themePrimary},mo)),tooltipText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:jo.neutralPrimary,fontFamily:"-apple-system",lineHeight:"normal"})},Ao=function(){return Po},_o=(Io=xo(Po),Object(pe.a)(Io),Object(E.a)(P)),Do={footerBar:Object(o.__assign)(Object(o.__assign)({},Me.a.padding("4px","0px")),{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}),headerBar:Object(o.__assign)({},Me.a.padding("0px","4px")),feedbackText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption2),{color:_o.neutralSecondaryAlt}),feedbackTextMinified:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:_o.neutralSecondaryAlt}),feedbackButtonsStack:Object(o.__assign)({alignItems:"center"},Me.a.gap("2px")),feedbackButton:(wo={backgroundColor:"transparent"},wo["&:hover .".concat(gn.a.icon)]={cursor:"pointer",color:_o.themePrimary},wo),feedbackDisclaimerStack:Object(o.__assign)({alignItems:"center"},Me.a.gap("2px")),tooltipText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:_o.neutralPrimary})},Lo=(Object(pe.a)(Do),po({buttonBarRoot:{marginTop:"0px",width:"auto"},minifiedButton:Object(o.__assign)({},Ao().feedbackButton),icon:{}})),Mo=function(e){var t,n,r,i,a,s,l,c;return Object(o.__assign)(Object(o.__assign)({defaultRoot:null!==(t=e.defaultRoot)&&void 0!==t?t:{},loader:null!==(n=e.loader)&&void 0!==n?n:{},human:null!==(r=e.human)&&void 0!==r?r:{},humanContent:null!==(i=e.humanContent)&&void 0!==i?i:{},chat:null!==(a=e.chat)&&void 0!==a?a:{},chatContent:null!==(s=e.chatContent)&&void 0!==s?s:{},chatCard:null!==(l=e.chatCard)&&void 0!==l?l:{},text:null!==(c=e.text)&&void 0!==c?c:{},strikeThroughText:{},cardHighContrast:{}},uo(e)),xo(e))},Bo={chatCard:Object(o.__assign)({width:"inherit"},Me.a.padding("16px")),text:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{fontFamily:"-apple-system",lineHeight:"normal"})},Ro=function(e){return Object(pe.a)(Mo(e))}(Bo),Fo=Object(E.a)(P),No=Object(o.__assign)(Object(o.__assign)({defaultRoot:Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),{alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"}),loader:Object(o.__assign)({boxSizing:"border-box",display:"flex",width:"inherit"},Me.a.gap("4px")),human:{alignSelf:"flex-end",maxWidth:"80%"},humanContent:{color:Fo.black,backgroundColor:Fo.themeLight},chat:{width:"100%",alignSelf:"flex-start",boxShadow:Fo.shadow2},chatContent:{backgroundColor:Fo.neutralLight},chatCard:Object(o.__assign)({width:"inherit"},Me.a.padding("12px")),text:Object(o.__assign)({},pn.a.body1),strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",Fo.neutralLighterAlt))},(To=So,ko=vo,a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},To),ko):Object(o.__assign)({},To))),function(){var e=Do,t=Ao();return a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},e),t):Object(o.__assign)({},e)}()),Ho=function(){var e=No,t=Bo;return a()===r.IOS?Object(o.__assign)(Object(o.__assign)({},e),t):Object(o.__assign)({},e)},Uo=Object(pe.a)(No),Vo={colorBrandFlair1:Fo.themeDarkAlt,colorBrandFlair2:Fo.themeLighterAlt,colorBrandFlair3:Fo.themeLighter,colorBrandFlair1Transparent:Fo.themeDarkAltTransparent,colorBrandFlair2Transparent:Fo.themeLighterAltTransparent,colorBrandFlair3Transparent:Fo.themeLighterTransparent},zo=Object(E.a)(P),Go=Object(o.__assign)({adaptiveCardRoot:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{color:zo.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":Object(o.__assign)({},Me.a.border("1px","solid",zo.neutralQuaternaryAlt)),"& p":{display:"inline"},"& .ac-textBlock":{overflowWrap:"anywhere",display:"inline !important"},"& .ac-adaptiveCard":{display:"inline !important"}})},Ho()),Wo=Object(pe.a)(Go);function Qo(e){var t=e.renderData,n=e.fallbackElement,r=e.customMessageRenderers;if(!t||!r)return ue.a.createElement(ue.a.Fragment,null,n);var i=r.renderers[t.component];return i?ue.a.createElement(i,Object(o.__assign)({},t.props)):r.renderFallback(t)}var qo,Ko,Yo=n(224),Zo=n(2807),Jo=n(1134),Xo=function(e){var t,n,r,o;if(!e)return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0};try{var i=e.messageExtensionPluginInfo.errorType,a=(null===(n=null===(t=e.oAuthCard)||void 0===t?void 0:t.buttons)||void 0===n?void 0:n.length)&&(null===(o=null===(r=e.oAuthCard)||void 0===r?void 0:r.buttons[0])||void 0===o?void 0:o.value),s=JSON.parse(e.messageExtensionPluginInfo.failedActivity),l=null==s?void 0:s.request;if(!l)throw new Error("Failed to parse pluginAuthError");return{requestType:i,authUrl:a,botInvokeRequest:{botId:l.msaAppId,appId:l.metaOsAppId,requestBody:{name:l.name,value:l.value}},appId:l.metaOsAppId}}catch(e){return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,appId:void 0}}},$o=n(3349),ei=n(3351),ti=n(3352),ni=function(e){var t=e.children,n=e.popoverTitle,r=e.popoverDuration,i=Object(o.__read)(Object(ce.useState)(!1),2),a=i[0],s=i[1],l=Object(ce.useRef)(void 0);return Object(ce.useEffect)((function(){a&&(l.current&&clearTimeout(l.current),l.current=window.setTimeout((function(){s(!1),l.current=void 0}),null!=r?r:2e3)),a||void 0===l.current||(clearTimeout(l.current),l.current=void 0)}),[r,a]),ue.a.createElement($o.a,{withArrow:!0,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:a,onOpenChange:function(e,t){var n;s(null!==(n=t.open)&&void 0!==n&&n)}},ue.a.createElement(ei.a,null,t),ue.a.createElement(ti.a,{"aria-live":"assertive"},n))};!function(e){e.Primary="Primary",e.Default="Default"}(qo||(qo={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(Ko||(Ko={}));var ri,oi,ii,ai=function(e,t,n,r,o,i){var a=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},s=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};console.log(e.text);var l,c,u,d=e.text?t.combinedButton:t.minifiedButton;return ue.a.createElement(be.a,{tabIndex:0,key:o,appearance:e.type==qo.Primary?"primary":void 0,className:e.type==qo.Primary?Object(x.a)(d,t.primaryButton):d,icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(l=e.iconRegular,c=e.iconHover,u=Object(Ee.a)(c,l),ue.a.createElement(u,null)):ue.a.createElement(e.iconRegular,null),className:t.icon}:void 0,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:a,onMouseLeave:s,onFocus:a,onBlur:s,disabled:e.isDisabled},null==e?void 0:e.text)},si=function(e){var t=e.actionBarButtons,n=e.styles,r=e.messageContentElementId,i=e.chatCardIndex,a=e.telemetryData,s=void 0===a?"":a;return ue.a.createElement(he,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?ue.a.createElement(ni,Object(o.__assign)({key:t},e.popoverProps),ai(e,n,r,i,t,s)):ai(e,n,r,i,t,s)})))},li=n(3523),ci=function(e,t,n,r,o,i){var a,s,l,c=e.text?t.combinedButton:t.iconButton,u=e.type==qo.Primary?t.primaryButton:t.defaultButton,d=function(){e.handleOnMouseEnter&&e.handleOnMouseEnter()},p=function(){e.handleOnMouseLeave&&(null==e||e.handleOnMouseLeave())};return ue.a.createElement(be.a,{tabIndex:0,key:o,"aria-label":null==e?void 0:e.ariaLabel,title:e.title,appearance:e.type==qo.Primary?"primary":void 0,className:Object(x.a)(c,u),icon:(null==e?void 0:e.iconRegular)?{children:e.iconHover?(a=e.iconRegular,s=e.iconHover,l=Object(Ee.a)(s,a),ue.a.createElement(l,null)):ue.a.createElement(e.iconRegular,null),className:(null==e?void 0:e.text)?t.combinedButtonIcon:t.icon}:void 0,onClick:function(){e.handleButtonOnClick&&e.handleButtonOnClick(n,r,i)},onMouseEnter:d,onMouseLeave:p,onFocus:d,onBlur:p,disabled:e.isDisabled},null==e?void 0:e.text)},ui=function(e){var t=e.actionBarButtons,n=e.styles,r=e.messageContentElementId,i=e.chatCardIndex,a=e.telemetryData,s=void 0===a?"":a,c=e.pluginAuthButtonProps,u=h();return ue.a.createElement(he,{style:n.buttonBarRoot,customProperties:{tabIndex:-1}},null==t?void 0:t.map((function(e,t){return e.popoverProps?ue.a.createElement(ni,Object(o.__assign)({key:t},e.popoverProps),ci(e,n,r,i,t,s)):ci(e,n,r,i,t,s)})),c&&ue.a.createElement(li.a,Object(o.__assign)({},c,{customStyles:Eo,theme:u===l.defaultBlack?"dark":"light"})))},di=function(e){return s()?ue.a.createElement(si,Object(o.__assign)({},e)):ue.a.createElement(ui,Object(o.__assign)({},e))},pi=n(2817),gi=n(3401),hi=n(2841);!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(ri||(ri={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(oi||(oi={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(ii||(ii={}));var fi=function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}};function mi(e){var t=fi(e);return Object(pe.a)(t)}var vi,bi=mi({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),yi=Object(E.a)(P),Ci=mi({tooltipText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:yi.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},Me.a.padding("12px")),Me.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),Oi=function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n])},Si=function(e){switch(void 0===e&&(e=ii.NonEncryption),e){case ii.Encryption:return s()?ue.a.createElement(Mt.q,null):ue.a.createElement(Mt.o,null);case ii.Warning:return s()?ue.a.createElement(hi.e,null):ue.a.createElement(hi.c,null);case ii.NonEncryption:default:return s()?ue.a.createElement(Mt.m,null):ue.a.createElement(Mt.k,null)}},Ei=function(e,t){switch(void 0===e&&(e=ii.NonEncryption),e){case ii.Encryption:return s()?ue.a.createElement(Mt.p,{primaryFill:t}):ue.a.createElement(Mt.n,{primaryFill:t});case ii.Warning:return s()?ue.a.createElement(hi.d,{primaryFill:t}):ue.a.createElement(hi.b,{primaryFill:t});case ii.NonEncryption:default:return s()?ue.a.createElement(Mt.l,{primaryFill:t}):ue.a.createElement(Mt.j,{primaryFill:t})}},xi=function(e){var t,n,o=e.styles,i=e.clpSensitivityIndicatorData,s=function(){var e=Ci(),t=bi();a()===r.IOS&&Oi(e,t);return e}();return Oi(s,o),ue.a.createElement($o.a,{openOnHover:!0},ue.a.createElement(ei.a,null,ue.a.createElement("span",{className:s.icon},i.icon?ue.a.createElement(i.icon,null):(t=i.iconType,n=i.color,void 0===t&&(t=ii.NonEncryption),n?Ei(t,n):Si(t)))),ue.a.createElement(ti.a,{className:s.tooltipStack},ue.a.createElement(he,null,i.badgeText&&ue.a.createElement(nr.a,{className:s.badgeText},i.badgeText),ue.a.createElement(nr.a,{className:s.tooltipText},i.tooltipText))))},Ii=function(e,t){var n=Object(Ee.a)(t,e);return ue.a.createElement(n,null)},wi=function(e,t){return ue.a.createElement(me.a,{content:ue.a.createElement(ut.a,{className:e.tooltipText},t?J():Z()),relationship:"description"},ue.a.createElement(ut.a,{className:e.feedbackTextMinified},t?U()?OfficeaicopilotStrings.AIPowered:"AI-powered suggestion":U()?OfficeaicopilotStrings.AIGenerated:"AI generated"))},Ti=function(e,t){var n=t?J():Z();return ue.a.createElement(ut.a,{className:e.feedbackText},n)},ki=function(e){var t=e?J():Z();return ue.a.createElement(pi.a,null,t)},ji=function(e){var t=e.styles,n=e.feedbackData,r=e.shouldShowAIGeneratedIndicator,i=void 0===r||r,a=e.shouldShowAIPoweredIndicator,l=e.displayPosition,c=e.shouldShowFeedbackButtons,u=void 0===c||c,d=e.handleThumbsUpClick,p=e.handleThumbsDownClick,g=e.showMinifiedUI,h=void 0!==g&&g,f=e.clpSensitivityIndicatorData,m=void 0===f?void 0:f,v=e.telemetryData,b=void 0===v?"":v,y=e.actionBarProps,C=e.useFluentAIGeneratedIndicator,O=void 0!==C&&C;t.headerBar=Object(x.a)(t.footerBar,t.headerBar);var S=s()?gi.d:gi.b,E=s()?gi.c:gi.a,I=s()?gi.h:gi.f,w=s()?gi.g:gi.e;return y.styles=W(y.styles,Lo()),ue.a.createElement(he,{horizontal:!0,reverse:!0,customProperties:{tabIndex:-1},style:l===ro.Header?t.headerBar:t.footerBar},ue.a.createElement(_e,null,ue.a.createElement(he,{horizontal:!0,style:t.feedbackButtonsStack},y&&ue.a.createElement(di,Object(o.__assign)({},y)),u&&ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(be.a,{title:Te(),"aria-label":Te(),appearance:"transparent",size:"small",className:t.feedbackButton,icon:Ii(I,w),onClick:function(e){var t=e.target.closest("button");null==n?d(void 0,void 0,t):d(n,b,t)}}),ue.a.createElement(be.a,{title:ke(),className:t.feedbackButton,"aria-label":ke(),appearance:"transparent",size:"small",icon:Ii(S,E),onClick:function(e){var t=e.target.closest("button");null==n?p(void 0,void 0,t):p(n,b,t)}})))),ue.a.createElement(_e,null,ue.a.createElement(he,{horizontal:!0,style:t.feedbackDisclaimerStack},m&&ue.a.createElement(xi,{styles:t,clpSensitivityIndicatorData:m}),i&&(h?wi(t,a):O?ki(a):Ti(t,a)))))},Pi=n(3522),Ai=n(2806),_i=n(2804),Di=n(2799),Li=n(1826),Mi=n(724),Bi=n(3397),Ri=function(e){var t=e.referenceType,n=e.iconAppName,r=e.iconUrl,o=e.authorEmail,i=e.authorName;if(t===ri.Internal){if(n===oi.Word||n===oi.OneNote)return ue.a.createElement(Mi.a,null);if(n===oi.PowerPoint)return ue.a.createElement(wn.a,null)}else if(t===ri.CrossApp){if(r)return ue.a.createElement(De.a,{src:r,alt:null!=n?n:"",height:20,width:20});if(n)switch(n){case oi.Word:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:n,height:20,width:20});case oi.PowerPoint:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:n,height:20,width:20});case oi.Excel:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:n,height:20,width:20});case oi.OneNote:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg",alt:n,height:20,width:20});case oi.Visio:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg",alt:n,height:20,width:20});case oi.Loop:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg",alt:n,height:20,width:20});case oi.Txt:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg",alt:n,height:20,width:20});case oi.SharePoint:return ue.a.createElement(De.a,{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg",alt:n,height:20,width:20});case oi.Event:case oi.Meeting:return ue.a.createElement(xe.c,null);case oi.Pdf:return ue.a.createElement(Mi.b,null);case oi.Teams:case oi.Outlook:return i||o?ue.a.createElement(Li.a,{size:20,name:i||o}):ue.a.createElement(Bi.a,null);case oi.Topic:return ue.a.createElement(De.a,{src:"../assets/topic-icon.svg",alt:n,height:20,width:20})}}return ue.a.createElement(Bi.a,null)},Fi=function(e){return{index:e.referenceIndex,label:ue.a.createElement(on.a,{appearance:"subtle",href:e.referenceProps.url,target:"_blank",onClick:function(){return Ni(e)}},e.referenceProps.title),primaryText:e.referenceProps.primarySubtitle,secondaryText:e.referenceProps.secondarySubtitle,excerpt:e.referenceProps.snippet,media:ue.a.createElement(Ri,{referenceType:e.referenceProps.referenceType,iconAppName:e.referenceProps.iconAppName,iconUrl:e.referenceProps.iconUrl,authorEmail:e.referenceProps.authorEmail,authorName:e.referenceProps.authorName}),sensitivityLabel:void 0!==e.referenceProps.sensitivityLabel?ue.a.createElement("span",null,e.referenceProps.sensitivityLabel):void 0}},Ni=function(e,t){e.referenceProps.onClickCitationLink&&e.referenceProps.onClickCitationLink(e.referenceIndex,e.referenceProps.path,t)},Hi=function(e){var t=e.references,n=e.msgExtCardReferences,r=void 0===n?[]:n,i=e.pluginServiceProvider,a=void 0===i?void 0:i,s=(e.telemetryData,e.styles,(t=Ui(t)).length>1?U()?OfficeaicopilotStrings.CitationTitleReferences:"References":U()?OfficeaicopilotStrings.CitationTitleReference:"Reference"),l=ue.a.createElement(Ai.a,null,t.map((function(e,t){return function(e){return void 0!==r.find((function(t){return t.index===e&&t.card}))}(t+1)?function(e,t,n){var r,i,a=n.find((function(t){return t.index===e&&t.card}));if(a){var s={cardId:a.card.cardId,content:a.content,contentType:S.b.AdaptiveCard,appId:a.card.appId,botId:a.card.botId};return ue.a.createElement(Pi.a,Object(o.__assign)({key:e,citationIndex:e,cardDetails:s,tokenService:null===(r=null==t?void 0:t.cardServices)||void 0===r?void 0:r.tokenService,theme:a.config.themeMode,appService:null===(i=null==t?void 0:t.cardServices)||void 0===i?void 0:i.appService},a))}return null}(e.referenceIndex,a,r):ue.a.createElement(_i.a,Object(o.__assign)({key:t},Fi(e)))})));return l?ue.a.createElement(he,null,ue.a.createElement(Di.a,{label:"".concat(t.length," ")+s},l)):null},Ui=function(e){var t,n,r=[],i=function(e){r.some((function(t){return t.referenceIndex===e.referenceIndex}))||r.push(e)};try{for(var a=Object(o.__values)(e),s=a.next();!s.done;s=a.next()){i(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},Vi=function(e){var t,n,r,i=e.styles,a=e.body,l=e.feedbackData,c=e.shouldShowAIGeneratedIndicator,u=void 0===c||c,d=e.shouldShowAIPoweredIndicator,p=e.shouldShowFeedbackButtons,g=void 0===p||p,h=e.feedbackSectionPosition,m=void 0===h?ro.None:h,v=e.showAnimation,b=void 0===v||v,y=e.handleThumbsDownClick,C=e.handleThumbsUpClick,O=e.actionBarButtons,S=e.chatCardIndex,E=e.showMinifiedUI,I=void 0!==E&&E,w=e.strikeThroughText,T=void 0!==w&&w,k=e.references,j=void 0===k?[]:k,P=e.clpSensitivityIndicatorData,A=void 0===P?void 0:P,_=e.telemetryData,D=void 0===_?"":_,L=e.pluginAuthError,M=void 0===L?void 0:L,B=e.pluginServiceProvider,R=void 0===B?void 0:B,F=e.msgExtCardProps,N=void 0===F?void 0:F,H=e.msgExtCardContextProvider,U=void 0===H?void 0:H,V=e.useFluentAIGeneratedIndicator,z=void 0!==V&&V,G=null!==(t=a.user)&&void 0!==t?t:"chat",W="human"!==a.user&&b,Q=Object(o.__read)(Object(ce.useState)(W),2),q=Q[0],K=Q[1],Y=ue.a.useMemo((function(){return Xo(M)}),[M]),Z=Y.requestType,J=Y.authUrl,X=Y.botInvokeRequest,$=Y.appId;Object(ce.useEffect)((function(){W&&K(!0)}),[W]),Object(ce.useEffect)((function(){q&&K(!1)}),[q]);var ee=f(),te=!!M&&Z&&X&&(null==R?void 0:R.activityProvider)&&(null===(n=null==R?void 0:R.cardServices)||void 0===n?void 0:n.appService),ne=((null==O?void 0:O.length)>0||te)&&"human"!==G,re=(m==ro.Header||m==ro.Footer&&s())&&"human"!==G,oe=!re&&m==ro.Footer&&"human"!==G,ie=(null==N?void 0:N.attributions.length)>0&&U,ae=j.length>0,se=Object(Jo.a)(),le=null==O?void 0:O.filter((function(e){return e.position===Ko.FeedbackSection})),de={actionBarButtons:null==O?void 0:O.filter((function(e){return e.position!==Ko.FeedbackSection})),styles:i,messageContentElementId:se,chatCardIndex:S,telemetryData:D,pluginAuthButtonProps:te?{requestType:Z,url:J,appId:$,originalBotInvokeRequest:X,activityProvider:null==R?void 0:R.activityProvider,appService:null===(r=null==R?void 0:R.cardServices)||void 0===r?void 0:r.appService}:void 0},pe={styles:i,feedbackData:l,shouldShowAIGeneratedIndicator:u,shouldShowAIPoweredIndicator:d,shouldShowFeedbackButtons:g,displayPosition:m,handleThumbsDownClick:y,handleThumbsUpClick:C,showMinifiedUI:!!s()||I,clpSensitivityIndicatorData:A,telemetryData:D,actionBarProps:{actionBarButtons:le,styles:Object(o.__assign)({},i),messageContentElementId:se,chatCardIndex:S,telemetryData:D},useFluentAIGeneratedIndicator:z},ge=function(e,t,n,r){var o={};return o.defaultRoot=Object(x.a)(e.defaultRoot,e[t]),n&&(o.defaultRoot=Object(x.a)(o.defaultRoot,e.cardHighContrast)),o.loader=e.loader,o.chatCard=Object(x.a)(e.chatCard,"human"===t?e.humanContent:e.chatContent),o.strikeThroughText=r?e.strikeThroughText:"",o}(i,G,ee,T),he=[];ie&&(he=U.getCardReferences(N.attributions));var fe=ue.a.createElement(ue.a.Fragment,null,re&&ue.a.createElement(ji,Object(o.__assign)({},pe)),ue.a.createElement("div",{id:"".concat(se),className:ge.strikeThroughText},a.element),ne&&ue.a.createElement(di,Object(o.__assign)({},de)),oe&&ue.a.createElement(ji,Object(o.__assign)({},pe)),ae&&ue.a.createElement(Hi,{references:j,msgExtCardReferences:he,pluginServiceProvider:R,styles:i,telemetryData:D}));return ue.a.createElement(Yo.a,{className:ge.defaultRoot,themeExtension:Vo},"human"===G?ue.a.createElement(Zo.a,{className:ge.chatCard},fe):ue.a.createElement(un.a,{isLoading:q,"aria-live":"assertive",className:ge.chatCard},fe))},zi=n(146),Gi=function(e){var t=e.styles,n=e.onClickShowMeButton,r=e.onClickHelpButton,o=t.combinedButton,i=t.showMeButton;return ue.a.createElement(he,{style:t.showMeButtonBarRoot,customProperties:{tabIndex:-1}},ue.a.createElement(be.a,{tabIndex:0,"aria-label":ee(),className:Object(x.a)(o,i),onClick:n},ee()),r&&ue.a.createElement(be.a,{tabIndex:0,"aria-label":te,className:Object(x.a)(o,i),icon:ue.a.createElement(zi.V,null),onClick:r},te))},Wi=n(2805),Qi=function(e){var t=e.referenceIndex,n=e.referenceProps,r=e.telemetryData,i=void 0===r?"":r,a=ue.a.createElement(_i.a,Object(o.__assign)({layout:"popover"},Fi({referenceIndex:t,referenceProps:n})));return ue.a.createElement(Wi.a,{popover:a,onClick:function(){void 0!==n.url&&window.open(n.url,"_blank"),n.onClickCitationLink&&n.onClickCitationLink(t,n.path,i)},popoverSurface:{tabIndex:0,style:{overflowWrap:"anywhere"}}},t)},qi=function(e){var t,n,r,o,i,a,s=e.styles,l=e.richText,c=e.renderTextWithCitation,u=void 0===c?function(e){return null}:c,d=e.references,p=void 0===d?[]:d;l.linkText&&(null===(t=l.linkText.linkSuffix)||void 0===t?void 0:t.includes("%s"))&&(l.text+=l.linkText.linkSuffix.substring(0,l.linkText.linkSuffix.indexOf("%s")),l.linkText.linkSuffix=l.linkText.linkSuffix.substring(l.linkText.linkSuffix.indexOf("%s")+2));return ue.a.createElement("span",null,ue.a.createElement(ut.a,{block:!0,className:Object(x.a)(s.text,s.richTextRoot)},l.text?q(l.text,p)?u(l.text):l.text:"",l.linkText&&ue.a.createElement(on.a,{target:l.linkText.linkUrl?"_blank":"",href:null!==(n=l.linkText.linkUrl)&&void 0!==n?n:"#",className:Object(x.a)(s.linkText,l.linkText.linkUrl?"":s.linkButton),onClick:function(){l.linkText.linkUrl||l.linkText.linkOnClick()}},l.linkText.text),(null===(r=l.linkText)||void 0===r?void 0:r.linkSuffix)?q(null===(o=l.linkText)||void 0===o?void 0:o.linkSuffix,p)?u(null===(i=l.linkText)||void 0===i?void 0:i.linkSuffix):null===(a=l.linkText)||void 0===a?void 0:a.linkSuffix:""))},Ki=function(e){return Object(pe.a)(function(e){var t,n,r,i,a,s,l,c,u,d,p,g,h;return Object(o.__assign)({rootStack:null!==(t=e.rootStack)&&void 0!==t?t:{},messageHeader:null!==(n=e.messageHeader)&&void 0!==n?n:{},messageFooter:null!==(r=e.messageFooter)&&void 0!==r?r:{},listStackStyle:null!==(i=e.listStackStyle)&&void 0!==i?i:{},pillsItem:null!==(a=e.listStackStyle)&&void 0!==a?a:{},pillsContainer:null!==(s=e.listStackStyle)&&void 0!==s?s:{},list:null!==(l=e.list)&&void 0!==l?l:{},listHeader:null!==(c=e.listHeader)&&void 0!==c?c:{},listFooter:null!==(u=e.listFooter)&&void 0!==u?u:{},linkText:null!==(d=e.linkText)&&void 0!==d?d:{},linkButton:null!==(p=e.linkButton)&&void 0!==p?p:{},listItemTitle:null!==(g=e.listItemTitle)&&void 0!==g?g:{},richTextRoot:null!==(h=e.richTextRoot)&&void 0!==h?h:{}},Mo(e))}(e))}({linkText:{fontFamily:"-apple-system",lineHeight:"normal"}}),Yi=Object(E.a)(P),Zi=Object(o.__assign)({rootStack:Object(o.__assign)({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},Me.a.gap("12px")),messageHeader:{},messageFooter:{},listStackStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.gap("4px")),Me.a.gap("12px")),pillsContainer:{alignItems:"flex-start"},pillsItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)((vi={backgroundColor:Be.a.colorNeutralBackground3,color:Be.a.colorNeutralForeground2},vi["&:hover"]={backgroundColor:Be.a.colorNeutralBackground2Hover,color:Be.a.colorNeutralForeground1Hover},vi.marginBottom="10px",vi),Me.a.border("transparent")),Me.a.borderColor(Be.a.colorNeutralBackground3)),{display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px"}),Me.a.borderRadius("4px")),Me.a.gap("4px")),Me.a.gap("12px")),list:Object(o.__assign)(Object(o.__assign)({},Me.a.margin("0px")),Me.a.gap("4px")),listHeader:{fontWeight:600},listFooter:{},linkText:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{color:Yi.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Yi.themePrimary}}}),linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"}},Ho()),Ji=Object(pe.a)(Zi),Xi=function(){var e=Ji(),t=Ki();if(a()===r.IOS)W(e,t);return e},$i=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=void 0!==r&&r,a=e.references,s=void 0===a?[]:a,l=e.pillsList,c=void 0===l?[]:l,u=e.handlePillOnClick,d=void 0===u?null:u,p=e.handleShowMeOnClick,g=void 0===p?null:p,h=e.telemetryData,f=void 0===h?"":h,m=Object(x.a)(t.text,t.rootStack);i&&(m=Object(x.a)(t.text,t.strikeThroughText,t.rootStack));var v=Xi(),b={styles:t,onClickShowMeButton:g,onClickHelpButton:null},y=function(e){var t=function(e,t){for(var n=[],r=e.search("%c"),o=function(){var o=e.slice(r+2).search("%c");if(-1===o)return"break";o+=r+2;var i=parseInt(e.slice(r+2,o));n.push({message:e.slice(0,r),references:[t.find((function(e){return e.referenceIndex===i}))]}),e=e.slice(o+2),r=e.search("%c")};-1!==r&&"break"!==o(););return n}(e,s);return t.map((function(e,t){return ue.a.createElement("span",{key:t},e.message,e.references&&e.references.map((function(e,t){return ue.a.createElement(Qi,Object(o.__assign)({},e,{key:t,telemetryData:f}))})))}))};return ue.a.createElement(he,{style:m},n.messageHeader&&(n.messageHeader.text||n.messageHeader.linkText)&&ue.a.createElement(he,{style:t.messageHeader},ue.a.createElement(qi,{styles:t,richText:n.messageHeader,references:s,renderTextWithCitation:y})),n.embeddedLists&&n.embeddedLists.map((function(e,n){return ue.a.createElement(he,{key:n,style:t.listStackStyle},e.listHeader&&ue.a.createElement(ut.a,{className:Object(x.a)(t.text,t.listHeader)},q(e.listHeader,s)?y(e.listHeader):e.listHeader),e.listItems&&e.listItems.length>0&&ue.a.createElement("ul",{className:t.list},e.listItems.map((function(e,n){return ue.a.createElement(ut.a,{block:!0,key:n,className:t.text},ue.a.createElement("li",null,e.title&&ue.a.createElement("span",{className:t.listItemTitle},q(e.title,s)?y(e.title):e.title),q(e.text,s)?y(e.text):e.text))}))),e.listFooter&&(e.listFooter.text||e.listFooter.linkText)&&ue.a.createElement(he,{style:t.listFooter},ue.a.createElement(qi,{styles:t,richText:e.listFooter,references:s,renderTextWithCitation:y})))})),n.messageFooter&&(n.messageFooter.text||n.messageFooter.linkText)&&ue.a.createElement(he,{style:t.messageFooter},ue.a.createElement(qi,{styles:t,richText:n.messageFooter,references:s,renderTextWithCitation:y})),g&&ue.a.createElement(Gi,Object(o.__assign)({},b)),c&&c.length>0&&ue.a.createElement(he,{style:v.pillsContainer},c.map((function(e,t){return ue.a.createElement(be.a,{key:t,className:v.pillsItem,onClick:function(){d&&d(e)}},e.data)}))))},ea=function(e){var t,n,r=e.body,o=e.styles,i=null!==(t=r.cardHeader)&&void 0!==t?t:X(),a=null!==(n=r.cardContent)&&void 0!==n?n:U()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContent:"Please help us learn and train our models by providing feedback through the thumbs up & down controls for each output the LLM generates.",s=r.imageSrc;return ue.a.createElement(he,{style:o.feedbackNudgeRootStack},ue.a.createElement(he,{style:o.msInternalContainer},ue.a.createElement(ut.a,{title:$(),className:o.msInternalHeader},$())),ue.a.createElement(De.a,{src:s,className:o.cardIllustration}),ue.a.createElement(ut.a,{title:X(),className:o.feedbackCardHeader},i),ue.a.createElement(ut.a,{title:U()?OfficeaicopilotStrings.ChatContainerFeedbackNudgeContentTitle:"Feedback Nudge Content",className:Object(x.a)(o.text,o.feedbackCardContent)},a))},ta=function(e){var t,n,r,i,a;return Object(o.__assign)({feedbackNudgeRootStack:{},msInternalContainer:null!==(t=e.msInternalContainer)&&void 0!==t?t:{},msInternalHeader:null!==(n=e.msInternalHeader)&&void 0!==n?n:{},feedbackCardHeader:null!==(r=e.feedbackCardHeader)&&void 0!==r?r:{},feedbackCardContent:null!==(i=e.feedbackCardContent)&&void 0!==i?i:{},cardIllustration:null!==(a=e.cardIllustration)&&void 0!==a?a:{}},Mo(e))};var na=function(e){var t=ta(e);return Object(pe.a)(t)}(Object(o.__assign)({msInternalHeader:{lineHeight:"normal"},feedbackCardHeader:{lineHeight:"14px"},feedbackCardContent:{lineHeight:"14px"}},Ho())),ra=Object(E.a)(P),oa=Object(o.__assign)({feedbackNudgeRootStack:Object(o.__assign)({alignItems:"center"},Me.a.gap("4px")),msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:"16px"},Me.a.borderRadius(ra.borderRadiusXLarge)),{backgroundColor:ra.neutralTertiary}),Me.a.padding("0px","12px")),pn.a.caption2Strong),{display:"flex",justifyContent:"center",alignItems:"center"}),feedbackCardHeader:Object(o.__assign)(Object(o.__assign)({marginTop:"12px",width:"100%",textAlign:"center"},pn.a.subtitle2),{color:ra.themePrimary}),feedbackCardContent:{marginTop:"12px"},cardIllustration:{}},Ho()),ia=Object(pe.a)(oa),aa=n(3589),sa=n(2164),la=n(465),ca=n(3508),ua=n(2870),da=Object(ua.b)({MsgExtCardPreview:Object(pe.a)({root:{maxWidth:"min(".concat(600,"px, 100%)"),minWidth:"min(".concat(0,"px, 100%)")}})}),pa=Object(ce.memo)((function(e){var t=e.card,n=e.context,r=e.config,o=ue.a.useMemo((function(){return{appId:t.appId,cardId:t.cardId,botId:t.botId,content:JSON.stringify(t.content),contentType:V(t.contentType)}}),[t]);return ue.a.createElement("div",null,ue.a.createElement(da,null,ue.a.createElement(ca.a,{cardDetails:o,serviceProvider:n,config:r})))}),(function(e,t){return e.card.cardId===t.card.cardId&&e.config.themeMode===t.config.themeMode})),ga=n(246),ha=n(2851),fa=Object(ua.a)("MsgExtCitationControl",Object(pe.a)({container:Object(o.__assign)({display:"inline-block",paddingBottom:"0px"},Me.a.borderRadius("12px")),citationMountNode:{zIndex:999},popoverSurface:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("0px","0px")),Me.a.padding("0px")),Me.a.borderRadius("12px")),Me.a.borderStyle("none")),{width:"min(".concat(450,"px, 100%)"),"& > div":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("12px")),Me.a.borderWidth("0px")),Me.a.borderStyle("none")),"&::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralForeground4},Me.a.border("0px")),Me.a.borderRadius(Be.a.borderRadiusMedium)),"&::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({width:Be.a.spacingHorizontalS},Me.a.border("0px")),Me.a.borderRadius(Be.a.borderRadiusMedium)),"&::-webkit-scrollbar-track":Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},Me.a.border("0px")),Me.a.borderRadius(Be.a.borderRadiusMedium)),"&::-webkit-scrollbar-corner":Object(o.__assign)(Object(o.__assign)({backGroundColor:Be.a.colorNeutralBackground5},Me.a.border("0px")),Me.a.borderRadius(Be.a.borderRadiusMedium))}),citationV2:Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground3,color:Be.a.colorNeutralForeground2},Me.a.border("1px","solid",Be.a.colorNeutralStroke1))}));function ma(e){var t,n,r,i,a=fa(),s=e.citation,l=e.cardDetails,c=e.serviceProvider,u=e.config,d=e.postActionExecute,p=e.isReferencesV2,g=e.viewModel,h=ce.useMemo((function(){return new ha.a(null==c?void 0:c.telemetryService,ga.h.CitationOrEntityControl,ga.g.MsgExtCitationOrEntityControl)}),[]),f=ce.useMemo((function(){return ce.createElement(ca.a,{cardDetails:l,serviceProvider:c,config:u,postActionExecute:d})}),[c,l]),m=null!=e.viewModel?"Entity":"Citation";ce.useEffect((function(){h.logMetricEnd({props:{},diagnosticsData:"TypeOfCard: ".concat(l.contentType,",  cardId : ").concat(l.cardId,",  sourceType: ").concat(m)},l.cardId)}),[]);var v=[g&&!(null===(t=g.item)||void 0===t?void 0:t.cardDetails)?ce.createElement(ut.a,null,null===(n=g.item)||void 0===n?void 0:n.title):ce.createElement(ei.a,{disableButtonEnhancement:!0},g&&(null===(r=g.item)||void 0===r?void 0:r.cardDetails)?ce.createElement(on.a,null,null===(i=g.item)||void 0===i?void 0:i.title):ce.createElement(Wi.a,{className:p?a.citationV2:void 0,"data-testid":"msgext-citation-pill"},s)),ce.createElement("div",{"data-testid":"msgext-citation-popover"},ce.createElement(ti.a,{className:a.popoverSurface},f))],b=Object(o.__read)(ce.useState(0),2),y=b[0],C=b[1],O=window.innerHeight;return ce.createElement("div",{className:a.container,ref:function(e){e&&C(e.getBoundingClientRect().top)}},ce.createElement($o.a,{openOnHover:!0,closeOnScroll:!0,positioning:{align:"center",position:y>O/2?"above":"below",autoSize:!0},trapFocus:!0,mountNode:{className:a.citationMountNode}},v))}var va,ba=function(e){var t=e.citation,n=e.card,r=e.context,o=e.config,i=ue.a.useMemo((function(){return{appId:n.appId,cardId:n.cardId,botId:n.botId,content:JSON.stringify(n.content),contentType:V(n.contentType)}}),[n]);return ue.a.createElement(ma,{citation:t,cardDetails:i,serviceProvider:r,config:o})},ya=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=e.msgExtCardProps,u=void 0===c?void 0:c,d=e.msgExtCardContextProvider,p=void 0===d?void 0:d,g=e.pluginAuthError,h=void 0===g?void 0:g,f=[],m=p?p.getCardServiceProps():void 0;(null==u?void 0:u.attributions.length)>0&&p&&(f=p.getCardReferences(u.attributions));var v=ue.a.useMemo((function(){return Xo(h)}),[h]),b=v.requestType,y=v.appId,C=t.markdownRoot;r&&(C=Object(x.a)(t.markdownRoot,t.strikeThroughText)),n.shouldApplyInputLinkTheme&&(C=Object(x.a)(C,t.markdownInputLinkStyles));var O={a:function(e){e.node;return function(e,t){var n=e.children[0],r=Number(n),i=Number.isInteger(r)&&r>0;if(f.length,i){var s=f.find((function(e){return e.index===r&&e.card}));if(s)return ue.a.createElement(ba,Object(o.__assign)({citation:r},s,{context:null==s?void 0:s.context}));var c=a.length?a.find((function(e){return e.referenceIndex===r})):void 0;return a.length&&c?ue.a.createElement(Qi,Object(o.__assign)({},a.find((function(e){return e.referenceIndex===r})),{telemetryData:l})):ue.a.createElement("span",null,"[",e.children,"](",e.href,")")}return t?ue.a.createElement("a",Object(o.__assign)({},e,{rel:"noreferrer"}),e.children):ue.a.createElement("span",null,"[",e.children,"](",e.href,")")}(Object(o.__rest)(e,["node"]),n.disableLinksProcessing)}};n.horizontalTableScroll&&(O.table=function(e){e.node;var n=Object(o.__rest)(e,["node"]);return ue.a.createElement("div",{className:t.markdownHorizontalTableContainer},ue.a.createElement("table",{className:t.markdownHorizontalTable},n.children))});var S=y&&m&&m.appService&&ue.a.createElement(aa.a,{requestType:b,appId:y,appService:m.appService});return ue.a.createElement(he,{style:C},ue.a.createElement(sa.a,{linkTarget:"_blank",disallowedElements:["img"],unwrapDisallowed:!0,remarkPlugins:[la.a],components:Object(o.__assign)(Object(o.__assign)({},O),n.componentsOverride)},0===a.length||a[0].isFlux?n.message:function(e,t){t.sort((function(e,t){return e.referenceIndex-t.referenceIndex}));var n=0;return t.forEach((function(t){var r=t.referenceProps.citationPosition+n,o="["+t.referenceIndex.toString()+"]()";e=e.substring(0,r)+o+e.substring(r),n+=o.length})),e}(n.message,a)),S,function(){if(1===f.length){var e=f[0];return ue.a.createElement(pa,Object(o.__assign)({},e,{context:e.context,config:e.config}))}return null}())},Ca=function(e){var t,n,r,i,a,s=Object(o.__assign)({markdownRoot:null!==(t=e.markdownRoot)&&void 0!==t?t:{},markdownElement:null!==(n=e.markdownElement)&&void 0!==n?n:{},markdownHorizontalTableContainer:null!==(r=e.markdownHorizontalTableContainer)&&void 0!==r?r:{},markdownHorizontalTable:null!==(i=e.markdownHorizontalTable)&&void 0!==i?i:{},markdownInputLinkStyles:null!==(a=e.markdownInputLinkStyles)&&void 0!==a?a:{}},Mo(e));return Object(pe.a)(s)}({markdownRoot:{lineHeight:"inherit"}}),Oa=Object(E.a)(P),Sa=Object(o.__assign)({markdownRoot:Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{color:Oa.black,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",Oa.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(o.__assign)({backgroundColor:Oa.colorNeutralBackground1Hover},Me.a.padding("1px","5px")),"& td":Object(o.__assign)(Object(o.__assign)({},Me.a.borderBottom("1px","solid",Oa.colorNeutralBackground3Pressed)),Me.a.padding("1px","5px")),"& p":Object(o.__assign)(Object(o.__assign)({},Me.a.margin("0px")),{display:"inline"})}),markdownElement:{marginBottom:"10px"},markdownHorizontalTableContainer:{width:"100%",overflowX:"auto","::-webkit-scrollbar":Object(o.__assign)({height:"7px",backgroundColor:"transparent"},Me.a.borderRadius(Oa.borderRadiusLarge)),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Oa.colorScrollbarOverlay},Me.a.borderRadius(Oa.borderRadiusLarge)),Me.a.border("1px","solid",Oa.colorNeutralBackground1)),{":hover":{backgroundColor:Oa.colorNeutralForeground3}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderRadius(Oa.borderRadiusLarge))},markdownHorizontalTable:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"100%",whiteSpace:"nowrap"},Me.a.overflow("hidden")),Me.a.borderRadius(Oa.borderRadiusMedium)),pn.a.caption1),{"& th":Object(o.__assign)({},pn.a.caption1Strong)}),markdownInputLinkStyles:{"& a":Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{color:Oa.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Oa.themePrimary}}})}},Ho()),Ea=Object(pe.a)(Sa),xa=n(3402),Ia=function(e){var t=e.styles,n=e.handleApplyOnClick,r=e.handleApplyAllOnClick,i=Object(o.__read)(Object(ce.useState)(!1),2),a=i[0],s=i[1],l=Object(o.__read)(Object(ce.useState)(!1),2),c=l[0],u=l[1],d=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,r()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?ue.a.createElement(me.a,{content:"Waiting to apply updates",relationship:"label"},ue.a.createElement(be.a,{className:Object(x.a)(t.spinnerButton,t.combinedButton),onClick:d,disabled:!0,icon:ue.a.createElement(wn.e,{className:t.spinnerIcon})})):ue.a.createElement(fe.a,{positioning:"below-end"},ue.a.createElement(ve.a,{disableButtonEnhancement:!0},(function(e){return ue.a.createElement(me.a,{content:"Apply Updates",relationship:"label"},ue.a.createElement(xa.a,{menuButton:e,primaryActionButton:{onClick:d},size:"small",className:t.applyButton},c?"Apply All":"Apply"))})),ue.a.createElement(Ce.a,null,ue.a.createElement(Oe.a,null,ue.a.createElement(Se.a,{onClick:function(){u((function(e){return!e}))}},c?"Apply":"Apply All"))))},wa=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(Object(ce.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.textIndices),!1)),2),l=s[0],c=s[1],u=Object(o.__read)(Object(ce.useState)(!1),2),d=u[0],p=u[1];Object(ce.useEffect)((function(){i>=l.length&&a(l.length-1)}),[l]);var g=function(){return a((function(e){return e-1}))},h=function(){return a((function(e){return e+1}))},f=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return p(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),p(!1),[2]}}))}))},m=function(){c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t.splice(i,1),t}))},v={styles:t,handleApplyOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return ue.a.createElement(he,{style:t.stack,customProperties:{tabIndex:-1}},l.length?ue.a.createElement(ue.a.Fragment,null,"Applying updates to following matches",ue.a.createElement("div",{className:t.contentBox},ue.a.createElement("div",{className:t.contentBoxButtonGroup},ue.a.createElement("div",{className:d?t.disabledContentBoxIcon:t.contentBoxIcon},d?ue.a.createElement(wn.f,{className:t.spinnerIcon}):ue.a.createElement(me.a,{content:"Locate",relationship:"label"},ue.a.createElement(Mt.b,{onClick:f}))),d?ue.a.createElement(ue.a.Fragment,null):ue.a.createElement("div",{className:Object(x.a)(t.contentBoxIcon,t.dismissIcon)},ue.a.createElement(me.a,{content:"Remove",relationship:"label"},ue.a.createElement(pt.h,{onClick:m})))),ue.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.extractTextToDisplay(l[i]))),ue.a.createElement("div",{className:t.footer},ue.a.createElement("div",null,ue.a.createElement(Ia,Object(o.__assign)({},v))),ue.a.createElement("div",{className:t.pagination},ue.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),ue.a.createElement("div",null,ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(me.a,{content:"Previous",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(gi.i,null),onClick:g,disabled:0==i,className:t.paginationButton})),ue.a.createElement(me.a,{content:"Next",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(gi.j,null),onClick:h,disabled:i+1>=l.length,className:t.paginationButton}))))))):ue.a.createElement(ue.a.Fragment,null,"No results found for the search"))},Ta=Object(E.a)(P),ka=Object(o.__assign)({stack:Object(o.__assign)({textAlign:"start",textOverflow:"clip"},Me.a.gap("12px")),contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Ta.neutralLight,minHeight:"50px",position:"relative"},Me.a.padding("12px")),Me.a.border("1px","solid",Ta.neutralLighterAlt)),Me.a.borderRadius(Ta.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},Me.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},Me.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ta.neutralLight,height:"24px"},Me.a.border("none")),{"&:hover":{color:Ta.themePrimary}}),spinnerButton:{backgroundColor:Ta.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Ta.themePrimary}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:Ta.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},Me.a.border("1px","solid",Ta.neutralLighterAlt)),Me.a.borderRadius(Ta.borderRadiusMedium)),pn.a.caption1),Me.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Ta.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Ta.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Ta.themePrimary},contentBoxText:{marginBottom:"20px"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Ho()),ja=Object(pe.a)(ka),Pa=n(3393),Aa=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(ue.a.useState(!1),2),i=r[0],a=r[1];return ue.a.createElement(he,{style:t.rootStack},ue.a.createElement("div",{className:t.container,onMouseOver:function(){n.handleMouseOver()},onMouseLeave:function(){n.handleMouseLeave()},onFocus:function(){n.handleMouseLeave()}},ue.a.createElement("div",null,ue.a.createElement(ut.a,{className:t.title},U()?OfficeaicopilotStrings.ProactiveSuggestionTitleText:"Highlight Data"),ue.a.createElement(Pa.a,{className:t.badge,size:"large",appearance:"outline",color:"subtle",icon:ue.a.createElement(wn.b,null)},U()?OfficeaicopilotStrings.ProactiveSuggestionIconText:"Idea")),ue.a.createElement(ut.a,{className:t.body},U()?OfficeaicopilotStrings.ProactiveSuggestionBodyText:"For a more engaging presentation, here’s a design that might better highlight the stats in your slide."),ue.a.createElement(De.a,{className:t.image,bordered:!0,shadow:!0,shape:"rounded",alt:U()?OfficeaicopilotStrings.ProactiveSuggestionImageAltText:"proactive suggestion card img",src:n.imageSrc}),ue.a.createElement(be.a,{disabled:i,className:t.applyButton,onClick:function(){a(!0),n.handleApplyClicked()},icon:ue.a.createElement(Bt.c,null)},U()?OfficeaicopilotStrings.ProactiveSuggestionApplyBtnText:"Apply")))},_a=Object(E.a)(P),Da=Object(o.__assign)({rootStack:Object(o.__assign)({},Me.a.gap("4px")),container:{display:"flex",flexDirection:"column"},title:{fontWeight:"600"},badge:Object(o.__assign)({float:"right"},Me.a.borderColor(_a.themeMedium)),body:{marginTop:"15px"},image:{marginTop:"15px"},applyButton:{marginTop:"15px",width:"104px"}},Ho()),La=Object(pe.a)(Da);!function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(va||(va={}));var Ma,Ba=n(3438),Ra=n(3439),Fa=n(3395),Na=function(e){var t=e.styles,n=(e.label,e.icon,e.text),r=e.disabled,o=e.isFormReadyForSubmission,i=e.onSubmit;return ue.a.createElement("div",{className:t.buttonStyle},ue.a.createElement(be.a,{appearance:"primary",icon:r?ue.a.createElement(dn.f,null):ue.a.createElement(Mt.d,null),onClick:i,disabled:!o,size:"small",className:t.buttonItemsStyle},ue.a.createElement(Fa.a,null,r?"Invitation Sent":n)))},Ha=(Object(E.a)(_),Object(o.__assign)({buttonTextStyle:{},buttonStyle:{display:"flex",flexDirection:"column",rowGap:"8px"},buttonItemsStyle:{width:"fit-content"}},Ho())),Ua=Object(pe.a)(Ha),Va=n(3603),za=n(3433),Ga=n(3434),Wa=function(e){e.styles;var t=e.label,n=e.selectedDate,r=e.disabled,o=e.onDateChange;return ue.a.createElement(za.a,{label:ue.a.createElement(Ga.a,null,t," ")},ue.a.createElement(Va.a,{showMonthPickerAsOverlay:!0,showGoToToday:!1,value:n,onSelectDate:function(e){o&&o(e)},disabled:r,minDate:new Date}))},Qa=Object(E.a)(_),qa=Object(o.__assign)({datePickerLabelStyle:{},datePickerInputStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",Qa.colorNeutralStroke1)),Me.a.borderRadius("4px")),datePickerIconStyle:{}},Ho()),Ka=Object(pe.a)(qa),Ya=n(3437),Za=n(3405),Ja=function(e){var t=e.styles,n=e.label,r=e.selectedValue,o=e.options,i=e.disabled,a=e.onItemSelected;return ue.a.createElement(he,null,ue.a.createElement(za.a,{label:ue.a.createElement(Ga.a,null,n)},ue.a.createElement(Ya.a,{onOptionSelect:function(e,t){return n=t.optionText,console.log(n),void(a&&a(n));var n},className:t.dropDownInputStyle,value:r,disabled:i},o.map((function(e){return ue.a.createElement(Za.a,{key:e},e)})))))},Xa=Object(E.a)(_),$a=Object(o.__assign)({dropDownLabelStyle:{},dropDownInputStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",Xa.colorNeutralStroke1)),Me.a.borderRadius("4px")),dropDownFlyoutStyle:{}},Ho()),es=Object(pe.a)($a),ts=n(3435),ns=n(3436),rs=function(e){var t=e.styles,n=e.label,r=e.suggestions,o=e.inputComponent,i=(e.onPeopleAdded,e.disabled),a=e.onPeopleRemoved;return ue.a.createElement(he,null,ue.a.createElement(za.a,{label:ue.a.createElement(Ga.a,null,n)},ue.a.createElement(he,{style:t.peoplePickerInputStyle},r&&r.length>0&&ue.a.createElement(_e,{style:t.peoplePickerInputContainerStyle},ue.a.createElement(ts.a,{onDismiss:function(e,t){var n=t.value;a&&a({mail:n,displayName:n})},className:t.peoplePickerTagGroupStyle},r.map((function(e,t){return ue.a.createElement(ns.a,{shape:"circular",media:ue.a.createElement(Li.a,{name:e.displayName,shape:"circular"}),dismissible:!e.isReadOnly,dismissIcon:e.isReadOnly?void 0:{"aria-label":"remove"},key:t,size:"extra-small",value:e.mail,disabled:i},e.displayName)})))),!i&&ue.a.createElement(_e,{style:t.peoplePickerInputContainerStyle},o))))},os=Object(E.a)(_),is=Object(o.__assign)({peoplePickerLabelStyle:{},peoplePickerInputStyle:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("4px")),Me.a.border("1px","solid",os.colorNeutralStroke1)),{display:"flex"}),peoplePickerInputContainerStyle:Object(o.__assign)({},Me.a.margin("2px","8px","2px","8px")),peoplePickerTagGroupStyle:{flexWrap:"wrap",rowGap:"8px"},peoplePickerSwitchStyle:{}},Ho()),as=Object(pe.a)(is);!function(e){e.PEOPLE_PICKER="PEOPLE_PICKER",e.TEXT_AREA="TEXT_AREA",e.DATE_PICKER="DATE_PICKER",e.DROP_DOWN="DROP_DOWN",e.SUBMIT="SUBMIT"}(Ma||(Ma={}));var ss=n(3425),ls=function(e){e.styles;var t=e.label,n=e.message,r=e.disabled,i=e.onMessageChange,a=Object(o.__read)(ue.a.useState(n),2),s=a[0],l=a[1];return ue.a.createElement(he,null,ue.a.createElement(za.a,{label:ue.a.createElement(Ga.a,null,t)},ue.a.createElement(ss.a,{value:s,onChange:function(e,t){i&&i(t.value),l(t.value)},disabled:r,rows:4},ue.a.createElement(nr.a,null,s))))},cs=Object(E.a)(_),us=Object(o.__assign)({textAreaLabelStyle:{},textAreaInputStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("4px")),Me.a.border("1px","solid",cs.colorNeutralStroke1))},Ho()),ds=Object(pe.a)(us),ps=Object(E.a)(_),gs=Object(o.__assign)({elementStyles:Object(o.__assign)({display:"flex",flexDirection:"column"},Me.a.gap("16px")),footerAIGeneratedStyles:{color:ps.neutralSecondaryAlt}},Ho()),hs=Object(pe.a)(gs),fs=function(e){var t,n,r=e.styles,i=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,a=null!==(t=i.isCardSubmitted)&&void 0!==t&&t,s=hs(),l=as(),c=ds(),u=es(),d=Ka(),p=Ua();return ue.a.createElement(he,{style:s.elementStyles},ue.a.createElement(Ba.a,null,null!==(n=i.headerText)&&void 0!==n?n:i.isEditDetailsRequest?oe:re),i.individualComponentProps.map((function(e,t){return ue.a.createElement(_e,{key:t},function(e,t){var n,r,i;if(!e)return null;var s=null;switch(e.InvitationComponentType){case Ma.PEOPLE_PICKER:r=e.componentProps,i=W(l,t),s=rs;break;case Ma.TEXT_AREA:r=e.componentProps,i=W(c,t),s=ls;break;case Ma.DROP_DOWN:r=e.componentProps,i=W(u,t),s=Ja;break;case Ma.DATE_PICKER:r=e.componentProps,i=W(d,t),s=Wa;break;case Ma.SUBMIT:(r=e.componentProps).isFormReadyForSubmission=null===(n=r.isFormReadyForSubmission)||void 0===n||n,i=W(p,t),s=Na;break;default:return null}return ue.a.createElement(s,Object(o.__assign)({},r,{styles:i,disabled:a}))}(e,r))})),ue.a.createElement(Ra.a,{className:s.footerAIGeneratedStyles},Z()))},ms=n(3432),vs=function(){return ue.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.a.createElement("rect",{width:"20",height:"20",rx:"10",fill:"url(#pattern0)"}),ue.a.createElement("defs",null,ue.a.createElement("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},ue.a.createElement("use",{xlinkHref:"#image0_6409_5011",transform:"scale(0.0033557)"})),ue.a.createElement("image",{id:"image0_6409_5011",width:"298",height:"298",xlinkHref:"data:image/png;base64,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"})))},bs=function(e){var t,n,r,i,a,s,l,c,u=e.styles,d=e.body,p=Object(o.__read)(Object(ce.useState)(!1),2),g=p[0],h=p[1],f=(null!==(t=d.reviewAgentIndividualCardProps)&&void 0!==t?t:{reviewAgentCardType:va.EntryPointCard,reviewAgentInternalCardProps:{onAddDetailsButtonClick:function(){},onStartReviewButtonClick:function(){}}}).reviewAgentInternalCardProps,m=null!==(n=f.isTriggeredFromReviewerAgentPane)&&void 0!==n&&n;return ue.a.createElement(he,{style:u.reviewAgentEntryCardStyle},m?null:ue.a.createElement(nr.a,null,null!==(r=f.headerText)&&void 0!==r?r:"Sure, I suggest continuing with Reviewer agent:"),ue.a.createElement(_e,null,ue.a.createElement(he,{horizontal:!0,style:u.reviewAgentEntryCardElementStyle},ue.a.createElement(_e,null,null!==(i=f.reviewAgentIcon)&&void 0!==i?i:ue.a.createElement(vs,null)),ue.a.createElement(ms.a,null,null!==(a=f.reviewSyncText)&&void 0!==a?a:"Reviewer"))),ue.a.createElement(Fa.a,null,null!==(s=f.reviewAgentDescriptionText)&&void 0!==s?s:"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments."),ue.a.createElement(_e,null,ue.a.createElement(he,{horizontal:!0,style:u.reviewAgentEntryCardElementStyle},ue.a.createElement(_e,null,ue.a.createElement(be.a,{onClick:function(){f.onStartReviewButtonClick(),h(!0)},size:"small",disabled:g},ue.a.createElement(Fa.a,null,null!==(l=f.buttonText)&&void 0!==l?l:"Start Review"))),ue.a.createElement(_e,null,ue.a.createElement(be.a,{onClick:function(){f.onAddDetailsButtonClick(),h(!0)},size:"small",disabled:g},ue.a.createElement(Fa.a,null,null!==(c=f.buttonText)&&void 0!==c?c:"Add Details"))))))},ys=(Object(E.a)(_),Object(o.__assign)({reviewAgentEntryCardStyle:Object(o.__assign)({display:"flex",flexDirection:"column"},Me.a.gap("16px")),reviewAgentEntryCardElementStyle:Object(o.__assign)({display:"flex",flexDirection:"row"},Me.a.gap("8px")),reviewAgentEntryCardSecondHeaderStyle:{},reviewAgentEntryCardDescriptionStyle:{},reviewAgentEntryCardButtonStyle:{},reviewAgentEntryCardReviewSyncIcon:{},reviewAgentEntryCardContinueIcon:{}},Ho())),Cs=Object(pe.a)(ys),Os=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=Object(o.__read)(Object(ce.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.suggestionIndices),!1)),2),l=s[0],c=s[1],u=n.suggestionIndices[i].changeType,d=Object(o.__read)(Object(ce.useState)(!1),2);d[0],d[1];Object(ce.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var p=function(){return a((function(e){return e-1}))},g=function(){return a((function(e){return e+1}))};return ue.a.createElement(he,{style:t.stack,customProperties:{tabIndex:-1}},l.length?ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(Ga.a,null,"".concat("Suggestion"," ").concat(i+1," of ").concat(l.length)),ue.a.createElement("div",null,ue.a.createElement(nr.a,null,u," "),ue.a.createElement(ms.a,null,"the line"," "),ue.a.createElement(nr.a,null,n.suggestionIndices[i].initialText," "," to"),ue.a.createElement("br",null),ue.a.createElement(ms.a,null,n.suggestionIndices[i].suggestedText)),ue.a.createElement("div",{className:t.footer},ue.a.createElement(be.a,{disabled:n.suggestionIndices[i].disabled,size:"small",icon:ue.a.createElement(dn.f,null),key:i,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t[i].disabled=!0,t})),[4,l[i].onApplySuggestion(l[i].commentId,l[i].suggestedText,l[i].changeType)];case 1:return e.sent(),[2]}}))}))}},"Apply"),ue.a.createElement("div",{className:t.pagination},ue.a.createElement("div",null,ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(me.a,{content:"Previous",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(dn.r,null),onClick:p,disabled:0==i,className:t.paginationButton})),ue.a.createElement(me.a,{content:"Next",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(dn.u,null),onClick:g,disabled:i+1>=l.length,className:t.paginationButton})))))),ue.a.createElement("div",{className:t.contentBoxIcon},Z())):ue.a.createElement(ue.a.Fragment,null,"No results found for the search"))},Ss=Object(E.a)(P),Es=Object(o.__assign)({stack:Object(o.__assign)({},Me.a.gap("16px")),header:{fontWeight:"600"},contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Ss.neutralLight,minHeight:"50px",position:"relative"},Me.a.padding("12px")),Me.a.border("1px","solid",Ss.neutralLighterAlt)),Me.a.borderRadius(Ss.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},Me.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},Me.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:Ss.neutralLight,height:"24px"},Me.a.border("none")),{"&:hover":{color:Ss.themePrimary}}),spinnerButton:{backgroundColor:Ss.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Ss.themePrimary},"&:disabled":{color:Ss.neutralLighterAlt,"&:hover":{color:Ss.neutralLighterAlt}}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:Ss.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},Me.a.border("1px","solid",Ss.neutralLighterAlt)),Me.a.borderRadius(Ss.borderRadiusMedium)),pn.a.caption1),Me.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:Object(o.__assign)(Object(o.__assign)({},pn.a.caption2),{color:Ss.neutralSecondaryAlt}),disabledContentBoxIcon:{":hover":{color:Ss.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Ss.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Ho()),xs=Object(pe.a)(Es),Is=n(3440),ws=function(e){var t=e.styles,n=e.body.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=n.headerText,o=n.reviewersWithAction,i=n.statusMessage,a=n.labelForReviewedPeople,s=n.labelForPendingPeople,l=n.commentsSummaryHeader,c=n.commentsSummaries,u=o.filter((function(e){return e.responded})).length,d=o.length-u;return ue.a.createElement(he,{style:t.reviewStatusCardStyle},ue.a.createElement(Is.a,null,r),ue.a.createElement(nr.a,null,i),u>0&&Ts(o,!0,a,t),d>0&&Ts(o,!1,s,t),c.length>0&&c[0].length>0&&ue.a.createElement("div",null,ue.a.createElement(Ga.a,null,l),c.map((function(e,t){return ue.a.createElement("p",{key:t},ue.a.createElement(nr.a,{key:t},e))}))),ue.a.createElement(Ra.a,{className:t.footerAIGeneratedStyles},Z()))},Ts=function(e,t,n,r){return ue.a.createElement("div",{className:r.reviewSStatusReviewersListStyle},ue.a.createElement(Ga.a,null,n),ue.a.createElement(ts.a,{"aria-label":"Reviewers List",className:r.reviewStatusCardWrapperStyle},e.map((function(e,n){return e.responded===t&&ue.a.createElement(ns.a,{shape:"circular",media:ue.a.createElement(Li.a,{name:e.suggestion.displayName,shape:"circular"}),dismissible:!1,key:n,size:"extra-small",value:e.suggestion.mail},e.suggestion.displayName)}))))},ks=Object(E.a)(_),js=Object(o.__assign)({reviewStatusCardStyle:{rowGap:"17px",display:"flex",flexDirection:"column"},reviewSStatusReviewersListStyle:{rowGap:"8px",display:"flex",flexDirection:"column"},reviewStatusCardWrapperStyle:{flexWrap:"wrap",rowGap:"8px"},footerAIGeneratedStyles:{color:ks.neutralSecondaryAlt}},Ho()),Ps=Object(pe.a)(js),As=function(e){var t,n,r=e.styles,o=e.body,i=o.reviewAgentIndividualCardProps.reviewAgentCardType,a=Cs(),s=xs(),l=Ps();switch(i){case va.EntryPointCard:t=W(a,r),n=bs;break;case va.ConfirmInvitationCard:t=W({},r),n=fs;break;case va.SuggestionCard:t=W(s,r),n=Os;break;case va.ReviewStatusCard:t=W(l,r),n=ws;break;default:t=W({},r),n=function(){return ue.a.createElement("div",null,"Invalid Card Type")}}return ue.a.createElement(n,{body:o,styles:t})},_s=n(3426),Ds=n(3427),Ls=n(3428),Ms=n(3429),Bs=n(3430),Rs=n(3431),Fs=n(3602),Ns=function(e){var t=e.styles,n=e.handleApplyOnClick,r=e.handleApplyAllOnClick,i=Object(o.__read)(Object(ce.useState)(!1),2),a=i[0],s=i[1],l=Object(o.__read)(Object(ce.useState)(!1),2),c=l[0],u=l[1],d=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return s(!0),c?[4,r()]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,n()];case 3:e.sent(),e.label=4;case 4:return s(!1),[2]}}))}))};return a?ue.a.createElement(me.a,{content:"Waiting to apply updates",relationship:"label"},ue.a.createElement(be.a,{className:Object(x.a)(t.spinnerButton,t.combinedButton),onClick:d,disabled:!0,icon:ue.a.createElement(wn.e,{className:t.spinnerIcon})})):ue.a.createElement(fe.a,{positioning:"below-end"},ue.a.createElement(ve.a,{disableButtonEnhancement:!0},(function(e){return ue.a.createElement(me.a,{content:"Apply Updates",relationship:"label"},ue.a.createElement(xa.a,{menuButton:e,primaryActionButton:{onClick:d},size:"small",className:t.applyButton},c?"Apply All":"Apply"))})),ue.a.createElement(Ce.a,null,ue.a.createElement(Oe.a,null,ue.a.createElement(Se.a,{onClick:function(){u((function(e){return!e}))}},c?"Apply":"Apply All"))))},Hs=[{columnKey:"old",label:"Old Comment"},{columnKey:"new",label:"New Comment"}],Us=function(e){var t=e.styles,n=e.body,r=Object(o.__read)(Object(ce.useState)(0),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(Object(o.__spreadArray)([],Object(o.__read)(n.commentIndices),!1)),2),l=s[0],c=s[1],u=Object(o.__read)(Object(ce.useState)(!1),2),d=u[0],p=u[1];Object(ce.useEffect)((function(){i>=l.length&&a(l.length-1)}),[i,l.length]);var g=function(){return a((function(e){return e-1}))},h=function(){return a((function(e){return e+1}))},f=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return p(!0),[4,n.locateTextIndex(l[i])];case 1:return e.sent(),p(!1),[2]}}))}))},m=function(){c((function(e){var t=Object(o.__spreadArray)([],Object(o.__read)(e),!1);return t.splice(i,1),t}))},v={styles:t,handleApplyOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyOnClick(l[i])];case 1:return e.sent(),[2]}}))}))},handleApplyAllOnClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.handleApplyAllOnClick(l)];case 1:return e.sent(),[2]}}))}))}};return ue.a.createElement(he,{style:t.stack,customProperties:{tabIndex:-1}},l.length?ue.a.createElement(ue.a.Fragment,null,ue.a.createElement("div",{className:t.header},"Comments Summary"),ue.a.createElement(_s.a,{"aria-label":"2X2 table"},ue.a.createElement("div",{className:t.header},ue.a.createElement("p",null,"Author Email : ",n.commentIndices[i].authorEmail)),ue.a.createElement(Ds.a,null,ue.a.createElement(Ls.a,null,Hs.map((function(e){return ue.a.createElement(Ms.a,{key:e.columnKey,className:t.tableHeader},e.label)})))),ue.a.createElement(Bs.a,null,ue.a.createElement(Ls.a,null,ue.a.createElement(Rs.a,null,ue.a.createElement(Fs.a,null,n.commentIndices[i].oldCommentText)),ue.a.createElement(Rs.a,null,ue.a.createElement(Fs.a,null,n.commentIndices[i].newCommentText))))),ue.a.createElement("div",{className:t.contentBox},ue.a.createElement("div",{className:t.contentBoxButtonGroup},ue.a.createElement("div",{className:d?t.disabledContentBoxIcon:t.contentBoxIcon},d?ue.a.createElement(wn.f,{className:t.spinnerIcon}):ue.a.createElement(me.a,{content:"Locate",relationship:"label"},ue.a.createElement(Mt.b,{onClick:f}))),d?ue.a.createElement(ue.a.Fragment,null):ue.a.createElement("div",{className:Object(x.a)(t.contentBoxIcon,t.dismissIcon)},ue.a.createElement(me.a,{content:"Remove",relationship:"label"},ue.a.createElement(pt.h,{onClick:m})))),ue.a.createElement("div",{className:t.contentBoxText},i<l.length&&n.commentIndices[i].comment)),ue.a.createElement("div",{className:t.footer},ue.a.createElement("div",null,ue.a.createElement(Ns,Object(o.__assign)({},v))),ue.a.createElement("div",{className:t.pagination},ue.a.createElement("div",{className:t.paginationNumberBox},i+1,"/",l.length),ue.a.createElement("div",null,ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(me.a,{content:"Previous",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(gi.i,null),onClick:g,disabled:0==i,className:t.paginationButton})),ue.a.createElement(me.a,{content:"Next",relationship:"label"},ue.a.createElement(be.a,{icon:ue.a.createElement(gi.j,null),onClick:h,disabled:i+1>=l.length,className:t.paginationButton}))))))):ue.a.createElement(ue.a.Fragment,null,"No results found for the search"))},Vs=Object(E.a)(P),zs=Object(o.__assign)({stack:Object(o.__assign)({textAlign:"start",textOverflow:"clip"},Me.a.gap("12px")),header:{fontWeight:"bold"},contentBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Vs.neutralLight,minHeight:"50px",position:"relative"},Me.a.padding("12px")),Me.a.border("1px","solid",Vs.neutralLighterAlt)),Me.a.borderRadius(Vs.borderRadiusMedium)),footer:Object(o.__assign)({width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},Me.a.gap("12px")),pagination:Object(o.__assign)({flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap"},Me.a.gap("10px")),paginationButton:Object(o.__assign)(Object(o.__assign)({backgroundColor:Vs.neutralLight,height:"24px"},Me.a.border("none")),{"&:hover":{color:Vs.themePrimary}}),spinnerButton:{backgroundColor:Vs.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Vs.themePrimary}},paginationNumberBox:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"center",backgroundColor:Vs.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box"},Me.a.border("1px","solid",Vs.neutralLighterAlt)),Me.a.borderRadius(Vs.borderRadiusMedium)),pn.a.caption1),Me.a.padding("4px","8px")),dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Vs.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Vs.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Vs.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"}},Ho()),Gs=Object(pe.a)(zs),Ws=n(98),Qs=n(344),qs=n.n(Qs),Ks=Object(E.a)(P),Ys=Object(o.__assign)(Object(o.__assign)({},Ho()),{cardRoot:{color:Ks.black,fontSize:Be.a.fontSizeBase300,"& pre":{whiteSpace:"pre-wrap"},"& table":Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",Be.a.colorNeutralBackground1Pressed)),{borderCollapse:"collapse"}),"& th":Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Hover},Me.a.padding("1px","5px")),"& td":Object(o.__assign)(Object(o.__assign)({},Me.a.borderBottom("1px","solid",Be.a.colorNeutralBackground3Pressed)),Me.a.padding("1px","5px")),"& a ":Object(o.__assign)({},Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({height:Be.a.lineHeightBase200,gap:Be.a.spacingHorizontalXS,display:"inline-flex",alignItems:"flex-start",color:Ks.colorBrandForegroundLink},Me.a.padding("0px","0px",Be.a.spacingVerticalXXS)),{textDecorationLine:"none",cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(o.__assign)({color:Ks.colorBrandForegroundLinkHover},Me.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:active"]=Object(o.__assign)({color:Ks.colorBrandForegroundLinkPressed},Me.a.textDecoration("underline","solid")),e}()),function(){var e;return(e={})["&:focus"]=Object(o.__assign)(Object(o.__assign)({color:Ks.colorBrandForegroundLinkSelected},Me.a.textDecoration("underline","solid",Be.a.colorStrokeFocus2)),Me.a.borderBottom("1px","solid",Be.a.colorStrokeFocus2)),e}()),function(){var e;return(e={})["&:disabled"]={color:Be.a.colorNeutralForegroundDisabled,textDecorationLine:"none",cursor:"default"},e}())),"& button, .ac-pushButton":Object(o.__assign)({},Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:Be.a.fontWeightRegular,color:Be.a.colorNeutralForeground1,fontSize:Be.a.fontSizeBase200},Me.a.padding(Be.a.spacingVerticalXS,Be.a.spacingHorizontalS)),Me.a.borderRadius(Be.a.borderRadiusMedium)),Me.a.border("1px","solid",Be.a.colorNeutralStroke1)),{backgroundColor:Be.a.colorNeutralBackground1,cursor:"pointer"}),function(){var e;return(e={})["&:hover"]=Object(o.__assign)(Object(o.__assign)({},Me.a.borderColor(Be.a.colorNeutralStroke1Hover)),{backgroundColor:Be.a.colorNeutralBackground1Hover,color:Be.a.colorNeutralForeground1Hover}),e["&:hover .".concat(gn.a.icon)]={color:Ks.themePrimary},e}()),function(){var e;return(e={})["&:hover:active"]=Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Pressed,color:Be.a.colorNeutralForeground1Pressed},Me.a.borderColor(Be.a.colorNeutralStroke1Pressed)),e}()),function(){var e;return(e={})["&:disabled"]=Object(o.__assign)(Object(o.__assign)({},Me.a.borderColor(Be.a.colorNeutralStrokeDisabled)),{color:Be.a.colorNeutralForegroundDisabled,backgroundColor:Be.a.colorNeutralBackgroundDisabled,cursor:"default"}),e}())),"& .ac-container":{"& ol, ul":{paddingInlineStart:Be.a.spacingVerticalXL}},"& .ac-image":{objectFit:"contain"}},decorativeBorder:Object(o.__assign)(Object(o.__assign)({},Me.a.margin(Be.a.spacingVerticalS,Be.a.spacingVerticalNone,Be.a.spacingVerticalNone)),Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius(Be.a.borderRadiusMedium)),Me.a.border("1px","solid",Be.a.colorNeutralStroke1))),adaptiveCardWrapper:Object(o.__assign)({},Me.a.padding(Be.a.spacingVerticalS,Be.a.spacingVerticalM,Be.a.spacingVerticalM)),cardHeader:{},cardFooter:{},cardSourceLabel:{display:"flex",flexDirection:"row",width:"100%",height:Be.a.lineHeightBase300,marginBottom:Be.a.spacingVerticalM,color:Be.a.colorNeutralForeground4,"& label":{fontSize:Be.a.fontSizeBase100,marginLeft:Be.a.spacingVerticalXS,height:Be.a.lineHeightBase100}}}),Zs=Object(pe.a)(Ys),Js=function(e){var t=e.text,n=Zs(),r=Object(x.a)(null==n?void 0:n.cardFooter,null==n?void 0:n.footerBar);return t?ue.a.createElement("div",{className:r},ue.a.createElement("span",null,t)):null},Xs=function(e){var t=e.text,n=Zs(),r=Object(x.a)(null==n?void 0:n.cardHeader,n.headerBar);return t?ue.a.createElement("div",{className:r},ue.a.createElement("span",null,t)):null},$s=n(1622),el=function(e){var t=e.text,n=e.iconName,r=Zs();return t||n?ue.a.createElement(he,{style:r.cardSourceLabel},n&&ue.a.createElement($s.a,{iconName:n}),t&&ue.a.createElement("label",null,t)):null},tl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.isTelemetryEnabled=function(e){return e instanceof t||void 0!==e.executeWithTelemetry},t}(Ws.Action);Ws.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new qs.a).render(e),t.didProcess=!0};var nl=function(e){var t=e.styles,n=e.body,r=e.telemetryData,o=void 0===r?"":r,i=n.actionHandlers,a=n.customActions,s=n.cardData,l=n.headerText,c=n.footerText,u=n.sourceLabel,d=n.decorativeBorder,p=void 0===d||d,g=Object(x.a)(null==t?void 0:t.adaptiveCardWrapper,p?null==t?void 0:t.decorativeBorder:null);return ue.a.createElement(he,{style:null==t?void 0:t.cardRoot},ue.a.createElement(Xs,{text:l}),ue.a.createElement("div",{className:g},ue.a.createElement(el,{text:null==u?void 0:u.text,iconName:null==u?void 0:u.iconName}),ue.a.createElement(rl,{element:ol(s,i,a,o)})),ue.a.createElement(Js,{text:c}))},rl=function(e){var t=e.element,n=Object(ce.useRef)();return Object(ce.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),ue.a.createElement("span",{ref:n})},ol=function(e,t,n,r){var o=new Ws.CardObjectRegistry;for(var i in Ws.GlobalRegistry.populateWithDefaultActions(o),n)o.register(i,n[i]);var a=new Ws.SerializationContext;a.setActionRegistry(o);var s=new Ws.AdaptiveCard;return s.hostConfig=new Ws.HostConfig({spacing:{default:"12",padding:"0"},containerStyles:{default:{foregroundColors:{default:{default:Ks.black}}}}}),s.parse(e,a),s.onExecuteAction=function(e){try{if(tl.isTelemetryEnabled(e))e.executeWithTelemetry(r);else if(e instanceof Ws.OpenUrlAction)(null==t?void 0:t.openUrlActionHandler)&&t.openUrlActionHandler(e.url,r);else if(e instanceof Ws.ExecuteAction&&(null==t?void 0:t.executeActionHandlers)){var n=t.executeActionHandlers[e.verb];n&&n(e.data,r)}}catch(e){}},s.render()},il=n(340),al=n.n(il);Ws.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new qs.a).render(e),t.didProcess=!0};var sl,ll,cl,ul=function(e){var t=e.cardData,n=new Ws.AdaptiveCard;n.hostConfig=new Ws.HostConfig({spacing:{padding:"0px"},containerStyles:{default:{foregroundColors:{default:{default:zo.black}}}}}),n.parse(t);var r=n.render();return ue.a.createElement(dl,{element:r})},dl=function(e){var t=e.element,n=Object(ce.useRef)();return Object(ce.useEffect)((function(){return t&&n.current&&n.current.appendChild(t),function(){t&&n.current&&n.current.removeChild(t)}}),[t]),ue.a.createElement("span",{ref:n})},pl=function(e){var t=e.styles,n=e.body,r=e.strikeThroughText,i=e.references,a=void 0===i?[]:i,s=e.telemetryData,l=void 0===s?"":s,c=Object(ce.useRef)(null),u=n.basin,d=n.uniqueId,p=n.accessPath,g=n.value;Object(ce.useEffect)((function(){!function(){var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}()}),[g]);var h=t.adaptiveCardRoot;if(r&&(h=Object(x.a)(t.adaptiveCardRoot,t.strikeThroughText)),u.items&&d&&p){var f=al()(u.items[d],p,null),m=[];if(a.length>0&&(m=Q(f,a)),0===m.length&&f)return ue.a.createElement(he,{style:h},ue.a.createElement(ul,{cardData:f}),ue.a.createElement("span",{ref:c}));if(f&&m.length>0)return ue.a.createElement(he,{style:h},m.map((function(e,n){return ue.a.createElement("span",{key:n,className:t.markdownRoot},ue.a.createElement(ul,{cardData:e.adaptiveCard})," ",e.references.map((function(e,t){return ue.a.createElement(Qi,Object(o.__assign)({},e,{key:t,telemetryData:l}))})))})),ue.a.createElement("span",{ref:c}))}return null},gl=function(e){var t=e.styles,n=e.body,r=e.warningActionButtons,o=void 0===r?[]:r;return ue.a.createElement(he,{style:t.warningMessageRootStack},ue.a.createElement(ut.a,{tabIndex:-1},n.warningPrefix,n.warningEmphasizedText&&ue.a.createElement("span",{className:t.warningMessageBoldText},n.warningEmphasizedText),n.warningSuffix),o&&o.length>0&&o.map((function(e,n){return ue.a.createElement(be.a,{key:n,className:t.warningActionButton,"aria-label":e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled},e.buttonText)})))},hl=Object(E.a)(P),fl=Object(o.__assign)({warningMessageRootStack:Object(o.__assign)({alignItems:"center"},Me.a.gap("4px")),warningMessageBoldText:Object(o.__assign)({},pn.a.body1Stronger),warningActionButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"100%",height:"28px",backgroundColor:hl.neutralLight},Me.a.border("1px","solid",hl.neutralLighterAlt)),Me.a.borderRadius(hl.borderRadiusMedium)),Me.a.padding("0px","0px","4px","0px")),pn.a.body1)},Ho()),ml=Object(pe.a)(fl),vl=function(e){var t,n,i,s,l,u,d=e.chatMessage,p=e.chatCardIndex,g=e.shouldShowFeedbackButtons,h=e.handleChatCardThumbsDownClick,f=e.handleChatCardThumbsUpClick,m=e.designerProps,v=e.customMessageRenderers,b=e.pluginServiceProvider,y=e.msgExtCardContextProvider,C=e.useFluentAIGeneratedIndicator,O={handleThumbsDownClick:h,handleThumbsUpClick:f,shouldShowFeedbackButtons:g,chatCardIndex:p,feedbackSectionPosition:d.feedbackSectionPosition,shouldShowAIGeneratedIndicator:d.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:!1,useFluentAIGeneratedIndicator:C,actionBarButtons:d.actionBarButtons,feedbackData:d.feedbackData,showAnimation:d.showAnimation,strikeThroughText:d.strikeThroughText,showMinifiedUI:null!==(t=d.showMinifiedUI)&&void 0!==t&&t,references:d.references,pillsList:d.pillsList,handlePillOnClick:d.handlePillOnClick,handleShowMeOnClick:d.handleShowMeOnClick,warningActionButtons:null!==(n=d.warningActionButtons)&&void 0!==n?n:[],clpSensitivityIndicatorData:null!==(i=d.clpSensitivityIndicatorData)&&void 0!==i?i:void 0,telemetryData:null!==(s=d.telemetryData)&&void 0!==s?s:"",msgExtCardProps:d.msgExtCardProps,pluginAuthError:d.pluginAuthError},S=d.messageType,E=d.body,x=d.styles;switch(S){case c.Default:O.styles=W(Xi(),x),u=ue.a.createElement($i,Object(o.__assign)({body:E},O));break;case c.PaginatedCard:O.styles=W(ja(),x),u=ue.a.createElement(wa,Object(o.__assign)({body:E},O));break;case c.AccordionCard:u=ue.a.createElement(co,Object(o.__assign)({styles:x,body:E},O));break;case c.ContentCard:O.styles=W(to(),x),u=ue.a.createElement(oo,Object(o.__assign)({body:E},O));break;case c.ChatCardWrapper:O.styles=W(function(){var e=Uo(),t=Ro();a()===r.IOS&&W(e,t);return e}(),x),u=ue.a.createElement(Qo,{renderData:E.renderData,fallbackElement:E.element,customMessageRenderers:v});break;case c.FeedbackNudge:O.styles=W(function(){var e=ia(),t=na();a()===r.IOS&&W(e,t);return e}(),x),u=ue.a.createElement(ea,Object(o.__assign)({body:E},O));break;case c.MarkdownCard:O.styles=W(function(){var e=Ea(),t=Ca();a()===r.IOS&&W(e,t);return e}(),x),u=ue.a.createElement(ya,Object(o.__assign)({body:E},O,{msgExtCardContextProvider:y}));break;case c.SelfHelpAdaptiveCard:O.styles=W(Zs(),x),u=ue.a.createElement(nl,Object(o.__assign)({body:E},O));break;case c.StreamingAdaptiveCard:O.styles=W(Wo(),x),u=ue.a.createElement(pl,Object(o.__assign)({body:E},O));break;case c.Designer:var I=E,w=m.clientSettings;return E.clientSessionId&&(w.sessionId=E.clientSessionId),E.correlationId&&(w.correlationId=E.correlationId),ue.a.createElement(Vr.a,Object(o.__assign)({key:E.message},m,{clientSettings:w,userInput:I.message,turnId:I.turnId,isRehydration:I.isRehydration,handleThumbsDownClick:function(){return h({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(w)}})},handleThumbsUpClick:function(){return f({feedbackArea:"Designer-Card",contextData:{cardMetaData:JSON.stringify(m.clientSettings)}})},feedbackData:O.feedbackData,fileCacheInfo:I.fileCacheInfo,isStockQuery:I.isStockQuery,stockImages:I.stockImages,imageType:I.imageType,isAuthEnabled:I.isAuthEnabled,dimensions:I.dimensions,companyName:I.companyName}));case c.WarningMessage:O.styles=W(ml(),x),u=ue.a.createElement(gl,Object(o.__assign)({body:E},O));break;case c.ProactiveSuggestionCard:O.styles=W(La(),x),u=ue.a.createElement(Aa,Object(o.__assign)({body:E},O));break;case c.CopilotWorkflowMessage:return ue.a.createElement(Qr,{launchText:E.launchText,buttonText:E.buttonText,onLaunch:E.onLaunch});case c.ReviewerSummaryCard:O.styles=W(Gs(),x),u=ue.a.createElement(Us,Object(o.__assign)({body:E},O));break;case c.ReviewAgentCard:O.styles=W({},x),u=ue.a.createElement(As,Object(o.__assign)({body:E},O));break;default:u=null}return ue.a.createElement(Vi,Object(o.__assign)({body:{user:null===(l=d.body)||void 0===l?void 0:l.user,element:u},pluginServiceProvider:b,msgExtCardContextProvider:y},O))},bl=ue.a.memo(vl,(function(e,t){var n,r;return t.chatMessage.messageType===c.Designer&&(null===(n=e.designerProps)||void 0===n?void 0:n.clientSettings.designerTheme)===(null===(r=t.designerProps)||void 0===r?void 0:r.clientSettings.designerTheme)})),yl={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:Object(o.__assign)({verticalAlign:"end"},Me.a.gap("10px")),chatCardsStack:Object(o.__assign)(Object(o.__assign)({verticalAlign:"end"},Me.a.padding("0px","16px")),Me.a.gap("10px"))},Cl=Object(pe.a)(yl),Ol=function(e){var t,n=e.children,r=e.chatLog,o=e.styles,i=e.elementsBeforeChatLog,a=e.shouldShowFeedbackButtons,s=void 0===a||a,l=e.handleChatCardThumbsDownClick,c=e.handleChatCardThumbsUpClick,u=e.designerProps,d=e.customMessageRenderers,p=e.pluginServiceProvider,g=e.msgExtCardContextProvider,h=e.useFluentAIGeneratedIndicator,f=W(Cl(),o),m=null!==(t=null==u?void 0:u.isDesignerEnabled)&&void 0!==t&&t,v=m?bl:vl;return ue.a.createElement(he,{style:f.root,reverse:!0},ue.a.createElement(he,{style:f.elementStack},i,ue.a.createElement(he,{style:f.chatCardsStack,customProperties:{role:M,"aria-label":U()?OfficeaicopilotStrings.ChatMessagesLabel:"Chat Messages","aria-setsize":r.length}},r.map((function(e,t){return ue.a.createElement(v,{key:t,chatCardIndex:t,chatMessage:e,useFluentAIGeneratedIndicator:h,shouldShowFeedbackButtons:s,handleChatCardThumbsDownClick:l,handleChatCardThumbsUpClick:c,designerProps:m?u:void 0,customMessageRenderers:d,pluginServiceProvider:p,msgExtCardContextProvider:g})}))),n))},Sl=Object(E.a)(_),El={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("10px")),Me.a.margin(Sl.spacingVerticalNone,Sl.spacingHorizontalNone,Sl.spacingVerticalS,Sl.spacingHorizontalS)),{alignContent:"center"}),Me.a.border("0px")),(sl={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},sl["&:hover .".concat(gn.a.icon)]={color:Sl.themePrimary},sl["&:hover:active .".concat(gn.a.icon)]={color:Sl.themePrimary},sl))},xl=Object(pe.a)(El),Il=function(e){var t=e.buttonText,n=e.icon,r=e.onClick;return ue.a.createElement(be.a,{appearance:"subtle",className:xl().root,icon:n,onClick:r,size:"small"},t)},wl=Object(E.a)(_),Tl={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("10px")),Me.a.margin(wl.spacingVerticalNone,wl.spacingHorizontalNone,wl.spacingVerticalS,wl.spacingHorizontalS)),{alignContent:"center"}),Me.a.border("0px")),(ll={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},ll["&:hover .".concat(gn.a.icon)]={color:wl.themePrimary},ll["&:hover:active .".concat(gn.a.icon)]={color:wl.themePrimary},ll))},kl=Object(pe.a)(Tl),jl=ce.memo((function(e){var t=e.handleChangeTopicButtonClick;return ce.createElement(be.a,{appearance:"subtle",className:kl().root,icon:ce.createElement(xe.e,null),onClick:t,size:"small"},Pe())})),Pl=Object(E.a)(_),Al={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("10px")),Me.a.margin(Pl.spacingVerticalNone,Pl.spacingHorizontalNone,Pl.spacingVerticalS,Pl.spacingHorizontalS)),{alignContent:"center"}),Me.a.border("0px")),(cl={width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}},cl["&:hover .".concat(gn.a.icon)]={color:Pl.themePrimary},cl["&:hover:active .".concat(gn.a.icon)]={color:Pl.themePrimary},cl))},_l=Object(pe.a)(Al);var Dl=ce.memo((function(e){var t=e.handlePythonExitAnalysisButtonClick;return ce.createElement(be.a,{appearance:"subtle",className:_l().root,icon:ce.createElement(Bt.i,null),onClick:t,size:"small"},"Exit analysis mode")}));function Ll(e){var t,n,r,o,i,a,s={root:null!==(t=e.root)&&void 0!==t?t:{},button:null!==(n=e.button)&&void 0!==n?n:{},suggestionContainer:null!==(r=e.suggestionContainer)&&void 0!==r?r:{},refreshButton:null!==(o=e.refreshButton)&&void 0!==o?o:{},refreshButtonIcon:null!==(i=e.refreshButtonIcon)&&void 0!==i?i:{},tooltip:null!==(a=e.tooltip)&&void 0!==a?a:{}};return Object(pe.a)(s)}var Ml,Bl,Rl=Object(E.a)(P),Fl=Ll({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({justifyContent:"flex-start",flexWrap:"nowrap",backgroundColor:"transparent",minHeight:"67px"},Me.a.padding("12px","0px")),Me.a.margin(Rl.spacingVerticalNone)),{"> *:not(.ms-StackItem)":{flexShrink:0},overflowX:"auto",overflowY:"hidden"}),suggestionContainer:Object(o.__assign)(Object(o.__assign)({minHeight:"67px"},Me.a.overflow("hidden")),Me.a.padding("12px")),button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),{display:"flex"}),Me.a.padding("0px","8px")),{fontFamily:"-apple-system",lineHeight:"normal",fontStyle:"normal",fontWeight:"400",fontSize:"14px",alignItems:"center",order:"0",textOverflow:"ellipsis",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",textAlign:"start"}),refreshButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",Rl.themeMedium)),{backgroundColor:"transparent"}),Me.a.borderRadius("50%")),Me.a.padding("2px")),Me.a.margin("4px")),{verticalAlign:"middle",minWidth:"40px",height:"40px",order:-1}),tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}}),Nl=Ll({root:Object(o.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},Me.a.margin(Be.a.spacingHorizontalNone,Be.a.spacingHorizontalL,Be.a.spacingHorizontalNone)),suggestionContainer:{},button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"start",color:Be.a.colorNeutralForeground1,backgroundColor:"transparent"},Me.a.border("1px","solid",Be.a.colorBrandBackground2Hover)),pn.a.caption1),Me.a.borderRadius(Be.a.borderRadiusXLarge)),Me.a.padding(Be.a.spacingVerticalSNudge,Be.a.spacingHorizontalS)),Me.a.margin(Be.a.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(o.__assign)({backgroundColor:Be.a.colorBrandBackground2},Me.a.border("1px","solid",Be.a.colorBrandStroke2Hover)),"&:hover :active":Object(o.__assign)({backgroundColor:Be.a.colorBrandBackground2},Me.a.border("1px","solid",Be.a.colorBrandStroke2Hover))}}),refreshButton:Object(o.__assign)(Object(o.__assign)({minWidth:"fit-content"},Me.a.border("1px","solid",Be.a.colorBrandBackground2Hover)),{"@media (forced-colors: none)":(Ml={"&:hover":Object(o.__assign)({backgroundColor:Be.a.colorBrandBackground2},Me.a.border("1px","solid",Be.a.colorBrandStroke2Hover))},Ml["&:hover .".concat(gn.a.icon)]={color:Be.a.colorCompoundBrandForeground1},Ml)}),refreshButtonIcon:{width:"14px",height:"14px"}}),Hl=Object(E.a)(P),Ul=Ll({root:Object(o.__assign)({justifyContent:"flex-end",flexWrap:"wrap"},Me.a.margin(Hl.spacingHorizontalNone,Hl.spacingHorizontalL,Hl.spacingHorizontalNone)),suggestionContainer:{},button:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({textAlign:"start",color:Hl.neutralPrimary,backgroundColor:"transparent"},Me.a.border("1px","solid",Hl.themeMedium)),pn.a.caption1),Me.a.borderRadius(Hl.borderRadiusXLarge)),Me.a.padding(Hl.spacingVerticalSNudge,Hl.spacingHorizontalS)),Me.a.margin(Hl.spacingVerticalXS)),{"@media (forced-colors: none)":{"&:hover":Object(o.__assign)({backgroundColor:Hl.themeLight},Me.a.border("1px","solid",Hl.themeDarker)),"&:hover :active":Object(o.__assign)({backgroundColor:Hl.themeLight},Me.a.border("1px","solid",Hl.themeDarker))}}),refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":(Bl={},Bl["&:hover .".concat(gn.a.icon)]={color:Hl.themePrimary},Bl)},refreshButtonIcon:{width:"14px",height:"14px"}}),Vl=function(e){var t=e.stylesToOverride,n=e.suggestionList,o=e.handleSuggestionPillClick,i=e.showRefreshButton,s=void 0!==i&&i,l=e.handleRefreshButtonClick,c=void 0===l?function(){}:l,u=function(){var e=Ul(),t=Nl(),n=v()?t:e;n.refreshButton=Object(x.a)(n.button,n.refreshButton);var o=Fl();a()===r.IOS&&W(n,o);return n}();W(u,t);return ue.a.createElement("div",{className:u.suggestionContainer},ue.a.createElement(he,{style:u.root,horizontal:!0,customProperties:{role:L,tabIndex:0,"aria-label":je()}},n.map((function(e,t){return ue.a.createElement(me.a,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},ue.a.createElement(be.a,{size:"small",appearance:"subtle",className:u.button,onClick:function(){return o(e)},role:N,id:"".concat(je,"-").concat(t)},e))})),s&&ue.a.createElement(me.a,{content:ue.a.createElement("span",{className:u.tooltip},U()?OfficeaicopilotStrings.SuggestionPaneRefreshButtonLabel:"Refresh"),relationship:"label",positioning:"above"},ue.a.createElement(be.a,{appearance:"subtle",className:u.refreshButton,onClick:function(){c();var e=document.getElementById("".concat(je,"-0"));e&&"function"==typeof e.focus&&e.focus()},icon:{className:u.refreshButtonIcon,children:ue.a.createElement(Bt.g,null)},role:N}))))},zl=function(){return U()?OfficeaicopilotStrings.HintCardHeaderTextLabel:"hintCardHeaderText"},Gl=function(){return U()?OfficeaicopilotStrings.HintCardDescriptionTextLabel:"hintCardDescriptionText"};var Wl,Ql,ql,Kl=function(e){var t,n,r,o={root:null!==(t=e.root)&&void 0!==t?t:{},rootHighContrast:{},headerText:null!==(n=e.headerText)&&void 0!==n?n:{},descriptionText:null!==(r=e.descriptionText)&&void 0!==r?r:{}};return Object(pe.a)(o)}({root:{lineHeight:"normal"}}),Yl=Object(E.a)(P),Zl={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({boxShadow:Yl.shadow4,backgroundColor:Yl.neutralLight},Me.a.borderRadius(Yl.borderRadiusXLarge)),Me.a.margin(Yl.spacingVerticalNone,Yl.spacingHorizontalL,Yl.spacingVerticalXXS)),Me.a.padding(Yl.spacingVerticalM)),rootHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",Yl.neutralLighterAlt)),headerText:{fontWeight:Yl.fontWeightSemibold,color:Yl.themePrimary},descriptionText:{color:Yl.neutralQuaternaryAlt}},Jl=Object(pe.a)(Zl),Xl=function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n]);e.rootHighContrast=Object(x.a)(e.root,e.rootHighContrast)},$l=ue.a.memo((function(e){var t=e.overrideStyles,n=e.headerText,o=e.descriptionText,i=f(),s=function(){var e=Jl(),t=Kl();a()===r.IOS&&Xl(e,t);return e}();return Xl(s,t),ue.a.createElement(he,{style:i?s.rootHighContrast:s.root,customProperties:{role:L,"aria-labelledby":zl(),"aria-describedby":Gl(),"aria-live":"polite"}},ue.a.createElement(ut.a,{id:zl(),className:s.headerText},n),ue.a.createElement(ut.a,{id:Gl(),className:s.descriptionText},o))})),ec=Object(E.a)(P),tc={chatInputRestShy:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px","solid",ec.neutralLighterAlt)),Me.a.borderRadius("12px")),{backgroundColor:ec.neutralLight}),Me.a.margin(ec.spacingHorizontalNone,ec.spacingHorizontalL,ec.spacingHorizontalL,ec.spacingHorizontalL)),Me.a.padding("4px")),Me.a.gap("12px")),{position:"relative",zIndex:"1",transform:"none",transformOrigin:"bottom","&selectors":{"&.chatInputLeftButtons":{"> button":{"&svg":{height:"18px",width:"18px"}}}}}),chatInputContainerRestShy:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding("6px","4px","0px")),{fontFamily:"-apple-system",fontStyle:"normal",fontWeight:"400",fontSize:"15px",cursor:"pointer",width:"min-content",lineHeight:"normal",display:"flex",alignItems:"center",letterSpacing:"-0.43px",color:ec.neutralSecondaryAlt}),Me.a.flex("none")),{order:"1",flexGrow:"1"}),chatInputRestShyMenuButton:{height:"40px",width:"40px","&selectors":{"&svg":{height:"24px",width:"24px",fill:ec.themePrimary},"&hover":{backgroundColor:"transparent !important"}}}},nc=Object(pe.a)(tc),rc=n(3441),oc=n(3442),ic=n(3443),ac=n(862),sc=Object(pe.a)({item:{fontSize:"16px",lineHeight:"normal",fontFamily:"-apple-system"},itemContent:Object(o.__assign)(Object(o.__assign)({display:"inline-block",whiteSpace:"nowrap"},Me.a.overflow("hidden")),{textOverflow:"ellipsis"}),menuGroupHeader:{fontSize:"14px",fontFamily:"-apple-system",lineHeight:"normal"}}),lc=Object(E.a)(P),cc=Object(pe.a)({item:(Wl={},Wl["&:hover .".concat(ac.a.icon)]={color:lc.themePrimary},Wl.paddingLeft="10px",Wl),itemContent:{},menuParent:Object(o.__assign)({width:"100%"},Me.a.margin("0px","16px")),menuGroupHeader:{color:lc.black}}),uc=function(){var e=cc(),t=sc();if(a()===r.IOS)W(e,t);return e},dc=function(e){var t,n=uc();return ue.a.createElement(rc.a,{key:null!==(t=e.sectionHeader)&&void 0!==t?t:T},e.showSectionTopDivider&&ue.a.createElement(oc.a,null),e.sectionHeader!==T&&ue.a.createElement(ic.a,{className:n.menuGroupHeader},e.sectionHeader),e.starterPrompts.map((function(t){return pc(t,e.sectionHeader)})))},pc=function(e,t){var n=Object(Ee.a)(e.iconHover,e.iconRegular),r=uc();return ue.a.createElement(Se.a,{key:e.text,className:r.item,icon:ue.a.createElement(n,null),onClick:function(){return gc(e.text)},"aria-label":t+" "+e.text,content:{className:r.itemContent}},e.text)},gc=function(e){Ql.handleOnClickStarterPromptMenuItem&&Ql.handleOnClickStarterPromptMenuItem(e)},hc=Object(E.a)(P),fc=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent")),{width:"40px",height:"40px",maxWidth:"unset","&:hover":Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent"))})}),mc=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent"))})}),vc=Object(pe.a)({root:{color:hc.themePrimary}}),bc=Object(E.a)(P),yc=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:bc.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},Me.a.borderColor(bc.neutralLight)),Me.a.borderRadius(bc.borderRadiusXLarge)),{marginLeft:"4px",width:"32px",height:"32px","&:hover":{backgroundColor:bc.neutralTertiaryAlt}})}),Cc=Object(pe.a)({root:{backgroundColor:bc.neutralLighter}}),Oc=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:bc.neutralTertiary},Me.a.borderColor(bc.neutralTertiary)),{"&:hover":Object(o.__assign)({backgroundColor:bc.neutralTertiary},Me.a.borderColor(bc.neutralTertiary))})}),Sc=Object(pe.a)({root:{color:bc.neutralPrimary}}),Ec=Object(pe.a)({root:{color:bc.themePrimary}}),xc=Object(pe.a)({root:{color:bc.neutralQuaternary}}),Ic=function(e){var t=e.title,n=e.isDisabled,i=e.isMenuOpen,s=e.setMenuOpen,l=(e.handleClick,e.positioningRef),c=e.menuProps,u=Object(ce.useRef)(function(){var e=yc(),t=fc();a()===r.IOS&&W(e,t);return e}()),d=Object(ce.useRef)(Object(x.a)(u.current.root,Cc().root)),p=Object(ce.useRef)(Object(x.a)(u.current.root,function(){var e=Oc(),t=mc();a()===r.IOS&&W(e,t);return e}().root)),g=Object(ce.useRef)(function(){var e=Sc(),t=vc();a()===r.IOS&&W(e,t);return e}()),h=Object(ce.useRef)(Ec().root),f=Object(ce.useRef)(xc().root),m=Object(o.__read)(Object(ce.useState)(u.current.root),2),v=m[0],b=m[1],y=Object(o.__read)(Object(ce.useState)(g.current.root),2),C=y[0],O=y[1];Object(ce.useEffect)((function(){n?(b(p.current),O(f.current)):i?(b(d.current),O(h.current)):(b(u.current.root),O(g.current.root))}),[n,i]);return ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(be.a,{className:v,title:t,"aria-haspopup":!0,"aria-expanded":i,role:"button",icon:{className:C,children:i?ue.a.createElement(wn.c,null):ue.a.createElement(wn.d,null)},disabled:n,onClick:function(){return s(!i)}}),ue.a.createElement(fe.a,{open:i,onOpenChange:function(e,t){s(t.open)},positioning:{positioningRef:l}},(Ql=c,ue.a.createElement(Ce.a,{className:uc().menuParent},ue.a.createElement(Oe.a,null,Ql.sections.map((function(e){return dc(e)})))))))},wc=function(e){var t,n=e.handleClickAndUnMount,r=e.chatInputRestShyPlaceholder,i=e.isMenuButtonEnabled,a=void 0!==i&&i,s=e.isDisabled,l=e.menuButtonTitle,c=void 0===l?w():l,u=e.handleMenuButtonClick,d=e.handleOnOpenMenu,p=e.menuProps,g=(e.overrideStyles,Object(ce.useRef)()),h=Object(ce.useRef)(null),f=nc(),m=Object(o.__read)(Object(ce.useState)(!1),2),v=m[0],b=m[1];ue.a.useEffect((function(){var e;g.current&&(null===(e=h.current)||void 0===e||e.setTarget(g.current))}),[h,g]);return s&&v&&b(!1),ue.a.createElement(he,null,ue.a.createElement("div",{id:"copilot-chat-input-shy",className:f.chatInputRestShy,ref:g},ue.a.createElement(he,{horizontal:!0},ue.a.createElement("div",{className:f.chatInputRestShyMenuButton},a&&ue.a.createElement(Ic,{title:c,isDisabled:s||0===(null===(t=null==p?void 0:p.sections)||void 0===t?void 0:t.length),isMenuOpen:v,setMenuOpen:b,handleClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return u&&u(),v?(b(!1),[3,4]):[3,1];case 1:return d?[4,d()]:[3,3];case 2:e.sent(),e.label=3;case 3:b(!0),e.label=4;case 4:return[2]}}))}))},menuProps:p,positioningRef:h})),ue.a.createElement("div",{className:f.chatInputContainerRestShy,onClick:n,role:"textbox",tabIndex:0,"aria-disabled":s},r))))},Tc=Object(E.a)(P),kc={root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Tc.neutralLight},Me.a.borderRadius(Tc.borderRadiusXLarge)),Me.a.margin(Tc.spacingHorizontalL)),Me.a.padding(Tc.spacingVerticalM)),Me.a.border("1px","double",Tc.colorTransparentStroke)),{backgroundImage:"linear-gradient(".concat(Tc.neutralLight,", ").concat(Tc.neutralLight,"), radial-gradient(circle at top left, ").concat(Tc.themePrimary,", ").concat(Tc.themeSecondary,")"),backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",rowGap:Tc.spacingVerticalXS}),rootHighContrast:Object(o.__assign)({},Me.a.border("1px","solid",Tc.neutralLighterAlt)),headerWrapper:{flexDirection:"row",alignItems:"center"},headerText:{fontWeight:Tc.fontWeightSemibold,marginLeft:Tc.spacingHorizontalSNudge,lineHeight:Tc.lineHeightBase300,whiteSpace:"pre-line"},descriptionText:{color:Tc.neutralQuaternaryAlt,fontSize:Tc.fontSizeBase300,lineHeight:Tc.lineHeightBase300,whiteSpace:"pre-line",marginTop:Tc.spacingVerticalS},tipCardIcon:{color:Tc.themePrimary},actionButtonWrapper:Object(o.__assign)(Object(o.__assign)({},Me.a.margin(0)),{marginTop:Tc.spacingVerticalS,color:Tc.neutralLight}),actionButton:Object(o.__assign)(Object(o.__assign)({float:"left",alignItems:"center",justifyContent:"center",width:"fit-content",height:Tc.spacingVerticalXXL,backgroundColor:Tc.themePrimary},Me.a.borderRadius(Tc.borderRadiusMedium)),{paddingRight:Tc.spacingHorizontalS,paddingLeft:Tc.spacingHorizontalS,paddingTop:"3px",paddingBottom:"5px",fontSize:Tc.fontSizeBase200,lineHeight:Tc.lineHeightBase200,color:Tc.neutralLight,":hover":Object(o.__assign)(Object(o.__assign)({backgroundColor:Tc.themeTertiary,color:Tc.neutralLight},Me.a.border("1px","solid",Tc.colorNeutralForegroundStaticInverted)),{":active":Object(o.__assign)({backgroundColor:Tc.themeDarker,color:Tc.neutralLight},Me.a.border("1px","solid",Tc.colorNeutralForegroundStaticInverted))})})},jc=Object(pe.a)(kc),Pc=ue.a.memo((function(e){var t=e.headerText,n=e.descriptionTextList,r=e.buttonTitle,o=e.onClick,i=e.overrideStyles,a=e.icon,s=f(),l=jc();!function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n]);e.rootHighContrast=Object(x.a)(e.root,e.rootHighContrast)}(l,i);var c;return ue.a.createElement(he,{style:s?l.rootHighContrast:l.root,customProperties:{role:L,"aria-labelledby":"tipCardHeaderText","aria-describedby":"tipCardDescriptionText"}},ue.a.createElement(he,{style:l.headerWrapper},a&&(c=a,ue.a.createElement(c,{className:l.tipCardIcon})),ue.a.createElement(ut.a,{id:"tipCardHeaderText",className:l.headerText},t)),ue.a.createElement(he,null,(null!=n?n:[]).map((function(e,t){return ue.a.createElement(ut.a,{key:t,id:"tipCardDescriptionText",className:l.descriptionText},e)}))),r&&o?ue.a.createElement("div",{className:l.actionButtonWrapper},ue.a.createElement(be.a,{appearance:"primary",className:l.actionButton,onClick:o,title:r},r)):null)})),Ac=Object(pe.a)({inputBanner:Object(o.__assign)(Object(o.__assign)({minHeight:"32px"},Me.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"})}),_c=function(e){var t=e.chatInputBannerString;return ue.a.createElement(Yn.a,{className:Ac().inputBanner},ue.a.createElement(Qn.a,null,t))};!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(ql||(ql={}));var Dc,Lc,Mc,Bc,Rc={fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system"},Fc=Object(E.a)(P),Nc=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Fc.neutralSecondaryAlt,alignItems:"flex-start"},pn.a.body1),{fontStyle:"normal"}),Me.a.gap("1px")),{content:"attr(title)"}),Hc={color:Fc.neutralQuaternary},Uc=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),Me.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(o.__assign)({},Me.a.outline(0))}),Vc={userInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Uc),{paddingRight:"2px",fontSize:"15px",lineHeight:"normal",fontFamily:"-apple-system",outlineStyle:"none"}),{"&:focus":Object(o.__assign)({},Me.a.outline(0)),"&:focus::after":Object(o.__assign)(Object(o.__assign)({},Nc),Rc),"&::after":Object(o.__assign)(Object(o.__assign)({},Nc),Rc)})},zc={userInput:{"&:focus::after":Hc,"&::after":Hc}},Gc=Object(pe.a)(Vc),Wc=Object(pe.a)(zc),Qc=ue.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,a=e.placeholderText,s=e.chatInputTabIndex,l=e.isDisabled,c=e.handleKeyDown,u=e.handleKeyUp,d=e.handleOnPaste,p=e.handleOnBeforeInput,g=e.handleOnInput,h=e.handleOnCompositionEnd,f=e.handleOnChatInputControlMount,m=e.handleOnChatInputControlUnmount,v=Object(ce.useRef)();Object(ce.useImperativeHandle)(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){b(e)},updateInputText:function(e,t){switch(t){case ql.InsertAtCursor:C(e);break;case ql.Replace:b(e)}},getInputText:function(){return y()},getInputSpanElement:function(){return v.current},setFocus:function(){O()},getGhostText:function(){var e,t;return null!==(t=null===(e=v.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;return null===(t=v.current)||void 0===t?void 0:t.setAttribute("title",e)}}}));var b=function(e){var t=v.current;t&&(t.innerText=e)},y=function(){var e=T,t=v.current;return t&&(e=t.innerText),e},C=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1)}},O=function(){if(!l){var e=v.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(ce.useEffect)((function(){return f&&f(),function(){m&&m()}}),[]);var S=Object(ce.useRef)(Gc()),E=Object(ce.useRef)(Wc()),I=Object(o.__read)(Object(ce.useState)(S.current.userInput),2),w=I[0],k=I[1];return Object(ce.useEffect)((function(){n&&k(Object(x.a)(S.current.userInput,n))}),[n]),Object(ce.useEffect)((function(){l&&k(Object(x.a)(S.current.userInput,E.current.userInput))}),[l]),ue.a.createElement("span",{ref:v,className:w,title:a,"aria-label":a,role:"textbox",tabIndex:s,contentEditable:!l,suppressContentEditableWarning:!l,onKeyDown:c,onKeyUp:u,onPaste:d,onBeforeInput:p,onCompositionEnd:h,onInput:g,spellCheck:!(i===r.MACOS)})})),qc=n(3444),Kc=Object(E.a)(P),Yc=Object(pe.a)({root:{backgroundColor:"transparent"}}),Zc=Object(pe.a)({root:Object(o.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:Kc.neutralTertiaryAlt,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},Me.a.padding("16px"))}),Jc=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px solid")),Me.a.borderColor("transparent")),Me.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),Xc=Object(pe.a)({root:{backgroundColor:Kc.themePrimary,color:Kc.neutralLight,"&:hover":{backgroundColor:"".concat(Kc.themePrimary," !important")}}}),$c=Object(pe.a)({root:{backgroundColor:Kc.neutralLight,color:Kc.black,"&:hover":Object(o.__assign)(Object(o.__assign)({},Me.a.borderColor("".concat(Kc.themePrimary))),{backgroundColor:"".concat(Kc.neutralLight," !important")})}}),eu=Object(pe.a)({root:{color:Kc.themePrimary,"&:hover":{color:Kc.themePrimary},fontSize:"12px"}}),tu=Object(pe.a)({root:{height:"63px",bottom:"12px"}}),nu=Object(pe.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),ru=Object(pe.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:Kc.neutralQuaternaryAlt,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),ou=Object(pe.a)({root:{fontWeight:"bold",color:Kc.black,fontSize:"12px",paddingBottom:"0px"}}),iu=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(x.a)(Jc().root,Xc().root),c=Object(x.a)(Jc().root,$c().root),u=ru().root,d=Object(x.a)(u,ou().root),p=eu().root,g=tu().root,h=Object(ce.useRef)(null);return Object(ce.useEffect)((function(){var e;t&&(null===(e=h.current)||void 0===e||e.focus())}),[t]),ue.a.createElement(le.a,{className:Yc().root},ue.a.createElement(tt.a,{modalType:"modal",open:t},ue.a.createElement(nt.a,{className:Zc().root,tabIndex:0},ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{className:d},n),ue.a.createElement(at.a,null,o&&ue.a.createElement(De.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),ue.a.createElement(ye.a,{className:u},r),i&&ue.a.createElement(on.a,{inline:!0,className:p,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},U()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),ue.a.createElement(Rn.a,{className:nu().root},ue.a.createElement(it.a,{disableButtonEnhancement:!0},ue.a.createElement(be.a,{ref:h,className:c,appearance:"secondary",onClick:s},U()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),ue.a.createElement(be.a,{className:l,appearance:"primary",onClick:a},U()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Dc||(Dc={}));var au=Object(E.a)(P),su=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:au.neutralLight,backgroundPositionX:"center",backgroundPositionY:"center"},Me.a.borderRadius("8px")),Me.a.borderColor(au.neutralLight)),(Lc={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},Lc["&:hover .".concat(gn.a.icon)]={color:au.themePrimary},Lc["&:hover:active .".concat(gn.a.icon)]={color:au.themePrimary},Lc.display="flow",Lc))}),lu=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:au.themePrimary,color:au.neutralLight},Me.a.borderRadius("50%")),(Mc={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(au.themeLight)},"60%":{boxShadow:"0 0 0 8px ".concat(au.themeLight)},"100%":{boxShadow:"0 0 0 0 ".concat(au.themeLight)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},Mc["&.".concat(gn.a.icon)]={color:au.neutralLight},Mc["&:hover .".concat(gn.a.icon)]={color:au.neutralLight},Mc["&:active .".concat(gn.a.icon)]={color:au.neutralLight},Mc["&:hover:active .".concat(gn.a.icon)]={color:au.neutralLight},Mc["&:hover"]={backgroundColor:au.themePrimary,color:au.neutralLight},Mc["&:hover:active"]={backgroundColor:au.themePrimary,color:au.neutralLight},Mc))}),cu=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:au.neutralTertiary},Me.a.borderColor(au.neutralTertiary)),(Bc={"&:hover":Object(o.__assign)({backgroundColor:au.neutralTertiary},Me.a.borderColor(au.neutralTertiary))},Bc["&:hover .".concat(gn.a.icon)]={color:au.neutralQuaternary},Bc["&:hover:active .".concat(gn.a.icon)]={color:"".concat(au.neutralQuaternary," !important")},Bc))}),uu=Object(pe.a)({root:{position:"relative",marginRight:"8px"}}),du=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:au.neutralTertiary},Me.a.borderRadius("50%")),{color:au.themePrimary}),loader:Object(o.__assign)(Object(o.__assign)({color:au.neutralLight},Me.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:au.themePrimary,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),pu=(Object(pe.a)({root:{color:au.neutralPrimary}}),Object(pe.a)({root:{color:au.themePrimary}}),Object(pe.a)({root:{color:au.neutralQuaternary}}),function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(ce.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(!1),2),l=s[0],c=s[1];Object(ce.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(m.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(ce.useEffect)((function(){t?g(h.current):n.isMicrophoneListening||g(u.current.root)}),[t]),Object(ce.useEffect)((function(){n.microphoneState===Dc.Loading?(a(!0),g(f.current)):(a(!1),n.microphoneState===Dc.Uninitialized&&g(u.current.root))}),[n.microphoneState]);var u=Object(ce.useRef)(su()),d=Object(o.__read)(Object(ce.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(ce.useRef)(Object(x.a)(u.current.root,cu().root)),f=Object(ce.useRef)(Object(x.a)(u.current.root,du().root)),m=Object(ce.useRef)(Object(x.a)(u.current.root,lu().root));return ue.a.createElement("div",{className:uu().root},ue.a.createElement(be.a,{className:p,title:n.title,"aria-label":n.title,role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?ue.a.createElement(qc.a,null):ue.a.createElement(qc.b,null),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t}),i&&ue.a.createElement("div",{className:du().loader}),ue.a.createElement(iu,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))});function gu(e){var t,n,r,o,i,a,s,l={chatInput:null!==(t=e.chatInput)&&void 0!==t?t:{},chatInputContainer:null!==(n=e.chatInputContainer)&&void 0!==n?n:{},userInput:null!==(r=e.userInput)&&void 0!==r?r:{},chatInputButtons:null!==(o=e.chatInputButtons)&&void 0!==o?o:{},chatInputLeftButtons:null!==(i=e.chatInputLeftButtons)&&void 0!==i?i:{},chatInputRightButtons:null!==(a=e.chatInputRightButtons)&&void 0!==a?a:{},contextualMenu:null!==(s=e.contextualMenu)&&void 0!==s?s:{}};return Object(pe.a)(l)}var hu,fu=Object(E.a)(P),mu=gu({chatInput:Object(o.__assign)({},Me.a.borderRadius(fu.borderRadiusXLarge)),contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.padding(0)),{maxWidth:"288px",backgroundColor:fu.neutralLight,boxShadow:fu.shadow16}),Me.a.borderRadius("12px"))}),vu=gu({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({left:"2",width:"97%",height:"4px"},Me.a.borderRadius(0,0,"12px","12px")),{backgroundImage:"linear-gradient(to right, ".concat(fu.themePrimary,", ").concat(fu.themeSecondary,")")})}}}),bu=Object(E.a)(P),yu={chatInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:bu.neutralPrimary,backgroundColor:bu.neutralLight},Me.a.border("1px","solid",bu.neutralLighterAlt)),Me.a.borderRadius(bu.borderRadiusXLarge)),Me.a.margin(0,"16px","16px","16px")),Me.a.padding("4px")),Me.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(o.__assign)({},Me.a.margin("12px","12px","4px","12px")),userInput:{},chatInputButtons:Object(o.__assign)(Object(o.__assign)({backgroundColor:bu.neutralLight,width:"100%",flexDirection:"row",flexWrap:"wrap"},Me.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{alignSelf:"flex-end",display:"flex"},contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},Me.a.padding("6px")),{backgroundColor:bu.neutralLight,boxShadow:bu.shadow4}),Me.a.borderRadius("8px"))},Cu=Object(pe.a)(yu),Ou=Object(pe.a)({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},Me.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(bu.themePrimary,", ").concat(bu.themeSecondary,")")})}}}),Su=Object(pe.a)({chatInputRightButtons:{display:"contents"}}),Eu=Object(pe.a)({chatInput:{backgroundColor:bu.neutralTertiary},chatInputButtons:{backgroundColor:bu.neutralTertiary}}),xu=Object(E.a)(P),Iu=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({width:"40px",height:"40px",maxWidth:"unset",backgroundColor:"transparent"},Me.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent"))})}),wu=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent")),{"&:hover":Object(o.__assign)({backgroundColor:"transparent"},Me.a.borderColor("transparent"))})}),Tu=Object(pe.a)({root:{color:xu.themePrimary}}),ku=Object(E.a)(P),ju=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:ku.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},Me.a.borderColor(ku.neutralLight)),Me.a.borderRadius(ku.borderRadiusXLarge)),{marginRight:"2px",width:"32px",height:"32px","&:hover":{backgroundColor:ku.neutralTertiaryAlt}})}),Pu=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:ku.neutralTertiary},Me.a.borderColor(ku.neutralTertiary)),{"&:hover":Object(o.__assign)({backgroundColor:ku.neutralTertiary},Me.a.borderColor(ku.neutralTertiary))})}),Au=Object(pe.a)({root:{color:ku.neutralPrimary}}),_u=Object(pe.a)({root:{color:ku.themePrimary}}),Du=Object(pe.a)({root:{color:ku.neutralQuaternary}}),Lu=function(e){var t=e.title,n=e.isDisabled,i=e.handleClick,l=e.isInputEmpty,c=Object(o.__read)(ue.a.useState(!1),2),u=c[0],d=c[1],p=Object(ce.useRef)(function(){var e=ju(),t=Iu();a()===r.IOS&&W(e,t);return e}()),g=Object(ce.useRef)(Object(x.a)(p.current.root,function(){var e=Pu(),t=wu();a()===r.IOS&&W(e,t);return e}().root)),h=Object(ce.useRef)(Au()),f=Object(ce.useRef)(_u().root),m=Object(ce.useRef)(Du().root),v=Object(ce.useRef)(function(){var e={root:""},t=Tu();a()===r.IOS&&W(e,t);return e}().root),b=Object(o.__read)(Object(ce.useState)(p.current.root),2),y=b[0],C=b[1],O=Object(o.__read)(Object(ce.useState)(h.current.root),2),S=O[0],E=O[1];Object(ce.useEffect)((function(){n?(C(g.current),E(m.current)):(E(u?f.current:l?h.current.root:v.current),C(p.current.root))}),[n,u,l]);var I,w,T,k=s()?Mt.f:Mt.h,j=s()?Mt.e:Mt.g;return ue.a.createElement(be.a,{className:y,title:t,"aria-label":t,role:"button",onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},icon:{className:S,children:(I=k,w=j,T=Object(Ee.a)(w,I),ue.a.createElement(T,null))},onClick:i,disabled:n})},Mu=ue.a.forwardRef((function(e,t){var n,i=e.isDisabled,l=e.overrideStyles,c=e.chatInputTabIndex,u=void 0===c?0:c,d=e.chatInputContainerTabIndex,p=void 0===d?-1:d,g=e.chatInputContainerTitle,h=void 0===g?U()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area":g,f=e.placeholderText,m=void 0===f?U()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own":f,v=e.maxInputCharLimit,b=void 0===v?300:v,y=e.handleKeyDown,C=e.handleKeyUp,O=e.handleOnPaste,S=e.handleOnBeforeInput,E=e.handleOnInput,I=e.submitButtonTitle,k=void 0===I?U()?OfficeaicopilotStrings.SubmitButtonTitle:"Send":I,j=e.handleSubmitButtonClick,P=e.isMenuButtonEnabled,A=void 0!==P&&P,_=e.shouldOpenMenuOnEmptyInput,D=void 0!==_&&_,L=e.menuButtonTitle,M=void 0===L?w():L,B=e.handleMenuButtonClick,R=e.handleOnOpenMenu,F=e.handleOnChatInputControlMount,N=e.handleOnChatInputControlUnmount,H=e.handleOnBlur,V=e.menuProps,z=e.microphoneProps,G=e.chatInputBannerProps,Q=e.submitButtonFactory,q=Object(ce.useRef)(),K=Object(ce.useRef)(),Y=Object(ce.useRef)(null);z&&!z.title&&(z.title=U()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone"),Object(ce.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=q.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=q.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getImages()},setInputText:function(e){var t;null===(t=q.current)||void 0===t||t.setInputText(e),s()&&te(0==e.length)},updateInputText:function(e,t){var n;null===(n=q.current)||void 0===n||n.updateInputText(e,t)},getInputText:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){re(e)},getGhostText:function(){return ne()},setFocus:function(){var e;null===(e=q.current)||void 0===e||e.setFocus()},closeMenu:function(){A&&J&&X(!1)}}}));var Z=Object(o.__read)(Object(ce.useState)(!1),2),J=Z[0],X=Z[1],$=Object(o.__read)(Object(ce.useState)(!0),2),ee=$[0],te=$[1],ne=function(){var e;return null===(e=q.current)||void 0===e?void 0:e.getGhostText()},re=Object(ce.useCallback)((function(e){var t;null===(t=q.current)||void 0===t||t.setGhostText(e)}),[]),oe=!1,ie=!1,ae=function(e){var t,n;e.stopPropagation();var r=null===(t=q.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==T&&(j(r),null===(n=q.current)||void 0===n||n.setInputText(T),re(m))};Object(ce.useEffect)((function(){re(m)}),[m,re]),ue.a.useEffect((function(){var e;K.current&&(null===(e=Y.current)||void 0===e||e.setTarget(K.current))}),[Y,K]);var se=function(){var e=Cu(),t=mu();a()===r.IOS&&W(e,t);return e}(),le=function(){var e=Ou(),t=vu();a()===r.IOS&&W(e,t);return e}(),de=Eu(),pe=Su(),ge=Object(ce.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),fe=Object(ce.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),me=Object(ce.useRef)({chatInput:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),ve=Object(o.__read)(Object(ce.useState)(se),2),be=ve[0],ye=ve[1];Object(ce.useEffect)((function(){for(var e in se)ge.current[e]=Object(x.a)(se[e],le[e]);for(var e in se)fe.current[e]=Object(x.a)(se[e],de[e]);for(var e in se)me.current[e]=Object(x.a)(le[e],se[e],pe[e])}),[]),Object(ce.useEffect)((function(){if(l)for(var e in se)ge.current[e]=Object(x.a)(se[e],l[e])}),[l]),Object(ce.useEffect)((function(){ye(i?fe.current:ge.current)}),[i,l]),Object(ce.useEffect)((function(){(null==z?void 0:z.isMicrophoneListening)?ye(me.current):ye(ge.current)}),[null==z?void 0:z.isMicrophoneListening]);return ue.a.createElement("div",null,ue.a.createElement("div",{id:"copilot-chat-input",className:be.chatInput,title:h,tabIndex:p,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return i||document.activeElement===(null===(e=q.current)||void 0===e?void 0:e.getInputSpanElement())?[2]:D&&A&&(null===(t=q.current)||void 0===t?void 0:t.getInputText())==T&&!J?R?[4,R()]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return X(!0),[3,4];case 3:J&&X(!1),r.label=4;case 4:return null===(n=q.current)||void 0===n||n.setFocus(),[2]}}))}))},onBlur:function(){var e;s()&&!J&&(null===(e=q.current)||void 0===e?void 0:e.getInputText())===T&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return H(),[2]}))}))}),100)},ref:K},G&&ue.a.createElement(_c,Object(o.__assign)({},G)),ue.a.createElement("div",{className:be.chatInputContainer},ue.a.createElement(Qc,{ref:q,styleOverrideClassName:l?l.userInput:"",placeholderText:m,chatInputTabIndex:u,isDisabled:i,handleKeyDown:function(e){var t,n,r;oe="Process"===e.key,e.nativeEvent.isComposing||(ie&&"Enter"===e.key?ie=!1:y&&!y(e)||(s()&&("Backspace"===e.key?te((null===(t=q.current)||void 0===t?void 0:t.getInputText().length)<=1):te(!1)),"Enter"===e.key&&(e.preventDefault(),j(null===(n=q.current)||void 0===n?void 0:n.getInputText()),null===(r=q.current)||void 0===r||r.setInputText(T),re(m))))},handleKeyUp:function(e){var t;C&&!C(e)||((null===(t=q.current)||void 0===t?void 0:t.getInputText())===T?re(m):ne()===m&&re(T))},handleOnPaste:function(e){var t;if(!O||O(e)){re(T),e.preventDefault();var n=e.clipboardData.getData("Text"),r=n.length||0,o=null===(t=q.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(i.rangeCount){var a=i.toString(),s=o.length-a.length,l=n.substring(0,b-s);i.deleteFromDocument(),s+r>=b?i.getRangeAt(0).insertNode(document.createTextNode(l)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()}}},handleOnBeforeInput:function(e){S&&!S(e)||(X(!1),re(T))},handleOnInput:function(e){!E||E(e)},handleOnCompositionEnd:function(){oe||(ie=!0)},handleOnChatInputControlMount:F,handleOnChatInputControlUnmount:N}),ue.a.createElement("span",{"aria-hidden":!0},"‍")),ue.a.createElement(he,{style:be.chatInputButtons},ue.a.createElement("div",{className:be.chatInputLeftButtons},A&&ue.a.createElement(Ic,{title:M,isDisabled:i||0===(null===(n=null==V?void 0:V.sections)||void 0===n?void 0:n.length),isMenuOpen:J,setMenuOpen:X,handleClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return B&&B(),J?(X(!1),[3,4]):[3,1];case 1:return R?[4,R()]:[3,3];case 2:e.sent(),e.label=3;case 3:X(!0),e.label=4;case 4:return[2]}}))}))},positioningRef:Y,menuProps:V})),ue.a.createElement("div",{className:be.chatInputRightButtons},z&&ue.a.createElement("span",{title:function(){switch(z.microphoneState){case Dc.Enabled:return z.isMicrophoneListening?U()?OfficeaicopilotStrings.MicrophoneListeningStatus:"Microphone Listening":U()?OfficeaicopilotStrings.MicrophonePausedStatus:"Microphone Paused";case Dc.Disabled:return U()?OfficeaicopilotStrings.MicrophoneDisabledStatus:"Microphone Disabled";case Dc.Loading:return U()?OfficeaicopilotStrings.MicrophoneLoadingStatus:"Microphone Loading"}}()},ue.a.createElement(pu,{"aria-live":"assertive",isDisabled:i,microphoneButtonProps:z})),Q?Q({handleClick:ae,isDisabled:i,isInputEmpty:ee,title:k}):ue.a.createElement(Lu,{title:k,isDisabled:i,handleClick:ae,isInputEmpty:ee})))))})),Bu=ue.a.memo(Mu),Ru=n(2803),Fu="/";!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(hu||(hu={}));var Nu,Hu,Uu=n(478),Vu=n(3446),zu=n(1595),Gu=n(2073),Wu=n(183),Qu="".concat(Object(Vu.a)({environment:"Prod"})).concat(zu.a),qu=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-nudge","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-oa-email-ecc","mc-editor-enable-meeting-banner","mc-editor-expanded-ecc-responsive","mc-editor-oa-debug"],Ku=function(){function e(){this.staticSettings={isAggregatedLoggingEnabled:!0,controlIconSetName:"FabricMDL2Icons",showOptionsButton:!0,synonymsEndPoint:Gu.b.Prod,licenseType:Wu.b.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:4,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,oaSettings:{isContextualCardEnabled:!0,disableInlineSuggestionTooltips:!0,mockResults:!1,e2eMetric:!0,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:!0,bestMatchConfig:{enabled:!0,maxResults:Yu}}},this.getFlightsToTrack=function(e,t,n){var r=Object(o.__spreadArray)([],Object(o.__read)(qu),!1);return(null==n?void 0:n.length)>0&&(r=r.concat.apply(r,Object(o.__spreadArray)([],Object(o.__read)(n),!1))),(null==t?void 0:t.enableChatCIQ)&&r.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&r.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&r.push("vivatopics"),e&&r.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&r.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&r.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableMeetingBanner)&&r.push("mc-editor-enable-meeting-banner"),(null==t?void 0:t.enableSearchBar)&&(r.push("mc-editor-enable-searchbar"),r.push("mc-editor-attachbutton-searchbar-position")),r}}return e.prototype.composeSettings=function(e,t){var n,r,o,i,a,s=Object.assign({},this.staticSettings.oaSettings,{enableOaClient:null===(n=e.featureFlags)||void 0===n?void 0:n.enableHybridWorkflow,customizedEmptyECCSuggestionsString:e.customizedEmptyECCSuggestionsString,updateResultsTimeout:e.resultTime?e.resultTime:6e3,entitiesEnabled:t,scopesConfig:e.enableAutomaticScoping?{enabled:!0,maxResults:Yu,enableAutomaticScoping:!0}:{enabled:!0,maxResults:Yu,enableAutomaticScoping:!1}});return Object.assign({},this.staticSettings,{appId:e.hostAppId,flightsToTrack:this.getFlightsToTrack(!!(null===(r=e.featureFlags)||void 0===r?void 0:r.enableHybridWorkflow),e.featureFlags,e.flightsToTrack),defaultLocale:e.hostDefaultLocale,editorEndPoint:e.isDogfoodEnvironment?Gu.a.Lab:Gu.a.Prod,hostMetadata:{appName:e.hostAppName,appPlatform:e.hostAppPlatform,appScenario:e.hostAppScenario,sessionId:e.sessionId,releaseAudienceGroup:e.isDogfoodEnvironment?"Dogfood":"Production"},orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:null!==(o=e.augloopEndPoint)&&void 0!==o?o:"https://augloop-dogfood.officeppe.com",augLoopAuthTokenCallback:e.augLoopAuthTokenCallback,substrateAuthTokenCallback:e.substrateAuthTokenCallback},oaSettings:s,serviceSettings:{hybridAugloop:{enabled:!!(null===(i=e.featureFlags)||void 0===i?void 0:i.enableHybridWorkflow),enableGraphSearchLocal:!!(null===(a=e.featureFlags)||void 0===a?void 0:a.enableHybridWorkflow),wasmConfig:{binaryPath:Qu,scriptPath:Qu}}},isDarkMode:e.isDarkMode})},e}(),Yu=15;function Zu(e,t){var n=new Ku,r=function(e){var t=[];return e.forEach((function(n){t.push({enabled:!0,entityType:n,maxResults:1===e.length?void 0:Yu})})),t}(t);return n.composeSettings(e,r)}!function(e){e.ChatECCInjectionError="Chat_ECC_Injection_Error",e.CIQForcedInvokeException="CIQ_Forced_Invoke_Exception",e.CIQThemeUpdateException="CIQ_Theme_Update_Exception",e.EditorBootstrapException="Editor_Bootstrap_Exception",e.EditorShutdownException="Editor_Shutdown_Exception",e.EmailECCInjectionError="Email_ECC_Injection_Error",e.EventECCInjectionError="Event_ECC_Injection_Error",e.FileECCInjectionError="File_ECC_Injection_Error",e.PeopleECCInjectionError="People_ECC_Injection_Error",e.UnsupportedSuggestionTypeError="Unsupported_Suggestion_Type_Error"}(Nu||(Nu={})),function(e){e.EditorShutdownSuccess="Editor_Shutdown_Success",e.EditorCIQForceInvoke="Editor_CIQ_Force_Invoke",e.EditorCIQThemeUpdate="Editor_CIQ_Theme_Update",e.EditorBootstrapSuccess="Editor_Bootstrap_Success"}(Hu||(Hu={}));var Ju=!1;var Xu=function(e,t){Ju&&(null==t?console.log("Chat Editor log:",e):console.log("Chat Editor log:",e,t))};function $u(e){var t=null==e?void 0:e.message;return void 0!==t?t:""}var ed=void 0;function td(e){ed&&(ed.logError(e),Xu(e))}function nd(e,t){ed&&ed.logErrorTelemetry&&ed.logErrorTelemetry(e,t)}function rd(e,t){ed&&ed.logSuccessTelemetry&&ed.logSuccessTelemetry(e,t)}var od,id=n(2077),ad=n(2076),sd=n(107),ld=n.n(sd);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(od||(od={}));var cd=od.web;function ud(){return cd===od.IOS}var dd,pd,gd;!function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(dd||(dd={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(pd||(pd={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(gd||(gd={}));var hd=Object(pe.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),fd=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(x.a)(o,t)),n?o=r?Object(x.a)(o,e.horizontalReverse):Object(x.a)(o,e.horizontal):r&&(o=Object(x.a)(o,e.verticalReverse)),o}(hd(),n,i,s);return ce.createElement("div",Object(o.__assign)({className:c},l),t)},md=Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),vd=(Object(o.__assign)(Object(o.__assign)({},j.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),function(e){var t,n,r,o;return{tooltipText:null!==(t=e.tooltipText)&&void 0!==t?t:{},badgeText:null!==(n=e.badgeText)&&void 0!==n?n:{},tooltipStack:null!==(r=e.tooltipStack)&&void 0!==r?r:{},icon:null!==(o=e.icon)&&void 0!==o?o:{}}});function bd(e){var t=vd(e);return Object(pe.a)(t)}var yd=bd({tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}}),Cd=Object(E.a)(md),Od=bd({tooltipText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1),{color:Cd.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"}),badgeText:Object(o.__assign)(Object(o.__assign)({},pn.a.caption1Stronger),{wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"}),tooltipStack:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px"},Me.a.padding("12px")),Me.a.gap("12px")),icon:{display:"grid",justifyItems:"center",alignItems:"center"}}),Sd=function(){var e=Od(),t=yd();if(cd===od.IOS)Ed(e,t);return e},Ed=function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n])},xd=function(e){switch(void 0===e&&(e=gd.NonEncryption),e){case gd.Encryption:return ud()?ue.a.createElement(Mt.q,null):ue.a.createElement(Mt.o,null);case gd.Warning:return ud()?ue.a.createElement(hi.e,null):ue.a.createElement(hi.c,null);case gd.NonEncryption:default:return ud()?ue.a.createElement(Mt.m,null):ue.a.createElement(Mt.k,null)}},Id=function(e,t){switch(void 0===e&&(e=gd.NonEncryption),e){case gd.Encryption:return ud()?ue.a.createElement(Mt.p,{primaryFill:t}):ue.a.createElement(Mt.n,{primaryFill:t});case gd.Warning:return ud()?ue.a.createElement(hi.d,{primaryFill:t}):ue.a.createElement(hi.b,{primaryFill:t});case gd.NonEncryption:default:return ud()?ue.a.createElement(Mt.l,{primaryFill:t}):ue.a.createElement(Mt.j,{primaryFill:t})}},wd=function(e){var t,n,r=e.styles,o=e.clpSensitivityIndicatorData,i=Sd();return Ed(i,r),ue.a.createElement($o.a,{openOnHover:!0},ue.a.createElement(ei.a,null,ue.a.createElement("span",{className:i.icon},o.icon?ue.a.createElement(o.icon,null):(t=o.iconType,n=o.color,void 0===t&&(t=gd.NonEncryption),n?Id(t,n):xd(t)))),ue.a.createElement(ti.a,{className:i.tooltipStack},ue.a.createElement(fd,null,o.badgeText&&ue.a.createElement(nr.a,{className:i.badgeText},o.badgeText),ue.a.createElement(nr.a,{className:i.tooltipText},o.tooltipText))))},Td=n(3343),kd=n(2421),jd=n(1618),Pd=n(3344),Ad=n(841),_d=Object(Ad.a)({palette:Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),Dd=(Object(Ad.a)({palette:Object(o.__assign)(Object(o.__assign)({},j.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(e){var t=e.themePalette,n=e.isDarkMode,r=e.children,i=e.className,a=Object(o.__assign)(Object(o.__assign)({},_d.palette),t),s=Object(Pd.a)(a),l=n?Object(kd.a)(s):Object(jd.a)(s);return ce.createElement(le.a,{className:i,theme:l},r)}),Ld=Object(pe.a)({ciqInputText:{color:Be.a.colorBrandForeground1}}),Md=ue.a.forwardRef((function(e,t){var n=e.text,r=e.id,i=e.copilotChatTheme,a=e.isDarkModeEnabled,s=Object(o.__read)(Object(ce.useState)(e.isLoading),2),l=s[0],c=s[1],u=Object(o.__read)(Object(ce.useState)(e.clpSensitivityIndicatorData),2),d=u[0],p=u[1],g=Ld();return Object(ce.useImperativeHandle)(t,(function(){return{setLoading:function(e){c(e)},setSensitivity:function(e){p(e)}}})),ue.a.createElement("span",{contentEditable:!1,className:"user-ciq-selection-id",id:r,style:{display:"inline"}},ue.a.createElement("span",{className:g.ciqInputText},n),ue.a.createElement("span",{style:{display:"inline-block",verticalAlign:"text-bottom"}},l?ue.a.createElement(Td.a,{size:"extra-tiny"}):ue.a.createElement(Dd,{themePalette:i,isDarkMode:a},d&&ue.a.createElement(wd,{clpSensitivityIndicatorData:d}))))})),Bd=function(){function e(){this.ciqId=0,this.ciqUrls=new Map,this.isHVCAppChatV2Enabled=!1,this.queryAnnotationSet=new Map}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,i,a){if(e.suggestion&&e.queryRange){++this.ciqId;var s="userCIQSelectionId-"+this.ciqId;this.ciqUrls.set(s,e.suggestion.url),this.queryAnnotationSet.set(s,e.suggestion.queryAnnotation);var l={text:e.suggestion.text,id:s,clpSensitivityIndicatorData:t,isLoading:n,copilotChatTheme:r,isDarkModeEnabled:i},c=ue.a.createElement(Md,Object(o.__assign)(Object(o.__assign)({},l),{ref:a}),null),u=document.createElement("span");if(ld.a.render(c,u),e.queryRange.endContainer){var d=e.queryRange.endContainer.textContent;d&&" "===d.charAt(d.length-1)&&(e.queryRange.endContainer.textContent=d.slice(0,-1),e.queryRange.setEndAfter(e.queryRange.endContainer),e.queryRange.collapse(!1))}e.queryRange.insertNode(u),u.insertAdjacentText("beforebegin"," "),e.queryRange.collapse(!1);var p=document.createTextNode(" ");e.queryRange.insertNode(p),e.queryRange.setEndAfter(p),e.queryRange.collapse(!1);var g=window.getSelection();null==g||g.removeAllRanges(),null==g||g.addRange(e.queryRange),Xu("renderAndTrackSelectedSuggestion: rendered suggestion")}else Xu("renderAndTrackSelectedSuggestion: nothing to render")},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n;if(this.ciqUrls.size<=0)Xu("generatCopilotOdslSignalLinks: nothing to generate");else{var r=Object(o.__spreadArray)([],Object(o.__read)(this.ciqUrls.keys()),!1);try{for(var i=Object(o.__values)(r),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.ciqUrls.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.ciqUrls.size<=0)){for(var l=[],c=0,u=e.childNodes,d=0;d<u.length;d++){var p=u[d];if(p.nodeType===Node.ELEMENT_NODE){var g=p.childNodes[0];if(g&&g.className.includes("user-ciq-selection-id")&&g.id){var h=g.textContent.length;this.ciqUrls.has(g.id)&&l.push({type:ad.a.URL,range:[c,c+h],value:this.ciqUrls.get(g.id)}),c+=h}else"BR"===p.nodeName?c++:this.isHVCAppChatV2Enabled&&"SPAN"===p.nodeName&&(c+=p.textContent.length)}else(""!=p.textContent.trim()||c>0)&&(c+=p.textContent.length)}return Xu("generatCopilotOdslSignalLinks: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.value,", range: [").concat(t.range[0],", ").concat(t.range[1],"]")}),""))),l}Xu("generatCopilotOdslSignalLinks: nothing to generate after cleanup")}},e.prototype.generateQueryAnnotations=function(e){var t,n;if(this.queryAnnotationSet.size<=0)Xu("generateQueryAnnotations: nothing to generate");else{var r=Object(o.__spreadArray)([],Object(o.__read)(this.queryAnnotationSet.keys()),!1);try{for(var i=Object(o.__values)(r),a=i.next();!a.done;a=i.next()){var s=a.value;e.querySelector("span#".concat(s))||this.queryAnnotationSet.delete(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}if(!(this.queryAnnotationSet.size<=0)){for(var l=[],c=e.childNodes,u=0;u<c.length;u++){var d=c[u];if(d.nodeType===Node.ELEMENT_NODE){var p=d.childNodes[0];p&&p.className.includes("user-ciq-selection-id")&&p.id&&this.queryAnnotationSet.has(p.id)&&l.push(this.queryAnnotationSet.get(p.id))}}return Xu("generateQueryAnnotations: ".concat(l.reduce((function(e,t){return e+"URL: ".concat(t.id,", text: ").concat(t.text)}),""))),l}Xu("generateQueryAnnotations: nothing to generate after cleanup")}},e.prototype.setHVCAppChatV2Enabled=function(e){this.isHVCAppChatV2Enabled=e},e}(),Rd={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}},Fd={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Nd=n(2074),Hd=n(2075);function Ud(e){var t,n,r,o,i,a,s;switch(e.type){case Nd.a.File:return i=(u=e).FileName,o=null!==(t=u.SpoId)&&void 0!==t?t:u.AccessUrl,"DownloadableUrl"===u.AccessUrlType&&(a=u.AccessUrl),a||"DownloadableUrl"!==u.AlternateAccessUrlType||(a=u.AlternateAccessUrl),a||(a=u.AccessUrl)||(a=u.AlternateAccessUrl),a?(s={QueryAnnotationType:Hd.a.File,text:i,id:o},{type:Nd.a.File,id:o,text:i,url:a,queryAnnotation:s}):(td("File ECC injection failed due to missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)),void nd(Nu.FileECCInjectionError,"Missing AccessUrl of type ".concat(u.AccessUrlType," and missing AlternateAccessUrl of type ").concat(u.AlternateAccessUrlType)));case Nd.a.People:return(null==(u=e)?void 0:u.EmailAddresses)&&u.DisplayName?(i=u.DisplayName,o=u.EmailAddresses[0],a=u.EmailAddresses[0]?"mailto:".concat(u.EmailAddresses[0]):"",s={QueryAnnotationType:Hd.a.People,text:i,id:o},{type:Nd.a.People,id:o,text:i,url:a,queryAnnotation:s}):(td("People ECC injection failed due to missing EmailAddresses or DisplayName"),void nd(Nu.PeopleECCInjectionError,"Missing EmailAddresses or DisplayName"));case Nd.a.Chat:if(!(null==(u=e)?void 0:u.ThreadId))return td("Chat ECC injection failed due to missing ThreadId"),void nd(Nu.ChatECCInjectionError,"Missing ThreadId");if(void 0!==u.Name)i=u.Name;else if(u.ChatMembers){var l=u.ChatMembers.length-2,c=u.ChatMembers.slice(0,2).map((function(e){return e.DisplayName})).join(", ");l>0&&(c+=", +".concat(l)),i=c}else i="";return o=u.ThreadId,a="",s={QueryAnnotationType:Hd.a.Chat,text:i,id:o},{type:Nd.a.Chat,id:o,text:i,url:a,queryAnnotation:s};case Nd.a.Message:return(null==(u=e)?void 0:u.ImmutableId)?(i=u.Subject,o=null===(n=u.ImmutableId)||void 0===n?void 0:n.Id,a="",s={QueryAnnotationType:Hd.a.Message,text:i,id:o},{type:Nd.a.Message,id:o,text:i,url:a,queryAnnotation:s}):(td("Email ECC injection failed due to missing ImmutableId"),void nd(Nu.EmailECCInjectionError,"Missing ImmutableId"));case Nd.a.Event:var u;return(null==(u=e)?void 0:u.OriginalId)?(i=u.Subject,o=u.OriginalId,a=null!==(r=u.WebLink)&&void 0!==r?r:"",s={QueryAnnotationType:Hd.a.Event,text:i,id:o},{type:Nd.a.Event,id:o,text:i,url:a,queryAnnotation:s}):(td("Event ECC injection failed due to missing OriginalId"),void nd(Nu.EventECCInjectionError,"Missing OriginalId"));default:return td("onItemSelected called with unsupported suggestion type ".concat(e.type)),void nd(Nu.UnsupportedSuggestionTypeError,"onItemSelected called with unsupported suggestion type ".concat(e.type))}}var Vd,zd=function(){function e(e){this.editorProofingNode=void 0,this.editorClient=e}return e.prototype.shutdown=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),Xu("Shutting down Editor"),[4,this.editorClient.shutDown()];case 1:return t.sent(),Xu("Shutting down Editor completed successfully"),rd(Hu.EditorShutdownSuccess),[3,3];case 2:return e=t.sent(),td("Exception shutting down Editor:"+JSON.stringify(e)+" Error message: "+$u(e)),nd(Nu.EditorShutdownException," Error message: "+$u(e)),[3,3];case 3:return this.editorClient=null,[2]}}))}))},e.prototype.initializeCiq=function(e,t){var n=this;return this.editorProofingNode&&this.uninitialize(t.queryCharToUse),Xu("Initializing Editor for CIQ"),this.editorProofingNode=this.editorClient.spellCheck(e,".ignore-block"),this.editorClient.enableInlineSuggestionsMenu(t.entitiesEnabled,t.queryCharToUse,(function(e,n,r){Xu("Suggestion selected from CIQ: "+JSON.stringify(e)+" in range: "+JSON.stringify(n)),t.onItemSelected({suggestion:Ud(e),queryRange:n,parentHtmlElement:r})}),void 0,void 0,{fitToContent:!0},t.ExpanededECC?Fd:Rd,void 0,void 0,void 0,void 0,t.ExpanededECC?void 0:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){var n,r,i,a,s;return Object(o.__generator)(this,(function(l){Xu("".concat(null==e?void 0:e.length," suggestions found")),t.onSuggestionsUpdated&&t.onSuggestionsUpdated(e.length);try{for(n=Object(o.__values)(e),r=n.next();!r.done;r=n.next())(i=r.value).groupTitle=t.menuTitle,i.groupSubtitle=t.menuSubtitle}catch(e){a={error:e}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,e]}))}))},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.ExpanededECC),new Bd},e.prototype.uninitialize=function(e){this.editorProofingNode&&(Xu("Uninitializing Editor"),this.editorClient.disableInlineSuggestionsMenu(e),this.editorClient.detach(this.editorProofingNode),this.editorProofingNode=void 0)},e.prototype.forceInvokeCIQMenu=function(e,t){if(this.editorProofingNode)try{Xu("Starting to show CIQ for force invoke"),t&&this.setCurrentScope(t),this.editorClient.showExistingMenuAtCursor(1,e,!0),Xu("Showing CIQ for force invoke"),rd(Hu.EditorCIQForceInvoke)}catch(e){td("Exception showing CIQ for forced invoke:"+JSON.stringify(e)+" Error message: "+$u(e)),nd(Nu.CIQForcedInvokeException," Error message: "+$u(e))}},e.prototype.updateCurrentTheme=function(e){try{switch(Xu("Starting to update theme for CIQ to ".concat(e)),e){case hu.light:case hu.dark:case hu.highContrast:case hu.custom:this.editorClient.updateCurrentTheme(e);break;default:throw"Unexpected themeType: ".concat(e)}Xu("Theme updated for CIQ"),rd(Hu.EditorCIQThemeUpdate)}catch(e){td("Exception updating theme for CIQ:"+JSON.stringify(e)+" Error message: "+$u(e)),nd(Nu.CIQThemeUpdateException," Error message: "+$u(e))}},e.prototype.normalizeCIQEntity=function(e){switch(!0){case/file/i.test(e):return id.a.File;case/(people)|(person)/i.test(e):return id.a.People;case/(event)|(meeting)/i.test(e):return id.a.Event;case/chat/i.test(e):return id.a.Chat;case/(message)|(email)/i.test(e):return id.a.Message;case/(topic)/i.test(e):return id.a.Topic;default:return}},e.prototype.setCurrentScope=function(e){if(this.editorClient){var t=this.normalizeCIQEntity(e);if(void 0!==t){var n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}else Xu("Invoked setEntityScope with unsupported entity type ".concat(e))}},e}(),Gd=function(){function e(){}return e.prototype.bootstrap=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:i=e.settings.isDogfoodEnvironment,Ju=i,o=e.telemLogger,ed=o,Xu("bootstrapEditor called"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,Object(Uu.a)(Zu(e.settings,e.entitiesSupported),e.telemSink,e.augloopSession)];case 2:return[4,(t=r.sent()).initializeSDK()];case 3:return r.sent(),[4,t.initializeUX(document)];case 4:return r.sent(),this.chatEditor=new zd(t),Xu("bootstrapEditor completed successfully"),rd(Hu.EditorBootstrapSuccess),[3,6];case 5:throw n=r.sent(),td("Exception bootstrapping Editor:"+JSON.stringify(n)+" Error message: "+$u(n)),nd(Nu.EditorBootstrapException," Error message: "+$u(n)),n;case 6:return[2,this.chatEditor]}var o,i}))}))},e.prototype.shutdown=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,this.chatEditor.shutdown()]}))}))},e}(),Wd=function(){function e(){}return e.prototype.createInstance=function(){return new Gd},e}(),Qd=n(573),qd=function(e){return ue.a.createElement("svg",{className:e,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.a.createElement("g",{clipPath:"url(#clip0_741_74312)"},ue.a.createElement("path",{d:"M10 18.4961C9.21875 18.4961 8.4668 18.3952 7.74414 18.1934C7.02148 17.9915 6.3444 17.7051 5.71289 17.334C5.08138 16.9629 4.50846 16.5202 3.99414 16.0059C3.47982 15.4915 3.03711 14.9186 2.66602 14.2871C2.29492 13.6556 2.00846 12.9785 1.80664 12.2559C1.60482 11.5332 1.50391 10.7812 1.50391 10C1.50391 9.21875 1.60482 8.4668 1.80664 7.74414C2.00846 7.02148 2.29492 6.3444 2.66602 5.71289C3.03711 5.08138 3.47982 4.50846 3.99414 3.99414C4.50846 3.47982 5.08138 3.03711 5.71289 2.66602C6.3444 2.29492 7.02148 2.00846 7.74414 1.80664C8.4668 1.60482 9.21875 1.50391 10 1.50391C10.7812 1.50391 11.5332 1.60482 12.2559 1.80664C12.9785 2.00846 13.6556 2.29492 14.2871 2.66602C14.9186 3.03711 15.4915 3.47982 16.0059 3.99414C16.5202 4.50846 16.9629 5.08138 17.334 5.71289C17.7051 6.3444 17.9915 7.02148 18.1934 7.74414C18.3952 8.4668 18.4961 9.21875 18.4961 10C18.4961 10.7812 18.3952 11.5332 18.1934 12.2559C17.9915 12.9785 17.7051 13.6556 17.334 14.2871C16.9629 14.9186 16.5202 15.4915 16.0059 16.0059C15.4915 16.5202 14.9186 16.9629 14.2871 17.334C13.6556 17.7051 12.9785 17.9915 12.2559 18.1934C11.5332 18.3952 10.7812 18.4961 10 18.4961Z",fill:"#FAFAFA"}),ue.a.createElement("path",{d:"M19.0039 10C19.0039 10.8268 18.8965 11.6243 18.6816 12.3926C18.4668 13.1543 18.1641 13.8704 17.7734 14.541C17.3828 15.2051 16.9141 15.8105 16.3672 16.3574C15.8203 16.9043 15.2148 17.3763 14.5508 17.7734C13.8802 18.1641 13.1641 18.4668 12.4023 18.6816C11.6341 18.8965 10.8366 19.0039 10.0098 19.0039C9.18294 19.0039 8.38542 18.8965 7.61719 18.6816C6.84896 18.4668 6.13281 18.1641 5.46875 17.7734C4.79818 17.3828 4.18945 16.9141 3.64258 16.3672C3.08919 15.8203 2.61719 15.2148 2.22656 14.5508C1.83594 13.8802 1.5332 13.1608 1.31836 12.3926C1.10352 11.6243 0.996094 10.8268 0.996094 10C0.996094 9.17318 1.10352 8.37891 1.31836 7.61719C1.5332 6.84896 1.83594 6.13281 2.22656 5.46875C2.61719 4.79818 3.08919 4.18945 3.64258 3.64258C4.18945 3.08919 4.79818 2.61719 5.46875 2.22656C6.13281 1.83594 6.84896 1.5332 7.61719 1.31836C8.37891 1.10352 9.17318 0.996094 10 0.996094C10.8268 0.996094 11.6243 1.10352 12.3926 1.31836C13.1543 1.5332 13.8704 1.83594 14.541 2.22656C15.2051 2.61719 15.8138 3.08919 16.3672 3.64258C16.9141 4.18945 17.3828 4.79818 17.7734 5.46875C18.1641 6.13281 18.4668 6.84896 18.6816 7.61719C18.8965 8.37891 19.0039 9.17318 19.0039 10ZM10 17.998C10.2344 17.998 10.4883 17.8841 10.7617 17.6562C11.0286 17.4284 11.2891 17.0996 11.543 16.6699C11.7904 16.2402 12.0215 15.7161 12.2363 15.0977C12.4512 14.4792 12.6237 13.7793 12.7539 12.998H7.24609C7.3763 13.7793 7.54883 14.4792 7.76367 15.0977C7.97852 15.7161 8.21289 16.2402 8.4668 16.6699C8.71419 17.0996 8.97461 17.4284 9.24805 17.6562C9.51497 17.8841 9.76562 17.998 10 17.998ZM12.9004 12.002C12.9329 11.6829 12.959 11.3574 12.9785 11.0254C12.9915 10.6934 12.998 10.3516 12.998 10C12.998 9.64844 12.9915 9.30664 12.9785 8.97461C12.959 8.64258 12.9329 8.31706 12.9004 7.99805H7.09961C7.06706 8.31706 7.04427 8.64258 7.03125 8.97461C7.01172 9.30664 7.00195 9.64844 7.00195 10C7.00195 10.3516 7.01172 10.6934 7.03125 11.0254C7.04427 11.3574 7.06706 11.6829 7.09961 12.002H12.9004ZM2.00195 10C2.00195 10.6771 2.08659 11.3444 2.25586 12.002H6.10352C6.07096 11.6764 6.04492 11.3477 6.02539 11.0156C6.00586 10.6836 5.99609 10.3451 5.99609 10C5.99609 9.65495 6.00586 9.31641 6.02539 8.98438C6.04492 8.65234 6.07096 8.32357 6.10352 7.99805H2.25586C2.08659 8.6556 2.00195 9.32292 2.00195 10ZM10 2.00195C9.76562 2.00195 9.51497 2.11589 9.24805 2.34375C8.97461 2.57161 8.71419 2.90039 8.4668 3.33008C8.21289 3.75977 7.97852 4.28385 7.76367 4.90234C7.54883 5.52083 7.3763 6.2207 7.24609 7.00195H12.7539C12.6237 6.2207 12.4512 5.52083 12.2363 4.90234C12.0215 4.28385 11.7904 3.75977 11.543 3.33008C11.2891 2.90039 11.0286 2.57161 10.7617 2.34375C10.4883 2.11589 10.2344 2.00195 10 2.00195ZM13.8965 7.99805C13.929 8.32357 13.9551 8.65234 13.9746 8.98438C13.9941 9.31641 14.0039 9.65495 14.0039 10C14.0039 10.3451 13.9941 10.6836 13.9746 11.0156C13.9551 11.3477 13.929 11.6764 13.8965 12.002H17.7441C17.9134 11.3444 17.998 10.6771 17.998 10C17.998 9.32292 17.9134 8.6556 17.7441 7.99805H13.8965ZM17.4121 7.00195C17.1777 6.42253 16.8815 5.88216 16.5234 5.38086C16.1654 4.87305 15.7585 4.41732 15.3027 4.01367C14.8405 3.60352 14.3359 3.25195 13.7891 2.95898C13.2422 2.65951 12.6628 2.42839 12.0508 2.26562C12.4479 2.79948 12.7962 3.47331 13.0957 4.28711C13.3887 5.0944 13.6133 5.99935 13.7695 7.00195H17.4121ZM7.94922 2.26562C7.33724 2.42839 6.75781 2.65951 6.21094 2.95898C5.66406 3.25195 5.16276 3.60352 4.70703 4.01367C4.24479 4.41732 3.83464 4.87305 3.47656 5.38086C3.11849 5.88216 2.82227 6.42253 2.58789 7.00195H6.23047C6.38672 5.99935 6.61458 5.0944 6.91406 4.28711C7.20703 3.47331 7.55208 2.79948 7.94922 2.26562ZM2.58789 12.998C2.82227 13.5775 3.11849 14.1211 3.47656 14.6289C3.83464 15.1302 4.24479 15.5859 4.70703 15.9961C5.16276 16.3997 5.66406 16.7513 6.21094 17.0508C6.75781 17.3438 7.33724 17.5716 7.94922 17.7344C7.55208 17.2005 7.20703 16.5299 6.91406 15.7227C6.61458 14.9089 6.38672 14.0007 6.23047 12.998H2.58789ZM12.0508 17.7344C12.6628 17.5716 13.2422 17.3438 13.7891 17.0508C14.3359 16.7513 14.8405 16.3997 15.3027 15.9961C15.7585 15.5859 16.1654 15.1302 16.5234 14.6289C16.8815 14.1211 17.1777 13.5775 17.4121 12.998H13.7695C13.6133 14.0007 13.3887 14.9089 13.0957 15.7227C12.7962 16.5299 12.4479 17.2005 12.0508 17.7344Z",fill:"#3A3A38"})),ue.a.createElement("defs",null,ue.a.createElement("clipPath",{id:"clip0_741_74312"},ue.a.createElement("rect",{width:"20",height:"20",fill:"white"}))))},Kd=function(e){return ue.a.createElement("svg",{className:e,width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.a.createElement("g",{clipPath:"url(#clip0_98326_1271)"},ue.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint0_linear_98326_1271)"}),ue.a.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint1_linear_98326_1271)"}),ue.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint2_radial_98326_1271)"}),ue.a.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint3_linear_98326_1271)"}),ue.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint4_radial_98326_1271)"}),ue.a.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint5_linear_98326_1271)"})),ue.a.createElement("defs",null,ue.a.createElement("linearGradient",{id:"paint0_linear_98326_1271",x1:"9.52494",y1:"5.71629",x2:"4.86462",y2:"20.1745",gradientUnits:"userSpaceOnUse"},ue.a.createElement("stop",{stopColor:"#AE7FE2"}),ue.a.createElement("stop",{offset:"1",stopColor:"#0078D4"})),ue.a.createElement("linearGradient",{id:"paint1_linear_98326_1271",x1:"7.5417",y1:"16.3092",x2:"6.72169",y2:"14.7676",gradientUnits:"userSpaceOnUse"},ue.a.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),ue.a.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),ue.a.createElement("radialGradient",{id:"paint2_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.98808 16.3592) rotate(-13.1869) scale(13.9366 10.8259)"},ue.a.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),ue.a.createElement("stop",{offset:"1",stopColor:"#5E438F"})),ue.a.createElement("linearGradient",{id:"paint3_linear_98326_1271",x1:"16.6314",y1:"10.9555",x2:"15.8357",y2:"12.2201",gradientUnits:"userSpaceOnUse"},ue.a.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),ue.a.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),ue.a.createElement("radialGradient",{id:"paint4_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9836 11.3541) rotate(-160.581) scale(16.4238 16.5011)"},ue.a.createElement("stop",{stopColor:"#50E6FF"}),ue.a.createElement("stop",{offset:"1",stopColor:"#436DCD"})),ue.a.createElement("linearGradient",{id:"paint5_linear_98326_1271",x1:"5.49905",y1:"5.87339",x2:"8.12498",y2:"5.87339",gradientUnits:"userSpaceOnUse"},ue.a.createElement("stop",{offset:"0.9999",stopColor:"#2D3F80"}),ue.a.createElement("stop",{offset:"1",stopColor:"#436DCD",stopOpacity:"0"})),ue.a.createElement("clipPath",{id:"clip0_98326_1271"},ue.a.createElement("rect",{y:"0.75",width:"20",height:"20",rx:"2",fill:"white"}))))},Yd=ue.a.createElement("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},ue.a.createElement("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM11 7h2v2h-2V7zm0 3h2v6h-2V10z"}));!function(e){e.CurrentContext="CurrentContext",e.Work="Work",e.Web="Web"}(Vd||(Vd={}));var Zd,Jd=function(e){var t;return(t={})[Vd.CurrentContext]=function(e){return ue.a.createElement("svg",{className:e,width:"16",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.a.createElement("path",{d:"M2 0.720703C0.89543 0.720703 0 1.61613 0 2.7207V18.7207C0 19.8253 0.895431 20.7207 2 20.7207H14C15.1046 20.7207 16 19.8253 16 18.7207V8.54847C16 8.01804 15.7893 7.50933 15.4142 7.13426L9.58645 1.30649C9.21137 0.931417 8.70267 0.720703 8.17223 0.720703H2ZM1.5 2.7207C1.5 2.44456 1.72386 2.2207 2 2.2207H8V6.7207C8 7.82527 8.89543 8.7207 10 8.7207H14.5V18.7207C14.5 18.9968 14.2761 19.2207 14 19.2207H2C1.72386 19.2207 1.5 18.9968 1.5 18.7207V2.7207ZM13.3793 7.2207H10C9.72386 7.2207 9.5 6.99685 9.5 6.7207V3.34136L13.3793 7.2207Z"}))}(e),t[Vd.Work]=function(e){return ue.a.createElement("svg",{className:e,width:"18",height:"19",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.a.createElement("path",{d:"M7.25 2.2207H10.75C11.1642 2.2207 11.5 2.55649 11.5 2.9707V4.7207H6.5V2.9707C6.5 2.55649 6.83579 2.2207 7.25 2.2207ZM5 2.9707V4.7207H3.25C1.45507 4.7207 0 6.17578 0 7.9707V15.4707C0 17.2656 1.45507 18.7207 3.25 18.7207H14.75C16.5449 18.7207 18 17.2656 18 15.4707V7.9707C18 6.17578 16.5449 4.7207 14.75 4.7207H13V2.9707C13 1.72806 11.9926 0.720703 10.75 0.720703H7.25C6.00736 0.720703 5 1.72806 5 2.9707ZM16.5 7.9707V9.4707C16.5 10.4372 15.7165 11.2207 14.75 11.2207H11V10.7207C11 10.1684 10.5523 9.7207 10 9.7207H8C7.44772 9.7207 7 10.1684 7 10.7207V11.2207H3.25C2.2835 11.2207 1.5 10.4372 1.5 9.4707V7.9707C1.5 7.0042 2.2835 6.2207 3.25 6.2207H14.75C15.7165 6.2207 16.5 7.0042 16.5 7.9707ZM16.5 12.2098V15.4707C16.5 16.4372 15.7165 17.2207 14.75 17.2207H3.25C2.2835 17.2207 1.5 16.4372 1.5 15.4707V12.2098C2.00515 12.5332 2.60568 12.7207 3.25 12.7207H7C7 13.273 7.44772 13.7207 8 13.7207H10C10.5523 13.7207 11 13.273 11 12.7207H14.75C15.3943 12.7207 15.9949 12.5332 16.5 12.2098Z"}))}(e),t},Xd={direction:Qd.a.bidirectional,isCircularNavigation:!0,handleTabKey:Qd.b.all};!function(e){e.Shimmer="shimmer",e.Blocked="blocked",e.Enabled="enabled",e.Disabled="disabled",e.Loading="loading"}(Zd||(Zd={}));var $d,ep=n(3569),tp=n(3447),np=n(3399),rp=n(3357),op=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return ue.a.createElement(me.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},ue.a.createElement(be.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=rp.e,n=rp.d,r=Object(Ee.a)(n,t),ue.a.createElement(r,null))},onClick:a,disabled:i}))},ip=Object(pe.a)({inputBanner:Object(o.__assign)(Object(o.__assign)({minHeight:"32px"},Me.a.margin("-5px")),{borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"}),inputBannerInInputV3:{minHeight:"32px",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomStyle:"none"}}),ap=function(e){var t=ip();return e?t.inputBannerInInputV3:t.inputBanner},sp=function(e){var t=e.chatInputBannerString,n=e.isInputV3Enabled,r=void 0!==n&&n;return ue.a.createElement(Yn.a,{className:ap(r)},ue.a.createElement(Qn.a,null,t))},lp=n(1447),cp={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",DIALOG:"dialog",TOOLTIP:"tooltip"},up=function(){return"undefined"!=typeof OfficeaicopilotStrings},dp=function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{augloopSession:t})},pp=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return e?(Object(lp.b)(e),[4,Object(lp.a)()]):[2,null];case 1:return[2,t.sent().getSession()]}}))}))},gp=function(e,t,n,r,i){var a;void 0===r&&(r=!1),void 0===i&&(i=void 0);var s=null==n?void 0:n.current;if(!s)return"";var l=Object(o.__read)(function(e,t){var n=-1,r=t.find((function(t){var r=null==e?void 0:e.toLocaleLowerCase().indexOf(t().toLocaleLowerCase());return-1!==r&&(n=r,!0)}));return[r?r():"",n]}(e,t),2),c=l[0],u=l[1],d=Object(o.__read)(function(e,t,n){var r="",o="",i=e;return t.length>0&&-1!==n&&(r=n>0?e.slice(0,n):"",o=t,i=e.slice(n+t.length)),[r,o,i]}(e,c,u),3),p=d[0],g=d[1],h=d[2];if(r||c.length>0){if(s.innerText="",e.includes("{")&&e.includes("}"))a=Object(o.__read)(function(e){var t=e.match(/\{(.*?)\}/),n="",r="",o=e;if(t){var i=e.indexOf(t[0]);n=e.slice(0,i),r=t[1],o=e.slice(i+t[0].length)}return[n,r,o]}(e),3),p=a[0],g=a[1],h=a[2],0===c.length&&(c=g);else if(0===c.length)return void(s.innerText=e);!function(e,t,n,r,i){if(void 0===i&&(i=void 0),t.length>0){var a=document.createTextNode(t);e.appendChild(a)}var s=document.createElement("span"),l=document.createElement("span");l.style.backgroundColor=Be.a.colorNeutralBackground3,l.style.color=Be.a.colorNeutralForeground2,l.contentEditable="false",l.textContent=n,l.style.borderRadius=Vp,l.style.padding=zp,s.appendChild(l);var c=new MutationObserver((function(t,r){var a,l;try{for(var c=Object(o.__values)(t),u=c.next();!u.done;u=c.next())"childList"===u.value.type&&(Array.from(e.children).includes(s)||(i&&i(n,!1),r.disconnect()))}catch(e){a={error:e}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(a)throw a.error}}}));c.observe(e,{childList:!0}),e.appendChild(s),0===r.length&&(r=" ");var u=document.createTextNode(r);e.appendChild(u)}(s,p,g,h,i)}else s.innerText=e;return c},hp=function(){return up()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area"},fp=function(){return up()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide"},mp=function(){return up()?OfficeaicopilotStrings.SubmitButtonTitle:"Send"},vp=function(){return up()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own"},bp="",yp="br",Cp="copilot-chat-input",Op=1e4,Sp=function(){return up()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},Ep=" ",xp=function(){return up()?OfficeaicopilotStrings.DefaultCIQButtonTitle:"Attach"},Ip=function(){return up()?OfficeaicopilotStrings.DefaultGroundingButtonTitle:"Manage search and plugins"},wp=function(){return up()?OfficeaicopilotStrings.GroundingSearchAndPlugins:"Search and plugins"},Tp=function(){return up()?OfficeaicopilotStrings.PreviewFlagLabel:"Preview"},kp=function(){return up()?OfficeaicopilotStrings.GroundingPluginFlyoutInfo:"Plugins allow Copilot to reference apps on your behalf. Copilot may share some of your Microsoft 365 enterprise data with plugins you’ve turned on."},jp=function(){return up()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoTooltip:"Microsoft 365 enterprise data includes Office applications, SharePoint sites, cloud files, communications, and more. All configured by your IT admin."},Pp=function(){return up()?OfficeaicopilotStrings.AdminBlockedPluginInfoTooltipLabel:"The service required to use this plugin is turned off for your organization."},Ap=function(){return up()?OfficeaicopilotStrings.WorkPluginLabel:"Microsoft 365 data"},_p=function(){return up()?OfficeaicopilotStrings.WebContentPluginLabel:"Web content"},Dp=function(){return up()?OfficeaicopilotStrings.GroundingPluginFlyoutInfoLabel:"Info"},Lp=function(){return"Create a new presentation"},Mp=function(){return"Create the new presentation"},Bp=function(){return"Add a slide about"},Rp=function(){return"Add an agenda slide"},Fp=function(){return"Create a presentation"},Np=function(){return"Organize the presentation"},Hp=function(){return"Organize this presentation"},Up=function(){return"Add an image of"},Vp="4px",zp="0px 4px 4px 4px";!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}($d||($d={}));var Gp,Wp,Qp,qp=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralForeground4,alignItems:"flex-start"},pn.a.body1),{fontStyle:"normal"}),Me.a.gap("1px")),{content:"attr(title)"}),Kp={color:Be.a.colorNeutralForegroundDisabled,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},Yp=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),Me.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(o.__assign)({},Me.a.outline(0))}),Zp={userInput:Object(o.__assign)(Object(o.__assign)({},Yp),{"&:focus":Object(o.__assign)({},Me.a.outline(0)),"&:focus::after":qp,"&::after":qp})},Jp={userInput:Object(o.__assign)(Object(o.__assign)({},Yp),{"&:focus":Object(o.__assign)({},Me.a.outline(0))})},Xp={userInput:{"&:focus::after":Kp,"&::after":Kp}},$p=Object(pe.a)(Jp),eg=Object(pe.a)(Zp),tg=Object(pe.a)(Xp),ng=function(e){var t=Object(o.__read)(Object(ce.useState)(!1),2),n=t[0],r=t[1];return ue.a.createElement("div",{onMouseEnter:function(){r(!0)},onMouseLeave:function(){r(!1)},style:{position:"relative"}},ue.a.createElement("button",{style:{position:"absolute",left:"40px",visibility:n?"visible":"hidden"},onClick:e.removeImageCallback},"X"),ue.a.createElement("img",{src:e.imageDataUri,alt:"Visual part of the prompt",width:"50px"}))},rg=ue.a.forwardRef((function(e,t){var n=e.styleOverrideClassName,r=e.placeholderText,i=e.chatInputTabIndex,a=e.isDisabled,s=e.isHVCAppChatV2Enabled,l=e.hvcPromptStrings,c=e.onChatInputHVCPromptUpdated,u=e.handleKeyDown,d=e.handleKeyUp,p=e.handleOnPaste,g=e.handleOnBeforeInput,h=e.handleOnInput,f=e.handleOnCompositionEnd,m=e.handleOnFocusTextArea,v=e.handleOnChatInputControlMount,b=e.handleOnChatInputControlUnmount,y=Object(ce.useRef)(),C=null!=l?l:[Lp,Mp,Bp,Rp,Fp,Np,Hp,Up];Object(ce.useImperativeHandle)(t,(function(){return{setInputText:function(e,t){void 0===t&&(t=!1),S(e,t),O()},updateInputText:function(e,t){switch(t){case $d.InsertAtCursor:E(e);break;case $d.Replace:S(e)}},getInputText:function(){return I()},getInputSpanElement:function(){return y.current},setFocus:function(){w()},getGhostText:function(){var e,t;return null!==(t=null===(e=y.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:function(e){var t;null===(t=y.current)||void 0===t||t.setAttribute("title",e),_(e===bp?T.current.userInput:j.current.userInput)},scrollToBottom:O,addImage:function(e){M([e])},removeImages:function(){M([])},getImages:function(){return L}}}));var O=function(){var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},S=function(e,t){void 0===t&&(t=!1);var n=y.current;if(n)if(s&&e.length>0){var r=gp(e,C,y,t,c);c(r,!0)}else n.innerText=e},E=function(e){var t=window.getSelection();if(t.rangeCount){t.deleteFromDocument();var n=t.getRangeAt(0);n.commonAncestorContainer.textContent+=e,n.selectNode(t.anchorNode),n.collapse(!1),O()}};var I=function(){var e,t,n=bp,r=y.current;return r&&(t=bp,(e=r).childNodes&&e.childNodes.length>0&&e.childNodes.forEach((function(e){e.tagName&&e.tagName.toLowerCase()===yp?t+="\n":t+=e.textContent})),n=t),n},w=function(){if(!a){var e=y.current;e&&(e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length))}};Object(ce.useEffect)((function(){return v&&v(),function(){b&&b()}}),[]);var T=Object(ce.useRef)($p()),k=Object(ce.useRef)(tg()),j=Object(ce.useRef)(eg()),P=Object(o.__read)(Object(ce.useState)(j.current.userInput),2),A=P[0],_=P[1];Object(ce.useEffect)((function(){a&&_(Object(x.a)(j.current.userInput,k.current.userInput))}),[a]),Object(ce.useEffect)((function(){n&&_(Object(x.a)(T.current.userInput,n))}),[n]);var D=Object(o.__read)(Object(ce.useState)([]),2),L=D[0],M=D[1];return ue.a.createElement(ue.a.Fragment,null,L.map((function(e,t){return ue.a.createElement(ng,{imageDataUri:e,key:t,removeImageCallback:function(){L.splice(t,1),M(L)}})})),ue.a.createElement("span",{ref:y,className:A,title:r,"aria-label":r,"aria-disabled":a,role:"textbox",tabIndex:i,contentEditable:!a,suppressContentEditableWarning:!a,onKeyDown:u,onKeyUp:d,onPaste:p,onBeforeInput:g,onInput:h,onCompositionEnd:f,onFocus:m}))})),og=n(2793),ig=n(3513),ag=n(3445),sg=Object(Ad.a)({palette:Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"})}),lg=(Object(Ad.a)({palette:Object(o.__assign)(Object(o.__assign)({},j.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"})}),function(){return Gp}),cg=function(e){var t=e.themePalette,n=e.isDarkMode,r=e.dir,i=void 0===r?void 0:r,a=e.children,s=e.className,l=Object(o.__assign)(Object(o.__assign)({},sg.palette),t),c=Object(ag.a)(l),u=n?Object(kd.a)(c):Object(jd.a)(c);return Gp=u,ce.createElement(le.a,{className:s,theme:u,dir:i},a)},ug=function(e,t){var n=Object(Ee.a)(t,e);return ue.a.createElement(n,null)},dg=function(e){var t=e;return ue.a.createElement(t,null)},pg=n(682),gg=n(3595),hg=n(35),fg={popOver:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",maxHeight:"390px"},Me.a.overflow("hidden","auto")),Me.a.margin("right: 20")),{backgroundColor:Be.a.colorNeutralBackground1,paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"4px",":hover::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralForeground4},Me.a.border("2px","solid",Be.a.colorNeutralBackground3)),Me.a.borderRadius(Be.a.borderRadiusMedium)),"&::-webkit-scrollbar":{width:Be.a.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:Be.a.colorNeutralBackground5}}),menuItem:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1,maxWidth:"inherit"},Me.a.padding("0px")),Me.a.border("2px","solid","transparent")),Me.a.borderRadius(Be.a.borderRadiusMedium)),(Wp={"> span":Object(o.__assign)({},Me.a.overflow("hidden"))},Wp["&:focus-within"]=Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Hover},Me.a.border("2px","solid",Be.a.colorNeutralBackground1Hover)),Wp[hg.m]={":hover":Object(o.__assign)({},Me.a.border("2px","dashed","Highlight"))},Wp)),descriptionSection:{color:Be.a.colorNeutralForeground2Link,paddingBottom:"6px"},installedSection:Object(o.__assign)(Object(o.__assign)({display:"flex",paddingBottom:"10px",flexDirection:"column"},Me.a.gap("2px")),{alignSelf:"stretch"}),description:{paddingBottom:"6px",fontFamily:"Segoe UI",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:Be.a.colorNeutralForeground2Link},titleContainer:Object(o.__assign)({display:"flex",flexDirection:"row"},Me.a.gap("8px")),title:Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start"},Me.a.gap("10px")),{alignSelf:"stretch"}),previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:Object(o.__assign)(Object(o.__assign)({height:"16px",color:Be.a.colorNeutralForeground2,backgroundColor:Be.a.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px"},Me.a.borderRadius("8px")),{display:"flex",flexDirection:"row",alignSelf:"stretch",fontFamily:"Segoe UI",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"}),shimmerComponent:Object(o.__assign)({},Me.a.padding("6px","6px","6px","0px")),labelInfo:(Qp={backgroundColor:Be.a.colorNeutralBackground1},Qp["&:focus-within"]=Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Hover},Me.a.border("2px","solid",Be.a.colorNeutralBackground1Hover)),Me.a.borderRadius(Be.a.borderRadiusMedium)),Qp)};var mg,vg=function(){var e,t,n,r,o,i,a,s,l,c,u,d={popOver:null!==(e=fg.popOver)&&void 0!==e?e:{},titleContainer:null!==(t=fg.titleContainer)&&void 0!==t?t:{},descriptionSection:null!==(n=fg.descriptionSection)&&void 0!==n?n:{},title:null!==(r=fg.title)&&void 0!==r?r:{},previewTitleContainer:null!==(o=fg.previewTitleContainer)&&void 0!==o?o:{},previewTitle:null!==(i=fg.previewTitle)&&void 0!==i?i:{},menuItem:null!==(a=fg.menuItem)&&void 0!==a?a:{},installedSection:null!==(s=fg.installedSection)&&void 0!==s?s:{},description:null!==(l=fg.description)&&void 0!==l?l:{},shimmerComponent:null!==(c=fg.shimmerComponent)&&void 0!==c?c:{},labelInfo:null!==(u=fg.labelInfo)&&void 0!==u?u:{}};return Object(pe.a)(d)}(),bg={shimmer:Be.a.colorNeutralStencil1,shimmerWave:Be.a.colorNeutralStencil2,background:Be.a.colorNeutralBackground1},yg={tooltipText:{width:"216px",fontSize:"12px"},tooltip:{alignSelf:"center","> button":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:"none",minWidth:"0px",maxHeight:"18px",maxWidth:"18px"},Me.a.padding("4px")),Me.a.borderStyle("none")),Me.a.borderRadius("18px"))},infoButton:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:"inherit",boxShadow:"none",lineHeight:"6px"},Me.a.border("2px","solid","transparent")),Me.a.borderColor(Be.a.borderRadiusCircular)),(mg={"> span":{maxHeight:"18px",maxWidth:"18px"}},mg["&:focus-within"]=Object(o.__assign)({},Me.a.border("2px","solid",Be.a.colorNeutralBackground1Hover)),mg[":hover"]={backgroundColor:Be.a.colorNeutralForeground2BrandHover,"> span > svg > path":{fill:Be.a.colorNeutralBackground2}},mg[hg.m]={"> span > svg > path":{fill:"ButtonText"},":hover":{backgroundColor:"Highlight"}},mg))};var Cg=function(){var e,t,n,r={tooltipText:null!==(e=yg.tooltipText)&&void 0!==e?e:{},tooltip:null!==(t=yg.tooltip)&&void 0!==t?t:{},infoButton:null!==(n=yg.infoButton)&&void 0!==n?n:{}};return Object(pe.a)(r)}();function Og(e){var t=e.infoMessage,n=Cg();return ce.createElement("span",{className:n.tooltip,role:cp.TOOLTIP},ce.createElement(me.a,{content:t,relationship:"description"},ce.createElement(be.a,{icon:Yd,size:"small",className:n.infoButton,"aria-label":Dp()})))}var Sg=n(3604),Eg={appIcon:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({width:"20px",height:"fit-content",float:"left"},Me.a.padding("4px","4px","4px","4px")),Me.a.border("2px","solid",Be.a.colorNeutralBackground3Pressed)),Me.a.borderRadius(Be.a.borderRadiusMedium)),appNameContainer:Object(o.__assign)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto"},Me.a.overflow("hidden")),appNameTextContainer:Object(o.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto"},Me.a.overflow("hidden")),appName:Object(o.__assign)(Object(o.__assign)({width:"auto",height:"auto",lineHeight:"36px",paddingLeft:"2px",paddingRight:"2px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:Be.a.colorNeutralForeground2Link,whiteSpace:"nowrap"},Me.a.overflow("hidden")),{textOverflow:"ellipsis"}),appInfo:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.gap("4px")),{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),Me.a.overflow("hidden")),{alignContent:"center",justifyItems:"left",alignItems:"center"}),blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",maxHeight:"100px"},Me.a.gap("4px")),{justifyContent:"space-between","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}),toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right",height:"36px","@media (forced-colors: active)":{forcedColorAdjust:"none"}},spinner:{paddingTop:"8px",paddingInlineEnd:"20px"}};var xg=function(){var e,t,n,r,o,i,a,s,l,c,u={appIcon:null!==(e=Eg.appIcon)&&void 0!==e?e:{},appNameContainer:null!==(t=Eg.appNameContainer)&&void 0!==t?t:{},appNameTextContainer:null!==(n=Eg.appNameTextContainer)&&void 0!==n?n:{},appName:null!==(r=Eg.appName)&&void 0!==r?r:{},appInfo:null!==(o=Eg.appInfo)&&void 0!==o?o:{},blocked:null!==(i=Eg.blocked)&&void 0!==i?i:{},infoIcon:null!==(a=Eg.infoIcon)&&void 0!==a?a:{},pluginItem:null!==(s=Eg.pluginItem)&&void 0!==s?s:{},toggleControl:null!==(l=Eg.toggleControl)&&void 0!==l?l:{},spinner:null!==(c=Eg.spinner)&&void 0!==c?c:{}};return Object(pe.a)(u)}();function Ig(e){var t=e.title,n=e.plugin,r=xg(),i=Object(o.__read)(ce.useState(n.state==Zd.Enabled),2),a=i[0],s=i[1],l=ce.useCallback((function(e,t){c(t.checked)}),[]);ce.useEffect((function(){s(n.state==Zd.Enabled)}),[n.state]);var c=function(e){n.onToggle(e),s(e)},u=n.state===Zd.Blocked?r.blocked:void 0,d=ce.useMemo((function(){var e=n.state==Zd.Blocked;return ce.createElement("div",{className:r.toggleControl},n.state===Zd.Loading&&ce.createElement(Sg.a,{className:r.spinner}),n.state!==Zd.Loading&&ce.createElement(We.a,{disabled:!!e,checked:a,onChange:l,tabIndex:-1,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c(!(n.state==Zd.Enabled)))},role:"switch"}))}),[c]),p=n.state===Zd.Blocked?ce.createElement(Og,{infoMessage:Pp()}):null,g=r.appName;g=Object(x.a)(g,u);var h,f=(h=n.id)===Vd.Web?qd(r.appIcon):h===Vd.Work?Kd(r.appIcon):void 0,m=ce.createElement("div",{className:r.appInfo},f,ce.createElement("div",{className:r.appNameTextContainer},ce.createElement(ut.a,{className:g},t),p));return ce.createElement("div",{className:r.pluginItem},m,d)}function wg(e){var t=e.plugins,n=e.isPluginDataLoaded,r=vg(),i=ce.useCallback((function(e){if(a.current.push(e),t.length===a.current.length)for(var n=y,r=function(e){if(!n[e].props.disabled)return requestAnimationFrame((function(){a.current[e].focus()})),"break"},o=0;o<n.length;o++){if("break"===r(o))break}}),[]),a=ce.useRef([]),s=r.title,l=r.previewTitle,c=r.descriptionSection,u=r.description,d=ce.createElement(Og,{infoMessage:jp()}),p=ce.createElement("div",{className:r.previewTitleContainer},ce.createElement(ut.a,{className:l},Tp())),g=ce.createElement("div",{className:c},ce.createElement("div",{className:r.titleContainer},ce.createElement(ut.a,{role:cp.HEADING,"aria-level":1,"aria-label":wp(),className:s},wp()),e.isPreview&&p),ce.createElement(ut.a,{className:u},kp()),d),h=[{type:pg.a.circle,height:22.7},{type:pg.a.gap,width:10},{type:pg.a.line,height:10,width:160},{type:pg.a.gap,width:80},{type:pg.a.line,height:10}],f=ce.memo((function(){return ce.createElement(gg.a,{className:r.shimmerComponent,shimmerElements:h,shimmerColors:bg})}));f.displayName="ShimmerComponent";var m,v=function(e){var t,n=e.target,r=null===(t=e.currentTarget)||void 0===t?void 0:t.querySelector('[role="switch"]');n!==r&&(e.preventDefault(),null==r||r.click(),null==n||n.focus())},b=function(e){"Enter"!==e.key&&" "!==e.key||v(e)},y=ce.useMemo((function(){return t.map((function(e,t){var n,o=e.state===Zd.Blocked,a=(n=e.id)===Vd.Work?Ap():n===Vd.Web?_p():void 0;return ce.createElement(Se.a,{role:"button",key:t,persistOnClick:!0,className:r.menuItem,tabIndex:o?-1:0,disabled:o,onKeyDown:b,onClick:v,"aria-label":a,"aria-pressed":e.state===Zd.Enabled,ref:i},ce.createElement(Ig,{title:a,plugin:e,key:e.id}))}))}),[t]),C=ce.createElement("div",{className:r.installedSection},n?y:(m=t.length,ce.createElement(ce.Fragment,null,Object(o.__spreadArray)([],Object(o.__read)(Array(m)),!1).map((function(e,t){return ce.createElement(f,{key:t})})))));return ce.createElement(le.a,null,ce.createElement(Ce.a,{role:cp.DIALOG,className:r.popOver},ce.createElement(Oe.a,null,g,C)))}var Tg,kg,jg,Pg,Ag={color:Be.a.colorBrandForeground1},_g=Object(pe.a)({menuPopOver:Object(o.__assign)(Object(o.__assign)({minWidth:"304px",maxWidth:"calc(100% - 20px)",overflowX:"hidden",boxSizing:"border-box"},Me.a.margin("right: 20")),{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",overflowY:"hidden"})}),Dg=function(e){var t=e.title,n=e.isDisabled,r=e.isMenuOpen,i=void 0!==r&&r,a=e.setMenuOpen,s=e.targetRef,l=e.shouldBlockGroundingButtonClick,c=void 0===l?function(){return!1}:l,u=e.groundingButtonPluginProps,d=Object(o.__read)(Object(ce.useState)(i),2),p=d[0],g=d[1],h=ue.a.useRef(null),f=Object(o.__read)(Object(ce.useState)(!1),2),m=f[0],v=f[1],b=ue.a.useRef(null),y=_g();ue.a.useEffect((function(){var e;s&&(null===(e=h.current)||void 0===e||e.setTarget(s))}),[s,h]),Object(ce.useEffect)((function(){g(i)}),[i]),Object(ce.useEffect)((function(){a(p)}),[p,a]);var C=ue.a.useCallback((function(e,t){var n;c&&c()||(null===(n=u.onGroundingButtonClick)||void 0===n||n.call(u),a(null==t?void 0:t.open))}),[a,c]);Object(ce.useEffect)((function(){var e;v(u.pluginBlockedInfo&&0===(null===(e=u.plugins)||void 0===e?void 0:e.filter((function(e){return e.state===Zd.Shimmer})).length))}),[u]);var O=ue.a.useMemo((function(){var e;if(!u.plugins)return[];if(!u.pluginBlockedInfo){var t=[];return u.plugins.forEach((function(e){var n=Object(o.__assign)(Object(o.__assign)({},e),{state:Zd.Shimmer});t.push(n)})),t}if(!(null===(e=u.pluginBlockedInfo)||void 0===e?void 0:e.length))return u.plugins;var n=[];return u.plugins.forEach((function(e){var t=Object(o.__assign)(Object(o.__assign)({},e),{state:u.pluginBlockedInfo.includes(e.id)?Zd.Blocked:e.state});n.push(t)})),n}),[u]),S=ue.a.createElement(me.a,{content:t,relationship:"label",positioning:"above",withArrow:!0},ue.a.createElement(be.a,{appearance:"transparent",disabled:n,icon:p?{children:dg(Bt.d),style:Ag}:{children:ug(Bt.e,Bt.d)},"aria-label":t}));if(u.copilotPluginFlyoutProps){var E={target:s,positioningRef:b,align:"center",position:"above"};return ue.a.createElement($o.a,{open:p,onOpenChange:C,positioning:E,trapFocus:!0},ue.a.createElement(ei.a,null,S),ue.a.createElement(le.a,null,ue.a.createElement(ti.a,{className:y.menuPopOver},ue.a.createElement(ig.a,Object(o.__assign)({},u.copilotPluginFlyoutProps,{positioningRef:b,fluentTheme:lg(),mountTooltipToBody:!0})))))}var x={target:s,align:"center",position:"above"};return ue.a.createElement(fe.a,{open:p,onOpenChange:C,positioning:x},ue.a.createElement(ve.a,{disableButtonEnhancement:!0},S),ue.a.createElement(wg,{isPluginDataLoaded:m,plugins:O,isPreview:!0}))},Lg=n(836),Mg=n(393),Bg=n(195),Rg=n(1137),Fg=n(2467),Ng={selectors:(Tg={},Tg[hg.m]={color:"ButtonText"},Tg)},Hg=Object(Mg.c)((function(e,t,n,r){return Object(hg.db)({root:{direction:"inherit",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},container:{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",minWidth:"-webkit-fill-available",alignItems:"center",backgroundColor:Be.a.colorNeutralBackground4,borderBottom:n?void 0:"solid",borderWidth:"1px",borderColor:Be.a.colorNeutralStroke1,margin:n?void 0:"-4px",borderTopLeftRadius:r?void 0:"7px",borderTopRightRadius:r?void 0:"7px",borderLeftStyle:n?"solid":void 0,borderRightStyle:n?"solid":void 0,borderTopStyle:n||r?"solid":void 0},label:Object(o.__assign)({fontWeight:400,fontSize:hg.k.size12,lineHeight:"16px",textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:t?Be.a.colorNeutralForegroundDisabled:Be.a.colorNeutralForeground1,paddingInlineStart:e?void 0:"10px"},Ng),iconContainer:{display:"flex"},icon:{paddingInlineStart:"10px",paddingInlineEnd:"8px"},downChevron:Object(o.__assign)({fill:t?Be.a.colorNeutralForegroundDisabled:Be.a.colorNeutralForeground1,color:t?Be.a.colorNeutralForegroundDisabled:Be.a.colorNeutralForeground1},Ng)})})),Ug=Object(Mg.c)((function(e){return{root:{background:"transparent",border:"none",fontSize:hg.k.size12,padding:0},rootHovered:{border:"none",backgroundColor:"transparent"},rootPressed:{border:"none",backgroundColor:"transparent"},rootDisabled:{border:"none",backgroundColor:"transparent",fontWeight:400},textContainer:{color:e?Be.a.colorNeutralForegroundDisabled:Be.a.colorNeutralForeground1,fontWeight:400,fontSize:hg.k.size12,lineHeight:"16px",textAlign:"start",textDecoration:"underline",padding:"2px 0px 2px 0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},menuIcon:{margin:0,color:e?Be.a.colorNeutralForegroundDisabled:Be.a.colorNeutralForeground1,fontSize:"8px",paddingTop:"3px"},label:{fontWeight:"normal"}}})),Vg=((kg={})[hg.m]=Object(o.__assign)({backgroundColor:"Highlight",color:"HighlightText",outlineColor:"ButtonText"},Object(hg.S)()),{selectors:(jg={},jg[hg.m]=Object(o.__assign)({backgroundColor:"ButtonFace",color:"ButtonText",outlineColor:"inherit"},Object(hg.S)()),jg)}),zg={selectors:(Pg={},Pg[hg.m]=Object(o.__assign)({backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed"},Object(hg.S)()),Pg)},Gg=Object(Mg.c)((function(){return{root:{padding:"6px",backgroundColor:"transparent",minWidth:"unset"},divider:{height:"1px"}}})),Wg=Object(Mg.c)((function(){var e;return{root:Object(o.__assign)({border:"none",minWidth:"-webkit-fill-available",minHeight:"48px",margin:"1px",padding:"0px",alignItems:"flex-start",fontWeight:400,backgroundColor:Be.a.colorNeutralBackground1,color:Be.a.colorNeutralForeground1,borderColor:Be.a.colorNeutralStroke1,borderRadius:"6px"},Vg),rootHovered:Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Hover,color:Be.a.colorNeutralForeground1Hover},zg),rootPressed:Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1Pressed,color:Be.a.colorNeutralForeground1Pressed},zg),flexContainer:(e={},e[hg.m]=Object(o.__assign)({color:"HighlightText",foreground:"HighlightText",":hover label, :hover svg":{color:"HighlightText",fill:"HighlightText"}},Object(hg.S)()),e)}})),Qg=Object(Mg.c)((function(){return Object(hg.db)({root:{direction:"inherit",borderRadius:"7px",backgroundColor:Be.a.colorNeutralBackground1},buttonContainer:{paddingLeft:"8px",paddingRight:"8px",width:"100%",alignItems:"center"},icon:{alignSelf:"center",padding:"2px",alignItems:"center",lineHeight:24,color:Be.a.colorNeutralForeground1,fill:Be.a.colorNeutralForeground1},container:{paddingInlineStart:"8px",alignItems:"flex-start",alignSelf:"center",display:"inline-block"},primaryLabel:Object(o.__assign)(Object(o.__assign)({textAlign:"start",fontSize:hg.k.size14,fontWeight:400,lineHeight:"14px"},Me.a.padding("0px")),{color:Be.a.colorNeutralForeground1}),secondaryLabel:Object(o.__assign)(Object(o.__assign)({textAlign:"start",fontSize:hg.k.size10,fontWeight:400,lineHeight:"14px"},Me.a.padding("0px")),{color:Be.a.colorNeutralForeground2Link})})})),qg=function(e,t){var n=e.key+"_desc";return ce.createElement(le.a,{className:e.root},ce.createElement(Rg.a,{onClick:function(n,r){e.onClick(),t(n,r)},styles:Wg(),role:"menuitem"},ce.createElement(Gr.a,{horizontal:!0,className:e.buttonContainerClass},Jd(e.iconClass)[e.iconId],ce.createElement(Gr.a,{className:e.containerClass},ce.createElement(Lg.a,{className:e.primaryClass,"aria-describedby":n},e.text),ce.createElement(Lg.a,{className:e.secondaryTextClass,id:n},e.secondaryText)))))},Kg=Object(Mg.c)((function(e,t,n,r){var o,i=t.map((function(e){return function(e,t){var n=Qg();return{key:e.primary,text:e.primary,secondaryText:e.secondary,iconId:e.id,root:n.root,containerClass:n.container,buttonContainerClass:n.buttonContainer,primaryClass:n.primaryLabel,secondaryTextClass:n.secondaryLabel,iconClass:n.icon,onClick:function(n){t(e,n)},onRender:qg}}(e,n)}));return{target:e,alignTargetEdge:!0,isBeakVisible:!1,gapSpace:4,directionalHint:Bg.a.topCenter,items:i,styles:Gg,focusZoneProps:Xd,calloutProps:(o=null==e?void 0:e.offsetWidth,{setInitialFocus:!0,styles:{root:{width:o?o+16:364,borderRadius:"8px"},calloutMain:{backgroundColor:lg().colorNeutralBackground1,borderRadius:"8px"}}}),onDismiss:r}})),Yg=function(e){var t=Object(o.__read)(ce.useState(e.sourcesData[0]),2),n=t[0],r=t[1],i=Object(o.__read)(ce.useState(!1),2),a=i[0],s=i[1],l=function(){s(!0)},c=function(t){s(!1),e.onMenuDismiss&&e.onMenuDismiss(t),window.requestAnimationFrame((function(){var e;return null===(e=d.querySelector("button[aria-haspopup]"))||void 0===e?void 0:e.focus()}))},u=Object(o.__read)(ce.useState(void 0),2),d=u[0],p=u[1],g=Hg(!!e.infoTip,e.isDisabled,e.isChatInputV3Enabled,e.isChatInputBannerVisible);return ce.createElement(le.a,{className:g.root},ce.createElement("div",{className:g.container,ref:function(e){e&&p(e)}},e.infoTip&&ce.createElement("div",{className:g.icon},ce.createElement(Og,{infoMessage:e.infoTip})),ce.createElement(Lg.a,{className:g.label},e.sourcePrefix),ce.createElement(Rg.a,{text:n.primary.toLocaleLowerCase(),styles:Ug(e.isDisabled),onClick:l,disabled:e.isDisabled,"aria-label":e.sourcePrefix+n.primary,type:"button","aria-haspopup":"true"}),ce.createElement(dn.k,{className:g.downChevron,"aria-label":e.infoTip,cursor:"pointer",onClick:e.isDisabled?void 0:l}),a&&d&&ce.createElement(Fg.a,Object(o.__assign)({},Kg(d,e.sourcesData,(function(t,o){t.id!=n.id&&(r(t),e.onSelection&&e.onSelection(t)),c(o)}),c)))))},Zg=Object(pe.a)({activeIcon:{color:Be.a.colorBrandForeground1},menuList:{minWidth:"100%",whiteSpace:"nowrap"},highlightedText:{color:Be.a.colorBrandForeground1},greyedText:{color:Be.a.colorNeutralForeground4},menuItem:{paddingLeft:"10px",paddingBottom:"8px",paddingTop:"8px",paddingRight:"10px",maxWidth:"none"},menuBackButtonContainer:{display:"flex",alignItems:"center","&:hover":{color:Be.a.colorNeutralForeground1}},menuBackButton:{textAlign:"left",paddingLeft:0},menuBackButtonText:{whiteSpace:"nowrap",fontWeight:"600",fontSize:"12px",paddingLeft:"8px"}}),Jg=function(e){e.title;var t,n=e.isDisabled,r=e.isMenuOpen,i=void 0!==r&&r,a=e.setMenuOpen,s=e.positioningRef,l=e.promptGuideMenuProps,c=Zg(),u=Object(o.__read)(Object(ce.useState)(""),2),d=u[0],p=u[1],g=Object(o.__read)(Object(ce.useState)(l.promptGuideMenuData),2),h=g[0],f=g[1],m=Object(ce.useRef)(""===d?h:null===(t=h.children)||void 0===t?void 0:t.find((function(e){return e.text===d})));Object(ce.useEffect)((function(){f(l.promptGuideMenuData)}),[l.promptGuideMenuData]),Object(ce.useEffect)((function(){var e;m.current=""===d?h:null===(e=h.children)||void 0===e?void 0:e.find((function(e){return e.text===d}))}),[h]);var v=Object(o.__read)(Object(ce.useState)(i),2),b=v[0],y=v[1];Object(ce.useEffect)((function(){y(i)}),[i]),Object(ce.useEffect)((function(){a(b)}),[b,a]);var C=ue.a.useCallback((function(e,t){(null==t?void 0:t.open)&&l.shouldBlockPromptGuideLaunch&&l.shouldBlockPromptGuideLaunch()||(y(null==t?void 0:t.open),(null==t?void 0:t.open)&&l.handleOnClickPromptGuideMenuButtonTelemetry(),p(""),m.current=h)}),[p,y,h,l.shouldBlockPromptGuideLaunch]),O=Object(ce.useCallback)((function(e){var t,n;p(e),null===(t=s.current)||void 0===t||t.updatePosition(),m.current=""===e?h:null===(n=h.children)||void 0===n?void 0:n.find((function(t){return t.text===e}))}),[p,h]),S=Object(ce.useRef)(null);return Object(ce.useEffect)((function(){var e=document.getElementById(Cp);if(e){var t=new ResizeObserver((function(){var t,n=e.offsetWidth;if(S.current){var r={width:"".concat(n,"px"),maxWidth:"none",minHeight:"100px"};Object.assign(S.current.style,r)}null===(t=s.current)||void 0===t||t.updatePosition()}));return t.observe(e),function(){t.unobserve(e)}}}),[S,b,s]),ue.a.createElement(fe.a,{open:b,onOpenChange:C,persistOnItemClick:!0,positioning:{positioningRef:s}},ue.a.createElement(ve.a,{disableButtonEnhancement:!0},ue.a.createElement(me.a,{content:up()?OfficeaicopilotStrings.DefaultMenuButtonTitle:"View prompts",relationship:"label",positioning:"above",withArrow:!0},ue.a.createElement(be.a,{appearance:"transparent",disabled:n,icon:b?{children:dg(rp.j),className:c.activeIcon}:{children:ug(rp.k,rp.j)},"aria-label":b?"Close view prompts":"Open view prompts",id:"".concat("ViewPromptsID")}))),ue.a.createElement(Ce.a,{ref:S},ue.a.createElement(Xg,{dataNode:m.current,updatePopoverOpen:y,updateDataNode:O,menuProps:l})))},Xg=function(e){var t,n=e.dataNode,r=e.updatePopoverOpen,i=e.updateDataNode,a=e.menuProps,s=Zg(),l=Object(o.__read)(ue.a.useState(a),1)[0],c="Root"===(null==n?void 0:n.nodeType),u=ue.a.useCallback((function(){i("")}),[i]),d=Object(ce.useRef)(null),p=Object(ce.useRef)(null);if(Object(ce.useEffect)((function(){var e=c?p.current:d.current;e&&e.focus()}),[c]),!n)return ue.a.createElement(ue.a.Fragment,null);var g=c?{}:{paddingLeft:0},h=null==l?void 0:l.copilotLabProps;return ue.a.createElement(Oe.a,{className:s.menuList},ue.a.createElement(rc.a,null,ue.a.createElement(ic.a,{style:g},c?ue.a.createElement(ut.a,{size:200,weight:"medium"},n.text):ue.a.createElement("div",{className:s.menuBackButtonContainer},ue.a.createElement(be.a,{ref:d,className:s.menuBackButton,appearance:"transparent",onClick:u,icon:ue.a.createElement(dn.r,null),"aria-label":"Back"}),ue.a.createElement("div",{className:s.menuBackButtonText},n.text))),null===(t=n.children)||void 0===t?void 0:t.map((function(e,t){return ue.a.createElement($g,{key:t,ref:0===t?p:void 0,dataNode:e,updatePopoverOpen:r,updateDataNode:i,menuProps:l})}))),(null==h?void 0:h.copilotLabMenuItemText)&&(c||"Category"===(null==n?void 0:n.nodeType))&&ue.a.createElement(ue.a.Fragment,null,ue.a.createElement(oc.a,null),ue.a.createElement(Se.a,{className:s.menuItem,icon:h.iconRegular?h.iconHover?{children:ug(h.iconRegular,h.iconHover)}:{children:dg(h.iconRegular)}:null,onClick:function(e){e.stopPropagation(),r(!1),(null==h?void 0:h.handleOnClickCopilotLab)&&h.handleOnClickCopilotLab("Category"===n.nodeType?n.promptCategory:void 0)}},up()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts")))},$g=Object(ce.forwardRef)((function(e,t){var n=e.dataNode,r=e.updatePopoverOpen,o=e.updateDataNode,i=e.menuProps,a=Zg(),s=n.text,l=void 0===s?"":s,c=n.data,u=n.iconHover,d=n.iconRegular,p=n.children,g=((null==p?void 0:p.length)||0)>0,h=function(e){var t=[],n=[],r=[],o=e.lastIndexOf(")"),i=e.lastIndexOf("(",o),a=e.lastIndexOf("]"),s=e.lastIndexOf("[",a);return o>i&&i>=0?(t.push(e.slice(0,i),e.slice(i,o+1),e.slice(o+1)),n.push(!1,!0,!1),r.push(!1,!1,!1)):a>s&&s>=0?(t.push(e.slice(0,s),e.slice(s,a+1),e.slice(a+1)),n.push(!1,!0,!1),r.push(!1,!0,!1)):(t.push(e),n.push(!1),r.push(!1)),{chunks:t,shouldHighlight:n,shouldGrey:r}}(l),f=h.chunks,m=h.shouldHighlight,v=h.shouldGrey,b=function(e,t,n){i.handleOnClickStarterPromptMenuItem&&i.handleOnClickStarterPromptMenuItem(e,t,n)},y=ue.a.useCallback((function(){if(!p)return r(!1),void b(l,!0,null==c?void 0:c.ciqEntity);o(l||""),b(l,!1,null==c?void 0:c.ciqEntity)}),[c,p,r,o,l]);return ue.a.createElement(Se.a,{ref:t,icon:d?u?{children:ug(d,u)}:{children:dg(d)}:null,hasSubmenu:g,disabled:n.isDisabled,className:a.menuItem,"aria-label":l+(g?", sub menu":""),onClick:y},ue.a.createElement("span",{style:{whiteSpace:"normal"}},f.map((function(e,t){return m[t]&&!n.isDisabled?ue.a.createElement("span",{key:t,className:v[t]?a.greyedText:a.highlightedText},e):ue.a.createElement(ue.a.Fragment,{key:t},e)}))))}));$g.displayName="ViewPromptsMenuItem";var eh,th,nh,rh,oh=Object(pe.a)({root:{backgroundColor:"transparent"}}),ih=Object(pe.a)({root:Object(o.__assign)({marginTop:"".concat(window.innerHeight/3,"px"),position:"relative",backgroundColor:Be.a.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},Me.a.padding("16px"))}),ah=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.border("1px solid")),Me.a.borderColor("transparent")),Me.a.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"})}),sh=Object(pe.a)({root:{backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1,"&:hover":{backgroundColor:"".concat(Be.a.colorBrandForeground1," !important")}}}),lh=Object(pe.a)({root:{backgroundColor:Be.a.colorNeutralBackground1,color:Be.a.colorStrokeFocus2,"&:hover":Object(o.__assign)(Object(o.__assign)({},Me.a.borderColor("".concat(Be.a.colorBrandForeground1))),{backgroundColor:"".concat(Be.a.colorNeutralBackground1," !important")})}}),ch=Object(pe.a)({root:{color:Be.a.colorBrandForeground1,"&:hover":{color:Be.a.colorBrandForeground1},fontSize:"12px"}}),uh=Object(pe.a)({root:{height:"63px",bottom:"12px"}}),dh=Object(pe.a)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),ph=Object(pe.a)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:Be.a.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),gh=Object(pe.a)({root:{fontWeight:"bold",color:Be.a.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),hh=function(e){var t=e.shouldShowMicPermissionRetryDialog,n=e.microphonePermissionErrorTitle,r=e.microphonePermissionErrorMessage,o=e.microphonePermissionErrorImagePath,i=e.showHelpLink,a=e.tryAgainOnClickHandler,s=e.notNowOnClickHandler,l=Object(x.a)(ah().root,sh().root),c=Object(x.a)(ah().root,lh().root),u=ph().root,d=Object(x.a)(u,gh().root),p=ch().root,g=uh().root,h=Object(ce.useRef)(null);return Object(ce.useEffect)((function(){var e;t&&(null===(e=h.current)||void 0===e||e.focus())}),[t]),ue.a.createElement(le.a,{className:oh().root},ue.a.createElement(tt.a,{modalType:"modal",open:t},ue.a.createElement(nt.a,{className:ih().root,tabIndex:0},ue.a.createElement(rt.a,null,ue.a.createElement(ot.a,{className:d},n),ue.a.createElement(at.a,null,o&&ue.a.createElement(De.a,{className:g,alt:"",src:o,width:"252px",height:"51px"}),ue.a.createElement(ye.a,{className:u},r),i&&ue.a.createElement(on.a,{inline:!0,className:p,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},up()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?")),ue.a.createElement(Rn.a,{className:dh().root},ue.a.createElement(it.a,{disableButtonEnhancement:!0},ue.a.createElement(be.a,{ref:h,className:c,appearance:"secondary",onClick:s},up()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now")),ue.a.createElement(be.a,{className:l,appearance:"primary",onClick:a},up()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again"))))))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(eh||(eh={}));var fh,mh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},Me.a.borderRadius("8px")),Me.a.borderColor(Be.a.colorNeutralBackground1)),(th={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},th["&:hover .".concat(gn.a.icon)]={color:Be.a.colorBrandForeground1},th["&:hover:active .".concat(gn.a.icon)]={color:Be.a.colorBrandForeground1},th.display="flow",th))}),vh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},Me.a.borderRadius("50%")),(nh={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Be.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Be.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Be.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},nh["&.".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},nh["&:hover .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},nh["&:active .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},nh["&:hover:active .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},nh["&:hover"]={backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},nh["&:hover:active"]={backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},nh["@media (forced-colors: active)"]={forcedColorAdjust:"none"},nh))}),bh=Object(pe.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),yh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground3},Me.a.borderRadius("50%")),{color:Be.a.colorBrandForeground1}),loader:Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralBackground1},Me.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Be.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Ch=Object(pe.a)({root:(rh={},rh["&:hover .".concat(gn.a.icon)]={color:Be.a.colorNeutralForegroundDisabled},rh["&:hover:active .".concat(gn.a.icon)]={color:"".concat(Be.a.colorNeutralForegroundDisabled," !important")},rh)}),Oh=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(ce.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(!1),2),l=s[0],c=s[1];Object(ce.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(f.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(ce.useEffect)((function(){n.microphoneState===eh.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===eh.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(ce.useEffect)((function(){t?g(m.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(ce.useRef)(mh()),d=Object(o.__read)(Object(ce.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(ce.useRef)(Object(x.a)(u.current.root,yh().root)),f=Object(ce.useRef)(Object(x.a)(u.current.root,vh().root)),m=Object(ce.useRef)(Object(x.a)(u.current.root,Ch().root)),v=ue.a.createElement(be.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case eh.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case eh.Disabled:case eh.Uninitialized:return"Microphone Disabled";case eh.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?ue.a.createElement(qc.a,{title:"Mic-Filled"}):ue.a.createElement(qc.b,{title:"Mic-Regular"}),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return ue.a.createElement("div",{className:bh().root},n.isTooltipDisabled?v:ue.a.createElement(me.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},v),i&&ue.a.createElement("div",{className:yh().loader}),ue.a.createElement(hh,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},Sh=n(892),Eh=n(2800),xh=n(1466),Ih=n(2821),wh=n(2822);!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(fh||(fh={}));var Th,kh,jh,Ph,Ah=fh.web,_h=function(){return Ah===fh.IOS},Dh=function(){function e(e,t){this.entityPluginRef=e,this.controlRef=t}return e.prototype.renderAndTrackSelectedSuggestion=function(e,t,n,r,o,i){var a,s=e.suggestion;s&&(null===(a=this.entityPluginRef.current)||void 0===a||a.insertChatInputEntity({text:s.text,data:s}))},e.prototype.generatCopilotOdslSignalLinks=function(e){var t,n,r=null===(t=this.controlRef.current)||void 0===t?void 0:t.getInputText().trim();if(r){var o=(null===(n=this.entityPluginRef.current)||void 0===n?void 0:n.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.url)})).map((function(e){var t=r.indexOf(e.text);return{type:"URL",range:[t,t+e.text.length-1],value:e.data.url}}));if(!(o.length<=0))return o}},e.prototype.generateQueryAnnotations=function(e){var t,n=(null===(t=this.entityPluginRef.current)||void 0===t?void 0:t.getActiveEntities()).filter((function(e){var t;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.queryAnnotation)})).map((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.queryAnnotation}));if(!(n.length<=0))return n},e.prototype.setHVCAppChatV2Enabled=function(e){},e}(),Lh=n(240),Mh=n(53),Bh=n(2819),Rh=n(2820),Fh=function(e){var t=Object(o.__read)(Object(Lh.useLexicalComposerContext)(),1)[0],n=e.ciqPlaceholderText,r=e.entityPluginRef,i=e.queryCharacter,a=ce.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,a,s,l,c,u;return Object(o.__generator)(this,(function(o){return n?(e=Object(Mh.$getSelection)(),Object(Mh.$isRangeSelection)(e)&&e.isCollapsed()?(t=e.getNodes()[0],Object(Mh.$isTextNode)(t)&&t.isSimpleText()?(r=t.getTextContent(),a=e.getCharacterOffsets()[0],s=r[a-1]===i,l=1===a||""===(null===(u=r[a-2])||void 0===u?void 0:u.trim()),c=a===r.length||""===r[a].trim(),s&&l&&c?[2,"​‌"+n+"​‌"]:[2,void 0]):[2,void 0]):[2,void 0]):[2,void 0]}))}))}),[n,i]);return ce.useEffect((function(){return t.registerNodeTransform(Mh.TextNode,(function(e){if(!e.getPreviousSibling()){var t=e.getTextContent();t.length>0&&t[0]===i&&e.insertBefore(Object(Mh.$createTextNode)(" "))}}))}),[t,i]),ce.createElement(ce.Fragment,null,ce.createElement(Bh.a,{id:"ciq",controlRef:r}),ce.createElement(Rh.a,{id:"ciqGhostText",$getGhostText:a}))},Nh=n(1494),Hh=n(293),Uh=n(1088),Vh=function(e){var t=e.closingMarker,n=void 0===t?"}":t,r=e.onChatInputTokenAdded,i=e.onChatInputTokenDeleted,a=e.openingMarker,s=void 0===a?"{":a,l=e.tokenPhrases,c=void 0===l?[]:l,u=e.tokenListPhrases,d=void 0===u?[]:u,p=e.useSortedTokenList,g=void 0!==p&&p,h=Object(o.__read)(Object(Lh.useLexicalComposerContext)(),1)[0];g&&function(e){e.sort((function(e,t){var n=e.join(""),r=t.join("");return n<r?-1:n>r?1:n.length-r.length}))}(d);var f=ce.useRef(!1),m=ce.useCallback((function(e){var t,r,i=e.endIndex,a=e.node,l=e.startIndex,c=e.text;f.current=!0;var u=Object(Eh.a)(c),d=a.splitText(l,i),p=0,g=a,h=0;try{for(var m=Object(o.__values)(d),v=m.next();!v.done;v=m.next()){var b=v.value;if(p++,h+=b.getTextContent().length,b.getTextContent().toLowerCase()===c.toLowerCase()||b.getTextContent().toLowerCase()===s+c.toLowerCase()+n){b.replace(u);break}}}catch(e){t={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(t)throw t.error}}return p<d.length&&(g=d[p]),Object(Mh.$isRootOrShadowRoot)(u.getParentOrThrow())&&Object(Hh.$wrapNodeInElement)(u,Mh.$createParagraphNode).selectEnd(),{updatedNode:g,nodeOffset:h}}),[n,s]);return Object(Uh.a)((function(){return Object(Hh.mergeRegister)(h.registerMutationListener(Eh.c,(function(e,t){var n,a,s=function(e,n){"destroyed"===n?t.prevEditorState.read((function(){var t=Object(Mh.$getNodeByKey)(e);Object(Eh.b)(t)&&(f.current=!1,null==i||i(t.getTextContent()),h.update((function(){var e,t=Object(Mh.$getRoot)().getFirstChild();Object(Mh.$isElementNode)(t)&&(null===(e=t.getChildren())||void 0===e||e.forEach((function(e){Object(Eh.b)(e)&&e.replace(Object(Mh.$createTextNode)(e.getTextContent()))})))})),h.update((function(){Object(Mh.$getRoot)().getAllTextNodes().forEach((function(e){return e.markDirty()}))})))})):"created"===n&&h.getEditorState().read((function(){var t,n=Object(Mh.$getNodeByKey)(e);if(Object(Eh.b)(n)){f.current=!0;var o="",i=Object(Mh.$getRoot)().getFirstChild();Object(Mh.$isElementNode)(i)&&(null===(t=i.getChildren())||void 0===t||t.forEach((function(e){Object(Eh.b)(e)&&(o+=e.getTextContent())}))),null==r||r(o)}}))};try{for(var l=Object(o.__values)(e),c=l.next();!c.done;c=l.next()){var u=Object(o.__read)(c.value,2);s(u[0],u[1])}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}})))}),[h]),ce.useEffect((function(){return h.registerNodeTransform(Mh.TextNode,(function(e){var t,r,i,a;if(!f.current){var l=e.getTextContent(),u=l.indexOf(s),p=l.indexOf(n,u);if(-1!==u&&-1!==p){var g=l.substring(u+1,p);""!==g&&m({node:e,startIndex:u,endIndex:p+1,text:g})}else if(d.length>0){var h=function(t){var n,r,i=0,a=t.every((function(e){var t=e(),n=l.toLocaleLowerCase().indexOf(t.toLocaleLowerCase(),i);return-1!==n&&(i=n+t.length,!0)}));if(a){var s=0,c=0;try{for(var u=(n=void 0,Object(o.__values)(t)),d=u.next();!d.done;d=u.next()){var p=(0,d.value)(),g=l.toLocaleLowerCase().indexOf(p.toLocaleLowerCase(),c);c=g+p.length-s;var h=m({node:e,startIndex:g-s,endIndex:c,text:p});e=h.updatedNode,s+=h.nodeOffset}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return{value:void 0}}};try{for(var v=Object(o.__values)(d),b=v.next();!b.done;b=v.next()){var y=h(b.value);if("object"==typeof y)return y.value}}catch(e){t={error:e}}finally{try{b&&!b.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}}else try{for(var C=Object(o.__values)(c),O=C.next();!O.done;O=C.next()){var S=(0,O.value)(),E=l.toLocaleLowerCase().indexOf(S.toLocaleLowerCase());if(-1!==E)return void m({node:e,startIndex:E,endIndex:E+S.length,text:S})}}catch(e){i={error:e}}finally{try{O&&!O.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}}}))}),[m,n,h,s,c]),null},zh=function(){},Gh=function(e,t){var n=e.chatInputContainerTitle,r=void 0===n?hp():n,i=e.ciqButtonTitle,a=void 0===i?xp():i,s=e.copilotChatTheme,l=e.editorProps,c=e.groundingButtonPluginProps,u=e.groundingSourcePickerProps,d=e.handleChatInputLoad,p=void 0===d?zh:d,g=e.handleFirstUserInput,h=void 0===g?zh:g,f=e.handleOnBlur,m=e.handleOnChatInputControlMount,v=e.handleOnChatInputControlUnmount,b=e.handleOnInput,y=e.handleSubmitButtonClick,C=e.isCIQButtonEnabled,O=void 0!==C&&C,S=e.isDarkMode,E=e.isDisabled,x=e.isMenuButtonEnabled,I=void 0!==x&&x,w=e.isGroundingButtonEnabled,T=void 0!==w&&w,k=e.isSensitivityIndicatorLoading,j=e.isSubmitButtonDisabled,P=e.maxInputCharLimit,A=void 0===P?2e3:P,_=e.menuButtonTitle,D=void 0===_?fp():_,L=e.overrideStyles,M=e.placeholderText,B=void 0===M?vp():M,R=e.promptGuideMenuProps,F=e.shouldBlockGroundingButtonClick,N=void 0===F?function(){return!1}:F,H=e.shouldBlockSubmitButtonClick,U=void 0===H?function(){return!1}:H,V=e.submitButtonTitle,z=void 0===V?mp():V,G=e.voiceInputProps,W=e.chatInputBannerProps,Q=e.hvcPromptStrings,q=e.hvcPromptStringsList,K=e.isHVCAppChatV2Enabled,Y=e.onChatInputHVCPromptUpdated,Z=e.useSortedHVCTokenList,J=Object(o.__read)(ce.useState(!1),2),X=J[0],$=J[1],ee=Object(o.__read)(ce.useState(!1),2),te=ee[0],ne=ee[1],re=Object(o.__read)(ce.useState(!1),2),oe=re[0],ie=re[1],ae=Object(o.__read)(ce.useState(B),2),se=ae[0],le=ae[1],ue=Object(o.__read)(ce.useState(!0),2),de=ue[0],pe=ue[1],ge=ce.useRef(),he=ce.useRef(),fe=ce.useRef(!0),me=ce.useRef(!0),ve=ce.useRef(null),be=ce.useRef(null),ye=ce.useRef(null);ce.useImperativeHandle(t,(function(){return{addImage:function(e){},removeImages:function(){},getImages:function(){return[]},setInputText:function(e){var t;null===(t=be.current)||void 0===t||t.setInputText(e)},updateInputText:function(e,t){var n,r,o;switch(t){case $d.InsertAtCursor:e!==Fu||fe.current||null===(n=be.current)||void 0===n||n.insertTextAtCursor(Ep),null===(r=be.current)||void 0===r||r.insertTextAtCursor(e);break;case $d.Replace:null===(o=be.current)||void 0===o||o.setInputText(e)}},getInputText:function(){var e;return null===(e=be.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){return ye.current},setGhostText:function(e){},getGhostText:function(){var e;return null===(e=Te.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=ye.current)||void 0===e||e.focus()},closeMenu:function(){I&&X&&$(!1),T&&te&&ne(!1),ke&&je.current&&Ae(!1)},getCIQTextRef:function(){return Ee.current},getChatEditorInstance:function(){return Oe},getCIQResponseHandler:function(){return Se}}})),ce.useEffect((function(){le(B)}),[B]),ce.useEffect((function(){var e;he.current&&(null===(e=ve.current)||void 0===e||e.setTarget(he.current))}),[ve,he]);var Ce=function(e){var t,n=e.chatInputRef,r=e.controlRef,i=e.copilotChatTheme,a=e.editorProps,s=e.isDarkMode,l=e.isSensitivityIndicatorLoading,c=e.languageSupportsSpace,u=Object(o.__read)(ce.useState(void 0),2),d=u[0],p=u[1],g=Object(o.__read)(ce.useState(void 0),2),h=g[0],f=g[1],m=Object(o.__read)(ce.useState(!1),2),v=m[0],b=m[1],y=ce.useRef(),C=ce.useRef(),O=ce.useRef();ce.useEffect((function(){s?d&&d.updateCurrentTheme(hu.dark):d&&d.updateCurrentTheme(hu.light)}),[s,d]),ce.useEffect((function(){(null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!y.current&&(null==a?void 0:a.alSession)&&b(!0)}),[null==a?void 0:a.alSession,null==a?void 0:a.handleInChatInput,null==a?void 0:a.editorConfig]),ce.useEffect((function(){return function(){y.current&&y.current.shutdown().then((function(){y.current=void 0}))}}),[]),ce.useEffect((function(){if(v){var e=(new Wd).createInstance();e.bootstrap(dp(a.editorConfig,a.alSession)).then((function(t){y.current=e,p(t)}))}}),[v]),ce.useEffect((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!h&&d&&n.current){var e=new Dh(O,r);d.initializeCiq(n.current,{menuTitle:null==a?void 0:a.editorConfig.transformFileMenuTitle,menuSubtitle:(null==a?void 0:a.editorConfig.transformFilePlaceholderText)?null==a?void 0:a.editorConfig.transformFilePlaceholderText:bp,queryCharToUse:Fu,onItemSelected:function(t){var o,u;null===(o=n.current)||void 0===o||o.focus(),e.renderAndTrackSelectedSuggestion(t,null,l,i,s,C),c.current&&(null===(u=r.current)||void 0===u||u.insertTextAtCursor(Ep)),a.postCIQItemSelectionHandler&&a.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==a?void 0:a.editorConfig.entitiesSupported,ExpanededECC:null==a?void 0:a.editorConfig.isExpandedECCEnabled}),f(e)}}),[d,h]);var S=d?ce.createElement(Fh,{queryCharacter:Fu,ciqPlaceholderText:null===(t=null==a?void 0:a.editorConfig)||void 0===t?void 0:t.ciqPlaceholderText,entityPluginRef:O}):null;return{chatEditor:d,ciqResponseHandler:h,ciqTextRef:C,ciqPlugin:S}}({chatInputRef:ye,controlRef:be,copilotChatTheme:s,editorProps:l,isDarkMode:S,isSensitivityIndicatorLoading:k,languageSupportsSpace:fe}),Oe=Ce.chatEditor,Se=Ce.ciqResponseHandler,Ee=Ce.ciqTextRef,xe=Ce.ciqPlugin,Ie=function(e){var t=e.chatInputRef,n=e.controlRef,r=e.handleChatInputLoad,i=e.isDisabled,a=e.languageSupportsSpace,s=e.maxInputCharLimit,l=e.placeholderText,c=e.voiceInputProps,u=Object(o.__read)(ce.useState(!1),2),d=u[0],p=u[1],g=Object(o.__read)(ce.useState(eh.Uninitialized),2),h=g[0],f=g[1],m=Object(o.__read)(ce.useState(!1),2),v=m[0],b=m[1],y=ce.useRef(null==c?void 0:c.alSession),C=ce.useRef(!1),O=ce.useRef(null),S=!(!(null==c?void 0:c.handleInChatInput)||!(null==c?void 0:c.alSession)&&!(null==c?void 0:c.alSessionConfig)),E=ce.useCallback((function(e){var t,r,o,i,s,l;if(e){var c=(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>0&&a.current?Ep:bp;null===(r=O.current)||void 0===r||r.setGhostText(c+Sp())}else{var u=null===(i=null===(o=O.current)||void 0===o?void 0:o.getGhostText())||void 0===i?void 0:i.trim();u&&""!==u&&u!==Sp()?null===(s=O.current)||void 0===s||s.commitGhostText(u):null===(l=O.current)||void 0===l||l.cancelGhostText()}p(e),C.current=e}),[l]);ce.useEffect((function(){var e;d||Object(ep.d)(E).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=t.current)||void 0===e||e.focus()}),[d]);var x=ce.useCallback((function(e){var r,o,l,c,u;if(C.current&&S&&!i&&!((null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>=s)){var d=(null===(o=n.current)||void 0===o?void 0:o.getInputText().length)>0&&a?Ep:bp;null===(l=O.current)||void 0===l||l.commitGhostText(d+e),null===(c=t.current)||void 0===c||c.focus(),null===(u=n.current)||void 0===u||u.scrollToBottom()}}),[S,i,s]),I=ce.useCallback((function(e){var t,r,o,l;if(C.current&&S&&!i&&!(null!=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>=s)){var c=(null===(r=n.current)||void 0===r?void 0:r.getInputText().length)>0&&a?Ep:bp;null===(o=O.current)||void 0===o||o.setGhostText(c+e),null===(l=n.current)||void 0===l||l.scrollToBottom(),e.trim()&&Object(ep.e)(Op,E)}}),[S,i,s,E]),w=ce.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return null!=y.current?[3,4]:(e=y,null===(r=c.alSession)||void 0===r?[3,1]:(t=r,[3,3]));case 1:return[4,pp(null==c?void 0:c.alSessionConfig)];case 2:t=o.sent(),o.label=3;case 3:e.current=t,o.label=4;case 4:return y.current?(n=Object(tp.a)(c.voiceInputLocale),[4,Object(ep.a)(n,x,I,f,E,y.current)]):[3,6];case 5:o.sent(),a.current=Object(tp.b)(Object(tp.a)(n)),o.label=6;case 6:return[2]}}))}))}),[I,x,E,null==c?void 0:c.alSession,null==c?void 0:c.alSessionConfig,null==c?void 0:c.voiceInputLocale]);ce.useEffect((function(){r()}),[]),ce.useEffect((function(){S&&w()}),[S,w]);var T=S?{isMicrophoneListening:d,microphoneState:h,handleMicrophoneButtonOnClick:function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s,c,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),d?((null===(r=O.current)||void 0===r?void 0:r.getGhostText())!=bp&&(null===(i=O.current)||void 0===i?void 0:i.getGhostText())!=l&&(null===(s=null===(a=O.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Sp()&&(null===(c=O.current)||void 0===c||c.commitGhostText(null===(u=O.current)||void 0===u?void 0:u.getGhostText())),[4,Object(ep.d)(E)]):[3,3];case 2:return o.sent(),[3,6];case 3:return h===eh.Uninitialized&&f(eh.Loading),[4,Nh.a.GetInstance().Resume()];case 4:return o.sent(),b(!1),E(!d),f(eh.Enabled),[4,Object(ep.e)(Op,E)];case 5:o.sent(),o.label=6;case 6:return[3,10];case 7:return t=o.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Nh.a.GetInstance().Pause()];case 8:o.sent(),b(!0),o.label=9;case 9:return f(eh.Uninitialized),[2];case 10:return[2]}}))}))},micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:v,microphonePermissionErrorTitle:null==c?void 0:c.microphonePermissionErrorTitle,microphonePermissionErrorMessage:null==c?void 0:c.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){Object(ep.b)(d,Op,b,f,E)},notNowOnClickHandler:function(){b(!1)},microphonePermissionErrorImagePath:null==c?void 0:c.microphonePermissionImagePath,showHelpLink:null==c?void 0:c.showMicrophonePermissionHelpLink},isTooltipDisabled:!0}:null==c?void 0:c.microphoneButtonProps;return{getMicrophoneLiveRegionText:function(){if(T)switch(null==T?void 0:T.microphoneState){case eh.Enabled:return T.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case eh.Disabled:case eh.Uninitialized:return"Microphone Disabled";case eh.Loading:return"Microphone Loading";default:return}},ghostTextRef:O,handleVoiceInChatInput:S,isMicrophoneActive:C,microphoneProps:T,setMicrophoneListeningStatus:E}}({chatInputRef:ye,controlRef:be,handleChatInputLoad:p,isDisabled:E,languageSupportsSpace:fe,maxInputCharLimit:A,placeholderText:B,voiceInputProps:G}),we=Ie.getMicrophoneLiveRegionText,Te=Ie.ghostTextRef,ke=Ie.handleVoiceInChatInput,je=Ie.isMicrophoneActive,Pe=Ie.microphoneProps,Ae=Ie.setMicrophoneListeningStatus;return ce.useEffect((function(){return m&&m(),function(){v&&v()}}),[m,v]),{isDisabled:E,isGroundingSourcePickerEnabled:!T&&void 0!==u,isPromptGuideMenuButtonEnabled:I&&void 0!==R,isCIQButtonEnabled:O,isGroundingButtonEnabled:T&&void 0!==c,isChatFooterDividerEnabled:I&&void 0!==R||O||T,isVoiceInputEnabled:void 0!==G,themeWrapper:{isDarkMode:S,themePalette:s},chatInputContainer:{id:Cp,onBlur:function(){var e;_h()&&!X&&(null===(e=be.current)||void 0===e?void 0:e.getInputText())===bp&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return f(),[2]}))}))}),100)},ref:he},groundingSourcePicker:Object(o.__assign)(Object(o.__assign)({},u),{isChatInputV3Enabled:!0,isChatInputBannerVisible:void 0!==W,isDisabled:!(null==u?void 0:u.alwaysEnable)&&E,onSelection:function(e){var t;le(e.placeholderText),null===(t=null==u?void 0:u.onSelection)||void 0===t||t.call(u,e)}}),chatInputBannerProps:W?Object(o.__assign)(Object(o.__assign)({},W),{isInputV3Enabled:!0}):void 0,chatInputContainerTooltip:{content:r,onVisibleChange:function(e,t){e&&"focus"===e.type?ie(!1):ie(t.visible)},positioning:"above",relationship:"label",visible:oe,withArrow:!0},promptGuideMenuButton:{isDisabled:E,isMenuOpen:X,setMenuOpen:$,positioningRef:ve,promptGuideMenuProps:R,title:D},ciqButton:{handleClick:function(){var e;null===(e=be.current)||void 0===e||e.setInputText("/")},isDisabled:E,title:a},groundingButton:{isDisabled:E,isMenuOpen:te,groundingButtonPluginProps:c,setMenuOpen:ne,shouldBlockGroundingButtonClick:N,targetRef:null==ge?void 0:ge.current,title:Ip()},chatFooterDivider:{appearance:"strong",vertical:!0},voiceInputTooltip:{content:we(),positioning:"above",relationship:"label",withArrow:!0},ariaLiveSpan:{"aria-live":"assertive",role:"alert"},microphoneButton:{"aria-live":"assertive",isDisabled:E,microphoneButtonProps:Pe},faiChatInput:{actions:{ref:ge},className:null==L?void 0:L.userInput,customNodes:[Sh.c,Eh.c,xh.c],disableSend:E||j||de,disabled:E,editor:{"aria-label":"Prompt"},maxLength:A,onChange:function(e,t){me.current&&(h(),me.current=!1);var n=t.value;pe(!n||""===n.trim())},onInput:b,onSubmit:function(e){var t,n,r,o;if(!(null==U?void 0:U())){e.stopPropagation(),ke&&Ae(!1);var i=null===(n=null===(t=be.current)||void 0===t?void 0:t.getInputText())||void 0===n?void 0:n.trim();if(void 0!==i&&i.trimStart()!==bp&&!E){var a=be.current?null==Se?void 0:Se.generateQueryAnnotations(ye.current):void 0;y(i,a),null===(r=be.current)||void 0===r||r.setInputText(bp),null===(o=Te.current)||void 0===o||o.cancelGhostText()}}},placeholderValue:se,ref:ye,send:{title:z},characterLimitErrorMessage:e.characterLimitErrorMessage,children:ce.createElement(ce.Fragment,null,ce.createElement(Ih.a,{ref:be}),ce.createElement(wh.a,{id:"voiceInputGhostText",ref:Te}),xe,K?ce.createElement(Vh,{languageSupportsSpace:fe,tokenPhrases:Q,tokenListPhrases:q,useSortedTokenList:Z,onChatInputTokenAdded:function(e){Y&&Y(e,!0)},onChatInputTokenDeleted:function(e){Y&&Y(e,!1)}}):void 0)}}},Wh={chatInputOuterContainer:Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius(Be.a.borderRadiusXLarge)),Me.a.margin(0,"16px","16px","16px")),chatInputContainer:{color:Be.a.colorNeutralForeground1,position:"relative",zIndex:"1"},faiChatInputWithGrounding:{borderTopLeftRadius:0,borderTopRightRadius:0}},Qh=Object(pe.a)(Wh),qh=ce.forwardRef((function(e,t){var n=Gh(e,t);return function(e){var t=Qh(),n=e.isDisabled,r=e.overrideStyles,o=e.isGroundingSourcePickerEnabled,i=e.chatInputBannerProps;e.themeWrapper.className=Object(x.a)(t.chatInputOuterContainer,!n&&(null==r?void 0:r.chatInputOuterContainer),e.themeWrapper.className),e.chatInputContainer.className=Object(x.a)(t.chatInputContainer,!n&&(null==r?void 0:r.chatInput),e.chatInputContainer.className),e.faiChatInput.className=Object(x.a)((o||i)&&t.faiChatInputWithGrounding,e.faiChatInput.className),e.ariaLiveSpan.className=Object(x.a)(!n&&(null==r?void 0:r.ariaLiveSpan),e.ariaLiveSpan.className)}(n),function(e){var t=e.ariaLiveSpan,n=e.chatFooterDivider,r=e.chatInputContainer,i=e.ciqButton,a=e.faiChatInput,s=e.groundingButton,l=e.groundingSourcePicker,c=e.isCIQButtonEnabled,u=e.isChatFooterDividerEnabled,d=e.isGroundingButtonEnabled,p=e.isGroundingSourcePickerEnabled,g=e.isPromptGuideMenuButtonEnabled,h=e.isVoiceInputEnabled,f=e.microphoneButton,m=e.promptGuideMenuButton,v=e.themeWrapper,b=e.voiceInputTooltip,y=e.chatInputBannerProps;return ce.createElement(cg,Object(o.__assign)({},v),ce.createElement("div",Object(o.__assign)({},r),y&&ce.createElement(sp,Object(o.__assign)({},y)),p&&ce.createElement(Yg,Object(o.__assign)({},l)),ce.createElement(og.a,Object(o.__assign)({},a,{actions:Object(o.__assign)(Object(o.__assign)({},a.actions),{children:ce.createElement("span",{style:{display:"flex",alignItems:"center"}},g&&ce.createElement(Jg,Object(o.__assign)({},m)),c&&ce.createElement(op,Object(o.__assign)({},i)),d&&ce.createElement(Dg,Object(o.__assign)({},s)),u&&ce.createElement(np.a,Object(o.__assign)({},n)),h&&ce.createElement(me.a,Object(o.__assign)({},b),ce.createElement("span",Object(o.__assign)({},t),ce.createElement(Oh,Object(o.__assign)({},f)))))})}))))}(n)}));qh.displayName="ChatInput",function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Th||(Th={}));var Kh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},Me.a.borderRadius("8px")),Me.a.borderColor(Be.a.colorNeutralBackground1)),(kh={backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px"},kh["&:hover .".concat(gn.a.icon)]={color:Be.a.colorBrandForeground1},kh["&:hover:active .".concat(gn.a.icon)]={color:Be.a.colorBrandForeground1},kh.display="flow",kh))}),Yh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},Me.a.borderRadius("50%")),(jh={animationName:[{"0%":{boxShadow:"0 0 0 0 ".concat(Be.a.colorBrandBackground2)},"60%":{boxShadow:"0 0 0 5px ".concat(Be.a.colorBrandBackground2)},"100%":{boxShadow:"0 0 0 0 ".concat(Be.a.colorBrandBackground2)}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite"},jh["&.".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},jh["&:hover .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},jh["&:active .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},jh["&:hover:active .".concat(gn.a.icon)]={color:Be.a.colorNeutralBackground1},jh["&:hover"]={backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},jh["&:hover:active"]={backgroundColor:Be.a.colorBrandForeground1,color:Be.a.colorNeutralBackground1},jh["@media (forced-colors: active)"]={forcedColorAdjust:"none"},jh))}),Zh=Object(pe.a)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),Jh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground3},Me.a.borderRadius("50%")),{color:Be.a.colorBrandForeground1}),loader:Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralBackground1},Me.a.borderRadius("50%")),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:Be.a.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Xh=Object(pe.a)({root:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground4},Me.a.borderColor(Be.a.colorNeutralBackground4)),(Ph={"&:hover":Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground4},Me.a.borderColor(Be.a.colorNeutralBackground4))},Ph["&:hover .".concat(gn.a.icon)]={color:Be.a.colorNeutralForegroundDisabled},Ph["&:hover:active .".concat(gn.a.icon)]={color:"".concat(Be.a.colorNeutralForegroundDisabled," !important")},Ph))}),$h=function(e){var t=e.isDisabled,n=e.microphoneButtonProps,r=Object(o.__read)(Object(ce.useState)(!1),2),i=r[0],a=r[1],s=Object(o.__read)(Object(ce.useState)(!1),2),l=s[0],c=s[1];Object(ce.useEffect)((function(){n.isMicrophoneListening?(a(!1),g(f.current)):g(u.current.root)}),[n.isMicrophoneListening]),Object(ce.useEffect)((function(){n.microphoneState===Th.Loading?(a(!0),g(h.current)):(a(!1),n.microphoneState===Th.Uninitialized&&g(u.current.root))}),[n.microphoneState]),Object(ce.useEffect)((function(){t?g(m.current):n.isMicrophoneListening||g(u.current.root)}),[t]);var u=Object(ce.useRef)(Kh()),d=Object(o.__read)(Object(ce.useState)(u.current.root),2),p=d[0],g=d[1],h=Object(ce.useRef)(Object(x.a)(u.current.root,Jh().root)),f=Object(ce.useRef)(Object(x.a)(u.current.root,Yh().root)),m=Object(ce.useRef)(Object(x.a)(u.current.root,Xh().root)),v=ue.a.createElement(be.a,{className:p,title:n.title,"aria-label":function(){switch(n.microphoneState){case Th.Enabled:return n.isMicrophoneListening?"Microphone Listening":"Microphone Paused";case Th.Disabled:case Th.Uninitialized:return"Microphone Disabled";case Th.Loading:return"Microphone Loading"}}(),role:"switch","aria-checked":n.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},icon:n.isMicrophoneListening||l||i?ue.a.createElement(qc.a,{title:"Mic-Filled"}):ue.a.createElement(qc.b,{title:"Mic-Regular"}),onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return n.handleMicrophoneButtonOnClick(event),[2]}))}))},disabled:t});return ue.a.createElement("div",{className:Zh().root},n.isTooltipDisabled?v:ue.a.createElement(me.a,{content:n.title,relationship:"label",positioning:"above",withArrow:!0},v),i&&ue.a.createElement("div",{className:Jh().loader}),ue.a.createElement(hh,{microphonePermissionErrorImagePath:n.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:n.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:n.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:n.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:n.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:n.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:n.micPermissionRetryDialogProps.showHelpLink}))},ef=Object(pe.a)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),tf=function(e){var t=e.children,n=e.style,r=e.horizontal,i=void 0!==r&&r,a=e.reverse,s=void 0!==a&&a,l=e.customProperties,c=function(e,t,n,r){var o=e.root;return t&&(o=Object(x.a)(o,t)),n?o=r?Object(x.a)(o,e.horizontalReverse):Object(x.a)(o,e.horizontal):r&&(o=Object(x.a)(o,e.verticalReverse)),o}(ef(),n,i,s);return ce.createElement("div",Object(o.__assign)({className:c},l),t)},nf={chatInputOuterContainer:Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius(Be.a.borderRadiusXLarge)),Me.a.margin(0,"16px","16px","16px")),chatInput:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralForeground1,backgroundColor:Be.a.colorNeutralBackground1},Me.a.border("1px","solid",Be.a.colorNeutralStroke1)),Me.a.borderRadius(Be.a.borderRadiusXLarge)),Me.a.padding("4px")),Me.a.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object(o.__assign)(Object(o.__assign)({},Me.a.margin("12px","12px","4px","12px")),{maxHeight:"168px",overflowY:"auto"}),userInput:{},chatInputButtons:Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground1,width:"100%",flexDirection:"row",flexWrap:"wrap"},Me.a.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputCharCount:{},chatInputLeftButtons:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralForeground4,alignSelf:"flex-start"},Me.a.margin("12px","12px","4px","12px")),Me.a.gap("6px")),{fontStyle:"normal",fontSize:"10px",justifyItems:"center"}),chatInputRightButtons:{display:"flex",flexDirection:"row",alignSelf:"flex-end"},contextualMenu:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column",alignItems:"flex-start"},Me.a.padding("6px")),{backgroundColor:Be.a.colorNeutralBackground1,boxShadow:Be.a.shadow4}),Me.a.borderRadius("8px")),chatInputCharCountError:{position:"absolute",left:"-9999px"}},rf=Object(pe.a)(nf),of=Object(pe.a)({chatInput:{":focus-within":{"::after":Object(o.__assign)(Object(o.__assign)({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},Me.a.borderRadius(0,0,"8px","8px")),{backgroundImage:"linear-gradient(to right, ".concat(Be.a.colorBrandForeground1,", ").concat(Be.a.colorCompoundBrandForeground1Hover,")")})}}}),af=Object(pe.a)({chatInput:{backgroundColor:Be.a.colorNeutralBackground4},chatInputButtons:{backgroundColor:Be.a.colorNeutralBackground4},chatInputCharCount:{userSelect:"none","@media (forced-colors: active)":{forcedColorAdjust:"none"}}});var sf,lf=function(e){var t,n,r,o=e.title,i=e.isDisabled,a=e.handleClick;return ue.a.createElement(me.a,{content:o,relationship:"label",withArrow:!0,positioning:"above"},ue.a.createElement(be.a,{"aria-label":o,appearance:"transparent",role:"button",icon:{children:(t=Mt.h,n=Mt.g,r=Object(Ee.a)(n,t),ue.a.createElement(r,null))},onClick:a,disabled:i}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(sf||(sf={}));var cf=function(){function e(e,t,n,r,i,a,s,l,c,u,d,p){var g=this;this.onTryAgainClicked=function(){(new Date).getTime(),Object(ep.b)(g.isMicrophoneListening,Op,g.setShouldShowMicrophonePermissionRetryDialog,g.setMicrophoneState,g.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(o.__awaiter)(g,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u,d;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),this.isMicrophoneListening?((null===(r=this.chatInputRef.current)||void 0===r?void 0:r.getGhostText())!=bp&&(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=this.chatPlaceHolderMessage&&(null===(s=null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())!=Sp()&&(null===(l=this.chatInputRef.current)||void 0===l||l.setInputText((null===(c=this.chatInputRef.current)||void 0===c?void 0:c.getInputText())+(null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getGhostText())),null===(d=this.chatInputRef.current)||void 0===d||d.setGhostText("")),[4,Object(ep.d)(this.setMicrophoneListeningStatus)]):[3,3];case 2:return o.sent(),[3,6];case 3:return this.microphoneState===sf.Uninitialized&&this.setMicrophoneState(sf.Loading),(new Date).getTime(),[4,Nh.a.GetInstance().Resume()];case 4:return o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(sf.Enabled),[4,Object(ep.e)(Op,this.setMicrophoneListeningStatus)];case 5:o.sent(),o.label=6;case 6:return[3,10];case 7:return t=o.sent(),n="Error occurred while fetching mic permissions - : ".concat(t),console.error(n),"ErrorAudioPermissionDeniedError"!=t?[3,9]:[4,Nh.a.GetInstance().Pause()];case 8:o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),o.label=9;case 9:return this.setMicrophoneState(sf.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=r,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}();var uf=ue.a.forwardRef((function(e,t){var n=e.isDisabled,r=e.isSubmitButtonDisabled,i=e.copilotChatTheme,a=void 0===i?sg.palette:i,s=e.isDarkMode,l=e.dir,c=void 0===l?void 0:l,u=e.overrideStyles,d=e.chatInputTabIndex,p=void 0===d?0:d,g=e.chatInputContainerTabIndex,h=void 0===g?-1:g,f=e.chatInputContainerTitle,m=void 0===f?hp():f,v=e.placeholderText,b=void 0===v?vp():v,y=e.maxInputCharLimit,C=void 0===y?2e3:y,O=e.isHVCAppChatV2Enabled,S=void 0!==O&&O,E=e.hvcPromptStrings,I=void 0===E?[]:E,w=e.onChatInputHVCPromptUpdated,T=void 0===w?function(e,t){}:w,k=e.handleKeyDown,j=e.handleKeyUp,P=e.handleOnPaste,A=e.handleOnBeforeInput,_=e.handleOnInput,D=e.submitButtonTitle,L=void 0===D?mp():D,M=e.handleSubmitButtonClick,B=e.isMenuButtonEnabled,R=void 0!==B&&B,F=(e.shouldOpenMenuOnEmptyInput,e.menuButtonTitle),N=void 0===F?fp():F,H=(e.handleMenuButtonClick,e.handleOnOpenMenu,e.handleOnChatInputControlMount),U=e.handleOnChatInputControlUnmount,V=e.handleOnBlur,z=e.promptGuideMenuProps,G=e.voiceInputProps,W=e.isCIQButtonEnabled,Q=void 0!==W&&W,q=e.ciqButtonTitle,K=void 0===q?xp():q,Y=e.isGroundingButtonEnabled,Z=void 0!==Y&&Y,J=e.groundingSourcePickerProps,X=e.groundingButtonPluginProps,$=e.shouldBlockGroundingButtonClick,ee=void 0===$?function(){return!1}:$,te=e.shouldBlockSubmitButtonClick,ne=void 0===te?function(){return!1}:te,re=e.handleFirstUserInput,oe=void 0===re?function(){}:re,ie=e.handleChatInputLoad,ae=void 0===ie?function(){}:ie,se=e.editorProps,le=e.isSensitivityIndicatorLoading,de=e.imageInputEnabled,pe=e.chatInputBannerProps,ge=Object(ce.useRef)(),he=Object(ce.useRef)(),fe=Object(ce.useRef)(null),ve=Object(ce.useRef)(),be=ue.a.useRef(),ye=Object(ce.useRef)(),Ce=Object(ce.useRef)(!1),Oe=Object(ce.useRef)(!0),Se=Object(ce.useRef)(!0),Ee=Object(ce.useRef)(null==G?void 0:G.alSession),xe=!(!(null==G?void 0:G.handleInChatInput)||!(null==G?void 0:G.alSession)&&!(null==G?void 0:G.alSessionConfig)),Ie=Object(o.__read)(Object(ce.useState)(void 0),2),we=Ie[0],Te=Ie[1],ke=Object(o.__read)(ue.a.useState(void 0),2),je=ke[0],Pe=ke[1],Ae=Object(o.__read)(Object(ce.useState)(0),2),_e=Ae[0],De=Ae[1];Object(ce.useImperativeHandle)(t,(function(){return{addImage:function(e){var t;null===(t=ge.current)||void 0===t||t.addImage(e)},removeImages:function(){var e;null===(e=ge.current)||void 0===e||e.removeImages()},getImages:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getImages()},setInputText:function(e,t){var n,r;void 0===t&&(t=!1),null===(n=ge.current)||void 0===n||n.setInputText(e,t),De(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)},updateInputText:function(e,t){var n,r;null===(n=ge.current)||void 0===n||n.updateInputText(e,t),De(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)},getInputText:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:function(e){var t;null===(t=ge.current)||void 0===t||t.setGhostText(e)},getGhostText:function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.getGhostText()},setFocus:function(){var e;null===(e=ge.current)||void 0===e||e.setFocus()},closeMenu:function(){R&&Me&&Be(!1),Z&&Fe&&Ne(!1),xe&&Ce.current&&tt(!1)},getCIQTextRef:function(){return ye.current},getChatEditorInstance:function(){return je},getCIQResponseHandler:function(){return we},setMenuButtonFocus:function(){document.getElementById("ViewPromptsID").focus()}}}));var Le=Object(o.__read)(Object(ce.useState)(!1),2),Me=Le[0],Be=Le[1],Re=Object(o.__read)(Object(ce.useState)(!1),2),Fe=Re[0],Ne=Re[1],He=Object(o.__read)(Object(ce.useState)(!1),2),Ue=He[0],Ve=He[1],ze=Object(o.__read)(Object(ce.useState)(Th.Uninitialized),2),Ge=ze[0],We=ze[1],Qe=Object(o.__read)(Object(ce.useState)(!1),2),qe=Qe[0],Ke=Qe[1],Ye=Object(o.__read)(Object(ce.useState)(!1),2),Ze=Ye[0],Je=Ye[1],Xe=Object(o.__read)(Object(ce.useState)(b),2),$e=Xe[0],et=Xe[1],tt=function(e){var t,n,r,o,i,a,s;if(e){var l=(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>0&&Se.current?Ep:bp;null===(n=ge.current)||void 0===n||n.setGhostText(l+Sp())}else(null===(r=ge.current)||void 0===r?void 0:r.getInputText())===bp?null===(o=ge.current)||void 0===o||o.setGhostText(b):(null===(a=null===(i=ge.current)||void 0===i?void 0:i.getGhostText())||void 0===a?void 0:a.trim())===Sp()&&(null===(s=ge.current)||void 0===s||s.setGhostText(bp));Je(e),Ce.current=e},nt=function(e){var t,r,o,i,a,s;if(Ce.current&&xe&&!n&&!(null!=ge.current&&(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>=C)){var l=(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?Ep:bp,c=null!=ge.current?(null===(o=ge.current)||void 0===o?void 0:o.getInputText())+l+e:bp;null===(i=ge.current)||void 0===i||i.setInputText(c),null===(a=ge.current)||void 0===a||a.setGhostText(bp),null===(s=ge.current)||void 0===s||s.setFocus()}},rt=function(e){var t,r,o;if(Ce.current&&xe&&!n&&!(null!=ge.current&&(null===(t=ge.current)||void 0===t?void 0:t.getInputText().length)>=C)){var i=(null===(r=ge.current)||void 0===r?void 0:r.getInputText().length)>0&&Se?Ep:bp;null===(o=ge.current)||void 0===o||o.setGhostText(i+e),e.trim()&&Object(ep.e)(Op,tt)}},ot=new cf(Ze,qe,Ge,null==G?void 0:G.microphonePermissionErrorTitle,null==G?void 0:G.microphonePermissionErrorMessage,Ke,We,tt,ge,b,null==G?void 0:G.microphonePermissionImagePath,null==G?void 0:G.showMicrophonePermissionHelpLink),it=xe?ot.getMicrophoneButtonProps():null==G?void 0:G.microphoneButtonProps;it&&!it.title&&(it.title=up()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone");var at=!1,st=function(){var e;Oe.current&&(oe(),Oe.current=!1);var t=null===(e=ge.current)||void 0===e?void 0:e.getInputText();t=t.replace("\n",""),De(t.length)},lt=!1;Object(ce.useEffect)((function(){var e;et(b),null===(e=ge.current)||void 0===e||e.setGhostText(b)}),[b]),Object(ce.useEffect)((function(){var e;he.current&&(null===(e=fe.current)||void 0===e||e.setTarget(he.current))}),[fe,he]),Object(ce.useEffect)((function(){s?je&&je.updateCurrentTheme(hu.dark):je&&je.updateCurrentTheme(hu.light)}),[s]),Object(ce.useEffect)((function(){if((null==se?void 0:se.handleInChatInput)&&(null==se?void 0:se.editorConfig)&&!be.current&&(null==se?void 0:se.alSession)){var e=(new Wd).createInstance();e.bootstrap(dp(se.editorConfig,se.alSession)).then((function(t){be.current=e,Pe(t)}))}return function(){be.current&&be.current.shutdown().then((function(){be.current=void 0}))}}),[null==se?void 0:se.alSession]),Object(ce.useEffect)((function(){if((null==se?void 0:se.handleInChatInput)&&(null==se?void 0:se.editorConfig)&&!we&&je&&ge.current){var e=je.initializeCiq(ge.current.getInputSpanElement(),{menuTitle:null==se?void 0:se.editorConfig.transformFileMenuTitle,menuSubtitle:(null==se?void 0:se.editorConfig.transformFilePlaceholderText)?null==se?void 0:se.editorConfig.transformFilePlaceholderText:bp,queryCharToUse:Fu,onItemSelected:function(t){var n,r;null===(n=ge.current)||void 0===n||n.setGhostText(bp),null===(r=ge.current)||void 0===r||r.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,le,a,s,ye),se.postCIQItemSelectionHandler&&se.postCIQItemSelectionHandler(t.suggestion)},entitiesEnabled:null==se?void 0:se.editorConfig.entitiesSupported,ExpanededECC:null==se?void 0:se.editorConfig.isExpandedECCEnabled});Te(e)}}),[je,we]),Object(ce.useEffect)((function(){var e;Ze||Object(ep.d)(tt).catch((function(e){console.log("pauseMicandStopTimer Error"+e)})),null===(e=ge.current)||void 0===e||e.setFocus()}),[Ze]);var ct=rf(),ut=of(),dt=af(),pt=Object(ce.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),gt=Object(ce.useRef)({chatInput:"",chatInputOuterContainer:"",chatInputContainer:"",userInput:"",chatInputButtons:"",chatInputCharCount:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:"",chatInputCharCountError:""}),ht=Object(o.__read)(Object(ce.useState)(ct),2),ft=ht[0],mt=ht[1];Object(ce.useEffect)((function(){for(var e in ct)pt.current[e]=Object(x.a)(ct[e],ut[e]);for(var e in ct)gt.current[e]=Object(x.a)(ct[e],dt[e]);xe&&Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return null!=Ee.current?[3,2]:(e=Ee,[4,pp(null==G?void 0:G.alSessionConfig)]);case 1:e.current=n.sent(),n.label=2;case 2:return Ee.current?(t=Object(tp.a)(G.voiceInputLocale),[4,Object(ep.a)(t,nt,rt,We,tt,Ee.current)]):[3,4];case 3:n.sent(),Se.current=Object(tp.b)(Object(tp.a)(t)),n.label=4;case 4:return[2]}}))})),ae()}),[]),Object(ce.useEffect)((function(){if(u)for(var e in ct)pt.current[e]=Object(x.a)(ct[e],u[e])}),[u]),Object(ce.useEffect)((function(){var e;n?mt(gt.current):(mt(pt.current),null===(e=ge.current)||void 0===e||e.setFocus())}),[n,u]);return ue.a.createElement(cg,{className:ft.chatInputOuterContainer,themePalette:a,isDarkMode:s,dir:c},ue.a.createElement("div",{id:Cp,className:ft.chatInput,tabIndex:h,onClick:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){return n||document.activeElement===(null===(e=ge.current)||void 0===e?void 0:e.getInputSpanElement())||null===(t=ge.current)||void 0===t||t.setFocus(),[2]}))}))},onMouseDown:function(e){_h()&&e.preventDefault()},onBlur:function(){var e;_h()&&!Me&&(null===(e=ge.current)||void 0===e?void 0:e.getInputText())===bp&&setTimeout((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return V(),[2]}))}))}),100)},ref:he},pe&&ue.a.createElement(sp,Object(o.__assign)({},pe)),!Z&&J&&ue.a.createElement(Yg,Object(o.__assign)({},J,{onSelection:function(e){et(e.placeholderText),J&&J.onSelection&&J.onSelection(e)},isDisabled:!J.alwaysEnable&&n,isChatInputBannerVisible:void 0!==pe})),ue.a.createElement(me.a,{content:m,relationship:"label",positioning:"above",withArrow:!0,visible:Ue,onVisibleChange:function(e,t){e&&"focus"===e.type?Ve(!1):Ve(t.visible)}},ue.a.createElement("div",null,ue.a.createElement("div",{className:ft.chatInputContainer},ue.a.createElement(rg,{ref:ge,styleOverrideClassName:u?u.userInput:"",placeholderText:$e,chatInputTabIndex:p,isDisabled:n,isHVCAppChatV2Enabled:S,hvcPromptStrings:I,onChatInputHVCPromptUpdated:T,handleKeyDown:function(e){var t,r,o,i,a;if(at="Process"===e.key,!e.nativeEvent.isComposing)if(lt&&"Enter"===e.key)lt=!1;else if(!k||k(e)){var s;if("Backspace"===e.key)if((c=window.getSelection())&&c.isCollapsed&&0!==c.anchorOffset&&(" "===c.anchorNode.textContent||c.anchorNode.lastChild&&" "===c.anchorNode.lastChild.textContent)){var l=c.anchorNode.lastChild?c.anchorNode.lastChild.previousSibling:c.anchorNode.previousSibling;l&&((s=l.lastChild)&&s instanceof HTMLElement&&"false"===s.contentEditable)&&(e.preventDefault(),c.modify("move","backward","character"))}if("Enter"===e.key)if(e.preventDefault(),e.shiftKey){if(_e===C)return;var c;null===(t=ge.current)||void 0===t||t.setGhostText(bp),(c=window.getSelection()).getRangeAt(0).insertNode(document.createElement("br")),c.collapseToEnd(),null===(r=ge.current)||void 0===r||r.scrollToBottom(),st()}else if(!n){var u=ge.current?null==we?void 0:we.generateQueryAnnotations(ge.current.getInputSpanElement()):void 0;M(null===(o=ge.current)||void 0===o?void 0:o.getInputText(),u),null===(i=ge.current)||void 0===i||i.setInputText(bp),null===(a=ge.current)||void 0===a||a.setGhostText($e)}}else xe&&"Enter"===e.key&&!e.shiftKey&&tt(!1)},handleKeyUp:function(e){var t,n,r,o;j&&!j(e)||((null===(t=ge.current)||void 0===t?void 0:t.getInputText())===bp?null===(n=ge.current)||void 0===n||n.setGhostText($e):(null===(r=ge.current)||void 0===r?void 0:r.getGhostText())===$e&&(null===(o=ge.current)||void 0===o||o.setGhostText(bp)))},handleOnPaste:function(e){var t,r,o;if(n)e.preventDefault();else if(!P||P(e)){if(e.preventDefault(),Ve(!1),null===(t=ge.current)||void 0===t||t.setGhostText(bp),de&&e.clipboardData.files.length>0){var i=new FileReader;i.addEventListener("load",(function(){var e;null===(e=ge.current)||void 0===e||e.addImage(i.result)})),i.readAsDataURL(e.clipboardData.files[0])}var a=e.clipboardData.getData("Text"),s=a.length||0,l=null===(r=ge.current)||void 0===r?void 0:r.getInputText(),c=window.getSelection();if(c.rangeCount){var u=c.toString(),d=l.length-u.length,p=a.substring(0,C-d);c.deleteFromDocument(),d+s>=C?c.getRangeAt(0).insertNode(document.createTextNode(p)):c.getRangeAt(0).insertNode(document.createTextNode(a)),c.collapseToEnd(),null===(o=ge.current)||void 0===o||o.scrollToBottom(),st()}}},handleOnBeforeInput:function(e){var t;A&&!A(e)||(_e!==C?(Be(!1),Ne(!1),null===(t=ge.current)||void 0===t||t.setGhostText(bp)):e.preventDefault())},handleOnInput:function(e){Ve(!1),st(),!_||_(e)},handleOnCompositionEnd:function(){at||(lt=!0)},handleOnFocusTextArea:function(){Ve(!1)},handleOnChatInputControlMount:H,handleOnChatInputControlUnmount:U}),ue.a.createElement("span",{"aria-hidden":!0,onPaste:function(e){e.preventDefault()}},"‍")),ue.a.createElement("div",{ref:ve},ue.a.createElement(tf,{style:ft.chatInputButtons},ue.a.createElement("div",{className:ft.chatInputLeftButtons},ue.a.createElement("span",{contentEditable:!1,suppressContentEditableWarning:!1,className:ft.chatInputCharCount,"aria-live":"assertive"},_e,"/",C,_e>=C&&ue.a.createElement("span",{className:ft.chatInputCharCountError},"Maximum character limit reached"))),ue.a.createElement("div",{className:ft.chatInputRightButtons},R&&z&&ue.a.createElement(Jg,{title:N,isDisabled:n,isMenuOpen:Me,setMenuOpen:Be,positioningRef:fe,promptGuideMenuProps:z}),Q&&ue.a.createElement(op,{title:K,isDisabled:n,handleClick:function(){var e,t;null===(e=ge.current)||void 0===e||e.updateInputText(Fu,$d.InsertAtCursor),null===(t=ge.current)||void 0===t||t.setGhostText(bp)}}),Z&&X&&ue.a.createElement(Dg,{title:Ip(),isDisabled:n,isMenuOpen:Fe,setMenuOpen:Ne,targetRef:null==ve?void 0:ve.current,groundingButtonPluginProps:X,shouldBlockGroundingButtonClick:ee}),(R&&z||Q||Z)&&ue.a.createElement(np.a,{vertical:!0,appearance:"strong"}),G&&ue.a.createElement("span",{"aria-live":"assertive",role:"alert"},ue.a.createElement($h,{"aria-live":"assertive",isDisabled:n,microphoneButtonProps:it})),ue.a.createElement(lf,{title:L,isDisabled:n||r||0===_e,handleClick:function(e){var t,r,o;if(!ne||!ne()){e.stopPropagation(),xe&&tt(!1);var i=null===(t=ge.current)||void 0===t?void 0:t.getInputText();if(i.trimStart()!==bp&&!n){var a=ge.current?null==we?void 0:we.generateQueryAnnotations(ge.current.getInputSpanElement()):void 0;M(i,a),null===(r=ge.current)||void 0===r||r.setInputText(bp),null===(o=ge.current)||void 0===o||o.setGhostText($e)}}}}))))))))})),df=ue.a.forwardRef((function(e,t){var n=e.isVersion3Enabled,r=void 0!==n&&n,i=Object(o.__rest)(e,["isVersion3Enabled"]);return r?ue.a.createElement(qh,Object(o.__assign)({},i,{ref:t})):ue.a.createElement(uf,Object(o.__assign)({},i,{ref:t}))}));df.displayName="ChatInput";var pf,gf,hf,ff,mf,vf,bf=ue.a.memo(df),yf=n(207),Cf=n(837),Of=n(1158),Sf=n(796),Ef=n(1139),xf=n(485);!function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.QueryDetails="QueryDetails",e.Microphone="Microphone"}(pf||(pf={})),function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.AugloopResponseTime="AugloopResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.ImageResponseTime="ImageResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.QnAResponseTime="QnAResponseTime",e.QnAChunkInfo="QnAChunkInfo",e.SuggestedQnAResponseTime="SuggestedQnAResponseTime",e.AnnotationType="AnnotationType",e.RequestSignalType="RequestSignalType",e.FeatureName="FeatureName",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.IsFirstSdxSessionQuery="IsFirstSdxSessionQuery",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.PluginsConfig3SFetchTime="PluginsConfig3SFetchTime",e.CopilotChatLoadTime="CopilotChatLoadTime",e.Cv="Cv"}(gf||(gf={})),function(e){e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorKey="ChatErrorKey",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorType="ChatErrorType",e.IsFromCache="IsFromCache",e.IsStreamingResponse="IsStreamingResponse",e.Cv="Cv"}(hf||(hf={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory"}(ff||(ff={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.SubmitButtonClicked="Submit_Button_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.ZQMButtonV2Clicked="ZQM_Button_V2_Clicked",e.ZQMLoaded="ZQM_Loaded",e.MenuItemClicked="Menu_Item_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.QueryResubmittedToAL="Query_Resubmitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.HintCardShownOnSubmission="Hint_Card_Shown",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.ALAnnotationReceived="AL_Annotation_Received",e.ChatHistoryTimeout="Chat_History_Timeout",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.EntityLabelOperationSubmitted="Entity_Label_Operation_Submitted",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.GetCurrentChatStatus="GetCurrentChat_Status",e.GetMessagesStatus="GetMessages_Status",e.DeleteMessageStatus="DeleteMessage_Status",e.GetAllChatStatus="GetAllChat_Status",e.AddMessageStatus="AddMessage_Status",e.FeedbackDataUploadOperationSubmitted="FeedbackDataUpload_Operation_Submitted",e.FeedbackDataSydneyDataMissing="FeedbackData_SydneyData_Missing",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionCompleted="Query_Execution_Completed",e.ChatPaneLoadMessageBarShown="ChatPaneLoad_MessageBar_Shown",e.FirstUserInputReceived="First_User_Input_Received",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.ChatInputLoaded="ChatInput_Loaded",e.FirstQuerySubmitted="First_Query_Submitted",e.CopilotLicensingAnnotationActivated="Copilot_Licensing_Annotation_Activated",e.ResetOperationListForResubmit="Reset_Operation_List_For_Resubmit",e.AddToOperationListForResubmit="Add_To_Operation_List_For_Resubmit",e.ChatInputDisabledAndBannerShownForInActiveChatSession="ChatInput_Disabled_And_Banner_Shown_For_InActive_Chat_Session",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TrySydneyToggle="Try_Sydney_Toggle",e.IsSydneyEnabled="Is_Sydney_Enabled",e.HubbleEnterprisePromptClicked="EnterpriseImagePrompt_Clicked",e.BasicChatOperationSubmitted="Basic_Chat_Operation_Submitted",e.BasicChatStreamingResponseTimeout="Basic_Chat_Streaming_Response_Timeout",e.CachedBasicChatResponseShown="Cached_Basic_Chat_Response_Shown",e.EmptyBasicChatResponse="Empty_Basic_Chat_Response",e.QuerySuccessful="Query_Successful",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CLPEncryptedLabelSent="CLP_Encrypted_Label_Sent",e.CLPNonEncryptedLabelSent="CLP_Non_Encrypted_Label_Sent",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabGoToCopilotLabButtonClicked="Copilot_Lab_GoToCopilotLab_Button_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.GroundingSourceUpdated="Grounding_Source_Updated",e.MenuButtonClicked="Menu_Button_Clicked",e.MenuL1SuggestionClicked="Menu_L1_Suggestion_Clicked",e.MenuL2SuggestionClicked="Menu_L2_Suggestion_Clicked",e.PluginConfigSignalSent="Plugin_Config_Signal_Sent",e.PromptSubmittedWithCIQ="Prompt_Submitted_With_CIQ",e.CIQSuggestionSelected="CIQ_Suggestion_Selected",e.SubstrateAPIOperationSubmitted="Substrate_API_Operation_Submitted",e.MsgExtCardDataReceived="MsgExtCard_Data_Received"}(mf||(mf={})),function(e){e.AugloopResponseTimeoutMessage="AugloopResponseTimeoutMessage"}(vf||(vf={}));var If,wf,Tf,kf,jf,Pf,Af,_f,Df,Lf=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},mf),gf),ff),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(If||(If={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(wf||(wf={})),function(e){e.BasicChat="Basic Chat",e.ContentCreation="Content Creation Skill in Chat"}(Tf||(Tf={})),function(e){e.Client="Client",e.Server="Server"}(kf||(kf={})),function(e){e.ChatQnA="Chat QnA",e.Draft="Draft",e.CopilotChat="CopilotChat"}(jf||(jf={})),function(e){e.BasicChatRAIFilterBlockedResponse="Ask Chat QnA Responsible AI Filter Blocked Response",e.ChatComposeDidNotGenerateContent="CopilotChatComposeDidNotGenerateContent",e.BasicChatUnsupportedCopilotFunctionality="Ask Chat QnA Unsupported Copilot Functionality",e.BasicChatMissingCopilotFunctionality="Ask Chat QnA Missing Copilot Functionality",e.BasicChatResponseTimedOut="Ask Chat QnA Response Delayed or Timed Out",e.BasicChatCapacityIssues="Ask Chat QnA Unable to Generate Response Due to Capacity Issue",e.BasicChatBadResponse="Ask Chat QnA LLM Service Side Issue Prevents Output",e.BasicChatInputNotProcessed="Ask Chat QnA User Input Could Not Be Processed",e.BasicChatTaskCompletionIssue="Ask Chat QnA Unable to Complete Task",e.BasicChatUnclassifiedError="Ask Chat QnA Unclassified ASHA Error",e.BasicChatUserCancelledResponse="Ask Chat QnA User Rejected or Cancelled Response"}(Pf||(Pf={})),function(e){e.UserAccessIssue="Unclear Intent CopilotChat User Access Issue for Copilot"}(Af||(Af={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.InputTooLong="Error occurred because input is too long",e.UserThrottled="Error occurred because user has issued too many requests",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.Timeout="Timeout waiting for server",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidSignal="Error occurred because signal/response is invalid",e.PromptInjection="Error occurred because prompt injection is detected",e.InputBlocked="Error occurred because input is blocked by filters",e.OutputBlocked="Error occurred because output is blocked by filters",e.OffensiveInput="Error occurred because user input is offensive",e.OffensiveOutput="Error occurred because offensive content is blocked in output",e.SignalMissing="Error occurred because signal is missing in workflow",e.SignalWrongType="Error occurred because signal is invalid",e.BadResponse="Error occured because of bad response",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.BadRequest="Error occured because of bad request",e.Unknown="Error is unknown",e.UserAbortedQueryExecution="User aborted query execution",e.APIUnavailable="Error occured because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated output",e.UnknownError="Unknown error from model"}(_f||(_f={})),function(e){e.Licensing="Error occured because copilot license couldn't be validated"}(Df||(Df={}));var Mf,Bf,Rf,Ff,Nf,Hf,Uf,Vf,zf,Gf="UserQueryGuid",Wf="Chat",Qf=function(){function e(e){this.copilotCommunicationHandler=e}return e.getInstance=function(t){if(void 0===e.instance){if(void 0===t)throw new Error("copilotCommunicationHandler is undefined");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.sendLoggingEventToClient=function(e,t){this.copilotCommunicationHandler.sendLoggingEventToClient(e,t)},e}(),qf=Qf;!function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(Mf||(Mf={})),function(e){e[e.ACTION_AI=0]="ACTION_AI",e[e.COPILOT_ODSL=1]="COPILOT_ODSL"}(Bf||(Bf={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(Rf||(Rf={})),function(e){e[e.QUERY_ENTERED=0]="QUERY_ENTERED",e[e.QUERY_SUBMITTED=1]="QUERY_SUBMITTED",e[e.QUERY_SUBMITTED_FAILED=2]="QUERY_SUBMITTED_FAILED",e[e.RESPONSE_RECEIVED=3]="RESPONSE_RECEIVED",e[e.RESPONSE_SENT=4]="RESPONSE_SENT",e[e.EXECUTION_COMPLETE=5]="EXECUTION_COMPLETE",e[e.IDLE=6]="IDLE"}(Ff||(Ff={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(Nf||(Nf={})),function(e){e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.PARTIAL_SUCCESS="PARTIAL"}(Hf||(Hf={})),function(e){e[e.AnnotationActivated=0]="AnnotationActivated",e[e.AugloopResponseTimeout=1]="AugloopResponseTimeout",e[e.StopGeneratingButtonClicked=2]="StopGeneratingButtonClicked",e[e.CopilotChatLoaded=3]="CopilotChatLoaded",e[e.CitationLinkClicked=4]="CitationLinkClicked",e[e.BasicChatSuggestionPills=5]="BasicChatSuggestionPills",e[e.BasicChatStatus=6]="BasicChatStatus",e[e.ChatTopicChanged=7]="ChatTopicChanged",e[e.ChatHistoryHydrationFailed=8]="ChatHistoryHydrationFailed",e[e.QuerySubmitted=9]="QuerySubmitted",e[e.UpdateChatClpFromChatHistory=10]="UpdateChatClpFromChatHistory",e[e.PluginsStateUpdated=11]="PluginsStateUpdated",e[e.ResetContextId=12]="ResetContextId",e[e.PythonExitAnalysisButtonClicked=13]="PythonExitAnalysisButtonClicked"}(Uf||(Uf={})),function(e){e.ALSessionInitialized="AL_Session_Initialized",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.ChatHistoryResponseReceived="Chat_History_Response_Received",e.ChatPaneInitalized="Chat_Pane_Initialized",e.ChatPaneLoaded="Chat_Pane_Loaded",e.MenuButtonItemClicked="Menu_Button_Item_Clicked",e.MenuButtonItemClickedL1="Menu_Button_Item_Clicked_L1",e.ZQMButtonItemClicked="ZQM_Button_Item_Clicked",e.InputAreaTextChangedToEmpty="Input_Area_Text_Changed_Empty",e.ZQMLoaded="ZQM_Loaded",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.AugloopResponseReceived="Augloop_Response_Received",e.AugloopErrorReceived="Augloop_Error_Received",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionStarted="Query_Execution_Started",e.QueryExecutionCompleted="Query_Execution_Completed",e.CopilotSwitcherMenuStateChange="Copilot_Switcher_Menu_State_Change"}(Vf||(Vf={})),function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(zf||(zf={}));var Kf,Yf,Zf,Jf,Xf,$f,em=n(131),tm=n(48);!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=3]="SystemMetadata",e[e.OrganizationIdentifiableInformation=4]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=5]="EndUserIdentifiableInformation",e[e.CustomerContent=6]="CustomerContent",e[e.AccessControl=7]="AccessControl",e[e.PublicNonPersonalData=8]="PublicNonPersonalData",e[e.EndUserPseudonymousInformation=9]="EndUserPseudonymousInformation",e[e.PublicPersonalData=10]="PublicPersonalData",e[e.SupportData=11]="SupportData",e[e.Everything=12]="Everything"}(Kf||(Kf={})),function(e){e[e.CP_EVENT_TYPE_NOT_SET=1]="CP_EVENT_TYPE_NOT_SET",e[e.CP_EVENT_TYPE_CRITICAL=2]="CP_EVENT_TYPE_CRITICAL"}(Yf||(Yf={})),function(e){e[e.CP_DATA_CATEGORY_NOT_SET=1]="CP_DATA_CATEGORY_NOT_SET",e[e.CP_DATA_CATEGORY_SOFTWARE_SETUP=2]="CP_DATA_CATEGORY_SOFTWARE_SETUP",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE=3]="CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE=4]="CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE",e[e.CP_DATA_CATEGORY_DEVICE_CONFIGURATION=5]="CP_DATA_CATEGORY_DEVICE_CONFIGURATION",e[e.CP_DATA_CATEGORY_INKING_TYPING_SPEECH=6]="CP_DATA_CATEGORY_INKING_TYPING_SPEECH"}(Zf||(Zf={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.QueryDetails="QueryDetails",e.Chat="Chat"}(Jf||(Jf={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone",e.AshaError="AshaError"}(Xf||(Xf={})),function(e){e[e.CP_DIAGNOSTIC_LEVEL_OPTIONAL=1]="CP_DIAGNOSTIC_LEVEL_OPTIONAL",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED=2]="CP_DIAGNOSTIC_LEVEL_REQUIRED",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES=3]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA=4]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA"}($f||($f={}));var nm=function(){function e(){}return e.prototype.LogTelemetryEvent=function(e){wb("LogTelemetryEvent: EventName: "+e.GetEventName()+"\n EventType: "+e.GetEventType()+"\n EventLogs: ",e.GetLogs())},e}(),rm=function(){function e(e,t,n,r,o,i,a,s,l,c){this.logs=n,this.isRequired=s||!1,this.shouldLog=null==a||a,this.eventType=e,this.eventName=t,this.diagnosticLevel=c||$f.CP_DIAGNOSTIC_LEVEL_OPTIONAL,this.dataCategory=l||Zf.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,this.scenarioName=r,this.capability=o,this.verb=i||""}return e.prototype.GetLogs=function(){return this.logs},e.prototype.SetLogs=function(e){this.logs=e},e.prototype.AddLog=function(e){this.logs.push(e)},e.prototype.IsRequired=function(){return this.isRequired},e.prototype.SetIsRequired=function(e){this.isRequired=e},e.prototype.SetEventType=function(e){this.eventType=e},e.prototype.GetEventType=function(){return this.eventType},e.prototype.SetEventName=function(e){this.eventName=e},e.prototype.GetEventName=function(){return this.eventName},e.prototype.SetDataCategory=function(e){this.dataCategory=e},e.prototype.GetDataCategory=function(){return this.dataCategory},e.prototype.SetDiagnosticLevel=function(e){this.diagnosticLevel=e},e.prototype.GetDiagnosticLevel=function(){return this.diagnosticLevel},e.prototype.SetScenarioName=function(e){this.scenarioName=e},e.prototype.GetScenarioName=function(){return this.scenarioName},e.prototype.SetCapability=function(e){this.capability=e},e.prototype.GetCapability=function(){return this.capability},e.prototype.GetShouldLog=function(){return this.shouldLog},e.prototype.SetShouldLog=function(e){this.shouldLog=e},e.prototype.GetVerb=function(){return this.verb},e.prototype.SetVerb=function(e){this.verb=e},e}(),om=function(){function e(){var e=this;this.chatHistoryInfoLog=[],this.userQueryGuid=Cm,this.getTelemetryLatencyEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:gf.CopilotChatHistoryInfoJson,value:JSON.stringify(e.chatHistoryInfoLog)}]))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),n&&e.setUserQueryGuid(Cm),new rm(Jf.Latency,Xf.Latency,t,r,o,i,n)},this.getASHATelemetryErrorEvent=function(t,n,r,i,a,s,l){return(t=t.concat.apply(t,Object(o.__spreadArray)([],Object(o.__read)(i&&a?Object(o.__spreadArray)([],Object(o.__read)(em.c.getFields({eventType:em.c.EventType.Error,veto:i,error:a,inStaging:null==s||s})),!1):[]),!1))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),new rm(Jf.Error,Xf.AshaError,t,n,r,l)},this.getASHAPillarTelemetryEvent=function(t,n,r,i,a){return(t=t.concat.apply(t,Object(o.__spreadArray)([],Object(o.__read)(i?Object(o.__spreadArray)([],Object(o.__read)(em.c.getFields({eventType:em.c.EventType.Pillar,pillar:i})),!1):[]),!1))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),new rm(Jf.ChatEvents,Xf.ChatEvents,t,n,r,a)},this.getTelemetryErrorEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:hf.UserQueryOrder,value:mO}]))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),new rm(Jf.Error,Xf.Error,t,r,o,i,n)},this.getTelemetryQueryDetailsEvent=function(t,n,r,o){return(t=t.concat(e.getDataFields([{key:Lf.UserQueryOrder,value:mO}]))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),new rm(Jf.QueryDetails,Xf.QueryDetails,t,n,r,o)},this.getTelemetryChatEvent=function(t,n,r,o,i){return(t=t.concat(e.getDataFields([{key:hf.UserQueryOrder,value:mO}]))).find((function(e){return e.name===Gf}))||(t=t.concat(e.getDataFields([{key:Gf,value:e.userQueryGuid.length>0?e.userQueryGuid:hO}]))),new rm(Jf.ChatEvents,Xf.ChatEvents,t,r,o,i,n)},this.chatHistoryInfoLog=[]}return e.setTelemetryHandler=function(e){this.telemetryHandler=e},e.getTelemetryHandler=function(){return this.telemetryHandler},e.prototype.addChatHistoryInfoLog=function(e){this.chatHistoryInfoLog.push(e)},e.prototype.resetChatHistoryInfoLog=function(){this.chatHistoryInfoLog=[]},e.prototype.setUserQueryGuid=function(e){this.userQueryGuid=e},e.prototype.getUserQueryGuid=function(){return this.userQueryGuid},e.getInstance=function(){return e.telemetryHandler||this.setTelemetryHandler(new nm),this.sInstance||(this.sInstance=new e),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.sendTelemetryLatencyData=function(t,n,r,o,i){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&(e.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEvent(this.getDataFields(t),n,r,o,i)),this.resetChatHistoryInfoLog())},e.prototype.sendTelemetryErrorData=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryErrorEvent(this.getDataFields(t),!0,n,r,o))},e.prototype.sendTelemetryQueryDetailsObject=function(t,n,r,o){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryQueryDetailsEvent(this.getDataFields(t),n,r,o))},e.prototype.sendTelemetryChatEventData=function(t,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=""),void 0===o&&(o=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getTelemetryChatEvent(this.getDataFields(t),n,r,o,i))},e.prototype.getCopilotScorecardData=function(e,t,n,r,i,a,s,l){return(e=e.concat(Object(o.__spreadArray)([],Object(o.__read)(em.e.getFields({featureActionType:em.e.FeatureActionType[t],isUserInitiated:!0,capability:Pb(i)?"":em.e.Capability[i],verb:Pb(s)?"":em.e.Verb[s],featureName:Pb(r)?"Others":r,subFeatureName:Pb(l)?"":l,entryPoint:n,isThumbsUp:Pb(a)?null:a})),!1))).find((function(e){return e.name===Gf}))||(e=e.concat(this.getDataFields([{key:Gf,value:this.userQueryGuid.length>0?this.userQueryGuid:hO}]))),new rm(Jf.Chat,Xf.Chat,e,r,i,s,!0,!0,Zf.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,$f.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?tm.b(e.key,e.value,e.tag):"string"==typeof e.value?tm.d(e.key,e.value,e.tag):"boolean"==typeof e.value?tm.a(e.key,e.value,e.tag):tm.d(e.key,e.value,e.tag)}),[])},e.prototype.logSeenEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),em.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logTriedEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),em.e.FeatureActionType.IsTried,n,r,o,i,a,s))},e.prototype.logKeptEvent=function(t,n,r,o,i,a,s){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),em.e.FeatureActionType.IsKept,n,r,o,i,a,s))},e.prototype.logEnabledEvent=function(t,n,r,o,i,a){null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(t),em.e.FeatureActionType.IsSeen,n,r,o,void 0,i,a))},e.prototype.logEventWithAshaPillar=function(t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHAPillarTelemetryEvent(this.getDataFields(t),n,r,o,i))},e.prototype.logErrorWithAshaVetoAndError=function(t,n,r,o,i,a,s){void 0===n&&(n=""),void 0===r&&(r=""),null!=e.telemetryHandler&&e.telemetryHandler.LogTelemetryEvent(this.getASHATelemetryErrorEvent(this.getDataFields(t),n,r,o,i,a,s))},e}(),im=function(e){return"ChatCompose"===e?jf.Draft:jf.ChatQnA},am=function(e){switch(e){case jf.Draft:return If.ContentGeneration;case jf.ChatQnA:return If.QAandSummaries;default:return}},sm=function(e){switch(e){case jf.Draft:return wf.Create;case jf.ChatQnA:return wf.Ask;default:return}},lm=function(e){switch(e){case jf.Draft:return Tf.ContentCreation;case jf.ChatQnA:return Tf.BasicChat;default:return}};function cm(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function um(e){return null==e}var dm=function(){return"undefined"!=typeof OfficeaicopilotStrings},pm=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(r){qf.getInstance().sendLoggingEventToClient(Vf.CopyButtonClicked,{chatEventParams:"Basic_Chat"}),t={correlationId:"",featureName:""};try{t=JSON.parse(n)}catch(e){wb("Error parsing telemetry data on copy click",e.message)}var i;return om.getInstance().logKeptEvent([{key:Gf,value:t.correlationId||""}],Wf,t.featureName,am(t.featureName),void 0,sm(t.featureName)),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopyButtonClicked},{key:hf.ChatEventParameters,value:t.featureName||""},{key:hf.UserQueryGuid,value:t.correlationId||""}]),i=e,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e=z(i),t=document.getElementById(i).innerText,n=new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([t],{type:"text/plain"})}),e?[4,navigator.clipboard.write([n])]:[3,2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:return r=o.sent(),console.log("Error copying html to clipboard",r.message),[3,4];case 4:return[2]}}))})),[2]}))}))},gm=function(e){return void 0===e&&(e="en"),e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e};var hm,fm=6e4,mm=5e3,vm="Sorry, something went wrong. I'm working on it.",bm=200,ym=2e3,Cm="",Om=" ",Sm="...",Em="https://augloop-dogfood.officeppe.com",xm="Choose a starter prompt from the suggestions menu to get started",Im="Augloop Response Timed Out",wm="Chat History Response Timed Out",Tm=1e4,km=function(){return dm()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},jm=function(){return dm()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"},Pm=function(){return dm()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},Am=function(){return dm()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts"},_m=function(){return dm()?OfficeaicopilotStrings.ErrorOffensiveInputContent:"Sorry, I can't work with that. Try making a new request."},Dm=function(){return dm()?OfficeaicopilotStrings.ErrorOffensiveOutputContent:"Sorry, I can't generate content for this. Try making a new request."},Lm=function(){return dm()?OfficeaicopilotStrings.ErrorInputBlockedByDynamicGuardList:"It looks like there's some content here I can't work with. Try asking me to do something else."},Mm=function(){return dm()?OfficeaicopilotStrings.ErrorInvalidSignal:"Something went wrong. Please try again in a moment."},Bm=function(){return dm()?OfficeaicopilotStrings.ErrorTimeout:"I can't process your request right now. Try again in a little while. "},Rm=function(){return dm()?OfficeaicopilotStrings.ErrorThrottled:"The maximum number of requests per hour has been reached. Try again in a little while."},Fm=function(){return dm()?OfficeaicopilotStrings.ErrorUserThrottled:"You're only allowed a certain number of requests per second. Try again in a little while."},Nm=function(){return dm()?OfficeaicopilotStrings.ErrorInputTooLong:"This is too much information for me to process. Try again with a request that's less than 15,000 words."},Hm=function(){return dm()?OfficeaicopilotStrings.ErrorInvalidLanguage:"Your request includes a language I don't currently support."},Um=function(){return dm()?OfficeaicopilotStrings.LearnMoreString:"Learn More"};!function(e){e.Opera="Opera",e.Safari="Safari",e.PhantomJS="PhantomJS",e.Edge="Edge",e.Electron="Electron",e.Chrome="Chrome",e.MSIE="MSIE",e.Firefox="Firefox",e.SkypeShell="SkypeShell",e.Unknown="Unknown"}(hm||(hm={}));var Vm,zm=16;!function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(Vm||(Vm={}));var Gm,Wm,Qm,qm,Km,Ym,Zm,Jm,Xm,$m,ev,tv,nv=function(){return dm()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},rv=function(){return dm()?OfficeaicopilotStrings.CIQDefaultPlaceholder:"Start typing to search"},ov="ChatWrapperId",iv="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",av="acquired",sv=function(){function e(t){var n,r,o,i,a,s,l,c,u;e.appName=t.appName,e.augloopUrl=null!==(n=t.augloopUrl)&&void 0!==n?n:Em,e.devBuild=null!==(r=t.devBuild)&&void 0!==r&&r,e.environment=t.environment,e.sessionId=t.sessionId,e.workflow=null!==(o=t.workflow)&&void 0!==o?o:Bf.ACTION_AI,e.appVersion=null!==(i=t.appVersion)&&void 0!==i?i:"",e.appInternalName=null!==(a=t.appInternalName)&&void 0!==a?a:"",e.appPlatform=null!==(s=t.appPlatform)&&void 0!==s?s:"",e.augloopFlights=null!==(l=t.augloopFlights)&&void 0!==l?l:"",e.language=null!==(c=t.language)&&void 0!==c?c:"en-US",e.substrateScenarioName=null!==(u=t.substrateScenarioName)&&void 0!==u?u:"",e.feedbackSettings=t.feedbackSettings}return e.getAppName=function(){return e.appName},e.getAugloopUrl=function(){return e.augloopUrl},e.isDevbuild=function(){return e.devBuild},e.getEnvironment=function(){return e.environment},e.getSessionId=function(){return e.sessionId},e.getWorkflowType=function(){return e.workflow},e.getAppVersion=function(){return e.appVersion},e.getAppInternalName=function(){return e.appInternalName},e.getAppPlatform=function(){return e.appPlatform},e.getAugloopFlights=function(){return e.augloopFlights},e.getLanguage=function(){return e.language},e.getSubstrateScenarioName=function(){return e.substrateScenarioName},e.getFeedbackSettings=function(){return e.feedbackSettings},e}(),lv=n(832);!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS"}(Gm||(Gm={})),function(e){e.Chat="chat",e.Human="human"}(Wm||(Wm={})),function(e){e.BASIC_CHAT="BasicChat",e.DRAFT="Draft"}(Qm||(Qm={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(qm||(qm={})),function(e){e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsApplyClpFromHydratedMessagedEnabled="IsApplyClpFromHydratedMessagedEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled",e.HydratedMessagesSquashingEnabled="HydratedMessagesSquashingEnabled",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.IsChatHistoryPaginationEnabled="IsChatHistoryPaginationEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.DisableChatHistoryPaginationFix="DisableChatHistoryPaginationFix",e.ChatHistoryDuplicateLoggingFix="ChatHistoryDuplicateLoggingFix",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.ShowRestrictiveSearchBanner="ShowRestrictiveSearchBanner",e.EnableRestrictiveSearchBanner="EnableRestrictiveSearchBanner",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.IsLicenseAnnotationEnabled="IsLicenseAnnotationEnabled",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsDisableChatInputWhenAlSessionCloseEnabled="IsDisableChatInputWhenAlSessionCloseEnabled",e.EnableALCorrelationLogs="EnableALCorrelationLogs",e.IsSuggestedQnACitationsEnabled="IsSuggestedQnACitationsEnabled",e.EnableMsgExtCardTelemetry="EnableMsgExtCardTelemetry"}(Km||(Km={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.UnknownOpenAI="unknown-openai",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(Ym||(Ym={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(Zm||(Zm={})),function(e){e.HandleSubmitError="handle-submit-error",e.AugloopInitializationError="augloop-initialization-error",e.ActivateAnnotationError="activate-annotation-error",e.AugloopResponseTimeout="augloop-response-timeout",e.ChatHistoryResponseTimeout="chat-history-response-timeout",e.AugloopPluginProviderFailure="augloop-plugin-provider-failure",e.MsgExtCardError="msg-ext-card-error"}(Jm||(Jm={})),function(e){e.Shy="Shy",e.Expanded="Expanded"}(Xm||(Xm={})),function(e){e.Favourite="Favourite",e.Unfavourite="Unfavourite"}($m||($m={})),function(e){e.PromptGuide="PromptGuide",e.Microphone="Microphone",e.SubmitButton="SubmitButton",e.GroundingButton="GroundingButton"}(ev||(ev={})),function(e){e.ENTERPRISE_SEARCH="EnterpriseSearch",e.WEB_SEARCH="BingWebSearch"}(tv||(tv={}));var cv,uv=function(){function e(e){this.workflowDataMap=new Map,this.copilotCommunicationHandler=e,this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())}return e.getInstance=function(t){if(!e.instance){if(!t)throw new Error("WorkflowDataMap has not been initialized");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.populateWorkflowDataMap=function(e){var t,n;try{for(var r=Object(o.__values)(e),i=r.next();!i.done;i=r.next()){var a=i.value,s={workflowInfo:a};this.workflowDataMap.set(a.workflowAnnotationType,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsQnASuggestionPillCachingEnabled)&&!this.workflowDataMap.has(Sf.c.getTypeName())&&this.workflowDataMap.set(Sf.c.getTypeName(),{workflowInfo:{workflowAnnotationType:Sf.c.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsSharedCopilotLabEnabled)&&(this.workflowDataMap.has(lv.a.getTypeName())?this.workflowDataMap.get(lv.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(lv.a.getTypeName(),{workflowInfo:{workflowAnnotationType:lv.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}})),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsClpSensitivityInChatInputEnabled)&&!this.workflowDataMap.has(Ef.a.getTypeName())&&this.workflowDataMap.set(Ef.a.getTypeName(),{workflowInfo:{workflowAnnotationType:Ef.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:15e3}}),(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)||this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsPersistanceInPhase2UxEnabled))&&(this.workflowDataMap.has(Of.a.getTypeName())?this.workflowDataMap.get(Of.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(Of.a.getTypeName(),{workflowInfo:{workflowAnnotationType:Of.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}))},e.prototype.getWorkflowDataMap=function(e){return void 0===e&&(e=!1),e&&(this.workflowDataMap.clear(),this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())),this.workflowDataMap},e.prototype.isWorkflowRegistered=function(e){return this.workflowDataMap.has(e)},e.prototype.getWorkflowAugloopTimeoutValue=function(e){return this.isWorkflowRegistered(e)?this.workflowDataMap.get(e).workflowInfo.augloopResponseTimeout:fm},e.prototype.isAugloopResponseTimeoutRequired=function(e){return!!this.isWorkflowRegistered(e)&&this.workflowDataMap.get(e).workflowInfo.augloopResponseTimerRequired},e}(),dv=uv,pv=n(2858);try{cv=n(1104)}catch(Ze){}var gv,hv,fv=function(){function e(){this.debugLogs=""}return e.initialize=function(){e.debugLogManager||(e.debugLogManager=new e)},e.getInstance=function(){return e.debugLogManager},e.prototype.addLog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=cv?cv.format.apply(cv,Object(o.__spreadArray)([],Object(o.__read)(e),!1))+"\n":e.join(" ")+"\n";this.debugLogs+=n},e.prototype.getLogs=function(){return this.debugLogs},e.prototype.resetLogs=function(){this.debugLogs=""},e}(),mv=n(1848),vv=n(681),bv=n(1489),yv=n(1151),Cv=function(){function e(){this.messageRequestIdMap={}}return e.prototype.updateMessageIdMap=function(){this.currentUserMessageId&&this.requestId&&!this.messageRequestIdMap[this.requestId]&&(this.messageRequestIdMap[this.requestId]=this.currentUserMessageId)},Object.defineProperty(e.prototype,"ConversationId",{get:function(){return this.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RequestId",{get:function(){return this.requestId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SydneyEndpoint",{get:function(){return this.sydneyEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ChatTimestamp",{get:function(){return this.chatTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return this.locale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ErrorMessage",{get:function(){return this.errorMessage},set:function(e){this.errorMessage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentUserMessageId",{get:function(){return this.currentUserMessageId},set:function(e){this.currentUserMessageId=e},enumerable:!1,configurable:!0}),e.prototype.GetMessageIdForRequestId=function(e){return this.messageRequestIdMap[e]},Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.resetInstance=function(){var e;null===(e=this._instance)||void 0===e||e.NewChatInitiated(),this._instance=void 0},e.prototype.Observe=function(e){var t,n,r,o,i,a;if(e)try{if(e.conversationId&&e.conversationId!==this.conversationId&&(this.conversationId=e.conversationId,wb("ChatStateObserver ConversationId: "+e.conversationId)),e.sydneyEndpoint&&!this.sydneyEndpoint&&(this.sydneyEndpoint=null!==(t=e.sydneyEndpoint)&&void 0!==t?t:this.sydneyEndpoint),this.requestId=null!==(n=e.queryId)&&void 0!==n?n:this.requestId,this.requestId&&this.updateMessageIdMap(),this.chatTimestamp=null!==(r=e.timestamp)&&void 0!==r?r:(new Date).toISOString(),!this.locale&&(null===(o=e.chatResponse)||void 0===o?void 0:o.messages)){var s=null===(a=null===(i=e.chatResponse)||void 0===i?void 0:i.messages)||void 0===a?void 0:a.find((function(e){return e.locale}));(null==s?void 0:s.locale)&&(this.locale=null==s?void 0:s.locale)}}catch(e){wb("Exception ocurred in ChatStateObserver "+e)}},e.prototype.NewChatInitiated=function(){this.currentUserMessageId=void 0,this.requestId=void 0,this.chatTimestamp=void 0,this.errorMessage=void 0},e}(),Ov=n(1141),Sv=function(e){gv=e};!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(hv||(hv={}));var Ev=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var r,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I;return Object(o.__generator)(this,(function(w){try{if(r=JSON.parse(e),i=(new Date).toISOString(),a=function(e){var t,n,r,i,a,s=null!==(i=null===(r=null==e?void 0:e.elements)||void 0===r?void 0:r.options)&&void 0!==i?i:[],l="CopilotChatFeedback",c=0;try{for(var u=Object(o.__values)(s),d=u.next();!d.done;d=u.next())switch(null===(a=d.value.displayedText)||void 0===a?void 0:a.toLowerCase()){case hv.INACCURATE_OR_IRRELEVANT:c=33554432;break;case hv.OFFENSIVE:l="CopilotChatReportHarm",c=32;break;case hv.OTHER:c=64}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return{AnswerType:l,FeedbackReasonType:c}}(null==r?void 0:r.responseContent),s=a.AnswerType,l=a.FeedbackReasonType,c=Cv.Instance,u=null!==(m=null===(f=null===(h=null==r?void 0:r.responseContent)||void 0===h?void 0:h.elements.find((function(e){return e.userVerbatim})))||void 0===f?void 0:f.userVerbatim)&&void 0!==m?m:(null==r?void 0:r.responseContent)?JSON.stringify(r.responseContent):"",d=function(e){var t,n,r,o,i,a,s;if(null===(t=null==e?void 0:e.contextData)||void 0===t?void 0:t.sydneyContextData)return null===(n=null==e?void 0:e.contextData)||void 0===n?void 0:n.sydneyContextData;var l=Cv.Instance,c=l.RequestId,u=l.ChatTimestamp,d=l.GetMessageIdForRequestId(l.RequestId);try{var p=(null===(r=null==e?void 0:e.contextData)||void 0===r?void 0:r.cardMetaData)?JSON.parse(null===(o=null==e?void 0:e.contextData)||void 0===o?void 0:o.cardMetaData):void 0;p&&(c=null!==(i=null==p?void 0:p.promptId)&&void 0!==i?i:c,u=null!==(a=null==p?void 0:p.utteranceTimestamp)&&void 0!==a?a:u,d=null!==(s=null==p?void 0:p.feedbackMessageId)&&void 0!==s?s:d)}catch(e){wb("Error parsing feedbackData",e.message)}return{conversationId:null!=Kv?Kv:l.ConversationId,requestId:c,utteranceTimeStamp:u,feedbackMessageId:d,sydneyEndpoint:l.SydneyEndpoint,locale:l.Locale}}(gv),!d.feedbackMessageId&&!n||!d.conversationId||!d.sydneyEndpoint||!d.sydneyEndpoint.length)return om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.FeedbackDataSydneyDataMissing}]),[2];p=Object.assign(new Ov.a,{responseData:{AnswerType:s,ClientName:t+"CopilotOCV",CorrelationId:Object(xf.a)(),Date:i,Description:u,FeedbackId:null!==(v=null==r?void 0:r.diagnosticsUploadId)&&void 0!==v?v:Object(xf.a)(),FeedbackRating:"Frown"===(null==r?void 0:r.feedbackType)?1:2,FeedbackReasonType:l,UserConsentGiven:null===(b=null==r?void 0:r.hostManagedContextDataConsent)||void 0===b||b,OptionalFields:{ConvId:null!==(y=d.conversationId)&&void 0!==y?y:"!CONVID_NA_"+(c.ErrorMessage?"[".concat(c.ErrorMessage,"]"):""),Endpoint:null!==(C=d.sydneyEndpoint)&&void 0!==C?C:"https://substrate.office.com/m365chat/SecuredChatHub",Locale:null!==(S=null!==(O=d.locale)&&void 0!==O?O:c.Locale)&&void 0!==S?S:"en-us",TraceId:null!==(E=d.feedbackMessageId)&&void 0!==E?E:(null===(x=d.requestId)||void 0===x?void 0:x.length)?d.requestId:"!TRACE_ID_NA",FeedbackSourceType:"OCV",UtteranceHappenTime:null!==(I=d.utteranceTimeStamp)&&void 0!==I?I:i,ContactMe:!!(null==r?void 0:r.userEmail)}}}),g=new bv.b({parentPath:["Signal",Ov.a.getTypeName()],items:[{id:yv.a.generateId(),body:p}]}),wb("Submitting FeedbackDiagnosticDataSignal to Augloop : ".concat(Ov.a.getTypeName()," with signal: ").concat(JSON.stringify(g))),Gb.getInstance().submitOperation(g,Ov.a.getTypeName()),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.FeedbackDataUploadOperationSubmitted}])}catch(e){wb("Error parsing feedback response data",e.message)}return[2]}))}))},xv=Vd.CurrentContext.toString(),Iv=!1,wv=function(){return xv},Tv=function(e,t){jv("".concat(kv(e.id),":").concat(t))},kv=function(e){switch(e){case tv.ENTERPRISE_SEARCH:return Vd.Work;case tv.WEB_SEARCH:return Vd.Web;default:return e}},jv=function(e){om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.GroundingSourceUpdated},{key:hf.ChatEventParameters,value:e}])},Pv=function(){function e(e,t,n){var r=this;this.handleThumbsDownClick=function(e,t,n){Sv(e),r.copilotCommunicationHandler.feedbackButtonClicked(Nf.DISLIKE,e,t,n)},this.handleThumbsUpClick=function(e,t,n){Sv(e),r.copilotCommunicationHandler.feedbackButtonClicked(Nf.LIKE,e,t,n)},this.addChatMessages=function(e){e.length>0&&r.setChatLog((function(t){return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(e),!1)}))},this.getLastMessage=function(e){void 0===e&&(e=!0);var t=r.getChatLog();if(0!==t.length)return t[jb(t,e)];wb("No chat messages available")},this.clearMessages=function(){r.setChatLog((function(){return[]}))},this.getFeedbackData=function(){var e=r.copilotCommunicationHandler.getFeedbackData();return e&&(null==e?void 0:e.contextData)||(e={feedbackArea:e.feedbackArea,contextData:{cardMetaData:JSON.stringify({prompt:fO,promptId:hO}),sydneyContextData:{conversationId:Cv.Instance.ConversationId,sydneyEndpoint:Cv.Instance.SydneyEndpoint,requestId:Cv.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:Cv.Instance.CurrentUserMessageId},feedbackContextData:{prompt:fO,promptId:hO},groundingSource:wv(),entryPoint:"Chat"}}),e},this.copilotCommunicationHandler=t,this.setChatLog=e,this.chatInputRef=n}var t;return e.convertResponseMessageToChatMessage=function(e,n,r,i,a){var s,l,c;void 0===i&&(i=null),void 0===a&&(a=function(){return!1});try{c=JSON.parse(r.telemetryData)}catch(e){wb("Error parsing telemetry data in chat message builder",e.message)}var u={messageType:e,body:t.getChatMessageBody(e,n),feedbackData:r.feedbackData,shouldShowAIGeneratedIndicator:r.shouldShowAIGeneratedIndicator,feedbackSectionPosition:r.feedbackSectionPosition,showMinifiedUI:r.showMinifiedUI,showAnimation:r.showAnimation,actionBarButtons:r.actionButtonList,strikeThroughText:r.strikeThroughText,references:r.references,pillsList:r.pillsList,handlePillOnClick:function(e){var t,n,o;if(!a()&&i){null===(t=i.current)||void 0===t||t.setGhostText("");var s=e.data;null===(n=i.current)||void 0===n||n.setInputText(s),null===(o=i.current)||void 0===o||o.setFocus(),e.isCiq&&setTimeout((function(){var e;return null===(e=i.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1)}r.handlePillOnClick(e)},handleShowMeOnClick:r.handleShowMeOnClick,warningActionButtons:null!==(s=r.warningActionButtons)&&void 0!==s?s:void 0,clpSensitivityIndicatorData:null!==(l=r.clpSensitivityIndicatorData)&&void 0!==l?l:void 0,telemetryData:JSON.stringify(void 0===c?{correlationId:hO}:Object(o.__assign)(Object(o.__assign)({},c),{correlationId:c.correlationId||hO})),messageId:r.messageId,msgExtCardProps:r.msgExtCardProps,pluginAuthError:r.pluginAuthError};return u},e.prototype.setChatMessageData=function(e,t,n,r,i){var a=this;void 0===n&&(n={shouldShowAIGeneratedIndicator:!1,showAnimation:!1,feedbackData:this.getFeedbackData(),isFailure:!1,showMinifiedUI:!1,feedbackSectionPosition:ro.None,aiResponseMetadata:void 0,actionButtonList:void 0,strikeThroughText:!1,references:void 0,pillsList:void 0,handlePillOnClick:void 0,handleShowMeOnClick:void 0,warningActionButtons:void 0,clpSensitivityIndicatorData:void 0,telemetryData:void 0,messageId:void 0,msgExtCardProps:void 0,pluginAuthError:void 0}),void 0===r&&(r=!0),void 0===i&&(i=function(){return!1}),this.setChatLog((function(s){var l=Object(o.__spreadArray)([],Object(o.__read)(s),!1);return a.addChatMessage(l,e,t,n,r,i)}))},e.prototype.getProps=function(e,t){var n,r;return{chatLog:e,shouldShowFeedbackButtons:null===(n=null==t?void 0:t.showFeedbackButtons)||void 0===n||n,handleChatCardThumbsUpClick:this.handleThumbsUpClick,handleChatCardThumbsDownClick:this.handleThumbsDownClick,useFluentAIGeneratedIndicator:null!==(r=null==t?void 0:t.useFluentAIGeneratedIndicator)&&void 0!==r&&r}},e.prototype.updateLastMessage=function(e,t,n,r){var i=this;void 0===r&&(r=!0),this.setChatLog((function(a){var s=Object(o.__spreadArray)([],Object(o.__read)(a),!1),l=jb(s);return-1===l?(wb("Error: No chat message found to update."),s):i.updateChatMessage(s,e,t,n,r,l)}))},e.prototype.updateMessage=function(e,t,n,r){var i=this;void 0===r&&(r=!0),this.setChatLog((function(a){var s=Object(o.__spreadArray)([],Object(o.__read)(a),!1),l=s.findIndex((function(e){return e.messageId===n.messageId}));return-1===l?(wb("chat message is not found with message id : ".concat(n.messageId)),s):i.updateChatMessage(s,e,t,n,r,l)}))},e.prototype.addChatMessage=function(e,n,r,i,a,s){var l;void 0===a&&(a=!0),void 0===s&&(s=function(){return!1});var u=t.convertResponseMessageToChatMessage(n,r,i,this.chatInputRef,s),d=Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(e),!1),[u],!1);return a&&Ab()&&n!==c.FeedbackNudge&&Bv(u,Fv(r,n),(null===(l=u.body)||void 0===l?void 0:l.user)===Wm.Human,i.isFailure,i.aiResponseMetadata),d},e.prototype.updateChatMessage=function(e,n,r,i,a,s){var l;void 0===a&&(a=!0);var c=Object(o.__spreadArray)([],Object(o.__read)(e),!1),u=c.at(s);return u&&(r&&void 0!==(null==u?void 0:u.body)&&(u.body=t.getChatMessageBody(n,r)),i&&Object.entries(i).forEach((function(e){var t=Object(o.__read)(e,2),n=t[0],r=t[1];"actionButtonList"===n?u.actionBarButtons=r:void 0!==r&&(u[n]=r)})),a&&Ab()&&(r||(r=this.getChatMessageData(u.body,n)),Bv(u,Fv(r,n),(null===(l=u.body)||void 0===l?void 0:l.user)===Wm.Human,null==i?void 0:i.isFailure,null==i?void 0:i.aiResponseMetadata))),c},e.prototype.deleteMessage=function(e,t){this.setChatLog((function(n){for(var r=Object(o.__spreadArray)([],Object(o.__read)(n),!1),i=r.length-1;i>=0;i--){var a=r[i];if(a.messageId===t&&a.messageType===e){r.splice(i,1);break}}return r}))},e.prototype.getChatMessageData=function(e,t){var n={};switch(t){case c.ContentCard:n.contentCardProps=e;break;case c.AccordionCard:n.accordionCardProps=e;break;case c.ChatCardWrapper:n.chatCardWrapperProps=e;break;case c.SelfHelpAdaptiveCard:n.selfHelpAdaptiveCardProps=e;break;case c.StreamingAdaptiveCard:n.streamingAdaptiveCardProps=e;break;case c.MarkdownCard:n.markDownCardProps=e;break;case c.Designer:n.designerCardProps=e;break;case c.WarningMessage:n.warningMessageCardProps=e;break;case c.ProactiveSuggestionCard:n.proactiveSuggestionCardProps=e;break;default:n.defaultMessageProps=e}return n},e.prototype.getChatLog=function(){var e=[];return this.setChatLog((function(t){return e=t})),e},t=e,e.getFeedBackNudgeMessageBody=function(e){return{imageSrc:e}},e.getChatMessageBody=function(e,r){var i;switch(e){case c.ContentCard:i=Object(o.__assign)({},r.contentCardProps);break;case c.AccordionCard:i=Object(o.__assign)({},r.accordionCardProps);break;case c.ChatCardWrapper:i=Object(o.__assign)({},r.chatCardWrapperProps);break;case c.FeedbackNudge:i=t.getFeedBackNudgeMessageBody(n(2718));break;case c.SelfHelpAdaptiveCard:i=Object(o.__assign)({},r.selfHelpAdaptiveCardProps);break;case c.StreamingAdaptiveCard:i=Object(o.__assign)({},r.streamingAdaptiveCardProps);break;case c.MarkdownCard:i=Object(o.__assign)({},r.markDownCardProps);break;case c.Designer:i=Object(o.__assign)({},r.designerCardProps);break;case c.CopilotWorkflowMessage:i=Object(o.__assign)({},r.copilotWorkflowsCardProps);break;case c.WarningMessage:i=Object(o.__assign)({},r.warningMessageCardProps);break;case c.PaginatedCard:i=Object(o.__assign)({},r.paginatedCardProps);break;case c.ProactiveSuggestionCard:i=Object(o.__assign)({},r.proactiveSuggestionCardProps);break;case c.ReviewerSummaryCard:i=Object(o.__assign)({},r.reviewerSummaryCardProps);break;case c.ReviewAgentCard:i=Object(o.__assign)({},r.reviewAgentCardProps);break;default:i=Object(o.__assign)({},r.defaultMessageProps)}return i},e}(),Av=void 0,_v=void 0;function Dv(e,t,n){if(e.isFeatureGateEnabledFromClient(Km.SkipHydrateEnabled))wb("hydrateMessages: Skipping hydrating chat pane with history messages");else{wb("hydrateMessages: Hydrating ".concat(t.length," messages"));var r=Lv(t);n((function(t){var n=Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(r),!1);if(!e.isFeatureGateEnabledFromClient(Km.HydratedMessagesSquashingEnabled))return n;var i=function(e,t){void 0===t&&(t=function(e){return e.messageId});var n=new Map,r=new Map,i=e.map((function(e){return[e,t(e)]}));i.forEach((function(e,t){var i=Object(o.__read)(e,2),a=i[0],s=i[1];void 0!==s&&(r.set(s,a),n.has(s)||n.set(s,t))}));var a=[];return i.forEach((function(e,t){var i=Object(o.__read)(e,2),s=i[0],l=i[1];void 0===l?a.push(s):t===n.get(l)&&a.push(r.get(l))})),a}(n);if(wb("hydrateMessages: Squashing reduced ".concat(n.length," messages to ").concat(i.length)),e.isFeatureGateEnabledFromClient(Km.IsApplyClpFromHydratedMessagedEnabled)&&i&&i.length>0){var a=Object(o.__spreadArray)([],Object(o.__read)(new Set(i.map((function(e){var t;return null===(t=e.clpSensitivityIndicatorData)||void 0===t?void 0:t.labelId})).filter(Boolean))),!1),s={messagesClpLabels:a,workflowAnnotationType:"UpdateChatClpFromChatHistory"};e.sendEventToClient(Uf.UpdateChatClpFromChatHistory,s)}return i}))}}function Lv(e){var t,n,r=[];try{for(var i=Object(o.__values)(e.slice().reverse()),a=i.next();!a.done;a=i.next()){var s=Mv(a.value);s&&r.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Mv(e){return e.richTextJson?function(e){var t;wb("parsing rich text and display message");try{t=JSON.parse(e)}catch(e){return void wb("error parsing rich text from chat history",e.message)}if(t.messageType===c.ChatCardWrapper&&!t.body.renderData)return void wb("No render data found for ChatCardWrapper");t.showAnimation=!1,t.clpSensitivityIndicatorData&&(t=Object(o.__assign)(Object(o.__assign)({},t),{clpSensitivityIndicatorData:Object(o.__assign)(Object(o.__assign)({},t.clpSensitivityIndicatorData),{icon:void 0})}));if(!um(t)&&t.body)return t;return}(e.richTextJson):e.content?function(e){var t,n=e.format,r=e.userRole,o=e.content;if(n===yf.b.PlainText){var i=r===yf.f.User;t={messageType:c.Default,body:{user:i?"human":"chat",messageHeader:{text:o}},shouldShowAIGeneratedIndicator:!i,showAnimation:!i,feedbackSectionPosition:i?ro.None:ro.Footer}}else t={messageType:c.MarkdownCard,body:{user:"chat",message:o},shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:ro.Footer};if(!um(t)&&t.body)return t;return}(e):void 0}function Bv(e,t,n,r,o){var i=Rv(e,t,n,r,o);e.messageType===c.ChatCardWrapper&&(Av=i,_v=e.messageId),$v(yf.c.AddMessageOperation,i)}function Rv(e,t,n,r,i){var a;if((a=e.actionBarButtons?Object(o.__assign)(Object(o.__assign)({},e),{actionBarButtons:void 0}):e.warningActionButtons?Object(o.__assign)(Object(o.__assign)({},e),{warningActionButtons:void 0}):e.messageType===c.Designer?Object(o.__assign)(Object(o.__assign)({},e),{actionBarButtons:void 0,feedbackSectionPosition:ro.None,body:Object(o.__assign)(Object(o.__assign)({},e.body),{isRehydration:!0})}):e).messageType===c.ChatCardWrapper){var s=a.body;s.renderData&&s.element&&(a=Object(o.__assign)(Object(o.__assign)({},a),{body:Object(o.__assign)(Object(o.__assign)({},s),{element:void 0})}))}var l="";try{l=JSON.stringify(a)}catch(e){wb("error while stringify chat card props error:",e.message)}var u=n?yf.f.User:r?yf.f.System:yf.f.Copilot;return function(e,t,n,r,o,i,a,s,l){var c={content:e,entry:t,userRole:n,format:r,timestamp:Date.now(),messageId:Object(xf.a)(),status:o,richTextJson:i,messageMetadata:a,userId:s,rephrasedMessage:l};n==yf.f.User&&(Cv.Instance.CurrentUserMessageId=c.messageId);return c}(t,yf.a.Pane,u,yf.b.RichText,r?yf.e.Failure:yf.e.Success,l,i)}function Fv(e,t){var n,r,i,a,s,l,u,d,p="";switch(t){case c.Default:p=function(e){var t,n,r,i,a="";(null==e?void 0:e.messageHeader)&&(a=a+Nv(e.messageHeader)+"\n");if(null==e?void 0:e.embeddedLists)try{for(var s=Object(o.__values)(e.embeddedLists),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.listHeader&&(a=a+c.listHeader+"\n"),c.listItems)try{for(var u=(r=void 0,Object(o.__values)(c.listItems)),d=u.next();!d.done;d=u.next()){var p=d.value;a+=p.title?"".concat(p.title,": ").concat(p.text+"\n"):"".concat(p.text+"\n")}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}c.listFooter&&(a=a+Nv(c.listFooter)+"\n")}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}(null==e?void 0:e.messageFooter)&&(a+=Nv(e.messageFooter));return a}(e.defaultMessageProps);break;case c.MarkdownCard:p=null!==(r=null===(n=e.markDownCardProps)||void 0===n?void 0:n.message)&&void 0!==r?r:"";break;case c.WarningMessage:p=(null===(i=e.warningMessageCardProps)||void 0===i?void 0:i.warningPrefix)+(null!==(s=null===(a=e.warningMessageCardProps)||void 0===a?void 0:a.warningEmphasizedText)&&void 0!==s?s:"")+(null!==(u=null===(l=e.warningMessageCardProps)||void 0===l?void 0:l.warningSuffix)&&void 0!==u?u:"");break;case c.ChatCardWrapper:p=null!==(d=e.chatCardWrapperProps.textContent)&&void 0!==d?d:"";break;case c.StreamingAdaptiveCard:p=function(e){if(!e)return"";var t=e.basin,n=e.uniqueId,r=e.accessPath;if((null==t?void 0:t.items)&&n&&r){var o=al()(e.basin.items[e.uniqueId],e.accessPath);return(null==o?void 0:o.body)?o.body.map((function(e){return e.text})).join("\n"):""}}(e.streamingAdaptiveCardProps);case c.ContentCard:case c.AccordionCard:case c.ProactiveSuggestionCard:case c.SelfHelpAdaptiveCard:}return p}function Nv(e){var t,n="";return(null==e?void 0:e.text)&&(n+=e.text),(null==e?void 0:e.linkText)&&(n=null!==(t=n+e.linkText.text+e.linkText.linkSuffix)&&void 0!==t?t:""),n}var Hv,Uv,Vv,zv,Gv,Wv=function(){function e(e,t){var n=this;this.chatHistoryResponseTimerID=null,this.workflowAnnotationType=Cf.c.getTypeName(),this.chatHistoryResponseTimeout=mm,this.hasExistingChat=!0,this.telemetryLoggerUtils=om.getInstance(),this.chatHistoryResponseTimeoutInternal=function(){n.chatHistoryResponseTimerID=null,wb("Chat History Augloop Response Timed Out for workflow",n.workflowAnnotationType),Gb.getInstance().clearOperationListForResubmit(),n.setIsChatHistoryLoading(!1),n.hasExistingChat&&n.setIsChatHistoryTimedOut(!0),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatHistoryTimeout},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()},{key:hf.ChatErrorType,value:kf.Server}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:ff.ErrorMessage,value:wm},{key:ff.ErrorType,value:kf.Server},{key:ff.ErrorCode,value:Jm.ChatHistoryResponseTimeout},{key:ff.ErrorCategory,value:pf.ChatEvents}]),n.hasExistingChat=!0},this.setIsChatHistoryLoading=e,this.setIsChatHistoryTimedOut=t,this.workflowAnnotationType=this.getChatHistoryWorkflowType(),this.chatHistoryResponseTimeout=this.getChatHistoryResponseTimeout()}return e.getInstance=function(t,n){if(!e.sInstance){if(um(t))throw new Error("setIsChatSessionIdSet is null or undefined");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(){wb("Setting chat history augloop response Timer"),this.clearAugloopResponseTimer(!1),this.setIsChatHistoryLoading(!0),this.setIsChatHistoryTimedOut(!1),this.chatHistoryResponseTimerID=window.setTimeout(this.chatHistoryResponseTimeoutInternal,this.chatHistoryResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(e){void 0===e&&(e=!0),null!==this.chatHistoryResponseTimerID&&(wb("Clear chat history augloop response Timer"),clearTimeout(this.chatHistoryResponseTimerID),this.chatHistoryResponseTimerID=null,e&&this.setIsChatHistoryLoading(!1))},Object.defineProperty(e.prototype,"isAugloopResponseTimerSet",{get:function(){return null!==this.chatHistoryResponseTimerID},enumerable:!1,configurable:!0}),e.prototype.setHasExistingChat=function(e){this.hasExistingChat=e},e.prototype.getChatHistoryWorkflowType=function(){return dv.getInstance().isWorkflowRegistered(Cf.c.getTypeName())?Cf.c.getTypeName():dv.getInstance().isWorkflowRegistered(Cf.a.getTypeName())?Cf.a.getTypeName():Cf.b.getTypeName()},e.prototype.getChatHistoryResponseTimeout=function(){var e;return null!==(e=dv.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType))&&void 0!==e?e:mm},e}(),Qv=[],qv=null,Kv=null,Yv=null,Zv=null,Jv=!0,Xv=!1,$v=function(e,t,n,r,i){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var a,s,l,c,u,d,p,g;return Object(o.__generator)(this,(function(o){switch(a={},s=new vv.a,l=Date.now(),c=om.getInstance(),u=function(){if(Iv){var e=xv===Vd.Work?yf.d.Enterprise:yf.d.Document;return wb("Orchestrator grounding mode used for Chat:",e),e}}(),e){case yf.c.AddChatOperation:"dummyUserId","dummyDocId",d={userId:"dummyUserId",documentId:"dummyDocId",sessionId:Object(xf.a)(),messages:[]},a={newChat:d,type:yf.c.AddChatOperation},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv});break;case yf.c.GetAllChatsOperation:p={pageSize:40,syncState:i?void 0:Zv},a={type:yf.c.GetAllChatsOperation,paging:p},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv});break;case yf.c.GetCurrentChatOperation:p={pageSize:10},a={type:yf.c.GetCurrentChatOperation,paging:r&&r.isFeatureGateEnabledFromClient(Km.IsChatHistoryPaginationEnabled)?p:void 0},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv});break;case yf.c.GetMessagesOperation:p={pageSize:10,syncState:i?void 0:Yv},qv=null!=i?i:qv,a={type:yf.c.GetMessagesOperation,chatSessionId:qv,paging:p,setSessionAsCurrent:!!i},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv});break;case yf.c.AddMessageOperation:Qv.push(t.messageId),a={newMessage:t,type:yf.c.AddMessageOperation,chatSessionId:qv},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv});break;case yf.c.DeleteChatOperation:a={type:yf.c.DeleteChatOperation,chatSessionId:i},s=new vv.a({operation:a,documentURLOrLocalPath:n,timestamp:l,documentSensitivity:Vv,orchestratorGroundingMode:u,isFluxChatHistoryAnnotationActivated:Xv})}return g=new bv.b({parentPath:["Signal",vv.a.getTypeName()],items:[{id:yv.a.generateId(),body:s}]}),qf.getInstance().sendLoggingEventToClient(Vf.ChatHistorySignalSent,{timestamp:(new Date).getTime(),signalName:vv.a.getTypeName(),operationType:e}),c.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatHistorySignalSent},{key:hf.ChatEventParameters,value:"".concat(vv.a.getTypeName(),"_").concat(e)}]),wb("Submitting signal to Augloop : ".concat(vv.a.getTypeName()," with operation type: ").concat(e," and signal: ").concat(JSON.stringify(s))),(null==t?void 0:t.content)&&wb("sending message: ".concat(t.content)),Gb.getInstance().submitOperation(g,vv.a.getTypeName()),Hv=(new Date).getTime(),e===yf.c.GetCurrentChatOperation&&Wv.getInstance().setAugloopResponseTimer(),[2]}))}))},eb=function(e,t,n,r,i,a,s,l,c,u){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B;return Object(o.__generator)(this,(function(R){switch(R.label){case 0:switch(d=null===(w=null===(I=e.body)||void 0===I?void 0:I.H_)||void 0===w?void 0:w.T_,wb("".concat(vv.a.getTypeName()," response. Time Taken : ").concat(CO(Hv)," sec \n")),p=null==e?void 0:e.body,g=null==p?void 0:p.operationResponse,h=om.getInstance(),qf.getInstance().sendLoggingEventToClient(Vf.ChatHistoryResponseReceived,{timeInMs:OO(Hv),annotationName:d,operationType:g.type}),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:"".concat(d,"_").concat(g.type)},{key:hf.Cv,value:u}]),f={operationType:yf.c.GetChatOperation,augloopResponseTime:-1},m=CO(Hv),g.type){case yf.c.GetCurrentChatOperation:return[3,1];case yf.c.GetMessagesOperation:return[3,7];case yf.c.GetAllChatsOperation:return[3,8];case yf.c.GetChatOperation:return[3,9];case yf.c.GetMessagesInCurrentChatSession:return[3,10];case yf.c.AddChatOperation:return[3,11];case yf.c.AddMessageOperation:return[3,12];case yf.c.DeleteChatOperation:return[3,13]}return[3,14];case 1:return S=g,f={operationType:yf.c.GetCurrentChatOperation,augloopResponseTime:m},Yv=null===(T=S.paging)||void 0===T?void 0:T.syncState,S.chat?[3,5]:(Wv.getInstance().setHasExistingChat(!1),c?[3,3]:[4,$v(yf.c.AddChatOperation)]);case 2:return R.sent(),[3,4];case 3:Wv.getInstance().clearAugloopResponseTimer(),R.label=4;case 4:return[3,6];case 5:qv=null===(k=S.chat)||void 0===k?void 0:k.sessionId,Kv=qv,wb("chatSessionId from GetCurrentChatOperation: "+qv),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatHistorySessionLoaded},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),0===n&&S.chat&&Wv.getInstance().isAugloopResponseTimerSet&&Dv(r,S.chat.messages,t),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.GetCurrentChatStatus},{key:hf.ChatEventParameters,value:g.status}]),g.status!==yf.e.Success&&Wv.getInstance().isAugloopResponseTimerSet&&(r.sendEventToClient(Uf.ChatHistoryHydrationFailed),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatHistoryHydrationFailed}])),Wv.getInstance().clearAugloopResponseTimer(),R.label=6;case 6:return null==a||a(null!==(P=null===(j=S.chat)||void 0===j?void 0:j.plugins)&&void 0!==P?P:[]),[3,14];case 7:if(Yv=null===(A=(S=g).paging)||void 0===A?void 0:A.syncState,l&&(S.status===yf.e.Success?(Qv=[],Jv=!0,Kv=qv,0===(null===(_=S.messages)||void 0===_?void 0:_.length)&&(null==l||l((function(){return[]})))):(qv=Kv,null==l||l())),(null===(D=S.messages)||void 0===D?void 0:D.length)>0){v=[];try{for(b=Object(o.__values)(S.messages),y=b.next();!y.done;y=b.next())C=y.value,r.isFeatureGateEnabledFromClient(Km.DisableChatHistoryPaginationFix)||Qv.includes(C.messageId)||(v.push(C),Qv.push(C.messageId))}catch(e){E={error:e}}finally{try{y&&!y.done&&(x=b.return)&&x.call(b)}finally{if(E)throw E.error}}(null==v?void 0:v.length)>0&&(Jv=!0,O=function(e){var t=l?[]:e,n=Lv(v);return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(n),!1),Object(o.__read)(t),!1)},l?l(O):t(O))}else S.status!==yf.e.Failure&&(Jv=!1);return h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.GetMessagesStatus},{key:hf.ChatEventParameters,value:S.status}]),[3,14];case 8:return g.status===yf.e.Success?(Zv=null!==(M=null===(L=g.paging)||void 0===L?void 0:L.syncState)&&void 0!==M?M:Zv,null==s||s(g.chats,!1)):null==s||s([],!0),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.GetAllChatStatus},{key:hf.ChatEventParameters,value:g.status}]),[3,14];case 9:case 10:return[3,14];case 11:return f={operationType:yf.c.AddChatOperation,augloopResponseTime:m},g.status===yf.e.Success&&(c?tb():(qv=null===(B=g.chats)||void 0===B?void 0:B[0].sessionId,Kv=qv),wb("chatSessionId from AddChatOperation: "+qv)),Wv.getInstance().clearAugloopResponseTimer(),i&&i(),[3,14];case 12:return f={operationType:yf.c.AddMessageOperation,augloopResponseTime:m},c&&g.status===yf.e.Success&&(qv=g.chat.sessionId,Kv=qv,wb("chatSessionId from AddMessageOperation: "+qv)),h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.AddMessageStatus},{key:hf.ChatEventParameters,value:g.status}]),[3,14];case 13:return S=g,h.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.DeleteMessageStatus},{key:hf.ChatEventParameters,value:S.status}]),[3,14];case 14:return-1!==f.augloopResponseTime&&(om.getInstance().addChatHistoryInfoLog(f),om.getInstance().sendTelemetryLatencyData([])),[2]}}))}))},tb=function(){qv="",Kv="",Yv=null,Zv=null,Qv=[],Jv=!0},nb=n(484),rb=n(1140),ob=n(1541),ib=n(1542),ab=function(e,t,n){var r,o,i=Object(xf.a)(),a=rb.a.POST;e===rb.b.Suggestion?(r=lb(i),o=ub()):(r=cb(t,n),o=db(i));var s={request:r,headers:o,httpMethod:a,type:e,queryId:i,scenario:sv.getSubstrateScenarioName()},l=new bv.a({parentPath:["Signal",ob.a.getTypeName()],items:[{id:yv.a.generateId(),body:new ob.a(s)}]});return om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.SubstrateAPIOperationSubmitted},{key:hf.ChatEventParameters,value:e},{key:hf.UserQueryGuid,value:i}]),zv=(new Date).getTime(),l},sb=function(e,t,n){var r,o,i;wb("".concat(lv.a.getTypeName()," response received\n Time Taken: ").concat(CO(zv),"s "));var a=e.body,s=a.queryId,l=a.status,c=a.results,u=a.error,d=a.httpStatus,p=a.type,g=om.getInstance();if(g.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:lv.a.getTypeName()},{key:hf.UserQueryGuid,value:s},{key:hf.Cv,value:n}]),g.sendTelemetryLatencyData([{key:gf.SubstrateAPIResponseTime,value:CO(zv)},{key:gf.UserQueryGuid,value:s}]),s&&wb("substrateAPIResponseAnnotationProcessor: queryID: ",s),d&&wb("substrateAPIResponseAnnotationProcessor: httpStatus: ",d),c&&wb("substrateAPIResponseAnnotationProcessor: results: ",c),l===ib.a.Failed){var h="";return u?(wb("substrateAPIResponseAnnotationProcessor: error: ",u),h=null!==(r=null==u?void 0:u.code)&&void 0!==r?r:""):h=null!==(o=null==d?void 0:d.toString())&&void 0!==o?o:"",void g.sendTelemetryChatEventData([{key:hf.ChatEventType,value:"".concat(lv.a.getTypeName(),"_Error")},{key:hf.ChatEventParameters,value:h},{key:hf.ChatErrorType,value:kf.Server},{key:hf.UserQueryGuid,value:s}])}if(l===ib.a.Success&&p===rb.b.Suggestion&&c)try{var f=JSON.parse(null!=c?c:""),m=null==f?void 0:f.Groups,v=null===(i=null==m?void 0:m[0])||void 0===i?void 0:i.Suggestions;(null==v?void 0:v.length)>0&&t(v)}catch(e){return void wb("substrateAPIResponseAnnotationProcessor: failed to parse results")}},lb=function(e){var t={EntityRequests:[{EntityType:"Prompt",Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:sv.getAppName()}}]}]},Size:100}],TimeZone:"UTC",Cvid:e,Scenario:{Name:sv.getSubstrateScenarioName(),Dimensions:[{DimensionName:"UserExperience",DimensionValue:"PromptLibrary"}]}};return JSON.stringify(t)},cb=function(e,t){void 0===t&&(t=!1);var n={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:t,ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(n)},ub=function(){return[{key:Vm.XClientLanguage,value:sv.getLanguage()},{key:Vm.XClientFlights,value:"EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion"}]},db=function(e){return[{key:Vm.ClientRequestId,value:e}]},pb=Cm,gb=function(e){pb=e},hb="libbie-loader",fb="https://admin.microsoft.com",mb="https://admin-ignite.microsoft.com",vb=null,bb=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return vb.updateSelectedFacets(e?{displayCategory:[e]}:void 0),[4,Object(nb.b)({centroEnvironmentBaseUrl:sv.isDevbuild()?mb:fb,preConfig:{hostName:"SharedCopilot",locale:"en",perfPrefix:"SharedCopilot_"},enableUxVersionQueryParam:!0})];case 1:return o.sent(),t=function(e){e("centro.hvc.libbieloader",vb)},[4,Object(nb.c)({featureName:hb,adapters:{dataSources:t},localMode:!!window.localStorage.getItem("centro.hvc-loader.localMode")})];case 2:return o.sent(),[4,Object(nb.a)({featureName:hb})];case 3:return n=o.sent(),r=document.createElement("div"),[4,n.main(r)];case 4:return o.sent(),[2]}}))}))},yb=n(1540),Cb=function(){function e(t,n,r){var o=this;this.citationPathDataIndexMap=new Map,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.streamChunks=[],this.isAnswerCompleted=!1,this.isBasicChatStreaming=!1,this.queryID="",this.suggestedQnaSignalSubmitTime=0,this.featureName=jf.ChatQnA,this.onClickCitationLink=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=""),wb("onClickCitationLink called with referenceId : ".concat(e,"  ,path"),o.citationPathDataIndexMap.get(e));var r={correlationId:"",featureName:""};try{r=JSON.parse(n)}catch(e){wb("Error parsing telemetry data on citation click",e.message)}o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CitationClicked},{key:hf.UserQueryGuid,value:r.correlationId||""}]);var i={referencePath:t.length>0?t:o.citationPathDataIndexMap.get(e),workflowAnnotationType:Sf.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(Uf.CitationLinkClicked,i)},this.sendBasicChatSuggestionPillsEvent=function(e){var t={suggestionPills:e,workflowAnnotationType:Sf.b.getTypeName()};o.copilotCommunicationHandler.sendEventToClient(Uf.BasicChatSuggestionPills,t)},this.getMarkdownReferences=function(e){return void 0===e||e&&0===e.length||!o.basicChatProps.isCitationsEnabled?[]:(o.citationPathDataIndexMap.clear(),e.map((function(e){var t,n,r;o.citationPathDataIndexMap.set(e.contentIndex,e.path),e.content&&e.content.length>150&&(e.content=e.content.substring(0,150).trim()+"...");var i='"'+e.content.slice(0,18).trim()+'..."';return e.content='"'+e.content+'"',{referenceIndex:e.contentIndex,referenceProps:{title:i,primarySubtitle:null===(t=o.basicChatProps)||void 0===t?void 0:t.citationTitle,snippet:e.content,iconAppName:e.type,referenceType:ri.Internal,citationPosition:e.position,onClickCitationLink:o.onClickCitationLink,sensitivityLabel:null===(r=null===(n=o.basicChatProps)||void 0===n?void 0:n.sensitivityIndicatorData)||void 0===r?void 0:r.badgeText,path:e.path}}})))},this.updateCardWithFooter=function(){var t,n;o.chatContainerBuilder.updateLastMessage(c.MarkdownCard,void 0,{feedbackSectionPosition:ro.Footer,showAnimation:!0,actionButtonList:[o.getCopyButton()],clpSensitivityIndicatorData:null!==(n=null===(t=e.getInstance().getBasicChatProps())||void 0===t?void 0:t.sensitivityIndicatorData)&&void 0!==n?n:void 0},!0)},this.sendBasicChatProcessingEvent=function(e){o.copilotCommunicationHandler.sendEventToClient(Uf.BasicChatStatus,e)},this.getFeedbackData=function(){var e=o.copilotCommunicationHandler.getFeedbackData(),t=o.featureName;return e&&!e.feedbackArea&&(e={feedbackArea:t===jf.Draft?Qm.DRAFT:Qm.BASIC_CHAT,contextData:{cardMetaData:JSON.stringify({prompt:fO,promptId:o.queryID}),sydneyContextData:{conversationId:Cv.Instance.ConversationId,sydneyEndpoint:Cv.Instance.SydneyEndpoint,requestId:Cv.Instance.RequestId,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:Cv.Instance.CurrentUserMessageId},feedbackContextData:{prompt:fO,promptId:o.queryID},groundingSource:wv(),entryPoint:"Chat"}}),e},this.handleTimeoutForBasicChatStreaming=function(){var t=o.getFeatureName();o.isFirstStreamChunk||(o.paragraphChunks.length>0&&(o.updateCardWithFooter(),o.resetBasicChatStreamingStates(!1)),o.isAnswerCompleted||o.chatContainerBuilder.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:vm}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ro.Footer,isFailure:!0,showAnimation:!1,feedbackData:o.getFeedbackData(),telemetryData:JSON.stringify({correlationId:e.getInstance().getQueryID(),featureName:e.getInstance().getFeatureName()})},!0),o.setIsExecuting(!1)),o.sendBasicChatProcessingEvent({status:zf.Finished,workflowAnnotationType:Sf.b.getTypeName(),queryID:o.queryID,isSuccess:!1}),o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.BasicChatStreamingResponseTimeout},{key:hf.UserQueryGuid,value:o.queryID},{key:hf.ChatErrorType,value:kf.Server}]),o.telemetryLoggerUtils.logErrorWithAshaVetoAndError([{key:Gf,value:o.queryID}],t,"",Pf.BasicChatResponseTimedOut,_f.Timeout),o.resetBasicChatStreamingStates(!1)},this.sendLoggingEventToClient=function(e,t){o.loggingEventHandler.sendLoggingEventToClient(e,t)},this.getIsFirstStreamChunk=function(){return o.isFirstStreamChunk},this.setIsFirstStreamChunk=function(e){o.isFirstStreamChunk=e},this.getParagraphChunks=function(){return o.paragraphChunks},this.setParagraphChunks=function(e){o.paragraphChunks=e},this.getIsAnswerCompleted=function(){return o.isAnswerCompleted},this.setIsAnswerCompleted=function(e){o.isAnswerCompleted=e},this.getIsBasicChatStreaming=function(){return o.isBasicChatStreaming},this.setIsBasicChatStreaming=function(e){o.isBasicChatStreaming=e},this.setQueryID=function(e){o.queryID=e},this.setFeatureName=function(e){o.featureName=e},this.getFeatureName=function(){return o.featureName},this.getQueryID=function(){return o.queryID},this.setBasicChatProps=function(e){o.basicChatProps=e},this.getIsFluxFlowEnabled=function(){var e;return null===(e=o.basicChatProps)||void 0===e?void 0:e.isFluxFlowEnabled},this.updateStreamChunks=function(e){o.streamChunks.push(e)},this.getStreamChunks=function(){return o.streamChunks},this.getBasicChatProps=function(){return o.basicChatProps},this.getSuggestedQnaSignalSubmitTime=function(){return o.suggestedQnaSignalSubmitTime},this.getSuggestedQnaScenarioSignalOperation=function(){var e={isBasicChat:!0,chatHistory:[],isStreaming:!0,queryId:Object(xf.a)(),userLanguage:gm(sv.getLanguage()),isSuggestedQnAScenario:!0},t=new bv.b({parentPath:["Signal",yb.a.getTypeName()],items:[{id:yv.a.generateId(),body:new yb.a(e)}]});return o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.BasicChatOperationSubmitted},{key:hf.UserQueryGuid,value:e.queryId}]),o.suggestedQnaSignalSubmitTime=(new Date).getTime(),t},this.resetBasicChatStreamingStates=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),o.streamChunks.length>0&&(o.telemetryLoggerUtils.sendTelemetryLatencyData([{key:gf.QnAResponseTime,value:CO(pO)},{key:gf.IsQuerySuccess,value:e},{key:gf.QnAChunkInfo,value:JSON.stringify(o.getStreamChunks())},{key:gf.UserQueryGuid,value:o.queryID},{key:gf.AnnotationType,value:Sf.b.getTypeName()}],t),e&&o.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QuerySuccessful},{key:hf.UserQueryGuid,value:o.queryID},{key:hf.ChatEventParameters,value:Sf.b.getTypeName()}])),o.setIsFirstStreamChunk(!0),o.setParagraphChunks(Cm),o.setIsAnswerCompleted(!1),o.setIsBasicChatStreaming(!1),o.setQueryID(Cm),o.telemetryLoggerUtils.setUserQueryGuid(Cm),o.streamChunks=[],o.featureName=jf.ChatQnA},this.chatContainerBuilder=t,this.copilotCommunicationHandler=n,this.setIsExecuting=r,this.loggingEventHandler=qf.getInstance(),this.telemetryLoggerUtils=om.getInstance()}return e.getInstance=function(t,n,r){if(!e.instance){if(!t||!r||!n)throw new Error("BasicChat Utils is not initialized");e.instance=new e(t,n,r)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.getCopyButton=function(){return{type:qo.Default,title:km(),text:s()?"":km(),iconRegular:s()?pt.e:pt.c,popoverProps:{popoverTitle:Pm()},position:s()?Ko.FeedbackSection:Ko.ActionButtonBar,handleButtonOnClick:pm}},e}(),Ob=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e.prototype.toString=function(){return"".concat(this.value,".").concat(this.nextChild)},e}();var Sb=function(){function e(){this.currentCvQueryGuid=hO,this.cvBase=function(){if(!Gv){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));Gv=new Ob(t.join(""))}return Gv}(),this.currentCvQueryGuid=hO,this.queryCv=this.cvBase.getNext(),this.alSessionKey=Cm}return e.getInstance=function(){return um(e.instance)&&(e.instance=new e),e.instance},e.prototype.resetCvData=function(){wb("Reset Cv data to generate next cv for new query"),this.currentCvQueryGuid=hO,this.queryCv=this.cvBase.getNext()},e.prototype.getBaseCv=function(){return this.cvBase},e.prototype.setAlSessionKey=function(e){this.alSessionKey=e},e.prototype.getAlSessionKey=function(){return this.alSessionKey},e.prototype.getQueryCv=function(){var e,t,n;return this.currentCvQueryGuid==hO?this.queryCv.getNext():this.resetCvData(),wb("cvBase: ".concat(null===(e=this.cvBase)||void 0===e?void 0:e.toString(),", queryCv: ").concat(null===(t=this.queryCv)||void 0===t?void 0:t.toString(),", userQueryGuid: ").concat(hO)),null===(n=this.queryCv)||void 0===n?void 0:n.toString()},e}(),Eb=function(){function e(e,t){var n=this;this.augloopResponseTimerID=null,this.augloopResponseTimeout=fm,this.telemetryLoggerUtils=om.getInstance(),this.augloopResponseTimeoutInternal=function(){n.augloopResponseTimerID=null,wb("Augloop Response Timed Out for workflow",n.workflowAnnotationType),Gb.getInstance().clearOperationListForResubmit(),n.augloopResponseTimeout=fm;var e=!0,t=Cm;n.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.EnableALCorrelationLogs)&&(t=Sb.getInstance().getQueryCv()),n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:gf.ErrorParameter,value:mf.AugloopResponseTimeout},{key:gf.ErrorType,value:kf.Server}]),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.AugloopResponseTimeout},{key:hf.ChatErrorType,value:kf.Server},{key:hf.ChatEventParameters,value:n.workflowAnnotationType},{key:hf.ChatErrorKey,value:vf.AugloopResponseTimeoutMessage},{key:hf.Cv,value:t},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:ff.ErrorMessage,value:Im},{key:ff.ErrorType,value:kf.Server},{key:ff.ErrorCode,value:Jm.AugloopResponseTimeout},{key:ff.ErrorCategory,value:pf.ChatEvents}]),n.workflowAnnotationType===Ef.a.getTypeName()?n.setSensitivityWarningInfo():(Cb.getInstance().getIsBasicChatStreaming()&&n.workflowAnnotationType===Sf.b.getTypeName()&&(Cb.getInstance().handleTimeoutForBasicChatStreaming(),e=!1),n.copilotCommunicationHandler.sendEventToClient(Uf.AugloopResponseTimeout,{workflowAnnotationType:n.workflowAnnotationType}),Cv.Instance.ErrorMessage="Augloop_Response_TimedOut_"+n.workflowAnnotationType),e&&n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(pO)},{key:gf.IsQuerySuccess,value:!1}],!0)},this.copilotCommunicationHandler=e,this.setSensitivityWarningInfo=t}return e.getInstance=function(t,n){if(!e.sInstance){if(!t||!n)throw new Error("AugloopResponseTimeoutHandler has not been initialized");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(e){var t;wb("Setting augloop response Timer for workflow ".concat(e)),this.clearAugloopResponseTimer(),um(e)||(this.workflowAnnotationType=e),um(this.workflowAnnotationType)||(this.augloopResponseTimeout=dv.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)),this.augloopResponseTimeout=null!==(t=this.augloopResponseTimeout)&&void 0!==t?t:fm,this.augloopResponseTimerID=window.setTimeout(this.augloopResponseTimeoutInternal,this.augloopResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(){null!==this.augloopResponseTimerID&&(wb("Clear augloop response Timer"),clearTimeout(this.augloopResponseTimerID),this.augloopResponseTimerID=null,this.augloopResponseTimeout=fm)},e.prototype.isAugloopResponseTimerSet=function(){return!um(this.augloopResponseTimerID)},e}(),xb=!1,Ib=function(e){xb=e},wb=function(e,t){if(sv.isDevbuild()){var n=fv.getInstance();null==t?(console.log("CopilotChat Log:",e),null==n||n.addLog("CopilotChat Log:",e)):(console.log("CopilotChat Log:",e,t),null==n||n.addLog("CopilotChat Log:",e,t))}},Tb=function(){var e,t,n,r=null===(n=null===(e=window.getSelection)||void 0===e?void 0:(t=e.call(window)).getRangeAt)||void 0===n?void 0:n.call(t,0).startOffset;return r||0===r?r:-1},kb=function(){var e=window.getSelection();return e?e.isCollapsed:(wb("window.getSelection() returned null"),!1)},jb=function(e,t){var n,r;if(void 0===t&&(t=!0),0===e.length)return-1;var o=e.length-1;return e.length>=2&&(e[o].messageType===c.FeedbackNudge||"human"===(null===(r=null===(n=t&&e[o])||void 0===n?void 0:n.body)||void 0===r?void 0:r.user))&&(o=e.length-2),o};function Pb(e){return null==e}var Ab=function(){return dv.getInstance().isWorkflowRegistered(Cf.c.getTypeName())||dv.getInstance().isWorkflowRegistered(Cf.b.getTypeName())||dv.getInstance().isWorkflowRegistered(Cf.a.getTypeName())},_b=function(){return dv.getInstance().isWorkflowRegistered(mv.a.getTypeName())&&dv.getInstance().getWorkflowDataMap().get(mv.a.getTypeName()).workflowInfo.shouldHandleResponse},Db=function(e,t){var n=e;return(null==t?void 0:t.length)&&t.reverse().forEach((function(t){var r=Object(o.__read)(t.range,2),i=r[0],a=r[1],s=e.slice(i,a+1),l="[".concat(s,"](").concat(t.value,")");n=n.slice(0,i)+l+n.slice(a+1)})),{user:Wm.Human,message:n,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}};function Lb(e){var t=Object.keys(e).filter((function(e){return"themeBackground"!==e})).reduce((function(t,n){var r;return Object.assign(t,((r={})[n]=e[n],r))}),{});return t}var Mb=function(e){var t=e,n=!1;return e.includes("<entity")?(t=e.slice(0,e.indexOf("<entity")),n=!0):e.includes("<placeholder")&&(t=e.slice(0,e.indexOf("<placeholder"))),{inputSpanText:t,isFileEntityPresent:n}},Bb=function(){xb=!1,Hv=void 0,qv=null,Kv=null,Yv=null,Qv=[],Jv=!0,Vv=void 0,Xv=!1,Zv=null,vb=null,yO(),gb(Cm)};function Rb(e,t,n,r,o){var i=om.getInstance();wb("basicChatErrorHandler called with error : ".concat(e," and status : "),t);var a="";if(!Pb(e.errorDetailsJson))try{a=JSON.parse(e.errorDetailsJson).code}catch(e){wb("Error parsing error code from basic chat error",e.message)}Cb.getInstance().sendLoggingEventToClient(Vf.AugloopErrorReceived,{annotationName:o,timeInMs:OO(pO),chatEventParams:JSON.stringify({errorCategory:e.category,errorCode:a})}),i.sendTelemetryChatEventData([{key:hf.ChatEventType,value:"".concat(o,"_Error")},{key:hf.ChatEventParameters,value:"".concat(e.category,"_").concat(a)},{key:hf.ChatErrorType,value:kf.Server},{key:hf.UserQueryGuid,value:Cb.getInstance().getQueryID()}]),i.sendTelemetryLatencyData([{key:gf.ErrorParameter,value:"".concat(e.category,"_").concat(a)},{key:gf.ErrorType,value:kf.Server}]);var s=e.category,l=_f.Fallback,c=Pf.BasicChatUnclassifiedError;switch(s){case Zm.OffensiveContent:switch(c=Pf.BasicChatRAIFilterBlockedResponse,a){case Ym.OffensiveInputContent:l=_f.OffensiveInput,Fb(n,_m());break;case Ym.OffensiveOutputContent:l=_f.OffensiveOutput,Fb(n,Dm());break;case Ym.OutputBlockedByDynamicGuardList:l=_f.OutputBlocked,Fb(n,Dm());break;case Ym.InputBlockedByDynamicGuardList:l=_f.InputBlocked,Fb(n,Lm());break;default:Fb(n,Mm())}break;case Zm.PromptInjection:if(a===Ym.Detected)c=Pf.BasicChatRAIFilterBlockedResponse,l=_f.PromptInjection,Fb(n,Lm());else Fb(n,Mm());break;case Zm.InvalidSignal:switch(l=_f.InvalidSignal,c=Pf.BasicChatUnclassifiedError,a){case Ym.Missing:l=_f.SignalMissing,Fb(n,Mm());break;case Ym.WrongType:l=_f.SignalWrongType,Fb(n,Mm());break;default:Fb(n,Mm())}break;case Zm.InvalidLanguage:if(l=_f.InvalidLanguage,c=Pf.BasicChatUnsupportedCopilotFunctionality,a===Ym.NotSupported){var u=Cb.getInstance().getBasicChatProps();(null==u?void 0:u.languageHelpLink)?Nb(n,Hm(),Um(),u.languageHelpLink):Fb(n,Hm())}else Fb(n,Mm());break;case Zm.InferenceAPI:switch(a){case Ym.Timeout:c=Pf.BasicChatResponseTimedOut,l=_f.Timeout,Fb(n,Bm());break;case Ym.UserThrottled:l=_f.UserThrottled,c=Pf.BasicChatCapacityIssues,Fb(n,Fm());break;case Ym.Throttled:l=_f.Throttled,c=Pf.BasicChatCapacityIssues,Fb(n,Rm());break;case Ym.ScenarioThrottled:l=_f.ScenarioThrottled,c=Pf.BasicChatCapacityIssues,Fb(n,Rm());break;case Ym.NotAvailable:l=_f.APIUnavailable,c=Pf.BasicChatBadResponse,Fb(n,Bm());break;case Ym.InputRaiDependency:l=_f.RAIOnInputError,c=Pf.BasicChatRAIFilterBlockedResponse,Fb(n,_m());break;case Ym.OutputRaiDependency:l=_f.RAIOnOutputError,c=Pf.BasicChatRAIFilterBlockedResponse,Fb(n,Mm());break;case Ym.UnknownOpenAI:l=_f.UnknownError,c=Pf.BasicChatBadResponse,Fb(n,Mm());break;case Ym.BadResponse:l=_f.BadResponse,c=Pf.BasicChatBadResponse,Fb(n,Mm());break;case Ym.BadRequest:l=_f.BadRequest,c=Pf.BasicChatUnclassifiedError,Fb(n,Mm());break;case Ym.Unknown:l=_f.Unknown,c=Pf.BasicChatUnclassifiedError,Fb(n,Mm());break;default:Fb(n,Mm())}break;case Zm.InvalidInput:if(a===Ym.TooLong)l=_f.InputTooLong,c=Pf.BasicChatInputNotProcessed,Fb(n,Nm());else Fb(n,Mm());break;default:Fb(n,Mm())}i.logErrorWithAshaVetoAndError([{key:hf.UserQueryGuid,value:Cb.getInstance().getQueryID()}],Cb.getInstance().getFeatureName(),Cm,c,l),Cb.getInstance().getIsFluxFlowEnabled()||(wb("Encountered Error. Stopping loading UI"),r(!1))}var Fb=function(e,t){e.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ro.Footer,isFailure:!0,showAnimation:!1,feedbackData:Cb.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:Cb.getInstance().getQueryID(),featureName:Cb.getInstance().getFeatureName()})},!0)},Nb=function(e,t,n,r){e.setChatMessageData(c.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t,linkText:{text:n,linkOnClick:Hb,linkUrl:r}}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ro.Footer,isFailure:!0,showAnimation:!1,feedbackData:Cb.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:Cb.getInstance().getQueryID(),featureName:Cb.getInstance().getFeatureName()})},!0)},Hb=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return window.open(e),[2]}))}))},Ub=22;function Vb(){return"object"==typeof window&&window.crypto&&function(){var e=new Uint8Array(Ub);window.crypto.getRandomValues(e);for(var t=new Array(Ub),n=0;n<Ub;n++)t[n]=e[n]/256;return t}()||function(){for(var e=new Array(Ub),t=0;t<Ub;t++)e[t]=Math.random();return e}()}var zb,Gb=function(){function e(e,t,n,r,o){this.isSessionConnected=!0,this.isSessionClosed=!1,this.isLicenseAnnotationActivated=!0,this.operationListForResubmit=new Map,this.callbackTokens=[],this.annotationTokens=[],this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.alSession=n,this.isSessionClosed=this.alSession.isClosed,this.isSessionConnected=this.alSession.isConnected,this.loggingEventHandler=qf.getInstance(t),this.telemetryLoggerUtils=om.getInstance(),this.setIsExecuting=r,this.setALSessionClosed=o}return e.getInstance=function(t,n,r,o,i){return void 0===this.sInstance?(this.sInstance=new e(t,n,r,o,i),this.sInstance.registerCallbacks()):void 0!==r&&this.sInstance.alSession!==r&&(this.sInstance.releaseActiveAnnotations(),this.sInstance.removeCallbacks(),this.sInstance.alSession=r,this.sInstance.isSessionClosed=r.isClosed,this.sInstance.isSessionConnected=r.isConnected,this.sInstance.setALSessionClosed(this.sInstance.isSessionClosed),this.sInstance.registerCallbacks()),this.sInstance},e.resetInstance=function(){this.sInstance=void 0},e.prototype.removeCallbacks=function(){var e=this;this.callbackTokens.forEach((function(t){e.alSession.removeSessionStateCallback(t)})),this.callbackTokens=[]},e.prototype.releaseActiveAnnotations=function(){var e=this;this.isSessionClosed||this.annotationTokens.forEach((function(t){e.alSession.releaseAnnotation(t).then((function(e){wb("Annotation deactivated: "+e)})).catch((function(e){wb("error in deactivating: ",e)}))})),this.annotationTokens=[]},e.prototype.registerCallbacks=function(){this.registerOnConnectCallback(),this.registerOnDisconnectCallback(),this.registerOnReconnectCallback(),this.registerOnCloseCallback()},e.prototype.registerOnConnectCallback=function(){var e=this,t=this.alSession.setConnectCallback((function(t,n,r,o){var i=n.substring(n.lastIndexOf("/")+1);e.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.EnableALCorrelationLogs)&&(wb("Setting AL session key in CorrelationUtils from connect callback: ".concat(i)),Sb.getInstance().setAlSessionKey(i)),wb("AL Session onSessionConnect, isSeedingRequired: ".concat(t,", sessionKey: ").concat(i)),e.isSessionConnected=!0,e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALSessionConnected},{key:hf.ChatEventParameters,value:"isSeedingRequired: "+t.toString()},{key:hf.ALSessionKey,value:i}]),e.loggingEventHandler.sendLoggingEventToClient(Vf.ALSessionConnected,{chatEventParams:t.toString()}),t?_b()?e.resubmitTimerId=setTimeout((function(){var t,n,r,o,i,a,s;e.isLicenseAnnotationActivated||(wb("License annotation is not activated, so not re-submitting signal and showing error"),Fb(e.chatContainerBuilder,dm()?OfficeaicopilotStrings.LicenseValidationErrorMessage:"We encountered a problem validating your Copilot license. For more information, see https://aka.ms/copilotlicensecheck"),Eb.getInstance().clearAugloopResponseTimer(),t=mv.a.getTypeName(),n="License annotation is not activated",r=kf.Client,o=Af.UserAccessIssue,i=Df.Licensing,a=jf.CopilotChat,(s=om.getInstance()).sendTelemetryChatEventData([{key:hf.ChatEventType,value:"".concat(t,"_Error")},{key:hf.ChatEventParameters,value:n},{key:hf.ChatErrorType,value:r}]),s.sendTelemetryLatencyData([{key:gf.ErrorParameter,value:n},{key:gf.ErrorType,value:r},{key:gf.UserPerceivedLatency,value:CO(pO)},{key:gf.IsQuerySuccess,value:!1},{key:gf.FeatureName,value:a}],!0),s.logErrorWithAshaVetoAndError([],a,Cm,o,i),e.setIsExecuting(!1),e.copilotCommunicationHandler.sendEventToClient(Uf.ResetContextId)),e.clearOperationListForResubmit()}),6e3):e.resubmitOnLicenseAnnotationActivation():(e.clearOperationListForResubmit(),e.setLicenseAnnotationActivated(!0))}));this.callbackTokens.push(t)},e.prototype.registerOnDisconnectCallback=function(){var e=this,t=this.alSession.setDisconnectCallback((function(t){wb("AL Session Disconnected",t),e.isSessionConnected=!1,_b()&&e.setLicenseAnnotationActivated(!1),e.loggingEventHandler.sendLoggingEventToClient(Vf.ALSessionDisconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALSessionDisconnected},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}])}));this.callbackTokens.push(t)},e.prototype.registerOnReconnectCallback=function(){var e=this,t=this.alSession.setReconnectCallback((function(){e.isSessionConnected=!0,e.loggingEventHandler.sendLoggingEventToClient(Vf.ALSessionReconnected),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALSessionReconnected},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),wb("AL Session Reconnected")}));this.callbackTokens.push(t)},e.prototype.registerOnCloseCallback=function(){var e=this,t=this.alSession.setSessionCloseCallback((function(t){e.isSessionClosed=!0,e.setALSessionClosed(e.isSessionClosed),e.loggingEventHandler.sendLoggingEventToClient(Vf.ALSessionClosed),e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALSessionClosed}]),wb("AL Session Closed",t)}));this.callbackTokens.push(t)},e.prototype.activateAnnotation=function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a=this;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.alSession.activateAnnotation(e,{callback:t,config:n,forceReturnCachedAnnotations:i}).then((function(t){return Object(o.__awaiter)(a,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(i){return wb("Annotation Token: "+t.token),this.annotationTokens.push(t.token),e===Cf.c.getTypeName()||e===Cf.b.getTypeName()||e===Cf.a.getTypeName()||t.token.includes(Cf.c.getTypeName())||t.token.includes(Cf.b.getTypeName())||t.token.includes(Cf.a.getTypeName())?(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.ChatHistoryDuplicateLoggingFix)&&e===Cf.b.getTypeName()&&(Xv=!0),function(e,t){Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CurrentChatHistoryStart},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),Uv=(new Date).getTime(),[4,$v(yf.c.GetCurrentChatOperation,void 0,e,t)];case 1:return n.sent(),[2]}}))}))}(r,this.copilotCommunicationHandler)):(e===Sf.c.getTypeName()||t.token.includes(Sf.c.getTypeName()))&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsQnASuggestionPillCachingEnabled)?this.submitOperation(Cb.getInstance().getSuggestedQnaScenarioSignalOperation(),Sf.c.getTypeName()):e===lv.a.getTypeName()&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsSharedCopilotLabEnabled)&&this.submitOperation(ab(rb.b.Suggestion),lv.a.getTypeName()),n={workflowAnnotationType:e,responseToken:t.token},this.copilotCommunicationHandler.sendEventToClient(Uf.AnnotationActivated,n),[2]}))}))})).catch((function(e){wb("error in activating: ",e)}))];case 1:return s.sent(),[2]}}))}))},e.prototype.submitOperation=function(e,t){var n,r,o;(!1===this.isSessionConnected||!0===this.isSessionClosed||_b()&&!1===this.isLicenseAnnotationActivated)&&(wb("Session is not connected, adding operation to resubmit list."),this.operationListForResubmit.set(e,t),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.AddToOperationListForResubmit},{key:hf.ChatEventParameters,value:t}]));var i=function(){for(var e=Vb(),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<Ub;r++)n.push(t.charAt(Math.floor(e[r]*t.length)));return n.join("")}();if(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.EnableALCorrelationLogs)){i=Sb.getInstance().getQueryCv();var a=null===(n=this.alSession.getConnectParams())||void 0===n?void 0:n.sessionUrl;if(a){var s=a.substring(a.lastIndexOf("/")+1);Sb.getInstance().getAlSessionKey()||(wb("Setting AL session key in CorrelationUtils from submitOperation: ".concat(s)),Sb.getInstance().setAlSessionKey(s))}}var l=e.items.length>0?null===(o=null===(r=e.items[0])||void 0===r?void 0:r.body)||void 0===o?void 0:o.H_.T_:"";wb("Submitting operation to AL: ".concat(e,", signalName: ").concat(l,", cv: ").concat(i)),this.alSession.submitOperation(e,i);var c={workflowAnnotationType:t,cv:i,operation:JSON.stringify(e)};this.copilotCommunicationHandler.sendEventToClient(Uf.QuerySubmitted,c),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QuerySubmittedToAL},{key:hf.ChatEventParameters,value:l},{key:hf.Cv,value:i},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}]),this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:gf.RequestSignalType,value:l},{key:gf.Cv,value:i},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}])},e.prototype.clearOperationListForResubmit=function(){this.operationListForResubmit.clear(),wb("Operation list for resubmit is cleared"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResetOperationListForResubmit},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}])},e.prototype.setLicenseAnnotationActivated=function(e){this.isLicenseAnnotationActivated=e,wb("License Annotation Activated: "+e)},e.prototype.resubmitOnLicenseAnnotationActivation=function(){var e=this;wb("operationListForResubmit: ",this.operationListForResubmit),this.operationListForResubmit.forEach((function(t,n){var r,o;e.submitOperation(n,t),wb("Resubmitting signal for operation: ",n);var i=n.items.length>0?null===(o=null===(r=n.items[0])||void 0===r?void 0:r.body)||void 0===o?void 0:o.H_.T_:"";e.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QueryResubmittedToAL},{key:hf.ChatEventParameters,value:i}]),dv.getInstance().isAugloopResponseTimeoutRequired(t)&&Eb.getInstance().setAugloopResponseTimer(t)})),clearTimeout(this.resubmitTimerId),wb("Resubmitting signals for operations in operation list for resubmit is completed. Cleared resubmit timer."),this.clearOperationListForResubmit()},e}(),Wb=null,Qb=null,qb={},Kb=function(){function e(){}return e.getInstance=function(){return e.telemetryEventHandler||(e.telemetryEventHandler=new e),e.telemetryEventHandler},e.prototype.initTelemetryLatencyObject=function(){var e;e={},Object.keys(gf).forEach((function(t){e[t]=0})),Wb=e},e.prototype.initTelemetryChatEventObject=function(){var e;e={},Object.keys(hf).forEach((function(t){e[t]=""})),Qb=e},e.prototype.updateTelemetryLatencyData=function(e,t){null!=Wb&&(Object.keys(e).forEach((function(t){Wb[t]=e[t],qb[t]=e[t]})),t&&this.sendTelemetryLatencyData(t))},e.prototype.updateTelemetryChatEventData=function(e,t){null===Qb&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(t){Qb[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)},e.prototype.updateTelemetryQueryDetailsEventData=function(e){Object.keys(e).forEach((function(t){qb[t]=e[t]}))},e.prototype.sendTelemetryLatencyData=function(e){var t;null!=e&&(e.logEvent(((t=Wb)[gf.UserQueryGuid]=hO,t[gf.CopilotChatSessionId]=sv.getSessionId(),{eventType:pf.Latency,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e))},e.prototype.sendTelemetryQueryDetailsObject=function(e){var t;null==e||e.logEvent(((t=qb)[Lf.UserQueryGuid]=hO,t[Lf.HostSDXSessionID]=sv.getSessionId(),t[Lf.UserQueryOrder]=mO,{eventType:pf.QueryDetails,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),qb={}},e.prototype.sendTelemetryChatEventData=function(e){if(null!=e){if(e.logEvent(((n=Qb)[hf.UserQueryGuid]=hO,n[hf.CopilotChatSessionId]=sv.getSessionId(),n[hf.UserQueryOrder]=mO,{eventType:pf.ChatEvents,eventData:Object.keys(n).map((function(e){return{key:e,value:n[e]}}))})),Qb[hf.ChatEventType]){var t=Object.keys(mf)[Object.values(mf).indexOf(Qb[hf.ChatEventType])];qb[t]=0===Qb[hf.ChatEventParameters].length?"true":Qb[hf.ChatEventParameters]}this.initTelemetryChatEventObject()}var n},e}(),Yb=n(1086),Zb="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",Jb=function(){function e(){this.oTelLogger=new Yb.a,this.setupTelemetryLogger(this.oTelLogger),this.telemetryEventHandler=Kb.getInstance()}return e.getInstance=function(){return e.telemetryLogger||(e.telemetryLogger=new e),e.telemetryLogger},e.prototype.getDefaultEventFlags=function(){return{}},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logError=function(e,t){var n;this.logTelemetryErrorEvent(e,t),this.telemetryEventHandler.updateTelemetryQueryDetailsEventData(((n={})[Lf.ErrorCategory]=e.eventType,n[Lf.ErrorMessage]=e.errorMessage,n))},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:{ariaTenantToken:Zb,nexusTenantToken:1763},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Object(o.__assign)(Object(o.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)},e.prototype.logTelemetryErrorEvent=function(e,t){var n={eventName:"Office.Voice.ActionAI."+pf.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Object(o.__assign)(Object(o.__assign)({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:"CopilotChatSessionId",value:sv.getSessionId()}])};this.oTelLogger.sendError(n)},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?tm.b(e.key,e.value):"string"==typeof e.value?tm.d(e.key,e.value):"boolean"==typeof e.value?tm.a(e.key,e.value):tm.d(e.key,e.value)}),[])},e.prototype.setupTelemetryLogger=function(e){e.setTenantToken("Office.Voice.ActionAI",Zb,1763)},e}(),Xb=Object(o.__assign)(Object(o.__assign)({},k.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),$b=(Object(o.__assign)(Object(o.__assign)({},j.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),Object(jd.a)({10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"})),ey=function(e,t,n,r,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(){return{sections:p.menuProps.sections.map((function(e){return{sectionHeader:e.sectionHeader,showSectionTopDivider:e.showSectionTopDivider,starterPrompts:e.starterPrompts.map((function(e){return{text:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover}}))}})),handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem}},this.handleOnClickMenuItem=function(e){return Object(o.__awaiter)(p,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t=e,n=Cm,gb(Cm),this.loggingEventHandler.sendLoggingEventToClient(Vf.MenuButtonItemClicked,{suggestionClicked:e}),this.isFreVisible&&this.setFreVisible(!1),e.endsWith(Sm)?[4,this.setChatInputStateExpanded()]:[3,2];case 1:o.sent(),t=t.slice(0,-Sm.length)+" ",o.label=2;case 2:return(null==(r=this.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:r.inputAreaText)&&(t=r.inputAreaText),this.immediateActionableQueries[e]?(null===(i=this.chatInputRef.current)||void 0===i||i.setInputText(Cm),null===(a=this.chatInputRef.current)||void 0===a||a.setGhostText(this.chatPlaceholderMessage),this.handleSubmit({text:t,telemetryData:mf.MenuItemClicked}),[3,8]):[3,3];case 3:return(null==r?void 0:r.copilotPromptLab)&&(null==r?void 0:r.copilotPromptLab.shouldOpenCopilotPromptLab)?this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsSharedCopilotLabEnabled)?[4,bb()]:[3,5]:[3,7];case 4:return o.sent(),[3,6];case 5:null==r||r.copilotPromptLab.launchCopilotPromptLab(),o.label=6;case 6:return[3,8];case 7:e===this.transformFileSuggestionText&&this.chatEditor&&(n=this.transformFilePlaceholderText),this.updateHintCard(e),null===(s=this.chatInputRef.current)||void 0===s||s.setInputText(t),null===(l=this.chatInputRef.current)||void 0===l||l.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1),null===(c=this.chatInputRef.current)||void 0===c||c.setGhostText(n),o.label=8;case 8:return wb("Suggestion clicked: "+e),[2]}}))}))},this.generateQueryMap=function(){var e={};p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e[t.suggestionText]=t.shouldSubmitQueryOnClick}))})),p.immediateActionableQueries=e},this.generatePromptSuggestionList=function(){var e=[];p.menuProps.sections.forEach((function(t){t.starterPrompts.forEach((function(t){e.push(t)}))})),p.promptSuggestionList=e},this.getTransformFileSuggestionText=function(){var e,t,n,r;try{for(var i=Object(o.__values)(p.menuProps.sections),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(n=void 0,Object(o.__values)(s.starterPrompts)),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.shouldLaunchCIQOnSelection)return u.suggestionText}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return Cm},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=r,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=s,this.chatPlaceholderMessage=u,this.generateQueryMap(),this.generatePromptSuggestionList(),this.updateHintCard=d,this.isFreVisible=i,this.setFreVisible=a,this.loggingEventHandler=qf.getInstance(),this.copilotCommunicationHandler=l,this.setChatInputStateExpanded=c};!function(e){e.Backspace="Backspace",e.Escape="Escape",e.Delete="Delete",e.V="V"}(zb||(zb={}));var ty,ny=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){var m=this;this.handleOnInput=function(e){var t;return m.isFreVisible&&m.setFreVisible(!1),(null===(t=m.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Cm&&(m.updateHintCard(Cm),gb(Cm),m.loggingEventHandler.sendLoggingEventToClient(Vf.InputAreaTextChangedToEmpty)),!0},this.getProps=function(e,t){var n={isDisabled:m.isDisabled,placeholderText:m.chatPlaceHolderMessage,isMenuButtonEnabled:!0,maxInputCharLimit:bm,handleSubmitButtonClick:function(e){var t;m.loggingEventHandler.sendLoggingEventToClient(Vf.SubmitButtonClicked);var n=m.chatInputRef.current?null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement()):void 0;m.handleSubmit({text:e,links:n,telemetryData:mf.SubmitButtonClicked})},handleKeyDown:function(e){var t,n=m.chatInputRef.current;if(!n)return!1;var r=n.getInputText(),o=n.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===zb.V)n.setGhostText(Cm);else{if("Enter"===e.key){if(e.preventDefault(),r.trimStart()===Cm)return!1;var i=null===(t=m.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(m.chatInputRef.current.getInputSpanElement());return n.setInputText(Cm),n.setGhostText(m.chatPlaceHolderMessage),m.handleSubmit({text:r,links:i}),!1}e.key===zb.Backspace?m.chatEditor&&r.length>1&&kb()&&Tb()===r.length&&r.slice(-1)===Fu?(m.updateHintCard(m.menuBuilder.getTransformFileSuggestionText()),n.setGhostText(Fu+m.ciqPlaceholderText)):0!==Tb()&&o!==Cm&&n.setGhostText(Cm):(e.key===zb.Escape||e.key===zb.Delete&&Tb()!==r.length&&o!==Cm)&&n.setGhostText(Cm)}return!0},handleOnChatInputControlMount:function(){m.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){m.setChatInputControlMounted(!1)},menuProps:m.menuBuilder.getMenuProps(),handleOnInput:m.handleOnInput,microphoneProps:m.microphoneButtonProps,handleOnBlur:e,chatInputBannerProps:t};return n},this.chatInputRef=e,this.isDisabled=t,this.handleSubmit=i,this.isFreVisible=n,this.setFreVisible=r,this.updateHintCard=a,this.chatPlaceHolderMessage=h,this.transformFilePlaceholderText=c,this.ciqPlaceholderText=u,this.updateHintCard=a,this.ciqResponseHandler=p,this.copilotCommunicationHandler=g,this.menuBuilder=new ey(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a),this.chatEditor=s,this.setChatInputControlMounted=d,this.microphoneButtonProps=f,this.loggingEventHandler=qf.getInstance()},ry=function(e,t,n,r,i,a,s,l,c,u,d){var p=this;this.getMenuProps=function(e){var t={promptGuideMenuData:p.menuProps.promptGuideMenuData,copilotLabProps:p.menuProps.copilotLabProps,handleOnClickStarterPromptMenuItem:p.handleOnClickMenuItem,handleOnClickPromptGuideMenuButtonTelemetry:p.handleOnClickMenuButtonTelemetry,shouldBlockPromptGuideLaunch:p.shouldBlockPromptGuideLaunch};return p.copilotCommunicationHandler.isFeatureGateEnabledFromClient(Km.IsSharedCopilotLabEnabled)&&(!p.menuProps.copilotLabProps&&e.length>0&&(p.menuProps.copilotLabProps={copilotLabMenuItemText:Am(),iconRegular:rp.i,iconHover:rp.h}),p.menuProps.copilotLabProps&&(p.menuProps.copilotLabProps.handleOnClickCopilotLab=function(e){return Object(o.__awaiter)(p,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,bb(e)];case 1:return t.sent(),[2]}}))}))})),t},this.shouldBlockPromptGuideLaunch=function(){return p.setPaneLoadMessageIfApplicable(ev.PromptGuide)},this.handleOnClickMenuButtonTelemetry=function(){p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MenuButtonClicked}])},this.handleOnClickMenuItem=function(e,t,n){var r,o,i,a,s,l=e,c=Cm;if(!t)return p.loggingEventHandler.sendLoggingEventToClient(Vf.MenuButtonItemClickedL1,{suggestionClicked:e}),void p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MenuL1SuggestionClicked},{key:hf.ChatEventParameters,value:e}]);gb(Cm),p.loggingEventHandler.sendLoggingEventToClient(Vf.MenuButtonItemClicked,{suggestionClicked:e}),p.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MenuL2SuggestionClicked}]),p.isFreVisible&&p.setFreVisible(!1),e.endsWith(Sm)&&(l=l.slice(0,-Sm.length)+" "),p.immediateActionableQueries[e]?(null===(r=p.chatInputRef.current)||void 0===r||r.setInputText(Cm),null===(o=p.chatInputRef.current)||void 0===o||o.setGhostText(p.chatPlaceholderMessage),p.handleSubmit({text:l})):(p.updateHintCard(e),n&&(l=l.replace(/ *\([^)]*\)/,Om),c=p.transformFilePlaceholderText),l=l.replace(/ *\[[^\]]*]/,Cm),n||(l+=" "),n&&p.chatEditor&&p.chatEditor.setCurrentScope(n),null===(i=p.chatInputRef.current)||void 0===i||i.setInputText(l),null===(a=p.chatInputRef.current)||void 0===a||a.setFocus(),n&&p.chatEditor&&setTimeout((function(){var e;return null===(e=p.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1),null===(s=p.chatInputRef.current)||void 0===s||s.setGhostText(c)),wb("Suggestion clicked: "+e)},this.generateQueryMap=function(){var e,t={};null===(e=p.menuProps.promptGuideMenuData.children)||void 0===e||e.forEach((function(e){var n;null===(n=e.children)||void 0===n||n.forEach((function(e){var n;"ActionSet"===e.nodeType&&(t[e.text]=null===(n=e.data)||void 0===n?void 0:n.shouldSubmitQueryOnClick)}))})),p.immediateActionableQueries=t},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,this.chatEditor=r,this.chatPlaceholderMessage=c,this.generateQueryMap(),this.updateHintCard=u,this.isFreVisible=i,this.setFreVisible=a,this.transformFilePlaceholderText=l,this.copilotCommunicationHandler=s,this.loggingEventHandler=qf.getInstance(),this.telemetryLoggerUtils=om.getInstance(),this.setPaneLoadMessageIfApplicable=d},oy=function(e,t,n,r,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L){var M,B,R=this;this.handleOnInput=function(e){var t;return R.isFreVisible&&R.setFreVisible(!1),(null===(t=R.chatInputRef.current)||void 0===t?void 0:t.getInputText())===Cm&&(R.updateHintCard(Cm),gb(Cm),R.loggingEventHandler.sendLoggingEventToClient(Vf.InputAreaTextChangedToEmpty)),!0},this.getGroundingSourcePickerProps=function(){if(R.groundingSourcePickerProps)return Object(o.__assign)(Object(o.__assign)({},R.groundingSourcePickerProps),{onSelection:function(e){jv(e.id),R.groundingSourcePickerProps.onSelection&&R.groundingSourcePickerProps.onSelection(e)}})},this.getProps=function(e,t){var n,r,o=null===(n=R.editorProps)||void 0===n?void 0:n.editorConfig;o&&void 0===o.ciqPlaceholderText&&(R.editorProps.editorConfig.ciqPlaceholderText=R.ciqPlaceholderText);var i={isDisabled:R.isExecuting,isSubmitButtonDisabled:R.isSubmitButtonDisabled,copilotChatTheme:R.copilotTheme,isDarkMode:R.isDarkModeEnabled,dir:R.dir,placeholderText:R.chatPlaceHolderMessage,isMenuButtonEnabled:!0,isCIQButtonEnabled:R.isCIQButtonEnabled,isGroundingButtonEnabled:R.isGroundingButtonEnabled,isVersion3Enabled:R.isVersion3Enabled,characterLimitErrorMessage:R.characterLimitErrorMessage,maxInputCharLimit:ym,handleSubmitButtonClick:function(e,t){var n,r,o,i=t;R.loggingEventHandler.sendLoggingEventToClient(Vf.SubmitButtonClicked);var a=R.chatInputRef.current?null===(n=R.ciqResponseHandler)||void 0===n?void 0:n.generatCopilotOdslSignalLinks(R.chatInputRef.current.getInputSpanElement()):void 0;(null===(r=R.editorProps)||void 0===r?void 0:r.handleInChatInput)||(i=R.chatInputRef.current?null===(o=R.ciqResponseHandler)||void 0===o?void 0:o.generateQueryAnnotations(R.chatInputRef.current.getInputSpanElement()):void 0),R.handleSubmit({text:e,links:a,telemetryData:mf.SubmitButtonClicked,queryAnnotations:i})},handleKeyDown:function(e){var t,n,r=R.chatInputRef.current;if(!r)return!1;var o=null==r?void 0:r.getInputText(),i=null==r?void 0:r.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===zb.V)null==r||r.setGhostText(Cm);else{if("Enter"===e.key){if(e.preventDefault(),R.shouldBlockSubmitButtonClick())return;if(R.isSubmitButtonDisabled||R.isExecuting)return!1;if(e.shiftKey)return!0;if(o.trimStart()===Cm)return!1;var a=null===(t=R.ciqResponseHandler)||void 0===t?void 0:t.generatCopilotOdslSignalLinks(R.chatInputRef.current.getInputSpanElement()),s=R.chatInputRef.current?null===(n=R.ciqResponseHandler)||void 0===n?void 0:n.generateQueryAnnotations(R.chatInputRef.current.getInputSpanElement()):void 0;return null==r||r.setInputText(Cm),null==r||r.setGhostText(R.chatPlaceHolderMessage),R.handleSubmit({text:o,links:a,queryAnnotations:s}),!1}e.key===zb.Backspace?R.chatEditor&&o.length>1&&kb()&&Tb()===o.length&&o.slice(-1)===Fu?null==r||r.setGhostText(Fu+R.ciqPlaceholderText):0!==Tb()&&i!==Cm&&(null==r||r.setGhostText(Cm)):(e.key===zb.Escape||e.key===zb.Delete&&Tb()!==o.length&&i!==Cm)&&(null==r||r.setGhostText(Cm))}return!0},handleOnBeforeInput:function(e){var t=R.chatInputRef.current;return!(!t||e.data===Fu&&R.chatEditor&&(null==t||t.setGhostText(R.ciqPlaceholderText),1))},handleOnChatInputControlMount:function(){R.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:function(){R.setChatInputControlMounted(!1)},promptGuideMenuProps:null===(r=R.menuBuilder)||void 0===r?void 0:r.getMenuProps(e),handleOnInput:R.handleOnInput,voiceInputProps:R.voiceInputProps,groundingSourcePickerProps:R.getGroundingSourcePickerProps(),groundingButtonPluginProps:R.groundingButtonPluginProps,shouldBlockGroundingButtonClick:R.shouldBlockGroundingButtonClick,shouldBlockSubmitButtonClick:R.shouldBlockSubmitButtonClick,handleFirstUserInput:R.handleFirstUserInput,handleChatInputLoad:R.handleChatInputLoad,editorProps:R.editorProps,isSensitivityIndicatorLoading:R.isSensitivityIndicatorLoading,imageInputEnabled:R.imageInputEnabled,isHVCAppChatV2Enabled:R.enableHVCAppChatV2,hvcPromptStrings:R.hvcPromptStrings,hvcPromptStringsList:R.hvcPromptStringsList,useSortedHVCTokenList:R.useSortedHVCTokenList,chatInputBannerProps:t,onChatInputHVCPromptUpdated:R.onChatInputHVCPromptUpdated};return i},this.shouldBlockGroundingButtonClick=function(){return R.setPaneLoadMessageIfApplicable(ev.GroundingButton)},this.shouldBlockSubmitButtonClick=function(){return R.setPaneLoadMessageIfApplicable(ev.SubmitButton)},this.handleFirstUserInput=function(){om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.FirstUserInputReceived},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}])},this.handleChatInputLoad=function(){om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatInputLoaded},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}])},this.chatInputRef=e,this.copilotTheme=t,this.isDarkModeEnabled=n,this.dir=r,this.isExecuting=i,this.isSubmitButtonDisabled=a,this.handleSubmit=d,this.isFreVisible=s,this.setFreVisible=l,this.copilotCommunicationHandler=c,this.updateHintCard=p,this.chatPlaceHolderMessage=b,this.ciqPlaceholderText=f,this.ciqResponseHandler=v,this.loggingEventHandler=qf.getInstance(),this.setPaneLoadMessageIfApplicable=x,this.menuBuilder=u?new ry(u,e,d,g,s,l,this.copilotCommunicationHandler,h,this.chatPlaceHolderMessage,p,this.setPaneLoadMessageIfApplicable):void 0,this.chatEditor=g,this.setChatInputControlMounted=m,this.voiceInputProps=y,this.isCIQButtonEnabled=C,this.isGroundingButtonEnabled=O,this.groundingSourcePickerProps=S;var F=null!==(B=null===(M=null==E?void 0:E.plugins)||void 0===M?void 0:M.map((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{onToggle:function(t){jv("".concat(e.id,":").concat(t?"On":"Off")),e.onToggle&&e.onToggle(t)}})})))&&void 0!==B?B:[];this.groundingButtonPluginProps=Object(o.__assign)(Object(o.__assign)({},E),{plugins:F}),this.editorProps=I,this.isSensitivityIndicatorLoading=w,this.isVersion3Enabled=T,this.characterLimitErrorMessage=k,this.imageInputEnabled=j,this.enableHVCAppChatV2=null!=P&&P,this.hvcPromptStrings=A,this.hvcPromptStringsList=_,this.useSortedHVCTokenList=L,this.onChatInputHVCPromptUpdated=D},iy=function(e,t,n,r,o,i,a,s,l,c,u,d){var p=this;this.handleClick=function(){},this.getProps=function(e){return{chatInputRestShyPlaceholder:p.chatPlaceHolderMessage,isDisabled:p.isDisabled,isMenuButtonEnabled:!0,handleMenuButtonClick:p.handleClick,menuProps:p.menuBuilder.getMenuProps(),handleClickAndUnMount:e}},this.isDisabled=t,this.handleSubmit=i,this.chatPlaceHolderMessage=d,this.transformFilePlaceholderText=c,this.copilotCommunicationHandler=u,this.menuBuilder=new ey(o,e,i,s,n,r,this.transformFilePlaceholderText,this.copilotCommunicationHandler,l,this.chatPlaceHolderMessage,a)},ay=function(){function e(){}return e.prototype.getProps=function(e,t){return{headerText:t.headerText,descriptionText:t.descriptionText,freImagePath:t.freImagePath,handleFreButtonClick:function(){e()},hideGetStartedButton:t.hideGetStartedButton}},e}(),sy=function(){function e(e){var t;this.promptSuggestionHintCardMap=null!==(t=null==e?void 0:e.promptSuggestionHintCardMap)&&void 0!==t?t:{}}return e.prototype.shouldShowHintCard=function(e){return!!this.promptSuggestionHintCardMap[e]},e.prototype.getProps=function(e){var t={headerText:Cm,descriptionText:Cm};if(this.promptSuggestionHintCardMap[e]){var n=this.promptSuggestionHintCardMap[e].descriptionTextList;t.headerText=this.promptSuggestionHintCardMap[e].headerText,t.descriptionText=n[Math.floor(Math.random()*n.length)]}return t},e}(),ly=function(){return[dm()?OfficeaicopilotStrings.WorkingOnItString:"Working on it...",dm()?OfficeaicopilotStrings.LoadingUIStringGettingReady:"Getting ready...",dm()?OfficeaicopilotStrings.LoadingUIStringFinishingUp:"Finishing up...",dm()?OfficeaicopilotStrings.LoadingUIStringWorkingOnRequest:"Working on your request...",dm()?OfficeaicopilotStrings.LoadingUIStringGatheringResources:"Gathering resources...",dm()?OfficeaicopilotStrings.LoadingUIStringCraftingContent:"Crafting your content...",dm()?OfficeaicopilotStrings.LoadingUIStringGettingEverythingReady:"Getting everything ready...",dm()?OfficeaicopilotStrings.LoadingUIStringFinishingTouches:"Applying the finishing touches..."]},cy=function(){return[dm()?OfficeaicopilotStrings.LoadingUIStringLoadingConversation:"Loading conversation...",dm()?OfficeaicopilotStrings.LoadingUIStringCreateNewConversation:"Creating a new conversation..."]},uy=function(){function e(){}return e.prototype.getProps=function(e,t){return{loadingUiStrings:e.loadingUiStringList,stringChangeIntervalDuration:e.stringChangeIntervalDuration,showStopButton:e.showStopGeneratingButton,showInlineStopButton:e.showInlineStopGeneratingButton,handleStopButtonOnClick:t}},e}(),dy=function(){function e(e,t,n,r,o,i){var a=this;this.isCitationsSupportEnabled=!1,this.executeSuggestionPill=function(e){var t,n;if(null===(t=a.chatInputRef.current)||void 0===t||t.setInputText(Cm),null===(n=a.chatInputRef.current)||void 0===n||n.setGhostText(a.chatPlaceHolderMessage),!a.isCitationsSupportEnabled&&e in a.suggestedQnAsList)a.setSuggestionClickChatCardsFromCacheSuggestion(e,a.suggestedQnAsList[e]),a.setCachedSuggestionPillList(a.getSuggestionPillListFromCache());else if(a.isCitationsSupportEnabled&&e in a.suggestedQnAListV2){var r=a.suggestedQnAListV2[e],o=r.answer,i=r.citations;a.setSuggestionClickChatCardsFromCacheSuggestion(e,o,i),a.setCachedSuggestionPillList(a.getSuggestionPillListFromCache())}else a.handleSubmit({text:e,telemetryData:mf.SuggestionPaneSuggestionClicked})},this.chatInputRef=e,this.handleSubmit=t,this.chatPlaceHolderMessage=n,this.setChatMessage=r,this.loggingEventHandler=qf.getInstance(),this.suggestedQnAsList={},this.suggestedQnAListV2={},this.isCitationsSupportEnabled=i,this.setCachedSuggestionPillList=o,this.telemetryLoggerUtils=om.getInstance()}return e.prototype.setSuggestedQnAListV2=function(e){var t=this;this.suggestedQnAListV2={},e.forEach((function(e){t.suggestedQnAListV2[e.question]={answer:e.answer,citations:e.citations}})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],Wf,jf.ChatQnA,If.QAandSummaries,wf.Ask,Tf.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.setSuggestedQnAList=function(e){var t=this;if(this.isCitationsSupportEnabled)return this.setSuggestedQnAListV2(e);this.suggestedQnAsList={},e.forEach((function(e){t.suggestedQnAsList[e.question]=e.answer})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],Wf,jf.ChatQnA,If.QAandSummaries,wf.Ask,Tf.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())},e.prototype.getSuggestedQnAsList=function(){return this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList)},e.prototype.getSuggestionPillListFromCache=function(){var e=this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList);return e=function(e){for(var t,n,r=e.length;0!=r;)n=Math.floor(Math.random()*r),r--,t=Object(o.__read)([e[n],e[r]],2),e[r]=t[0],e[n]=t[1];return e}(e),e.slice(0,2)},e.prototype.setSuggestionClickChatCardsFromCacheSuggestion=function(e,t,n){var r,o=Object(xf.a)();this.telemetryLoggerUtils.setUserQueryGuid(o),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.SuggestionPaneSuggestionClicked}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QuerySubmittedByUser}]),this.setChatMessage(c.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),this.setChatMessage(c.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:ro.Footer,isFailure:!1,actionButtonList:[Cb.getInstance().getCopyButton()],references:n?Cb.getInstance().getMarkdownReferences(n):void 0,feedbackData:Cb.getInstance().getFeedbackData(),clpSensitivityIndicatorData:null===(r=Cb.getInstance().getBasicChatProps())||void 0===r?void 0:r.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:o,featureName:jf.ChatQnA})}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CachedBasicChatResponseShown},{key:hf.IsFromCache,value:!0}]),this.telemetryLoggerUtils.logTriedEvent([],Wf,jf.ChatQnA,If.QAandSummaries,void 0,wf.Ask,Tf.BasicChat),this.telemetryLoggerUtils.setUserQueryGuid(Cm)},e.prototype.getProps=function(e,t){var n=this,r={suggestionList:e.suggestionList.length>0?e.suggestionList:t,showRefreshButton:null==e?void 0:e.showRefreshButton,handleSuggestionPillClick:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.loggingEventHandler.sendLoggingEventToClient(Vf.SuggestionPillClicked,{suggestionClicked:e}),gb(Cm),this.executeSuggestionPill(e),wb(e,"officeaicopilot-chat: onClickSuggestionPill"),[2]}))}))},handleRefreshButtonClick:function(){return Object(o.__awaiter)(n,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){return this.getSuggestedQnAsList().length>0?(this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache()),this.telemetryLoggerUtils.logSeenEvent([],Wf,jf.ChatQnA,If.QAandSummaries,wf.Ask,Tf.BasicChat)):null===(t=null==e?void 0:e.onRefreshButtonClicked)||void 0===t||t.call(e),wb("officeaicopilot-chat: onClickRefreshButton"),[2]}))}))}};return r},e}(),py=dy,gy=function(){function e(e,t,n,r,i,a,s,l,c){var u=this;this.getTransformFileSuggestionText=function(){var e,t;if(u.zqmProps)try{for(var n=Object(o.__values)(u.zqmProps.promptSuggestionList),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Cm},this.chatInputRef=e,this.handleSubmit=t,this.updateHintCard=n,this.isExecuting=r,this.chatEditor=i,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=a,this.setChatInputStateExpanded=s,this.telemetryLoggerUtils=om.getInstance(),this.isHVCAppChatV2Enabled=null!=l&&l,this.hvcPromptStringsList=null!=c?c:[]}return e.prototype.handleZQMButtonClick=function(e){var t,n,r;return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return this.isExecuting?[2]:(gb(Cm),qf.getInstance().sendLoggingEventToClient(Vf.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ZQMButtonClicked}]),i=e,a=Cm,e.endsWith(Sm)?[4,this.setChatInputStateExpanded()]:[3,2]);case 1:o.sent(),i=i.slice(0,-Sm.length)+" ",o.label=2;case 2:return(null==(s=this.zqmProps.promptSuggestionList.find((function(t){return t.suggestionText===e})))?void 0:s.inputAreaText)&&(i=s.inputAreaText),(null==s?void 0:s.shouldSubmitQueryOnClick)?[4,this.handleSubmit({text:i,telemetryData:mf.ZQMButtonClicked})]:[3,4];case 3:return o.sent(),[2];case 4:return this.updateHintCard(e),e===this.transformFileSuggestionText&&(a=this.transformFilePlaceholderText),e===this.transformFileSuggestionText&&this.chatEditor&&this.chatEditor.setCurrentScope(Mf.File),null===(t=this.chatInputRef.current)||void 0===t||t.setInputText(i),null===(n=this.chatInputRef.current)||void 0===n||n.setFocus(),e===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=l.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1),null===(r=this.chatInputRef.current)||void 0===r||r.setGhostText(a),[2]}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{headerText:this.zqmProps.headerText,promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestion:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t}})),handleButtonClick:this.handleZQMButtonClick,isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,hvcPromptStringsList:this.hvcPromptStringsList}},e}(),hy=function(){function e(){}return e.prototype.getTrySydneyProps=function(e,t,n){return{checked:e.trySydneyToggleChecked,disabled:t,onChange:e.trySydneyToggleOnChange,label:n}},e.prototype.getTryEnterpriseSearchProps=function(e,t,n){return{checked:e.tryEnterpriseSearchToggleChecked,disabled:t,onChange:e.tryEnterpriseSearchToggleOnChange,label:n}},e.prototype.getTryWebChatProps=function(e,t,n){return{checked:e,onChange:t,label:n,disabled:!1}},e.prototype.getTryReviewerAgentProps=function(e,t,n){return{checked:e.tryReviewerAgentToggleChecked,disabled:t,onChange:e.tryReviewerAgentToggleOnChange,label:n}},e}(),fy=function(e,t,n,r,i,a,s,l,c){var u=this;this.isExecuting=!1,this.addResponseMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0===o||o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");u.chatContainerbuilder.setChatMessageData(t,n,r,p,u.getIsExecuting),s&&Eb.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.updateLastMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;u.chatContainerbuilder.updateLastMessage(t,n,r,p),s&&Eb.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)},this.resendChatHistorySignal=function(e,t){!function(e,t){if(Av){wb("resendCopilotMessage got key ".concat(e,", and found a message with key ").concat(_v));var n=t(Av);n&&$v(yf.c.AddMessageOperation,n)}}(e,t)},this.updateMessage=function(e){var t=e.chatCardType,n=e.chatMessageData,r=e.chatMessageBodyData,o=e.stopLoadingUi,i=void 0!==o&&o,a=e.startAugloopTimerForStreaming,s=void 0!==a&&a,l=e.workflowAnnotationTypeForAugloopTimer,c=void 0===l?void 0:l,d=e.addCardToChatHistory,p=void 0===d||d;(null==r?void 0:r.messageId)?(u.chatContainerbuilder.updateMessage(t,n,r,p),s&&Eb.getInstance().setAugloopResponseTimer(c),i&&u.setIsExecuting(!1)):(wb("updateMessage: messageId is missing in chatMessageBodyData"),u.addResponseMessage({chatCardType:t,chatMessageData:n,chatMessageBodyData:r,stopLoadingUi:i,startAugloopTimerForStreaming:s,workflowAnnotationTypeForAugloopTimer:c,addCardToChatHistory:p}))},this.deleteMessage=function(e){var t=e.chatCardType,n=e.messageIdToDelete;u.chatContainerbuilder.deleteMessage(t,n)},this.submitOperation=function(e){var t=e.operation,n=e.workflowAnnotationType;return dv.getInstance().isWorkflowRegistered(n)&&dv.getInstance().isAugloopResponseTimeoutRequired(n)&&Eb.getInstance().setAugloopResponseTimer(n),wb("operation submitted",t),Gb.getInstance().submitOperation(t,n),!0},this.updateLoadingComponentProps=function(e){u.setLoadingComponentProps((function(t){return Object(o.__assign)(Object(o.__assign)({},t),e)}))},this.addChatMessages=function(e,t){void 0===t&&(t=!0),u.chatContainerbuilder.addChatMessages(e),t&&u.setIsExecuting(!1)},this.getLastMessage=function(e){return u.chatContainerbuilder.getLastMessage(e)},this.clearMessages=function(){u.chatContainerbuilder.clearMessages()},this.startLoadingUi=function(){u.setIsExecuting(!0)},this.startReinitializeALSession=function(){u.setShouldReinitializeALSession(!0)},this.getInputText=function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.getInputText()},this.setInputAreaText=function(e){var t,n,r;wb("setInputAreaText",e);var o=e,i=Mb(e),a=i.inputSpanText,s=i.isFileEntityPresent;o=a,wb("inputSpanText: ".concat(a,", isFileEntityPresent:"),s);var l=Cm;a.endsWith(Sm)&&(o=a.slice(0,-Sm.length)+" "),s&&(l=u.ciqPlaceholderText?u.ciqPlaceholderText:rv()),null===(t=u.chatInputRef.current)||void 0===t||t.setInputText(o),null===(n=u.chatInputRef.current)||void 0===n||n.setFocus(),s&&u.getChatEditor()&&setTimeout((function(){var e;return null===(e=u.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1),null===(r=u.chatInputRef.current)||void 0===r||r.setGhostText(l)},this.submitUserQuery=function(e){var t=e.text,n=e.links,r=e.telemetryData,o=e.queryAnnotations;wb("submitUserQuery called for query: ",t),u.isExecuting||u.isDisabled?wb("Returning from submitting Query because isExecuting is: ".concat(u.isExecuting," and isDisabled is: ").concat(u.isDisabled)):u.handleSubmit({text:t,links:n,telemetryData:r,queryAnnotations:o})},this.setInputFocus=function(){var e;wb("setInputFocus"),u.isDisabled||null===(e=u.chatInputRef.current)||void 0===e||e.setFocus()},this.setIsDisabled=function(e){wb("setIsDisabled",e),u.isDisabled=e},this.setLocalIsExecuting=function(e){u.isExecuting=e},this.getIsExecuting=function(){return u.isExecuting},this.setIsExecuting=e,this.chatContainerbuilder=r,this.handleSubmit=n,this.setLoadingComponentProps=t,this.chatInputRef=i,this.getChatEditor=a,this.isDisabled=c,this.setShouldReinitializeALSession=s,this.ciqPlaceholderText=l},my=Object(E.a)(Xb),vy={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:my.themeBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:my.themeBackground},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:my.colorNeutralStroke1Selected},Me.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:my.colorNeutralForeground3},Me.a.borderRadius("20px")),Me.a.border("2px","solid",my.colorNeutralBackground2Hover)),{":hover":{backgroundColor:my.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:my.colorNeutralBackground2Hover},Me.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:my.colorNeutralStroke1Selected},Me.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:my.colorNeutralForeground3},Me.a.borderRadius("20px")),Me.a.border("2px","solid",my.colorNeutralBackground2Hover)),{":hover":{backgroundColor:my.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:my.colorNeutralBackground2Hover},Me.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:my.themeBackground},incomingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},Me.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Me.a.margin("10px")),outgoingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},Me.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Me.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),Me.a.border("1px","solid","rgba(230, 230, 230, 1)")),Me.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",backgroundColor:my.colorNeutralBackground1,opacity:"0.6"}),outgoingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),Me.a.border("1px","solid","rgba(230, 230, 230, 1)")),Me.a.margin(0,"16px")),{height:"124px",backgroundColor:my.colorNeutralBackground1,opacity:"0.8"})},by={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:Be.a.colorNeutralBackground1},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:Be.a.colorNeutralBackground1},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralStroke1Selected},Me.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralForeground3},Me.a.borderRadius("20px")),Me.a.border("2px","solid",Be.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Be.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground2Hover},Me.a.borderRadius("20px"))},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralStroke1Selected},Me.a.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({backgroundColor:Be.a.colorNeutralForeground3},Me.a.borderRadius("20px")),Me.a.border("2px","solid",Be.a.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Be.a.colorNeutralForeground2}}),"::-webkit-scrollbar-track":Object(o.__assign)({backgroundColor:Be.a.colorNeutralBackground2Hover},Me.a.borderRadius("20px"))},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:Be.a.colorNeutralBackground1},incomingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},Me.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Me.a.margin("10px")),outgoingShimmerCard:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},Me.a.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Me.a.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),Me.a.border("1px","solid","rgba(230, 230, 230, 1)")),Me.a.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Be.a.colorNeutralBackground1}),outgoingShimmerCardWrapper:Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Me.a.borderRadius("8px")),Me.a.border("1px","solid","rgba(230, 230, 230, 1)")),Me.a.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:Be.a.colorNeutralBackground1})},yy=Object(pe.a)(vy),Cy=Object(pe.a)(by),Oy=function(e,t){if(t)for(var n in e)e[n]=Object(x.a)(e[n],t[n]);return e},Sy=0,Ey=function(){function e(e,t,n,r,i,a,s,l,c,u,d,p,g){var h=this;this.onTryAgainClicked=function(){Sy=(new Date).getTime(),Object(ep.b)(h.isMicrophoneListening,Tm,h.setShouldShowMicrophonePermissionRetryDialog,h.setMicrophoneState,h.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=function(e){return Object(o.__awaiter)(h,void 0,void 0,(function(){var t,n,r,i,a,s,l,c,u,d,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(t=om.getInstance(),this.setPaneLoadMessageIfApplicable(ev.Microphone))return[2];null==e||e.stopPropagation(),o.label=1;case 1:return o.trys.push([1,7,,10]),this.isMicrophoneListening?(t.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophonePauseClicked}]),(null===(i=this.chatInputRef.current)||void 0===i?void 0:i.getGhostText())!=Cm&&(null===(a=this.chatInputRef.current)||void 0===a?void 0:a.getGhostText())!=this.chatPlaceHolderMessage&&(null===(l=null===(s=this.chatInputRef.current)||void 0===s?void 0:s.getGhostText())||void 0===l?void 0:l.trim())!=nv()&&(null===(c=this.chatInputRef.current)||void 0===c||c.setInputText((null===(u=this.chatInputRef.current)||void 0===u?void 0:u.getInputText())+(null===(d=this.chatInputRef.current)||void 0===d?void 0:d.getGhostText())),null===(p=this.chatInputRef.current)||void 0===p||p.setGhostText("")),[4,Object(ep.d)(this.setMicrophoneListeningStatus)]):[3,3];case 2:return o.sent(),wb("Microphone Paused"),[3,6];case 3:return t.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophonePlayClicked}]),this.microphoneState===Dc.Uninitialized&&this.setMicrophoneState(Dc.Loading),Sy=(new Date).getTime(),[4,Nh.a.GetInstance().Resume()];case 4:return o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(Dc.Enabled),[4,Object(ep.e)(Tm,this.setMicrophoneListeningStatus)];case 5:o.sent(),wb("Microphone Resumed"),o.label=6;case 6:return[3,10];case 7:return n=o.sent(),r="Error occurred while fetching mic permissions - : ".concat(n),wb(r),null==uO||uO.logError({eventType:pf.Microphone,errorMessage:r}),"ErrorAudioPermissionDeniedError"!=n?[3,9]:[4,Nh.a.GetInstance().Pause()];case 8:o.sent(),this.setShouldShowMicrophonePermissionRetryDialog(!0),t.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophonePermissionDenied}]),o.label=9;case 9:return this.setMicrophoneState(Dc.Uninitialized),[2];case 10:return[2]}}))}))},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=r,this.microphonePermissionErrorMessage=i,this.setShouldShowMicrophonePermissionRetryDialog=a,this.setMicrophoneState=s,this.setMicrophoneListeningStatus=l,this.chatInputRef=c,this.chatPlaceHolderMessage=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=p,this.setPaneLoadMessageIfApplicable=g}return e.prototype.getMicrophoneButtonProps=function(){var e=this;return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:function(){e.onTryAgainClicked()},notNowOnClickHandler:function(){e.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}},e}(),xy=function(e,t,n,r,o){var i,a,l,u,d,p,g,h=null==e?void 0:e.body,f=null==h?void 0:h.answer,m=null==h?void 0:h.error,v=null==h?void 0:h.aiResponse,b=null==h?void 0:h.status,y=null==h?void 0:h.isBasicChat,C=null==h?void 0:h.queryId,O=null==h?void 0:h.citation,S=om.getInstance(),E=im(null==h?void 0:h.featureType);if(Cb.getInstance().setFeatureName(E),S.setUserQueryGuid(C),Cb.getInstance().setQueryID(C),Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Started,workflowAnnotationType:Sf.a.getTypeName(),queryID:C,responseTime:OO(r)}),S.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:Sf.a.getTypeName()},{key:hf.UserQueryGuid,value:C},{key:hf.Cv,value:o}]),S.logTriedEvent([{key:Gf,value:C}],Wf,E,am(E),void 0,sm(E),lm(E)),S.sendTelemetryLatencyData([{key:gf.FeatureName,value:E}]),Cb.getInstance().sendLoggingEventToClient(Vf.AugloopResponseReceived,{annotationName:Sf.a.getTypeName(),timeInMs:OO(r)}),dv.getInstance().isAugloopResponseTimeoutRequired(null===(i=null==h?void 0:h.H_)||void 0===i?void 0:i.T_)&&Eb.getInstance().clearAugloopResponseTimer(),!um(m)&&!um(null==m?void 0:m.category))return Rb(m,b,t,n,Sf.a.getTypeName()),S.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(r)},{key:gf.QnAResponseTime,value:CO(r)},{key:gf.IsQuerySuccess,value:!1},{key:gf.UserQueryGuid,value:C}],!0),Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Finished,workflowAnnotationType:Sf.a.getTypeName(),queryID:C,isSuccess:!1,responseTime:OO(r)}),Cb.getInstance().setQueryID(Cm),S.setUserQueryGuid(Cm),Cb.getInstance().setFeatureName(jf.ChatQnA),void(Cb.getInstance().getIsFluxFlowEnabled()||(wb("Stopping loading UI"),n(!1)));var x={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:ro.Footer,showAnimation:!0,feedbackData:Cb.getInstance().getFeedbackData(),isFailure:!1,actionButtonList:[{type:qo.Default,title:km(),text:s()?"":km(),iconRegular:s()?pt.e:pt.c,iconHover:s()?pt.d:pt.b,position:s()?Ko.FeedbackSection:Ko.ActionButtonBar,popoverProps:{popoverTitle:Pm()},handleButtonOnClick:pm}],references:O&&O.length>0&&(null===(a=Cb.getInstance().getBasicChatProps())||void 0===a?void 0:a.isCitationsEnabled)?Cb.getInstance().getMarkdownReferences(O):void 0,clpSensitivityIndicatorData:null!==(u=null===(l=Cb.getInstance().getBasicChatProps())||void 0===l?void 0:l.sensitivityIndicatorData)&&void 0!==u?u:void 0,telemetryData:JSON.stringify({correlationId:C,featureName:E})},I=y?c.MarkdownCard:c.Default,w=y?{markDownCardProps:{user:"chat",message:f}}:{defaultMessageProps:{user:"chat",messageHeader:{text:f}}};t.setChatMessageData(I,w,x),v&&"suggestions"===(null==v?void 0:v.type)&&(null===(p=null===(d=null==v?void 0:v.value)||void 0===d?void 0:d.suggestions)||void 0===p?void 0:p.length)>0&&Cb.getInstance().sendBasicChatSuggestionPillsEvent(null===(g=null==v?void 0:v.value)||void 0===g?void 0:g.suggestions),Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Finished,workflowAnnotationType:Sf.a.getTypeName(),queryID:C,isSuccess:!0,responseTime:OO(r)}),S.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(r)},{key:gf.QnAResponseTime,value:CO(r)},{key:gf.IsQuerySuccess,value:!0},{key:gf.UserQueryGuid,value:C}],!0),Cb.getInstance().setQueryID(Cm),S.setUserQueryGuid(Cm),Cb.getInstance().setFeatureName(jf.ChatQnA),Cb.getInstance().getIsFluxFlowEnabled()||(wb("Stopping loading UI"),n(!1))},Iy=function(e,t,n,r,o){var i,a,s,l,u=null==e?void 0:e.body,d=null==u?void 0:u.answer,p=null==u?void 0:u.error,g=null==u?void 0:u.aiResponse,h=null==u?void 0:u.status,f=null==u?void 0:u.citations,m=null==u?void 0:u.isStreaming,v=null==u?void 0:u.isAnswerCompleted,b=null==u?void 0:u.queryId,y=om.getInstance(),C=im(null==u?void 0:u.featureType);if(wb("Getting isStreaming boolean as : ".concat(m," and isAnswerCompleted as : ").concat(v," and answer as : ").concat(d," and featureType as : ").concat(C)),Cb.getInstance().setFeatureName(C),y.setUserQueryGuid(b),Cb.getInstance().setQueryID(b),Cb.getInstance().getIsFirstStreamChunk()&&(Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Started,workflowAnnotationType:Sf.b.getTypeName(),queryID:b,responseTime:OO(r)}),y.logTriedEvent([{key:Gf,value:b}],Wf,C,am(C),void 0,sm(C),lm(C)),y.sendTelemetryLatencyData([{key:gf.FeatureName,value:C}])),y.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:Sf.b.getTypeName()},{key:hf.UserQueryGuid,value:b},{key:hf.IsStreamingResponse,value:m.toString()},{key:hf.Cv,value:o}]),Cb.getInstance().sendLoggingEventToClient(Vf.AugloopResponseReceived,{annotationName:Sf.b.getTypeName(),timeInMs:OO(r)}),Eb.getInstance().clearAugloopResponseTimer(),!um(p)&&!um(null==p?void 0:p.category))return Cb.getInstance().getIsFirstStreamChunk()||Cb.getInstance().updateCardWithFooter(),Rb(p,h,t,n,Sf.b.getTypeName()),Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Finished,workflowAnnotationType:Sf.b.getTypeName(),queryID:b,isSuccess:!1,responseTime:OO(r)}),y.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(r)}]),void Cb.getInstance().resetBasicChatStreamingStates(!1,!Cb.getInstance().getIsFluxFlowEnabled());m?(Cb.getInstance().setIsBasicChatStreaming(!0),wy(d,v,t,y)):Cb.getInstance().resetBasicChatStreamingStates(!0,!Cb.getInstance().getIsFluxFlowEnabled()),f&&f.length>0&&Cb.getInstance().getBasicChatProps().isCitationsEnabled&&(y.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CitationReceived},{key:hf.ChatEventParameters,value:f.length.toString()},{key:hf.UserQueryGuid,value:b}]),t.updateLastMessage(c.MarkdownCard,void 0,{references:Cb.getInstance().getMarkdownReferences(f)},!1)),g&&"suggestions"===(null==g?void 0:g.type)&&(null===(a=null===(i=null==g?void 0:g.value)||void 0===i?void 0:i.suggestions)||void 0===a?void 0:a.length)>0&&Cb.getInstance().sendBasicChatSuggestionPillsEvent(null===(s=null==g?void 0:g.value)||void 0===s?void 0:s.suggestions),m?Eb.getInstance().setAugloopResponseTimer(null===(l=null==u?void 0:u.H_)||void 0===l?void 0:l.T_):(Cb.getInstance().sendBasicChatProcessingEvent({status:zf.Finished,workflowAnnotationType:Sf.b.getTypeName(),queryID:b,isSuccess:!0,responseTime:OO(r)}),Cb.getInstance().getIsFluxFlowEnabled()||(wb("Streaming finished. Stopping loading UI"),n(!1)))},wy=function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,u;return Object(o.__generator)(this,(function(o){return Cb.getInstance().getIsFirstStreamChunk()&&""===e?(r.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.EmptyBasicChatResponse},{key:hf.UserQueryGuid,value:Cb.getInstance().getQueryID()}]),[2]):(i=(i=e).replace("\\n","\n").replace("\\t","\t"),a=Cb.getInstance().getParagraphChunks(),a+=i,Cb.getInstance().setParagraphChunks(a),s={shouldShowAIGeneratedIndicator:!0,showAnimation:!1,feedbackData:Cb.getInstance().getFeedbackData(),isFailure:!1,clpSensitivityIndicatorData:null!==(u=null===(l=Cb.getInstance().getBasicChatProps())||void 0===l?void 0:l.sensitivityIndicatorData)&&void 0!==u?u:void 0,telemetryData:JSON.stringify({correlationId:Cb.getInstance().getQueryID(),featureName:Cb.getInstance().getFeatureName()})},Cb.getInstance().updateStreamChunks({augloopResponseTime:CO(pO)}),Cb.getInstance().getIsFirstStreamChunk()?(n.setChatMessageData(c.MarkdownCard,{markDownCardProps:{user:"chat",message:i}},s,!1),Cb.getInstance().setIsFirstStreamChunk(!1),r.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(pO)}])):n.updateLastMessage(c.MarkdownCard,{markDownCardProps:{user:"chat",message:a}},void 0,!1),t&&Cb.getInstance().updateCardWithFooter(),[2])}))}))};!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(ty||(ty={}));var Ty=function(e,t,n){var r=null==e?void 0:e.body,o=r.suggestedQnAs,i=r.error,a=r.queryId,s=om.getInstance(),l=Cb.getInstance().getSuggestedQnaSignalSubmitTime();if(wb("received suggestedQnaList",o),s.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:Sf.c.getTypeName()},{key:hf.UserQueryGuid,value:a},{key:hf.Cv,value:n}]),s.sendTelemetryLatencyData([{key:gf.SuggestedQnAResponseTime,value:CO(l)},{key:hf.UserQueryGuid,value:a}]),Cb.getInstance().sendLoggingEventToClient(Vf.AugloopResponseReceived,{annotationName:Sf.c.getTypeName(),timeInMs:OO(l)}),!um(i)&&!um(null==i?void 0:i.category)){var c="",u=Sf.c.getTypeName();if(!um(i.errorDetailsJson))try{c=JSON.parse(i.errorDetailsJson).code}catch(e){wb("Error parsing error code from basic chat error",e.message)}return wb("Received error from DynamicQuestionGeneratorSuggestedQnAAnnotation Workflow"),Cb.getInstance().sendLoggingEventToClient(Vf.AugloopErrorReceived,{annotationName:u,timeInMs:OO(l),chatEventParams:JSON.stringify({errorCategory:i.category,errorCode:c})}),void s.sendTelemetryChatEventData([{key:hf.ChatEventType,value:"".concat(u,"_Error")},{key:hf.ChatEventParameters,value:"".concat(i.category,"_").concat(c)},{key:hf.ChatErrorType,value:kf.Server},{key:hf.UserQueryGuid,value:a}])}o&&t.setSuggestedQnAList(o)},ky=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n){return{conversationId:t,getLogs:e,telemetryData:n}},e}(),jy=n(2078),Py=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var r,i,a,s,l,c;return Object(o.__generator)(this,(function(o){return r=null===(c=null===(l=e.body)||void 0===l?void 0:l.H_)||void 0===c?void 0:c.T_,i=null==e?void 0:e.body,a=i.success,s=i.sensitivityLabel,om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ResponseReceivedFromAL},{key:hf.ChatEventParameters,value:"".concat(r)},{key:hf.Cv,value:n}]),wb("received sensitivity label",s),t(a&&s?s:void 0),[2]}))}))},Ay=function(){this.getProps=function(e){return{handleChangeTopicButtonClick:e}}},_y=function(e){var t=e.children,n=Object(o.__rest)(e,["children"]);return n.shouldUseV9Tokens?ue.a.createElement(le.a,{theme:n.theme,dir:n.dir},t):(console.log("Test app is using Custom tokens to render Theme"),ue.a.createElement(ue.a.Fragment,null,t))},Dy=function(e){if(!e.shouldUseFluentV9Tokens)return wb("Fluent V8 Custom Tokens enabled"),ue.a.createElement(de,{theme:e.theme,dir:e.dir},e.children);if(e.shouldUseFluentV9Tokens&&e.theme)return wb("Fluent V9 supported tokens enabled"),ue.a.createElement(_y,Object(o.__assign)({},Ly(e.theme,e.dir)),e.children);throw new Error("Exception: Please ensure a compatible V9 Theme is passed to the ThemeProvider")},Ly=function(e,t){return void 0===t&&(t=void 0),{shouldUseV9Tokens:!0,theme:e,dir:t}},My=n(3598),By=n(3368),Ry=function(e){var t=e.className,n=yy();return ce.createElement(he,{style:t},ce.createElement(My.a,null,ce.createElement("div",{className:n.incomingShimmerCardWrapper},ce.createElement("div",{className:n.incomingShimmerCard},ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}))),ce.createElement("div",{className:n.outgoingShimmerCardWrapper},ce.createElement("div",{className:n.outgoingShimmerCard},ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm}),ce.createElement(By.a,{size:zm})))))},Fy=n(1435),Ny=n(462);const Hy=800,Uy=600;var Vy=n(1434);class zy extends Vy.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class Gy extends zy{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class Wy{constructor(e,t,n,r,o){this.userContext=e,this.hostContext=t,this.tokenService=n,this.telemetryService=r,this.hostWindow=o}authenticate(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var r,i;const a={user:this.userContext,app:this.hostContext,page:{id:(null===(r=e.appDefinition)||void 0===r?void 0:r.id)||"",frameContext:I.b.authentication}},s=e=>(r,o)=>e?(t({code:r}),Promise.resolve()):(n(r),Promise.resolve()),l=new Gy(s(!0),s(!1),this.tokenService,this.userContext);(function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((o,a)=>{var s,l;const c=Object(Fy.a)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(s=t.appDefinition.version)&&void 0!==s?s:"",appId:t.appDefinition.id,manifestVersion:null!==(l=t.appDefinition.manifestVersion)&&void 0!==l?l:""})),u={url:t.signInUrl,width:Hy,height:Uy,left:e.screen.availWidth/2-Hy/2,top:e.screen.availHeight/2-Uy/2};new Ny.b(e,u,c,n,r,{log:function(e,t,n,r){}},i)?o(void 0):a("Unable to initialize auth extension")}))}))})(null!==(i=this.hostWindow)&&void 0!==i?i:window,e,l,a,this.telemetryService).catch((e=>{}))}))}))}getToken(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.tokenService.getToken(e)}))}}var Qy=n(1170),qy=n(2152);class Ky{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:Qy.b.LogMetric,tag:this.tag,name:this.name,success:Qy.f.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:Qy.b.LogMetric,tag:this.tag,name:this.name,success:Qy.f.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:Qy.b.LogMetric,tag:this.tag,name:this.name,success:Qy.f.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}class Yy{constructor(e,t,n){this.dataProvider=e,this.addPlugin=t,this.removePlugin=n}onToggle(e){var t,n;return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.plugin.isEnabled=e,e?null===(t=this.addPlugin)||void 0===t||t.call(this,this.plugin,!0):null===(n=this.removePlugin)||void 0===n||n.call(this,this.plugin,!0),yield this.dataProvider.setPlugin(this.plugin)}))}}class Zy extends Yy{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class Jy extends Yy{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class Xy extends Yy{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}var $y=n(2217),eC=n(1555),tC=n(1477),nC=n(2859),rC=n(2681),oC=n(2680);let iC=0;class aC extends Yy{constructor(e,t,n,r,o,i,a,s){var l;super(t,o,i),this.plugin=e,this.dataProvider=t,this.authActivityProvider=n,this.appService=r,this.addPlugin=o,this.removePlugin=i,this.telemetryService=a,this.correlationVector=s,this.pluginInfoForLogging="",this.authActivityProvider&&(this.authRuntime=new $y.a(this.authActivityProvider)),e.isEnabled&&(null===(l=this.addPlugin)||void 0===l||l.call(this,e)),this.pluginInfoForLogging=function(e){var t,n;return null!==(n=null===(t=e.titleId)||void 0===t?void 0:t.startsWith("P_"))&&void 0!==n&&n}(e)?`, PluginId: ${this.plugin.id}, PluginName: ${this.plugin.name}, PluginSource: ${this.plugin.source}`:e.titleId?", LOB Plugin":", TitleId not found"}handleAuthLinkClick(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=this.plugin.authRequest)||void 0===t?void 0:t.type;try{"silentAuth"!==n&&iC++;const t=yield this.executeAuthRequest(!1);this.updatePluginStatus(t,e)}catch(e){}"silentAuth"!==n&&iC>0&&iC--}))}onToggle(e,t){var n,r;return Object(o.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)return void this.toggleAndUpdatePluginStatus("processed",e,t);if(!this.authRuntime||!this.plugin.metaOSAppId){const r=this.authRuntime?"metaOSAppId is undefined":"AuthRuntime is undefined";return null===(n=this.telemetryService)||void 0===n||n.LogError({type:Qy.b.LogError,tag:Qy.i.MsgExtViewModel,name:Qy.g.onToggle,message:Qy.a.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${r}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),void this.toggleAndUpdatePluginStatus("processed",e,t)}this.updatePluginStatus("processing",t),this.plugin.authRequest=yield this.getAuthRuntimeRequest();const r=yield this.executeAuthRequest(!0);if("pendingAuth"===r&&0===iC)return this.toggleAndUpdatePluginStatus(r,e,t),void(yield this.handleAuthLinkClick(t));this.toggleAndUpdatePluginStatus(r,e,t)}catch(n){null===(r=this.telemetryService)||void 0===r||r.LogError({type:Qy.b.LogError,tag:Qy.i.MsgExtViewModel,name:Qy.g.onToggle,message:Qy.a.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${(null==n?void 0:n.message)||n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),this.toggleAndUpdatePluginStatus("processed",e,t)}}))}executeAuthRequest(e){var t,n,r,i;return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.plugin.authRequest){const o=new Ky(Qy.d.AuthActivity,Qy.c.AuthActivity,this.telemetryService),a={};try{switch(this.plugin.authRequest.type){case"botInvoke":a[Qy.h.TypeOfAuthFlow]=Qy.j.BotInvokeForAuthCheck;break;case"silentAuth":a[Qy.h.TypeOfAuthFlow]=Qy.j.SilentAuth;break;case"auth":a[Qy.h.TypeOfAuthFlow]=Qy.j.Auth;break;case"config":a[Qy.h.TypeOfAuthFlow]=Qy.j.Config}a[Qy.h.isAuthFlowAutomatic]=e?1:0;const s=yield null===(t=this.authRuntime)||void 0===t?void 0:t.execute(this.plugin.authRequest);if(s)return o.logMetricEnd({props:a,message:Qy.a.None,diagnosticsData:`Auth request executed successfully${this.pluginInfoForLogging}`},this.correlationVector),this.plugin.authRequest=Object(eC.b)(this.plugin.authRequest,s),"auth"===(null===(n=this.plugin.authRequest)||void 0===n?void 0:n.type)||"config"===(null===(r=this.plugin.authRequest)||void 0===r?void 0:r.type)||"silentAuth"===(null===(i=this.plugin.authRequest)||void 0===i?void 0:i.type)?"pendingAuth":"processed";o.logMetricEndWithError({props:a,message:Qy.a.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: AuthSDK execute returned undefined response${this.pluginInfoForLogging}`},this.correlationVector)}catch(e){if(o.logMetricEndWithError({props:a,message:Qy.a.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: ${null==e?void 0:e.message}${this.pluginInfoForLogging}`},this.correlationVector),(null==e?void 0:e.message)===nC.a){const e=this.plugin.authRequest;return e&&(e.isSilent=!0,this.plugin.authRequest=e),"pendingAuth"}return Promise.reject(`Could not execute auth request as ${e.message||e}`)}}return Promise.reject("Could not execute auth request as auth request is not available")}))}getAuthRuntimeRequest(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(!this.appService||!this.plugin.metaOSAppId)return Promise.reject("AppId or serviceProvider is undefined");const e=yield this.getAppDefinition(this.appService,this.plugin.metaOSAppId);if(!e)return Promise.reject("Could not find app definition");if(!Object(rC.a)(e))return Promise.reject("Could not find command with initial run enabled");const t=this.getBotInvokeRequest(e);if(!t)return Promise.reject("Could not find bot invoke request");const n=Object.assign(Object.assign({type:"botInvoke"},t),{onActivityCompletion:this.getOnAuthActivityCompletion(this.plugin)});return Promise.resolve(n)}))}getOnAuthActivityCompletion(e){return t=>{if("object"==typeof t){if(e.authRequest){const n=Object(tC.b)(t);if("auth"===n||"config"===n)return e.authRequest=Object(eC.b)(e.authRequest,t),e.status="pendingAuth",Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)}}onInstall(){throw new Error("Method not implemented.")}getAppDefinition(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getApp({id:t});if(!n||!n.appDefinition&&!n.titleInfo)return;let r;return(null==n?void 0:n.appDefinition)?r=n.appDefinition:(null==n?void 0:n.titleInfo)&&(r=Object(oC.a)(n.titleInfo)),r}))}getBotInvokeRequest(e){var t,n,r,o,i,a,s,l;const c=null!==(r=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)&&void 0!==r?r:null===(i=null===(o=e.inputExtensions)||void 0===o?void 0:o[0])||void 0===i?void 0:i.botId,u=this.plugin.metaOSAppId,d=null===(l=null===(s=null===(a=e.inputExtensions)||void 0===a?void 0:a[0].commands)||void 0===s?void 0:s[0])||void 0===l?void 0:l.id;if(!c||!u||!d){throw new Error(`Could not construct bot invoke request. ErrorMessage: ${c?u?"CommandId is undefined":"AppId is undefined":"BotId is undefined"}`)}return{appId:u,botId:c,requestBody:{name:"composeExtension/query",appName:e.name,value:{commandId:d,parameters:[{name:"initialRun",value:"true"}],queryOptions:{skip:0,count:25}}}}}toggleAndUpdatePluginStatus(e,t,n){const r=Object.create(null,{onToggle:{get:()=>super.onToggle}});return Object(o.__awaiter)(this,void 0,void 0,(function*(){yield r.onToggle.call(this,t),this.updatePluginStatus(e,n)}))}updatePluginStatus(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.plugin.status=e,null==t||t()}))}}class sC extends Yy{constructor(e,t,n,r){var o;super(e,n,r),this.plugin=t,this.addPlugin=n,this.removePlugin=r,t.isEnabled&&(null===(o=this.addPlugin)||void 0===o||o.call(this,t))}onInstall(){throw new Error("Method not implemented.")}}class lC{constructor(e,t){this.dataProvider=e,this.plugin=t}onInstall(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){return this.dataProvider.installStoreFrontPlugin(this.plugin)}))}}class cC{constructor(e,t,n,r,o,i){this.dataProvider=e,this.authActivityProvider=t,this.addPlugin=n,this.removePlugin=r,this.telemetryService=o,this.appService=i,this.supportedPluginTypes=["MsgExt","FirstParty","PowerPlatform","DataVerse","Undefined"]}getPlugins(e,t,n,r){var i;return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(n)return this.getPluginsGrouped(e,t,r);const o=new Ky(Qy.d.GetPluginsState,Qy.c.GetPlugins,this.telemetryService),a={};try{const n=this.getSupportedPluginTypes(e),r=yield null===(i=this.dataProvider)||void 0===i?void 0:i.getPlugins(t);let s=0,l=0,c=0,u=0,d=0,p=0;const g=null==r?void 0:r.reduce(((e,r)=>{var o;if(r.type&&n.includes(r.type))switch(r.isEnabled?s++:l++,(null===(o=r.titleId)||void 0===o?void 0:o.startsWith("P_"))&&(c++,r.isEnabled&&u++),r.type){case"MsgExt":d++,r.isEnabled&&p++,e.push(new aC(r,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new Jy(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new sC(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new Zy(this.dataProvider,r,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new Xy(this.dataProvider,r,this.addPlugin,this.removePlugin))}return e}),[]);return a[Qy.h.TotalPluginCount]=g.length,a[Qy.h.TotalISVPluginCount]=c,a[Qy.h.SelectedPluginCount]=s,a[Qy.h.UnselectedPluginCount]=l,a[Qy.h.UnsupportedPluginCount]=r.length-g.length,a[Qy.h.SelectedISVPluginCount]=u,a[Qy.h.TotalMEPluginCount]=d,a[Qy.h.SelectedMEPluginCount]=p,o.logMetricEnd({props:a},t),g}catch(e){o.logMetricEndWithError({props:a,message:Qy.a.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getPluginsGrouped(e,t,n){var r,i,a,s,l;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const c=new Ky(Qy.d.GetPluginsState,Qy.c.GetPlugins,this.telemetryService),u={};try{const h=this.getSupportedPluginTypes(e),f=[],m=yield null===(l=this.dataProvider)||void 0===l?void 0:l.getPluginsGrouped(t,n);let v=0,b=0,y=0,C=0,O=0,S=0,E=0;try{for(var d,p=!0,g=Object(o.__asyncValues)(m);d=yield g.next(),!(r=d.done);p=!0){s=d.value,p=!1;const e=s,n=e.groupHeaderPlugin;if(n.type&&h.includes(n.type)){let r,o=0,i=0,a=0,s=0,l=0,c=0;if("PowerPlatform"===n.type)r=new sC(this.dataProvider,n,this.addPlugin,this.removePlugin);else r=new Jy(this.dataProvider,n,this.addPlugin,this.removePlugin);const u=e.plugins.reduce(((e,n)=>{var r;switch(E++,n.isEnabled?o++:i++,(null===(r=n.titleId)||void 0===r?void 0:r.startsWith("P_"))&&(a++,n.isEnabled&&s++),n.type){case"MsgExt":l++,n.isEnabled&&c++,e.push(new aC(n,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t));break;case"FirstParty":e.push(new Jy(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"PowerPlatform":e.push(new sC(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"DataVerse":e.push(new Zy(this.dataProvider,n,this.addPlugin,this.removePlugin));break;case"Undefined":e.push(new Xy(this.dataProvider,n,this.addPlugin,this.removePlugin))}return e}),[]);v+=o,b+=i,y+=a,C+=s,O+=l,S+=c,f.push({groupPlugins:u,parentPlugin:r})}}}catch(e){i={error:e}}finally{try{p||r||!(a=g.return)||(yield a.call(g))}finally{if(i)throw i.error}}return u[Qy.h.TotalPluginCount]=f.length,u[Qy.h.TotalISVPluginCount]=y,u[Qy.h.SelectedPluginCount]=v,u[Qy.h.UnselectedPluginCount]=b,u[Qy.h.UnsupportedPluginCount]=E-f.length,u[Qy.h.SelectedISVPluginCount]=C,u[Qy.h.TotalMEPluginCount]=O,u[Qy.h.SelectedMEPluginCount]=S,c.logMetricEnd({props:u},t),f}catch(e){c.logMetricEndWithError({props:u,message:Qy.a.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}getStoreFrontPlugins(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=new Ky(Qy.d.GetStoreFrontPluginsState,Qy.c.GetStoreFrontPlugins,this.telemetryService),r={};try{const o=yield null===(t=this.dataProvider)||void 0===t?void 0:t.getStoreFrontPlugins(e),i=[];return o.forEach((e=>{const t=new lC(this.dataProvider,e);i.push(t)})),r[Qy.h.TotalStoreFrontPluginsCount]=i.length,n.logMetricEnd({props:r},e),i}catch(t){n.logMetricEndWithError({props:r,message:Qy.a.StoreFrontPluginsFetchFailed,diagnosticsData:`Error: ${t.message||t}`},e)}}))}getSupportedPluginTypes(e){return e?Object(qy.a)(this.supportedPluginTypes,e):this.supportedPluginTypes}}var uC=n(487);function dC(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.botInvoke(e);return Object.assign({},n)}))}class pC{constructor(e){this.serviceProvider=e}execute(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=e,n=yield this.executeConfigOrAuthRequest(t,this.serviceProvider.telemetryService),r=Object.assign({},t.originalInvokeRequest);return n&&(r.requestBody.value.state=n,delete r.requestBody.value.authentication),yield dC(r,this.serviceProvider.channelService)}))}executeConfigOrAuthRequest(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=e.originalInvokeRequest.appId,r=yield this.serviceProvider.appService.getApp({id:n});let o;if(null==r?void 0:r.appDefinition)o=r.appDefinition;else{if(!(null==r?void 0:r.titleInfo))return null==t||t.LogError({type:uC.c.LogError,name:uC.f.ExecuteConfigOrAuthRequest,tag:uC.h.AuthConfigRuntimeActivity,success:!1,diagnosticsData:"App Definition not found"}),Promise.reject("App Definition not found");o=Object(oC.a)(r.titleInfo)}const i=yield this.serviceProvider.authService.authenticate({appDefinition:o,signInUrl:e.url});return null==i?void 0:i.code}))}}class gC{constructor(e){this.serviceProvider=e}execute(e){var t,n,r,i,a,s,l,c;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const o=e;if(!o.resource){const e=yield this.serviceProvider.appService.getApp({id:o.originalInvokeRequest.appId});o.resource=null!==(i=null!==(t=o.resource)&&void 0!==t?t:null===(r=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.webApplicationInfo)||void 0===r?void 0:r.resource)&&void 0!==i?i:null===(l=null===(s=null===(a=null==e?void 0:e.titleInfo)||void 0===a?void 0:a.titleDefinition)||void 0===s?void 0:s.webApplicationInfo)||void 0===l?void 0:l.resource}const u=yield this.executeSilentAuthRequest(o);if(!u)return null===(c=this.serviceProvider.telemetryService)||void 0===c||c.LogError({type:uC.c.LogError,name:uC.f.Execute,tag:uC.h.SilentAuthRuntimeActivity,success:!1,diagnosticsData:"Failed to fetch Auth token for the request"}),Promise.reject("Failed to fetch Auth token for the request");const d=Object.assign({},o.originalInvokeRequest);return d.requestBody.value.authentication={token:u},yield dC(d,this.serviceProvider.channelService)}))}executeSilentAuthRequest(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(!e.resource)return Promise.reject("Resource is undefined");const t=yield this.serviceProvider.authService.getToken({resource:e.resource,claims:e.claims,isSilent:e.isSilent});return Promise.resolve(null==t?void 0:t.authToken)}))}}class hC{constructor(e){this.serviceProvider=e}execute(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function*(){const n=e;return this.serviceProvider.channelService?yield dC(n,this.serviceProvider.channelService):(null===(t=this.serviceProvider.telemetryService)||void 0===t||t.LogError({type:uC.c.LogError,name:uC.f.Execute,tag:uC.h.BotInvokeRuntimeActivity,success:!1,diagnosticsData:"Channel service is not available"}),Promise.reject("Channel service is not available"))}))}}class fC{constructor(e){this.serviceProvider=e}execute(e){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const t=e;return Promise.reject({request:t,error:"Not implemented"})}))}}var mC,vC=function(e,t,n,r){var o={authService:e,appService:t,channelService:n,telemetryService:r};this.authConfigActivity=new pC(o),this.silentAuthActivity=new gC(o),this.botInvokeActivity=new hC(o),this.apiPluginAuthActivity=new fC(o)},bC=function(){function e(e){this.clientInfo=e}return e.prototype.getUserContext=function(){if(!this.userInfo){var e=this.clientInfo;this.userInfo={dataResidency:this.getDataResidency(e.physicalRing),id:e.aadUserId,displayName:e.userName}}return this.userInfo},e.prototype.getHostContext=function(){if(!this.hostInfo){var e=this.clientInfo;this.hostInfo={host:{clientType:I.c.web,name:I.d.office,sessionId:e.sessionId,version:"1.0"},locale:e.locale,sessionId:e.sessionId,theme:I.e.default}}return this.hostInfo},e.prototype.getDataResidency=function(e){switch(e){case"dod":return O.d.DOD;case"doj":return O.d.DOJ;default:return O.d.Public}},e}(),yC=n(1810),CC=n(298),OC=function(){function e(e){this.pluginConfigService=e,this.cachedApps=new Map,this.appsLoadingPromise=void 0}return e.prototype.getApp=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrLoadAppById(e.id)];case 1:return[2,(t=n.sent())?{titleInfo:t}:void 0]}}))}))},e.prototype.getOrLoadAppById=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return this.cachedApps.size&&(t=this.cachedApps.get(e))?[2,t]:[4,this.fetchAndCacheApps()];case 1:return[2,n.sent().get(e)]}}))}))},e.prototype.fetchAndCacheApps=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this.appsLoadingPromise?[2,this.appsLoadingPromise]:(this.appsLoadingPromise=this.fetchApps(),e=this,[4,this.appsLoadingPromise]);case 1:return e.cachedApps=t.sent(),this.appsLoadingPromise=void 0,[2,this.cachedApps]}}))}))},e.prototype.fetchApps=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.pluginConfigService.executeOperation({type:yC.a.GetPluginDefinition})];case 1:return"Success"===(null==(e=n.sent())?void 0:e.status)&&Of.b.typeGuard(e)?(t=SC(e.pluginDefinitions),[2,new Map(t.map((function(e){return[e.appId,e]})))]):[2,new Map]}}))}))},e}(),SC=function(e){return Array.isArray(e)?e.map((function(e){return SC(e)})):null!=e&&e.constructor===Object?Object.keys(e).reduce((function(t,n){var r;return Object(o.__assign)(Object(o.__assign)({},t),((r={})[Object(CC.camelCase)(n)]=SC(e[n]),r))}),{}):e},EC=n(406),xC=n(1811),IC=function(){function e(e){this.pluginConfigService=e}return e.prototype.botInvoke=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.processRequest(e),n={type:yC.a.GetBotResult,botRequest:t},[4,this.pluginConfigService.executeOperation(n)];case 1:return"Success"!==(null==(r=o.sent())?void 0:r.status)?[2,void 0]:(i=r.botResult,r.botResult.Error?[2,{type:xC.a.Error,value:{errorCode:i.Error.HttpCode,errorMessage:i.Error.Message}}]:[2,{type:xC.a.Result,value:i.response}]);case 2:return o.sent(),[2,void 0];case 3:return[2]}}))}))},e.prototype.processRequest=function(e){var t,n,r,o,i,a={request:{metaOsAppId:e.appId,msaAppId:e.botId,name:e.requestBody.name,value:null!==(t=e.requestBody.value.serializedValue)&&void 0!==t?t:e.requestBody.value,extension:{generateCardSignature:null!==(r=null===(n=e.requestBody.extension)||void 0===n?void 0:n.generateCardSignature)&&void 0!==r&&r,generateFallbackHtml:null!==(i=null===(o=e.requestBody.extension)||void 0===o?void 0:o.generateFallbackHtml)&&void 0!==i&&i}},logicalId:Object(EC.generateGuid)(),scenario:{name:"M365CardSDK"}};return e.requestBody.appName&&(a.request.appName=e.requestBody.appName),e.requestBody.imdisplayname&&(a.request.imDisplayName=e.requestBody.imdisplayname),a},e}(),wC=n(1790),TC=n(300),kC=function(){function e(e){this.clientInfo=e,this.selectedAccount=null;var t=e&&(null==e?void 0:e.clientId)?e.clientId:"3068386c-7a16-4f6a-a664-043b6b232816",n=e&&(null==e?void 0:e.redirectUri)?e.redirectUri:"/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.13003/en-us_web/login.html";this.msalApp=new wC.a({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}return e.prototype.getToken=function(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,s,l,c=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,9]),[4,this.msalApp.initialize()];case 1:return o.sent(),(null==(i=this.msalApp.getAllAccounts())?void 0:i.length)>=1&&(this.clientInfo?this.selectedAccount=null!==(t=i.find((function(e){var t;return e.username===(null===(t=c.clientInfo)||void 0===t?void 0:t.userPrincipalName)})))&&void 0!==t?t:null:this.selectedAccount=i[0]),this.selectedAccount||this.signInRequestPromise||(a=this.clientInfo?{loginHint:this.clientInfo.userPrincipalName}:void 0,this.signInRequestPromise=this.msalApp.loginPopup(a)),this.signInRequestPromise?[4,this.signInRequestPromise]:[3,3];case 2:(s=o.sent())&&(this.selectedAccount=s.account),this.signInRequestPromise=void 0,o.label=3;case 3:if(!this.selectedAccount)throw new Error("Failed to acquire token - No account found.");return n={scopes:["".concat(e.resource,"/.default")],account:this.selectedAccount},[4,this.msalApp.acquireTokenSilent(n)];case 4:return(l=o.sent())?[2,{authToken:l.accessToken}]:[3,9];case 5:return o.sent()instanceof TC.a?e.isSilent&&n?[4,this.msalApp.acquireTokenPopup(n)]:[3,7]:[3,8];case 6:return r=o.sent(),[3,8];case 7:throw new Error(nC.a);case 8:return this.signInRequestPromise=void 0,[3,9];case 9:if(r)return[2,{authToken:r.accessToken}];throw new Error("Failed to acquire token.")}}))}))},e}(),jC=function(e,t,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var a,s,l,c,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,t.getOrLoadPlugins()];case 1:return a=null!==(u=o.sent())&&void 0!==u?u:[],s={pluginsInfo:a,workflowAnnotationType:Of.a.getTypeName()},n(s),l=function(e){var t=a.filter((function(t){return t.id===function(e){switch(e){case Vd.Work:return tv.ENTERPRISE_SEARCH;case Vd.Web:return tv.WEB_SEARCH}return""}(e.id)})),n=t.length?t[0]:void 0;return n?"blocked"===n.state?Zd.Blocked:n.isEnabled?Zd.Enabled:Zd.Disabled:Zd.Disabled},c=[],null==e||e.map((function(e){var t=e.state,n=l(e);n!=Zd.Blocked&&(e.id===Vd.Work&&i||e.id===Vd.Web&&r)&&(n=Zd.Enabled),n===Zd.Blocked?(t===Zd.Enabled&&(wb("Plugin is blocked by admin, turning off ".concat(e.id," plugin Ux")),e.onToggle(!1)),c.push(e.id),jv("".concat(e.id,":AdminBlocked"))):(e.onToggle(n===Zd.Enabled),jv("".concat(e.id,":").concat(n===Zd.Enabled?"AutoOn":"AutoOff")))})),[2,c]}}))}))},PC=function(){function e(e,t,n,r,i,a,s,l){var c=this;this.getTransformFileSuggestionText=function(){var e,t;if(c.zqmProps)try{for(var n=Object(o.__values)(c.zqmProps.promptSuggestionList),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.shouldLaunchCIQOnSelection)return i.suggestionText}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return Cm},this.chatInputRef=e,this.handleSubmit=t,this.isExecuting=n,this.chatEditor=r,this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=i,this.setChatInputStateExpanded=a,this.isHVCAppChatV2Enabled=null!=s&&s,this.hvcPromptStringsList=null!=l?l:[],this.telemetryLoggerUtils=om.getInstance()}return e.prototype.handleZQMButtonClick=function(e,t){var n,r,i;return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return this.isExecuting?[2]:(gb(Cm),qf.getInstance().sendLoggingEventToClient(Vf.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ZQMButtonV2Clicked}]),a=this.zqmProps.promptSuggestionList.find((function(e){return e.suggestionText==t})),s=e,l=Cm,[4,this.setChatInputStateExpanded()]);case 1:return o.sent(),(null==a?void 0:a.shouldSubmitQueryOnClick)?(this.isHVCAppChatV2Enabled&&(s=s.replace(/{|}/g,"")),this.handleSubmit({text:s,telemetryData:mf.ZQMButtonClicked}),[2]):(t===this.transformFileSuggestionText&&(l=this.transformFilePlaceholderText),null===(n=this.chatInputRef.current)||void 0===n||n.setInputText(s,!0),null===(r=this.chatInputRef.current)||void 0===r||r.setFocus(),t===this.transformFileSuggestionText&&this.chatEditor&&setTimeout((function(){var e;return null===(e=c.chatInputRef.current)||void 0===e?void 0:e.updateInputText(Fu,$d.InsertAtCursor)}),1),null===(i=this.chatInputRef.current)||void 0===i||i.setGhostText(l),[2])}}))}))},e.prototype.getProps=function(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{promptSuggestions:this.zqmProps.promptSuggestionList.map((function(e){var t;return{promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,isDisabled:null!==(t=e.isDisabled)&&void 0!==t&&t,iconRegular:e.iconRegular}})),isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,handleButtonClick:this.handleZQMButtonClick,hvcPromptStringsList:this.hvcPromptStringsList}},e}(),AC=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){return wb("CopilotLicensingAnnotation received"),e=om.getInstance(),Gb.getInstance().setLicenseAnnotationActivated(!0),e.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLicensingAnnotationActivated},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),Gb.getInstance().resubmitOnLicenseAnnotationActivation(),[2]}))}))},_C=function(){this.getProps=function(e){return{handleRestrictiveMsgDismissClick:e}}},DC=function(){function e(){}return e.prototype.getDebugSectionProps=function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,h,f){return{conversationId:t,getLogs:e,telemetryData:n,sessionId:r,conversationLogObject:o,debugMessageInfoObject:i,showDebugInfoMessage:a,setShowDebugInfoOnMessage:s,chatPaneLoadTime:l,chatInputLoadTime:c,sydneyConversationObject:u,augloopKustoQueryURL:d,clientKustoQueryURL:p,appName:g,appPlatform:h,sdxVersion:f}},e}(),LC=Object(pe.a)({deleteAllButton:{width:"100%"}}),MC=ce.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return ce.createElement(be.a,{className:Object(x.a)(Rr().root,LC().deleteAllButton,n),icon:ce.createElement(jr.k,{className:r}),onClick:t,"aria-label":Pr()},Pr())})),BC=ce.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return ce.createElement(be.a,{className:Object(x.a)(Rr().root,Fr().root,n),icon:ce.createElement(Jn.d,{className:r}),onClick:t,"aria-label":U()?OfficeaicopilotStrings.BackButtonText:"Go back"})})),RC=(ce.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return ce.createElement(be.a,{className:Object(x.a)(Rr().root,Fr().root,n),icon:ce.createElement(we.p,{className:r}),onClick:t,"aria-label":Ar()})})),ce.memo((function(e){var t=e.onClick,n=e.customStyles,r=e.customIconStyles;return ce.createElement(be.a,{className:Object(x.a)(Rr().root,n),icon:ce.createElement(we.p,{className:r}),onClick:t,"aria-label":Ar(),size:"small"},U()?OfficeaicopilotStrings.NewChatButtonText:"New chat")}))),FC={Root:Object(o.__assign)({justifyContent:"space-between"},Me.a.padding("0px","16px","10px","0px")),label:Object(o.__assign)({},Me.a.padding("3px")),icon:{fontSize:"16px"},toolbarGroup:{display:"flex"}},NC=Object(pe.a)(FC),HC=ce.memo((function(e){var t=e.title,n=e.backButtonProps,r=e.newConversationButtonProps,o=NC();return ce.createElement(Pt.a,{"aria-label":U()?OfficeaicopilotStrings.ChatHistoryHeaderAriaLabel:"Tool bar",className:o.Root},ce.createElement(At.a,{role:"presentation",className:o.toolbarGroup},ce.createElement(BC,{customIconStyles:o.icon,onClick:n.onClick}),ce.createElement(ye.a,{className:o.label,size:"large"},t)),ce.createElement(At.a,{role:"presentation"},ce.createElement(RC,{customIconStyles:o.icon,onClick:r.onClick})))})),UC=ce.memo(HC),VC=Object(E.a)(P),zC={Root:{overflowY:"auto",maxHeight:"100%"},TriggerButtonStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.border("none")),{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:VC.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:VC.colorNeutralBackground3Hover}}}),SplitButtonGroupStyle:(mC={},mC["& .".concat(ac.a.icon)]={display:"none"},mC["&:hover .".concat(ac.a.icon)]={display:"inline"},mC["& > :nth-child(2) > :nth-child(2)"]={display:"inline"},mC["&:hover > :nth-child(2) > :nth-child(2)"]={display:"none"},mC),SplitButtonLeftButtonStyle:Object(o.__assign)(Object(o.__assign)({},Me.a.overflow("hidden")),{textOverflow:"ellipsis",whiteSpace:"nowrap",flexShrink:1,display:"inline-block"}),SplitButtonRightButtonStyle:{paddingLeft:"6px !important","&:before":{display:"none"}},LoadingSkeletonStyle:Object(o.__assign)({width:"inherit",alignItems:"center",display:"flex",paddingTop:"5px",paddingBottom:"5px",position:"relative"},Me.a.gap("5px")),SplitButtonAdditionalStyle:{backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:VC.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:VC.colorNeutralBackground3Hover}},maxWidth:"100%"},EmptyConversationListTextStyle:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column",paddingTop:"30px",paddingBottom:"30px"}},GC=Object(pe.a)(zC);var WC=ce.forwardRef((function(e,t){var n=e.isInErrorState,r=e.isChatHistoryListLoading,o=e.conversationOnClick,i=e.deleteOnClick,a=e.conversations,s=GC();return ce.createElement(Oe.a,{ref:t,className:s.Root},r?ce.createElement(My.a,{role:"menuitem"},ce.createElement("div",{className:s.LoadingSkeletonStyle},ce.createElement(By.a,{shape:"circle",size:16}),ce.createElement(By.a,{shape:"rectangle",size:16})),ce.createElement("div",{className:s.LoadingSkeletonStyle},ce.createElement(By.a,{shape:"circle",size:16}),ce.createElement(By.a,{shape:"rectangle",size:16})),ce.createElement("div",{className:s.LoadingSkeletonStyle},ce.createElement(By.a,{shape:"circle",size:16}),ce.createElement(By.a,{shape:"rectangle",size:16}))):n?ce.createElement("div",{className:s.EmptyConversationListTextStyle},ce.createElement("div",null,ce.createElement(ye.a,{size:"large"},U()?OfficeaicopilotStrings.ConversationListErrorStateTitle:"Something went wrong")),ce.createElement("div",null,ce.createElement(ye.a,null,U()?OfficeaicopilotStrings.ConversationListErrorStateText:"Chat history is having a hard time loading. Please, try again later."))):0===a.length?ce.createElement(ye.a,{className:s.EmptyConversationListTextStyle},U()?OfficeaicopilotStrings.EmptyConversationListText:"No previous Copilot chats in this document"):a.map((function(e){return ce.createElement(Lt.a,{key:e.conversationId,className:s.SplitButtonGroupStyle},ce.createElement(Se.a,{className:Object(x.a)(s.SplitButtonLeftButtonStyle,s.SplitButtonAdditionalStyle),onClick:function(){return o(e)}},e.conversationName),ce.createElement(Se.a,{className:Object(x.a)(s.SplitButtonRightButtonStyle,s.SplitButtonAdditionalStyle),onClick:function(){return i(e)},icon:ce.createElement(Jn.n,null)},ce.createElement("span",null,e.timeOfCreation)))})))})),QC=ce.memo(WC),qC={Root:Object(o.__assign)(Object(o.__assign)({display:"flex",flexDirection:"column"},Me.a.padding("0px","3px")),{justifyContent:"space-between",height:"100%"}),ChatHistoryPanelBodyStyle:Object(o.__assign)({overflowY:"auto",flexGrow:1},Me.a.padding("0px","13px")),DeleteButtonContainerStyle:Object(o.__assign)({alignSelf:"flex-end",width:"95%"},Me.a.margin("10px","auto"))},KC=Object(pe.a)(qC),YC=ue.a.forwardRef((function(e,t){var n=e.headerProps,r=e.conversationListProps,o=e.deleteButtonProps,i=KC();return ue.a.createElement("div",{className:i.Root},ue.a.createElement(UC,{title:n.title,backButtonProps:n.backButtonProps,newConversationButtonProps:n.newConversationButtonProps}),ue.a.createElement("div",{className:i.ChatHistoryPanelBodyStyle},ue.a.createElement(QC,{ref:t,isChatHistoryListLoading:r.isChatHistoryListLoading,conversationOnClick:r.conversationOnClick,deleteOnClick:r.deleteOnClick,conversations:r.conversations,isInErrorState:r.isInErrorState})),ue.a.createElement("div",{className:i.DeleteButtonContainerStyle},ue.a.createElement(MC,{onClick:o.onClick})))})),ZC=ue.a.memo(YC),JC=function(e){var t=e.setChatLog,n=e.currentChatId,r=e.setIsExecuting,i=e.setLoadingComponentProps,a=e.suggestionPillsBuilderRef,s=e.createAndSubmitChatHistorySignal,l=e.resetToNewConversation,c=e.setChatHistoryMenuData,u=e.handleChatHistoryPanelClose,d=e.isSwitchingConversation,p=e.isChatHistoryMenuLoading,g=e.chatHistoryMenuData,h=e.isChatHistoryPanelFetchingMoreChats,f=e.setIsChatHistoryPanelFetchingMoreChats,m=e.isEndOfChatHistory,v=e.isChatHistoryMenuLoadingFailed,b=Object(ce.useRef)(null),y=Object(ce.useRef)(150);Object(ce.useEffect)((function(){h&&!m&&s(yf.c.GetAllChatsOperation)}),[h]),Object(ce.useEffect)((function(){var e=b.current;if(e)return e.addEventListener("scroll",C),function(){return e.removeEventListener("scroll",C)}}),[]);var C=function(e){!(e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight)<y.current)||h||m||f(!0)},O=ue.a.useCallback((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return u(),wb("Change Topic Button Clicked."),a.current.setSuggestedQnAList([]),SO(!0),i((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[cy()[1]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,s(yf.c.AddChatOperation)];case 1:return e.sent(),r(!0),[2]}}))}))}),[a,i,cy,s]),S=ue.a.useCallback((function(e){n!==e.conversationId&&(d.current=!0,s(yf.c.GetMessagesOperation,void 0,void 0,void 0,e.conversationId),i((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[cy()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),r(!0)),u()}),[n,s,i,cy]),E=ue.a.useCallback((function(e){s(yf.c.DeleteChatOperation,void 0,void 0,void 0,e.conversationId),c(g.filter((function(t){return t.sessionId!==e.conversationId}))),e.conversationId===n&&(l(),t([]))}),[s,g,n]);return ue.a.createElement(ZC,{ref:b,headerProps:{title:dm()?OfficeaicopilotStrings.ChatHistoryPanelTitle:"Copilot Chats",backButtonProps:{onClick:function(){return u()}},newConversationButtonProps:{onClick:O}},conversationListProps:{isChatHistoryListLoading:p,conversationOnClick:S,deleteOnClick:E,conversations:g.map((function(e){return{conversationName:e.chatName&&""!==e.chatName?e.chatName:dm()?OfficeaicopilotStrings.ChatHistoryPanelEmptyConversationName:"Empty chat",conversationId:e.sessionId,timeOfCreation:"".concat(String(new Date(e.createTimeUtc).getDate()).padStart(2,"0"),"/").concat(String(new Date(e.createTimeUtc).getMonth()+1).padStart(2,"0"),"/").concat(new Date(e.createTimeUtc).getFullYear())}})),isInErrorState:v},deleteButtonProps:{onClick:function(){return window.open("https://go.microsoft.com/fwlink/?linkid=2259761","_blank")}}})},XC=function(){this.getProps=function(e){return{handlePythonExitAnalysisButtonClick:e}}},$C=n(2679),eO=function(){function e(){this.requestByQueryId=new Map}return e.prototype.executeOperation=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Object(o.__generator)(this,(function(o){return t=function(e){var t=new $C.a({operation:e,queryId:Object(xf.a)()}),n=om.getInstance(),r=new bv.b({parentPath:["Signal",$C.a.getTypeName()],items:[{id:yv.a.generateId(),body:t}]}),o=e.type;return n.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.PluginConfigSignalSent},{key:hf.ChatEventParameters,value:"".concat($C.a.getTypeName(),"_").concat(o)}]),wb("Submitting signal to Augloop : ".concat($C.a.getTypeName()," signal: ").concat(JSON.stringify(t))),Gb.getInstance().submitOperation(r,Of.a.getTypeName()),t}(e),n=new tO,this.requestByQueryId.set(t.queryId,n),r=n.completion.then((function(){return!0})),i=cm(6e4).then((function(){return!1})),[2,Promise.race([r,i]).then((function(r){return r?n.completion:(a.requestByQueryId.delete(t.queryId),Promise.reject(new Error("Timeout executing operation ".concat(e.type))))}))]}))}))},e.prototype.onOperationResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e}(),tO=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),nO=function(){function e(){this.current=void 0,this.pending=void 0,this.resolvePending=void 0}return e.prototype.awaitChatHistoryPlugin=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){return this.current?[2,this.current]:(e=this.pending||this.initPendingPromise(),t=e.then((function(){return!0})),n=cm(mm).then((function(){return!1})),[2,Promise.race([t,n]).then((function(t){return t?e:Promise.reject(new Error("Timeout during awaiting chat history plugins"))}))])}))}))},e.prototype.onChatHistoryPluginInfo=function(e){var t;this.current=e.map((function(e){return e.id})),null===(t=this.resolvePending)||void 0===t||t.call(this,this.current)},e.prototype.initPendingPromise=function(){var e=this;return this.pending=new Promise((function(t){e.resolvePending=t}))},e}(),rO=function(){function e(e,t,n){var r=this;this.pluginConfigService=e,this.chatHistoryEnabledPluginsSource=t,this.pluginParams=n,this.plugins=void 0,this.pluginsLoadingPromise=void 0,this.telemetryLoggerUtils=om.getInstance(),this.logFailure=function(e){r.telemetryLoggerUtils.sendTelemetryErrorData([{key:ff.ErrorMessage,value:e},{key:ff.ErrorType,value:kf.Server},{key:ff.ErrorCode,value:Jm.AugloopPluginProviderFailure},{key:ff.ErrorCategory,value:Jf.Augloop}])}}return e.prototype.getPlugins=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return[2,e.sent()]}}))}))},e.prototype.getStoreFrontPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.installStoreFrontPlugin=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){throw new Error("Method not implemented.")}))}))},e.prototype.getPluginsGrouped=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getOrLoadPlugins()];case 1:return e=t.sent(),[2,e.map((function(e){return{groupHeaderPlugin:e,plugins:[e]}}))]}}))}))},e.prototype.setPlugin=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.plugins=Object(CC.unionBy)(this.plugins,[e],"id"),this.pluginParams.logGroundingSourceEvent&&Tv(e,e.isEnabled?"On":"Off"),[2,Promise.resolve()]}))}))},e.prototype.getEnabledPlugins=function(){return this.plugins?this.plugins.filter((function(e){return e.isEnabled})).map((function(e){return{id:e.id,source:e.source}})):[]},e.prototype.getOrLoadPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this.plugins?[2,this.plugins]:this.pluginsLoadingPromise?[2,this.pluginsLoadingPromise]:(this.pluginsLoadingPromise=this.loadPlugins(),[4,this.pluginsLoadingPromise]);case 1:return e=t.sent(),this.plugins=e,this.pluginsLoadingPromise=void 0,[2,e]}}))}))},e.prototype.getRestrictedSearchMode=function(){var e;return null===(e=this.restrictedSearchConfigResponse)||void 0===e?void 0:e.RestrictedSearchMode},e.prototype.loadPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.getInstalledPlugins(),this.getChatHistoryEnabledPlugins()])];case 1:return e=o.__read.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],t?(t.forEach((function(e){"acquired"===e.state?(n.has(e.id)&&(e.isEnabled=!0),e.id===tv.WEB_SEARCH&&r.pluginParams.isWebSearchDefaultOn&&(e.isEnabled=!0),r.pluginParams.logGroundingSourceEvent&&Tv(e,e.isEnabled?"AutoOn":"AutoOff")):r.pluginParams.logGroundingSourceEvent&&Tv(e,"AdminBlocked")})),[2,t]):[2,void 0]}}))}))},e.prototype.getInstalledPlugins=function(){var e,t,n,r;return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.pluginConfigService.executeOperation({type:yC.a.GetPluginConfig})];case 1:return"Success"!==(null==(i=o.sent())?void 0:i.status)?(this.logFailure("GetPluginConfig operation failed"),[2,void 0]):((null===(e=i.installedPlugins)||void 0===e?void 0:e.PluginGroups.findIndex((function(e){var t;return!e.IsDisabledByAdmin&&(null===(t=e.PluginDescriptions)||void 0===t?void 0:t.findIndex((function(e){return e.CopilotPluginInfo.Id===tv.ENTERPRISE_SEARCH})))>=0})))>=0&&(this.restrictedSearchConfigResponse=null===(t=i.pluginProperties)||void 0===t?void 0:t.enterpriseRestrictedSearch),[2,null!==(r=null===(n=i.installedPlugins)||void 0===n?void 0:n.PluginGroups.flatMap(oO))&&void 0!==r?r:[]]);case 2:return a=o.sent(),this.logFailure("Exception in getInstalledPlugins: "+a.message),[2,void 0];case 3:return[2]}}))}))},e.prototype.getChatHistoryEnabledPlugins=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.chatHistoryEnabledPluginsSource.awaitChatHistoryPlugin()];case 1:return e=t.sent(),[2,new Set(e)];case 2:return t.sent(),[2,new Set];case 3:return[2]}}))}))},e}();function oO(e){return(null==e?void 0:e.PluginDescriptions)?e.PluginDescriptions.map((function(t){return function(e,t){var n,r,o,i,a,s;if(!t.CopilotPluginInfo.Id)return;var l=null!==(n=e.DisplayName)&&void 0!==n?n:t.DisplayName;if(!l)return;return{icon:null!==(i=null!==(o=null!==(r=e.IconUrl)&&void 0!==r?r:e.IconBase64)&&void 0!==o?o:t.IconUrl)&&void 0!==i?i:t.IconBase64,name:l,metaOSAppId:e.MetaOSAppId,id:null!==(a=t.CopilotPluginInfo.Id)&&void 0!==a?a:e.MetaOSAppId,state:e.IsDisabledByAdmin?"blocked":"acquired",source:null!==(s=t.CopilotPluginInfo.Source)&&void 0!==s?s:"",type:iO(t.CopilotPluginInfo.Id),isEnabled:!1,rank:0}}(e,t)})).filter((function(e){return!!e})):[]}function iO(e){return e?e.includes("MessageExtension")?"MsgExt":e.includes("BingWebSearch")?"FirstParty":e.includes("DataVerse")?"DataVerse":e.includes("PowerPlatform")?"PowerPlatform":"Unsupported":"Unsupported"}var aO=function(){this.getProps=function(e){return{buttonText:e.buttonText,icon:e.icon,onClick:e.onClick}}},sO=n(752),lO=function(){function e(){this.telemetryLoggerUtils=om.getInstance()}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d;return{tag:null!==(t=ga.h[e.tag].toString())&&void 0!==t?t:"",name:null!==(r=null===(n=ga.g[e.name])||void 0===n?void 0:n.toString())&&void 0!==r?r:"",source:null!==(i=null===(o=e.source)||void 0===o?void 0:o.toString())&&void 0!==i?i:"",duration:null!==(s=null===(a=e.duration)||void 0===a?void 0:a.toString())&&void 0!==s?s:"",success:null!==(c=null===(l=ga.j[e.success])||void 0===l?void 0:l.toString())&&void 0!==c?c:"",correlationVector:null!==(d=null===(u=e.correlationVector)||void 0===u?void 0:u.toString())&&void 0!==d?d:""}},e.prototype.LogEvent=function(e){if(wb("MsgExtCardTelemetry Info: ",e),e.type&&e.tag&&e.name){var t=this.getRecord(e),n="";try{n=JSON.stringify(t)}catch(e){return void wb("Error while stringifying chatEventData:",e)}switch(e.type){case sO.e.LogInfo:case sO.e.LogMetric:this.logInfo(n);break;case sO.e.LogError:case sO.e.LogException:this.logError(t)}}},e.prototype.logInfo=function(e){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MsgExtCardDataReceived},{key:hf.ChatEventParameters,value:e}])},e.prototype.logError=function(e){var t=(null==e?void 0:e.message)||"";this.telemetryLoggerUtils.sendTelemetryErrorData([{key:ff.ErrorMessage,value:t},{key:ff.ErrorType,value:kf.Server},{key:ff.ErrorCode,value:Jm.MsgExtCardError},{key:ff.ErrorCategory,value:Jf.ChatEvents}])},e}(),cO=function(){function e(){this.telemetryLogger=new lO}return e.prototype.LogInfo=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogError=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogException=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogWarning=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogVerbose=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e.prototype.LogMetric=function(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)},e}(),uO=null,dO=null,pO=null,gO=!1,hO="",fO="",mO=0,vO=ce.forwardRef((function(e,t){var a,s,u,d,h,f,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B,R,F,N,H,U,V,z,G,W,Q,q,Y=e.style,Z=e.platformType,J=void 0===Z?r.web:Z,X=e.copilotCommunicationHandler,$=e.copilotTelemetryHandler,ee=void 0===$?new nm:$,te=e.theme,ne=void 0===te?Xb:te,re=e.themeV2,oe=void 0===re?void 0:re,ie=e.useALRuntime,ae=void 0!==ie&&ie,le=e.chatUiProps,pe=e.designerProps,ge=e.basicChatProps,fe=e.debugProps,me=e.copilotPluginProps,ve=Object(ce.useRef)((new Date).getTime());i=J;var be=null!==(a=le.chatInputProps)&&void 0!==a?a:le.chatInputV2Props,ye=le.chatInputV2Props,Ce=null!==(s=be.isHVCAppChatV2Enabled)&&void 0!==s&&s,Oe=null!==(u=be.hvcPromptStrings)&&void 0!==u?u:[],Se=null!==(d=be.hvcPromptStringsList)&&void 0!==d?d:[],Ee=null!==(h=be.useSortedHVCTokenList)&&void 0!==h&&h,xe=be.onChatInputHVCPromptUpdated,Ie=null!==(f=be.onUserQuerySubmitted)&&void 0!==f?f:function(){},we=le.clientInfoProps?le.clientInfoProps.clientInfo:K(),Te=le.clientInfoProps?null===(v=le.clientInfoProps)||void 0===v?void 0:v.taskModuleLauncher:void 0,ke=null!==(b=null==ye?void 0:ye.shouldInitializeEditorInChatInput)&&void 0!==b&&b,je=qf.getInstance(X),Pe=om.getInstance(),Ae=Object(o.__read)(Object(ce.useState)(!1),2),_e=Ae[0],De=Ae[1],Le=null===(y=null==me?void 0:me.copilotList.find((function(e){return e.isDefaultCopilot})))||void 0===y?void 0:y.id,Me=null===(C=null==me?void 0:me.copilotList.find((function(e){return e.isSelected})))||void 0===C?void 0:C.id,Be=me&&me.copilotList.length>1,Re=null!==(O=(null==me?void 0:me.showNewChatButtonOnTop)&&Be)&&void 0!==O&&O,Fe=Object(o.__read)(ce.useState(ce.createElement(ce.Fragment,null)),2),Ne=Fe[0],He=Fe[1],Ue=Object(o.__read)(ce.useState(!1),2),Ve=Ue[0],We=Ue[1],Qe=function(e,t){We(t.open);var n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};je.sendLoggingEventToClient(Vf.CopilotSwitcherMenuStateChange,n)},qe=void 0!==oe,Ye=yy(),Ze=Cy();Oy(qe?Ze:Ye,Y);var Je=Object(o.__read)(Object(ce.useState)([]),2),Xe=Je[0],$e=Je[1],et=Object(o.__read)(Object(ce.useState)(Xm.Shy),2),tt=et[0],nt=et[1],rt=Object(ce.useRef)(),ot=new Pv($e,X,rt),it=Object(ce.useRef)(null),at=Object(ce.useRef)(null),st=Object(ce.useRef)(null),lt=Object(ce.useRef)(!1),ct=Object(o.__read)(Object(ce.useState)(!1),2),ut=ct[0],dt=ct[1],pt=ce.useCallback((function(){return ut}),[ut]),gt=Object(o.__read)(Object(ce.useState)(),2),ht=gt[0],ft=gt[1],mt=Object(ce.useRef)(0),vt=Object(ce.useRef)(),bt=Object(o.__read)(Object(ce.useState)(!1),2),yt=bt[0],Ct=bt[1],Ot=Object(o.__read)(Object(ce.useState)(!1),2),St=Ot[0],Et=Ot[1],xt=Object(o.__read)(Object(ce.useState)(!1),2),It=xt[0],wt=xt[1],Tt=Object(o.__read)(Object(ce.useState)(!0),2),kt=Tt[0],Pt=Tt[1],At=Object(o.__read)(Object(ce.useState)(!1),2),_t=At[0],Dt=At[1],Lt=Object(o.__read)(Object(ce.useState)([]),2),Mt=Lt[0],Bt=Lt[1],Rt=Object(o.__read)(Object(ce.useState)(!1),2),Ft=Rt[0],Nt=Rt[1],Ht=Object(o.__read)(Object(ce.useState)(!1),2),Ut=Ht[0],Vt=Ht[1],zt=Object(o.__read)(Object(ce.useState)({loadingUiStringList:ly(),shouldShowLoadingUi:!0}),2),Gt=zt[0],Wt=zt[1],Qt=Object(o.__read)(Object(ce.useState)({headerText:Cm,descriptionText:Cm}),2),qt=Qt[0],Kt=Qt[1],Yt=le.tipCardProps,Zt=Object(o.__read)(Object(ce.useState)(!1),2),Jt=Zt[0],Xt=Zt[1],$t=Object(o.__read)(Object(ce.useState)(!1),2),en=$t[0],tn=$t[1],nn=Object(o.__read)(Object(ce.useState)(Xb),2),rn=nn[0],on=nn[1],an=Object(o.__read)(Object(ce.useState)($b),2),sn=an[0],ln=an[1],un=Object(o.__read)(Object(ce.useState)(!1),2),dn=(un[0],un[1]),pn=Object(o.__read)(Object(ce.useState)(void 0!==le.freUiProps),2),gn=pn[0],hn=pn[1],fn=Object(o.__read)(Object(ce.useState)(!1),2),mn=fn[0],vn=fn[1],bn=Object(o.__read)(Object(ce.useState)(!1),2),yn=bn[0],Cn=bn[1],On=Object(o.__read)(Object(ce.useState)(ty.Uninitialized),2),Sn=On[0],En=On[1],xn=Object(o.__read)(Object(ce.useState)(!1),2),In=xn[0],wn=xn[1],Tn=Object(o.__read)(Object(ce.useState)(!1),2),kn=Tn[0],jn=Tn[1],Pn=Object(ce.useRef)(!1),An=Object(ce.useRef)(),_n=Object(o.__read)(Object(ce.useState)(!1),2),Dn=_n[0],Ln=_n[1],Bn=ae,Rn=ce.useRef(),Fn=Object(o.__read)(Object(ce.useState)(),2),Nn=Fn[0],Hn=Fn[1],Un=Object(o.__read)(Object(ce.useState)(),2),Vn=Un[0],zn=Un[1],Gn=Object(o.__read)(ce.useState(!1),2),Qn=Gn[0],qn=Gn[1],Kn=Object(o.__read)(ce.useState([]),2),Yn=Kn[0],Zn=Kn[1],Jn=Object(o.__read)(Object(ce.useState)(!1),2),Xn=Jn[0],$n=Jn[1],tr=Object(o.__read)(Object(ce.useState)(!1),2),nr=tr[0],rr=tr[1],or=Object(o.__read)(Object(ce.useState)(),2),ir=or[0],ar=or[1],sr=Object(o.__read)(Object(ce.useState)(le.copilotWorkflowProps),2),lr=sr[0],cr=sr[1],dr=Object(o.__read)(Object(ce.useState)(0),2),pr=dr[0],gr=dr[1],hr=Object(o.__read)(Object(ce.useState)(!1),2),fr=hr[0],mr=hr[1],vr=Object(o.__read)(Object(ce.useState)(null),2),br=vr[0],yr=vr[1],Cr=Object(o.__read)(Object(ce.useState)(null),2),Or=Cr[0],Er=Cr[1],xr=Object(ce.useRef)(!1),Ir=Object(ce.useRef)(),wr=Object(ce.useRef)(!0),Tr=Object(o.__read)(Object(ce.useState)(!1),2),jr=Tr[0],Pr=Tr[1],Ar=Object(o.__read)(Object(ce.useState)(!1),2),_r=Ar[0],Dr=Ar[1],Lr=Object(o.__read)(Object(ce.useState)(!1),2),Mr=Lr[0],Br=Lr[1],Rr=Object(o.__read)(Object(ce.useState)([]),2),Fr=Rr[0],Nr=Rr[1],Hr=Object(o.__read)(Object(ce.useState)(!1),2),Vr=Hr[0],zr=Hr[1],Gr=Object(o.__read)(Object(ce.useState)(!1),2),Wr=Gr[0],Qr=Gr[1],qr=Object(o.__read)(Object(ce.useState)(!1),2),Kr=qr[0],Yr=qr[1],Zr=ce.useRef(!1),Jr=ce.useRef(!1),Xr=ce.useRef(void 0),$r=new uy,eo=new ay,to=null===(S=le.toggleUiProps)||void 0===S?void 0:S.trySydneyToggleEnabled,no=null===(E=le.toggleUiProps)||void 0===E?void 0:E.tryEnterpriseSearchToggleEnabled,ro=null===(x=le.toggleUiProps)||void 0===x?void 0:x.tryWebSearchToggleEnabled,oo=null===(I=le.toggleUiProps)||void 0===I?void 0:I.tryReviewerAgentToggleEnabled,io=new hy,ao=new ky,so=new DC,lo=new sy(le.hintCardProps),co=new Ay,uo=new XC,po=new _C,go=new aO,ho=function(){var e;return ke?null===(e=rt.current)||void 0===e?void 0:e.getChatEditorInstance():Nn},fo=!!(null===(w=le.copilotWorkflowProps)||void 0===w?void 0:w.enableWorkflowPlugin)&&le.copilotWorkflowProps.enableWorkflowPlugin,mo=null!==(k=null===(T=null==be?void 0:be.voiceInputProps)||void 0===T?void 0:T.handleInChatInput)&&void 0!==k&&k,vo=null!==(j=le.zeroQueryMessageProps)&&void 0!==j?j:le.zeroQueryMessageV2Props,bo=le.copilotLabProps;ne=null!=ne?ne:oe;var yo=-1,Co=function(){var e,t,n,r,o;wb("handleEditorOpenButtonClick"),xr.current=!0;var i=Fu,a=null!==(e=null==Oo?void 0:Oo.ciqPlaceholderText)&&void 0!==e?e:rv();null===(t=rt.current)||void 0===t||t.setInputText(i),null===(n=rt.current)||void 0===n||n.setGhostText(a),null===(r=rt.current)||void 0===r||r.setFocus(),null===(o=ho())||void 0===o||o.forceInvokeCIQMenu(Fu)};(null==be?void 0:be.voiceInputProps)&&hm[Object(pv.a)()]===hm.Safari&&(be.voiceInputProps=void 0);var Oo=null==be?void 0:be.editorConfig,So=function(){return X.isFeatureGateEnabledFromClient(Km.IsDebugSectionV2Enabled)};sv.isDevbuild()&&((null==fe?void 0:fe.isDebugToggleEnabled)||So())&&fv.initialize();var Eo,xo=!0;Object(ce.useImperativeHandle)(t,(function(){return{addResponseMessage:Ro.current.addResponseMessage,updateMessage:Ro.current.updateMessage,resendChatHistorySignal:Ro.current.resendChatHistorySignal,updateLastMessage:Ro.current.updateLastMessage,deleteMessage:Ro.current.deleteMessage,submitOperation:Ro.current.submitOperation,updateLoadingComponentProps:Ro.current.updateLoadingComponentProps,addChatMessages:Ro.current.addChatMessages,getLastMessage:function(e){if(mt.current>0)return Xe[jb(Xe,e)]},clearMessages:Ro.current.clearMessages,startLoadingUi:Ro.current.startLoadingUi,startReinitializeALSession:Ro.current.startReinitializeALSession,setInputAreaText:Ro.current.setInputAreaText,setInputFocus:Ro.current.setInputFocus,getInputText:Ro.current.getInputText,submitUserQuery:Ro.current.submitUserQuery}}));var Io=function(e,t,n){ot.setChatMessageData(e,t,n)},wo=function(){var e;return ke?null===(e=rt.current)||void 0===e?void 0:e.getCIQResponseHandler():Vn},To=function(){var e;return ke?null===(e=rt.current)||void 0===e?void 0:e.getCIQTextRef():An.current},ko=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return To()?e?[4,Oo.getSensitivityInfo(e)]:[3,2]:[3,4];case 1:return n=r.sent(),[3,3];case 2:n=null,r.label=3;case 3:t=n,$n(!1),To().setSensitivity(t),wt(!1),r.label=4;case 4:return[2]}}))}))},jo=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return To()?[4,Oo.getSensitivityInfo(null)]:[3,2];case 1:e=t.sent(),To().setSensitivity(e),$n(!1),t.label=2;case 2:return[2]}}))}))},Po=function(){var e;return(null===(e=rt.current)||void 0===e?void 0:e.getInputText())||""},Ao=function(){var e;null===(e=it.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},_o=function(e){return void 0===e&&(e=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,qo(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),wb("Exception occurred during initialization of AL"+t.message),[3,3];case 3:return[2]}}))}))},Do=function(e){var t,n,r,o,i,a,s,l;if(e){Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophoneLoadingTimeInMs},{key:hf.ChatEventParameters,value:OO(Sy)}]);var c=(null===(t=rt.current)||void 0===t?void 0:t.getInputText().length)>0&&xo?" ":Cm;null===(n=rt.current)||void 0===n||n.setGhostText(c+nv())}else(null===(r=rt.current)||void 0===r?void 0:r.getInputText())===Cm?null===(o=rt.current)||void 0===o||o.setGhostText(null!==(i=null==be?void 0:be.chatPlaceholderMessage)&&void 0!==i?i:xm):(null===(s=null===(a=rt.current)||void 0===a?void 0:a.getGhostText())||void 0===s?void 0:s.trim())===nv()&&(null===(l=rt.current)||void 0===l||l.setGhostText(Cm));jn(e),Pn.current=e};Object(ce.useEffect)((function(){if(Me!==Le){var e=null==me?void 0:me.copilotList.find((function(e){return e.id===Me}));e&&e.copilotComponent&&He(e.copilotComponent)}}),[null==me?void 0:me.copilotList,Le,Me]),Object(ce.useEffect)((function(){if(X.isFeatureGateEnabledFromClient(Km.IsChatHistoryPaginationEnabled)){var e=st.current;if(e){var t=0,n=!0,r=function(){st.current.scrollHeight-Math.round(st.current.scrollTop)-10<=st.current.clientHeight?n=!1:!lt.current&&Jv&&!n&&Math.round(e.scrollTop)<=Math.round(st.current.scrollHeight/3)&&t!=e.scrollHeight&&(rr(!0),t=e.scrollHeight,gr(t),Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,$v(yf.c.GetMessagesOperation,void 0,void 0,X)];case 1:return e.sent(),[2]}}))}))),Jv||e.removeEventListener("scroll",r)};e.addEventListener("scroll",r)}}}),[st.current,kt]),Object(ce.useEffect)((function(){var e;(null==(e=le.documentSensitivityProps)?void 0:e.isEncrypted)?om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CLPEncryptedLabelSent}]):om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CLPNonEncryptedLabelSent}]),Vv=e}),[le.documentSensitivityProps]),Object(ce.useEffect)((function(){To()||(wt(!1),$n(!1))}),[To]),Object(ce.useEffect)((function(){cr((function(e){return Object(o.__assign)(Object(o.__assign)({},e),le.copilotWorkflowProps)}))}),[le.copilotWorkflowProps]),Object(ce.useEffect)((function(){Ao()}),[null===(P=le.streamingUiProps)||void 0===P?void 0:P.cardDataValue,Yn,yt,Gt]),Object(ce.useEffect)((function(){var e;if(yt)je.sendLoggingEventToClient(Vf.QueryExecutionStarted);else{gb(Cm),je.sendLoggingEventToClient(Vf.QueryExecutionCompleted);var t=Cm;X.isFeatureGateEnabledFromClient(Km.EnableALCorrelationLogs)&&(t=Sb.getInstance().getQueryCv()),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QueryExecutionCompleted},{key:hf.Cv,value:t},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}]),hO="";try{Cb.getInstance().getIsBasicChatStreaming()&&Cb.getInstance().resetBasicChatStreamingStates()}catch(e){wb("An error was thrown while trying to reset basic chat streaming. "+e)}}null===(e=Ro.current)||void 0===e||e.setLocalIsExecuting(yt)}),[yt]),Object(ce.useEffect)((function(){!gn&&(null==vo?void 0:vo.promptSuggestionList.length)>0&&(je.sendLoggingEventToClient(Vf.ZQMLoaded),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ZQMLoaded}]))}),[gn]),Object(ce.useEffect)((function(){return vt.current=new sv(X.getHostSettings()),Fo.current.updateLocale(sv.getLanguage()),om.setTelemetryHandler(ee),uO=Jb.getInstance(),Kb.getInstance().initTelemetryLatencyObject(),je.sendLoggingEventToClient(Vf.ChatPaneInitalized,{timestamp:(new Date).getTime()}),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatPaneInitialized},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),dv.getInstance(X),Ab()?Wv.getInstance(Pt,Pr):Pt(!1),_o(),mO=0,X.updateCopilotState(Ff.IDLE),Xr.current=new py(rt,Bo,null==be?void 0:be.chatPlaceholderMessage,Io,Zn,X.isFeatureGateEnabledFromClient(Km.IsSuggestedQnACitationsEnabled)),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatInputEarlyLoadEnabled},{key:hf.ChatEventParameters,value:X.isFeatureGateEnabledFromClient(Km.ChatInputEarlyLoadEnabled)?"true":"false"}]),Er(CO(dO)),function(e){p=e}(void 0!==oe),function(){Eb.getInstance().clearAugloopResponseTimer(),Gb.getInstance().releaseActiveAnnotations(),Bb(),Wv.resetInstance(),Gb.resetInstance(),Eb.resetInstance(),dv.resetInstance(),qf.resetInstance(),Cv.resetInstance(),Cb.resetInstance(),om.resetInstance()}}),[]),Object(ce.useEffect)((function(){_t&&(_o(!0),Dt(!1))}),[_t]),Object(ce.useEffect)((function(){var e;kn||Object(ep.d)(Do).catch((function(e){wb("pauseMicandStopTimer Error"+e),Cv.Instance.ErrorMessage="Error_PauseMic_StopTimer"})),null===(e=rt.current)||void 0===e||e.setFocus()}),[kn]),Object(ce.useEffect)((function(){window.addEventListener("blur",(function(){var e;null===(e=rt.current)||void 0===e||e.closeMenu(),Ei(),(null==be?void 0:be.voiceInputProps)&&Pn.current&&Do(!1)}))})),Object(ce.useEffect)((function(){nr?yt||(st.current.scrollTop=st.current.scrollHeight-pr):Ao(),rr(!1),mt.current=Xe.length,gn&&Xe.length>0&&hn(!1)}),[Xe,gn]),Object(ce.useEffect)((function(){kt||(Ao(),ut&&(Pe.sendTelemetryLatencyData([{key:gf.ChatHistoryTimeInLoad,value:CO(Uv)}]),Pe.sendTelemetryLatencyData([{key:gf.CopilotChatLoadTime,value:CO(ve.current)}]),X.sendEventToClient(Uf.CopilotChatLoaded),je.sendLoggingEventToClient(Vf.ChatPaneLoaded,{timestamp:(new Date).getTime()}),yr(CO(dO)),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatPaneLoaded},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),!gn&&(null==vo?void 0:vo.promptSuggestionList.length)>0&&(je.sendLoggingEventToClient(Vf.ZQMLoaded),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ZQMLoaded}]))))}),[kt,ut]),Object(ce.useEffect)((function(){jr&&(X.sendEventToClient(Uf.ChatHistoryHydrationFailed),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatHistoryHydrationFailed}]),lt.current=jr,li.onChatHistoryPluginInfo([]))}),[jr]),Object(ce.useEffect)((function(){var e;ne.isDarkModeEnabled?(g(l.defaultBlack),Nn&&Nn.updateCurrentTheme(hu.dark)):(g(l.defaultWhite),Nn&&Nn.updateCurrentTheme(hu.light)),fo&&Nn&&(null===(e=null==le?void 0:le.copilotWorkflowProps)||void 0===e?void 0:e.enableEditorForSelectFileStage)&&cr((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{handleEditorOpenButtonClick:Co})})),ne.isHighContrastModeEnabled?m(!0):m(!1),on(ne),ln(oe),Fo.current.updateDarkMode(ne.isDarkModeEnabled)}),[ne,Nn]),Object(ce.useEffect)((function(){var e,t;((null===(e=null==le?void 0:le.suggestionPillsUiProps)||void 0===e?void 0:e.clearCacheSuggestionPills)||(null===(t=null==le?void 0:le.suggestionPillsUiProps)||void 0===t?void 0:t.suggestionList.length)>0)&&Xr.current.setSuggestedQnAList([])}),[null==le?void 0:le.suggestionPillsUiProps]),Object(ce.useEffect)((function(){ot&&Ct&&X&&(Cb.getInstance(ot,X,Ct),Cb.getInstance().setBasicChatProps(ge))}),[ge]),Object(ce.useEffect)((function(){var e;Dn&&Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.TrySydneyToggle},{key:hf.ChatEventParameters,value:(null===(e=le.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[Dn]),Object(ce.useEffect)((function(){var e;Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.IsSydneyEnabled},{key:hf.ChatEventParameters,value:(null===(e=le.toggleUiProps)||void 0===e?void 0:e.trySydneyToggleChecked)?"true":"false"}])}),[null===(A=le.toggleUiProps)||void 0===A?void 0:A.trySydneyToggleChecked]),Object(ce.useEffect)((function(){if(!St&&!ke&&Oo&&!Rn.current&&ht){var e=(new Wd).createInstance();Oo.telemLogger.logErrorTelemetry=function(e,t){Pe.sendTelemetryErrorData([{key:ff.ErrorMessage,value:t},{key:ff.ErrorCategory,value:e}])},Oo.telemLogger.logSuccessTelemetry=function(e,t){t?Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:e},{key:hf.ChatEventParameters,value:t}]):Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:e}])},e.bootstrap(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{augloopSession:t})}(Oo,ht)).then((function(t){Rn.current=e,Hn(t)}))}return function(){Rn.current&&Rn.current.shutdown().then((function(){Rn.current=void 0}))}}),[ht,Oo,St]),Object(ce.useEffect)((function(){tn((null==Yt?void 0:Yt.isError)&&(null==Yt?void 0:Yt.headerText)&&!gn&&!yt)}),[Yt,gn,yt]),Object(ce.useEffect)((function(){Et(yt||(null==Yt?void 0:Yt.isError)||(null==be?void 0:be.isDisabled)||(null==ye?void 0:ye.isDisabled)||Lo())}),[yt,Yt,be,ye]),Object(ce.useEffect)((function(){var e;ye&&(null==ye?void 0:ye.groundingSourcePickerProps)&&!(null===(e=null==ye?void 0:ye.buttonProps)||void 0===e?void 0:e.groundingButtonEnabled)&&(mr(!0),Iv=!0)}),[ye]),Object(ce.useEffect)((function(){Ro.current.setIsDisabled(St)}),[St]),Object(ce.useEffect)((function(){(null==bo?void 0:bo.copilotLabLink)&&Fo.current.updateCopilotLabLink(null==bo?void 0:bo.copilotLabLink),(null==bo?void 0:bo.isCopilotLabHeaderDisabled)&&Fo.current.updateIsHeaderDisabled(null==bo?void 0:bo.isCopilotLabHeaderDisabled),(null==bo?void 0:bo.facets)&&Fo.current.updateFacets(null==bo?void 0:bo.facets)}),[bo]),Object(ce.useEffect)((function(){if(Fo.current.updatePrompts(Mt),!(null==bo?void 0:bo.facets)){var e=(t=[],n=[],Mt.forEach((function(e){e.DisplayCategory&&!n.includes(e.DisplayCategory)&&n.push(e.DisplayCategory)})),n.forEach((function(e){t.push({value:e})})),t);Fo.current.updateFacets({displayCategory:e})}var t,n}),[Mt]);var Lo=function(){return X.isFeatureGateEnabledFromClient(Km.IsDisableChatInputWhenAlSessionCloseEnabled)&&yn};Object(ce.useEffect)((function(){var e,t,n;X.isFeatureGateEnabledFromClient(Km.IsDisableChatInputWhenAlSessionCloseEnabled)&&(null===(e=rt.current)||void 0===e||e.setInputText(""),null===(t=rt.current)||void 0===t||t.setGhostText(null!==(n=null==be?void 0:be.chatPlaceholderMessage)&&void 0!==n?n:xm),Et(yn),yn&&Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatInputDisabledAndBannerShownForInActiveChatSession}]))}),[X,yn]);var Mo=function(e){return!!ki()&&(wb("Setting pane load warning banner as chat history is still loading."),mn||vn(!0),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ChatPaneLoadMessageBarShown},{key:hf.ChatEventParameters,value:e.toString()}]),!0)},Bo=function(e){var t=e.text,n=e.links,i=e.telemetryData,a=e.queryAnnotations;return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,s,l,u,d,p,g,h;return Object(o.__generator)(this,(function(f){switch(f.label){case 0:return t&&0!==t.length||0!==Po().length?(hO=Object(xf.a)(),mO++,pO=(new Date).getTime(),Ie(),wr.current&&(wb("First Query submitted by User"),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.FirstQuerySubmitted},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),om.getInstance().sendTelemetryLatencyData([{key:gf.IsFirstSdxSessionQuery,value:!0}]),wr.current=!1),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:null!=i?i:mf.EnterKeyPressed},{key:hf.ChatEventParameters,value:(new Date).getTime().toString()}]),pb!==Cm&&Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabPromptSubmitted}]),(null==a?void 0:a.length)>0&&(e=a.map((function(e){return e.QueryAnnotationType})),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.PromptSubmittedWithCIQ},{key:hf.ChatEventParameters,value:JSON.stringify(e)}])),Wt((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),X.updateCopilotState(Ff.QUERY_ENTERED),X.sendEventToClient(Uf.QuerySubmitted),Cv.Instance.NewChatInitiated(),Ln(!0),(null==be?void 0:be.voiceInputProps)&&Do(!1),s=t?t.trim():Po().trim(),fO=s,l=function(){var e,t,n=null!==(t=null===(e=rt.current)||void 0===e?void 0:e.getImages())&&void 0!==t?t:[];return Object(o.__spreadArray)([],Object(o.__read)(n),!1)}(),function(e){var t;null===(t=rt.current)||void 0===t||t.setGhostText(e)}(null!==(g=null==be?void 0:be.chatPlaceholderMessage)&&void 0!==g?g:xm),function(){var e;null===(e=rt.current)||void 0===e||e.removeImages()}(),gn&&hn(!1),wb("User query Entered : ".concat(s)),function(e){var t;null===(t=rt.current)||void 0===t||t.setInputText(e)}(Cm),J===r.IOS&&nt(Xm.Shy),Xt(!1),dn(!1),Ct(!0),l.length>0&&Io(c.ContentCard,{contentCardProps:{user:Wm.Chat,cardContent:{contentBody:ce.createElement(ce.Fragment,null,l.map((function(e,t){return ce.createElement("img",{src:e,key:t,alt:"Visual content of chat prompt",width:"50px"})})))}}}),Io(c.MarkdownCard,{markDownCardProps:Db(s,n)}),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.QuerySubmittedByUser},{key:hf.IsMicrophoneInvolvedInQueryInput,value:xb.toString()}]),Ib(!1),[4,X.shouldSendRequestToAugloop(s,n,a,hO)]):[2];case 1:return f.sent()?s!==jm()||(null===(h=le.changeTopicUiProps)||void 0===h?void 0:h.hideChangeTopicButton)?[3,3]:(gO=!0,Wt((function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loadingUiStringList:[ly()[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})})),[4,$v(yf.c.AddChatOperation)]):(Ct(!1),[2]);case 2:return f.sent(),[2];case 3:return f.trys.push([3,7,,8]),pt?[3,5]:[4,Jo()];case 4:f.sent(),f.label=5;case 5:return u=X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)?ci.getEnabledPlugins():[],[4,X.getDefaultSignalOperation(s,hO,Kv,n,a,u,l)];case 6:return d=f.sent(),Eb.getInstance().setAugloopResponseTimer(d.workflowAnnotationType),Gb.getInstance().submitOperation(d.operation,d.workflowAnnotationType),X.updateCopilotState(Ff.QUERY_SUBMITTED),wb("successfully submitted operation to AL : \n\n\n"+JSON.stringify(d.operation)+"\nat Time : "+new Date+"\n\n\n"),[3,8];case 7:return p=f.sent(),wb("CopilotChat Log: Exception:"+JSON.stringify(p)+" Error message: "+p.message),Cv.Instance.ErrorMessage="Exception_Query_Submission_Failed",X.updateCopilotState(Ff.QUERY_SUBMITTED_FAILED),Eb.getInstance().clearAugloopResponseTimer(),Io(c.Default,{defaultMessageProps:{user:Wm.Chat,messageHeader:{text:"".concat("I'm still learning and can't do this just yet. Is there something else I can do to help")},embeddedLists:[]}}),X.updateCopilotState(Ff.IDLE),Pe.sendTelemetryErrorData([{key:ff.ErrorMessage,value:"Error in handle submit: "+p.message},{key:ff.ErrorType,value:kf.Client},{key:ff.ErrorCode,value:Jm.HandleSubmitError},{key:ff.ErrorCategory,value:pf.ChatEvents}]),Pe.sendTelemetryLatencyData([{key:gf.UserPerceivedLatency,value:CO(pO)},{key:gf.IsQuerySuccess,value:!1}],!0),Ct(!1),[3,8];case 8:return[2]}}))}))},Ro=Object(ce.useRef)(new fy(Ct,Wt,Bo,ot,rt,ho,Dt,Oo?Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm:null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage,St)),Fo=Object(ce.useRef)(function(e,t,n){if(void 0===n&&(n=!1),vb)return vb;var r=[],o={origin:window.location.origin,columnSize:6,title:dm()?OfficeaicopilotStrings.CopilotPromptLibraryHeader:"Prompts from Copilot Lab",copilotLabButtonText:dm()?OfficeaicopilotStrings.CopilotLabLaunchertext:"See all prompts in Copilot Lab",copilotLabLink:"https://copilot.cloud.microsoft/prompts",prompts:[],bookmarks:[],facets:{displayCategory:[]},selectedFacets:{},width:55,height:55,isDarkMode:n,locale:sv.getLanguage(),isHeaderDisabled:!1,onDialogLaunched:function(){wb("dialog launched!"),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabDialogLaunched}])},onPromptClicked:function(t){wb("prompt clicked",t),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabPromptItemClicked},{key:hf.ChatEventParameters,value:"".concat(t.DisplayCategory)}]),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabDialogClosed}]),gb(t.PromptId),e.current.setInputAreaText(t.CommandText)},onFavoriteToggled:function(e,t){wb("favorited toggle favorited: ".concat(t,", prompt: "),e),Gb.getInstance().submitOperation(ab(rb.b.UserActivity,e.PromptId,t),lv.a.getTypeName());var n=o.prompts.map((function(n){var r=n;return e.Id===n.Id&&((r=e).UserActivity.Favorite.IsFavorite=t),r}));o.prompts=n,om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabSavedPromptClicked},{key:hf.ChatEventParameters,value:t?$m.Favourite:$m.Unfavourite}]),r.forEach((function(e){return e({prompts:n})}))},onDialogDismissed:function(){wb("dialog dismissed"),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabDialogClosed}]),t.current.setMenuButtonFocus()},onFilterChanged:function(e){wb("filters changed",e)},onShowOnlyFavoriteToggled:function(e){wb("show only favorited toggled ".concat(e))},onGoToCopilotLabClicked:function(){wb("on go to copilot lab clicked"),om.getInstance().sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CopilotLabGoToCopilotLabButtonClicked}])}};return vb={register:function(e){return r.push(e),o},unregister:function(){},updateColumnSize:function(e){o.columnSize=e,r.forEach((function(t){return t({columnSize:e})}))},updateTitle:function(e){o.title=e,r.forEach((function(t){return t({title:e})}))},updateCopilotLabButtonText:function(e){o.copilotLabButtonText=e,r.forEach((function(t){return t({copilotLabButtonText:e})}))},updateCopilotLabLink:function(e){o.copilotLabLink=e,r.forEach((function(t){return t({copilotLabLink:e})}))},updatePrompts:function(e){o.prompts=e,r.forEach((function(t){return t({prompts:e})}))},updateBookmarks:function(e){o.bookmarks=e,r.forEach((function(t){return t({bookmarks:e})}))},updateFacets:function(e){o.facets=e,r.forEach((function(t){return t({facets:e})}))},updateSelectedFacets:function(e){o.selectedFacets=e,r.forEach((function(t){return t({selectedFacets:e})}))},updateDarkMode:function(e){o.isDarkMode=e,r.forEach((function(t){return t({isDarkMode:e})}))},updateLocale:function(e){o.locale=e,r.forEach((function(t){return t({locale:e})}))},updateIsHeaderDisabled:function(e){o.isHeaderDisabled=e,r.forEach((function(t){return t({isHeaderDisabled:e})}))}}}(Ro,rt,ne.isDarkModeEnabled)),No=function(e){Kt(lo.getProps(e)),Xt(lo.shouldShowHintCard(e))},Ho=function(){Wo()?$e([]):X.sendEventToClient(Uf.ChatTopicChanged),gO=!1,Ct(!1)},Uo=function(){gb(Cm),wb("Change Topic Button Clicked."),Xr.current.setSuggestedQnAList([]),Bo({text:jm()})},Vo=ce.useCallback((function(e,t){t?(Br(!0),Nr([])):e.length>0?Nr((function(t){return Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t),!1),Object(o.__read)(e),!1)})):Yr(!0),Dr(!1),Qr(!1)}),[]),zo=ce.useCallback((function(e){e&&$e((function(t){return e(t)})),Ct(!1),Zr.current=!1}),[]),Go=ce.useCallback((function(){zr(!1),Jr.current=!0}),[]),Wo=ce.useCallback((function(){var e;return null===(e=le.chatHistoryUiProps)||void 0===e?void 0:e.enableChatHistoryV2}),[le]),Qo=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return ye&&(X.isFeatureGateEnabledFromClient(Km.IsPersistanceInPhase2UxEnabled)&&(null==ye?void 0:ye.pluginsInfo)&&(null===(r=null==ye?void 0:ye.pluginsInfo)||void 0===r?void 0:r.length)>0||X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled))?(e=function(e){var t,n,r;X.sendEventToClient(Uf.PluginsStateUpdated,e);var o,i,a,s=!1,l=e.pluginsInfo.findIndex((function(e){return e&&e.id===tv.ENTERPRISE_SEARCH&&e.state===av}))>=0;X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)?s=e.pluginsInfo.findIndex((function(e){return e&&e.id===tv.WEB_SEARCH&&e.state===av&&e.isEnabled}))>=0:(l=null!==(n=(null===(t=null==ye?void 0:ye.pluginsInfo.find((function(e){return e.id===Vd.Work})))||void 0===t?void 0:t.state)===Zd.Enabled)&&void 0!==n?n:l,s=(null===(r=null==ye?void 0:ye.pluginsInfo.find((function(e){return e.id===Vd.Web})))||void 0===r?void 0:r.state)===Zd.Enabled),o=l,i=s,a=Vd.CurrentContext.toString(),o&&(a+="+Work"),i&&(a+="+Web"),xv=a},t=(new Date).getTime(),[4,jC(null==ye?void 0:ye.pluginsInfo,ci,e,X.isFeatureGateEnabledFromClient(Km.IsWebSearchDefaultOn),X.isFeatureGateEnabledFromClient(Km.IsEnterpriseSearchDefaultOn))]):[2];case 1:return n=o.sent(),Pe.sendTelemetryLatencyData([{key:gf.PluginsConfig3SFetchTime,value:CO(t)}]),wb("resolved plugins initial state using copilot brokering WF annotations"),Vt("OnWithAllowList"===ci.getRestrictedSearchMode()||X.isFeatureGateEnabledFromClient(Km.ShowRestrictiveSearchBanner)),ar(n),yo=0,[2]}}))}))},qo=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,r,i;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return t=(new Date).getTime(),dO=t,Bn?[3,2]:[4,X.getALSession()];case 1:return r=a.sent(),ft(r),[3,5];case 2:return[4,(s=X.getAuthToken(),l=!1,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.e(2).then(n.bind(null,504))];case 1:return e=r.sent(),l||(t={serviceUrl:sv.getAugloopUrl(),appName:sv.getAppName(),appVersion:sv.getAppVersion(),authToken:s,releaseAudienceGroup:null,releaseChannel:null,releaseFork:null,flights:sv.getAugloopFlights()},e.StartInitializingRuntimeManage(t)),[4,e.EnsureAugloopRuntimeManager()];case 2:return[2,r.sent()]}}))})))];case 3:return[4,a.sent().getSession()];case 4:r=a.sent(),ft(r),a.label=5;case 5:Gb.getInstance(ot,X,r,Ct,Cn),Eb.getInstance(X,jo),Cb.getInstance(ot,X,Ct),Cb.getInstance().setBasicChatProps(ge),Pe.sendTelemetryLatencyData([{key:gf.AugloopInitializationTime,value:CO(t)}]),je.sendLoggingEventToClient(Vf.ALSessionInitialized,{timeInMs:OO(t)}),a.label=6;case 6:return a.trys.push([6,10,,11]),[4,Jo(e)];case 7:return a.sent(),mo?[3,9]:[4,ri(r)];case 8:a.sent(),a.label=9;case 9:return wb("Augloop Initialized. Time Taken : ".concat(CO()," sec")),[3,11];case 10:throw i=a.sent(),wb("Failure in Augloop Initialization: "+JSON.stringify(i)+" Error message: "+i.message),Pe.sendTelemetryErrorData([{key:ff.ErrorMessage,value:"Failure in Augloop Initialization: "+i.message},{key:ff.ErrorType,value:kf.Client},{key:ff.ErrorCode,value:Jm.AugloopInitializationError},{key:ff.ErrorCategory,value:pf.Augloop}]),i;case 11:return Qo(),[2]}var s,l}))}))};function Ko(e,t){var n;return void 0===t&&(t=Cm),Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,s,l,c,u,d;return Object(o.__generator)(this,(function(p){switch(p.label){case 0:wb("sharedAugloopAnnotationHandler op: ",e),wb("sharedAugloopAnnotationHandler cv: ",t),p.label=1;case 1:p.trys.push([1,22,23,24]),r=Object(o.__values)(e.items),i=r.next(),p.label=2;case 2:if(i.done)return[3,21];switch(a=i.value,Cv.Instance.Observe(a.body),(null==(s=null===(n=a.body)||void 0===n?void 0:n.H_)?void 0:s.T_)&&Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALAnnotationReceived},{key:hf.ChatEventParameters,value:null==s?void 0:s.T_},{key:hf.Cv,value:t},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}]),null==s?void 0:s.T_){case Cf.a.getTypeName():case Cf.c.getTypeName():case Cf.b.getTypeName():return[3,3];case Sf.b.getTypeName():return[3,4];case Sf.a.getTypeName():return[3,7];case Sf.c.getTypeName():return[3,10];case lv.a.getTypeName():return[3,13];case Ef.a.getTypeName():return[3,15];case Of.a.getTypeName():return[3,17];case mv.a.getTypeName():return[3,18]}return[3,20];case 3:return eb(a,$e,mt.current,X,gO?Ho:void 0,(function(e){return li.onChatHistoryPluginInfo(e)}),Vo,Zr.current?zo:void 0,Wo(),t),[3,20];case 4:return[4,X.shouldIgnoreResponse(a)];case 5:return p.sent()?[2]:[4,Iy(a,ot,Ct,pO,t)];case 6:return p.sent(),[3,20];case 7:return[4,X.shouldIgnoreResponse(a)];case 8:return p.sent()?[2]:[4,xy(a,ot,Ct,pO,t)];case 9:return p.sent(),[3,20];case 10:return[4,X.shouldIgnoreResponse(a)];case 11:return p.sent()?[2]:[4,Ty(a,Xr.current,t)];case 12:return p.sent(),[3,20];case 13:return[4,sb(a,Bt,t)];case 14:return p.sent(),[3,20];case 15:return[4,Py(a,ko,t)];case 16:return p.sent(),[3,20];case 17:return l=a.body,si.onOperationResponse(l.queryId,l.operationResponse),[3,20];case 18:return[4,AC()];case 19:return p.sent(),[3,20];case 20:return i=r.next(),[3,2];case 21:return[3,24];case 22:return c=p.sent(),u={error:c},[3,24];case 23:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 24:return[2]}}))}))}function Yo(e,t){var n;return void 0===t&&(t=Cm),Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,s,l,c,u;return Object(o.__generator)(this,(function(d){switch(d.label){case 0:wb("clientSpecificAugloopAnnotationHandler op: ",e),wb("clientSpecificAugloopAnnotationHandler cv: ",t),d.label=1;case 1:d.trys.push([1,7,8,9]),r=Object(o.__values)(e.items),i=r.next(),d.label=2;case 2:return i.done?[3,6]:(a=i.value,(null==(s=null===(n=a.body)||void 0===n?void 0:n.H_)?void 0:s.T_)&&Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.ALAnnotationReceived},{key:hf.ChatEventParameters,value:null==s?void 0:s.T_},{key:hf.Cv,value:t},{key:hf.ALSessionKey,value:Sb.getInstance().getAlSessionKey()}]),dv.getInstance().isWorkflowRegistered(null==s?void 0:s.T_)?dv.getInstance().isAugloopResponseTimeoutRequired(null==s?void 0:s.T_)?[4,X.shouldIgnoreResponse(a)]:[3,4]:[3,5]);case 3:if(d.sent())return[2];Eb.getInstance().clearAugloopResponseTimer(),d.label=4;case 4:Cv.Instance.Observe(a.body),X.sendResponseToClient(a,t),d.label=5;case 5:return i=r.next(),[3,2];case 6:return[3,9];case 7:return l=d.sent(),c={error:l},[3,9];case 8:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(c)throw c.error}return[7];case 9:return[2]}}))}))}var Zo,Jo=function(e){return void 0===e&&(e=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=(new Date).getTime(),dO=t,n=[],[4,null===(s=null===(a=X.getHostSettings())||void 0===a?void 0:a.getDocumentUrlAsync)||void 0===s?void 0:s.call(a)];case 1:return r=o.sent(),dv.getInstance().getWorkflowDataMap(e).forEach((function(e){wb("send activate annotation request for workflow: ",e.workflowInfo.workflowAnnotationType),n.push(Gb.getInstance().activateAnnotation(e.workflowInfo.workflowAnnotationType,e.workflowInfo.shouldHandleResponse?Ko:Yo,e.workflowInfo.config,r,e.workflowInfo.forceReturnCachedAnnotations))})),[4,Promise.all(n)];case 2:return o.sent(),Pe.sendTelemetryLatencyData([{key:gf.AnnotationActivationTime,value:CO(t)}]),je.sendLoggingEventToClient(Vf.AnnotationActivated,{timeInMs:OO(t)}),wb("AnnotationActivationTime. Time Taken :  ".concat(CO()," sec")),dt(!0),[3,4];case 3:throw i=o.sent(),dt(!1),wb("Failed to activate annotations: ".concat(i.message)),Pe.sendTelemetryErrorData([{key:ff.ErrorMessage,value:"Failure in Activating Annotation: "+i.message},{key:ff.ErrorType,value:kf.Server},{key:ff.ErrorCode,value:Jm.ActivateAnnotationError},{key:ff.ErrorCategory,value:pf.Augloop}]),i;case 4:return[2]}}))}))},Xo=function(){return X.getPythonMode()&&!yt},$o=function(){var e;return Re&&Xe.length>0&&!(null===(e=le.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Wo()},ei=function(e){var t,n,r,o,i,a;if(!(!Pn.current||yt||null!=rt.current&&(null===(t=rt.current)||void 0===t?void 0:t.getInputText().length)>=(le.chatInputProps?bm:ym))){Ib(!0);var s=(null===(n=rt.current)||void 0===n?void 0:n.getInputText().length)>0&&xo?" ":Cm,l=null!=rt.current?(null===(r=rt.current)||void 0===r?void 0:r.getInputText())+s+e:Cm;null===(o=rt.current)||void 0===o||o.setInputText(l),null===(i=rt.current)||void 0===i||i.setGhostText(Cm),null===(a=rt.current)||void 0===a||a.setFocus(),wb("final text passing here: "+e)}},ti=function(e){var t,n,r;if(!(!Pn.current||yt||null!=rt.current&&(null===(t=rt.current)||void 0===t?void 0:t.getInputText().length)>=(le.chatInputProps?bm:ym))){var o=(null===(n=rt.current)||void 0===n?void 0:n.getInputText().length)>0&&xo?" ":Cm;null===(r=rt.current)||void 0===r||r.setGhostText(o+e),wb("ghost text passing here: "+e),Ib(!0),e.trim()&&Object(ep.e)(Tm,Do),wb("Voice response - Partial Text: "+e)}},ni=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){nt(Xm.Expanded),e()}))];case 1:return e.sent(),[2]}}))}))},ri=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return(null==be?void 0:be.voiceInputProps)?(t=(new Date).getTime(),n=Object(tp.a)(be.voiceInputProps.voiceInputLocale),[4,Object(ep.a)(n,ei,ti,En,Do,e)]):[3,2];case 1:r.sent(),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophoneInitializationTimeInMs},{key:hf.ChatEventParameters,value:OO(t).toString()}]),xo=Object(tp.b)(Object(tp.a)(n)),Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.MicrophoneSuccessfullyInitialized}]),r.label=2;case 2:return[2]}}))}))},oi=function(e){X.isFeatureGateEnabledFromClient(Km.IsClpSensitivityInChatInputEnabled)&&"File"===(null==e?void 0:e.type)&&($n(!0),wt(!0),function(e){Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(o.__generator)(this,(function(o){return t=om.getInstance(),n=new jy.a({type:e.type,id:e.url}),r=new bv.b({parentPath:["Signal",jy.a.getTypeName()],items:[{id:yv.a.generateId(),body:n}]}),wb("Submitting signal to Augloop : ".concat(jy.a.getTypeName()," signal: ").concat(JSON.stringify(n))),t.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.EntityLabelOperationSubmitted},{key:hf.ChatEventParameters,value:"".concat(jy.a.getTypeName(),"_").concat(r)}]),Gb.getInstance().submitOperation(r,jy.a.getTypeName()),[2]}))}))}(e))},ii=new Ey(kn,In,Sn,null===(_=null==be?void 0:be.voiceInputProps)||void 0===_?void 0:_.microphonePermissionErrorTitle,null===(D=null==be?void 0:be.voiceInputProps)||void 0===D?void 0:D.microphonePermissionErrorMessage,wn,En,Do,rt,null!==(L=null==be?void 0:be.chatPlaceholderMessage)&&void 0!==L?L:xm,null===(M=null==be?void 0:be.voiceInputProps)||void 0===M?void 0:M.microphonePermissionImagePath,null===(B=null==be?void 0:be.voiceInputProps)||void 0===B?void 0:B.showMicrophonePermissionHelpLink,Mo),ai=function(e){var t=e.isWebSearchDefaultOn,n=e.logGroundingSourceEvent,r=ue.a.useMemo((function(){return new eO}),[]),o=ue.a.useMemo((function(){return new nO}),[]),i=ue.a.useMemo((function(){return new rO(r,o,{isWebSearchDefaultOn:t,logGroundingSourceEvent:n})}),[r,o]);return{pluginConfigService:r,chatHistoryEnabledPluginsSource:o,pluginDataProvider:i}}({isWebSearchDefaultOn:X.isFeatureGateEnabledFromClient(Km.IsWebSearchDefaultOn),logGroundingSourceEvent:!(null===(R=null==ye?void 0:ye.pluginsInfo)||void 0===R?void 0:R.length)}),si=ai.pluginConfigService,li=ai.chatHistoryEnabledPluginsSource,ci=ai.pluginDataProvider,ui=void 0,di=void 0;if(X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)){var pi=ce.useMemo((function(){return new kC(we)}),[we]),gi=ce.useMemo((function(){return new bC(we)}),[we]),hi=ce.useMemo((function(){return new Wy(gi.getUserContext(),gi.getHostContext(),pi)}),[gi,pi]),fi=ce.useMemo((function(){return new OC(si)}),[si]),mi=ce.useMemo((function(){return new IC(si)}),[si]),vi=ce.useMemo((function(){return new vC(hi,fi,mi)}),[hi,fi,mi]);di={cardServices:{appService:fi,channelService:mi,tokenService:pi},activityProvider:vi};ui=new cC(ci,vi,(function(e,t){var n;t&&(null==me?void 0:me.showSystemMessageOnPluginEnabled)&&"FirstParty"!==e.type&&ot.setChatMessageData(c.Default,{defaultMessageProps:{user:Wm.Chat,messageHeader:{text:(n=e.name,"Great! ".concat(n," has been successfully added and is ready to improve your Copilot experience."))}}})}),(function(){}),void 0,fi)}var bi=void 0;X.isFeatureGateEnabledFromClient(Km.EnableMsgExtCardTelemetry)&&(bi=new cO);var yi=ce.useMemo((function(){var e,t,n;return{appService:null===(e=null==di?void 0:di.cardServices)||void 0===e?void 0:e.appService,tokenService:null===(t=null==di?void 0:di.cardServices)||void 0===t?void 0:t.tokenService,channelService:null===(n=null==di?void 0:di.cardServices)||void 0===n?void 0:n.channelService,clientInfo:we,taskModuleLauncher:Te,telemetryService:bi}}),[we]);Zo=ce.useMemo((function(){return new se(yi)}),[yi]);var Ci=(null==ye?void 0:ye.groundingSourcePickerProps)?Object(o.__assign)(Object(o.__assign)({},null==ye?void 0:ye.groundingSourcePickerProps),{onSelection:function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return function(e){xv=e}(t.id.toString()),null===(n=null==e?void 0:e.onSelection)||void 0===n||n.call(e,t),fr?[4,$v(yf.c.AddChatOperation)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}}(null==ye?void 0:ye.groundingSourcePickerProps)}):void 0,Oi=(null==ye?void 0:ye.pluginsInfo)&&(null==ye?void 0:ye.pluginsInfo.length)>0||X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)?{plugins:null==ye?void 0:ye.pluginsInfo,pluginBlockedInfo:ir,onGroundingButtonClick:function(){yo=void 0===ir&&-1===yo?window.setTimeout((function(){void 0===ir&&(wb("Failed to timely resolve plugins initial state after ".concat(4e3,"ms of Grounding button click.")),ar([])),yo=0}),4e3):0},copilotPluginFlyoutProps:X.isFeatureGateEnabledFromClient(Km.IsCopilotPluginEnabled)?{pluginProvider:ui,isPreview:!0}:void 0}:void 0,Si=le.chatInputProps?new ny(rt,St,gn,hn,le.menuProps,Bo,No,ho(),ni,Oo&&Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm,Oo?Oo.ciqPlaceholderText?Oo.ciqPlaceholderText:rv():Cm,qn,wo(),X,null==be?void 0:be.chatPlaceholderMessage,(null==be?void 0:be.voiceInputProps)?ii.getMicrophoneButtonProps():void 0):new oy(rt,Lb(rn),(sn||rn).isDarkModeEnabled,null!==(F=(sn||rn).dir)&&void 0!==F?F:void 0,St,It,gn,hn,X,null==ye?void 0:ye.menuProps,Bo,No,ho(),Oo?Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm:(null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage)?null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage:Cm,Oo?Oo.ciqPlaceholderText?Oo.ciqPlaceholderText:rv():Cm,qn,wo(),null==ye?void 0:ye.chatPlaceholderMessage,(null==ye?void 0:ye.voiceInputProps)?Object(o.__assign)(Object(o.__assign)({},null==ye?void 0:ye.voiceInputProps),{alSession:ht,microphoneButtonProps:ii.getMicrophoneButtonProps()}):void 0,null===(N=null==ye?void 0:ye.buttonProps)||void 0===N?void 0:N.ciqButtonEnabled,null===(H=null==ye?void 0:ye.buttonProps)||void 0===H?void 0:H.groundingButtonEnabled,Ci,Oi,Mo,ke?{editorConfig:Oo,alSession:ht,handleInChatInput:ke,postCIQItemSelectionHandler:oi}:void 0,Xn,null==ye?void 0:ye.isVersion3Enabled,null==ye?void 0:ye.characterLimitErrorMessage,null==ye?void 0:ye.imageInputEnabled,Ce,Oe,Se,xe,Ee);J===r.IOS&&(Eo=new iy(rt,St,gn,hn,le.menuProps,Bo,No,Nn,ni,Oo&&Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm,X,null!==(V=null!==(U=null==be?void 0:be.chatRestShyPlaceholderMessage)&&void 0!==U?U:null==ye?void 0:ye.chatRestShyPlaceholderMessage)&&void 0!==V?V:"Ask a question"));var Ei=function(){var e;J===r.IOS&&(null===(e=rt.current)||void 0===e?void 0:e.getInputText())===Cm&&nt(Xm.Shy)};function xi(){if(J!==r.IOS)if(_e)1==window.devicePixelRatio&&De(!1);else{var e=document.getElementById(ov);if(e)e.getBoundingClientRect().height<=0&&De(!0)}}Object(ce.useEffect)((function(){var e;null===(e=To())||void 0===e||e.setLoading(Xn)}),[Xn]),Object(ce.useEffect)((function(){if(J!==r.IOS)return xi(),window.addEventListener("resize",xi),function(){window.removeEventListener("resize",xi)}})),Object(ce.useEffect)((function(){if(ke||!Nn||!Vn||Qn||Jr.current||(Nn.uninitialize(Fu),zn(void 0)),ho()&&(Ro.current=new fy(Ct,Wt,Bo,ot,rt,ho,Dt,Oo?Oo.ciqPlaceholderText?Oo.ciqPlaceholderText:rv():null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage,St)),!ke&&Oo&&Qn&&!Vn&&Nn&&rt.current&&!Jr.current){var e=Nn.initializeCiq(rt.current.getInputSpanElement(),{menuTitle:Oo.transformFileMenuTitle,menuSubtitle:Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm,queryCharToUse:Fu,onItemSelected:function(t){var n,r,o,i,a,s,l,c,u,d;if(Pe.sendTelemetryChatEventData([{key:hf.ChatEventType,value:mf.CIQSuggestionSelected},{key:hf.ChatEventParameters,value:null!==(o=null===(r=null===(n=t.suggestion)||void 0===n?void 0:n.queryAnnotation)||void 0===r?void 0:r.QueryAnnotationType)&&void 0!==o?o:Cm}]),xr.current)return null===(i=Ir.current)||void 0===i||i.addUserContentMessageItem((u=t.suggestion,d=iv,(null==u?void 0:u.url)&&((null==u?void 0:u.url.includes("docx"))?d=iv:(null==u?void 0:u.url.includes("pptx"))?d="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg":(null==u?void 0:u.url.includes("xlsx"))&&(d="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg")),{iconUrl:d,boldText:null==u?void 0:u.text}),!0),xr.current=!1,void(null===(a=rt.current)||void 0===a||a.setGhostText(null!==(s=null==be?void 0:be.chatPlaceholderMessage)&&void 0!==s?s:xm));null===(l=rt.current)||void 0===l||l.setGhostText(Cm),null===(c=rt.current)||void 0===c||c.setFocus(),e.renderAndTrackSelectedSuggestion(t,null,Xn,Lb(rn),(sn||rn).isDarkModeEnabled,An),oi(t.suggestion)},entitiesEnabled:Oo.entitiesSupported,ExpanededECC:Oo.isExpandedECCEnabled});e.setHVCAppChatV2Enabled(Ce),zn(e)}Jr.current=!1}),[Nn,Vn,Qn]);var Ii=function(){var e,t;return null!==(t=null===(e=fv.getInstance())||void 0===e?void 0:e.getLogs())&&void 0!==t?t:""},wi=new gy(rt,Bo,No,St,ho(),Oo?Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm:(null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage)?null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage:Cm,ni,Ce,Se),Ti=new PC(rt,Bo,St,ho(),Oo?Oo.transformFilePlaceholderText?Oo.transformFilePlaceholderText:Cm:(null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage)?null==ye?void 0:ye.transfromFileNonCIQPlaceholderMessage:Cm,ni,Ce,Se),ki=function(){return X.isFeatureGateEnabledFromClient(Km.ChatInputEarlyLoadEnabled)&&(kt||!ut)},ji=function(){return Lo()?dm()?OfficeaicopilotStrings.InActiveChatSessionErrorString:"This chat session has ended. Please close and reopen this app for a new session.":dm()?OfficeaicopilotStrings.PaneLoadingUIString:"Please wait for the pane to finish loading"},Pi=function(){return ki()&&mn||Lo()&&!yt?{chatInputBannerString:ji()}:void 0},Ai=function(){return!yt&&le.showSuggestionButtonProps};return X.isFeatureGateEnabledFromClient(Km.ChatInputEarlyLoadEnabled)||!kt&&ut?me&&me.showCopilotSwitcherMenu&&Be&&Me&&Le&&Me!==Le?ce.createElement(Dy,{theme:oe?sn:rn,shouldUseFluentV9Tokens:qe,dir:oe?sn.dir:rn.dir},ce.createElement(he,{style:_e?Ye.chatUiStackZoom:Ye.chatUiStack},ce.createElement(ze,{isMenuOpen:Ve,onMenuStateChange:Qe,handleCopilotChatChange:me.handleCopilotChatChange,copilotList:me.copilotList,showNewChatButtonOnTop:$o(),isExecuting:yt,handleChangeTopicButtonClick:Uo}),ce.createElement(Ge,{componentToRender:Ne}))):Wo()&&Vr?ce.createElement(Dy,{theme:oe?sn:rn,shouldUseFluentV9Tokens:qe,dir:oe?sn.dir:rn.dir},ce.createElement(he,{style:_e?Ye.chatUiStackZoom:Ye.chatUiStack},ce.createElement(JC,{setChatLog:$e,currentChatId:Kv,setIsExecuting:Ct,setLoadingComponentProps:Wt,suggestionPillsBuilderRef:Xr,createAndSubmitChatHistorySignal:$v,resetToNewConversation:tb,setChatHistoryMenuData:Nr,handleChatHistoryPanelClose:Go,isSwitchingConversation:Zr,isChatHistoryMenuLoading:_r,chatHistoryMenuData:Fr,isChatHistoryPanelFetchingMoreChats:Wr,setIsChatHistoryPanelFetchingMoreChats:Qr,isEndOfChatHistory:Kr,isChatHistoryMenuLoadingFailed:Mr}))):ce.createElement(Dy,{theme:oe?sn:rn,shouldUseFluentV9Tokens:qe,dir:oe?sn.dir:rn.dir},ce.createElement(he,{style:_e?Ye.chatUiStackZoom:Ye.chatUiStack},me&&me.showCopilotSwitcherMenu&&Be&&ce.createElement(ze,{isMenuOpen:Ve,onMenuStateChange:Qe,handleCopilotChatChange:me.handleCopilotChatChange,copilotList:me.copilotList,showNewChatButtonOnTop:$o(),isExecuting:yt,handleChangeTopicButtonClick:Uo}),ki()&&ce.createElement(Ry,{className:_e?Ye.chatFreStackZoom:Ye.chatFreStack}),oo&&le.toggleUiProps&&ce.createElement(Ke,Object(o.__assign)({},io.getTryReviewerAgentProps(le.toggleUiProps,!1,"Reviewer"))),ro&&ce.createElement(Ke,Object(o.__assign)({},io.getTryWebChatProps(Ft,(function(e,t){var n=null==t?void 0:t.checked;wb("Toggling Try Web chat to "+(n?"on":"off")),Nt(null!=n&&n)}),"Try Web Chat"))),Ft&&ce.createElement("iframe",{src:null!==(G=null===(z=null==le?void 0:le.toggleUiProps)||void 0===z?void 0:z.webSearchUrl)&&void 0!==G?G:"https://edgeservices.bing.com/edgesvc/chat?udsframed=1&form=SHORUN&clientscopes=chat,noheader,udsedgeshop,channelcanary,ntpquery,devtoolsapi,udsinwin11,clipboardcontext,udsdlpconsent,udscstart,cspgrd&lightschemeovr=1",title:"Web Chat",height:"100%",allow:"clipboard-write;microphone;camera"}),!Ft&&ce.createElement(ce.Fragment,null,!kt&&ut&&ce.createElement(ce.Fragment,null,to&&le.toggleUiProps&&ce.createElement(Ke,Object(o.__assign)({},io.getTrySydneyProps(le.toggleUiProps,Dn,"Try Sydney"))),no&&le.toggleUiProps&&ce.createElement(Ke,Object(o.__assign)({},io.getTryEnterpriseSearchProps(le.toggleUiProps,!1,"Enterprise Search Mode"))),sv.isDevbuild()&&(null==fe?void 0:fe.isDebugToggleEnabled)&&!So()&&ce.createElement(jt,Object(o.__assign)({},ao.getDebugSectionProps(Ii,null!==(W=null==fe?void 0:fe.conversationId)&&void 0!==W?W:"",null==fe?void 0:fe.telemetryData))),sv.isDevbuild()&&So()&&ce.createElement(cn,Object(o.__assign)({},so.getDebugSectionProps(Ii,null!==(Q=null==fe?void 0:fe.conversationId)&&void 0!==Q?Q:"",null==fe?void 0:fe.telemetryData,null==fe?void 0:fe.sessionId,null==fe?void 0:fe.conversationLogObject,null==fe?void 0:fe.debugMessageInfoObject,null==fe?void 0:fe.showDebugInfoMessage,null==fe?void 0:fe.setShowDebugInfoOnMessage,br,Or,null==fe?void 0:fe.sydneyConversationObject,null==fe?void 0:fe.augloopKustoQueryURL,null==fe?void 0:fe.clientKustoQueryURL,X.getHostSettings().appName,J,null==fe?void 0:fe.sdxVersion))),ce.createElement(Ru.a,{id:ov,className:_e?Ye.chatFreStackZoom:Ye.chatFreStack,ref:st},fo&&ce.createElement(Wn,Object(o.__assign)({ref:Ir},lr)),X.isFeatureGateEnabledFromClient(Km.EnableRestrictiveSearchBanner)&&Ut&&ce.createElement(er,Object(o.__assign)({},po.getProps((function(){Vt(!1)})))),gn?ce.createElement(ur,Object(o.__assign)({},eo.getProps((function(){hn(!1)}),le.freUiProps))):(null==vo?void 0:vo.promptSuggestionList.length)>0&&(le.zeroQueryMessageProps?ce.createElement(Sr,Object(o.__assign)({},wi.getProps(le.zeroQueryMessageProps))):ce.createElement(kr,Object(o.__assign)({},Ti.getProps(le.zeroQueryMessageV2Props)))),Wo()&&ce.createElement(Ur,{onClick:function(){Zv=null,$v(yf.c.GetAllChatsOperation),Dr(!0),Nr([]),zr(!0),Yr(!1),Qr(!1)}}),ce.createElement("div",{id:"messagesStartID",ref:at}),Xe.length>0&&ce.createElement(Ol,Object(o.__assign)({},ot.getProps(Xe,le.chatContainerUiProps),{designerProps:pe,customMessageRenderers:le.customMessageRenderers,pluginServiceProvider:di,msgExtCardContextProvider:Zo})),Ai()&&ce.createElement(Il,Object(o.__assign)({},go.getProps(le.showSuggestionButtonProps))),function(){var e;return!yt&&Xe.length>0&&!(null===(e=le.changeTopicUiProps)||void 0===e?void 0:e.hideChangeTopicButton)&&!Wo()}()&&!Xo()&&!Ai()&&!Re&&ce.createElement(jl,Object(o.__assign)({},co.getProps(Uo))),Xo()&&ce.createElement(Dl,Object(o.__assign)({},uo.getProps((function(){Ct(!1),X.sendEventToClient(Uf.PythonExitAnalysisButtonClicked),X.updateCopilotState(Ff.IDLE),wb("Python Exit Analysis Button Clicked.")})))),yt&&(null===(q=Gt.shouldShowLoadingUi)||void 0===q||q)&&ce.createElement(Mn,Object(o.__assign)({},$r.getProps(Gt,(function(){Cb.getInstance().getIsBasicChatStreaming()&&(Cb.getInstance().updateCardWithFooter(),Pe.logErrorWithAshaVetoAndError([],Cb.getInstance().getFeatureName(),Cm,Pf.BasicChatUserCancelledResponse,_f.UserAbortedQueryExecution),Cb.getInstance().resetBasicChatStreamingStates(!0,!1)),Cv.Instance.ErrorMessage="Stop_Generation_Clicked",Ct(!1),X.sendEventToClient(Uf.StopGeneratingButtonClicked),Eb.getInstance().clearAugloopResponseTimer(),Gb.getInstance().clearOperationListForResubmit(),X.updateCopilotState(Ff.IDLE),wb("Stop Generation Button Clicked.")})))),ce.createElement("div",{ref:it})),function(){var e,t;return!St&&((null===(t=null===(e=null==le?void 0:le.suggestionPillsUiProps)||void 0===e?void 0:e.suggestionList)||void 0===t?void 0:t.length)>0||Yn.length>0)&&(wb("Suggestion Pills are shown"),!0)}()&&ce.createElement(Vl,Object(o.__assign)({},Xr.current.getProps(le.suggestionPillsUiProps,Yn))),Jt&&ce.createElement($l,Object(o.__assign)({},qt)),J===r.IOS&&tt===Xm.Shy&&!yt&&Eo&&ce.createElement(wc,Object(o.__assign)({},Eo.getProps((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,ni()];case 1:return t.sent(),null===(e=rt.current)||void 0===e||e.setFocus(),[2]}}))}))})))),en&&ce.createElement(Pc,Object(o.__assign)({},Yt))),le.chatInputProps?(J!=r.IOS||tt===Xm.Expanded&&!yt)&&ce.createElement(Bu,Object(o.__assign)({ref:rt},Si.getProps(Ei,Pi()))):ce.createElement(bf,Object(o.__assign)({ref:rt},Si.getProps(Mt,Pi())))))):ce.createElement(de,{theme:rn},ce.createElement("div",null,ce.createElement(Td.a,{appearance:"primary",className:Ye.spinner})))}));vO.displayName="CopilotChat";var bO,yO=function(){uO=null,null,dO=null,pO=null,gO=!1},CO=function(e){return((new Date).getTime()-(null!=e?e:dO))/1e3},OO=function(e){return(new Date).getTime()-(null!=e?e:dO)},SO=function(e){gO=e},EO=n(860);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(bO||(bO={}));var xO,IO=n(532),wO=function(e){var t,n="inapp-feedback-element-id";return e&&(t=document.getElementById(e)),t||(t=document.getElementById(n)),t||((t=document.createElement("div")).id=n,document.body.appendChild(t)),t},TO=function(){function e(){}return e.prototype.isFeatureGateEnabledFromClient=function(e){return console.log("Feature gate: ",e),!1},e.prototype.sendLoggingEventToClient=function(e,t){console.log("sendLoggingEventToClient: ",e),console.log("loggingEventArgs: ",t)},e.prototype.updateCopilotState=function(e){console.log("updateCopilotState: "+e)},e.prototype.feedbackButtonClicked=function(e,t,n,r){var i,a=sv.getFeedbackSettings(),s=Cb.getInstance().getIsFluxFlowEnabled();a&&(null===(i=a.feedbackInitOptions)||void 0===i?void 0:i.appId)&&function(e){var t=e.appData,n=e.featureAreaName,r=void 0===n?"Copilot":n,i=e.inAppFeedbackRef,a=e.specificHvcVersion,s=e.majorVersion,l=e.feedbackInitOptions,c=e.ocvFeedbackHost,u=e.appEnvironment,d=void 0===u?bO.DEV:u,p=e.language,g=void 0===p?"en":p,h=e.feedbackType,f=e.feedbackData,m=e.buttonTarget,v=e.isSydneyEnabled,b=e.createAndSubmitFeedbackDataUploadSignal;Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,n,u,p,y,C,O,S,E,x,I;return Object(o.__generator)(this,(function(w){switch(w.label){case 0:return e=Object(Jo.a)(),(l=Object(o.__assign)(Object(o.__assign)({},l),{authenticationType:null!==(p=null==l?void 0:l.authenticationType)&&void 0!==p?p:IO.a.Unauthenticated,clientFeedbackId:e,clientName:c})).themeOptions||(l.themeOptions={baseTheme:"WindowsLight"}),void 0!==l.isProduction&&null!==l.isProduction||(l.isProduction=d===bO.PRODUCTION),l.telemetry=Object(o.__assign)(Object(o.__assign)({},l.telemetry),{featureArea:r,sourceContext:v?"CopilotChatFeedback":null===(y=l.telemetry)||void 0===y?void 0:y.sourceContext,featureName:null===(C=null==f?void 0:f.contextData)||void 0===C?void 0:C.featureName,subFeatureName:null===(O=null==f?void 0:f.contextData)||void 0===O?void 0:O.subFeatureName}),l.feedbackConfig=Object(o.__assign)(Object(o.__assign)({},l.feedbackConfig),{appData:null!==(E=null===(S=l.feedbackConfig)||void 0===S?void 0:S.appData)&&void 0!==E?E:JSON.stringify(t),calloutTarget:m,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:IO.c.CallOut,initialFeedbackType:h,invocationTimeStamp:Date.now(),isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isScreenRecordingEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:h==IO.b.Smile?IO.d.AIThumbsUp:IO.d.AIThumbsDown},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0}),n=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){return e=new File([null===(t=null==f?void 0:f.contextData)||void 0===t?void 0:t.cardMetaData],"contextData.json",{type:"text/json"}),[2,new Promise((function(t){t([e])}))]}))}))},l.feedbackConfig.diagnosticsConfig=Object(o.__assign)(Object(o.__assign)({},l.feedbackConfig.diagnosticsConfig),{diagnosticsEndPoint:"ODS",diagnosticsUploadId:e,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:null!==(I=null===(x=l.feedbackConfig.diagnosticsConfig)||void 0===x?void 0:x.getContextData)&&void 0!==I?I:n}),b&&(l.feedbackConfig.diagnosticsConfig=Object(o.__assign)(Object(o.__assign)({},l.feedbackConfig.diagnosticsConfig),{extractFeedbackDataForHost:function(e){b(JSON.stringify(e),c)},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0})),u={hostName:"AppChatCopilot",locale:g,inAppFeedbackRef:wO(i),specificHvcVersion:a,majorVersion:s},[4,Object(IO.e)(u)];case 1:return w.sent(),Object(IO.f)(l),[2]}}))}))}(Object(o.__assign)(Object(o.__assign)({},a),{feedbackData:t,ocvFeedbackHost:sv.getAppName(),language:sv.getLanguage(),appEnvironment:sv.getEnvironment(),feedbackType:e==Nf.LIKE?EO.b.Smile:EO.b.Frown,appData:null!=n?n:a.appData,buttonTarget:r,isSydneyEnabled:s,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(Km.EnableSendTenantFeedback)?Ev:void 0})),console.log("feedbackButtonClicked: "+e),console.log("feedbackData: "+t),console.log("telemetryData: "+n)},e.prototype.getALSession=function(){throw new Error("Method not implemented.")},e.prototype.getHostSettings=function(){throw new Error("Method not implemented.")},e.prototype.getAuthToken=function(){throw new Error("Method not implemented.")},e.prototype.getPythonMode=function(){return!1},e.prototype.shouldIgnoreResponse=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,!1]}))}))},e.prototype.shouldSendRequestToAugloop=function(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return wb("shouldSendRequestToAugloop"),[2,!0]}))}))},e.prototype.getFeedbackData=function(){return{}},e.prototype.getOnClickHandler=function(e){return function(){}},e}();!function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(xO||(xO={}));var kO=n(2720),jO=n(2721),PO=n(2719),AO=n(2722),_O=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({color:Be.a.colorNeutralForeground4,alignItems:"flex-start"},pn.a.body1),{fontStyle:"normal"}),Me.a.gap("1px")),{content:"attr(title)"}),DO={color:Be.a.colorNeutralForegroundDisabled,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},LO=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},pn.a.body1),{alignItems:"flex-start",fontStyle:"normal"}),Me.a.gap("1px")),{whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":Object(o.__assign)({},Me.a.outline(0))}),MO={userInput:Object(o.__assign)(Object(o.__assign)({},LO),{"&:focus":Object(o.__assign)({},Me.a.outline(0)),"&:focus::after":_O,"&::after":_O})},BO={userInput:Object(o.__assign)(Object(o.__assign)({},LO),{"&:focus":Object(o.__assign)({},Me.a.outline(0))})},RO={userInput:{"&:focus::after":DO,"&::after":DO}},FO=(Object(pe.a)(BO),Object(pe.a)(MO)),NO=Object(pe.a)(RO),HO=function(e){var t=e.isDisabled,n=void 0===t||t,r=e.placeholderText,i=void 0===r?"":r,a=e.editorProps,s=e.onItemSelected,l=ue.a.useRef(),c=Object(o.__read)(ue.a.useState(void 0),2),u=c[0],d=c[1],p=Object(ce.useRef)(null),g=Object(o.__read)(Object(ce.useState)(void 0),2),h=g[0],f=g[1],m=Object(o.__read)(Object(ce.useState)(i),2),v=m[0],b=m[1];Object(ce.useEffect)((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!l.current&&(null==a?void 0:a.alSession)){var e=(new Wd).createInstance();e.bootstrap((t=a.editorConfig,n=a.alSession,Object(o.__assign)(Object(o.__assign)({},t),{augloopSession:n}))).then((function(t){l.current=e,d(t)}))}var t,n;return function(){l.current&&l.current.shutdown().then((function(){l.current=void 0}))}}),[null==a?void 0:a.alSession]),Object(ce.useEffect)((function(){if((null==a?void 0:a.handleInChatInput)&&(null==a?void 0:a.editorConfig)&&!h&&u&&p.current){var e=u.initializeCiq(p.current,{menuTitle:null==a?void 0:a.editorConfig.transformFileMenuTitle,menuSubtitle:(null==a?void 0:a.editorConfig.transformFilePlaceholderText)?null==a?void 0:a.editorConfig.transformFilePlaceholderText:"",queryCharToUse:Fu,onItemSelected:function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return console.log(e),[4,(r=e.suggestion,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){return console.log(r),r&&(e={displayName:r.text,mail:r.id}),[2,e]}))})))];case 1:return t=n.sent(),s&&s(t),console.log("Item Selected"),a.postCIQItemSelectionHandler&&a.postCIQItemSelectionHandler(e.suggestion),[2]}var r}))}))},entitiesEnabled:null==a?void 0:a.editorConfig.entitiesSupported,ExpanededECC:null==a?void 0:a.editorConfig.isExpandedECCEnabled});f(e)}}),[u,h]);var y=Object(ce.useRef)(NO()),C=Object(ce.useRef)(FO()),O=Object(o.__read)(Object(ce.useState)(C.current.userInput),2),S=O[0],E=O[1];Object(ce.useEffect)((function(){n&&E(Object(x.a)(C.current.userInput,y.current.userInput))}),[n]);return ue.a.createElement("span",{className:S,title:v,ref:p,contentEditable:!0,onInput:function(e){""===e.target.textContent?b(i):e.target.textContent.length>0&&""!==v&&b("")}})};const UO=(e,t)=>{const n={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"Copilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,resultTime:1e4},telemLogger:{logError:e=>{console.log("Shared Copilot CIQ Error Log: ",e)}},entitiesSupported:[Mf.People],isExpandedECCEnabled:!1};return ue.a.createElement(HO,{editorProps:{editorConfig:n,alSession:e,handleInChatInput:!0},placeholderText:"Type to add more",onItemSelected:t})};var VO=n(896);const zO="Done! Your review has been started. Feel free to ask me for a status update at any time.",GO="Check review status",WO="Close this review",QO="Edit review details",qO=new Map([[xO.EntryPointCard,"ReviewAgentEntryPointCard"],[xO.ConfirmInvitationCard,"ReviewAgentConfirmInvitationCard"],[xO.ReviewStatusCard,"ReviewAgentReviewStatusCard"],[xO.SuggestionCard,"ReviewAgentSuggestionsCard"]]),KO=["Fetching latest comments...","Updating respondent counts...","Drafting feedback summary...."],YO=["Checking for reviews in progress...","Understanding your document...","Preparing your agent..."],ZO=["Fetching latest comments...","Analyzing feedback...","Generating suggestions..."],JO="https://microsoft-my.sharepoint-df.com/:w:/p/suprasad/EWDsu6HpR21GhOJWiUuwQi0B-xXMvVhcShUeEPlcap3O1w?e=la5tmO",XO="EditReviewDetails",$O="Retry",eS=["None","1 day before","3 days before"];class tS{static generateId(){return tS.operationId++,"AugLoopChatAgent-Reviewer"+tS.operationId.toString()}}var nS,rS;tS.operationId=0,function(e){e.Primary="Primary",e.Default="Default"}(nS||(nS={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(rS||(rS={}));const oS=()=>({query:"create agent",queryId:Object(xf.a)(),createAgent:{templateName:"ReviewSync",mode:PO.a.CREATE}}),iS=e=>({query:"Show Suggestion",queryId:Object(xf.a)(),suggestionCardSignal:{agentId:e}}),aS=e=>{const t=JSON.stringify(e);return{query:"UI STATE SYNC",queryId:Object(xf.a)(),uiStateSync:{jsonPayload:t}}},sS=e=>{const t=JSON.parse(e);return t?t.mode:PO.a.NONE},lS=e=>{var t;const n=null===(t=JSON.parse(e))||void 0===t?void 0:t.payload;return n?n.agentId:""},cS=e=>{var t;const n=null===(t=JSON.parse(e))||void 0===t?void 0:t.payload;return n?n.displayMessage:"Hello, welcome back. How can I help you today?"},uS=e=>{var t;const n=null===(t=JSON.parse(e))||void 0===t?void 0:t.payload;return console.log("ReviewerAgent:: payload: ",n),n},dS=e=>void 0!==JSON.parse(e).uiType,pS=e=>JSON.parse(e).uiType;function gS(e){const t="string"==typeof e?parseInt(e):e;return new Date(t)}const hS=(e,t=!1)=>e.map((e=>{let n;switch(e.kind){case"DATE_PICKER":case"TEXT_AREA":case"PEOPLE_PICKER":case"DROP_DOWN":case"SUBMIT":n={};break;default:throw new Error(`Unsupported kind: ${e.kind}`)}for(const r in e.props){if(n[r]=e.props[r].defaultValue,"selectedDate"===r)if(t)n[r]=gS(n[r]);else{const e=new Date;e.setDate(e.getDate()+7),0===e.getDay()?e.setDate(e.getDate()+1):6===e.getDay()&&e.setDate(e.getDate()+2),n[r]=e}else"selectedValue"===r&&(n[r]="None");"options"===r&&(n[r]=vS((new Date).getTime()+7))}return{InvitationComponentType:e.kind,componentProps:n}}));const fS=(e,t,n)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){mS("Retry button clicked"),bS.getInstance().removeActionButtonFromLastCard(),bS.getInstance().showActionCard($O),yield bS.getInstance().invokeReviewAgent()})),mS=(...e)=>{console.log("ReviewerAgent::"+(new Date).toUTCString(),...e)},vS=e=>{const t=["None"],n=new Date;for(let r=1;r<eS.length;r++){const o=new Date(e);if(1===r&&o.getDate()-1<n.getDate()||2===r&&o.getDate()-3<n.getDate())continue;1===r?o.setDate(o.getDate()-1):2===r&&o.setDate(o.getDate()-3);const i=o.toLocaleDateString(),a=`${eS[r]} (${i})`;t.push(a)}return t};class bS extends TO{sendSuggestionSignal(){var e,t,n;null===(e=this.copilotChatRef.current)||void 0===e||e.addChatMessages([{messageType:c.ChatCardWrapper,body:{user:"human",element:"Show Suggestions"}}]);const r={documentConfig:{documentURL:this.documentURL}},o=Object.assign(Object.assign({},iS(this.agentID)),{config:r});null===(t=this.copilotChatRef.current)||void 0===t||t.submitOperation({operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(o)}]}),workflowAnnotationType:jO.a.getTypeName()}),null===(n=this.copilotChatRef.current)||void 0===n||n.startLoadingUi()}constructor(e,t,n,r,o,i,a,s,l,u){super(),this.commentId="",this.documentURL=JO,this.userQuery="",this.authorName="",this.authorMail="",this.message="",this.date=null,this.reminder="",this.agentID="",this.isInitialCardShown=!1,this.firstMessageText="",this.annotationId=void 0,this.agentLaunchType=VO.a.LAUNCH_WITH_REVIEWERS,this.processInvitationRenderCardRequest=e=>{var t;console.log("ReviewerAgent::  processInvitationRenderCardRequest response ",e);const n=uS(e);console.log("ReviewerAgent::  processInvitationRenderCardRequest payload ",n),console.log("ReviewerAgent::  processInvitationRenderCardRequest payload.props ",null==n?void 0:n.props),this.confirmInvitationCardProps={headerText:null===(t=null==n?void 0:n.props)||void 0===t?void 0:t.headerText,individualComponentProps:hS(null==n?void 0:n.props)},this.confirmInvitationCardProps.individualComponentProps[4].componentProps.onSubmit=()=>this.sendUIStateSyncSignal(),this.message=this.confirmInvitationCardProps.individualComponentProps[1].componentProps.message,this.date=this.confirmInvitationCardProps.individualComponentProps[2].componentProps.selectedDate.getTime(),this.reminder=this.confirmInvitationCardProps.individualComponentProps[3].componentProps.selectedValue,this.reviewers=[],this.confirmInvitationCardProps.individualComponentProps[0].componentProps.suggestions=this.reviewers,this.confirmInvitationCardProps.individualComponentProps[0].componentProps.inputComponent=UO(this.session,this.onItemSelected),this.confirmInvitationCardProps.individualComponentProps[1].componentProps.onMessageChange=e=>{var t;console.log("ReviewerAgent::  onMessageChange message ",e),this.message=e,(0===this.message.trim().length||this.message.trim().length>0&&!this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission)&&(this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission=this.validateBeforeSubmit(),null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getConfirmInvitationProps()))},this.confirmInvitationCardProps.individualComponentProps[2].componentProps.onDateChange=e=>{var t;console.log("ReviewerAgent::  onDateChange date ",e),e.setHours(23,59,59,999),this.date=e.getTime(),this.reminder="None",this.confirmInvitationCardProps.individualComponentProps[3].componentProps.selectedValue=this.reminder,this.confirmInvitationCardProps.individualComponentProps[3].componentProps.options=vS(this.date),this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission=this.validateBeforeSubmit(),null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getConfirmInvitationProps())},this.confirmInvitationCardProps.individualComponentProps[3].componentProps.onItemSelected=e=>{var t;if(console.log("ReviewerAgent::  onDateChange item ",e),e.includes("1 day")){const e=this.date-864e5;this.reminder=e.toString()}else if(e.includes("3 days")){const e=this.date-2592e5;this.reminder=e.toString()}else this.reminder=e;this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission=this.validateBeforeSubmit(),this.confirmInvitationCardProps.individualComponentProps[3].componentProps.selectedValue=e,null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getConfirmInvitationProps())},console.log("ReviewerAgent::  processInvitationRenderCardRequest this.confirmInvitationCardProps: ",this.confirmInvitationCardProps),this.confirmInvitationCardProps.individualComponentProps[0].componentProps.onPeopleRemoved=e=>{var t;this.reviewers=this.reviewers.filter((t=>t.mail!==e.mail)),this.confirmInvitationCardProps.individualComponentProps[0].componentProps.suggestions=this.reviewers,null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getConfirmInvitationProps())},this.agentLaunchType===VO.a.LAUNCH_WITH_REVIEWERS&&this.showInvitationCard()},this.showInvitationCard=()=>{var e;this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission=!1,null===(e=this.copilotChatRef.current)||void 0===e||e.addResponseMessage(this.getConfirmInvitationProps())},this.processReturningUserReviewDetailsRequest=e=>{var t,n,r;const o=uS(e);console.log("ReviewerAgent::  processReturningUserReviewDetailsRequest:","\nresponse:\n",e,"\npayload:\n",o,"\npayload.additionalPayload:\n",null==o?void 0:o.additionalPayload),this.returningUserReviewDetailsProps={isEditDetailsRequest:!0,headerText:null===(t=null==o?void 0:o.additionalPayload)||void 0===t?void 0:t.headerText,individualComponentProps:hS(null===(n=null==o?void 0:o.additionalPayload)||void 0===n?void 0:n.props,!0),messageIdPrefix:Object(xf.a)()},this.returningUserReviewDetailsProps.individualComponentProps[2].componentProps.onSubmit=()=>this.sendUIStateSyncSignalForEditReviewDetails(),this.date=this.returningUserReviewDetailsProps.individualComponentProps[1].componentProps.selectedDate.getTime(),Array.isArray(this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions)||(this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions=(null===(r=this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions)||void 0===r?void 0:r.value)||[]),this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions.forEach((e=>{e.isReadOnly=!0})),this.reviewers=this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions,this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.inputComponent=UO(this.session,this.onItemSelectedForEditReviewDetails),this.returningUserReviewDetailsProps.individualComponentProps[1].componentProps.onDateChange=e=>{console.log("ReviewerAgent::  onDateChange date ",e),e.setHours(23,59,59,999),this.date=e.getTime()},console.log("ReviewerAgent::  processReturningUserReviewDetailsRequest this.returningUserReviewDetailsProps: ",this.returningUserReviewDetailsProps),this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.onPeopleRemoved=e=>{var t;this.reviewers=this.reviewers.filter((t=>t.mail!==e.mail)),this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions=this.reviewers,null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getEditReviewDetailsChatCardResponse())}},this.getConfirmInvitationProps=()=>({chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.ConfirmInvitationCard,reviewAgentInternalCardProps:this.confirmInvitationCardProps}}},chatMessageBodyData:{messageId:qO.get(xO.ConfirmInvitationCard)}}),this.getEditReviewDetailsChatCardResponse=()=>{var e,t,n;(null===(e=this.returningUserReviewDetailsProps)||void 0===e?void 0:e.messageIdPrefix)?this.returningUserReviewDetailsProps.messageIdPrefix=`${XO}-${null===(t=this.returningUserReviewDetailsProps)||void 0===t?void 0:t.messageIdPrefix}`:this.returningUserReviewDetailsProps.messageIdPrefix=XO;const r=(null===(n=this.returningUserReviewDetailsProps)||void 0===n?void 0:n.messageIdPrefix)+qO.get(xO.ConfirmInvitationCard);return{chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.ConfirmInvitationCard,reviewAgentInternalCardProps:this.returningUserReviewDetailsProps}}},chatMessageBodyData:{messageId:r}}},this.onItemSelected=e=>{var t;this.reviewers.find((t=>t.mail===e.mail))||(this.reviewers.push(e),this.confirmInvitationCardProps.individualComponentProps[0].componentProps.suggestions=this.reviewers,null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getConfirmInvitationProps()))},this.onItemSelectedForEditReviewDetails=e=>{var t;this.reviewers.find((t=>t.mail===e.mail))||(this.reviewers.push(e),this.returningUserReviewDetailsProps.individualComponentProps[0].componentProps.suggestions=this.reviewers,null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(this.getEditReviewDetailsChatCardResponse()))},this.copilotChatRef=e,this.session=t,this.userQuery=n||"Start a review on this document",this.documentURL=r||JO,this.authorName=o||"Aditya Aswal",this.authorMail=i||"aditysasaaswal@microsoft.com",this.setSuggestionList=a,this.isReviewerNotAddedButtonClicked=s||!1,this.agentLaunchType=l,this.getDocumentSensitivity=u}setCallbacks(e,t,n,r){this.onApplySuggestion=e,this.toggleChangeHandler=t,this.addCommentToFirstLineOfDocument=n,this.onReviewerAgentClose=r}static getInstance(e,t,n,r,o,i,a,s,l,c){return bS.instance||(bS.instance=new bS(e,t,n,r,o,i,a,s,l,c)),bS.instance}static destroy(){console.log("ReviewerAgent:: Destroying CopilotCommunicationHandlerImpl instance."),bS.instance=void 0}getWorkflowsToRegister(){console.log("ReviewerAgent:: getWorkflowsToRegister.");const e=[];return e.push({workflowAnnotationType:jO.a.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}),console.log("ReviewerAgent:: Registered workflows"),e}handoffInitialCard(){this.isInitialCardShown||this.agentLaunchType==VO.a.LAUNCH_FROM_TOGGLE||(this.showStartupCard(),this.isInitialCardShown=!0)}showStartupCard(){var e;null===(e=this.copilotChatRef.current)||void 0===e||e.addResponseMessage({chatCardType:c.Default,chatMessageData:{defaultMessageProps:{user:"human",messageHeader:{text:"Start reviewersync"}}},stopLoadingUi:!0})}showAcknowledgementCard(){var e;this.isReviewerNotAddedButtonClicked&&(this.firstMessageText=zO),this.firstMessageText&&(null===(e=this.copilotChatRef.current)||void 0===e||e.addResponseMessage({chatCardType:c.MarkdownCard,chatMessageData:{markDownCardProps:{message:this.firstMessageText}},stopLoadingUi:!0}))}sendResponseToClient(e){var t,n,r,o,i,a,s,l,u,d;console.log("ReviewerAgent:: SendResponseToClient.",e);const p=e.id;if((!this.annotationId||this.annotationId!==p)&&(this.annotationId&&this.annotationId===p||(this.annotationId=p),0===(null===(t=e.body.chatResponse)||void 0===t?void 0:t.status))){this.handoffInitialCard();const t=null===(n=e.body.chatResponse)||void 0===n?void 0:n.messages;if(t.length>=2){this.agentLaunchType===VO.a.LAUNCH_FROM_TOGGLE&&(null===(r=this.copilotChatRef.current)||void 0===r||r.addResponseMessage({chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.EntryPointCard,reviewAgentInternalCardProps:{isTriggeredFromReviewerAgentPane:!0,onAddDetailsButtonClick:()=>{this.isReviewerNotAddedButtonClicked=!1,this.showAcknowledgementCard(),this.showInvitationCard(),console.log("onAddDetailsButtonClick")},onStartReviewButtonClick:()=>{this.isReviewerNotAddedButtonClicked=!0,this.showAcknowledgementCard(),this.sendUIStateSyncSignalZeroReviewers(),console.log("onStartReviewButtonClick")}}}}}})),this.firstMessageText=this.isReviewerNotAddedButtonClicked?zO:null===(o=t[0])||void 0===o?void 0:o.text,this.firstMessageText&&this.agentLaunchType!==VO.a.LAUNCH_FROM_TOGGLE&&(null===(i=this.copilotChatRef.current)||void 0===i||i.addResponseMessage({chatCardType:c.MarkdownCard,chatMessageData:{markDownCardProps:{message:this.firstMessageText}},stopLoadingUi:!0}));const e=null===(a=t[1])||void 0===a?void 0:a.text;console.log("ReviewerAgent:: SendResponseToClient secondMessage mode: ",sS(e)),(e=>{console.log("ReviewerAgent::  responseMessageText.",e);try{return void 0!==uS(e)}catch(e){return console.log("ReviewerAgent::  responseMessageText parsing error: ",e),!1}})(e)&&sS(e)===PO.a.CREATE&&(console.log("ReviewerAgent:: Create Agent responsePayLoad: ",e),this.agentID=lS(e),this.agentLaunchType===VO.a.LAUNCH_WITHOUT_REVIEWERS?this.sendUIStateSyncSignalZeroReviewers():this.processInvitationRenderCardRequest(e))}else if(1===t.length&&sS(null===(s=t[0])||void 0===s?void 0:s.text)===PO.a.RETURNINGUSER){const e=null===(l=t[0])||void 0===l?void 0:l.text;if(this.agentID=lS(e),dS(e)&&pS(e)===AO.a.SUMMARYCARD)console.log("ReviewerAgent:: Returning user with responsePayLoad: ",e),this.processSummaryCard(e);else if(dS(e)&&pS(e)===AO.a.SUGGESTIONCARD)console.log("ReviewerAgent:: Returning user with responsePayLoad: ",e),this.processSuggestionCard(e);else{this.setSuggestionList([QO,GO,WO]);const e=null===(u=t[0])||void 0===u?void 0:u.text;this.agentID=lS(e),this.processReturningUserReviewDetailsRequest(e),console.log("ReviewerAgent:: Returning user with responsePayLoad,show suggestion pills "),null===(d=this.copilotChatRef.current)||void 0===d||d.addResponseMessage({chatCardType:c.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:cS(e)}}},stopLoadingUi:!0})}}}}processSuggestionCard(e){var t;const n=((e,t)=>{var n,r,o;return console.log("ReviewerAgent:: data: ",e),{suggestionIndices:((null===(o=null===(r=null===(n=null==e?void 0:e.props)||void 0===n?void 0:n[0])||void 0===r?void 0:r.props)||void 0===o?void 0:o.suggestionIndices)||[]).map((e=>({onApplySuggestion:t,initialText:e.initialText,suggestedText:e.suggestedText,commentId:e.commentId,changeType:e.changeType})))}})(uS(e),this.onApplySuggestion);null===(t=this.copilotChatRef.current)||void 0===t||t.addResponseMessage({chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.SuggestionCard,reviewAgentInternalCardProps:n}}},chatMessageBodyData:{messageId:qO.get(xO.SuggestionCard)},stopLoadingUi:!0}),this.setSuggestionList([QO,GO,WO])}processSummaryCard(e){var t,n,r;const o=uS(e),i=o.props.map((e=>{let t={reviewersWithAction:[],statusMessage:"",labelForReviewedPeople:"",labelForPendingPeople:"",commentsSummaryHeader:"",commentsSummaries:[]};return t=e.props,t}));const a=null===(n=null===(t=null==o?void 0:o.props)||void 0===t?void 0:t[0])||void 0===n?void 0:n.props.areSuggestionsGenerated;null===(r=this.copilotChatRef.current)||void 0===r||r.addResponseMessage({chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.ReviewStatusCard,reviewAgentInternalCardProps:i[0]}}},chatMessageBodyData:{messageId:qO.get(xO.ReviewStatusCard)},stopLoadingUi:!0}),a&&this.setSuggestionList([QO,"Show suggestions",GO,WO]),console.log("ReviewerAgent:: processSummaryCard payload: ",o)}sendEventToClient(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){console.log("ReviewerAgent:: SendEventToClient.",e),e==Uf.CopilotChatLoaded&&this.invokeReviewAgent()}))}invokeReviewAgent(){var e;return Object(o.__awaiter)(this,void 0,void 0,(function*(){var t;(t=this.getDocumentSensitivity?yield this.getDocumentSensitivity():void 0)&&t.parent&&(console.log("ReviewerAgent:: sensitivity: ",t),1)?null===(e=this.copilotChatRef.current)||void 0===e||e.addResponseMessage({chatCardType:c.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:"I'm sorry, but I can't assist you in initiating a review as this document is marked confidential. Please take a moment to review the sensitivity label and try again."}}},chatMessageBodyData:{actionButtonList:[{type:nS.Default,title:$O,text:$O,iconRegular:Bt.g,iconHover:Bt.f,handleButtonOnClick:fS}]},stopLoadingUi:!0}):(console.log("ReviewerAgent:: Sending initial signal"),this.sendInitialSignal())}))}getDefaultSignalOperation(e,t,n,r,o){var i,a;let s;console.log("ReviewerAgent:: getDefaultSignalOperation.",e,t);const l={documentConfig:{documentURL:this.documentURL}};var c;e.toLowerCase().includes("status")?(s=Object.assign(Object.assign({},(c=this.agentID,{query:"status review of agent",queryId:Object(xf.a)(),summaryCardSignal:{agentId:c}})),{config:l}),null===(i=this.copilotChatRef.current)||void 0===i||i.updateLoadingComponentProps({loadingUiStringList:KO})):e.toLowerCase().includes("close")?s=Object.assign(Object.assign({},(e=>({query:"clean up agent",queryId:Object(xf.a)(),cleanupSignal:{agentId:e}}))(this.agentID)),{config:l}):e.toLowerCase().includes("suggestion")?(s=Object.assign(Object.assign({},iS(this.agentID)),{config:l}),null===(a=this.copilotChatRef.current)||void 0===a||a.updateLoadingComponentProps({loadingUiStringList:ZO})):s=oS();const u={operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(s)}]}),workflowAnnotationType:jO.a.getTypeName()};return Promise.resolve(u)}getHostSettings(){return{appName:"Testing",appPlatform:"All",devBuild:!0,environment:Rf.DEV,sessionId:"",augloopUrl:"http://localhost:20080"}}getAuthToken(){return console.log("ReviewerAgent:: getauthtoken"),Promise.resolve("")}shouldSendRequestToAugloop(e){var t,n;if(e.toLowerCase().includes("entry card")&&(null===(t=this.copilotChatRef.current)||void 0===t||t.addResponseMessage({chatCardType:c.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:xO.EntryPointCard,reviewAgentInternalCardProps:{onAddDetailsButtonClick:()=>{console.log("Detail button clicked")},onStartReviewButtonClick:()=>{console.log("Start Review button clicked")}}}}}})),e.includes(WO))this.onReviewerAgentClose();else if(e.toLowerCase().includes("edit review details"))return null===(n=this.copilotChatRef.current)||void 0===n||n.addResponseMessage(this.getEditReviewDetailsChatCardResponse()),this.setSuggestionList([GO,WO]),Promise.resolve(!1);return Promise.resolve(!0)}getALSession(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(console.log("getALSession"),this.session)return this.session;throw new Error("Session is not undefined")}))}sendInitialSignal(){var e,t,n;console.log("sendInitialSignal");const r={documentConfig:{documentURL:this.documentURL}},o=Object.assign(Object.assign({},oS()),{config:r});null===(e=this.copilotChatRef.current)||void 0===e||e.submitOperation({operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(o)}]}),workflowAnnotationType:jO.a.getTypeName()}),null===(t=this.copilotChatRef.current)||void 0===t||t.startLoadingUi(),null===(n=this.copilotChatRef.current)||void 0===n||n.updateLoadingComponentProps({loadingUiStringList:YO})}sendUIStateSyncSignal(){var e,t,n;return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.reviewers.length>0&&(yield this.notifyClientOnReviewInitiation()),this.confirmInvitationCardProps.isCardSubmitted=!0,this.confirmInvitationCardProps.individualComponentProps[4].componentProps.isFormReadyForSubmission=!1,null===(e=this.copilotChatRef.current)||void 0===e||e.updateMessage(this.getConfirmInvitationProps()),console.log("sendUIStateSyncSignal");const r={INVITE_EMAIL:this.message,DUE_DATE:this.date,REMINDER_CADENCE:this.reminder,REVIEWERS:this.reviewers.map((e=>Object.assign(Object.assign({},e),{commentId:this.commentId,context:this.message}))),COMMENT_ID:this.commentId,CONTEXT:this.message,AUTHOR:{displayName:this.authorName,mail:this.authorMail}},o={documentConfig:{documentURL:this.documentURL}},i=Object.assign(Object.assign({},aS(r)),{config:o});null===(t=this.copilotChatRef.current)||void 0===t||t.startLoadingUi(),null===(n=this.copilotChatRef.current)||void 0===n||n.submitOperation({operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(i)}]}),workflowAnnotationType:jO.a.getTypeName()}),this.setSuggestionList([GO,WO])}))}sendUIStateSyncSignalForEditReviewDetails(){var e,t,n;return Object(o.__awaiter)(this,void 0,void 0,(function*(){this.returningUserReviewDetailsProps.isCardSubmitted=!0,this.returningUserReviewDetailsProps.individualComponentProps[2].componentProps.isFormReadyForSubmission=!1,null===(e=this.copilotChatRef.current)||void 0===e||e.updateMessage(this.getEditReviewDetailsChatCardResponse()),console.log("sendUIStateSyncSignalForEditReviewDetails");const r={DUE_DATE:this.date,REVIEWERS:this.reviewers.map((e=>Object.assign(Object.assign({},e),{commentId:this.commentId,context:this.message})))},o={documentConfig:{documentURL:this.documentURL}},i=Object.assign(Object.assign({},aS(r)),{config:o});null===(t=this.copilotChatRef.current)||void 0===t||t.startLoadingUi(),null===(n=this.copilotChatRef.current)||void 0===n||n.submitOperation({operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(i)}]}),workflowAnnotationType:jO.a.getTypeName()}),this.setSuggestionList([GO,WO])}))}validateBeforeSubmit(){return this.message.length>0&&this.date>Date.now()&&"None"!==this.reminder}sendUIStateSyncSignalZeroReviewers(){var e;return Object(o.__awaiter)(this,void 0,void 0,(function*(){console.log("sendUIStateSyncSignalZeroReviewers");const t=new Date;t.setDate(t.getDate()+7);const n={INVITE_EMAIL:"",DUE_DATE:t.getTime(),REMINDER_CADENCE:"1 day before",REVIEWERS:[],COMMENT_ID:"Random comment id",CONTEXT:"",AUTHOR:{displayName:this.authorName,mail:this.authorMail}},r={documentConfig:{documentURL:this.documentURL}},o=Object.assign(Object.assign({},aS(n)),{config:r});console.log("sendUIStateSyncSignalZeroReviewers textTile",o),null===(e=this.copilotChatRef.current)||void 0===e||e.submitOperation({operation:new bv.b({parentPath:["Signal",kO.a.getTypeName()],items:[{id:tS.generateId(),body:new kO.a(o)}]}),workflowAnnotationType:jO.a.getTypeName()}),this.setSuggestionList([GO,WO])}))}notifyClientOnReviewInitiation(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){const e=`[via Reviewer]\n\nHello ${this.reviewers.map((e=>e.displayName)).join(", ")}\n\nHere's how you can help with this document review:\n"${this.message}"`;console.log(e),this.commentId=yield this.addCommentToFirstLineOfDocument(null!=e?e:"Please review this document")}))}showActionCard(e){this.copilotChatRef.current.addResponseMessage({chatCardType:c.Default,chatMessageData:{defaultMessageProps:{user:Wm.Human,messageHeader:{text:e}}}})}removeActionButtonFromLastCard(){this.copilotChatRef.current.updateLastMessage({chatCardType:c.Default,chatMessageBodyData:{actionButtonList:[]},addCardToChatHistory:!1})}}const yS=(e,t)=>{console.log("onAgentToggleChangeStub")},CS=(e,t,n)=>{console.log("onApplySuggestionStub: ",e,t,n)},OS=e=>(console.log("addCommentToFirstLineOfDocument: ",e),Promise.resolve("Comment added successfully")),SS=()=>{console.log("onReviewerAgentCloseStub")},ES={themePrimary:"#598FEC",themeSecondary:"#8763c2",themeLight:"#0E336A",themeDark:"#464FEB",themeTertiary:"#598FEC",themeDarker:"#353696",themeMedium:"#464FEB",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondaryAlt:"#FFFFFF",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternaryAlt:"#FFFFFF",neutralDark:"#2461CA",black:"#FFFFFF",white:"#000000"},xS={themePrimary:"#185abd",themeSecondary:"#8763c2",themeLight:"#D2E0F4",themeDark:"#82ABF1",themeTertiary:"#598FEC",themeDarker:"#598FEC",themeMedium:"#82ABF1",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralLighter:"#f5f5f5",neutralDark:"#1651AA",white:"#FFFFFF"};var IS=function(e){var t,n,r,o,i,a,s,l,c;return{chatUiStack:null!==(t=e.chatUiStack)&&void 0!==t?t:{},chatFreStack:null!==(n=e.chatFreStack)&&void 0!==n?n:{},chatUiStackZoom:null!==(r=e.chatUiStackZoom)&&void 0!==r?r:{},chatFreStackZoom:null!==(o=e.chatFreStackZoom)&&void 0!==o?o:{},spinner:null!==(i=e.spinner)&&void 0!==i?i:{},incomingShimmerCard:null!==(a=e.incomingShimmerCard)&&void 0!==a?a:{},outgoingShimmerCard:null!==(s=e.outgoingShimmerCard)&&void 0!==s?s:{},incomingShimmerCardWrapper:null!==(l=e.incomingShimmerCardWrapper)&&void 0!==l?l:{},outgoingShimmerCardWrapper:null!==(c=e.outgoingShimmerCardWrapper)&&void 0!==c?c:{}}};const wS=function(e){var t=IS(e);return Object(pe.a)(t)}({chatFreStack:{height:"calc(100vh - 50px)"}}),TS=({isTestApp:e=!1,alSession:t,documentURL:r,userQuery:i,intent:a,onReviewerAgentToggleChange:s,onApplySuggestion:l,addCommentToFirstLineOfDocument:c,onReviewerAgentClose:u,isDarkModeEnabled:d=!1,isHighContrastModeEnabled:p=!1,authorName:g,authorEmail:h,isReviewerNotAddedButtonClicked:f=!1,agentLaunchType:m=VO.a.LAUNCH_WITH_REVIEWERS,getDocumentSensitivity:v})=>{console.log("ReviewerAgent: ",t,"IsTestApp: ",e);const b=ce.useRef(null),[y,C]=Object(ce.useState)([]);Object(ce.useEffect)((()=>{}),[y]);const O=(e,t,n)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){console.log("ReviewerAgent:: onApplySuggestionsCbk: ",e,t,n);const r=parseInt(e,16);l&&(yield l(r.toString(),t,n))}));e&&(i="create agent",r="https://www.microsoft.com",g="Aditya Test",h="test@msft.com");const S=bS.getInstance(b,e?void 0:t,i,r,g,h,C,f,m,v);e?S.setCallbacks(CS,yS,OS,SS):S.setCallbacks(O,s,c,u);const E={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"Copilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,resultTime:1e4},telemLogger:{logError:e=>{console.log("Shared Copilot CIQ Error Log: ",e)}},entitiesSupported:[],isExpandedECCEnabled:!1},x={headerText:"Reviewer",descriptionText:"I'm the ultimate partner for document reviews, and can help you launch, track progress and resolve review comments.",freImagePath:n(2723),hideGetStartedButton:!0},I={trySydneyToggleChecked:!1,trySydneyToggleEnabled:!1,tryWebSearchToggleEnabled:!1,trySydneyToggleOnChange:(e,t)=>{console.log("officeaicopilot-test-app: onChange for Try Sydney Toggle")},tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryEnterpriseSearchToggleOnChange:(e,t)=>{console.log("officeaicopilot-test-app: onChange for Enterprise Search Toggle")},tryReviewerAgentToggleChecked:!0,tryReviewerAgentToggleEnabled:!0,tryReviewerAgentToggleOnChange:s},w=wS(),T=((e,t)=>Object.assign({isDarkModeEnabled:e,isHighContrastModeEnabled:t},e?ES:xS))(d,p);return Object(ce.useEffect)((()=>()=>{bS.destroy()}),[]),ce.createElement(Gr.a,{className:"ms-welcome",style:{display:"flex",gap:"8px",margin:"0px 4px"}},e||t?ce.createElement(vO,{style:w,chatUiProps:{chatInputV2Props:{pluginsInfo:[],chatPlaceholderMessage:"Type a message for Reviewer",editorConfig:E},changeTopicUiProps:{hideChangeTopicButton:!0},freUiProps:x,toggleUiProps:I,suggestionPillsUiProps:{suggestionList:y}},copilotCommunicationHandler:S,useALRuntime:!!e,ref:b,debugProps:{conversationId:"ReviewerAgent",telemetryData:[],isDebugToggleEnabled:!0},theme:T}):ce.createElement("div",null,"ReviewerAgent: alSession is required for non test"))};TS.displayName="Reviewer"},3508:function(e,t,n){"use strict";n.d(t,"a",(function(){return Fo}));var r=n(142),o=n(246),i=n(2851),a=n(3404),s=n(570),l=n(359),c=n(65),u=n(3345),d=n(1),p=n(2089);const g=e=>new p.a(e,{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},imageSizes:{small:32,medium:52,large:100},containerStyles:{default:{foregroundColors:{default:{default:"#ffffffff",subtle:"#f0f0f0"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}},borderColor:"#CCCCCC",backgroundColor:"#1f1f1f"},emphasis:{foregroundColors:{default:{default:"#ffffffff",subtle:"#bfffffff"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}},borderColor:"#666666",backgroundColor:"#ff292828"},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}}},actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}}),h=e=>new p.a(e,{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:32,medium:52,large:100},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{foregroundColors:{default:{default:"#1f1f1f",subtle:"#424242"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#CCCCCC",backgroundColor:"#fafafa"},emphasis:{foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#666666",backgroundColor:"#fff9f8f7"},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}}},actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}});var f=n(1627),m=n(2445);const v=Object.assign({},f.a),b=Object.assign({},m.a),y=d.createContext(void 0);var C=n(406);const O=new Map;function S(e,t){var n;null===(n=O.get(e))||void 0===n||n(t)}var E=n(1531),x=n(1110),I=n(1005),w=n(771),T=n(2094),k=n(1743);const j={body:[{type:"TextBlock",size:"Medium",weight:"Bolder",text:"Sign In"},{type:"TextBlock",text:"Please sign in to see the card content",wrap:!0}],actions:[{type:"Action.SignIn",title:"Sign in",url:"https://sampleSigninUrl",data:{id:"",verb:"",data:{},originalCard:""}}],$schema:"https://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"};class P{constructor(e,t,n){this.request=e,this.content=t,this.type=n}}class A{constructor(e,t,n){this.request=e,this.code=t,this.message=n}}class _{constructor(e,t,n){this.request=e,this.signInButton=t,this.tokenExchangeResource=n}}class D{constructor(e,t,n,r,o,i,a){this.cardData=e,this.serviceProvider=t,this.action=n,this.trigger=r,this.maxRetryCount=o,this.authToken=i,this.authCode=a}onCompletion(e){var t,n,r,s,l,c,u,d,p;const g=new i.a(null===(t=this.serviceProvider)||void 0===t?void 0:t.telemetryService,o.h.CardActions,o.g.ActionExecuteActivityRequest),h={};if(h[o.l.ActionType]=o.c.Execute,h[o.l.Intent]=void 0,h[o.l.RuntimeActivityResponseMethod]=o.i.OnCompletion,e instanceof P){const t=null==e?void 0:e.content;if(t&&e.type){const n=Object.values(E.b).indexOf(e.type),r=Object.keys(E.b)[n];S(this.cardData.cardId,{cardData:Object.assign(Object.assign({},this.cardData),{content:t,contentType:E.b[r]})})}}else if(e instanceof _){const t=e,o=j;o.actions[0].title=null!==(r=null===(n=t.signInButton)||void 0===n?void 0:n.title)&&void 0!==r?r:"Sign in",o.actions[0].url=null!==(l=null===(s=t.signInButton)||void 0===s?void 0:s.value)&&void 0!==l?l:"",o.actions[0].data.data=null!==(c=this.action.data)&&void 0!==c?c:{},o.actions[0].data.id=null!==(u=this.action.id)&&void 0!==u?u:"",o.actions[0].data.verb=this.action.verb,o.actions[0].data.originalCard=this.cardData.content,S(this.cardData.cardId,{cardData:Object.assign(Object.assign({},this.cardData),{content:JSON.stringify(o),contentType:E.b.AdaptiveCard})})}g.logMetricEnd({props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(d=this.cardData)||void 0===d?void 0:d.titleId,null===(p=this.cardData)||void 0===p?void 0:p.appId)}`})}async execute(){var e,t,n,r,s,l,c,u;const d=new i.a(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.h.CardActions,o.g.ActionExecuteActivityRequest),p={};p[o.l.ActionType]=o.c.Execute,p[o.l.Intent]=void 0,p[o.l.RuntimeActivityResponseMethod]=o.i.Execute;let g,h=0;p[o.l.RetryCount]=h;do{try{const e={cardData:this.cardData,botId:null!==(t=this.cardData.botId)&&void 0!==t?t:"",appId:this.cardData.appId,actionId:this.action.id,actionVerb:this.action.verb,actionData:this.action.data,trigger:this.trigger,authCode:this.authCode,authToken:this.authToken},i=await this.serviceProvider.cardService.handleActionExecute(e);i&&(g=i instanceof k.a?new _(this,i.signInButton,i.tokenExchangeResource):i instanceof k.c?new P(this,i.content,i.type):new A(this,i.code,i.message)),g instanceof A?(p[o.l.ActionErrorType]=o.a.BotInvokeError,d.logMetricEndWithError({props:p,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Bot Invoke failed with error code: ${g.code} and message: ${g.message}, Appid: ${Object(a.a)(null===(n=this.cardData)||void 0===n?void 0:n.titleId,null===(r=this.cardData)||void 0===r?void 0:r.appId)}`})):d.logMetricEnd({props:p,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId} Appid: ${Object(a.a)(null===(s=this.cardData)||void 0===s?void 0:s.titleId,null===(l=this.cardData)||void 0===l?void 0:l.appId)}`})}catch(e){h++,p[o.l.ActionErrorType]=o.a.Others,d.logMetricEndWithError({props:p,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${Object(a.a)(null===(c=this.cardData)||void 0===c?void 0:c.titleId,null===(u=this.cardData)||void 0===u?void 0:u.appId)}\n          }`})}}while(!g&&this.maxRetryCount&&h<this.maxRetryCount);return null!=g?g:{request:this}}}class L{constructor(e,t,n,r){this.cardData=e,this.url=t,this.serviceProvider=n,this.botId=r}onCompletion(e){}async execute(){var e,t,n,r,s;const l=new i.a(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.h.CardActions,o.g.OpenUrlActivityRequest),c={};c[o.l.ActionType]=o.c.OpenUrl,c[o.l.Intent]=void 0,c[o.l.RuntimeActivityResponseMethod]=o.i.Execute;try{const e={cardData:this.cardData,url:this.url,botId:this.botId};await this.serviceProvider.cardService.handleOpenUrl(e),l.logMetricEnd({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})}catch(e){l.logMetricEndWithError({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${Object(a.a)(null===(r=this.cardData)||void 0===r?void 0:r.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)} `})}return{request:this}}}var M=n(2680);class B{constructor(e,t,n,r){this.cardData=e,this.serviceProvider=t,this.signInUrl=n,this.data=r}onCompletion(e){var t,n,r;const s=new i.a(null===(t=this.serviceProvider)||void 0===t?void 0:t.telemetryService,o.h.CardActions,o.g.SigninActionActivityRequest),l={};if(l[o.l.ActionType]=o.c.SignIn,l[o.l.Intent]=void 0,l[o.l.RuntimeActivityResponseMethod]=o.i.OnCompletion,!this.data)return void s.logMetricEndWithError({props:l,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Data not present, Appid: ${Object(a.a)(null===(n=this.cardData)||void 0===n?void 0:n.titleId,null===(r=this.cardData)||void 0===r?void 0:r.appId)} `});const c=new I.a,u=JSON.parse(this.data);c.id=u.id,c.verb=u.verb,c.data=u.data;const d=e.code,p=Object.assign(Object.assign({},this.cardData),{content:u.originalCard}),g=new D(p,this.serviceProvider,c,E.a.Manual,void 0,void 0,d);g.execute().then((e=>{var t,n;g.onCompletion(e),s.logMetricEnd({props:l,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})})).catch((e=>{var t,n;s.logMetricEndWithError({props:l,diagnosticsData:`Error: ${e.message||e}}, TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)} `})}))}async execute(){var e,t,n,r,s,l,c,u,d,p;if(!this.signInUrl||!this.data)return{request:this};const g=new i.a(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.h.CardActions,o.g.SigninActionActivityRequest),h={};h[o.l.ActionType]=o.c.SignIn,h[o.l.Intent]=void 0,h[o.l.RuntimeActivityResponseMethod]=o.i.Execute;if(!JSON.parse(this.data))return g.logMetricEndWithError({props:h,message:o.d.AttributedDataNotFound,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Data not present, Appid: ${Object(a.a)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)} `}),Promise.reject(o.d.AttributedDataNotFound);const f=this.cardData.appId,m=await this.getAppDefinition(f);if(!m)return g.logMetricEndWithError({message:o.d.AppDefinitionIsUndefined,props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId} , Error: app definition not present, Appid: ${Object(a.a)(null===(r=this.cardData)||void 0===r?void 0:r.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)} `}),Promise.reject(o.d.AppDefinitionIsUndefined);const v={cardData:this.cardData,appDefinition:m,signInUrl:this.signInUrl};try{const e=await(null===(l=this.serviceProvider.hostService)||void 0===l?void 0:l.handleAuth(v));return e?{code:e.code}:(g.logMetricEnd({props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(c=this.cardData)||void 0===c?void 0:c.titleId,null===(u=this.cardData)||void 0===u?void 0:u.appId)}`}),{request:this})}catch(e){return g.logMetricEndWithError({props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error : ${null==e?void 0:e.message}, Appid: ${Object(a.a)(null===(d=this.cardData)||void 0===d?void 0:d.titleId,null===(p=this.cardData)||void 0===p?void 0:p.appId)} `}),{request:this}}}async getAppDefinition(e){var t;try{const n=await(null===(t=this.serviceProvider.appService)||void 0===t?void 0:t.getApp({id:e}));let r=null==n?void 0:n.appDefinition;return!r&&(null==n?void 0:n.titleInfo)&&(r=Object(M.a)(n.titleInfo)),r}catch(e){return}}}class R{constructor(e,t,n,r,o){this.cardData=e,this.appId=t,this.botId=n,this.serviceProvider=r,this.action=o}async execute(){var e,t,n,r,s;const l=new i.a(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.h.CardActions,o.g.SubmitActionActivityRequest),c={};c[o.l.ActionType]=o.c.Submit,c[o.l.Intent]=void 0,c[o.l.RuntimeActivityResponseMethod]=o.i.Execute;try{const e={id:this.action.id,cardData:this.cardData,botId:this.botId,data:this.action.data,appId:this.appId};await this.serviceProvider.cardService.handleActionSubmit(e),l.logMetricEnd({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Appid: ${Object(a.a)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})}catch(e){l.logMetricEndWithError({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${Object(a.a)(null===(r=this.cardData)||void 0===r?void 0:r.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)}`})}return{request:this}}onCompletion(e){}}class F{constructor(e,t,n,r){this.cardData=e,this.serviceProvider=t,this.onPrepareRuntimeActivityRequest=n,this.onRuntimeActivityResponse=r}get handleAction(){return e=>{const t=this.createRequest(e);this.triggerActivityRequest(t).catch((e=>{}))}}get handleAnchorClicked(){return(e,t)=>{const n=new L(this.cardData,e,this.serviceProvider);return this.triggerActivityRequest(n).catch((e=>{})),!0}}async triggerActivityRequest(e){var t,n;if(e){if(!await(null===(t=this.onPrepareRuntimeActivityRequest)||void 0===t?void 0:t.call(this,e))){const t=await e.execute();await(null===(n=this.onRuntimeActivityResponse)||void 0===n?void 0:n.call(this,t))||e.onCompletion(t)}}}createRequest(e,t){var n;let r,o,i;return e instanceof x.a?(o=e.getHref(),o&&(r=new L(this.cardData,o,this.serviceProvider,this.cardData.botId))):e instanceof I.a?r=new D(this.cardData,this.serviceProvider,e,null!=t?t:E.a.Manual):e instanceof T.a?(o=e.getHref(),i=JSON.stringify(e.data),r=new B(this.cardData,this.serviceProvider,o,i)):e instanceof w.a&&(r=new R(this.cardData,this.cardData.appId,null!==(n=this.cardData.botId)&&void 0!==n?n:"",this.serviceProvider,e)),r}}var N,H=n(2),U=n(32),V=n(28),z="#107C10",G="#FFC300",W="#D13438",Q="#CCCCCC",q="#c50f1f",K="#80215d",Y="#3f3682",Z="#2461ca",J="#0078d4",X="#00b7c3",$="#00cc6a",ee="#a4cd6c",te="#f3c761",ne="#333357",re="#4f52b2",oe="#5b5fc7",ie="#7f85f5",ae="#9299f7",se="#aab1fa",le="#c5cbfa",ce="#dce0fa",ue="#13458f",de="#2c72a8",pe="#92b6d1",ge="#9bd9db",he="#ffe69e",fe="#f4beaa",me="#e37d81",ve="#d33f4c",be="#950c17",ye="#4b5356",Ce={name:"Categorical",lightTheme:[q,K,Y,Z,J,X,$,ee,te],darkTheme:[q,K,Y,Z,J,X,$,ee,te]},Oe={name:"Sequential",lightTheme:[ne,re,oe,ie,ae,se,le,ce],darkTheme:[ne,re,oe,ie,ae,se,le,ce]},Se={name:"Diverging",lightTheme:[ue,de,pe,ge,he,fe,me,ve,be],darkTheme:[ge,pe,de,ue,ye,be,ve,me,fe]},Ee=["good","warning","attention","neutral","categoricalRed","categoricalPurple","categoricalLavender","categoricalBlue","categoricalLightBlue","categoricalTeal","categoricalGreen","categoricalLime","categoricalMarigold","sequential1","sequential2","sequential3","sequential4","sequential5","sequential6","sequential7","sequential8","divergingBlue","divergingLightBlue","divergingCyan","divergingTeal","divergingYellow","divergingPeach","divergingLightRed","divergingRed","divergingMaroon","divergingGray"],xe=Oe,Ie=function(){function e(){}return e.addColorSet=function(e){this._colorSets.set(e.name.toLowerCase(),e)},e.removeColorSet=function(e){this._colorSets.delete(e.toLowerCase())},e.getColor=function(e,t,n){var r,o=e&&null!==(r=this._colorSets.get(e))&&void 0!==r?r:xe,i=t===V.y.Dark?o.darkTheme:o.lightTheme;return i[(n>=0?n:0)%i.length]},e.getColors=function(e,t){var n,r=e&&null!==(n=this._colorSets.get(e.toLowerCase()))&&void 0!==n?n:xe;return t===V.y.Dark?r.darkTheme:r.lightTheme},e.getWellKnownColor=function(e){return e?this._wellKnownChartColors[e]:this._wellKnownChartColors.sequential3},e._colorSets=new Map([[Ce.name.toLowerCase(),Ce],[Oe.name.toLowerCase(),Oe],[Se.name.toLowerCase(),Se]]),e._wellKnownChartColors={good:z,warning:G,attention:W,neutral:Q,categoricalRed:q,categoricalPurple:K,categoricalLavender:Y,categoricalBlue:Z,categoricalLightBlue:J,categoricalTeal:X,categoricalGreen:$,categoricalLime:ee,categoricalMarigold:te,sequential1:ne,sequential2:re,sequential3:oe,sequential4:ie,sequential5:ae,sequential6:se,sequential7:le,sequential8:ce,divergingBlue:ue,divergingLightBlue:de,divergingCyan:pe,divergingTeal:ge,divergingYellow:he,divergingPeach:fe,divergingLightRed:me,divergingRed:ve,divergingMaroon:be,divergingGray:ye},e.defaultLoadingSkeletonHeight=200,e.wideVerticalBarWidth=30,e.narrowVerticalBarWidth=20,e.verticalChartHeight=300,e.lineChartHeight=300,e.pieAndDonutChartHeight=300,e.gaugeChartHeight=150,e.donutChartInnerRadiusRatio=.3,e}(),we=n(321),Te=n(181),ke=n(3598),je=n(3368),Pe=function(e){var t;return d.createElement(ke.a,Object(H.__assign)({},e),d.createElement(je.a,{style:{height:"".concat(null!==(t=e.height)&&void 0!==t?t:Ie.defaultLoadingSkeletonHeight,"px")}}))},Ae=function(e){var t=Object(H.__read)(d.useState(0),2)[1],n=d.useCallback((function(){t((function(e){return e+1}))}),[]);return d.useEffect((function(){return e.addResizeListener(n),function(){e.removeResizeListener(n)}}),[]),e.renderChartComponent()},_e=function(e){function t(t,n,r){var o=this,i=Ee.map((function(e){return{value:e}}));return(o=e.call(this,t,n,i)||this).targetVersion=t,o.name=n,o.defaultValue=r,o}return Object(H.__extends)(t,e),t}(U.q),De=function(e){function t(){var t=e.apply(this,Object(H.__spreadArray)([],Object(H.__read)(arguments),!1))||this;return t._resizeListeners=new Set,t}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorSet",{get:function(){return this.getValue(t.colorSetProperty)},set:function(e){this.setValue(t.colorSetProperty,e)},enumerable:!1,configurable:!0}),t.prototype.addResizeListener=function(e){this._resizeListeners.add(e)},t.prototype.removeResizeListener=function(e){this._resizeListeners.delete(e)},t.prototype.getResizeManager=function(){var e=this.getRootElement();return e instanceof we.a?e.resizeManager:void 0},t.prototype.onRef=function(e){var t=this,n=this.getResizeManager();n&&(this._chartHost&&n.unobserve(this._chartHost),this._chartHost=null!=e?e:void 0,this._chartHost&&n.observe(this._chartHost,(function(e,n){var r;0!==n.width&&n.width!==(null===(r=t._currentSize)||void 0===r?void 0:r.width)&&(t._currentSize=Object(H.__assign)({},n),t._resizeListeners.forEach((function(e){return e()})))})))},Object.defineProperty(t.prototype,"chartHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHost",{get:function(){return this._chartHost},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this;return d.createElement(d.Suspense,{fallback:d.createElement(Pe,{height:this.chartHeight})},d.createElement("div",{ref:function(t){return e.onRef(t)},style:{height:"".concat(this.chartHeight,"px")}},d.createElement(Ae,{addResizeListener:function(t){return e.addResizeListener(t)},removeResizeListener:function(t){return e.removeResizeListener(t)},renderChartComponent:function(){return e.renderChartComponent()}})))},t.prototype.getAdditionalPropertyDescriptors=function(t){return Object(H.__spreadArray)(Object(H.__spreadArray)([],Object(H.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"colorSet",valueType:"string",description:"Name of a color set. Color set names are validated on the client, never on the server.",isArray:!1}],!1)},Object.defineProperty(t.prototype,"currentSize",{get:function(){return this._currentSize},enumerable:!1,configurable:!0}),t.titleProperty=new U.n(U.s.v1_5,"title"),t.colorSetProperty=new U.n(U.s.v1_5,"colorSet"),t}(Te.d),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),t.legendProperty=new U.n(U.s.v1_5,"legend"),t}(U.j),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"DonutChartData"},t.valueProperty=new U.g(U.s.v1_5,"value"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(Le),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return Ie.pieAndDonutChartHeight},enumerable:!1,configurable:!0}),t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new Me})),t}(De),Re=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.DonutChart}}))})),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n={chartTitle:this.title,chartData:this.data.map((function(e,n){return{color:e.color?Ie.getWellKnownColor(e.color):Ie.getColor(t.colorSet,t.theme,n),legend:e.legend,data:e.value}}))},r=void 0;return this.currentSize&&(r=this.currentSize.height>this.currentSize.width?this.currentSize.width*Ie.donutChartInnerRadiusRatio:this.currentSize.height*Ie.donutChartInnerRadiusRatio),d.createElement(Re,{data:n,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,innerRadius:r})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Donut",t}(Be),Ne=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.DonutChart}}))})),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n={chartTitle:this.title,chartData:this.data.map((function(e,n){return{color:e.color?Ie.getWellKnownColor(e.color):Ie.getColor(t.colorSet,t.theme,n),legend:e.legend,data:e.value}}))};return d.createElement(Ne,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Pie",t}(Be),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"BarChartDataValue"},t.xProperty=new U.n(U.s.v1_5,"x"),t.yProperty=new U.g(U.s.v1_5,"y"),t}(U.j),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"xAxisTitle",{get:function(){return this.getValue(t.xAxisTitleProperty)},set:function(e){this.setValue(t.xAxisTitleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yAxisTitle",{get:function(){return this.getValue(t.yAxisTitleProperty)},set:function(e){this.setValue(t.yAxisTitleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.xAxisTitleProperty=new U.n(U.s.v1_5,"xAxisTitle"),t.yAxisTitleProperty=new U.n(U.s.v1_5,"yAxisTitle"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(De),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return this.getValue(t.valuesProperty)},set:function(e){this.setValue(t.valuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"BarChartData"},t.valuesProperty=new U.k(U.s.v1_5,"values",(function(e){return new Ue})),t.colorProperty=new _e(U.s.v1_5,"color"),t}(Le),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"stacked",{get:function(){return this.getValue(t.stackedProperty)},set:function(e){this.setValue(t.stackedProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBarValues",{get:function(){return this.getValue(t.showBarValuesProperty)},set:function(e){this.setValue(t.showBarValuesProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,V.A.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,V.A.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.stackedProperty=new U.b(U.s.v1_5,"stacked",!1),t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new ze})),t.showBarValuesProperty=new U.b(U.s.v1_5,"showBarValues",!1),t}(Ve),We=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.GroupedVerticalBarChart}}))})),Qe=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.VerticalStackedBarChart}}))})),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderGroupedVerticalBarChart=function(){var e,t=this,n=[];return this.data.forEach((function(e,r){e.values.forEach((function(o){var i=n.find((function(e){return e.name===o.x})),a={key:e.legend,data:o.y,color:e.color?Ie.getWellKnownColor(e.color):Ie.getColor(t.colorSet,t.theme,r),legend:e.legend,xAxisCalloutData:o.x};i?i.series.push(a):n.push({name:o.x,series:[a]})}))})),d.createElement(We,{chartTitle:this.title,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLabels:!0,showXAxisLablesTooltip:!1,barwidth:Ie.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderStackedVerticalBarChart=function(){var e,t=this,n=[];return this.data.forEach((function(e,r){e.values.forEach((function(o){var i=n.find((function(e){return e.xAxisPoint===o.x})),a={data:o.y,color:e.color?Ie.getWellKnownColor(e.color):Ie.getColor(t.colorSet,t.theme,r),legend:e.legend,xAxisCalloutData:o.x};i?i.chartData.push(a):n.push({xAxisPoint:o.x,chartData:[a]})}))})),d.createElement(Qe,{chartTitle:this.title,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLabels:!this.showBarValues,isCalloutForStack:!0,showXAxisLablesTooltip:!1,barWidth:Ie.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderChartComponent=function(){return this.stacked?this.renderStackedVerticalBarChart():this.renderGroupedVerticalBarChart()},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.VerticalBar.Grouped",t}(Ge),Ke=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return Object(H.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];return"string"==typeof r||"number"==typeof r?r:this.defaultValue},t.prototype.serialize=function(e,t,n,r){"string"==typeof n?r.serializeString(t,this.name,n):"number"==typeof n&&r.serializeNumber(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:["string","number"],isArray:!1}},t}(U.i),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"BarChartValue"},t.xProperty=new Ke(U.s.v1_5,"x",0),t.yProperty=new U.g(U.s.v1_5,"y"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(U.j),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBarValues",{get:function(){return this.getValue(t.showBarValuesProperty)},set:function(e){this.setValue(t.showBarValuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return Ie.verticalChartHeight},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,V.A.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,V.A.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new Ye})),t.colorProperty=new _e(U.s.v1_5,"color"),t.showBarValuesProperty=new U.b(U.s.v1_5,"showBarValues",!1),t}(Ve),Je=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.VerticalBarChart}}))})),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this;if(0===this.data.length)return null;var n=this.data.map((function(e,n){var r;return{x:e.x,y:e.y,color:t.colorSet?Ie.getColor(t.colorSet,t.theme,n):Ie.getWellKnownColor(null!==(r=e.color)&&void 0!==r?r:t.color)}}));return d.createElement(Je,{chartTitle:this.title,data:n,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,showXAxisLablesTooltip:!1,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLegend:!0,hideLabels:!this.showBarValues,barWidth:Ie.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.VerticalBar",t}(Ze),$e=n(161),et=n(1126);!function(e){e[e.AbsoluteWithAxis=0]="AbsoluteWithAxis",e[e.AbsoluteNoAxis=1]="AbsoluteNoAxis",e[e.PartToWhole=2]="PartToWhole"}(N||(N={}));var tt,nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"HorizontalBarChartDataValue"},t.xProperty=new U.n(U.s.v1_5,"x"),t.yProperty=new U.g(U.s.v1_5,"y"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(U.j),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMode",{get:function(){return this.getValue(t.displayModeProperty)},set:function(e){this.setValue(t.displayModeProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,V.A.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,V.A.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new nt})),t.displayModeProperty=new U.e(U.s.v1_5,"displayMode",N,N.AbsoluteWithAxis),t}(Ve),ot=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.HorizontalBarChart}}))})),it=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.HorizontalBarChartWithAxis}}))})),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderHorizontalBarChart=function(){var e,t=this,n=this.data.reduce((function(e,t){return e+t.y}),0),r=Math.max.apply(Math,Object(H.__spreadArray)([],Object(H.__read)(this.data.map((function(e){return e.y}))),!1)),o=this.data.map((function(e,o){var i;return{chartTitle:e.x,chartData:[{legend:e.x,horizontalBarChartdata:{x:e.y,y:t.displayMode===N.PartToWhole?n:r},color:t.colorSet?Ie.getColor(t.colorSet,t.theme,o):Ie.getWellKnownColor(null!==(i=e.color)&&void 0!==i?i:t.color),yAxisCalloutData:t.displayMode===N.PartToWhole?"".concat(e.y," (").concat((e.y/n*100).toFixed(0),"%)"):void 0}]}}));return d.createElement(ot,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,data:o,chartDataMode:"default",variant:this.displayMode===N.PartToWhole?et.a.PartToWhole:et.a.AbsoluteScale})},t.prototype.renderHorizontalBarChartWithAxis=function(){var e,t=this,n=this.data.map((function(e,n){var r;return{color:t.colorSet?Ie.getColor(t.colorSet,t.theme,n):Ie.getWellKnownColor(null!==(r=e.color)&&void 0!==r?r:t.color),x:e.y,y:e.x}})),r=Object($e.g)(this.hostWidth,V.j.Standard)>=0;return d.createElement(it,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,data:n,showYAxisLablesTooltip:!r,showYAxisLables:r,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLegend:!0,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderChartComponent=function(){return this.displayMode===N.AbsoluteWithAxis?this.renderHorizontalBarChartWithAxis():this.renderHorizontalBarChart()},t.prototype.isResponsive=function(){return!0},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.HorizontalBar",t}(rt),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,V.A.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,V.A.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new lt})),t}(Ve),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"StackedHorizontalBarChartData"},t.titleProperty=new U.n(U.s.v1_5,"title"),t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new ct})),t}(U.j),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"StackedHorizontalBarChartDataPoint"},t.legendProperty=new U.n(U.s.v1_5,"legend"),t.valueProperty=new U.g(U.s.v1_5,"value"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(U.j),ut=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.MultiStackedBarChart}}))})),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderChartComponent=function(){var e=this,t=[];return this.data.forEach((function(n){var r=n.data.map((function(t,n){return{data:t.value,color:t.color?Ie.getWellKnownColor(t.color):Ie.getColor(e.colorSet,e.theme,n),legend:t.legend}}));t.push({chartTitle:n.title,chartData:r})})),d.createElement(ut,{data:t})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.HorizontalBar.Stacked",t}(st),pt=n(147),gt=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return Object(H.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if("string"==typeof r){var o=Object(pt.h)(r);if(o)return o}else if("number"==typeof r)return r;return this.defaultValue},t.prototype.toJSON=function(e,t,n,r){n instanceof Date?r.serializeDate(t,this.name,n):"number"==typeof n&&r.serializeNumber(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueType:["number","string"],description:'Dates must be in the "YYYY-MM-DD" format',isArray:!1}},t}(U.i),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"LineChartValue"},t.xProperty=new gt(U.s.v1_5,"x",0),t.yProperty=new U.g(U.s.v1_5,"y"),t}(U.j),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return this.getValue(t.valuesProperty)},set:function(e){this.setValue(t.valuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"LineChartData"},t.valuesProperty=new U.k(U.s.v1_5,"values",(function(e){return new ht})),t.colorProperty=new _e(U.s.v1_5,"color"),t}(Le),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.dataProperty=new U.k(U.s.v1_5,"data",(function(e){return new ft})),t}(Ve),vt=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.LineChart}}))})),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return Ie.lineChartHeight},enumerable:!1,configurable:!0}),t.prototype.renderChartComponent=function(){var e,t=this;if(0===this.data.length||0===this.data[0].values.length)return null;var n=this.data.map((function(e,n){return{legend:e.legend,data:e.values.map((function(e){return{x:e.x,y:e.y}})),color:e.color?Ie.getWellKnownColor(e.color):Ie.getColor(t.colorSet,t.theme,n)}})),r={chartTitle:this.title,lineChartData:n};return d.createElement(vt,{data:r,height:this.chartHeight,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Line",t}(mt);!function(e){e[e.Percentage=0]="Percentage",e[e.Fraction=1]="Fraction"}(tt||(tt={}));var yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"GaugeChartLegend"},t.sizeProperty=new U.g(U.s.v1_5,"size",0),t.legendProperty=new U.n(U.s.v1_5,"legend"),t.colorProperty=new _e(U.s.v1_5,"color"),t}(U.j),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subLabel",{get:function(){return this.getValue(t.subLabelProperty)},set:function(e){this.setValue(t.subLabelProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showMinMax",{get:function(){return this.getValue(t.showMinMaxProperty)},set:function(e){this.setValue(t.showMinMaxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showLegend",{get:function(){return this.getValue(t.showLegendProperty)},set:function(e){this.setValue(t.showLegendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){return this.getValue(t.segmentsProperty)},set:function(e){this.setValue(t.segmentsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueFormat",{get:function(){return this.getValue(t.valueFormatProperty)},set:function(e){this.setValue(t.valueFormatProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return Ie.gaugeChartHeight+(this.showLegend?20:0)+(this.title?20:0)},enumerable:!1,configurable:!0}),t.minProperty=new U.g(U.s.v1_5,"min",0),t.maxProperty=new U.g(U.s.v1_5,"max"),t.subLabelProperty=new U.n(U.s.v1_5,"subLabel"),t.showMinMaxProperty=new U.b(U.s.v1_5,"showMinMax",!0),t.showLegendProperty=new U.b(U.s.v1_5,"showLegend",!0),t.segmentsProperty=new U.k(U.s.v1_5,"segments",(function(e){return new yt})),t.valueProperty=new U.g(U.s.v1_5,"value",0),t.valueFormatProperty=new U.e(U.s.v1_5,"valueFormat",tt,tt.Percentage),t}(De),Ot=d.lazy((function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2789)).then((function(e){return{default:e.GaugeChart}}))})),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(H.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n=this.segments.map((function(e,n){var r;return{legend:null!==(r=e.legend)&&void 0!==r?r:"",size:e.size,color:t.colorSet?Ie.getColor(t.colorSet,t.theme,n):Ie.getWellKnownColor(e.color)}}));return d.createElement(Ot,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,segments:n,chartTitle:this.title,sublabel:this.subLabel,chartValueFormat:this.valueFormat===tt.Percentage?"percentage":"fraction",chartValue:this.value,hideMinMax:!this.showMinMax,hideLegend:!this.showLegend,minValue:this.min,maxValue:this.max})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Gauge",t}(Ct);var Et=n(1814),xt=n(3366),It=n(3360),wt=n(3362),Tt=n(1817),kt=n(3364),jt=n(3365),Pt=n(139),At=n(976),_t=n(2160);class Dt{}Dt.basicInputAppearance="outline",Dt.comboboxAppearance="outline",Dt.textareaAppearance="outline",Dt.numberInputAppearance="outline",Dt.timeInputAppearance="outline",Dt.destructiveActionButton=Object.assign(Object.assign({backgroundColor:Pt.a.colorStatusDangerBackground3,color:Pt.a.colorNeutralForegroundOnBrand},At.a.borderColor(Pt.a.colorStatusDangerBackground3)),{"&:hover":Object.assign({backgroundColor:Pt.a.colorStatusDangerBackground3Hover,color:Pt.a.colorNeutralForegroundOnBrand},At.a.borderColor(Pt.a.colorStatusDangerBackground3Hover)),"&:focus:active":Object.assign({backgroundColor:Pt.a.colorStatusDangerBackground3Pressed,color:Pt.a.colorNeutralForegroundOnBrand},At.a.borderColor(Pt.a.colorStatusDangerBackground3Pressed))});const Lt={width:"100%",minWidth:"0"},Mt=Object(_t.a)({textInput:Object.assign(Object.assign({},Lt),Dt.textInput),multilineTextInput:Object.assign(Object.assign(Object.assign({},Lt),{height:"90px"}),Dt.multilineTextInput),multilineTextInputTextArea:Object.assign({},Lt),passwordInputHideRevealButton:{"::-ms-reveal":{display:"none"}},dateInput:Object.assign(Object.assign({},Lt),Dt.dateInput),numberInput:Object.assign(Object.assign({},Lt),Dt.numberInput),timeInput:Object.assign(Object.assign({},Lt),Dt.timeInput),toggleInput:Object.assign(Object.assign({},Lt),Dt.toggleInput),toggleInputLabelNoWrap:Object.assign(Object.assign({},At.a.overflow("hidden")),{whiteSpace:"nowrap",textOverflow:"ellipsis"}),compactChoiceSetInput:Object.assign(Object.assign({},Lt),Dt.compactChoiceSetInput),actionButton:Object.assign({minWidth:"0"},Dt.actionButton),destructiveActionButton:Object.assign({},Dt.destructiveActionButton),inlineActionButton:Object.assign({minWidth:"0",flexShrink:0,flexGrow:0,flexBasis:"auto"},Dt.actionButton)});class Bt extends Te.b{constructor(){super(...arguments),this._buttonRef=d.createRef()}render(e,t){let n;switch(this.action.style){case V.e.Positive:n=V.e.Positive;break;case V.e.Destructive:n=V.e.Destructive;break;default:n=this.action.isExpanded||this.action.isInSubCard||t.forcePrimary?V.e.Positive:V.e.Default}return d.createElement(Rt,Object.assign({buttonProps:e},t,{style:n,isInline:t.isInline,buttonRef:this._buttonRef,menuItems:this.menuItems,isExpanded:this.action.isExpanded}))}get domElement(){return this._buttonRef.current}}const Rt=e=>{const t=Mt(),n=e.isInline?t.inlineActionButton:t.actionButton,r=e.style===V.e.Destructive?Object(c.a)(n,t.destructiveActionButton):n;if(!e.menuItems||0===e.menuItems.length)return d.createElement(Et.a,Object.assign({},e.buttonProps,{className:r,ref:e.buttonRef,appearance:e.style===V.e.Positive?"primary":void 0,onClick:e.onClick,"aria-expanded":e.isExpanded}),e.renderedContent);const o=e.menuItems.map((e=>{var t;return d.createElement(xt.a,{key:e.key,disabled:e.disabled,title:e.tooltip,onClick:()=>{e.onClick&&e.onClick()}},null!==(t=e.renderedContent)&&void 0!==t?t:e.text)}));return d.createElement(It.a,null,d.createElement(wt.a,{disableButtonEnhancement:!0},d.createElement(Tt.a,Object.assign({},e.buttonProps,{className:t.actionButton,ref:e.buttonRef,appearance:e.style===V.e.Positive?"primary":void 0,menuIcon:e.renderedContent}))),d.createElement(kt.a,null,d.createElement(jt.a,null,o)))};var Ft=n(1748),Nt=n(3408),Ht=n(3409),Ut=n(3410),Vt=n(3407),zt=n(3405),Gt=n(3406);const Wt=(e,t,n,r,o)=>Object(H.__awaiter)(void 0,void 0,void 0,(function*(){r(n({searchString:e,dataQuery:t,onDataQueryCompleted:e=>{o(e),r(!1)}}))})),Qt=(e,t)=>{let n;return function(...r){n&&clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}},qt=e=>{const{title:t,value:n}=e,r=Object(H.__rest)(e,["title","value"]);return d.createElement(zt.a,Object.assign({key:t+n,text:t,value:n},r),t)},Kt=d.forwardRef(((e,t)=>{const{staticChoices:n,choicesData:r,internalId:o,placeholder:i,ariaLabelledBy:a,isRequired:s,valueChanged:l,onDataQuery:c,value:u}=e,p=Mt(),g=e=>e.map(((e,t)=>e.title&&e.value?d.createElement(qt,{key:t,title:e.title,value:e.value}):null)).filter((e=>null!==e)),[h,f]=d.useState(0),[m,v]=d.useState(""),[b,y]=d.useState(!1),C=d.useCallback((e=>{y(e)}),[y]),O=((e,t,n,r)=>{const[o,i]=d.useState(void 0),a=d.useCallback((e=>{i(e)}),[i]),s=d.useCallback((e=>{t(e)}),[t]),l=d.useMemo((()=>Qt(Wt,250)),[]);return d.useEffect((()=>{e&&r&&n&&l(e,n,r,s,a)}),[e,n,r,s,a,l]),o})(m,C,r,c);let S=[];O&&(null==O?void 0:O.query)===m&&(S=g((e=>{const t=[];return e&&Array.isArray(e)&&e.map((e=>{e.title&&e.value&&t.push(new Ft.a(e.title,e.value))})),t})(O.data)));let E=null;b?E=d.createElement(Gt.a,{label:e.strings.loadingResults}):(null==O?void 0:O.error)&&(E=d.createElement(Gt.a,{label:e.strings.errorLoadingResults}));const x=d.useRef(void 0);d.useEffect((()=>{u!==x.current&&(u!==x.current&&(x.current=u),null!=u&&0!==u.length?v(u.join(",")):v(""))}),[u]);const I={id:o,appearance:Dt.comboboxAppearance,className:p.compactChoiceSetInput,placeholder:i,multiselect:!1,selectedOptions:u,value:m,onOptionSelect:(e,t)=>{l(t.selectedOptions)},onChange:e=>{const t=e.target.value.trim();v(t)},"aria-label":i,"aria-labelledby":a,"aria-required":s,onOpenChange(e,t){t.open&&f(e.currentTarget.clientWidth)},input:{style:{minWidth:0}},listbox:{style:{maxHeight:"200px",width:`${h}px`}}};return d.createElement(Vt.a,Object.assign({ref:t},I),(()=>{if(m){const e=n.filter((e=>e.title&&0===e.title.toLowerCase().indexOf(m.toLowerCase())));return g(e)}return[]})(),S,E)}));Kt.displayName="DynamicTypeahead";class Yt{}Yt.passwordInputHidePasswordAriaLabel={key:"passwordInputHidePasswordAriaLabel",defaultValue:"Hide password"},Yt.passwordInputRevealPasswordAriaLabel={key:"passwordInputRevealPasswordAriaLabel",defaultValue:"Reveal password"},Yt.dateInputDefaultPlaceholder={key:"dateInputDefaultPlaceholder",defaultValue:"Select a date..."},Yt.timeInputDefaultPlaceholder={key:"timeInputDefaultPlaceholder",defaultValue:"Select a time..."},Yt.noResults={key:"noResults",defaultValue:"No results"},Yt.selectMultipleOptions={key:"selectMultipleOptions",defaultValue:"Select multiple options"},Yt.selectAnOption={key:"selectAnOption",defaultValue:"Select an option"},Yt.comboBoxClearButtonAriaLabel={key:"comboBoxClearButtonAriaLabel",defaultValue:"Clear"},Yt.loadingResults={key:"loadingResults",defaultValue:"Loading..."},Yt.errorLoadingResults={key:"errorLoadingResults",defaultValue:"Results couldn't be loaded"},Yt.sliderInputCurrentValue={key:"sliderInputCurrentValue",defaultValue:"Current value: {{value}}"},Yt.checkboxGroupLabel={key:"checkboxGroupLabel",defaultValue:"Select at least one"},Yt.january={key:"january",defaultValue:"January"},Yt.february={key:"february",defaultValue:"February"},Yt.march={key:"march",defaultValue:"March"},Yt.april={key:"april",defaultValue:"April"},Yt.may={key:"may",defaultValue:"May"},Yt.june={key:"june",defaultValue:"June"},Yt.july={key:"july",defaultValue:"July"},Yt.august={key:"august",defaultValue:"August"},Yt.september={key:"september",defaultValue:"September"},Yt.october={key:"october",defaultValue:"October"},Yt.november={key:"november",defaultValue:"November"},Yt.december={key:"december",defaultValue:"December"},Yt.januaryShort={key:"januaryShort",defaultValue:"Jan"},Yt.februaryShort={key:"februaryShort",defaultValue:"Feb"},Yt.marchShort={key:"marchShort",defaultValue:"Mar"},Yt.aprilShort={key:"aprilShort",defaultValue:"Apr"},Yt.mayShort={key:"mayShort",defaultValue:"May"},Yt.juneShort={key:"juneShort",defaultValue:"Jun"},Yt.julyShort={key:"julyShort",defaultValue:"Jul"},Yt.augustShort={key:"augustShort",defaultValue:"Aug"},Yt.septemberShort={key:"septemberShort",defaultValue:"Sep"},Yt.octoberShort={key:"octoberShort",defaultValue:"Oct"},Yt.novemberShort={key:"novemberShort",defaultValue:"Nov"},Yt.decemberShort={key:"decemberShort",defaultValue:"Dec"},Yt.sunday={key:"sunday",defaultValue:"Sunday"},Yt.monday={key:"monday",defaultValue:"Monday"},Yt.tuesday={key:"tuesday",defaultValue:"Tuesday"},Yt.wednesday={key:"wednesday",defaultValue:"Wednesday"},Yt.thursday={key:"thursday",defaultValue:"Thursday"},Yt.friday={key:"friday",defaultValue:"Friday"},Yt.saturday={key:"saturday",defaultValue:"Saturday"},Yt.sundayShort={key:"sundayShort",defaultValue:"Sun"},Yt.mondayShort={key:"mondayShort",defaultValue:"Mon"},Yt.tuesdayShort={key:"tuesdayShort",defaultValue:"Tue"},Yt.wednesdayShort={key:"wednesdayShort",defaultValue:"Wed"},Yt.thursdayShort={key:"thursdayShort",defaultValue:"Thu"},Yt.fridayShort={key:"fridayShort",defaultValue:"Fri"},Yt.saturdayShort={key:"saturdayShort",defaultValue:"Sat"},Yt.calendarWeekNumberFormatString={key:"calendarWeekNumberFormatString",defaultValue:"Week number {0}"},Yt.calendarPreviousMonthAriaLabel={key:"calendarPreviousMonthAriaLabel",defaultValue:"Previous month"},Yt.calendarNextMonthAriaLabel={key:"calendarNextMonthAriaLabel",defaultValue:"Next month"},Yt.calendarGoToToday={key:"calendarGoToToday",defaultValue:"Go to today"};const Zt=d.forwardRef(((e,t)=>{const n=Mt(),r=new Set(e.choices.filter((e=>e.isSelected)).map((e=>e.value))),o=e.localizeString(Yt.checkboxGroupLabel);return d.createElement("div",{id:e.internalId,ref:t,style:{display:"flex",flexDirection:"column",overflow:"hidden"},"aria-label":e.isRequired?o:""},e.choices.map(((t,o)=>d.createElement(Nt.a,{key:o,id:`${o}`,className:n.toggleInput,label:{className:e.wrap?void 0:n.toggleInputLabelNoWrap,children:t.title},checked:t.isSelected,input:{"aria-label":t.title},onChange:(n,o)=>{"boolean"==typeof o.checked&&(o.checked?r.add(t.value):r.delete(t.value),e.valueChanged([...r.values()]))},"aria-labelledby":`${e.ariaLabelledBy} ${o}`}))))}));Zt.displayName="CheckboxGroupComponent";const Jt=d.forwardRef(((e,t)=>d.createElement(Ht.a,{id:e.internalId,ref:t,onChange:(t,n)=>{e.valueChanged(n.value)},value:e.value,"aria-label":e.label,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},e.choices.map(((e,t)=>d.createElement(Ut.a,{key:t,value:e.value,label:e.title}))))));Jt.displayName="RadioGroupComponent";const Xt=d.forwardRef(((e,t)=>{const n=Mt(),r=e.choices.filter((e=>e.isSelected)).map((e=>e.value)),[o,i]=d.useState(e.choices),a=d.useMemo((()=>{const t=[];return r.forEach((n=>{const r=e.choices.find((e=>e.value===n));r&&t.push(r)})),t.map((e=>e.title)).join(", ")}),[e.choices,r]),[s,l]=d.useState(a);d.useEffect((()=>{l(a)}),[a]);const c=()=>{l(""),i(e.choices)},u=()=>{l(a)},p=t=>{if(e.isFiltered){const n=e.choices.filter((e=>e.title.toLowerCase().includes(t.target.value.toLowerCase())));i(n)}l(t.target.value)},g={id:e.internalId,appearance:Dt.comboboxAppearance,className:n.compactChoiceSetInput,placeholder:e.placeholder,multiselect:e.isMultiSelect,onOptionSelect:(t,n)=>{e.valueChanged(n.selectedOptions)},selectedOptions:r,onInput:p,value:s,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired,input:{style:{minWidth:0}}};return(e.isFiltered||e.isMultiSelect)&&(g.onChange=p,g.onFocus=c,g.onBlur=u),d.createElement(Vt.a,Object.assign({ref:t},g),o.map(((e,t)=>d.createElement(zt.a,{key:t,value:e.value},e.title))),0===o.length&&e.isFiltered?d.createElement(Gt.a,{label:e.strings.noResults}):null)}));function $t(e,t=["radio","checkbox"]){for(let n=0;n<e.children.length;n++){const r=e.children[n];if(r instanceof HTMLInputElement){if("INPUT"===r.tagName&&t.includes(r.type))return r}else{const e=$t(r);if(e)return e}}}Xt.displayName="ComboboxComponent";class en extends Ft.b{constructor(){super(...arguments),this._inputRef=d.createRef(),this.checkboxLabelId=Object(pt.d)(),this.onDataQueryRequest=e=>this.dataQuery(e)}focus(){if(this._inputRef.current){if("expanded"!==this.style)return this._inputRef.current.focus(),!0;{const e=$t(this._inputRef.current);if(e)return e.focus(),!0}}return!1}getAllLabelIds(){const e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.checkboxLabelId,this.errorId),e}isValid(){if(""===this.value||void 0===this.value||this.isDynamicTypeahead())return!0;const e=this.isMultiSelect?this.value.split(this.hostConfig.choiceSetInputValueSeparator):[this.value],t=this.choices.map((e=>e.value));for(const n of e)if(!t.includes(n))return!1;return!0}renderInputControl(){this.ensureValidValue();const e=void 0!==this.value?this.value:this.defaultValue,t=e?this.isMultiSelect?e.split(this.hostConfig.choiceSetInputValueSeparator):[e]:[],n=this.choices.map(((e,n)=>{var r,o;return{title:null!==(r=e.title)&&void 0!==r?r:n.toString(),value:null!==(o=e.value)&&void 0!==o?o:n.toString(),isSelected:!!e.value&&t.includes(e.value)}}));return this.isDynamicTypeahead()?this.renderAsDynamicTypeahead(t):"compact"===this.style||"filtered"===this.style?this.renderAsComboBox(n,t):this.isMultiSelect?this.renderAsCheckboxGroup(n,t):this.renderAsRadioGroup(n)}isDynamicTypeahead(){var e;return void 0!==(null===(e=this.choicesData)||void 0===e?void 0:e.dataset)}ensureValidValue(){var e;if(this.isDynamicTypeahead())return;const t=null!==(e=this.value)&&void 0!==e?e:this.defaultValue;if(t){const e=this.isMultiSelect?t.split(this.hostConfig.choiceSetInputValueSeparator):[t],n=this.choices.map((e=>e.value)),r=[];for(const t of e)n.indexOf(t)>=0&&r.push(t);this._value=r.length>0?r.join(this.hostConfig.choiceSetInputValueSeparator):void 0}}renderAsDynamicTypeahead(e){return d.createElement(Kt,{ref:this._inputRef,staticChoices:this.choices,choicesData:this.choicesData,internalId:this.internalId,placeholder:this.placeholder,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()},onDataQuery:this.onDataQueryRequest,isMultiSelect:this.isMultiSelect,value:e,strings:{dropdownPlaceholder:this.localizeString(Yt.selectAnOption),noResults:this.localizeString(Yt.noResults),loadingResults:this.localizeString(Yt.loadingResults),errorLoadingResults:this.localizeString(Yt.errorLoadingResults)}})}renderAsComboBox(e,t){return d.createElement(Xt,{ref:this._inputRef,internalId:this.internalId,choices:e,value:t,isMultiSelect:this.isMultiSelect,isFiltered:"filtered"===this.style,placeholder:this.placeholder,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),strings:{dropdownPlaceholder:this.isMultiSelect?this.localizeString(Yt.selectMultipleOptions):this.localizeString(Yt.selectAnOption),noResults:this.localizeString(Yt.noResults),clearButtonAriaLabel:this.localizeString(Yt.comboBoxClearButtonAriaLabel)},valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()}})}renderAsRadioGroup(e){var t;return d.createElement(Jt,{ref:this._inputRef,internalId:this.internalId,choices:e,value:null!==(t=this.value)&&void 0!==t?t:"",isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{this.valueChanged(e),this.updateLayout()},wrap:this.wrap,localizeString:(e,t)=>this.localizeString(e,t)})}renderAsCheckboxGroup(e,t){return d.createElement(Zt,{ref:this._inputRef,internalId:this.internalId,choices:e,value:t,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()},wrap:this.wrap,label:this.label,localizeString:(e,t)=>this.localizeString(e,t)})}}var tn=n(1457),nn=n(773),rn=n(2155),on=n(1543);const an=Object(on.a)({root:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"auto 1fr",rowGap:Pt.a.spacingHorizontalXS,columnGap:Pt.a.spacingHorizontalS},icon:{alignSelf:"baseline",marginTop:"1px",gridRowStart:1,gridRowEnd:3}}),sn=e=>{const t=an();return d.createElement(rn.a,Object.assign({},e,{className:t.root,icon:e.icon&&"string"==typeof e.icon?d.createElement("span",{className:t.icon},e.icon):e.icon}))};class ln extends U.j{get name(){return this.getValue(ln.nameProperty)}set name(e){this.setValue(ln.nameProperty,e)}get size(){return this.getValue(ln.sizeProperty)}set size(e){this.setValue(ln.sizeProperty,e)}get style(){return this.getValue(ln.styleProperty)}set style(e){this.setValue(ln.styleProperty,e)}get color(){return this.getValue(ln.colorProperty)}set color(e){this.setValue(ln.colorProperty,e)}getSchemaKey(){return"IconInfo"}constructor(e,t,n,r){super(),this.name=e,void 0!==t&&(this.size=t),void 0!==n&&(this.style=n),void 0!==r&&(this.color=r)}render(e){var t;return d.createElement(tn.a,{name:null!==(t=this.name)&&void 0!==t?t:cn.defaultIconName,iconSize:this.size,iconStyle:this.style,iconColor:this.color?Object(pt.l)(e.foregroundColors.getColorDefinition(this.color).default):void 0})}}ln.nameProperty=new U.n(U.s.v1_5,"name"),ln.sizeProperty=new U.e(U.s.v1_5,"size",V.k,V.k.Small),ln.styleProperty=new U.e(U.s.v1_5,"style",V.l,V.l.Regular),ln.colorProperty=new U.e(U.s.v1_5,"color",V.v,V.v.Default);class cn extends Te.d{static getDefaultIcon(){return cn._defaultIcon||(cn._defaultIcon=new ln("Info",V.k.Small,V.l.Regular,V.v.Default)),cn._defaultIcon}get icon(){return this.getValue(cn.iconProperty)}set icon(e){this.setValue(cn.iconProperty,e)}get title(){return this.getValue(cn.titleProperty)}set title(e){this.setValue(cn.titleProperty,e)}get badge(){return this.getValue(cn.badgeProperty)}set badge(e){this.setValue(cn.badgeProperty,e)}get description(){return this.getValue(cn.descriptionProperty)}set description(e){this.setValue(cn.descriptionProperty,e)}get selectAction(){return this.getValue(cn.selectActionProperty)}set selectAction(e){this.setValue(cn.selectActionProperty,e)}internalRender(e){var t,n;const r={icon:(null!==(t=this.icon)&&void 0!==t?t:cn.getDefaultIcon()).render(this.getEffectiveStyleDefinition()),category:null!==(n=this.title)&&void 0!==n?n:"",prompt:this.description,badge:this.badge,style:{}};return this.selectAction&&this.hostConfig.supportsInteractivity&&(r.onKeyPress=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.stopPropagation(),this.selectAction.execute())},r.onClick=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),this.selectAction.execute())},this.selectAction.setupElementForAccessibility(r,!1,!1)),d.createElement(sn,Object.assign({},r))}getJsonTypeName(){return"CompoundButton"}}cn.defaultIconName="Info",cn.iconProperty=new U.l(U.s.v1_5,"icon",(()=>new ln),!0),cn.badgeProperty=new U.n(U.s.v1_5,"badge"),cn.titleProperty=new U.n(U.s.v1_5,"title"),cn.descriptionProperty=new U.n(U.s.v1_5,"description"),cn.selectActionProperty=new nn.a(U.s.v1_5,"selectAction",["Action.ShowCard"]);var un=n(2101),dn=n(3511);const pn=d.forwardRef(((e,t)=>{var n;const r=Mt();return d.createElement(dn.a,{id:e.internalId,strings:e.strings,appearance:Dt.basicInputAppearance,className:r.dateInput,onSelectDate:t=>{e.valueChanged(null!=t?t:void 0)},allowTextInput:!0,value:null!==(n=e.value)&&void 0!==n?n:null,placeholder:e.placeholder,showGoToToday:!1,showMonthPickerAsOverlay:!0,formatDate:e.formatDate,input:{ref:t,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired}})}));pn.displayName="DateInputComponent";class gn extends un.a{constructor(){super(...arguments),this._inputRef=d.createRef()}getStrings(){return{months:[this.localizeString(Yt.january),this.localizeString(Yt.february),this.localizeString(Yt.march),this.localizeString(Yt.april),this.localizeString(Yt.may),this.localizeString(Yt.june),this.localizeString(Yt.july),this.localizeString(Yt.august),this.localizeString(Yt.september),this.localizeString(Yt.october),this.localizeString(Yt.november),this.localizeString(Yt.december)],shortMonths:[this.localizeString(Yt.januaryShort),this.localizeString(Yt.februaryShort),this.localizeString(Yt.marchShort),this.localizeString(Yt.aprilShort),this.localizeString(Yt.mayShort),this.localizeString(Yt.juneShort),this.localizeString(Yt.julyShort),this.localizeString(Yt.augustShort),this.localizeString(Yt.septemberShort),this.localizeString(Yt.octoberShort),this.localizeString(Yt.novemberShort),this.localizeString(Yt.decemberShort)],days:[this.localizeString(Yt.sunday),this.localizeString(Yt.monday),this.localizeString(Yt.tuesday),this.localizeString(Yt.wednesday),this.localizeString(Yt.thursday),this.localizeString(Yt.friday),this.localizeString(Yt.saturday)],shortDays:[this.localizeString(Yt.sundayShort),this.localizeString(Yt.mondayShort),this.localizeString(Yt.tuesdayShort),this.localizeString(Yt.wednesdayShort),this.localizeString(Yt.thursdayShort),this.localizeString(Yt.fridayShort),this.localizeString(Yt.saturdayShort)],weekNumberFormatString:this.localizeString(Yt.calendarWeekNumberFormatString),prevMonthAriaLabel:this.localizeString(Yt.calendarPreviousMonthAriaLabel),nextMonthAriaLabel:this.localizeString(Yt.calendarNextMonthAriaLabel),goToToday:this.localizeString(Yt.calendarGoToToday)}}focus(){return!!this._inputRef.current&&(this._inputRef.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Yt.dateInputDefaultPlaceholder),t=e=>e?this.formatDate(e):"";return d.createElement(pn,{strings:this.getStrings(),internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},value:this.value,placeholder:e,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,formatDate:e=>t(e),ref:this._inputRef})}}var hn=n(2694),fn=n(3422);const mn=d.forwardRef(((e,t)=>{const n=Mt();return d.createElement(fn.a,{id:e.internalId,appearance:Dt.numberInputAppearance,className:n.numberInput,ref:t,placeholder:e.placeholder,value:void 0!==e.value?e.value:null,min:e.min,max:e.max,precision:10,input:{"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:(t,n)=>{let r;if(void 0===n.value){if(n.displayValue){const t=Number(n.displayValue);isNaN(t)||(r=void 0!==e.min&&t<e.min?e.min:void 0!==e.max&&t>e.max?e.max:t)}}else r=null!==n.value?n.value:void 0;e.valueChanged(r)}})}));mn.displayName="NumberInputComponent";class vn extends hn.a{constructor(){super(...arguments),this._inputRef=d.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}renderInputControl(){return d.createElement(mn,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},placeholder:this.placeholder,value:this.value,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,min:this.min,max:this.max,ref:this._inputRef})}}var bn,yn,Cn,On=n(3553);!function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large"}(bn||(bn={})),function(e){e[e.Neutral=0]="Neutral",e[e.Marigold=1]="Marigold"}(yn||(yn={})),function(e){e[e.Default=0]="Default",e[e.Compact=1]="Compact"}(Cn||(Cn={}));const Sn={[bn.Medium]:"medium",[bn.Large]:"large"},En={[yn.Neutral]:"neutral",[yn.Marigold]:"marigold"};class xn extends Te.d{get value(){return this.getValue(xn.valueProperty)}set value(e){this.setValue(xn.valueProperty,e)}get count(){return this.getValue(xn.countProperty)}set count(e){this.setValue(xn.countProperty,e)}get max(){return this.getValue(xn.maxProperty)}set max(e){this.setValue(xn.maxProperty,e)}get size(){return this.getValue(xn.sizeProperty)}set size(e){this.setValue(xn.sizeProperty,e)}get color(){return this.getValue(xn.colorProperty)}set color(e){this.setValue(xn.colorProperty,e)}get style(){return this.getValue(xn.styleProperty)}set style(e){this.setValue(xn.styleProperty,e)}internalRender(e){const t=this.max>0?Math.min(this.max,xn.maxMax):xn.defaultMax;return d.createElement(On.a,{value:this.value,max:t,size:Sn[this.size],color:En[this.color],count:this.count,compact:this.style===Cn.Compact})}getJsonTypeName(){return"Rating"}}xn.defaultMax=5,xn.maxMax=5,xn.valueProperty=new U.g(U.s.v1_5,"value"),xn.countProperty=new U.g(U.s.v1_5,"count"),xn.maxProperty=new U.g(U.s.v1_5,"max",xn.defaultMax),xn.sizeProperty=new U.e(U.s.v1_5,"size",bn,bn.Large),xn.colorProperty=new U.e(U.s.v1_5,"color",yn,yn.Neutral),xn.styleProperty=new U.e(U.s.v1_5,"style",Cn,Cn.Default);var In=n(693),wn=n(3529);const Tn=d.forwardRef(((e,t)=>d.createElement(wn.a,{ref:t,step:e.step,id:e.internalId,max:e.max,size:e.size,color:e.color,value:e.value,onChange:(t,n)=>{e.valueChanged(n.value)}})));Tn.displayName="RatingInputComponent";const kn={[bn.Medium]:"medium",[bn.Large]:"large"},jn={[yn.Neutral]:"neutral",[yn.Marigold]:"marigold"};class Pn extends In.a{constructor(){super(...arguments),this._inputRef=d.createRef()}get defaultValue(){return this.getValue(Pn.valueProperty)}set defaultValue(e){this.setValue(Pn.valueProperty,e)}get max(){return this.getValue(Pn.maxProperty)}set max(e){this.setValue(Pn.maxProperty,e)}get allowHalfSteps(){return this.getValue(Pn.allowHalfStepsProperty)}set allowHalfSteps(e){this.setValue(Pn.allowHalfStepsProperty,e)}get size(){return this.getValue(Pn.sizeProperty)}set size(e){this.setValue(Pn.sizeProperty,e)}get color(){return this.getValue(Pn.colorProperty)}set color(e){this.setValue(Pn.colorProperty,e)}focus(){var e;if(null===(e=this._inputRef)||void 0===e?void 0:e.current){const e=this._inputRef.current,t=e.querySelector("input[type=radio]:checked")||e.querySelector("input[type=radio]:enabled");if(t)return null==t||t.focus(),!0}return!1}internalParse(e,t){super.internalParse(e,t),this.max>0&&this._value>this.max&&(this._value=this.max)}renderInputControl(){const e=this.max>0?Math.min(this.max,Pn.maxMax):Pn.defaultMax;return d.createElement(Tn,{ref:this._inputRef,internalId:this.internalId,isRequired:this.isRequired,max:e,step:this.allowHalfSteps?.5:1,size:kn[this.size],color:jn[this.color],value:this.value,valueChanged:e=>{this.valueChanged(e),this.updateLayout()}})}getJsonTypeName(){return"Input.Rating"}isSet(){return void 0!==this.value&&!isNaN(this.value)}isValid(){return void 0===this.value?!this.isRequired:this.isValidValue(this.value)}isValidValue(e){let t=!0;return void 0!==this.max&&(t=t&&e<=this.max),t}get value(){return this._value}set value(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)}}Pn.defaultMax=5,Pn.maxMax=5,Pn.valueProperty=new U.g(U.s.v1_5,"value"),Pn.maxProperty=new U.g(U.s.v1_5,"max",Pn.defaultMax),Pn.allowHalfStepsProperty=new U.b(U.s.v1_5,"allowHalfSteps",!1),Pn.sizeProperty=new U.e(U.s.v1_5,"size",bn,bn.Large),Pn.colorProperty=new U.e(U.s.v1_5,"color",yn,yn.Neutral);var An=n(2695),_n=n(3424),Dn=n(3425),Ln=n(2853);const Mn=d.forwardRef(((e,t)=>{var n,r;const[o,i]=d.useState(!1),a=Mt(),s=(t,n)=>{e.valueChanged(n.value)},l=t=>{t.ctrlKey&&"Enter"===t.key&&e.inlineAction&&e.inlineAction.isEffectivelyEnabled()&&e.inlineAction.execute()},c=e.maxLength&&e.maxLength>0?e.maxLength:void 0,u=e.style===V.o.Password;if(!e.isMultiline){const r=u?o?"text":"password":V.o[e.style].toLowerCase();let p;if(u){let t,n;o?(t=d.createElement(Ln.d,null),n=e.strings.passwordInputIconHideAriaLabel):(t=d.createElement(Ln.c,null),n=e.strings.passwordInputIconRevealAriaLabel);const r=()=>{i(!o)};p=d.createElement(Et.a,{icon:t,appearance:"transparent","aria-label":n,onClick:r})}const g=u?a.passwordInputHideRevealButton:void 0;return d.createElement(_n.a,{id:e.internalId,className:a.textInput,appearance:Dt.basicInputAppearance,type:r,ref:t,placeholder:e.placeholder,value:null!==(n=e.value)&&void 0!==n?n:"",maxLength:c,contentAfter:p,input:{className:g,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:s,onKeyDown:l})}return d.createElement(Dn.a,{id:e.internalId,className:a.multilineTextInput,appearance:Dt.textareaAppearance,ref:t,placeholder:e.placeholder,maxLength:c,value:null!==(r=e.value)&&void 0!==r?r:"",textarea:{className:a.multilineTextInputTextArea,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:s,onKeyDown:l})}));Mn.displayName="TextInputComponent";class Bn extends An.a{constructor(){super(...arguments),this._inputRef=d.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}internalParse(e,t){super.internalParse(e,t),this.style===V.o.Password&&this.isMultiline&&(this.style=V.o.Text)}renderInputControl(){return d.createElement(Mn,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},value:this.value,inlineAction:this.inlineAction,maxLength:this.maxLength,style:this.style,isMultiline:this.isMultiline,placeholder:this.placeholder,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,strings:{passwordInputIconHideAriaLabel:this.localizeString(Yt.passwordInputHidePasswordAriaLabel),passwordInputIconRevealAriaLabel:this.localizeString(Yt.passwordInputRevealPasswordAriaLabel)},ref:this._inputRef})}}var Rn=n(2103),Fn=n(838),Nn=n(3510);function Hn(e){return e?Object(Fn.b)(e):""}const Un=d.forwardRef(((e,t)=>{var n;const[r,o]=d.useState(Hn(e.value));d.useEffect((()=>{o(Hn(e.value))}),[e.value]);const i=Mt();return d.createElement(Nn.a,{id:e.internalId,className:i.timeInput,appearance:Dt.timeInputAppearance,ref:t,placeholder:e.placeholder,dateAnchor:Rn.b.referenceDate,selectedTime:e.value,value:r,startHour:null===(n=e.min)||void 0===n?void 0:n.getHours(),endHour:e.max?e.max.getHours()+1:void 0,freeform:!0,required:!1,input:{"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onInput:e=>{o(e.target.value)},onTimeChange:(t,n)=>{if("required-input"===n.errorType)o(""),e.valueChanged(void 0);else if(void 0!==n.errorType)o(Hn(e.value));else{let t=null!==n.selectedTime?n.selectedTime:void 0;void 0!==t&&(void 0!==e.min&&t<e.min?t=e.min:void 0!==e.max&&t>e.max&&(t=e.max)),o(Hn(t)),e.valueChanged(t)}}})}));Un.displayName="TimeInputComponent";class Vn extends Rn.a{constructor(){super(...arguments),this._inputRef=d.createRef()}focus(){var e,t;return!!(null===this._inputRef||void 0===e?void 0:e.current)&&(null===this._inputRef||void 0===t||t.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Yt.timeInputDefaultPlaceholder);return d.createElement(Un,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},placeholder:e,value:this.valueAsDate,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,min:this.minAsDate,max:this.maxAsDate,ref:this._inputRef})}}var zn=n(2696);const Gn=d.forwardRef(((e,t)=>{const n=Mt(),r=e.wrap?void 0:n.toggleInputLabelNoWrap;return d.createElement(Nt.a,{id:e.internalId,ref:t,className:n.toggleInput,label:{id:e.checkboxLabelId,className:r,children:e.title},checked:e.value,input:{"aria-label":e.title,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:(t,n)=>{"boolean"==typeof n.checked&&e.valueChanged(n.checked)}})}));Gn.displayName="ToggleInputComponent";class Wn extends zn.a{constructor(){super(...arguments),this._inputRef=d.createRef(),this.checkboxLabelId=Object(pt.d)()}focus(){return!!this._inputRef.current&&(this._inputRef.current.focus(),!0)}getAllLabelIds(){const e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.checkboxLabelId,this.errorId),e}renderInputControl(){return d.createElement(Gn,{internalId:this.internalId,checkboxLabelId:this.checkboxLabelId,ref:this._inputRef,title:this.title,value:this.value===this.valueOn,valueChanged:e=>{const t=e?this.valueOn:this.valueOff;this.valueChanged(t),this.updateLayout()},isRequired:this.isRequired,wrap:this.wrap,ariaLabelledBy:this.getAriaLabelledBy()})}}var Qn=n(262),qn=n(2164);class Kn extends Te.g{constructor(e,t,n){super(U.s.latest),this.setElementRegistry(e),this.setActionRegistry(t),this.forbiddenActionTypes=n}parseAction(e,t,n,r){return super.parseAction(e,t,this.forbiddenActionTypes,r)}}const Yn=["card-enableCharts","disableAdaptiveCardActionSubmit"];function Zn(e,t){var n;return Yn.includes(e)&&!!(null===(n=null==t?void 0:t.featureFlags)||void 0===n?void 0:n[e])}const Jn=d.forwardRef(((e,t)=>{const n=Mt(),[r,o]=d.useState(null);return d.createElement(d.Fragment,null,d.createElement(dn.a,{mountNode:r,id:e.internalId,appearance:Dt.basicInputAppearance,className:n.dateInput,onSelectDate:t=>{e.valueChanged(null!=t?t:void 0)},allowTextInput:!0,value:e.value,placeholder:e.placeholder,input:{ref:t,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired}}),d.createElement("div",{ref:o,id:"mount-node",style:{zIndex:1}}))}));Jn.displayName="DateInputComponent";class Xn extends un.a{constructor(){super(...arguments),this._inputRef=d.createRef()}focus(){return!!this._inputRef.current&&(this._inputRef.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Yt.dateInputDefaultPlaceholder);return d.createElement(Jn,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},value:this.value,placeholder:e,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,ref:this._inputRef})}}var $n=n(3509),er=n(839);const tr=d.forwardRef(((e,t)=>{var n;const r=Mt(),[o,i]=d.useState(null);return d.createElement(d.Fragment,null,d.createElement($n.a,{mountNode:o,id:e.internalId,className:r.timeInput,appearance:Dt.timeInputAppearance,ref:t,placeholder:e.placeholder,dateAnchor:Rn.b.referenceDate,selectedTime:e.value,value:void 0!==e.value?Object(er.b)(e.value):"",startHour:null===(n=e.min)||void 0===n?void 0:n.getHours(),endHour:e.max?e.max.getHours()+1:void 0,freeform:!1,input:{"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onTimeChange:(t,n)=>{let r=null!==n.selectedTime?n.selectedTime:void 0;void 0!==r&&(void 0!==e.min&&r<e.min?r=e.min:void 0!==e.max&&r>e.max&&(r=e.max)),e.valueChanged(r)},positioning:{position:"below",pinned:!0}}),d.createElement("div",{ref:i,id:"mount-node",style:{zIndex:1}}))}));tr.displayName="TimeInputComponent";class nr extends Rn.a{constructor(){super(...arguments),this._inputRef=d.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Yt.timeInputDefaultPlaceholder);return d.createElement(tr,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},placeholder:e,value:this.valueAsDate,ariaLabelledBy:this.getAriaLabelledBy(),isRequired:this.isRequired,min:this.minAsDate,max:this.maxAsDate,ref:this._inputRef})}}const rr="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+DQogIDxnIGlkPSJjYW52YXMiIG9wYWNpdHk9IjAiIGZpbGw9Im5vbmUiPg0KICAgIDxwYXRoIGQ9Ik0xNiwxNkgwVjBIMTZaIiBvcGFjaXR5PSIwIiBmaWxsPSJub25lIiAvPg0KICA8L2c+DQogIDxnIGlkPSJsZXZlbC0xIj4NCiAgICA8cGF0aCBkPSJNMTQuNSwyLjV2MTJIMS41VjIuNVoiIGZpbGw9IiMyMTIxMjEiIG9wYWNpdHk9IjAuMSIgLz4NCiAgICA8cGF0aCBkPSJNMTQuNSwySDEuNUwxLDIuNXYxMmwuNS41aDEzbC41LS41VjIuNVpNMTQsMTRIMlYzSDE0WiIgZmlsbD0iIzIxMjEyMSIgLz4NCiAgICA8cGF0aCBkPSJNMTIsNS41QTEuNSwxLjUsMCwxLDEsMTAuNSw0LDEuNSwxLjUsMCwwLDEsMTIsNS41WiIgZmlsbD0iIzk5NmYwMCIgLz4NCiAgICA8cGF0aCBkPSJNMTQsMTEuMDlWMTIuNWwtMi44MTktMi44Mkw4Ljk4OCwxMS44NzdIOC4yODFMNC44MTQsOC40MSwyLDExLjIyNVY5LjgxMUw0LjQ2MSw3LjM1aC43MDdsMy40NjYsMy40NjYsMi4xOTMtMi4xOTNoLjcwN1oiIGZpbGw9IiMwMDVkYmEiIC8+DQogIDwvZz4NCjwvc3ZnPg==",or=e=>{var t;const[n,r]=Object(d.useState)(rr),a=d.useMemo((()=>{var t;return new i.a(null===(t=e.serviceProvider)||void 0===t?void 0:t.telemetryService,o.h.GetImage,o.g.GetImageProxyUrl)}),[]);return d.useEffect((()=>{var t,n,o;const i=null===(t=null==e?void 0:e.imageAttr)||void 0===t?void 0:t.src;if(i){if(/^data:image\/[a-zA-Z+.-]+;base64,/.test(i))return r(i),void a.logMetricEnd({renderId:e.renderId,diagnosticsData:`cardId : ${e.cardId}, type: base64`});const t={url:i};null===(o=null===(n=e.serviceProvider)||void 0===n?void 0:n.hostService)||void 0===o||o.getImage(t).then((t=>{var n;r(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:rr),a.logMetricEnd({renderId:e.renderId,diagnosticsData:`cardId : ${e.cardId}, type: URL, Image url: ${null==t?void 0:t.url}`})})).catch((t=>{a.logMetricEndWithError({renderId:e.renderId,diagnosticsData:`GetImage request failed with error: ${t} cardId : ${e.cardId}`})}))}}),[]),d.createElement("img",{src:n,alt:"Adaptive card img",style:null===(t=e.imageAttr)||void 0===t?void 0:t.style})};function ir(e){const{content:t,runtime:n,hostConfig:r,uxRegistry:a,serviceProvider:s,cardId:l,renderId:c}=e,[u,p]=d.useState(d.createElement("div"));Object(Qn.a)();const g=d.useMemo((()=>new i.a(null==s?void 0:s.telemetryService,o.h.CardRender,o.g.M365CardParser)),[t,n,r,a]);return d.useEffect((()=>{try{const o=new we.a;Te.f.actionButtonRenderer=Bt,Te.f.defaultElements.register("Input.Text",(e=>new Bn),U.s.v1_0),Te.f.defaultElements.register("Input.Date",(e=>new Xn),U.s.v1_0),Te.f.defaultElements.register("Input.Time",(e=>new nr),U.s.v1_0),Te.f.defaultElements.register("Input.Number",(e=>new vn),U.s.v1_0),Te.f.defaultElements.register("Input.Toggle",(e=>new Wn),U.s.v1_0),Te.f.defaultElements.register("Input.ChoiceSet",(e=>new en),U.s.v1_0),Zn("card-enableCharts",r)&&(e=Te.f.defaultElements,Te.f.defaultActions,e.register(Fe.jsonTypeName,(function(){return new Fe})),e.register(He.jsonTypeName,(function(){return new He})),e.register(qe.jsonTypeName,(function(){return new qe})),e.register(Xe.jsonTypeName,(function(){return new Xe})),e.register(at.jsonTypeName,(function(){return new at})),e.register(dt.jsonTypeName,(function(){return new dt})),e.register(bt.jsonTypeName,(function(){return new bt})),e.register(St.jsonTypeName,(function(){return new St})));const i=(e,t,r)=>{r.didProcess=!0,r.output=d.createElement(qn.a,{components:{a:e=>{var{node:t}=e;const r=function(e,t){if(t.href&&"string"==typeof t.href){return function(e){return d.createElement("a",Object.assign({},e,{href:e.href,title:e.href,target:"_blank",rel:"noopener noreferrer",style:{color:"#1890f1"}}),e.children)}(Object.assign(Object.assign({},t),{onClick:n=>{e(t.href),n.preventDefault(),n.stopPropagation()},href:t.href}))}return d.createElement("span",null,t.children)}((e=>{!function(e,t){t&&(null==e||e.handleAnchorClicked(t))}(n,e)}),Object(H.__rest)(e,["node"]));return r},p:e=>{var{node:n}=e,r=Object(H.__rest)(e,["node"]);return function(e,t){return d.createElement("p",Object.assign({style:{overflow:e?void 0:"hidden",textOverflow:e?void 0:"ellipsis",margin:0}},t))}(t.wrap,r)}}},e)};o.onProcessMarkdown=i;const a=Zn("disableAdaptiveCardActionSubmit",r)?["Action.Submit"]:[],u=new Kn(Te.f.defaultElements,Te.f.defaultActions,a),h=JSON.parse(t);o.parse(h,u),o.onExecuteAction=null==n?void 0:n.handleAction,o.hostConfig=r,o.onRenderImage=(e,t)=>d.createElement(or,{image:e,cardId:l,renderId:c,imageAttr:t,serviceProvider:s});const f=o.getAllActions().filter(((e,t,n)=>t===n.findIndex((t=>t.key===e.key)))).length,m=d.createElement(o.Render,null);m&&p(m),g.logMetricEnd({diagnosticsData:`cardId : ${l}, actionCount: ${f}`})}catch(e){g.logMetricEndWithError({diagnosticsData:` Card parsing failed with error: ${e} cardId : ${l}`})}var e}),[t,n,r,a]),d.createElement("div",{id:"renderedAC"},u)}var ar=n(2870),sr=n(335);const lr=Object(ar.a)("nonAdaptiveCardStyles",Object(on.a)({cardStack:{marginLeft:"16px",marginRight:"16px",marginBottom:"16px",marginTop:"4px"},factName:{fontSize:"14px",fontWeight:600,color:Pt.a.colorNeutralForeground1},cardTitle:{fontSize:"18px",fontWeight:700,textAlign:"start",display:"block",whiteSpace:"pre-wrap",wordBreak:"break-word",textOverflow:"clip",textSizeAdjust:"100%",overflowWrap:"anywhere",color:Pt.a.colorNeutralForeground1},cardSubTitle:{fontSize:"12px",fontWeight:400,width:"fit-content",textAlign:"start",textSizeAdjust:"100%",wordBreak:"break-word",color:Pt.a.colorNeutralForeground3,display:"block",marginBottom:"16px"},cardText:{fontSize:"14px",width:"fit-content",textAlign:"start",wordBreak:"break-word",whiteSpace:"normal",color:Pt.a.colorNeutralForeground1,display:"block",marginBottom:"16px"},thumbnailImage:{flexShrink:"0 !important"},heroImage:{height:"100%",width:"100%",maxWidth:"fit-content"},cardButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},sr.a.overflow("hidden")),{textOverflow:"ellipsis",textAlign:"center",verticalAlign:"middle",cursor:"default",fontFamily:"'Segoe UI', sans-serif",fontSize:"14px",fontWeight:600}),sr.a.padding("4px 10px 5px 10px")),{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",height:"31px",marginTop:"1px"}),sr.a.border("1px solid")),{backgroundColor:Pt.a.colorNeutralBackground1}),sr.a.borderColor(Pt.a.colorNeutralStroke1)),{"&:active":{cursor:"pointer"}}),sr.a.borderRadius("4px")),{marginRight:"8px"}),buttonStack:{marginTop:"5px"}}));var cr=n(3378),ur=n(1532),dr=n.n(ur);class pr{constructor(){this.options={attributeCallbacks:fr()}}static instance(){return this.sInstance||(this.sInstance=new pr),this.sInstance}sanitizeHtml(e){return dr.a.sanitizeHtml(e,this.options)}}pr.sInstance=null;const gr=["width","height","style"],hr={IMG:{width:"auto",height:"auto",style:""}},fr=()=>{const e={};return gr.forEach((t=>{e[t]=mr(t)})),e},mr=e=>(t,n)=>n&&void 0!==hr[n.tagName]&&void 0!==hr[n.tagName][e]?hr[n.tagName][e]:vr(t),vr=e=>{const t=null==e?void 0:e.split(";").map((e=>-1===e.indexOf("font-size")?e:null)).join(";");return t},br=d.memo((e=>{const{content:t}=e,n=pr.instance().sanitizeHtml(t);return d.createElement("div",{dangerouslySetInnerHTML:{__html:n}})}));br.displayName="RichHtml";const yr=e=>{const{content:t,className:n}=e;return t?d.createElement(cr.a,{className:n},d.createElement(br,{content:t})):null},Cr=d.memo((e=>{const t=d.useRef(!1),{action:n,className:r,onClick:o}=e,[i,a]=d.useState(!1),s=d.useCallback((e=>t.current&&a(e)),[]);d.useEffect((()=>(t.current=!0,()=>{t.current=!1})),[]);const l=d.useCallback((e=>{try{e.stopPropagation(),s(!0),o(n)}catch(e){}finally{s(!1)}}),[o,n,s]);return d.createElement(Et.a,{className:r,disabled:i,onClick:l},n.title)}));Cr.displayName="CardButton";const Or=e=>{const{actions:t,buttonClassName:n,containerClassName:r,onClick:o,payload:i}=e,a=(s=t,Array.isArray(s)&&(null==s?void 0:s.length)>0?t.slice(0,6):t);var s;return d.createElement("div",{className:r},a.map(((e,t)=>d.createElement("span",null,d.createElement(Cr,{key:t,className:n,action:e,onClick:o,payload:i})))))};function Sr(e){const t=JSON.parse(e.content),n=t=>{var n;null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId})},r=lr(),o=t.images,i=t.text||"",a=null==o?void 0:o[0],s=t.tap,l=e=>{try{e.stopPropagation(),n(s)}catch(e){}},c={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==a?void 0:a.url,alt:null==a?void 0:a.alt},serviceProvider:e.serviceProvider};return d.createElement("div",{key:"heroCardView","data-tid":"hero-card",className:r.cardStack,onClick:s&&l,onKeyDown:s&&l,role:"presentation"},d.createElement(yr,{className:r.cardTitle,content:t.title}),d.createElement(yr,{className:r.cardSubTitle,content:t.subtitle}),a&&d.createElement("div",null,d.createElement(or,Object.assign({},c))),i&&d.createElement(yr,{className:r.cardText,content:i}),d.createElement(Or,{actions:t.buttons||[],buttonClassName:r.cardButton,containerClassName:r.buttonStack,onClick:n,payload:t}))}var Er,xr,Ir;!function(e){e.OpenUri="OpenUri",e.ViewAction="ViewAction",e.HttpPOST="HttpPOST",e.ActionCard="ActionCard"}(Er||(Er={})),function(e){e.Article="article",e.Avatar="avatar"}(xr||(xr={})),function(e){e.Android="android",e.Default="default",e.IOS="iOS",e.Windows="windows"}(Ir||(Ir={}));function wr(e){return Array.isArray(e)&&(null==e?void 0:e.length)>0}const Tr=e=>{switch(e["@type"]){case Er.OpenUri:return{type:"openUrl",title:e.name,value:kr(e)};case Er.ViewAction:return{type:"openUrl",title:e.name,value:null==e?void 0:e.target[0]};case Er.ActionCard:case Er.HttpPOST:default:return{type:"unknown",title:e.name,value:""}}},kr=e=>{var t;const n=null===(t=null==e?void 0:e.targets)||void 0===t?void 0:t.find((e=>e.os===Ir.Default));return(null==n?void 0:n.uri)||""},jr=d.memo((({actions:e,buttonClassName:t,containerClassName:n,onClick:r,payload:o})=>d.createElement("div",{className:n},e.map(((e,n)=>d.createElement("span",{key:n},d.createElement(Cr,{className:t,action:Tr(e),onClick:r,key:n,payload:o})))))));jr.displayName="O365ConnectorCardButtonContainer";const Pr=d.memo((e=>{const{fact:t,factClassName:n,textClassName:r}=e;return d.createElement("div",null,d.createElement("span",{className:n},d.createElement(br,{content:null==t?void 0:t.name})),d.createElement(yr,{className:r,content:null==t?void 0:t.value}))}));Pr.displayName="O365ConnectorCardFactRenderer";const Ar=d.memo((e=>{var t,n;const{section:r,payload:o,onCardAction:i}=e,a=lr(),s=wr(r.images)?r.images.map(((t,n)=>{const r={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==t?void 0:t.image,alt:null==t?void 0:t.title,height:160,width:160},serviceProvider:e.serviceProvider};return d.createElement("div",{key:n},d.createElement("div",null,t.image?d.createElement(or,Object.assign({},r)):null))})):null,l=wr(r.facts)?r.facts.map(((e,t)=>d.createElement("div",{key:t},d.createElement(Pr,{factClassName:a.factName,textClassName:a.cardText,fact:e})))):null,c=r.potentialAction&&d.createElement(jr,{actions:r.potentialAction,buttonClassName:a.cardButton,containerClassName:a.buttonStack,onClick:i,payload:o});return d.createElement("div",null,d.createElement(yr,{className:a.cardSubTitle,content:null===(t=null==e?void 0:e.section)||void 0===t?void 0:t.title}),d.createElement(_r,Object.assign({},e)),d.createElement(yr,{className:a.cardText,content:null===(n=null==e?void 0:e.section)||void 0===n?void 0:n.text}),l,d.createElement("div",null,s),c)}));Ar.displayName="O365ConnectorCardSectionRenderer";const _r=e=>{const{section:t}=e,n=lr(),r={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:t.activityImage,alt:t.activityImage,height:52,width:52},serviceProvider:e.serviceProvider};return d.createElement("div",null,t.activityImage?d.createElement(or,Object.assign({},r)):null,d.createElement("div",null,d.createElement(yr,{className:n.cardSubTitle,content:null==t?void 0:t.activityTitle}),d.createElement(yr,{className:n.cardSubTitle,content:t.activitySubtitle}),d.createElement(yr,{className:n.cardText,content:t.activityText})))};function Dr(e){const t=lr(),n=JSON.parse(e.content),r=n.potentialAction,o=t=>{var n;"openUrl"===t.type&&(null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId,cardData:e.cardData}))},i=wr(n.sections)?n.sections.map(((t,r)=>d.createElement("div",{key:r},d.createElement(Ar,{section:t,onCardAction:o,payload:n,serviceProvider:e.serviceProvider})))):null;return d.createElement("div",{className:t.cardStack},d.createElement(yr,{className:t.cardTitle,content:null==n?void 0:n.title}),d.createElement(yr,{className:t.cardText,content:null==n?void 0:n.text}),i,r&&d.createElement(jr,{actions:r,buttonClassName:t.cardButton,containerClassName:t.buttonStack,onClick:o,payload:n}))}function Lr(e){const t=lr(),n=JSON.parse(e.content),r=t=>{var n;null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId})},o=n.tap,i=e=>{try{e.stopPropagation(),r(o)}catch(e){}},a=n.text||"",s=n.images,l=null==s?void 0:s[0],c={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==l?void 0:l.url,alt:null==l?void 0:l.alt,height:100,width:100},serviceProvider:e.serviceProvider};return d.createElement("div",{key:"thumbnailCardView",className:t.cardStack,onClick:o&&i,onKeyDown:o&&i,role:"presentation"},d.createElement("div",null,l?d.createElement("div",null,d.createElement("div",{className:t.thumbnailImage},d.createElement(or,Object.assign({},c)))):[],d.createElement("div",null,d.createElement(yr,{className:t.cardTitle,content:n.title}),d.createElement(yr,{className:t.cardSubTitle,content:n.subtitle}),a&&d.createElement(yr,{className:t.cardText,content:a}))),d.createElement(Or,{actions:n.buttons||[],buttonClassName:t.cardButton,containerClassName:t.buttonStack,onClick:r,payload:n}))}function Mr(e){const{cardData:t,uxRegistry:n,onPrepareRuntimeActivityRequest:r,onRuntimeActivityResponse:o,hostConfig:i,serviceProvider:a,renderId:s}=e,l=d.useMemo((()=>a?new F(t,a,r,o):void 0),[a,r,o,t]);switch(null==t?void 0:t.contentType){case E.b.AdaptiveCard:return d.createElement(ir,{content:null==t?void 0:t.content,cardId:t.cardId,renderId:s,runtime:l,uxRegistry:n,hostConfig:i,serviceProvider:a});case E.b.HeroCard:return d.createElement(Sr,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a});case E.b.ThumbnailCard:return d.createElement(Lr,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a});case E.b.ConnectorCard:return d.createElement(Dr,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a,cardData:t});default:return d.createElement(d.Fragment,null)}}function Br(e){var t,n;let r=null;const{cardData:s,uxRegistry:c,hostConfig:u,onPrepareRuntimeActivityRequest:p,onRuntimeActivityResponse:g,serviceProvider:h}=e,[f,m]=d.useState({cardData:s}),[v,b]=d.useState(Object(C.generateGuid)());d.useMemo((()=>{return e=s.cardId,t=m,void O.set(e,t);var e,t}),[s.cardId]),d.useMemo((()=>m({cardData:s})),[s]);const y=d.useMemo((()=>(b(Object(C.generateGuid)()),new i.a(null==h?void 0:h.telemetryService,o.h.CardRender,o.g.M365CardRenderer))),[]);try{r=d.createElement(Mr,{cardData:null==f?void 0:f.cardData,hostConfig:u,uxRegistry:c,serviceProvider:h,onPrepareRuntimeActivityRequest:p,onRuntimeActivityResponse:g,renderId:v})}catch(e){y.logMetricEndWithError({diagnosticsData:`TypeOfCard: ${null==f?void 0:f.cardData.contentType}, Card rendering failed with error: ${e} cardId : ${null==f?void 0:f.cardData.cardId}, Appid: ${Object(a.a)(null===(t=null==f?void 0:f.cardData)||void 0===t?void 0:t.titleId,null===(n=null==f?void 0:f.cardData)||void 0===n?void 0:n.appId)}`})}return d.useEffect((()=>{var e,t,n;b(Object(C.generateGuid)());y.logMetricEnd({props:{},renderId:v,diagnosticsData:`TypeOfCard: ${null==f?void 0:f.cardData.contentType}, cardId : ${null==f?void 0:f.cardData.cardId} cardsize: ${null===(e=null==f?void 0:f.cardData.content)||void 0===e?void 0:e.length}, Appid: ${Object(a.a)(null===(t=null==f?void 0:f.cardData)||void 0===t?void 0:t.titleId,null===(n=null==f?void 0:f.cardData)||void 0===n?void 0:n.appId)}, actionabilityStatus: ${Object(l.c)(null==f?void 0:f.cardData.cardId)}`},null==u?void 0:u.correlationId)}),[]),r}class Rr{constructor(){this.elementRegistry=new Te.e,this.actionRegistry=new Te.e}}class Fr{constructor(e){this.msgExtTelemetryService=e}LogInfo(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogInfo(t)}LogError(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogError(t)}LogException(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogException(t)}LogWarning(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogWarning(t)}LogVerbose(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogVerbose(t)}LogMetric(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogMetric(t)}convertRequest(e){return Object.assign(Object.assign({},e),{source:4})}}function Nr(){const e=d.useMemo((()=>new Rr),[]),t=d.useContext(y);if(!t)return d.createElement(d.Fragment,null);const n=new Fr(t.serviceProvider.telemetryService),r=Object.assign(Object.assign({},t.serviceProvider),{telemetryService:n});return d.createElement(Br,{cardData:t.cardDetails,hostConfig:t.hostConfig,uxRegistry:e,serviceProvider:r,onPrepareRuntimeActivityRequest:t.beforeActionExecute,onRuntimeActivityResponse:t.postActionExecute})}function Hr(e){const{serviceProvider:t,cardDetails:n,hostConfig:r,beforeActionExecute:o,postActionExecute:i}=e;return d.createElement(y.Provider,{value:{serviceProvider:t,cardDetails:n,hostConfig:r,beforeActionExecute:o,postActionExecute:i}},d.createElement(Nr,null))}var Ur,Vr=n(187),zr=n(752);!function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(Ur||(Ur={}));var Gr,Wr=n(313),Qr=n(71),qr=Object(Wr.b)("MsgExtCardFooterStore",{cardsFooterMap:new Qr.a}),Kr=Object(Wr.d)("updateFooterStore",(function(e,t){var n,r,o,i,a=null===(r=null===(n=qr())||void 0===n?void 0:n.cardsFooterMap)||void 0===r?void 0:r.get(e);a&&t?(a.actionMessageProps=t.actionMessageProps,a.dismissType=t.dismissType,a.type=t.type,a.messageType=t.messageType):null===(i=null===(o=qr())||void 0===o?void 0:o.cardsFooterMap)||void 0===i||i.set(e,t)}));!function(e){e[e.GenericError=0]="GenericError",e[e.AppNotInstalled=1]="AppNotInstalled",e[e.AppNotAvailable=2]="AppNotAvailable",e[e.ComposeScenario=3]="ComposeScenario",e[e.UntrustedUrl=4]="UntrustedUrl",e[e.VerificationInProgress=5]="VerificationInProgress",e[e.VerificationFailed=6]="VerificationFailed",e[e.VerificationError=7]="VerificationError",e[e.AppNotInstalledWithInstallLink=8]="AppNotInstalledWithInstallLink",e[e.AppNotUpdatedWithInstallLink=9]="AppNotUpdatedWithInstallLink",e[e.AppNotUpdated=10]="AppNotUpdated"}(Gr||(Gr={}));var Yr=n(218);function Zr(e){const t=Object(l.d)(e);let n;if(null==t?void 0:t.type){const e=function(e){switch(e){case l.a.error:return Yr.a.error;case l.a.warning:return Yr.a.warning;default:return Yr.a.info}}(t.messageType);n={dismissType:Ur.Automatic,type:Jr(t.type),messageType:e}}Kr(e,n)}function Jr(e){switch(e){case l.b.AppNotAvailable:return Gr.AppNotAvailable;case l.b.AppNotInstalled:return Gr.AppNotInstalled;case l.b.ComposeScenario:return Gr.ComposeScenario;default:return Gr.GenericError}}const Xr=Object(Vr.b)((function(e){const{cardId:t,serviceProvider:n,hostConfig:r,postActionExecute:o}=e,i=Object(s.c)(t),a=(e=>t=>{switch(Object(l.c)(e)){case zr.b.Full:return Promise.resolve(!1);case zr.b.Limited:return t instanceof L||t instanceof D&&t.trigger===E.a.Automatic?Promise.resolve(!1):(Zr(e),Promise.resolve(!0));default:return Zr(e),Promise.resolve(!0)}})(t);return i?d.createElement(Hr,{serviceProvider:n,cardDetails:i,hostConfig:null!=r?r:h(),beforeActionExecute:a,postActionExecute:o}):d.createElement(d.Fragment,null)}));var $r=n(3583),eo=n(3564),to=5e3;function no(e){var t=e.message,n=e.messageType,r=e.dismissType,o=e.action,i=e.onDismiss,a=e.autoDismissTimer;return d.useEffect((function(){if(r!==Ur.Manual){var e=setTimeout((function(){null==i||i()}),null!=a?a:to);return function(){return clearTimeout(e)}}}),[r,a,i]),t?"0"==n?d.createElement(eo.a,{intent:"error",action:{title:null==o?void 0:o.title,onClick:null==o?void 0:o.onClick}},t):"1"==n?d.createElement(eo.a,{intent:"info",action:{title:null==o?void 0:o.title,onClick:null==o?void 0:o.onClick}},t):"2"==n?d.createElement(eo.a,{intent:"success",action:{title:null==o?void 0:o.title,onClick:null==o?void 0:o.onClick}},t):"3"==n?d.createElement(eo.a,{intent:"warning",action:{title:null==o?void 0:o.title,onClick:null==o?void 0:o.onClick}},t):d.createElement(d.Fragment,null):null}const ro=Object(r.declareString)("msgext-card-preview.genericError"),oo=Object(r.declareString)("msgext-card-preview.notAllowedInCompose"),io=Object(r.declareString)("msgext-card-preview.appNotAvailable"),ao=Object(r.declareString)("msgext-card-preview.untrustedUrl"),so=Object(r.declareString)("msgext-card-preview.appNotInstalled"),lo=Object(Vr.b)((function(e){const t=(n=e.cardId,null===(o=null===(r=qr())||void 0===r?void 0:r.cardsFooterMap)||void 0===o?void 0:o.get(n));var n,r,o;const i=function(e){switch(e){case Gr.AppNotAvailable:return io;case Gr.AppNotInstalled:return so;case Gr.ComposeScenario:return oo;case Gr.GenericError:return ro;case Gr.UntrustedUrl:return ao;default:return ro}}(null==t?void 0:t.type),a=Object($r.b)({messageText:i}),s=d.useMemo((()=>{return(null==t?void 0:t.type)?(e=a.messageText(),d.createElement("div",null,e)):d.createElement(d.Fragment,null);var e}),[t,a]);if(!t)return d.createElement(d.Fragment,null);let l;return t.actionMessageProps&&(l={text:t.actionMessageProps.actionMessage,onClick:t.actionMessageProps.onClick}),d.createElement(no,{message:s,messageType:t.messageType,dismissType:t.dismissType,action:l,onDismiss:co(e.cardId),autoDismissTimer:t.autoDismissTimer})}));const co=e=>()=>{Kr(e,{})},uo=Object(ar.a)("MsgExtCardPreview",Object(on.a)({root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({maxWidth:"min(450px, 100%)",backgroundColor:Pt.a.colorNeutralBackground2},sr.a.borderStyle("solid")),sr.a.borderWidth("1px")),sr.a.borderRadius("12px")),sr.a.borderColor(Pt.a.colorNeutralStroke1)),sr.a.overflow("hidden"))})),po=Object(on.a)({button:Object.assign(Object.assign(Object.assign(Object.assign({},sr.a.borderRadius("4px")),sr.a.borderWidth("1px")),sr.a.borderStyle("solid")),{height:"32px"})});var go=n(3363),ho=Object(ar.a)("M365AppTile",Object(on.a)({appName:{fontSize:"12px",fontWeight:600,letterSpacing:"normal",textOverflow:"ellipsis",marginLeft:"12px",overflowY:"hidden",overflowX:"hidden",textAlign:"left",whiteSpace:"nowrap",color:Pt.a.colorNeutralForeground2},appIcon:Object(H.__assign)({height:"24px",width:"24px",maxWidth:"32px",maxHeight:"32px",overflowX:"hidden",overflowY:"hidden"},sr.a.borderRadius("3px")),appTile:Object(H.__assign)({paddingTop:"12px",paddingRight:"5px",paddingLeft:"16px"},sr.a.overflow("hidden")),flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"2px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1}})),fo=24,mo=24,vo="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOTIgMTkyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxOTIgMTkyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxyZWN0IHN0eWxlPSJmaWxsOiNFREVCRTk7IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIvPgo8cGF0aCBzdHlsZT0iZmlsbDojNjA1RTVDOyIgZD0iTTY4LjA2MjUsNTQuODg4N2MwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NGMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NAoJYy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtM2MtMC44MTMsMC0xLjUxNjEsMC4yOTc0LTIuMTA5NCwwLjg5MDZjLTAuNTkzOCwwLjU5MzgtMC44OTA2LDEuMjk2OS0wLjg5MDYsMi4xMDk0Cgl2M2MwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0di0zYzAtMS42MjQ1LDAuNDA1OC0zLjEyNDUsMS4yMTg4LTQuNWMwLjgxMjUtMS4zNzUsMS45MDU4LTIuNDY4MywzLjI4MTItMy4yODEyCgljMS4zNzUtMC44MTI1LDIuODc1LTEuMjE4OCw0LjUtMS4yMTg4aDNDNjYuNzY1Niw1My45OTgsNjcuNDY4OCw1NC4yOTU0LDY4LjA2MjUsNTQuODg4N3ogTTU5LjA2MjUsNzguODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMy0wLjI5NzQsMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CgljLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2Yy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTQKCWMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNkM1Ny43NjU2LDc3Ljk5OCw1OC40Njg4LDc4LjI5NTQsNTkuMDYyNSw3OC44ODg3eiBNNTkuMDYyNSwxMDIuODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMjUtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNgoJYy0wLjgxMywwLTEuNTE2MS0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTR2LTZjMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0CgljMC41OTMzLTAuNTkzOCwxLjI5NjQtMC44OTA2LDIuMTA5NC0wLjg5MDZDNTcuNzY1NiwxMDEuOTk4LDU4LjQ2ODgsMTAyLjI5NDksNTkuMDYyNSwxMDIuODg4N3ogTTU5LjA2MjUsMTIzLjg4ODcKCWMwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHYzYzAsMC44MTI1LDAuMjk2OSwxLjUxNTYsMC44OTA2LDIuMTA5NGMwLjU5MzMsMC41OTM4LDEuMjk2NCwwLjg5MDYsMi4xMDk0LDAuODkwNmgzCgljMC44MTI1LDAsMS41MTU2LDAuMjk2OSwyLjEwOTQsMC44OTA2YzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0cy0wLjI5NzQsMS41MTU2LTAuODkwNiwyLjEwOTQKCWMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTNjLTEuNjI1LDAtMy4xMjUtMC40MDYyLTQuNS0xLjIxODhjLTEuMzc1NS0wLjgxMjUtMi40Njg4LTEuOTA2Mi0zLjI4MTItMy4yODEyCgljLTAuODEzLTEuMzc1LTEuMjE4OC0yLjg3NS0xLjIxODgtNC41di0zYzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTM4LDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNgoJQzU3Ljc2NTYsMTIyLjk5OCw1OC40Njg4LDEyMy4yOTQ5LDU5LjA2MjUsMTIzLjg4ODd6IE04OS4wNjI1LDU0Ljg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCWMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDODcuNzY1Niw1My45OTgsODguNDY4OCw1NC4yOTU0LDg5LjA2MjUsNTQuODg4N3ogTTg5LjA2MjUsMTMyLjg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCXMtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTMsMC0xLjUxNjEtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCWMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzMy0wLjU5MzgsMS4yOTY0LTAuODkwNiwyLjEwOTQtMC44OTA2aDYKCUM4Ny43NjU2LDEzMS45OTgsODguNDY4OCwxMzIuMjk0OSw4OS4wNjI1LDEzMi44ODg3eiBNMTEzLjA2MjUsNTQuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NAoJYzAsMC44MTMtMC4yOTY5LDEuNTE2MS0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTI1LDAtMS41MTU2LTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzgtMC41OTMzLDEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDMTExLjc2NTYsNTMuOTk4LDExMi40Njg4LDU0LjI5NTQsMTEzLjA2MjUsNTQuODg4N3ogTTExMy4wNjI1LDEzMi44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0CglzLTAuMjk2OSwxLjUxNTYtMC44OTA2LDIuMTA5NHMtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2aC02Yy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCXMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0czAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NHMxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDZoNgoJQzExMS43NjU2LDEzMS45OTgsMTEyLjQ2ODgsMTMyLjI5NDksMTEzLjA2MjUsMTMyLjg4ODd6IE0xMzMuNDUzMSw1NS4yMTY4YzEuMzc1LDAuODEzLDIuNDY4OCwxLjkwNjIsMy4yODEyLDMuMjgxMgoJYzAuODEyNSwxLjM3NTUsMS4yMTg4LDIuODc1NSwxLjIxODgsNC41djNjMCwwLjgxMy0wLjI5NjksMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CglzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzMy0wLjg5MDYtMS4yOTY0LTAuODkwNi0yLjEwOTR2LTNjMC0wLjgxMjUtMC4yOTY5LTEuNTE1Ni0wLjg5MDYtMi4xMDk0CgljLTAuNTkzOC0wLjU5MzMtMS4yOTY5LTAuODkwNi0yLjEwOTQtMC44OTA2aC0zYy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDZjLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzOC0wLjU5MzMsMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2aDMKCUMxMzAuNTc4MSw1My45OTgsMTMyLjA3ODEsNTQuNDA0MywxMzMuNDUzMSw1NS4yMTY4eiBNMTM3LjA2MjUsMTIzLjg4ODdjMC41OTM4LDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTR2MwoJYzAsMS42MjUtMC40MDYyLDMuMTI1LTEuMjE4OCw0LjVzLTEuOTA2MiwyLjQ2ODgtMy4yODEyLDMuMjgxMnMtMi44NzUsMS4yMTg4LTQuNSwxLjIxODhoLTNjLTAuODEyNSwwLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJcy0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmgzYzAuODEyNSwwLDEuNTE1Ni0wLjI5NjksMi4xMDk0LTAuODkwNgoJczAuODkwNi0xLjI5NjksMC44OTA2LTIuMTA5NHYtM2MwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRzMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2CglTMTM2LjQ2ODgsMTIzLjI5NDksMTM3LjA2MjUsMTIzLjg4ODd6IE0xMzcuMDYyNSw3OC44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djYKCWMwLDAuODEzLTAuMjk2OSwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJYy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRjMC41OTM4LTAuNTkzMywxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDYKCVMxMzYuNDY4OCw3OC4yOTU0LDEzNy4wNjI1LDc4Ljg4ODd6IE0xMzcuMDYyNSwxMDIuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHY2CgljMCwwLjgxMjUtMC4yOTY5LDEuNTE1Ni0wLjg5MDYsMi4xMDk0cy0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNnMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0di02CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNlMxMzYuNDY4OCwxMDIuMjk0OSwxMzcuMDYyNSwxMDIuODg4N3oiLz4KPC9zdmc+Cg==";function bo(e){var t=e.appIcon,n=e.appName,r=null!=t?t:vo,o=ho(),i=Object(c.a)(o.flex,o.appTile);return d.createElement("div",{className:i},d.createElement("div",{className:"styles.flexItem"},d.createElement(go.a,{className:o.appIcon,src:r,height:fo,width:mo})),d.createElement("div",{className:"styles.flexItem"},d.createElement(cr.a,{className:o.appName},n)))}var yo=n(3361),Co=n(552),Oo=n(576),So=Object(r.declareString)("m365card-header-v9.Copied"),Eo=Object(ar.a)("M365CardHeaderOptions",Object(on.a)({cardOptions:{paddingTop:"12px"},optionsStack:{paddingRight:"16px"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1},button:{backgroundColor:Pt.a.colorNeutralBackground2,":hover":{backgroundColor:Pt.a.colorNeutralBackground2}}}));function xo(e){var t=e.options,n=Eo(),r=Object(c.a)(n.flex,n.optionsStack),o=Object(c.a)(n.flexItem,n.cardOptions),i=Object(H.__read)(d.useState(!1),2),a=i[0],s=i[1],l=Object($r.a)(So);return d.createElement("div",{className:r},t.map((function(e){var t;return d.createElement("div",{key:null===(t=null==e?void 0:e.iconProps)||void 0===t?void 0:t.iconName,className:o},d.createElement(yo.a,{content:l,relationship:"label",visible:a},d.createElement(Et.a,{className:n.button,size:"small",style:{border:"none"},icon:a?d.createElement(Co.g,null):d.createElement(Oo.f,null),onClick:function(){var t;null===(t=null==e?void 0:e.onMenuClick)||void 0===t||t.call(e),setTimeout((function(){s(!1)}),5e3),s(!0)}})))})))}var Io=Object(ar.a)("M365CardHeader",Object(on.a)({cardAppHeader:{justifyContent:"space-between"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1}}));function wo(e){var t=e.appName,n=e.appIcon,r=e.options,o=e.optionsComponents,i=Io(),a=Object(c.a)(i.flex,i.cardAppHeader);return d.createElement("div",{className:a},d.createElement("div",{className:i.flexItem},t&&d.createElement(bo,{appIcon:n,appName:t})),d.createElement("div",{className:i.flexItem},r&&d.createElement(xo,{options:r})),d.createElement("div",{className:i.flexItem},o&&o))}var To=n(3384),ko=Object(ar.a)("MsgExtCardHeader",Object(on.a)({root:{height:"2px",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},progressBar:{borderTopLeftRadius:"2px",borderTopRightRadius:"2px",borderBottomLeftRadius:"2px",borderBottomRightRadius:"2px",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},itemProgress:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},flex:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}})),jo=n(886),Po=Object(jo.a)("MsgExtCardHeaderStore",{cardsMap:new Qr.a}),Ao=(Object(jo.b)("initializeHeaderStore",(function(e,t){var n={options:t};Po().cardsMap.set(e,n)})),Object(jo.b)("updateMsgExtCardOptionsFeature",(function(e,t){var n=Po().cardsMap.get(e);n?n.options=t:Po().cardsMap.set(e,{options:t})})));Object(jo.b)("addMsgextCardOptionsFeature",(function(e,t){var n,r,o=null===(r=null===(n=Po())||void 0===n?void 0:n.cardsMap)||void 0===r?void 0:r.get(e);if(o){var i=[t];if(o.options)Object(H.__spreadArray)([],Object(H.__read)(o.options),!1).forEach((function(e){t.type!==e.type&&i.push(e)}));o.options=i}})),Object(jo.b)("removeMsgExtCardOptionsFeature",(function(e,t){var n=Po().cardsMap.get(e);if(n){var r=[];n.options&&(r=Object(H.__spreadArray)([],Object(H.__read)(n.options),!1)),r.forEach((function(e,n,r){e.type===t.type&&r.splice(n,1)})),n.options=r}}));var _o=Object(Vr.b)((function(e){var t=e.processingCompleted,n=e.appIcon,r=e.appName,o=e.options,i=e.cardId,a=e.hideProgressIndicator,s=e.optionsComponents,l=ko(),u=Object(c.a)(l.progressBar,l.itemProgress,l.root);d.useEffect((function(){o&&Ao(i,o)}),[]);var p=function(e){var t,n,r;return null===(r=null===(n=null===(t=Po())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===r?void 0:r.options}(i);return d.createElement("div",{className:"progressIndicatorStyles.flex"},a?null:d.createElement(To.a,{value:t?1:void 0,className:u}),d.createElement(wo,{appName:r,appIcon:n,options:p,optionsComponents:s}))}));const Do=Object(r.declareString)("msgext-card-preview.Copied"),Lo=Object(r.declareString)("msgext-card-preview.Copy"),Mo=Object(ar.a)("M365CardHeaderOptions",Object(on.a)({cardOptions:{paddingTop:"12px",paddingRight:"16px"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1},button:{backgroundColor:Pt.a.colorNeutralBackground2,":hover":{backgroundColor:Pt.a.colorNeutralBackground2}}}));function Bo(e){const t=Mo(),n=Object(c.a)(t.flexItem,t.cardOptions),r=Object($r.a)(Lo),o=Object($r.a)(Do),[i,a]=d.useState({tooltip:r,visible:void 0});return d.createElement("div",{className:n},d.createElement(yo.a,{content:i.tooltip,relationship:"label",visible:i.visible},d.createElement(Et.a,{className:t.button,size:"small",style:{border:"none"},icon:i.tooltip===o?d.createElement(Co.g,null):d.createElement(Oo.f,null),onClick:()=>{e.onClick(),setTimeout((()=>{a({tooltip:r,visible:void 0})}),5e3),a({tooltip:o,visible:!0})}})))}const Ro=Object(Vr.b)((function(e){var t,n,r;const{cardId:i,hostService:a,telemetryService:c}=e,u=Object(l.c)(i),p=Object(s.c)(i);if(!p)return d.createElement(d.Fragment,null);const g=Object(s.a)(i),h=u!==zr.b.Unknown,f=null!==(t=null==g?void 0:g.name)&&void 0!==t?t:null==p?void 0:p.appName,m=null!==(n=null==g?void 0:g.largeImageUrl)&&void 0!==n?n:null==p?void 0:p.appIcon,v=function(e,t,n){const r=[];if("compose"===e){const e={iconProps:{iconName:"Cancel",title:"Remove card"},onMenuClick:()=>{t.deleteCard({cardDetails:n})}};r.push(e)}return r}(null!==(r=Object(s.d)(i))&&void 0!==r?r:"consume",a,p),b=function(e,t,n){var r,i;const a=[];let s;try{s=JSON.parse(null!==(r=null==t?void 0:t.content)&&void 0!==r?r:"{}")}catch(e){null==n||n.LogError({type:o.e.LogError,tag:o.m.MsgExtCardHeader,name:o.k.getHeaderOptions,message:o.d.cardContentParseError}),s={}}if(null===(i=s.metadata)||void 0===i?void 0:i.webUrl){const n=()=>{e.copyCard({cardDetails:t})};return a.push(d.createElement(Bo,{onClick:n})),a}return}(a,p,c);return d.createElement(_o,{cardId:p.cardId,processingCompleted:h,appIcon:m,appName:f,options:v,hideProgressIndicator:!0,optionsComponents:b})}));function Fo(e){const{cardDetails:t,serviceProvider:n,config:p,renderingMode:f}=e,m=d.useMemo((()=>"dark"===(null==p?void 0:p.themeMode)?g(null==p?void 0:p.featureFlags):h(null==p?void 0:p.featureFlags)),[p]),y=uo(),C=d.useMemo((()=>new i.a(null==n?void 0:n.telemetryService,o.h.CardRender,o.g.MsgExtCardPreview)),[t,n,f]);d.useEffect((()=>{var e;const t=Object(r.toSupportedLocale)(null!==(e=m.locale)&&void 0!==e?e:"en-us");Object(r.getCurrentLocaleForDefaultStringProvider)().then((e=>{e!==t&&Object(r.setCurrentLocaleForDefaultStringProvider)(t)}))}),[m]),d.useEffect((()=>{const e={};if(!n.appService)return void C.logMetricEndWithError({props:e,diagnosticsData:`TypeOfCard: ${t.contentType},  cardId : ${t.cardId}, Error: Card rendering failed due to invalid appService, Appid: ${Object(a.a)(null==t?void 0:t.titleId,null==t?void 0:t.appId)}`});const r=null!=f?f:"consume";Object(s.e)(t,r,n.appService),C.logMetricEnd({props:e,diagnosticsData:`TypeOfCard: ${t.contentType},  cardId : ${t.cardId} , CardRenderingMode : ${r}, Appid: ${Object(a.a)(null==t?void 0:t.titleId,null==t?void 0:t.appId)}, actionabilityStatus: ${Object(l.c)(t.cardId)}`},null==m?void 0:m.correlationId)}),[t,n,f]);const O=function(e){let t;return e&&(t="dark"===e?b:v),null!=t?t:v}(null==p?void 0:p.themeMode),S={useButtonStyles_unstable:e=>{const t=e;t.root.className=Object(c.a)(t.root.className,po().button)}};return d.createElement(u.a,{customStyleHooks_unstable:S,theme:O},d.createElement("div",{className:y.root,"data-testid":"MsgExtCardPreview"},d.createElement(Ro,{cardId:t.cardId,hostService:n.hostService,telemetryService:n.telemetryService}),d.createElement(Xr,{cardId:t.cardId,serviceProvider:n,hostConfig:m,postActionExecute:e.postActionExecute}),d.createElement(lo,{cardId:t.cardId})))}},3513:function(e,t,n){"use strict";n.d(t,"a",(function(){return Be}));var r=n(1149),o=n(1170),i=n(406),a=n(142),s=n(3345),l=n(1);const c=l.createContext({});var u;!function(e){e.TEAMS_HUB="teamshub",e.OWA_HUB="owahub",e.OFFICE_WEB="officeweb"}(u||(u={}));const d="https://teams.microsoft.com/l/store?id=app:co:copilotplugins",p="{domain}/m365apps/apps/app:co:copilotplugins";var g=n(3583),h=n(1632),f=n(3378),m=n(3424),v=n(3399),b=n(1814),y=n(3361),C=n(65),O=n(3365),S=n(3347),E=n(2172),x=n(3366),I=n(552),w=n(3363),T=n(2870),k=n(1543),j=n(139);const P=Object(T.a)("CopilotPluginFlyoutCustomInfoButton",Object(k.a)({tooltiptext:{width:"216px",fontSize:"12px"},tooltip:{"> button":{backgroundColor:"none",paddingTop:"4px",paddingLeft:"4px",paddingRight:"4px",paddingBottom:"4px",width:"12px",height:"12px",minWidth:"0px",minHeight:"0px",maxWidth:"12px",maxHeight:"12px",borderTopStyle:"none",borderLeftStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderBottomLeftRadius:"16px",borderBottomRightRadius:"16px",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"}},infoButton:{backgroundColor:j.a.colorNeutralBackground1,marginLeft:"5px",marginBottom:"5px",":hover":{"> button":{backgroundColor:j.a.colorNeutralForeground2BrandHover},"> button > span > svg > path":{fill:j.a.colorNeutralForeground1}}},infoButtonTooltip:{zIndex:2},infoButtonOverrideLightMode:{marginLeft:"5px",marginBottom:"5px",":hover":{"> button":{backgroundColor:"#0f6cbd"},"> button > span > svg > path":{fill:"#ffffff"}}},infoButtonOverrideDarkMode:{marginLeft:"5px",marginBottom:"5px",":hover":{"> button":{backgroundColor:"#479ef5"},"> button > span > svg > path":{fill:"#242424"}}}}));function A(e){const[t,n]=l.useState(),{infoMessage:r,theme:o}=e,i=P(),a=Object(C.a)(i.tooltip,i.infoButton,"dark"===o?i.infoButtonOverrideDarkMode:i.infoButtonOverrideLightMode),s=l.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M12 0C5.373 0 0 5.373 0 12C0 18.627 5.373 24 12 24C18.627 24 24 18.627 24 12C24 5.373 18.627 0 12 0ZM12 22C6.486 22 2 17.514 2 12C2 6.486 6.486 2 12 2C17.514 2 22 6.486 22 12C22 17.514 17.514 22 12 22Z",fill:"currentColor"}),l.createElement("path",{d:"M12 7C11.448 7 11 7.448 11 8V16C11 16.552 11.448 17 12 17C12.552 17 13 16.552 13 16V8C13 7.448 12.552 7 12 7Z",fill:"currentColor"}),l.createElement("circle",{cx:"12",cy:"5",r:"1",fill:"currentColor"})),c={content:{children:r,className:i.infoButtonTooltip},relationship:"label",...!e.mountTooltipToBody&&{mountNode:t}};return l.createElement("span",{className:a,title:"Info",role:"button","aria-label":"Info"},l.createElement(y.a,{...c},l.createElement(b.a,{icon:s,size:"small"})),l.createElement("div",{ref:n}))}var _=n(335);const D=Object(T.a)("CopilotPluginFlyoutItemRenderer",Object(k.a)({appIcon:{width:"20px",height:"20px",float:"left"},appNameContainer:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",..._.a.overflow("hidden")},appNameTextContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",..._.a.overflow("hidden")},appNameTooltip:{zIndex:2},appName:{width:"auto",height:"auto",lineHeight:"20px",paddingLeft:"2px",paddingRight:"2px",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:j.a.colorNeutralForeground2Link,whiteSpace:"nowrap",..._.a.overflow("hidden"),textOverflow:"ellipsis"},appInfo:{..._.a.padding("6px 4px 6px 6px"),..._.a.gap("4px"),display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},..._.a.overflow("hidden"),alignContent:"center",justifyItems:"left",alignSelf:"center"},blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"36px",maxHeight:"100px",..._.a.margin("2px"),..._.a.padding("6px 0px 6px 6px"),justifyContent:"space-between",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},alignItems:"center"},toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right","&:focus-within":{..._.a.border("1px","solid",j.a.colorNeutralForeground3)}},signInButton:{fontSize:"12px"},chevronIcon:{float:"left",marginRight:"20px",rotate:"270deg"},chevronIconCollapsed:{float:"left",marginRight:"20px"},powerplatformConnectorTextContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"400px",justifyContent:"space-between",height:"auto",..._.a.overflow("hidden")},connectButton:{width:"auto",height:"auto",lineHeight:"16px",paddingLeft:"8px",paddingTop:"3px",paddingRight:"10px",fontSize:"12px",fontStyle:"normal",fontWeight:400,color:j.a.colorNeutralForeground2BrandPressed}}));function L(e){const{plugin:t,setShowPlugins:n,pluginId:r}=e,[o,i]=l.useState(!1),a=D(),[s,c]=l.useState(),u="blocked"===t.state?a.blocked:void 0,d="blocked"===t.state?l.createElement(A,{infoMessage:"This plugin is disabled. Contact your admin."}):null,p=Object(C.a)(u,a.appName),g=l.createElement("div",{className:a.appInfo},t.icon&&l.createElement(w.a,{src:t.icon,className:Object(C.a)(a.appIcon,u),"aria-labelledby":r}),l.createElement("div",{className:a.appNameTextContainer,ref:c},l.createElement(y.a,{content:{children:t.name,className:a.appNameTooltip},relationship:"label",mountNode:s},l.createElement(f.a,{id:r,className:p},t.name)),d));return l.createElement("div",{className:a.pluginItem,onClick:()=>{i(!o),n&&n()},role:"presentation"},g,l.createElement(I.n,{className:o?a.chevronIconCollapsed:a.chevronIcon}))}var M=n(2385),B=n(3370);const R=Object(T.a)("CopilotPluginFlyoutItemCustomSwitch",Object(k.a)({toggleContainer:{boxSizing:"border-box",cursor:"pointer",..._.a.margin("0px"),..._.a.padding("8px"),width:"56px"},toggleOnContainerLightMode:{height:"20px",width:"40px",..._.a.borderRadius("10000px"),..._.a.border("1px","solid"),backgroundColor:"#0f6cbd",color:"#ffffff"},toggleOnContainerDarkMode:{height:"20px",width:"40px",..._.a.borderRadius("10000px"),..._.a.border("1px","solid"),backgroundColor:"#479ef5",color:"#242424"},toggleOffContainerLightMode:{height:"20px",width:"40px",..._.a.borderRadius("10000px"),..._.a.border("1px","solid"),..._.a.borderColor("#616161")},toggleOffContainerDarkMode:{height:"20px",width:"40px",..._.a.borderRadius("10000px"),..._.a.border("1px","solid"),..._.a.borderColor("#adadad")},toggleOffLightMode:{marginLeft:"2px",marginRight:"20px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",..._.a.borderRadius("10000px"),backgroundColor:"#616161"},toggleOffDarkMode:{marginLeft:"2px",marginRight:"20px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",..._.a.borderRadius("10000px"),backgroundColor:"#adadad"},toggleOnLightMode:{marginLeft:"22px",marginRight:"0px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",..._.a.borderRadius("10000px"),backgroundColor:"#ffffff"},toggleOnDarkMode:{marginLeft:"22px",marginRight:"0px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",..._.a.borderRadius("10000px"),backgroundColor:"#242424"}}));function F(e){const{onChangeCallback:t,checked:n,theme:r,isBlocked:o,pluginName:i}=e,a=!o&&n,[s,c]=l.useState(a),u=()=>{if(!o){!function(e){const t=document.createElement("div"),n="PluginsFlyoutAnnounce-"+Date.now();t.setAttribute("id",n),t.setAttribute("aria-live","assertive"),t.classList.add("visually-hidden"),document.body.appendChild(t),window.setTimeout((()=>{const t=document.getElementById(n);t&&(t.textContent=e)}),100),window.setTimeout((()=>{const e=document.getElementById(n);e&&document.body.removeChild(e)}),1e3)}(`Toggle button ${i||"Plugin"} ${s?"not checked":"checked"}`),c(!s),t(!s)}},d=R();return s?l.createElement("div",{"aria-label":`Toggle Button ${i} checked`,tabIndex:0,className:d.toggleContainer,onClick:u},l.createElement("div",{className:"dark"===r?d.toggleOnContainerDarkMode:d.toggleOnContainerLightMode},l.createElement("div",{className:"dark"===r?d.toggleOnDarkMode:d.toggleOnLightMode}))):l.createElement("div",{"aria-label":`Toggle Button ${i} not checked`,tabIndex:0,className:d.toggleContainer,onClick:u},l.createElement("div",{className:"dark"===r?d.toggleOffContainerDarkMode:d.toggleOffContainerLightMode},l.createElement("div",{className:"dark"===r?d.toggleOffDarkMode:d.toggleOffLightMode})))}function N(e){switch(e){case"MsgExt":return o.e.MsgExt;case"FirstParty":return o.e.FirstParty;case"PowerPlatform":return o.e.PowerPlatform;case"DataVerse":return o.e.DataVerse;case"Unsupported":return o.e.Unsupported;default:return o.e.Undefined}}const H=Object(a.declareString)("copilot-ext-plugin-flyout.pluginTitle"),U=Object(a.declareString)("copilot-ext-plugin-flyout.pluginPreviewTitle"),V=Object(a.declareString)("copilot-ext-plugin-flyout.pluginDescription"),z=Object(a.declareString)("copilot-ext-plugin-flyout.pluginInfoIconDescription"),G=Object(a.declareString)("copilot-ext-plugin-flyout.pluginAuthText"),W=Object(a.declareString)("copilot-ext-plugin-flyout.pluginConfigText"),Q=Object(a.declareString)("copilot-ext-plugin-flyout.searchInputPlaceholderText"),q=Object(a.declareString)("copilot-ext-plugin-flyout.pluginRequiredText"),K=Object(a.declareString)("copilot-ext-plugin-flyout.pluginDisabledInfoText"),Y=Object(a.declareString)("copilot-ext-plugin-flyout.storeFrontTitleText"),Z=Object(a.declareString)("copilot-ext-plugin-flyout.addButtonContentText"),J=Object(a.declareString)("copilot-ext-plugin-flyout.addingButtonContentText"),X=Object(a.declareString)("copilot-ext-plugin-flyout.privacyPolicyLinkText"),$=Object(a.declareString)("copilot-ext-plugin-flyout.termsOfUseLinkText"),ee=Object(a.declareString)("copilot-ext-plugin-flyout.permissionsLinkText"),te=Object(a.declareString)("copilot-ext-plugin-flyout.pluginMoreAppsText"),ne=Object(a.declareString)("copilot-ext-plugin-flyout.managePluginsText"),re=Object(a.declareString)("copilot-ext-plugin-flyout.connectPowerPlatformConnectorText");function oe(e){const{plugin:t,onToggle:n,pluginId:i}=e,a=l.useContext(c),{telemetryService:s,correlationVector:u,customStylingRequired:d,theme:p}=a,h=D(),m=Object(g.a)(K),[v,b]=l.useState(),O=Object(M.a)(t)?`PluginName: ${t.name}, PluginId: ${t.id}, PluginSource: ${t.source}`:t.titleId?"LOB Plugin":"TitleId not found",{pluginRenderPerfMarker:S,propMap:E}=l.useMemo((()=>{const e=new r.a(o.d.PluginRender,o.c.PluginFlyoutItemRender,s),n={};return n[o.h.PluginType]=N(t.type),n[o.h.IsPluginIconAvailable]=+!!t.icon,{pluginRenderPerfMarker:e,propMap:n}}),[t]),x=l.useCallback((e=>{I(!t.isEnabled)}),[]),I=l.useCallback((e=>{const i=new r.a(o.d.TogglePlugin,o.c.OnToggle,s),a={};try{a[o.h.TypeOfOperation]=e?o.k.EnablePlugin:o.k.DisablePlugin,a[o.h.PluginType]=N(t.type),n(e),i.logMetricEnd({props:a,diagnosticsData:O},u)}catch(e){i.logMetricEndWithError({props:a,message:o.a.PluginStateUpdateFailed,diagnosticsData:`Failed to update the toggled plugin state with error: ${e.message||"Unknown"}, ${O}`},u)}}),[n]),T="blocked"===t.state?h.blocked:void 0,k=l.useMemo((()=>d?l.createElement("div",{className:Object(C.a)(h.toggleControl,T)},l.createElement(F,{checked:t.isEnabled,onChangeCallback:()=>{},theme:p,isBlocked:"blocked"==t.state,pluginName:t.name})):l.createElement(B.a,{className:h.toggleControl,disabled:"blocked"==t.state,checked:t.isEnabled,"aria-label":`${t.name}. Menu Items ${e.index} of ${e.length}. Toggle Mode `,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),I(!t.isEnabled))}})),[d,h.toggleControl,t.isEnabled,t.state,I,p]),j="blocked"===t.state?l.createElement(A,{infoMessage:m}):null,P=Object(C.a)(T,h.appName),_=l.createElement("div",{className:h.appInfo},t.icon&&l.createElement(w.a,{src:t.icon,className:Object(C.a)(h.appIcon,T),"aria-labelledby":i}),l.createElement("div",{className:h.appNameTextContainer,ref:b},l.createElement(y.a,{content:{children:t.name,className:h.appNameTooltip},relationship:"label",mountNode:v},l.createElement(f.a,{id:i,className:P},t.name)),j));l.useEffect((()=>{S.logMetricEnd({props:E,diagnosticsData:O},u)}),[t]);const L="blocked"===t.state?void 0:x;return l.createElement("div",{className:h.pluginItem,onClick:L,role:"presentation"},_,k)}function ie(e){const{pluginVM:t,pluginId:n}=e,[r,o]=l.useReducer((()=>({...t.plugin})),t.plugin),i=l.useCallback((e=>{t.onToggle(e),o()}),[t]);return l.createElement(oe,{plugin:r,onToggle:i,pluginId:n,index:t.index,length:t.length})}var ae=n(3382),se=n(3343);function le({onSpinnerComplete:e}){return l.useEffect((()=>{e()}),[]),l.createElement("div",null,l.createElement(se.a,{labelPosition:"after",size:"tiny",label:"Enabling"}))}function ce(e){const{onToggle:t,onAuthLinkClickHandler:n,pluginId:i}=e,a=e.plugin,s=l.useContext(c),{telemetryService:u,correlationVector:d,customStylingRequired:p,theme:h}=s,m=D(),[v,b]=l.useState(),O=Object(M.a)(a)?`PluginName: ${a.name}, PluginId: ${a.id}, PluginSource: ${a.source}`:a.titleId?"LOB Plugin":"TitleId not found",{pluginRenderPerfMarker:S,propMap:E}=l.useMemo((()=>{const e=new r.a(o.d.PluginRender,o.c.PluginFlyoutItemRender,u),t={};return t[o.h.PluginType]=N(a.type),t[o.h.IsPluginIconAvailable]=+!!a.icon,{pluginRenderPerfMarker:e,propMap:t}}),[a]),x=l.useCallback((e=>{I(!a.isEnabled)}),[]),I=l.useCallback((e=>{const n=new r.a(o.d.TogglePlugin,o.c.OnToggle,u),i={};try{i[o.h.TypeOfOperation]=e?o.k.EnablePlugin:o.k.DisablePlugin,i[o.h.PluginType]=N(a.type),t(e),n.logMetricEnd({props:i,diagnosticsData:O},d)}catch(e){n.logMetricEndWithError({props:i,message:o.a.PluginStateUpdateFailed,diagnosticsData:`Failed to update the toggled plugin state with error: ${e.message||"Unknown"}, ${O}`},d)}}),[d,t,a.id,a.name,a.source,a.type,u]),T=l.useRef(null),[k,j]=l.useState(!1);l.useEffect((()=>{k&&T.current&&(T.current.focus(),j(!1))}),[k,a.isEnabled,a.state]);const P=()=>{j(!0)},_="blocked"===a.state?m.blocked:void 0,L=l.useMemo((()=>a.isEnabled||"processing"!=a.status?p?l.createElement("div",{className:Object(C.a)(m.toggleControl,_)},l.createElement(F,{checked:a.isEnabled,onChangeCallback:()=>{},theme:h})):l.createElement(B.a,{className:m.toggleControl,"aria-label":`${a.name}. Menu Items ${e.index} of ${e.length}. Toggle Mode `,ref:T,disabled:"blocked"==a.state,checked:a.isEnabled,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),I(!a.isEnabled))}}):l.createElement(le,{onSpinnerComplete:P})),[a.isEnabled,a.status,a.state,p,m.toggleControl,I,h]),R=Object(C.a)(_,m.appName),H=Object(g.a)(K),U="blocked"===a.state?l.createElement(A,{infoMessage:H}):null,V=l.createElement("div",{className:m.appInfo},a.icon&&l.createElement(w.a,{src:a.icon,className:Object(C.a)(m.appIcon,_),"aria-labelledby":i}),l.createElement("div",{className:m.appNameContainer},l.createElement("div",{className:m.appNameTextContainer,ref:b},l.createElement(y.a,{content:{children:a.name,className:m.appNameTooltip},relationship:"label",mountNode:v},l.createElement(f.a,{className:R,id:i},a.name)),U),l.createElement(ue,{plugin:a,onAuthLinkClickHandler:n})));l.useEffect((()=>{S.logMetricEnd({props:E,diagnosticsData:O},d)}),[a]);const z="blocked"===a.state?void 0:x;return l.createElement("div",{className:m.pluginItem,onClick:z,role:"presentation"},V,L)}function ue(e){const t=e.plugin,n=e.onAuthLinkClickHandler,r=D(),o=Object(g.b)({pluginAuthText:G,pluginConfigText:W,pluginRequiredText:q});let i;return t.authRequest&&(i="auth"===t.authRequest.type||"silentAuth"===t.authRequest.type||t.authRequest.isSilent?o.pluginAuthText():o.pluginConfigText()),t.isEnabled&&"pendingAuth"===t.status&&"blocked"!==t.state&&t.authRequest?l.createElement(f.a,{className:r.signInButton},l.createElement(ae.a,{as:"button",onClick:e=>{e.stopPropagation(),n&&n()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),n&&n())}},i),` ${o.pluginRequiredText()}`):null}function de(e){const{pluginVM:t,pluginId:n}=e,r=t,[o,i]=l.useReducer((()=>({...r.plugin})),r.plugin),a=l.useCallback((e=>{r.onToggle(e,(()=>{i()}))}),[r]);return l.createElement(ce,{plugin:o,onToggle:a,onAuthLinkClickHandler:async()=>{r.handleAuthLinkClick(i)},pluginId:n,index:e.pluginVM.index,length:e.pluginVM.length})}function pe(e){const{pluginVM:t,dismissFlyoutCallback:n}=e,i=t.plugin,a=i.id,s=D(),[u,d]=l.useState(),p=Object(g.b)({connectPowerPlatformConnectorText:re}),{correlationVector:h,telemetryService:m}=l.useContext(c),v=l.createElement("div",{className:s.appInfo},i.icon&&l.createElement(w.a,{src:i.icon,className:s.appIcon,"aria-labelledby":a}),l.createElement("div",{className:s.powerplatformConnectorTextContainer,ref:d},l.createElement(y.a,{content:{children:i.name,className:s.appNameTooltip},relationship:"label",mountNode:u},l.createElement(f.a,{id:a,className:s.appName},i.name)),l.createElement(f.a,{className:s.connectButton},p.connectPowerPlatformConnectorText())));return l.createElement("div",{className:s.pluginItem,onClick:()=>{const e=new r.a(o.d.PowerPlatformConnector,o.c.PowerPlatformConnectorClick,m);window.open(i.powerPlatformConnectorId),n?(e.logMetricEnd({message:o.a.PowerPlatformConnectorFlyoutDismissed},h),n()):e.logMetricEnd({message:o.a.PowerPlatformConnectorFlyoutOpen},h)},role:"presentation"},v)}const ge=e=>{const{pluginVM:t,isParentPlugin:n,isUnconnectedPPC:r,setShowPlugins:o,pluginId:i,dismissFlyoutCallback:a}=e;return n?l.createElement(L,{plugin:t.plugin,setShowPlugins:o,pluginId:i}):r?l.createElement(pe,{pluginVM:t,dismissFlyoutCallback:a}):t.plugin.id.includes("MessageExtension")?l.createElement(de,{pluginVM:t,pluginId:i}):l.createElement(ie,{pluginVM:t,pluginId:i})},he=Object(T.a)("CopilotPluginFlyoutRenderer",Object(k.a)({menuPopOver:{overflowX:"hidden",width:"272px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",backgroundColor:j.a.colorNeutralBackground1,overflowY:"hidden"},menuList:{maxHeight:"280px",overflowY:"scroll"},searchInputBox:{minWidth:"250px",marginBottom:"5px",minHeight:"32px"},popOverScroll:{":hover::-webkit-scrollbar-thumb":{backgroundColor:j.a.colorNeutralForeground4,..._.a.border("2px","solid",j.a.colorNeutralBackground3),..._.a.borderRadius(j.a.borderRadiusMedium)},"&::-webkit-scrollbar":{width:j.a.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:j.a.colorNeutralBackground5}},menuItem:{backgroundColor:j.a.colorNeutralBackground1,maxWidth:"inherit",paddingLeft:"0px",paddingRight:"0px","> span":{..._.a.overflow("hidden")},"&:hover":{backgroundColor:j.a.colorNeutralBackground1Hover}},subMenuItem:{backgroundColor:j.a.colorNeutralBackground1,maxWidth:"inherit",paddingLeft:"25px",paddingRight:"0px","> span":{..._.a.overflow("hidden")},"&:focus-within":{backgroundColor:j.a.colorNeutralBackground1Hover}},descriptionSection:{color:j.a.colorNeutralForeground2Link,paddingBottom:"6px",paddingRight:"8px",paddingLeft:"8px"},installedSection:{display:"flex",paddingBottom:"10px",paddingTop:"2px",paddingLeft:"2px",paddingRight:"2px",flexDirection:"column",..._.a.gap("2px"),alignSelf:"stretch"},description:{paddingBottom:"6px",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:j.a.colorNeutralForeground2Link},footerSection:{height:"auto",width:"100%",..._.a.borderRadius("0px","0px","4px","4px")},dividerContainer:{paddingLeft:"2px",paddingRight:"14px"},footerContainer:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",paddingTop:"16px",paddingBottom:"12px",paddingRight:"12px"},morePlugins:{..._.a.borderRadius("4px"),..._.a.borderWidth("1px"),paddingTop:"5px",paddingBottom:"7px",paddingLeft:"12px",paddingRight:"12px",lineHeight:"20px",fontWeight:600,fontSize:"14px",fontStyle:"normal",color:j.a.colorNeutralForeground1},titleContainer:{display:"flex",flexDirection:"row",..._.a.gap("8px")},title:{color:j.a.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start",..._.a.gap("10px"),alignSelf:"stretch"},previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:{height:"16px",color:j.a.colorNeutralForeground2,backgroundColor:j.a.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px",..._.a.borderRadius("8px"),display:"flex",flexDirection:"row",alignSelf:"stretch",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"},shimmer:{display:"grid",position:"relative",gridTemplateColumns:"min-content 1fr 20%",alignItems:"center",..._.a.padding("6px","12px","6px","0px"),color:j.a.colorNeutralStencil1},shimmerCircle:{marginRight:"10px"},shimmerRectangle:{width:"60%"},shimmerElementRadius:{..._.a.borderRadius("2px")},labelInfo:{backgroundColor:j.a.colorNeutralBackground1,"&:focus-within":{backgroundColor:j.a.colorNeutralBackground1Hover,..._.a.border("2px","solid",j.a.colorNeutralBackground1Hover),..._.a.borderRadius(j.a.borderRadiusMedium)}}}));var fe=n(3598),me=n(3368);function ve(e){const t=e||6,n=l.memo((()=>{const e=he(),t=Object(C.a)(e.shimmerElementRadius,e.shimmerRectangle);return l.createElement(fe.a,{className:e.shimmer,animation:"wave",appearance:"translucent"},l.createElement(me.a,{shape:"circle",size:24,className:e.shimmerCircle}),l.createElement(me.a,{shape:"rectangle",size:8,className:t}),l.createElement(me.a,{shape:"rectangle",size:8,className:e.shimmerElementRadius}))}));return n.displayName="ShimmerComponent",l.createElement(l.Fragment,null,[...Array(t)].map(((e,t)=>l.createElement(n,{key:t}))))}ve.displayName="CopilotPluginFlyoutShimmerSection";const be=e=>{const{pluginGroupVM:t,dismissFlyoutCallback:n,enableCreatePpcConnections:r}=e,o=he(),[a,s]=l.useState(!1),c=()=>{s(!a)};const u=t.groupPlugins.length>1;const d=!!r&&function(e){return e.parentPlugin.plugin.powerPlatformConnectorId&&0==e.groupPlugins.length}(t),p=l.useMemo((()=>l.createElement(l.Fragment,null,d&&l.createElement(x.a,{persistOnClick:!0,tabIndex:-1,className:o.menuItem},ge({pluginVM:t.parentPlugin,isParentPlugin:!1,isUnconnectedPPC:!0,dismissFlyoutCallback:n})),u&&l.createElement(x.a,{persistOnClick:!0,tabIndex:-1,className:o.menuItem},ge({pluginVM:t.parentPlugin,isParentPlugin:!0,setShowPlugins:c})),(!u||a)&&t.groupPlugins.map(((e,n)=>{e.index=t.index,e.length=t.length;const r=`PluginItem-${Object(i.generateGuid)()}`;return l.createElement(x.a,{persistOnClick:!0,tabIndex:-1,className:u?o.subMenuItem:o.menuItem,key:n,"aria-labelledby":r},ge({pluginVM:e,isParentPlugin:!1,pluginId:r}))})))),[t,a]);return p},ye=e=>{const{pluginsGrouped:t,isPluginDataLoaded:n,dismissFlyoutCallback:r,enableCreatePpcConnections:o}=e;if(!n)return l.createElement(ve,null);const i=[];return t.forEach(((e,n)=>{const a={parentPlugin:e.parentPlugin,groupPlugins:e.groupPlugins,index:n+1,length:t.length};i.push(l.createElement(be,{pluginGroupVM:a,dismissFlyoutCallback:r,enableCreatePpcConnections:o,key:e.parentPlugin.plugin.id}))})),l.createElement(l.Fragment,null,i)},Ce="https://teams.microsoft.com/l/store?tabType=UserApps";const Oe=Object(T.a)("CopilotPluginStoreFrontListItemRenderer",Object(k.a)({image:{width:"2rem",height:"2rem",outlineOffset:"-0.1rem",..._.a.borderRadius(".6rem"),..._.a.outline(".1rem","solid",j.a.colorNeutralStroke2)},imageDiv:{marginRight:"0.6rem"},text:{fontWeight:400,fontSize:"0.9rem",lineHeight:"1.2rem",color:j.a.colorNeutralForeground1,textOverflow:"ellipsis",whiteSpace:"nowrap",..._.a.overflow("hidden")},textDesc:{fontWeight:400,fontSize:"0.7rem",lineHeight:"1rem",color:j.a.colorNeutralForeground1,textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",..._.a.overflow("hidden")},tileDiv:{display:"flex",marginRight:"1.6rem",height:"2.4rem",width:"11rem",alignItems:"center"},button:{paddingLeft:"0.2rem",paddingRight:"0.2rem",minWidth:"2.8rem",height:"1.6rem",..._.a.borderRadius(".4rem")},buttonDiv:{display:"flex",height:"2.4rem",alignItems:"center",paddingLeft:"0.2rem"},toolTipDiv:{width:"100%",display:"inline-block",backgroundColor:j.a.colorNeutralBackground1,":hover":{backgroundColor:j.a.colorNeutralBackground1Hover,"& span":{color:j.a.colorNeutralForeground1Hover}},paddingTop:"0.2rem",paddingBottom:"0.2rem"},privacyTermsDiv:{paddingLeft:"2.8rem",paddingRight:"0.6rem",paddingBottom:"0.5rem"}})),Se=Object(T.a)("CopilotPluginStoreFrontTermAndPrivacyRenderer",Object(k.a)({termAndPrivacyDiv:{display:"flex"},privacyButton:{fontSize:"smaller",paddingLeft:"0",paddingRight:"0.2rem",whiteSpace:"nowrap"},linkButton:{fontSize:"smaller",paddingLeft:"0.2rem",paddingRight:"0.2rem",whiteSpace:"nowrap"}})),Ee="https://teams.microsoft.com/l/app/{appId}?scrollToSection=permissions";function xe(e){const{appId:t,privacyUrl:n,termsOfUseUrl:i,sourceName:a}=e,{correlationVector:s,telemetryService:d,metaOsSdk:p}=l.useContext(c),h=Se(),f=Object(g.b)({privacyPolicyLinkText:X,termsOfUseLinkText:$,permissionsLinkText:ee}),m=l.useCallback((()=>{window.open(n)}),[]),b=l.useCallback((()=>{window.open(i)}),[]),y=l.useCallback((async()=>{const e=new r.a(o.d.StoreFrontCopilotPluginPermissions,o.c.StoreFrontCopilotPluginPermissionClick,d);try{if(p){const n=function(e,t){const n=Ee.replace("{appId}",e);if(!t)return n;switch(t.toLocaleLowerCase()){case u.OFFICE_WEB:case u.OWA_HUB:case u.TEAMS_HUB:}return n}(t,a);await p.appOpenLink(n),e.logMetricEnd({message:o.a.StoreFrontCopilotPluginPermissionsClickHostHandled},s)}else e.logMetricEndWithError({message:o.a.StoreFrontCopilotPluginPermissionsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:o.a.StoreFrontCopilotPluginPermissionsClickFailed,diagnosticsData:`App details page failed to open on clicking permissions url on the flyout. Error: ${n}`})}}),[p]);return l.createElement("div",{className:h.termAndPrivacyDiv},l.createElement(ae.a,{onClick:m,inline:!0,className:h.privacyButton},f.privacyPolicyLinkText()),l.createElement(v.a,{vertical:!0}),l.createElement(ae.a,{onClick:b,inline:!0,className:h.linkButton},f.termsOfUseLinkText()),l.createElement(v.a,{vertical:!0}),l.createElement(ae.a,{onClick:y,inline:!0,className:h.linkButton},f.permissionsLinkText()))}function Ie(e){const{appId:t,appName:n,imageUrl:r,appDescription:o,privacyUrl:i,termsOfUseUrl:a,onStoreFrontItemClick:s,sourceName:c}=e,[u,d]=l.useState(!1),p=Oe(),h=Object(g.b)({addButtonContentText:Z,addingButtonContentText:J}),m=l.useCallback((async()=>{d(!0),await s(),d(!1)}),[]);return l.createElement(y.a,{content:n,relationship:"label"},l.createElement("div",{className:p.toolTipDiv},l.createElement("div",{className:p.buttonDiv},l.createElement("div",{className:p.tileDiv},l.createElement("div",{className:p.imageDiv},l.createElement(w.a,{src:r,className:p.image,"aria-hidden":"true"})),l.createElement(f.a,{className:p.text},n)),l.createElement(b.a,{className:p.button,onClick:m,disabled:u},u?h.addingButtonContentText():h.addButtonContentText())),l.createElement("div",{className:p.privacyTermsDiv},l.createElement(f.a,{className:p.textDesc},o),l.createElement(xe,{appId:t,privacyUrl:i,termsOfUseUrl:a,sourceName:c}))))}function we(e){const{storeFrontPlugins:t,sourceName:n,fetchPluginsByNetwork:i}=e,a=[],{correlationVector:s,telemetryService:u}=l.useContext(c);return t.forEach((e=>{const t=e.plugin,c=async()=>{const n=new r.a(o.d.StoreFrontCopilotPluginItem,o.c.StoreFrontCopilotPluginItemClick,u);await e.onInstall()?(i(),n.logMetricEnd({message:o.a.StoreFrontCopilotPluginItemInstallSucceeded},s)):n.logMetricEndWithError({message:o.a.StoreFrontCopilotPluginItemInstallFailed,diagnosticsData:`store front plugin installation failed for plugin id: ${t.id}`})};t.largeImageUrl&&t.shortDescription&&t.privacyUrl&&t.termsOfUseUrl&&a.push(l.createElement("div",{key:t.id},l.createElement(Ie,{appId:t.id,appName:t.name,imageUrl:t.largeImageUrl,appDescription:t.shortDescription,privacyUrl:t.privacyUrl,termsOfUseUrl:t.termsOfUseUrl,onStoreFrontItemClick:c,sourceName:n})))})),0===a.length?null:l.createElement("div",null,a)}xe.displayName="CopilotPluginManagerStoreFrontTermAndPrivacyRenderer",Ie.displayName="CopilotPluginStoreFrontListItemRenderer",we.displayName="CopilotPluginStoreFrontListRenderer";const Te=Object(T.a)("CopilotPluginStoreFrontRenderer",Object(k.a)({renderDiv:{paddingTop:"0.2rem"},textDiv:{height:"1.6rem",paddingTop:"0.5rem",paddingLeft:"0.5rem"},text:{fontWeight:600,fontSize:"0.8rem",lineHeight:"1.2rem",color:j.a.colorNeutralForeground3}})),ke=8;function je(e){const{storeFrontPlugins:t,installedPlugins:n,searchText:r,fetchPluginsByNetwork:o,isInstalledPluginsDataLoaded:i,isStoreFrontPluginsDataLoaded:a,sourceName:s}=e,c=Te(),u=Object(g.b)({storeFrontTitleText:Y});if(!i||!a)return l.createElement(ve,{numShimmers:ke});if(t&&t.length>0){const e=t.filter((e=>{const t=e.plugin,n=r.toLowerCase();return 0===n.length||t.name.toLowerCase().includes(n)||t.shortDescription&&t.shortDescription.toLowerCase().includes(n)})).filter((e=>!n.some((t=>t.parentPlugin.plugin.metaOSAppId===e.plugin.id))));if(e.length>0){const t=e.slice(0,ke);return l.createElement("div",{className:c.renderDiv},l.createElement(v.a,null),l.createElement("div",{className:c.textDiv},l.createElement(f.a,{className:c.text},u.storeFrontTitleText())),l.createElement(we,{storeFrontPlugins:t,fetchPluginsByNetwork:o,sourceName:s}))}}return null}je.displayName="CopilotPluginStoreFrontRenderer";const Pe=250;function Ae(e){const{pluginsGrouped:t,isPluginDataLoaded:n,storeFrontPlugins:i,isStoreFrontPluginsDataLoaded:a,enableMorePlugins:s,sourceName:x,positioningRef:I,fetchPluginsByNetwork:w,enablePluginSearch:T,tokenService:k,enableManagePlugins:j,dismissFlyoutCallback:P,openFlyoutCallback:_,enableStoreFrontPlugins:D,enableCreatePpcConnections:L,mountTooltipToBody:M}=e,B=he(),{theme:R,isPreview:F,correlationVector:N,telemetryService:G,metaOsSdk:W,appStoreExtProvider:q}=l.useContext(c),[K,Y]=l.useState([]),[Z,J]=l.useState(""),X=Object(g.b)({pluginInfoIconDescription:z,pluginPreviewTitle:U,pluginTitle:H,pluginDescription:V,pluginMoreAppsText:te,searchInputPlaceholderText:Q,managePluginsText:ne});l.useEffect((()=>{n&&Y(t)}),[n]);const{findFirstFocusable:$}=Object(h.a)(),ee=l.useCallback((e=>{if(n){J(e);const n=t.filter((t=>t.parentPlugin.plugin.name.toLowerCase().includes(e)||t.groupPlugins.some((t=>t.plugin.name.toLowerCase().includes(e)))));Y(n)}}),[t,n]),re=Object(E.a)(((e,t={value:""})=>{ee(t.value.toLowerCase().trim())}),Pe),oe=l.useRef(null),ie=l.useRef(null);l.useEffect((()=>{I&&I.current&&I.current.updatePosition()}),[n]),l.useEffect((()=>{if(n)if(T&&oe.current)oe.current.focus();else if(ie.current){const e=$(ie.current);e&&e.focus()}}),[oe,ie,T,n]);const ae=X.pluginInfoIconDescription(),se=l.createElement(A,{infoMessage:ae,theme:R,mountTooltipToBody:M}),le=X.pluginPreviewTitle(),ce=F?l.createElement("div",{className:B.previewTitleContainer},l.createElement(f.a,{className:B.previewTitle},le)):null,ue=X.pluginTitle(),de=l.createElement("div",{className:B.descriptionSection},l.createElement("div",{className:B.titleContainer},l.createElement(f.a,{role:"heading","aria-level":1,"aria-label":"Heading: Plugins",className:B.title},ue),ce),T&&l.createElement(m.a,{ref:oe,"data-testid":"plugin-flyout-search-input","aria-label":X.searchInputPlaceholderText(),placeholder:X.searchInputPlaceholderText(),contentAfter:l.createElement(S.a,null),onChange:re,className:B.searchInputBox}),l.createElement(f.a,{className:B.description},X.pluginDescription()),se),pe=async()=>{const e=new r.a(o.d.MorePlugins,o.c.MorePluginsClick,G);try{if(W){const t=(await W.appGetContext()).page.sourceOrigin,n=function(e,t){if(!e)return d;switch(e.toLocaleLowerCase()){case u.OFFICE_WEB:return t?p.replace("{domain}",t):d;case u.OWA_HUB:case u.TEAMS_HUB:default:return d}}(x,t);await W.appOpenLink(n),e.logMetricEnd({message:o.a.MorePluginsClickHostHandled},N)}else e.logMetricEndWithError({message:o.a.MorePluginsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:o.a.MorePluginsClickFailed,diagnosticsData:`Store page failed to open on clicking more plugins button on the flyout. Error: ${n}`})}},ge=s?l.createElement("div",{className:B.footerSection},l.createElement(v.a,{className:B.dividerContainer}),l.createElement("div",{className:B.footerContainer},l.createElement(b.a,{className:B.morePlugins,onClick:()=>{if(q){const e=new r.a(o.d.MorePlugins,o.c.MorePluginsClick,G);q.openAppStore({tokenService:k,onAppInstallation:_}),P&&P(),e.logMetricEnd({message:o.a.MorePluginsClickHostHandled},N)}else pe()}},X.pluginMoreAppsText()),j&&l.createElement(y.a,{content:X.managePluginsText(),relationship:"label"},l.createElement(b.a,{icon:l.createElement(S.i,null),appearance:"transparent",onClick:async()=>{const e=new r.a(o.d.ManagePlugins,o.c.ManagePluginsClick,G);try{if(W){const t=function(e){if(!e)return Ce;switch(e.toLocaleLowerCase()){case u.OFFICE_WEB:case u.OWA_HUB:case u.TEAMS_HUB:}return Ce}(x);await W.appOpenLink(t),e.logMetricEnd({message:o.a.ManagePluginsClickHostHandled},N)}else e.logMetricEndWithError({message:o.a.ManagePluginsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:o.a.ManagePluginsClickFailed,diagnosticsData:`Store page failed to open on clicking manage plugins button on the flyout. Error: ${n}`})}}})))):null,fe=Object(C.a)(B.menuList,B.popOverScroll);return l.createElement(l.Fragment,null,l.createElement("div",null,de),l.createElement("div",{className:fe},l.createElement(O.a,null,l.createElement("div",{ref:ie},l.createElement("div",{className:B.installedSection},l.createElement(ye,{pluginsGrouped:K,isPluginDataLoaded:n,dismissFlyoutCallback:P,enableCreatePpcConnections:L})))),D&&l.createElement(je,{storeFrontPlugins:i,installedPlugins:t,isInstalledPluginsDataLoaded:n,fetchPluginsByNetwork:w,isStoreFrontPluginsDataLoaded:a,sourceName:x,searchText:Z})),l.createElement("div",null,ge))}var _e=n(1627),De=n(2445);const Le={..._e.a},Me={...De.a};function Be(e){const[t,n]=l.useState([]),[u,d]=l.useState(!1),[p,g]=l.useState([]),[h,f]=l.useState(!1),{pluginProvider:m,telemetryService:v,customStylingRequired:b,theme:y,isPreview:C,locale:O,enableMorePlugins:S,sourceName:E,positioningRef:x,enablePluginSearch:I,appStoreExtProvider:w,tokenService:T,metaOsSdk:k,enableManagePlugins:j,dismissFlyoutCallback:P,openFlyoutCallback:A,enableStoreFrontPlugins:_,enableCreatePpcConnections:D,mountTooltipToBody:L}=e,M=l.useMemo((()=>Object(i.generateGuid)()),[]),B=l.useMemo((()=>new r.a(o.d.LaunchPluginFlyout,o.c.CopilotPluginFlyout,v)),[]);l.useEffect((()=>{m.getPlugins(void 0,M,!0).then((e=>{e&&(n(e),d(!0))}))}),[]),l.useEffect((()=>{_&&m.getStoreFrontPlugins(M).then((e=>{e&&(g(e),f(!0))}))}),[_]),l.useEffect((()=>{B.logMetricEnd(void 0,M)}),[]),l.useEffect((()=>{const e=O?Object(a.toSupportedLocale)(O):Object(a.toSupportedLocale)("en-us");Object(a.getCurrentLocaleForDefaultStringProvider)().then((t=>{t!==O&&Object(a.setCurrentLocaleForDefaultStringProvider)(e)}))}),[O]);const R=l.useCallback((()=>{u&&(d(!1),m.getPlugins(void 0,M,!0,!0).then((e=>{e&&(n(e),d(!0))})))}),[u]),F=l.useMemo((()=>e.fluentTheme?e.fluentTheme:function(e){let t;return t=e?"light"===e?Le:Me:Le,t}(e.theme)),[e.fluentTheme,e.theme]);return l.createElement(s.a,{theme:F},l.createElement(c.Provider,{value:{telemetryService:v,correlationVector:M,customStylingRequired:b,theme:y,isPreview:C,appStoreExtProvider:w,metaOsSdk:k}},l.createElement(Ae,{pluginsGrouped:t,isPluginDataLoaded:u,storeFrontPlugins:p,isStoreFrontPluginsDataLoaded:h,enableMorePlugins:S,sourceName:E,positioningRef:x,fetchPluginsByNetwork:R,enablePluginSearch:I,tokenService:T,enableManagePlugins:j,dismissFlyoutCallback:P,openFlyoutCallback:A,enableStoreFrontPlugins:_,enableCreatePpcConnections:D,mountTooltipToBody:L})))}},3522:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(2),o=n(246),i=n(2851),a=n(3345),s=n(1),l=n(2119);var c=n(1627),u=n(2445);var d=Object(r.__assign)({},c.a),p=Object(r.__assign)({},u.a);function g(e){if(!e)return"";if(/<([A-Za-z][A-Za-z0-9]*)\b[^>]*>(.*?)<\/\1>/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}return e}var h=n(2804),f=n(2120),m=n(168),v=n(2170),b=n(3361),y=n(65),C=n(3398),O=n(3399),S=n(3378),E=n(2870),x=n(335),I=n(1543),w=n(139),T=Object(E.a)("ReferenceItem",Object(I.a)({link:Object(r.__assign)(Object(r.__assign)({},x.a.textDecoration("none")),{cursor:"pointer",":hover":Object(r.__assign)({},x.a.textDecoration("none")),":active":Object(r.__assign)({},x.a.textDecoration("none"))}),flexHorizontal:{display:"flex",flexDirection:"row",alignItems:"center",boxSizing:"border-box",justifyContent:"flex-start"},content:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({backgroundColor:w.a.colorNeutralBackground3,maxWidth:"168px",width:"fit-content"},x.a.padding("2px","8px","2px","0px")),x.a.overflow("hidden")),x.a.borderRadius("4px")),leftContainer:Object(r.__assign)({width:"20px",justifyContent:"center"},x.a.overflow("hidden")),dividerStyle:{height:"100%",flexGrow:0},rightContainer:{paddingLeft:"6px"},citationIndexText:{color:w.a.colorNeutralForeground2},text:Object(r.__assign)({color:w.a.colorNeutralForeground2,fontSize:w.a.fontSizeBase200,maxWidth:"115px",marginLeft:"4px"},x.a.overflow("hidden")),referenceIconContainer:{height:"16px"}})),k=n(115),j=n(3333),P=function(e){var t,n=e.name,o=e.url,i=e.referenceIndex,a=e.onLinkClick,l=e.slots,c=e.ariaLabel,u=e.ariaDescription,d=e.onRender,p=T(),g=(t=l,{components:{referenceIcon:"div"},referenceIcon:k.a.optional(null==t?void 0:t.referenceIcon,{elementType:"div",renderByDefault:!0,defaultProps:{children:s.createElement(j.a,{fontSize:16})}})});Object(m.a)(g);var h=Object(v.a)(g),f=h.slots,E=h.slotProps;return s.useEffect((function(){null==d||d()}),[]),s.createElement(b.a,{content:n||o||"",relationship:"label",positioning:"above"},s.createElement("a",{"aria-label":c,"aria-describedby":u,className:Object(y.a)(p.link,p.flexHorizontal,p.content),href:o,onClick:a,onKeyDown:function(e){return function(e,t){("Enter"===e.key||" "===e.key)&&(null==t||t(e))}(e,a)},target:"_blank","data-testid":"reference-item-url",rel:"noreferrer"},s.createElement("div",{className:Object(y.a)(p.flexHorizontal,p.leftContainer)},s.createElement(C.a,{wrap:!1,truncate:!0,className:p.citationIndexText},i)),s.createElement(O.a,{vertical:!0,className:p.dividerStyle}),s.createElement("div",{className:Object(y.a)(p.flexHorizontal,p.rightContainer)},s.createElement("div",{className:p.referenceIconContainer},s.createElement(f.referenceIcon,Object(r.__assign)({},E.referenceIcon))),s.createElement(S.a,{wrap:!1,truncate:!0,className:p.text},n||o))))},A=n(577),_=n(3382),D=n(1826),L=n(2796),M=n(2802);var B=Object(E.a)("MsgExtCardReference",Object(I.a)({root:{marginBottom:"5px",marginTop:"5px"},rootV2:{marginTop:"0px",marginBottom:"0px"},rootV2NoLink:{"> a":{cursor:"default"}},appIcon:Object(r.__assign)({width:"20px",height:"20px"},x.a.borderRadius(w.a.borderRadiusMedium)),appIconV2:{verticalAlign:"text-top"},title:{fontWeight:600,fontSize:"14px"},metaData:{fontSize:"12px",color:w.a.colorNeutralForeground1,colorbackground:w.a.colorNeutralBackground1,fontWeight:400},citationLink:{textDecorationLine:"none"}})),R=function(e,t){if(e&&t){var n=t.filter((function(e){return function(e){if(!e)return!1;var t=e.split("/")[0].split(".");if(t.length<=1)return!1;var n=t[t.length-1],r=t[t.length-2];return!n.includes("*")&&!r.includes("*")}(e)})),o=Object(r.__read)(Object(L.a)(n,(function(e){return e.includes("/")})),2),i=o[0];if(function(e,t){var n,o;try{for(var i=Object(r.__values)(Object(M.a)(t,(function(e){return e.toLowerCase()}))),a=i.next();!a.done;a=i.next()){for(var s=a.value,l="",c=s.split("."),u=0;u<c.length;u++)l+=(u>0?"[.]":"")+c[u].replace("*","[^/^.]+");var d=new RegExp("^".concat(l,"((/|\\?).*)?$"),"i"),p=new RegExp("^https://".concat(l,"((/|\\?).*)?$"),"i");if(e.match(d)||e.match(p))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!1}(e,o[1])||function(e,t){return!!t.some((function(t){var n=t.replace(new RegExp("[*]","g"),"(.*)"),r=new RegExp(n);return e.match(r)}))}(e,i))return!0}return!1},F=function(e){var t=e.cardUrl,n=e.cardTitle,o=e.citationIndex,i=e.appName,a=e.appIcon,l=e.idxRenderOnBcb,c=e.validDomains,u=e.sourceName,d=Object(A.c)(),p=B(),g=Object(r.__read)(s.useState(!1),2),m=g[0],v=g[1],b=function(n){t&&m&&(e.onLinkClickHandler?e.onLinkClickHandler(t):window.open(t)),null==n||n.preventDefault()};s.useEffect((function(){(Object(f.a)(u)||function(e){var t=new RegExp("https://nam.+.safelinks.protection.+/?url=.+");return!(!e||!e.match(t))}(t)||R(t,c))&&v(!0)}),[t,u,c]);var C=m?s.createElement(_.a,{appearance:"subtle",href:t,onClick:t?b:void 0},s.createElement("div",{className:p.title,"data-testid":"msgext-reference-title"},n)):s.createElement("div",null,n),O=s.createElement("a",{href:t,className:p.citationLink,target:"_blank",rel:"noopener noreferrer"},o),S=s.createElement("span",{className:p.metaData,"data-testid":"msgext-reference-primary-text"},i),E=s.createElement("span",{className:p.metaData,"data-testid":"msgext-reference-secondary-text"},e.cardSubText);return s.createElement("div",{className:e.isReferencesV2?Object(y.a)(p.rootV2,!t&&p.rootV2NoLink):p.root,"data-testid":"msgext-reference-container"},e.isReferencesV2?s.createElement(P,{name:n,url:m?t:void 0,referenceIndex:e.citationIndex,onLinkClick:t?b:void 0,slots:{referenceIcon:s.createElement(D.a,{size:16,className:p.appIconV2,image:{src:a}})}}):s.createElement(h.a,{media:s.createElement(D.a,{className:p.appIcon,"data-testid":"appIcon",image:{src:a}}),label:C,primaryText:S,secondaryText:E,referenceId:d,index:e.citationIndex,citation:l?O:void 0}))},N=function(e){var t,n,c={},u=e.cardDetails,h=e.citationIndex,f=e.tokenService,m=e.telemetryService,v=e.onLinkClickHandler,b=e.isReferencesV2,y=e.sourceName,C=e.appService,O=Object(r.__read)(s.useState(u.appName),2),S=O[0],E=O[1],x=Object(r.__read)(s.useState(u.appIcon),2),I=x[0],w=x[1],T=Object(r.__read)(s.useState(void 0),2),k=T[0],j=T[1],P=u.appId;s.useEffect((function(){!f||null!=S&&null!=I&&null!=k||function(e,t,n){var o,i,a,s,c,u,d;return Object(r.__awaiter)(this,void 0,void 0,(function(){var p,g,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),p=null!=n?n:new l.a(t),g={id:e},[4,p.getApp(g)];case 1:return h=r.sent(),[2,{appName:null===(i=null===(o=h.titleInfo)||void 0===o?void 0:o.titleDefinition)||void 0===i?void 0:i.name,appIcon:null===(c=null===(s=null===(a=h.titleInfo)||void 0===a?void 0:a.titleDefinition)||void 0===s?void 0:s.iconLarge)||void 0===c?void 0:c.uri,validDomains:null===(d=null===(u=h.titleInfo)||void 0===u?void 0:u.titleDefinition)||void 0===d?void 0:d.validDomains}];case 2:return r.sent(),[2,{appName:void 0,appIcon:void 0,validDomains:void 0}];case 3:return[2]}}))}))}(P,f,C).then((function(e){(null==e?void 0:e.appName)!==S&&E(null==e?void 0:e.appName),(null==e?void 0:e.appIcon)!==I&&w(null==e?void 0:e.appIcon),(null==e?void 0:e.validDomains)!==k&&j(null==e?void 0:e.validDomains)})).catch((function(e){null==m||m.LogException({type:o.e.LogException,name:o.k.MsgExtCardReference,tag:o.m.getAppDataException,success:o.j.Failure,props:c,diagnosticsData:"Error while getting the app data ".concat(e)})}))}),[P]);var A=s.useMemo((function(){return new i.a(m,o.h.ReferenceContainer,o.g.MsgExtCardReferenceContainer)}),[]),_=s.useMemo((function(){return JSON.parse(u.content)}),[u.content]),D=s.useMemo((function(){return function(e){var t,n,r;return e?g(null!==(r=null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.title)&&void 0!==r?r:""):""}(_)}),[_]),L=s.useMemo((function(){return function(e){var t,n,r,o,i,a,s,l,c,u;return e?(null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.subtitle)?g(null!==(i=null===(o=null===(r=e.preview)||void 0===r?void 0:r.content)||void 0===o?void 0:o.subtitle)&&void 0!==i?i:""):(null===(s=null===(a=e.preview)||void 0===a?void 0:a.content)||void 0===s?void 0:s.text)?g(null!==(u=null===(c=null===(l=e.preview)||void 0===l?void 0:l.content)||void 0===c?void 0:c.text)&&void 0!==u?u:""):void 0:""}(_)}),[_]),M=s.useMemo((function(){return function(e){var t,n;return e?null===(n=null===(t=e.content)||void 0===t?void 0:t.metadata)||void 0===n?void 0:n.webUrl:""}(_)}),[_]),B=function(e){var t=void 0;return e&&(t="dark"===e?p:d),null!=t?t:d}(null!==(t=e.theme)&&void 0!==t?t:"light");return s.useEffect((function(){var e={};e[o.l.citationIndex]=h,e[o.l.HasURL]=1,null!=M&&null!=M||(e[o.l.HasURL]=0),A.logMetricEnd({props:e,diagnosticsData:"TypeOfCard: ".concat(u.contentType,",  cardId : ").concat(u.cardId," }, isReferencesV2: ").concat(b)})}),[]),s.createElement(a.a,{theme:B},s.createElement(F,{citationIndex:h,cardTitle:null!=D?D:"",appIcon:null!=I?I:"",appName:null!=S?S:"",cardSubText:L,cardUrl:M,onLinkClickHandler:v,idxRenderOnBcb:null!==(n=e.idxRenderOnBcb)&&void 0!==n&&n,isReferencesV2:b,validDomains:k,sourceName:y}))}},3523:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var r=n(487);const o=3e5;class i{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.c.LogMetric,tag:this.tag,name:this.name,success:!1,duration:o,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),o)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.c.LogMetric,tag:this.tag,name:this.name,success:!0,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.c.LogMetric,tag:this.tag,name:this.name,success:!1,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}var a=n(406),s=n(142),l=n(65),c=n(3345),u=n(1814),d=n(1),p=n(2217),g=n(1477),h=n(1574);var f=n(1627),m=n(2445);const v=Object.assign({},f.a),b=Object.assign({},m.a);function y(e){if(e){if(e.startsWith("P_"))return e;if(e.startsWith("T_"))return"T_";if(e.startsWith("U_"))return"U_"}return""}const C=0;var O=n(1555),S=n(1573),E=n(3363),x=n(2870),I=n(1543),w=n(335);const T=Object(x.a)("AuthButtonAppIcon",Object(I.a)({appIconContainer:Object.assign({},w.a.margin("auto")),appIcon:Object.assign({width:"20px",height:"20px"},w.a.borderRadius("4px"))})),k=e=>{const{appIcon:t}=e,n=T();return d.createElement("div",{className:n.appIconContainer},d.createElement(E.a,{src:t,className:n.appIcon}))};var j=n(3583),P=n(3378);const A=Object(s.declareStringWithPlaceholders)("copilot-ext-auth-sdk.pluginAuthTextWithAppName"),_=Object(s.declareString)("copilot-ext-auth-sdk.pluginAuthTextWithoutAppName"),D=Object(s.declareStringWithPlaceholders)("copilot-ext-auth-sdk.pluginConfigTextWithAppName"),L=Object(s.declareString)("copilot-ext-auth-sdk.pluginConfigTextWithoutAppName"),M=Object(x.a)("AuthButtonTitle",Object(I.a)({titleContainer:Object.assign(Object.assign({},w.a.padding("0px 0px 2px 2px")),{display:"flex",flexDirection:"column",alignItems:"flex-start"}),title:Object.assign({fontWeight:"600",fontSize:"14px",lineHeight:"20px",textOverflow:"ellipsis"},w.a.overflow("ellipsis"))})),B=e=>{const{appName:t,requestType:n}=e,r=Object(j.c)({pluginAuthTextWithAppName:A,pluginConfigTextWithAppName:D}),o=Object(j.b)({pluginAuthTextWithoutAppName:_,pluginConfigTextWithoutAppName:L});let i;i="auth"===n||"silentAuth"===n||"APIPluginAuth"===n?t?r.pluginAuthTextWithAppName({appName:t}):o.pluginAuthTextWithoutAppName():t?r.pluginConfigTextWithAppName({appName:t}):o.pluginConfigTextWithoutAppName();const a=M();return d.createElement("div",{className:a.titleContainer},d.createElement(P.a,{className:a.title},i))},R=412,F=e=>{const{requestType:t,url:n,originalBotInvokeRequest:o,originalAPIPluginAuthRequest:f,activityProvider:m,resultCallBack:E,appService:x,theme:I,locale:w,telemetryService:T,scenarioName:j,customStyles:P,enableAPIPlugins:A,appId:_}=e,D="APIPluginAuth"===t;d.useEffect((()=>{A&&D&&async function(e,t,n,o,i,a){var s,l,c,u,d,p,g,h,f,m,v,b,O,S,E;try{const r={id:e},o=null===(l=null===(s=(await t.getApp(r)).titleInfo)||void 0===s?void 0:s.titleDefinition)||void 0===l?void 0:l.elementDefinitions;return{referenceId:null!==(m=null===(f=null===(h=null===(g=null===(p=null===(d=null===(u=null===(c=null==o?void 0:o.gpts)||void 0===c?void 0:c.find((e=>e.id===i)))||void 0===u?void 0:u.actions)||void 0===d?void 0:d.find((e=>e.id===a)))||void 0===p?void 0:p.runtimes)||void 0===g?void 0:g[n])||void 0===h?void 0:h.auth)||void 0===f?void 0:f.referenceId)&&void 0!==m?m:null===(E=null===(S=null===(O=null===(b=null===(v=null==o?void 0:o.plugins)||void 0===v?void 0:v[C])||void 0===b?void 0:b.runtimes)||void 0===O?void 0:O[n])||void 0===S?void 0:S.auth)||void 0===E?void 0:E.referenceId}}catch(t){return null==o||o.LogError({type:r.c.LogError,name:r.f.GetAppDataForRuntime,tag:r.h.GetAppDataForRuntime,success:!1,titleId:y(e),diagnosticsData:`Error while getting app data ${(null==t?void 0:t.message)||t}`}),{referenceId:void 0}}}(_,x,(null==f?void 0:f.pluginRuntimeId)||0,T,null==f?void 0:f.gptId,null==f?void 0:f.gptActionId).then((e=>{M({type:t,titleId:(null==f?void 0:f.titleId)||"",oauthConfigId:e.referenceId||"",url:n||"",onActivityCompletion:e=>Promise.resolve(!0)})}))}),[_,x]);const[L,M]=d.useState(D?A?{type:t,titleId:(null==f?void 0:f.titleId)||"",oauthConfigId:"",url:n||"",onActivityCompletion:e=>Promise.resolve(!0)}:void 0:{type:t,url:n||"",isSilent:!0,originalInvokeRequest:o,onActivityCompletion:e=>Promise.resolve(!0)}),F=Object(S.a)(),N=d.useMemo((()=>function(e){let t;return t=e?"light"===e?v:b:v,t}(I)),[I]),[H,U]=d.useState({appName:void 0,appIcon:void 0}),[V,z]=d.useState(void 0);d.useEffect((()=>{Object(h.a)(_,x,T).then((e=>{U(e)}))}),[_,x]),d.useEffect((()=>{const e=w?Object(s.toSupportedLocale)(w):Object(s.toSupportedLocale)("en-us");Object(s.getCurrentLocaleForDefaultStringProvider)().then((t=>{t!==w&&Object(s.setCurrentLocaleForDefaultStringProvider)(e)}))}),[w]);const G=d.useCallback((()=>{if(!L)return;const e=new i(r.e.AuthRenderingTime,r.d.AuthRenderingTime,T),t={};t[r.g.AuthScenario]=j,t[r.g.AuthType]=(e=>{switch(e.type){case"auth":return r.a.Auth;case"config":return r.a.Config;case"silentAuth":return r.a.SilentAuth;case"botInvoke":return r.a.BotInvoke;default:return r.a.Unknown}})(L);new p.a(m,T).execute(L).then((n=>{if("object"==typeof n){let o;switch(Object(g.b)(n)){case"result":M(void 0),e.logMetricEnd({props:t},Object(a.generateGuid)()),null==E||E(n);break;case void 0:e.logMetricEndWithError({props:t,diagnosticsData:"unknown auth response type"},Object(a.generateGuid)()),null==E||E(n);break;default:e.logMetricEnd({props:t,message:r.b.PartialAuthSuccess},Object(a.generateGuid)()),o=Object(O.a)(L,n),M(o)}}z(void 0)})).catch((n=>{if(n instanceof Response&&n.status===R&&V!==R&&"silentAuth"===L.type&&L.url)return z(R),M(Object.assign(Object.assign({},L),{type:"auth"})),void e.logMetricEndWithError({props:t,diagnosticsData:"Auth Request failed due to reconsent required [status: 412]"},Object(a.generateGuid)());z(void 0),e.logMetricEndWithError({props:t,diagnosticsData:`Error while handling auth response ${(null==n?void 0:n.message)||n}`},Object(a.generateGuid)())}))}),[m,L,E,j,T,V]);d.useEffect((()=>{"auth"===(null==L?void 0:L.type)&&V===R&&G()}),[L,V,G]);const W=P?{useButtonStyles_unstable:e=>{var t;const n=e;n.root.className=Object(l.a)(n.root.className,null===(t=P())||void 0===t?void 0:t.authButton)},useImageStyles_unstable:e=>{var t;const n=e;n.root.className=Object(l.a)(n.root.className,null===(t=P())||void 0===t?void 0:t.appIcon)},useTextStyles_unstable:e=>{var t;const n=e;n.root.className=Object(l.a)(n.root.className,null===(t=P())||void 0===t?void 0:t.title)}}:{};return L?d.createElement(c.a,{theme:N,customStyleHooks_unstable:W},d.createElement("div",null,d.createElement(u.a,{className:F.authButton,onClick:G,disabled:!L},d.createElement(k,{appIcon:H.appIcon}),d.createElement(B,{appName:H.appName,requestType:L.type})))):null}},3525:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,o=n(138),i=n(975),a=n(1),s=n(2),l=n(951);class c extends l.a{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class u extends c{constructor(e,t,n,r){super(n,r),this.notifySuccess=e,this.notifyFailure=t}}class d extends l.a{constructor(e){super(),this.dialogActions=e}open(e){throw new Error("Method not implemented.")}submit(e,t){return this.dialogActions.submit(e),Promise.resolve()}messageForParent(e){throw new Error("Method not implemented.")}messageForChild(e){throw new Error("Method not implemented.")}}class p{getLoadingUi(){return a.createElement(a.Fragment,null)}getErrorUi(e){return a.createElement(a.Fragment,null)}}function g(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:r.Unhandled,params:{url:new URL(e)}};const t=new URL(e);return t.pathname&&"https://teams.microsoft.com"===t.origin?function(e){var t;try{const[n,o,i,a]=e.pathname.split("/");if(""!==n||"m365Apps"!==o)throw new Error("Invalid Teams url format for App");if(!i)throw new Error("Invalid appId");const s=null!==(t=new URLSearchParams(e.search).get("webUrl"))&&void 0!==t?t:void 0;return{type:r.NavigateToApp,params:{appId:i,pageId:null!=a?a:"",webUrl:s}}}catch(e){return}}(t)||function(e){var t,n,o,i,a,s,l;try{if(!e)return;const c=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==c?void 0:c.length)||!c[1])throw new Error("Invalid Teams url format for TaskModule");const u={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},d={url:null!==(o=e.searchParams.get("url"))&&void 0!==o?o:void 0,fallbackUrl:null!==(i=e.searchParams.get("fallbackUrl"))&&void 0!==i?i:void 0,card:null!==(a=JSON.stringify(e.searchParams.get("card")))&&void 0!==a?a:void 0,width:u.width,height:u.height,title:null!==(s=e.searchParams.get("title"))&&void 0!==s?s:void 0,completionBotId:null!==(l=e.searchParams.get("completionBotId"))&&void 0!==l?l:void 0};return{type:r.TaskModule,params:{appId:c[1],taskInfo:d}}}catch(e){return}}(t)||f(t)||m(t)||h(t):{type:r.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.NavigateToApp="app",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(r||(r={}));const h=e=>({type:r.Unhandled,params:{url:e}});const f=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const o=t.searchParams.get("context");let i={};const a=decodeURIComponent(null!=o?o:"");return i=JSON.parse(a),{type:r.StageView,params:{appId:n[1],stageInfo:i}}}catch(e){return}},m=e=>{var t,n;try{const o=/^\/l\/entity\/([^/]+)\/([^/]+)$/,i=e,a=i.pathname.match(o);if(3!==(null==a?void 0:a.length))throw new Error("Invalid Teams url format for Tab");const s=a[1];let l;if(i.searchParams.has("context")){const e=i.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");l=JSON.parse(t)}const c={entityId:a[2],webUrl:null!==(t=i.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=i.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==l?void 0:l.subEntityId};return{type:r.LaunchPage,params:{appId:s,tabInfo:c}}}catch(e){return}};class v{constructor(e,t){this.actions=e,this.onNavigateToApp=t}openLink(e){var t,n;const o=g(e);return o?((null==o?void 0:o.type)===r.NavigateToApp&&(this.actions.close(),null===(t=this.onNavigateToApp)||void 0===t||t.call(this,null!==(n=o.params.appId)&&void 0!==n?n:"")),Promise.resolve()):Promise.reject()}}class b extends l.a{returnFocus(e){throw new Error("Method not implemented.")}setCurrentFrame(e){throw new Error("Method not implemented.")}navigateToApp(e){throw new Error("Method not implemented.")}shareDeepLink(e){throw new Error("Method not implemented.")}getConfig(){throw new Error("Method not implemented.")}}function y(e){var t;const n={authenticationService:new u((()=>Promise.resolve()),(()=>Promise.resolve()),e.tokenService,e.userContext),hubUiService:new p,linkService:new v(e.dialogActions,e.onNavigateToApp),pageService:new b,dialogService:new d(e.dialogActions)},r={user:e.userContext,app:e.hostContext,page:{id:(null===(t=e.appDefinition)||void 0===t?void 0:t.id)||"",frameContext:o.a.content,sourceOrigin:"https://teams.microsoft.com",subPageId:e.subEntityId}};return a.createElement(i.a,{hostWindow:window,hubServices:n,contentUrl:e.content.url,appDefinition:e.appDefinition,context:r})}},353:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));n(2),n(1531);var r,o=n(2823),i=(n(65),n(89)),a=(n(1606),n(1596));!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(r||(r={}));var s;r.defaultWhite;!function(e){e[e.Regular=0]="Regular",e[e.Ghost=1]="Ghost",e[e.File=2]="File",e[e.Skill=3]="Skill"}(s||(s={}));Object(o.a)(a.a);var l=function(){return"undefined"!=typeof OfficeaicopilotStrings};var c=function(){return{aadUserId:"",clientType:i.c.web,hubName:i.d.orange,locale:"en-US",physicalRing:"",sessionId:"",theme:i.e.default,userName:"",userPrincipalName:""}}},3537:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(2),i=n(241),a=n(1),s=n(1134);!function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(r||(r={}));var l,c,u;!function(e){e.Dogfood="dogfood",e.Production="production"}(l||(l={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.TestApp="TestApp"}(c||(c={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(u||(u={}));var d,p,g=function(){return"undefined"!=typeof OfficeaicopilotStrings};function h(e,t){var n=Array.from(e),r=new Blob([new Uint8Array(n)],{type:t||"image/png"}),o=new FileReader;return o.readAsDataURL(r),new Promise((function(e,t){o.onload=function(){var t=o.result;e(t)},o.onerror=function(){t(o.error)}}))}!function(e){e.DallEImages="DallEImages",e.DesignSuggestions="DesignSuggestions"}(d||(d={})),function(e){e.Production="Production",e.Dogfood="Dogfood",e.Automation="Automation",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Other="Other"}(p||(p={}));var f=function(e){var t,n,r=e.clientSettings,c=e.hostTokenProvider,d=e.isAuthEnabled,g=e.isRehydration,h=e.turnId,f=e.hostCallback,m=e.fileCacheInfo,v=function(e,t){return void 0===e&&(e=l.Production),void 0===t&&(t=!0),e===l.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))}(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,d),b=(void 0===(n=null==r?void 0:r.selectedDesignerEnv)&&(n=l.Production),n===l.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):new URL("https://designerapp.officeapps.live.com")),y=(null==r?void 0:r.clientId)||Object(s.a)(),C=(null==r?void 0:r.sessionId)||Object(s.a)(),O=Object(s.a)(),S=null==r?void 0:r.hostAppName,E="".concat(S,"-").concat(C),x=null==r?void 0:r.platformType,I=null==r?void 0:r.hostBuildVersion,w="".concat(S,"-").concat(x),T=null==r?void 0:r.audienceGroup,k=e.parentContainerIdentifier,j=a.useMemo((function(){var t,n,o,a,s,l;return{miniURL:v,serviceBaseURL:b,viewConfig:{view:i.e.Chat,theme:null!==(t=null==r?void 0:r.designerTheme)&&void 0!==t?t:i.d.Light,showFeedbackSection:!0},fileCacheInfoConfig:{hostCallback:null!=f?f:function(e){console.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:m},telemetryConfig:{audienceGroup:null!=T?T:p.Other,clientId:y,clientName:null!=S?S:"unknown",hostBuildVersion:null!=I?I:"unknown",hostEnvironment:w,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:C,correlationId:O,platform:(l=null!==(n=null==r?void 0:r.platformType)&&void 0!==n?n:u.Web,l===u.iOS?{platform:"iOS"}:l===u.Web?{platform:"Web"}:l===u.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform},container:document.getElementById(k),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(o=e.preferredCtaButtonLabel)&&void 0!==o?o:i.a.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(a=e.preferredImageFormat)&&void 0!==a?a:"png",hostTokenProvider:c,lng:null!==(s=null==r?void 0:r.uiLanguage)&&void 0!==s?s:"en-US"}}),[v,b,null==r?void 0:r.designerTheme,null==r?void 0:r.platformType,null==r?void 0:r.uiLanguage,f,m,y,S,I,w,C,O,k,e.preferredCtaButtonLabel,e.preferredImageFormat,c]),P=a.useCallback((function(e,t,n,r,a,s){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var l;return Object(o.__generator)(this,(function(c){switch(c.label){case 0:return[4,(l=new i.b(Object(o.__assign)(Object(o.__assign)({},j),{container:document.getElementById(e)}))).initialize(Object(o.__assign)({turnId:h,isRehydration:g,scenario:E,minCount:3,maxCount:4},null!=t?t:{}))];case 1:return c.sent(),n&&l.on("done",n),r&&l.on("customize",r),s&&l.on("feedback",s),a&&l.on("AnswerCardResize",a),[2,l]}}))}))}),[j,g,E,h]);return{designerMiniSettings:j,initializeDesignerMini:P}},m=n(35),v=Object(m.db)({container:{borderRadius:"8px",height:"400px",padding:"6px 0px",gap:"4px",alignItems:"flex-start",position:"relative",zIndex:"1",overflowWrap:"anywhere"},lightThemePalette:{backgroundColor:"#FFFFFF",boxShadow:"0px 1px 2px  #00000024, 0px 0px 2px #0000001f"},darkThemePalette:{backgroundColor:"#292929",boxShadow:"0px 1px 2px  #FFFFFF24, 0px 0px 2px #FFFFFF1f"}}),b=function(e){var t,n,r=a.useMemo((function(){return Object(s.a)()}),[]),l=a.useRef(),c=a.useRef(!1),u=g()?OfficeaicopilotStrings.DesignerPreviewLabel:"Designer Preview",p=f({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:r,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo}),m=p.initializeDesignerMini,b=p.designerMiniSettings,y=a.useCallback((function(t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n,r,i,a,s;return Object(o.__generator)(this,(function(l){switch(l.label){case 0:return(null===(r=t.options)||void 0===r?void 0:r.isUrl)&&t.uri?(null===(i=e.insertImagesInCanvas)||void 0===i||i.call(e,t.uri,Object(o.__assign)(Object(o.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri})),[3,3]):[3,1];case 1:return[4,h(t.media,t.mimeType)];case 2:n=l.sent(),null===(a=e.insertImagesInCanvas)||void 0===a||a.call(e,n,Object(o.__assign)(Object(o.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(s=t.options)||void 0===s?void 0:s.isUrl)?t.uri:void 0})),l.label=3;case 3:return[2]}}))}))}),[e]),C=a.useCallback((function(e){var t=document.getElementById(r);t&&(t.style.height="".concat(e.height,"px"))}),[r]),O=a.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,b)}),[b,e]),S=a.useCallback((function(t){!function(e,t,n,r){e===i.c.Like?r?null==t||t(r):null==t||t():e===i.c.Dislike&&(r?null==n||n(r):null==n||n())}(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),E=a.useMemo((function(){if(e.isStockQuery){var t=void 0;return t=e.imageType&&"enterprise"===e.imageType.toLowerCase()?e.companyName&&e.companyName.length>0?(n=g()?OfficeaicopilotStrings.ChatCardSourceEnterprise:"From %s content library",r=e.companyName,n.includes("%s")?n.replace("%s",r):n):"From your organization's asset library":g()?OfficeaicopilotStrings.ChatCardSourceStockContent:"From Microsoft 365 creative content library",Object(o.__assign)({stockContent:e.stockImages},void 0!==t&&{sourceDescription:t,artifactType:d.DesignSuggestions})}return e.dimensions?{dimensions:e.dimensions,text:e.userInput.trim(),artifactType:d.DesignSuggestions}:{text:e.userInput.trim(),sourceDescription:g()?OfficeaicopilotStrings.ChatCardSourceDALLE:"Powered by DALL-E 3",artifactType:d.DallEImages};var n,r}),[e.dimensions,e.isStockQuery,e.stockImages,e.userInput]);return a.useEffect((function(){c.current||m(r,E,y,O,C,S).then((function(e){l.current=e,c.current=!0})).catch((function(e){console.error(e)}))}),[E,m,C,O,y,S,r]),a.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&l.current&&l.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),a.createElement(a.Fragment,null,a.createElement("div",{id:r,key:r,className:"".concat(v.container," ").concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===i.d.Dark?v.darkThemePalette:v.lightThemePalette),tabIndex:0,"aria-label":u}))}},354:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r,o=n(2),i=n(1),a=n(32),s=n(147),l=n(175),c=n(1457),u=n(28),d=n(181),p=n(161),g=function(e){function t(t,n){var r=e.call(this)||this;return r.url=t,r.mimeType=n,r}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"mimeType",{get:function(){return this.getValue(t.mimeTypeProperty)},set:function(e){this.setValue(t.mimeTypeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.mimeTypeProperty=new a.n(a.s.v1_1,"mimeType"),t.urlProperty=new a.n(a.s.v1_1,"url"),t}(a.j),h=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.label=r,o}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this.getValue(t.labelProperty)},set:function(e){this.setValue(t.labelProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"CaptionSource"},t.prototype.render=function(e){return this.isValid()?i.createElement("track",{src:this.url,kind:"captions",label:this.label}):null},t.labelProperty=new a.n(a.s.v1_6,"label"),t}(g),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.render=function(){return this.isValid()?i.createElement("source",{src:this.url,type:this.mimeType}):null},t}(g),m=function(){function e(){this.isPlaying=!1}return e.prototype.play=function(){},Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){},enumerable:!1,configurable:!0}),e}(),v=function(e){function t(t){var n=e.call(this)||this;return n.owner=t,n._selectedSources=[],n._captionSources=[],n.processSources(),n}return Object(o.__extends)(t,e),t.prototype.processSources=function(){var e,n,r;this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;try{for(var i=Object(o.__values)(this.owner.sources),a=i.next();!a.done;a=i.next()){var s=a.value,l=s.mimeType?s.mimeType.split("/"):[];if(2===l.length){if(!this._selectedMediaType){var c=t.supportedMediaTypes.indexOf(l[0]);c>=0&&(this._selectedMediaType=t.supportedMediaTypes[c])}l[0]===this._selectedMediaType&&this._selectedSources.push(s)}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}(r=this._captionSources).push.apply(r,Object(o.__spreadArray)([],Object(o.__read)(this.owner.captionSources),!1))},t.prototype.canPlay=function(){return this._selectedSources.length>0},t.prototype.fetchVideoDetails=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2]}))}))},t.prototype.render=function(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio");var e=Object(s.b)();e["aria-label"]=this.owner.altText?this.owner.altText:this.owner.localizeString(l.a.mediaPlayerAriaLabel),e.playsInline=!0,e.crossOrigin="",e.autoPlay=!0,e.controls=!0,e.preload="none",e.style.width="100%",Object(s.f)()&&(e.muted=!0);var t=this.owner.sources.map((function(e){return e.render()})).filter((function(e){return void 0!==e})),n=this.owner.captionSources.filter((function(e){return"vtt"===e.mimeType})).map((function(e){return e.render()})).filter((function(e){return void 0!==e}));return i.createElement("video"===this._selectedMediaType?"video":"audio",e,t,n)},t.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.supportedMediaTypes=["audio","video"],t}(m),b=function(e){function t(t,n,r){var o=e.call(this,n)||this;return o.owner=t,o.matches=n,o.iFrameTitle=r,n.length>=2&&(o._videoId=n[1]),o}return Object(o.__extends)(t,e),t.prototype.canPlay=function(){return void 0!==this._videoId},t.prototype.render=function(){return i.createElement("div",{style:{position:"relative",width:"100%",height:"0",paddingBottom:"56.25%"}},i.createElement("iframe",{sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},src:this.getEmbedVideoUrl(),frameBorder:"0",title:this.iFrameTitle?this.owner.localizeString(this.iFrameTitle):void 0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))},Object.defineProperty(t.prototype,"videoId",{get:function(){return this._videoId},enumerable:!1,configurable:!0}),t}(function(e){function t(t){return e.call(this)||this}return Object(o.__extends)(t,e),t}(m));(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(o.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return e="https://vimeo.com/api/oembed.json?url=".concat(this.getEmbedVideoUrl()),[4,fetch(e)];case 1:return(t=r.sent()).ok?[4,t.json()]:[3,3];case 2:n=r.sent(),this.posterUrl=n.thumbnail_url,r.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://player.vimeo.com/video/".concat(this.videoId,"?autoplay=1")}})(b),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(o.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return e="https://api.dailymotion.com/video/".concat(this.videoId,"?fields=thumbnail_720_url"),[4,fetch(e)];case 1:return(t=r.sent()).ok?[4,t.json()]:[3,3];case 2:n=r.sent(),this.posterUrl=n.thumbnail_720_url,r.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://www.dailymotion.com/embed/video/".concat(this.videoId,"?autoplay=1")}}(b),function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.owner=t,o.matches=n,o.iFrameTitle=r,n.length>=3&&void 0!==n[2]&&(o._startTimeIndex=parseInt(n[2],10)),o}Object(o.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this.posterUrl=this.videoId?"https://img.youtube.com/vi/".concat(this.videoId,"/maxresdefault.jpg"):void 0,[2]}))}))},t.prototype.getEmbedVideoUrl=function(){var e="https://www.youtube.com/embed/".concat(this.videoId,"?autoplay=1");return void 0!==this._startTimeIndex&&(e+="&start=".concat(this._startTimeIndex)),e}}(b);!function(e){e[e.Loading=0]="Loading",e[e.ShowPoster=1]="ShowPoster",e[e.ShowPlayer=2]="ShowPlayer"}(r||(r={}));var y=function(e){return i.createElement("div",{tabIndex:0,role:"button","aria-label":e.ariaLabel,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.startPlayback()},onKeyDown:function(t){"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),t.stopPropagation(),e.startPlayback())},style:{position:"absolute",transform:"translate(-50%, -50%)",top:"50%",left:"50%",display:"flex",alignItems:"center",justifyContent:"center",width:"".concat(56,"px"),height:"".concat(56,"px"),border:"1px solid #eeeeee",borderRadius:"".concat(28,"px"),boxShadow:"0px 0px 10px #eeeeee",backgroundColor:"rgba(255, 255, 255, 0.9)",color:"black",cursor:"pointer"}},i.createElement(c.a,{name:"Play",iconSize:u.k.Large,iconStyle:u.l.Filled,iconColor:"black"}))},C=function(){function e(){}return e.registerMediaElement=function(t){var n,r=null!==(n=t.groupId)&&void 0!==n?n:e.defaultGroupId,o=e._groupedMediaElements.get(r);o||(o=new Set,e._groupedMediaElements.set(r,o)),o.add(t)},e.unregisterMediaElement=function(t){var n,r;try{for(var i=Object(o.__values)(e._groupedMediaElements.values()),a=i.next();!a.done;a=i.next()){a.value.delete(t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.stopPlayback=function(t,n){var r,i,a,s,l,c;if(t){if(h=e._groupedMediaElements.get(t))try{for(var u=Object(o.__values)(h),d=u.next();!d.done;d=u.next()){(v=d.value)!==n&&v.releaseDOMResources()}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}else try{for(var p=Object(o.__values)(e._groupedMediaElements),g=p.next();!g.done;g=p.next()){var h=Object(o.__read)(g.value,2)[1];if(!n||h.has(n))try{for(var f=(l=void 0,Object(o.__values)(h)),m=f.next();!m.done;m=f.next()){var v;(v=m.value)!==n&&v.releaseDOMResources()}}catch(e){l={error:e}}finally{try{m&&!m.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}}}catch(e){a={error:e}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}},e.stopPlaybackInChildren=function(t){var n,r,i,a;try{for(var s=Object(o.__values)(e._groupedMediaElements),l=s.next();!l.done;l=s.next()){var c=Object(o.__read)(l.value,2)[1];try{for(var u=(i=void 0,Object(o.__values)(c)),d=u.next();!d.done;d=u.next()){var p=d.value;p.hasAsParent(t)&&p.releaseDOMResources()}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.defaultGroupId="__defaultGroupId__",e._groupedMediaElements=new Map,e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.stopPlayback=function(e){C.stopPlayback(e)},t.stopPlaybackInChildren=function(e){C.stopPlaybackInChildren(e)},Object.defineProperty(t.prototype,"sources",{get:function(){return this.getValue(t.sourcesProperty)},set:function(e){this.setValue(t.sourcesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"captionSources",{get:function(){return this.getValue(t.captionSourcesProperty)},set:function(e){this.setValue(t.captionSourcesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"poster",{get:function(){return this.getValue(t.posterProperty)},set:function(e){this.setValue(t.posterProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"altText",{get:function(){return this.getValue(t.altTextProperty)},set:function(e){this.setValue(t.altTextProperty,e)},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){e.prototype.mounted.call(this),C.registerMediaElement(this)},t.prototype.unmounted=function(){e.prototype.unmounted.call(this),C.unregisterMediaElement(this)},t.prototype.getJsonTypeName=function(){return"Media"},t.sourcesProperty=new a.k(a.s.v1_1,"sources",(function(e){return new f})),t.captionSourcesProperty=new a.k(a.s.v1_6,"captionSources",(function(e){return new h})),t.posterProperty=new a.n(a.s.v1_1,"poster"),t.altTextProperty=new a.n(a.s.v1_1,"altText"),t}(d.d),S=function(e){var t,n=Object(o.__read)(i.useState(r.Loading),2),a=n[0],s=n[1];i.useEffect((function(){var t;(null===(t=e.mediaPlayer)||void 0===t?void 0:t.isPlaying)||(s(r.Loading),e.mediaPlayer&&e.mediaPlayer.fetchVideoDetails().then((function(){s(r.ShowPoster)})))}),[e.mediaPlayer,null===(t=e.mediaPlayer)||void 0===t?void 0:t.isPlaying]);switch(a){case r.Loading:return i.createElement("div",{style:{height:"".concat(e.placeholderHeight,"px")}});case r.ShowPoster:return function(){var t,n,a,c=null!==(a=null!==(t=e.posterUrl)&&void 0!==t?t:null===(n=e.mediaPlayer)||void 0===n?void 0:n.posterUrl)&&void 0!==a?a:e.defaultPosterUrl,u=null,p=void 0;if(c){var g={src:c,alt:e.localizeString(l.a.mediaPlayerPosterAltText),style:{width:"100%",height:"100%"}};u=e.renderImage({isSelectable:!1,allowExpand:!1},g)}else p="".concat(e.placeholderHeight,"px");var h=function(){e.startPlayback(),s(r.ShowPlayer)};return i.createElement("div",{role:"contentinfo","aria-label":e.ariaLabel,style:{position:"relative",display:"flex",height:p}},u,function(){if(e.mediaPlayer&&e.mediaPlayer.canPlay()){var t={ariaLabel:e.localizeString(l.a.mediaPlayerAriaLabel),startPlayback:h};return d.f.mediaPlayButtonRenderer?d.f.mediaPlayButtonRenderer(t):i.createElement(y,Object(o.__assign)({},t))}return null}())}();case r.ShowPlayer:return e.mediaPlayer?e.mediaPlayer.render():null}},E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.registerCustomMediaPlayers=function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(e=t._customMediaPlayers).push.apply(e,Object(o.__spreadArray)([],Object(o.__read)(n),!1))},t.prototype.createMediaPlayerFromRegistry=function(){var e,n,r,i,a,s;try{for(var l=Object(o.__values)(t._customMediaPlayers),c=l.next();!c.done;c=l.next()){var u=c.value;try{for(var d=(r=void 0,Object(o.__values)(this.sources)),p=d.next();!p.done;p=d.next()){var g=p.value;if(g.url)try{for(var h=(a=void 0,Object(o.__values)(u.urlPatterns)),f=h.next();!f.done;f=h.next()){var m=f.value.exec(g.url);if(null!==m)return u.createMediaPlayer(this,m)}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}},t.prototype.propertyChanged=function(t,n){this._mediaPlayer=void 0,e.prototype.propertyChanged.call(this,t,n)},t.prototype.internalRender=function(e){var t,n=this;void 0===this._mediaPlayer&&(this._mediaPlayer=this.createMediaPlayerFromRegistry(),!this._mediaPlayer&&this.hostConfig.media.useHTML5PlayerAsFallback&&(this._mediaPlayer=new v(this)));return i.createElement(S,{mediaPlayer:this._mediaPlayer,posterUrl:this.poster,defaultPosterUrl:this.hostConfig.media.defaultPoster,placeholderHeight:function(){switch(n.hostWidth){case u.j.VeryNarrow:return n.hostConfig.media.placeholderHeights.veryNarrow;case u.j.Narrow:return n.hostConfig.media.placeholderHeights.narrow;case u.j.Standard:return n.hostConfig.media.placeholderHeights.standard;default:return n.hostConfig.media.placeholderHeights.wide}}(),ariaLabel:null!==(t=this.altText)&&void 0!==t?t:this.localizeString(l.a.mediaPlayerAriaLabel),renderImage:function(e,t){return n.renderImage(e,t)},localizeString:function(e,t){return n.localizeString(e,t)},startPlayback:function(){n._mediaPlayer&&(n._mediaPlayer.isPlaying=!0),p.a.allowSimultaneousVideoPlayback||C.stopPlayback(void 0,n),n.mediaPlaybackStarted(n)}})},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._mediaPlayer&&(this._mediaPlayer.isPlaying=!1),this.updateLayout()},t.prototype.getResourceInformation=function(){var e,t,n,r,i=[];if(this._mediaPlayer){var a=this.poster?this.poster:this.hostConfig.media.defaultPoster;a&&i.push({url:a,mimeType:"image"})}try{for(var s=Object(o.__values)(this.sources),l=s.next();!l.done;l=s.next()){var c=l.value;c.isValid()&&i.push({url:c.url,mimeType:c.mimeType})}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}try{for(var u=Object(o.__values)(this.captionSources),d=u.next();!d.done;d=u.next()){var p=d.value;p.isValid()&&i.push({url:p.url,mimeType:p.mimeType})}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return i},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){var e;return null===(e=this._mediaPlayer)||void 0===e?void 0:e.selectedMediaType},enumerable:!1,configurable:!0}),t._customMediaPlayers=[],t}(O)},3549:function(e,t,n){"use strict";var r;function o(e,t,n){if(t){var r=window.navigator;if(r&&r.sendBeacon)try{return void r.sendBeacon(t,e)}catch(e){}!function(e,t,n){var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,n),r.send(e))}(e,t,n)}}function i(e,t,n,r){var o=[],i=e.map((function(e){return function(e,t,n){var r={};if(r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category,e.correlationId){var o=n.findIndex((function(t){return t===e.correlationId}));o<0&&(o=n.push(e.correlationId)-1),r.I=o}var i=e.type*a+e.level;return r.D=i,r}(e,r,o)})),s=function(e,t,n,r,o){var i={};i.T=e,i.L=t,i.S=n,i.I=r,o&&o.length>0&&(i.W=o);return i.V=1,i}(r,i,t,n,o);return JSON.stringify(s)}n.d(t,"a",(function(){return c})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={}));var a=1e3;var s=n(133),l=function(){function e(t,n,r){var a=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){a.triggerUpload(!1,!1)},this.flush=function(){a.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return a.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){(window.clearTimeout(a.timeoutId),a.logCache.length>0)&&(a.uploadId+=1,o(i(a.logCache,a.userSessionId,a.uploadId,a.timestampBase),a.remoteUrlEndpoint,n),a.logCache=[],a.timestampBase=Date.now());t&&(a.timeoutId=window.setTimeout(a.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t;var s=n+"?usid="+t;void 0!==r&&r.forEach((function(e,t){s+="&"+t+"="+e})),this.remoteUrlEndpoint=s,window.setTimeout((function(){return a.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===s.a.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}(),c=function(){function e(e,t,n){this.correlationId="",this.cache=new l(e,t,n)}return e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,n,r){u(this.cache,e,t,n,r,this.correlationId)},e.prototype.debugAssertTag=function(e,t,n,r){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,n,r){n&&u(this.cache,e,t,s.a.Error,r,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose},e}();function u(e,t,n,o,i,a){if(!(o>s.a.Info)){var l={timestamp:Date.now(),category:n,tag:t,level:o,type:r.Trace,message:i,correlationId:a};e.handleTrace(l)}}},3554:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(302),o=n(3579),i=n(2835),a=n(798),s=n(1),l=n(2),c=n(544),u=Object(c.a)("@1js/create-shared-react-context",{});var d=n(65),p=function(e,t){var n=u.get();return n[t]||(n[t]=s.createContext(e))}([],"ComponentStylingPureFluentOverrides");var g=n(1543);const h=function(e,t){function n(){var n=t(),r=Object(s.useContext)(p).map((function(t){return t[e]})).filter((function(e){return!!e})),o=Object(l.__assign)({},n),i=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],i=r.map((function(t){return t[e]})).filter((function(e){return!!e})),a=d.a.apply(void 0,Object(l.__spreadArray)([t],Object(l.__read)(i),!1));o[e]=a}};for(var a in n)i(a);return o}return n.componentName=e,n.__version="fluent",n}("DialogHeader",Object(g.a)({dialogHeader:{display:"flex",flexDirection:"row",marginBottom:"6px",paddingTop:"24px",paddingRight:"24px",paddingBottom:"0px",paddingLeft:"32px",width:"auto"},appNameLarge:{fontWeight:"bold",fontSize:"18px"},appName:{fontWeight:"bold",fontSize:"14px"},title:{fontSize:"12px"},dialogIcon:{minWidth:"24px",minHeight:"24px",maxHeight:"32px",maxWidth:"32px",marginRight:"16px"},cancelIcon:{marginLeft:"auto"}})),f="Close";function m(e){const t=h(),{appDefinition:n,dialogActions:l,title:c}=e,u=s.useMemo((()=>({src:n.largeImageUrl,imageFit:r.b.contain})),[n.largeImageUrl]);return s.createElement(o.a.Item,{className:t.dialogHeader},s.createElement(i.a,{className:t.dialogIcon,imageProps:u}),s.createElement(o.a,{verticalAlign:"center"},s.createElement(o.a.Item,{className:c?t.appName:t.appNameLarge},n.name),c?s.createElement(o.a.Item,{className:t.title},c):null),s.createElement(a.a,{title:f,"aria-label":f,onClick:l.close,iconName:"Cancel",className:t.cancelIcon}))}},3568:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o=n(2),i=n(1134),a=n(860);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(r||(r={}));var s=n(532),l=function(e){var t,n="inapp-feedback-element-id";return e&&(t=document.getElementById(e)),t||(t=document.getElementById(n)),t||((t=document.createElement("div")).id=n,document.body.appendChild(t)),t},c=n(125),u=n(52),d=n(75),p=n(260),g=n(239),h=n(895),f=function(){function e(){}return e.prototype.isFeatureGateEnabledFromClient=function(e){return console.log("Feature gate: ",e),!1},e.prototype.sendLoggingEventToClient=function(e,t){console.log("sendLoggingEventToClient: ",e),console.log("loggingEventArgs: ",t)},e.prototype.updateCopilotState=function(e){console.log("updateCopilotState: "+e)},e.prototype.feedbackButtonClicked=function(e,t,n,u){var f,m=p.a.getFeedbackSettings(),v=c.a.getInstance().getIsFluxFlowEnabled();m&&(null===(f=m.feedbackInitOptions)||void 0===f?void 0:f.appId)&&function(e){var t=e.appData,n=e.featureAreaName,a=void 0===n?"Copilot":n,c=e.inAppFeedbackRef,u=e.specificHvcVersion,d=e.majorVersion,p=e.feedbackInitOptions,g=e.ocvFeedbackHost,h=e.appEnvironment,f=void 0===h?r.DEV:h,m=e.language,v=void 0===m?"en":m,b=e.feedbackType,y=e.feedbackData,C=e.buttonTarget,O=e.isSydneyEnabled,S=e.createAndSubmitFeedbackDataUploadSignal;Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,n,h,m,E,x,I,w,T,k,j;return Object(o.__generator)(this,(function(P){switch(P.label){case 0:return e=Object(i.a)(),(p=Object(o.__assign)(Object(o.__assign)({},p),{authenticationType:null!==(m=null==p?void 0:p.authenticationType)&&void 0!==m?m:s.a.Unauthenticated,clientFeedbackId:e,clientName:g})).themeOptions||(p.themeOptions={baseTheme:"WindowsLight"}),void 0!==p.isProduction&&null!==p.isProduction||(p.isProduction=f===r.PRODUCTION),p.telemetry=Object(o.__assign)(Object(o.__assign)({},p.telemetry),{featureArea:a,sourceContext:O?"CopilotChatFeedback":null===(E=p.telemetry)||void 0===E?void 0:E.sourceContext,featureName:null===(x=null==y?void 0:y.contextData)||void 0===x?void 0:x.featureName,subFeatureName:null===(I=null==y?void 0:y.contextData)||void 0===I?void 0:I.subFeatureName}),p.feedbackConfig=Object(o.__assign)(Object(o.__assign)({},p.feedbackConfig),{appData:null!==(T=null===(w=p.feedbackConfig)||void 0===w?void 0:w.appData)&&void 0!==T?T:JSON.stringify(t),calloutTarget:C,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:s.c.CallOut,initialFeedbackType:b,invocationTimeStamp:Date.now(),isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isScreenRecordingEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:b==s.b.Smile?s.d.AIThumbsUp:s.d.AIThumbsDown},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0}),n=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){return e=new File([null===(t=null==y?void 0:y.contextData)||void 0===t?void 0:t.cardMetaData],"contextData.json",{type:"text/json"}),[2,new Promise((function(t){t([e])}))]}))}))},p.feedbackConfig.diagnosticsConfig=Object(o.__assign)(Object(o.__assign)({},p.feedbackConfig.diagnosticsConfig),{diagnosticsEndPoint:"ODS",diagnosticsUploadId:e,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:null!==(j=null===(k=p.feedbackConfig.diagnosticsConfig)||void 0===k?void 0:k.getContextData)&&void 0!==j?j:n}),S&&(p.feedbackConfig.diagnosticsConfig=Object(o.__assign)(Object(o.__assign)({},p.feedbackConfig.diagnosticsConfig),{extractFeedbackDataForHost:function(e){S(JSON.stringify(e),g)},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0})),h={hostName:"AppChatCopilot",locale:v,inAppFeedbackRef:l(c),specificHvcVersion:u,majorVersion:d},[4,Object(s.e)(h)];case 1:return P.sent(),Object(s.f)(p),[2]}}))}))}(Object(o.__assign)(Object(o.__assign)({},m),{feedbackData:t,ocvFeedbackHost:p.a.getAppName(),language:p.a.getLanguage(),appEnvironment:p.a.getEnvironment(),feedbackType:e==g.f.LIKE?a.b.Smile:a.b.Frown,appData:null!=n?n:m.appData,buttonTarget:u,isSydneyEnabled:v,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(d.h.EnableSendTenantFeedback)?h.a:void 0})),console.log("feedbackButtonClicked: "+e),console.log("feedbackData: "+t),console.log("telemetryData: "+n)},e.prototype.getALSession=function(){throw new Error("Method not implemented.")},e.prototype.getHostSettings=function(){throw new Error("Method not implemented.")},e.prototype.getAuthToken=function(){throw new Error("Method not implemented.")},e.prototype.getPythonMode=function(){return!1},e.prototype.shouldIgnoreResponse=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,!1]}))}))},e.prototype.shouldSendRequestToAugloop=function(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return Object(u.c)("shouldSendRequestToAugloop"),[2,!0]}))}))},e.prototype.getFeedbackData=function(){return{}},e.prototype.getOnClickHandler=function(e){return function(){}},e}()},3569:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"e",(function(){return b}));var r,o=n(2),i=n(1484),a=n(1494),s=n(699),l=n(1087);!function(e){e[e.Completed=0]="Completed",e[e.Canceled=1]="Canceled"}(r||(r={}));class c{constructor(e){this.isCanceled=!1,this.tasks=e}ExecuteTaskListSequentially(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){if(this.isCanceled)return{status:r.Canceled};let e=null;if(this.tasks)for(const t of this.tasks)try{if(e=yield t(e),this.isCanceled)return{status:r.Canceled}}catch(e){if(this.isCanceled)return{status:r.Canceled};throw e}return{status:r.Completed,result:e}}))}Cancel(){this.isCanceled=!0}}class u{static getInstance(){return u._instance||(u._instance=new u),u._instance}startVoiceInputTimer(e,t){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((()=>Object(o.__awaiter)(this,void 0,void 0,(function*(){yield f(t),console.log("Voice input timed out")}))),e)}stopVoiceInputTimer(){this.timerId&&clearTimeout(this.timerId)}}var d=n(1594);const p=(e,t,n,r,s,u)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){if(i.a.getInstance().setALSession(u),l.a.createInstance(t,n,e),null==l.a.GetInstance())throw new Error("realTimeTranscriptionConnection is null");const o=new c([()=>a.a.GetInstance().Initialize(e),()=>h(r)]);yield Object(d.a)(o),s(!1)}));function g(){return Object(o.__awaiter)(this,void 0,void 0,(function*(){let e=null;if(navigator.permissions)try{e=yield navigator.permissions.query({name:"microphone"})}catch(e){}return e}))}const h=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield g();console.log("Microphone Permission Status = "+(null==t?void 0:t.state)),(null==t?void 0:t.state)===s.d?e(s.c.Uninitialized):(null==t?void 0:t.state)===s.e&&e(s.c.Enabled)})),f=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){yield a.a.GetInstance().Pause(),e(!1)})),m=e=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){null!=l.a.GetInstance()&&(yield f(e),u.getInstance().stopVoiceInputTimer())})),v=(e,t,n,r,i)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){try{yield a.a.GetInstance().Resume(),n(!1),r(s.c.Enabled),i(!e),u.getInstance().startVoiceInputTimer(t,i)}catch(e){console.error("Error occurred - "+e),"ErrorAudioPermissionDeniedError"===e&&(yield a.a.GetInstance().Pause(),n(!0)),r(s.c.Uninitialized)}})),b=(e,t)=>Object(o.__awaiter)(void 0,void 0,void 0,(function*(){null!=l.a.GetInstance()&&u.getInstance().startVoiceInputTimer(e,t)}))},357:function(e,t,n){"use strict";var r=n(2),o=n(796),i=n(832),a=n(44),s=n(75),l=n(1139),c=n(1158),u=function(){function e(e){this.workflowDataMap=new Map,this.copilotCommunicationHandler=e,this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())}return e.getInstance=function(t){if(!e.instance){if(!t)throw new Error("WorkflowDataMap has not been initialized");e.instance=new e(t)}return e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.populateWorkflowDataMap=function(e){var t,n;try{for(var u=Object(r.__values)(e),d=u.next();!d.done;d=u.next()){var p=d.value,g={workflowInfo:p};this.workflowDataMap.set(p.workflowAnnotationType,g)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(s.h.IsQnASuggestionPillCachingEnabled)&&!this.workflowDataMap.has(o.c.getTypeName())&&this.workflowDataMap.set(o.c.getTypeName(),{workflowInfo:{workflowAnnotationType:o.c.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(s.h.IsSharedCopilotLabEnabled)&&(this.workflowDataMap.has(i.a.getTypeName())?this.workflowDataMap.get(i.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(i.a.getTypeName(),{workflowInfo:{workflowAnnotationType:i.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}})),this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(s.h.IsClpSensitivityInChatInputEnabled)&&!this.workflowDataMap.has(l.a.getTypeName())&&this.workflowDataMap.set(l.a.getTypeName(),{workflowInfo:{workflowAnnotationType:l.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:a.x}}),(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(s.h.IsCopilotPluginEnabled)||this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(s.h.IsPersistanceInPhase2UxEnabled))&&(this.workflowDataMap.has(c.a.getTypeName())?this.workflowDataMap.get(c.a.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(c.a.getTypeName(),{workflowInfo:{workflowAnnotationType:c.a.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}))},e.prototype.getWorkflowDataMap=function(e){return void 0===e&&(e=!1),e&&(this.workflowDataMap.clear(),this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister())),this.workflowDataMap},e.prototype.isWorkflowRegistered=function(e){return this.workflowDataMap.has(e)},e.prototype.getWorkflowAugloopTimeoutValue=function(e){return this.isWorkflowRegistered(e)?this.workflowDataMap.get(e).workflowInfo.augloopResponseTimeout:a.q},e.prototype.isAugloopResponseTimeoutRequired=function(e){return!!this.isWorkflowRegistered(e)&&this.workflowDataMap.get(e).workflowInfo.augloopResponseTimerRequired},e}();t.a=u},3570:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),o=n(241),i=n(1),a=n(1134),s=n(1015),l=n(206),c=n(1084),u=n(35),d=Object(u.db)({container:{borderRadius:"8px",height:"400px",padding:"6px 0px",gap:"4px",alignItems:"flex-start",position:"relative",zIndex:"1",overflowWrap:"anywhere"},lightThemePalette:{backgroundColor:"#FFFFFF",boxShadow:"0px 1px 2px  #00000024, 0px 0px 2px #0000001f"},darkThemePalette:{backgroundColor:"#292929",boxShadow:"0px 1px 2px  #FFFFFF24, 0px 0px 2px #FFFFFF1f"}}),p=function(e){var t,n,u=i.useMemo((function(){return Object(a.a)()}),[]),p=i.useRef(),g=i.useRef(!1),h=Object(l.c)(),f=function(e){var t,n=e.clientSettings,u=e.hostTokenProvider,d=e.isAuthEnabled,p=e.isRehydration,g=e.turnId,h=e.hostCallback,f=e.fileCacheInfo,m=Object(c.c)(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,d),v=Object(c.d)(null==n?void 0:n.selectedDesignerEnv),b=(null==n?void 0:n.clientId)||Object(a.a)(),y=(null==n?void 0:n.sessionId)||Object(a.a)(),C=(null==n?void 0:n.correlationId)||Object(a.a)(),O=null==n?void 0:n.hostAppName,S=(null==n?void 0:n.scenarioName)||"Other",E=null==n?void 0:n.platformType,x=null==n?void 0:n.hostBuildVersion,I="".concat(O,"-").concat(E),w=null==n?void 0:n.audienceGroup,T=e.parentContainerIdentifier,k=i.useMemo((function(){var t,r,i,a,c;return{miniURL:m,serviceBaseURL:v,viewConfig:{view:o.e.Chat,theme:null!==(t=null==n?void 0:n.designerTheme)&&void 0!==t?t:o.d.Light,showFeedbackSection:!0},fileCacheInfoConfig:{hostCallback:null!=h?h:function(e){console.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:f},telemetryConfig:{audienceGroup:null!=w?w:l.b.Other,clientId:b,clientName:null!=O?O:"unknown",hostBuildVersion:null!=x?x:"unknown",hostEnvironment:I,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:y,correlationId:C,platform:Object(s.c)(null!==(r=null==n?void 0:n.platformType)&&void 0!==r?r:l.e.Web).platform},container:document.getElementById(T),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(i=e.preferredCtaButtonLabel)&&void 0!==i?i:o.a.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(a=e.preferredImageFormat)&&void 0!==a?a:"png",hostTokenProvider:u,lng:null!==(c=null==n?void 0:n.uiLanguage)&&void 0!==c?c:"en-US"}}),[m,v,null==n?void 0:n.designerTheme,null==n?void 0:n.platformType,null==n?void 0:n.uiLanguage,h,f,b,O,x,I,y,C,T,e.preferredCtaButtonLabel,e.preferredImageFormat,u]),j=i.useCallback((function(e,t,n,i,a,s){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var l;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return[4,(l=new o.b(Object(r.__assign)(Object(r.__assign)({},k),{container:document.getElementById(e)}))).initialize(Object(r.__assign)({turnId:g,isRehydration:p,scenario:S,minCount:3,maxCount:4},null!=t?t:{}))];case 1:return c.sent(),n&&l.on("done",n),i&&l.on("customize",i),s&&l.on("feedback",s),a&&l.on("AnswerCardResize",a),[2,l]}}))}))}),[k,p,S,g]);return{designerMiniSettings:k,initializeDesignerMini:j}}({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:u,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo}),m=f.initializeDesignerMini,v=f.designerMiniSettings,b=i.useCallback((function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o,i,a,l;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return(null===(o=t.options)||void 0===o?void 0:o.isUrl)&&t.uri?(null===(i=e.insertImagesInCanvas)||void 0===i||i.call(e,t.uri,Object(r.__assign)(Object(r.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri})),[3,3]):[3,1];case 1:return[4,Object(s.a)(t.media,t.mimeType)];case 2:n=c.sent(),null===(a=e.insertImagesInCanvas)||void 0===a||a.call(e,n,Object(r.__assign)(Object(r.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(l=t.options)||void 0===l?void 0:l.isUrl)?t.uri:void 0})),c.label=3;case 3:return[2]}}))}))}),[e]),y=i.useCallback((function(e){var t=document.getElementById(u);t&&(t.style.height="".concat(e.height,"px"))}),[u]),C=i.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,v)}),[v,e]),O=i.useCallback((function(t){var n=t.type;Object(s.d)(n,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),S=i.useMemo((function(){if(e.isStockQuery){var t=void 0;return t=e.imageType&&"enterprise"===e.imageType.toLowerCase()?e.companyName&&e.companyName.length>0?Object(s.b)(Object(l.j)(),e.companyName):"From your organization's asset library":Object(l.k)(),Object(r.__assign)({stockContent:e.stockImages},void 0!==t&&{sourceDescription:t,artifactType:l.a.DesignSuggestions})}return e.dimensions?{dimensions:e.dimensions,text:e.userInput.trim(),artifactType:l.a.DesignSuggestions}:{text:e.userInput.trim(),sourceDescription:Object(l.i)(),artifactType:l.a.DallEImages}}),[e.dimensions,e.isStockQuery,e.stockImages,e.userInput]);return i.useEffect((function(){g.current||m(u,S,b,C,y,O).then((function(e){p.current=e,g.current=!0})).catch((function(e){console.error(e)}))}),[S,m,y,C,b,O,u]),i.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&p.current&&p.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),i.createElement(i.Fragment,null,i.createElement("div",{id:u,key:u,className:"".concat(d.container," ").concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===o.d.Dark?d.darkThemePalette:d.lightThemePalette),tabIndex:0,"aria-label":h}))}},3577:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2173),o=n(2089),i=n(54),a=n(1606),s=n(2),l=function(e){function t(t,n,r,o,i,a,s,l,c,u,d){var p=e.call(this,r,o,i,a,s,l,c,u,d)||this;return p.taskModuleLauncher=t,p.clientInfo=n,p}return Object(s.__extends)(t,e),t.prototype.launchModalDialogContainer=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t?[4,this.getAppDefinition(e.appId)]:[2,Promise.reject("Dialog content not found")];case 1:return(n=o.sent())?(r={dialogContent:t,appDefinition:n,cardData:JSON.stringify(e.cardData)},this.taskModuleLauncher?[4,this.taskModuleLauncher(r)]:[3,3]):[2,Promise.reject("App definition not found")];case 2:return o.sent(),[2,Promise.resolve({status:"Success"})];case 3:return[2,Promise.resolve({status:"Failure"})]}}))}))},t.prototype.openTaskModule=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){return t=this.getDialogFromTaskInfo(e.taskInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t.prototype.openStageView=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){return t=this.getDialogFromStageInfo(e.stageInfo),[2,this.launchModalDialogContainer(e,t)]}))}))},t}(n(1131).MsgExtPreviewHostService),c=function(){function e(){}return e.prototype.getRecord=function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return{type:e.type.toString(),tag:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",name:null!==(o=null===(r=e.name)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",source:null!==(a=null===(i=e.source)||void 0===i?void 0:i.toString())&&void 0!==a?a:"",duration:null!==(l=null===(s=e.duration)||void 0===s?void 0:s.toString())&&void 0!==l?l:"",success:null!==(u=null===(c=e.success)||void 0===c?void 0:c.toString())&&void 0!==u?u:"",correlationVector:null!==(p=null===(d=e.correlationVector)||void 0===d?void 0:d.toString())&&void 0!==p?p:""}},e.prototype.LogInfo=function(e){},e.prototype.LogError=function(e){},e.prototype.LogException=function(e){},e.prototype.LogWarning=function(e){},e.prototype.LogVerbose=function(e){},e.prototype.LogMetric=function(e){},e}(),u=function(){function e(e){this.cardProps=e}return e.prototype.getDisplayExternalUrlWarning=function(){return function(e){return new Promise((function(t,n){e?setTimeout((function(){return t()}),2e3):n("CardId is missing")}))}},e.prototype.isValidMessageForMsgExtCard=function(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((function(e){return!!e.cardJson}))},e.prototype.getCardReferences=function(e){var t,n,r=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];var i=new o.a({},null,null===(t=this.cardProps.clientInfo)||void 0===t?void 0:t.locale,"",null===(n=this.cardProps.clientInfo)||void 0===n?void 0:n.theme);return e.map((function(e,t){return{index:t+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:r,content:e.cardJson,config:i}}))},e.prototype.getCardServiceProps=function(){return this.cardProps},e.prototype.getMsgExtCardService=function(){var e,t=this.cardProps.tokenService,n=this.cardProps.appService,o=this.cardProps.channelService,s=this.cardProps.clientInfo,u=null===(e=this.cardProps)||void 0===e?void 0:e.telemetryService,d=this.cardProps.taskModuleLauncher,p={host:{clientType:s.clientType,name:s.hubName,sessionId:s.sessionId,version:a.b},locale:s.locale,sessionId:s.sessionId,theme:s.theme},g={dataResidency:i.d.Public,id:s.aadUserId,displayName:s.userName,userPrincipalName:s.userPrincipalName};u||(u=new c);var h=document.createElement("div"),f=new l(d,s,(function(){return h}),g,p,n,t,(function(){throw new Error("Not implemented")}),o,void 0,this.getDisplayExternalUrlWarning());return{hostService:f,tokenService:t,appService:n,cardService:new r.a(f,o,n),telemetryService:u,channelService:o}},e}()},3583:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n(1),o=n(899),i=n(142);function a(e,t){return Object(i.isDevLocalization)()?t():e.lookupString(t.key)()}function s(e,t,n){return Object(i.isDevLocalization)()?t(n):e.lookupString(t.key)(n)}var l=function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},c=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function u(e){var t=Object(o.b)(),n=Object.keys(e),i=n.map((function(t){return e[t]}));return Object(r.useMemo)((function(){return n.reduce((function(n,r){var o;return l(l({},n),((o={})[r]=function(){return a(t,e[r])},o))}),{})}),c(c([t],n,!0),i,!0))}function d(e){var t=Object(o.b)(),n=Object.keys(e),i=n.map((function(t){return e[t]}));return Object(r.useMemo)((function(){return n.reduce((function(n,r){var o;return l(l({},n),((o={})[r]=function(n){return s(t,e[r],n)},o))}),{})}),c(c([t],n,!0),i,!0))}function p(e){return a(Object(o.b)(),e)}},3584:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(1),i=n(544),a=Object(i.a)("@1js/create-shared-react-context",{});var s=n(65),l=function(e,t){var n=a.get();return n[t]||(n[t]=o.createContext(e))}([],"ComponentStylingPureFluentOverrides");function c(e,t){function n(){var n=t(),i=Object(o.useContext)(l).map((function(t){return t[e]})).filter((function(e){return!!e})),a=Object(r.__assign)({},n),c=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],o=i.map((function(t){return t[e]})).filter((function(e){return!!e})),l=s.a.apply(void 0,Object(r.__spreadArray)([t],Object(r.__read)(o),!1));a[e]=l}};for(var u in n)c(u);return a}return n.componentName=e,n.__version="fluent",n}},3589:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(142),o=n(3583),i=n(3378),a=n(1);const s=Object(r.declareStringWithPlaceholders)("copilot-ext-auth-sdk.pluginAuthErrorWithAppNameText"),l=Object(r.declareString)("copilot-ext-auth-sdk.pluginAuthErrorWithoutAppNameText"),c=Object(r.declareStringWithPlaceholders)("copilot-ext-auth-sdk.pluginConfigErrorWithAppNameText"),u=Object(r.declareString)("copilot-ext-auth-sdk.pluginConfigErrorWithoutAppNameText");var d=n(1574),p=n(1573);const g=e=>{const{requestType:t,appId:n,appService:g,locale:h,telemetryService:f}=e,m=Object(p.a)(),[v,b]=a.useState(void 0);a.useEffect((()=>{Object(d.a)(n,g,f).then((e=>{b(e.appName)}))}),[n,g]),a.useEffect((()=>{const e=h?Object(r.toSupportedLocale)(h):Object(r.toSupportedLocale)("en-us");Object(r.getCurrentLocaleForDefaultStringProvider)().then((t=>{t!==h&&Object(r.setCurrentLocaleForDefaultStringProvider)(e)}))}),[h]);const y=Object(o.c)({pluginAuthErrorWithAppNameText:s,pluginConfigErrorWithAppNameText:c}),C=Object(o.b)({pluginAuthErrorWithoutAppNameText:l,pluginConfigErrorWithoutAppNameText:u});let O;return O="auth"===t||"silentAuth"===t?v?y.pluginAuthErrorWithAppNameText({appName:v}):C.pluginAuthErrorWithoutAppNameText():v?y.pluginConfigErrorWithAppNameText({appName:v}):C.pluginConfigErrorWithoutAppNameText(),a.createElement("div",{className:m.errorText},a.createElement(i.a,null,O))}},359:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return S}));var r=n(313),o=n(71);const i=Object(r.b)("MsgExtCardStoreActionPolicy",{cardsMap:new o.a}),a=Object(r.d)("updateActionabilityStatus",((e,t)=>{var n,r,o;const a=null===(r=null===(n=i())||void 0===n?void 0:n.cardsMap)||void 0===r?void 0:r.get(e);a?a.actionabilityStatus=t:null===(o=i().cardsMap)||void 0===o||o.set(e,{actionabilityStatus:t})}));var s,l,c,u,d,p,g,h,f,m,v=n(570);!function(e){e.Unknown="Unknown",e.Success="Success",e.Partial="Partial",e.Failed="Failed",e.Error="Error"}(s||(s={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(l||(l={})),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(c||(c={})),function(e){e.DeleteCard="DeleteCard",e.CopyCard="CopyCard",e.ManualRefresh="ManualRefresh",e.GetApp="GetApp",e.CardCopied="CardCopied"}(u||(u={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.NeedsConsentForUpgrade=3]="NeedsConsentForUpgrade"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.MailEditor=1]="MailEditor",e[e.MailReadingPane=2]="MailReadingPane",e[e.MailEditorReplyForward=3]="MailEditorReplyForward",e[e.MailReadingPaneFromExProp=4]="MailReadingPaneFromExProp"}(p||(p={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(g||(g={})),function(e){e[e.Full=0]="Full",e[e.Limited=1]="Limited",e[e.None=2]="None",e[e.Unknown=3]="Unknown"}(h||(h={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(f||(f={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth"}(m||(m={}));const b=Object(r.d)("updateDisabledActionabilityReason",((e,t)=>{var n,r;const o=null===(r=null===(n=i())||void 0===n?void 0:n.cardsMap)||void 0===r?void 0:r.get(e);o&&(o.reason=t)}));var y,C;!function(e){e[e.error=0]="error",e[e.info=1]="info",e[e.warning=2]="warning"}(y||(y={})),function(e){e[e.AppNotInstalled=0]="AppNotInstalled",e[e.AppNotAvailable=1]="AppNotAvailable",e[e.ComposeScenario=2]="ComposeScenario"}(C||(C={}));Object(r.e)(v.f,(e=>{var t,n,r,o,i,s,l;let c;const u=Object(v.d)(e.cardId),p=Object(v.b)(e.cardId);let g=h.None;p===d.Installed?g=h.Full:("compose"===u&&(g=h.Limited,c={type:C.ComposeScenario,messageType:y.info}),p===d.NotInstalled?c={type:C.AppNotInstalled,messageType:y.error}:p===d.NotAvailable&&(c={type:C.AppNotAvailable,messageType:y.error}));const f=null!==(o=null===(r=null===(n=null===(t=e.appInfo)||void 0===t?void 0:t.bots)||void 0===n?void 0:n[0])||void 0===r?void 0:r.id)&&void 0!==o?o:null===(l=null===(s=null===(i=e.appInfo)||void 0===i?void 0:i.inputExtensions)||void 0===s?void 0:s[0])||void 0===l?void 0:l.botId;if(f){const t=Object(v.c)(e.cardId);t&&(t.botId=f,Object(v.g)(e.cardId,t))}a(e.cardId,g),b(e.cardId,c)}));function O(e){var t,n,r;return null===(r=null===(n=null===(t=i())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===r?void 0:r.actionabilityStatus}function S(e){var t,n,r;return null===(r=null===(n=null===(t=i())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===r?void 0:r.reason}},3612:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(2),o=n(1),i=n(544),a=Object(i.a)("@1js/create-shared-react-context",{});var s=n(65),l=function(e,t){var n=a.get();return n[t]||(n[t]=o.createContext(e))}([],"ComponentStylingPureFluentOverrides");function c(e,t){function n(){var n=t(),i=Object(o.useContext)(l).map((function(t){return t[e]})).filter((function(e){return!!e})),a=Object(r.__assign)({},n),c=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],o=i.map((function(t){return t[e]})).filter((function(e){return!!e})),l=s.a.apply(void 0,Object(r.__spreadArray)([t],Object(r.__read)(o),!1));a[e]=l}};for(var u in n)c(u);return a}return n.componentName=e,n.__version="fluent",n}function u(e){var t=l.Consumer,n=l.Provider;return function(i){var a=i.children,s={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=e[l];c&&(s[l]=c())}return o.createElement(t,null,(function(e){var t=Object(r.__spreadArray)([s],Object(r.__read)(e),!1);return o.createElement(n,{value:t},a)}))}}},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));var r=n(718),o=n(59),i=function(){function e(){}return e.useMarkdownInRadioButtonAndCheckbox=!0,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!0,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!1,e.defaultUnlocalizableStringFallback="Undefined",e.allowDelayedContainerRendering=!0,e.useBorderColorForSeparator=!1,e.failRenderingWhenUnknownPropertiesAreFound=!1,e.failRenderingWhenInvalidPropertyValuesAreFound=!1,e.fluentIconCdnBasePath="https://res-1.cdn.office.net/assets/fluentui-react-icons/2.0.226/",e.enableIconSupportForActionButtons=!1,e.allowSimultaneousVideoPlayback=!1,e}(),a=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r},s=function(e,t,n,r){void 0===e&&(e=o.p.None),void 0===t&&(t=o.p.None),void 0===n&&(n=o.p.None),void 0===r&&(r=o.p.None),this.top=o.p.None,this.right=o.p.None,this.bottom=o.p.None,this.left=o.p.None,this.top=e,this.right=t,this.bottom=n,this.left=r},l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,o.o.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var i=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(i&&i.length>=a)return r.physicalSize=parseInt(i[1],10),3===i.length&&"px"===i[2]&&(r.unit=o.o.Pixel),r}throw new Error("Invalid size: ".concat(t))},e}();var c=function(){function e(e,t){void 0===e&&(e=o.i.Wide),this.width=e,this.condition=t}return e.parse=function(t){var n,i,a=Object(r.a)(o.q).join("|"),s=Object(r.a)(o.i).join("|"),l=new RegExp("^(?:(".concat(a,"):)?(").concat(s,")$"),"i").exec(t);if(l&&l.length>=3){var c=new e,u=null===(n=l[1])||void 0===n?void 0:n.toLowerCase();if(void 0!==u){var d=Object(r.b)(o.q,u);if(void 0===d)return;c.condition=d}var p=null===(i=l[2])||void 0===i?void 0:i.toLowerCase();if(void 0!==p){var g=Object(r.b)(o.i,p);if(void 0===g)return;return c.width=g,c}}},e.prototype.matches=function(e){return void 0===this.condition?this.width===e:this.condition===o.q.AtLeast?this.width<=e:e<=this.width},e.prototype.toString=function(){return void 0!==this.condition?"".concat(o.q[this.condition],":").concat(o.i[this.width]):o.i[this.width]},e}(),u=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&r|128]+e.lut[r>>8&255]+"-"+e.lut[r>>16&255]+e.lut[r>>24&255]+e.lut[255&o]+e.lut[o>>8&255]+e.lut[o>>16&255]+e.lut[o>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();u.initialize()},391:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"h",(function(){return C})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return S}));var r,o=n(2),i=n(1545),a=n(1470),s=n(36),l=n(894),c=n(472),u=n(143),d=n(144),p=n(133),g=0;!function(e){e.ErrorAugloopActivateAnnotations="ErrorAugloopActivateAnnotations"}(r||(r={}));var h=function(e,t,n){var r=new i.a({item:{id:g.toString(),body:t}});e.submitCustomMessage({message:r}).catch((function(e){S(e,n)}))},f=function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return u.a.sendTraceTag(508151006,d.a.msoulscat_Wac_Dictation,p.a.Info,"Start to activate annotations of: "+t),r?[4,e.activateAnnotation({annotationType:t,handler:function(e){n&&n.onAnnotationResult(e)}})]:[3,2];case 1:return a=o.sent(),[3,4];case 2:return[4,e.activateAnnotation({annotationType:t})];case 3:a=o.sent(),o.label=4;case 4:return(i=a)||u.a.sendTraceTag(508151005,d.a.msoulscat_Wac_Dictation,p.a.Error,"activateAnnotationAsync: Missing activationResult!"),[2,null==i?void 0:i.token]}}))}))},m=function(e,t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return u.a.sendTraceTag(508151004,d.a.msoulscat_Wac_Dictation,p.a.Info,"Releasing annotation tokens: ".concat(t)),n=t.map((function(t){return u.a.sendTraceTag(508151003,d.a.msoulscat_Wac_Dictation,p.a.Info,"Start to release annotation of: "+t),t?e.releaseAnnotation({token:t}).catch((function(e){u.a.sendTraceTag(508151002,d.a.msoulscat_Wac_Dictation,p.a.Error,"Failed to release annotation ".concat(t,": ").concat(e.message))})):Promise.resolve()})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},v=function(e,t,n,r,o,i){var a=n.dictationLanguage,s=n.useAutoPunctuation,f=n.useCorrections,m=n.useVoiceCommands;u.a.sendTraceTag(508151001,d.a.msoulscat_Wac_Dictation,p.a.Info,"Sending empty warm-up tile, seq: ".concat(g,", dictationLanguage: ").concat(a,", useAutoPunctuation: ").concat(s,", useCorrections: ").concat(f,", useVoiceCommands: ").concat(m,", speechToTextProfile: ").concat(o));var v=new l.b({sampleRate:c.b,useFrontdoorWorkflow:t,seq:g,dictationSettings:n,responseVersion:r,speechToTextProfile:o,commandSet:["warm-up"]});h(e,v,i),g+=1},b=function(e,t,n,r){u.a.sendTraceTag(508151e3,d.a.msoulscat_Wac_Dictation,p.a.Info,"Sending empty tile with endVoiceSession:true, seq: ".concat(g));var o=new l.b({endVoiceSession:!0,sampleRate:c.b,useFrontdoorWorkflow:t,seq:g,dictationSettings:n});h(e,o,r),g+=1},y=function(e,t,n,r,o,i,a,s,c){void 0===c&&(c=[]);var u=new l.b({sampleRate:n,useFrontdoorWorkflow:r,seq:g,dictationSettings:o,responseVersion:i,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return h(e,u,s),g+=1,u},C=function(e){var t="".concat(e).trimLeft();if(t.startsWith("[object "))try{var n=(null==e?void 0:e.name)&&(null==e?void 0:e.message)?"".concat(e.name,": ").concat(e.message):(null==e?void 0:e.message)?e.message:(null==e?void 0:e.name)?e.name:JSON.stringify(e);return n?t+" "+n:t}catch(e){var r="stringifyException error: ".concat(e.name,": ").concat(e.message);return u.a.sendTraceTag(508150999,d.a.msoulscat_Wac_Dictation,p.a.Error,r),t+" "+r}return t};var O=function(e,t){return s.a.getTypeNameFor(e)!==a.a.getTypeName()&&s.a.getTypeNameFor(e)!==a.b.getTypeName()||0===e.items.length?[]:e.items.filter((function(e){return e.body&&s.a.getTypeNameFor(e.body)===t}))};function S(e,t){var n,r;(null==t?void 0:t.onTileSubmitFailed)&&t.onTileSubmitFailed();var o=null!==(r=null!==(n=null==e?void 0:e.error)&&void 0!==n?n:null==e?void 0:e.message)&&void 0!==r?r:null==e?void 0:e.toString();switch(o){case"Timeout waiting for response":case"Cancelled":case"Message is dropped as oldest in full queue":return;default:u.a.sendTraceTag(508150998,d.a.msoulscat_Wac_Dictation,p.a.Error,"submitVoiceTile error: ".concat(C(o)))}}},399:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(44).w,o=function(e){r=e},i=function(){return r}},402:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(52),o=n(44),i=n(159),a=n(547),s=n(17),l=n(105),c=n(239),u=n(357),d=n(325),p=n(1139),g=n(796),h=n(125),f=n(171),m=n(326),v=n(75),b=n(571),y=function(){function e(e,t){var n=this;this.augloopResponseTimerID=null,this.augloopResponseTimeout=o.q,this.telemetryLoggerUtils=f.a.getInstance(),this.augloopResponseTimeoutInternal=function(){n.augloopResponseTimerID=null,Object(r.c)("Augloop Response Timed Out for workflow",n.workflowAnnotationType),d.a.getInstance().clearOperationListForResubmit(),n.augloopResponseTimeout=o.q;var e=!0,t=o.w;n.copilotCommunicationHandler.isFeatureGateEnabledFromClient(v.h.EnableALCorrelationLogs)&&(t=b.a.getInstance().getQueryCv()),n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:s.k.ErrorParameter,value:s.f.AugloopResponseTimeout},{key:s.k.ErrorType,value:s.e.Server}]),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:s.g.ChatEventType,value:s.f.AugloopResponseTimeout},{key:s.g.ChatErrorType,value:s.e.Server},{key:s.g.ChatEventParameters,value:n.workflowAnnotationType},{key:s.g.ChatErrorKey,value:s.d.AugloopResponseTimeoutMessage},{key:s.g.Cv,value:t},{key:s.g.ALSessionKey,value:b.a.getInstance().getAlSessionKey()}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:s.h.ErrorMessage,value:o.c},{key:s.h.ErrorType,value:s.e.Server},{key:s.h.ErrorCode,value:v.g.AugloopResponseTimeout},{key:s.h.ErrorCategory,value:a.a.ChatEvents}]),n.workflowAnnotationType===p.a.getTypeName()?n.setSensitivityWarningInfo():(h.a.getInstance().getIsBasicChatStreaming()&&n.workflowAnnotationType===g.b.getTypeName()&&(h.a.getInstance().handleTimeoutForBasicChatStreaming(),e=!1),n.copilotCommunicationHandler.sendEventToClient(c.c.AugloopResponseTimeout,{workflowAnnotationType:n.workflowAnnotationType}),m.a.Instance.ErrorMessage="Augloop_Response_TimedOut_"+n.workflowAnnotationType),e&&n.telemetryLoggerUtils.sendTelemetryLatencyData([{key:s.k.UserPerceivedLatency,value:Object(l.c)(l.d)},{key:s.k.IsQuerySuccess,value:!1}],!0)},this.copilotCommunicationHandler=e,this.setSensitivityWarningInfo=t}return e.getInstance=function(t,n){if(!e.sInstance){if(!t||!n)throw new Error("AugloopResponseTimeoutHandler has not been initialized");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(e){var t;Object(r.c)("Setting augloop response Timer for workflow ".concat(e)),this.clearAugloopResponseTimer(),Object(i.d)(e)||(this.workflowAnnotationType=e),Object(i.d)(this.workflowAnnotationType)||(this.augloopResponseTimeout=u.a.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)),this.augloopResponseTimeout=null!==(t=this.augloopResponseTimeout)&&void 0!==t?t:o.q,this.augloopResponseTimerID=window.setTimeout(this.augloopResponseTimeoutInternal,this.augloopResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(){null!==this.augloopResponseTimerID&&(Object(r.c)("Clear augloop response Timer"),clearTimeout(this.augloopResponseTimerID),this.augloopResponseTimerID=null,this.augloopResponseTimeout=o.q)},e.prototype.isAugloopResponseTimerSet=function(){return!Object(i.d)(this.augloopResponseTimerID)},e}()},406:function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}n.r(t),n.d(t,"isGuidNullOrEmpty",(function(){return i})),n.d(t,"isValidGuid",(function(){return a})),n.d(t,"generateGuid",(function(){return s}));var o="00000000-0000-0000-0000-000000000000";function i(e){return!e||e===o}function a(e){return!i(e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function s(){for(var e=r(),t=0,n="",o=0;o<36;o++)switch(o){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[o-t]%4+8).toString(16);break;default:n+=(e[o-t]%16).toString(16)}return n}},44:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"p",(function(){return a})),n.d(t,"q",(function(){return s})),n.d(t,"x",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"G",(function(){return p})),n.d(t,"D",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"w",(function(){return m})),n.d(t,"O",(function(){return v})),n.d(t,"v",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"I",(function(){return C})),n.d(t,"m",(function(){return O})),n.d(t,"c",(function(){return S})),n.d(t,"l",(function(){return E})),n.d(t,"r",(function(){return x})),n.d(t,"i",(function(){return I})),n.d(t,"W",(function(){return w})),n.d(t,"Q",(function(){return T})),n.d(t,"X",(function(){return k})),n.d(t,"T",(function(){return j})),n.d(t,"U",(function(){return P})),n.d(t,"V",(function(){return A})),n.d(t,"db",(function(){return _})),n.d(t,"eb",(function(){return D})),n.d(t,"Z",(function(){return L})),n.d(t,"cb",(function(){return M})),n.d(t,"gb",(function(){return B})),n.d(t,"fb",(function(){return R})),n.d(t,"hb",(function(){return F})),n.d(t,"ab",(function(){return N})),n.d(t,"bb",(function(){return H})),n.d(t,"jb",(function(){return U})),n.d(t,"wb",(function(){return V})),n.d(t,"nb",(function(){return z})),n.d(t,"qb",(function(){return G})),n.d(t,"pb",(function(){return W})),n.d(t,"kb",(function(){return Q})),n.d(t,"mb",(function(){return q})),n.d(t,"sb",(function(){return K})),n.d(t,"ob",(function(){return Y})),n.d(t,"rb",(function(){return Z})),n.d(t,"lb",(function(){return J})),n.d(t,"ub",(function(){return X})),n.d(t,"ib",(function(){return $})),n.d(t,"z",(function(){return ee})),n.d(t,"S",(function(){return te})),n.d(t,"R",(function(){return ne})),n.d(t,"n",(function(){return re})),n.d(t,"g",(function(){return r})),n.d(t,"xb",(function(){return ie})),n.d(t,"yb",(function(){return ae})),n.d(t,"N",(function(){return se})),n.d(t,"M",(function(){return le})),n.d(t,"t",(function(){return ce})),n.d(t,"u",(function(){return ue})),n.d(t,"K",(function(){return de})),n.d(t,"L",(function(){return oe})),n.d(t,"tb",(function(){return pe})),n.d(t,"Y",(function(){return ge})),n.d(t,"o",(function(){return he})),n.d(t,"B",(function(){return fe})),n.d(t,"P",(function(){return me})),n.d(t,"F",(function(){return ve})),n.d(t,"y",(function(){return be})),n.d(t,"J",(function(){return ye})),n.d(t,"C",(function(){return Ce})),n.d(t,"d",(function(){return Oe})),n.d(t,"e",(function(){return Se})),n.d(t,"A",(function(){return Ee})),n.d(t,"E",(function(){return xe})),n.d(t,"H",(function(){return Ie})),n.d(t,"vb",(function(){return we}));var r,o=n(159),i=" ",a="CopilotChat",s=6e4,l=15e3,c=5e3,u="I'm still learning and can't do this just yet. Is there something else I can do to help",d="Sorry, something went wrong. I'm working on it.",p=200,g=2e3,h=10,f=40,m="",v=" ",b="...",y="https://augloop-dogfood.officeppe.com",C=6e3,O="Choose a starter prompt from the suggestions menu to get started",S="Augloop Response Timed Out",E="Chat History Response Timed Out",x=1e4,I="https://go.microsoft.com/fwlink/?linkid=2259761",w=function(){return Object(o.e)()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},T=function(){return Object(o.e)()?OfficeaicopilotStrings.ChangeTopicButtonLabel:"Change topic"},k=function(){return Object(o.e)()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},j=function(){return Object(o.e)()?OfficeaicopilotStrings.CopilotPromptLibraryHeader:"Prompts from Copilot Lab"},P=function(){return Object(o.e)()?OfficeaicopilotStrings.CopilotLabLaunchertext:"See all prompts in Copilot Lab"},A=function(){return Object(o.e)()?OfficeaicopilotStrings.CopilotLabMenuSubItem:"View more prompts"},_=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorOffensiveInputContent:"Sorry, I can't work with that. Try making a new request."},D=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorOffensiveOutputContent:"Sorry, I can't generate content for this. Try making a new request."},L=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorInputBlockedByDynamicGuardList:"It looks like there's some content here I can't work with. Try asking me to do something else."},M=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorInvalidSignal:"Something went wrong. Please try again in a moment."},B=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorTimeout:"I can't process your request right now. Try again in a little while. "},R=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorThrottled:"The maximum number of requests per hour has been reached. Try again in a little while."},F=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorUserThrottled:"You're only allowed a certain number of requests per second. Try again in a little while."},N=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorInputTooLong:"This is too much information for me to process. Try again with a request that's less than 15,000 words."},H=function(){return Object(o.e)()?OfficeaicopilotStrings.ErrorInvalidLanguage:"Your request includes a language I don't currently support."},U=function(){return Object(o.e)()?OfficeaicopilotStrings.LearnMoreString:"Learn More"},V=function(){return Object(o.e)()?OfficeaicopilotStrings.WorkingOnItString:"Working on it..."},z=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringFinishingUp:"Finishing up..."},G=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringGettingReady:"Getting ready..."},W=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringGettingEverythingReady:"Getting everything ready..."},Q=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringCraftingContent:"Crafting your content..."},q=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringFinishingTouches:"Applying the finishing touches..."},K=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringWorkingOnRequest:"Working on your request..."},Y=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringGatheringResources:"Gathering resources..."},Z=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringLoadingConversation:"Loading conversation..."},J=function(){return Object(o.e)()?OfficeaicopilotStrings.LoadingUIStringCreateNewConversation:"Creating a new conversation..."},X=function(){return Object(o.e)()?OfficeaicopilotStrings.PaneLoadingUIString:"Please wait for the pane to finish loading"},$=function(){return Object(o.e)()?OfficeaicopilotStrings.InActiveChatSessionErrorString:"This chat session has ended. Please close and reopen this app for a new session."},ee=function(){return Object(o.e)()?OfficeaicopilotStrings.LicenseValidationErrorMessage:"We encountered a problem validating your Copilot license. For more information, see https://aka.ms/copilotlicensecheck"},te=function(){return Object(o.e)()?OfficeaicopilotStrings.ChatHistoryPanelTitle:"Copilot Chats"},ne=function(){return Object(o.e)()?OfficeaicopilotStrings.ChatHistoryPanelEmptyConversationName:"Empty chat"},re="Ask a question";!function(e){e.Opera="Opera",e.Safari="Safari",e.PhantomJS="PhantomJS",e.Edge="Edge",e.Electron="Electron",e.Chrome="Chrome",e.MSIE="MSIE",e.Firefox="Firefox",e.SkypeShell="SkypeShell",e.Unknown="Unknown"}(r||(r={}));var oe,ie=100,ae=16,se="Prompt",le="UTC",ce="UserExperience",ue="PromptLibrary",de="EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion";!function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(oe||(oe={}));var pe=function(){return Object(o.e)()&&OfficeaicopilotStrings.MicrophoneListeningGhostText?OfficeaicopilotStrings.MicrophoneListeningGhostText:"Listening..."},ge=function(){return Object(o.e)()?OfficeaicopilotStrings.CIQDefaultPlaceholder:"Start typing to search"},he="ChatWrapperId",fe="messagesStartID",me="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",ve="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",be="https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",ye=10,Ce=3,Oe="https://edgeservices.bing.com/edgesvc/chat?udsframed=1&form=SHORUN&clientscopes=chat,noheader,udsedgeshop,channelcanary,ntpquery,devtoolsapi,udsinwin11,clipboardcontext,udsdlpconsent,udscstart,cspgrd&lightschemeovr=1",Se="Web Chat",Ee=4e3,xe="acquired",Ie="OnWithAllowList",we=function(e){return"Great! ".concat(e," has been successfully added and is ready to improve your Copilot experience.")}},448:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n(680),o=n(52),i=n(207),a=n(171),s=n(17),l=n(75),c=r.a.CurrentContext.toString(),u=!1,d=function(e){c=e},p=function(e,t){var n=r.a.CurrentContext.toString();e&&(n+="+Work"),t&&(n+="+Web"),c=n},g=function(){return c},h=function(e){u=e},f=function(){if(u){var e=c===r.a.Work?i.d.Enterprise:i.d.Document;return Object(o.c)("Orchestrator grounding mode used for Chat:",e),e}},m=function(e,t){b("".concat(v(e.id),":").concat(t))},v=function(e){switch(e){case l.j.ENTERPRISE_SEARCH:return r.a.Work;case l.j.WEB_SEARCH:return r.a.Web;default:return e}},b=function(e){a.a.getInstance().sendTelemetryChatEventData([{key:s.g.ChatEventType,value:s.f.GroundingSourceUpdated},{key:s.g.ChatEventParameters,value:e}])}},451:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){null==t?console.log("Augloop Log:",e):console.log("Augloop Log:",e,t)}},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){null==t?console.log("Augloop Log:",e):console.log("Augloop Log:",e,t)}},453:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){null==t?console.log("Augloop Log:",e):console.log("Augloop Log:",e,t)}},455:function(e,t,n){"use strict";var r,o,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(r||(r={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(o||(o={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(i||(i={}))},467:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(r||(r={}));var o=r.defaultWhite,i=!1,a=!1,s=function(e){o=e},l=function(){return o},c=function(){return i},u=function(e){i=e},d=function(e){a=e},p=function(){return a}},472:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r=16e3,o=16,i=function(e,t){var n=a(e,t,r),o=new ArrayBuffer(2*n.length),i=new DataView(o);return s(i,0,n),i},a=function(e,t,n){if(n===t||n>t)return e;if(null==e)return new Float32Array(0);for(var r=t/n,o=Math.round(e.length/r),i=new Float32Array(o),a=0,s=0;s<o;){for(var l=Math.round((s+1)*r),c=0,u=0;a<l&&a<e.length;)c+=e[a],a+=1,u+=1;i[s]=c/u,s+=1}return i},s=function(e,t,n){for(var r=0,o=t;r<n.length;r+=1,o+=2){var i=Math.max(-1,Math.min(1,n[r]));e.setInt16(o,i<0?32768*i:32767*i,!0)}}},474:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,r){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(r,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")},unknownProperty:function(e){return'Unknown property "'.concat(e,'"')}},e.hints={dontUseWeightedAndStretchedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.overflowButtonText={key:"overflowButtonText",defaultValue:"..."},e.overflowButtonTooltip={key:"overflowButtonTooltip",defaultValue:"More options"},e.mediaPlayerAriaLabel={key:"mediaPlayerAriaLabel",defaultValue:"Media content"},e.mediaPlayerPlayMedia={key:"mediaPlayerPlayMedia",defaultValue:"Play media"},e.youTubeVideoPlayer={key:"youTubeVideoPlayer",defaultValue:"YouTube video player"},e.vimeoVideoPlayer={key:"vimeoVideoPlayer",defaultValue:"Vimeo video player"},e.dailymotionVideoPlayer={key:"dailymotionVideoPlayer",defaultValue:"Dailymotion video player"},e.mediaPlayerPosterAltText={key:"mediaPlayerPosterAltText",defaultValue:"Video poster"},e.emptyElementText={key:"emptyElementText",defaultValue:"Empty {{elementType}}"},e}()},487:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"g",(function(){return d})),function(e){e[e.None=0]="None",e[e.PartialAuthSuccess=1]="PartialAuthSuccess"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.AuthRuntime=2]="AuthRuntime",e[e.AuthConfigRuntimeActivity=3]="AuthConfigRuntimeActivity",e[e.BotInvokeRuntimeActivity=4]="BotInvokeRuntimeActivity",e[e.SilentAuthRuntimeActivity=5]="SilentAuthRuntimeActivity",e[e.GetAppData=6]="GetAppData",e[e.GetAppDataForRuntime=7]="GetAppDataForRuntime"}(i||(i={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(a||(a={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.ExecuteActivity=2]="ExecuteActivity",e[e.Execute=3]="Execute",e[e.ExecuteConfigOrAuthRequest=4]="ExecuteConfigOrAuthRequest",e[e.GetAppData=5]="GetAppData",e[e.GetAppDataForRuntime=6]="GetAppDataForRuntime"}(s||(s={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(l||(l={})),function(e){e[e.PluginFlyout=1]="PluginFlyout",e[e.InChat=2]="InChat",e[e.CardAction=3]="CardAction",e[e.Unknown=4]="Unknown"}(c||(c={})),function(e){e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth",e[e.BotInvoke=4]="BotInvoke",e[e.Unknown=5]="Unknown"}(u||(u={})),function(e){e.AuthScenario="AuthScenario",e.AuthType="AuthType"}(d||(d={}))},504:function(e,t,n){"use strict";n.r(t),n.d(t,"OperationId",(function(){return o.a})),n.d(t,"TextToImage",(function(){return l})),n.d(t,"EnsureAugloopRuntimeManager",(function(){return r.a})),n.d(t,"StartInitializingRuntimeManage",(function(){return r.b})),n.d(t,"getAlSessionKey",(function(){return r.c})),n.d(t,"guid",(function(){return r.d}));var r=n(1447),o=n(1151),i=n(2),a=n(452),s=n(1152),l=function(){function e(){}return e.addImage=function(t){e.images.push(t)},e.getImages=function(){return e.images},e.findImageUrlFromDescription=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return[2,n.sent()]}}))}))},e.insertImage=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(s.a)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!=n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return(n=r.sent())?[3,2]:(Object(a.a)("insertImageFromAl: Could not find image matching description"),[2,void 0]);case 2:return r.trys.push([2,4,,5]),[4,Object(s.b)(n)];case 3:return[2,r.sent()];case 4:return r.sent(),Object(a.a)("failed to fetch image from url and encode it as base64"),[2,void 0];case 5:return[2]}}))}))},e.images=[],e}()},52:function(e,t,n){"use strict";n.d(t,"q",(function(){return w})),n.d(t,"x",(function(){return T})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return j})),n.d(t,"l",(function(){return P})),n.d(t,"i",(function(){return A})),n.d(t,"h",(function(){return _})),n.d(t,"j",(function(){return D})),n.d(t,"m",(function(){return L})),n.d(t,"f",(function(){return M})),n.d(t,"v",(function(){return B})),n.d(t,"e",(function(){return R})),n.d(t,"g",(function(){return F})),n.d(t,"r",(function(){return N})),n.d(t,"o",(function(){return H})),n.d(t,"p",(function(){return U})),n.d(t,"w",(function(){return V})),n.d(t,"a",(function(){return z})),n.d(t,"b",(function(){return G})),n.d(t,"n",(function(){return W})),n.d(t,"s",(function(){return Q})),n.d(t,"k",(function(){return q})),n.d(t,"t",(function(){return K})),n.d(t,"u",(function(){return Y}));var r=n(2),o=(n(1),n(837)),i=n(103),a=n(547),s=n(17),l=n(105),c=n(260),u=n(357),d=n(2858),p=n(44),g=n(1483),h=n(75),f=n(1848),m=n(171),v=n(316),b=n(1009),y=n(399),C=n(721),O=n(325),S=n(402),E=n(323),x=n(326),I=n(125),w=!1,T=function(e){w=e},k=function(e,t){if(c.a.isDevbuild()){var n=g.a.getInstance();null==t?(console.log("CopilotChat Log:",e),null==n||n.addLog("CopilotChat Log:",e)):(console.log("CopilotChat Log:",e,t),null==n||n.addLog("CopilotChat Log:",e,t))}},j=function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{augloopSession:t})},P=function(){var e={};return Object.keys(s.k).forEach((function(t){e[t]=0})),e},A=function(e){return e[s.k.UserQueryGuid]=l.i,e[s.k.CopilotChatSessionId]=c.a.getSessionId(),{eventType:a.a.Latency,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},_=function(e){return e[s.g.UserQueryGuid]=l.i,e[s.g.CopilotChatSessionId]=c.a.getSessionId(),e[s.g.UserQueryOrder]=l.j,{eventType:a.a.ChatEvents,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},D=function(e){return e[s.l.UserQueryGuid]=l.i,e[s.l.HostSDXSessionID]=c.a.getSessionId(),e[s.l.UserQueryOrder]=l.j,{eventType:a.a.QueryDetails,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},L=function(){var e={};return Object.keys(s.g).forEach((function(t){e[t]=""})),e},M=function(){var e,t,n,r=null===(n=null===(e=window.getSelection)||void 0===e?void 0:(t=e.call(window)).getRangeAt)||void 0===n?void 0:n.call(t,0).startOffset;return r||0===r?r:-1},B=function(){var e=window.getSelection();return e?e.isCollapsed:(k("window.getSelection() returned null"),!1)},R=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.e(2).then(n.bind(null,504))];case 1:return o=r.sent(),t||(i={serviceUrl:c.a.getAugloopUrl(),appName:c.a.getAppName(),appVersion:c.a.getAppVersion(),authToken:e,releaseAudienceGroup:null,releaseChannel:null,releaseFork:null,flights:c.a.getAugloopFlights()},o.StartInitializingRuntimeManage(i)),[4,o.EnsureAugloopRuntimeManager()];case 2:return[2,r.sent()]}}))}))},F=function(e,t){var n,r;if(void 0===t&&(t=!0),0===e.length)return-1;var o=e.length-1;return e.length>=2&&(e[o].messageType===i.a.FeedbackNudge||"human"===(null===(r=null===(n=t&&e[o])||void 0===n?void 0:n.body)||void 0===r?void 0:r.user))&&(o=e.length-2),o};function N(e){return null==e}var H=function(){return u.a.getInstance().isWorkflowRegistered(o.c.getTypeName())||u.a.getInstance().isWorkflowRegistered(o.b.getTypeName())||u.a.getInstance().isWorkflowRegistered(o.a.getTypeName())},U=function(){return u.a.getInstance().isWorkflowRegistered(f.a.getTypeName())&&u.a.getInstance().getWorkflowDataMap().get(f.a.getTypeName()).workflowInfo.shouldHandleResponse},V=function(e,t,n,r,o,i){var a=m.a.getInstance();a.sendTelemetryChatEventData([{key:s.g.ChatEventType,value:"".concat(e,"_Error")},{key:s.g.ChatEventParameters,value:t},{key:s.g.ChatErrorType,value:n}]),a.sendTelemetryLatencyData([{key:s.k.ErrorParameter,value:t},{key:s.k.ErrorType,value:n},{key:s.k.UserPerceivedLatency,value:Object(l.c)(l.d)},{key:s.k.IsQuerySuccess,value:!1},{key:s.k.FeatureName,value:i}],!0),a.logErrorWithAshaVetoAndError([],i,p.w,r,o)},z=function(e,t){var n=e;return(null==t?void 0:t.length)&&t.reverse().forEach((function(t){var o=Object(r.__read)(t.range,2),i=o[0],a=o[1],s=e.slice(i,a+1),l="[".concat(s,"](").concat(t.value,")");n=n.slice(0,i)+l+n.slice(a+1)})),{user:h.e.Human,message:n,disableLinksProcessing:!0}};function G(e){return Object.keys(e).filter((function(e){return"themeBackground"!==e})).reduce((function(t,n){var r;return Object.assign(t,((r={})[n]=e[n],r))}),{})}var W=function(){return p.g[Object(d.a)()]===p.g.Safari},Q=function(e){var t=e,n=!1;return e.includes("<entity")?(t=e.slice(0,e.indexOf("<entity")),n=!0):e.includes("<placeholder")&&(t=e.slice(0,e.indexOf("<placeholder"))),{inputSpanText:t,isFileEntityPresent:n}},q=function(e){var t=p.P;return(null==e?void 0:e.url)&&((null==e?void 0:e.url.includes("docx"))?t=p.P:(null==e?void 0:e.url.includes("pptx"))?t=p.F:(null==e?void 0:e.url.includes("xlsx"))&&(t=p.y)),{iconUrl:t,boldText:null==e?void 0:e.text}},K=function(){w=!1,Object(v.g)(),Object(b.c)(),Object(l.e)(),Object(y.b)(p.w)},Y=function(){C.a.resetInstance(),O.a.resetInstance(),S.a.resetInstance(),u.a.resetInstance(),E.a.resetInstance(),x.a.resetInstance(),I.a.resetInstance(),m.a.resetInstance()}},540:function(e,t,n){"use strict";n.r(t),n.d(t,"ActivityRequestTrigger",(function(){return r.a})),n.d(t,"M365CardContentType",(function(){return r.b})),n.d(t,"BaseHostConfig",(function(){return o})),n.d(t,"SigninAction",(function(){return i.a})),n.d(t,"M365HostConfig",(function(){return a.a}));var r=n(1531);const o={choiceSetInputValueSeparator:",",supportsInteractivity:!0,fontFamily:"Segoe UI",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#E1E1E1"},fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},fontWeights:{lighter:300,default:400,bolder:500},imageSizes:{small:40,medium:160,large:320},containerStyles:{default:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#000000",subtle:"#000000"},dark:{default:"#000000",subtle:"#000000"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F8F8F8"},accent:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#EBF6FF"},good:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F1FFF1"},warning:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF8E4"},attention:{foregroundColors:{default:{default:"#000000",subtle:"#605E5C"},dark:{default:"#000000",subtle:"#605E5C"},light:{default:"#605E5C",subtle:"#605E5C"},accent:{default:"#005A9E",subtle:"#005A9E"},good:{default:"#0B6A0B",subtle:"#0B6A0B"},warning:{default:"#8F6900",subtle:"#8F6900"},attention:{default:"#D13438",subtle:"#D13438"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFF2F3"}},actions:{maxActions:5,spacing:"",buttonSpacing:8,showCard:{actionMode:"Inline",style:"default"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:102},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:8}};var i=n(2094),a=n(2089)},547:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.QueryDetails="QueryDetails",e.Microphone="Microphone"}(r||(r={}))},550:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Shimmer="shimmer",e.Blocked="blocked",e.Enabled="enabled",e.Disabled="disabled",e.Loading="loading"}(r||(r={}))},570:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return f}));var r=n(313);const o=Object(r.a)("initializeMsgExtCardState",((e,t,n,r,o)=>({cardDetails:e,renderingMode:t,appService:n,channelService:r,actionabilityStatus:o})));var i=n(71);const a=Object(r.b)("MsgExtCardStoreVnext",{cardsMap:new i.a}),s=(Object(r.c)(o,(e=>{const t={cardDetails:e.cardDetails,renderingMode:e.renderingMode};a().cardsMap.set(e.cardDetails.cardId,t)})),Object(r.a)("updateMsgExtAppInfo",((e,t,n)=>({cardId:e,appInfo:t,channelService:n})))),l=(Object(r.c)(s,(e=>{const t=a().cardsMap.get(e.cardId);t&&(t.appInfo=e.appInfo)})),Object(r.d)("updateMsgExtCardDetails",((e,t)=>{const n=a().cardsMap.get(e);n&&(n.cardDetails=t)})));var c=n(2),u=n(2680);Object(r.e)(o,(e=>Object(c.__awaiter)(void 0,void 0,void 0,(function*(){let t;try{const n=e.cardDetails;if(n&&n.appId){const r=yield e.appService.getApp({id:n.appId});r&&(r.titleInfo?t=Object(u.a)(r.titleInfo):r.appDefinition&&(t=r.appDefinition))}}catch(e){}s(e.cardDetails.cardId,t,e.channelService)}))));function d(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.appInfo}var p=n(752);function g(e){var t;const n=null===(t=a().cardsMap.get(e))||void 0===t?void 0:t.appInfo;if(n&&n.state)switch(n.state){case"InstalledAndDeprecated":case"Featured":case"InstalledAndHidden":case"NotInstalled":case"PreConsented":return p.a.NotInstalled;case"Installed":case"AdminPreInstalled":case"InstalledAndPermanent":return p.a.Installed;case"RequireConsent":return p.a.NeedsConsentForUpgrade;default:return p.a.NotAvailable}return p.a.NotAvailable}function h(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.cardDetails}function f(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.renderingMode}},571:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,o=n(159),i=n(105),a=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e.prototype.toString=function(){return"".concat(this.value,".").concat(this.nextChild)},e}();var s=n(52),l=n(44),c=function(){function e(){this.currentCvQueryGuid=i.i,this.cvBase=function(){if(!r){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));r=new a(t.join(""))}return r}(),this.currentCvQueryGuid=i.i,this.queryCv=this.cvBase.getNext(),this.alSessionKey=l.w}return e.getInstance=function(){return Object(o.d)(e.instance)&&(e.instance=new e),e.instance},e.prototype.resetCvData=function(){Object(s.c)("Reset Cv data to generate next cv for new query"),this.currentCvQueryGuid=i.i,this.queryCv=this.cvBase.getNext()},e.prototype.getBaseCv=function(){return this.cvBase},e.prototype.setAlSessionKey=function(e){this.alSessionKey=e},e.prototype.getAlSessionKey=function(){return this.alSessionKey},e.prototype.getQueryCv=function(){var e,t,n;return this.currentCvQueryGuid==i.i?this.queryCv.getNext():this.resetCvData(),Object(s.c)("cvBase: ".concat(null===(e=this.cvBase)||void 0===e?void 0:e.toString(),", queryCv: ").concat(null===(t=this.queryCv)||void 0===t?void 0:t.toString(),", userQueryGuid: ").concat(i.i)),null===(n=this.queryCv)||void 0===n?void 0:n.toString()},e}()},59:function(e,t,n){"use strict";n.d(t,"f",(function(){return A})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"n",(function(){return i})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"o",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"p",(function(){return g})),n.d(t,"r",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"l",(function(){return C})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return E})),n.d(t,"x",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"v",(function(){return T})),n.d(t,"u",(function(){return k})),n.d(t,"i",(function(){return j})),n.d(t,"q",(function(){return P}));var r,o,i,a,s,l,c,u,d,p,g,h,f,m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();!function(e){e.Default="default",e.Positive="positive",e.Destructive="destructive"}(r||(r={})),function(e){e.Primary="primary",e.Secondary="secondary"}(o||(o={})),function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(i||(i={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(a||(a={})),function(e){e[e.xxSmall=0]="xxSmall",e[e.xSmall=1]="xSmall",e[e.Small=2]="Small",e[e.Standard=3]="Standard",e[e.Medium=4]="Medium",e[e.Large=5]="Large",e[e.xLarge=6]="xLarge",e[e.xxLarge=7]="xxLarge"}(s||(s={})),function(e){e[e.Regular=0]="Regular",e[e.Filled=1]="Filled"}(l||(l={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(c||(c={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(u||(u={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(d||(d={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(p||(p={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(g||(g={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(h||(h={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(f||(f={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(m||(m={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(v||(v={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person",e[e.RoundedCorners=2]="RoundedCorners"}(b||(b={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(y||(y={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(C||(C={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(O||(O={})),function(e){e[e.Normal=0]="Normal",e[e.Expanded=1]="Expanded",e[e.Subdued=2]="Subdued"}(S||(S={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(E||(E={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(x||(x={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(I||(I={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other",e[e.UnknownProperty=18]="UnknownProperty"}(w||(w={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(T||(T={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(k||(k={})),function(e){e[e.VeryNarrow=0]="VeryNarrow",e[e.Narrow=1]="Narrow",e[e.Standard=2]="Standard",e[e.Wide=3]="Wide"}(j||(j={})),function(e){e[e.AtLeast=0]="AtLeast",e[e.AtMost=1]="AtMost"}(P||(P={}))},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"m",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return C})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return S})),n.d(t,"l",(function(){return E})),n.d(t,"i",(function(){return x})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return T})),n.d(t,"g",(function(){return k}));var r=n(2),o=n(1531),i=n(2823),a=n(65),s=n(89),l=n(137),c=n(238),u=n(99),d=n(467),p=n(698),g=Object(i.a)(u.b),h={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",BUTTON:"button",ALERT:"alert"},f=function(){return"undefined"!=typeof OfficeaicopilotStrings},m=function(e){var t;return null===(t=Object.values(o.b).filter((function(t){return t===e})))||void 0===t?void 0:t[0]},v=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=b(e),n=document.getElementById(e).innerText,o=new ClipboardItem({"text/html":new Blob([t],{type:"text/html"}),"text/plain":new Blob([n],{type:"text/plain"})}),t?[4,navigator.clipboard.write([o])]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return i=r.sent(),console.log("Error copying html to clipboard",i.message),[3,4];case 4:return[2]}}))}))},b=function(e){var t,n=document.getElementById(e),r=n.cloneNode(!0);y(n,r);var o=r.outerHTML.replace(l.j,"");return null===(t=r.parentNode)||void 0===t||t.removeChild(r),o};function y(e,t){var n=document.createElement("div");document.body.appendChild(n);for(var r=getComputedStyle(e),o=getComputedStyle(n),i=[],a=0;a<r.length;a++){var s=r[a],l=r.getPropertyValue(s),c=o.getPropertyValue(s),u=Object(d.b)();u!==d.a.defaultBlack&&u!==d.a.defaultDarkGrey||"color"===s&&(l=g.black),l!==c&&i.push("".concat(s,": ").concat(l))}t.setAttribute("style",i.join(";"));for(var p=e.children,h=t.children,f=0;f<p.length;f++){y(p[f],h[f])}n.remove()}var C=function(e,t){if(t)for(var n in e)e[n]=Object(a.a)(e[n],t[n]);return e},O=function(e,t){var n=[],o=e.body;return function(e){var t,n,o=e.split(/(\[.*?\]\(.*?\))/g),i=[];try{for(var a=Object(r.__values)(o),s=a.next();!s.done;s=a.next()){var l=s.value;if(!l.startsWith("[")||!l.endsWith(")")){var c=l.trim();c.startsWith(".")&&(c=c.substring(1).trim(),i.length>0&&(i[i.length-1]=i[i.length-1]+". ")),i.push(c)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}(o[0].text).forEach((function(i,a){i.length>0?n.push({adaptiveCard:Object(r.__assign)(Object(r.__assign)({},e),{body:[Object(r.__assign)(Object(r.__assign)({},o[0]),{text:i})]}),references:t[a]?[t[a]]:[]}):t[a]&&n.length>0&&n[n.length-1].references.push(t[a])})),n},S=function(e,t){t.sort((function(e,t){return e.referenceIndex-t.referenceIndex}));var n=0;return t.forEach((function(t){var r=t.referenceProps.citationPosition+n,o="["+t.referenceIndex.toString()+"]()";e=e.substring(0,r)+o+e.substring(r),n+=o.length})),e},E=function(e,t){if(0===t.length)return!1;var n=e.search("%c");if(-1===n)return!1;var r=e.slice(n+2).search("%c");if(-1===r)return!1;r=r+n+2;var o=parseInt(e.slice(n+2,r));return t.some((function(e){return e.referenceIndex===o}))},x=function(e,t){for(var n=[],r=e.search("%c"),o=function(){var o=e.slice(r+2).search("%c");if(-1===o)return"break";o+=r+2;var i=parseInt(e.slice(r+2,o));n.push({message:e.slice(0,r),references:[t.find((function(e){return e.referenceIndex===i}))]}),e=e.slice(o+2),r=e.search("%c")};-1!==r;){if("break"===o())break}return n},I=function(e){var t=c.h,n=c.h,r=e.lastIndexOf("]"),o=e.lastIndexOf("[",r);return r>o&&o>=0?(t=e.slice(0,o),n=e.slice(o,r+1)):t=e,{inputText:t,hintText:n}},w=function(e){var t=c.h,n=c.h,r=c.h,o=c.h;if(!e||0===e.length)return{prefixText:r,skillText:o,inputText:t,hintText:n};var i=e.lastIndexOf("}"),a=e.lastIndexOf("{",i);i>a&&a>=0&&(o=e.slice(a+1,i),r=e.slice(0,a),e=e.slice(i+1));var s=e.lastIndexOf("]"),l=e.lastIndexOf("[",s);return s>l&&l>=0?(t=e.slice(0,l),n=e.slice(l,s+1)):t=e,{prefixText:r,skillText:o,inputText:t,hintText:n}},T=function(){return{aadUserId:"",clientType:s.c.web,hubName:s.d.orange,locale:"en-US",physicalRing:"",sessionId:"",theme:s.e.default,userName:"",userPrincipalName:""}},k=function(e,t){for(var n=[],r=e,o=0,i=function(e,t){return t.find((function(t){return t.every((function(t){return e.includes(t())}))}))}(r,t);r.length>0;){var a=!1,s=-1;if((null==i?void 0:i.length)>0&&o<(null==i?void 0:i.length)){var l=i;0===(s=r.indexOf(l[o]()))&&(a=!0,n.push({promptType:p.a.Skill,promptText:l[o]()}),r=r.substring(l[o]().length))}if(a)o++;else{var c=r.indexOf("["),u=r.indexOf("]"),d=r.indexOf("("),g=r.indexOf(")"),h=-1,f=p.a.Regular;c>=0&&u>=0&&0===(h=c)&&(f=p.a.Ghost,h=u+1),d>=0&&g>=0&&(-1===h||d<h)&&0===(h=d)&&(f=p.a.File,h=g+1),-1===h&&(h=s>0?s:r.length),n.push({promptType:f,promptText:r.substring(0,h)}),r=r.substring(h)}}return n}},655:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n(2),o=n(1),i=n(773),a=n(28),s=n(147),l=n(32),c=n(181),u=n(1828),d=n(161),p=n(321),g=function(e){function t(t){var n=e.call(this)||this;return n.ariaHidden=!1,t&&(n.text=t),n}return Object(r.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this.getValue(t.weightProperty)},set:function(e){this.setValue(t.weightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontType",{get:function(){return this.getValue(t.fontTypeProperty)},set:function(e){this.setValue(t.fontTypeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubtle",{get:function(){return this.getValue(t.isSubtleProperty)},set:function(e){this.setValue(t.isSubtleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.effectiveSize){case a.w.Small:return e.fontSizes.small;case a.w.Medium:return e.fontSizes.medium;case a.w.Large:return e.fontSizes.large;case a.w.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t,n=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);switch(n.fontFamily&&(e.style.fontFamily=n.fontFamily),this.effectiveSize){case a.w.Small:t=n.fontSizes.small;break;case a.w.Medium:t=n.fontSizes.medium;break;case a.w.Large:t=n.fontSizes.large;break;case a.w.ExtraLarge:t=n.fontSizes.extraLarge;break;default:t=n.fontSizes.default}e.style.fontSize="".concat(t,"px");var r=this.getEffectiveStyleDefinition().foregroundColors.getColorDefinition(this.effectiveColor),o=Object(s.l)(this.effectiveIsSubtle?r.subtle:r.default);switch(o&&(e.style.color=o),this.effectiveWeight){case a.x.Lighter:e.style.fontWeight=n.fontWeights.lighter;break;case a.x.Bolder:e.style.fontWeight=n.fontWeights.bolder;break;default:e.style.fontWeight=n.fontWeights.default}this.ariaHidden&&(e["aria-hidden"]="true")},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),t.textProperty=new l.n(l.s.v1_0,"text"),t.sizeProperty=new l.e(l.s.v1_0,"size",a.w),t.weightProperty=new l.e(l.s.v1_0,"weight",a.x),t.colorProperty=new l.e(l.s.v1_0,"color",a.v),t.isSubtleProperty=new l.b(l.s.v1_0,"isSubtle"),t.fontTypeProperty=new l.e(l.s.v1_2,"fontType",a.h),t.selectActionProperty=new i.a(l.s.v1_1,"selectAction",["Action.ShowCard"]),t}(c.d),h=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t.useMarkdown=!0,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLines",{get:function(){return this.getValue(t.maxLinesProperty)},set:function(e){this.setValue(t.maxLinesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.processMarkdown=function(e){var t={didProcess:!1},n=this.getRootElement();return n instanceof p.a&&n.onProcessMarkdown?n.onProcessMarkdown(e,this,t):p.a.onProcessMarkdown&&p.a.onProcessMarkdown(e,this,t),t},t.prototype.internalRender=function(e){var t=this;if(this.text){var n=this.preProcessPropertyValue(g.textProperty),r=this.hostConfig,i={style:{}};if(i.id=this.id,i.htmlFor=this.forElementId,i.className=r.makeCssClassName("ac-textBlock"),i.style.overflow="hidden",i.style.margin=0,i.style.padding=0,this.applyStylesTo(i),"heading"===this.style){i.role="heading";var a=this.hostConfig.textBlock.headingLevel;void 0!==a&&a>0&&(i["aria-level"]=a)}this.selectAction&&r.supportsInteractivity&&(i.onClick=function(e){t.selectAction&&t.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.selectAction.execute())},this.selectAction.setupElementForAccessibility(i),this.selectAction.isEffectivelyEnabled()&&Object(s.a)(i,r.makeCssClassName("ac-selectable")));var l=Object(u.a)(this.lang,n),c=this.useMarkdown&&l?this.processMarkdown(l):{didProcess:!1};return c.didProcess&&c.output?i.children=c.output:i.children=l,this.wrap?(i.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(i.style.overflow="hidden",d.a.useWebkitLineClamp?(i.style.lineHeight=void 0,i.style.display="-webkit-box",i.style.WebkitBoxOrient="vertical",i.style.WebkitLineClamp=this.maxLines):i.style.maxHeight="".concat(this._computedLineHeight*this.maxLines,"px"))):i.style.whiteSpace="nowrap",i.style.textOverflow="ellipsis",o.createElement(this.forElementId?"label":"div",i)}return null},t.prototype.applyStylesTo=function(t){switch(e.prototype.applyStylesTo.call(this,t),this.getEffectiveHorizontalAlignment()){case a.i.Center:t.style.textAlign="center";break;case a.i.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this.hostConfig.lineHeights;if(n)switch(this.effectiveSize){case a.w.Small:this._computedLineHeight=n.small;break;case a.w.Medium:this._computedLineHeight=n.medium;break;case a.w.Large:this._computedLineHeight=n.large;break;case a.w.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));t.style.lineHeight="".concat(this._computedLineHeight,"px")},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):e.prototype.getEffectiveTextStyleDefinition.call(this)},t.wrapProperty=new l.b(l.s.v1_0,"wrap",!1),t.maxLinesProperty=new l.g(l.s.v1_0,"maxLines"),t.styleProperty=new l.q(l.s.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),t}(g)},675:function(e,t,n){"use strict";function r(e,t){for(var n in e){var r=parseInt(n,10);if(r>=0){var o=e[n];if(o&&"string"==typeof o&&o.toLowerCase()===t.toLowerCase())return r}}}function o(e){var t=[];for(var n in e){if(parseInt(n,10)>=0){var r=e[n];r&&"string"==typeof r&&t.push(r)}}return t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},680:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r,o=n(573),i=n(1014);!function(e){e.CurrentContext="CurrentContext",e.Work="Work",e.Web="Web"}(r||(r={}));var a=function(e){var t;return(t={})[r.CurrentContext]=Object(i.a)(e),t[r.Work]=Object(i.b)(e),t},s={direction:o.a.bidirectional,isCircularNavigation:!0,handleTabKey:o.b.all}},692:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),o=n(1),i=n(32),a=n(28),s=n(161),l=n(175),c=n(147),u=n(188),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.getValue(t.widthProperty)},set:function(e){this.setValue(t.widthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"ColumnDefinition"},t.horizontalCellContentAlignmentProperty=new i.e(i.s.v1_5,"horizontalCellContentAlignment",a.i),t.verticalCellContentAlignmentProperty=new i.e(i.s.v1_5,"verticalCellContentAlignment",a.C),t.widthProperty=new i.c(i.s.v1_5,"width",(function(e,t,n,r){var o=t.defaultValue,i=n[t.name],c=!1;if("number"!=typeof i||isNaN(i))if("string"==typeof i)try{o=s.c.parse(i)}catch(e){c=!0}else c=!0;else o=new s.c(i,a.s.Weight);return c&&r.logParseEvent(e,a.A.InvalidPropertyValue,l.a.errors.invalidColumnWidth(i)),o}),(function(e,t,n,r,o){r.unit===a.s.Pixel?o.serializeValue(n,"width","".concat(r.physicalSize,"px")):o.serializeNumber(n,"width",r.physicalSize)}),new s.c(1,a.s.Weight)),t}(i.j),p=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._items=[],t}return Object(r.__extends)(t,e),t.prototype.parseItem=function(e,t){var n=this;return t.parseCardObject(this,e,[],!0,(function(e){return n.createItemInstance(e)}),(function(e,n){t.logParseEvent(void 0,a.A.ElementTypeNotAllowed,l.a.errors.elementTypeNotAllowed(e))}))},t.prototype.internalAddItem=function(e){if(e.parent)throw new Error(l.a.errors.elementAlreadyParented());this._items.push(e),e.setParent(this)},t.prototype.internalRemoveItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.internalIndexOf=function(e){return this._items.indexOf(e)},t.prototype.internalParse=function(t,n){var o,i;e.prototype.internalParse.call(this,t,n),this._items=[];var a=t[this.getCollectionPropertyName()];if(Array.isArray(a))try{for(var s=Object(r.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=this.parseItem(c,n);u&&this._items.push(u)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getCollectionPropertyName(),this._items)},t.prototype.removeItem=function(e){return this.internalRemoveItem(e)},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(0):void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(this.getItemCount()-1):void 0},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),[this.getCollectionPropertyName()],!1)},t}(u.e),g=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._columnIndex=-1,t._cellType="data",t}return Object(r.__extends)(t,e),t.prototype.getHasBorder=function(){return this.parentRow.parentTable.showGridLines},t.prototype.applyBorder=function(e){if(this.getHasBorder()){var t=this.hostConfig.containerStyles.getStyleByName(this.parentRow.parentTable.gridStyle);if(t.borderColor){var n=Object(c.l)(t.borderColor);n&&(e.style.borderRight="1px solid ".concat(n),e.style.borderBottom="1px solid ".concat(n))}}},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new s.b(a.t.Small,a.t.Small,a.t.Small,a.t.Small):e.prototype.getDefaultPadding.call(this)},t.prototype.adjustSize=function(e){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex);t.computedWidth.unit===a.s.Pixel?e.flex="0 0 ".concat(t.computedWidth.physicalSize,"px"):e.flex="1 1 ".concat(t.computedWidth.physicalSize,"%")},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t.role="data"===this.cellType?"cell":"columnheader",t.style.minWidth=0,"header"===this.cellType&&(t.scope="col")},t.prototype.shouldSerialize=function(e){return!0},t.prototype.getJsonTypeName=function(){return"TableCell"},t.prototype.getEffectiveTextStyleDefinition=function(){return"header"===this.cellType?this.hostConfig.textStyles.columnHeader:e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.getEffectiveHorizontalAlignment=function(){if(void 0!==this.horizontalAlignment)return this.horizontalAlignment;if(void 0!==this.parentRow.horizontalCellContentAlignment)return this.parentRow.horizontalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).horizontalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.horizontalCellContentAlignment?this.parentRow.parentTable.horizontalCellContentAlignment:e.prototype.getEffectiveHorizontalAlignment.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;if(void 0!==this.parentRow.verticalCellContentAlignment)return this.parentRow.verticalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).verticalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.verticalCellContentAlignment?this.parentRow.parentTable.verticalCellContentAlignment:e.prototype.getEffectiveVerticalContentAlignment.call(this)},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellType",{get:function(){return this._cellType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentRow",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(u.b),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(u.e.layoutsProperty)},t.prototype.getDefaultPadding=function(){return new s.b(a.t.None,a.t.None,a.t.None,a.t.None)},t.prototype.applyBackground=function(e){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(t.backgroundColor){var n=Object(c.l)(t.backgroundColor);n&&(e.style.backgroundColor=n)}},t.prototype.getCollectionPropertyName=function(){return"cells"},t.prototype.createItemInstance=function(e){return e&&"TableCell"!==e?void 0:new g},t.prototype.renderItems=function(){for(var e=[],t=this.getIsFirstRow(),n=0;n<Math.min(this.getItemCount(),this.parentTable.getColumnCount());n++){var r=this.getItemAt(n);r._columnIndex=n,r._cellType=this.parentTable.firstRowAsHeaders&&t?"header":"data";var i=o.createElement(r.Render,{key:r.key});i&&e.push(i)}return e},t.prototype.customizeProps=function(e){e.role="row"},t.prototype.applyLayout=function(e){e.style.display="flex",e.style.flexDirection="row";var t=this.hostConfig.table.cellSpacing;!this.parentTable.showGridLines&&t>0&&(e.style.gap=t)},t.prototype.shouldSerialize=function(e){return!0},t.prototype.addCell=function(e){this.internalAddItem(e)},t.prototype.removeCellAt=function(e){return e>=0&&e<this.getItemCount()&&this.removeItem(this.getItemAt(e))},t.prototype.indexOf=function(e){return e instanceof g?this.internalIndexOf(e):-1},t.prototype.ensureHasEnoughCells=function(e){for(;this.getItemCount()<e;)this.addCell(new g)},t.prototype.getJsonTypeName=function(){return"TableRow"},t.prototype.getIsFirstRow=function(){return this.parentTable.getItemAt(0)===this},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.styleProperty=new u.d(i.s.v1_5,"style"),t.horizontalCellContentAlignmentProperty=new i.e(i.s.v1_5,"horizontalCellContentAlignment",a.i),t.verticalCellContentAlignmentProperty=new i.e(i.s.v1_5,"verticalCellContentAlignment",a.C),t}(p),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"_columns",{get:function(){return this.getValue(t._columnsProperty)},set:function(e){this.setValue(t._columnsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstRowAsHeaders",{get:function(){return this.getValue(t.firstRowAsHeadersProperty)},set:function(e){this.setValue(t.firstRowAsHeadersProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showGridLines",{get:function(){return this.getValue(t.showGridLinesProperty)},set:function(e){this.setValue(t.showGridLinesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gridStyle",{get:function(){var e=this.getValue(t.gridStyleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e},set:function(e){this.setValue(t.gridStyleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(u.e.layoutsProperty)},t.prototype.ensureRowsHaveEnoughCells=function(){for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).ensureHasEnoughCells(this.getColumnCount())},t.prototype.removeCellsFromColumn=function(e){for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).removeCellAt(e)},t.prototype.getCollectionPropertyName=function(){return"rows"},t.prototype.createItemInstance=function(e){return e&&"TableRow"!==e?void 0:new h},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.ensureRowsHaveEnoughCells()},t.prototype.renderItems=function(){for(var e=[],t=0;t<this.getItemCount();t++){var n=this.getItemAt(t),r=o.createElement(n.Render,{key:n.key});r&&e.push(r)}return e},t.prototype.applyLayout=function(e){var t,n,o,i,l=0;try{for(var u=Object(r.__values)(this._columns),d=u.next();!d.done;d=u.next()){(h=d.value).width.unit===a.s.Weight&&(l+=h.width.physicalSize)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}try{for(var p=Object(r.__values)(this._columns),g=p.next();!g.done;g=p.next()){var h;(h=g.value).width.unit===a.s.Pixel?h.computedWidth=new s.c(h.width.physicalSize,a.s.Pixel):h.computedWidth=new s.c(100/l*h.width.physicalSize,a.s.Weight)}}catch(e){o={error:e}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}var f=this.hostConfig.table.cellSpacing;if(e.role="table",e.style.display="flex",e.style.flexDirection="column",this.showGridLines){var m=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(m.borderColor){var v=Object(c.l)(m.borderColor);v&&(e.style.borderTop="1px solid ".concat(v),e.style.borderLeft="1px solid ".concat(v))}}else e.style.gap=f>0?f:void 0},t.prototype.addColumn=function(e){this._columns.push(e),this.ensureRowsHaveEnoughCells()},t.prototype.removeColumn=function(e){var t=this._columns.indexOf(e);t>=0&&(this.removeCellsFromColumn(t),this._columns.splice(t,1))},t.prototype.getColumnCount=function(){return this._columns.length},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.addRow=function(e){this.internalAddItem(e),e.ensureHasEnoughCells(this.getColumnCount())},t.prototype.indexOf=function(e){return e instanceof h?this.internalIndexOf(e):-1},t.prototype.getJsonTypeName=function(){return"Table"},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),["columns"],!1)},t._columnsProperty=new i.k(i.s.v1_5,"columns",(function(e){return new d})),t.firstRowAsHeadersProperty=new i.b(i.s.v1_5,"firstRowAsHeaders",!0),t.showGridLinesProperty=new i.b(i.s.v1_5,"showGridLines",!0),t.gridStyleProperty=new u.d(i.s.v1_5,"gridStyle"),t.horizontalCellContentAlignmentProperty=new i.e(i.s.v1_5,"horizontalCellContentAlignment",a.i),t.verticalCellContentAlignmentProperty=new i.e(i.s.v1_5,"verticalCellContentAlignment",a.C),t}(p)},693:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),o=n(1),i=n(773),a=n(147),s=n(161),l=n(28),c=n(175),u=n(32),d=n(181),p=n(1111),g=n(822),h=n(655),f=n(321),m=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._hasError=!1,t.internalId=Object(a.d)(),t.labelId=Object(a.d)(),t.errorId=Object(a.d)(),t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this.getValue(t.labelProperty)},set:function(e){this.setValue(t.labelProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this.getValue(t.isRequiredProperty)},set:function(e){this.setValue(t.isRequiredProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorMessage",{get:function(){return this.getValue(t.errorMessageProperty)},set:function(e){this.setValue(t.errorMessageProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueChangedAction",{get:function(){return this.getValue(t.valueChangedActionProperty)},set:function(e){this.setValue(t.valueChangedActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._value=this.defaultValue},t.prototype.getAllLabelIds=function(){var e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.errorId),e},t.prototype.getAriaLabelledBy=function(){var e=this.getAllLabelIds();return e.length>0?e.join(" "):void 0},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.hostConfig;if(this.label){var t=new p.a;t.id=this.labelId,t.setParent(this),t.forElementId=this.internalId;var n=new g.a(this.label);if(t.addInline(n),this.isRequired){n.init(e.inputs.label.requiredInputs);var r=new g.a(e.inputs.label.requiredInputs.suffix);r.color=e.inputs.label.requiredInputs.suffixColor,r.ariaHidden=!0,t.addInline(r)}else n.init(e.inputs.label.optionalInputs);return o.createElement(t.Render,null)}return null},t.prototype.renderExtraContent=function(){return null},t.prototype.internalRender=function(e){var t=this.hostConfig,n=this.renderExtraContent(),r={display:"flex",flexDirection:"row",gap:n?"10px":void 0,flex:"stretch"===this.height?"1 1 auto":void 0};return o.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"".concat(t.getEffectiveSpacing(t.inputs.label.inputSpacing),"px")}},this.renderLabel(),o.createElement("div",{className:this.hostConfig.makeCssClassName("ac-input-container"),style:r},this.renderInputControl(),n),this.renderValidationError())},t.prototype.renderValidationError=function(){if(this.hasError&&this.errorMessage&&s.a.displayInputValidationErrors){var e=new h.b;return e.id=this.errorId,e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),o.createElement(e.Render,null)}return null},t.prototype.executeValueChangedAction=function(){var e;null===(e=this.valueChangedAction)||void 0===e||e.execute()},t.prototype.valueChanged=function(e){this._value=e,this.getRootElement().updateActionsEnabledState(),this.executeValueChangedAction(),!this.isValid()||(this.hasError=!1),this.onValueChanged&&this.onValueChanged(this);var t=this.getRootElement(),n=t&&t.onInputValueChanged?t.onInputValueChanged:f.a.onInputValueChanged;n&&n(this)},t.prototype.focus=function(){return!1},t.prototype.resetValue=function(){this.isSet()&&(this.value=this.defaultValue,this.updateLayout())},t.prototype.isValid=function(){return!0},t.prototype.isDirty=function(){return this.isSet()&&this.value!==this._oldValue},t.prototype.resetDirtyState=function(){this._oldValue=this.value},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,l.A.PropertyCantBeNull,c.a.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,l.A.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,l.A.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return this.hasError=!e,e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},Object.defineProperty(t.prototype,"valueAsString",{get:function(){return void 0!==this.value&&null!==this.value?this.value.toString():void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasError",{get:function(){return this._hasError},set:function(e){this._hasError!==e&&(this._hasError=e,this.updateLayout())},enumerable:!1,configurable:!0}),t.labelProperty=new u.n(u.s.v1_3,"label"),t.isRequiredProperty=new u.b(u.s.v1_3,"isRequired",!1),t.errorMessageProperty=new u.n(u.s.v1_3,"errorMessage"),t.valueChangedActionProperty=new i.a(u.s.v1_5,"valueChangedAction",["Action.ToggleVisibility","Action.Execute","Action.Submit","Action.OpenUrl","Action.Overflow","Action.Http","Action.ShowCard"]),t}(d.d)},697:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(17),o=function(e){return"ChatCompose"===e?r.i.Draft:r.i.ChatQnA},i=function(e){switch(e){case r.i.Draft:return r.m.ContentGeneration;case r.i.ChatQnA:return r.m.QAandSummaries;default:return}},a=function(e){switch(e){case r.i.Draft:return r.o.Create;case r.i.ChatQnA:return r.o.Ask;default:return}},s=function(e){switch(e){case r.i.Draft:return r.n.ContentCreation;case r.i.ChatQnA:return r.n.BasicChat;default:return}}},698:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Regular=0]="Regular",e[e.Ghost=1]="Ghost",e[e.File=2]="File",e[e.Skill=3]="Skill"}(r||(r={}))},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l}));const r="ErrorAugloopActivateAnnotations",o=3e4,i={maxRetries:3,retryWaitMilliseconds:5e3},a="granted",s="denied";var l;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(l||(l={}))},718:function(e,t,n){"use strict";function r(e,t){for(var n in e){var r=parseInt(n,10);if(r>=0){var o=e[n];if(o&&"string"==typeof o&&o.toLowerCase()===t.toLowerCase())return r}}}function o(e){var t=[];for(var n in e){if(parseInt(n,10)>=0){var r=e[n];r&&"string"==typeof r&&t.push(r)}}return t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},720:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e.Primary="Primary",e.Default="Default"}(r||(r={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(o||(o={}))},721:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(52),o=n(44),i=n(159),a=n(547),s=n(17),l=n(325),c=n(837),u=n(357),d=n(171),p=n(75),g=function(){function e(e,t){var n=this;this.chatHistoryResponseTimerID=null,this.workflowAnnotationType=c.c.getTypeName(),this.chatHistoryResponseTimeout=o.k,this.hasExistingChat=!0,this.telemetryLoggerUtils=d.a.getInstance(),this.chatHistoryResponseTimeoutInternal=function(){n.chatHistoryResponseTimerID=null,Object(r.c)("Chat History Augloop Response Timed Out for workflow",n.workflowAnnotationType),l.a.getInstance().clearOperationListForResubmit(),n.setIsChatHistoryLoading(!1),n.hasExistingChat&&n.setIsChatHistoryTimedOut(!0),n.telemetryLoggerUtils.sendTelemetryChatEventData([{key:s.g.ChatEventType,value:s.f.ChatHistoryTimeout},{key:s.g.ChatEventParameters,value:(new Date).getTime().toString()},{key:s.g.ChatErrorType,value:s.e.Server}]),n.telemetryLoggerUtils.sendTelemetryErrorData([{key:s.h.ErrorMessage,value:o.l},{key:s.h.ErrorType,value:s.e.Server},{key:s.h.ErrorCode,value:p.g.ChatHistoryResponseTimeout},{key:s.h.ErrorCategory,value:a.a.ChatEvents}]),n.hasExistingChat=!0},this.setIsChatHistoryLoading=e,this.setIsChatHistoryTimedOut=t,this.workflowAnnotationType=this.getChatHistoryWorkflowType(),this.chatHistoryResponseTimeout=this.getChatHistoryResponseTimeout()}return e.getInstance=function(t,n){if(!e.sInstance){if(Object(i.d)(t))throw new Error("setIsChatSessionIdSet is null or undefined");e.sInstance=new e(t,n)}return e.sInstance},e.resetInstance=function(){e.sInstance=void 0},e.prototype.setAugloopResponseTimer=function(){Object(r.c)("Setting chat history augloop response Timer"),this.clearAugloopResponseTimer(!1),this.setIsChatHistoryLoading(!0),this.setIsChatHistoryTimedOut(!1),this.chatHistoryResponseTimerID=window.setTimeout(this.chatHistoryResponseTimeoutInternal,this.chatHistoryResponseTimeout)},e.prototype.clearAugloopResponseTimer=function(e){void 0===e&&(e=!0),null!==this.chatHistoryResponseTimerID&&(Object(r.c)("Clear chat history augloop response Timer"),clearTimeout(this.chatHistoryResponseTimerID),this.chatHistoryResponseTimerID=null,e&&this.setIsChatHistoryLoading(!1))},Object.defineProperty(e.prototype,"isAugloopResponseTimerSet",{get:function(){return null!==this.chatHistoryResponseTimerID},enumerable:!1,configurable:!0}),e.prototype.setHasExistingChat=function(e){this.hasExistingChat=e},e.prototype.getChatHistoryWorkflowType=function(){return u.a.getInstance().isWorkflowRegistered(c.c.getTypeName())?c.c.getTypeName():u.a.getInstance().isWorkflowRegistered(c.a.getTypeName())?c.a.getTypeName():c.b.getTypeName()},e.prototype.getChatHistoryResponseTimeout=function(){var e;return null!==(e=u.a.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType))&&void 0!==e?e:o.k},e}()},75:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p,g,h;n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return h})),function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS"}(r||(r={})),function(e){e.Chat="chat",e.Human="human"}(o||(o={})),function(e){e.BASIC_CHAT="BasicChat",e.DRAFT="Draft"}(i||(i={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(a||(a={})),function(e){e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsApplyClpFromHydratedMessagedEnabled="IsApplyClpFromHydratedMessagedEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled",e.HydratedMessagesSquashingEnabled="HydratedMessagesSquashingEnabled",e.ChatInputEarlyLoadEnabled="ChatInputEarlyLoadEnabled",e.IsChatHistoryPaginationEnabled="IsChatHistoryPaginationEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.DisableChatHistoryPaginationFix="DisableChatHistoryPaginationFix",e.ChatHistoryDuplicateLoggingFix="ChatHistoryDuplicateLoggingFix",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.ShowRestrictiveSearchBanner="ShowRestrictiveSearchBanner",e.EnableRestrictiveSearchBanner="EnableRestrictiveSearchBanner",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.IsLicenseAnnotationEnabled="IsLicenseAnnotationEnabled",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsDisableChatInputWhenAlSessionCloseEnabled="IsDisableChatInputWhenAlSessionCloseEnabled",e.EnableALCorrelationLogs="EnableALCorrelationLogs",e.IsSuggestedQnACitationsEnabled="IsSuggestedQnACitationsEnabled",e.EnableMsgExtCardTelemetry="EnableMsgExtCardTelemetry"}(s||(s={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.UnknownOpenAI="unknown-openai",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(l||(l={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(c||(c={})),function(e){e.HandleSubmitError="handle-submit-error",e.AugloopInitializationError="augloop-initialization-error",e.ActivateAnnotationError="activate-annotation-error",e.AugloopResponseTimeout="augloop-response-timeout",e.ChatHistoryResponseTimeout="chat-history-response-timeout",e.AugloopPluginProviderFailure="augloop-plugin-provider-failure",e.MsgExtCardError="msg-ext-card-error"}(u||(u={})),function(e){e.Shy="Shy",e.Expanded="Expanded"}(d||(d={})),function(e){e.Favourite="Favourite",e.Unfavourite="Unfavourite"}(p||(p={})),function(e){e.PromptGuide="PromptGuide",e.Microphone="Microphone",e.SubmitButton="SubmitButton",e.GroundingButton="GroundingButton"}(g||(g={})),function(e){e.ENTERPRISE_SEARCH="EnterpriseSearch",e.WEB_SEARCH="BingWebSearch"}(h||(h={}))},752:function(e,t,n){"use strict";var r,o,i,a,s,l,c,u,d,p;n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),function(e){e.Unknown="Unknown",e.Success="Success",e.Partial="Partial",e.Failed="Failed",e.Error="Error"}(r||(r={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(i||(i={})),function(e){e.DeleteCard="DeleteCard",e.CopyCard="CopyCard",e.ManualRefresh="ManualRefresh",e.GetApp="GetApp",e.CardCopied="CardCopied"}(a||(a={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.NeedsConsentForUpgrade=3]="NeedsConsentForUpgrade"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MailEditor=1]="MailEditor",e[e.MailReadingPane=2]="MailReadingPane",e[e.MailEditorReplyForward=3]="MailEditorReplyForward",e[e.MailReadingPaneFromExProp=4]="MailReadingPaneFromExProp"}(l||(l={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(c||(c={})),function(e){e[e.Full=0]="Full",e[e.Limited=1]="Limited",e[e.None=2]="None",e[e.Unknown=3]="Unknown"}(u||(u={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth"}(p||(p={}))},771:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(2),o=n(161),i=n(32),a=n(181),s=function(e){function t(){var t=e.apply(this,Object(r.__spreadArray)([],Object(r.__read)(arguments),!1))||this;return t._isPrepared=!1,t._areReferencedInputsDirty=!1,t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"_originalData",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"associatedInputs",{get:function(){return this.getValue(t.associatedInputsProperty)},set:function(e){this.setValue(t.associatedInputsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"conditionallyEnabled",{get:function(){return this.getValue(t.conditionallyEnabledProperty)},set:function(e){this.setValue(t.conditionallyEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.updateReferencedInputsDirtyState=function(){var e,t;this._areReferencedInputsDirty=!1;var n=this.getReferencedInputs();if(n)try{for(var o=Object(r.__values)(Object.keys(n)),i=o.next();!i.done;i=o.next()){if(n[i.value].isDirty()){this._areReferencedInputsDirty=!0;break}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.prototype.internalGetReferencedInputs=function(){var e,t,n={};if("none"!==this.associatedInputs){for(var o=this.parent,i=[];o;)i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(o.getAllInputs(!1)),!1)),o=o.parent;try{for(var a=Object(r.__values)(i),s=a.next();!s.done;s=a.next()){var l=s.value;l.id&&(n[l.id]=l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return n},t.prototype.internalPrepareForExecution=function(e){var t,n;if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)try{for(var o=Object(r.__values)(Object.keys(e)),i=o.next();!i.done;i=o.next()){var a=e[i.value];a.id&&a.isSet()&&(this._processedData[a.id]=a.valueAsString)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this._isPrepared=!0},t.prototype.internalAfterExecute=function(){o.a.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()},t.prototype.resetReferencedInputsDirtyState=function(){var e,t,n=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,n)try{for(var o=Object(r.__values)(Object.keys(n)),i=o.next();!i.done;i=o.next()){n[i.value].resetDirtyState()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.prototype.updateEnabledState=function(){var e,t,n=this._areReferencedInputsDirty;this.updateReferencedInputsDirtyState();var o=this.getReferencedInputs();if(o)try{for(var i=Object(r.__values)(Object.keys(o)),a=i.next();!a.done;a=i.next()){if(o[a.value].isDirty()){this._areReferencedInputsDirty=!0;break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._areReferencedInputsDirty!==n&&this.updateLayout()},t.prototype.isEffectivelyEnabled=function(){var t=e.prototype.isEffectivelyEnabled.call(this);return this.updateReferencedInputsDirtyState(),this.conditionallyEnabled?t&&this._areReferencedInputsDirty:t},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new i.i(i.s.v1_0,"data"),t.associatedInputsProperty=new a.c(i.s.v1_3,"associatedInputs"),t.conditionallyEnabledProperty=new i.b(i.s.v1_5,"conditionallyEnabled",!1),t}(a.a),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t}(s)},773:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(32),i=function(e){function t(t,n,r){void 0===r&&(r=[]);var o=e.call(this,t,n,void 0)||this;return o.targetVersion=t,o.name=n,o.forbiddenActionTypes=r,o}return Object(r.__extends)(t,e),t.prototype.parse=function(e,t,n){var r=e;return n.parseAction(r,t[this.name],this.forbiddenActionTypes,r.isDesignMode())},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t.prototype.getDescriptor=function(e){for(var t=[],n=0;n<e.actionRegistry.getItemCount();n++){var r=e.actionRegistry.getItemAt(n);if(-1===this.forbiddenActionTypes.indexOf(r.typeName)){var i=r.createInstance({context:e,typeName:r.typeName,targetVersion:e.targetVersion});t.push(new o.d(i))}}return{valueType:t.sort((function(e,t){return e.name.localeCompare(t.name)})),isArray:!1}},t}(o.i)},791:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.Conflict=409]="Conflict",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"}(r||(r={})),function(e){e.TeamsHubCopilot3sInvoke="TeamsHubCopilot3sInvoke",e.OfficeWebCopilot3sInvoke="OfficeWebCopilot3sInvoke",e.OutlookWebCopilot3sInvoke="OutlookWebCopilot3sInvoke",e.CibCopilot3sInvoke="cibCopilot3sInvoke",e.M365CardSDK="M365CardSDK"}(o||(o={}))},794:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.Conflict=409]="Conflict",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"}(r||(r={})),function(e){e.TeamsHubCopilot3sInvoke="TeamsHubCopilot3sInvoke",e.OfficeWebCopilot3sInvoke="OfficeWebCopilot3sInvoke",e.OutlookWebCopilot3sInvoke="OutlookWebCopilot3sInvoke",e.CibCopilot3sInvoke="cibCopilot3sInvoke",e.M365CardSDK="M365CardSDK"}(o||(o={}))},822:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(1),i=n(1828),a=n(147),s=n(32),l=n(655),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.add(l.a.selectActionProperty)},Object.defineProperty(t.prototype,"italic",{get:function(){return this.getValue(t.italicProperty)},set:function(e){this.setValue(t.italicProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strikethrough",{get:function(){return this.getValue(t.strikethroughProperty)},set:function(e){this.setValue(t.strikethroughProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlight",{get:function(){return this.getValue(t.highlightProperty)},set:function(e){this.setValue(t.highlightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this.getValue(t.underlineProperty)},set:function(e){this.setValue(t.underlineProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t=this;if(this.text){var n=this.preProcessPropertyValue(l.a.textProperty),r=this.hostConfig,s=Object(i.a)(this.lang,n),c=null!=s?s:"";if(this.selectAction&&r.supportsInteractivity){var u={style:{}};u.className=r.makeCssClassName("ac-anchor"),u.href=this.selectAction.getHref(),u.target="_blank",u.rel="noopener noreferrer",u.onClick=function(e){t.selectAction&&t.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.selectAction.execute())},this.selectAction.setupElementForAccessibility(u);var d=this.renderAnchor(s,u);null!==d&&(c=d)}var p=Object(a.b)();return p.className=r.makeCssClassName("ac-textRun"),p.style.whiteSpace="pre-wrap",this.applyStylesTo(p),o.createElement("span",p,c)}return null},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getEffectiveStyleDefinition().foregroundColors.getColorDefinition(this.effectiveColor),r=Object(a.l)(this.effectiveIsSubtle?n.highlightColors.subtle:n.highlightColors.default);r&&(t.style.backgroundColor=r)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new s.b(s.s.v1_2,"italic",!1),t.strikethroughProperty=new s.b(s.s.v1_2,"strikethrough",!1),t.highlightProperty=new s.b(s.s.v1_2,"highlight",!1),t.underlineProperty=new s.b(s.s.v1_3,"underline",!1),t}(l.a)},829:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return O})),n.d(t,"e",(function(){return S})),n.d(t,"b",(function(){return x}));var r=n(2),o=n(103),i=n(215),a=n(207),s=n(485),l=n(239),c=n(52),u=n(159),d=n(316),p=(n(1593),n(75)),g=n(326),h=n(340),f=n.n(h),m=void 0,v=void 0;function b(e,t,n){if(e.isFeatureGateEnabledFromClient(p.h.SkipHydrateEnabled))Object(c.c)("hydrateMessages: Skipping hydrating chat pane with history messages");else{Object(c.c)("hydrateMessages: Hydrating ".concat(t.length," messages"));var o=y(t);n((function(t){var n=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t),!1),Object(r.__read)(o),!1);if(!e.isFeatureGateEnabledFromClient(p.h.HydratedMessagesSquashingEnabled))return n;var i=function(e,t){void 0===t&&(t=function(e){return e.messageId});var n=new Map,o=new Map,i=e.map((function(e){return[e,t(e)]}));i.forEach((function(e,t){var i=Object(r.__read)(e,2),a=i[0],s=i[1];void 0!==s&&(o.set(s,a),n.has(s)||n.set(s,t))}));var a=[];return i.forEach((function(e,t){var i=Object(r.__read)(e,2),s=i[0],l=i[1];void 0===l?a.push(s):t===n.get(l)&&a.push(o.get(l))})),a}(n);if(Object(c.c)("hydrateMessages: Squashing reduced ".concat(n.length," messages to ").concat(i.length)),e.isFeatureGateEnabledFromClient(p.h.IsApplyClpFromHydratedMessagedEnabled)&&i&&i.length>0){var a={messagesClpLabels:Object(r.__spreadArray)([],Object(r.__read)(new Set(i.map((function(e){var t;return null===(t=e.clpSensitivityIndicatorData)||void 0===t?void 0:t.labelId})).filter(Boolean))),!1),workflowAnnotationType:"UpdateChatClpFromChatHistory"};e.sendEventToClient(l.c.UpdateChatClpFromChatHistory,a)}return i}))}}function y(e){var t,n,o=[];try{for(var i=Object(r.__values)(e.slice().reverse()),a=i.next();!a.done;a=i.next()){var s=C(a.value);s&&o.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}function C(e){return e.richTextJson?function(e){var t;Object(c.c)("parsing rich text and display message");try{t=JSON.parse(e)}catch(e){return void Object(c.c)("error parsing rich text from chat history",e.message)}if(t.messageType===o.a.ChatCardWrapper&&!t.body.renderData)return void Object(c.c)("No render data found for ChatCardWrapper");t.showAnimation=!1,t.clpSensitivityIndicatorData&&(t=Object(r.__assign)(Object(r.__assign)({},t),{clpSensitivityIndicatorData:Object(r.__assign)(Object(r.__assign)({},t.clpSensitivityIndicatorData),{icon:void 0})}));if(!Object(u.d)(t)&&t.body)return t;return}(e.richTextJson):e.content?function(e){var t,n=e.format,r=e.userRole,s=e.content;if(n===a.b.PlainText){var l=r===a.f.User;t={messageType:o.a.Default,body:{user:l?"human":"chat",messageHeader:{text:s}},shouldShowAIGeneratedIndicator:!l,showAnimation:!l,feedbackSectionPosition:l?i.a.None:i.a.Footer}}else t={messageType:o.a.MarkdownCard,body:{user:"chat",message:s},shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:i.a.Footer};if(!Object(u.d)(t)&&t.body)return t;return}(e):void 0}function O(e,t,n,r,i){var s=E(e,t,n,r,i);e.messageType===o.a.ChatCardWrapper&&(m=s,v=e.messageId),Object(d.b)(a.c.AddMessageOperation,s)}function S(e,t){if(m){Object(c.c)("resendCopilotMessage got key ".concat(e,", and found a message with key ").concat(v));var n=t(m);n&&Object(d.b)(a.c.AddMessageOperation,n)}}function E(e,t,n,l,u){var d;if((d=e.actionBarButtons?Object(r.__assign)(Object(r.__assign)({},e),{actionBarButtons:void 0}):e.warningActionButtons?Object(r.__assign)(Object(r.__assign)({},e),{warningActionButtons:void 0}):e.messageType===o.a.Designer?Object(r.__assign)(Object(r.__assign)({},e),{actionBarButtons:void 0,feedbackSectionPosition:i.a.None,body:Object(r.__assign)(Object(r.__assign)({},e.body),{isRehydration:!0})}):e).messageType===o.a.ChatCardWrapper){var p=d.body;p.renderData&&p.element&&(d=Object(r.__assign)(Object(r.__assign)({},d),{body:Object(r.__assign)(Object(r.__assign)({},p),{element:void 0})}))}var h="";try{h=JSON.stringify(d)}catch(e){Object(c.c)("error while stringify chat card props error:",e.message)}var f=n?a.f.User:l?a.f.System:a.f.Copilot;return function(e,t,n,r,o,i,l,c,u){var d={content:e,entry:t,userRole:n,format:r,timestamp:Date.now(),messageId:Object(s.a)(),status:o,richTextJson:i,messageMetadata:l,userId:c,rephrasedMessage:u};n==a.f.User&&(g.a.Instance.CurrentUserMessageId=d.messageId);return d}(t,a.a.Pane,f,a.b.RichText,l?a.e.Failure:a.e.Success,h,u)}function x(e,t){var n,i,a,s,l,c,u,d,p="";switch(t){case o.a.Default:p=function(e){var t,n,o,i,a="";(null==e?void 0:e.messageHeader)&&(a=a+I(e.messageHeader)+"\n");if(null==e?void 0:e.embeddedLists)try{for(var s=Object(r.__values)(e.embeddedLists),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.listHeader&&(a=a+c.listHeader+"\n"),c.listItems)try{for(var u=(o=void 0,Object(r.__values)(c.listItems)),d=u.next();!d.done;d=u.next()){var p=d.value;a+=p.title?"".concat(p.title,": ").concat(p.text+"\n"):"".concat(p.text+"\n")}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}c.listFooter&&(a=a+I(c.listFooter)+"\n")}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}(null==e?void 0:e.messageFooter)&&(a+=I(e.messageFooter));return a}(e.defaultMessageProps);break;case o.a.MarkdownCard:p=null!==(i=null===(n=e.markDownCardProps)||void 0===n?void 0:n.message)&&void 0!==i?i:"";break;case o.a.WarningMessage:p=(null===(a=e.warningMessageCardProps)||void 0===a?void 0:a.warningPrefix)+(null!==(l=null===(s=e.warningMessageCardProps)||void 0===s?void 0:s.warningEmphasizedText)&&void 0!==l?l:"")+(null!==(u=null===(c=e.warningMessageCardProps)||void 0===c?void 0:c.warningSuffix)&&void 0!==u?u:"");break;case o.a.ChatCardWrapper:p=null!==(d=e.chatCardWrapperProps.textContent)&&void 0!==d?d:"";break;case o.a.StreamingAdaptiveCard:p=function(e){if(!e)return"";var t=e.basin,n=e.uniqueId,r=e.accessPath;if((null==t?void 0:t.items)&&n&&r){var o=f()(e.basin.items[e.uniqueId],e.accessPath);return(null==o?void 0:o.body)?o.body.map((function(e){return e.text})).join("\n"):""}}(e.streamingAdaptiveCardProps);case o.a.ContentCard:case o.a.AccordionCard:case o.a.ProactiveSuggestionCard:case o.a.SelfHelpAdaptiveCard:}return p}function I(e){var t,n="";return(null==e?void 0:e.text)&&(n+=e.text),(null==e?void 0:e.linkText)&&(n=null!==(t=n+e.linkText.text+e.linkText.linkSuffix)&&void 0!==t?t:""),n}},840:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(242),o=function(){function e(e,t,n,o,i,a,s,l,c,u){this.logs=n,this.isRequired=l||!1,this.shouldLog=null==s||s,this.eventType=e,this.eventName=t,this.diagnosticLevel=u||r.b.CP_DIAGNOSTIC_LEVEL_OPTIONAL,this.dataCategory=c||r.a.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,this.scenarioName=o,this.capability=i,this.verb=a||""}return e.prototype.GetLogs=function(){return this.logs},e.prototype.SetLogs=function(e){this.logs=e},e.prototype.AddLog=function(e){this.logs.push(e)},e.prototype.IsRequired=function(){return this.isRequired},e.prototype.SetIsRequired=function(e){this.isRequired=e},e.prototype.SetEventType=function(e){this.eventType=e},e.prototype.GetEventType=function(){return this.eventType},e.prototype.SetEventName=function(e){this.eventName=e},e.prototype.GetEventName=function(){return this.eventName},e.prototype.SetDataCategory=function(e){this.dataCategory=e},e.prototype.GetDataCategory=function(){return this.dataCategory},e.prototype.SetDiagnosticLevel=function(e){this.diagnosticLevel=e},e.prototype.GetDiagnosticLevel=function(){return this.diagnosticLevel},e.prototype.SetScenarioName=function(e){this.scenarioName=e},e.prototype.GetScenarioName=function(){return this.scenarioName},e.prototype.SetCapability=function(e){this.capability=e},e.prototype.GetCapability=function(){return this.capability},e.prototype.GetShouldLog=function(){return this.shouldLog},e.prototype.SetShouldLog=function(e){this.shouldLog=e},e.prototype.GetVerb=function(){return this.verb},e.prototype.SetVerb=function(e){this.verb=e},e}()},865:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(2),o=n(1),i=n(773),a=n(161),s=n(28),l=n(175),c=n(32),u=n(181),d=n(147),p=function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i.targetVersion=t,i.name=n,i.internalName=r,i.fallbackProperty=o,i}return Object(r.__extends)(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var r,o=t[this.name];if(void 0===o)return this.defaultValue;var i=!1;if("string"==typeof o){try{var c=a.c.parse(o,!0);c.unit===s.s.Pixel&&(r=c.physicalSize,i=!0)}catch(e){}!i&&this.fallbackProperty&&(i=this.fallbackProperty.isValidValue(o,n))}return i||n.logParseEvent(e,s.A.InvalidPropertyValue,l.a.errors.invalidPropertyValue(o,this.name)),r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))},t.prototype.getDescriptor=function(e){var t,n=null===(t=this.fallbackProperty)||void 0===t?void 0:t.getDescriptor(e);return{valueType:"string",values:null==n?void 0:n.values,description:"Size in the format <number>px",isArray:!1}},t}(c.i),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(u.d.heightProperty),n.add(t.pixelHeightProperty)},Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"altText",{get:function(){return this.getValue(t.altTextProperty)},set:function(e){this.setValue(t.altTextProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this.getValue(t.backgroundColorProperty)},set:function(e){this.setValue(t.backgroundColorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixelWidth",{get:function(){return this.getValue(t.pixelWidthProperty)},set:function(e){this.setValue(t.pixelWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixelHeight",{get:function(){return this.getValue(t.pixelHeightProperty)},set:function(e){this.setValue(t.pixelHeightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowExpand",{get:function(){return this.getValue(t.allowExpandProperty)},set:function(e){this.setValue(t.allowExpandProperty,e)},enumerable:!1,configurable:!0}),t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width="".concat(this.pixelWidth,"px")),this.pixelHeight&&(e.style.height="".concat(this.pixelHeight,"px"));else if(this.maxHeight){switch(this.size){case s.r.Small:e.style.height="".concat(this.hostConfig.imageSizes.small,"px");break;case s.r.Large:e.style.height="".concat(this.hostConfig.imageSizes.large,"px");break;default:e.style.height="".concat(this.hostConfig.imageSizes.medium,"px")}e.style.maxHeight="".concat(this.maxHeight,"px")}else{switch(this.size){case s.r.Stretch:e.style.width="100%";break;case s.r.Auto:e.style.maxWidth="100%";break;case s.r.Small:e.style.width="".concat(this.hostConfig.imageSizes.small,"px");break;case s.r.Large:e.style.width="".concat(this.hostConfig.imageSizes.large,"px");break;case s.r.Medium:e.style.width="".concat(this.hostConfig.imageSizes.medium,"px")}e.style.maxHeight="100%"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var n=this;if(this.url){var r=Object(d.b)();r.style.display="flex",r.style.alignItems="flex-start";var i=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case s.i.Center:r.style.justifyContent="center";break;case s.i.Right:r.style.justifyContent="flex-end";break;default:r.style.justifyContent="flex-start"}var a={style:{}};a.style={minWidth:"0"},a.className=i.makeCssClassName("ac-image"),this.selectAction&&i.supportsInteractivity&&(a.onKeyPress=function(e){n.selectAction&&n.selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.stopPropagation(),n.selectAction.execute())},a.onClick=function(e){n.selectAction&&n.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),n.selectAction.execute())},this.selectAction.setupElementForAccessibility(a),this.selectAction.isEffectivelyEnabled()&&Object(d.a)(a,i.makeCssClassName("ac-selectable"))),this.applySize(a),this.style!==s.n.Default&&(a.style.borderRadius=this.style===s.n.Person?"50%":"".concat(this.hostConfig.roundedCornerRadius,"px"),a.style.backgroundPosition="50% 50%",a.style.backgroundRepeat="no-repeat");var l=Object(d.l)(this.backgroundColor);l&&(a.style.backgroundColor=l),a.src=this.preProcessPropertyValue(t.urlProperty);var c=this.preProcessPropertyValue(t.altTextProperty);return c&&(a.alt=c),o.createElement("div",r,this.renderImage({allowExpand:this.allowExpand,isSelectable:void 0!==this.selectAction},a))}return null},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},t.urlProperty=new c.n(c.s.v1_0,"url"),t.altTextProperty=new c.n(c.s.v1_0,"altText"),t.backgroundColorProperty=new c.n(c.s.v1_1,"backgroundColor"),t.styleProperty=new c.e(c.s.v1_0,"style",s.n,s.n.Default),t.sizeProperty=new c.e(c.s.v1_0,"size",s.r,s.r.Auto),t.pixelWidthProperty=new p(c.s.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new p(c.s.v1_1,"height","pixelHeight",u.d.heightProperty),t.selectActionProperty=new i.a(c.s.v1_1,"selectAction",["Action.ShowCard"]),t.allowExpandProperty=new c.b(c.s.v1_2,"allowExpand",!1),t}(u.d)},881:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.Ambiguous=300]="Ambiguous",e[e.MultipleChoices=300]="MultipleChoices",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.Unprocessable=422]="Unprocessable",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.FetchTimeoutStatusCode=707]="FetchTimeoutStatusCode",e[e.OfflineFetchFailureStatusCode=709]="OfflineFetchFailureStatusCode",e[e.FetchFailureStatusCode=710]="FetchFailureStatusCode"}(r||(r={}))},883:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.Ambiguous=300]="Ambiguous",e[e.MultipleChoices=300]="MultipleChoices",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.Unprocessable=422]="Unprocessable",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.FetchTimeoutStatusCode=707]="FetchTimeoutStatusCode",e[e.OfflineFetchFailureStatusCode=709]="OfflineFetchFailureStatusCode",e[e.FetchFailureStatusCode=710]="FetchFailureStatusCode"}(r||(r={}))},885:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.Ambiguous=300]="Ambiguous",e[e.MultipleChoices=300]="MultipleChoices",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.Unprocessable=422]="Unprocessable",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.FetchTimeoutStatusCode=707]="FetchTimeoutStatusCode",e[e.OfflineFetchFailureStatusCode=709]="OfflineFetchFailureStatusCode",e[e.FetchFailureStatusCode=710]="FetchFailureStatusCode"}(r||(r={}))},890:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(r||(r={}))},893:function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return I}));var r,o,i=n(2),a=n(391),s=n(2062),l=n(2061),c=n(2064),u=n(2063),d=n(2065),p=n(2066),g=n(143),h=n(144),f=n(133),m=!1,v=[],b=2e4;function y(e){C({kind:"event",event:e,timestamp:(new Date).getTime()})}function C(e){m&&(r?r(e):v.length<=b?v.push(e):1)}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(o||(o={}));var O,S=n(1155),E=n(1544),x=function(){return Object(S.a)("Microsoft.Office.WordOnline.DictationUserPerceivedLatencies",!0)||Object(S.a)("Microsoft.Office.OneNoteOnline.DictationUserPerceivedLatencies",!0)};!function(e){e[e.FinalResult=0]="FinalResult",e[e.PartialResult=1]="PartialResult"}(O||(O={}));var I=function(){function e(e,t,n,r,o,i,a){void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===i&&(i=s.a.Dictation);var c,u,d=this;this.initialized=!1,this.speechSessionEventToken=null,this.speechToTextPartialResultToken=null,this.speechToTextFinalResultToken=null,this.speechErrorEventToken=null,this.speechQualityEventToken=null,this.useDebugDictation=!1,a&&(this.augloopSessionUtil=new E.a(a)),this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,this.speechToTextProfile=i,this.startRecognitionInSpeechToTextClient=r,this.enableSetAnnotationsFromALVoiceClient=!!o,this.annotationObserver={onAnnotationResult:function(e){d.onAnnotationResult(e)}};var p=new URLSearchParams(null===(c=window.location.search)||void 0===c?void 0:c.toLowerCase()),g=null!==(u=l.a.dictationSettings.properties)&&void 0!==u?u:{};this.useDebugDictation="true"===p.get("wddictationdebugmode"),this.useDebugDictation&&(g.EnableAudioLogging="true");var h=p.get("wdspeechdomain");h&&(g.wdSpeechDomain=decodeURIComponent(h)),l.a.dictationSettings={properties:g}}return e.logPhraseId_old=function(e,t,n,r){e&&y({name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:e},{name:"ConnectionID",string:t},{name:"SessionID",string:n},{name:"MessageType",string:r}]})},e.logPhraseId=function(e,t,n){var r,o=null===(r=n.properties.JsonResult)||void 0===r?void 0:r.Id;if(o&&t&&n){var i={name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:o},{name:"ConnectionID",string:t.connectionID},{name:"SessionID",string:t.sessionID},{name:"MessageType",string:e},{name:"voiceLatency",int64:n.properties.audioLatency}]};if(n.properties.commandLatency&&i.dataFields.push({name:"commandLatency",int64:n.properties.commandLatency}),t.audioPerfTracker&&n.properties.JsonResult&&n.properties.JsonResult.Offset&&n.properties.JsonResult.Duration){var a=n.properties.JsonResult.Offset/1e4,s=n.properties.JsonResult.Duration/1e4,l="final"===e,c=t.audioPerfTracker.measureLatency(a,s,l);i.dataFields.push({name:"perceivedLatency",int64:c.perceived}),i.dataFields.push({name:"serviceLatency",int64:c.service})}y(i)}},e.prototype.initializeAsync=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=this.checkAnnotationActive(),g.a.sendTraceTag(521417154,h.a.msoulscat_Wac_Dictation,f.a.Info,"SpeechToTextClient.initializeAsync - initialized: ".concat(this.initialized,", annotationsActive: ").concat(n)),n?(g.a.sendTraceTag(521417153,h.a.msoulscat_Wac_Dictation,f.a.Warning,"Releasing old annotations"),[4,this.uninitializeAsync()]):[3,2];case 1:i.sent(),i.label=2;case 2:t&&(this.sessionTelemetry=t),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.activateAnnotations(e)];case 4:return i.sent(),this.warmUpAugloop(),this.initialized=!0,[3,6];case 5:if(r=i.sent(),o="SpeechToTextClient.initializeAsync - Activate Annotations - "+r.message,s={errorType:a.a.ErrorAugloopActivateAnnotations,errorMsg:o+" - Error stack: "+r.stack},!r.message)try{l={},Object.getOwnPropertyNames(r).forEach((function(e){return l[e]=r[e]})),g.a.sendTraceTag(509745299,h.a.msoulscat_Wac_Dictation,f.a.Error,"Odd error: "+JSON.stringify(l))}catch(e){g.a.sendTraceTag(509745298,h.a.msoulscat_Wac_Dictation,f.a.Error,"Failed to diagnose odd error: "+a.h(e))}return o.includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(s):this.fdSpeechClientObserver.onError(s),[3,6];case 6:return[2]}}))}))},e.prototype.uninitializeAsync=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,s,l=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:t=this.checkAnnotationActive(),g.a.sendTraceTag(521417152,h.a.msoulscat_Wac_Dictation,f.a.Info,"SpeechToTextClient.uninitializeAsync - initialized: ".concat(this.initialized,", annotationsActive: ").concat(t)),this.initialized=!1,r=(n=["speechSessionEventToken","speechToTextPartialResultToken","speechToTextFinalResultToken","speechQualityEventToken","speechErrorEventToken"]).map((function(e){return l[e]})).filter((function(e){return!!e})),i.label=1;case 1:return i.trys.push([1,6,,7]),this.augloopSessionUtil?[4,this.augloopSessionUtil.releaseAnnotations(r)]:[3,3];case 2:return i.sent(),[3,5];case 3:return[4,a.f(this.runtimeManager,r)];case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:return o=i.sent(),s="SpeechToTextClient.uninitializeAsync - Release Annotations - "+o.message,null===(e=this.sessionTelemetry)||void 0===e||e.onAugloopError(s),g.a.sendTraceTag(521417123,h.a.msoulscat_Wac_Dictation,f.a.Error,"SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+s+" - Error stack: "+o.stack),[3,7];case 7:return n.forEach((function(e){return l[e]=null})),[2]}}))}))},e.prototype.checkAnnotationActive=function(){return null!==this.speechSessionEventToken||null!==this.speechToTextPartialResultToken||null!==this.speechToTextFinalResultToken||null!==this.speechQualityEventToken||null!==this.speechErrorEventToken},e.prototype.getAnnotationObserver=function(){return this.annotationObserver},e.prototype.activateAnnotations=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.augloopSessionUtil?[4,this.activateAnnotationsUsingALSession(e)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.activateAnnotationsUsingRuntimeManager(e)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.activateAnnotationsUsingRuntimeManager=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=a.b(this.runtimeManager,c.a.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),n=a.b(this.runtimeManager,c.c.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),r=null,e.indexOf(O.PartialResult)>=0&&(r=a.b(this.runtimeManager,c.e.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),o=null,e.indexOf(O.FinalResult)>=0&&(o=a.b(this.runtimeManager,c.d.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),s=a.b(this.runtimeManager,c.b.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[4,Promise.all([n,r,o,s,t])];case 1:return l=i.sent(),this.speechSessionEventToken=l[0],this.speechToTextPartialResultToken=l[1],this.speechToTextFinalResultToken=l[2],this.speechQualityEventToken=l[3],this.speechErrorEventToken=l[4],[2]}}))}))},e.prototype.warmUpAugloop=function(){this.augloopSessionUtil?this.augloopSessionUtil.startAudioProcessor(this.useFrontdoorWorkflow,l.a.dictationSettings,u.c.version2,this.speechToTextProfile,this.sessionTelemetry):a.g(this.runtimeManager,this.useFrontdoorWorkflow,l.a.dictationSettings,u.c.version2,this.speechToTextProfile,this.sessionTelemetry)},e.prototype.onAnnotationResult=function(e){var t=this;a.d(e,c.a.getTypeName()).map((function(e){t.handleSpeechErrorEvent(e.body)})),a.d(e,c.c.getTypeName()).map((function(e){t.handleSpeechSessionEvent(e.body)})),a.d(e,c.e.getTypeName()).map((function(e){t.handleSpeechToTextPartialResult(e.body)})),a.d(e,c.d.getTypeName()).map((function(e){var n=e.body,r=n.text;!function(e,t,n,r){var o,i,a,s=new Map([[t.language,n]]);r&&""!==n&&r.onFinalResultAnnotationResponse(Date.now(),null===(o=t.properties.JsonResult)||void 0===o?void 0:o.Offset,null===(i=t.properties.JsonResult)||void 0===i?void 0:i.Duration);var l=new Map;l.set("JsonResult",JSON.stringify(t.properties.JsonResult)),e.onFinalText(s,l),x()?r&&""!==n&&I.logPhraseId("final",r,t):I.logPhraseId_old(null===(a=t.properties.JsonResult)||void 0===a?void 0:a.Id,null==r?void 0:r.connectionID,null==r?void 0:r.sessionID,"final")}(t.fdSpeechClientObserver,n,r,t.sessionTelemetry)})),a.d(e,c.b.getTypeName()).map((function(e){var n=e.body;n.eventInfo&&n.eventInfo.eventName===d.a.QualityStatusUpdate&&t.handleSpeechQualityEvent(n.eventInfo)}))},e.prototype.handleSpeechErrorEvent=function(e){e&&(g.a.sendTraceTag(521417122,h.a.msoulscat_Wac_Dictation,f.a.Warning,JSON.stringify(e)),e.ErrorState===u.b.FINAL&&e.ErrorImpact===u.a.NO_DICTATION?(g.a.sendTraceTag(521417121,h.a.msoulscat_Wac_Dictation,f.a.Error,JSON.stringify(e)),this.fdSpeechClientObserver.onError(e.ErrorCode)):e.ErrorState===u.b.INTERMITTENT&&e.ErrorImpact===u.a.NO_DICTATION?g.a.sendTraceTag(521417120,h.a.msoulscat_Wac_Dictation,f.a.Warning,JSON.stringify(e)):e.ErrorState===u.b.FINAL&&e.ErrorImpact===u.a.NO_COMMANDING&&(g.a.sendTraceTag(521417119,h.a.msoulscat_Wac_Dictation,f.a.Warning,JSON.stringify(e)),this.fdSpeechClientObserver.showDictationWarning(e.ErrorCode,e.ErrorImpact)))},e.prototype.handleSpeechSessionEvent=function(e){var t;switch(e.eventId){case p.a.SpeechRecognitionStarted:this.transcriberId=e.sessionId,this.useDebugDictation&&console.warn("Speech transcriberId: ".concat(this.transcriberId)),this.startRecognitionInSpeechToTextClient&&this.fdSpeechClientObserver.onSpeechRecognitionStarted();break;case p.a.SpeechRecognitionStopped:null===(t=this.sessionTelemetry)||void 0===t||t.setEndReason("SpeechRecognitionStopped"),this.fdSpeechClientObserver.onSpeechEnd();break;case p.a.SpeechSessionStarted:if(this.speechSessionId=e.sessionId,this.useDebugDictation&&console.warn("Speech speechSessionId: ".concat(this.speechSessionId)),this.fdSpeechClientObserver.onSpeechSessionStarted&&this.speechSessionId){var n={speechSessionId:this.speechSessionId,transcriptionSignature:""};this.fdSpeechClientObserver.onSpeechSessionStarted(n)}break;case p.a.SpeechSessionStopped:this.fdSpeechClientObserver.onSpeechSessionStopped&&this.fdSpeechClientObserver.onSpeechSessionStopped();break;default:console.warn("Unexpected speechSessionEventId: ".concat(e.eventId))}},e.prototype.handleSpeechToTextPartialResult=function(t){var n,r,o,i,a,s;if(""!==t.text){var l=new Map([[t.language,t.text]]);null===(n=this.sessionTelemetry)||void 0===n||n.onPartialResultAnnotationResponse(Date.now(),null===(r=t.properties.JsonResult)||void 0===r?void 0:r.Offset,null===(o=t.properties.JsonResult)||void 0===o?void 0:o.Duration);var c=new Map;c.set("JsonResult",JSON.stringify(t.properties.JsonResult)),this.fdSpeechClientObserver.onFragmentText(l,c),x()?this.sessionTelemetry&&e.logPhraseId("partial",this.sessionTelemetry,t):e.logPhraseId_old(null===(i=t.properties.JsonResult)||void 0===i?void 0:i.Id,null===(a=this.sessionTelemetry)||void 0===a?void 0:a.connectionID,null===(s=this.sessionTelemetry)||void 0===s?void 0:s.sessionID,"partial")}},e.prototype.handleSpeechQualityEvent=function(e){this.fdSpeechClientObserver.onEventUpdate(e)},e.prototype.activateAnnotationsUsingALSession=function(e){var t,n,r,o,a;return Object(i.__awaiter)(this,void 0,void 0,(function(){var s,l,u,d,p,g;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return s=null===(t=this.augloopSessionUtil)||void 0===t?void 0:t.activateAnnotationAsync(c.a.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),l=null===(n=this.augloopSessionUtil)||void 0===n?void 0:n.activateAnnotationAsync(c.c.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),u=null,e.indexOf(O.PartialResult)>=0&&(u=null===(r=this.augloopSessionUtil)||void 0===r?void 0:r.activateAnnotationAsync(c.e.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),d=null,e.indexOf(O.FinalResult)>=0&&(d=null===(o=this.augloopSessionUtil)||void 0===o?void 0:o.activateAnnotationAsync(c.d.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),p=null===(a=this.augloopSessionUtil)||void 0===a?void 0:a.activateAnnotationAsync(c.b.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[4,Promise.all([l,u,d,p,s])];case 1:return g=i.sent(),this.speechSessionEventToken=g[0],this.speechToTextPartialResultToken=g[1],this.speechToTextFinalResultToken=g[2],this.speechQualityEventToken=g[3],this.speechErrorEventToken=g[4],[2]}}))}))},e}()},895:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b}));var r,o,i=n(2),a=n(326),s=n(1141),l=n(1489),c=n(485),u=n(325),d=n(1151),p=n(52),g=n(17),h=n(171),f=n(316),m=function(e){r=e};!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(o||(o={}));var v=function(e,t,n){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var m,v,b,y,C,O,S,E,x,I,w,T,k,j,P,A,_,D,L,M,B,R;return Object(i.__generator)(this,(function(F){try{if(m=JSON.parse(e),v=(new Date).toISOString(),b=function(e){var t,n,r,a,s,l=null!==(a=null===(r=null==e?void 0:e.elements)||void 0===r?void 0:r.options)&&void 0!==a?a:[],c="CopilotChatFeedback",u=0;try{for(var d=Object(i.__values)(l),p=d.next();!p.done;p=d.next())switch(null===(s=p.value.displayedText)||void 0===s?void 0:s.toLowerCase()){case o.INACCURATE_OR_IRRELEVANT:u=33554432;break;case o.OFFENSIVE:c="CopilotChatReportHarm",u=32;break;case o.OTHER:u=64}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return{AnswerType:c,FeedbackReasonType:u}}(null==m?void 0:m.responseContent),y=b.AnswerType,C=b.FeedbackReasonType,O=a.a.Instance,S=null!==(k=null===(T=null===(w=null==m?void 0:m.responseContent)||void 0===w?void 0:w.elements.find((function(e){return e.userVerbatim})))||void 0===T?void 0:T.userVerbatim)&&void 0!==k?k:(null==m?void 0:m.responseContent)?JSON.stringify(m.responseContent):"",E=function(e){var t,n,r,o,i,s,l;if(null===(t=null==e?void 0:e.contextData)||void 0===t?void 0:t.sydneyContextData)return null===(n=null==e?void 0:e.contextData)||void 0===n?void 0:n.sydneyContextData;var c=a.a.Instance,u=c.RequestId,d=c.ChatTimestamp,g=c.GetMessageIdForRequestId(c.RequestId);try{var h=(null===(r=null==e?void 0:e.contextData)||void 0===r?void 0:r.cardMetaData)?JSON.parse(null===(o=null==e?void 0:e.contextData)||void 0===o?void 0:o.cardMetaData):void 0;h&&(u=null!==(i=null==h?void 0:h.promptId)&&void 0!==i?i:u,d=null!==(s=null==h?void 0:h.utteranceTimestamp)&&void 0!==s?s:d,g=null!==(l=null==h?void 0:h.feedbackMessageId)&&void 0!==l?l:g)}catch(e){Object(p.c)("Error parsing feedbackData",e.message)}return{conversationId:null!==f.c&&void 0!==f.c?f.c:c.ConversationId,requestId:u,utteranceTimeStamp:d,feedbackMessageId:g,sydneyEndpoint:c.SydneyEndpoint,locale:c.Locale}}(r),!E.feedbackMessageId&&!n||!E.conversationId||!E.sydneyEndpoint||!E.sydneyEndpoint.length)return h.a.getInstance().sendTelemetryChatEventData([{key:g.g.ChatEventType,value:g.f.FeedbackDataSydneyDataMissing}]),[2];x=Object.assign(new s.a,{responseData:{AnswerType:y,ClientName:t+"CopilotOCV",CorrelationId:Object(c.a)(),Date:v,Description:S,FeedbackId:null!==(j=null==m?void 0:m.diagnosticsUploadId)&&void 0!==j?j:Object(c.a)(),FeedbackRating:"Frown"===(null==m?void 0:m.feedbackType)?1:2,FeedbackReasonType:C,UserConsentGiven:null===(P=null==m?void 0:m.hostManagedContextDataConsent)||void 0===P||P,OptionalFields:{ConvId:null!==(A=E.conversationId)&&void 0!==A?A:"!CONVID_NA_"+(O.ErrorMessage?"[".concat(O.ErrorMessage,"]"):""),Endpoint:null!==(_=E.sydneyEndpoint)&&void 0!==_?_:"https://substrate.office.com/m365chat/SecuredChatHub",Locale:null!==(L=null!==(D=E.locale)&&void 0!==D?D:O.Locale)&&void 0!==L?L:"en-us",TraceId:null!==(M=E.feedbackMessageId)&&void 0!==M?M:(null===(B=E.requestId)||void 0===B?void 0:B.length)?E.requestId:"!TRACE_ID_NA",FeedbackSourceType:"OCV",UtteranceHappenTime:null!==(R=E.utteranceTimeStamp)&&void 0!==R?R:v,ContactMe:!!(null==m?void 0:m.userEmail)}}}),I=new l.b({parentPath:["Signal",s.a.getTypeName()],items:[{id:d.a.generateId(),body:x}]}),Object(p.c)("Submitting FeedbackDiagnosticDataSignal to Augloop : ".concat(s.a.getTypeName()," with signal: ").concat(JSON.stringify(I))),u.a.getInstance().submitOperation(I,s.a.getTypeName()),h.a.getInstance().sendTelemetryChatEventData([{key:g.g.ChatEventType,value:g.f.FeedbackDataUploadOperationSubmitted}])}catch(e){Object(p.c)("Error parsing feedback response data",e.message)}return[2]}))}))},b=function(){return a.a.Instance.CurrentUserMessageId}},896:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(r||(r={}))},899:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(1),o=n(544),i=Object(o.a)("@1js/create-shared-react-context",{});var a=function(e,t){var n=i.get();return n[t]||(n[t]=r.createContext(e))}({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider"),s=a.Provider;function l(){return r.useContext(a)}},99:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(2),o=n(1627),i=n(2445),a=Object(r.__assign)(Object(r.__assign)({},o.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}),s=Object(r.__assign)(Object(r.__assign)({},i.a),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"}),l=Object(r.__assign)(Object(r.__assign)({},o.a),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"})}}]);
//# sourceMappingURL=chunkOffice1js.js.map