"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[9444],{36599:(e,t,r)=>{r.d(t,{P:()=>s});var o=r(65043),a=r(83545),n=r(48043);class s extends o.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){const t=new n.QW(a.NN.FluentUiError,e.stack,e.stack);this.props.onRenderPromise.reject(t),this.props.onCompletePromise.reject(t)}render(){if(!this.state.hasError)return this.props.children;alert(this.props.stringTable.fluentUiErrorTitle)}constructor(e){super(e),this.state={hasError:!1}}}},64681:(e,t,r)=>{r.d(t,{x:()=>f});var o=r(65043),a=r(40488),n=r(57433),s=r(33516),i=r(53015),c=r(83545),l=r(48043),d=r(44869),h=r(57426);const m="shareIframe",u="www.odwebp.svc.ms",p="https://".concat(u,"/share");let g;const f=o.memo((e=>{const{payloadPromise:t,onRenderPromise:r,onCompletePromise:s,stringTable:i,perfMarks:c,localization:h,renderState:f,setRenderState:y,onIframeDismiss:S,useEnterpriseEndpoint:k,shareMode:C}=e,[P,x]=o.useState(void 0),[L,T]=o.useState({width:(0,d._5)(d.Ic),height:d.GB}),R=o.useRef(null),D=o.useRef(null),M=o.useCallback((e=>{let{width:t,height:r}=e;T({width:(0,d._5)(t),height:r})}),[]),N=o.useCallback((e=>{if(k){g=new URL(e).hostname;const t=Date.now();let r="".concat(e).concat("/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true","&clientId=").concat("fluid","&clickTime=").concat(t);return r+="&smkt=".concat(h.locale),r}g=u;return"".concat(p,"?smkt=").concat(h.locale)}),[k,h.locale]),_=o.useCallback((e=>{e&&e.focus()}),[]),I=o.useCallback((e=>{e&&(e.submit(),c.payloadSendStartTime=performance.now())}),[c]),j=o.useCallback((()=>{if(null!==R.current&&void 0!==P){const e=P.authToken,t=N(P.webAbsoluteUrl);R.current.target=m,R.current.method="POST",R.current.action=t;const r=document.createElement("input");r.type="text",r.value=e,r.name="access_token",r.hidden=!0,R.current.appendChild(r);const o=document.createElement("input");o.type="text",o.value=JSON.stringify(P),o.name="context",o.hidden=!0,R.current.appendChild(o),R.current.submit(),c.payloadSendStartTime=performance.now()}}),[N,R,P,c]),U=k?j:I;o.useEffect((()=>{t.then((e=>{x(e);const t=((e,t)=>{let r="";return r=t?new URL(e).origin:p,"clipboard-read self "+r+"; clipboard-write self "+r})(e.webAbsoluteUrl,k);D.current&&(D.current.allow=t),U()})).catch((e=>{r.reject(e),s.reject(e)}))}),[t,P,s,r,U,k]),o.useEffect((()=>{s.catch((()=>{y(l.yp.Error)}))}),[s]),o.useEffect((()=>{const e=e=>{w(e,S,r,s,y,M,c)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]);const z=b(f,L.width,L.height),q=v(L.width,L.height);return o.createElement(o.Fragment,null,f===l.yp.Loading&&o.createElement("div",{className:E(C),"aria-label":"Loading",ref:_},o.createElement(a.y,{size:n.H.large})),f===l.yp.Error&&o.createElement("div",{"aria-label":i.shareDialogErrorMessage},i.shareDialogErrorMessage),f!==l.yp.Error&&o.createElement("div",{className:z},k?o.createElement("form",{id:"shareform",ref:R}):P&&o.createElement("form",{id:"shareform",action:N(""),method:"post",target:m,ref:U},o.createElement("input",{type:"text",name:"context",defaultValue:JSON.stringify(P),style:{display:"none"}})),o.createElement("iframe",{className:q,name:m,title:e.stringTable.shareIframeTitle,sandbox:void 0,role:"dialog",ref:D})))})),w=(e,t,r,o,a,n,s)=>{const d=new URL(e.origin);if("https:"!==d.protocol||d.hostname!==g)return;const h=JSON.parse(e.data);switch(h.name){case"share_started":s.sharePointLoadStartTime=performance.now();break;case"share_ready":a(l.yp.Loaded),r.resolve(!0);break;case"share_resize":h&&(0,i.E)(h.width)&&(0,i.E)(h.height)&&0!==h.width&&0!==h.height&&n({width:h.width,height:h.height});break;case"share_dismiss":t();break;case"share_grantAccessCompleted":o.resolve(null===h||void 0===h?void 0:h.successful);break;case"share_completed":o.resolve(!0);break;case"share_error":const e=null!==h&&void 0!==h&&h.error?h.error.toString():"error not provided",d=null!==h&&void 0!==h&&h.errorCategory?h.errorCategory.toString():"error category not provided",m=null!==h&&void 0!==h&&h.errorMessage?h.errorMessage:"error message not provided",u=null!==h&&void 0!==h&&h.debugErrorMessage?h.debugErrorMessage:"debug error message not provided",p=new l.QW(c.NN.SpoShareError,m,u,e,d);r.reject(p),o.reject(p)}},E=e=>{switch(e){case h.n.default:case h.n.copyLink:return(0,s.Zq)({width:480,height:d.GB,paddingBottom:0,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}},"@media screen and (max-width: 430px)":{width:"100%"}});case h.n.atMention:return(0,s.Zq)({width:480,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}})}},v=(e,t)=>(0,s.Zq)({width:e,height:t,border:"none","@media screen and (max-width: 430px)":{width:d.Ic}}),b=(e,t,r)=>(0,s.Zq)({width:e===l.yp.Loaded?t:0,height:e===l.yp.Loaded?r:0,overflow:"hidden","@media screen and (max-width: 430px)":{width:e===l.yp.Loaded?d.Ic:0}})},57864:(e,t,r)=>{r.r(t),r.d(t,{ShareCallout:()=>u,ShareCalloutRenderer:()=>p});var o=r(65043),a=r(78632),n=r(49634),s=r(98656),i=r(50840),c=r(44869),l=r(48043),d=r(64681);var h=r(83545),m=r(36599);const u=o.memo((e=>{const{onRenderPromise:t,onCompletePromise:r,stringTable:u,perfMarks:p,localization:f,shareMode:w,onDismissCallout:E,calloutProps:v,showShareProps:b}=e,[y,S]=o.useState(l.yp.Loading),[k,C]=o.useState(!1),P=()=>{C(!0),E()};(e=>{const t=o.useRef(!1);o.useEffect((()=>{const r=r=>{t.current&&!r.relatedTarget&&e()};return window.addEventListener("blur",r),t.current=!0,()=>{t.current=!1,window.removeEventListener("blur",r)}}),[])})(P);const x=(0,n.D)(),L=(0,c.zq)(x,null===v||void 0===v?void 0:v.theme,b);return L.then((()=>{p.payloadLoadEndTime=performance.now(),(0,a.t)(15e3,[t,r]).then((e=>{if(e){const e=new l.QW(h.NN.SpoTimeoutError);(0,c.tD)(t,r,e)}})).catch((()=>{}))})).catch((()=>{})),o.createElement(m.P,{onCompletePromise:r,onRenderPromise:t,stringTable:u},o.createElement(s.N,{theme:null===v||void 0===v?void 0:v.theme},o.createElement(i.P,{hidden:k,onDismiss:P,...g,...v},o.createElement(d.x,{payloadPromise:L,onRenderPromise:t,onCompletePromise:r,stringTable:u,perfMarks:p,localization:f,renderState:y,setRenderState:S,onIframeDismiss:P,useEnterpriseEndpoint:!(0,c.iO)(e.showShareProps.tokenProvider),shareMode:w}))))})),p=e=>{const[t,r]=o.useState(!0);return t?o.createElement(u,{...e,onDismissCallout:()=>{r(!1),e.onDismissCallout()}}):null},g={setInitialFocus:!0,isBeakVisible:!1,gapSpace:0}}}]);
//# sourceMappingURL=shareCallout.8fe9172c.chunk.js.map