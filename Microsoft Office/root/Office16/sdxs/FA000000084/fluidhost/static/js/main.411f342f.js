/*! For license information please see main.411f342f.js.LICENSE.txt */
(()=>{var e={60138:(e,t,r)=>{"use strict";r.d(t,{z:()=>u});var n=r(58443),o=r(40118),i=r(56142),s=r(69235),a=r(51655),c=r(24921),l=r(91947),d=r(51492);class u{constructor(){this.getTokenCallCount=0,this.getTokenTotalDuration=0,this.getTokenSucceededAfterRetryCount=0,this.retryEnabledPromise=void 0,this.identityType="Enterprise"}get TokenProvider(){return this}getAppId(){return n.R0}async getToken(e,t){++this.getTokenCallCount;const r=a.q.startNew();if(e&&e.length>0){let a;if(e[0]&&e[0].indexOf("/")>=0)try{const t=new URL(e[0]),r=t.pathname.lastIndexOf("/");if(r>0){const e=t.pathname.substring(0,r);t.pathname=e,a=t.href}else a="".concat(t.protocol,"//").concat(t.hostname)}catch(l){throw(0,s.c2)("getToken()",new s.uV("scopes resource url is invalid",l)),new s.uV("scopes resource url is invalid")}else a="https://graph.microsoft.com";try{var c;const e=null===t||void 0===t?void 0:t.claims,n=null!==(c=null===t||void 0===t?void 0:t.forceRefresh)&&void 0!==c&&c,i=await o.n.GetInstance().getToken(a,e,n);return r.setSuccess(),this.getTokenTotalDuration+=r.getDuration(),"fromCache"in i?{token:i.token,fromCache:i.fromCache}:{token:i.token}}catch(l){throw n.Nu||(0,i.vV)(l),l}}throw new s.uV("No scopes provided to getToken")}async getTokenWithRetries(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;let n=0,o=1e3<r?1e3:r;for(;;)try{const r=await this.getToken(e,t);return n>0&&++this.getTokenSucceededAfterRetryCount,r}catch(i){this.retryEnabledPromise||(this.retryEnabledPromise=(0,l.PA)(d.u.OEP,"ChangeGate.FluidHost.TokenRetryOnError"));if(!await this.retryEnabledPromise)throw i;++n;const e=this.decorateErrorPerErrorCode(i,n);if(!e.canRetry)throw e.canRetry,e;if(n>=25)throw e;o>0&&await(0,c.y)(o),o=2*o>r?r:2*o}}decorateErrorPerErrorCode(e,t){const r=e;switch(r.attemptCount=t,null===r||void 0===r?void 0:r.errorCode){case 12007:r.canRetry=!0;break;case 13002:r.canRetry=!1,r.isExpected=!0;break;case 13001:case 13003:case 13005:r.canRetry=!1}return r}}},58443:(e,t,r)=>{"use strict";r.d(t,{A2:()=>u,CZ:()=>S,Ct:()=>i,FT:()=>f,KV:()=>l,L0:()=>g,Nu:()=>d,R0:()=>a,UH:()=>p,a8:()=>b,bY:()=>s,g4:()=>o,l1:()=>h,pY:()=>y,s:()=>v,sz:()=>m,xu:()=>n,yz:()=>c});const n="fluidElement",o=".fluid",i=".loop",s="animatedSplashScreen",a="FluidHostWin32",c=!1,l=!0,d=!1,u=100,h="FormsLoop",g="fluidLink",p="componentPartHostingElementId",m=864e5,f=290,v=835,y=245,b="white solid 1px",S="black solid 1px"},56142:(e,t,r)=>{"use strict";r.d(t,{Rm:()=>a,sF:()=>i,vV:()=>s});var n=r(58443);let o;function i(e){o=n.yz||e}function s(e){!0===o&&console.error(e)}async function a(e){!0===o&&console.log(e)}},69235:(e,t,r)=>{"use strict";r.d(t,{aK:()=>h,c2:()=>g,oD:()=>d,u1:()=>u,uV:()=>l});var n=r(37450),o=r(90589),i=r(58443),s=r(82645),a=r(56142),c=r(97232);class l extends Error{constructor(e,t,r){super(e),this.name=void 0,this.message=void 0,this.innerError=void 0,this.hydrateResult=void 0,this.name="AppError",this.message=e,this.innerError=t,this.hydrateResult=null!==r&&void 0!==r?r:c.d.Error_FluidHostWebApp_Exception}}function d(e){return e instanceof l?e:new l(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exception occurred.",e)}function u(e){return"string"===typeof e?e:e instanceof Error?e.message:e instanceof PromiseRejectionEvent?e.reason:"".concat(e)}function h(e){return e instanceof l?e.message:""}function g(e,t){if(i.yz){const e=u(t);(0,a.vV)("UNEXPECTED ERROR: ".concat(e))}else{const r={eventName:"Office.Extensibility.Fluid.HostWebAppErrors",eventFlags:{dataCategories:n.o.DataCategories.ProductServiceUsage,diagnosticLevel:n.o.DiagnosticLevel.FullEvent},dataFields:[(0,o.m9)("Message",h(t)),(0,o.m9)("Source",e)]};i.Nu||s.u.sendTelemetryEvent(r)}}},33829:(e,t,r)=>{"use strict";r.d(t,{As:()=>c,CD:()=>d,R2:()=>u,TN:()=>h,VN:()=>p,Vb:()=>l,bv:()=>g,dR:()=>s,sc:()=>a});var n=r(16460),o=r(91947),i=r(90662);function s(e){(0,n.gp)((t=>{const r=t.detail.isDarkBackground;e.forEach((e=>{e(r)}))}))}function a(e){(0,n.fQ)((t=>{const r=t.detail.newTheme,n=(0,i.g4)(r);e.forEach((e=>{e(n)}))}))}function c(e){(0,n.hj)((t=>{e(t.detail.documentUrl,t.detail.linkScope)}))}async function l(e){(0,n.WU)((t=>{e(t.detail.linkProblemState)}));const t=(await(0,o.KE)()).linkProblemState;t&&e(t)}function d(e){(0,n.$h)((t=>{t.detail.isPermissionError&&e(n.$R.Error)}))}function u(e){(0,n.ED)((t=>{const r=t.detail.isContentHeightLimited;e(r)}))}function h(e){(0,n.Md)((t=>{const r=t.detail.showLoopGlowBorder;e(r)}))}function g(e){(0,n.us)((t=>{const r=t.detail.isHeader;e(r)}))}function p(e){(0,n.gC)((t=>{e(t.detail.isReadOnly)}))}},899:(e,t,r)=>{"use strict";r.d(t,{Mg:()=>o,qn:()=>n,u0:()=>i,xE:()=>s});const n=window.external;function o(){return n.GetContext?n.GetContext().GetAppUILocale():void 0}function i(){var e;return(null===(e=n.GetContext())||void 0===e?void 0:e.GetCorrelationId())||""}function s(){const e=null===n||void 0===n?void 0:n.GetHostInfo(),[,t]=e.split("="),[r,o]=t.split("$"),i="string"===typeof o?o:"";return{appName:"string"===typeof r?r:"Unknown",appVersion:(null===n||void 0===n?void 0:n.GetContext().GetHostFullVersion())||"",platform:i}}},51492:(e,t,r)=>{"use strict";r.d(t,{CI:()=>d,LM:()=>g,MO:()=>w,PA:()=>o.PA,aw:()=>C,cn:()=>m,dG:()=>b,dK:()=>P,eH:()=>o.eH,hC:()=>u,lb:()=>k,n_:()=>o.n_,nw:()=>S,qF:()=>v,tT:()=>f,u:()=>p,x$:()=>o.x$,xH:()=>y,y:()=>h});var n=r(69235),o=r(91947),i=r(6971),s=r(56142);let a,c,l,d,u,h,g,p=function(e){return e.OEP="OEP",e}({});async function m(){var e;const t=await(0,i.E)();return null!==(e=null===t||void 0===t?void 0:t.loopComponentPropertiesAreEnabled)&&void 0!==e&&e}async function f(){return a||(a=(0,o.x$)(p.OEP,"FluidHost.IsCardLoopCdnCodeLoaderEnabled")),a}async function v(){var e;const t=await(0,i.E)(),r=null!==(e=null===t||void 0===t?void 0:t.useGenericLoader)&&void 0!==e&&e;return r&&(0,s.Rm)("Generic loader is enabled."),r}async function y(){return c||(c=(0,o.PA)(p.OEP,"FluidHost.IsSaveEmbeddedDataEnabled")),c}async function b(){return l||(l=(0,o.PA)(p.OEP,"ChangeGate.FluidHost.IsPlaybackHandlerEnabled")),l}async function S(){return d||(d=(0,o.PA)(p.OEP,"ChangeGate.FluidHost.ShyHeaderHovering")),d}async function C(){return u||(u=(0,o.PA)(p.OEP,"ChangeGate.FluidHost.IsComponentPartCheckEnabled")),u}async function k(){return h||(h=(0,o.PA)(p.OEP,"ChangeGate.FluidHost.isAppThemeBrandingEnabled")),h}async function w(){return g||(g=(0,o.PA)(p.OEP,"ChangeGate.FluidHost.isSetReadOnlyEnabled")),g}function P(e,t){if(!t||t.startsWith(".")||t.endsWith(".")||t.startsWith("Microsoft.Office."))throw new n.uV("The feature name is not valid.");return"Microsoft.Office.".concat(e,".").concat(t)}},61762:(e,t,r)=>{"use strict";r.d(t,{h:()=>zo});var n=r(73702);var o=r(95996),i=r(83125),s=r(83397),a=r(48680);const c=e=>(0,a.AU)("owh.useComponentInitialize",!0,e),l=e=>(0,a.AU)("owh.handleLocationRedirection",!0,e);class d{constructor(e,t){this.settingsProvider=t,this.defaultIntervalInMin=60,this.heartbeatSendTimerId=void 0,this.heartbeatIntervalMs=60*this.defaultIntervalInMin*1e3,this.onUserActivityStateChanged=e=>{e?this.resume():this.stop()},this.registerSessionEndingErrorObserver=e=>{(async()=>{try{const r=await e,n="container"in(t=r)&&"component"in t,o=await(n?r.component:r);o.ComponentLifecycle?o.ComponentLifecycle.on("error",(()=>this.dispose())):n&&r.container.then((e=>{const t=()=>this.dispose();e.on("closed",t),e.on("disposed",t)})).catch((()=>{this.dispose()}))}catch{this.dispose()}var t})().catch((()=>{this.dispose()}))},this.stop=()=>{this.clearHeartbeatSendTimer()},this.resume=()=>{this.sendHeartbeatAndReQueue()},this.queueHeartbeat=()=>{this.heartbeatSendTimerId=window.setTimeout((()=>{this.sendHeartbeatAndReQueue()}),this.heartbeatIntervalMs)},this.sendHeartbeatAndReQueue=()=>{this.heartbeatLogger&&(0,o.Ot)(this.heartbeatLogger,{eventName:"Heartbeat"}),this.queueHeartbeat()},this.clearHeartbeatSendTimer=()=>{window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=void 0},this.dispose=()=>{this.stop(),this.userActivityTracker.dispose(),this.heartbeatLogger=void 0},this.heartbeatLogger=new i.p("Heartbeat",e),this.heartbeatIntervalMs=60*(e=>(0,a.AU)("owh.HeartbeatIntervalInMin",60,e))(this.settingsProvider)*1e3,this.sendHeartbeatAndReQueue(),this.userActivityTracker=new s.N(this.heartbeatIntervalMs,this.onUserActivityStateChanged)}}var u=r(69235),h=r(51492);const g={KeyboardShortcutEmitter:"KeyboardShortcutEmitter",ConsumeLayout:"ConsumeLayout",ContentPlayable:"ContentPlayable",Focusable:"Focusable",FocusableV2:"FocusableV2",HTMLView:"HTMLView",ComponentProduceCommands:"ComponentProduceCommands",DeepLinking:"DeepLinking",ComponentClipboardProvider:"ComponentClipboardProvider",ComponentFocusable:"ComponentFocusable",ComponentHasTransaction:"ComponentHasTransaction",ComponentHighlight:"ComponentHighlight",ComponentProvidesPlaceholder:"ComponentProvidesPlaceholder",ComponentSelection:"ComponentSelection",IFluidHTMLView:"IFluidHTMLView",ComponentCanvasProvider:"ComponentCanvasProvider",HTMLViewable:"HTMLViewable",ComponentWithTitle:"ComponentWithTitle",ComponentTitle:"ComponentTitle",ComponentProperties:"ComponentProperties",MessageBannerProvider:"MessageBannerProvider",LoopState:"LoopState",IComponentLastEditedTracker:"IComponentLastEditedTracker",PresenceAwayStatusTrackerFetcher:"PresenceAwayStatusTrackerFetcher",IFluidLoadable:"IFluidLoadable",ComponentLifecycle:"ComponentLifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",ContentURL:"ContentURL",LoopComponentUrl:"LoopComponentUrl",Presence:"Presence",ComponentInitializer:"ComponentInitializer",ComponentMeetingInformationProvider:"ComponentMeetingInformationProvider",FluidMetadataProvider:"FluidMetadataProvider",ComponentTelemetryMetadata:"ComponentTelemetryMetadata"};var p=r(23989),m=r(25045);var f=r(82351),v=r(33788),y=r(75335);const b="14.31.9";var S=r(52841);function C(){var e;return!("1"!==(null===(e=(0,S.A)())||void 0===e?void 0:e.FluidDebugger))}var k=r(95720);function w(e){const t=Date.now(),r=(0,y.yb)(),{logger:n,...o}=e;return{logger:n&&new i.p(k.Ak,n,{isReplay:C()||void 0,owhVersion:b}),newConfig:o,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:r}}const P={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},{dataCorruptionError:E,dataProcessingError:T,...I}=P,N={...I,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var F;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(F||(F={}));var D=r(76078);function O(e){return"object"===typeof e&&null!==e&&e.errorType===N.locationRedirection}var B=r(16876);function x(e){if("object"!==typeof(t=e)||null===t)return!1;var t;const r=e.errorType,n=e.statusCode;return"fileNotFoundOrAccessDeniedError"===r&&404===n}var L=r(75460),A=r(52563),R=r(76899);var M,_=r(60257);!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(M||(M={}));var z=r(78632);const H="Open",U="PostBoot",j="FileOpenFailed",q="ComponentLoadError",V="ContainerConnectedTimeout",G="ContainerLoadError";var W=r(95740),K=r(69953);const J="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function Q(e,t,r,n,s,a,c){const l=new i.p("QoS",e);(0,o.hO)(l,{eventName:t,pillar:r,veto:n,errorType:s,isAce:!X(c),...a},c)}function X(e){if(!e)return!1;const t=e;return!(!t.errorType||![W.a.offlineError,W.a.fileNotFoundOrAccessDeniedError,W.a.authorizationError,K.E.snapshotTooBig,K.E.invalidFileNameError,W.a.fileOverwrittenInStorage,V].some((e=>e===t.errorType)))||!(!t.message||!new RegExp(J).test(t.message))}const Z=(e,t,r)=>{(0,z.t)(6e4,[r]).then((r=>{if(r&&!e.closed){const e=V;Q(t,k.Qk,U,"ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e}),(0,o.hO)(t,{eventName:k.Qk,errorType:e,isUserImpacting:!0},{message:"Timed out while connecting the container",errorType:e})}})).catch((()=>{}))},$=(e,t)=>{var r;const n={},o=e.resolvedUrl;o&&"id"in o&&(n.docId=o.id),null===(r=t.PersistedProperties)||void 0===r||r.addPersistedProperties(n)},Y=(e,t)=>{const r=new L.c;e.attachState!==M.Attached?e.once("attached",(()=>{$(e,t),Z(e,t,r)})):($(e,t),Z(e,t,r)),e.once("closed",(e=>{e&&(Q(t,k.Qk,U,"PostBootContainerClosed",e.errorType,{},e),(0,o.hO)(t,{eventName:k.Qk,errorType:e.errorType||k.Qk,isUserImpacting:!0,isExpected:x(e)},e))})),e.once("connected",(()=>{r.resolve()}))};var ee,te=r(65317);class re{get Disposable(){return this}get NamespaceLogger(){return this}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const r=e.duration,n=Date.now(),o="number"===typeof r?n-r:void 0;t={...this.perfMetadata,startTime:o,documentEverHidden:this.documentHiddenTrackerId&&(0,y.xl)(this.documentHiddenTrackerId)>-1,...t}}void 0===t.opMessageAgeMs&&"number"===typeof t.messageTimestamp&&(t={opMessageAgeMs:Date.now()-t.messageTimestamp,...t}),t.message&&(t.message=(0,te.ku)(t.message.toString())),t.stack&&(t.stack=(0,te.ku)(t.stack.toString())),t.error&&(t.error=(0,te.ku)(t.error.toString())),t.errorMessage&&(t.errorMessage=(0,te.ku)(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=(0,te.ku)(t.responseMessage.toString())),this.runtimeLogger.send(t)}dispose(){this.runtimeLogger.Disposable.dispose()}constructor(e,t,r){this.perfMetadata=t,this.documentHiddenTrackerId=r,this.runtimeLogger=new i.p("FluidRuntime",e)}}function ne(e){e.closed||e.attachState!==M.Attached&&void 0!==e.attachState||e.connect()}!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(ee||(ee={}));var oe=r(60835),ie=r(27284);class se extends ie.EventEmitter{emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}trackContainerEvents(){this.container.audience.on("addMember",this.addMemberEventHandler),this.container.audience.on("removeMember",this.removeMemberEventHandler),this.container.on("connected",this.connectedEventHandler),this.container.on("disconnected",this.disconnectedEventHandler),this.container.on("dirty",this.dirtyEventHandler),this.container.on("saved",this.savedEventHandler),this.container.on("readonly",this.readonlyEventHandler),this.container.on("closed",this.closedEventHandler),this.container.on("disposed",this.disposedEventHandler),this.container.on("warning",this.waringEventHandler)}removeContainerListeners(){this.container.audience.off("addMember",this.addMemberEventHandler),this.container.audience.off("removeMember",this.removeMemberEventHandler),this.container.off("connected",this.connectedEventHandler),this.container.off("disconnected",this.disconnectedEventHandler),this.container.off("dirty",this.dirtyEventHandler),this.container.off("saved",this.savedEventHandler),this.container.off("readonly",this.readonlyEventHandler),this.container.off("closed",this.closedEventHandler),this.container.off("disposed",this.disposedEventHandler),this.container.off("warning",this.waringEventHandler)}get ComponentLifecycle(){return this}get disposed(){return this._disposed}get isDirty(){return this.container.isDirty}get isReadOnly(){var e;return null!==(e=this.container.readOnlyInfo.readonly)&&void 0!==e&&e}get Disposable(){return this}dispose(){var e;this.container.dispose(),null===(e=this.component.Disposable)||void 0===e||e.dispose()}get ConnectionManager(){return this}get isConnected(){return this.container.connectionState===ee.Connected}connect(){this.container.connect()}disconnect(){this.container.disconnect()}get CollaboratorInfo(){return this}get clientId(){return this.container.clientId}getMembers(){const e=new Map;return this.container.audience.getMembers().forEach(((t,r)=>{const n=t.user;e.set(r,{id:n.id,name:n.name,email:n.email,joinTime:t.timestamp})})),e}get FluidMetadataProvider(){return this}getCodeDetails(){return this.container.getLoadedCodeDetails()}getSnapshot(){return this.container.serialize()}get LoopComponentUrl(){return this}async initializeLoopComponentUrl(e){if(!e)throw new Error("File name is required to initialize component url.");const t=await this.documentServiceFactoryProviderPromise;if(null===t||void 0===t||!t.getCreateDocumentRequest)throw new Error("FluidDocumentServiceFactoryProvider.getCreateDocumentRequest is required to initialize component url");const r=await t.getCreateDocumentRequest(e);await this.container.attach(r)}async getLoopComponentUrl(){const e=this.documentUrl?this.documentUrl:await this.container.getAbsoluteUrl("/");if(e)return new URL(e)}get FluidShareLinkInfo(){return this}getShareLink(){const e=this.container.resolvedUrl;if(e&&(0,oe.g2)(e))return e.shareLinkInfo}constructor(e,t,r,n){super(),this.container=e,this.documentUrl=t,this.documentServiceFactoryProviderPromise=r,this.component=n,this.addMemberEventHandler=()=>{this.emit("membersChanged",!0)},this.removeMemberEventHandler=()=>{this.emit("membersChanged",!1)},this.connectedEventHandler=()=>{this.emit("connected")},this.disconnectedEventHandler=e=>{this.emit("disconnected",e)},this.dirtyEventHandler=()=>{this.emit("dirty")},this.savedEventHandler=()=>{this.emit("saved")},this.readonlyEventHandler=e=>{this.emit("readonlyChanged",e)},this.closedEventHandler=e=>{this.emit("error",e)},this.disposedEventHandler=()=>{this.emit("disposed"),this._disposed=!0,this.removeContainerListeners(),this.removeAllListeners()},this.waringEventHandler=e=>{this.emit("warning",e)},this.trackContainerEvents(),this.container.forceReadonly&&(this.setReadonly=e=>{var t,r;null===(t=(r=this.container).forceReadonly)||void 0===t||t.call(r,e)}),this._disposed=!1}}const ae={ComponentLifecycle:"ComponentLifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",FluidMetadataProvider:"FluidMetadataProvider",LoopComponentUrl:"LoopComponentUrl",Disposable:"Disposable",FluidShareLinkInfo:"FluidShareLinkInfo"};function ce(e,t,r,n,o){const i={};let s;t&&function(e){return Object.keys(ae).some((t=>t in e))}(r)&&(s=new se(t,o,n,e));for(const a of Object.keys(r)){const t=s&&a in s?{value:s[a]}:{value:e[a]};Object.defineProperty(i,a,t)}return i}var le=r(28101),de=r(74080);const ue={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let he;const ge=new Uint8Array(16);function pe(){if(!he&&(he="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!he))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return he(ge)}const me=[];for(let Ho=0;Ho<256;++Ho)me.push((Ho+256).toString(16).slice(1));function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return me[e[t+0]]+me[e[t+1]]+me[e[t+2]]+me[e[t+3]]+"-"+me[e[t+4]]+me[e[t+5]]+"-"+me[e[t+6]]+me[e[t+7]]+"-"+me[e[t+8]]+me[e[t+9]]+"-"+me[e[t+10]]+me[e[t+11]]+me[e[t+12]]+me[e[t+13]]+me[e[t+14]]+me[e[t+15]]}const ve=function(e,t,r){if(ue.randomUUID&&!t&&!e)return ue.randomUUID();const n=(e=e||{}).random||(e.rng||pe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return fe(n)};var ye=r(70202),be=r(8653),Se=r(12624),Ce=r(83644),ke=r(2642),we=r(60056),Pe=r(97652);function Ee(e){var t;const r=(0,de.parse)(e,!0);if("string"!==typeof r.pathname)throw new we.iq("Failed to parse pathname");const n=null!==(t=r.search)&&void 0!==t?t:"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(r.pathname);return 3===(null===o||void 0===o?void 0:o.length)?{id:o[1],path:o[2],query:n,version:r.query.version}:void 0}function Te(e,t){(0,Se.v)(!(0,Pe.ub)(e),1448),(0,Se.v)(!(0,Pe.ub)(t),1449);return{type:ke.Z.Tree,tree:{".protocol":t,".app":e}}}function Ie(e){const t={blobs:{},blobsContents:{},trees:{},id:ve(),unreferenced:e.unreferenced},r=Object.keys(e.tree);for(const n of r){const r=e.tree[n];switch(r.type){case ke.Z.Tree:t.trees[n]=Ie(r);break;case ke.Z.Attachment:t.blobs[n]=r.id;break;case ke.Z.Blob:{const e=ve();t.blobs[n]=e;const o="string"===typeof r.content?(0,ye.Xg)(r.content,"utf8"):(0,be.M)(r.content);t.blobsContents[e]=o;break}case ke.Z.Handle:throw new we.iq("No handles should be there in summary in detached container!!");default:(0,Ce.$)(r,"Unknown tree type ".concat(r.type))}}return t}function Ne(e,t){const r={type:ke.Z.Tree,tree:{...t.tree}};r.tree[".protocol"]=e;return Ie(r)}const Fe=e=>{(0,Se.v)((0,Pe.ub)(e),480);return Ne(e.tree[".protocol"],e.tree[".app"])};function De(e){return".protocol"in e.trees?e.trees[".protocol"]:e}function Oe(e){return"object"===typeof e&&null!==e&&(null===e||void 0===e?void 0:e.errorType)===N.deltaStreamConnectionForbidden}async function Be(e,t,r,n){var o,i;let s="/";if(n){const e=await t.resolve({url:n.url});if(!e)throw new Error("Get undefined for resolvedUrl with ".concat(n.url));const r=Ee(e.url);void 0!==r&&(s="".concat(r.path).concat(r.query))}const a={url:s,headers:r},c=await(null===(o=e.getEntryPoint)||void 0===o?void 0:o.call(e));if(c){var l,d;const e={status:200,mimeType:"fluid/object",value:c};if("/"===a.url||""===a.url)return e;const t=await(null===(l=c.UrlRouterFetcher)||void 0===l?void 0:l.getUrlRouter());return null!==(d=await(null===t||void 0===t?void 0:t.request(le.X.create(a))))&&void 0!==d?d:e}const u=null===(i=e.runtime)||void 0===i?void 0:i.request;if(u&&"function"===typeof u)return u(a);throw new Error("Could not invoke the request via the legacy back-compat path: `container.runtime.request` not found.")}async function xe(e,t,r,n,o,i,s,a,c){var l;const d=v.m.start(k.a$,n,{addUserTiming:!0,isAPerformanceMetric:!0}),u=(0,y.yb)();let h;try{h=await async function(e,t,r,n,o,i,s){const a=v.m.start(k.ol,n,{addUserTiming:!0});let c;if(o){const n={...null===r||void 0===r?void 0:r.headers,wait:!1,externalRequest:!1};if(c=await Be(e,t,n,r),404===c.status){ne(e);const n={...null===r||void 0===r?void 0:r.headers,externalRequest:!1};c=await Be(e,t,n,r)}}else{const n={...null===r||void 0===r?void 0:r.headers,externalRequest:!1};c=await Be(e,t,n,r)}if(200!==c.status||"fluid/component"!==c.mimeType&&"fluid/object"!==c.mimeType||!c.value){const e=new B.vU("Component not found: status=".concat(c.status,", value=").concat(c.value),void 0,c.status,c.stack),t={externalRequest:!1,mimeType:c.mimeType};throw a.setResult(!1,t,e),e}const l=c.value;if(a.setResult(!0),s){const t=null===i||void 0===i?void 0:i.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return ce(l,e,s,null===t||void 0===t?void 0:t.FluidDocumentServiceFactoryProvider,null===r||void 0===r?void 0:r.url)}return l}(e,t,r,n,s,a)}catch(vt){return function(e){(0,y.WN)(u),d.setResult(!1,void 0,e)}(vt),Promise.reject(vt)}const g=h.ComponentTelemetryMetadata,p=null===g||void 0===g?void 0:g.entityName,m=null===(l=h.IFluidLoadable)||void 0===l?void 0:l.handle.absolutePath,f=(0,y.xl)(u,!0),b=(0,y.xl)(i);if(d.setResult(!0,{...o,componentType:p,componentUrl:m,documentEverHidden:b>-1,documentHidden:f>-1}),s&&function(e,t,r){void 0===r||r<=0?ne(e):Promise.race([(0,z.c)(r),t]).then((()=>{setTimeout((()=>{ne(e)}),50)})).catch((()=>{}))}(e,void 0,0),c){const t=null===a||void 0===a?void 0:a.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return ce(h,e,c,null===t||void 0===t?void 0:t.FluidDocumentServiceFactoryProvider,null===r||void 0===r?void 0:r.url)}return h}var Le,Ae=r(72264),Re=r(43812);!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(Le||(Le={}));var Me=r(21605),_e=r(98418);const ze=10;var He;!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(He||(He={}));const Ue=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid),je=e=>{const t=e;return"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.package)||Ue(null===t||void 0===t?void 0:t.package))&&(void 0===(null===t||void 0===t?void 0:t.config)||"object"===typeof(null===t||void 0===t?void 0:t.config))};var qe=r(84792),Ve=r(89951),Ge=r(19307),We=r(16713),Ke=r(57406),Je=r(24847),Qe=r(25249);const Xe="object"===typeof self?self:globalThis,Ze=e=>((e,t)=>{const r=(t,r)=>(e.set(r,t),t),n=o=>{if(e.has(o))return e.get(o);const[i,s]=t[o];switch(i){case 0:case-1:return r(s,o);case 1:{const e=r([],o);for(const t of s)e.push(n(t));return e}case 2:{const e=r({},o);for(const[t,r]of s)e[n(t)]=n(r);return e}case 3:return r(new Date(s),o);case 4:{const{source:e,flags:t}=s;return r(new RegExp(e,t),o)}case 5:{const e=r(new Map,o);for(const[t,r]of s)e.set(n(t),n(r));return e}case 6:{const e=r(new Set,o);for(const t of s)e.add(n(t));return e}case 7:{const{name:e,message:t}=s;return r(new Xe[e](t),o)}case 8:return r(BigInt(s),o);case"BigInt":return r(Object(BigInt(s)),o)}return r(new Xe[i](s),o)};return n})(new Map,e)(0),$e="",{toString:Ye}={},{keys:et}=Object,tt=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=Ye.call(e).slice(8,-1);switch(r){case"Array":return[1,$e];case"Object":return[2,$e];case"Date":return[3,$e];case"RegExp":return[4,$e];case"Map":return[5,$e];case"Set":return[6,$e]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},rt=e=>{let[t,r]=e;return 0===t&&("function"===r||"symbol"===r)},nt=function(e){let{json:t,lossy:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return((e,t,r,n)=>{const o=(e,t)=>{const o=n.push(e)-1;return r.set(t,o),o},i=n=>{if(r.has(n))return r.get(n);let[s,a]=tt(n);switch(s){case 0:{let t=n;switch(a){case"bigint":s=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return o([-1],n)}return o([s,t],n)}case 1:{if(a)return o([a,[...n]],n);const e=[],t=o([s,e],n);for(const r of n)e.push(i(r));return t}case 2:{if(a)switch(a){case"BigInt":return o([a,n.toString()],n);case"Boolean":case"Number":case"String":return o([a,n.valueOf()],n)}if(t&&"toJSON"in n)return i(n.toJSON());const r=[],c=o([s,r],n);for(const t of et(n))!e&&rt(tt(n[t]))||r.push([i(t),i(n[t])]);return c}case 3:return o([s,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return o([s,{source:e,flags:t}],n)}case 5:{const t=[],r=o([s,t],n);for(const[o,s]of n)(e||!rt(tt(o))&&!rt(tt(s)))&&t.push([i(o),i(s)]);return r}case 6:{const t=[],r=o([s,t],n);for(const o of n)!e&&rt(tt(o))||t.push(i(o));return r}}const{message:c}=n;return o([s,{name:a,message:c}],n)};return i})(!(t||r),!!t,new Map,n)(e),n},ot="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?Ze(nt(e,t)):structuredClone(e):(e,t)=>Ze(nt(e,t));class it extends ie.EventEmitter{constructor(){super(),this.members=new Map,super.setMaxListeners(0)}on(e,t){return super.on(e,t)}addMember(e,t){if(this.members.has(e)){const r=this.members.get(e);(0,Se.v)(JSON.stringify(r)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}}class st{get clientId(){return this._getClientId()}get id(){var e;return null!==(e=this._getContainerDiagnosticId())&&void 0!==e?e:""}get connected(){return this._getConnected()}constructor(e,t,r,n,o,i,s,a,c,l,d,u,h,g,p,m,f,v,y,b,S,C,k,w,P,E){this.options=e,this.scope=t,this.baseSnapshot=r,this._version=n,this.deltaManager=o,this.storage=i,this.quorum=s,this.audience=a,this.loader=c,this.submitFn=l,this.submitSummaryFn=d,this.submitBatchFn=u,this.submitSignalFn=h,this.disposeFn=g,this.closeFn=p,this.updateDirtyContainerState=m,this.getAbsoluteUrl=f,this._getContainerDiagnosticId=v,this._getClientId=y,this._getAttachState=b,this._getConnected=S,this.getSpecifiedCodeDetails=C,this.clientDetails=k,this.existing=w,this.taggedLogger=P,this.pendingLocalState=E,this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]])}getLoadedFromVersion(){return this._version}get attachState(){return this._getAttachState()}}var at;!function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(at||(at={}));var ct=r(33941),lt=r(71724);class dt extends _e.X{get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){var e;return null!==(e=this.processingPromise)&&void 0!==e?e:{count:0,duration:0}}constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new lt,this.pauseCount=1}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(vt){this.emit("error",vt)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){(0,Se.v)(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then((()=>{(0,Se.v)(void 0!==this.processingPromise,895);const e=this.processDeltas();return(0,Se.v)(void 0!==this.processingPromise,896),this.processingPromise=void 0,e})).catch((e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0}))),(0,Se.v)(void 0!==this.processingPromise,897))}anythingToProcess(){return 0!==this.q.length&&!this.paused&&void 0===this.error}processDeltas(){const e=Me.F.now();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const r=Me.F.now()-e;return 0===this.q.length&&this.emit("idle",t,r),{count:t,duration:r}}}const ut={...P,clientSessionExpiredError:"clientSessionExpiredError"};var ht;!function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(ht||(ht={}));class gt extends we.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=ut.throttlingError}static wrap(e,t,r){return(0,we.G)(e,(e=>new gt(e,t)),r)}}function pt(e){if((0,We.Wz)(e))return!0;switch(e.type){case Ke.Go.Propose:case Ke.Go.Reject:case Ke.Go.NoOp:case We.sI.Accept:case Ke.Go.Summarize:return!0;default:return!1}}class mt extends _e.X{get active(){return this._active()}get disposed(){return this._closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return(0,Se.v)(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;const i={contents:t,metadata:arguments.length>3?arguments[3]:void 0,referenceSequenceNumber:null!==o&&void 0!==o?o:this.lastProcessedSequenceNumber,type:e,compression:n};r||this.flush();const s=this.connectionManager.prepareMessageToSend(i);return void 0===s?-1:((0,Se.v)(pt(s),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(s),s.type===Ke.Go.NoOp&&this.noOpCount++,this.emit("submitOp",s),r||this.flush(),s.clientSequenceNumber)}submitSignal(e,t){return this.connectionManager.submitSignal(e,t)}flush(){const e=this.messageBuffer;if(0!==e.length){var t,r,n;if(this.messageBuffer=[],this.emit("prepareSend",e),1===e.length)(0,Se.v)(void 0===(null===(t=e[0].metadata)||void 0===t?void 0:t.batch),969);else(0,Se.v)(!0===(null===(r=e[0].metadata)||void 0===r?void 0:r.batch),970),(0,Se.v)(!1===(null===(n=e[e.length-1].metadata)||void 0===n?void 0:n.batch),971);this.connectionManager.sendMessages(e),(0,Se.v)(0===this.messageBuffer.length,972)}}get connectionProps(){return{sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0,deltaManagerState:this._disposed?"disposed":this._closed?"closed":"open",...this.connectionManager.connectionProps}}logConnectionIssue(e){var t;(0,Se.v)(this.connectionManager.connected,568);const r=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.logger.sendTelemetryEvent({...e,fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber,...this.connectionManager.connectionVerboseProps,pendingOps:this.pending.length,pendingFirst:null===(t=r[0])||void 0===t?void 0:t.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused})}constructor(e,t,r,n){super(),this.serviceProvider=e,this.logger=t,this._active=r,this.pending=[],this.currentlyProcessingOps=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.noOpCount=0,this.lastClientSequenceNumber=0,this.opsSize=0,this.initSequenceNumber=0,this._closed=!1,this._disposed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new AbortController,this.deltaStorageDelayId=ve(),this.deltaStreamDelayId=ve(),this.messageBuffer=[];const o={incomingOpHandler:(e,t)=>{try{this.enqueueMessages(e,t)}catch(vt){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},vt),this.close((0,we.cQ)(vt))}},signalHandler:e=>{for(const t of e)this._inboundSignal.push(t)},reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:(e,t)=>{(0,Je.uk)(this,this.logger,"readonly",e,t)},establishConnectionHandler:e=>this.establishingConnection(e),cancelConnectionHandler:e=>this.cancelEstablishingConnection(e)};this.connectionManager=n(o),this._inbound=new dt((e=>{this.processInboundMessage(e)})),this._inbound.on("error",(e=>{this.close(Re.I9.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))})),this._inboundSignal=new dt((e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({clientId:e.clientId,content:JSON.parse(e.content)})})),this._inboundSignal.on("error",(e=>{this.close((0,we.cQ)(e))}))}cancelEstablishingConnection(e){this.emit("cancelEstablishingConnection",e)}establishingConnection(e){this.emit("establishingConnection",e)}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,void 0!==r&&this.updateLatestKnownOpSeqNumber(r),(0,Se.v)(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0!==r?this.lastObservedSeqNumber-this.lastSequenceNumber:void 0),void 0!==r?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}async attachOpHandler(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none";if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=t,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=t,this.lastObservedSeqNumber=t,(0,Se.v)(void 0===this.handler,226),this.handler=r,(0,Se.v)(!!this.handler,227),(0,Se.v)(void 0===this.fetchReason,616),!this._closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==n){const e="cached"===n;await this.fetchMissingDeltasCore("DocumentOpen_".concat(n),e),e&&this.fetchMissingDeltas("PostDocumentOpen")}(0,Se.v)(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){var t;const r=null===(t=e.fetchOpsFromStorage)||void 0===t||t;!function(e,t,r){if(e)return!0;const n="string"===typeof r?{eventName:r,category:"error"}:{category:"error",...r};t.send(n)}(void 0!==this.handler||!r,this.logger,"CantFetchWithoutBaseline"),r&&this.fetchMissingDeltas(e.reason.text),this.connectionManager.connect(e.reason,e.mode)}async getDeltas(e,t,r,n,o){const i=this.serviceProvider();if(void 0===i)throw new Error("Delta manager is not attached");let s;if(void 0===this.deltaStorage&&(this.deltaStorage=await i.connectToDeltaStorage()),void 0!==t){const n=t-1;if(this.lastQueuedSequenceNumber>=n)return void this.logger.sendPerformanceEvent({reason:r,eventName:"ExtraStorageCall",early:!0,from:e,to:t,...this.connectionManager.connectionVerboseProps});s=e=>e.sequenceNumber>=n}else s=e=>e.sequenceNumber>=this.lastObservedSeqNumber;const a=new AbortController;let c=!1;const l=e=>{(0,Se.v)(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!c&&s(e)&&(a.abort("DeltaManager getDeltas fetch cancelled"),this._inbound.off("push",l))};try{this._inbound.on("push",l),(0,Se.v)(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.onabort=()=>a.abort(this.closeAbortController.signal.reason);const i=this.deltaStorage.fetchMessages(e,t,a.signal,o,r);for(;;){const e=await i.read();if(e.done)break;try{c=!0,n(e.value)}finally{c=!1}}}finally{a.signal.aborted&&this.logger.sendTelemetryEvent({eventName:"DeltaManager_GetDeltasAborted",fetchReason:r,reason:a.signal.reason}),this.closeAbortController.signal.onabort=null,this._inbound.off("push",l),(0,Se.v)(!c,649)}}close(e){this._closed||(this._closed=!0,this.connectionManager.dispose(e,!0),this.clearQueues(),this.emit("closed",e))}dispose(e){if(!this._disposed){if(void 0!==e&&!(0,ct.Xy)(e))throw new Re.eb("Error must be a Fluid error");this._disposed=!0,this._closed=!0,this.connectionManager.dispose(e,!1),this.clearQueues(),this.emit("disposed",e),this.removeAllListeners()}}clearQueues(){this.closeAbortController.abort("DeltaManager is closed"),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[]}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e)}emitDelayInfo(e,t,r){const n=Date.now();if(this.throttlingIdSet.add(e),t>0&&n+t>this.timeTillThrottling){this.timeTillThrottling=n+t;const e=gt.wrap(r,t/1e3,this.logger);this.emit("throttled",e)}}comparableMessagePayload(e){return"".concat(e.clientId,"-").concat(e.type,"-").concat(e.minimumSequenceNumber,"-").concat(e.referenceSequenceNumber,"-").concat(e.timestamp)}enqueueMessages(e,t){var r;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===this.handler)return void(this.pending=this.pending.concat(e));if((0,Se.v)(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const o=e[0].sequenceNumber,i=e[e.length-1].sequenceNumber;if(i>this.lastQueuedSequenceNumber){let r=o-1;const s=r-this.lastQueuedSequenceNumber;let a,c,l=0,d=0;for(const t of e)t.sequenceNumber===r?l++:t.sequenceNumber!==r+1&&(d++,void 0===a&&(a=r+1)),r=t.sequenceNumber;0!==l||0!==d&&!n||s>0&&void 0===this.fetchReason?c="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&o<=this.lastQueuedSequenceNumber+1&&i>this.lastQueuedSequenceNumber&&(c="enqueueMessagesExtraFetch"),void 0!==c&&this.logger.sendPerformanceEvent({eventName:c,reason:t,previousReason:this.prevEnqueueMessagesReason,from:o,to:i+1,length:e.length,fetchReason:this.fetchReason,duplicate:l>0?l:void 0,initialGap:0!==s?s:void 0,gap:d>0?d:void 0,firstMissing:a,dmInitialSeqNumber:this.initialSequenceNumber,...this.connectionManager.connectionVerboseProps})}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const s=null===(r=this.previouslyProcessedMessage)||void 0===r?void 0:r.sequenceNumber;(0,Se.v)(void 0===s||s===this.lastQueuedSequenceNumber,236);for(const c of e){var a;if(c.sequenceNumber<=this.lastQueuedSequenceNumber){if((null===(a=this.previouslyProcessedMessage)||void 0===a?void 0:a.sequenceNumber)===c.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(c);if(e!==t){const r=new Ge.OI("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",N.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:c.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else c.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(c),this.fetchMissingDeltas(t,c.sequenceNumber)):(this.lastQueuedSequenceNumber=c.sequenceNumber,this.previouslyProcessedMessage=c,this._inbound.push(c))}this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();(0,Se.v)(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;const r="string"===typeof e.clientId;if((0,Se.v)(null===e.clientId||r,1050),!r&&pt(e)&&e.type!==Ke.Go.NoOp)throw new Re.EW("Mismatch in clientId",{...(0,Re.ds)(e),messageType:e.type});if("string"===typeof e.contents&&""!==e.contents&&e.type!==Ke.Go.ClientLeave&&(e.contents=JSON.parse(e.contents)),void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===Ke.Go.NoOp&&this.noOpCount--;const t=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=t,this.noOpCount<0)throw new Error("gap in client sequence number: ".concat(t));this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw new Re.EW("Found a lower minimumSequenceNumber (msn) than previously recorded",{...(0,Re.ds)(e),clientId:this.connectionManager.clientId});const n=e.sequenceNumber-e.minimumSequenceNumber;if(n<0||0===n&&null!==e.clientId)throw new Re.EW("MSN has to be lower than sequence #",(0,Re.ds)(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Re.EW("Found a non-Sequential sequenceNumber",{...(0,Re.ds)(e),clientId:this.connectionManager.clientId});if(this.lastProcessedSequenceNumber=e.sequenceNumber,(0,Se.v)(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const o=Date.now();this.emit("op",e,o-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch((e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)}))}async fetchMissingDeltasCore(e,t,r){if(void 0===this.fetchReason)if(this._closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{var n;let o=this.lastQueuedSequenceNumber+1;const i=null===(n=this.previouslyProcessedMessage)||void 0===n?void 0:n.sequenceNumber;void 0!==i&&((0,Se.v)(i===this.lastQueuedSequenceNumber,242),(0,Se.v)(o>1,243),o--);const s="".concat(e,"_fetch");this.fetchReason=s,await this.getDeltas(o,r,s,(e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,s)}),t)}catch(vt){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},vt),this.close((0,we.cQ)(vt))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else(0,Se.v)(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this._closed)return;(0,Se.v)(void 0!==this.handler,620);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.pending=[],this.enqueueMessages(t,"".concat(e,"_pending"),!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}const ft="2.0.0-rc.1.0.8";var vt=r(27939);class yt{constructor(e,t){this.internalStorageService=e,this.addProtocolSummaryIfMissing=t,this.getSnapshotTree=this.internalStorageService.getSnapshotTree.bind(this.internalStorageService),this.getVersions=this.internalStorageService.getVersions.bind(this.internalStorageService),this.createBlob=this.internalStorageService.createBlob.bind(this.internalStorageService),this.readBlob=this.internalStorageService.readBlob.bind(this.internalStorageService),this.downloadSummary=this.internalStorageService.downloadSummary.bind(this.internalStorageService),this.dispose=this.internalStorageService.dispose.bind(this.internalStorageService)}get policies(){return this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(e),t)}}class bt{constructor(e,t){this.internalStorageServiceP=e,this.logger=t,this._disposed=!1,this.internalStorageServiceP.then((e=>this.internalStorageService=e)).catch((()=>{}))}get policies(){if(this.internalStorageService)return this.internalStorageService.policies;throw new Error("storage service not yet instantiated")}get disposed(){return this._disposed}dispose(){this._disposed=!0}get repositoryUrl(){if(this.internalStorageService)return this.internalStorageService.repositoryUrl;throw new Error("storage service not yet instantiated")}async getSnapshotTree(e,t){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async r=>r.getSnapshotTree(e,t)))),"storage_getSnapshotTree")}async readBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.readBlob(e)))),"storage_readBlob")}async getVersions(e,t,r,n){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async o=>o.getVersions(e,t,r,n)))),"storage_getVersions")}async uploadSummaryWithContext(e,t){return(0,Se.v)(0===t.referenceSequenceNumber===(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageServiceP.then((async r=>r.uploadSummaryWithContext(e,t))):this.runWithRetry((async()=>this.internalStorageServiceP.then((async r=>r.uploadSummaryWithContext(e,t)))),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.downloadSummary(e)))),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.createBlob(e)))),"storage_createBlob")}checkStorageDisposed(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:"".concat(e,"_abortedStorageDisposed"),fetchCallName:e},t),new Re.gn("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return(0,qe.M)(e,t,this.logger,{onRetry:(e,r)=>this.checkStorageDisposed(t,r)})}}class St{get summarizeProtocolTree(){return!0===this._summarizeProtocolTree}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.logger=t,this.blobContents=r,this.addProtocolSummaryIfMissing=n,this.disposed=!1,this._storageService=new Ct(e,t),this._summarizeProtocolTree=o}dispose(e){var t,r;null===(t=this._storageService)||void 0===t||null===(r=t.dispose)||void 0===r||r.call(t,e),this.disposed=!0}connectToService(e){var t,r;if(!(this._storageService instanceof Ct))return;const n=e.connectToStorage(),o=this._storageService=new bt(n,this.logger);this._summarizeProtocolTree=null!==(t=this._summarizeProtocolTree)&&void 0!==t?t:null===(r=e.policies)||void 0===r?void 0:r.summarizeProtocolTree,this.summarizeProtocolTree&&(this.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this._storageService=new yt(o,this.addProtocolSummaryIfMissing))}loadSnapshotForRehydratingContainer(e){this.getBlobContents(e)}getBlobContents(e){if(void 0!==e.blobsContents)for(const[r,n]of Object.entries(null!==(t=e.blobsContents)&&void 0!==t?t:{})){var t;this.blobContents[r]=n}for(const[r,n]of Object.entries(e.trees))this.getBlobContents(n)}get policies(){try{return this._storageService.policies}catch(e){}}get repositoryUrl(){return this._storageService.repositoryUrl}async getSnapshotTree(e,t){return this._storageService.getSnapshotTree(e,t)}async readBlob(e){const t=this.blobContents[e];if(void 0!==t){if("string"===typeof t){return(0,ye.Xg)(t,"utf8")}return t}return this._storageService.readBlob(e)}async getVersions(e,t,r,n){return this._storageService.getVersions(e,t,r,n)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this._storageService.downloadSummary(e)}async createBlob(e){return this._storageService.createBlob(e)}}class Ct{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}async createBlob(e){return this.verifyStorage().createBlob(e)}async readBlob(e){return this.verifyStorage().readBlob(e)}verifyStorage(){if(void 0===this.detachedStorage)throw new vt.e("Real storage calls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}get repositoryUrl(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const kt=".blobs",wt=".redirectTable";async function Pt(e,t){const r={};return await Et(e,r,t),r}async function Et(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=[];for(const[i,s]of Object.entries(e.trees))n&&i===kt?o.push(Tt(s,t,r)):o.push(Et(s,t,r,!1));for(const i of Object.values(e.blobs)){const e=await r.readBlob(i);t[i]=(0,ye.JR)(e,"utf8")}return Promise.all(o)}async function Tt(e,t,r){const n=e.blobs[wt],o=await r.readBlob(n);t[n]=(0,ye.JR)(o,"utf8")}function It(e){const t={};return Nt(e,t),t}function Nt(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];for(const[o,i]of Object.entries(e.trees))r&&o===kt?Ft(i,t):Nt(i,t,!1);for(const o of Object.values(e.blobs)){var n;const r=null===(n=e.blobsContents)||void 0===n?void 0:n[o];(0,Se.v)(void 0!==r,748),t[o]=(0,ye.JR)(r,"utf8")}}function Ft(e,t){var r;const n=e.blobs[wt],o=null===(r=e.blobsContents)||void 0===r?void 0:r[n];(0,Se.v)(void 0!==o,1807),t[n]=(0,ye.JR)(o,"utf8")}var Dt=r(6501);class Ot{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this.disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,(0,Se.v)(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}dispose(){this.disposed||(this.disposed=!0,this.deltaManager.off("op",this.opHandler))}}function Bt(e,t,r){const n=(0,Ae.Ln)(e.logger);return function(e,t,r,n,o){if(!e)return new At(r,t,o);return new Lt(r,(e=>new At(e,t,o)),n)}(!0===n.config.getBoolean("Fluid.Container.CatchUpBeforeDeclaringConnected"),!0===n.config.getBoolean("Fluid.Container.EnableJoinSignalWait"),e,t,r)}class xt{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){return this.pimpl.receivedDisconnectEvent(e)}establishingConnection(e){return this.pimpl.establishingConnection(e)}cancelEstablishingConnection(e){return this.pimpl.cancelEstablishingConnection(e)}receivedConnectEvent(e){return this.pimpl.receivedConnectEvent(e)}get logger(){return this.inputs.logger}connectionStateChanged(e,t,r){return this.inputs.connectionStateChanged(e,t,r)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t,r){return this.inputs.logConnectionIssue(e,t,r)}clientShouldHaveLeft(e){return this.inputs.clientShouldHaveLeft(e)}}class Lt extends xt{constructor(e,t,r){super(e,t),this.deltaManager=r,this.transitionToConnectedState=()=>{const e=this.pimpl.connectionState;(0,Se.v)(e===ee.Connected,997),(0,Se.v)(this._connectionState===ee.CatchingUp,998),this._connectionState=ee.Connected,this.inputs.connectionStateChanged(ee.Connected,ee.CatchingUp,{text:"caught up"})},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,r){var n;switch(e){case ee.Connected:return(0,Se.v)(this._connectionState===ee.CatchingUp,993),(0,Se.v)(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new Ot(this.deltaManager,this.transitionToConnectedState));case ee.Disconnected:null===(n=this.catchUpMonitor)||void 0===n||n.dispose(),this.catchUpMonitor=void 0;break;case ee.EstablishingConnection:(0,Se.v)(this._connectionState===ee.Disconnected,1746);break;case ee.CatchingUp:(0,Se.v)(this._connectionState===ee.EstablishingConnection,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,r)}}class At{get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}constructor(e,t,r){var n;this.handler=e,this.readClientsWaitForJoinSignal=t,this._connectionState=ee.Disconnected,this._clientId=r,this.prevClientLeftTimer=new Dt.M4(null!==(n=this.handler.maxClientLeaveWaitTime)&&void 0!==n?n:3e5,(()=>{(0,Se.v)(this.connectionState!==ee.Connected,684),this.applyForConnectedState("timeout")})),this.joinOpTimer=new Dt.M4(0,(()=>{if(this.connectionState!==ee.CatchingUp)return;const e={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("NoJoinOp","error",e)}))}startJoinOpTimer(){(0,Se.v)(!this.joinOpTimer.hasTimer,564),(0,Se.v)(void 0!==this.connection,1203),this.joinOpTimer.start("write"===this.connection.mode?45e3:5e3)}stopJoinOpTimer(){(0,Se.v)(this.joinOpTimer.hasTimer,565),this.joinOpTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){(0,Se.v)(!this.joinOpTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId?(this.joinOpTimer.hasTimer?this.stopJoinOpTimer():this.shouldWaitForJoinSignal()&&this.handler.logConnectionIssue("ReceivedJoinOp","generic"),this.waitingForLeaveOp&&(this.waitEvent=D.Bt.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent")):e===this.clientId&&((0,Se.v)(!this.waitingForLeaveOp,1490),(0,Se.v)(this.connectionState!==ee.Connected,1491),this.prevClientLeftTimer.restart())}applyForConnectedState(e){if((0,Se.v)(void 0!==this.protocol,566),(0,Se.v)(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp){var t;null===(t=this.waitEvent)||void 0===t||t.end({source:e}),this.setConnectionState(ee.Connected)}else{const t="timeout"===e&&this.connectionState!==ee.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:t?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}receivedRemoveMemberEvent(e){this.clientId===e&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.connection=void 0,this.setConnectionState(ee.Disconnected,e)}cancelEstablishingConnection(e){(0,Se.v)(this._connectionState===ee.EstablishingConnection,1747),(0,Se.v)(void 0===this.connection,1748);const t=this._connectionState;this._connectionState=ee.Disconnected,this.handler.connectionStateChanged(ee.Disconnected,t,e)}establishingConnection(e){const t=this._connectionState;this._connectionState=ee.EstablishingConnection,this.handler.connectionStateChanged(ee.EstablishingConnection,t,{text:"Establishing Connection due to ".concat(e.text),error:e.error})}shouldWaitForJoinSignal(){return(0,Se.v)(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}receivedConnectEvent(e){this.connection=e;const t=this._connectionState;this._connectionState=ee.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(ee.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForJoinSignal()?this.startJoinOpTimer():this.waitingForLeaveOp||this.setConnectionState(ee.Connected)}setConnectionState(e,t){var r;if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const n=this._connectionState;this._connectionState=e;const o=void 0!==this._clientId&&void 0!==(null===(r=this.protocol)||void 0===r||null===(r=r.quorum)||void 0===r?void 0:r.getMember(this._clientId));e===ee.Connected?((0,Se.v)(n===ee.CatchingUp,472),o&&this.handler.clientShouldHaveLeft(this._clientId),this._clientId=this.pendingClientId):e===ee.Disconnected&&(this._pendingClientId=void 0,this.joinOpTimer.hasTimer&&this.stopJoinOpTimer(),o&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:o,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,n,t)}get membership(){var e,t;return this.readClientsWaitForJoinSignal?null===(e=this.protocol)||void 0===e?void 0:e.audience:null===(t=this.protocol)||void 0===t?void 0:t.quorum}initProtocol(e){var t,r;this.protocol=e,null===(t=this.membership)||void 0===t||t.on("addMember",((t,r)=>{(0,Se.v)("read"===r.mode||void 0!==e.quorum.getMember(t),1205),this.receivedAddMemberEvent(t)})),null===(r=this.membership)||void 0===r||r.on("removeMember",(t=>{(0,Se.v)(void 0===e.quorum.getMember(t),1206),this.receivedRemoveMemberEvent(t)})),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),void 0!==this.clientId&&this.hasMember(this.clientId)&&this.prevClientLeftTimer.restart()}hasMember(e){var t;return void 0!==(null===(t=this.membership)||void 0===t?void 0:t.getMember(null!==e&&void 0!==e?e:""))}}class Rt extends _e.X{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;super(),this.NoopCountFrequency=t,this.opsProcessedSinceOpSent=0,e!==1/0&&(this.timer=new Dt.M4(e,(()=>{0!==this.opsProcessedSinceOpSent&&this.emit("wantsNoop")})))}notifyMessageProcessed(e){(0,We.Wz)(e)&&(this.opsProcessedSinceOpSent++,this.opsProcessedSinceOpSent===this.NoopCountFrequency&&queueMicrotask((()=>{this.opsProcessedSinceOpSent>=this.NoopCountFrequency&&(this.emit("wantsNoop"),(0,Se.v)(0===this.opsProcessedSinceOpSent,579))})),void 0!==this.timer&&(1===this.opsProcessedSinceOpSent&&this.timer.restart(),(0,Se.v)(this.timer.hasTimer,578)))}notifyDisconnect(){this.opsProcessedSinceOpSent=0}notifyMessageSent(){this.opsProcessedSinceOpSent=0}}var Mt=r(11158),_t=r(39613);class zt extends ie.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}var Ht,Ut=r(98504);class jt{constructor(e,t,r,n){this.sequenceNumber=e,this.key=t,this.value=r,this.local=n}}class qt extends zt{constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}get disposed(){return this.isDisposed}snapshot(){var e;return null!==(e=this.snapshotCache)&&void 0!==e||(this.snapshotCache=Array.from(this.members)),this.snapshotCache}addMember(e,t){(0,Ut.v)(!!e,1135),(0,Ut.v)(!this.members.has(e),462),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){(0,Ut.v)(!!e,1136),(0,Ut.v)(this.members.has(e),463),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class Vt extends zt{constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new ie.EventEmitter,this.proposals=new Map(e.proposals.map((e=>{let[,t]=e;return[t.sequenceNumber,new jt(t.sequenceNumber,t.key,t.value,!1)]}))),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}get disposed(){return this.isDisposed}snapshot(){var e,t;return null!==(e=this.proposalsSnapshotCache)&&void 0!==e||(this.proposalsSnapshotCache=Array.from(this.proposals).map((e=>{let[t,r]=e;return[t,{sequenceNumber:t,key:r.key,value:r.value},[]]}))),null!==(t=this.valuesSnapshotCache)&&void 0!==t||(this.valuesSnapshotCache=Array.from(this.values)),{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){var t;return null===(t=this.values.get(e))||void 0===t?void 0:t.value}getApprovalData(e){return this.values.get(e)}async propose(e,t){const r=this.sendProposal(e,t);if(r<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise(((e,t)=>{let n;const o=(e,t)=>{e===r&&(n=t,this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===n&&(e(),c())},s=()=>{void 0===n&&this.stateEvents.once("connected",(()=>{void 0===n&&(t(new Error("Client disconnected without successfully sending proposal")),c())}))},a=()=>{t(new Error("QuorumProposals was disposed")),c()},c=()=>{this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",o),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)}))}addProposal(e,t,r,n,o){(0,Ut.v)(!this.proposals.has(r),464);const i=new jt(r,e,t,n);this.proposals.set(r,i),this.emit("addProposal",i),n&&this.stateEvents.emit("localProposalSequenced",o,r),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber,r=[];for(const[n,o]of this.proposals)n<=t&&r.push(o);r.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));for(const n of r){const t={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:n.key,sequenceNumber:n.sequenceNumber,value:n.value};this.values.set(t.key,t),this.valuesSnapshotCache=void 0;let r=!1,o=!1;for(const[,e]of this.proposals)if(e.key===t.key){if(o){r=!1;break}r=!0,o=!0}this.emit("approveProposal",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),r&&this.emit("approveProposalComplete",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),this.proposals.delete(n.sequenceNumber),this.proposalsSnapshotCache=void 0,n.local&&this.stateEvents.emit("localProposalApproved",n.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}class Gt extends zt{constructor(e,t,r,n){super(),this.isDisposed=!1,this.quorumClients=new qt(e),this.quorumClients.on("addMember",((e,t)=>{this.emit("addMember",e,t)})),this.quorumClients.on("removeMember",(e=>{this.emit("removeMember",e)})),this.quorumProposals=new Vt({proposals:t,values:r},n),this.quorumProposals.on("addProposal",(e=>{this.emit("addProposal",e)})),this.quorumProposals.on("approveProposal",((e,t,r,n)=>{this.emit("approveProposal",e,t,r,n)}))}get disposed(){return this.isDisposed}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:r}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:r}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}getApprovalData(e){return this.quorumProposals.getApprovalData(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}async propose(e,t){return this.quorumProposals.propose(e,t)}addProposal(e,t,r,n,o){return this.quorumProposals.addProposal(e,t,r,n,o)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class Wt{constructor(e,t,r,n,o,i){this.minimumSequenceNumber=e,this.sequenceNumber=t,this._quorum=new Gt(r,n,o,i)}get quorum(){return this._quorum}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error("Protocol state is not moving sequentially. "+"Current is ".concat(this.sequenceNumber,". Next is ").concat(e.sequenceNumber));this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let r=!1;switch(e.type){case Ke.Go.ClientJoin:const n=e,o=JSON.parse(n.data),i={client:o.detail,sequenceNumber:n.sequenceNumber};this._quorum.addMember(o.clientId,i);break;case Ke.Go.ClientLeave:const s=e,a=JSON.parse(s.data);this._quorum.removeMember(a);break;case Ke.Go.Propose:"string"===typeof e.contents&&(e.contents=JSON.parse(e.contents));const c=e.contents;this._quorum.addProposal(c.key,c.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}getProtocolState(){const e=this._quorum.snapshot().members;return e.forEach((e=>{e[1]={...e[1],client:{...e[1].client,user:{id:""}}}})),{sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber,...this._quorum.snapshot(),members:e}}}!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(Ht||(Ht={}));class Kt extends Wt{constructor(e,t,r,n,o){super(e.minimumSequenceNumber,e.sequenceNumber,t.members,t.proposals,t.values,r),this.audience=n,this.shouldClientHaveLeft=o,this.quorum.on("addMember",((e,t)=>n.addMember(e,t.client))),this.quorum.on("removeMember",(e=>n.removeMember(e)));for(const[i,s]of this.quorum.getMembers())this.audience.addMember(i,s.client)}processMessage(e,t){if(null!=e.clientId){if(void 0===this.quorum.getMember(e.clientId)&&e.type!==Ke.Go.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(this.shouldClientHaveLeft(e.clientId)&&!(0,We.DW)(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case Ht.Clear:{const e=this.audience.getMembers();for(const[t,r]of e)"read"===r.mode&&this.audience.removeMember(t);break}case Ht.ClientJoin:{const e=t.content;"read"===e.client.mode&&this.audience.addMember(e.clientId,e.client);break}case Ht.ClientLeave:{var r;const e=t.content;"read"===(null===(r=this.audience.getMember(e))||void 0===r?void 0:r.mode)&&this.audience.removeMember(e);break}}}}const Jt={fatalConnectError:!0};const Qt={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},Xt="storage-only client";class Zt extends _e.X{constructor(e,t){super(),this.storageOnlyReason=e,this.readonlyConnectionReason=t,this.clientId=Xt,this.claims={scopes:[_t.h.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[{client:Qt,clientId:Xt}],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map((e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}}))))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}function $t(e){return e instanceof Zt}const Yt=async()=>{var e;if(!1===(null===(e=globalThis.navigator)||void 0===e?void 0:e.onLine)&&void 0!==globalThis.addEventListener)return new Promise((e=>{const t=()=>{e(),globalThis.removeEventListener("online",t)};globalThis.addEventListener("online",t)}))};class er{get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){var e,t;return null!==(e=null===(t=this.connection)||void 0===t?void 0:t.mode)&&void 0!==e?e:"read"}get connected(){return void 0!==this.connection}get clientId(){var e;return null===(e=this.connection)||void 0===e?void 0:e.clientId}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){var e,t;return null!==(e=null===(t=this.connection)||void 0===t||null===(t=t.serviceConfiguration)||void 0===t?void 0:t.maxMessageSize)&&void 0!==e?e:16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){var e;return null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration}get scopes(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0!==this.connection?this._connectionProps:{...this._connectionProps,sentOps:this.clientSequenceNumber}}shouldJoinWrite(){const e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}get readonly(){return this.readOnlyInfo.readonly}get readOnlyInfo(){let e,t=!1;return $t(this.connection)&&(t=!0,e=this.connection.storageOnlyReason),t||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:t,storageOnlyReason:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}constructor(e,t,r,n,o,i){this.serviceProvider=e,this.containerDirty=t,this.client=r,this.logger=o,this.props=i,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=(e,t)=>{const r=Array.isArray(t)?t:[t];this.props.incomingOpHandler(r,"opHandler")},this.signalHandler=e=>{const t=Array.isArray(e)?e:[e];this.props.signalHandler(t)},this.nackHandler=(e,t)=>{const r=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler((0,Ge.Of)("writeOnReadOnlyDocument",{driverVersion:void 0}));const n=function(e){const t="Nack (".concat(e.type,"): ").concat(e.message),r=403!==e.code,n=void 0!==e.retryAfter?1e3*e.retryAfter:void 0;return(0,Ge.ix)(t,{canRetry:r,retryAfterMs:n},{statusCode:e.code,driverVersion:void 0})}(r.content);n.canRetry?this.reconnectOnError("write",n):this.props.closeHandler(n)},this.disconnectHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=n?at.Enabled:at.Never,this._outbound=new dt((e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)})),this._outbound.on("error",(e=>{this.props.closeHandler((0,we.cQ)(e))}))}dispose(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._disposed)return;this._disposed=!0,this._reconnectMode=at.Never,this._outbound.clear();const r={text:"Closing DeltaManager",error:e},n=this.readonly;this.disconnectFromDeltaStream(r),t&&this.set_readonlyPermissions(!0,n,r)}setAutoReconnect(e,t){(0,Se.v)(e!==at.Never&&this._reconnectMode!==at.Never,632),this._reconnectMode=e,e!==at.Enabled&&this.disconnectFromDeltaStream(t)}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===at.Never)throw new Re.eb("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream({text:"Force readonly"})),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect({text:"Force Readonly"},"read")}}set_readonlyPermissions(e,t,r){this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly,r)}connect(e,t){this.connectCore(e,t).catch((e=>{const t=(0,we.cQ)(e,{props:Jt});this.props.closeHandler(t)}))}async connectCore(e,t){var r,n;if((0,Se.v)(!this._disposed,618),void 0!==this.connection)return;let o;void 0!==this.pendingConnection&&(o=this.pendingConnection.connectionMode,this.cancelConnection(e),(0,Se.v)(void 0===this.pendingConnection,836));let i=null!==(r=null!==t&&void 0!==t?t:o)&&void 0!==r?r:this.defaultReconnectionMode;this.shouldJoinWrite()&&(i="write");const s=this.serviceProvider();let a;if((0,Se.v)(void 0!==s,679),!0===(null===(n=s.policies)||void 0===n?void 0:n.storageOnly))return a=new Zt,this.setupNewSuccessfulConnection(a,"read",e),void(0,Se.v)(void 0===this.pendingConnection,691);let c=500,l=0;const d=Me.F.now();let u;const h=new AbortController,g=h.signal;for(this.pendingConnection={abort:()=>{h.abort()},connectionMode:i},this.props.establishConnectionHandler(e);void 0===a;){if(this._disposed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===g.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:(0,D.T0)(Me.F.now()-d),connectionEstablished:!1});l++;try{this.client.mode=i,a=await s.connectToDeltaStream({...this.client,mode:i}),a.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),a=void 0),this.logger.sendTelemetryEvent({eventName:"ConnectionReceived",connected:void 0!==a&&!1===a.disposed},void 0,ze)}catch(m){var p;if(this.logger.sendTelemetryEvent({eventName:"ConnectToDeltaStreamException",connected:void 0!==a&&!1===a.disposed},void 0,ze),Oe(m)){a=new Zt(m.storageOnlyReason,{text:m.message,error:m}),i="read";break}if((0,ct.Xy)(m)&&m.errorType===F.outOfStorageError){a=new Zt(void 0,{text:m.message,error:m}),i="read";break}if(!(0,Ge.YU)(m)){const e=(0,we.cQ)(m,{props:Jt});throw this.props.closeHandler(e),e}(0,Mt.f)(this.logger,{attempts:l,delay:c,eventName:"DeltaConnectionFailureToConnect",duration:(0,D.T0)(Me.F.now()-d)},m),u=m;const e=Me.F.now(),t=(0,Ge.E9)(m);void 0===t&&!1===(null===(p=globalThis.navigator)||void 0===p?void 0:p.onLine)||(c=(0,qe.F)(c,m)),void 0!==t&&this.props.reconnectionDelayHandler(c,m),await new Promise((e=>{setTimeout(e,c)})),await Yt(),this.logger.sendPerformanceEvent({eventName:"WaitBetweenConnectionAttempts",duration:Me.F.now()-e,details:JSON.stringify({retryDelayFromError:t,delayMs:c})})}}if(l>1&&(0,Mt.f)(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:l,duration:(0,D.T0)(Me.F.now()-d)},u),!0===g.aborted||this._disposed)return a.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:l,duration:(0,D.T0)(Me.F.now()-d),connectionEstablished:!0});this.setupNewSuccessfulConnection(a,i,e)}triggerConnect(e,t){this.reconnectMode===at.Enabled&&this.connect(e,t)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(e),!0);(0,Se.v)(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),t.dispose(),this.props.disconnectHandler(e),this._connectionVerboseProps={},!0}cancelConnection(e){(0,Se.v)(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived"}),this.props.cancelConnectionHandler({text:"Cancel Pending Connection due to ".concat(e.text),error:e.error})}setupNewSuccessfulConnection(e,t,r){var n;(0,Se.v)(void 0===this.connection,230),(0,Se.v)(!e.disposed,650),this.pendingConnection=void 0;const o=this.readonly;this.connection=e;const i=!e.claims.scopes.includes(_t.h.DocWrite);if(e.mode!==t&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:t,mode:e.mode}),(0,Se.v)("read"===t||i===("read"===this.connectionMode),231),(0,Se.v)(!i||"read"===this.connectionMode,232),this.set_readonlyPermissions(i,o,$t(e)?e.readonlyConnectionReason:void 0),this._disposed)return void this.disconnectFromDeltaStream({text:"ConnectionManager already closed"});this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const s=e.initialMessages.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));let a=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let c=-1;0!==s.length&&(this._connectionVerboseProps.connectionInitialOpsFrom=s[0].sequenceNumber,c=s[s.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=c+1,(void 0===a||a<c)&&(a=c)),this.props.incomingOpHandler(s,this.connectFirstConnection?"InitialOps":"ReconnectOps");const l=er.detailsFromConnection(e,r);l.checkpointSequenceNumber=a,this.props.connectHandler(l),this.connectFirstConnection=!1;let d=[{clientId:null,content:JSON.stringify({type:Ht.Clear})}];const u=(null!==(n=e.initialClients)&&void 0!==n?n:[]).map((e=>({clientId:null,content:JSON.stringify({type:Ht.ClientJoin,content:e})})));u.length>0&&(d=d.concat(u)),void 0!==e.initialSignals&&e.initialSignals.length>0&&(d=d.concat(e.initialSignals)),this.props.signalHandler(d)}reconnectOnError(e,t){this.reconnect(e,{text:t.message,error:t}).catch(this.props.closeHandler)}async reconnect(e,t){var r;if((0,Se.v)(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),!1===(null===(r=t.error)||void 0===r?void 0:r.canRetry)&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},t.error),this.reconnectMode===at.Never&&this.props.closeHandler(),this._disposed||this.reconnectMode!==at.Enabled)return;const n=(0,Ge.E9)(t.error);void 0!==t.error&&void 0!==n&&(this.props.reconnectionDelayHandler(n,t.error),await new Promise((e=>{setTimeout(e,n)}))),await Yt(),this.triggerConnect({text:void 0!==t.error?"Reconnecting due to Error":"Reconnecting due to: ".concat(t.text),error:t.error},e)}prepareMessageToSend(e){var t;if(!0!==this.readonly){var r;if((0,Se.v)(!!this.connection,228),this.lastSubmittedClientId!==(null===(t=this.connection)||void 0===t?void 0:t.clientId))this.lastSubmittedClientId=null===(r=this.connection)||void 0===r?void 0:r.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0;return(0,We.Wz)(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,{...e,clientSequenceNumber:++this.clientSequenceNumber}}{(0,Se.v)(!0===this.readOnlyInfo.readonly,496);const e=new Re.gn("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly,storageOnlyReason:this.readOnlyInfo.storageOnlyReason});this.props.closeHandler(e)}}submitSignal(e,t){void 0!==this.connection?this.connection.submitSignal(e,t):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}sendMessages(e){(0,Se.v)(this.connected,692),"read"!==this.connectionMode?((0,Se.v)(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then((async()=>{this.pendingReconnect&&await this.reconnect("write",{text:"Switch to write"})})).catch((()=>{})))}beforeProcessingIncomingOp(e){if((0,Se.v)(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;(0,Se.v)(this.clientSequenceNumberObserved<t,239),(0,Se.v)(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}if(e.type===Ke.Go.ClientLeave){const t=e;JSON.parse(t.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read",{text:"Switch to read"}).catch((e=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)})))}}}const tr="saved",rr=".hasAttachmentBlobs";const nr="summarizer";class or extends Qe.o{static async load(e,t){const{version:r,pendingLocalState:n,loadMode:o,resolvedUrl:i,loadToSequenceNumber:s}=e,a=new or(t,e),c=a.mc.config.getBoolean("Fluid.Loader.DisableRecordHeapSize");return D.Bt.timedExecAsync(a.mc.logger,{eventName:"Load"},(async e=>new Promise(((t,c)=>{const l={opsBeforeReturn:"cached"},d=n?{...null!==o&&void 0!==o?o:l,opsBeforeReturn:void 0}:null!==o&&void 0!==o?o:l,u=e=>{c(null!==e&&void 0!==e?e:new Re.gn("Container closed without error during load"))};a.on("closed",u),a.load(r,d,i,n,s).finally((()=>{a.removeListener("closed",u)})).then((r=>{e.end({...r,...o}),t(a)}),(e=>{const t=(0,we.cQ)(e);a.close(t),a.dispose(t),u(t)}))}))),{start:!0,end:!0,cancel:"generic"},!0!==c)}static async createDetached(e,t){const r=new or(e);return D.Bt.timedExecAsync(r.mc.logger,{eventName:"CreateDetached"},(async e=>(await r.createDetached(t),r)),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t){const r=new or(e);return D.Bt.timedExecAsync(r.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},(async e=>{const n=JSON.parse(t);if(!(0,Pe.ub)(n,rr))throw new Re.eb("Cannot rehydrate detached container. Incorrect format");return await r.rehydrateDetachedFromSnapshot(n),r}),{start:!0,end:!0,cancel:"generic"})}setLoaded(){"loading"===this._lifecycleState&&(this.propagateConnectionState(!0),this._lifecycleState="loaded")}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||this.disposed}get disposed(){return"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get resolvedUrl(){var e;return null===(e=this.service)||void 0===e?void 0:e.resolvedUrl}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}forceReadonly(e){this._deltaManager.connectionManager.forceReadonly(e)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===ee.Connected}get clientId(){return this._clientId}get offlineLoadEnabled(){var e,t;return(null!==(e=this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))&&void 0!==e?e:!0===(null===(t=this.options)||void 0===t?void 0:t.enableOfflineLoad))&&this.deltaManager.clientDetails.capabilities.interactive}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){return this._loadedCodeDetails}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}async getEntryPoint(){if(this._disposed)throw new Re.eb("The context is already disposed");var e,t;return void 0!==this._runtime?null===(e=(t=this._runtime).getEntryPoint)||void 0===e?void 0:e.call(t):new Promise(((e,t)=>{const r=()=>{var t,r;(0,Se.v)(void 0!==this._runtime,1443),e(null===(t=(r=this._runtime).getEntryPoint)||void 0===t?void 0:t.call(r)),this._lifecycleEvents.off("disposed",n)},n=()=>{t(new Error("ContainerContext was disposed")),this._lifecycleEvents.off("runtimeInstantiated",r)};this._lifecycleEvents.once("runtimeInstantiated",r),this._lifecycleEvents.once("disposed",n)}))}constructor(e,t){var r;super(((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"===typeof e?e:void 0},t)})),this._lifecycleState="loading",this._attachState=He.Detached,this.inboundQueuePausedFromInit=!0,this.firstConnection=!0,this.connectionTransitionTimes=[],this.attachStarted=!1,this._dirtyContainer=!1,this.savedOps=[],this.clientsWhoShouldHaveLeft=new Set,this.setAutoReconnectTime=Me.F.now(),this._lifecycleEvents=new _e.X,this._disposed=!1,this.getAbsoluteUrl=async e=>{if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,(e=>{let t;return t=e&&"name"in e?e:Ue(null===e||void 0===e?void 0:e.package)?null===e||void 0===e?void 0:e.package.name:null===e||void 0===e?void 0:e.package,{name:t}})(this._loadedCodeDetails))},this.updateDirtyContainerState=e=>{this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":tr))};const{canReconnect:n,clientDetailsOverride:o,urlResolver:i,documentServiceFactory:s,codeLoader:a,options:c,scope:l,subLogger:d,detachedBlobStorage:u,protocolHandlerBuilder:h}=e;this.connectionTransitionTimes[ee.Disconnected]=Me.F.now();const g=null===t||void 0===t?void 0:t.pendingLocalState;this._clientId=null===g||void 0===g?void 0:g.clientId,this._canReconnect=null===n||void 0===n||n,this.clientDetailsOverride=o,this.urlResolver=i,this.serviceFactory=s,this.codeLoader=a,this.options={...c},this.scope=l,this.detachedBlobStorage=u,this.protocolHandlerBuilder=null!==h&&void 0!==h?h:(e,t,r)=>new Kt(e,t,r,new it,(e=>this.clientsWhoShouldHaveLeft.has(e))),this.clone=async(t,r)=>or.load(t,{...e,...r}),this._containerId=ve(),this.client=or.setupClient(this._containerId,this.options,this.clientDetailsOverride);const p=this.client.details.type,m=this.client.details.capabilities.interactive,f="".concat(m?"interactive":"noninteractive").concat(void 0!==p&&""!==p?"/".concat(p):"");this.subLogger=(0,D.pW)({logger:d,properties:{all:{clientType:f,containerId:this._containerId,docId:()=>{var e;return null===(e=this.resolvedUrl)||void 0===e?void 0:e.id},containerAttachState:()=>this._attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>ee[this.connectionState],serializedContainer:void 0!==g},error:{dmInitialSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.initialSequenceNumber},dmLastProcessedSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastSequenceNumber},dmLastKnownSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastKnownSeqNumber},containerLoadedFromVersionId:()=>{var e;return null===(e=this._loadedFromVersion)||void 0===e?void 0:e.id},containerLoadedFromVersionDate:()=>{var e;return null===(e=this._loadedFromVersion)||void 0===e?void 0:e.date},dmLastMsqSeqNumber:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.sequenceNumber},dmLastMsqSeqTimestamp:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.timestamp},dmLastMsqSeqClientId:()=>{var e,t;return null===(null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.clientId)?"null":null===(t=this.deltaManager)||void 0===t||null===(t=t.lastMessage)||void 0===t?void 0:t.clientId},dmLastMsgClientSeq:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.clientSequenceNumber},connectionStateDuration:()=>Me.F.now()-this.connectionTransitionTimes[this.connectionState]}}}),this.mc=(0,Ae.CL)({logger:this.subLogger,namespace:"Container"}),this._deltaManager=this.createDeltaManager(),this.connectionStateHandler=Bt({logger:this.mc.logger,connectionStateChanged:(e,t,r)=>{e===ee.Connected&&(this._clientId=this.connectionStateHandler.pendingClientId),this.logConnectionStateChangeTelemetry(e,t,r),"loaded"===this._lifecycleState&&this.propagateConnectionState(!1,e===ee.Disconnected?r:void 0)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:c.maxClientLeaveWaitTime,logConnectionIssue:(e,t,r)=>{const n=this.connectionMode;if(this._deltaManager.logConnectionIssue({eventName:e,mode:n,category:"loading"===this._lifecycleState?"generic":t,duration:Me.F.now()-this.connectionTransitionTimes[ee.CatchingUp],...void 0===r?{}:{details:JSON.stringify(r)}}),"read"===n){const e={text:"NoJoinSignal"};this.disconnectInternal(e),this.connectInternal({reason:e,fetchOpsFromStorage:!1})}},clientShouldHaveLeft:e=>{this.clientsWhoShouldHaveLeft.add(e)}},this.deltaManager,null===g||void 0===g?void 0:g.clientId),this.on(tr,(()=>{this.connectionStateHandler.containerSaved()}));const v=null!==(r=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2"))&&void 0!==r?r:c.summarizeProtocolTree;this.storageAdapter=new St(u,this.mc.logger,null===g||void 0===g?void 0:g.snapshotBlobs,(e=>!0===(0,Pe.ub)(e)?e:Te(e,this.captureProtocolSummary())),v);"object"===typeof document&&null!==document&&"function"===typeof document.addEventListener&&null!==document.addEventListener&&m&&(this.lastVisible=document.hidden?Me.F.now():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=Me.F.now():setTimeout((()=>{this.lastVisible=void 0}),0)},document.addEventListener("visibilitychange",this.visibilityEventHandler))}getQuorum(){return this.protocolHandler.quorum}dispose(e){this._deltaManager.dispose(e),this.verifyClosed()}close(e){this._deltaManager.close(e),this.verifyClosed()}verifyClosed(){(0,Se.v)(this.connectionState===ee.Disconnected,207),(0,Se.v)("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788)}closeCore(e){(0,Se.v)(!this.closed,789);try{try{var t;this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose()}catch(r){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},r)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed",this.client.details.type===nr&&this.dispose(e)}}disposeCore(e){(0,Se.v)(!this._disposed,1356),this._disposed=!0;try{try{var t,r,n;this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:this.closed||void 0===e?"generic":"error"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose();const o=void 0!==e?new Error(e.message):void 0;null===(r=this._runtime)||void 0===r||r.dispose(o),this.storageAdapter.dispose(),null===(n=this.service)||void 0===n||n.dispose(e)}catch(o){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},o)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed",this._lifecycleEvents.emit("disposed")}}async closeAndGetPendingLocalState(e){const t=await this.getPendingLocalStateCore({notifyImminentClosure:!0,stopBlobAttachingSignal:e});return this.close(),t}async getPendingLocalState(){return this.getPendingLocalStateCore({notifyImminentClosure:!1})}async getPendingLocalStateCore(e){return D.Bt.timedExecAsync(this.mc.logger,{eventName:"getPendingLocalState",notifyImminentClosure:e.notifyImminentClosure,savedOpsSize:this.savedOps.length,clientId:this.clientId},(async()=>{if(!this.offlineLoadEnabled)throw new Re.eb("Can't get pending local state unless offline load is enabled");if(this.closed||this._disposed)throw new Re.eb("Pending state cannot be retried if the container is closed or disposed");(0,Se.v)(this.attachState===He.Attached,209),(0,Se.v)(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210),(0,Se.v)(!!this.baseSnapshot,1492),(0,Se.v)(!!this.baseSnapshotBlobs,1493);const t=await this.runtime.getPendingLocalState(e),r={pendingRuntimeState:t,baseSnapshot:this.baseSnapshot,snapshotBlobs:this.baseSnapshotBlobs,savedOps:this.savedOps,url:this.resolvedUrl.url,clientId:void 0!==t?this.clientId:void 0};return JSON.stringify(r)}))}get attachState(){return this._attachState}serialize(){(0,Se.v)(this.attachState===He.Detached,211);const e=Te(this.runtime.createSummary(),this.captureProtocolSummary());return this.detachedBlobStorage&&this.detachedBlobStorage.size>0&&(e.tree[rr]={type:ke.Z.Blob,content:"true"}),JSON.stringify(e)}async attach(e,t){await D.Bt.timedExecAsync(this.mc.logger,{eventName:"Attach"},(async()=>{if("loaded"!==this._lifecycleState)throw new Re.eb("The Container is not in a valid state for attach [".concat(this._lifecycleState,"]"));(0,Se.v)(this._attachState===He.Detached&&!this.attachStarted,517),this.attachStarted=!0;const r=void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0;try{let n;if((0,Se.v)(0===this.deltaManager.inbound.length,214),!r){const e=this.runtime.createSummary(),t=this.captureProtocolSummary();if(n=Te(e,t),this._attachState=He.Attaching,this.runtime.setAttachState(He.Attaching),this.emit("attaching"),this.offlineLoadEnabled){const e=Fe(n);this.baseSnapshot=e,this.baseSnapshotBlobs=It(e)}}if(void 0===this.service){const t=await this.urlResolver.resolve(e);(0,Se.v)(this.client.details.type!==nr&&void 0!==t,708),this.service=await(0,qe.M)((async()=>this.serviceFactory.createContainer(n,t,this.subLogger,!1)),"containerAttach",this.mc.logger,{cancel:this._deltaManager.closeAbortController.signal})}if(this.storageAdapter.connectToService(this.service),r){(0,Se.v)(!!this.detachedBlobStorage,590);const e=new Map;for(;e.size<this.detachedBlobStorage.size;){const t=this.detachedBlobStorage.getBlobIds().filter((t=>!e.has(t)));for(const r of t){const t=await this.detachedBlobStorage.readBlob(r),n=await this.storageAdapter.createBlob(t);e.set(r,n.id)}}const t=this.runtime.createSummary(e),r=this.captureProtocolSummary();if(n=Te(t,r),this._attachState=He.Attaching,this.runtime.setAttachState(He.Attaching),this.emit("attaching"),this.offlineLoadEnabled){const e=Fe(n);this.baseSnapshot=e,this.baseSnapshotBlobs=It(e)}await this.storageAdapter.uploadSummaryWithContext(n,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0})}this._attachState=He.Attached,this.runtime.setAttachState(He.Attached),this.emit("attached"),this.closed||this.handleDeltaConnectionArg({fetchOpsFromStorage:!1,reason:{text:"createDetached"}},null===t||void 0===t?void 0:t.deltaConnection)}catch(vt){var n;const t=(0,we.cQ)(vt);throw t.addTelemetryProperties({resolvedUrl:null===(n=this.resolvedUrl)||void 0===n?void 0:n.url}),this.close(t),t}}),{start:!0,end:!0,cancel:"generic"})}setAutoReconnectInternal(e,t){if(this._deltaManager.connectionManager.reconnectMode===e)return;const r=Me.F.now(),n=r-this.setAutoReconnectTime;this.setAutoReconnectTime=r,this.mc.logger.sendTelemetryEvent({eventName:e===at.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:ee[this.connectionState],duration:n}),this._deltaManager.connectionManager.setAutoReconnect(e,t)}connect(){if(this.closed)throw new Re.eb("The Container is closed and cannot be connected");if(this._attachState!==He.Attached)throw new Re.eb("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:{text:"DocumentConnect"},fetchOpsFromStorage:!1})}connectInternal(e){(0,Se.v)(!this.closed,709),(0,Se.v)(this._attachState===He.Attached,710),this.resumeInternal(e);const t=at.Enabled;this.setAutoReconnectInternal(t,e.reason)}disconnect(){if(this.closed)throw new Re.eb("The Container is closed and cannot be disconnected");this.disconnectInternal({text:"DocumentDisconnect"})}disconnectInternal(e){(0,Se.v)(!this.closed,711);const t=at.Disabled;this.setAutoReconnectInternal(t,e)}resumeInternal(e){(0,Se.v)(!this.closed,217),this.inboundQueuePausedFromInit&&(this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async proposeCodeDetails(e){if(!je(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then((()=>!0)).catch((()=>!1))}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]),!0===await this.satisfies(e))return this.deltaManager.inbound.resume(),void this.deltaManager.inboundSignal.resume();const t=new Re.gn("Existing context does not satisfy incoming proposal");this.close(t)}async satisfies(e){var t;if(void 0===this._loadedModule)return!1;const r=[],n=this.codeLoader;void 0!==n.IFluidCodeDetailsComparer&&r.push(n.IFluidCodeDetailsComparer);const o=null===(t=this._loadedModule)||void 0===t?void 0:t.module.fluidExport;if(void 0!==(null===o||void 0===o?void 0:o.IFluidCodeDetailsComparer)&&r.push(o.IFluidCodeDetailsComparer),0===r.length)return!1;for(const s of r){var i;if(!1===await s.satisfies(null===(i=this._loadedModule)||void 0===i?void 0:i.details,e))return!1}return!0}async getVersion(e){return(await this.storageAdapter.getVersions(e,1))[0]}connectToDeltaStream(e){this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async load(e,t,r,n,o){var i,s,a;const c={phase1:Me.F.now()};this.service=await this.serviceFactory.createDocumentService(r,this.subLogger,this.client.details.type===nr);const l={reason:{text:"DocumentOpen"},mode:!0===this.mc.config.getBoolean("Fluid.Container.ForceWriteConnection")||(null!==(i=null===n||void 0===n?void 0:n.savedOps.length)&&void 0!==i?i:0)>0?"write":"read",fetchOpsFromStorage:!1};void 0!==t.deltaConnection||n||this.connectToDeltaStream(l),this.storageAdapter.connectToService(this.service),this._attachState=He.Attached,c.phase2=Me.F.now();const{snapshot:d,versionId:u}=void 0===n?await this.fetchSnapshotTree(e):{snapshot:n.baseSnapshot,versionId:void 0};n?(this.baseSnapshot=n.baseSnapshot,this.baseSnapshotBlobs=n.snapshotBlobs):((0,Se.v)(void 0!==d,567),this.offlineLoadEnabled&&(this.baseSnapshot=d,this.baseSnapshotBlobs=await Pt(d,this.storageAdapter)));const h=await this.getDocumentAttributes(this.storageAdapter,d),g=null===n||void 0===n||null===(s=n.savedOps[n.savedOps.length-1])||void 0===s?void 0:s.sequenceNumber,p=void 0!==g?{...h,sequenceNumber:g}:h;let m;if(!0===t.pauseAfterLoad){if("sequenceNumber"===t.opsBeforeReturn&&((0,Se.v)(void 0!==o,1831),p.sequenceNumber>o))throw new Error("Cannot satisfy request to pause the container at the specified sequence number. Most recent snapshot is newer than the specified sequence number.");this.forceReadonly(!0);const e=()=>{if(void 0===o){if(0!==this.deltaManager.inbound.length)return}else if(this.deltaManager.lastSequenceNumber<o)return;this.deltaManager.inbound.pause(),this.deltaManager.outbound.pause(),this.off("op",e)};void 0===o&&0===this.deltaManager.inbound.length||this.deltaManager.lastSequenceNumber===o?e():this.on("op",e)}switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(p,"none"!==t.deltaConnection?"all":"none");break;case"sequenceNumber":case"cached":case"all":m=this.attachDeltaManagerOpHandler(p,t.opsBeforeReturn);break;default:(0,Ce.$)(t.opsBeforeReturn)}await this.initializeProtocolStateFromSnapshot(h,this.storageAdapter,d),c.phase3=Me.F.now();const f=this.getCodeDetailsFromQuorum();if(await this.instantiateRuntime(f,d,n?null!==(a=null===n||void 0===n?void 0:n.pendingRuntimeState)&&void 0!==a?a:{}:void 0),n){for(const e of n.savedOps){var v,y;this.processRemoteMessage({...e,metadata:{...e.metadata,savedOp:!0}}),await(null===(v=(y=this.runtime).notifyOpReplay)||void 0===v?void 0:v.call(y,e))}n.savedOps=[]}if(this.closed||(void 0!==m&&(this._deltaManager.inbound.resume(),await D.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},(async()=>m)),await D.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},(async()=>this._deltaManager.inbound.waitTillProcessingDone())),this._deltaManager.inbound.pause()),this.handleDeltaConnectionArg(l,t.deltaConnection,void 0!==n)),void 0!==o&&this.deltaManager.lastSequenceNumber<o&&await new Promise(((e,t)=>{const r=t=>{t.sequenceNumber>=o&&(e(),this.off("op",r))};this.on("op",r)})),this.closed)throw new Error("Container was closed while load()");return this.setLoaded(),c.end=Me.F.now(),this.subLogger.sendTelemetryEvent({eventName:"LoadStagesTimings",details:JSON.stringify(c)},void 0,ze),{sequenceNumber:h.sequenceNumber,version:u,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const r=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.initializeProtocolState(t,{members:[],proposals:[],values:r}),await this.instantiateRuntime(e,void 0),this.setLoaded()}async rehydrateDetachedFromSnapshot(e){void 0!==e.tree[rr]&&((0,Se.v)(!!this.detachedBlobStorage&&this.detachedBlobStorage.size>0,592),delete e.tree[rr]);const t=Fe(e);this.storageAdapter.loadSnapshotForRehydratingContainer(t);const r=await this.getDocumentAttributes(this.storageAdapter,t);await this.attachDeltaManagerOpHandler(r);const n=De(t),o=await(0,Ve.P)(this.storageAdapter,n.blobs.quorumValues);this.initializeProtocolState(r,{members:[],proposals:[],values:o});const i=this.getCodeDetailsFromQuorum();await this.instantiateRuntime(i,t),this.setLoaded()}async getDocumentAttributes(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0};const r=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"];return await(0,Ve.P)(e,r)}async initializeProtocolStateFromSnapshot(e,t,r){const n={members:[],proposals:[],values:[]};if(void 0!==r){const e=De(r);[n.members,n.proposals,n.values]=await Promise.all([(0,Ve.P)(t,e.blobs.quorumMembers),(0,Ve.P)(t,e.blobs.quorumProposals),(0,Ve.P)(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,n)}initializeProtocolState(e,t){const r=this.protocolHandlerBuilder(e,t,((e,t)=>this.submitMessage(Ke.Go.Propose,JSON.stringify({key:e,value:t})))),n=(0,D.pW)({logger:this.subLogger,namespace:"ProtocolHandler"});r.quorum.on("error",(e=>{n.sendErrorEvent(e)})),this.connectionStateHandler.initProtocol(r),r.quorum.on("addProposal",(e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)})),r.quorum.on("approveProposal",((e,t,r)=>{"code"!==t&&"code2"!==t||(je(r)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch((e=>{const t=(0,we.cQ)(e);throw this.close(t),e})))})),this._protocolHandler=r}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:ke.Z.Blob},quorumMembers:{content:JSON.stringify(e.members),type:ke.Z.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:ke.Z.Blob},quorumValues:{content:JSON.stringify(e.values),type:ke.Z.Blob}},type:ke.Z.Tree}}getCodeDetailsFromQuorum(){const e=(e=>{var t;return null!==(t=e.get("code"))&&void 0!==t?t:e.get("code2")})(this.protocolHandler.quorum);return e}static setupClient(e,t,r){const n=ot(null===t||void 0===t?void 0:t.client),o=void 0!==n?n:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}};return void 0!==r&&(o.details={...o.details,...r,capabilities:{...o.details.capabilities,...null===r||void 0===r?void 0:r.capabilities}}),o.details.environment=[o.details.environment," loaderVersion:".concat(ft)," containerId:".concat(e)].join(";"),o}activeConnection(){return this.connectionState===ee.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new mt(e,(0,D.pW)({logger:this.subLogger,namespace:"DeltaManager"}),(()=>this.activeConnection()),(t=>new er(e,(()=>this.isDirty),this.client,this._canReconnect,(0,D.pW)({logger:this.subLogger,namespace:"ConnectionManager"}),t)));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",((e,t)=>{(0,Se.v)(this.connectionMode===e.mode,1207),this.connectionStateHandler.receivedConnectEvent(e)})),t.on("establishingConnection",(e=>{this.connectionStateHandler.establishingConnection(e)})),t.on("cancelEstablishingConnection",(e=>{this.connectionStateHandler.cancelEstablishingConnection(e)})),t.on("disconnect",(e=>{var t;null===(t=this.noopHeuristic)||void 0===t||t.notifyDisconnect(),this.closed||this.connectionStateHandler.receivedDisconnectEvent(e)})),t.on("throttled",(e=>{const t=e;!0!==t.logged&&this.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},t),this.emit("warning",t)})),t.on("readonly",(e=>{this.setContextConnectedState(this.connectionState===ee.Connected,e),this.emit("readonly",e)})),t.on("closed",(e=>{this.closeCore(e)})),t.on("disposed",(e=>{this.disposeCore(e)})),t}async attachDeltaManagerOpHandler(e,t){return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t)}logConnectionStateChangeTelemetry(e,t,r){var n;const o=Me.F.now();this.connectionTransitionTimes[e]=o;const i=o-this.connectionTransitionTimes[t];let s,a,c,l,d;e===ee.Disconnected?c=this._deltaManager.connectionManager.reconnectMode:(e===ee.Connected?(s=o-this.connectionTransitionTimes[ee.Disconnected],s=(0,D.T0)(s)):e===ee.CatchingUp&&(l=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&"loaded"===this._lifecycleState&&(d=l-this.deltaManager.lastSequenceNumber)),a=this.firstConnection?"InitialConnect":"AutoReconnect"),this.mc.logger.sendPerformanceEvent({eventName:"ConnectionStateChange_".concat(ee[e]),from:ee[t],duration:i,durationFromDisconnected:s,reason:null===r||void 0===r?void 0:r.text,connectionInitiationReason:a,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.clientId,autoReconnect:c,opsBehind:d,online:Ge.WA[(0,Ge.sc)()],lastVisible:void 0!==this.lastVisible?Me.F.now()-this.lastVisible:void 0,checkpointSequenceNumber:l,quorumSize:null===(n=this._protocolHandler)||void 0===n?void 0:n.quorum.getMembers().size,isDirty:this.isDirty,...this._deltaManager.connectionProps},null===r||void 0===r?void 0:r.error),e===ee.Connected&&(this.firstConnection=!1)}propagateConnectionState(e,t){var r;if(!e&&this.connectionState!==ee.Connected&&this.connectionState!==ee.Disconnected)return;const n=this.connectionState===ee.Connected;this.setContextConnectedState(n,null!==(r=this.readOnlyInfo.readonly)&&void 0!==r&&r),this.protocolHandler.setConnectionState(n,this.clientId),(0,Je.aX)(this.mc.logger,this,n,this.clientId,null===t||void 0===t?void 0:t.text)}submitContainerMessage(e,t,r,n){switch(e){case Ke.Go.Operation:return this.submitMessage(e,JSON.stringify(t),r,n);case Ke.Go.Summarize:return this.submitSummaryMessage(t);default:{const t=new Re.gn("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(t),-1}}}submitBatch(e,t){let r=-1;for(const n of e)r=this.submitMessage(Ke.Go.Operation,n.contents,!0,n.metadata,n.compression,t);return this._deltaManager.flush(),r}submitSummaryMessage(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(Ke.Go.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}submitMessage(e,t,r,n,o,i){var s;return this.connectionState!==ee.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(null===(s=this.noopHeuristic)||void 0===s||s.notifyMessageSent(),this._deltaManager.submit(e,t,r,n,o,i))}processRemoteMessage(e){this.offlineLoadEnabled&&this.savedOps.push(e);const t=this.clientId===e.clientId,r=this.protocolHandler.processMessage(e,t);if(this.runtime.process(e,t),this.activeConnection()){if(void 0===this.noopHeuristic){const e=this.deltaManager.serviceConfiguration;(0,Se.v)(void 0!==e,740),this.noopHeuristic=new Rt(e.noopTimeFrequency,e.noopCountFrequency),this.noopHeuristic.on("wantsNoop",(()=>{(0,Se.v)(this.activeConnection(),577),this.submitMessage(Ke.Go.NoOp)}))}this.noopHeuristic.notifyMessageProcessed(e),!0===r.immediateNoOp&&this.submitMessage(We.sI.Accept)}this.emit("op",e)}submitSignal(e,t){this._deltaManager.submitSignal(JSON.stringify(e),t)}processSignal(e){if(function(e){if(null===e.clientId){const t=e.content;return t.type===Ht.Clear||t.type===Ht.ClientJoin||t.type===Ht.ClientLeave}return!1}(e))this.protocolHandler.processSignal(e);else{const t=this.clientId===e.clientId;this.runtime.processSignal(e,t)}}async fetchSnapshotTree(e){var t;const r=await this.getVersion(null!==e&&void 0!==e?e:null);void 0===r&&void 0!==e&&this.mc.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:e}),this._loadedFromVersion=r;const n=null!==(t=await this.storageAdapter.getSnapshotTree(r))&&void 0!==t?t:void 0;return void 0===n&&void 0!==r&&this.mc.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:r.id}),{snapshot:n,versionId:null===r||void 0===r?void 0:r.id}}async instantiateRuntime(e,t,r){var n,o;(0,Se.v)(!1!==(null===(n=this._runtime)||void 0===n?void 0:n.disposed),221);const i=this.scope,s=new lr(this,i.ILoader),a=await D.Bt.timedExecAsync(this.subLogger,{eventName:"CodeLoad"},(async()=>this.codeLoader.load(e)));this._loadedModule={module:a.module,details:null!==(o=a.details)&&void 0!==o?o:e};const c=this._loadedModule.module.fluidExport,l=null===c||void 0===c?void 0:c.IRuntimeFactory;if(void 0===l)throw new Error("Code package does not implement IRuntimeFactory");const d=void 0!==t,u=new st(this.options,this.scope,t,this._loadedFromVersion,this._deltaManager,this.storageAdapter,this.protocolHandler.quorum,this.protocolHandler.audience,s,((e,t,r,n)=>this.submitContainerMessage(e,t,r,n)),((e,t)=>this.submitSummaryMessage(e,t)),((e,t)=>this.submitBatch(e,t)),((e,t)=>this.submitSignal(e,t)),(e=>this.dispose(e)),(e=>this.close(e)),this.updateDirtyContainerState,this.getAbsoluteUrl,(()=>{var e;return null===(e=this.resolvedUrl)||void 0===e?void 0:e.id}),(()=>this.clientId),(()=>this.attachState),(()=>this.connected),(()=>{var e;return null!==(e=this.protocolHandler.quorum.get("code"))&&void 0!==e?e:this.protocolHandler.quorum.get("code2")}),this._deltaManager.clientDetails,d,this.subLogger,r);this._runtime=await D.Bt.timedExecAsync(this.subLogger,{eventName:"InstantiateRuntime"},(async()=>l.instantiateRuntime(u,d))),this._lifecycleEvents.emit("runtimeInstantiated"),this._loadedCodeDetails=e}setContextConnectedState(e,t){var r;!1===(null===(r=this._runtime)||void 0===r?void 0:r.disposed)&&this.runtime.setConnectionState(e&&!t,this.clientId)}handleDeltaConnectionArg(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(t){case void 0:r&&this.connectToDeltaStream(e);case"delayed":(0,Se.v)(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:(0,Ce.$)(t)}}}var ir=r(76522);const{debug:sr}=ir;class ar{static mixinDebugLogger(e,t,r){const n=sr(e),o=sr(e);return o.log=function(){!0===n.enabled?sr.log(...arguments):console.error(...arguments)},o.enabled=!0,(0,D.Z)({namespace:e,loggers:[t,new ar(n,o)],properties:r,tryInheritProperties:!0})}constructor(e,t){this.debug=e,this.debugErr=t}send(e){var t;const r={...e},n="error"===r.category;let o=n?this.debugErr:this.debug;const i=e.eventName.lastIndexOf(D.Hf),s=e.eventName.substring(i+1);i>0&&(o=o.extend(e.eventName.substring(0,i))),r.eventName=void 0;let a="";a="tick=".concat((0,D.T0)(Me.F.now()));const c=null!==(t=r.stack)&&void 0!==t?t:"";let l;r.stack=void 0;try{l=JSON.stringify(r)}catch(vt){r.error=void 0,l=JSON.stringify(r)}"{}"===l&&(l=""),n&&(o.enabled=!0),o("".concat(s," ").concat(l," ").concat(a," ").concat(c))}}function cr(e){if(void 0===e)throw new Error("Object is not a IResolveUrl.")}class lr{constructor(e,t){this.container=e,this.loader=t}async resolve(e){if(e.url.startsWith("/")){var t,r,n,o,i;cr(this.container.resolvedUrl);return await this.container.clone({resolvedUrl:{...this.container.resolvedUrl},version:null!==(t=null===(r=e.headers)||void 0===r?void 0:r[Le.version])&&void 0!==t?t:void 0,loadMode:null===(n=e.headers)||void 0===n?void 0:n[Le.loadMode]},{canReconnect:null===(o=e.headers)||void 0===o?void 0:o[Le.reconnect],clientDetailsOverride:null===(i=e.headers)||void 0===i?void 0:i[Le.clientDetails]})}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}}class dr{constructor(e){const{urlResolver:t,documentServiceFactory:r,codeLoader:n,options:o,scope:i,logger:s,detachedBlobStorage:a,configProvider:c,protocolHandlerBuilder:l}=e,d={loaderId:ve(),loaderVersion:ft},u=(0,Ae.fG)(ar.mixinDebugLogger("fluid:telemetry",s,{all:d}),Ae.lh.value,c);this.services={urlResolver:t,documentServiceFactory:r,codeLoader:n,options:null!==o&&void 0!==o?o:{},scope:!1!==(null===o||void 0===o?void 0:o.provideScopeLoader)?{...i,ILoader:this}:{...i},detachedBlobStorage:a,protocolHandlerBuilder:l,subLogger:u.logger},this.mc=(0,Ae.CL)({logger:this.services.subLogger,namespace:"Loader"})}async createDetachedContainer(e,t){return or.createDetached({...t,...this.services},e)}async rehydrateDetachedContainerFromSnapshot(e,t){return or.rehydrateDetachedFromSnapshot({...t,...this.services},e)}async resolve(e,t){const r=void 0===t?"Resolve":"ResolveWithPendingState";return D.Bt.timedExecAsync(this.mc.logger,{eventName:r},(async()=>(await this.resolveCore(e,void 0!==t?JSON.parse(t):void 0)).container))}async resolveCore(e,t){var r,n,o;const i=await this.services.urlResolver.resolve(e);cr(i);const s=Ee(i.url);if(void 0===s)throw new Error("Invalid URL ".concat(i.url));if(void 0!==t){const e=Ee(t.url);if((null===e||void 0===e?void 0:e.id)!==s.id||(null===e||void 0===e?void 0:e.path.replace(/\/$/,""))!==s.path.replace(/\/$/,"")){const e="URL ".concat(i.url," does not match pending state URL ").concat(t.url);throw new Error(e)}}null!==(r=e.headers)&&void 0!==r||(e.headers={}),e.headers[Le.version]=null!==(n=s.version)&&void 0!==n?n:e.headers[Le.version];const a=e.headers[Le.sequenceNumber],c=null===(o=e.headers[Le.loadMode])||void 0===o?void 0:o.opsBeforeReturn;if("sequenceNumber"===c&&(void 0===a||a<0))throw new Re.eb("sequenceNumber must be set to a non-negative integer");if("sequenceNumber"!==c&&void 0!==a)throw new Re.eb('opsBeforeReturn must be set to "sequenceNumber"');return{container:await this.loadContainer(e,i,t),parsed:s}}async loadContainer(e,t,r){var n,o,i,s,a,c;return or.load({resolvedUrl:t,version:null!==(n=null===(o=e.headers)||void 0===o?void 0:o[Le.version])&&void 0!==n?n:void 0,loadMode:null===(i=e.headers)||void 0===i?void 0:i[Le.loadMode],pendingLocalState:r,loadToSequenceNumber:null===(s=e.headers)||void 0===s?void 0:s[Le.sequenceNumber]},{canReconnect:null===(a=e.headers)||void 0===a?void 0:a[Le.reconnect],clientDetailsOverride:null===(c=e.headers)||void 0===c?void 0:c[Le.clientDetails],...this.services})}}var ur;!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(ur||(ur={}));var hr=r(16135),gr=r(82963);const pr="@ms/office-fluid-container",mr="@ms/onenote-meetings",fr="@ms/whiteboard-container",vr="@fluidx/loop-page-container";var yr=r(57063),br=r(75812),Sr=r(93537),Cr=r(37805),kr=r(69649);const wr="fluidCodeLoaderCache",Pr="codeLoaderStorage";function Er(){return(0,kr.P2)(wr,1,{async upgrade(e,t){e.createObjectStore(Pr).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function Tr(e){return"".concat(e.packageName,"_").concat(e.containerEnvironment)}function Ir(e,t){const r=e.find((e=>!function(e,t){const r=new URL(e);return t.includes(r.origin)}(e,t)));return void 0===r}const Nr=6048e5;async function Fr(e,t){try{const r=await Er();await r.delete(Pr,Tr({packageName:e,containerEnvironment:t})),r.close()}catch{}}async function Dr(e,t,r,n,o){const i=(0,y.yb)(),s=v.m.start("GetCodeDetailsPackage",o,{addUserTiming:!0}),a=async function(e,t,r){try{const n=await Er(),o=await n.get(Pr,Tr({packageName:e,containerEnvironment:t}));if(n.close(),o){const n=Date.now()-o.lastUpdatedTime;return n>Nr?{metadata:{cacheStatus:"expired",cacheAge:n},codeDetails:void 0}:Ir(o.codeDetailsPackage.fluid.browser.umd.files,r)?{metadata:{cacheStatus:"hit",cacheAge:n},codeDetails:o.codeDetailsPackage}:(Fr(e,t).catch((()=>{})),{metadata:{cacheStatus:"unsafe"},codeDetails:void 0})}}catch{}return{metadata:{cacheStatus:"miss"},codeDetails:void 0}}(e,t,r).then((e=>({method:"cache",cacheDetails:e}))),c=n(t,r).then((e=>({method:"network",codeDetails:e}))),l=await Promise.race([a,c]);let d={documentEverHidden:(0,y.xl)(i,!0)>-1};if("cache"===l.method){const{cacheDetails:e}=l;if(d={...d,...e.metadata},e.codeDetails)return s.setResult(!0,{method:"cache",...d}),e.codeDetails}return c.then((e=>(s.setResult(!0,{method:"network",...d}),e.codeDetails)))}function Or(e,t,r,n,o){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=r,c=r=>function(e,t,r,n,o,i){const s=n(r),a=s.then((async n=>{const s=await Er(),a=Tr({packageName:t,containerEnvironment:r}),c=await s.get(Pr,a);c&&c.codeDetailsPackage.version===n.fluidCodeDetailsOverride.package.version||o(e,n,i),await s.put(Pr,{codeDetailsPackage:n.fluidCodeDetailsOverride.package,lastUpdatedTime:Date.now()},a),s.close()})).catch((()=>{}));return{codePackagePromise:s.then((e=>{const t=e.maxUnsupportedContainerScriptVersion;return{...e.fluidCodeDetailsOverride.package,maxUnsupportedVersion:t}})),cacheUpdatePromise:a}}(e,t,r,i,a,o);return{getCodeDetailsPackage:(e,r)=>Dr(t,e,r,(e=>c(e).codePackagePromise),n),upgradeNeeded:async(e,r)=>{if(!s)return!1;const n=await s(e,r);return n&&(await Fr(t,e),c(e)),n},preCacheLatestContainerCode:async e=>await c(e).cacheUpdatePromise}}function Br(e,t){const r=e.document,n=r.createDocumentFragment();t.forEach((e=>{const t=r.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",n.appendChild(t)):e.endsWith(".css")&&(t.as="style",n.appendChild(t))})),r.head.appendChild(n)}function xr(e,t,r){const n=t.preload.manifest,o=[...n.assets];if(n.localizedAssets){const e=(0,A.rv)(r),t=n.localizedAssets[e];t&&o.push(...t)}Br(e,o.map((e=>"".concat(t.preload.jsBaseUrl,"/").concat(e))))}async function Lr(e,t){const r=await(t?(0,br.R)(e,{method:"GET"},"GetCodeLoadDetailsFromNetwork",t,!1,{maxRetries:3,filter:(0,Sr.sC)([709,710]),backoffFn:(0,Cr.FT)(500)}):(0,Sr.J5)(e,{method:"GET"},{maxRetries:3,filter:(0,Sr.sC)([709,710]),backoffFn:(0,Cr.FT)(500)}));if(r.result.ok)return r.result.json();throw new Error("getCodeLoadDetailsFromNetwork: Failed to fetch: ".concat(e," ; StatusCode: ").concat(r.result.status))}function Ar(e){return!isNaN(e)&&isFinite(e)}const Rr=(e,t,r,n,o)=>Or(e,t,{getLatestContainerCodeDetails:r,preCacheContainerCode:xr,upgradeNeeded:async(e,t)=>{try{const n=await r(e);return function(e,t,r){const n=parseFloat(e);if(!Ar(n))return!1;const o=parseFloat(t);if(!Ar(o))return!1;const i=parseFloat(r);return!!(Ar(i)&&n>i)||n<=o}(t,n.maxUnsupportedContainerScriptVersion,n.fluidCodeDetailsOverride.package.version)}catch{return!1}}},n,o);const Mr=(e,t,r,n)=>Rr(e,pr,(e=>async function(e,t,r){return Lr(r?"".concat((0,yr.Vv)(e),"/container/versionless/_1cdn_bucketedcontent/officeContainerCodeLoadDetails.json"):"".concat((0,yr.ox)(e),"/container/versionless/officeContainerCodeLoadDetails.json"),t)}(e,t,n)),t,r);const _r=(e,t,r)=>Rr(e,vr,(e=>async function(e,t){return Lr("".concat((0,yr.ox)(e),"/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json"),t)}(e,t)),t,r),zr=e=>{const t="https://whiteboard.office.com";switch(e){case"Development":return"https://dev.whiteboard.microsoft.com";case"Staging":return"https://app.int.whiteboard.microsoft.com";case"Dogfood":case"Gcc":default:return t;case"GccHigh":return"https://whiteboard.office365.us";case"DoD":return"https://whiteboard.apps.mil";case"USNat":return"https://whiteboard.eaglex.ic.gov";case"USSec":return"https://whiteboard.microsoft.scloud"}},Hr=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid),Ur=e=>{var t,r;return Hr(e)&&"string"===typeof(null===e||void 0===e||null===(t=e.fluid)||void 0===t||null===(t=t.browser)||void 0===t||null===(t=t.umd)||void 0===t?void 0:t.library)&&Array.isArray(null===e||void 0===e||null===(r=e.fluid)||void 0===r||null===(r=r.browser)||void 0===r||null===(r=r.umd)||void 0===r?void 0:r.files)};var jr=r(32896);const qr=e=>{switch(e){case mr:case pr:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case fr:case vr:return e;default:return"(redacted)"}},Vr="NPM",Gr="CDN";function Wr(e,t){return new Promise(((r,n)=>{const o=e.document,i=o.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{r()},i.onerror=()=>n(new Error("Failed to download the style sheet at url: ".concat(t,", isUserDefinitelyOffline: ").concat(!e.navigator.onLine))),o.head.appendChild(i),i}))}const Kr=new Map,Jr=e=>"string"===typeof e.package?e.package:e.package.name,Qr="0.0.1",Xr=e=>!Number.isNaN(e)&&Number.isFinite(e),Zr=e=>{return"string"!==typeof e.package&&(t=e.package,Ur(t)&&(t.version===Qr||Xr(Number(t.version))))?{name:e.package.name,version:e.package.version===Qr?Qr:Number(e.package.version)}:void 0;var t};class $r{get IRuntimeFactory(){return this}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}constructor(e,t){this.wrappedFactory=e,this.config=t}}class Yr{get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=Zr(e);if(void 0!==t)return"".concat(t.version,"|").concat(t.name)}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}async load(e,t){var r;const n=Jr(e),i=e.config,{windowContext:s,getBundledPackageFactoryOverride:a,disableCdnCodeLoadingFallback:c,revertToUnloadEventInsteadOfPageHide:l}=this.config;let d=Kr.get(s);const u=null===(r=d)||void 0===r?void 0:r.get(n);if(void 0!==u){const t=await u,r=t.fluidExport.ConfigurableRuntimeFactory;return void 0!==r?{module:{fluidExport:new $r(r,i)},details:e}:{module:t,details:e}}let h=null===a||void 0===a?void 0:a(n);if(h)h.then((e=>{var r;const o=null===(r=e.fluidExport.CodeVersionDetailsProvider)||void 0===r||null===(r=r.codeVersionDetails)||void 0===r?void 0:r.version;en(t,{packageName:n,deliveryType:Vr,codeVersion:o})})).catch((()=>{t&&(0,o.hO)(t,{eventName:"NpmCodeLoaderOverrideFailed",packageName:qr(n)})}));else{if(c)throw new Error("CDN code loading fallback set to false but no factory provided by host for container named ".concat(qr(n)));t&&(0,o.Ot)(t,{eventName:"CodeLoaderFallbackToCDN",containerType:qr(n)}),h=this.loadInternal(e,t)}d||(d=new Map,Kr.set(s,d),s!==window&&(l?s.addEventListener("unload",(()=>{Kr.delete(s)})):s.addEventListener("pagehide",(e=>{e.persisted||Kr.delete(s)})))),d.set(n,h),h.catch((()=>d.delete(n)));const g=await h,p=g.fluidExport.ConfigurableRuntimeFactory;return void 0!==p?{module:{fluidExport:new $r(p,i)},details:e}:{module:g,details:e}}async loadInternal(e,t){const{windowContext:r,trustedTypesPolicy:n,allowedCodeOrigins:o,getFluidCodeVersionDetails:i}=this.config,s=await this.getEffectiveFluidCodeDetailsPackage(e);if(en(t,{packageName:Jr(e),deliveryType:Gr,codeVersion:s.version}),void 0===s)throw new Error("Failed to get Fluid Package. Trying to load ContainerType: ".concat(qr(e.package.name)));const a=s.fluid.browser.umd;if(!this.shouldLoad(a.files))throw new Error("Unsupported container files, check that CDN is on allow list");const c=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==c&&"string"!==typeof e.package){const t={...e,package:{...e.package,...s}};this.actualCodeDetailsMap.set(c,t)}const l=n&&{trustedTypesPolicy:await n,allowedOrigins:o};await Promise.all(a.files.map((e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return(0,jr.a)(r,e,l,"high");if(t.endsWith(".css"))return((e,t)=>{let r=3;return function n(){return Wr(e,t).catch((()=>(r-=1,0===r?Wr(e,t):n())))}()})(r,e);throw new Error("Codeloader does not know how to load: ".concat(e))})));const d=r[a.library];if(void 0===d)throw new Error("Entry point of loaded package not a Fluid module. Trying to load ContainerType: ".concat(qr(e.package.name)));const{CodeVersionDetailsProvider:u}=d.fluidExport;if(u){const e=null===i||void 0===i?void 0:i(s);e&&u.setCodeVersionDetails(e)}return d}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:r}=this.config;if(t){const n=await t(e);if(n){const e=n.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");Br(r,e.files)}}}async getEffectiveFluidCodeDetailsPackage(e){var t,r;const n="string"===typeof e.package?e.package:e.package.name,o=await(null===(t=(r=this.config).getFluidCodeDetailsPackageOverride)||void 0===t?void 0:t.call(r,n))||e.package;if("string"===typeof o)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!Ur(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(o),o}shouldLoad(e){return Ir(e,this.config.allowedCodeOrigins)}async satisfies(e,t){const r=this.getActualCodeDetails(e);if(void 0===r)return!0;if("string"===typeof t.package||"string"===typeof r.package)return!0;const n=(e=>{const t=Number(e.maxUnsupportedVersion);return Xr(t)?t:void 0})(t.package);if(void 0!==n){var o;const e=null===(o=Zr(r))||void 0===o?void 0:o.version;if(void 0!==e)return e===Qr||e>n}return!0}async compare(e,t){const r=Zr(e);if(void 0===r)return;const n=Zr(t);return void 0!==n&&r.name===n.name?r.version===n.version?0:r.version===Qr?-1:n.version===Qr?1:r.version-n.version:void 0}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map}}function en(e,t){let{packageName:r,deliveryType:n,codeVersion:i}=t;if(!e)return;const s={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:qr(r),deliveryType:n};i&&(s.codeVersion=i),(0,o.Ot)(e,s)}function tn(e){var t;const r=null===(t=(0,S.A)())||void 0===t?void 0:t.AllowListOverride;return r?(e&&(0,o.Ot)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(r)):[]}class rn{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}async preCache(e){var t;if(null!==(t=this.config.locallyBundledPackageFactories)&&void 0!==t&&t.has(e))return;const r=this.containerCodeDetailsProviderMap.get(e);return null!==r&&void 0!==r&&r.preCacheLatestContainerCode?r.preCacheLatestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e,this.logger)}constructor(e){var t,r;this.config=e;const n=null!==(t=e.additionalAllowedCodeOrigins)&&void 0!==t?t:[],{windowContext:o,logger:s,localeHint:c,sdpEnabled:l}=this.config,d=null!==s&&void 0!==s&&s.NamespaceLogger?new i.p("OfficeWebHost",s.NamespaceLogger):s;this.logger=d,this.settingsProvider=e.settingsProvider;const u=Mr(o,d,c,l),h=_r(o,d,c),g={getCodeDetailsPackage:(e,t)=>{const r=zr(e),n={name:fr,version:"0.0.1",fluid:{browser:{umd:{files:["".concat(r,"/root/index.fluid.js")],library:"microsoftWhiteboard"}}}};return Promise.resolve(n)}};this.containerCodeDetailsProviderMap=new Map([[pr,u],[mr,u],[vr,h],[fr,g]]),null===(r=e.additionalCodeDetailsProviders)||void 0===r||r.forEach((e=>{let[t,r]=e;return this.containerCodeDetailsProviderMap.set(t,r)}));const p=[...(0,gr.c)(this.config.containerEnvironment,this.settingsProvider,d),...tn(d),...n];this.simpleCodeLoader=new Yr({windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,getBundledPackageFactoryOverride:t=>{var r;const n=null===(r=e.locallyBundledPackageFactories)||void 0===r?void 0:r.get(t);return n?Promise.resolve(n):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,revertToUnloadEventInsteadOfPageHide:(0,a.AU)("revertToUnloadEventInsteadOfPageHide2",!1,this.settingsProvider),getFluidCodeDetailsPackageOverride:async t=>{const r=this.containerCodeDetailsProviderMap.get(t);if(r)return r.getCodeDetailsPackage(e.containerEnvironment,p)},allowedCodeOrigins:p,getFluidCodeVersionDetails:t=>{var r;const{containerEnvironment:n}=e,o=t.version,i=null===(r=this.containerCodeDetailsProviderMap.get(t.name))||void 0===r?void 0:r.upgradeNeeded;return{version:o,containerEnvironment:n||"Local",needUpgrade:i?()=>i(n,o):async()=>!1}}})}}class nn{get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[r,n,o]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new rn({...this.bohemiaConfig,windowContext:e.windowContext,trustedTypesPolicy:r,settingsProvider:n,logger:o})}}}class on{getRawConfig(e){const t=(0,a.AU)(e,null,this.settingsProvider);return null===t?void 0:t}constructor(e){this.settingsProvider=e}}var sn=r(72376);async function an(e,t){let r;const n=v.m.start(k.A8,t),o=new URL(e);try{const e=await(0,br.R)("".concat(o),{method:"GET"},"ContainerManifestFetch",t,!1,sn._9,3e3);if(!e.result.ok)throw new Error("Component manifest fetch returned an error response. status: ".concat(e.result.status,": ").concat(e.result.statusText,"."));r=await e.result.json()}catch(vt){return void n.setResult(!1,{errorType:k.ps},vt,{sampleEvent:!0})}return n.setResult(!0,void 0,void 0,{sampleEvent:!0}),r}const cn="manifest",ln="json";function dn(e,t,r){const n=(0,hr.Rs)(e);if(r){const e="string"===typeof r?r:function(e,t){const r="http://localhost:8081",n="Staging"===e?"stg":"Dogfood"===e?"df":"prod";return"".concat(r,"/").concat(n,"/").concat(cn,".").concat(t,".").concat(ln)}(n,t);return e}const o=(0,yr.ox)(n);return i=t,"".concat(o,"/generic-loader/versionless/").concat(cn,".").concat(i,".").concat(ln);var i}async function un(e){return(await(0,Sr.J5)(e,{method:"GET"},{maxRetries:2,filter:(0,Sr.sC)([408,409,429,710]),backoffFn:(0,Cr.FT)(500)})).result}const hn="LoadManifestFromCache",gn="LoadManifestFromNetwork",pn="DownloadGLManifestError",mn="glManifest";function fn(e){return"string"===typeof e?e:e instanceof Error?e.message:e&&"object"===typeof e?e.toString():void 0}async function vn(e,t,r){const n=v.m.start("GetContainerManifestEntries",r),i=(0,A.Zd)(e)?(0,A.rv)(e):A.q;try{const[e,s]=await async function(e,t,r,n,i){var s;const a=dn(e,t,i);let c,l;n.markSubActivityStart(hn);try{c=await caches.open(mn),l=await c.match(a)}catch(vt){n.markSubActivityEnd(hn),n.addAdditionalProps({cacheError:fn(vt)})}if(null!==(s=l)&&void 0!==s&&s.ok){const e=await l.text();return n.markSubActivityEnd(hn),un(a).then((e=>{var t;return e.ok?null===(t=c)||void 0===t?void 0:t.put(a,e):void 0})).catch((e=>{(0,o.hO)(r,{eventName:pn,isBackground:!0},e)})),[e,!0]}if(n.markSubActivityEnd(hn),n.markSubActivityStart(gn),l=await un(a),n.markSubActivityEnd(gn),l.ok){var d;return null===(d=c)||void 0===d||d.put(a,l.clone()).catch((e=>{})),[await l.text(),!1]}throw new Error("Failed to fetch manifest. Status code ".concat(l.status))}(null!==t&&void 0!==t?t:{audience:"Production"},i,null!==r&&void 0!==r?r:new yn,n),a=function(e){return JSON.parse(e,((e,t)=>{if("urlRegexes"===e||"pathAndQueryParamRegexes"===e){if(Array.isArray(t))return t.map((e=>new RegExp(e)));throw new Error('Invalid value for urlRegexes: "'.concat(t,'"'))}return t}))}(e),c=function(e,t){const r="@ms/office-fluid-container",n=e.components.find((e=>e.registrationId===r));if(!n)return t&&(0,o.hO)(t,{eventName:"LpcRegistrationNotFound"}),[];const{createEntries:i,fluidCodeDetails:s}=n;if(!i)return t&&(0,o.hO)(t,{eventName:"LpcCreateEntriesNotFound"}),[];if(!s)return t&&(0,o.hO)(t,{eventName:"LpcFluidCodeDetailsNotFound"}),[];return i.map((e=>{const{displayName:t,description:r,keywords:n,icons:o,id:i,creationData:a}=e;return{codeDetails:{package:s,config:a},queryableData:{id:i,displayName:t,description:r,keywords:null!==n&&void 0!==n?n:[],icon:o.default}}}))}(a,r);return n.setResult(!0,{fromCache:s}),c}catch(vt){throw n.setResult(!1,void 0,vt),vt}}class yn{get NamespaceLogger(){return this}send(){}sendWithNamespace(){}dispose(){}}const bn="{locale}",Sn=[{genericUrl:"/officeContainerManifest.json",localizableUrl:"/officeContainerManifest.".concat(bn,".json")}];async function Cn(e,t,r,n,o){const s=r&&new i.p(k.Ak,r);if(n)return vn(e,t,s);const a=await async function(e,t,r,n){const o=(0,A.Zd)(e)?(0,A.rv)(e):void 0,i=(0,hr.Rs)(t);return Promise.all(Sn.map((async e=>{const t="SDP"===n?(0,yr.Vv)(i)+"container/versionless/_1cdn_bucketedcontent/":(0,yr.ox)(i)+"/container/versionless",s=t+e.genericUrl,a=t+e.localizableUrl;if(void 0!==o&&a){const e=await an(a.replace(bn,o),r);if(void 0!==e)return e}return an(s,r)})))}(e,t,s,o);return function(e){const t=[];return e.forEach((e=>{if(void 0!==e){const r=e.fluidCodeDetailsPackage;e.configurations.forEach((e=>t.push({codeDetails:{package:r,config:e.config},queryableData:e.queryableData,heroConfiguration:e.heroConfiguration})))}})),t}(a)}const kn=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);function wn(e){if("string"!==typeof e.package&&kn(e.package))return e.package.name}var Pn=r(75704),En=r(82673);function Tn(e){return e?Object.keys(e).sort().join(","):""}class In{get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.clearMemo(),this.providers.set(e,t)}unregister(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}clearMemo(){this.memo.clear()}synthesize(e,t){const r="required:".concat(Tn(t),",optional:").concat(Tn(e));if(this.memo.has(r))return this.memo.get(r);const n={};return this.generateRequired(n,t),this.generateOptional(n,e),Object.defineProperty(n,En.x,{get:()=>this}),this.memo.set(r,n),n}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}generateRequired(e,t){if(void 0===t)return;const r=this.generate(e,t);if(0!==r.size){const e=Array.from(r).join(", ");throw new Error("Object attempted to be created without registered required providers ".concat(e))}}generateOptional(e,t){if(void 0===t)return;const r=this.generate(e,t);for(const n of r){const t={get:async()=>{}};Object.defineProperty(e,n,t)}}generate(e,t){const r=new Set(Object.keys(t));for(const n of r){const t=this.resolveLocalProvider(n);t&&(r.delete(n),Object.defineProperty(e,n,t))}for(const n of this.parents){const t={};for(const e of r)t[e]=e;const o=n.synthesize(t,void 0);for(const n of r){const t=Object.getOwnPropertyDescriptor(o,n);t&&(r.delete(n),Object.defineProperty(e,n,t))}}return r}constructor(){this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=e=>{const t=this.providers.get(e);if(t)return"function"===typeof t?{get:()=>{if("function"===typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then((async e=>t(e))).then((t=>null===t||void 0===t?void 0:t[e]))}}:{get:()=>new Pn.I((async()=>Promise.resolve(t).then((t=>{if(t)return t[e]}))))}};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter((e=>void 0!==e))}}function Nn(e,t){return t?new In(e):new f.h(e)}class Fn{get IFluidDependencySynthesizer(){return this}register(e,t){let r;this.dependencySynthesizer.has("DataConnector")&&(r=this.dependencySynthesizer.synthesize({DataConnector:"DataConnector"},void 0)),this.dependencySynthesizer.register(e,new Pn.I((async()=>{const n=await Promise.resolve(t);if("DataConnector"!==e){var o,i;const e=await(null===(o=r)||void 0===o?void 0:o.DataConnector);null===e||void 0===e||null===(i=e.addComponentTracking)||void 0===i||i.call(e,n)}return this.synthDependencies.set(e,n),n})))}registerIfNotAlreadyExists(e,t){this.dependencySynthesizer.has(e)||this.register(e,t)}synthesize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dependencySynthesizer.synthesize(e,t)}has(e){return this.dependencySynthesizer.has(e)}unregister(e){return this.dependencySynthesizer.unregister(e)}dispose(){for(const[e,t]of this.synthDependencies)t.Disposable.dispose(),this.unregister(e);this.synthDependencies.clear()}constructor(e,t){this.synthDependencies=new Map,this.dependencySynthesizer=Nn(e,t)}}function Dn(e,t){var r;if(!t)return;const n=e?qr(e):"Unknown",o={};o.containerCodeDetailsName=n,null===(r=t.PersistedProperties)||void 0===r||r.addPersistedProperties(o)}const On="FluidCodeLoaderFactory";function Bn(e,t){(async()=>{const r=function(e){var t;if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const r=e.getQuorum();return null!==(t=r.getMember("code"))&&void 0!==t?t:r.getMember("code2")}(e);if(r){var n;const o=null===(n=t.getActualCodeDetails)||void 0===n?void 0:n.call(t,r);if(o&&t.IFluidCodeDetailsComparer){const n=await t.IFluidCodeDetailsComparer.compare(r,o);void 0!==n&&n<0&&await e.proposeCodeDetails(o)}}})().catch((()=>{}))}function xn(){const e=function(){var e;return null===(e=(0,S.A)())||void 0===e?void 0:e.FluidCodeDetailsOverride}();if(void 0!==e)return JSON.parse(e)}async function Ln(e,t,n,s,a,c,l,d){const u=new Fn(a,!0);l&&!u.has("NamespaceLogger")&&u.register("NamespaceLogger",new i.p(k.BN,l));const h={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:On},g=u.synthesize(h,void 0);let[p,m]=await Promise.all([g.SettingsProvider,g.FluidCodeLoaderFactory]);if(!m){const e=await async function(e){let{hostConfig:t,dependencySynthesizer:r}=e;const n=t.codeLoader;if(n)return Promise.resolve({get FluidCodeLoaderFactory(){return this},instantiateFluidCodeLoader:async e=>{let{windowContext:t}=e;return n(t)},get Disposable(){return this},dispose(){}});const o=r.synthesize({SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},void 0),[i,s]=await Promise.all([o.SettingsProvider,o.InternationalizationContext]),a=(0,hr.H9)(t.environment,null===i||void 0===i?void 0:i.audience),c=(null===s||void 0===s?void 0:s.uiLocale)||A.q;return new nn({containerEnvironment:a,localeHint:c})}({hostConfig:n,dependencySynthesizer:u});u.registerIfNotAlreadyExists(On,e),m=e}const f=await m.instantiateFluidCodeLoader({windowContext:e,dependencySynthesizer:u});if(C()){const e=await s.documentServiceFactory;s.documentServiceFactory=await Promise.all([r.e(87212),r.e(6747)]).then(r.bind(r,43390)).then((t=>{let{FluidDebugger:r}=t;return r.createFromServiceFactory(e)}))}let y,b;if("Existing"===t.type&&(y=t.containerCodeHint),y){if(l&&(0,o.Ot)(l,{eventName:k.Ug}),void 0===n.loadCodeFromHint||n.loadCodeFromHint){const e=v.m.start(k.Qn,l,{addUserTiming:!0});f.load({package:y}).then((()=>{e.setResult(!0)})).catch((t=>{e.setResult(!1,void 0,t)}))}(function(e){return"preCache"in e&&!!e.preCache})(f)&&(null===d||void 0===d||d.addAdditionalProps({precachedContainerPackageName:qr(y)}),f.preCache(y).catch((e=>{l&&(0,o.hO)(l,{eventName:k.TK},e)})))}p&&(b=new on(p));const S={urlResolver:await s.urlResolver,documentServiceFactory:await s.documentServiceFactory,options:n.loaderOptions,scope:{IFluidDependencySynthesizer:u},codeLoader:f,detachedBlobStorage:n.detachedBlobStorage,logger:c,configProvider:b};return new dr(S)}async function An(e,t,r,n,o){const i={[ur.loadMode]:{opsBeforeReturn:"cached",deltaConnection:r.startContainerInPausedState?"none":"delayed"}};let s,a;const c=e.services.codeLoader;switch(t.type){case"Existing":{const n=t.containerRequest,o={url:n.url,headers:{...i,...n.headers}};a=t.containerCodeHint,s=e.resolve(o,r.pendingLocalState);break}case"DetachedFromCode":{const r=xn()||t.codeDetails;a=wn(r),s=e.createDetachedContainer(r);break}case"DetachedFromSnapshot":s=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return Dn(a,o),s.then((async e=>{!0===r.closeBeforeDisposing&&e.once("closed",(()=>e.dispose())),r.startContainerInPausedState||ne(e);const i=e.getSpecifiedCodeDetails(),s=i&&wn(i);if("DetachedFromSnapshot"===t.type&&Dn(s,o),null===n||void 0===n||n.addAdditionalProps({containerPackageMatchedCodeHint:a===s}),e.deltaManager.active)Bn(e,c);else{const t=()=>{e.deltaManager.active&&(Bn(e,c),e.off("connected",t))};e.on("connected",t)}})).catch((()=>{})),s}const Rn="ContainerLoadFailed",Mn="ComponentLoadFailedOnContainerBoot";class _n extends Error{constructor(){super("The container could not be loaded because its hosting window has already been unloaded."),this.errorType=k._H,this.name=k._H}}async function zn(e,t,r,n,o,i){const s=v.m.start(k.F7,n,{addUserTiming:!0});return t.then((async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await An(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},r,void 0,n);s.markSubActivityEnd("TemplateLoadContainer"),await async function(e){if(e.closed)throw new Re.eb("waitContainerToCatchUp: Container closed");return new Promise(((t,r)=>{const n=e.deltaManager,o=t=>{e.off("closed",o);const n="Container closed while waiting to catch up";r(void 0!==t?(0,we.J4)(t,(e=>new Re.gn("".concat(n,": ").concat(e)))):new Re.gn(n))};e.on("closed",o);const i=()=>{(0,Se.v)(e.connectionState===ee.CatchingUp||e.connectionState===ee.Connected,205);const r=n.hasCheckpointSequenceNumber,i=n.lastKnownSeqNumber;if((0,Se.v)(n.lastSequenceNumber<=i,614),n.lastSequenceNumber===i)return e.off("closed",o),void t(r);const s=a=>{i<=a.sequenceNumber&&(e.off("closed",o),t(r),n.off("op",s))};n.on("op",s)};if(e.connectionState===ee.Connected)return void i();const s=()=>{e.off(Je.Tg,s),i()};e.on(Je.Tg,s),e.connectionState===ee.Disconnected&&e.connect()}))}(a),s.markSubActivityStart("TemplateLoadComponent");return xe(a,t.services.urlResolver,{url:e.fromExistingTemplateUrl},n,o,i,r.startContainerInPausedState).then((async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),null===e||void 0===e||!e.ComponentSerializable)throw new B.Ej("Component doesn't implement ComponentSerializable",k.ul);try{const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}catch(t){throw new B.Ej("Component serialization failed",k.ii,t)}})).finally((()=>{a.dispose()}))})).catch((e=>{throw s.setResult(!1,void 0,e),e.name=e.name||k.uT,e}))}function Hn(e){let{windowContextForLoader:t,driverFetcher:r,dependencySynthesizer:n,hostConfig:o,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:c,driver:l,preCheckInfo:d,requiredProviderTypes:u}=e;Gn(l,r,o,n);const h={type:"Existing",containerRequest:c,containerCodeHint:null===d||void 0===d?void 0:d.codeDetailsHint},{containerPromise:g,componentPromise:p}=l?qn(t,h,l,c,n,o,i,s,a,u,void 0):jn(t,h,r,c,n,o,i,s,a,u,void 0);return{container:g,component:p}}function Un(e,t,r,n,o,i,s,a){Gn(r,n,o,t.dependencySynthesizer);const{componentPromise:c,containerPromise:l}=r?qn(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},r,void 0,t.dependencySynthesizer,o,i,s,a,t.requiredProviderTypes,t.loadTemplateProps):jn(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},n,void 0,t.dependencySynthesizer,o,i,s,a,t.requiredProviderTypes,t.loadTemplateProps);return{component:c,container:l}}function jn(e,t,r,n,o,i,s,a,c,l,d){const u=new L.c,h=new L.c;return async function(){const t=v.m.start(k.ih,s,{addUserTiming:!0}),n={...a,documentEverHidden:(0,y.xl)(c)>-1},{driverImplementationOverride:l}=i;if(l)return t.setResult(!0,{...n,driverType:"Override"}),l;const{DriverImplementation:d,FluidDocumentServiceFactoryProvider:u,FluidUrlResolverProvider:h}=o.synthesize({DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0),[g,p,m]=await Promise.all([d,null===h||void 0===h?void 0:h.then((e=>null===e||void 0===e?void 0:e.urlResolver)),null===u||void 0===u?void 0:u.then((e=>null===e||void 0===e?void 0:e.documentServiceFactory))]);if(g)return t.setResult(!0,{...n,driverType:"SynthesizedLegacy"}),g;if(p&&m)return t.setResult(!0,{...n,driverType:"Synthesized"}),{documentServiceFactory:m,urlResolver:p};if(r){const{type:a,impl:c}=await r(e,o,i,s);return t.setResult(!0,{...n,driverType:a}),c}const f=new Error("Driver unavailable");throw t.setResult(!1,n,f),f}().then((async r=>{const g=qn(e,t,r,n,o,i,s,a,c,l,d);u.resolve(g.containerPromise),h.resolve(g.componentPromise)})).catch((e=>{u.reject(e),h.reject(e)})),{containerPromise:u,componentPromise:h}}function qn(e,t,r,n,i,s,a,c,u,h,g){var p,m;const f=c.fluidBootstrapperStartTime,b="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type};let S=n;const C=b&&{additionalPropsToLog:b}||void 0,w=i.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider"},void 0);let P;null===(p=w.SettingsProvider)||void 0===p||p.then((e=>{P=a&&new d(a,e)})).catch((e=>{a&&(0,o.hO)(a,{eventName:"FailedToStartHeartbeat"},{errorType:"SettingsProviderFetchFailed",...e})})),Promise.resolve(w.InternationalizationContext).then((e=>{a&&(0,o.Ot)(a,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:(null===e||void 0===e?void 0:e.uiLocale)||A.q})})).catch((()=>{}));const E=v.m.start(k.bU,a,{addUserTiming:!0,...C});a&&function(e){var t;const r=null===(t=navigator)||void 0===t?void 0:t.connection;(0,o.Ot)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:null===r||void 0===r?void 0:r.effectiveType,networkRoundTripTime:null===r||void 0===r?void 0:r.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:(0,R.Fr)(),timeStamp:Date.now()})}(a);const T=a&&new re(a,c,u),I=v.m.start(k.tR,a,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),N=Ln(e,t,s,r,i,T,a,I),F=Promise.all([N,w.SettingsProvider]).then((e=>{let[r,n]=e;return l(n)&&"Existing"===t.type?async function(e,t,r,n){let o=t;const i=(0,D.pW)({logger:n,namespace:"LocationRedirection"});for(;;)try{return await e(o)}catch(vt){if(!O(vt))throw vt;i.sendTelemetryEvent({eventName:"LocationRedirectionError"});const t=vt.redirectUrl;o={url:await r.getAbsoluteUrl(t,"",void 0),headers:o.headers}}}((async e=>(t.containerRequest=e,S=e,An(r,t,s,I,a))),t.containerRequest,r.services.urlResolver,T):An(r,t,s,I,a)})).then((t=>{if(e.closed)throw function(e,t){t&&e.close(),e.dispose()}(t,!0===s.closeBeforeDisposing),new _n;return t}));F.then((e=>{a&&Y(e,a);const t=(0,y.xl)(u),r=I.startTimeSinceEpoch;I.setResult(!0,{...c,offsetFromFluidBootstrapperStartTime:(0,_.q)(r,f),documentEverHidden:t>-1})})).catch((e=>{I.setResult(!1,{errorType:e.errorType},e),E.setResult(!1,{errorType:e.errorType||Rn,isUserImpacting:!0},e),a&&Q(a,k.bU,H,j,e.errorType||q,{},e)}));const L=F.then((e=>{if(!e)throw E.setResult(!1),a&&Q(a,k.bU,H,j,G),new Error("Failed to Load Container");const t=N.then((t=>xe(e,t.services.urlResolver,S,a,c,u,s.startContainerInPausedState,i)));let r=t;if(null!==g&&void 0!==g&&g.fromExistingTemplateUrl){const e=zn(g,N,s,a,c,u);r=t.then((t=>{const r=t.ComponentSerializable;if(!r)throw new B.Ej("Component doesn't implement ComponentSerializable",k.ul);let n;return e.then((async e=>{if(n=v.m.start(k.P,a,{addUserTiming:!0}),void 0===e)throw new Error(k.md);return await r.rehydrate(e),n.setResult(!0),t})).catch((e=>{var t;throw null===(t=n)||void 0===t||t.setResult(!1,void 0,e),e}))}))}return r=r.then((t=>{if(h){var r;const n=i.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return ce(t,e,h,n.FluidDocumentServiceFactoryProvider,null===(r=S)||void 0===r?void 0:r.url)}return t})),r.then((()=>{E.setResult(!0)})).catch((t=>{e.dispose(),E.setResult(!1,{errorType:t.errorType||"Error"!==t.name?t.name:Mn,isUserImpacting:!0,isExpected:x(t)},t),a&&Q(a,k.bU,H,j,t.errorType||t.name||q,{},t)})),r})),M={container:F,component:L};return null===(m=P)||void 0===m||m.registerSessionEndingErrorObserver(M),{containerPromise:F,componentPromise:L}}const Vn=new Error("Invalid configuration for driver. Please provide either a driver, driverFetcher, or driverImplementationOverride.");function Gn(e,t,r,n){const o=e||t||r.driverImplementationOverride||function(e){return e.has("DriverImplementation")||["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"].every((t=>e.has(t)))}(n);if(!o)throw Vn}var Wn=r(73905),Kn=r(55863),Jn=r(3221);async function Qn(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const r=e.data.url,n=await t;if(!n||n instanceof Wn.Y||n instanceof Kn.s)return function(e){const t=(0,Jn.Mh)(e);if(!t)return;let r;try{null!==t&&void 0!==t&&t.siteUrl&&(r=new URL(null===t||void 0===t?void 0:t.siteUrl).origin)}catch{}return{codeDetailsHint:null===t||void 0===t?void 0:t.containerPackageName,criticalBootDomains:r?[r]:void 0}}(r);try{const e=await n.resolve({url:r.href});if("fluid"===(null===e||void 0===e?void 0:e.type))return{}}catch(o){}}const Xn=e=>{if(void 0!==e.hostLocaleContext)return{get InternationalizationContext(){return this},uiLocale:e.hostLocaleContext.uiLanguage,defaultContentDirection:e.hostLocaleContext.defaultContentDirection}},Zn=(e,t)=>{var r;return t.audience?t:{get SettingsProvider(){return this},getSetting:(e,r,n)=>t.getSetting(e,r,n),audience:null!==(r=e.environment)&&void 0!==r&&r.audience?e.environment.audience:"audience"in e?e.audience:"Production"}},$n=/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/g,Yn=e=>{var t;const r=e.userContext.user,n=null!==(t=null===r||void 0===r?void 0:r.id)&&void 0!==t?t:null===r||void 0===r?void 0:r.oid,o=function(e,t){return t||(e&&(e=>{const t=e.match($n);return 1===(null===t||void 0===t?void 0:t.length)&&t[0].length===e.length})(e)?"UserObjectId":function(e){const t=/[1-2]{1}[0-9a-fA-F]{15}/g;return null===e||void 0===e?void 0:e.match(t)}(e)?"OrgIdPuid":void 0)}(n,null===r||void 0===r?void 0:r.userIdSpace);if(void 0!==r&&void 0!==n&&void 0!==o)return{get UserContext(){return this},user:{id:n,tenantId:r.tenantId,userIdSpace:o},displayName:e.userContext.displayName}};const eo=(e,t)=>{var r,n,o;return null!==t&&void 0!==t&&t.hostCorrelationId&&t.hostSessionId&&t.scenarioStartTime?t:{get TelemetryConfig(){return this},disallowServiceTelemetry:null===t||void 0===t?void 0:t.disallowServiceTelemetry,hostCorrelationId:null!==(r=null===t||void 0===t?void 0:t.hostCorrelationId)&&void 0!==r?r:e.hostCorrelationId,hostSessionId:null!==(n=null===t||void 0===t?void 0:t.hostSessionId)&&void 0!==n?n:e.hostSessionId,scenarioStartTime:null!==(o=null===t||void 0===t?void 0:t.scenarioStartTime)&&void 0!==o?o:e.hostScenarioStartTime}};class to{async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:r}=this.props,{registrationId:n}=e;if(!n)throw new Error("registrationId is required.");const i=await t.load({packageName:n}),s=new Fn(r,!0);this.logger&&s.register("NamespaceLogger",this.logger);const a="Data"===e.type?{creationData:e,manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:"Creation"===e.type?{creationData:{},manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:e;return i.module.loopExport.instantiateLoopComponent(a,await async function(e){if(!e.has("HostContext"))return e;const t=e.synthesize({HostContext:"HostContext"},void 0),r=await t.HostContext;if(r){const t={get HostContext(){return this},environment:r.environment,hostCorrelationId:r.hostCorrelationId,hostSessionId:r.hostSessionId,userContext:r.userContext,hostLocaleContext:r.hostLocaleContext,hostName:"",hostScenarioLifecycle:void 0,hostScenarioEntryPoint:void 0,hostScenarioName:void 0,hostAppVersion:void 0,hostScenarioStartTime:void 0,hostPerformanceData:void 0,hostAppName:"",hostAppPlatform:"",hostLoopContext:void 0,get Disposable(){return this},dispose(){}},n=new Fn(e,!0);return n.register("HostContext",t),n}return e}(await(async(e,t)=>{const r=await(null===e||void 0===e?void 0:e.synthesize({SettingsProvider:"SettingsProvider"},void 0).SettingsProvider),n=Nn(e,!0);if(!n.has("HostContext"))return n;const i=n.synthesize({HostContext:"HostContext",TelemetryConfig:"TelemetryConfig"},void 0),[s,a]=await Promise.all([i.HostContext,i.TelemetryConfig]),c=r,l=[];if(s){if(!n.has("InternationalizationContext")){const e=Xn(s);void 0!==e&&(l.push("InternationalizationContext"),n.register("InternationalizationContext",e))}if(!n.has("UserContext")){const e=Yn(s);e&&(l.push("UserContext"),n.register("UserContext",e))}n.has("SettingsProvider")&&c&&void 0===c.audience&&(l.push("SettingsProvider"),n.register("SettingsProvider",Zn(s,c))),null!==a&&void 0!==a&&a.hostCorrelationId&&a.hostSessionId||(l.push("TelemetryConfig"),n.register("TelemetryConfig",eo(s,a)))}return t&&l.length>0&&(0,o.yL)(t,{eventName:"GetFromDeprecatedHostContext",deprecatedInterfaces:l.toString()},null===r||void 0===r?void 0:r.audience),n})(s,this.logger)))}constructor(e){this.props=e,e.logger&&(this.logger=new i.p("LoopLoader",e.logger))}}async function ro(e){const{loopComponentRouterInput:t,windowContextForLoader:r,dependencySynthesizer:n,config:o,logger:i,loopCodeLoaderFactory:s,requiredProviderTypes:a}=e,c=await async function(e,t,r,n,o){const{environment:i}=e,s=r.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[a,c,l,d]=await Promise.all([s.InternationalizationContext,s.SettingsProvider,s.TokenProvider,s.LoopTrustedTypesPolicy]),u=null===a||void 0===a?void 0:a.uiLocale,h={audience:(null===i||void 0===i?void 0:i.audience)||"Production",localeHint:u||A.q,settingsProvider:c,windowContext:t,trustedTypesPolicy:d,tokenProvider:l,dependencySynthesizer:r,logger:n},g=await o.instantiateLoopCodeLoader(h);return new to({loopCodeLoader:g,dependencySynthesizer:r,logger:n})}(o,r,n,i,s),l=await c.instantiateLoopComponent(t);if(a){return ce(l,void 0,a,n.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0).FluidDocumentServiceFactoryProvider,void 0)}return l}const no="fluid";function oo(e){return e===no||"fluid-odsp"===e}async function io(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:n,driver:o,urlResolver:i,config:s={},logger:a,perfMetadata:c,documentHiddenTrackerId:l,fluidRequestHeaders:d,loopCodeLoaderFactory:u}=e,{registrationId:h,manifestData:g}=r;if(h&&!oo(h)){let e=u;if(!e){const t={LoopCodeLoaderFactoryProvider:"LoopCodeLoaderFactoryProvider"},{LoopCodeLoaderFactoryProvider:r}=n.synthesize(t,void 0),o=await r;e=await(null===o||void 0===o?void 0:o.getLoopCodeLoaderFactory())}if(!e)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");return{component:ro({loopComponentRouterInput:r,windowContextForLoader:t,dependencySynthesizer:n,config:s,logger:a,loopCodeLoaderFactory:e}),container:Promise.resolve(void 0)}}if("Data"===r.type&&"URL"===r.dataType){let e;var p;if(h&&oo(h)&&(e=g&&"object"===typeof g?g:void 0),!e)e=await Qn(r,null!==(p=null!==i&&void 0!==i?i:null===o||void 0===o?void 0:o.urlResolver)&&void 0!==p?p:async function(e){var t;const{dependencySynthesizer:r,config:n}=e;if(null!==n&&void 0!==n&&n.driverImplementationOverride)return n.driverImplementationOverride.urlResolver;const o={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider"},{DriverImplementation:i,FluidUrlResolverProvider:s}=r.synthesize(o,void 0),[a,c]=await Promise.all([i,s]);return null!==(t=null===a||void 0===a?void 0:a.urlResolver)&&void 0!==t?t:null===c||void 0===c?void 0:c.urlResolver}({dependencySynthesizer:n,config:s}));if(!e)throw new Error("Failed to create Fluid component from the provided url.");Dn(e.codeDetailsHint,a);return Hn({windowContextForLoader:t,driverFetcher:void 0,dependencySynthesizer:n,hostConfig:s,logger:a,perfMetadata:c,documentEverHiddenTrackerID:l,containerRequest:{url:r.data.url.href,headers:d},driver:o,preCheckInfo:e})}throw new Error("Failed to create component.")}function so(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,documentServiceFactory:n,urlResolver:o,config:i,fluidRequestHeaders:s,loopCodeLoaderFactory:a,requiredProviderTypes:c,returnProviderPromise:l}=e;const{logger:d,newConfig:u,perfMetadata:h,documentHiddenTrackerId:g}=w(i||{}),p=ao({windowContextForLoader:window,loopComponentRouterInput:t,dependencySynthesizer:r,documentServiceFactory:n,urlResolver:o,config:u,logger:d,perfMetadata:h,documentHiddenTrackerId:g,fluidRequestHeaders:s,loopCodeLoaderFactory:a,requiredProviderTypes:c});return l?Promise.all([p.container,p.component]).then((e=>{let[t,r]=e;return r})):p}function ao(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:n,documentServiceFactory:i,urlResolver:s,config:a,logger:l,perfMetadata:d,documentHiddenTrackerId:u,requiredProviderTypes:h}=e,g=i&&s?{documentServiceFactory:i,urlResolver:s}:void 0,p={...a},m=v.m.start(k.m1,l,{addUserTiming:!0}),b=function(e){if(e.has("LoopComponentLoader"))return e;const t=new f.h(e);return t.register("LoopComponentLoader",function(){return{get LoopComponentLoader(){return this},async getLoopComponent(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,fluidRequestHeaders:n,requiredProviderTypes:o}=e;const i=await r.synthesize({NamespaceLogger:"NamespaceLogger"},void 0).NamespaceLogger,s=ao({windowContextForLoader:window,loopComponentRouterInput:t,dependencySynthesizer:r,logger:i,perfMetadata:{fluidBootstrapperStartTime:Date.now()},documentHiddenTrackerId:(0,y.yb)(),fluidRequestHeaders:n,requiredProviderTypes:o});return Promise.all([s.container,s.component]).then((e=>{let[t,r]=e;return r}))},get Disposable(){return this},dispose(){}}}()),t}(n);if("Fluid"===r.type){if(null!==l&&void 0!==l&&l.PersistedProperties){const e={isFluid:!0};l.PersistedProperties.addPersistedProperties(e)}const e=wn(r.codeDetails);Dn(e,l);try{const n=Un(t,{dependencySynthesizer:b,codeDetails:r.codeDetails,loadTemplateProps:r.templateProps,requiredProviderTypes:h},g,void 0,p,l,d,u);return m.setResult(!0,{packageName:e}),n}catch(vt){throw m.setResult(!1,{packageName:e},vt),vt}}const S=io({...e,driver:g,loopComponentRouterInput:r});if(null!==l&&void 0!==l&&l.PersistedProperties){const{registrationId:e}=r,t=!e||oo(e),n=(0,y.xl)(u),o=t?{isFluid:!0,documentEverHidden:n}:{isFluid:!1,loopRegistrationId:e,documentEverHidden:n};l.PersistedProperties.addPersistedProperties(o)}return{component:S.then((async e=>{const[t,n]=await Promise.all([e.container,e.component]);await async function(e,t,r){const n=e;if(!n.ComponentInitializer)return;const o=r.synthesize({SettingsProvider:"SettingsProvider"},void 0),i=await o.SettingsProvider;c(i)&&(t.markSubActivityStart("ComponentInitialize"),await n.ComponentInitializer.initialize(),t.markSubActivityEnd("ComponentInitialize"))}(n,m,b);const i=lo(n);null!==l&&void 0!==l&&l.PersistedProperties&&i&&l.PersistedProperties.addPersistedProperties({identityName:i}),m.setResult(!0),l&&function(e,t,r){const n=lo(e);n&&!co.has(n)&&((0,o.Ot)(r,{eventName:"LoadComponentMetadata",identityName:n,source:t}),co.add(n))}(n,"owh-getLoopComponentInternal",l);const s=t&&"Data"===r.type&&"URL"===r.dataType?r.data.url.href:void 0;if(h){const e=b.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return ce(n,t,h,e.FluidDocumentServiceFactoryProvider,s)}return n})).catch((e=>{throw m.setResult(!1,void 0,e),e})),container:S.then((e=>e.container)).catch((e=>{throw m.setResult(!1,void 0,e),e}))}}const co=new Set;function lo(e){var t;return null===(t=e.ComponentTelemetryMetadata)||void 0===t?void 0:t.entityName}function uo(e){const{logger:t,newConfig:r,perfMetadata:n,documentHiddenTrackerId:o}=w(e.config||{}),i=function(e,t,r,n,o,i,s,a){Gn(r,n,o,t.dependencySynthesizer);const{componentPromise:c,containerPromise:l}=r?qn(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},r,void 0,t.dependencySynthesizer,o,i,s,a,t.requiredProviderTypes,void 0):jn(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},n,void 0,t.dependencySynthesizer,o,i,s,a,t.requiredProviderTypes,void 0);return{component:c,container:l}}(window,e,e.urlResolver&&e.documentServiceFactory?{urlResolver:e.urlResolver,documentServiceFactory:e.documentServiceFactory}:void 0,void 0,r,t,n,o);return e.returnProviderPromise?Promise.all([i.container,i.component]).then((e=>{let[t,r]=e;return r})):i}var ho=r(58443),go=r(13296),po=r(56142),mo=r(16460),fo=r(91947);class vo{constructor(e,t){this.isProvidingDataToSave=void 0,this.hasDataToSave=void 0,this.component=void 0,this.isProvidingDataToSave=!1,this.hasDataToSave=e,this.component=t}async startProvidingDataToSave(){this.isProvidingDataToSave||((0,po.Rm)("Will start providing data to save..."),(0,mo.tM)((e=>{(0,po.Rm)("RequestDataToSave event"),this.onDataToSaveRequest(e)})),(0,mo.U4)((()=>{(0,po.Rm)("FluidComponentSaved event"),this.onFluidComponentDataSaved()})),await(0,fo.UT)(!0),this.isProvidingDataToSave=!0,this.hasDataToSave||this.detectWhenFluidComponentIsEdited())}async stopProvidingDataToSave(){this.isProvidingDataToSave&&((0,po.Rm)("Will stop providing data to save..."),await(0,fo.UT)(!1),(0,mo.DS)(this.onDataToSaveRequest),(0,mo.Yz)(this.onFluidComponentDataSaved),this.isProvidingDataToSave=!1)}async onDataToSaveRequest(e){var t;const r=e.detail.requestId;let n=!1,o="";const i=await(null===(t=this.component.LoopComponentUrl)||void 0===t?void 0:t.getLoopComponentUrl());let s=!1;var a,c;if(i&&(s=!0),s)n=null!==(a=null===(c=this.component.ComponentLifecycle)||void 0===c?void 0:c.isDirty)&&void 0!==a&&a;else try{this.component.LoopComponentUrl&&this.component.FluidMetadataProvider&&(o=this.component.FluidMetadataProvider.getSnapshot()),n=o.length>0}catch(l){(0,u.c2)("DataToSaveProvider.onDataToSaveRequest()",new u.uV("Unable to get data to save from the container.",l))}(0,fo.a7)(r,s,n,o).then((()=>{(0,po.Rm)("Provided data to save. (Request: ".concat(r,", isAttached: ").concat(s,", hasDataToSave: ").concat(n,")"))})).catch((e=>{(0,po.vV)("Unable to provide data to save. (Request: ".concat(r,") ").concat(e))}))}onFluidComponentDataSaved(){(0,po.Rm)("Fluid component was saved."),this.hasDataToSave=!1,this.detectWhenFluidComponentIsEdited()}fluidComponentEdited(){this.hasDataToSave||((0,po.Rm)("Fluid component was edited, so there is now data to save."),this.hasDataToSave=!0,(0,fo.nA)())}detectWhenFluidComponentIsEdited(){const e=t=>{t.defaultPrevented||(0,go.wP)(t)&&(document.removeEventListener("keydown",e),document.removeEventListener("mousedown",e),this.fluidComponentEdited())};document.addEventListener("keydown",e),document.addEventListener("mousedown",e)}}var yo=r(64643),bo=r(33829),So=r(20967),Co=r(98123),ko=r(6971);class wo{constructor(e,t,r,n){this.component=e,this.loopInfo=t,this.isFluidLoop=r,this.officeFluidLogger=n,this.loopInfoChangedEventListeners=new Set,this.hasBeenUpdated=!1,this.currentLinkScope=void 0}determineLinkText(e,t,r){return e?r?r+ho.Ct:t:r||t}off(e,t){this.loopInfoChangedEventListeners.delete(t)}on(e,t){this.loopInfoChangedEventListeners.add(t)}async onLinkUrlChanged(e,t){if((0,po.Rm)("Received native event LinkUrlChanged"),e!==this.loopInfo.linkUrl){if("@fluidx/video-playback"===this.loopInfo.registrationId){const t=await(0,ko.E)();e=(0,Co.addReferralParamsToStreamUrl)(e,t.hydrateScenarioEntryPoint)}(0,po.Rm)("Link url: ".concat(e)),this.loopInfo.linkUrl=e,this.onLoopInfoChanged({linkUrl:e})}if(t&&t!==this.currentLinkScope){const e=void 0!==this.currentLinkScope;if(this.currentLinkScope=t,(0,po.Rm)("link scope: ".concat(t,", isUpdate: ").concat(e)),this.officeFluidLogger){p._.startActivity(this.officeFluidLogger,m.G.CreateShareLink).setSuccess({linkScope:t,isUpdate:e})}}}onLoopInfoChanged(e){Object.keys(e).length&&(this.loopInfoChangedEventListeners.forEach((t=>{t(new CustomEvent("LoopInfoChanged",{detail:e}))})),(0,fo.a5)(e))}onTitleChanged(e){const t={};(0,po.Rm)("LoopComponentProperties.onTitleChanged() called."),e&&e!==this.loopInfo.loopTitle&&((0,po.Rm)("Loop title: ".concat(e)),this.loopInfo.loopTitle=e,t.loopTitle=e);const r=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);r&&r!==this.loopInfo.linkText&&((0,po.Rm)("Link text: ".concat(r)),this.loopInfo.linkText=r,t.linkText=r),this.onLoopInfoChanged(t)}async updateFluidFilename(){if(!this.isFluidLoop||!this.loopInfo.linkUrl)return;const e=await(0,So.Wu)(this.loopInfo.linkUrl,this.loopInfo.linkText||null),t=(0,So.$r)(e||"");this.onTitleChanged(t)}async update(){const e=this.component.ComponentProperties,t=this.component.ComponentTitle,n=this.component.ComponentWithTitle,o=this.component.ContentURL,i={};if(o)try{const e=await o.getContentURL();e.href&&e.href!==this.loopInfo.linkUrl&&((0,po.Rm)("Link url: ".concat(e.href)),this.loopInfo.linkUrl=e.href,i.linkUrl=e.href)}catch(l){(0,po.vV)("Unable to get the content url for the Loop component.")}if(e){try{var s;let t;if("@fluidx/video-playback"===this.loopInfo.registrationId){t=(await r.e(27443).then(r.bind(r,27443))).StreamLogo}else t=e.iconUrl||await(null===(s=e.getIconUrl)||void 0===s?void 0:s.call(e));t&&t!==this.loopInfo.loopIconUrl&&((0,po.Rm)("Loop icon url: ".concat(t)),this.loopInfo.loopIconUrl=t,i.loopIconUrl=t)}catch(l){(0,po.vV)("Unable to get the icon url of the Loop component.")}try{var a;const t=e.name||await(null===(a=e.getName)||void 0===a?void 0:a.call(e));t&&t!==this.loopInfo.loopName&&((0,po.Rm)("Loop name: ".concat(t)),this.loopInfo.loopName=t,i.loopName=t)}catch(l){(0,po.vV)("Unable to get the name of the Loop component.")}}if((t||n)&&(void 0===t&&((0,po.Rm)("Component does not provide ComponentTitle."),n&&(0,po.Rm)("Using ComponentWithTitle instead.")),!this.isFluidLoop))try{const e=(null===t||void 0===t?void 0:t.title)||await(null===n||void 0===n?void 0:n.getTitleText());e&&e!==this.loopInfo.loopTitle&&((0,po.Rm)("Loop title: ".concat(e)),this.loopInfo.loopTitle=e,i.loopTitle=e)}catch(l){(0,po.vV)("Unable to get the title of the Loop component.")}const c=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);c&&c!==this.loopInfo.linkText&&((0,po.Rm)("Link text: ".concat(c)),this.loopInfo.linkText=c,i.linkText=c),this.onLoopInfoChanged(i),this.hasBeenUpdated||((0,bo.As)(this.onLinkUrlChanged.bind(this)),null===t||void 0===t||t.on("titleChanged",(e=>{(0,po.Rm)("Received event ComponentTitle.titleChanged"),this.onTitleChanged(e)}))),this.hasBeenUpdated=!0}}var Po=r(4311),Eo=r(24921),To=r(53450),Io=r(51655);let No=function(e){return e[e.Success=0]="Success",e[e.Failure=1]="Failure",e}({});class Fo extends To.r{constructor(e){super("CreateDocument",e),this.AttachDocumentPerfTracker=void 0,this.CreateDocumentPerfTracker=void 0,this.setAttachDocumentPerfTracker()}setAttachDocumentPerfTracker(){const e=Io.q.startNew();this.AttachDocumentPerfTracker=e}setCreateDocumentPerfTracker(){const e=Io.q.startNew();this.CreateDocumentPerfTracker=e}sendTelemetryForSuccess(){this.endActivity(!0,No.Success)}sendTelemetryForFailure(e){this.endActivity(!1,e)}async addDataFieldsToActivity(e,t){var r,n,o,i;(null===(r=this.AttachDocumentPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("AttachDocumentStartTime",this.AttachDocumentPerfTracker.startTime),(null===(n=this.AttachDocumentPerfTracker)||void 0===n?void 0:n.getDuration)&&this.addInt64DataField("AttachDocumentDuration",this.AttachDocumentPerfTracker.getDuration()),this.AttachDocumentPerfTracker&&this.addBooleanDataField("AttachDocumentSuccess",this.AttachDocumentPerfTracker.isSuccess),(null===(o=this.CreateDocumentPerfTracker)||void 0===o?void 0:o.startTime)&&this.addInt64DataField("CreateDocumentStartTime",this.CreateDocumentPerfTracker.startTime),(null===(i=this.CreateDocumentPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("CreateDocumentDuration",this.CreateDocumentPerfTracker.getDuration()),this.CreateDocumentPerfTracker&&this.addBooleanDataField("CreateDocumentSuccess",this.CreateDocumentPerfTracker.isSuccess),this.addStringDataField("ResultType",No[e]),t&&this.addStringDataField("ErrorMessage",t)}}var Do=r(97232),Oo=r(29369),Bo=r(54362);async function xo(e,t,r,n,o,i){(0,po.Rm)("Attaching document..."),await async function(e,t,r,n){var o,i;const s=(0,h.n_)(h.u.OEP,"FluidHost.AttachDelay",0),a=r?p._.startActivity(r,m.G.AttachContainer):void 0,c=await s;c>0&&await(0,Eo.y)(c);const l=n;null!==(o=l.LoopComponentUrl)&&void 0!==o&&o.initializeLoopComponentUrl&&await l.LoopComponentUrl.initializeLoopComponentUrl(e).catch((e=>{var r,n;throw null===(r=l.Disposable)||void 0===r||r.dispose(),null===(n=t.AttachDocumentPerfTracker)||void 0===n||n.setFailure(e),null===a||void 0===a||a.setFailure(e),new Error("Unable to attach document.")})),null===(i=t.AttachDocumentPerfTracker)||void 0===i||i.setSuccess(),null===a||void 0===a||a.setSuccess()}(t,n,r,e),(0,po.Rm)("Document attached."),n.setCreateDocumentPerfTracker();try{const s=await async function(e,t,r){var n,o;const i=r?p._.startActivity(r,m.G.GetFileLink):void 0,s=await(null===(n=e.LoopComponentUrl)||void 0===n?void 0:n.getLoopComponentUrl().catch((r=>{var n,o;throw null===(n=e.Disposable)||void 0===n||n.dispose(),null===(o=t.CreateDocumentPerfTracker)||void 0===o||o.setFailure(r),null===i||void 0===i||i.setFailure(r),new Error("Unable to get the url of the new Fluid component. ".concat((0,u.u1)(r)))})));if(!s){var a,c;null===(a=e.Disposable)||void 0===a||a.dispose();const r=new Error("Unable to get the absolute url from the component.");throw null===i||void 0===i||i.setFailure(r),null===(c=t.CreateDocumentPerfTracker)||void 0===c||c.setFailure(r),r}return null===(o=t.CreateDocumentPerfTracker)||void 0===o||o.setSuccess(),null===i||void 0===i||i.setSuccess(),s}(e,n,r);let c="";try{c=await(0,Po.RG)(s)}catch(a){(0,po.vV)("Unable to get file name from Sharepoint.")}c||(c=t),(0,po.Rm)('Document created.\nFile name: "'.concat(c,'"\nUrl: ').concat(s));const l=null===o||void 0===o?void 0:o.resolve({url:s.href,headers:i.headers});if(await(0,h.cn)()){const t={linkText:c,linkUrl:s.toString()},o=new wo(e,t,!0,r);await o.update();return{loopComponentProperties:o,createDocumentActivity:n,resolvedUrlPromise:l}}return{url:s.toString(),linkText:c,createDocumentActivity:n,resolvedUrlPromise:l}}catch(a){var s;throw null===n||void 0===n||null===(s=n.CreateDocumentPerfTracker)||void 0===s||s.setFailure(a),new Error("Unable to create document.")}}async function Lo(e,t,r,n,o,i,s,a,c,l,d,f){var v,y;let b;const S=function(e){if(e===ho.l1)return!1;return!0}(e),C=!S||await(0,h.qF)(),k=await(0,h.cn)(),P=await h.LM,E=a?p._.startActivity(a,m.G.GetDriveInfo):void 0,T=new Fo(n||""),I=await(0,Po.fZ)().catch((e=>{var t;throw null===(t=T.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),null===E||void 0===E||E.setFailure(e),new Error("Unable to get driver info.")}));null===E||void 0===E||E.setSuccess();const N=await t.catch((e=>{var t;throw null===(t=T.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")}));if(l){const e=await l;s.register("FluidDocumentServiceFactoryProvider",function(e){let{documentServiceFactory:t,createDocumentRequest:r}=e;return{get FluidDocumentServiceFactoryProvider(){return this},documentServiceFactory:t,getCreateDocumentRequest:r,get Disposable(){return this},dispose:()=>{}}}({documentServiceFactory:e,createDocumentRequest:async e=>function(e,t,r,n,o){const i=function(e){if(!e)return;const t=e.scope;if(!t)return"createLinkType=".concat(e);let r="createLinkScope=".concat(t);const n=e.role;return r=n?"".concat(r,"&createLinkRole=").concat(n):r,r}(o);return{url:"".concat(e,"?driveId=").concat(encodeURIComponent(t),"&path=").concat(encodeURIComponent(r)).concat(i?"&".concat(i):""),headers:{[Bo.U2.createNew]:{fileName:n}}}}(I.siteUrl,I.id,N,e)}))}if(e){const t=o.environment,r=i.uiLanguage;if(C){(0,po.Rm)("Creating Loop component...");const n=function(e){if(e===ho.l1)return"@ms/forms-loop";return""}(e),i=await async function(e,t,r,n,o,i){const s=!n||"@ms/office-fluid-container"==n;if(s){return{type:"Fluid",codeDetails:await Ao(e,t,r,o,i)}}return{type:"Creation",registrationId:n}}(e,t,r,n,a,c);b=so({urlResolver:d,config:o,dependencySynthesizer:s,loopCodeLoaderFactory:await(0,Oo.Zj)(n),loopComponentRouterInput:i,requiredProviderTypes:P?{...g,ComponentLifecycle:"ComponentLifecycle"}:void 0,returnProviderPromise:!0})}else{b=function(e){const{logger:t,newConfig:r,perfMetadata:n,documentHiddenTrackerId:o}=w(e.config||{}),i=window;Dn(wn(e.codeDetails),t);const s=Un(i,e,e.urlResolver&&e.documentServiceFactory?{urlResolver:e.urlResolver,documentServiceFactory:e.documentServiceFactory}:void 0,void 0,r,t,n,o);return e.returnProviderPromise?Promise.all([s.container,s.component]).then((e=>{let[t,r]=e;return r})):s}({codeDetails:await Ao(e,t,r,a,c),config:o,dependencySynthesizer:s,requiredProviderTypes:P?{...g,ComponentLifecycle:"ComponentLifecycle"}:void 0,returnProviderPromise:!0})}}else{b=uo({config:o,dependencySynthesizer:s,snapshot:await async function(){return await(0,fo.Y0)()}(),requiredProviderTypes:P?{...g,ComponentLifecycle:"ComponentLifecycle"}:void 0,returnProviderPromise:!0})}const F=await b,D=null===(v=F.FluidMetadataProvider)||void 0===v?void 0:v.getCodeDetails();let O,B;if(void 0===F)throw new u.uV("Unable to create Fluid component. The component is undefined.");if(S){const t=(await(0,yo.q)()).NewLoopComponentFileName,n=function(e,t){const r=e.replace(/[~#%&*{}\\:<>?/+|".]/g,"").trim();return t?function(e,t,r){const n=wn(e);return"".concat(t,"@ms/whiteboard-container"===n?".whiteboard":r?".fluid":".loop")}(t,r):((0,u.c2)("toFullSharepointFileName()",new u.uV("Using default extension since no code details provided.")),"".concat(r,".fluid"))}(r.trim()||t,D);if(void 0===d)throw new u.uV("url resolver must be defined for fluid loop");O=xo(F,n,a,T,d,f);B=new vo(!!e,F),B.startProvidingDataToSave().catch((()=>{(0,u.c2)("createFluidComponent()",new u.uV("Unable to start providing data to save."))}))}else O=k?async function(e,t){const r=new wo(e,{},!1,t);await r.update();return{loopComponentProperties:r}}(F,a):async function(e,t){let r,n;try{var o,i;const t=await(null===(o=e.LoopComponentUrl)||void 0===o?void 0:o.getLoopComponentUrl());r=null!==(i=null===t||void 0===t?void 0:t.href)&&void 0!==i?i:""}catch(a){(0,po.vV)("Unable to get the content url for the Loop component."),r=""}try{var s;n=null===(s=e.ComponentTitle)||void 0===s?void 0:s.title}catch(a){n="Loop component",(0,po.vV)("Unable to get the title for the Loop component.")}n||(n=t===ho.l1?"Poll":"Loop component");return{linkText:n,url:r}}(F,e);null===(y=O)||void 0===y||y.then((async e=>{var t;null===(t=B)||void 0===t||t.stopProvidingDataToSave(),k?e.loopComponentProperties&&(0,fo.sQ)(e.loopComponentProperties.loopInfo.linkUrl||"",e.loopComponentProperties.loopInfo.linkText||""):e.url&&e.linkText&&(0,fo.sQ)(e.url,e.linkText)}));return{component:F,createDocumentPromise:O,componentPromise:b}}async function Ao(e,t,r,n,o){const i=await async function(e,t,r){const n="containerManifests",o=await(0,h.x$)(h.u.OEP,"FluidHost.ManifestUpgradeParameterFeature")?Cn(t,e,r,!0):Cn(t,e,r);o.then((e=>{localStorage.setItem(n,JSON.stringify(e))})).catch((e=>{(0,u.c2)("fetchAndCacheContainerManifestEntries()",new u.uV("failed to fetch container manifest.",e))}));const i=localStorage.getItem(n);if(i)try{return JSON.parse(i)}catch(s){(0,u.c2)("fetchAndCacheContainerManifestEntries()",new u.uV("cannot parse from cache.",s)),localStorage.removeItem(n)}return o}(t,r,n);if(0==i.length){if(await(0,h.PA)(h.u.OEP,"FluidHost.UseFallbackCodeDetails")){const t=function(e){var t;const r=null!==(t={"FFX-BulletedList":"bulletedList","FFX-Checklist":"checklist","FFX-NumberedList":"numberedList","FFX-Paragraph":"paragraph","FFX-QuestionAnswer":"questionAnswer","FFX-Table":"tableInCanvas","FFX-TaskList":"taskListHostedInScriptorCanvas","FFX-CodeBlock":"codeBlock"}[e])&&void 0!==t?t:"paragraph";return{config:{blueprintId:r},package:{fluid:{browser:{umd:{files:["DynamicallyGeneratedWithCodeLoaderLogic"],library:"officeContainer"}}},name:"@ms/office-fluid-container",version:"0.0.1"}}}(e);return o.addBooleanDataField("FallbackCodeDetailsUsed",!0),(0,po.Rm)("Using fallback codedetails for ".concat(e)),t}throw new u.uV("failed to get any manifests",void 0,Do.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest)}let s=Ro(i,e);if(s||(s=Ro(i,"FFX-Paragraph"),(0,u.c2)("createFluidComponent()",new u.uV('No container manifest entry with id "'.concat(e,'".')))),!s)throw new u.uV("Unable to create a Fluid component of type: ".concat(e,". There is no container manifest entry for this type."));return s.codeDetails}function Ro(e,t){return e.find((e=>{var r;return(null===e||void 0===e||null===(r=e.queryableData)||void 0===r?void 0:r.id)==t}))}async function Mo(e,t,r,n){return function(e){let{dependencySynthesizer:t,documentServiceFactory:r,urlResolver:n,containerRequest:o,preCheckInfo:i,config:s,requiredProviderTypes:a,returnProviderPromise:c}=e;const{logger:l,newConfig:d,perfMetadata:u,documentHiddenTrackerId:h}=w(s||{}),g=Hn({windowContextForLoader:window,driverFetcher:void 0,dependencySynthesizer:t,hostConfig:d,logger:l,perfMetadata:u,documentEverHiddenTrackerID:h,containerRequest:o,driver:r&&n?{documentServiceFactory:r,urlResolver:n}:void 0,preCheckInfo:i,requiredProviderTypes:a});return c?Promise.all([g.container,g.component]).then((e=>{let[t,r]=e;return r})):g}({config:e,containerRequest:t,preCheckInfo:r,dependencySynthesizer:n,returnProviderPromise:!0,requiredProviderTypes:{...g,ComponentLifecycle:"ComponentLifecycle"}})}let _o;async function zo(e,t,r,o,i,s,a,c,l,p,m,f,v,y){if(e)return await Lo(t,r,o,c,s,a,p,m,f,v,y,l);{var b;let e;const t=await(0,h.qF)(),r=await(0,h.cn)(),o=!i.registrationId||"@fluidx/office-fluid-container"===i.registrationId;if(t){const t=function(e){let t,r;if(e.linkUrl)try{t=new URL(e.linkUrl)}catch(i){throw new u.uV("LoopInfo.loopLinkUrl is not a valid URL.")}if(e.manifestData)try{r=JSON.parse(e.manifestData)}catch(i){throw new u.uV("Manifest data is not valid JSON.",i)}if(e.loopData){if(e.registrationId===Oo.B2){let t;try{var n,o;t=JSON.parse(e.loopData),t.updateExtension={type:"updateExtendedProps",data:{appIcon:null!==(n=t.appIcon)&&void 0!==n?n:"",appName:null!==(o=t.appName)&&void 0!==o?o:"",cardId:t.cardId,contentType:t.cardType,mailId:""}}}catch(i){throw new u.uV("Loop data is not valid JSON.",i)}return{type:"Data",dataType:"Card",data:t,manifestData:r,registrationId:e.registrationId}}throw new u.uV("Cannot provide loop data for registration id: ".concat(e.registrationId))}if(!t)throw new u.uV("A url is required.");return{type:"Data",dataType:"URL",data:{url:t},manifestData:r,registrationId:"@fluidx/office-fluid-container"==e.registrationId?void 0:e.registrationId}}(i);e=async function(e,t,r){return(0,po.Rm)("Loading Loop component..."),so({config:e,dependencySynthesizer:t,loopCodeLoaderFactory:await(0,Oo.Zj)(r.registrationId),loopComponentRouterInput:r,returnProviderPromise:!0,requiredProviderTypes:{...g,ComponentLifecycle:"ComponentLifecycle"}})}(s,p,t)}else{_o=await async function(e){const t=function(e){const t=(0,n.Mh)(e);if(!t)return;let r;try{null!==t&&void 0!==t&&t.siteUrl&&(r=new URL(null===t||void 0===t?void 0:t.siteUrl).origin)}catch{}return{codeDetailsHint:null===t||void 0===t?void 0:t.containerPackageName,criticalBootDomains:r?[r]:void 0}}(new URL(e));return t||{}}(l.url),e=Mo(s,l,_o,p);const t=new d(m);null===t||void 0===t||t.registerSessionEndingErrorObserver(e)}const a=(0,h.xH)(),c=await e;if(await a){var S;null===c||void 0===c||null===(S=c.EmbedCardData)||void 0===S||S.getData().then((e=>{const t=JSON.stringify(e);(0,fo.KJ)(t),(0,po.Rm)("Saved embedded data: ".concat(t))})).catch((()=>{}))}let f,v;r&&(f=new wo(c,i,o,m),await f.update(),f.updateFluidFilename());const C=await(null===(b=c.LoopComponentUrl)||void 0===b?void 0:b.getLoopComponentUrl());C&&(v=null===y||void 0===y?void 0:y.resolve({url:C.href,headers:l.headers}));return{component:c,loopComponentProperties:f,componentPromise:e,resolvedUrlPromise:v}}}},5482:(e,t,r)=>{"use strict";r.d(t,{M4:()=>f,ZY:()=>n.ZY,qb:()=>n.qb,v6:()=>m});var n=r(16876),o=r(22270),i=r(11582),s=r(89092),a=r(14357),c=r(56142),l=r(20967),d=r(94115),u=r(27377),h=r(85656),g=r(58443),p=r(69235);const m="unknownError";function f(e,t,r){var n;let m;if(e instanceof p.uV)m=e.hydrateResult;else{const t=function(e){return(0,o.kN)(e)||(0,i.$T)(e)||(0,s.FX)(e)||(0,a.N2)(e)}(e);m=(0,h.G)(t)}var f;((0,c.vV)("Unable to load the Fluid container or component. ".concat(e)),null===(n=r.LoadPerfTracker)||void 0===n||n.setFailure(e),r.sendTelemetryForFailure(d.y.LoadComponentError,m,e),(0,u._)(),t)&&(null===(f=document.getElementById(g.L0))||void 0===f||f.focus());l.ux&&(l.ux.notify=!0)}},20967:(e,t,r)=>{"use strict";r.d(t,{br:()=>Ye,NK:()=>rt,Wu:()=>et,b6:()=>ot,Z:()=>Ze,$r:()=>Je,Ng:()=>$e,ig:()=>Xe,Sk:()=>tt,ux:()=>We,ZG:()=>Ke,OX:()=>Qe});var n=r(12179),o=r(68216),i=r(27284),s=r(62945);const a="sans-serif",c="Segoe UI",l="Segoe UI Emoji",d="--ms-themeColorHeadingText",u={Neutral:{neutralPrimary:"var(".concat("--ms-themeColorPaletteNeutralPrimary",", #323130)")}},h="--ms-themeFontFamilyHeading1",g="--ms-themeFontSizeHeading1",p="--ms-themeFontSizeHeading2",m="--ms-themeFontSizeHeading3",f="--ms-themeFontFamilyBody",v="--ms-themeFontFamilyHeading2",y="--ms-themeFontFamilyHeading3",b="--ms-themeFontSizeBody",S="--ms-themeFontWeightBody",C="--ms-themeFontWeightHeading1",k="--ms-themeFontWeightHeading2",w="--ms-themeFontWeightHeading3",P="--ms-themeColorBodyText",E="--ms-themeColorBodyBackground",T="--ms-themeMarginTopHeading1",I="--ms-themeMarginTopHeading2",N="--ms-themeMarginTopHeading3",F="--ms-themeLineHeightBody",D="--ms-themeLineHeightHeading1",O="--ms-themeLineHeightHeading2",B="--ms-themeLineHeightHeading3",x="--ms-themeOutlineBody",L="--ms-themeOutlineHeading1",A="--ms-themeOutlineHeading2",R="--ms-themeOutlineHeading3",M="--colorNeutralForeground1",_="--colorNeutralBackground1",z="--fontFamilyBase",H="--fontSizeBase300",U="--fontSizeBase500",j="--fontSizeBase600",q="--fontSizeHero800",V="--fontWeightRegular",G="--fontWeightSemibold",W="--fontWeightBold",K="--lineHeightBase400",J="--lineHeightBase500",Q="--lineHeightBase600",X="--lineHeightHero800",Z="var(".concat(z,", var(").concat(f,", ").concat(c,", ").concat(l,", ").concat(a,"))"),$="var(".concat(M,", var(").concat(P,", ").concat(u.Neutral.neutralPrimary,"))"),Y=[["Heading 1",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(h,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:q,fallbackValue:"var(".concat(g,", 24px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:W,fallbackValue:"var(".concat(C,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:d,fallbackValue:$}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:T,fallbackValue:"24px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:X,fallbackValue:"var(".concat(D,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"1"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:L}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(E,", transparent)")}}]],["Heading 2",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(v,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:j,fallbackValue:"var(".concat(p,", 20px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:W,fallbackValue:"var(".concat(k,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:d,fallbackValue:$}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:I,fallbackValue:"20px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:Q,fallbackValue:"var(".concat(O,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"2"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:A}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(E,", transparent)")}}]],["Heading 3",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(y,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:U,fallbackValue:"var(".concat(m,", 14px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:G,fallbackValue:"var(".concat(w,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:d,fallbackValue:$}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:N,fallbackValue:"16px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:J,fallbackValue:"var(".concat(B,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"3"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:R}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(E,", transparent)")}}]],["Body",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:z,fallbackValue:Z}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:H,fallbackValue:"var(".concat(b,", 14px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:V,fallbackValue:"var(".concat(S,")")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:M,fallbackValue:"var(".concat(P,", ").concat(u.Neutral.neutralPrimary,")")}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:K,fallbackValue:"var(".concat(F,", normal)")}},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:x}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(E,", transparent)")}}]]];class ee extends i.EventEmitter{get Disposable(){return this}dispose(){delete this._themeName,delete this.appThemeProperties,delete this.appTextStyles}get Theming(){return this}get themeName(){return this._themeName}set themeName(e){e!==this._themeName&&(this._themeName=e,this.emit("themeNameChanged"))}set themeProperties(e){this.setThemeProperties(new Map(e))}get StylingProvider(){return this}get themeProperties(){return this.appThemeProperties}get textStyles(){return this.appTextStyles}setThemeProperties(e){const t=this.appThemeProperties?new Map(this.appThemeProperties):void 0;this.appThemeProperties=e,this.emit(s.j.themePropertiesChanged,t)}setTextStyles(e){const t=this.appTextStyles?new Map(this.appTextStyles):void 0;this.appTextStyles=e,this.emit(s.j.textStylesChanged,t)}constructor(){super(),this.setMaxListeners(0),this.appTextStyles=new Map(Y)}}var te=r(31942);const re=1e4;class ne{get NamespaceLogger(){return this}get PersistedProperties(){return this}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){const r=t||this.namespace;let{category:n,...o}={...this.persistentProps,...e},i=!1;o.sampleEvent&&(i=Boolean(o.sampleEvent),delete o.sampleEvent);const s=Object.keys(o).length>100;"error"!==n&&"Error"!==n||(o=(e=>{let t;return"string"===typeof e.message&&e.message.length>re&&(t="message",e.message=e.message.substr(0,re)),"string"===typeof e.stack&&e.stack.length>re&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,re)),t?{...e,cappedFields:t}:e})(o)),this.logEvent({category:n,props:{...o,exceedsMaxAllowedFields:s},sampleEvent:i,namespace:r})}addPersistedProperties(e){this.persistentProps={...this.persistentProps,...e}}getPersistedProperties(){return{...this.persistentProps}}constructor(e,t){this.namespace=t,this.persistentProps=e||{},this.namespace=t}}var oe=r(78702);const ie=new class{logEvent(e){if(e.category===oe.hB.Error)console.error("%cPurple: %c%s","color: purple; font-style: italic","",JSON.stringify(e));else console.log("%cPurple: %c%s","color: purple; font-style: italic","",JSON.stringify(e))}setUserContext(e){}shutdown(){}loadFull(){return Promise.resolve()}loadAsha(){}};var se=r(90589),ae=r(37450),ce=r(12283),le=r(82770),de=r(50406),ue=r(93916);const he={Open:"Open",Interruptions:"Interruptions",VetoMissingClassification:"VetoMissingClassification"},ge="LoadFailed",pe="UnhandledError",me="UnhandledRejection",fe=[{pillar:he.Open,vetos:[ge]},{pillar:he.Interruptions,vetos:[pe,me]}];function ve(e){for(const t of fe)if(t.vetos.includes(e))return t.pillar;return he.VetoMissingClassification}const ye={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},be={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"};function Se(e){return function(){let e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch{}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e}(e)?be:ye}class Ce{async logEvent(e){let{namespace:t,category:r,props:n,sampleEvent:o}=e;if(r===oe.hB.UserAction)this.logUserActionEventToOtel(e);else if(r===oe.hB.Activity)this.logActivityEventToOtel(e);else if(r===oe.hB.DNM)this.logDNMEventToOTel(e);else{var i;if(["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(n.eventName))return this.loadAsha(),void(null===(i=this.ashaUtils)||void 0===i||i.then((t=>{let{handleAshaEvent:r}=t;return r(e)})).catch((()=>{this.logDefaultEventToOtel({category:oe.hB.Error,namespace:t,props:{eventName:"".concat(n.eventName,"Failure")},sampleEvent:o})})));r===oe.hB.Error&&function(e){return"eventName"in e&&"veto"in e}(n)&&(n=function(e){var t,r,n,o,i;return{...e,pillar:null!==(t=e.pillar)&&void 0!==t?t:ve(e.veto),isIntentional:null!==(r=e.isIntentional)&&void 0!==r&&r,isInternal:null===(n=e.isInternal)||void 0===n||n,alertOnPillar:null===(o=e.alertOnPillar)||void 0===o||o,isSessionEndingError:null!==(i=e.isSessionEndingError)&&void 0!==i&&i}}(n)),this.logDefaultEventToOtel({namespace:t,category:r,props:n,sampleEvent:o})}}shutdown(){var e;null===(e=this.ashaUtils)||void 0===e||e.then((e=>{let{shutdownAshaForFluid:t}=e;return t()})).catch((()=>{this.logDefaultEventToOtel({category:oe.hB.Error,props:{eventName:"AshaShutdownFailure"}})}))}logDefaultEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareDefaultOtelEvent(t,e)}))}logActivityEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareActivityOtelEvent(t,{...e.props})}))}logUserActionEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareUserActionOtelEvent(t,{...e.props},e.namespace)}))}logDNMEventToOTel(e){const t=e.props.eventName,r=e.props.dataName,n=e.props.dataMeasurement;if("string"!==typeof t||"string"!==typeof r||"number"!==typeof n&&"boolean"!==typeof n)return;const o={eventName:t,dataName:r,dataMeasurement:n,dataType:e.props.dataType,interval:e.props.interval};this.logDirectNumericMeasurementEvent(o)}logDirectNumericMeasurementEvent(e){const t=[];switch(e.dataType){case oe.Qq.Bool:t.push((0,se.LK)(e.dataName,e.dataMeasurement));break;case oe.Qq.Double:t.push((0,se.ip)(e.dataName,e.dataMeasurement));break;case oe.Qq.Int64:t.push((0,se.Ug)(e.dataName,e.dataMeasurement))}if(!e.eventName||0===e.eventName.length)return;const r=e.eventName[0].toUpperCase()+e.eventName.slice(1),n={telemetryProperties:{dnmToken:this.ariaInfo.directNumericMeasurementToken,dnmInterval:e.interval,dnmAllowedPartA:[3,4,5,1]},eventName:"Office.DNM.Loop."+r,eventFlags:{dataCategories:ae.o.DataCategories.ProductServicePerformance,diagnosticLevel:ae.o.DiagnosticLevel.RequiredServiceData},dataFields:t};this.telemetryLogger.sendDirectNumericEvent(n)}getTelemetryConfig(e){const t={enableQueue:!0};return this.isNonProductionAudience(e)?t:{...t,disableValidation:!0}}isNonProductionAudience(e){return"Automation"===e||"Local"===e||"Staging"===e}registerOtelErrorsListener(){(0,ce.d$)().addListener((e=>{0===e.category&&0===e.level&&console.error(e.message())}))}getDataFieldsFromProps(e){const t=[];if(Object.keys(e).forEach((r=>{const n=(0,ue.R)(e[r],r);n&&t.push(n)})),e.dataFields){const r=e.dataFields;t.push(...r)}return t}logEventToOtelInternal(e,t){const r=this.getBasicOtelEvent(e);t(r),this.telemetryLogger.sendTelemetryEvent(r)}getBasicOtelEvent(e){let t=e.category&&"".concat(e.category.charAt(0).toUpperCase()).concat(e.category.substring(1));e.props.subCategory&&e.category===oe.hB.Generic&&(t+=".".concat(e.props.subCategory.charAt(0).toUpperCase()).concat(e.props.subCategory.substring(1)));let r=!1;return e.sampleEvent&&(r=e.sampleEvent),{eventName:"".concat(this.ariaInfo.namespacePrefix).concat(e.namespace?"."+e.namespace:"",".").concat(t),eventFlags:{diagnosticLevel:ae.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:r?ae.o.SamplingPolicy.Measure:void 0}}}prepareDefaultOtelEvent(e,t){e.eventFlags.dataCategories=ae.o.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps({...t.props})}mapActivityResultTypeToCode(e){switch(e){case oe.Tp.Failure:return 0;case oe.Tp.Success:return 1;case oe.Tp.Cancelled:return 2}}prepareBaseActivityOtelEvent(e,t,r){t.durationMs||(t.durationMs=0);const n=Math.floor(1e3*t.durationMs),{durationMs:o,succeeded:i,resultType:s,...a}=t;return e.eventContract={name:le.Il.contractName,dataFields:le.Il.getFields({duration:n,count:1,aggMode:0,success:i,result:!r&&s?{code:this.mapActivityResultTypeToCode(s),type:s}:void 0})},a}prepareActivityOtelEvent(e,t){const r=t.eventName;e.eventName+=".".concat(r.charAt(0).toUpperCase()).concat(r.substring(1)),e.eventFlags.dataCategories=ae.o.DataCategories.ProductServicePerformance;const n=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(n||{})}prepareUserActionOtelEvent(e,t,r){const n=t.eventName;e.eventName+=".".concat(n.charAt(0).toUpperCase()).concat(n.substring(1)),e.eventFlags.dataCategories=ae.o.DataCategories.ProductServiceUsage;const o=le.rh.getFields("Funnel",{name:r,state:"Successful"}),i=t,s=le.ay.getFields({id:i.actionId,name:n,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),a=this.prepareBaseActivityOtelEvent(e,t,!0),{eventName:c,actionId:l,commandSurface:d,parentName:u,triggerMethod:h,timeOffsetMs:g,...p}=a;e.dataFields=[...o,...s,...this.getDataFieldsFromProps(p||{})]}loadAsha(){this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=r.e(59941).then(r.bind(r,93401)),this.ashaUtils.then((e=>{let{initializeAshaForFluid:t}=e;return t(this.ariaInfo.namespacePrefix,this.initialPersistentProps,(e=>{delete e.eventContract,this.telemetryLogger.sendTelemetryEvent(e)}))})).catch((()=>{this.ashaLoadStarted=!1,this.logDefaultEventToOtel({category:oe.hB.Error,props:{eventName:"AshaLoadFailure"}})})))}constructor(e,t){this.initialPersistentProps=t,this.ashaLoadStarted=!1,this.telemetryLogger=new de.GV(void 0,void 0,this.getTelemetryConfig(e)),this.telemetryLogger.partAFields.push((0,se.m9)("Loop.Audience",e)),this.ariaInfo=Se(e),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,de.di),this.isNonProductionAudience(e)&&this.registerOtelErrorsListener()}}class ke extends Ce{setUserContext(e){}replaceTelemetrySink(e){this.hostTelemetrySink=e,this.telemetryLogger.telemetrySinks.pop(),this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}async loadFull(){if(!this.loadFullCalled){this.loadFullCalled=!0;try{const e=await this.hostTelemetrySink;this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}catch(e){this.logDefaultEventToOtel({category:oe.hB.Error,props:{eventName:"FailedToLoadTelemetrySink",message:"".concat(e)}})}}}constructor(e,t,r){super(t,r),this.hostTelemetrySink=e,this.loadFullCalled=!1}}class we{get Disposable(){return this}dispose(){}get LoopTelemetrySink(){return this}sendTelemetryEvent(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){var t,r;null===(t=(r=this.telemetrySink).sendCustomerContent)||void 0===t||t.call(r,e)}sendNonStandardEvent(e,t){var r,n;null===(r=(n=this.telemetrySink).sendNonStandardEvent)||void 0===r||r.call(n,e,t)}constructor(e){this.telemetrySink=e}}var Pe=r(95996);class Ee extends Ce{getLoopTelemetrySinkPromise(){return this.loopTelemetrySinkPromise.then()}async logEvent(e){return this.allowedToLogEupi||(e.props={...e.props,hostCorrelationId:""}),e.category===oe.hB.Error&&(this.loadFullCalled||this.loadFull().catch((()=>{}))),super.logEvent(e)}scrubContextIfNecessary(){this.allowedToLogEupi||(this.context.sessionId="",this.context.user=void 0)}setUserContext(e){var t;this.context={...this.context,...e},this.scrubContextIfNecessary(),null===(t=this.telemetrySink)||void 0===t||t.setPartADataFields(this.context)}shutdown(){super.shutdown(),this.loadFull().then((()=>{var e;return null===(e=this.telemetrySink)||void 0===e?void 0:e.shutdown()})).catch((()=>{}))}async loadFull(){this.loadFullCalled||(this.loadFullCalled=!0,Promise.all([r.e(82075),r.e(10945),r.e(26873)]).then(r.bind(r,14698)).then((e=>{var t;this.telemetrySink=new e.OfficeFluidOneDsSink(this.context);const r=this.telemetrySink.createOneDsSink();this.telemetryLogger.addSink(r),this.telemetryLogger.flushQueue(),null===(t=this.loopTelemetrySinkPromiseResolve)||void 0===t||t.call(this,new we(r))})).catch((e=>{this.logDefaultEventToOtel({category:oe.hB.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})})))}constructor(e,t){const r=(0,Pe.LJ)(e.audience),n=r?t:{...t,hostCorrelationId:""};super(e.audience,n),this.context=e,this.loadFullCalled=!1,this.allowedToLogEupi=!1,this.loopTelemetrySinkPromise=new Promise((e=>this.loopTelemetrySinkPromiseResolve=e)),this.allowedToLogEupi=r,this.scrubContextIfNecessary()}}class Te extends ne{get Disposable(){return this}get PersistedProperties(){return this}getTelemetrySinkPromise(){return this.telemetrySinkPromise.then()}async loadFull(){try{await Promise.allSettled([this.logProcessors.map((e=>e.loadFull()))])}catch{}}setUserContext(e){this.logProcessors.forEach((t=>t.setUserContext(e)))}logEvent(e){this.logProcessors.forEach((t=>t.logEvent(e)));if("Local"===this.audience){const t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,r=e.category===oe.hB.Error||e.category===oe.hB.Activity&&!1===e.props.succeeded;t&&r&&!this.forceTelemetryToConsole&&console.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}addPersistedProperties(e){super.addPersistedProperties(e),r.e(59941).then(r.bind(r,93401)).then((t=>{let{updateAshaAdditionalPartCEventDataFromTelemetryProperties:r}=t;return r(e)})).catch((()=>{this.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})}))}constructor(e){const t=e.hostTelemetryContext,r={...e.persistentProps,hostCorrelationId:t.hostCorrelationId,hostScenarioName:[t.hostScenarioLifecycle,t.hostScenarioName,t.hostScenarioEntryPoint].filter((e=>e)).join("_"),hostName:t.hostName,hostScenarioStartTime:t.hostScenarioStartTime,loopAudience:e.audience};super(r,e.namespace),this.forceTelemetryToConsole=!1,this.dispose=()=>{this.logProcessors.forEach((e=>e.shutdown()))},this.shutdown=()=>{this.Disposable.dispose()};const{delayLoadLogger:n,hostTelemetrySink:o}=e;this.audience=e.audience,this.logProcessors=[...e.additionalLogProcessors||[]];try{this.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),this.forceTelemetryToConsole&&this.logProcessors.push(ie)}catch{}if(o)this.telemetrySinkPromise=Promise.resolve(o).then((e=>new we(e))),this.logProcessors.push(new ke(o,this.audience,r));else{var i;const n=new Ee({appPlatform:t.hostAppPlatform,appName:t.hostAppName,appVersion:t.hostAppVersion,user:null===(i=t.userContext)||void 0===i?void 0:i.user,sessionId:t.hostSessionId,audience:this.audience,uiLanguage:e.hostTelemetryContext.uiLanguage},r);this.telemetrySinkPromise=n.getLoopTelemetrySinkPromise(),this.logProcessors.push(n)}if(n||this.loadFull().catch((()=>{})),e.hostMetadata&&!e.skipInitializationLogs){const{hostMetadata:t}=e,r=t.hostFlights;this.sendWithNamespace({eventName:"HostMetadata",hostRing:t.hostRing,hostFlights:r&&JSON.stringify(r),category:"Generic"},"HostMetadata")}}}var Ie=r(52563),Ne=r(63854);function Fe(e){var t;t=null===e||void 0===e?void 0:e.dir,document.documentElement.setAttribute("dir",t||(0,Ne.Gz)(Ie.q)),document.documentElement.setAttribute("lang",(null===e||void 0===e?void 0:e.lang)||Ie.q),document.documentElement.setAttribute("translate","no")}var De=r(58443),Oe=r(69235),Be=r(899),xe=r(64643),Le=r(56142),Ae=r(91947),Re=r(4311),Me=r(6971),_e=r(24921);class ze{get notify(){return this._notify}set notify(e){this._notify=e,this.notifySizeChanged()}get currentHeight(){return this.height}constructor(e,t,r,n){this.beforeNotify=void 0,this.useDevicePixelRatio=void 0,this.hasSizeChanged=!1,this.height=0,this.isNotifying=!1,this.layoutMode=te.S.fixedByHost,this._notify=!0,this.resizeObserver=void 0,this.sizeChanged=void 0,this.width=0,this.beforeNotify=this.waitBeforeNotifying,this.layoutMode=t,this.notify=r,this.sizeChanged=n,this.observeResize(e)}async notifySizeChanged(){if(this.layoutMode!=te.S.fixedByHost&&!this.isNotifying)for(;this.notify&&this.hasSizeChanged;){this.hasSizeChanged=!1,this.isNotifying=!0;try{await this.beforeNotify(),this.hasSizeChanged&&(ze.isVerboseLoggingEnabled&&(0,Le.Rm)("Size changed while waiting."),this.hasSizeChanged=!1),ze.isVerboseLoggingEnabled&&(0,Le.Rm)("Notifying about size change (".concat(this.width," x ").concat(this.height,")...")),await this.sizeChanged(this.width,this.height,this.layoutMode)}catch(e){}this.isNotifying=!1}}observeResize(e){this.layoutMode!=te.S.fixedByHost&&e&&(this.resizeObserver=new ResizeObserver((async e=>{await this.resizeObserverCallback(e)})),this.resizeObserver.observe(e))}async resizeObserverCallback(e){if(void 0===this.useDevicePixelRatio){var t;const e=await(0,Me.E)();this.useDevicePixelRatio=null!==(t=null===e||void 0===e?void 0:e.useDevicePixelRatio)&&void 0!==t&&t}if(e.length>0){const t=e[e.length-1];let o,i;var r,n;if(this.useDevicePixelRatio){if(o=Math.ceil(t.contentRect.height*devicePixelRatio),i=Math.ceil(t.contentRect.width*devicePixelRatio),ze.isVerboseLoggingEnabled)(0,Le.Rm)("Device pixel ratio: ".concat(devicePixelRatio)),(0,Le.Rm)("ResizeObserverEntry:"),(0,Le.Rm)("  .contentRect =                    ".concat(t.contentRect.width," W x ").concat(t.contentRect.height," H")),null===(r=t.contentBoxSize)||void 0===r||r.forEach(((e,t)=>(0,Le.Rm)("  .contentBoxSize[".concat(t,"] =              ").concat(e.inlineSize," W x ").concat(e.blockSize," H")))),null===(n=t.devicePixelContentBoxSize)||void 0===n||n.forEach(((e,t)=>(0,Le.Rm)("  .devicePixelContentBoxSize[".concat(t,"] =   ").concat(e.inlineSize," W x ").concat(e.blockSize," H")))),(0,Le.Rm)("  .contentRect * devicePixelRatio = ".concat(t.contentRect.width*devicePixelRatio," W x ").concat(t.contentRect.height*devicePixelRatio," H"))}else o=Math.ceil(t.contentRect.height),i=Math.ceil(t.contentRect.width);if(o!=this.height||i!=this.width)return this.height=o,this.width=i,this.hasSizeChanged=!0,De.Nu||(0,Le.Rm)("Observed size change. ".concat(this.width," W x ").concat(this.height," H  (devicePixelRatio: ").concat(devicePixelRatio,")")),this.notifySizeChanged()}}setBeforeNotifyFunction(e){this.beforeNotify=e}async waitBeforeNotifying(){ze.isVerboseLoggingEnabled&&(0,Le.Rm)("Waiting for ".concat(ze.delayBeforeSizeChanged," ms before notifying about size change (").concat(this.width," x ").concat(this.height,")...")),await(0,_e.y)(ze.delayBeforeSizeChanged),ze.isVerboseLoggingEnabled&&(0,Le.Rm)("Finished waiting.")}}ze.delayBeforeSizeChanged=10,ze.isVerboseLoggingEnabled=!1;var He=r(60119),Ue=r(90662),je=r(96826),qe=r(31482),Ve=r(20677),Ge=r(83736);let We;function Ke(e){switch(e){case"fixed":return te.S.fixedByHost;case"grow":return te.S.grow;default:return te.S.growHeight}}function Je(e){const t=new RegExp(/\.(fluid|loop)$/,"i");return e.replace(t,"")}function Qe(e){if(!e)throw new Oe.uV("A Loop url was not provided.");let t;try{t=new URL(e)}catch(n){throw new Oe.uV("The Loop url that was provided is not a valid url.")}const r=t.protocol;if(!r||"https:"!==r.toLowerCase())throw new Oe.uV("The Loop url must use the HTTPS protocol.")}function Xe(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&!e.ctrlKey&&(e.preventDefault(),(0,Ae.Jc)()),r&&!e.ctrlKey&&e.preventDefault()}async function Ze(e){const t=(0,Ie.rv)(e.toLowerCase()),r=(0,Ne.Gz)(t);Fe({lang:t,dir:r});const n=await(0,xe.q)(),o="OneNote"===nt((0,Be.xE)().appName);return{localization:{locale:t,localeDirection:r,stringOverrides:{permissionsPanelPeopleOutsideWithLinkText:o?n.CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote:n.CustomPermissionsPanelPeopleOutsideWithLinkText_Default,permissionsPanelSpecificPermissionText:o?n.CustomPermissionsPanelSpecificPermissionText_OneNote:n.CustomPermissionsPanelSpecificPermissionText_Default,permissionsPanelPeopleOutsideText:o?n.CustomPermissionsPanelPeopleOutsideText_OneNote:n.CustomPermissionsPanelPeopleOutsideText_Default,permissionsPanelSomePeopleText:o?n.CustomPermissionsPanelSomePeopleText_OneNote:n.CustomPermissionsPanelSomePeopleText_Default}},internationalizationContext:{get InternationalizationContext(){return this},uiLocale:t,defaultContentDirection:r}}}function $e(e,t,r){const n=function(e){const t={};if(null!==e&&void 0!==e&&e.audienceGroup||null!==e&&void 0!==e&&e.channel){var r,n;const o=null!==(r=null===e||void 0===e?void 0:e.audienceGroup)&&void 0!==r?r:"Unknown",i=null!==(n=null===e||void 0===e?void 0:e.channel)&&void 0!==n?n:"Unknown";t.hostRing="".concat(o,"/").concat(i)}return t}(t);return new Te({hostTelemetryContext:e,hostTelemetrySink:He.a,audience:r,hostMetadata:n})}function Ye(e,t,r){const i=new ee,s=(0,Ue.h2)(t),a=new Map(s.properties);let c;if(r){const r=(0,Ge.b)(e,t);c=(0,Ve.m)(r)}else c=(0,Ve.m)({fluentThemeV9:t?je.C:qe.o});const l=new Map;c.forEach((e=>{l.set(e.name,e.value)}));const d=new Map([...l.entries(),...a.entries()]);null===i||void 0===i||i.setThemeProperties(d);const u=[];for(const[n,o]of a)u.push({name:n,value:o});const h=u.concat(c),g=(0,n.x)(h),p=(0,o.w)(h);var m,f;t&&(null===(m=document)||void 0===m||null===(f=m.body)||void 0===f||f.style.setProperty("background-color",Ue.kc));return{stylingProvider:i,initialTheme:g,initialThemeV9:p}}async function et(e,t){return await(0,Re.RG)(new URL(e)).catch((e=>((0,Le.vV)("Unable to get fluid file name from Sharepoint.\n".concat((0,Oe.u1)(e))),null)))||function(e){try{const t=/^.*[/\\]([^/\\]+)$/,r=new URL(e).pathname,n=t.exec(r);if(n&&n.length>1){const e=decodeURIComponent(n[1]);if(e.endsWith(De.g4)||e.endsWith(De.Ct))return e}}catch(t){}return null}(e)||t||""}function tt(e){const t=document.documentElement;We=t?new ze(t,e,!1,Ae.CQ):void 0}function rt(e){switch(e){case"Automation":case"Local":case"Staging":case"SyntheticTraffic":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Microsoft":return{audience:"Microsoft"};case"Preview":return{audience:"Preview"};case"DoD":case"GCC":case"GCC-High":case"Production":return{audience:"Production"};default:return De.Nu||(0,Le.vV)("Audience ".concat(e," is not a known value.")),{audience:"Production"}}}function nt(e){switch(e){case"Demo App":case"Demo Host":case"Fluid Preview App":case"Loop App":case"Office.com":case"OfficeMobile":case"OneNote":case"Outlook":case"Scriptor Pad":case"Teams":case"Whiteboard":case"Word":return e;default:return De.Nu||(0,Le.Rm)('"'.concat(e,'" is not a valid app name, set to Unknown')),"Unknown"}}function ot(e,t,r,n){const o=(0,Be.xE)(),i=function(e){switch(null===e||void 0===e?void 0:e.toLowerCase()){case"android":return"Android";case"ios":return"iOS";case"mac":return"Mac";case"web":return"Web";case"win32":return"Win32";default:throw new Error('"'.concat(e,'" is not a valid app platform.'))}}(o.platform),s=nt(o.appName);return(0,Le.Rm)("Fluid host context: {\n"+"  correlationId: ".concat(t,", \n")+"  hostAppName: ".concat(s," \n")+"  hostAppPlatform: ".concat(i," \n")+"  hostAppVersion: ".concat(o.appVersion,", \n")+"  scenarioLifecycle: ".concat(n.lifecycle,", \n")+"  scenarioName: ".concat(n.name,", \n")+"  scenarioEntryPoint: ".concat(n.entryPoint,", \n")+"}"),{hostName:"".concat(o.appName,"_").concat(i),hostAppName:s,hostAppPlatform:i,hostSessionId:e,hostCorrelationId:t,uiLanguage:r,hostAppVersion:o.appVersion,hostScenarioEntryPoint:n.entryPoint,hostScenarioLifecycle:n.lifecycle,hostScenarioName:n.name,hostScenarioStartTime:n.startTime,userContext:{}}}},29369:(e,t,r)=>{"use strict";r.d(t,{B2:()=>n.J,IG:()=>i,Zj:()=>lc});var n=r(35159),o=r(96689);const i="@ms/forms-loop";function s(e){return new Promise((t=>setTimeout((()=>t()),e)))}function a(e,t,r){return c(e,[],t,r)}function c(e,t,r,n){let o;const i=[e(t.length).then((e=>(o=e,!1)))];return n&&n.timeoutMs>0&&i.push(s(n.timeoutMs).then((()=>!0))),Promise.race(i).then((i=>(i&&(o=null===n||void 0===n?void 0:n.onTimeout()),!r||!r.filter(o)||t.length>=r.maxRetries?{result:o,tries:t}:s(r.backoffFn(t.length)).then((()=>(t.push(o),c(e,t,r,n)))))))}async function l(e,t,r){return new Promise(((n,o)=>{var i,s;const a=e.document,c=a.createElement("script"),l=null!==(i=null===r||void 0===r||null===(s=r.trustedTypesPolicy)||void 0===s?void 0:s.createScriptURL(t,{allowedScriptOrigins:r.allowedOrigins}))&&void 0!==i?i:t;c.src=l,c.async=!1,c.charset="utf-8",c.crossOrigin="anonymous",c.onload=n,c.onerror=()=>o(new Error("Failed to download the script at url: ".concat(t,", isUserOnline: ").concat(e.navigator.onLine))),a.head.appendChild(c)}))}var d=r(51238);class u{constructor(e){this.audience=e.audience,this.windowContext=e.windowContext,this.trustedTypesPolicy=e.trustedTypesPolicy}canLoad(e){return e.packageName===i}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");const t=await this.determineCdnUrl(),r=this.trustedTypesPolicy&&{trustedTypesPolicy:await this.trustedTypesPolicy,allowedOrigins:["https://cdn.forms.office.net"]};await((e,t,r)=>{let n=3;return function o(){return l(e,t,r).catch((()=>(n-=1,0===n?l(e,t,r):o())))}()})(this.windowContext,t,r);const n=this.windowContext[i];if(!n)throw new Error("Could not fetch loop module from the window object.");return{module:n,details:e}}async determineCdnUrl(){const e=this.getTargetEnvironment(),t="https://cdn.forms.office.net/forms/loop/formsCodeLoaderDetails-".concat(e,".json?r=").concat((0,d.A)()),r=await function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return a((()=>{const r=performance.now();return fetch(e,t).then((e=>{const t=e;return t.durationMs=Math.round(performance.now()-r),t})).catch((e=>({status:window.navigator.onLine?710:709,ok:!1,durationMs:Math.round(performance.now()-r)})))}),r,{timeoutMs:n,onTimeout:()=>({status:707,ok:!1,durationMs:n})})}(t,{method:"GET"},{maxRetries:3,filter:(o=[500,599],e=>e&&o.includes(e.status)),backoffFn:(n=500,e=>n)});var n,o;if(!r.result.ok||200!==r.result.status)throw new Error("Failed to fetch ".concat(t));return(await r.result.json()).codeLoaderFile}getTargetEnvironment(){switch(this.audience){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":return"staging";case"Dogfood":return"df";case"Microsoft":return"msft";default:return"prod"}}}const h={instantiateLoopCodeLoader:e=>Promise.resolve(new u(e))};var g=r(52059),p=r(76899);class m{canLoad(e){return e.packageName===g.JL}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return(0,p.Fr)()||this.isSmallPageWidth()||!await this.isEnabledByOcps()?Promise.all([r.e(69808),r.e(97950),r.e(82075),r.e(94885),r.e(18806),r.e(76115),r.e(10945),r.e(95126),r.e(40135),r.e(14618),r.e(93191),r.e(72806),r.e(42038)]).then(r.bind(r,53734)).then((t=>({module:t,details:e}))):Promise.all([r.e(69808),r.e(97950),r.e(82075),r.e(10945),r.e(95126),r.e(27614),r.e(36697),r.e(14618),r.e(77062),r.e(10538)]).then(r.bind(r,34601)).then((t=>({module:t,details:e})))}isSmallPageWidth(){const e=this.props.windowContext.document.getElementsByClassName("scriptor-pageFrameContainer");return e.length>0&&e[0].clientWidth<g.$A}async isEnabledByOcps(){try{var e;const t=null===(e=this.props.dependencySynthesizer)||void 0===e?void 0:e.synthesize({OfficePolicyProvider:"OfficePolicyProvider"},void 0),r=await(null===t||void 0===t?void 0:t.OfficePolicyProvider);if(null===r||void 0===r||!r.getPolicy)return!1;const n=await r.getPolicy(g.gE);return void 0===n||"1"===n.value}catch(t){return!1}}constructor(e){this.props=e}}const f={instantiateLoopCodeLoader:e=>Promise.resolve(new m(e))};var v=r(81918),y=r(75368),b=r(24435),S="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:{},C=function(e){return e&&e.Math==Math&&e},k=C("object"==typeof globalThis&&globalThis)||C("object"==typeof window&&window)||C("object"==typeof self&&self)||C("object"==typeof S&&S)||Function("return this")(),w={},P=function(e){try{return!!e()}catch(t){return!0}},E=!P((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),T={},I={}.propertyIsEnumerable,N=Object.getOwnPropertyDescriptor,F=N&&!I.call({1:2},1);T.f=F?function(e){var t=N(this,e);return!!t&&t.enumerable}:I;var D=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},O={}.toString,B=function(e){return O.call(e).slice(8,-1)},x=B,L="".split,A=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e},R=P((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==x(e)?L.call(e,""):Object(e)}:Object,M=A,_=function(e){return R(M(e))},z=function(e){return"object"===typeof e?null!==e:"function"===typeof e},H=z,U=function(e,t){if(!H(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!H(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!H(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!H(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},j={}.hasOwnProperty,q=function(e,t){return j.call(e,t)},V=z,G=k.document,W=V(G)&&V(G.createElement),K=function(e){return W?G.createElement(e):{}},J=K,Q=!E&&!P((function(){return 7!=Object.defineProperty(J("div"),"a",{get:function(){return 7}}).a})),X=E,Z=T,$=D,Y=_,ee=U,te=q,re=Q,ne=Object.getOwnPropertyDescriptor;w.f=X?ne:function(e,t){if(e=Y(e),t=ee(t,!0),re)try{return ne(e,t)}catch(r){}if(te(e,t))return $(!Z.f.call(e,t),e[t])};var oe={},ie=z,se=function(e){if(!ie(e))throw TypeError(String(e)+" is not an object");return e},ae=E,ce=Q,le=se,de=U,ue=Object.defineProperty;oe.f=ae?ue:function(e,t,r){if(le(e),t=de(t,!0),le(r),ce)try{return ue(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var he=oe,ge=D,pe=E?function(e,t,r){return he.f(e,t,ge(1,r))}:function(e,t,r){return e[t]=r,e},me={exports:{}},fe=k,ve=pe,ye=function(e,t){try{ve(fe,e,t)}catch(r){fe[e]=t}return t},be=ye,Se="__core-js_shared__",Ce=k[Se]||be(Se,{}),ke=Ce,we=Function.toString;"function"!=typeof ke.inspectSource&&(ke.inspectSource=function(e){return we.call(e)});var Pe=ke.inspectSource,Ee=Pe,Te=k.WeakMap,Ie="function"===typeof Te&&/native code/.test(Ee(Te)),Ne={exports:{}},Fe=Ce;(Ne.exports=function(e,t){return Fe[e]||(Fe[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"});var De,Oe,Be,xe=0,Le=Math.random(),Ae=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++xe+Le).toString(36)},Re=Ne.exports,Me=Ae,_e=Re("keys"),ze=function(e){return _e[e]||(_e[e]=Me(e))},He={},Ue=Ie,je=z,qe=pe,Ve=q,Ge=ze,We=He,Ke=k.WeakMap;if(Ue){var Je=new Ke,Qe=Je.get,Xe=Je.has,Ze=Je.set;De=function(e,t){return Ze.call(Je,e,t),t},Oe=function(e){return Qe.call(Je,e)||{}},Be=function(e){return Xe.call(Je,e)}}else{var $e=Ge("state");We[$e]=!0,De=function(e,t){return qe(e,$e,t),t},Oe=function(e){return Ve(e,$e)?e[$e]:{}},Be=function(e){return Ve(e,$e)}}var Ye={set:De,get:Oe,has:Be,enforce:function(e){return Be(e)?Oe(e):De(e,{})},getterFor:function(e){return function(t){var r;if(!je(t)||(r=Oe(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},et=k,tt=pe,rt=q,nt=ye,ot=Pe,it=Ye.get,st=Ye.enforce,at=String(String).split("String");(me.exports=function(e,t,r,n){var o=!!n&&!!n.unsafe,i=!!n&&!!n.enumerable,s=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof t||rt(r,"name")||tt(r,"name",t),st(r).source=at.join("string"==typeof t?t:"")),e!==et?(o?!s&&e[t]&&(i=!0):delete e[t],i?e[t]=r:tt(e,t,r)):i?e[t]=r:nt(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&it(this).source||ot(this)}));var ct=k,lt=k,dt=function(e){return"function"==typeof e?e:void 0},ut=function(e,t){return arguments.length<2?dt(ct[e])||dt(lt[e]):ct[e]&&ct[e][t]||lt[e]&&lt[e][t]},ht={},gt=Math.ceil,pt=Math.floor,mt=function(e){return isNaN(e=+e)?0:(e>0?pt:gt)(e)},ft=mt,vt=Math.min,yt=function(e){return e>0?vt(ft(e),9007199254740991):0},bt=mt,St=Math.max,Ct=Math.min,kt=_,wt=yt,Pt=function(e,t){var r=bt(e);return r<0?St(r+t,0):Ct(r,t)},Et=function(e){return function(t,r,n){var o,i=kt(t),s=wt(i.length),a=Pt(n,s);if(e&&r!=r){for(;s>a;)if((o=i[a++])!=o)return!0}else for(;s>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},Tt={includes:Et(!0),indexOf:Et(!1)},It=q,Nt=_,Ft=Tt.indexOf,Dt=He,Ot=function(e,t){var r,n=Nt(e),o=0,i=[];for(r in n)!It(Dt,r)&&It(n,r)&&i.push(r);for(;t.length>o;)It(n,r=t[o++])&&(~Ft(i,r)||i.push(r));return i},Bt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],xt=Ot,Lt=Bt.concat("length","prototype");ht.f=Object.getOwnPropertyNames||function(e){return xt(e,Lt)};var At={};At.f=Object.getOwnPropertySymbols;var Rt=ht,Mt=At,_t=se,zt=ut("Reflect","ownKeys")||function(e){var t=Rt.f(_t(e)),r=Mt.f;return r?t.concat(r(e)):t},Ht=q,Ut=zt,jt=w,qt=oe,Vt=P,Gt=/#|\.prototype\./,Wt=function(e,t){var r=Jt[Kt(e)];return r==Xt||r!=Qt&&("function"==typeof t?Vt(t):!!t)},Kt=Wt.normalize=function(e){return String(e).replace(Gt,".").toLowerCase()},Jt=Wt.data={},Qt=Wt.NATIVE="N",Xt=Wt.POLYFILL="P",Zt=Wt,$t=k,Yt=w.f,er=pe,tr=me.exports,rr=ye,nr=function(e,t){for(var r=Ut(t),n=qt.f,o=jt.f,i=0;i<r.length;i++){var s=r[i];Ht(e,s)||n(e,s,o(t,s))}},or=Zt,ir=function(e,t){var r,n,o,i,s,a=e.target,c=e.global,l=e.stat;if(r=c?$t:l?$t[a]||rr(a,{}):($t[a]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(s=Yt(r,n))&&s.value:r[n],!or(c?n:a+(l?".":"#")+n,e.forced)&&void 0!==o){if(typeof i===typeof o)continue;nr(i,o)}(e.sham||o&&o.sham)&&er(i,"sham",!0),tr(r,n,i,e)}},sr=k.Promise,ar=me.exports,cr=P,lr=!!Object.getOwnPropertySymbols&&!cr((function(){return!String(Symbol())})),dr=lr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ur=k,hr=Ne.exports,gr=q,pr=Ae,mr=lr,fr=dr,vr=hr("wks"),yr=ur.Symbol,br=fr?yr:yr&&yr.withoutSetter||pr,Sr=function(e){return gr(vr,e)||(mr&&gr(yr,e)?vr[e]=yr[e]:vr[e]=br("Symbol."+e)),vr[e]},Cr=oe.f,kr=q,wr=Sr("toStringTag"),Pr=function(e,t,r){e&&!kr(e=r?e:e.prototype,wr)&&Cr(e,wr,{configurable:!0,value:t})},Er=ut,Tr=oe,Ir=E,Nr=Sr("species"),Fr=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Dr={exports:{}},Or={},Br=Or,xr=Sr("iterator"),Lr=Array.prototype,Ar=Fr,Rr=function(e,t,r){if(Ar(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},Mr={};Mr[Sr("toStringTag")]="z";var _r="[object z]"===String(Mr),zr=B,Hr=Sr("toStringTag"),Ur="Arguments"==zr(function(){return arguments}()),jr=_r?zr:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),Hr))?r:Ur?zr(t):"Object"==(n=zr(t))&&"function"==typeof t.callee?"Arguments":n},qr=Or,Vr=Sr("iterator"),Gr=se,Wr=se,Kr=function(e){return void 0!==e&&(Br.Array===e||Lr[xr]===e)},Jr=yt,Qr=Rr,Xr=function(e){if(void 0!=e)return e[Vr]||e["@@iterator"]||qr[jr(e)]},Zr=function(e,t,r,n){try{return n?t(Gr(r)[0],r[1]):t(r)}catch(i){var o=e.return;throw void 0!==o&&Gr(o.call(e)),i}},$r=function(e,t){this.stopped=e,this.result=t};(Dr.exports=function(e,t,r,n,o){var i,s,a,c,l,d,u,h=Qr(t,r,n?2:1);if(o)i=e;else{if("function"!=typeof(s=Xr(e)))throw TypeError("Target is not iterable");if(Kr(s)){for(a=0,c=Jr(e.length);c>a;a++)if((l=n?h(Wr(u=e[a])[0],u[1]):h(e[a]))&&l instanceof $r)return l;return new $r(!1)}i=s.call(e)}for(d=i.next;!(u=d.call(i)).done;)if("object"==typeof(l=Zr(i,h,u.value,n))&&l&&l instanceof $r)return l;return new $r(!1)}).stop=function(e){return new $r(!0,e)};var Yr=Sr("iterator"),en=!1;try{var tn=0,rn={next:function(){return{done:!!tn++}},return:function(){en=!0}};rn[Yr]=function(){return this},Array.from(rn,(function(){throw 2}))}catch(dc){}var nn,on,sn,an=se,cn=Fr,ln=Sr("species"),dn=ut("document","documentElement"),un=ut("navigator","userAgent")||"",hn=/(iphone|ipod|ipad).*applewebkit/i.test(un),gn=k,pn=P,mn=B,fn=Rr,vn=dn,yn=K,bn=hn,Sn=gn.location,Cn=gn.setImmediate,kn=gn.clearImmediate,wn=gn.process,Pn=gn.MessageChannel,En=gn.Dispatch,Tn=0,In={},Nn="onreadystatechange",Fn=function(e){if(In.hasOwnProperty(e)){var t=In[e];delete In[e],t()}},Dn=function(e){return function(){Fn(e)}},On=function(e){Fn(e.data)},Bn=function(e){gn.postMessage(e+"",Sn.protocol+"//"+Sn.host)};Cn&&kn||(Cn=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return In[++Tn]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},nn(Tn),Tn},kn=function(e){delete In[e]},"process"==mn(wn)?nn=function(e){wn.nextTick(Dn(e))}:En&&En.now?nn=function(e){En.now(Dn(e))}:Pn&&!bn?(sn=(on=new Pn).port2,on.port1.onmessage=On,nn=fn(sn.postMessage,sn,1)):!gn.addEventListener||"function"!=typeof postMessage||gn.importScripts||pn(Bn)||"file:"===Sn.protocol?nn=Nn in yn("script")?function(e){vn.appendChild(yn("script"))[Nn]=function(){vn.removeChild(this),Fn(e)}}:function(e){setTimeout(Dn(e),0)}:(nn=Bn,gn.addEventListener("message",On,!1)));var xn,Ln,An,Rn,Mn,_n,zn,Hn,Un={set:Cn,clear:kn},jn=k,qn=w.f,Vn=B,Gn=Un.set,Wn=hn,Kn=jn.MutationObserver||jn.WebKitMutationObserver,Jn=jn.process,Qn=jn.Promise,Xn="process"==Vn(Jn),Zn=qn(jn,"queueMicrotask"),$n=Zn&&Zn.value;$n||(xn=function(){var e,t;for(Xn&&(e=Jn.domain)&&e.exit();Ln;){t=Ln.fn,Ln=Ln.next;try{t()}catch(dc){throw Ln?Rn():An=void 0,dc}}An=void 0,e&&e.enter()},Xn?Rn=function(){Jn.nextTick(xn)}:Kn&&!Wn?(Mn=!0,_n=document.createTextNode(""),new Kn(xn).observe(_n,{characterData:!0}),Rn=function(){_n.data=Mn=!Mn}):Qn&&Qn.resolve?(zn=Qn.resolve(void 0),Hn=zn.then,Rn=function(){Hn.call(zn,xn)}):Rn=function(){Gn.call(jn,xn)});var Yn=$n||function(e){var t={fn:e,next:void 0};An&&(An.next=t),Ln||(Ln=t,Rn()),An=t},eo={},to=Fr,ro=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=to(t),this.reject=to(r)};eo.f=function(e){return new ro(e)};var no,oo,io=se,so=z,ao=eo,co=k,lo=un,uo=k.process,ho=uo&&uo.versions,go=ho&&ho.v8;go?oo=(no=go.split("."))[0]+no[1]:lo&&(!(no=lo.match(/Edge\/(\d+)/))||no[1]>=74)&&(no=lo.match(/Chrome\/(\d+)/))&&(oo=no[1]);var po,mo,fo,vo,yo=oo&&+oo,bo=ir,So=k,Co=ut,ko=sr,wo=me.exports,Po=function(e,t,r){for(var n in t)ar(e,n,t[n],r);return e},Eo=Pr,To=function(e){var t=Er(e),r=Tr.f;Ir&&t&&!t[Nr]&&r(t,Nr,{configurable:!0,get:function(){return this}})},Io=z,No=Fr,Fo=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e},Do=B,Oo=Pe,Bo=Dr.exports,xo=function(e,t){if(!t&&!en)return!1;var r=!1;try{var n={};n[Yr]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(dc){}return r},Lo=function(e,t){var r,n=an(e).constructor;return void 0===n||void 0==(r=an(n)[ln])?t:cn(r)},Ao=Un.set,Ro=Yn,Mo=function(e,t){if(io(e),so(t)&&t.constructor===e)return t;var r=ao.f(e);return(0,r.resolve)(t),r.promise},_o=function(e,t){var r=co.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))},zo=eo,Ho=function(e){try{return{error:!1,value:e()}}catch(dc){return{error:!0,value:dc}}},Uo=Ye,jo=Zt,qo=yo,Vo=Sr("species"),Go="Promise",Wo=Uo.get,Ko=Uo.set,Jo=Uo.getterFor(Go),Qo=ko,Xo=So.TypeError,Zo=So.document,$o=So.process,Yo=Co("fetch"),ei=zo.f,ti=ei,ri="process"==Do($o),ni=!!(Zo&&Zo.createEvent&&So.dispatchEvent),oi="unhandledrejection",ii=jo(Go,(function(){if(!(Oo(Qo)!==String(Qo))){if(66===qo)return!0;if(!ri&&"function"!=typeof PromiseRejectionEvent)return!0}if(qo>=51&&/native code/.test(Qo))return!1;var e=Qo.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Vo]=t,!(e.then((function(){}))instanceof t)})),si=ii||!xo((function(e){Qo.all(e).catch((function(){}))})),ai=function(e){var t;return!(!Io(e)||"function"!=typeof(t=e.then))&&t},ci=function(e,t,r){if(!t.notified){t.notified=!0;var n=t.reactions;Ro((function(){for(var o=t.value,i=1==t.state,s=0;n.length>s;){var a,c,l,d=n[s++],u=i?d.ok:d.fail,h=d.resolve,g=d.reject,p=d.domain;try{u?(i||(2===t.rejection&&hi(e,t),t.rejection=1),!0===u?a=o:(p&&p.enter(),a=u(o),p&&(p.exit(),l=!0)),a===d.promise?g(Xo("Promise-chain cycle")):(c=ai(a))?c.call(a,h,g):h(a)):g(o)}catch(dc){p&&!l&&p.exit(),g(dc)}}t.reactions=[],t.notified=!1,r&&!t.rejection&&di(e,t)}))}},li=function(e,t,r){var n,o;ni?((n=Zo.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),So.dispatchEvent(n)):n={promise:t,reason:r},(o=So["on"+e])?o(n):e===oi&&_o("Unhandled promise rejection",r)},di=function(e,t){Ao.call(So,(function(){var r,n=t.value;if(ui(t)&&(r=Ho((function(){ri?$o.emit("unhandledRejection",n,e):li(oi,e,n)})),t.rejection=ri||ui(t)?2:1,r.error))throw r.value}))},ui=function(e){return 1!==e.rejection&&!e.parent},hi=function(e,t){Ao.call(So,(function(){ri?$o.emit("rejectionHandled",e):li("rejectionhandled",e,t.value)}))},gi=function(e,t,r,n){return function(o){e(t,r,o,n)}},pi=function(e,t,r,n){t.done||(t.done=!0,n&&(t=n),t.value=r,t.state=2,ci(e,t,!0))},mi=function(e,t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(e===r)throw Xo("Promise can't be resolved itself");var o=ai(r);o?Ro((function(){var n={done:!1};try{o.call(r,gi(mi,e,n,t),gi(pi,e,n,t))}catch(dc){pi(e,n,dc,t)}})):(t.value=r,t.state=1,ci(e,t,!1))}catch(dc){pi(e,{done:!1},dc,t)}}};ii&&(Qo=function(e){Fo(this,Qo,Go),No(e),po.call(this);var t=Wo(this);try{e(gi(mi,this,t),gi(pi,this,t))}catch(dc){pi(this,t,dc)}},(po=function(e){Ko(this,{type:Go,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Po(Qo.prototype,{then:function(e,t){var r=Jo(this),n=ei(Lo(this,Qo));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=ri?$o.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&ci(this,r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),mo=function(){var e=new po,t=Wo(e);this.promise=e,this.resolve=gi(mi,e,t),this.reject=gi(pi,e,t)},zo.f=ei=function(e){return e===Qo||e===fo?new mo(e):ti(e)},"function"==typeof ko&&(vo=ko.prototype.then,wo(ko.prototype,"then",(function(e,t){var r=this;return new Qo((function(e,t){vo.call(r,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Yo&&bo({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Mo(Qo,Yo.apply(So,arguments))}}))),bo({global:!0,wrap:!0,forced:ii},{Promise:Qo}),Eo(Qo,Go,!1),To(Go),fo=Co(Go),bo({target:Go,stat:!0,forced:ii},{reject:function(e){var t=ei(this);return t.reject.call(void 0,e),t.promise}}),bo({target:Go,stat:!0,forced:ii},{resolve:function(e){return Mo(this,e)}}),bo({target:Go,stat:!0,forced:si},{all:function(e){var t=this,r=ei(t),n=r.resolve,o=r.reject,i=Ho((function(){var r=No(t.resolve),i=[],s=0,a=1;Bo(e,(function(e){var c=s++,l=!1;i.push(void 0),a++,r.call(t,e).then((function(e){l||(l=!0,i[c]=e,--a||n(i))}),o)})),--a||n(i)}));return i.error&&o(i.value),r.promise},race:function(e){var t=this,r=ei(t),n=r.reject,o=Ho((function(){var o=No(t.resolve);Bo(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var fi,vi=Ot,yi=Bt,bi=Object.keys||function(e){return vi(e,yi)},Si=oe,Ci=se,ki=bi,wi=E?Object.defineProperties:function(e,t){Ci(e);for(var r,n=ki(t),o=n.length,i=0;o>i;)Si.f(e,r=n[i++],t[r]);return e},Pi=se,Ei=wi,Ti=Bt,Ii=He,Ni=dn,Fi=K,Di="prototype",Oi="script",Bi=ze("IE_PROTO"),xi=function(){},Li=function(e){return"<"+Oi+">"+e+"</"+Oi+">"},Ai=function(){try{fi=document.domain&&new ActiveXObject("htmlfile")}catch(dc){}Ai=fi?function(e){e.write(Li("")),e.close();var t=e.parentWindow.Object;return e=null,t}(fi):function(){var e,t=Fi("iframe"),r="java"+Oi+":";return t.style.display="none",Ni.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Li("document.F=Object")),e.close(),e.F}();for(var e=Ti.length;e--;)delete Ai[Di][Ti[e]];return Ai()};Ii[Bi]=!0;var Ri=Object.create||function(e,t){var r;return null!==e?(xi[Di]=Pi(e),r=new xi,xi[Di]=null,r[Bi]=e):r=Ai(),void 0===t?r:Ei(r,t)},Mi=Ri,_i=oe,zi=Sr("unscopables"),Hi=Array.prototype;void 0==Hi[zi]&&_i.f(Hi,zi,{configurable:!0,value:Mi(null)});var Ui,ji,qi,Vi=function(e){Hi[zi][e]=!0},Gi=A,Wi=!P((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ki=q,Ji=function(e){return Object(Gi(e))},Qi=Wi,Xi=ze("IE_PROTO"),Zi=Object.prototype,$i=Qi?Object.getPrototypeOf:function(e){return e=Ji(e),Ki(e,Xi)?e[Xi]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Zi:null},Yi=$i,es=pe,ts=q,rs=Sr("iterator"),ns=!1;[].keys&&("next"in(qi=[].keys())?(ji=Yi(Yi(qi)))!==Object.prototype&&(Ui=ji):ns=!0),void 0==Ui&&(Ui={}),ts(Ui,rs)||es(Ui,rs,(function(){return this}));var os={IteratorPrototype:Ui,BUGGY_SAFARI_ITERATORS:ns},is=os.IteratorPrototype,ss=Ri,as=D,cs=Pr,ls=Or,ds=function(){return this},us=z,hs=se,gs=function(e){if(!us(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e},ps=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(dc){}return function(r,n){return hs(r),gs(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),ms=ir,fs=function(e,t,r){var n=t+" Iterator";return e.prototype=ss(is,{next:as(1,r)}),cs(e,n,!1),ls[n]=ds,e},vs=$i,ys=ps,bs=Pr,Ss=pe,Cs=me.exports,ks=Or,ws=os.IteratorPrototype,Ps=os.BUGGY_SAFARI_ITERATORS,Es=Sr("iterator"),Ts="keys",Is="values",Ns="entries",Fs=function(){return this},Ds=_,Os=Vi,Bs=Or,xs=Ye,Ls=function(e,t,r,n,o,i,s){fs(r,t,n);var a,c,l,d=function(e){if(e===o&&m)return m;if(!Ps&&e in g)return g[e];switch(e){case Ts:case Is:case Ns:return function(){return new r(this,e)}}return function(){return new r(this)}},u=t+" Iterator",h=!1,g=e.prototype,p=g[Es]||g["@@iterator"]||o&&g[o],m=!Ps&&p||d(o),f="Array"==t&&g.entries||p;if(f&&(a=vs(f.call(new e)),ws!==Object.prototype&&a.next&&(vs(a)!==ws&&(ys?ys(a,ws):"function"!=typeof a[Es]&&Ss(a,Es,Fs)),bs(a,u,!0))),o==Is&&p&&p.name!==Is&&(h=!0,m=function(){return p.call(this)}),g[Es]!==m&&Ss(g,Es,m),ks[t]=m,o)if(c={values:d(Is),keys:i?m:d(Ts),entries:d(Ns)},s)for(l in c)(Ps||h||!(l in g))&&Cs(g,l,c[l]);else ms({target:t,proto:!0,forced:Ps||h},c);return c},As="Array Iterator",Rs=xs.set,Ms=xs.getterFor(As),_s=Ls(Array,"Array",(function(e,t){Rs(this,{type:As,target:Ds(e),index:0,kind:t})}),(function(){var e=Ms(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");Bs.Arguments=Bs.Array,Os("keys"),Os("values"),Os("entries");var zs=k,Hs={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Us=_s,js=pe,qs=Sr,Vs=qs("iterator"),Gs=qs("toStringTag"),Ws=Us.values;for(var Ks in Hs){var Js=zs[Ks],Qs=Js&&Js.prototype;if(Qs){if(Qs[Vs]!==Ws)try{js(Qs,Vs,Ws)}catch(dc){Qs[Vs]=Ws}if(Qs[Gs]||js(Qs,Gs,Ks),Hs[Ks])for(var Xs in Us)if(Qs[Xs]!==Us[Xs])try{js(Qs,Xs,Us[Xs])}catch(dc){Qs[Xs]=Us[Xs]}}}var Zs=se,$s=function(){var e=Zs(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Ys=me.exports,ea=se,ta=P,ra=$s,na="toString",oa=RegExp.prototype,ia=oa[na],sa=ta((function(){return"/a/b"!=ia.call({source:"a",flags:"b"})})),aa=ia.name!=na;(sa||aa)&&Ys(RegExp.prototype,na,(function(){var e=ea(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in oa)?ra.call(e):r)}),{unsafe:!0});const ca=(e,t)=>Object.assign(void 0!==t?function(){return{type:e,...t(...arguments)}}:t=>void 0!==t?{type:e,...t}:{type:e},{type:e}),la="[Loop]",da="".concat(la," [Start]"),ua="".concat(la," [Resolve]"),ha="".concat(la," [Reject]"),ga=e=>({start:Object.assign((t=>ca("".concat(da," ").concat(e),(e=>({...t,asyncId:window.crypto.randomUUID(),instanceId:e})))),{type:"".concat(da," ").concat(e)}),resolve:Object.assign((t=>ca("".concat(ua," ").concat(e),((e,r)=>({...t,asyncId:r,instanceId:e})))),{type:"".concat(ua," ").concat(e)}),reject:Object.assign((t=>ca("".concat(ha," ").concat(e),((e,r)=>({...t,asyncId:r,instanceId:e})))),{type:"".concat(ha," ").concat(e)})});function pa(e){return void 0!==e.asyncId}class ma{constructor(e){this.target=e,this.listeners=new Set,this.typeListeners=new Map,this.asyncListeners=new Map,this.asyncResponders=new Map,this.messageDelegator=e=>this.onMessage(e),this.listener=e=>this.messageDelegator(e),this.queue=[],window.addEventListener("message",this.listener)}pause(e){this.messageDelegator=t=>{e&&e(t)?this.onMessage(t):this.queue.push(t)}}flush(){const e=this.queue;this.queue=[];for(const t of e)this.onMessage(t)}resume(){this.messageDelegator=e=>this.onMessage(e),this.flush()}dispose(){window.removeEventListener("message",this.listener),this.listeners.clear(),this.typeListeners.clear(),this.asyncListeners.clear(),this.asyncResponders.clear(),this.queue=[]}listen(e){this.listeners.add(e)}listenFor(e,t){let{type:r}=e;const n=this.typeListeners.get(r);n?n.add(t):this.typeListeners.set(r,new Set([t]))}listenForAsync(e,t){const r=e.start.type,n=this.asyncListeners.get(r);n?n.add(t):this.asyncListeners.set(r,new Set([t]))}send(e){"function"===typeof e?this.sendMessage(e(this.target.instanceId)):this.sendMessage({...e,instanceId:this.target.instanceId})}async sendAsync(e){return new Promise(((t,r)=>{const n=e(this.target.instanceId),{asyncId:o}=n;this.asyncResponders.set(o,[t,r]),this.sendMessage(n)}))}onMessage(e){if(this.target.origin!==e.origin)return;const t=e.data;if(function(e){const t=e;return null!=t&&"object"===typeof t&&void 0!==t.type&&void 0!==t.instanceId}(t)){if(pa(t)){const e=this.asyncResponders.get(t.asyncId);if(e){this.asyncResponders.delete(t.asyncId);const[r,n]=e,{type:o,asyncId:i,instanceId:s,...a}=t;o.startsWith(ua)?r(a):t.type.startsWith(ha)&&n(a)}}for(const r of Array.from(this.listeners))r(t);const e=this.typeListeners.get(t.type);if(e)for(const r of Array.from(e))r(t);if(pa(t)&&t.type.startsWith(da)){const e=this.asyncListeners.get(t.type);if(e)for(const r of Array.from(e))Promise.resolve(r(t)).then((e=>this.sendMessage(e(t.instanceId,t.asyncId))))}}}sendMessage(e){var t;null===(t=this.target.window())||void 0===t||t.postMessage(e,this.target.origin)}}class fa extends ma{constructor(e,t,r){super({origin:e,window:t,instanceId:r})}}const va=ga("Open"),ya=ga("Initialize"),ba=ga("GetToken"),Sa=ga("Render"),Ca=[0,0,1];class ka{constructor(e,t){this.container=e,this.config=t,this.renderPromiseResolver={resolve:()=>{},reject:()=>{}},this.renderPromise=new Promise(((e,t)=>this.renderPromiseResolver={resolve:e,reject:t}))}dispose(){var e,t;null===(e=this.broker)||void 0===e||e.dispose(),this.broker=void 0,null===(t=this.iframe)||void 0===t||t.remove(),this.iframe=void 0,this.instanceId=void 0}async open(e){return await this.bootstrap(e),this.broker?this.broker.sendAsync(va.start(e)):{kind:"Unknown",resolved:"Unknown"}}async bootstrap(e){var t;if(this.broker)return Ca;const r=new URL(e.url);r.pathname="loop",r.search="";const n=this.config.featureSwitches;if(n)for(const l in n)r.searchParams.set(l,n[l]?"1":"0");this.instanceId=window.crypto.randomUUID();const o=function(e,t,r){const n="string"===typeof e?new URL(e):e;return n.searchParams.set("__instanceId",t),n.searchParams.set("__hostOrigin",r),n}(r,this.instanceId,location.origin),i=this.iframe=this.container.ownerDocument.createElement("iframe");i.src=o.toString(),i.style.width="100%",i.style.height="400px",i.style.border="none",i.title="Power BI",i.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms");const s=null===(t=new URLSearchParams(i.src))||void 0===t?void 0:t.get("__hostOrigin"),a=new Promise(((e,t)=>{i.onload=e,i.onerror=t}));this.broker=new fa(r.origin,(()=>null===i||void 0===i?void 0:i.contentWindow),this.instanceId);const c=new Promise(((t,r)=>{var n;null===(n=this.broker)||void 0===n||n.listenForAsync(ya,(n=>{let{version:o}=n;return(e=>e[0]===Ca[0])(o)?t(o):r(o),ya.resolve({version:Ca,context:this.config.hostContext,launchPbiStartTime:e.launchPbiStartTime,hostName:null!==s&&void 0!==s?s:"unknown"})}))}));return this.setupListeners(),this.container.appendChild(i),await a,c}setupListeners(){var e,t;null===(e=this.broker)||void 0===e||e.listenForAsync(ba,(e=>{let{scopes:t,options:r}=e;return this.config.providers.token.getToken(t,r).then(ba.resolve,ba.reject)})),null===(t=this.broker)||void 0===t||t.listenForAsync(Sa,(e=>{let{isError:t}=e;return t?this.renderPromiseResolver.reject():this.renderPromiseResolver.resolve(),Sa.resolve({isError:t})}))}}const wa="@trident/powerbi-loop",Pa="Power BI";class Ea{constructor(e,t){if(this.props=e,this.providers=t,this.launchPbiStartTime=performance.timeOrigin,!t)throw Error("Missing providers")}get HTMLView(){return this}async render(e){var t,r,n;const[o,i,s]=await Promise.all([null==(t=this.providers)?void 0:t.InternationalizationContext,null==(r=this.providers)?void 0:r.TelemetryConfig,null==(n=this.providers)?void 0:n.TokenProvider]);if(!i||!s)throw Error("No telemetryConfig or token provider");var a;return this.loopClient=new ka(e,{featureSwitches:{},hostContext:{hostSessionId:(null==i?void 0:i.hostSessionId)||"",hostLocaleContext:(null==o?void 0:o.uiLocale)||""},providers:{token:{getToken:async function(e){const t=e[0];if(1!==e.length||"https://analysis.windows-int.net/powerbi/api/.default"!==t&&"https://analysis.windows.net/powerbi/api/.default"!==t)throw Error("Incorrect token scopes requested");{const t=await(null==s?void 0:s.getToken(e));if(t){return{token:null==t?void 0:t.token}}throw Error("No token")}}}}}),this.props.url&&this.loopClient.open({url:null==(a=this.props.url)?void 0:a.toString(),launchPbiStartTime:this.launchPbiStartTime}),this.loopClient.renderPromise}async dispose(){this.element&&delete this.element}}class Ta{constructor(e,t){var r;this.powerBILoopInitialConfig=e,this.providers=t,this.name=Pa,this.iconUrl=(r="data:image/svg+xml,%3csvg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cg clip-path='url(%23clip0_2135_196676)'%3e%3cmask id='mask0_2135_196676' style='mask-type:alpha' maskUnits='userSpaceOnUse' x='2' y='0' width='16' height='20'%3e%3cpath d='M10.8333 0.833333C10.8333 0.61232 10.9211 0.400358 11.0774 0.244078C11.2337 0.0877974 11.4457 0 11.6667 0L16.6667 0C16.8877 0 17.0996 0.0877974 17.2559 0.244078C17.4122 0.400358 17.5 0.61232 17.5 0.833333V19.1667C17.5 19.3877 17.4122 19.5996 17.2559 19.7559C17.0996 19.9122 16.8877 20 16.6667 20H3.33333C3.11232 20 2.90036 19.9122 2.74408 19.7559C2.5878 19.5996 2.5 19.3877 2.5 19.1667V10.8333C2.5 10.6123 2.5878 10.4004 2.74408 10.2441C2.90036 10.0878 3.11232 10 3.33333 10H6.66667V5.83333C6.66667 5.61232 6.75446 5.40036 6.91074 5.24408C7.06702 5.0878 7.27899 5 7.5 5H10.8333V0.833333Z' fill='white'/%3e%3c/mask%3e%3cg mask='url(%23mask0_2135_196676)'%3e%3cpath d='M17.5 0V20H10.8333V0H17.5Z' fill='url(%23paint0_linear_2135_196676)'/%3e%3cg filter='url(%23filter0_f_2135_196676)'%3e%3cpath d='M13.3334 5.91671V20.0834H6.66669V5.08337H12.5C12.721 5.08337 12.933 5.17117 13.0893 5.32745C13.2456 5.48373 13.3334 5.69569 13.3334 5.91671Z' fill='black' fill-opacity='0.2'/%3e%3c/g%3e%3cg filter='url(%23filter1_f_2135_196676)'%3e%3cpath d='M13.3334 6.24996V20.4166H6.66669V5.41663H12.5C12.721 5.41663 12.933 5.50442 13.0893 5.6607C13.2456 5.81698 13.3334 6.02895 13.3334 6.24996Z' fill='black' fill-opacity='0.18'/%3e%3c/g%3e%3cpath d='M13.3334 5.83333V20H6.66669V5H12.5C12.721 5 12.933 5.0878 13.0893 5.24408C13.2456 5.40036 13.3334 5.61232 13.3334 5.83333Z' fill='url(%23paint1_linear_2135_196676)'/%3e%3cpath d='M2.5 10V20H9.16667V10.8333C9.16667 10.6123 9.07887 10.4004 8.92259 10.2441C8.76631 10.0878 8.55435 10 8.33333 10H2.5Z' fill='url(%23paint2_linear_2135_196676)'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cfilter id='filter0_f_2135_196676' x='6.26669' y='4.68337' width='7.46669' height='15.8' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='0.2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3cfilter id='filter1_f_2135_196676' x='2.66669' y='1.41663' width='14.6667' height='23' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3clinearGradient id='paint0_linear_2135_196676' x1='9.72206' y1='-1.22525e-07' x2='18.5135' y2='18.6348' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23E6AD10'/%3e%3cstop offset='1' stop-color='%23C87E0E'/%3e%3c/linearGradient%3e%3clinearGradient id='paint1_linear_2135_196676' x1='6.66606' y1='5' x2='14.0596' y2='19.3387' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F6D751'/%3e%3cstop offset='1' stop-color='%23E6AD10'/%3e%3c/linearGradient%3e%3clinearGradient id='paint2_linear_2135_196676' x1='2.49937' y1='10' x2='6.585' y2='19.6829' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F9E589'/%3e%3cstop offset='1' stop-color='%23F6D751'/%3e%3c/linearGradient%3e%3cclipPath id='clip0_2135_196676'%3e%3crect width='20' height='20' fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",{type:"image",source:r}).source,this.experienceType="Isolated",e.creationData.dataType===y.kW&&(this.initialURL=e.creationData.data.url),this.loopTitle=Pa}get HTMLViewable(){return this}get ContentURL(){return this}async getView(){return new Ea({url:this.initialURL},this.providers)}async getContentURL(){if(!this.initialURL)throw Error("Unable to retrieve URL");return this.initialURL}get ComponentTitle(){return this}on(e,t){return this}off(e,t){return this}get title(){return this.loopTitle}getTitle(){return Promise.resolve(this.loopTitle)}get ComponentProperties(){return this}get ComponentSerializable(){return this}async serialize(){throw Error("serialize is not implemented")}async rehydrate(e){throw Error("rehydrate is not implemented")}async getHtmlAsync(){var e;const t=document.createElement("a");return t.href=(null==(e=this.initialURL)?void 0:e.href)||"",t.textContent=this.loopTitle,t.rel="noreferrer noopener",t.outerHTML}async getTextAsync(){var e;return(null==(e=this.initialURL)?void 0:e.href)||""}}const Ia=new b.p(Ta,{InternationalizationContext:"InternationalizationContext",TelemetryConfig:"TelemetryConfig",TokenProvider:"TokenProvider"});var Na=Object.freeze({__proto__:null,PowerBIPortableComponent:Ta,loopExport:Ia}),Fa=E,Da=P,Oa=q,Ba=Object.defineProperty,xa={},La=function(e){throw e},Aa=Tt.includes,Ra=Vi,Ma=function(e,t){if(Oa(xa,e))return xa[e];t||(t={});var r=[][e],n=!!Oa(t,"ACCESSORS")&&t.ACCESSORS,o=Oa(t,0)?t[0]:La,i=Oa(t,1)?t[1]:void 0;return xa[e]=!!r&&!Da((function(){if(n&&!Fa)return!0;var e={length:-1};n?Ba(e,1,{enumerable:!0,get:La}):e[1]=1,r.call(e,o,i)}))};ir({target:"Array",proto:!0,forced:!Ma("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return Aa(this,e,arguments.length>1?arguments[1]:void 0)}}),Ra("includes");var _a=z,za=B,Ha=Sr("match"),Ua=function(e){var t;return _a(e)&&(void 0!==(t=e[Ha])?!!t:"RegExp"==za(e))},ja=Sr("match"),qa=function(e){if(Ua(e))throw TypeError("The method doesn't accept regular expressions");return e},Va=A,Ga=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[ja]=!1,"/./"[e](t)}catch(n){}}return!1};ir({target:"String",proto:!0,forced:!Ga("includes")},{includes:function(e){return!!~String(Va(this)).indexOf(qa(e),arguments.length>1?arguments[1]:void 0)}});var Wa={},Ka=P;function Ja(e,t){return RegExp(e,t)}Wa.UNSUPPORTED_Y=Ka((function(){var e=Ja("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),Wa.BROKEN_CARET=Ka((function(){var e=Ja("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));var Qa=$s,Xa=Wa,Za=RegExp.prototype.exec,$a=String.prototype.replace,Ya=Za,ec=function(){var e=/a/,t=/b*/g;return Za.call(e,"a"),Za.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),tc=Xa.UNSUPPORTED_Y||Xa.BROKEN_CARET,rc=void 0!==/()??/.exec("")[1];(ec||rc||tc)&&(Ya=function(e){var t,r,n,o,i=this,s=tc&&i.sticky,a=Qa.call(i),c=i.source,l=0,d=e;return s&&(-1===(a=a.replace("y","")).indexOf("g")&&(a+="g"),d=String(e).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==e[i.lastIndex-1])&&(c="(?: "+c+")",d=" "+d,l++),r=new RegExp("^(?:"+c+")",a)),rc&&(r=new RegExp("^"+c+"$(?!\\s)",a)),ec&&(t=i.lastIndex),n=Za.call(s?r:i,d),s?n?(n.input=n.input.slice(l),n[0]=n[0].slice(l),n.index=i.lastIndex,i.lastIndex+=n[0].length):i.lastIndex=0:ec&&n&&(i.lastIndex=i.global?n.index+n[0].length:t),rc&&n&&n.length>1&&$a.call(n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n});ir({target:"RegExp",proto:!0,forced:/./.exec!==Ya},{exec:Ya});let nc,oc,ic;const sc=function(){if("undefined"===typeof window)return!1;if(void 0===ic){const e=navigator.userAgentData;if(null!=e&&e.mobile)return!0;ic=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||(void 0===nc&&(nc=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),nc)||function(){if(void 0===oc){const e=navigator.userAgentData;oc=null!=e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return oc}()}return ic};class ac{canLoad(e){return e.packageName===wa&&!sc()}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details");return Promise.resolve().then((function(){return Na})).then((t=>({module:t,details:e})))}}const cc={instantiateLoopCodeLoader:e=>Promise.resolve(new ac)};async function lc(e){let t;switch(e){case n.J:{const e=await(0,v.Cw)();t=await e.getCodeLoaderFactory();break}case i:t=h;break;case o.JL:t=(await(0,v.vJ)()).getNpmCodeLoader();break;case wa:t=cc;break;case g.JL:t=f}return t}},59091:(e,t,r)=>{"use strict";r.d(t,{kx:()=>z,FM:()=>H,Om:()=>_});var n=r(83125),o=r(33788),i=r(95996),s=r(75460),a=r(16135),c=r(82963),l=r(32896);const d="FluidOdspDriver";var u=r(16876),h=r(63990);const g="fluidDevOverrides";var p=r(57063),m=r(93537),f=r(37805);const v="odspDriverManifestUrl";var y=r(52841);const b="fluidOdspDriverManifestCache_";function S(e){return b+(e||"Prod")}const C="v1",k="/odsp-driver/versionless/deploymentManifestOdspDriver.json",w=6048e5;async function P(e){const t=function(e){try{const t=function(e){var t;const r=null===(t=(0,y.A)())||void 0===t?void 0:t.getItem(S(e));return r?JSON.parse(r):null}(e);if(!t)return null;return Date.now()-t.lastUpdatedTime>w?null:t}catch(t){return null}}(e);return t?(function(e){(0,y.A)()&&(0,h.l)((()=>E(e,"low").catch((e=>{}))))}(e),t):await E(e)}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"high";const r=function(e){try{var t;return null===(t=window.top[g])||void 0===t?void 0:t[e]}catch(r){return}}(v)||(0,p.ox)(e)+k,n={method:"GET",priority:t};try{const t=await(0,m.J5)(r,n,{maxRetries:3,filter:(0,m.sC)([709,710]),backoffFn:(0,f.FT)(500)});if(t.result.ok){const r=await t.result.json();return function(e,t){var r;if(!(0,y.A)())return;const n={...e,lastUpdatedTime:Date.now()};null===(r=(0,y.A)())||void 0===r||r.setItem(S(t),JSON.stringify(n))}(r,e),r}throw new Error('Invalid response of "'.concat(t.result.statusText,'" with status ').concat(t.result.status))}catch(o){const e=o instanceof Error?o.message:void 0;throw new u.Ej("Error fetching ODSP Driver manifest".concat(" with message "+e),"OdspDriverFetchError",o)}}async function T(e){return function(e){return e.jsBaseUrl+"/"+e[C].index}(await P(e))}const I={GetOdspCode:"GetOdspCode"},N="OdspDriverCodeLoader",F="getServiceDeliveredOdspCode",D="Could not load service-delivered ODSP Driver Code";async function O(e){let{windowContext:t,environment:r,logger:i,trustedTypesPolicy:u,disposeOnCompletion:h}=e;const g=i&&new n.p(N,i),p=o.m.start(I.GetOdspCode,g,{addUserTiming:!0}),m=t;m[d]||(m[d]={});const f=m[d];try{var v;if(f.getDocumentServiceFactory)return p.setResult(!0,{message:"Namespace already loaded."}),f;if(f.scriptLoadingStarted){const e=new s.c;return f.pending||(f.pending=[]),f.pending.push({promise:e,logger:g}),await e,p.setResult(!0,{message:"Loaded from existing call."}),f}f.scriptLoadingStarted=!0;const e=(0,a.Rs)(r),t=await T(e),n=(0,c.c)(e),o=u&&{trustedTypesPolicy:await u,allowedOrigins:n};return await(0,l.a)(m,t,o),null===(v=f.pending)||void 0===v||v.forEach((e=>e.promise.resolve())),delete f.pending,p.setResult(!0,{message:"Loaded from first call."}),f}catch(b){var y;const e=new Error(D);throw b instanceof Error&&B(g,b),delete f.scriptLoadingStarted,null===(y=f.pending)||void 0===y||y.forEach((t=>{b instanceof Error&&B(t.logger,b),t.promise.reject(e)})),delete f.pending,p.setResult(!1,{},e),e}finally{h&&function(e){delete e[d]}(m)}}function B(e,t){e&&(0,i.hO)(e,{eventName:F},t)}var x=r(58443),L=r(69235),A=r(51655),R=r(81918),M=r(10042);let _=!1;class z{constructor(e,t){this.urlResolver=e,this.documentServiceFactory=t}get DriverImplementation(){return this}}async function H(e,t,r,o,i,s,a){var c;const l=3*x.sz,d=s?new M.f({partitionKey:a,logger:r,maxCacheItemAge:l}):void 0,u=t.environment,h=null!==(c=t.hostStoragePolicy)&&void 0!==c?c:{},g=r;h.enableRedeemFallback=!0;try{return _=!0,await async function(e){let{windowContext:t,environment:r,tokenProvider:o,trustedTypesPolicy:i,logger:s,driverCache:a,hostStoragePolicy:c,disposeOnCompletion:l}=e;const d=s&&new n.p(N,s);return(await O({windowContext:t,environment:r,logger:d,trustedTypesPolicy:i,disposeOnCompletion:l})).getDocumentServiceFactory({tokenProvider:o,logger:d,driverCache:a,hostStoragePolicy:c})}({windowContext:window,driverCache:d,environment:u,hostStoragePolicy:h,logger:g,tokenProvider:i,settingsProvider:o,disposeOnCompletion:!0,trustedTypesPolicy:void 0})}catch(p){(0,L.c2)("getDocumentServiceFactory()",new L.uV("getServiceDeliveredDocumentServiceFactory() failed.",p))}try{_=!1,e.odspModuleImportTracker=new A.q;const t=await e.odspModuleImportTracker.measure((()=>(0,R.Al)()));return(await t.getNpmSharepointDriver(i,g,d,h,{appName:void 0},o)).documentServiceFactory}catch(p){(0,L.c2)("getSharepointDriver()",(0,L.oD)(p))}throw new L.uV("Unable to get the document service factory.")}},27901:(e,t,r)=>{"use strict";function n(){return"".concat(o()+o(),"-").concat(o(),"-").concat(o(),"-").concat(o(),"-").concat(o()).concat(o()).concat(o())}function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}r.d(t,{_:()=>n})},13296:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>d,k3:()=>s,qP:()=>c,wP:()=>l});var n=r(91947);const o="ms-ContextualMenu",i="ms-Callout";function s(e,t){e.defaultPrevented||"Escape"==e.key&&async function(e,t){const r=e.target;if(!r)return!1;if(r===a)return!t;if(a&&a.contains(r))return!1;if(function(e){for(;e;){var t;const r=null===(t=e)||void 0===t?void 0:t.className;if(r&&(r.indexOf(o)>-1||r.indexOf(i)>-1))return!0;e=e.parentElement}return!1}(r))return!1;return!0}(e,t).then((t=>{t&&((0,n.wL)(e.key),e.preventDefault())}))}let a;function c(e){e&&(a=e)}function l(e){if(e.target&&a){const t=e.target;if(a.contains(t))return!0}return!1}function d(e){if(e.target&&a){return e.target===a}return!0}},64643:(e,t,r)=>{"use strict";var n;r.d(t,{q:()=>a});var o=r(899),i=r(16281);let s;async function a(){const e=(0,o.Mg)();try{return s||(s=await r(65606)("./".concat(e,"/strings.json"))),s}catch(t){return n||(n=r.t(i,2))}}},81918:(e,t,r)=>{"use strict";async function n(){return Promise.all([r.e(97950),r.e(8393),r.e(50924)]).then(r.bind(r,60724))}async function o(){return Promise.all([r.e(87212),r.e(13255),r.e(2440)]).then(r.bind(r,36713))}async function i(){return Promise.all([r.e(69808),r.e(97950),r.e(78167),r.e(94885),r.e(18806),r.e(15996),r.e(19779)]).then(r.bind(r,98123))}r.d(t,{Al:()=>o,Cw:()=>n,vJ:()=>i})},98123:(e,t,r)=>{"use strict";function n(){return i}r.r(t),r.d(t,{addReferralParamsToStreamUrl:()=>s,getNpmCodeLoader:()=>n});class o{canLoad(e){return"@fluidx/video-playback"===e.packageName}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return{module:await Promise.all([r.e(69808),r.e(97950),r.e(78167),r.e(94885),r.e(18806),r.e(15996),r.e(19779)]).then(r.bind(r,54918)),details:e}}}const i={instantiateLoopCodeLoader:()=>Promise.resolve(new o)};function s(e,t){if("MailCompose"!==t&&"MailRead"!==t)return e;const r=new URL(e);if(r.searchParams.has("url"))return e;return function(e,t,r,n){const o="".concat(t,".").concat(r),i=e.searchParams.getAll("referrer"),s=e.searchParams.getAll("referrerScenario");if(i.length>0&&i[i.length-1]===o){if(!n)return;if(n&&s.length>0&&s[s.length-1]===n)return}e.searchParams.append("referrer",o),n&&e.searchParams.append("referrerScenario",n)}(r,"Outlook","Win32","email-linkwithembed"),r.toString()}},6971:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var n=r(91947);let o;async function i(){return o||(o=(0,n.KE)()),o}},16460:(e,t,r)=>{"use strict";r.d(t,{$R:()=>a,$h:()=>m,D4:()=>i,DP:()=>u,DS:()=>S,ED:()=>p,Lb:()=>s,Md:()=>C,QF:()=>l,U4:()=>h,Vg:()=>E,WU:()=>f,Yz:()=>g,fQ:()=>P,gC:()=>w,gp:()=>d,hj:()=>v,tM:()=>b,us:()=>k});var n=r(6971);class o extends EventTarget{constructor(){super()}}let i=function(e){return e.BackgroundChanged="BackgroundChanged",e.ContentPlayableStateUpdate="ContentPlayableStateUpdate",e.FluidComponentDataSaved="FluidComponentDataSaved",e.FocusEvent="FocusEvent",e.IsContentHeightLimitedChanged="IsContentHeightLimitedChanged",e.LinkPermissionChanged="LinkPermissionChanged",e.LinkProblemStateChanged="LinkProblemStateChanged",e.LinkUrlChanged="LinkUrlChanged",e.ReadOnlyChanged="ReadOnlyChanged",e.RequestDataToSave="RequestDataToSave",e.ShowLoopGlowBorder="ShowLoopGlowBorder",e.ThemeChanged="ThemeChanged",e}({}),s=function(e){return e[e.Unknown=0]="Unknown",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e}({}),a=function(e){return e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e}({});const c=new o;async function l(e){const t=await(0,n.E)();if(!t.version)return!1;switch(e){case i.LinkUrlChanged:case i.ThemeChanged:return t.version>=2;case i.LinkPermissionChanged:return t.version>=2&&t.version<=5;case i.LinkProblemStateChanged:return t.version>=5;case i.BackgroundChanged:return t.version>=6;case i.IsContentHeightLimitedChanged:return t.version>=15;case i.RequestDataToSave:case i.FluidComponentDataSaved:return t.version>=16;case i.ShowLoopGlowBorder:return t.version>=20;default:return!1}}function d(e){c.addEventListener(i.BackgroundChanged,e)}function u(e){c.addEventListener(i.ContentPlayableStateUpdate,e)}function h(e){c.addEventListener(i.FluidComponentDataSaved,e)}function g(e){c.removeEventListener(i.FluidComponentDataSaved,e)}function p(e){c.addEventListener(i.IsContentHeightLimitedChanged,e)}function m(e){c.addEventListener(i.LinkPermissionChanged,e)}function f(e){c.addEventListener(i.LinkProblemStateChanged,e)}function v(e){c.addEventListener(i.LinkUrlChanged,e)}function y(e,t){c.dispatchEvent(new CustomEvent(e,{detail:t}))}function b(e){c.addEventListener(i.RequestDataToSave,e)}function S(e){c.removeEventListener(i.RequestDataToSave,e)}function C(e){c.addEventListener(i.ShowLoopGlowBorder,e)}function k(e){c.addEventListener(i.FocusEvent,e)}function w(e){c.addEventListener(i.ReadOnlyChanged,e)}function P(e){c.addEventListener(i.ThemeChanged,e)}function E(){Object.defineProperty(window,"onNativeEvent",{value:y})}},40684:(e,t,r)=>{"use strict";r.d(t,{QK:()=>c,qH:()=>h,tR:()=>a,zr:()=>m});var n=r(899),o=r(31942),i=r(56142),s=r(69235);let a=function(e){return e[e.GetToken=1e3]="GetToken",e[e.SizeChanged=1001]="SizeChanged",e[e.GetFeature=1002]="GetFeature",e[e.SendTelemetry=1003]="SendTelemetry",e[e.ReportActivityResult=1004]="ReportActivityResult",e[e.GetUserIdentity=1006]="GetUserIdentity",e[e.GetNativeInfo=1007]="GetNativeInfo",e[e.ShowPermissionCallout=1008]="ShowPermissionCallout",e[e.CaretPositionChanged=1009]="CaretPositionChanged",e[e.OnAtMention=1010]="OnAtMention",e[e.OnInvokeFromInjectedScript=1011]="OnInvokeFromInjectedScript",e[e.FluidComponentCreated=1012]="FluidComponentCreated",e[e.IsChangeGateEnabled=1013]="IsChangeGateEnabled",e[e.FluidHostIsReady=1015]="FluidHostIsReady",e[e.PassKeyToHost=1016]="PassKeyToHost",e[e.GetDataForCreate=1017]="GetDataForCreate",e[e.SetCanProvideDataToSave=1018]="SetCanProvideDataToSave",e[e.ProvideDataToSave=1019]="ProvideDataToSave",e[e.FluidComponentEdited=1020]="FluidComponentEdited",e[e.TeachingCalloutDismissed=1021]="TeachingCalloutDismissed",e[e.TeachingCalloutShown=1022]="TeachingCalloutShown",e[e.FluidComponentCreateFailed=1023]="FluidComponentCreateFailed",e[e.InvokeMessageExtensionCommand=1024]="InvokeMessageExtensionCommand",e[e.LoopComponentCreated=1025]="LoopComponentCreated",e[e.Dehydrate=1026]="Dehydrate",e[e.SaveEmbeddedData=1027]="SaveEmbeddedData",e[e.UpdateLoopInfo=1028]="UpdateLoopInfo",e[e.CursUpDownFromE2o=1029]="CursUpDownFromE2o",e[e.ClearYCaretCoordinate=1030]="ClearYCaretCoordinate",e[e.GetOcps=1031]="GetOcps",e[e.ScrollHost=1032]="ScrollHost",e}({}),c=function(e){return e[e.Hydrate=0]="Hydrate",e}({});class l extends Error{constructor(e,t){super(t),this.errorCode=void 0,this.errorCode=e}}let d=function(e){return e[e.fixed=0]="fixed",e[e.growHeight=1]="growHeight",e[e.grow=2]="grow",e}({});function u(e){return a[e]}function h(e){switch(e){case o.S.grow:return d.grow;case o.S.growHeight:return d.growHeight;case o.S.fixedByHost:return d.fixed;default:throw new s.uV("Unknown LayoutMode")}}let g=0;const p=!1;function m(e,t){return new Promise(((r,o)=>{try{const c=function(e){if(p){++g;const t=a[e];return(0,i.Rm)("[".concat(g,"] Native method called: ").concat(t)),{invocation:g,methodName:t,timeStart:performance.now()}}return}(e);n.qn&&n.qn.Execute||o(new l(void 0,"Native requests are not supported.")),n.qn.Execute(e,t,((t,n)=>{if(function(e){if(e){const t=performance.now()-e.timeStart;(0,i.Rm)("[".concat(e.invocation,"] Native method return: ").concat(e.methodName," (Duration: ").concat(t,")"))}}(c),!t)throw new s.uV("The callback did not provide any data.");const a=t.toArray();if(!Array.isArray(a))throw new s.uV("The callback data is not an array.");0===a.length&&a.push("number"===typeof n?n:0);const[d,...h]=a;if("number"!==typeof d)throw new s.uV("The first item returned should be an error code number.");if(0===d)r(h);else{const[t]=h,r="string"===typeof t?"\n".concat(t):"";o(new l(d,"".concat(u(e)," native method failed. Error code: ").concat(d).concat(r)))}}))}catch(c){o(new l(void 0,"Unexpected response from native request: ".concat(u(e),".\n").concat(c instanceof Error?c.message:c)))}}))}},91947:(e,t,r)=>{"use strict";r.d(t,{CE:()=>g,CQ:()=>M,Ht:()=>d,Jc:()=>R,Jn:()=>B,KE:()=>w,KJ:()=>A,PA:()=>T,UT:()=>L,Vp:()=>_,XQ:()=>z,Y0:()=>b,_d:()=>u,a5:()=>H,a7:()=>O,eH:()=>k,gf:()=>P,hw:()=>p,kF:()=>y,lW:()=>h,nA:()=>v,n_:()=>C,nt:()=>N,sQ:()=>m,wL:()=>F,wW:()=>x,w_:()=>E,x$:()=>S,xh:()=>f,y7:()=>D});var n=r(58443),o=r(69235),i=r(51492),s=r(56142),a=r(6971),c=r(40684);let l=function(e){return e[e.boolean=0]="boolean",e[e.integer=1]="integer",e[e.string=2]="string",e}({});async function d(e){await(0,c.zr)(c.tR.CaretPositionChanged,[e])}async function u(){await I(c.tR.ClearYCaretCoordinate)&&await(0,c.zr)(c.tR.ClearYCaretCoordinate,[])}async function h(e){await(0,c.zr)(c.tR.CursUpDownFromE2o,[e?1:-1])}async function g(e){try{if(await I(c.tR.GetOcps)){const[t]=await(0,c.zr)(c.tR.GetOcps,[e]);return t}return}catch(t){return}}async function p(){await I(c.tR.Dehydrate)&&await(0,c.zr)(c.tR.Dehydrate,[])}async function m(e,t){await(0,c.zr)(c.tR.FluidComponentCreated,[e,t])}async function f(e){await I(c.tR.FluidComponentCreateFailed)&&await(0,c.zr)(c.tR.FluidComponentCreateFailed,[e])}async function v(){await I(c.tR.FluidComponentEdited)&&await(0,c.zr)(c.tR.FluidComponentEdited,[])}async function y(){try{await I(c.tR.FluidHostIsReady)&&await(0,c.zr)(c.tR.FluidHostIsReady,[])}catch(e){(0,o.c2)("fluidHostIsReady()",(0,o.oD)(e))}}async function b(){if(await I(c.tR.GetDataForCreate)){const[e]=await(0,c.zr)(c.tR.GetDataForCreate,[]);if("string"!==typeof e)throw new o.uV("The data returned is not a string.");return e}return""}async function S(e,t){const r=[(0,i.dK)(e,t),l.boolean],[o]=await(0,c.zr)(c.tR.GetFeature,r).catch((e=>(n.Nu||(0,s.vV)(e),[!1])));return"boolean"===typeof o&&o}async function C(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!Number.isInteger(r))throw new o.uV("The default value must be an integer.");const a=[(0,i.dK)(e,t),l.integer,r],[d]=await(0,c.zr)(c.tR.GetFeature,a).catch((e=>(n.Nu||(0,s.vV)(e),[r])));return"number"===typeof d?d:r}async function k(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const o=[(0,i.dK)(e,t),l.string,r],[a]=await(0,c.zr)(c.tR.GetFeature,o).catch((e=>(n.Nu||(0,s.vV)(e),[r])));return"string"===typeof a?a:r}async function w(){const[e]=await(0,c.zr)(c.tR.GetNativeInfo,[]).catch((()=>["{}"]));if("string"!==typeof e)throw new Error("A string should be returned.");const t=JSON.parse(e);if(!t)throw new Error("Unable to parse the native info json.");return t}async function P(e,t){const r=[e,null!==t&&void 0!==t?t:"",!0],[n]=await(0,c.zr)(c.tR.GetToken,r);if("string"!==typeof n)throw new o.uV("Token should be a string.");return n}async function E(e,t){if(await I(c.tR.InvokeMessageExtensionCommand)){const[r]=await(0,c.zr)(c.tR.InvokeMessageExtensionCommand,[e,JSON.stringify(t)]);if("string"!==typeof r)throw new o.uV("The data returned is not a string.");return JSON.parse(r)}}async function T(e,t){if(!await I(c.tR.IsChangeGateEnabled))return!0;const[r]=await(0,c.zr)(c.tR.IsChangeGateEnabled,[e,t]).catch((e=>(n.Nu||(0,s.vV)(e),[!0])));return"boolean"!==typeof r||r}async function I(e){const t=await(0,a.E)();if(!t.version)return!1;switch(e){case c.tR.GetFeature:case c.tR.GetNativeInfo:case c.tR.GetToken:case c.tR.GetUserIdentity:case c.tR.ReportActivityResult:case c.tR.SendTelemetry:return t.version>=1;case c.tR.ShowPermissionCallout:return t.version>=2;case c.tR.CaretPositionChanged:return t.version>=3;case c.tR.OnAtMention:return t.version>=4;case c.tR.OnInvokeFromInjectedScript:return t.version>=8;case c.tR.FluidComponentCreated:return t.version>=9;case c.tR.IsChangeGateEnabled:return t.version>=10;case c.tR.FluidHostIsReady:return t.version>=12;case c.tR.PassKeyToHost:return t.version>=13;case c.tR.GetDataForCreate:return t.version>=15;case c.tR.SetCanProvideDataToSave:case c.tR.ProvideDataToSave:case c.tR.FluidComponentEdited:return t.version>=16;case c.tR.TeachingCalloutDismissed:case c.tR.TeachingCalloutShown:return t.version>=17;case c.tR.FluidComponentCreateFailed:return t.version>=18;case c.tR.InvokeMessageExtensionCommand:return t.version>=22;case c.tR.Dehydrate:return t.version>=24;case c.tR.SaveEmbeddedData:return t.version>=25;case c.tR.UpdateLoopInfo:return t.version>=26;case c.tR.CursUpDownFromE2o:return t.version>=28;case c.tR.GetOcps:return t.version>=32;case c.tR.ScrollHost:return t.version>=33;default:return!1}}async function N(e,t){await(0,c.zr)(c.tR.OnAtMention,[e,t])}async function F(e){const t=function(e){const t=27;if("Escape"===e)return t;return void(0,s.vV)("Unsupported key: ".concat(e))}(e);t&&await(0,c.zr)(c.tR.PassKeyToHost,[t])}async function D(e,t){await I(c.tR.ScrollHost)&&await(0,c.zr)(c.tR.ScrollHost,[e,t])}async function O(e,t,r,n){await I(c.tR.ProvideDataToSave)&&await(0,c.zr)(c.tR.ProvideDataToSave,[e,t,r,n])}async function B(e,t,r){const n=[e,t,r];await(0,c.zr)(c.tR.ReportActivityResult,n).catch(s.vV)}async function x(e){await(0,c.zr)(c.tR.SendTelemetry,e)}async function L(e){await I(c.tR.SetCanProvideDataToSave)&&await(0,c.zr)(c.tR.SetCanProvideDataToSave,[e])}async function A(e){await I(c.tR.SaveEmbeddedData)&&await(0,c.zr)(c.tR.SaveEmbeddedData,[e])}async function R(){await(0,c.zr)(c.tR.ShowPermissionCallout,[])}async function M(e,t,r){n.Nu||(0,s.Rm)("Size changed: ".concat(e," x ").concat(t)),await(0,c.zr)(c.tR.SizeChanged,[e,t,(0,c.qH)(r)])}async function _(e){await(0,c.zr)(c.tR.TeachingCalloutDismissed,[e])}async function z(){await(0,c.zr)(c.tR.TeachingCalloutShown,[])}async function H(e){if(await I(c.tR.UpdateLoopInfo)){const t=JSON.stringify(e);await(0,c.zr)(c.tR.UpdateLoopInfo,[t])}}},26140:(e,t,r)=>{"use strict";function n(){return performance.now()}function o(){return performance.getEntriesByType("resource")}r.d(t,{F:()=>n,T:()=>o})},62231:(e,t,r)=>{"use strict";function n(){return r.e(26853).then(r.bind(r,52564)).then((e=>e.getInstance()))}r.d(t,{H:()=>n})},4311:(e,t,r)=>{"use strict";r.d(t,{RG:()=>d,ZQ:()=>u,fZ:()=>l});var n=r(69235),o=r(18206),i=r(40635),s=r(60138),a=r(56142);const c=new s.z;async function l(){const e=new URL("https://graph.microsoft.com/v1.0/me/drive"),t=e.origin,r=await(0,o.z$)((e=>c.getTokenWithRetries([t],e)),e.href);if(r.ok){const e=await r.json(),t=null===e||void 0===e?void 0:e.webUrl,n=t?t.split("/").slice(0,-1).join("/"):t;return{id:(null===e||void 0===e?void 0:e.id)||"",siteUrl:n||""}}throw new n.uV("Unable to get the Sharepoint drive info. [".concat(r.status," ").concat(r.statusText,"]"))}async function d(e){"string"===typeof e&&(e=new URL(e));const t=e.origin,r="".concat(t,"/_api/v2.0/shares/").concat(function(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}(e.href));(0,a.Rm)("Getting file name from Sharepoint...");const o=(await(0,i.y)({url:r,getToken:e=>c.getTokenWithRetries([t],e)})).result;if(o.ok){const e=await o.json();return(null===e||void 0===e?void 0:e.name)||""}throw new n.uV("Unable to get filename from Sharepoint. [".concat(o.status," ").concat(o.statusText,"]"))}async function u(e){const t=new URL("https://graph.microsoft.com/v1.0/me/drive/special/".concat(e)),r=t.origin,i=await(0,o.z$)((e=>c.getTokenWithRetries([r],e)),t.href);if(i.ok){const e=await i.json();return(null===e||void 0===e?void 0:e.name)||""}throw new n.uV("Unable to get special folder name. [".concat(i.status," ").concat(i.statusText,"]"))}},24921:(e,t,r)=>{"use strict";function n(e){return new Promise(((t,r)=>{try{setTimeout(t,e)}catch(n){r(n)}}))}r.d(t,{y:()=>n})},27377:(e,t,r)=>{"use strict";r.d(t,{O:()=>g,_:()=>h});r(65043);const n=r.p+"static/media/DarkBackground.f9c4b682680f49530d388ba0f2830809.svg";const o=r.p+"static/media/LightBackground.d93751152f3824d76f84f995fec9752f.svg";const i=r.p+"static/media/LightShimmerLoading.838ac9544853d68b3b1b62a5009ecef8.svg";const s=r.p+"static/media/DarkShimmerLoading.5bd608fb2a16127c459c6027848848ce.svg";const a=r.p+"static/media/DarkBackground_Old.df15325639cb5218602d4da3c7467955.svg";const c=r.p+"static/media/LightBackground_Old.f5416049e2f7d9abee2b5d9386b6fe77.svg";const l=r.p+"static/media/LightShimmerLoading_Old.ea2f880c2eab4e2bba069ba794390732.svg";const d=r.p+"static/media/DarkShimmerLoading_Old.e340d47723d2a30dc95ec74facf4f8b6.svg";var u=r(58443);function h(){const e=document.getElementById(u.bY),t=document.getElementById(u.xu);e&&(e.hidden=!0),null===t||void 0===t||t.removeAttribute("hidden")}function g(e,t){return t?e?{background:n,shimmer:s}:{background:o,shimmer:i}:e?{background:a,shimmer:d}:{background:c,shimmer:l}}},53450:(e,t,r)=>{"use strict";r.d(t,{r:()=>a});var n=r(37450),o=r(90589),i=r(58443),s=r(82645);class a{constructor(e,t){this.activity=void 0,this.activity=s.u.createActivity({eventName:"Office.Extensibility.Fluid.HostWebApp."+e,eventFlags:{dataCategories:n.o.DataCategories.ProductServiceUsage,diagnosticLevel:n.o.DiagnosticLevel.FullEvent}}),this.addStringDataField("HydrateId",t)}async endActivity(e,t,r){this.activity&&(await this.addDataFieldsToActivity(t,r),this.activity.success=e,this.activity.setResult(t),i.KV&&this.activity.endNow())}addInt64DataField(e,t){var r;const n=(0,o.Ug)(e,Math.floor(t));this.activity&&(null!==(r=this.activity)&&void 0!==r&&r.dataFields?this.activity.dataFields.push(n):this.activity.dataFields=[n])}addStringDataField(e,t){const r=(0,o.m9)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}addBooleanDataField(e,t){const r=(0,o.LK)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}}},51655:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var n=r(69235),o=r(26140);class i{constructor(){this.startTime=void 0,this.stopTime=void 0,this.isSuccess=!1,this.error=void 0}measure(e){try{this.start();const t=e();return this.setSuccess(),t}catch(t){throw this.setFailure(t),t}}start(e){if(this.startTime)throw new n.uV("PerfTracker.start() called when already started.");this.startTime=e||i.getTimePoint()}stop(){const e=i.getTimePoint();if(!this.stopTime){if(!this.startTime)throw new n.uV("PerTracker.stop() called when not started.");this.stopTime=e}}static getTimePoint(){return 1e3*(0,o.F)()}getDuration(){if(this.startTime){const e=(this.stopTime||i.getTimePoint())-this.startTime;return Math.floor(e)}return 0}getDurationInSeconds(){return this.getDuration()/1e6}setSuccess(){this.stop(),this.isSuccess=!0}setFailure(e){this.stop(),this.isSuccess=!1,this.error=e}static startNew(e){const t=new i;return t.start(e),t}}},94115:(e,t,r)=>{"use strict";r.d(t,{i:()=>g,y:()=>h});var n=r(60138),o=r(25573),i=r(85656),s=r(97232),a=r(53450),c=r(51655),l=r(26140),d=r(59091),u=r(69235);let h=function(e){return e[e.Success=0]="Success",e[e.LoadComponentError=1]="LoadComponentError",e[e.RenderComponentError_PromiseRejected=2]="RenderComponentError_PromiseRejected",e[e.RenderComponentError_NoComponent=3]="RenderComponentError_NoComponent",e[e.RenderComponentError_CannotRender=4]="RenderComponentError_CannotRender",e}({});class g extends a.r{constructor(e,t,r,n){super("ShowComponent",e),this.WebAppMainPerfTracker=void 0,this.LoadPerfTracker=void 0,this.InitialRenderPerfTracker=void 0,this.AppLazyImportTracker=void 0,this.AppLazyStartTracker=void 0,this.ComponentRenderPerfTracker=void 0,this.GetTokenCount=void 0,this.GetTokenTotalDuration=void 0,this.GetTokenSucceededAfterRetryCount=void 0,this.EndTime=void 0,this.EnforceInformationProtectionPerfTracker=void 0,this.odspModuleImportTracker=void 0,this.addStringDataField("ScenarioName",t),this.addStringDataField("Fluid_Audience",r),this.setWebAppMainPerfTracker(n)}setWebAppMainPerfTracker(e){this.WebAppMainPerfTracker=c.q.startNew(e)}setLoadPerfTracker(){this.LoadPerfTracker=c.q.startNew()}setInitialRenderPerfTracker(){this.InitialRenderPerfTracker=c.q.startNew()}setAppLazyImportPerfTracker(){this.AppLazyImportTracker=c.q.startNew()}setAppLazyStartPerfTracker(){this.AppLazyStartTracker=c.q.startNew()}setComponentRenderPerfTracker(){this.ComponentRenderPerfTracker=c.q.startNew()}setEnforceInformationProtectionPerfTracker(){this.EnforceInformationProtectionPerfTracker=c.q.startNew()}onLoadComplete(e){var t;null===(t=this.LoadPerfTracker)||void 0===t||t.setSuccess(),e instanceof n.z&&(this.GetTokenCount=e.getTokenCallCount,this.GetTokenTotalDuration=e.getTokenTotalDuration,this.GetTokenSucceededAfterRetryCount=e.getTokenSucceededAfterRetryCount)}addResourceMetrics(){const e=(0,l.T)(),t=e.find((e=>e.name.match("https://fa000000084.resources.office.net/static/js/268.(.*).chunk.js"))),r=e.find((e=>e.name.match("https://fa000000084.resources.office.net/static/js/main.(.*).chunk.js")));t&&(void 0!=t.startTime&&this.addInt64DataField("LoadResourceBundleStart",t.startTime),void 0!=t.duration&&this.addInt64DataField("LoadResourceBundleDuration",t.duration)),r&&(void 0!=r.startTime&&this.addInt64DataField("LoadResourceMainStart",r.startTime),void 0!=r.duration&&this.addInt64DataField("LoadResourceMainDuration",r.duration))}async sendTelemetryForSuccess(){await this.endActivity(!0,h.Success),this.EndTime=(0,o.W)(),(0,i.$)(s.d.Success_Hydrated)}async sendTelemetryForFailure(e,t,r){const n=null===r||void 0===r?void 0:r.errorType,s=null===r||void 0===r?void 0:r.name,a=(0,u.aK)(r)||n||s;await this.endActivity(!1,e,a),this.EndTime=(0,o.W)(),(0,i.$)(t)}async addDataFieldsToActivity(e,t){var r,n,o,i,s,a,c,l,u,g,p,m,f,v,y;(null===(r=this.WebAppMainPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("WebAppMainStartTime",this.WebAppMainPerfTracker.startTime),(null===(n=this.WebAppMainPerfTracker)||void 0===n?void 0:n.getDuration)&&this.addInt64DataField("WebAppMainDuration",this.WebAppMainPerfTracker.getDuration()),this.WebAppMainPerfTracker&&this.addBooleanDataField("WebAppMainSuccess",this.WebAppMainPerfTracker.isSuccess),(null===(o=this.LoadPerfTracker)||void 0===o?void 0:o.startTime)&&this.addInt64DataField("LoadStartTime",this.LoadPerfTracker.startTime),(null===(i=this.LoadPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("LoadDuration",this.LoadPerfTracker.getDuration()),this.LoadPerfTracker&&this.addBooleanDataField("LoadSuccess",this.LoadPerfTracker.isSuccess),(null===(s=this.AppLazyImportTracker)||void 0===s?void 0:s.startTime)&&this.addInt64DataField("AppLazyImportStartTime",this.AppLazyImportTracker.startTime),(null===(a=this.AppLazyImportTracker)||void 0===a?void 0:a.getDuration)&&this.addInt64DataField("AppLazyImportDuration",this.AppLazyImportTracker.getDuration()),this.AppLazyImportTracker&&this.addBooleanDataField("AppLazyImportSuccess",this.AppLazyImportTracker.isSuccess),(null===(c=this.AppLazyStartTracker)||void 0===c?void 0:c.startTime)&&this.addInt64DataField("AppLazyStartStartTime",this.AppLazyStartTracker.startTime),(null===(l=this.AppLazyStartTracker)||void 0===l?void 0:l.getDuration)&&this.addInt64DataField("AppLazyStartDuration",this.AppLazyStartTracker.getDuration()),this.AppLazyStartTracker&&this.addBooleanDataField("AppLazyStartSuccess",this.AppLazyStartTracker.isSuccess),(null===(u=this.InitialRenderPerfTracker)||void 0===u?void 0:u.startTime)&&this.addInt64DataField("InitialRenderStartTime",this.InitialRenderPerfTracker.startTime),(null===(g=this.InitialRenderPerfTracker)||void 0===g?void 0:g.getDuration)&&this.addInt64DataField("InitialRenderDuration",this.InitialRenderPerfTracker.getDuration()),this.InitialRenderPerfTracker&&this.addBooleanDataField("InitialRenderSuccess",this.InitialRenderPerfTracker.isSuccess),(null===(p=this.ComponentRenderPerfTracker)||void 0===p?void 0:p.startTime)&&this.addInt64DataField("ComponentRenderStartTime",this.ComponentRenderPerfTracker.startTime),(null===(m=this.ComponentRenderPerfTracker)||void 0===m?void 0:m.getDuration)&&this.addInt64DataField("ComponentRenderDuration",this.ComponentRenderPerfTracker.getDuration()),this.ComponentRenderPerfTracker&&this.addBooleanDataField("ComponentRenderSuccess",this.ComponentRenderPerfTracker.isSuccess),(null===(f=this.EnforceInformationProtectionPerfTracker)||void 0===f?void 0:f.getDuration)&&this.addInt64DataField("EnforceInformationProtectionDuration",this.EnforceInformationProtectionPerfTracker.getDuration()),this.addBooleanDataField("IsUsingServiceDeliveredODSPDriver",d.Om),this.GetTokenCount&&this.addInt64DataField("GetTokenCount",this.GetTokenCount),this.GetTokenTotalDuration&&this.addInt64DataField("GetTokenTotalDuration",this.GetTokenTotalDuration),this.GetTokenSucceededAfterRetryCount&&this.addInt64DataField("GetTokenSucceededAfterRetryCount",this.GetTokenSucceededAfterRetryCount),(null===(v=this.odspModuleImportTracker)||void 0===v?void 0:v.startTime)&&this.addInt64DataField("OdspModuleImportStartTime",this.odspModuleImportTracker.startTime),(null===(y=this.odspModuleImportTracker)||void 0===y?void 0:y.getDuration)&&this.addInt64DataField("OdspModuleImportDuration",this.odspModuleImportTracker.getDuration()),this.addResourceMetrics(),this.addStringDataField("ResultType",h[e]),t&&this.addStringDataField("ErrorMessage",t)}}},82645:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var n=r(11517),o=r(60119);const i=function(){const e=new n.M;return e.addSink(o.a),e.setTenantToken("Office.Extensibility","db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",1755),e}()},85656:(e,t,r)=>{"use strict";r.d(t,{G:()=>h,$:()=>g});var n=r(5482),o=r(56142),i=r(91947),s=r(40684),a=r(97232),c=r(59592),l=r(72831);const d={...c.a_,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"};var u;function h(e){const t={[l.Dm.clientSessionExpiredError]:a.d.Error_FluidContainer_ClientSessionExpiredError,[l.Dm.dataCorruptionError]:a.d.Error_FluidContainer_DataCorruption,[l.Dm.dataProcessingError]:a.d.Error_FluidContainer_DataProcessingError,[l.Dm.genericError]:a.d.Error_FluidContainer_GeneralError,[l.Dm.throttlingError]:a.d.Error_FluidContainer_ThrottlingError,[l.Dm.usageError]:a.d.Error_FluidContainer_UsageError,[n.qb.RootComponentCreateFailed]:a.d.Error_FluidContainerLoad_RootComponentCreateFailed,[n.qb.RaasNotSupported]:a.d.Error_FluidContainerLoad_RaasNotSupported,[c.a_.authorizationError]:a.d.ExpectedError_FluidDriver_AuthorizationError,[c.a_.deltaStreamConnectionForbidden]:a.d.Error_FluidDriver_DeltaStreamConnectionForbidden,[c.a_.fetchFailure]:a.d.ExpectedError_FluidDriver_FetchFailure,[c.a_.fileNotFoundOrAccessDeniedError]:a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied,[c.a_.fileOverwrittenInStorage]:a.d.Error_FluidDriver_FileOverwrittenInStorage,[c.a_.fluidInvalidSchema]:a.d.Error_FluidDriver_FluidInvalidSchema,[c.a_.genericError]:a.d.Error_FluidDriver_GenericError,[c.a_.genericNetworkError]:a.d.Error_FluidDriver_GenericNetworkError,[c.a_.incorrectServerResponse]:a.d.Error_FluidDriver_IncorrectServerResponse,[c.a_.locationRedirection]:a.d.Error_FluidDriver_LocationRedirection,[c.a_.offlineError]:a.d.ExpectedError_FluidDriver_OfflineError,[c.a_.throttlingError]:a.d.Error_FluidDriver_ThrottlingError,[c.a_.usageError]:a.d.Error_FluidDriver_UsageError,[c.a_.unsupportedClientProtocolVersion]:a.d.Error_FluidDriver_UnsupportedClientProtocolVersion,[c.a_.writeError]:a.d.Error_FluidDriver_WriteError,[c.a_.fileIsLocked]:a.d.Error_FluidDriver_FileIsLocked,[d.cannotCatchUp]:a.d.Error_FluidOdsp_CannotCatchUp,[d.fetchTimeout]:a.d.Error_FluidOdsp_FetchTimeout,[d.fetchTokenError]:a.d.Error_FluidOdsp_FetchTokenError,[d.fluidNotEnabled]:a.d.ExpectedError_FluidOdsp_FluidNotEnabled,[d.invalidFileNameError]:a.d.Error_FluidOdsp_InvalidFileNameError,[d.outOfStorageError]:a.d.Error_FluidOdsp_OutOfStorageError,[d.serviceReadOnly]:a.d.Error_FluidOdsp_ServiceReadOnly,[d.snapshotTooBig]:a.d.Error_FluidOdsp_SnapshotTooBig,[d.blockedIPAddress]:a.d.Error_FluidOdsp_BlockedIPAddress,[n.ZY.ComponentNotFound]:a.d.Error_FluidOWH_ComponentNotFound,[n.ZY.ContainerUpgradeRequired]:a.d.Error_FluidOWH_ContainerUpgradeRequired,[n.ZY.IframeLoadFailed]:a.d.Error_FluidOWH_IFrameLoadFailed,[n.v6]:a.d.Error_Fluid_UnknownError};return e?t[e]:a.d.Error_Fluid_Undefined}function g(e){const t=function(e){switch(e){case a.d.Success_Hydrated:case a.d.Success_NoFluidUrl:case a.d.ExpectedError_FluidDriver_AuthorizationError:case a.d.ExpectedError_FluidDriver_FetchFailure:case a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied:case a.d.ExpectedError_FluidDriver_OfflineError:case a.d.ExpectedError_FluidOdsp_FluidNotEnabled:case a.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest:return!0;default:return!1}}(e);return(0,o.Rm)("Hydrate ".concat(t?"succeeded":"failed",": ").concat(a.d[e]," (").concat(e,").")),(0,i.Jn)(s.QK.Hydrate,t,e)}!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly",e.blockedIPAddress="blockedIPAddress"}(u||(u={}))},97232:(e,t,r)=>{"use strict";r.d(t,{d:()=>n});let n=function(e){return e[e.Success_Hydrated=0]="Success_Hydrated",e[e.Success_E2oNotViewed=1]="Success_E2oNotViewed",e[e.Success_NoFluidUrl=2]="Success_NoFluidUrl",e[e.Success_Aborted=3]="Success_Aborted",e[e.Error_FluidHostWebApp_Exception=500]="Error_FluidHostWebApp_Exception",e[e.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest=501]="ExpectedError_FluidHostWebApp_CannotFetchContainerManifest",e[e.Error_Fluid_Undefined=1e3]="Error_Fluid_Undefined",e[e.Error_Fluid_UnknownError=1001]="Error_Fluid_UnknownError",e[e.Error_RenderFailed=1002]="Error_RenderFailed",e[e.Error_FluidContainer_DataCorruption=2e3]="Error_FluidContainer_DataCorruption",e[e.Error_FluidContainer_GeneralError=2001]="Error_FluidContainer_GeneralError",e[e.Error_FluidContainer_ThrottlingError=2002]="Error_FluidContainer_ThrottlingError",e[e.Error_FluidContainer_DataProcessingError=2003]="Error_FluidContainer_DataProcessingError",e[e.Error_FluidContainer_UsageError=2004]="Error_FluidContainer_UsageError",e[e.Error_FluidContainer_ClientSessionExpiredError=2005]="Error_FluidContainer_ClientSessionExpiredError",e[e.ExpectedError_FluidDriver_AuthorizationError=3e3]="ExpectedError_FluidDriver_AuthorizationError",e[e.ExpectedError_FluidDriver_FetchFailure=3001]="ExpectedError_FluidDriver_FetchFailure",e[e.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied=3002]="ExpectedError_FluidDriver_FileNotFoundOrAccessDenied",e[e.Error_FluidDriver_GenericError=3003]="Error_FluidDriver_GenericError",e[e.Error_FluidDriver_GenericNetworkError=3004]="Error_FluidDriver_GenericNetworkError",e[e.Error_FluidDriver_IncorrectServerResponse=3005]="Error_FluidDriver_IncorrectServerResponse",e[e.ExpectedError_FluidDriver_OfflineError=3006]="ExpectedError_FluidDriver_OfflineError",e[e.Error_FluidDriver_ThrottlingError=3007]="Error_FluidDriver_ThrottlingError",e[e.Error_FluidDriver_UnsupportedClientProtocolVersion=3008]="Error_FluidDriver_UnsupportedClientProtocolVersion",e[e.Error_FluidDriver_WriteError=3009]="Error_FluidDriver_WriteError",e[e.Error_FluidDriver_FileOverwrittenInStorage=3010]="Error_FluidDriver_FileOverwrittenInStorage",e[e.Error_FluidDriver_DeltaStreamConnectionForbidden=3011]="Error_FluidDriver_DeltaStreamConnectionForbidden",e[e.Error_FluidDriver_LocationRedirection=3012]="Error_FluidDriver_LocationRedirection",e[e.Error_FluidDriver_FluidInvalidSchema=3013]="Error_FluidDriver_FluidInvalidSchema",e[e.Error_FluidDriver_UsageError=3014]="Error_FluidDriver_UsageError",e[e.Error_FluidDriver_FileIsLocked=3015]="Error_FluidDriver_FileIsLocked",e[e.Error_FluidOdsp_CannotCatchUp=4e3]="Error_FluidOdsp_CannotCatchUp",e[e.Error_FluidOdsp_FetchTimeout=4001]="Error_FluidOdsp_FetchTimeout",e[e.ExpectedError_FluidOdsp_FluidNotEnabled=4002]="ExpectedError_FluidOdsp_FluidNotEnabled",e[e.Error_FluidOdsp_InvalidFileNameError=4003]="Error_FluidOdsp_InvalidFileNameError",e[e.Error_FluidOdsp_OutOfStorageError=4004]="Error_FluidOdsp_OutOfStorageError",e[e.Error_FluidOdsp_SnapshotTooBig=4005]="Error_FluidOdsp_SnapshotTooBig",e[e.Error_FluidOdsp_FetchTokenError=4006]="Error_FluidOdsp_FetchTokenError",e[e.Error_FluidOdsp_ServiceReadOnly=4007]="Error_FluidOdsp_ServiceReadOnly",e[e.Error_FluidOdsp_BlockedIPAddress=4008]="Error_FluidOdsp_BlockedIPAddress",e[e.Error_FluidOWH_ContainerUpgradeRequired=5e3]="Error_FluidOWH_ContainerUpgradeRequired",e[e.Error_FluidOWH_IFrameLoadFailed=5001]="Error_FluidOWH_IFrameLoadFailed",e[e.Error_FluidOWH_ComponentNotFound=5002]="Error_FluidOWH_ComponentNotFound",e[e.Error_FluidContainerLoad_RootComponentCreateFailed=6e3]="Error_FluidContainerLoad_RootComponentCreateFailed",e[e.Error_FluidContainerLoad_RaasNotSupported=6001]="Error_FluidContainerLoad_RaasNotSupported",e}({})},60119:(e,t,r)=>{"use strict";r.d(t,{a:()=>l});var n=r(91947),o=r(6971),i=r(24921);let s,a=[],c=!1;const l=new class{get LoopTelemetrySink(){return this}async sendTelemetryEvent(e){var t;void 0===s&&(s=await(0,o.E)());const r=JSON.stringify(e),l=null!==(t=s.telemetryBatchDurationMs)&&void 0!==t?t:0;l>0?(a.push(r),async function(e){if(!c){c=!0,await(0,i.y)(e),c=!1;const t=a;a=[],(0,n.wW)(t)}}(l)):(0,n.wW)([r])}}},90662:(e,t,r)=>{"use strict";r.d(t,{kc:()=>l,h2:()=>g,mz:()=>s,d8:()=>c,D8:()=>a,g4:()=>h,fB:()=>p});r(899);var n=r(83754);let o=function(e){return e[e.Default=0]="Default",e[e.Dark=1]="Dark",e}({});const i=new Map([[o[o.Default],{name:"Default Theme",properties:[]}],[o[o.Dark],{name:"Dark Theme",properties:[[n.Ve.black,"#ffffff"],[n.Ve.white,"#262626"],[n.Ve.neutralDark,"#ffffff"],[n.Ve.neutralPrimary,"#ffffff"],[n.Ve.neutralPrimaryAlt,"#f8f8f8"],[n.Ve.neutralSecondary,"#f4f4f4"],[n.Ve.neutralTertiary,"#eaeaea"],[n.Ve.neutralTertiaryAlt,"#c8c8c8"],[n.Ve.neutralQuaternary,"#2e2e2e"],[n.Ve.neutralLight,"#000000"],[n.Ve.neutralQuaternaryAlt,"#2e2e2e"],[n.Ve.neutralLighter,"#212121"],[n.Ve.neutralLighterAlt,"#363636"],[n.Ve.redDark,"#e81123"],[n.Ve.purple,"#9c89e9"],[n.Ve.themeDarker,"#cfd3d5"],[n.Ve.themeDark,"#bcd6e6"],[n.Ve.themeDarkAlt,"#afd8f0"],[n.Ve.themePrimary,"#79b0c8"],[n.Ve.themeSecondary,"#588b9e"],[n.Ve.themeTertiary,"#597c87"],[n.Ve.themeLight,"#495e66"],[n.Ve.themeLighter,"#485b60"],[n.Ve.themeLighterAlt,"#3c4547"],[n.Ve.EntityRecognitionUnderline,"#8a8886"],[n.Ve.EntityRecognitionHoverHighlight,"#3b3a39"],[n.Ve.TaskRecognitionUnderline,"#8a8886"],[n.Ve.TaskRecognitionHoverHighlight,"#3b3a39"],[n._D.ThemeName,n.aM.Dark],[n.KM.MessageText,"#323130"],[n.KM.ErrorBackground,"#FDE7E9"],[n.KM.ErrorIcon,"#F75E75"],[n.KM.SuccessBackground,"#262626"],[n.KM.SuccessIcon,"#107C10"],[n.KM.WarningBackground,"#FFF4CE"],[n.KM.WarningIcon,"#797775"],[n.KM.SevereWarningBackground,"#FED9CC"],[n.KM.SevereWarningIcon,"#D83B01"],[n.KM.InfoBackground,"#292929"],[n.KM.InfoIcon,"#605e5c"]]}]]),s="#e49fff",a="#EB0000",c="#FF4D4D",l="#262626",d="#ffffff";let u=function(e){return e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e}({});function h(e){return e===u.Black}function g(e){return e?i.get(o[o.Dark])||{name:"Default Theme",properties:[]}:i.get(o[o.Default])||{name:"Default Theme",properties:[]}}function p(e){var t,r;null===(t=document)||void 0===t||null===(r=t.body)||void 0===r||r.style.setProperty("background-color",e?l:d)}},83736:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});var n=r(45799),o=r(31482),i=r(91608),s=r(96826);const a={10:"#050106",20:"#211029",30:"#37154A",40:"#4A1866",50:"#5E1984",60:"#7219A2",70:"#802CB0",80:"#8D40B7",90:"#9853BE",100:"#A465C5",110:"#AF76CC",120:"#BA88D3",130:"#C59ADA",140:"#D0ABE1",150:"#DABDE7",160:"#E5CFEE"},c={10:"#020304",20:"#14171D",30:"#1E2631",40:"#263241",50:"#2F3E53",60:"#384B65",70:"#405878",80:"#49668B",90:"#52749F",100:"#5C82B3",110:"#6590C7",120:"#6E9FDC",130:"#7CAEEE",140:"#96BCF2",150:"#AECAF5",160:"#C5D9F8"};function l(e,t){let r;"OneNote"===e&&(r=a),"Word"===e&&(r=c);const l=r?(0,n.a)(r):o.o,d=r?(0,i.W)(r):s.C;return{fluentThemeV9:t?d:l,brandVariants:r}}},25573:(e,t,r)=>{"use strict";function n(){return(new Date).getTime()}r.d(t,{W:()=>n})},40118:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var n=r(91947);class o{constructor(){this.tokenMap=new Map,this.pendingRequests=new Map,this.tokenExpirationDuration=18e4,this.isCacheEnabled=!1}generateTokenKey(e,t){return"".concat(e,"|").concat(t)}static getCurrentTime(){return(new Date).getTime()}async getToken(e,t,r){if(!this.isCacheEnabled){return{token:await(0,n.gf)(e,t)}}const i=this.generateTokenKey(e,t);if(r)this.tokenMap.delete(i);else{const e=this.tokenMap.get(i);if(e){if(!(o.getCurrentTime()>=e.expiration)){return{token:e.token,fromCache:!0}}this.tokenMap.delete(i)}}const s=this.pendingRequests.get(i);if(s){return{token:await s}}const a=(0,n.gf)(e,t);this.pendingRequests.set(i,a);try{const e=await a;return this.tokenMap.set(i,{token:e,expiration:o.getCurrentTime()+this.tokenExpirationDuration}),{token:e}}finally{this.pendingRequests.delete(i)}}static GetInstance(){return null==this.instance&&(this.instance=new o),this.instance}}o.instance=void 0},35159:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});const n="@1js/card-loop"},3542:(e,t,r)=>{"use strict";function n(e){i!==e&&(i=e)}function o(){return void 0===i&&(i="undefined"!==typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),i}var i;function s(){return{rtl:o()}}r.d(t,{DU:()=>n,Iy:()=>s}),i=o()},63722:(e,t,r)=>{"use strict";r.d(t,{n:()=>u});var n,o=r(6326),i=0,s=1,a=2,c="__stylesheet__",l="undefined"!==typeof navigator&&/rv:11.0/.test(navigator.userAgent),d={};try{d=window||{}}catch(h){}var u=function(){function e(e,t){var r,n,a,c,l,d;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,o.__assign)({injectionMode:"undefined"===typeof document?i:s,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(r=null===t||void 0===t?void 0:t.classNameToArgs)&&void 0!==r?r:this._classNameToArgs,this._counter=null!==(n=null===t||void 0===t?void 0:t.counter)&&void 0!==n?n:this._counter,this._keyToClassName=null!==(c=null!==(a=this._config.classNameCache)&&void 0!==a?a:null===t||void 0===t?void 0:t.keyToClassName)&&void 0!==c?c:this._keyToClassName,this._preservedRules=null!==(l=null===t||void 0===t?void 0:t.preservedRules)&&void 0!==l?l:this._preservedRules,this._rules=null!==(d=null===t||void 0===t?void 0:t.rules)&&void 0!==d?d:this._rules}return e.getInstance=function(){if(!(n=d[c])||n._lastStyleElement&&n._lastStyleElement.ownerDocument!==document){var t=(null===d||void 0===d?void 0:d.FabricConfig)||{},r=new e(t.mergeStyles,t.serializedStylesheet);n=r,d[c]=r}return n},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,o.__assign)((0,o.__assign)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter((function(t){return t!==e}))}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter((function(t){return t!==e}))}},e.prototype.getClassName=function(e){var t=this._config.namespace,r=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(r,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,r,n){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:r,rules:n}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t){var r=this._config.injectionMode,n=r!==i?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(r){case s:var o=n.sheet;try{o.insertRule(e,o.cssRules.length)}catch(c){}break;case a:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach((function(e){return e()}))},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(e){return e()}))},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"===typeof document||(this._styleElement=this._createStyleElement(),l||window.requestAnimationFrame((function(){e._styleElement=void 0}))),this._styleElement},e.prototype._createStyleElement=function(){var e=document.head,t=document.createElement("style"),r=null;t.setAttribute("data-merge-styles","true");var n=this._config.cspSettings;if(n&&n.nonce&&t.setAttribute("nonce",n.nonce),this._lastStyleElement)r=this._lastStyleElement.nextElementSibling;else{var o=this._findPlaceholderStyleTag();r=o?o.nextElementSibling:e.childNodes[0]}return e.insertBefore(t,e.contains(r)?r:null),this._lastStyleElement=t,t},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},19466:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var n=r(3542),o=r(63722),i=r(28205);function s(e){var t=o.n.getInstance(),r=(0,i.bz)((0,n.Iy)(),e);if(!t.classNameFromKey(r)){var s=t.getClassName();t.insertRule("@font-face{".concat(r,"}"),!0),t.cacheClassName(s,r,[],["font-face",r])}}},28205:(e,t,r)=>{"use strict";r.d(t,{Ae:()=>N,bz:()=>T,kG:()=>F,GJ:()=>I});var n,o=r(6326),i=r(63722),s={};function a(e,t){var r=e[t];"-"!==r.charAt(0)&&(e[t]=s[r]=s[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase())}var c={"user-select":1};function l(e,t){var r=function(){var e;if(!n){var t="undefined"!==typeof document?document:void 0,r="undefined"!==typeof navigator?navigator:void 0,o=null===(e=null===r||void 0===r?void 0:r.userAgent)||void 0===e?void 0:e.toLowerCase();n=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(o&&o.indexOf("firefox")>-1),isOpera:!!(o&&o.indexOf("opera")>-1),isMs:!(!r||!/rv:11.0/i.test(r.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return n}(),o=e[t];if(c[o]){var i=e[t+1];c[o]&&(r.isWebkit&&e.push("-webkit-"+o,i),r.isMoz&&e.push("-moz-"+o,i),r.isMs&&e.push("-ms-"+o,i),r.isOpera&&e.push("-o-"+o,i))}}var d,u=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function h(e,t){var r=e[t],n=e[t+1];if("number"===typeof n){var o=u.indexOf(r)>-1,i=r.indexOf("--")>-1,s=o||i?"":"px";e[t+1]="".concat(n).concat(s)}}var g="left",p="right",m="@noflip",f=((d={})[g]=p,d[p]=g,d),v={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,r){if(e.rtl){var n=t[r];if(!n)return;var o=t[r+1];if("string"===typeof o&&o.indexOf(m)>=0)t[r+1]=o.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(n.indexOf(g)>=0)t[r]=n.replace(g,p);else if(n.indexOf(p)>=0)t[r]=n.replace(p,g);else if(String(o).indexOf(g)>=0)t[r+1]=o.replace(g,p);else if(String(o).indexOf(p)>=0)t[r+1]=o.replace(p,g);else if(f[n])t[r]=f[n];else if(v[o])t[r+1]=v[o];else switch(n){case"margin":case"padding":t[r+1]=function(e){if("string"===typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(o);break;case"box-shadow":t[r+1]=function(e,t){var r=e.split(" "),n=parseInt(r[t],10);return r[0]=r[0].replace(String(n),String(-1*n)),r.join(" ")}(o,0)}}}var b="displayName";var S=/\:global\((.+?)\)/g;function C(e,t){return e.indexOf(":global(")>=0?e.replace(S,"$1"):0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function k(e,t,r,n){void 0===t&&(t={__order:[]}),0===r.indexOf("@")?w([n],t,r=r+"{"+e):r.indexOf(",")>-1?function(e){if(!S.test(e))return e;for(var t=[],r=/\:global\((.+?)\)/g,n=null;n=r.exec(e);)n[1].indexOf(",")>-1&&t.push([n.index,n.index+n[0].length,n[1].split(",").map((function(e){return":global(".concat(e.trim(),")")})).join(", ")]);return t.reverse().reduce((function(e,t){var r=t[0],n=t[1],o=t[2];return e.slice(0,r)+o+e.slice(n)}),e)}(r).split(",").map((function(e){return e.trim()})).forEach((function(r){return w([n],t,C(r,e))})):w([n],t,C(r,e))}function w(e,t,r){void 0===t&&(t={__order:[]}),void 0===r&&(r="&");var n=i.n.getInstance(),o=t[r];o||(o={},t[r]=o,t.__order.push(r));for(var s=0,a=e;s<a.length;s++){var c=a[s];if("string"===typeof c){var l=n.argsFromClassName(c);l&&w(l,t,r)}else if(Array.isArray(c))w(c,t,r);else for(var d in c)if(c.hasOwnProperty(d)){var u=c[d];if("selectors"===d){var h=c.selectors;for(var g in h)h.hasOwnProperty(g)&&k(r,t,g,h[g])}else"object"===typeof u?null!==u&&k(r,t,d,u):void 0!==u&&("margin"===d||"padding"===d?P(o,d,u):o[d]=u)}}return t}function P(e,t,r){var n="string"===typeof r?function(e){for(var t=[],r=0,n=0,o=0;o<e.length;o++)switch(e[o]){case"(":n++;break;case")":n&&n--;break;case"\t":case" ":n||(o>r&&t.push(e.substring(r,o)),r=o+1)}return r<e.length&&t.push(e.substring(r)),t}(r):[r];0===n.length&&n.push(r),"!important"===n[n.length-1]&&(n=n.slice(0,-1).map((function(e){return e+" !important"}))),e[t+"Top"]=n[0],e[t+"Right"]=n[1]||n[0],e[t+"Bottom"]=n[2]||n[0],e[t+"Left"]=n[3]||n[1]||n[0]}function E(e,t){return t<=0?"":1===t?e:e+E(e,t-1)}function T(e,t){if(!t)return"";var r=[];for(var n in t)t.hasOwnProperty(n)&&n!==b&&void 0!==t[n]&&r.push(n,t[n]);for(var o=0;o<r.length;o+=2)a(r,o),h(r,o),y(e,r,o),l(r,o);for(o=1;o<r.length;o+=4)r.splice(o,1,":",r[o],";");return r.join("")}function I(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=w(t),o=function(e,t){for(var r=[e.rtl?"rtl":"ltr"],n=!1,o=0,i=t.__order;o<i.length;o++){var s=i[o];r.push(s);var a=t[s];for(var c in a)a.hasOwnProperty(c)&&void 0!==a[c]&&(n=!0,r.push(c,a[c]))}return n?r.join(""):void 0}(e,n);if(o){var s=i.n.getInstance(),a={className:s.classNameFromKey(o),key:o,args:t};if(!a.className){a.className=s.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(n));for(var c=[],l=0,d=n.__order;l<d.length;l++){var u=d[l];c.push(u,T(e,n[u]))}a.rulesToInsert=c}return a}}function N(e,t){void 0===t&&(t=1);var r=i.n.getInstance(),n=e.className,o=e.key,s=e.args,a=e.rulesToInsert;if(a){for(var c=0;c<a.length;c+=2){var l=a[c+1];if(l){var d=a[c];d=d.replace(/&/g,E(".".concat(e.className),t));var u="".concat(d,"{").concat(l,"}").concat(0===d.indexOf("@")?"}":"");r.insertRule(u)}}r.cacheClassName(n,o,s,a)}}function F(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=I.apply(void 0,(0,o.__spreadArray)([e],t,!1));return n?(N(n,e.specificityMultiplier),n.className):""}},22751:(e,t,r)=>{"use strict";r.d(t,{a:()=>w});var n={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"},o=r(46851),i={elevation4:o.f.depth4,elevation8:o.f.depth8,elevation16:o.f.depth16,elevation64:o.f.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},s=r(19466),a=r(53815),c="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",l="'Segoe UI', '".concat(a.Dn.WestEuropean,"'"),d={ar:a.bi.Arabic,bg:a.bi.Cyrillic,cs:a.bi.EastEuropean,el:a.bi.Greek,et:a.bi.EastEuropean,he:a.bi.Hebrew,hi:a.bi.Hindi,hr:a.bi.EastEuropean,hu:a.bi.EastEuropean,ja:a.bi.Japanese,kk:a.bi.EastEuropean,ko:a.bi.Korean,lt:a.bi.EastEuropean,lv:a.bi.EastEuropean,pl:a.bi.EastEuropean,ru:a.bi.Cyrillic,sk:a.bi.EastEuropean,"sr-latn":a.bi.EastEuropean,th:a.bi.Thai,tr:a.bi.EastEuropean,uk:a.bi.Cyrillic,vi:a.bi.Vietnamese,"zh-hans":a.bi.ChineseSimplified,"zh-hant":a.bi.ChineseTraditional,hy:a.bi.Armenian,ka:a.bi.Georgian};function u(e,t,r){return{fontFamily:r,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var h=r(48717),g=r(44828);var p,m=r(13290),f="language";var v=function(e){var t=function(e){for(var t in d)if(d.hasOwnProperty(t)&&e&&0===t.indexOf(e))return d[t];return l}(e),r="".concat(t,", ").concat(c);return{tiny:u(a.s.mini,a.BO.regular,r),xSmall:u(a.s.xSmall,a.BO.regular,r),small:u(a.s.small,a.BO.regular,r),smallPlus:u(a.s.smallPlus,a.BO.regular,r),medium:u(a.s.medium,a.BO.regular,r),mediumPlus:u(a.s.mediumPlus,a.BO.regular,r),large:u(a.s.large,a.BO.regular,r),xLarge:u(a.s.xLarge,a.BO.semibold,r),xLargePlus:u(a.s.xLargePlus,a.BO.semibold,r),xxLarge:u(a.s.xxLarge,a.BO.semibold,r),xxLargePlus:u(a.s.xxLargePlus,a.BO.semibold,r),superLarge:u(a.s.superLarge,a.BO.semibold,r),mega:u(a.s.mega,a.BO.semibold,r)}}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===p){var t=(0,h.Y)(),r="localStorage"===e?function(e){var t=null;try{var r=(0,g.z)();t=r?r.localStorage.getItem(e):null}catch(n){}return t}(f):"sessionStorage"===e?m.G(f):void 0;r&&(p=r),void 0===p&&t&&(p=t.documentElement.getAttribute("lang")),void 0===p&&(p="en")}return p}());function y(e,t,r,n){e="'".concat(e,"'");var o=void 0!==n?"local('".concat(n,"'),"):"";(0,s.n)({fontFamily:e,src:o+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:r,fontStyle:"normal",fontDisplay:"swap"})}function b(e,t,r,n,o){void 0===n&&(n="segoeui");var i="".concat(e,"/").concat(r,"/").concat(n);y(t,i+"-light",a.BO.light,o&&o+" Light"),y(t,i+"-semilight",a.BO.semilight,o&&o+" SemiLight"),y(t,i+"-regular",a.BO.regular,o),y(t,i+"-semibold",a.BO.semibold,o&&o+" SemiBold"),y(t,i+"-bold",a.BO.bold,o&&o+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");b(t,a.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),b(t,a.Dn.Arabic,"segoeui-arabic"),b(t,a.Dn.Cyrillic,"segoeui-cyrillic"),b(t,a.Dn.EastEuropean,"segoeui-easteuropean"),b(t,a.Dn.Greek,"segoeui-greek"),b(t,a.Dn.Hebrew,"segoeui-hebrew"),b(t,a.Dn.Vietnamese,"segoeui-vietnamese"),b(t,a.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),b(t,a.bi.Selawik,"selawik","selawik"),b(t,a.Dn.Armenian,"segoeui-armenian"),b(t,a.Dn.Georgian,"segoeui-georgian"),y("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),a.BO.light),y("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),a.BO.semibold)}}(function(){var e,t,r=null===(e=(0,g.z)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null===r||void 0===r?void 0:r.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"}());var S=r(4563),C={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},k=r(40695);function w(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var r=!!e.isInverted,o={palette:n,effects:i,fonts:v,spacing:C,isInverted:r,disableGlobalClassNames:!1,semanticColors:(0,k.b)(n,i,void 0,r,t),rtl:void 0};return(0,S.z)(o,e)}},46851:(e,t,r)=>{"use strict";var n;r.d(t,{f:()=>n}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(n||(n={}))},53815:(e,t,r)=>{"use strict";var n,o,i,s,a;r.d(t,{BO:()=>s,Dn:()=>n,bi:()=>o,fF:()=>a,s:()=>i}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(n||(n={})),function(e){e.Arabic="'".concat(n.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(n.Cyrillic,"'"),e.EastEuropean="'".concat(n.EastEuropean,"'"),e.Greek="'".concat(n.Greek,"'"),e.Hebrew="'".concat(n.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(n.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(n.Vietnamese,"'"),e.WestEuropean="'".concat(n.WestEuropean,"'"),e.Armenian="'".concat(n.Armenian,"'"),e.Georgian="'".concat(n.Georgian,"'")}(o||(o={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i||(i={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(s||(s={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}))},4563:(e,t,r)=>{"use strict";function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,i=t;n<i.length;n++){o(e||{},i[n])}return e}function o(e,t,r){for(var n in void 0===r&&(r=[]),r.push(t),t)if(t.hasOwnProperty(n)&&"__proto__"!==n&&"constructor"!==n&&"prototype"!==n){var i=t[n];if("object"!==typeof i||null===i||Array.isArray(i))e[n]=i;else{var s=r.indexOf(i)>-1;e[n]=s?i:o(e[n]||{},i,r)}}return r.pop(),e}r.d(t,{z:()=>s});var i=r(40695);function s(e,t){var r,o,s;void 0===t&&(t={});var a=n({},e,t,{semanticColors:(0,i.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(r=t.palette)||void 0===r?void 0:r.themePrimary)&&!(null===(o=t.palette)||void 0===o?void 0:o.accent)&&(a.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,l=Object.keys(a.fonts);c<l.length;c++){var d=l[c];a.fonts[d]=n(a.fonts[d],t.defaultFontStyle,null===(s=null===t||void 0===t?void 0:t.fonts)||void 0===s?void 0:s[d])}return a}},40695:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,b:()=>o});var n=r(6326);function o(e,t,r,o,s){return void 0===s&&(s=!1),function(e,t){var r="";!0===t&&(r=" /* @deprecated */");return e.listTextColor=e.listText+r,e.menuItemBackgroundChecked+=r,e.warningHighlight+=r,e.warningText=e.messageText+r,e.successText+=r,e}(i(e,t,(0,n.__assign)({primaryButtonBorder:"transparent",errorText:o?"#F1707B":"#a4262c",messageText:o?"#F3F2F1":"#323130",messageLink:o?"#6CB8F6":"#005A9E",messageLinkHovered:o?"#82C7FF":"#004578",infoIcon:o?"#C8C6C4":"#605e5c",errorIcon:o?"#F1707B":"#A80000",blockingIcon:o?"#442726":"#FDE7E9",warningIcon:o?"#C8C6C4":"#797775",severeWarningIcon:o?"#FCE100":"#D83B01",successIcon:o?"#92C353":"#107C10",infoBackground:o?"#323130":"#f3f2f1",errorBackground:o?"#442726":"#FDE7E9",blockingBackground:o?"#442726":"#FDE7E9",warningBackground:o?"#433519":"#FFF4CE",severeWarningBackground:o?"#4F2A0F":"#FED9CC",successBackground:o?"#393D1B":"#DFF6DD",warningHighlight:o?"#fff100":"#ffb900",successText:o?"#92c353":"#107C10"},r),o),s)}function i(e,t,r,o,i){void 0===i&&(i=!1);var s={},a=e||{},c=a.white,l=a.black,d=a.themePrimary,u=a.themeDark,h=a.themeDarker,g=a.themeDarkAlt,p=a.themeLighter,m=a.neutralLight,f=a.neutralLighter,v=a.neutralDark,y=a.neutralQuaternary,b=a.neutralQuaternaryAlt,S=a.neutralPrimary,C=a.neutralSecondary,k=a.neutralSecondaryAlt,w=a.neutralTertiary,P=a.neutralTertiaryAlt,E=a.neutralLighterAlt,T=a.accent;return c&&(s.bodyBackground=c,s.bodyFrameBackground=c,s.accentButtonText=c,s.buttonBackground=c,s.primaryButtonText=c,s.primaryButtonTextHovered=c,s.primaryButtonTextPressed=c,s.inputBackground=c,s.inputForegroundChecked=c,s.listBackground=c,s.menuBackground=c,s.cardStandoutBackground=c),l&&(s.bodyTextChecked=l,s.buttonTextCheckedHovered=l),d&&(s.link=d,s.primaryButtonBackground=d,s.inputBackgroundChecked=d,s.inputIcon=d,s.inputFocusBorderAlt=d,s.menuIcon=d,s.menuHeader=d,s.accentButtonBackground=d),u&&(s.primaryButtonBackgroundPressed=u,s.inputBackgroundCheckedHovered=u,s.inputIconHovered=u),h&&(s.linkHovered=h),g&&(s.primaryButtonBackgroundHovered=g),p&&(s.inputPlaceholderBackgroundChecked=p),m&&(s.bodyBackgroundChecked=m,s.bodyFrameDivider=m,s.bodyDivider=m,s.variantBorder=m,s.buttonBackgroundCheckedHovered=m,s.buttonBackgroundPressed=m,s.listItemBackgroundChecked=m,s.listHeaderBackgroundPressed=m,s.menuItemBackgroundPressed=m,s.menuItemBackgroundChecked=m),f&&(s.bodyBackgroundHovered=f,s.buttonBackgroundHovered=f,s.buttonBackgroundDisabled=f,s.buttonBorderDisabled=f,s.primaryButtonBackgroundDisabled=f,s.disabledBackground=f,s.listItemBackgroundHovered=f,s.listHeaderBackgroundHovered=f,s.menuItemBackgroundHovered=f),y&&(s.primaryButtonTextDisabled=y,s.disabledSubtext=y),b&&(s.listItemBackgroundCheckedHovered=b),w&&(s.disabledBodyText=w,s.variantBorderHovered=(null===r||void 0===r?void 0:r.variantBorderHovered)||w,s.buttonTextDisabled=w,s.inputIconDisabled=w,s.disabledText=w),S&&(s.bodyText=S,s.actionLink=S,s.buttonText=S,s.inputBorderHovered=S,s.inputText=S,s.listText=S,s.menuItemText=S),E&&(s.bodyStandoutBackground=E,s.defaultStateBackground=E),v&&(s.actionLinkHovered=v,s.buttonTextHovered=v,s.buttonTextChecked=v,s.buttonTextPressed=v,s.inputTextHovered=v,s.menuItemTextHovered=v),C&&(s.bodySubtext=C,s.focusBorder=C,s.inputBorder=C,s.smallInputBorder=C,s.inputPlaceholderText=C),k&&(s.buttonBorder=k),P&&(s.disabledBodySubtext=P,s.disabledBorder=P,s.buttonBackgroundChecked=P,s.menuDivider=P),T&&(s.accentButtonBackground=T),(null===t||void 0===t?void 0:t.elevation4)&&(s.cardShadow=t.elevation4),!o&&(null===t||void 0===t?void 0:t.elevation8)?s.cardShadowHovered=t.elevation8:s.variantBorderHovered&&(s.cardShadowHovered="0 0 1px "+s.variantBorderHovered),s=(0,n.__assign)((0,n.__assign)({},s),r)}},17483:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});const n={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},65922:(e,t,r)=>{"use strict";r.d(t,{oZ:()=>n});const n={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"}},51497:(e,t,r)=>{"use strict";r.d(t,{Ul:()=>s,cc:()=>i,yd:()=>o});var n=r(43483);const o={red:n.wv,green:n.wL,darkOrange:n.je,yellow:n.D9,berry:n.pT,lightGreen:n.EM,marigold:n.KK},i={darkRed:n.ik,cranberry:n.jF,pumpkin:n.Vv,peach:n.WB,gold:n.bK,brass:n.YA,brown:n.Xk,forest:n.CE,seafoam:n.$T,darkGreen:n.AV,lightTeal:n.JW,teal:n.$S,steel:n.s$,blue:n.z1,royalBlue:n.Os,cornflower:n.um,navy:n.Z,lavender:n.Us,purple:n.Zp,grape:n.QH,lilac:n.qn,pink:n.Vu,magenta:n.GC,plum:n.t1,beige:n.Zz,mink:n.QJ,platinum:n.X1,anchor:n.Y3},s={cranberry:n.jF,green:n.wL,orange:n.T_}},43483:(e,t,r)=>{"use strict";r.d(t,{$S:()=>F,$T:()=>P,AV:()=>I,CE:()=>w,D9:()=>b,EM:()=>E,GC:()=>U,JW:()=>N,KK:()=>y,ON:()=>l,Oh:()=>n,Os:()=>B,Q1:()=>i,QH:()=>M,QJ:()=>V,Ql:()=>d,T_:()=>f,Us:()=>A,Vu:()=>H,Vv:()=>m,WB:()=>v,X1:()=>G,Xk:()=>k,Xv:()=>c,Y3:()=>W,YA:()=>C,Z:()=>L,Z1:()=>a,Zp:()=>R,Zz:()=>q,bK:()=>S,c8:()=>o,ik:()=>u,jF:()=>h,je:()=>p,pT:()=>_,qn:()=>z,s$:()=>D,t1:()=>j,ti:()=>s,um:()=>x,wL:()=>T,wv:()=>g,z1:()=>O});const n={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},o={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},i={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},s={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},a={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},c={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},l="#ffffff",d="#000000",u={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},h={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},g={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},p={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},m={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},f={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},v={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},y={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},b={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},S={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},C={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},k={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},w={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},P={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},E={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},T={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},I={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},N={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},F={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},D={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},O={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},B={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},x={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},L={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},A={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},R={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},M={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},_={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},z={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},H={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},U={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},j={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},q={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},V={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},G={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},W={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},58511:(e,t,r)=>{"use strict";r.d(t,{L:()=>n});const n={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},27586:(e,t,r)=>{"use strict";r.d(t,{S:()=>n});const n={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},95829:(e,t,r)=>{"use strict";r.d(t,{GR:()=>n,NM:()=>i,aI:()=>s,lm:()=>o});const n={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},o={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},i={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},s={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},91809:(e,t,r)=>{"use strict";r.d(t,{F:()=>m,b:()=>p});const n="0",o="2px",i="4px",s="6px",a="8px",c="10px",l="12px",d="16px",u="20px",h="24px",g="32px",p={spacingHorizontalNone:n,spacingHorizontalXXS:o,spacingHorizontalXS:i,spacingHorizontalSNudge:s,spacingHorizontalS:a,spacingHorizontalMNudge:c,spacingHorizontalM:l,spacingHorizontalL:d,spacingHorizontalXL:u,spacingHorizontalXXL:h,spacingHorizontalXXXL:g},m={spacingVerticalNone:n,spacingVerticalXXS:o,spacingVerticalXS:i,spacingVerticalSNudge:s,spacingVerticalS:a,spacingVerticalMNudge:c,spacingVerticalM:l,spacingVerticalL:d,spacingVerticalXL:u,spacingVerticalXXL:h,spacingVerticalXXXL:g}},45882:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});const n={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},43927:(e,t,r)=>{"use strict";r.d(t,{TQ:()=>n,dt:()=>o});const n=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],o=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},6390:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});const n={success:"green",warning:"orange",danger:"cranberry"}},96826:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=r(91608),o=r(65922);const i=(0,n.W)(o.oZ)},31482:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});var n=r(45799),o=r(65922);const i=(0,n.a)(o.oZ)},91608:(e,t,r)=>{"use strict";r.d(t,{W:()=>y});var n=r(51497),o=r(43927),i=r(6390);const s=o.TQ.reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background1")]:n.yd[t].shade40,["colorPalette".concat(r,"Background2")]:n.yd[t].shade30,["colorPalette".concat(r,"Background3")]:n.yd[t].primary,["colorPalette".concat(r,"Foreground1")]:n.yd[t].tint30,["colorPalette".concat(r,"Foreground2")]:n.yd[t].tint40,["colorPalette".concat(r,"Foreground3")]:n.yd[t].tint20,["colorPalette".concat(r,"BorderActive")]:n.yd[t].tint30,["colorPalette".concat(r,"Border1")]:n.yd[t].primary,["colorPalette".concat(r,"Border2")]:n.yd[t].tint20};return Object.assign(e,o)}),{});s.colorPaletteRedForeground3=n.yd.red.tint30,s.colorPaletteRedBorder2=n.yd.red.tint30,s.colorPaletteGreenForeground3=n.yd.green.tint40,s.colorPaletteGreenBorder2=n.yd.green.tint40,s.colorPaletteDarkOrangeForeground3=n.yd.darkOrange.tint30,s.colorPaletteDarkOrangeBorder2=n.yd.darkOrange.tint30,s.colorPaletteRedForegroundInverted=n.yd.red.primary,s.colorPaletteGreenForegroundInverted=n.yd.green.primary,s.colorPaletteYellowForegroundInverted=n.yd.yellow.shade30;const a=o.dt.reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background2")]:n.cc[t].shade30,["colorPalette".concat(r,"Foreground2")]:n.cc[t].tint40,["colorPalette".concat(r,"BorderActive")]:n.cc[t].tint30};return Object.assign(e,o)}),{});a.colorPaletteDarkRedBackground2=n.cc.darkRed.shade20,a.colorPalettePlumBackground2=n.cc.plum.shade20;const c={...s,...a},l=Object.entries(i.s).reduce(((e,t)=>{let[r,o]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={["colorStatus".concat(i,"Background1")]:n.Ul[o].shade40,["colorStatus".concat(i,"Background2")]:n.Ul[o].shade30,["colorStatus".concat(i,"Background3")]:n.Ul[o].primary,["colorStatus".concat(i,"Foreground1")]:n.Ul[o].tint30,["colorStatus".concat(i,"Foreground2")]:n.Ul[o].tint40,["colorStatus".concat(i,"Foreground3")]:n.Ul[o].tint20,["colorStatus".concat(i,"BorderActive")]:n.Ul[o].tint30,["colorStatus".concat(i,"ForegroundInverted")]:n.Ul[o].shade10,["colorStatus".concat(i,"Border1")]:n.Ul[o].primary,["colorStatus".concat(i,"Border2")]:n.Ul[o].tint20};return Object.assign(e,s)}),{});l.colorStatusDangerBackground3Hover=n.Ul[i.s.danger].shade10,l.colorStatusDangerBackground3Pressed=n.Ul[i.s.danger].shade20,l.colorStatusDangerForeground3=n.Ul[i.s.danger].tint40,l.colorStatusDangerBorder2=n.Ul[i.s.danger].tint30,l.colorStatusSuccessForeground3=n.Ul[i.s.success].tint40,l.colorStatusSuccessBorder2=n.Ul[i.s.success].tint40,l.colorStatusWarningForegroundInverted=n.Ul[i.s.warning].shade20;var d=r(43483);var u=r(17483),h=r(95829),g=r(45882),p=r(92708),m=r(27586),f=r(58511),v=r(91809);const y=e=>{const t=(e=>({colorNeutralForeground1:d.ON,colorNeutralForeground1Hover:d.ON,colorNeutralForeground1Pressed:d.ON,colorNeutralForeground1Selected:d.ON,colorNeutralForeground2:d.Oh[84],colorNeutralForeground2Hover:d.ON,colorNeutralForeground2Pressed:d.ON,colorNeutralForeground2Selected:d.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:d.Oh[68],colorNeutralForeground3Hover:d.Oh[84],colorNeutralForeground3Pressed:d.Oh[84],colorNeutralForeground3Selected:d.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:d.Oh[60],colorNeutralForegroundDisabled:d.Oh[36],colorNeutralForegroundInvertedDisabled:d.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:d.Oh[84],colorNeutralForeground2LinkHover:d.ON,colorNeutralForeground2LinkPressed:d.ON,colorNeutralForeground2LinkSelected:d.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:d.Oh[14],colorNeutralForegroundStaticInverted:d.ON,colorNeutralForegroundInverted:d.Oh[14],colorNeutralForegroundInvertedHover:d.Oh[14],colorNeutralForegroundInvertedPressed:d.Oh[14],colorNeutralForegroundInvertedSelected:d.Oh[14],colorNeutralForegroundInverted2:d.Oh[14],colorNeutralForegroundOnBrand:d.ON,colorNeutralForegroundInvertedLink:d.ON,colorNeutralForegroundInvertedLinkHover:d.ON,colorNeutralForegroundInvertedLinkPressed:d.ON,colorNeutralForegroundInvertedLinkSelected:d.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:d.Oh[16],colorNeutralBackground1Hover:d.Oh[24],colorNeutralBackground1Pressed:d.Oh[12],colorNeutralBackground1Selected:d.Oh[22],colorNeutralBackground2:d.Oh[12],colorNeutralBackground2Hover:d.Oh[20],colorNeutralBackground2Pressed:d.Oh[8],colorNeutralBackground2Selected:d.Oh[18],colorNeutralBackground3:d.Oh[8],colorNeutralBackground3Hover:d.Oh[16],colorNeutralBackground3Pressed:d.Oh[4],colorNeutralBackground3Selected:d.Oh[14],colorNeutralBackground4:d.Oh[4],colorNeutralBackground4Hover:d.Oh[12],colorNeutralBackground4Pressed:d.Ql,colorNeutralBackground4Selected:d.Oh[10],colorNeutralBackground5:d.Ql,colorNeutralBackground5Hover:d.Oh[8],colorNeutralBackground5Pressed:d.Oh[2],colorNeutralBackground5Selected:d.Oh[6],colorNeutralBackground6:d.Oh[20],colorNeutralBackgroundInverted:d.ON,colorNeutralBackgroundStatic:d.Oh[24],colorNeutralBackgroundAlpha:d.ti[50],colorNeutralBackgroundAlpha2:d.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:d.Oh[22],colorSubtleBackgroundPressed:d.Oh[18],colorSubtleBackgroundSelected:d.Oh[20],colorSubtleBackgroundLightAlphaHover:d.Xv[80],colorSubtleBackgroundLightAlphaPressed:d.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:d.Q1[10],colorSubtleBackgroundInvertedPressed:d.Q1[30],colorSubtleBackgroundInvertedSelected:d.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:d.Oh[8],colorNeutralBackgroundInvertedDisabled:d.c8[10],colorNeutralStencil1:d.Oh[34],colorNeutralStencil2:d.Oh[20],colorNeutralStencil1Alpha:d.c8[10],colorNeutralStencil2Alpha:d.c8[5],colorBackgroundOverlay:d.Q1[50],colorScrollbarOverlay:d.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:d.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:d.Oh[20],colorNeutralCardBackgroundHover:d.Oh[24],colorNeutralCardBackgroundPressed:d.Oh[18],colorNeutralCardBackgroundSelected:d.Oh[22],colorNeutralCardBackgroundDisabled:d.Oh[8],colorNeutralStrokeAccessible:d.Oh[68],colorNeutralStrokeAccessibleHover:d.Oh[74],colorNeutralStrokeAccessiblePressed:d.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:d.Oh[40],colorNeutralStroke1Hover:d.Oh[46],colorNeutralStroke1Pressed:d.Oh[42],colorNeutralStroke1Selected:d.Oh[44],colorNeutralStroke2:d.Oh[32],colorNeutralStroke3:d.Oh[24],colorNeutralStrokeSubtle:d.Oh[4],colorNeutralStrokeOnBrand:d.Oh[16],colorNeutralStrokeOnBrand2:d.ON,colorNeutralStrokeOnBrand2Hover:d.ON,colorNeutralStrokeOnBrand2Pressed:d.ON,colorNeutralStrokeOnBrand2Selected:d.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:d.Oh[26],colorNeutralStrokeInvertedDisabled:d.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:d.c8[10],colorNeutralStrokeAlpha2:d.c8[20],colorStrokeFocus1:d.Ql,colorStrokeFocus2:d.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...u.V,...h.GR,...h.lm,...h.aI,...h.NM,...g.k,...v.b,...v.F,...m.S,...f.L,...t,...c,...l,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},45799:(e,t,r)=>{"use strict";r.d(t,{a:()=>y});var n=r(51497),o=r(43927),i=r(6390);const s=o.TQ.reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background1")]:n.yd[t].tint60,["colorPalette".concat(r,"Background2")]:n.yd[t].tint40,["colorPalette".concat(r,"Background3")]:n.yd[t].primary,["colorPalette".concat(r,"Foreground1")]:n.yd[t].shade10,["colorPalette".concat(r,"Foreground2")]:n.yd[t].shade30,["colorPalette".concat(r,"Foreground3")]:n.yd[t].primary,["colorPalette".concat(r,"BorderActive")]:n.yd[t].primary,["colorPalette".concat(r,"Border1")]:n.yd[t].tint40,["colorPalette".concat(r,"Border2")]:n.yd[t].primary};return Object.assign(e,o)}),{});s.colorPaletteYellowForeground1=n.yd.yellow.shade30,s.colorPaletteRedForegroundInverted=n.yd.red.tint20,s.colorPaletteGreenForegroundInverted=n.yd.green.tint20,s.colorPaletteYellowForegroundInverted=n.yd.yellow.tint40;const a=o.dt.reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background2")]:n.cc[t].tint40,["colorPalette".concat(r,"Foreground2")]:n.cc[t].shade30,["colorPalette".concat(r,"BorderActive")]:n.cc[t].primary};return Object.assign(e,o)}),{}),c={...s,...a},l=Object.entries(i.s).reduce(((e,t)=>{let[r,o]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={["colorStatus".concat(i,"Background1")]:n.Ul[o].tint60,["colorStatus".concat(i,"Background2")]:n.Ul[o].tint40,["colorStatus".concat(i,"Background3")]:n.Ul[o].primary,["colorStatus".concat(i,"Foreground1")]:n.Ul[o].shade10,["colorStatus".concat(i,"Foreground2")]:n.Ul[o].shade30,["colorStatus".concat(i,"Foreground3")]:n.Ul[o].primary,["colorStatus".concat(i,"ForegroundInverted")]:n.Ul[o].tint30,["colorStatus".concat(i,"BorderActive")]:n.Ul[o].primary,["colorStatus".concat(i,"Border1")]:n.Ul[o].tint40,["colorStatus".concat(i,"Border2")]:n.Ul[o].primary};return Object.assign(e,s)}),{});l.colorStatusDangerBackground3Hover=n.Ul[i.s.danger].shade10,l.colorStatusDangerBackground3Pressed=n.Ul[i.s.danger].shade20,l.colorStatusWarningForeground1=n.Ul[i.s.warning].shade20,l.colorStatusWarningForeground3=n.Ul[i.s.warning].shade20,l.colorStatusWarningBorder2=n.Ul[i.s.warning].shade20;var d=r(43483);var u=r(17483),h=r(95829),g=r(45882),p=r(92708),m=r(27586),f=r(58511),v=r(91809);const y=e=>{const t=(e=>({colorNeutralForeground1:d.Oh[14],colorNeutralForeground1Hover:d.Oh[14],colorNeutralForeground1Pressed:d.Oh[14],colorNeutralForeground1Selected:d.Oh[14],colorNeutralForeground2:d.Oh[26],colorNeutralForeground2Hover:d.Oh[14],colorNeutralForeground2Pressed:d.Oh[14],colorNeutralForeground2Selected:d.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:d.Oh[38],colorNeutralForeground3Hover:d.Oh[26],colorNeutralForeground3Pressed:d.Oh[26],colorNeutralForeground3Selected:d.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:d.Oh[44],colorNeutralForegroundDisabled:d.Oh[74],colorNeutralForegroundInvertedDisabled:d.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:d.Oh[26],colorNeutralForeground2LinkHover:d.Oh[14],colorNeutralForeground2LinkPressed:d.Oh[14],colorNeutralForeground2LinkSelected:d.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:d.Oh[14],colorNeutralForegroundStaticInverted:d.ON,colorNeutralForegroundInverted:d.ON,colorNeutralForegroundInvertedHover:d.ON,colorNeutralForegroundInvertedPressed:d.ON,colorNeutralForegroundInvertedSelected:d.ON,colorNeutralForegroundInverted2:d.ON,colorNeutralForegroundOnBrand:d.ON,colorNeutralForegroundInvertedLink:d.ON,colorNeutralForegroundInvertedLinkHover:d.ON,colorNeutralForegroundInvertedLinkPressed:d.ON,colorNeutralForegroundInvertedLinkSelected:d.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:d.ON,colorNeutralBackground1Hover:d.Oh[96],colorNeutralBackground1Pressed:d.Oh[88],colorNeutralBackground1Selected:d.Oh[92],colorNeutralBackground2:d.Oh[98],colorNeutralBackground2Hover:d.Oh[94],colorNeutralBackground2Pressed:d.Oh[86],colorNeutralBackground2Selected:d.Oh[90],colorNeutralBackground3:d.Oh[96],colorNeutralBackground3Hover:d.Oh[92],colorNeutralBackground3Pressed:d.Oh[84],colorNeutralBackground3Selected:d.Oh[88],colorNeutralBackground4:d.Oh[94],colorNeutralBackground4Hover:d.Oh[98],colorNeutralBackground4Pressed:d.Oh[96],colorNeutralBackground4Selected:d.ON,colorNeutralBackground5:d.Oh[92],colorNeutralBackground5Hover:d.Oh[96],colorNeutralBackground5Pressed:d.Oh[94],colorNeutralBackground5Selected:d.Oh[98],colorNeutralBackground6:d.Oh[90],colorNeutralBackgroundInverted:d.Oh[16],colorNeutralBackgroundStatic:d.Oh[20],colorNeutralBackgroundAlpha:d.c8[50],colorNeutralBackgroundAlpha2:d.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:d.Oh[96],colorSubtleBackgroundPressed:d.Oh[88],colorSubtleBackgroundSelected:d.Oh[92],colorSubtleBackgroundLightAlphaHover:d.c8[70],colorSubtleBackgroundLightAlphaPressed:d.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:d.Q1[10],colorSubtleBackgroundInvertedPressed:d.Q1[30],colorSubtleBackgroundInvertedSelected:d.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:d.Oh[94],colorNeutralBackgroundInvertedDisabled:d.c8[10],colorNeutralStencil1:d.Oh[90],colorNeutralStencil2:d.Oh[98],colorNeutralStencil1Alpha:d.Q1[10],colorNeutralStencil2Alpha:d.Q1[5],colorBackgroundOverlay:d.Q1[40],colorScrollbarOverlay:d.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:d.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:d.Oh[98],colorNeutralCardBackgroundHover:d.ON,colorNeutralCardBackgroundPressed:d.Oh[96],colorNeutralCardBackgroundSelected:d.Oh[92],colorNeutralCardBackgroundDisabled:d.Oh[94],colorNeutralStrokeAccessible:d.Oh[38],colorNeutralStrokeAccessibleHover:d.Oh[34],colorNeutralStrokeAccessiblePressed:d.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:d.Oh[82],colorNeutralStroke1Hover:d.Oh[78],colorNeutralStroke1Pressed:d.Oh[70],colorNeutralStroke1Selected:d.Oh[74],colorNeutralStroke2:d.Oh[88],colorNeutralStroke3:d.Oh[94],colorNeutralStrokeSubtle:d.Oh[88],colorNeutralStrokeOnBrand:d.ON,colorNeutralStrokeOnBrand2:d.ON,colorNeutralStrokeOnBrand2Hover:d.ON,colorNeutralStrokeOnBrand2Pressed:d.ON,colorNeutralStrokeOnBrand2Selected:d.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:d.Oh[88],colorNeutralStrokeInvertedDisabled:d.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:d.Q1[5],colorNeutralStrokeAlpha2:d.c8[20],colorStrokeFocus1:d.ON,colorStrokeFocus2:d.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...u.V,...h.GR,...h.lm,...h.aI,...h.NM,...g.k,...v.b,...v.F,...m.S,...f.L,...t,...c,...l,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},92708:(e,t,r)=>{"use strict";function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{["shadow2".concat(r)]:"0 0 2px ".concat(e,", 0 1px 2px ").concat(t),["shadow4".concat(r)]:"0 0 2px ".concat(e,", 0 2px 4px ").concat(t),["shadow8".concat(r)]:"0 0 2px ".concat(e,", 0 4px 8px ").concat(t),["shadow16".concat(r)]:"0 0 2px ".concat(e,", 0 8px 16px ").concat(t),["shadow28".concat(r)]:"0 0 8px ".concat(e,", 0 14px 28px ").concat(t),["shadow64".concat(r)]:"0 0 8px ".concat(e,", 0 32px 64px ").concat(t)}}r.d(t,{t:()=>n})},73895:(e,t,r)=>{"use strict";function n(){return"undefined"!==typeof window&&!(!window.document||!window.document.createElement)}r.d(t,{S:()=>n})},48717:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var n=r(73895);function o(e){if((0,n.S)()&&"undefined"!==typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},44828:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var n=r(73895),o=void 0;try{o=window}catch(s){}function i(e){if((0,n.S)()&&"undefined"!==typeof o){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:o}}},13290:(e,t,r)=>{"use strict";r.d(t,{G:()=>o,S:()=>i});var n=r(44828);function o(e){var t=null;try{var r=(0,n.z)();t=r?r.sessionStorage.getItem(e):null}catch(o){}return t}function i(e,t){var r;try{null===(r=(0,n.z)())||void 0===r||r.sessionStorage.setItem(e,t)}catch(o){}}},98504:(e,t,r)=>{"use strict";function n(e,t){if(!e)throw new Error("number"===typeof t?"0x".concat(t.toString(16).padStart(3,"0")):t)}r.d(t,{v:()=>n})},75704:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});class n{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},16163:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFluidBrowserPackage=void 0;const n=r(67459);t.isFluidBrowserPackage=e=>{var t,r;return(0,n.isFluidPackage)(e)&&"string"===typeof(null===e||void 0===e||null===(t=e.fluid)||void 0===t||null===(t=t.browser)||void 0===t||null===(t=t.umd)||void 0===t?void 0:t.library)&&Array.isArray(null===e||void 0===e||null===(r=e.fluid)||void 0===r||null===(r=r.browser)||void 0===r||null===(r=r.umd)||void 0===r?void 0:r.files)}},56461:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerErrorType=t.ContainerErrorTypes=void 0;const n=r(65432);var o;t.ContainerErrorTypes={...n.FluidErrorTypes,clientSessionExpiredError:"clientSessionExpiredError"},function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(o||(t.ContainerErrorType=o={}))},67459:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=void 0;t.isFluidPackage=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);t.isFluidCodeDetails=e=>{const r=e;return"object"===typeof r&&("string"===typeof(null===r||void 0===r?void 0:r.package)||(0,t.isFluidPackage)(null===r||void 0===r?void 0:r.package))&&(void 0===(null===r||void 0===r?void 0:r.config)||"object"===typeof(null===r||void 0===r?void 0:r.config))},t.IFluidCodeDetailsComparer="IFluidCodeDetailsComparer"},72831:(e,t,r)=>{"use strict";t.Dm=void 0;var n=r(16163);var o=r(56461);Object.defineProperty(t,"Dm",{enumerable:!0,get:function(){return o.ContainerErrorTypes}});var i=r(94140);var s=r(67459);var a=r(19863)},94140:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LoaderHeader=void 0,function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(r||(t.LoaderHeader=r={}))},19863:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.IRuntimeFactory=t.AttachState=void 0,function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(r||(t.AttachState=r={})),t.IRuntimeFactory="IRuntimeFactory"},63146:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FluidErrorTypes=void 0,t.FluidErrorTypes={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},67796:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidRunnable=t.IFluidLoadable=void 0,t.IFluidLoadable="IFluidLoadable",t.IFluidRunnable="IFluidRunnable"},46690:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=void 0;t.isFluidPackage=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);t.isFluidCodeDetails=e=>{const r=e;return"object"===typeof r&&("string"===typeof(null===r||void 0===r?void 0:r.package)||(0,t.isFluidPackage)(null===r||void 0===r?void 0:r.package))&&(void 0===(null===r||void 0===r?void 0:r.config)||"object"===typeof(null===r||void 0===r?void 0:r.config))},t.IFluidCodeDetailsComparer="IFluidCodeDetailsComparer"},58655:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidHandle=t.IFluidHandleContext=void 0,t.IFluidHandleContext="IFluidHandleContext",t.IFluidHandle="IFluidHandle"},65432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.IFluidHandle=t.IFluidHandleContext=t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=t.IFluidRunnable=t.IFluidLoadable=t.FluidErrorTypes=void 0;var n=r(63146);Object.defineProperty(t,"FluidErrorTypes",{enumerable:!0,get:function(){return n.FluidErrorTypes}});var o=r(67796);Object.defineProperty(t,"IFluidLoadable",{enumerable:!0,get:function(){return o.IFluidLoadable}}),Object.defineProperty(t,"IFluidRunnable",{enumerable:!0,get:function(){return o.IFluidRunnable}});var i=r(46690);Object.defineProperty(t,"isFluidPackage",{enumerable:!0,get:function(){return i.isFluidPackage}}),Object.defineProperty(t,"isFluidCodeDetails",{enumerable:!0,get:function(){return i.isFluidCodeDetails}}),Object.defineProperty(t,"IFluidCodeDetailsComparer",{enumerable:!0,get:function(){return i.IFluidCodeDetailsComparer}});var s=r(58655);Object.defineProperty(t,"IFluidHandleContext",{enumerable:!0,get:function(){return s.IFluidHandleContext}}),Object.defineProperty(t,"IFluidHandle",{enumerable:!0,get:function(){return s.IFluidHandle}});var a=r(93430);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return a.LogLevel}})},93430:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,t.LogLevel={verbose:10,default:20,error:30}},39807:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FluidErrorTypes=void 0,t.FluidErrorTypes={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},6301:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidRunnable=t.IFluidLoadable=void 0,t.IFluidLoadable="IFluidLoadable",t.IFluidRunnable="IFluidRunnable"},38241:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=void 0;t.isFluidPackage=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);t.isFluidCodeDetails=e=>{const r=e;return"object"===typeof r&&("string"===typeof(null===r||void 0===r?void 0:r.package)||(0,t.isFluidPackage)(null===r||void 0===r?void 0:r.package))&&(void 0===(null===r||void 0===r?void 0:r.config)||"object"===typeof(null===r||void 0===r?void 0:r.config))},t.IFluidCodeDetailsComparer="IFluidCodeDetailsComparer"},67692:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidRouter=void 0,t.IFluidRouter="IFluidRouter"},82226:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidHandle=t.IFluidHandleContext=void 0,t.IFluidHandleContext="IFluidHandleContext",t.IFluidHandle="IFluidHandle"},58293:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.IFluidHandle=t.IFluidHandleContext=t.IFluidRouter=t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=t.IFluidRunnable=t.IFluidLoadable=t.FluidErrorTypes=void 0;var n=r(39807);Object.defineProperty(t,"FluidErrorTypes",{enumerable:!0,get:function(){return n.FluidErrorTypes}});var o=r(6301);Object.defineProperty(t,"IFluidLoadable",{enumerable:!0,get:function(){return o.IFluidLoadable}}),Object.defineProperty(t,"IFluidRunnable",{enumerable:!0,get:function(){return o.IFluidRunnable}});var i=r(38241);Object.defineProperty(t,"isFluidPackage",{enumerable:!0,get:function(){return i.isFluidPackage}}),Object.defineProperty(t,"isFluidCodeDetails",{enumerable:!0,get:function(){return i.isFluidCodeDetails}}),Object.defineProperty(t,"IFluidCodeDetailsComparer",{enumerable:!0,get:function(){return i.IFluidCodeDetailsComparer}});var s=r(67692);Object.defineProperty(t,"IFluidRouter",{enumerable:!0,get:function(){return s.IFluidRouter}});var a=r(82226);Object.defineProperty(t,"IFluidHandleContext",{enumerable:!0,get:function(){return a.IFluidHandleContext}}),Object.defineProperty(t,"IFluidHandle",{enumerable:!0,get:function(){return a.IFluidHandle}});var c=r(57837);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return c.LogLevel}})},57837:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,t.LogLevel={verbose:10,default:20,error:30}},31156:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverErrorType=t.DriverErrorTypes=void 0;const n=r(58293),{dataCorruptionError:o,dataProcessingError:i,...s}=n.FluidErrorTypes;var a;t.DriverErrorTypes={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"},function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(a||(t.DriverErrorType=a={}))},59592:(e,t,r)=>{"use strict";t.a_=void 0;var n=r(31156);Object.defineProperty(t,"a_",{enumerable:!0,get:function(){return n.DriverErrorTypes}});var o=r(29633);var i=r(38883)},29633:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.FetchSource=t.LoaderCachingPolicy=void 0,function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(r||(t.LoaderCachingPolicy=r={})),function(e){e.default="default",e.noCache="noCache"}(n||(t.FetchSource=n={}))},38883:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DriverHeader=void 0,function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(r||(t.DriverHeader=r={}))},25880:(e,t,r)=>{"use strict";r.d(t,{jB:()=>b,TX:()=>m,qw:()=>v,Q3:()=>C,lJ:()=>S});const{dataCorruptionError:n,dataProcessingError:o,...i}={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},s={...i,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var a;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(a||(a={}));var c=r(76078),l=r(60056),d=r(19307);var u;!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly",e.blockedIPAddress="blockedIPAddress"}(u||(u={}));var h=r(74086);const g="Bearer";const p="2.0.0-rc.1.0.8",m=712,f="serviceReadOnly";function v(e){const t={sprequestduration:(0,c.ZK)(e.get("sprequestduration")),contentsize:(0,c.ZK)(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach((r=>{const n=e.get(r.headerName);void 0!==n&&null!==n&&(t[r.logName]=n)}));const r=e.get("x-fluid-telemetry");if(void 0!==r&&null!==r){t.xFluidTelemetry=r;const e=r.split(",").map((e=>e.split("=")));for(const[r,n]of e)if("Origin"===r.trim()){let e;switch(null===n||void 0===n?void 0:n.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=null===n||void 0===n?void 0:n.trim()}t["responseOrigin"]=e;break}}return t}class y extends l.iq{constructor(e,t,r){super(e,r,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function b(e,t,r,n,o){let i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const c=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=null===e||void 0===e?void 0:e.error;return"string"===typeof(null===t||void 0===t?void 0:t.message)&&(void 0===(null===t||void 0===t?void 0:t.code)||"string"===typeof(null===t||void 0===t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(t){}return{success:!1}}(o);let l,b,S;if(c.success){const e=c.errorResponse;s.responseMessage=e.error.message,l=function(e){const t=[];let r=e.error;for(;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(e),void 0!==l&&(b=l[0],s.innerMostErrorCode=b)}const C={driverVersion:p,statusCode:t,...s};switch(t){case 400:if("fluidInvalidSchema"===b){i=new d.d8(e,C);break}i=new d.OI(e,a.genericNetworkError,C);break;case 401:case 403:if(b===f)i=new d.dw(e,u.serviceReadOnly,C);else if("blockedIPAddress"===b||"conditionalAccessPolicyEnforced"===b)i=new d.OI("IP Address is blocked",u.blockedIPAddress,C);else{const t=null!==n&&void 0!==n&&n.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let r,n=!1;return t.split(",").map((e=>{const t=e.split("=");t.length>=2&&(n||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,h.AH)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):n="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),n?r:void 0}(n.headers):void 0,r=null!==n&&void 0!==n&&n.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(g);if(r<0)return;let n;return t.substring(r+g.length).split(",").map((e=>{if(!n){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(n=JSON.parse(t[1].trim()))}})),n}(n.headers):void 0;i=new d.yi(e,t,r,C)}break;case 404:if(c.success){var k;const t=null===c||void 0===c||null===(k=c.errorResponse)||void 0===k?void 0:k.error;if(S=null===t||void 0===t?void 0:t["@error.redirectLocation"],void 0!==S){i=new y(e,S,C);break}}i=new d.OI(e,a.fileNotFoundOrAccessDeniedError,C);break;case 406:i=new d.OI(e,a.unsupportedClientProtocolVersion,C);break;case 410:i=new d.OI(e,u.cannotCatchUp,C);break;case 409:i=new d.OI(e,a.fileOverwrittenInStorage,C);break;case 412:i=new d.OI(e,a.genericNetworkError,C);break;case 413:i=new d.OI(e,u.snapshotTooBig,C);break;case 414:i=new d.OI(e,u.invalidFileNameError,C);break;case 423:if("resourceLocked"===b||"resourceCheckedOut"===b){i=new d.OI(e,a.fileIsLocked,C);break}case 500:i=new d.dw(e,a.genericNetworkError,C);break;case 501:i=new d.OI(e,u.fluidNotEnabled,C);break;case 507:i=new d.OI(e,a.outOfStorageError,C);break;case m:i=new d.OI(e,a.incorrectServerResponse,C);break;default:const t=void 0!==r?1e3*r:void 0;i=(0,d.ix)(e,{canRetry:!0,retryAfterMs:t},C)}return i.addTelemetryProperties({endpointReached:!0}),function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=d.WA[(0,d.sc)()],void 0!==r&&(e.facetCodes=r);if(t&&(n.responseType=t.type,t.headers)){var o;const r=v(t.headers);for(const e of Object.keys(r))n[e]=r[e];e.serverEpoch=null!==(o=t.headers.get("x-fluid-epoch"))&&void 0!==o?o:void 0}e.addTelemetryProperties(n)}(i,n,l,void 0),i}function S(e,t,r,n,o){const i=b(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,n,o);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}function C(e){return Array.isArray(null===e||void 0===e?void 0:e.facetCodes)}},48849:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FluidErrorTypes=void 0,t.FluidErrorTypes={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},2059:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidRunnable=t.IFluidLoadable=void 0,t.IFluidLoadable="IFluidLoadable",t.IFluidRunnable="IFluidRunnable"},50623:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=void 0;t.isFluidPackage=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);t.isFluidCodeDetails=e=>{const r=e;return"object"===typeof r&&("string"===typeof(null===r||void 0===r?void 0:r.package)||(0,t.isFluidPackage)(null===r||void 0===r?void 0:r.package))&&(void 0===(null===r||void 0===r?void 0:r.config)||"object"===typeof(null===r||void 0===r?void 0:r.config))},t.IFluidCodeDetailsComparer="IFluidCodeDetailsComparer"},73900:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidHandle=t.IFluidHandleContext=void 0,t.IFluidHandleContext="IFluidHandleContext",t.IFluidHandle="IFluidHandle"},16299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.IFluidHandle=t.IFluidHandleContext=t.IFluidCodeDetailsComparer=t.isFluidCodeDetails=t.isFluidPackage=t.IFluidRunnable=t.IFluidLoadable=t.FluidErrorTypes=void 0;var n=r(48849);Object.defineProperty(t,"FluidErrorTypes",{enumerable:!0,get:function(){return n.FluidErrorTypes}});var o=r(2059);Object.defineProperty(t,"IFluidLoadable",{enumerable:!0,get:function(){return o.IFluidLoadable}}),Object.defineProperty(t,"IFluidRunnable",{enumerable:!0,get:function(){return o.IFluidRunnable}});var i=r(50623);Object.defineProperty(t,"isFluidPackage",{enumerable:!0,get:function(){return i.isFluidPackage}}),Object.defineProperty(t,"isFluidCodeDetails",{enumerable:!0,get:function(){return i.isFluidCodeDetails}}),Object.defineProperty(t,"IFluidCodeDetailsComparer",{enumerable:!0,get:function(){return i.IFluidCodeDetailsComparer}});var s=r(73900);Object.defineProperty(t,"IFluidHandleContext",{enumerable:!0,get:function(){return s.IFluidHandleContext}}),Object.defineProperty(t,"IFluidHandle",{enumerable:!0,get:function(){return s.IFluidHandle}});var a=r(83947);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return a.LogLevel}})},83947:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,t.LogLevel={verbose:10,default:20,error:30}},30462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverErrorType=t.DriverErrorTypes=void 0;const n=r(16299),{dataCorruptionError:o,dataProcessingError:i,...s}=n.FluidErrorTypes;var a;t.DriverErrorTypes={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"},function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(a||(t.DriverErrorType=a={}))},54362:(e,t,r)=>{"use strict";t.U2=void 0;var n=r(30462);var o=r(81519);var i=r(95881);Object.defineProperty(t,"U2",{enumerable:!0,get:function(){return i.DriverHeader}})},81519:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.FetchSource=t.LoaderCachingPolicy=void 0,function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(r||(t.LoaderCachingPolicy=r={})),function(e){e.default="default",e.noCache="noCache"}(n||(t.FetchSource=n={}))},95881:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DriverHeader=void 0,function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(r||(t.DriverHeader=r={}))},5881:(e,t,r)=>{"use strict";r.d(t,{It:()=>i,hK:()=>o});var n=r(2642);function o(e){const t=e.type===n.Z.Handle?e.handleType:e.type;switch(t){case n.Z.Blob:case n.Z.Attachment:return"blob";case n.Z.Tree:return"tree";default:!function(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}(t,"Unknown type: ".concat(t))}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n={},o={id:e.sha,blobs:{},trees:{}};n[""]=o;for(const i of e.tree){const e=r?i.path.replace(/^\.app\//,""):i.path,o=e.lastIndexOf("/"),s=e.slice(0,Math.max(0,o)),a=e.slice(o+1),c=n[s];if("tree"===i.type){const t={id:i.sha,blobs:{},commits:{},trees:{}};c.trees[decodeURIComponent(a)]=t,n[e]=t}else{if("blob"!==i.type)throw new Error("Unknown entry type!!");c.blobs[decodeURIComponent(a)]=i.sha,t.set(i.sha,"/".concat(e))}}return o}},72264:(e,t,r)=>{"use strict";r.d(t,{CL:()=>f,G0:()=>u,Ln:()=>g,fG:()=>p,lh:()=>i,uz:()=>h});var n=r(58400),o=r(76078);const i=new n.d((()=>a(d()))),s={getRawConfig:()=>{}},a=e=>void 0!==e&&null!==e?new u(void 0,{getRawConfig:t=>{try{var r,n;return null===(r=l(null!==(n=e.getItem(t))&&void 0!==n?n:void 0))||void 0===r?void 0:r.raw}catch{return}}}):s;function c(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function l(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===r)return t;const n=typeof r;if(c(n))return{...t,raw:e,[n]:r};if(Array.isArray(r)){const n=typeof r[0];if(!c(n))return t;for(const e of r)if(typeof e!==n)return t;return{...t,raw:e,["".concat(n,"[]")]:r}}return t}const d=()=>{try{var e;return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch{return}};class u{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];const i=[...n];for(;i.length>0;){const e=i.shift();void 0!==e&&m(e)&&!t.has(e)&&(t.add(e),e instanceof u?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const r of this.orderedBaseProviders){const n=l(null===r||void 0===r?void 0:r.getRawConfig(e));var t;if(void 0!==n)return this.configCache.set(e,n),null===(t=this.logger)||void 0===t||t.send({category:"generic",eventName:"ConfigRead",...(0,o.Df)({configName:e,configValue:JSON.stringify(n)})}),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function h(e){const t=e;return m(null===t||void 0===t?void 0:t.config)&&void 0!==(null===t||void 0===t?void 0:t.logger)}function g(e){return h(e)?e:p(e,i.value)}function p(e){if(h(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.config=new u(e,...n),t.logger=e,t}function m(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}function f(e){return g((0,o.pW)(e))}},43812:(e,t,r)=>{"use strict";r.d(t,{EW:()=>u,I9:()=>h,gn:()=>l,eb:()=>d,ds:()=>g,bt:()=>c});const n="genericError",o="dataCorruptionError",i="dataProcessingError",s="usageError";var a=r(60056);function c(e,t,r){if(!e)throw new d(t,r)}class l extends a.iq{constructor(e,t,r){super(e,r,new Set(["error"])),this.error=t,this.errorType=n}}class d extends a.iq{constructor(e,t){super(e,{...t,usageError:!0}),this.errorType=s}}class u extends a.iq{constructor(e,t){super(e,{...t,dataProcessingError:1}),this.errorType=o,this.canRetry=!1}}class h extends a.iq{constructor(e,t){super(e,t),this.errorType=i,this.canRetry=!1}static create(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=h.wrapIfUnrecognized(e,t,r);return o.addTelemetryProperties(n),o}static wrapIfUnrecognized(e,t,r){const n={dataProcessingError:1,dataProcessingCodepath:t,...void 0===r?void 0:g(r)},o=(0,a.cQ)(e,{props:n});if((0,a.vt)(o)||o.errorType===a.i5){const e=(0,a.J4)(o,(e=>new h(e)));return e.addTelemetryProperties(o.getTelemetryProperties()),e}return o}}const g=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp})},60056:(e,t,r)=>{"use strict";r.d(t,{iq:()=>T,i5:()=>I,AV:()=>h,oD:()=>f,aX:()=>v,OQ:()=>E,vt:()=>C,dy:()=>g,qp:()=>k,cQ:()=>p,kc:()=>S,J4:()=>y,G:()=>b});const n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);function s(){if(!o&&(o="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)}const a=[];for(let F=0;F<256;++F)a.push((F+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return c(o)};var d=r(33941);const u=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function h(e,t){const r={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(u(e)){const{errorType:n,stack:o,name:i}=e;if("string"===typeof n&&(r.errorType=n),"string"===typeof o){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const n=e.split("\n");return n.shift(),void 0!==r&&n.unshift(r),n.join("\n")})(o,e)}}return r}const g=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if((0,d.cp)(e)&&function(e){const t=e;void 0===t.errorInstanceId&&(t.errorInstanceId=l())}(e),(0,d.Xy)(e))return e.addTelemetryProperties(null!==(r=t.props)&&void 0!==r?r:{}),e;const{message:n,stack:o}=h(e,!1),i=new N({message:n,stack:o});if("object"===typeof e&&null!==e){const t=e;let r;var s,a;if("canRetry"in e)null!==(s=r)&&void 0!==s||(r={}),r.canRetry=t.canRetry;if("retryAfterSeconds"in e)null!==(a=r)&&void 0!==a||(r={}),r.retryAfterSeconds=t.retryAfterSeconds;void 0!==r&&Object.assign(i,r)}"object"!==typeof e&&i.addTelemetryProperties({typeofError:typeof e});const c=T.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return i.addTelemetryProperties({...c,...t.props}),i}let m;function f(){const e=new Error("<<generated stack>>");if(void 0===m&&(m=void 0!==e.stack),m)return e;try{throw e}catch(t){return t}}function v(){return f().stack}function y(e,t){const{message:r,stack:n}=h(e,!1),o=t(r);return void 0!==n&&S(o,n),C(e)&&o.addTelemetryProperties({untrustedOrigin:1}),(0,d.fV)(e)&&(o.overwriteErrorInstanceId(e.errorInstanceId),o.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),g(e)&&o.addTelemetryProperties(e.getTelemetryProperties()),o}function b(e,t,r){const n=y(e,t),o=n.errorInstanceId,i=o;return r.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:o,wrappedByErrorInstanceId:i},e),n}function S(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function C(e){return T.typeCheck(e)?e.errorType===I&&1===e.getTelemetryProperties().untrustedOrigin:!(0,d.cp)(e)}function k(e){return"string"===typeof(null===e||void 0===e?void 0:e.tag)}function w(e,t){return Array.isArray(e)&&e.every((e=>P(e)))?JSON.stringify(e):P(e)?e:(console.error("UnSupported Format of Logging Error Property for key ".concat(t,":"),e),"REDACTED (arbitrary object)")}function P(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}const E=()=>{const e=new WeakSet;return(t,r)=>{if("object"===typeof r&&null!==r){if(e.has(r))return"<removed/circular>";e.add(r)}return r}};class T extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=l(),this.fluidErrorCode="-",r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const r of Object.keys(t))void 0===e[r]&&(e[r]=t[r])}(this,e)}getTelemetryProperties(){return{...function(e,t){const r={};for(const n of Object.keys(e)){if(t.has(n))continue;const o=e[n];r[n]=k(o)?{value:w(o.value,n),tag:o.tag}:w(o,n)}return r}(this,this.omitPropsFromLogging),stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const I="genericError";class N extends T{constructor(e){super(e.message),this.errorType=I,void 0!==e.stack&&S(this,e.stack)}}},25249:(e,t,r)=>{"use strict";r.d(t,{o:()=>o});var n=r(98418);class o extends n.X{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}catch(o){return this.errorHandler(e,o),!0}}}},24847:(e,t,r)=>{"use strict";r.d(t,{Tg:()=>n,aX:()=>s,uk:()=>i});const n="connected",o="disconnected";function i(e,t,r){try{for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];e.emit(r,...o)}catch(s){t.sendErrorEvent({eventName:"RaiseEventError",event:r},s)}}function s(e,t,r,i,s){try{r?t.emit(n,i):t.emit(o,s)}catch(a){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},a)}}},33941:(e,t,r)=>{"use strict";r.d(t,{Xy:()=>i,cp:()=>s,fV:()=>o});const n=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)&&"function"===typeof(null===e||void 0===e?void 0:e.addTelemetryProperties),o=e=>"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId);function i(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&o(e)&&n(e)}function s(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&n(e)}},76078:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>y,gn:()=>g,mc:()=>i,pW:()=>p,Z:()=>f,Hf:()=>u,T0:()=>d,ZK:()=>l,Df:()=>C});const n=20,o=30;var i,s=r(21605),a=r(72264),c=r(60056);function l(e){if(void 0===e||null===e)return;const t=Number(e);return Number.isNaN(t)?e:t}function d(e){return Math.floor(e)}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(i||(i={}));const u=":";class h{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:n,errorType:o,stack:i}=(0,c.AV)(t,!0);if(e.stack=i,e.error=n,e.errorType=o,(0,c.dy)(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=(0,c.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){var r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;this.sendTelemetryEventCore({...e,category:null!==(r=e.category)&&void 0!==r?r:"generic"},t,"error"===e.category?o:i)}sendTelemetryEventCore(e,t,r){const n=function(e){let{category:t,eventName:r,...n}=e;const o={category:t,eventName:r};for(const i of Object.keys(n))o[i]=b(n[i]);return o}(e);void 0!==t&&h.prepareErrorObject(n,t,!1),"number"===typeof n.duration&&(n.duration=d(n.duration)),this.send(n,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,o)}sendPerformanceEvent(e,t){var r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;const s={...e,category:null!==(r=e.category)&&void 0!==r?r:"performance"};this.sendTelemetryEventCore(s,t,"error"===s.category?o:i)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r={...e};return void 0!==this.namespace&&(r.eventName="".concat(this.namespace).concat(h.eventNamespaceSeparator).concat(r.eventName)),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const e of Object.keys(t)){if(void 0!==r[e])continue;const n=t[e],o="function"===typeof n?n():n;void 0!==o&&(r[e]=o)}}return e}}h.eventNamespaceSeparator=u;class g{constructor(e){this.logger=e}send(e){const t={category:e.category,eventName:e.eventName};for(const r of Object.keys(e)){const n=e[r],{value:o,tag:s}="object"===typeof n?n:{value:n,tag:void 0};switch(s){case void 0:case"PackageData":case i.CodeArtifact:t[r]=o;break;case i.UserData:t[r]="REDACTED (UserData)";break;default:t[r]="REDACTED (unknown tag)"}}this.logger.send(t)}}function p(e){return m.create(null===e||void 0===e?void 0:e.logger,null===e||void 0===e?void 0:e.namespace,null===e||void 0===e?void 0:e.properties)}class m extends h{static create(e,t,r){if(e instanceof m){const n={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(n.all={...n.all,...t.all}),void 0!==t.error&&(n.error={...n.error,...t.error}));const o=void 0===e.namespace?t:void 0===t?e.namespace:"".concat(e.namespace).concat(h.eventNamespaceSeparator).concat(t),i=new m(e.baseLogger,o,n);return!(0,a.uz)(i)&&(0,a.uz)(e)&&(0,a.fG)(i,e.config),i}return new m(null!==e&&void 0!==e?e:{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,(0,a.uz)(e)&&(0,a.fG)(this,new a.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){var r;return(null!==t&&void 0!==t?t:n)<(null!==(r=this.baseLogger.minLogLevel)&&void 0!==r?r:n)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}function f(e){var t;return new v(e.namespace,e.properties,null===(t=e.loggers)||void 0===t?void 0:t.filter((e=>void 0!==e)),e.tryInheritProperties)}class v extends h{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,i=void 0===t?void 0:{...t};if(!0===o){var s;const e=null!==(s=i)&&void 0!==s?s:i={};r.filter((e=>e instanceof h)).map((e=>{var t;return null!==(t=e.properties)&&void 0!==t?t:{}})).forEach((t=>{Object.keys(t).forEach((r=>{e[r]={...t[r],...null===e||void 0===e?void 0:e[r]}}))}))}super(e,i),this.loggers=r,this._minLogLevelOfAllLoggers=n,this.calculateMinLogLevel()}get minLogLevel(){return this._minLogLevelOfAllLoggers}calculateMinLogLevel(){if(this.loggers.length>0){const t=[];for(const r of this.loggers){var e;t.push(null!==(e=r.minLogLevel)&&void 0!==e?e:n)}this._minLogLevelOfAllLoggers=Math.min(...t)}}addLogger(e){void 0!==e&&null!==e&&(this.loggers.push(e),this.calculateMinLogLevel())}send(e){const t=this.prepareEvent(e);for(const r of this.loggers)r.send(t)}}class y{static start(e,t,r){return new y(e,t,r,arguments.length>3&&void 0!==arguments[3]&&arguments[3],!(arguments.length>4&&void 0!==arguments[4])||arguments[4])}static timedExec(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=y.start(e,t,n,void 0,y.shouldReport(t,o));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;const s=y.start(e,t,n,o,y.shouldReport(t,i));try{const e=await r(s);return s.autoEnd(),e}catch(a){throw s.cancel(void 0,a),a}}get duration(){return s.F.now()-this.startTime}constructor(e,t){var r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.logger=e,this.markers=n,this.recordHeapSize=o,this.emitLogs=i,this.startTime=s.F.now(),this.startMemoryCollection=0,this.event={...t},this.markers.start&&this.reportEvent("start"),"object"===typeof window&&null!==(r=window)&&void 0!==r&&null!==(r=r.performance)&&void 0!==r&&r.mark&&(this.startMark="".concat(t.eventName,"-start"),window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(this.startMark&&this.event){const e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const n={...this.event,...t};if(n.eventName="".concat(n.eventName,"_").concat(e),"start"!==e){if(n.duration=this.duration,this.startMemoryCollection){var o;const e=null===s.F||void 0===s.F||null===(o=s.F.memory)||void 0===o?void 0:o.usedJSHeapSize,t=Math.floor((e-this.startMemoryCollection)/1024);t>0&&(n.usedJSHeapSize=t)}}else if(this.recordHeapSize){var i;this.startMemoryCollection=null===s.F||void 0===s.F||null===(i=s.F.memory)||void 0===i?void 0:i.usedJSHeapSize}this.logger.sendPerformanceEvent(n,r)}static shouldReport(e,t){var r;const n=".".concat(e.category,".").concat(e.eventName),o=null!==(r=y.eventHits.get(n))&&void 0!==r?r:0;return y.eventHits.set(n,o>=t?1:o+1),o%t===0}}y.eventHits=new Map;function b(e){return(0,c.qp)(e)?{value:S(e.value),tag:e.tag}:S(e)}function S(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}const C=e=>((e,t)=>Object.entries(t).filter((e=>void 0!==e[1])).reduce(((t,r)=>{const[n,o]=r;return t[n]="function"===typeof o?()=>({tag:e,value:o()}):{tag:e,value:o},t}),{}))(i.CodeArtifact,e)},32782:(e,t,r)=>{"use strict";r.d(t,{A3:()=>l,Jf:()=>n,RC:()=>o,RG:()=>c,SK:()=>d,Ve:()=>u,be:()=>p,g3:()=>a,hW:()=>s,kZ:()=>i,qi:()=>h,zu:()=>g});const n={colorNeutralForeground1:"--colorNeutralForeground1",colorNeutralForeground1Hover:"--colorNeutralForeground1Hover",colorNeutralForeground1Pressed:"--colorNeutralForeground1Pressed",colorNeutralForeground1Selected:"--colorNeutralForeground1Selected",colorNeutralForeground2:"--colorNeutralForeground2",colorNeutralForeground2Hover:"--colorNeutralForeground2Hover",colorNeutralForeground2Pressed:"--colorNeutralForeground2Pressed",colorNeutralForeground2Selected:"--colorNeutralForeground2Selected",colorNeutralForeground2BrandHover:"--colorNeutralForeground2BrandHover",colorNeutralForeground2BrandPressed:"--colorNeutralForeground2BrandPressed",colorNeutralForeground2BrandSelected:"--colorNeutralForeground2BrandSelected",colorNeutralForeground3:"--colorNeutralForeground3",colorNeutralForeground3Hover:"--colorNeutralForeground3Hover",colorNeutralForeground3Pressed:"--colorNeutralForeground3Pressed",colorNeutralForeground3Selected:"--colorNeutralForeground3Selected",colorNeutralForeground3BrandHover:"--colorNeutralForeground3BrandHover",colorNeutralForeground3BrandPressed:"--colorNeutralForeground3BrandPressed",colorNeutralForeground3BrandSelected:"--colorNeutralForeground3BrandSelected",colorNeutralForeground4:"--colorNeutralForeground4",colorNeutralForegroundDisabled:"--colorNeutralForegroundDisabled",colorBrandForegroundLink:"--colorBrandForegroundLink",colorBrandForegroundLinkHover:"--colorBrandForegroundLinkHover",colorBrandForegroundLinkPressed:"--colorBrandForegroundLinkPressed",colorBrandForegroundLinkSelected:"--colorBrandForegroundLinkSelected",colorNeutralForeground2Link:"--colorNeutralForeground2Link",colorNeutralForeground2LinkHover:"--colorNeutralForeground2LinkHover",colorNeutralForeground2LinkPressed:"--colorNeutralForeground2LinkPressed",colorNeutralForeground2LinkSelected:"--colorNeutralForeground2LinkSelected",colorCompoundBrandForeground1:"--colorCompoundBrandForeground1",colorCompoundBrandForeground1Hover:"--colorCompoundBrandForeground1Hover",colorCompoundBrandForeground1Pressed:"--colorCompoundBrandForeground1Pressed",colorNeutralForegroundOnBrand:"--colorNeutralForegroundOnBrand",colorNeutralForegroundInverted:"--colorNeutralForegroundInverted",colorNeutralForegroundInvertedHover:"--colorNeutralForegroundInvertedHover",colorNeutralForegroundInvertedPressed:"--colorNeutralForegroundInvertedPressed",colorNeutralForegroundInvertedSelected:"--colorNeutralForegroundInvertedSelected",colorNeutralForegroundInverted2:"--colorNeutralForegroundInverted2",colorNeutralForegroundStaticInverted:"--colorNeutralForegroundStaticInverted",colorNeutralForegroundInvertedLink:"--colorNeutralForegroundInvertedLink",colorNeutralForegroundInvertedLinkHover:"--colorNeutralForegroundInvertedLinkHover",colorNeutralForegroundInvertedLinkPressed:"--colorNeutralForegroundInvertedLinkPressed",colorNeutralForegroundInvertedLinkSelected:"--colorNeutralForegroundInvertedLinkSelected",colorNeutralForegroundInvertedDisabled:"--colorNeutralForegroundInvertedDisabled",colorBrandForeground1:"--colorBrandForeground1",colorBrandForeground2:"--colorBrandForeground2",colorNeutralForeground1Static:"--colorNeutralForeground1Static",colorBrandForegroundInverted:"--colorBrandForegroundInverted",colorBrandForegroundInvertedHover:"--colorBrandForegroundInvertedHover",colorBrandForegroundInvertedPressed:"--colorBrandForegroundInvertedPressed",colorBrandForegroundOnLight:"--colorBrandForegroundOnLight",colorBrandForegroundOnLightHover:"--colorBrandForegroundOnLightHover",colorBrandForegroundOnLightPressed:"--colorBrandForegroundOnLightPressed",colorBrandForegroundOnLightSelected:"--colorBrandForegroundOnLightSelected",colorNeutralBackground1:"--colorNeutralBackground1",colorNeutralBackground1Hover:"--colorNeutralBackground1Hover",colorNeutralBackground1Pressed:"--colorNeutralBackground1Pressed",colorNeutralBackground1Selected:"--colorNeutralBackground1Selected",colorNeutralBackground2:"--colorNeutralBackground2",colorNeutralBackground2Hover:"--colorNeutralBackground2Hover",colorNeutralBackground2Pressed:"--colorNeutralBackground2Pressed",colorNeutralBackground2Selected:"--colorNeutralBackground2Selected",colorNeutralBackground3:"--colorNeutralBackground3",colorNeutralBackground3Hover:"--colorNeutralBackground3Hover",colorNeutralBackground3Pressed:"--colorNeutralBackground3Pressed",colorNeutralBackground3Selected:"--colorNeutralBackground3Selected",colorNeutralBackground4:"--colorNeutralBackground4",colorNeutralBackground4Hover:"--colorNeutralBackground4Hover",colorNeutralBackground4Pressed:"--colorNeutralBackground4Pressed",colorNeutralBackground4Selected:"--colorNeutralBackground4Selected",colorNeutralBackground5:"--colorNeutralBackground5",colorNeutralBackground5Hover:"--colorNeutralBackground5Hover",colorNeutralBackground5Pressed:"--colorNeutralBackground5Pressed",colorNeutralBackground5Selected:"--colorNeutralBackground5Selected",colorNeutralBackground6:"--colorNeutralBackground6",colorNeutralBackgroundInverted:"--colorNeutralBackgroundInverted",colorNeutralBackgroundStatic:"--colorNeutralBackgroundStatic",colorSubtleBackground:"--colorSubtleBackground",colorSubtleBackgroundHover:"--colorSubtleBackgroundHover",colorSubtleBackgroundPressed:"--colorSubtleBackgroundPressed",colorSubtleBackgroundSelected:"--colorSubtleBackgroundSelected",colorSubtleBackgroundLightAlphaHover:"--colorSubtleBackgroundLightAlphaHover",colorSubtleBackgroundLightAlphaPressed:"--colorSubtleBackgroundLightAlphaPressed",colorSubtleBackgroundLightAlphaSelected:"--colorSubtleBackgroundLightAlphaSelected",colorSubtleBackgroundInverted:"--colorSubtleBackgroundInverted",colorSubtleBackgroundInvertedHover:"--colorSubtleBackgroundInvertedHover",colorSubtleBackgroundInvertedPressed:"--colorSubtleBackgroundInvertedPressed",colorSubtleBackgroundInvertedSelected:"--colorSubtleBackgroundInvertedSelected",colorTransparentBackground:"--colorTransparentBackground",colorTransparentBackgroundHover:"--colorTransparentBackgroundHover",colorTransparentBackgroundPressed:"--colorTransparentBackgroundPressed",colorTransparentBackgroundSelected:"--colorTransparentBackgroundSelected",colorNeutralBackgroundDisabled:"--colorNeutralBackgroundDisabled",colorNeutralBackgroundInvertedDisabled:"--colorNeutralBackgroundInvertedDisabled",colorNeutralStencil1:"--colorNeutralStencil1",colorNeutralStencil2:"--colorNeutralStencil2",colorNeutralStencil1Alpha:"--colorNeutralStencil1Alpha",colorNeutralStencil2Alpha:"--colorNeutralStencil2Alpha",colorBackgroundOverlay:"--colorBackgroundOverlay",colorScrollbarOverlay:"--colorScrollbarOverlay",colorBrandBackground:"--colorBrandBackground",colorBrandBackgroundHover:"--colorBrandBackgroundHover",colorBrandBackgroundPressed:"--colorBrandBackgroundPressed",colorBrandBackgroundSelected:"--colorBrandBackgroundSelected",colorCompoundBrandBackground:"--colorCompoundBrandBackground",colorCompoundBrandBackgroundHover:"--colorCompoundBrandBackgroundHover",colorCompoundBrandBackgroundPressed:"--colorCompoundBrandBackgroundPressed",colorBrandBackgroundStatic:"--colorBrandBackgroundStatic",colorBrandBackground2:"--colorBrandBackground2",colorBrandBackgroundInverted:"--colorBrandBackgroundInverted",colorBrandBackgroundInvertedHover:"--colorBrandBackgroundInvertedHover",colorBrandBackgroundInvertedPressed:"--colorBrandBackgroundInvertedPressed",colorBrandBackgroundInvertedSelected:"--colorBrandBackgroundInvertedSelected",colorNeutralStrokeAccessible:"--colorNeutralStrokeAccessible",colorNeutralStrokeAccessibleHover:"--colorNeutralStrokeAccessibleHover",colorNeutralStrokeAccessiblePressed:"--colorNeutralStrokeAccessiblePressed",colorNeutralStrokeAccessibleSelected:"--colorNeutralStrokeAccessibleSelected",colorNeutralStrokeAlpha:"--colorNeutralStrokeAlpha",colorNeutralStroke1:"--colorNeutralStroke1",colorNeutralStroke1Hover:"--colorNeutralStroke1Hover",colorNeutralStroke1Pressed:"--colorNeutralStroke1Pressed",colorNeutralStroke1Selected:"--colorNeutralStroke1Selected",colorNeutralStroke2:"--colorNeutralStroke2",colorNeutralStroke3:"--colorNeutralStroke3",colorNeutralStrokeOnBrand:"--colorNeutralStrokeOnBrand",colorNeutralStrokeOnBrand2:"--colorNeutralStrokeOnBrand2",colorNeutralStrokeOnBrand2Hover:"--colorNeutralStrokeOnBrand2Hover",colorNeutralStrokeOnBrand2Pressed:"--colorNeutralStrokeOnBrand2Pressed",colorNeutralStrokeOnBrand2Selected:"--colorNeutralStrokeOnBrand2Selected",colorBrandStroke1:"--colorBrandStroke1",colorBrandStroke2:"--colorBrandStroke2",colorCompoundBrandStroke:"--colorCompoundBrandStroke",colorCompoundBrandStrokeHover:"--colorCompoundBrandStrokeHover",colorCompoundBrandStrokePressed:"--colorCompoundBrandStrokePressed",colorNeutralStrokeDisabled:"--colorNeutralStrokeDisabled",colorNeutralStrokeInvertedDisabled:"--colorNeutralStrokeInvertedDisabled",colorTransparentStroke:"--colorTransparentStroke",colorTransparentStrokeInteractive:"--colorTransparentStrokeInteractive",colorTransparentStrokeDisabled:"--colorTransparentStrokeDisabled",colorStrokeFocus1:"--colorStrokeFocus1",colorStrokeFocus2:"--colorStrokeFocus2",colorNeutralShadowAmbient:"--colorNeutralShadowAmbient",colorNeutralShadowKey:"--colorNeutralShadowKey",colorNeutralShadowAmbientLighter:"--colorNeutralShadowAmbientLighter",colorNeutralShadowKeyLighter:"--colorNeutralShadowKeyLighter",colorNeutralShadowAmbientDarker:"--colorNeutralShadowAmbientDarker",colorNeutralShadowKeyDarker:"--colorNeutralShadowKeyDarker",colorBrandShadowAmbient:"--colorBrandShadowAmbient",colorBrandShadowKey:"--colorBrandShadowKey",colorPaletteDarkOrangeForeground1:"--colorPaletteDarkOrangeForeground1",colorPaletteRedForeground1:"--colorPaletteRedForeground1"},o={fontFamilyBase:"--fontFamilyBase",fontFamilyMonospace:"--fontFamilyMonospace",fontFamilyNumeric:"--fontFamilyNumeric"},i={fontSizeBase100:"--fontSizeBase100",fontSizeBase200:"--fontSizeBase200",fontSizeBase300:"--fontSizeBase300",fontSizeBase400:"--fontSizeBase400",fontSizeBase500:"--fontSizeBase500",fontSizeBase600:"--fontSizeBase600",fontSizeHero700:"--fontSizeHero700",fontSizeHero800:"--fontSizeHero800",fontSizeHero900:"--fontSizeHero900",fontSizeHero1000:"--fontSizeHero1000"},s={fontWeightRegular:"--fontWeightRegular",fontWeightMedium:"--fontWeightMedium",fontWeightSemibold:"--fontWeightSemibold",fontWeightBold:"--fontWeightBold"},a={borderRadiusNone:"--borderRadiusNone",borderRadiusSmall:"--borderRadiusSmall",borderRadiusMedium:"--borderRadiusMedium",borderRadiusLarge:"--borderRadiusLarge",borderRadiusXLarge:"--borderRadiusXLarge",borderRadiusCircular:"--borderRadiusCircular"},c={lineHeightBase100:"--lineHeightBase100",lineHeightBase200:"--lineHeightBase200",lineHeightBase300:"--lineHeightBase300",lineHeightBase400:"--lineHeightBase400",lineHeightBase500:"--lineHeightBase500",lineHeightBase600:"--lineHeightBase600",lineHeightHero700:"--lineHeightHero700",lineHeightHero800:"--lineHeightHero800",lineHeightHero900:"--lineHeightHero900",lineHeightHero1000:"--lineHeightHero1000"},l={shadow2:"--shadow2",shadow4:"--shadow4",shadow8:"--shadow8",shadow16:"--shadow16",shadow28:"--shadow28",shadow64:"--shadow64",shadow2Brand:"--shadow2Brand",shadow4Brand:"--shadow4Brand",shadow8Brand:"--shadow8Brand",shadow16Brand:"--shadow16Brand",shadow28Brand:"--shadow28Brand",shadow64Brand:"--shadow64Brand"},d={strokeWidthThin:"--strokeWidthThin",strokeWidthThick:"--strokeWidthThick",strokeWidthThicker:"--strokeWidthThicker",strokeWidthThickest:"--strokeWidthThickest"},u={spacingHorizontalNone:"--spacingHorizontalNone",spacingHorizontalXXS:"--spacingHorizontalXXS",spacingHorizontalXS:"--spacingHorizontalXS",spacingHorizontalSNudge:"--spacingHorizontalSNudge",spacingHorizontalS:"--spacingHorizontalS",spacingHorizontalMNudge:"--spacingHorizontalMNudge",spacingHorizontalM:"--spacingHorizontalM",spacingHorizontalL:"--spacingHorizontalL",spacingHorizontalXL:"--spacingHorizontalXL",spacingHorizontalXXL:"--spacingHorizontalXXL",spacingHorizontalXXXL:"--spacingHorizontalXXXL",spacingVerticalNone:"--spacingVerticalNone",spacingVerticalXXS:"--spacingVerticalXXS",spacingVerticalXS:"--spacingVerticalXS",spacingVerticalSNudge:"--spacingVerticalSNudge",spacingVerticalS:"--spacingVerticalS",spacingVerticalMNudge:"--spacingVerticalMNudge",spacingVerticalM:"--spacingVerticalM",spacingVerticalL:"--spacingVerticalL",spacingVerticalXL:"--spacingVerticalXL",spacingVerticalXXL:"--spacingVerticalXXL",spacingVerticalXXXL:"--spacingVerticalXXXL"},h={durationUltraFast:"--durationUltraFast",durationFaster:"--durationFaster",durationFast:"--durationFast",durationNormal:"--durationNormal",durationGentle:"--durationGentle",durationSlow:"--durationSlow",durationSlower:"--durationSlower",durationUltraSlow:"--durationUltraSlow"},g={curveAccelerateMax:"--curveAccelerateMax",curveAccelerateMid:"--curveAccelerateMid",curveAccelerateMin:"--curveAccelerateMin",curveDecelerateMax:"--curveDecelerateMax",curveDecelerateMid:"--curveDecelerateMid",curveDecelerateMin:"--curveDecelerateMin",curveEasyEaseMax:"--curveEasyEaseMax",curveEasyEase:"--curveEasyEase",curveLinear:"--curveLinear"},p={colorNeutralBackground7:"--colorNeutralBackground7",colorNeutralBackground7Selected:"--colorNeutralBackground7Selected"}},83754:(e,t,r)=>{"use strict";r.d(t,{Fq:()=>a,KM:()=>n,PB:()=>s,Ve:()=>c,_D:()=>o,aM:()=>i});const n={BlockingBackground:"--ms-themeColorBlockingBackground",BlockingIcon:"--ms-themeColorBlockingIcon",BodyBackground:"--ms-themeColorBodyBackground",BodyBackgroundChecked:"--ms-themeColorBodyBackgroundChecked",BodyBackgroundHovered:"--ms-themeColorBodyBackgroundHovered",BodyDivider:"--ms-themeColorBodyDivider",BodyFrameBackground:"--ms-themeColorBodyFrameBackground",BodyFrameDivider:"--ms-themeColorBodyFrameDivider",BodyText:"--ms-themeColorBodyText",BodyTextChecked:"--ms-themeColorBodyTextChecked",BodyStandoutBackground:"--ms-themeColorBodyStandoutBackground",BodySubtext:"--ms-themeColorBodySubtext",DefaultStateBackground:"--ms-themeColorDefaultStateBackground",DisabledBodySubtext:"--ms-themeColorDisabledBodySubtext",DisabledBodyText:"--ms-themeColorDisabledBodyText",DisabledBorder:"--ms-themeColorDisabledBorder",ErrorBackground:"--ms-themeColorErrorBackground",ErrorBoxBackground:"--ms-themeColorErrorBoxBackground",ErrorIcon:"--ms-themeColorErrorIcon",ErrorBorder:"--ms-themeColorErrorBorder",ErrorBlock:"--ms-themeColorErrorBlock",DarkErrorBlock:"--ms-themeColorDarkErrorBlock",GrayErrorBackground:"--ms-themeColorGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorDarkGrayErrorBackground",ErrorText:"--ms-themeColorErrorText",InfoText:"--ms-themeColorInfoText",RedErrorText:"--ms-themeColorRedErrorText",GrayIcon:"--ms-themeColorGrayIcon",FocusBorder:"--ms-themeColorFocusBorder",InfoBackground:"--ms-themeColorInfoBackground",InfoIcon:"--ms-themeColorInfoIcon",MessageLink:"--ms-themeColorMessageLink",MessageLinkHovered:"--ms-themeColorMessageLinkHovered",MessageText:"--ms-themeColorMessageText",SevereWarningBackground:"--ms-themeColorSevereWarningBackground",SevereWarningIcon:"--ms-themeColorSevereWarningIcon",SuccessBackground:"--ms-themeColorSuccessBackground",SuccessIcon:"--ms-themeColorSuccessIcon",VariantBorder:"--ms-themeColorVariantBorder",VariantBorderHovered:"--ms-themeColorVariantBorderHovered",WarningBackground:"--ms-themeColorWarningBackground",WarningHighlight:"--ms-themeColorWarningHighlight",WarningIcon:"--ms-themeColorWarningIcon",ActionLink:"--ms-themeColorActionLink",ActionLinkHovered:"--ms-themeColorActionLinkHovered",Link:"--ms-themeColorLink",LinkHovered:"--ms-themeColorLinkHovered",AccentButtonBackground:"--ms-themeColorAccentButtonBackground",AccentButtonText:"--ms-themeColorAccentButtonText",ButtonBackground:"--ms-themeColorButtonBackground",ButtonBackgroundChecked:"--ms-themeColorButtonBackgroundChecked",ButtonBackgroundHovered:"--ms-themeColorButtonBackgroundHovered",ButtonBackgroundCheckedHovered:"--ms-themeColorButtonBackgroundCheckedHovered",ButtonBackgroundPressed:"--ms-themeColorButtonBackgroundPressed",ButtonBackgroundDisabled:"--ms-themeColorButtonBackgroundDisabled",ButtonBorder:"--ms-themeColorButtonBorder",ButtonText:"--ms-themeColorButtonText",ButtonTextHovered:"--ms-themeColorButtonTextHovered",ButtonTextChecked:"--ms-themeColorButtonTextChecked",ButtonTextCheckedHovered:"--ms-themeColorButtonTextCheckedHovered",ButtonTextPressed:"--ms-themeColorButtonTextPressed",ButtonTextDisabled:"--ms-themeColorButtonTextDisabled",ButtonBorderDisabled:"--ms-themeColorButtonBorderDisabled",PrimaryButtonBackground:"--ms-themeColorPrimaryButtonBackground",PrimaryButtonBackgroundHovered:"--ms-themeColorPrimaryButtonBackgroundHovered",PrimaryButtonBackgroundPressed:"--ms-themeColorPrimaryButtonBackgroundPressed",PrimaryButtonBackgroundDisabled:"--ms-themeColorPrimaryButtonBackgroundDisabled",PrimaryButtonBorder:"--ms-themeColorPrimaryButtonBorder",PrimaryButtonText:"--ms-themeColorPrimaryButtonText",PrimaryButtonTextHovered:"--ms-themeColorPrimaryButtonTextHovered",PrimaryButtonTextPressed:"--ms-themeColorPrimaryButtonTextPressed",PrimaryButtonTextDisabled:"--ms-themeColorPrimaryButtonTextDisabled",InputBorder:"--ms-themeColorInputBorder",InputBorderHovered:"--ms-themeColorInputBorderHovered",InputBackground:"--ms-themeColorInputBackground",InputBackgroundChecked:"--ms-themeColorInputBackgroundChecked",InputBackgroundCheckedHovered:"--ms-themeColorInputBackgroundCheckedHovered",InputPlaceholderBackgroundChecked:"--ms-themeColorInputPlaceholderBackgroundChecked",InputForegroundChecked:"--ms-themeColorInputForegroundChecked",InputIcon:"--ms-themeColorInputIcon",InputIconHovered:"--ms-themeColorInputIconHovered",InputIconDisabled:"--ms-themeColorInputIconDisabled",InputFocusBorderAlt:"--ms-themeColorInputFocusBorderAlt",SmallInputBorder:"--ms-themeColorSmallInputBorder",InputText:"--ms-themeColorInputText",InputTextHovered:"--ms-themeColorInputTextHovered",InputTextPressed:"--ms-themeColorInputTextPressed",InputPlaceholderText:"--ms-themeColorInputPlaceholderText",DisabledBackground:"--ms-themeColorDisabledBackground",DisabledText:"--ms-themeColorDisabledText",DisabledSubtext:"--ms-themeColorDisabledSubtext",ListBackground:"--ms-themeColorListBackground",ListText:"--ms-themeColorListText",ListTextColor:"--ms-themeColorListTextColor",ListItemBackgroundHovered:"--ms-themeColorListItemBackgroundHovered",ListItemBackgroundChecked:"--ms-themeColorListItemBackgroundChecked",ListItemBackgroundCheckedHovered:"--ms-themeColorListItemBackgroundCheckedHovered",ListHeaderBackgroundHovered:"--ms-themeColorListHeaderBackgroundHovered",ListHeaderBackgroundPressed:"--ms-themeColorListHeaderBackgroundPressed",MenuBackground:"--ms-themeColorMenuBackground",MenuBorder:"--ms-themeColorMenuBorder",MenuDivider:"--ms-themeColorMenuDivider",MenuIcon:"--ms-themeColorMenuIcon",MenuHeader:"--ms-themeColorMenuHeader",MenuItemBackgroundChecked:"--ms-themeColorMenuItemBackgroundChecked",MenuItemBackgroundHovered:"--ms-themeColorMenuItemBackgroundHovered",MenuItemBackgroundPressed:"--ms-themeColorMenuItemBackgroundPressed",MenuItemText:"--ms-themeColorMenuItemText",MenuItemTextHovered:"--ms-themeColorMenuItemTextHovered",MenuItemTextPressed:"--ms-themeColorMenuItemTextPressed",MenuItemTextChecked:"--ms-themeColorMenuItemTextChecked",MenuItemTextSecondary:"--ms-themeColorMenuItemTextSecondary",CardShadow:"--ms-themeCardShadow",CardShadowHovered:"--ms-themeCardShadowHovered",CardStandoutBackground:"--ms-themeColorCardStandoutBackground",GrabberBorderChecked:"--ms-grabberBorderChecked",GrabberBackgroundChecked:"--ms-grabberBackgroundChecked",GrabberColor:"--ms-grabberColor",GrabberColorChecked:"--ms-grabberColorChecked",CheckboxBackgroundUnchecked:"--ms-checkboxBackgroundUnchecked",CheckboxBackgroundChecked:"--ms-checkboxBackgroundChecked",CheckboxColorUnchecked:"--ms-checkboxColorUnchecked",CheckboxColorUncheckedHovered:"--ms-checkboxColorUncheckedHovered",CheckboxColorCheckedHovered:"--ms-checkboxColorCheckedHovered",CheckboxColorChecked:"--ms-checkboxColorChecked",CheckboxUnpopulated:"--ms-checkboxUnpopulated",TeamsV2DefaultForeground2:"--ms-themeColorPaletteTeamsV2DefaultForeground2",TeamsV2DefaultForeground:"--ms-themeColorPaletteTeamsV2DefaultForeground",TeamsV2DefaultForegroundHover:"--ms-themeColorPaletteTeamsV2DefaultForegroundHover",TeamsV2DefaultForegroundPressed:"--ms-themeColorPaletteTeamsV2DefaultForegroundPressed",TeamsV2DefaultBackground:"--ms-themeColorPaletteTeamsV2DefaultBackground",TeamsV2DefaultBackgroundHover:"--ms-themeColorPaletteTeamsV2DefaultBackgroundHover",TeamsV2DefaultBackgroundPressed:"--ms-themeColorPaletteTeamsV2DefaultBackgroundPressed",TeamsV2DefaultBorder:"--ms-themeColorPaletteTeamsV2DefaultBorder",TeamsV2DefaultBorderHover:"--ms-themeColorPaletteTeamsV2DefaultBorderHover",TeamsV2DefaultBorderPressed:"--ms-themeColorPaletteTeamsV2DefaultBorderPressed",TeamsV2BrandForeground4:"--ms-themeColorPaletteTeamsV2BrandForeground4",TeamsV2BrandBackground:"--ms-themeColorPaletteTeamsV2BrandBackground",TeamsV2BrandBackgroundHover:"--ms-themeColorPaletteTeamsV2BrandBackgroundHover",TeamsV2BrandBackgroundPressed:"--ms-themeColorPaletteTeamsV2BrandBackgroundPressed",VotingButtonHoverShadow:"--ms-themeColorPaletteVotingButtonHoverShadow"},o={ThemeName:"--ms-themeColorThemeName",TextSizeAdjust:"--ms-themeTextSizeAdjust",Selection:"--ms-themeColorSelection",SelectionBackground:"--ms-themeColorSelectionBackground",SelectionBorder:"--ms-themeColorSelectionBorder",DragDropTearOffPageBorder:"--ms-themeColorPaletteDragDropTearOffPageBorder",DragDropTearOffPageBackground:"--ms-themeColorPaletteDragDropTearOffPageBackground",BlockComponentPlaceholderBackground:"--ms-themeColorPaletteBlockComponentPlaceholderBackground",AtMentionBackgroundMe:"--ms-themeColorPaletteAtMentionBackGroundMe",AtMentionTextMe:"--ms-themeColorPaletteAtMentionTextMe",AtMentionBackgroundOther:"--ms-themeColorPaletteAtMentionBackgroundOther",AtMentionTextOther:"--ms-themeColorPaletteAtMentionTextOther",AtMentionBackgroundHighlight:"--ms-themeColorPaletteAtMentionBackgroundHighlight",AtMentionHighlightBorder:"--ms-themeColorPaletteAtMentionHighlightBorder",AtMentionUnresolvedBackground:"--ms-themeColorPaletteAtMentionUnresolvedBackground",AtMentionUnresolvedBackgroundHovered:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudHovered",AtMentionUnresolvedBackgroundPressed:"--ms-themeColorPaletteAtMentionsUnresolvedBackgroundPressed",AtMentionUnresolvedBackgroundSelected:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudSelected",AtMentionUnresolvedIcon:"--ms-themeColorPaletteAtMentionUnresolvedIcon",AtMentionUnresolvedIconHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconHovered",AtMentionUnresolvedIconPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconPressed",AtMentionUnresolvedIconSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconSelected",AtMentionUnresolvedIconInner:"--ms-themeColorPaletteAtMentionUnresolvedIconInner",AtMentionUnresolvedIconInnerHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerHovered",AtMentionUnresolvedIconInnerPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerPressed",AtMentionUnresolvedIconInnerSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerSelected",AtMentionUnresolvedOutline:"--ms-themeColorPaletteAtMentionUnresolvedOutline",AtMentionUnresolvedOutlineHovered:"--ms-themeColorPaletteAtMentionUnresolvedOutlineHovered",AtMentionUnresolvedOutlinePressed:"--ms-themeColorPaletteAtMentionUnresolvedOutlinePressed",AtMentionUnresolvedOutlineSelected:"--ms-themeColorPaletteAtMentionUnresolvedOutlineSelected",IconButton:"--ms-themeColorIconButton",IconButtonHovered:"--ms-themeColorIconButtonHovered",IconButtonPressed:"--ms-themeColorIconButtonPressed",IconButtonChecked:"--ms-themeColorIconButtonChecked",IconButtonBackground:"--ms-themeColorIconButtonBackground",IconButtonBackgroundHovered:"--ms-themeColorIconButtonBackgroundHovered",IconButtonBackgroundPressed:"--ms-themeColorIconButtonBackgroundPressed",IconButtonBackgroundChecked:"--ms-themeColorIconButtonBackgroundChecked",OverflowText:"--ms-themeColorOverflowText",OverflowTextHovered:"--ms-themeColorOverflowTextHovered",OverflowTextPressed:"--ms-themeColorOverflowTextPressed",OverflowTextChecked:"--ms-themeColorOverflowTextChecked",OverflowBackground:"--ms-themeColorOverflowBackground",OverflowBackgroundHovered:"--ms-themeColorOverflowBackgroundHovered",OverflowBackgroundPressed:"--ms-themeColorOverflowBackgroundPressed",OverflowBackgroundChecked:"--ms-themeColorOverflowBackgroundChecked",MenuBorder:"--ms-themeColorMenuBorder",TooltipText:"--ms-themeColorTooltipText",TooltipBackground:"--ms-themeColorTooltipBackground",CalendarCellText:"--ms-themeColorCalendarCellText",CalendarCellTextHovered:"--ms-themeColorCalendarCellTextHovered",CalendarCellTextChecked:"--ms-themeColorCalendarCellTextChecked",CalendarCellTextToday:"--ms-themeColorCalendarCellTextToday",CalendarHeaderText:"--ms-themeColorCalendarHeaderText",CalendarBackground:"--ms-themeColorCalendarBackground",CalendarCellBackground:"--ms-themeColorCalendarCellBackground",CalendarCellBackgroundHovered:"--ms-themeColorCalendarCellBackgroundHovered",CalendarCellBackgroundChecked:"--ms-themeColorCalendarCellBackgroundSelected",CalendarCellBackgroundToday:"--ms-themeColorCalendarCellBackgroundToday",DatePickerTextToday:"--ms-themeColorDatePickerTextToday",DatePickerTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",DatePickerTextYesterday:"--ms-themeColorDatePickerTextYesterday",DatePickerTextOther:"--ms-themeColorDatePickerTextOther",DatePickerBackgroundToday:"--ms-themeColorDatePickerBackgroundToday",DatePickerBackgroundTomorrow:"--ms-themeColorDatePickerBackgroundTomorrow",DatePickerBackgroundYesterday:"--ms-themeColorDatePickerBackgroundYesterday",DatePickerBackground:"--ms-themeColorDatePickerBackground",DatePickerGrayedText:"--ms-themeColorDatePickerGrayedText",DatePickerGrayedBackground:"--ms-themeColorDatePickerGrayedBackground",TaskDueDateTextToday:"--ms-themeColorDatePickerTextToday",TaskDueDateTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",TaskDueDateTextYesterday:"--ms-themeColorDatePickerTextYesterday",TaskDueDateTextOther:"--ms-themeColorDatePickerTextOther",PersonaBorder:"--ms-themeColorPersonaBorder",PersonaText:"--ms-themeColorPersonaText",BodyBackgroundWithAlpha:"--ms-themeColorBodyBackgroundWithAlpha",ErrorCalloutText:"--ms-themeColorErrorCalloutText",ErrorCalloutBackground:"--ms-themeColorErrorCalloutBackground",ErrorSnackbarText:"--ms-themeColorErrorSnackbarText",ErrorSnackbarBackground:"--ms-themeColorErrorSnackbarBackground",WarningSnackbarText:"--ms-themeColorWarningSnackbarText",WarningSnackbarBackground:"--ms-themeColorWarningSnackbarBackground",TextSelectionBackgroundHovered:"--ms-themeColorPaletteTextSelectionBackgroundHovered",TextSelectionBackgroundPressed:"--ms-themeColorPaletteTextSelectionBackgroundPressed",TextSelectionEndCap:"--ms-themeColorPaletteTextSelectionEndCap",TextSelectionHorizontalCap:"--ms-themeColorPaletteTextSelectionHorizontalCap",FloatieText:"--ms-themeColorPaletteFloatieText",FloatieTextHovered:"--ms-themeColorPaletteFloatieTextHovered",FloatieTextPressed:"--ms-themeColorPaletteFloatieTextPressed",FloatieBackground:"--ms-themeColorPaletteFloatieBackground",FloatieBackgroundHovered:"--ms-themeColorPaletteFloatieBackgroundHovered",FloatieBackgroundPressed:"--ms-themeColorPaletteFloatieBackgroundPressed",FloatieBorder:"--ms-themeColorPaletteFloatieBorder",FloatieBorderHovered:"--ms-themeColorPaletteFloatieBorderHovered",FloatieBorderPressed:"--ms-themeColorPaletteFloatieBorderPressed",FontColorRed:"--ms-themeColorPaletteFontColorRed",FontColorOrange:"--ms-themeColorPaletteFontColorOrange",FontColorYellow:"--ms-themeColorPaletteFontColorYellow",FontColorGreen:"--ms-themeColorPaletteFontColorGreen",FontColorBlueGreen:"--ms-themeColorPaletteFontColorBlueGreen",FontColorBlue:"--ms-themeColorPaletteFontColorBlue",FontColorPurple:"--ms-themeColorPaletteFontColorPurple",BackgroundColorRed:"--ms-themeColorPaletteBackgroundColorRed",BackgroundColorOrange:"--ms-themeColorPaletteBackgroundColorOrange",BackgroundColorYellow:"--ms-themeColorPaletteBackgroundColorYellow",BackgroundColorGreen:"--ms-themeColorPaletteBackgroundColorGreen",BackgroundColorBlueGreen:"--ms-themeColorPaletteBackgroundColorBlueGreen",BackgroundColorBlue:"--ms-themeColorPaletteBackgroundColorBlue",BackgroundColorPurple:"--ms-themeColorPaletteBackgroundColorPurple",BackgroundAcrylicColorized:"--colorBackgroundAcrylicColorized",BackgroundAcrylicColorizedFallback:"--colorBackgroundAcrylicColorizedFallback",BackgroundAcrylicNeutral:"--colorBackgroundAcrylicNeutral",BackgroundAcrylicNeutralFallback:"--colorBackgroundAcrylicNeutralFallback",ComponentGlowBorder1:"--ms-themeColorPaletteComponentGlowBorder1",ComponentGlowBorder2:"--ms-themeColorPaletteComponentGlowBorder2",ComponentGlowBorder3:"--ms-themeColorPaletteComponentGlowBorder3",ComponentGlowBorder4:"--ms-themeColorPaletteComponentGlowBorder4",ComponentGlowBorder5:"--ms-themeColorPaletteComponentGlowBorder5",InCanvasPresenceText:"--ms-themeColorInCanvasPresenceText"},i={Default:"default",Dark:"dark",HighContrast:"high-contrast"},s={MarginTopBody:"--ms-themeMarginTopBody",MarginTopHeading1:"--ms-themeMarginTopHeading1",MarginTopHeading2:"--ms-themeMarginTopHeading2",MarginTopHeading3:"--ms-themeMarginTopHeading3",LineHeightBody:"--ms-themeLineHeightBody",LineHeightHeading1:"--ms-themeLineHeightHeading1",LineHeightHeading2:"--ms-themeLineHeightHeading2",LineHeightHeading3:"--ms-themeLineHeightHeading3",OutlineBody:"--ms-themeOutlineBody",OutlineHeading1:"--ms-themeOutlineHeading1",OutlineHeading2:"--ms-themeOutlineHeading2",OutlineHeading3:"--ms-themeOutlineHeading3",TextDecorationComplement:"--ms-themeTextDecorationComplement"},a={FontFamilyBody:"--ms-themeFontFamilyBody",FontFamilyHeading1:"--ms-themeFontFamilyHeading1",FontFamilyHeading2:"--ms-themeFontFamilyHeading2",FontFamilyHeading3:"--ms-themeFontFamilyHeading3",FontFamilyMenu:"--ms-themeFontFamilyMenu",FontFamilyButton:"--ms-themeFontFamilyButton",FontSizeBody:"--ms-themeFontSizeBody",FontSizeHeading1:"--ms-themeFontSizeHeading1",FontSizeHeading2:"--ms-themeFontSizeHeading2",FontSizeHeading3:"--ms-themeFontSizeHeading3",FontSizeHeading4:"--ms-themeFontSizeHeading4",FontSizeMenu:"--ms-themeFontSizeMenu",FontSizeButton:"--ms-themeFontSizeButton",FontWeightBody:"--ms-themeFontWeightBody",FontWeightHeading1:"--ms-themeFontWeightHeading1",FontWeightHeading2:"--ms-themeFontWeightHeading2",FontWeightHeading3:"--ms-themeFontWeightHeading3",FontWeightMenu:"--ms-themeFontWeightMenu",FontWeightButton:"--ms-themeFontWeightButton"},c={PinkRed10:"--ms-themeColorPaletteSharedPinkRed10",Red20:"--ms-themeColorPaletteSharedRed20",Red10:"--ms-themeColorPaletteSharedRed10",RedOrange10:"--ms-themeColorPaletteSharedRedOrange10",Orange30:"--ms-themeColorPaletteSharedOrange30",Orange20:"--ms-themeColorPaletteSharedOrange20",Orange10:"--ms-themeColorPaletteSharedOrange10",Yellow20:"--ms-themeColorPaletteSharedYellow20",Yellow10:"--ms-themeColorPaletteSharedYellow10",OrangeYellow20:"--ms-themeColorPaletteSharedOrangeYellow20",OrangeYellow10:"--ms-themeColorPaletteSharedOrangeYellow10",YellowGreen10:"--ms-themeColorPaletteSharedYellowGreen10",Green20:"--ms-themeColorPaletteSharedGreen20",Green10:"--ms-themeColorPaletteSharedGreen10",GreenCyan10:"--ms-themeColorPaletteSharedGreenCyan10",Cyan30:"--ms-themeColorPaletteSharedCyan30",Cyan20:"--ms-themeColorPaletteSharedCyan20",Cyan10:"--ms-themeColorPaletteSharedCyan10",CyanBlue20:"--ms-themeColorPaletteSharedCyanBlue20",CyanBlue10:"--ms-themeColorPaletteSharedCyanBlue10",Blue10:"--ms-themeColorPaletteSharedBlue10",BlueMagenta30:"--ms-themeColorPaletteSharedBlueMagenta30",BlueMagenta20:"--ms-themeColorPaletteSharedBlueMagenta20",BlueMagenta10:"--ms-themeColorPaletteSharedBlueMagenta10",Magenta20:"--ms-themeColorPaletteSharedMagenta20",Magenta10:"--ms-themeColorPaletteSharedMagenta10",MagentaPink20:"--ms-themeColorPaletteSharedMagentaPink20",MagentaPink10:"--ms-themeColorPaletteSharedMagentaPink10",Gray430:"--ms-themeColorPaletteSharedGray430",Gray180:"--ms-themeColorPaletteSharedGray180",Gray130:"--ms-themeColorPaletteSharedGray130",Gray100:"--ms-themeColorPaletteSharedGray100",Gray80:"--ms-themeColorPaletteSharedGray80",Gray70:"--ms-themeColorPaletteSharedGray70",Gray50:"--ms-themeColorPaletteSharedGray50",Gray40:"--ms-themeColorPaletteSharedGray40",Gray30:"--ms-themeColorPaletteSharedGray30",Gray20:"--ms-themeColorPaletteSharedGray20",Gray10:"--ms-themeColorPaletteSharedGray10",Gray4:"--ms-themeColorPaletteSharedGray4",Gray6:"--ms-themeColorPaletteSharedGray6",Gray5:"--ms-themeColorPaletteSharedGray5",Gray1:"--ms-themeColorPaletteSharedGray1",Away:"--ms-themeColorPalettePresenceAway",DoNotDisturb:"--ms-themeColorPalettePresenceDoNotDisturb",Online:"--ms-themeColorPalettePresenceOnline",Invisible:"--ms-themeColorPalettePresenceInvisible",OutOfOffice:"--ms-themeColorPalettePresenceOutOfOffice",Warning:"--ms-themeColorPaletteMessagingWarning",WarningIcon:"--ms-themeColorPaletteMessagingWarningIcon",SevereWarning:"--ms-themeColorPaletteMessagingSevereWarning",SevereWarningIcon:"--ms-themeColorPaletteMessagingServereWarningIcon",ErrorBlock:"--ms-themeColorPaletteMessagingErrorBlock",ErrorBlockIcon:"--ms-themeColorPaletteMessagingErrorBlockIcon",ErrorBackground:"--ms-themeColorPaletteMessagingErrorBackground",ErrorBoxBackground:"--ms-themeColorPaletteMessagingErrorBoxBackground",ErrorText:"--ms-themeColorPaletteMessagingErrorText",InfoText:"--ms-themeColorPaletteMessagingInfoText",DarkErrorBlock:"--ms-themeColorPaletteMessagingDarkErrorBlock",GrayErrorBackground:"--ms-themeColorPaletteMessagingGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorPaletteMessagingDarkGrayErrorBackground",GrayErrorText:"--ms-themeColorPaletteMessagingGrayErrorText",RedErrorText:"--ms-themeColorPaletteMessagingRedErrorText",GrayIcon:"--ms-themeColorPaletteMessagingGrayIcon",ButtonText:"--ms-themeColorPaletteMessagingButtonText",Success:"--ms-themeColorPaletteMessagingSuccess",SuccessIcon:"--ms-themeColorPaletteMessagingSuccessIcon",themeDarker:"--ms-themeColorPaletteThemeDarker",themeDark:"--ms-themeColorPaletteThemeDark",themeDarkAlt:"--ms-themeColorPaletteThemeDarkAlt",themePrimary:"--ms-themeColorPaletteThemePrimary",themeSecondary:"--ms-themeColorPaletteThemeSecondary",themeTertiary:"--ms-themeColorPaletteThemeTertiary",themeLight:"--ms-themeColorPaletteThemeLight",themeLighter:"--ms-themeColorPaletteThemeLighter",themeLighterAlt:"--ms-themeColorPaletteThemeLightAlt",black:"--ms-themeColorPaletteBlack",neutralDark:"--ms-themeColorPaletteNeutralDark",neutralPrimary:"--ms-themeColorPaletteNeutralPrimary",neutralPrimaryAlt:"--ms-themeColorPaletteNeutralPrimaryAlt",neutralSecondary:"--ms-themeColorPaletteNeutralSecondary",neutralSecondaryAlt:"--ms-themeColorPaletteNeutralSecondaryAlt",neutralTertiary:"--ms-themeColorPaletteNeutralTertiary",neutralTertiaryAlt:"--ms-themeColorPaletteNeutralTertiaryAlt",neutralQuaternary:"--ms-themeColorPaletteNeutralQuaternary",neutralQuaternaryAlt:"--ms-themeColorPaletteNeutralQuaternaryAlt",neutralQuaternaryAlt2:"--ms-themeColorPaletteNeutralQuaternaryAlt2",neutralLight:"--ms-themeColorPaletteNeutralLight",neutralLightAlt:"--ms-themeColorPaletteNeutralLightAlt",neutralLighter:"--ms-themeColorPaletteNeutralLighter",neutralLighterAlt:"--ms-themeColorPaletteNeutralLighterAlt",white:"--ms-themeColorPaletteWhite",yellowDark:"--ms-themeColorPaletteAccentYellowDark",yellow:"--ms-themeColorPaletteAccentYellow",yellowLight:"--ms-themeColorPaletteAccentYellowLight",orange:"--ms-themeColorPaletteAccentOrange",orangeLight:"--ms-themeColorPaletteAccentOrangeLight",orangeLighter:"--ms-themeColorPaletteAccentOrangeLighter",redDark:"--ms-themeColorPaletteAccentRedDark",red:"--ms-themeColorPaletteAccentRed",magentaDark:"--ms-themeColorPaletteAccentMagentaDark",magenta:"--ms-themeColorPaletteAccentMagenta",magentaLight:"--ms-themeColorPaletteAccentMagentaLight",purpleDark:"--ms-themeColorPaletteAccentPurpleDark",purple:"--ms-themeColorPaletteAccentPurple",purpleLight:"--ms-themeColorPaletteAccentPurpleLight",blueDark:"--ms-themeColorPaletteAccentBlueDark",blueMid:"--ms-themeColorPaletteAccentBlueMid",blue:"--ms-themeColorPaletteAccentBlue",blueAlt:"--ms-themeColorPaletteAccentBlueAlt",blueLight:"--ms-themeColorPaletteAccentBlueLight",tealDark:"--ms-themeColorPaletteAccentTealDark",teal:"--ms-themeColorPaletteAccentTeal",tealLight:"--ms-themeColorPaletteAccentTealLight",greenDark:"--ms-themeColorPaletteAccentGreenDark",green:"--ms-themeColorPaletteAccentGreen",greenLight:"--ms-themeColorPaletteAccentGreenLight",SuggestionAcceptedBackground:"--ms-themeColorPaletteProofingSuggestionAcceptedBackground",SpellingSuggestionHoverHighlight:"--ms-themeColorPaletteProofingSpellingSuggestionHoverHighlight",SpellingHoverTextColor:"--ms-themeColorPaletteProofingSpellingHoverTextColor",GrammarSuggestionHoverHighlight:"--ms-themeColorPaletteProofingGrammarSuggestionHoverHighlight",GrammarHoverTextColor:"--ms-themeColorPaletteProofingGrammarHoverTextColor",HeadingDetectedHoverHighlight:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverHighlight",HeadingDetectedHoverTextColor:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverTextColor",TaskRecognitionUnderline:"--ms-themeColorPaletteAnnotationsTaskRecognitionUnderline",TaskRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverHighlight",TaskRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverTextColor",EntityRecognitionUnderline:"--ms-themeColorPaletteAnnotationsEntityRecognitionUnderline",EntityRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverHighlight",EntityRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverTextColor",Scrollbar:"--ms-themeColorScrollbar",ScrollbarPressed:"--ms-themeColorScrollbarPressed",HeadingText:"--ms-themeColorHeadingText"}},12179:(e,t,r)=>{"use strict";r.d(t,{x:()=>a});var n=r(22751),o=r(45107);const i="--ms-themeColorPalette",s="--ms-themeColor";function a(e){const t=e?(0,o.P)(e):void 0,r={},a={},l=(0,n.a)(),d=(e,t)=>{if(e.startsWith(i)){const n=function(e){const t="--ms-themeColorPaletteShared",r="--ms-themeColorPaletteAccent";if(e.startsWith(t))return c(e,t);if(e.startsWith(r))return c(e,r);if(e.startsWith(i))return c(e,i);return}(e);void 0!==n&&l.palette.hasOwnProperty(n)&&!r[n]&&(r[n]=t)}else if(e.startsWith(s)){const r=c(e,s);r&&l.semanticColors.hasOwnProperty(r)&&!a[r]&&(a[r]=t)}};if(t)for(const n of t)d(n.name,n.value);return(0,n.a)({palette:r,semanticColors:a})}function c(e,t){const r=e.substring(t.length);return"".concat(r.substring(0,1).toLowerCase()).concat(r.substring(1))}},68216:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var n=r(45799),o=r(45107);const i="--";function s(e){const t=e?(0,o.P)(e):void 0,r=(0,n.a)({10:"#29130b",20:"#4d2415",30:"#792000",40:"#99482b",50:"#a52c00",60:"#c33400",70:"#e06a3f",80:"#d83b01",90:"#dd4f1b",100:"#fe7948",110:"#ff865a",120:"#ff9973",130:"#e8825d",140:"#ffb498",150:"#f4beaa",160:"#f9dcd1"}),s=(e,t)=>{const n=function(e){if(e.startsWith(i)){const t=e.replace(i,"");return"".concat(t.charAt(0).toLowerCase()).concat(t.substring(1))}return e}(e);n&&r.hasOwnProperty(n)&&(r[n]=t)};if(t)for(const n of t)s(n.name,n.value);return r}},45107:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var n=r(4846);function o(e){const t=[];for(const r of e){let e,o;Array.isArray(r)?(e=r[0],o=r[1]):(e=r.name,o=r.value),t.push({name:e,value:o});const i=n.y.get(e);if(i)for(const r of i)if(void 0===t.find((e=>e.name===r))){const e={name:r,value:o};t.push(e)}}return t}},4846:(e,t,r)=>{"use strict";r.d(t,{c:()=>s,y:()=>i});var n=r(32782),o=r(83754);const i=new Map([[n.Jf.colorNeutralForeground1,[o.Ve.neutralPrimary,o.KM.ActionLink,o.KM.BodyText,o.KM.ButtonText,o.KM.ButtonTextChecked,o.KM.ButtonTextCheckedHovered,o.KM.ButtonTextHovered,o.KM.ButtonTextPressed,o.KM.InputText,o.KM.ListText,o.KM.ListTextColor,o.KM.MenuIcon,o.KM.MenuItemText,o.KM.MessageText]],[n.Jf.colorNeutralForeground1Hover,[o.Ve.neutralPrimary,o.KM.ActionLinkHovered,o.KM.InputTextHovered]],[n.Jf.colorNeutralForeground1Pressed,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForeground1Selected,[o.Ve.neutralPrimary,o.KM.BodyTextChecked]],[n.Jf.colorNeutralForeground2,[o.Ve.neutralSecondary,o.KM.BodySubtext]],[n.Jf.colorNeutralForeground2Hover,[o.Ve.neutralPrimary,o.KM.MenuItemTextHovered]],[n.Jf.colorNeutralForeground2Pressed,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForeground2Selected,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForeground2BrandHover,[o.Ve.themePrimary]],[n.Jf.colorNeutralForeground2BrandPressed,[o.Ve.themeDarkAlt]],[n.Jf.colorNeutralForeground2BrandSelected,[o.Ve.themePrimary]],[n.Jf.colorNeutralForeground3,[o.Ve.neutralTertiary,o.KM.InputIcon,o.KM.InputIconHovered,o.KM.MenuHeader]],[n.Jf.colorNeutralForeground3Hover,[o.Ve.neutralSecondary]],[n.Jf.colorNeutralForeground3Pressed,[o.Ve.neutralSecondary]],[n.Jf.colorNeutralForeground3Selected,[o.Ve.neutralSecondary]],[n.Jf.colorNeutralForeground3BrandHover,[o.Ve.themePrimary]],[n.Jf.colorNeutralForeground3BrandPressed,[o.Ve.themeDarkAlt]],[n.Jf.colorNeutralForeground3BrandSelected,[o.Ve.themePrimary]],[n.Jf.colorNeutralForeground4,[o.Ve.neutralQuaternary,o.KM.InputPlaceholderText]],[n.Jf.colorNeutralForegroundDisabled,[o.Ve.neutralTertiaryAlt,o.KM.ButtonTextDisabled,o.KM.DisabledBodySubtext,o.KM.DisabledBodyText,o.KM.DisabledText,o.KM.InputIconDisabled,o.KM.PrimaryButtonTextDisabled]],[n.Jf.colorBrandForegroundLink,[o.Ve.themeDarkAlt,o.KM.Link,o.KM.MessageLink]],[n.Jf.colorBrandForegroundLinkHover,[o.Ve.themeDark,o.KM.LinkHovered,o.KM.MessageLinkHovered]],[n.Jf.colorBrandForegroundLinkPressed,[o.Ve.themeDarker]],[n.Jf.colorBrandForegroundLinkSelected,[o.Ve.themeDarkAlt]],[n.Jf.colorNeutralForeground2Link,[o.Ve.neutralSecondary]],[n.Jf.colorNeutralForeground2LinkHover,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForeground2LinkPressed,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForeground2LinkSelected,[o.Ve.neutralPrimary]],[n.Jf.colorCompoundBrandForeground1,[o.Ve.themePrimary]],[n.Jf.colorCompoundBrandForeground1Hover,[o.Ve.themeDarkAlt]],[n.Jf.colorCompoundBrandForeground1Pressed,[o.Ve.themeDark]],[n.Jf.colorBrandForeground1,[o.Ve.themePrimary]],[n.Jf.colorBrandForeground2,[o.Ve.themeDarkAlt]],[n.Jf.colorNeutralForeground1Static,[o.Ve.neutralPrimary]],[n.Jf.colorNeutralForegroundInverted,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedHover,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedPressed,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedSelected,[o.Ve.white]],[n.Jf.colorNeutralForegroundOnBrand,[o.Ve.white,o.KM.AccentButtonText,o.KM.InputForegroundChecked,o.KM.PrimaryButtonText,o.KM.PrimaryButtonTextHovered,o.KM.PrimaryButtonTextPressed]],[n.Jf.colorNeutralForegroundInvertedLink,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedLinkHover,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedLinkPressed,[o.Ve.white]],[n.Jf.colorNeutralForegroundInvertedLinkSelected,[o.Ve.white]],[n.Jf.colorNeutralForegroundInverted2,[o.Ve.white]],[n.Jf.colorBrandForegroundInverted,[o.Ve.themeSecondary]],[n.Jf.colorBrandForegroundInvertedHover,[o.Ve.themeTertiary]],[n.Jf.colorBrandForegroundInvertedPressed,[o.Ve.themeSecondary]],[n.Jf.colorBrandForegroundOnLight,[o.Ve.themePrimary]],[n.Jf.colorBrandForegroundOnLightHover,[o.Ve.themeDarkAlt]],[n.Jf.colorBrandForegroundOnLightPressed,[o.Ve.themeDark]],[n.Jf.colorBrandForegroundOnLightSelected,[o.Ve.themeDark]],[n.Jf.colorNeutralBackground1,[o.Ve.white,o.KM.BodyBackground,o.KM.BodyFrameBackground,o.KM.ButtonBackground,o.KM.CardStandoutBackground,o.KM.InputBackground,o.KM.ListBackground,o.KM.MenuBackground,o.KM.MenuItemBackgroundChecked]],[n.Jf.colorNeutralBackground1Hover,[o.Ve.neutralLighter,o.KM.BodyBackgroundHovered,o.KM.ButtonBackgroundCheckedHovered,o.KM.ButtonBackgroundHovered,o.KM.ListHeaderBackgroundHovered,o.KM.ListItemBackgroundHovered,o.KM.MenuItemBackgroundHovered,o.KM.MenuItemBackgroundPressed]],[n.Jf.colorNeutralBackground1Pressed,[o.Ve.neutralQuaternaryAlt,o.KM.ButtonBackgroundPressed,o.KM.ListHeaderBackgroundPressed]],[n.Jf.colorNeutralBackground1Selected,[o.Ve.neutralLight,o.KM.BodyBackgroundChecked,o.KM.ButtonBackgroundChecked,o.KM.ListItemBackgroundChecked,o.KM.ListItemBackgroundCheckedHovered]],[n.Jf.colorNeutralBackground2,[o.Ve.neutralLighterAlt,o.KM.BodyStandoutBackground,o.KM.DefaultStateBackground]],[n.Jf.colorNeutralBackground2Hover,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground2Pressed,[o.Ve.neutralQuaternaryAlt]],[n.Jf.colorNeutralBackground2Selected,[o.Ve.neutralLight]],[n.Jf.colorNeutralBackground3,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground3Hover,[o.Ve.neutralLight]],[n.Jf.colorNeutralBackground3Pressed,[o.Ve.neutralQuaternary]],[n.Jf.colorNeutralBackground3Selected,[o.Ve.neutralQuaternaryAlt]],[n.Jf.colorNeutralBackground4,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground4Hover,[o.Ve.neutralLighterAlt]],[n.Jf.colorNeutralBackground4Pressed,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground4Selected,[o.Ve.white]],[n.Jf.colorNeutralBackground5,[o.Ve.neutralLight]],[n.Jf.colorNeutralBackground5Hover,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground5Pressed,[o.Ve.neutralLighter]],[n.Jf.colorNeutralBackground5Selected,[o.Ve.neutralLighterAlt]],[n.Jf.colorNeutralBackground6,[o.Ve.neutralLight]],[n.Jf.colorNeutralBackgroundInverted,[o.Ve.neutralSecondary]],[n.Jf.colorSubtleBackgroundHover,[o.Ve.neutralLighter]],[n.Jf.colorSubtleBackgroundPressed,[o.Ve.neutralQuaternaryAlt]],[n.Jf.colorSubtleBackgroundSelected,[o.Ve.neutralLight]],[n.Jf.colorNeutralBackgroundDisabled,[o.Ve.neutralLighter,o.KM.ButtonBackgroundDisabled,o.KM.DisabledBackground,o.KM.PrimaryButtonBackgroundDisabled]],[n.Jf.colorNeutralStencil1,[o.Ve.neutralLight]],[n.Jf.colorNeutralStencil2,[o.Ve.neutralLighterAlt]],[n.Jf.colorBrandBackground,[o.Ve.themePrimary,o.KM.AccentButtonBackground,o.KM.PrimaryButtonBackground]],[n.Jf.colorBrandBackgroundHover,[o.Ve.themeDarkAlt,o.KM.PrimaryButtonBackgroundHovered]],[n.Jf.colorBrandBackgroundPressed,[o.Ve.themeDarker,o.KM.PrimaryButtonBackgroundPressed]],[n.Jf.colorBrandBackgroundSelected,[o.Ve.themeDark]],[n.Jf.colorCompoundBrandBackground,[o.Ve.themePrimary,o.KM.InputBackgroundChecked]],[n.Jf.colorCompoundBrandBackgroundHover,[o.Ve.themeDarkAlt,o.KM.InputBackgroundCheckedHovered]],[n.Jf.colorCompoundBrandBackgroundPressed,[o.Ve.themeDark]],[n.Jf.colorBrandBackgroundStatic,[o.Ve.themePrimary]],[n.Jf.colorBrandBackground2,[o.Ve.themeLighterAlt]],[n.Jf.colorBrandBackgroundInverted,[o.Ve.white]],[n.Jf.colorBrandBackgroundInvertedHover,[o.Ve.themeLighterAlt]],[n.Jf.colorBrandBackgroundInvertedPressed,[o.Ve.themeLight]],[n.Jf.colorBrandBackgroundInvertedSelected,[o.Ve.themeLighter,o.KM.InputPlaceholderBackgroundChecked]],[n.Jf.colorNeutralStrokeAccessible,[o.Ve.neutralSecondary,o.KM.InputBorder]],[n.Jf.colorNeutralStrokeAccessibleHover,[o.Ve.neutralSecondary,o.KM.InputBorderHovered]],[n.Jf.colorNeutralStrokeAccessiblePressed,[o.Ve.neutralSecondary]],[n.Jf.colorNeutralStrokeAccessibleSelected,[o.Ve.themePrimary]],[n.Jf.colorNeutralStroke1,[o.Ve.neutralQuaternary,o.KM.ButtonBorder]],[n.Jf.colorNeutralStroke1Hover,[o.Ve.neutralTertiaryAlt]],[n.Jf.colorNeutralStroke1Pressed,[o.Ve.neutralTertiaryAlt]],[n.Jf.colorNeutralStroke1Selected,[o.Ve.neutralTertiaryAlt]],[n.Jf.colorNeutralStroke2,[o.Ve.neutralQuaternaryAlt,o.KM.BodyDivider,o.KM.BodyFrameDivider,o.KM.MenuDivider]],[n.Jf.colorNeutralStroke3,[o.Ve.neutralLighter]],[n.Jf.colorNeutralStrokeOnBrand,[o.Ve.white]],[n.Jf.colorNeutralStrokeOnBrand2,[o.Ve.white]],[n.Jf.colorNeutralStrokeOnBrand2Hover,[o.Ve.white]],[n.Jf.colorNeutralStrokeOnBrand2Pressed,[o.Ve.white]],[n.Jf.colorNeutralStrokeOnBrand2Selected,[o.Ve.white]],[n.Jf.colorBrandStroke1,[o.Ve.themePrimary]],[n.Jf.colorBrandStroke2,[o.Ve.themeLight,o.KM.FocusBorder]],[n.Jf.colorCompoundBrandStroke,[o.Ve.themePrimary,o.KM.InputFocusBorderAlt]],[n.Jf.colorCompoundBrandStrokeHover,[o.Ve.themeDarkAlt]],[n.Jf.colorCompoundBrandStrokePressed,[o.Ve.themeDark]],[n.Jf.colorNeutralStrokeDisabled,[o.Ve.neutralQuaternaryAlt,o.KM.ButtonBorderDisabled,o.KM.DisabledBorder]],[o.Ve.black,[n.Jf.colorStrokeFocus2,n.Jf.colorNeutralForeground1Selected]],[o.Ve.neutralDark,[n.Jf.colorNeutralForeground1Hover]],[o.Ve.neutralPrimary,[n.Jf.colorNeutralForeground1,n.Jf.colorNeutralStrokeAccessibleHover]],[o.Ve.neutralSecondary,[n.Jf.colorNeutralForeground2,n.Jf.colorNeutralForeground3,n.Jf.colorNeutralForeground4,n.Jf.colorNeutralStrokeAccessible]],[o.Ve.neutralSecondaryAlt,[n.Jf.colorNeutralStroke1]],[o.Ve.neutralTertiary,[n.Jf.colorNeutralForegroundDisabled]],[o.Ve.neutralLight,[n.Jf.colorNeutralBackground1Selected,n.Jf.colorNeutralBackground1Pressed,n.Jf.colorNeutralStroke2]],[o.Ve.neutralLighter,[n.Jf.colorNeutralStrokeDisabled,n.Jf.colorNeutralBackgroundDisabled,n.Jf.colorNeutralBackground1Hover]],[o.Ve.neutralLightAlt,[n.Jf.colorNeutralBackground2]],[o.Ve.neutralLight,[n.Jf.colorSubtleBackgroundPressed]],[o.Ve.neutralSecondary,[n.Jf.colorNeutralForeground2Selected]],[o.Ve.white,[n.Jf.colorStrokeFocus1,n.Jf.colorNeutralForegroundOnBrand,n.Jf.colorNeutralBackground1]],[o.Ve.themeDarker,[n.Jf.colorBrandForegroundLinkHover]],[o.Ve.themeDark,[n.Jf.colorCompoundBrandBackgroundHover,n.Jf.colorBrandBackgroundPressed]],[o.Ve.themeDarkAlt,[n.Jf.colorBrandBackgroundHover]],[o.Ve.themePrimary,[n.Jf.colorBrandBackground,n.Jf.colorCompoundBrandBackground,n.Jf.colorCompoundBrandStroke,n.Jf.colorBrandForegroundLink]],[o.Ve.themeLighter,[n.Jf.colorBrandBackgroundInvertedSelected]],[o.KM.AccentButtonBackground,[n.Jf.colorBrandBackground]],[o.KM.AccentButtonText,[n.Jf.colorNeutralForegroundOnBrand]],[o.KM.ActionLink,[n.Jf.colorNeutralForeground1]],[o.KM.ActionLinkHovered,[n.Jf.colorNeutralForeground1Hover]],[o.KM.BodyBackground,[n.Jf.colorNeutralBackground1]],[o.KM.BodyBackgroundChecked,[n.Jf.colorNeutralBackground1Selected]],[o.KM.BodyBackgroundHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.BodyDivider,[n.Jf.colorNeutralStroke2]],[o.KM.BodyFrameBackground,[n.Jf.colorNeutralBackground1]],[o.KM.BodyFrameDivider,[n.Jf.colorNeutralStroke2]],[o.KM.BodyStandoutBackground,[n.Jf.colorNeutralBackground2]],[o.KM.BodySubtext,[n.Jf.colorNeutralForeground3]],[o.KM.BodyText,[n.Jf.colorNeutralForeground1]],[o.KM.BodyTextChecked,[n.Jf.colorNeutralForeground1Selected]],[o.KM.ButtonBackground,[n.Jf.colorNeutralBackground1]],[o.KM.ButtonBackgroundChecked,[n.Jf.colorNeutralBackground1Selected]],[o.KM.ButtonBackgroundCheckedHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.ButtonBackgroundDisabled,[n.Jf.colorNeutralBackgroundDisabled]],[o.KM.ButtonBackgroundHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.ButtonBackgroundPressed,[n.Jf.colorNeutralBackground1Pressed]],[o.KM.ButtonBorder,[n.Jf.colorNeutralStroke1]],[o.KM.ButtonBorderDisabled,[n.Jf.colorNeutralStrokeDisabled]],[o.KM.ButtonText,[n.Jf.colorNeutralForeground1]],[o.KM.ButtonTextChecked,[n.Jf.colorNeutralForeground1]],[o.KM.ButtonTextCheckedHovered,[n.Jf.colorNeutralForeground1]],[o.KM.ButtonTextDisabled,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.ButtonTextHovered,[n.Jf.colorNeutralForeground1]],[o.KM.ButtonTextPressed,[n.Jf.colorNeutralForeground1]],[o.KM.CardStandoutBackground,[n.Jf.colorNeutralBackground1]],[o.KM.DefaultStateBackground,[n.Jf.colorNeutralBackground2]],[o.KM.DisabledBackground,[n.Jf.colorNeutralBackgroundDisabled]],[o.KM.DisabledBodySubtext,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.DisabledBodySubtext,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.DisabledBorder,[n.Jf.colorNeutralStrokeDisabled]],[o.KM.DisabledSubtext,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.DisabledText,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.FocusBorder,[n.Jf.colorStrokeFocus2]],[o.KM.InputBackground,[n.Jf.colorNeutralBackground1]],[o.KM.InputBackgroundChecked,[n.Jf.colorCompoundBrandBackground]],[o.KM.InputBackgroundCheckedHovered,[n.Jf.colorCompoundBrandBackgroundHover]],[o.KM.InputBorder,[n.Jf.colorNeutralStrokeAccessible]],[o.KM.InputBorderHovered,[n.Jf.colorNeutralStrokeAccessibleHover]],[o.KM.InputFocusBorderAlt,[n.Jf.colorCompoundBrandStroke]],[o.KM.InputForegroundChecked,[n.Jf.colorNeutralForegroundOnBrand]],[o.KM.InputIcon,[n.Jf.colorNeutralForeground3]],[o.KM.InputIconDisabled,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.InputIconHovered,[n.Jf.colorNeutralForeground3]],[o.KM.InputPlaceholderBackgroundChecked,[n.Jf.colorBrandBackgroundInvertedSelected]],[o.KM.InputPlaceholderText,[n.Jf.colorNeutralForeground4]],[o.KM.InputText,[n.Jf.colorNeutralForeground1]],[o.KM.InputTextHovered,[n.Jf.colorNeutralForeground1Hover]],[o.KM.Link,[n.Jf.colorBrandForegroundLink]],[o.KM.LinkHovered,[n.Jf.colorBrandForegroundLinkHover]],[o.KM.ListBackground,[n.Jf.colorNeutralBackground1]],[o.KM.ListHeaderBackgroundHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.ListHeaderBackgroundPressed,[n.Jf.colorNeutralBackground1Pressed]],[o.KM.ListItemBackgroundChecked,[n.Jf.colorNeutralBackground1Selected]],[o.KM.ListItemBackgroundCheckedHovered,[n.Jf.colorNeutralBackground1Selected]],[o.KM.ListItemBackgroundHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.ListText,[n.Jf.colorNeutralForeground1]],[o.KM.ListTextColor,[n.Jf.colorNeutralForeground1]],[o.KM.MenuBackground,[n.Jf.colorNeutralBackground1]],[o.KM.MenuDivider,[n.Jf.colorNeutralStroke2]],[o.KM.MenuHeader,[n.Jf.colorNeutralForeground3]],[o.KM.MenuIcon,[n.Jf.colorNeutralForeground1]],[o.KM.MenuItemBackgroundChecked,[n.Jf.colorNeutralBackground1]],[o.KM.MenuItemBackgroundHovered,[n.Jf.colorNeutralBackground1Hover]],[o.KM.MenuItemBackgroundPressed,[n.Jf.colorNeutralBackground1Hover]],[o.KM.MenuItemText,[n.Jf.colorNeutralForeground1]],[o.KM.MenuItemTextHovered,[n.Jf.colorNeutralForeground2Hover]],[o.KM.MessageLink,[n.Jf.colorBrandForegroundLink]],[o.KM.MessageLinkHovered,[n.Jf.colorBrandForegroundLinkHover]],[o.KM.MessageText,[n.Jf.colorNeutralForeground1]],[o.KM.PrimaryButtonBackground,[n.Jf.colorBrandBackground]],[o.KM.PrimaryButtonBackgroundDisabled,[n.Jf.colorNeutralBackgroundDisabled]],[o.KM.PrimaryButtonBackgroundHovered,[n.Jf.colorBrandBackgroundHover]],[o.KM.PrimaryButtonBackgroundPressed,[n.Jf.colorBrandBackgroundPressed]],[o.KM.PrimaryButtonBorder,[n.Jf.colorTransparentStroke]],[o.KM.PrimaryButtonText,[n.Jf.colorNeutralForegroundOnBrand]],[o.KM.PrimaryButtonTextDisabled,[n.Jf.colorNeutralForegroundDisabled]],[o.KM.PrimaryButtonTextHovered,[n.Jf.colorNeutralForegroundOnBrand]],[o.KM.PrimaryButtonTextPressed,[n.Jf.colorNeutralForegroundOnBrand]]]),s=[{name:n.Jf.colorTransparentStroke,value:"transparent"},{name:n.g3.borderRadiusNone,value:"0px"},{name:n.g3.borderRadiusSmall,value:"2px"},{name:n.g3.borderRadiusMedium,value:"4px"},{name:n.g3.borderRadiusLarge,value:"6px"},{name:n.g3.borderRadiusXLarge,value:"8px"},{name:n.g3.borderRadiusCircular,value:"10000px"},{name:n.kZ.fontSizeBase100,value:"10px"},{name:n.kZ.fontSizeBase200,value:"12px"},{name:n.kZ.fontSizeBase300,value:"14px"},{name:n.kZ.fontSizeBase400,value:"16px"},{name:n.kZ.fontSizeBase500,value:"20px"},{name:n.kZ.fontSizeBase600,value:"24px"},{name:n.kZ.fontSizeHero700,value:"28px"},{name:n.kZ.fontSizeHero800,value:"32px"},{name:n.kZ.fontSizeHero900,value:"40px"},{name:n.kZ.fontSizeHero1000,value:"68px"},{name:n.RG.lineHeightBase100,value:"14px"},{name:n.RG.lineHeightBase200,value:"16px"},{name:n.RG.lineHeightBase300,value:"20px"},{name:n.RG.lineHeightBase400,value:"22px"},{name:n.RG.lineHeightBase500,value:"28px"},{name:n.RG.lineHeightBase600,value:"32px"},{name:n.RG.lineHeightHero700,value:"36px"},{name:n.RG.lineHeightHero800,value:"40px"},{name:n.RG.lineHeightHero900,value:"52px"},{name:n.RG.lineHeightHero1000,value:"92px"},{name:n.RC.fontFamilyBase,value:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},{name:n.RC.fontFamilyMonospace,value:"Consolas, 'Courier New', Courier, monospace"},{name:n.RC.fontFamilyNumeric,value:"Bahnschrift,'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},{name:n.hW.fontWeightRegular,value:"400"},{name:n.hW.fontWeightMedium,value:"500"},{name:n.hW.fontWeightSemibold,value:"600"},{name:n.hW.fontWeightBold,value:"700"},{name:n.SK.strokeWidthThin,value:"1px"},{name:n.SK.strokeWidthThick,value:"2px"},{name:n.SK.strokeWidthThicker,value:"3px"},{name:n.SK.strokeWidthThickest,value:"4px"},{name:n.Ve.spacingHorizontalNone,value:"0px"},{name:n.Ve.spacingHorizontalXXS,value:"2px"},{name:n.Ve.spacingHorizontalXS,value:"4px"},{name:n.Ve.spacingHorizontalSNudge,value:"6px"},{name:n.Ve.spacingHorizontalS,value:"8px"},{name:n.Ve.spacingHorizontalMNudge,value:"10px"},{name:n.Ve.spacingHorizontalM,value:"12px"},{name:n.Ve.spacingHorizontalL,value:"16px"},{name:n.Ve.spacingHorizontalXL,value:"20px"},{name:n.Ve.spacingHorizontalXXL,value:"24px"},{name:n.Ve.spacingHorizontalXXXL,value:"32px"},{name:n.Ve.spacingVerticalNone,value:"0px"},{name:n.Ve.spacingVerticalXXS,value:"2px"},{name:n.Ve.spacingVerticalXS,value:"4px"},{name:n.Ve.spacingVerticalSNudge,value:"6px"},{name:n.Ve.spacingVerticalS,value:"8px"},{name:n.Ve.spacingVerticalMNudge,value:"10px"},{name:n.Ve.spacingVerticalM,value:"12px"},{name:n.Ve.spacingVerticalL,value:"16px"},{name:n.Ve.spacingVerticalXL,value:"20px"},{name:n.Ve.spacingVerticalXXL,value:"24px"},{name:n.Ve.spacingVerticalXXXL,value:"32px"},{name:n.qi.durationUltraFast,value:"50ms"},{name:n.qi.durationFaster,value:"100ms"},{name:n.qi.durationFast,value:"150ms"},{name:n.qi.durationNormal,value:"200ms"},{name:n.qi.durationGentle,value:"250ms"},{name:n.qi.durationSlow,value:"300ms"},{name:n.qi.durationSlower,value:"400ms"},{name:n.qi.durationUltraSlow,value:"500ms"},{name:n.zu.curveAccelerateMax,value:"cubic-bezier(1,0,1,1)"},{name:n.zu.curveAccelerateMid,value:"cubic-bezier(0.7,0,1,0.5)"},{name:n.zu.curveAccelerateMin,value:"cubic-bezier(0.8,0,1,1)"},{name:n.zu.curveDecelerateMax,value:"cubic-bezier(0,0,0,1)"},{name:n.zu.curveDecelerateMid,value:"cubic-bezier(0.1,0.9,0.2,1)"},{name:n.zu.curveDecelerateMid,value:"cubic-bezier(0.33,0,0.1,1)"},{name:n.zu.curveEasyEaseMax,value:"cubic-bezier(0.8,0,0.1,1)"},{name:n.zu.curveEasyEase,value:"cubic-bezier(0.33,0,0.67,1)"},{name:n.zu.curveLinear,value:"cubic-bezier(0,0,1,1)"},{name:n.A3.shadow2,value:"0 0 2px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.14)"},{name:n.A3.shadow4,value:"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)"},{name:n.A3.shadow8,value:"0 0 2px rgba(0,0,0,0.12), 0 4px 8px rgba(0,0,0,0.14)"},{name:n.A3.shadow16,value:"0 0 2px rgba(0,0,0,0.12), 0 8px 16px rgba(0,0,0,0.14)"},{name:n.A3.shadow28,value:"0 0 2px rgba(0,0,0,0.12), 0 14px 28px rgba(0,0,0,0.14)"},{name:n.A3.shadow64,value:"0 0 2px rgba(0,0,0,0.12), 0 32px 64px rgba(0,0,0,0.14)"},{name:n.A3.shadow2Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 1px 2px rgba(0,0,0,0.25)"},{name:n.A3.shadow4Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 2px 4px rgba(0,0,0,0.25)"},{name:n.A3.shadow8Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 4px 8px rgba(0,0,0,0.25)"},{name:n.A3.shadow16Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 8px 16px rgba(0,0,0,0.25)"},{name:n.A3.shadow28Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 14px 28px rgba(0,0,0,0.25)"},{name:n.A3.shadow64Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 32px 64px rgba(0,0,0,0.25)"},{name:n.A3.shadow64Brand,value:"0 0 2px rgba(0,0,0,0.30), 0 32px 64px rgba(0,0,0,0.25)"},{name:n.Jf.colorNeutralShadowAmbient,value:"rgba(0,0,0,0.10)"},{name:n.Jf.colorNeutralShadowAmbientLighter,value:"rgba(0,0,0,0.08)"},{name:n.Jf.colorNeutralShadowAmbientDarker,value:"rgba(0,0,0,0.14)"},{name:n.Jf.colorBrandShadowAmbient,value:"rgba(0,0,0,0.30)"},{name:n.Jf.colorNeutralShadowKey,value:"rgba(0,0,0,0.12)"},{name:n.Jf.colorNeutralShadowKeyLighter,value:"rgba(0,0,0,0.10)"},{name:n.Jf.colorNeutralShadowKeyDarker,value:"rgba(0,0,0,0.14)"},{name:n.Jf.colorBrandShadowKey,value:"rgba(0,0,0,0.25)"},{name:n.Jf.colorNeutralStrokeInvertedDisabled,value:"rgba(255, 255, 255, 0.4)"},{name:n.Jf.colorTransparentStroke,value:"transparent"},{name:n.Jf.colorTransparentStrokeInteractive,value:"transparent"},{name:n.Jf.colorTransparentStrokeDisabled,value:"transparent"},{name:n.Jf.colorNeutralStrokeAlpha,value:"rgba(0, 0, 0, 0.05)"}]},20677:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(83754);const o="--";function i(e){const t=[];e.black&&t.push([n.Ve.black,e.black]),e.white&&t.push([n.Ve.white,e.white]),e.greys&&t.push([n.Ve.neutralDark,e.greys[8]],[n.Ve.neutralPrimary,e.greys[14]],[n.Ve.neutralPrimaryAlt,e.greys[22]],[n.Ve.neutralSecondary,e.greys[36]],[n.Ve.neutralSecondaryAlt,e.greys[52]],[n.Ve.neutralTertiary,e.greys[62]],[n.Ve.neutralTertiaryAlt,e.greys[78]],[n.Ve.neutralQuaternary,e.greys[82]],[n.Ve.neutralQuaternaryAlt,e.greys[88]],[n.Ve.neutralLight,e.greys[92]],[n.Ve.neutralLighter,e.greys[96]],[n.Ve.neutralLighterAlt,e.greys[98]]),e.brandVariants&&t.push([n.Ve.themeDarker,e.brandVariants[40]],[n.Ve.themeDark,e.brandVariants[60]],[n.Ve.themeDarkAlt,e.brandVariants[70]],[n.Ve.themePrimary,e.brandVariants[80]],[n.Ve.themeSecondary,e.brandVariants[90]],[n.Ve.themeTertiary,e.brandVariants[120]],[n.Ve.themeLight,e.brandVariants[140]],[n.Ve.themeLighter,e.brandVariants[150]],[n.Ve.themeLighterAlt,e.brandVariants[160]]),Object.entries(e.fluentThemeV9).forEach((e=>{let[r,n]=e;const i=(s=r,"".concat(o).concat(s));var s;t.push([i,n.toString()])}));const r=[];for(const n of t)r.push({name:n[0],value:n[1]});return r}},85874:(e,t,r)=>{"use strict";r.d(t,{E7:()=>y,Ix:()=>N,LV:()=>s,M6:()=>w,SU:()=>T,e9:()=>S,gX:()=>v,hP:()=>E,jP:()=>C,p3:()=>k,vY:()=>I,y6:()=>b,yg:()=>P});var n=r(48680),o=r(32356);const i="mip.getLabel",s="mip.setLabel",a="mip.getDlp",c="mip.increaseRetries",l="mip.noDefaultOnGet",d="mip.makeVroomCall",u="mip.guestComponentInheritLabel",h="mip.filterUDPLabels",g="mip.fileIdUsedForDlpTip",p="mip.enforceReadOnlyEnabled",m="mip.enforceMandatoryLabelingEnabled",f="mip.canGetLabelIdWithoutTenantFiltering";function v(e){return(0,n.AU)(i,!0,e)}function y(e){return(0,n.AU)(s,!1,e)}function b(e){return(0,n.AU)(a,!0,e)}function S(e){return(0,n.AU)(c,!0,e)}function C(e){return(0,n.AU)(l,!0,e)}function k(e){return(0,n.AU)(d,(0,o.a)("Staging",null===e||void 0===e?void 0:e.audience),e)}function w(e){return(0,n.AU)(u,!1,e)}function P(e){return(0,n.AU)(h,!1,e)}function E(e){return(0,n.AU)(g,!1,e)}function T(e){return(0,n.AU)(p,!1,e)}function I(e){return(0,n.AU)(m,!0,e)}function N(e){return(0,n.AU)(f,!0,e)}},98581:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});const n=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],o=["#DC8990","#DA846B","#ECC26E","#B5CC99","#78C9A0","#85ACB8","#7FA3D0","#CC87B1","#E47CA1","#BF9D8C"],i="--ms-themeColorThemeName",s="dark";class a{get PresenceColorProvider(){return this}get Disposable(){return this.disposable}getColorPaletteForTheme(){var e,t,r;return(null!==(e=null===(t=this.theming)||void 0===t?void 0:t.themeName)&&void 0!==e?e:null===(r=this.theming)||void 0===r||null===(r=r.themeProperties)||void 0===r?void 0:r.get(i))===s?o:n}dispose(){this.Disposable.dispose()}async getPresenceColorForUser(e){const t=this.assignedColors.get(e);if(t)return Promise.resolve(t);if(this.colorAssignmentInFlight.has(e))return new Promise((t=>{this.deferredColorAssignment[e].push(t)}));this.colorAssignmentInFlight.add(e);const r=this.colorPalette[this.nextColorToAssignIndex];if(this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(e,r),this.colorAssignmentInFlight.delete(e),void 0!==this.deferredColorAssignment[e])for(const n of this.deferredColorAssignment[e])n(r);return delete this.deferredColorAssignment[e],Promise.resolve(r)}constructor(e){var t;this.theming=e,this.nextColorToAssignIndex=0,this.colorAssignmentInFlight=new Set,this.deferredColorAssignment={},this.assignedColors=new Map,this.colorPalette=n,this.disposable={get Disposable(){return this},dispose:()=>{this.theming&&this.theming.off("themePropertiesChanged",this.themePropertiesChangedListener),this.colorAssignmentInFlight.clear(),this.assignedColors.clear()}},this.themePropertiesChangedListener=()=>{const e=this.getColorPaletteForTheme();e!==this.colorPalette&&(this.colorPalette=e,this.assignedColors.clear(),this.nextColorToAssignIndex=0)},null===(t=this.theming)||void 0===t||t.on("themePropertiesChanged",this.themePropertiesChangedListener),this.colorPalette=this.getColorPaletteForTheme()}}},75368:(e,t,r)=>{"use strict";r.d(t,{$3:()=>y,A8:()=>k,F3:()=>O,Ft:()=>F,GO:()=>d,HA:()=>n,HY:()=>N,Jv:()=>I,KS:()=>o,MK:()=>B,Ph:()=>s,Py:()=>w,RG:()=>c,Tl:()=>b,UJ:()=>l,Xc:()=>u,Z6:()=>T,_w:()=>D,bG:()=>S,bh:()=>f,fM:()=>m,hL:()=>P,i5:()=>a,j4:()=>i,k4:()=>v,kW:()=>g,kx:()=>h,rf:()=>C,v3:()=>p,xH:()=>E});const n="Card",o="Code",i="Copilot",s="Date",a="Image",c="List",l="Person",d="RichText",u="Tabular",h="Task",g="URL",p="application/vnd.microsoft.card.adaptive",m="application/vnd.microsoft.card.hero",f="application/vnd.microsoft.card.thumbnail",v="application/vnd.microsoft.teams.card.o365connector",y="SignInCard",b="JITInstallCard",S="ErrorCard",C="Label",k="Quote",w="Callout",P="application/vnd.microsoft.activity.loginRequest",E="TokenProvider",T="SettingsProvider",I="CardChannelProvider",N="MetaOSProvider",F="UrlHandlerProvider",D="LinkService",O="OptionalConnectedServicesPolicyProvider",B="OfficePolicyProvider"},24435:(e,t,r)=>{"use strict";r.d(t,{x:()=>xr,p:()=>Br});var n=r(12624),o=r(98418),i=r(43812),s=r(89951),a=r(57406);const c={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let l;const d=new Uint8Array(16);function u(){if(!l&&(l="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!l))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(d)}const h=[];for(let Lr=0;Lr<256;++Lr)h.push((Lr+256).toString(16).slice(1));function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]}const p=function(e,t,r){if(c.randomUUID&&!t&&!e)return c.randomUUID();const n=(e=e||{}).random||(e.rng||u)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return g(n)};var m,f=r(25249),v=r(76078),y=r(72264),b=r(21605);class S{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Map;this.eventBase=e,this.logger=t,this.sampleThreshold=r,this.includeAggregateMetrics=n,this.perBucketProperties=o,this.disposed=!1,this.measurementsMap=new Map}measure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=b.F.now(),n=e(),o=b.F.now()-r;let i=this.measurementsMap.get(t);var s,a,c;(void 0===i&&(i={count:0,duration:-1},this.measurementsMap.set(t,i)),i.count++,i.duration=o,this.includeAggregateMetrics)&&(i.totalDuration=(null!==(s=i.totalDuration)&&void 0!==s?s:0)+o,i.minDuration=Math.min(null!==(a=i.minDuration)&&void 0!==a?a:o,o),i.maxDuration=Math.max(null!==(c=i.maxDuration)&&void 0!==c?c:0,o));return i.count>=this.sampleThreshold&&this.flushBucket(t),n}flushBucket(e){const t=this.measurementsMap.get(e);if(void 0!==t&&0!==t.count){const r=this.perBucketProperties.get(e),n={...this.eventBase,...r,...t};this.logger.sendPerformanceEvent(n),this.measurementsMap.delete(e)}}dispose(e){for(const[t]of this.measurementsMap.entries())this.flushBucket(t)}}!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(m||(m={}));var C=r(38698);const k=e=>"__fluid_handle__"===(null===e||void 0===e?void 0:e.type);var w,P,E=r(60574);!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(w||(w={})),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(P||(P={}));var T=r(58400),I=r(30667);var N,F,D,O=r(60056),B=r(24847);!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(N||(N={})),function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(F||(F={})),function(e){e.default="default",e.noCache="noCache"}(D||(D={}));var x=r(2642);function L(e){if(null!==e&&"object"===typeof e&&!0===e.errorFromRequestFluidObject){const t=e;return{mimeType:"text/plain",status:t.code,value:t.message,get stack(){return t.stack},headers:t.underlyingResponseHeaders}}const t=(0,O.oD)();return{mimeType:"text/plain",status:500,value:"".concat(e),get stack(){var r;return null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:t.stack}}}function A(e,t){const r=e.value,n=(0,O.oD)();return{errorFromRequestFluidObject:!0,message:r,name:"Error",code:e.status,get stack(){var t;return null!==(t=e.stack)&&void 0!==t?t:n.stack},underlyingResponseHeaders:e.headers}}const R=e=>M(404,"not found",e);function M(e,t,r,o){var i;(0,n.v)(200!==e,411);const s=null===(i=r.url)||void 0===i?void 0:i.split("?")[0],a=(0,O.oD)();return{mimeType:"text/plain",status:e,value:void 0===s?t:"".concat(t,": ").concat(s),get stack(){return a.stack},headers:o}}var _=r(28101),z=r(70202),H=r(74086),U=r(83644),j=r(94489);class q{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"utf-8";this.path=e,this.mode=j.S.File,this.type=j.$.Blob,this.value={contents:t,encoding:r}}}class V{constructor(e,t){this.path=e,this.value=t,this.mode=j.S.Directory,this.type=j.$.Tree}}class G{constructor(e,t){this.path=e,this.id=t,this.mode=j.S.File,this.type=j.$.Attachment,this.value={id:t}}}function W(){const e={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0,unreferencedBlobSize:0};for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const o of r)e.treeNodeCount+=o.treeNodeCount,e.blobNodeCount+=o.blobNodeCount,e.handleNodeCount+=o.handleNodeCount,e.totalBlobSize+=o.totalBlobSize,e.unreferencedBlobSize+=o.unreferencedBlobSize;return e}function K(e){return"string"===typeof e?function(e){let t=e.length;for(let r=e.length-1;r>=0;r--){const n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t}(e):e.byteLength}function J(e,t,r){const n={type:x.Z.Blob,content:r};e.summary.tree[t]=n,e.stats.blobNodeCount++,e.stats.totalBlobSize+=K(r)}class Q{get summary(){return{type:x.Z.Tree,tree:{...this.summaryTree}}}get stats(){return{...this.summaryStats}}constructor(){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=W(),this.summaryStats.treeNodeCount++}addBlob(e,t){J({summary:{type:x.Z.Tree,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,r){this.summaryTree[e]={type:x.Z.Handle,handleType:t,handle:r},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=W(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:x.Z.Attachment}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}}function X(e){const t=new Q;for(const[n,o]of Object.entries(e.blobs)){let r;if(void 0!==e.blobsContents){const t=e.blobsContents[o];void 0!==t&&(r=(0,z.JR)(t,"utf-8"))}else void 0!==e.blobs[o]&&(r=(0,H.AH)(e.blobs[o]));void 0!==r&&t.addBlob(n,r)}for(const[n,o]of Object.entries(e.trees)){const e=X(o);t.addWithStats(n,e)}const r=t.getSummaryTree();return r.summary.unreferenced=e.unreferenced,r}function Z(e){const t=[];for(const[r,n]of Object.entries(e.tree))switch(n.type){case x.Z.Blob:{let e,o="utf-8";"string"===typeof n.content?e=n.content:(e=(0,z.Km)(n.content,"base64"),o="base64"),t.push(new q(r,e,o));break}case x.Z.Tree:t.push(new V(r,Z(n)));break;case x.Z.Attachment:t.push(new G(r,n.id));break;case x.Z.Handle:throw new Error("Should not have Handle type in summary tree");default:(0,U.$)(n,"Unexpected summary tree type")}return{entries:t,unreferenced:e.unreferenced}}function $(e,t){const r=null===e||void 0===e?void 0:e.entries.find((e=>".gcdata"===e.path));if(void 0===r)return!1;(0,n.v)(r.type===j.$.Blob&&"utf-8"===r.value.encoding,"GC data should be a utf-8-encoded blob");const o=JSON.parse(r.value.contents);for(const[n,i]of Object.entries(o.gcNodes))i.forEach((e=>{t(n,e)}));return!0}function Y(e){return e.replace(/\/+$/g,"")}class ee{constructor(){this.gcNodesSet={}}get gcNodes(){const e={};for(const[t,r]of Object.entries(this.gcNodesSet))e[t]=[...r];return e}addNode(e,t){this.gcNodesSet[e]=new Set(t)}prefixAndAddNodes(e,t){for(const[r,n]of Object.entries(t)){let t=r.replace(/^\/+/g,"");t="/".concat(e,"/").concat(t),t=Y(t),this.gcNodesSet[t]=new Set(n)}}addNodes(e){for(const[t,r]of Object.entries(e))this.gcNodesSet[t]=new Set(r)}addRouteToAllNodes(e){for(const t of Object.values(this.gcNodesSet))t.add(e)}getGCData(){return{gcNodes:this.gcNodes}}}const te={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let re;const ne=new Uint8Array(16);function oe(){if(!re&&(re="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!re))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return re(ne)}const ie=[];for(let Lr=0;Lr<256;++Lr)ie.push((Lr+256).toString(16).slice(1));function se(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ie[e[t+0]]+ie[e[t+1]]+ie[e[t+2]]+ie[e[t+3]]+"-"+ie[e[t+4]]+ie[e[t+5]]+"-"+ie[e[t+6]]+ie[e[t+7]]+"-"+ie[e[t+8]]+ie[e[t+9]]+"-"+ie[e[t+10]]+ie[e[t+11]]+ie[e[t+12]]+ie[e[t+13]]+ie[e[t+14]]+ie[e[t+15]]}const ae=function(e,t,r){if(te.randomUUID&&!t&&!e)return te.randomUUID();const n=(e=e||{}).random||(e.rng||oe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return se(n)};class ce{get IFluidDataStoreRegistry(){return this}constructor(e){this.map=new Map;for(const t of e){if(this.map.has(t[0]))throw new i.eb("Duplicate entry names exist");this.map.set(t[0],t[1])}}async get(e){if(this.map.has(e))return this.map.get(e)}}function le(e,t){var r;const n=null!==(r=(0,y.Ln)(e).config.getBoolean("Fluid.Telemetry.DisableSampling"))&&void 0!==r&&r;return{send:r=>{(n||void 0===t||t.sample())&&e.send(r)},sendTelemetryEvent:r=>{(n||void 0===t||t.sample())&&e.sendTelemetryEvent(r)},sendErrorEvent:r=>{(n||void 0===t||t.sample())&&e.sendErrorEvent(r)},sendPerformanceEvent:r=>{(n||void 0===t||t.sample())&&e.sendPerformanceEvent(r)},isSamplingDisabled:n}}class de{constructor(e,t,r){this.clientId=e,this.deltaManager=t,this.msnTrackingTimestamp=0,this.latencyStatistics=new Map,this.firstConnection=!0,this.bootTime=b.F.now(),this.connectionStartTime=0,this.gap=0,this.logger=(0,v.pW)({logger:r,namespace:"OpPerf"});const o=(()=>{let e=-1;return{sample:()=>{e++;const t=e%de.DELTA_LATENCY_SAMPLE_RATE===0;return t&&(e=0),t}}})();this.deltaLatencyLogger=le(r,o),this.opLatencyLogger=le(r),this.deltaManager.on("pong",(e=>this.recordPingTime(e))),this.deltaManager.on("submitOp",(e=>this.beforeOpSubmit(e))),this.deltaManager.on("op",(e=>this.afterProcessingOp(e))),this.deltaManager.on("connect",((e,t)=>{this.clientId=e.clientId,void 0!==t&&(this.connectionOpSeqNumber=this.deltaManager.lastKnownSeqNumber,this.gap=t,this.connectionStartTime=b.F.now(),this.gap<=0&&this.reportGettingUpToDate())})),this.deltaManager.on("disconnect",(()=>{this.sequenceNumberForMsnTracking=void 0,this.clientSequenceNumberForLatencyStatistics=void 0,this.connectionOpSeqNumber=void 0,this.firstConnection=!1,this.latencyStatistics.clear()})),this.deltaManager.outbound.on("push",(e=>{for(const t of e)if(t.type===a.Go.Operation&&(this.opLatencyLogger.isSamplingDisabled||this.clientSequenceNumberForLatencyStatistics===t.clientSequenceNumber)){const e=this.latencyStatistics.get(t.clientSequenceNumber);(0,n.v)(void 0!==e,1986),(0,n.v)(void 0===e.opProcessingTimes.outboundPushEventTime,712),(0,n.v)(void 0===e.opPerfData.durationNetwork,713),e.opProcessingTimes.outboundPushEventTime=Date.now(),(0,n.v)(void 0===e.opPerfData.durationOutboundBatching,714),(0,n.v)(void 0!==e.opProcessingTimes.submitOpEventTime,715),e.opPerfData.durationOutboundBatching=e.opProcessingTimes.outboundPushEventTime-e.opProcessingTimes.submitOpEventTime}})),this.deltaManager.inbound.on("push",(e=>{if(this.clientId===e.clientId&&e.type===a.Go.Operation&&(this.opLatencyLogger.isSamplingDisabled||this.clientSequenceNumberForLatencyStatistics===e.clientSequenceNumber)){const t=this.latencyStatistics.get(e.clientSequenceNumber);(0,n.v)(void 0!==t,1987),void 0!==t.opProcessingTimes.outboundPushEventTime&&(t.opProcessingTimes.inboundPushEventTime=Date.now(),t.opPerfData.durationNetwork=t.opProcessingTimes.inboundPushEventTime-t.opProcessingTimes.outboundPushEventTime,t.opPerfData.lengthInboundQueue=this.deltaManager.inbound.length)}})),this.deltaManager.inbound.on("idle",((e,t)=>{"number"===typeof e&&e>=100&&this.logger.sendPerformanceEvent({eventName:"GetDeltas_OpProcessing",count:e,duration:t})}))}reportGettingUpToDate(){this.connectionOpSeqNumber=void 0,this.logger.sendPerformanceEvent({eventName:"ConnectionSpeed",duration:b.F.now()-this.connectionStartTime,ops:this.gap,timeToConnect:this.firstConnection?(0,v.T0)(this.connectionStartTime-this.bootTime):void 0,firstConnection:this.firstConnection})}recordPingTime(e){this.pingLatency=e,e>6e4&&this.logger.sendErrorEvent({eventName:"LatencyTooLong",duration:e}),this.deltaManager.active&&this.deltaLatencyLogger.sendPerformanceEvent({eventName:"DeltaLatency",duration:e})}beforeOpSubmit(e){(this.opLatencyLogger.isSamplingDisabled||void 0===this.clientSequenceNumberForLatencyStatistics&&e.clientSequenceNumber%de.OP_LATENCY_SAMPLE_RATE===1)&&((0,n.v)(void 0===this.latencyStatistics.get(e.clientSequenceNumber),1988),this.clientSequenceNumberForLatencyStatistics=e.clientSequenceNumber,this.latencyStatistics.set(e.clientSequenceNumber,{opProcessingTimes:{submitOpEventTime:Date.now()},opPerfData:{}}))}afterProcessingOp(e){const t=e.sequenceNumber;if(t===this.connectionOpSeqNumber&&this.reportGettingUpToDate(),void 0===this.sequenceNumberForMsnTracking&&t%1e3===0&&(this.sequenceNumberForMsnTracking=t,this.msnTrackingTimestamp=e.timestamp),void 0!==this.sequenceNumberForMsnTracking&&e.minimumSequenceNumber>=this.sequenceNumberForMsnTracking&&((0,n.v)(void 0!==this.msnTrackingTimestamp,718),this.logger.sendPerformanceEvent({eventName:"MsnStatistics",sequenceNumber:t,msnDistance:t-this.sequenceNumberForMsnTracking,duration:e.timestamp-this.msnTrackingTimestamp}),this.sequenceNumberForMsnTracking=void 0),this.clientId===e.clientId&&(this.opLatencyLogger.isSamplingDisabled||this.clientSequenceNumberForLatencyStatistics===e.clientSequenceNumber)){const r=this.latencyStatistics.get(e.clientSequenceNumber);(0,n.v)(void 0!==r,1989),(0,n.v)(void 0!==r.opProcessingTimes.submitOpEventTime,288);const o=Date.now();void 0!==r.opProcessingTimes.inboundPushEventTime&&(r.opPerfData.durationInboundToProcessing=o-r.opProcessingTimes.inboundPushEventTime);const i=o-r.opProcessingTimes.submitOpEventTime,s=i>5e3?"error":"performance";this.opLatencyLogger.sendPerformanceEvent({eventName:"OpRoundtripTime",sequenceNumber:t,referenceSequenceNumber:e.referenceSequenceNumber,duration:i,category:s,pingLatency:this.pingLatency,msnDistance:this.deltaManager.lastSequenceNumber-this.deltaManager.minimumSequenceNumber,...r.opPerfData}),this.clientSequenceNumberForLatencyStatistics=void 0,this.latencyStatistics.delete(e.clientSequenceNumber)}}}de.OP_LATENCY_SAMPLE_RATE=500,de.DELTA_LATENCY_SAMPLE_RATE=100;r(71724);var ue=r(24356),he=r(84792),ge=r(19307);class pe{get IFluidHandle(){return this}get isAttached(){return this.routeContext.isAttached&&this.attached}constructor(e,t,r,n){this.path=e,this.routeContext=t,this.get=r,this.onAttachGraph=n,this.attached=!1,this.absolutePath=(0,E.a)(e,this.routeContext)}attachGraph(){var e;this.attached||(this.attached=!0,null===(e=this.onAttachGraph)||void 0===e||e.call(this))}bind(e){throw new Error("Cannot bind to blob handle")}}class me extends o.X{constructor(e,t,r,o,s,a,c){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},d=arguments.length>8?arguments[8]:void 0;super(),this.routeContext=e,this.getStorage=r,this.blobRequested=s,this.isBlobDeleted=a,this.runtime=c,this.closeContainer=d,this.pendingBlobs=new Map,this.opsInFlight=new Map,this.tombstonedBlobs=new Set,this.stopAttaching=!1,this.mc=(0,y.CL)({logger:this.runtime.logger,namespace:"BlobManager"}),this.redirectTable=this.load(t),Object.entries(l).forEach((e=>{let[t,r]=e;const n=(0,z.Xg)(r.blob,"base64"),o=r.attached,i=r.acked,s=r.storageId;if(r.minTTLInSeconds&&r.uploadTime){const e=(Date.now()-r.uploadTime)/1e3;if(r.minTTLInSeconds-e>r.minTTLInSeconds/2)return void this.pendingBlobs.set(t,{blob:n,uploading:!1,opsent:!0,handleP:new ue.c,storageId:s,uploadP:void 0,uploadTime:r.uploadTime,minTTLInSeconds:r.minTTLInSeconds,attached:o,acked:i})}this.pendingBlobs.set(t,{blob:n,uploading:!0,handleP:new ue.c,uploadP:this.uploadBlob(t,n),attached:o,acked:i,opsent:!0,pendingStashed:!0})})),this.sendBlobAttachOp=(e,t)=>{const r=this.pendingBlobs.get(e);if((0,n.v)(void 0!==r,1829),null!==r&&void 0!==r&&r.uploadTime&&null!==r&&void 0!==r&&r.minTTLInSeconds){const n=(Date.now()-r.uploadTime)/1e3,o=r.minTTLInSeconds-n<0;this.mc.logger.sendTelemetryEvent({eventName:"sendBlobAttach",secondsSinceUpload:n,minTTLInSeconds:r.minTTLInSeconds,expired:o}),o&&this.closeContainer(new i.gn("Trying to submit a BlobAttach for expired blob",void 0,{localId:e,blobId:t,secondsSinceUpload:n}))}return r.opsent=!0,o(e,t)}}get allBlobsAttached(){for(const[,e]of this.pendingBlobs)if(!1===e.attached)return!1;return!0}get hasPendingBlobs(){return this.runtime.attachState!==P.Attached&&this.redirectTable.size>0||this.pendingBlobs.size>0}createAbortError(e){return new O.iq("uploadBlob aborted",{acked:null===e||void 0===e?void 0:e.acked,uploadTime:null===e||void 0===e?void 0:e.uploadTime})}hasPendingStashedBlobs(){return Array.from(this.pendingBlobs.values()).some((e=>!0===e.pendingStashed))}async processStashedChanges(){const e=Array.from(this.pendingBlobs.values()).filter((e=>!0===e.pendingStashed)).map((async e=>e.uploadP));await v.Bt.timedExecAsync(this.mc.logger,{eventName:"BlobUploadProcessStashedChanges",count:e.length},(async()=>Promise.all(e)),{start:!0,end:!0})}get storageIds(){const e=new Set(this.redirectTable.values()),t=e.delete(void 0);return(0,n.v)(!t||this.runtime.attachState===P.Detached&&0===e.size,898),e}async getBlob(e){this.verifyBlobNotDeleted(e),this.blobRequested(fe(e));const t=this.pendingBlobs.get(e);if(t)return t.blob;let r;if(this.runtime.attachState===P.Detached)(0,n.v)(this.redirectTable.has(e),899),r=e;else{const t=this.redirectTable.get(e);(0,n.v)(!!t,287),r=t}return v.Bt.timedExecAsync(this.mc.logger,{eventName:"AttachmentReadBlob",id:r},(async()=>this.getStorage().readBlob(r)),{end:!0,cancel:"error"})}getBlobHandle(e){(0,n.v)(this.redirectTable.has(e)||this.pendingBlobs.has(e),900);const t=this.pendingBlobs.get(e),r=t?()=>{t.attached=!0,this.emit("blobAttached",t),this.deletePendingBlobMaybe(e)}:void 0;return new pe("".concat(me.basePath,"/").concat(e),this.routeContext,(async()=>this.getBlob(e)),r)}async createBlobDetached(e){const t=await this.getStorage().createBlob(e);return this.setRedirection(t.id,void 0),this.getBlobHandle(t.id)}async createBlob(e,t){if(this.runtime.attachState===P.Detached)return this.createBlobDetached(e);if(this.runtime.attachState===P.Attaching&&(this.mc.logger.sendTelemetryEvent({eventName:"CreateBlobWhileAttaching"}),await new Promise((e=>this.runtime.once("attached",e)))),(0,n.v)(this.runtime.attachState===P.Attached,901),null!==t&&void 0!==t&&t.aborted)throw this.createAbortError();const r=ae(),o={blob:e,uploading:!0,handleP:new ue.c,uploadP:this.uploadBlob(r,e),attached:!1,acked:!1,abortSignal:t,opsent:!1};this.pendingBlobs.set(r,o);const i=()=>{o.acked||o.handleP.reject(this.createAbortError(o))};return null===t||void 0===t||t.addEventListener("abort",i,{once:!0}),o.handleP.promise.finally((()=>{null===t||void 0===t||t.removeEventListener("abort",i)}))}async uploadBlob(e,t){var r;return(0,he.M)((async()=>{try{return await this.getStorage().createBlob(t)}catch(r){const t=this.pendingBlobs.get(e);if((0,n.v)(!!t,903),t.opsent&&!(0,ge.YU)(r))throw(0,O.J4)(r,(()=>new O.iq("uploadBlob error",{canRetry:!0})));throw r}}),"createBlob",this.mc.logger,{cancel:null===(r=this.pendingBlobs.get(e))||void 0===r?void 0:r.abortSignal}).then((t=>this.onUploadResolve(e,t)),(t=>{var r;null===(r=this.pendingBlobs.get(e))||void 0===r||r.handleP.reject(t),this.deletePendingBlob(e)}))}setRedirection(e,t){this.redirectTable.set(e,t)}deletePendingBlobMaybe(e){if(this.pendingBlobs.has(e)){const t=this.pendingBlobs.get(e);null!==t&&void 0!==t&&t.attached&&null!==t&&void 0!==t&&t.acked&&this.deletePendingBlob(e)}}deletePendingBlob(e){this.pendingBlobs.delete(e)&&!this.hasPendingBlobs&&this.emit("noPendingBlobs")}onUploadResolve(e,t){var r;const o=this.pendingBlobs.get(e);if((0,n.v)(void 0!==o,1736),(!0!==(null===(r=o.abortSignal)||void 0===r?void 0:r.aborted)||o.opsent)&&!this.stopAttaching){var i;if((0,n.v)(!0===o.uploading,902),o.storageId=t.id,o.uploadTime=Date.now(),o.minTTLInSeconds=t.minTTLInSeconds,o.opsent||this.sendBlobAttachOp(e,t.id),this.storageIds.has(t.id))this.setRedirection(e,t.id),o.handleP.resolve(this.getBlobHandle(e)),this.deletePendingBlobMaybe(e);else this.opsInFlight.set(t.id,(null!==(i=this.opsInFlight.get(t.id))&&void 0!==i?i:[]).concat(e));return t}this.deletePendingBlob(e)}reSubmit(e){(0,n.v)(!!e,907);const{localId:t,blobId:r}=e;(0,n.v)(void 0!==t,1293);const o=this.pendingBlobs.get(t);return r?this.sendBlobAttachOp(t,r):((0,n.v)(!0===(null===o||void 0===o?void 0:o.opsent)&&!(null===o||void 0===o||!o.storageId),909),this.sendBlobAttachOp(t,null===o||void 0===o?void 0:o.storageId))}processBlobAttachOp(e,t){var r,o;const i=null===(r=e.metadata)||void 0===r?void 0:r.localId,s=null===(o=e.metadata)||void 0===o?void 0:o.blobId;if(i){var a;const e=this.pendingBlobs.get(i);if(null!==e&&void 0!==e&&null!==(a=e.abortSignal)&&void 0!==a&&a.aborted)return void this.deletePendingBlob(i);null!==e&&void 0!==e&&e.pendingStashed&&(e.pendingStashed=!1)}if((0,n.v)(void 0!==s,298),void 0!==i&&this.setRedirection(i,s),this.setRedirection(s,s),t){(0,n.v)(void 0!==i,1294);const e=this.opsInFlight.get(s);void 0!==e&&(e.forEach((e=>{const t=this.pendingBlobs.get(e);(0,n.v)(void 0!==t,911),this.setRedirection(e,s),t.acked=!0,t.handleP.resolve(this.getBlobHandle(e)),this.deletePendingBlobMaybe(e)})),this.opsInFlight.delete(s));const t=this.pendingBlobs.get(i);t&&(t.acked=!0,t.handleP.resolve(this.getBlobHandle(i)),this.deletePendingBlobMaybe(i))}}static async load(e,t){if(!e)return{};let r;const n=e.blobs[this.redirectTableBlobName];n&&(r=await t(n));return{ids:Object.entries(e.blobs).filter((e=>{let[t,r]=e;return t!==this.redirectTableBlobName})).map((e=>{let[t,r]=e;return r})),redirectTable:r}}load(e){var t,r,n;this.mc.logger.sendTelemetryEvent({eventName:"AttachmentBlobsLoaded",count:null!==(t=null===(r=e.ids)||void 0===r?void 0:r.length)&&void 0!==t?t:0,redirectTable:null===(n=e.redirectTable)||void 0===n?void 0:n.length});const o=new Map(e.redirectTable);if(e.ids){const t=this.runtime.attachState===P.Detached;e.ids.forEach((e=>o.set(e,t?void 0:e)))}return o}summarize(e){const t=this.storageIds.size>0?Array.from(this.storageIds):Array.from(this.redirectTable.keys()),r=new Q;return t.forEach((e=>{r.addAttachment(e)})),this.redirectTable.size>t.length&&r.addBlob(me.redirectTableBlobName,JSON.stringify(Array.from(this.redirectTable.entries()).filter((e=>{let[t,r]=e;return t!==r})))),r.getSummaryTree()}getGCData(){const e={gcNodes:{}};for(const[t,r]of this.redirectTable)(0,n.v)(!!r,912),t!==r&&(e.gcNodes[fe(t)]=[]);return e}updateUnusedRoutes(e){this.deleteBlobsFromRedirectTable(e)}deleteSweepReadyNodes(e){return this.deleteBlobsFromRedirectTable(e),Array.from(e)}deleteBlobsFromRedirectTable(e){if(0===e.length)return;const t=new Set;for(const r of e){const e=ve(r),o=this.isBlobDeleted(r);if(!this.redirectTable.has(e)){this.mc.logger.sendTelemetryEvent({eventName:"DeletedAttachmentBlobNotFound",category:o?"generic":"error",blobId:e,details:{alreadyDeleted:o}});continue}const i=this.redirectTable.get(e);(0,n.v)(!!i,1467),t.add(i),this.redirectTable.delete(e)}for(const[r,o]of this.redirectTable.entries())(0,n.v)(!!o,1468),t.has(o)&&r!==o&&t.delete(o);for(const r of t)this.redirectTable.delete(r)}updateTombstonedRoutes(e){const t=new Set;for(const r of e){const e=ve(r);t.add(e)}for(const r of this.tombstonedBlobs)t.has(r)||this.tombstonedBlobs.delete(r);for(const r of t)this.tombstonedBlobs.add(r)}verifyBlobNotDeleted(e){if(!this.isBlobDeleted(fe(e)))return;const t={url:e},r=A(M(404,"Blob was deleted",t));throw this.mc.logger.sendErrorEvent({eventName:"GC_Deleted_Blob_Requested",pkg:me.basePath},r),r}setRedirectTable(e){(0,n.v)(this.runtime.attachState===P.Detached,594),(0,n.v)(this.redirectTable.size===e.size,913);for(const[t,r]of e)(0,n.v)(this.redirectTable.has(t),596),this.setRedirection(t,r),this.setRedirection(r,r)}async attachAndGetPendingBlobs(e){return v.Bt.timedExecAsync(this.mc.logger,{eventName:"GetPendingBlobs"},(async()=>{if(0===this.pendingBlobs.size)return;const t={},r=new Set;for(;r.size<this.pendingBlobs.size;){const t=[];for(const[n,o]of this.pendingBlobs)r.has(o)||(r.add(o),o.handleP.resolve(this.getBlobHandle(n)),t.push(new Promise(((t,r)=>{null===e||void 0===e||e.addEventListener("abort",(()=>{this.stopAttaching=!0,r(new Error("Operation aborted"))}),{once:!0});const n=e=>{e===o&&(this.off("blobAttached",n),t())};o.attached?t():this.on("blobAttached",n)}))));await Promise.allSettled(t).catch((()=>{}))}for(const[o,i]of this.pendingBlobs)null===e||void 0===e||!e.aborted||i.attached?((0,n.v)(!0===i.attached,1936),i.opsent||this.sendBlobAttachOp(o,i.storageId),t[o]={blob:(0,z.JR)(i.blob,"base64"),storageId:i.storageId,attached:i.attached,acked:i.acked,minTTLInSeconds:i.minTTLInSeconds,uploadTime:i.uploadTime}):this.mc.logger.sendTelemetryEvent({eventName:"UnableToStashBlob",id:o});return Object.keys(t).length>0?t:void 0}))}}function fe(e){return"/".concat(me.basePath,"/").concat(e)}function ve(e){const t=e.split("/");return(0,n.v)(3===t.length&&t[1]===me.basePath,1469),t[2]}me.basePath="_blobs",me.redirectTableBlobName=".redirectTable";var ye=r(92166);function be(e){const t=e.filter((e=>""!==e&&"/"!==e)),r=new Map;for(const o of t){(0,n.v)(o.startsWith("/"),1504);const e=o.split("/")[1],t=o.slice(e.length+1),i=r.get(e);void 0!==i?i.push(t):r.set(e,[t])}return r}var Se=r(57320);Symbol.iterator;class Ce{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.threshold=e,this.logger=t,this.thresholdMultiple=r}send(e,t){t<this.threshold||this.logger.sendPerformanceEvent({eventName:e,value:t})}sendIfMultiple(e,t){t===this.thresholdMultiple&&(this.logger.sendPerformanceEvent({eventName:e,value:t}),this.thresholdMultiple=2*this.thresholdMultiple)}}const ke=".blobs",we=".idCompressor";C.aT;const Pe=".component";function Ee(e){e.summary={type:x.Z.Tree,tree:{[C._1]:e.summary}},e.stats.treeNodeCount++}const Te="summarizer";class Ie extends o.X{get electedClientId(){var e;return null===(e=this.clientElection.electedClient)||void 0===e?void 0:e.clientId}get electedParentId(){var e;return null===(e=this.clientElection.electedParent)||void 0===e?void 0:e.clientId}constructor(e,t,r,n){super(),this.logger=e,this.summaryCollection=t,this.clientElection=r,this.maxOpsSinceLastSummary=n,this.lastReportedSeq=0,this.summaryCollection.on("default",(e=>{var t;let{sequenceNumber:r}=e;const n=this.electedClientId;if(void 0===n)return void(this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(r));const o=this.clientElection.electionSequenceNumber;if(r-(null!==(t=this.lastSummaryAckSeqForClient)&&void 0!==t?t:o)>this.maxOpsSinceLastSummary){var i;if(r-this.lastReportedSeq>this.maxOpsSinceLastSummary)this.logger.sendTelemetryEvent({eventName:"ElectedClientNotSummarizing",electedClientId:n,lastSummaryAckSeqForClient:this.lastSummaryAckSeqForClient,electionSequenceNumber:o,nextElectedClientId:null===(i=this.clientElection.peekNextElectedClient())||void 0===i?void 0:i.clientId}),this.lastReportedSeq=r}})),this.summaryCollection.on(a.Go.SummaryAck,(e=>{this.lastSummaryAckSeqForClient=e.sequenceNumber})),this.clientElection.on("election",((e,t)=>{this.lastSummaryAckSeqForClient=void 0,void 0===e&&this.clientElection.eligibleCount>0&&this.clientElection.resetElectedClient(t),this.emit("electedSummarizerChanged")}))}serialize(){var e;const{electedClientId:t,electedParentId:r,electionSequenceNumber:n}=this.clientElection.serialize();return{electedClientId:t,electedParentId:r,electionSequenceNumber:null!==(e=this.lastSummaryAckSeqForClient)&&void 0!==e?e:n}}static isClientEligible(e){const t=e.client.details;return void 0===t||Ie.clientDetailsPermitElection(t)}}Ie.clientDetailsPermitElection=e=>e.capabilities.interactive||e.type===Te;const Ne="Fluid.GarbageCollection.RunSweep",Fe="Fluid.GarbageCollection.DisableTombstone",De="Fluid.GarbageCollection.ThrowOnTombstoneLoadOverride",Oe="Fluid.GarbageCollection.ThrowOnTombstoneUsage",Be="Fluid.GarbageCollection.DetectOutboundRoutesViaDDS";function xe(e,t,r,n){var o;t.pkg=null===(o=(0,v.Df)({pkg:null===r||void 0===r?void 0:r.join("/")}))||void 0===o?void 0:o.pkg,t.tombstoneFlags=JSON.stringify({DisableTombstone:e.config.getBoolean(Fe),ThrowOnTombstoneUsage:e.config.getBoolean(Oe),ThrowOnTombstoneLoad:e.config.getBoolean(De)}),t.sweepFlags=JSON.stringify({EnableSweepFlag:e.config.getBoolean(Ne)}),e.logger.sendTelemetryEvent(t,n)}function Le(e,t){return{pkg:JSON.stringify(e),summaryFormatVersion:2,isRootDataStore:t}}class Ae extends o.X{get packagePath(){return(0,n.v)(void 0!==this.pkg,313),this.pkg}get options(){return this._containerRuntime.options}get clientId(){return this._containerRuntime.clientId}get clientDetails(){return this._containerRuntime.clientDetails}get logger(){return this._containerRuntime.logger}get deltaManager(){return this._containerRuntime.deltaManager}get connected(){return this._containerRuntime.connected}get IFluidHandleContext(){return this._containerRuntime.IFluidHandleContext}get containerRuntime(){return this._containerRuntime}ensureNoDataModelChanges(e){return this._containerRuntime.ensureNoDataModelChanges(e)}get isLoaded(){return this.loaded}get baseSnapshot(){return this._baseSnapshot}get idCompressor(){return this._containerRuntime.idCompressor}get disposed(){return this._disposed}get tombstoned(){return this._tombstoned}get attachState(){return this._attachState}get IFluidDataStoreRegistry(){return this.registry}async isRoot(){return this.isInMemoryRoot()||(await this.getInitialSnapshotDetails()).isRootDataStore}isInMemoryRoot(){return this._isInMemoryRoot}constructor(e,t,r,o){var i;super(),this.existing=t,this.isLocalDataStore=r,this.makeLocallyVisibleFn=o,this._disposed=!1,this._tombstoned=!1,this.deleted=!1,this.detachedRuntimeCreation=!1,this.loaded=!1,this.pending=[],this._isInMemoryRoot=!1,this._containerRuntime=e.runtime,this.id=e.id,this.storage=e.storage,this.scope=e.scope,this.pkg=e.pkg,(0,n.v)(!this.id.includes("/"),314),this._attachState=this.containerRuntime.attachState!==P.Detached&&this.existing?this.containerRuntime.attachState:P.Detached;this.summarizerNode=e.createSummarizerNodeFn((async(e,t,r)=>this.summarizeInternal(e,t,r)),(async e=>this.getGCDataInternal(e))),this.mc=(0,y.CL)({logger:this.logger,namespace:"FluidDataStoreContext",properties:{all:(0,v.Df)({fluidDataStoreId:this.id,fullPackageName:()=>{var e;return null===(e=this.pkg)||void 0===e?void 0:e.join("/")}})}}),this.thresholdOpsCounter=new Ce(Ae.pendingOpsCountThreshold,this.mc.logger),this.throwOnTombstoneUsage=this._containerRuntime.gcThrowOnTombstoneUsage,this.localChangesTelemetryCount=null!==(i=this.mc.config.getNumber("Fluid.Telemetry.LocalChangesTelemetryCount"))&&void 0!==i?i:10}dispose(){this._disposed||(this._disposed=!0,this.channelDeferred&&this.channelDeferred.promise.then((e=>{e.dispose()})).catch((e=>{})))}delete(){this.deleted=!0}setTombstone(e){this.tombstoned!==e&&(this._tombstoned=e)}rejectDeferredRealize(e,t,r){throw new O.iq(e,(0,v.Df)({failedPkgPath:t,packagePath:null===r||void 0===r?void 0:r.join("/")}))}async realize(){return(0,n.v)(!this.detachedRuntimeCreation,317),this.channelDeferred||(this.channelDeferred=new ue.c,this.realizeCore(this.existing).catch((e=>{var t,r;const n=i.I9.wrapIfUnrecognized(e,"realizeFluidDataStoreContext");n.addTelemetryProperties((0,v.Df)({fullPackageName:null===(t=this.pkg)||void 0===t?void 0:t.join("/"),fluidDataStoreId:this.id})),null===(r=this.channelDeferred)||void 0===r||r.reject(n),this.mc.logger.sendErrorEvent({eventName:"RealizeError"},n)}))),this.channelDeferred.promise}async factoryFromPackagePath(e){var t;let r;(0,n.v)(this.pkg===e,318),void 0===e&&this.rejectDeferredRealize("packages is undefined");let o,i=this._containerRuntime.IFluidDataStoreRegistry;for(const n of e)i||this.rejectDeferredRealize("No registry for package",o,e),o=n,r=await i.get(n),r||this.rejectDeferredRealize("Registry does not contain entry for the package",n,e),i=r.IFluidDataStoreRegistry;const s=null===(t=r)||void 0===t?void 0:t.IFluidDataStoreFactory;return void 0===s&&this.rejectDeferredRealize("Can't find factory for package",o,e),{factory:s,registry:i}}async realizeCore(e){const t=await this.getInitialSnapshotDetails();this._baseSnapshot=t.snapshot;const r=t.pkg,{factory:o,registry:i}=await this.factoryFromPackagePath(r);(0,n.v)(void 0===this.registry,319),this.registry=i;const s=await o.instantiateDataStore(this,e);(0,n.v)(void 0!==s,320),this.bindRuntime(s),this.disposed&&s.dispose()}setConnectionState(e,t){this.verifyNotClosed("setConnectionState",!1),this.loaded&&((0,n.v)(this.connected===e,321),this.channel.setConnectionState(e,t))}process(e,t,r){const o=(0,i.ds)(e);if(this.verifyNotClosed("process",!1,o),this.tombstoned&&this.throwOnTombstoneUsage)throw new i.EW("Context is tombstoned! Call site [process]",o);const s=e.contents,a={...e,type:s.type,contents:s.content};var c;if(this.summarizerNode.recordChange(a),this.loaded)return null===(c=this.channel)||void 0===c?void 0:c.process(a,t,r);(0,n.v)(!t,322),(0,n.v)(void 0!==this.pending,573),this.pending.push(a),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length)}processSignal(e,t){var r;this.verifyNotClosed("processSignal"),this.loaded&&(null===(r=this.channel)||void 0===r||r.processSignal(e,t))}getQuorum(){return this._containerRuntime.getQuorum()}getAudience(){return this._containerRuntime.getAudience()}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return this.summarizerNode.summarize(e,t,r)}async summarizeInternal(e,t,r){await this.realize();const n=await this.channel.summarize(e,t,r);Ee(n);const o=[C._1],{pkg:i}=await this.getInitialSnapshotDetails(),s=Le(i,await this.isRoot());return J(n,Pe,JSON.stringify(s)),this.summarizerNode.isReferenced()||(n.summary.unreferenced=!0,n.stats.unreferencedBlobSize=n.stats.totalBlobSize),{...n,id:this.id,pathPartsForChildren:o}}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.summarizerNode.getGCData(e)}async getGCDataInternal(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return await this.realize(),(0,n.v)(void 0!==this.channel,323),this.channel.getGCData(e)}updateUsedRoutes(e){this.summarizerNode.updateUsedRoutes(e),this.lastUsedRoutes=e,this.loaded&&this.updateChannelUsedRoutes()}addedGCOutboundReference(e,t){!0===this.mc.config.getBoolean(Be)&&this._containerRuntime.addedGCOutboundReference(e,t)}addedGCOutboundRoute(e,t){this._containerRuntime.addedGCOutboundReference({absolutePath:e},{absolutePath:t})}updateChannelUsedRoutes(){if((0,n.v)(this.loaded,324),(0,n.v)(void 0!==this.channel,325),void 0===this.lastUsedRoutes)return;const e=this.lastUsedRoutes.filter((e=>"/"!==e&&""!==e));this.channel.updateUsedRoutes(e)}async request(e){return(await this.realize()).request(e)}submitMessage(e,t,r){this.verifyNotClosed("submitMessage"),(0,n.v)(!!this.channel,326);const o={content:t,type:e};this.identifyLocalChangeInSummarizer("DataStoreMessageSubmittedInSummarizer",e),this._containerRuntime.submitDataStoreOp(this.id,o,r)}setChannelDirty(e){this.verifyNotClosed("setChannelDirty");const t=this.deltaManager.lastSequenceNumber;this.summarizerNode.invalidate(t);const r=this.summarizerNode.getChild(e);r&&r.invalidate(t)}submitSignal(e,t,r){return this.verifyNotClosed("submitSignal"),(0,n.v)(!!this.channel,327),this._containerRuntime.submitDataStoreSignal(this.id,e,t,r)}makeLocallyVisible(){(0,n.v)(void 0!==this.channel,719),(0,n.v)(this.channel.visibilityState===C.cy.LocallyVisible,1424),this.makeLocallyVisibleFn()}bindRuntime(e){if(this.channel)throw new Error("Runtime already bound");try{(0,n.v)(!this.detachedRuntimeCreation,328),(0,n.v)(void 0!==this.channelDeferred,329),(0,n.v)(void 0!==this.pkg,330);const t=this.pending;for(const r of t)e.process(r,!1,void 0);this.thresholdOpsCounter.send("ProcessPendingOps",t.length),this.pending=void 0,this.loaded=!0,this.channel=e,Object.freeze(this.pkg),this.updateChannelUsedRoutes(),this.channelDeferred.resolve(this.channel)}catch(r){var t;null===(t=this.channelDeferred)||void 0===t||t.reject(r),this.mc.logger.sendErrorEvent({eventName:"BindRuntimeError"},r)}}async getAbsoluteUrl(e){if(this.attachState===P.Attached)return this._containerRuntime.getAbsoluteUrl(e)}setInMemoryRoot(){this._isInMemoryRoot=!0}async getBaseGCDetails(){return{}}reSubmit(e,t){(0,n.v)(!!this.channel,331);const r=e;this.channel.reSubmit(r.type,r.content,t)}rollback(e,t){if(!this.channel)throw new Error("Channel must exist when rolling back ops");if(!this.channel.rollback)throw new Error("Channel doesn't support rollback");const r=e;this.channel.rollback(r.type,r.content,t)}async applyStashedOp(e){return this.channel||await this.realize(),(0,n.v)(!!this.channel,332),this.channel.applyStashedOp(e)}verifyNotClosed(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.deleted){const t="Context is deleted! Call site [".concat(e,"]"),n=new i.EW(t,r);throw this.mc.logger.sendErrorEvent({eventName:"GC_Deleted_DataStore_Changed",callSite:e},n),n}if(this._disposed)throw new Error("Context is closed! Call site [".concat(e,"]"));if(t&&this.tombstoned){const t="Context is tombstoned! Call site [".concat(e,"]"),n=new i.EW(t,r);if(xe(this.mc,{eventName:"GC_Tombstone_DataStore_Changed",category:this.throwOnTombstoneUsage?"error":"generic",gcTombstoneEnforcementAllowed:this._containerRuntime.gcTombstoneEnforcementAllowed,callSite:e},this.pkg,n),this.throwOnTombstoneUsage)throw n}}identifyLocalChangeInSummarizer(e,t){var r,n;this.clientDetails.type!==Te||this.localChangesTelemetryCount<=0||(this.mc.logger.sendTelemetryEvent({eventName:e,type:t,isSummaryInProgress:null===(r=(n=this.summarizerNode).isSummaryInProgress)||void 0===r?void 0:r.call(n),stack:(0,O.aX)()}),this.localChangesTelemetryCount--)}getCreateChildSummarizerNodeFn(e,t){return(r,n)=>this.summarizerNode.createChild(r,e,t,{throwOnFailure:!0},n)}async uploadBlob(e,t){return this.containerRuntime.uploadBlob(e,t)}}Ae.pendingOpsCountThreshold=1e3;var Re;!function(e){e.Aliased="Aliased",e.Aliasing="Aliasing",e.None="None"}(Re||(Re={}));var Me;!function(e){e[e.Local=0]="Local",e[e.Broadcast=1]="Broadcast",e[e.Acked=2]="Acked",e[e.Nacked=-1]="Nacked"}(Me||(Me={}));o.X;o.X;o.X;var _e=r(33941),ze=r(6501);const He={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},{dataCorruptionError:Ue,dataProcessingError:je,...qe}=He,Ve={...qe,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var Ge;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(Ge||(Ge={}));const We=e=>void 0!==e.data;class Ke{get lastAttempt(){return this._lastAttempt}get lastSuccessfulSummary(){return this._lastSuccessfulSummary}get opsSinceLastSummary(){return this.numNonRuntimeOpsBefore+this.numRuntimeOpsBefore}constructor(e,t){this.lastOpSequenceNumber=e,this.hasMissingOpData=!1,this.totalOpsSize=0,this.totalOpsSizeBefore=0,this.numNonRuntimeOps=0,this.numNonRuntimeOpsBefore=0,this.numRuntimeOps=0,this.numRuntimeOpsBefore=0,this._lastAttempt=t,this._lastSuccessfulSummary={...t}}updateWithLastSummaryAckInfo(e){this._lastAttempt=e,this._lastSuccessfulSummary={...e}}recordAttempt(e){this._lastAttempt={refSequenceNumber:null!==e&&void 0!==e?e:this.lastOpSequenceNumber,summaryTime:Date.now()},this.numNonRuntimeOpsBefore=this.numNonRuntimeOps,this.numRuntimeOpsBefore=this.numRuntimeOps,this.totalOpsSizeBefore=this.totalOpsSize}markLastAttemptAsSuccessful(){this._lastSuccessfulSummary={...this.lastAttempt},this.numNonRuntimeOps-=this.numNonRuntimeOpsBefore,this.numNonRuntimeOpsBefore=0,this.numRuntimeOps-=this.numRuntimeOpsBefore,this.numRuntimeOpsBefore=0,this.totalOpsSize-=this.totalOpsSizeBefore,this.totalOpsSizeBefore=0}}class Je{constructor(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[new Qe,new Ze];this.heuristicData=e,this.configuration=t,this.logger=n,this.summarizeStrategies=o,this.idleTimer=new ze.M4(this.idleTime,(()=>this.runSummarize("idle"))),this.runSummarize=e=>{var t;null===(t=this.idleTimer)||void 0===t||t.clear();this.opsSinceLastAck>0&&r(e)}}get idleTime(){const e=this.configuration.maxIdleTime,t=this.configuration.minIdleTime,r=1*Xe(this.heuristicData.numRuntimeOps,this.heuristicData.numNonRuntimeOps,this.configuration.runtimeOpWeight,this.configuration.nonRuntimeOpWeight)/this.configuration.maxOps;return r>=1?t:e-(e-t)*r}get opsSinceLastAck(){return this.heuristicData.lastOpSequenceNumber-this.heuristicData.lastSuccessfulSummary.refSequenceNumber}start(){var e;null===(e=this.idleTimer)||void 0===e||e.start(this.idleTime)}run(){var e;for(const t of this.summarizeStrategies)if(t.shouldRunSummary(this.configuration,this.heuristicData))return this.runSummarize(t.summarizeReason);null===(e=this.idleTimer)||void 0===e||e.restart(this.idleTime)}shouldRunLastSummary(){const e=Xe(this.heuristicData.numRuntimeOps,this.heuristicData.numNonRuntimeOps,this.configuration.runtimeOpWeight,this.configuration.nonRuntimeOpWeight),t=this.configuration.minOpsForLastSummaryAttempt;return this.logger.sendTelemetryEvent({eventName:"ShouldRunLastSummary",weightedOpsSinceLastAck:e,minOpsForLastSummaryAttempt:t}),e>=t}dispose(){var e;null===(e=this.idleTimer)||void 0===e||e.clear()}}class Qe{constructor(){this.summarizeReason="maxTime"}shouldRunSummary(e,t){return Date.now()-t.lastSuccessfulSummary.summaryTime>e.maxTime}}function Xe(e,t,r,n){return r*e+n*t}class Ze{constructor(){this.summarizeReason="maxOps"}shouldRunSummary(e,t){return Xe(t.numRuntimeOps,t.numNonRuntimeOps,e.runtimeOpWeight,e.nonRuntimeOpWeight)>e.maxOps}}async function $e(e,t,r){const n=[e.then((e=>({result:"done",value:e}))),t.then((e=>{let{timerResult:t}=e;return{result:t}}))];return void 0!==r&&n.push(r.waitCancelled.then((()=>({result:"cancelled"})))),Promise.race(n)}const Ye={submitSummaryFailure:"Error while generating, uploading, or submitting summary",summaryOpWaitTimeout:"Timeout while waiting for summarize op broadcast",summaryAckWaitTimeout:"Timeout while waiting for summaryAck/summaryNack op",summaryNack:"Server rejected summary via summaryNack op",disconnect:"Summary cancelled due to summarizer or main client disconnect"};class et{constructor(){this.summarySubmitted=new ue.c,this.summaryOpBroadcasted=new ue.c,this.receivedSummaryAckOrNack=new ue.c}fail(e,t,r,o){(0,n.v)(!this.receivedSummaryAckOrNack.isCompleted,606);const i={success:!1,message:e,data:void 0,error:t};this.summarySubmitted.resolve({...i,data:r}),this.summaryOpBroadcasted.resolve(i),this.receivedSummaryAckOrNack.resolve({...i,data:o})}build(){return{summarySubmitted:this.summarySubmitted.promise,summaryOpBroadcasted:this.summaryOpBroadcasted.promise,receivedSummaryAckOrNack:this.receivedSummaryAckOrNack.promise}}}O.iq;class tt{constructor(e,t,r,n,o,i){this.pendingAckTimer=e,this.heuristicData=t,this.submitSummaryCallback=r,this.successfulSummaryCallback=n,this.summaryWatcher=o,this.logger=i,this.summarizeTimer=new ze.M4(2e4,(()=>this.summarizeTimerHandler(2e4,1)))}summarize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new et;return this.summarizeCore(e,t).catch((r=>{const n="UnexpectedSummarizeError";e.summaryLogger.sendErrorEvent({eventName:n},r),t.fail(n,r)})),t.build()}async summarizeCore(e,t){var r;const{summaryLogger:o,cancellationToken:i,...s}=e,c=Date.now()-this.heuristicData.lastAttempt.summaryTime,l=Date.now()-this.heuristicData.lastSuccessfulSummary.summaryTime;let d={...s,fullTree:null!==(r=s.fullTree)&&void 0!==r&&r,timeSinceLastAttempt:c,timeSinceLastSummary:l};const u=v.Bt.start(o,{eventName:"Summarize",...d},{start:!0,end:!0,cancel:"generic"});let h;const g=(e,r,n,o,s)=>{var a;const c=i.cancelled||(null===r||void 0===r?void 0:r.errorType)===Ve.offlineError?"generic":"error",l=(e=>"".concat(e,": ").concat(Ye[e]))(e);u.cancel({...n,reason:l,category:c,retryAfterSeconds:null!==(a=null===o||void 0===o?void 0:o.retryAfterSeconds)&&void 0!==a?a:null===s||void 0===s?void 0:s.retryAfterSeconds},null!==r&&void 0!==r?r:l),t.fail(l,r,o,s)};this.summarizeTimer.start();try{const r=this.heuristicData.lastAttempt.refSequenceNumber;h=await this.submitSummaryCallback(e);const n=h.referenceSequenceNumber;if(d={...d,referenceSequenceNumber:n,minimumSequenceNumber:h.minimumSequenceNumber,opsSinceLastAttempt:n-r,opsSinceLastSummary:n-this.heuristicData.lastSuccessfulSummary.refSequenceNumber,stage:h.stage},d=this.addSummaryDataToTelemetryProps(h,d),"submit"!==h.stage)return g("submitSummaryFailure",h.error,d,{stage:h.stage,retryAfterSeconds:(0,ge.PE)(h.error)});if(!e.fullTree&&!h.forcedFullTree){const{summarizedDataStoreCount:e,gcStateUpdatedDataStoreCount:t=0}=h.summaryStats;e>t+this.heuristicData.opsSinceLastSummary&&o.sendErrorEvent({eventName:"IncrementalSummaryViolation",summarizedDataStoreCount:e,gcStateUpdatedDataStoreCount:t,opsSinceLastSummary:this.heuristicData.opsSinceLastSummary})}u.reportEvent("generate",{...d}),t.summarySubmitted.resolve({success:!0,data:h})}catch(p){return g("submitSummaryFailure",p,void 0,{stage:"unknown",retryAfterSeconds:(0,ge.PE)(p)})}finally{void 0===h&&this.heuristicData.recordAttempt(),this.summarizeTimer.clear()}try{const e=this.pendingAckTimer.start(),r=this.summaryWatcher.watchSummary(h.clientSequenceNumber),s=await $e(r.waitBroadcast(),e,i);if("cancelled"===s.result)return g("disconnect");if("done"!==s.result)return g("summaryOpWaitTimeout");const c=s.value,l=Date.now()-this.heuristicData.lastAttempt.summaryTime;t.summaryOpBroadcasted.resolve({success:!0,data:{summarizeOp:c,broadcastDuration:l}}),this.heuristicData.lastAttempt.summarySequenceNumber=c.sequenceNumber,o.sendTelemetryEvent({eventName:"Summarize_Op",duration:l,referenceSequenceNumber:c.referenceSequenceNumber,summarySequenceNumber:c.sequenceNumber,handle:c.contents.handle});const p=await $e(r.waitAckNack(),e,i);if("cancelled"===p.result)return g("disconnect");if("done"!==p.result)return g("summaryAckWaitTimeout");const m=p.value;this.pendingAckTimer.clear();const f=Date.now()-this.heuristicData.lastAttempt.summaryTime;if(d={ackWaitDuration:f,ackNackSequenceNumber:m.sequenceNumber,summarySequenceNumber:m.contents.summaryProposal.summarySequenceNumber,...d},m.type!==a.Go.SummaryAck){(0,n.v)(m.type===a.Go.SummaryNack,628);const e=m.contents,t=null===e||void 0===e?void 0:e.message,r=null===e||void 0===e?void 0:e.retryAfter,o=new O.iq("Received summaryNack",{retryAfterSeconds:r,errorMessage:t});return(0,n.v)((0,ge.PE)(o)===r,607),g("summaryNack",o,{...d,nackRetryAfter:r},void 0,{summaryNackOp:m,ackNackDuration:f,retryAfterSeconds:r})}this.heuristicData.markLastAttemptAsSuccessful(),this.successfulSummaryCallback(),u.end({...d,handle:m.contents.handle}),t.receivedSummaryAckOrNack.resolve({success:!0,data:{summaryAckOp:m,ackNackDuration:f}})}finally{this.pendingAckTimer.clear()}}addSummaryDataToTelemetryProps(e,t){switch(e.stage){case"base":return t;case"generate":return{...t,...e.summaryStats,generateDuration:e.generateDuration};case"upload":return{...t,...e.summaryStats,generateDuration:e.generateDuration,handle:e.handle,uploadDuration:e.uploadDuration};case"submit":return{...t,...e.summaryStats,generateDuration:e.generateDuration,handle:e.handle,uploadDuration:e.uploadDuration,clientSequenceNumber:e.clientSequenceNumber,hasMissingOpData:this.heuristicData.hasMissingOpData,opsSizesSinceLastSummary:this.heuristicData.totalOpsSize,nonRuntimeOpsSinceLastSummary:this.heuristicData.numNonRuntimeOps,runtimeOpsSinceLastSummary:this.heuristicData.numRuntimeOps};default:(0,n.v)(!0,919)}return t}summarizeTimerHandler(e,t){if(this.logger.sendPerformanceEvent({eventName:"SummarizeTimeout",timeoutTime:e,timeoutCount:t}),t<5){const r=2*e;this.summarizeTimer.start(r,(()=>this.summarizeTimerHandler(r,t+1)))}}dispose(){this.summarizeTimer.clear()}}class rt extends o.X{static async start(e,t,r,n,o,i,s,a,c,l){var d,u;const h=new rt(e,t,r,n,o,i,s,a,c,l),g=await h.handleSummaryAck();await h.waitStart(),h.processIncomingSummaryAcks(g).catch((t=>{(0,v.pW)({logger:e}).sendErrorEvent({eventName:"HandleSummaryAckFatalError"},t)}));const p=l.deltaManager.lastSequenceNumber-(i.lastSuccessfulSummary.refSequenceNumber+i.numNonRuntimeOps+i.numRuntimeOps);return i.hasMissingOpData=p>0,i.hasMissingOpData&&(i.numNonRuntimeOps+=Math.ceil(p/2),i.numRuntimeOps+=Math.floor(p/2)),i.lastOpSequenceNumber=l.deltaManager.lastSequenceNumber,null===(d=h.heuristicRunner)||void 0===d||d.start(),null===(u=h.heuristicRunner)||void 0===u||u.run(),h}get disposed(){return this._disposed}constructor(e,t,r,o,i,s,a,c,l,d){super(),this.summaryWatcher=t,this.configuration=r,this.submitSummaryCallback=o,this.refreshLatestSummaryAckCallback=i,this.heuristicData=s,this.summaryCollection=a,this.cancellationToken=c,this.stopSummarizerCallback=l,this.runtime=d,this.stopping=!1,this._disposed=!1,this.tryWhileSummarizing=!1,this.summarizeCount=0,this.totalSuccessfulAttempts=0,this.initialized=!1,this.tryGetCorrelatedLogger=e=>this.heuristicData.lastAttempt.refSequenceNumber===e?this.mc.logger:void 0,this.heuristicRunnerMicroTaskExists=!1;const u={summarizeCount:()=>this.summarizeCount,summarizerSuccessfulAttempts:()=>this.totalSuccessfulAttempts};this.mc=(0,y.CL)({logger:e,namespace:"Running",properties:{all:u}}),"disableHeuristics"!==r.state&&((0,n.v)("enabled"===this.configuration.state,746),this.heuristicRunner=new Je(s,this.configuration,(e=>this.trySummarize(e)),this.mc.logger)),(0,n.v)("disabled"!==this.configuration.state,747);const h=Math.min(this.configuration.maxAckWaitTime,6e5);this.pendingAckTimer=new ze.zO(h,(()=>{this.mc.logger.sendErrorEvent({eventName:"SummaryAckWaitTimeout",message:"Pending summary ack not received in time",maxAckWaitTime:h,referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber,timePending:Date.now()-this.heuristicData.lastAttempt.summaryTime})})),a.setPendingAckTimerTimeoutCallback(h,(()=>{this.pendingAckTimer.hasTimer&&(this.mc.logger.sendTelemetryEvent({eventName:"MissingSummaryAckFoundByOps",referenceSequenceNumber:this.heuristicData.lastAttempt.refSequenceNumber,summarySequenceNumber:this.heuristicData.lastAttempt.summarySequenceNumber}),this.pendingAckTimer.clear())})),this.generator=new tt(this.pendingAckTimer,this.heuristicData,this.submitSummaryCallback,(()=>{this.totalSuccessfulAttempts++}),this.summaryWatcher,this.mc.logger),this.runtimeListener=(e,t)=>{this.handleOp(e,!0===t)},this.runtime.on("op",this.runtimeListener);const g=this.mc.config.getNumber("Fluid.Summarizer.AttemptsForSubmitFailures");this.maxAttemptsForSubmitFailures=g&&g<5?g:5}async handleSummaryAck(){const e=this.summaryCollection.latestAck;let t=-1;if(void 0!==e){var r;t=e.summaryOp.referenceSequenceNumber;const n=null!==(r=this.tryGetCorrelatedLogger(t))&&void 0!==r?r:this.mc.logger,o=e.summaryOp.contents.handle,i=e.summaryAck.contents.handle;for(;void 0!==this.summarizingLock;)n.sendTelemetryEvent({eventName:"RefreshAttemptWithSummarizerRunning",referenceSequenceNumber:t,proposalHandle:o,ackHandle:i}),await this.summarizingLock;await this.lockedSummaryAction((()=>{}),(async()=>this.refreshLatestSummaryAckCallback({proposalHandle:o,ackHandle:i,summaryRefSeq:t,summaryLogger:n}).catch((async e=>{const r=(0,_e.Xy)(e)&&e.errorType===Ve.fileNotFoundOrAccessDeniedError;n.sendTelemetryEvent({eventName:r?"HandleSummaryAckErrorIgnored":"HandleLastSummaryAckError",referenceSequenceNumber:t,proposalHandle:o,ackHandle:i},e)}))),(()=>{})),t++}return t}async processIncomingSummaryAcks(e){let t=e>0?e:this.runtime.deltaManager.initialSequenceNumber;for(;!this.disposed;){var r;const o=null!==(r=this.tryGetCorrelatedLogger(t))&&void 0!==r?r:this.mc.logger;await this.summaryCollection.waitSummaryAck(t),o.sendTelemetryEvent({eventName:"processIncomingSummaryAcks",referenceSequenceNumber:t,lastAckRefSeq:e}),t=await this.handleSummaryAck(),(0,n.v)(t>=0,1423)}}dispose(){var e;this.runtime.off("op",this.runtimeListener),this.summaryWatcher.dispose(),null===(e=this.heuristicRunner)||void 0===e||e.dispose(),this.heuristicRunner=void 0,this.generator.dispose(),this.pendingAckTimer.clear(),this.disposeEnqueuedSummary(),this._disposed=!0,this.stopping=!0}handleOp(e,t){this.heuristicData.lastOpSequenceNumber=e.sequenceNumber,t?this.heuristicData.numRuntimeOps++:this.heuristicData.numNonRuntimeOps++,this.heuristicData.totalOpsSize+=(e=>{var t;const r="string"===typeof e.contents?e.contents:null!==(t=JSON.stringify(e.contents))&&void 0!==t?t:"",n=We(e)?e.data:"";return r.length+n.length})(e),this.initialized&&this.opCanTriggerSummary(e,t)&&!this.tryRunEnqueuedSummary()&&!this.heuristicRunnerMicroTaskExists&&(this.heuristicRunnerMicroTaskExists=!0,Promise.resolve().then((()=>{var e;null===(e=this.heuristicRunner)||void 0===e||e.run()})).finally((()=>{this.heuristicRunnerMicroTaskExists=!1})))}opCanTriggerSummary(e,t){switch(e.type){case a.Go.Summarize:case a.Go.SummaryAck:case a.Go.SummaryNack:return!1;default:return t||this.nonRuntimeOpCanTriggerSummary()}}nonRuntimeOpCanTriggerSummary(){const e=this.heuristicData.lastOpSequenceNumber-this.heuristicData.lastSuccessfulSummary.refSequenceNumber;return"enabled"===this.configuration.state&&(void 0===this.configuration.nonRuntimeHeuristicThreshold||this.configuration.nonRuntimeHeuristicThreshold<=e)}async waitStop(e){var t;this.stopping||(this.stopping=!0,this.disposeEnqueuedSummary(),e&&null!==(t=this.heuristicRunner)&&void 0!==t&&t.shouldRunLastSummary()&&void 0===this.summarizingLock&&this.trySummarizeOnce({summarizeReason:"lastSummary"},{}),await this.summarizingLock)}async waitStart(){const e=await $e(this.summaryWatcher.waitFlushed(),this.pendingAckTimer.start());this.pendingAckTimer.clear(),this.summaryCollection.unsetPendingAckTimerTimeoutCallback(),"done"===e.result&&void 0!==e.value&&this.heuristicData.updateWithLastSummaryAckInfo({refSequenceNumber:e.value.summaryOp.referenceSequenceNumber,summaryTime:Date.now(),summarySequenceNumber:e.value.summaryOp.sequenceNumber}),this.initialized=!0}beforeSummaryAction(){this.summarizeCount++}afterSummaryAction(){const e=this.tryWhileSummarizing;var t;(this.tryWhileSummarizing=!1,this.stopping||this.tryRunEnqueuedSummary()||!e)||(null===(t=this.heuristicRunner)||void 0===t||t.run())}async lockedSummaryAction(e,t,r){(0,n.v)(void 0===this.summarizingLock,603);const o=new ue.c;return this.summarizingLock=o.promise,e(),t().finally((()=>{o.resolve(),this.summarizingLock=void 0,r()}))}trySummarizeOnce(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new et;return this.lockedSummaryAction((()=>{this.beforeSummaryAction()}),(async()=>{const n=(0,v.pW)({logger:this.mc.logger,properties:{all:e}}),o={...t,summaryLogger:n,cancellationToken:this.cancellationToken};return this.generator.summarize(o,r).receivedSummaryAckOrNack}),(()=>{this.afterSummaryAction()})).catch((e=>{})),r.build()}trySummarize(e){void 0===this.summarizingLock?this.lockedSummaryAction((()=>{this.beforeSummaryAction()}),(async()=>this.mc.config.getBoolean("Fluid.Summarizer.UseDynamicRetries")?this.trySummarizeWithRetries(e):this.trySummarizeWithStaticAttempts(e)),(()=>{this.afterSummaryAction()})).catch((e=>{this.mc.logger.sendErrorEvent({eventName:"UnexpectedSummarizeError"},e)})):this.tryWhileSummarizing=!0}async trySummarizeWithStaticAttempts(e){const t=[{refreshLatestAck:!1,fullTree:!1},{refreshLatestAck:!0,fullTree:!1}];let r=0,n=0,o=0;for(;o<t.length;){var i,s;if(this.cancellationToken.cancelled)return;if(++r>1&&"lastSummary"===e)return;n++;const c=t[o],l={summarizeReason:e,summaryAttempts:r,summaryAttemptsPerPhase:n,summaryAttemptPhase:o+1,...c},d=(0,v.pW)({logger:this.mc.logger,properties:{all:l}}),u={...c,summaryLogger:d,cancellationToken:this.cancellationToken},h=this.generator.summarize(u),g=await h.receivedSummaryAckOrNack;if(g.success)return;const p=await h.summarySubmitted,m=p.success?null===(s=g.data)||void 0===s?void 0:s.retryAfterSeconds:null===(i=p.data)||void 0===i?void 0:i.retryAfterSeconds;var a;if((void 0===m||n>1)&&(o++,n=0),void 0!==m)this.mc.logger.sendPerformanceEvent({eventName:"SummarizeAttemptDelay",duration:m,summaryNackDelay:void 0!==(null===(a=g.data)||void 0===a?void 0:a.retryAfterSeconds),...l}),await(0,I.c)(1e3*m)}this.stopSummarizerCallback("failToSummarize")}async trySummarizeWithRetries(e){const t=(t,r)=>{const n={fullTree:!1},o={summarizeReason:e,summaryAttempts:t,...n,finalAttempt:r},i=(0,v.pW)({logger:this.mc.logger,properties:{all:o}}),s={...n,summaryLogger:i,cancellationToken:this.cancellationToken,finalAttempt:r};return{summarizeProps:o,summarizeResult:this.generator.summarize(s)}};let r,n,o=2,i=0,s=!1,a="success";do{if(i++,this.cancellationToken.cancelled){a="canceled",s=!0;break}const e=t(i,!1);n=e.summarizeResult;const h=await n.receivedSummaryAckOrNack;if(h.success){a="success",s=!0;break}const g=await n.summarySubmitted;var c,l;if(g.success)o=2,r=null===(c=h.data)||void 0===c?void 0:c.retryAfterSeconds;else o=this.maxAttemptsForSubmitFailures,r=null===(l=g.data)||void 0===l?void 0:l.retryAfterSeconds;a="failure";const p={result:a,currentAttempt:i,maxAttempts:o,error:h.error};var d,u;if(this.emit("summarize",p),(void 0===r||i>=o-1)&&(s=!0),void 0!==r)this.mc.logger.sendPerformanceEvent({eventName:"SummarizeAttemptDelay",duration:r,summaryNackDelay:void 0!==(null===(d=h.data)||void 0===d?void 0:d.retryAfterSeconds),stage:null===(u=g.data)||void 0===u?void 0:u.stage,dynamicRetries:!0,...e.summarizeProps}),await(0,I.c)(1e3*r)}while(!s);if("failure"!==a)return this.emit("summarize",{result:a,currentAttempt:i,maxAttempts:o}),n;if(void 0!==r){const{summarizeResult:e}=t(++i,!0),r=await e.receivedSummaryAckOrNack;a=r.success?"success":"failure";const s={result:a,currentAttempt:i,maxAttempts:o,error:r.success?void 0:r.error};this.emit("summarize",s),n=e}return"failure"===a&&this.stopSummarizerCallback("failToSummarize"),n}async summarizeOnDemandWithRetries(e,t){const r=await this.trySummarizeWithRetries(e);if(void 0===r)return t.fail("Summarization was canceled",void 0),t.build();const n=await r.summarySubmitted,o=await r.summaryOpBroadcasted,i=await r.receivedSummaryAckOrNack;return t.summarySubmitted.resolve(n),t.summaryOpBroadcasted.resolve(o),t.receivedSummaryAckOrNack.resolve(i),t.build()}summarizeOnDemand(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new et;if(this.stopping)return t.fail("RunningSummarizer stopped or disposed",void 0),t.build();if(void 0!==this.summarizingLock)throw new i.eb("Attempted to run an already-running summarizer on demand");const{reason:r,...n}=e;return!0===e.retryOnFailure?this.summarizeOnDemandWithRetries("onDemand;".concat(r),t).catch((e=>{t.fail("summarize failed",e)})):this.trySummarizeOnce({summarizeReason:"onDemand/".concat(r)},n,t),t.build()}enqueueSummarize(e){const{reason:t,afterSequenceNumber:r=0,override:n=!1,...o}=e;let i=!1;if(void 0!==this.enqueuedSummary){if(!n)return{alreadyEnqueued:!0};this.enqueuedSummary.resultsBuilder.fail("Aborted; overridden by another enqueue summarize attempt",void 0),this.enqueuedSummary=void 0,i=!0}this.enqueuedSummary={reason:"enqueue;".concat(t),afterSequenceNumber:r,summarizeOptions:o,resultsBuilder:new et};const s=this.enqueuedSummary.resultsBuilder.build();return this.tryRunEnqueuedSummary(),i?{...s,alreadyEnqueued:!0,overridden:!0}:s}tryRunEnqueuedSummary(){if(this.stopping)return this.disposeEnqueuedSummary(),!1;if(void 0===this.enqueuedSummary||this.heuristicData.lastOpSequenceNumber<this.enqueuedSummary.afterSequenceNumber||void 0!==this.summarizingLock)return!1;const{reason:e,resultsBuilder:t,summarizeOptions:r}=this.enqueuedSummary;return this.enqueuedSummary=void 0,this.trySummarizeOnce({summarizeReason:"enqueuedSummary/".concat(e)},r,t),!0}disposeEnqueuedSummary(){void 0!==this.enqueuedSummary&&(this.enqueuedSummary.resultsBuilder.fail("RunningSummarizer stopped or disposed",void 0),this.enqueuedSummary=void 0)}}class nt extends O.iq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.logged=t,this.errorType="summarizingError",this.canRetry=!0}static wrap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return(0,O.G)(e,(e=>new nt(e,t)),r)}}class ot extends o.X{get ISummarizer(){return this}constructor(e,t,r,n,o,i){super(),this.runtime=e,this.configurationGetter=t,this.internalsProvider=r,this.summaryCollection=o,this.runCoordinatorCreateFn=i,this._disposed=!1,this.starting=!1,this.stopDeferred=new ue.c,this.handleSummarizeEvent=e=>{this.emit("summarize",e)},this.logger=(0,v.pW)({logger:this.runtime.logger,namespace:"Summarizer"})}async run(e){try{return await this.runCore(e)}catch(t){throw this.stop("summarizerException"),nt.wrap(t,!1,this.logger)}finally{this.close()}}stop(e){this.stopDeferred.resolve(e)}close(){this.dispose(),this.runtime.disposeFn()}async runCore(e){const t=await this.runCoordinatorCreateFn(this.runtime),r=Promise.race([t.waitCancelled,this.stopDeferred.promise]);if(r.then((t=>{this.logger.sendTelemetryEvent({eventName:"StoppingSummarizer",onBehalfOf:e,reason:t})})),t.cancelled)return t.waitCancelled;const n=await this.start(e,t),o=await r;return await n.waitStop(!t.cancelled&&ot.stopReasonCanRunLastSummary(o)),t.stop(o),o}static stopReasonCanRunLastSummary(e){return"parentNotConnected"===e}async start(e,t){var r=this;if(this.runningSummarizer){if(this.runningSummarizer.disposed)throw new i.eb("Starting a disposed summarizer");return this.runningSummarizer}if(this.starting)throw new i.eb("Attempting to start a summarizer that is already starting");this.starting=!0,this.logger.sendTelemetryEvent({eventName:"RunningSummarizer",onBehalfOf:e,initSummarySeqNumber:this.runtime.deltaManager.initialSequenceNumber,config:JSON.stringify(this.configurationGetter())});const n=this.runtime.clientId;if(void 0===n)throw new i.eb("clientId should be defined if connected.");this._heuristicData=new Ke(this.runtime.deltaManager.lastSequenceNumber,{refSequenceNumber:this.runtime.deltaManager.initialSequenceNumber,summaryTime:Date.now()});const o=await rt.start(this.logger,this.summaryCollection.createWatcher(n),this.configurationGetter(),(async function(){return r.internalsProvider.submitSummary(...arguments)}),(async function(){return r.internalsProvider.refreshLatestSummaryAck(...arguments)}),this._heuristicData,this.summaryCollection,t,(e=>t.stop(e)),this.runtime);return this.runningSummarizer=o,this.runningSummarizer.on("summarize",this.handleSummarizeEvent),this.starting=!1,o}dispose(){this.stop("summarizerClientDisconnected"),this._disposed=!0,this.runningSummarizer&&(this.runningSummarizer.off("summarize",this.handleSummarizeEvent),this.runningSummarizer.dispose(),this.runningSummarizer=void 0)}summarizeOnDemand(e){try{var t;if(this._disposed||null!==(t=this.runningSummarizer)&&void 0!==t&&t.disposed)throw new i.eb("Summarizer is already disposed.");if(void 0!==this.runtime.summarizerClientId&&this.runtime.summarizerClientId!==this.runtime.clientId)throw new i.eb("On-demand summary attempted while an elected summarizer is present");const r=new et;if(this.runningSummarizer)return this.runningSummarizer.summarizeOnDemand(e,r);return this.runCoordinatorCreateFn(this.runtime).then((t=>{this.start(this.runtime.clientId,t).then((async n=>{n.summarizeOnDemand(e,r);const o=await Promise.race([this.stopDeferred.promise,t.waitCancelled]);await n.waitStop(!1),t.stop(o),this.close()})).catch((e=>{r.fail("Failed to start summarizer",e)}))})).catch((e=>{r.fail("Failed to create cancellation token",e)})),r.build()}catch(r){throw nt.wrap(r,!1,this.logger)}}enqueueSummarize(e){if(this._disposed||void 0===this.runningSummarizer||this.runningSummarizer.disposed)throw new i.eb("Summarizer is not running or already disposed.");return this.runningSummarizer.enqueueSummarize(e)}recordSummaryAttempt(e){var t;null===(t=this._heuristicData)||void 0===t||t.recordAttempt(e)}}new Promise((()=>{}));const it=5e3,st=4e3;var at;!function(e){e[e.Off=0]="Off",e[e.Starting=1]="Starting",e[e.Running=2]="Running",e[e.Stopping=3]="Stopping"}(at||(at={}));class ct extends o.X{get disposed(){return this._disposed}get currentState(){return this.state}constructor(e,t,r,n,o,i){let{initialDelayMs:s=it,opsToBypassInitialDelay:a=st}=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c=arguments.length>7?arguments[7]:void 0;super(),this.clientElection=e,this.connectedState=t,this.summaryCollection=r,this.createSummarizerFn=o,this.startThrottler=i,this.disableHeuristics=c,this.state=at.Off,this._disposed=!1,this.handleConnected=e=>{this.latestClientId=e,this.refreshSummarizer()},this.handleDisconnected=()=>{this.refreshSummarizer()},this.handleSummarizeEvent=e=>{this.emit("summarize",e)},this.refreshSummarizer=()=>{const e=this.getShouldSummarizeState();switch(this.state){case at.Off:return void(e.shouldSummarize&&this.startSummarization());case at.Starting:return;case at.Running:return void(!1===e.shouldSummarize&&this.stop(e.stopReason));case at.Stopping:default:return}},this.logger=(0,v.pW)({logger:n,namespace:"SummaryManager",properties:{all:{clientId:()=>this.latestClientId}}}),this.connectedState.on("connected",this.handleConnected),this.connectedState.on("disconnected",this.handleDisconnected),this.latestClientId=this.connectedState.clientId,this.opsToBypassInitialDelay=a,this.initialDelayMs=s}start(){this.clientElection.on("electedSummarizerChanged",this.refreshSummarizer),this.refreshSummarizer()}getShouldSummarizeState(){return this.connectedState.clientId!==this.clientElection.electedParentId?{shouldSummarize:!1,stopReason:"notElectedParent"}:this.state!==at.Running&&this.connectedState.clientId!==this.clientElection.electedClientId?{shouldSummarize:!1,stopReason:"notElectedClient"}:this.connectedState.connected?this.disposed?void(0,n.v)(!1,608):{shouldSummarize:!0}:{shouldSummarize:!1,stopReason:"parentNotConnected"}}startSummarization(){(0,n.v)(this.state===at.Off,609),this.state=at.Starting,(0,n.v)(void 0===this.summarizer,610),this.delayBeforeCreatingSummarizer().then((async e=>{const t=this.getShouldSummarizeState();if(e&&!1===t.shouldSummarize)return"early exit ".concat(t.stopReason);(0,n.v)(this.state===at.Starting,611),this.state=at.Running;const r=await this.createSummarizerFn();this.summarizer=r,this.summarizer.on("summarize",this.handleSummarizeEvent);const o=this.getShouldSummarizeState();if(!1===o.shouldSummarize){if(e||!ot.stopReasonCanRunLastSummary(o.stopReason))return this.state=at.Starting,r.stop(o.stopReason),"early exit after starting summarizer ".concat(o.stopReason);this.logger.sendTelemetryEvent({eventName:"LastAttemptToSummarize"})}const i=this.latestClientId;return v.Bt.timedExecAsync(this.logger,{eventName:"RunningSummarizer",attempt:this.startThrottler.numAttempts},(async()=>r.run(i,this.disableHeuristics)))})).then((e=>{this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:e})})).catch((e=>{if(this.logger.sendTelemetryEvent({eventName:"EndingSummarizer",reason:"exception"},e),this.getShouldSummarizeState().shouldSummarize||void 0!==this.summarizer){const t=(null===e||void 0===e?void 0:e.errorType)===Ve.offlineError?"generic":"error";this.logger.sendTelemetryEvent({eventName:"SummarizerException",category:t},e)}})).finally((()=>{var e,t;(0,n.v)(this.state!==at.Off,612),this.state=at.Off,null===(e=this.summarizer)||void 0===e||e.off("summarize",this.handleSummarizeEvent),null===(t=this.summarizer)||void 0===t||t.close(),this.summarizer=void 0,this.getShouldSummarizeState().shouldSummarize&&this.startSummarization()}))}stop(e){var t;ct.isStartingOrRunning(this.state)&&(this.state=at.Stopping,null===(t=this.summarizer)||void 0===t||t.stop(e))}async delayBeforeCreatingSummarizer(){let e=this.startThrottler.getDelay();this.logger.sendTelemetryEvent({eventName:"CreatingSummarizer",throttlerDelay:e,initialDelay:this.initialDelayMs,startThrottlerMaxDelayMs:this.startThrottler.maxDelayMs,opsSinceLastAck:this.summaryCollection.opsSinceLastAck,opsToBypassInitialDelay:this.opsToBypassInitialDelay,electedParentId:this.clientElection.electedParentId,electedClientId:this.clientElection.electedClientId});let t=!1;if(this.summaryCollection.opsSinceLastAck<this.opsToBypassInitialDelay&&(t=!0,e=Math.max(e,this.initialDelayMs)),e>0){let t,r;const n=()=>{this.summaryCollection.opsSinceLastAck>=this.opsToBypassInitialDelay&&(clearTimeout(t),r())},o=new Promise((r=>{t=setTimeout((()=>r()),e)})),i=new Promise((e=>{r=e}));this.summaryCollection.addOpListener(n),await Promise.race([o,i]),this.summaryCollection.removeOpListener(n)}return t}summarizeOnDemand(e){if(void 0===this.summarizer)throw Error("No running summarizer client");return this.summarizer.summarizeOnDemand(e)}enqueueSummarize(e){if(void 0===this.summarizer)throw Error("No running summarizer client");return this.summarizer.enqueueSummarize(e)}dispose(){var e;this.clientElection.off("electedSummarizerChanged",this.refreshSummarizer),this.connectedState.off("connected",this.handleConnected),this.connectedState.off("disconnected",this.handleDisconnected),null===(e=this.summarizer)||void 0===e||e.off("summarize",this.handleSummarizeEvent),this._disposed=!0}}ct.isStartingOrRunning=e=>e===at.Starting||e===at.Running;var lt,dt;!function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(lt||(lt={}));O.iq;!function(e){e.FluidDataStoreOp="component",e.Attach="attach",e.ChunkedOp="chunkedOp",e.BlobAttach="blobAttach",e.Rejoin="rejoin",e.Alias="alias",e.IdAllocation="idAllocation",e.GC="GC"}(dt||(dt={}));"".concat(C.YV,"_root");ze.M4;Map;r(16713);class ut{constructor(e,t){this.logger=t,this.processingTimeIncrement=10,this.currentAllowedProcessingTimeForTurn=ut.processingTime,this.schedulingCount=0,this.deltaManager=e,this.deltaManager.inbound.on("idle",(()=>{this.inboundQueueIdle()}))}batchBegin(e){this.processingStartTime||(this.processingStartTime=b.F.now()),void 0===this.schedulingLog&&this.schedulingCount%500===0&&(this.schedulingLog={opsRemainingToProcess:0,numberOfTurns:1,totalProcessingTime:0,numberOfBatchesProcessed:0,firstSequenceNumber:e.sequenceNumber,lastSequenceNumber:e.sequenceNumber,startTime:b.F.now()})}batchEnd(e){if(this.schedulingLog&&(this.schedulingLog.numberOfBatchesProcessed++,this.schedulingLog.lastSequenceNumber=e.sequenceNumber,this.schedulingLog.opsRemainingToProcess=this.deltaManager.inbound.length),this.shouldRunScheduler()){const e=b.F.now(),t=e-this.processingStartTime;t>this.currentAllowedProcessingTimeForTurn&&(this.deltaManager.inbound.pause(),this.currentAllowedProcessingTimeForTurn+=this.processingTimeIncrement,this.schedulingLog&&(this.schedulingLog.numberOfTurns++,this.schedulingLog.totalProcessingTime+=t),setTimeout((()=>{this.schedulingLog&&this.logger.sendTelemetryEvent({eventName:"InboundOpsPartialProcessingTime",duration:(0,v.T0)(t),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,opsRemainingToProcess:this.deltaManager.inbound.length,processingTime:(0,v.T0)(this.schedulingLog.totalProcessingTime),numberOfTurns:this.schedulingLog.numberOfTurns,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,timeToResume:(0,v.T0)(b.F.now()-e)}),this.deltaManager.inbound.resume()})),this.processingStartTime=void 0)}}inboundQueueIdle(){if(this.schedulingLog){const e=b.F.now();this.schedulingLog.totalProcessingTime+=e-this.processingStartTime,this.logger.sendTelemetryEvent({eventName:"InboundOpsProcessingTime",opsRemainingToProcess:this.schedulingLog.opsRemainingToProcess,numberOfTurns:this.schedulingLog.numberOfTurns,processingTime:(0,v.T0)(this.schedulingLog.totalProcessingTime),opsProcessed:this.schedulingLog.lastSequenceNumber-this.schedulingLog.firstSequenceNumber+1,batchesProcessed:this.schedulingLog.numberOfBatchesProcessed,duration:(0,v.T0)(e-this.schedulingLog.startTime),schedulingCount:this.schedulingCount}),this.schedulingLog=void 0}this.schedulingCount++,this.processingStartTime=void 0,this.currentAllowedProcessingTimeForTurn=ut.processingTime}shouldRunScheduler(){return this.deltaManager.inbound.length>0}}ut.processingTime=50;class ht{constructor(e,t){this.config=e,this.logger=(0,v.pW)({logger:t,namespace:"OpGroupingManager"})}groupBatch(e){if(!this.shouldGroup(e))return e;e.content.length>=1e3&&this.logger.sendTelemetryEvent({eventName:"GroupLargeBatch",length:e.content.length,threshold:this.config.opCountThreshold,reentrant:e.hasReentrantOps,referenceSequenceNumber:e.content[0].referenceSequenceNumber});for(const r of e.content)if(r.metadata){const e=Object.keys(r.metadata);(0,n.v)(e.length<2,1501),(0,n.v)(0===e.length||"batch"===e[0],1502)}const t=JSON.stringify({type:ht.groupedBatchOp,contents:e.content.map((e=>({contents:void 0===e.contents?void 0:JSON.parse(e.contents),metadata:e.metadata,compression:e.compression})))});return{...e,content:[{localOpMetadata:void 0,metadata:void 0,referenceSequenceNumber:e.content[0].referenceSequenceNumber,contents:t,type:ht.groupedBatchOp}]}}ungroupOp(e){let t=1;if((null===(r=e.contents)||void 0===r?void 0:r.type)!==ht.groupedBatchOp)return this.config.groupedBatchingEnabled?[{...e,clientSequenceNumber:t}]:[e];var r;return e.contents.contents.map((r=>({...e,clientSequenceNumber:t++,contents:r.contents,metadata:r.metadata,compression:r.compression})))}shouldGroup(e){return this.config.groupedBatchingEnabled&&e.content.length>=this.config.opCountThreshold&&(this.config.reentrantBatchGroupingEnabled||!0!==e.hasReentrantOps)}}ht.groupedBatchOp="groupedBatch";r(5531);class gt extends o.X{static isEmitterEvent(e){return e===gt.newListenerEvent||e===gt.removeListenerEvent}get disposed(){return this.isDisposed}constructor(e){if(super(),this.isDisposed=!1,this.forwardingEvents=new Map,void 0!==e){const t=t=>this.unforwardEvent(e,t),r=t=>this.forwardEvent(e,t);this.on(gt.removeListenerEvent,t),this.on(gt.newListenerEvent,r)}}dispose(){this.isDisposed=!0;for(const e of this.forwardingEvents.values())for(const t of e.values())try{t()}catch{}this.removeAllListeners(),this.forwardingEvents.clear()}forwardEvent(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];for(const i of n)if(void 0!==e&&void 0!==i&&!gt.isEmitterEvent(i)){let r=this.forwardingEvents.get(i);if(void 0===r&&(r=new Map,this.forwardingEvents.set(i,r)),!r.has(e)){const n=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.emit(i,...r)};r.set(e,(()=>e.off(i,n))),e.on(i,n)}}}unforwardEvent(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(const o of r)if(void 0!==o&&!gt.isEmitterEvent(o)){const t=this.forwardingEvents.get(o);if(!0===(null===t||void 0===t?void 0:t.has(e))&&0===this.listenerCount(o)){const r=t.get(e);void 0!==r&&r(),t.delete(e),0===t.size&&this.forwardingEvents.delete(o)}}}}gt.newListenerEvent="newListener",gt.removeListenerEvent="removeListener";var pt;!function(e){e.wait="wait",e.viaHandle="viaHandle"}(pt||(pt={}));var mt;!function(e){e.lz4="lz4"}(mt||(mt={}));C.WD.TurnBased,mt.lz4;var ft;!function(e){e.FluidDataStoreOp="component",e.Attach="attach",e.ChunkedOp="chunkedOp",e.BlobAttach="blobAttach",e.Rejoin="rejoin",e.Alias="alias",e.Operation="op"}(ft||(ft={}));o.X;class vt{get IFluidHandleContext(){return this}get IFluidHandle(){return this}constructor(e,t){this.absolutePath=e,this.routeContext=t,this.isAttached=!0,(0,n.v)(e.startsWith("/"),413)}async get(){if(void 0===this.objectP){const e={url:this.absolutePath,headers:{[pt.viaHandle]:!0}};this.objectP=this.routeContext.resolveHandle(e).then((e=>{if("fluid/object"===e.mimeType){return e.value}throw A(e)}))}return this.objectP}attachGraph(){}bind(e){e.attachGraph()}}class yt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};for(this.context=e,this.handleParsedCb=t,this.encodeValue=(e,t)=>{const r=null===e||void 0===e?void 0:e.IFluidHandle;return void 0!==r?this.serializeHandle(r,t):e},this.decodeValue=e=>{if(k(e)){const t=e.url.startsWith("/")?e.url:(0,E.a)(e.url,this.context),r=new vt(t,this.root);return this.handleParsedCb(r),r}return e},this.root=this.context;void 0!==this.root.routeContext;)this.root=this.root.routeContext}get IFluidSerializer(){return this}encode(e,t){return e&&"object"===typeof e?this.recursivelyReplace(e,this.encodeValue,t):e}decode(e){return e&&"object"===typeof e?this.recursivelyReplace(e,this.decodeValue):e}stringify(e,t){return JSON.stringify(e,((e,r)=>this.encodeValue(r,t)))}parse(e){return JSON.parse(e,((e,t)=>this.decodeValue(t)))}recursivelyReplace(e,t,r){var n;const o=t(e,r);if(o!==e)return o;let i;for(const a of Object.keys(e)){const n=e[a];if(n&&"object"===typeof n){const o=this.recursivelyReplace(n,t,r);var s;if(o!==n)i=null!==(s=i)&&void 0!==s?s:Array.isArray(e)?[...e]:{...e},i[a]=o}}return null!==(n=i)&&void 0!==n?n:e}serializeHandle(e,t){return t.bind(e),{type:"__fluid_handle__",url:e.absolutePath}}}class bt extends ye.a{get isAttached(){return this.value.isAttached()}constructor(e,t,r){super(e,t,r),this.value=e}attachGraph(){this.value.bindToContext(),super.attachGraph()}}class St extends yt{constructor(){super(...arguments),this.serializedRoutes=new Set}getSerializedRoutes(){return Array.from(this.serializedRoutes)}serializeHandle(e,t){return this.serializedRoutes.add(e.absolutePath),super.serializeHandle(e,t)}}class Ct extends f.o{get IFluidLoadable(){return this}get connected(){return this._connected}constructor(e,t,r){super(((e,t)=>this.eventListenerErrorHandler(e,t))),this.id=e,this.runtime=t,this.attributes=r,this._connected=!1,this._isBoundToContext=!1,(0,n.v)(!e.includes("/"),772),this.handle=new bt(this,e,t.IFluidHandleContext),this.logger=(0,v.pW)({logger:t.logger,properties:{all:{sharedObjectId:p(),...(0,v.Df)({ddsType:this.attributes.type})}}}),this.mc=(0,y.Ln)(this.logger),[this.opProcessingHelper,this.callbacksHelper]=this.setUpSampledTelemetryHelpers(),this.attachListeners()}setUpSampledTelemetryHelpers(){var e,t;(0,n.v)(void 0!==this.mc&&void 0!==this.logger,841);const r=new S({eventName:"ddsOpProcessing",category:"performance"},this.logger,null!==(e=this.mc.config.getNumber("Fluid.SharedObject.OpProcessingTelemetrySampling"))&&void 0!==e?e:1e3,!0,new Map([["local",{localOp:!0}],["remote",{localOp:!1}]])),o=new S({eventName:"ddsEventCallbacks",category:"performance"},this.logger,null!==(t=this.mc.config.getNumber("Fluid.SharedObject.DdsCallbacksTelemetrySampling"))&&void 0!==t?t:1e3,!0);return this.runtime.once("dispose",(()=>{this.callbacksHelper.dispose(),this.opProcessingHelper.dispose()})),[r,o]}closeWithError(e){void 0===this.closeError&&(this.closeError=e)}verifyNotClosed(){if(void 0!==this.closeError)throw this.closeError}eventListenerErrorHandler(e,t){const r=i.I9.wrapIfUnrecognized(t,"SharedObjectEventListenerException");throw r.addTelemetryProperties({emittedEventName:String(e)}),this.closeWithError(r),r}attachListeners(){this.isAttached()||this.runtime.once("attaching",(()=>{this.didAttach()}))}async load(e){this.runtime.attachState!==m.Detached&&(this.services=e),await this.loadCore(e.objectStorage),this.runtime.attachState!==m.Detached&&this.attachDeltaHandler()}initializeLocal(){this.initializeLocalCore()}bindToContext(){this._isBoundToContext||(this._isBoundToContext=!0,this.runtime.bindChannel(this))}connect(e){this.services=e,this.attachDeltaHandler()}isAttached(){return void 0!==this.services&&this.runtime.attachState!==m.Detached}handleDecoded(e){var t,r,n;this.isAttached()&&(null===(t=this.services)||void 0===t||null===(r=(n=t.deltaConnection).addedGCOutboundReference)||void 0===r||r.call(n,this.handle,e))}initializeLocalCore(){}didAttach(){}submitLocalMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.verifyNotClosed(),this.isAttached()&&this.services.deltaConnection.submit(e,t)}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}async newAckBasedPromise(e){let t;return new Promise(((r,n)=>{t=()=>n(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed?t():(this.runtime.on("dispose",t),e(r,n))})).finally((()=>{this.runtime.off("dispose",t)}))}attachDeltaHandler(){(0,n.v)(void 0!==this.services,122),this._isBoundToContext=!0,this.didAttach(),this.services.deltaConnection.attach({process:(e,t,r)=>{this.process(e,t,r)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t)=>{this.reSubmit(e,t)},applyStashedOp:e=>this.applyStashedOp(e),rollback:(e,t)=>{this.rollback(e,t)}}),this.setConnectionState(this.services.deltaConnection.connected)}setConnectionState(e){this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,r){this.verifyNotClosed(),this.emitInternal("pre-op",e,t,this),this.opProcessingHelper.measure((()=>{this.processCore(e,t,r)}),t?"local":"remote"),this.emitInternal("op",e,t,this)}reSubmit(e,t){this.reSubmitCore(e,t)}rollback(e,t){throw new Error("rollback not supported")}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.callbacksHelper.measure((()=>this.runtime.ensureNoDataModelChanges((()=>super.emit(e,...r)))))}emitInternal(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return super.emit(e,...r)}}class kt extends Ct{get serializer(){return(0,n.v)(!this._isGCing,117),this._serializer}constructor(e,t,r,n){super(e,t,r),this.telemetryContextPrefix=n,this._isGCing=!1,this._serializer=new yt(this.runtime.channelsRoutingContext,(e=>this.handleDecoded(e)))}getAttachSummary(){let e=arguments.length>2?arguments[2]:void 0;const t=this.summarizeCore(this.serializer,e);return this.incrementTelemetryMetric(C.RN,t.stats.blobNodeCount,e),this.incrementTelemetryMetric(C.NM,t.stats.totalBlobSize,e),t}async summarize(){let e=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0;const r=this.summarizeCore(this.serializer,e,t);return this.incrementTelemetryMetric(C.RN,r.stats.blobNodeCount,e),this.incrementTelemetryMetric(C.NM,r.stats.totalBlobSize,e),r}getGCData(){let e;(0,n.v)(!this._isGCing,120),this._isGCing=!0;try{const t=new St(this.runtime.channelsRoutingContext,(e=>this.handleDecoded(e)));this.processGCDataCore(t),e={gcNodes:{"/":t.getSerializedRoutes()}},(0,n.v)(this._isGCing,121)}finally{this._isGCing=!1}return e}processGCDataCore(e){this.summarizeCore(e)}incrementTelemetryMetric(e,t,r){var n;const o=null!==(n=null===r||void 0===r?void 0:r.get(this.telemetryContextPrefix,e))&&void 0!==n?n:0;null===r||void 0===r||r.set(this.telemetryContextPrefix,e,o+t)}}var wt;!function(e){e[e.Shared=0]="Shared",e[e.Plain=1]="Plain"}(wt||(wt={}));var Pt=r(53316);const Et=0,Tt=1;class It{constructor(e,t){this.compareKeys=e,this.aug=t}makeNode(e,t,r,n){return{key:e,data:t,color:r,size:n}}isRed(e){return!!e&&e.color===Et}nodeSize(e){return e?e.size:0}size(){return this.nodeSize(this.root)}isEmpty(){return!this.root}get(e){if(void 0!==e)return this.nodeGet(this.root,e)}nodeGet(e,t){let r=e;for(;r;){const e=this.compareKeys(t,r.key);if(e<0)r=r.left;else{if(!(e>0))return r;r=r.right}}}contains(e){return this.get(e)}gather(e,t){const r=[];return void 0!==e&&this.nodeGather(this.root,r,e,t),r}nodeGather(e,t,r,n){e&&(n.continueSubtree(e.left,r)&&this.nodeGather(e.left,t,r,n),n.matchNode(e,r)&&t.push(e),n.continueSubtree(e.right,r)&&this.nodeGather(e.right,t,r,n))}walkExactMatchesForward(e,t,r,n){this.nodeWalkExactMatchesForward(this.root,e,t,r,n)}nodeWalkExactMatchesForward(e,t,r,n,o){if(!e)return;const i=t(e);n(i)&&this.nodeWalkExactMatchesForward(e.left,t,r,n,o),0===i&&r(e),o(i)&&this.nodeWalkExactMatchesForward(e.right,t,r,n,o)}walkExactMatchesBackward(e,t,r,n){this.nodeWalkExactMatchesBackward(this.root,e,t,r,n)}nodeWalkExactMatchesBackward(e,t,r,n,o){if(!e)return;const i=t(e);o(i)&&this.nodeWalkExactMatchesBackward(e.right,t,r,n,o),0===i&&r(e),n(i)&&this.nodeWalkExactMatchesBackward(e.left,t,r,n,o)}put(e,t,r){void 0!==e&&(void 0===t?this.remove(e):(this.root=this.nodePut(this.root,e,t,r),this.root.color=Tt))}nodePut(e,t,r,n){let o=e;if(o){const e=this.compareKeys(t,o.key);if(e<0)o.left=this.nodePut(o.left,t,r,n);else if(e>0)o.right=this.nodePut(o.right,t,r,n);else if(n){const e=n(t,o.key,r,o.data);e.key&&(o.key=e.key),o.data=e.data?e.data:r}else o.data=r;return this.isRed(o.right)&&!this.isRed(o.left)&&(o=this.rotateLeft(o)),this.isRed(o.left)&&this.isRed(o.left.left)&&(o=this.rotateRight(o)),this.isRed(o.left)&&this.isRed(o.right)&&this.flipColors(o),o.size=this.nodeSize(o.left)+this.nodeSize(o.right)+1,this.aug&&this.updateLocal(o),o}return this.makeNode(t,r,Et,1)}updateLocal(e){this.aug&&(this.isRed(e.left)&&this.aug.update(e.left),this.isRed(e.right)&&this.aug.update(e.right),this.aug.update(e))}nodeRemoveMin(e){let t=e;if(t.left)return this.isRed(t.left)||this.isRed(t.left.left)||(t=this.moveRedLeft(t)),t.left=this.nodeRemoveMin(t.left),this.balance(t)}remove(e){if(void 0!==e){if(!this.contains(e))return;this.removeExisting(e)}}removeExisting(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=Et),this.root=this.nodeRemove(this.root,e)}nodeRemove(e,t){let r=e;if(this.compareKeys(t,r.key)<0)this.isRed(r.left)||this.isRed(r.left.left)||(r=this.moveRedLeft(r)),r.left=this.nodeRemove(r.left,t);else{if(this.isRed(r.left)&&(r=this.rotateRight(r)),0===this.compareKeys(t,r.key)&&!r.right)return;if(this.isRed(r.right)||this.isRed(r.right.left)||(r=this.moveRedRight(r)),0===this.compareKeys(t,r.key)){const e=this.nodeMin(r.right);r.key=e.key,r.data=e.data,r.right=this.nodeRemoveMin(r.right)}else r.right=this.nodeRemove(r.right,t)}return this.balance(r)}floor(e){if(!this.isEmpty())return this.nodeFloor(this.root,e)}nodeFloor(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r<0)return this.nodeFloor(e.left,t);{const r=this.nodeFloor(e.right,t);return r||e}}}ceil(e){if(!this.isEmpty())return this.nodeCeil(this.root,e)}nodeCeil(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r>0)return this.nodeCeil(e.right,t);{const r=this.nodeCeil(e.left,t);return r||e}}}min(){if(this.root)return this.nodeMin(this.root)}nodeMin(e){return e.left?this.nodeMin(e.left):e}max(){if(this.root)return this.nodeMax(this.root)}nodeMax(e){return e.right?this.nodeMax(e.right):e}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.color=t.right.color,t.right.color=Et,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.color=t.left.color,t.left.color=Et,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}oppositeColor(e){return e===Tt?Et:Tt}flipColors(e){e.color=this.oppositeColor(e.color),e.left.color=this.oppositeColor(e.left.color),e.right.color=this.oppositeColor(e.right.color)}moveRedLeft(e){let t=e;return this.flipColors(t),this.isRed(t.right.left)&&(t.right=this.rotateRight(t.right),t=this.rotateLeft(t),this.flipColors(t)),t}moveRedRight(e){let t=e;return this.flipColors(t),this.isRed(t.left.left)&&(t=this.rotateRight(t),this.flipColors(t)),t}balance(e){let t=e;return this.isRed(t.right)&&(t=this.rotateLeft(t)),this.isRed(t.left)&&this.isRed(t.left.left)&&(t=this.rotateRight(t)),this.isRed(t.left)&&this.isRed(t.right)&&this.flipColors(t),t.size=this.nodeSize(t.left)+this.nodeSize(t.right)+1,this.aug&&this.aug.update(t),t}mapRange(e,t,r,n){this.nodeMap(this.root,e,t,r,n)}map(e,t){this.nodeMap(this.root,e,t)}keys(){const e=[],t={showStructure:!0,infix:t=>(e.push(t.key),!0)};return this.walk(t),e}walk(e){this.nodeWalk(this.root,e)}walkBackward(e){this.nodeWalkBackward(this.root,e)}nodeWalk(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===Tt)&&(r=t.pre(e)),e.left&&(r=this.nodeWalk(e.left,t)),r&&t.infix&&(t.showStructure||e.color===Tt)&&(r=t.infix(e)),r&&(r=this.nodeWalk(e.right,t)),r&&t.post&&(t.showStructure||e.color===Tt)&&(r=t.post(e))),r}nodeWalkBackward(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===Tt)&&(r=t.pre(e)),e.right&&(r=this.nodeWalkBackward(e.right,t)),r&&t.infix&&(t.showStructure||e.color===Tt)&&(r=t.infix(e)),r&&(r=this.nodeWalkBackward(e.left,t)),r&&t.post&&(t.showStructure||e.color===Tt)&&(r=t.post(e))),r}nodeMap(e,t,r,n,o){let i=n,s=o;if(!e)return!0;void 0===i&&(i=this.nodeMin(e).key),void 0===s&&(s=this.nodeMax(e).key);const a=this.compareKeys(i,e.key),c=this.compareKeys(s,e.key);let l=!0;return a<0&&(l=this.nodeMap(e.left,t,r,i,s)),l&&a<=0&&c>=0&&(l=t(e,r)),l&&c>0&&(l=this.nodeMap(e.right,t,r,i,s)),l}}function Nt(e,t,r){const n=e.makeSerialized(t,r);return{type:n.type,value:n.value&&JSON.parse(n.value)}}class Ft{constructor(e){this.value=e}get type(){return wt[wt.Plain]}makeSerialized(e,t){const r=function(e,t,r){return void 0!==e?t.stringify(e,r):e}(this.value,e,t);return{type:this.type,value:r}}}class Dt{constructor(e){this.serializer=e}fromSerializable(e){if(e.type===wt[wt.Shared]){e.type=wt[wt.Plain];const t={type:"__fluid_handle__",url:e.value};e.value=t}const t=(r=e.value,n=this.serializer,void 0!==r?n.parse(JSON.stringify(r)):r);var r,n;return new Ft(t)}fromInMemory(e){return new Ft(e)}}const Ot="2.0.0-rc.1.0.8";var Bt,xt;const Lt=Pt.posix,At="header";class Rt{get type(){return Rt.Type}get attributes(){return Rt.Attributes}async load(e,t,r,n){const o=new Ht(t,e,n);return await o.load(r),o}create(e,t){const r=new Ht(t,e,Rt.Attributes);return r.initializeLocal(),r}}Rt.Type="https://graph.microsoft.com/types/directory",Rt.Attributes={type:Rt.Type,snapshotFormatVersion:"0.1",packageVersion:Ot};const Mt=(e,t)=>_t(e)?_t(t)?e.seq!==t.seq?e.seq-t.seq:e.clientSeq-t.clientSeq:-1:_t(t)?1:e.seq!==t.seq?e.seq-t.seq:e.clientSeq-t.clientSeq;function _t(e){return e.seq>=0}class zt{constructor(){this.indexToKey=new It(Mt),this.keyToIndex=new Map}set(e,t){this.indexToKey.put(t,e),this.keyToIndex.set(e,t)}has(e){return"string"===typeof e?this.keyToIndex.has(e):void 0!==this.indexToKey.get(e)}delete(e){if(this.has(e))if("string"===typeof e){const t=this.keyToIndex.get(e);this.keyToIndex.delete(e),this.indexToKey.remove(t)}else{var t;const r=null===(t=this.indexToKey.get(e))||void 0===t?void 0:t.data;this.indexToKey.remove(e),this.keyToIndex.delete(r)}}keys(e){const t=[];return this.indexToKey.mapRange((r=>(e&&!e(r.data)||t.push(r.data),!0)),t),t}get size(){return this.keyToIndex.size}}class Ht extends kt{static create(e,t){return e.createChannel(t,Rt.Type)}static getFactory(){return new Rt}get absolutePath(){return this.root.absolutePath}constructor(e,t,r){super(e,t,r,"fluid_directory_"),this[Bt]="SharedDirectory",this.root=new Wt({seq:0,clientSeq:0},new Set,this,this.runtime,this.serializer,Lt.sep,this.logger),this.messageHandlers=new Map,this.localValueMaker=new Dt(this.serializer),this.setMessageHandlers(),this.root.on("containedValueChanged",((e,t)=>{this.emit("containedValueChanged",e,t,this)})),this.root.on("subDirectoryCreated",((e,t)=>{this.emit("subDirectoryCreated",e,t,this)})),this.root.on("subDirectoryDeleted",((e,t)=>{this.emit("subDirectoryDeleted",e,t,this)}))}get(e){return this.root.get(e)}set(e,t){return this.root.set(e,t),this}dispose(e){this.root.dispose(e)}get disposed(){return this.root.disposed}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[(Bt=Symbol.toStringTag,Symbol.iterator)](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}countSubDirectory(){return this.root.countSubDirectory()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){const t=this.makeAbsolute(e);if(t===Lt.sep)return this.root;let r=this.root;const n=t.slice(1).split(Lt.sep);for(const o of n)if(r=r.getSubDirectory(o),!r)return;return r}summarizeCore(e,t){return this.serializeDirectory(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}onDisconnect(){}reSubmitCore(e,t){const r=e,o=this.messageHandlers.get(r.type);(0,n.v)(void 0!==o,13),o.submit(r,t)}async loadCore(e){const t=await(0,s.P)(e,At),r=t;Array.isArray(r.blobs)?(this.populate(r.content),await Promise.all(r.blobs.map((async t=>{const r=await(0,s.P)(e,t);this.populate(r)})))):this.populate(t)}populate(e){const t=[];for(t.push([this.root,e]);t.length>0;){const[e,r]=t.pop();if(r.subdirectories){const n=new Map;for(const[o,i]of Object.entries(r.subdirectories)){let r,s=e.getSubDirectory(o);if(!s){const t=i.ci;if(void 0!==t&&t.csn>0){n.has(t.csn)||n.set(t.csn,0);let e=n.get(t.csn);r={seq:t.csn,clientSeq:e},n.set(t.csn,++e)}else r={seq:0,clientSeq:++e.localCreationSeq};s=new Wt(r,void 0!==t?new Set(t.ccIds):new Set,this,this.runtime,this.serializer,Lt.join(e.absolutePath,o),this.logger),e.populateSubDirectory(o,s),e.ackedCreationSeqTracker.set(o,{...r})}t.push([s,i])}}if(r.storage)for(const[t,n]of Object.entries(r.storage)){const r=this.makeLocal(t,e.absolutePath,n);e.populateStorage(t,r)}}}processCore(e,t,r){if(e.type===a.Go.Operation){const o=e.contents,i=this.messageHandlers.get(o.type);(0,n.v)(void 0!==i,14),i.process(e,o,t,r)}}rollback(e,t){const r=e,n=this.getWorkingDirectory(r.path);n&&n.rollback(r,t)}makeAbsolute(e){return Lt.resolve(Lt.sep,e)}makeLocal(e,t,r){return(0,n.v)(r.type===wt[wt.Plain]||r.type===wt[wt.Shared],484),this.localValueMaker.fromSerializable(r)}isSubDirectoryDeletePending(e){const t=this.makeAbsolute(e);if(t===Lt.sep)return!1;let r=this.root;const n=t.split(Lt.sep);let o=1;for(;o<n.length;){const e=n[o];if(r.isSubDirectoryDeletePending(e))return!0;if(r=r.getSubDirectory(e),void 0===r)return!0;o+=1}return!1}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,r,n)=>{const o=this.getWorkingDirectory(t.path);o&&!this.isSubDirectoryDeletePending(t.path)&&o.processClearMessage(e,t,r,n)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitClearMessage(e,t)},applyStashedOp:e=>{const t=this.getWorkingDirectory(e.path);if(t)return t.applyStashedClearMessage(e)}}),this.messageHandlers.set("delete",{process:(e,t,r,n)=>{const o=this.getWorkingDirectory(t.path);o&&!this.isSubDirectoryDeletePending(t.path)&&o.processDeleteMessage(e,t,r,n)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)},applyStashedOp:e=>{const t=this.getWorkingDirectory(e.path);if(t)return t.applyStashedDeleteMessage(e)}}),this.messageHandlers.set("set",{process:(e,t,r,n)=>{const o=this.getWorkingDirectory(t.path);if(o&&!this.isSubDirectoryDeletePending(t.path)){const i=r?void 0:this.makeLocal(t.key,t.path,t.value);o.processSetMessage(e,t,i,r,n)}},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)},applyStashedOp:e=>{const t=this.getWorkingDirectory(e.path);if(t){const r=this.makeLocal(e.key,e.path,e.value);return t.applyStashedSetMessage(e,r)}}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,r,n)=>{const o=this.getWorkingDirectory(t.path);o&&!this.isSubDirectoryDeletePending(t.path)&&o.processCreateSubDirectoryMessage(e,t,r,n)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)},applyStashedOp:e=>{const t=this.getWorkingDirectory(e.path);if(t)return t.applyStashedCreateSubDirMessage(e)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,r,n)=>{const o=this.getWorkingDirectory(t.path);o&&!this.isSubDirectoryDeletePending(t.path)&&o.processDeleteSubDirectoryMessage(e,t,r,n)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)},applyStashedOp:e=>{const t=this.getWorkingDirectory(e.path);if(t)return t.applyStashedDeleteSubDirMessage(e)}})}applyStashedOp(e){const t=this.messageHandlers.get(e.type);if(void 0===t)throw new Error("no apply stashed op handler");return t.applyStashedOp(e)}serializeDirectory(e,t,r){const n=new Q;let o=0;const i=[],s=[],a={};for(s.push([e,a]);s.length>0;){const[e,r]=s.pop();r.ci=e.getSerializableCreateInfo();for(const[s,a]of e.getSerializedStorage(t)){r.storage||(r.storage={});const t={type:a.type,value:a.value&&JSON.parse(a.value)};if(a.value&&a.value.length>=8192){const r={};let a=r;if(e.absolutePath!==Lt.sep)for(const t of e.absolutePath.slice(1).split(Lt.sep)){const e={};a.subdirectories={[t]:e},a=e}a.storage={[s]:t};const c="blob".concat(o);o++,i.push(c),n.addBlob(c,JSON.stringify(r))}else r.storage[s]=t}for(const[t,n]of e.subdirectories()){r.subdirectories||(r.subdirectories={});const e={};r.subdirectories[t]=e,s.push([n,e])}}const c={blobs:i,content:a};return n.addBlob(At,JSON.stringify(c)),n.getSummaryTree()}}function Ut(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&"edit"===e.type}function jt(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId&&"object"===typeof e.previousStorage}function qt(e){return void 0!==e&&("createSubDir"===e.type||"deleteSubDir"===e.type)}function Vt(e){(0,n.v)(null!==e,1711)}let Gt=!1;class Wt extends o.X{constructor(e,t,r,n,o,i,s){super(),this.seqData=e,this.clientIds=t,this.directory=r,this.runtime=n,this.serializer=o,this.absolutePath=i,this.logger=s,this._deleted=!1,this[xt]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingDeleteSubDirectoriesTracker=new Map,this.pendingCreateSubDirectoriesTracker=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localCreationSeq=0,this.localCreationSeqTracker=new zt,this.ackedCreationSeqTracker=new zt}dispose(e){this._deleted=!0,this.emit("disposed",this)}undispose(){this._deleted=!1,this.emit("undisposed",this)}get disposed(){return this._deleted}throwIfDisposed(){if(this._deleted)throw new i.eb("Cannot access Disposed subDirectory")}has(e){return this.throwIfDisposed(),this._storage.has(e)}get(e){var t;return this.throwIfDisposed(),null===(t=this._storage.get(e))||void 0===t?void 0:t.value}set(e,t){if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("Undefined and null keys are not supported");const r=this.directory.localValueMaker.fromInMemory(t),n=Nt(r,this.serializer,this.directory.handle),o=this.setCore(e,r,!0);if(!this.directory.isAttached())return this;const i={key:e,path:this.absolutePath,type:"set",value:n};return this.submitKeyMessage(i,o),this}countSubDirectory(){return this._subdirectories.size}createSubDirectory(e){var t;if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(Lt.sep))throw new Error("SubDirectory name may not contain ".concat(Lt.sep));const r=this.createSubDirectoryCore(e,!0,this.getLocalSeq(),null!==(t=this.runtime.clientId)&&void 0!==t?t:"detached"),o=this._subdirectories.get(e);if((0,n.v)(void 0!==o,1450),!this.directory.isAttached())return o;if(r){const t={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};this.submitCreateSubDirectoryMessage(t)}return o}getLocalSeq(){return this.directory.isAttached()?{seq:-1,clientSeq:++this.localCreationSeq}:{seq:0,clientSeq:++this.localCreationSeq}}getSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.get(e)}hasSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.has(e)}deleteSubDirectory(e){this.throwIfDisposed();const t=this.deleteSubDirectoryCore(e,!0);if(!this.directory.isAttached())return void 0!==t;if(void 0!==t){const r={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};this.submitDeleteSubDirectoryMessage(r,t)}return void 0!==t}subdirectories(){this.throwIfDisposed();const e=[...this.ackedCreationSeqTracker.keys(),...this.localCreationSeqTracker.keys((e=>!this.ackedCreationSeqTracker.has(e)))];if(e.length!==this._subdirectories.size)return Gt||(this.logger.sendTelemetryEvent({eventName:"inconsistentSubdirectoryOrdering",localKeyCount:this.localCreationSeqTracker.size,ackedKeyCount:this.ackedCreationSeqTracker.size,subdirNamesLength:e.length,subdirectoriesSize:this._subdirectories.size}),Gt=!0),this._subdirectories.entries();return{index:0,dirs:this._subdirectories,next(){if(this.index<e.length){const t=e[this.index++];return{value:[t,this.dirs.get(t)],done:!1}}return{value:void 0,done:!0}},[Symbol.iterator](){return this}}}getWorkingDirectory(e){return this.throwIfDisposed(),this.directory.getWorkingDirectory(this.makeAbsolute(e))}isSubDirectoryDeletePending(e){return!!this.pendingDeleteSubDirectoriesTracker.has(e)}delete(e){this.throwIfDisposed();const t=this.deleteCore(e,!0);if(!this.directory.isAttached())return void 0!==t;const r={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(r,t),void 0!==t}clear(){if(this.throwIfDisposed(),!this.directory.isAttached())return void this.clearCore(!0);const e=new Map(this._storage);this.clearCore(!0);const t={path:this.absolutePath,type:"clear"};this.submitClearMessage(t,e)}forEach(e){this.throwIfDisposed(),this._storage.forEach(((t,r,n)=>{e(t.value,r,n)}))}get size(){return this.throwIfDisposed(),this._storage.size}entries(){this.throwIfDisposed();const e=this._storage.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}keys(){return this.throwIfDisposed(),this._storage.keys()}values(){this.throwIfDisposed();const e=this._storage.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[(xt=Symbol.toStringTag,Symbol.iterator)](){return this.throwIfDisposed(),this.entries()}processClearMessage(e,t,r,o){if(this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e))if(r){(0,n.v)(jt(o),15);const e=this.pendingClearMessageIds.shift();(0,n.v)(e===o.pendingMessageId,810)}else this.clearExceptPendingKeys(!1)}applyStashedClearMessage(e){this.throwIfDisposed();const t=new Map(this._storage);this.clearExceptPendingKeys(!0);const r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);return{type:"clear",pendingMessageId:r,previousStorage:t}}processDeleteMessage(e,t,r,n){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,r,n)&&this.deleteCore(t.key,r)}applyStashedDeleteMessage(e){this.throwIfDisposed();const t=this.deleteCore(e.key,!0);return{type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t}}processSetMessage(e,t,r,n,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,n,o)&&this.setCore(t.key,r,n)}applyStashedSetMessage(e,t){this.throwIfDisposed();const r=this.setCore(e.key,t,!0);return{type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:r}}processCreateSubDirectoryMessage(e,t,r,n){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,n)&&(Vt(e.clientId),this.createSubDirectoryCore(t.subdirName,r,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber},e.clientId))}applyStashedCreateSubDirMessage(e){var t;this.throwIfDisposed(),this.createSubDirectoryCore(e.subdirName,!0,this.getLocalSeq(),null!==(t=this.runtime.clientId)&&void 0!==t?t:"detached"),this.updatePendingSubDirMessageCount(e);return{type:"createSubDir"}}processDeleteSubDirectoryMessage(e,t,r,n){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,n)&&this.deleteSubDirectoryCore(t.subdirName,r)}applyStashedDeleteSubDirMessage(e){this.throwIfDisposed();const t=this.deleteSubDirectoryCore(e.subdirName,!0);this.updatePendingSubDirMessageCount(e);return{type:"deleteSubDir",subDirectory:t}}submitClearMessage(e,t){this.throwIfDisposed();const r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);const n={type:"clear",pendingMessageId:r,previousStorage:t};this.directory.submitDirectoryMessage(e,n)}resubmitClearMessage(e,t){(0,n.v)(jt(t),811);this.pendingClearMessageIds.shift()===t.pendingMessageId&&this.submitClearMessage(e,t.previousStorage)}getKeyMessageId(e){const t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return void 0!==r?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitKeyMessage(e,t){this.throwIfDisposed();const r={type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t};this.directory.submitDirectoryMessage(e,r)}resubmitKeyMessage(e,t){(0,n.v)(Ut(t),813);const r=this.pendingKeys.get(e.key);if(void 0!==r){const n=r.findIndex((e=>e===t.pendingMessageId));if(-1===n)return;r.splice(n,1),0===r.length&&this.pendingKeys.delete(e.key),this.submitKeyMessage(e,t.previousValue)}}incrementPendingSubDirCount(e,t){var r;const n=null!==(r=e.get(t))&&void 0!==r?r:0;e.set(t,n+1)}decrementPendingSubDirCount(e,t){var r;const n=null!==(r=e.get(t))&&void 0!==r?r:0;e.set(t,n-1),n<=1&&e.delete(t)}updatePendingSubDirMessageCount(e){"deleteSubDirectory"===e.type?this.incrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName):"createSubDirectory"===e.type&&this.incrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName)}submitCreateSubDirectoryMessage(e){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);this.directory.submitDirectoryMessage(e,{type:"createSubDir"})}submitDeleteSubDirectoryMessage(e,t){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);const r={type:"deleteSubDir",subDirectory:t};this.directory.submitDirectoryMessage(e,r)}resubmitSubDirectoryMessage(e,t){(0,n.v)(qt(t),815),("createSubDir"!==t.type||this.pendingCreateSubDirectoriesTracker.has(e.subdirName))&&("deleteSubDir"!==t.type||this.pendingDeleteSubDirectoriesTracker.has(e.subdirName))&&("createSubDir"===t.type?(this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName),this.submitCreateSubDirectoryMessage(e)):(this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName),this.submitDeleteSubDirectoryMessage(e,t.subDirectory)))}*getSerializedStorage(e){this.throwIfDisposed();for(const[t,r]of this._storage){const n=[t,r.makeSerialized(e,this.directory.handle)];yield n}}getSerializableCreateInfo(){this.throwIfDisposed();return{csn:this.seqData.seq,ccIds:Array.from(this.clientIds)}}populateStorage(e,t){this.throwIfDisposed(),this._storage.set(e,t)}populateSubDirectory(e,t){this.throwIfDisposed(),this._subdirectories.set(e,t)}getLocalValue(e){return this.throwIfDisposed(),this._storage.get(e)}rollbackPendingMessageId(e,t,r){const n=e.get(t),o=null===n||void 0===n?void 0:n.pop();if(!n||o!==r)throw new Error("Rollback op does not match last pending");0===n.length&&e.delete(t)}rollback(e,t){if(!(Ut(r=t)||jt(r)||qt(r)))throw new Error("Invalid localOpMetadata");var r;if("clear"===e.type&&"clear"===t.type){for(const[r,n]of t.previousStorage.entries())this.setCore(r,n,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if("delete"!==e.type&&"set"!==e.type||"edit"!==t.type)if("createSubDirectory"===e.type&&"createSubDir"===t.type)this.deleteSubDirectoryCore(e.subdirName,!0),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName);else{if("deleteSubDirectory"!==e.type||"deleteSubDir"!==t.type)throw new Error("Unsupported op for rollback");void 0!==t.subDirectory&&(this.undeleteSubDirectoryTree(t.subDirectory),this._subdirectories.set(e.subdirName,t.subDirectory),_t(t.subDirectory.seqData)?this.ackedCreationSeqTracker.set(e.subdirName,{...t.subDirectory.seqData}):this.localCreationSeqTracker.set(e.subdirName,{...t.subDirectory.seqData}),this.emit("subDirectoryCreated",e.subdirName,!0,this)),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subDirName)}else void 0===t.previousValue?this.deleteCore(e.key,!0):this.setCore(e.key,t.previousValue,!0),this.rollbackPendingMessageId(this.pendingKeys,e.key,t.pendingMessageId)}makeAbsolute(e){return Lt.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,r){if(this.pendingClearMessageIds.length>0){if(t){(0,n.v)(void 0!==r&&Ut(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],16);const t=this.pendingClearMessageIds[0],o=this.pendingKeys.get(e.key);if(void 0!==o){let r=0;for(;o[r]<t;)r+=1;const n=o.splice(r);0===n.length?this.pendingKeys.delete(e.key):this.pendingKeys.set(e.key,n)}}return!1}const o=this.pendingKeys.get(e.key);return void 0!==o?(t&&((0,n.v)(void 0!==r&&Ut(r),17),(0,n.v)(o[0]===r.pendingMessageId,817),o.shift(),0===o.length&&this.pendingKeys.delete(e.key)),!1):!t}isMessageForCurrentInstanceOfSubDirectory(e){return null!==e.clientId&&this.clientIds.has(e.clientId)||this.clientIds.has("detached")||-1!==this.seqData.seq&&this.seqData.seq<=e.referenceSequenceNumber}needProcessSubDirectoryOperation(e,t,r,o){Vt(e.clientId);const i=this.pendingDeleteSubDirectoriesTracker.get(t.subdirName),s=this.pendingCreateSubDirectoriesTracker.get(t.subdirName);if(void 0!==i&&i>0||void 0!==s&&s>0){if(r&&((0,n.v)(qt(o),18),"deleteSubDir"===o.type?((0,n.v)(void 0!==i&&i>0,1730),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,t.subdirName)):"createSubDir"===o.type&&((0,n.v)(void 0!==s&&s>0,1731),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,t.subdirName))),"deleteSubDirectory"===t.type){const e=t=>{if(!t)return;t.clearExceptPendingKeys(r),t.seqData.seq=-1,t.seqData.clientSeq=-1,t.clientIds.clear();const n=t.subdirectories();for(const[r,o]of n)t.pendingCreateSubDirectoriesTracker.has(r)?e(o):t.deleteSubDirectoryCore(r,!1)},n=this._subdirectories.get(t.subdirName);this.ackedCreationSeqTracker.delete(t.subdirName),e(n)}if("createSubDirectory"===t.type){const n=this._subdirectories.get(t.subdirName);-1!==this.seqData.seq&&this.seqData.seq<=e.sequenceNumber&&(-1===(null===n||void 0===n?void 0:n.seqData.seq)&&(n.seqData.seq=e.sequenceNumber,n.seqData.clientSeq=e.clientSequenceNumber,this.ackedCreationSeqTracker.has(t.subdirName)||this.pendingDeleteSubDirectoriesTracker.has(t.subdirName)||(this.ackedCreationSeqTracker.set(t.subdirName,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber}),r&&this.localCreationSeqTracker.delete(t.subdirName))),void 0!==n&&!n.clientIds.has(e.clientId)&&n.seqData.seq<=e.sequenceNumber&&n.clientIds.add(e.clientId))}return!1}return!r}clearExceptPendingKeys(e){const t=new Map;for(const[r]of this.pendingKeys){const e=this._storage.get(r);void 0!==e&&t.set(r,e)}this.clearCore(e);for(const[r,n]of t.entries())this.setCore(r,n,!0)}clearCore(e){this._storage.clear(),this.directory.emit("clear",e,this.directory)}deleteCore(e,t){const r=this._storage.get(e),n=null===r||void 0===r?void 0:r.value;if(this._storage.delete(e)){const r={key:e,path:this.absolutePath,previousValue:n};this.directory.emit("valueChanged",r,t,this.directory);const o={key:e,previousValue:n};this.emit("containedValueChanged",o,t,this)}return r}setCore(e,t,r){const n=this._storage.get(e),o=null===n||void 0===n?void 0:n.value;this._storage.set(e,t);const i={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",i,r,this.directory);const s={key:e,previousValue:o};return this.emit("containedValueChanged",s,r,this),n}createSubDirectoryCore(e,t,r,n){const o=this._subdirectories.get(e);if(void 0===o){const o=Lt.join(this.absolutePath,e),i=new Wt({...r},new Set([n]),this.directory,this.runtime,this.serializer,o,this.logger);return _t(r)?this.ackedCreationSeqTracker.set(e,{...r}):this.localCreationSeqTracker.set(e,{...r}),this.registerEventsOnSubDirectory(i,e),this._subdirectories.set(e,i),this.emit("subDirectoryCreated",e,t,this),!0}return o.clientIds.add(n),!1}registerEventsOnSubDirectory(e,t){e.on("subDirectoryCreated",((e,r)=>{this.emit("subDirectoryCreated",Lt.join(t,e),r,this)})),e.on("subDirectoryDeleted",((e,r)=>{this.emit("subDirectoryDeleted",Lt.join(t,e),r,this)}))}deleteSubDirectoryCore(e,t){const r=this._subdirectories.get(e);return void 0!==r&&(this._subdirectories.delete(e),this.ackedCreationSeqTracker.has(e)&&this.ackedCreationSeqTracker.delete(e),this.localCreationSeqTracker.has(e)&&this.localCreationSeqTracker.delete(e),this.disposeSubDirectoryTree(r),this.emit("subDirectoryDeleted",e,t,this)),r}disposeSubDirectoryTree(e){if(!e)return;const t=e.subdirectories();for(const[r,n]of t)this.disposeSubDirectoryTree(n);"function"===typeof e.dispose&&e.dispose()}undeleteSubDirectoryTree(e){e.undispose();for(const[t,r]of e.subdirectories())this.undeleteSubDirectoryTree(r)}}function Kt(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&("add"===e.type||"edit"===e.type)}function Jt(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId}function Qt(e,t,r){return{type:"clear",pendingMessageId:t,previousMap:r}}function Xt(e,t,r){return r?{type:"edit",pendingMessageId:t,previousValue:r}:{type:"add",pendingMessageId:t}}class Zt{get size(){return this.data.size}constructor(e,t,r,n,o){this.serializer=e,this.handle=t,this.submitMessage=r,this.isAttached=n,this.eventEmitter=o,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localValueMaker=new Dt(e),this.messageHandlers=this.getMessageHandlers()}keys(){return this.data.keys()}entries(){const e=this.data.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){const e=this.data.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach(((t,r,n)=>{e(t.value,r,n)}))}get(e){const t=this.data.get(e);return void 0===t?void 0:t.value}has(e){return this.data.has(e)}set(e,t){if(void 0===e||null===e)throw new Error("Undefined and null keys are not supported");const r=this.localValueMaker.fromInMemory(t),n=Nt(r,this.serializer,this.handle),o=this.setCore(e,r,!0);if(!this.isAttached())return;const i={key:e,type:"set",value:n};this.submitMapKeyMessage(i,o)}delete(e){const t=this.deleteCore(e,!0);if(!this.isAttached())return void 0!==t;const r={key:e,type:"delete"};return this.submitMapKeyMessage(r,t),void 0!==t}clear(){const e=this.isAttached()?new Map(this.data):void 0;if(this.clearCore(!0),this.pendingKeys.clear(),!this.isAttached())return;this.submitMapClearMessage({type:"clear"},e)}getSerializedStorage(e){const t={};for(const[r,n]of this.data.entries())t[r]=n.makeSerialized(e,this.handle);return t}getSerializableStorage(e){const t={};for(const[r,n]of this.data.entries())t[r]=Nt(n,e,this.handle);return t}serialize(e){return JSON.stringify(this.getSerializableStorage(e))}populateFromSerializable(e){for(const[t,r]of Object.entries(e)){const e={key:t,value:this.makeLocal(t,r)};this.data.set(e.key,e.value)}}populate(e){this.populateFromSerializable(JSON.parse(e))}trySubmitMessage(e,t){const r=this.messageHandlers.get(e.type);return void 0!==r&&(r.submit(e,t),!0)}tryApplyStashedOp(e){const t=this.messageHandlers.get(e.type);if(void 0===t)throw new Error("no apply stashed op handler");return t.applyStashedOp(e)}tryProcessMessage(e,t,r){const n=this.messageHandlers.get(e.type);return void 0!==n&&(n.process(e,t,r),!0)}rollback(e,t){if(void 0===(r=t)||"number"!==typeof r.pendingMessageId||"add"!==r.type&&"edit"!==r.type&&"clear"!==r.type)throw new Error("Invalid localOpMetadata");var r;if("clear"===e.type&&"clear"===t.type){if(void 0===t.previousMap)throw new Error("Cannot rollback without previous map");for(const[r,n]of t.previousMap.entries())this.setCore(r,n,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else{if("delete"!==e.type&&"set"!==e.type)throw new Error("Unsupported op for rollback");{if("add"===t.type)this.deleteCore(e.key,!0);else{if("edit"!==t.type||void 0===t.previousValue)throw new Error("Cannot rollback without previous value");this.setCore(e.key,t.previousValue,!0)}const r=this.pendingKeys.get(e.key),n=null===r||void 0===r?void 0:r.pop();if(!r||n!==t.pendingMessageId)throw new Error("Rollback op does not match last pending");0===r.length&&this.pendingKeys.delete(e.key)}}}setCore(e,t,r){const n=this.data.get(e),o=null===n||void 0===n?void 0:n.value;return this.data.set(e,t),this.eventEmitter.emit("valueChanged",{key:e,previousValue:o},r,this.eventEmitter),n}clearCore(e){this.data.clear(),this.eventEmitter.emit("clear",e,this.eventEmitter)}deleteCore(e,t){const r=this.data.get(e),n=null===r||void 0===r?void 0:r.value;return this.data.delete(e)&&this.eventEmitter.emit("valueChanged",{key:e,previousValue:n},t,this.eventEmitter),r}clearExceptPendingKeys(){const e=new Map;for(const t of this.pendingKeys.keys())this.data.has(t)&&e.set(t,this.data.get(t));this.clearCore(!1);for(const[t,r]of e.entries())this.setCore(t,r,!0)}makeLocal(e,t){if(t.type===wt[wt.Plain]||t.type===wt[wt.Shared])return this.localValueMaker.fromSerializable(t);throw new Error("Unknown local value type")}needProcessKeyOperation(e,t,r){if(this.pendingClearMessageIds.length>0)return t&&(0,n.v)(void 0!==r&&Kt(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],19),!1;const o=this.pendingKeys.get(e.key);return void 0!==o?(t&&((0,n.v)(void 0!==r&&Kt(r),20),(0,n.v)(o[0]===r.pendingMessageId,762),o.shift(),0===o.length&&this.pendingKeys.delete(e.key)),!1):!t}getMessageHandlers(){const e=new Map;return e.set("clear",{process:(e,t,r)=>{if(t){(0,n.v)(Jt(r),21);const e=this.pendingClearMessageIds.shift();(0,n.v)(e===r.pendingMessageId,763)}else this.pendingKeys.size>0?this.clearExceptPendingKeys():this.clearCore(t)},submit:(e,t)=>{(0,n.v)(Jt(t),764);const r=this.pendingClearMessageIds.shift();(0,n.v)(r===t.pendingMessageId,765),this.submitMapClearMessage(e,t.previousMap)},applyStashedOp:e=>{const t=new Map(this.data);return this.clearCore(!0),Qt(0,this.getMapClearMessageId(),t)}}),e.set("delete",{process:(e,t,r)=>{this.needProcessKeyOperation(e,t,r)&&this.deleteCore(e.key,t)},submit:(e,t)=>{this.resubmitMapKeyMessage(e,t)},applyStashedOp:e=>{const t=this.deleteCore(e.key,!0);return Xt(0,this.getMapKeyMessageId(e),t)}}),e.set("set",{process:(e,t,r)=>{if(!this.needProcessKeyOperation(e,t,r))return;const n=this.makeLocal(e.key,e.value);this.setCore(e.key,n,t)},submit:(e,t)=>{this.resubmitMapKeyMessage(e,t)},applyStashedOp:e=>{const t=this.makeLocal(e.key,e.value),r=this.setCore(e.key,t,!0);return Xt(0,this.getMapKeyMessageId(e),r)}}),e}getMapClearMessageId(){const e=++this.pendingMessageId;return this.pendingClearMessageIds.push(e),e}submitMapClearMessage(e,t){const r=Qt(0,this.getMapClearMessageId(),t);this.submitMessage(e,r)}getMapKeyMessageId(e){const t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return void 0!==r?r.push(t):this.pendingKeys.set(e.key,[t]),t}submitMapKeyMessage(e,t){const r=Xt(0,this.getMapKeyMessageId(e),t);this.submitMessage(e,r)}resubmitMapKeyMessage(e,t){(0,n.v)(Kt(t),766);const r=this.pendingKeys.get(e.key);if(void 0===r)return;const o=r.findIndex((e=>e===t.pendingMessageId));if(-1===o)return;r.splice(o,1),0===r.length&&this.pendingKeys.delete(e.key);const i=this.getMapKeyMessageId(e),s="edit"===t.type?{type:"edit",pendingMessageId:i,previousValue:t.previousValue}:{type:"add",pendingMessageId:i};this.submitMessage(e,s)}}var $t;const Yt="header";class er{get type(){return er.Type}get attributes(){return er.Attributes}async load(e,t,r,n){const o=new tr(t,e,n);return await o.load(r),o}create(e,t){const r=new tr(t,e,er.Attributes);return r.initializeLocal(),r}}er.Type="https://graph.microsoft.com/types/map",er.Attributes={type:er.Type,snapshotFormatVersion:"0.2",packageVersion:Ot};class tr extends kt{static create(e,t){return e.createChannel(t,er.Type)}static getFactory(){return new er}constructor(e,t,r){super(e,t,r,"fluid_map_"),this[$t]="SharedMap",this.kernel=new Zt(this.serializer,this.handle,((e,t)=>this.submitLocalMessage(e,t)),(()=>this.isAttached()),this)}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[($t=Symbol.toStringTag,Symbol.iterator)](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}summarizeCore(e,t){let r=0,n=0,o={};const i=[],s=new Q,a=this.kernel.getSerializedStorage(e);for(const l of Object.keys(a)){const e=a[l];if(e.value&&e.value.length>=8192){const t="blob".concat(n);n++,i.push(t);const r={[l]:{type:e.type,value:JSON.parse(e.value)}};s.addBlob(t,JSON.stringify(r))}else{if(r+=e.type.length+21,e.value&&(r+=e.value.length),r>16384){const e="blob".concat(n);n++,i.push(e),s.addBlob(e,JSON.stringify(o)),o={},r=0}o[l]={type:e.type,value:void 0===e.value?void 0:JSON.parse(e.value)}}}const c={blobs:i,content:o};return s.addBlob(Yt,JSON.stringify(c)),s.getSummaryTree()}async loadCore(e){const t=await(0,s.P)(e,Yt),r=t;Array.isArray(r.blobs)?(this.kernel.populateFromSerializable(r.content),await Promise.all(r.blobs.map((async t=>{const r=await(0,s.P)(e,t);this.kernel.populateFromSerializable(r)})))):this.kernel.populateFromSerializable(t)}onDisconnect(){}reSubmitCore(e,t){this.kernel.trySubmitMessage(e,t)}applyStashedOp(e){return this.kernel.tryApplyStashedOp(e)}processCore(e,t,r){e.type===a.Go.Operation&&this.kernel.tryProcessMessage(e.contents,t,r)}rollback(e,t){this.kernel.rollback(e,t)}}var rr;!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(rr||(rr={}));const nr={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let or;const ir=new Uint8Array(16);function sr(){if(!or&&(or="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!or))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return or(ir)}const ar=[];for(let Lr=0;Lr<256;++Lr)ar.push((Lr+256).toString(16).slice(1));function cr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ar[e[t+0]]+ar[e[t+1]]+ar[e[t+2]]+ar[e[t+3]]+"-"+ar[e[t+4]]+ar[e[t+5]]+"-"+ar[e[t+6]]+ar[e[t+7]]+"-"+ar[e[t+8]]+ar[e[t+9]]+"-"+ar[e[t+10]]+ar[e[t+11]]+ar[e[t+12]]+ar[e[t+13]]+ar[e[t+14]]+ar[e[t+15]]}const lr=function(e,t,r){if(nr.randomUUID&&!t&&!e)return nr.randomUUID();const n=(e=e||{}).random||(e.rng||sr)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return cr(n)};function dr(e){let t=e;return t.startsWith("/")&&(t=t.substr(1)),t.endsWith("/")&&(t=t.substr(0,t.length-1)),t.length>0?t.split("/"):[]}class ur{static flattenTree(e,t,r){for(const n in t.trees)ur.flattenTree("".concat(e).concat(n,"/"),t.trees[n],r);for(const n in t.blobs)r["".concat(e).concat(n)]=t.blobs[n]}constructor(e,t,r,n){this.tree=e,this.storage=t,this.logger=r,this.extraBlobs=n,this.flattenedTree={},void 0!==e&&ur.flattenTree("",e,this.flattenedTree)}async contains(e){return void 0!==this.flattenedTree[e]}async readBlob(e){const t=await this.getIdForPath(e),r=void 0!==this.extraBlobs?this.extraBlobs.get(t):void 0;if(void 0!==r)return r;const n=this.storage.readBlob(t);return n.catch((e=>this.logger.sendErrorEvent({eventName:"ChannelStorageBlobError"},e))),n}async list(e){var t,r;let n=this.tree;const o=dr(e);for(;void 0!==n&&o.length>0;){const e=o.shift();n=n.trees[e]}if(void 0===n||0!==o.length)throw new Error("path does not exist");return Object.keys(null!==(t=null===(r=n)||void 0===r?void 0:r.blobs)&&void 0!==t?t:{})}async getIdForPath(e){return this.flattenedTree[e]}}class hr{get handler(){return(0,n.v)(!!this._handler,375),this._handler}get connected(){return this._connected}constructor(e,t,r,n){this._connected=e,this.submit=t,this.dirty=r,this.addedGCOutboundReference=n}attach(e){(0,n.v)(void 0===this._handler,376),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}process(e,t,r){try{this.handler.process(e,t,r)}catch(n){throw i.I9.wrapIfUnrecognized(n,"channelDeltaConnectionFailedToProcessMessage",e)}}reSubmit(e,t){this.handler.reSubmit(e,t)}rollback(e,t){if(void 0===this.handler.rollback)throw new Error("Handler doesn't support rollback");this.handler.rollback(e,t)}applyStashedOp(e){return this.handler.applyStashedOp(e)}}const gr=".attributes";function pr(e,t,r,n,o,i,s,a){return{deltaConnection:new hr(e,((e,r)=>t(e,r)),r,n),objectStorage:new ur(s,o,i,a)}}function mr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;const o=e.getAttachSummary(t,r,n);return J(o,gr,JSON.stringify(e.attributes)),o}async function fr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const i=await e.summarize(t,r,n,o);return J(i,gr,JSON.stringify(e.attributes)),i}async function vr(e,t,r,n,o){var a;let c;await t.objectStorage.contains(gr)&&(c=await(0,s.P)(t.objectStorage,gr));const l=c?c.type:o;if(void 0===l)throw new i.EW("channelTypeNotAvailable",(0,v.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:l}));const d=n.get(l);if(void 0===d)throw new i.EW("channelFactoryNotRegisteredForGivenType",(0,v.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:l}));return c=null!==(a=c)&&void 0!==a?a:d.attributes,{factory:d,attributes:c}}async function yr(e,t,r,n,o,i){return void 0!==t.snapshotFormatVersion&&t.snapshotFormatVersion!==r.attributes.snapshotFormatVersion&&o.sendTelemetryEvent({eventName:"ChannelAttributesVersionMismatch",...(0,v.Df)({channelType:t.type,channelSnapshotVersion:"".concat(t.snapshotFormatVersion,"@").concat(t.packageVersion),channelCodeVersion:"".concat(r.attributes.snapshotFormatVersion,"@").concat(r.attributes.packageVersion)})}),r.load(e,i,n,t)}class br{constructor(e,t,r,o,i){this.id=e,this.runtime=t,this.services=r,this.channelP=o,this._channel=i,this.globallyVisible=!1,this.pending=[],(0,n.v)(!this.id.includes("/"),783)}async getChannel(){return void 0===this._channel?this.channelP.then((e=>this._channel=e)):this.channelP}get isLoaded(){return void 0!==this._channel}setConnectionState(e,t){this.globallyVisible&&this.isLoaded&&this.services.value.deltaConnection.setConnectionState(e)}processOp(e,t,r){(0,n.v)(this.globallyVisible,723),this.isLoaded?this.services.value.deltaConnection.process(e,t,r):((0,n.v)(!1===t,393),this.pending.push(e))}reSubmit(e,t){(0,n.v)(this.isLoaded,394),(0,n.v)(this.globallyVisible,724),this.services.value.deltaConnection.reSubmit(e,t)}rollback(e,t){(0,n.v)(this.isLoaded,750),(0,n.v)(this.globallyVisible,751),this.services.value.deltaConnection.rollback(e,t)}applyStashedOp(){throw new Error("no stashed ops on local channel")}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return fr(await this.getChannel(),e,t,r)}getAttachSummary(e){return(0,n.v)(void 0!==this._channel,397),mr(this._channel,!0,!1,e)}getAttachGCData(e){return(0,n.v)(void 0!==this._channel,"Local Channel should be loaded before being attached"),this._channel.getGCData(!0)}makeVisible(){if(this.globallyVisible)throw new Error("Channel is already globally visible");this.isLoaded&&((0,n.v)(!!this._channel,402),this._channel.connect(this.services.value)),this.globallyVisible=!0}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){}}class Sr extends br{constructor(e,t,r,n,o,s,a,c,l,d){super(e,r,new T.d((()=>{const e=new Map,t=kr(this.snapshotTree);return this.isSnapshotInOldFormatAndCollectBlobs(t,e)&&this.sanitizeSnapshot(t),pr(n.connected,a,this.dirtyFn,l,o,s,t,e)})),new T.I((async()=>{try{const{attributes:e,factory:o}=await vr(n,this.services.value,this.id,t),i=await yr(r,e,o,this.services.value,s,this.id);for(const t of this.pending)this.services.value.deltaConnection.process(t,!1,void 0);return i}catch(e){throw i.I9.wrapIfUnrecognized(e,"rehydratedLocalChannelContextFailedToLoadChannel",void 0)}}))),this.snapshotTree=d,this.dirtyFn=()=>{c(e)}}isSnapshotInOldFormatAndCollectBlobs(e,t){let r=!1;const n=e.blobsContents;void 0!==n&&Object.entries(n).forEach((n=>{let[o,i]=n;t.set(o,i),void 0!==e.blobs[o]&&(r=!0)}));for(const o of Object.values(e.trees))r=r||this.isSnapshotInOldFormatAndCollectBlobs(o,t);return r}sanitizeSnapshot(e){const t=new Map(Object.entries(e.blobs));for(const[r,n]of t.entries()){void 0===t.get(n)&&delete e.blobs[r]}for(const r of Object.values(e.trees))this.sanitizeSnapshot(r)}}class Cr extends br{constructor(e,t,r,n,o,i,s,a){super(e.id,t,new T.d((()=>pr(r.connected,i,this.dirtyFn,a,n,o))),Promise.resolve(e),e),this.channel=e,this.channel=e,this.dirtyFn=()=>{s(e.id)}}}function kr(e){const t={...e,blobs:{...e.blobs},trees:{}};for(const[r,n]of Object.entries(e.trees))t.trees[r]=kr(n);return t}class wr{constructor(e,t,r,o,i,s,a,c,l,d,u,h){this.id=a,this.isLoaded=!1,this.pending=[],(0,n.v)(!this.id.includes("/"),784),this.subLogger=(0,v.pW)({logger:e.logger,namespace:"RemoteChannelContext"}),this.services=pr(t.connected,o,(()=>i(this.id)),s,r,this.subLogger,c,d),this.channelP=new T.I((async()=>{const{attributes:r,factory:o}=await vr(t,this.services,this.id,l,h),i=await yr(e,r,o,this.services,this.subLogger,this.id);(0,n.v)(void 0!==this.pending,575);for(const e of this.pending)this.services.deltaConnection.process(e,!1,void 0);return this.thresholdOpsCounter.send("ProcessPendingOps",this.pending.length),this.channel=i,this.pending=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(t.connected),this.channel}));this.summarizerNode=u((async(e,t,r,n)=>this.summarizeInternal(e,t,r,n)),(async e=>this.getGCDataInternal(e))),this.thresholdOpsCounter=new Ce(wr.pendingOpsCountThreshold,this.subLogger)}getChannel(){return this.channelP}setConnectionState(e,t){this.isLoaded&&this.services.deltaConnection.setConnectionState(e)}applyStashedOp(e){return(0,n.v)(this.isLoaded,404),this.services.deltaConnection.applyStashedOp(e)}processOp(e,t,r){this.summarizerNode.invalidate(e.sequenceNumber),this.isLoaded?this.services.deltaConnection.process(e,t,r):((0,n.v)(!t,405),(0,n.v)(void 0!==this.pending,574),this.pending.push(e),this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pending.length))}reSubmit(e,t){(0,n.v)(this.isLoaded,406),this.services.deltaConnection.reSubmit(e,t)}rollback(e,t){(0,n.v)(this.isLoaded,752),this.services.deltaConnection.rollback(e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return this.summarizerNode.summarize(e,t,r)}async summarizeInternal(e,t,r,n){const o=await this.getChannel();return{...await fr(o,e,t,r,n),id:this.id}}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.summarizerNode.getGCData(e)}async getGCDataInternal(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){this.summarizerNode.updateUsedRoutes([""])}}var Pr;wr.pendingOpsCountThreshold=1e3,function(e){e.Attach="attach",e.ChannelOp="op"}(Pr||(Pr={}));class Er extends o.X{get connected(){return this.dataStoreContext.connected}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.clientDetails}get isAttached(){return this.attachState!==rr.Detached}get attachState(){return this._attachState}get absolutePath(){return(0,E.a)(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.IFluidHandleContext}get idCompressor(){return this.dataStoreContext.idCompressor}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}get logger(){return this.mc.logger}ensureNoDataModelChanges(e){return void 0===this.dataStoreContext.ensureNoDataModelChanges?e():this.dataStoreContext.ensureNoDataModelChanges(e)}constructor(e,t,r,o){var i;super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this._disposed=!1,this.contexts=new Map,this.pendingAttach=new Set,this.deferredAttached=new ue.c,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.pendingHandlesToMakeVisible=new Set,(0,n.v)(!e.id.includes("/"),782),this.mc=(0,y.CL)({logger:e.logger,namespace:"FluidDataStoreRuntime",properties:{all:{dataStoreId:lr()}}}),this.id=e.id,this.options=e.options,this.deltaManager=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();const s=e.baseSnapshot;void 0!==(null===s||void 0===s?void 0:s.trees)&&Object.keys(s.trees).forEach((t=>{if("_search"===t)return;let r;e.isLocalDataStore?(r=new Sr(t,this.sharedObjectRegistry,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,((e,r)=>this.submitChannelOp(t,e,r)),(e=>this.setChannelDirty(e)),((e,t)=>this.addedGCOutboundReference(e,t)),s.trees[t]),e.attachState!==rr.Detached?r.makeVisible():this.localChannelContextQueue.set(t,r)):r=new wr(this,e,e.storage,((e,r)=>this.submitChannelOp(t,e,r)),(e=>this.setChannelDirty(e)),((e,t)=>this.addedGCOutboundReference(e,t)),t,s.trees[t],this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(t,{type:C.nL.FromSummary})),this.contexts.set(t,r)})),this.entryPoint=new ye.a(new T.I((async()=>o(this))),"",this.objectsRoutingContext),this.attachListener(),this._attachState=e.attachState,this.visibilityState=r?e.attachState===rr.Detached?C.cy.LocallyVisible:C.cy.GloballyVisible:C.cy.NotVisible,r&&this.deferredAttached.resolve(),this.localChangesTelemetryCount=null!==(i=this.mc.config.getNumber("Fluid.Telemetry.LocalChangesTelemetryCount"))&&void 0!==i?i:10}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}async resolveHandle(e){return this.request(e)}async request(e){try{const r=_.X.create(e),n=r.pathParts[0];if("_channels"===n||"_custom"===n)return await this.request(r.createSubRequest(1));const o=this.contexts.get(n);if(void 0!==o&&r.isLeaf(1))try{return{mimeType:"fluid/object",status:200,value:await o.getChannel()}}catch(t){return this.mc.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},t),M(500,"Failed to get Channel: ".concat(t),e)}return R(e)}catch(t){return L(t)}}async getChannel(e){this.verifyNotClosed();const t=this.contexts.get(e);if(void 0===t)throw new O.iq("Channel does not exist");return t.getChannel()}addChannel(e){const t=e.id;if(t.includes("/"))throw new i.eb("Id cannot contain slashes: ".concat(t));this.verifyNotClosed(),(0,n.v)(!this.contexts.has(t),2149);const r=e.attributes.type;if(void 0===this.sharedObjectRegistry.get(e.attributes.type))throw new Error("Channel Factory ".concat(r," not registered"));this.createChannelContext(e),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",t,r)}createChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr(),t=arguments.length>1?arguments[1]:void 0;if(e.includes("/"))throw new i.eb("Id cannot contain slashes: ".concat(e));this.verifyNotClosed(),(0,n.v)(!this.contexts.has(e),377),(0,n.v)(void 0!==t,521);const r=this.sharedObjectRegistry.get(t);if(void 0===r)throw new Error("Channel Factory ".concat(t," not registered"));const o=r.create(this,e);return this.createChannelContext(o),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",e,t),o}createChannelContext(e){this.notBoundedChannelContextSet.add(e.id);const t=new Cr(e,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,((t,r)=>this.submitChannelOp(e.id,t,r)),(e=>this.setChannelDirty(e)),((e,t)=>this.addedGCOutboundReference(e,t)));this.contexts.set(e.id,t)}bindChannel(e){(0,n.v)(this.notBoundedChannelContextSet.has(e.id),379),this.notBoundedChannelContextSet.delete(e.id),this.isAttached?this.makeChannelLocallyVisible(e):this.pendingHandlesToMakeVisible.has(e.handle)||(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}makeVisibleAndAttachGraph(){this.visibilityState===C.cy.NotVisible&&(this.visibilityState=C.cy.LocallyVisible,this.pendingHandlesToMakeVisible.forEach((e=>{e.attachGraph()})),this.pendingHandlesToMakeVisible.clear(),this.dataStoreContext.makeLocallyVisible())}attachGraph(){this.makeVisibleAndAttachGraph()}bind(e){this.visibilityState===C.cy.NotVisible?this.pendingHandlesToMakeVisible.add(e):e.attachGraph()}setConnectionState(e,t){this.verifyNotClosed();for(const[,r]of this.contexts)r.setConnectionState(e,t);(0,B.aX)(this.logger,this,e,t)}getQuorum(){return this.quorum}getAudience(){return this.audience}async uploadBlob(e,t){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e,t)}createRemoteChannelContext(e,t){const r=new Map,n=(0,Se.X)(e.snapshot.entries,r);return new wr(this,this.dataStoreContext,this.dataStoreContext.storage,((t,r)=>this.submitChannelOp(e.id,t,r)),(e=>this.setChannelDirty(e)),((e,t)=>this.addedGCOutboundReference(e,t)),e.id,n,this.sharedObjectRegistry,r,this.dataStoreContext.getCreateChildSummarizerNodeFn(e.id,t),e.type)}process(e,t,r){this.verifyNotClosed();try{switch(e.type){case Pr.Attach:{const r=e.contents,o=r.id;if($(r.snapshot,((e,t)=>{var r,n;const i="/".concat(this.id,"/").concat(o).concat("/"===e?"":e);null===(r=(n=this.dataStoreContext).addedGCOutboundRoute)||void 0===r||r.call(n,i,t)})),t)(0,n.v)(this.pendingAttach.delete(o),380);else{(0,n.v)(!this.contexts.has(o),381);const t={type:C.nL.FromAttach,sequenceNumber:e.sequenceNumber,snapshot:r.snapshot},i=this.createRemoteChannelContext(r,t);this.contexts.set(o,i)}break}case Pr.ChannelOp:this.processChannelOp(e,t,r)}this.emit("op",e)}catch(o){throw i.I9.wrapIfUnrecognized(o,"fluidDataStoreRuntimeFailedToProcessMessage",e)}}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}getOutboundRoutes(){const e=[];for(const[t]of this.contexts)e.push("".concat(this.absolutePath,"/").concat(t));return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new ee;return await Promise.all(Array.from(this.contexts).filter((e=>{let[t,r]=e;return this.isChannelAttached(t)})).map((async r=>{let[n,o]=r;const i=await o.getGCData(e);t.prefixAndAddNodes(n,i.gcNodes)}))),this.updateGCNodes(t),t.getGCData()}updateUsedRoutes(e){const t=be(e);for(const[o]of t)(0,n.v)(this.contexts.has(o),382);for(const[n,o]of this.contexts){var r;o.updateUsedRoutes(null!==(r=t.get(n))&&void 0!==r?r:[])}}addedGCOutboundReference(e,t){var r,n;null===(r=(n=this.dataStoreContext).addedGCOutboundReference)||void 0===r||r.call(n,e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const o=new Q;return await Promise.all(Array.from(this.contexts).filter((e=>{let[t,r]=e;const o=this.isChannelAttached(t);return(0,n.v)(o,383),o})).map((async n=>{let[i,s]=n;const a=await s.summarize(e,t,r);o.addWithStats(i,a)}))),o.getSummaryTree()}getAttachSummary(e){const t=new Q;return this.visitLocalBoundContextsDuringAttach(((r,o)=>{let i;if(o.isLoaded){const t=o.getAttachSummary(e);(0,n.v)(t.summary.type===x.Z.Tree,384),i={stats:t.stats,summary:t.summary}}else(0,n.v)(!!this.dataStoreContext.baseSnapshot,385),i=X(this.dataStoreContext.baseSnapshot.trees[r]);t.addWithStats(r,i)})),t.getSummaryTree()}getAttachGCData(e){const t=new ee;return this.visitLocalBoundContextsDuringAttach(((r,n)=>{if(n.isLoaded){const o=n.getAttachGCData(e);t.prefixAndAddNodes(r,o.gcNodes)}})),this.updateGCNodes(t),t.getGCData()}visitLocalBoundContextsDuringAttach(e){this.attachGraph();for(const[t,r]of this.contexts){if(!(r instanceof br))throw new O.iq("Should only be called with local channel handles");this.notBoundedChannelContextSet.has(t)||e(t,r)}}submitMessage(e,t,r){this.submit(e,t,r)}submitSignal(e,t,r){return this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t,r)}async waitAttached(){return this.deferredAttached.promise}makeChannelLocallyVisible(e){if(this.verifyNotClosed(),e.handle.isAttached)return;e.handle.attachGraph(),(0,n.v)(this.isAttached,386),(0,n.v)(this.visibilityState===C.cy.GloballyVisible,720);const t=mr(e,!0,!1),r=e.getGCData(!0);J(t,C.xX,JSON.stringify(r));const o=Z(t.summary),i={id:e.id,snapshot:o,type:e.attributes.type};this.pendingAttach.add(e.id),this.submit(Pr.Attach,i);this.contexts.get(e.id).makeVisible()}submitChannelOp(e,t,r){const n={address:e,contents:t};this.submit(Pr.ChannelOp,n,r)}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,r)}reSubmit(e,t,r){switch(this.verifyNotClosed(),e){case Pr.ChannelOp:{const e=t,o=this.contexts.get(e.address);(0,n.v)(!!o,387),o.reSubmit(e.contents,r);break}case Pr.Attach:this.submit(e,t,r);break;default:(0,U.$)(e)}}rollback(e,t,r){switch(this.verifyNotClosed(),e){case Pr.ChannelOp:{const e=t,o=this.contexts.get(e.address);(0,n.v)(!!o,749),o.rollback(e.contents,r);break}default:throw new O.iq("Can't rollback ".concat(e," message"))}}async applyStashedOp(e){const t=null===e||void 0===e?void 0:e.type;switch(t){case Pr.Attach:{const t=e.content,r={type:C.nL.Local},n=this.createRemoteChannelContext(t,r);return this.pendingAttach.add(t.id),void this.contexts.set(t.id,n)}case Pr.ChannelOp:{const t=e.content,r=this.contexts.get(t.address);return(0,n.v)(!!r,388),await r.getChannel(),r.applyStashedOp(t.contents)}default:(0,U.$)(t)}}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}processChannelOp(e,t,r){this.verifyNotClosed();const o=e.contents,i={...e,contents:o.contents},s=this.contexts.get(o.address);return(0,n.v)(!!s,389),s.processOp(i,t,r),s}attachListener(){this.setMaxListeners(Number.MAX_SAFE_INTEGER),this.dataStoreContext.once("attaching",(()=>{this.attachGraph(),this._attachState=rr.Attaching,(0,n.v)(this.visibilityState===C.cy.LocallyVisible,721),this.visibilityState=C.cy.GloballyVisible,this.localChannelContextQueue.forEach((e=>{e.makeVisible()})),this.localChannelContextQueue.clear(),this.deferredAttached.resolve(),this.emit("attaching")})),this.dataStoreContext.once("attached",(()=>{(0,n.v)(this.visibilityState===C.cy.GloballyVisible,722),this._attachState=rr.Attached,this.emit("attached")}))}verifyNotClosed(){if(this._disposed)throw new O.iq("Runtime is closed")}identifyLocalChangeInSummarizer(e,t,r){"summarizer"!==this.clientDetails.type||this.localChangesTelemetryCount<=0||(this.mc.logger.sendTelemetryEvent({eventName:e,...(0,v.Df)({channelType:r,channelId:t,fluidDataStoreId:this.id,fluidDataStorePackagePath:this.dataStoreContext.packagePath.join("/")}),stack:(0,O.aX)()}),this.localChangesTelemetryCount--)}}const Tr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er;return class extends t{async request(t){const r=await super.request(t);return 404===r.status?e(t,this):r}}};async function Ir(e,t,r,o,i,s,a){var c,l;let d=i;d=Tr((async(e,t)=>{const r=await t.entryPoint.get();return(0,n.v)(void 0!==r.request,1941),r.request(e)}),d);const u=new d(t,r,s,(async e=>((0,n.v)(void 0!==h,1130),await h.finishInitialization(!0),h))),h=new e({runtime:u,context:t,providers:null!==(c=null===(l=t.scope.IFluidDependencySynthesizer)||void 0===l?void 0:l.synthesize(o,{}))&&void 0!==c?c:{},initProps:a});return s||await h.finishInitialization(s),{instance:h,runtime:u}}class Nr{constructor(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Er;if(this.type=e,this.ctor=t,this.optionalProviders=n,this.runtimeClass=i,""===this.type)throw new Error("undefined type member");void 0!==o&&(this.registry=new ce(o)),this.sharedObjectRegistry=new Map(r.map((e=>[e.type,e])))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}async instantiateDataStore(e,t){const{runtime:r}=await Ir(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,t);return r}async createChildInstance(e,t){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t)}async createPeerInstance(e,t){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t)}async createInstance(e,t){return this.createNonRootInstanceCore(e,[this.type],t)}async createRootInstance(e,t,r){const n=t.createDetachedRootDataStore([this.type],e);return this.createInstanceCore(n,r)}async createNonRootInstanceCore(e,t,r){const n=e.createDetachedDataStore(t);return this.createInstanceCore(n,r)}async createInstanceCore(e,t){const{instance:r,runtime:n}=await Ir(this.ctor,e,this.sharedObjectRegistry,this.optionalProviders,this.runtimeClass,!1,t);return await e.attachRuntime(this,n),r}}class Fr extends Nr{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Er;const s=[...r];r.find((e=>e.type===Rt.Type))||s.push(Ht.getFactory()),r.find((e=>e.type===er.Type))||s.push(tr.getFactory()),super(e,t,s,n,o,i)}}class Dr extends o.X{get id(){return this.runtime.id}get IFluidLoadable(){return this}get IFluidHandle(){return this.handle}get handle(){return(0,n.v)(void 0!==this.runtime.entryPoint,1131),this.runtime.entryPoint}static async getDataObject(e){return await e.entryPoint.get()}constructor(e){super(),this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps,(0,n.v)(void 0===this.runtime._dataObject,189),this.runtime._dataObject=this}async request(e){return""===e.url||"/"===e.url||e.url.startsWith("/?")?{mimeType:"fluid/object",status:200,value:this}:R(e)}async finishInitialization(e){return void 0!==this.initializeP||(this.initializeP=this.initializeInternal(e)),this.initializeP}async initializeInternal(e){var t;(await this.preInitialize(),e)?((0,n.v)(void 0===this.initProps,190),await this.initializingFromExisting()):await this.initializingFirstTime(null!==(t=this.context.createProps)&&void 0!==t?t:this.initProps);await this.hasInitialized()}async preInitialize(){}async initializingFirstTime(e){}async initializingFromExisting(){}async hasInitialized(){}}class Or extends Dr{constructor(){super(...arguments),this.rootDirectoryId="root"}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}async initializeInternal(e){e?(this.internalRoot=await this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===er.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=Ht.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),await super.initializeInternal(e)}getUninitializedErrorString(e){return"".concat(e," must be initialized before being accessed.")}}class Br{constructor(e,t,r){this.ctor=e,this.optionalProviders=t,this.type="LoopObject"}async instantiateLoopComponent(e,t){const r=this.optionalProviders&&(null===t||void 0===t?void 0:t.synthesize(this.optionalProviders,void 0))||void 0;return new this.ctor(e,r)}}class xr extends Fr{constructor(e,t,r,n,o,s,a){super(e,t,r,n,function(e){if(!e)return;const t=new Map;return e.forEach(((e,r)=>{"FluidObject"===e.factory.type&&t.set(r,e.factory.factory)})),t}(o),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Er;return Tr((async(e,t)=>(await Or.getDataObject(t)).request(e)),e)}(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Er;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er;return class extends t{addBlob(e,t,r){const n=t.shift();if(void 0===n)throw new O.iq("Path can't be empty");let o={type:x.Z.Blob,content:r};e.stats.blobNodeCount++,e.stats.totalBlobSize+=r.length;for(const i of t.reverse())o={type:x.Z.Tree,tree:{[i]:o}},e.stats.treeNodeCount++;e.summary.tree[n]=o}async summarize(){const t=await super.summarize(...arguments);try{const r=await e(this);void 0!==r&&this.addBlob(t,r.path,r.content)}catch(r){throw i.I9.wrapIfUnrecognized(r,"mixinSummaryHandler")}return t}}}((async e=>{const t=(await Or.getDataObject(e)).SearchContent;if(void 0===t)return;const r=await t.getSearchContent();if(void 0===r)return;return{path:["_search","01"],content:r.endsWith("\n")?r:r+"\n"}}),e)}(s))),this.registryEntries=o,this.contractAdapters=a}getSubComponentRegistryInfo(e){var t;return null===(t=this.registryEntries)||void 0===t?void 0:t.get(e)}get SubComponentRegistryDataProvider(){return this}}},37805:(e,t,r)=>{"use strict";r.d(t,{Ed:()=>a,FT:()=>s,TE:()=>o,mI:()=>i,pb:()=>l,sb:()=>c});var n=r(78632);function o(e,t){let r;return()=>{const n="undefined"!==typeof performance?performance.now():Date.now();if(void 0===r||n-r.cacheTime>t){const t=e();r={cacheTime:n,result:t},t.then((e=>{void 0===e&&(r=void 0)})).catch((()=>{r=void 0}))}return r.result}}function i(e){return t=>t*e}function s(e){return()=>e}function a(e){return t=>Math.pow(2,t)*e}function c(){return()=>!1}function l(e,t,r){return d(e,[],t,r)}function d(e,t,r,o){let i;const s=[e(t.length).then((e=>(i=e,!1)))];return o&&o.timeoutMs>0&&s.push((0,n.c)(o.timeoutMs).then((()=>!0))),Promise.race(s).then((s=>(s&&(i=o.onTimeout()),null===r||void 0===r||!r.filter(i)||t.length>=r.maxRetries?{result:i,tries:t}:(0,n.c)(r.backoffFn(t.length,i)).then((()=>(t.push(i),d(e,t,r,o)))))))}},78632:(e,t,r)=>{"use strict";function n(e){return new Promise((t=>setTimeout((()=>t()),e)))}function o(e,t){const r=n(e).then((e=>!0)),o=t.map((e=>e.then((e=>!1)).catch((e=>!1))));return Promise.race([r,...o])}r.d(t,{c:()=>n,t:()=>o})},93537:(e,t,r)=>{"use strict";r.d(t,{$e:()=>u,J5:()=>h,Ky:()=>l,qX:()=>c,sC:()=>d});var n=r(37805);const o=709,i=710;function s(){return"undefined"===typeof navigator||navigator.onLine}const a={durationMs:-1,body:null,bodyUsed:!1,headers:new Headers,ok:!1,redirected:!1,status:s()?i:o,statusText:"",type:"error",url:"",arrayBuffer:()=>Promise.resolve(new ArrayBuffer(0)),blob:()=>Promise.resolve(new Blob(void 0)),formData:()=>Promise.resolve(new FormData(void 0)),json:()=>Promise.resolve(void 0),text:()=>Promise.resolve(""),clone:()=>new Response};function c(e){return d(e)}function l(e){return u(e)}function d(e){return t=>e.includes(t.status)}function u(e){return t=>!e.includes(t.status)}function h(e,t,r){var c;let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:18e4,d=r;null!==r&&void 0!==r&&r.respectRetryAfterHeader&&(d={...r},d.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return r.backoffFn(e,t)});const u=new AbortController;var h;null!==t&&void 0!==t&&null!==(c=t.signal)&&void 0!==c&&c.aborted?u.abort(t.signal.reason):null===t||void 0===t||null===(h=t.signal)||void 0===h||h.addEventListener("abort",(function(){u.abort(this.reason)}));const g={...t,signal:u.signal};return(0,n.pb)((()=>{const t="undefined"!==typeof performance?performance.now():Date.now();return fetch(e,g).then((e=>{const r=e;return r.durationMs=Math.round(performance.now()-t),r})).catch((e=>{if(function(e,t){return e===(null===t||void 0===t?void 0:t.reason)||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,g.signal))throw e;let r="Error does not provide a message";return e.name&&e.message?r="Error type: ".concat(e.name,", ").concat(e.message):e.name?r="Error type: ".concat(e.name):e.message&&(r="Error message: ".concat(e.message)),{...a,status:s()?i:o,ok:!1,durationMs:Math.round(performance.now()-t),statusText:r}}))}),d,{timeoutMs:l,onTimeout:()=>(u.abort(),{...a,status:707,ok:!1,durationMs:l})})}},32896:(e,t,r)=>{"use strict";r.d(t,{a:()=>n});const n=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",i=3;return function s(){return o(e,t,r,n).catch((()=>(i-=1,0===i?o(e,t,r,n):s())))}()};async function o(e,t,r,n){return new Promise(((o,i)=>{var s,a;const c=e.document,l=c.createElement("script");l.setAttribute("fetchpriority",n);const d=null!==(s=null===r||void 0===r||null===(a=r.trustedTypesPolicy)||void 0===a?void 0:a.createScriptURL(t,{allowedScriptOrigins:r.allowedOrigins}))&&void 0!==s?s:t;l.src=d,l.async=!1,l.charset="utf-8",l.crossOrigin="anonymous",l.onload=o,l.onerror=()=>i(new Error("Failed to download the script at url: ".concat(t,", isUserDefinitelyOffline: ").concat(!e.navigator.onLine))),c.head.appendChild(l)}))}},62945:(e,t,r)=>{"use strict";var n;r.d(t,{j:()=>n}),function(e){e.themePropertiesChanged="themePropertiesChanged",e.textStylesChanged="textStylesChanged"}(n||(n={}))},31942:(e,t,r)=>{"use strict";var n;r.d(t,{S:()=>n}),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(n||(n={}))},16876:(e,t,r)=>{"use strict";var n,o,i;r.d(t,{Ej:()=>s,ZY:()=>n,qb:()=>o,vU:()=>a}),function(e){e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound"}(n||(n={})),function(e){e.RootComponentCreateFailed="RootComponentCreateFailed",e.RaasNotSupported="RaasNotSupported"}(o||(o={}));class s extends Error{constructor(e,t,r,n){if(super(e),this.internalError=r,this.name=t,n)try{this.stack=n}catch{}}}!function(e){e.UndefinedInitializeIframeMethod="UndefinedInitializeIframeMethod"}(i||(i={}));class a extends s{constructor(e,t,r,o){super(e,n.ComponentNotFound,t,o),this.code=r}}},78702:(e,t,r)=>{"use strict";var n,o;r.d(t,{Qq:()=>i,Tp:()=>o,hB:()=>n}),function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM"}(n||(n={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(o||(o={}));const i={Bool:"Bool",Int64:"Int64",Double:"Double"}},52059:(e,t,r)=>{"use strict";r.d(t,{$A:()=>i,JL:()=>n,ZV:()=>o,gE:()=>s});const n="@ms/planner-loop",o="Planner",i=300,s={policyId:"L_Loop_Planner",valueName:"LoopPlanner",registryDataType:"REG_DWORD",regKeyFullPath:"software\\policies\\microsoft\\office\\16.0\\common\\loop"}},33788:(e,t,r)=>{"use strict";r.d(t,{m:()=>a});var n=r(78702),o=r(51238),i=r(95996);const s=new Set;class a{static start(e,t,r){const n=new a(e,t,r);return s.add(n),n}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const r=this.subActivities[e];if(!r)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const n={["durationMs_".concat(e)]:Math.round(performance.now()-r.startTime)};this.logSubactivityStartTimes&&(n["startTime_".concat(e)]=r.startTimeSinceEpoch),this.additionalPropsToLog={...n,...this.additionalPropsToLog,...t}}setResult(e,t,r,n){this.logActivityResult(e,t,r,null===n||void 0===n?void 0:n.skipLogging,void 0,null===n||void 0===n?void 0:n.sampleEvent)}cancel(e,t,r){this.logActivityResult(e,t,r,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const r in this.subActivities)e(this.getSubActivityName(r,"start")),e(this.getSubActivityName(r,"end")),t(r)}}logActivityResult(e,t,r,o,a,c){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const l=performance.now(),d=Math.round(l-this.startTime);if(this.isAPerformanceMetric){(window._pageTimings||(window._pageTimings={}))[this.activityName]=null!==t&&void 0!==t&&t.durationMs?Number(t.durationMs):d}if(this.logger&&!o){const o={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:d,succeeded:e,sampleEvent:c,resultType:a?n.Tp.Cancelled:e?n.Tp.Success:n.Tp.Failure,...this.additionalPropsToLog,...t};(0,i.IA)(this.logger,o,r)}this.logger=void 0,s.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName="".concat(this.activityName).concat(!1===e?"-FAILED":"","-").concat(this.identifier),this.cachedMeasureName}getSubActivityName(e,t){return"".concat(e,"-").concat(t,"-").concat(this.identifier)}constructor(e,t,r){var n;this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null===r||void 0===r?void 0:r.additionalPropsToLog,this.addUserTiming=null===r||void 0===r?void 0:r.addUserTiming,this.isAPerformanceMetric=(null===r||void 0===r?void 0:r.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(n=null===r||void 0===r?void 0:r.logSubactivityStartTimes)||void 0===n||n,this.subActivities={},this.identifier=(0,o.A)(),this.activityStartName="".concat(this.activityName,"-start-").concat(this.identifier),this.activityEndName="".concat(this.activityName,"-end-").concat(this.identifier),this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}}},95996:(e,t,r)=>{"use strict";r.d(t,{LJ:()=>S,IA:()=>m,yL:()=>p,hO:()=>l,Ot:()=>c,o4:()=>f});var n=r(78702),o=r(83125),i=r(65317);const s=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function a(e){const t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((r=>{if(-1===r.toLowerCase().indexOf("message")&&-1===r.toLowerCase().indexOf("error")&&-1===r.toLowerCase().indexOf("stack")&&!1===s.includes(r))return;let n=e[r];void 0!==n&&"string"===typeof n&&(n=n.toString().replace(t,"scrubbed_email"),e[r]=(0,i.ku)(n.toString()))})),e}function c(e,t){const r=a(t);e.send({...r,category:n.hB.Generic})}function l(e,t,r){r&&y(t,r);const o=a(t);e.send({...o,category:n.hB.Error}),t.isUserImpacting&&v(e,o)}const d=new Set,u=new Set,h=new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]),g={Automation:!0,SyntheticTraffic:!0,Local:!0,Development:!0,Staging:!0,Dogfood:!0,Preview:!0,Microsoft:!0,Production:!1,GCC:!1,"GCC-High":!1,DoD:!1,USNat:!1,USSec:!1};function p(e,t,r){const n=r?h.get(r):.001;if(!n||Math.random()>n)return;const s=new o.p("Deprecated",e);t.stack||(t.stack=function(){var e;let t=b();null!==(e=t)&&void 0!==e&&e.startsWith("Error")&&(t=t.substring(5));return t}()),t.stack&&(t.stack=(0,i.ku)(t.stack.toString())),d.has(t.eventName)&&u.has(t.stack)||(c(s,t),d.add(t.eventName),u.add(t.stack))}function m(e,t,r){r&&y(t,r),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?n.Tp.Success:n.Tp.Failure);const o=a(t);e.send({...o,category:n.hB.Activity}),t.resultType===n.Tp.Failure&&t.isUserImpacting&&v(e,o)}function f(e,t){e.send({...t,category:n.hB.UserAction})}function v(e,t){var r,i;let s=e;const a=null===(r=(i=s).getNamespace)||void 0===r?void 0:r.call(i),c="".concat(a,"_").concat(t.eventName);s=new o.p("ContainerSession",e),s.send({...t,errorAction:c,category:n.hB.Error})}function y(e,t){!function(e,t){var r;const n=e=>"object"===typeof e&&null!==e,o="string"===typeof e?e:void 0;function i(t){if(!n(e))return;const r=e[t];return"string"===typeof r?r:void 0}t.message=null!==o&&void 0!==o?o:i("message"),t.errorMessage=null!==(r=null!==o&&void 0!==o?o:i("errorMessage"))&&void 0!==r?r:t.message,t.errorName=i("name"),t.stack=i("stack");const a=i("errorType");t.errorType=a||t.errorType,t.errorInstanceId=i("errorInstanceId"),s.forEach((r=>{if(n(e)){const n=e[r];"boolean"!==typeof n&&"number"!==typeof n&&"string"!==typeof n&&"undefined"!==typeof n||(t[r]=n),"object"===typeof n&&(t[r]=JSON.stringify(n))}}))}(t,e),e.message||(e.message=e.errorMessage),void 0===e.stack&&(e.stack=b())}function b(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}function S(e){return g[e]}},83125:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});class n{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this}dispose(){this.logger=null}addPersistedProperties(e){this.persistedProperties={...this.getPersistedProperties(),...e}}getPersistedProperties(){var e,t;return{...null===(e=this.baseLogger.PersistedProperties)||void 0===e||null===(t=e.getPersistedProperties)||void 0===t?void 0:t.call(e),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var r;null===(r=this.logger)||void 0===r||r.sendWithNamespace({...this.persistedProperties,...e},t)}getNamespace(){return this.namespace}constructor(e,t,r){if(this.namespace=e,t instanceof n){const e={...t.getPersistedProperties(),...r};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=r;this.baseLogger=t}}},93916:(e,t,r)=>{"use strict";r.d(t,{R:()=>o});var n=r(90589);const o=(e,t)=>{const r=function(e){const{value:t,tag:r}=null!==e&&"object"===typeof e?e:{value:e,tag:void 0};switch(r){case void 0:case"PackageData":case"CodeArtifact":return t;case"UserData":return"REDACTED (tag: UserData)";default:return"REDACTED (tag: ".concat(r,")")}}(e);if(void 0!==r)return"string"===typeof r?(0,n.m9)(t,r):"number"===typeof r?(0,n.ip)(t,r):(0,n.LK)(t,r)}},65317:(e,t,r)=>{"use strict";function n(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}r.d(t,{ku:()=>n})},76528:(e,t,r)=>{"use strict";r.d(t,{_y:()=>o,eP:()=>n});const n=()=>"undefined"===typeof window,o=()=>{var e;return!(null===(e=window.chrome)||void 0===e||!e.webview)}},83397:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(95996);const o=["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange"];class i{get isUserActive(){return this.isActive}dispose(){this.isActive=!0,clearTimeout(this.userInactiveTimerId),o.forEach((e=>{document.removeEventListener(e,this.userActivityCallback,{capture:!1})}))}onUserActivityDetected(){this.isActive||(this.isActive=!0,this.onUserActivityStateChange(!0),this.logger&&(0,n.Ot)(this.logger,{eventName:"UserActive"})),this.resetUserInactiveTimer()}resetUserInactiveTimer(){clearTimeout(this.userInactiveTimerId),this.startUserInactiveTimer()}startUserInactiveTimer(){this.userInactiveTimerId=setTimeout((()=>{this.isActive=!1,this.onUserActivityStateChange(!1),this.logger&&(0,n.Ot)(this.logger,{eventName:"UserInactive"})}),this.timeoutMs)}constructor(e,t,r){this.timeoutMs=e,this.onUserActivityStateChange=t,this.logger=r,this.isActive=!0,this.userActivityCallback=()=>{this.onUserActivityDetected()},o.forEach((e=>{document.addEventListener(e,this.userActivityCallback,{passive:!0,capture:!1})})),this.startUserInactiveTimer()}}},26308:(e,t,r)=>{"use strict";r.d(t,{b6:()=>l,v6:()=>c});var n=r(63990),o=r(52841);let i;const s="FluidSiteToAadTenantMapping";function a(){if(!i){let e;const t=(0,o.A)(),r=null===t||void 0===t?void 0:t.getItem(s);if(r)try{e=JSON.parse(r)}catch{null===t||void 0===t||t.removeItem(s)}i=new Map(e)}return i}function c(e){return a().get(e)}function l(e,t){const r=a(),n=r.get(e);r.set(e,{hostname:(null===n||void 0===n?void 0:n.hostname)||t.hostname,guid:(null===n||void 0===n?void 0:n.guid)||t.guid}),u()}let d=!1;function u(){d||(d=!0,(0,n.l)((()=>{try{var e;if(i)null===(e=(0,o.A)())||void 0===e||e.setItem(s,JSON.stringify(Array.from(i.entries())))}finally{d=!1}}),{ensureExecution:!0}))}},46624:(e,t,r)=>{"use strict";r.d(t,{DR:()=>n});const n="9188040d-6c67-4c5b-b112-36a304b66dad";new Set(["72f988bf-86f1-41af-91ab-2d7cd011db47","0000","f34444e5-e35c-4ceb-8a8b-7a0042451ccc","0a54704d-bba9-4e27-878e-fe460a591835","de21c301-a4ae-4292-aa09-6db710a590a6","49b6f6cd-6628-4bd2-8753-4d8c8a68fa04","fabbafd6-0003-4695-ada4-929dea5a0d36","5b73a072-2f1f-46ad-92ca-a9b3993e45aa","d4093791-9818-48dc-8880-35d134b8c79d","0d746a1c-f9a6-47a3-9d3a-4f3f1a79c0f6","13c6a44d-9b52-4b9e-aa34-0513ee7131f2","1f855c63-5a0d-47be-8300-914123519d11","21a4f3dd-ef15-47a5-bc51-1a31b80765be","26ed3691-0678-440d-9bc4-134f94a1beb1","35e07416-9027-4637-ae4d-72159981338a","3cbebbae-5ae7-4090-9654-f2df09940424","40ed3d74-3c8c-4399-866e-d1f7a95bb051","45c54e3f-1b2a-4a84-a2f5-5d5e86845726","4ad43d82-3f33-47ee-b8a0-273939d4570a","55ccf089-0e94-4a28-85df-629d0b273be1","6f6da031-e5cf-4e62-82cd-96636e80639e","73561903-7c11-4927-809d-b9a31fda7d61","78375574-4a4c-41a5-8b31-72e0374aa242","9188040d-6c67-4c5b-b112-36a304b66dad","a0effc3b-4ee4-4a46-9dcc-89fd35b439f6","af33e969-0b64-4c2d-bad6-329f25f2d990","b00367e2-193a-4f48-94de-7245d45c0947","b48595ab-4114-4783-883d-41872f68adfb","b68a597d-37e2-4254-a203-5fd9602367ee","c00cdc1a-23ab-45df-8a48-1f8d96fa2fab","c51071fb-f559-4967-ac4f-63ee879ca4ec","e1a132a4-2f3d-4ef5-9b14-2d4e94833544","e58c8e81-abd8-48a8-929d-eb67611b83bd","e73ba7cf-4e1b-40f5-805e-c3aae41e1b90","fc3fd415-e428-4884-bf6f-62c2e70a6682","8f474e12-1b0c-463d-a004-edbc2e2c72b0","6583636b-d156-492e-86ce-b8fccb790df1","91b036b7-fff3-4c61-8d5e-dba6d56268bd","7a55eed5-98d0-4f09-bf4e-17768961e804"])},74906:(e,t,r)=>{"use strict";r.d(t,{n:()=>v});var n=r(66206),o=r(48116),i=r(26308),s=r(87416),a=r(63990),c=r(95996),l=r(93537),d=r(29018),u=r(43172),h=r(46624);function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return arguments.length<=0?void 0:arguments[0]};const r=new Map;return{get(){const n=t(...arguments),o=r.get(n);if(o)return o.then();const i=e(...arguments);return r.set(n,i),i.catch((()=>{r.delete(n)})),i.then()},forceFetch:e,delete(){const e=t(...arguments);r.delete(e)}}}async function p(e,t){const r=new URL(e);if([n.i,o.t].includes(r.origin.toLowerCase()))return h.DR;const s=r.hostname.toLowerCase(),a=(0,i.v6)(s);return null!==a&&void 0!==a&&a.guid?a.guid:await async function(e,t,r){const n=await m.get(e,t,r);void 0===n&&m.delete(e,t,r);return n}(e,s,t)}const m=g((async(e,t,r)=>{let n,o;try{const r="".concat((0,d.$)(e),"/_api/v2.0/drives");let s;try{s=await(0,l.J5)(r,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"})}catch{n="Server did not respond"}s&&(o=(0,u.J)(s.result.headers),o?(0,i.b6)(t,{guid:o}):n="ODSP did not return tenant id in headers. Response status code: ".concat(s.result.status))}catch{n="Unexpected error"}return n&&r&&(0,c.Ot)(r,{eventName:"AadTenantNotFound",message:n}),o}),((e,t)=>t));const f=new Set;function v(e,t){const r=new URL(e);if([n.i,o.t].includes(r.origin.toLowerCase()))return"consumers";const c=r.hostname.toLowerCase(),l=(0,i.v6)(c);return null!==l&&void 0!==l&&l.guid?l.guid:l?l.hostname:(function(e,t){const r=new URL(e).hostname.toLowerCase();f.has(r)||(f.add(r),(0,a.l)((()=>{p(e,t).catch((()=>{})).finally((()=>f.delete(r)))}),{ensureExecution:!1}))}(e,t),(0,s.Xd)(e))}},87416:(e,t,r)=>{"use strict";r.d(t,{Xd:()=>u,p7:()=>s});var n=r(66206),o=r(48116),i=r(26308);const s="-my",a="-admin",c=".sharepoint.",l=".sharepoint-df.",d=".onmicrosoft.";function u(e){const t=new URL(e);if([n.i,o.t].includes(t.origin.toLowerCase()))return"consumers";const r=t.hostname.toLowerCase(),u=(0,i.v6)(r);if(u)return u.hostname;let h=r.substring(0,r.indexOf(".")),g=r.substring(h.length),p=!1;0===g.indexOf(c)?g="".concat(d).concat(g.substring(c.length)):0===g.indexOf(l)?g="".concat(d).concat(g.substring(l.length)):p=!0,h.endsWith(s)?h=h.substring(0,h.length-s.length):h.endsWith(a)&&(h=h.substring(0,h.length-a.length));const m=p?void 0:"".concat(h).concat(g);return(0,i.b6)(r,{hostname:m}),m}},82963:(e,t,r)=>{"use strict";r.d(t,{c:()=>d});var n=r(95996);const o=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft"],i=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],s=["https://res-dod.cdn.office.net","https://whiteboard.apps.mil"],a=["https://whiteboard.eaglex.ic.gov"],c=["https://whiteboard.microsoft.scloud"],l=[...o,...i,...s,...a,...c],d=(e,t,r)=>{var d;if(null===(d=null===t||void 0===t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))||void 0===d||d){let t;switch(e){case"DoD":t=s;break;case"GccHigh":t=i;break;case"USNat":t=a;break;case"USSec":t=c;break;default:t=o}return r&&((0,n.Ot)(r,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&(0,n.hO)(r,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return l}},68180:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});function n(e){try{const t=new URL(e),r=t.searchParams.get("nav");if(!r)return e;const n=window.atob(r),o=new URLSearchParams(n),i=o.get("c");if((null===i||void 0===i||!i.includes("deepLinkInfo"))&&(null===i||void 0===i||!i.includes("minified")))return e;o.set("c","");const s=o.toString(),a=window.btoa(s);return t.searchParams.set("nav",a),t.toString()}catch(t){return e}}},75460:(e,t,r)=>{"use strict";let n;r.d(t,{c:()=>o});class o{then(e,t){return this.p.then(e,t)}catch(e){return this.p.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isPending=!1,this.rej(e)}pending(){return this.isPending}finally(e){return this.p.finally(e)}constructor(){this[n]="Deferred",this.isPending=!0,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}}n=Symbol.toStringTag},16135:(e,t,r)=>{"use strict";function n(e){const t=o(null===e||void 0===e?void 0:e.audience);return t||(null!==e&&void 0!==e&&e.ring?e.ring:"Prod")}function o(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";default:return}}function i(e,t){var r;return e?n(e):null!==(r=o(t))&&void 0!==r?r:"Prod"}r.d(t,{H9:()=>i,Rs:()=>n})},76899:(e,t,r)=>{"use strict";r.d(t,{Fr:()=>l});var n=r(76528);let o,i,s;const a=function(){return void 0===o&&(o=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),o},c=function(){if(void 0===i){const e=navigator.userAgentData;i=null!==e&&void 0!==e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return i},l=function(){if((0,n.eP)())return!1;if(void 0===s){const e=navigator.userAgentData;if(null!==e&&void 0!==e&&e.mobile)return!0;s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||c()}return s}},22270:(e,t,r)=>{"use strict";r.d(t,{kN:()=>s});const n={...r(11374).k,clientSessionExpiredError:"clientSessionExpiredError"};var o;!function(e){e.genericError="genericError",e.throttlingError="throttlingError",e.dataCorruptionError="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(o||(o={}));var i=r(16876);function s(e){if("object"===typeof e){const t=e;if(function(e){var t;return e.errorType===i.ZY.ContainerUpgradeRequired&&(null===(t=e.error)||void 0===t?void 0:t.name)===i.ZY.ContainerUpgradeRequired}(t))return i.ZY.ContainerUpgradeRequired;if(function(e){return e.errorType===n.genericError}(t))return n.genericError;if(function(e){return e.errorType===n.throttlingError}(t))return n.throttlingError;const r=function(e){return Object.values(i.qb).find((t=>t===e.name||t===e.errorType))}(t);if(r)return r}}},11582:(e,t,r)=>{"use strict";r.d(t,{$T:()=>o});var n=r(41179);function o(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===n.a.genericError}(t))return n.a.genericError;if(function(e){return e.errorType===n.a.fileNotFoundOrAccessDeniedError}(t))return n.a.fileNotFoundOrAccessDeniedError;if(function(e){return e.errorType===n.a.authorizationError}(t))return n.a.authorizationError;if(function(e){return e.errorType===n.a.throttlingError}(t))return n.a.throttlingError}}},14357:(e,t,r)=>{"use strict";r.d(t,{N2:()=>s});var n=r(41179);const o={...n.a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"};var i;function s(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===o.outOfStorageError}(t))return o.outOfStorageError;if(function(e){return e.errorType===o.invalidFileNameError}(t))return o.invalidFileNameError;if(function(e){return e.errorType===o.snapshotTooBig}(t))return o.snapshotTooBig;if(function(e){return e.errorType===o.fetchTimeout}(t))return o.fetchTimeout;if(function(e){return e.errorType===o.fluidNotEnabled}(t))return o.fluidNotEnabled;if(function(e){return e.errorType===n.a.fileOverwrittenInStorage}(t))return n.a.fileOverwrittenInStorage}}!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly",e.blockedIPAddress="blockedIPAddress"}(i||(i={}))},89092:(e,t,r)=>{"use strict";r.d(t,{FX:()=>o});var n=r(16876);function o(e){if("object"===typeof e){const t=e;if(function(e){return e.name===n.ZY.IframeLoadFailed}(t))return n.ZY.IframeLoadFailed;if(function(e){return e.name===n.ZY.ComponentNotFound}(t))return n.ZY.ComponentNotFound}}},48116:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});const n="https://home.microsoftpersonalcontent.com"},73370:(e,t,r)=>{"use strict";r.d(t,{p:()=>s,Y:()=>i});var n=r(51238);function o(e,t,r){e.headers instanceof Headers?e.headers.set(t,r):e.headers={...e.headers,[t]:r}}const i="Bearer";function s(e,t,r,i){let s=!1;const a=new URL(e);i.queryParam&&(a.searchParams.set(i.queryParam,r),s=!i.doNotExceedQueryParamsLength||a.search.length<=i.doNotExceedQueryParamsLength,s||a.searchParams.delete(i.queryParam));let c=t;if(!s){c={...t};let e=!1;const s=null!==t&&void 0!==t&&t.method?t.method.toUpperCase():"GET";if(i.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(s)){c.method="POST";const l=(0,n.A)(),d=[];d.push("--".concat(l)),d.push("Authorization: ".concat(i.scheme," ").concat(r)),d.push("X-HTTP-Method-Override: ".concat(s)),d.push("_post: 1"),null!==t&&void 0!==t&&t.body&&d.push("\r\n".concat(t.body,"\r\n")),d.push("\r\n--".concat(l,"--"));const u=d.join("\r\n");e=!i.doNotExceedMultipartFormBodyLength||u.length<=i.doNotExceedMultipartFormBodyLength,e&&(c.body=u,o(c,"Content-Type","multipart/form-data;boundary=".concat(l)),a.searchParams.set("ump","1"))}e||(i.scheme?o(c,"Authorization","".concat(i.scheme," ").concat(r)):o(c,"Authorization",r))}return{url:a.href,request:c}}},40635:(e,t,r)=>{"use strict";r.d(t,{y:()=>u,g:()=>h});var n=r(73370),o=r(93537),i=r(75812),s=r(75964);var a=r(43172),c=r(95996);function l(){return"undefined"!==typeof performance?performance.now():Date.now()}const d={scheme:n.Y};function u(e){let t;return e.tenantId&&(t={tenantId:e.tenantId}),p(e,t)}function h(e){let t;return e.tenantId&&(t={tenantId:e.tenantId}),p(e,t)}const g=3;async function p(e,t){var r,c,u;let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const f=null!==(r=null===(c=e.retryPolicy)||void 0===c?void 0:c.maxAuthRetries)&&void 0!==r?r:g,v=l(),y=(await e.getToken(t)).token,b=l(),{url:S,requestInit:C,retryPolicy:k,timeoutMs:w}=e,P=null!==(u=e.tokenPolicy)&&void 0!==u?u:d,{url:E,request:T}=(0,n.p)(S,C,y,P);e.additionalRequestHeaders&&T&&e.additionalRequestHeaders.forEach(((e,t)=>{!function(e,t,r){if(void 0===e.headers){const n=new Headers;n.set(t,r),e.headers=n}else if(e.headers instanceof Headers)e.headers.has(t)||e.headers.set(t,r);else if(Array.isArray(e.headers)){for(let r=0;r<e.headers.length;r+=1)if(e.headers[r][0]===t)return;e.headers=[...e.headers,[t,r]]}else e.hasOwnProperty("headers")&&(e.headers={[t]:r,...e.headers})}(T,t,e)}));const I=e=>401===e.status&&function(e){const t=e.get("www-authenticate");if(!t)return;let r,n=!1;return t.split(",").map((e=>{const t=e.split("=");if(t.length>=2)if(n||"error"!==t[0].trim().toLowerCase()){if(!r&&"claims"===t[0].trim().toLowerCase()){const t=(0,s.X)(e.substring(e.indexOf("=")+1).trim());t&&(r=atob(t))}}else n="insufficient_claims"===(0,s.X)(t[1].trim().toLowerCase())})),n?r:void 0}(e.headers)||void 0,N=e=>401===e.status&&void 0!==function(e){const t=e.get("www-authenticate");if(!t)return;let r,n=!1;for(const o of t.split(",")){const e=o.split("=");e.length>=2&&(n||"error"!==e[0].trim().toLowerCase()?void 0===r&&"error_description"===e[0].trim().toLowerCase()&&(r=(0,s.X)(e[1].trim())):n="invalid_token"===(0,s.X)(e[1].trim().toLowerCase()))}return n?{errorDescription:r}:void 0}(e.headers)||void 0,F=e=>{if(401===e.status){const r=(0,a.J)(e.headers);if(r&&r!==(null===t||void 0===t?void 0:t.tenantId))return r}};let D,O;if(k&&(D={...k,filter:e=>!I(e)&&!N(e)&&!F(e)&&k.filter(e)}),"logger"in e&&"nameForLogging"in e){const t=async(t,r)=>{var n;const o=await(null===(n=e.getAdditionalProps)||void 0===n?void 0:n.call(e,t,r));return{tokenFetchDurationMs:Math.round(b-v),...o}};O=await(0,i.R)(E,T,e.nameForLogging,e.logger,e.doNotLogOnSuccess,D,w,t)}else O=await(0,o.J5)(E,T,D,w);if(h<=f){const r=h===f,n=I(O.result);if(n)return m(e,"InsufficientClaims",h,r),p(e,{...t,claims:n,forceRefresh:!0},h+1);if(N(O.result))return m(e,"InvalidToken",h,r),p(e,{...t,forceRefresh:!0},h+1);const o=F(O.result);if(o)return m(e,"SpecificTenant",h,r),p(e,{...t,tenantId:o},h+1)}return O}function m(e,t,r,n){"logger"in e&&"nameForLogging"in e&&(0,c.Ot)(e.logger,{eventName:"Retry".concat(e.nameForLogging,"OnAuthError"),subCategory:t,attempt:r,isFinalAttempt:n})}},74405:(e,t,r)=>{"use strict";r.d(t,{u:()=>o});const n=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function o(e){const t={};return null!==e&&void 0!==e&&e.headers&&n.forEach((r=>{const n=e.headers.get(r.headerName);n&&(t[r.logName]=n)})),t}},29018:(e,t,r)=>{"use strict";function n(e){return new URL(e).origin}r.d(t,{$:()=>n})},75812:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var n=r(93537),o=r(95996);function i(e,t,r,o,i,a){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7?arguments[7]:void 0;return(0,n.J5)(e,t,a,c).then((e=>o&&r?((!i&&e.result.ok||!e.result.ok)&&s(r,!0,e.result,e.tries.length+1,o,l),e.tries.forEach(((e,t)=>{s(r,!1,e,t+1,o,l)})),e):e))}async function s(e,t,r,n,i,s){var a;const c=s&&await s(r,t);(0,o.Ot)(i,{subCategory:"Request",eventName:e,isFinalAttempt:t,status:r.status,durationMs:r.durationMs,size:(null===(a=r.headers)||void 0===a?void 0:a.get("Content-Length"))||-1,attempt:n,...c})}},43172:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});var n=r(73370);function o(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(n.Y);if(r<0)return;let o;return t.substring(r+n.Y.length).split(",").map((e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}})),o}},60835:(e,t,r)=>{"use strict";r.d(t,{OF:()=>d,g2:()=>h,qT:()=>u,sN:()=>l});var n=r(29018),o=r(40635),i=r(74405),s=r(72376),a=r(95996);const c=new Map;function l(e,t,r,l,d,u){const h=(0,n.$)(t),g="".concat(h,"_").concat(r,"_").concat(l);if(!c.has(g)){const n=async()=>{var n,p;const m={getToken:n=>{const o={...n,siteUrl:t,driveId:r,itemId:l};return e.getToken(["".concat(h,"/files.readwrite.all")],o)},url:"".concat(h,"/_api/v2.0/drives/").concat(r,"/items/").concat(l,"?select=sharepointIds"),tenantId:u,requestInit:{method:"GET"},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},f=d?(0,o.g)({...m,logger:d,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,o.y)(m);let v;try{v=(await f).result}catch{}if(null!==(n=v)&&void 0!==n&&n.ok){var y;let e;try{e=await v.json()}catch(b){d&&(0,a.hO)(d,{eventName:"GetFileSharepointIdsResponseParseError"},b)}if(null!==(y=e)&&void 0!==y&&y.sharepointIds)return e.sharepointIds;d&&(0,a.hO)(d,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"))}404!==(null===(p=v)||void 0===p?void 0:p.status)&&c.delete(g)};c.set(g,n())}return c.get(g).then()}async function d(e,t,r,c,l,d,u){var h;const g=(0,n.$)(t),p={getToken:n=>{const o={...n,siteUrl:t,driveId:r,itemId:c};return e.getToken(["".concat(g,"/files.readwrite.all")],o)},url:"".concat(g,"/_api/v2.0/drives/").concat(r,"/items/").concat(c,"?select=webUrl,webDavUrl,name,sharepointIds"),tenantId:d,requestInit:{method:"GET",signal:u},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},m=l?(0,o.g)({...p,logger:l,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,o.y)(p);let f;try{f=(await m).result}catch{}if(null!==(h=f)&&void 0!==h&&h.ok)try{return await f.json()}catch(v){l&&(0,a.hO)(l,{eventName:"GetFileItemLiteResponseParseError"},v)}}const u=async(e,t,r,n,o)=>{if(h(e))return d(t,e.siteUrl,e.driveId,e.itemId,r,n,o).then((e=>{const t=null===e||void 0===e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==t&&t>0)return null===e||void 0===e?void 0:e.webDavUrl.substring(0,t)}))},h=e=>"driveId"in e&&"siteUrl"in e&&"itemId"in e},25969:(e,t,r)=>{"use strict";r.d(t,{K:()=>o});var n=r(29018);function o(e){return["".concat((0,n.$)(e),"/files.readwrite.all")]}},72376:(e,t,r)=>{"use strict";r.d(t,{N$:()=>l,_9:()=>s});var n=r(73370),o=r(37805),i=r(93537);const s={maxRetries:2,backoffFn:(0,o.FT)(500),filter:(0,i.sC)([408,409,503]),respectRetryAfterHeader:!0},a={scheme:n.Y,queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},c={scheme:n.Y,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function l(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{..."Consumer"===e.identityType?c:a,preferAuthorizationInMultipartFormBody:t}}},18206:(e,t,r)=>{"use strict";r.d(t,{XM:()=>a,wJ:()=>l,z$:()=>c});var n=r(93537),o=r(37805),i=r(40635),s=r(74405);const a={respectRetryAfterHeader:!0,maxRetries:3,filter:(0,n.sC)([503]),backoffFn:(0,o.Ed)(100)};async function c(e,t,r,n,o,a,c){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0;const h={getToken:e,url:t.startsWith("http")?t:"https://graph.microsoft.com/v1.0/".concat(t),tenantId:o,requestInit:a,retryPolicy:c,timeoutMs:l,additionalRequestHeaders:u},g=n&&r?(0,i.g)({...h,logger:n,nameForLogging:r,doNotLogOnSuccess:d,getAdditionalProps:async(e,t)=>(0,s.u)(e)}):(0,i.y)(h);return(await g).result}function l(e,t){const r=new Map;return function(){const n=t(...arguments),o=r.get(n);if(o)return o;const i=e(...arguments);return r.set(n,i),i.then((e=>("number"===typeof e&&200!==e&&404!==e&&r.delete(n),e)),(e=>{throw r.delete(n),e}))}}},52563:(e,t,r)=>{"use strict";r.d(t,{Zd:()=>a,hT:()=>n,q:()=>i,rv:()=>c});const n={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},o={af:n.afZa,am:n.amEt,ar:n.arSa,as:n.asIn,az:n.azLatnAz,bg:n.bgBg,bn:n.enGb,bs:n.bsLatnBa,"bs-cyrl-ba":n.enGb,ca:n.caEs,cs:n.csCz,cy:n.cyGb,da:n.daDk,de:n.deDe,el:n.elGr,"el-cy":n.enGb,en:n.enUs,es:n.esEs,et:n.etEe,eu:n.euEs,fa:n.faIr,fi:n.fiFi,fil:n.filPh,fr:n.frFr,ga:n.gaIe,gd:n.gdGb,gl:n.glEs,gu:n.guIn,he:n.heIl,hi:n.hiIn,hr:n.hrHr,hu:n.huHu,hy:n.hyAm,id:n.idId,is:n.isIs,it:n.itIt,iw:n.heIl,"iw-il":n.heIl,ja:n.jaJp,ka:n.kaGe,kk:n.kkKz,km:n.kmKh,kn:n.knIn,ko:n.koKr,kok:n.kokIn,lb:n.lbLu,lo:n.loLa,lt:n.ltLt,lv:n.lvLv,mi:n.miNz,mk:n.mkMk,ml:n.mlIn,mr:n.mrIn,ms:n.msMy,mt:n.mtMt,nb:n.nbNo,ne:n.neNp,nl:n.nlNl,nn:n.nnNo,or:n.orIn,pa:n.paIn,pl:n.plPl,pt:n.ptBr,quz:n.quzPe,ro:n.roRo,ru:n.ruRu,sk:n.skSk,sl:n.slSi,sq:n.sqAl,sv:n.svSe,ta:n.taIn,te:n.teIn,th:n.thTh,tr:n.trTr,"tr-cy":n.enGb,tt:n.ttRu,ug:n.ugCn,uk:n.ukUa,ur:n.urPk,uz:n.enUs,vi:n.viVn,zh:n.enUs,"zh-hans-tw":n.zhTw},i=n.enUs,s=/^([^-]+)-.+/;function a(e){if(void 0===e||null===e)return!1;const t=e.toLowerCase();return Object.values(n).includes(t)||void 0!==o[t]}function c(e){if(void 0===e||null===e)return i;const t=e.toLowerCase();if(Object.values(n).includes(t))return t;const r=o[t];if(void 0!==r)return r;const a=function(e){const t=s.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==a){const e=o[a];if(void 0!==e)return e}return i}},63854:(e,t,r)=>{"use strict";function n(e){return o(e)}function o(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}r.d(t,{Gz:()=>n})},75335:(e,t,r)=>{"use strict";r.d(t,{WN:()=>u,xl:()=>d,yb:()=>l});const n=new Map;let o=!1,i=0;function s(){if(document.hidden){const e=Date.now();n.forEach(((t,r)=>{-1===t&&n.set(r,e)})),a()}}function a(){o=!1,document.removeEventListener("visibilitychange",s)}function c(e){document.hidden?n.set(e,0):(o||(o=!0,document.addEventListener("visibilitychange",s)),n.set(e,-1))}function l(){return i+=1,c(i),i}function d(e,t){const r=n.get(e);return t&&u(e),r}function u(e){n.delete(e),0===n.size&&o&&a()}},57063:(e,t,r)=>{"use strict";function n(e){switch(e){case"Development":return"https://res-sdf.cdn.office.net/fluid/dev";case"Staging":return"https://res-sdf.cdn.office.net/fluid/stg";case"Dogfood":return"https://res.cdn.office.net/fluid/df";case"Gcc":return"https://res.cdn.office.net/fluid/gcc";case"GccHigh":return"https://res-gcch.cdn.office.net/fluid/gcch";case"DoD":return"https://res-dod.cdn.office.net/fluid/dod";default:return"https://res.cdn.office.net/fluid/prod"}}function o(e){switch(e){case"Development":return"https://res-sdp.sdf.cdn.office.net/fluid/dev";case"Staging":return"https://res-sdp.sdf.cdn.office.net/fluid/stg";case"Dogfood":return"https://res-sdp.public.cdn.office.net/fluid/df";case"Gcc":return"https://res-sdp.gcc.cdn.office.net/fluid/gcc";case"GccHigh":return"https://res-sdp.gcch.cdn.office.net/fluid/gcch";case"DoD":return"https://res-sdp.dod.cdn.office.net/fluid/dod";default:return"https://res-sdp.public.cdn.office.net/fluid/prod"}}r.d(t,{Vv:()=>o,ox:()=>n})},75964:(e,t,r)=>{"use strict";r.d(t,{X:()=>o});var n=r(95996);function o(e,t,r){try{return JSON.parse(e,t)}catch(o){return void(r&&(0,n.hO)(r.logger,r.event,o))}}},60257:(e,t,r)=>{"use strict";r.d(t,{q:()=>n});const n=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t}},63990:(e,t,r)=>{"use strict";r.d(t,{M:()=>a,l:()=>s});let n=[],o=!1,i=!1;function s(e,t){n.push({ensureExecution:!0===(null===t||void 0===t?void 0:t.ensureExecution),task:e}),null!==t&&void 0!==t&&t.ensureExecution&&!i&&(document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&l((e=>e.ensureExecution))})),i=!0),c()}function a(e){const t=n.findIndex((t=>t.task===e));-1!==t&&n.splice(t,1)}function c(){if(!o){if(window.requestIdleCallback)window.requestIdleCallback(d);else{const e=Date.now()+50;window.setTimeout((()=>d({timeRemaining:()=>Math.max(e-Date.now(),0),didTimeout:!1})),0)}o=!0}}function l(e,t){const r=[];for(let o=0;o<n.length;o+=1){if(t&&!t()){r.push(...n.slice(o));break}const i=n[o];e&&!e(i)?r.push(i):i.task()}n=r}function d(e){l(void 0,(()=>e.timeRemaining()>10)),o=!1,n.length>0&&c()}},32356:(e,t,r)=>{"use strict";function n(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}function o(e,t){const r=n(e),o=n(null!==t&&void 0!==t?t:"Production");return void 0!==r&&void 0!==o&&o<=r}r.d(t,{a:()=>o})},48680:(e,t,r)=>{"use strict";r.d(t,{AU:()=>d});var n=r(75964),o=r(52841),i=r(3503);const s=new Map;function a(e,t){const r=function(e,t){const r=s.get(e);if(void 0!==r)return r;let n,a,l;l=void 0!==(n=function(e){const t=i.f.get(e);return c(t)}(e))?n:void 0!==(a=function(e){var t;const r=null===(t=(0,o.A)())||void 0===t?void 0:t.getItem(e);return c(r)}(e))?a:t;return s.set(e,l),l}(e,t);return r}function c(e){if(null!==e&&void 0!==e){const t=(0,n.X)(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function l(e,t,r,n){return r?r.getSetting(e,t,n):a(e,t)}const d=(e,t,r)=>l(e,t,r,"FluidExperiences")},52841:(e,t,r)=>{"use strict";let n,o;r.d(t,{A:()=>i});try{n=localStorage}catch{}n||(n=void 0);try{o=sessionStorage}catch{}function i(){return n}o||(o=void 0)},3503:(e,t,r)=>{"use strict";r.d(t,{f:()=>n});const n=new URLSearchParams("undefined"!==typeof location?location.search:"")},96689:(e,t,r)=>{"use strict";r.d(t,{Cx:()=>a,II:()=>i,JL:()=>n,K$:()=>o});const n="@fluidx/video-playback",o="@fluidx/video-playback-extended",i="@fluidx/video-notes-msa";class s{canLoad(e){const{packageName:t}=e;return t===n||t===i||t===o}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return Promise.all([r.e(69808),r.e(97950),r.e(78167),r.e(94885),r.e(18806),r.e(15996),r.e(3280)]).then(r.bind(r,15996)).then((t=>({module:t,details:e})))}}const a={instantiateLoopCodeLoader:e=>Promise.resolve(new s)}},82770:(e,t,r)=>{"use strict";r.d(t,{EW:()=>p,Il:()=>d,KJ:()=>u,Kz:()=>b,Nn:()=>f,OD:()=>c,ay:()=>g,qw:()=>m,rh:()=>h});var n=r(90589);function o(e,t){return e?e+"."+t:t}function i(e,t,r,i,s){void 0===s&&(s=4),i&&e.push((0,n.m9)("".concat(o(t,r)),i,s))}function s(e,t,r,i){"boolean"===typeof i&&e.push((0,n.LK)("".concat(o(t,r)),i))}function a(e,t,r,i){"number"===typeof i&&e.push((0,n.Ug)("".concat(o(t,r)),i))}var c,l=function(e){var t="Activity.Result",r=[];return a(r,t,"Code",e.code),i(r,t,"Type",e.type),a(r,t,"Tag",e.tag),s(r,t,"IsExpected",e.isExpected),r.push((0,n.m9)("zC.Activity.Result","Office.System.Result")),r},d={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return i(r,t,"CV",e.cV),a(r,t,"Duration",e.duration),a(r,t,"Count",e.count),a(r,t,"AggMode",e.aggMode),s(r,t,"Success",e.success),e.result&&r.push.apply(r,l(e.result)),r.push((0,n.m9)("zC.Activity",this.contractName)),r}},u={getFields:function(e){var t="User",r=[];return i(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(r,t,"TenantId",e.tenantId,1),i(r,t,"TenantGroup",e.tenantGroup,1),s(r,t,"IsAnonymous",e.isAnonymous),s(r,t,"IsSignedIn",e.isSignedIn),r}},h={getFields:function(e,t){var r=[];return i(r,e,"Name",t.name),i(r,e,"State",t.state),r}},g={getFields:function(e){var t="UserAction",r=[];return a(r,t,"Id",e.id),i(r,t,"Name",e.name),i(r,t,"CommandSurface",e.commandSurface),i(r,t,"ParentName",e.parentName),i(r,t,"TriggerMethod",e.triggerMethod),a(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(c||(c={}));var p,m={getFields:function(e){var t="App",r=[];return i(r,t,"Name",e.name,1),i(r,t,"Platform",e.platform,1),i(r,t,"Version",e.version,1),r}},f={getFields:function(e){var t="Session",r=[];return i(r,t,"Id",e.id,1),i(r,t,"EcsETag",e.ecsETag,1),r}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(p||(p={}));var v,y,b={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var r=[];return i(r,t,"FeatureActionType",e.featureActionType),s(r,t,"IsUserInitiated",e.isUserInitiated),i(r,t,"FeatureName",e.featureName),i(r,t,"SubFeatureName",e.subFeatureName),i(r,t,"Capability",e.capability),s(r,t,"IsThumbsUp",e.isThumbsUp),i(r,t,"EntryPoint",e.entryPoint),i(r,t,"Verb",e.verb),i(r,t,"InteractionId",e.interactionId),r.push((0,n.m9)("zC.".concat(t),"Office.System.Copilot")),r}}(v||(v={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var r=[];return i(r,t,"EventType",e.eventType),i(r,t,"Pillar",e.pillar),i(r,t,"Scenario",e.scenario),i(r,t,"Veto",e.veto),i(r,t,"Error",e.error),s(r,t,"InStaging",e.inStaging),s(r,t,"IsSessionEndingError",e.isSessionEndingError),s(r,t,"IsIntentional",e.isIntentional),s(r,t,"IsInternal",e.isInternal),r.push((0,n.m9)("zC.".concat(t),"Office.System.Asha")),r}}(y||(y={}))},90589:(e,t,r)=>{"use strict";function n(e,t,r){return a(e,1,t,r)}function o(e,t,r){return a(e,2,t,r)}function i(e,t,r){return a(e,3,t,r)}function s(e,t,r){return a(e,0,t,r)}function a(e,t,r,n){return{name:e,dataType:t,value:r,classification:n||4}}r.d(t,{LK:()=>n,Ug:()=>o,ip:()=>i,m9:()=>s})},12283:(e,t,r)=>{"use strict";r.d(t,{d$:()=>o,vV:()=>s,wC:()=>i});var n=function(){var e=[];return{fireEvent:function(t){e.forEach((function(e){return e(t)}))},addListener:function(t){t&&e.push(t)}}}();function o(){return n}function i(e,t,r){n.fireEvent({level:e,category:t,message:r})}function s(e,t,r){i(0,e,(function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)}))}},50406:(e,t,r)=>{"use strict";r.d(t,{GV:()=>b,di:()=>v,EY:()=>y});var n=r(6326),o=r(12283),i={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,o.wC)(0,0,(function(){return"Namespace: ".concat(e)}))}function a(e,t){for(var r=e.length;r>0;){var n=e.substr(0,r);if(i[n]){var o=i[n];return t.ariaTenantToken=o.ariaTenantToken,t.dnmToken=o.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var c=9007199254740991,l=-c,d=98,u=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,h=/^[a-zA-Z0-9_\.]{1,95}$/;function g(e){if(!function(e){if(!e||e.length>d)return!1;return u.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!p(t.name))throw new Error("Invalid eventContract");m(t.dataFields)}m(e.dataFields)}function p(e){return h.test(e)}function m(e){e&&e.forEach((function(e){if("string"!==typeof e.name||!p(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e<l||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var f=r(90589),v=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,n.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(e,t,r){var o,i,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},e&&(this.telemetrySinks=e.telemetrySinks,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=(0,n.__assign)((0,n.__assign)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,f.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),r=t.telemetryProperties;r.nexusTenantToken=v;var n=r.ariaTenantToken;if(!n&&(!a(t.eventName,r)&&!n))return void(0,o.wC)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var r=y(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),r=t.telemetryProperties,n=r.customerContentVersion;return(!n||n>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),r=t.telemetryProperties;if(!r.dnmToken&&(!a(t.eventName,r)&&!r.dnmToken))return void(0,o.wC)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,o.wC)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(r){return void(0,o.vV)(0,"SendTelemetryEvent",r)}this.telemetrySinks.forEach((function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(n){}}))}else(0,o.wC)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var r,n,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift((0,f.m9)("OTelJS.Version","4.20.0")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||g(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var n=r[t],o=n[0],i=n[1];this.sendTelemetryEventInternal(o,i)}},e.prototype.setTenantToken=function(e,t,r){s(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e}()},11517:(e,t,r)=>{"use strict";r.d(t,{M:()=>g});var n=r(6326),o=r(50406),i=r(82770),s=r(12283),a=function(){return 1e3*Date.now()};"object"===typeof window&&"object"===typeof window.performance&&"now"in window.performance&&(a=function(){return 1e3*Math.floor(window.performance.now())});var c,l=function(e){var t,r=a(),c=(0,o.EY)(e.telemetryEvent);return(0,n.__assign)((0,n.__assign)({cv:e.parentCv.getNext()},c),{createChildActivity:function(t){return l({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var n,o,c=this;if(!t){void 0===this.success&&void 0===this.result&&(0,s.wC)(1,0,(function(){return"Activity does not have success or result set"}));var l=a();t=!0;var d={duration:l-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},u=null!==(o=null===(n=this.eventContract)||void 0===n?void 0:n.dataFields)&&void 0!==o?o:[];return u.push.apply(u,i.Il.getFields(d)),this.eventContract={name:i.Il.contractName,dataFields:u},e.sendTelemetryEvent(this)}(0,s.wC)(0,0,(function(){return"'".concat(c.eventName,"' already ended")}))}})},d=r(90589),u=function(e){var t="Error",r=[];return r.push((0,d.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,d.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,d.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,d.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,d.Ug)("".concat(t,".Count"),e.count)),r},h=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var g=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.baseCv=function(){if(!c){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],r=0;r<22;r++)t.push(e.charAt(Math.floor(64*Math.random())));c=new h(t.join(""))}return c}(),o}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return l({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:i.Il.contractName,dataFields:i.Il.getFields(t)},dataFields:r,eventFlags:n})},t.prototype.sendError=function(e){var t=u(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return l({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(o.GV)},37450:(e,t,r)=>{"use strict";var n;r.d(t,{o:()=>n}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(n||(n={}))},29967:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var n=r(55863),o=r(83125),i=r(25969),s=r(14836);function a(e,t,r,a){const c=t&&new o.p("OdspUrlResolver",t),l="UnauthenticatedGuest"===e.identityType?void 0:{tokenFetcher:r=>e.getToken((0,i.K)(r.siteUrl),(0,s.r)(r,t)),identityType:e.identityType||"Enterprise"};return new n.s(l,c,null===r||void 0===r?void 0:r.appName,a)}},14836:(e,t,r)=>{"use strict";r.d(t,{r:()=>s});var n=r(83125),o=r(74906),i=r(95720);function s(e,t){const r=t&&new n.p(i.Ak,t);return{claims:e.claims,forceRefresh:e.refresh,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,tenantId:e.tenantId||(0,o.n)(e.siteUrl,r)}}},95720:(e,t,r)=>{"use strict";r.d(t,{A8:()=>u,Ak:()=>k,BN:()=>w,F7:()=>c,P:()=>l,Qk:()=>g,Qn:()=>d,TK:()=>p,Ug:()=>C,_H:()=>S,a$:()=>s,bU:()=>n,ih:()=>o,ii:()=>y,m1:()=>h,md:()=>f,ol:()=>a,ps:()=>b,tR:()=>i,uT:()=>m,ul:()=>v});const n="LoadComponentInDiv",o="GetDriver",i="LoadContainer",s="LoadComponentFromContainer",a="RequestComponent",c="GetTemplateContent",l="RehydrateFromTemplateContent",d="LoadCodeFromHint",u="FetchComponentManifest",h="GetLoopComponentCore",g="ContainerPostBootError",p="ContainerPackagePreCacheError",m="GetTemplateContentError",f="UndefinedTemplateContentError",v="ComponentNotSerializableError",y="ComponentSerializationError",b="ComponentManifestFetchError",S="LoadComponentCancelledByHost",C="CodeHintExists",k="OfficeWebHost",w="LoopExperiences"},25045:(e,t,r)=>{"use strict";r.d(t,{G:()=>n,K:()=>o});const n={GetDriveInfo:"GetDriveInfo",AttachContainer:"AttachContainer",GetFileLink:"GetFileLink",CreateShareLink:"CreateShareLink",RenderComponent:"RenderComponent",PostRender:"PostRender"},o={RenderComponent:"RenderComponentByHost"}},23989:(e,t,r)=>{"use strict";r.d(t,{_:()=>l});var n=r(95996),o=r(83125),i=r(33788),s=r(75335),a=r(25045);const c="EndToEnd";class l{static startScenario(e,t,r,n){if(r){const o=l.startScenario(e,t);return(async()=>{try{const e=await r(o);return o.setSuccess(null===n||void 0===n?void 0:n()),e}catch(e){throw o.setFailure(e,null===n||void 0===n?void 0:n()),e}})()}let o;return new l(t+c,e,(()=>{o=(0,s.yb)();try{var t,r;const n=null===(t=e.PersistedProperties)||void 0===t||null===(r=t.getPersistedProperties)||void 0===r?void 0:r.call(t).hostScenarioStartTime;if(n&&"number"===typeof n){const e=performance.now()-(Date.now()-n);e>=0&&performance.measure("PreScenarioOverhead",{start:e})}}catch{}}),(()=>{o&&((0,s.WN)(o),o=void 0)}),(()=>({documentHidden:o?(0,s.xl)(o,!0)>-1:""})))}static startActivity(e,t,r){if(r){const n=l.startActivity(e,t);return(async()=>{try{const e=await r();return n.setSuccess(),e}catch(e){throw n.setFailure(e),e}})()}return new l(a.K[t]||t,e)}getLogger(){return this.logger}scenarioEndsAfterRender(){return"LoadEndToEnd"===this.activityType||"PasteEndToEnd"===this.activityType}setSuccess(e){var t;this.activityTracker&&(this.activityTracker.setResult(!0,{...e,...null===(t=this.getExtraPropsToLog)||void 0===t?void 0:t.call(this)}),this.dispose())}setFailure(e,t){var r;this.activityTracker&&(this.activityTracker.setResult(!1,{...t,...null===(r=this.getExtraPropsToLog)||void 0===r?void 0:r.call(this),errorType:e?e.errorType:void 0},e),this.dispose())}cancel(){this.dispose()}dispose(){var e,t;null===(e=this.additionalCleanup)||void 0===e||e.call(this),this.logger&&(0,n.Ot)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),null===(t=this.activityTracker)||void 0===t||t.dispose(),this.activityTracker=void 0,this.logger=void 0}constructor(e,t,r,s,l){this.activityType=e,this.additionalCleanup=s,this.getExtraPropsToLog=l,null===r||void 0===r||r(),this.logger=new o.p("HostTracker",t),this.activityTracker=i.m.start(e,this.logger,{addUserTiming:!0,isAPerformanceMetric:[a.G.RenderComponent,a.K.RenderComponent].includes(e)||e.endsWith(c)}),(0,n.Ot)(this.logger,{eventName:e,subCategory:"HostActivityTrackerCreated"})}}},14826:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});const n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);function s(){if(!o&&(o="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)}const a=[];for(let d=0;d<256;++d)a.push((d+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return c(o)}},34445:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,i=a(e),s=i[0],c=i[1],l=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),d=0,u=c>0?s-4:s;for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[d++]=255&t);1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=16383,a=0,l=n-o;a<l;a+=s)i.push(c(e,a,a+s>l?l:a+s));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],n=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=i[s],n[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},12028:(e,t,r)=>{"use strict";var n=r(60002),o=r(61712),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"===typeof r&&i(e,".prototype.")>-1?o(r):r}},61712:(e,t,r)=>{"use strict";var n=r(63864),o=r(60002),i=r(75438),s=r(54902),a=o("%Function.prototype.apply%"),c=o("%Function.prototype.call%"),l=o("%Reflect.apply%",!0)||n.call(c,a),d=r(82090),u=o("%Math.max%");e.exports=function(e){if("function"!==typeof e)throw new s("a function is required");var t=l(n,c,arguments);return i(t,1+u(0,e.length-(arguments.length-1)),!0)};var h=function(){return l(n,a,arguments)};d?d(e.exports,"apply",{value:h}):e.exports.apply=h},33415:e=>{var t=1e3,r=60*t,n=60*r,o=24*n,i=7*o,s=365.25*o;function a(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,c){c=c||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=o)return a(e,i,o,"day");if(i>=n)return a(e,i,n,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=o)return Math.round(e/o)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},76522:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(35237)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},35237:(e,t,r)=>{e.exports=function(e){function t(e){let r,o,i,s=null;function a(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!a.enabled)return;const i=a,s=Number(new Date),c=s-(r||s);i.diff=c,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");let l=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,((e,r)=>{if("%%"===e)return"%";l++;const o=t.formatters[r];if("function"===typeof o){const t=n[l];e=o.call(i,t),n.splice(l,1),l--}return e})),t.formatArgs.call(i,n);(i.log||t.log).apply(i,n)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"===typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(33415),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},74992:(e,t,r)=>{"use strict";var n=r(82090),o=r(62557),i=r(54902),s=r(95558);e.exports=function(e,t,r){if(!e||"object"!==typeof e&&"function"!==typeof e)throw new i("`obj` must be an object or a function`");if("string"!==typeof t&&"symbol"!==typeof t)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!==typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!==typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!==typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!==typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,d=arguments.length>6&&arguments[6],u=!!s&&s(e,t);if(n)n(e,t,{configurable:null===l&&u?u.configurable:!l,enumerable:null===a&&u?u.enumerable:!a,value:r,writable:null===c&&u?u.writable:!c});else{if(!d&&(a||c||l))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},71724:e=>{"use strict";function t(e){if(this._capacity=n(e),this._length=0,this._front=0,r(e)){for(var t=e.length,o=0;o<t;++o)this[o]=e[o];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,n=this._capacity,o=0;o<e;++o)t[o]=this[r+o&n-1];return t},t.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var n=this._capacity;if(r+t>n){for(var o=0;o<t;++o){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[o],r++,this._length=r}return r}for(var i=this._front,o=0;o<t;++o)this[i+r&n-1]=arguments[o],i++;return this._length=r+t,r+t}return 0===t?r:(this._checkCapacity(r+1),this[o=this._front+r&this._capacity-1]=e,this._length=r+1,r+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},t.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){if(t+r>(o=this._capacity)){for(var n=r-1;n>=0;n--){this._checkCapacity(t+1);var o=this._capacity;this[s=(this._front-1&o-1^o)-o]=arguments[n],t++,this._length=t,this._front=s}return t}var i=this._front;for(n=r-1;n>=0;n--){var s;this[s=(i-1&o-1^o)-o]=arguments[n],i=s}return this._front=i,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);o=this._capacity;return this[n=(this._front-1&o-1^o)-o]=e,this._length=t+1,this._front=n,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,n=0;n<e;++n)this[t+n&r-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(n(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,n=this._length;r+n>t&&function(e,t,r,n,o){for(var i=0;i<o;++i)r[i+n]=e[i+t],e[i+t]=void 0}(this,0,this,t,r+n&t-1)};var r=Array.isArray;function n(e){if("number"!==typeof e){if(!r(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},82090:(e,t,r)=>{"use strict";var n=r(60002)("%Object.defineProperty%",!0)||!1;if(n)try{n({},"a",{value:1})}catch(o){n=!1}e.exports=n},79820:e=>{"use strict";e.exports=EvalError},29304:e=>{"use strict";e.exports=Error},1725:e=>{"use strict";e.exports=RangeError},75077:e=>{"use strict";e.exports=ReferenceError},62557:e=>{"use strict";e.exports=SyntaxError},54902:e=>{"use strict";e.exports=TypeError},63094:e=>{"use strict";e.exports=URIError},27284:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,o,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var o,i,s,l;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,l=d,console&&console.warn&&console.warn(l)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=d.bind(n);return o.listener=r,n.wrapFn=o,o}function h(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"===typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):p(o,o.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var l=c.length,d=p(c,l);for(r=0;r<l;++r)n(d[r],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},17724:e=>{"use strict";var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r};e.exports=function(e){var o=this;if("function"!==typeof o||"[object Function]"!==t.apply(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var i,s=function(e,t){for(var r=[],n=t||0,o=0;n<e.length;n+=1,o+=1)r[o]=e[n];return r}(arguments,1),a=r(0,o.length-s.length),c=[],l=0;l<a;l++)c[l]="$"+l;if(i=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var t=o.apply(this,n(s,arguments));return Object(t)===t?t:this}return o.apply(e,n(s,arguments))})),o.prototype){var d=function(){};d.prototype=o.prototype,i.prototype=new d,d.prototype=null}return i}},63864:(e,t,r)=>{"use strict";var n=r(17724);e.exports=Function.prototype.bind||n},60002:(e,t,r)=>{"use strict";var n,o=r(29304),i=r(79820),s=r(1725),a=r(75077),c=r(62557),l=r(54902),d=r(63094),u=Function,h=function(e){try{return u('"use strict"; return ('+e+").constructor;")()}catch(t){}},g=Object.getOwnPropertyDescriptor;if(g)try{g({},"")}catch(A){g=null}var p=function(){throw new l},m=g?function(){try{return p}catch(e){try{return g(arguments,"callee").get}catch(t){return p}}}():p,f=r(72108)(),v=r(80951)(),y=Object.getPrototypeOf||(v?function(e){return e.__proto__}:null),b={},S="undefined"!==typeof Uint8Array&&y?y(Uint8Array):n,C={__proto__:null,"%AggregateError%":"undefined"===typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":f&&y?y([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"===typeof Atomics?n:Atomics,"%BigInt%":"undefined"===typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"===typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"===typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"===typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":u,"%GeneratorFunction%":b,"%Int8Array%":"undefined"===typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f&&y?y(y([][Symbol.iterator]())):n,"%JSON%":"object"===typeof JSON?JSON:n,"%Map%":"undefined"===typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&f&&y?y((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?n:Promise,"%Proxy%":"undefined"===typeof Proxy?n:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":"undefined"===typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&f&&y?y((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f&&y?y(""[Symbol.iterator]()):n,"%Symbol%":f?Symbol:n,"%SyntaxError%":c,"%ThrowTypeError%":m,"%TypedArray%":S,"%TypeError%":l,"%Uint8Array%":"undefined"===typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?n:Uint32Array,"%URIError%":d,"%WeakMap%":"undefined"===typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?n:WeakSet};if(y)try{null.error}catch(A){var k=y(y(A));C["%Error.prototype%"]=k}var w=function e(t){var r;if("%AsyncFunction%"===t)r=h("async function () {}");else if("%GeneratorFunction%"===t)r=h("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=h("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&y&&(r=y(o.prototype))}return C[t]=r,r},P={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},E=r(63864),T=r(34384),I=E.call(Function.call,Array.prototype.concat),N=E.call(Function.apply,Array.prototype.splice),F=E.call(Function.call,String.prototype.replace),D=E.call(Function.call,String.prototype.slice),O=E.call(Function.call,RegExp.prototype.exec),B=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,x=/\\(\\)?/g,L=function(e,t){var r,n=e;if(T(P,n)&&(n="%"+(r=P[n])[0]+"%"),T(C,n)){var o=C[n];if(o===b&&(o=w(n)),"undefined"===typeof o&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!==typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===O(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=D(e,0,1),r=D(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var n=[];return F(e,B,(function(e,t,r,o){n[n.length]=r?F(o,x,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",o=L("%"+n+"%",t),i=o.name,s=o.value,a=!1,d=o.alias;d&&(n=d[0],N(r,I([0,1],d)));for(var u=1,h=!0;u<r.length;u+=1){var p=r[u],m=D(p,0,1),f=D(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===f||"'"===f||"`"===f)&&m!==f)throw new c("property names with quotes must have matching quotes");if("constructor"!==p&&h||(a=!0),T(C,i="%"+(n+="."+p)+"%"))s=C[i];else if(null!=s){if(!(p in s)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return}if(g&&u+1>=r.length){var v=g(s,p);s=(h=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:s[p]}else h=T(s,p),s=s[p];h&&!a&&(C[i]=s)}}return s}},95558:(e,t,r)=>{"use strict";var n=r(60002)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(o){n=null}e.exports=n},12101:(e,t,r)=>{"use strict";var n=r(82090),o=function(){return!!n};o.hasArrayLengthDefineBug=function(){if(!n)return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},80951:e=>{"use strict";var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)}},72108:(e,t,r)=>{"use strict";var n="undefined"!==typeof Symbol&&Symbol,o=r(99534);e.exports=function(){return"function"===typeof n&&("function"===typeof Symbol&&("symbol"===typeof n("foo")&&("symbol"===typeof Symbol("bar")&&o())))}},99534:e=>{"use strict";e.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"===typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"===typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},34384:(e,t,r)=>{"use strict";var n=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=r(63864);e.exports=i.call(n,o)},69649:(e,t,r)=>{"use strict";r.d(t,{P2:()=>f});const n=(e,t)=>t.some((t=>e instanceof t));let o,i;const s=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,d=new WeakMap;let u={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return p(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(m(this),r),p(s.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return p(e.apply(m(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];const i=e.call(m(this),t,...n);return c.set(i,t.sort?t.sort():[t]),p(i)}}function g(e){return"function"===typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));a.set(e,t)}(e),n(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,u):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(p(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),d.set(t,e),t}(e);if(l.has(e))return l.get(e);const t=g(e);return t!==e&&(l.set(e,t),d.set(t,e)),t}const m=e=>d.get(e);function f(e,t){let{blocked:r,upgrade:n,blocking:o,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=p(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(p(s.result),e.oldVersion,e.newVersion,p(s.transaction))})),r&&s.addEventListener("blocked",(()=>r())),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),a}const v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,o=y.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!v.includes(r))return;const i=async function(e){const t=this.transaction(e,o?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];return n&&(i=i.index(a.shift())),(await Promise.all([i[r](...a),o&&t.done]))[0]};return b.set(t,i),i}u=(e=>({...e,get:(t,r,n)=>S(t,r)||e.get(t,r,n),has:(t,r)=>!!S(t,r)||e.has(t,r)}))(u)},5531:(e,t,r)=>{var n=r(43028),o=r(68105),i=65536,s=15,a=h(5<<20),c=function(){try{return new Uint32Array(i)}catch(r){for(var e=new Array(i),t=0;t<i;t++)e[t]=0;return e}}(),l=407708164,d=2147483648,u={4:65536,5:262144,6:1048576,7:4194304};function h(e){try{return new Uint8Array(e)}catch(n){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t}}function g(e,t,r){if(void 0!==typeof e.buffer){if(Uint8Array.prototype.slice)return e.slice(t,r);var n=e.length;t=(t|=0)<0?Math.max(n+t,0):Math.min(t,n),r=(r=void 0===r?n:0|r)<0?Math.max(n+r,0):Math.min(r,n);for(var o=new Uint8Array(r-t),i=t,s=0;i<r;)o[s++]=e[i++];return o}return e.slice(t,r)}t.compressBound=function(e){return e+e/255+16|0},t.decompressBound=function(e){var t=0;if(o.readU32(e,t)!==l)throw new Error("invalid magic number");t+=4;var r=e[t++];if(64!==(192&r))throw new Error("incompatible descriptor version "+(192&r));var n=0!==(16&r),i=0!==(8&r),s=e[t++]>>4&7;if(void 0===u[s])throw new Error("invalid block size "+s);var a=u[s];if(i)return o.readU64(e,t);t++;for(var c=0;;){var h=o.readU32(e,t);if(t+=4,c+=h&d?h&=2147483647:a,0===h)return c;n&&(t+=4),t+=h}},t.makeBuffer=h,t.decompressBlock=function(e,t,r,n,o){var i,s,a,c,l;for(a=r+n;r<a;){var d=e[r++],u=d>>4;if(u>0){if(15===u)for(;u+=e[r],255===e[r++];);for(c=r+u;r<c;)t[o++]=e[r++]}if(r>=a)break;if(i=15&d,s=e[r++]|e[r++]<<8,15===i)for(;i+=e[r],255===e[r++];);for(c=(l=o-s)+(i+=4);l<c;)t[o++]=0|t[l++]}return o},t.compressBlock=function(e,t,r,n,i){var a,c,l,d,u,h,g,p;if(h=0,g=n+r,c=r,n>=13)for(var m=67;r+4<g-5;){var f=o.readU32(e,r),v=o.hashU32(f)>>>0;if(a=i[v=(v>>16^v)>>>0&65535]-1,i[v]=r+1,a<0||r-a>>>16>0||o.readU32(e,a)!==f)r+=m++>>6;else{for(m=67,u=r-c,d=r-a,a+=4,l=r+=4;r<g-5&&e[r]===e[a];)r++,a++;var y=(l=r-l)<15?l:15;if(u>=s){for(t[h++]=240+y,p=u-s;p>=255;p-=255)t[h++]=255;t[h++]=p}else t[h++]=(u<<4)+y;for(var b=0;b<u;b++)t[h++]=e[c+b];if(t[h++]=d,t[h++]=d>>8,l>=15){for(p=l-15;p>=255;p-=255)t[h++]=255;t[h++]=p}c=r}}if(0===c)return 0;if((u=g-c)>=s){for(t[h++]=240,p=u-s;p>=255;p-=255)t[h++]=255;t[h++]=p}else t[h++]=u<<4;for(r=c;r<g;)t[h++]=e[r++];return h},t.decompressFrame=function(e,r){var n,i,s,a,c=0,h=0;if(o.readU32(e,c)!==l)throw new Error("invalid magic number");if(c+=4,64!==(192&(a=e[c++])))throw new Error("incompatible descriptor version");n=0!==(16&a),i=0!==(4&a),s=0!==(8&a);var g=e[c++]>>4&7;if(void 0===u[g])throw new Error("invalid block size");for(s&&(c+=8),c++;;){var p;if(p=o.readU32(e,c),c+=4,0===p)break;if(n&&(c+=4),0!==(p&d)){p&=2147483647;for(var m=0;m<p;m++)r[h++]=e[c++]}else h=t.decompressBlock(e,r,c,p,h),c+=p}return i&&(c+=4),h},t.compressFrame=function(e,r){var s=0;o.writeU32(r,s,l),s+=4,r[s++]=64,r[s++]=112,r[s]=n.hash(0,r,4,s-4)>>8,s++;var d=u[7],h=e.length,g=0;for(!function(e){for(var t=0;t<i;t++)c[t]=0}();h>0;){var p,m=h>d?d:h;if((p=t.compressBlock(e,a,g,m,c))>m||0===p){o.writeU32(r,s,2147483648|m),s+=4;for(var f=g+m;g<f;)r[s++]=e[g++];h-=m}else{o.writeU32(r,s,p),s+=4;for(var v=0;v<p;)r[s++]=a[v++];g+=m,h-=m}}return o.writeU32(r,s,0),s+=4},t.decompress=function(e,r){var n,o;return void 0===r&&(r=t.decompressBound(e)),n=t.makeBuffer(r),(o=t.decompressFrame(e,n))!==r&&(n=g(n,0,o)),n},t.compress=function(e,r){var n,o;return void 0===r&&(r=t.compressBound(e.length)),n=t.makeBuffer(r),(o=t.compressFrame(e,n))!==r&&(n=g(n,0,o)),n}},68105:(e,t)=>{t.hashU32=function(e){return-1252372727^(e=(e=(e=(e=-949894596^(e=(e|=0)+2127912214+(e<<12)|0)^e>>>19)+374761393+(e<<5)|0)+-744332180^e<<9)+-42973499+(e<<3)|0)^e>>>16},t.readU64=function(e,t){var r=0;return r|=e[t++]|0,r|=e[t++]<<8,r|=e[t++]<<16,r|=e[t++]<<24,r|=e[t++]<<32,r|=e[t++]<<40,r|=e[t++]<<48,r|=e[t++]<<56},t.readU32=function(e,t){var r=0;return r|=e[t++]|0,r|=e[t++]<<8,r|=e[t++]<<16,r|=e[t++]<<24},t.writeU32=function(e,t,r){e[t++]=255&r,e[t++]=r>>8&255,e[t++]=r>>16&255,e[t++]=r>>24&255},t.imul=function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16)*n+r*(t>>>16)<<16)|0}},43028:(e,t,r)=>{var n=r(68105),o=2654435761,i=2246822519,s=3266489917,a=668265263,c=374761393;function l(e,t){return(e|=0)>>>(32-(t|=0)|0)|e<<t}function d(e,t,r){return e|=0,t|=0,r|=0,0|n.imul(e>>>(32-t|0)|e<<t,r)}function u(e,t){return(e|=0)>>>(t|=0)^e}function h(e,t,r,o,i){return d(n.imul(t,r)+e,o,i)}function g(e,t,r){return d(e+n.imul(t[r],c),11,o)}function p(e,t,r){return h(e,n.readU32(t,r),s,17,a)}function m(e,t,r){return[h(e[0],n.readU32(t,r+0),i,13,o),h(e[1],n.readU32(t,r+4),i,13,o),h(e[2],n.readU32(t,r+8),i,13,o),h(e[3],n.readU32(t,r+12),i,13,o)]}t.hash=function(e,t,r,a){var d,h;if(h=a,a>=16){for(d=[e+o+i,e+i,e,e-o];a>=16;)d=m(d,t,r),r+=16,a-=16;d=l(d[0],1)+l(d[1],7)+l(d[2],12)+l(d[3],18)+h}else d=e+c+a>>>0;for(;a>=4;)d=p(d,t,r),r+=4,a-=4;for(;a>0;)d=g(d,t,r),r++,a--;return(d=u(n.imul(u(n.imul(u(d,15),i),13),s),16))>>>0}},17541:(e,t,r)=>{"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},42123:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,o){for(var i,s,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in i=Object(arguments[c]))r.call(i,l)&&(a[l]=i[l]);if(t){s=t(i);for(var d=0;d<s.length;d++)n.call(i,s[d])&&(a[s[d]]=i[s[d]])}}return a}},68206:(e,t,r)=>{var n="function"===typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,i=n&&o&&"function"===typeof o.get?o.get:null,s=n&&Map.prototype.forEach,a="function"===typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=a&&c&&"function"===typeof c.get?c.get:null,d=a&&Set.prototype.forEach,u="function"===typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,h="function"===typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,g="function"===typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,f=Function.prototype.toString,v=String.prototype.match,y=String.prototype.slice,b=String.prototype.replace,S=String.prototype.toUpperCase,C=String.prototype.toLowerCase,k=RegExp.prototype.test,w=Array.prototype.concat,P=Array.prototype.join,E=Array.prototype.slice,T=Math.floor,I="function"===typeof BigInt?BigInt.prototype.valueOf:null,N=Object.getOwnPropertySymbols,F="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?Symbol.prototype.toString:null,D="function"===typeof Symbol&&"object"===typeof Symbol.iterator,O="function"===typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===D||"symbol")?Symbol.toStringTag:null,B=Object.prototype.propertyIsEnumerable,x=("function"===typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function L(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||k.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"===typeof e){var n=e<0?-T(-e):T(e);if(n!==e){var o=String(n),i=y.call(t,o.length+1);return b.call(o,r,"$&_")+"."+b.call(b.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var A=r(42634),R=A.custom,M=j(R)?R:null;function _(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function z(e){return b.call(String(e),/"/g,"&quot;")}function H(e){return"[object Array]"===G(e)&&(!O||!("object"===typeof e&&O in e))}function U(e){return"[object RegExp]"===G(e)&&(!O||!("object"===typeof e&&O in e))}function j(e){if(D)return e&&"object"===typeof e&&e instanceof Symbol;if("symbol"===typeof e)return!0;if(!e||"object"!==typeof e||!F)return!1;try{return F.call(e),!0}catch(t){}return!1}e.exports=function e(t,n,o,a){var c=n||{};if(V(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(V(c,"maxStringLength")&&("number"===typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var m=!V(c,"customInspect")||c.customInspect;if("boolean"!==typeof m&&"symbol"!==m)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(V(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(V(c,"numericSeparator")&&"boolean"!==typeof c.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var S=c.numericSeparator;if("undefined"===typeof t)return"undefined";if(null===t)return"null";if("boolean"===typeof t)return t?"true":"false";if("string"===typeof t)return K(t,c);if("number"===typeof t){if(0===t)return 1/0/t>0?"0":"-0";var k=String(t);return S?L(t,k):k}if("bigint"===typeof t){var T=String(t)+"n";return S?L(t,T):T}var N="undefined"===typeof c.depth?5:c.depth;if("undefined"===typeof o&&(o=0),o>=N&&N>0&&"object"===typeof t)return H(t)?"[Array]":"[Object]";var R=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"===typeof e.indent&&e.indent>0))return null;r=P.call(Array(e.indent+1)," ")}return{base:r,prev:P.call(Array(t+1),r)}}(c,o);if("undefined"===typeof a)a=[];else if(W(a,t)>=0)return"[Circular]";function q(t,r,n){if(r&&(a=E.call(a)).push(r),n){var i={depth:c.depth};return V(c,"quoteStyle")&&(i.quoteStyle=c.quoteStyle),e(t,i,o+1,a)}return e(t,c,o+1,a)}if("function"===typeof t&&!U(t)){var J=function(e){if(e.name)return e.name;var t=v.call(f.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),ee=Y(t,q);return"[Function"+(J?": "+J:" (anonymous)")+"]"+(ee.length>0?" { "+P.call(ee,", ")+" }":"")}if(j(t)){var te=D?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):F.call(t);return"object"!==typeof t||D?te:Q(te)}if(function(e){if(!e||"object"!==typeof e)return!1;if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"===typeof e.nodeName&&"function"===typeof e.getAttribute}(t)){for(var re="<"+C.call(String(t.nodeName)),ne=t.attributes||[],oe=0;oe<ne.length;oe++)re+=" "+ne[oe].name+"="+_(z(ne[oe].value),"double",c);return re+=">",t.childNodes&&t.childNodes.length&&(re+="..."),re+="</"+C.call(String(t.nodeName))+">"}if(H(t)){if(0===t.length)return"[]";var ie=Y(t,q);return R&&!function(e){for(var t=0;t<e.length;t++)if(W(e[t],"\n")>=0)return!1;return!0}(ie)?"["+$(ie,R)+"]":"[ "+P.call(ie,", ")+" ]"}if(function(e){return"[object Error]"===G(e)&&(!O||!("object"===typeof e&&O in e))}(t)){var se=Y(t,q);return"cause"in Error.prototype||!("cause"in t)||B.call(t,"cause")?0===se.length?"["+String(t)+"]":"{ ["+String(t)+"] "+P.call(se,", ")+" }":"{ ["+String(t)+"] "+P.call(w.call("[cause]: "+q(t.cause),se),", ")+" }"}if("object"===typeof t&&m){if(M&&"function"===typeof t[M]&&A)return A(t,{depth:N-o});if("symbol"!==m&&"function"===typeof t.inspect)return t.inspect()}if(function(e){if(!i||!e||"object"!==typeof e)return!1;try{i.call(e);try{l.call(e)}catch(re){return!0}return e instanceof Map}catch(t){}return!1}(t)){var ae=[];return s&&s.call(t,(function(e,r){ae.push(q(r,t,!0)+" => "+q(e,t))})),Z("Map",i.call(t),ae,R)}if(function(e){if(!l||!e||"object"!==typeof e)return!1;try{l.call(e);try{i.call(e)}catch(t){return!0}return e instanceof Set}catch(r){}return!1}(t)){var ce=[];return d&&d.call(t,(function(e){ce.push(q(e,t))})),Z("Set",l.call(t),ce,R)}if(function(e){if(!u||!e||"object"!==typeof e)return!1;try{u.call(e,u);try{h.call(e,h)}catch(re){return!0}return e instanceof WeakMap}catch(t){}return!1}(t))return X("WeakMap");if(function(e){if(!h||!e||"object"!==typeof e)return!1;try{h.call(e,h);try{u.call(e,u)}catch(re){return!0}return e instanceof WeakSet}catch(t){}return!1}(t))return X("WeakSet");if(function(e){if(!g||!e||"object"!==typeof e)return!1;try{return g.call(e),!0}catch(t){}return!1}(t))return X("WeakRef");if(function(e){return"[object Number]"===G(e)&&(!O||!("object"===typeof e&&O in e))}(t))return Q(q(Number(t)));if(function(e){if(!e||"object"!==typeof e||!I)return!1;try{return I.call(e),!0}catch(t){}return!1}(t))return Q(q(I.call(t)));if(function(e){return"[object Boolean]"===G(e)&&(!O||!("object"===typeof e&&O in e))}(t))return Q(p.call(t));if(function(e){return"[object String]"===G(e)&&(!O||!("object"===typeof e&&O in e))}(t))return Q(q(String(t)));if("undefined"!==typeof window&&t===window)return"{ [object Window] }";if(t===r.g)return"{ [object globalThis] }";if(!function(e){return"[object Date]"===G(e)&&(!O||!("object"===typeof e&&O in e))}(t)&&!U(t)){var le=Y(t,q),de=x?x(t)===Object.prototype:t instanceof Object||t.constructor===Object,ue=t instanceof Object?"":"null prototype",he=!de&&O&&Object(t)===t&&O in t?y.call(G(t),8,-1):ue?"Object":"",ge=(de||"function"!==typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||ue?"["+P.call(w.call([],he||[],ue||[]),": ")+"] ":"");return 0===le.length?ge+"{}":R?ge+"{"+$(le,R)+"}":ge+"{ "+P.call(le,", ")+" }"}return String(t)};var q=Object.prototype.hasOwnProperty||function(e){return e in this};function V(e,t){return q.call(e,t)}function G(e){return m.call(e)}function W(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function K(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return K(y.call(e,0,t.maxStringLength),t)+n}return _(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,J),"single",t)}function J(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+S.call(t.toString(16))}function Q(e){return"Object("+e+")"}function X(e){return e+" { ? }"}function Z(e,t,r,n){return e+" ("+t+") {"+(n?$(r,n):P.call(r,", "))+"}"}function $(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+P.call(e,","+r)+"\n"+t.prev}function Y(e,t){var r=H(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=V(e,o)?t(e[o],e):""}var i,s="function"===typeof N?N(e):[];if(D){i={};for(var a=0;a<s.length;a++)i["$"+s[a]]=s[a]}for(var c in e)V(e,c)&&(r&&String(Number(c))===c&&c<e.length||D&&i["$"+c]instanceof Symbol||(k.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"===typeof N)for(var l=0;l<s.length;l++)B.call(e,s[l])&&n.push("["+t(s[l])+"]: "+t(e[s[l]],e));return n}},53316:e=>{"use strict";function t(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,n="",o=0,i=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(i===a-1||1===s);else if(i!==a-1&&2===s){if(n.length<2||2!==o||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var c=n.lastIndexOf("/");if(c!==n.length-1){-1===c?(n="",o=0):o=(n=n.slice(0,c)).length-1-n.lastIndexOf("/"),i=a,s=0;continue}}else if(2===n.length||1===n.length){n="",o=0,i=a,s=0;continue}t&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+e.slice(i+1,a):n=e.slice(i+1,a),o=a-i-1;i=a,s=0}else 46===r&&-1!==s?++s:s=-1}return n}var n={resolve:function(){for(var e,n="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var s;i>=0?s=arguments[i]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(n=s+"/"+n,o=47===s.charCodeAt(0))}return n=r(n,!o),o?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(e){if(t(e),0===e.length)return".";var n=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!n)).length||n||(e="."),e.length>0&&o&&(e+="/"),n?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var o=arguments[r];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":n.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r)return"";if((e=n.resolve(e))===(r=n.resolve(r)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var i=e.length,s=i-o,a=1;a<r.length&&47===r.charCodeAt(a);++a);for(var c=r.length-a,l=s<c?s:c,d=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===r.charCodeAt(a+u))return r.slice(a+u+1);if(0===u)return r.slice(a+u)}else s>l&&(47===e.charCodeAt(o+u)?d=u:0===u&&(d=0));break}var h=e.charCodeAt(o+u);if(h!==r.charCodeAt(a+u))break;47===h&&(d=u)}var g="";for(u=o+d+1;u<=i;++u)u!==i&&47!==e.charCodeAt(u)||(0===g.length?g+="..":g+="/..");return g.length>0?g+r.slice(a+d):(a+=d,47===r.charCodeAt(a)&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),n=47===r,o=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(r=e.charCodeAt(s))){if(!i){o=s;break}}else i=!1;return-1===o?n?"/":".":n&&1===o?"//":e.slice(0,o)},basename:function(e,r){if(void 0!==r&&"string"!==typeof r)throw new TypeError('"ext" argument must be a string');t(e);var n,o=0,i=-1,s=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,c=-1;for(n=e.length-1;n>=0;--n){var l=e.charCodeAt(n);if(47===l){if(!s){o=n+1;break}}else-1===c&&(s=!1,c=n+1),a>=0&&(l===r.charCodeAt(a)?-1===--a&&(i=n):(a=-1,i=c))}return o===i?i=c:-1===i&&(i=e.length),e.slice(o,i)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!s){o=n+1;break}}else-1===i&&(s=!1,i=n+1);return-1===i?"":e.slice(o,i)},extname:function(e){t(e);for(var r=-1,n=0,o=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(i=!1,o=a+1),46===c?-1===r?r=a:1!==s&&(s=1):-1!==r&&(s=-1);else if(!i){n=a+1;break}}return-1===r||-1===o||0===s||1===s&&r===o-1&&r===n+1?"":e.slice(r,o)},format:function(e){if(null===e||"object"!==typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+n:r+e+n:n}("/",e)},parse:function(e){t(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var n,o=e.charCodeAt(0),i=47===o;i?(r.root="/",n=1):n=0;for(var s=-1,a=0,c=-1,l=!0,d=e.length-1,u=0;d>=n;--d)if(47!==(o=e.charCodeAt(d)))-1===c&&(l=!1,c=d+1),46===o?-1===s?s=d:1!==u&&(u=1):-1!==s&&(u=-1);else if(!l){a=d+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(r.base=r.name=0===a&&i?e.slice(1,c):e.slice(a,c)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,c)):(r.name=e.slice(a,s),r.base=e.slice(a,c)),r.ext=e.slice(s,c)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n},14202:(e,t,r)=>{"use strict";var n=r(42123),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var s=60109,a=60110,c=60112;t.Suspense=60113;var l=60115,d=60116;if("function"===typeof Symbol&&Symbol.for){var u=Symbol.for;o=u("react.element"),i=u("react.portal"),t.Fragment=u("react.fragment"),t.StrictMode=u("react.strict_mode"),t.Profiler=u("react.profiler"),s=u("react.provider"),a=u("react.context"),c=u("react.forward_ref"),t.Suspense=u("react.suspense"),l=u("react.memo"),d=u("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function f(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}function v(){}function y(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=f.prototype;var b=y.prototype=new v;b.constructor=y,n(b,f.prototype),b.isPureReactComponent=!0;var S={current:null},C=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,r){var n,i={},s=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,n)&&!k.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===i[n]&&(i[n]=c[n]);return{$$typeof:o,type:e,key:s,ref:a,props:i,_owner:S.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,r,n,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case o:case i:c=!0}}if(c)return s=s(c=e),e=""===n?"."+T(c,0):n,Array.isArray(s)?(r="",null!=e&&(r=e.replace(E,"$&/")+"/"),I(s,t,r,"",(function(e){return e}))):null!=s&&(P(s)&&(s=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+e)),t.push(s)),1;if(c=0,n=""===n?".":n+":",Array.isArray(e))for(var l=0;l<e.length;l++){var d=n+T(a=e[l],l);c+=I(a,t,r,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),l=0;!(a=e.next()).done;)c+=I(a=a.value,t,r,d=n+T(a,l++),s);else if("object"===a)throw t=""+e,Error(g(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function N(e,t,r){if(null==e)return e;var n=[],o=0;return I(e,n,"","",(function(e){return t.call(r,e,o++)})),n}function F(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var D={current:null};function O(){var e=D.current;if(null===e)throw Error(g(321));return e}var B={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:n};t.Children={map:N,forEach:function(e,t,r){N(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error(g(143));return e}},t.Component=f,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error(g(267,e));var i=n({},e.props),s=e.key,a=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,c=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)C.call(t,d)&&!k.hasOwnProperty(d)&&(i[d]=void 0===t[d]&&void 0!==l?l[d]:t[d])}var d=arguments.length-2;if(1===d)i.children=r;else if(1<d){l=Array(d);for(var u=0;u<d;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:o,type:e.type,key:s,ref:a,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:a,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:l,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return O().useCallback(e,t)},t.useContext=function(e,t){return O().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return O().useEffect(e,t)},t.useImperativeHandle=function(e,t,r){return O().useImperativeHandle(e,t,r)},t.useLayoutEffect=function(e,t){return O().useLayoutEffect(e,t)},t.useMemo=function(e,t){return O().useMemo(e,t)},t.useReducer=function(e,t,r){return O().useReducer(e,t,r)},t.useRef=function(e){return O().useRef(e)},t.useState=function(e){return O().useState(e)},t.version="17.0.2"},65043:(e,t,r)=>{"use strict";e.exports=r(14202)},75438:(e,t,r)=>{"use strict";var n=r(60002),o=r(74992),i=r(12101)(),s=r(95558),a=r(54902),c=n("%Math.floor%");e.exports=function(e,t){if("function"!==typeof e)throw new a("`fn` is not a function");if("number"!==typeof t||t<0||t>4294967295||c(t)!==t)throw new a("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,l=!0;if("length"in e&&s){var d=s(e,"length");d&&!d.configurable&&(n=!1),d&&!d.writable&&(l=!1)}return(n||l||!r)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},19269:(e,t,r)=>{"use strict";var n=r(60002),o=r(12028),i=r(68206),s=r(54902),a=n("%WeakMap%",!0),c=n("%Map%",!0),l=o("WeakMap.prototype.get",!0),d=o("WeakMap.prototype.set",!0),u=o("WeakMap.prototype.has",!0),h=o("Map.prototype.get",!0),g=o("Map.prototype.set",!0),p=o("Map.prototype.has",!0),m=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new s("Side channel does not contain "+i(e))},get:function(n){if(a&&n&&("object"===typeof n||"function"===typeof n)){if(e)return l(e,n)}else if(c){if(t)return h(t,n)}else if(r)return function(e,t){var r=m(e,t);return r&&r.value}(r,n)},has:function(n){if(a&&n&&("object"===typeof n||"function"===typeof n)){if(e)return u(e,n)}else if(c){if(t)return p(t,n)}else if(r)return function(e,t){return!!m(e,t)}(r,n);return!1},set:function(n,o){a&&n&&("object"===typeof n||"function"===typeof n)?(e||(e=new a),d(e,n,o)):c?(t||(t=new c),g(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=m(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n}},91907:function(e,t,r){var n;e=r.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof r.g&&r.g;i.global!==i&&i.window!==i&&i.self;var s,a=2147483647,c=36,l=1,d=26,u=38,h=700,g=72,p=128,m="-",f=/^xn--/,v=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=c-l,C=Math.floor,k=String.fromCharCode;function w(e){throw new RangeError(b[e])}function P(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function E(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+P((e=e.replace(y,".")).split("."),t).join(".")}function T(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function I(e){return P(e,(function(e){var t="";return e>65535&&(t+=k((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=k(e)})).join("")}function N(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function F(e,t,r){var n=0;for(e=r?C(e/h):e>>1,e+=C(e/t);e>S*d>>1;n+=c)e=C(e/S);return C(n+(S+1)*e/(e+u))}function D(e){var t,r,n,o,i,s,u,h,f,v,y,b=[],S=e.length,k=0,P=p,E=g;for((r=e.lastIndexOf(m))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&w("not-basic"),b.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<S;){for(i=k,s=1,u=c;o>=S&&w("invalid-input"),((h=(y=e.charCodeAt(o++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||h>C((a-k)/s))&&w("overflow"),k+=h*s,!(h<(f=u<=E?l:u>=E+d?d:u-E));u+=c)s>C(a/(v=c-f))&&w("overflow"),s*=v;E=F(k-i,t=b.length+1,0==i),C(k/t)>a-P&&w("overflow"),P+=C(k/t),k%=t,b.splice(k++,0,P)}return I(b)}function O(e){var t,r,n,o,i,s,u,h,f,v,y,b,S,P,E,I=[];for(b=(e=T(e)).length,t=p,r=0,i=g,s=0;s<b;++s)(y=e[s])<128&&I.push(k(y));for(n=o=I.length,o&&I.push(m);n<b;){for(u=a,s=0;s<b;++s)(y=e[s])>=t&&y<u&&(u=y);for(u-t>C((a-r)/(S=n+1))&&w("overflow"),r+=(u-t)*S,t=u,s=0;s<b;++s)if((y=e[s])<t&&++r>a&&w("overflow"),y==t){for(h=r,f=c;!(h<(v=f<=i?l:f>=i+d?d:f-i));f+=c)E=h-v,P=c-v,I.push(k(N(v+E%P,0))),h=C(E/P);I.push(k(N(h,0))),i=F(r,S,n==o),r=0,++n}++r,++t}return I.join("")}s={version:"1.4.1",ucs2:{decode:T,encode:I},decode:D,encode:O,toASCII:function(e){return E(e,(function(e){return v.test(e)?"xn--"+O(e):e}))},toUnicode:function(e){return E(e,(function(e){return f.test(e)?D(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return s}.call(t,r,t,e))||(e.exports=n)}()},44737:e=>{"use strict";var t=String.prototype.replace,r=/%20/g,n="RFC1738",o="RFC3986";e.exports={default:o,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:o}},76857:(e,t,r)=>{"use strict";var n=r(55808),o=r(48638),i=r(44737);e.exports={formats:i,parse:o,stringify:n}},48638:(e,t,r)=>{"use strict";var n=r(33940),o=Object.prototype.hasOwnProperty,i=Array.isArray,s={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"===typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},l=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,a=r.depth>0&&/(\[[^[\]]*])/.exec(i),l=a?i.slice(0,a.index):i,d=[];if(l){if(!r.plainObjects&&o.call(Object.prototype,l)&&!r.allowPrototypes)return;d.push(l)}for(var u=0;r.depth>0&&null!==(a=s.exec(i))&&u<r.depth;){if(u+=1,!r.plainObjects&&o.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;d.push(a[1])}return a&&d.push("["+i.slice(a.index)+"]"),function(e,t,r,n){for(var o=n?t:c(t,r),i=e.length-1;i>=0;--i){var s,a=e[i];if("[]"===a&&r.parseArrays)s=r.allowEmptyArrays&&""===o?[]:[].concat(o);else{s=r.plainObjects?Object.create(null):{};var l="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,d=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,u=parseInt(d,10);r.parseArrays||""!==d?!isNaN(u)&&a!==d&&String(u)===d&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(s=[])[u]=o:"__proto__"!==d&&(s[d]=o):s={0:o}}o=s}return o}(d,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return s;if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.decodeDotInKeys&&"boolean"!==typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.decoder&&"undefined"!==typeof e.decoder&&"function"!==typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"===typeof e.charset?s.charset:e.charset,r="undefined"===typeof e.duplicates?s.duplicates:e.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:"undefined"===typeof e.allowDots?!0===e.decodeDotInKeys||s.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:s.allowEmptyArrays,allowPrototypes:"boolean"===typeof e.allowPrototypes?e.allowPrototypes:s.allowPrototypes,allowSparse:"boolean"===typeof e.allowSparse?e.allowSparse:s.allowSparse,arrayLimit:"number"===typeof e.arrayLimit?e.arrayLimit:s.arrayLimit,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:s.charsetSentinel,comma:"boolean"===typeof e.comma?e.comma:s.comma,decodeDotInKeys:"boolean"===typeof e.decodeDotInKeys?e.decodeDotInKeys:s.decodeDotInKeys,decoder:"function"===typeof e.decoder?e.decoder:s.decoder,delimiter:"string"===typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:s.delimiter,depth:"number"===typeof e.depth||!1===e.depth?+e.depth:s.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof e.interpretNumericEntities?e.interpretNumericEntities:s.interpretNumericEntities,parameterLimit:"number"===typeof e.parameterLimit?e.parameterLimit:s.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"===typeof e.plainObjects?e.plainObjects:s.plainObjects,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:s.strictNullHandling}}(t);if(""===e||null===e||"undefined"===typeof e)return r.plainObjects?Object.create(null):{};for(var d="string"===typeof e?function(e,t){var r,l={__proto__:null},d=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=t.parameterLimit===1/0?void 0:t.parameterLimit,h=d.split(t.delimiter,u),g=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<h.length;++r)0===h[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[r]?p="utf-8":"utf8=%26%2310003%3B"===h[r]&&(p="iso-8859-1"),g=r,r=h.length);for(r=0;r<h.length;++r)if(r!==g){var m,f,v=h[r],y=v.indexOf("]="),b=-1===y?v.indexOf("="):y+1;-1===b?(m=t.decoder(v,s.decoder,p,"key"),f=t.strictNullHandling?null:""):(m=t.decoder(v.slice(0,b),s.decoder,p,"key"),f=n.maybeMap(c(v.slice(b+1),t),(function(e){return t.decoder(e,s.decoder,p,"value")}))),f&&t.interpretNumericEntities&&"iso-8859-1"===p&&(f=a(f)),v.indexOf("[]=")>-1&&(f=i(f)?[f]:f);var S=o.call(l,m);S&&"combine"===t.duplicates?l[m]=n.combine(l[m],f):S&&"last"!==t.duplicates||(l[m]=f)}return l}(e,r):e,u=r.plainObjects?Object.create(null):{},h=Object.keys(d),g=0;g<h.length;++g){var p=h[g],m=l(p,d[p],r,"string"===typeof e);u=n.merge(u,m,r)}return!0===r.allowSparse?u:n.compact(u)}},55808:(e,t,r)=>{"use strict";var n=r(19269),o=r(33940),i=r(44737),s=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,l=Array.prototype.push,d=function(e,t){l.apply(e,c(t)?t:[t])},u=Date.prototype.toISOString,h=i.default,g={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:o.encode,encodeValuesOnly:!1,format:h,formatter:i.formatters[h],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},p={},m=function e(t,r,i,s,a,l,u,h,m,f,v,y,b,S,C,k,w,P){for(var E,T=t,I=P,N=0,F=!1;void 0!==(I=I.get(p))&&!F;){var D=I.get(t);if(N+=1,"undefined"!==typeof D){if(D===N)throw new RangeError("Cyclic object value");F=!0}"undefined"===typeof I.get(p)&&(N=0)}if("function"===typeof f?T=f(r,T):T instanceof Date?T=b(T):"comma"===i&&c(T)&&(T=o.maybeMap(T,(function(e){return e instanceof Date?b(e):e}))),null===T){if(l)return m&&!k?m(r,g.encoder,w,"key",S):r;T=""}if("string"===typeof(E=T)||"number"===typeof E||"boolean"===typeof E||"symbol"===typeof E||"bigint"===typeof E||o.isBuffer(T))return m?[C(k?r:m(r,g.encoder,w,"key",S))+"="+C(m(T,g.encoder,w,"value",S))]:[C(r)+"="+C(String(T))];var O,B=[];if("undefined"===typeof T)return B;if("comma"===i&&c(T))k&&m&&(T=o.maybeMap(T,m)),O=[{value:T.length>0?T.join(",")||null:void 0}];else if(c(f))O=f;else{var x=Object.keys(T);O=v?x.sort(v):x}var L=h?r.replace(/\./g,"%2E"):r,A=s&&c(T)&&1===T.length?L+"[]":L;if(a&&c(T)&&0===T.length)return A+"[]";for(var R=0;R<O.length;++R){var M=O[R],_="object"===typeof M&&"undefined"!==typeof M.value?M.value:T[M];if(!u||null!==_){var z=y&&h?M.replace(/\./g,"%2E"):M,H=c(T)?"function"===typeof i?i(A,z):A:A+(y?"."+z:"["+z+"]");P.set(t,N);var U=n();U.set(p,P),d(B,e(_,H,i,s,a,l,u,h,"comma"===i&&k&&c(T)?null:m,f,v,y,b,S,C,k,w,U))}}return B};e.exports=function(e,t){var r,o=e,l=function(e){if(!e)return g;if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.encodeDotInKeys&&"boolean"!==typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||g.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if("undefined"!==typeof e.format){if(!s.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n,o=i.formatters[r],l=g.filter;if(("function"===typeof e.filter||c(e.filter))&&(l=e.filter),n=e.arrayFormat in a?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":g.arrayFormat,"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var d="undefined"===typeof e.allowDots?!0===e.encodeDotInKeys||g.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:g.addQueryPrefix,allowDots:d,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:g.allowEmptyArrays,arrayFormat:n,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:g.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:"undefined"===typeof e.delimiter?g.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:g.encode,encodeDotInKeys:"boolean"===typeof e.encodeDotInKeys?e.encodeDotInKeys:g.encodeDotInKeys,encoder:"function"===typeof e.encoder?e.encoder:g.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:g.encodeValuesOnly,filter:l,format:r,formatter:o,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:g.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:g.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:g.strictNullHandling}}(t);"function"===typeof l.filter?o=(0,l.filter)("",o):c(l.filter)&&(r=l.filter);var u=[];if("object"!==typeof o||null===o)return"";var h=a[l.arrayFormat],p="comma"===h&&l.commaRoundTrip;r||(r=Object.keys(o)),l.sort&&r.sort(l.sort);for(var f=n(),v=0;v<r.length;++v){var y=r[v];l.skipNulls&&null===o[y]||d(u,m(o[y],y,h,p,l.allowEmptyArrays,l.strictNullHandling,l.skipNulls,l.encodeDotInKeys,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,f))}var b=u.join(l.delimiter),S=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?S+="utf8=%26%2310003%3B&":S+="utf8=%E2%9C%93&"),b.length>0?S+b:""}},33940:(e,t,r)=>{"use strict";var n=r(44737),o=Object.prototype.hasOwnProperty,i=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!==typeof e[n]&&(r[n]=e[n]);return r},c=1024;e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],s=o.obj[o.prop],a=Object.keys(s),c=0;c<a.length;++c){var l=a[c],d=s[l];"object"===typeof d&&null!==d&&-1===r.indexOf(d)&&(t.push({obj:s,prop:l}),r.push(d))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)"undefined"!==typeof r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(o){return n}},encode:function(e,t,r,o,i){if(0===e.length)return e;var a=e;if("symbol"===typeof e?a=Symbol.prototype.toString.call(e):"string"!==typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var l="",d=0;d<a.length;d+=c){for(var u=a.length>=c?a.slice(d,d+c):a,h=[],g=0;g<u.length;++g){var p=u.charCodeAt(g);45===p||46===p||95===p||126===p||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||i===n.RFC1738&&(40===p||41===p)?h[h.length]=u.charAt(g):p<128?h[h.length]=s[p]:p<2048?h[h.length]=s[192|p>>6]+s[128|63&p]:p<55296||p>=57344?h[h.length]=s[224|p>>12]+s[128|p>>6&63]+s[128|63&p]:(g+=1,p=65536+((1023&p)<<10|1023&u.charCodeAt(g)),h[h.length]=s[240|p>>18]+s[128|p>>12&63]+s[128|p>>6&63]+s[128|63&p])}l+=h.join("")}return l},isBuffer:function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!==typeof r){if(i(t))t.push(r);else{if(!t||"object"!==typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!o.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(r);var s=t;return i(t)&&!i(r)&&(s=a(t,n)),i(t)&&i(r)?(r.forEach((function(r,i){if(o.call(t,i)){var s=t[i];s&&"object"===typeof s&&r&&"object"===typeof r?t[i]=e(s,r,n):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var s=r[i];return o.call(t,i)?t[i]=e(t[i],s,n):t[i]=s,t}),s)}}},74080:(e,t,r)=>{"use strict";var n=r(91907);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var i=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),d=["%","/","?",";","#"].concat(l),u=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},f={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(76857);function y(e,t,r){if(e&&"object"===typeof e&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if("string"!==typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var y=e=c.join(s);if(y=y.trim(),!r&&1===e.split("#").length){var b=a.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var S=i.exec(y);if(S){var C=(S=S[0]).toLowerCase();this.protocol=C,y=y.substr(S.length)}if(r||S||y.match(/^\/\/[^@/]+@[^@/]+/)){var k="//"===y.substr(0,2);!k||S&&m[S]||(y=y.substr(2),this.slashes=!0)}if(!m[S]&&(k||S&&!f[S])){for(var w,P,E=-1,T=0;T<u.length;T++){-1!==(I=y.indexOf(u[T]))&&(-1===E||I<E)&&(E=I)}-1!==(P=-1===E?y.lastIndexOf("@"):y.lastIndexOf("@",E))&&(w=y.slice(0,P),y=y.slice(P+1),this.auth=decodeURIComponent(w)),E=-1;for(T=0;T<d.length;T++){var I;-1!==(I=y.indexOf(d[T]))&&(-1===E||I<E)&&(E=I)}-1===E&&(E=y.length),this.host=y.slice(0,E),y=y.slice(E),this.parseHost(),this.hostname=this.hostname||"";var N="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!N)for(var F=this.hostname.split(/\./),D=(T=0,F.length);T<D;T++){var O=F[T];if(O&&!O.match(h)){for(var B="",x=0,L=O.length;x<L;x++)O.charCodeAt(x)>127?B+="x":B+=O[x];if(!B.match(h)){var A=F.slice(0,T),R=F.slice(T+1),M=O.match(g);M&&(A.push(M[1]),R.unshift(M[2])),R.length&&(y="/"+R.join(".")+y),this.hostname=A.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),N||(this.hostname=n.toASCII(this.hostname));var _=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+_,this.href+=this.host,N&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!p[C])for(T=0,D=l.length;T<D;T++){var H=l[T];if(-1!==y.indexOf(H)){var U=encodeURIComponent(H);U===H&&(U=escape(H)),y=y.split(H).join(U)}}var j=y.indexOf("#");-1!==j&&(this.hash=y.substr(j),y=y.slice(0,j));var q=y.indexOf("?");if(-1!==q?(this.search=y.substr(q),this.query=y.substr(q+1),t&&(this.query=v.parse(this.query)),y=y.slice(0,q)):t&&(this.search="",this.query={}),y&&(this.pathname=y),f[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){_=this.pathname||"";var V=this.search||"";this.path=_+V}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&"object"===typeof this.query&&Object.keys(this.query).length&&(i=v.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||f[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(y(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if("string"===typeof e){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var l=a[c];"protocol"!==l&&(r[l]=e[l])}return f[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!f[e.protocol]){for(var d=Object.keys(e),u=0;u<d.length;u++){var h=d[u];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||m[e.protocol])r.pathname=e.pathname;else{for(var g=(e.pathname||"").split("/");g.length&&!(e.host=g.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==g[0]&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",v=r.search||"";r.path=p+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),S=b||y||r.host&&e.pathname,C=S,k=r.pathname&&r.pathname.split("/")||[],w=(g=e.pathname&&e.pathname.split("/")||[],r.protocol&&!f[r.protocol]);if(w&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===g[0]?g[0]=e.host:g.unshift(e.host)),e.host=null),S=S&&(""===g[0]||""===k[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=g;else if(g.length)k||(k=[]),k.pop(),k=k.concat(g),r.search=e.search,r.query=e.query;else if(null!=e.search){if(w)r.host=k.shift(),r.hostname=r.host,(N=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=N.shift(),r.hostname=N.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var P=k.slice(-1)[0],E=(r.host||e.host||k.length>1)&&("."===P||".."===P)||""===P,T=0,I=k.length;I>=0;I--)"."===(P=k[I])?k.splice(I,1):".."===P?(k.splice(I,1),T++):T&&(k.splice(I,1),T--);if(!S&&!C)for(;T--;T)k.unshift("..");!S||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),E&&"/"!==k.join("/").substr(-1)&&k.push("");var N,F=""===k[0]||k[0]&&"/"===k[0].charAt(0);w&&(r.hostname=F?"":k.length?k.shift():"",r.host=r.hostname,(N=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=N.shift(),r.hostname=N.shift(),r.host=r.hostname));return(S=S||r.host&&k.length)&&!F&&k.unshift(""),k.length>0?r.pathname=k.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=y,t.resolve=function(e,t){return y(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?y(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"===typeof e&&(e=y(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o},51238:(e,t,r)=>{"use strict";var n;r.d(t,{A:()=>u});var o=new Uint8Array(16);function i(){if(!n&&!(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"===typeof e&&s.test(e)};for(var c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};const u=function(e,t,r){var n=(e=e||{}).random||(e.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return d(n)}},65606:(e,t,r)=>{var n={"./af-ZA/strings.json":[90976,90976],"./am-ET/strings.json":[79327,79327],"./ar-SA/strings.json":[36077,36077],"./as-IN/strings.json":[6471,6471],"./az-Latn-AZ/strings.json":[69110,69110],"./bg-BG/strings.json":[41514,41514],"./bn-IN/strings.json":[11299,11299],"./bs-Latn-BA/strings.json":[59108,59108],"./ca-ES/strings.json":[89520,89520],"./ca-Es-VALENCIA/strings.json":[69698,69698],"./cs-CZ/strings.json":[94751,94751],"./cy-GB/strings.json":[66561,66561],"./da-DK/strings.json":[57940,57940],"./de-DE/strings.json":[2338,2338],"./el-GR/strings.json":[88974,88974],"./en-GB/strings.json":[10572,10572],"./en-US/strings.json":[16281],"./es-ES/strings.json":[38428,38428],"./es-MX/strings.json":[23329,23329],"./et-EE/strings.json":[55953,55953],"./eu-ES/strings.json":[52326,52326],"./fa-IR/strings.json":[58888,58888],"./fi-FI/strings.json":[4474,4474],"./fil-PH/strings.json":[17925,17925],"./fr-CA/strings.json":[93892,93892],"./fr-FR/strings.json":[26748,26748],"./ga-IE/strings.json":[55346,55346],"./gd-gb/strings.json":[43164,43164],"./gl-ES/strings.json":[77873,77873],"./gu-IN/strings.json":[14183,14183],"./he-IL/strings.json":[97244,97244],"./hi-IN/strings.json":[7374,7374],"./hr-HR/strings.json":[93420,93420],"./hu-HU/strings.json":[36738,36738],"./hy-AM/strings.json":[13039,13039],"./id-ID/strings.json":[22362,22362],"./is-IS/strings.json":[85916,85916],"./it-IT/strings.json":[79450,79450],"./ja-JP/strings.json":[3201,3201],"./ka-GE/strings.json":[76128,76128],"./kk-KZ/strings.json":[85031,85031],"./km-KH/strings.json":[19347,19347],"./kn-IN/strings.json":[96900,96900],"./ko-KR/strings.json":[3763,3763],"./kok-IN/strings.json":[61374,61374],"./lb-LU/strings.json":[57397,57397],"./lt-LT/strings.json":[15520,15520],"./lv-LV/strings.json":[45092,45092],"./mi-NZ/strings.json":[65662,65662],"./mk-MK/strings.json":[12156,12156],"./ml-IN/strings.json":[10632,10632],"./mr-IN/strings.json":[32870,32870],"./ms-MY/strings.json":[40738,40738],"./mt-MT/strings.json":[49306,49306],"./nb-NO/strings.json":[20559,20559],"./ne-NP/strings.json":[41717,41717],"./nl-NL/strings.json":[28688,6307],"./nn-NO/strings.json":[50787,50787],"./or-IN/strings.json":[65156,65156],"./pa-IN/strings.json":[85902,85902],"./pl-PL/strings.json":[62200,62200],"./pt-BR/strings.json":[95164,95164],"./pt-PT/strings.json":[38328,38328],"./quz-PE/strings.json":[5891,5891],"./ro-RO/strings.json":[11354,11354],"./ru-RU/strings.json":[68346,68346],"./sk-SK/strings.json":[10672,10672],"./sl-SI/strings.json":[37801,37801],"./sq-AL/strings.json":[53205,53205],"./sr-Cyrl-BA/strings.json":[7911,7911],"./sr-Cyrl-RS/strings.json":[25621,25621],"./sr-Latn-RS/strings.json":[26676,26676],"./sv-SE/strings.json":[98595,98595],"./ta-IN/strings.json":[9858,9858],"./te-IN/strings.json":[56510,56510],"./th-TH/strings.json":[11072,11072],"./tr-TR/strings.json":[96444,96444],"./tt-RU/strings.json":[12481,12481],"./ug-CN/strings.json":[89441,89441],"./uk-UA/strings.json":[55874,55874],"./ur-PK/strings.json":[18196,18196],"./uz-Latn-UZ/strings.json":[28566,28566],"./vi-VN/strings.json":[89559,89559],"./zh-CN/strings.json":[77771,77771],"./zh-TW/strings.json":[56295,56295]};function o(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return Promise.all(t.slice(1).map(r.e)).then((()=>r.t(o,19)))}o.keys=()=>Object.keys(n),o.id=65606,e.exports=o},42634:()=>{},67948:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.VisibilityState=t.FlushModeExperimental=t.FlushMode=void 0,function(e){e[e.Immediate=0]="Immediate",e[e.TurnBased=1]="TurnBased"}(r||(t.FlushMode=r={})),function(e){e[e.Async=2]="Async"}(n||(t.FlushModeExperimental=n={})),t.VisibilityState={NotVisible:"NotVisible",LocallyVisible:"LocallyVisible",GloballyVisible:"GloballyVisible"}},43149:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidDataStoreFactory=void 0,t.IFluidDataStoreFactory="IFluidDataStoreFactory"},10376:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFluidDataStoreRegistry=void 0,t.IFluidDataStoreRegistry="IFluidDataStoreRegistry"},28401:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gcDataBlobKey=t.gcDeletedBlobKey=t.gcTombstoneBlobKey=t.gcBlobPrefix=t.gcTreeKey=void 0,t.gcTreeKey="gc",t.gcBlobPrefix="__gc",t.gcTombstoneBlobKey="__tombstones",t.gcDeletedBlobKey="__deletedNodes",t.gcDataBlobKey=".gcdata"},38698:(e,t,r)=>{"use strict";t.NM=t.nL=t._1=t.RN=t.aT=t.Yz=t.kc=t.xX=t.YV=t.cy=t.qS=t.WD=void 0;var n=r(67948);Object.defineProperty(t,"WD",{enumerable:!0,get:function(){return n.FlushMode}}),Object.defineProperty(t,"qS",{enumerable:!0,get:function(){return n.FlushModeExperimental}}),Object.defineProperty(t,"cy",{enumerable:!0,get:function(){return n.VisibilityState}});var o=r(43149);var i=r(10376);var s=r(28401);Object.defineProperty(t,"YV",{enumerable:!0,get:function(){return s.gcBlobPrefix}}),Object.defineProperty(t,"xX",{enumerable:!0,get:function(){return s.gcDataBlobKey}}),Object.defineProperty(t,"kc",{enumerable:!0,get:function(){return s.gcDeletedBlobKey}}),Object.defineProperty(t,"Yz",{enumerable:!0,get:function(){return s.gcTombstoneBlobKey}}),Object.defineProperty(t,"aT",{enumerable:!0,get:function(){return s.gcTreeKey}});var a=r(22198);Object.defineProperty(t,"RN",{enumerable:!0,get:function(){return a.blobCountPropertyName}}),Object.defineProperty(t,"_1",{enumerable:!0,get:function(){return a.channelsTreeName}}),Object.defineProperty(t,"nL",{enumerable:!0,get:function(){return a.CreateSummarizerNodeSource}}),Object.defineProperty(t,"NM",{enumerable:!0,get:function(){return a.totalBlobSizePropertyName}});var c=r(75628)},22198:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.totalBlobSizePropertyName=t.blobCountPropertyName=t.channelsTreeName=t.CreateSummarizerNodeSource=void 0,function(e){e[e.FromSummary=0]="FromSummary",e[e.FromAttach=1]="FromAttach",e[e.Local=2]="Local"}(r||(t.CreateSummarizerNodeSource=r={})),t.channelsTreeName=".channels",t.blobCountPropertyName="BlobCount",t.totalBlobSizePropertyName="TotalBlobSize"},90645:(e,t)=>{"use strict";function r(e,t){if(Number.isFinite(e)&&Number.isFinite(t))return e-t;let r=typeof e,n=typeof t;if(r!==n)return r<n?-1:1;if("object"===r){if(null===e)return null===t?0:-1;if(null===t)return 1;if(r=typeof(e=e.valueOf()),n=typeof(t=t.valueOf()),r!==n)return r<n?-1:1}return e<t?-1:e>t?1:e===t?0:Number.isNaN(e)?Number.isNaN(t)?0:-1:Number.isNaN(t)?1:Array.isArray(e)?0:Number.NaN}t.Pb=void 0;class n{constructor(e,t,n){this._root=u,this._size=0,this._maxNodeSize=n>=4?Math.min(n,256):32,this._compare=t||r,e&&this.setPairs(e)}get size(){return this._size}get length(){return this._size}get isEmpty(){return 0===this._size}clear(){this._root=u,this._size=0}forEach(e,t){return void 0!==t&&(e=e.bind(t)),this.forEachPair(((t,r)=>e(r,t,this)))}forEachPair(e,t){var r=this.minKey(),n=this.maxKey();return this.forRange(r,n,!0,e,t)}get(e,t){return this._root.get(e,t,this)}set(e,t,r){this._root.isShared&&(this._root=this._root.clone());var n=this._root.set(e,t,r,this);return!0===n||!1===n?n:(this._root=new s([this._root,n]),!0)}has(e){return 0!==this.forRange(e,e,!0,void 0)}delete(e){return 0!==this.editRange(e,e,!0,l)}with(e,t,r){let n=this.clone();return n.set(e,t,r)||r?n:this}withPairs(e,t){let r=this.clone();return 0!==r.setPairs(e,t)||t?r:this}withKeys(e,t){let r=this.clone(),n=!1;for(var o=0;o<e.length;o++)n=r.set(e[o],void 0,!1)||n;return t&&!n?this:r}without(e,t){return this.withoutRange(e,e,!0,t)}withoutKeys(e,t){let r=this.clone();return r.deleteKeys(e)||!t?r:this}withoutRange(e,t,r,n){let o=this.clone();return 0===o.deleteRange(e,t,r)&&n?this:o}filter(e,t){var r,n=this.greedyClone();return n.editAll(((t,n,o)=>{if(!e(t,n,o))return r=c})),!r&&t?this:n}mapValues(e){var t={},r=this.greedyClone();return r.editAll(((r,n,o)=>(t.value=e(n,r,o),t))),r}reduce(e,t){let r=0,n=t;for(var o,i=this.entries(this.minKey(),g);!(o=i.next()).done;)n=e(n,o.value,r++,this);return n}entries(e,t){var r=this.findPath(e);if(void 0===r)return o();var{nodequeue:n,nodeindex:i,leaf:s}=r,a=void 0!==t?1:0,c=void 0===e?-1:s.indexOf(e,0,this._compare)-1;return o((()=>{e:for(;;)switch(a){case 0:if(++c<s.keys.length)return{done:!1,value:[s.keys[c],s.values[c]]};a=2;continue;case 1:if(++c<s.keys.length)return t[0]=s.keys[c],t[1]=s.values[c],{done:!1,value:t};a=2;case 2:for(var e=-1;;){if(++e>=n.length){a=3;continue e}if(++i[e]<n[e].length)break}for(;e>0;e--)n[e-1]=n[e][i[e]].children,i[e-1]=0;s=n[0][i[0]],c=-1,a=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))}entriesReversed(e,t,r){if(void 0===e&&(r=void 0,void 0===(e=this.maxKey())))return o();var{nodequeue:n,nodeindex:i,leaf:s}=this.findPath(e)||this.findPath(this.maxKey());p(!n[0]||s===n[0][i[0]],"wat!");var a=s.indexOf(e,0,this._compare);!r&&a<s.keys.length&&this._compare(s.keys[a],e)<=0&&a++;var c=void 0!==t?1:0;return o((()=>{e:for(;;)switch(c){case 0:if(--a>=0)return{done:!1,value:[s.keys[a],s.values[a]]};c=2;continue;case 1:if(--a>=0)return t[0]=s.keys[a],t[1]=s.values[a],{done:!1,value:t};c=2;case 2:for(var e=-1;;){if(++e>=n.length){c=3;continue e}if(--i[e]>=0)break}for(;e>0;e--)n[e-1]=n[e][i[e]].children,i[e-1]=n[e-1].length-1;s=n[0][i[0]],a=s.keys.length,c=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))}findPath(e){var t,r,n=this._root;if(n.isLeaf)t=h,r=h;else{t=[],r=[];for(var o=0;!n.isLeaf;o++){if(t[o]=n.children,r[o]=void 0===e?0:n.indexOf(e,0,this._compare),r[o]>=t[o].length)return;n=t[o][r[o]]}t.reverse(),r.reverse()}return{nodequeue:t,nodeindex:r,leaf:n}}diffAgainst(e,t,r,o){if(e._compare!==this._compare)throw new Error("Tree comparators are not the same.");if(this.isEmpty||e.isEmpty){if(this.isEmpty&&e.isEmpty)return;return this.isEmpty?void 0===r?void 0:n.stepToEnd(n.makeDiffCursor(e),r):void 0===t?void 0:n.stepToEnd(n.makeDiffCursor(this),t)}const{_compare:i}=this,s=n.makeDiffCursor(this),a=n.makeDiffCursor(e);let c=!0,l=!0,d=n.compare(s,a,i);for(;c&&l;){const e=n.compare(s,a,i),{leaf:u,internalSpine:h,levelIndices:g}=s,{leaf:p,internalSpine:m,levelIndices:f}=a;if(u||p){if(0!==d)if(0===e){if(u&&p&&o){const e=u.values[g[g.length-1]],t=p.values[f[f.length-1]];if(!Object.is(e,t)){const r=o(s.currentKey,e,t);if(r&&r.break)return r.break}}}else if(e>0){if(p&&r){const e=p.values[f[f.length-1]],t=r(a.currentKey,e);if(t&&t.break)return t.break}}else if(t&&u&&0!==d){const e=u.values[g[g.length-1]],r=t(s.currentKey,e);if(r&&r.break)return r.break}}else if(!u&&!p&&0===e){const e=h.length-1,t=m.length-1,r=h[e][g[e]];if(m[t][f[t]]===r){d=0,c=n.step(s,!0),l=n.step(a,!0);continue}}d=e,e<0?c=n.step(s):l=n.step(a)}return c&&t?n.finishCursorWalk(s,a,i,t):l&&r?n.finishCursorWalk(a,s,i,r):void 0}static finishCursorWalk(e,t,r,o){const i=n.compare(e,t,r);if(0===i){if(!n.step(e))return}else i<0&&p(!1,"cursor walk terminated early");return n.stepToEnd(e,o)}static stepToEnd(e,t){let r=!0;for(;r;){const{leaf:o,levelIndices:i,currentKey:s}=e;if(o){const e=t(s,o.values[i[i.length-1]]);if(e&&e.break)return e.break}r=n.step(e)}}static makeDiffCursor(e){const{_root:t,height:r}=e;return{height:r,internalSpine:[[t]],levelIndices:[0],leaf:void 0,currentKey:t.maxKey()}}static step(e,t){const{internalSpine:r,levelIndices:n,leaf:o}=e;if(!0===t||o){const i=n.length;if(!0===t||0===n[i-1]){const t=r.length;if(0===t)return!1;const o=t-1;let s=o;for(;s>=0;){if(n[s]>0)return s<i-1&&(e.leaf=void 0,n.pop()),s<o&&(e.internalSpine=r.slice(0,s+1)),e.currentKey=r[s][--n[s]].maxKey(),!0;s--}return!1}{const t=--n[i-1];return e.currentKey=o.keys[t],!0}}{const t=r.length,o=t-1,i=r[o][n[o]];if(i.isLeaf){e.leaf=i;const r=n[t]=i.values.length-1;e.currentKey=i.keys[r]}else{const o=i.children;r[t]=o;const s=o.length-1;n[t]=s,e.currentKey=o[s].maxKey()}return!0}}static compare(e,t,r){const{height:n,currentKey:o,levelIndices:i}=e,{height:s,currentKey:a,levelIndices:c}=t,l=r(a,o);if(0!==l)return l;const d=n<s?n:s;return i.length-(n-d)-(c.length-(s-d))}keys(e){var t=this.entries(e,g);return o((()=>{var e=t.next();return e.value&&(e.value=e.value[0]),e}))}values(e){var t=this.entries(e,g);return o((()=>{var e=t.next();return e.value&&(e.value=e.value[1]),e}))}get maxNodeSize(){return this._maxNodeSize}minKey(){return this._root.minKey()}maxKey(){return this._root.maxKey()}clone(){this._root.isShared=!0;var e=new n(void 0,this._compare,this._maxNodeSize);return e._root=this._root,e._size=this._size,e}greedyClone(e){var t=new n(void 0,this._compare,this._maxNodeSize);return t._root=this._root.greedyClone(e),t._size=this._size,t}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2147483647,t=this.minKey(),r=this.maxKey();return void 0!==t?this.getRange(t,r,!0,e):[]}keysArray(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,((t,r)=>{e.push(t)})),e}valuesArray(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,((t,r)=>{e.push(r)})),e}toString(){return this.toArray().toString()}setIfNotPresent(e,t){return this.set(e,t,!1)}nextHigherPair(e,t){return t=t||[],void 0===e?this._root.minPair(t):this._root.getPairOrNextHigher(e,this._compare,!1,t)}nextHigherKey(e){var t=this.nextHigherPair(e,g);return t&&t[0]}nextLowerPair(e,t){return t=t||[],void 0===e?this._root.maxPair(t):this._root.getPairOrNextLower(e,this._compare,!1,t)}nextLowerKey(e){var t=this.nextLowerPair(e,g);return t&&t[0]}getPairOrNextLower(e,t){return this._root.getPairOrNextLower(e,this._compare,!0,t||[])}getPairOrNextHigher(e,t){return this._root.getPairOrNextHigher(e,this._compare,!0,t||[])}changeIfPresent(e,t){return 0!==this.editRange(e,e,!0,((e,r)=>({value:t})))}getRange(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:67108863;var o=[];return this._root.forRange(e,t,r,!1,this,0,((e,t)=>(o.push([e,t]),o.length>n?d:void 0))),o}setPairs(e,t){for(var r=0,n=0;n<e.length;n++)this.set(e[n][0],e[n][1],t)&&r++;return r}forRange(e,t,r,n,o){var i=this._root.forRange(e,t,r,!1,this,o||0,n);return"number"===typeof i?i:i.break}editRange(e,t,r,n,o){var i=this._root;i.isShared&&(this._root=i=i.clone());try{var s=i.forRange(e,t,r,!0,this,o||0,n);return"number"===typeof s?s:s.break}finally{let e;for(;i.keys.length<=1&&!i.isLeaf;)e||(e=i.isShared),this._root=i=0===i.keys.length?u:i.children[0];e&&(i.isShared=!0)}}editAll(e,t){return this.editRange(this.minKey(),this.maxKey(),!0,e,t)}deleteRange(e,t,r){return this.editRange(e,t,r,l)}deleteKeys(e){for(var t=0,r=0;t<e.length;t++)this.delete(e[t])&&r++;return r}get height(){let e=this._root,t=-1;for(;e;)t++,e=e.isLeaf?void 0:e.children[0];return t}freeze(){var e=this;e.clear=e.set=e.editRange=function(){throw new Error("Attempted to modify a frozen BTree")}}unfreeze(){delete this.clear,delete this.set,delete this.editRange}get isFrozen(){return this.hasOwnProperty("editRange")}checkValid(){var e=this._root.checkValid(0,this,0);p(e===this.size,"size mismatch: counted ",e,"but stored",this.size)}}function o(){var e={next:arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>({done:!0,value:void 0})};return Symbol&&Symbol.iterator&&(e[Symbol.iterator]=function(){return this}),e}t.Pb=n,Symbol&&Symbol.iterator&&(n.prototype[Symbol.iterator]=n.prototype.entries),n.prototype.where=n.prototype.filter,n.prototype.setRange=n.prototype.setPairs,n.prototype.add=n.prototype.set;class i{get isLeaf(){return void 0===this.children}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.keys=e,this.values=t||a,this.isShared=void 0}maxKey(){return this.keys[this.keys.length-1]}indexOf(e,t,r){const n=this.keys;for(var o=0,i=n.length,s=i>>1;o<i;){var a=r(n[s],e);if(a<0)o=s+1;else{if(!(a>0)){if(0===a)return s;if(e===e)return n.length;throw new Error("BTree: NaN was used as a key")}i=s}s=o+i>>1}return s^t}minKey(){return this.keys[0]}minPair(e){if(0!==this.keys.length)return e[0]=this.keys[0],e[1]=this.values[0],e}maxPair(e){if(0===this.keys.length)return;const t=this.keys.length-1;return e[0]=this.keys[t],e[1]=this.values[t],e}clone(){var e=this.values;return new i(this.keys.slice(0),e===a?e:e.slice(0))}greedyClone(e){return this.isShared&&!e?this:this.clone()}get(e,t,r){var n=this.indexOf(e,-1,r._compare);return n<0?t:this.values[n]}getPairOrNextLower(e,t,r,n){var o=this.indexOf(e,-1,t);const i=o<0?~o-1:r?o:o-1;if(i>=0)return n[0]=this.keys[i],n[1]=this.values[i],n}getPairOrNextHigher(e,t,r,n){var o=this.indexOf(e,-1,t);const i=o<0?~o:r?o:o+1,s=this.keys;if(i<s.length)return n[0]=s[i],n[1]=this.values[i],n}checkValid(e,t,r){var n=this.keys.length,o=this.values.length;return p(this.values===a?n<=o:n===o,"keys/values length mismatch: depth",e,"with lengths",n,o,"and baseIndex",r),p(0==e||n>0,"empty leaf at depth",e,"and baseIndex",r),n}set(e,t,r,n){var o=this.indexOf(e,-1,n._compare);if(o<0){if(o=~o,n._size++,this.keys.length<n._maxNodeSize)return this.insertInLeaf(o,e,t,n);var i=this.splitOffRightSide(),s=this;return o>this.keys.length&&(o-=this.keys.length,s=i),s.insertInLeaf(o,e,t,n),i}return!1!==r&&(void 0!==t&&this.reifyValues(),this.keys[o]=e,this.values[o]=t),!1}reifyValues(){return this.values===a?this.values=this.values.slice(0,this.keys.length):this.values}insertInLeaf(e,t,r,n){if(this.keys.splice(e,0,t),this.values===a){for(;a.length<n._maxNodeSize;)a.push(void 0);if(void 0===r)return!0;this.values=a.slice(0,this.keys.length-1)}return this.values.splice(e,0,r),!0}takeFromRight(e){var t=this.values;e.values===a?t!==a&&t.push(void 0):(t=this.reifyValues()).push(e.values.shift()),this.keys.push(e.keys.shift())}takeFromLeft(e){var t=this.values;e.values===a?t!==a&&t.unshift(void 0):(t=this.reifyValues()).unshift(e.values.pop()),this.keys.unshift(e.keys.pop())}splitOffRightSide(){var e=this.keys.length>>1,t=this.keys.splice(e),r=this.values===a?a:this.values.splice(e);return new i(t,r)}forRange(e,t,r,n,o,i,s){var c,l,d=o._compare;if(t===e){if(!r)return i;if(l=(c=this.indexOf(e,-1,d))+1,c<0)return i}else c=this.indexOf(e,0,d),(l=this.indexOf(t,-1,d))<0?l=~l:!0===r&&l++;var u=this.keys,h=this.values;if(void 0!==s)for(var g=c;g<l;g++){var p=u[g],m=s(p,h[g],i++);if(void 0!==m){if(!0===n){if(p!==u[g]||!0===this.isShared)throw new Error("BTree illegally changed or cloned in editRange");m.delete?(this.keys.splice(g,1),this.values!==a&&this.values.splice(g,1),o._size--,g--,l--):m.hasOwnProperty("value")&&(h[g]=m.value)}if(void 0!==m.break)return m}}else i+=l-c;return i}mergeSibling(e,t){if(this.keys.push.apply(this.keys,e.keys),this.values===a){if(e.values===a)return;this.values=this.values.slice(0,this.keys.length)}this.values.push.apply(this.values,e.reifyValues())}}class s extends i{constructor(e,t){if(!t){t=[];for(var r=0;r<e.length;r++)t[r]=e[r].maxKey()}super(t),this.children=e}clone(){for(var e=this.children.slice(0),t=0;t<e.length;t++)e[t].isShared=!0;return new s(e,this.keys.slice(0))}greedyClone(e){if(this.isShared&&!e)return this;for(var t=new s(this.children.slice(0),this.keys.slice(0)),r=0;r<t.children.length;r++)t.children[r]=t.children[r].greedyClone(e);return t}minKey(){return this.children[0].minKey()}minPair(e){return this.children[0].minPair(e)}maxPair(e){return this.children[this.children.length-1].maxPair(e)}get(e,t,r){var n=this.indexOf(e,0,r._compare),o=this.children;return n<o.length?o[n].get(e,t,r):void 0}getPairOrNextLower(e,t,r,n){var o=this.indexOf(e,0,t),i=this.children;if(o>=i.length)return this.maxPair(n);const s=i[o].getPairOrNextLower(e,t,r,n);return void 0===s&&o>0?i[o-1].maxPair(n):s}getPairOrNextHigher(e,t,r,n){var o=this.indexOf(e,0,t),i=this.children,s=i.length;if(o>=s)return;const a=i[o].getPairOrNextHigher(e,t,r,n);return void 0===a&&o<s-1?i[o+1].minPair(n):a}checkValid(e,t,r){let n=this.keys.length,o=this.children.length;p(n===o,"keys/children length mismatch: depth",e,"lengths",n,o,"baseIndex",r),p(n>1||e>0,"internal node has length",n,"at depth",e,"baseIndex",r);let i=0,s=this.children,a=this.keys,c=0;for(var l=0;l<o;l++)i+=s[l].checkValid(e+1,t,r+i),c+=s[l].keys.length,p(i>=c,"wtf",r),p(0===l||s[l-1].constructor===s[l].constructor,"type mismatch, baseIndex:",r),s[l].maxKey()!=a[l]&&p(!1,"keys[",l,"] =",a[l],"is wrong, should be ",s[l].maxKey(),"at depth",e,"baseIndex",r),0===l||t._compare(a[l-1],a[l])<0||p(!1,"sort violation at depth",e,"index",l,"keys",a[l-1],a[l]);let d=0===c;return(d||c>t.maxNodeSize*o)&&p(!1,d?"too few":"too many","children (",c,i,") at depth",e,"maxNodeSize:",t.maxNodeSize,"children.length:",o,"baseIndex:",r),i}set(e,t,r,n){var o,i=this.children,s=n._maxNodeSize,a=n._compare,c=Math.min(this.indexOf(e,0,a),i.length-1),l=i[c];(l.isShared&&(i[c]=l=l.clone()),l.keys.length>=s)&&(c>0&&(o=i[c-1]).keys.length<s&&a(l.keys[0],e)<0?(o.isShared&&(i[c-1]=o=o.clone()),o.takeFromRight(l),this.keys[c-1]=o.maxKey()):void 0!==(o=i[c+1])&&o.keys.length<s&&a(l.maxKey(),e)<0&&(o.isShared&&(i[c+1]=o=o.clone()),o.takeFromLeft(l),this.keys[c]=i[c].maxKey()));var d=l.set(e,t,r,n);if(!1===d)return!1;if(this.keys[c]=l.maxKey(),!0===d)return!0;if(this.keys.length<s)return this.insert(c+1,d),!0;var u=this.splitOffRightSide(),h=this;return a(d.maxKey(),this.maxKey())>0&&(h=u,c-=this.keys.length),h.insert(c+1,d),u}insert(e,t){this.children.splice(e,0,t),this.keys.splice(e,0,t.maxKey())}splitOffRightSide(){var e=this.children.length>>1;return new s(this.children.splice(e),this.keys.splice(e))}takeFromRight(e){this.keys.push(e.keys.shift()),this.children.push(e.children.shift())}takeFromLeft(e){this.keys.unshift(e.keys.pop()),this.children.unshift(e.children.pop())}forRange(e,t,r,n,o,i,s){var a=o._compare,c=this.keys,l=this.children,d=this.indexOf(e,0,a),u=d,h=Math.min(t===e?d:this.indexOf(t,0,a),c.length-1);if(n){if(u<=h)try{for(;u<=h;u++){l[u].isShared&&(l[u]=l[u].clone());m=l[u].forRange(e,t,r,n,o,i,s);if(c[u]=l[u].maxKey(),"number"!==typeof m)return m;i=m}}finally{var g=o._maxNodeSize>>1;for(d>0&&d--,u=h;u>=d;u--)l[u].keys.length<=g&&(0!==l[u].keys.length?this.tryMerge(u,o._maxNodeSize):(c.splice(u,1),l.splice(u,1)));0!==l.length&&0===l[0].keys.length&&p(!1,"emptiness bug")}}else for(;u<=h;u++){var m;if("number"!==typeof(m=l[u].forRange(e,t,r,n,o,i,s)))return m;i=m}return i}tryMerge(e,t){var r=this.children;return e>=0&&e+1<r.length&&r[e].keys.length+r[e+1].keys.length<=t&&(r[e].isShared&&(r[e]=r[e].clone()),r[e].mergeSibling(r[e+1],t),r.splice(e+1,1),this.keys.splice(e+1,1),this.keys[e]=r[e].maxKey(),!0)}mergeSibling(e,t){var r=this.keys.length;this.keys.push.apply(this.keys,e.keys);const n=e.children;if(this.children.push.apply(this.children,n),e.isShared&&!this.isShared)for(var o=0;o<n.length;o++)n[o].isShared=!0;this.tryMerge(r-1,t)}}var a=[];const c={delete:!0},l=()=>c,d={break:!0},u=function(){var e=new i;return e.isShared=!0,e}(),h=[],g=[];function p(e){if(!e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw r.unshift("B+ tree"),new Error(r.join(" "))}}(()=>{let e=new n;e.freeze()})()},74086:(e,t,r)=>{"use strict";r.d(t,{AH:()=>o,O0:()=>i});var n=r(70202);const o=e=>n.Ss.from(e,"base64").toString("utf8"),i=e=>n.Ss.from(e,"utf8").toString("base64")},70202:(e,t,r)=>{"use strict";r.d(t,{JR:()=>s,Km:()=>o,Ss:()=>c,Xg:()=>i});var n=r(34445);function o(e,t){switch(t){case"base64":return n.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class c extends Uint8Array{toString(e){return o(this,e)}static from(e,t,r){if("string"===typeof e)return c.fromString(e,t);if(null!==e&&"object"===typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const n=null!==t&&void 0!==t?t:0,o=null!==r&&void 0!==r?r:e.byteLength-n;if(n<0||n>e.byteLength||o<0||o+n>e.byteLength)throw new RangeError("Invalid range specified.");return new c(e,n,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=n.toByteArray(t);return new c(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}},8653:(e,t,r)=>{"use strict";function n(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}r.d(t,{M:()=>n})},3878:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});var n=r(34445);async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return r.e(55106).then(r.bind(r,55106)).then((async r=>r.hashFile(e,t,o)));const i=await async function(e,t){const r=await crypto.subtle.digest(t,e);return new Uint8Array(r)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,(e=>e.toString(16).padStart(2,"0"))).join("");case"base64":return n.fromByteArray(e)}}(i,o)}},21605:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});const n=globalThis.performance},98418:(e,t,r)=>{"use strict";r.d(t,{X:()=>o});var n=r(27284);class o extends n.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},12624:(e,t,r)=>{"use strict";function n(e,t){if(!e)throw new Error("number"===typeof t?"0x".concat(t.toString(16).padStart(3,"0")):t)}r.d(t,{v:()=>n})},30667:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});const n=async e=>new Promise((t=>setTimeout((()=>t()),e)))},58400:(e,t,r)=>{"use strict";r.d(t,{I:()=>o,d:()=>n});class n{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class o{get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},89165:(e,t,r)=>{"use strict";r.d(t,{o:()=>o});class n{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class o{constructor(){let{expiry:e={policy:"indefinite"},removeOnError:t=(()=>!0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.removeOnError=t,this.gc=new n(e,(e=>this.remove(e)))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let r=this.get(e);if(void 0===r){r=(async()=>t())(),this.cache.set(e,r),r.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)}return r}add(e,t){const r=this.has(e);return this.addOrGet(e,t).catch((()=>{})),!r}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}},24356:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});class n{constructor(){this.completed=!1,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}},6501:(e,t,r)=>{"use strict";r.d(t,{M4:()=>a,zO:()=>c});var n=r(12624),o=r(24356);const i=2147483647;function s(e,t,r){let n;if(t>i){const o=t-i;n=setTimeout((()=>s(e,o,r)),i)}else n=setTimeout((()=>e()),Math.max(t,0));return null===r||void 0===r||r(n),n}class a{get hasTimer(){return!!this.runningState}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>Date.now();this.defaultTimeout=e,this.defaultHandler=t,this.getCurrentTick=r}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultTimeout,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultHandler;this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){if(this.runningState){var r,n;const o=null!==e&&void 0!==e?e:this.runningState.intendedDuration,i=null!==(r=null!==t&&void 0!==t?t:null===(n=this.runningState.restart)||void 0===n?void 0:n.handler)&&void 0!==r?r:this.runningState.handler,s=this.calculateRemainingTime(this.runningState);o<s?this.start(o,i):o===s?(this.runningState.handler=i,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:i}}else this.start(e,t)}startCore(e,t,r){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:s((()=>this.handler()),e,(e=>{void 0!==this.runningState&&(this.runningState.timeout=e)}))}}handler(){(0,n.v)(!!this.runningState,1892);const e=this.runningState.restart;if(void 0===e){const e=this.runningState.handler;this.clear(),e()}else{const t=this.calculateRemainingTime(e);this.startCore(t,(()=>e.handler()),e.duration)}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class c{get hasTimer(){return this.timer.hasTimer}constructor(e,t){this.timer=new a(e,(()=>this.wrapHandler(t)))}async start(e,t){return this.clear(),this.deferred=new o.c,this.timer.start(e,t?()=>this.wrapHandler(t):void 0),this.deferred.promise}clear(){this.timer.clear(),this.deferred&&(this.deferred.resolve({timerResult:"cancel"}),this.deferred=void 0)}wrapHandler(e){e(),(0,n.v)(!!this.deferred,1893),this.deferred.resolve({timerResult:"timeout"}),this.deferred=void 0}}},83644:(e,t,r)=>{"use strict";function n(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}r.d(t,{$:()=>n})},92166:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});var n=r(60574);class o{get IFluidHandle(){return this}get isAttached(){return this.routeContext.isAttached}get visible(){return this.isAttached||this.locallyVisible}constructor(e,t,r){this.value=e,this.path=t,this.routeContext=r,this.pendingHandlesToMakeVisible=new Set,this.locallyVisible=!1,this.absolutePath=(0,n.a)(t,this.routeContext)}async get(){return this.value}attachGraph(){this.visible||(this.locallyVisible=!0,this.pendingHandlesToMakeVisible.forEach((e=>{e.attachGraph()})),this.pendingHandlesToMakeVisible.clear(),this.routeContext.attachGraph())}bind(e){this.visible?e.attachGraph():this.pendingHandlesToMakeVisible.add(e)}}},57320:(e,t,r)=>{"use strict";r.d(t,{X:()=>f});var n=r(70202),o=r(12624),i=r(94489),s=r(5881);const a={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let c;const l=new Uint8Array(16);function d(){if(!c&&(c="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!c))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(l)}const u=[];for(let v=0;v<256;++v)u.push((v+256).toString(16).slice(1));function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}const g=function(e,t,r){if(a.randomUUID&&!t&&!e)return a.randomUUID();const n=(e=e||{}).random||(e.rng||d)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return h(n)};function p(e,t,r){const s=[];for(const a of t){const t="".concat(e).concat(a.path);if(a.type===i.$.Blob){const e=a.value,o=(0,n.Xg)(e.contents,e.encoding),c=g();r.set(c,o);const l={mode:i.S[a.mode],path:t,sha:c,size:0,type:"blob",url:""};s.push(l)}else if(a.type===i.$.Tree){(0,o.v)(a.type===i.$.Tree,257);const e=a.value,n={mode:i.S[a.mode],path:t,sha:"",size:-1,type:"tree",url:""};s.push(n);const c=p("".concat(t,"/"),e.entries,r);s.push(...c)}}return s}function m(e,t){return{sha:"",tree:p("",e,t),url:""}}function f(e,t){const r=m(e,t);return(0,s.It)(r)}},27939:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(74754),o=r(60056);class i extends o.iq{constructor(e){super(e,{usageError:!0}),this.errorType=n.f.usageError,this.canRetry=!1}}},16713:(e,t,r)=>{"use strict";r.d(t,{DW:()=>s,Wz:()=>i,sI:()=>n});var n,o=r(57406);function i(e){return e.type===o.Go.Operation}function s(e){return e.type===o.Go.NoOp||e.type===n.Accept}!function(e){e.Accept="accept"}(n||(n={}))},19307:(e,t,r)=>{"use strict";r.d(t,{E9:()=>S,Gi:()=>m,OI:()=>g,Of:()=>f,PE:()=>b,Tj:()=>h,WA:()=>n,YU:()=>y,c_:()=>u,d8:()=>c,dw:()=>p,gb:()=>l,ix:()=>v,sc:()=>s,yi:()=>d});var n,o=r(74754),i=r(60056);function s(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?n.Online:n.Offline:n.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(n||(n={}));class a extends i.iq{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=o.f.genericNetworkError}}class c extends i.iq{constructor(e,t){super(e,t),this.errorType=o.f.fluidInvalidSchema,this.canRetry=!1}}class l extends i.iq{constructor(e,t,r){super(e,{...t,statusCode:400}),this.errorType=l.errorType,this.canRetry=!1,this.storageOnlyReason=r}}l.errorType=o.f.deltaStreamConnectionForbidden;class d extends i.iq{constructor(e,t,r,n){super(e,n,new Set(["claims","tenantId"])),this.claims=t,this.tenantId=r,this.errorType=o.f.authorizationError,this.canRetry=!1}}class u extends i.iq{constructor(e,t,r){super(e,r,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=o.f.locationRedirection,this.canRetry=!1}}class h extends i.iq{constructor(e,t,r,n){super(e,n),this.errorType=t,this.canRetry=r}}class g extends h{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class p extends h{constructor(e,t,r){super(e,t,!0,r),this.errorType=t}}class m extends i.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=o.f.throttlingError,this.canRetry=!0}}const f=(e,t)=>new g(e,o.a.writeError,t);function v(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new m(e,t.retryAfterMs/1e3,r):new a(e,t.canRetry,r)}const y=e=>!0===(null===e||void 0===e?void 0:e.canRetry),b=e=>null===e||void 0===e?void 0:e.retryAfterSeconds,S=e=>void 0!==(null===e||void 0===e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0},11158:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});var n=r(19307);function o(e,t,r){const o={...t},i=null===r||void 0===r?void 0:r.online;if(o.online="string"===typeof i?i:n.WA[(0,n.sc)()],"object"===typeof navigator&&null!==navigator){var s,a;const e=navigator,t=null!==(s=null!==(a=e.connection)&&void 0!==a?a:e.mozConnection)&&void 0!==s?s:e.webkitConnection;null!==t&&"object"===typeof t&&(o.connectionType=t.type)}o.category=(0,n.YU)(r)?"generic":"error",e.sendTelemetryEvent(o,r)}},45019:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});const n="2.0.0-rc.1.0.8"},7791:(e,t,r)=>{"use strict";r.d(t,{v:()=>o});var n=r(12624);class o{constructor(e){this.maxRequests=e,this.tasks=[],this.release=()=>{const e=this.tasks.shift();if(void 0!==e)return e();this.maxRequests++},(0,n.v)(e>0,174)}get waitQueueLength(){return this.tasks.length}async acquire(){if(!(this.maxRequests>0))return new Promise((e=>{this.tasks.push(e)}));this.maxRequests--}async schedule(e){return await this.acquire(),e().finally(this.release)}}},89951:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var n=r(70202);async function o(e,t){const r=await e.readBlob(t),o=(0,n.JR)(r,"utf8");return JSON.parse(o)}},84792:(e,t,r)=>{"use strict";r.d(t,{F:()=>h,M:()=>l});var n=r(33941),o=r(21605),i=r(30667),s=r(74754),a=r(19307),c=r(45019);async function l(e,t,r,n){let l,d=!1,u=500,g=0;const p=o.F.now();let m;do{try{l=await e(n.cancel),d=!0}catch(v){var f;if(!(0,a.YU)(v))throw r.sendTelemetryEvent({eventName:"".concat(t,"_cancel"),retry:g,duration:o.F.now()-p,fetchCallName:t},v),v;if(!0===(null===(f=n.cancel)||void 0===f?void 0:f.aborted))throw r.sendTelemetryEvent({eventName:"".concat(t,"_runWithRetryAborted"),retry:g,duration:o.F.now()-p,fetchCallName:t,reason:n.cancel.reason},v),new a.OI("runWithRetry was Aborted",s.a.genericError,{driverVersion:c.z,fetchCallName:t,reason:n.cancel.reason});0===g&&r.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),duration:o.F.now()-p,fetchCallName:t},v),g++,m=v,u=h(u,v),n.onRetry&&n.onRetry(u,v),await(0,i.c)(u)}}while(!d);return g>0&&r.sendTelemetryEvent({eventName:"".concat(t,"_lastError"),retry:g,duration:o.F.now()-p,fetchCallName:t},m),l}const d=6e4,u=8e3;function h(e,t){const r=(0,a.E9)(t);let o=Math.max(null!==r&&void 0!==r?r:0,2*e);return o=Math.min(o,(0,n.Xy)(t)&&!0===t.getTelemetryProperties().endpointReached?d:u),o}},97652:(e,t,r)=>{"use strict";r.d(t,{YG:()=>i,ub:()=>o});var n=r(2642);function o(e){for(var t,r,o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];if(void 0===(null===e||void 0===e?void 0:e.tree)||(null===(t=e.tree)||void 0===t||null===(t=t[".app"])||void 0===t?void 0:t.type)!==n.Z.Tree||(null===(r=e.tree)||void 0===r||null===(r=r[".protocol"])||void 0===r?void 0:r.type)!==n.Z.Tree)return!1;return 2===Object.keys(e.tree).filter((e=>!i.includes(e))).length}function i(e){const t=e.tree.attributes;return JSON.parse(t.content)}},74754:(e,t,r)=>{"use strict";r.d(t,{f:()=>a,a:()=>s});const{dataCorruptionError:n,dataProcessingError:o,...i}={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},s={...i,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var a;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(a||(a={}))},10042:(e,t,r)=>{"use strict";r.d(t,{f:()=>v});var n=r(12624),o=r(76078);let i=[],s=!1;function a(e){i.push({task:e}),c(2e3)}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!s){if(self.requestIdleCallback)self.requestIdleCallback(l);else{const t=Date.now()+50;self.setTimeout((()=>l({timeRemaining:()=>Math.max(t-Date.now(),0),didTimeout:!1})),e)}s=!0}}function l(e){!function(e,t){const r=[];for(let n=0;n<i.length;n+=1){if(t&&!t()){r.push(...i.slice(n));break}const o=i[n];e&&!e(o)?r.push(o):o.task()}i=r}(void 0,(()=>e.timeRemaining()>10)),s=!1,i.length>0&&c()}var d=r(69649);const u="fluidDriverCache",h="driverStorage.V3",g={1:"diverStorage",2:"diverStorage.V2"};function p(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}function m(e){return new Promise(((t,r)=>{(0,d.P2)(u,3,{upgrade:(t,r)=>{try{const e=g[r];e&&t.deleteObjectStore(e)}catch(i){(0,o.pW)({logger:e}).sendErrorEvent({eventName:"FluidCacheDeleteOldDbError"},i)}const n=t.createObjectStore(h);n.createIndex("createdTimeMs","createdTimeMs"),n.createIndex("lastAccessTimeMs","lastAccessTimeMs"),n.createIndex("partitionKey","partitionKey"),n.createIndex("fileId","fileId")},blocked:()=>{r(new Error("Could not open DB since it is blocked by an older client that has the DB open"))}}).then(t,r)}))}const f="2.0.0-rc.1.0.8";class v{constructor(e){var t;this.closeDbImmediately=!0,this.dbReuseCount=-1,this.logger=(0,o.pW)({logger:e.logger}),this.partitionKey=e.partitionKey,this.maxCacheItemAge=e.maxCacheItemAge,this.closeDbAfterMs=null!==(t=e.closeDbAfterMs)&&void 0!==t?t:0,this.closeDbAfterMs>0&&(this.closeDbImmediately=!1),a((async()=>{var e;if(null!==(e=navigator.storage)&&void 0!==e&&e.estimate){const e=await navigator.storage.estimate();let t;"usageDetails"in e&&(t=e.usageDetails.indexedDB),this.logger.sendTelemetryEvent({eventName:"FluidCacheStorageInfo",subCategory:"FluidCache",quota:e.quota,usage:e.usage,indexedDBSize:t,pkgVersion:f})}})),a((async()=>{let e;try{e=await m(this.logger);const t=e.transaction(h,"readwrite"),r=t.store.index("createdTimeMs"),n=await r.getAllKeys(IDBKeyRange.upperBound((new Date).getTime()-this.maxCacheItemAge));await Promise.all(n.map((e=>t.store.delete(e)))),await t.done}catch(r){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:f},r)}finally{var t;null===(t=e)||void 0===t||t.close()}}))}async openDb(){if(this.closeDbImmediately)return m(this.logger);if(void 0===this.db){const e=await m(this.logger);if(void 0!==this.db)return e.close(),this.dbReuseCount+=1,this.db;this.dbReuseCount=-1,this.db=e,this.db.onversionchange=e=>{var t;null===(t=this.db)||void 0===t||t.close(),this.db=void 0,clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0},this.db.addEventListener("close",(e=>{clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0,this.db=void 0})),(0,n.v)(void 0===this.dbCloseTimer,1734),this.dbCloseTimer=setTimeout((()=>{var e;null===(e=this.db)||void 0===e||e.close(),this.db=void 0,this.dbCloseTimer=void 0}),this.closeDbAfterMs)}return(0,n.v)(void 0!==this.db,1735),this.dbReuseCount+=1,this.db}closeDb(e){this.closeDbImmediately&&(null===e||void 0===e||e.close())}async removeEntries(e){let t;try{t=await this.openDb();const r=t.transaction(h,"readwrite"),n=r.store.index("fileId"),o=await n.getAllKeys(e.docId);await Promise.all(o.map((e=>r.store.delete(e)))),await r.done}catch(r){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:f},r)}finally{this.closeDb(t)}}async get(e){const t=performance.now(),r=await this.getItemFromCache(e);return this.logger.sendPerformanceEvent({eventName:"FluidCacheAccess",cacheHit:void 0!==r,type:e.type,duration:performance.now()-t,dbOpenPerf:null===r||void 0===r?void 0:r.dbOpenPerf,dbReuseCount:this.dbReuseCount,pkgVersion:f}),null===r||void 0===r?void 0:r.cachedObject}async getItemFromCache(e){let t;try{const r=p(e),n=performance.now();t=await this.openDb();const o=performance.now()-n,i=await t.get(h,r);if(!i)return void this.closeDb(t);if(i.partitionKey!==this.partitionKey)return this.logger.sendTelemetryEvent({eventName:"FluidCachePartitionKeyMismatch",subCategory:"FluidCache",pkgVersion:f}),void this.closeDb(t);return(new Date).getTime()-i.createdTimeMs>this.maxCacheItemAge?void this.closeDb(t):(this.closeDb(t),{...i,dbOpenPerf:o})}catch(r){return this.logger.sendErrorEvent({eventName:"FluidCacheGetError",pkgVersion:f},r),void this.closeDb(t)}}async put(e,t){let r;try{r=await this.openDb();const n=(new Date).getTime();await r.put(h,{cachedObject:t,fileId:e.file.docId,type:e.type,cacheItemId:e.key,partitionKey:this.partitionKey,createdTimeMs:n,lastAccessTimeMs:n},p(e)),this.closeDb(r)}catch(n){this.logger.sendErrorEvent({eventName:"FluidCachePutError",pkgVersion:f},n)}finally{this.closeDb(r)}}}},75628:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IdCompressor:()=>Y,assertIsStableId:()=>f,createIdCompressor:()=>ee,createSessionId:()=>m,deserializeIdCompressor:()=>te,generateStableId:()=>v,isStableId:()=>y});var n=r(12624),o=r(70202),i=r(76078);function s(e){return e>=0}const a={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let c;const l=new Uint8Array(16);function d(){if(!c&&(c="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!c))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(l)}const u=[];for(let re=0;re<256;++re)u.push((re+256).toString(16).slice(1));function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}const g=function(e,t,r){if(a.randomUUID&&!t&&!e)return a.randomUUID();const n=(e=e||{}).random||(e.rng||d)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return h(n)},p=Array.from("09afAF").map((e=>e.charCodeAt(0)));function m(){return f(g())}function f(e){return(0,n.v)(y(e),1187),e}function v(){return f(g())}function y(e){if(36!==e.length)return!1;for(let r=0;r<e.length;r++)switch(r){case 8:case 13:case 18:case 23:if("-"!==e.charAt(r))return!1;break;case 14:if("4"!==e.charAt(r))return!1;break;case 19:{const t=e.charAt(r);if("8"!==t&&"9"!==t&&"a"!==t&&"b"!==t)return!1;break}default:if(!((t=e.charCodeAt(r))>=p[0]&&t<=p[1]||t>=p[2]&&t<=p[3]||t>=p[4]&&t<=p[5]))return!1}var t;return!0}function b(e,t){return e-t}function S(e,t){return e>t?1:e===t?0:-1}function C(e){return-e}function k(e){return-e}const w=0x4n<<76n,P=0x8n<<60n,E=0xffffffffffffn<<80n,T=E>>6n,I=0xfffn<<64n,N=I>>2n,F=0x3fffffffffffffffn;function D(e){const t=BigInt("0x".concat(e.replace(/-/g,"")));return(t&E)>>6n|(t&I)>>2n|t&F}function O(e){const t=((e&T)<<6n|w|(e&N)<<2n|P|e&F).toString(16).padStart(32,"0");return"".concat(t.substring(0,8),"-").concat(t.substring(8,12),"-").concat(t.substring(12,16),"-").concat(t.substring(16,20),"-").concat(t.substring(20,32))}function B(e,t){return e+BigInt(t)}function x(e,t){return e-t}const L=BigInt("0xFFFFFFFFFFFFFFFF"),A=BigInt(64);function R(e,t,r){return e[t]=r,t+1}function M(e,t,r){return e[t]=r&L,e[t+1]=r>>A,t+2}function _(e){const t=e.bufferFloat[e.index];return e.index+=1,t}function z(e){const t=e.bufferUint[e.index],r=e.bufferUint[e.index+1]<<A|t;return e.index+=2,r}var H=r(90645);class U{constructor(e){if(this.uuidSpace=new H.Pb(void 0,S),this.sessionCache=new Map,void 0!==e){for(const[t,r]of e)this.sessionCache.set(O(t),r);if(this.uuidSpace=new H.Pb(e,S),this.sessionCache.size!==e.length||e.length!==this.uuidSpace.size)throw new Error("Cannot resume existing session.")}}sessions(){return this.sessionCache.values()}getOrCreate(e){const t=this.sessionCache.get(e);if(void 0!==t)return t;const r=new j(e);return(0,n.v)(this.uuidSpace.set(r.sessionUuid,r),1888),this.sessionCache.set(e,r),r}get(e){return this.sessionCache.get(e)}getContainingCluster(e){const t=D(e),r=this.uuidSpace.getPairOrNextLower(t);if(void 0===r)return;const[n,o]=r,i=x(t,o.sessionUuid);if(i>Number.MAX_SAFE_INTEGER)return;const s=k(Number(i)+1),a=o.getClusterByLocal(s,!0);return void 0!==a?[a,s]:void 0}clusterCollides(e){const{session:t,baseLocalId:r,capacity:o}=e,i=B(t.sessionUuid,C(r)-1),s=B(i,o-1);let a=this.uuidSpace.getPairOrNextLower(s);for(;void 0!==a&&a[1]===t;)a=this.uuidSpace.nextLowerPair(a[0]);if(void 0===a)return!1;const[c,l]=a;(0,n.v)(l!==t,1889);const d=l.getLastCluster();if(void 0===d)return!1;return B(l.sessionUuid,C(J(d))-1)>=i}equals(e,t){const r=(e,r)=>{const o=e.sessions().next(),i=o.done?void 0:o.value;for(const[s,a]of e.sessionCache.entries()){const e=r.sessionCache.get(s);if(void 0===e){if(!a.isEmpty()||t)return!1;(0,n.v)(a===i,1890)}else if(!a.equals(e))return!1}return!0};return r(this,e)&&r(e,this)}}class j{constructor(e){this.clusterChain=[],this.sessionUuid="string"===typeof e?D(e):e}addNewCluster(e,t,r){const n=this.getLastCluster(),o={session:this,baseFinalId:e,baseLocalId:void 0===n?-1:J(n)-1,capacity:t,count:r};return this.clusterChain.push(o),o}isEmpty(){return 0===this.clusterChain.length}getLastCluster(){return this.clusterChain[this.clusterChain.length-1]}tryConvertToFinal(e,t){const r=this.getClusterByLocal(e,t);if(void 0!==r)return V(r,e)}getClusterByLocal(e,t){const r=t?J:Q;return j.binarySearch(e,this.clusterChain,((e,t)=>e<r(t)?1:e>t.baseLocalId?-1:0))}getClusterByAllocatedFinal(e){return j.getContainingCluster(e,this.clusterChain)}static getContainingCluster(e,t){return j.binarySearch(e,t,((e,t)=>{const r=W(t);return e<t.baseFinalId?-1:e>r?1:0}))}static binarySearch(e,t,r){let n=0,o=t.length-1;for(;n<=o;){const i=Math.floor((n+o)/2),s=r(e,t[i]);if(0===s)return t[i];s>0?n=i+1:o=i-1}}equals(e){for(let t=0;t<this.clusterChain.length;t++)if(!q(this.clusterChain[t],e.clusterChain[t]))return!1;return this.sessionUuid===e.sessionUuid}}function q(e,t){return e.session.sessionUuid===t.session.sessionUuid&&e.baseFinalId===t.baseFinalId&&e.baseLocalId===t.baseLocalId&&e.capacity===t.capacity&&e.count===t.count}function V(e,t){const r=C(t)-C(e.baseLocalId);if(r<e.capacity)return e.baseFinalId+r}function G(e,t){(0,n.v)(t>=e.baseFinalId&&t<=W(e),1891);const r=t-e.baseFinalId;return e.baseLocalId-r}function W(e){return e.baseFinalId+(e.capacity-1)}function K(e){return e.baseFinalId+(e.count-1)}function J(e){return e.baseLocalId-(e.capacity-1)}function Q(e){return e.baseLocalId-(e.count-1)}class X{constructor(e){this.comparator=e,this.elements=[]}get size(){return this.elements.length/2}minKey(){return this.elements[0]}maxKey(){return this.elements[this.elements.length-2]}minValue(){return this.elements[1]}maxValue(){return this.elements[this.elements.length-1]}first(){const{elements:e}=this,{length:t}=e;if(0!==t)return[e[0],e[1]]}last(){const{elements:e}=this,{length:t}=e;if(0===t)return;const r=t-2;return[e[r],e[r+1]]}getAtIndex(e){const t=2*e,{elements:r}=this;if(!(t<0||t>r.length-1))return[r[t],r[t+1]]}*entries(){const{elements:e}=this;for(let t=0;t<e.length;t+=2)yield[e[t],e[t+1]]}*keys(){const{elements:e}=this;for(let t=0;t<e.length;t+=2)yield e[t]}*values(){const{elements:e}=this;for(let t=0;t<e.length;t+=2)yield e[t+1]}*entriesReversed(){const{elements:e}=this;for(let t=e.length-2;t>=0;t-=2)yield[e[t],e[t+1]]}append(e,t){const{elements:r}=this,{length:n}=r;if(0!==n&&this.comparator(e,this.maxKey())<=0)throw new Error("Inserted key must be > all others in the map.");r.push(e),r.push(t)}replaceLast(e,t){const{elements:r,comparator:n}=this,{length:o}=r;if(0!==o&&(r.pop(),r.pop(),n(e,this.maxKey())<=0))throw new Error("Inserted key must be > all others in the map.");r.push(e),r.push(t)}get(e){const t=X.keyIndexOf(this.elements,e,this.comparator);if(!(t<0))return this.elements[t+1]}getPairOrNextLower(e){return this.getPairOrNextLowerBy(e,this.comparator)}getPairOrNextHigher(e){return this.getPairOrNextHigherBy(e,this.comparator)}equals(e,t){if(e===this)return!0;if(this.elements.length!==e.elements.length)return!1;for(let r=this.elements.length-2;r>=0;r-=2){const n=this.elements[r],o=this.elements[r+1],i=e.elements[r],s=e.elements[r+1];if(0!==this.comparator(n,i))return!1;if(!t(o,s))return!1}return!0}assertValid(){let e;for(const t of this.entries())void 0!==e&&(0,n.v)(this.comparator(t[0],e[0])>0,1874),e=t}*getRange(e,t){const r=this.getKeyIndexOfOrNextHigher(e,this.comparator);if(void 0===r)return;const n=this.getKeyIndexOfOrNextLower(t,this.comparator);if(void 0!==n)for(let o=r;o<=n;o+=2)yield[this.elements[o],this.elements[o+1]]}getPairOrNextLowerBy(e,t){const r=this.getKeyIndexOfOrNextLower(e,t);if(void 0!==r)return[this.elements[r],this.elements[r+1]]}getKeyIndexOfOrNextLower(e,t){const{elements:r}=this;if(0===r.length)return;let n=X.keyIndexOf(r,e,t);return n<0?(n^=X.failureXor,n>0?n-2:void 0):n}getPairOrNextHigherBy(e,t){const r=this.getKeyIndexOfOrNextHigher(e,t);if(void 0!==r)return[this.elements[r],this.elements[r+1]]}getKeyIndexOfOrNextHigher(e,t){const{elements:r}=this,{length:n}=r;if(0===n)return;let o=X.keyIndexOf(r,e,t);return o<0?(o^=X.failureXor,o<n?o:void 0):o}static keyIndexOf(e,t,r){let n=0,o=e.length/2,i=o>>1;for(;n<o;){const s=2*i,a=r(t,e[s],e[s+1]);if(a>0)n=i+1;else{if(!(a<0)){if(0===a)return s;throw new Error("Invalid comparator.")}o=i}i=n+o>>1}return 2*i^X.failureXor}}X.failureXor=-1;class Z{constructor(){this.localIdRanges=new X(b)}get idRanges(){return this.localIdRanges}addLocalRange(e,t){const r=this.localIdRanges.last();if(void 0!==r){const[n,o]=r;if(n+o===e)return void this.localIdRanges.replaceLast(n,o+t)}this.localIdRanges.append(e,t)}contains(e){const t=C(e),r=this.localIdRanges.getPairOrNextLower(t);if(void 0!==r){const[e,n]=r;if(t<=e+(n-1))return!0}return!1}equals(e){return this.localIdRanges.equals(e.localIdRanges,((e,t)=>e===t))}}class ${constructor(){this.clusterList=[]}get clusters(){return this.clusterList}getLastCluster(){return this.clusterList[this.clusterList.length-1]}addCluster(e){const t=this.getLastCluster();(0,n.v)(void 0===t||e.baseFinalId===t.baseFinalId+t.capacity,1875),this.clusterList.push(e)}getFinalizedIdLimit(){const e=this.getLastCluster();return void 0===e?0:K(e)+1}getAllocatedIdLimit(){const e=this.getLastCluster();return void 0===e?0:W(e)+1}equals(e){for(let t=0;t<this.clusterList.length;t++)if(!q(this.clusterList[t],e.clusterList[t]))return!1;return this.clusterList.length===e.clusterList.length}}class Y{constructor(e,t){if(this.logger=t,this.normalizer=new Z,this.localGenCount=0,this.nextRangeBaseGenCount=1,this.sessions=new U,this.finalSpace=new $,this.nextRequestedClusterSize=512,this.telemetryLocalIdCount=0,this.telemetryEagerFinalIdCount=0,"string"===typeof e)this.localSessionId=e,this.localSession=this.sessions.getOrCreate(e);else{this.sessions=e;const t=e.sessions().next();(0,n.v)(!t.done,1876),this.localSession=t.value,this.localSessionId=O(this.localSession.sessionUuid)}}static create(e,t){let r,n;void 0===e?r=m():"string"===typeof e?(r=e,n=t):(r=m(),n=t);return new Y(r,void 0===n?void 0:(0,i.pW)({logger:n}))}generateCompressedId(){if(this.ongoingGhostSession)return void 0===this.ongoingGhostSession.cluster?this.ongoingGhostSession.cluster=this.addEmptyCluster(this.sessions.getOrCreate(this.ongoingGhostSession.ghostSessionId),1):this.ongoingGhostSession.cluster.capacity++,this.ongoingGhostSession.cluster.count++,K(this.ongoingGhostSession.cluster);{this.localGenCount++;const e=this.localSession.getLastCluster();if(void 0===e)return this.telemetryLocalIdCount++,this.generateNextLocalId();const t=this.localGenCount-C(e.baseLocalId);return e.capacity>t?(this.telemetryEagerFinalIdCount++,e.baseFinalId+t):(this.telemetryLocalIdCount++,this.generateNextLocalId())}}beginGhostSession(e,t){this.ongoingGhostSession={ghostSessionId:e};try{t()}finally{this.ongoingGhostSession=void 0}}generateNextLocalId(){return this.normalizer.addLocalRange(this.localGenCount,1),k(this.localGenCount)}takeNextCreationRange(){(0,n.v)(!this.ongoingGhostSession,2214);const e=this.localGenCount-(this.nextRangeBaseGenCount-1);if(0===e)return{sessionId:this.localSessionId};const t={sessionId:this.localSessionId,ids:{firstGenCount:this.nextRangeBaseGenCount,count:e,requestedClusterSize:this.nextRequestedClusterSize}};return this.nextRangeBaseGenCount=this.localGenCount+1,Y.assertValidRange(t),t}static assertValidRange(e){if(void 0===e.ids)return;const{count:t,requestedClusterSize:r}=e.ids;(0,n.v)(t>0,1877),(0,n.v)(r>0,2166),(0,n.v)(r<=Y.maxClusterSize,2167)}finalizeCreationRange(e){if((0,n.v)(!this.ongoingGhostSession,2215),void 0===e.ids)return;Y.assertValidRange(e);const{sessionId:t,ids:r}=e,{count:o,firstGenCount:i,requestedClusterSize:s}=r,a=this.sessions.getOrCreate(t),c=a===this.localSession,l=k(i);let d=a.getLastCluster();if(void 0===d){if(-1!==l)throw new Error("Ranges finalized out of order.");var u;if(d=this.addEmptyCluster(a,s+o),c)null===(u=this.logger)||void 0===u||u.sendTelemetryEvent({eventName:"RuntimeIdCompressor:FirstCluster",sessionId:this.localSessionId})}const h=d.capacity-d.count;if(d.baseLocalId-d.count!==l)throw new Error("Ranges finalized out of order.");if(h>=o)d.count+=o;else{const e=o-h,t=e+s;if(d===this.finalSpace.getLastCluster()){var g;if(d.capacity+=t,d.count+=o,(0,n.v)(!this.sessions.clusterCollides(d),1878),c)null===(g=this.logger)||void 0===g||g.sendTelemetryEvent({eventName:"RuntimeIdCompressor:ClusterExpansion",sessionId:this.localSessionId,previousCapacity:d.capacity-t,newCapacity:d.capacity,overflow:e})}else{d.count=d.capacity;var p;if(this.addEmptyCluster(a,t).count+=e,c)null===(p=this.logger)||void 0===p||p.sendTelemetryEvent({eventName:"RuntimeIdCompressor:NewCluster",sessionId:this.localSessionId})}}var m;c&&(null===(m=this.logger)||void 0===m||m.sendTelemetryEvent({eventName:"RuntimeIdCompressor:IdCompressorStatus",eagerFinalIdCount:this.telemetryEagerFinalIdCount,localIdCount:this.telemetryLocalIdCount,sessionId:this.localSessionId}),this.telemetryEagerFinalIdCount=0,this.telemetryLocalIdCount=0);(0,n.v)(!a.isEmpty(),1879)}addEmptyCluster(e,t){var r;(0,n.v)(!(null!==(r=this.ongoingGhostSession)&&void 0!==r&&r.cluster),2216);const o=e.addNewCluster(this.finalSpace.getAllocatedIdLimit(),t,0);return(0,n.v)(!this.sessions.clusterCollides(o),1880),this.finalSpace.addCluster(o),o}normalizeToOpSpace(e){if(s(e))return e;{const t=e;if(!this.normalizer.contains(t))throw new Error("Invalid ID to normalize.");const r=this.localSession.tryConvertToFinal(t,!0);return void 0===r?t:r}}normalizeToSessionSpace(e,t){if(s(e)){const t=this.localSession.getClusterByAllocatedFinal(e);if(void 0===t){if(e>=this.finalSpace.getFinalizedIdLimit())throw new Error("Unknown op space ID.");return e}{const r=G(t,e);if(this.normalizer.contains(r))return r;if(C(r)>this.localGenCount)throw new Error("Unknown op space ID.");return e}}{const r=e;if(t===this.localSessionId){if(this.normalizer.contains(r))return r;throw new Error("Unknown op space ID.")}{const e=this.sessions.get(t);if(void 0===e)throw new Error("No IDs have ever been finalized by the supplied session.");const n=e.tryConvertToFinal(r,!1);if(void 0===n)throw new Error("Unknown op space ID.");return n}}}decompress(e){if(s(e)){const t=j.getContainingCluster(e,this.finalSpace.clusters);if(void 0===t)throw new Error("Unknown ID");const r=G(t,e),o=C(r);if(o>C(Q(t))){if(t.session!==this.localSession)throw new Error("Unknown ID");(0,n.v)(!this.normalizer.contains(r),1881)}return O(B(t.session.sessionUuid,o-1))}{const t=e;if(!this.normalizer.contains(t))throw new Error("Unknown ID");return O(B(this.localSession.sessionUuid,C(t)-1))}}recompress(e){const t=this.tryRecompress(e);if(void 0===t)throw new Error("Could not recompress.");return t}tryRecompress(e){const t=this.sessions.getContainingCluster(e);if(void 0!==t){const[e,r]=t;return e.session===this.localSession?this.normalizer.contains(r)?r:((0,n.v)(C(r)<=this.localGenCount,1882),V(e,r)):C(r)>=Q(e)?V(e,r):void 0}{const t=x(D(e),this.localSession.sessionUuid);if(t<Number.MAX_SAFE_INTEGER){const e=k(Number(t)+1);if(this.normalizer.contains(e))return e}}}serialize(e){var t;(0,n.v)(!this.ongoingGhostSession,2217);const{normalizer:r,finalSpace:i,sessions:s}=this,a=new Map;let c=0;for(const n of s.sessions())n.isEmpty()&&!e||(a.set(n,c),c++);const l=e?3+2*this.normalizer.idRanges.size:0,d=4+2*a.size+3*i.clusters.length+l,u=new Float64Array(d),h=new BigUint64Array(u.buffer);let g=0;g=R(u,g,2),g=function(e,t,r){return R(e,t,r?1:0)}(u,g,e),g=R(u,g,a.size),g=R(u,g,i.clusters.length);for(const[n]of a.entries())g=M(h,g,n.sessionUuid);if(i.clusters.forEach((e=>{g=R(u,g,a.get(e.session)),g=R(u,g,e.capacity),g=R(u,g,e.count)})),e){g=R(u,g,this.localGenCount),g=R(u,g,this.nextRangeBaseGenCount),g=R(u,g,r.idRanges.size);for(const[e,t]of r.idRanges.entries())g=R(u,g,e),g=R(u,g,t)}return(0,n.v)(g===d,1883),null===(t=this.logger)||void 0===t||t.sendTelemetryEvent({eventName:"RuntimeIdCompressor:SerializedIdCompressorSize",size:u.byteLength,clusterCount:i.clusters.length,sessionCount:a.size}),(0,o.JR)(u.buffer,"base64")}static deserialize(e,t){const r=(0,o.Xg)(e,"base64"),n={index:0,bufferFloat:new Float64Array(r),bufferUint:new BigUint64Array(r)};switch(_(n)){case 1:throw new Error("IdCompressor version 1.0 is no longer supported.");case 2:return Y.deserialize2_0(n,t);default:throw new Error("Unknown IdCompressor serialized version.")}}static deserialize2_0(e,t){const r=function(e){return 1===_(e)}(e),o=_(e),i=_(e);let s=0;const a=[];if(r)(0,n.v)(void 0===t,1886);else{(0,n.v)(void 0!==t,1885);const e=D(t);a.push([e,new j(e)]),s=1}for(let n=0;n<o;n++){const t=z(e);a.push([t,new j(t)])}const c=new Y(new U(a));let l=0;for(let n=0;n<i;n++){const t=a[_(e)+s][1],r=_(e),n=_(e),o=t.addNewCluster(l,r,n);c.finalSpace.addCluster(o),l+=r}if(r){c.localGenCount=_(e),c.nextRangeBaseGenCount=_(e);const t=_(e);for(let r=0;r<t;r++)c.normalizer.addLocalRange(_(e),_(e))}return(0,n.v)(e.index===e.bufferFloat.length,1887),c}equals(e,t){return!!(!t||this.localSessionId===e.localSessionId&&this.localSession.equals(e.localSession)&&this.normalizer.equals(e.normalizer)&&this.nextRangeBaseGenCount===e.nextRangeBaseGenCount&&this.localGenCount===e.localGenCount)&&(this.sessions.equals(e.sessions,t)&&this.finalSpace.equals(e.finalSpace))}}function ee(e,t){return Y.create(e,t)}function te(e,t){return void 0===t?Y.deserialize(e):Y.deserialize(e,t)}Y.maxClusterSize=2**20},73702:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>b});var n=r(34445);function o(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class i extends Uint8Array{toString(e){return function(e,t){switch(t){case"base64":return n.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}(this,e)}static from(e,t,r){if("string"===typeof e)return i.fromString(e,t);if(null!==e&&"object"===typeof e&&o(e.buffer))return i.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(o(e))return i.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const n=null!==t&&void 0!==t?t:0,o=null!==r&&void 0!==r?r:e.byteLength-n;if(n<0||n>e.byteLength||o<0||o+n>e.byteLength)throw new RangeError("Invalid range specified.");return new i(e,n,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=n.toByteArray(t);return new i(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new i(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}const s=e=>i.from(e,"base64").toString("utf8"),a="https://my.microsoftpersonalcontent.com",c="https://1drv.ms",l="fluid",d="s",u="d",h="f",g="c",p="a",m="p",f="v",v="x";const y="nav";function b(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(y);if(!r)return;return function(e,t){var r,n,o,i;let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const c=new URLSearchParams(s(e)),y=c.get(l);if(a&&"1"!==y)return;const b=c.get(d),S=c.get(u),C=c.get(h),k=c.get(g),w=null!==(r=c.get(p))&&void 0!==r?r:void 0,P=null!==(n=c.get(m))&&void 0!==n?n:void 0,E=null!==(o=c.get(f))&&void 0!==o?o:void 0,T=null!==(i=c.get(v))&&void 0!==i?i:void 0;if(!b||!S||!C||null===k)return;let I;try{I=new URL(b,t)}catch{}return I?{siteUrl:I.href,driveId:S,itemId:C,dataStorePath:k,appName:w,containerPackageName:P,fileVersion:E,context:T}:void 0}(r,e.origin.toLowerCase()===c?a:e.origin,t)}},57406:(e,t,r)=>{"use strict";var n,o,i;r.d(t,{Go:()=>n}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(n||(n={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(o||(o={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},39613:(e,t,r)=>{"use strict";var n;r.d(t,{h:()=>n}),function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(n||(n={}))},94489:(e,t,r)=>{"use strict";var n,o;r.d(t,{$:()=>o,S:()=>n}),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Symlink="120000"}(n||(n={})),function(e){e.Blob="Blob",e.Tree="Tree",e.Attachment="Attachment"}(o||(o={}))},2642:(e,t,r)=>{"use strict";var n;r.d(t,{Z:()=>n}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(n||(n={}))},60574:(e,t,r)=>{"use strict";function n(e,t){if(""===e)return void 0===t?"":t.absolutePath;{let r=e.startsWith("/")?e.slice(1):e;return r=r.endsWith("/")?r.slice(0,-1):r,void 0===t?"/".concat(r):"".concat("/"===t.absolutePath?"":t.absolutePath,"/").concat(r)}}r.d(t,{a:()=>n})},28101:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});class n{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce(((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e)),[])}static create(e){return e instanceof n?e:new n(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):""}get url(){return this.request.url}get headers(){return this.request.headers}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=n.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:"/".concat(this.query),headers:this.headers};const r="/".concat(this.pathParts.slice(e).join("/"));return{url:""===this.query?r:"".concat(r,"/").concat(this.query),headers:this.headers}}}},82673:(e,t,r)=>{"use strict";r.d(t,{x:()=>n});const n="IFluidDependencySynthesizer"},82351:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});var n=r(58400),o=r(82673);class i{get IFluidDependencySynthesizer(){return this}constructor(){this.providers=new Map;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter((e=>void 0!==e))}register(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){const r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,o.x,{get:()=>this}),r}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(const t of this.parents){if(t instanceof i)return t.getProvider(e);{const r=t;if(void 0!==(null===r||void 0===r?void 0:r.getProvider))return r.getProvider(e)}}}}generateRequired(e,t){if(void 0!==t)for(const r of Object.keys(t)){const t=this.resolveProvider(r);if(void 0===t)throw new Error("Object attempted to be created without registered required provider ".concat(String(r)));Object.defineProperty(e,r,t)}}generateOptional(e,t){if(void 0!==t)for(const n of Object.keys(t)){var r;const t=null!==(r=this.resolveProvider(n))&&void 0!==r?r:{get:async()=>{}};Object.defineProperty(e,n,t)}}resolveProvider(e){const t=this.providers.get(e);if(void 0!==t)return"function"===typeof t?{get(){if(t&&"function"===typeof t)return Promise.resolve(this[o.x]).then((async e=>t(e))).then((t=>null===t||void 0===t?void 0:t[e]))}}:{get(){if(t)return new n.I((async()=>Promise.resolve(t).then((t=>{if(t)return t[e]}))))}};for(const r of this.parents){const t={[e]:e},n=r.synthesize(t,{}),o=Object.getOwnPropertyDescriptor(n,e);if(void 0!==o)return o}}}},11374:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});const n={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},41179:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var n=r(11374);const{dataCorruptionError:o,dataProcessingError:i,...s}=n.k,a={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var c;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(c||(c={}))},66206:(e,t,r)=>{"use strict";r.d(t,{W:()=>o,i:()=>n});const n="https://my.microsoftpersonalcontent.com",o="https://1drv.ms"},95740:(e,t,r)=>{"use strict";r.d(t,{f:()=>a,a:()=>s});const{dataCorruptionError:n,dataProcessingError:o,...i}={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},s={...i,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"};var a;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked",e.outOfStorageError="outOfStorageError"}(a||(a={}))},69953:(e,t,r)=>{"use strict";r.d(t,{E:()=>n,P:()=>o});const n={...r(95740).a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"};var o;!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly",e.blockedIPAddress="blockedIPAddress"}(o||(o={}))},79478:(e,t,r)=>{"use strict";r.d(t,{V:()=>o,o:()=>n});const n="snapshot";function o(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}},55919:(e,t,r)=>{"use strict";var n,o,i;r.d(t,{DD:()=>n,Nd:()=>i,Vy:()=>o}),function(e){e.csl="csl"}(n||(n={})),function(e){e.organization="organization",e.users="users",e.anonymous="anonymous",e.default="default"}(o||(o={})),function(e){e.view="view",e.edit="edit"}(i||(i={}))},8024:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});const n=3},95975:(e,t,r)=>{"use strict";var n,o;r.d(t,{O:()=>n,t:()=>o}),function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(n||(n={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(o||(o={}))},80946:(e,t,r)=>{"use strict";function n(e){let t="".concat(e.siteUrl,"?driveId=").concat(encodeURIComponent(e.driveId),"&itemId=").concat(encodeURIComponent(e.itemId),"&path=").concat(encodeURIComponent(e.dataStorePath));return e.containerPackageName&&(t+="&containerPackageName=".concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(t+="&fileVersion=".concat(encodeURIComponent(e.fileVersion))),t}r.d(t,{m:()=>n})},45792:(e,t,r)=>{"use strict";r.d(t,{Cj:()=>y,iJ:()=>C});var n=r(14826),o=r(12624),i=r(24356),s=r(72264),a=r(33941),c=r(60056),l=r(76078),d=r(7791),u=r(19307),h=r(79478),g=r(95740),p=r(76140),m=r(8024),f=r(95975),v=r(53727);const y="Odsp409Error";class b{constructor(e,t,r,o){this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=o,this.driverId=(0,n.A)(),this.networkCallNumber=1,this.rateLimiter=new d.v(24),this.snapshotCacheExpiryTimeoutMs=(0,s.Ln)(r).config.getBoolean("Fluid.Driver.Odsp.TestOverride.DisableSnapshotCache")?0:1728e5}setEpoch(e,t,r){(0,o.v)(void 0===this._fluidEpoch,475),this._fluidEpoch=e,this.logger.sendTelemetryEvent({eventName:"EpochLearnedFirstTime",epoch:e,fetchType:r,fromCache:t})}async get(e){try{const r=await this.cache.get(this.fileEntryFromEntry(e));if(void 0===r||r.version!==m.F)return;if((0,o.v)(void 0!==r.fluidEpoch,476),void 0===this._fluidEpoch)this.setEpoch(r.fluidEpoch,!0,"cache");else if(this._fluidEpoch!==r.fluidEpoch)return;if(e.type===h.o){var t;const e=null===(t=r.value)||void 0===t?void 0:t.cacheEntryTime,n=Date.now();if(void 0===e||n-e>=this.snapshotCacheExpiryTimeoutMs)return this.logger.sendTelemetryEvent({eventName:"odspVersionsCacheExpired",duration:n-e,maxCacheAgeMs:this.snapshotCacheExpiryTimeoutMs}),void await this.removeEntries()}return r.value}catch(r){return void this.logger.sendErrorEvent({eventName:"cacheFetchError",type:e.type},r)}}async put(e,t){var r;((0,o.v)(void 0!==this._fluidEpoch,477),e.type===h.o)&&(t.cacheEntryTime=null!==(r=t.cacheEntryTime)&&void 0!==r?r:Date.now());const n={value:t,version:m.F,fluidEpoch:this._fluidEpoch};return this.cache.put(this.fileEntryFromEntry(e),n).catch((t=>{throw this.logger.sendErrorEvent({eventName:"cachePutError",type:e.type},t),t}))}async removeEntries(){try{return await this.cache.removeEntries(this.fileEntry)}catch(e){this.logger.sendErrorEvent({eventName:"removeCacheEntries"},e)}}get fluidEpoch(){return this._fluidEpoch}async validateEpoch(e,t){(0,o.v)(void 0!==e,1412);try{this.validateEpochFromResponse(e,t)}catch(r){throw await this.checkForEpochError(r,e,t),r}}async fetchAndParseAsJSON(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,p.bf,r,n,o)}async fetch(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,p.ZR,r,n,o)}async fetchCore(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const s=this.formatClientCorrelationId(i);let l;return this.addEpochInRequest(t,o,s),this.rateLimiter.schedule((async()=>r(e,t))).then((e=>(l=e.headers.get("x-fluid-epoch"),this.validateEpochFromResponse(l,n),e.propsToLog.XRequestStatsHeader=s,e))).catch((async e=>{throw void 0===l&&(l=e.serverEpoch),await this.checkForEpochError(e,l,n),e})).catch((e=>{if((0,a.Xy)(e)&&e.errorType===g.f.fileNotFoundOrAccessDeniedError){const t=e.redirectLocation;if(void 0!==t){const r=function(e,t){const r={...(0,p.Yn)(e)},n=new URL(t).origin,o="".concat(n).concat(new URL(r.siteUrl).pathname);return r.siteUrl=o,r}(this.fileEntry.resolvedUrl,t),n=new u.c_(e.message,r,{driverVersion:v.z,redirectLocation:t});throw n.addTelemetryProperties(e.getTelemetryProperties()),n}}throw e})).catch((e=>{throw(0,c.cQ)(e,{props:{XRequestStatsHeader:s}})}))}async fetchArray(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,p.cr,r,n,o)}addEpochInRequest(e,t,r){const n=(0,p.Yn)(this.fileEntry.resolvedUrl).isClpCompliantApp;if(t){const t={};t["X-RequestStats"]=r,void 0!==this.fluidEpoch&&(t["x-fluid-epoch"]=this.fluidEpoch),n&&(t[f.t.isClpCompliantApp]=n.toString()),this.addParamInBody(e,t)}else{const t=(t,r)=>{e.headers={...e.headers},(0,o.v)(void 0!==e.headers,642),e.headers[t]=r};t("X-RequestStats",r),void 0!==this.fluidEpoch&&t("x-fluid-epoch",this.fluidEpoch),n&&t(f.t.isClpCompliantApp,n.toString())}}addParamInBody(e,t){const r=e.body;(0,o.v)("string"===typeof r,541);const n=r.split("\r\n"),i=n.shift();(0,o.v)(!0===(null===i||void 0===i?void 0:i.startsWith("--")),542);const s=[i];Object.entries(t).forEach((e=>{let[t,r]=e;s.push("".concat(t,": ").concat(r))})),n.forEach((e=>{s.push(e)})),e.body=s.join("\r\n")}formatClientCorrelationId(e){const t=["driverId=".concat(this.driverId),"RequestNumber=".concat(this.networkCallNumber++),"driverVersion=".concat(v.z),"isSummarizer=".concat(this.clientIsSummarizer)];return void 0!==e&&t.push("fetchReason=".concat(e)),t.join(", ")}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.checkForEpochErrorCore(e);if(void 0!==n)throw n;void 0!==e&&void 0===this._fluidEpoch&&this.setEpoch(e,r,t)}async checkForEpochError(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,a.Xy)(e)&&e.errorType===g.f.fileOverwrittenInStorage){const o=this.checkForEpochErrorCore(t);if(void 0!==o)throw o.addTelemetryProperties({fromCache:n,fetchType:r}),this.logger.sendErrorEvent({eventName:"fileOverwrittenInStorage"},o),await this.removeEntries(),o;throw(0,c.J4)(e,(e=>new u.Gi("Coherency 409: ".concat(e),1,{[y]:!0,driverVersion:v.z})))}}checkForEpochErrorCore(e){if(this.fluidEpoch&&e&&this.fluidEpoch!==e)return new u.OI("Epoch mismatch",g.f.fileOverwrittenInStorage,{driverVersion:v.z,serverEpoch:e,clientEpoch:this.fluidEpoch})}fileEntryFromEntry(e){return{...e,file:this.fileEntry}}}class S extends b{constructor(e,t,r,n){super(e,t,r,n),this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=n,this.treesLatestDeferral=new i.c,this.treesLatestDeferral.promise.catch((()=>{}))}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super.validateEpochFromResponse(e,t,r),this.treesLatestDeferral.resolve()}async get(e){let t=super.get(e);return e.type===h.o&&(t=t.then((e=>(void 0!==e&&this.treesLatestDeferral.resolve(),e))).catch((e=>{throw this.treesLatestDeferral.reject(e),e}))),t}async fetchAndParseAsJSON(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;const i=this.treesLatestDeferral.isCompleted;try{return await super.fetchAndParseAsJSON(e,t,r,n,o)}catch(s){if("treesLatest"===r&&this.treesLatestDeferral.reject(s),"joinSession"!==r||s.statusCode<401||s.statusCode>404||i)throw s}return await l.Bt.timedExecAsync(this.logger,{eventName:"JoinSessionSyncWait"},(async e=>{let t;const r=new Promise((e=>{t=setTimeout((()=>{e(51)}),15e3)}));51===await Promise.race([r,this.treesLatestDeferral.promise.finally((()=>clearTimeout(t)))])&&e.cancel()}),{start:!0,end:!0,cancel:"generic"}),super.fetchAndParseAsJSON(e,t,r,n)}}function C(e,t,r,n,o){const i=new S(e,r,n,o);return{cache:{...t,persistedCache:i},epochTracker:i}}},45061:(e,t,r)=>{"use strict";function n(e,t,r){if(!t||0===t.length)return{url:e,headers:{}};if(!r){const r=new URL(e);if(r.searchParams.set("access_token",t),r.search.length<=2048)return{headers:{},url:r.href}}return{headers:{Authorization:"Bearer ".concat(t)},url:e}}r.d(t,{$:()=>n})},73905:(e,t,r)=>{"use strict";r.d(t,{Y:()=>S});var n,o=r(12624);!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(n||(n={}));var i=r(95740),s=r(55919),a=r(19307),c=r(80946),l=r(56730),d=r(76140),u=r(70202),h=r(3878);var g=r(95975),p=r(53727);function m(e,t,r,n){const o=new URL(e).origin,i=n?"versions/".concat(n,"/"):"";return"".concat((0,l.lA)(o),"/drives/").concat(t,"/items/").concat(r,"/").concat(i)}function f(e,t,r,n){const o=m(e,t,r,n);return"".concat(o,"opStream/snapshots")}function v(e,t,r,n){const o=m(e,t,r,n);return"".concat(o,"opStream/attachment")}function y(e,t,r,n){const o=m(e,t,r,n);return"".concat(o,"opStream/attachments")}function b(e,t,r,n){const o=m(e,t,r,n);return"".concat(o,"opStream")}class S{constructor(){}async resolve(e){var t,r,c;if(null!==(t=e.headers)&&void 0!==t&&t[n.createNew]){var l;const[t,r]=e.url.split("?"),o=new URLSearchParams(r),c=e.headers[n.createNew].fileName,d=o.get("driveId"),u=o.get("path"),h=o.get("containerPackageName"),m=o.get("createLinkType");if(!(c&&t&&d&&null!==u&&void 0!==u))throw new a.OI("Proper new file params should be there!!",i.f.genericError,{driverVersion:p.z});let f;return m&&m in s.DD&&(f={createLink:{type:s.DD[m]}}),{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:"fluid-odsp://".concat(t,"?").concat(r,"&version=null"),siteUrl:t,hashedDocumentId:"",driveId:d,itemId:"",fileName:c,summarizer:!1,codeHint:{containerPackageName:null!==h&&void 0!==h?h:void 0},fileVersion:void 0,shareLinkInfo:f,isClpCompliantApp:null===(l=e.headers)||void 0===l?void 0:l[g.t.isClpCompliantApp]}}const{siteUrl:d,driveId:m,itemId:S,path:C,containerPackageName:k,fileVersion:w}=function(e){const[t,r]=e.split("?"),n=new URLSearchParams(r),o=n.get("driveId"),i=n.get("itemId"),s=n.get("path"),a=n.get("containerPackageName"),c=n.get("fileVersion");if(null===o)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(o),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),P=await async function(e,t){const r=u.Ss.from("".concat(e,"_").concat(t));return encodeURIComponent(await(0,h.D)(r,"SHA-256","base64"))}(m,S);(0,o.v)(!P.includes("/"),168);const E="fluid-odsp://placeholder/placeholder/".concat(P,"/").concat((T=C).startsWith("/")?T.substr(1):T);var T;const I=!(null===(r=e.headers)||void 0===r||!r[n.summarizingClient]);return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:f(d,m,S,w),attachmentPOSTStorageUrl:v(d,m,S,w),attachmentGETStorageUrl:y(d,m,S,w),deltaStorageUrl:b(d,m,S,w)},id:P,tokens:{},url:E,hashedDocumentId:P,siteUrl:d,driveId:m,itemId:S,dataStorePath:C,fileName:"",summarizer:I,codeHint:{containerPackageName:k},fileVersion:w,isClpCompliantApp:null===(c=e.headers)||void 0===c?void 0:c[g.t.isClpCompliantApp]}}async getAbsoluteUrl(e,t,r){var n,o;const i=(0,d.Yn)(e);let s=t;""===t&&void 0!==i.dataStorePath&&(s=i.dataStorePath),s.startsWith("/")&&(s=s.substr(1));let a;var l;return r&&"name"in r?a=r.name:a="object"===typeof(l=null===r||void 0===r?void 0:r.package)&&"string"===typeof(null===l||void 0===l?void 0:l.name)&&"object"===typeof(null===l||void 0===l?void 0:l.fluid)?null===r||void 0===r?void 0:r.package.name:null===r||void 0===r?void 0:r.package,a=null!==(n=a)&&void 0!==n?n:null===(o=i.codeHint)||void 0===o?void 0:o.containerPackageName,(0,c.m)({...i,containerPackageName:a,dataStorePath:s})}}},55863:(e,t,r)=>{"use strict";r.d(t,{s:()=>S});var n=r(89165),o=r(3221),i=r(95975),s=r(80946),a=r(73905),c=r(76140),l=r(76078),d=r(12624),u=r(84792),h=r(19307),g=r(95740),p=r(45061),m=r(53727),f=r(9690);const v=new Map;async function y(e,t,r){const n="".concat(t.siteUrl,"_").concat(t.driveId,"_").concat(t.itemId),o=v.get(n);if(void 0!==o)return o;const i=async function(){let o;try{let n=0;o=await(0,u.M)((async()=>(0,f.M)((async()=>async function(e,t,r){const n=await async function(e,t,r,n){return l.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getFileItemLite"},(async o=>{let i,s=0;const a=await(0,c.gO)((async o=>{s++;const{siteUrl:a,driveId:l,itemId:u}=t,f=(0,c.yI)(r,t,e,!0),v=await f(o,"GetFileItemLite");(0,d.v)(null!==v,700);const{url:y,headers:S}=(0,p.$)("".concat(a,"/_api/v2.0/drives/").concat(l,"/items/").concat(u,"?select=webUrl,webDavUrl,sharepointIds"),v,n),C={method:"GET",headers:S},k=await(0,c.ZR)(y,C);i=k.propsToLog;const w=await k.content.json();if(!b(w))throw new h.OI("Malformed getFileItemLite response",g.f.incorrectServerResponse,{driverVersion:m.z});return w}));return o.end({...i,attempts:s}),a}))}(e,t,r,!0);return l.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getSharingInformation"},(async o=>{let i,s=0;const a=await(0,c.gO)((async o=>{var a;s++;const l=(0,c.yI)(r,t,e,!0),u=await l(o,"GetFileLinkCore");(0,d.v)(null!==u,699);const{url:f,headers:v}=(0,p.$)("".concat(t.siteUrl,"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid").concat(encodeURIComponent("'".concat(n.sharepointIds.listItemUniqueId,"'"))),u,!0),y={method:"POST",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose",...v}},b=await(0,c.ZR)(f,y);i=b.propsToLog;const S=await b.content.json(),C=null===S||void 0===S||null===(a=S.d)||void 0===a?void 0:a.directUrl;if("string"!==typeof C)throw new h.OI("Malformed GetSharingInformation response",g.f.incorrectServerResponse,{driverVersion:m.z});return C}));return o.end({...i,attempts:s}),a}))}(e,t,r)),"getFileLinkCore",r)),"getShareLink",r,{onRetry(e,t){if(n++,5===n){if(void 0!==t&&"object"===typeof t)throw t.canRetry=!1,t;throw t}}})}catch(i){throw v.delete(n),i}return(0,d.v)(void 0!==o,658),o}();return v.set(n,i),i}const b=e=>"string"===typeof e.webUrl&&"string"===typeof e.webDavUrl&&"object"===typeof e.sharepointIds;class S{constructor(e,t,r,o){this.appName=r,this.getContext=o,this.sharingLinkCache=new n.o,this.logger=(0,c.bP)(t),e&&(this.shareLinkFetcherProps={...e,tokenFetcher:e.tokenFetcher})}appendDataStorePath(e,t){const r=(0,o.Mh)(e);if(!r)return;const n=new URL(r.dataStorePath,"".concat(e.protocol,"//").concat(e.hostname));if(t.startsWith("/?")||t.startsWith("?")){new URLSearchParams(t).forEach(((e,t)=>{n.searchParams.append(t,e)})),r.dataStorePath="".concat(n.pathname).concat(n.search)}else r.dataStorePath="".concat(n.pathname).concat(n.pathname.endsWith("/")||t.startsWith("/")?"":"/").concat(t,"/").concat(n.search);return(0,o.Cu)(e,r),e.href}getKey(e){return"".concat(e.siteUrl,",").concat(e.driveId,",").concat(e.itemId)}async resolve(e){var t;const r={headers:e.headers,url:e.url},n=null===(t=r.headers)||void 0===t?void 0:t[i.O.isSharingLinkToRedeem];try{const t=new URL(e.url),n=(0,o.Mh)(t);n&&(r.url=(0,s.m)(n))}catch{}const c=await(new a.Y).resolve(r);var l;n&&(c.shareLinkInfo=Object.assign(null!==(l=c.shareLinkInfo)&&void 0!==l?l:{},{sharingLinkToRedeem:this.removeNavParam(e.url)}));return c.itemId&&this.getShareLinkPromise(c).catch((()=>{})),c}removeNavParam(e){const t=new URL(e),r=new URLSearchParams(t.search);return r.delete(o.jC),t.search=r.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),r=this.sharingLinkCache.get(t);if(r)return r;const n=y(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch((e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e}));return this.sharingLinkCache.add(t,(async()=>n)),n}async getAbsoluteUrl(e,t,r){var n,i,s;const a=(0,c.Yn)(e),l=await this.getShareLinkPromise(a),d=new URL(l);let u=t;""===t&&void 0!==a.dataStorePath&&(u=a.dataStorePath);let h;var g;r&&"name"in r?h=r.name:h="object"===typeof(g=null===r||void 0===r?void 0:r.package)&&"string"===typeof(null===g||void 0===g?void 0:g.name)&&"object"===typeof(null===g||void 0===g?void 0:g.fluid)?null===r||void 0===r?void 0:r.package.name:null===r||void 0===r?void 0:r.package,h=null!==(n=h)&&void 0!==n?n:null===(i=a.codeHint)||void 0===i?void 0:i.containerPackageName;const p=await(null===(s=this.getContext)||void 0===s?void 0:s.call(this,a,u));return(0,o.Cu)(d,{siteUrl:a.siteUrl,driveId:a.driveId,itemId:a.itemId,dataStorePath:u,appName:this.appName,containerPackageName:h,fileVersion:a.fileVersion,context:p}),d.href}static createDocumentUrl(e,t){const r=new URL(e);return(0,o.Cu)(r,t),r.href}static createNavParam(e){return(0,o.kt)(e)}}},3221:(e,t,r)=>{"use strict";r.d(t,{kt:()=>f,Mh:()=>b,jC:()=>v,Cu:()=>y});var n=r(74086);const o="https://my.microsoftpersonalcontent.com",i="https://1drv.ms",s="1",a="fluid",c="s",l="d",d="f",u="c",h="a",g="p",p="v",m="x";function f(e){const t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),o=encodeURIComponent(e.driveId),i=encodeURIComponent(e.itemId),f=encodeURIComponent(e.dataStorePath);let v="".concat(c,"=").concat(r,"&").concat(l,"=").concat(o,"&").concat(d,"=").concat(i,"&").concat(u,"=").concat(f,"&").concat(a,"=").concat(s);return e.appName&&(v+="&".concat(h,"=").concat(encodeURIComponent(e.appName))),e.containerPackageName&&(v+="&".concat(g,"=").concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(v+="&".concat(p,"=").concat(encodeURIComponent(e.fileVersion))),e.context&&(v+="&".concat(m,"=").concat(encodeURIComponent(e.context))),(0,n.O0)(v)}const v="nav";function y(e,t){const r=f(t);e.searchParams.set(v,r)}function b(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(v);if(!r)return;return function(e,t){var r,o,i,s;let f=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const v=new URLSearchParams((0,n.AH)(e)),y=v.get(a);if(f&&"1"!==y)return;const b=v.get(c),S=v.get(l),C=v.get(d),k=v.get(u),w=null!==(r=v.get(h))&&void 0!==r?r:void 0,P=null!==(o=v.get(g))&&void 0!==o?o:void 0,E=null!==(i=v.get(p))&&void 0!==i?i:void 0,T=null!==(s=v.get(m))&&void 0!==s?s:void 0;if(!b||!S||!C||null===k)return;let I;try{I=new URL(b,t)}catch{}return I?{siteUrl:I.href,driveId:S,itemId:C,dataStorePath:k,appName:w,containerPackageName:P,fileVersion:E,context:T}:void 0}(r,e.origin.toLowerCase()===i?o:e.origin,t)}},56730:(e,t,r)=>{"use strict";function n(e){return e.includes("onedrive.com")||e.includes("storage.live.com")||e.includes("storage.live-int.com")||e.includes("onedrive-tst.com")}function o(e){let t="_api/";return n(e)&&(t=""),"".concat(e,"/").concat(t,"v2.1")}r.d(t,{hw:()=>n,lA:()=>o})},76140:(e,t,r)=>{"use strict";r.d(t,{wF:()=>F,wL:()=>I,bP:()=>E,bf:()=>k,cr:()=>C,ZR:()=>S,Q1:()=>B,Yn:()=>P,$z:()=>y,gO:()=>b,TV:()=>v,$o:()=>w,K3:()=>N,xP:()=>D,jL:()=>O,yI:()=>T});var n=r(95740),o=r(19307),i=r(21605),s=r(12624),a=r(76078),c=r(60056),l=r(25880),d=r(69953);const u=e=>null===e||"string"===typeof e?e:void 0===e?null:e.token,h=e=>null===e||"string"===typeof e?void 0:e.fromCache;var g=r(79478),p=r(17541);const m=async(e,t)=>p(e,t);var f=r(53727);const v="getWithRetryForTokenRefreshRepeat",y=e=>new URL(e).origin;async function b(e){return e({refresh:!1}).catch((async t=>{const r={refresh:!0,previousError:t};switch(t.errorType){case n.f.authorizationError:return e({...r,claims:t.claims,tenantId:t.tenantId});case n.f.incorrectServerResponse:case d.P.fetchTokenError:return e(r);default:if(!0===t[v])return e(r);throw t}}))}async function S(e,t){const r=i.F.now();return m(e,t).then((async e=>{const t=e;if(!t)throw new o.OI("No response from ODSP fetch call",n.f.incorrectServerResponse,{driverVersion:f.z});(!t.ok||t.status<200||t.status>=300)&&(0,l.lJ)("ODSP fetch error [".concat(t.status,"]"),t.status,t,await t.text());const s=function(e){const t=new Map;for(const[r,n]of e.entries())t.set(r,n);return t}(t.headers);return{content:t,headers:s,propsToLog:(0,l.qw)(s),duration:i.F.now()-r}}),(e=>{const t=(0,o.sc)(),r={value:"".concat(e),tag:a.mc.UserData},i=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new o.dw("Fetch Timeout (AbortError)",d.P.fetchTimeout,{driverVersion:f.z});if(i.includes("ETIMEDOUT"))throw new o.dw("Fetch Timeout (ETIMEDOUT)",d.P.fetchTimeout,{driverVersion:f.z});throw t===o.WA.Offline?new o.dw("ODSP fetch failure (Offline): ".concat(i),n.f.offlineError,{driverVersion:f.z,rawErrorMessage:r}):new o.dw("ODSP fetch failure: ".concat(i),n.f.fetchFailure,{driverVersion:f.z,rawErrorMessage:r})}))}async function C(e,t){const{content:r,headers:n,propsToLog:o,duration:i}=await S(e,t);let s;try{s=await r.arrayBuffer()}catch(a){(0,l.lJ)("Error while parsing fetch response",l.TX,r,void 0,o)}return o.bodySize=s.byteLength,{headers:n,content:s,propsToLog:o,duration:i}}async function k(e,t){const{content:r,headers:n,propsToLog:o,duration:i}=await S(e,t);let s;try{s=await r.text()}catch(a){(0,l.lJ)("Error while parsing fetch response",l.TX,r,s,o)}o.bodySize=s.length;return{headers:n,content:JSON.parse(s),propsToLog:o,duration:i}}function w(e){return void 0===e.type||"New"===e.type}function P(e){return(0,s.v)(!0===e.odspResolvedUrl,478),e}const E=e=>(0,a.pW)({logger:e,namespace:"OdspDriver",properties:{all:{driverVersion:f.z}}});function T(e,t,r,n){return async function(i,s){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.Bt.timedExecAsync(e,{eventName:"".concat(s,"_GetToken"),attempts:i.refresh?2:1,hasClaims:!!i.claims,hasTenantId:!!i.tenantId},(async e=>r({...i,...t}).then((t=>{const r=u(t);if((l||e.duration>=32)&&e.end({fromCache:h(t),isNull:null===r}),null===r&&n)throw new o.OI("The Host-provided token fetcher returned null",d.P.fetchTokenError,{method:s,driverVersion:f.z});return r}),(e=>{const t=null===e||void 0===e?void 0:e.canRetry;throw(0,c.J4)(e,(e=>new o.Tj("The Host-provided token fetcher threw an error",d.P.fetchTokenError,"boolean"===typeof t&&t,{method:s,errorMessage:e,driverVersion:f.z})))}))),{cancel:"generic"})}}function I(e){var t;return{type:g.o,key:null!==(t=e.fileVersion)&&void 0!==t?t:"",file:{resolvedUrl:e,docId:e.hashedDocumentId}}}const N=79872;function F(e){if(!e)return;const t=e.scope;if(!t)return"createLinkType=".concat(e);let r="createLinkScope=".concat(t);const n=e.role;return r=n?"".concat(r,"&createLinkRole=").concat(n):r,r}function D(e){const t=i.F.now();return[e(),i.F.now()-t]}async function O(e){const t=i.F.now();return[await e(),i.F.now()-t]}function B(e){return"".concat(e.hashedDocumentId,"/joinsession")}},53727:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});const n="2.0.0-rc.1.0.8"},9690:(e,t,r)=>{"use strict";r.d(t,{M:()=>c});var n=r(21605),o=r(30667),i=r(19307),s=r(69953),a=r(45792);async function c(e,t,r,c){let l=1e3;const d=n.F.now();let u;for(let p=1;;p++){void 0!==c&&c();try{const o=await e();return p>1&&r.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:p,duration:n.F.now()-d},u),o}catch(g){var h;const e=(0,i.YU)(g),c=!0===(null===g||void 0===g?void 0:g[a.Cj]),m=(null===g||void 0===g?void 0:g.errorType)===s.P.serviceReadOnly;if(1===p&&r.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),callName:t,attempts:p,duration:n.F.now()-d},g),!c&&!m||!e)throw g;if(5===p)throw r.sendErrorEvent({eventName:c?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:p,duration:n.F.now()-d},g),g.canRetry=!1,g;l=null!==(h=(0,i.E9)(g))&&void 0!==h?h:l,await(0,o.c)(Math.floor(l)),l+=l/4*(1+Math.random()),u=g}}}},6326:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>L,__assign:()=>i,__asyncDelegator:()=>E,__asyncGenerator:()=>P,__asyncValues:()=>T,__await:()=>w,__awaiter:()=>p,__classPrivateFieldGet:()=>O,__classPrivateFieldIn:()=>x,__classPrivateFieldSet:()=>B,__createBinding:()=>f,__decorate:()=>a,__disposeResources:()=>R,__esDecorate:()=>l,__exportStar:()=>v,__extends:()=>o,__generator:()=>m,__importDefault:()=>D,__importStar:()=>F,__makeTemplateObject:()=>I,__metadata:()=>g,__param:()=>c,__propKey:()=>u,__read:()=>b,__rest:()=>s,__runInitializers:()=>d,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>k,__spreadArrays:()=>C,__values:()=>y,default:()=>M});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,o,i){function s(e){if(void 0!==e&&"function"!==typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?n.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),h=!1,g=r.length-1;g>=0;g--){var p={};for(var m in n)p[m]="access"===m?{}:n[m];for(var m in n.access)p.access[m]=n.access[m];p.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var f=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[l],p);if("accessor"===c){if(void 0===f)continue;if(null===f||"object"!==typeof f)throw new TypeError("Object expected");(a=s(f.get))&&(u.get=a),(a=s(f.set))&&(u.set=a),(a=s(f.init))&&o.unshift(a)}else(a=s(f))&&("field"===c?o.unshift(a):u[l]=a)}d&&Object.defineProperty(d,n.name,u),h=!0}function d(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function u(e){return"symbol"===typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"===typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function m(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function y(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function k(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,l):d(i[0][2],r)}catch(n){d(i[0][3],n)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function d(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function E(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:!1}:o?o(t):t}:o}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function D(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function B(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function x(e,t){if(null===t||"object"!==typeof t&&"function"!==typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"===typeof e?t===e:e.has(t)}function L(e,t,r){if(null!==t&&void 0!==t){if("object"!==typeof t&&"function"!==typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!==typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var A="function"===typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function R(e){function t(t){e.error=e.hasError?new A(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(i){t(i)}}if(e.hasError)throw e.error}()}const M={__extends:o,__assign:i,__rest:s,__decorate:a,__param:c,__metadata:g,__awaiter:p,__generator:m,__createBinding:f,__exportStar:v,__values:y,__read:b,__spread:S,__spreadArrays:C,__spreadArray:k,__await:w,__asyncGenerator:P,__asyncDelegator:E,__asyncValues:T,__makeTemplateObject:I,__importStar:F,__importDefault:D,__classPrivateFieldGet:O,__classPrivateFieldSet:B,__classPrivateFieldIn:x,__addDisposableResource:L,__disposeResources:R}},16281:e=>{"use strict";e.exports=JSON.parse('{"ControlClickToFollowLink":"Ctrl+Click to follow link","GettingThisReady":"Getting this ready...","NewLoopComponentFileName":"Loop component","CalloutTitle":"This is a Loop component","CalloutDescription":"You can edit this directly without sending a reply, and everyone will see changes in real time.","GotIt":"Got it","CustomPermissionsPanelPeopleOutsideWithLinkText_Default":"People outside this message with the link have access","CustomPermissionsPanelSpecificPermissionText_Default":"People in this message have access","CustomPermissionsPanelPeopleOutsideText_Default":"People outside this message have access","CustomPermissionsPanelSomePeopleText_Default":"Some people in this message have access","CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSpecificPermissionText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelPeopleOutsideText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSomePeopleText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document."}')}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,r.F={},r.E=e=>{Object.keys(r.F).map((t=>{r.F[t](e)}))},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&o&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,r.d(i,s),i}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+({170:"InformationProtectionStrings82",361:"shareServiceStrings6",372:"genericLinkStrings84",467:"genericLinkStrings61",470:"genericLinkStrings37",522:"shareServiceStrings36",620:"shareServiceStrings81",849:"cardloopstrings-prs",1214:"InformationProtectionStrings28",1261:"VideoPlaybackStrings59",1303:"graphapi",1369:"cardloopstrings-fr-ca",1734:"InformationProtectionStrings15",2118:"InformationProtectionStrings64",2165:"cardloopstrings-tk-tm",2246:"notificationac",2440:"fluidHost-odsp",2489:"cardloopstrings-da",2544:"shareServiceStrings70",2690:"el-plex-strings-json",2892:"InformationProtectionStrings40",3150:"graphservice",3181:"shareServiceStrings2",3196:"cardloopstrings-gu",3280:"videoPlaybackComponent",3304:"genericLinkStrings0",3349:"genericLinkStrings23",3367:"viewtransformsac",3401:"hostUxStrings45",3459:"shareServiceStrings42",3642:"usermodule",3678:"VideoPlaybackStrings52",3900:"hostUxStrings4",4062:"VideoPlaybackStrings85",4256:"genericLinkStrings31",4316:"hostUxStrings71",4440:"ar-plex-strings-json",4524:"MTSFoundInPlaces",4554:"InformationProtectionStrings19",4692:"cardloopstrings-zh-hant",4856:"driveitemmodule",4938:"InformationProtectionStrings68",5220:"activityac",5309:"cardloopstrings-de",5364:"shareServiceStrings74",5520:"InformationProtectionStrings13",5828:"unifiedgroupmodule",5851:"diffsyncmodule",6279:"shareServiceStrings46",6363:"addformrequirementdialog",6373:"InformationProtectionStrings85",6667:"hostUxStrings54",6689:"genericLinkStrings12",6725:"shareServiceStrings31",6747:"fluid-debugger",6830:"genericLinkStrings64",7058:"cardloopstrings-ko",7076:"genericLinkStrings35",7135:"genericLinkStrings29",7159:"cardloopstrings-az-latn-az",7464:"VideoPlaybackStrings54",8010:"permissionmodule",8081:"lb-lu-plex-strings-json",8340:"InformationProtectionStrings17",8446:"VideoPlaybackStrings38",8500:"sr-latn-rs-plex-strings-json",8857:"InformationProtectionStrings38",8947:"cardloopstrings-ja",8996:"qps-ploc-plex-strings-json",9350:"VideoPlaybackStrings74",9444:"shareCallout",9496:"settingsac",9507:"genericLinkStrings3",9770:"userac",10041:"bucketmodule",10065:"shareServiceStrings40",10119:"nb-no-plex-strings-json",10135:"richtexteditorribbon",10301:"quz-pe-plex-strings-json",10361:"genericLinkStrings81",10475:"genericLinkStrings18",10506:"hostUxStrings2",10538:"PlannerComponent",10616:"genericLinkStrings62",10720:"gateddirectoryservice",10922:"hostUxStrings77",11348:"cardloopstrings-sq",11567:"shareServiceStrings77",11966:"hostUxStrings15",12870:"hostUxStrings51",12892:"genericLinkStrings17",13170:"shareServiceStrings5",13181:"genericLinkStrings85",13276:"genericLinkStrings66",13279:"genericLinkStrings36",13311:"kk-plex-strings-json",13499:"InformationProtectionStrings76",13667:"VideoPlaybackStrings57",14044:"he-plex-strings-json",14094:"InformationProtectionStrings37",14543:"InformationProtectionStrings14",14664:"telemetrymodule",14708:"hostUxStrings79",14782:"pt-pt-plex-strings-json",15228:"cardloopstrings-lt",15286:"shareServiceStrings29",15353:"shareServiceStrings71",15434:"et-plex-strings-json",15456:"containermodule",15596:"odspservice",15700:"af-plex-strings-json",15732:"cardloopstrings-tt",15797:"sr-cyrl-ba-plex-strings-json",16113:"cardloopstrings-pt-pt",16158:"genericLinkStrings20",16210:"hostUxStrings46",16268:"shareServiceStrings45",16487:"VideoPlaybackStrings53",16709:"hostUxStrings5",16770:"cardloopstrings-en-us",17065:"genericLinkStrings30",17125:"hostUxStrings70",17296:"cardloopstrings-mk",17551:"cardloopstrings-sr",17620:"card-loop",17880:"InformationProtectionStrings31",18106:"shareServiceStrings25",18329:"InformationProtectionStrings12",18407:"shareServiceStrings8",18510:"linksmodule",18848:"bs-latn-ba-plex-strings-json",19411:"gatedtsapi",19498:"genericLinkStrings11",19499:"VideoPlaybackStrings71",19632:"VideoPlaybackStrings29",19639:"genericLinkStrings65",19702:"InformationProtectionStrings73",19779:"fluidHost-videoLoop",19867:"cardloopstrings-kn",19885:"genericLinkStrings34",20273:"VideoPlaybackStrings55",20731:"VideoPlaybackStrings66",21063:"cardloopstrings-el",21149:"InformationProtectionStrings16",21211:"nl-plex-strings-json",21910:"az-latn-az-plex-strings-json",22284:"cardloopstrings-ka",22316:"genericLinkStrings4",22573:"hostUxStrings41",22874:"shareServiceStrings43",22968:"InformationProtectionStrings80",23170:"genericLinkStrings82",23394:"shareServiceStrings54",23398:"cardloopstrings-eu",23425:"genericLinkStrings63",23488:"InformationProtectionStrings75",23840:"shareServiceStrings49",23852:"bg-plex-strings-json",23945:"genericLinkStrings56",24083:"InformationProtectionStrings32",24251:"hostUxStrings69",24309:"shareServiceStrings22",24376:"shareServiceStrings78",24677:"cardloopstrings-ro",24888:"cardloopstrings-as-in",24901:"loopappdialogs",25072:"VideoPlaybackStrings1",25115:"VideoPlaybackStrings13",25145:"cardloopstrings-bs-latn-ba",25253:"editformdialog",25416:"pa-plex-strings-json",25701:"genericLinkStrings16",25785:"bucketac",25914:"planmodule",25921:"InformationProtectionStrings56",25979:"shareServiceStrings4",26047:"zh-cn-plex-strings-json",26070:"cardloopstrings-kk",26088:"genericLinkStrings39",26308:"InformationProtectionStrings71",26319:"cardloopstrings-ml",26476:"VideoPlaybackStrings50",26584:"hi-plex-strings-json",26765:"genericLinkStrings52",26850:"cardloopstrings-sr-cyrl",26853:"playbackStateHandler",26873:"officeFluidOneDsSink",26903:"InformationProtectionStrings36",26934:"VideoPlaybackStrings63",27211:"genericLinkStrings69",27517:"hostUxStrings78",27717:"gu-plex-strings-json",27837:"th-plex-strings-json",27861:"pl-plex-strings-json",27892:"VideoPlaybackStrings5",28095:"shareServiceStrings28",28162:"shareServiceStrings72",28391:"card-loop-jitcardview",28522:"VideoPlaybackStrings78",28573:"campaignmodule",28679:"genericLinkStrings7",28688:"InformationProtectionStrings0",28725:"InformationProtectionStrings78",29077:"shareServiceStrings44",29171:"InformationProtectionStrings83",29246:"cardloopstrings-si-lk",29655:"cardloopstrings-mn-mn",29874:"genericLinkStrings33",29888:"genericLinkStrings8",29934:"hostUxStrings73",30138:"intelligenceac",30633:"cardloopstrings-no",30689:"InformationProtectionStrings30",30699:"cardloopstrings-mt-mt",30703:"cardloopstrings-fa",30720:"VideoPlaybackStrings65",30813:"es-mx-plex-strings-json",31022:"cardloopstrings-ne-np",31209:"InformationProtectionStrings27",31318:"VideoPlaybackStrings16",31436:"hostUxStrings48",31487:"cs-plex-strings-json",31508:"InformationProtectionStrings4",31591:"bn-in-plex-strings-json",31902:"or-in-plex-strings-json",32124:"InformationProtectionStrings53",32175:"hostUxStrings29",32182:"shareServiceStrings1",32441:"VideoPlaybackStrings28",32465:"genericLinkStrings1",32511:"InformationProtectionStrings72",32815:"cardloopstrings-ga-ie",33019:"hostUxStrings83",33201:"directoryservice",33274:"hostUxStrings60",33321:"shareServiceStrings13",33477:"ca-plex-strings-json",33540:"VideoPlaybackStrings61",33555:"InformationProtectionStrings18",33720:"hostUxStrings75",33884:"SharepointNotificationService",34095:"VideoPlaybackStrings6",34525:"shareServiceStrings75",34624:"ga-ie-plex-strings-json",34905:"ug-plex-strings-json",35104:"VideoPlaybackStrings10",35125:"genericLinkStrings5",35222:"hostUxStrings42",35910:"InformationProtectionStrings59",35940:"cardloopstrings-fr",35957:"VideoPlaybackStrings68",35968:"shareServiceStrings7",35979:"genericLinkStrings83",36074:"sv-plex-strings-json",36079:"tr-plex-strings-json",36203:"shareServiceStrings55",36234:"genericLinkStrings60",36297:"InformationProtectionStrings74",36754:"genericLinkStrings55",36818:"tasksbyplanviewac",36892:"InformationProtectionStrings35",37118:"shareServiceStrings21",37161:"cardloopstrings-ta",37185:"shareServiceStrings79",37308:"taskmodule",37466:"genericLinkStrings77",37580:"cardloopstrings-cy",37678:"VideoPlaybackStrings27",37711:"InformationProtectionStrings7",37837:"cardloopstrings-gl",37881:"VideoPlaybackStrings0",37924:"VideoPlaybackStrings14",38014:"cardloopstrings-sk",38354:"cardloopstrings-am",38510:"genericLinkStrings15",38730:"InformationProtectionStrings55",38788:"shareServiceStrings3",38856:"sl-plex-strings-json",38897:"genericLinkStrings38",39008:"hostUxStrings44",39117:"InformationProtectionStrings70",39477:"hostUxStrings67",39479:"fil-ph-plex-strings-json",39743:"VideoPlaybackStrings62",39862:"id-plex-strings-json",39903:"cardloopstrings-ru",39923:"hostUxStrings76",39981:"cardloopstrings-te",40044:"card-loop-herocardview",40362:"intelligencemodule",40513:"tsgraphodataapi",40701:"VideoPlaybackStrings4",40904:"shareServiceStrings27",40971:"shareServiceStrings73",41198:"hostUxStrings20",41252:"genericLinkStrings79",41366:"cardloopstrings-cs",41380:"taskac",41464:"VideoPlaybackStrings21",41497:"InformationProtectionStrings1",41886:"shareServiceStrings47",41991:"genericLinkStrings58",42038:"PlannerLinkComponent",42067:"formresponseviewdialog",42296:"genericLinkStrings13",42406:"shareServiceStrings50",42437:"genericLinkStrings67",42503:"LazyPermissionsPopoverTrigger1",42743:"hostUxStrings72",42906:"cardloopstrings-lb-lu",42966:"LazyFluidMessageBannerStack",42967:"gatedconversationsservice",43008:"hostUxStrings80",43442:"cardloopstrings-nl",43529:"VideoPlaybackStrings64",43669:"genericLinkStrings70",44127:"VideoPlaybackStrings17",44245:"hostUxStrings49",44285:"ms-plex-strings-json",44317:"InformationProtectionStrings5",44729:"tt-plex-strings-json",44874:"gatedgraphapi",44933:"InformationProtectionStrings52",44984:"hostUxStrings26",44991:"shareServiceStrings0",45274:"genericLinkStrings2",45371:"hostUxStrings47",45479:"cardloopstrings-zu-za",45590:"LazyLastEdited",45828:"hostUxStrings84",46075:"diffsyncac",46130:"shareServiceStrings10",46184:"cardloopstrings-th",46192:"shareServiceStrings56",46349:"VideoPlaybackStrings60",46904:"VideoPlaybackStrings9",47107:"shareServiceStrings24",47174:"shareServiceStrings76",47534:"fa-plex-strings-json",47550:"uz-latn-uz-plex-strings-json",47665:"qps-ploca-plex-strings-json",47667:"VideoPlaybackStrings22",47701:"cardloopstrings-kok",47913:"VideoPlaybackStrings11",47934:"genericLinkStrings6",48031:"hostUxStrings43",48499:"genericLinkStrings10",48547:"shareServiceStrings19",48719:"InformationProtectionStrings58",48867:"ko-plex-strings-json",49012:"shareServiceStrings52",49106:"InformationProtectionStrings77",49505:"VideoPlaybackStrings46",49563:"genericLinkStrings54",49701:"InformationProtectionStrings34",49927:"shareServiceStrings20",50177:"lt-plex-strings-json",50381:"InformationProtectionStrings23",50487:"VideoPlaybackStrings26",50520:"InformationProtectionStrings8",50568:"cardloopstrings-ms",50690:"VideoPlaybackStrings3",50924:"fluidHost-cardLoop",50932:"mr-plex-strings-json",51187:"hostUxStrings25",51306:"planac",51319:"genericLinkStrings14",51540:"cardloopstrings-nn-no",52253:"fr-plex-strings-json",52286:"hostUxStrings64",52487:"gatedplannerservice",52492:"LazyPermissionsPopoverTrigger2",52493:"shareServiceStrings17",52535:"cardloopstrings-fi",52536:"cardloopstrings-uk",53131:"cardloopstrings-it",53408:"te-plex-strings-json",53713:"shareServiceStrings26",54007:"hostUxStrings21",54014:"shareServiceStrings9",54061:"genericLinkStrings78",54273:"VideoPlaybackStrings20",54306:"InformationProtectionStrings2",54609:"cardloopstrings-sl",54793:"VideoPlaybackStrings37",54816:"cardloopstrings-sd-arab-pk",54853:"sq-plex-strings-json",54914:"hostUxStrings33",54949:"cardloopstrings-ar",54953:"cardloopstrings-ur",55215:"shareServiceStrings51",55547:"lv-plex-strings-json",55708:"VideoPlaybackStrings43",55766:"genericLinkStrings51",55807:"km-kh-plex-strings-json",55817:"hostUxStrings81",55892:"shareServiceStrings38",56012:"ur-plex-strings-json",56072:"hostUxStrings62",56176:"de-plex-strings-json",56186:"kn-plex-strings-json",56338:"VideoPlaybackStrings67",56458:"userplansretrievalac",56478:"genericLinkStrings73",56936:"VideoPlaybackStrings18",57488:"InformationProtectionStrings62",57605:"es-plex-strings-json",57613:"VideoPlaybackStrings33",57742:"InformationProtectionStrings51",57793:"hostUxStrings27",58180:"hostUxStrings40",58555:"shareServiceStrings60",58637:"hostUxStrings85",59001:"shareServiceStrings57",59007:"sr-cyrl-rs-plex-strings-json",59062:"card-loop-adaptivecardview",59106:"genericLinkStrings46",59432:"VideoPlaybackStrings83",59494:"VideoPlaybackStrings49",59552:"genericLinkStrings57",59713:"VideoPlaybackStrings8",59805:"cy-gb-plex-strings-json",59850:"InformationProtectionStrings33",59858:"hostUxStrings68",59885:"uk-plex-strings-json",59916:"shareServiceStrings23",59941:"AshaUtils",60250:"lo-plex-strings-json",60264:"genericLinkStrings75",60308:"InformationProtectionStrings66",60370:"InformationProtectionStrings24",60476:"VideoPlaybackStrings25",60722:"VideoPlaybackStrings12",61082:"InformationProtectionStrings46",61528:"InformationProtectionStrings57",61578:"ml-plex-strings-json",61821:"shareServiceStrings53",62087:"cardloopstrings-vi",62275:"hostUxStrings61",62314:"VideoPlaybackStrings45",62364:"da-plex-strings-json",62372:"genericLinkStrings53",62530:"card-loop-signincardview",62603:"cardloopstrings-or",62672:"requirementssection",63030:"InformationProtectionStrings20",63056:"hostUxStrings8",63329:"InformationProtectionStrings9",63377:"cardloopstrings-mr",63499:"VideoPlaybackStrings2",63605:"qps-plocm-plex-strings-json",63729:"cardloopstrings-af",63874:"plannerservice",63937:"hostUxStrings38",63996:"hostUxStrings22",64238:"shareServiceStrings58",64332:"InformationProtectionStrings79",64571:"cardloopstrings-id",64720:"VideoPlaybackStrings72",64758:"shareServiceStrings65",64868:"InformationProtectionStrings48",64969:"ne-np-plex-strings-json",65013:"shareServiceStrings80",65095:"hostUxStrings65",65142:"shareServiceStrings14",65354:"SharepointInformationProtectionService",65607:"InformationProtectionStrings29",65635:"VideoPlaybackStrings80",65940:"cardloopstrings-is",66147:"nn-no-plex-strings-json",66467:"genericLinkStrings76",66511:"InformationProtectionStrings65",66676:"gl-plex-strings-json",66816:"InformationProtectionStrings26",67082:"VideoPlaybackStrings23",67085:"VideoPlaybackStrings15",67115:"InformationProtectionStrings3",67285:"InformationProtectionStrings41",67336:"hostUxStrings13",67578:"shareServiceStrings69",67602:"VideoPlaybackStrings34",67723:"hostUxStrings32",67731:"InformationProtectionStrings54",67782:"hostUxStrings28",67846:"it-plex-strings-json",67910:"removeformconfirmationdialog",68054:"ca-es-valencia-plex-strings-json",68240:"hostUxStrings57",68455:"VideoPlaybackStrings84",68517:"VideoPlaybackStrings42",68544:"shareServiceStrings63",68575:"genericLinkStrings50",68626:"hostUxStrings82",68701:"shareServiceStrings39",68881:"hostUxStrings63",68928:"shareServiceStrings12",68983:"cardloopstrings-ha-latn-ng",69018:"diffsyncstateac",69287:"genericLinkStrings72",69356:"hu-plex-strings-json",69427:"eu-plex-strings-json",69702:"VideoPlaybackStrings7",69745:"VideoPlaybackStrings19",69769:"cardloopstrings-fil",69807:"zh-tw-plex-strings-json",70176:"cardloopstrings-pl",70297:"InformationProtectionStrings63",70463:"cardloopstrings-mi-nz",70506:"kok-plex-strings-json",70536:"cardloopstrings-bn-in",70551:"InformationProtectionStrings50",70602:"hostUxStrings24",71060:"hostUxStrings53",71118:"shareServiceStrings32",71122:"hostUxStrings19",71364:"shareServiceStrings67",71398:"conversationsservice",71528:"genericLinkStrings26",71564:"VideoPlaybackStrings69",71915:"genericLinkStrings47",72241:"VideoPlaybackStrings82",72303:"VideoPlaybackStrings48",72820:"cardloopstrings-ky",72839:"VideoPlaybackStrings39",73073:"genericLinkStrings74",73117:"InformationProtectionStrings67",73179:"InformationProtectionStrings25",73244:"cardloopstrings-km-kh",73285:"VideoPlaybackStrings24",73318:"InformationProtectionStrings6",73539:"hostUxStrings10",73580:"SharepointShareService",73743:"VideoPlaybackStrings75",73851:"uilayoutac",73926:"hostUxStrings37",74332:"genericLinkStrings48",74874:"augloopapi",74904:"shareServiceStrings34",75084:"hostUxStrings66",75107:"hr-plex-strings-json",75175:"cardloopstrings-bn-bd",75291:"shareServiceStrings11",75865:"hostUxStrings9",75990:"formrequirementiframedialog",76359:"hostUxStrings14",76785:"cardloopstrings-uz",76794:"en-gb-plex-strings-json",76805:"hostUxStrings23",76881:"cardloopstrings-en-gb",76902:"notificationmodule",77047:"shareServiceStrings59",77091:"cardloopstrings-ca-es-valencia",77263:"hostUxStrings50",77529:"VideoPlaybackStrings73",77548:"gd-plex-strings-json",77567:"shareServiceStrings64",77598:"genericLinkStrings59",77677:"InformationProtectionStrings49",77712:"hostUxStrings31",77731:"genericLinkStrings25",77738:"card-loop-thumbnailcardview",77822:"shareServiceStrings83",77878:"ru-plex-strings-json",77951:"shareServiceStrings15",78118:"genericLinkStrings42",78622:"linksac",78768:"cardloopstrings-es",79094:"vi-plex-strings-json",79190:"cardloopstrings-es-mx",79269:"cardloopstrings-hi",79276:"genericLinkStrings71",80094:"InformationProtectionStrings42",80145:"hostUxStrings12",80411:"VideoPlaybackStrings35",80532:"hostUxStrings35",80551:"genericLinkStrings21",80568:"cardloopstrings-pt",80720:"mi-nz-plex-strings-json",80819:"dialogac",81049:"hostUxStrings56",81102:"hostUxStrings6",81107:"shareServiceStrings37",81200:"genericLinkStrings80",81326:"VideoPlaybackStrings41",81353:"shareServiceStrings62",81514:"approvalrequestsection",81608:"shareServiceStrings85",81686:"cardloopstrings-hr",81802:"fr-ca-plex-strings-json",81904:"genericLinkStrings44",82368:"StreamEmbeddedRenderer",82689:"card-loop-o365connectorscardview",82707:"reactplayer",82722:"InformationProtectionStrings11",83069:"notificationbar",83106:"InformationProtectionStrings60",83479:"tenantmodule",83869:"hostUxStrings52",83880:"InformationProtectionStrings44",83892:"VideoPlaybackStrings76",83927:"shareServiceStrings33",83931:"hostUxStrings18",83998:"cardloopstrings-ug-cn",84006:"fi-plex-strings-json",84035:"cardloopstrings-pa-in",84173:"shareServiceStrings66",84314:"shareServiceStrings18",84337:"genericLinkStrings27",84465:"formattachmentslist",84666:"VideoPlaybackStrings56",84724:"genericLinkStrings40",84888:"hostUxStrings0",85050:"VideoPlaybackStrings81",85112:"VideoPlaybackStrings47",85164:"ta-plex-strings-json",85411:"as-in-plex-strings-json",85523:"InformationProtectionStrings69",85730:"cardloopstrings-sw",85988:"InformationProtectionStrings22",86286:"hostUxStrings59",86348:"hostUxStrings17",86614:"VideoPlaybackStrings30",86735:"hostUxStrings36",86841:"cardloopstrings-he",87141:"genericLinkStrings49",87292:"cardloopstrings-quz-pe",87361:"InformationProtectionStrings81",87397:"mk-plex-strings-json",87713:"shareServiceStrings35",87791:"cardloopstrings-et",87986:"ja-plex-strings-json",88100:"shareServiceStrings16",88116:"cardloopstrings-ca",88233:"shareServiceStrings48",88452:"VideoPlaybackStrings58",88689:"cardloopstrings-gd-gb",89088:"mt-mt-plex-strings-json",90055:"WSETFoundInPlaces",90083:"InformationProtectionStrings47",90114:"cardloopstrings-tr",90296:"cardloopstrings-sr-cyrl-ba",90338:"VideoPlaybackStrings70",90400:"VideoPlaybackStrings36",90422:"pt-br-plex-strings-json",90447:"cardloopstrings-be-by",90521:"hostUxStrings30",90540:"genericLinkStrings22",90631:"shareServiceStrings82",90709:"cardloopstrings-hy",90791:"sk-plex-strings-json",90869:"VideoPlaybackStrings51",90927:"genericLinkStrings43",91091:"hostUxStrings3",91315:"VideoPlaybackStrings44",91883:"cardloopstrings-zh-hans",91955:"gatedtenantservice",92191:"InformationProtectionStrings21",92345:"is-plex-strings-json",92430:"cardloopstrings-lv",92755:"VideoPlaybackStrings79",92796:"unifiedgroupac",92903:"InformationProtectionStrings43",92954:"hostUxStrings11",92957:"ka-plex-strings-json",93220:"VideoPlaybackStrings32",93341:"hostUxStrings34",93564:"InformationProtectionStrings84",93818:"plantaskboardpage",93858:"hostUxStrings55",93911:"hostUxStrings7",93916:"shareServiceStrings30",94084:"ro-plex-strings-json",94135:"VideoPlaybackStrings40",94162:"shareServiceStrings61",94258:"appLazy",94267:"genericLinkStrings32",94281:"genericLinkStrings9",94326:"genericLinkStrings28",94417:"shareServiceStrings84",94573:"cardloopstrings-bg",94680:"shareDialog",94713:"genericLinkStrings45",95336:"containerac",95531:"InformationProtectionStrings10",95915:"InformationProtectionStrings61",96048:"InformationProtectionStrings39",96579:"shareServiceStrings68",96689:"InformationProtectionStrings45",96701:"VideoPlaybackStrings77",96924:"tenantservice",97138:"groupdocumentsac",97146:"genericLinkStrings24",97256:"shareServiceStrings41",97533:"genericLinkStrings41",97666:"genericLinkStrings19",97697:"hostUxStrings1",98050:"genericLinkStrings68",98113:"hostUxStrings74",98117:"cardloopstrings-lo-la",98281:"cardloopstrings-hu",98539:"cardloopstrings-sv",98903:"am-et-plex-strings-json",99095:"hostUxStrings58",99157:"hostUxStrings16",99171:"gatedodspservice",99423:"VideoPlaybackStrings31",99544:"hostUxStrings39"}[e]||e)+"."+{170:"0808c3ee",361:"bd14f649",372:"397a76c5",467:"22bf533b",470:"8a014eb3",522:"15eb901d",620:"1e8b21b0",849:"bb5fba5f",1214:"bd23590c",1261:"27a4037a",1303:"b86f27b4",1369:"7845b452",1385:"1c4a11b7",1734:"8e23bf63",2118:"805b1bae",2165:"5644cf14",2246:"f46b005b",2338:"a28d55b2",2440:"ebc8c055",2489:"b5aca897",2544:"89e0c70b",2690:"dcef869f",2892:"1c97e431",3150:"3e47d958",3181:"cc7f50a3",3196:"597743f9",3201:"0fd670b4",3280:"5f522363",3304:"c43e398b",3349:"2d73bc7b",3367:"4fbca9f0",3401:"3631ec03",3459:"e245af43",3642:"d2ee7fb1",3678:"8437b527",3763:"75bf0bed",3900:"14afe8ba",4062:"13d49601",4256:"5fcfc7c2",4316:"2b91c9c5",4440:"f923f8b6",4474:"670c5c78",4524:"ae05646d",4554:"21ce4745",4692:"47c66bdb",4856:"93b2822e",4938:"cc3b51e1",5220:"fa819d2a",5309:"75f759f0",5364:"1fa56eb6",5520:"b8647929",5828:"e0330ea5",5851:"9646b019",5891:"8a530c3e",6279:"29395ade",6307:"ad9a1888",6363:"843255ca",6373:"01a235ea",6471:"a224881a",6667:"90cdb3ae",6689:"6087d928",6725:"1ad10cd4",6747:"b46384d1",6830:"cce64366",7058:"6067ac7d",7076:"b0311407",7135:"a605fe82",7159:"506b6c19",7374:"634c9e51",7464:"657ea2f7",7670:"7430ee32",7911:"c5018052",8010:"39efc0cf",8081:"57750f3b",8340:"cbf98fbd",8393:"706f0f6e",8446:"4018c928",8500:"a9016297",8857:"201cc9a8",8947:"8e18dc17",8996:"8f3c0026",9350:"d105fdf7",9444:"8fe9172c",9496:"26bab638",9507:"362fba53",9770:"f142bbc0",9858:"e0e70eaa",10041:"d697ccd5",10065:"404e3e0a",10119:"3d5b3457",10135:"8722bc8c",10301:"8a9661e2",10361:"c4754ed2",10475:"b2b16796",10506:"e3d144a0",10538:"e1856900",10572:"943d92a4",10616:"d5394cd6",10632:"59cb4825",10672:"8a2d4782",10720:"4c74e747",10922:"35123dc3",10945:"ad22b7ae",11072:"9c7a45c9",11299:"76047172",11348:"ef71f0dd",11354:"2d5d8f4d",11567:"2c10231d",11966:"cd410139",12156:"8aaa1b6f",12481:"bd007956",12870:"cee61acf",12892:"c350578e",13039:"f185fecd",13075:"94076318",13170:"b63c998b",13181:"229eec15",13255:"3bc6efaf",13276:"575797a2",13279:"389697d6",13311:"c57a91df",13499:"97bac5cb",13667:"a0b57585",14044:"749e62ec",14094:"8849583e",14183:"05a2f792",14543:"b3499a14",14618:"1e747e7c",14664:"9c04e5ff",14708:"005ef231",14782:"d1f4ac41",15228:"86d48dca",15286:"a49985dc",15353:"f6853b85",15434:"c9687930",15456:"5f92fab4",15520:"37c6d663",15596:"e53efec2",15700:"8330f030",15732:"3233252e",15797:"770a3f9c",15996:"2acc6c03",16113:"6599fbf6",16158:"8ba70591",16210:"71d3fddb",16268:"e961b765",16487:"ccfbfd5c",16709:"2192c308",16770:"1a56a5ae",17065:"e56e2e83",17122:"eca9470c",17125:"752e35b3",17296:"c797eb8e",17323:"56d1933d",17551:"04a29174",17620:"137e676b",17880:"4f034c50",17925:"2afc0609",18106:"e0925e07",18196:"8b7b3878",18329:"7c77313d",18407:"241aaef3",18510:"e4dab07b",18806:"89881998",18848:"a6deb8df",19347:"477c3d9e",19411:"4ea7dd60",19498:"0f44580b",19499:"de5dcc6c",19632:"9685e3d7",19639:"6948d1c8",19702:"92796130",19779:"ce837713",19867:"0b9555c5",19885:"d805f481",20273:"b95f050f",20559:"63c76e7f",20731:"a993cf3c",21063:"26c8ab99",21149:"5704729d",21211:"2f734ebb",21910:"9a17f6d0",22284:"9961e7a5",22316:"49ddfb97",22362:"e680f6a7",22514:"7b423b7d",22573:"d85c8c03",22874:"62b78c5b",22968:"364e7554",23170:"66374bfd",23329:"fccebb90",23394:"e2f4ca53",23398:"d7e0f2da",23425:"7aaf8389",23488:"801a73f8",23840:"7507e0fe",23852:"5e2304eb",23945:"ecb6a8ec",24083:"05ead416",24251:"16247d7d",24309:"9b4fe0b4",24376:"a346157d",24677:"14893a71",24888:"d6564c61",24901:"0f75aa56",25072:"2c717cf8",25115:"b2e6a691",25145:"c964841d",25253:"df38b6e2",25416:"2f301480",25621:"cefcef82",25701:"6c0661da",25785:"9f697956",25914:"fdb40f81",25921:"4803223d",25979:"ad95f7bd",26047:"5fd58d32",26070:"d7524326",26088:"78fb6521",26308:"a81b29e2",26319:"ae8222de",26476:"affc11e0",26584:"0cf28344",26676:"e53b3576",26748:"3eadfad8",26765:"01b00a1f",26850:"4e08f4c0",26853:"830c2a83",26873:"ab3f763d",26903:"cbc51ae5",26934:"e2fe2be5",27211:"365fe64f",27443:"9b7fbe86",27517:"3b821a4c",27614:"45529b17",27717:"cf099a14",27837:"e7ef1811",27861:"ee0ad9de",27892:"8ebf2cf2",28095:"cfbcbf3d",28162:"3d44635f",28391:"f6ce229e",28522:"3c24a36e",28566:"b8b7f0ec",28573:"d39ac800",28679:"654db585",28688:"1367ed73",28725:"c858c54f",29077:"60cc7d46",29171:"c10f0340",29246:"889daa27",29655:"ba3e45a1",29874:"bee628d5",29888:"38be1336",29934:"2a1c3a40",30138:"ef822cdd",30633:"0d6198ed",30689:"67e7df5b",30699:"7b1428fd",30703:"1fb88ef1",30720:"1e672f69",30813:"c8910c18",31022:"f9196972",31209:"dd59e241",31318:"684cc457",31436:"62a78ab1",31487:"22ef340d",31508:"ccd1eaaa",31591:"ce315d86",31902:"7121a433",32124:"5d7c86b3",32175:"1eb96310",32182:"3e1ceb28",32441:"bb36307f",32465:"d2dd5ff2",32511:"990665ed",32815:"bd7605d2",32870:"d0ccfb84",33019:"b3a94de9",33201:"4c2c02d9",33274:"86b2ee4d",33321:"afb8f669",33477:"18c23d4d",33540:"a2e0bf19",33555:"9c7c2302",33720:"f584b148",33884:"a3001fa8",34095:"0e3be274",34167:"c16266ca",34525:"990f797a",34624:"19515a72",34905:"5ecef4ff",35104:"3943f2c5",35125:"4beea734",35222:"56e9bda6",35910:"bbad0ed9",35940:"bf60698b",35957:"afc243ca",35968:"d925c192",35979:"211cd000",36074:"4149e6fe",36077:"22ba2b3e",36079:"0680c2ec",36203:"6f93107e",36234:"6ac5a287",36297:"a2b6fced",36697:"10b5ed4e",36738:"abbdc747",36754:"c2ffc3b7",36818:"50beef43",36892:"4b62c459",37118:"71d27b52",37161:"0e907d37",37185:"9bcd0160",37308:"81a1e88a",37466:"b1fd3f46",37580:"08dde6a9",37678:"e2d5cf6c",37711:"318e29e8",37801:"837eeebf",37837:"ca94085c",37881:"5a479406",37924:"d25898ed",38014:"44a7ab8c",38328:"f0286e16",38354:"53b4fd14",38428:"4ddfd29b",38510:"ec0775b8",38730:"a969e8d3",38788:"f59a163f",38856:"87cbdd94",38868:"6532317a",38897:"0383b7ac",39008:"8ce66f7d",39117:"1a34a8f8",39477:"075bcee7",39479:"ee18d7db",39743:"711e30e6",39862:"f16befbb",39903:"6e08f3fe",39923:"cf048db3",39981:"29907535",40044:"f4db9209",40135:"84578923",40362:"6c8e3a5d",40513:"170c3b77",40701:"b83300d0",40738:"17f87aad",40904:"04a05af3",40971:"aaf0cc32",41198:"36b12a00",41252:"0fbe0daa",41366:"0c9dd369",41380:"a58e4138",41464:"f469812b",41497:"9235cbdb",41514:"0a1de377",41717:"244066b3",41886:"2ed50bf8",41991:"d062f4c5",42038:"963d9b0d",42067:"28bb6fea",42296:"7264db42",42406:"67501684",42437:"50c8ddbd",42503:"bd0afa2d",42743:"6f03e834",42906:"7997068e",42966:"88c139a3",42967:"9815041a",43008:"afbfc721",43164:"7431e385",43442:"a46c39f7",43529:"fc4bb57a",43669:"00909551",44127:"faf12c2b",44245:"5e4f7b65",44285:"60e53886",44317:"40bd49b0",44729:"60681e3f",44874:"52f351a2",44933:"6b7fad1f",44984:"a6db72e9",44991:"3764b288",45092:"1e7ec207",45274:"3f39ca7c",45371:"d5b59f13",45479:"3fa71c15",45590:"e8d46332",45630:"320d2795",45828:"792c4e02",46075:"91c8703f",46130:"1ffb43c4",46184:"3b344ff8",46192:"1f984dfa",46349:"2e0dcd7a",46904:"c6911f26",46954:"1fbbb7be",47107:"379d7340",47174:"1ca7dbc0",47534:"d4fb6941",47550:"c49cb86a",47665:"45ce3011",47667:"1e5bdb5a",47701:"567d4e0a",47913:"dedaad68",47934:"351e3bf5",48031:"684f316f",48499:"97c5732d",48547:"f35b3c70",48719:"fec640d9",48867:"a1c515a2",49012:"e4725a55",49106:"eec09322",49306:"2978ca33",49505:"0f7442d0",49563:"990f55d8",49701:"7919a0cc",49927:"4b810356",50177:"1d8c1093",50381:"d43c5565",50487:"72835cd5",50520:"482657d8",50568:"78214b30",50690:"32e604b6",50787:"cea03a05",50924:"054ff4f7",50932:"36c3c159",51187:"0e752088",51306:"eff24c75",51319:"e950b7a5",51540:"1afee188",52253:"02ef593e",52286:"ce204d45",52326:"9abac3c2",52487:"74480e1c",52492:"619a9dc1",52493:"80df54ea",52535:"10fa9868",52536:"e0c1c649",53131:"8f73ba0b",53205:"0c60aa73",53408:"7d82d0b9",53713:"d37cb68a",54007:"5e707eeb",54014:"e65474a2",54061:"50560c49",54273:"bec846bb",54306:"7cf8a4cc",54609:"5068f0e0",54793:"009a0496",54816:"7df5196e",54853:"6d38e991",54914:"36dccb8d",54949:"fb61d238",54953:"31b0d7f2",55106:"7289abe2",55215:"e7cd5741",55346:"7fe92281",55547:"24983de7",55708:"027044bf",55766:"16380b2f",55807:"6c787f66",55817:"7881a22c",55874:"051d444e",55892:"cc757e31",55953:"bd869a70",56012:"e0a6f75a",56072:"6c1414ef",56176:"3f54ff20",56186:"5cec11e8",56295:"dc419051",56338:"ef8eb75b",56458:"cdc8ef77",56478:"93585a52",56510:"55b13089",56936:"0592652f",57397:"3f5ce41e",57488:"8c691fe9",57605:"02b0e507",57613:"5f96f0dd",57624:"54e239ec",57742:"f354cfb0",57793:"1e42a91c",57939:"071f975a",57940:"3ce89642",58180:"0f7630b8",58555:"a0959146",58637:"e8c2cd7a",58888:"cc909421",59001:"109d0212",59007:"122c14e9",59062:"99947503",59106:"48f6a6ef",59108:"27a49c7a",59432:"592ea703",59494:"4cf05ccf",59552:"267f488a",59713:"7f57c7f2",59805:"317ec42c",59850:"5223356d",59858:"a4152541",59885:"a776d946",59916:"8e21f086",59941:"ccfc992a",60250:"4fa41515",60264:"74eb9a67",60308:"e1ad4965",60370:"4223a402",60476:"48132a43",60722:"80488990",61082:"07a65647",61374:"e2e7cfed",61528:"6dc3abab",61578:"c59bc0ed",61821:"8fe17647",62087:"b53bb8bf",62200:"b91f8c83",62275:"8414d36f",62314:"e4b95e1c",62364:"7260a07b",62372:"d07aa3f9",62530:"9927b8fe",62603:"bce11960",62672:"87407843",63030:"50664306",63056:"bbb56c97",63329:"b5377f98",63377:"fccf0011",63499:"61dae7d1",63605:"cf6fd6d0",63729:"597c0535",63874:"3527d132",63937:"e52cf02f",63996:"5647586c",64238:"0e146f73",64332:"2b1a4abf",64571:"6c25b729",64720:"1a142c03",64758:"2ead6472",64868:"6b78329f",64969:"ce2160b6",65013:"657c015f",65095:"f8366a6f",65142:"ebc7fcea",65156:"8193351d",65354:"923a60fd",65607:"3f6af780",65635:"100bdcb4",65662:"a89c0cd9",65940:"a5e977af",66147:"cee98181",66467:"fe3ad198",66511:"5787d402",66561:"2e3d8103",66676:"481c2642",66816:"1f8dec25",67082:"c4c1604d",67085:"fd5456f0",67115:"dc51cc1a",67285:"2155db15",67336:"970a6922",67578:"cbb56377",67602:"dc923494",67723:"bea43b1d",67731:"1907aad3",67782:"06d2adfe",67846:"6617eb12",67910:"4cd8d70c",68054:"cabf1090",68240:"f888ca9a",68346:"f5d87e9f",68455:"8d440dab",68517:"5e30fbd2",68544:"62dad94c",68575:"f763254b",68626:"91ee76df",68701:"44f8ea52",68881:"fdc8b657",68928:"58d2972f",68983:"ae29532f",69018:"9973a2a2",69110:"99804902",69225:"fdc7943e",69287:"4f8350e3",69356:"c980d1c7",69427:"19579e71",69698:"e4d3457c",69702:"9598b747",69745:"f2074ade",69769:"5bd3c496",69807:"ff5afb14",69808:"f05841f2",70176:"5be79999",70297:"4a8f88df",70463:"15823995",70506:"0dbafa37",70536:"c499a7ba",70551:"489cd261",70602:"d0866632",71060:"854d733e",71118:"c2291a44",71122:"11ef5286",71364:"cbeff8d9",71398:"428584ba",71528:"01015989",71564:"b5764b39",71915:"f36cfc7d",72241:"a6cdef92",72303:"a9bab307",72423:"dee828b8",72806:"94b14fa1",72820:"e9f135bb",72839:"bcfee8c4",73073:"1f78a31a",73117:"fe800c93",73179:"16d3e9d9",73244:"cf95879d",73285:"a8719ddc",73318:"b9450041",73539:"ef03bc46",73580:"4dc74fd1",73743:"0cded90f",73851:"b6f1bb82",73926:"c9b42ed5",74332:"f086e8f9",74874:"66e050d4",74904:"87cd1f35",75084:"d36cd2ef",75107:"10734290",75175:"86b870f8",75291:"597c5a42",75865:"e64f57da",75990:"f987bd8d",76115:"b1adc339",76128:"884e4c4b",76359:"5a9ffc7f",76785:"85d86f95",76794:"9b83fa78",76805:"8ead8f7c",76881:"546ea526",76902:"7bff6091",77047:"15661a44",77062:"899811db",77091:"622b38e9",77263:"61a34dca",77529:"cf0b7d5d",77548:"b658ddcd",77567:"77bd0bbe",77598:"9ef9bfc6",77677:"6c8f4fb1",77712:"bdfd73cf",77731:"cfb83fca",77738:"2fa8a1d7",77771:"45049d95",77822:"d4ac9ebe",77873:"e48dc7ff",77878:"65e05ff3",77951:"59e787e7",78118:"311acb53",78167:"b339e4d8",78622:"6fc8a334",78768:"0f0f32ec",79094:"7b8c67db",79190:"44be1b2a",79269:"855b24f8",79276:"c0dc370f",79327:"a8f65908",79450:"2e03c09b",80094:"d06514c2",80145:"1668bed4",80411:"9c61918d",80532:"5399fadd",80551:"cf2ebc92",80568:"b0af512b",80720:"f0b2ad23",80819:"120945cb",81049:"45e0c6cf",81102:"2b3de441",81107:"7993c48e",81200:"01372665",81326:"94580831",81353:"c532bb94",81514:"db0a4016",81608:"586ae2ac",81686:"754c0c45",81802:"43f81e91",81904:"5305318a",82075:"fd072fc8",82368:"0249a161",82689:"76793bff",82707:"a7e803cb",82722:"c7526b31",83069:"eb564738",83106:"1f335cde",83479:"0b1a5d80",83869:"caef8f92",83880:"06c6dd72",83892:"b6a11645",83927:"5ce9404d",83931:"86d85c78",83998:"446a8304",84006:"6a1ed941",84035:"2ae2c0ab",84173:"74c8e53a",84314:"acf1d6a9",84337:"1fdef56e",84465:"c9deffdd",84666:"a817baea",84724:"30281c0d",84888:"363751a0",85031:"3a8ba29f",85050:"72282fa3",85112:"a4fd9976",85164:"37972467",85411:"ec3552fc",85523:"5e9f831e",85730:"21634380",85902:"ea19407d",85916:"c5106d1d",85988:"2cf21083",86286:"8533f80e",86348:"e3957720",86614:"68c30fd1",86735:"107e29b0",86841:"65c48b9e",87141:"6224f417",87212:"d08189db",87292:"8dba97a8",87361:"d163a365",87397:"2b33dc89",87713:"6e9cd8e4",87791:"86d33ef0",87986:"fe5a89bb",88100:"e84ee2c0",88116:"a2807d49",88233:"f79e407a",88452:"47570055",88689:"0c1bebe0",88974:"550e5d41",89088:"d035c207",89441:"8e49d376",89520:"9e304611",89559:"47b8396c",90055:"4843e7af",90083:"80d83965",90114:"65a6c34a",90296:"14898b06",90338:"88a05746",90400:"7f849264",90422:"94efa3f3",90447:"e48d9d9a",90521:"4303a099",90540:"4388930d",90631:"a2c4db08",90709:"c037a258",90791:"f40b59d4",90869:"db052bec",90927:"3d12454c",90976:"8bd4236e",91091:"f57a9b3f",91315:"711b1f24",91883:"c89cf5d0",91955:"5dc0f71a",92191:"2624e5bf",92345:"8b17a1d7",92430:"b8f088bf",92755:"e82b9629",92796:"b320b73a",92903:"00a41a62",92954:"9073354e",92957:"fb5c1ba6",92970:"368db3f0",93191:"d0474234",93220:"e5e58243",93341:"ec0690cf",93420:"edc7446e",93564:"7cab79d5",93818:"3bd96e9b",93858:"2e1d04d4",93892:"a66712f2",93911:"708b3b80",93916:"f9325746",94084:"9e004c53",94135:"86a0bea2",94162:"7a613536",94258:"7ddb7995",94267:"c1a4ee55",94281:"6bd2467c",94326:"b1055cd5",94417:"0f68d682",94573:"7e6cff70",94680:"c1358ebd",94713:"17836e3f",94751:"1fa443cd",94885:"bcdb3704",95126:"b3572414",95164:"6f070550",95336:"a65b4656",95531:"d14ce1c6",95915:"aca19920",96048:"e535b4e9",96444:"294ea780",96579:"41de529a",96689:"43f45305",96701:"6fdeb184",96900:"4847f35b",96924:"ecac0a6d",97138:"4e582eb4",97146:"b427c302",97244:"4c797ada",97256:"4309ce40",97533:"357d834f",97666:"efac4242",97697:"5661c6ab",97950:"7568566c",98050:"7496c3c8",98113:"23c5b7d6",98117:"80cfcc91",98256:"0f77e43a",98281:"3534893b",98539:"db52558f",98595:"5df4a41e",98903:"2ce81359",99095:"dc890021",99157:"fea7f8dd",99171:"2d9732ac",99423:"d45e98e2",99544:"80b85e25"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fluidhost:";r.l=(n,o,i,s)=>{if(e[n])e[n].push(o);else{var a,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+i),a.src=n),e[n]=[o];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(g);var o=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="./",(()=>{var e={38792:0};r.f.j=(t,n)=>{var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((r,n)=>o=e[t]=[r,n]));n.push(o[2]=i);var s=r.p+r.u(t),a=new Error;r.l(s,(n=>{if(r.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,o[1](a)}}),"chunk-"+t,t)}},r.F.j=t=>{if(!r.o(e,t)||void 0===e[t]){e[t]=null;var n=document.createElement("link");r.nc&&n.setAttribute("nonce",r.nc),n.rel="prefetch",n.as="script",n.href=r.p+r.u(t),document.head.appendChild(n)}};var t=(t,n)=>{var o,i,s=n[0],a=n[1],c=n[2],l=0;if(s.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(c)c(r)}for(t&&t(n);l<s.length;l++)i=s[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkfluidhost=self.webpackChunkfluidhost||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{var e={73580:[9444,94680]};r.f.prefetch=(t,n)=>Promise.all(n).then((()=>{var n=e[t];Array.isArray(n)&&n.map(r.E)}))})(),(()=>{"use strict";var e=r(73702),t=r(83125),n=r(33788),o=r(85874);var i=r(70202),s=r(3878);async function a(e,r,o,a,c){(async function(e,t){const r=i.Ss.from("".concat(e,"_").concat(t));return encodeURIComponent(await(0,s.D)(r,"SHA-256","base64"))})(o,a).then((i=>{!function(e,r,o){(async(e,r)=>{const i=o?new t.p("InformationProtectionService",o):void 0,s=n.m.start("precacheInformationProtection",i,{addUserTiming:!0,isAPerformanceMetric:!0});try{const t=await e;await Promise.all([t.getIrmInformation(r),t.getWatermarkInformation(r)])}catch{s.setResult(!1)}s.setResult(!0)})(e,r)}(e,{siteUrl:r,driveId:o,itemId:a,odspResolvedUrl:!0,hashedDocumentId:i,type:"fluid",id:"",url:"",tokens:{},endpoints:{snapshotStorageUrl:"",attachmentPOSTStorageUrl:"",attachmentGETStorageUrl:"",deltaStorageUrl:""},fileName:"",summarizer:!1,fileVersion:""},c)})).catch((()=>{}))}var c=r(98581),l=r(31942),d=r(95996),u=r(52841),h=r(93537),g=r(3503),p=r(37805);const m={maxRetries:3,filter:(0,h.sC)([429,500,503]),backoffFn:(0,p.Ed)(500)},f=/.+\S\([^\(\)]+\)$/,v={USNat:"https://config.ecs.teams.eaglex.ic.gov",USSec:"https://config.ecs.teams.microsoft.scloud",DOD:"https://config.ecs.dod.teams.microsoft.us",GCCHigh:"https://config.ecs.gov.teams.microsoft.us",GCC:"https://ecs.office.com",PUBLIC:"https://ecs.office.com"};function y(e){const t=g.f.get(e);if(null!==t&&void 0!==t)return C(t)}function b(e){var t;const r=null===(t=(0,u.A)())||void 0===t?void 0:t.getItem(e);if(null!==r&&void 0!==r)return C(r)}function S(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function C(e){if(null!==e&&void 0!==e){let r;try{r=JSON.parse(e)}catch(t){}const n=void 0!==r?r:e;return"on"===n||"off"===n?"on"===n:n}}class k{get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(){if(this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!S(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const r={};for(let t=0;t<e.guestAgents.length;t+=1){const n=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),o=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));r[n]=r[n]?"".concat(r[n],",").concat(o):o}Object.entries(r).forEach((e=>{let[r,n]=e;t.append("guestAgents","".concat(n,"(").concat(r,")"))}))}Object.entries(e.filters).forEach((e=>{let[r,n]=e;void 0!==n&&t.append(r,n)}));const r=t.toString();return"".concat(e.host,"/config/v1/").concat(e.clientName,"/").concat(e.clientVersion).concat(""!==r?"?".concat(r):"")}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetchAndParse(e),this.ecsResponsePromise.then((e=>{e&&this.cacheEcsResponse(e),this._settingsFetchedFromEcs=!0})).catch((()=>{}))),this.ecsResponsePromise}}getSettingKey(e,t){return"".concat(e,"_").concat(t)}getSetting(e,t,r){return this.getSettingInternal(e,t,r)}async getLiveSetting(e,t,r){return this.getLiveSettingInternal(e,t,r)}getSettingInternal(e,t,r){let n;const o=this.getSettingKey(e,r);return void 0!==(n=this.previouslyAccessedEcsSettings.get(o))||(void 0!==(n=y(e))||void 0!==(n=b(e))||void 0!==(n=this.getSettingFromCachedEcsResponse(e,r))||(n=t),this.previouslyAccessedEcsSettings.set(o,n)),n}async getLiveSettingInternal(e,t,r){var n,o;let i;const s=this.getSettingKey(e,r);if(void 0!==(i=this.previouslyAccessedEcsSettings.get(s)))return i;if(void 0!==(i=y(e))||(i=b(e)),void 0!==i)return this.previouslyAccessedEcsSettings.set(s,i),i;const a=this._settingsFetchedFromEcs?null===(n=this.getAllCachedEcsResponses())||void 0===n?void 0:n[this.ecsClientConfiguration.cacheKey]:await this.fetch();return void 0!==(i=null===a||void 0===a||null===(o=a.ecsTeamsSettings[r])||void 0===o?void 0:o[e])||(i=t),this.previouslyAccessedEcsSettings.set(s,i),i}getSettingFromCachedEcsResponse(e,t){var r;return(null===(r=this.ecsResponseFromCache)||void 0===r?void 0:r.ecsTeamsSettings[t])&&this.ecsResponseFromCache.ecsTeamsSettings[t][e]}async fetchAndParse(e){const t=n.m.start("EcsFetch",this.logger,{addUserTiming:!0});let r;try{r=await(0,h.J5)(e,void 0,m)}catch(i){return void t.setResult(!1,{},i)}if(200!==r.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:r.result.status,statusText:r.result.statusText},e)}const o=this.parseResponseToEcsResponse(r);return o.then((r=>{let n;performance.getEntriesByName(e).map((e=>{e.name.includes(this.ecsClientConfiguration.host)&&(n=e.duration)})),t.setResult(!0,{eTag:r.eTag,networkDurationMs:n,configIds:JSON.stringify(r.configIDs)})})).catch((e=>{t.setResult(!1,{},e)})),o}async parseResponseToEcsResponse(e){var t;const r=await e.result.json(),n=[...this.ecsClientConfiguration.teamNames],o={};null===(t=this.ecsClientConfiguration.guestAgents)||void 0===t||t.forEach((e=>{if(f.test(e)){const t=e.substring(0,e.indexOf("("));n.push(t)}else this.logger&&(0,d.hO)(this.logger,{eventName:"ecsTeamFormat"},new Error("".concat(e," doesn't match the format <EcsTeam>(<EcsClient>)")))}));for(let c=0;c<n.length;c+=1)r[n[c]]&&(o[n[c]]=r[n[c]]);const i=e.result.headers.get("ETag")||"",s=r.ConfigIDs||{};let a;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)a=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");a=t?new Date(t):void 0}return{ecsTeamsSettings:o,eTag:i,configIDs:s,expires:a,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=(0,u.A)();if(t)try{const r=this.getAllCachedEcsResponses()||{};r[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(r){this.logger&&(0,d.hO)(this.logger,{eventName:"cacheEcsResponse"},r)}}getAllCachedEcsResponses(){try{const e=(0,u.A)(),t=null===e||void 0===e?void 0:e.getItem(this.ecsClientConfiguration.responsesCacheKey),r=t&&JSON.parse(t);if(!r||0===Object.keys(r).length)return;return Object.entries(r).forEach((e=>{let[t,r]=e;"string"===typeof r.expires&&(r.expires=new Date(r.expires))})),r}catch(e){this.logger&&(0,d.hO)(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t,this.logger&&(0,d.Ot)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)})),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=(0,u.A)();if(!t)return;const r={};Object.entries(e).forEach((e=>{let[t,n]=e;(S(n)||t===this.ecsClientConfiguration.cacheKey)&&(r[t]=n)})),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(t){this.logger&&(0,d.hO)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},t)}}constructor(e,r){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this.logger=r&&new t.p("EcsClient",r),this.loadAndClearCache()}}function w(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":case"Dogfood":case"Preview":case"Microsoft":case"Production":return v.PUBLIC;case"GCC":return v.GCC;case"GCC-High":return v.GCCHigh;case"DoD":return v.DOD;case"USNat":return v.USNat;case"USSec":return v.USSec;default:throw new Error("Unexpected audience value provided")}}class P{get SettingsProvider(){return this}get settingsFetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,r){return this.ecsClient.getSetting(e,t,r)}async getLiveSetting(e,t,r){return this.ecsClient.getLiveSetting(e,t,r)}constructor(e,t){this.ecsClient=new k(function(e){var t,r;const{ecsFilters:n,hostName:o,sessionId:i,responsesCacheKeyOverride:s,cacheExpiresDurationOverrideInMin:a,fetchFluidExperiencesSettings:c=!0,fetchHostExperiencesSettings:l=!0,fetchSegmentationSettings:d=!0,alwaysFetchNewSettings:u}=e,{userContext:h,audience:g}=n,p=null===(t=h.user)||void 0===t?void 0:t.id,m={audience:g,userId:p,tenantId:null===(r=h.user)||void 0===r?void 0:r.tenantId,hostName:o},f="".concat(p).concat(o).concat(g),v=s||"FluidEcsClientResponses",y=[];return c&&y.push("FluidExperiences"),l&&y.push("HostExperiences"),d&&y.push("Segmentation"),{host:w(g),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:y,filters:m,cacheKey:f,responsesCacheKey:v,cacheExpiresDurationOverrideInMin:a,sessionId:i,alwaysFetchNewSettings:u}}(e),t),this.audience=e.ecsFilters.audience,this.fetchSettings().catch((e=>{}))}}var E=r(68180),T=r(23989),I=r(29967),N=r(58443),F=r(51655),D=r(56142);var O=r(82351),B=r(59091),x=r(60119);var L=r(69235),A=r(51492),R=r(61762),M=r(20967),_=r(91947);class z{constructor(e){this.isOptionalConnectedExperiencesEnabled=e}async optionalConnectedExperiencesEnabled(){return this.isOptionalConnectedExperiencesEnabled}async getEnterpriseFeedbackPolicy(){}get OfficePolicyProvider(){return this}async getPolicy(e){if(!await(0,A.PA)(A.u.OEP,"LoopSettings.OcpsPolicyEnabled"))return{value:"0"};const t=await(0,_.CE)(e.policyId);return void 0===t?void 0:{value:t?"1":"0"}}}class H{constructor(e,t,r){this.defaultProvider=void 0,this.settingOverrides=void 0,this.audience=void 0,this.SettingsProvider=void 0,this.defaultProvider=t,this.SettingsProvider=this,this.audience=e,this.settingOverrides=r,void 0===this.settingOverrides&&async function(){const e=await(0,A.eH)(A.u.OEP,"FluidHost.FluidSettingOverrides","");if(e)try{return JSON.parse(e)}catch(t){(0,L.c2)("HostSettingsProvider",new L.uV("Unable to parse value of FluidHost.FluidSettingsOverride."))}return{}}().then((e=>{this.settingOverrides=e}))}getSetting(e,t,r){var n,o;if(this.settingOverrides){const r=this.settingOverrides[e];if(void 0!==r){const n=typeof r,o=typeof t;if(n===o)return(0,D.Rm)("Override setting: ".concat(e," = ").concat(r)),r;console.warn("Cannot override setting ".concat(e,". The override type (").concat(n,") is different than the setting type (").concat(o,")."))}}return null!==(n=null===(o=this.defaultProvider)||void 0===o?void 0:o.getSetting(e,t,r))&&void 0!==n?n:t}}var U=r(29369),j=r(64643),q=r(81918),V=r(16460),G=r(6971),W=r(60138),K=r(899);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=r(4311),Q=r(24921),X=r(27377),Z=r(85656),$=r(97232),Y=r(94115),ee=r(25573),te=r(40118),re=r(27901);let ne;var oe=r(62231),ie=r(98123);"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{(0,D.vV)(e.message)})),(0,V.Vg)(),(0,G.E)(),async function(i){var s,d,u,h,g,p,m,f;N.yz&&await(0,A.x$)(A.u.OEP,"FluidHost.Debugger.BreakAtMain");const v=F.q.getTimePoint();let{layoutMode:y}=i;const{uiLanguage:b}=i,S=await(0,G.E)(),C=(null===S||void 0===S?void 0:S.loopInfo)||{},k=i.componentTypeToCreate||"",w=k==N.l1,se="@fluidx/video-playback"===C.registrationId;if((0,D.sF)(null===S||void 0===S?void 0:S.consoleLogEnabled),!C.linkUrl&&C.loopData){var ae;const e=JSON.parse(C.loopData);C.linkUrl="string"===typeof e.webUrl?e.webUrl:null===(ae=e.webUrl)||void 0===ae?void 0:ae.href}var ce;C.linkText||(C.linkText=i.loopLinkText||(null===S||void 0===S||null===(ce=S.createParams)||void 0===ce?void 0:ce.loopFileName)||"");C.linkUrl||(C.linkUrl=i.loopLinkUrl||"");C.registrationId||(C.registrationId=w?U.IG:i.loopRegistrationId||"");const le=!C.registrationId||"@fluidx/office-fluid-container"===C.registrationId,de=C.registrationId===U.B2,ue=null===S||void 0===S?void 0:S.fluidSettingOverrides,he=null===S||void 0===S?void 0:S.hydrateId,ge=null!==(s=null===S||void 0===S?void 0:S.isDarkBackground)&&void 0!==s&&s,pe=null!==(d=null===S||void 0===S?void 0:S.isInEditableDocument)&&void 0!==d&&d,me=null!==S&&void 0!==S&&S.linkProblemState||null!==S&&void 0!==S&&S.isPermissionError?V.$R.Error:V.$R.None,fe=null!==(u=null===S||void 0===S?void 0:S.useTokenCache)&&void 0!==u&&u;te.n.GetInstance().isCacheEnabled=fe;const ve=await async function(){if(!N.KV&&(N.Nu||await(0,A.PA)(A.u.OEP,"ChangeGate.LocalAudience")))return"Local";const e="Production",t=await(0,A.eH)(A.u.OEP,"FluidHost.Audience",e);switch(t){case"Automation":case"Dogfood":case"Local":case"Microsoft":case"Preview":case"Production":case"Staging":case"SyntheticTraffic":return t;default:return(0,L.c2)("determineAudience()",new L.uV('Unexpected value for OEP.FluidHost.Audience ("'.concat(t,'").'))),e}}(),ye=function(e){e.name&&"MailComponent"!==e.name||(e.name="Component");e.entryPoint||(e.entryPoint="Mail");e.lifecycle||(e.lifecycle="Load");return e}({entryPoint:i.scenarioEntryPoint,name:i.scenarioName,lifecycle:i.scenarioLifecycle,startTime:null!==(h=null===S||void 0===S?void 0:S.scenarioStartTime)&&void 0!==h?h:(0,ee.W)()}),be="Create"==ye.lifecycle,Se=(0,A.x$)(A.u.OEP,"FluidHost.MIP"),Ce=(0,A.x$)(A.u.OEP,"FluidHost.AppWaitForDriver"),ke="".concat(ye.lifecycle,"_").concat(ye.name,"_").concat(ye.entryPoint),we=null!==(g=(null===S||void 0===S?void 0:S.showTeachingCallout)&&le)&&void 0!==g&&g,Pe=await(0,j.q)(),Ee={buttonText:Pe.GotIt,descriptionText:Pe.CalloutDescription,headerText:Pe.CalloutTitle,officeTheme:null===S||void 0===S?void 0:S.officeTheme,calloutColors:null===S||void 0===S?void 0:S.teachingCalloutColors},Te=null!==(p=null===S||void 0===S?void 0:S.useNewAnimatedSplashScreen)&&void 0!==p&&p,Ie=null!==(m=null===S||void 0===S?void 0:S.enableShowLoopGlowBorderEvent)&&void 0!==m&&m,Ne=null!==(f=null===S||void 0===S?void 0:S.enableRightToLeftSplashScreen)&&void 0!==f&&f;(0,A.lb)();const Fe=(0,A.dG)();(0,A.nw)(),(0,A.aw)(),(0,A.MO)(),se&&C.linkUrl&&(C.linkUrl=(0,ie.addReferralParamsToStreamUrl)(C.linkUrl,S.hydrateScenarioEntryPoint));if((0,D.Rm)("Audience: ".concat(ve)),(0,D.Rm)("Scenario: ".concat(ke)),(0,D.Rm)("LayoutMode: ".concat(y)),(0,D.Rm)("UI Language: ".concat(b)),(0,D.Rm)("Native info: ".concat(JSON.stringify(S,void 0,"  "))),(0,D.Rm)("Loop info: ".concat(JSON.stringify(C,void 0,"  "))),(0,D.Rm)("Is Fluid Loop: ".concat(le)),!le||C.linkUrl||be){var De,Oe,Be,xe;const i=new Y.i(he||"",ke,ve,v),s=be?null!==S&&void 0!==S&&null!==(De=S.createParams)&&void 0!==De&&De.loopFolderName?Promise.resolve(S.createParams.loopFolderName):(0,J.ZQ)("attachments"):Promise.resolve(""),d=Promise.resolve(be?C.linkText:"");let u;be||((0,M.OX)(C.linkUrl),"Paste"===ye.lifecycle&&(C.linkUrl=(0,E.c)(C.linkUrl)),le&&(u=(0,e.Mh)(new URL(C.linkUrl)),u||(0,D.vV)("Unable to get the SharePoint locator from the Fluid url.")));const{localization:h,internationalizationContext:g}=await(0,M.Z)(b),p=document.getElementById(N.xu),m=document.getElementById(N.bY);p&&(p.hidden=!0),null===m||void 0===m||m.removeAttribute("hidden");const f=null===m||void 0===m?void 0:m.clientWidth,w=f?Math.min(f,N.s):N.s,{background:U,shimmer:j}=(0,X.O)(ge,Te),V=document.createElement("div");V.className="combined";const G=document.createElement("object");G.data=U,G.width=(null===f||void 0===f?void 0:f.toString())||"",G.height=Te?N.pY.toString():N.FT.toString();const Q=document.createElement("object");Q.data=j,Q.width=w.toString(),Q.height=Te?N.pY.toString():N.FT.toString(),Ne&&"rtl"==h.localeDirection&&(Q.style.transform="scale(-1, 1)"),Q.onload=()=>{setTimeout((()=>{(0,_.kF)()}),200)},Q.onerror=()=>{m&&(m.hidden=!0),null===p||void 0===p||p.removeAttribute("hidden"),(0,L.c2)("main()",new L.uV("Failed to load animated Svg.")),(0,_.kF)()},V.append(G,Q),null===m||void 0===m||m.append(V);const Z=(0,K.u0)().replace(/[{}]/g,"").toLowerCase(),$=null!==he&&void 0!==he?he:(0,re._)(),ee=(0,M.b6)(Z,$,b,ye),te={get TelemetryConfig(){return this},hostCorrelationId:$,hostSessionId:Z},ie=new W.z,ae=(0,M.Ng)(ee,S,ve),ce=T._.startScenario(ae,ye.lifecycle),fe=new P({ecsFilters:{audience:ve,userContext:{}},hostName:ee.hostName},ae),Ae=await A.y,Re=new H(ve,fe,ue),{stylingProvider:Me,initialTheme:_e,initialThemeV9:ze}=(0,M.br)(ee.hostAppName,ge,Ae),He=le&&await Se,Ue=He?function(e){if("Consumer"===e.tokenProvider.identityType)return;let i;if((0,o.gX)(e.settingsProvider)&&(i=r.e(65354).then(r.bind(r,83126)).then((r=>{const n=new r.SharepointInformationProtectionService({...e,logger:e.logger?new t.p("InformationProtectionService",e.logger):void 0});return n.initialize("PO"),n}))),e.logger){const r=new t.p("InformationProtectionService",e.logger);n.m.start("getInformationProtectionServiceForSharepoint",r).setResult(void 0!==i,{isGetLabelEnabled:(0,o.gX)(e.settingsProvider),isSetLabelEnabled:(0,o.E7)(e.settingsProvider),settingsProviderExists:void 0!==e.settingsProvider})}return i}({tokenProvider:ie,settingsProvider:Re,logger:ae,locale:h.locale}):void 0;if(He&&void 0===Ue&&(0,L.c2)("main()",new L.uV("getInformationProtectionServiceForSharepoint() failed.")),He&&Ue&&u)try{a(Ue,u.siteUrl,u.driveId,u.itemId,ae)}catch(Le){(0,L.c2)("preCacheInformationProtectionWithSharePointIds()",new L.uV("Exception occurred.",Le))}const je=new c.R(Me);let qe,Ve,Ge;const We=void 0!==(null===S||void 0===S?void 0:S.isOptionalConnectedExperiencesEnabled),Ke=void 0!==(null===S||void 0===S?void 0:S.isOptionalConnectedExperiencesEnabled)?new z(We):void 0;if(de){const e=await(0,q.Cw)();Ge=e.getUrlHandlerProvider(),Ve=e.getMetaOSProvider(),qe=null!==S&&void 0!==S&&S.isCardChannelProviderEnabled?e.getCardChanelProvider():void 0}const Je={environment:(0,M.NK)(ve),logger:ae},Qe=(null===S||void 0===S?void 0:S.partitionCacheKey)||null,Xe=S&&""!==S.partitionCacheKey;let Ze,$e;le&&(Ze=(0,B.FM)(i,Je,ae,Re,ie,Xe,Qe),$e=(0,I.o)(ie,ae));const Ye=await Fe?(0,oe.H)():void 0,et=await async function(e){let{cardChannelProvider:t,documentServiceFactory:r,informationProtectionServicePromise:n,internationalizationContext:o,metaOSProvider:i,officeFluidLogger:s,optionalConnectedProvider:a,presenceColorProvider:c,settingsProvider:l,stylingProvider:d,telemetryConfig:u,tokenProvider:h,urlHandlerProvider:g,urlResolver:p,playbackStateHandlerPromise:m}=e;const f=new O.h;return t&&f.register("CardChannelProvider",t),f.register("InternationalizationContext",o),n&&f.register("InformationProtectionService",n),f.register("LoopTelemetrySink",x.a),i&&f.register("MetaOSProvider",i),f.register("NamespaceLogger",s),a&&f.register("OfficePolicyProvider",a),f.register("PresenceColorProvider",c),f.register("SettingsProvider",l),f.register("StylingProvider",d),f.register("TelemetryConfig",u),f.register("TokenProvider",h),g&&f.register("UrlHandlerProvider",g),r&&p&&f.register("DriverImplementation",new B.kx(p,r)),m&&f.register("PlaybackStateHandler",m),f}({cardChannelProvider:qe,documentServiceFactory:Ze,informationProtectionServicePromise:Ue,metaOSProvider:Ve,officeFluidLogger:ae,optionalConnectedProvider:Ke,playbackStateHandlerPromise:Ye,presenceColorProvider:je,settingsProvider:Re,stylingProvider:Me,tokenProvider:ie,urlHandlerProvider:Ge,urlResolver:$e,internationalizationContext:g,telemetryConfig:te}),tt={url:C.linkUrl,headers:{isSharingLinkToRedeem:!0}};He&&(tt.headers={...tt.headers,"X-CLP-Compliant-App":!0});const rt=await d,nt="Mac"!==ee.hostAppPlatform;i.setLoadPerfTracker();const ot=(0,R.h)(be,k,s,rt,C,Je,ee,he,tt,et,ae,i,Ze,$e);ot.then((()=>{var e;i.onLoadComplete(ie);const t=null===(e=i.LoadPerfTracker)||void 0===e?void 0:e.getDurationInSeconds();(0,D.Rm)("Fluid component loaded. (".concat(null!==t&&void 0!==t?t:"??"," s)")),C.loopData&&(0,D.Rm)("  Data: ".concat(C.loopData)),C.loopIconUrl&&(0,D.Rm)("  Icon: ".concat(C.loopIconUrl)),C.loopName&&(0,D.Rm)("  Name: ".concat(C.loopName)),C.loopTitle&&(0,D.Rm)("  Title: ".concat(C.loopTitle)),C.linkText&&(0,D.Rm)("  Link Text: ".concat(C.linkText)),C.linkUrl&&(0,D.Rm)("  Link Url: ".concat(C.linkUrl))})),be&&ot.catch((async()=>{await(0,A.PA)(A.u.OEP,"ChangeGate.FluidHost.CreateFailed")&&(0,_.xh)(k)})),async function(e){"Mac"!=e.hostAppPlatform&&(0,A.PA)(A.u.OEP,"ChangeGate.FluidOutlook.FixBorder").then((e=>{if(e){const e=document.getElementById(N.xu);e&&(e.style.paddingRight="1px")}}))}(ee),(0,M.Sk)(y),se&&(y=l.S.grow);const it=function(e,t){return ne?e.isInEditableDocument&&(ne.delegateToHostAppForNotification=!0,ne.useCustomSharedService=!0):(ne={delegateToHostAppForNotification:!1,disableSingleClickOpenHeaderLink:!1,shouldDisableEscapeKey:!1,useCustomSharedService:!1},("MailCompose"===e.hydrateScenarioEntryPoint||void 0===e.hydrateScenarioEntryPoint&&e.isInEditableDocument)&&(ne.delegateToHostAppForNotification=!0,ne.useCustomSharedService=!0,t&&(ne.shouldDisableEscapeKey=!0)),"WordDocument"===e.hydrateScenarioEntryPoint&&(ne.disableSingleClickOpenHeaderLink=!0)),ne}(S,!(null===S||void 0===S||!S.version)&&(null===S||void 0===S?void 0:S.version)>=28),st={controlClickToFollowLink:Pe.ControlClickToFollowLink,isDarkBackground:ge,shouldDisableEscapeKey:it.shouldDisableEscapeKey,linkProblemState:me,linkText:C.linkText,linkUrl:null!==(Oe=C.safeLinkWrappedUrl)&&void 0!==Oe?Oe:C.linkUrl,onClick:e=>{(0,M.ig)(e,pe,it.disableSingleClickOpenHeaderLink)},textForEmptyUrl:Pe.GettingThisReady,updateTheme:void 0};if(i.setInitialRenderPerfTracker(),Ze){if(await Ce)try{await Ze}catch{}}const at=await A.CI;(async function(e){const t=e.showComponentActivity;(0,D.Rm)("appLazyStart() started."),t.AppLazyImportTracker=new F.q,t.AppLazyStartTracker=new F.q;const n=await t.AppLazyImportTracker.measure((()=>Promise.all([r.e(69808),r.e(97950),r.e(17122),r.e(78167),r.e(82075),r.e(94885),r.e(13075),r.e(95126),r.e(27614),r.e(93191),r.e(45630),r.e(72423),r.e(94258)]).then(r.bind(r,78003))));t.AppLazyStartTracker.measure((()=>n.lazyStart(e)));const o=t.AppLazyImportTracker.getDurationInSeconds(),i=t.AppLazyStartTracker.getDurationInSeconds();(0,D.Rm)("appLazyStart() completed.  (Import: ".concat(o," s,  Lazy start: ").concat(i," s)"))})({areLoopComponentPropertiesEnabled:await(0,A.cn)(),canSetFocusToLink:nt,containerRequest:tt,dependencySynthesizer:et,documentServiceFactory:Ze,enableShowLoopGlowBorderEvent:Ie,giveComponentFocus:be,headerProps:st,hostConfig:Je,hostContext:ee,informationProtectionServicePromise:Ue,initialTheme:_e,initialThemeV9:ze,isAppThemeBrandingEnabled:Ae,isInEditableDocument:pe,isMIPEnabled:He,isShyHeaderHoveringEnabled:at,layoutMode:y,loadCompletePromise:ot,localization:h,loopInfo:C,officeFluidLogger:ae,presenceColorProvider:je,scenarioTracker:ce,settingsProvider:Re,showComponentActivity:i,stylingProvider:Me,teachingProps:Ee,tokenProvider:ie,urlResolver:$e,wantToShowTeachingCallout:we,webAppConfigOverride:it}).catch((e=>{(0,L.c2)("appLazyStart()",(0,L.oD)(e))})),null===(Be=i.WebAppMainPerfTracker)||void 0===Be||Be.setSuccess();const ct=null===(xe=i.WebAppMainPerfTracker)||void 0===xe?void 0:xe.getDurationInSeconds();(0,D.Rm)("WebApp main complete. (".concat(null!==ct&&void 0!==ct?ct:"??"," s)"))}else{const e=1e3,t=await(0,A.n_)(A.u.OEP,"FluidHost.DelayTimeWhenNoFluidUrl",e);await(0,Q.y)(t),await(0,Z.$)($.d.Success_NoFluidUrl)}}(function(e){const t=function(e){const t=e.search?e.search:e.hash;return new URLSearchParams("#"==t[0]?t.substring(1):t)}(e),r=t.get("create"),n=null!==r,o=null!==t.get("paste");return{componentTypeToCreate:r,layoutMode:(0,M.ZG)(t.get("layout")),loopRegistrationId:t.get("loopId"),loopLinkText:t.get("linkText")||t.get("fileName"),loopLinkUrl:function(e){switch(e){case"1":return"";case"2":return"https://microsoft-my.sharepoint-df.com/:fl:/p/manos/ETK44FqyWS1HmflsrI7osCcBaCWLXvZ-GinnJBsnNU9ZXg?nav=cz0lMkZwZXJzb25hbCUyRm1hbm9zX21pY3Jvc29mdF9jb20mZD1iIVVET05QQU1XQlVLOUU2U3NyT2dwTEdtQjVpYmliR3BNa2d4RG1rYXlnTFYtaUVoOHAwNDhTNTR4YUUxUVh6R3EmZj0wMUJNWFJUSUpTWERRRlZNU1pGVkRaVDZMTVZTSE9STUJIJmM9JTJGNTU2YzVkNjEtNmY4Ny00MTBiLTlkMzctYTM2OTE5N2Y1OGZkJTNGc3RhcnQlM0R1bmRlZmluZWQlMjZlbmQlM0QyZDhjNmIwNS1jYTg3LTQ3OGMtOGJjZC1lMGNiNzZkOTk2MjgmZmx1aWQ9MSZwPSU0MG1zJTJGb2ZmaWNlLWZsdWlkLWNvbnRhaW5lcg%3D%3D"}return null}(t.get("fluidUrlOverride"))||t.get("linkUrl")||t.get("fluidUrl"),scenarioEntryPoint:t.get("sep")||"",scenarioLifecycle:o?"Paste":n?"Create":"Load",scenarioName:t.get("s")||"",uiLanguage:t.get("locale")||(0,K.Mg)()||"en-us"}}(window.location)).catch((e=>{(0,L.c2)("main()",(0,L.oD)(e))}))})()})();
//# sourceMappingURL=main.411f342f.js.map