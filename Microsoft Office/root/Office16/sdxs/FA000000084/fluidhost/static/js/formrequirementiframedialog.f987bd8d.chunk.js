"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[75990],{19456:(e,t,o)=>{o.r(t),o.d(t,{FormRequirementIframeDialog:()=>q});var r,n=o(65043),a=o(16112),s=o(52342),i=o(20751);!function(e){e.Desktop="desktop",e.Web="web",e.Mobile="mobile"}(r||(r={}));var d,l,m;!function(e){e.formsEndpoint="https://forms.office.com",e.formsRunTimeIFramePath="/pages/EmbedResponsePage.aspx",e.formsDesignateIframePath="/pages/EmbedDesignPage.aspx",e.formsAppName="Tasks"}(d||(d={})),function(e){e.GetTokenRequest="getToken",e.GetTokenResponse="getTokenSuccess",e.GetTokenResponseV2="accessToken",e.GetTemplate="getTemplate",e.TemplateContent="templateContent",e.SizeChanged="sizeChanged",e.FormReady="contentLoaded",e.ContentReady="contentReady",e.DataValidationResult="formValidationStatus",e.SubmitRequest="submit",e.SubmitStatus="submitStatus",e.SavingStatus="savingStatus",e.ThemeChanged="themeChanged",e.ThemeChangedV2="themeModeChanged",e.KeyDown="keyDown",e.FormsContext="formsContext",e.GetSetting="getSettings",e.Setting="setting",e.GeneralError="generalError",e.ServerError="serverError",e.AuthError="authError"}(l||(l={})),function(e){e.NotStarted="notStarted",e.Saved="saved",e.Saving="saving",e.Failed="failed"}(m||(m={}));var p=o(77508),g=o(25290);const u="error";function h(e,t,o,r){v(o);const n=e=>{null===t||void 0===t||t.postMessage(JSON.stringify(e),o)};return{send(e){const t={...e,meta:{senderId:r}};n(t)},sendWithReturn(t,a){const s=(0,g.DA)();let i;return new Promise(((d,l)=>{const m=t=>{var r;const n=c(t,o);(null===n||void 0===n||null===(r=n.meta)||void 0===r?void 0:r.messageId)===s&&(e.removeEventListener("message",m),d(n))};e.addEventListener("message",m);const p={...t,meta:{messageId:s,senderId:r}};n(p),a&&(i=e.setTimeout((()=>{l("sendWithReply timeout"),i=void 0}),3e3))})).then((t=>(void 0!==i&&e.clearTimeout(i),t)))},sendReply(e,t){if(e.meta){var o;const a={...t,meta:{messageId:null===e||void 0===e||null===(o=e.meta)||void 0===o?void 0:o.messageId,senderId:r}};n(a)}}}}function c(e,t){if(e.origin===t)try{const t=JSON.parse(e.data);if(t&&"object"===typeof t)return t}catch{}}function v(e){if("*"===e)throw new Error("Post message origin invalid value: '".concat(e,"'"))}function f(e){switch(e){case p.Sx.Dark:case p.Sx.TeamsDark:return"dark";case p.Sx.TeamsContrast:return"hc";default:return"light"}}var I;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Saving=1]="Saving",e[e.Saved=2]="Saved",e[e.Failed=3]="Failed"}(I||(I={}));class R extends n.Component{componentDidMount(){var e;const{formsIframeRef:t}=this.state;if(null!==(e=t.current)&&void 0!==e&&e.contentWindow){const{remove:e}=function(e,t,o,r){v(t);const n=e=>{const n=c(e,t);if(n){var a;if(r&&(null===(a=n.meta)||void 0===a?void 0:a.senderId)!==r)return;const e=o[n.type];e?e(n):n.error&&o[u]&&o[u](n)}};return e.addEventListener("message",n,!1),{remove:()=>{e.removeEventListener("message",n,!1)}}}(window,this.formsEndpoint,this.formsIframeMessageHandler);return this.setState({postMessageSender:h(window,t.current.contentWindow,this.formsEndpoint),removeListener:e}),e}}componentWillUnmount(){const{removeListener:e}=this.state;e&&e()}render(){const{formsIframeRef:e}=this.state,{className:t,allow:o,defaultHeight:r}=this.props;return n.createElement("iframe",{className:t,allow:o,sandbox:"allow-modals allow-scripts allow-popups allow-forms allow-popups-to-escape-sandbox allow-same-origin",src:this.formsRuntimeIframeUrl,ref:e,width:"100%",height:r})}constructor(e){super(e),this.formsEndpoint=d.formsEndpoint,this.formsRuntimeIframeUrl=function(e){const t=new URL(d.formsRunTimeIFramePath,d.formsEndpoint);return t.searchParams.append("Id",e),t.searchParams.append("host",d.formsAppName),t.searchParams.append("mode","full"),t.searchParams.append("version","1.1"),t.toString()}(this.props.urlFormId),this.formsIframeMessageHandler={[l.GetSetting]:e=>{var t,o;const{viewType:r,theme:n,planNameforTask:a}=this.props,{postMessageSender:s}=this.state,i=a,d=e;this.setState({messageId:null!==(t=d.meta)&&void 0!==t&&t.messageId?null===(o=d.meta)||void 0===o?void 0:o.messageId:""});const m={type:l.Setting,payload:{viewType:r,themeMode:n,configuration:{isCreateMyOwnFormEnabled:!1,fileUploadPrefix:i},intelligenceEnabled:["questionSuggestion"]},meta:{messageId:this.state.messageId}};null===s||void 0===s||s.sendWithReturn(m)},[l.FormsContext]:e=>{var t;this.setState({sessionId:null===(t=e.payload)||void 0===t?void 0:t.sessionId})},[l.FormReady]:e=>{var t;null!==(t=this.props.eventHandlers)&&void 0!==t&&t.formReadyEventHandler&&this.props.eventHandlers.formReadyEventHandler()},[l.DataValidationResult]:e=>{const{eventHandlers:t}=this.props;var o;null!==t&&void 0!==t&&t.dataValidateEventHandler&&("passed"===(null===(o=e.payload)||void 0===o?void 0:o.status)?t.dataValidateEventHandler(!0):t.dataValidateEventHandler(!1))},[l.SizeChanged]:e=>{var t;null!==(t=this.props.eventHandlers)&&void 0!==t&&t.sizeChangedEventHandler&&this.props.eventHandlers.sizeChangedEventHandler(e.payload)},[l.ContentReady]:e=>{var t;null!==(t=this.props.eventHandlers)&&void 0!==t&&t.formReadyEventHandler&&this.props.eventHandlers.formReadyEventHandler()},[l.GeneralError]:e=>{const{telemetryLogger:t,componentName:o,eventHandlers:r}=this.props;var n;t&&t(o,l.GeneralError,{error:null===(n=e.payload)||void 0===n?void 0:n.message});null!==r&&void 0!==r&&r.generalErrorHandler&&r.generalErrorHandler(E(e))},[l.ServerError]:e=>{var t;const{telemetryLogger:o,componentName:r}=this.props;var n;o&&o(r,l.ServerError,{error:null===(n=e.payload)||void 0===n?void 0:n.message});null!==(t=this.props.eventHandlers)&&void 0!==t&&t.serverErrorHandler&&this.props.eventHandlers.serverErrorHandler(E(e))},[l.SubmitStatus]:e=>{var t,o,r,n;"succeeded"===(null===(t=e.payload)||void 0===t?void 0:t.status)&&(null===(o=(r=this.props).onResposeIdReceived)||void 0===o||o.call(r,null===(n=e.payload)||void 0===n?void 0:n.responseId))},[l.GetTokenRequest]:async e=>{const{postMessageSender:t,sessionId:o}=this.state,{formsTokenProvider:r,telemetryLogger:n,componentName:a}=this.props,s=await y(r,n,a);s&&(null===t||void 0===t||t.sendReply(e,{payload:{token:s,sessionId:o}}))},[l.AuthError]:async e=>{const{eventHandlers:t,formsTokenProvider:o,telemetryLogger:r,componentName:n}=this.props;if(r){var a;r(n,l.AuthError,{error:null===(a=e.payload)||void 0===a?void 0:a.message});const t=await y(o,r,n);if(t){const{postMessageSender:o,sessionId:r}=this.state;null===o||void 0===o||o.sendReply(e,{payload:{token:t,sessionId:r}})}}null!==t&&void 0!==t&&t.authErrorHandler&&t.authErrorHandler(E(e))}},this.state={formsIframeRef:n.createRef(),sessionId:"",messageId:"",postMessageSender:void 0}}}async function y(e,t,o){try{if(e){return await e()}}catch(r){return void(t&&t(o,l.AuthError,{error:r}))}}function E(e){var t,o,r;return{code:null===(t=e.payload)||void 0===t?void 0:t.code,message:null===(o=e.payload)||void 0===o?void 0:o.message,isRetriable:null===(r=e.payload)||void 0===r?void 0:r.isRetriable}}var S=o(86053),x=o(66783),T=o(33516),w=o(8736),b=o(66151),C=o(56415);const D="30px",k=(0,x.J9)(((e,t)=>{const o={dialogContainer:[(0,b.dg)(e),{padding:"0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{minWidth:"800px"}}],dialogTitle:[F(e),(0,b._D)(e),(0,b.gS)(),{justifyContent:"space-between",alignItems:"center",left:"0",height:"20px",boxSizing:"border-box"}],dialogTopButton:[{display:"flex",alignItems:"center",right:"revert",height:D,boxSizing:"border-box",paddingBottom:"2px",cursor:"pointer",border:"none",background:"none",outline:"none"}],container:[{alignItems:"top",width:"50%",height:"100%",maxWidth:w.B.MainDialogMaxWidth,minWidth:w.B.MainDialogMaxWidth,"@media (min-width: 480px)":{width:"50%",maxWidth:w.B.MainDialogMaxWidth,minWidth:w.B.MainDialogMaxWidth},borderRadius:w.B.PlannerBorderRadius,boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",".ms-Dialog-inner":[{padding:"0px",overflow:"hidden"}],".ms-Dialog-header":[F(e),{height:"40px",border:"1px 0px 1px 0px"}],button:[{width:"fit-content",height:D,backgroundColor:"transparent",":hover":{backgroundColor:"transparent !important"}}],i:[(0,b._D)(e)]}]};return(0,T.TW)(o,t)})),H=(0,x.J9)((e=>({dialogTitle:(0,T.Zq)("dialogTitle",e.dialogTitle),dialogTopButton:(0,T.Zq)("dialogTopButton",e.dialogTopButton),dialogContainer:(0,T.Zq)("dialogContainer",e.dialogContainer),container:(0,T.Zq)("container",e.container)}))),N=(0,x.J9)((e=>({title:e.dialogTitle,topButton:e.dialogTopButton}))),F=(0,x.J9)((e=>{let t=C.z.NeutralLightGrey96;switch(e){case p.Sx.Dark:case p.Sx.TeamsDark:case p.Sx.TeamsContrast:t=C.z.NeutralDarkGrey32}return{backgroundColor:t}}));var M=o(96891),P=o(74527);class q extends a.${name(){return"formsIframeRequirementDialog"}renderComponent(){const{container:e,dialogTopButton:t,dialogTitle:o}=this.getClassNames();return n.createElement(s.l,{hidden:!1,onDismiss:()=>this.props.onDismiss(),dialogContentProps:{showCloseButton:!1,className:this.props.dialogContentClassName,styles:N(k(this.props.theme)),topButtonsProps:[{onRenderIcon:()=>n.createElement("div",{className:t,onClick:this.props.onDismiss},n.createElement(i.I,P.qb),n.createElement("label",{className:o},S.p.Strings.FormRequirementIframeDialog_FormRequirementIframeDialogHeader))}]},modalProps:{containerClassName:e,isBlocking:!0}},this.renderDialogContent())}renderDialogContent(){return n.createElement("div",{className:"formsIframeDialog"},this.renderIframe())}getClassNames(){return H(k(this.props.theme))}renderIframe(){const e=this.context.usageLogger;return n.createElement(R,{defaultHeight:screen.availHeight,viewType:r.Desktop,componentName:this.name(),telemetryLogger:e.logData.bind(e),formsTokenProvider:this.props.formTokenProvider,onResposeIdReceived:this.props.onFormResponseIdReceived,iframeHeaderTitle:S.p.Strings.FormRequirementIframeDialog_FormRequirementIframeDialogHeader,urlFormId:this.props.urlFormId,className:"FormsRunTimeIframe",theme:f(this.props.theme),onError:this.onIframeError,onFormReady:this.onFormReady,planNameforTask:this.props.planNameforTask})}constructor(e,t){super(e,t),this.onIframeError=e=>{this.props.onError&&this.props.onError(e),this.context.usageLogger.logData(this.name(),M.M.FormsRequirementsIframeDialogError,{event:e.message})},this.onFormReady=()=>{this.context.usageLogger.logData(this.name(),M.M.FormsRequirementsIframeDialogFormReady,{})}}}}}]);
//# sourceMappingURL=formrequirementiframedialog.f987bd8d.chunk.js.map