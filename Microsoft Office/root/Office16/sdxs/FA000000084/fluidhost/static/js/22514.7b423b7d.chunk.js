"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[22514],{3854:(e,t,i)=>{i.d(t,{EJ:()=>a,Il:()=>n,Iy:()=>r,zs:()=>o});const o="ProjectTrialRetentionSurvey",n={CampaignId:"1985b389-aee4-4904-b60a-967b0e328837",StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2023-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,IsAggregate:!1,Activity:"TimelineTrialDialogDsimissed",Count:1},Content:{Prompt:{Title:"TimelinePromptTitle",Question:"Prompt_Question",YesLabel:"PromptYesLabel",NoLabel:"PromptNoLabel"},Rating:{Question:"TimelineRatingQuestion",RatingValuesAscending:["TimelineOption5","TimelineOption4","TimelineOption3","TimelineOption2","TimelineOption1"]},Question:{Question:"Question_Question"}}}},a={CampaignId:"9a341c6f-c9bd-4d53-820b-8e82a8db41c3",StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2023-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,IsAggregate:!1,Activity:o,Count:1},Content:{Prompt:{Title:"TrialRetentionPromptTitle",Question:"Prompt_Question",YesLabel:"PromptYesLabel",NoLabel:"PromptNoLabel"},Rating:{Question:"TrialRetentionRatingQuestion",RatingValuesAscending:["TimelineOption5","TrialRetentionOption4","TrialRetentionOption3","TrialRetentionOption2","TrialRetentionOption1"]},Question:{Question:"Question_Question"}}}},r={CampaignId:"261170d6-c83e-4dd7-9c08-f3df9efcf5c8",StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2023-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,IsAggregate:!1,Activity:"TimelineTrialBannerDsimissed",Count:1},Content:{Prompt:{Title:"TimelinePromptTitle",Question:"Prompt_Question",YesLabel:"PromptYesLabel",NoLabel:"PromptNoLabel"},Rating:{Question:"TimelineRatingQuestion",RatingValuesAscending:["TimelineOption5","TimelineOption4","TimelineOption3","TimelineOption2","TimelineOption1"]},Question:{Question:"Question_Question"}}}}},22514:(e,t,i)=>{i.d(t,{q:()=>y});var o,n=i(78332),a=i(96891),r=i(56434),s=i.n(r),c=function(){function e(){this.clear()}return e.prototype.getItem=function(e){var t=this.storage[e];return null==t?null:t},e.prototype.setItem=function(e,t){this.storage[e]=t},e.prototype.removeItem=function(e){delete this.storage[e]},e.prototype.clear=function(){this.storage={}},e}();!function(e){var t={},i=new c;function o(e){var i=t[e];if(null!=i)return i;var o=null;try{o=window[e];var n="__storage_test__";o.setItem(n,n),o.removeItem(n),i=!0}catch(a){i=a instanceof DOMException&&(22===a.code||1014===a.code||"QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&null!=o&&0!==o.length}return t[e]=i,i}e.getSessionOrInMemoryStorage=function(){return e.sessionStorageAvailable()?window.sessionStorage:i},e.localStorageAvailable=function(){return o("localStorage")},e.sessionStorageAvailable=function(){return o("sessionStorage")}}(o||(o={}));var l=i(74844);const g="NPSPromptSurvey",d="PlannerIntercept",u="AppUsageTime";class p{static init(e){if(!o.localStorageAvailable()){const t="OCV floodgate initialization failed because localStorage is not avilable.";throw e.logTrace(507778499,l.k.Warning,t),new Error(t)}window.localStorage.setItem("obf-CampaignDefinitions",JSON.stringify(p.NPSCampaignDefinitions))}static getNPSCampaignDefinitions(){return s()(p.NPSCampaignDefinitions)}}p.NPSCampaignId="ac824c21-e1cc-4d32-a173-de0873658c6b",p.InterceptCampaignId="e4568478-476e-4fa4-aac6-660b263c1814",p.NPSCampaignDefinitions=[{CampaignId:p.NPSCampaignId,StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2050-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!0,Activity:u,Count:300},{Type:0,IsAggregate:!0,Activity:g,Count:2}]},Content:{Prompt:{Title:"Prompt_Title",Question:"Prompt_Question",YesLabel:"Prompt_YesLabel",NoLabel:"Prompt_NoLabel"},Rating:{Question:"Rating_Question",RatingValuesAscending:["Rating_Values_1","Rating_Values_2","Rating_Values_3","Rating_Values_4","Rating_Values_5"]},Question:{Question:"Question_Question"}}}},{CampaignId:p.InterceptCampaignId,StartTimeUtc:"2021-11-05T00:00:00Z",EndTimeUtc:"2021-11-10T19:30:00Z",GovernedChannelType:1,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:259200}},SurveyTemplate:{Type:5,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:d,Count:1,IsAggregate:!0}]},Content:{Intercept:{Title:"InterceptTitle",Question:"InterceptQuestion",Url:"InterceptURL"}}}}];var m=i(3854),f=i(21382),T=i(38752),v=i(86053),S=i(79537);class y{static getFormattedBuildVersion(e){return e?e.replace(/[^\d.]/g,""):""}static surveyFloodgateInit(e){return y.CUSTOM_SURVEY_STRINGS={Prompt_Title:v.p.Strings.OfficeCustomerVoice_PromptTitle,Prompt_Question:v.p.Strings.OfficeCustomerVoice_PromptQuestion,Prompt_YesLabel:v.p.Strings.OfficeCustomerVoice_PromptYesLabel,Prompt_NoLabel:v.p.Strings.OfficeCustomerVoice_PromptNoLabel,Rating_Question:v.p.Strings.OfficeCustomerVoice_RatingQuestion,Rating_Values_1:v.p.Strings.OfficeCustomerVoice_RatingValues1,Rating_Values_2:2,Rating_Values_3:3,Rating_Values_4:4,Rating_Values_5:v.p.Strings.OfficeCustomerVoice_RatingValues5,Question_Question:v.p.Strings.OfficeCustomerVoice_FollowUpQuestion,InterceptTitle:f.G(v.p.Strings.OfficeCustomerVoice_InterceptTitle,v.p.Strings.OfficeCustomerVoice_InterceptTopic),InterceptQuestion:f.G(v.p.Strings.OfficeCustomerVoice_InterceptQuestion,v.p.Strings.OfficeCustomerVoice_InterceptTopic),InterceptURL:"https://aka.ms/planneruser",TimelinePromptTitle:v.p.Strings.OfficeCustomerVoice_TimelinePromptTitle,TrialRetentionPromptTitle:v.p.Strings.OfficeCustomerVoice_TrialRetentionPromptTitle,TimelineRatingQuestion:v.p.Strings.OfficeCustomerVoice_TimelineRatingQuestion,TrialRetentionRatingQuestion:v.p.Strings.OfficeCustomerVoice_TrialRetentionRatingQuestion,TimelineOption1:v.p.Strings.OfficeCustomerVoice_TimelineOption1,TimelineOption2:v.p.Strings.OfficeCustomerVoice_TimelineOption2,TimelineOption3:v.p.Strings.OfficeCustomerVoice_TimelineOption3,TimelineOption4:v.p.Strings.OfficeCustomerVoice_TimelineOption4,TimelineOption5:v.p.Strings.OfficeCustomerVoice_TimelineOption5,TrialRetentionOption1:v.p.Strings.OfficeCustomerVoice_TrialRetentionOption1,TrialRetentionOption2:v.p.Strings.OfficeCustomerVoice_TrialRetentionOption2,TrialRetentionOption3:v.p.Strings.OfficeCustomerVoice_TrialRetentionOption3,TrialRetentionOption4:v.p.Strings.OfficeCustomerVoice_TrialRetentionOption4},new Promise(((t,i)=>{y.setupFloodgate(e).then((()=>{y.startFloodgate(e.traceLogger).then((()=>{e.usageLogger.logData("OCV Floodgate","successfully initialized"),this.initFinished=!0;for(const t of y.activityLogNamesBeforeInit)y.logFloodgateActivity(t,e.traceLogger);y.activityLogNamesBeforeInit=[],t()})).catch((e=>{i(e)}))})).catch((t=>{e.traceLogger.logTrace(507778498,l.k.Error,"OCV Floodgate - failed to initialize [Error=".concat(S.f.getMessage(t),"]")),i(t)}))}))}static onSurveyActivated(e,t,i){const o=y.getOfficeBrowserFeedback("onSurveyActivated",e.traceLogger);o&&(o.survey=i,t.launch(),e.usageLogger.logData("OCV Floodgate","NPS survey activated"))}static getEnvironment(){let e=T.B.isPreProductionEnvironment()?"PPE":"Production";return T.B.tenantId===n.qf&&(e="Microsoft"),e}static openInAppFeedback(e,t,i){const o={applicationGroup:{appData:T.B.clientType},telemetryGroup:{deviceType:navigator.userAgent,platform:navigator.platform,tenantId:e,audienceGroup:y.getEnvironment()},webGroup:{sourcePageName:t,sourcePageURI:window.location.href,browser:T.B.currentBrowser,browserVersion:navigator.appVersion}},n=window.OfficeBrowserFeedback;n?n.multiFeedback(o).catch((e=>{i.logTrace(507778496,l.k.Error,"Failed to launch OCV in-app multi-feedback. Error: ".concat(e))})):i.logTrace(507778497,l.k.Warning,"OfficeBrowserFeedback not on window")}static setupFloodgate(e){return new Promise(((t,i)=>{try{y.floodgateInit(e),y.setFloodgateWindowEvents(e),t()}catch(o){i(o)}}))}static floodgateInit(e){const{traceLogger:t}=e,i=y.getOfficeBrowserFeedback("floodgateInit",t);if(!i)throw new Error("OfficeBrowserFeedback not on window");const o=p.getNPSCampaignDefinitions();o.push(m.Iy),o.push(m.Il),o.push(m.EJ),i.floodgate.initOptions={campaignDefinitions:o,onSurveyActivatedCallback:{onSurveyActivated:(t,i)=>y.onSurveyActivated(e,t,i)},uIStringGetter:y.uiStringMap,onDismiss:function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return y.onDismiss(...i,e)},authTokenCallback:{getUserPuid:()=>Promise.resolve("")}},p.init(t)}static startFloodgate(e){return new Promise(((t,i)=>{const o=y.getOfficeBrowserFeedback("startFloodgate",e);o?o.floodgate.initialize().then((()=>{this.startFloodgateAsync(e).then((()=>{t()})).catch((e=>{i(e)}))})).catch((t=>{e.logTrace(507778467,l.k.Error,"OCV Floodgate - failed to initialize [Error=".concat(S.f.getMessage(t),"]")),i(t)})):i(new Error("OfficeBrowserFeedback not on window"))}))}static setFloodgateWindowEvents(e){window.addEventListener("focus",(()=>this.startFloodgateAsync(e))),window.addEventListener("blur",(()=>this.stopFloodgate(e))),window.addEventListener("unload",(()=>this.stopFloodgate(e)))}static startFloodgateAsync(e){return new Promise(((t,i)=>{const o=y.getOfficeBrowserFeedback("startFloodgateAsync",e);o?o.floodgate?o.floodgate.start().then((()=>{const i=y.getActivityListener("startFloodgateAsync",e);null===i||void 0===i||i.logActivity(g),null===i||void 0===i||i.logActivity(d),null===i||void 0===i||i.logActivityStartTime(u),t()})).catch((t=>{const o="Floodgate failed to start [Error=".concat(t,"]");e.logTrace(507778466,l.k.Info,o),i(t)})):i(new Error("officeBrowserFeedback.floodgate not on window")):i(new Error("OfficeBrowserFeedback not on window"))}))}static stopFloodgate(e){const t=y.getOfficeBrowserFeedback("stopFloodgate",e);if(!t)return;if(!t.floodgate)return void e.logTrace(507778465,l.k.Error,"officeBrowserFeedback.floodgate is undefined");const i=y.getActivityListener("stopFloodgate",e);null===i||void 0===i||i.logActivityStopTime(u,new Date),t.floodgate.stop()}}y.activityLogNamesBeforeInit=[],y.initFinished=!1,y.CUSTOM_SURVEY_STRINGS={},y.logFloodgateActivity=(e,t)=>{if(y.initFinished){const i=y.getActivityListener("logFloodgateActivity",t);null===i||void 0===i||i.logActivity(e)}else y.activityLogNamesBeforeInit.push(e)},y.uiStringMap=e=>y.CUSTOM_SURVEY_STRINGS[e]?y.CUSTOM_SURVEY_STRINGS[e]:"NA",y.onDismiss=(e,t,i)=>{const{traceLogger:o,usageLogger:n}=i,r=y.getOfficeBrowserFeedback("onDismiss",o),s=null===r||void 0===r?void 0:r.survey;if(t&&e===p.NPSCampaignId&&null!=s){const e="Rating",t=s.getComponent(e);switch(null===t||void 0===t?void 0:t.selectedIndex){case 0:n.logData(a.M.OCVFloodgate,a.M.NPSRating1);break;case 1:n.logData(a.M.OCVFloodgate,a.M.NPSRating2);break;case 2:n.logData(a.M.OCVFloodgate,a.M.NPSRating3);break;case 3:n.logData(a.M.OCVFloodgate,a.M.NPSRating4);break;case 4:n.logData(a.M.OCVFloodgate,a.M.NPSRating5)}}},y.getOfficeBrowserFeedback=(e,t)=>{const i=window.OfficeBrowserFeedback;return i||(t.logTrace(507778464,l.k.Warning,"OfficeBrowserFeedback not on window"),null)},y.getActivityListener=(e,t)=>{const i=y.getOfficeBrowserFeedback(e,t);if(!i)return null;if(!i.floodgate)return t.logTrace(507778463,l.k.Warning,"floodgate is not defined"),null;const o=i.floodgate.getEngine();if(!o)return t.logTrace(507778462,l.k.Warning,"engine is not defined"),null;const n=o.getActivityListener();return n||(t.logTrace(507778461,l.k.Warning,"activityListener is not defined"),null)}}}]);
//# sourceMappingURL=22514.7b423b7d.chunk.js.map