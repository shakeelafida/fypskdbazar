"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[1303],{11755:(e,t,r)=>{r.d(t,{K:()=>n});class n{constructor(e,t){this.skipTokenKey="@odata.nextLink",this.betaBaseUrl="beta/",this.v1BaseUrl="v1.0/",this._baseUrl=e,this.ajaxClient=t}}},77014:(e,t,r)=>{r.r(t),r.d(t,{GraphApi:()=>w});var n=r(45078),a=r(95783),o=r(11755),i=r(23918),s=r(92970),c=r(65818),u=r(50204),l=r(11910),d=r(54320),h=r.n(d),m=r(33411),p=r.n(m),g=r(98502),f=r(81704),y=r(61739);class w extends o.K{async getUnifiedGroupAsync(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"?").concat("$select=assignedLabels,autoSubscribeNewMembers,classification,description,displayName,id,mail,mailNickname,visibility"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUnifiedGroupAsync"}});try{const t=await r.clone().json();if(null==t)throw new Error("No unified group data returned");return t.id=e.groupId,s.E.builder.fromGraphResource(t).build()}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getMembersOfContainerAsync(e){switch(e.container.containerType){case c.K.Group:return await this.getMembersOfGroupAsync(e);case c.K.Roster:return await this.getMembersOfPlannerRosterAsync(e);default:return Promise.reject(g.g.generateAjaxClientError(new Response(n.MR.NotImplemented,{status:a.t3.NotImplemented,statusText:n.MR.NotImplemented})))}}async getUserAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"users/").concat(e.userId,"?$select=id,displayName,givenName,jobTitle,mail,preferredLanguage,surname,userPrincipalName,proxyAddresses,userType"),n=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUserAsync"}});try{const e=await n.clone().json();if(null==e)throw new Error("No data returned");return u.K.builder.fromGraphUserResource(e).build()}catch(a){throw g.g.generateAjaxClientError(n,a)}}async resolveUsersAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userIds"]);if(null!==t)return Promise.reject(t);const r=[];for(const n of e.userIds)r.push(this.getUserAsync({userId:n}));return await Promise.all(r)}async getConversationThreadAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupId","threadId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"groups/").concat(e.groupId,"/threads/").concat(e.threadId,"/posts"),n=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getConversationThreadAsync"}});try{const t=await n.clone().json();if(null==t)throw new Error("No conversation thread data returned");const r=t.value;return p()(r,(t=>l.L.builder.fromGraphPostResource(t,e.threadId).build()))}catch(a){throw g.g.generateAjaxClientError(n,a)}}async getUserPhoto(e){const t="".concat(this._baseUrl,"users/").concat(e.user.id,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUserPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getGroupPhoto(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getGroupPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getDriveItem(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"drives/").concat(e.driveId,"/items/").concat(e.itemId),n=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getDriveItem"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await n.clone().json();if(null==e)throw new Error("No drive item returned");return i.Y.builder.fromGraphDriveItemResource(e).build()}catch(a){throw g.g.generateAjaxClientError(n,a)}}async getGroupDocumentsInFolderPaged(e,t){const r=g.g.validateAjaxClientRequestParameters(e,["groupId"]);if(null!==r)return Promise.reject(r);const n=e.folderId?"/items/".concat(e.folderId,"/children"):"/root/children",a=e.skipToken||"".concat(this._baseUrl,"groups/").concat(e.groupId,"/drive").concat(n),o=await this.ajaxClient.executeRequest(a,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getGroupDocumentsInFolderPaged"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await o.clone().json();if(null==e)throw new Error("No group documents returned");const t=e.value;return{data:p()(t,(e=>i.Y.builder.fromGraphDriveItemResource(e).build())),skipToken:(0,y.n0)(e[this.skipTokenKey])}}catch(s){throw g.g.generateAjaxClientError(o,s)}}async getDriveItemThumbnail(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"/drive/root:/").concat(e.itemPath,":/thumbnails/0/large/url"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getDriveItemThumbnail"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().json(),t=e?e.value:null;if(!t)throw new Error("No item thumbnail url returned");return t}catch(n){throw g.g.generateAjaxClientError(r,n)}}async shareDriveItemAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId","userIds"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"drives/").concat(e.driveId,"/items/").concat(e.itemId,"/invite"),o=[];for(const n of e.userIds){const e={objectId:n};o.push(e)}const i={recipients:o,requireSignIn:!0,sendInvitation:!1,roles:["write"]};await this.ajaxClient.executeRequest(r,{method:a.PJ.Post,mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"shareDriveItemAsync"},body:JSON.stringify(i),headers:{[n.Lr.ContentType]:n.Mq.Json}})}async checkCurrentUserToGroupsMembershipsAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupIds"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"me/checkMemberGroups"),o={groupIds:e.groupIds},i=await this.ajaxClient.executeRequest(r,{method:a.PJ.Post,mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"checkCurrentUserToGroupsMembershipsAsync"},body:JSON.stringify(o),headers:{[n.Lr.ContentType]:n.Mq.Json}});try{const e=await i.clone().json();if(null==e)return Promise.reject(g.g.generateAjaxClientError(i,"No group ids returned"));let t=[];return e.value&&(t=e.value),t}catch(s){throw g.g.generateAjaxClientError(i,s)}}async getMembersOfGroupAsync(e){let t="".concat(this._baseUrl,"groups/").concat(e.container.externalId,"/members?$select=proxyAddresses,id,displayName,givenName,mail,preferredLanguage,surname,userPrincipalName,jobTitle,userType");h()(e.skipToken)||(t="".concat(t,"&$skiptoken=").concat(e.skipToken));const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getMembersOfGroupContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,n=(0,y.Cx)(e[this.skipTokenKey]);return{data:p()(t,(e=>u.K.builder.fromGraphUserResource(e).build())),skipToken:n}}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getMembersOfPlannerRosterAsync(e){let t="".concat(this.betaBaseUrl,"planner/rosters/").concat(e.container.externalId,"/members?$select=userId");h()(e.skipToken)||(t="".concat(t,"&$skiptoken=").concat(e.skipToken));const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getMembersOfRosterContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,n=(0,y.Cx)(e[this.skipTokenKey]),a=await Promise.all(p()(t,(e=>this.getUserAsync({userId:e.userId}))));return{data:a,skipToken:n}}catch(n){throw g.g.generateAjaxClientError(r,n)}}appendSharepointAuthenticationChallengeHeaders(e){return e[n.Er.AuthenticationChallengeHeaderName]=n.Er.AuthenticationChallengeHeaderValue,e}}w.apiName="GraphApi"},81704:(e,t,r)=>{r.d(t,{Vj:()=>c});var n=r(95783),a=r(34677),o=r.n(a),i=r(38752),s=r(98502);function c(e){return o()({maxRetryCount:i.B.clientSettings.RetrySettings.MaxRetryCount,maxRetryTimeoutInMiliseconds:i.B.clientSettings.RetrySettings.MaxRetryTimeout,delayOnRetryInMiliseconds:i.B.clientSettings.RetrySettings.RetryDelay,retryCheck:u},e)}async function u(e,t,r){return(null==e.method||e.method.toUpperCase()===n.PJ.Get)&&s.g.isRetryableResponse(t,r)}},61739:(e,t,r)=>{r.d(t,{Cx:()=>o,Ny:()=>i,n0:()=>s});var n=r(54320),a=r.n(n);function o(e){let t="";if(!a()(e))try{t=new URLSearchParams(new URL(e).search).get("$skiptoken")||""}catch(r){}return t}function i(e,t){return"startswith(".concat(e,", '").concat(encodeURIComponent(t).replace(/'/g,"''"),"')")}function s(e){const t="https://graph.microsoft.com/";return e&&0===e.indexOf(t)&&(e=e.substring(28)),e}},91675:(e,t,r)=>{r.d(t,{t:()=>n});var n={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}},23918:(e,t,r)=>{r.d(t,{Y:()=>f});var n=r(91675),a=r(51171),o=r(57718),i=r(86178),s=r.n(i),c=r(14983),u=function(){function e(){this.id=o.cM(),this.name="",this.fileType=c.Er.Other,this.url="",this.modifiedDate=s()(),this.childCount=-1,this.itemPath="/drive/root:"}return e.prototype.build=function(){return new f(this)},e.prototype.withPropertyBag=function(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.fileType=e.fileType||this.fileType,this.url=e.url||this.url,this.modifiedDate=e.modifiedDate||this.modifiedDate,this.childCount=void 0!==e.childCount?e.childCount:this.childCount,this.itemPath=e.itemPath||this.itemPath,this},e.prototype.withDefaultValues=function(){return this.withPropertyBag({id:"driveItemId",name:"Item1",fileType:c.Er.Other,url:"driveItemUrl",modifiedDate:s()(),itemPath:"/drive/root:",childCount:-1})},e.prototype.fromGraphDriveItemResource=function(e){return this.withPropertyBag({id:e.id,name:e.name,fileType:e.folder?c.Er.Other:e.package?f.GetType(e.package.type):f.GetFileType(e.name),url:e.webUrl,modifiedDate:s()(e.lastModifiedDateTime),childCount:e.folder?e.folder.childCount:-1,itemPath:e.parentReference.path})},e}(),l=r(98990),d=r.n(l),h=r(55491),m=r.n(h),p=r(54320),g=r.n(p),f=function(){function e(e){if(g()(e.id))throw new a.L("id");if(g()(e.name))throw new a.L("name");if(g()(e.url))throw new a.L("url");this.id=e.id,this.name=e.name,this.url=e.url,this.fileType=e.fileType,this.description=e.description,this.modifiedDate=e.modifiedDate,this.childCount=e.childCount,this.itemPath=e.itemPath}return Object.defineProperty(e,"builder",{get:function(){return new u},enumerable:!1,configurable:!0}),e.GetType=function(e){switch(e.toLowerCase()){case"excel":return c.Er.Excel;case"onenote":return c.Er.OneNote;case"pdf":return c.Er.Pdf;case"powerpoint":return c.Er.PowerPoint;case"project":return c.Er.Project;case"visio":return c.Er.Visio;case"word":return c.Er.Word;case"loop":return c.Er.Loop;default:return c.Er.Other}},e.GetFileType=function(t){var r=c.Er.Other,a=t.slice(t.lastIndexOf(".")+1);return m()(n.t,(function(t,n){d()(t,(function(e){return e.toLowerCase()===a.toLowerCase()}))&&(r=e.GetType(n))})),r},e}()},57718:(e,t,r)=>{function n(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16)}return t}r.d(t,{cM:()=>a});function a(){var e=[];e.push(n(8)),e.push(n(4));var t="4"+n(3);e.push(t);var r=n(4),a=parseInt(r[0],16);return a&=3,r=(a|=8).toString(16)+r.substr(1),e.push(r),e.push(n(12)),e.join("-")}}}]);
//# sourceMappingURL=graphapi.b86f27b4.chunk.js.map