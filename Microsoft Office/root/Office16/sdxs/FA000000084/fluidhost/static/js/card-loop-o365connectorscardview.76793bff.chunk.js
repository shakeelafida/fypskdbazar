"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82689],{47137:(e,t,n)=>{n.d(t,{V:()=>r});var a=n(6326),o=n(48612);const r=(e,t,n,r,i,l,c,s,d,u)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{verificationStatus:a}=n;if(t&&"Unknown"===a&&"Installed"===e&&n.signature)try{if(!n.updateExtension)throw l.logEvent("error","NoUpdateExtensionFound",{message:"No update extension found while verifying cards"}),new Error("No update extension found");const t={cardId:n.cardId,metaOSAppId:n.appId,signature:n.signature,content:JSON.stringify(n.payload),verificationStatus:n.verificationStatus,extension:{updateExtendedProps:{type:"updateExtendedProps",data:Object.assign(Object.assign({},n.updateExtension.data),{contentType:n.cardType})}}};if("function"===typeof r.cardVerify){const a=function(e){return e.cards[0].verificationStatus}(yield r.cardVerify(t));c(a),(0,o.l)(n.appId,e,a,i,d,s,u)}}catch(m){}}))},26901:(e,t,n)=>{n.d(t,{Al:()=>r,Iq:()=>l,Md:()=>d,WK:()=>i,gy:()=>c});var a=n(82381);const o="medium";function r(e,t){try{const n=/^\/l\/stage\/([^/]+)\/([^/]+)$/,a=e.pathname.match(n);if(3!==(null===a||void 0===a?void 0:a.length)||!a[1]||a[1]!==t){const e=new Error("Invalid StageView deep link");throw e.name="StageViewDeepLinkParseError",e}const o=t,r=e.searchParams.get("context"),i=decodeURIComponent(null!==r&&void 0!==r?r:"");return{appId:t,deepLinkAppId:o,stageInfo:JSON.parse(i)}}catch(n){const e=new Error((0,a.r)(n,"Unable to parse StageView deep link"));throw e.name="StageViewDeepLinkParseError",e}}function i(e,t){var n,r,i,l,c,d;try{const a=/^\/l\/task\/([^/]+)$/,u=e.pathname.match(a);if(2!==(null===u||void 0===u?void 0:u.length)||!u[1]||u[1]!==t){const e=new Error("Invalid TaskModule deep link");throw e.name="TaskModuleDeepLinkParseError",e}const m=e.searchParams.get("card");return{appId:t,taskInfo:{title:null!==(n=e.searchParams.get("title"))&&void 0!==n?n:void 0,width:s(null!==(r=e.searchParams.get("width"))&&void 0!==r?r:o),height:s(null!==(i=e.searchParams.get("width"))&&void 0!==i?i:o),url:null!==(l=e.searchParams.get("url"))&&void 0!==l?l:void 0,card:m?JSON.parse(m):void 0,fallbackUrl:null!==(c=e.searchParams.get("fallbackUrl"))&&void 0!==c?c:void 0,completionBotId:null!==(d=e.searchParams.get("completionBotId"))&&void 0!==d?d:void 0}}}catch(u){const e=new Error((0,a.r)(u,"Unable to parse TaskModule deep link"));throw e.name="TaskModuleDeepLinkParseError",e}}function l(e){return e.startsWith("https://teams.microsoft.com/l/stage")}function c(e){return e.startsWith("https://teams.microsoft.com/l/task")}function s(e){let t="medium";if("string"===typeof e)switch(e=e.toLowerCase()){case"small":case"medium":case"large":t=e;break;default:t=o}else"number"===typeof e&&(t=e);return t}function d(e,t){var n,a;let o;if("StageView"===t?o=null===(n=null===e||void 0===e?void 0:e.stageInfo)||void 0===n?void 0:n.websiteUrl:"TaskModule"===t&&(o=null===(a=null===e||void 0===e?void 0:e.taskInfo)||void 0===a?void 0:a.fallbackUrl),!o){const e=new Error("Fallback url is empty");throw e.name="OpenUrlActionError",e}return new URL(o)}},28144:(e,t,n)=>{n.d(t,{X:()=>c});var a=n(82381),o=n(26901);const r="noopener noreferrer";function i(e){return"http:"===e.protocol.toLowerCase()||"https:"===e.protocol.toLowerCase()?(window.open(e,"_blank",r),Promise.resolve(!0)):Promise.resolve(!1)}var l=n(46675);function c(e,t,n,r,c,s,d){var u,m;let p="OpenUrl";try{if(!t||!(0,l.A)(t)){const e=new Error("Action url is empty or invalid");throw e.name="OpenUrlActionError",e}let a=new URL(t);if((0,o.Iq)(t)){p="StageView",c.logEvent("info","OpenUrlActionClicked",{actionType:p});const t=null===s||void 0===s?void 0:s.getCustomProperty("deepLinkPayload"),n=null!==t&&void 0!==t?t:(0,o.Al)(a,e);if(!n){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof r.openStageView)return n.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(u=r.openStageView)||void 0===u||u.call(r,n));c.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: openStageView; OpenUrlActionType: ".concat(p)}),a=(0,o.Md)(n,p)}else if((0,o.gy)(t)){p="TaskModule",c.logEvent("info","OpenUrlActionClicked",{actionType:p});const t=null===s||void 0===s?void 0:s.getCustomProperty("deepLinkPayload"),n=null!==t&&void 0!==t?t:(0,o.WK)(a,e);if(!n){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof r.launchTaskModule)return n.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(m=r.launchTaskModule)||void 0===m||m.call(r,n));c.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: launchTaskModule; OpenUrlActionType: ".concat(p)}),a=(0,o.Md)(n,p)}c.logEvent("info","OpenUrlActionClicked",{actionType:p}),n?n.onClick(a).then((e=>{e||i(a)})):i(a)}catch(v){c.logEvent("error","OpenUrlActionExecutionError",{actionType:p,message:(0,a.r)(v,"Error while executing OpenUrl action")})}}},81536:(e,t,n)=>{n.d(t,{v:()=>a});const a=(e,t,n)=>t?"Installed"===e&&"Success"===n?"Full":"None":"Full"},50317:(e,t,n)=>{function a(e){return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0}n.d(t,{u:()=>a})},46675:(e,t,n)=>{function a(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(t){return!1}}n.d(t,{A:()=>a})},43632:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var a,o=n(41851),r=n(94308),i=n(24720),l=n(64867),c=n(92964),s=n(47137),d=n(50317),u=n(1720),m=n(13569),p=n(25055),v=n(99375),f=n(17122),y=n(65043);!function(e){e.activityImage="o365-connector-card-activity-image",e.activityTitle="o365-connector-card-activity-title",e.buttons="o365-connector-card-buttons",e.facts="o365-connector-card-fact",e.images="o365-connector-card-images",e.sectionTitle="o365-connector-card-section-title",e.title="o365-connector-card-title"}(a||(a={}));var h,g,k=n(35427);!function(e){e.Android="android",e.Default="default",e.IOS="iOS",e.Windows="windows"}(h||(h={})),function(e){e.OpenUri="OpenUri",e.ViewAction="ViewAction",e.HttpPOST="HttpPOST",e.ActionCard="ActionCard"}(g||(g={}));const E=e=>{switch(e["@type"]){case g.OpenUri:return{type:"openUrl",title:e.name,value:w(e)};case g.ViewAction:return{type:"openUrl",title:e.name,value:null===e||void 0===e?void 0:e.target[0]};case g.ActionCard:case g.HttpPOST:default:return{type:"unknown",title:e.name,value:""}}},w=e=>{var t;const n=null===(t=null===e||void 0===e?void 0:e.targets)||void 0===t?void 0:t.find((e=>e.os===h.Default));return(null===n||void 0===n?void 0:n.uri)||""},C=y.memo((e=>{let{actions:t,buttonClassName:n,containerClassName:o,onClick:r,payload:i}=e;return y.createElement(f.B,{horizontal:!0,wrap:!0,tokens:{childrenGap:20},className:o},t.map(((e,t)=>y.createElement(f.B.Item,{key:t},y.createElement(k.r,{className:n,"data-tid":a.buttons,action:E(e),onClick:r,key:t,payload:i})))))}));C.displayName="O365ConnectorCardButtonContainer";var S=n(27663),N=n(97972),I=n(10615);const O=y.memo((e=>{const{fact:t,factClassName:n,textClassName:o}=e;return y.createElement(f.B,{horizontal:!0,tokens:{childrenGap:10}},y.createElement(I.E,{"data-tid":a.facts,className:n},y.createElement(N.I,{content:null===t||void 0===t?void 0:t.name})),y.createElement(p.F,{className:o,content:null===t||void 0===t?void 0:t.value}))}));O.displayName="O365ConnectorCardFactRenderer";const T=y.memo((e=>{var t,n,o,r;const{section:i,styles:l,payload:c,onCardAction:s}=e,u=(0,d.u)(i.images)?null===(t=i.images)||void 0===t?void 0:t.map(((e,t)=>y.createElement(f.B.Item,{key:t},y.createElement("div",null,e.image?y.createElement(S._,{key:t.toString(),src:e.image,"data-tid":a.images,height:160,width:160}):null)))):null,m=(0,d.u)(i.facts)?null===(n=i.facts)||void 0===n?void 0:n.map(((e,t)=>y.createElement(f.B.Item,{key:t},y.createElement(O,{factClassName:l.factName,textClassName:l.cardText,fact:e})))):null,v=i.potentialAction&&y.createElement(C,{actions:i.potentialAction,buttonClassName:l.cardButton,containerClassName:l.buttonStack,onClick:s,payload:c});return y.createElement(f.B,{tokens:{childrenGap:10}},y.createElement(p.F,{className:l.cardSubTitle,content:null===(o=null===e||void 0===e?void 0:e.section)||void 0===o?void 0:o.title,datatid:a.sectionTitle}),y.createElement(b,Object.assign({},e)),y.createElement(p.F,{className:l.cardText,content:null===(r=null===e||void 0===e?void 0:e.section)||void 0===r?void 0:r.text}),m,y.createElement(f.B,{horizontal:!0,tokens:{childrenGap:10},wrap:!0},u),v)}));T.displayName="O365ConnectorCardSectionRenderer";const b=e=>{const{section:t,styles:n}=e;return y.createElement(f.B,{horizontal:!0,tokens:{childrenGap:10}},t.activityImage?y.createElement(S._,{key:t.activityImage,src:t.activityImage,"data-tid":a.activityImage,height:52,width:52}):null,y.createElement(f.B,{tokens:{childrenGap:10}},y.createElement(p.F,{className:n.cardSubTitle,content:null===t||void 0===t?void 0:t.activityTitle,datatid:a.activityTitle}),y.createElement(p.F,{className:n.cardSubTitle,content:t.activitySubtitle}),y.createElement(p.F,{className:n.cardText,content:t.activityText})))},A=()=>{const{cardData:e,isVerificationRequired:t,appStatus:n}=(0,o.f)(),{baseCardPerfMarker:h,logger:g}=(0,r.g)(),{cardChannelProvider:k,metaOSProvider:E,urlHandlerProvider:w}=(0,i.g)(),{setAppStatus:S,setMessageData:N,setVerificationStatus:I}=(0,l.t)(),{theme:O}=(0,c.d)(),b=(0,v.eO)(),A=e.payload,P=A.potentialAction,U=(0,u.u)(n,t,e.appId,e.verificationStatus,w,E,S,N,g,b),x=(0,m.O)(O),V=(0,d.u)(A.sections)?A.sections.map(((e,t)=>y.createElement(f.B.Item,{key:t},y.createElement(T,{section:e,styles:x,onCardAction:U,payload:A})))):null;return y.useEffect((()=>{h.end(!0)}),[h]),y.useEffect((()=>{(0,s.V)(n,t,e,k,E,g,I,N,S,b)}),[n,k,e,t,E,S,N,I,b]),y.createElement(f.B,{tokens:{childrenGap:10},className:x.cardStack},y.createElement(p.F,{className:x.cardTitle,content:null===A||void 0===A?void 0:A.title,datatid:a.title}),y.createElement(p.F,{className:x.cardText,content:null===A||void 0===A?void 0:A.text}),V,P&&y.createElement(C,{actions:P,buttonClassName:x.cardButton,containerClassName:x.buttonStack,onClick:U,payload:A}))}},35427:(e,t,n)=>{n.d(t,{r:()=>r});var a=n(11638),o=n(65043);const r=o.memo((e=>{const t=o.useRef(!1),{action:n,className:r,onClick:i}=e,[l,c]=o.useState(!1),s=o.useCallback((e=>t.current&&c(e)),[]);o.useEffect((()=>(t.current=!0,()=>{t.current=!1})),[]);const d=o.useCallback((e=>{try{e.stopPropagation(),s(!0),i(n)}catch(t){}finally{s(!1)}}),[i,n,s]);return o.createElement(a.Y,{className:r,text:n.title,disabled:l,onClick:d})}));r.displayName="CardButton"},1720:(e,t,n)=>{n.d(t,{u:()=>i});var a=n(81536),o=n(28144),r=n(48612);const i=(e,t,n,i,l,c,s,d,u,m)=>p=>{switch((0,a.v)(e,t,i)){case"Full":"openUrl"===p.type&&(0,o.X)(n,p.value,l,c,u);break;case"None":case"Limited":(0,r.l)(n,e,i,c,s,d,m)}}}}]);
//# sourceMappingURL=card-loop-o365connectorscardview.76793bff.chunk.js.map