"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[72806],{85633:(e,t,n)=>{n.d(t,{j:()=>a});var i=n(65043),o=n(57987),a=function(){var e=(0,o.d)({});return i.useEffect((function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];clearTimeout(i)}}}),[e]),(0,o.d)({setTimeout:function(t,n){var i=setTimeout(t,n);return e[i]=1,i},clearTimeout:function(t){delete e[t],clearTimeout(t)}})}},24369:(e,t,n)=>{var i;n.d(t,{H:()=>i}),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(i||(i={}))},11660:(e,t,n)=>{n.d(t,{S:()=>S});var i=n(65804),o=n(6326),a=n(65043),r=n(33516),s=n(89379),l=n(24718);var c=n(69451),d=n(27480),m=n(78233),u=n(32824),h=n(17066),p=n(72799),v=n(75215),f=n(50840),g=n(6017),y=(0,s.Z)(),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"===typeof e.content?a.createElement("p",{className:t._classNames.subText},e.content):a.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,i=e.directionalHint,r=e.directionalHintForRTL,s=e.styles,l=e.id,c=e.maxWidth,d=e.onRenderContent,m=void 0===d?this._onRenderContent:d,u=e.targetElement,p=e.theme;return this._classNames=y(s,{theme:p,className:t||n&&n.className,beakWidth:n&&n.isBeakVisible?n.beakWidth:0,gapSpace:n&&n.gapSpace,maxWidth:c}),a.createElement(f.P,(0,o.__assign)({target:u,directionalHint:i,directionalHintForRTL:r},n,(0,h.G1)(this.props,h.JM,["id"]),{className:this._classNames.root}),a.createElement("div",{className:this._classNames.content,id:l,onFocus:this.props.onFocus,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},m(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:g.A.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(a.Component),T=(0,i.I)(C,(function(e){var t=e.className,n=e.beakWidth,i=void 0===n?16:n,o=e.gapSpace,a=void 0===o?0:o,s=e.maxWidth,l=e.theme,c=l.semanticColors,d=l.fonts,m=l.effects,u=-(Math.sqrt(i*i/2)+a)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,r.lw.fadeIn200,{background:c.menuBackground,boxShadow:m.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:u,left:u,right:u,top:u,zIndex:0}}},t],content:["ms-Tooltip-content",d.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"}),w=n(24369),P=n(82014),b=n(19487),_=(0,s.Z)(),x=function(e){function t(n){var i=e.call(this,n)||this;return i._tooltipHost=a.createRef(),i._defaultTooltipId=(0,l.O)("tooltip"),i.show=function(){i._toggleTooltip(!0)},i.dismiss=function(){i._hideTooltip()},i._getTargetElement=function(){if(i._tooltipHost.current){var e=i.props.overflowMode;if(void 0!==e)switch(e){case v.$.Parent:return i._tooltipHost.current.parentElement;case v.$.Self:return i._tooltipHost.current}return i._tooltipHost.current}},i._onTooltipFocus=function(e){i._ignoreNextFocusEvent?i._ignoreNextFocusEvent=!1:i._onTooltipMouseEnter(e)},i._onTooltipContentFocus=function(e){t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,i._clearDismissTimer(),i._clearOpenTimer()},i._onTooltipBlur=function(e){var t;i._ignoreNextFocusEvent=(null===(t=(0,b.LW)(i.context))||void 0===t?void 0:t.activeElement)===e.target,i._dismissTimerId=i._async.setTimeout((function(){i._hideTooltip()}),0)},i._onTooltipMouseEnter=function(e){var n,o=i.props,a=o.overflowMode,r=o.delay,s=(0,b.LW)(i.context);if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,void 0!==a){var l=i._getTargetElement();if(l&&(!function(e){return e.clientWidth<e.scrollWidth}(n=l)&&!function(e){return e.clientHeight<e.scrollHeight}(n)))return}if(!e.target||!(0,c.s)(e.target,i._getTargetElement(),s))if(i._clearDismissTimer(),i._clearOpenTimer(),r!==w.H.zero){var d=i._getDelayTime(r);i._openTimerId=i._async.setTimeout((function(){i._toggleTooltip(!0)}),d)}else i._toggleTooltip(!0)},i._onTooltipMouseLeave=function(e){var n=i.props.closeDelay;i._clearDismissTimer(),i._clearOpenTimer(),n?i._dismissTimerId=i._async.setTimeout((function(){i._toggleTooltip(!1)}),n):i._toggleTooltip(!1),t._currentVisibleTooltip===i&&(t._currentVisibleTooltip=void 0)},i._onTooltipKeyDown=function(e){(e.which===d.c.escape||e.ctrlKey)&&i.state.isTooltipVisible&&(i._hideTooltip(),e.stopPropagation())},i._clearDismissTimer=function(){i._async.clearTimeout(i._dismissTimerId)},i._clearOpenTimer=function(){i._async.clearTimeout(i._openTimerId)},i._hideTooltip=function(){i._clearOpenTimer(),i._clearDismissTimer(),i._toggleTooltip(!1)},i._toggleTooltip=function(e){i.state.isTooltipVisible!==e&&i.setState({isTooltipVisible:e},(function(){return i.props.onTooltipToggle&&i.props.onTooltipToggle(e)}))},i._getDelayTime=function(e){switch(e){case w.H.medium:return 300;case w.H.long:return 500;default:return 0}},(0,m.f)(i),i.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},i}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,i=e.content,s=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,d=e.id,m=e.setAriaDescribedBy,p=void 0===m||m,v=e.tooltipProps,f=e.styles,g=e.theme;this._classNames=_(f,{theme:g,className:c});var y=this.state.isTooltipVisible,C=d||this._defaultTooltipId,w=(0,o.__assign)((0,o.__assign)({id:"".concat(C,"--tooltip"),content:i,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:l,calloutProps:(0,u.kp)({},t,{onDismiss:this._hideTooltip,onFocus:this._onTooltipContentFocus,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},(0,h.G1)(this.props,h.JM,["id"])),v),P=(null===v||void 0===v?void 0:v.onRenderContent)?v.onRenderContent(w,(function(e){return(null===e||void 0===e?void 0:e.content)?a.createElement(a.Fragment,null,e.content):null})):i,b=y&&!!P,x=p&&y&&P?C:void 0;return a.createElement("div",(0,o.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipFocus},{onBlurCapture:this._onTooltipBlur},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":x}),n,b&&a.createElement(T,(0,o.__assign)({},w)),a.createElement("div",{hidden:!0,id:C,style:r.dX},P))},t.prototype.componentDidMount=function(){this._async=new p.j(this)},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:w.H.medium},t.contextType=P._0,t}(a.Component),E={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},S=(0,i.I)(x,(function(e){var t=e.className,n=e.theme;return{root:[(0,r.Km)(E,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},75215:(e,t,n)=>{var i;n.d(t,{$:()=>i}),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(i||(i={}))},53734:(e,t,n)=>{n.r(t),n.d(t,{createPlannerLinkUnfurl:()=>yt,loopExport:()=>Ct,plannerLinkOptionalProviders:()=>gt});var i=n(40656),o=n(69817),a=n(43107),r=n(75368);const s={TokenProvider:"TokenProvider",...n(37828).y};var l=n(48680),c=n(65043),d=n(97950),m=n(7981),u=n(58370),h=n(14190),p=n(84083),v=n(93085),f=n(75923),g=n(52455),y=n(78769),C=n(40135),T=n(33516);const w="window",P=(0,T.Zq)({fill:"#CECECE",selectors:{[T.up]:{fill:w,...(0,T.Qg)()}}}),b=(0,T.Zq)({fill:"#F7F7F7",selectors:{[T.up]:{fill:w,...(0,T.Qg)()}}}),_=(0,T.Zq)({fill:"none",selectors:{[T.up]:{fill:"windowText",...(0,T.Qg)()}}}),x=function(e){return c.createElement("svg",{width:180,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,"aria-hidden":"true"},c.createElement("path",{className:P,d:"M0 0h180v16H0z"}),c.createElement("g",{filter:"url(#webChromeHeader_svg__filter0_i)"},c.createElement("path",{className:b,d:"M0 8h180v8H0z"})),c.createElement("path",{className:b,d:"M20 4a2 2 0 012-2h21a2 2 0 012 2v4H20V4z"}),c.createElement("g",{transform:"translate(-1, 2)"},c.createElement("path",{className:_,d:"M20 5v1h1V5h-1zM0 5V4h-1v1h1zm0 8h-1v1h1v-1zm180 0v1h1v-1h-1zm0-8h1V4h-1v1zM45 5h-1v1h1V5zM21 2a1 1 0 011-1v-2a3 3 0 00-3 3h2zm0 3V2h-2v3h2zM0 6h20V4H0v2zm1 7V5h-2v8h2zm179-1H0v2h180v-2zm-1-7v8h2V5h-2zM45 6h135V4H45v2zm-1-4v3h2V2h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM22 1h21v-2H22v2z"})),c.createElement("defs",null,c.createElement("filter",{id:"webChromeHeader_svg__filter0_i",x:0,y:8,width:180,height:8,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dy:-.5}),c.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.882353 0 0 0 0 0.882353 0 0 0 0 0.882353 0 0 0 1 0"}),c.createElement("feBlend",{in2:"shape",result:"effect1_innerShadow"}))))};var E=n(11660),S=n(24369),N=n(13706),k=n(50840),F=n(95225),L=n(51238);const I=function(e){return c.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},c.createElement("path",{d:"M6.25 10a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zm5 0a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zM15 11.25a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5z"}))},R=e=>{let{className:t}=e;return c.createElement("svg",{width:"28",height:"29",viewBox:"0 0 28 29",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t},c.createElement("g",{filter:"url(#filter0_dd)"},c.createElement("rect",{x:"2",y:"2",width:"24",height:"24",rx:"12",fill:"white"}),c.createElement("path",{d:"M14 8C17.3137 8 20 10.6863 20 14C20 15.6772 18.8661 17 17.5 17C16.748 17 16.2155 16.6446 15.89 16.0146C15.4563 16.6143 14.8056 17 14 17C12.4709 17 11.5 15.6104 11.5 14C11.5 12.3896 12.4709 11 14 11C14.5919 11 15.1002 11.2082 15.5009 11.5569L15.5 11.5C15.5 11.2239 15.7239 11 16 11C16.2455 11 16.4496 11.1769 16.4919 11.4101L16.5 11.5V14C16.5 15.3628 16.8534 16 17.5 16C18.2767 16 19 15.1562 19 14C19 11.2386 16.7614 9 14 9C11.2386 9 9 11.2386 9 14C9 16.7614 11.2386 19 14 19C14.4161 19 14.8249 18.9493 15.2202 18.8502L15.514 18.7668L15.719 18.6968C15.9784 18.6019 16.2655 18.7351 16.3605 18.9944C16.4554 19.2537 16.3222 19.5409 16.0628 19.6358C15.9814 19.6657 15.8992 19.6937 15.8164 19.72C15.2338 19.9049 14.623 20 14 20C10.6863 20 8 17.3137 8 14C8 10.6863 10.6863 8 14 8ZM14 12C13.1156 12 12.5 12.8811 12.5 14C12.5 15.1189 13.1156 16 14 16C14.8844 16 15.5 15.1189 15.5 14C15.5 12.8811 14.8844 12 14 12Z",fill:"#7635FF"})),c.createElement("defs",null,c.createElement("filter",{id:"filter0_dd",x:"0",y:"0",width:"28",height:"29",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",null),c.createElement("feGaussianBlur",{stdDeviation:"1"}),c.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),c.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),c.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dy:"1"}),c.createElement("feGaussianBlur",{stdDeviation:"1"}),c.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.14 0"}),c.createElement("feBlend",{mode:"normal",in2:"effect1_dropShadow",result:"effect2_dropShadow"}),c.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow",result:"shape"}))))},M=(0,T.Zq)({display:"flex"});const A=e=>e;!function(e){const{icons:t}=e,n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none",display:"flex",alignItems:"center"},icons:t};(0,T.qM)({disableWarnings:!0}),(0,T.K1)(n)}({icons:{FFXMoreHorizontal:c.createElement(I,{className:M}),FFXAtMention:c.createElement(R,{className:M})}});const U=(0,T.Zq)({display:"flex",alignItems:"center",justifyContent:"center"}),W=(D="#808080",(0,T.Zq)({selectors:{":hover, :active":{color:"#712DFF"}},borderRadius:6},U,{color:D}));var D;A("FFXMoreHorizontal");const H={iconName:A("FFXAtMention"),className:W};var V=n(6326),z=n(66783),B=(0,z.J9)((function(e,t,n,i){return{root:(0,T.Zq)("ms-ActivityItem",t,e.root,i&&e.isCompactRoot),pulsingBeacon:(0,T.Zq)("ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:(0,T.Zq)("ms-ActivityItem-personaContainer",e.personaContainer,i&&e.isCompactPersonaContainer),activityPersona:(0,T.Zq)("ms-ActivityItem-activityPersona",e.activityPersona,i&&e.isCompactPersona,!i&&n&&2===n.length&&e.doublePersona),activityTypeIcon:(0,T.Zq)("ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,i&&e.isCompactIcon),activityContent:(0,T.Zq)("ms-ActivityItem-activityContent",e.activityContent,i&&e.isCompactContent),activityText:(0,T.Zq)("ms-ActivityItem-activityText",e.activityText),commentText:(0,T.Zq)("ms-ActivityItem-commentText",e.commentText),timeStamp:(0,T.Zq)("ms-ActivityItem-timeStamp",e.timeStamp,i&&e.isCompactTimeStamp)}})),O="32px",q="16px",Z="16px",G="13px",$=(0,z.J9)((function(){return(0,T.i7)({from:{opacity:0},to:{opacity:1}})})),X=(0,z.J9)((function(){return(0,T.i7)({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}})})),K=(0,z.J9)((function(e,t,n,i,o,a){var r;void 0===e&&(e=(0,T.O4)());var s={animationName:T.T8.continuousPulseAnimationSingle(i||e.palette.themePrimary,o||e.palette.themeTertiary,"4px","28px","4px"),animationIterationCount:"1",animationDuration:".8s",zIndex:1},l={animationName:X(),animationIterationCount:"1",animationDuration:".5s"},c={animationName:$(),animationIterationCount:"1",animationDuration:".5s"},d={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},a&&n&&c],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},a&&n&&s],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:O,width:O,height:O},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:q,width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:O,fontSize:Z,lineHeight:Z,marginTop:"3px"},isCompactIcon:{height:q,minWidth:q,fontSize:G,lineHeight:G,color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(r={},r[T.up]={border:"none",margin:"0"},r)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},a&&n&&l],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}};return(0,T.TW)(d,t)})),j=n(76115),J=n(72721),Q=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e){return e.activityPersonas?n._onRenderPersonaArray(e):n.props.activityIcon},n._onRenderActivityDescription=function(e){var t=n._getClassNames(e),i=e.activityDescription||e.activityDescriptionText;return i?c.createElement("span",{className:t.activityText},i):null},n._onRenderComments=function(e){var t=n._getClassNames(e),i=e.comments||e.commentText;return!e.isCompact&&i?c.createElement("div",{className:t.commentText},i):null},n._onRenderTimeStamp=function(e){var t=n._getClassNames(e);return!e.isCompact&&e.timeStamp?c.createElement("div",{className:t.timeStamp},e.timeStamp):null},n._onRenderPersonaArray=function(e){var t=n._getClassNames(e),i=null,o=e.activityPersonas;if(o[0].imageUrl||o[0].imageInitials){var a=[],r=o.length>1||e.isCompact,s=e.isCompact?3:4,l=void 0;e.isCompact&&(l={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"}),o.filter((function(e,t){return t<s})).forEach((function(e,n){a.push(c.createElement(j.c,(0,V.__assign)({},e,{key:e.key||n,className:t.activityPersona,size:r?J.WH.size16:J.WH.size32,style:l})))})),i=c.createElement("div",{className:t.personaContainer},a)}return i},n}return(0,V.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,n=void 0===t?this._onRenderIcon:t,i=e.onRenderActivityDescription,o=void 0===i?this._onRenderActivityDescription:i,a=e.onRenderComments,r=void 0===a?this._onRenderComments:a,s=e.onRenderTimeStamp,l=void 0===s?this._onRenderTimeStamp:s,d=e.animateBeaconSignal,m=e.isCompact,u=this._getClassNames(this.props);return c.createElement("div",{className:u.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&c.createElement("div",{className:u.activityTypeIcon},d&&m&&c.createElement("div",{className:u.pulsingBeacon}),n(this.props)),c.createElement("div",{className:u.activityContent},o(this.props,this._onRenderActivityDescription),r(this.props,this._onRenderComments),l(this.props,this._onRenderTimeStamp)))},t.prototype._getClassNames=function(e){return B(K(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)},t}(c.Component);const Y=(0,T.Zq)({paddingTop:"12px",paddingBottom:"12px",paddingLeft:"4px",paddingRight:"4px",cursor:"default",border:"1px solid transparent",selectors:{":hover":{backgroundColor:"#F5F5F5"}}});function ee(e){return c.createElement("div",null,e.activities.map((e=>c.createElement(Q,{...e,key:e.key,className:Y}))))}var te=n(83754),ne=n(22459);const ie="var(".concat(te.KM.MenuDivider,", #EBEBEB)"),oe={root:{border:"1px solid ".concat(ie),boxSizing:"border-box"},content:{position:"relative",color:te._D.TooltipText,backgroundColor:te._D.TooltipBackground,fontFamily:"var(".concat(te.Fq.FontFamilyBody,", ").concat(ne.cL.SegoeUi,")"),fontSize:"12px",maxHeight:"120px",maxWidth:"400px",overflow:"auto"}},ae=(0,T.Zq)({width:320,borderRadius:4}),re=e=>{const[t,{setFalse:n,toggle:i}]=(0,F.e)(!1),o="activityButton_".concat((0,L.A)()),a={styles:oe},r="TooltipId-".concat((0,L.A)());return c.createElement("div",{className:g.activityButtonContainerClassName(e.cardWidth)},c.createElement(E.S,{id:r,tooltipProps:a,content:"Click to see recent activity",hidden:t,closeDelay:S.H.medium},c.createElement(N.K,{id:o,className:g.activityButtonClassName(e.cardWidth),onClick:i,iconProps:H,role:"button","aria-label":"Activity","aria-describedby":r,"aria-haspopup":"true","aria-expanded":t})),t&&c.createElement(k.P,{className:ae,gapSpace:0,target:"#".concat(o),onDismiss:n,setInitialFocus:!0,role:"status","aria-live":"polite"},c.createElement(ee,{activities:e.activities})))};var se=n(217);const le=c.memo((e=>{const{cardState:t,cardWidth:n,showWebChromeHeader:i,src:o}=e,a=o===h.$?undefined:o;return c.createElement("div",{className:g.thumbnailContainerClassName(n),"data-automation-id":"UNFURL_CARD_ID_THUMBNAIL","aria-hidden":"true"},c.createElement("div",{className:g.thumbnailHolderClassName(t)},"Loaded"===t&&c.createElement(c.Fragment,null,i&&c.createElement(x,{className:g.webChromeHeaderClassName(n)}),c.createElement("img",{className:g.thumbnailClassName(n),src:a,alt:""}))))})),ce=c.memo((e=>{const t="Loading"===e.cardState?e.loadingText:"Unauthed"===e.cardState?e.unauthedText:e.title;return c.createElement("div",{className:g.titleBarClassName(e.cardWidth)},c.createElement("div",{className:g.logoContainerClassName(e.cardWidth),"aria-hidden":"true"},(0,p.Kw)(e.cardState,se.r.Card,e.logoSrc,e.unauthedLogoSrc)),c.createElement("span",{title:t,className:g.titleClassName(e.cardWidth),"data-automation-id":"UNFURL_CARD_ID_TITLE"},t))})),de=c.memo((e=>{const t=[{type:y.w.line}],n=[{type:y.w.line}];return c.createElement("div",{className:g.descriptionFadeClassName(e.cardWidth)},"Loading"===e.cardState||e.description===h.$?c.createElement("div",{className:g.descriptionShimmerContainerClassName(e.cardWidth)},c.createElement(C.W,{className:g.shimmerFirstRowClassName,shimmerElements:t}),c.createElement(C.W,{className:g.shimmerSecondRowClassName,shimmerElements:n})):"Loaded"===e.cardState?c.createElement("div",{title:e.description,className:g.descriptionClassName(e.cardWidth)},e.description):void 0)})),me=c.memo((e=>{const t="Unauthed"!==e.cardState&&!!e.description;return c.createElement("div",{className:g.contentContainerClassName(e.cardWidth)},c.createElement(ce,{cardWidth:e.cardWidth,cardState:e.cardState,logoSrc:e.logoSrc,title:e.title,unauthedLogoSrc:e.unauthedLogoSrc,loadingText:e.loadingText,unauthedText:e.unauthedText}),c.createElement(c.Fragment,null,t&&c.createElement(de,{cardWidth:e.cardWidth,cardState:e.cardState,description:e.description}),c.createElement("span",{title:e.fileMetadata,className:g.linkClassName(e.cardWidth)},e.fileMetadata)))})),ue=c.memo((e=>{var t;const n=null!==(t=e.cardState)&&void 0!==t?t:"Loaded",[i,o]=c.useState(e.cardWidth),a="Loading"===n||e.thumbnailSrc===h.$,r="Loaded"===n&&!!e.thumbnailSrc&&e.thumbnailSrc!==h.$,s=a||r,l=(0,f.w)((e=>{const t=e.contentRect.width,n=(i=t)&&i<=500&&i>250?"Half":i&&i<=250?"Third":"Full";var i;o(n)})),d=e.description===h.$?void 0:e.description;return c.createElement("div",{className:g.unfurlCardContainerClassName(i,n,s,!!e.description),ref:l},c.createElement("div",{className:g.embedCardClassName(i,n,s),tabIndex:0,role:"button","aria-describedby":d||e.title||e.link,onClick:e.onClick,onKeyDown:e.onKeyDown,onContextMenu:e.onClick,ref:e.parentRef,"data-automation-id":"UNFURL_CARD_ID_ARIA"},c.createElement("a",{href:e.link},c.createElement(me,{cardWidth:i,title:e.title,description:e.description,link:e.link,logoSrc:e.logoSrc,fileMetadata:e.fileMetadata,cardState:n,unauthedLogoSrc:e.unauthedLogoSrc,loadingText:e.loadingText,unauthedText:e.unauthedText})),s&&c.createElement(le,{cardWidth:i,cardState:n,showWebChromeHeader:e.showWebChromeHeader,src:e.thumbnailSrc})),e.activities&&e.activities.length>0&&"Loaded"===n&&c.createElement(re,{cardWidth:i,link:e.link,description:e.description,activities:e.activities}))}));var he=n(62573),pe=n(58593);const ve={name:"ffx-generic-links",icons:{FFXGlobe:c.createElement(pe.A,null)}};var fe=n(52018);const ge=he.Nr;(0,fe.y)(ve);const ye=c.memo((e=>{var t,n;const{url:i,metadata:o,logo:a,thumbnail:r,componentState:s,onClick:l,onKeyDown:d,viewMode:m}=e,u=c.useCallback((e=>{l(e)}),[l]),f=c.useCallback((e=>{d(e)}),[d]),g=function(e,t){if("Init"===e||t===h.$)return"Loading";if("AccessDenied"===e)return"Unauthed";if("NotFound"===e)return;return"Loaded"}(s,o),y=o===h.$?i:null!==(t=null===o||void 0===o?void 0:o.title)&&void 0!==t?t:i,C=o===h.$?i:null!==(n=null===o||void 0===o?void 0:o.description)&&void 0!==n?n:"",T="string"===typeof a?(0,p.Rm)(a):a;return"Pill"===m?c.createElement(v.EM,{title:y,cardState:g,link:i,logoSrc:T,loadingText:e.loadingText,unauthedText:y,unauthedLogoSrc:(0,p.XS)(ge("FFXGlobe")),onClick:u,onKeyDown:f,parentRef:e.unfurlViewRef}):c.createElement(ue,{title:y,description:C,link:i,thumbnailSrc:r,logoSrc:T,fileMetadata:i,cardWidth:"Full",cardState:g,onClick:u,onKeyDown:f,loadingText:e.loadingText,unauthedText:y,unauthedLogoSrc:(0,p.XS)(ge("FFXGlobe")),parentRef:e.unfurlViewRef})}));async function*Ce(e,t,n){let i=[];const o=e.map((e=>{const t=e.then((e=>{i.push(e)})).catch((t=>{null===n||void 0===n||n(e,t)})).finally((()=>{o.splice(o.indexOf(t),1)}));return t}));for(;o.length>0;)if(await Promise.race(o),t){if(0===i.length)continue;const e=i;i=[],yield e}else for(;i.length>0;){const e=i.shift();yield e}}var Te=n(75460),we=n(31360),Pe=n(76372);var be=n(4846),_e=n(45107);const xe=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null===e||void 0===e||!e.themeProperties)return{};let n=e.themeProperties;if(!function(e){var t;return!(null===e||void 0===e||null===(t=e.themeProperties)||void 0===t||!t.has("--colorNeutralForeground1"))}(e)){let e=be.c;if(t){const t=(0,_e.P)(n);e=e.concat(t),n=new Map(e.map((e=>[e.name,e.value])))}else n=new Map([...n,...new Map(e.map((e=>[e.name,e.value])))])}const i={};for(const[o,a]of n){i[o.startsWith("--")?o.slice(2):o]=a}return i};function Ee(e){let t;if(e)if("themeName"in e)t=e.themeName;else{var n;t=null===(n=e.themeProperties)||void 0===n?void 0:n.get("--ms-themeColorThemeName")}else t=void 0;switch(t){case"default":return"light";case"dark":return"dark";default:return}}function Se(e){let{theming:t,idPrefix:n,translateTheme:i=!0,...o}=e;const[a,r]=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=(0,c.useRef)(e),[i,o]=(0,c.useState)((()=>Ee(e))),[a,r]=(0,c.useState)((()=>xe(e,t)));return e!==n.current&&(n.current=e,r(xe(e,t)),o(Ee(e))),(0,c.useEffect)((()=>{if(!e)return;const n=()=>o(Ee(e)),i=()=>{r(xe(e,t)),n()};return e.on("themeNameChanged",n),e.on("themePropertiesChanged",i),()=>{e.off("themeNameChanged",n),e.off("themePropertiesChanged",i)}}),[e,t]),[i,a]}(t,i),s=c.useMemo((()=>({display:"contents",colorScheme:a,backgroundColor:"transparent",...o.style})),[a,o.style]),l=c.useMemo((()=>{return n+(e=1e4,e<=0?0:Math.floor(Math.random()*e)).toString();var e}),[n]);return c.createElement(we.LX,{value:l},c.createElement(Pe.q,{...o,"data-testid":"ComponentFluentProviderId",theme:r,style:s}))}class Ne extends m.L{async getCommandStrings(){return{copyLinkCommandDisplayName:this.strings.genericLinkCopyLinkCommandDisplayName,openLinkCommandDisplayName:this.strings.genericLinkOpenLinkCommandDisplayName}}async disposeView(){this.element&&(d.unmountComponentAtNode(this.element),delete this.element,this.providers.NamespaceLogger.send({category:"dispose",eventName:"DisposeView",viewMode:this.viewMode}))}getUrlAsString(){return this.urlData.url.href}async onLocaleUpdated(e){if(this.strings=e,this.element)return this.render(this.element)}convertViewTypeToCommonViewModeType(){switch(this.viewMode){case"Pill":return u.G.Pill;case"Card":return u.G.Card;default:throw Error("Unknown view mode")}}internalRender(e,t){const n={theming:this.providers.Theming,idPrefix:"genericLinkUnfurl-"};d.render(c.createElement(Se,n,c.createElement(ye,{unfurlViewRef:this.viewRef,url:this.getUrlAsString(),metadata:this.metadata,logo:this.getLogoSrc(),thumbnail:this.getThumbnailSrc(),componentState:t,onClick:this.onClickHandler,onKeyDown:this.onKeyDownHandler,loadingText:this.strings.genericLinkLoadingText,element:this.element,viewMode:this.viewMode})),e,(()=>this.renderCallback()))}async renderView(e){this.viewMode=this.isInline()?"Pill":"Card",this.renderLoadIncrementallyEnabled()||this.metadata!==h.$||this.internalRender(e,"Init"),(this.renderLoadIncrementallyEnabled()?this.renderIncrementally(e):this.renderIncrementallyLegacy(e)).then((()=>{this.timerExpired||this.endRenderingActivity(this.convertViewTypeToCommonViewModeType())})).catch((async e=>{}));return setTimeout((async()=>{this.metadata&&this.metadata!==h.$||(this.timerExpired=!0,this.addAdditionalProps({TimerExpired:!0}),this.internalRender(e,"Found"),this.endRenderingActivity(this.convertViewTypeToCommonViewModeType()))}),1e4),this.loadingRenderPromise}async renderIncrementally(e){const t=[this.loadMetadata(),this.loadLogo(),this.loadThumbnail(),this.startWithLoading()];for await(const n of Ce(t,!0)){const t=this.aggregateStates(n);this.internalRender(e,t)}}async renderIncrementallyLegacy(e){const t=[this.loadMetadata(),this.loadLogo(),this.loadThumbnail()];for await(const n of Ce(t,!1))this.internalRender(e,n)}async startWithLoading(){return Promise.resolve("Init")}async loadMetadata(){const e=await this.metadataPromise;return this.metadata=await e.metadata,e.componentState}async loadLogo(){const e=await this.metadataPromise;return this.logo=await e.favicon,e.componentState}async loadThumbnail(){const e=await this.metadataPromise;return this.thumbnail=await e.thumbnail,e.componentState}getLogoSrc(){return void 0===this.logo||this.logo===h.$?this.logo:this.logo.favicon}getThumbnailSrc(){return void 0===this.thumbnail||this.thumbnail===h.$?this.thumbnail:this.thumbnail.thumbnail}renderLoadIncrementallyEnabled(){return(0,l.AU)("loop.genericLinkUnfurlRenderLoadingIncrementally",!1,this.settingsProvider)}aggregateStates(e){return e.includes("AccessDenied")?"AccessDenied":e.includes("Unauthed")?"Unauthed":e.includes("NotFound")?"NotFound":e.includes("Found")?"Found":"Init"}renderCallback(){this.loadingRenderPromise.resolve(),this.endRenderingSubActivity()}constructor(e,t,n,i,o,a,r,s,l){super(e,n,i,a,r,"GenericLinkUnfurl",!1,l),this.strings=t,this.providers=n,this.metadataPromise=o,this.settingsProvider=s,this.viewMode="Card",this.metadata=h.$,this.logo=h.$,this.thumbnail=h.$,this.timerExpired=!1,this.loadingRenderPromise=new Te.c}}var ke=n(14525);let Fe;const Le=e=>n(71663)("./".concat(e,"/GenericLinkStrings.json"));function Ie(e){return async function(e,t){var n;return(null===(n=Fe)||void 0===n?void 0:n.locale)!==t&&(Fe={locale:t,stringTablePromise:e(t).then((e=>(0,ke.$)(e,t)))}),Fe.stringTablePromise}(Le,e)}var Re=n(33788),Me=n(83125),Ae=n(22884);const Ue={Production:{scopes:["https://urlp-v2.asm.skype.com/URLPreview.Generate"],urlToFetch:"https://urlp.asm.skype.com/v1/url/info"},Test:{scopes:["https://urlp.asm.skype.net/URLPreview.Generate"],urlToFetch:"https://urlp.asm.skype.net/v1/url/info"}},We={NoData:1,FailedToFetch:2,OfflineFetchFailure:3,FetchFailure:4},De={Info:1,Thumbnail:2,Favicon:3};var He=n(40635),Ve=n(97323),ze=n(95996);function Be(e){return e>=200&&e<300}async function Oe(e,t,n,i,o){let a;try{a=await fetch(e,n)}catch{return void Ke(window.navigator.onLine?We.FetchFailure:We.OfflineFetchFailure,t,!1,o,i)}if(!a.ok)return void Ke(a.status,t,!1,o,i);const r=await a.blob();return new Promise(((e,t)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.onerror=t,n.readAsDataURL(r)}))}function qe(e){return!!e.statusCode&&Be(Number(e.statusCode))}async function Ze(e,t,n,i,o){const a=Re.m.start("URLPreviewInfoRequest",o);let r;try{if(!await t)return;r=(await(0,He.y)(e)).result}catch{throw Ke(We.FailedToFetch,De.Info,!1,a,i),new Error("URL Preview API failed, likely due to token issue, without making a call")}if(!r.ok&&r.status>=300)throw Ke(r.status,De.Info,404===r.status,a,i),new Error("URL Preview API returned an error response");const s=function(e,t,n){var i,o,a;const r={url:null!==(i=e.url)&&void 0!==i?i:t,title:null!==(o=null!==(a=e.title)&&void 0!==a?a:e.url)&&void 0!==o?o:t,faviconUri:e.favicon&&Je(e.favicon)?e.favicon:void 0,faviconMeta:e.favicon_meta,thumbnailUri:e.thumbnail&&Je(e.thumbnail)?e.thumbnail:void 0,thumbnailMeta:e.thumbnail_meta,description:e.description,contentType:e.content_type,statusCode:e.status_code,site:e.site};(0,l.AU)("loopURLP.updateTitleWhenUnauthenticated",!0,n)&&(r.title=function(e,t){let n=e;if("sign in to your account"===n.toLowerCase()){const e=t.match(/https?:\/\/(?:www\.)?([^\/]+)/);e&&(n=e[1])}return n}(r.title,r.url));return r}(await r.json(),e.url,n);return qe(s)||a.addAdditionalProps({DataStatusCode:Number(s.statusCode)}),a.setResult(!0),s}async function Ge(e,t,n,i,o,a,r){if(!e)return void(null===a||void 0===a||a.addAdditionalProps({IsThumbnailUrlPresent:!1}));const s=await t,l=s.thumbnailMeta;if(!qe(s)||!s.thumbnailUri||!l)return void(null===a||void 0===a||a.addAdditionalProps({IsThumbnailUrlPresent:!1}));const c=await i,d=await o;if(!c||!d)return void(null===a||void 0===a||a.addAdditionalProps({IsThumbnailUrlPresent:!1}));const m=Re.m.start("URLPreviewThumbnailRequest",r);try{const e={...n.requestInit,headers:{Authorization:"Bearer ".concat(c)}},t=await Oe(je(s.thumbnailUri),De.Thumbnail,e,m);if(!t)return;return m.setResult(!0),null===a||void 0===a||a.addAdditionalProps({IsThumbnailUrlPresent:!0}),{thumbnail:t,thumbnailMeta:l}}catch(u){return void m.setResult(!1,void 0,u)}}async function $e(e,t,n,i,o,a,r){if(!e)return void(null===a||void 0===a||a.addAdditionalProps({IsFaviconUrlPresent:!1}));const s=await t,l=s.faviconMeta;if(!qe(s)||!s.faviconUri||!l)return void(null===a||void 0===a||a.addAdditionalProps({IsFaviconUrlPresent:!1}));const c=await i,d=await o;if(!c||!d)return void(null===a||void 0===a||a.addAdditionalProps({IsFaviconUrlPresent:!1}));const m=Re.m.start("URLPreviewFaviconRequest",r);try{const e={...n.requestInit,headers:{Authorization:"Bearer ".concat(c)}},t=await Oe(je(s.faviconUri),De.Favicon,e,m);if(!t)return;return m.setResult(!0),null===a||void 0===a||a.addAdditionalProps({IsFaviconUrlPresent:!0}),{favicon:t,faviconMeta:l}}catch(u){return void m.setResult(!1,void 0,u)}}function Xe(e,t,n,i,o,a,r){let s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],c=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const d=function(e,t){const n=encodeURIComponent(t),i="?url=".concat(n),o=Ue.Production;let a,r;const s={getToken:t=>(a&&r===t||(a=e.getToken(o.scopes,t),r=t),a),url:je(o.urlToFetch+i),requestInit:{method:"GET"}};return s}(e,t.url.href),m=async function(e,t,n){return function(e){return!!e}(e)&&await async function(e,t){if(!e)return!1;try{return await e.optionalConnectedExperiencesEnabled()}catch(n){t&&(0,ze.hO)(t,{eventName:"checkOCSError"},n)}return!1}(t,n)}(e,n,a),u=d.getToken().then((e=>e.token)).catch((e=>(a&&(0,ze.hO)(a,{eventName:"FailedToFetchToken"},e),null===o||void 0===o||o.addAdditionalProps({FailedToFetchToken:!0}),Promise.reject(e))));if(!c){const e=function(e,t,n,i,o,a,r){const s=null===r||void 0===r?void 0:r.loadCache();return s?(Qe(e,t,n,i,o,a,r).catch((()=>{})),null===o||void 0===o||o.addAdditionalProps({UsedMetadataCache:!0}),Promise.resolve(s.metadata)):Qe(e,t,n,i,o,a,r)}(d,t,m,i,o,a,r);return{metadata:e,favicon:$e(l,e,d,u,m,o,a),thumbnail:Ge(s,e,d,u,m,o,a)}}const h=function(e,t,n,i,o,a,r){const s={url:t.url.href,title:t.title||t.url.href},l=Ze(e,n,i,o,a).catch((e=>(null===o||void 0===o||o.setResult(!1,{message:"".concat(We.FailedToFetch,": ").concat(e)}),s))).then((e=>null!==e&&void 0!==e?e:s)),c=null===r||void 0===r?void 0:r.loadCache();if(null!==c&&void 0!==c&&c.metadata)return null===o||void 0===o||o.addAdditionalProps({UsedMetadataCache:!0}),{latest:l,fastest:Promise.resolve(c.metadata)};return{latest:l,fastest:l}}(d,t,m,i,o,a,r),p=function(e,t,n,i,o,a,r,s){const l=$e(e,t,n,i,o,a,r).catch((()=>{null===a||void 0===a||a.addAdditionalProps({IsFaviconUrlPresent:!1})})),c=null===s||void 0===s?void 0:s.loadCache();if(null!==c&&void 0!==c&&c.favicon)return null===a||void 0===a||a.addAdditionalProps({UsedFaviconCache:!0}),{latest:l,fastest:Promise.resolve(c.favicon)};return{latest:l,fastest:l}}(l,h.fastest,d,u,m,o,a,r),v=function(e,t,n,i,o,a,r,s){const l=Ge(e,t,n,i,o,a,r).catch((()=>{null===a||void 0===a||a.addAdditionalProps({IsThumbnailUrlPresent:!1})})),c=null===s||void 0===s?void 0:s.loadCache();if(null!==c&&void 0!==c&&c.thumbnail)return null===a||void 0===a||a.addAdditionalProps({UsedThumbnailCache:!0}),{latest:l,fastest:Promise.resolve(c.thumbnail)};return{latest:l,fastest:l}}(s,h.fastest,d,u,m,o,a,r);return r&&Promise.all([h.latest,p.latest,v.latest]).then((e=>{let[t,n,i]=e;r.saveCache({metadata:t,favicon:n,thumbnail:i})})).catch((()=>{})),{metadata:h.fastest,favicon:p.fastest,thumbnail:v.fastest}}function Ke(e,t,n,i,o){null===i||void 0===i||i.addAdditionalProps({ErrorCode:e}),null===i||void 0===i||i.setResult(n),null===o||void 0===o||o.addAdditionalProps({FailedRequest:t}),null===o||void 0===o||o.setResult(n)}function je(e){const t=new URL(e);return t.searchParams.set("origin",window.location.origin),t.href}function Je(e){return function(e){return e.startsWith("https://urlp.asm.skype.com/")||e.startsWith("https://urlp.sfbassets.com/urlpcdn/")||e.startsWith("https://ca-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://us-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://as-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://eu-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://fr-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://au-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://uk-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://in-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://jp-prod.asyncgw.teams.microsoft.com/")}(e)&&(0,Ve.C)(e)}async function Qe(e,t,n,i,o,a,r){const s={url:t.url.href,title:t.title||t.url.href};try{const t=await Ze(e,n,i,o,a);return t?(null===r||void 0===r||r.saveCache({metadata:t,favicon:void 0,thumbnail:void 0}),t):s}catch(l){return null===o||void 0===o||o.setResult(!1,{message:"".concat(We.FailedToFetch,": ").concat(l)}),s}}var Ye=n(44502),et=n(50264),tt=n(75717),nt=n(75704),it=n(27284),ot=n(75964);function at(e,t){return rt(e,t,new Set)}function rt(e,t,n){if(!(st(e)&&st(t)))return e===t;if(n.has(e)&&n.has(t))return!0;n.add(e),n.add(t);const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(const a of i){const i=e[a],o=t[a],r=st(i)&&st(o);if(r&&!rt(i,o,n)||!r&&i!==o)return!1}return!0}function st(e){return null!=e&&"object"===typeof e}function lt(e,t){return{loadCache:()=>null===e||void 0===e?void 0:e.urlPreview,saveCache:n=>function(e,t,n){if(at(null===n||void 0===n?void 0:n.urlPreview,t))return;e(JSON.stringify({...n,urlPreview:t}))}(t,n,e),clearCache:()=>t(void 0)}}const ct=(0,z.J9)((async e=>await Ie(e)));class dt extends Ae.J{get HTMLViewable(){return this}get IViewLayout(){return{canInline:!0,IViewLayout:this}}get ComponentPersistentInputDataV2(){return this}async getView(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Re.m.start("DurationComponentCreation",this.providers.NamespaceLogger),n=new Ne(this.urlData,await this.getStrings(),this.providers,this.ComponentClipboardProvider,this.metadataPromise,this.openLink,0===this.views.length,this.providers.SettingsProvider,e);return this.views.push(n),t.setResult(!0),this.augLoopSerializableHelpers.queueAddComponentToSessionModel(),n}async getPrintView(){return this.getView(!0)}onLocaleUpdated(){(async()=>{Promise.all(this.views.map((async e=>e.onLocaleUpdated(await this.getStrings())))).catch((()=>{}))})().catch((()=>{}))}on(e,t){return this.eventEmitter.on(e,t),this}off(e,t){return this.eventEmitter.off(e,t),this}async getStrings(){return await ct(this.contentLocale)}get ComponentProperties(){return this}constructor(e,t){super("GenericLinkUnfurl",e,t),this.providers=t,this.views=[],this.eventEmitter=new it.EventEmitter,this.experienceType="PreviewCard",this.iconUrl=void 0,this.name=void 0;const n=lt(function(e){if(e)return(0,ot.X)(e)}(e.componentPersistentInputData),(e=>this.eventEmitter.emit("onPersistentInitialDataChange",e)));this.metadataPromise=new nt.I((()=>async function(e,t,n,i,o,a){let r=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const s={componentState:"NotFound",metadata:Promise.resolve({url:e.url.href,title:e.title||e.url.href}),favicon:Promise.resolve(void 0),thumbnail:Promise.resolve(void 0)},l=Re.m.start("URLPreviewRequest",o);try{const c=Xe(t,e,n,i,l,o,a,!0,!0,r),d=await c.metadata,m=d.statusCode?Number(d.statusCode):-1;return Be(m)?(function(e,t){t.title&&t.title!==t.url.href&&(e.title=t.title)}(d,e),Promise.all([c.metadata,c.favicon,c.thumbnail]).then((()=>l.setResult(!0))).catch((()=>{})),{...c,metadata:Promise.resolve(d),componentState:"Found"}):(l.setResult(404===m,{message:We.NoData}),s)}catch{return l.setResult(!1,{message:We.FailedToFetch}),{componentState:"Unauthed",metadata:Promise.resolve({url:e.url.href,title:e.title||e.url.href}),favicon:Promise.resolve(void 0),thumbnail:Promise.resolve(void 0)}}}(this.urlData,t.TokenProvider,t.OfficePolicyProvider,t.SettingsProvider,t.NamespaceLogger,n,(0,l.AU)("loop.urlpFaviconThumbnailCache",!1,t.SettingsProvider))))}}async function mt(e,t){if(!t)throw Error("Missing providers");if(!(0,i.I)(e,r.kW))throw Error("Unexpected initial configuration");const[n,o,a,s,l,c,d,m,u,h]=await Promise.all([t.CommandingSurface,t.InternationalizationContext,t.NamespaceLogger,t.TokenProvider,t.LinkService,t.OfficePolicyProvider,t.CommandBarTreeViewProvider,t.UrlHandlerProvider,t.SettingsProvider,t.AugmentationSession]),p=a?new Me.p("GenericLinkUnfurl",a):new Ye.z;if(!s)throw Error("Missing TokenProvider");const v={CommandingSurface:n,InternationalizationContext:o,NamespaceLogger:p,TokenProvider:s,LinkService:null!==l&&void 0!==l?l:m?void 0:new et.D,OfficePolicyProvider:null!==c&&void 0!==c?c:new tt.S,CommandBarTreeViewProvider:d,UrlHandlerProvider:m,SettingsProvider:u,AugmentationSession:h};return new dt(e,v)}new o.q(mt,s,[],[a.X]);var ut=n(28184),ht=n(59190),pt=n(76899),vt=n(74844),ft=n(68639);const gt={UserContext:"UserContext",LoopTelemetrySink:"LoopTelemetrySink",TelemetryConfig:"TelemetryConfig",...s};async function yt(e,t){if(!t)throw Error("Missing Providers");let n;const[o,a,s,l,c,d]=await Promise.all([t.TokenProvider,t.UserContext,t.InternationalizationContext,t.SettingsProvider,t.LoopTelemetrySink,t.TelemetryConfig]);let m="";if((0,i.I)(e,r.kW))n=e;else{if(!o)throw Error("Missing Token Provider");m=await(0,ft.E)(o,a);const e={tokenProvider:o,tenantId:m},{url:t}=await(0,ut.pL)(e,null===s||void 0===s?void 0:s.uiLocale);n={creationData:{dataType:r.kW,data:{url:t}}}}const u={tenantId:m};return c&&!(0,ht.pk)(null===l||void 0===l?void 0:l.audience)&&(0,ht.$N)(c,(0,ht.eO)({userContext:u,settingsProvider:l,internationalizationContext:s,telemetryConfig:d})),(0,pt.Fr)()&&(0,ht.om)("LoopPlannerLink_createPlannerLinkUnfurl","Creating link chiclet for Planner Component in mobile",vt.k.Info),mt(n,t)}const Ct=new o.q(yt,gt,[],[a.X])}}]);
//# sourceMappingURL=72806.94b14fa1.chunk.js.map