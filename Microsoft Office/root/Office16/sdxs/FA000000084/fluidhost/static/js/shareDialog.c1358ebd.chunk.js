"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[94680],{36599:(e,t,r)=>{r.d(t,{P:()=>i});var n=r(65043),a=r(83545),o=r(48043);class i extends n.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){const t=new o.QW(a.NN.FluentUiError,e.stack,e.stack);this.props.onRenderPromise.reject(t),this.props.onCompletePromise.reject(t)}render(){if(!this.state.hasError)return this.props.children;alert(this.props.stringTable.fluentUiErrorTitle)}constructor(e){super(e),this.state={hasError:!1}}}},64681:(e,t,r)=>{r.d(t,{x:()=>f});var n=r(65043),a=r(40488),o=r(57433),i=r(33516),s=r(53015),d=r(83545),l=r(48043),c=r(44869),h=r(57426);const m="shareIframe",p="www.odwebp.svc.ms",u="https://".concat(p,"/share");let g;const f=n.memo((e=>{const{payloadPromise:t,onRenderPromise:r,onCompletePromise:i,stringTable:s,perfMarks:d,localization:h,renderState:f,setRenderState:b,onIframeDismiss:k,useEnterpriseEndpoint:S,shareMode:C}=e,[x,P]=n.useState(void 0),[D,L]=n.useState({width:(0,c._5)(c.Ic),height:c.GB}),T=n.useRef(null),M=n.useRef(null),N=n.useCallback((e=>{let{width:t,height:r}=e;L({width:(0,c._5)(t),height:r})}),[]),R=n.useCallback((e=>{if(S){g=new URL(e).hostname;const t=Date.now();let r="".concat(e).concat("/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true","&clientId=").concat("fluid","&clickTime=").concat(t);return r+="&smkt=".concat(h.locale),r}g=p;return"".concat(u,"?smkt=").concat(h.locale)}),[S,h.locale]),_=n.useCallback((e=>{e&&e.focus()}),[]),I=n.useCallback((e=>{e&&(e.submit(),d.payloadSendStartTime=performance.now())}),[d]),j=n.useCallback((()=>{if(null!==T.current&&void 0!==x){const e=x.authToken,t=R(x.webAbsoluteUrl);T.current.target=m,T.current.method="POST",T.current.action=t;const r=document.createElement("input");r.type="text",r.value=e,r.name="access_token",r.hidden=!0,T.current.appendChild(r);const n=document.createElement("input");n.type="text",n.value=JSON.stringify(x),n.name="context",n.hidden=!0,T.current.appendChild(n),T.current.submit(),d.payloadSendStartTime=performance.now()}}),[R,T,x,d]),B=S?j:I;n.useEffect((()=>{t.then((e=>{P(e);const t=((e,t)=>{let r="";return r=t?new URL(e).origin:u,"clipboard-read self "+r+"; clipboard-write self "+r})(e.webAbsoluteUrl,S);M.current&&(M.current.allow=t),B()})).catch((e=>{r.reject(e),i.reject(e)}))}),[t,x,i,r,B,S]),n.useEffect((()=>{i.catch((()=>{b(l.yp.Error)}))}),[i]),n.useEffect((()=>{const e=e=>{w(e,k,r,i,b,N,d)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]);const U=v(f,D.width,D.height),z=y(D.width,D.height);return n.createElement(n.Fragment,null,f===l.yp.Loading&&n.createElement("div",{className:E(C),"aria-label":"Loading",ref:_},n.createElement(a.y,{size:o.H.large})),f===l.yp.Error&&n.createElement("div",{"aria-label":s.shareDialogErrorMessage},s.shareDialogErrorMessage),f!==l.yp.Error&&n.createElement("div",{className:U},S?n.createElement("form",{id:"shareform",ref:T}):x&&n.createElement("form",{id:"shareform",action:R(""),method:"post",target:m,ref:B},n.createElement("input",{type:"text",name:"context",defaultValue:JSON.stringify(x),style:{display:"none"}})),n.createElement("iframe",{className:z,name:m,title:e.stringTable.shareIframeTitle,sandbox:void 0,role:"dialog",ref:M})))})),w=(e,t,r,n,a,o,i)=>{const c=new URL(e.origin);if("https:"!==c.protocol||c.hostname!==g)return;const h=JSON.parse(e.data);switch(h.name){case"share_started":i.sharePointLoadStartTime=performance.now();break;case"share_ready":a(l.yp.Loaded),r.resolve(!0);break;case"share_resize":h&&(0,s.E)(h.width)&&(0,s.E)(h.height)&&0!==h.width&&0!==h.height&&o({width:h.width,height:h.height});break;case"share_dismiss":t();break;case"share_grantAccessCompleted":n.resolve(null===h||void 0===h?void 0:h.successful);break;case"share_completed":n.resolve(!0);break;case"share_error":const e=null!==h&&void 0!==h&&h.error?h.error.toString():"error not provided",c=null!==h&&void 0!==h&&h.errorCategory?h.errorCategory.toString():"error category not provided",m=null!==h&&void 0!==h&&h.errorMessage?h.errorMessage:"error message not provided",p=null!==h&&void 0!==h&&h.debugErrorMessage?h.debugErrorMessage:"debug error message not provided",u=new l.QW(d.NN.SpoShareError,m,p,e,c);r.reject(u),n.reject(u)}},E=e=>{switch(e){case h.n.default:case h.n.copyLink:return(0,i.Zq)({width:480,height:c.GB,paddingBottom:0,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}},"@media screen and (max-width: 430px)":{width:"100%"}});case h.n.atMention:return(0,i.Zq)({width:480,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}})}},y=(e,t)=>(0,i.Zq)({width:e,height:t,border:"none","@media screen and (max-width: 430px)":{width:c.Ic}}),v=(e,t,r)=>(0,i.Zq)({width:e===l.yp.Loaded?t:0,height:e===l.yp.Loaded?r:0,overflow:"hidden","@media screen and (max-width: 430px)":{width:e===l.yp.Loaded?c.Ic:0}})},50780:(e,t,r)=>{r.r(t),r.d(t,{ShareDialog:()=>g,ShareDialogRenderer:()=>f});var n=r(65043),a=r(49634),o=r(98656),i=r(52342),s=r(40520),d=r(78632),l=r(57426),c=r(48043),h=r(64681),m=r(44869),p=r(83545),u=r(36599);const g=n.memo((e=>{const{onRenderPromise:t,onCompletePromise:r,onDismissDialog:g,stringTable:f,perfMarks:w,localization:E,shareMode:y,dialogProps:v,showShareProps:b}=e,[k,S]=n.useState(!1),[C,x]=n.useState(c.yp.Loading),P=()=>{S(!0),g()},D=function(e,t){switch(e){case c.yp.Loading:return{header:{padding:0,height:t===l.n.atMention?50:0},title:{padding:0},inner:{padding:0}};case c.yp.Loaded:return{header:{padding:0,height:0},title:{padding:0},inner:{padding:0,"@media (min-width: 320px) and (max-width: 479px)":{padding:0}}};case c.yp.Error:return{header:{padding:0,height:50},title:{paddingTop:15,paddingBottom:15,paddingLeft:20},inner:{padding:20,width:330}}}}(C,y),L=(0,a.D)(),T=(0,m.zq)(L,null===v||void 0===v?void 0:v.theme,b);return T.then((()=>{w.payloadLoadEndTime=performance.now(),(0,d.t)(15e3,[t,r]).then((e=>{if(e){const e=new c.QW(p.NN.SpoTimeoutError);(0,m.tD)(t,r,e)}})).catch((()=>{}))})).catch((()=>{})),n.createElement(u.P,{onCompletePromise:r,onRenderPromise:t,stringTable:f},n.createElement(o.N,{theme:null===v||void 0===v?void 0:v.theme},n.createElement(i.l,{dialogContentProps:{type:s.h.normal,styles:D},hidden:k,modalProps:{isBlocking:!1,styles:{main:{maxWidth:m.yO,minWidth:m.Ic,minHeight:m.GB}}},onDismiss:P,maxWidth:"none",title:C===c.yp.Error?y===l.n.copyLink?f.copyDialogErrorTitle:f.shareDialogErrorTitle:void 0,...v},n.createElement(h.x,{payloadPromise:T,onRenderPromise:t,onCompletePromise:r,stringTable:f,perfMarks:w,localization:E,renderState:C,setRenderState:x,onIframeDismiss:P,useEnterpriseEndpoint:!(0,m.iO)(e.showShareProps.tokenProvider),shareMode:y}))))})),f=e=>{const[t,r]=n.useState(!0);return t?n.createElement(g,{...e,onDismissDialog:()=>{r(!1),e.onDismissDialog()}}):null}}}]);
//# sourceMappingURL=shareDialog.c1358ebd.chunk.js.map