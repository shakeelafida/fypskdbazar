"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[6363],{54555:(e,t,o)=>{o.d(t,{G:()=>v});var r=o(65804),n=o(6326),i=o(65043),a=o(89379),s=o(17066),l=o(27480),p=o(40440),d=o(56420),c=o(15199),u=o(13706),m=o(20751),h="SearchBox",g={root:{height:"auto"},icon:{fontSize:"12px"}},C={iconName:"Clear"},x={ariaLabel:"Clear text"},f=(0,a.Z)(),S=i.forwardRef((function(e,t){var o=e.ariaLabel,r=e.className,a=e.defaultValue,S=void 0===a?"":a,b=e.disabled,F=e.underlined,N=e.styles,v=e.labelText,k=e.placeholder,B=void 0===k?v:k,E=e.theme,G=e.clearButtonProps,y=void 0===G?x:G,D=e.disableAnimation,P=void 0!==D&&D,I=e.showIcon,w=void 0!==I&&I,L=e.onClear,R=e.onBlur,A=e.onEscape,T=e.onSearch,q=e.onKeyDown,_=e.iconProps,z=e.role,O=e.onChange,W=e.onChanged,Z=i.useState(!1),H=Z[0],J=Z[1],V=i.useRef(),j=(0,p.k)(e.value,S,(function(e,t){e&&e.timeStamp===V.current||(V.current=null===e||void 0===e?void 0:e.timeStamp,null===O||void 0===O||O(e,t),null===W||void 0===W||W(t))})),$=j[0],K=j[1],M=String($),U=i.useRef(null),Y=i.useRef(null),Q=(0,d.a)(U,t),X=(0,c.B)(h,e.id),ee=y.onClick,te=f(N,{theme:E,className:r,underlined:F,hasFocus:H,disabled:b,hasInput:M.length>0,disableAnimation:P,showIcon:w}),oe=(0,s.G1)(e,s.QQ,["className","placeholder","onFocus","onBlur","value","role"]),re=i.useCallback((function(e){var t;null===L||void 0===L||L(e),e.defaultPrevented||(K(""),null===(t=Y.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())}),[L,K]),ne=i.useCallback((function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||re(e)}),[ee,re]),ie=i.useCallback((function(e){J(!1),null===R||void 0===R||R(e)}),[R]),ae=function(e){K(e.target.value,e)};return function(e,t,o){i.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return o}}}),[t,o])}(e.componentRef,Y,H),i.createElement("div",{role:z,ref:Q,className:te.root,onFocusCapture:function(t){var o;J(!0),null===(o=e.onFocus)||void 0===o||o.call(e,t)}},i.createElement("div",{className:te.iconContainer,onClick:function(){Y.current&&(Y.current.focus(),Y.current.selectionStart=Y.current.selectionEnd=0)},"aria-hidden":!0},i.createElement(m.I,(0,n.__assign)({iconName:"Search"},_,{className:te.icon}))),i.createElement("input",(0,n.__assign)({},oe,{id:X,className:te.field,placeholder:B,onChange:ae,onInput:ae,onBlur:ie,onKeyDown:function(e){switch(e.which){case l.c.escape:null===A||void 0===A||A(e),M&&!e.defaultPrevented&&re(e);break;case l.c.enter:T&&(T(M),e.preventDefault(),e.stopPropagation());break;default:null===q||void 0===q||q(e),e.defaultPrevented&&e.stopPropagation()}},value:M,disabled:b,role:"searchbox","aria-label":o,ref:Y})),M.length>0&&i.createElement("div",{className:te.clearButton},i.createElement(u.K,(0,n.__assign)({onBlur:ie,styles:g,iconProps:C},y,{onClick:ne}))))}));S.displayName=h;var b=o(33516),F=o(50605),N={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var v=(0,r.I)(S,(function(e){var t,o,r,n,i,a=e.theme,s=e.underlined,l=e.disabled,p=e.hasFocus,d=e.className,c=e.hasInput,u=e.disableAnimation,m=e.showIcon,h=a.palette,g=a.fonts,C=a.semanticColors,x=a.effects,f=(0,b.Km)(N,a),S={color:C.inputPlaceholderText,opacity:1},v=h.neutralSecondary,k=h.neutralPrimary,B=h.neutralLighter,E=h.neutralLighter,G=h.neutralLighter;return{root:[f.root,g.medium,b.S8,{color:C.inputText,backgroundColor:C.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:x.roundedCorner2,border:"1px solid ".concat(C.inputBorder),height:32,selectors:(t={},t[b.up]={borderColor:"WindowText"},t[":hover"]={borderColor:C.inputBorderHovered,selectors:(o={},o[b.up]={borderColor:"Highlight"},o)},t[":hover .".concat(f.iconContainer)]={color:C.inputIconHovered},t)},!p&&c&&{selectors:(r={},r[":hover .".concat(f.iconContainer)]={width:4},r[":hover .".concat(f.icon)]={opacity:0,pointerEvents:"none"},r)},p&&["is-active",{position:"relative"},(0,b.Sq)(C.inputFocusBorderAlt,s?0:x.roundedCorner2,s?"borderBottom":"border")],m&&[{selectors:(n={},n[":hover .".concat(f.iconContainer)]={width:32},n[":hover .".concat(f.icon)]={opacity:1},n)}],l&&["is-disabled",{borderColor:B,backgroundColor:G,pointerEvents:"none",cursor:"default",selectors:(i={},i[b.up]={borderColor:"GrayText"},i)}],s&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],s&&l&&{backgroundColor:"transparent"},c&&"can-clear",d],iconContainer:[f.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:C.inputIcon,cursor:"text"},p&&{width:4},l&&{color:C.inputIconDisabled},!u&&{transition:"width ".concat(b.cs.durationValue1)},m&&p&&{width:32}],icon:[f.icon,{opacity:1},p&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(b.cs.durationValue1," 0s")},m&&p&&{opacity:1}],clearButton:[f.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:E},"&:hover .ms-Button-icon":{color:k},".ms-Button":{borderRadius:(0,F.jI)(a)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:v}}}],field:[f.field,b.S8,(0,b.CX)(S),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:C.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:C.disabledText}]}}),void 0,{scope:"SearchBox"})},67354:(e,t,o)=>{o.r(t),o.d(t,{AddFormRequirementDialog:()=>Ce,DialogState:()=>ge,FormOption:()=>he});var r=o(65043),n=o(96891),i=o(77508),a=o(16112),s=o(63485),l=o(66783),p=o(54845),d=o(31537),c=o(54555),u=o(67048),m=o(65337),h=o(94850),g=o(4648),C=o(20751),x=o(9422),f=o(36060),S=o(33516),b=o(72943),F=o(66151),N=o(56415),v=o(8736);const k=(0,l.J9)(((e,t)=>{const o={groupListRoot:[{height:v.B.GroupListHeight,overflowY:"scroll"},e&&{maxHeight:v.B.CopyPlanPickerHeight,height:"auto"}],groupRow:[(0,F.gS)(),(0,b.kE)(),{justifyContent:"center",overflow:"hidden",position:"relative",alignItems:"center",cursor:"pointer",padding:"".concat(v.B.GroupListPaddingBetweenElements," 0px"),"> *":{margin:"0px ".concat(v.B.GroupListPaddingBetweenElements)},"> .newGroupIcon":{fontSize:v.B.GroupInfoNewGroupIconFontSize,color:N.z.ThemePrimary},"> .virtualContainer-wrapper":{margin:0},"&:hover, &.selected":{backgroundColor:N.z.NeutralLight}},e&&{maxWidth:"100%",margin:"0px 0px",padding:"".concat(v.B.SearchBarPadding," ").concat(v.B.SearchBarPadding)}],icon:[(0,F.gS)(),F.cc,(0,F.$Z)(v.B.GroupListIconPrimarySize),{color:N.z.White,fontSize:S.s.large,fontWeight:S.BO.regular,height:v.B.GroupListIconPrimarySize,width:v.B.GroupListIconPrimarySize}],groupContext:(0,F.GD)(),groupName:[(0,F.GD)(),(0,F.q0)("ellipsis"),{fontSize:S.s.medium,fontWeight:S.BO.semibold},e&&{lineHeight:v.B.GroupInfoLineHeight}],groupInfo:[(0,F.q0)("ellipsis"),{fontSize:S.s.small,color:N.z.NeutralSecondary}]};return(0,S.TW)(o,t)})),B=(0,l.J9)((e=>({groupListRoot:(0,S.Zq)("groupList",e.groupListRoot),groupRow:(0,S.Zq)("groupRow",e.groupRow),groupContext:(0,S.Zq)("groupContext",e.groupContext),icon:(0,S.Zq)("icon",e.icon),groupName:(0,S.Zq)("groupName",e.groupName),groupInfo:(0,S.Zq)("groupInfo",e.groupInfo)})));var E=o(54320),G=o.n(E),y=o(33411),D=o.n(y),P=o(44535),I=o(27678),w=o(86053),L=o(91246),R=o(74527);class A extends a.${name(){return"GroupList"}renderComponent(){const e=this.getClassNames();return r.createElement(m.R,{className:e.groupListRoot,direction:h.E.vertical},r.createElement("ul",{role:"listbox","aria-label":w.p.Strings.GroupList_GroupListAriaLabel},D()(this.props.groups,(e=>{if(!G()(e.displayName))return this.renderGroupRow(e)}))))}renderGroupRow(e){const{currentGroup:t,renderGroupContextInfo:o,sensitivityLabels:n,onClickGroupRow:i}=this.props,{groupRow:a,groupContext:s,groupName:l,groupInfo:p}=this.getClassNames(),d=this.renderGroupContainer(e),c=!!t&&e.id===t.id;return r.createElement("li",{className:(0,g.A)(a,c?"selected":""),key:e.id,"aria-label":e.displayName,"aria-selected":e===t,"tab-index":0,"data-is-focusable":!0,onClick:i.bind(this,e),role:"option"},d,r.createElement("div",{className:s},r.createElement("div",{className:l},e.displayName),o?r.createElement("div",{className:p},e.getDetailedInfo(n)):null))}renderGroupPhoto(e){const{icon:t}=this.getClassNames(),o=this.props.getGroupPhoto(e.id);if(o)return r.createElement("img",{src:o,className:t,alt:""});{const o=P.$.parseInitialsFromName(e.displayName),n=(0,f.K)((0,I.wV)(e.displayName));return r.createElement("span",{className:(0,g.A)(t,n)},o)}}renderGroupContainer(e){const{icon:t}=this.getClassNames();return L.o.isPlexTempId(e.id)?r.createElement("span",{className:(0,g.A)(t,"newGroupIcon")},r.createElement(C.I,R.D5)):r.createElement(x.$,{planContainerId:e.id,onRender:()=>this.props.onRenderGroup(e.id)},this.renderGroupPhoto(e))}getClassNames(){return B(k(this.props.isCopyPlanContext,this.props.styles))}constructor(e,t){super(e,t)}}var T=o(28680),q=o(75472);const _="".concat((0,q.jz)(v.B.GroupPickerTotalHorizontalPadding)-(0,q.jz)(v.B.fabricHorizontalPadding),"px"),z=(0,l.J9)(((e,t)=>{const{isCopyPlanContext:o}=e,r={groupPickerRoot:{fontSize:S.s.small,padding:o?"0px":"0px ".concat(_," ").concat(_)},groupFilter:{padding:o?v.B.SearchBarPadding:"".concat(v.B.SearchBarPadding," 0")},subComponentStyles:{searchBar:Z(),groupList:k(o)}};return(0,T.p)(e,r,t)})),O={root:{"> h1":{fontSize:S.s.large,fontWeight:S.BO.bold}}},W={root:{fontSize:S.s.small,"> a":{textDecoration:"none",":hover":{textDecoration:"underline"}}}},Z=(0,l.J9)((()=>({root:{fontWeight:S.BO.semibold,borderColor:"transparent",backgroundColor:N.z.NeutralLight}}))),H=(0,l.J9)((e=>({rootHovered:{backgroundColor:N.z.NeutralLight},root:[(0,F.aS)(e),{fontSize:S.s.medium,fontColor:N.z.NeutralPrimary,height:v.B.ButtonHeight,backgroundColor:N.z.NeutralLighter}]}))),J=(0,l.J9)((e=>({groupPickerRoot:(0,S.Zq)("groupPickerDialog",e.groupPickerRoot),groupFilter:(0,S.Zq)("groupFilter",e.groupFilter)})));var V=o(21382);class j extends a.${componentDidUpdate(e){const t=this.getTextToAnnounce();if(this.state.textToAnnounce!==t||e.groups.length!==this.props.groups.length){const e=this.props.groups.filter((e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e}));""!==t&&this.props.alertUser("SharedComponents_GroupSearchResultCountAriaLabel",[e.length.toString(),this.currentSearchText]),this.setState({textToAnnounce:t,filteredGroups:e})}}name(){return n.M.GroupPicker}renderComponent(){const{groupPickerRoot:e,groupFilter:t}=this.getClassNames(),o=this.getStyles();return r.createElement("div",{className:e},r.createElement(u.Y,{isClickableOutsideFocusTrap:!0},this.props.hideHeaderFooter?null:this.renderGroupPickerDialogHeader(),r.createElement("div",{className:t},r.createElement(c.G,{styles:o.subComponentStyles.searchBar,ariaLabel:w.p.Strings.GroupPicker_SearchBoxAriaLabel,onChange:this.onChangeSearch.bind(this),placeholder:w.p.Strings.GroupPicker_SearchBoxPlaceholder,underlined:this.props.underlinedSearchBar})),this.renderGroupList(),this.props.hideHeaderFooter?null:r.createElement(p.E,null,r.createElement(s.j,{styles:H(this.props.theme),className:"backButton",onClick:this.onClickBack.bind(this)},w.p.Strings.GroupPicker_BackButton))))}renderGroupPickerDialogHeader(){const e=r.createElement("a",{href:i.$j.m365Groups,target:"_blank",rel:"noopener noreferrer",onClick:this.onClickLink.bind(this)},w.p.Strings.GroupPicker_LearnMoreLinkText);return r.createElement("div",{className:"groupPickerDialogHeader"},r.createElement(d.J,{className:"groupPickerTitle",styles:O},r.createElement("h1",null,w.p.Strings.GroupPicker_DialogTitle)),r.createElement(d.J,{styles:W,className:"groupPickerSubtitle"},w.p.Strings.GroupPicker_DialogSubtitle," ",r.createElement("br",null)," ",e))}renderGroupList(){const{currentGroup:e,sensitivityLabels:t,renderGroupContextInfo:o,isCopyPlanContext:n,getGroupPhoto:i,onRenderGroup:a}=this.props,s=this.getStyles();return r.createElement(A,{styles:s.subComponentStyles.groupList,currentGroup:e,groups:this.state.filteredGroups,sensitivityLabels:t,onClickGroupRow:e=>this.onClickGroupRow(e),getGroupPhoto:e=>i(e),renderGroupContextInfo:o,isCopyPlanContext:n,onRenderGroup:a})}onClickGroupRow(e){this.props.setGroup(e),this.props.onDismiss&&this.props.onDismiss()}onClickBack(){this.props.setGroup(null),this.props.onDismiss&&this.props.onDismiss()}onClickLink(){this.context.usageLogger.logData(n.M.GroupPicker,n.M.GroupLinkClicked)}getTextToAnnounce(){return""===this.currentSearchText?"":V.G(w.p.Strings.SharedComponents_GroupSearchResultCountAriaLabel,this.state.filteredGroups.length,this.currentSearchText)}getStyles(){const{isCopyPlanContext:e,styles:t}=this.props,o=this.getStyleProps(e);return z(o,t)}getClassNames(){return J(this.getStyles())}constructor(e,t){super(e,t),this.currentSearchText="",this.onChangeSearch=(e,t)=>{this.currentSearchText=t||"";const o=this.props.groups.filter((e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e}));this.setState({filteredGroups:o})},this.getStyleProps=(0,l.J9)((e=>({isCopyPlanContext:e}))),this.state={filteredGroups:this.props.groups,textToAnnounce:""}}}var $=o(40520),K=o(52342),M=o(40488),U=o(57433),Y=o(11638),Q=o(6017),X=o(42283),ee=o(46646),te=o(11034),oe=o(8480),re=o(39410),ne=o(39946),ie=o(86634),ae=o(53815),se=o(48709);const le=(0,l.J9)(((e,t,o)=>{const r=[(0,b.kE)({borderWidth:"1px"}),{fontSize:ae.s.medium,border:"0px",borderBottom:"2px solid",width:"100%",height:"31px",":focus-visible":{outline:0,borderColor:(0,F.Nh)(e)},":disabled,:disabled:hover":{cursor:"default",opacity:"0.5",backgroundColor:N.z.NeutralLighter,borderColor:se.kd.gray110},paddingLeft:"12px"},(0,F.aS)(e),(0,F.nK)(e)],n={":hover":{".defaultContent":(0,F.aS)(e)}},a=[(0,b.kE)({borderWidth:"1px"}),{borderColor:(0,F.Nh)(e),borderBottom:"2px solid"}],s=[r,{marginBottom:"15px",".groupSelectionDropdownIcon":{float:"right",lineHeight:"14px"},".defaultContent":[{float:"left"}],".groupContent":{float:"left"}},t?a:n],l={":hover":{backgroundColor:"transparent"},":disabled":[(0,F.A9)(e)],"&.ms-Button--primary":[(0,F.jU)(e)],"&.ms-Button--default":[(0,F.i9)(e)]},p=[(0,F.aS)(e),(0,F.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{maxWidth:"600px",minWidth:"510px"}},e===i.Sx.TeamsContrast&&{border:"1px solid "+N.z.White}],d=[(0,F.aS)(e)],c=[(0,F.Ml)(e),{"::after":e===i.Sx.TeamsContrast&&{color:N.z.White}}],u=[(0,F.gS)("row"),{alignItems:"center"}],m={marginBottom:"15px"},h=[c,{fontSize:ae.s.small,marginBottom:"5px"}],g=[m,{":hover":{".ms-Dropdown-titleIsPlaceHolder":[(0,F.aS)(e)]},".ms-Label":{"::after":e===i.Sx.TeamsContrast&&{color:N.z.White}}}],C=[(0,F.gS)("column"),(0,F.aS)(e),{justifyContent:"center",textAlign:"center",fontSize:ae.s.large,height:"250px",fontWeight:ae.BO.semibold}],x={".ms-Dialog-button":[(0,F.aS)(e),{":hover":[(0,F.aS)(e),{backgroundColor:"transparent"}]}]};return(0,S.TW)({groupPickerButton:s,dialogContainer:p,dialogFooterButtons:l,dialogFooter:{paddingTop:"15px"},dialogTitle:d,label:c,labelWithInfoIcon:u,infoIcon:{display:"inline-block",verticalAlign:"middle"},inputField:m,labelDescription:h,dropdown:g,loadingSpinner:C,dialogTopButton:x,tooltip:{maxWidth:"250px"}},o)})),pe={circle:{borderColor:"".concat(N.z.TeamsAppBrand00," ").concat(N.z.TeamsDarkPurple," ").concat(N.z.TeamsDarkPurple),marginBottom:"10px"}},de=(0,l.J9)((e=>({groupPickerRoot:{ul:{marginLeft:"0px",paddingLeft:"10px",marginTop:"0px"},img:{borderRadius:"5px"},padding:"0px"},groupFilter:{paddingTop:"15px",paddingBottom:"15px",paddingLeft:"25px",paddingRight:"25px"},subComponentStyles:{groupList:ce(e),searchBar:{}}}))),ce=(0,l.J9)((e=>({groupListRoot:{maxHeight:"300px"},groupRow:[(0,F.gS)(),{backgroundColor:N.z.Black,maxWidth:"100%",margin:"0px 0px",padding:"10px 10px"}],icon:[(0,F.$Z)("52px"),{height:"52px",width:"52px"}],groupContext:{},groupInfo:{},groupName:{}}))),ue=(0,l.J9)((e=>({title:e.dialogTitle,topButton:e.dialogTopButton}))),me=(0,l.J9)((e=>({dialogContainer:(0,S.Zq)("dialogContainer",e.dialogContainer),dialogFooterButtons:(0,S.Zq)("dialogFooterButtons",e.dialogFooterButtons),dialogFooter:(0,S.Zq)("dialogFooter",e.dialogFooter),groupPickerButton:(0,S.Zq)("groupPickerButton",e.groupPickerButton),label:(0,S.Zq)("labelStyles",e.label),labelWithInfoIcon:(0,S.Zq)("labelWithInfoIcon",e.labelWithInfoIcon),infoIcon:(0,S.Zq)("infoIcon",e.infoIcon),inputField:(0,S.Zq)("inputField",e.inputField),labelDescription:(0,S.Zq)("labelDescription",e.labelDescription),dropdown:(0,S.Zq)("dropdown",e.dropdown),loadingSpinner:(0,S.Zq)("loadingSpinner",e.loadingSpinner),dialogTitle:(0,S.Zq)("dialogTitle",e.dialogTitle),dialogTopButton:(0,S.Zq)("dialogTopButton",e.dialogTopButton),tooltip:(0,S.Zq)("tooltip",e.tooltip)})));var he,ge;!function(e){e.CreateNewForm="CreateNewForm",e.AddExistingForm="AddExistingForm"}(he||(he={})),function(e){e.Normal="Normal",e.Loading="Loading",e.Error="Error"}(ge||(ge={}));class Ce extends a.${name(){return"AddFormRequirementDialog"}componentDidMount(){this.state.selectedGroup&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}componentDidUpdate(e,t){this.state.selectedGroup&&this.state.selectedGroup!==t.selectedGroup&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}renderComponent(){const{dialogContainer:e}=this.getClassNames();let t,o,n=$.h.normal;switch(this.state.dialogState){case ge.Loading:o=void 0,t=this.renderLoading();break;case ge.Error:o=w.p.Strings.AddFormRequirementDialog_CreateFormErrorDialogTitle,t=this.renderError(),n=$.h.close;break;case ge.Normal:default:o=w.p.Strings.AddFormRequirementDialog_AddFormRequirementDialogTitle,t=this.renderDialogContent()}return r.createElement(K.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,closeButtonAriaLabel:w.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,title:o,styles:ue(le(this.props.theme,this.state.showGroupPickerCallout,this.props.contentStyles)),type:n},modalProps:{className:this.props.dialogClassName,containerClassName:(0,g.A)(this.props.dialogContainerClassName,e),isBlocking:!1}},t)}renderDialogContent(){return r.createElement("div",null,this.renderGroupPickerButton(),this.state.showGroupPickerCallout&&this.renderGroupPickerCallout(),this.renderFormOptions(),this.isInitialInputValid()&&this.renderCreateNewFormInput(),this.isInitialInputValid()&&this.renderAddExistingFormInput(),this.renderFooter())}renderLoading(){const{loadingSpinner:e}=this.getClassNames(),t=w.p.Strings.AddFormRequirementDialog_CreateFormLoadingText;return r.createElement("div",{className:e},r.createElement(M.y,{size:U.H.large,ariaLabel:t,styles:pe}),t)}renderError(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames();return r.createElement("div",null,w.p.Strings.AddFormRequirementDialog_CreateFormErrorText,r.createElement(p.E,{className:t},r.createElement(s.j,{className:(0,g.A)("saveButton",e),onClick:this.onSubmit},w.p.Strings.AddFormRequirementDialog_TryAgainButtonText)))}renderFooter(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames(),o=this.state.selectedFormOption===he.CreateNewForm?w.p.Strings.AddFormRequirementDialog_CreateNewFormButtonText:w.p.Strings.AddFormRequirementDialog_AddExistingFormButtonText;return r.createElement(p.E,{className:t},this.isInitialInputValid()&&r.createElement(s.j,{className:(0,g.A)("saveButton",e),disabled:!this.isRequiredInputValid(),onClick:this.onSubmit},o),r.createElement(Y.Y,{className:(0,g.A)("cancelButton",e),onClick:this.props.onDismiss},w.p.Strings.SharedComponents_CancelButtonText))}isRequiredInputValid(){if(!this.state.selectedGroup)return!1;switch(this.state.selectedFormOption){case he.CreateNewForm:return!!this.state.formDisplayName;case he.AddExistingForm:return!!this.state.selectedExistingForm&&!!this.state.formDisplayName;default:return!1}}isInitialInputValid(){return!(!this.state.selectedGroup||!this.state.selectedFormOption)}renderGroupPickerButton(){var e;const{groupPickerButton:t,labelWithInfoIcon:o,tooltip:n}=this.getClassNames(),i=r.createElement(r.Fragment,null,this.state.selectedGroup?r.createElement("div",{className:"groupContent"},null===(e=this.state.selectedGroup)||void 0===e?void 0:e.displayName):r.createElement(r.Fragment,null,r.createElement("div",{className:"defaultContent"},w.p.Strings.AddFormRequirementDialog_GroupPickerPlaceholder),r.createElement("div",{className:"groupSelectionDropdownIcon"},r.createElement(C.I,R.Ju))));return r.createElement(r.Fragment,null,r.createElement("div",{className:o},r.createElement(d.J,{required:!0},w.p.Strings.AddFormRequirementDialog_GroupPickerLabel),r.createElement(oe.S,{plannerTheme:this.props.theme,directionalHint:Q.A.rightCenter,content:w.p.Strings.AddFormRequirementDialog_GroupPickerTooltipText,className:n},r.createElement(C.I,{...R.h_,tabIndex:0}))),r.createElement("button",{"aria-haspopup":!0,className:t,onClick:this.onGroupPickerButtonClicked,type:"button",ref:e=>this.groupPickerButton=e},i))}renderGroupPickerCallout(){const e={theme:this.props.theme,hideHeaderFooter:!0,renderGroupContextInfo:!1,currentGroup:this.state.selectedGroup,groups:this.props.groups,sensitivityLabels:null,getGroupPhoto:()=>null,setGroup:e=>{this.setState({selectedGroup:e})},onRenderGroup:()=>null,alertUser:()=>null,onDismiss:this.onGroupPickerCalloutDismiss};return r.createElement(re.P,{calloutWidth:this.groupPickerButton.getBoundingClientRect().width,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this.groupPickerButton,onDismiss:this.onGroupPickerCalloutDismiss,setInitialFocus:!0,styles:(0,ie.df)(this.props.theme)},r.createElement(j,{styles:de(this.props.theme),...e}))}renderFormOptions(){const{dropdown:e}=this.getClassNames(),t=[{key:he.CreateNewForm,text:w.p.Strings.AddFormRequirementDialog_CreateNewFormOption},{key:he.AddExistingForm,text:w.p.Strings.AddFormRequirementDialog_AddExistingFormOption}];return r.createElement(X.t,{label:w.p.Strings.AddFormRequirementDialog_FormOptionsDropdownLabel,debounceInterval:200,appTheme:this.props.theme,options:t,placeholder:w.p.Strings.AddFormRequirementDialog_FormOptionsDropdownPlaceholder,required:!0,selectedKey:this.state.selectedFormOption,onChange:this.onFormOptionChanged,className:(0,g.A)(e,"formOptionsDropdown")})}renderCreateNewFormInput(){if(this.state.selectedFormOption!==he.CreateNewForm)return null;const{labelWithInfoIcon:e,inputField:t,labelDescription:o}=this.getClassNames();return r.createElement("div",{className:"createNewFormInput"},r.createElement(d.J,{className:e,required:!0},w.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),r.createElement("div",{className:o},w.p.Strings.AddFormRequirementDialog_FormDisplayNameInputDescription),r.createElement(ee.A,{appTheme:this.props.theme,placeholder:w.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:te.u.Dialog,className:t,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName,maxLength:ne.l.TitleMaxLength}))}renderAddExistingFormInput(){var e;if(this.state.selectedFormOption!==he.AddExistingForm||!this.state.selectedGroup)return null;const{label:t,inputField:o,dropdown:n}=this.getClassNames();let i=[];const a=this.props.getFormsInGroup(this.state.selectedGroup.id);return a&&(i=a.map((e=>({key:e.id,text:e.title,data:e})))),r.createElement("div",{className:"addExistingFormInput"},r.createElement(X.t,{label:w.p.Strings.AddFormRequirementDialog_ExistingFormDropdownLabel,debounceInterval:200,appTheme:this.props.theme,placeholder:w.p.Strings.AddFormRequirementDialog_ExistingFormDropdownPlaceholder,options:i,required:!0,selectedKey:null===(e=this.state.selectedExistingForm)||void 0===e?void 0:e.id,onChange:this.onExistingFormChanged,className:(0,g.A)(n,"existingFormsDropdown")}),r.createElement(d.J,{className:t,required:!0},w.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),r.createElement(ee.A,{appTheme:this.props.theme,placeholder:w.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:te.u.Dialog,className:o,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName}))}getClassNames(){const{theme:e,contentStyles:t}=this.props;return me(le(e,this.state.showGroupPickerCallout,t))}constructor(e,t){var o;super(e,t),this.onSubmit=()=>{if(this.setState({dialogState:ge.Loading}),this.state.selectedFormOption===he.CreateNewForm&&this.state.selectedGroup)this.props.onCreateForm(this.state.formDisplayName,this.state.selectedGroup.id).then((()=>{this.props.onDismiss(),this.setState({dialogState:ge.Normal})})).catch((()=>{this.setState({dialogState:ge.Error})}));else if(this.state.selectedFormOption===he.AddExistingForm&&this.state.selectedExistingForm){const e={...this.state.selectedExistingForm,title:this.state.formDisplayName};this.props.onAddExistingForm(e).then((()=>{this.props.onDismiss(),this.setState({dialogState:ge.Normal})}))}},this.onGroupPickerButtonClicked=()=>{this.setState((e=>({showGroupPickerCallout:!e.showGroupPickerCallout})))},this.onGroupPickerCalloutDismiss=()=>{this.setState({showGroupPickerCallout:!1})},this.onFormOptionChanged=(e,t)=>{this.setState({selectedFormOption:t.key})},this.onExistingFormChanged=(e,t)=>{this.setState({selectedExistingForm:t.data})},this.state={selectedFormOption:null,selectedExistingForm:null,selectedGroup:null!==(o=this.props.currentGroup)&&void 0!==o?o:null,showGroupPickerCallout:!1,existingForms:[],formDisplayName:"",dialogState:ge.Normal}}}},9422:(e,t,o)=>{o.d(t,{$:()=>c});var r=o(65043),n=o(16112),i=o(22317),a=o(66783),s=o(33516);const l=(0,a.J9)((()=>({anchor:{minHeight:"1px"}}))),p=(0,a.J9)((e=>({anchor:(0,s.Zq)("virtualContainer-anchor",e.anchor)})));class d extends n.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return r.createElement(r.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return r.createElement("div",{className:"virtualContainer-wrapper"},r.createElement(i.pL,{onChange:this.handleInView,triggerOnce:!0},r.createElement("div",{className:e.anchor})))}getClassNames(){return p(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}class c extends n.${renderComponent(){const{children:e,planContainerId:t,onRender:o}=this.props;return t?r.createElement(d,{containerId:t,onLoad:o},e):r.createElement(r.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}}}]);
//# sourceMappingURL=addformrequirementdialog.843255ca.chunk.js.map