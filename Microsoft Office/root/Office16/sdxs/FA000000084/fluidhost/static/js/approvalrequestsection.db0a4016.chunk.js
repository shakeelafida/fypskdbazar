"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[81514],{49784:(e,t,r)=>{r.r(t),r.d(t,{ApprovalRequestSection:()=>Ee});var o=r(16112),n=r(39410),i=r(66151),a=r(66783),s=r(33516),p=r(75472);const l="24px",c=(0,a.J9)(((e,t)=>(0,s.TW)({addApproverPicker:[{borderRadius:"5px",height:"450px"}],compactPeoplePicker:[{width:"260px",marginTop:"15px",marginInline:"15px"}]},t))),d=(0,a.J9)(((e,t)=>{const r={root:[(0,i.NX)(e),{padding:"".concat("16px"," 0px")}],calloutMain:[(0,i.aS)(e),(0,i.NX)(e),{overflowY:"hidden"}]};return(0,s.TW)(r,t)})),u=(0,a.J9)(((e,t)=>{const r={root:[{margin:"0px ".concat(l," ").concat((0,p.vb)((0,p.jz)(l)/2)," ").concat(l)}],text:{border:"none","::after":(0,i.T4)(e)},input:[(0,i.aS)(e),(0,i.zK)(e),(0,i.Oj)(e),{minHeight:"34px"}]};return(0,s.TW)(r,t)})),v=(0,a.J9)((e=>({addApproverPicker:(0,s.Zq)("addApproverPicker",e.addApproverPicker),compactPeoplePicker:(0,s.Zq)("compactPeoplePicker",e.compactPeoplePicker)})));var h=r(65043),m=r(50605),A=r(6017),g=r(17323),C=r(86053);const f={mostRecentlyUsedHeaderText:C.p.Strings.AddApprover_AddApproverPicker_Suggestions,noResultsFoundText:C.p.Strings.AddApprover_AddApproverPicker_NoResultsFound,loadingText:C.p.Strings.AddApprover_AddApproverPicker_Loading,showRemoveButtons:!0};class S extends o.${name(){return"AddApproverPicker"}renderComponent(){const e=this.getClassNames(),t=e=>this.props.peopleList.filter((t=>function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())}(t.text,e))),r=(0,m.jI)();return h.createElement(n.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this.props.targetElement,directionalHint:r?A.A.leftTopEdge:A.A.rightTopEdge,className:e.addApproverPicker,styles:d(this.props.theme)},h.createElement(g.HQ,{className:e.compactPeoplePicker,onResolveSuggestions:(e,r,o)=>{if(e){let n=t(e);return n=x(n,r),n=o?n.slice(0,o):n,n}return[]},onEmptyResolveSuggestions:e=>x(this.props.peopleList,e),getTextFromItem:_,pickerSuggestionsProps:f,onChange:this.props.onSelectedPerson,styles:u(this.props.theme),componentRef:this._pickerRef}))}getClassNames(){return v(c(this.props.theme))}constructor(e,t){super(e,t),this._pickerRef=e=>{e&&e.focus()},this.state={}}}function _(e){var t;return null!==(t=e.text)&&void 0!==t?t:""}function x(e,t){return e.filter((e=>!function(e,t){if(0===(null===t||void 0===t?void 0:t.length))return!1;return t.filter((t=>t.text===e.text)).length>0}(e,t)))}var D,T=r(65804),k=r(6326),q=r(89379),R=r(27480),y=r(78233),P=r(9833),b=r(17066);!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(D||(D={}));var I=r(82014),N=r(19487),w=(0,q.Z)(),B=h.createContext({}),E=function(e){function t(t){var r=e.call(this,t)||this;return r._rootElement=h.createRef(),r._onClick=function(e){r._onAction(e)},r._onKeyDown=function(e){e.which!==R.c.enter&&e.which!==R.c.space||r._onAction(e)},r._onAction=function(e){var t=r.props,o=t.onClick,n=t.onClickHref,i=t.onClickTarget,a=(0,N.k_)(r.context);o?o(e):!o&&n&&(i?a.open(n,i,"noreferrer noopener nofollow"):a.location.href=n,e.preventDefault(),e.stopPropagation())},(0,y.f)(r),(0,P.A)("DocumentCard",t,{accentColor:void 0}),r}return(0,k.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,r=t.onClick,o=t.onClickHref,n=t.children,i=t.type,a=t.accentColor,s=t.styles,p=t.theme,l=t.className,c=(0,b.G1)(this.props,b.JM,["className","onClick","type","role"]),d=!(!r&&!o);this._classNames=w(s,{theme:p,className:l,actionable:d,compact:i===D.compact}),i===D.compact&&a&&(e={borderBottomColor:a});var u={role:this.props.role||(d?r?"button":"link":void 0),tabIndex:d?0:void 0};return h.createElement("div",(0,k.__assign)({ref:this._rootElement,role:"group",className:this._classNames.root,onKeyDown:d?this._onKeyDown:void 0,onClick:d?this._onClick:void 0,style:e},c),h.createElement(B.Provider,{value:u},n))},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:D.normal},t.contextType=I._0,t}(h.Component),M=r(42815),U={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},W={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},L={root:"ms-DocumentCardTitle"},O={root:"ms-DocumentCardLocation"},F={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},j=(0,T.I)(E,(function(e){var t,r,o=e.className,n=e.theme,i=e.actionable,a=e.compact,p=n.palette,l=n.fonts,c=n.effects,d=(0,s.Km)(F,n);return{root:[d.root,{WebkitFontSmoothing:"antialiased",backgroundColor:p.white,border:"1px solid ".concat(p.neutralLight),maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(M.Y2," &:focus")]=(0,s.Sq)(p.neutralSecondary,c.roundedCorner2),t[".".concat(O.root," + .").concat(L.root)]={paddingTop:"4px"},t)},i&&[d.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:p.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid ".concat(p.neutralTertiaryAlt),pointerEvents:"none"}}}],a&&[d.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(r={},r[".".concat(U.root)]={borderRight:"1px solid ".concat(p.neutralLight),borderBottom:0,maxHeight:"106px",maxWidth:"144px"},r[".".concat(U.icon)]={maxHeight:"32px",maxWidth:"32px"},r[".".concat(W.root)]={paddingBottom:"12px"},r[".".concat(L.root)]={paddingBottom:"12px 16px 8px 16px",fontSize:l.mediumPlus.fontSize,lineHeight:"16px"},r)}],o]}}),void 0,{scope:"DocumentCard"}),H=r(72799),V=r(44388),Z=(0,q.Z)(),z=function(e){function t(t){var r=e.call(this,t)||this;return r._titleElement=h.createRef(),r._truncateTitle=function(){r._needMeasurement&&r._async.requestAnimationFrame(r._truncateWhenInAnimation)},r._truncateWhenInAnimation=function(){var e=r.props.title,t=r._titleElement.current;if(t){var o=getComputedStyle(t);if(o.width&&o.lineHeight&&o.height){var n=t.clientWidth,i=t.scrollWidth;r._clientWidth=n;var a=Math.floor((parseInt(o.height,10)+5)/parseInt(o.lineHeight,10));t.style.whiteSpace="";var s=i/(parseInt(o.width,10)*a);if(s>1){var p=e.length/s-3;return r.setState({truncatedTitleFirstPiece:e.slice(0,p/2),truncatedTitleSecondPiece:e.slice(e.length-p/2)})}}}},r._shrinkTitle=function(){var e=r.state,t=e.truncatedTitleFirstPiece,o=e.truncatedTitleSecondPiece;if(t&&o){var n=r._titleElement.current;if(!n)return;(n.scrollHeight>n.clientHeight+5||n.scrollWidth>n.clientWidth)&&r.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:o.slice(1)})}},(0,y.f)(r),r._async=new H.j(r),r._events=new V.g(r),r._clientWidth=void 0,r.state={truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0},r}return(0,k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;if(this.props.title!==e.title&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0}),e.shouldTruncate!==this.props.shouldTruncate){var r=(0,N.k_)(this.context);this.props.shouldTruncate?(this._truncateTitle(),this._async.requestAnimationFrame(this._shrinkTitle),this._events.on(r,"resize",this._updateTruncation)):this._events.off(r,"resize",this._updateTruncation)}else this._needMeasurement&&this._async.requestAnimationFrame((function(){t._truncateWhenInAnimation(),t._shrinkTitle()}))},t.prototype.componentDidMount=function(){if(this.props.shouldTruncate){this._truncateTitle();var e=(0,N.k_)(this.context);this._events.on(e,"resize",this._updateTruncation)}},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this,t=this.props,r=t.title,o=t.shouldTruncate,n=t.showAsSecondaryTitle,i=t.styles,a=t.theme,s=t.className,p=this.state,l=p.truncatedTitleFirstPiece,c=p.truncatedTitleSecondPiece;return this._classNames=Z(i,{theme:a,className:s,showAsSecondaryTitle:n}),o&&l&&c?h.createElement(B.Consumer,null,(function(t){var o=t.role,n=t.tabIndex;return h.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:n,role:o},l,"\u2026",c)})):h.createElement(B.Consumer,null,(function(t){var o=t.role,n=t.tabIndex;return h.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:n,role:o,style:e._needMeasurement?{whiteSpace:"nowrap"}:void 0},r)}))},Object.defineProperty(t.prototype,"_needMeasurement",{get:function(){return!!this.props.shouldTruncate&&void 0===this._clientWidth},enumerable:!1,configurable:!0}),t.prototype._updateTruncation=function(){var e=this;this._timerId||(this._timerId=this._async.setTimeout((function(){delete e._timerId,e._clientWidth=void 0,e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0})}),250))},t.contextType=I._0,t}(h.Component),J=(0,T.I)(z,(function(e){var t,r=e.theme,o=e.className,n=e.showAsSecondaryTitle,i=r.palette,a=r.fonts,p=r.effects;return{root:[(0,s.Km)(L,r).root,n?a.medium:a.large,{padding:"8px 16px",display:"block",overflow:"hidden",position:"relative",wordWrap:"break-word",height:n?"45px":"38px",lineHeight:n?"18px":"21px",color:n?i.neutralSecondary:i.neutralPrimary,selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(M.Y2," &:focus")]=(0,s.Sq)(i.neutralSecondary,p.roundedCorner2),t)},o]}}),void 0,{scope:"DocumentCardTitle"}),G=r(9011),X=r(72721),Y=r(63485),K=r(11638);const $="239px",Q=(0,a.J9)(((e,t)=>{const r={addApproverDraft:[{borderRadius:"10px",".DraftTitle":{borderBottom:"1px solid lightgray",fontWeight:"bold",fontSize:"12px",width:$,height:"20px",backgroundColor:"rgba(0,0,0,0)"},".DraftPerson":[{margin:"10px",width:$}],".DraftButtonGroup":{marginBottom:"10px",width:$}}],draftButton:{borderRadius:"5px",marginLeft:"10px","&.ms-Button--primary":[(0,i.jU)(e)],"&.ms-Button--default":[(0,i.i9)(e)]}};return(0,s.TW)(r,t)})),ee=(0,a.J9)((e=>({addApproverDraft:(0,s.Zq)("addApproverDraft",e.addApproverDraft),draftButton:(0,s.Zq)("draftButton",e.draftButton)})));var te=r(53815);const re="10px",oe="10px",ne="12px",ie=(0,a.J9)(((e,t)=>{const r={titleSection:[(0,i.gS)(),(0,i.aS)(e),{".requiredMark":{color:(0,i.Qt)(e)},".labelTag":{marginRight:re,marginLeft:re}}],historySection:{marginTop:oe,marginBottom:oe},linkSection:[(0,i.NX)(e),(0,i.gS)(),{".addApproverText":[{textAlign:"start",marginLeft:"10px"}]}],addApproverButton:[{"> button":[(0,i.BP)(e),(0,i.gS)(),{border:"none",background:"none",fontSize:te.s.medium,cursor:"pointer"}]}],approvalsSection:{margin:"".concat("20px"," 0px")}};return(0,s.TW)(r,t)})),ae=(0,a.J9)(((e,t)=>{const r={root:[(0,i.aS)(e),(0,i.NX)(e),{".ms-DocumentCardTitle":(0,i.aS)(e),".ms-Persona-primaryText":(0,i.aS)(e),".ms-Persona-secondaryText":(0,i.aS)(e),width:"270px"}]};return(0,s.TW)(r,t)})),se=(0,a.J9)((e=>({primaryText:{fontSize:ne,fontWeight:500},secondaryText:{fontSize:ne}}))),pe=(0,a.J9)(((e,t)=>{const r={label:[{margin:"0px"}]};return(0,s.TW)(r,t)})),le=(0,a.J9)((e=>({titleSection:(0,s.Zq)("titleSection",e.titleSection),historySection:(0,s.Zq)("historySection",e.historySection),linkSection:(0,s.Zq)("linkSection",e.linkSection),addApproverButton:(0,s.Zq)("addApproverButton",e.addApproverButton),approvalsSection:(0,s.Zq)("approvalsSection",e.approvalsSection)})));class ce extends o.${name(){return"AddApproverDraft"}renderComponent(){const e=this.getClassNames();return h.createElement(j,{styles:ae(this.props.theme),className:e.addApproverDraft},h.createElement(J,{title:C.p.Strings.AddApprover_AddApproverDraft_SendApprovalRequestFor,className:"DraftTitle",styles:ae(this.props.theme)}),h.createElement(G.F,{className:"DraftPerson",...this.props.selectedPerson,size:X.WH.size32,presence:X.As.online,styles:se(this.props.theme)}),h.createElement("div",{className:"DraftButtonGroup"},h.createElement(Y.j,{styles:pe(this.props.theme),className:e.draftButton,onClick:this.props.onSendRequest},C.p.Strings.AddApprover_AddApproverDraft_SendRequest),h.createElement(K.Y,{styles:pe(this.props.theme),className:e.draftButton,onClick:this.props.onDiscard},C.p.Strings.AddApprover_AddApproverDraft_Discard)))}getClassNames(){return ee(Q(this.props.theme))}constructor(e,t){super(e,t),this.state={}}}var de,ue,ve=r(38752),he=r(78332),me=r(98571),Ae=r(67239),ge=r(40520),Ce=r(52342),fe=r(54845),Se=r(80493),_e=r(48770);!function(e){e.Approve="Approve",e.Reject="Reject"}(de||(de={})),function(e){e.NotSpecified="NotSpecified",e.Owner="Owner",e.Approver="Approver",e.DelegatedAccess="DelegatedAccess"}(ue||(ue={}));var xe=r(74527);const De="10px",Te=(0,a.J9)(((e,t)=>{const r={approvalCardDetail:[{borderRadius:"10px",".infoSection":[(0,i.gS)(),{margin:"5px",justifyContent:"space-between"}],".StatusText":{borderBottom:"1px solid lightgray",fontWeight:"bold",fontSize:"14px",height:"20px"},".personStatus":{float:"left",marginLeft:De},".actionButtons":{marginTop:De,marginBottom:De,button:{marginLeft:De}}}],moreButton:[(0,i.NX)(e),{float:"right",marginRight:De}],dialog:[(0,i.aS)(e),{".ms-Dialog-main":{borderRadius:"10px"}}],dialogButton:{borderRadius:"5px","&.ms-Button--primary":[(0,i.jU)(e)],"&.ms-Button--default":[(0,i.i9)(e)]}};return(0,s.TW)(r,t)})),ke=(0,a.J9)((e=>({title:[(0,i.aS)(e),(0,i.NX)(e)],topButton:{".ms-Dialog-button":[(0,i.aS)(e),(0,i.NX)(e),{":hover":[(0,i.aS)(e),{backgroundColor:"transparent"}]}]},inner:[(0,i.aS)(e),(0,i.NX)(e)]}))),qe=(0,a.J9)((e=>({approvalCardDetail:(0,s.Zq)("approvalCardDetail",e.approvalCardDetail),dialog:(0,s.Zq)("dialog",e.dialog),dialogButton:(0,s.Zq)("dialogButton",e.dialogButton),moreButton:(0,s.Zq)("moreButton",e.moreButton)})));class Re extends o.${name(){return"ApprovalCardDetail"}renderComponent(){var e;const t=this.getClassNames(),r={imageUrl:this.props.showCardInfo.imageUrl,imageInitials:this.props.showCardInfo.imageInitials,text:this.convertStatusText().personText,secondaryText:this.props.showCardInfo.showPeople};return h.createElement(j,{styles:ae(this.props.theme),className:t.approvalCardDetail},h.createElement(J,{title:null!==(e=this.convertStatusText().titleText)&&void 0!==e?e:"",className:"StatusText"}),h.createElement("div",{className:"infoSection"},h.createElement(G.F,{className:"personStatus",...r,size:X.WH.size40,styles:se(this.props.theme)}),h.createElement("div",{ref:this._moreChoiceRef},h.createElement(Ae.K,{className:t.moreButton,disabled:!this.props.enableMoreButtons,key:"more",iconProps:xe.XP,onClick:this.onTaskDialogMoreButtonClicked.bind(this),plannerTheme:this.props.theme}))),this.showApproverActions()?this.renderActionButtons():null,this.renderMoreOptionsContextMenu(),this.props.showCardInfo.status===_e.q.Requested?this.renderCancelDialog():this.props.showCardInfo.status===_e.q.Approved?this.renderClearDialog():null)}convertStatusText(){switch(this.props.showCardInfo.status){case _e.q.Requested:return{titleText:C.p.Strings.AddApprover_ApprovalCardDetail_StatusApprovalRequested,personText:C.p.Strings.AddApprover_ApprovalCardDetail_WaitingOn};case _e.q.Approved:return{titleText:C.p.Strings.AddApprover_ApprovalCardDetail_FinalStatusApproved,personText:C.p.Strings.AddApprover_ApprovalCardDetail_ApprovedBy};case _e.q.Rejected:case _e.q.Cancelled:case _e.q.UnknownFutureValue:default:return{titleText:C.p.Strings.AddApprover_AddApproverPicker_NAMark,personText:C.p.Strings.AddApprover_AddApproverPicker_NAMark}}}getClassNames(){return qe(Te(this.props.theme))}onTaskDialogMoreButtonClicked(e){this.setState((e=>({...e,isDialogContextMenuOpen:!e.isDialogContextMenuOpen})))}renderMoreOptionsContextMenu(){if(!this.state.isDialogContextMenuOpen)return null;const e=[];switch(this.props.showCardInfo.status){case _e.q.Requested:e.push({key:"cancelRequest",name:C.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,title:C.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,iconProps:xe.s5,onClick:this.changeDialogCancelConfirmStatus.bind(this)}),this.props.userRole!==ue.Approver&&this.props.userRole!==ue.Owner||e.push({key:"viewInApp",name:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:xe.M8,onClick:this.redirectToApprovalPage.bind(this)});break;case _e.q.Approved:e.push({key:"clearRequest",name:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,title:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,iconProps:xe.s5,onClick:this.changeDialogClearConfirmStatus.bind(this)}),this.props.userRole!==ue.Approver&&this.props.userRole!==ue.Owner||e.push({key:"viewInApp",name:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:xe.M8,onClick:this.redirectToApprovalPage.bind(this)});case _e.q.Rejected:case _e.q.Cancelled:case _e.q.UnknownFutureValue:}return h.createElement(me.l,{shouldFocusOnMount:!0,target:this._moreChoiceRef.current,onDismiss:this.onMoreContextMenuDismiss.bind(this),directionalHint:A.A.bottomLeftEdge,items:e,appTheme:this.props.theme})}renderCancelDialog(){const e={type:ge.h.normal,title:C.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequest,closeButtonAriaLabel:C.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:C.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequestQuestion,styles:ke(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return h.createElement(Ce.l,{hidden:!this.state.isDialogCancelConfirmOpen,onDismiss:this.changeDialogCancelConfirmStatus.bind(this),dialogContentProps:e,modalProps:r,minWidth:this.dialogWidth},h.createElement(fe.E,null,h.createElement(Y.j,{onClick:this.onCancelApproval.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_YesCancel,className:t.dialogButton}),h.createElement(K.Y,{onClick:this.changeDialogCancelConfirmStatus.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderClearDialog(){const e={type:ge.h.normal,title:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,closeButtonAriaLabel:C.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequestQuestion,styles:ke(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return h.createElement(Ce.l,{hidden:!this.state.isDialogClearConfirmOpen,onDismiss:this.changeDialogClearConfirmStatus.bind(this),dialogContentProps:e,modalProps:r},h.createElement(fe.E,null,h.createElement(Y.j,{onClick:this.onClearApproval.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_YesClear,className:t.dialogButton}),h.createElement(K.Y,{onClick:this.changeDialogClearConfirmStatus.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderActionButtons(){const e=this.getClassNames();return h.createElement("div",{className:"actionButtons"},h.createElement(Y.j,{styles:pe(this.props.theme),onClick:this.onUpdateApproval.bind(this,de.Approve),text:C.p.Strings.AddApprover_ApprovalCardDetail_Approve,className:e.dialogButton}),h.createElement(K.Y,{styles:pe(this.props.theme),onClick:this.onUpdateApproval.bind(this,de.Reject),text:C.p.Strings.AddApprover_ApprovalCardDetail_Reject,className:e.dialogButton}))}onMoreContextMenuDismiss(){this.setState({isDialogContextMenuOpen:!1})}changeDialogCancelConfirmStatus(){this.setState((e=>({...e,isDialogCancelConfirmOpen:!e.isDialogCancelConfirmOpen})))}changeDialogClearConfirmStatus(){this.setState((e=>({...e,isDialogClearConfirmOpen:!e.isDialogClearConfirmOpen})))}onCancelApproval(){this.props.onCancelApproval(),this.changeDialogCancelConfirmStatus()}onClearApproval(){this.props.onClearApproval(),this.changeDialogClearConfirmStatus()}onUpdateApproval(e){this.props.onUpdateApproval(e)}showApproverActions(){return this.props.showCardInfo.status===_e.q.Requested&&this.props.userRole===ue.Approver}redirectToApprovalPage(){const e="Default-".concat(ve.B.tenantId),t=this.props.approvalId,r=this.props.userRole,o="".concat(r,":").concat(t,":").concat("/providers/Microsoft.ProcessSimple/environments/approvalViews",":").concat(e),n=encodeURIComponent('{"subEntityId":"'.concat(o,'"}')),i="https://".concat(ve.B.clientSettings.TeamsSettings.TeamsHostName,"/l/entity/").concat(he.uc.ApprovalApp,"/approvals?context=").concat(n);Se.b.safelyOpenExternalUrl(i)}constructor(e,t){super(e,t),this.dialogWidth="600px",this._moreChoiceRef=h.createRef(),this.state={isDialogContextMenuOpen:!1,isDialogCancelConfirmOpen:!1,isDialogClearConfirmOpen:!1}}}var ye=r(69412),Pe=r(40135),be=r(31537),Ie=r(20751),Ne=r(21382),we=r(44535),Be=r(91834);class Ee extends o.${name(){return"ApprovalRequestSection"}renderComponent(){var e,t,r;const o=this.getClassNames(),n=this.generateApprovalCardDetailCardInfo();return this.props.isApprovalDataLoading?h.createElement(Pe.W,null):h.createElement("div",{className:o.approvalsSection},h.createElement("div",{className:o.titleSection},h.createElement(be.J,null,C.p.Strings.AddApprover_ApprovalRequestSection_ApprovalRequest,this.renderTitleMark(),this.renderStatusTag())),this.renderHistorySection(),this.showLinkSection()&&this.renderLinkSection(),this.props.selectedApprover&&h.createElement(ce,{theme:this.props.theme,selectedPerson:this.convertUserToApprovalPersona(this.props.selectedApprover),onDiscard:this.onDiscard,onSendRequest:this.onClickSendApprovalRequestButton}),!this.showLinkSection()&&n&&(null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.status)===Be.ZB.Stable&&h.createElement(Re,{theme:this.props.theme,showCardInfo:n,approvalId:null!==(t=null===(r=this.props.approvalInfo)||void 0===r?void 0:r.approvalId)&&void 0!==t?t:"",userRole:this.getUserRole(),onCancelApproval:this.onClickCancelApprovalRequestButton,onClearApproval:this.props.onClearApproval,onUpdateApproval:this.onClickUpdateApprovalRequestButton,enableMoreButtons:!this.props.isTaskCompleted}))}showLinkSection(){var e,t,r;return!this.isApprovalDataValid()||(null===(e=this.props.approvalInfo)||void 0===e?void 0:e.approvalStatus)===_e.q.Cancelled||(null===(t=this.props.approvalInfo)||void 0===t?void 0:t.approvalStatus)===_e.q.Rejected||(null===(r=this.props.approvalInfo)||void 0===r?void 0:r.approvalStatus)===_e.q.UnknownFutureValue}generateApprovalCardDetailCardInfo(){var e;const t=this.getApproverDisplayInfo();if(null===(e=this.props.approvalInfo)||void 0===e||!e.approvalId||!t)return null;return{status:this.props.approvalInfo.approvalStatus,showPeople:t.approverName,imageUrl:t.approverImage,imageInitials:we.$.parseInitialsFromName(t.approverName)}}getApproverDisplayInfo(){var e,t,r,o;const n=null!==(e=null===(t=this.props.approvalDetailInfo)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.approvers)&&void 0!==e?e:[];if(0===n.length||null===n[0])return null;const i=this.getUserInPrincipals(n[0]);return i?{approverName:null!==(r=i.displayName)&&void 0!==r?r:"",approverImage:null!==(o=i.thumbnailPhoto)&&void 0!==o?o:""}:null}getUserInPrincipals(e){var t,r;return null!==(t=null===(r=this.props.approvalDetailInfo)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.principals)||void 0===r?void 0:r.find((t=>(null===t||void 0===t?void 0:t.id)===e)))&&void 0!==t?t:null}convertStatusText(){var e,t,r,o,n,i;const a=this.getApproverDisplayInfo(),s=null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.data,p=null!==(t=null===(r=this.getUserInPrincipals(null===s||void 0===s||null===(o=s.owner)||void 0===o?void 0:o.id))||void 0===r?void 0:r.displayName)&&void 0!==t?t:"",l=null!==(n=null===a||void 0===a?void 0:a.approverName)&&void 0!==n?n:"",c=new Date(s.creationDate),d=c.toLocaleDateString(),u=c.toLocaleTimeString(),v=new Date(s.completionDate),h=v.toLocaleDateString(),m=v.toLocaleTimeString();switch(null===(i=this.props.approvalInfo)||void 0===i?void 0:i.approvalStatus){case _e.q.Requested:return{resultText:"",requestText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Requested,p,l,d,u)};case _e.q.Approved:return{resultText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Approved,l,h,m),requestText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.Rejected:return{resultText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Rejected,l,h,m),requestText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.Cancelled:return{resultText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Cancelled,p,h,m),requestText:Ne.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.UnknownFutureValue:default:return{resultText:C.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage,requestText:C.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage}}}isApprovalDataValid(){var e,t;return!(!(null!==(e=this.props.approvalInfo)&&void 0!==e&&e.approvalId&&null!==(t=this.props.approvalDetailInfo)&&void 0!==t&&t.data&&this.getApproverDisplayInfo())||this.isApprovalDetailError())}isApprovalDetailError(){return!this.props.approvalDetailInfo||this.props.approvalDetailInfo.status===Be.ZB.DeleteFailed||this.props.approvalDetailInfo.status===Be.ZB.Failed||this.props.approvalDetailInfo.status===Be.ZB.Inaccessible}renderTitleMark(){var e;return(null===(e=this.props.approvalInfo)||void 0===e?void 0:e.approvalStatus)===_e.q.Approved?h.createElement(Ie.I,xe.r8):h.createElement("text",{className:"requiredMark"},"*")}renderStatusTag(){var e;let t=1,r=C.p.Strings.AddApprover_ApprovalRequestSection_Required;if(null!==(e=this.props.approvalInfo)&&void 0!==e&&e.approvalId)switch(this.props.approvalInfo.approvalStatus){case _e.q.Requested:t=2,r=C.p.Strings.AddApprover_ApprovalRequestSection_Pending;break;case _e.q.Approved:t=3,r=C.p.Strings.AddApprover_ApprovalRequestSection_Approved;case _e.q.Cancelled:case _e.q.Rejected:case _e.q.UnknownFutureValue:}return h.createElement(ye.l,{index:t,isCollapsed:!1,title:r,showBorder:!1,theme:this.props.theme})}renderHistorySection(){if(!this.isApprovalDataValid())return null;const e=this.convertStatusText();return h.createElement("div",{className:this.getClassNames().historySection},h.createElement("b",null,e.resultText),e.requestText)}renderLinkSection(){return h.createElement("div",{className:this.getClassNames().linkSection},!this.props.selectedApprover&&this.renderAddApproverLink(),this.state.isPickerVisible&&this.renderAddApproverPicker())}renderAddApproverLink(){return h.createElement("div",{ref:this._linkButtonRef,className:this.getClassNames().addApproverButton},h.createElement("button",{onClick:this.onClickAddApproverLink},h.createElement(Ie.I,xe.D5),h.createElement("span",{className:"addApproverText"},C.p.Strings.AddApprover_AddApproverLink_AddAnApprover)))}renderAddApproverPicker(){return h.createElement(S,{theme:this.props.theme,peopleList:this.convertAssignees(),onSelectedPerson:this.onSelectedPerson,targetElement:this._linkButtonRef.current})}getClassNames(){return le(ie(this.props.theme))}convertAssignees(){return this.props.getAssigneePoolForApproval().map((e=>this.convertUserToApprovalPersona(e)))}convertUserToApprovalPersona(e){const t=this.props.getUserPhoto(e.id);return{user:e,imageUrl:null==t?void 0:t,text:e.displayName}}getUserRole(){var e;const t=null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.data,r=null===t||void 0===t?void 0:t.creator,o=null===t||void 0===t?void 0:t.approvers;return(null===r||void 0===r?void 0:r.id)===this.props.currentUserId?ue.Owner:null!==o&&void 0!==o&&o.includes(this.props.currentUserId)?ue.Approver:ue.NotSpecified}constructor(e,t){super(e,t),this._linkButtonRef=h.createRef(),this.onClickAddApproverLink=()=>{this.setState((e=>({...e,isPickerVisible:!e.isPickerVisible})))},this.onSelectedPerson=e=>{this.props.onSelectApprover(e.length>0?e[0].user:null),this.setState({isPickerVisible:!1})},this.onClickSendApprovalRequestButton=()=>{this.props.onSendApprovalRequest()},this.onDiscard=()=>{this.props.onSelectApprover(null)},this.onClickUpdateApprovalRequestButton=e=>{this.props.onUpdateApproval(e)},this.onClickCancelApprovalRequestButton=()=>{this.props.onCancelApproval()},this.state={isPickerVisible:!1}}}}}]);
//# sourceMappingURL=approvalrequestsection.db0a4016.chunk.js.map