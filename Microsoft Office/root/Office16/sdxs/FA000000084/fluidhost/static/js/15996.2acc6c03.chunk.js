"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[15996],{53787:(e,t,r)=>{r.d(t,{a:()=>d});var i=r(6326),n=r(65043),o=r(33516),a=r(23956),s=r(37142),l=r(65909),c=r(5944);function d(e,t){void 0===t&&(t={});var r=t.factoryOptions,d=(void 0===r?{}:r).defaultProp,h=function(r){var l=function(e,t,r){var i=["theme","styles","tokens"];return s.X.getSettings(r||i,e,t.customizations)}(t.displayName,n.useContext(a.z),t.fields),c=t.state;c&&(r=(0,i.__assign)((0,i.__assign)({},r),c(r)));var d=r.theme||l.theme,h=u(r,d,t.tokens,l.tokens,r.tokens),m=function(e,t,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];return o.TW.apply(void 0,i.map((function(i){return"function"===typeof i?i(e,t,r):i})))}(r,d,h,t.styles,l.styles,r.styles),v=(0,i.__assign)((0,i.__assign)({},r),{styles:m,tokens:h,_defaultStyles:m,theme:d});return e(v)};return h.displayName=t.displayName||e.name,d&&(h.create=(0,l.Bw)(h,{defaultProp:d})),(0,c.k)(h,t.statics),h}function u(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];for(var o={},a=0,s=r;a<s.length;a++){var l=s[a];l&&(l="function"===typeof l?l(e,t):l,Array.isArray(l)&&(l=u.apply(void 0,(0,i.__spreadArray)([e,t],l,!1))),(0,c.k)(o,l))}return o}},65909:(e,t,r)=>{var i;r.d(t,{Bw:()=>u,Sk:()=>m,WL:()=>d});var n=r(6326),o=r(65043),a=r(97002),s=r(66783),l=r(50605),c=r(5944);function d(e,t){for(var a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];var l=e;return l.isSlot?0===(a=o.Children.toArray(a)).length?l(t):l((0,n.__assign)((0,n.__assign)({},t),{children:a})):o.createElement.apply(i||(i=r.t(o,2)),(0,n.__spreadArray)([e,t],a,!1))}function u(e,t){void 0===t&&(t={});var r=t.defaultProp,i=void 0===r?"children":r;return function(t,r,s,d,u){if(o.isValidElement(r))return r;var h=function(e,t){var r,i;"string"===typeof t||"number"===typeof t||"boolean"===typeof t?((r={})[e]=t,i=r):i=t;return i}(i,r),m=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];for(var n={},o=[],s=0,d=r;s<d.length;s++){var u=d[s];o.push(u&&u.className),(0,c.k)(n,u)}return n.className=(0,a.e)([e,o],{rtl:(0,l.jI)(t)}),n}(d,u,t,h);if(s){if(s.component){var v=s.component;return o.createElement(v,(0,n.__assign)({},m))}if(s.render)return s.render(m,e)}return o.createElement(e,(0,n.__assign)({},m))}}var h=(0,s.J9)((function(e){return u(e)}));function m(e,t){var r={},i=e,n=function(e){if(t.hasOwnProperty(e)){var n=function(r){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(n.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return function(e,t,r,i,n,o){return void 0!==e.create?e.create(t,r,i,n):h(e)(t,r,i,n,o)}(t[e],r,i[e],i.slots&&i.slots[e],i._defaultStyles&&i._defaultStyles[e],i.theme)};n.isSlot=!0,r[e]=n}};for(var o in t)n(o);return r}},5944:(e,t,r)=>{r.d(t,{k:()=>i});var i=r(6326).__assign},10615:(e,t,r)=>{r.d(t,{E:()=>s});var i=r(53787),n=r(6326),o=r(65909),a=r(17066),s=(0,i.a)((function(e){if(null==e.children)return null;e.block,e.className;var t=e.as,r=void 0===t?"span":t,i=(e.variant,e.nowrap,(0,n.__rest)(e,["block","className","as","variant","nowrap"])),s=(0,o.Sk)(e,{root:r});return(0,o.WL)(s.root,(0,n.__assign)({},(0,a.G1)(i,a.vt)))}),{displayName:"Text",styles:function(e,t){var r=e.as,i=e.className,n=e.block,o=e.nowrap,a=e.variant,s=t.fonts,l=t.semanticColors,c=s[a||"medium"];return{root:[c,{color:c.color||l.bodyText,display:n?"td"===r?"table-cell":"block":"inline",mozOsxFontSmoothing:c.MozOsxFontSmoothing,webkitFontSmoothing:c.WebkitFontSmoothing},o&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},i]}}})},27200:(e,t,r)=>{r.d(t,{w:()=>n});var i=r(20723);function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i._;return e?r[t].map((t=>t.replace("{resource}",e))):r[t]}},20723:(e,t,r)=>{r.d(t,{P:()=>i,_:()=>n});const i={OneDrive:"OneDrive",SharePoint:"SharePoint",Graph:"Graph",GraphRead:"GraphRead"},n={Graph:["files.readwrite.all"],GraphRead:["files.read"],OneDrive:["{resource}/files.readwrite.all"],SharePoint:["{resource}/files.readwrite.all"]}},16775:(e,t,r)=>{r.d(t,{C:()=>i,b:()=>n});const i={ExchangeAppId:"00000002-0000-0ff1-ce00-000000000000",OwaAppId:"9199bf20-a13f-4107-85dc-02114787ef48",MonarchAppId:"5d661950-3475-41cd-a2c3-d671a3162bc1",LoopAppId:"a187e399-0c36-4b98-8f04-1edc167a0996",OfficeAppId:"d3590ed6-52b3-4102-aeff-aad2292ab01c"},n={Outlook:"Outlook",LoopEnabledApp:"LoopEnabledApp",LoopApp:"LoopApp"}},56090:(e,t,r)=>{r.d(t,{Kr:()=>n,QK:()=>o,o7:()=>i});const i={GetTokenError:"GetTokenError",GetTitleError:"GetTitleError"},n={RequestError:"RequestError",TelemetryInitialization:"TelemetryInitialization"},o={...n,RuntimeErrorBeforeUnfurl:"RuntimeErrorBeforeUnfurl",VideoUnfurlingInitialization:"VideoUnfurlingInitialization",OnePlayerTokenRetrieval:"OnePlayerTokenRetrieval",RedeemSharingLink:"RedeemSharingLink",IframePlayerSetup:"IFramePlayerSetup",OnePlayerWarmup:"OnePlayerWarmup",MissingVisibilityElement:"MissingVisibilityElement",VideoUnfurlTimeout:"VideoUnfurlTimeout"}},12851:(e,t,r)=>{r.d(t,{H:()=>n});var i=r(95996);function n(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t&&(0,i.hO)(t,{eventName:r,errorCode:n,...o},e)}},80194:(e,t,r)=>{r.d(t,{Qe:()=>o,Ym:()=>a});var i=r(65043),n=r(52563);const o=i.createContext({internationalizationContext:void 0,userContext:void 0});function a(){var e;const t=null===(e=i.useContext(o).internationalizationContext)||void 0===e?void 0:e.uiLocale;return(0,n.rv)(t)}},91730:(e,t,r)=>{r.d(t,{b:()=>o,h:()=>n});var i=r(65043);const n=i.createContext(void 0);function o(){return i.useContext(n)}},82500:(e,t,r)=>{r.d(t,{n:()=>n,z:()=>i});const i={VideoLoadFromUnfurl:"VideoLoadFromUnfurl",SetupIframeAfterBeforeUnload:"SetupIframeAfterBeforeUnload",VideoReloadFromUnfurl:"VideoReloadFromUnfurl"},n={GetVideoUnfurlInfo:"GetVideoUnfurlInfo",OnePlayerTokenRetrieval:"OnePlayerTokenRetrieval",VideoHydratedInDetachedMode:"VideoHydratedInDetachedMode",TimeInPlaybackLoopComponent:"TimeInPlaybackLoopComponent",SetupIframeAfterIframeForciblyUnloaded:"SetupIframeAfterIframeForciblyUnloaded"}},80789:(e,t,r)=>{r.d(t,{I:()=>i});const i="VideoPlaybackLoopComponent"},73540:(e,t,r)=>{r.d(t,{xn:()=>h,q_:()=>s,vd:()=>u,pG:()=>l,uc:()=>c,Nh:()=>a,d5:()=>d});var i=r(48680);const n={DefaultOptimizedIFrame:"video.defaultOptimizedIframe",GenericFileIFrame:"video.genericFileIframe",ThumbnailIframe:"video.thumbnailIframe",UseRedeemShareLinkHeader:"video.useRedeemShareLinkHeader",ObserveIsConnected:"video.observeIsConnected",CalculateT0WithScenarioStartTime:"video.calculateT0WithScenarioStartTime",FocusOutlineOffset:"video.focusOutlineOffset"};function o(e,t,r){return(0,i.AU)(e,null!==r&&void 0!==r&&r,t)}function a(e){return o(n.UseRedeemShareLinkHeader,e,!0)}function s(e){return o(n.DefaultOptimizedIFrame,e)}function l(e){return o(n.GenericFileIFrame,e)}function c(e){return o(n.ThumbnailIframe,e)}function d(e){return o(n.ObserveIsConnected,e,!0)}function u(e){return o(n.FocusOutlineOffset,e,!0)}function h(e){return o(n.CalculateT0WithScenarioStartTime,e,!0)}},15996:(e,t,r)=>{r.r(t),r.d(t,{VideoPlaybackComponent:()=>lt,createVideoPlaybackComponent:()=>ct,loopExport:()=>dt});var i=r(66783),n=r(51238),o=r(75368),a=r(22884),s=r(50264),l=r(44502),c=r(40656),d=r(75717),u=r(69817),h=r(43107),m=r(83125),v=r(65043);const p=r.p+"static/media/stream.7eacf5f14a28dc2803f444c363c72f18.svg",g="Stream",f="Isolated";class y{getName(){return Promise.resolve(g)}getIconUrl(){return Promise.resolve(p)}async getExperienceType(){return Promise.resolve(f)}get ComponentProperties(){return this}constructor(e){this.getTitle=e,this.experienceType=f,this.name=g,this.iconUrl=p}}var A=r(12851),C=r(56090),T=r(75460),w=r(27284);class P extends w.EventEmitter{get ComponentTitle(){return this}constructor(){super(...arguments),this.titlePromise=new T.c,this.title=void 0}}var S=r(87070);var I=r(16775);class b{get Disposable(){return this}dispose(){delete this.identityType,delete this.aadUserId,delete this.appId}get TokenProvider(){return this}async getToken(e,t){const r=await this.tokenProvider.getToken(e,t);if((!this.tokenProvider.identityType||"Enterprise"===this.tokenProvider.identityType)&&(!this.aadUserId||!this.appId))try{const e=(0,S.A)(r.token);this.aadUserId=e.oid,this.appId=e.appid}catch{(0,A.H)(void 0,this.logger,"DecodeTokenForAADId",C.Kr.TelemetryInitialization)}return"Consumer"===this.tokenProvider.identityType&&(this.appId=I.C.LoopAppId),r}get AADUserId(){return this.aadUserId}get AppID(){return this.appId}constructor(e,t){this.tokenProvider=e,this.logger=t,this.aadUserId=void 0,this.appId=void 0,this.identityType=e.identityType}}var E=r(33788),k=r(82500);const x=["3g2","3gp","3gpp","asf","avi","m2ts","m4v","mkv","mov","mp4","mp4v","mts","ts","webm","wmv"],R=new RegExp("/stream.aspx?","i"),U=new RegExp("/:v:/","i"),q=new RegExp("/onedrive.aspx?","i"),N=new RegExp("/allitems.aspx?","i"),L="".concat(x.join("|"),"|").concat(x.join("|").toUpperCase()),V=new RegExp("^https://([A-Za-z0-9-]{1,63}\\.)sharepoint(-df)?\\.com\\/(sites|contentstorage|personal|teams)\\/[%\\w-._].+?(".concat(L,")((\\?|&).*)?$"));class O{startAndSetUnfurlingTracker(){const e=E.m.start(k.z.VideoLoadFromUnfurl,this.logger,{isAPerformanceMetric:!0,additionalPropsToLog:{renderedViewType:this.renderedViewType,urlType:(t=this.videoUrl,t.search(U)>0?"ShortShareUrl":t.search(N)>0?"allitems.aspx":t.search(q)>0?"onedrive.aspx":t.search(R)>0?"stream.aspx":V.test(t)?"VideoWebUrl":"Unknown")}});var t;return this.activityTrackers.set(k.z.VideoLoadFromUnfurl,e),e.markSubActivityStart(k.n.TimeInPlaybackLoopComponent),e}async getVideoTitle(e){let t;try{t=(await this.videoUnfurlService.getEmbeddableInfo(e,!1)).title}finally{return t}}async unfurlStreamEmbeddedVideo(e,t){const r=this.startAndSetUnfurlingTracker();try{r.markSubActivityStart(k.n.GetVideoUnfurlInfo);const i=await this.videoUnfurlService.getEmbeddableInfo(e,t),n={videoId:i.videoId,hasVideoFacet:Boolean(i.height)&&Boolean(i.width),mimeType:i.mimeType};return r.markSubActivityEnd(k.n.GetVideoUnfurlInfo,n),i}catch(i){throw r.setResult(!1,{errorCode:C.QK.VideoUnfurlingInitialization,unfurlCorrelationId:this.unfurlCorrelationId},i),i}}constructor(e,t,r,i,n,o){this.videoUnfurlService=e,this.videoUrl=t,this.renderedViewType=r,this.logger=i,this.activityTrackers=n,this.unfurlCorrelationId=o}}var B=r(14525);let H;const D=e=>r(14526)("./".concat(e,"/VideoStrings.json"));function Q(e){return async function(e,t){var r;return(null===(r=H)||void 0===r?void 0:r.locale)!==t&&(H={locale:t,stringTablePromise:e(t).then((e=>(0,B.$)(e,t)))}),H.stringTablePromise}(D,e)}var z=r(58814);class W{buildEmbeddableUrl(e,t){return"".concat(e,"/_layouts/15/embed.aspx?uniqueId=").concat(t)}async getEmbeddableInfo(e,t){var r,i,n,o;this.videoInfoPromise&&!t||(this.videoInfoPromise=this.odspApi.getVideoInfo(e,t));const a=await this.videoInfoPromise,s=this.buildEmbeddableUrl(a.sharepointIds.siteUrl,a.sharepointIds.listItemUniqueId),l=null!==(r=a.listItem.fields.Title)&&void 0!==r?r:a.listItem.fields.LinkFilename;return{embeddableUrl:s,height:null===(i=a.video)||void 0===i?void 0:i.height,width:null===(n=a.video)||void 0===n?void 0:n.width,mimeType:null===(o=a.file)||void 0===o?void 0:o.mimeType,videoId:a.id,title:l}}constructor(e){this.odspApi=e}}var F=r(97950),j=r(7981),K=r(95996),G=r(80194),M=r(12179),J=r(83754),Y=r(62945),Z=r(91730);const X=e=>{let{children:t,logger:r,stylingProvider:i}=e;const n=function(e,t){const[r,i]=v.useState(void 0);return v.useEffect((()=>{if(!t)return;const e=e=>{if(!t.themeProperties||0===t.themeProperties.size)return;const r=Array.from(t.themeProperties,(e=>{let[t,r]=e;return{name:t,value:r}})),n=(0,M.x)(r),o=t.themeProperties.get(J._D.ThemeName);i({theme:n,themeName:o,themeProperties:t.themeProperties})};return t.addListener(Y.j.themePropertiesChanged,e),e(),()=>{t.removeListener(Y.j.themePropertiesChanged,e)}}),[t,i,e]),r}(r,i);return v.createElement(Z.h.Provider,{value:n},t)};var _=r(33516),$=r(23134);const ee={position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",aspectRatio:"16/9",borderRadius:8,maxWidth:768,maxHeight:512},te={backgroundColor:$.Wq.Neutral.neutralLighterAlt,border:"1px solid ".concat($.Wq.Neutral.neutralQuaternaryAlt2)},re=(e,t,r)=>(0,_.Zq)(ee,{width:r,height:t},e?void 0:te),ie={circle:{color:$.Wq.Theme.themePrimary,borderColor:"".concat($.Wq.Theme.themePrimary," ").concat($.Wq.Theme.themeLighterAlt," ").concat($.Wq.Theme.themeLighterAlt)}};var ne=r(40488),oe=r(57433);const ae=v.forwardRef((function(e,t){let{height:r,width:i,ariaLabel:n,children:o,customLoadingUI:a,hasLoaded:s,shouldLoadChildrenInBackground:l,isChildrenReady:c}=e;const d=a||v.createElement(ne.y,{size:oe.H.medium,ariaLabel:n,styles:ie,"data-testid":"embedded-loading-view"});return l?v.createElement("div",{ref:t,className:re(s&&!!c,r,i)},s?v.createElement(v.Fragment,null,v.createElement("div",{style:c?{display:"none"}:{display:"contents"}},d),v.createElement("div",{style:c?{display:"contents"}:{display:"none"},"data-is-visible":!!c},o)):d):v.createElement("div",{ref:t,className:re(s,r,i)},s?o:d)}));var se=r(58370),le=r(37664),ce=r(54306);const de=function(){return ce.A.Date.now()};var ue=r(92660),he=Math.max,me=Math.min;const ve=function(e,t,r){var i,n,o,a,s,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=i,o=n;return i=n=void 0,c=t,a=e.apply(o,r)}function v(e){var r=e-l;return void 0===l||r>=t||r<0||u&&e-c>=o}function p(){var e=de();if(v(e))return g(e);s=setTimeout(p,function(e){var r=t-(e-l);return u?me(r,o-(e-c)):r}(e))}function g(e){return s=void 0,h&&i?m(e):(i=n=void 0,a)}function f(){var e=de(),r=v(e);if(i=arguments,n=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(p,t),d?m(e):a}(l);if(u)return clearTimeout(s),s=setTimeout(p,t),m(l)}return void 0===s&&(s=setTimeout(p,t)),a}return t=(0,ue.A)(t)||0,(0,le.A)(r)&&(d=!!r.leading,o=(u="maxWait"in r)?he((0,ue.A)(r.maxWait)||0,t):o,h="trailing"in r?!!r.trailing:h),f.cancel=function(){void 0!==s&&clearTimeout(s),c=0,i=l=n=s=void 0},f.flush=function(){return void 0===s?a:g(de())},f};const pe=function(e,t,r){var i=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,le.A)(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),ve(e,t,{leading:i,maxWait:t,trailing:n})};var ge=r(32782);const fe=(0,_.Zq)({color:"var(".concat(ge.Jf.colorNeutralForeground1,", ").concat($.Wq.Neutral.neutralPrimary,")"),fontWeight:"var(--fontWeightSemibold, 600)",textAlign:"center",fontSize:16,lineHeight:22}),ye=(0,_.Zq)({color:"var(".concat(ge.Jf.colorNeutralForeground2,", ").concat($.Wq.Neutral.neutralSecondary,")"),textAlign:"center",marginTop:16,marginBottom:16,fontWeight:"var(--fontWeightRegular, 400)",fontSize:14,width:460,lineHeight:20}),Ae=(0,_.Zq)(ye,{width:"auto"}),Ce=(0,_.Zq)({color:"var(".concat(ge.Jf.colorNeutralForeground2,", ").concat($.Wq.Neutral.neutralSecondary,")"),textAlign:"center",marginTop:16,fontWeight:"var(--fontWeightRegular, 400)",fontSize:12,width:460,lineHeight:16}),Te=(0,_.Zq)(Ce,{width:"auto"}),we=((0,_.Zq)({marginTop:0}),(0,_.Zq)({height:"auto",width:128,marginBottom:16})),Pe=(0,_.Zq)(we,{display:"none"}),Se=(0,_.Zq)(we,{width:64});(0,_.Zq)({width:218}),(0,_.Zq)({width:416}),(0,_.Zq)({width:461});var Ie=r(10615),be=r(11638),Ee=r(36210);const ke=(0,_.Zq)({backgroundColor:"var(".concat(ge.Jf.colorNeutralBackground2,", ").concat($.Wq.Neutral.neutralLighterAlt,")"),border:"1px solid var(".concat(ge.Jf.colorNeutralStrokeAccessibleHover,", ").concat($.Wq.Neutral.neutralPrimary,", #575757)"),display:"flex",boxSizing:"border-box",borderRadius:12,justifyContent:"center",alignItems:"center"}),xe=(e,t)=>(0,_.Zq)((0,Ee.s2)(e,t),ke),Re=(0,_.Zq)({display:"flex",boxSizing:"border-box",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",padding:"31px 178.5px"}),Ue=(0,_.Zq)(Re,{padding:"32px 16px"}),qe=(0,_.Zq)(Re,{padding:"26px 98px"}),Ne=(0,_.Zq)({backgroundColor:"var(".concat(ge.Jf.colorNeutralBackground1,", ").concat($.Wq.Neutral.white,")"),border:"1px solid var(".concat(ge.Jf.colorNeutralStroke1,", ").concat($.Wq.Neutral.neutralSecondary,")"),color:"var(".concat(ge.Jf.colorNeutralForeground2,", ").concat($.Wq.Neutral.neutralSecondary,")"),":hover":{color:"var(".concat(ge.Jf.colorNeutralForeground1Hover,", ").concat($.Wq.Neutral.neutralDark,")"),backgroundColor:"var(".concat(ge.Jf.colorNeutralBackground1Hover,", ").concat($.Wq.Neutral.neutralLighter,")")},borderRadius:"var(--borderRadiusLarge, 8px)",fontWeight:"var(--fontWeightSemibold, 600)",padding:"0px 12px",height:32,fontSize:14}),Le={componentStyles:xe(512,768),containerStyles:Re,iconStyles:we,descriptionStyles:ye,correlationIdStyles:Ce},Ve=e=>{switch(e){case"Small":return{componentStyles:(0,_.Zq)((0,Ee.s2)(t,r),ke,{aspectRatio:"auto",height:"auto",minWidth:240}),containerStyles:Ue,iconStyles:Pe,descriptionStyles:Ae,correlationIdStyles:Te};case"Medium":return{componentStyles:xe(512,768),containerStyles:qe,iconStyles:Se,descriptionStyles:ye,correlationIdStyles:Ce};default:return{componentStyles:xe(512,768),containerStyles:Re,iconStyles:we,descriptionStyles:ye,correlationIdStyles:Ce}}var t,r};var Oe=r(26887),Be=r(73540),He=r(80220);const De=v.memo((e=>{const{setViewRootElement:t,endRenderingActivity:r,error:i,strings:o,reloadComponent:a,settingsProvider:s,onCardClick:l}=e,c=v.useRef(null),[d,u]=v.useState(void 0),{title:h,description:m,errorType:p}=function(e,t,r){return e instanceof Oe.L&&(403===e.status||404===e.status)&&!r?{title:t.noAccessOrNotFoundErrorTitle,description:t.noAccessOrNotFoundErrorDescription,errorType:"noAccessOrNotFound"}:{title:t.genericErrorTitle,description:t.genericErrorDescription,errorType:"generic"}}(i,o,!(0,Be.Nh)(s)),g=v.useRef(Le),f=(0,He.i)().additionalTelemetryProperties.unfurlCorrelationId,y=v.useCallback((e=>{"noAccessOrNotFound"===p?(null===l||void 0===l||l(e),e.stopPropagation()):(a(),e.stopPropagation())}),[a,p,l]),A=v.useCallback((e=>{e.stopPropagation()}),[]);var C,T;v.useEffect((()=>{c.current&&t(c.current),r(se.G.Card)}),[c,t,r]),C=c,T=e=>((e,t,r,i,n)=>{r!==t&&(t<480?e.current=n("Small"):t<640?e.current=n("Medium"):t<1024&&(e.current=n("Large")),i(t))})(g,e,d,u,Ve),v.useEffect((()=>{const e=C.current,t=new ResizeObserver(pe((e=>{for(const t of e){const{width:e}=t.contentRect;T(e)}}),100,{leading:!0,trailing:!0}));return e&&t.observe(e),()=>{e&&t.unobserve(e)}}),[C,T]);const w=(0,n.A)();return v.createElement("div",{className:g.current.componentStyles,tabIndex:0,ref:c,role:"alert","aria-labelledby":"error-label-".concat(w," error-desc-").concat(w),"data-testid":"error-view"},v.createElement("div",{className:g.current.containerStyles},v.createElement("img",{src:"data:image/png;base64,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","aria-hidden":"true",alt:"",className:g.current.iconStyles}),v.createElement(Ie.E,{"data-testid":"error-title",className:fe,id:"error-label-".concat(w)},h),v.createElement(Ie.E,{className:g.current.descriptionStyles,id:"error-desc-".concat(w)},m),v.createElement(be.Y,{className:Ne,onClick:y,onKeyDown:A},"noAccessOrNotFound"===p?o.requestAccessOnError:o.reloadActionOnError),v.createElement(Ie.E,{"data-testid":"error-correlation-id",className:g.current.correlationIdStyles},"".concat(o.correlationIdText,": ").concat(f))))}));var Qe=r(75704),ze=r(85540);const We=new Qe.I((()=>r.e(82368).then(r.bind(r,87209)).then((e=>e.StreamEmbeddedRenderer))));function Fe(e,t,r,i,n){const o=(0,ze.U)(),a=v.useRef(!1),[s,l]=v.useState(),c=function(e){const t=v.useRef();return v.useEffect((()=>{t.current=e}),[e]),t.current}(r),d=v.useMemo((()=>{const t=new URL(e.videoUrl).searchParams.get("referrerScenario");return t?t.split(".")[0]:""}),[e.videoUrl]),u=v.useMemo((()=>{const t=new URL(e.videoUrl).searchParams.get("nav");if(t){var r;const e=atob(t);return null===(r=JSON.parse(e).playbackOptions)||void 0===r?void 0:r.startTimeInSeconds}}),[e.videoUrl]);return v.useEffect((()=>{"StreamEmbedded"!==t||c&&c===r||a.current||(a.current=!0,Promise.all([e.unfurlStreamEmbeddedVideo(e.videoUrl,c!==r),We]).then((e=>{let[t,r]=e;l({componentViewType:"StreamEmbedded",component:r,embeddableUrl:t.embeddableUrl,height:t.height,width:t.width,hostView:d,startTimeInSeconds:u,playerLoads:n}),a.current=!1})).catch((e=>{i(e),(0,A.H)(e,o,"useCreateComponentProps",C.QK.RuntimeErrorBeforeUnfurl),a.current=!1,n.current+=1})))}),[e,i,t,o,r,c,d,u,n]),s}class je{}const Ke=e=>{let{unfurlController:t,renderedViewType:r,setViewRootElement:i,playbackStateSetter:n,onKeyDownHandler:o,onCardClick:a,endRenderingActivity:s,updateTitle:l,strings:c,videoUrl:d,settingsProvider:u}=e;const[h,m]=v.useState(),[p,g]=v.useState(!1),[f,y]=v.useState(!1),{componentState:T,rerenderComponent:w}=function(){const[e,t]=v.useState();return{componentState:e,rerenderComponent:function(){t((()=>new je))}}}(),P=(0,ze.U)(),S=(0,He.i)(),I=v.useRef(null),b=v.useRef(0),E=v.useCallback((()=>{m(void 0),w(),g(!1)}),[m,w,g]),k=Fe(t,r,T,m,b);return v.useEffect((()=>{k&&g(!0)}),[k]),v.useEffect((()=>{let e;return h||f||(e=setTimeout((()=>{y(!0);const e=S.additionalTelemetryProperties.unfurlCorrelationId;(0,A.H)(null,P,"VideoUnfurlTimeout",C.QK.VideoUnfurlTimeout,{unfurlCorrelationId:e})}),3e4)),()=>{clearTimeout(e)}}),[f,h,P,3e4,S.additionalTelemetryProperties.unfurlCorrelationId]),h?v.createElement(ae,{ariaLabel:c.videoViewLoadingText,hasLoaded:!0},v.createElement(De,{strings:c,setViewRootElement:i,onCardClick:a,endRenderingActivity:s,error:h,reloadComponent:E,settingsProvider:u})):v.createElement(ae,{hasLoaded:p,ariaLabel:c.videoViewLoadingText,shouldLoadChildrenInBackground:!0,isChildrenReady:f},k&&v.createElement("div",{ref:I,className:(0,Ee.s2)(k.height,k.width)},v.createElement(Ge,{...k,strings:c,parentRef:I,playbackStateSetter:n,endRenderingActivity:s,onKeyDownHandler:o,setViewRootElement:i,updateTitle:l,setIsPlayerReady:y,videoUrl:d})))},Ge=e=>v.createElement(e.component,e);var Me=r(12910),Je=r(67048);const Ye="videoPlaybackComponent-root";const Ze=e=>{let{children:t,componentSelection:r}=e;return v.createElement(Je.Y,{disableFirstFocus:!0,isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disabled:!r},v.createElement("div",{"data-automation-id":Ye,className:Ee.k2},t))},Xe=v.memo((e=>{let{activityTrackers:t,providers:r,componentSelection:i,additionalTelemetryProperties:n,...o}=e;const{StylingProvider:a,TokenProvider:s,NamespaceLogger:l,SettingsProvider:c,UserContext:d,InternationalizationContext:u,TelemetryConfig:h}=r;return v.createElement(ze.b.Provider,{value:l},v.createElement(G.Qe.Provider,{value:{userContext:d,internationalizationContext:u}},v.createElement(He.b.Provider,{value:{activities:t,telemetryConfig:h,settingsProvider:c,additionalTelemetryProperties:n}},v.createElement(X,{logger:l,stylingProvider:a},v.createElement(Me.Q.Provider,{value:s},v.createElement(Ze,{componentSelection:i},v.createElement(Ke,{settingsProvider:c,...o})))))))}));var _e=r(93085),$e=r(84083);const et=v.memo((e=>{var t;const{strings:r,unfurlController:i,componentTitle:n,onKeyDownHandler:o,onCardClick:a,endRenderingActivity:s,setViewRootElement:l}=e,c=v.createRef(),[d,u]=v.useState();return n.titlePromise.then(u).catch((()=>{})),v.useEffect((()=>{c.current&&(l(c.current),s(se.G.Pill))}),[c,s,l]),v.createElement(_e.EM,{title:null!==(t=n.title||d)&&void 0!==t?t:i.videoUrl,link:i.videoUrl,parentRef:c,onKeyDown:o,onClick:a,loadingText:r.videoViewLoadingText,unauthedText:r.videoViewUnauthorizedText,logoSrc:(0,$e.Rm)(p)})}));class tt extends j.L{get ContentPlayable(){return this.playbackStateSetter}async getBaseProps(e){return{strings:await this.strings,setViewRootElement:this.setViewRootElement,endRenderingActivity:this.endVideoComponentRenderingActivity,onCardClick:this.onClickHandler,onKeyDownHandler:this.onKeyDownHandler,unfurlController:e}}cleanUp(){this.element&&(F.unmountComponentAtNode(this.element),this.element=void 0,(0,K.o4)(this.providers.NamespaceLogger,{eventName:"RemoveVideoPlaybackComponent"}))}async getCommandStrings(){const e=await this.strings;return{openLinkCommandDisplayName:e.videoOpenLink,copyLinkCommandDisplayName:e.videoCopyLink}}async onLocaleUpdated(e){if(this.strings=e,this.element)return this.render(this.element)}isComponentFocused(){return!!this.viewRef.current&&this.viewRef.current.contains(document.activeElement)}giveFocus(e){return this.setFocus()}setFocus(){var e;return null===(e=this.viewRef.current)||void 0===e||e.focus(),this.isComponentFocused()}clear(){}getViewRootElement(){return this.viewRootElementPromise}get ViewRootElement(){return this}get IFluidHTMLView(){return this}async renderView(e){try{const t=await this.controllerResolverPromise();this.element=e,this.isInline()?await this.renderPillView(t,e):await this.renderEmbeddedView(t,e)}catch(t){throw(0,A.H)(t,this.providers.NamespaceLogger,"renderViewError",C.QK.RuntimeErrorBeforeUnfurl),t}}async renderPillView(e,t){const r=await this.getBaseProps(e);F.render(v.createElement(et,{...r,componentTitle:this.componentTitle}),t)}async renderEmbeddedView(e,t){const r=await this.getBaseProps(e),{renderedViewType:i}=this.configContext;this.addAdditionalProps({renderedViewType:i}),F.render(v.createElement(Xe,{providers:this.providers,renderedViewType:i,activityTrackers:this.activityTrackers,playbackStateSetter:this.playbackStateSetter,componentSelection:this.ComponentSelection.hostComponent,additionalTelemetryProperties:this.additionalTelemetryProperties,updateTitle:this.updateTitle,videoUrl:this.url,...r}),t)}disposeView(){this.cleanUp()}remove(){this.cleanUp()}constructor(e,t,r,i,n,o,a,s,l,c,d,u,h,m){super({url:e},r,i,n,o,"Video",!0,m),this.url=e,this.strings=t,this.providers=r,this.controllerResolverPromise=a,this.updateTitle=s,this.configContext=l,this.componentTitle=c,this.activityTrackers=d,this.playbackStateSetter=u,this.additionalTelemetryProperties=h,this.viewRootElementPromise=new T.c,this.endVideoComponentRenderingActivity=e=>{this.endRenderingActivity(e)},this.setViewRootElement=e=>{this.viewRef={current:e},this.viewRootElementPromise.resolve(e)}}}class rt{initialize(e){this.currentPlayer=e}getPlaybackState(){var e;return"Playing"===(null===(e=this.currentPlayer)||void 0===e?void 0:e.playState.value)?"Playing":"Paused"}pause(){return!!this.currentPlayer&&(this.currentPlayer.playState.value="Paused",!0)}play(){return!!this.currentPlayer&&(this.currentPlayer.playState.value="Playing",!0)}}class it extends w.EventEmitter{get ContentPlayable(){return this}getPlaybackState(){return this.setter?this.setter.getPlaybackState():"Paused"}initialize(e){this.setter=new rt,this.setter.initialize(e)}pause(){return!!this.setter&&this.setter.pause()}play(){return!!this.setter&&this.setter.play()}raiseIsPlaying(){this.emit("playbackStateChanged","Playing")}raiseIsPaused(){this.emit("playbackStateChanged","Paused")}}const nt="test";function ot(e){var t,r,i;const n=e.toString().replace("https://".concat(nt,"/"),""),o=decodeURIComponent(n),a=JSON.parse(o);return{webUrl:null!==(t=a.progressiveUrl)&&void 0!==t?t:"",progressiveUrl:null!==(r=a.progressiveUrl)&&void 0!==r?r:"",resource:null!==(i=a.resource)&&void 0!==i?i:"",getManifestUrl:()=>Promise.resolve(a.manifestUrl),getClosedCaptionsUrls:()=>Promise.resolve([])}}const at={TokenProvider:"TokenProvider",StylingProvider:"StylingProvider",UserContext:"UserContext",TelemetryConfig:"TelemetryConfig",...r(37828).y},st=(0,i.J9)((e=>Q(e)));class lt extends a.J{onLocaleUpdated(){(async()=>{Promise.all(this.views.map((async e=>e.onLocaleUpdated(this.getStrings())))).catch((()=>{}))})().catch((()=>{}))}get HTMLViewable(){return this}get IFluidHTMLView(){return this.initialView}get ContentPlayable(){return this.playbackStateSetter}getVideoUrl(){return this.urlData.url}get IViewLayout(){return{canInline:!0,IViewLayout:this}}get ComponentInitializer(){return this}get ComponentProperties(){return void 0===this.videoComponentProperties&&(this.videoComponentProperties=new y(this.getTitle)),this.videoComponentProperties}get ComponentTitle(){return this.videoComponentTitle}async initialize(){this.hasInitialized||(void 0===this.videoComponentTitle.title&&this.getTitle().then(this.updateTitle).catch((e=>{(0,A.H)(e,this.providers.NamespaceLogger,"Initialize",C.o7.GetTitleError)})),this.hasInitialized=!0)}on(e,t){return this}off(e,t){return this}async getStrings(){return await st(this.contentLocale)}getControllerResolver(){return async()=>{if(this.controller)return this.controller;const{NamespaceLogger:e,TokenProvider:t,SettingsProvider:r}=this.providers,{renderedViewType:i}=this.configContext,n=new z.H(t,e,r,{unfurlCorrelationId:this.additionalTelemetryProperties.unfurlCorrelationId});return this.controller=new O(new W(n),this.getVideoUrl().toString(),i,e,this.activityTrackers,this.additionalTelemetryProperties.unfurlCorrelationId),this.controller}}getView(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Promise.resolve(this.createView(e))}createView(e){const t=new tt(this.getVideoUrl(),this.getStrings(),this.providers,this.ComponentClipboardProvider,this.openLink,0===this.views.length,this.getControllerResolver(),this.updateTitle,this.configContext,this.ComponentTitle,this.activityTrackers,this.playbackStateSetter,this.additionalTelemetryProperties,e);return this.views.push(t),t}async getPrintView(){return this.createView(!0)}constructor(e,t){super("VideoPlayback",e,t),this.providers=t,this.activityTrackers=new Map,this.playbackStateSetter=new it,this.videoComponentTitle=new P,this.hasInitialized=!1,this.variableHeight=!0,this.canInline=!1,this.views=[],this.additionalTelemetryProperties={unfurlCorrelationId:(0,n.A)(),variableTimeOrigin:Date.now()-performance.now()},this.getTitle=()=>this.getControllerResolver()().then((e=>e.getVideoTitle(this.getVideoUrl().toString()))),this.updateTitle=e=>{this.videoComponentTitle.titlePromise.resolve(e),this.videoComponentTitle.title=e,this.videoComponentTitle.emit("titleChanged",e)};const r=this.getVideoUrl();var i;this.configContext={providedPlaybackContext:(i=r,i.host===nt?ot(r):void 0),renderedViewType:"StreamEmbedded"},this.initialView=this.createView(!1)}}async function ct(e,t){if(!t)throw Error("Expected providers to be defined, got undefined");const[r,i,n,a,u,h,v,p,g,f,y]=await Promise.all([t.CommandingSurface,t.LinkService,t.NamespaceLogger,t.TokenProvider,t.OfficePolicyProvider,t.SettingsProvider,t.StylingProvider,t.UserContext,t.InternationalizationContext,t.TelemetryConfig,t.UrlHandlerProvider]),A=null!==i&&void 0!==i?i:y?void 0:new s.D,C=n?new m.p("Video",n):new l.z;if(!(0,c.I)(e,o.kW))throw new Error("Unexpected initial configuration");if(!a)throw new Error("Missing TokenProvider");const T={CommandingSurface:r,LinkService:A,NamespaceLogger:C,TokenProvider:new b(a,C),OfficePolicyProvider:null!==u&&void 0!==u?u:new d.S,SettingsProvider:h,StylingProvider:v,UserContext:p,InternationalizationContext:g,TelemetryConfig:f,UrlHandlerProvider:y};return new lt(e,T)}const dt=new u.q(ct,at,[],[h.X])},58814:(e,t,r)=>{r.d(t,{H:()=>A});var i=r(33788),n=r(72376),o=r(74405),a=r(43172),s=r(29018),l=r(27200),c=r(20723),d=r(56090),u=r(93537);const h=["code","message"],m=["error"];var v=r(40635);var p=r(80789),g=r(26887),f=r(73540);const y={...n._9,filter:(0,u.sC)([408,409,503,709,710])};class A{async oneDriveFetch(e,t,r,n,u){const p=(0,l.w)(e,void 0===e?c.P.Graph:c.P.OneDrive),f="/_api/v2.0/",A=void 0===e?"https://graph.microsoft.com/v1.0/":"".concat(e).concat(f),C=e=>this.tokenProvider.getToken(p,e),T=i.m.start(r,this.logger);let w,P;try{w=await async function(e,t,r,i,n,a,s,l){let c=arguments.length>9?arguments[9]:void 0;const d={getToken:e,url:t,tenantId:void 0,requestInit:n,retryPolicy:a,tokenPolicy:s,timeoutMs:arguments.length>8&&void 0!==arguments[8]?arguments[8]:0},u=(0,v.g)({...d,logger:i,nameForLogging:r,doNotLogOnSuccess:c,getAdditionalProps:async(e,t)=>({...(0,o.u)(e),...l})});return(await u).result}(C,"".concat(A).concat(t),r,this.logger,n,y,u,this.extraTelemetryInfo),P=(0,o.u)(w).spRequestGuid;let e={sPRequestGUID:P,responseOk:w.ok,statusCode:w.status,statusText:w.statusText,responseType:w.type,redirected:w.redirected,...this.extraTelemetryInfo};if(w.ok)return T.setResult(!0,e),w.json();{var S,I;const t=await w.json();let i="vroom fetch request failed";const o=(0,a.J)(w.headers);if(709===w.status||710===w.status)throw new g.L("".concat(i,". User connectivity issue"),w.status);if(function(e){if("object"!==typeof e||null===e)return!1;let t=!0;return m.forEach((r=>{var i;e.hasOwnProperty(r)?(i=e.error,t="object"===typeof i&&null!==i&&0===h.filter((e=>!i.hasOwnProperty(e))).length):t=!1})),t}(t)&&(i=t.error.message,e={...e,errorCode:d.QK.RequestError,apiMessage:i,apiErrorCode:t.error.code,videoResourceTenantGuid:o}),T.setResult(!1,e,new Error(i)),"itemNotFound"===(null===(S=t.error)||void 0===S?void 0:S.code)&&null!==(I=t.error)&&void 0!==I&&I["@error.redirectLocation"]){const e=t.error["@error.redirectLocation"],i=(0,s.$)(e),o=e.split(f)[1];return this.oneDriveFetch(i,o,r,n,u)}throw new g.L(i,w.status)}}catch(b){throw T.setResult(!1,{errorCode:d.QK.RequestError},b),b}}getRequestInit(e,t,r,i){const n=new Headers({Application:p.I,Scenario:r,ScenarioType:"AUO"});return t&&n.append("Prefer","redeemSharingLink"),i&&n.append("Prefer","manualRedirect"),{method:e,headers:n}}async getVideoInfo(e,t){const r="u!"+btoa(e).replace(/=+$/g,"").replace(/\//g,"_").replace(/\+/g,"-");const i=(0,s.$)(e),n="shares/".concat(r,"/driveItem?select=video,sharepointIds,id,file&$expand=listItem(expand=fields($select=title, linkFilename))"),o=await this.oneDriveFetch(i,n,"GetVideoInfoFromVideoUrl",this.getRequestInit("GET",t||(0,f.Nh)(this.settingsProvider),"ReadFile",!0));return o}async getSpecialFolder(e){const t="me/drive/special/".concat(e,"?select=webUrl"),r=await this.oneDriveFetch(void 0,t,"GetSpecialFolder",this.getRequestInit("GET",!1,"ReadFile"));return r}constructor(e,t,r,i){this.tokenProvider=e,this.logger=t,this.settingsProvider=r,this.extraTelemetryInfo=i}}},26887:(e,t,r)=>{r.d(t,{L:()=>i});class i extends Error{constructor(e,t){super(e),this.status=t,this.name="APIError"}}},85540:(e,t,r)=>{r.d(t,{U:()=>o,b:()=>n});var i=r(65043);const n=i.createContext(void 0);function o(){return i.useContext(n)}},80220:(e,t,r)=>{r.d(t,{b:()=>n,i:()=>o});var i=r(65043);const n=i.createContext({activities:new Map,telemetryConfig:void 0,settingsProvider:void 0,additionalTelemetryProperties:{unfurlCorrelationId:"-1",variableTimeOrigin:-1}});function o(){return i.useContext(n)}},12910:(e,t,r)=>{r.d(t,{Q:()=>o,_:()=>a});var i=r(65043),n=r(98504);const o=i.createContext(void 0);function a(){const e=i.useContext(o);return(0,n.v)(!!e,"Expected TokenProvider to be defined in TokenProviderContext, got undefined"),e}},36210:(e,t,r)=>{r.d(t,{hS:()=>d,Ig:()=>u,qo:()=>h,s2:()=>p,k2:()=>v,Fj:()=>s});var i=r(83754),n=r(47027),o=r(33516);var a=r(66783);const s="--video-themePrimaryColor",l=(0,a.J9)((e=>(0,o.Zq)({outline:"solid 2px",outlineColor:"var(".concat(i.KM.FocusBorder,")"),...e&&{outlineOffset:"-2px"},[o.up]:{outlineColor:n.H.SelectedBackground,...(0,o.Qg)()},".video-outline-container::after":{display:"none !important"}}))),c=e=>l(e),d=(e,t)=>{null===e||void 0===e||e.classList.add(c(t))},u=(e,t)=>{null===e||void 0===e||e.classList.remove(c(t))},h=e=>(0,o.Zq)({width:"100%",height:"100%","& iframe":{width:"100%",height:"100%",borderRadius:8},[s]:e}),m=(0,o.Zq)({overflow:"hidden",borderRadius:8}),v=(0,o.Zq)({width:768,maxWidth:"100%"}),p=(e,t)=>(0,o.Zq)(((e,t)=>{if(!e||!t||t>=e){const r=e&&t?"".concat(t,"/").concat(e):"16/9";return(0,o.Zq)({aspectRatio:r,margin:"0 auto",width:"100%",height:"100%",minHeight:162,minWidth:288,maxHeight:512,maxWidth:768})}return(0,o.Zq)({aspectRatio:"".concat(t,"/").concat(e),margin:"0 auto",minHeight:428,minWidth:240,maxHeight:428,maxWidth:241})})(e,t),m)},75622:(e,t,r)=>{r.d(t,{A:()=>i});const i=r(54306).A.Symbol},14802:(e,t,r)=>{r.d(t,{A:()=>h});var i=r(75622),n=Object.prototype,o=n.hasOwnProperty,a=n.toString,s=i.A?i.A.toStringTag:void 0;const l=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var i=!0}catch(l){}var n=a.call(e);return i&&(t?e[s]=r:delete e[s]),n};var c=Object.prototype.toString;const d=function(e){return c.call(e)};var u=i.A?i.A.toStringTag:void 0;const h=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?l(e):d(e)}},58187:(e,t,r)=>{r.d(t,{A:()=>i});const i="object"==typeof global&&global&&global.Object===Object&&global},54306:(e,t,r)=>{r.d(t,{A:()=>o});var i=r(58187),n="object"==typeof self&&self&&self.Object===Object&&self;const o=i.A||n||Function("return this")()},37664:(e,t,r)=>{r.d(t,{A:()=>i});const i=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},53239:(e,t,r)=>{r.d(t,{A:()=>i});const i=function(e){return null!=e&&"object"==typeof e}},92660:(e,t,r)=>{r.d(t,{A:()=>p});var i=/\s/;const n=function(e){for(var t=e.length;t--&&i.test(e.charAt(t)););return t};var o=/^\s+/;const a=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e};var s=r(37664),l=r(14802),c=r(53239);const d=function(e){return"symbol"==typeof e||(0,c.A)(e)&&"[object Symbol]"==(0,l.A)(e)};var u=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,m=/^0o[0-7]+$/i,v=parseInt;const p=function(e){if("number"==typeof e)return e;if(d(e))return NaN;if((0,s.A)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,s.A)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=a(e);var r=h.test(e);return r||m.test(e)?v(e.slice(2),r?2:8):u.test(e)?NaN:+e}}}]);
//# sourceMappingURL=15996.2acc6c03.chunk.js.map