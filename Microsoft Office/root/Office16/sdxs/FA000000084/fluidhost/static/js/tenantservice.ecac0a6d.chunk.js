"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[96924],{94283:(e,t,i)=>{i.d(t,{k:()=>p});var s=i(55491),r=i.n(s),a=i(54320),l=i.n(a),n=i(91246);class o{build(){return new p(this)}fromSensitivityLabelResource(e){var t;const i=null===(t=e.sublabels)||void 0===t?void 0:t.map((e=>(new o).fromSensitivityLabelResource(e)));return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:e.groupAllowGuestUsers,groupPrivacy:e.groupPrivacy,sublabels:i})}fromGraphResource(e){var t;const i=null===(t=e.sublabels)||void 0===t?void 0:t.map((e=>(new o).fromGraphResource(e)));let s=this.groupAllowGuestUsers,r=this.groupPrivacy;const a=e.labelActions;if(a&&!l()(a))for(const l of a)if("protectGroup"===l.name){var n,u;s=null!==(n=l.allowGuestUsers)&&void 0!==n&&n,r=null!==(u=l.privacy)&&void 0!==u?u:this.groupPrivacy;break}return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:s,groupPrivacy:r,sublabels:i})}withPropertyBag(e){var t,i;return this.id=e.id||this.id,this.name=e.name||this.name,this.displayName=e.displayName||this.displayName,this.description=e.description||this.description,this.toolTip=e.toolTip||this.toolTip,this.isDefault=null!==(t=e.isDefault)&&void 0!==t?t:this.isDefault,this.priority=e.priority||this.priority,this.groupAllowGuestUsers=null!==(i=e.groupAllowGuestUsers)&&void 0!==i?i:this.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy||this.groupPrivacy,this.sublabels=e.sublabels||this.sublabels,this}withValidData(){return this.withPropertyBag({id:n.o.generate()})}constructor(){this.id="",this.name="",this.displayName="",this.description="",this.toolTip="",this.isDefault=!1,this.priority=0,this.groupAllowGuestUsers=!0,this.groupPrivacy="",this.sublabels=null}}var u=i(21382),h=i(86053);class p{static get builder(){return new o}static getDefaultSensitivityLabel(e){if(l()(e))return null;let t=null;return r()(e,(e=>{if(e.isDefault?t=e:null!=e.sublabels&&r()(e.sublabels,(e=>{if(e.isDefault)return t=e,!1})),null!=t)return!1})),t}static getSensitivityLabel(e,t){if(l()(e)||l()(t))return null;let i=null;return r()(t,(t=>{if(t.id===e?i=t:null!=t.sublabels&&r()(t.sublabels,(t=>{if(t.id===e)return i=t,!1})),null!=i)return!1})),i}static getParentSensitivityLabel(e,t){if(l()(e)||l()(t))return null;let i=null;return r()(t,(t=>{if(null!=t.sublabels&&r()(t.sublabels,(s=>{if(s.id===e)return i=t,!1})),null!=i)return!1})),i}static getFullSensitivityTitle(e,t){var i;if(l()(e)||l()(t))return"";const s=p.getSensitivityLabel(e,t),r=p.getParentSensitivityLabel(e,t);return s&&r?u.G(h.p.Strings.SensitivityLabel_FullTitle,r.displayName,s.displayName):null!==(i=null===s||void 0===s?void 0:s.displayName)&&void 0!==i?i:""}constructor(e){this.id=e.id,this.name=e.name,this.displayName=e.displayName,this.description=e.description,this.toolTip=e.toolTip,this.isDefault=e.isDefault,this.priority=e.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy,this.sublabels=null,null!=e.sublabels&&(this.sublabels=[],e.sublabels.forEach((e=>{this.sublabels.push(new p(e))})))}}},94266:(e,t,i)=>{i.d(t,{R:()=>r});var s=i(45078);class r{appendSharepointAuthenticationChallengeHeaders(e){return e[s.Er.AuthenticationChallengeHeaderName]=s.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const t=new URL(e);return new URLSearchParams(t.search).get(this.skipTokenParam)}catch{return null}}constructor(e,t,i){this.name=e,this.hostDomain=t,this.ajaxClient=i,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[s.a8.ClientRequestId],this.loggableResponseHeaders=[s.Qu.RequestId,s.Qu.ClientRequestId,s.Qu.TCorrelationId]}}},56088:(e,t,i)=>{i.r(t),i.d(t,{TenantService:()=>h});var s=i(94283),r=i(55337),a=i(5312),l=i(94266),n=i(98990),o=i.n(n),u=i(98502);class h extends l.R{async getSensitivityLabelsAsync(){const e="".concat(this.hostDomain,"/").concat(this.vBetaUrlToken,"/").concat("me/informationProtection/sensitivityLabels?$filter=applicableTo+has+'site,unifiedGroup'"),t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getSensitivityLabelsAsync")});try{const e=await t.clone().json();if(null==e||!e.value)throw u.g.generateAjaxClientError(t,"No sensitivity labels returned");return e.value.map((e=>s.k.builder.fromGraphResource(e).build()))}catch(i){throw u.g.generateAjaxClientError(t,i)}}async getSensitivityPolicySettingsAsync(){const e="".concat(this.hostDomain,"/").concat(this.vBetaUrlToken,"/").concat("me/informationProtection/sensitivityPolicySettings?$filter=applicableTo+has+'site,unifiedGroup'"),t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getSensitivityPolicySettingsAsync")});try{const e=await t.clone().json();return a.H.fromGraphResource(e)}catch(i){return a.H.fromGraphResource(null)}}async getTenantGroupSettingsAsync(){const e="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groupSettings"),t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getTenantGroupSettingsAsync")});try{const e=await t.clone().json();if(null==e||!e.value)throw u.g.generateAjaxClientError(t,"No tenant group settings returned");const i=o()(e.value,(e=>e.templateId===this.unifiedGroupTemplateId&&e.displayName===this.unifiedGroupDisplayName));return i?r.h.builder.fromGraphResource(i).build():r.h.builder.withPropertyBag({enableUnifiedGroupCreation:!0}).build()}catch(i){throw u.g.generateAjaxClientError(t,i)}}constructor(e,t){super("TenantService",e,t),this.unifiedGroupTemplateId="62375ab9-6b52-47ed-826b-58e47e0e304b",this.unifiedGroupDisplayName="Group.Unified"}}}}]);
//# sourceMappingURL=tenantservice.ecac0a6d.chunk.js.map