"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[62672],{62264:(e,t,r)=>{r.d(t,{g:()=>d});var o=r(65043),s=r(16112),n=r(66783),i=r(33516),a=r(66151),l=r(56415);const p="34px",m=(0,n.J9)((e=>({root:[(0,a.q0)("ellipsis"),(0,a.aS)(e),{height:p,cursor:"default","> button":[a.xK,(0,a.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:i.BO.semibold,lineHeight:p,margin:"auto"}}]}))),c=(0,n.J9)((e=>({root:(0,i.Zq)("primaryTextSection",e.root)})));class d extends s.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:r}=this.props,s=this.getClassNames();return o.createElement("div",{className:s.root,title:e},null!=t?o.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":r,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},o.createElement("span",null,e)):o.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return c(m(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=o.createRef(),this.onTitleClick=()=>{var e,t,r;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(r=this.titleButtonRef.current)&&void 0!==r?r:void 0)}}}},37374:(e,t,r)=>{r.r(t),r.d(t,{RequirementsSection:()=>z});var o=r(77508),s=r(16112),n=r(31537),i=r(6017),a=r(20751),l=r(11638),p=r(4648),m=r(67048),c=r(9442),d=r(39410),u=r(62264),h=r(67239),v=r(65043),S=r(70149);const A=()=>(0,S.L)((()=>r.e(84465).then(r.bind(r,52514)))).then((e=>({default:e.FormAttachmentsList}))),g=(0,v.lazy)(A),C=()=>(0,S.L)((()=>Promise.all([r.e(17323),r.e(81514)]).then(r.bind(r,49784)))).then((e=>({default:e.ApprovalRequestSection}))),q=(0,v.lazy)(C);var F=r(69412),R=r(8480),f=r(13862),T=r(82229),k=r(86634),x=r(74527),b=r(56415),E=r(66783),B=r(33516),N=r(66151),I=r(4705);const y="20px",D=(0,E.J9)(((e,t,r)=>{const s={".ms-Label":[(0,I.oQ)(e),(0,N.gS)("row")],".plannerCheckMark":[e===o.Sx.TeamsContrast&&{color:b.z.White},{color:b.z.PlannerSecondary,hight:"16px",width:"12px",paddingLeft:"4px"}],".labelTag":[{marginLeft:"4px"}]},n={margin:"".concat(y," 0px")},i={margin:"".concat(y," 0px")},a=[(0,N.gS)(),{marginTop:"5px",":hover":{".deleteApprovalButton":{display:"flex"}}}],l={color:(0,N.Qt)(e),paddingInlineEnd:"10px"},p=[!0===t&&{color:b.z.PlannerSecondary},!1===t&&{color:(0,N.Qt)(e)},{paddingInlineStart:"12px"}],m=[{".plannerCheckMark":{color:b.z.DarkRed}}],c=[e===o.Sx.TeamsContrast&&{color:b.z.White},e===o.Sx.TeamsLight&&{color:b.z.TeamsAppBrand00},e===o.Sx.TeamsDark&&{color:b.z.TeamsDarkPurple},{display:"inline-block",verticalAlign:"bottom",padding:"4px"}],d=[(0,N.$Z)(),{margin:"5px",fontSize:B.s.size14}],u=[(0,N.gS)("column"),{width:"385px",padding:"16px 16px 20px 16px",".header":[(0,N.gS)("row"),{justifyContent:"space-between",".primaryTextSectionTitle":{margin:"0px"}}],".ms-Callout-beakCurtain":{backgroundColor:"inherit"},".ms-Callout-beak":[{backgroundColor:"inherit"},e===o.Sx.TeamsContrast&&{border:"".concat(b.z.White," solid 1px")}]}],h=[(0,N.$Z)(),{display:"none",marginLeft:"auto",".ms-Button":{color:"inherit",backgroundColor:"inherit",margin:0,padding:0},"&.forceShow":{display:"flex"}}],v=[(0,N.gS)("row"),{alignItems:"center",gap:"8px"}];return(0,B.TW)({root:s,addRequirementButton:{height:"35px"},formsSection:n,approvalsSection:i,approvalsContainer:a,approvalsIcon:c,approvalRequirementText:d,addFormCallout:u,deleteApprovalButton:h,asterisk:l,okCheckmark:m,fractionOfRequiredForms:p,tooltip:{maxWidth:"250px"},requirementsTitleContainer:v},r)})),L=(0,E.J9)((e=>{const t=(0,N.cK)(e);return{...t,root:[t.root,{height:"35px"}]}})),P=(0,E.J9)((e=>({root:(0,B.Zq)("requirementsSection",e.root),addRequirementButton:(0,B.Zq)("addRequirementButton",e.addRequirementButton),formsSection:(0,B.Zq)("formsSection",e.formsSection),approvalsSection:(0,B.Zq)("approvalsSection",e.approvalsSection),approvalsContainer:(0,B.Zq)("approvalsContainer",e.approvalsContainer),approvalsIcon:(0,B.Zq)("approvalsIcon",e.approvalsIcon),approvalRequirementText:(0,B.Zq)("approvalRequirementText",e.approvalRequirementText),addFormCallout:(0,B.Zq)("addFormCallout",e.addFormCallout),deleteApprovalButton:(0,B.Zq)("deleteApprovalButton",e.deleteApprovalButton),asterisk:(0,B.Zq)("asterisk",e.asterisk),okCheckmark:(0,B.Zq)("okCheckmark",e.okCheckmark),fractionOfRequiredForms:(0,B.Zq)("fraction",e.fractionOfRequiredForms),tooltip:(0,B.Zq)("tooltip",e.tooltip),requirementsTitleContainer:(0,B.Zq)("requirementsTitleContainer",e.requirementsTitleContainer)})));var Z=r(2908),_=r(86053),U=r(40135),w=r(21382);class z extends s.${name(){return"RequirementsSection"}componentDidUpdate(e,t){this.props.createdFormId!==e.createdFormId&&this.setState({isAddFormCalloutVisible:!!this.props.createdFormId})}renderComponent(){const{root:e}=this.getClassNames();return v.createElement("div",{className:e},this.renderAddRequirementsSection(),this.renderFormsSection(),this.renderAddFormCallout(),this.renderApprovalsSection())}renderAddRequirementsSection(){const{maxRequiredForms:e,maxRequiredApprovals:t}=this.props,{addRequirementButton:r,tooltip:o,requirementsTitleContainer:s}=this.getClassNames();return this.canUpdateFormRequirement()?v.createElement(v.Fragment,null,v.createElement("div",{className:s},v.createElement(n.J,null,_.p.Strings.RequirementsSection_RequirementsSectionTitle),v.createElement(R.S,{plannerTheme:this.props.theme,directionalHint:i.A.rightCenter,content:w.G(_.p.Strings.RequirementsSection_InfoIconTooltipText,e,t),className:o},v.createElement(a.I,{...x.h_,tabIndex:0}))),v.createElement(l.Y,{split:!0,menuProps:{items:this.props.addRequirementButtonMenuItems,styles:(0,k.Zo)(this.props.theme)},styles:L(this.props.theme),className:r},_.p.Strings.RequirementsSection_AddRequirementButtonText)):null}renderFormsSection(){const{enableFormsRequirement:e,formAttachmentsListProps:t}=this.props,{formsSection:r}=this.getClassNames();if(!e||0===t.taskAttachmentRowItems.length)return null;const o=this.canSubmitForm()?_.p.Strings.TaskEditor_FormRequirementSubmitFormTitle:_.p.Strings.RequirementsSection_FormRequirementSectionTitle;return v.createElement("div",{className:r},v.createElement(n.J,null,o,this.renderAsterisk(),this.renderFormsCompletedAdditionalHeader(),this.renderFormsRequirementCount()),this.renderFormAttachmentsList())}renderAsterisk(){const{asterisk:e}=this.getClassNames(),t=this.getTheNumberOfActiveForms();return this.canSubmitForm()&&0!==t?v.createElement("span",{className:e},"*"):null}renderFormsRequirementCount(){const{forms:e}=this.props,{fractionOfRequiredForms:t}=this.getClassNames(),r=e?e.length:0;if(!this.canSubmitForm()||r<2)return null;const o=this.getTheNumberOfActiveForms(),s=w.G(_.p.Strings.TaskEditor_FormsFraction,r-o,r);return v.createElement("span",{className:t},s)}renderFormsCompletedAdditionalHeader(){const{okCheckmark:e}=this.getClassNames(),t=this.getTheNumberOfActiveForms();return this.canSubmitForm()?0===t?v.createElement(a.I,{className:e,...x.r8}):v.createElement(F.l,{index:1,isCollapsed:!1,title:_.p.Strings.TaskEditor_ShowMandatoryChecklistToggleLabel,showBorder:!1,theme:this.props.theme}):null}renderApprovalsSection(){const{approvalsSection:e,approvalsContainer:t,approvalRequirementText:r,approvalsIcon:o,deleteApprovalButton:s}=this.getClassNames();if(!this.props.enableApprovalsRequirement||!this.props.isApprovalRequired||!this.canUpdateApprovalRequirement()&&!this.canUpdateApprovalRequest())return null;if(this.canUpdateApprovalRequirement()){const i=this.state.deleteApprovalFocused?"forceShow":"";return v.createElement("div",{className:e},v.createElement(n.J,null,_.p.Strings.RequirementsSection_ApprovalRequirementSectionTitle),v.createElement("div",{className:t},v.createElement(a.I,{...x.hn,className:(0,p.A)(x.hn.className,o)}),v.createElement("div",{className:r},_.p.Strings.RequirementsSection_ApprovalRequirementText),v.createElement("div",{className:"".concat(s," ").concat(i)},v.createElement(h.K,{className:"deleteApprovalIconButton",iconProps:x.pJ,ariaLabel:_.p.Strings.RequirementsSection_RemoveApprovalButtonTitle,title:_.p.Strings.RequirementsSection_RemoveApprovalButtonTitle,onClick:this.onClickDeleteApproval,onFocus:this.onDeleteApprovalFocus,onBlur:this.onDeleteApprovalBlur,plannerTheme:this.props.theme}))))}return v.createElement(v.Suspense,{fallback:v.createElement(U.W,null)},v.createElement(q,{theme:this.props.theme,approvalInfo:this.props.approvalInfo,getAssigneePoolForApproval:this.props.getAssigneePoolForApproval,getUserPhoto:this.props.getUserPhoto,currentUserId:this.props.currentUserId,onCancelApproval:this.props.onCancelApproval,onClearApproval:this.props.onClearApproval,onUpdateApproval:this.props.onUpdateApproval,onSendApprovalRequest:this.props.onSendApprovalRequest,approvalDetailInfo:this.props.approvalDetailInfo,selectedApprover:this.props.selectedApprover,isApprovalDataLoading:this.props.isApprovalDataLoading,onSelectApprover:this.props.onSelectApprover,isTaskCompleted:this.props.isTaskCompleted}))}renderFormAttachmentsList(){return v.createElement(v.Suspense,{fallback:v.createElement(v.Fragment,null)},v.createElement(g,{...this.props.formAttachmentsListProps,createdFormId:this.props.createdFormId,createdFormRef:this.createdFormActionButtonRef}))}renderAddFormCallout(){const{addFormCallout:e}=this.getClassNames();return this.state.isAddFormCalloutVisible&&this.createdFormActionButtonRef.current?v.createElement(d.P,{target:this.createdFormActionButtonRef,isBeakVisible:!0,gapSpace:0,doNotLayer:!1,directionalHint:i.A.topLeftEdge,styles:(0,Z.df)(this.props.theme),className:e,setInitialFocus:!0,onDismiss:this.onAddFormCalloutDismiss},v.createElement(m.Y,{isClickableOutsideFocusTrap:!0},v.createElement("div",{className:"header"},v.createElement(u.g,{titleText:_.p.Strings.RequirementsSection_AddFormCalloutTitle,theme:this.props.theme}),v.createElement(h.K,{iconProps:x.s5,title:_.p.Strings.RequirementsSection_CloseButtonText,ariaLabel:_.p.Strings.RequirementsSection_CloseButtonAriaLabel,onClick:this.onAddFormCalloutDismiss,plannerTheme:this.props.theme})),v.createElement("p",null,_.p.Strings.RequirementsSection_AddFormCalloutBody),v.createElement(c.N,{href:o.$j.addFormsRequirement,target:"_blank",rel:"noopener noreferrer"},_.p.Strings.SharedComponents_LearnMoreLink))):null}getTheNumberOfActiveForms(){const{forms:e}=this.props;return e?e.filter((e=>null===e.formResponse)).length:0}canSubmitForm(){return!(0,f.M)(this.props.formPermissions,f.J.DisableSubmitForm)}canUpdateFormRequirement(){return!(0,f.M)(this.props.formPermissions,f.J.DisableUpdateFormRequirement)}canUpdateApprovalRequirement(){return!(0,T.P)(this.props.approvalPermissions,T.u.DisableUpdateApprovalRequirement)}canUpdateApprovalRequest(){return!(0,T.P)(this.props.approvalPermissions,T.u.DisableUpdateApprovalRequest)}getClassNames(){const{theme:e,styles:t}=this.props,r=this.getTheNumberOfActiveForms();return P(D(e,0===r,t))}constructor(e,t){super(e,t),this.createdFormActionButtonRef=v.createRef(),this.onClickDeleteApproval=()=>{this.props.onDeleteApprovalRequirement(),this.setState({deleteApprovalFocused:!1})},this.onDeleteApprovalFocus=()=>{this.setState({deleteApprovalFocused:!0})},this.onDeleteApprovalBlur=()=>{this.setState({deleteApprovalFocused:!1})},this.onAddFormCalloutDismiss=()=>{this.setState({isAddFormCalloutVisible:!1})},this.state={isAddFormCalloutVisible:!!this.props.createdFormId,deleteApprovalFocused:!1}}}}}]);
//# sourceMappingURL=requirementssection.87407843.chunk.js.map