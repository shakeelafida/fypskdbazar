(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[93818],{54555:(e,t,r)=>{"use strict";r.d(t,{G:()=>x});var o=r(65804),n=r(6326),a=r(65043),s=r(89379),i=r(17066),l=r(27480),c=r(40440),p=r(56420),d=r(15199),u=r(13706),h=r(20751),m="SearchBox",g={root:{height:"auto"},icon:{fontSize:"12px"}},k={iconName:"Clear"},C={ariaLabel:"Clear text"},b=(0,s.Z)(),T=a.forwardRef((function(e,t){var r=e.ariaLabel,o=e.className,s=e.defaultValue,T=void 0===s?"":s,S=e.disabled,v=e.underlined,P=e.styles,x=e.labelText,y=e.placeholder,f=void 0===y?x:y,D=e.theme,w=e.clearButtonProps,L=void 0===w?C:w,B=e.disableAnimation,E=void 0!==B&&B,A=e.showIcon,F=void 0!==A&&A,I=e.onClear,M=e.onBlur,N=e.onEscape,_=e.onSearch,R=e.onKeyDown,U=e.iconProps,H=e.role,O=e.onChange,V=e.onChanged,W=a.useState(!1),G=W[0],z=W[1],Z=a.useRef(),K=(0,c.k)(e.value,T,(function(e,t){e&&e.timeStamp===Z.current||(Z.current=null===e||void 0===e?void 0:e.timeStamp,null===O||void 0===O||O(e,t),null===V||void 0===V||V(t))})),q=K[0],J=K[1],j=String(q),$=a.useRef(null),Y=a.useRef(null),X=(0,p.a)($,t),Q=(0,d.B)(m,e.id),ee=L.onClick,te=b(P,{theme:D,className:o,underlined:v,hasFocus:G,disabled:S,hasInput:j.length>0,disableAnimation:E,showIcon:F}),re=(0,i.G1)(e,i.QQ,["className","placeholder","onFocus","onBlur","value","role"]),oe=a.useCallback((function(e){var t;null===I||void 0===I||I(e),e.defaultPrevented||(J(""),null===(t=Y.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())}),[I,J]),ne=a.useCallback((function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||oe(e)}),[ee,oe]),ae=a.useCallback((function(e){z(!1),null===M||void 0===M||M(e)}),[M]),se=function(e){J(e.target.value,e)};return function(e,t,r){a.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return r}}}),[t,r])}(e.componentRef,Y,G),a.createElement("div",{role:H,ref:X,className:te.root,onFocusCapture:function(t){var r;z(!0),null===(r=e.onFocus)||void 0===r||r.call(e,t)}},a.createElement("div",{className:te.iconContainer,onClick:function(){Y.current&&(Y.current.focus(),Y.current.selectionStart=Y.current.selectionEnd=0)},"aria-hidden":!0},a.createElement(h.I,(0,n.__assign)({iconName:"Search"},U,{className:te.icon}))),a.createElement("input",(0,n.__assign)({},re,{id:Q,className:te.field,placeholder:f,onChange:se,onInput:se,onBlur:ae,onKeyDown:function(e){switch(e.which){case l.c.escape:null===N||void 0===N||N(e),j&&!e.defaultPrevented&&oe(e);break;case l.c.enter:_&&(_(j),e.preventDefault(),e.stopPropagation());break;default:null===R||void 0===R||R(e),e.defaultPrevented&&e.stopPropagation()}},value:j,disabled:S,role:"searchbox","aria-label":r,ref:Y})),j.length>0&&a.createElement("div",{className:te.clearButton},a.createElement(u.K,(0,n.__assign)({onBlur:ae,styles:g,iconProps:k},L,{onClick:ne}))))}));T.displayName=m;var S=r(33516),v=r(50605),P={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var x=(0,o.I)(T,(function(e){var t,r,o,n,a,s=e.theme,i=e.underlined,l=e.disabled,c=e.hasFocus,p=e.className,d=e.hasInput,u=e.disableAnimation,h=e.showIcon,m=s.palette,g=s.fonts,k=s.semanticColors,C=s.effects,b=(0,S.Km)(P,s),T={color:k.inputPlaceholderText,opacity:1},x=m.neutralSecondary,y=m.neutralPrimary,f=m.neutralLighter,D=m.neutralLighter,w=m.neutralLighter;return{root:[b.root,g.medium,S.S8,{color:k.inputText,backgroundColor:k.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:C.roundedCorner2,border:"1px solid ".concat(k.inputBorder),height:32,selectors:(t={},t[S.up]={borderColor:"WindowText"},t[":hover"]={borderColor:k.inputBorderHovered,selectors:(r={},r[S.up]={borderColor:"Highlight"},r)},t[":hover .".concat(b.iconContainer)]={color:k.inputIconHovered},t)},!c&&d&&{selectors:(o={},o[":hover .".concat(b.iconContainer)]={width:4},o[":hover .".concat(b.icon)]={opacity:0,pointerEvents:"none"},o)},c&&["is-active",{position:"relative"},(0,S.Sq)(k.inputFocusBorderAlt,i?0:C.roundedCorner2,i?"borderBottom":"border")],h&&[{selectors:(n={},n[":hover .".concat(b.iconContainer)]={width:32},n[":hover .".concat(b.icon)]={opacity:1},n)}],l&&["is-disabled",{borderColor:f,backgroundColor:w,pointerEvents:"none",cursor:"default",selectors:(a={},a[S.up]={borderColor:"GrayText"},a)}],i&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],i&&l&&{backgroundColor:"transparent"},d&&"can-clear",p],iconContainer:[b.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:k.inputIcon,cursor:"text"},c&&{width:4},l&&{color:k.inputIconDisabled},!u&&{transition:"width ".concat(S.cs.durationValue1)},h&&c&&{width:32}],icon:[b.icon,{opacity:1},c&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(S.cs.durationValue1," 0s")},h&&c&&{opacity:1}],clearButton:[b.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:D},"&:hover .ms-Button-icon":{color:y},".ms-Button":{borderRadius:(0,v.jI)(s)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:x}}}],field:[b.field,S.S8,(0,S.CX)(T),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:k.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:k.disabledText}]}}),void 0,{scope:"SearchBox"})},62264:(e,t,r)=>{"use strict";r.d(t,{g:()=>u});var o=r(65043),n=r(16112),a=r(66783),s=r(33516),i=r(66151),l=r(56415);const c="34px",p=(0,a.J9)((e=>({root:[(0,i.q0)("ellipsis"),(0,i.aS)(e),{height:c,cursor:"default","> button":[i.xK,(0,i.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:s.BO.semibold,lineHeight:c,margin:"auto"}}]}))),d=(0,a.J9)((e=>({root:(0,s.Zq)("primaryTextSection",e.root)})));class u extends n.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:r}=this.props,n=this.getClassNames();return o.createElement("div",{className:n.root,title:e},null!=t?o.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":r,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},o.createElement("span",null,e)):o.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return d(p(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=o.createRef(),this.onTitleClick=()=>{var e,t,r;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(r=this.titleButtonRef.current)&&void 0!==r?r:void 0)}}}},9422:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var o=r(65043),n=r(16112),a=r(22317),s=r(66783),i=r(33516);const l=(0,s.J9)((()=>({anchor:{minHeight:"1px"}}))),c=(0,s.J9)((e=>({anchor:(0,i.Zq)("virtualContainer-anchor",e.anchor)})));class p extends n.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return o.createElement(o.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return o.createElement("div",{className:"virtualContainer-wrapper"},o.createElement(a.pL,{onChange:this.handleInView,triggerOnce:!0},o.createElement("div",{className:e.anchor})))}getClassNames(){return c(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}class d extends n.${renderComponent(){const{children:e,planContainerId:t,onRender:r}=this.props;return t?o.createElement(p,{containerId:t,onLoad:r},e):o.createElement(o.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}},85906:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PlanTaskBoardPage:()=>Ip});var o,n,a,s=r(78332),i=r(5099),l=r(64327),c=r(45795),p=r(96891),d=r(16701),u=r(38629),h=r(38752),m=r(77508),g=r(16112),k=r(65043),C=r(65818),b=r(44430),T=r(76241),S=r(54320),v=r.n(S),P=r(30210);function x(e,t){return e>-1&&0!==(e&t)}function y(e,t){return e>-1&&0!==(e&t)}!function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableYammer=1]="EnableYammer",e[e.EnableConversations=2]="EnableConversations",e[e.EnableMembers=4]="EnableMembers",e[e.EnableFiles=8]="EnableFiles",e[e.EnableNotebook=16]="EnableNotebook",e[e.EnableSites=32]="EnableSites",e[e.EnableAll=63]="EnableAll"}(o||(o={})),function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableFavorite=1]="EnableFavorite",e[e.EnableCopy=2]="EnableCopy",e[e.EnableExport=4]="EnableExport",e[e.EnableCopyLink=8]="EnableCopyLink",e[e.EnableSettings=16]="EnableSettings",e[e.EnableCalendar=32]="EnableCalendar",e[e.EnableLeave=64]="EnableLeave",e[e.EnableJoin=128]="EnableJoin",e[e.EnableAll=255]="EnableAll"}(n||(n={})),function(e){e.getLinksCapabilitiesForContainer=function(e){return null==e?o.EnableNone:e.containerType===C.K.Group?function(e){const t=e.unifiedGroupDetails;if(null==t)return o.EnableNone;let r=o.EnableFiles|o.EnableNotebook|o.EnableSites;t.isYammerGroup()?r|=o.EnableYammer:h.B.isGuestUser||(r=r|o.EnableConversations|o.EnableMembers);return r}(e):o.EnableNone},e.getLinksCapabilitiesForPlan=function(e,t,r,o){let a=C.K.Invalid;switch(null!=e?a=e.containerType:o&&(a=r),a){case C.K.Group:return function(e){var t,r,o,a,s;if((null===(t=e.unifiedGroupDetails)||void 0===t?void 0:t.currentUserRelationToGroup)===b.N.NonMember)return e.unifiedGroup.visibility===T.X.Public?n.EnableJoin:n.EnableNone;let i=n.EnableCopy|n.EnableExport|n.EnableCopyLink|n.EnableSettings;e.unifiedGroupDetails&&!e.unifiedGroupDetails.isYammerGroup()&&(i|=n.EnableFavorite);const l=null!==(r=(null===(o=e.unifiedGroupDetails)||void 0===o?void 0:o.owners)&&e.unifiedGroupDetails.owners.length>1)&&void 0!==r&&r;(e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup!==b.N.Owner||l)&&(i|=n.EnableLeave);(null===(a=e.unifiedGroupDetails)||void 0===a?void 0:a.currentUserRelationToGroup)!==b.N.Owner&&(null===(s=e.unifiedGroupDetails)||void 0===s?void 0:s.currentUserRelationToGroup)!==b.N.Member||(i|=n.EnableCalendar);return i}(e);case C.K.DriveItem:return n.EnableFavorite|n.EnableCopy|n.EnableExport|n.EnableCopyLink|n.EnableSettings|n.EnableCalendar;case C.K.User:return n.EnableFavorite|n.EnableCopy|n.EnableExport|n.EnableCopyLink|n.EnableSettings;case C.K.Roster:return function(e){let t=n.EnableFavorite|n.EnableCopy|n.EnableExport|n.EnableCopyLink|n.EnableSettings|n.EnableCalendar;e>1&&(t|=n.EnableLeave);return t}(t);default:return n.EnableNone}},e.getContextLinkMenuItemForPlan=function(e,t,r,o,n){if(!v()(t.contextDetails)){const a=(0,P.g)(e.contexts,r),s=v()(a)?null:t.contextDetails[a];if(null!=s&&!v()(s.url))return{key:a,name:o,href:s.url,target:"_blank",onClick:n}}return null}}(a||(a={}));var f,D=r(22514);!function(e){e[e.DisableAll=0]="DisableAll",e[e.DisableNothing=1]="DisableNothing",e[e.DisablePlanChanges=2]="DisablePlanChanges"}(f||(f={}));class w extends g.${componentDidMount(){this.logFloodgateActivity(),this.logSharedContainersTelemetryOnPlanLoad()}componentDidUpdate(e){var t,r;(null===(t=this.props.plan)||void 0===t?void 0:t.id)!==(null===(r=e.plan)||void 0===r?void 0:r.id)&&(this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1),e.sharedContainersListProps!==this.props.sharedContainersListProps&&(this.logSharedContainersTelemetryOnPlanLoad(),this.logSharedContainersTelemetryOnMemberListOpen())}logFloodgateActivity(){const{disableMode:e,flights:t,hasAccessViaSharedContainer:r,plan:o,planContainer:s,planMembers:i}=this.props;h.B.clientType===c.s.Plex&&D.q.logFloodgateActivity(p.M.ProgressFilterActivity,this.context.traceLogger),h.B.clientType===c.s.Plex&&null!==t&&void 0!==t&&t.EnableImageRecommendations&&e===f.DisableNothing&&o&&y(a.getLinksCapabilitiesForPlan(null!==s&&void 0!==s?s:null,i.length,o.container.containerType,null!==r&&void 0!==r&&r),n.EnableSettings)&&D.q.logFloodgateActivity(p.M.SmartBackgroundActivity,this.context.traceLogger)}constructor(){super(...arguments),this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1,this.headerMoreOptionsButtonRef=k.createRef(),this.openPlanSettingsPanel=(e,t)=>{var r,o;null===(r=(o=this.props.callbacks).openPlanSettingsPanel)||void 0===r||r.call(o,e,t)},this.openLeavePlanDialog=e=>{var t,r;null===(t=(r=this.props.callbacks).openLeavePlanDialog)||void 0===t||t.call(r,e)},this.onOpenMembersCallout=()=>{this.shouldLogMembersListOpened=!0,this.logSharedContainersTelemetryOnMemberListOpen()},this.logSharedContainersTelemetryOnMemberListOpen=()=>{!this.isMembersListOpenedLogged&&this.shouldLogMembersListOpened&&this.isSharedContainersListPropsLoaded()&&(this.isMembersListOpenedLogged=!0,this.context.usageLogger.logData(this.name(),p.M.MembersListOpenedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.logSharedContainersTelemetryOnPlanLoad=()=>{!this.isSharedContainersTelemetryLogged&&this.isSharedContainersListPropsLoaded()&&(this.isSharedContainersTelemetryLogged=!0,this.context.usageLogger.logData(this.name(),p.M.PlanLoadedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.isSharedContainersListPropsLoaded=()=>{const{plan:e,sharedContainersListProps:t}=this.props;return null!=t&&null!=e&&e.sharedWithContainers.length===t.sharedContainerItems.length+t.inaccessibleSharedContainerCount},this.getSharedContainerTelemetryExtraData=()=>{const{plan:e,sharedContainersListProps:t}=this.props;if(null==t||null==e)return;const r={planId:e.id};return t.inaccessibleSharedContainerCount>0&&(r.hasInaccessibleSharedContainers="true"),r}}}var L=r(53356),B=r(20751),E=r(63485),A=r(33631),F=r(9422),I=r(52342),M=r(40520),N=r(54845),_=r(37535),R=r(75104),U=r(86053);class H extends g.${name(){return"WorkloadProvisioningDialog"}renderComponent(){let e="";switch(this.props.workloadName){case _.P[_.P.Conversations]:e=U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadConversationsError;break;case _.P[_.P.People]:e=U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadPeopleError;break;case _.P[_.P.Documents]:e=U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadFileStorageError;break;case _.P[_.P.Notebook]:e=U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadNotebookError;break;case _.P[_.P.Yammer]:e=U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadYammerError;break;default:return null}return k.createElement(I.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,type:M.h.normal,styles:(0,R.XK)(this.props.theme)},styles:(0,R.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1}},e,k.createElement(N.E,null,k.createElement(E.j,{onClick:this.props.onDismiss},U.p.Strings.WorkloadProvisioningDialog_MissingWorkloadErrorOkBtn)))}constructor(e,t){super(e,t),this.state={}}}var O=r(50724),V=r(66783),W=r(33516),G=r(50605),z=r(66151),Z=r(56415),K=r(8736),q=r(72943);const J="38px",j=(0,V.J9)(((e,t,r)=>{const o=[(0,z.gS)("column","nowrap"),(0,z.aS)(e),(0,q.zI)(),{padding:"".concat(K.B.TopHeaderPaddingTop," ").concat(K.B.TopHeaderHorizontalPadding," ").concat(K.B.TopHeaderPaddingBottom),transition:"background 0.3s ease-in-out",height:"100%",overflowX:"auto","&.responsive":{overflowY:"hidden"}},e===m.Sx.SharePoint&&{backgroundColor:Z.z.SharepointBackgroundColor(),transition:"background 0s linear"}],n=[(0,z.gS)("row","nowrap"),{height:"100%"},e===m.Sx.SharePoint&&{flexBasis:"".concat(J," !important")}],a=[z.xK,(0,z.Ml)(e),{fontSize:W.s.small,borderColor:Z.z.NeutralLight,padding:"1px 6px",borderRadius:"5px",border:"1px solid",textDecoration:"none",cursor:"pointer"}],s=[z.$Z,(0,z.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,z.gS)("row","nowrap"),{"> .plannerDivider":[{color:Z.z.NeutralQuaternaryAlt}],"> .plannerLinkDismiss":[(0,z.bY)(e)]}]}],i=[z.xK,(0,z.$Z)(),(0,z.aS)(e),{height:"32px",width:"32px",padding:"4px",cursor:"pointer"}],l=[(0,z.$Z)(),(0,z.gS)(),z.cc,{marginRight:"2px",marginLeft:"12px",img:{height:"28px",width:"24px"}}],c=[(0,z.GD)(),(0,z.gS)("column","nowrap"),{"> div":(0,z.gS)("row","nowrap")},(0,z.aS)(e)],p={".teamsApp:not(.splitUI) &":{display:"none"},display:"inline-block",margin:"0px ".concat("40px"," 0px ").concat("12px"),minWidth:"164px",maxWidth:"250px"},d=[(0,z.gS)(),{alignItems:"center",button:[z.xK,{paddingRight:"5px !important",display:"inline-block",cursor:"pointer"}],"> .secondaryIconSection":{fontSize:W.s.size16}}],u=[(0,z.gS)("row","nowrap"),{alignItems:"center","> .contextInfoSection":{"> *":(0,z.GD)(),".fallbackContextInfoText":[(0,z.q0)("ellipsis"),(0,z.Ml)(e),{fontSize:W.s.small}]}}],h=[(0,z.$Z)("auto"),(0,z.gS)("row","nowrap"),{margin:"0px ".concat("6px"),height:J}],g={root:o,topHeaderLandmark:n,linkedBadgeDropdown:a,linkedBadgeItem:s,pivotsSection:[(0,z.$Z)(),(0,z.gS)("row","nowrap"),{"> div":(0,z.gS)()}],appMoreOptionsButton:i,appLogo:l,nonIcon:c,primarySection:p,primaryTextSectionContainer:d,contextInfoSectionContainer:u,secondarySection:h,rightAlignedSection:[(0,z.GD)("auto"),(0,z.gS)("row","nowrap"),{alignItems:"center",height:J,"> .joinUnifiedGroup":[(0,z.gS)("row","nowrap"),(0,z.GD)(),{justifyContent:"flex-end"}],"> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,W.pB)(void 0,g,t)})),$=(0,V.J9)((e=>({root:(0,W.Zq)("topHeader",e.root),topHeaderLandmark:(0,W.Zq)("topHeaderLandmark",e.topHeaderLandmark),linkedBadgeDropdown:(0,W.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,W.Zq)("linkedBadgeItem",e.linkedBadgeItem),pivotsSection:(0,W.Zq)("pivotsSection",e.pivotsSection),appMoreOptionsButton:(0,W.Zq)("appMoreOptionsButton",e.appMoreOptionsButton),appLogo:(0,W.Zq)("appLogo",e.appLogo),primaryTextSectionContainer:(0,W.Zq)("primaryTextSectionContainer",e.primaryTextSectionContainer),contextInfoSectionContainer:(0,W.Zq)("contextInfoSectionContainer",e.contextInfoSectionContainer),nonIcon:(0,W.Zq)("nonIcon",e.nonIcon),primarySection:(0,W.Zq)("primarySection",e.primarySection),secondarySection:(0,W.Zq)("secondarySection",e.secondarySection),rightAlignedSection:(0,W.Zq)("rightAlignedSection",e.rightAlignedSection)}))),Y=(0,V.J9)((e=>({root:{margin:"0px"},listItem:[(0,z.Ml)(e),{"&:first-child > .ms-Breadcrumb-item":{paddingLeft:"0px"},"&:last-child > .ms-Breadcrumb-item":[(0,z.Ml)(e),{fontWeight:"400",color:"inherit"}]}],item:[(0,z.Ml)(e),{fontSize:W.s.small,lineHeight:"inherit",padding:"0 5px"}],overflowButton:[(0,z.Ml)(e),{"&:hover, &:active, &:hover:active, &.is-expanded":[(0,z.Mi)(e),(0,z.Ml)(e)],":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]})));var X=r(75472);const Q="10px",ee="2px",te=(0,V.J9)(((e,t)=>{let r=[];r=t?[{marginLeft:"0px","> .icon":{fontSize:W.s.small,marginRight:K.B.TeamsPivotIconRightMargin,paddingBottom:ee},"*:last-child:not(:only-child)":{marginRight:K.B.TeamsPivotLabelRightMargin,marginLeft:"0px"},"&.isSelected,&:hover,&:active":[(0,z._D)(e),{"> span":(0,z._D)(e),fontWeight:W.BO.regular}]},e===m.Sx.TeamsContrast&&{"&.isSelected":{color:Z.z.TeamsContrastSelectedColor,"> span":{color:Z.z.TeamsContrastSelectedColor}},"&:hover,&:active":{color:Z.z.TeamsContrastHyperlinkColor,"> span":{color:Z.z.TeamsContrastHyperlinkColor}}}]:[{":not(.isSelected):not(:hover) > *":{paddingBottom:ee},"&:hover > *,&.isSelected > *":[(0,z.T4)(e),{borderBottomStyle:"solid",borderBottomWidth:ee}]},e===m.Sx.TeamsContrast&&{" &.isSelected > *":{borderBottomColor:Z.z.TeamsContrastSelectedColor},"&:hover > *":{color:Z.z.TeamsContrastHyperlinkColor,borderBottomColor:Z.z.TeamsContrastHyperlinkColor}}];const o=[e===m.Sx.SharePoint&&{margin:"0px ".concat(Q),"> *:not(.icon)":{color:Z.z.SharepointTitleFontColor()}},{"> .icon":{display:"none"},"> .pivotLinkWithIcon":[(0,z.gS)("row","nowrap"),{alignItems:"center","> i svg":{transform:"scale(0.7)",marginLeft:(0,G.jI)()?"0px":"-4px",marginRight:(0,G.jI)()?"-4px":"0px"}}]}];return{removable:[(0,z.$Z)(),e===m.Sx.SharePoint&&{margin:"0px -".concat(Q)},{"> .pivotLink":o}],pivotLink:[r,(0,z.gS)(),z.cc,(0,z.aS)(e),{fontSize:W.s.medium,cursor:"pointer","> span":(0,z.aS)(e),lineHeight:(0,X.jz)(J)-3,margin:"0px ".concat((0,X.vb)((0,X.jz)("24px")/2-(0,X.jz)("8px"))),"> *":[(0,z.$Z)(),{margin:"0px ".concat("8px"),":first-child:not(:only-child)":{marginLeft:"0px"},":last-child:not(:only-child)":{marginRight:"8px"},":only-child":{margin:"0px",paddingBottom:ee}},e===m.Sx.SharePoint&&{margin:"0px"}],"&.isSelected":e===m.Sx.SharePoint&&{color:Z.z.SharepointTitleFontColor()}}],icon:{marginTop:"3px",fontSize:"18px",height:"24px","> button":[z.xK,(0,z.aS)(e),{".plannerIcon":{cursor:"pointer"}}]}}})),re=(0,V.J9)((e=>({removable:(0,W.Zq)("removable",e.removable),pivotLink:(0,W.Zq)("pivotLink",e.pivotLink),icon:(0,W.Zq)("icon",e.icon)})));var oe=r(4648),ne=r(49560);class ae extends g.${name(){return"HeaderPivotLinks"}renderComponent(){const{pivotLinks:e,selectedPivotLinkIndex:t,renderTeamsPivotSection:r}=this.props,o=this.getClassNames();return r?this.renderTeamsPivotLinks(o):k.createElement("div",{className:o.removable,role:"tablist"},e.map(((e,r)=>{const n=t===r,a=(0,oe.A)(o.pivotLink,{isSelected:n});return k.createElement("a",{key:e.id,className:a,title:e.name,tabIndex:0,onClick:this.onLinkClick.bind(this,r),onKeyUp:this.handleOnKeyPress.bind(this,r),"aria-label":e.name,role:"tab","aria-selected":n},k.createElement("span",{className:o.icon},k.createElement(B.I,e.iconProps)),k.createElement("span",{className:e.alwaysShowIcon?"pivotLinkWithIcon":void 0},e.alwaysShowIcon&&k.createElement(B.I,e.iconProps),e.name))})))}renderTeamsPivotLinks(e){const t={};return this.props.pivotLinks.forEach(((e,r)=>{t[e.id]=r})),k.createElement("div",{className:"altViewPivots"},this.props.pivotLinks.map(((r,o)=>{const n=(0,oe.A)(e.pivotLink,{isSelected:this.props.selectedPivotLinkIndex===t[r.id]});return k.createElement("a",{key:r.id,className:n,title:r.name,tabIndex:0,onClick:this.onLinkClick.bind(this,t[r.id]),onKeyUp:this.handleOnKeyPress.bind(this,t[r.id])},k.createElement("span",{className:e.icon},k.createElement(B.I,r.iconProps)),k.createElement("span",null,r.name))})))}getClassNames(){var e;return re(te(this.props.theme,null!==(e=this.props.renderTeamsPivotSection)&&void 0!==e&&e))}onLinkClick(e){const{onSelectPivotLink:t,pivotLinks:r}=this.props;t&&r&&t(this.props.pivotLinks[e])}handleOnKeyPress(e,t){const{onSelectPivotLink:r,pivotLinks:o}=this.props,n=ne.a.getKey(t);n!==O.D.ENTER&&n!==O.D.SPACE||!r||!o||r(this.props.pivotLinks[e])}constructor(e,t){super(e,t)}}var se=r(6017),ie=r(98571);const le=(0,V.J9)((e=>({root:[e===m.Sx.SharePoint&&{display:"none"},(0,z.$Z)(),(e===m.Sx.LoopLight||e===m.Sx.LoopDark)&&{borderLeft:"solid thin",padding:"0 8px 0 12px"},e===m.Sx.LoopLight&&{borderLeftColor:Z.z.NeutralLightGrey88},e===m.Sx.LoopDark&&{borderLeftColor:Z.z.NeutralDarkGrey32}],moreContextMenuButton:[(0,z.gS)(),z.cc,(0,z.aS)(e),{fontSize:W.s.medium,cursor:"pointer","> span":[(0,z.aS)(e)],"&:hover > *":{borderBottom:"none !important"}}]}))),ce=(0,V.J9)((e=>({root:(0,W.Zq)("more",e.root),moreContextMenuButton:(0,W.Zq)("moreContextMenuButton",e.moreContextMenuButton)})));var pe=r(74527);class de extends g.${name(){return"HeaderMoreOptions"}renderComponent(){const{moreOptionsContextMenuItems:e,moreOptionsTooltip:t}=this.props,r=this.getClassNames(),o=this.getPivotLinkClassNames(),n=k.createElement("button",{onClick:this.toggleLinksContextMenu.bind(this),"aria-haspopup":"true",title:t,"aria-label":U.p.Strings.PlannerHeader_MoreAriaLabel,ref:this.props.headerMoreOptionsButtonRef,id:"headerMoreOptionButton"},k.createElement(B.I,pe.XP)),a=k.createElement(ie.l,{shouldFocusOnMount:!0,items:e||[],directionalHint:se.A.bottomAutoEdge,target:this.refs.secondaryLinksCommandButton,onDismiss:this.dismissLinksContextMenu.bind(this),appTheme:this.props.theme});return k.createElement("div",{className:r.root,ref:"secondaryLinksCommandButton"},k.createElement("div",{className:(0,oe.A)(o.pivotLink,r.moreContextMenuButton),"aria-haspopup":!0},k.createElement("span",{className:o.icon},e&&e.length>0?n:null)),this.state.isLinksContextMenuVisible?a:null)}getClassNames(){return ce(le(this.props.theme))}getPivotLinkClassNames(){return re(te(this.props.theme))}toggleLinksContextMenu(){const{onOpenLinksContextMenu:e}=this.props;!this.state.isLinksContextMenuVisible&&e&&e(),this.setState((e=>({isLinksContextMenuVisible:!e.isLinksContextMenuVisible})))}dismissLinksContextMenu(){this.setState((e=>({isLinksContextMenuVisible:!1})))}constructor(e,t){super(e,t),this.state={isLinksContextMenuVisible:!1}}}function ue(e){switch(e){case s.Yc.Plan:return U.p.Strings.PlanHeader_GroupByDropDownPlanOption;case s.Yc.Assignee:return U.p.Strings.PlanHeader_GroupByDropDownAssignedToOption;case s.Yc.Bucket:return U.p.Strings.PlanHeader_GroupByDropDownBucketOption;case s.Yc.Progress:return U.p.Strings.PlanHeader_GroupByDropDownProgressOption;case s.Yc.DueDate:return U.p.Strings.PlanHeader_GroupByDropDownDueDateOption;case s.Yc.Category:return U.p.Strings.PlanHeader_GroupByDropDownCategoryOption;case s.Yc.Priority:return U.p.Strings.PlanHeader_GroupByDropDownPriorityOption;default:throw new Error("Unexpected taskGroupingType: ".concat(e))}}class he extends g.${name(){return"GroupByMenu"}renderComponent(){return k.createElement(ie.l,{id:"groupByMenu",shouldFocusOnMount:!0,items:this.getMenuItems(),directionalHint:se.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.onDismissGroupByMenu,appTheme:this.props.theme})}getMenuItems(){const{onGroupByChange:e,currentTaskGrouping:t,taskGroupingOptions:r}=this.props,o=[];for(const n of r)isNaN(Number(n))||o.push({key:s.Yc[n],name:ue(n),canCheck:!0,checked:t===n,onClick:e.bind(this,n)});return o}constructor(e,t){super(e,t),this.state={}}}var me=r(31537),ge=r(9442),ke=r(25588);const Ce="28px",be="8px",Te="56px",Se=(0,V.J9)(((e,t)=>{const r={root:[(0,z.GD)(),{fontSize:W.s.medium,lineHeight:"20px",alignItems:"center",whiteSpace:"nowrap",maxWidth:"100%"}],itemText:[(0,z.GD)(),{margin:"15px 0px",display:"inline-block",verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"normal"}],headerLink:[(0,z.zt)(e),{textDecoration:"none"}],contextRow:[(0,z.gS)("row"),(0,z.GD)(),(0,z.aS)(e),{whiteSpace:"nowrap",alignItems:"center",maxWidth:"100%"}],contextIcon:[(0,z.$Z)(),{height:Ce,width:Ce,marginLeft:(0,X.vb)((0,X.jz)(K.B.HeaderDropdownItemSpacing)/2),marginRight:K.B.HeaderDropdownItemSpacing,"> .ms-Image > .ms-Image-image":[{maxWidth:Ce,maxHeight:Ce}]}],contextDetailsColumn:[(0,z.GD)("auto"),(0,z.gS)("column"),{padding:"10px 0px 11px 0px"}],contextDetailsText:[(0,z.aS)(e),{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"19px",lineHeight:"16px"}],contextDetailsSecondaryText:[(0,z.gS)("row","nowrap"),(0,z.Ml)(e),{fontSize:W.s.small,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"16px",lineHeight:"14px",alignItems:"center","> .plannerLinkDismiss":[(0,z.bY)(e),{marginRight:"5px"}]}]};return(0,W.TW)(r,t)})),ve=(0,V.J9)((e=>({root:(0,W.Zq)("ms-ContextualMenu-linkContent",e.root),itemText:(0,W.Zq)("ms-ContextualMenu-itemText",e.itemText),headerLink:(0,W.Zq)("headerLink",e.headerLink),contextRow:(0,W.Zq)("ms-ContextualMenu-linkContent contextRow",e.contextRow),contextIcon:(0,W.Zq)("contextIcon",e.contextIcon),contextDetailsColumn:(0,W.Zq)("contextDetailsColumn",e.contextDetailsColumn),contextDetailsText:(0,W.Zq)("contextDetailsText",e.contextDetailsText),contextDetailsSecondaryText:(0,W.Zq)("ms-ContextualMenu-itemSecondaryText contextDetailsSecondaryText",e.contextDetailsSecondaryText)}))),Pe=(0,V.J9)((e=>({header:[(0,z.aS)(e),{height:"70px",padding:"0px ".concat(K.B.HeaderDropdownItemSpacing)}],subComponentStyles:{menuItem:xe(e)}}))),xe=(0,V.J9)((e=>({item:{"&.button, &.link > div":[(0,z.$Z)(),{height:Te,alignItems:"center"}]},root:{height:Te,"&:hover":(0,z.Mi)(e)}}))),ye=(0,V.J9)((e=>{const t=[z.xK,(0,z.$Z)(),(0,z.gS)("row","nowrap"),{alignItems:"center","> *":{marginLeft:be},"> span:not(:last-child)":{marginRight:"0px"},"> .contextIcon > .ms-Image":[(0,z.$Z)(),{height:Ce,width:Ce,".ms-Image-image":{height:"100%",width:"100%"}}],"> .ms-Label":[(0,z.$Z)(),(0,z.aS)(e),{fontSize:"13px",fontWeight:W.BO.regular,cursor:"pointer"}],"&.link, &.button":{"> .ms-Label":{marginRight:be,marginLeft:be}},"&.button, &.dropdownMenu":{":hover":(0,z.Mi)(e)},"&.link > .ms-Label":{":hover":{textDecoration:"underline"}}}];return(0,W.Zq)("contextSplitButton",t)})),fe="10px",De=(0,V.J9)((e=>{const t=[(0,z.$Z)(),(0,z.gS)("row","nowrap"),{margin:"0px ".concat((0,X.vb)(((0,X.jz)(K.B.TopHeaderIconHorizontalOffset)-(0,X.jz)(K.B.HeaderDropdownItemSpacing))/2+(0,X.jz)("8px")))}],r=[(0,z.$Z)(),(0,z.aS)(e),{padding:"0px",fontSize:"13px",fontWeight:W.BO.regular,marginLeft:"8px",cursor:"pointer","> span:first-child":{marginRight:"4px"},"> .value":[(0,z.aS)(e),e===m.Sx.SharePoint&&{color:Z.z.SharepointButtonHoverColor()}]}];return{root:t,dropdownMenu:[z.xK,(0,z.$Z)(),(0,z.gS)("row","nowrap"),{alignItems:"center",cursor:"pointer",margin:"0px ".concat((0,X.vb)(((0,X.jz)(K.B.HeaderDropdownItemSpacing)-(0,X.jz)(fe))/2)),height:"38px","&:hover":[(0,z.Mi)(e),e===m.Sx.TeamsLight&&{backgroundColor:Z.z.NeutralLight},{borderRadius:"2px"}],"> *":{margin:"0px ".concat((0,X.vb)((0,X.jz)(fe)/2))},"> .ms-Label":r,"> .plannerDiamond":{marginRight:"-8px",marginTop:"3px",svg:{transform:"scale(0.7)"}}},e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black,color:Z.z.White,"&:hover":{"> .ms-Label, > .ms-Label > .value":{color:Z.z.Black}}}],dropdownIcon:[(0,z.$Z)(),(0,z.gS)("row","nowrap"),z.cc,(0,z.aS)(e),{marginRight:"8px","> .dropdownChevronIcon":{display:"inline"},"> .dropdownHiddenTextIcon":{display:"none"}}]}})),we=(0,V.J9)((e=>({root:(0,W.Zq)("dropdowns",e.root),dropdownMenu:(0,W.Zq)("dropdownMenu",e.dropdownMenu),dropdownIcon:(0,W.Zq)("dropDownIcon",e.dropdownIcon)})));var Le=r(55491),Be=r.n(Le),Ee=r(21382),Ae=r(6505),Fe=r(99535),Ie=r(81877);class Me extends g.${name(){return"ContextDropdown"}renderComponent(){return this.renderSplitButton()}getHeaderDropdownClassNames(){return we(De(this.props.theme))}renderSplitButton(){var e;const{onRenderLabel:t,className:r,theme:o}=this.props,n=this.generateSplitButtonProps();if(null==n)return null;if(t)return k.createElement("button",{className:r,ref:"contextCommandButton",onClick:this.toggleContextCallout},t(n),this.state.isContextCalloutVisible&&this.renderContextCallout(n.dropdownItems));let a=(0,oe.A)(ye(o),r);if(n.dropdownItems.length-1===1){const e=n.dropdownItems[1];return a=(0,oe.A)(a,e.className),k.createElement("button",{className:a,ref:"link",onClick:t=>this.openLink(e,t),"aria-label":e.ariaLabel},k.createElement(B.I,{...e.iconProps,className:"contextIcon"}),k.createElement(me.J,{className:"context-text"},e.fallbackText))}const s=this.getHeaderDropdownClassNames();a=(0,oe.A)(a,s.dropdownMenu);const i=this.state.isContextCalloutVisible?U.p.Strings.PlannerHeader_RightSectionExpandedAriaLabel:U.p.Strings.PlannerHeader_RightSectionCollapsedAriaLabel;return k.createElement("button",{className:a,ref:"contextCommandButton",onClick:this.toggleContextCallout,"aria-label":Ee.G(U.p.Strings.PlanContextLinking_OpenLinkText,i)},k.createElement(B.I,{...n.currentValueIconProps,className:(0,oe.A)(null===(e=n.currentValueIconProps)||void 0===e?void 0:e.className,"contextIcon")}),k.createElement(me.J,null,n.currentValue),k.createElement("span",{className:s.dropdownIcon},k.createElement(B.I,pe.Ju),this.state.isContextCalloutVisible&&this.renderContextCallout(n.dropdownItems)))}renderContextCallout(e){const{theme:t,calloutProps:r,isBeakVisible:o,onRenderCallout:n}=this.props;return n?n(e):k.createElement(ie.l,{calloutProps:{...r,calloutMaxWidth:257},className:"contextContextualMenu",shouldFocusOnMount:!0,contextualMenuItemAs:this.contextualMenuItemAs,items:e,directionalHint:se.A.bottomRightEdge,target:this.refs.contextCommandButton,onDismiss:this.dismissContextCallout,isBeakVisible:o,appTheme:t,styles:Pe(t)})}generateSplitButtonProps(){const{visibleContextKeys:e}=this.props;if(e.length<1)return null;const t=[];let r,o="";o=U.p.Strings.PlanContextLinking_OpenLinkText,t.push({key:"header",itemType:A.G.Header,text:U.p.Strings.PlanContextLinking_MultipleLinkedContextsText,ariaLabel:U.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel,href:m.$j.linkedPlans,secondaryText:U.p.Strings.SharedComponents_LearnMoreLink,target:"_blank",canCheck:!1}),e.length>1&&t.push({key:"divider_1",itemType:A.G.Divider});let n=!0;Be()(e,(a=>{const s=this.getContextMenuItemForContextKey(a);null!=s&&(t.push(s),n&&(1===e.length&&(o=s.text),r=s.iconProps,n=!1))}));return{currentValueIconProps:r,currentValue:o,dropdownItems:t}}getContextMenuItemForContextKey(e){var t,r;const{contextDetails:o,contexts:n,title:a,planContainer:s}=this.props;if(null==n[e]||null==o||null==o[e])return null;let i=a,l="",c="",p="button";const d=n[e],u=null!==(t=null===s||void 0===s?void 0:s.displayName)&&void 0!==t?t:"",h=(0,Ie.C)(d,u),m=o[e];switch(m.displayAs){case ke.s.MeetingNotes:i=l=U.p.Strings.PlanContextLinking_MeetingNotes,c=Ee.G(U.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,U.p.Strings.PlanContextLinking_MeetingNotes,U.p.Strings.PlanContextLinking_MicrosoftLoop),p="link";break;case ke.s.LoopPage:c=Ee.G(U.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,U.p.Strings.PlanContextLinking_MicrosoftLoop),l=U.p.Strings.PlanContextLinking_MicrosoftLoop;break;case ke.s.SharePointPage:c=Ee.G(U.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,U.p.Strings.PlanContextLinking_SharePoint),l=U.p.Strings.PlanContextLinking_OpenInSharePoint;break;case ke.s.TeamsTab:c=Ee.G(U.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,U.p.Strings.PlanContextLinking_Teams),l=U.p.Strings.PlanContextLinking_OpenInMicrosoftTeams;break;case ke.s.Other:i=l=null!==(r=m.customLinkText)&&void 0!==r?r:h,c=Ee.G(U.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,i,U.p.Strings.PlanContextLinking_Other);break;default:return null}const g=m.status===Fe.$.Delinked?U.p.Strings.PlanContextLinking_DelinkedContextSecondaryText:(0,Ie.C)(d,u);return null!=(null===m||void 0===m?void 0:m.url)&&null!=m.displayAs?{key:e,className:p,itemType:A.G.Normal,text:i,fallbackText:l,ariaLabel:c,href:null===m||void 0===m?void 0:m.url,onClick:this.logContextClick,data:{displayAs:m.displayAs,status:m.status},secondaryText:g,target:"_blank",iconProps:{imageProps:{src:(0,Ae.qz)(m.displayAs,this.context.traceLogger)}}}:null}openLink(e,t){this.logContextClick(t,e),window.open(e.href,e.target)}constructor(e,t){super(e,t),this.contextualMenuItemAs=e=>{const t=ve(Se(this.props.theme));return e.item.itemType===A.G.Header?k.createElement("div",{className:t.root,"aria-label":e.item.ariaLabel},k.createElement("span",{className:t.itemText},e.item.text," ",k.createElement(ge.N,{className:t.headerLink,href:e.item.href,target:e.item.target},e.item.secondaryText))):e.item.itemType===A.G.Normal?k.createElement("div",{className:t.contextRow,"aria-label":e.item.ariaLabel},k.createElement(B.I,{...e.item.iconProps,className:t.contextIcon}),k.createElement("div",{className:t.contextDetailsColumn},k.createElement("span",{className:t.contextDetailsText},e.item.text),k.createElement("span",{className:t.contextDetailsSecondaryText},e.item.data.status===Fe.$.Delinked&&k.createElement(B.I,pe.aA),e.item.secondaryText))):null},this.toggleContextCallout=()=>{this.setState((e=>({isContextCalloutVisible:!e.isContextCalloutVisible})))},this.dismissContextCallout=()=>{this.setState({isContextCalloutVisible:!1})},this.logContextClick=(e,t)=>{var r;const o={};null!=(null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.displayAs)&&(o.displayAs=t.data.displayAs),this.logUsage("PlanContextClicked",o)},this.state={isContextCalloutVisible:!1}}}var Ne=r(67048),_e=r(94028),Re=r(39410);const Ue=(0,V.J9)(((e,t)=>{const r=(0,z.GD)(),o=[(0,z.$Z)(),{"> .plannerIcon":[(0,z.$Z)(),(0,z.aS)(e),{cursor:"pointer",fontSize:"16px",transition:"transform 0.2s ease-in-out",transform:"rotate(180deg)"},t&&{transform:"rotate(0deg)"}]}],n=[z.xK,(0,z.aS)(e),(0,z.D1)(e),(0,z.gS)(),{alignItems:"center",cursor:"pointer",height:"35px","> *":{fontSize:W.s.medium,fontWeight:W.BO.semibold}},e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black,color:Z.z.White,borderColor:Z.z.White,borderWidth:"1px 0px",borderStyle:"solid",boxSizing:"border-box",":focus, :hover":{borderColor:Z.z.TeamsContrastHyperlinkColor,"> .sectionToggle > .plannerIcon":{color:Z.z.TeamsContrastHyperlinkColor}}}];return{root:[(0,z.gS)("column"),{flexShrink:0,paddingTop:"2px","> .sectionRowsContainer":(0,z.gS)("column")}],header:n,title:r,sectionToggle:o}})),He=(0,V.J9)(((e,t)=>{const r=Ue(e,t);return{root:(0,W.Zq)("filterSection",r.root),header:(0,W.Zq)("header",r.header),title:(0,W.Zq)("title",r.title),sectionToggle:(0,W.Zq)("sectionToggle",r.sectionToggle)}}));class Oe extends g.${renderComponent(){const e=Ee.G(U.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,this.getFilterTitleAriaLabel(),this.getAppliedFilterCount()),t=this.getClassNames();return k.createElement("div",{className:t.root},k.createElement("button",{className:t.header,"aria-label":e,"aria-expanded":!this.props.isCollapsed,onClick:this.props.toggleSection.bind(this),tabIndex:0},k.createElement("div",{className:t.title},Ee.G(this.props.sectionTitle,this.getAppliedFilterCount())),k.createElement("div",{className:t.sectionToggle},k.createElement(B.I,pe.Ju))),this.props.isCollapsed?null:this.renderSectionFilterRows())}getAppliedFilterCount(){return this.props.currentTaskFilter.getFieldFilterCount(this.getFilterField()).toString()}getClassNames(){const{theme:e,isCollapsed:t}=this.props;return He(e,t)}constructor(e,t){super(e,t)}}var Ve=r(9011),We=r(72721),Ge=r(40787),ze=r(40729);const Ze="35px",Ke="44px",qe="40px",Je="28px",je=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e),o={root:[z.xK,(0,z.gS)(),{height:Ze,cursor:"pointer",padding:"0px ".concat("16px"),"> *":{lineHeight:Ze},":focus, :hover":[(0,z.Mi)(e),e===m.Sx.TeamsContrast&&{color:Z.z.Black}],"&.iconFilterRow":Ye(e),"&.categoryFilterRow":{alignItems:"center"},"&.assignmentFilterRow":Qe(e)},r&&{width:"100%",height:K.B.LoopMenuItemHeight,borderRadius:K.B.LoopSubItemBorderRadius,padding:K.B.LoopMenuItemPadding,alignItems:"center",".textValue":[(0,z.aS)(e),{fontWeight:W.BO.regular}],".plannerCheckMark":(0,z.sC)(e)}],textValue:[(0,z.GD)(),(0,z.q0)("ellipsis"),{fontSize:W.s.medium,fontWeight:W.BO.semibold,display:"block"}],indicator:[(0,z.gS)(),(0,z.$Z)(),{width:Ze,height:Ze,justifyContent:"flex-end","> .ms-Icon":[(0,z._D)(e),{fontSize:"16px"}]}]};return(0,W.TW)(o,t)})),$e=(0,V.J9)((e=>({root:(0,W.Zq)("filterRow",e.root),textValue:(0,W.Zq)("textValue",e.textValue),indicator:(0,W.Zq)("indicator",e.indicator)}))),Ye=(0,V.J9)((e=>{const t=ze.d.isLoopTheme(e);return{alignItems:"center","> .icon":{height:Ze,marginRight:t?K.B.LoopMenuItemIconMarginRight:"16px","> .plannerIcon":{height:Ze,"&:not(i[class^='plannerProgress']):not(i[class^='plannerPriority'])":(0,z.aS)(e)}}}})),Xe=(0,V.J9)((()=>({root:[(0,z.$Z)(),{fontSize:W.s.medium,maxWidth:"205px",height:"20px"}]}))),Qe=(0,V.J9)((e=>{const t=ze.d.isLoopTheme(e);return[{height:t?qe:Ke,"> .photo":[(0,z.$Z)(),{alignSelf:"center",width:t?qe:Ke,"> .plannerIcon":[(0,z.gS)(),(0,z.zK)(e),(0,z.aS)(e),{alignItems:"center",borderRadius:"50%",height:Je,width:Je,justifyContent:"center"}]}]},!t&&{"> *":{lineHeight:"".concat(Ke," !important")},"> .indicator":{width:"".concat(Ke," !important"),height:"".concat(Ke," !important")},":last-child":{marginBottom:"18px"}},t&&{":hover":{"> .photo > .plannerIcon":(0,z.NX)(e)}}]}));class et extends g.${name(){return"BaseFilterRow"}getStylesClassNames(){return $e(je(this.props.theme,this.props.styles))}renderComponent(){const e=this.getStylesClassNames(),t=(0,oe.A)(e.root,this.getClassName());return k.createElement("button",{className:t,onClick:this.props.onToggleFilter.bind(this),tabIndex:0,role:"checkbox","aria-checked":this.props.isSet},this.renderFilterRowIcon(),k.createElement("div",{className:e.textValue},this.props.text),k.createElement("div",{className:e.indicator},this.props.isSet?k.createElement(B.I,pe.r8):null))}constructor(e,t){super(e,t)}}class tt extends et{name(){return"AssignmentFilterRow"}renderFilterRowIcon(){const e=this.props.member.id!==s.lf.UnassignedUserId!=null?this.getMemberPersonaProps(this.props.member):null;return k.createElement("div",{className:"photo"},this.props.member.id!==s.lf.UnassignedUserId?k.createElement(Ge.f,{user:this.props.member,onLoad:this.props.onRenderPersona,containerId:"userContainer-filter-".concat(this.props.member.id)},k.createElement(Ve.F,e)):k.createElement(B.I,pe.T$))}getClassName(){return"assignmentFilterRow"}getMemberPersonaProps(e){return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:this.props.memberPhoto,size:We.WH.extraSmall}}constructor(e,t){super(e,t)}}var rt=r(50204),ot=r(141);class nt extends Oe{name(){return p.M.AssignmentFilterSection}getFilterField(){return"assignments"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName}renderSectionFilterRows(){const e=this.props.members.slice().sort(ot.k),t=rt.K.builder.fromUserResource({Id:s.lf.UnassignedUserId,DisplayName:U.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build();return k.createElement("div",{className:"sectionRowsContainer"},this.renderAssignmentFilter(t),e.map((e=>this.renderAssignmentFilter(e))))}renderAssignmentFilter(e){var t;return k.createElement(tt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onFilterClicked.bind(this,e),memberPhoto:null!==(t=this.props.getUserPhoto(e.id))&&void 0!==t?t:void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),onRenderPersona:this.props.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const r=this.getFilterField(),o=null!=e?e.id:null,n=this.props.currentTaskFilter.doesFilterValueExist(r,o),a=this.props.currentTaskFilter.toggleFilterValue(r,o);this.props.setTaskFilter(a,!1,n,[this.getFilterTitleAriaLabel(),e.displayName]),this.logUsage(p.M.FilterClicked,{filterRemoved:String(n)})}}}class at extends et{name(){return"FilterRow"}renderFilterRowIcon(){return null}getClassName(){return""}constructor(e,t){super(e,t)}}var st=r(70776);class it extends Oe{name(){return p.M.BucketFilterSection}getFilterField(){return"bucketId"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_BucketFilterSectionName}renderSectionFilterRows(){const e=this.props.buckets||[];e.sort(st.k);const t=[];return e.forEach((e=>{t.push(this.renderBucketFilter(e))})),k.createElement("div",{className:"sectionRowsContainer"},t)}renderBucketFilter(e){return k.createElement(at,{key:e.id,text:e.title,onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const r=this.getFilterField(),o=this.props.currentTaskFilter.doesFilterValueExist(r,e.id),n=this.props.currentTaskFilter.toggleFilterValue(r,e.id);this.props.setTaskFilter(n,!1,o,[this.getFilterTitleAriaLabel(),e.title]),this.logUsage(p.M.FilterClicked,{filterRemoved:String(o)})}}}var lt=r(69412);class ct extends et{name(){return"CategoryFilterRow"}renderFilterRowIcon(){return this.props.renderLabelTag?k.createElement(lt.l,{key:this.props.categoryNumber,index:this.props.categoryNumber,title:this.props.categoryName,isCollapsed:!1,theme:this.props.theme,styles:Xe()}):null!==this.props.categoryNumber?k.createElement("span",{className:(0,oe.A)("category-"+this.props.categoryNumber,"categoryIcon")}):null}getClassName(){return"categoryFilterRow"}constructor(e,t){super(e,t)}}var pt=r(38780);class dt extends Oe{name(){return p.M.CategoryFilterSection}getFilterField(){return"appliedCategories"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_LabelFilterSectionName}renderSectionFilterRows(){const{categories:e}=this.props,t=[this.renderCategoryFilterRow(-1,U.p.Strings.Labels_UnlabeledText),...e.map((e=>{let{categoryNumber:t,categoryName:r}=e;return null!=r&&""!==r||(r=pt.U.getLabelPlaceholderByIndex(t)),this.renderCategoryFilterRow(t,r)}))];return k.createElement("div",{className:"sectionRowsContainer"},t)}renderCategoryFilterRow(e,t){const r=-1===e,o=r?null:e,n=r?t:"";return k.createElement(ct,{key:e,text:n,categoryName:t,categoryNumber:e,onToggleFilter:this.onFilterClicked.bind(this,o,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),o),renderLabelTag:!r,theme:this.props.theme})}onFilterClicked(e,t){const r=this.getFilterField(),o=this.props.currentTaskFilter.doesFilterValueExist(r,e),n=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(n,!1,o,[this.getFilterTitleAriaLabel(),t]),this.logUsage(p.M.FilterClicked,{filterRemoved:String(o)})}constructor(e,t){super(e,t)}}class ut extends Oe{name(){return p.M.DueDateFilterSection}getFilterField(){return"dueDate"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;return!1===e.renderSection?null:k.createElement("div",{className:"sectionRowsContainer"},e.renderLateOption&&this.renderDateFilter(s.Tt.Late),e.renderTodayOption&&this.renderDateFilter(s.Tt.Today),e.renderTomorrowOption&&this.renderDateFilter(s.Tt.Tomorrow),e.renderThisWeekOption&&this.renderDateFilter(s.Tt.ThisWeek),e.renderNextWeekOption&&this.renderDateFilter(s.Tt.NextWeek),e.renderFutureOption&&this.renderDateFilter(s.Tt.Future),e.renderNoDateOption&&this.renderDateFilter(s.Tt.NoDate),e.renderSomeDateOption&&this.renderDateFilter(s.Tt.SomeDate))}renderDateFilter(e){return k.createElement(at,{text:this.getDateFilterTitle(e),onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e),theme:this.props.theme})}getDateFilterTitle(e){switch(e){case s.Tt.NoDate:return U.p.Strings.PlannerApp_NoDateDueDateText;case s.Tt.Late:return U.p.Strings.PlannerApp_LateDueDateText;case s.Tt.Today:return U.p.Strings.PlannerApp_TodayDueDateText;case s.Tt.Tomorrow:return U.p.Strings.PlannerApp_TomorrowDueDateText;case s.Tt.ThisWeek:return U.p.Strings.PlannerApp_ThisWeekDueDateText;case s.Tt.NextWeek:return U.p.Strings.PlannerApp_NextWeekDueDateText;case s.Tt.Future:return U.p.Strings.PlannerApp_FutureDueDateText;case s.Tt.SomeDate:return U.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error("UnsupportedException: filterValue")}}onFilterClicked(e,t){const r=this.getFilterField(),o=this.props.currentTaskFilter.doesFilterValueExist(r,e),n=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(n,!1,o,[this.getFilterTitleAriaLabel(),this.getDateFilterTitle(e)]),this.logUsage(p.M.FilterClicked,{dueDateCategory:s.Tt[e],filterRemoved:String(o)})}constructor(e,t){super(e,t)}}class ht extends et{name(){return"IconFilterRow"}renderFilterRowIcon(){return k.createElement("div",{className:"icon"},this.props.iconProps&&k.createElement(B.I,this.props.iconProps))}getClassName(){return"iconFilterRow"}constructor(e,t){super(e,t)}}var mt=r(24723),gt=r(67271);class kt extends Oe{name(){return p.M.PriorityFilterSection}getFilterField(){return"priority"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderUrgentOption&&t.push(this.renderPriorityFilterRow(mt.gy.Urgent,U.p.Strings.Task_PriorityUrgentText)),e.renderImportantOption&&t.push(this.renderPriorityFilterRow(mt.gy.Important,U.p.Strings.Task_PriorityImportantText)),e.renderMediumOption&&t.push(this.renderPriorityFilterRow(mt.gy.Medium,U.p.Strings.Task_PriorityMediumText)),e.renderLowOption&&t.push(this.renderPriorityFilterRow(mt.gy.Low,U.p.Strings.Task_PriorityLowText)),k.createElement("div",{className:"sectionRowsContainer"},t)}renderPriorityFilterRow(e,t){const r=(0,gt._d)(e);return k.createElement(ht,{key:e,text:t,iconProps:(0,Ae.m4)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),r),theme:this.props.theme})}onFilterClicked(e,t){const r=this.getFilterField(),o=this.props.currentTaskFilter.doesFilterValueExist(r,e),n=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(n,!1,o,[this.getFilterTitleAriaLabel(),t]),this.logUsage(p.M.FilterClicked,{priorityName:t,filterRemoved:String(o)})}constructor(e,t){super(e,t)}}var Ct=r(94772);class bt extends Oe{name(){return p.M.ProgressFilterSection}getFilterField(){return"percentComplete"}getFilterTitleAriaLabel(){return U.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderNotStartedOption&&t.push(this.renderProgressFilterRow(Ct.$.NotStarted,U.p.Strings.TaskCard_TaskNotStartedText)),e.renderInProgressOption&&t.push(this.renderProgressFilterRow(Ct.$.InProgress,U.p.Strings.TaskCard_TaskInProgressText)),e.renderCompleteOption&&t.push(this.renderProgressFilterRow(Ct.$.Complete,U.p.Strings.TaskCard_TaskCompletedText)),k.createElement("div",{className:"sectionRowsContainer"},t)}renderProgressFilterRow(e,t){const r=(0,gt.BK)(e);return k.createElement(ht,{key:e,text:t,iconProps:(0,Ae.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),r),theme:this.props.theme})}onFilterClicked(e,t){const r=this.props.currentTaskFilter.doesFilterValueExist("percentComplete",e),o=this.props.currentTaskFilter.toggleFilterValue("percentComplete",e);this.props.setTaskFilter(o,!1,r,[this.getFilterTitleAriaLabel(),t]),this.logUsage(p.M.FilterClicked,{progressName:t,filterRemoved:String(r)})}constructor(e,t){super(e,t)}}var Tt=r(72866),St=r(93950),vt=r.n(St),Pt=r(49728);const xt="16px",yt=xt,ft=(0,V.J9)(((e,t)=>{const r={root:[(0,z.NX)(e),{width:"300px",paddingTop:xt,"> .ms-Callout-main":[(0,z.aS)(e),(0,z.NX)(e),{"> div":[(0,z.gS)("column"),{maxHeight:"".concat("70vh"," !important"),overflowY:"hidden !important","> .ie11Scroll":{maxHeight:"58vh"}}]}]},e===m.Sx.SharePoint&&{".plannerProgressInProgress, .plannerProgressInProgressSmall":{color:Z.z.SharepointBlueIconColor()},".plannerProgressComplete, .plannerProgressCompleteSmall":{color:Z.z.SharepointCompleteColor()},".plannerPriorityUrgent, .plannerPriorityUrgentSmall":{color:Z.z.SharepointHighPriIconColor()},".plannerPriorityImportant, .plannerPriorityImportantSmall":{color:Z.z.SharepointHighPriIconColor()},".plannerPriorityMedium":{color:Z.z.SharepointCompleteColor()},".plannerPriorityLow":{color:Z.z.SharepointBlueIconColor()},".plannerRecurrence, .plannerRecurrenceSmall ":{color:Z.z.SharepointHighPriIconColor()}}],filterHeader:[(0,z.gS)(),{padding:"0px ".concat(xt," ").concat("6px"),minHeight:"20px",justifyContent:"space-between","> .filterTitle":{fontSize:"17px",fontWeight:W.BO.semibold,cursor:"default"},"> .clearFilters":[z.xK,(0,z._D)(e),e===m.Sx.SharePoint&&{color:Z.z.SharepointTitleFontColor()},{cursor:"pointer"},e===m.Sx.TeamsContrast&&{":focus, :hover":{color:Z.z.TeamsContrastHyperlinkColor}}]}],titleFilterBox:{height:"35px",margin:"0px ".concat(yt," ").concat("6px"),".ms-TextField-fieldGroup":[(0,z.Nc)(e),{".ms-TextField-field":[(0,z.aS)(e),(0,z.Oj)(e),e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black,border:"1px solid ".concat(Z.z.White)},e!==m.Sx.SharePoint&&{borderRadius:"3px"}],":hover":[e!==m.Sx.TeamsContrast&&e!==m.Sx.SharePoint&&{borderColor:"transparent"}]}],"&.is-active":{"> .ms-TextField-wrapper > .ms-TextField-fieldGroup":[(0,z.oO)(e),{"::after":{border:"none"}}]}},filterSections:[(0,z.gS)("column"),{overflowY:"auto",".title":{paddingLeft:xt},".sectionToggle":{paddingRight:xt}}]};return(0,W.TW)(r,t)})),Dt=(0,V.J9)((e=>({root:(0,W.Zq)("taskFilterCallout",e.root),filterHeader:(0,W.Zq)("filterHeader",e.filterHeader),titleFilterBox:(0,W.Zq)("titleFilterBox",e.titleFilterBox),filterSections:(0,W.Zq)("filterSections",e.filterSections)})));class wt extends g.${name(){return p.M.TaskFilterCallout}renderComponent(){const{options:e}=this.props,t=this.getClassNames(),r=window.navigator.userAgent.indexOf("Trident/7.0")>0?(0,oe.A)(t.filterSections,"ie11Scroll"):t.filterSections;return k.createElement(Re.P,{id:"taskFilterCallout",target:this.props.targetElement,directionalHint:se.A.bottomRightEdge,className:t.root,setInitialFocus:!1,isBeakVisible:!1,onDismiss:this.props.callbacks.onDismiss,gapSpace:0,role:"complementary"},k.createElement(Ne.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},k.createElement("div",{className:t.filterHeader},k.createElement("div",{className:"filterTitle"},U.p.Strings.TaskFilterCallout_FilterTitle),k.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":U.p.Strings.TaskFilterCallout_ClearFiltersAriaLabel},U.p.Strings.TaskFilterCallout_ClearFilters)),k.createElement(_e.A,{ariaLabel:U.p.Strings.TaskFilterCallout_FilterTextFieldAriaLabel,autoAdjustHeight:!0,autoFocus:!0,className:t.titleFilterBox,multiline:!1,placeholder:U.p.Strings.TaskFilterCallout_TitleFilterInputPlaceholderText,value:this.state.currentlyTypedText,resizable:!1,onChange:(e,t)=>{this.onFilterTextValueChanged(null!==t&&void 0!==t?t:"")}}),k.createElement("div",{className:r},e.dueDateFilterOptions.renderSection&&this.renderDueDateFiltersSection(),e.priorityFilterOptions.renderSection&&this.renderPriorityFiltersSection(),e.progressFilterOptions.renderSection&&this.renderProgressFiltersSection(),e.labelFilterOptions.renderSection&&this.renderCategoryFiltersSection(),e.bucketFilterOptions.renderSection&&this.renderBucketFiltersSection(),e.assignmentFilterOptions.renderSection&&this.renderAssignmentFiltersSection())))}renderAssignmentFiltersSection(){const{users:e,currentTaskFilter:t,taskData:r,callbacks:o,theme:n}=this.props;if(!e)return null;const a=r?(0,Pt.rA)(e,r,t):e;return k.createElement(nt,{members:a,currentTaskFilter:t,sectionTitle:U.p.Strings.TaskFilterCallout_AssignmentSectionTitle,isCollapsed:this.state.isAssignmentSectionCollapsed,setTaskFilter:o.setTaskFilter,toggleSection:this.onAssignmentSectionToggle.bind(this),getUserPhoto:o.getUserPhoto,onRenderPersona:o.onRenderPersona,theme:n})}renderBucketFiltersSection(){return this.props.buckets?k.createElement(it,{buckets:this.props.buckets,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:U.p.Strings.TaskFilterCallout_BucketSectionTitle,isCollapsed:this.state.isBucketSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onBucketSectionToggle.bind(this),theme:this.props.theme}):null}renderCategoryFiltersSection(){const{categories:e,currentTaskFilter:t,taskData:r,callbacks:o,theme:n}=this.props;if(!e)return null;const a=(0,Pt.$p)(e,r,t);return k.createElement(dt,{categories:a,currentTaskFilter:t,sectionTitle:U.p.Strings.TaskFilterCallout_CategoryLabelSectionTitle,isCollapsed:this.state.isCategorySectionCollapsed,setTaskFilter:o.setTaskFilter,toggleSection:this.onCategorySectionToggle.bind(this),theme:n})}renderDueDateFiltersSection(){return k.createElement(ut,{options:this.props.options.dueDateFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:U.p.Strings.TaskFilterCallout_DueDateSectionTitle,isCollapsed:this.state.isDueDateSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onDueDateSectionToggle.bind(this),theme:this.props.theme})}renderPriorityFiltersSection(){return k.createElement(kt,{options:this.props.options.priorityFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:U.p.Strings.TaskFilterCallout_PrioritySectionTitle,isCollapsed:this.state.isPrioritySectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onPrioritySectionToggle.bind(this),theme:this.props.theme})}renderProgressFiltersSection(){return k.createElement(bt,{options:this.props.options.progressFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:U.p.Strings.TaskFilterCallout_ProgressSectionTitle,isCollapsed:this.state.isProgressSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onProgressSectionToggle.bind(this),theme:this.props.theme})}onFilterTextValueChanged(e){let t;this.logUsage(p.M.FilterByKeyword,{filterRemoved:String(""===e)}),t=""===e?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new Tt.d("title",[e])),this.setState((t=>({currentlyTypedText:e}))),this.debouncedTextFilterCallback(t)}onAssignmentSectionToggle(){this.setState((e=>({isAssignmentSectionCollapsed:!e.isAssignmentSectionCollapsed})))}onBucketSectionToggle(){this.setState((e=>({isBucketSectionCollapsed:!e.isBucketSectionCollapsed})))}onDueDateSectionToggle(){this.setState((e=>({isDueDateSectionCollapsed:!e.isDueDateSectionCollapsed})))}onCategorySectionToggle(){this.setState((e=>({isCategorySectionCollapsed:!e.isCategorySectionCollapsed})))}onPrioritySectionToggle(){this.setState((e=>({isPrioritySectionCollapsed:!e.isPrioritySectionCollapsed})))}onProgressSectionToggle(){this.setState((e=>({isProgressSectionCollapsed:!e.isProgressSectionCollapsed})))}clearFilters(){this.logUsage(p.M.ClearFilters),this.props.callbacks.setTaskFilter(new Tt.S,!0),this.setState((e=>({currentlyTypedText:""})))}getClassNames(){return Dt(ft(this.props.theme,this.props.styles))}constructor(e,t){super(e,t);const r=this.props.currentTaskFilter.filters.filter((e=>"title"===e.field))[0];this.state={currentlyTypedText:null!=(null===r||void 0===r?void 0:r.values[0])?r.values[0].toString():"",isAssignmentSectionCollapsed:!1,isBucketSectionCollapsed:!0,isDueDateSectionCollapsed:!1,isCategorySectionCollapsed:!0,isPrioritySectionCollapsed:!0,isProgressSectionCollapsed:!0},this.debouncedTextFilterCallback=vt()(e.callbacks.setTaskFilter,200)}}var Lt=r(54555),Bt=r(53815);const Et="16px",At=(0,V.J9)(((e,t)=>{const r={root:[(0,z.gS)("column"),(0,z.NX)(e),{alignItems:"flex-start",maxHeight:"400px",maxWidth:"260px","> ul":[(0,z.gS)("column"),{alignSelf:"center",width:"100%"}],".ms-ContextualMenu-item:hover":{".assignmentFilterNoResults":(0,z.NX)(e)},".assignmentFilterNoResults":[(0,z.aS)(e),{textAlign:"center",width:K.B.MenuItemWidth,padding:"30px 0px"}]}],header:[(0,z.gS)(),{width:K.B.MenuItemWidth,height:"32px",alignItems:"center",padding:"".concat(K.B.LoopMenuItemPadding," 0px"),justifyContent:"space-between",fontSize:Bt.s.small,fontWeight:Bt.BO.semibold,"> .filterTitle":[(0,z.aS)(e),{paddingLeft:Et}],"> .clearFilters":[z.xK,(0,z._D)(e),(0,q.c3)(),{cursor:"pointer",paddingRight:Et}]}],menuItems:[(0,z.gS)(),{width:K.B.MenuItemWidth,height:K.B.LoopMenuItemHeight,alignItems:"center",alignSelf:"center",button:[(0,z.gS)(),{borderRadius:K.B.LoopSubItemBorderRadius,padding:K.B.LoopMenuItemPadding,alignItems:"center",".ms-ContextualMenu-linkContent":{width:"100%"},".ms-ContextualMenu-submenuIcon":[(0,z.$Z)(),{justifyContent:"flex-end"}]}]}]};return(0,W.TW)(r,t)})),Ft=(0,V.J9)((e=>({root:(0,W.Zq)("taskFilterMenu",e.root),header:(0,W.Zq)("header",e.header),menuItems:(0,W.Zq)("menuItems",e.menuItems)}))),It=(0,V.J9)((e=>({root:[(0,z.zK)(e),(0,q.kE)(),{width:K.B.MenuItemWidth,height:K.B.LoopMenuItemHeight,borderRadius:"8px",alignSelf:"center",border:"none",padding:K.B.LoopMenuItemPadding,"&.is-active":[{"::after":[(0,q.lX)({border:"none !important"}),(0,z.T4)(e),{borderRadius:K.B.LoopSubItemBorderRadius}]}],"&.assignmentFilterSearchBox":{paddingLeft:"14px",margin:"12px 12px 0px 12px","> input":{marginLeft:"2px"},i:{marginLeft:"0px"}}}],icon:[(0,z.A9)(e),{marginLeft:"2px",paddingLeft:"0px",span:{justifyContent:"flex-start"}}],field:[(0,z.MJ)(e),(0,z.aS)(e),{marginLeft:"4px"}],clearButton:{marginRight:"-6px"}})));var Mt=r(86634),Nt=r(26727),_t=r.n(Nt);function Rt(e){switch(e){case s.Tt.NoDate:return U.p.Strings.PlannerApp_NoDateDueDateText;case s.Tt.Late:return U.p.Strings.PlannerApp_LateDueDateText;case s.Tt.Today:return U.p.Strings.PlannerApp_TodayDueDateText;case s.Tt.Tomorrow:return U.p.Strings.PlannerApp_TomorrowDueDateText;case s.Tt.ThisWeek:return U.p.Strings.PlannerApp_ThisWeekDueDateText;case s.Tt.NextWeek:return U.p.Strings.PlannerApp_NextWeekDueDateText;case s.Tt.Future:return U.p.Strings.PlannerApp_FutureDueDateText;case s.Tt.SomeDate:return U.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error("Unexpected DueDateCategory value: ".concat(e))}}function Ut(e){switch(e){case d.mW.DueDate:return U.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName;case d.mW.Priority:return U.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName;case d.mW.Progress:return U.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName;case d.mW.Label:return U.p.Strings.BaseTaskFilterSection_LabelFilterSectionName;case d.mW.Bucket:return U.p.Strings.BaseTaskFilterSection_BucketFilterSectionName;case d.mW.Assignment:return U.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName;default:throw new Error("Unexpected FilterTypes value: ".concat(e))}}function Ht(e,t,r){return Ee.G(U.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,Ut(e),Ot(t,r))}function Ot(e,t){return t.getFieldFilterCount(e)}function Vt(e,t,r){let o=e;const n=Ot(t,r);return n>0&&(o=o.concat(" (",n.toString(),")")),o}class Wt extends g.${name(){return"TaskFilterMenu"}getClassNames(){return Ft(At(this.props.theme,this.props.styles))}renderComponent(){const e=this.getClassNames();return k.createElement(ie.l,{className:e.root,items:this.getFilterMenuItems(e),directionalHint:se.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.callbacks.onDismiss,onRestoreFocus:this.onRestoreFocus,onRenderMenuList:(t,r)=>this.renderMenuList(e,t,r),appTheme:this.props.theme,styles:this.props.contextualMenuStyles})}renderMenuList(e,t,r){return k.createElement(k.Fragment,null,k.createElement("div",{className:e.header},k.createElement("div",{className:"filterTitle"},U.p.Strings.TaskFiltering_FiltersMenuHeaderText),k.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":U.p.Strings.TaskFiltering_ClearFiltersAriaLabel},U.p.Strings.TaskFiltering_ClearFilters)),!this.props.hideSearchBox&&k.createElement(Lt.G,{placeholder:U.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:U.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:pe._x,clearButtonProps:{iconProps:pe.s5},value:this.state.currentlyTypedText,onChange:this.onFilterSearchBoxChange,styles:It(this.props.theme)}),r?r(t):null)}clearFilters(){this.context.usageLogger.logData(p.M.TaskFilterMenu,p.M.ClearFilters),this.props.callbacks.setTaskFilter(new Tt.S,!0),this.setState((e=>({currentlyTypedText:""})))}clearAssignmentFilter(){this.setState({currentlyTypedTextAssignment:""})}getFilterMenuItems(e){return[this.getDueDateMenuItem(e),this.getPriorityMenuItem(e),this.getProgressMenuItem(e),this.getLabelMenuItem(e),this.getBucketMenuItem(e),this.getAssignmentMenuItem(e)]}getBucketMenuItem(e){const{currentTaskFilter:t}=this.props,r=[],o=this.props.buckets||[];o.sort(st.k);for(const n of o)r.push({key:n.title,onRender:()=>this.renderBucketFilterRow(n)});return{key:d.mW.Bucket,name:Vt(U.p.Strings.Task_BucketIdFieldText,d.Gx.Bucket,t),ariaLabel:Ht(d.mW.Bucket,d.Gx.Bucket,t),className:e.menuItems,iconProps:pe.fD,subMenuProps:{items:r,calloutProps:{className:"plannerAppCallout"},styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}getLabelMenuItem(e){const{currentTaskFilter:t,taskData:r}=this.props,o=[],n=this.props.categories||[];o.push({key:"Unlabeled",onRender:()=>this.renderCategoryFilterRow(-1,U.p.Strings.Labels_UnlabeledText)});return(0,Pt.$p)(n,r,t).forEach((e=>{let{categoryNumber:t,categoryName:r}=e;const n=null!==r&&void 0!==r?r:pt.U.getLabelPlaceholderByIndex(t);o.push({key:n,onRender:()=>this.renderCategoryFilterRow(t,n)})})),{key:d.mW.Label,name:Vt(U.p.Strings.Task_LabelsFieldText,d.Gx.Label,t),ariaLabel:Ht(d.mW.Label,d.Gx.Label,t),className:e.menuItems,iconProps:pe.Oi,subMenuProps:{items:o,calloutProps:{className:"plannerAppCallout"},styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}onCategoryFilterClicked(e,t){this.context.usageLogger.logData(p.M.CategoryFilterSection,p.M.FilterClicked);const r=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Label,e),o=this.props.currentTaskFilter.toggleFilterValue(d.Gx.Label,e);this.props.callbacks.setTaskFilter(o,!1,r,[Ut(d.mW.Label),t])}getAssignmentMenuItems(){const{members:e,currentTaskFilter:t,taskData:r}=this.props,o=[];let n=r?(0,Pt.rA)(e,r,t):e;const{currentlyTypedTextAssignment:a}=this.state;if(a){if(n=n.filter((e=>-1!==e.formattedDisplayName.toLowerCase().indexOf(a.toLowerCase()))).sort(ot.k),!n||v()(n)){const e=k.createElement("div",{className:"assignmentFilterNoResults"},U.p.Strings.TaskFiltering_FilterNoResultsFound);return o.push({key:"noResults",onRender:()=>e}),o}}else{n=[rt.K.builder.fromUserResource({Id:s.lf.UnassignedUserId,DisplayName:U.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build(),...n.slice().sort(ot.k)]}for(const s of n)o.push({key:s.id,text:s.formattedDisplayName,onRender:this.renderAssignmentFilterRow.bind(this,s)});return o}getAssignmentMenuItem(e){const{currentTaskFilter:t}=this.props;return{key:d.mW.Assignment,name:Vt(U.p.Strings.Task_AssignmentFieldText,d.Gx.Assignment,t),ariaLabel:Ht(d.mW.Assignment,d.Gx.Assignment,t),className:e.menuItems,iconProps:pe.Nz,subMenuProps:{items:this.getAssignmentMenuItems(),onRenderMenuList:(t,r)=>this.renderAssignmentMenuList(e,t,r),calloutProps:{className:"plannerAppCallout"},styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}renderAssignmentMenuList(e,t,r){return k.createElement(k.Fragment,null,k.createElement(Lt.G,{placeholder:U.p.Strings.TaskFiltering_AssignmentFilterInputPlaceholderText,ariaLabel:U.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,className:"assignmentFilterSearchBox",iconProps:pe._x,clearButtonProps:{iconProps:pe.s5},value:this.state.currentlyTypedTextAssignment,onAbort:this.clearAssignmentFilter,onChange:this.onAssignmentFilterSearchBoxChange,styles:It(this.props.theme)}),r?r(t):null)}getDueDateMenuItem(e){const{currentTaskFilter:t}=this.props,r=[],o=_t()(s.Tt).filter((e=>e!==s.Tt.SomeDate));for(const n of _t()(o))isNaN(Number(n))||r.push({key:n.toString(),onRender:this.renderDueDateFilterRow.bind(this,n)});return{key:d.mW.DueDate,name:Vt(U.p.Strings.Task_DueDateFieldText,d.Gx.DueDate,t),ariaLabel:Ht(d.mW.DueDate,d.Gx.DueDate,t),className:e.menuItems,iconProps:pe.cx,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}getPriorityMenuItem(e){const{currentTaskFilter:t}=this.props,r=[];for(const o of _t()(mt.gy))r.push({key:o,onRender:this.renderPriorityFilterRow.bind(this,o,o)});return{key:d.mW.Priority,name:Vt(U.p.Strings.Task_PriorityFieldText,d.Gx.Priority,t),ariaLabel:Ht(d.mW.Priority,d.Gx.Priority,t),className:e.menuItems,iconProps:pe.iW,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}getProgressMenuItem(e){const{currentTaskFilter:t}=this.props,r=[];return r.push({key:Ct.$.NotStarted,onRender:this.renderProgressFilterRow.bind(this,Ct.$.NotStarted,U.p.Strings.TaskCard_TaskNotStartedText)}),r.push({key:Ct.$.InProgress,onRender:this.renderProgressFilterRow.bind(this,Ct.$.InProgress,U.p.Strings.TaskCard_TaskInProgressText)}),r.push({key:Ct.$.Complete,onRender:this.renderProgressFilterRow.bind(this,Ct.$.Complete,U.p.Strings.TaskCard_TaskCompletedText)}),{key:d.mW.Progress,name:Vt(U.p.Strings.Task_ProgressFieldText,d.Gx.Progress,t),ariaLabel:Ht(d.mW.Progress,d.Gx.Progress,t),className:e.menuItems,iconProps:pe.vE,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,Mt.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:pe.rK}}renderPriorityFilterRow(e,t){const{theme:r,currentTaskFilter:o}=this.props,n=(0,gt._d)(e);return k.createElement(ht,{key:e,text:t,iconProps:(0,Ae.m4)(this.context.traceLogger,r,e),onToggleFilter:this.onPriorityFilterClicked.bind(this,n,t),isSet:o.doesFilterValueExist(d.Gx.Priority,n),theme:r})}onPriorityFilterClicked(e,t){this.context.usageLogger.logData(p.M.PriorityFilterSection,p.M.FilterClicked,{priorityName:t});const r=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Priority,e),o=this.props.currentTaskFilter.toggleFilterValue(d.Gx.Priority,e);this.props.callbacks.setTaskFilter(o,!1,r,[Ut(d.mW.Priority),t])}renderProgressFilterRow(e,t){const r=(0,gt.BK)(e);return k.createElement(ht,{key:e,text:t,iconProps:(0,Ae.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onProgressFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Progress,r),theme:this.props.theme})}onProgressFilterClicked(e,t){this.context.usageLogger.logData(p.M.ProgressFilterSection,p.M.FilterClicked,{progressName:t});const r=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Progress,e),o=this.props.currentTaskFilter.toggleFilterValue(d.Gx.Progress,e);this.props.callbacks.setTaskFilter(o,!1,r,[Ut(d.mW.Progress),t])}renderDueDateFilterRow(e){return k.createElement(ht,{key:e,iconProps:(0,Ae.OY)(e,this.context.traceLogger),text:Rt(e),onToggleFilter:this.onDueDateFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(d.Gx.DueDate,e),theme:this.props.theme})}onDueDateFilterClicked(e){this.context.usageLogger.logData(p.M.DueDateFilterSection,p.M.FilterClicked,{dueDateCategory:s.Tt[e]});const t=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.DueDate,e),r=this.props.currentTaskFilter.toggleFilterValue(d.Gx.DueDate,e);this.props.callbacks.setTaskFilter(r,!1,t,[Ut(d.mW.DueDate),Rt(e)])}renderAssignmentFilterRow(e){var t;return k.createElement(tt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onAssignmentFilterClicked.bind(this,e),memberPhoto:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Assignment,e.id),onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterSearchBoxChange=(e,t)=>{this.context.usageLogger.logData(p.M.TaskFilterMenu,p.M.FilterByKeyword);const r=null!==t&&void 0!==t?t:"";let o;o=""===r?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new Tt.d("title",[r])),this.props.callbacks.setTaskFilter(o),this.setState({currentlyTypedText:r})},this.onAssignmentFilterSearchBoxChange=(e,t)=>{this.setState({currentlyTypedTextAssignment:null!==t&&void 0!==t?t:""})},this.renderBucketFilterRow=e=>k.createElement(at,{key:e.id,text:e.title,onToggleFilter:()=>this.onBucketFilterClicked(e),isSet:this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Bucket,e.id),theme:this.props.theme}),this.onBucketFilterClicked=e=>{this.context.usageLogger.logData(p.M.BucketFilterSection,p.M.FilterClicked);const t=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Bucket,e.id),r=this.props.currentTaskFilter.toggleFilterValue(d.Gx.Bucket,e.id);this.props.callbacks.setTaskFilter(r,!1,t,[Ut(d.mW.Bucket),e.title])},this.renderCategoryFilterRow=(e,t)=>{const r=-1===e,o=r?null:e,n=r?t:"";return k.createElement(ct,{key:e,text:n,categoryName:t,categoryNumber:e,onToggleFilter:()=>this.onCategoryFilterClicked(o,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Label,o),renderLabelTag:!r,theme:this.props.theme})},this.onAssignmentFilterClicked=e=>{const t=null!=e?e.id:null,r=this.props.currentTaskFilter.doesFilterValueExist(d.Gx.Assignment,t),o=this.props.currentTaskFilter.toggleFilterValue(d.Gx.Assignment,t);this.props.callbacks.setTaskFilter(o,!1,r,[Ut(d.mW.Assignment),e.displayName])},this.onRestoreFocus=e=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()};const r=this.props.currentTaskFilter.filters.filter((e=>"title"===e.field))[0];this.state={currentlyTypedText:null!=(null===r||void 0===r?void 0:r.values[0])?r.values[0].toString():"",currentlyTypedTextAssignment:""}}}var Gt=r(65337),zt=r(94850),Zt=r(17323);const Kt=(0,V.J9)(((e,t,r)=>{const o={root:[{"&:focus, &:hover":[{".moreButton":{opacity:"1"}},(0,z.Mi)(e),e===m.Sx.TeamsContrast&&{"> .memberCardContainer > .ms-Persona .ms-Persona-primaryText":{color:Z.z.Black}}]},t&&{opacity:"0.5"}],memberCardContainer:[(0,z.gS)(),{backgroundColor:"transparent",padding:"".concat("6px"," ").concat("24px"),"&:focus, &:hover":{"> .moreButton":{opacity:"1"}}}],moreButton:[z.xK,(0,z.$Z)(),{opacity:"0",cursor:"pointer","&.isMenuOpen":{display:"inline-block"},"&:focus":{opacity:"1"}}]};return(0,W.TW)(o,r)})),qt=(0,V.J9)((e=>({root:(0,W.Zq)("memberCard",e.root),memberCardContainer:(0,W.Zq)("memberCardContainer",e.memberCardContainer),moreButton:(0,W.Zq)("moreButton",e.moreButton)}))),Jt=(0,V.J9)(((e,t)=>{const r={root:[(0,z.GD)(),{overflow:"hidden",cursor:"pointer"}],primaryText:[(0,z.aS)(e),{"&:hover":(0,z.aS)(e)}]};return(0,W.TW)(r,t)}));var jt=r(62948);class $t extends g.${name(){return"Member"}renderComponent(){const e=this.props.isEditable?this.renderEditableMemberItem():this.renderReadOnlyMemberItem(),t=this.getClassNames(),r=(0,oe.A)("plannerAppCallout",t.root),o=this.getPersonaProps(),n=k.createElement("div",{className:r,onKeyUp:this.handleKeyUpEvent.bind(this,o.id),"aria-label":o.text+" "+o.secondaryText,tabIndex:0,"data-is-focusable":!0,ref:this.memberFocusElement,role:"button"},e);var a;return this.props.connectDragSource&&null!==(a=this.props.connectDragSource(n))&&void 0!==a?a:n}cardSource(){return{beginDrag:e=>({user:e.user,userPhoto:e.userPhoto})}}cardCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}getPersonaProps(){let e=this.props.personaProps;e||(e=this.getMemberPersonaProps());const t={...e};return t.onClick=this.highlightCardsAssignedToUser.bind(this,e.id),t}renderReadOnlyMemberItem(){var e;const t=this.getPersonaProps();return k.createElement("div",{className:this.getClassNames().memberCardContainer},k.createElement(Ge.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:"userContainer-memberCard-".concat(null===(e=this.props.user)||void 0===e?void 0:e.id)},k.createElement(Ve.F,{...t,styles:Jt(this.props.theme)})))}renderEditableMemberItem(){var e;const t=this.getPersonaProps(),r=[{key:"remove",name:U.p.Strings.MembersList_RemoveMember,onClick:this.props.onRemoveUser}],o=k.createElement(ie.l,{items:r,target:this.contextMenuLauncher,onDismiss:this.hideContextMenu.bind(this),directionalHint:se.A.bottomAutoEdge,appTheme:this.props.theme}),n=this.getClassNames(),a=(0,oe.A)(n.moreButton,{isMenuOpen:this.state.isContextMenuOpen});return k.createElement("div",{className:n.memberCardContainer},k.createElement(Ge.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:"userContainer-memberCard-".concat(null===(e=this.props.user)||void 0===e?void 0:e.id)},k.createElement(Ve.F,{...t,styles:Jt(this.props.theme)})),k.createElement("button",{className:a,onClick:this.toggleContextMenu.bind(this),ref:this.resolveRef(this,"contextMenuLauncher"),title:U.p.Strings.MembersList_MoreButtonTooltipText,"aria-label":U.p.Strings.MembersList_MoreButtonTooltipText},k.createElement(B.I,{...pe.XP,"data-is-focusable":!1})),this.state.isContextMenuOpen?o:null)}getMemberPersonaProps(){return{id:this.props.user.id,text:this.props.user.formattedDisplayName,secondaryText:this.props.user.mail,imageUrl:this.props.userPhoto,size:We.WH.extraSmall,onClick:this.highlightCardsAssignedToUser.bind(this,this.props.user.id)}}handleKeyUpEvent(e,t){ne.a.getKey(t)===O.D.ENTER&&this.highlightCardsAssignedToUser(e)}highlightCardsAssignedToUser(e){this.props.highlightTasks&&this.props.highlightTasks(s.JS.Assignee,e)}toggleContextMenu(){this.setState((e=>({...e,isContextMenuOpen:!e.isContextMenuOpen})))}hideContextMenu(){this.setState((e=>({...e,isContextMenuOpen:!1})))}getClassNames(){const{theme:e,styles:t,isDragging:r}=this.props;return qt(Kt(e,!!r,t))}constructor(e,t){super(e,t),this.memberFocusElement=k.createRef(),this.state={isContextMenuOpen:!1}}}const Yt=(0,jt.I)("memberCard",$t.prototype.cardSource(),$t.prototype.cardCollect)($t);var Xt=r(9737),Qt=r(89379),er=r(65804),tr=r(19664);const rr="24px",or={fontSize:W.s.xLarge,fontWeight:W.BO.semibold},nr="280px",ar="17px",sr=(0,X.vb)((0,X.jz)(nr)-2*(0,X.jz)(ar)),ir=(0,V.J9)(((e,t,r)=>{const o={root:{},sectionsContainer:[(0,z.gS)("column"),{maxHeight:"80vh",overflowY:"auto","> .membersSection":[(0,z.GD)("auto"),(0,z.gS)("column"),{flexShrink:2,minHeight:t?"120px":"100px"}],"> .sharedContainersSection":[(0,z.GD)("auto"),(0,z.gS)("column"),{minHeight:"80px"}]}],membersTitle:[(0,z.$Z)(),or,{margin:"0px ".concat(rr," ").concat((0,X.vb)((0,X.jz)(rr)/2)," ").concat(rr),cursor:"default"}],membersListContainer:[(0,z.GD)("auto"),{paddingTop:"1px",minHeight:t?"100px":"60px",maxHeight:"481px",overflowY:"auto","> .noViewMembersPermissionMessage":[(0,z.Ml)(e),{margin:"0px ".concat(rr)}]}],noSuggestions:[(0,z.aS)(e),{textAlign:"center",fontSize:W.s.small,lineHeight:30,padding:"5px"}],addGuest:{marginBottom:"10px","> .addGuestBtn":[z.xK,(0,z.jU)(e),{color:Z.z.White,cursor:"pointer",padding:"".concat("12px"," ").concat(ar),width:sr}],"> .addGuestMicrocopy":{fontSize:W.s.small,padding:"10px ".concat(ar)},"> .addGuestHelpLink":[(0,z.BP)(e),{display:"block",fontSize:W.s.small,textDecoration:"none",padding:"10px ".concat(ar)}]},suggestions:[(0,z.aS)(e),(0,z.NX)(e),{width:nr,".ms-Suggestions-title":[(0,z.aS)(e),(0,z.NX)(e),{borderBottom:"none","> .addGuestHelpFooter":{fontSize:W.s.medium,padding:"0 ".concat((0,X.vb)((0,X.jz)(ar)-(0,X.jz)("5px")))}}]}],suggestionsItem:[(0,z.aS)(e),{padding:"5px",":hover":[(0,z.Mi)(e),{".ms-Suggestions-itemButton.is-suggested":(0,z.Mi)(e)}],".ms-Persona":{width:"100%"},".ms-Persona-primaryText":(0,z.aS)(e),".ms-Persona-secondaryText":(0,z.Ml)(e),".ms-Suggestions-itemButton.is-suggested":(0,z.NX)(e)}]};return(0,W.TW)(o,r)})),lr=(0,V.J9)((e=>({root:(0,W.Zq)("membersList",e.root),sectionsContainer:(0,W.Zq)("sectionsContainer",e.sectionsContainer),membersTitle:(0,W.Zq)("membersTitle",e.membersTitle),membersListContainer:(0,W.Zq)("membersListContainer",e.membersListContainer),noSuggestions:(0,W.Zq)("noSuggestions",e.noSuggestions),addGuest:(0,W.Zq)("addGuest",e.addGuest),suggestions:(0,W.Zq)("suggestions",e.suggestions),suggestionsItem:(0,W.Zq)("suggestionsItem",e.suggestionsItem)}))),cr=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e),o={root:[(0,z.NX)(e),{width:"320px",padding:"".concat("16px"," 0px")},r&&{borderRadius:K.B.LoopBorderRadius}],calloutMain:[(0,z.aS)(e),(0,z.NX)(e),{overflowY:"hidden"}]};return(0,W.TW)(o,t)})),pr=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e),o={root:{margin:"0px ".concat(rr," ").concat((0,X.vb)((0,X.jz)(rr)/2)," ").concat(rr)},text:{border:"none","::after":[r&&{borderRadius:K.B.LoopSubItemBorderRadius},(0,z.T4)(e)]},input:[(0,z.aS)(e),(0,z.zK)(e),(0,z.Oj)(e),{minHeight:"34px"}]};return(0,W.TW)(o,t)})),dr=(0,V.J9)((()=>({root:[(0,z.GD)("auto")]})));var ur=r(63633);const hr=(0,Qt.Z)(),mr=(0,er.I)((e=>{let{sharedContainerItems:t,inaccessibleSharedContainerCount:r,theme:o,styles:n}=e;const a=t.length>0,s=r>0,i=t.length+r,l=hr(n,{theme:o,hasMultipleListItems:a&&i>1});let c=null;a?c=U.p.Strings.SharedContainersList_PlanSharedWithFilesMessage:1===r?c=U.p.Strings.SharedContainersList_UnsharedFileFullMessageSingular:r>1&&(c=Ee.G(U.p.Strings.SharedContainersList_UnsharedFileFullMessagePlural,r)),c&&(c+=" ");const p=a?k.createElement("ul",null,t.map(((e,t)=>k.createElement("li",{key:t},k.createElement(tr.S,{styles:l.subComponentStyles.item,...e}))))):null,d=a&&s?k.createElement("div",{className:l.inaccessibleFilesInfo},k.createElement("span",{className:"countBubble"},Ee.G(U.p.Strings.SharedContainersList_PlusNumberOfUnsharedFiles,r)),k.createElement("span",{className:"inaccessibleFilesText"},1===r?U.p.Strings.SharedContainersList_UnsharedFileMessageSingular:U.p.Strings.SharedContainersList_UnsharedFileMessagePlural)):null;return k.createElement("div",{className:l.root},k.createElement("div",{className:l.header},U.p.Strings.SharedContainersList_SharedWithHeader),k.createElement("div",{className:l.description},c,c&&k.createElement(ge.N,{href:m.$j.sharedPlans,target:"_blank",rel:"noopener noreferrer"},U.p.Strings.SharedComponents_LearnMoreLink)),(p||d)&&k.createElement("div",{className:l.itemsList},p,d))}),(e=>{let{theme:t,hasMultipleListItems:r}=e;const o=r?"64px":"40px";return{root:["sharedContainersList",(0,z.gS)("column"),{marginTop:"12px"}],header:["header",(0,z.$Z)(),{margin:"0 ".concat(rr," 8px"),fontSize:W.s.xLarge,fontWeight:W.BO.semibold}],description:["description",(0,z.$Z)(),(0,z.Ml)(t),{margin:"0 ".concat(rr)}],itemsList:[(0,z.GD)("auto"),{marginTop:"12px",minHeight:o,overflowY:"auto"}],inaccessibleFilesInfo:["inaccessibleFilesInfo",(0,z.$Z)(),(0,z.gS)(),z.cc,{margin:"4px ".concat(rr," 0"),height:ur.n,".countBubble":[(0,z.$Z)(ur.s),(0,z.wA)(t),{marginRight:"10px",lineHeight:ur.s,borderRadius:"50%",textAlign:"center",fontSizes:W.s.small,fontWeight:W.BO.semibold}],".inaccessibleFilesText":[(0,z.GD)("auto"),(0,z.Ml)(t)]}],subComponentStyles:{item:{root:{margin:"0 ".concat(rr)}}}}}));var gr=r(50723),kr=r.n(gr),Cr=r(32520),br=r.n(Cr),Tr=r(19853),Sr=r.n(Tr),vr=r(33411),Pr=r.n(vr),xr=r(27559),yr=r(28730);class fr extends g.${name(){return p.M.MembersList}renderComponent(){let e;this.memberCardFocusElements={},e=this.props.canViewMembers?this.props.canAddMembers?this.renderMembersPeoplePicker():this.renderReadOnlyMembersList():this.renderNoViewMembersPermissionMessage();const t=this.getClassNames(),r=(0,oe.A)("plannerAppCallout",t.root);return k.createElement(Re.P,{id:"membersList",directionalHint:se.A.bottomRightEdge,target:this.props.calloutTarget,onDismiss:this.props.callbacks.dismissMembersCallout,className:r,isBeakVisible:!1,gapSpace:0,ariaLabel:U.p.Strings.MembersList_MembersTitle,role:"complementary",layerProps:{eventBubblingEnabled:!0},onClick:this.stopPropagation,onKeyDown:this.stopPropagation,styles:cr(this.props.theme,this.props.calloutStyles)},k.createElement(Ne.Y,{className:t.sectionsContainer,isClickableOutsideFocusTrap:!0},k.createElement("div",{className:"membersSection"},k.createElement("div",{className:t.membersTitle},U.p.Strings.MembersList_MembersTitle),k.createElement("div",{className:t.membersListContainer},e)),this.renderSharedContainersList()))}renderMembersPeoplePicker(){const e=Pr()(this.getMembersToRender(),(e=>this.getMemberPersonaProps(e))),t=this.getClassNames(),r={loadingText:U.p.Strings.MembersList_LoadingText,noResultsFoundText:U.p.Strings.MembersList_NoResultsFound,onRenderNoResultFound:this.renderNoResultsFound.bind(this),className:t.suggestions,suggestionsItemClassName:t.suggestionsItem};return k.createElement("div",{className:"membersPeoplePicker"},k.createElement(Zt.iG,{onResolveSuggestions:this.onSearchTextChanged.bind(this),onGetMoreResults:this.onSearchTextChanged.bind(this),getTextFromItem:e=>{var t;return null!==(t=e.text)&&void 0!==t?t:""},className:"addMembersPeoplePicker",pickerSuggestionsProps:r,onRenderItem:this.renderMemberItem.bind(this),onChange:this.onUsersChange.bind(this),selectedItems:e,inputProps:{placeholder:U.p.Strings.MembersList_AddMemberPlaceholder,role:"textbox",tabIndex:0},ref:this._peoplePickerRef,resolveDelay:200,onDismiss:e=>{e.defaultPrevented=!0},styles:pr(this.props.theme,this.props.peoplePickerStyles)}))}renderNoResultsFound(e,t){const r=this.getClassNames();return k.createElement("div",{className:r.noSuggestions},U.p.Strings.MembersList_NoResultsFound)}renderReadOnlyMembersList(){let e=!1;this.state.numMembersToRender<this.props.members.length&&(e=!0);const t=k.createElement(k.Fragment,null,Pr()(this.getMembersToRender(),(e=>{var t;return k.createElement("div",{key:e.id,role:"listitem"},k.createElement(Yt,{isEditable:!1,user:e,userPhoto:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,highlightTasks:this.props.callbacks.highlightTasks,onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme}))})));return k.createElement(Gt.R,{className:"readOnlyMembersList",direction:zt.E.vertical,isCircularNavigation:!1,role:"list"},k.createElement(Xt.H,{id:"readOnlyMemberList",hasMoreItemsToRender:e,orientation:Xt.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},t))}onLastMemberVisible(){const e=this.state.numMembersToRender+this.membersPageSize;this.setState({numMembersToRender:e})}getMembersToRender(){return this.memoizeGetMembersToRender(this.props.members,this.state.numMembersToRender)}memoizeGetMembersToRender(e,t){const r=this.prevMembers!==e&&!Sr()(this.prevMembers,e);return r&&(this.sortedMembers=e.slice().sort(((e,t)=>yr.l.compareStringForDisplay(e.displayName,t.displayName))),this.prevMembers=e),(r||this.prevNumMembersToRender!==t)&&(this.renderedMembers=this.sortedMembers.slice(0,t),this.prevNumMembersToRender=t),this.renderedMembers}renderMemberItem(e){const t=!!this.props.canRemoveMembers&&(!!this.props.callbacks.canUserBeRemovedFromGroup&&this.props.callbacks.canUserBeRemovedFromGroup(e.item.id));let r=!1;e.index===this.state.numMembersToRender-1&&(r=!0);const o=k.createElement("div",{key:e.item.id,role:"listitem"},k.createElement(Yt,{isEditable:t,personaProps:e.item,user:this.getMembersToRender()[e.index],highlightTasks:this.props.callbacks.highlightTasks,onRemoveUser:()=>{var t;this.updateFocusOnRemoval(e.item.id),null===(t=e.onRemoveItem)||void 0===t||t.call(e)},onRenderPersona:this.props.callbacks.onRenderPersona,ref:t=>{var r;const o=null===t||void 0===t?void 0:t.getDecoratedComponentInstance();null!==o&&void 0!==o&&null!==(r=o.memberFocusElement)&&void 0!==r&&r.current&&(this.memberCardFocusElements[e.item.id]={element:o.memberFocusElement.current,id:e.item.id})},theme:this.props.theme}));return k.createElement(Xt.H,{id:"memberList",key:"memberListKey".concat(e.item.id),hasMoreItemsToRender:r,orientation:Xt.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},o)}updateFocusOnRemoval(e){xr.n.ChangeFocusBeforeRemovalAlt(this.getMembersToRender(),(()=>{var e,t;return null===(e=this._peoplePickerRef)||void 0===e||null===(e=e.current)||void 0===e||null===(t=e.focusInput)||void 0===t?void 0:t.call(e)}),e,(e=>e.id),(e=>{var t;return null===(t=this.memberCardFocusElements[e.id])||void 0===t?void 0:t.element}))}getMemberPersonaProps(e){var t;return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,size:We.WH.extraSmall}}onSearchTextChanged(e,t){const{getUserWithKeyword:r}=this.props.callbacks;return this.setState({inputText:e}),v()(e)||e.length<m.c9.MinCharsNeededToSearch?[]:r?new Promise(((t,o)=>{r(e).then((e=>{if(v()(e))t([]);else{const r=kr()(e,(e=>!(br()(this.props.members,(t=>t.id===e.id))>-1)&&!(!this.props.canAddGuests&&e.isGuest()))),o=Pr()(r,(e=>this.getMemberPersonaProps(e)));t(o)}}))})):[]}onUsersChange(e){if(this.props.callbacks.addUserCallback){const t=this.props.members;for(let r=0;r<e.length;r++){if(-1===br()(t,(t=>t.id===e[r].id)))return this.logUsage(p.M.AddMember),void this.props.callbacks.addUserCallback(e[r].id)}}if(this.props.callbacks.removeUserCallback){const t=this.getMembersToRender();for(let r=0;r<t.length;r++){if(-1===br()(e,(e=>e.id===t[r].id)))return this.logUsage(p.M.RemoveMember),void this.props.callbacks.removeUserCallback(t[r].id)}}}renderNoViewMembersPermissionMessage(){return k.createElement("div",{className:"noViewMembersPermissionMessage"},U.p.Strings.MembersList_NonPlanMemberMessage)}renderSharedContainersList(){return null==this.props.sharedContainersListProps?null:k.createElement("div",{className:"sharedContainersSection"},k.createElement(mr,{...this.props.sharedContainersListProps,styles:dr()}))}getClassNames(){const{members:e,theme:t,styles:r}=this.props,o=e.length>1;return lr(ir(t,o,r))}constructor(e,t){super(e,t),this._peoplePickerRef=k.createRef(),this.membersPageSize=10,this.prevMembers=[],this.prevNumMembersToRender=0,this.sortedMembers=[],this.renderedMembers=[],this.stopPropagation=e=>{e.stopPropagation()},this.state={inputText:"",numMembersToRender:this.membersPageSize}}}class Dr extends g.${name(){return"HeaderDropdowns"}renderComponent(){const{renderNewFilterMenu:e}=this.props.filtersDropdownProps,t=this.getClassNames();return k.createElement("div",{className:t.root},this.renderContextDropdown(),e?this.renderFiltersDropdown(t):this.renderMembersDropdown(t),e?this.renderGroupByDropdown(t):this.renderFiltersDropdown(t),e?this.renderMembersDropdown(t):this.renderGroupByDropdown(t))}getClassNames(){return we(De(this.props.theme))}renderContextDropdown(){const{contextMenuProps:e,renderContextDropdown:t}=this.props;return t&&null!=e&&null!=e.contextDetails?k.createElement(Me,e):null}renderMembersDropdown(e){const{renderMembersDropdown:t,membersDropdownProps:r}=this.props;return t&&null!=r?k.createElement("button",{className:(0,oe.A)("members passive_2 active_3",e.dropdownMenu),ref:"membersCommandButton",onClick:r.toggleMembersCallout,title:U.p.Strings.PlannerHeader_MembersTooltipText,"aria-expanded":r.isMembersCalloutVisible,"aria-controls":"membersList",id:"plannerHeaderMemberButton"},k.createElement(me.J,null,U.p.Strings.PlannerHeader_MembersDropDownHeaderText),k.createElement("span",{className:e.dropdownIcon},k.createElement(B.I,{...pe.Ju,className:(0,oe.A)(pe.Ju.className,"dropdownChevronIcon")}),k.createElement(B.I,{...pe.BW,className:(0,oe.A)(pe.BW.className,"dropdownHiddenTextIcon")}),r.isMembersCalloutVisible&&this.renderMembersCallout())):null}renderFiltersDropdown(e){const{filtersDropdownProps:t}=this.props;return t.currentTaskFilter?k.createElement("button",{className:(0,oe.A)("filters",e.dropdownMenu),ref:"filterCalloutCommandButton",onClick:this.toggleFilterCallout.bind(this),title:U.p.Strings.PlannerHeader_FiltersTooltipText,"aria-expanded":t.isFilterCalloutVisible,"aria-controls":"taskFilterCallout"},k.createElement(me.J,null,k.createElement("span",null,U.p.Strings.TaskFiltering_FiltersMenuHeaderText),k.createElement("span",null,U.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses),k.createElement("span",{className:"value"},t.currentTaskFilter.filterCount.toString()),k.createElement("span",null,U.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses)),k.createElement("span",{className:e.dropdownIcon},k.createElement(B.I,{...pe.Ju,className:(0,oe.A)(pe.Ju.className,"dropdownChevronIcon")}),k.createElement(B.I,{...pe.ao,className:(0,oe.A)(pe.ao.className,"dropdownHiddenTextIcon")}),t.isFilterCalloutVisible?this.renderTaskFilterMenu():null)):null}renderMembersCallout(){var e,t,r,o,n;const{membersDropdownProps:a,callbacks:s}=this.props;if(null==a)return null;const i=s,l={addUserCallback:i.onAddMember,dismissMembersCallout:a.dismissMembersCallout,getUserWithKeyword:i.getUserWithKeyword,getUserPhoto:i.getUserPhoto,canUserBeRemovedFromGroup:i.canUserBeRemovedFromContainer?i.canUserBeRemovedFromContainer:()=>!1,highlightTasks:i.highlightTasks,onRenderPersona:i.onRenderPersona,removeUserCallback:i.onRemoveMember};return k.createElement(fr,{callbacks:l,calloutTarget:this.refs.membersCommandButton,members:null!==(e=this.props.members)&&void 0!==e?e:[],canAddGuests:null!==(t=a.canUserAddGuests)&&void 0!==t&&t,canViewMembers:null===(r=a.canUserViewMembers)||void 0===r||r,canAddMembers:null!==(o=a.canUserAddMembers)&&void 0!==o&&o,canRemoveMembers:null!==(n=a.canUserRemoveMembers)&&void 0!==n&&n,sharedContainersListProps:a.sharedContainersListProps,theme:this.props.theme})}renderTaskFilterMenu(){const{filtersDropdownProps:e,members:t,callbacks:r,theme:o}=this.props,{currentTaskFilter:n,taskData:a,buckets:s,planCategories:i,filterOptions:l,renderNewFilterMenu:c}=e;if(!n)return null;const p={getUserPhoto:r.getUserPhoto,setTaskFilter:r.setTaskFilter,onDismiss:this.dismissFilterCallout,onRenderPersona:r.onRenderPersona};return c?k.createElement(Wt,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:n,taskData:a,members:null!==t&&void 0!==t?t:[],categories:i,buckets:s,theme:o}):k.createElement(wt,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:n,taskData:a,buckets:s,users:t,categories:i,options:null!==l&&void 0!==l?l:{assignmentFilterOptions:{renderSection:!1},bucketFilterOptions:{renderSection:!1},dueDateFilterOptions:{renderSection:!1,renderSomeDateOption:!1,renderFutureOption:!1,renderLateOption:!1,renderNoDateOption:!1,renderNextWeekOption:!1,renderThisWeekOption:!1,renderTodayOption:!1,renderTomorrowOption:!1},labelFilterOptions:{renderSection:!1},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}},theme:o})}toggleFilterCallout(){this.context.usageLogger.logData(this.name(),"Filter menu selected"),this.props.callbacks.onFilterCalloutVisibleChange(!this.props.filtersDropdownProps.isFilterCalloutVisible)}renderGroupByDropdown(e){const{groupByDropdownProps:t}=this.props;if(!t.taskGroupingOptions||v()(t.taskGroupingOptions)||!t.currentTaskGrouping)return null;const r=ue(t.currentTaskGrouping);return k.createElement("button",{className:(0,oe.A)("groupByMenu",e.dropdownMenu),ref:"groupByMenuCommandButton",onClick:this.toggleGroupByMenu,title:U.p.Strings.HeaderDropdowns_GroupByTooltipText,"aria-expanded":this.state.isGroupByMenuVisible,"aria-controls":"groupByMenu"},k.createElement(me.J,null,k.createElement("span",null,U.p.Strings.HeaderDropdowns_GroupByDropDownHeaderText),t.showGroupByMenuTitleValue?k.createElement("span",{className:"value"},r):null),k.createElement("span",{className:e.dropdownIcon},k.createElement(B.I,{...pe.Ju,className:(0,oe.A)(pe.Ju.className,"dropdownChevronIcon")}),k.createElement(B.I,{...pe.DZ,className:(0,oe.A)(pe.DZ.className,"dropdownHiddenTextIcon")}),this.state.isGroupByMenuVisible?k.createElement(he,{currentTaskGrouping:t.currentTaskGrouping,taskGroupingOptions:t.taskGroupingOptions,targetElement:this.refs.groupByMenuCommandButton,onDismissGroupByMenu:this.dismissGroupByMenu,onGroupByChange:this.props.callbacks.onGroupByChange,theme:this.props.theme}):null))}constructor(e,t){super(e,t),this.dismissFilterCallout=()=>{this.props.callbacks.onFilterCalloutVisibleChange(!1),this.refs.filterCalloutCommandButton.focus()},this.toggleGroupByMenu=()=>{this.setState((e=>({isGroupByMenuVisible:!e.isGroupByMenuVisible})))},this.dismissGroupByMenu=()=>{this.setState((e=>({isGroupByMenuVisible:!1})))},this.state={isGroupByMenuVisible:!1}}}var wr=r(56205),Lr=r(3902);const Br=e=>({root:[(0,z.$Z)("auto"),(0,z.gS)("row","nowrap"),{margin:"0px ".concat((0,X.vb)((0,X.jz)("20px")-((0,X.jz)(K.B.TopHeaderIconHorizontalOffset)+(0,X.jz)(K.B.HeaderDropdownItemSpacing))/2))}],descriptiveOverflowButton:{lineHeight:"normal",backgroundColor:"transparent",".ms-Persona-initials > span":[(0,z.aS)(e),(0,q.M8)()]}});class Er extends g.${name(){return"HeaderFacepile"}renderComponent(){const{members:e,toggleMembersCallout:t,onRenderPersona:r,theme:o}=this.props,n=e.length,a=e.map((e=>this.getFacepileProps(e)));let s="";return Be()(e.slice(0,4),((e,t)=>{s+=e.displayName,t!==n-1&&3!==t&&(s+=U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator)})),k.createElement(Lr.g,{className:"facePileArray",personas:a,maxDisplayablePersonas:4,overflowButtonType:wr.Z.descriptive,overflowButtonProps:{onClick:t,ariaLabel:Ee.G(U.p.Strings.PlannerHeader_OverflowButtonAriaLabel,a.length-4)},onRenderUserPersona:r,ariaLabel:s,customStyles:Br(o)})}getFacepileProps(e){var t;return{personaName:e.formattedDisplayName,imageUrl:null!==(t=this.props.getUserPhoto(e.id))&&void 0!==t?t:void 0,onClick:this.highlightCardsAssignedToUser.bind(this,e.id),data:{user:e}}}highlightCardsAssignedToUser(e){var t,r;null===(t=(r=this.props).highlightTasks)||void 0===t||t.call(r,s.JS.Assignee,e)}constructor(e,t){super(e,t),this.state={}}}var Ar=r(79889),Fr=r.n(Ar),Ir=r(44388);class Mr extends g.${name(){return"Responsive"}componentDidMount(){this.resizeEventGroup.on(window,"resize",Fr()(this.calculateClassName.bind(this))),this.calculateClassName()}componentWillUnmount(){this.resizeEventGroup.off()}renderComponent(){return k.createElement(this.props.elementTagName||"div",{ref:"responsiveContainer"},this.props.children)}calculateClassName(){let e=0,t="";if(null!=this.refs.responsiveContainer){this.isAdditive()&&(t=this.defaultClassName);do{t=this.isAdditive()?(0,oe.A)(t,this.props.sizeClasses[e]):(0,oe.A)(this.defaultClassName,this.props.sizeClasses[e]),this.refs.responsiveContainer.className=t,e++}while(e<this.props.sizeClasses.length&&this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth);this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth&&this.logUsage("ResponsiveTooSmall",{parentSize:this.refs.responsiveContainer.offsetWidth.toString(10),contentSize:this.refs.responsiveContainer.scrollWidth.toString(10)})}}isAdditive(){return this.props.isAdditive||!0}constructor(e,t){if(super(e,t),0===this.props.sizeClasses.length)throw new Error("InvalidArgumentException: sizeClasses must be of length 1 or greater");this.defaultClassName=(0,oe.A)("responsive",this.props.className),this.state={className:this.defaultClassName},this.resizeEventGroup=new Ir.g(this)}}var Nr=r(44433),_r=r(67239),Rr=r(96980);const Ur="12px",Hr="16px",Or=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e),o={root:[e===m.Sx.Dark&&{".ms-Button-icon":{color:Z.z.White}},{".ms-Callout-main":{borderRadius:r?K.B.LoopBorderRadius:"initial"}}],content:[(0,z.gS)("column"),{boxSizing:"border-box",width:"288px",padding:"".concat(Ur," ").concat(Ur," 0 ").concat("28px")}],infoSectionContainer:[(0,z.gS)("column"),{width:"232px",".infoSection":{"> .title":{fontWeight:W.BO.bold,paddingBottom:"12px"},"> .description":{fontSize:W.s.small,fontWeight:W.BO.semilight,paddingBottom:"24px"}}}],closeButtonContainer:{alignSelf:"flex-end",".closeButton":{width:Hr,height:Hr,padding:"0px",".ms-Button-icon":{padding:"0px",margin:"0px"}}}};return(0,W.TW)(o,t)})),Vr=(0,V.J9)((e=>({root:(0,W.Zq)("planInfoCallout",e.root),content:(0,W.Zq)("planInfoCallout-content",e.content),infoSectionContainer:(0,W.Zq)("infoSectionContainer",e.infoSectionContainer),closeButtonContainer:(0,W.Zq)("closeButtonContainer",e.closeButtonContainer)})));class Wr extends g.${name(){return"PlanInfoCallout"}renderComponent(){const e=this.getClassNames();return k.createElement(Re.P,{ariaLabel:U.p.Strings.PlanInfoCallout_CalloutAriaLabel,target:this.props.targetElement,directionalHint:se.A.bottomLeftEdge,className:e.root,setInitialFocus:!0,isBeakVisible:!0,beakWidth:10,onDismiss:this.props.callbacks.onDismiss,gapSpace:5,styles:(0,Mt.df)(this.props.theme)},k.createElement(Ne.Y,{elementToFocusOnDismiss:this.props.targetElement,isClickableOutsideFocusTrap:!0,className:e.content},k.createElement("div",{className:e.closeButtonContainer},k.createElement(_r.K,{className:(0,oe.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:pe.s5,title:U.p.Strings.PlanInfoCallout_CloseButtonText,ariaLabel:U.p.Strings.PlanInfoCallout_CloseButtonAriaLabel,onClick:this.props.callbacks.onDismiss,plannerTheme:this.props.theme})),k.createElement("div",{className:e.infoSectionContainer},this.renderPrivacySection(),this.renderClassificationSection(),this.renderSensitivitySection(),this.renderHasGuestsSection())))}renderPrivacySection(){const e=this.props.visibility===T.X.Public?U.p.Strings.PlanCreateEditor_VisibilityMode_Public:this.props.hasSharedContainers?U.p.Strings.Plan_Group_PrivacyText_WithSharedContainers:U.p.Strings.PlanCreateEditor_VisibilityMode_Private;return k.createElement(Rr.K,{title:U.p.Strings.PlanInfoCallout_PrivacyTitle,description:e})}renderClassificationSection(){return!this.props.classification||this.props.sensitivity?null:k.createElement(Rr.K,{title:U.p.Strings.PlanInfoCallout_ClassificationTitle,description:this.props.classification})}renderSensitivitySection(){return this.props.sensitivity?k.createElement(Rr.K,{title:U.p.Strings.PlanInfoCallout_SensitivityTitle,description:this.props.sensitivity}):null}renderHasGuestsSection(){return this.props.hasGuests?k.createElement(Rr.K,{title:U.p.Strings.PlanInfoCallout_GuestsTitle,description:U.p.Strings.PlanInfoCallout_HasGuestsText}):null}getClassNames(){return Vr(Or(this.props.theme,this.props.styles))}constructor(e,t){super(e,t)}}var Gr=r(94283);const zr="48px",Zr="19px",Kr=(0,V.J9)((e=>{const t=ze.d.isLoopTheme(e);return{root:[(0,z.$Z)(zr),{position:"relative",margin:"".concat("5px"," ").concat(K.B.TopHeaderHorizontalPadding," 0px"),"> .icon":[(0,z.gS)(),z.cc,(0,z.$Z)(zr),(0,q.kE)(),{height:zr,width:zr,borderRadius:t&&"4px","&.circular":{borderRadius:"50%"}}],".icontext":{fontSize:"17px",fontWeight:"300",color:Z.z.White,textAlign:"center"}}],badge:[(0,z.gS)(),z.cc,{backgroundColor:Z.z.White,position:"absolute",top:(0,X.vb)((0,X.jz)(zr)-(0,X.jz)(Zr)/2),right:(0,X.vb)(0-(0,X.jz)(Zr)/2),borderRadius:"50%",height:Zr,width:Zr,".badgeContainer":[z.xK,(0,z.gS)(),z.cc,{cursor:"pointer"}]}]}})),qr=(0,V.J9)((e=>({root:(0,W.Zq)("primaryIconSection",e.root),badge:(0,W.Zq)("primaryIconBadge",e.badge)})));var Jr=r(36060),jr=r(27678),$r=r(44535);class Yr extends g.${name(){return"HeaderIcon"}renderComponent(){const{badgeIconAriaLabel:e,imageSource:t,isIconCircular:r,titleText:o}=this.props,n=this.getClassNames();let a;const s=null!==e&&void 0!==e?e:"";if(t){const e=(0,oe.A)("icon",{circular:null!==r&&void 0!==r&&r});a=k.createElement("img",{src:t,className:e,tabIndex:s?0:-1,alt:s,title:s})}else{const e=(0,Jr.K)((0,jr.wV)(o)),t=(0,oe.A)("icon",e,{circular:null!==r&&void 0!==r&&r});a=k.createElement("div",{className:t,tabIndex:s?0:-1,"aria-label":s,title:s},k.createElement("div",{className:"icontext"},$r.$.parseInitialsFromName(o)))}return k.createElement("div",{className:n.root},a,this.renderBadge(n))}getClassNames(){return qr(Kr(this.props.theme))}renderPlanInfoCallout(){const{hasSharedContainers:e,sensitivityLabels:t,planMembers:r,planContainer:o,theme:n}=this.props,a={onDismiss:this.dismissPlanInfoCallout};let s=!1;if(r)for(let l=0;l<r.length;l++)if(r[l].isGuest()){s=!0;break}const i=null===o||void 0===o?void 0:o.unifiedGroup;return k.createElement(Wr,{callbacks:a,visibility:null===i||void 0===i?void 0:i.visibility,classification:null===i||void 0===i?void 0:i.classification,sensitivity:i?Gr.k.getFullSensitivityTitle(i.assignedSensitivityLabelId,null!==t&&void 0!==t?t:null):"",targetElement:this.infoCalloutCommandButton,hasGuests:s,hasSharedContainers:e,theme:n})}constructor(e,t){super(e,t),this.renderBadge=e=>this.props.hideBadgeIcon?null:k.createElement("div",{className:e.badge},k.createElement("button",{className:"badgeContainer",tabIndex:0,onClick:this.togglePlanInfoCallout,ref:e=>this.infoCalloutCommandButton=e,"aria-label":U.p.Strings.PlanHeader_PlanInfoBadgeIconAriaLabel,"aria-haspopup":!0},k.createElement(B.I,pe.DA),this.state.isPlanInfoCalloutVisible?this.renderPlanInfoCallout():null)),this.togglePlanInfoCallout=()=>{this.state.isPlanInfoCalloutVisible||this.logUsage("ViewPlanInfoCallout"),this.setState((e=>({isPlanInfoCalloutVisible:!e.isPlanInfoCalloutVisible})))},this.dismissPlanInfoCallout=()=>{this.setState((e=>({isPlanInfoCalloutVisible:!1})))},this.state={isPlanInfoCalloutVisible:!1}}}var Xr=r(62264);const Qr=r.p+"static/media/planner.ada07f52318c532dc0d7d68dc36a9b7c.svg",eo=(0,V.J9)((()=>({hidePersonas:{".facePileArray, .joinUnifiedGroup":{display:"none"},".rightAlignedSection":[(0,z.$Z)(),{flexGrow:1,justifyContent:"flex-end"}],".secondarySection":[(0,z.GD)("auto"),{flexShrink:0}],".dropdowns":{margin:"0px"}},hidePivotText:{".pivotsSection > .removable > .pivotLink":{"> *:not(.icon)":{display:"none"},"> .icon":{display:"inline"}}},hideTitle:{".nonIcon > * > .primarySection":{display:"none"}},hideDropdownText:{".dropdownMenu":{margin:"0px ".concat((0,X.vb)((0,X.jz)(K.B.HeaderDropdownItemSpacing)/2)),"> *":{margin:"0px"},"> label":{display:"none"},".dropDownIcon":{"> .dropdownChevronIcon":{display:"none"},"> .dropdownHiddenTextIcon":{display:"inline"}},".plannerDiamond svg":{transform:"scale(1)"}}}}))),to=(0,V.J9)((e=>({hidePersonas:(0,W.Zq)("hidePersonas",e.hidePersonas),hidePivotText:(0,W.Zq)("hidePivotText",e.hidePivotText),hideTitle:(0,W.Zq)("hideTitle",e.hideTitle),hideDropdownText:(0,W.Zq)("hideDropdownText",e.hideDropdownText)})));var ro=r(98990),oo=r.n(ro),no=r(80493),ao=r(74844),so=r(33268);class io extends w{name(){return"PlanHeader"}getClassNames(){return $(j(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return to(eo())}renderComponent(){const{callbacks:e,disableMode:t,flights:r,plan:o,planContainer:n,hideFavoriteButton:a}=this.props,s=this.getClassNames(),i=this.renderPrimaryIconSection(),l=this.renderPrimaryTextSection(),c=r.EnableDocumentTasks&&(null===n||void 0===n?void 0:n.containerType)===C.K.DriveItem&&null!==e.getBreadcrumbUrl(null===n||void 0===n?void 0:n.externalId)?this.renderSecondaryIconSection():null,p=a||t===f.DisableAll?null:this.renderToggleFavoriteButton(),d=this.renderPivotsSection(s),u=this.renderRightSection(s),h=this.renderBreadcrumbSection(),g=this.renderLinkedSection(s);let b="";const T=this.getBreadcrumbItemsInfo();b=v()(T)?this.fallbackContextInfoProvider():T.map((e=>e.text)).join();const S=this.getResponsiveHeaderClassNames(),P=["",S.hidePersonas,S.hideTitle,S.hidePivotText,S.hideDropdownText];this.props.isSlimView&&P.push("slimView");const x=this.props.hideTitleSection?null:k.createElement("div",{className:s.primarySection,tabIndex:0,"aria-label":Ee.G(U.p.Strings.PlannerHeader_PrimarySectionAriaLabel,this.props.plan.title,b)},k.createElement("div",{className:s.primaryTextSectionContainer},l,p,c),k.createElement("div",{className:s.contextInfoSectionContainer},k.createElement("div",{className:"contextInfoSection"},h),g));return k.createElement(F.$,{planContainerId:o.id,onRender:e.onRenderPlanPhoto},k.createElement(Mr,{sizeClasses:P,isAdditive:!0,className:s.root},k.createElement(Nr.H,{className:s.topHeaderLandmark,role:"banner","aria-label":U.p.Strings.PlannerHeader_TopHeaderLandmarkAriaLabel},i,k.createElement("div",{className:s.nonIcon},k.createElement("div",null,this.renderAppLogo(),x,k.createElement("div",{className:s.secondarySection},d),u)),this.props.children)),this.state.workloadNameToShowInMissingWorkloadErrorDialog&&k.createElement(H,{dialogClassName:"workloadErrorDialog",dialogContainerClassName:m.bI,dialogContentClassName:m.vt,workloadName:this.state.workloadNameToShowInMissingWorkloadErrorDialog,onDismiss:this.closeWorkloadErrorDialog.bind(this),theme:this.props.theme}))}renderPrimaryIconSection(){var e,t,r,o,n;return this.props.hideTitleSection?null:k.createElement(Yr,{hideBadgeIcon:this.props.hideBadgeIcon,badgeIconAriaLabel:null===(e=(t=this.props.callbacks).getBadgeIconAriaLabel)||void 0===e?void 0:e.call(t),imageSource:this.props.imageSource,isIconCircular:this.props.isIconCircular,titleText:this.props.plan.title,planMembers:null!==(r=this.props.planMembers)&&void 0!==r?r:[],planContainer:null!==(o=this.props.planContainer)&&void 0!==o?o:null,sensitivityLabels:null!==(n=this.props.sensitivityLabels)&&void 0!==n?n:null,hasSharedContainers:this.props.plan.sharedWithContainers.length>0,theme:this.props.theme})}renderAppLogo(){return this.props.showAppLogo?k.createElement("div",{className:this.getClassNames().appLogo},k.createElement("img",{src:Qr,alt:"",role:"presentation"})):null}renderToggleFavoriteButton(){const{isCurrentPlanFavorite:e,theme:t}=this.props,r=e?pe.z$:pe.XR,o=e?U.p.Strings.PlanHeader_PlanHeaderRemovePinned:U.p.Strings.PlanHeader_PlanHeaderAddPinned;return k.createElement(_r.K,{onClick:this.toggleFavoriteButtonClick,className:"toggleFavoriteIcon",iconProps:r,title:o,ariaLabel:o,plannerTheme:t})}renderPrimaryTextSection(){const{hideTitleSection:e,plan:t}=this.props;if(e)return null;const r=t.title;return k.createElement(Xr.g,{onClickTitleButton:this.props.callbacks.onClickTitleButton,titleButtonAriaLabel:Ee.G(U.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,r),titleText:r,theme:this.props.theme})}renderBreadcrumbSection(){const{contextDropdownProps:e,hideBreadcrumbMenu:t}=this.props;if(t||e&&e.visibleContextKeys.length>0)return null;const r=this.getBreadcrumbItemsInfo();if(v()(r))return k.createElement("div",{className:"fallbackContextInfoText"},this.fallbackContextInfoProvider());const o=null!==e&&void 0!==e&&e.visibleContextKeys&&e.visibleContextKeys.length>0?1:void 0;return k.createElement(L.Q,{items:null!==r&&void 0!==r?r:[],className:"headerBreadCrumb",maxDisplayedItems:o,overflowAriaLabel:U.p.Strings.PlanHeader_BreadcrumbButtonOverflowAriaLabel,role:void 0,styles:Y(this.props.theme)})}renderLinkedSection(e){const{contextDropdownProps:t,theme:r}=this.props;if(t&&t.visibleContextKeys.length>0){const o=k.createElement("span",{title:U.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel},U.p.Strings.PlanContextLinking_LinkedPlanBreadCrumbText),n=this.renderDelinkSection();return k.createElement(Me,{...t,className:e.linkedBadgeDropdown,isBeakVisible:!0,onRenderLabel:t=>k.createElement("div",{className:e.linkedBadgeItem},o,n),theme:r})}return null}renderDelinkSection(){const{contextDropdownProps:e}=this.props;if(e&&e.visibleContextKeys.length>0){const t=e.contextDetails;if(!t)return null;if(null!=oo()(t,(e=>e.status===Fe.$.Delinked)))return k.createElement("div",{className:"delinkIcon"},k.createElement(B.I,pe.Zl),k.createElement(B.I,pe.aA))}return null}renderSecondaryIconSection(){const e=U.p.Strings.PlanHeader_OpenDocumentInNewWindow;return k.createElement("button",{className:"secondaryIconSection",onClick:()=>{this.openOriginalDocument(this.props.plan)},"aria-label":e,title:e},k.createElement(B.I,pe.XL))}renderPivotsSection(e){const{hidePlanNavLinks:t}=this.props;return t?null:k.createElement("div",{className:e.pivotsSection},k.createElement(ae,{pivotLinks:this.getPrimaryPagePivotLinksInfo(),selectedPivotLinkIndex:this.findSelectedIndex(),onSelectPivotLink:this.onClickHeaderPivotLink,renderTeamsPivotSection:this.props.renderTeamsPivotSection,theme:this.props.theme}),!this.props.renderTeamsPivotSection&&k.createElement(de,{moreOptionsContextMenuItems:this.getSecondaryLinksContextMenuInfo(),onOpenLinksContextMenu:this.props.callbacks.onOpenLinksContextMenu,moreOptionsTooltip:U.p.Strings.PlanHeader_MoreText,theme:this.props.theme,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef}))}renderRightSection(e){const{planContainer:t,containerPermissions:r,userPermissions:o}=this.props;let n=!1;if((null===t||void 0===t?void 0:t.containerType)===C.K.Group){const e=t;n=null!=e.unifiedGroupDetails&&e.unifiedGroup.visibility===T.X.Public}const a=!this.isUserCurrentGroupMembership()&&n&&k.createElement("div",{className:"joinUnifiedGroup"},k.createElement(E.j,{className:"joinUnifiedGroupButton",onClick:this.props.callbacks.joinGroup.bind(this)},U.p.Strings.PlannerHeader_JoinUnifiedGroupButtonLabel)),s=null!=this.props.planMembers&&!this.props.hideMembers,i={assignmentFilterOptions:{renderSection:!0},bucketFilterOptions:{renderSection:!v()(this.props.planBuckets)},dueDateFilterOptions:{renderSection:!0,renderFutureOption:!0,renderLateOption:!0,renderNextWeekOption:!0,renderThisWeekOption:!0,renderTodayOption:!0,renderTomorrowOption:!0,renderNoDateOption:!0,renderSomeDateOption:!1},labelFilterOptions:{renderSection:!0},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}};return k.createElement("div",{className:e.rightAlignedSection},a,s&&this.renderFacepile(),k.createElement(Dr,{renderContextDropdown:!0,renderMembersDropdown:s,contextMenuProps:this.props.contextDropdownProps,membersDropdownProps:{canUserAddGuests:null===o||void 0===o?void 0:o.canAddGuests,canUserViewMembers:null===r||void 0===r?void 0:r.canViewMembers,canUserAddMembers:null===r||void 0===r?void 0:r.canAddMembers,canUserRemoveMembers:null===r||void 0===r?void 0:r.canRemoveMembers,sharedContainersListProps:this.props.sharedContainersListProps,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{currentTaskFilter:this.props.currentTaskFilter,filterOptions:i,isFilterCalloutVisible:this.props.isFilterCalloutVisible,taskData:this.props.taskData,buckets:this.props.planBuckets,planCategories:this.props.planCategories},groupByDropdownProps:{showGroupByMenuTitleValue:this.props.showGroupByMenuTitleValue,currentTaskGrouping:this.props.currentTaskGrouping,taskGroupingOptions:this.props.taskGroupingOptions},members:this.props.planMembers,callbacks:this.props.callbacks,theme:this.props.theme}),this.renderAppMoreOptionsButton())}renderFacepile(){const{callbacks:e,planMembers:t}=this.props;return null==t||v()(t)?null:k.createElement(Er,{members:t,getUserPhoto:e.getUserPhoto,toggleMembersCallout:this.toggleMembersCallout,onRenderPersona:e.onRenderPersona,highlightTasks:e.highlightTasks,theme:this.props.theme})}renderAppMoreOptionsButton(){if(null==this.props.callbacks.openAppAboutDialog)return null;const e=k.createElement(ie.l,{appTheme:this.props.theme,items:[{key:"about",name:U.p.Strings.SharedComponents_TeamsHeader_About,onClick:this.props.callbacks.openAppAboutDialog}],target:this.moreButtonRef,onDismiss:this.closeAppMoreOptionsContextMenu});return k.createElement("div",{className:this.getClassNames().appMoreOptionsButton},k.createElement(_r.K,{plannerTheme:this.props.theme,elementRef:this.moreButtonRef,iconProps:pe.XP,onClick:this.toggleAppMoreOptionsContextMenu,title:U.p.Strings.SharedComponents_MoreButtonTooltipText,ariaLabel:U.p.Strings.SharedComponents_MoreButtonTooltipText}),this.state.isAppMoreOptionsContextMenuVisible&&e)}getPrimaryPagePivotLinksInfo(){const{isTimelineVisible:e,showGoToProject:t}=this.props,r=[];return r.push({id:i.EC.PlanGrid,name:U.p.Strings.SharedComponents_PlanGridPageName,iconProps:pe.Dz}),r.push({id:i.EC.PlanTaskboard,name:U.p.Strings.SharedComponents_PlanTaskboardPageName,iconProps:pe.fD}),r.push({id:i.EC.PlanCharts,name:U.p.Strings.SharedComponents_PlanChartsPageName,iconProps:pe.V1}),r.push({id:i.EC.PlanSchedule,name:U.p.Strings.SharedComponents_PlanSchedulePageName,iconProps:pe.cx}),e&&r.push({id:i.EC.PlanTimeline,name:t?U.p.Strings.SharedComponents_PlanProjectPageName:U.p.Strings.SharedComponents_PlanTimelinePageName,iconProps:pe.aM,alwaysShowIcon:!0}),r}getSpoWorkloadUrl(e,t){const{sharepointDomainUrl:r}=this.props;return Ee.G(s.Lf.SharepointWorkloadUrlFormat,r,e,t)}getSecondaryLinksContextMenuInfo(){const{callbacks:e,disableMode:t,flights:r,isCurrentPlanFavorite:i,plan:l,planContainer:p,planMembers:d,sharepointDomainUrl:u,hasAccessViaSharedContainer:m,showCopyPlanToProjectLink:g}=this.props;if(this.props.hideSecondaryLinksContextMenu||null==p||h.B.clientType===c.s.SharepointApp)return[];const k=[];if(t!==f.DisableAll&&null!=l&&p.containerType===C.K.User){const e=a.getLinksCapabilitiesForPlan(p,d.length,l.container.containerType,m);if(y(e,n.EnableFavorite)){const e=i?U.p.Strings.PlanHeader_PlanHeaderRemovePinned:U.p.Strings.PlanHeader_PlanHeaderAddPinned;k.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}return y(e,n.EnableCopyLink)&&k.push({key:"copyLinkToPlan",name:U.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),y(e,n.EnableSettings)&&t===f.DisableNothing&&k.push({key:"PlanSettings",name:U.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e;return this.openPlanSettingsPanel(l.id,null!==(e=this.headerMoreOptionsButtonRef.current)&&void 0!==e?e:void 0)}}),k}const b=a.getLinksCapabilitiesForContainer(p);if(x(b,o.EnableYammer)&&k.push({key:"Yammer",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadYammer,onClick:this.handleWorkloadNavigation.bind(this,_.P[_.P.Yammer])}),x(b,o.EnableConversations)&&k.push({key:"Conversations",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadConversation,onClick:()=>{u?this.openLink(this.getSpoWorkloadUrl(p.externalId,_.P[_.P.Conversations]),"navigateToWorkloadConversations"):(this.context.traceLogger.logTrace(508036125,ao.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(_.P[_.P.Conversations]))}}),x(b,o.EnableMembers)&&k.push({key:"Members",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadMembers,onClick:()=>{u?this.openLink(this.getSpoWorkloadUrl(p.externalId,"Members"),"navigateToWorkloadPeople"):(this.context.traceLogger.logTrace(508036124,ao.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(_.P[_.P.People]))}}),x(b,o.EnableFiles)&&k.push({key:"Files",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadFiles,onClick:()=>{u?this.openLink(this.getSpoWorkloadUrl(p.externalId,_.P[_.P.Documents]),"navigateToWorkloadDocuments"):this.handleWorkloadNavigation(_.P[_.P.Documents])}}),x(b,o.EnableNotebook)&&k.push({key:"Notebook",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadNotebook,onClick:()=>{u?this.openLink(this.getSpoWorkloadUrl(p.externalId,_.P[_.P.Notebook]),"navigateToWorkloadNotebook"):this.handleWorkloadNavigation(_.P[_.P.Notebook])}}),x(b,o.EnableSites)&&k.push({key:"Sites",name:U.p.Strings.PlanHeader_PlanHeaderWorkloadSites,onClick:()=>{this.openLink(Ee.G(s.Lf.SharepointSiteUrlFormat,u,null===p||void 0===p?void 0:p.externalId),"navigateToWorkloadSites")}}),v()(k)||k.push({key:"divider_1",name:"-",itemType:A.G.Divider}),t!==f.DisableAll&&null!=l){const o=a.getLinksCapabilitiesForPlan(p,d.length,l.container.containerType,m);if(y(o,n.EnableFavorite)){const e=i?U.p.Strings.PlanHeader_PlanHeaderRemovePinned:U.p.Strings.PlanHeader_PlanHeaderAddPinned;k.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}if(y(o,n.EnableCopy)&&null!=e.onClickCopyPlan&&t===f.DisableNothing&&k.push({key:"CopyPlan",name:U.p.Strings.PlanHeader_CopyPlanText,onClick:()=>e.onClickCopyPlan(l.id)}),g&&k.push({key:"CopyPlanToProject",name:U.p.Strings.PlanHeader_CopyPlanToProjectText,onClick:()=>this.openLink((0,so.lo)(l.id),"navigateToImportPlanInProject")}),y(o,n.EnableExport)&&this.showExportPlanToExcel()&&k.push({key:"ExportPlanToExcel",name:U.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,onClick:()=>e.onClickExportPlanToExcel(l.id)}),y(o,n.EnableCopyLink)&&k.push({key:"copyLinkToPlan",name:U.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),y(o,n.EnableSettings)&&t===f.DisableNothing&&k.push({key:"PlanSettings",name:U.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e;return this.openPlanSettingsPanel(l.id,null!==(e=this.headerMoreOptionsButtonRef.current)&&void 0!==e?e:void 0)}}),y(o,n.EnableCalendar)&&null!=r&&r.ICalendar){const e=this.getCalendarLink();null!=e&&k.push(e)}y(o,n.EnableLeave)&&k.push({key:"LeavePlan",name:U.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>this.openLeavePlanDialog(l.id)}),y(o,n.EnableJoin)&&k.push({key:"Join",name:U.p.Strings.PlanHeader_PlanHeaderJoin,onClick:e.joinGroup.bind(this)})}return k}getCalendarLink(){const{callbacks:e,plan:t,planContainer:r,planDetails:o,userOutlookCalendarUrlToPublishTasks:n}=this.props;let a=null;return(null===r||void 0===r?void 0:r.containerType)===C.K.Group&&(a=r.unifiedGroupDetails)?(null===(s=a)||void 0===s?void 0:s.currentUserRelationToGroup)===b.N.Owner?{key:"AddPlanToCalendar",name:U.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)}:o&&(null===(i=a)||void 0===i?void 0:i.currentUserRelationToGroup)===b.N.Member&&o.iCalendarPublishEnabled&&n?{key:"AddPlanToCalendar",name:U.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:()=>{this.context.usageLogger.logData("PlanHeader","publishPlanTasksToOutlookCalendar ",{planID:t.id}),no.b.safelyOpenExternalUrl(n,"_blank")}}:null:{key:"AddPlanToCalendar",name:U.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)};var s,i}togglePlanFavorite(){const{callbacks:e,isCurrentPlanFavorite:t}=this.props;this.logUsage(t?p.M.RemoveFromFavorite:p.M.AddToFavorite),e.updatePlanFavoriteStatus(!t)}getBreadcrumbItemsInfo(){var e;const{callbacks:t,flights:r,plan:o,planContainer:n}=this.props,a=(0,P.g)(o.contexts);if((null===n||void 0===n?void 0:n.containerType)!==C.K.DriveItem&&v()(a))return;const s=null!==(e=null===n||void 0===n?void 0:n.displayName)&&void 0!==e?e:"",i=[];if(r.EnableDocumentTasks&&(null===n||void 0===n?void 0:n.containerType)===C.K.DriveItem&&null!==t.getBreadcrumbUrl(null===n||void 0===n?void 0:n.externalId))i.push({key:"DocPlanBreadcrumb",text:o.title,onClick:()=>this.openOriginalDocument(o)});else if(null!=a){const e=o.contexts[a],t=(0,Ie.e)(e,s);Be()(t,((e,t)=>{i.push({key:e+t,text:e})}))}return i}findSelectedIndex(){const e=this;return br()(this.getPrimaryPagePivotLinksInfo(),(t=>t.id===e.props.currentPage))}isUserCurrentGroupMembership(){const{planContainer:e}=this.props;if((null===e||void 0===e?void 0:e.containerType)!==C.K.Group)return!1;const t=e;return!(!t.unifiedGroup||!t.unifiedGroupDetails)&&t.unifiedGroupDetails.currentUserRelationToGroup!==b.N.NonMember}handleWorkloadNavigation(e){var t,r;if((null===(t=this.props.planContainer)||void 0===t?void 0:t.containerType)!==C.K.Group)return;const o=null===(r=this.props.planContainer.unifiedGroupDetails)||void 0===r?void 0:r.getWorkloadUrl(e);this.context.traceLogger.logTrace(508036123,ao.k.Info,"Workload navigation [Name=".concat(e,"][HasUrl=").concat(!!o,"]")),o?this.openLink(o,"navigateToWorkload"+e):this.showWorkloadErrorDialog(e)}openLink(e,t){this.logUsage(t),no.b.safelyOpenExternalUrl(e,"_blank")}openOriginalDocument(e){const t=this.props.callbacks.getBreadcrumbUrl(e.container.externalId);return t&&this.openLink(t,"openOriginalDocument")}showWorkloadErrorDialog(e){this.setState((t=>({workloadNameToShowInMissingWorkloadErrorDialog:e})))}closeWorkloadErrorDialog(){this.setState((e=>({workloadNameToShowInMissingWorkloadErrorDialog:null})))}onClickCopyLinkToPlan(){const{callbacks:e,plan:t}=this.props,r={planId:t.id};this.logUsage("copyPlanLinkPlanHeader",r),e.copyLinkToPlan(t.id)}showExportPlanToExcel(){const{callbacks:e,disableMode:t}=this.props,r=t===f.DisableNothing,o=null!=e.onClickExportPlanToExcel;return r&&o}constructor(e,t){super(e,t),this.moreButtonRef=k.createRef(),this.fallbackContextInfoProvider=()=>{const{planContainer:e,sensitivityLabels:t}=this.props;let r="";if((null===e||void 0===e?void 0:e.containerType)===C.K.Group){const o=e;o.unifiedGroup&&(r=o.unifiedGroup.getDetailedInfo(t))}return r},this.toggleFavoriteButtonClick=()=>{this.logUsage(this.props.isCurrentPlanFavorite?p.M.RemoveFromFavorite:p.M.AddToFavorite),this.togglePlanFavorite()},this.dismissMembersCallout=()=>{this.setState((e=>({isMembersCalloutVisible:!1})))},this.toggleMembersCallout=()=>{this.setState((e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}}))},this.toggleAppMoreOptionsContextMenu=()=>{this.setState((e=>({isAppMoreOptionsContextMenuVisible:!e.isAppMoreOptionsContextMenuVisible})))},this.closeAppMoreOptionsContextMenu=()=>{this.setState({isAppMoreOptionsContextMenuVisible:!1})},this.onClickHeaderPivotLink=e=>{const{callbacks:t}=this.props;switch(this.logUsage(e.id+"Clicked"),e.id){case i.EC.PlanTaskboard:t.navigateToPage(i.EC.PlanTaskboard);break;case i.EC.PlanCharts:t.navigateToPage(i.EC.PlanCharts);break;case i.EC.PlanSchedule:t.navigateToPage(i.EC.PlanSchedule);break;case i.EC.PlanGrid:t.navigateToPage(i.EC.PlanGrid);break;case i.EC.PlanTimeline:this.logUsage(p.M.PlanTimelineViewClicked),t.navigateToPage(i.EC.PlanTimeline)}},this.state={workloadNameToShowInMissingWorkloadErrorDialog:null,isMembersCalloutVisible:!1,isAppMoreOptionsContextMenuVisible:!1}}}var lo=r(40488),co=r(57433),po=r(11660),uo=r(48709);const ho=(0,V.J9)((e=>{let t="";switch(e){case m.Sx.Dark:t=Z.z.NeutralPrimaryAlt;break;case m.Sx.Light:t=Z.z.NeutralLighter;break;case m.Sx.TeamsLight:t=Z.z.White;break;case m.Sx.TeamsDark:t=Z.z.Black;break;case m.Sx.TeamsContrast:t=uo.kd.gray150}return{backgroundColor:t}})),mo=(0,V.J9)((e=>{let t="";switch(e){case m.Sx.Dark:t=Z.z.FontColorThemeLight;break;case m.Sx.Light:case m.Sx.TeamsLight:t=Z.z.FontColorThemeDark;break;case m.Sx.SharePoint:t=Z.z.SharepointButtonHoverColor();break;case m.Sx.TeamsDark:case m.Sx.TeamsContrast:t=Z.z.White}return{color:t}})),go=(0,V.J9)(((e,t)=>({root:[(0,z.gS)("row","nowrap"),{position:"relative"},e===m.Sx.TeamsLight&&{background:t?K.B.HeaderlessTeamsBackgroundColor:Z.z.TeamsLightBackgroundColor},e===m.Sx.TeamsDark&&{background:Z.z.TeamsDarkBackgroundColor},e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black},e===m.Sx.SharePoint&&{background:Z.z.SharepointBackgroundColor()}],background:[(0,z.GD)(),(0,z.gS)("row","nowrap"),z.cc],columns:[(0,z.gS)("row","nowrap"),(0,z.$Z)(),{alignItems:"flex-start"}],column:[(0,z.GD)("276px"),(0,z.gS)("column","nowrap"),{alignItems:"stretch",width:"276px",margin:"0px 15px"}],addTaskButtonShadow:[ho(e),e===m.Sx.SharePoint&&{border:"1px solid "+Z.z.SharepointTextFontColor()},{marginBottom:"15px",height:"40px"}],taskCardShadow:[ho(e),e===m.Sx.SharePoint&&{border:"1px solid "+Z.z.SharepointTextFontColor()},{marginTop:"7px",height:"98px"}],foreground:[(0,z.gS)("column","nowrap"),z.cc,{position:"absolute",top:0,left:0,right:0,bottom:0}],mainText:[mo(e),{fontSize:W.s.xxLarge,fontWeight:W.BO.semibold,marginBottom:"7px"}],subText:[mo(e),{fontSize:W.s.mediumPlus,fontWeight:W.BO.semibold,marginBottom:"10px"}]}))),ko=(0,V.J9)(((e,t)=>{const r=go(e,t);return{root:(0,W.Zq)("planCreationInProgressView",r.root),background:(0,W.Zq)("background",r.background),columns:(0,W.Zq)("columns",r.columns),column:(0,W.Zq)("column",r.column),addTaskButtonShadow:(0,W.Zq)("addTaskButtonShadow",r.addTaskButtonShadow),taskCardShadow:(0,W.Zq)("taskCardShadow",r.taskCardShadow),foreground:(0,W.Zq)("foreground",r.foreground),mainText:(0,W.Zq)("mainText",r.mainText),subText:(0,W.Zq)("subText",r.subText)}}));class Co extends g.${name(){return"PlanCreationInProgressView"}renderComponent(){const e=this.getClassNames();return k.createElement("div",{className:e.root},k.createElement("div",{className:e.background},k.createElement("div",{className:e.columns},k.createElement("div",{className:e.column},k.createElement("div",{className:e.addTaskButtonShadow}),k.createElement("div",{className:e.taskCardShadow})),k.createElement("div",{className:e.column},k.createElement("div",{className:e.addTaskButtonShadow}),k.createElement("div",{className:e.taskCardShadow}),k.createElement("div",{className:e.taskCardShadow}),k.createElement("div",{className:e.taskCardShadow})),k.createElement("div",{className:e.column},k.createElement("div",{className:e.addTaskButtonShadow}),k.createElement("div",{className:e.taskCardShadow}),k.createElement("div",{className:e.taskCardShadow})))),k.createElement("div",{className:e.foreground},k.createElement("div",{className:e.mainText},U.p.Strings.PlanCreationInProgressView_MainText),k.createElement("div",{className:e.subText},U.p.Strings.PlanCreationInProgressView_SubText),k.createElement(E.j,{className:"redirectButton",onClick:()=>this.props.onClickNavigateToHub()},U.p.Strings.PlanCreationInProgressView_ReturnToHubButtonText)))}getClassNames(){const{theme:e}=this.props;return ko(e,h.B.headerlessMode)}constructor(e,t){super(e,t)}}class bo extends g.${name(){return"PlaceholderHeader"}renderComponent(){const e=this.getResponsiveHeaderClassNames(),t=["",e.hidePersonas,e.hideTitle,e.hidePivotText,e.hideDropdownText];return k.createElement(Mr,{sizeClasses:t,isAdditive:!0,className:this.getClassNames().root})}getClassNames(){return $(j(this.props.theme,this.props.topHeaderStyles))}getResponsiveHeaderClassNames(){return to(eo())}constructor(e,t){super(e,t)}}var To=r(80708),So=r(56128),vo=r(42870),Po=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),xo=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.perfActionCreator=o.props.perfActionCreator,o.pageReadyActionDispatched=!1,o.dataFetchStartTime=(new Date).getTime(),o}return Po(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.trySendPageReadyAction()},t.prototype.componentDidUpdate=function(t,r){e.prototype.componentDidUpdate.call(this,t,r),this.setTitle()},t.prototype.storeDidUpdate=function(){e.prototype.storeDidUpdate.call(this),this.trySendPageReadyAction()},t.prototype.getPageReadyExportName=function(){},t.prototype.getPageTitle=function(){return""},t.prototype.getPageReadyMetaTag=function(){},t.prototype.getPageReadyLoggingData=function(){},t.prototype.setTitle=function(){var e=this.getPageTitle();e&&(document.title=e)},t.prototype.trySendPageReadyAction=function(){!1===this.pageReadyActionDispatched&&this.checkForCriticalDataReady()&&(this.pageReadyActionDispatched=!0,this.perfActionCreator.pageReady(this.dataFetchStartTime,(new Date).getTime(),this.getPageReadyExportName(),this.getPageReadyMetaTag(),this.getPageReadyLoggingData()))},t}(vo.M),yo=r(56953);class fo extends xo{logUsage(e,t,r){this.props.loggers.usageLogger.logData(this.name(),e,t,r)}logError(e,t,r){yo.v.logError(e,t,r,this.props.loggers.logHandler)}storeDidUpdate(){Fr()(super.storeDidUpdate,m.c9.StoreUpdateThrottleThreshold).bind(this)()}async fetchCriticalData(e,t){(await e.viewActionCreatorProvider()).fetchViewData(e.viewPartitionKey)}fetchNonCriticalData(e,t){this.onViewCriticalDataFetchCompletion()}checkForCriticalDataReady(){const e=this.checkForCriticalViewDataReady();return e&&this.onViewCriticalDataFetchCompletion(),e}fetchCriticalDataWhenComponentDidUpdate(e,t){return super.fetchCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}fetchNonCriticalDataWhenComponentDidUpdate(e,t){return super.fetchNonCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}notifyInteractive(e){var t,r;null===(t=(r=this.props).onPageInteractive)||void 0===t||t.call(r,e)}getViewContext(){const{viewStore:e,viewPartitionKey:t}=this.props;return e.getViewContext(this.taskAccessContext,t)}async onSetLabelsCollapsedStateForView(e){const{viewPartitionKey:t,actionCreatorProviders:r}=this.props;(await r.viewTransformsActionCreator()).setCategoryLabelMode(this.taskAccessContext,e,t)}constructor(){super(...arguments),this.onCriticalDataReadyDispatched={},this.onViewCriticalDataFetchCompletion=async()=>{const{viewPartitionKey:e,viewActionCreatorProvider:t}=this.props;if(!this.onCriticalDataReadyDispatched[e]){this.onCriticalDataReadyDispatched[e]=!0;(await t()).onCriticalDataFetchCompletion(e),this.notifyInteractive()}},this.getTaskPermissions=e=>{const t=this.props.planStore.getPlan(e.planId);return this.props.permissionsStore.getTaskPermissions(e,t)},this.completedTaskClassifier=e=>e.isComplete(),this.onFilterMenuVisibleChange=e=>{this.setState({isFilterMenuVisible:e})},this.onUpdateTask=async(e,t)=>{var r;this.props.loggers.usageLogger.logData(this.name(),p.M.TaskUpdated,{taskCreationSourceType:null!==(r=e.taskCreationSourceType)&&void 0!==r?r:""});(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(To.F.builder.withTask(e).build(),To.F.builder.withTask(t).build())},this.onUpdateTaskDetails=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).updateTaskDetails(e,t)},this.onDeleteTask=async e=>{const t=this.props.taskStore.getTask(e),r=await this.props.actionCreatorProviders.taskActionCreator();t&&r.deleteTask(e,t.itemVersion)},this.onDeleteRecurringTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openDeleteRecurringTaskDialog(e,t)},this.onOpenTaskDetailsEditor=async(e,t)=>{const{appContextStore:r,actionCreatorProviders:o,userStore:n,flights:a,taskStore:s}=this.props;(await o.dialogActionCreator()).openTaskDetails(e,this.taskAccessContext,t);const i=n.getUserDetailsById(r.getCurrentUserId());if(null==i)return;let l=!1;if(a.EnablePalauCoachmark){var p;const t=s.getTask(e);l=null!==(p=null===t||void 0===t?void 0:t.isProjectTask())&&void 0!==p&&p}if(!l&&!i.getHasSeenTaskDetails()&&h.B.clientType!==c.s.Loop){(await o.walkthroughActionCreator()).setTeachingCallout(i,m.Ox.TaskDetails,null,null)}},this.onRenderPersona=async e=>{const t=this.props.userStore.getUserPhotoById(e.id);if(!t||t===m.S1.Photo){(await this.props.actionCreatorProviders.userActionCreator()).fetchUserPhoto(e)}},this.onShowAssigneeLimitError=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openAssigneeLimitErrorDialog(e)},this.onGroupByChange=async e=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskGroupingState(this.taskAccessContext,e)},this.onFilterChange=async(e,t,r,o)=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskFilter(this.taskAccessContext,e,t,r,o)},this.onCopyTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyTaskDialog(e,t)},this.onMoveTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openMoveTaskDialog(e,t)},this.onAssignTask=async(e,t,r,o)=>{const{taskStore:n,appContextStore:a,actionCreatorProviders:s,viewPartitionKey:i}=this.props;if(null==e||""===e)return;let l=n.getTask(t);null==l&&(l=(0,Pt.YO)(t,i));const c=l.getClone();c&&(c.assignments[e]=new So.I(a.getCurrentUserId(),new Date));(await s.taskActionCreator()).assignTask({userId:e,originalTask:l,updatedTask:c,elementToFocusOnDismiss:r,onAssignSuccess:o})},this.onOpenAssignCallout=async e=>{const{planStore:t,userStore:r,actionCreatorProviders:o,groupDocumentsStore:n}=this.props,a=t.getPlan(e);if(null!=a){if(null==r.getContainerUsers(a.container.externalId)){(await o.userActionCreator()).fetchUsersForContainer(a.container)}if(null!=a.sharedWithContainers)for(const e of a.sharedWithContainers)if(e.containerType===C.K.DriveItem&&null==n.getDriveItem(e.externalId)){(await o.groupDocumentsActionCreator()).fetchDriveItem(e.externalId)}}},this.getAssigneePool=e=>{var t;const{taskStore:r,planStore:o,userStore:n}=this.props,a=r.getTask(e),s=a?o.getPlan(a.planId):null,i=null===s||void 0===s?void 0:s.container;return i&&null!==(t=n.getContainerUsers(i.externalId))&&void 0!==t?t:[]},this.canUserAccessPlanViaSharedContainerOnly=e=>{const{permissionsStore:t,planStore:r}=this.props,o=r.getPlan(e);return null!=o&&(t.canAccessPlanViaSharedContainers(o.sharedWithContainers)&&!t.canAccessPlanViaHostContainer(o))},this.onDeleteBucket=async e=>{const{actionCreatorProviders:t,bucketStore:r,viewPartitionKey:o}=this.props,n=await t.bucketActionCreator();if("null"===e)n.deleteBucket(s.iR+o,"");else{const t=r.getBucket(e);n.deleteBucket(e,t?t.itemVersion:"")}},this.fetchReferencePreviewForTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).fetchReferencePreviewForTask(e)},this.onCopyLinkToTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).copyLinkToTask(e)},this.showInfoBanner=async e=>{(await this.props.actionCreatorProviders.notificationActionCreator()).showInfo(e)},this.alertUser=async(e,t,r)=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast(e,t,r)},this.getUsersWithKeyword=async e=>(await this.props.actionCreatorProviders.userActionCreator()).fetchUsersWithKeyword(e),this.navigateToPage=async(e,t,r,o)=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(e,t,r,o)},this.fetchPermissionsWithTaskContext=async e=>{(await this.props.actionCreatorProviders.containerActionCreator()).fetchPermissionsWithTaskContext(e)}}}const Do=(0,V.J9)(((e,t)=>{const r={root:[(0,z.gS)("column","nowrap"),(0,z.$Z)(K.B.TopHeaderHeight),{padding:"".concat(K.B.TopHeaderPaddingTop," ").concat(K.B.TopHeaderHorizontalPadding," ").concat(K.B.TopHeaderPaddingBottom),overflowX:"auto","&.responsive":{overflowY:"hidden"}}],landmark:[(0,z.gS)("row","nowrap"),{height:"100%"}],leftAlignedSection:[(0,z.gS)("row","nowrap"),{alignItems:"center","> .primaryTextSection":{marginLeft:"12px",maxWidth:"220px"}}],rightAlignedSection:[(0,z.GD)("auto"),(0,z.gS)("row","nowrap"),{alignItems:"center","> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,W.TW)(r,t)})),wo=(0,V.J9)((e=>({root:(0,W.Zq)("LoopPlanHeader",e.root),landmark:(0,W.Zq)("LoopPlanHeaderLandmark",e.landmark),leftAlignedSection:(0,W.Zq)("leftAlignedSection",e.leftAlignedSection),rightAlignedSection:(0,W.Zq)("rightAlignedSection",e.rightAlignedSection)})));class Lo extends w{name(){return"LoopPlanHeader"}getClassNames(){return wo(Do(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return to(eo())}renderComponent(){var e;const{contextDropdownProps:t,imageSource:r,isIconCircular:o,hideBadgeIcon:n,showGroupByMenuTitleValue:a,currentTaskGrouping:s,taskGroupingOptions:i,currentTaskFilter:l,plan:c,planBuckets:p,planCategories:d,isFilterCalloutVisible:u,sharedContainersListProps:h,renderContextDropdown:m,renderMembersDropdown:g,callbacks:C,planMembers:b,planContainer:T,sensitivityLabels:S,userPermissions:v,containerPermissions:P,theme:x}=this.props,y=this.getClassNames(),f=this.getResponsiveHeaderClassNames(),D=["",f.hidePivotText,f.hideDropdownText,f.hideTitle],w=c.title;return k.createElement(F.$,{planContainerId:c.id,onRender:C.onRenderPlanPhoto},k.createElement(Mr,{sizeClasses:D,isAdditive:!0,className:y.root},k.createElement(Nr.H,{className:y.landmark,role:"banner"},k.createElement("div",{className:y.leftAlignedSection},k.createElement(Yr,{badgeIconAriaLabel:null===(e=C.getBadgeIconAriaLabel)||void 0===e?void 0:e.call(C),hideBadgeIcon:n,imageSource:r,isIconCircular:o,titleText:c.title,planMembers:b,planContainer:null!==T&&void 0!==T?T:null,sensitivityLabels:null!==S&&void 0!==S?S:null,hasSharedContainers:c.sharedWithContainers.length>0,theme:x}),k.createElement(Xr.g,{onClickTitleButton:C.onClickTitleButton,titleButtonAriaLabel:Ee.G(U.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,w),titleText:w,theme:x})),k.createElement("div",{className:y.rightAlignedSection},k.createElement(Dr,{renderContextDropdown:null===m||void 0===m||m,renderMembersDropdown:null===g||void 0===g||g,contextMenuProps:t,membersDropdownProps:{canUserAddGuests:null===v||void 0===v?void 0:v.canAddGuests,canUserViewMembers:null===P||void 0===P?void 0:P.canViewMembers,canUserAddMembers:null===P||void 0===P?void 0:P.canAddMembers,canUserRemoveMembers:null===P||void 0===P?void 0:P.canRemoveMembers,sharedContainersListProps:h,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{renderNewFilterMenu:!0,currentTaskFilter:l,buckets:p,planCategories:d,isFilterCalloutVisible:u,taskData:this.props.taskData},groupByDropdownProps:{showGroupByMenuTitleValue:a,currentTaskGrouping:s,taskGroupingOptions:i},members:b,callbacks:C,theme:x}),k.createElement(de,{moreOptionsContextMenuItems:this.getMoreOptionsMenuItems(),moreOptionsTooltip:U.p.Strings.PlanHeader_MoreText,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef,theme:x})))))}getMoreOptionsMenuItems(){const{disableMode:e,plan:t,planContainer:r,planMembers:o,hasAccessViaSharedContainer:s}=this.props;if(e===f.DisableAll||null==t)return[];const i=[],l=a.getLinksCapabilitiesForPlan(null!==r&&void 0!==r?r:null,o.length,t.container.containerType,null!==s&&void 0!==s&&s);return y(l,n.EnableSettings)&&i.push({key:"PlanSettings",name:U.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e,r;return null===(e=this.openPlanSettingsPanel)||void 0===e?void 0:e.call(this,t.id,null!==(r=this.headerMoreOptionsButtonRef.current)&&void 0!==r?r:void 0)}}),y(l,n.EnableLeave)&&i.push({key:"LeavePlan",name:U.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>{var e;return null===(e=this.openLeavePlanDialog)||void 0===e?void 0:e.call(this,t.id)}}),i.push({key:"Help",name:U.p.Strings.PlanHeader_PlanHeaderHelp,onClick:()=>this.openHelpLink()}),i}constructor(e,t){super(e,t),this.dismissMembersCallout=()=>{this.setState((e=>({isMembersCalloutVisible:!1})))},this.toggleMembersCallout=()=>{this.setState((e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}}))},this.openHelpLink=()=>{no.b.safelyOpenExternalUrl(m.$j.usePlannerComponent,"_blank")},this.state={isMembersCalloutVisible:!1}}}var Bo=r(49634),Eo=r(24369),Ao=r(13706),Fo=r(27663),Io=r(50861);var Mo;!function(e){var t=e.White="#FFFFFF",r=(e.LightRed="#e73550",e.DarkRed="#a80000",e.Black="#000000"),o=(e.Grey4="#0A0A0A",e.Grey14="#242424",e.Grey16="#292929",e.Grey26="#424242",e.Grey38="#616161",e.Grey78="#C7C7C7",e.Grey82="#D1D1D1",e.Grey84="#D6D6D6",e.Grey92="#EBEBEB",e.Grey94="#F0F0F0",e.Grey96="#F5F5F5",e.Grey98="#FAFAFA",e.DarkGrey24="#3D3D3D",e.DarkGrey68="#ADADAD",e.Teams12="#bdbde6",e.Teams60="#444791",e.Teams70="#4F52B2",e.Teams80="#5B5FC7",e.Teams160="#E8EBFA",e.NeutralDark="#201f1e",e.NeutralPrimary="#323130"),n=(e.NeutralPrimaryAlt="#3b3a39",e.NeutralSecondary="#605e5c",e.NeutralSecondaryAlt="#8a8886",e.NeutralTertiary="#a19f9d"),a=(e.NeutralTertiaryAlt="#c8c6c4",e.NeutralLight="#edebe9"),s=e.NeutralLighter="#f3f2f1",i=(e.NeutralLighterAlt="#faf9f8",e.NeutralQuaternaryAlt="#e1dfdd",e.ThemePrimary="#217346");e.ThemeSecondary="#318456",e.ThemeSecondaryAlt="#4a986d",e.ThemeTertiary="#62ab83",e.ThemeLighter="#cee9da",e.PlannerPrimary="#107c41",e.PlannerSecondary="#218D51",e.PlannerDarkAlt="#0F703B",e.PlannerDarker="#094624",e.PlannerDarkDarker="#60BD82",e.PlannerDarkPrimary="#10893C",e.PlannerDarkSecondary="#0F7937",e.DarkThemeAppBackgroundColor="#1b1a19",e.HighContrastYellow="#ffff00",e.HighContrastCyan="#00ffff",e.HighContrastBlack="#000000",e.HighContrastSelectedTextBackground="#008000",e.HighContrastWhiteSelectedTextBackground="#37006e",e.HighContrastBlackSelectedTextBackground="#1aebff",e.ExcelIconColor="#107c10",e.PowerPointIconColor="#d24726",e.WordIconColor="#2b579a",e.OneNoteIconColor="#80397b",e.PdfIconColor="#de3d41",e.ProjectIconColor="#31752f",e.VisioIconColor="#3955a3",e.FormsIconColor="#038387",e.GenericIconColor="#5e727c",e.MeetingNotesColorLight="#7719aa",e.MeetingNotesColorDark="#C0AAE4",e.WordColorLight="#185abd",e.WordColorDark="#296FE6",e.ExcelColorLight="#107C41",e.ExcelColorDark="#10893C",e.PowerPointColorLight="#C43E1C",e.PowerPointColorDark="#CA5010",e.ProjectColorLight="#107C41",e.ProjectColorDark="#0a4e28",e.TeamsPurple="#6264a7",e.TeamsDarkPurple="#a6a7dc",e.TeamsDarkBackground="#252423",e.TeamsDarkNeutralPrimary="#323130",e.TeamsAppBrand00="#6264a7",e.TeamsAppBrand04="#464775",e.TeamsAppBrand08="#8b8cc7",e.TeamsAppBrand12="#bdbde6",e.TeamsAppBrand14="#e2e2f6",e.TeamsContrastSelectedColor="#00ebff",e.TeamsContrastHyperlinkColor="#e6e600",e.TeamsHoverBackgroundColor="#f5f5f5",e.TeamsLightBackgroundColor="#f3f2f1",e.TeamsDarkBackgroundColor="#201f1f",e.TeamsContrastPlaceHolderOrDisabledColor="#3ef23e",e.TeamsMessageDarkColor="#7a7fea",e.TeamsProgressNotStartedColor="#605e5c",e.TeamsProgressInProgressColor="#327eaa",e.TeamsDarkProgressNotStartedColor="#979693",e.TeamsDarkProgressInProgressColor="#5ca9e5",e.TeamsPriorityUrgentColor="#c4314b",e.TeamsPriorityImportantColor="#c4314b",e.TeamsPriorityMediumColor="#418040",e.TeamsPriorityLowColor="#327eaa",e.TeamsDarkPriorityUrgentColor="#cb455e",e.TeamsDarkPriorityImportantColor="#cb455e",e.TeamsDarkPriorityMediumColor="#418040",e.TeamsDarkPriorityLowColor="#327eaa",e.LoopBrand50="#560FBF",e.LoopBrand140="#D0BEFE",e.LoopBrand70="#7520F5",e.LoopBrand80="#8230FF",e.LoopBrand100="#A375FF",e.LoopBrand110="#AB85FF",e.FontColorThemeDark="#195735",e.FontColorThemeDarkAlt="#1e673f",e.BorderColorNeutralPrimary="#364147",e.BorderColorNeutralTertiaryAlt="#c7cde1",e.BorderColorNeutralTertiary="#afb8bd",e.SharepointTitleFontColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.black)&&void 0!==e?e:r},e.SharepointAddTaskButtonBackgroundColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.neutralLighter)&&void 0!==e?e:s},e.SharepointBackgroundColor=()=>{var e,r;return null!==(e=null===(r=window.__themeState__)||void 0===r||null===(r=r.theme)||void 0===r?void 0:r.white)&&void 0!==e?e:t},e.SharepointTextFontColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.primaryText)&&void 0!==e?e:"#333333"},e.SharepointPlaceholderFontColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.neutralTertiary)&&void 0!==e?e:n},e.SharepointLightBackgroundColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.neutralLight)&&void 0!==e?e:a},e.SharepointNeutralTextFontColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.neutralSecondary)&&void 0!==e?e:"#666666"},e.SharepointButtonHoverColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.themePrimary)&&void 0!==e?e:"#407855"},e.SharepointCardSeparator=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.neutralLight)&&void 0!==e?e:a},e.SharepointBGColorForNonProcessableStyles=()=>{var e,r;return null!==(e=null===(r=window.__themeState__)||void 0===r||null===(r=r.theme)||void 0===r?void 0:r.PageBackground)&&void 0!==e?e:t},e.SharepointTextColorForNonProcessableStyles=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.bodyText)&&void 0!==e?e:o},e.SharepointBlueIconColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.blue)&&void 0!==e?e:"#0078d4"},e.SharepointCompleteColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.excel)&&void 0!==e?e:i},e.SharepointHighPriIconColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.redDark)&&void 0!==e?e:"#a4262c"},e.SharepointCheckboxCheckedColor=()=>{var e,t;return null!==(e=null===(t=window.__themeState__)||void 0===t||null===(t=t.theme)||void 0===t?void 0:t.themePrimary)&&void 0!==e?e:"#6264A7"},e.LoopLightP0="#712DFF",e.NeutralLightGrey14="#242424",e.NeutralLightGrey26="#424242",e.NeutralLightGrey30="#4D4D4D",e.NeutralLightGrey38="#616161",e.NeutralLightGrey44="#707070",e.NeutralLightGrey74="#BDBDBD",e.NeutralLightGrey82="#D1D1D1",e.NeutralLightGrey86="#DBDBDB",e.NeutralLightGrey88="#E0E0E0",e.NeutralLightGrey92="#EBEBEB",e.NeutralLightGrey94="#F0F0F0",e.NeutralLightGrey96="#F5F5F5",e.NeutralDarkGrey8="#141414",e.NeutralDarkGrey12="#1F1F1F",e.NeutralDarkGrey16="#292929",e.NeutralDarkGrey20="#333333",e.NeutralDarkGrey24="#3D3D3D",e.NeutralDarkGrey28="#474747",e.NeutralDarkGrey32="#525252",e.NeutralDarkGrey36="#5C5C5C",e.NeutralDarkGrey40="#666666",e.NeutralDarkGrey60="#999999",e.NeutralDarkGrey68="#ADADAD",e.NeutralDarkGrey84="#D6D6D6",e.CompleteButtonHoverColor="#195735",e.ConfettiMagenta="#e3008c",e.ConfettiRed="#da3b00",e.ConfettiOrange="#feab43",e.ConfettiGreen="#02ad56",e.ConfettiBlue="#0078d4",e.ConfettiPurple="#8763b8",e.TeamsDarkThemeConfettiDarkPurple="#7d84c4",e.NotStarted="#605e5c",e.InProgress="#327eaa",e.Completed="#418040",e.Late="#d13438",e.DarkNotStarted="#979693",e.DarkInProgress="#5ca9e5",e.DarkCompleted="#62ab83",e.Urgent="#d13438",e.Important="#d13438",e.Medium="#418040",e.Low="#327eaa",e.DarkUrgent="#cb455e",e.DarkImportant="#cb455e",e.DarkMedium="#418040",e.DarkLow="#327eaa"}(Mo||(Mo={}));var No=r(46851);const _o="5px",Ro="0px 2px 4px -0.75px rgba(0, 0, 0, 0.1)";No.f.depth8,No.f.depth16;var Uo;!function(e){e.Dark="dark",e.Light="light",e.TeamsDark="teamsdark",e.TeamsLight="teamslight",e.TeamsContrast="teamscontrast",e.SharePoint="sharepoint",e.LoopLight="looplight",e.LoopDark="loopdark",e.LoopWorkspaceLight="loopworkspacelight",e.LoopWorkspaceDark="loopworkspacedark"}(Uo||(Uo={}));const Ho="Highlight",Oo="HighlightText",Vo="WindowText",Wo=e=>({"@media screen and (-ms-high-contrast: active)":e}),Go=e=>({"@media screen and (-ms-high-contrast: white-on-black)":e}),zo=e=>(0,W.TW)(Wo((t=>{const r={border:"1px solid "+t};return(0,W.TW)(r,e)})(Vo))),Zo=e=>(0,W.TW)(Wo((t=>{const r={background:t};return(0,W.TW)(r,e)})("Window"))),Ko=()=>(0,W.TW)(Wo({color:Vo}),Go({color:Mo.White})),qo=e=>{const t={color:Vo,backgroundColor:Vo,borderColor:Vo,":disabled, :disabled:hover":{color:Vo,backgroundColor:Vo,borderColor:Vo,opacity:"0.5"}};return Wo((0,W.TW)(t,e))},Jo=e=>{const t={color:Ho,backgroundColor:Oo,borderColor:Ho};return Wo((0,W.TW)(t,e))},jo=((0,W.TW)(Wo({color:Ho,backgroundColor:Oo,"-ms-high-contrast-adjust":"none"}),Go({color:Mo.HighContrastCyan,backgroundColor:Mo.Black})),(0,W.TW)(Wo({color:Oo,backgroundColor:Ho,"-ms-high-contrast-adjust":"none"}),Go({color:Mo.Black,backgroudColor:Mo.HighContrastCyan})),(0,V.J9)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"row",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nowrap";return{display:"flex","-webkit-flex-direction":e,"-moz-flex-direction":e,"-ms-flex-direction":e,flexDirection:e,"-webkit-flex-wrap":t,"-moz-flex-wrap":t,"-ms-flex-wrap":t,flexWrap:t}}))),$o=(0,V.J9)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0px";return{"-webkit-flex":"1 1 ".concat(e),"-moz-flex":"1 1 ".concat(e),"-ms-flex":"1 1 ".concat(e),flex:"1 1 ".concat(e),minHeight:0,minWidth:0}})),Yo=((0,V.J9)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";return{"-webkit-flex":"0 0 ".concat(e),"-moz-flex":"0 0 ".concat(e),"-ms-flex":"0 0 ".concat(e),flex:"0 0 ".concat(e),minHeight:0,minWidth:0}})),{justifyContent:"center",alignItems:"center"});(0,V.J9)((function(){return{textOverflow:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clip",whiteSpace:"nowrap",overflow:"hidden"}})),(0,V.J9)((function(){return{display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":arguments.length>0&&void 0!==arguments[0]?arguments[0]:"5",whiteSpace:"pre-line",overflow:"hidden",textOverflow:"ellipsis"}}));(0,V.J9)((e=>({"::-webkit-scrollbar":{width:"10px",height:"7px"},"::-webkit-scrollbar-track":{borderRadius:_o},"::-webkit-scrollbar-track-piece":{borderRadius:_o},"::-webkit-scrollbar-thumb":{backgroundColor:e.palette.neutralTertiaryAlt,borderRadius:_o}}))),(0,V.J9)((e=>{let t=Qo(e);switch(e.name){case Uo.TeamsContrast:t={backgroundColor:Mo.TeamsContrastHyperlinkColor,color:Mo.Black};break;case Uo.TeamsLight:case Uo.TeamsDark:t={backgroundColor:e.palette.neutralLighter}}return t})),(0,V.J9)((e=>{let t=Mo.NeutralLighter;switch(e.name){case Uo.Dark:case Uo.TeamsDark:t=uo.kd.gray160;break;case Uo.TeamsContrast:t=Mo.TeamsContrastSelectedColor;break;case Uo.SharePoint:t=Mo.SharepointAddTaskButtonBackgroundColor();break;case Uo.Light:case Uo.TeamsLight:case Uo.LoopLight:t=Mo.NeutralLightGrey96;break;case Uo.LoopDark:t=Mo.NeutralDarkGrey24}return{backgroundColor:t}}));const Xo=(0,V.J9)((e=>{let t=e.semanticColors.bodyBackground;switch(e.name){case Uo.Light:t=Mo.White;break;case Uo.Dark:t=uo.kd.gray180;break;case Uo.SharePoint:t=Mo.SharepointBackgroundColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.White;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.Grey16;case Uo.TeamsLight:case Uo.TeamsDark:case Uo.TeamsContrast:}return{backgroundColor:t}})),Qo=(0,V.J9)((e=>{let t=e.palette.neutralLight;switch(e.name){case Uo.Light:t=Mo.NeutralLight;break;case Uo.Dark:t=uo.kd.gray150;break;case Uo.SharePoint:t=Mo.SharepointAddTaskButtonBackgroundColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.Grey96;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.DarkGrey24;case Uo.TeamsContrast:case Uo.TeamsLight:case Uo.TeamsDark:}return{backgroundColor:t}})),en=((0,V.J9)((e=>{let t=e.palette.neutralLighter;switch(e.name){case Uo.Dark:case Uo.TeamsDark:t=uo.kd.gray190;break;case Uo.TeamsContrast:t=Mo.Black;break;case Uo.SharePoint:t=Mo.SharepointAddTaskButtonBackgroundColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.NeutralLightGrey92;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.NeutralDarkGrey12}return{backgroundColor:t}})),(0,V.J9)((e=>{let t=e.palette.neutralPrimary;switch(e.name){case Uo.Light:t=Mo.NeutralPrimary;break;case Uo.Dark:case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.White;break;case Uo.SharePoint:t=Mo.SharepointTitleFontColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.Grey14;case Uo.TeamsContrast:case Uo.TeamsLight:case Uo.TeamsDark:}return{color:t}}))),tn=(0,V.J9)((e=>{let t=e.palette.neutralTertiary;switch(e.name){case Uo.Light:t=Mo.NeutralTertiary;break;case Uo.Dark:t=uo.kd.gray90;break;case Uo.SharePoint:t=Mo.SharepointTitleFontColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.Grey38;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.DarkGrey68;case Uo.TeamsContrast:case Uo.TeamsLight:case Uo.TeamsDark:}return{color:t}})),rn=((0,V.J9)((e=>{let t=tn(e);switch(e.name){case Uo.TeamsContrast:t={color:Mo.TeamsContrastPlaceHolderOrDisabledColor};break;case Uo.SharePoint:t={color:Mo.SharepointPlaceholderFontColor()};case Uo.Light:case Uo.Dark:case Uo.TeamsLight:case Uo.TeamsDark:case Uo.LoopLight:case Uo.LoopDark:case Uo.LoopWorkspaceLight:case Uo.LoopWorkspaceDark:}return t})),(0,V.J9)((e=>{let t=Mo.NeutralSecondary;switch(e.name){case Uo.Light:case Uo.TeamsLight:t=Mo.NeutralSecondary;break;case Uo.Dark:case Uo.TeamsDark:t=uo.kd.gray60;break;case Uo.TeamsContrast:t=Mo.White;break;case Uo.SharePoint:t=Mo.SharepointNeutralTextFontColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.NeutralLightGrey26;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.NeutralDarkGrey84}return{color:t}}))),on=((0,V.J9)((e=>({color:e.name===Uo.TeamsContrast?Mo.TeamsContrastHyperlinkColor:on(e),textDecoration:"underline"}))),(0,V.J9)((e=>({backgroundColor:e.palette.neutralLighter,borderStyle:"solid",borderWidth:"0px 0px 2px",borderRadius:"3px",borderColor:e.palette.neutralLighter}))),(0,V.J9)((e=>({backgroundColor:e.palette.neutralLight,borderStyle:"solid",borderWidth:"0px 0px 2px",borderRadius:"3px",borderColor:e.palette.neutralLight}))),(0,V.J9)((e=>(0,W.CX)([{color:e.semanticColors.inputPlaceholderText},Ko]))),(0,V.J9)((e=>(0,W.CX)([{color:e.palette.neutralSecondary},Ko]))),(0,V.J9)((e=>({borderBottomColor:e.palette.themePrimary,borderBottomLeftRadius:"2px",borderBottomRightRadius:"2px"}))),(0,V.J9)((e=>{let t=Mo.ThemePrimary;switch(e.name){case Uo.Light:t=Mo.ThemePrimary;break;case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.Black;break;case Uo.SharePoint:t=Mo.SharepointButtonHoverColor();break;case Uo.LoopLight:t=Mo.PlannerPrimary;break;case Uo.LoopWorkspaceLight:t=Mo.LoopBrand80;break;case Uo.LoopDark:t=Mo.PlannerDarkPrimary;break;case Uo.LoopWorkspaceDark:t=Mo.LoopBrand100}return t}))),nn=(Bt.s.large,Bt.BO.semilight,(0,V.J9)((e=>{const t=(0,W.TW)(en(e),Xo(e),{":disabled":{cursor:"default",opacity:"0.5"}});let r;switch(e.name){case Uo.Light:r={border:"1px solid "+Mo.NeutralLight,boxShadow:Ro,":focus,:hover":{backgroundColor:Mo.NeutralLighter},":disabled":{backgroundColor:Mo.NeutralLight}};break;case Uo.Dark:r={borderColor:uo.kd.gray120,":focus,:hover":{backgroundColor:uo.kd.gray150},":disabled":{backgroundColor:uo.kd.gray180}};break;case Uo.TeamsLight:r={borderColor:Mo.NeutralLight,borderWidth:"1px",boxShadow:Ro,":focus,:hover":{backgroundColor:Mo.NeutralLighter},":disabled":{backgroundColor:Mo.NeutralLight}};break;case Uo.TeamsDark:r={borderColor:uo.kd.gray120,":focus,:hover":{backgroundColor:uo.kd.gray150},":disabled":{backgroundColor:uo.kd.gray180}};break;case Uo.TeamsContrast:r={borderColor:Mo.White,":focus,:hover":{color:Mo.Black,borderColor:Mo.TeamsContrastHyperlinkColor,backgroundColor:Mo.TeamsContrastHyperlinkColor},":disabled":{backgroundColor:Mo.Black,borderColor:Mo.TeamsContrastPlaceHolderOrDisabledColor,color:Mo.TeamsContrastPlaceHolderOrDisabledColor}};break;case Uo.SharePoint:r={color:Mo.SharepointTitleFontColor(),backgroundColor:Mo.SharepointLightBackgroundColor(),border:"1px solid "+Mo.SharepointLightBackgroundColor(),boxShadow:"0px 0px 3px "+Mo.SharepointAddTaskButtonBackgroundColor(),":focus,:hover":{backgroundColor:Mo.SharepointBackgroundColor(),boxShadow:"0px 6.4px 14.4px 0px rgba(0, 0, 0, 0.18), 0px 1.2px 3.6px 0px rgba(0, 0, 0, 0.11)"},":disabled":{backgroundColor:Mo.SharepointAddTaskButtonBackgroundColor(),color:Mo.SharepointTitleFontColor()}};break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:r={border:"1px solid "+Mo.NeutralLightGrey82};break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:r={border:"1px solid "+Mo.NeutralDarkGrey40}}return(0,W.TW)(t,r)}))),an=((0,V.J9)((e=>[rn(e),{fontSize:Bt.s.medium}])),(0,V.J9)(((e,t,r)=>{let o=Mo.NeutralPrimaryAlt,n=on(r),a=Mo.NeutralTertiary;switch(r.name){case Uo.Light:o=Mo.NeutralPrimaryAlt;break;case Uo.Dark:case Uo.TeamsDark:o=uo.kd.gray20,a=uo.kd.gray90;break;case Uo.TeamsLight:o=Mo.NeutralPrimaryAlt;break;case Uo.TeamsContrast:o=Mo.White,n=Mo.TeamsContrastSelectedColor,a=Mo.TeamsContrastPlaceHolderOrDisabledColor;break;case Uo.SharePoint:o=Mo.SharepointCardSeparator(),a=Mo.SharepointPlaceholderFontColor();case Uo.LoopLight:case Uo.LoopDark:case Uo.LoopWorkspaceLight:case Uo.LoopWorkspaceDark:}return[{"::before,:hover::before":[Xo(r),Zo(),zo(),{borderColor:o}],"::after":[Xo(r),Zo({backgroundColor:o})],":hover::after":[Zo(),zo(),{backgroundColor:o}]},e&&{"::before,:hover::before,::after,:hover::after":[zo(),{borderColor:n}]},t&&{"::before,:hover::before,::after,:hover::after":{borderColor:a}}]})),(0,V.J9)((e=>{let t=Mo.White;switch(e.name){case Uo.Dark:case Uo.TeamsDark:t=uo.kd.gray170;break;case Uo.TeamsContrast:t=Mo.Black;break;case Uo.SharePoint:t=Mo.SharepointBackgroundColor();break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.NeutralDarkGrey16;case Uo.Light:case Uo.TeamsLight:case Uo.LoopLight:case Uo.LoopWorkspaceLight:}return{backgroundColor:t}})),(0,V.J9)((e=>{let t=Mo.DarkRed;switch(e.name){case Uo.Dark:case Uo.TeamsDark:case Uo.TeamsContrast:t=Mo.LightRed;case Uo.Light:case Uo.TeamsLight:case Uo.LoopLight:case Uo.LoopDark:case Uo.LoopWorkspaceLight:case Uo.LoopWorkspaceDark:}return t})),(0,V.J9)((e=>{let t=Mo.NeutralLighter;switch(e.name){case Uo.Light:t=Mo.NeutralLighter;break;case Uo.Dark:t=uo.kd.gray190;break;case Uo.TeamsLight:t=Mo.NeutralLighter;break;case Uo.TeamsDark:t=uo.kd.gray190;break;case Uo.TeamsContrast:t=Mo.Black;break;case Uo.SharePoint:t=Mo.SharepointAddTaskButtonBackgroundColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.White;case Uo.LoopDark:case Uo.LoopWorkspaceDark:}return t})),(0,V.J9)((e=>{let t=e.palette.themePrimary;switch(e.name){case Uo.Light:t=Mo.ThemePrimary;break;case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.White;break;case Uo.SharePoint:t=Mo.SharepointButtonHoverColor();break;case Uo.LoopWorkspaceLight:t=Mo.LoopLightP0;break;case Uo.LoopLight:t=Mo.PlannerPrimary;break;case Uo.LoopDark:t=Mo.PlannerDarkPrimary;case Uo.LoopWorkspaceDark:}return{borderColor:t}})),(0,V.J9)((e=>{const t={color:Mo.White,":disabled":[en(e),{cursor:"default",opacity:"0.5"}]};let r;switch(e.name){case Uo.Light:r={backgroundColor:Mo.ThemeSecondary,borderColor:Mo.ThemeSecondary,boxShadow:Ro,":focus,:hover":(0,W.TW)({backgroundColor:Mo.ThemePrimary,borderColor:Mo.ThemePrimary},Jo()),":disabled,:disabled:hover":{backgroundColor:Mo.NeutralLight,borderColor:Mo.NeutralLight}},r=(0,W.TW)(r,qo());break;case Uo.Dark:r={backgroundColor:Mo.ThemePrimary,borderColor:Mo.ThemePrimary,boxShadow:Ro,":focus,:hover":(0,W.TW)({backgroundColor:Mo.ThemeSecondary,borderColor:Mo.ThemeSecondary},Jo()),":disabled,:disabled:hover":{backgroundColor:uo.kd.gray180,borderColor:uo.kd.gray120}},r=(0,W.TW)(r,qo());break;case Uo.TeamsLight:r={backgroundColor:e.palette.themePrimary,borderColor:e.palette.themePrimary,boxShadow:Ro,":focus,:hover":{backgroundColor:Mo.TeamsAppBrand04,borderColor:Mo.TeamsAppBrand04},":disabled,:disabled:hover":{backgroundColor:Mo.NeutralLight,borderColor:Mo.NeutralLight}};break;case Uo.TeamsDark:r={backgroundColor:e.palette.themePrimary,borderColor:"transparent",":focus,:hover":{backgroundColor:Mo.TeamsAppBrand08,borderColor:"transparent"},":disabled,:disabled:hover":{backgroundColor:uo.kd.gray180,borderColor:uo.kd.gray120}};break;case Uo.TeamsContrast:r={backgroundColor:Mo.Black,borderColor:Mo.White,":focus,:hover":{color:Mo.Black,borderColor:Mo.TeamsContrastHyperlinkColor,backgroundColor:Mo.TeamsContrastHyperlinkColor},":disabled,:disabled:hover":{backgroundColor:Mo.TeamsContrastPlaceHolderOrDisabledColor,borderColor:Mo.TeamsContrastPlaceHolderOrDisabledColor}};break;case Uo.SharePoint:r={backgroundColor:Mo.SharepointCompleteColor(),":disabled,:disabled:hover":{backgroundColor:Mo.SharepointAddTaskButtonBackgroundColor(),color:Mo.SharepointTitleFontColor()}};break;case Uo.LoopLight:r={backgroundColor:Mo.PlannerSecondary,":hover":{backgroundColor:Mo.PlannerDarkAlt},":disabled,:disabled:hover":{backgroundColor:Mo.NeutralLightGrey94,color:Mo.NeutralLightGrey74}};break;case Uo.LoopDark:r={backgroundColor:Mo.PlannerDarkPrimary,":hover":{backgroundColor:Mo.PlannerDarkSecondary},":disabled,:disabled:hover":{backgroundColor:Mo.NeutralLightGrey94,color:Mo.NeutralLightGrey74}};break;case Uo.LoopWorkspaceLight:r={backgroundColor:Mo.LoopBrand80,":hover":{backgroundColor:Mo.LoopBrand70},":disabled,:disabled:hover":{backgroundColor:Mo.NeutralLightGrey94,color:Mo.NeutralLightGrey74}};break;case Uo.LoopWorkspaceDark:r={backgroundColor:Mo.LoopBrand70,":hover":{backgroundColor:Mo.LoopBrand80},":disabled,:disabled:hover":{backgroundColor:Mo.NeutralDarkGrey8,color:Mo.NeutralDarkGrey36}}}const o=zo();return(0,W.TW)(t,r,o)})),(0,V.J9)((e=>{const t=[en(e),Xo(e)],r={root:t,rootFocused:t,rootHovered:t,rootPressed:t,rootDisabled:{cursor:"default",opacity:"0.5"}};let o={},n={};switch(e.name){case Uo.Light:n={backgroundColor:Mo.NeutralLighter,color:Mo.NeutralPrimary,border:"1px solid "+Mo.NeutralLight},o={root:{border:"1px solid "+Mo.NeutralLight,boxShadow:Ro},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:Mo.NeutralLight,color:Mo.NeutralPrimary}};break;case Uo.Dark:n={backgroundColor:uo.kd.gray150,color:Mo.White,border:"1px solid "+uo.kd.gray120},o={root:{border:"1px solid "+uo.kd.gray120},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:uo.kd.gray180,color:Mo.White}};break;case Uo.TeamsLight:n={backgroundColor:Mo.NeutralLighter,color:Mo.NeutralPrimary,border:"1px solid "+Mo.NeutralLight},o={root:{border:"1px solid "+Mo.NeutralLight,borderWidth:"1px",boxShadow:Ro},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:Mo.NeutralLight,color:Mo.NeutralPrimary}};break;case Uo.TeamsDark:n={backgroundColor:uo.kd.gray150,color:Mo.White,border:"1px solid "+uo.kd.gray120},o={root:{border:"1px solid "+uo.kd.gray120},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:uo.kd.gray180,color:Mo.White}};break;case Uo.TeamsContrast:n={color:Mo.Black,border:"1px solid "+Mo.TeamsContrastHyperlinkColor,backgroundColor:Mo.TeamsContrastHyperlinkColor},o={root:{border:"1px solid "+Mo.White},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:Mo.Black,border:"1px solid "+Mo.TeamsContrastPlaceHolderOrDisabledColor,color:Mo.TeamsContrastPlaceHolderOrDisabledColor}};break;case Uo.SharePoint:n={color:Mo.SharepointTitleFontColor(),backgroundColor:Mo.SharepointBackgroundColor(),boxShadow:"0px 6.4px 14.4px 0px rgba(0, 0, 0, 0.18), 0px 1.2px 3.6px 0px rgba(0, 0, 0, 0.11)",border:"1px solid "+Mo.SharepointLightBackgroundColor()},o={root:{color:Mo.SharepointTitleFontColor(),backgroundColor:Mo.SharepointLightBackgroundColor(),border:"1px solid "+Mo.SharepointLightBackgroundColor(),boxShadow:"0px 0px 3px "+Mo.SharepointAddTaskButtonBackgroundColor()},rootHovered:n,rootFocused:n,rootPressed:n,rootDisabled:{backgroundColor:Mo.SharepointAddTaskButtonBackgroundColor(),color:Mo.SharepointTitleFontColor()}};break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:o={root:{borderRadius:"8px",border:"1px solid "+Mo.NeutralLightGrey82}};break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:o={root:{borderRadius:"8px",border:"1px solid "+Mo.NeutralDarkGrey40}}}return(0,W.TW)(r,o)})),Bt.s.medium,Bt.BO.regular,Bt.s.small,Bt.BO.regular,(0,V.J9)((e=>{let t=Mo.ThemePrimary;switch(e.name){case Uo.Light:t=Mo.ThemePrimary;break;case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.White;break;case Uo.SharePoint:t=Mo.SharepointButtonHoverColor();break;case Uo.LoopLight:t=Mo.PlannerPrimary;break;case Uo.LoopWorkspaceLight:t=Mo.LoopBrand80;break;case Uo.LoopDark:t=Mo.PlannerDarkDarker;break;case Uo.LoopWorkspaceDark:t=Mo.LoopBrand100}return{color:t}})),(0,V.J9)((e=>{let t=Mo.NeutralPrimary;switch(e.name){case Uo.Dark:case Uo.TeamsDark:case Uo.TeamsContrast:t=Mo.White;break;case Uo.SharePoint:t=Mo.SharepointTitleFontColor();break;case Uo.LoopLight:case Uo.LoopWorkspaceLight:t=Mo.NeutralLightGrey26;break;case Uo.LoopDark:case Uo.LoopWorkspaceDark:t=Mo.NeutralDarkGrey84;case Uo.Light:case Uo.TeamsLight:}return{color:t}})),(0,V.J9)((e=>{let t=Bt.BO.semibold;switch(e.name){case Uo.LoopLight:case Uo.LoopDark:t=Bt.BO.regular}return[rn(e),{fontSize:Bt.s.medium,fontWeight:t}]})),(0,V.J9)((e=>{let t=Mo.Black,r=Mo.ThemePrimary;switch(null===e||void 0===e?void 0:e.name){case Uo.Dark:t=Mo.White,r=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.Black,r=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.White,r=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.TeamsContrastSelectedColor,r=Mo.TeamsContrastSelectedColor}return{color:t,borderBottomColor:r}})),(0,V.J9)((e=>{let t=Mo.ThemePrimary;switch(null===e||void 0===e?void 0:e.name){case Uo.Light:case Uo.SharePoint:t=Mo.ThemePrimary;break;case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.TeamsContrastHyperlinkColor}return{color:t}})),(0,V.J9)((e=>{let t,r;switch(e.name){case Uo.Light:t=Mo.ThemeSecondary,r=Mo.ThemePrimary;break;case Uo.Dark:t=Mo.ThemeSecondaryAlt,r=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsButtonHoverColor,r=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple,r=Mo.TeamsLightPivotDownColor;break;case Uo.TeamsContrast:t=Mo.TeamsContrastHyperlinkColor;break;case Uo.SharePoint:t=Mo.SharepointButtonHoverColor();case Uo.LoopLight:case Uo.LoopDark:case Uo.LoopWorkspaceLight:case Uo.LoopWorkspaceDark:}return r?{color:t,":hover":{color:r}}:{color:t}})),(0,V.J9)((e=>{let t=Mo.ThemePrimary;switch(null===e||void 0===e?void 0:e.name){case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.TeamsContrastSelectedColor}return{backgroundColor:t}})),(0,V.J9)((e=>{let t=Mo.ThemePrimary;switch(null===e||void 0===e?void 0:e.name){case Uo.Dark:t=Mo.ThemeTertiary;break;case Uo.TeamsLight:t=Mo.TeamsAppBrand00;break;case Uo.TeamsDark:t=Mo.TeamsDarkPurple;break;case Uo.TeamsContrast:t=Mo.TeamsContrastSelectedColor}return{borderColor:t}})),(0,V.J9)((e=>{const t={fontSize:Bt.s.medium,height:"32px",pointerEvents:"auto",padding:"0px ".concat("24px"),cursor:"pointer"};return(0,W.TW)(nn(e),t)})),(0,V.J9)((e=>{let t=Mo.White;if(e.name===Uo.TeamsContrast)t=Mo.Black;return{color:t,":hover":{color:t}}})),(0,V.J9)((e=>{let t=Mo.Late,r=Mo.LateHover;if(e.name===Uo.TeamsContrast)t=Mo.White,r=Mo.TeamsContrastHyperlinkColor;return{backgroundColor:t,":hover":{backgroundColor:r}}})),(0,V.J9)(((e,t,r,o)=>{const n={borderRadius:"4px",width:"".concat(t,"px"),height:"".concat(t,"px")},a={root:[jo(),$o(),{justifyContent:"space-between",padding:"0 ".concat("12px")}],initialsWrapper:[jo(),Yo,zo(e),n],initialsText:{fontSize:W.s.size10,fontWeight:W.BO.semibold,color:Mo.White},subComponentStyles:{icon:{root:[zo(e),n,{"> svg":{width:"".concat(r,"px"),height:"".concat(r,"px")}}]},image:{root:n}}};return(0,W.TW)(a,o)}))),sn=(0,V.J9)((e=>({root:(0,W.Zq)("dynamic-icon",e.root),initialsWrapper:(0,W.Zq)("initials-wrapper",e.initialsWrapper),initialsText:(0,W.Zq)("initials-text",e.initialsText)})));var ln;!function(e){e.color0="rgb(104, 123, 33)",e.color1="rgb(76, 119, 168)",e.color2="rgb(177, 87, 144)",e.color3="rgb(0, 163, 0)",e.color4="rgb(30, 113, 69)",e.color5="rgb(217, 0, 128)",e.color6="rgb(126, 56, 120)",e.color7="rgb(96, 60, 186)",e.color8="rgb(0, 130, 129)",e.color9="rgb(0, 120, 212)",e.color10="rgb(43, 87, 151)",e.color11="rgb(196, 74, 38)",e.color12="rgb(185, 29, 71)",e.color13="rgb(226, 16, 16)"}(ln||(ln={}));const cn=(0,V.J9)((e=>{if(null==ln[e])return"";const t={backgroundColor:ln[e]};return(0,W.Zq)(t)}));r(36475),r(7233);var pn=r(60651),dn=r.n(pn);r(93672);function un(e){const t=function(e,t){if(null==e)return-1;if(0===e.length)return-1;if(t<=0)return-1;const r=e.split("").map((e=>e.charCodeAt(0))).reduce(((e,t,r,o)=>e+(t<<r+1)));return Math.abs(r)%t}(e,14);return t<0?"":"color"+t}const hn=e=>{const{stateBasedIcons:t,focused:r,name:o,styles:n,size:a=24,iconSvgSize:s=20}=e,i=(0,Bo.D)(),l=an(i,a,s,n),{initialsWrapper:c,initialsText:p}=sn(l),{image:d,icon:u}=l.subComponentStyles;if(null==t){if(null!=o){const e=function(e){if(!e)return"";if(!(e=e.replace(/[&#.*;]/g,"").trim()))return"";let t="";const r=e.split(/[\s]+/);if(1===r.length){const e=Array.from(r[0]);t=1===e.length?e[0].toLocaleUpperCase():e[0].toLocaleUpperCase()+e[1].toLocaleUpperCase()}else t=Array.from(r[0])[0].toLocaleUpperCase()+Array.from(r[1])[0].toLocaleUpperCase();return(0,G.jI)()&&(t=dn()(t.split("")).join("")),t}(o),t=cn(un(o));return k.createElement("div",{className:(0,oe.A)(c,t)},k.createElement("span",{className:p},e))}return null}if("string"===typeof t)return k.createElement(Fo._,{styles:d,imageFit:Io.N_.cover,src:t,alt:""});{const e=t;return r&&null!=e.focusedIcon?k.createElement(B.I,{styles:u,...e.focusedIcon}):k.createElement(B.I,{styles:u,...e.normalIcon})}};var mn;!function(e){e.Invalid="invalid",e.PlannerUser="plannerUser",e.Group="group",e.TeamsConversation="teamsConversation",e.DriveItem="driveItem",e.Roster="roster",e.Project="project",e.User="user",e.ToDo="todo"}(mn||(mn={}));var gn=r(88319),kn=r(64084),Cn=r(96232),bn=r(49153),Tn=r(81522),Sn=r(12027),vn=r(92285),Pn=r(66014),xn=r(82455),yn=r(92736),fn=r(66442),Dn=r(36697),wn=r(2400),Ln=r(43703),Bn=r(42549),En=r(50486);var An;!function(e){e[e.plannerAdd=0]="plannerAdd",e[e.plannerAppsList=1]="plannerAppsList",e[e.plannerAssign=2]="plannerAssign",e[e.plannerBarChart=3]="plannerBarChart",e[e.plannerBlocked=4]="plannerBlocked",e[e.plannerBoardSplitFilled=5]="plannerBoardSplitFilled",e[e.plannerBoardSplitRegular=6]="plannerBoardSplitRegular",e[e.plannerCalendar=7]="plannerCalendar",e[e.plannerCheckMark=8]="plannerCheckMark",e[e.plannerChevronDown=9]="plannerChevronDown",e[e.plannerChevronLeft=10]="plannerChevronLeft",e[e.plannerChevronLeftExtraSmall=11]="plannerChevronLeftExtraSmall",e[e.plannerChevronLeftLarge=12]="plannerChevronLeftLarge",e[e.plannerChevronRight=13]="plannerChevronRight",e[e.plannerChevronRightExtraSmall=14]="plannerChevronRightExtraSmall",e[e.plannerChevronRightLarge=15]="plannerChevronRightLarge",e[e.plannerChevronUp=16]="plannerChevronUp",e[e.plannerCommentMultiple=17]="plannerCommentMultiple",e[e.plannerCompleted=18]="plannerCompleted",e[e.plannerCopy=19]="plannerCopy",e[e.plannerDelete=20]="plannerDelete",e[e.plannerDeleteSmall=21]="plannerDeleteSmall",e[e.plannerDiamond=22]="plannerDiamond",e[e.plannerDismiss=23]="plannerDismiss",e[e.plannerDismissExtraSmall=24]="plannerDismissExtraSmall",e[e.plannerDismissCircle=25]="plannerDismissCircle",e[e.plannerDismissCircleFilled=26]="plannerDismissCircleFilled",e[e.plannerDivider=27]="plannerDivider",e[e.plannerDot=28]="plannerDot",e[e.plannerDown=29]="plannerDown",e[e.plannerDownSmall=30]="plannerDownSmall",e[e.plannerEdit=31]="plannerEdit",e[e.plannerError=32]="plannerError",e[e.plannerEyeHide=33]="plannerEyeHide",e[e.plannerEyeOff=34]="plannerEyeOff",e[e.plannerFavoriteStar=35]="plannerFavoriteStar",e[e.plannerFavoriteStarFilled=36]="plannerFavoriteStarFilled",e[e.plannerFilter=37]="plannerFilter",e[e.plannerGroup=38]="plannerGroup",e[e.plannerHome=39]="plannerHome",e[e.plannerImage=40]="plannerImage",e[e.plannerInfoLarge=41]="plannerInfoLarge",e[e.plannerInfo=42]="plannerInfo",e[e.plannerInfoSmall=43]="plannerInfoSmall",e[e.plannerLink=44]="plannerLink",e[e.plannerLinkDismiss=45]="plannerLinkDismiss",e[e.plannerLock=46]="plannerLock",e[e.plannerMore=47]="plannerMore",e[e.plannerMoreFilled=48]="plannerMoreFilled",e[e.plannerMove=49]="plannerMove",e[e.plannerMyDayFilled=50]="plannerMyDayFilled",e[e.plannerMyDayRegularSmall=51]="plannerMyDayRegularSmall",e[e.plannerMyDayRegular=52]="plannerMyDayRegular",e[e.plannerMyPlansFilled=53]="plannerMyPlansFilled",e[e.plannerMyPlansRegular=54]="plannerMyPlansRegular",e[e.plannerMyTasksFilled=55]="plannerMyTasksFilled",e[e.plannerMyTasksRegular=56]="plannerMyTasksRegular",e[e.plannerNavigation=57]="plannerNavigation",e[e.plannerOpenInNewWindow=58]="plannerOpenInNewWindow",e[e.plannerPanelLeftContract=59]="plannerPanelLeftContract",e[e.plannerPanelRightContract=60]="plannerPanelRightContract",e[e.plannerPdf=61]="plannerPdf",e[e.plannerPeople=62]="plannerPeople",e[e.plannerPerson=63]="plannerPerson",e[e.plannerPersonFeedback=64]="plannerPersonFeedback",e[e.plannerPhone=65]="plannerPhone",e[e.plannerPin=66]="plannerPin",e[e.plannerPinFilled=67]="plannerPinFilled",e[e.plannerPinOff=68]="plannerPinOff",e[e.plannerPinOffFilled=69]="plannerPinOffFilled",e[e.plannerPlanHub=70]="plannerPlanHub",e[e.plannerQuestion=71]="plannerQuestion",e[e.plannerQuestionCircle=72]="plannerQuestionCircle",e[e.plannerRecents=73]="plannerRecents",e[e.plannerRecurrence=74]="plannerRecurrence",e[e.plannerRecurrenceSmall=75]="plannerRecurrenceSmall",e[e.plannerReOrderDotsVertical=76]="plannerReOrderDotsVertical",e[e.plannerRevToggle=77]="plannerRevToggle",e[e.plannerSend=78]="plannerSend",e[e.plannerSortLines=79]="plannerSortLines",e[e.plannerSearch=80]="plannerSearch",e[e.plannerTag=81]="plannerTag",e[e.plannerTaskList=82]="plannerTaskList",e[e.plannerTaskListFilled=83]="plannerTaskListFilled",e[e.plannerTaskboard=84]="plannerTaskboard",e[e.plannerUnknown=85]="plannerUnknown",e[e.plannerUpload=86]="plannerUpload",e[e.plannerUpSmall=87]="plannerUpSmall",e[e.plannerApprovalsAppFilled=88]="plannerApprovalsAppFilled",e[e.plannerProgressNotStarted=89]="plannerProgressNotStarted",e[e.plannerProgressNotStartedSmall=90]="plannerProgressNotStartedSmall",e[e.plannerProgressInProgress=91]="plannerProgressInProgress",e[e.plannerProgressInProgressSmall=92]="plannerProgressInProgressSmall",e[e.plannerProgressComplete=93]="plannerProgressComplete",e[e.plannerProgressCompleteSmall=94]="plannerProgressCompleteSmall",e[e.plannerPriorityUrgent=95]="plannerPriorityUrgent",e[e.plannerPriorityImportant=96]="plannerPriorityImportant",e[e.plannerPriorityMedium=97]="plannerPriorityMedium",e[e.plannerPriorityLow=98]="plannerPriorityLow",e[e.plannerPriorityLowSmall=99]="plannerPriorityLowSmall",e[e.plannerPriorityUrgentSmall=100]="plannerPriorityUrgentSmall",e[e.plannerPriorityImportantSmall=101]="plannerPriorityImportantSmall",e[e.plannerPriorityUrgentNoFill=102]="plannerPriorityUrgentNoFill",e[e.plannerPriorityImportantNoFill=103]="plannerPriorityImportantNoFill",e[e.plannerPriorityMediumNoFill=104]="plannerPriorityMediumNoFill",e[e.plannerAttachSmall=105]="plannerAttachSmall",e[e.plannerCalendarSmall=106]="plannerCalendarSmall",e[e.plannerChatSmall=107]="plannerChatSmall",e[e.plannerChecklistSmall=108]="plannerChecklistSmall",e[e.plannerDueDateLate=109]="plannerDueDateLate",e[e.plannerDueDateToday=110]="plannerDueDateToday",e[e.plannerDueDateTomorrow=111]="plannerDueDateTomorrow",e[e.plannerDueDateWeek=112]="plannerDueDateWeek",e[e.plannerDueDateNoDate=113]="plannerDueDateNoDate",e[e.plannerWordLogo=114]="plannerWordLogo",e[e.plannerExcelLogo=115]="plannerExcelLogo",e[e.plannerOneNoteLogo=116]="plannerOneNoteLogo",e[e.plannerOutlookLogo=117]="plannerOutlookLogo",e[e.plannerPowerPointLogo=118]="plannerPowerPointLogo",e[e.plannerProjectLogo=119]="plannerProjectLogo",e[e.plannerFormsLogo=120]="plannerFormsLogo",e[e.plannerVisioLogo=121]="plannerVisioLogo",e[e.plannerFormsLogoFilled=122]="plannerFormsLogoFilled",e[e.plannerOpenFolder=123]="plannerOpenFolder",e[e.plannerFolder=124]="plannerFolder",e[e.plannerDocument=125]="plannerDocument",e[e.timelineIcon=126]="timelineIcon",e[e.listIcon=127]="listIcon"}(An||(An={}));const Fn=(0,W.Zq)({display:"flex",alignItems:"center",justifyContent:"center"},Ko()),In=e=>k.createElement(e,{className:Fn}),Mn={plannerAdd:In(gn.Eu3),plannerAppsList:In(gn.xme),plannerAssign:In(fn.L_y),plannerBarChart:In(Sn.egg),plannerBlocked:In(Ln.LZx),plannerBoardSplitFilled:In(Cn.FRO),plannerBoardSplitRegular:In(Cn.$tf),plannerCalendar:In(bn.lVp),plannerCheckMark:In(Tn.N5_),plannerChevronDown:In(Tn.geq),plannerChevronLeft:In(Tn.bP_),plannerChevronLeftExtraSmall:In(Tn.g4p),plannerChevronLeftLarge:In(Tn.p4f),plannerChevronRight:In(Tn.KOR),plannerChevronRightExtraSmall:In(Tn.ba0),plannerChevronRightLarge:In(Tn.O_$),plannerChevronUp:In(Tn.nbk),plannerCommentMultiple:In(Sn.kBw),plannerCompleted:In(Tn.kt0),plannerCopy:In(Sn.c2D),plannerDelete:In(Sn.aYy),plannerDeleteSmall:In(Sn.va_),plannerDismiss:In(kn.LMj),plannerDismissExtraSmall:In(kn.Wyk),plannerDismissCircle:In(kn.Pe6),plannerDismissCircleFilled:In(kn.LtS),plannerDiamond:In(fn.WOc),plannerDivider:In(kn.W9w),plannerDot:In(Tn.sC3),plannerDown:In(gn.SMo),plannerDownSmall:In(gn.bqg),plannerEdit:In(kn.RIf),plannerError:In(vn.NUc),plannerEyeHide:In(vn.umr),plannerEyeOff:In(vn.nat),plannerFavoriteStar:In(wn.do),plannerFavoriteStarFilled:In(wn.zeV),plannerFilter:In(vn.Hs1),plannerGroup:In(fn.nUE),plannerHome:In(Pn.aiC),plannerImage:In(Pn.spT),plannerInfoLarge:In(Pn.vNW),plannerInfo:In(Pn.vrP),plannerInfoSmall:In(Pn.g0L),plannerLink:In(xn.dAI),plannerLinkDismiss:In(xn.w7n),plannerLock:In(xn.iCA),plannerMore:In(yn.caz),plannerMoreFilled:In(yn.GNZ),plannerMove:In(gn.yjO),plannerMyDayFilled:In(Bn.KIq),plannerMyDayRegularSmall:In(Bn.b2j),plannerMyDayRegular:In(Bn.U1s),plannerMyPlansFilled:In(Pn.LIC),plannerMyPlansRegular:In(Pn.rzn),plannerMyTasksFilled:In(Pn.Zed),plannerMyTasksRegular:In(Pn.Deg),plannerNavigation:In(yn.VFg),plannerOpenInNewWindow:In(yn.KCZ),plannerPanelLeftContract:In(yn.OIp),plannerPanelRightContract:In(yn.rCp),plannerPdf:In(kn.I3i),plannerPeople:In(fn.a4t),plannerPerson:In(fn.i3v),plannerPersonFeedback:In(fn.tNe),plannerPhone:In(fn.Vjr),plannerPin:In(fn.W5L),plannerPinFilled:In(fn.sAz),plannerPinOff:In(fn.jz7),plannerPinOffFilled:In(fn.Rv2),plannerPlanHub:In(Tn.LNC),plannerQuestion:In(Dn.n9U),plannerQuestionCircle:In(Dn.XLu),plannerRecents:In(Tn.Ppt),plannerRecurrence:In(gn.efW),plannerRecurrenceSmall:In(gn.dCO),plannerReOrderDotsVertical:In(Dn.FBB),plannerRevToggle:In(gn.XfG),plannerSend:In(Dn.LOf),plannerSortLines:In(Cn.pI5),plannerSearch:In(Dn.TRI),plannerTag:In(Ln.F$A),plannerTaskList:In(Ln.CSm),plannerTaskListFilled:In(Ln.uE4),plannerTaskboard:In(Cn.Twm),plannerUnknown:In(Dn.XLu),plannerUpload:In(Cn.hhx),plannerUpSmall:In(Cn.spB),plannerApprovalsAppFilled:In(gn.y0y),plannerProgressNotStarted:In(Tn.LNC),plannerProgressNotStartedSmall:In(Tn.s81),plannerProgressInProgress:In(Tn.p4k),plannerProgressComplete:In(Tn.ghe),plannerProgressInProgressSmall:In(Tn.YmK),plannerProgressCompleteSmall:In(Tn.RaO),plannerPriorityUrgent:In(gn.AAD),plannerPriorityImportant:In(Pn.BNw),plannerPriorityMedium:In(Tn.sC3),plannerPriorityLow:In(gn.SMo),plannerPriorityLowSmall:In(gn.bqg),plannerPriorityUrgentSmall:In(gn.TcI),plannerPriorityImportantSmall:In(Pn.c2h),plannerPriorityUrgentNoFill:In(gn.eF7),plannerPriorityImportantNoFill:In(Pn.RqK),plannerPriorityMediumNoFill:In(Tn.ufZ),plannerAttachSmall:In(Cn.x4$),plannerCalendarSmall:In(bn.glr),plannerChatSmall:In(Tn.emQ),plannerChecklistSmall:In(Tn.FHz),plannerDueDateLate:In(Bn.rg6),plannerDueDateToday:In(bn.S1y),plannerDueDateTomorrow:In(bn.PeL),plannerDueDateWeek:In(bn.SAe),plannerDueDateNoDate:In(bn.Gv9),plannerWordLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1963 128q35 0 60 25t25 60v1622q0 35-25 60t-60 25H597q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h427V213q0-35 25-60t60-25h1366zM515 956l123 404h140l134-672H771l-80 397-113-384H459l-120 386-80-399H112l134 672h140l129-404zm1405 836v-256H640v256h1280zm0-384v-320h-896v320h896zm0-448V640h-896v320h896zm0-448V256H640v256h1280z"})))),plannerExcelLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1963 128q35 0 60 25t25 60v1622q0 35-25 60t-60 25H597q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h427V213q0-35 25-60t60-25h1366zM512 1133l121 227h183l-203-330 199-324H637L525 911q-2 3-3 6t-4 8q-27-55-55-109t-56-110H221l194 326-212 328h184l125-227zm704 659v-256H640v256h576zm0-384v-320h-192v320h192zm0-448V640h-192v320h192zm0-448V256H640v256h576zm704 1280v-256h-576v256h576zm0-384v-320h-576v320h576zm0-448V640h-576v320h576zm0-448V256h-576v256h576z"})))),plannerOneNoteLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1963 128q35 0 60 25t25 60v1622q0 35-25 60t-60 25H597q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h427V213q0-35 25-60t60-25h1366zM389 939l242 420h152V689H635v429L402 689H241v670h148V939zm1531 853v-256h-256v256h256zm0-384v-256h-256v256h256zm0-384V768h-256v256h256zm0-384V256H640v256h299q35 0 60 25t25 60v854q0 35-25 60t-60 25H640v256h896V640h384z"})))),plannerOutlookLogo:In((e=>k.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",...e},k.createElement("path",{d:"M17.8 9.52006L11.5 5.92006H11.41C11.3005 5.84277 11.1732 5.79459 11.04 5.78006C10.9047 5.77897 10.7711 5.8098 10.65 5.87006H10.56L4.25998 9.47006C4.20058 9.50431 4.15156 9.55401 4.11811 9.61386C4.08466 9.67372 4.06803 9.74151 4.06998 9.81006C4.06975 9.87577 4.08613 9.94048 4.1176 9.99818C4.14906 10.0559 4.1946 10.1047 4.24998 10.1401L11.04 15.0001L17.85 10.1901C17.9066 10.1552 17.9536 10.1067 17.9868 10.0491C18.0199 9.9915 18.0382 9.92652 18.04 9.86006C18.0362 9.78651 18.0116 9.71554 17.9691 9.65537C17.9266 9.5952 17.868 9.54829 17.8 9.52006Z",fill:"#0A2767"}),k.createElement("path",{d:"M16.04 2H6.03998C5.77476 2 5.52041 2.10536 5.33287 2.29289C5.14534 2.48043 5.03998 2.73478 5.03998 3L11.04 5L17.04 3C17.04 2.73478 16.9346 2.48043 16.7471 2.29289C16.5595 2.10536 16.3052 2 16.04 2Z",fill:"#0364B8"}),k.createElement("path",{d:"M11 3H5V9L10.99 15.01H16.99V8.99L11 3Z",fill:"#28A8EA"}),k.createElement("path",{d:"M17 3H11V9H17V3Z",fill:"#50D9FF"}),k.createElement("path",{d:"M10.99 15.01L5 15V9H11L10.99 15.01Z",fill:"#0078D4"}),k.createElement("path",{opacity:"0.5",d:"M11.04 15L4.21002 10.17L4.72002 9.29003L11.04 12.87L17.32 9.28003L17.81 10.19L11.04 15Z",fill:"#0A2767"}),k.createElement("path",{d:"M17.81 10.1901L11.5 13.7801C11.3595 13.8699 11.1967 13.9184 11.03 13.9201H10.97C10.887 13.9306 10.803 13.9306 10.72 13.9201L13.04 17.0001L17.68 17.8301C17.7915 17.7484 17.8823 17.6415 17.9448 17.5181C18.0074 17.3948 18.04 17.2584 18.04 17.1201V9.86011C18.0342 9.93053 18.0099 9.99816 17.9695 10.0561C17.9291 10.1141 17.874 10.1603 17.81 10.1901Z",fill:"#1490DF"}),k.createElement("path",{opacity:"0.1",d:"M12.04 13.48L11.5 13.79C11.3595 13.8797 11.1967 13.9282 11.03 13.93H10.97C10.887 13.9404 10.803 13.9404 10.72 13.93L13.04 17L17.68 17.83C17.7915 17.7483 17.8823 17.6414 17.9448 17.518C18.0074 17.3947 18.04 17.2583 18.04 17.12V16.85L12.04 13.48Z",fill:"black"}),k.createElement("path",{d:"M4.18001 10.1901C4.13199 10.1503 4.09421 10.0996 4.06985 10.0421C4.04549 9.98473 4.03526 9.9223 4.04001 9.86011V17.1301C4.04006 17.31 4.09586 17.4854 4.19973 17.6323C4.3036 17.7791 4.45043 17.8902 4.62001 17.9501C4.71609 17.9653 4.81394 17.9653 4.91001 17.9501H17.12C17.3027 17.9523 17.4813 17.8963 17.63 17.7901L4.18001 10.1901Z",fill:"#28A8EA"}),k.createElement("path",{opacity:"0.5",d:"M11.04 16C11.5704 16 12.0791 15.7893 12.4542 15.4142C12.8293 15.0391 13.04 14.5304 13.04 14V7C13.04 6.73478 12.9346 6.48043 12.7471 6.29289C12.5595 6.10536 12.3052 6 12.04 6H5.03998V9.07L4.24998 9.52C4.19338 9.55488 4.14636 9.60332 4.11319 9.66094C4.08002 9.71856 4.06173 9.78354 4.05998 9.85H4.03998V15.99L11.04 16Z",fill:"black"}),k.createElement("path",{d:"M11 5H3C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H11C11.5523 15 12 14.5523 12 14V6C12 5.44772 11.5523 5 11 5Z",fill:"#0078D4"}),k.createElement("path",{d:"M4.19997 8.3699C4.44318 7.87665 4.8302 7.46871 5.30997 7.1999C5.84096 6.91355 6.43679 6.7689 7.03997 6.7799C7.61248 6.76501 8.1786 6.90309 8.67997 7.1799C9.15878 7.4291 9.55225 7.81562 9.80997 8.2899C10.0678 8.79764 10.1982 9.3605 10.19 9.9299C10.2021 10.5264 10.0682 11.1169 9.79997 11.6499C9.54283 12.1263 9.15402 12.5185 8.67997 12.7799C8.15841 13.0616 7.57259 13.2029 6.97997 13.1899C6.39384 13.2017 5.81478 13.0604 5.29997 12.7799C4.83469 12.5182 4.45324 12.1298 4.19997 11.6599C3.94341 11.1588 3.81297 10.6028 3.81997 10.0399C3.81428 9.46117 3.94444 8.88918 4.19997 8.3699ZM5.38997 11.0999C5.5158 11.4123 5.73159 11.6803 6.00997 11.8699C6.30566 12.0659 6.65551 12.1638 7.00997 12.1499C7.36492 12.1563 7.71351 12.0552 8.00997 11.8599C8.28633 11.6706 8.49898 11.4022 8.61997 11.0899C8.75257 10.7491 8.81712 10.3855 8.80997 10.0199C8.81368 9.65213 8.75276 9.28658 8.62997 8.9399C8.51839 8.61 8.30346 8.32484 8.01706 8.1267C7.73066 7.92856 7.38803 7.82799 7.03997 7.8399C6.68598 7.8299 6.3373 7.92753 6.03997 8.1199C5.75811 8.31087 5.53619 8.57787 5.39997 8.8899C5.24757 9.23974 5.17253 9.61837 5.17997 9.9999C5.16826 10.3775 5.23996 10.7531 5.38997 11.0999Z",fill:"white"})))),plannerPowerPointLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1152 128q124 0 238 32t214 90 181 140 140 181 91 214 32 239q0 124-32 238t-90 214-140 181-181 140-214 91-239 32q-110 0-215-26t-199-75-176-121-145-162H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h332q63-90 144-161t176-121 200-76 215-26zm64 131v701h701q-12-140-70-262t-152-216-217-152-262-71zM767 905q0-58-19-99t-54-68-80-38-100-12H243v671h157v-234h106q49 0 95-14t84-42 59-69 23-95zm385 887q100 0 193-24t175-70 152-109 121-142 84-170 40-190h-828V259q-148 12-279 77T580 512h359q35 0 60 25t25 60v854q0 35-25 60t-60 25H580q55 61 120 108t139 81 152 50 161 17zM496 819q49 0 78 19t29 72q0 23-10 37t-27 24-36 12-38 4h-92V819h96z"})))),plannerProjectLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M496 819q49 0 78 19t29 72q0 23-10 37t-27 24-36 12-38 4h-92V819h96zm1552 546v470q0 35-25 60t-60 25H789q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h171V213q0-35 25-60t60-25h918q35 0 60 25t25 60v491h235q35 0 60 25t25 60v491h299q35 0 60 25t25 60zm-512-533h-512v448h512V832zm-769 73q0-58-19-99t-54-68-80-38-100-12H243v671h157v-234h106q49 0 95-14t84-42 59-69 23-95zM384 512h555q35 0 60 25t25 60v107h192V256H384v256zm1536 1280v-384h-896v43q0 35-25 60t-60 25H832v256h1088z"})))),plannerFormsLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1344 1216h448v448h-448v-448zm128 320h192v-192h-192v192zm96-640q-60 0-112-22t-92-62-61-91-23-113q0-60 22-112t62-92 91-61 113-23q60 0 112 22t92 62 61 91 23 113q0 60-22 112t-62 92-91 61-113 23zm0-448q-33 0-62 12t-51 35-34 51-13 62q0 33 12 62t35 51 51 34 62 13q33 0 62-12t51-35 34-51 13-62q0-33-12-62t-35-51-51-34-62-13zm395-320q35 0 60 25t25 60v1622q0 35-25 60t-60 25H597q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h427V213q0-35 25-60t60-25h1366zM640 512h299q35 0 60 25t25 60v363h896V256H640v256zm80 590V966H461V824h278V688H304v672h157v-258h259zm1200 690v-704h-896v363q0 35-25 60t-60 25H640v256h1280z"})))),plannerVisioLogo:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",...e},k.createElement("path",{d:"M1984 597v790q0 35-25 60t-60 25h-429q-6 95-46 176t-104 142-149 95-179 35q-84 0-162-29t-141-80-107-121-59-154H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h433q-6-15-6-32 0-35 25-60L932 25q25-25 60-25t60 25l395 395q25 25 25 60 0 17-6 32h433q35 0 60 25t25 60zM992 146L658 480l32 32h249q35 0 60 25t25 60v185l302-302-334-334zM592 1360l255-672H681q-42 123-85 244t-83 245q-41-123-82-244t-83-245H178l251 672h163zm400 432q73 0 137-27t112-76 75-112 28-137q0-67-25-128t-68-109-101-78-126-35v361q0 35-25 60t-60 25H655q17 56 49 103t76 81 98 53 114 19zm864-448V640h-509q-11 11-36 37t-59 60-70 71-69 68-56 53-33 25v8q80 3 152 34t131 82 98 120 56 146h395z"})))),plannerFormsLogoFilled:In((e=>k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",...e},k.createElement("g",{clipPath:"url(#clip0_998_31900)"},k.createElement("path",{d:"M3.75 10V18.75C3.75 19.375 4.375 20 5 20H18.75C19.5 20 20 19.5 20 18.75V10L12.5 7.5L3.75 10Z",fill:"#036C70"}),k.createElement("path",{d:"M20 10V1.25C20 0.5 19.5 0 18.75 0H5C4.25 0 3.75 0.5 3.75 1.25V10H20Z",fill:"#37C6D0"}),k.createElement("path",{d:"M17.5 12.5H12.5V17.5H17.5V12.5Z",fill:"#1A9BA1"}),k.createElement("path",{d:"M15 8.75C17.0711 8.75 18.75 7.07107 18.75 5C18.75 2.92893 17.0711 1.25 15 1.25C12.9289 1.25 11.25 2.92893 11.25 5C11.25 7.07107 12.9289 8.75 15 8.75Z",fill:"#1A9BA1"}),k.createElement("path",{d:"M15 7.5C16.3807 7.5 17.5 6.38071 17.5 5C17.5 3.61929 16.3807 2.5 15 2.5C13.6193 2.5 12.5 3.61929 12.5 5C12.5 6.38071 13.6193 7.5 15 7.5Z",fill:"#036C70"}),k.createElement("path",{opacity:"0.5",d:"M12.5 5H3.75V17.5H11.25C12.625 17.5 13.75 16.375 13.75 15V6.25C13.75 5.625 13.25 5 12.5 5Z",fill:"black"}),k.createElement("path",{d:"M11.25 16.25H1.25C0.5 16.25 0 15.75 0 15V5C0 4.375 0.5 3.75 1.25 3.75H11.25C12 3.75 12.5 4.375 12.5 5V15C12.5 15.75 12 16.25 11.25 16.25Z",fill:"#038387"}),k.createElement("path",{d:"M8.875 7.5H5.625V9.5H8.625V10.75H5.625V13.75H4.125V6.25H8.875V7.5Z",fill:"white"})),k.createElement("defs",null,k.createElement("clipPath",{id:"clip0_998_31900"},k.createElement("rect",{width:"20",height:"20",fill:"white"})))))),plannerOpenFolder:In(vn.hqt),plannerFolder:In(vn.Ppp),plannerDocument:In(kn.OL4),timelineIcon:In(En.cjE),listIcon:In(xn.nNr)},Nn=e=>e;!function(e){const{icons:t}=e,r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none",display:"flex",alignItems:"center"},icons:t};(0,W.K1)(r)}({icons:Mn});const _n=(0,W.Zq)({display:"flex",alignItems:"center",justifyContent:"center"}),Rn=e=>({iconName:Nn(e),className:(0,oe.A)("plannerIcon",e,_n)}),Un=(Rn("plannerAdd"),Rn("plannerAppsList"),Rn("plannerAssign"),Rn("plannerBarChart"),Rn("plannerBlocked"),Rn("plannerBoardSplitFilled")),Hn=Rn("plannerBoardSplitRegular"),On=(Rn("plannerCalendar"),Rn("plannerCheckMark"),Rn("plannerChevronDown"),Rn("plannerChevronLeft"),Rn("plannerChevronLeftExtraSmall"),Rn("plannerChevronLeftLarge"),Rn("plannerChevronRight"),Rn("plannerChevronRightExtraSmall"),Rn("plannerChevronRightLarge"),Rn("plannerChevronUp"),Rn("plannerCompleted"),Rn("plannerCommentMultiple"),Rn("plannerCopy"),Rn("plannerDelete"),Rn("plannerDeleteSmall"),Rn("plannerDiamond"),Rn("plannerDismiss"),Rn("plannerDismissExtraSmall"),Rn("plannerDismissCircle"),Rn("plannerDismissCircleFilled"),Rn("plannerDivider"),Rn("plannerDot"),Rn("plannerDown"),Rn("plannerDownSmall"),Rn("plannerEdit"),Rn("plannerError"),Rn("plannerEyeHide"),Rn("plannerEyeOff"),Rn("plannerFavoriteStarFilled"),Rn("plannerFavoriteStar"),Rn("plannerFilter"),Rn("plannerGroup"),Rn("plannerHome"),Rn("plannerImage"),Rn("plannerInfoLarge"),Rn("plannerInfo"),Rn("plannerInfoSmall"),Rn("plannerLink"),Rn("plannerLinkDismiss"),Rn("plannerLock"),Rn("plannerMore"),Rn("plannerMoreFilled"),Rn("plannerMove"),Rn("plannerMyDayFilled"),Rn("plannerMyDayRegular"),Rn("plannerMyPlansFilled"),Rn("plannerMyPlansRegular"),Rn("plannerMyTasksFilled"),Rn("plannerMyTasksRegular"),Rn("plannerNavigation"),Rn("plannerOpenInNewWindow"),Rn("plannerPanelLeftContract"),Rn("plannerPanelRightContract"),Rn("plannerPdf"),Rn("plannerPeople"),Rn("plannerPerson"),Rn("plannerPersonFeedback"),Rn("plannerPhone"),Rn("plannerPinFilled"),Rn("plannerPin"),Rn("plannerPinOffFilled"),Rn("plannerPinOff"),Rn("plannerPlanHub"),Rn("plannerQuestion"),Rn("plannerQuestionCircle"),Rn("plannerRecents"),Rn("plannerRecurrence"),Rn("plannerRecurrenceSmall"),Rn("plannerReOrderDotsVertical"),Rn("plannerRevToggle"),Rn("plannerSortLines"),Rn("plannerSearch"),Rn("plannerSend"),Rn("plannerTag"),Rn("plannerTaskList"),Rn("plannerTaskListFilled"),Rn("plannerTaskboard"),Rn("plannerUnknown"),Rn("plannerUpload"),Rn("plannerUpSmall"),Rn("plannerApprovalsAppFilled"),Rn("plannerProgressNotStarted"),Rn("plannerProgressNotStartedSmall"),Rn("plannerProgressInProgress"),Rn("plannerProgressInProgressSmall"),Rn("plannerProgressComplete"),Rn("plannerProgressCompleteSmall"),Rn("plannerPriorityUrgent"),Rn("plannerPriorityUrgentSmall"),Rn("plannerPriorityImportant"),Rn("plannerPriorityImportantSmall"),Rn("plannerPriorityMedium"),Rn("plannerPriorityLow"),Rn("plannerPriorityLowSmall"),Rn("plannerPriorityUrgentNoFill"),Rn("plannerPriorityImportantNoFill"),Rn("plannerPriorityMediumNoFill"),Rn("plannerAttachSmall"),Rn("plannerCalendarSmall"),Rn("plannerChatSmall"),Rn("plannerChecklistSmall"),Rn("plannerDueDateLate"),Rn("plannerDueDateToday"),Rn("plannerDueDateTomorrow"),Rn("plannerDueDateWeek"),Rn("plannerDueDateNoDate"),Rn("plannerWordLogo"),Rn("plannerExcelLogo"),Rn("plannerOneNoteLogo"),Rn("plannerOutlookLogo"),Rn("plannerPowerPointLogo"),Rn("plannerProjectLogo"),Rn("plannerVisioLogo"),Rn("plannerFormsLogo"),Rn("plannerFormsLogoFilled"),Rn("plannerOpenFolder"),Rn("plannerFolder"),Rn("plannerDocument"),Rn("timelineIcon"),Rn("listIcon"),{subComponentStyles:{icon:{root:{background:"linear-gradient(224deg, ".concat("#B377E0"," 1.02%, ").concat("#5166D7"," 123.98%)"),color:Mo.White,":hover":{color:Mo.White}}},image:{}}}),Vn=e=>{const{containerType:t,containerPhoto:r,focused:o=!1,showIconOnly:n,name:a,size:s=20,iconSvgSize:i=16}=e,l=(0,k.useMemo)((()=>n||t!==mn.Group?{normalIcon:Hn,focusedIcon:Un}:r),[t,r,n]);return k.createElement(hn,{name:a,focused:o,stateBasedIcons:l,size:s,iconSvgSize:i,styles:On})},Wn=(0,V.J9)(((e,t)=>{const r={root:[(0,z.$Z)(),(0,z.gS)("row","nowrap"),{alignItems:"center","> div":(0,z.gS)(),paddingRight:"24px"}],linkedBadgeDropdown:[z.xK,{color:e.palette.neutralSecondary,fontSize:W.s.small,textDecoration:"none",cursor:"pointer"}],linkedBadgeItem:[z.$Z,(0,z.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,z.gS)("row","nowrap"),{"> .plannerDivider":[{color:e.palette.neutralQuaternaryAlt}],"> .plannerLinkDismiss":{color:e.semanticColors.errorIcon}}],"> .plannerChevronDownSmall":{color:e.palette.neutralPrimary,marginLeft:"8px",":hover, :active":{color:e.palette.themePrimary}}}],dividerContainer:[(0,z.gS)(),z.cc,{".plannerChevronRightSmall":{color:e.palette.neutralSecondary,padding:"1px 4px 0px 4px"}}],planAvatar:[(0,z.gS)(),{marginRight:"8px"}],planTitle:[(0,z.gS)(),{fontWeight:W.BO.bold,fontSize:W.s.size16,paddingBottom:"4px"}]};return(0,W.pB)(void 0,r,t)})),Gn=(0,V.J9)((e=>({root:(0,W.Zq)("planTitleSection",e.root),linkedBadgeDropdown:(0,W.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,W.Zq)("linkedBadgeItem",e.linkedBadgeItem),dividerContainer:(0,W.Zq)("dividerContainer",e.dividerContainer),planAvatar:(0,W.Zq)("planAvatar",e.planAvatar),planTitle:(0,W.Zq)("planTitle",e.planTitle)}))),zn=e=>{const{theme:{palette:t}}=e;return{root:{margin:"0px"},listItem:[{"&:first-child > .ms-Breadcrumb-itemLink":{fontSize:W.s.size14},"&:last-child > .ms-Breadcrumb-itemLink":{fontWeight:W.BO.bold,fontSize:W.s.size16,maxWidth:"30ch"}}],itemLink:{padding:"0px",":active, :active:hover, :hover":{background:"transparent",textDecoration:"underline"}},overflowButton:[{color:t.neutralSecondary,":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]}},Zn=(0,V.J9)((e=>({root:{marginLeft:"8px",height:"16px",width:"16px",color:e.palette.neutralPrimary},rootPressed:{color:e.palette.themePrimary,backgroundColor:"inherit"}}))),Kn=e=>{let{isCurrentPlanPinned:t,styles:r,theme:o,plan:n,imageSource:a,breadcrumbItems:s,contextDropdownProps:i,togglePlanPinUnpinStatus:l,isTeamsTabView:c}=e;const p=(0,Bo.D)(),d=Gn(Wn(p,r)),u=()=>i&&i.visibleContextKeys.length>0?k.createElement(Me,{...i,className:d.linkedBadgeDropdown,isBeakVisible:!1,onRenderLabel:e=>k.createElement("div",{className:d.linkedBadgeItem},k.createElement(B.I,pe.u2),(()=>{if(i&&i.visibleContextKeys.length>0){const e=i.contextDetails;if(!e)return null;if(null!=oo()(e,(e=>e.status===Fe.$.Delinked)))return k.createElement("div",{className:"delinkIcon"},k.createElement(B.I,pe.Zl),k.createElement(B.I,pe.aA))}return null})()),theme:o}):null,h=()=>k.createElement("div",{className:d.planAvatar},k.createElement(Vn,{containerType:n.container.containerType,containerPhoto:a,name:n.title})),m=e=>k.createElement("div",{className:d.dividerContainer},k.createElement(B.I,pe.gO),h());return c?k.createElement("div",{className:d.root},h(),k.createElement("div",{className:d.planTitle}," ",n.title," "),u()):k.createElement("div",{className:d.root},k.createElement(L.Q,{items:s,className:"planHeader-breadcrumb",maxDisplayedItems:2,overflowAriaLabel:"",dividerAs:m,styles:zn,onReduceData:()=>{}}),u(),(()=>{const e=t?U.p.Strings.PlanHeader_PlanHeaderRemovePinned:U.p.Strings.PlanHeader_PlanHeaderAddPinned,r=t?pe.s1:pe.ol;return k.createElement(po.S,{hostClassName:"pin-button-tooltiphost",content:e,delay:Eo.H.medium,directionalHint:se.A.bottomRightEdge},k.createElement(Ao.K,{onClick:l,className:"toggleFavoriteIcon",ariaLabel:e,styles:Zn(p),onRenderIcon:()=>k.createElement(k.Fragment,null,k.createElement(B.I,{...r,className:(0,oe.A)(r.className,"regularPin")}))}))})())};var qn=r(6326),Jn=r(15199),jn=r(40440),$n=r(37178),Yn=r(17066),Xn=r(27480),Qn=r(87633);function ea(e,t){void 0===t&&(t=null);var r=k.useRef({ref:function(){var e=function(e){r.ref.current!==e&&(r.cleanup&&(r.cleanup(),r.cleanup=void 0),r.ref.current=e,null!==e&&(r.cleanup=r.callback(e)))};return e.current=t,e}(),callback:e}).current;return r.callback=e,r.ref}var ta=r(76682),ra=r(44828),oa=function(e){var t=e.onOverflowItemsChanged,r=e.rtl,o=e.pinnedIndex,n=k.useRef(),a=k.useRef(),s=ea((function(e){var t=function(e,t){if("undefined"!==typeof ResizeObserver){var r=new ResizeObserver(t);return Array.isArray(e)?e.forEach((function(e){return r.observe(e)})):r.observe(e),function(){return r.disconnect()}}var o=function(){return t(void 0)},n=(0,ra.z)(Array.isArray(e)?e[0]:e);if(!n)return function(){};var a=n.requestAnimationFrame(o);return n.addEventListener("resize",o,!1),function(){n.cancelAnimationFrame(a),n.removeEventListener("resize",o,!1)}}(e,(function(t){a.current=t?t[0].contentRect.width:e.clientWidth,n.current&&n.current()}));return function(){t(),a.current=void 0}})),i=ea((function(e){return s(e.parentElement),function(){return s(null)}}));return(0,ta.E)((function(){var e=s.current,l=i.current;if(e&&l){for(var c=[],p=0;p<e.children.length;p++){var d=e.children[p];d instanceof HTMLElement&&d!==l&&c.push(d)}var u=[],h=0;n.current=function(){var e=a.current;if(void 0!==e){for(var t=c.length-1;t>=0;t--){if(void 0===u[t]){var n=r?e-c[t].offsetLeft:c[t].offsetLeft+c[t].offsetWidth;t+1<c.length&&t+1===o&&(h=u[t+1]-n),t===c.length-2&&(h+=l.offsetWidth),u[t]=n+h}if(e>u[t])return void g(t+1)}g(0)}};var m=c.length,g=function(e){m!==e&&(m=e,t(e,c.map((function(t,r){return{ele:t,isOverflowing:r>=e&&r!==o}}))))},k=void 0;if(void 0!==a.current){var C=(0,ra.z)(e);if(C){var b=C.requestAnimationFrame(n.current);k=function(){return C.cancelAnimationFrame(b)}}}return function(){k&&k(),g(c.length),n.current=void 0}}})),{menuButtonRef:i}},na=r(78233),aa=r(9833),sa=function(e){function t(t){var r=e.call(this,t)||this;return(0,na.f)(r),(0,aa.A)("PivotItem",t,{linkText:"headerText"}),r}return(0,qn.__extends)(t,e),t.prototype.render=function(){return k.createElement("div",(0,qn.__assign)({},(0,Yn.G1)(this.props,Yn.JM)),this.props.children)},t}(k.Component),ia=(0,Qt.Z)(),la=function(e,t){var r={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return k.Children.forEach(k.Children.toArray(e.children),(function(o,n){if(ca(o)){var a=o.props,s=a.linkText,i=(0,qn.__rest)(a,["linkText"]),l=o.props.itemKey||n.toString();r.links.push((0,qn.__assign)((0,qn.__assign)({headerText:s},i),{itemKey:l})),r.keyToIndexMapping[l]=n,r.keyToTabIdMapping[l]=function(e,t,r,o){return e.getTabId?e.getTabId(r,o):t+"-Tab".concat(o)}(e,t,l,n)}else o&&(0,$n.R)("The children of a Pivot component must be of type PivotItem to be rendered.")})),r},ca=function(e){var t;return k.isValidElement(e)&&(null===(t=e.type)||void 0===t?void 0:t.name)===sa.name},pa=k.forwardRef((function(e,t){var r,o=k.useRef(null),n=k.useRef(null),a=(0,Jn.B)("Pivot"),s=(0,jn.k)(e.selectedKey,e.defaultSelectedKey),i=s[0],l=s[1],c=e.componentRef,p=e.theme,d=e.linkSize,u=e.linkFormat,h=e.overflowBehavior,m=e.overflowAriaLabel,g=e.focusZoneProps,C=e.overflowButtonAs,b={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]},T=(0,Yn.G1)(e,Yn.JM,["aria-label","aria-labelledby"]),S=la(e,a);k.useImperativeHandle(c,(function(){return{focus:function(){var e;null===(e=o.current)||void 0===e||e.focus()}}}));var v=function(e){if(!e)return null;var t=e.itemCount,o=e.itemIcon,n=e.headerText;return k.createElement("span",{className:r.linkContent},void 0!==o&&k.createElement("span",{className:r.icon},k.createElement(B.I,{iconName:o})),void 0!==n&&k.createElement("span",{className:r.text}," ",e.headerText),void 0!==t&&k.createElement("span",{className:r.count}," (",t,")"))},P=function(e,t,o,n){var a,s=t.itemKey,i=t.headerButtonProps,l=t.onRenderItemLink,c=e.keyToTabIdMapping[s],p=o===s;a=l?l(t,v):v(t);var d=t.headerText||"";d+=t.itemCount?" ("+t.itemCount+")":"",d+=t.itemIcon?" xx":"";var u=t.role&&"tab"!==t.role?{role:t.role}:{role:"tab","aria-selected":p};return k.createElement(Qn.c,(0,qn.__assign)({},i,u,{id:c,key:s,className:(0,oe.A)(n,p&&r.linkIsSelected),onClick:function(e){return x(s,e)},onKeyDown:function(e){return y(s,e)},"aria-label":t.ariaLabel,name:t.headerText,keytipProps:t.keytipProps,"data-content":d}),a)},x=function(e,t){t.preventDefault(),f(e,t)},y=function(e,t){t.which===Xn.c.enter&&(t.preventDefault(),f(e))},f=function(t,r){var o;if(l(t),S=la(e,a),e.onLinkClick&&S.keyToIndexMapping[t]>=0){var s=S.keyToIndexMapping[t],i=k.Children.toArray(e.children)[s];ca(i)&&e.onLinkClick(i,r)}null===(o=n.current)||void 0===o||o.dismissMenu()};r=ia(e.styles,{theme:p,linkSize:d,linkFormat:u});var D=function(){return null===(e=i)||void 0!==e&&void 0!==S.keyToIndexMapping[e]?i:S.links.length?S.links[0].itemKey:void 0;var e}(),w=D?S.keyToIndexMapping[D]:0,L=S.links.map((function(e){return P(S,e,D,r.link)})),E=k.useMemo((function(){return{items:[],alignTargetEdge:!0,directionalHint:se.A.bottomRightEdge}}),[]),A=oa({onOverflowItemsChanged:function(e,t){t.forEach((function(e){var t=e.ele,r=e.isOverflowing;return t.dataset.isOverflowing="".concat(r)})),E.items=S.links.slice(e).filter((function(e){return e.itemKey!==D})).map((function(t,o){return t.role="menuitem",{key:t.itemKey||"".concat(e+o),onRender:function(){return P(S,t,D,r.linkInMenu)}}}))},rtl:(0,G.jI)(p),pinnedIndex:w}).menuButtonRef,F=C||Qn.c;return k.createElement("div",(0,qn.__assign)({ref:t},T),k.createElement(Gt.R,(0,qn.__assign)({componentRef:o,role:"tablist"},b,{direction:zt.E.horizontal},g,{className:(0,oe.A)(r.root,null===g||void 0===g?void 0:g.className)}),L,"menu"===h&&k.createElement(F,{className:(0,oe.A)(r.link,r.overflowMenuButton),elementRef:A,componentRef:n,menuProps:E,menuIconProps:{iconName:"More",style:{color:"inherit"}},ariaLabel:m,role:"tab"})),D&&S.links.map((function(t){return(!0===t.alwaysRender||D===t.itemKey)&&function(t,o){if(e.headersOnly||!t)return null;var n=S.keyToIndexMapping[t],a=S.keyToTabIdMapping[t];return k.createElement("div",{role:"tabpanel",hidden:!o,key:t,"aria-hidden":!o,"aria-labelledby":a,className:r.itemContainer},k.Children.toArray(e.children)[n])}(t.itemKey,D===t.itemKey)})))}));pa.displayName="Pivot";var da=r(42815),ua={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text",linkInMenu:"ms-Pivot-linkInMenu",overflowMenuButton:"ms-Pivot-overflowMenuButton"},ha=function(e,t,r){var o,n,a;void 0===r&&(r=!1);var s=e.linkSize,i=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d="large"===s,u="tabs"===i;return[p.medium,{color:c.actionLink,padding:"0 8px",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:{":hover":{backgroundColor:c.buttonBackgroundHovered,color:c.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:c.buttonBackgroundPressed,color:c.buttonTextHovered},":focus":{outline:"none"}}},!r&&[{display:"inline-block",lineHeight:44,height:44,marginRight:8,textAlign:"center",selectors:(o={},o[".".concat(da.Y2," &:focus")]={outline:"1px solid ".concat(c.focusBorder)},o[".".concat(da.Y2," &:focus:after")]={content:"attr(data-content)",position:"relative",border:0},o[":before"]={backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left ".concat(W.cs.durationValue2," ").concat(W.cs.easeFunction2,",\n                        right ").concat(W.cs.durationValue2," ").concat(W.cs.easeFunction2)},o[":after"]={color:"transparent",content:"attr(data-content)",display:"block",fontWeight:W.BO.bold,height:1,overflow:"hidden",visibility:"hidden"},o)},d&&{fontSize:p.large.fontSize},u&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:c.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(n={":focus":{outlineOffset:"-2px"}},n[".".concat(da.Y2," &:focus::before")]={height:"auto",background:"transparent",transition:"none"},n["&:hover, &:focus"]={color:c.buttonTextCheckedHovered},n["&:active, &:hover"]={color:c.primaryButtonText,backgroundColor:c.primaryButtonBackground},n["&.".concat(t.linkIsSelected)]={backgroundColor:c.primaryButtonBackground,color:c.primaryButtonText,fontWeight:W.BO.regular,selectors:(a={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:c.primaryButtonBackgroundHovered,color:c.primaryButtonText},":active":{backgroundColor:c.primaryButtonBackgroundPressed,color:c.primaryButtonText}},a[W.up]=(0,qn.__assign)({fontWeight:W.BO.semibold,color:"HighlightText",background:"Highlight"},(0,W.Qg)()),a)},n[".".concat(da.Y2," &.").concat(t.linkIsSelected,":focus")]={outlineColor:c.primaryButtonText},n)}]]]},ma=(0,er.I)(pa,(function(e){var t,r,o,n,a=e.className,s=e.linkSize,i=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d=(0,W.Km)(ua,l),u="large"===s,h="tabs"===i;return{root:[d.root,p.medium,W.S8,{position:"relative",color:c.link,whiteSpace:"nowrap"},u&&d.rootIsLarge,h&&d.rootIsTabs,a],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:(0,qn.__spreadArray)((0,qn.__spreadArray)([d.link],ha(e,d),!0),[(t={},t["&[data-is-overflowing='true']"]={display:"none"},t)],!1),overflowMenuButton:[d.overflowMenuButton,(r={visibility:"hidden",position:"absolute",right:0},r[".".concat(d.link,"[data-is-overflowing='true'] ~ &")]={visibility:"visible",position:"relative"},r)],linkInMenu:(0,qn.__spreadArray)((0,qn.__spreadArray)([d.linkInMenu],ha(e,d,!0),!0),[{textAlign:"left",width:"100%",height:36,lineHeight:36}],!1),linkIsSelected:[d.link,d.linkIsSelected,{fontWeight:W.BO.semibold,selectors:(o={":before":{backgroundColor:c.inputBackgroundChecked,selectors:(n={},n[W.up]={backgroundColor:"Highlight"},n)},":hover::before":{left:0,right:0}},o[W.up]={color:"Highlight"},o)}],linkContent:[d.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[d.text,{display:"inline-block",verticalAlign:"top"}],count:[d.count,{display:"inline-block",verticalAlign:"top"}],icon:d.icon}}),void 0,{scope:"Pivot"});const ga=e=>{const{theme:{palette:t}}=e;return{root:[(0,z.gS)("row","wrap")],link:{marginRight:"8px",":last-of-type":{marginRight:"4px"},["@media (max-width: ".concat(K.B.UnoSmallScreenWidth,")")]:{margin:"0xp",width:"36px",":hover":{backgroundColor:"transparent","::before":{backgroundColor:t.neutralTertiaryAlt}}}},linkIsSelected:{"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-icon":{color:t.themePrimary},"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-text":{fontWeight:W.BO.semibold},":hover":{"::before":{backgroundColor:t.themePrimary}}},icon:{"> i":{marginTop:"5px"}},text:{marginRight:"2px",["@media (max-width: ".concat(K.B.UnoSmallScreenWidth,")")]:{display:"none"}}}},ka=e=>{const{pivotItemProps:t,onSelectPivotItem:r,selectedPivotKey:o}=e,n=(t,r)=>{if(!t||!r)return k.createElement(k.Fragment,null);const o=e.showTooltip?t.tooltipText:"";return k.createElement(po.S,{content:o,componentRef:t.tooltipRef},r(t))},a=k.useCallback(((e,t)=>{var o;if(null===t||void 0===t||t.stopPropagation(),null!=(null===e||void 0===e||null===(o=e.props)||void 0===o?void 0:o.itemKey)){const t=e.props.itemKey;r(t)}}),[r]);return k.createElement(ma,{headersOnly:!0,onLinkClick:a,styles:ga,selectedKey:o},t.map((e=>{return k.createElement(sa,{...e,key:e.itemKey,onRenderItemLink:n,headerButtonProps:{onFocus:(t=e.tooltipRef,()=>{null!==t&&void 0!==t&&t.current&&t.current.show()})},ariaLabel:e.tooltipText});var t})))},Ca=(0,V.J9)(((e,t)=>{const r={root:[(0,z.$Z)(),(0,z.gS)("row","nowrap"),{alignItems:"center","> div":(0,z.gS)()}]};return(0,W.pB)(void 0,r,t)})),ba=(0,V.J9)((e=>({root:(0,W.Zq)("planViewsPivots",e.root)})));var Ta=r(66298);const Sa=e=>{const t=(0,Bo.D)(),r=ba(Ca(t,e.styles)),{usageLogger:o}=(0,Ta.t)(),n=k.useRef(null),a=k.useRef(null),s=k.useRef(null),l=k.useRef(null),c=()=>{const{onUpsellHookClick:t,showUpsellHooks:r}=e,o=[],n=e.plan.container.containerType!==C.K.Group;return r&&(o.push({key:"AddMoreViews",name:U.p.Strings.SharedComponents_AddMoreViewsText,itemType:A.G.Header,iconProps:pe.aM}),o.push({key:i.EC.PlanTimeline,name:U.p.Strings.SharedComponents_PlanTimelinePageName,onClick:()=>t(i.EC.PlanTimeline),iconProps:pe.mF,disabled:n,canCheck:!0,checked:!1}),o.push({key:i.EC.PlanPeople,name:U.p.Strings.SharedComponents_PlanPeoplePageName,onClick:()=>t(i.EC.PlanPeople),iconProps:pe.CR,disabled:n,canCheck:!0,checked:!1}),o.push({key:i.EC.PlanGoals,name:U.p.Strings.SharedComponents_PlanGoalsPageName,onClick:()=>t(i.EC.PlanGoals),iconProps:pe.C,disabled:n,canCheck:!0,checked:!1}),o.push({key:i.EC.PlanAssignments,name:U.p.Strings.SharedComponents_PlanAssignmentsPageName,onClick:()=>t(i.EC.PlanAssignments),iconProps:pe.T6,disabled:n,canCheck:!0,checked:!1})),o},p=t=>{const{currentPage:r}=e;return t===r},d=c();return k.createElement("div",{className:r.root},k.createElement(ka,{pivotItemProps:(()=>{const e=[];return e.push({headerText:U.p.Strings.SharedComponents_PlanGridPageName,itemIcon:p(i.EC.PlanGrid)?pe.SG.iconName:pe.CY.iconName,itemKey:i.EC.PlanGrid,tooltipText:"".concat(U.p.Strings.UnoPlanHeader_View," ").concat(U.p.Strings.SharedComponents_PlanGridPageName),tooltipRef:n}),e.push({headerText:U.p.Strings.SharedComponents_PlanTaskboardPageName,itemIcon:p(i.EC.PlanTaskboard)?pe.fN.iconName:pe.fD.iconName,itemKey:i.EC.PlanTaskboard,tooltipText:"".concat(U.p.Strings.UnoPlanHeader_View," ").concat(U.p.Strings.SharedComponents_PlanTaskboardPageName),tooltipRef:a}),e.push({headerText:U.p.Strings.SharedComponents_PlanSchedulePageName,itemIcon:p(i.EC.PlanSchedule)?pe._o.iconName:pe.cx.iconName,itemKey:i.EC.PlanSchedule,tooltipText:"".concat(U.p.Strings.UnoPlanHeader_View," ").concat(U.p.Strings.SharedComponents_PlanSchedulePageName),tooltipRef:s}),e.push({headerText:U.p.Strings.SharedComponents_PlanChartsPageName,itemIcon:p(i.EC.PlanCharts)?pe.OH.iconName:pe.iH.iconName,itemKey:i.EC.PlanCharts,tooltipText:"".concat(U.p.Strings.UnoPlanHeader_View," ").concat(U.p.Strings.SharedComponents_PlanChartsPageName),tooltipRef:l}),e})(),onSelectPivotItem:t=>{const{navigateToPage:r}=e;o.logData(t,"Clicked"),r(t)},selectedPivotKey:(()=>{const{currentPage:t,plan:r}=e;if(r.container.containerType===C.K.User){return c().find((e=>e.key===t))?null:t}return t})(),showTooltip:e.showTooltip}),d.length>0&&k.createElement(de,{moreOptionsContextMenuItems:d,moreOptionsTooltip:U.p.Strings.UnoPlanHeader_MoreViews,theme:e.theme}))};var va=r(11638);const Pa=(0,V.J9)(((e,t)=>{const r={root:[(0,z.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto"}]};return(0,W.pB)(void 0,r,t)})),xa=(0,V.J9)((e=>({root:(0,W.Zq)("overflowMenu",e.root)}))),ya="bpShowMoreHeaderButton",fa=e=>{let{styles:t,theme:r,showFeedbackButton:o,onClickFeedback:n}=e;const a=(0,Bo.D)(),[s,i]=k.useState(!1),l=xa(Pa(a,t)),c=(0,k.useCallback)((()=>{if(!s)return null;const e=[{key:"help",text:U.p.Strings.PlanHeader_PlanHeaderHelp,iconProps:pe.uh,onClick:()=>{i(!1),no.b.safelyOpenExternalUrl(m.$j.plannerHelp,"_blank")}}];return o&&e.push({key:"feedback",text:U.p.Strings.UnoPlanHeader_FeedbackText,iconProps:pe.is,onClick:()=>{i(!1),n()}}),k.createElement(ie.l,{shouldFocusOnMount:!0,items:e,directionalHint:se.A.bottomAutoEdge,target:".".concat(ya),appTheme:r,onDismiss:()=>i(!1)})}),[n,r,o,s]);return k.createElement("div",{className:l.root},k.createElement(_r.K,{title:U.p.Strings.PlannerHeader_MoreAriaLabel,className:ya,iconProps:pe.uh,onClick:()=>i(!s),plannerTheme:r}),c())};var Da=r(5586),wa=r(8784);const La=(0,V.J9)(((e,t)=>{const r={root:[{border:"none",borderColor:null===e||void 0===e?void 0:e.semanticColors.buttonBorder,height:"32px",padding:"0px",".ms-Icon":{margin:"0px"},".ms-Button-textContainer":{["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{display:"none"}}}]};return(0,W.pB)(void 0,r,t)})),Ba=(0,V.J9)((e=>({root:(0,W.Zq)("diamondButton",e.root)}))),Ea=e=>{let{showTooltip:t,styles:r,showTrialStatusButton:o,showTrialStatusButtonText:n,isTrialActive:a,onClickTrialButton:s}=e;const i=(0,Bo.D)(),l=Ba(La(i,r));if(!1===o)return null;const c=t?U.p.Strings.UnoPlanHeader_TrialTooltip:"";return k.createElement(po.S,{content:c},k.createElement(wa.r,{text:n?a?U.p.Strings.UnoPlanHeader_TrialButtonTextTrialActive:U.p.Strings.UnoPlanHeader_TrialButtonText:void 0,onClick:s,className:l.root,iconProps:pe.aM,id:Da.Au}))},Aa=(0,V.J9)((e=>({root:{border:"none",background:"transparent",minWidth:"auto",padding:"0px",borderRadius:"4px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Bt.BO.regular},textContainer:{["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{display:"none !important"}}})));const Fa=r.p+"static/media/copilot-bw-16.812130a5faff946bf6cb2c019ad13537.svg",Ia=e=>{let{showCopilotButton:t,showTooltip:r,onClickCopilotButton:o}=e;const n=(0,Bo.D)();if(!1===t)return null;const a=r?U.p.Strings.UnoPlanHeader_CopilotText:"";return k.createElement(po.S,{content:a},k.createElement(va.Y,{id:"CopilotButton",text:U.p.Strings.UnoPlanHeader_CopilotText,iconProps:{imageProps:{src:Fa,width:16,height:16}},styles:Aa(n),onClick:o}))},Ma=(0,V.J9)(((e,t)=>{const r={root:[(0,z.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto",paddingLeft:"32px",columnGap:"12px"}],statusIcon:{marginRight:"12px"}};return(0,W.pB)(void 0,r,t)})),Na=(0,V.J9)((e=>({root:(0,W.Zq)("planStatusSection",e.root),statusIcon:(0,W.Zq)("statusIcon",e.statusIcon)}))),_a=(0,V.J9)((e=>({root:{border:"1px solid ".concat(e.palette.neutralTertiaryAlt),background:"transparent",minWidth:"auto",padding:"5px 8px 5px 10px",borderRadius:"4px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px 2px 4px 0px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Bt.BO.regular},textContainer:{["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",["@media (max-width: ".concat(K.B.UnoLargeScreenWidth,")")]:{display:"none !important"}}})));var Ra=r(50840);const Ua=(0,V.J9)((e=>({root:{maxWidth:"343px",padding:"20px 24px",borderRadius:"2px",background:e.palette.white},calloutMain:{background:"transparent"}}))),Ha=e=>{const t=(0,Bo.D)();return k.createElement(Ra.P,{styles:Ua(t),...e},k.createElement("div",null,U.p.Strings.UnoPlanHeader_ViewMembersDisabledInfo))},Oa="shareButtonRef",Va=e=>{let{showTooltip:t,styles:r,plan:o,openSharePlanDialog:n,canViewMembers:a,copilotButtonProps:s,premiumPlanTrialButtonProps:i,headerOverflowMenuProps:l}=e;const c=(0,Bo.D)(),[p,d]=k.useState(!1),u=Na(Ma(c,r)),h=o.id,m=o.container.containerType,g=(0,k.useCallback)((()=>{a?n(h):d(!p)}),[a,p,n,h]),b=(0,k.useCallback)((()=>{const e=t?U.p.Strings.UnoPlanHeader_ShareTooltip:"";return k.createElement("div",null,k.createElement(po.S,{content:e},k.createElement(va.Y,{text:U.p.Strings.UnoPlanHeader_ShareText,iconProps:pe.lO,menuIconProps:pe.u2,styles:_a(c),onClick:g,ariaLabel:U.p.Strings.UnoPlanHeader_ShareTooltip,className:Oa})),p&&k.createElement(Ha,{directionalHint:se.A.bottomRightEdge,isBeakVisible:!1,gapSpace:0,onDismiss:()=>d(!p),target:".".concat(Oa)}))}),[t,c,p,g]),T=(0,k.useCallback)((()=>{if(m===C.K.User)return k.createElement(po.S,{content:U.p.Strings.UnoPlanHeader_PrivatePlanStatus},k.createElement(B.I,{className:u.statusIcon,...pe.VW}))}),[m,u.statusIcon]);return k.createElement("div",{className:u.root},k.createElement(Ia,s),T(),b(),k.createElement(Ea,i),k.createElement(fa,l))},Wa="32px",Ga="58px",za=(0,V.J9)(((e,t,r)=>{const o={root:[(0,z.gS)("row","nowrap"),{backgroundColor:"inherit",marginBottom:Wa}],unoPlanHeaderLandmark:t?[(0,z.gS)("row","nowrap"),{width:"100%",boxShadow:No.f.depth4,borderBottom:"1px solid ".concat(e.palette.neutralLight)}]:[(0,z.gS)("column","nowrap"),{width:"100%"}]};return(0,W.pB)(void 0,o,r)})),Za=(0,V.J9)((e=>({root:(0,W.Zq)("unoPlanHeader",e.root),unoPlanHeaderLandmark:(0,W.Zq)("unoPlanHeaderLandmark",e.unoPlanHeaderLandmark)}))),Ka=(0,V.J9)(((e,t,r)=>{const o={root:t?[(0,z.gS)("row","nowrap"),{height:Ga,padding:"0 ".concat(Wa," 0 ").concat(Wa)}]:[(0,z.gS)("row","nowrap"),{height:Ga,padding:"0 ".concat(Wa," 0 ").concat(Wa),boxShadow:No.f.depth4,borderBottom:"1px solid ".concat(e.palette.neutralLight)}]};return(0,W.pB)(void 0,o,r)})),qa=(0,V.J9)((e=>({root:(0,W.Zq)("planHeader",e.root)}))),Ja=e=>{const t=(0,Bo.D)(),r=qa(Ka(t,e.isTeamsTabView,e.styles));return k.createElement("div",{className:r.root},k.createElement(Kn,e.planTitleSectionProps),k.createElement(Sa,e.planViewPivotsProps),e.isTeamsTabView?null:k.createElement(Va,e.planStatusSectionProps))};var ja=r(55563);const $a=e=>{const{theme:{semanticColors:t,palette:r}}=e;return{root:{background:t.menuBackground},subComponentStyles:{callout:{root:{backgroundColor:t.menuBackground,color:r.neutralPrimary,borderRadius:"2px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"},beak:{background:t.menuBackground},beakCurtain:{borderRadius:"2px",background:t.menuBackground},calloutMain:{borderRadius:"2px",backgroundColor:t.menuBackground}},menuItem:Ya}}},Ya=e=>{const{theme:{semanticColors:t,palette:r},expanded:o}=e;return{root:[o&&{backgroundColor:t.menuItemBackgroundPressed},{color:r.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:r.neutralPrimary},":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered,color:r.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:r.neutralPrimary}}}],item:{":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered},backgroundColor:t.menuBackground,marginLeft:"4px",marginRight:"4px",":first-of-type":{marginTop:"4px"},":last-of-type":{marginBottom:"6px"},"*":{boxSizing:"border-box"},button:[{borderRadius:"0px",height:"36px",width:"100%",marginBottom:"0px !important",":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered}},o&&{backgroundColor:t.menuItemBackgroundPressed}]},checkmarkIcon:{color:r.neutralPrimary},label:{color:r.neutralPrimary},icon:[{marginRight:"12px",color:r.neutralPrimary}]}},Xa=(0,V.J9)((e=>({root:{backgroundColor:e.semanticColors.menuBackground},header:[{"> .clearFilters":{color:e.palette.themePrimary},"> .filterTitle":{color:e.palette.neutralPrimary}}]}))),Qa=e=>{const t=k.useRef(),r=(0,Bo.D)(),[o,n]=k.useState(!1),a=k.useCallback((()=>{n(!o)}),[o]),s=k.useCallback((()=>{n(!1),t.current.focus()}),[]);return(()=>{const{currentTaskFilter:n,styles:i}=e;if(!n)return null;const l=n.filterCount>0?"".concat(U.p.Strings.UnoPlanHeader_Filters,"\n                    ").concat(U.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses,"\n                    ").concat(n.filterCount.toString(),"\n                    ").concat(U.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses):U.p.Strings.UnoPlanHeader_Filters,c=e.showTooltip?U.p.Strings.UnoPlanHeader_Filters:"";return k.createElement("span",{ref:t},k.createElement(po.S,{content:c},k.createElement(ja.z,{onClick:a,text:l,iconProps:pe.ao,styles:i,menuIconProps:pe.Ju}),o&&(()=>{const{members:o,theme:n,currentTaskFilter:a,taskData:i,buckets:l,planCategories:c,getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,hideSearchBox:h}=e;if(!a)return null;const m={getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,onDismiss:s};return k.createElement(Wt,{targetElement:t.current,callbacks:m,currentTaskFilter:a,taskData:i,members:null!==o&&void 0!==o?o:[],categories:c,buckets:l,theme:n,hideSearchBox:h,contextualMenuStyles:$a,styles:Xa(r)})})()))})()},es=e=>{const t=()=>{const{currentTaskGrouping:t,onGroupByChange:r}=e,o={items:[],shouldFocusOnMount:!1,directionalHint:se.A.bottomRightEdge};for(const n of e.taskGroupingOptions)isNaN(Number(n))||o.items.push({key:s.Yc[n],text:ue(n),canCheck:!0,checked:t===n,onClick:r.bind(void 0,n)});return o};return(()=>{const{taskGroupingOptions:r,currentTaskGrouping:o,onGroupByChange:n,styles:a}=e;if(!r||v()(r)||!o)return null;const i={items:[],shouldFocusOnMount:!1,directionalHint:se.A.bottomRightEdge};for(const e of r)isNaN(Number(e))||i.items.push({key:s.Yc[e],text:ue(e),canCheck:!0,checked:o===e,onClick:n.bind(void 0,e)});const l=ue(o),c=e.showTooltip?Ee.G(U.p.Strings.UnoPlanHeader_GroupByText,l):"";return k.createElement(po.S,{content:c},k.createElement(ja.z,{iconProps:pe.JW,text:Ee.G(U.p.Strings.UnoPlanHeader_GroupByText,l),menuProps:t(),menuIconProps:pe.Ju,styles:a}))})()},ts=(0,V.J9)(((e,t)=>{const r={root:[(0,z.gS)("row","nowrap"),{alignItems:"center",columnGap:"12px"}]};return(0,W.pB)(void 0,r,t)})),rs=(0,V.J9)((e=>({root:(0,W.Zq)("planActionBar",e.root)}))),os=(0,V.J9)(((e,t)=>{const r={padding:"0px",height:"32px",["@media (max-width: ".concat(K.B.UnoSmallScreenWidth,")")]:t&&{minWidth:"36px"},backgroundColor:"inherit"},o={["@media (max-width: ".concat(K.B.UnoSmallScreenWidth,")")]:t&&{display:"none"}},n={marginLeft:"0px",marginRight:"0px",["@media (max-width: ".concat(K.B.UnoSmallScreenWidth,")")]:t&&{display:"none !important"}},a={["@media (min-width: ".concat(K.B.UnoSmallScreenWidth,")")]:{background:"transparent"},color:e.palette.themePrimary},s={background:"transparent",color:e.palette.themePrimary};return{root:r,rootExpanded:t?[a]:[s],rootHovered:t?[a]:[s],rootExpandedHovered:t?[a]:[s],rootPressed:t?[a]:[s],rootFocused:t?{["@media (min-width: ".concat(K.B.UnoSmallScreenWidth,")")]:{background:"transparent"}}:{background:"transparent"},textContainer:o,menuIcon:n,icon:{color:"inherit",display:"inline-block",marginBottom:"2px"},iconPressed:{color:e.palette.themePrimary}}})),ns=e=>{const t=(0,Bo.D)(),r=rs(ts(t,e.styles));return k.createElement("div",{className:r.root},k.createElement(Qa,{taskData:e.taskData,buckets:e.buckets,planCategories:e.planCategories,currentTaskFilter:e.currentTaskFilter,setTaskFilter:e.setTaskFilter,getUserPhoto:e.getUserPhoto,onRenderPersona:e.onRenderPersona,members:e.members,theme:e.theme,styles:os(t,e.isTeamsTabView),hideSearchBox:!e.isTeamsTabView,showTooltip:e.showTooltip}),k.createElement(es,{taskGroupingOptions:e.taskGroupingOptions,currentTaskGrouping:e.currentTaskGrouping,onGroupByChange:e.onGroupByChange,styles:os(t,e.isTeamsTabView),showTooltip:e.showTooltip}))},as=e=>{const{theme:{palette:t}}=e;return{root:{minWidth:"200px",width:"280px",alignSelf:"center",border:"none",borderRadius:0,background:"transparent",borderBottom:"1px solid ".concat(t.neutralSecondaryAlt),"&.is-active":[{"::after":{border:"none",borderBottom:"2px solid ".concat(t.themePrimary),borderBottomRightRadius:"0px",borderBottomLeftRadius:"0px"}}]},icon:{color:t.neutralSecondary,marginTop:"6px"},clearButton:{},field:{color:t.neutralPrimary}}},ss=e=>{const{currentTaskFilter:t,setTaskFilter:r}=e,[o,n]=k.useState("");if(!t)return null;return k.createElement(Lt.G,{placeholder:U.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:U.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:pe._x,value:o,onChange:(e,o)=>{const a=null!==o&&void 0!==o?o:"";let s;s=""===a?t.removeFilter("title"):t.replaceFilter("title",new Tt.d("title",[a])),r(s),n(a)},styles:as})},is=(0,V.J9)(((e,t,r)=>{const o={root:t?[(0,z.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:Ga,padding:"0 ".concat(Wa," 0 ").concat(Wa),marginLeft:"auto",columnGap:"12px"}]:[(0,z.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:Ga,padding:"0 ".concat(Wa," 0 ").concat(Wa)}]};return(0,W.pB)(void 0,o,r)})),ls=(0,V.J9)((e=>({root:(0,W.Zq)("planViewHeader",e.root)}))),cs=e=>{const t=(0,Bo.D)(),r=ls(is(t,e.isTeamsTabView,e.styles));return e.isTeamsTabView?k.createElement("div",{className:r.root},k.createElement(Ia,e.copilotButtonProps),k.createElement(ns,e.planActionBarProps),k.createElement(Ea,e.premiumPlanTrialButtonProps),k.createElement(fa,e.headerOverflowMenuProps)):k.createElement("div",{className:r.root},k.createElement(ss,e.filterSearchBoxProps),k.createElement(ns,e.planActionBarProps))},ps=e=>{const t=(0,Bo.D)(),{root:r,unoPlanHeaderLandmark:o}=Za(za(t,e.isTeamsTabView));return k.createElement(Mr,{sizeClasses:[""],isAdditive:!0,className:r},k.createElement(Nr.H,{className:o,role:"banner","aria-label":""},k.createElement(Ja,e.planHeaderProps),k.createElement(cs,e.planViewHeaderProps)))},ds=(0,V.J9)(((e,t,r)=>{const o={root:[(0,z.Ph)(e,t),{"::before":[{content:"''",display:"block",width:"100%",height:"100%",position:"absolute",zIndex:"-1",top:"0",left:"0"},e===m.Sx.Light&&{background:"linear-gradient(to bottom, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.2) 50%)"},e===m.Sx.Dark&&{background:"linear-gradient(to bottom, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0.2) 50%)"}]}],planErrorView:[(0,z.Ph)(e,t),(0,z.gS)("column"),z.cc,(0,z.aS)(e),{padding:"10px","> *":{textAlign:"center"},"> .errorText":{fontSize:W.s.xxLarge,paddingTop:"48px",paddingBottom:"28px"},"> .errorSubText":[{fontSize:W.s.medium,paddingBottom:"88px"}],".buttonContainers":[(0,z.gS)("row"),z.cc,{"> .buttonContainer":{margin:"0px 10px"}}],".buttonContainer":[(0,z.gS)("row"),z.cc,{"> .redirectButton":[(0,z.jU)(e),{width:"200px",height:"38px"}]}],"> .shrug":[(0,z._D)(e),{fontSize:W.s.superLarge,lineHeight:"1"}]}],pendingView:{"> .spinner":{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"}},subComponentStyles:{topHeader:us()}};return(0,W.pB)(void 0,o,r)})),us=(0,V.J9)((()=>({root:(0,z.$Z)(K.B.TopHeaderHeight)}))),hs=(0,V.J9)((e=>({root:(0,W.Zq)("planView",e.root),planErrorView:(0,W.Zq)("planErrorView",e.planErrorView),pendingView:(0,W.Zq)("pendingView",e.pendingView)})));var ms,gs,ks=r(96481),Cs=r(62687),bs=r(97139),Ts=r(39589),Ss=r(64696),vs=r(17776),Ps=r(40468);!function(e){e[e.Invalid=0]="Invalid",e[e.Plan=1]="Plan"}(ms||(ms={})),function(e){e[e.Invalid=0]="Invalid",e[e.Excel=1]="Excel"}(gs||(gs={}));const xs=[s.Yc.Bucket,s.Yc.Assignee,s.Yc.Progress,s.Yc.DueDate,s.Yc.Category,s.Yc.Priority];s.Yc.Plan,s.Yc.Progress,s.Yc.DueDate,s.Yc.Priority,s.Yc.Plan,s.Yc.Bucket,s.Yc.Assignee,s.Yc.Progress,s.Yc.DueDate,s.Yc.Priority,s.Yc.Plan,s.Yc.Progress,s.Yc.DueDate,s.Yc.Priority;var ys=r(70252),fs=r(31408),Ds=r(81206),ws=r(91834);const Ls=r.p+"static/media/searchExclamDark.7df65dbbeef20727f66b.png",Bs=r.p+"static/media/searchExclamLight.dea5c5a45aaf17d877e4.png";var Es,As=r(10871),Fs=r.n(As),Is=r(28673),Ms=r.n(Is),Ns=r(91733),_s=r.n(Ns),Rs=r(86178),Us=r.n(Rs);function Hs(e){return Us().utc().year(e.year()).month(e.month()).date(e.date()).hour(10).minute(0).second(0).millisecond(0)}function Os(e){switch(e){case Es.Late:return Hs(Us()().subtract(1,"day"));case Es.Today:return Hs(Us()());case Es.Tomorrow:return Hs(Us()().add(1,"day"));case Es.ThisWeek:return Hs(Us()().endOf("week"));case Es.NextWeek:return Hs(Us()().add(7,"days").endOf("week"));case Es.Future:return Hs(Us()().add(7,"days").endOf("week").add(1,"day"));case Es.NoDate:default:return null}}!function(e){e[e.Late=0]="Late",e[e.Today=1]="Today",e[e.Tomorrow=2]="Tomorrow",e[e.ThisWeek=3]="ThisWeek",e[e.NextWeek=4]="NextWeek",e[e.Future=5]="Future",e[e.NoDate=6]="NoDate"}(Es||(Es={}));var Vs=r(98424),Ws=r(79537),Gs=r(74719),zs=r(99611);class Zs extends fo{getPageReadyMetaTag(){return h.B.headerlessMode?"headerless":"fullpage"}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:r,onPlanLoaded:o}=this.props;e.viewPartitionKey!==r&&(null==this.props.planStore.getPlan(r)&&(this.isPlanViewLoaded=!1),this.planViewLoadNotified=!1),this.isPlanViewLoaded&&!this.planViewLoadNotified&&(o(r),this.planViewLoadNotified=!0)}componentDidMount(){super.componentDidMount();const{viewPartitionKey:e,onPlanLoaded:t}=this.props;this.isPlanViewLoaded&&!this.planViewLoadNotified&&(t(e),this.planViewLoadNotified=!0)}checkForCriticalViewDataReady(){const{viewPartitionKey:e,bucketStore:t,planStore:r,viewStore:o,taskStore:n}=this.props,a=null!=this.getTaskboardTaskFormatData(),i=null!=n.getTasksForPlan(e),l=o.getCurrentTaskGroupingState(this.taskAccessContext)!==s.Yc.Bucket||!v()(t.getBucketsForPlan(e)),c=o.getCurrentTaskGroupingState(this.taskAccessContext)!==s.Yc.Category||null!=r.getPlanDetails(e);return!!(i&&l&&a&&c)&&(this.onViewCriticalDataFetchCompletion(),!0)}getTaskData(){var e;const{taskStore:t,viewPartitionKey:r}=this.props;return null!==(e=t.getTasksForPlan(r))&&void 0!==e?e:[]}getTaskboardTaskFormatData(){var e;const{viewPartitionKey:t,taskStore:r,viewStore:o}=this.props,n=o.getCurrentTaskGroupingState(this.taskAccessContext);return n!==s.Yc.Assignee&&n!==s.Yc.Bucket&&n!==s.Yc.Progress?[]:null!==(e=r.getTaskboardTaskFormattingForPlan(t,this.getCurrentTaskboardType()))&&void 0!==e?e:[]}getCurrentTaskboardType(){switch(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)){case s.Yc.Assignee:return ys.s.AssignedTo;case s.Yc.Bucket:return ys.s.Bucket;case s.Yc.Progress:return ys.s.Progress;default:throw new Error("NotSupportedException: invalid type")}}progressBoardValueSetter(e,t,r,o,n,a){const s=t.setProperty("percentComplete",(0,gt.BK)(r)),i=this.getOrderHintForProgressBoard(o,e),l=this.getOrderHintForProgressBoard(n,e),c=Vs.O.generateOrderHintBetween(i,l);let p=e[t.id];p||(p=bs.j.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ts._.builder.withPropertyBag({progressBoardFormat:p}).build(),h=Ts._.builder.withPropertyBag({progressBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,s,u,h)}bucketBoardValueSetter(e,t,r,o,n,a){const s=t.setProperty("bucketId",r),i=this.getOrderHintForBucketBoard(o,e),l=this.getOrderHintForBucketBoard(n,e),c=Vs.O.generateOrderHintBetween(i,l);let p=e[t.id];p||(p=vs.g.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ts._.builder.withPropertyBag({bucketBoardFormat:p}).build(),h=Ts._.builder.withPropertyBag({bucketBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,s,u,h)}assignedToBoardValueSetter(e,t,r,o,n,a){const s=t.getClone();let i,l=!1,c=null,p=null,d=e[t.id];if(d)i=d.getClone();else{d=Ss.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:void 0,orderHintsByAssignee:{}}).build();const a={};let s=null;Be()(Ms()(t.assignments),(e=>{s=Vs.O.generateOrderHintBetween(s,null),a[e]=s})),i=Ss.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:Vs.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(o,r,e),this.getOrderHintForAssigneeColumn(n,r,e)),orderHintsByAssignee:a}).build()}if(null!=a&&""!==a&&"null"!==a&&(-1!==s.getAssigneeIds().indexOf(a)&&(l=!0,c=a,delete s.assignments[a]),i.orderHintsByAssignee[a]&&delete i.orderHintsByAssignee[a]),null==r||""===r||"null"===r){if(s.getAssigneeIds().length>0){l=!0;s.getAssigneeIds().forEach((e=>{delete s.assignments[e],delete i.orderHintsByAssignee[e]}))}i=i.setProperty("orderHintsByAssignee",{}),i=i.setProperty("unassignedOrderHint",Vs.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(o,e),this.getOrderHintForUnassignedColumn(n,e)))}else-1===s.getAssigneeIds().indexOf(r)&&(l=!0,p=r,s.assignments[r]=new So.I(this.props.appContextStore.getCurrentUserId(),new Date)),i.orderHintsByAssignee[r]=Vs.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(o,r,e),this.getOrderHintForAssigneeColumn(n,r,e));const u=Ts._.builder.withPropertyBag({assignedBoardFormat:d}).build(),h=Ts._.builder.withPropertyBag({assignedBoardFormat:i}).build();l?this.updateOnTaskDragAndDrop(t,s,u,h):this.updateOnTaskDragAndDrop(t,t,u,h),this.onAssignedToCardValueSetterUpdated(t,s,c,p,r,a)}async updateOnTaskDragAndDrop(e,t,r,o){this.state.isCardChangingCompletedSection&&(t=t.toggleCompletionState());(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(To.F.builder.withTask(e).withFormatData(r).build(),To.F.builder.withTask(t).withFormatData(o).build()),this.state.isCardChangingCompletedSection&&this.setState({isCardChangingCompletedSection:!1})}getOrderHintForProgressBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForBucketBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForUnassignedColumn(e,t){return e&&t[e.id]?t[e.id].unassignedOrderHint:null}getOrderHintForAssigneeColumn(e,t,r){let o=null;if(e&&r[e.id]){var n;o=(null!==(n=r[e.id].orderHintsByAssignee)&&void 0!==n?n:{})[t]}return o||this.getOrderHintForUnassignedColumn(e,r)||""}setupCallbacks(){const{bucketStore:e,userStore:t}=this.props;this.taskCardCallbacks={onAssignTask:this.onAssignTask,getUser:t.getUserById.bind(t),getUserPhoto:t.getUserPhotoById.bind(t),getUsersWithKeyword:this.getUsersWithKeyword,getBuckets:e.getBucketsForPlan.bind(e),getAssigneePool:this.getAssigneePool,getFlights:()=>this.props.flights,getCanUserModifyAssigneePool:e=>{const t=this.props.taskStore.getTask(e);if(!t)return!1;const r=this.props.planStore.getPlan(t.planId);return null!=r&&(this.canUserAddMembers(r)||this.canUserAccessPlanViaSharedContainerOnly(t.planId))},getCanUserAccessPlanViaSharedContainerOnly:this.canUserAccessPlanViaSharedContainerOnly,onUpdateTask:this.onUpdateTask,onUpdateTaskDetails:this.onUpdateTaskDetails,getDocumentPreviewThumbnail:this.props.groupDocumentsStore.getDriveItemThumbnail.bind(this.props.groupDocumentsStore),showAssigneeLimitError:this.onShowAssigneeLimitError,openCopyTaskDialog:this.onCopyTaskClick,openMoveTaskDialog:this.onMoveTaskClick,openDeleteRecurringTaskDialog:this.onDeleteRecurringTaskClick,onCopyLinkToTask:this.onCopyLinkToTask,onRenderPersona:this.onRenderPersona,showInfoBanner:this.showInfoBanner,fetchTaskContainerPermissions:this.fetchPermissionsWithTaskContext,onOpenLink:this.context.openLinkCallback,setLabelsCollapsedState:e=>{this.onSetLabelsCollapsedStateForView(e)},alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,addUserToContainer:()=>{},getAssigneeSuggestions:()=>[],isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask}}getViewClassNames(){return hs(this.getViewStyles())}getViewStyles(){return ds(this.props.appContextStore.getCurrentTheme(),h.B.isUnoContext,this.props.styles)}getThemedPageStyles(e){if(h.B.clientType!==c.s.Plex||!this.props.flights.EnableImageRecommendations)return{};let t={};if(null!=e){const r=this.props.planStore.getPlanDetails(e);null!=(null===r||void 0===r?void 0:r.background.overlayImage)&&(t={backgroundImage:"url(".concat(r.background.overlayImage,")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",zIndex:0,position:"relative"})}return t}renderViewCommandBar(){var e,t;const{appContextStore:r,bucketStore:o,containerStore:n,getSharepointDomainUrl:a,groupDocumentsStore:d,permissionsStore:m,planStore:g,showHeader:b,tenantStore:T,userOutlookCalendarUrlToPublishTasks:S,userStore:v,viewStore:P,taskStore:x,flights:y,isSlimView:D,viewPartitionKey:w}=this.props;if(!b)return null;const L=r.getCurrentTheme(),B=null===(e=this.getViewStyles().subComponentStyles)||void 0===e?void 0:e.topHeader,E=g.getPlan(w);if(null==E)return k.createElement(bo,{theme:L,topHeaderStyles:B});const A=m.getPlanPermissions(E);let F=f.DisableNothing;A.canEdit||A.canFavorite?(!A.canEdit&&A.canFavorite||r.getClientFlavor()===l.g.TeamsPersonalApp)&&(F=f.DisablePlanChanges):F=f.DisableAll;const I=r.getClientFlavor(),M=n.getContainer(E.container.externalId),N=M?m.getContainerPermissions(M):m.getDefaultContainerPermissions(E.container),_=N.canViewMembers?this.getContainerMembers(E.container.externalId):[],R=g.getPlanDetails(w),H={title:E.title,visibleContextKeys:this.getVisibleContextKeys(),contexts:E.contexts,contextDetails:null===R||void 0===R?void 0:R.contextDetails,theme:L,planContainer:M},O=pt.U.getILabelArray((null===R||void 0===R?void 0:R.categories)||[],this.props.aggregatesStore.getLabelUsageCountsForPlan(w)).map((e=>e.name)),V=null!==(t=x.getTasksForPlan(w))&&void 0!==t?t:[];if(I===l.g.LoopSinglePlanApp){var W;const e={onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:v.getUserPhotoById.bind(v),highlightTasks:this.onHighlightTasks,onRenderPersona:this.onRenderPersona,setTaskFilter:this.onFilterChange,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onGroupByChange:this.onGroupByChange,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(E.id),onRenderPlanPhoto:async()=>{(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).ensureGroupPhotoForPlan(w)}};return k.createElement(Lo,{callbacks:e,renderContextDropdown:!0,renderMembersDropdown:null!=_,contextDropdownProps:H,imageSource:this.getPlanImage(),currentTaskFilter:P.getCurrentTaskFilter(this.taskAccessContext),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:P.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,planMembers:_,planContainer:M,planBuckets:null!==(W=o.getBucketsForPlan(w))&&void 0!==W?W:[],planCategories:O,planDetails:R,plan:E,taskData:V,disableMode:F,sharedContainersListProps:this.getSharedContainersListProps(E),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(E),sensitivityLabels:T.getCurrentSensitivityLabels(),userPermissions:m.getUserPermissions(),containerPermissions:N,flights:y,theme:L})}if(h.B.isUnoContext){var G,z,Z,K,q,J,j,$,Y;const e={};e[i.yx.GroupId]=E.container.externalId,e[i.yx.PlanId]=w;const t=I===l.g.TeamsTab,n={navigateToPage:t=>this.navigateToPage(t,e,void 0,i.jf.Other),onUpsellHookClick:e=>{this.logUsage(p.M.UpsellDialogOpenedFromViewPivots,{pageName:e}),this.openConvertPlan()},currentPage:this.name(),plan:E,showUpsellHooks:v.getCurrentUserProjectUpsellExperienceMode(null!==(G=this.props.showUpsellConversion)&&void 0!==G&&G)!==Da.M$.Disabled,showTooltip:r.getUnoCurrentPageFormFactorState()===s.qk.Tablet,theme:L},a=[];t||a.push({key:"MyPlansBreadcrumb",text:U.p.Strings.UnoPlanHeader_MyPlans,onClick:()=>this.navigateToMyPlans()},{key:"PlanTitleBreadcrumb",text:E.title,onClick:()=>this.openPlanSettingsPanel(E.id)});const c=v.getFavoritePlansMRU();let d=!1;null!=(null===c||void 0===c?void 0:c.references)&&(d=null!=c.references[w]);const h=async()=>{this.props.loggers.usageLogger.logData(d?p.M.RemoveFromFavorite:p.M.AddToFavorite,"Clicked");(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(E.id,!d);(await this.props.actionCreatorProviders.userActionCreator()).toggleUserFavoritePlanStatus(E)},m={breadcrumbItems:a,theme:L,contextDropdownProps:H,isCurrentPlanPinned:d,plan:E,imageSource:this.getPlanImage(),togglePlanPinUnpinStatus:()=>h(),isTeamsTabView:t},g=v.getCurrentUserProjectSubscriptionStatus(),b=v.getCurrentUserProjectUpsellExperienceMode(r.getFlights().EnableTryProjectFeature),S={onClickFeedback:this.onClickFeedback,showFeedbackButton:null!==(z=null===(Z=T.getCurrentTenantFeedbackSettings())||void 0===Z?void 0:Z.allowFeedback)&&void 0!==z&&z,theme:L},x=null!=g&&((0,zs.yJ)(g)||b===Da.M$.GoToProject)&&(null===(K=g.highestTrialSubscription)||void 0===K?void 0:K.eligibilityStatus)!==u.RG.Ineligible,y=null!==(q=this.props.showUpsellConversion)&&void 0!==q&&q&&b===Da.M$.OfferTrial&&(null===E||void 0===E?void 0:E.container.containerType)===C.K.Group,f=!y&&b===Da.M$.OfferTrial,D=null===g||void 0===g||null===(J=g.highestTrialSubscription)||void 0===J?void 0:J.subscriptionStatus,B=D===u.gr.InGracePeriod||D===u.gr.Disabled||D===u.gr.Deprovisioned,A={showTrialStatusButton:x||y||f,showTrialStatusButtonText:!B,isTrialActive:null!=g&&(null===(j=g.highestTrialSubscription)||void 0===j?void 0:j.subscriptionStatus)===u.gr.Active,onClickTrialButton:()=>this.onClickTrialButton(x,y,f),showTooltip:r.getUnoCurrentPageFormFactorState()!==s.qk.Desktop},F={showCopilotButton:null!==($=this.props.showCopilotUpsellExperience)&&void 0!==$&&$,onClickCopilotButton:this.onClickCopilotButton,showTooltip:r.getUnoCurrentPageFormFactorState()!==s.qk.Desktop},R={planTitleSectionProps:m,planViewPivotsProps:n,planStatusSectionProps:{plan:E,planContainer:M,planMembersCount:_.length,showTooltip:r.getUnoCurrentPageFormFactorState()!==s.qk.Desktop,openSharePlanDialog:this.openSharePlanDialog,headerOverflowMenuProps:S,premiumPlanTrialButtonProps:A,copilotButtonProps:F,canViewMembers:N.canViewMembers},isTeamsTabView:t},W={planActionBarProps:{theme:L,taskGroupingOptions:this.taskGroupingOptions,currentTaskGrouping:P.getCurrentTaskGroupingState(this.taskAccessContext),onGroupByChange:this.onGroupByChange,currentTaskFilter:P.getCurrentTaskFilter(this.taskAccessContext),taskData:V,buckets:null!==(Y=o.getBucketsForPlan(w))&&void 0!==Y?Y:[],planCategories:O,members:_,getUserPhoto:v.getUserPhotoById.bind(v),setTaskFilter:this.onFilterChange,onRenderPersona:this.onRenderPersona,isTeamsTabView:t,showTooltip:t&&r.getUnoCurrentPageFormFactorState()!==s.qk.Desktop},filterSearchBoxProps:{currentTaskFilter:P.getCurrentTaskFilter(this.taskAccessContext),setTaskFilter:this.onFilterChange},headerOverflowMenuProps:S,premiumPlanTrialButtonProps:A,isTeamsTabView:t,copilotButtonProps:F};return k.createElement(ps,{planHeaderProps:R,planViewHeaderProps:W,isTeamsTabView:t})}{var X,Q,ee;const e=I===l.g.TeamsPersonalApp||y.EnableTeamsSplitUI&&I===l.g.TeamsTab,t=h.B.clientType===c.s.Teams&&!e,n=(null===M||void 0===M?void 0:M.containerType)===C.K.Group?M:null,s=null!==(X=null===n||void 0===n?void 0:n.unifiedGroupDetails)&&void 0!==X?X:null,p=a?a(s):"",u={};u[i.yx.GroupId]=E.container.externalId,u[i.yx.PlanId]=w;const g=null===(Q=v.getUserDetailsById(r.getCurrentUserId()))||void 0===Q?void 0:Q.favoritePlans;let b=!1;null!=(null===g||void 0===g?void 0:g.references)&&(b=null!=g.references[w]);const x=async e=>{(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(E.id,e)},f={navigateToPage:e=>this.navigateToPage(e,u,void 0,i.jf.Other),onGroupByChange:this.onGroupByChange,onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,highlightTasks:this.onHighlightTasks,getBreadcrumbUrl:e=>{var t,r;return null!==(t=null===(r=d.getDriveItem(e))||void 0===r?void 0:r.url)&&void 0!==t?t:null},getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:v.getUserPhotoById.bind(v),updatePlanFavoriteStatus:x,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,setTaskFilter:this.onFilterChange,joinGroup:async()=>{(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).joinGroup(E.container.externalId)},copyLinkToPlan:async()=>{(await this.props.actionCreatorProviders.planActionCreator()).copyLinkToPlan(w)},onClickCopyPlan:e=>this.onOpenCopyPlanDialog(e),onClickExportPlanToExcel:e=>this.onExportPlanToExcel(e),onRenderPersona:this.onRenderPersona,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onRenderPlanPhoto:async()=>{(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).ensureGroupPhotoForPlan(w)},openAppAboutDialog:e?this.openTeamsAboutDialog:void 0,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(E.id)},A=v.getCurrentUserProjectUpsellExperienceMode(y.EnableTryProjectFeature),U=A!==Da.M$.Disabled,W=v.getCanCurrentUserCopyPlanToProject(y.EnableTryProjectFeature,r.getExperiment(Ds.b.UpsellImportPlan)===Ds.b.UpsellImportPlan_treatment,y.EnableImportPlanForTrialUsers,y.EnableImportPlanForProjectUsers);return k.createElement(io,{callbacks:f,currentPage:this.name(),currentTaskFilter:P.getCurrentTaskFilter(this.taskAccessContext),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:P.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,sensitivityLabels:T.getCurrentSensitivityLabels(),plan:E,planBuckets:null!==(ee=o.getBucketsForPlan(w))&&void 0!==ee?ee:[],planDetails:R,isCurrentPlanFavorite:b,flights:y,planMembers:_,planContainer:M,imageSource:this.getPlanImage(),taskData:V,userOutlookCalendarUrlToPublishTasks:null!==S&&void 0!==S?S:"",sharepointDomainUrl:null!==p&&void 0!==p?p:void 0,hideMembers:h.B.clientType===c.s.Webpart||h.B.clientType===c.s.SharepointApp||h.B.clientType===c.s.Teams||E.container.containerType===C.K.DriveItem,hideBadgeIcon:y.EnableDocumentTasks&&(null===M||void 0===M?void 0:M.containerType)===C.K.DriveItem,userPermissions:m.getUserPermissions(),containerPermissions:N,hidePlanNavLinks:!this.props.showPlanViewNavLinks,hideBreadcrumbMenu:!this.props.showPlanContext,hideTitleSection:!this.props.showPlanTitleSection,hideSecondaryLinksContextMenu:e,renderTeamsPivotSection:t,disableMode:F,planCategories:O,isSlimView:D,theme:L,styles:B,isTimelineVisible:U,showGoToProject:A===Da.M$.GoToProject,showAppLogo:y.EnableTeamsSplitUI&&I===l.g.TeamsTab,sharedContainersListProps:this.getSharedContainersListProps(E),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(E),contextDropdownProps:H,showCopyPlanToProjectLink:W})}}renderPartitionedView(e){const{viewPartitionKey:t,planStore:r}=this.props,o=r.getPlan(t),n=r.getPlanStatus(t);if(null==o)return null==n?h.B.clientType===c.s.Teams?null:this.renderSpinner():n===ws.ZB.Inaccessible?this.renderRequestAccessPermissionView(o):this.renderPlanNotFoundErrorView();if(o.isBeingCreated())return this.renderCreationInProgressView(e);const a=r.getPlanDetails(t);if(a&&n===ws.ZB.Stable){if(!Zs.openedPlans){var s;const e=Ps.T.getSortedDisplayableContexts(o,a);let t;var i;if(e.length>0)t=null!==(i=a.contextDetails[e[0].contextKey].displayAs)&&void 0!==i?i:"";const r={planId:o.id};t&&(r.displayAs=t),this.logUsage(p.M.OpenPlan,r),this.props.loggers.traceLogger.logTrace(508065228,ao.k.Info,"Open Plan Info,\n                        [containerType=".concat(null===o||void 0===o?void 0:o.container.containerType,"]\n                        [creationProcessType=").concat(null===o||void 0===o||null===(s=o.creationProcessInfo)||void 0===s?void 0:s.processType,"]")),Zs.openedPlans=!0}}else Zs.openedPlans=!1;return this.isPlanViewLoaded=!0,this.renderPlanView()}renderRequestAccessPermissionView(e){var t,r;if(null==this.props.getSharepointDomainUrl)return null;const o=e?null===(t=this.props.containerStore.getContainer(e))||void 0===t?void 0:t.unifiedGroupDetails:null,n=this.props.getSharepointDomainUrl(o),a=!!e&&(null===(r=this.props.containerStore.getContainer(null!==e&&void 0!==e?e:""))||void 0===r?void 0:r.containerType)===C.K.Group&&!!o&&!!n,l=h.B.clientType===c.s.Plex,p=U.p.Strings.Errors_AskForAccessText,d=U.p.Strings.Errors_UnauthorizedAccessErrorSubTitle;return k.createElement(Nr.H,{className:this.getViewClassNames().planErrorView,role:"main"},k.createElement("div",{className:"shrug","aria-label":U.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),k.createElement("div",{className:"errorText",tabIndex:0,"aria-label":p},p),a&&k.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":d},d),k.createElement("div",{className:"buttonContainers"},a&&k.createElement("div",{className:"buttonContainer"},k.createElement(E.j,{className:"redirectButton",onClick:()=>{this.logUsage("requestGroupAccess",{groupId:e||""}),no.b.safelyOpenExternalUrl(Ee.G(s.Lf.SharepointSiteUrlFormat,n,e),"_blank")}},U.p.Strings.Errors_UnauthorizedAccessErrorButtonText)),l&&k.createElement("div",{className:"buttonContainer"},k.createElement(E.j,{className:"redirectButton",onClick:()=>this.navigateToPage(i.EC.PlanHub,{},void 0,i.jf.Other)},U.p.Strings.Errors_PlanNotFoundButtonText))))}renderPlanNotFoundErrorView(){return h.B.isUnoContext?this.renderUnoPlanNotFoundErrorView():this.renderPlanErrorView(U.p.Strings.Errors_PlanNotFoundErrorText,U.p.Strings.Errors_PlanNotFoundErrorBody)}renderCreationInProgressView(e){return k.createElement(Co,{theme:e,onClickNavigateToHub:()=>this.navigateToPage(i.EC.PlanHub,{},!1,i.jf.Other)})}renderUnoPlanNotFoundErrorView(){const{appContextStore:e}=this.props,t=e.getClientFlavor(),r=U.p.Strings.Errors_UnoPlanNotFoundErrorText,o=t===l.g.TeamsTab?U.p.Strings.Errors_PlanNotFoundErrorBody:U.p.Strings.Errors_UnoPlanNotFoundErrorBody;let n;switch(e.getCurrentTheme()){case m.Sx.Dark:case m.Sx.LoopDark:case m.Sx.LoopWorkspaceDark:case m.Sx.TeamsContrast:case m.Sx.TeamsDark:n=Ls;break;case m.Sx.Light:case m.Sx.LoopLight:case m.Sx.LoopWorkspaceLight:case m.Sx.TeamsLight:case m.Sx.SharePoint:default:n=Bs}return k.createElement(Nr.H,{className:this.getViewClassNames().planErrorView,role:"main"},k.createElement("div",{className:"errorImage"},k.createElement("img",{src:n,alt:""})),k.createElement("div",{className:"errorText",tabIndex:0},r),k.createElement("div",{className:"errorSubText",tabIndex:0},o),t!==l.g.TeamsTab&&k.createElement("div",{className:"buttonContainer"},k.createElement(E.j,{className:"redirectButton",onClick:()=>this.navigateToPage(i.EC.PlanHub,{},void 0,i.jf.Other)},U.p.Strings.Errors_UnoPlanNotFoundButtonText)))}renderPlanErrorView(e,t){const r=h.B.clientType===c.s.Plex;return k.createElement(Nr.H,{className:this.getViewClassNames().planErrorView,role:"main"},k.createElement("div",{className:"shrug","aria-label":U.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),k.createElement("div",{className:"errorText",tabIndex:0,"aria-label":e},e),k.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":t},t),r&&k.createElement("div",{className:"buttonContainer"},k.createElement(E.j,{className:"redirectButton",onClick:()=>this.navigateToPage(i.EC.PlanHub,{},void 0,i.jf.Other)},U.p.Strings.Errors_PlanNotFoundButtonText)))}renderSpinner(){return k.createElement("div",{className:this.getViewClassNames().pendingView},k.createElement("div",{className:"spinner"},k.createElement(lo.y,{size:co.H.large})))}getSharedContainersListProps(e){const{appContextStore:t,groupDocumentsStore:r}=this.props;return(0,Gs.qg)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>r.getDriveItemStatus(e),getDriveItem:e=>r.getDriveItem(e)},t.getCurrentTheme(),this.props.loggers.traceLogger)}getHasAccessViaSharedContainer(e){const{groupDocumentsStore:t}=this.props;return(0,Gs.NL)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>t.getDriveItemStatus(e)})}onAssignedToCardValueSetterUpdated(e,t,r,o,n,a){}constructor(){super(...arguments),this.isPlanViewLoaded=!1,this.planViewLoadNotified=!1,this.taskAccessContext=Cs.t.Plan,this.taskGroupingOptions=xs,this.usageloggingConstant=p.M.PlanViewComponent,this.isGroupMember=null,this.loggedUnbucketedTasks=!1,this.categoryBoardValueSetter=(e,t,r,o,n)=>{let a=e.getClone(),s=!1;if(null!=n&&"null"!==n){const e=parseInt(n,10),t=a.appliedCategories.indexOf(e);-1!==t&&(s=!0,a.appliedCategories.splice(t,1),this.props.loggers.usageLogger.logData(this.usageloggingConstant,p.M.RemoveLabelFromTask))}if(null==t||"null"===t)a.appliedCategories.length>0&&(s=!0,a=a.setProperty("appliedCategories",[]),this.props.loggers.usageLogger.logData(this.usageloggingConstant,p.M.RemoveLabelFromTask));else{const e=parseInt(t,10);-1===a.appliedCategories.indexOf(e)&&(s=!0,a.appliedCategories.push(e),this.props.loggers.usageLogger.logData(this.usageloggingConstant,p.M.AddLabelToTask,{isNewLabel:String(e>5)}))}s&&this.updateOnTaskDragAndDrop(e,a)},this.dueDateBoardValueSetter=(e,t,r,o,n)=>{if((null===t||void 0===t?void 0:t.toString())!==(null===n||void 0===n?void 0:n.toString())){var a;const r=Os(t);null==r&&null!==(a=e.recurrence)&&void 0!==a&&a.isActive()&&this.logUsage(p.M.RecurrenceCanceledDueDate);const o=e.setDueDate(r);this.updateOnTaskDragAndDrop(e,o)}},this.priorityBoardValueSetter=(e,t,r,o,n)=>{if((null===t||void 0===t?void 0:t.toString())!==(null===n||void 0===n?void 0:n.toString())){const r=e.setProperty("priority",(0,gt._d)(t));this.updateOnTaskDragAndDrop(e,r)}},this.completedSectionValueSetter=(e,t)=>{t!==this.completedTaskClassifier(e)&&this.setState({isCardChangingCompletedSection:!0})},this.canUserAddMembers=e=>{const{containerStore:t,permissionsStore:r}=this.props,o=t.getContainer(e.container.externalId);return(o?r.getContainerPermissions(o):r.getDefaultContainerPermissions(e.container)).canAddMembers},this.getTaskHighlightedType=e=>{const t={assigneeHighlighted:!1,wywaBorderHighlighted:this.props.wywaStore.isModifiedTask(e.id),wywaAnimated:this.props.wywaStore.isModifiedTask(e.id)&&this.props.wywaStore.getAnimatedModifiedTasks()};if(this.state.highlightField===s.JS.Assignee){const r=this.state.highlightValue;null!=e.assignments[r]&&(t.assigneeHighlighted=!0)}else t.assigneeHighlighted=!1;return t},this.onOpenCopyPlanDialog=async e=>{this.props.loggers.usageLogger.logData(this.usageloggingConstant,p.M.CopyPlanDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyPlan(e)},this.onCreateTask=async(e,t,r,o)=>{let n,a,i;const l=this.getTaskboardTaskFormatData(),c=Fs()(l,"id"),p=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(p){case s.Yc.Bucket:e=e.setProperty("bucketId",t),a=vs.g.builder.withPropertyBag({id:e.id,orderHint:Vs.O.generateOrderHintBetween(this.getOrderHintForBucketBoard(r,c),this.getOrderHintForBucketBoard(o,c))}).build();break;case s.Yc.Assignee:null!=t&&(e.assignments[t]=new So.I(this.props.appContextStore.getCurrentUserId(),new Date)),n=Ss.x.builder.withPropertyBag({id:e.id,unassignedOrderHint:Vs.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(r,c),this.getOrderHintForUnassignedColumn(o,c)),orderHintsByAssignee:_s()(e.assignments,((e,t)=>Vs.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(r,t,c),this.getOrderHintForAssigneeColumn(o,t,c))))}).build();break;case s.Yc.Progress:e=e.setProperty("percentComplete",(0,gt.BK)(t)),i=bs.j.builder.withPropertyBag({id:e.id,orderHint:Vs.O.generateOrderHintBetween(this.getOrderHintForProgressBoard(r,c),this.getOrderHintForProgressBoard(o,c))}).build();break;case s.Yc.Category:null!=t&&(e=e.setProperty("appliedCategories",[t]));break;case s.Yc.DueDate:e=e.setDueDate(Os(t));break;case s.Yc.Priority:e=e.setProperty("priority",(0,gt._d)(t));break;case s.Yc.Plan:case s.Yc.None:break;default:return void Ws.f.unreachableCase(p,(e=>{this.props.loggers.traceLogger.logTrace(508065227,ao.k.Error,e)}))}const d=Ts._.builder.withPropertyBag({assignedBoardFormat:n,bucketBoardFormat:a,progressBoardFormat:i}).build();(await this.props.actionCreatorProviders.taskActionCreator()).createTask(To.F.builder.withTask(e).withFormatData(d).build())},this.onAddUserToContainer=async e=>{const t=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null!=(null===t||void 0===t?void 0:t.container)){(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.container)}},this.onRemoveUserFromPlan=async e=>{const{actionCreatorProviders:t,planStore:r,containerStore:o,viewPartitionKey:n}=this.props;if(null==e)return;const a=r.getPlan(n);if(null==a)return;const s=o.getContainer(a.container.externalId),i=s?this.getContainerMembers(s.externalId):[];let l=!1;for(let c=0;c<i.length;c++)if(i[c].id===e){l=!0;break}if(l)if(e===this.props.appContextStore.getCurrentUserId()){(await t.dialogActionCreator()).openLeavePlanDialog(a.id)}else{(await t.userActionCreator()).removeUserFromContainer(e,a.container)}},this.onHighlightTasks=async(e,t)=>{if(h.B.clientType!==c.s.Loop){(await this.props.actionCreatorProviders.wywaActionCreator()).setAnimateModifiedTasks(!1)}this.setState((r=>r.highlightField!==e||r.highlightValue!==t?{highlightField:e,highlightValue:t}:{highlightField:null,highlightValue:null}))},this.onExportPlanToExcel=async e=>{(await this.props.actionCreatorProviders.exportActionCreator()).requestExportOperation(e,gs.Excel,ms.Plan)},this.onGetAssigneeSuggestion=(e,t)=>{var r;const o=null===(r=this.props.assigneeSuggestionStore)||void 0===r?void 0:r.getAssigneeSuggestions(e,null!=t?this.props.taskStore.getSimilarTasks(t):[]);if(null!=o){const e=[];for(const t of o){const r=this.props.userStore.getUserById(t.userId);null!=r&&e.push(new fs.D(r,t.context,t.weight))}return e}return[]},this.getContainerMembers=e=>{var t;return null!==(t=this.props.userStore.getContainerUsers(e))&&void 0!==t?t:[]},this.onAddMember=async e=>{const t=this.getPlanContainer();if(null==t)return;(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.id)},this.getPlanContainer=()=>{const{viewPartitionKey:e,planStore:t,containerStore:r}=this.props,o=t.getPlan(e);return o&&r.getContainer(o.container.externalId)},this.canUserBeRemovedFromContainer=e=>{const t=this.getPlanContainer(),r=t?this.getContainerMembers(t.externalId):[];if((null===t||void 0===t?void 0:t.containerType)===C.K.Roster)return r.length>1;if((null===t||void 0===t?void 0:t.containerType)!==C.K.Group)return!1;const o=t;if(!o.unifiedGroup||!o.unifiedGroupDetails||!o.unifiedGroupDetails.owners)return!1;const n=o.unifiedGroupDetails.owners.length>1;return!(-1!==br()(o.unifiedGroupDetails.owners,(t=>t.id===e))&&!n)},this.onPlanTitleClick=e=>{const{viewPartitionKey:t,planStore:r,containerStore:o}=this.props,s=r.getPlan(t);if(null==s)return;const i=o.getContainer(s.container.externalId),l=i?this.getContainerMembers(i.externalId):[],c=y(a.getLinksCapabilitiesForPlan(i,l.length,s.container.containerType,this.getHasAccessViaSharedContainer(s)),n.EnableSettings);this.getPlanHeaderDisableMode(s)===f.DisableNothing&&c&&this.openPlanSettingsPanel(t,e)},this.openPlanSettingsPanel=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPlanSettingsPanel(e,t)},this.navigateToMyPlans=async()=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(i.EC.PlanHub,{})},this.openConvertPlan=()=>{var e,t;null===(e=(t=this.props).openConvertPlanModal)||void 0===e||e.call(t)},this.openLeavePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openLeavePlanDialog(e)},this.getPlanHeaderDisableMode=e=>{const{permissionsStore:t,appContextStore:r}=this.props,o=t.getPlanPermissions(e);let n=f.DisableNothing;return o.canEdit||o.canFavorite?(!o.canEdit&&o.canFavorite||r.getClientFlavor()===l.g.TeamsPersonalApp)&&(n=f.DisablePlanChanges):n=f.DisableAll,n},this.openPlanTasksICalendarDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPublishTasksToCalenderDialog(e)},this.openTeamsAboutDialog=async()=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openTeamsAboutDialog()},this.openSharePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openSharePlanDialog(e,[])},this.onClickTrialButton=async(e,t,r)=>{var o,n;if(e)null===(o=(n=this.props).openUpsellStatusModal)||void 0===o||o.call(n);else if(t){var a,s;null===(a=(s=this.props).openConvertPlanModal)||void 0===a||a.call(s)}else if(r){var i,l;null===(i=(l=this.props).openTryPremiumModal)||void 0===i||i.call(l,Da.vR.Header)}},this.onClickCopilotButton=async()=>{var e,t,r,o;const{userStore:n,permissionsStore:a}=this.props;switch(n.p3TrialEligibilityStatus()){case u.RG.EligibleForSelfService:return void(null===(e=(t=this.props).openCopilotUpsellModal)||void 0===e||e.call(t));case u.RG.EligibleToRequestOnly:return void(null===(r=(o=this.props).openRequestPremiumLicenseModal)||void 0===r||r.call(o))}const s=n.getCurrentUserProjectSubscriptionStatus(),i=s&&(0,zs.yJ)(s),l=a.canAccessCopilot();var c,p,d,h;i||!i&&l?null===(c=(p=this.props).openCopilotUpsellModal)||void 0===c||c.call(p):null===(d=(h=this.props).openGetSubscriptionCallout)||void 0===d||d.call(h)},this.onClickFeedback=async()=>{var e,t;null===(e=(t=this.props).openInAppFeedback)||void 0===e||e.call(t)},this.getPlanImage=()=>{const{planStore:e,containerStore:t,viewPartitionKey:r}=this.props,o=e.getPlan(r);if(null==o)return null;const n=e.getPlanDetails(r);return(0,Ae.R6)(o,n,t.getContainerPhotoById.bind(t))},this.getBadgeIconAriaLabel=()=>{const{flights:e}=this.props,t=this.getPlanContainer();let r;if(e.EnableDocumentTasks&&(null===t||void 0===t?void 0:t.containerType)===C.K.DriveItem)r=U.p.Strings.PlanHeader_BadgeIconTextDocumentPlan;else if((null===t||void 0===t?void 0:t.containerType)===C.K.Group){const e=t;r=e.unifiedGroup?e.unifiedGroup.visibility===T.X.Public?U.p.Strings.PlanHeader_BadgeIconTextPublicPlan:U.p.Strings.PlanHeader_BadgeIconTextPrivatePlan:void 0}else(null===t||void 0===t?void 0:t.containerType)===C.K.Roster&&this.getVisibleContextKeys().length>0&&(r=U.p.Strings.PlanHeader_BadgeIconTextRosterPlan);return r},this.getVisibleContextKeys=()=>{const{viewPartitionKey:e,planStore:t}=this.props,r=t.getPlan(e),o=t.getPlanDetails(e),n=[];for(const a in null===o||void 0===o?void 0:o.contextDetails)null!==o&&void 0!==o&&o.contextDetails[a].isVisible()&&null!=(null===r||void 0===r?void 0:r.contexts[a])&&n.push(a);return n},this.renderUncategorizedBucketHeaderImage=()=>k.createElement(po.S,{content:U.p.Strings.Bucket_NullBucketInfoIconText},k.createElement(B.I,{...pe.an,"aria-label":U.p.Strings.Bucket_NullBucketInfoIconText,"aria-hidden":"false"}))}}Zs.contextType=ks.Do,Zs.openedPlans=!1;var Ks,qs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Js=function(){return Js=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Js.apply(this,arguments)};!function(e){e[e.Board=0]="Board",e[e.List=1]="List"}(Ks||(Ks={}));var js=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.boardViewUlElementRef=k.createRef(),o.dragToScrollData={isDragging:!1,initialScrollValue:0},o.onPointerDown=function(e){o.props.enableDragToScroll&&o.boardViewUlElementRef.current&&e.target instanceof HTMLElement&&e.target.dataset.canDragToScroll&&"mouse"===e.pointerType&&0===e.button&&(o.boardViewUlElementRef.current.setPointerCapture(e.pointerId),o.dragToScrollData={isDragging:!0,initialScrollValue:o.boardViewUlElementRef.current.scrollLeft+e.clientX})},o.onPointerMove=function(e){o.dragToScrollData.isDragging&&o.boardViewUlElementRef.current&&e.clientX&&(e.preventDefault(),o.boardViewUlElementRef.current.scrollLeft=o.dragToScrollData.initialScrollValue-e.clientX)},o.onPointerUp=function(e){var t;null===(t=o.boardViewUlElementRef.current)||void 0===t||t.releasePointerCapture(e.pointerId),o.dragToScrollData.isDragging=!1},o.state={placeholderIndex:null,draggedColumnIndex:null},o._previousPointerPosition=null,o}return qs(t,e),t.prototype.name=function(){return"BoardView"},t.prototype.renderComponent=function(){var e=this,t=this.props.columnDefinitions.map((function(t,r){return e.renderBoardViewColumn(t,r)}));if(this.props.isOver&&null!=this.state.placeholderIndex&&t.splice(this.state.placeholderIndex,0,k.createElement("li",{key:"placeholderColumn","data-dnd-role":"placeholder",className:this.props.placeholderColumnClassName})),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");var r=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null;return this.props.connectDropTarget(k.createElement("div",{className:this.props.boardViewClassName},this.renderDragPreviews(),k.createElement("ul",Js({ref:this.boardViewUlElementRef},r),t,this.props.columnCreationEnabled?this.renderAddColumnControl():null)))},t.prototype.boardCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.boardTarget=function(){return{drop:function(e,t,r){var o=r,n=o.props.callbacks.onColumnDrop;if(n){var a=o.state.placeholderIndex;if(null==t)throw new Error("monitor not defined");var s=t.getItem(),i=a===s.props.index+1?a-2:a-1,l=a===s.props.index&&s.props.index===o.props.columnDefinitions.length-1,c=o.props.columnDefinitions[a]&&!l?o.props.columnDefinitions[a].pivotValue:null,p=o.props.columnDefinitions[i]?o.props.columnDefinitions[i].pivotValue:null;n(s.props.pivotValue,p,c)}},hover:Fr()((function(e,t,r){if(null==t)throw new Error("monitor not defined");var o=r,n=t.getClientOffset(),a=o.state.placeholderIndex;if(null!=n){var s=o.getDisplayMode()===Ks.List?n.y:n.x,i=null===o._previousPointerPosition?0:s-o._previousPointerPosition;o._previousPointerPosition=s;var l=document.elementFromPoint(n.x,n.y);if(null!==(l=o.findTarget(l))){var c=parseInt(l.getAttribute("data-index")||"",10),p=l.getBoundingClientRect().top+l.getBoundingClientRect().bottom,d=l.getBoundingClientRect().left+l.getBoundingClientRect().right,u=s-(o.getDisplayMode()===Ks.List?p:d)/2>=0;if((null===a||Math.abs(c-a)>1)&&u&&(c+=1),a===c&&(c+=1),!(i<0&&c===a+1||i>0&&c===a-1||0===i&&null!==a)&&null!==c&&c!==a){var h=t.getItem();o.setPlaceholder(c,h.props.index)}}}}),50)}},t.prototype.findTarget=function(e){return null==e||"placeholder"===e.getAttribute("data-dnd-role")?null:("column"===e.getAttribute("data-dnd-role")||(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({placeholderIndex:e,draggedColumnIndex:t})},t.prototype.renderDragPreviews=function(){return null},t.prototype.renderAddColumnControl=function(){return null},t.prototype.getDisplayMode=function(){return this.props.displayMode||Ks.Board},t}(g.$),$s=r(46646),Ys=r(11034),Xs=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Qs=function(e){function t(t,r){return e.call(this,t,r)||this}return Xs(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource?this.props.connectDragSource(k.createElement("li",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column"},this.renderColumnHeader(),this.renderColumnBody())):null},t.prototype.columnSource=function(){return{beginDrag:function(e){return{props:e}},canDrag:function(e){return!0!==e.disableDrag}}},t.prototype.columnCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource()}},t.prototype.name=function(){return"BoardColumn"},t}(g.$),ei=r(75886),ti=r(11079),ri=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),oi=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o._previousPointerYPosition=null,o}return ri(t,e),t.prototype.renderComponent=function(){var e=this,t=this.renderSectionToggle(),r=this.renderAddButton(),o=this.props.data.map((function(t,r){return e.renderEntityCard(t,r)})),n=this.props.isOver?this.state.placeholderIndex:null;if(null!=n&&o.splice(n,0,k.createElement("div",{style:{position:"relative"},key:"placeholder",className:this.props.placeholderCardClassName,"data-dnd-role":"placeholder"},k.createElement("div",{style:{opacity:0,visibility:"hidden"}},this.renderEntityCard(this.props.isOver?this.state.draggedEntity:null,null)))),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");return this.props.connectDropTarget(k.createElement("div",{className:this.props.columnGroupClassName,"data-dnd-role":"columnGroup"},this.props.isCollapsable?t:null,k.createElement("div",{"data-dnd-role":"topDropZone",className:this.props.topDropZoneClassName},null!=this.props.callbacks.addCardControlProvider?r:null),k.createElement("ul",{className:this.state.showSection?void 0:"hidden"},null!=this.props.callbacks.addCardControlProvider&&this.state.showAddEntityCard?this.renderAddCardControl():null,o),this.state.showSection?k.createElement("div",{"data-dnd-role":"bottomDropZone",className:this.props.bottomDropZoneClassName}):null))},t.prototype.groupTarget=function(){return{drop:function(e,t,r){var o=r,n=o.props.callbacks.valueSetter,a=o.state.placeholderIndex;if(o.onDrop(o.props,t,r),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var s=t.getItem(),i=s.sourceColumnValue===o.props.columnValue&&s.secondaryGrouping===o.props.secondaryGrouping,l=void 0;l=i&&a===s.index+1?a-2:a-1;var c=!1;i&&(c=a===s.index&&s.index===o.props.data.length-1);var p=o.props.data[a]&&!c?o.props.data[a]:null,d=o.props.data[l]?o.props.data[l]:null,u=o.props.callbacks.secondaryValueSetter;u&&u(s.entity,o.props.secondaryGrouping,s.secondaryGrouping),n(s.entity,d,p,s.sourceColumnValue)}},hover:Fr()((function(e,t,r){var o=r;if(o.onHover(e,t,r),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var n=t.getItem(),a=t.getClientOffset();if(null==a)return;var s=null===o._previousPointerYPosition?0:a.y-o._previousPointerYPosition;o._previousPointerYPosition=a.y;var i=document.elementFromPoint(a.x,a.y);if((i=o.findTarget(i))&&"topDropZone"===i.getAttribute("data-dnd-role")&&o.setPlaceholder(0,n),i&&"bottomDropZone"===i.getAttribute("data-dnd-role")&&o.setPlaceholder(o.props.data.length,n),i&&"card"===i.getAttribute("data-dnd-role")){var l=a.y-(i.getBoundingClientRect().top+i.getBoundingClientRect().bottom)/2<=0,c=parseInt(i.getAttribute("data-index")||"",10),p=o.state.placeholderIndex;if((null===p||Math.abs(c-p)>1)&&!l&&(c+=1),p===c&&(c+=1),s<0&&c===p+1||s>0&&c===p-1||0===s&&null!==o.state.placeholderIndex)return;o.setPlaceholder(c,n)}i&&"sectionToggle"===i.getAttribute("data-dnd-role")&&(!1===o.state.showSection&&o.setState({showSection:!0}),o.setPlaceholder(0,n))}}),50)}},t.prototype.groupCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardColumnGroup"},t.prototype.findTarget=function(e){if(null==e)return null;var t=e.getAttribute("data-dnd-role");return"placeholder"===t?null:("card"===t||"columnGroup"===t||"sectionToggle"===t||null===t&&(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({draggedEntity:t.entity,placeholderIndex:e})},t.prototype.renderSectionToggle=function(){return k.createElement("div",{className:"sectionToggle","data-dnd-role":"sectionToggle",onClick:this.toggleShowSection.bind(this)},k.createElement("div",{className:"icon"},k.createElement(B.I,{iconName:"ChevronDown",className:this.state.showSection?"rotated":"straight"})),k.createElement("div",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),k.createElement("div",{className:"sectionItemCount"},this.props.data.length),k.createElement("div",{className:"labelSpacer"}))},t.prototype.renderAddButton=function(){return k.createElement("div",{className:"addButtonContainer"},k.createElement("button",{className:"addButton",onClick:this.toggleAddCardControl.bind(this)},k.createElement(B.I,{iconName:"Add"})),k.createElement("div",{className:"labelSpacer"}))},t.prototype.toggleAddCardControl=function(){this.props.callbacks.addCardControlProvider&&this.setState({showAddEntityCard:!this.state.showAddEntityCard})},t.prototype.toggleShowSection=function(){!0===this.props.isCollapsable&&this.setState({showSection:!this.state.showSection})},t.prototype.onDrop=function(e,t,r){},t.prototype.onHover=function(e,t,r){},t}(g.$),ni=r(79966);const ai="44px",si="15px",ii="12px",li="30px",ci="32px",pi=K.B.ShadowMargin,di="4px",ui="5px",hi="288px",mi="260px",gi=(0,V.J9)((e=>{let t;switch(e){case m.Sx.LoopLight:t={boxShadow:K.B.LoopLightRestShadow,backgroundColor:Z.z.White,":hover":{backgroundColor:Z.z.NeutralLightGrey96,boxShadow:K.B.LoopLightHoverShadow},":active":{backgroundColor:Z.z.NeutralLightGrey96,boxShadow:K.B.LoopLightRestShadow}};break;case m.Sx.LoopDark:t={boxShadow:K.B.LoopDarkRestShadow,backgroundColor:Z.z.NeutralDarkGrey20,":hover":{backgroundColor:Z.z.NeutralDarkGrey24,boxShadow:K.B.LoopDarkHoverShadow},":active":{backgroundColor:Z.z.NeutralDarkGrey24,boxShadow:K.B.LoopDarkRestShadow}}}return t})),ki=(0,X.vb)((0,X.jz)(hi)+(0,X.jz)(K.B.ScrollbarSpaceAround)),Ci=(0,V.J9)(((e,t,r,o,n)=>{let a="0 ".concat(si);switch(e){case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:n||o||(a="0 ".concat(li," 0 0"));break;case m.Sx.LoopLight:case m.Sx.LoopDark:a="0 ".concat(ii);case m.Sx.Light:case m.Sx.Dark:case m.Sx.SharePoint:}return[(0,z.gS)("column"),e===m.Sx.SharePoint&&{outline:"none"},t===Ks.Board&&[{padding:a},e===m.Sx.SharePoint&&{"&:nth-child(1)":{paddingLeft:"0px"},"&:nth-last-child(1)":{paddingRight:"0px"}}],t===Ks.List&&{display:"table"},{boxSizing:"contentBox","> .columnContent":[(0,z.gS)("column"),(0,z.GD)("100%"),{marginLeft:"-".concat(pi),marginRight:"-".concat(pi)}]},r&&{".columnContent":[{overflowX:"hidden",overflowY:"auto"}]}]})),bi=(0,V.J9)((e=>{let t=hi;switch(e){case m.Sx.LoopLight:case m.Sx.LoopDark:t=mi;case m.Sx.Light:case m.Sx.Dark:case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:case m.Sx.SharePoint:}return{paddingLeft:pi,paddingRight:pi,"> .columnHeaderTitle":[(0,z.$Z)(),(0,z.gS)(),{width:t}]}})),Ti=(0,V.J9)(((e,t)=>[(0,z.GD)(),(0,z.gS)(),(0,z.q0)(),(0,z.aS)(e),{height:ci,lineHeight:ci,margin:"0px -".concat(ui),fontSize:W.s.medium,fontWeight:W.BO.semibold,"> *":{margin:"0px ".concat(ui)},"> .columnTitle":[(0,z.GD)(),(0,z.gS)(),{cursor:t?"default":"pointer",".plannerIcon":{display:"none"},"> h3":[z.xK,(0,z.GD)(),(0,z.q0)()]}],"> .editColumnTextField":[(0,z.GD)(),{".ms-TextField-field":{paddingLeft:"10px"}}]},(e===m.Sx.LoopLight||e===m.Sx.LoopDark)&&{paddingTop:K.B.ShadowMargin}])),Si=e=>{switch(e){case m.Sx.Light:return Z.z.NeutralLighter;case m.Sx.TeamsLight:return Z.z.NeutralLight;case m.Sx.Dark:case m.Sx.TeamsDark:return Z.z.DarkThemeAppBackgroundColor;case m.Sx.TeamsContrast:return Z.z.Black;case m.Sx.SharePoint:return Z.z.SharepointAddTaskButtonBackgroundColor();case m.Sx.LoopLight:return Z.z.NeutralLighter;case m.Sx.LoopDark:return Z.z.DarkThemeAppBackgroundColor;default:return""}},vi=(0,V.J9)((e=>{const t={root:{margin:"".concat(di," 0px"),position:"relative",width:"100%","&.ui-draggable-dragging":{opacity:"0.75"}},preview:{width:hi}};return(0,W.TW)(t,e)})),Pi=(0,V.J9)((e=>{const t=vi(e);return{root:(0,W.Zq)("taskBoardCard",t.root),preview:(0,W.Zq)("taskBoardCardPreview",t.preview)}}));var xi=r(17961),yi=r.n(xi),fi=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Di=function(e){function t(t,r){return e.call(this,t,r)||this}return fi(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource&&this.props.connectDropTarget?this.props.connectDragSource(this.props.connectDropTarget(k.createElement("div",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":"card","aria-posinset":this.props.taskBoardCardPositionInColumnGroup,"aria-setsize":this.props.totalTasksInColumnGroup},this.cardRenderer()))):null},t.prototype.cardSource=function(){return{beginDrag:function(e){return{entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping}}}},t.prototype.cardTarget=function(){return{drop:this.onDrop.bind(this)}},t.prototype.cardCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}},t.prototype.cardTargetCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardCard"},t}(g.$),wi=r(64226);const Li=k.createContext({isLabelCollapsed:!1});var Bi=r(10859),Ei=r(9100),Ai=r(15987),Fi=function(){return Fi=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Fi.apply(this,arguments)},Ii=function(e){return k.createElement(wa.r,Fi({"aria-label":e.ariaLabel,tabIndex:e.isKeyboardFocusable?0:-1,"data-is-focusable":e.isKeyboardFocusable,title:e.ariaLabel},e),e.label)},Mi=r(51129);const Ni="6px",_i="12px",Ri="16px",Ui="16px",Hi="18px",Oi="10px",Vi="236px",Wi=(0,X.vb)((0,X.jz)(Vi)-(0,X.jz)(Hi)),Gi="20px",zi="2px",Zi="8px",Ki="2px",qi="85px",Ji="32px",ji="4px",$i="1px solid ".concat(Z.z.WywaLightColor),Yi="1px solid ".concat(Z.z.WywaDarkColor),Xi="1px solid ".concat(Z.z.WywaTeamsLightColor),Qi="1px solid ".concat(Z.z.TeamsAppBrand00),el="1px solid ".concat(Z.z.WywaTeamsDarkColor),tl="1px solid ".concat(Z.z.HighContrastCyan),rl=(0,V.J9)(((e,t,r,o,n,a,s,i)=>{const l=(0,W.i7)({from:gl(e),to:kl(e)}),c=ze.d.isLoopTheme(e),p={root:[(0,z.gS)("row","nowrap"),{cursor:"pointer",":hover":[{".bottomBar .ms-Facepile-addButton":{opacity:"1"}},c&&[gi(e),{borderRadius:K.B.LoopBorderRadius}]],"> .container":[K.B.CardShadow,(0,z.NX)(e),(0,z.$Z)(),gi(e),(0,z.gS)("row","nowrap"),{minHeight:"10px",borderRadius:K.B.PlannerBorderRadius,width:"100%","> .textContent":(0,z.GD)()},e===m.Sx.TeamsContrast&&!o&&{border:"1px solid ".concat(Z.z.White),":hover":{borderColor:Z.z.TeamsContrastHyperlinkColor}},o&&kl(e),n&&[gl(e),{animation:"".concat(l," 1s 3s forwards")}],c&&[gi(e),{borderRadius:K.B.LoopBorderRadius}]]}],textContent:[(0,z.gS)("column"),(0,q.kE)(),{cursor:"pointer",position:"relative",borderRadius:c?K.B.LoopBorderRadius:"".concat(K.B.PlannerBorderRadius," ").concat(K.B.PlannerBorderRadius," 0 0"),":hover":[{"> .taskMenuSection > .indicator":[{opacity:"1"},c&&[(0,z.zK)(e),{".plannerMore > span":(0,q.c3)()}]]}],"> .labels":[(0,z.GD)("auto"),(0,z.gS)("row"),{flexWrap:"wrap",justifyContent:"flex-start",padding:_i,paddingBottom:"0px",marginBottom:"-".concat(Ni),"> :last-child":{marginRight:"0px"},"> li":{marginRight:Ni,marginBottom:Ni}}],"> .topBar":[(0,z.GD)("auto"),(0,z.gS)("column"),{justifyContent:"space-between",padding:_i,"> .titleRow":al(e,r,n),"> .planName":ol(e),"> .bucketName":nl(e)}]},r&&[e===m.Sx.SharePoint&&{backgroundColor:Z.z.SharepointAddTaskButtonBackgroundColor()},e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black}],a&&Cl(e)],taskMenuSection:[(0,z.gS)(),(0,z.$Z)("auto"),(0,z.Ml)(e),{fontSize:Bt.s.small,right:"2px",top:"12px",lineHeight:Gi,letterSpacing:"0.75px",alignItems:"flex-start",margin:"0px ".concat(zi),position:"absolute","> .indicator":[(0,z.gS)(),(0,z.$Z)(),(0,z.NX)(e),{fontSize:Bt.s.xSmall,margin:"0px ".concat((0,X.vb)((0,X.jz)(Zi)/2-(0,X.jz)(zi))),padding:"0px ".concat(Ki),opacity:"0"}],"> .indicator.clickable":ul(e),"> .indicator.menuOpen":[{opacity:"1"},c&&{":hover":[(0,z.wA)(e),(0,q.cP)()]}],"> .indicator:focus":{opacity:"1"}}],thumbnail:[(0,z.$Z)("162px"),(0,z.gS)(),z.cc,{textAlign:"center",wordWrap:"break-word",overflow:"hidden",borderRadius:"".concat(K.B.PlannerBorderRadius," ").concat(K.B.PlannerBorderRadius," 0 0"),"> .fallbackPreviewIcon":[{fontSize:Ji,animation:"".concat(hl," 1s"),"> svg":{height:Ji,width:Ji}},e===m.Sx.TeamsContrast&&{color:Z.z.White}],"> .previewImage > img.is-loaded":{maxWidth:"100%",minWidth:qi,minHeight:qi,pointerEvents:"none"},"&.real":[{borderBottom:"1px solid"},(0,z.au)(e),ml(e,r)],"&.placeholder":[{borderBottom:"1px solid"},ml(e,r),(0,z.au)(e),o&&(e===m.Sx.Dark||e===m.Sx.TeamsDark)&&{borderColor:uo.kd.gray140},n&&e===m.Sx.TeamsContrast&&{borderColor:Z.z.Black}]},r&&e===m.Sx.SharePoint&&{"& .real":{backgroundColor:Z.z.SharepointAddTaskButtonBackgroundColor()}},r&&e===m.Sx.TeamsContrast&&{"& .real":{backgroundColor:Z.z.Black}}],preview:[(0,z.gS)(),{marginTop:"10px",fontSize:Bt.s.size16,"> *":{flex:"0 1 auto",maxWidth:"100%"},"> .notesPreview":[(0,z.Ml)(e),(0,z.Gn)(),{fontSize:Bt.s.small,wordWrap:"normal",maxHeight:"80px",marginLeft:"28px"},e===m.Sx.SharePoint&&{color:Z.z.SharepointTitleFontColor()},e===m.Sx.TeamsContrast&&{color:Z.z.White}],"> .referencePreviewDescription":[(0,z.gS)(),{alignItems:"center","> .previewIcon":[(0,z.$Z)(),{marginRight:"11px",marginLeft:"1px",padding:"0",height:Ri,width:Ri,"> .ms-Image > img":{height:Ri,width:Ri}},e===m.Sx.SharePoint&&{color:Z.z.SharepointTitleFontColor()},e===m.Sx.TeamsContrast&&{color:Z.z.White}],"> .previewCaption":[(0,z.q0)(),{fontSize:Bt.s.small,flex:"0 1 auto",minHeight:"16px"}],":hover > .previewCaption":[{textDecoration:"underline"},e===m.Sx.TeamsContrast&&{color:Z.z.TeamsContrastHyperlinkColor}]}],"> .checklistPreview":sl(e,s)}],topBar:[(0,z.gS)(),{"> .bucketName.disableUpdateBucket":{cursor:"default","> a:hover":{backgroundColor:"transparent"}}}],indicatorRow:[(0,z.gS)(),(0,z.$Z)("auto"),(0,z.Ml)(e),{fontSize:Bt.s.size12,lineHeight:Gi,marginTop:"16px",marginBottom:"-4px",letterSpacing:"0.75px","> *":[(0,z.gS)(),{alignItems:"center",margin:"0px -".concat((0,X.vb)((0,X.jz)(Zi)/2+(0,X.jz)(Ki))),"> .indicator":[(0,z.gS)(),(0,z.$Z)(),{margin:"0px ".concat((0,X.vb)((0,X.jz)(Zi)/2-(0,X.jz)(zi))),padding:"0px ".concat(Ki)}]}],"> .leftSection":[(0,z.GD)()]},n&&e===m.Sx.TeamsContrast&&{".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-icon":{color:Z.z.Black},".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-textContainer > .ms-Button-label":{color:Z.z.Black}}],requiredCompleteIcon:[(0,z.$Z)(Hi),{marginRight:Oi,marginBottom:"auto"}],bottomBar:[(0,z.gS)("row"),{"&.noDisplayBottomBar":[{display:"none"}],transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",borderTop:"1px solid",borderRadius:"0 0 ".concat(K.B.PlannerBorderRadius," ").concat(K.B.PlannerBorderRadius),"> .completedAssignment":[(0,z.GD)(),{padding:"".concat("8px"," ").concat("14px"),width:"100%",".ms-Persona-primaryText":[(0,z.aS)(e)]}],"> .bottomBarLeftSection":[(0,z.gS)(),{paddingLeft:"12px"," > .dueDateIndicator":{margin:"".concat("6px"," 0px")}}],"> .bottomBarRightSection":[(0,z.gS)(),{right:"12px",position:"absolute",marginTop:"6px"}]},(0,z.au)(e),r&&e===m.Sx.TeamsContrast&&[{backgroundColor:Z.z.Black,color:Z.z.White,borderTop:"1px solid ".concat(Z.z.NeutralLighter),":hover":{backgroundColor:Z.z.Black,color:Z.z.White}}],r&&e===m.Sx.SharePoint&&[{borderTop:"1px solid ".concat(Z.z.SharepointBackgroundColor()),backgroundColor:Z.z.SharepointAddTaskButtonBackgroundColor()}],o&&(e===m.Sx.Dark||e===m.Sx.TeamsDark)&&{borderColor:uo.kd.gray140},a&&Cl(e)]};return(0,W.TW)(p,t)})),ol=e=>[(0,z.$Z)(),(0,z.q0)(),(0,z._D)(e),{fontSize:Bt.s.small,fontWeight:Bt.BO.semibold,marginBottom:"15px",marginTop:"-5px",textOverflow:"ellipsis",wordWrap:"break-word",minHeight:"16px"}],nl=e=>{const t=ze.d.isLoopTheme(e);return[(0,z.$Z)(),(0,z.q0)(),{fontSize:Bt.s.small,fontWeight:Bt.BO.semibold,marginTop:"10px",textOverflow:"ellipsis",wordWrap:"break-word","> a":[(0,z._D)(e),{padding:"4px",":hover":[(0,z.zK)(e),e===m.Sx.TeamsContrast&&{backgroundColor:"transparent",color:Z.z.TeamsContrastHyperlinkColor},t&&(0,z.NX)(e)]},ul(e)]}]},al=(e,t,r)=>{const o=ze.d.isLoopTheme(e);return[(0,z.$Z)(),(0,z.gS)("row"),{"> .completeButtonWithAnimation":[(0,z.$Z)(Hi),{marginRight:Oi}],"> .title":[(0,z.aS)(e),(0,z.$Z)(o?Wi:Vi),{marginTop:"-1px",fontSize:Bt.s.medium,fontWeight:Bt.BO.regular,overflow:"hidden"},t&&[(0,z.Ml)(e),{textDecoration:"line-through"}],r&&e===m.Sx.TeamsContrast&&{color:Z.z.Black}],".toggleCheckLabel":[r&&e===m.Sx.TeamsContrast&&{color:Z.z.Black}]}]},sl=(e,t)=>[(0,z.GD)(),{marginLeft:"1px","*":{marginTop:"0px !important",marginLeft:"0px !important"},"> .checklistItem":[(0,z.gS)(),(0,z.q0)(),{height:Ui,marginBottom:"8px","> .clickWrapper":{"> .checklistItemText":[(0,z.Ml)(e),{maxWidth:"100%",".ms-Checkbox-text":[(0,z.q0)("ellipsis"),(0,z.Ml)(e),(0,q.M8)(),{":hover":[(0,q.M8)(),{textDecoration:"underline"}],fontSize:Bt.s.small,lineHeight:Ui,marginTop:"0px"},e===m.Sx.SharePoint&&{color:Z.z.SharepointTitleFontColor()},e===m.Sx.TeamsContrast&&{color:Z.z.White}]},e===m.Sx.TeamsContrast&&{color:Z.z.White,"> .ms-Checkbox-label > .ms-Checkbox-checkbox":{borderColor:Z.z.White,"> .ms-Checkbox-checkmark":{color:Z.z.TeamsContrastHyperlinkColor},"&:hover":{borderColor:Z.z.TeamsContrastHyperlinkColor}}},t&&{".ms-Checkbox-label span:hover":{textDecoration:"none"}}]}}],".ms-Checkbox-checkbox":[(0,z.jI)(e),{margin:"0px",marginRight:"".concat("11px"," !important"),borderRadius:"50%",flex:"0 0 ".concat(Ui),height:Ui,width:Ui,"> .ms-Checkbox-checkmark":{width:Mi.kT}}]}],il=(0,V.J9)((e=>({root:(0,W.Zq)("taskCard",e.root),textContent:(0,W.Zq)("textContent",e.textContent),taskMenuSection:(0,W.Zq)("taskMenuSection",e.taskMenuSection),thumbnail:(0,W.Zq)("thumbnail",e.thumbnail),preview:(0,W.Zq)("preview",e.preview),indicatorRow:(0,W.Zq)("indicatorRow",e.indicatorRow),bottomBar:(0,W.Zq)("bottomBar",e.bottomBar),topBar:(0,W.Zq)("topBar",e.topBar),requiredCompleteIcon:(0,W.Zq)("requiredCompleteIcon",e.requiredCompleteIcon)}))),ll=(0,V.J9)((()=>{const e={maxHeight:"280px",maxWidth:hi,".labelTagMenuButton":[z.xK,(0,z.gS)(),{paddingLeft:ji,paddingRight:(0,X.vb)(2*(0,X.jz)(ji)),alignItems:"center",cursor:"pointer",width:"100%",height:"32px","> .ms-ContextualMenu-checkmarkIcon":[(0,z.$Z)(),(0,z.gS)(),z.cc,{margin:"0px ".concat(ji)}],"> .labelTag":[(0,z.$Z)(),{marginLeft:ji,maxWidth:"234px"}]}]};return(0,W.Zq)("taskCardContextMenu",e)})),cl="24px",pl="6px",dl=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(t);return{root:[(0,z.GD)(),{width:"100%"}],assigneeRow:[e&&{":hover .addFriendIcon":{opacity:"1"}},{".ms-Facepile-member":{margin:"0px 4px",marginBottom:pl,".ms-Persona-primaryText":{maxWidth:"92px"}},".ms-Facepile-addButton":{marginBottom:pl,opacity:"0",borderRadius:"50%"},".ms-Facepile-addButton:focus":{opacity:"1"},".ms-Facepile-addButton:hover":[(0,z.wA)(t)],".ms-Facepile-addButton i":{margin:"1px 2px 0px"},".ms-Facepile-descriptiveOverflowButton":{marginBottom:pl},".assignDiv .addFriendIcon":{marginLeft:"4px",marginRight:"0px"}}],addFriendIcon:[r?(0,z.aS)(t):(0,z._D)(t),{marginBottom:"3px",backgroundColor:"transparent",position:"absolute",bottom:"0px",opacity:"1",transition:"opacity 0.167s ease-in-out"}],assignDiv:{height:cl,width:cl," &:hover":[(0,z.wA)(t),{borderRadius:"50%"}]}}})),ul=(0,V.J9)((e=>{const t=ze.d.isLoopTheme(e);return{borderRadius:t?"4px":"2px",":hover":[(0,z.Mi)(e),t&&[(0,z.wA)(e),(0,q.cP)(),{"> .plannerMore":[(0,z._D)(e),{"> span":(0,q.cP)()}],".plannerIcon > span":(0,q.cP)()}]]}})),hl=(0,W.i7)({from:{opacity:0},to:{opacity:1}}),ml=(0,V.J9)(((e,t)=>{let r=uo.kd.gray10;switch(e){case m.Sx.Dark:case m.Sx.TeamsDark:r=uo.kd.gray170;break;case m.Sx.TeamsContrast:r=Z.z.Black;break;case m.Sx.SharePoint:r=t?Z.z.SharepointAddTaskButtonBackgroundColor():Z.z.SharepointBackgroundColor();case m.Sx.Light:case m.Sx.TeamsLight:}return{backgroundColor:r}})),gl=(0,V.J9)((e=>{let t=Z.z.WywaLightHighlightBackgroundColor,r=$i;switch(e){case m.Sx.Dark:t=Z.z.WywaDarkHighlightBackgroundColor,r=Yi;break;case m.Sx.TeamsLight:t=Z.z.WywaTeamsLightHighlightBackgroundColor,r=Xi;break;case m.Sx.TeamsDark:t=Z.z.WywaTeamsDarkHighlightBackgroundColor,r=el;break;case m.Sx.TeamsContrast:t=Z.z.TeamsContrastHyperlinkColor,r=tl;case m.Sx.Light:}return{backgroundColor:t,border:r}})),kl=(0,V.J9)((e=>{let t=Z.z.White,r=$i;switch(e){case m.Sx.Dark:t=uo.kd.gray160,r=Yi;break;case m.Sx.TeamsLight:t=Z.z.White,r=Qi;break;case m.Sx.TeamsDark:t=uo.kd.gray160,r=el;break;case m.Sx.TeamsContrast:t=Z.z.Black,r=tl;case m.Sx.Light:}return{backgroundColor:t,border:r}})),Cl=(0,V.J9)((e=>{let t=Z.z.NeutralTertiary;switch(e){case m.Sx.TeamsContrast:t=Z.z.Black;case m.Sx.Light:case m.Sx.Dark:case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.SharePoint:}return{backgroundColor:t}})),bl=(0,V.J9)((e=>{const t=[(0,z.GD)("auto"),z.xK,(0,z.Ml)(e),{fontSize:W.s.xSmall,height:"100%"}],r=[(0,z.Ml)(e),(0,q.M8)()],o=[(0,q.M8)(),(0,z.Ml)(e),{padding:"0",margin:"2px",height:"100%"}];return{root:t,rootHovered:r,flexContainer:{padding:"0",margin:"0"},icon:o,iconHovered:o,iconPressed:o,textContainer:{letterSpacing:"0.75px",padding:"0 0 1px 0",margin:"0"},label:[(0,z.Ml)(e),{fontSize:W.s.xSmall,padding:"0",margin:"2px"}]}})),Tl=(0,V.J9)(((e,t,r)=>{const o=r&&ul(e),n=e===m.Sx.TeamsContrast&&{color:Z.z.White},a={color:e===m.Sx.TeamsContrast?Z.z.Black:(0,jr.eX)(e,t)},s={root:o,rootExpanded:n,iconHovered:a,iconPressed:a,iconExpandedHovered:a};return(0,W.TW)(bl(e),s)})),Sl=(0,V.J9)(((e,t,r)=>{const o=[r&&ul(e)],n=e===m.Sx.TeamsContrast&&{color:Z.z.White},a={color:e===m.Sx.TeamsContrast?Z.z.Black:(0,jr.Bt)(e,t)},s={root:o,rootExpanded:n,iconHovered:a,iconPressed:a,iconExpandedHovered:a};return(0,W.TW)(bl(e),s)})),vl=e=>{const t=Math.max(e.numberOfAttachments,0),r=1===t?U.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelSingular:U.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelPlural,o=Ee.G(r,t),n=bl(e.appTheme);return k.createElement("div",{className:"attachment indicator",title:o},k.createElement(Ii,{...e,ariaLabel:o,label:t.toString(),iconProps:pe.M$,styles:n}))},Pl=e=>{const t=Math.max(e.numChecklistItems,0),r=Math.max(e.numCompletedChecklistItems,0),o=Ee.G(U.p.Strings.ChecklistIndicator_ChecklistIndicatorAriaLabel,r,t),n=Ee.G(U.p.Strings.TaskEditor_ChecklistFraction,r,t),a=bl(e.appTheme);return k.createElement("div",{className:"checkList indicator",title:o},k.createElement(Ii,{...e,ariaLabel:o,label:n,iconProps:pe.tF,styles:a}))},xl=e=>{const t=bl(e.appTheme);return k.createElement("div",{className:"conversation indicator",title:e.ariaLabel},k.createElement(Ii,{...e,ariaLabel:e.ariaLabel,iconProps:pe.CJ,styles:t}))};var yl=r(3176),fl=r(55228),Dl=r(60601);const wl=k.memo((e=>{const{attachment:t,theme:r,isFocusable:o,onAttachmentClick:n,onKeyDown:a}=e,s=yl.m.builder.fromTaskAttachment(t,"").build(),i=s.taskAttachmentRowItemType.taskAttachmentType,l=(0,fl.$)(r,i);return k.createElement("a",{className:"referencePreviewDescription",title:s.url,"data-is-focusable":o,tabIndex:o?0:-1,onKeyDown:e=>{const t=Dl.$.getKey(e);t!==O.D.ENTER&&t!==O.D.SPACE||n(s.url,e),a(e)},onClick:e=>n(s.url,e)},k.createElement(Bi.$,{key:s.url,styles:l,taskAttachmentRowItem:s,className:"previewIcon",icons:fl.b}),k.createElement("span",{className:"previewCaption"},s.alias))}));var Ll=r(22344),Bl=r(5958);const El=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e),o={root:[(0,z.gS)(),{display:"inline-flex",alignItems:"center",height:"24px",cursor:"default","&.clickable":{borderRadius:"2px",cursor:"pointer"},"&.clickable:hover":(0,z.wA)(e),"&.isLate":[(0,z.wM)(e),{borderRadius:r?"4px":"2px",transition:"background 0.167s ease-in-out","> .plannerIcon,.label":(0,z.sS)(e)}]}],calendarIcon:[r?(0,z.aS)(e):(0,z._D)(e),{paddingLeft:"2px",paddingRight:"2px"}],calendarLabel:[(0,z.aS)(e),{fontSize:Bt.s.small,fontWeight:Bt.BO.regular,paddingLeft:"2px",paddingRight:"8px"}],callout:(0,Bl.j)(e).callout};return(0,W.TW)(o,t)})),Al=(0,V.J9)((e=>({root:(0,W.Zq)("dueDateIndicator",e.root),calendarIcon:(0,W.Zq)("calendarIcon",e.calendarIcon),calendarLabel:(0,W.Zq)("calendarLabel",e.calendarLabel),callout:(0,W.Zq)("dueDateIndicatorCallout",e.callout)}))),Fl=e=>{var t;const{isItemVisible:r,toggleOnEvent:o,hideItem:n}=(()=>{const[e,t]=k.useState(!1);return{isItemVisible:e,toggleOnEvent:e=>{null===e||void 0===e||e.preventDefault(),null===e||void 0===e||e.stopPropagation(),t((e=>!e))},showItem:k.useCallback((()=>t(!0)),[t]),hideItem:k.useCallback((()=>t(!1)),[t])}})(),a=k.useRef(null),{ariaLabel:s,isKeyboardFocusable:i,task:l,taskPermissions:c,onKeyDown:p,onUpdateTask:d,appTheme:u,styles:h}=e,m=k.useCallback((e=>{const t=l.setDueDate(null==e?null:Us()(e));d(l,t),n()}),[l,d,n]),g=k.useCallback((e=>{ne.a.getKey(e)===O.D.ESCAPE&&n()}),[n]),C=Al(El(u,h)),b=k.useMemo((()=>(0,oe.A)(null===C||void 0===C?void 0:C.root,c.canEdit&&c.canUpdateDueDate?"clickable":null,{isLate:l.isLate()})),[l,c,C]),T=l.dueDate?l.getFormattedDueDate():U.p.Strings.TaskCard_DueDatePlaceholder;let S;return S=null!==(t=l.recurrence)&&void 0!==t&&t.isActive()?pe.SO:pe.cx,k.createElement("div",{ref:a,className:b,"aria-label":s,title:s,"data-is-focusable":i,onClick:o,onKeyUp:g,onKeyDown:p,role:"button"},k.createElement(B.I,{...S,className:(0,oe.A)(null===C||void 0===C?void 0:C.calendarIcon,S.className)}),k.createElement("span",{className:(0,oe.A)(null===C||void 0===C?void 0:C.calendarLabel,"label"),tabIndex:-1},T),c.canUpdateDueDate&&r&&k.createElement(Re.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:a,directionalHint:se.A.bottomLeftEdge,onDismiss:n,setInitialFocus:!0,className:Al(El(u,h)).callout},k.createElement(Ne.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},k.createElement(Ll.V,{onSelectDate:m,onDismiss:n,isMonthPickerVisible:!0,value:null!=l.dueDate?l.dueDate.toDate():void 0,today:new Date,theme:u}))))},Il=e=>{const{priorityStrings:t,task:r,taskPermissions:o,appTheme:n,onUpdateTask:a}=e,{traceLogger:s}=(0,Ta.t)(),i=k.useCallback(((e,t)=>{let o;switch(t.key){case mt.gy[mt.gy.Urgent]:o=r.setProperty("priority",(0,gt._d)(mt.gy.Urgent));break;case mt.gy[mt.gy.Important]:o=r.setProperty("priority",(0,gt._d)(mt.gy.Important));break;case mt.gy[mt.gy.Medium]:o=r.setProperty("priority",(0,gt._d)(mt.gy.Medium));break;case mt.gy[mt.gy.Low]:o=r.setProperty("priority",(0,gt._d)(mt.gy.Low));break;default:return}a(r,o)}),[r,a]),l=k.useMemo((()=>[{key:mt.gy[mt.gy.Urgent],disabled:!o.canUpdatePriorityToUrgent,name:t.priorityUrgentText,onClick:i,iconProps:(0,Ae.m4)(s,n,mt.gy.Urgent)},{key:mt.gy[mt.gy.Important],name:t.priorityImportantText,onClick:i,iconProps:(0,Ae.m4)(s,n,mt.gy.Important)},{key:mt.gy[mt.gy.Medium],name:t.priorityMediumText,onClick:i,iconProps:(0,Ae.m4)(s,n,mt.gy.Medium)},{key:mt.gy[mt.gy.Low],name:t.priorityLowText,onClick:i,iconProps:(0,Ae.m4)(s,n,mt.gy.Low)}]),[t,i,o,n,s]),[c,p]=k.useMemo((()=>{let e=(0,Ae.m4)(s,n,mt.gy.Urgent,Ae.lK.Small),o=t.priorityUrgentText;return(0,gt.aV)(r.priority)===mt.gy.Important&&(e=(0,Ae.m4)(s,n,mt.gy.Important,Ae.lK.Small),o=t.priorityImportantText),[e,o]}),[r.priority,t,n,s]),d=Tl(n,(0,gt.aV)(r.priority),o.canUpdatePriority);return k.createElement("div",{className:"priority indicator",title:p},k.createElement(Ii,{...e,ariaLabel:p,iconProps:c,disabled:!o.canUpdatePriority,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:se.A.bottomAutoEdge,items:l,styles:(0,Mt.Zo)(n)},menuIconProps:{iconName:"",style:{display:"none"}},styles:d}))},Ml=e=>{const{usageLogger:t,traceLogger:r}=(0,Ta.t)(),{ariaLabel:o,progressState:n,progressStrings:a,task:s,appTheme:i,onUpdateTask:l,canUpdateProgress:c}=e,d=k.useCallback(((e,r)=>{var o;let n;switch(t.logData("ProgressIndicatorOnTaskCard",p.M.TaskProgressChanged,{taskCreationSourceType:null!==(o=s.taskCreationSourceType)&&void 0!==o?o:""}),r.key){case Ct.$.NotStarted:n=s.setProperty("percentComplete",(0,gt.BK)(Ct.$.NotStarted));break;case Ct.$.InProgress:n=s.setProperty("percentComplete",(0,gt.BK)(Ct.$.InProgress));break;case Ct.$.Complete:n=s.setProperty("percentComplete",(0,gt.BK)(Ct.$.Complete));break;default:return}l(s,n)}),[s,l,t]),u=k.useMemo((()=>(0,Ae.Nu)(r,i,null!==n&&void 0!==n?n:Ct.$.InProgress,Ae.lK.Small)),[i,n,r]),h=k.useMemo((()=>[{key:Ct.$.NotStarted,name:a.notStartedText,onClick:d,iconProps:(0,Ae.Nu)(r,i,Ct.$.NotStarted)},{key:Ct.$.InProgress,name:a.inProgressText,onClick:d,iconProps:(0,Ae.Nu)(r,i,Ct.$.InProgress)},{key:Ct.$.Complete,name:a.completedText,onClick:d,iconProps:(0,Ae.Nu)(r,i,Ct.$.Complete)}]),[a,d,i,r]),m=Sl(i,null!==n&&void 0!==n?n:Ct.$.InProgress,c);return k.createElement("div",{className:"progress indicator",title:o},k.createElement(Ii,{...e,ariaLabel:o,disabled:!c,iconProps:u,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:se.A.bottomAutoEdge,items:h,styles:(0,Mt.Zo)(i)},menuIconProps:{iconName:"",style:{display:"none"}},styles:m}))};var Nl,_l,Rl,Ul,Hl=r(62530),Ol=r(9479),Vl=r(54052),Wl=r.n(Vl),Gl=r(20781);!function(e){e.PercentComplete="percentComplete",e.Assignments="assignments",e.Title="title",e.Bucket="bucketId",e.StartDate="startDate",e.DueDate="dueDate",e.Priority="priority",e.MarkTaskAsCompleteColumnName="markTaskAsComplete",e.AddColumnColumnName="addColumn",e.Plan="plan"}(Nl||(Nl={})),function(e){e.HeaderHeight=40,e.RowHeaderWidth=32,e.RowHeight=40,e.AddColumnWidth=164,e.MarkTaskAsCompleteColumnWidth=40,e.DefaultColumnWidth=144,e.AssignedToColumnWidth=180,e.PlanColumnWidth=180,e.TitleColumnWidth=378,e.UndefinedColumnWidth=0}(_l||(_l={})),function(e){e.DefaultCellValue="",e.ToggleTaskCompletionColumnLeftPadding="0px",e.ToggleTaskCompletionColumnRightPadding="0px",e.ToggleTaskCompletionColumnTopPadding="13px",e.ToggleTaskCompletionColumnBottomPadding="11px"}(Rl||(Rl={})),function(e){e.AddToMyDay="addToMyDay",e.RemoveFromMyDay="removeFromMyDay",e.TaskDetails="taskDetails",e.CopyLinkToTask="copyLinkToTask",e.DeleteTask="deleteTask",e.MarkTaskAsComplete="markTaskAsComplete",e.ReactivateTask="markTaskAsIncomplete"}(Ul||(Ul={}));class zl extends g.${name(){return"TaskContextMenu"}renderComponent(){const e=(0,oe.A)("otherCommands indicator clickable",{menuOpen:this.state.isTaskContextMenuVisible});return k.createElement("div",{className:e,onClick:this.toggleOtherCommandsMenu.bind(this),title:U.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-label":U.p.Strings.TaskContextMenu_MoreButtonTooltipText,onKeyUp:this.handleOtherCommandsMenu.bind(this),onKeyDown:this.handleOnKeyDown.bind(this),"data-is-focusable":this.props.isFocusZoneEnabled,ref:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton:"TaskContextMenuButton",role:"button"},k.createElement(B.I,pe.XP),this.state.isTaskContextMenuVisible?this.renderContextMenu():null)}renderContextMenu(){const e=[],{isTaskOnMyDay:t,toggleMyDayForTask:r}=this.props,o=this.props.task.getAssigneeIds().indexOf(h.B.currentUserId)>-1;if(h.B.isUnoContext&&o&&t&&r){const o=t(this.props.task.id),n=()=>{r(this.props.task.id)};e.push(((e,t)=>e?{key:Ul.RemoveFromMyDay,name:U.p.Strings.TaskContextMenu_RemoveFromMyDay,iconProps:pe.c6,title:U.p.Strings.TaskContextMenu_RemoveFromMyDayTooltip,onClick:t}:{key:Ul.AddToMyDay,name:U.p.Strings.TaskContextMenu_AddToMyDay,iconProps:pe.c6,title:U.p.Strings.TaskContextMenu_AddToMyDayTooltip,onClick:t})(o,n))}return this.renderLabelMenuItems(e),this.props.showAssign&&this.props.onClickAssign&&(0,gt.Fk)(this.props.task.percentComplete)!==Ct.$.Complete&&e.push({key:"Assign",name:U.p.Strings.TaskContextMenu_AssignOption,iconProps:this.iconPropsWithDefaultColor(pe.lO),onClick:this.props.onClickAssign.bind(this)}),e.push({key:"CopyTask",name:U.p.Strings.TaskContextMenu_CopyTaskOption,iconProps:this.iconPropsWithDefaultColor(pe.RC),onClick:this.onClickCopyTask.bind(this),disabled:!this.props.showCopyTask}),this.props.showCopyLinkToTask&&e.push({key:"CopyLinkToTask",name:U.p.Strings.TaskContextMenu_CopyLinkToTaskOption,iconProps:this.iconPropsWithDefaultColor(pe.M8),onClick:this.onClickCopyLinkToTask.bind(this)}),e.push({key:"MoveTask",name:U.p.Strings.TaskContextMenu_MoveTaskOption,iconProps:this.iconPropsWithDefaultColor(pe.Nk),onClick:this.onClickMoveTask.bind(this),disabled:!this.props.config.enableMoveTaskOperation}),this.props.showTaskDetails&&this.props.openTaskDetails&&e.push({key:"TaskDetails",name:U.p.Strings.TaskContextMenu_TaskDetailsOption,onClick:this.props.openTaskDetails.bind(this,this.props.task.id,(()=>{}))}),this.props.showDelete&&e.push({key:"Delete",name:U.p.Strings.TaskContextMenu_DeleteOption,iconProps:this.iconPropsWithDefaultColor(pe.pJ),onClick:this.handleDelete}),k.createElement(ie.l,{className:ll(),shouldFocusOnMount:!0,items:e,directionalHint:se.A.bottomAutoEdge,target:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton.current:this.refs.TaskContextMenuButton,onDismiss:this.dismissOtherCommandsMenu.bind(this),appTheme:this.props.theme})}renderLabelMenuItems(e){if(!this.props.showLabel)return;let t=[];null!=this.props.labels&&(t=this.state.taskPlanLabels.map((e=>({key:e.index.toString(),data:e,onRender:this.onRenderLabelMenuItem})))),t.length>0&&e.push({key:"Labels",name:U.p.Strings.TaskContextMenu_LabelOption,iconProps:this.iconPropsWithDefaultColor(pe.Oi),subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:t,styles:(0,Mt.Zo)(this.props.theme)},submenuIconProps:this.iconPropsWithDefaultColor(pe.rK)})}handleOtherCommandsMenu(e){const t=ne.a.getKey(e);t===this.lastKeyDown&&t===O.D.ENTER&&(e.stopPropagation(),this.toggleOtherCommandsMenu(e)),this.lastKeyDown=null}handleOnKeyDown(e){const t=ne.a.getKey(e);t===O.D.ENTER&&e.stopPropagation(),this.lastKeyDown=t,this.props.disableFocusZone(e)}toggleCategory(e){const t=this.props.task.getClone(),r=t.appliedCategories.indexOf(e);r>-1?(t.appliedCategories.splice(r,1),this.logUsage(p.M.RemoveLabelFromTask)):(t.appliedCategories.push(e),this.logUsage(p.M.AddLabelToTask,{isNewLabel:String(e>5)})),this.props.onFocusContainer&&this.props.onFocusContainer(),this.props.onUpdateTask&&this.props.onUpdateTask(this.props.task,t)}toggleOtherCommandsMenu(e){var t;e.stopPropagation();const{task:r,fetchTaskContainerPermissions:o,onOtherCommandsMenuOpened:n}=this.props;null!=(null===(t=r.creationSource)||void 0===t?void 0:t.publication)&&o(r);const a=this.getSortedLabels();this.setState((e=>{var t;e.isTaskContextMenuVisible||this.context.usageLogger.logData(this.name(),p.M.TaskCardContextMenuClicked,{taskCreationSourceType:null!==(t=r.taskCreationSourceType)&&void 0!==t?t:""});return{isTaskContextMenuVisible:!e.isTaskContextMenuVisible,taskPlanLabels:a}}),(()=>{n&&n()}))}getSortedLabels(){var e;let t=null!==(e=this.props.labels)&&void 0!==e?e:[];return t=Gl.H.sortLabelsByUsageAndIndex(t),t}onDeleteTask(){var e,t;null===(e=(t=this.props).deleteTask)||void 0===e||e.call(t,this.props.task.id)}onDeleteTaskSeries(){var e,t;this.logUsage("DeleteRecurringTaskDialogOpened"),null===(e=(t=this.props).openDeleteRecurringTaskDialog)||void 0===e||e.call(t,this.props.task.id)}dismissOtherCommandsMenu(){this.setState({isTaskContextMenuVisible:!1})}onClickCopyTask(){this.logUsage("CopyTaskDialogOpened"),this.props.openCopyTaskDialog&&this.props.openCopyTaskDialog(this.props.task.id)}onClickMoveTask(){this.logUsage("MoveTaskDialogOpened"),this.props.openMoveTaskDialog&&this.props.openMoveTaskDialog(this.props.task.id)}onClickCopyLinkToTask(){const e={taskId:this.props.task.id};this.logUsage("copyTaskLinkTaskCard",e),this.props.onCopyLinkToTask&&this.props.onCopyLinkToTask(this.props.task.id),this.props.onFocusContainer&&this.props.onFocusContainer()}constructor(e,t){super(e,t),this.onRenderLabelMenuItem=e=>{const t=e.data,{index:r}=t,o=(Wl()(this.props.task.appliedCategories)?this.props.task.appliedCategories:[]).indexOf(r)>-1,n=t.name||pt.U.getLabelPlaceholderByIndex(r),a={className:"ms-ContextualMenu-link labelTagMenuButton",name:n,"aria-posinset":e["aria-posinset"],"aria-setsize":e["aria-setsize"],"aria-checked":o};return k.createElement("button",{...a,onClick:e=>this.toggleCategory(r),role:"menuitemcheckbox"},o?k.createElement(B.I,{...pe.r8,className:(0,oe.A)("ms-ContextualMenu-checkmarkIcon",pe.r8.className)}):k.createElement(B.I,{iconName:"",className:"ms-ContextualMenu-checkmarkIcon"}),k.createElement(lt.l,{key:r,index:r,title:n,isCollapsed:!1,theme:this.props.theme}))},this.handleDelete=e=>{var t;return null!==(t=this.props.task.recurrence)&&void 0!==t&&t.isActive()?this.onDeleteTaskSeries():this.onDeleteTask()},this.iconPropsWithDefaultColor=e=>({...e,className:(0,oe.A)("defaultIconColor",e.className)});const r=this.getSortedLabels();this.state={isTaskContextMenuVisible:!1,taskPlanLabels:r}}}var Zl=r(46530),Kl=r(34648),ql=r(13378),Jl=r(8480),jl=r(70995),$l=r(69108),Yl=r.n($l),Xl=r(47649),Ql=r(79962),ec=r(80347),tc=r(71683),rc=r(70149);function oc(e){if(!e)return"";return ac((new DOMParser).parseFromString(e,"text/html").body).trim().replace(/\n{2,}/g,"\n")}const nc=["BR","LI","P","DIV"];function ac(e){if(null==e)return"";var t;if(e.nodeType===Node.TEXT_NODE)return null!==(t=e.textContent)&&void 0!==t?t:"";if(e.nodeType===Node.ELEMENT_NODE){const t=e;let r="";nc.includes(t.tagName)&&(r+="\n");for(const e of t.childNodes)r+=ac(e);return r}return""}const sc={};var ic=r(75314);class lc extends g.${name(){return"TaskCard"}logUsage(e,t,r){this.props.loggers.usageLogger.logData(this.name(),e,t,r)}logError(e,t,r){yo.v.logError(e,t,r,this.props.loggers.logHandler)}renderComponent(){const{task:e,highlightType:t,showPreview:r,isFocusZoneEnabled:o}=this.props;if(null==e)return null;const n=this.getClassNames(),a=(0,gt.Fk)(e.percentComplete),s=this.renderTaskMenu(n),i=this.renderTopBar(n),l=this.renderBottomBar(a,n),c=this.renderCategoryLabels(),p=(0,oe.A)(n.root,"passive_0","active_2",{complete:a===Ct.$.Complete},{wywaBorderHighlighted:t.wywaBorderHighlighted},{assigneeHighlighted:t.assigneeHighlighted},{wywaAnimated:!t.assigneeHighlighted&&t.wywaAnimated}),d=t.wywaBorderHighlighted||!t.assigneeHighlighted&&t.wywaAnimated?U.p.Strings.TaskCard_TaskChangedSinceLastVisit:"",u=e.title+d,h=k.createElement("div",{className:n.textContent,tabIndex:-1},r&&this.renderReferencePreviewThumbnail(n),s,c,i,l);return k.createElement(Gt.R,{direction:zt.E.horizontal,isCircularNavigation:!0,disabled:!o},k.createElement("div",{className:p,"aria-label":u},k.createElement("div",{className:"container",ref:e=>this._containerRef=e},h)))}getAssignees(){return Pr()(this.props.task.getAssigneeIds(),(e=>{let t=this.props.callbacks.getUser(e);return t||(t=Zl._.getUnknownUser(e)),t}))}renderCompleteButton(e,t){const{completeBtnRef:r,task:o,taskPermissions:n,isFocusZoneEnabled:a,theme:s,callbacks:i,taskDetails:l}=this.props,c=i.getFlights().TeamsTasksECS_enableMandatoryChecklist&&(0,ic.cl)(o),p=i.getFlights().TeamsTasksECS_enableMandatoryForms&&(0,ic.lj)(o,l),d=i.getFlights().TeamsTasksECS_enableMandatoryApprovals&&(0,ic.Zw)(o,l);return c||p||d?k.createElement(Jl.S,{plannerTheme:s,directionalHint:se.A.rightCenter,content:U.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel},k.createElement("img",{className:t.requiredCompleteIcon,tabIndex:-1,onClick:this.stopMouseClickEventPropagation,src:jl.A,"data-is-focusable":this.props.isFocusZoneEnabled,"aria-label":U.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel,role:"checkbox","aria-checked":e})):k.createElement(Ol.N,{id:"completeButton"+o.id,isTaskCompleted:e,isFocusZoneEnabled:a,completeButtonRef:r,isDisabled:!n.canUpdateProgress,completeTaskButtonTabIndex:-1,onButtonClick:this.onTaskCardCompleteClick,disableTaskCardFocusZone:this.disableFocusZone,theme:s})}renderAssignmentBar(){const{callbacks:e,currentUserId:t,maxAssignees:r,task:o,taskPermissions:n,theme:a}=this.props,s=this.getAssignees(),i=e.getCanUserModifyAssigneePool(o.id)&&n.canEdit&&n.canAssign,l=(0,gt.Fk)(o.percentComplete);return k.createElement(Ai.UI,{layout:Ai.Yn.Compact,assignees:s,currentUserId:t,canEditAssignments:n.canAssign,canEditAccessPermissions:i,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:i,canAccessPlanViaSharedContainerOnly:e.getCanUserAccessPlanViaSharedContainerOnly(o.planId),minQueryTermLength:m.c9.MinCharsNeededToSearch,maxAssignees:r,maxDisplayablePersonas:m.eg.MaxDisplayablePersonasTaskCard,addIconPlacement:Ai.aq.BeforeAssignees,strings:{assignControlLauncherText:"",assignControlAssignToMeButtonText:U.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:U.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:U.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:U.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:U.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:U.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:U.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:U.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:U.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:U.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:U.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:U.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:U.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:U.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:U.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:U.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:U.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:e.onRenderPersona,getUsersWithPlanAccess:this.getAssigneePool,getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,onCloseAssignCallout:this.onCloseAssignCallout,getSearchQueryResults:i?e.getUsersWithKeyword:void 0,getUserPhoto:e.getUserPhoto,showAssigneeLimitError:this.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,overflowButtonType:wr.Z.descriptive,showPeoplePicker:this.state.isPeoplePickerVisible,targetElement:l!==Ct.$.Complete&&null!==o.getAssigneeIds()&&o.getAssigneeIds().length>0?this._bottomBar||void 0:this._containerRef||void 0,theme:a,styles:dl(n.canAssign,a),allowMultiline:!1,hideSingleAssigneeDetails:!0})}renderCompletedTaskBottomBar(){const{task:e,callbacks:t}=this.props;if(null==e.completedBy||null==e.completedDate)return null;const r=ec.lz.FormatDate(e.completedDate);let o=this.props.callbacks.getUser(e.completedBy);null==o&&(o=Zl._.getUnknownUser(e.completedBy));const n={text:Ee.G(U.p.Strings.TaskCard_CompletedByOnDate,o.formattedDisplayName,r),imageUrl:t.getUserPhoto(o.id)||void 0,imageInitials:(0,Ql.I)(o.displayName,(0,G.jI)()),initialsColor:(0,Ei.X)({text:o.displayName}),size:We.WH.extraSmall,className:"completedBy"};return k.createElement("div",{className:"completedAssignment"},k.createElement(Ge.f,{user:o,onLoad:t.onRenderPersona,containerId:"userContainer-taskCard-".concat(e.id,"-").concat(o.id)},k.createElement(Ve.F,n)))}renderActiveTaskBottomBar(){const e=this.renderDueDateIndicator();return k.createElement(k.Fragment,null,k.createElement("div",{className:"bottomBarLeftSection"},e),k.createElement("div",{className:"bottomBarRightSection",onClick:this.preventDefault},this.renderAssignmentBar()))}renderTaskMenu(e){const t={enableMoveTaskOperation:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canMove};return k.createElement("div",{className:e.taskMenuSection},k.createElement(zl,{config:t,task:this.props.task,labels:this.props.taskPlanLabels,showAssign:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canAssign,showDelete:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canDelete,showLabel:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canUpdateAppliedLabels,showCopyTask:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canCopy,showCopyLinkToTask:this.props.showCopyLinkToTask,openCopyTaskDialog:e=>{this.props.callbacks.openCopyTaskDialog(e,this.props.onFocusContainer)},openMoveTaskDialog:e=>{this.props.callbacks.openMoveTaskDialog(e,this.props.onFocusContainer)},openDeleteRecurringTaskDialog:e=>{this.props.callbacks.openDeleteRecurringTaskDialog(e,this.props.onFocusContainer)},onCopyLinkToTask:e=>{this.props.callbacks.onCopyLinkToTask(e)},deleteTask:e=>{this.props.onDelete(e)},onFocusContainer:()=>{this.props.onFocusContainer()},onUpdateTask:(e,t)=>{this.props.callbacks.onUpdateTask(e,t)},onClickAssign:()=>{this.onClickAssign()},onOtherCommandsMenuOpened:()=>{this.onOtherCommandsMenuOpened()},isTaskOnMyDay:this.props.callbacks.isTaskOnMyDay,toggleMyDayForTask:this.props.callbacks.toggleMyDayForTask,isFocusZoneEnabled:this.props.isFocusZoneEnabled,disableFocusZone:this.disableFocusZone,otherCommandsMenuCommandButton:this.props.moreBtnRef,fetchTaskContainerPermissions:this.props.callbacks.fetchTaskContainerPermissions,theme:this.props.theme}))}renderTopBar(e){const t=this.props.taskPlan,r=Ee.G(U.p.Strings.TaskCard_TaskTitleAriaLabel,this.props.task.title),o=k.createElement("div",{className:"titleRow"},this.renderCompleteButton(this.props.task.isComplete(),e),k.createElement("div",{className:"title","aria-label":r,role:"textbox"},this.props.task.title));let n=null;if(this.props.showPlanTitle){const e=null!=t?Ee.G(U.p.Strings.TaskCard_PlanTitleAriaLabel,t.title):void 0;n=k.createElement("div",{className:"planName","aria-label":e,role:null!=t?"textbox":void 0},null===t||void 0===t?void 0:t.title)}const a=this.renderIndicatorRow(e);return k.createElement("div",{className:e.topBar,onClick:this.onCardClick},n,o,this.renderBucketTitle(),this.props.showPreview&&this.renderPreview(e),a)}renderBottomBar(e,t){const{task:r}=this.props,o=null!=r.dueDate,n=(0,oe.A)(t.bottomBar,e===Ct.$.Complete||o||null!==r.getAssigneeIds()&&r.getAssigneeIds().length>0?"":"noDisplayBottomBar");return k.createElement("div",{className:n,ref:this.resolveRef(this,"_bottomBar"),tabIndex:-1},e===Ct.$.Complete&&r.completedBy&&r.completedDate?this.renderCompletedTaskBottomBar():this.renderActiveTaskBottomBar())}renderBucketTitle(){if(null==this.props.taskBucket||!this.props.showBucketTitle)return null;const e=this.props.taskPermissions.canUpdateBucket?"bucketName":"bucketName disableUpdateBucket";if(null!=this.props.callbacks.getBuckets){const t=[],r=null!=this.props.task.planId?this.props.callbacks.getBuckets(this.props.task.planId):[];null!=r&&r.sort(((e,t)=>Vs.O.compareOrderHints(t.orderHint,e.orderHint))),Be()(r,(e=>{t.push({key:e.id,name:e.title,onClick:this.setBucket})}));const o=k.createElement(ie.l,{shouldFocusOnMount:!0,items:t,className:"bucketContextualMenu",directionalHint:se.A.bottomAutoEdge,target:this.refs.bucketMenuCommandButton,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme});return k.createElement("div",{className:e,ref:"bucketMenuCommandButton",tabIndex:-1},k.createElement("a",{onClick:this.toggleBucketMenu,"data-is-focusable":"false"},this.props.taskBucket.title),this.state.isBucketMenuVisible?o:null)}return k.createElement("div",{className:e},this.props.taskBucket.title)}renderPreview(e){let t=null;switch(this.props.task.previewType){case Kl.X.CheckList:t=this.renderChecklistPreview();break;case Kl.X.Description:t=this.renderNotesPreview();break;case Kl.X.Reference:case Kl.X.Automatic:t=this.renderTaskReferencePreviewDescription();break;case Kl.X.NoPreview:break;default:Ws.f.unreachableCase(this.props.task.previewType,(e=>{this.props.loggers.traceLogger.logTrace(508077509,ao.k.Error,e)}))}return t?t&&k.createElement("div",{className:e.preview},t):null}renderChecklistPreview(){if(!this.props.taskDetails)return null;this._checklistItems=[];const e=!this.props.taskPermissions.canEdit||(0,ei.c)(this.props.taskPermissions.checklistPermissions,ei.j.DisableCheckedStateToggling),t=ql.e.getSortedChecklistItems(this.props.taskDetails.checklist).filter((e=>!e.isChecked)).slice(0,10).map((t=>k.createElement("div",{className:"checklistItem",key:t.id},k.createElement("div",{className:"clickWrapper",title:e?U.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:t.title,onClick:this.onIgnoreClick,onKeyUp:this.stopKeyUpPropagation},k.createElement(Hl.S,{inputProps:{"data-is-focusable":!1},label:t.title,className:"checklistItemText",onChange:e=>this.onPreviewCheckboxChanged(t,e),componentRef:e=>{null!=e&&this._checklistItems.push({element:e,id:t.id})},disabled:e,appTheme:this.props.theme})))));return k.createElement("div",{className:"checklistPreview"},t)}renderNotesPreview(){var e;const{taskDetails:t,callbacks:r}=this.props,o=r.getFlights().TeamsTasksECS_richTextEditorEnabled,n=t&&(o?null===(e=t.notes)||void 0===e?void 0:e.content:t.description);return k.createElement("div",{className:"notesPreview"},n?o?function(e,t){var r;return e?((null===(r=sc[t])||void 0===r?void 0:r.htmlString)!==e&&(sc[t]={htmlString:e,plainText:oc(e)}),sc[t].plainText):""}(n,t.id):(0,tc.o)(n):"")}renderTaskReferencePreviewDescription(){if(!this.props.taskDetails)return this.props.task.numberOfReferences>0?k.createElement("div",{className:"referencePreviewDescription","data-is-focusable":"false"},k.createElement("span",{className:"previewCaption"})):null;const e=this.props.taskDetails.getReferenceWithLowestPriority();return this.isPreviewTypeReferenceOrAutomatic()&&e&&e.taskAttachmentType?k.createElement(wl,{theme:this.props.theme,isFocusable:this.props.isFocusZoneEnabled,attachment:e,onAttachmentClick:this.onAttachmentClick,onKeyDown:this.disableFocusZone}):null}renderReferencePreviewThumbnail(e){if(!this.isPreviewTypeReferenceOrAutomatic()||this.props.task.numberOfReferences<=0)return null;if(null==this.props.taskDetails)return k.createElement("div",{className:(0,oe.A)(e.thumbnail,"placeholder")});const t=this.props.taskDetails.getReferenceWithLowestPriority();if(null===t||void 0===t||!t.taskAttachmentType)return null;const r=this.props.callbacks.getFlights().VideoLinkPreviews;if(r&&t.isGifAttachment())return k.createElement("img",{src:t.url,className:(0,oe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick});if(r&&!t.hasKnownExtension())if(this.state.reactPlayerInstance){const r=this.state.reactPlayerInstance;if(t.taskAttachmentType.videoUrlParseResult.canPlay)return k.createElement("div",{className:(0,oe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},k.createElement("iframe",{sandbox:void 0,src:t.taskAttachmentType.videoUrlParseResult.embedUrl,allowFullScreen:!0,frameBorder:0}));if(r.canPlay(t.url))return k.createElement("div",{className:(0,oe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},k.createElement(r,{url:t.url,controls:!0}))}else this.loadReactPlayer();if(!this.props.taskPlan)return this.renderFallbackThumbnail(t,e);const o=this.props.callbacks.getDocumentPreviewThumbnail(this.props.taskPlan.container.externalId,t.url);return null==o||this.state.taskPreviewImageLoadState===Io.P6.error?this.renderFallbackThumbnail(t,e):k.createElement("div",{className:(0,oe.A)(e.thumbnail,"real")},k.createElement(Fo._,{className:"previewImage",shouldFadeIn:!0,imageFit:Io.N_.none,src:o,alt:"",onLoadingStateChange:this.onImageLoadingStateChange}))}renderFallbackThumbnail(e,t){const r=yl.m.builder.fromTaskAttachment(e,"").build(),o=r.taskAttachmentRowItemType.taskAttachmentType,n=(0,fl.$)(this.props.theme,o);return k.createElement("div",{className:(0,oe.A)(t.thumbnail,"placeholder")},k.createElement(Bi.$,{key:r.url,styles:n,taskAttachmentRowItem:r,className:"fallbackPreviewIcon",icons:fl.b}))}renderIndicatorRow(e){const{task:t,isFocusZoneEnabled:r}=this.props,o=k.createElement(xl,{ariaLabel:U.p.Strings.TaskCard_HasCommentsAriaLabel,isKeyboardFocusable:r,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),n=k.createElement(vl,{isKeyboardFocusable:r,numberOfAttachments:t.numberOfReferences,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),a=k.createElement(Pl,{isKeyboardFocusable:r,numChecklistItems:t.numberOfChecklistItems,numCompletedChecklistItems:t.numberOfChecklistItems-t.numberOfActiveChecklistItems,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),s=(0,gt.Fk)(t.percentComplete),i=(0,gt.aV)(t.priority);return k.createElement("div",{className:e.indicatorRow},k.createElement("div",{className:"leftSection"},i!==mt.gy.Low&&i!==mt.gy.Medium?this.renderPriorityIndicator():null,s!==Ct.$.NotStarted&&s!==Ct.$.Complete?this.renderInProgressIndicator():null,t.conversationThreadId&&null!==t.conversationThreadId?o:null,t.numberOfReferences>0?n:null,t.numberOfChecklistItems>0?a:null))}renderPriorityIndicator(){const e={priorityUrgentText:U.p.Strings.Task_PriorityUrgentText,priorityImportantText:U.p.Strings.Task_PriorityImportantText,priorityMediumText:U.p.Strings.Task_PriorityMediumText,priorityLowText:U.p.Strings.Task_PriorityLowText};return k.createElement(Il,{isKeyboardFocusable:this.props.isFocusZoneEnabled,priorityStrings:e,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderInProgressIndicator(){const e=U.p.Strings.TaskCard_TaskInProgressText,t={completedText:U.p.Strings.PlannerApp_CompletedText,inProgressText:U.p.Strings.PlannerApp_InProgressText,notStartedText:U.p.Strings.PlannerApp_NotStartedText};return k.createElement(Ml,{ariaLabel:e,canUpdateProgress:this.props.taskPermissions.canUpdateProgress,isKeyboardFocusable:this.props.isFocusZoneEnabled,progressStrings:t,task:this.props.task,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderDueDateIndicator(){let e;var t;this.props.task.dueDate?e=null!==(t=this.props.task.recurrence)&&void 0!==t&&t.isActive()?Ee.G(U.p.Strings.TaskCard_RecurringDueDateAriaLabel,this.props.task.dueDate.format("LL")):Ee.G(U.p.Strings.TaskCard_DueDateAriaLabel,this.props.task.dueDate.format("LL")):e=U.p.Strings.AddTaskCard_DueDateText;return this.props.taskPermissions.canUpdateDueDate||(e=U.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip),k.createElement(Fl,{ariaLabel:e,isKeyboardFocusable:this.props.isFocusZoneEnabled,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,appTheme:this.props.theme})}renderCategoryLabels(){const{callbacks:e,isFocusZoneEnabled:t,task:r,taskPlanLabels:o}=this.props,n=r.appliedCategories.sort(yr.l.compareNumbers);if(v()(n)||0===o.length)return null;const a=[];Be()(n,(e=>{const t=o[e];null!=t&&a.push(Gl.H.getLabelPlaceholder(t))}));const s=a.join(", ");return k.createElement("ul",{className:"labels","aria-label":s,"data-is-focusable":t,tabIndex:t?0:-1,onClick:e=>{e.screenX||e.screenY||e.stopPropagation()},onKeyUp:t=>{ne.a.isButtonPress(t)&&(t.stopPropagation(),e.setLabelsCollapsedState(!this.context.isLabelCollapsed,r.planId))},onKeyDown:this.disableFocusZone},n.map((e=>this.renderLabel(e,this.context.isLabelCollapsed))))}renderLabel(e,t){const r=this.props.taskPlanLabels[e];return null==r?null:k.createElement("li",{key:e},k.createElement(lt.l,{key:e,index:e,isHovered:this.state.labelsHovered,title:Gl.H.getLabelPlaceholder(r),isCollapsed:t,showBorder:this.state.labelsHovered&&!t,theme:this.props.theme,onClick:e=>{e.stopPropagation(),this.props.callbacks.setLabelsCollapsedState(!t,this.props.task.planId)},onMouseEnterCallback:()=>{this.setState({labelsHovered:!0})},onMouseLeaveCallback:()=>{this.setState({labelsHovered:!1})}}))}isPreviewTypeReferenceOrAutomatic(){return Yl()([Kl.X.Reference,Kl.X.Automatic],this.props.task.previewType)>=0}onOtherCommandsMenuOpened(){this.onCloseAssignCallout()}onClickAssign(){this.state.isPeoplePickerVisible||this.setState({isPeoplePickerVisible:!0})}loadReactPlayer(){(0,rc.L)((()=>r.e(82707).then(r.bind(r,90961)))).then((e=>{if(null===e||void 0===e||!e.default)throw new Error("Invalid react-player import");this.setState({reactPlayerInstance:e.default})})).catch((e=>{this.props.loggers.traceLogger.logTrace(508077508,ao.k.Error,"Failed to dynamically import react-player [Error=".concat(Ws.f.getMessage(e),"]"))}))}getClassNames(){const{highlightType:e,task:t}=this.props,r=(0,gt.Fk)(t.percentComplete)===Ct.$.Complete,o=e.wywaBorderHighlighted,n=!e.assigneeHighlighted&&e.wywaAnimated,a=e.assigneeHighlighted,s=!this.props.taskPermissions.canEdit||(0,ei.c)(this.props.taskPermissions.checklistPermissions,ei.j.DisableCheckedStateToggling);return il(rl(this.props.theme,this.props.styles,r,o,n,a,s))}constructor(e,t){super(e,t),this.onCardClick=e=>{const{onTaskCardClick:t,task:r}=this.props;ne.a.isButtonPress(e)&&null!=t&&(t(r.id),e.stopPropagation())},this.showAssigneeLimitError=()=>{this.props.callbacks.showAssigneeLimitError(this.props.task.id)},this.onOpenAssignCallout=()=>{var e;this.setState({isPeoplePickerVisible:!0}),this.props.callbacks.onOpenAssignCallout&&this.props.callbacks.onOpenAssignCallout(this.props.task.planId),null!=(null===(e=this.props.task.creationSource)||void 0===e?void 0:e.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onTaskCardCompleteClick=e=>{const{task:t,callbacks:r,loggers:o}=this.props;var n,a;(Xl.v.create().setImmediate((()=>{const e=t.toggleCompletionState();r.onUpdateTask(t,e)})),t.isComplete())?o.usageLogger.logData(this.name(),p.M.TaskReactivateButtonClicked,{taskCreationSourceType:null!==(n=t.taskCreationSourceType)&&void 0!==n?n:""}):o.usageLogger.logData(this.name(),p.M.TaskCompleteButtonClicked,{taskCreationSourceType:null!==(a=t.taskCreationSourceType)&&void 0!==a?a:""})},this.disableFocusZone=e=>{ne.a.getKey(e)===O.D.TAB&&this.props.disableFocusZone()},this.onIgnoreClick=e=>{e.stopPropagation()},this.stopKeyUpPropagation=e=>{e.stopPropagation()},this.stopMouseClickEventPropagation=e=>{e.stopPropagation()},this.onImageLoadingStateChange=e=>{this.setState({taskPreviewImageLoadState:e})},this.onAttachmentClick=(e,t)=>{var r;if(t.stopPropagation(),t.preventDefault(),e){this.logUsage("ClickAttachment");try{this.props.callbacks.onOpenLink(this.props.taskDetails.references[e])}catch(o){this.props.callbacks.showInfoBanner(wi.fc.UnopenableAttachmentLinkInfo)}}null!=(null===(r=this.props.task.creationSource)||void 0===r?void 0:r.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onPreviewCheckboxChanged=(e,t)=>{const{taskDetails:r,callbacks:o,onFocusContainer:n,loggers:a}=this.props;if(null===t||void 0===t||t.stopPropagation(),null===t||void 0===t||t.preventDefault(),xr.n.ChangeFocusBeforeRemovalIFocusableAlt(this._checklistItems,n,e.id),null!=r){const t=r.checkChecklistItem(e.id,!0);o.onUpdateTaskDetails(r,t),a.usageLogger.logData("TaskCardChecklist","Checklist item is marked as complete")}},this.toggleBucketMenu=e=>{this.props.taskPermissions.canUpdateBucket&&(e.stopPropagation(),this.setState((e=>({isBucketMenuVisible:!e.isBucketMenuVisible}))))},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.setBucket=(e,t)=>{const r=this.props.task.setProperty("bucketId",""!==t.key?t.key:null);this.props.callbacks.onUpdateTask(this.props.task,r),this.dismissBucketMenu()},this.getAssigneePool=()=>null==this.props.callbacks.getAssigneePool?[]:this.props.callbacks.getAssigneePool(this.props.task.id)||[],this.onAnimatedPreviewContentClick=e=>{e.stopProp()},this.onAssignUser=(e,t,r)=>{const{task:o,callbacks:n}=this.props;null!=o&&null!=n.onAssignTask&&-1===o.getAssigneeIds().indexOf(e)&&n.onAssignTask(e,o.id,t,r)},this.onUnassignUser=e=>{if(null!=this.props.task&&null!=this.props.callbacks.onUpdateTask&&-1!==this.props.task.getAssigneeIds().indexOf(e)){const t=this.props.task.getClone();delete t.assignments[e],v()(t.assignments)&&this.state.isPeoplePickerVisible&&this.setState({isPeoplePickerVisible:!1}),this.props.callbacks.onUpdateTask(this.props.task,t)}},this.onCloseAssignCallout=()=>{this.setState({isPeoplePickerVisible:!1})},this.getZeroTermQueryAssignmentResults=()=>this.props.callbacks.getAssigneeSuggestions(this.props.task.planId,this.props.task),this.tenantSearchAlertUser=e=>{this.props.callbacks.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.callbacks.addUserToContainer(e,this.props.task.planId)},this.preventDefault=e=>{e.preventDefault()},this.onClickIndicator=()=>{var e;null!=(null===(e=this.props.task.creationSource)||void 0===e?void 0:e.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.state={isBucketMenuVisible:!1,taskPreviewImageLoadState:Io.P6.notLoaded,isPeoplePickerVisible:!1,labelsHovered:!1,reactPlayerInstance:null}}}lc.contextType=Li;class cc extends Di{renderComponent(){const e=Pi(this.props.styles),t=k.createElement("div",{key:this.props.entity.id,id:this.props.entity.id,className:e.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"aria-label":this.props.entity.title,"aria-posinset":this.props.taskBoardCardPositionInColumnGroup+1,"aria-setsize":this.props.totalTasksInColumnGroup,"data-dnd-role":"card","data-is-focusable":!0,role:"listitem",onClick:this.onClick.bind(this),tabIndex:0,onKeyDown:this.handleOnKeyDown.bind(this),onKeyUp:this.handleOnKeyUp.bind(this),ref:e=>{this._taskBoardCardElement=e}},this.cardRenderer());return this.props.taskPermissions.canEdit&&this.props.connectDragSource&&this.props.connectDropTarget&&null!==(r=this.props.connectDragSource(this.props.connectDropTarget(t)))&&void 0!==r?r:t;var r}cardSource(){return{beginDrag:e=>({entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping,props:e})}}componentDidUpdate(e,t){var r,o,n;(Sr()(t,this.state)&&Sr()(e,this.props)||t.enableFocusZone!==this.state.enableFocusZone||this.props.setRef(this._taskBoardCardElement,this.props.entity.id),e.isDragging!==this.props.isDragging)&&(null===(r=(o=this.props).onCardDragStateChange)||void 0===r||r.call(o,null!==(n=this.props.isDragging)&&void 0!==n&&n))}cardRenderer(){const{canAddGuests:e,currentUserId:t,entity:r,maxAssignees:o,onDelete:n,onTaskCardClick:a,showPlanTitle:i,showPreview:l,showCopyLinkToTask:c,taskBoardCardCallbacks:p,taskPermissions:d}=this.props,u={...p.taskCallbacks,onUpdateTask:(e,t)=>{this.onUpdateTask(e,t)}},h=p.getTaskHighlightedType(this.props.entity);this.props.isOver&&(h.assigneeHighlighted=!0);let m=[];const g=null!=r.planId?p.getTaskPlanDetails(r.planId):null,C=p.getTaskPlanLabelUsageCounts(r.planId);return m=pt.U.getILabelArray((null===g||void 0===g?void 0:g.categories)||[],C),k.createElement(lc,{key:r.id,task:r,taskBucket:null!=r.bucketId?p.getTaskBucket(r.bucketId):null,taskDetails:p.getTaskDetails(r.id),taskPlan:null!=r.planId?p.getTaskPlan(r.planId):null,taskPlanLabels:m,callbacks:u,showBucketTitle:!i&&p.getCurrentTaskGroupingState()!==s.Yc.Bucket,showPlanTitle:i,showPreview:l,showCopyLinkToTask:c,highlightType:h,isFocusZoneEnabled:this.state.enableFocusZone,maxAssignees:o,onDelete:n,onFocusContainer:()=>this.setFocusOnCard(),onTaskCardClick:a,completeBtnRef:this._completeBtnRef,moreBtnRef:this._moreBtnRef,disableFocusZone:this.disableFocusZone.bind(this),currentUserId:t,taskPermissions:d,canAddGuests:e,theme:this.props.theme,loggers:this.context})}onDrop(e,t,r){if(!t||"memberCard"!==t.getItemType())return;const o=t.getItem();if(-1===e.entity.getAssigneeIds().indexOf(o.user.id)){if(e.maxAssignees&&e.entity.getAssigneeIds().length>=e.maxAssignees)return void e.taskBoardCardCallbacks.showAssigneeLimitError(e.entity.id);const t=e.entity.getClone();t.assignments[o.user.id]=new So.I(e.currentUserId,new Date),e.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e.entity,t)}}onClick(){this.props.onTaskCardClick(this.props.entity.id)}handleOnKeyDown(e){e.stopPropagation(),e.target===e.currentTarget&&(this.lastKeyDown=e.keyCode)}disableFocusZone(){this.setState({enableFocusZone:!1})}handleOnKeyUp(e){e.stopPropagation();const{entity:t,columnValue:r,onKeyboardTaskReorder:o,onTaskCardClick:n,taskPermissions:a}=this.props;e.keyCode===this.lastKeyDown&&(e.keyCode===O.D.DOWN_ARROW&&e.ctrlKey&&a.canEdit?o&&o(r,t,!1):e.keyCode===O.D.UP_ARROW&&e.ctrlKey&&a.canEdit?o&&o(r,t,!0):e.keyCode===O.D.SPACE||e.keyCode===O.D.ENTER?n(t.id):e.keyCode===O.D.RIGHT_ARROW&&(e.preventDefault(),this.setState({enableFocusZone:!0},(()=>{a.canEdit?this._completeBtnRef.current&&this._completeBtnRef.current.focus():this._moreBtnRef.current&&this._moreBtnRef.current.focus()})))),this.lastKeyDown=null}setFocusOnCard(){null!=this._taskBoardCardElement&&this._taskBoardCardElement.focus()}onUpdateTask(e,t){if(e.percentComplete!==t.percentComplete)switch((0,gt.Fk)(t.percentComplete)){case Ct.$.NotStarted:this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==s.Yc.Progress&&(0,gt.Fk)(e.percentComplete)!==Ct.$.Complete||null==this.props.restoreFocusOnMoveTask?this.setFocusOnCard():this.props.restoreFocusOnMoveTask(t.id);break;case Ct.$.InProgress:break;case Ct.$.Complete:null!=this.props.restoreFocusOnMoveTask&&this.props.restoreFocusOnMoveTask(t.id);break;default:return}this.props.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e,t)}constructor(e,t){super(e,t),this._completeBtnRef=k.createRef(),this._moreBtnRef=k.createRef(),this.state={enableFocusZone:!1}}}const pc=yi()((0,jt.I)("card",cc.prototype.cardSource(),cc.prototype.cardCollect),(0,ni.T)("memberCard",cc.prototype.cardTarget(),cc.prototype.cardTargetCollect))(cc),dc=(0,V.J9)((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ks.Board,o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,i=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=hi;switch(e){case m.Sx.LoopLight:case m.Sx.LoopDark:c=mi;case m.Sx.Light:case m.Sx.Dark:case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:case m.Sx.SharePoint:}const p={root:Ci(e,r,n,i,l),columnHeader:[bi(e),{"> .addButtonContainer":[(0,z.$Z)(),(0,z.gS)(),{marginBottom:"17px"}]}],titleSection:[Ti(e,o),r===Ks.List&&[z.cc,mc(e),{borderRadius:"4px",margin:"4px 0",padding:"0 9px",height:"40px"}],{"> .headerImage":[(0,z.$Z)(),(0,z.gS)(),z.cc],"> .editMenu":[(0,z.$Z)(),{display:"block","button.editMenuLauncher":[z.xK,{width:"24px",cursor:"pointer",opacity:0,":focus":{opacity:1}}],"& .stayOpen button.editMenuLauncher":{opacity:1}}],":hover":{"> .editMenu button.editMenuLauncher":{opacity:1}},"> .columnCollapseButton":[z.xK,(0,z.$Z)(),(0,z.gS)(),{margin:"0 ".concat(ui),"> .plannerIcon":[(0,z.$Z)(),{fontSize:W.s.large,verticalAlign:"middle",cursor:"pointer",transition:"transform 0.2s ease-in-out",transform:s?"rotate(0deg)":"rotate(180deg)"}],":hover":[e===m.Sx.TeamsContrast&&{color:Z.z.TeamsContrastHyperlinkColor}]}]}],addButton:uc(e,a),scrollable:[(0,z.GD)("auto"),(0,z.gS)("column"),s&&{display:"none "},(0,z.Ss)(e),r===Ks.Board&&!n&&{overflowY:"hidden",overflowX:"hidden",":hover":{overflowY:"auto"}},{marginTop:"-9px",paddingLeft:pi,paddingRight:pi,"> *":[(0,z.$Z)(),{width:c,":last-child":{flex:"1 0 auto","> .listWrapper > .listboxGroup":{paddingBottom:"36px"}}}],"> .primarySection":{minHeight:"10px",paddingTop:K.B.ShadowMargin}}]};return(0,W.TW)(p,t)})),uc=(e,t)=>{let r=!0,o={},n="none",a="",s="",i="",l="40px",c=K.B.PlannerBorderRadius,p=hi;switch(e){case m.Sx.Light:break;case m.Sx.Dark:s=uo.kd.gray170;break;case m.Sx.TeamsLight:s=uo.kd.gray30;break;case m.Sx.TeamsDark:s=uo.kd.gray150;break;case m.Sx.TeamsContrast:r=!1,n="1px solid "+Z.z.White,a=Z.z.Black,s=Z.z.TeamsContrastHyperlinkColor,i=Z.z.TeamsContrastHyperlinkColor;break;case m.Sx.SharePoint:break;case m.Sx.LoopLight:case m.Sx.LoopWorkspaceLight:case m.Sx.LoopDark:case m.Sx.LoopWorkspaceDark:l=ai,c=K.B.LoopBorderRadius,p=mi,o=gi(e)}return[(0,z.$Z)(p),(0,z.gS)(),z.cc,(0,q.kE)(),(0,z.NX)(e),(0,z._D)(e),r&&K.B.CardShadow,{height:l,marginTop:di,padding:"0px ".concat("10px"),border:n,borderRadius:c,boxSizing:"border-box",fontSize:W.s.mediumPlus,font:"inherit",transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",cursor:"pointer",":hover":[s&&{backgroundColor:s},a&&{color:a},i&&{borderColor:i}],"> .plannerIcon":[(0,z.$Z)(),{padding:"0px ".concat("6px")}],"> .addTaskText":[(0,z.GD)(),{padding:"0px ".concat("6px"),fontSize:W.s.medium}]},o]},hc=(0,V.J9)((e=>({root:(0,W.Zq)("taskBoardColumn",e.root),columnHeader:(0,W.Zq)("columnHeader",e.columnHeader),addButton:(0,W.Zq)("addButton",e.addButton),titleSection:(0,W.Zq)("titleSection",e.titleSection),scrollable:(0,W.Zq)("scrollable",e.scrollable)}))),mc=e=>{let t="";switch(e){case m.Sx.Light:t="rgba(255, 255, 255, 0.8)";break;case m.Sx.Dark:t="rgba(41, 40, 39, 0.8)"}return t?{backgroundColor:t}:{}},gc="14px",kc=(0,V.J9)(((e,t,r)=>{let o=hi;switch(e){case m.Sx.LoopLight:case m.Sx.LoopDark:o=mi;case m.Sx.Light:case m.Sx.Dark:case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:case m.Sx.SharePoint:}const n={root:[(0,z.gS)("column"),{"> .addControlContainer":{marginTop:"-".concat(K.B.ShadowMargin),padding:"".concat(di," 0")}}],sectionToggleButton:[z.xK,(0,z.$Z)("40px"),(0,z.gS)(),z.cc,(0,z.aS)(e),mc(e),{width:o,marginTop:"0px",marginBottom:"6px",borderRadius:"4px",fontSize:W.s.medium,cursor:"pointer","> .toggleText":[(0,z.GD)("auto"),(0,z.q0)("ellipsis"),{padding:"0 ".concat(gc),fontSize:W.s.medium}],"> .sectionItemCount":[(0,z.GD)()],"> .icon":[(0,z.$Z)(),(0,z.gS)(),z.cc,{padding:"0 ".concat(gc),"> .plannerIcon":[(0,z.$Z)(),{transition:"transform 0.2s ease-in-out",transform:r?"rotate(180deg)":"rotate(0deg)"}]}]}],placeholderCard:[{position:"absolute",width:o,marginTop:di,marginBottom:di,inset:0,backgroundColor:Si(e)},(e===m.Sx.LoopLight||e===m.Sx.LoopDark)&&{borderRadius:K.B.LoopBorderRadius}],bottomDropZone:{flex:"1 1 auto",boxSizing:"border-box",height:"26px"},listBoxGroup:{position:"relative"},screenReaderOnly:{maxWidth:ki}};return(0,W.TW)(n,t)})),Cc=(0,V.J9)((e=>({root:(0,W.Zq)("taskBoardColumnGroup",e.root),sectionToggleButton:(0,W.Zq)("sectionToggleButton",e.sectionToggleButton),placeholderCard:(0,W.Zq)("placeholderCard",e.placeholderCard),bottomDropZone:(0,W.Zq)("bottomDropZone",e.bottomDropZone),screenReaderOnly:(0,W.Zq)("screenReaderOnly",e.screenReaderOnly),listBoxGroup:(0,W.Zq)("listBoxGroup",e.listBoxGroup)})));var bc=r(39068),Tc=r(56434),Sc=r.n(Tc),vc=r(91246),Pc=r(44459);class xc extends oi{componentDidUpdate(e,t){let r=[],o=!1;if(e.data!==this.props.data){const t=e.data.slice(0,this.state.numCardsToRender);r=this.props.data.slice(0,this.state.numCardsToRender),o=!Sr()(r,t)}if(!o||v()(r)){if(t.numCardsToRender!==this.state.numCardsToRender&&!v()(this.props.data)){const e=this.props.data.slice(t.numCardsToRender,this.state.numCardsToRender).filter((e=>!vc.o.isPlexTempId(e.id)));for(const t of e)this.props.fetchTaskPreview(t.id);(0,Pt.qj)(e).map((e=>this.props.fetchPermissionsWithTaskContext(e)))}}else{const e=r.filter((e=>!vc.o.isPlexTempId(e.id)));for(const t of e)this.props.fetchTaskPreview(t.id);(0,Pt.qj)(e).map((e=>this.props.fetchPermissionsWithTaskContext(e)))}}renderComponent(){var e;const t=this.getClassNames(),r=k.createElement("button",{className:t.sectionToggleButton,"data-dnd-role":"sectionToggle","aria-expanded":this.state.showSection,onClick:this.toggleShowSection},k.createElement("h4",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),k.createElement("div",{className:"sectionItemCount"},this.props.data.length),k.createElement("div",{className:"icon"},k.createElement(B.I,pe.Ju)));this._taskBoardCards=[];const o=this.props.data.slice(0,this.state.numCardsToRender).map(((e,t)=>this.renderEntityCard(e,t)));this.props.isOver&&null!==this.state.placeholderIndex&&o.splice(this.state.placeholderIndex,0,k.createElement("div",{style:{position:"relative"},className:"placeholderCardContainer",key:"placeholder","data-dnd-role":"placeholder"},k.createElement("div",{style:{opacity:0,visibility:"hidden"}},k.createElement(pc,{key:"placeholder card",index:null,entity:this.state.draggedEntity,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===Ks.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:!1,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:()=>{},onTaskCardClick:()=>{},setRef:()=>{},currentUserId:this.props.currentUserId,taskPermissions:{canAssign:!0,canDelete:!0,canEditDescription:!0,attachmentPermissions:ti.I.DisableNone,canEditTitle:!0,canUpdateDueDate:!0,canUpdatePriority:!0,canUpdatePriorityToUrgent:!0,checklistPermissions:ei.j.DisableNone},canAddGuests:!0,theme:this.props.theme})),k.createElement("div",{className:t.placeholderCard})));let n=!1;this.props.data&&this.state.numCardsToRender<this.props.data.length&&(n=!0);let a="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?a=U.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(a=Ee.G(U.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const s=this.props.canMoveTaskWithinSameColumn?U.p.Strings.TaskCard_MovableTaskCardAriaLabel:U.p.Strings.TaskCard_TaskCardAriaLabel,i=k.createElement("div",{className:(0,oe.A)(this.props.columnGroupClassName,t.root),"data-dnd-role":"columnGroup","data-can-drag-to-scroll":"true",ref:this.resolveRef(this,"columnGroup")},this.props.isCollapsable?r:null,null!=this.props.callbacks.addCardControlProvider&&this.props.showAddEntityCard?this.renderAddCardControl():null,k.createElement("div",{className:"listWrapper"},this.state.showSection&&!v()(o)?k.createElement("div",{className:(0,oe.A)("listboxGroup",t.listBoxGroup),role:"list","data-can-drag-to-scroll":"true"},k.createElement("div",{className:(0,oe.A)(bc.Z,t.screenReaderOnly)},a+this.props.columnName+s),k.createElement(Xt.H,{id:"taskColumn",hasMoreItemsToRender:n,orientation:Xt.Q.Vertical,onLastElementIsVisible:()=>this.handleInView()},o)):null),this.state.showSection?k.createElement("div",{"data-dnd-role":"bottomDropZone","data-can-drag-to-scroll":"true",className:t.bottomDropZone}):null);return this.props.disableColumnChanges||!this.props.connectDropTarget?i:null!==(e=this.props.connectDropTarget(i))&&void 0!==e?e:i}groupTarget(){const e=super.groupTarget();return{drop:(t,r,o)=>{var n;if(t.disableDragInto&&"card"===r.getItemType()){if(r.getItem().sourceColumnValue!==t.columnValue)return}return null===(n=e.drop)||void 0===n?void 0:n.call(e,t,r,o)},hover:Fr()(((t,r,o)=>{if(t.disableCustomOrderCards){const e=o;if(e.onHover(t,r,o),"card"===r.getItemType()){const o=r.getItem(),n=r.getClientOffset();if(null==n)return;e._previousPointerYPosition=n.y;let a=document.elementFromPoint(n.x,n.y);a=e.findTarget(a);const s=Sc()(e.props.data);let i=s.indexOf(o.entity);-1===i&&(null!=t.findPlaceHolderIndex?i=t.findPlaceHolderIndex(s,e.props.columnValue,o.entity):(s.push(o.entity),s.sort(Pc.BY),i=s.indexOf(o.entity))),a&&"topDropZone"===a.getAttribute("data-dnd-role")&&e.setPlaceholder(i,o),a&&"bottomDropZone"===a.getAttribute("data-dnd-role")&&e.setPlaceholder(i,o),a&&"card"===a.getAttribute("data-dnd-role")&&e.setPlaceholder(i,o),a&&"sectionToggle"===a.getAttribute("data-dnd-role")&&(!1===e.state.showSection&&e.setState({showSection:!0}),e.setPlaceholder(i,o))}}else{var n;null===(n=e.hover)||void 0===n||n.call(e,t,r,o)}}),50),canDrop:(t,r)=>{if(t.taskBoardCardCallbacks.taskCallbacks.getFlights().EnableProjectTasksForPlannerWeb&&"card"===r.getItemType()&&r.getItem()){const e=r.getItem(),o=e.props.taskPermissions;if(e.sourceColumnValue!==t.columnValue&&o){const e=t.taskBoardCardCallbacks.getCurrentTaskGroupingState();if(e===s.Yc.Progress&&!o.canUpdateProgress)return!1;if(e===s.Yc.Priority&&!o.canUpdatePriority)return!1;if(e===s.Yc.DueDate&&!o.canUpdateDueDate)return!1;if(e===s.Yc.Bucket&&!o.canUpdateBucket)return!1;if(e===s.Yc.Assignee&&!o.canAssign)return!1;if(e===s.Yc.Category&&!o.canUpdateAppliedLabels)return!1}else if(e.sourceColumnValue===t.columnValue&&o){if(e.secondaryGrouping!==t.secondaryGrouping&&!o.canUpdateProgress)return!1}}return!e.canDrop||e.canDrop(t,r)}}}getLastTaskCard(){return v()(this._taskBoardCards)?null:this._taskBoardCards[this._taskBoardCards.length-1].element}renderAddCardControl(){const e=this.props.callbacks.addCardControlProvider&&this.props.toggleAddCardControl?this.props.callbacks.addCardControlProvider(this.props.toggleAddCardControl.bind(this)):null;return k.createElement("div",{key:"addCardControl",className:"addControlContainer"},e)}renderEntityCard(e,t){return k.createElement(pc,{key:e.id,index:t,entity:e,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===Ks.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:this.props.secondaryGrouping,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:e=>{this.restoreFocusOnMoveTask(e),this.props.taskBoardCardCallbacks.onDeleteTask(e)},onTaskCardClick:this.onClickTaskCard,setRef:(e,t)=>null!=e&&this._taskBoardCards.push({element:e,id:t}),restoreFocusOnMoveTask:this.restoreFocusOnMoveTask,currentUserId:this.props.currentUserId,taskPermissions:this.props.getTaskPermissions(e),totalTasksInColumnGroup:this.props.data.length,taskBoardCardPositionInColumnGroup:t,canAddGuests:this.props.canAddGuests,onCardDragStateChange:this.props.onCardDragStateChange,theme:this.props.theme})}handleInView(){this.setState({numCardsToRender:this.state.numCardsToRender+xc.infiniteScrollIncrementSize})}getClassNames(){return Cc(kc(this.props.theme,this.props.styles,this.state.showSection))}constructor(e,t){if(super(e,t),this.toggleShowSection=()=>{this.logUsage(p.M.ToggleColumnGroupSection,{sectionId:this.props.columnValue,isCollapsed:String(this.state.showSection),isCompleteSection:String(this.props.secondaryGrouping)}),super.toggleShowSection()},this.restoreFocusOnMoveTask=e=>{const t=null==this.props.altFocusElement?this.columnGroup:this.props.altFocusElement;xr.n.ChangeFocusBeforeRemovalIFocusable(this._taskBoardCards,t,e)},this.onClickTaskCard=e=>{this.props.data.forEach(((t,r)=>{t.id===e&&(this._taskDetailsTaskIndex=r)})),this.props.openTaskDetails(e,(e=>{this.onTaskDetailsEditorDismiss(e)}))},this.onTaskDetailsEditorDismiss=e=>{xr.n.RestoreFocusAfterRemovalAlt(this._taskBoardCards.map((e=>e.element)),(()=>{this.props.altFocusElement&&this.props.altFocusElement.focus()}),this._taskDetailsTaskIndex)},this.state={draggedEntity:null,placeholderIndex:null,showSection:!this.props.isCollapsable,showAddEntityCard:!1,numCardsToRender:xc.infiniteScrollIncrementSize},!v()(e.data)){const t=e.data.slice(0,this.state.numCardsToRender);for(const e of t)this.props.fetchTaskPreview(e.id);(0,Pt.qj)(t).map((e=>this.props.fetchPermissionsWithTaskContext(e)))}}}xc.infiniteScrollIncrementSize=10;const yc=(0,ni.T)("card",xc.prototype.groupTarget(),xc.prototype.groupCollect)(xc);var fc,Dc=r(61804),wc=function(){return wc=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},wc.apply(this,arguments)};!function(e){e[e.None=0]="None",e[e.Dragging=1]="Dragging",e[e.Scrolling=2]="Scrolling"}(fc||(fc={}));var Lc=function(){function e(e,t){var r=this;if(this.options={maxScrollSpeed:1.2,maxSpeedZoneSize:20,maxScrollZoneSize:200,scrollZoneScale:.2,updateScrollSpeedThrottleInterval:50,minDragDistanceForScrolling:50},this.scrollState=fc.None,this.hasPointerLeftDragStartArea=!1,this.xSpeed=0,this.ySpeed=0,this.canScrollX=!1,this.canScrollY=!1,this.updateScrollSpeed=Fr()((function(){if(null!=r.pointerCoord&&null!=r.initialPointerCoord&&r.scrollState!==fc.None){if(!r.hasPointerLeftDragStartArea){var e=r.initialPointerCoord,t=e.x,o=e.y,n=r.pointerCoord,a=n.x,s=n.y,i=Math.abs(a-t),l=Math.abs(s-o);if(i<r.options.minDragDistanceForScrolling&&l<r.options.minDragDistanceForScrolling)return;r.hasPointerLeftDragStartArea=!0}var c=r.element.getBoundingClientRect(),p=c.left,d=c.right,u=c.top,h=c.bottom,m=c.width,g=c.height,k=r.options,C=k.maxScrollSpeed,b=k.maxSpeedZoneSize,T=k.maxScrollZoneSize,S=k.scrollZoneScale;if(r.canScrollX&&u<r.pointerCoord.y&&r.pointerCoord.y<h){var v=Math.min(T,m*S);r.xSpeed=Bc(r.pointerCoord.x,p,d,v,b,C)}else r.xSpeed=0;if(r.canScrollY&&p<r.pointerCoord.x&&r.pointerCoord.x<d){var P=Math.min(T,g*S);r.ySpeed=Bc(r.pointerCoord.y,u,h,P,b,C)}else r.ySpeed=0;0!==r.xSpeed||0!==r.ySpeed?r.setScrollState(fc.Scrolling):r.setScrollState(fc.Dragging)}}),this.options.updateScrollSpeedThrottleInterval),this.element=e,t&&(this.options=wc(wc({},this.options),t)),this.options.maxScrollSpeed<=0)throw new Error("maxScrollSpeed must be greater than 0");if(this.options.maxSpeedZoneSize<0)throw new Error("maxSpeedZoneSize cannot be negative");if(this.options.maxScrollZoneSize<0)throw new Error("maxScrollZoneSize cannot be negative");if(this.options.scrollZoneScale<=0||this.options.scrollZoneScale>.5)throw new Error("scrollZoneScale must be between 0 and 0.5");if(this.options.updateScrollSpeedThrottleInterval<0)throw new Error("updateScrollSpeedThrottleInterval cannot be negative");if(this.options.minDragDistanceForScrolling<0)throw new Error("minDragDistanceForScrolling cannot be negative")}return e.prototype.setIsDragging=function(e){e?this.scrollState===fc.None&&this.setScrollState(fc.Dragging):this.setScrollState(fc.None)},e.prototype.setPointerCoord=function(e){null==this.initialPointerCoord&&(this.initialPointerCoord=e),this.pointerCoord=e,this.updateScrollSpeed()},e.prototype.setScrollState=function(e){this.scrollState!==e&&(this.scrollState===fc.None?this.checkElementCanScroll():this.scrollState===fc.Scrolling&&this.endScroll(),this.scrollState=e,e===fc.None?this.resetState():e===fc.Scrolling&&this.startScroll())},e.prototype.startScroll=function(){var e,t=this,r=function(o){if(t.scrollState===fc.Scrolling){var n=null!=e?o-e:0;e=o;var a=t.xSpeed*n,s=t.ySpeed*n;0===a&&0===s||t.element.scrollBy(a,s),t.rafId=window.requestAnimationFrame(r)}};this.rafId=window.requestAnimationFrame(r)},e.prototype.endScroll=function(){null!=this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=null)},e.prototype.resetState=function(){this.xSpeed=0,this.ySpeed=0,this.pointerCoord=null,this.initialPointerCoord=null,this.hasPointerLeftDragStartArea=!1,this.canScrollX=!1,this.canScrollY=!1},e.prototype.checkElementCanScroll=function(){this.canScrollX=this.element.scrollWidth>this.element.clientWidth,this.canScrollY=this.element.scrollHeight>this.element.clientHeight},e}();function Bc(e,t,r,o,n,a){var s=t+o,i=r-o,l=o-n;return e<t+n?-a:e<s?-((s-e)/l*a):e>r-n?a:e>i?(e-i)/l*a:0}function Ec(e,t){var r=k.useContext(Dc.M).dragDropManager;if(!r)throw new Error("Unable to get dragDropManager from context. Wrap this in <DndProvider>.");k.useEffect((function(){if(null!=e.current){var o=new Lc(e.current,t),n=r.getMonitor(),a=n.subscribeToStateChange((function(){o.setIsDragging(n.isDragging())})),s=n.subscribeToOffsetChange((function(){var e=n.getClientOffset();e&&o.setPointerCoord(e)}));return function(){a(),s()}}}),[r,e,t])}const Ac=k.forwardRef(((e,t)=>{const{scrollerOptions:r,...o}=e;return Ec(t,r),k.createElement("ul",{...o,ref:t})})),Fc=k.forwardRef(((e,t)=>{const{scrollerOptions:r,...o}=e;return Ec(t,r),k.createElement("div",{...o,ref:t})}));var Ic=r(8403),Mc=r(61460),Nc=r.n(Mc),_c=r(22317);class Rc extends Qs{columnCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}componentDidMount(){this.props.autoFocus&&!this.props.showAddEntityCard&&this.columnElement&&this.columnElement.focus()}renderComponent(){var e;const t=this.getClassNames();let r="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?r=U.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(r=Ee.G(U.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const o=k.createElement("li",{ref:this.resolveRef(this,"columnElement"),"data-is-focusable":!0,className:t.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column",id:"column_".concat(this.props.pivotValue),tabIndex:0,"aria-label":this.props.disableDrag?Ee.G(U.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+r:Ee.G(U.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+r+U.p.Strings.TaskBoardColumn_ColumnAriaLabel,onKeyDown:this.onKeyDown},k.createElement(_c.pL,{rootMargin:"500px"},this.renderColumnContentCallback.bind(this)));return this.props.disableColumnChanges||!this.props.connectDragPreview?o:null!==(e=this.props.connectDragPreview(o))&&void 0!==e?e:o}renderColumnHeader(){const e=this.getClassNames(),t=this.props.headerImage&&k.createElement("div",{className:"headerImage"},this.props.headerImage),r=Ee.G(U.p.Strings.TaskBoardColumn_AddButtonContainerAriaLabel,this.props.title),o=k.createElement("div",{className:"addButtonContainer"},k.createElement("div",{className:(0,oe.A)(e.addButton,"active_0"),onClick:e=>{this.toggleAddCardControl(e)},onKeyPress:e=>{this.toggleAddCardControl(e)},"aria-label":r,role:"button",tabIndex:0,title:U.p.Strings.TaskBoardColumn_AddButtonContainerTooltipText,ref:this.resolveRef(this,"addTaskButtonElement")},k.createElement(B.I,pe.D5),k.createElement("span",{className:"addTaskText"},U.p.Strings.TaskBoardColumn_AddTaskButtonText))),n=null!=this.props.callbacks.addCardControlProvider&&!this.props.disableColumnChanges&&!this.props.disableAddTask;return k.createElement("div",{className:e.columnHeader,draggable:!this.props.disableDrag},k.createElement("div",{className:"columnHeaderTitle passive_1"},k.createElement("div",{className:e.titleSection},t,this.renderColumnTitle(),this.renderEditMenu(),!!this.props.isCollapsable&&k.createElement("button",{className:"columnCollapseButton",onClick:e=>{this.toggleShowSection(e)},"aria-expanded":!this.state.isCollapsed,"aria-label":this.props.title},k.createElement(B.I,{...pe.Ju,className:(0,oe.A)(pe.Ju.className,this.state.isCollapsed?"straight":"rotated")})))),n&&o)}renderColumnBody(){const e=this.getClassNames(),t=this.props.enableAutoScrollOnDragItem?Fc:"div";return k.createElement(t,{className:e.scrollable,"data-can-drag-to-scroll":"true",ref:this.columnBodyRef},this.renderPrimarySection(),this.props.useSecondaryClassification?this.renderSecondarySection():null)}renderPrimarySection(){let e=this.props.data;this.props.useSecondaryClassification&&this.props.callbacks.secondaryClassifier&&(e=kr()(this.props.data,(e=>!this.props.callbacks.secondaryClassifier(e))));const t={addCardControlProvider:this.props.callbacks.addCardControlProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},r=this.addTaskButtonElement||this.props.emptyColumnFocusElement||this.columnElement,o=e.map((e=>e.id)),n=this.props.modifiedTaskIds?Nc()(this.props.modifiedTaskIds,o):[];return k.createElement(yc,{columnGroupClassName:"primarySection",columnName:this.props.title,columnValue:this.props.pivotValue,modifiedTaskIds:n,data:e,callbacks:t,isCollapsable:!1,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,toggleAddCardControl:()=>this.toggleAddCardControl(),secondaryGrouping:!1,disableCustomOrderCards:this.props.disableCustomOrderCards,disableDragInto:this.props.disableDragInto,findPlaceHolderIndex:this.props.findPlaceHolderIndex,altFocusElement:null!==r&&void 0!==r?r:void 0,openTaskDetails:this.props.openTaskDetails,ref:this.resolveRef(this,"primaryTaskBoardColumnGroup"),fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderSecondarySection(){if(!this.props.callbacks.secondaryClassifier)return null;const e=kr()(this.props.data,(e=>this.props.callbacks.secondaryClassifier(e)));if(this._secondarySectionLength=e.length,0===this._secondarySectionLength)return null;const t={sectionTitleProvider:this.props.callbacks.secondarySectionTitleProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},r=null==this.primaryTaskBoardColumnGroup?null:this.primaryTaskBoardColumnGroup.getDecoratedComponentInstance().getLastTaskCard(),o=null==r?this.addTaskButtonElement:r,n=e.map((e=>e.id)),a=this.props.modifiedTaskIds?Nc()(this.props.modifiedTaskIds,n):[];return k.createElement(yc,{columnGroupClassName:"secondarySection",columnName:this.props.title,columnValue:this.props.pivotValue,data:e,modifiedTaskIds:a,callbacks:t,isCollapsable:!0,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,secondaryGrouping:!0,disableCustomOrderCards:this.props.disableCustomOrderCards,findPlaceHolderIndex:this.props.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,altFocusElement:null!==o&&void 0!==o?o:void 0,fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,disableDragInto:this.props.disableDragInto,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderColumnContentCallback(e){let{inView:t,ref:r}=e;return t||!this.props.bucketVirtualization||this.props.isDragging||this.state.isCardDragged?k.createElement("div",{ref:r,className:"columnContent"},this.props.connectDragSource?this.props.connectDragSource(this.renderColumnHeader()):this.renderColumnHeader(),this.renderColumnBody(),this.state.isDeleteDialogOpen?this.getDeleteDialog():null):k.createElement("div",{ref:r,className:"columnContent"})}renderEditMenu(){if(this.state.isEditingTitle||this.props.disableColumnChanges||!this.props.canEditTitle&&!this.props.canDeleteColumn&&!this.props.canMoveColumnLeft&&!this.props.canMoveColumnRight)return null;const e=k.createElement(_r.K,{className:"editMenuLauncher",onClick:this.toggleEditMenu,iconProps:pe.XP,ariaLabel:U.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,title:U.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,elementRef:this.editMenuLauncher,plannerTheme:this.props.theme}),t=[];this.props.canEditTitle&&t.push({key:"Edit",name:U.p.Strings.TaskBoardColumn_RenameBucket,onClick:this.startEditingColumnTitle}),this.props.canDeleteColumn&&t.push({key:"Delete",name:U.p.Strings.TaskBoardColumn_DeleteBucket,onClick:this.openDeleteDialog}),this.props.canMoveColumnRight&&t.push({key:"MoveRight",name:U.p.Strings.TaskBoardColumn_MoveBucketRight,onClick:this.moveBucket.bind(this,!0)}),this.props.canMoveColumnLeft&&t.push({key:"MoveLeft",name:U.p.Strings.TaskBoardColumn_MoveBucketLeft,onClick:this.moveBucket.bind(this,!1)});const r=k.createElement(ie.l,{shouldFocusOnMount:!0,items:t,directionalHint:se.A.bottomAutoEdge,target:this.editMenuLauncher,onDismiss:this.dismissEditMenu,appTheme:this.props.theme}),o=(0,oe.A)("editMenu",{stayOpen:this.state.isEditMenuVisible});return k.createElement("div",{className:o},e,this.state.isEditMenuVisible?r:null)}renderColumnTitle(){if(this.state.isEditingTitle)return k.createElement($s.A,{className:"editColumnTextField",autoComplete:"off",autoFocus:!0,tabIndex:0,placeholder:this.props.title,onKeyUp:this.columnTitleKeyUp,onKeyDown:this.columnTitleTextfieldKeyDown,onBlur:this.onTextFieldBlur,onChange:(e,t)=>{this.columnTitleChanged(t)},ariaLabel:U.p.Strings.TaskBoardColumn_EditTitleAriaLabel,value:this.state.updatedTitle,maxLength:Ic.f.TitleMaxLength,styleType:Ys.u.Bucket,appTheme:this.props.theme});{const e=(0,oe.A)("columnTitle",{readOnly:!this.props.canEditTitle||this.props.disableColumnChanges});return this.props.canEditTitle&&!this.props.disableColumnChanges?k.createElement("div",{className:e,tabIndex:0,onClick:this.startEditingColumnTitle,onKeyDown:this.startEditingColumnTitle,role:"button",title:this.props.title,ref:this.columnTitle},k.createElement("h3",null,this.props.title)):k.createElement("div",{className:e,title:this.props.title},k.createElement("h3",null,this.props.title))}}getDeleteDialog(){const e=(0,R.S9)(this.props.theme),t=(0,R.XK)(this.props.theme);return k.createElement(I.l,{hidden:!this.state.isDeleteDialogOpen,onDismiss:this.dismissDeleteDialog.bind(this),dialogContentProps:{className:m.vt,type:M.h.normal,title:"null"===this.props.pivotValue?U.p.Strings.TaskBoardColumn_DeleteUncategorizedTitle:Ee.G(U.p.Strings.TaskBoardColumn_DeleteBucketText,this.props.title),subText:"null"===this.props.pivotValue?U.p.Strings.TaskBoardColumn_DeleteUncategorizedTasksSubtext:U.p.Strings.TaskBoardColumn_DeleteBucketTasksText,styles:t},styles:e,modalProps:{className:"deleteColumnDialog",containerClassName:m.bI,isBlocking:!1}},k.createElement(N.E,null,k.createElement(E.j,{onClick:this.deleteColumn},U.p.Strings.TaskBoardColumn_DeleteBucketButtonText),k.createElement(va.Y,{onClick:this.dismissDeleteDialog},U.p.Strings.TaskBoardColumn_CancelDelete)))}getClassNames(){const e=!this.props.canEditTitle||this.props.disableColumnChanges;return hc(dc(this.props.theme,this.props.styles,this.props.displayMode,e,this.props.isSlimView,this.props.showAddEntityCard,this.state.isCollapsed,this.props.isTeamsSplitUI,h.B.isUnoContext))}constructor(e,t){var r;super(e,t),r=this,this.editMenuLauncher=k.createRef(),this.columnTitle=k.createRef(),this.SET_FOCUS_TIMEOUT=60,this.columnBodyRef=k.createRef(),this.toggleAddCardControl=e=>{(null==e||ne.a.isButtonPress(e))&&(this.props.callbacks.addCardControlProvider&&(this.props.showAddEntityCard&&this.addTaskButtonElement?(this.addTaskButtonElement.focus(),this.props.onCloseAddTaskCard()):this.props.onOpenAddTaskCardFromAddTaskButton(),this.props.toggleAddTaskFormVisibility(this.props.pivotValue)),null!=e&&e.stopPropagation())},this.toggleShowSection=e=>{null!=e&&(e.stopPropagation(),e.preventDefault());const t=this.props.pivotValue===Ct.$.Complete;this.logUsage(p.M.ToggleColumnGroupSection,{sectionId:this.props.pivotValue,isCollapsed:String(!this.state.isCollapsed),isCompleteSection:String(t)}),this.setState((e=>({...e,isCollapsed:!e.isCollapsed})))},this.toggleEditMenu=()=>{this.setState((e=>({...e,isEditMenuVisible:!e.isEditMenuVisible})))},this.dismissEditMenu=()=>{this.setState((e=>({...e,isEditMenuVisible:!1})))},this.startEditingColumnTitle=e=>{e.stopPropagation(),ne.a.isButtonPress(e)&&(this.props.setTaskBoardEditMode(Gc.Edit),this.setState((e=>({...e,isEditingTitle:!0,updatedTitle:this.props.title}))))},this.onKeyDown=e=>{if(e.stopPropagation(),this.props.disableColumnChanges||!this.props.onReorderColumn)return;const t=!(0,G.jI)();e.ctrlKey&&e.shiftKey&&e.keyCode===O.D.Period?(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,t)):e.ctrlKey&&e.shiftKey&&e.keyCode===O.D.Comma&&(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,!t))},this.onTextFieldBlur=e=>{this.updateColumnTitle(),this.dismissEditTitle(!1)},this.moveBucket=e=>{setTimeout((()=>{this.setFocusOnMoreMenu()}),this.SET_FOCUS_TIMEOUT),this.props.onReorderColumn&&(e?this.props.onReorderColumn(this.props.pivotValue,!0):this.props.onReorderColumn(this.props.pivotValue,!1))},this.columnTitleKeyUp=e=>{e.stopPropagation()},this.columnTitleTextfieldKeyDown=e=>{const t=ne.a.getKey(e);t===O.D.ESCAPE?this.dismissEditTitle():t===O.D.ENTER&&(this.updateColumnTitle(),this.dismissEditTitle())},this.columnTitleChanged=e=>{this.setState((t=>({...t,updatedTitle:e})))},this.updateColumnTitle=()=>{this.props.updateColumnTitle&&(this.state.updatedTitle&&""!==this.state.updatedTitle.trim()&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(this.state.updatedTitle),""===this.state.updatedTitle&&this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()===s.Yc.Category&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(""))},this.dismissEditTitle=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r.props.setTaskBoardEditMode(Gc.Drag),r.setState((e=>({...e,isEditingTitle:!1,updatedTitle:r.props.title})),(()=>{var t;e&&(null===(t=r.columnTitle)||void 0===t||null===(t=t.current)||void 0===t||t.focus())}))},this.openDeleteDialog=()=>{this.setState((e=>({...e,isDeleteDialogOpen:!0})))},this.dismissDeleteDialog=()=>{this.setFocusOnMoreMenu(),this.setState((e=>({...e,isDeleteDialogOpen:!1})))},this.deleteColumn=()=>{this.setState((e=>({isDeleteDialogOpen:!1})),(()=>{"null"===this.props.pivotValue&&this.context.usageLogger.logData("TaskBoardColumn",p.M.DeleteUncategorizedBucket),null!=this.props.onDeleteColumn&&this.props.onDeleteColumn(this.props.pivotValue)}))},this.onKeyboardTaskReorder=(e,t,r)=>{if(!this.props.data)return;const o=this.getSortAfterBeforeTasks(t,r,this.props.data);null===o[0]&&null===o[1]||this.props.callbacks.valueSetter(t,o[0],o[1],e)},this.getSortAfterBeforeTasks=(e,t,r)=>{let o=null,n=null;const a=r.indexOf(e);if(t){if(0===a)return[n,o];for(let t=a-1;t>=0&&(e.isComplete()!==r[t].isComplete()||(o?n||(n=r[t]):o=r[t],!n||!o));t--);}else{if(a===r.length-1)return[n,o];for(let t=a+1;t<r.length&&(e.isComplete()!==r[t].isComplete()||(n?o||(o=r[t]):n=r[t],!n||!o));t++);}return[n,o]},this.setFocusOnMoreMenu=()=>{this.editMenuLauncher.current?this.editMenuLauncher.current.focus():null!=this.addTaskButtonElement&&this.addTaskButtonElement.focus()},this.onCardDragStateChange=e=>{this.setState({isCardDragged:e})},this._secondarySectionLength=0,this.state={showAddEntityCard:!1,isCollapsed:this.props.isCollapsed||!1,isEditingTitle:!1,updatedTitle:this.props.title,isEditMenuVisible:!1,isDeleteDialogOpen:!1,isCardDragged:!1}}}const Uc=(0,jt.I)("column",Rc.prototype.columnSource(),Rc.prototype.columnCollect)(Rc),Hc="32px",Oc=(0,X.vb)((0,X.jz)(K.B.TopHeaderIconHorizontalOffset)-(0,X.jz)(si)),Vc=(0,V.J9)((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ks.Board,o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;const s=ze.d.isLoopTheme(e);let i=ki,l=si;switch(e){case m.Sx.LoopLight:case m.Sx.LoopDark:i=mi,l=ii;break;case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:a||(l=li);case m.Sx.Light:case m.Sx.Dark:case m.Sx.SharePoint:}const c={root:[(0,z.GD)(),(0,z.gS)(),r===Ks.Board&&{"> ul.columnsList":{padding:a?"0 ".concat(Oc," 0 15px"):"0 ".concat(Oc)},".sharepointApp &":{padding:"".concat(K.B.SharepointContentTopPadding," ").concat(K.B.SharepointHorizontalPadding," ").concat(K.B.SharepointContentBottomPadding)}},r===Ks.List&&{marginLeft:K.B.ShadowMargin}],columnsList:[(0,z.GD)(),r===Ks.Board&&[(0,z.gS)(),{overflowX:"auto",overflowY:"hidden","> li":[(0,z.$Z)(i)]}],r===Ks.List&&[(0,z.gS)("column"),{"> li":[(0,z.$Z)()]}]],createColumn:[Ci(e,r,o,n,a),{"> .columnContent > .columnHeader":[bi(e),{"> .columnHeaderTitle > .titleSection":[Ti(e,!1),s&&{overflow:"visible","> .columnTitle":[(0,z.$Z)(),{".plannerIcon":[(0,z.$Z)("auto"),(0,z._D)(e),gi(e),(0,q.kE)(),{display:"flex",width:Hc,height:Hc,borderRadius:"8px"}],"> span":{display:"none"}}]}]}]}],addColumnButton:[z.xK,(0,z.aS)(e),{cursor:"pointer",":hover":[(0,z.aS)(e)]}],placeholderColumn:[{width:i,padding:"0 ".concat(l),boxSizing:"content-box",backgroundColor:Si(e),"> div":{opacity:0,visibility:"hidden"}},(e===m.Sx.LoopLight||e===m.Sx.LoopDark)&&{borderRadius:K.B.LoopBorderRadius}]};return(0,W.TW)(c,t)})),Wc=(0,V.J9)((e=>({root:(0,W.Zq)("taskBoardView",e.root),columnsList:(0,W.Zq)("columnsList",e.columnsList),createColumn:(0,W.Zq)("createColumn",e.createColumn),addColumnButton:(0,W.Zq)("addColumnButton",e.addColumnButton),placeholderColumn:(0,W.Zq)("placeholderColumn",e.placeholderColumn)})));var Gc;!function(e){e[e.Edit=0]="Edit",e[e.Drag=1]="Drag"}(Gc||(Gc={}));class zc extends js{renderComponent(){var e;const t=this.getClassNames(),r=this.props.columnDefinitions;this._boardColumns=[];const o=r.map(((e,t)=>this.renderBoardViewColumn(e,t))),n=null!=this.state.draggedColumnIndex?this.props.columnDefinitions[this.state.draggedColumnIndex]:null;this.props.isOver&&null!=this.state.placeholderIndex&&this.state.placeholderIndex>=0&&null!=n&&o.splice(this.state.placeholderIndex,0,k.createElement("li",{className:t.placeholderColumn,key:"placeholder","data-dnd-role":"placeholder"},k.createElement("div",null,this.renderBoardViewColumn(n,null))));const a=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null,s=this.props.enableAutoScrollOnDragItem?Ac:"ul",i=k.createElement("div",{className:t.root},k.createElement(s,{className:t.columnsList,ref:this.boardViewUlElementRef,...a},o,this.renderCreateColumn()));return this.props.disableColumnChanges||!this.props.connectDropTarget?i:null!==(e=this.props.connectDropTarget(i))&&void 0!==e?e:i}componentDidUpdate(e,t){this.shouldSetFocus&&this.addColumnButton&&(this.addColumnButton.focus(),this.shouldSetFocus=!1)}renderBoardViewColumn(e,t){var r;const{callbacks:o}=this.props,n={secondaryClassifier:o.secondaryClassifier,secondarySectionTitleProvider:o.secondarySectionTitleProvider,secondaryValueSetter:o.secondaryValueSetter,valueSetter:(t,r,n,a)=>o.valueSetter(t,e.pivotValue,r,n,a),addCardControlProvider:o.addCardControlProvider?t=>o.addCardControlProvider(e.pivotValue,null,e.dataEntities?e.dataEntities[0]:null,(()=>{}),t):void 0},a=null!=e.pivotValue?e.pivotValue.toString():"null",s=null===e.pivotValue||this.state.interactionMode===Gc.Edit||!e.canEditTitle||!this.props.enableColumnMove||this.props.disableColumnChanges,i=null!==(r=this.props.enableColumnMove)&&void 0!==r&&r,l=e.dataEntities?e.dataEntities.map((e=>e.id)):[],c=this.props.modifiedTaskIds?Nc()(this.props.modifiedTaskIds,l):[];return k.createElement(Uc,{autoFocus:this.props.autoFocus&&0===t,key:a,data:e.dataEntities,modifiedTaskIds:c,canEditTitle:e.canEditTitle,canDeleteColumn:e.canDeleteColumn,canMoveColumnRight:i&&e.canMoveColumnRight,canMoveColumnLeft:i&&e.canMoveColumnLeft,updateColumnTitle:e.onUpdateTitle,onDeleteColumn:e=>this.onDeleteColumn(e),onReorderColumn:(e,t)=>this.onReorderColumn(e,t),useSecondaryClassification:this.props.useSecondaryClassification,callbacks:n,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,title:e.title,pivotValue:a,index:t,disableDrag:s,setTaskBoardEditMode:this.setTaskBoardEditMode.bind(this),isCollapsable:e.isCollapsable,isCollapsed:e.isCollapsed,headerImage:e.headerImage,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,toggleAddTaskFormVisibility:this.props.toggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.props.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.props.onCloseAddTaskCard,showAddEntityCard:!(!this.props.showAddEntityCardCallback||this.props.disableColumnChanges)&&this.props.showAddEntityCardCallback(a),disableAddTask:e.disableAddTask,disableCustomOrderCards:e.disableCustomOrderCards,disableDragInto:e.disableDragInto,findPlaceHolderIndex:e.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,emptyColumnFocusElement:this.props.emptyColumnFocusElement,ref:e=>{null!=(null===e||void 0===e?void 0:e.getDecoratedComponentInstance())&&this._boardColumns.push({element:e.getDecoratedComponentInstance().columnElement,id:a})},fetchTaskPreview:this.props.fetchReferencePreviewForTask,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,bucketVirtualization:this.props.bucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:e.canMoveTaskWithinSameColumn,enableAutoScrollOnDragItem:this.props.enableAutoScrollOnDragItem,isTeamsSplitUI:this.props.isTeamsSplitUI,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext})}setTaskBoardEditMode(e){this.setState((t=>({...t,interactionMode:e})))}renderCreateColumn(){if(this.props.columnCreationEnabled){const e=this.getClassNames();return k.createElement("li",{className:e.createColumn},k.createElement("div",{className:"columnContent","data-can-drag-to-scroll":"true"},k.createElement("div",{className:"columnHeader"},k.createElement("div",{className:"columnHeaderTitle"},k.createElement("h3",{className:"titleSection"},this.renderAddColumnControlArea())))))}return null}renderAddColumnControlArea(){if(this.props.disableColumnChanges)return null;const e=this.getClassNames();return this.state.showAddColumnControl?k.createElement("form",{onSubmit:this.createColumn.bind(this),autoComplete:"off"},k.createElement($s.A,{className:"editColumnTextField active_1",autoFocus:!0,tabIndex:0,placeholder:this.props.createColumnPlaceholder,onKeyUp:this.onCreateColumnKeyUp.bind(this),onBlur:this.createColumn.bind(this),onChange:(e,t)=>{this.columnNameChanged(t)},ariaLabel:this.props.createColumnButtonText,value:this.state.newColumnName,maxLength:Ic.f.TitleMaxLength,styleType:Ys.u.Bucket,appTheme:this.props.theme})):k.createElement("button",{className:(0,oe.A)("columnTitle",e.addColumnButton),onClick:this.toggleAddColumnControl.bind(this),ref:this.resolveRef(this,"addColumnButton"),title:U.p.Strings.TaskBoardColumn_AddNewBucket,"aria-label":U.p.Strings.TaskBoardColumn_AddNewBucket},k.createElement(B.I,pe.D5),k.createElement("span",{className:"active_1"}," ",this.props.createColumnButtonText))}toggleAddColumnControl(){this.setState((e=>({...e,showAddColumnControl:!e.showAddColumnControl,newColumnName:"",interactionMode:Gc.Drag})))}onCreateColumnKeyUp(e){ne.a.getKey(e)===O.D.ESCAPE&&this.dismissAddColumn()}createColumn(e){e.preventDefault(),""!==this.state.newColumnName&&null!=this.props.createColumnCallback&&this.props.createColumnCallback(this.state.newColumnName),this.dismissAddColumn()}dismissAddColumn(){null!=this.props.createColumnCallback&&(this.shouldSetFocus=!0),this.setState((e=>({...e,showAddColumnControl:!1,newColumnName:"",interactionMode:Gc.Drag})))}columnNameChanged(e){this.setState((t=>({...t,newColumnName:e})))}onReorderColumn(e,t){if(this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==s.Yc.Bucket)return;if(!this.props.callbacks.onColumnDrop)return;const r=this.props.columnDefinitions,o=br()(r,(t=>t.pivotValue===e));if(-1===o)return;let n=null,a=null;t?(a=r[o+1]?r[o+1].pivotValue:null,n=r[o+2]?r[o+2].pivotValue:null):(a=r[o-2]?r[o-2].pivotValue:null,n=r[o-1]?r[o-1].pivotValue:null),null==n&&null==a||this.props.callbacks.onColumnDrop(e,a,n)}onDeleteColumn(e){xr.n.ChangeFocusBeforeRemovalIFocusable(this._boardColumns,this.addColumnButton,e),null!=this.props.deleteColumnCallback&&this.props.deleteColumnCallback(e)}getClassNames(){return Wc(Vc(this.props.theme,this.props.styles,this.props.displayMode,this.props.isSlimView,this.props.isTeamsSplitUI,h.B.isUnoContext))}constructor(e,t){super(e,t),this.shouldSetFocus=!1}}const Zc=(0,ni.T)("column",zc.prototype.boardTarget(),zc.prototype.boardCollect)(zc);var Kc=r(15018),qc=r(34717);const Jc=K.B.userBubbleDiameter,jc="3px",$c="5px",Yc="10px",Xc=K.B.ShadowMargin,Qc=(0,V.J9)(((e,t)=>{const r=ze.d.isLoopTheme(e);let o=hi,n="228px",a=K.B.PlannerBorderRadius;switch(e){case m.Sx.LoopLight:case m.Sx.LoopDark:o=mi,n="200px",a=K.B.LoopBorderRadius;case m.Sx.Light:case m.Sx.Dark:case m.Sx.TeamsLight:case m.Sx.TeamsDark:case m.Sx.TeamsContrast:case m.Sx.SharePoint:}const s={root:[(0,z.gS)("column","nowrap"),(0,z.NX)(e),(0,q.kE)(),{position:"relative",width:o,marginTop:Xc,borderRadius:a,".ms-Callout &":{marginTop:"0px"},".setFieldsSection":[(0,z.$Z)(),{padding:"0px ".concat("16px")}]},e!==m.Sx.TeamsContrast&&{boxShadow:K.B.hoverShadow},e===m.Sx.TeamsContrast&&{backgroundColor:Z.z.Black,border:"1px solid ".concat(Z.z.White),boxSizing:"border-box"}],titleSection:[(0,z.gS)("row"),(0,z.$Z)(),{marginTop:"16px",marginBottom:(0,X.vb)((0,X.jz)(Yc)-(0,X.jz)(jc)),"> .plannerIcon":[(0,z.$Z)("20px"),{marginRight:Yc,color:Z.z.NeutralTertiary},e===m.Sx.TeamsContrast&&{color:Z.z.White}]}],textField:[(0,z.$Z)(n),!r&&(0,q.kE)(),{".ms-Callout &":[(0,z.$Z)("192px")],".ms-TextField-fieldGroup":(0,z.nK)(e)}],property:[(0,z.gS)(),(0,z.$Z)(),(0,z.aS)(e),!r&&(0,q.kE)(),{alignItems:"center",padding:"".concat(jc," 0px ").concat(r?"0px":jc," 0px"),minHeight:Jc,fontSize:Bt.s.medium,"> .launcher":[z.xK,(0,z.gS)("row","nowrap"),(0,z.GD)(),{cursor:"pointer",alignItems:"center",width:"100%","> *":{margin:$c},"> i":[(0,z.$Z)("20px"),{marginLeft:"0"}],"> span, > div":[(0,z.GD)()]},r&&{":hover":[(0,z._D)(e),(0,q.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,q.h8)()}]}]}],addTaskButton:[(0,z.$Z)(r?"32px":"44px"),(0,z.jU)(e),r&&{width:"236px",alignSelf:"center",marginBottom:"10px"},{fontSize:Bt.s.medium,color:Z.z.White,border:"none",marginTop:(0,X.vb)((0,X.jz)("14px")-(0,X.jz)(jc)/2),borderRadius:r?K.B.LoopButtonBorderRadius:"0 0 ".concat(K.B.PlannerBorderRadius," ").concat(K.B.PlannerBorderRadius),"&:hover":[{cursor:"pointer"},r&&(0,q.cP)()]}]};return(0,W.TW)(s,t)})),ep=(0,V.J9)((e=>({root:(0,W.Zq)("addTaskCard",e.root),titleSection:(0,W.Zq)("titleSection",e.titleSection),textField:(0,W.Zq)("addTaskTextField",e.textField),property:(0,W.Zq)("property",e.property),addTaskButton:(0,W.Zq)("addTaskButton",e.addTaskButton)}))),tp=(0,V.J9)((e=>{const t=ze.d.isLoopTheme(e);return{root:[(0,z.GD)(),{width:"100%"},t&&{":hover":[(0,q.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,q.h8)()}]}],assigneeRow:[{"> .ms-Facepile-addButton i":{margin:"2px 10px 10px 0px"},"> .ms-Facepile":{margin:"6px 0px"}}],assignDiv:t&&{":hover":{"> .plannerIcon, .assignLabel":[(0,z._D)(e),(0,q.h8)()]}},addFriendIcon:{margin:"".concat($c," 10px ").concat($c," 0px")}}}));var rp=r(98352),op=r(14740),np=r.n(op),ap=r(12759),sp=r.n(ap),ip=r(97943);class lp extends g.${name(){return"AddTaskCard"}renderComponent(){const e=this.getClassNames(),t=this.renderSetBucket(e),r=this.renderSetDueDate(e),o=this.renderAssignPicker(e);return k.createElement("div",{"aria-label":U.p.Strings.AddTaskCard_AddTaskFormAriaLabel,className:(0,oe.A)(e.root,"walkthroughStep2"),ref:this.resolveRef(this,"addTaskCardElement"),onBlur:this.onAddTaskCardBlur,onClick:this.stopPropagation,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp},k.createElement("div",{className:"setFieldsSection"},this.renderTitleSection(e),!this.props.hideSetBucket&&t,!this.props.hideSetDueDate&&r,!this.props.hideSetAssignment&&o),k.createElement("button",{className:e.addTaskButton,onClick:this.createTask},U.p.Strings.AddTaskCard_AddTaskButtonText))}renderTitleSection(e){return k.createElement("div",{className:e.titleSection},k.createElement(B.I,pe.vx),this.renderTextField(e.textField))}renderTextField(e){const t={className:e,autoFocus:this.props.autoFocus,tabIndex:0,placeholder:U.p.Strings.AddTaskCard_AddTaskPlaceholderText,onClick:this.stopPropagation,onKeyPress:this.createTask,onChange:(e,t)=>{this.taskNameChanged(t)},ariaLabel:U.p.Strings.AddTaskCard_TaskNameText,value:this.state.newTaskName,errorMessage:this.state.taskNameErrorMsg,styleType:Ys.u.Dialog,maxLength:Kc.i.TitleMaxLength,appTheme:this.props.theme},r={uniqueIdentifier:this.state.newTaskId,...t,styles:(0,rp.pS)(t.appTheme,t.styleType),highlightStyle:(0,z.H)(t.appTheme),onDateChange:this.onSmartControlDateChange};return this.props.renderSmartTextField&&this.state.showSmartTextField?this.props.renderSmartTextField(r):k.createElement($s.A,t)}renderSetBucket(e){if(0===this.props.buckets.length)return null;""===this.defaultBucketId&&(this.defaultBucketId=this.props.buckets[0].id);const t=[];let r=null;this.props.buckets.forEach((e=>{this.state.bucketId===e.id&&(r=e),t.push({key:e.id,name:e.title,checked:this.state.bucketId===e.id,onClick:this.setBucket})}));const o=k.createElement(ie.l,{shouldFocusOnMount:!0,items:t,directionalHint:se.A.bottomAutoEdge,target:this._bucketMenuElement,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme}),n=null==r?U.p.Strings.AddTaskCard_BucketText:r.title;return k.createElement("div",{className:(0,oe.A)("addTaskBucket",e.property)},k.createElement("button",{className:"launcher",ref:e=>this._bucketMenuElement=e,onClick:this.toggleBucketMenu,title:n,"aria-label":Ee.G(U.p.Strings.AddTaskCard_BucketButtonAriaLabel,n)},k.createElement(B.I,pe.fD),k.createElement("span",null,n)),this.state.isBucketMenuVisible?o:null)}renderSetDueDate(e){const t=null==this.state.dueDate?U.p.Strings.AddTaskCard_DueDateText:Ee.G(U.p.Strings.AddTaskCard_DueDateValueText,ec.lz.FormatDate(Us()(this.state.dueDate))),r=Al(El(this.props.theme,this.props.styles)).callout;return k.createElement("div",{className:(0,oe.A)("addTaskDueDate",e.property)},k.createElement("button",{className:"launcher",ref:e=>this._dueDateButtonElement=e,onClick:this.onDueDateClick,title:t},k.createElement(B.I,pe.cx),k.createElement("span",null,t)),this.state.showCalendar&&k.createElement(Re.P,{ariaLabel:U.p.Strings.TaskEditor_SelectEndDateAriaLabel,isBeakVisible:!1,className:(0,oe.A)("ms-DatePicker-callout",r),gapSpace:0,doNotLayer:!1,role:"dialog",target:this._dueDateButtonElement,directionalHint:se.A.bottomLeftEdge,onDismiss:this.onDueDateCalendarDismiss,setInitialFocus:!0},k.createElement(Ne.Y,{isClickableOutsideFocusTrap:!0},k.createElement(Ll.V,{onSelectDate:this.onSelectDueDate,onDismiss:this.onDueDateCalendarDismiss,isMonthPickerVisible:!1,value:null==this.state.dueDate?void 0:this.state.dueDate.toDate(),today:new Date,theme:this.props.theme}))))}renderAssignPicker(e){return k.createElement("div",{className:(0,oe.A)("addTaskAssignee",e.property),ref:this.resolveRef(this,"addTaskAssignee")},this.renderAssignmentControl())}renderAssignmentControl(){var e;const t=np()(Pr()(this.state.assignedToUserIds,(e=>this.props.getUser(e))));return k.createElement(Ai.UI,{layout:Ai.Yn.Compact,assignees:t,currentUserId:this.props.currentUserId,canEditAssignments:!0,canEditAccessPermissions:this.props.canAddUser,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:this.props.canAddUser,canAccessPlanViaSharedContainerOnly:null!==(e=this.props.canAccessPlanViaSharedContainerOnly)&&void 0!==e&&e,minQueryTermLength:m.c9.MinCharsNeededToSearch,maxAssignees:this.props.maxAssignees,maxDisplayablePersonas:m.eg.MaxDisplayablePersonasAddTaskCard,addIconPlacement:Ai.aq.BeforeAssignees,strings:{assignControlLauncherText:U.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:U.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:U.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:U.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:U.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:U.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:U.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:U.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:U.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:U.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:U.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:U.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:U.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:U.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:U.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:U.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:U.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:U.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:U.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:this.props.onRenderPersona,getUsersWithPlanAccess:()=>this.props.getAssigneePool()||[],getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,getSearchQueryResults:this.props.getUsersWithKeyword,getUserPhoto:this.props.getUserPhoto,showAssigneeLimitError:this.props.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,theme:this.props.theme,renderAssignToMeButton:this.props.enableSuggestedAssigneeUI,styles:tp(this.props.theme)})}alertUser(){this.props.alertUser("SharedComponents_AddTaskErrorToastTitle")}taskNameChanged(e){this.setState((t=>({newTaskName:e,taskNameErrorMsg:""!==e.trim()?"":t.taskNameErrorMsg})))}resetControl(){this.setState({newTaskId:vc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,showCalendar:!1,dueDate:this.props.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0})}isFormDirty(){return null!=this.state.newTaskName&&""!==this.state.newTaskName.trim()||!Sr()(this.state.dueDate,this.props.defaultDueDate)||!v()(this.state.assignedToUserIds)||this.state.bucketId!==this.defaultBucketId}getClassNames(){return ep(Qc(this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.onAddTaskCardBlur=e=>{const t=e.relatedTarget||document.activeElement;(0,ip.s)(this.addTaskCardElement,t)||t.className.indexOf("addButton")>=0||t.className.indexOf("addTaskButton")>=0||this.isFormDirty()||this.props.toggleAddCard(e)},this.toggleBucketMenu=e=>{e.stopPropagation(),this.setState((e=>({isBucketMenuVisible:!e.isBucketMenuVisible})))},this.setBucket=(e,t)=>{e.stopPropagation(),this.setState({bucketId:t.key,isBucketMenuVisible:!1})},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.onDueDateClick=e=>{e.stopPropagation(),this.setState((e=>({showCalendar:!e.showCalendar})))},this.onDueDateCalendarDismiss=()=>{this.setState({showCalendar:!1})},this.onSelectDueDate=e=>{this.setState({showCalendar:!1,dueDate:null!=e?ec.lz.ToUTC10am(Us()(e)):void 0,showSmartTextField:!1})},this.onSmartControlDateChange=e=>{this.setState({dueDate:e?ec.lz.ToUTC10am(Us()(e)):this.props.defaultDueDate})},this.onOpenAssignCallout=()=>{this.props.onOpenAssignCallout(this.props.planId)},this.onAssignUser=(e,t,r)=>{const{onAssignNonMember:o,getAssigneePool:n}=this.props,a=n()||[];this.setState((n=>{if(-1===n.assignedToUserIds.indexOf(e)){const s=()=>{n.assignedToUserIds.push(e),null===r||void 0===r||r()};oo()(a,(t=>t.id===e))?s():null===o||void 0===o||o(e,this.state.newTaskId,t,s)}return n}));const s=this.props.getUser(e),i=null!=s?s.displayName:"";this.props.alertUser("SharedComponents_AssignUserToastTitle",[i])},this.onUnassignUser=e=>{this.setState((t=>{const r=t.assignedToUserIds.indexOf(e);return-1!==r&&t.assignedToUserIds.splice(r,1),t}));const t=this.props.getUser(e),r=null!=t?t.displayName:"";this.props.alertUser("SharedComponents_UnassignUserToastTitle",[r])},this.createTask=e=>{const{currentUserId:t,planId:r,createTask:o}=this.props;e.stopPropagation();if(ne.a.getKey(e)===O.D.ENTER||"click"===e.type){if(""===this.state.newTaskName.trim())return this.setState({taskNameErrorMsg:U.p.Strings.SharedComponents_AddTaskErrorToastTitle}),void this.alertUser();const n=sp()(this.state.assignedToUserIds,((e,r)=>(e[r]=new So.I(t,new Date),e)),{});o(qc.Y.builder.withPropertyBag({id:this.state.newTaskId,title:this.state.newTaskName,planId:r,percentComplete:(0,gt.BK)(Ct.$.NotStarted),bucketId:""!==this.state.bucketId?this.state.bucketId:null,dueDate:null==this.state.dueDate?void 0:Us()(this.state.dueDate),assignments:n}).build()),this.resetControl(),this.props.closeOnKeyPress&&this.props.toggleAddCard(e)}},this.onKeyDown=e=>{const t=ne.a.getKey(e);this._lastKeyDown=null==e?null:t},this.onKeyUp=e=>{ne.a.getKey(e)===O.D.ESCAPE&&this._lastKeyDown===O.D.ESCAPE&&this.props.toggleAddCard(e),this._lastKeyDown=null},this.stopPropagation=e=>{e.stopPropagation()},this.getZeroTermQueryAssignmentResults=()=>this.props.getAssigneeSuggestions(this.props.planId,qc.Y.builder.withPropertyBag({id:vc.o.generate(),title:this.state.newTaskName,planId:this.props.planId}).build()),this.tenantSearchAlertUser=e=>{this.props.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.addUserToContainer(e,this.props.planId)},this.defaultBucketId="",0!==this.props.buckets.length&&(this.defaultBucketId=this.props.buckets[0].id),this.state={newTaskId:vc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,isBucketMenuVisible:!1,showCalendar:!1,dueDate:e.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0}}}const cp=(0,V.J9)(((e,t)=>{const r={main:[{position:"relative",backgroundColor:Z.z.ThemePrimary,boxSizing:"border-box",padding:"20px",width:"340px"},e===m.Sx.Light&&{color:Z.z.White},e===m.Sx.Dark&&{color:Z.z.NeutralLight}],header:{fontSize:W.s.large},title:[e===m.Sx.Light&&{color:Z.z.White},e===m.Sx.Dark&&{color:Z.z.NeutralLight}],subText:[{fontSize:W.s.medium,margin:"".concat("16px"," 0")},e===m.Sx.Light&&{color:Z.z.White},e===m.Sx.Dark&&{color:Z.z.NeutralLight}],actions:[(0,z.gS)(),{alignItems:"center"}],left:(0,z.GD)(),detail:{fontSize:W.s.xSmall},right:[(0,z.$Z)(),{"> .nextButton":[(0,z.$Z)(),e===m.Sx.Light&&{backgroundColor:Z.z.White,color:Z.z.ThemePrimary},e===m.Sx.Dark&&{color:Z.z.NeutralLight}]}]};return(0,W.TW)(r,t)})),pp=(0,V.J9)(((e,t)=>{const r=cp(e,t);return{main:(0,W.Zq)("walkthroughStep_main",r.main),header:(0,W.Zq)("header",r.header),title:(0,W.Zq)("title",r.title),subText:(0,W.Zq)("subText",r.subText),actions:(0,W.Zq)("actions",r.actions),left:(0,W.Zq)("left",r.left),detail:(0,W.Zq)("detail",r.detail),right:(0,W.Zq)("right",r.right)}})),dp={border:"none",backgroundColor:Z.z.ThemePrimary,boxShadow:"0px 0px 15px -5px rgba(0, 0, 0, 0.4)"},up={root:dp,beak:dp},hp=(0,V.J9)((e=>({root:[{position:"absolute",right:"0",top:"0"},e===m.Sx.Light&&{color:Z.z.White},e===m.Sx.Dark&&{color:Z.z.NeutralLight}]})));class mp extends g.${name(){return"WalkthroughStep"}renderComponent(){const e=this.getClassNames(),t=k.createElement(Ao.K,{className:(0,oe.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:pe.s5,title:U.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,ariaLabel:U.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,onClick:this.onSkipButtonDown.bind(this),styles:hp(this.props.theme)});return k.createElement(Re.P,{className:"walkthroughStep",target:this.props.target,gapSpace:this.props.gapSpace||0,directionalHint:this.props.direction||se.A.bottomCenter,doNotLayer:null==this.props.doNotLayer||this.props.doNotLayer,setInitialFocus:!0,styles:up},k.createElement("div",{className:e.main,tabIndex:0,"aria-label":Ee.G(U.p.Strings.WalkthroughStep_Walkthrough_CombinedTextAriaLabel,this.props.detail,this.props.title,this.props.subtitle)},k.createElement("div",{className:e.header},k.createElement("div",{className:e.title},this.props.title)),t,k.createElement("div",{className:"inner"},k.createElement("div",{className:"content"},k.createElement("div",{className:e.subText},this.props.subtitle)),k.createElement("div",{className:e.actions},k.createElement("div",{className:e.left},k.createElement("div",{className:e.detail},this.props.detail)),k.createElement("div",{className:e.right},this.props.showNextButton&&this.props.onNextClicked&&k.createElement(E.j,{className:"nextButton",onClick:this.props.onNextClicked.bind(this)},this.getNextButtonText()))))))}onSkipButtonDown(e){ne.a.isButtonPress(e)&&this.props.onSkipClicked&&this.props.onSkipClicked()}getNextButtonText(){return this.props.isLastStep?U.p.Strings.WalkthroughStep_Walkthrough_FinishButtonText:U.p.Strings.WalkthroughStep_Walkthrough_NextButtonText}getClassNames(){const{theme:e,styles:t}=this.props;return pp(e,t)}constructor(e,t){super(e,t)}}class gp extends vo.M{name(){return p.M.PlannerWalkthrough}async fetchCriticalData(e,t){if(!this.fetchCriticalDataWhenComponentDidUpdate(e,t))return;let r=null;if(0!==e.tasks.length||e.currentUserDetails.getDidActiveWalkthrough()){if(0!==e.tasks.length&&!e.currentUserDetails.getDidPassiveWalkthrough()){if(!e.isFirstRunExperience||!e.isSessionFromTaskLink){(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(m.hs.Passive),r=e.currentUserDetails.setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}}}else{(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(m.hs.Active),r=e.currentUserDetails.setFirstRunExperienceDataProperty("didActiveWalkthrough",!0).setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}if(null!=r){(await this.props.actionCreatorProviders.userActionCreator()).updateUserDetails(e.currentUserDetails,r)}}fetchNonCriticalData(e,t){}renderComponent(){const e=this.getWalkthroughStepDetail();return null==e?null:k.createElement(mp,e)}getWalkthroughStepDetail(){if(this.props.walkthroughStore.getCurrentWalkthroughMode()===m._9.Walkthrough){const e=this.props.walkthroughStore.getCurrentWalkthroughStepIndex();return null==e?null:this.getWalkthroughStep(this.props.walkthroughStore.getCurrentWalkthroughType(),e)}return null}checkForCriticalDataReady(){return!0}fetchCriticalDataWhenComponentDidUpdate(e,t){return null==this.props.walkthroughStore.getCurrentWalkthroughStepIndex()&&null!=this.props.currentUser&&null!=this.props.currentUserDetails&&null!=this.props.tasks&&null!=this.props.buckets&&0!==this.props.buckets.length&&null!=this.props.users&&0===this.props.currentUser.totalTasksCreated}async onNextClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).showNextStep()}async onSkipClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).skipWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType(),this.props.walkthroughStore.getCurrentWalkthroughStepIndex())}async onCompletion(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).completeWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType())}getWalkthroughStep(e,t){if(e===m.hs.Active)switch(t){case 0:return{target:".active_0",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Subtitle,detail:this.getDescriptionText(1,4),direction:se.A.rightTopEdge,onSkipClicked:this.onSkipClicked.bind(this),gapSpace:30,theme:this.props.theme};case 1:return{target:".active_1",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Subtitle,detail:this.getDescriptionText(2,4),direction:se.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".active_2",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Subtitle,detail:this.getDescriptionText(3,4),direction:se.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 3:return{target:".active_3",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Subtitle,detail:this.getDescriptionText(4,4),direction:se.A.rightCenter,isLastStep:!0,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}else{if(e!==m.hs.Passive)throw new Error("NotImplementedException: Unknown WalkthroughType requested");switch(t){case 0:return{target:".passive_0",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Subtitle,detail:this.getDescriptionText(1,3),direction:se.A.rightCenter,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 1:return{target:".passive_1",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Subtitle,detail:this.getDescriptionText(2,3),direction:se.A.bottomLeftEdge,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".passive_2",title:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Title,subtitle:U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Subtitle,detail:this.getDescriptionText(3,3),direction:se.A.rightCenter,isLastStep:!0,showNextButton:!0,onNextClicked:this.onCompletion.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}}}getDescriptionText(e,t){return Ee.G(U.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_StepDescription,e.toString(),t.toString())}constructor(e,t){super(e,t),this.state={}}}var kp=r(25246);const Cp="calc(100% - ".concat((0,X.vb)((0,X.jz)(K.B.TopHeaderHeight)+(0,X.jz)(K.B.TopHeaderPaddingTop)+(0,X.jz)(K.B.TopHeaderPaddingBottom)),")"),bp="calc(100% - ".concat((0,X.vb)((0,X.jz)(K.B.TopHeaderHeight)+(0,X.jz)(K.B.SharepointContentTopPadding)),")"),Tp="calc(100% - ".concat((0,X.vb)((0,X.jz)(K.B.TeamsTopHeaderHeight)+(0,X.jz)(K.B.TopHeaderPaddingTop)+(0,X.jz)(K.B.TeamsTopHeaderMargin)),")"),Sp=(0,V.J9)(((e,t,r,o)=>{const n=ds(e,r),a={root:[(0,z.gS)("column","nowrap"),e!==m.Sx.SharePoint&&(0,z.GD)(),e===m.Sx.SharePoint&&{minHeight:"800px"}],taskBoardViewLandmark:[(0,z.GD)("0px"),(0,z.gS)("column","nowrap"),t&&e===m.Sx.TeamsLight&&{background:K.B.HeaderlessTeamsBackgroundColor},r&&{marginLeft:"16px"}]};return(0,W.pB)(void 0,n,a,o)})),vp=(0,V.J9)((e=>({...hs(e),root:(0,W.Zq)("planTaskBoardPage",e.root),taskBoardViewLandmark:(0,W.Zq)("taskBoardViewLandmark",e.taskBoardViewLandmark)}))),Pp=(0,V.J9)(((e,t)=>({root:{position:"relative",width:"100%",height:e===m.Sx.SharePoint?bp:Cp,".teamsApp &":{height:t?"100%":Tp}},columnsList:{}})));var xp=r(74065),yp=r.n(xp),fp=(r(87424),r(9376),r(25290)),Dp=r(7670);function wp(e,t,r,o,n,a,s){if(!e||!t)return[];const i=[],l=Fs()(r,"id");return(0,Dp.Fy)(e,t,l,n).forEach((e=>{var t,r;const n=null!=e.pivotValue?null!==(t=l[e.pivotValue])&&void 0!==t?t:a(e.pivotValue):null,c=e,p=null==n&&null!=e.pivotValue;var d;c.canEditTitle=!1,c.isCollapsable=o,c.isCollapsed=!1,c.title=n?n.formattedDisplayName:null!=e.pivotValue?(d=e.pivotValue,(0,fp.W_)(d)?U.p.Strings.AssignmentPicker_PersonaRoleNonMember:U.p.Strings.PlannerApp_FormerUserName):U.p.Strings.PlannerApp_UnassignedText,c.disableAddTask=p,c.disableDragInto=p,c.headerImage=s&&n&&null!==(r=s(n))&&void 0!==r?r:void 0,c.canMoveTaskWithinSameColumn=!0,i.push(c)})),i}function Lp(e,t,r,o,n,a,s,i){if(!e||!t||!r)return[];const l=[],c=i?(0,Dp.wA)(e,t,r):(0,Dp.M1)(e,t,r);if(1===c.length){if(null!=c[0].dataEntities&&0===c[0].dataEntities.length)return[];if(null==r)return[]}return null===s||void 0===s||s(c),c.forEach(((e,t)=>{const s=e;if(null==e.pivotValue)s.canDeleteColumn=o,s.canEditTitle=!1,s.canMoveColumnLeft=!1,s.canMoveColumnRight=!1,s.title=U.p.Strings.Bucket_NullBucketLabel,s.headerImage=n();else{const n=oo()(r,(t=>t.id===e.pivotValue));null!=n&&(s.canDeleteColumn=o,s.canEditTitle=!!a,s.canMoveColumnLeft=1!==t,s.canMoveColumnRight=t!==c.length-1,s.title=n.title,s.onUpdateTitle=a?e=>{a(n,e)}:void 0)}s.isCollapsed=!1,s.isCollapsable=!o,s.canMoveTaskWithinSameColumn=!0,(null!=s.pivotValue||null!=s.dataEntities&&0!==s.dataEntities.length)&&l.push(s)})),l}function Bp(e,t,r,o,n,a){if(!t||!r)return[];const s=[];return(n!==Cs.t.Plan&&null!=a?(0,Dp.PG)(t,o,a):(0,Dp.py)(t,r,o)).forEach((t=>{if(null==t.pivotValue)return void e.logTrace(507778442,ao.k.Warning,"Null progress group pivot value");const r=t;r.canEditTitle=!1,r.isCollapsable=!o,r.isCollapsed=!1,r.title=qc.Y.getProgressTitle(t.pivotValue),r.canMoveTaskWithinSameColumn=!0,s.push(r)})),s}function Ep(e,t,r,o,n,a){if(!e)return[];const s=[];return(0,Dp.Qc)(e,r).forEach((e=>{const i=e,l=e.pivotValue;if(i.canDeleteColumn=!1,i.canEditTitle=null!=l&&!!n,i.canMoveColumnLeft=!1,i.canMoveColumnRight=!1,i.isCollapsable=!o,i.isCollapsed=!1,null==l)i.title=U.p.Strings.Labels_UnlabeledText;else{const e=r[l];i.title=null!=e&&""!==e?e:pt.U.getLabelPlaceholderByIndex(l)}i.disableCustomOrderCards=!0,i.onUpdateTitle=n&&null!=l?e=>n(l,t,e):void 0,i.headerImage=a&&null!=l?a(l):void 0,i.canMoveTaskWithinSameColumn=!1,s.push(i)})),s}function Ap(e,t){const r=[];return(0,Dp.GU)(e).forEach((e=>{const o=e;o.canEditTitle=!1,o.canDeleteColumn=!1,o.canMoveColumnRight=!1,o.canMoveColumnLeft=!1,o.title=function(e){switch(e){case s.Tt.Future:return U.p.Strings.PlannerApp_FutureDueDateText;case s.Tt.Late:return U.p.Strings.PlannerApp_LateDueDateText;case s.Tt.NextWeek:return U.p.Strings.PlannerApp_NextWeekDueDateText;case s.Tt.NoDate:return U.p.Strings.PlannerApp_NoDateDueDateText;case s.Tt.ThisWeek:return U.p.Strings.PlannerApp_ThisWeekDueDateText;case s.Tt.Today:return U.p.Strings.PlannerApp_TodayDueDateText;case s.Tt.Tomorrow:return U.p.Strings.PlannerApp_TomorrowDueDateText;default:return""}}(o.pivotValue),o.isCollapsable=t,o.isCollapsed=!1,o.disableCustomOrderCards=!0,o.findPlaceHolderIndex=Dp.fS,o.canMoveTaskWithinSameColumn=!1,r.push(o)})),r}function Fp(e,t){const r=[];return(0,Dp.K5)(e).forEach((e=>{const o=e;o.canEditTitle=!1,o.canDeleteColumn=!1,o.canMoveColumnRight=!1,o.canMoveColumnLeft=!1,o.title=qc.Y.getPriorityText(o.pivotValue),o.isCollapsable=t,o.isCollapsed=!1,o.disableCustomOrderCards=!0,o.findPlaceHolderIndex=Dp.pU,o.canMoveTaskWithinSameColumn=!1,r.push(o)})),r}class Ip extends Zs{name(){return i.EC.PlanTaskboard}setupCallbacks(){super.setupCallbacks(),this.taskBoardCallbacks={getCurrentTaskGroupingState:()=>this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),getTaskBucket:e=>null!=e?this.props.bucketStore.getBucket(e):null,getTaskDetails:e=>null!=e?this.props.taskStore.getTaskDetails(e):null,getTaskGroupId:e=>null!=e?this.props.planStore.getContainerIdForPlan(e):null,getTaskPlan:e=>null!=e?this.props.planStore.getPlan(e):null,getTaskPlanDetails:e=>null!=e?this.props.planStore.getPlanDetails(e):null,getTaskPlanLabelUsageCounts:e=>this.props.aggregatesStore.getLabelUsageCountsForPlan(e),getTaskHighlightedType:this.getTaskHighlightedType,onDeleteTask:this.onDeleteTask,showAssigneeLimitError:this.onShowAssigneeLimitError,taskCallbacks:{isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask,...this.taskCardCallbacks}}}getViewClassNames(){return vp(this.getViewStyles())}getViewStyles(){return Sp(this.props.appContextStore.getCurrentTheme(),h.B.headerlessMode,h.B.isUnoContext,this.props.styles)}isAddTaskCardShowing(){return!0}generateColumnAddTaskPivotValue(){var e,t;const{viewPartitionKey:r,loggers:o}=this.props,n=this.props.planStore.getPlan(r);if(null==n)return;const a=null==this.state?void 0:this.state.columnAddTaskPivotValue;if(void 0!==a)return a;const i=this.getTaskData();if(!this.checkForCriticalViewDataReady())return;if(0!==i.length)return null;const l=null!==(e=this.getTaskboardTaskFormatData())&&void 0!==e?e:[];let p=[];const d=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(d){case s.Yc.Bucket:p=Lp(i,Fs()(l,"id"),this.props.bucketStore.getBucketsForPlan(r),!0,this.renderUncategorizedBucketHeaderImage);break;case s.Yc.Progress:p=Bp(o.traceLogger,i,Fs()(l,"id"),!0,this.taskAccessContext);break;case s.Yc.Assignee:p=wp(i,Fs()(l,"id"),this.getContainerMembers(n.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage);break;case s.Yc.Category:const e=this.props.planStore.getPlanDetails(r);p=Ep(i,r,null!==(t=null===e||void 0===e?void 0:e.categories)&&void 0!==t?t:[],!0,this.onUpdateCategoryTitle);break;case s.Yc.DueDate:p=Ap(i,!1);break;case s.Yc.Priority:p=Fp(i,!1);break;case s.Yc.None:case s.Yc.Plan:break;default:return void Ws.f.unreachableCase(d,(e=>{o.traceLogger.logTrace(508060124,ao.k.Error,e)}))}if(0!==p.length&&(0!==i.length||h.B.clientType!==c.s.Webpart)){if(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)===s.Yc.Bucket){let e=0;for(;null==p[e].pivotValue;)e++;return this.props.bucketStore.getBucketStatus(p[e].pivotValue)!==kp.v.Created?void 0:p[e].pivotValue}var u;return null===p[0].pivotValue?"null":null===(u=p[0].pivotValue)||void 0===u?void 0:u.toString()}}renderComponent(){const{viewPartitionKey:e,appContextStore:t}=this.props,r=h.B.clientType===c.s.Plex?this.renderWalkthrough():null,o=this.getThemedPageStyles(e);return k.createElement(k.Fragment,null,k.createElement("div",{className:(0,oe.A)(this.getViewClassNames().root),style:o},this.renderViewCommandBar(),this.renderPartitionedView(t.getCurrentTheme()),r))}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:r,flights:o}=this.props;e.viewPartitionKey!==r&&(this.loggedUnbucketedTasks=!1,this.setState({columnAddTaskPivotValue:void 0}),this.props.actionCreatorProviders.viewTransformsActionCreator().then((e=>{const t=h.B.isUnoContext&&o.EnableDefaultActiveTasksFilterInPlanView?[d._6]:[];e.setTaskFilter(this.taskAccessContext,new Tt.S(t))})))}componentDidMount(){super.componentDidMount(),this.logUsage(p.M.PlanTaskBoard_Navigated);const{loggers:e}=this.props;h.B.clientType!==c.s.Plex&&h.B.clientType!==c.s.Teams||D.q.logFloodgateActivity(p.M.LoadTaskBoard,e.traceLogger)}storeDidUpdate(){if(super.storeDidUpdate(),void 0===this.state.columnAddTaskPivotValue){const e=this.generateColumnAddTaskPivotValue();void 0!==e&&this.setState((t=>({...t,columnAddTaskPivotValue:e})))}}renderPlanView(){return this.renderTaskBoard()}renderTaskBoard(){var e,t;const{flights:r,viewPartitionKey:o,loggers:n}=this.props,a=this.props.planStore.getPlan(o);if(null==a)return null;const i=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),p=this.getTaskData(),d=this.getTaskboardTaskFormatData(),u=Fs()(d,"id"),m=this.props.viewStore.getCurrentTaskFilter(this.taskAccessContext),g=this.props.viewStore.getFilterExceptions(),C=p.filter((e=>qc.Y.ApplyEntityFilter(e,m,g)));let b;this.isAddTaskCardShowing()&&(b=this.generateAddCardControlProvider());const T={valueSetter:(e,t,r,o,n)=>{},secondaryClassifier:e=>!1,secondaryValueSetter:(e,t)=>{},secondarySectionTitleProvider:e=>U.p.Strings.PlannerApp_CompletedSectionText,onColumnDrop:async(e,t,r)=>{let o=null,n=null,a=null;if(null!=e&&i===s.Yc.Bucket){if(o=this.props.bucketStore.getBucket(e),null!=t&&(n=this.props.bucketStore.getBucket(t)),null!=r&&(a=this.props.bucketStore.getBucket(r)),null==o)return;const s=o.setProperty("orderHint",Vs.O.generateOrderHintBetween(a?a.orderHint:null,n?n.orderHint:null));(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(o,s)}},addCardControlProvider:b};let S,v=[],P=!1,x=!1,y=!1,f="",D="";const w=a?this.props.permissionsStore.getPlanPermissions(a):this.props.permissionsStore.getDefaultPlanPermissions();switch(i){case s.Yc.Bucket:x=!0,v=Lp(C,u,this.props.bucketStore.getBucketsForPlan(o),!0,this.renderUncategorizedBucketHeaderImage,this.onUpdateBucketTitle,this.logUnbucketedTasksCount),P=!0,T.valueSetter=(e,t,r,o,n)=>this.bucketBoardValueSetter(u,e,t,r,o,n),T.secondaryClassifier=this.completedTaskClassifier,T.secondaryValueSetter=this.completedSectionValueSetter,y=w.canAddBuckets,S=async e=>{let t=null;const r=yp()(v);if(r){const e=this.props.bucketStore.getBucketsForPlan(o),n=oo()(e,(e=>e.id===r.pivotValue));t=n?n.orderHint:null}const n=Ic.f.builder.withPropertyBag({id:"",title:e,planId:o,orderHint:Vs.O.generateOrderHintBetween(null,t)}).withLocallyUniqueId().build();(await this.props.actionCreatorProviders.bucketActionCreator()).createBucket(n)},D=U.p.Strings.PlannerApp_AddBucket,f=U.p.Strings.PlannerApp_AddBucketPlaceHolder;break;case s.Yc.Progress:v=Bp(n.traceLogger,C,u,!0,this.taskAccessContext),P=!1,T.valueSetter=(e,t,r,o,n)=>this.progressBoardValueSetter(u,e,t,r,o,n);break;case s.Yc.Assignee:v=wp(C,u,this.getContainerMembers(a.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage),P=!0,T.valueSetter=(e,t,r,o,n)=>this.assignedToBoardValueSetter(u,e,t,r,o,n),T.secondaryClassifier=this.completedTaskClassifier,T.secondaryValueSetter=this.completedSectionValueSetter;break;case s.Yc.Category:const r=null!==(e=null===(t=this.props.planStore.getPlanDetails(o))||void 0===t?void 0:t.categories)&&void 0!==e?e:[];v=Ep(C,o,r,!0,this.onUpdateCategoryTitle,this.renderCategoryHeaderImage),P=!0,T.valueSetter=this.categoryBoardValueSetter,T.secondaryClassifier=this.completedTaskClassifier,T.secondaryValueSetter=this.completedSectionValueSetter;break;case s.Yc.DueDate:v=Ap(C,!1),P=!0,T.valueSetter=this.dueDateBoardValueSetter,T.secondaryClassifier=this.completedTaskClassifier,T.secondaryValueSetter=this.completedSectionValueSetter;break;case s.Yc.Priority:v=Fp(C,!1),P=!0,T.valueSetter=this.priorityBoardValueSetter,T.secondaryClassifier=this.completedTaskClassifier,T.secondaryValueSetter=this.completedSectionValueSetter;break;case s.Yc.None:case s.Yc.Plan:break;default:Ws.f.unreachableCase(i,(e=>{this.props.loggers.traceLogger.logTrace(508060123,ao.k.Error,e)}))}const L=o,B=this.props.appContextStore.getClientFlavor(),E=this.props.appContextStore.getCurrentTheme();return k.createElement(Li.Provider,{value:this.getViewContext()},k.createElement(Nr.H,{className:this.getViewClassNames().taskBoardViewLandmark,role:"main"},k.createElement(Zc,{autoFocus:h.B.clientType!==c.s.Webpart&&this.props.autoFocus&&!this.state.isFilterMenuVisible,key:L,displayMode:Ks.Board,columnCreationEnabled:y,createColumnCallback:S,createColumnButtonText:D,createColumnPlaceholder:f,columnDefinitions:v,modifiedTaskIds:this.props.wywaStore.getModifiedTaskIds(),deleteColumnCallback:i===s.Yc.Bucket?this.onDeleteBucket:void 0,enableColumnMove:x,useSecondaryClassification:P,maxAssignees:h.B.clientSettings.MaxTaskAssignees,callbacks:T,taskBoardCardCallbacks:this.taskBoardCallbacks,toggleAddTaskFormVisibility:this.onToggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.onCloseAddTaskCard,showAddEntityCardCallback:this.showAddEntityCardCallback,showPlanTitleOnCard:!1,showCopyLinkToTask:this.props.showCopyLinkToTask,openTaskDetails:this.onOpenTaskDetailsEditor,fetchReferencePreviewForTask:this.fetchReferencePreviewForTask,currentUserId:this.props.appContextStore.getCurrentUserId(),disableColumnChanges:!w.canEdit,getTaskPermissions:this.getTaskPermissions,bucketVirtualization:r.BucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,enableAutoScrollOnDragItem:r.EnableImprovedDragScroll,theme:E,enableDragToScroll:!0,isTeamsSplitUI:this.props.appContextStore.getFlights().EnableTeamsSplitUI&&(B===l.g.TeamsPersonalApp||B===l.g.TeamsTab),fetchPermissionsWithTaskContext:this.fetchPermissionsWithTaskContext,styles:Pp(E,h.B.headerlessMode)})))}renderWalkthrough(){var e,t;const{viewPartitionKey:r,planStore:o}=this.props,n=o.getPlan(r);return null==n?null:k.createElement(gp,{buckets:null!==(e=this.props.bucketStore.getBucketsForPlan(r))&&void 0!==e?e:[],tasks:null!==(t=this.props.taskStore.getTasksForPlan(r))&&void 0!==t?t:[],users:this.getContainerMembers(n.container.externalId),currentUser:this.props.userStore.getCurrentUser(),currentUserDetails:this.props.userStore.getCurrentUserDetails(),dispatcherEventManagement:this.props.dispatcherEventManagement,walkthroughStore:this.props.walkthroughStore,actionCreatorProviders:this.props.actionCreatorProviders,isFirstRunExperience:this.props.isFirstRunExperience,isSessionFromTaskLink:this.props.isSessionFromTaskLink,theme:this.props.appContextStore.getCurrentTheme()})}constructor(e,t){super(e,t),this.generateAddCardControlProvider=()=>(e,t,r,o,n)=>{var a;const l=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null==l)return null;const p=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),d=l.container.externalId,u=this.canUserAddMembers(l),m=this.canUserAccessPlanViaSharedContainerOnly(l.id),g=u||m,C=null!==(a=this.props.bucketStore.getBucketsForPlan(this.props.viewPartitionKey))&&void 0!==a?a:[];return C.sort(st.k),k.createElement(lp,{autoFocus:!!this.state.isAddTaskCardOpenedFromAddTaskButton||this.props.appContextStore.getLastRouteChangeSource()!==i.jf.LeftNav&&h.B.clientType!==c.s.Webpart&&!this.state.isFilterMenuVisible,createTask:o=>{this.onCreateTask(o,e,t,r)},planId:this.props.viewPartitionKey,toggleAddCard:n,closeOnKeyPress:!1,canAddUser:u,canAccessPlanViaSharedContainerOnly:m,buckets:C,defaultDueDate:void 0,hideSetAssignment:p===s.Yc.Assignee,hideSetBucket:p===s.Yc.Bucket,hideSetDueDate:p===s.Yc.DueDate,getUser:this.taskCardCallbacks.getUser,getUserPhoto:this.taskCardCallbacks.getUserPhoto,getUsersWithKeyword:g?this.taskCardCallbacks.getUsersWithKeyword:void 0,getAssigneePool:d?this.getContainerMembers.bind(this,d):()=>[],maxAssignees:h.B.clientSettings.MaxTaskAssignees,showAssigneeLimitError:this.onShowAssigneeLimitError,currentUserId:this.props.appContextStore.getCurrentUserId(),onRenderPersona:this.onRenderPersona,alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,enableSuggestedAssigneeUI:this.props.flights.EnableSuggestedAssignee,addUserToContainer:this.onAddUserToContainer,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,theme:this.props.appContextStore.getCurrentTheme(),getAssigneeSuggestions:this.onGetAssigneeSuggestion,onAssignNonMember:this.onAssignTask,renderSmartTextField:this.props.renderSmartTextField})},this.renderCategoryHeaderImage=e=>k.createElement(lt.l,{index:e,isCollapsed:!1,title:"",showBorder:!0,theme:this.props.appContextStore.getCurrentTheme()}),this.renderAssigneeHeaderImage=e=>null==e?null:k.createElement(Ge.f,{user:e,onLoad:this.onRenderPersona,containerId:"userContainer-assigneeHeader-".concat(e.id)},k.createElement(Ve.F,{id:e.id,imageUrl:this.props.userStore.getUserPhotoById(e.id)||void 0,size:We.WH.size32,hidePersonaDetails:!0})),this.onToggleAddTaskFormVisibility=e=>{this.state.columnAddTaskPivotValue===e||null==e?this.setState((e=>({...e,columnAddTaskPivotValue:null}))):this.setState((t=>({...t,columnAddTaskPivotValue:e})))},this.onOpenAddTaskCardFromAddTaskButton=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonExpanded"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!0})},this.onCloseAddTaskCard=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonCollapsed"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!1})},this.onUpdateBucketTitle=async(e,t)=>{const r=e.setProperty("title",t);(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(e,r)},this.onUpdateCategoryTitle=async(e,t,r)=>{const o=this.props.planStore.getPlanDetails(t);if(!o||o.categories[e]===r)return;const n=o.categories.slice();n[e]=r;const a=o.setProperty("categories",n);(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(o,a)},this.logUnbucketedTasksCount=e=>{this.loggedUnbucketedTasks||null==e[0]||null==e[0].dataEntities||(this.props.loggers.usageLogger.logData(this.name(),"Unbucketed Tasks Count",{planId:this.props.viewPartitionKey,numTasks:String(e[0].dataEntities.length)}),this.loggedUnbucketedTasks=!0)},this.showAddEntityCardCallback=e=>this.state.columnAddTaskPivotValue===e,this.setupCallbacks(),this.state={highlightField:s.JS.None,highlightValue:void 0,columnAddTaskPivotValue:this.generateColumnAddTaskPivotValue(),isCardChangingCompletedSection:!1,isFilterMenuVisible:!1,isAddTaskCardOpenedFromAddTaskButton:!1}}}},94283:(e,t,r)=>{"use strict";r.d(t,{k:()=>d});var o=r(55491),n=r.n(o),a=r(54320),s=r.n(a),i=r(91246);class l{build(){return new d(this)}fromSensitivityLabelResource(e){var t;const r=null===(t=e.sublabels)||void 0===t?void 0:t.map((e=>(new l).fromSensitivityLabelResource(e)));return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:e.groupAllowGuestUsers,groupPrivacy:e.groupPrivacy,sublabels:r})}fromGraphResource(e){var t;const r=null===(t=e.sublabels)||void 0===t?void 0:t.map((e=>(new l).fromGraphResource(e)));let o=this.groupAllowGuestUsers,n=this.groupPrivacy;const a=e.labelActions;if(a&&!s()(a))for(const s of a)if("protectGroup"===s.name){var i,c;o=null!==(i=s.allowGuestUsers)&&void 0!==i&&i,n=null!==(c=s.privacy)&&void 0!==c?c:this.groupPrivacy;break}return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:o,groupPrivacy:n,sublabels:r})}withPropertyBag(e){var t,r;return this.id=e.id||this.id,this.name=e.name||this.name,this.displayName=e.displayName||this.displayName,this.description=e.description||this.description,this.toolTip=e.toolTip||this.toolTip,this.isDefault=null!==(t=e.isDefault)&&void 0!==t?t:this.isDefault,this.priority=e.priority||this.priority,this.groupAllowGuestUsers=null!==(r=e.groupAllowGuestUsers)&&void 0!==r?r:this.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy||this.groupPrivacy,this.sublabels=e.sublabels||this.sublabels,this}withValidData(){return this.withPropertyBag({id:i.o.generate()})}constructor(){this.id="",this.name="",this.displayName="",this.description="",this.toolTip="",this.isDefault=!1,this.priority=0,this.groupAllowGuestUsers=!0,this.groupPrivacy="",this.sublabels=null}}var c=r(21382),p=r(86053);class d{static get builder(){return new l}static getDefaultSensitivityLabel(e){if(s()(e))return null;let t=null;return n()(e,(e=>{if(e.isDefault?t=e:null!=e.sublabels&&n()(e.sublabels,(e=>{if(e.isDefault)return t=e,!1})),null!=t)return!1})),t}static getSensitivityLabel(e,t){if(s()(e)||s()(t))return null;let r=null;return n()(t,(t=>{if(t.id===e?r=t:null!=t.sublabels&&n()(t.sublabels,(t=>{if(t.id===e)return r=t,!1})),null!=r)return!1})),r}static getParentSensitivityLabel(e,t){if(s()(e)||s()(t))return null;let r=null;return n()(t,(t=>{if(null!=t.sublabels&&n()(t.sublabels,(o=>{if(o.id===e)return r=t,!1})),null!=r)return!1})),r}static getFullSensitivityTitle(e,t){var r;if(s()(e)||s()(t))return"";const o=d.getSensitivityLabel(e,t),n=d.getParentSensitivityLabel(e,t);return o&&n?c.G(p.p.Strings.SensitivityLabel_FullTitle,n.displayName,o.displayName):null!==(r=null===o||void 0===o?void 0:o.displayName)&&void 0!==r?r:""}constructor(e){this.id=e.id,this.name=e.name,this.displayName=e.displayName,this.description=e.description,this.toolTip=e.toolTip,this.isDefault=e.isDefault,this.priority=e.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy,this.sublabels=null,null!=e.sublabels&&(this.sublabels=[],e.sublabels.forEach((e=>{this.sublabels.push(new d(e))})))}}},80523:(e,t,r)=>{var o=r(21817),n=r(2112);function a(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}a.prototype=o(n.prototype),a.prototype.constructor=a,e.exports=a},52990:(e,t,r)=>{var o=r(21817),n=r(2112);function a(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}a.prototype=o(n.prototype),a.prototype.constructor=a,e.exports=a},2112:e=>{e.exports=function(){}},8760:(e,t,r)=>{var o=r(52990),n=r(15857),a=r(88218),s=r(60911),i=r(54052),l=r(90402);e.exports=function(e){return n((function(t){var r=t.length,n=r,c=o.prototype.thru;for(e&&t.reverse();n--;){var p=t[n];if("function"!=typeof p)throw new TypeError("Expected a function");if(c&&!d&&"wrapper"==s(p))var d=new o([],!0)}for(n=d?n:r;++n<r;){p=t[n];var u=s(p),h="wrapper"==u?a(p):void 0;d=h&&l(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?d[s(h[0])].apply(d,h[3]):1==p.length&&l(p)?d[u]():d.thru(p)}return function(){var e=arguments,o=e[0];if(d&&1==e.length&&i(o))return d.plant(o).value();for(var n=0,a=r?t[n].apply(this,e):o;++n<r;)a=t[n].call(this,a);return a}}))}},15857:(e,t,r)=>{var o=r(20819),n=r(55636),a=r(46350);e.exports=function(e){return a(n(e,void 0,o),e+"")}},88218:(e,t,r)=>{var o=r(22867),n=r(75713),a=o?function(e){return o.get(e)}:n;e.exports=a},60911:(e,t,r)=>{var o=r(27530),n=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",r=o[t],a=n.call(o,t)?r.length:0;a--;){var s=r[a],i=s.func;if(null==i||i==e)return s.name}return t}},90402:(e,t,r)=>{var o=r(80523),n=r(88218),a=r(60911),s=r(48991);e.exports=function(e){var t=a(e),r=s[t];if("function"!=typeof r||!(t in o.prototype))return!1;if(e===r)return!0;var i=n(r);return!!i&&e===i[0]}},22867:(e,t,r)=>{var o=r(26600),n=o&&new o;e.exports=n},27530:e=>{e.exports={}},79360:(e,t,r)=>{var o=r(80523),n=r(52990),a=r(91980);e.exports=function(e){if(e instanceof o)return e.clone();var t=new n(e.__wrapped__,e.__chain__);return t.__actions__=a(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},17961:(e,t,r)=>{var o=r(8760)();e.exports=o},48991:(e,t,r)=>{var o=r(80523),n=r(52990),a=r(2112),s=r(54052),i=r(22761),l=r(79360),c=Object.prototype.hasOwnProperty;function p(e){if(i(e)&&!s(e)&&!(e instanceof o)){if(e instanceof n)return e;if(c.call(e,"__wrapped__"))return l(e)}return new n(e)}p.prototype=a.prototype,p.prototype.constructor=p,e.exports=p}}]);
//# sourceMappingURL=plantaskboardpage.3bd96e9b.chunk.js.map