"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[42067],{29610:(e,t,o)=>{o.r(t),o.d(t,{FormResponseViewDialog:()=>y});var n=o(65043),r=o(20751),i=o(27663),a=o(9442),s=o(52342),l=o(40520),c=o(62264),d=o(715),p=o(61035),m=o(77508),u=o(56415),h=o(8736),g=o(66783),x=o(33516),b=o(53815),f=o(66151);const T=(0,g.J9)(((e,t)=>{const o=[(0,f.aS)(e),(0,f.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{width:h.B.MainDialogWidth,maxWidth:h.B.MainDialogMaxWidth,minWidth:h.B.MainDialogMinWidth},button:[{width:"fit-content",height:"30px",backgroundColor:"transparent",padding:"5px 12px 5px 12px",":hover":{backgroundColor:"transparent !important"}}]},e===m.Sx.TeamsContrast&&{border:"1px solid "+u.z.White}],n=[(0,f._D)(e),{display:"flex",gap:"5px"}],r=[(0,f.gS)("column"),f.cc,(0,f.aS)(e),{textAlign:"center",fontSize:b.s.large,height:"250px",fontWeight:b.BO.semibold}],i={table:{borderCollapse:"separate",borderSpacing:0,padding:"0px 20px",width:"100%"},"table tr th, table tr td":{borderRight:"1px solid ".concat(u.z.NeutralLightGrey82),borderBottom:"1px solid ".concat(u.z.NeutralLightGrey82),padding:"8px 16px"},"table tr th:first-child, table tr td:first-child":{borderLeft:"1px solid ".concat(u.z.NeutralLightGrey82)},"table tr th":{borderTop:"1px solid ".concat(u.z.NeutralLightGrey82),textAlign:"left"},"table tr:first-child th:first-child":{borderTopLeftRadius:"8px"},"table tr:first-child th:last-child":{borderTopRightRadius:"8px"},"table tr:last-child td:first-child":{borderBottomLeftRadius:"8px"},"table tr:last-child td:last-child":{borderBottomRightRadius:"8px"}},a=[e===m.Sx.TeamsContrast?{color:u.z.HighContrastBlackSelectedTextBackground}:(0,f._D)(e),{fontSize:b.s.medium,margin:"15px 10px",border:"none",cursor:"pointer"}],s=[(0,f.gS)("row"),{padding:"30px 20px",gap:"15px"}],l=[(0,f.$Z)("32px"),{height:"32px",width:"32px"}],c=[(0,f.$Z)("40px"),(0,f.i9)(e),{height:"40px",width:"40px",alignItems:"center",padding:"8px 0px 0px 8px",borderRadius:"2px",pointerEvents:"none"}],d=[(0,f.gS)("column"),{".primaryTextSection":{height:"28px"}}],p=[(0,f.gS)("column"),{gap:"15px",minWidth:"200px",".ms-Image-image":{maxWidth:"300px"}}];return(0,x.TW)({dialogContainer:o,loadingSpinner:r,dialogTopButton:[{right:"auto",padding:"15px 15px 0px"}],questionAnswerTable:i,backButton:n,submitAnotherResponseButton:a,formsHeaderSection:s,formsLogoIcon:l,formsMetadataSection:d,iconSection:c,fileUpload:p,tableColumn:{minWidth:"200px"}},t)})),S=("".concat(u.z.TeamsAppBrand00," ").concat(u.z.TeamsDarkPurple," ").concat(u.z.TeamsDarkPurple),(0,g.J9)((e=>({topButton:e.dialogTopButton})))),R=(0,g.J9)((e=>({dialogContainer:(0,x.Zq)("dialogContainer",e.dialogContainer),loadingSpinner:(0,x.Zq)("loadingSpinner",e.loadingSpinner),dialogTopButton:(0,x.Zq)("dialogTopButton",e.dialogTopButton),questionAnswerTable:(0,x.Zq)("questionAnswerTable",e.questionAnswerTable),backButton:(0,x.Zq)("backButton",e.backButton),submitAnotherResponseButton:(0,x.Zq)("submitAnotherResponseButton",e.submitAnotherResponseButton),formsHeaderSection:(0,x.Zq)("formsHeaderSection",e.formsHeaderSection),formsLogoIcon:(0,x.Zq)("formsLogoIcon",e.formsLogoIcon),formsMetadataSection:(0,x.Zq)("formsMetadataSection",e.formsMetadataSection),iconSection:(0,x.Zq)("iconSection",e.iconSection),fileUpload:(0,x.Zq)("fileUpload",e.fileUpload),tableColumn:(0,x.Zq)("tableColumn",e.tableColumn)})));var C=o(74527),w=o(4648),B=o(86053),N=o(21382),k=o(54052),E=o.n(k);const y=e=>{const{onDismiss:t,theme:o,contentStyles:m,getThumbnail:u,dialogContentClassName:h,dialogClassName:g,dialogContainerClassName:x,formWithQA:b,onSubmitAnotherResponseClick:f}=e,k=R(T(o,m)),y=n.useCallback(((e,t)=>{var o,n;if(!t)return null;return null!==(o=null===(n=p.V.getLatestResponseAnswers(t).find((t=>t.questionId===e.id)))||void 0===n?void 0:n.answer1)&&void 0!==o?o:null}),[]),q=()=>{if(!b)return null;const e=p.V.getLatestResponse(b),t=e?new Date(e.submitDate):"",i=null===e||void 0===e?void 0:e.responderName;return n.createElement("div",{className:k.formsHeaderSection},n.createElement("div",{className:k.iconSection},n.createElement(r.I,{...C.U3,className:(0,w.A)(C.U3.className,k.formsLogoIcon)})),n.createElement("div",{className:k.formsMetadataSection},n.createElement(c.g,{titleText:b.displayName,theme:o}),t&&i&&N.G(B.p.Strings.FormResponseViewDialog_SubmissionMetadataText,i,t.toLocaleDateString(),t.toLocaleTimeString())))},v=()=>n.createElement("button",{className:k.submitAnotherResponseButton,type:"button",onClick:()=>f()},B.p.Strings.FormResponseViewDialog_SubmitAnotherResponseButtonText),A=()=>{if(!b)return null;const e=b.questions.sort(((e,t)=>e.order-t.order)).map((e=>D(e)));return n.createElement("div",{className:k.questionAnswerTable},n.createElement("table",null,n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,n.createElement(c.g,{titleText:B.p.Strings.FormResponseViewDialog_QuestionColumnHeaderText,theme:o})),n.createElement("th",null,n.createElement(c.g,{titleText:B.p.Strings.FormResponseViewDialog_AnswerColumnHeaderText,theme:o})))),n.createElement("tbody",null,...e)))},D=e=>{const t=L(e);return n.createElement("tr",null,n.createElement("td",null,n.createElement("div",{className:k.tableColumn},e.title)),n.createElement("td",null,t))},L=e=>{var t;const o=y(e,b);if(!o)return null;let r=o;switch(e.questionType){case d.x.Ranking:r=o.sort(((e,t)=>e.answerOrder-t.answerOrder)).map((e=>e.displayText)).join(", ");break;case d.x.MatrixChoice:r=null!==(t=o.displayText)&&void 0!==t?t:"";break;case d.x.FileUpload:const e=p.V.getImageUrls(o);return n.createElement("div",{className:k.fileUpload},e.map((e=>{const t=u(e);return t?n.createElement(i._,{key:e,src:t}):n.createElement(a.N,{key:e,href:e,target:"_blank",rel:"noopener noreferrer"},B.p.Strings.FormResponseViewDialog_OpenFileInSharepointLinkText)})));case d.x.Choice:try{const e=JSON.parse(o);r=E()(e)?e.join(", "):o}catch(s){r=o}break;case d.x.Text:case d.x.Rating:case d.x.Date:case d.x.NetPromoterScore:case d.x.MatrixChoiceGroup:default:r=o}return n.createElement("div",{className:k.tableColumn},r)};return n.createElement(s.l,{hidden:!1,onDismiss:t,dialogContentProps:{className:h,closeButtonAriaLabel:B.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,styles:S(T(o,m)),type:l.h.normal,topButtonsProps:[{onRenderIcon:()=>n.createElement("div",{className:k.backButton,onClick:t},n.createElement(r.I,C.qb),B.p.Strings.FormResponseViewDialog_DialogHeaderBackButtonLabel)}]},modalProps:{className:g,containerClassName:(0,w.A)(x,k.dialogContainer),isBlocking:!1}},n.createElement("div",null,q(),A(),v()))}},62264:(e,t,o)=>{o.d(t,{g:()=>m});var n=o(65043),r=o(16112),i=o(66783),a=o(33516),s=o(66151),l=o(56415);const c="34px",d=(0,i.J9)((e=>({root:[(0,s.q0)("ellipsis"),(0,s.aS)(e),{height:c,cursor:"default","> button":[s.xK,(0,s.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:a.BO.semibold,lineHeight:c,margin:"auto"}}]}))),p=(0,i.J9)((e=>({root:(0,a.Zq)("primaryTextSection",e.root)})));class m extends r.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:o}=this.props,r=this.getClassNames();return n.createElement("div",{className:r.root,title:e},null!=t?n.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":o,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},n.createElement("span",null,e)):n.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return p(d(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=n.createRef(),this.onTitleClick=()=>{var e,t,o;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(o=this.titleButtonRef.current)&&void 0!==o?o:void 0)}}}},61035:(e,t,o)=>{o.d(t,{V:()=>r});class n{constructor(e){this.id=e.id,this.order=e.order,this.title=e.title,this.titleRT=e.titleRT,this.subtitle=e.subtitle,this.subtitleRT=e.subtitleRT,this.questionType=e.questionType}}n.fromWebResource=e=>new n({id:e.id,order:e.order,title:e.title,titleRT:e.formsProRTQuestionTitle,subtitle:e.subtitle,subtitleRT:e.formsProRTSubtitle,questionType:e.type});class r{static getLatestResponse(e){return e.responses[0]}static getLatestResponseAnswers(e){let t=[];const o=this.getLatestResponse(e);if(null!==o&&void 0!==o&&o.answers)try{t=JSON.parse(o.answers)}catch(n){throw new Error("Failed to parse form response answers: ".concat(o.answers,", Error: ").concat(n))}return t}constructor(e){this.formId=e.formId,this.displayName=e.displayName,this.questions=e.questions,this.responses=e.responses,this.formWebUrl=e.formWebUrl,this.formResponse=e.formResponse}}r.getImageUrls=e=>{try{return JSON.parse(e).map((e=>e.link))}catch(t){throw new Error("Failed to parse form response file upload answer: ".concat(e,", Error: ").concat(t))}},r.fromWebResource=e=>new r({formId:e.formId,displayName:e.displayName,questions:e.questions.map((e=>n.fromWebResource(e))),responses:e.responses,formWebUrl:e.formWebUrl,formResponse:e.formResponse})},715:(e,t,o)=>{var n;o.d(t,{x:()=>n}),function(e){e.Rating="Question.Rating",e.Date="Question.DateTime",e.FileUpload="Question.FileUpload",e.Choice="Question.Choice",e.Text="Question.TextField",e.Ranking="Question.Ranking",e.MatrixChoiceGroup="Question.MatrixChoiceGroup",e.MatrixChoice="Question.MatrixChoice",e.NetPromoterScore="Question.NPS"}(n||(n={}))}}]);
//# sourceMappingURL=formresponseviewdialog.28bb6fea.chunk.js.map