"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[33201],{94266:(e,t,r)=>{r.d(t,{R:()=>o});var n=r(45078);class o{appendSharepointAuthenticationChallengeHeaders(e){return e[n.Er.AuthenticationChallengeHeaderName]=n.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const t=new URL(e);return new URLSearchParams(t.search).get(this.skipTokenParam)}catch{return null}}constructor(e,t,r){this.name=e,this.hostDomain=t,this.ajaxClient=r,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[n.a8.ClientRequestId],this.loggableResponseHeaders=[n.Qu.RequestId,n.Qu.ClientRequestId,n.Qu.TCorrelationId]}}},98546:(e,t,r)=>{r.r(t),r.d(t,{DirectoryService:()=>d});var n=r(45078),o=r(95783),s=r(92970),a=r(50204),i=r(94266),c=r(54320),u=r.n(c),l=r(33411),h=r.n(l),g=r(98502),m=r(81704),y=r(61739);class d extends i.R{async getGroupAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId,"?").concat("$select=assignedLabels,autoSubscribeNewMembers,classification,description,displayName,id,mail,mailNickname,visibility"),r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupAsync")});try{const e=await r.clone().json();if(null==e)throw new Error("No unified group data returned");return s.E.builder.fromGraphResource(e).build()}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getGroupPhotoAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupPhotoAsync"),retryConfig:(0,m.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getMembersOfGroupAsync(e){let t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId,"/members?$select=proxyAddresses,id,displayName,givenName,mail,preferredLanguage,surname,userPrincipalName,jobTitle,userType");u()(e.skipToken)||(t="".concat(t,"&$skiptoken=").concat(e.skipToken));const r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getMembersOfGroupAsync")});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,n=(0,y.n0)(e[this.skipTokenKey]);let o="";if(!u()(n)){o=n.split("?")[1].split("&")[1].split("=")[1]}return{data:h()(t,(e=>a.K.builder.fromGraphUserResource(e).build())),skipToken:o}}catch(n){throw g.g.generateAjaxClientError(r,n)}}async checkMemberGroupsForCurrentUserAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/me/checkMemberGroups"),r={groupIds:e.groupIds},s=await this.ajaxClient.executeRequest(t,{method:o.PJ.Post,telemetryConfig:this.getDefaultRequestTelemetryConfig("checkMemberGroupsForCurrentUserAsync"),body:JSON.stringify(r),headers:{[n.Lr.ContentType]:n.Mq.Json}});try{var a;const e=await s.clone().json();return null==e?Promise.reject(g.g.generateAjaxClientError(s,"No group ids returned")):null!==(a=e.value)&&void 0!==a?a:[]}catch(i){throw g.g.generateAjaxClientError(s,i)}}async getUserAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/users/").concat(e.userId,"?$select=id,displayName,givenName,jobTitle,mail,preferredLanguage,surname,userPrincipalName,proxyAddresses,userType"),r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getUserAsync")});try{const e=await r.clone().json();if(null==e)throw new Error("No data returned");return a.K.builder.fromGraphUserResource(e).build()}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getUserPhotoAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/users/").concat(e.userId,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getUserPhotoAsync"),retryConfig:(0,m.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getUserLicensesAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/users/").concat(e.userId,"/licenseDetails"),r=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getLicensesForUserAsync")});try{const e=await r.clone().json();if(null==e)throw new Error("No data returned");return e.value}catch(n){throw g.g.generateAjaxClientError(r,n)}}async getJoinedGroupsAsync(e){const t=null===e||void 0===e?void 0:e.skipToken;let r="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/me/memberOf");null!=t&&""!==t&&(r+="".concat(this.skipTokenParam,"=").concat(t));const n=await this.ajaxClient.executeRequest(r,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getJoinedGroupsAsync")});try{const e=await n.clone().json();if(null==e)throw g.g.generateAjaxClientError(n,"No joined group data returned");const t=e.value.map((e=>s.E.builder.fromGraphResource(e).build()));return{data:t,skipToken:e[this.skipTokenKey]?this.extractSkipTokenFromNextLink(e[this.skipTokenKey]):null}}catch(o){throw g.g.generateAjaxClientError(n,o)}}async addMemberToGroupAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId,"/members/$ref"),r={"@odata.id":"".concat(this.hostDomain,"users/").concat(e.userId)};await this.ajaxClient.executeRequest(t,{method:o.PJ.Post,body:JSON.stringify(r),headers:{[n.Lr.ContentType]:n.Mq.Json},telemetryConfig:this.getDefaultRequestTelemetryConfig("addMemberToGroupAsync"),retryConfig:(0,m.Vj)({maxRetryCount:0})})}async removeMemberFromGroupAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId,"/members/").concat(e.userId,"/$ref");await this.ajaxClient.executeRequest(t,{method:o.PJ.Delete,telemetryConfig:this.getDefaultRequestTelemetryConfig("removeMemberFromGroupAsync")})}async deleteGroupAsync(e){const t="".concat(this.hostDomain,"/").concat(this.v1UrlToken,"/groups/").concat(e.groupId);await this.ajaxClient.executeRequest(t,{method:o.PJ.Delete,telemetryConfig:this.getDefaultRequestTelemetryConfig("deleteGroupAsync")})}constructor(e,t){super("DirectoryService",e,t)}}},81704:(e,t,r)=>{r.d(t,{Vj:()=>c});var n=r(95783),o=r(34677),s=r.n(o),a=r(38752),i=r(98502);function c(e){return s()({maxRetryCount:a.B.clientSettings.RetrySettings.MaxRetryCount,maxRetryTimeoutInMiliseconds:a.B.clientSettings.RetrySettings.MaxRetryTimeout,delayOnRetryInMiliseconds:a.B.clientSettings.RetrySettings.RetryDelay,retryCheck:u},e)}async function u(e,t,r){return(null==e.method||e.method.toUpperCase()===n.PJ.Get)&&i.g.isRetryableResponse(t,r)}},61739:(e,t,r)=>{r.d(t,{Cx:()=>s,Ny:()=>a,n0:()=>i});var n=r(54320),o=r.n(n);function s(e){let t="";if(!o()(e))try{t=new URLSearchParams(new URL(e).search).get("$skiptoken")||""}catch(r){}return t}function a(e,t){return"startswith(".concat(e,", '").concat(encodeURIComponent(t).replace(/'/g,"''"),"')")}function i(e){const t="https://graph.microsoft.com/";return e&&0===e.indexOf(t)&&(e=e.substring(28)),e}}}]);
//# sourceMappingURL=directoryservice.4c2c02d9.chunk.js.map