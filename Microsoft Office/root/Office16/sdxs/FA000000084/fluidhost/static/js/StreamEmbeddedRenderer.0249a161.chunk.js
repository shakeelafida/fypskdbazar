"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82368],{87209:(e,t,r)=>{r.r(t),r.d(t,{StreamEmbeddedRenderer:()=>Ye});var n=r(65043);var i=r(91730),o=r(80194),a=r(12851),s=r(56090),l=r(58370),c=r(85540),d=r(80220),u=r(12910);const p="playerInteractiveTimestamp";function h(){return{setIsReady(e,t,r){const n=t.playerInteractiveTimestamp;if(n){const t=n.timestamp,i=n.timeOrigin,o=performance.timeOrigin,a=Math.abs(r-o),s=Math.round(e.startTime-a),l=t+i-r;e.setResult(!0,{timeDrift:Math.round(a),hostTimeOrigin:o,hostVariableTimeOrigin:r,activityStartTimeWithDrift:s,[p]:Math.round(t),playerInteractiveTimestamp_timeOrigin:Math.round(i),playerInteractiveTimestamp_currentTimeScale:Math.round(l),activityStartTimeMs_performanceNow:Math.round(e.startTime),unfurlDurationMs_performanceNow:Math.round(l-e.startTime)})}}}}const m=[" ","Enter"],f=[...m,"Tab"];function v(e){return"warmData"in e}function y(e){return"simulateClick"in e}var b=r(82500);function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.z.VideoLoadFromUnfurl;return e.activities.get(t)}var _=r(36210),w=r(20723),k=r(27200),P=r(29018);var E=function(){function e(e,t,r,n,i,o,a,s){this.level=e,this.isExpected=t,this.scenario=r,this.knownError=n,this.originalError=i,this.message=o,this.playbackSessionId=a,this.hostSessionId=s}return e.createKnownError=function(t,r,n,i,o,a,s,l){return new e(t,r,n,i,o,a,s,l)},e.createGenericError=function(t,r,n,i,o,a,s){var l=!1;if(void 0!==(null===i||void 0===i?void 0:i.isExpected))l=i.isExpected,o=i.errorName;else if(i&&i.message){var c=function(e){return"'ResizeObserver' is undefined"===e||"'ResizeObserver' is not defined"===e||"ResizeObserver is not defined"===e||"Can't find variable: ResizeObserver"===e||"'IntersectionObserver' is undefined"===e||"IntersectionObserver is not defined"===e||"Can't find variable: IntersectionObserver"===e||"'PerformanceObserver' is undefined"===e||"'PerformanceObserver' is not defined"===e||"function is not a constructor (evaluating 'new EventTarget')"===e||"<safe>Unsupported browser</safe>"===e||!(!e||!e.includes("setstrings"))||!(!e||!e.includes("URL is not supported"))||"e.addEventListener is not a function. (In 'e.addEventListener(\"change\",m)', 'e.addEventListener' is undefined)"===e||"Object doesn't support property or method 'addEventListener'"===e||"Performance timeOrigin is not supported"===e}(i.message);c&&(l=!0)}return e.createKnownError(t,l,r,n,i,o,a,s)},e}(),S=r(6326),I=function(e){this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=e},T=function(){function e(e){this._observers=new Array,this.onCallbackError=e}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var r=new I(e);return r.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(r),this.internalRemove.bind(this,r)},e.prototype.notify=function(e){for(var t=0,r=this._observers;t<r.length;t++){var n=r[t];if(!n.willBeUnregistered){try{n.callback(e)}catch(i){this.onCallbackError&&this.onCallbackError(i)}n.unregisterOnNextCall&&this.deferUnregister(n)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout((function(){t.internalRemove(e)}),0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),A=function(){function e(e,t){this._observable=new T(t),this._value=e,this.onCallbackError=t}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var r=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(r)try{e(this._value)}catch(n){this.onCallbackError&&this.onCallbackError(n)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&r?function(){}:this._observable.subscribe(e,t)},e}(),C=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function O(e,t){var r=e,n=r.dispose,i="function"===typeof n&&n.disposalChain||function(e){var t=new C(e),r=e.dispose,n=function(){t.dispose(),r&&(e.dispose=r,e.dispose())};return e.dispose=n,n.disposalChain=t,t}(r);return i.addCallback(t),r}var R=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,r="".concat(++this._lastDisposableId),n=O(e,(function(){delete t._disposables[r]}));return this._disposables[r]=n,n},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,r=Object.keys(e);t<r.length;t++){var n=r[t],i=e[n];i&&"function"===typeof i.dispose&&i.dispose(),delete e[n]}},e}(),U=function(){function e(e){this._scope=new R,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,r){var n;if(M(e))n=e;else{var i=this._targetMap.get(e);i?n=i:(n=new EventTarget,this._targetMap.set(e,n))}n.addEventListener(t,r);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){n.removeEventListener(t,r)}});o.set(t,a)},e.prototype.off=function(e,t,r){var n;if(M(e))n=e;else{var i=this._targetMap.get(e);i&&(n=i)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}n&&n.removeEventListener(t,r)},e.prototype.dispose=function(){this._scope.dispose()},e}();function M(e){return!!e.addEventListener}var x=function(){function e(e){this._scope=new R,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var r=this,n=setTimeout((function(){r._timeoutMap.delete(n),e()}),t),i=this._scope.attach({dispose:function(){clearTimeout(n)}});return this._timeoutMap.set(n,i),n},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),D="unsupportedCommand",N="handlerError",V="handlerRejection",F="acknowledgeTimeout",L="resultTimeout",G="setupTimeout",H="canceled",W="disposed",j=0,z=function(){function e(e,t){void 0===t&&(t={});var r=this,n=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,l=e.ackTimeoutMs,c=void 0===l?1e3:l,d=e.resultTimeoutMs,u=void 0===d?1e4:d,p=t.asyncType,h=void 0===p?x:p,m=t.eventGroupType,f=void 0===m?U:m,v=this._scope=new R;v.attach(o);var y,b=this._async=v.attach(new h(this)),g=v.attach(new f(this));this._ackTimeoutMs=c,this._resultTimeoutMs=u,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch((function(e){return{result:"error",error:{code:(e=e||{name:V,isExpected:!1,message:"Unknown error"}).code||e.name||V,message:e.message||"".concat(e)},isExpected:!!e.isExpected}})):Promise.resolve({result:"error",error:{code:D,message:e.command},isExpected:!0})}catch(r){return Promise.resolve({result:"error",isExpected:!1,error:{code:N,message:r&&"Name: ".concat(r.name,"; Message: ").concat(r.message||r)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(a){}};var _=this._port=new Promise((function(t,n){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=H,n(e)}}),y=b.setTimeout((function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=G,n(e)}),s),e.init((function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});g.on(e,"message",(function(t){var n=t.data;if(n&&"object"===typeof n)return"acknowledge"===n.type?r._onAcknowledge(n):"command"===n.type?r._onCommand(e,n):"notification"===n.type?r._onNotification(n):"result"===n.type?r._onResult(n):void 0})),e.start(),t(e)}),n)}));this.ready=_.then((function(){}),(function(e){return r.dispose(),Promise.reject(e)})),this._signals=n}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach((function(e){e.resolve({result:"error",isExpected:!0,error:{code:H,message:"Messenger disposed"}})})),this._signals.clear()},e.prototype.sendCommand=function(e,t){var r=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:W,message:"disposed"}});var n=++j,i=t.timeoutDelayMs,o=void 0===i?this._resultTimeoutMs:i,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a,l=t.transfer;return this._port.then((function(t){var i=r._async,a=new Promise((function(e){r._signals.set(n,{acknowledgeTimeout:i.setTimeout((function(){r._onResult(B(n,F))}),s),resultTimeout:i.setTimeout((function(){r._onResult(B(n,L))}),o),resolve:e})}));return t.postMessage({type:"command",id:n,data:e},l||[]),a}))},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then((function(t){t.postMessage({type:"notification",data:e})}))},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var r=t.id;e.postMessage({type:"acknowledge",id:r}),this._invokeCommandHandler(t.data).then((function(t){e.postMessage({type:"result",data:t,id:r})})).catch((function(e){}))},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,r=this._async,n=this._signals,i=n.get(t);i&&(r.clearTimeout(i.acknowledgeTimeout),r.clearTimeout(i.resultTimeout),i.resolve(e.data)),n.delete(t)},e}();function B(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}const K={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let J;const X=new Uint8Array(16);function Q(){if(!J&&(J="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!J))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return J(X)}const q=[];for(let $e=0;$e<256;++$e)q.push(($e+256).toString(16).slice(1));function Y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return q[e[t+0]]+q[e[t+1]]+q[e[t+2]]+q[e[t+3]]+"-"+q[e[t+4]]+q[e[t+5]]+"-"+q[e[t+6]]+q[e[t+7]]+"-"+q[e[t+8]]+q[e[t+9]]+"-"+q[e[t+10]]+q[e[t+11]]+q[e[t+12]]+q[e[t+13]]+q[e[t+14]]+q[e[t+15]]}const $=function(e,t,r){if(K.randomUUID&&!t&&!e)return K.randomUUID();const n=(e=e||{}).random||(e.rng||Q)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return Y(n)};var Z,ee=((Z={}).SHAREPOINT_TOKEN="SPO",Z);var te=function(){this.playState=new A(void 0),this.isPlayerReady=new A(!1),this.lastUserAction=new T,this.currentTimeInSeconds=new A(void 0),this.muted=new A(void 0),this.volume=new A(void 0),this.mediaDurationInSeconds=new A(void 0),this.playbackSpeed=new A(void 0),this.title=new A(void 0),this.itemUrl=new A(void 0),this.playerBeforeUnload=new T},re=function(){function e(e,t,r,n,i){var o=this;this._ttlMs=new A(void 0),this._ttirMs=new A(void 0),this._playerInteractiveTimestamp=new A(void 0),this._pbsid=new A(void 0),this._latestValuesFromIframe={playState:void 0,currentTime:void 0,muted:void 0,volume:void 0,playbackSpeed:void 0},this.crossWindow=e,this._tokenRetriever=t,this._embedUrl=r,this._onError=n,this._onTitleOrDisplayNameUpdate=i,this.externalPlayerApi=new te,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp,playbackSessionId:this._pbsid},this.subscribeToApiEvents(),window.addEventListener("beforeunload",(function(){o.externalPlayerApi.playerBeforeUnload.notify(!0)}))}return e.prototype.warmData=function(){return this.crossWindow.sendCommand({command:"one-player-warm-data"}).then((function(){return Promise.resolve()})).catch((function(e){throw E.createGenericError("warning","warmData","warmDataUnknown",e)}))},e.prototype.loadPlayer=function(e){return this.crossWindow.sendCommand({command:e?"one-player-load-player-auto-play":"one-player-load-player"}).then((function(){return Promise.resolve()})).catch((function(e){throw E.createGenericError("fatal","loadPlayer","loadPlayerUnknown",e)}))},e.prototype.onCommand=function(e){if("getToken"===e.command)return function(e,t,r){return(0,S.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s;return(0,S.__generator)(this,(function(l){switch(l.label){case 0:if(!Object.prototype.hasOwnProperty.call(ee,e.tokenType))return[3,4];n=e.tokenType,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t.getTokenAsync(ee[n],r)];case 2:return[2,{result:"success",token:l.sent()}];case 3:return i=l.sent(),o="",a="","object"===typeof i&&null!==i&&(s=i,o=Object.prototype.hasOwnProperty.call(s,"code")&&"string"===typeof s.code?s.code:"",a=Object.prototype.hasOwnProperty.call(s,"message")&&"string"===typeof s.message?s.message:""),[2,{result:"error",isExpected:!1,error:{code:o,message:a}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}}))}))}(e,this._tokenRetriever,this._embedUrl)},e.prototype.onNotification=function(e){switch(void 0===this._pbsid.value&&void 0!==e.pbsid&&(this._pbsid.value=e.pbsid),e.notification){case"one-player-duration":this.externalPlayerApi.mediaDurationInSeconds.value=e.durationInSeconds;break;case"one-player-volume":this._latestValuesFromIframe.volume=e.volume,this.externalPlayerApi.volume.value=e.volume;break;case"one-player-muted":this._latestValuesFromIframe.muted=e.isMuted,this.externalPlayerApi.muted.value=e.isMuted;break;case"one-player-current-time":this._latestValuesFromIframe.currentTime=e.currentTime,this.externalPlayerApi.currentTimeInSeconds.value=e.currentTime;break;case"one-player-playback-speed":this._latestValuesFromIframe.playbackSpeed=e.playbackSpeed,this.externalPlayerApi.playbackSpeed.value=e.playbackSpeed;break;case"one-player-first-interactive":void 0!==e.timestamp&&void 0!==e.timestampTimeOrigin&&(this._playerInteractiveTimestamp.value={timestamp:e.timestamp,timeOrigin:e.timestampTimeOrigin});break;case"one-player-player-ready":this.externalPlayerApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var t="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=t,this.externalPlayerApi.playState.value=t,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||E.createGenericError("fatal","playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||E.createGenericError("fatal","createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-reconnect-host":this.loadAndConnectToOnePlayerCallback(this).catch((function(e){throw E.createGenericError("fatal","requestReconnect","errorReconnecting",e)}));break;case"one-player-user-click-play":this.externalPlayerApi.lastUserAction.notify({action:"Play"});break;case"one-player-user-click-pause":this.externalPlayerApi.lastUserAction.notify({action:"Pause"});break;case"one-player-user-begin-seek":this.externalPlayerApi.lastUserAction.notify({action:"BeginSeek"});break;case"one-player-user-end-seek":if(void 0===e.targetTimeInSeconds)return void this._onError(E.createGenericError("warning","notification","targetTimeInSecondsUndefinedInEndSeekEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"EndSeek",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-user-skip":if(void 0===e.targetTimeInSeconds)return void this._onError(E.createGenericError("warning","notification","targetTimeInSecondsUndefinedInSkipEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"Skip",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-title-updated":this._onTitleOrDisplayNameUpdate(e.title),this.externalPlayerApi.title.value=e.title;break;case"one-player-item-url":this.externalPlayerApi.itemUrl.value=e.itemUrl;break;case"one-player-title-or-display-name-known":this._onTitleOrDisplayNameUpdate(e.value)}},e.prototype.subscribeToApiEvents=function(){var e=this;this.externalPlayerApi.playState.subscribe((function(t){t&&t!==e._latestValuesFromIframe.playState&&e.crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch((function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send play/pause command"))}))})),this.externalPlayerApi.currentTimeInSeconds.subscribe((function(t){void 0!==t&&t!==e._latestValuesFromIframe.currentTime&&e.crossWindow.sendCommand({command:"one-player-seek",position:t}).catch((function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send seek command"))}))})),this.externalPlayerApi.muted.subscribe((function(t){t!==e._latestValuesFromIframe.muted&&e.crossWindow.sendCommand({command:t?"one-player-mute":"one-player-unmute"}).catch((function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send mute/unmute command"))}))})),this.externalPlayerApi.volume.subscribe((function(t){t!==e._latestValuesFromIframe.volume&&e.crossWindow.sendCommand({command:"one-player-set-volume",volumeLevel:t}).catch((function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send set-volume command"))}))})),this.externalPlayerApi.playbackSpeed.subscribe((function(t){t!==e._latestValuesFromIframe.playbackSpeed&&e.crossWindow.sendCommand({command:"one-player-set-playback-speed",playbackSpeed:t}).catch((function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send set-playback-speed command"))}))}))},e}(),ne=function(){function e(e,t,r,n,i){if(this._channelId=$(),this._onError=n,this._onTitleOrDisplayNameUpdate=i,null===t.contentWindow)throw new Error("The iframe's contentWindow is null");var o=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*",a=new URL(e);a.hash="#channelId="+this._channelId+"&origin="+o,this._embedUrl=a.toString(),this._host=function(e,t){void 0===t&&(t={});var r=e.channelId,n=e.onReinitialize,i=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,l=e.identifyParent,c=t.eventGroupType,d=void 0===c?U:c,u=t.messengerType,p=void 0===u?z:u,h=new R,m=h.attach(new d(null));return new p({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(l&&s){var c=setInterval((function(){var e={type:"identify-parent",channelId:r};s.postMessage(e,i)}),100);o=h.attach({dispose:function(){clearInterval(c)}})}var d=!1;m.on(a,"message",(function(t){var a=t.data;if(t.origin===i&&(!s||t.source===s)&&a&&"object"===typeof a&&"initialize"===a.type&&a.channelId===r){if(o&&o.dispose(),n){if(d)return n(),void m.dispose();d=!0}else m.dispose();var l=a.replyTo;l.postMessage({type:"activate"}),e(l)}}))},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:t.contentWindow,channelId:this._channelId.toString(),origin:new URL(e).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this._tokenRetriever=r}return e.prototype.createIframeApi=function(){this.iFrameApi=new re(this._host,this._tokenRetriever,this._embedUrl,this._onError,this._onTitleOrDisplayNameUpdate),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.reconnectHost=function(e){e.crossWindow=this._host,this.iFrameApi=e,this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.getDecoratedEmbedUrl=function(){return this._embedUrl},e.prototype.dispose=function(){this._host.dispose()},e.prototype.onCommand=function(e){return this._onCommandCallback(e)},e.prototype.onNotification=function(e){this._onNotificationCallback(e)},e}();function ie(e,t,r){return new Promise((function(n,i){e.onload=function(){n()},e.onerror=function(e){i(e)};var o=e.contentDocument;o.body||o.createElement("body");var a=o.createElement("form");a.action=t,a.method="POST",a.style.visibility="hidden",a.target="_self";var s=o.createElement("input");s.type="hidden",s.name="access_token",s.value=r,a.appendChild(s),o.body.appendChild(a),a.submit()}))}var oe=function(){function e(e,t,r,n,i){var o=this;this.observer=void 0,this.isIframeConnected=new A(!1),this.defaultIframeTitle="Microsoft Stream video and audio player",this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",i&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups allow-downloads"),this._iframe.setAttribute("title",this.defaultIframeTitle);var a=this.onLoad.bind(this);this._iframe.addEventListener("load",a),this._embedUrl=e,this._containerDiv=t,this._tokenRetriever=r,this._onError=n,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this.observer=new MutationObserver((function(){var e,t,r;o.isIframeConnected.value=(null===(e=o._iframe)||void 0===e?void 0:e.isConnected)||!1,(null===(t=o._iframe)||void 0===t?void 0:t.isConnected)&&(null===(r=o.observer)||void 0===r||r.disconnect())})),this._disposeActions=[function(){var e;o._iframe&&(o._containerDiv.removeChild(o._iframe),o._iframe.removeEventListener("load",a),o._iframe=void 0),null===(e=o.observer)||void 0===e||e.disconnect()}]}return e.prototype.loadAndConnectToOnePlayer=function(e){return(0,S.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i=this;return(0,S.__generator)(this,(function(o){switch(o.label){case 0:if(void 0===this._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._tokenRetriever.getTokenAsync("SPO",this._embedUrl)];case 2:return t=o.sent(),[3,4];case 3:throw r=o.sent(),E.createGenericError("fatal","loadIframe","getTokenFailed",r);case 4:return e&&this.reCreateIframeElement(),[4,this.waitForIframeConnected()];case 5:o.sent(),this._crossWindowChannel=new ne(this._embedUrl,this._iframe,this._tokenRetriever,this._onError,(function(e){return i._onTitleOrDisplayNameUpdate(e)})),e?this._crossWindowChannel.reconnectHost(e):this._crossWindowChannel.createIframeApi(),this._disposeActions.push((function(){var e;return null===(e=i._crossWindowChannel)||void 0===e?void 0:e.dispose()})),this._embedUrl=this._crossWindowChannel.getDecoratedEmbedUrl(),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,ie(this._iframe,this._embedUrl,t)];case 7:return o.sent(),[3,9];case 8:throw n=o.sent(),E.createGenericError("fatal","loadIframe","navToEmbed",n);case 9:return[2,this._crossWindowChannel.iFrameApi]}}))}))},e.prototype.dispose=function(){for(var e=0,t=this._disposeActions;e<t.length;e++){(0,t[e])()}this._disposeActions.length=0},e.prototype.reCreateIframeElement=function(){this._iframe&&(this.dispose(),this._hasNavigatedToAboutBlank=!1),this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups"),this._iframe.setAttribute("title",this.defaultIframeTitle);var e=this.onLoad.bind(this);this._iframe.addEventListener("load",e),this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe)},e.prototype.waitForIframeConnected=function(){return(0,S.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,S.__generator)(this,(function(t){return[2,new Promise((function(t){var r;if(null===(r=e._iframe)||void 0===r?void 0:r.isConnected)t();else{var n=e.isIframeConnected.subscribe((function(e){e&&t()}));e._disposeActions.push((function(){return n()}))}}))]}))}))},e.prototype.onLoad=function(){var e,t,r,n;try{"about:blank"!==(null===(t=null===(e=this._iframe)||void 0===e?void 0:e.contentWindow)||void 0===t?void 0:t.location.href)&&(null===(n=null===(r=this._iframe)||void 0===r?void 0:r.contentWindow)||void 0===n?void 0:n.location.href)||(this._hasNavigatedToAboutBlank&&this._onError(E.createGenericError("fatal","loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(i){i instanceof DOMException&&(this._hasNavigatedToAboutBlank=!0)}},e.prototype._onTitleOrDisplayNameUpdate=function(e){var t;null===(t=this._iframe)||void 0===t||t.setAttribute("title",e||this.defaultIframeTitle)},e}(),ae=function(){function e(e){this._loaderOptionsBase=e}return e.prototype.createPlaybackSession=function(e,t){return(0,S.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o;return(0,S.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return r=a.sent(),n=r[0],i=r[1],[2,{playbackApi:n.externalPlayerApi,dispose:i,playerStats:n.playerStats}];case 2:throw(o=a.sent())instanceof E?o:E.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,t.hostSessionId);case 3:return[2]}}))}))},e.prototype.createThumbnailHyperlinkOnlySession=function(e){return(0,S.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i;return(0,S.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("thumbnailHyperlinkOnly",e)];case 1:return t=o.sent(),r=t[0],n=t[1],[2,{playbackApi:r.externalPlayerApi,playerStats:r.playerStats,dispose:n,simulateClick:function(){return r.loadPlayer(!0)}}];case 2:return i=o.sent(),[2,Promise.reject(i)];case 3:return[2]}}))}))},e.prototype.createDeferredPlaybackSession=function(e){return(0,S.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i,o;return(0,S.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("deferredLoad",e)];case 1:return t=a.sent(),r=t[0],n=t[1],i=new A(void 0),r.externalPlayerApi.isPlayerReady.subscribe((function(e){e&&(i.value=r.externalPlayerApi)})),[2,{playbackApi:i,loadPlayer:function(e){return r.loadPlayer(e)},warmData:function(){return r.warmData()},dispose:n,playerStats:r.playerStats}];case 2:throw(o=a.sent())instanceof E?(o.hostSessionId=e.hostSessionId,o):E.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,e.hostSessionId);case 3:return[2]}}))}))},e.prototype.createPlaybackSessionInternal=function(e,t){return(0,S.__awaiter)(this,void 0,void 0,(function(){var r,n,i,o,a,s,l;return(0,S.__generator)(this,(function(c){switch(c.label){case 0:return r=performance.now(),n={timeOrigin:Date.now()-r,timestamp:r},[4,this.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return i=c.sent(),i=this.adjustEmbedUrlQueryString(e,i,t,n),o=void 0,a=function(){try{null===o||void 0===o||o.dispose()}catch(e){throw e instanceof E?e:E.createGenericError("fatal","dispose","disposeUnknown",e,void 0,t.hostSessionId)}},s=function(e){t.onError(a,e)},[4,(o=new oe(i,t.containerDiv,this._loaderOptionsBase.tokenRetriever,s,t.allowFullscreen)).loadAndConnectToOnePlayer()];case 2:return(l=c.sent()).loadAndConnectToOnePlayerCallback=o.loadAndConnectToOnePlayer.bind(o),[2,[l,a]]}}))}))},e}();const se="13.18.3";var le=function(e){function t(t){return e.call(this,t)||this}return(0,S.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,r,n){var i,o,a=new URL(t);a.searchParams.delete("access_token"),a.searchParams.set("auth","readwrite");var s=void 0,l=void 0,c=void 0;r.theme&&(s="light"===r.theme.name?1:0,l=r.theme.primaryColor,c=r.theme.fluentTheme);var d=JSON.stringify({ap:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hvn:r.hostVersion,he:r.hostEnvironment,hm:r.hostMode,hsi:r.hostSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,lv:se,t0:null!==(i=r.hostTimestamps.t0.timestamp)&&void 0!==i?i:0,t0to:null!==(o=r.hostTimestamps.t0.timeOrigin)&&void 0!==o?o:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,ust:s,pc:l,theme:c,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(a.searchParams.set("embed",d),r.startTimeInSeconds){var u={playbackOptions:{startTimeInSeconds:r.startTimeInSeconds}};a.searchParams.set("nav",JSON.stringify(u))}if(r.flightsUsed||r.flightsUnused){var p={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};a.searchParams.set("exp",JSON.stringify(p))}return a.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw E.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0)},t}(ae);var ce=function(e){function t(t){return e.call(this,t)||this}return(0,S.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,r,n){var i,o,a,s,l,c=new URL(t);c.searchParams.delete("access_token"),c.searchParams.set("auth","readwrite");var d=JSON.stringify({ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hm:r.hostMode,hsi:r.hostSessionId,he:r.hostEnvironment,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,hvn:r.hostVersion,lv:se,t0:null!==(i=r.hostTimestamps.t0.timestamp)&&void 0!==i?i:0,t0to:null!==(o=r.hostTimestamps.t0.timeOrigin)&&void 0!==o?o:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,dl:"deferredLoad"===e?1:void 0,ap:"autoplayOn"===e?1:void 0,thl:"thumbnailHyperlinkOnly"===e?1:void 0,thm:null===(a=r.theme)||void 0===a?void 0:a.name,pc:null===(s=r.theme)||void 0===s?void 0:s.primaryColor,flthm:null===(l=r.theme)||void 0===l?void 0:l.fluentTheme,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(c.searchParams.set("embed",d),r.startTimeInSeconds){var u={playbackOptions:{startTimeInSeconds:r.startTimeInSeconds}};c.searchParams.set("nav",JSON.stringify(u))}if(r.flightsUsed||r.flightsUnused){var p={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};c.searchParams.set("exp",JSON.stringify(p))}return c.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("streamembed.aspx"))return Promise.resolve(e);throw E.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0,void 0)},t}(ae);var de=r(80789),ue=r(16775);const pe={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGE_CHROMIUM:"Edge Chromium",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},he="Windows",me="Mac OS X",fe="Windows Phone",ve="Windows RT",ye="iOS",be="Android",ge="Linux",_e=/(windows|win32)/i,we=/ arm;/i,ke=/windows\sphone\s\d+\.\d+/i,Pe=/(macintosh|mac os x)/i,Ee=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Se=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Ie=/android/i,Te={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Ae="([\\d,.]+)",Ce="Unknown",Oe="undefined";function Re(e,t){return t.indexOf(e)>-1}function Ue(e,t){if(t===pe.MSIE)return function(e){const t=e.match(new RegExp(pe.MSIE+" "+Ae));if(t)return t[1];{const t=e.match(new RegExp("rv:"+Ae));if(t)return t[1]}return""}(e);return function(e,t){let r=e;r===pe.SAFARI&&(r="Version");const n=t.match(new RegExp(r+"/"+Ae));if(n)return n[1];return}(t===pe.EDGE_CHROMIUM?"Edg":t,e)}const Me=e=>e.match(ke)?fe:e.match(we)?ve:e.match(Ee)?ye:e.match(Ie)?be:e.match(Se)?ge:e.match(Pe)?me:e.match(_e)?he:Ce,xe=(e,t)=>t===he?De(e,"Windows NT"):t===be?De(e,t):t===me?Ne(e):Ce,De=(e,t)=>{const r=e.match(new RegExp(t+" "+Ae));return r?Te[r[1]]?Te[r[1]]:r[1]:Ce},Ne=e=>{const t=e.match(new RegExp(me+" ([\\d,_,.]+)"));if(t){const e=t[1].replace(/_/g,".");if(e){const t=(e=>e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null)(e);if(t){return e.split(t)[0]}return e}}return Ce};let Ve;function Fe(){if(!Ve){const e=typeof navigator!==Oe?navigator.userAgent:"",t=function(e){return Re("OPR/",e)?pe.OPERA:Re(pe.PHANTOMJS,e)?pe.PHANTOMJS:Re(pe.EDGE,e)?pe.EDGE:Re("Edg",e)?pe.EDGE_CHROMIUM:Re(pe.ELECTRON,e)?pe.ELECTRON:Re(pe.CHROME,e)?pe.CHROME:Re("Trident",e)?pe.MSIE:Re(pe.FIREFOX,e)?pe.FIREFOX:Re(pe.SAFARI,e)?pe.SAFARI:Re(pe.SKYPE_SHELL,e)?pe.SKYPE_SHELL:void 0}(e),r=void 0!==t?Ue(e,t):void 0,n=Me(e),i=void 0!==n?xe(e,n):void 0;Ve={browserName:t,browserVersion:r,osName:n,osVersion:i}}return Ve}var Le=r(76528);function Ge(){const{osName:e}=Fe();return function(e){if((0,Le.eP)()||(0,Le._y)())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(e)}function He(e){var t;const r=function(e){var t;let r,n=null!==(t=Ge())&&void 0!==t?t:"Native";switch(e){case ue.C.ExchangeAppId:case ue.C.MonarchAppId:case ue.C.OwaAppId:r=ue.b.Outlook,(0,Le._y)()&&(n="Desktop");break;case ue.C.OfficeAppId:r="Win32"===n?ue.b.Outlook:ue.b.LoopApp;break;case ue.C.LoopAppId:r=ue.b.LoopApp}return{hostApp:r,hostPlatform:n}}(e),n=r.hostPlatform||"";return r.hostApp===ue.b.LoopApp?{hostApp:"Loop",hostPlatform:n}:{hostApp:null!==(t=r.hostApp)&&void 0!==t?t:e,hostPlatform:n}}var We=r(73540);function je(e){const t=e.searchParams.get("nav");if(t)try{const e=atob(t),{referralInfo:r}=JSON.parse(e);if(!r)return;return{hostReferrerApp:r.referralApp,hostReferrerAppPlatform:r.referralAppPlatform,hostReferrerView:r.referralView,hostReferrerMode:r.referralMode,hostReferrerPlaybackSessionId:r.referralPlaybackSessionId}}catch{return}}function ze(e){return t=>{"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}function Be(e,t){var r;if(null===(r=e.current)||void 0===r||r.dispose(),t.current){const e=t.current;for(;e.firstChild&&e.lastChild;)e.removeChild(e.lastChild)}}async function Ke(e,t,r,n,i,o,a){var l,c,d,u,p,h,m;let f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=arguments.length>8?arguments[8]:void 0,y=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0,_=arguments.length>11?arguments[11]:void 0,S=arguments.length>12?arguments[12]:void 0,I=arguments.length>13?arguments[13]:void 0;const{hostApp:T,hostPlatform:A}=He(null!==(l=r.AppID)&&void 0!==l?l:""),C=await async function(e,t){return{tokenRetriever:{beginSilentSignOn:()=>{},getTokenAsync:async(r,n)=>{let i=[];try{null===t||void 0===t||t.markSubActivityStart(b.n.OnePlayerTokenRetrieval);const r=w.P.SharePoint;i=(0,k.w)((0,P.$)(n),r);const o=await e.TokenProvider.getToken(i);return null===t||void 0===t||t.markSubActivityEnd(b.n.OnePlayerTokenRetrieval),o.token}catch(o){throw null===t||void 0===t||t.markSubActivityEnd(b.n.OnePlayerTokenRetrieval,{[s.QK.OnePlayerTokenRetrieval]:"failed",tokenType:r}),o}}}}}(r,y),O=n.additionalTelemetryProperties.unfurlCorrelationId,R=n.additionalTelemetryProperties.variableTimeOrigin,U=(M=n.settingsProvider,(0,We.q_)(M)?"P-X-1112345-4":(0,We.pG)(M)?"P-X-1112345-2":(0,We.uc)(M)?"P-X-1112345-1":"P-X-1112345-3");var M;const x=null===(c=n.telemetryConfig)||void 0===c?void 0:c.scenarioStartTime,D=v&&(null===(d=v.PersistedProperties)||void 0===d||null===(u=d.getPersistedProperties)||void 0===u?void 0:u.call(d).hostScenarioStartTime),N=v&&(null===(p=v.PersistedProperties)||void 0===p||null===(h=p.getPersistedProperties)||void 0===h?void 0:h.call(p).codeVersion),V=function(e,t,r,n,i){if(t)return performance.now();if(e){const e=null!==n&&void 0!==n?n:i;if(void 0!==e){const t=Date.now()-e;return performance.now()-t}}return null!==r&&void 0!==r?r:performance.now()}((0,We.xn)(n.settingsProvider),f,null===y||void 0===y?void 0:y.startTime,"number"===typeof D?D:void 0,x),F=I?function(e,t){const r=e.searchParams.getAll("referrer"),n=e.searchParams.getAll("referrerScenario");if(0===r.length)return je(e);if(1===r.length&&r[r.length-1].split(".")[0]===t)return je(e);let i=r[r.length-1],o=n[n.length-1];i.split(".")[0]===t&&r.length>1&&(i=r[r.length-2],n.length>1&&(o=n[n.length-2]));const a=i.split(".")[0],s=i.split(".")[1];let l,c,d;return o&&(l=o.split(".")[0],c=o.split(".")[1],d=o.split(".")[2]),{hostReferrerApp:a,hostReferrerAppPlatform:s,hostReferrerView:l,hostReferrerMode:c,hostReferrerPlaybackSessionId:d}}(I,T):void 0;null===y||void 0===y||y.addAdditionalProps({unfurlCorrelationId:O,isVideoHydratedInDetachedMode:f,t0TimeOrigin:R,t0:V,telemetryConfigScenarioStartTime:x,loggerScenarioStartTime:D,usedOnePlayerIframeConfigId:U,playerReloads:g.current}),g.current+=1;const L={videoId:{videoUrl:(0,We.pG)(n.settingsProvider)?t:t.replace("embed.aspx","streamembed.aspx")},containerDiv:e,allowFullscreen:!1,onError:(e,t)=>o(e,t,y),hostApp:T,hostPlatform:A,hostComponent:de.I,hostView:null!==_&&void 0!==_?_:"",theme:i,hostSessionId:(null===(m=n.telemetryConfig)||void 0===m?void 0:m.hostSessionId)||"",hostCorrelationId:O||"",hostMode:void 0,hostEnvironment:"Prod",hostTimestamps:{t0:{timestamp:V,timeOrigin:R}},hostVersion:"string"===typeof N?N:"",hostReferrerApp:null===F||void 0===F?void 0:F.hostReferrerApp,hostReferrerAppPlatform:null===F||void 0===F?void 0:F.hostReferrerAppPlatform,hostReferrerView:null===F||void 0===F?void 0:F.hostReferrerView,hostReferrerMode:null===F||void 0===F?void 0:F.hostReferrerMode,hostReferrerPlaybackSessionId:null===F||void 0===F?void 0:F.hostReferrerPlaybackSessionId,overrideLanguage:a,enableVideoPlayerTabstopDuringPlayback:!1,flightsUsed:[U],startTimeInSeconds:S};null===y||void 0===y||y.markSubActivityEnd(b.n.TimeInPlaybackLoopComponent);const G=function(e,t){return(0,We.pG)(t)?function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new le(e)}catch(r){throw r instanceof E?r:E.createGenericError("fatal","loadIframe",t,r)}}(e):function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new ce(e)}catch(r){throw r instanceof E?r:E.createGenericError("fatal","loadIframe",t,r)}}(e)}(C,n.settingsProvider);return await function(e,t,r){return(0,We.q_)(r)||(0,We.pG)(r)?e.createPlaybackSession(!1,t):(0,We.uc)(r)?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(G,L,n.settingsProvider)}class Je{cleanUp(){this.playState.unsubscribeAll()}constructor(e){this.isPlayerReady=new A(!1),this.playState=new A("Paused"),this.lastUserAction=new A({action:"Pause"}),this.currentTimeInSeconds=new A(void 0),this.muted=new A(void 0),this.volume=new A(void 0),this.mediaDurationInSeconds=new A(void 0),this.playbackSpeed=new A(void 0),this.title=new A(void 0),this.itemUrl=new A(void 0),this.playerBeforeUnload=new A(!1),this.playState.subscribe((t=>{"Playing"===t&&e.loadPlayer(!0).catch((e=>{throw e}))}))}}const Xe={dark:"dark",light:"light",default:"light"};function Qe(e){if(e.current){return getComputedStyle(e.current).getPropertyValue(_.Fj)||void 0}}var qe=r(33788);const Ye=e=>{let{embeddableUrl:t,playbackStateSetter:r,parentRef:p,setViewRootElement:w,endRenderingActivity:k,onKeyDownHandler:P,setIsPlayerReady:E,setError:S,updateTitle:I,strings:T,hostView:A,startTimeInSeconds:C,playerLoads:O,videoUrl:R}=e;const U=(0,c.U)(),M=(0,d.i)(),x=(0,u._)(),D=n.useRef(null),N=n.useRef(!1),V=n.useRef(null),F=n.useRef(null),L=n.useRef(null),G=n.useRef(void 0),[H,W]=n.useState(!1),j=(0,i.b)(),z=function(e){const t=(0,i.b)(),[r,o]=n.useState();return n.useEffect((()=>{const n=Xe[(null===t||void 0===t?void 0:t.themeName)||"light"];e.current&&(null===r||void 0===r?void 0:r.name)!==n&&o({name:n,primaryColor:Qe(e)})}),[t,e,null===r||void 0===r?void 0:r.name]),r}(D),B=(0,o.Ym)(),K=n.useMemo(h,[]),J=!(0,We.pG)(M.settingsProvider)&&!(0,We.q_)(M.settingsProvider)&&!(0,We.uc)(M.settingsProvider),X=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[r,i]=n.useState(!1),o=n.useRef(),l=(0,c.U)();return n.useEffect((()=>{if(!t)return;const e=new IntersectionObserver((e=>{i(e[0].isIntersecting)}));return o.current=e,()=>e.disconnect()}),[t]),n.useEffect((()=>{if(!t)return;const r=e.current;if(r){if(o.current){const e=o.current;return e.observe(r),()=>e.unobserve(r)}return()=>{}}(0,a.H)(void 0,l,"useVisibilityObserver",s.QK.MissingVisibilityElement)}),[e,l,t]),{observer:o,isVisible:r}}(p,J),Q=function(e){const[t,r]=n.useState(null),i=n.useRef(null),[o,a]=n.useState(void 0);n.useEffect((()=>{r(e.current)}),[e]);const s=()=>{var e;null===(e=i.current)||void 0===e||e.disconnect()};return n.useEffect((()=>{if(t&&(s(),a((()=>t.isConnected)),!t.isConnected))return i.current=new MutationObserver((()=>{a((()=>t.isConnected)),t.isConnected&&s()})),i.current.observe(document.body,{subtree:!0,childList:!0}),()=>{s()}}),[t]),o}(D),q=(0,We.d5)(M.settingsProvider)&&Q,Y=n.useCallback(((e,t)=>{t&&e&&(null===E||void 0===E||E(!0),K.setIsReady(t,{playerInteractiveTimestamp:e},M.additionalTelemetryProperties.variableTimeOrigin))}),[M,K,E]),$=n.useCallback((e=>{if((e=>m.includes(e.key))(e)){e.preventDefault(),e.stopPropagation();const t=L.current;if(t&&y(t))return void(G.current?window.open(G.current,"_blank","noopener,noreferrer"):(F.current={...F.current,itemUrlUnsubscribe:t.playbackApi.itemUrl.subscribe((e=>{e&&(G.current=e,window.open(e,"_blank","noopener,noreferrer"))}))},t.simulateClick()));"Playing"===r.getPlaybackState()?r.pause():r.play()}else(e=>f.includes(e.key))(e)||P(e)}),[r,P]),Z=n.useCallback((()=>{(0,_.hS)(p.current,(0,We.vd)(M.settingsProvider))}),[p,M]),ee=n.useCallback((()=>{(0,_.Ig)(p.current,(0,We.vd)(M.settingsProvider))}),[p,M]),te=n.useCallback(((e,t)=>{r.initialize(e),F.current={...F.current,playStateUnsubscribe:e.playState.subscribe(ze(r)),titleUnsubscribe:e.title.subscribe(I),playerBeforeUnloadUnsubscribe:e.playerBeforeUnload.subscribe(t)}}),[r,I]);return n.useEffect((()=>{if(!L.current)return;const e=L.current;var t;v(e)&&X.isVisible&&p.current&&(null===(t=X.observer.current)||void 0===t||t.unobserve(p.current),e.warmData().catch((e=>{(0,a.H)(e,U,"warmData",s.QK.OnePlayerWarmup)})))}),[X,U,p,H]),n.useEffect((()=>{const e=(e,t,r)=>{null===E||void 0===E||E(!0);const{level:n,isExpected:o,scenario:a,knownError:c,playbackSessionId:d}=t;"iframeForciblyUnloaded"===c?(L.current=null,e(),null===r||void 0===r||r.markSubActivityStart(b.n.SetupIframeAfterIframeForciblyUnloaded),i(!1,r),null===r||void 0===r||r.markSubActivityEnd(b.n.SetupIframeAfterIframeForciblyUnloaded)):(k(l.G.Embedded),null===r||void 0===r||r.setResult(!1,{errorCode:s.QK.IframePlayerSetup,level:n,scenario:a,isExpected:o,playbackSessionId:d},c),"loadIframe"===a&&S&&S(new Error("loadIframe failed")))},n=e=>{if(e){const e=qe.m.start(b.z.SetupIframeAfterBeforeUnload,U);M.activities.set(b.z.SetupIframeAfterBeforeUnload,e),Be(L,D),i(!1,e)}};function i(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=arguments.length>1?arguments[1]:void 0;if(void 0!==q){if((0,We.d5)(M.settingsProvider)){if(null===D.current||void 0===z||!q)return void(q||(N.current=!0,null===c||void 0===c||c.markSubActivityStart(b.n.VideoHydratedInDetachedMode)));N.current&&(N.current=!1,null===c||void 0===c||c.markSubActivityEnd(b.n.VideoHydratedInDetachedMode))}else{if(null===D.current||void 0===z)return;if(!D.current.isConnected)return void function(e,t,r){null===r||void 0===r||r.markSubActivityStart(b.n.VideoHydratedInDetachedMode);const n=document.createElement("iframe");n.height="0px",n.width="0px",n.style.visibility="hidden";const i=()=>{e.removeChild(n),null===r||void 0===r||r.markSubActivityEnd(b.n.VideoHydratedInDetachedMode),t(!0,r),document.removeEventListener("load",i),document.removeEventListener("error",i)};n.addEventListener("load",i),n.addEventListener("error",i),e.appendChild(n)}(D.current,i,c)}if(O.current>0){const e=qe.m.start(b.z.VideoReloadFromUnfurl,U);M.activities.set(b.z.VideoReloadFromUnfurl,e)}Ke(D.current,t,x,M,z,e,B,o,U,O.current>0?g(M,b.z.VideoReloadFromUnfurl):c,O,A,C,R).then((e=>{if(k(l.G.Embedded),L.current=e,W(!0),w(V.current),F.current={playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe((e=>{const t=O.current>1?g(M,b.z.VideoReloadFromUnfurl):c;Y(e,t)}))},v(e)){const t=new Je(e);r.initialize(t),F.current={...F.current,playbackApiUnsubscribe:e.playbackApi.subscribe((e=>{e&&(t.cleanUp(),te(e,n))}))}}else y(e)||te(e.playbackApi,n)})).catch((e=>{null===E||void 0===E||E(!0),k(l.G.Embedded);const t=(e=>{const t=e=>"object"===typeof e&&null!==e;let r=e;if(t(e)&&"string"!==typeof e.message){const n=e.originalError;"string"===typeof n?r={...e,message:n}:t(n)&&"string"===typeof n.message&&(r={...e,message:n.message})}return r})(e);var r;O.current>1&&(null===(r=g(M,b.z.VideoReloadFromUnfurl))||void 0===r||r.setResult(!1,{errorCode:s.QK.IframePlayerSetup},t));null===c||void 0===c||c.setResult(!1,{errorCode:s.QK.IframePlayerSetup},t),(0,a.H)(t,U,"setupIframePlayer",s.QK.IframePlayerSetup)}))}}return i(!1,g(M,b.z.VideoLoadFromUnfurl)),()=>{var e;F.current&&(e=F.current,Object.values(e).forEach((e=>e()))),Be(L,D)}}),[q,t,x,U,M,r,k,z,w,Y,K,$,B,te,E,S,A,C,O,R]),n.createElement(n.Fragment,null,n.createElement("div",{ref:V,role:"link",tabIndex:0,onFocus:Z,onBlur:ee,onKeyDown:$,"aria-label":T.onePlayerIframeHostContainerAriaLabel}),n.createElement("div",{ref:D,className:(0,_.qo)(null===j||void 0===j?void 0:j.theme.palette.themePrimary),"aria-label":T.onePlayerIframeHostContainerAriaLabel}))}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.0249a161.chunk.js.map