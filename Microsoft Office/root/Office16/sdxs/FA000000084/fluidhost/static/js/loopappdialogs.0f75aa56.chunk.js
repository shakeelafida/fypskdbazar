/*! For license information please see loopappdialogs.0f75aa56.chunk.js.LICENSE.txt */
(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[24901],{73141:(e,t,n)=>{"use strict";var o,i,r;n.d(t,{EE:()=>o,MK:()=>i,aC:()=>r}),function(e){e.Feedback="feedback",e.EntityAction="entityAction"}(o||(o={})),function(e){e.Yes="Yes",e.No="No"}(i||(i={})),function(e){e.EntityClicked="entityclicked",e.PreviewOpen="previewopen",e.PreviewClose="previewclose",e.MouseHover="mousehover"}(r||(r={}))},61513:(e,t,n)=>{"use strict";var o;n.d(t,{r:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(o||(o={}))},22953:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ee});var o,i=n(65804),r=n(6326),a=n(65043),s=n(13706),l=n(35363),c=n(53930),d=n(51134),u=n(89379),p=n(96318),h=n(4648),m=n(78233),g=n(9833),f=n(24718),v=n(72799),b=n(44388),y=n(50605),C=n(17066),S=n(97943),k=n(67048),D=n(17557),x=n(82014),T=n(19487),E=(0,u.Z)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(o||(o={}));var w,_,I,P,A,R=function(e){function t(t){var n=e.call(this,t)||this;n._panel=a.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?(0,p.K0)(e,n._events):(0,p.c8)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,o=void 0===t?n._onRenderNavigationContent:t;return a.createElement("div",{className:n._classNames.navigation},o(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,o=e.closeButtonAriaLabel,i=e.hasCloseButton,r=e.onRenderHeader,l=void 0===r?n._onRenderHeader:r;if(i){var c=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return a.createElement(a.Fragment,null,!n._hasCustomNavigation&&l(n.props,n._onRenderHeader,n._headerTextId),a.createElement(s.K,{styles:c,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:o,title:o,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,o){var i=e.headerText,s=e.headerTextProps,l=void 0===s?{}:s;return i?a.createElement("div",{className:n._classNames.header},a.createElement("div",(0,r.__assign)({id:o,role:"heading","aria-level":1},l,{className:(0,h.A)(n._classNames.headerText,l.className)}),i)):null},n._onRenderBody=function(e){return a.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,o=void 0===t?null:t;return o?a.createElement("div",{className:n._classNames.footer},a.createElement("div",{className:n._classNames.footerInner},o())):null},n._animateTo=function(e){e===o.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout((function(){n.setState({visibility:e}),n._onTransitionComplete(e)}),200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(e){n._updateFooterPosition(),e===o.open&&n.props.onOpened&&n.props.onOpened(),e===o.closed&&n.props.onDismissed&&n.props.onDismissed()};var i=n.props.allowTouchBodyScroll,l=void 0!==i&&i;return n._allowTouchBodyScroll=l,(0,m.f)(n),(0,g.A)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:o.closed,id:(0,f.O)("Panel")},n}return(0,r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==o.closed&&t.visibility!==o.animatingClosed?e.isOpen||t.visibility!==o.open&&t.visibility!==o.animatingOpen?null:{visibility:o.animatingClosed}:{visibility:o.animatingOpen}},t.prototype.componentDidMount=function(){this._async=new v.j(this),this._events=new b.g(this);var e=(0,T.k_)(this.context),t=(0,T.LW)(this.context);this._events.on(e,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(null===t||void 0===t?void 0:t.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:o.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),i=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===o.animatingOpen?this._animateTo(o.open):this.state.visibility===o.animatingClosed&&this._animateTo(o.closed));var r=(0,T.LW)(this.context);n&&!i?this._events.on(null===r||void 0===r?void 0:r.body,"mousedown",this._dismissOnOuterClick,!0):!n&&i&&this._events.off(null===r||void 0===r?void 0:r.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,i=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,u=e.focusTrapZoneProps,p=e.forceFocusInsideTrap,h=e.hasCloseButton,m=e.headerText,g=e.headerClassName,f=void 0===g?"":g,v=e.ignoreExternalFocusing,b=e.isBlocking,S=e.isFooterAtBottom,x=e.isLightDismiss,T=e.isHiddenOnDismiss,w=e.layerProps,_=e.overlayProps,I=e.popupProps,P=e.type,A=e.styles,R=e.theme,L=e.customWidth,N=e.onLightDismissClick,M=void 0===N?this._onPanelClick:N,O=e.onRenderNavigation,B=void 0===O?this._onRenderNavigation:O,F=e.onRenderHeader,j=void 0===F?this._onRenderHeader:F,H=e.onRenderBody,z=void 0===H?this._onRenderBody:H,U=e.onRenderFooter,W=void 0===U?this._onRenderFooter:U,K=this.state,G=K.isFooterSticky,q=K.visibility,V=K.id,Z=P===D.H.smallFixedNear||P===D.H.customNear,Y=(0,y.jI)(R)?Z:!Z,X=P===D.H.custom||P===D.H.customNear?{width:L}:{},$=(0,C.G1)(this.props,C.JM),J=this.isActive,Q=q===o.animatingClosed||q===o.animatingOpen;if(this._headerTextId=m&&V+"-headerText",!J&&!Q&&!T)return null;this._classNames=E(A,{theme:R,className:n,focusTrapZoneClassName:u?u.className:void 0,hasCloseButton:h,headerClassName:f,isAnimating:Q,isFooterSticky:G,isFooterAtBottom:S,isOnRightSide:Y,isOpen:J,isHiddenOnDismiss:T,type:P,hasCustomNavigation:this._hasCustomNavigation});var ee,te=this._classNames,ne=this._allowTouchBodyScroll;return b&&J&&(ee=a.createElement(c.h,(0,r.__assign)({className:te.overlay,isDarkThemed:!1,onClick:x?M:void 0,allowTouchBodyScroll:ne},_))),a.createElement(l.W,(0,r.__assign)({},w),a.createElement(d.z,(0,r.__assign)({role:"dialog","aria-modal":b?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:te.hiddenPanel,enableAriaHiddenSiblings:!!J},I),a.createElement("div",(0,r.__assign)({"aria-hidden":!J&&Q},$,{ref:this._panel,className:te.root}),ee,a.createElement(k.Y,(0,r.__assign)({ignoreExternalFocusing:v,forceFocusInsideTrap:!(!b||T&&!J)&&p,firstFocusableSelector:s,isClickableOutsideFocusTrap:!0},u,{className:te.main,style:X,elementToFocusOnDismiss:i}),a.createElement("div",{className:te.contentInner},a.createElement("div",{ref:this._allowScrollOnPanel,className:te.scrollableContent,"data-is-scrollable":!0},a.createElement("div",{className:te.commands,"data-is-visible":!0},B(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!h)&&j(this.props,this._onRenderHeader,this._headerTextId),z(this.props,this._onRenderBody),W(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:o.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:o.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===o.open||this.state.visibility===o.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&((0,S.s)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:D.H.smallFixedFar},t.contextType=x._0,t}(a.Component),L=n(33516),N={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},M="100%",O="auto",B=272,F=340,j=592,H=644,z=940,U="auto",W=0,K=48,G=428,q=176,V=((w={})["@media (min-width: ".concat(L.O7,"px)")]={width:F},w),Z=((_={})["@media (min-width: ".concat(L.mu,"px)")]={width:j},_["@media (min-width: ".concat(L.af,"px)")]={width:H},_),Y=((I={})["@media (min-width: ".concat(L.c3,"px)")]={left:K,width:O},I["@media (min-width: ".concat(L.Ke,"px)")]={left:G},I),X=((P={})["@media (min-width: ".concat(L.Ke,"px)")]={left:U,width:z},P),$=((A={})["@media (min-width: ".concat(L.Ke,"px)")]={left:q},A),J=function(e){var t;switch(e){case D.H.smallFixedFar:t=(0,r.__assign)({},V);break;case D.H.medium:t=(0,r.__assign)((0,r.__assign)({},V),Z);break;case D.H.large:t=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},V),Z),Y);break;case D.H.largeFixed:t=(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({},V),Z),Y),X);break;case D.H.extraLarge:t=(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({},V),Z),Y),$)}return t},Q={paddingLeft:"24px",paddingRight:"24px"},ee=(0,i.I)(R,(function(e){var t,n,o,i,a=e.className,s=e.focusTrapZoneClassName,l=e.hasCloseButton,c=e.headerClassName,d=e.isAnimating,u=e.isFooterSticky,p=e.isFooterAtBottom,h=e.isOnRightSide,m=e.isOpen,g=e.isHiddenOnDismiss,f=e.hasCustomNavigation,v=e.theme,b=e.type,y=void 0===b?D.H.smallFixedFar:b,C=v.effects,S=v.fonts,k=v.semanticColors,x=(0,L.Km)(N,v),T=y===D.H.custom||y===D.H.customNear;return{root:[x.root,v.fonts.medium,m&&x.isOpen,l&&x.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},T&&h&&x.custom,T&&!h&&x.customNear,a],overlay:[{pointerEvents:"auto",cursor:"pointer"},m&&d&&L.lw.fadeIn100,!m&&d&&L.lw.fadeOut100],hiddenPanel:[!m&&!d&&g&&{visibility:"hidden"}],main:[x.main,{backgroundColor:k.bodyBackground,boxShadow:C.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:U,right:W,width:M,selectors:(0,r.__assign)((t={},t[L.up]={borderLeft:"3px solid ".concat(k.variantBorder),borderRight:"3px solid ".concat(k.variantBorder)},t),J(y))},y===D.H.smallFluid&&{left:W},y===D.H.smallFixedNear&&{left:W,right:U,width:B},y===D.H.customNear&&{right:"auto",left:0},T&&{maxWidth:"100vw"},m&&d&&!h&&L.lw.slideRightIn40,m&&d&&h&&L.lw.slideLeftIn40,!m&&d&&!h&&L.lw.slideLeftOut40,!m&&d&&h&&L.lw.slideRightOut40,s],commands:[x.commands,{backgroundColor:k.bodyBackground,paddingTop:18,selectors:(n={},n["@media (min-height: ".concat(L.O7,"px)")]={position:"sticky",top:0,zIndex:1},n)},f&&{paddingTop:"inherit"}],navigation:[x.navigation,{display:"flex",justifyContent:"flex-end"},f&&{height:"44px"}],contentInner:[x.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[x.header,Q,{alignSelf:"flex-start"},l&&!f&&{flexGrow:1},f&&{flexShrink:0}],headerText:[x.headerText,S.xLarge,{color:k.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},c],scrollableContent:[x.scrollableContent,{overflowY:"auto"},p&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[x.content,Q,{paddingBottom:20},p&&{selectors:(o={},o["@media (min-height: ".concat(L.O7,"px)")]={flexGrow:1},o)}],footer:[x.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity ".concat(L.cs.durationValue3," ").concat(L.cs.easeFunction2),selectors:(i={},i["@media (min-height: ".concat(L.O7,"px)")]={position:"sticky",bottom:0},i)},u&&{backgroundColor:k.bodyBackground,borderTopColor:k.variantBorder}],footerInner:[x.footerInner,Q,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[x.closeButton,{marginRight:14,color:v.palette.neutralSecondary,fontSize:L.fF.large},f&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:v.palette.neutralPrimary}}}}}),void 0,{scope:"Panel"})},17557:(e,t,n)=>{"use strict";var o;n.d(t,{H:()=>o}),function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(o||(o={}))},94299:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var o=n(65804),i=n(6326),r=n(65043),a=n(89379),s=n(24718),l=(0,a.Z)(),c=function(e){function t(t){var n=e.call(this,t)||this;n._onRenderProgress=function(e){var t=n.props,o=t.ariaLabel,i=t.ariaValueText,a=t.barHeight,s=t.className,c=t.description,d=t.label,u=void 0===d?n.props.title:d,p=t.styles,h=t.theme,m="number"===typeof n.props.percentComplete?Math.min(100,Math.max(0,100*n.props.percentComplete)):void 0,g=l(p,{theme:h,className:s,barHeight:a,indeterminate:void 0===m}),f={width:void 0!==m?m+"%":void 0,transition:void 0!==m&&m<.01?"none":void 0},v=void 0!==m?0:void 0,b=void 0!==m?100:void 0,y=void 0!==m?Math.floor(m):void 0;return r.createElement("div",{className:g.itemProgress},r.createElement("div",{className:g.progressTrack}),r.createElement("div",{className:g.progressBar,style:f,role:"progressbar","aria-describedby":c?n._descriptionId:void 0,"aria-label":o,"aria-labelledby":u?n._labelId:void 0,"aria-valuemin":v,"aria-valuemax":b,"aria-valuenow":y,"aria-valuetext":i}))};var o=(0,s.O)("progress-indicator");return n._labelId=o+"-label",n._descriptionId=o+"-description",n}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,o=e.label,a=void 0===o?this.props.title:o,s=e.description,c=e.styles,d=e.theme,u=e.progressHidden,p=e.onRenderProgress,h=void 0===p?this._onRenderProgress:p,m="number"===typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,g=l(c,{theme:d,className:n,barHeight:t,indeterminate:void 0===m});return r.createElement("div",{className:g.root},a?r.createElement("div",{id:this._labelId,className:g.itemName},a):null,u?null:h((0,i.__assign)((0,i.__assign)({},this.props),{percentComplete:m}),this._onRenderProgress),s?r.createElement("div",{id:this._descriptionId,className:g.itemDescription},s):null)},t.defaultProps={label:"",description:"",width:180},t}(r.Component),d=n(33516),u=n(66783),p=n(50605),h={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},m=(0,u.J9)((function(){return(0,d.i7)({"0%":{left:"-30%"},"100%":{left:"100%"}})})),g=(0,u.J9)((function(){return(0,d.i7)({"100%":{right:"-30%"},"0%":{right:"100%"}})})),f=(0,o.I)(c,(function(e){var t,n,o,r=(0,p.jI)(e.theme),a=e.className,s=e.indeterminate,l=e.theme,c=e.barHeight,u=void 0===c?2:c,f=l.palette,v=l.semanticColors,b=l.fonts,y=(0,d.Km)(h,l),C=f.neutralLight;return{root:[y.root,b.medium,a],itemName:[y.itemName,d.oA,{color:v.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[y.itemDescription,{color:v.bodySubtext,fontSize:b.small.fontSize,lineHeight:18}],itemProgress:[y.itemProgress,{position:"relative",overflow:"hidden",height:u,padding:"".concat(8,"px 0")}],progressTrack:[y.progressTrack,{position:"absolute",width:"100%",height:u,backgroundColor:C,selectors:(t={},t[d.up]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:f.themePrimary,height:u,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[d.up]=(0,i.__assign)({backgroundColor:"highlight"},(0,d.Qg)()),n)},s?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, ".concat(C," 0%, ")+"".concat(f.themePrimary," 50%, ").concat(C," 100%)"),animation:"".concat(r?g():m()," 3s infinite"),selectors:(o={},o[d.up]={background:"highlight"},o)}:{transition:"width .15s linear"},y.progressBar]}}),void 0,{scope:"ProgressIndicator"})},34644:(e,t,n)=>{"use strict";function o(e,t){for(var n=[],o=0,i=t;o<i.length;o++){var r=e[i[o]];r&&n.push(r)}return n}n.d(t,{D:()=>o})},50199:(e,t,n)=>{"use strict";var o;n.d(t,{W:()=>o}),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(o||(o={}))},42283:(e,t,n)=>{"use strict";n.d(t,{t:()=>l});var o=n(65043),i=n(16112),r=n(8201),a=n(93950),s=n.n(a);class l extends i.${name(){return"DebouncedDropdown"}componentDidUpdate(e,t){this.state.currentSelectedKey!==this.props.selectedKey&&this.props.selectedKey!==e.selectedKey&&this.setState({currentSelectedKey:this.props.selectedKey})}renderComponent(){const{debounceInterval:e,children:t,...n}={...this.props,selectedKey:this.state.currentSelectedKey,onChange:this.onChange};return o.createElement(r.m,n,t)}constructor(e,t){super(e,t),this.onChange=(e,t,n)=>{this.setState({currentSelectedKey:null===t||void 0===t?void 0:t.key}),this.debouncedOnChange(e,t,n)},this.debouncedOnChange=this.props.onChange?s()(this.props.onChange,this.props.debounceInterval):()=>{},this.state={currentSelectedKey:this.props.selectedKey}}}},8201:(e,t,n)=>{"use strict";n.d(t,{m:()=>me});var o=n(65043),i=n(16112),r=n(65804),a=n(6326),s=n(89379),l=n(64930),c=n(27194),d=n(4648),u=n(48717),p=n(27480),h=n(17046),m=n(78233),g=n(24718),f=n(17066),v=n(74258),b=n(73095),y=n(44359),C=n(50840),S=n(6017),k=n(87633),D=n(50199),x=function(){function e(){this._size=0}return e.prototype.updateOptions=function(e){for(var t=[],n=[],o=0,i=0;i<e.length;i++){var r=e[i],s=r.itemType,l=r.hidden;s===D.W.Divider||s===D.W.Header?(t.push(i),n.push(i)):l?n.push(i):o++}this._size=o,this._displayOnlyOptionsCache=t,this._notSelectableOptionsCache=n,this._cachedOptions=(0,a.__spreadArray)([],e,!0)},Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._notSelectableOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index ".concat(e," is not a selectable element."));if(this._notSelectableOptionsCache[t]!==e)return e-t+1}},e}(),T=n(65337),E=n(94850),w=n(20751),_=n(31537),I=n(22953),P=n(62450),A=n(46745),R=n(34644),L=n(23830),N=n(52787),M=n(58847),O=n(56420),B=n(82014),F=n(19487),j=(0,s.Z)(),H={options:[]};var z=o.forwardRef((function(e,t){var n=(0,N.N)(H,e),i=o.useRef(null),r=(0,O.a)(t,i),s=(0,P.z)(i,n.responsiveMode),c=function(e){var t,n=e.defaultSelectedKeys,i=e.selectedKeys,r=e.defaultSelectedKey,a=e.selectedKey,s=e.options,c=e.multiSelect,d=(0,M.Z)(s),u=o.useState([]),p=u[0],h=u[1],m=s!==d;t=c?m&&void 0!==n?n:i:m&&void 0!==r?r:a;var g=(0,M.Z)(t);return o.useEffect((function(){var e=function(){return s.map((function(e,t){return e.selected?t:-1})).filter((function(e){return-1!==e}))},n=function(e){return(0,l.SL)(s,(function(t){return null!=e?t.key===e:!!t.selected||!!t.isSelected}))};void 0===t&&d||t===g&&!m||h(function(){if(void 0===t)return c?e():-1!==(a=n(null))?[a]:[];if(!Array.isArray(t))return-1!==(a=n(t))?[a]:[];for(var o=[],i=0,r=t;i<r.length;i++){var a,s=r[i];-1!==(a=n(s))&&o.push(a)}return o}())}),[m,c,d,g,s,t]),[p,h]}(n),d=c[0],u=c[1];return o.createElement(V,(0,a.__assign)({},n,{responsiveMode:s,hoisted:{rootRef:r,selectedIndices:d,setSelectedIndices:u}}))}));z.displayName="DropdownBase";var U,W,K,G,q,V=function(e){function t(t){var n=e.call(this,t)||this;n._host=o.createRef(),n._focusZone=o.createRef(),n._dropDown=o.createRef(),n._scrollIdleDelay=250,n._sizePosCache=new x,n._requestAnimationFrame=function(e){var t;return function(n){t||(t=new Set,(0,c.i)(e,{componentWillUnmount:function(){t.forEach((function(e){return cancelAnimationFrame(e)}))}}));var o=requestAnimationFrame((function(){t.delete(o),n()}));t.add(o)}}(n),n.dismissMenu=function(){n.state.isOpen&&n.setState({isOpen:!1})},n._onChange=function(e,t,o,i,r){var s=n.props,l=s.onChange,c=s.onChanged;if(l||c){var d=r?(0,a.__assign)((0,a.__assign)({},t[o]),{selected:!i}):t[o];l&&l((0,a.__assign)((0,a.__assign)({},e),{target:n._dropDown.current}),d,o),c&&c(d,o)}},n._getPlaceholder=function(){return n.props.placeholder||n.props.placeHolder},n._getTitle=function(e,t){var o=n.props.multiSelectDelimiter,i=void 0===o?", ":o;return e.map((function(e){return e.text})).join(i)},n._onRenderTitle=function(e){return o.createElement(o.Fragment,null,n._getTitle(e))},n._onRenderPlaceholder=function(e){return n._getPlaceholder()?o.createElement(o.Fragment,null,n._getPlaceholder()):null},n._onRenderContainer=function(e){var t=e.calloutProps,i=e.panelProps,r=n.props,s=r.responsiveMode,l=r.dropdownWidth,c=s<=A.AR.medium,d={firstFocusableTarget:"#".concat(n._listId,"1")},u=n._classNames.subComponentStyles?n._classNames.subComponentStyles.panel:void 0,p=void 0,h=void 0;return"auto"===l?h=n._dropDown.current?n._dropDown.current.clientWidth:0:p=l||(n._dropDown.current?n._dropDown.current.clientWidth:0),c?o.createElement(I.Z,(0,a.__assign)({closeButtonAriaLabel:"Close",focusTrapZoneProps:d,hasCloseButton:!0,isOpen:!0,isLightDismiss:!0,onDismiss:n._onDismiss,styles:u},i),n._renderFocusableList(e)):o.createElement(C.P,(0,a.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:S.A.bottomLeftEdge,calloutWidth:p,calloutMinWidth:h},t,{className:n._classNames.callout,target:n._dropDown.current,onDismiss:n._onDismiss,onScroll:n._onScroll,onPositioned:n._onPositioned}),n._renderFocusableList(e))},n._onRenderCaretDown=function(e){return o.createElement(w.I,{className:n._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},n._onRenderList=function(e){var t=e.onRenderItem,i=void 0===t?n._onRenderItem:t,r={items:[]},s=[],l=function(){var e=r.id?[o.createElement("div",{role:"group",key:r.id,"aria-labelledby":r.id},r.items)]:r.items;s=(0,a.__spreadArray)((0,a.__spreadArray)([],s,!0),e,!0),r={items:[]}};return e.options.forEach((function(e,t){!function(e,t){switch(e.itemType){case D.W.Header:r.items.length>0&&l();var o=n._id+e.key;r.items.push(i((0,a.__assign)((0,a.__assign)({id:o},e),{index:t}),n._onRenderItem)),r.id=o;break;case D.W.Divider:t>0&&r.items.push(i((0,a.__assign)((0,a.__assign)({},e),{index:t}),n._onRenderItem)),r.items.length>0&&l();break;default:r.items.push(i((0,a.__assign)((0,a.__assign)({},e),{index:t}),n._onRenderItem))}}(e,t)})),r.items.length>0&&l(),o.createElement(o.Fragment,null,s)},n._onRenderItem=function(e){switch(e.itemType){case D.W.Divider:return n._renderSeparator(e);case D.W.Header:return n._renderHeader(e);default:return n._renderOption(e)}},n._renderOption=function(e){var t,i=n.props,r=i.onRenderOption,s=void 0===r?n._onRenderOption:r,l=i.hoisted.selectedIndices,c=void 0===l?[]:l,u=!(void 0===e.index||!c)&&c.indexOf(e.index)>-1,p=e.hidden?n._classNames.dropdownItemHidden:u&&!0===e.disabled?n._classNames.dropdownItemSelectedAndDisabled:u?n._classNames.dropdownItemSelected:!0===e.disabled?n._classNames.dropdownItemDisabled:n._classNames.dropdownItem,h=e.title,m=n._listId+e.index,g=null!==(t=e.id)&&void 0!==t?t:m+"-label",f=n._classNames.subComponentStyles?n._classNames.subComponentStyles.multiSelectItem:void 0;return n.props.multiSelect?o.createElement(L.S,{id:m,key:e.key,disabled:e.disabled,onChange:n._onItemClick(e),inputProps:(0,a.__assign)({"aria-selected":u,onMouseEnter:n._onItemMouseEnter.bind(n,e),onMouseLeave:n._onMouseItemLeave.bind(n,e),onMouseMove:n._onItemMouseMove.bind(n,e),role:"option"},{"data-index":e.index,"data-is-focusable":!(e.disabled||e.hidden)}),label:e.text,title:h,onRenderLabel:n._onRenderItemLabel.bind(n,(0,a.__assign)((0,a.__assign)({},e),{id:g})),className:(0,d.A)(p,"is-multi-select"),checked:u,styles:f,ariaPositionInSet:e.hidden?void 0:n._sizePosCache.positionInSet(e.index),ariaSetSize:e.hidden?void 0:n._sizePosCache.optionSetSize,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:g}):o.createElement(k.c,{id:m,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:p,onClick:n._onItemClick(e),onMouseEnter:n._onItemMouseEnter.bind(n,e),onMouseLeave:n._onMouseItemLeave.bind(n,e),onMouseMove:n._onItemMouseMove.bind(n,e),role:"option","aria-selected":u?"true":"false",ariaLabel:e.ariaLabel,title:h,"aria-posinset":n._sizePosCache.positionInSet(e.index),"aria-setsize":n._sizePosCache.optionSetSize},s(e,n._onRenderOption))},n._onRenderOption=function(e){return o.createElement("span",{className:n._classNames.dropdownOptionText},e.text)},n._onRenderMultiselectOption=function(e){return o.createElement("span",{id:e.id,"aria-hidden":"true",className:n._classNames.dropdownOptionText},e.text)},n._onRenderItemLabel=function(e){var t=n.props.onRenderOption;return(void 0===t?n._onRenderMultiselectOption:t)(e,n._onRenderMultiselectOption)},n._onPositioned=function(e){n._focusZone.current&&n._requestAnimationFrame((function(){var e=n.props.hoisted.selectedIndices;if(n._focusZone.current)if(!n._hasBeenPositioned&&e&&e[0]&&!n.props.options[e[0]].disabled){var t=(0,u.Y)().getElementById("".concat(n._id,"-list").concat(e[0]));t&&n._focusZone.current.focusElement(t),n._hasBeenPositioned=!0}else n._focusZone.current.focus()})),n.state.calloutRenderEdge&&n.state.calloutRenderEdge===e.targetEdge||n.setState({calloutRenderEdge:e.targetEdge})},n._onItemClick=function(e){return function(t){e.disabled||(n.setSelectedIndex(t,e.index),n.props.multiSelect||n.setState({isOpen:!1}))}},n._onScroll=function(){var e=(0,F.k_)(n.context);n._isScrollIdle||void 0===n._scrollIdleTimeoutId?n._isScrollIdle=!1:(e.clearTimeout(n._scrollIdleTimeoutId),n._scrollIdleTimeoutId=void 0),n._scrollIdleTimeoutId=e.setTimeout((function(){n._isScrollIdle=!0}),n._scrollIdleDelay)},n._onMouseItemLeave=function(e,t){if(!n._shouldIgnoreMouseEvent()&&n._host.current)if(n._host.current.setActive)try{n._host.current.setActive()}catch(o){}else n._host.current.focus()},n._onDismiss=function(){n.setState({isOpen:!1})},n._onDropdownBlur=function(e){n._isDisabled()||n.state.isOpen||(n.setState({hasFocus:!1}),n.props.onBlur&&n.props.onBlur(e))},n._onDropdownKeyDown=function(e){if(!n._isDisabled()&&(n._lastKeyDownWasAltOrMeta=n._isAltOrMeta(e),!n.props.onKeyDown||(n.props.onKeyDown(e),!e.defaultPrevented))){var t,o=n.props.hoisted.selectedIndices.length?n.props.hoisted.selectedIndices[0]:-1,i=e.altKey||e.metaKey,r=n.state.isOpen;switch(e.which){case p.c.enter:n.setState({isOpen:!r});break;case p.c.escape:if(!r)return;n.setState({isOpen:!1});break;case p.c.up:if(i){if(r){n.setState({isOpen:!1});break}return}n.props.multiSelect?n.setState({isOpen:!0}):n._isDisabled()||(t=n._moveIndex(e,-1,o-1,o));break;case p.c.down:i&&(e.stopPropagation(),e.preventDefault()),i&&!r||n.props.multiSelect?n.setState({isOpen:!0}):n._isDisabled()||(t=n._moveIndex(e,1,o+1,o));break;case p.c.home:n.props.multiSelect||(t=n._moveIndex(e,1,0,o));break;case p.c.end:n.props.multiSelect||(t=n._moveIndex(e,-1,n.props.options.length-1,o));break;case p.c.space:break;default:return}t!==o&&(e.stopPropagation(),e.preventDefault())}},n._onDropdownKeyUp=function(e){if(!n._isDisabled()){var t=n._shouldHandleKeyUp(e),o=n.state.isOpen;n.props.onKeyUp&&(n.props.onKeyUp(e),e.defaultPrevented)||(e.which===p.c.space?(n.setState({isOpen:!o}),e.stopPropagation(),e.preventDefault()):t&&o&&n.setState({isOpen:!1}))}},n._onZoneKeyDown=function(e){var t,o,i;n._lastKeyDownWasAltOrMeta=n._isAltOrMeta(e);var r=e.altKey||e.metaKey;switch(e.which){case p.c.up:r?n.setState({isOpen:!1}):n._host.current&&(i=(0,h.dm)(n._host.current,n._host.current.lastChild,!0));break;case p.c.home:case p.c.end:case p.c.pageUp:case p.c.pageDown:break;case p.c.down:!r&&n._host.current&&(i=(0,h.j5)(n._host.current,n._host.current.firstChild,!0));break;case p.c.escape:n.setState({isOpen:!1});break;case p.c.tab:n.setState({isOpen:!1});var a=(0,u.Y)();a&&(e.shiftKey?null===(t=(0,h.yv)(a.body,n._dropDown.current,!1,!1,!0,!0))||void 0===t||t.focus():null===(o=(0,h.eX)(a.body,n._dropDown.current,!1,!1,!0,!0))||void 0===o||o.focus());break;default:return}i&&i.focus(),e.stopPropagation(),e.preventDefault()},n._onZoneKeyUp=function(e){n._shouldHandleKeyUp(e)&&n.state.isOpen&&(n.setState({isOpen:!1}),e.preventDefault())},n._onDropdownClick=function(e){if(!n.props.onClick||(n.props.onClick(e),!e.defaultPrevented)){var t=n.state.isOpen;n._isDisabled()||n._shouldOpenOnFocus()||n.setState({isOpen:!t}),n._isFocusedByClick=!1}},n._onDropdownMouseDown=function(){n._isFocusedByClick=!0},n._onFocus=function(e){if(!n._isDisabled()){n.props.onFocus&&n.props.onFocus(e);var t={hasFocus:!0};n._shouldOpenOnFocus()&&(t.isOpen=!0),n.setState(t)}},n._isDisabled=function(){var e=n.props.disabled,t=n.props.isDisabled;return void 0===e&&(e=t),e},n._onRenderLabel=function(e){var t=e.label,i=e.required,r=e.disabled,a=n._classNames.subComponentStyles?n._classNames.subComponentStyles.label:void 0;return t?o.createElement(_.J,{className:n._classNames.label,id:n._labelId,required:i,styles:a,disabled:r},t):null},(0,m.f)(n);t.multiSelect,t.selectedKey,t.selectedKeys,t.defaultSelectedKey,t.defaultSelectedKeys;var i=t.options;return n._id=t.id||(0,g.O)("Dropdown"),n._labelId=n._id+"-label",n._listId=n._id+"-list",n._optionId=n._id+"-option",n._isScrollIdle=!0,n._hasBeenPositioned=!1,n._sizePosCache.updateOptions(i),n.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},n}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props,t=e.options,n=e.hoisted.selectedIndices;return(0,R.D)(t,n)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},t.prototype.componentDidUpdate=function(e,t){!0===t.isOpen&&!1===this.state.isOpen&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},t.prototype.render=function(){var e=this._id,t=this.props,n=t.className,i=t.label,r=t.options,s=t.ariaLabel,l=t.required,c=t.errorMessage,d=t.styles,u=t.theme,p=t.panelProps,h=t.calloutProps,m=t.onRenderTitle,g=void 0===m?this._getTitle:m,b=t.onRenderContainer,y=void 0===b?this._onRenderContainer:b,C=t.onRenderCaretDown,S=void 0===C?this._onRenderCaretDown:C,k=t.onRenderLabel,D=void 0===k?this._onRenderLabel:k,x=t.onRenderItem,T=void 0===x?this._onRenderItem:x,E=t.hoisted.selectedIndices,w=this.state,_=w.isOpen,I=w.calloutRenderEdge,P=w.hasFocus,A=t.onRenderPlaceholder||t.onRenderPlaceHolder||this._getPlaceholder;r!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(r);var L=(0,R.D)(r,E),N=(0,f.G1)(t,f.JM),M=this._isDisabled(),O=e+"-errorMessage";this._classNames=j(d,{theme:u,className:n,hasError:!!(c&&c.length>0),hasLabel:!!i,isOpen:_,required:l,disabled:M,isRenderingPlaceholder:!L.length,panelClassName:p?p.className:void 0,calloutClassName:h?h.className:void 0,calloutRenderEdge:I});var B=!!c&&c.length>0;return o.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":_?this._listId:void 0},D(this.props,this._onRenderLabel),o.createElement("div",(0,a.__assign)({"data-is-focusable":!M,"data-ktp-target":!0,ref:this._dropDown,id:e,tabIndex:M?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":_?"true":"false","aria-label":s,"aria-labelledby":i&&!s?(0,v._)(this._labelId,this._optionId):void 0,"aria-describedby":B?this._id+"-errorMessage":void 0,"aria-required":l,"aria-disabled":M,"aria-controls":_?this._listId:void 0},N,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),o.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":P?"polite":void 0,"aria-atomic":!!P||void 0,"aria-invalid":B},L.length?g(L,this._onRenderTitle):A(t,this._onRenderPlaceholder)),o.createElement("span",{className:this._classNames.caretDownWrapper},S(t,this._onRenderCaretDown))),_&&y((0,a.__assign)((0,a.__assign)({},t),{onDismiss:this._onDismiss,onRenderItem:T}),this._onRenderContainer),B&&o.createElement("div",{role:"alert",id:O,className:this._classNames.errorMessage},c))},t.prototype.focus=function(e){this._dropDown.current&&(this._dropDown.current.focus(),e&&this.setState({isOpen:!0}))},t.prototype.setSelectedIndex=function(e,t){var n=this.props,o=n.options,i=n.selectedKey,r=n.selectedKeys,a=n.multiSelect,s=n.notifyOnReselect,l=n.hoisted.selectedIndices,c=void 0===l?[]:l,d=!!c&&c.indexOf(t)>-1,u=[];if(t=Math.max(0,Math.min(o.length-1,t)),void 0===i&&void 0===r){if(a||s||t!==c[0]){if(a)if(u=c?this._copyArray(c):[],d){var p=u.indexOf(t);p>-1&&u.splice(p,1)}else u.push(t);else u=[t];e.persist(),this.props.hoisted.setSelectedIndices(u),this._onChange(e,o,t,d,a)}}else this._onChange(e,o,t,d,a)},t.prototype._copyArray=function(e){for(var t=[],n=0,o=e;n<o.length;n++){var i=o[n];t.push(i)}return t},t.prototype._moveIndex=function(e,t,n,o){var i=this.props.options;if(o===n||0===i.length)return o;n>=i.length?n=0:n<0&&(n=i.length-1);for(var r=0;i[n].itemType===D.W.Header||i[n].itemType===D.W.Divider||i[n].disabled;){if(r>=i.length)return o;n+t<0?n=i.length:n+t>=i.length&&(n=-1),n+=t,r++}return this.setSelectedIndex(e,n),n},t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,i=e.label,r=e.ariaLabel,a=e.multiSelect;return o.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},o.createElement(T.R,{ref:this._focusZone,direction:E.E.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":r,"aria-labelledby":i&&!r?this._labelId:void 0,"aria-multiselectable":a},n(e,this._onRenderList)))},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key,i=e.hidden?this._classNames.dropdownDividerHidden:this._classNames.dropdownDivider;return t>0?o.createElement("div",{role:"presentation",key:n,className:i}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,i=e.key,r=e.id,a=e.hidden?this._classNames.dropdownItemHeaderHidden:this._classNames.dropdownItemHeader;return o.createElement("div",{id:r,key:i,className:a},n(e,this._onRenderOption))},t.prototype._onItemMouseEnter=function(e,t){this._shouldIgnoreMouseEvent()||t.currentTarget.focus()},t.prototype._onItemMouseMove=function(e,t){var n=(0,F.LW)(this.context),o=t.currentTarget;this._gotMouseMove=!0,this._isScrollIdle&&n.activeElement!==o&&o.focus()},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._isAltOrMeta=function(e){return e.which===p.c.alt||"Meta"===e.key},t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);return this._lastKeyDownWasAltOrMeta=!1,!!t&&!((0,b.c)()||(0,y.u)())},t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e},t.defaultProps={options:[]},t.contextType=B._0,t}(o.Component),Z=n(42815),Y=n(21979),X=n(33516),$={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},J=((U={})["".concat(X.up,", ").concat(X.hT.replace("@media ",""))]=(0,a.__assign)({},(0,X.Qg)()),U),Q={selectors:(0,a.__assign)((W={},W[X.up]=(K={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},K[".".concat(Z.Y2," &:focus:after")]={borderColor:"HighlightText"},K),W[".ms-Checkbox-checkbox"]=(G={},G[X.up]={borderColor:"HighlightText"},G),W),J)},ee={selectors:(q={},q[X.up]={borderColor:"Highlight"},q)},te=(0,X.L6)(0,X.O7),ne=(0,r.I)(z,(function(e){var t,n,o,i,r,s,l,c,d,u,p,h,m=e.theme,g=e.hasError,f=e.hasLabel,v=e.className,b=e.isOpen,y=e.disabled,C=e.required,S=e.isRenderingPlaceholder,k=e.panelClassName,D=e.calloutClassName,x=e.calloutRenderEdge;if(!m)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var T=(0,X.Km)($,m),E=m.palette,w=m.semanticColors,_=m.effects,I=m.fonts,P={color:w.menuItemTextHovered},A={color:w.menuItemText},R={borderColor:w.errorText},L=[T.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],N=[T.dropdownItemHeader,(0,a.__assign)((0,a.__assign)({},I.medium),{fontWeight:X.BO.semibold,color:w.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(t={},t[X.up]=(0,a.__assign)({color:"GrayText"},(0,X.Qg)()),t)})],M=w.menuItemBackgroundPressed,O=function(e){var t,n;return void 0===e&&(e=!1),{selectors:(t={"&:hover":[{color:w.menuItemTextHovered,backgroundColor:e?M:w.menuItemBackgroundHovered},Q],"&.is-multi-select:hover":[{backgroundColor:e?M:"transparent"},Q],"&:active:hover":[{color:w.menuItemTextHovered,backgroundColor:e?w.menuItemBackgroundHovered:w.menuItemBackgroundPressed},Q]},t[".".concat(Z.Y2," &:focus:after")]=(n={left:0,top:0,bottom:0,right:0},n[X.up]={inset:"2px"},n),t[X.up]={border:"none"},t)}},B=(0,a.__spreadArray)((0,a.__spreadArray)([],L,!0),[{backgroundColor:M,color:w.menuItemTextHovered},O(!0),Q],!1),F=(0,a.__spreadArray)((0,a.__spreadArray)([],L,!0),[{color:w.disabledText,cursor:"default",selectors:(n={},n[X.up]={color:"GrayText",border:"none"},n)}],!1),j=x===Y.x.bottom?"".concat(_.roundedCorner2," ").concat(_.roundedCorner2," 0 0"):"0 0 ".concat(_.roundedCorner2," ").concat(_.roundedCorner2),H=x===Y.x.bottom?"0 0 ".concat(_.roundedCorner2," ").concat(_.roundedCorner2):"".concat(_.roundedCorner2," ").concat(_.roundedCorner2," 0 0");return{root:[T.root,v],label:T.label,dropdown:[T.dropdown,X.S8,I.medium,{color:w.menuItemText,borderColor:w.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(o={},o["&:hover ."+T.title]=[!y&&P,{borderColor:b?E.neutralSecondary:E.neutralPrimary},ee],o["&:focus ."+T.title]=[!y&&P,{selectors:(i={},i[X.up]={color:"Highlight"},i)}],o["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:y?"none":"2px solid ".concat(E.themePrimary),borderRadius:"2px",selectors:(r={},r[X.up]={color:"Highlight"},r)}],o["&:active ."+T.title]=[!y&&P,{borderColor:E.themePrimary},ee],o["&:hover ."+T.caretDown]=!y&&A,o["&:focus ."+T.caretDown]=[!y&&A,{selectors:(s={},s[X.up]={color:"Highlight"},s)}],o["&:active ."+T.caretDown]=!y&&A,o["&:hover ."+T.titleIsPlaceHolder]=!y&&A,o["&:focus ."+T.titleIsPlaceHolder]=!y&&A,o["&:active ."+T.titleIsPlaceHolder]=!y&&A,o["&:hover ."+T.titleHasError]=R,o["&:active ."+T.titleHasError]=R,o)},b&&"is-open",y&&"is-disabled",C&&"is-required",C&&!f&&{selectors:(l={":before":{content:"'*'",color:w.errorText,position:"absolute",top:-5,right:-10}},l[X.up]={selectors:{":after":{right:-14}}},l)}],title:[T.title,X.S8,{backgroundColor:w.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:w.inputBorder,borderRadius:b?j:_.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},S&&[T.titleIsPlaceHolder,{color:w.inputPlaceholderText}],g&&[T.titleHasError,R],y&&{backgroundColor:w.disabledBackground,border:"none",color:w.disabledText,cursor:"default",selectors:(c={},c[X.up]=(0,a.__assign)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},(0,X.Qg)()),c)}],caretDownWrapper:[T.caretDownWrapper,{height:32,lineHeight:30,paddingTop:1,position:"absolute",right:8,top:0},!y&&{cursor:"pointer"}],caretDown:[T.caretDown,{color:E.neutralSecondary,fontSize:I.small.fontSize,pointerEvents:"none"},y&&{color:w.disabledText,selectors:(d={},d[X.up]=(0,a.__assign)({color:"GrayText"},(0,X.Qg)()),d)}],errorMessage:(0,a.__assign)((0,a.__assign)({color:w.errorText},m.fonts.small),{paddingTop:5}),callout:[T.callout,{boxShadow:_.elevation8,borderRadius:H,selectors:(u={},u[".ms-Callout-main"]={borderRadius:H},u)},D],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[T.dropdownItems,{display:"block"}],dropdownItem:(0,a.__spreadArray)((0,a.__spreadArray)([],L,!0),[O()],!1),dropdownItemSelected:B,dropdownItemDisabled:F,dropdownItemSelectedAndDisabled:[B,F,{backgroundColor:"transparent"}],dropdownItemHidden:(0,a.__spreadArray)((0,a.__spreadArray)([],L,!0),[{display:"none"}],!1),dropdownDivider:[T.dropdownDivider,{height:1,backgroundColor:w.bodyDivider}],dropdownDividerHidden:[T.dropdownDivider,{display:"none"}],dropdownOptionText:[T.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:N,dropdownItemHeaderHidden:(0,a.__spreadArray)((0,a.__spreadArray)([],N,!0),[{display:"none"}],!1),subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(p={},p[".".concat(Z.Y2," &:focus + label::before")]={outlineOffset:"0px"},p)}},panel:{root:[k],main:{selectors:(h={},h[te]={width:272},h)},contentInner:{padding:"0 0 20px"}}}}}),void 0,{scope:"Dropdown"});ne.displayName="Dropdown";var oe=n(66783),ie=n(66151),re=n(72943),ae=n(77508),se=n(56415),le=n(8736),ce=n(40729);const de=(0,oe.J9)(((e,t,n)=>o=>(0,X.pB)(o,ue(e,t),n))),ue=(0,oe.J9)(((e,t,n)=>{const o=ce.d.isLoopTheme(e);let i="",r="",a="",s=le.B.PlannerBorderRadius;switch(e){case ae.Sx.Light:case ae.Sx.TeamsLight:a=se.z.NeutralDark,i="1px",r="3px";break;case ae.Sx.Dark:case ae.Sx.TeamsDark:a=se.z.NeutralLight,i="1px",r="3px";break;case ae.Sx.TeamsContrast:a=se.z.TeamsContrastHyperlinkColor,i="1px",r="3px";break;case ae.Sx.LoopLight:case ae.Sx.LoopDark:s=le.B.LoopBorderRadius;case ae.Sx.SharePoint:}const l=(0,ie.Ml)(e),c=[(0,ie.aS)(e),o?(0,ie.Nc)(e):(0,ie.nK)(e),{height:le.B.PlannerInputHeight,"> *":{backgroundColor:"transparent"},"&.is-open":(0,ie.oO)(e),"&:focus, &:hover":{".ms-Dropdown-title":(0,ie.aS)(e),".ms-Dropdown-caretDown":{color:a}},"&:active":{".ms-Dropdown-title":(0,ie.aS)(e)},"&:focus::after":{border:"none",position:"inherit"}},t&&{"&:hover, &:focus, &:hover:focus":{".ms-Dropdown-title, .ms-Dropdown-caretDown":(0,ie.$4)(e)}},!t&&{"&:focus":[(0,ie.oO)(e),e===ae.Sx.SharePoint&&{"> .ms-Dropdown-title":{border:"1px solid "+se.z.BorderColorNeutralTertiary}}]}],d=[t?(0,ie.$4)(e):(0,ie.aS)(e),{backgroundColor:"transparent",border:"0px solid transparent",borderRadius:r,paddingTop:i}],u=[(0,ie.gS)(),ie.cc],p=[(0,ie.NX)(e),(0,ie.aS)(e),{border:"1px solid transparent","&:focus, &:hover, &:hover:focus":[(0,ie.aS)(e),(0,ie.Mi)(e),(0,re._Z)(),{".icon span":(0,re._Z)()}],".ms-Button-flexContainer":{width:"100%"}}],h=[(0,ie.D1)(e),(0,ie.aS)(e),{border:"1px solid transparent","&:focus, &:hover, &:hover:focus":[(0,ie.aS)(e),(0,ie.Mi)(e),e===ae.Sx.TeamsContrast&&{".ms-Icon":{color:se.z.Black}}],".ms-Button-flexContainer":{width:"100%"},".plannerIcon > span":(0,re.h8)()},e===ae.Sx.TeamsContrast&&{color:se.z.Black,".ms-Icon":{color:se.z.Black}},e===ae.Sx.SharePoint&&{backgroundColor:se.z.SharepointAddTaskButtonBackgroundColor(),color:se.z.SharepointTitleFontColor(),".ms-Dropdown-optionText":{color:se.z.SharepointTitleFontColor()}}],m=[(0,ie.NX)(e),{borderTop:"1px solid transparent"}],g={borderRadius:s,".ms-Callout-main":[{borderRadius:s},e===ae.Sx.TeamsContrast&&{backgroundColor:se.z.Black}]};return(0,X.TW)({label:l,dropdown:c,title:d,caretDownWrapper:u,dropdownItem:p,dropdownItemSelected:h,dropdownItems:m,callout:g},n)})),pe=(0,oe.J9)(((e,t)=>({root:[t?(0,ie.$4)(e):(0,ie.Ml)(e)]})));var he=n(74527);class me extends i.${name(){return"Dropdown"}renderComponent(){var e;const{children:t,...n}={...this.props,styles:this.props.isDefaultView?{}:de(this.props.appTheme,this.props.disabled,this.props.styles),calloutProps:{...this.props.calloutProps,className:(0,d.A)("plannerAppCallout",null===(e=this.props.calloutProps)||void 0===e?void 0:e.className)},onRenderCaretDown:this.onRenderCaretDown};return o.createElement(ne,n,t)}constructor(e,t){super(e,t),this.onRenderCaretDown=()=>o.createElement(w.I,{...he.Ju,styles:pe(this.props.appTheme,this.props.disabled)})}}},2880:(e,t,n)=>{"use strict";n.d(t,{n:()=>s});var o=n(65043),i=n(42463),r=n(93589),a=n(74527);const s=e=>{let t=a.UU;if(null!=e.messageBarType)switch(e.messageBarType){case i.H.success:t=a.p$;break;case i.H.error:t=a.mU;break;case i.H.blocked:t=a.Ex;break;case i.H.severeWarning:t=a.td;break;case i.H.info:case i.H.warning:default:t=a.UU}return o.createElement(r.n,{dismissIconProps:a.s5,messageBarIconProps:t,...e})}},34525:(e,t,n)=>{"use strict";n.d(t,{h:()=>L});var o=n(16112),i=n(65043),r=n(51948),a=n(50724),s=n(98571),l=n(10859),c=n(94299),d=n(20751),u=n(23830),p=n(6017),h=n(66783),m=n(48709),g=n(33516),f=n(66151),v=n(56415);const b="28px",y="10px",C="28px",S="16px",k=(0,h.J9)(((e,t)=>{const n=[(0,f.gS)("column"),{justifyContent:"space-between",overflow:"hidden"}],o=[(0,f.GD)(),(0,f.gS)(),{alignItems:"center",justifyContent:"space-between"}],i=[(0,f.$Z)("272px"),(0,f.gS)("column"),{backgroundColor:v.z.NeutralLighterAlt,border:"solid 1px ".concat(v.z.NeutralQuaternaryAlt),borderRadius:"2px",boxSizing:"border-box",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",height:"48px",maxWidth:"100%",":hover":{backgroundColor:v.z.NeutralLighter}}],r=[(0,f.gS)(),(0,f.GD)(),{alignItems:"center","> *":{margin:"0px ".concat(y)}},e.unclickable&&{borderBottom:"solid 2px ".concat(v.z.DarkRed)}],a=[(0,f.$Z)(b),(0,f.gS)(),f.cc,{cursor:e.unclickable?"default":"pointer",height:b,margin:"0px ".concat(y)},e.uploading&&{"> .documentPreviewIcon":{color:v.z.NeutralSecondary}}],s=[(0,f.$Z)(b),{fontSize:C,"&.link > .ms-Image > img":[(0,f.$Z)(C),{height:C,width:C}],"&.thumbnailImage > .ms-Image > img":[(0,f.$Z)(),{height:b,width:b}]}],l=[(0,f.GD)(),(0,f.gS)("column"),{cursor:e.unclickable?"default":"pointer"}],c=[(0,f.$Z)("20px"),(0,f.q0)()],d={fontSize:"14px",color:e.uploading?v.z.NeutralSecondary:m.kd.gray180},u=[(0,f.$Z)("16px"),(0,f.q0)()],p={color:e.uploading?v.z.NeutralSecondary:m.kd.gray140,fontSize:"12px"},h=[(0,f.$Z)(),(0,f.gS)(),f.cc,f.$u,{cursor:"pointer","> *":[(0,f.$Z)(),(0,f.gS)(),f.cc]},e.uploading&&{display:"none"}],k=[f.xK,(0,f.gS)(),f.cc,f.$u,{cursor:"pointer"},e.uploading&&{display:"none"}],D=[f.xK,(0,f.gS)(),f.cc,{cursor:"pointer"}],x={root:[(0,f.$Z)("2px"),e.uploading&&{opacity:1}],itemName:{display:"none"},itemProgress:{padding:"0px"}},T={root:[(0,f.gS)(),{alignSelf:"center",padding:"2px ".concat(y," 0px ").concat(y),opacity:1},e.uploading&&{display:"none"}],checkbox:{borderRadius:"3px",height:S,width:S},label:{alignItems:"center"}},E={root:n,content:o,leftContent:i,attachmentChicklet:r,previewListImage:a,itemListTitleContainer:l,itemListTitle:c,itemListTitleText:d,itemListUrl:u,itemListUrlText:p,otherCommands:h,attachmentMoreButton:D,brokenLinkIcon:[f.$u,{margin:"2px 0px 0px 0px",cursor:"default",color:v.z.DarkRed}],fallbackPreviewIcon:s,actionButton:k,subComponentStyles:{uploadProgress:x,showOnCard:T}};return(0,g.pB)(e,E,t)})),D=(0,h.J9)((e=>({root:(0,g.Zq)("taskAttachmentRow",e.root),content:(0,g.Zq)("content",e.content),leftContent:(0,g.Zq)("leftContent",e.leftContent),attachmentChicklet:(0,g.Zq)("attachmentChicklet",e.attachmentChicklet),previewListImage:(0,g.Zq)("preview-list-image",e.previewListImage),itemListTitleContainer:(0,g.Zq)("item-list-title-container",e.itemListTitleContainer),itemListTitle:(0,g.Zq)("item-list-title",e.itemListTitle),itemListTitleText:(0,g.Zq)("item-list-title-text",e.itemListTitleText),itemListUrl:(0,g.Zq)("item-list-url",e.itemListUrl),itemListUrlText:(0,g.Zq)("item-list-url-text",e.itemListUrlText),otherCommands:(0,g.Zq)("other-commands",e.otherCommands),attachmentMoreButton:(0,g.Zq)("attachmentMoreButton",e.attachmentMoreButton),brokenLinkIcon:(0,g.Zq)("broken-link-icon",e.brokenLinkIcon),fallbackPreviewIcon:(0,g.Zq)("fallbackPreviewIcon",e.fallbackPreviewIcon),actionButton:(0,g.Zq)("actionButton",e.actionButton)})));var x=n(4648),T=n(80493),E=n(60601);class w extends o.${name(){return"TaskAttachmentRow"}renderComponent(){const e=this.getClassNames(),{taskAttachmentRowItem:t,taskAttachmentRowStrings:n,documentPreviewIcons:o,config:r}=this.props,a=t.isUrlValid(),s=i.createElement(l.$,{key:t.url,taskAttachmentRowItem:t,className:e.fallbackPreviewIcon,icons:o}),c=a?t.alias:"".concat(t.alias,". ").concat(n.invalidLinkError);return i.createElement("li",{className:e.root,key:"taskAttachmentRow"+t.url},i.createElement("div",{className:e.content},i.createElement("div",{className:e.leftContent},i.createElement("div",{className:e.attachmentChicklet},i.createElement("div",{className:e.previewListImage,tabIndex:0,role:"link","aria-label":c,onKeyDown:this.onKeyDown,onClick:this.openAttachment,ref:this.resolveRef(this,"taskAttachmentIcon")},s),i.createElement("div",{className:e.itemListTitleContainer,onClick:this.openAttachment},i.createElement("div",{className:e.itemListTitle,title:t.alias},i.createElement("span",{className:e.itemListTitleText,title:t.alias},t.alias)),i.createElement("div",{className:e.itemListUrl,title:t.url},i.createElement("span",{className:e.itemListUrlText,title:t.url},t.url))),!a&&this.renderInvalidLinkIcon(),!r.disableActionButton&&i.createElement("div",null,this.renderActionButton()),i.createElement("div",{className:e.otherCommands},this.renderMoreOptions(),this.renderMoreContextMenu())),this.renderProgressIndicator()),this.renderShowOnCard()))}renderProgressIndicator(){const e=this.getStyles(),{taskAttachmentRowItem:t}=this.props;return t.isBeingUploaded?i.createElement(c.Z,{styles:e.subComponentStyles.uploadProgress,percentComplete:t.uploadProgress}):null}renderInvalidLinkIcon(){const e=this.getClassNames(),{taskAttachmentRowStrings:t,icons:n}=this.props;return i.createElement("span",{className:e.brokenLinkIcon,title:t.invalidLinkError},i.createElement(d.I,{iconName:"AlertSolid",...null===n||void 0===n?void 0:n.alert}))}renderActionButton(){const e=this.getClassNames(),{taskAttachmentRowItem:t,taskAttachmentRowStrings:n}=this.props;return t.isBeingUploaded?null:i.createElement("button",{className:e.actionButton,onClick:this.openAttachment,"aria-label":n.actionButtonLabel,ref:this.props.actionButtonRef},n.actionButtonLabel)}renderMoreOptions(){const e=this.getClassNames(),{taskAttachmentRowItem:t,taskAttachmentRowStrings:n,icons:o,config:r}=this.props;return t.isBeingUploaded||r.hideMoreButton?null:i.createElement("button",{className:e.attachmentMoreButton,onClick:this.showPreviewCommand,"aria-label":n.moreOptionsAriaLabel,"aria-haspopup":!0,ref:this.resolveRef(this,"taskAttachmentMenuButton")},i.createElement(d.I,{iconName:"More",...null===o||void 0===o?void 0:o.more}))}renderShowOnCard(){const e=this.getStyles(),{callbacks:t,config:n,taskAttachmentRowItem:o,taskAttachmentRowStrings:r}=this.props;if(n.hideShowOnCardButton)return null;const a=(0,x.A)({visible:o.isShownInTaskCard}),s=r.showOnCardAriaLabel(o.alias);return i.createElement(u.S,{className:a,styles:e.subComponentStyles.showOnCard,checked:o.isShownInTaskCard,label:r.showOnCardLabel,onChange:(e,n)=>{t.onSelectDeselectShowOnCard(!!n)},ariaLabel:s,disabled:n.disableEdit})}renderMoreContextMenu(){const e=this.getStyles(),{callbacks:t,config:n,taskAttachmentRowStrings:o,icons:a}=this.props;if(!this.state.isMoreMenuVisible)return null;const l=[];return n.hideOpenInNewWindow||l.push({key:"OpenInNewWindow",name:o.openInNewWindowMenuOption,onClick:this.onOpenInNewWindow}),n.disableCopyLink||l.push({key:"CopyLink",name:o.copyLinkOption,onClick:this.copyAttachmentLink,iconProps:{iconName:r.F.Copy,...null===a||void 0===a?void 0:a.copy}}),l.push({key:"Edit",name:o.editMenuOption,onClick:this.onEditTaskAttachment,disabled:n.disableEdit,iconProps:{iconName:r.F.Edit,...null===a||void 0===a?void 0:a.edit}}),l.push({key:"Remove",name:o.removeMenuOption,onClick:t.onDelete,disabled:n.disableRemove,iconProps:{iconName:r.F.Delete,...null===a||void 0===a?void 0:a.remove}}),i.createElement(s.l,{shouldFocusOnMount:!0,items:l,directionalHint:p.A.bottomAutoEdge,target:this.taskAttachmentMenuButton,onDismiss:this.closeAttachmentMenu,styles:e.subComponentStyles.contextualMenu,appTheme:this.props.theme})}openAttachmentMenu(){this.setState({isMoreMenuVisible:!0})}getClassNames(){return D(this.getStyles())}getStyles(){const{styles:e,taskAttachmentRowItem:t}=this.props,n=t.isBeingUploaded,o=!t.isUrlValid(),i=this.getStyleProps(n,o);return k(i,e)}constructor(e,t){super(e,t),this.openAttachment=()=>{const{callbacks:e,taskAttachmentRowItem:t}=this.props;!t.isBeingUploaded&&t.isUrlValid()&&e.onOpenLink(t)},this.copyAttachmentLink=e=>{const{callbacks:t,taskAttachmentRowItem:n}=this.props;t.onCopyLink(n)},this.closeAttachmentMenu=()=>{this.setState({isMoreMenuVisible:!1})},this.onOpenInNewWindow=e=>{const{taskAttachmentRowItem:t}=this.props;!t.isBeingUploaded&&t.isUrlValid()&&T.b.safelyOpenExternalUrl(t.url)},this.onEditTaskAttachment=e=>{this.props.callbacks.onEdit()},this.onKeyDown=e=>{const t=E.$.getKey(e);t!==a.D.ENTER&&t!==a.D.SPACE||this.openAttachment()},this.showPreviewCommand=e=>{e.stopPropagation(),this.openAttachmentMenu()},this.getStyleProps=(0,h.J9)(((e,t)=>({uploading:e,unclickable:t}))),this.state={isMoreMenuVisible:!1}}}const _=(0,h.J9)((e=>(0,g.pB)(void 0,e))),I=(0,h.J9)((e=>({root:(0,g.Zq)("taskAttachmentList",e.root)})));var P=n(33411),A=n.n(P),R=n(27559);class L extends o.${name(){return"TaskAttachmentList"}componentDidUpdate(e,t){null!=e.taskAttachmentToEditIndex&&e.isTaskAttachmentBeingEdited&&e.taskAttachmentToEditIndex>=0&&this._attachmentMenuElements[e.taskAttachmentToEditIndex]&&this._attachmentMenuElements[e.taskAttachmentToEditIndex].element.focus()}renderComponent(){const e=this.getClassNames(),t=this.getStyles(),{taskAttachmentRowItems:n,taskAttachmentRowStrings:o,taskAttachmentRowIcons:r,documentPreviewIcons:a,addedAttachmentId:s}=this.props,{onEditTaskAttachment:l,onSelectDeselectShowOnCard:c,onOpenLink:d,onCopyLink:u}=this.props.callbacks,{hideShowOnCardButton:p,hideOpenInNewWindow:h,disableEdit:m,disableRemove:g,disableCopyLink:f,disableActionButton:v,hideMoreButton:b}=this.props.rowConfig;return this._attachmentElements=[],this._attachmentMenuElements=[],i.createElement("div",{className:e.root},i.createElement("ul",null,A()(n,(e=>{var n;const y={onDelete:()=>this.onDeleteAttachment(e),onEdit:()=>l(e),onSelectDeselectShowOnCard:t=>c(e,t),onOpenLink:d,onCopyLink:u},C={hideShowOnCardButton:p,hideOpenInNewWindow:h,disableEdit:m,disableRemove:g,disableCopyLink:f,disableActionButton:v,hideMoreButton:b},S=e.id===s?this.props.addedAttachmentButtonRef:void 0;return i.createElement(w,{key:e.url,taskAttachmentRowItem:e,callbacks:y,ref:t=>{t&&(t.taskAttachmentIcon&&this._attachmentElements.push({element:t.taskAttachmentIcon,id:e.url}),t.taskAttachmentMenuButton&&this._attachmentMenuElements.push({element:t.taskAttachmentMenuButton,id:e.url}))},config:C,taskAttachmentRowStrings:o,styles:null===(n=t.subComponentStyles)||void 0===n?void 0:n.row,icons:r,documentPreviewIcons:a,theme:this.props.theme,actionButtonRef:S})}))))}onDeleteAttachment(e){null!=this.props.altFocusableElement&&R.n.ChangeFocusBeforeRemovalIFocusable(this._attachmentElements,this.props.altFocusableElement,e.url),this.props.callbacks.onDeleteTaskAttachment(e)}getClassNames(){return I(this.getStyles())}getStyles(){const{styles:e}=this.props;return _(e)}constructor(e,t){super(e,t)}}},4705:(e,t,n)=>{"use strict";n.d(t,{$f:()=>k,EJ:()=>D,Zz:()=>w,oQ:()=>S,qw:()=>E,uI:()=>x});var o=n(53815),i=n(48709),r=n(56415),a=n(77508),s=n(66783),l=n(33516),c=n(72943),d=n(66151),u=n(75472),p=n(40729);const h="100px",m="#00ab54",g="20px",f="20px",v="10px",b="22px",y="53px",C="10px",S=(0,s.J9)((e=>{let t=o.BO.semibold;switch(e){case a.Sx.LoopLight:case a.Sx.LoopDark:t=o.BO.regular}return[(0,d.Ml)(e),{fontSize:o.s.medium,fontWeight:t}]})),k=(0,s.J9)(((e,t,n,s)=>{const k=!t.canEdit,D=k||!t.canEditTitle,x=p.d.isLoopTheme(e);let T="linear-gradient(270deg, ".concat(m," 0%, ").concat("#094624"," 100%)"),E=r.z.NeutralLighter,w="",_="0px 25px";switch(e){case a.Sx.TeamsLight:T="linear-gradient(\n                    270deg,\n                    ".concat(r.z.TeamsLightPivotDownColor," 0%,\n                    ").concat(r.z.TeamsAppBrand00," 100%\n                )"),E=r.z.NeutralLighter;break;case a.Sx.TeamsDark:T="linear-gradient(\n                    270deg,\n                    ".concat(r.z.TeamsLightPivotDownColor," 0%,\n                    ").concat(r.z.TeamsAppBrand00," 100%\n                )"),E=r.z.NeutralDark;break;case a.Sx.TeamsContrast:T="linear-gradient(\n                    270deg,\n                    ".concat(r.z.White," 0%,\n                    ").concat(r.z.White," 100%\n                )"),E=r.z.Black,w="1px solid ".concat(r.z.White);break;case a.Sx.LoopWorkspaceLight:case a.Sx.LoopWorkspaceDark:T="linear-gradient(\n                    270deg,\n                    ".concat(r.z.LoopBrand140," 0%,\n                    ").concat(r.z.LoopBrand50," 100%\n                )"),_="0px 92px";case a.Sx.SharePoint:case a.Sx.Light:case a.Sx.Dark:case a.Sx.LoopLight:case a.Sx.LoopDark:}const I=[e===a.Sx.SharePoint&&{backgroundColor:r.z.SharepointBackgroundColor()},x&&{".taskAttachments":{".addAttachmentButtonWrapper > .addAttachmentButton":{border:"1px solid "+r.z.NeutralLightGrey82,borderRadius:"8px"}}},{fontSize:o.s.small,padding:_,"> .removeMargin":{marginBottom:"16px","> .ms-TextField .ms-TextField-wrapper textarea":[(0,d.MJ)(e)],".taskAttachments":{".emptyAttachmentsSection, .ms-Label.attachmentLabel":S(e),".addAttachmentButtonWrapper > .addAttachmentButton":[{":focus, :hover":[(0,d.Mi)(e),(0,c._Z)()]}]},"> .labelPickerArea":(0,d.Ml)(e)}}],P=[(0,d.gS)()],A=[(0,d._D)(e),{fontSize:o.s.small,fontWeight:o.BO.semibold,marginBottom:"4px","&.link":[(0,d.BP)(e),{cursor:"pointer",":hover":[e===a.Sx.Dark&&{color:r.z.FontColorThemeLight},e===a.Sx.Light&&{color:r.z.FontColorThemeDarker}]}]}],R=[(0,d.gS)(),n&&{"> .edit input":[!D&&(0,d.Ml)(e),{textDecoration:"line-through"}]},{".ms-TextField":[(0,d.GD)(),{".ms-TextField-field":[e===a.Sx.SharePoint&&{color:r.z.SharepointTitleFontColor()}]}],"> .completeButtonWithAnimation":{transform:"scale(1.111111)",height:"20px",width:"20px",marginTop:"6px",marginRight:"12px"}},D&&{"> .ms-TextField > .ms-TextField-wrapper > .ms-TextField-fieldGroup > .ms-TextField-field":{outline:"none",border:"none"}}],L=[(0,d.Ml)(e),{marginBottom:"32px"}],N=[(0,d.gS)(),{margin:"".concat((0,u.vb)((0,u.jz)(f)/2)," 0px ").concat((0,u.vb)((0,u.jz)(f)-(0,u.jz)("5px"))," 0px")}],M={".ms-TextField-field":[e===a.Sx.SharePoint&&{backgroundColor:r.z.SharepointAddTaskButtonBackgroundColor()}],"> .removeMargin":[(0,d.gS)("row","wrap"),{margin:"".concat((0,u.vb)((0,u.jz)(f)/2)," -").concat(v),"> *":{margin:"0px ".concat(v)},".dropdownTuple":[(0,d.GD)("175px"),{".ms-Label, .ms-TextField .ms-Label":[S(e),{marginBottom:"0px"}],"> .ms-Dropdown-container > *:nth-child(2)":[e===a.Sx.SharePoint&&{border:"1px",borderStyle:"solid",borderColor:r.z.SharepointCardSeparator()}],".ms-DatePicker":{fontSize:o.s.small,".ms-Icon":{fontSize:o.s.size16,"::before":[(0,d.aS)(e)]}}},x&&{paddingTop:"10px",paddingBottom:"10px",".plannerIcon.plannerCalendar":(0,d.A9)(e)}]}]},O=[(0,d.GD)(),{overflow:"hidden","> *":[(0,d.gS)(),d.cc,{margin:"-4px","> *":[(0,d.$Z)(),{margin:"4px"}],"> .textValue":[(0,d.GD)(),(0,d.q0)("ellipsis")],"> .indicator":[(0,d.gS)(),(0,d.$Z)(),{fontSize:o.s.large,width:b,height:b,justifyContent:"flex-end","> .plannerIcon":[(0,d.sC)(e)]}],"> .icon":[e===a.Sx.SharePoint&&{".plannerProgressInProgress, .plannerProgressInProgressSmall":{color:r.z.SharepointBlueIconColor()},".plannerProgressComplete, .plannerProgressCompleteSmall":{color:r.z.SharepointCompleteColor()},".plannerPriorityUrgent, .plannerPriorityUrgentSmall":{color:r.z.SharepointHighPriIconColor()},".plannerPriorityImportant, .plannerPriorityImportantSmall":{color:r.z.SharepointHighPriIconColor()},".plannerPriorityMedium":{color:r.z.SharepointCompleteColor()},".plannerPriorityLow":{color:r.z.SharepointBlueIconColor()},".plannerRecurrence, .plannerRecurrenceSmall ":{color:r.z.SharepointHighPriIconColor()}}]}]}],B=[{margin:"".concat(f," 0px"),"> .checklistInfo":[(0,d.gS)(),d.cc,{height:"30px",".checklistDetails":[S(e),(0,d.GD)(),(0,d.gS)(),{paddingRight:"25px","> .labelTag":{marginRight:C,marginLeft:C},"> .checklistFraction":{paddingLeft:"5px"}},e===a.Sx.TeamsContrast&&{color:r.z.White}],"> .checklistCompletionBar":[(0,d.GD)(),{".ms-ProgressIndicator-progressTrack":[(0,c.E1)(),(0,c.kE)(),{backgroundColor:E,border:w,boxSizing:"border-box",borderRadius:h,height:"4px"}],".ms-ProgressIndicator-progressBar":[(0,c.nb)(),{MsHighContrastAdjust:"none",backgroundImage:T,borderRadius:"".concat(h," 0px 0px ").concat(h),height:"4px"}]}],"> .checklistCompleted .ms-ProgressIndicator-progressBar":{borderRadius:h},"> .setPreviewCheckbox":[(0,d.gS)(),(0,d.$Z)(),{fontSize:o.s.small,paddingLeft:"30px","> .ms-Checkbox":[e===a.Sx.SharePoint&&{".ms-Checkbox-text":{color:r.z.SharepointTitleFontColor()}},e===a.Sx.TeamsContrast&&{".ms-Checkbox-text":{color:r.z.White},".ms-Checkbox-checkbox":{color:r.z.White,"> .ms-Checkbox-checkmark":{color:r.z.White}}}]}]}]}],F=[(0,d.gS)("column"),(0,d.dg)(e),{boxSizing:"border-box",width:"288px",padding:"".concat("8px"," ").concat("8px"," 0 ").concat("20px")}],j=[(0,d.gS)("column"),{".ms-Callout-beak":[e===a.Sx.TeamsDark&&{backgroundColor:i.kd.gray170},e===a.Sx.TeamsContrast&&{backgroundColor:r.z.Black}]},{".infoSection":[{"> .description":{fontSize:o.s.small,fontWeight:o.BO.semilight,padding:"8px",textAlign:"center"}}]}],H=[{borderColor:"inherit","> .ms-Toggle":[{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"0px","> .ms-Label":[S(e),{paddingRight:"8px",paddingBottom:"0px",paddingTop:"0px"}]}],".ghostTasksToggle.toggleOn":[{button:[(0,d.y8)(e)]}],".ghostTasksToggle.toggleOff":[{".ms-Toggle-thumb":[(0,d.y8)(e)],button:[(0,d.Qe)(e),{backgroundColor:"inherit"}]}],"button.activeView":[(0,d.GN)(e),{fontWeight:o.BO.bold}]}],z=[(0,d.$Z)(),{cursor:"pointer","> .ms-Checkbox":[{"> .ms-Checkbox-label":{alignItems:"center","> *":{fontSize:o.s.small}},".ms-Checkbox-checkbox":{borderRadius:"3px"}},e===a.Sx.SharePoint&&{"&.is-checked.is-enabled > .ms-Checkbox-label > .ms-Checkbox-checkbox":{backgroundColor:r.z.SharepointCompleteColor(),borderColor:r.z.SharepointCompleteColor(),"> .ms-Icon":{color:r.z.White}}}]}],U=[(0,c.kE)(),(0,d.nK)(e),(0,d.aS)(e),(0,d.MJ)(e),{fontFamily:"'Segoe UI Regular WestEuropean', 'Segoe UI', Tahoma, Arial, sans-serif",fontSize:o.s.size14,lineHeight:"17px",minHeight:"54px",paddingTop:"6px",paddingLeft:"8px",paddingRight:"12px"},k&&(0,d.$4)(e),e===a.Sx.TeamsContrast&&{backgroundColor:r.z.Black,borderColor:r.z.White,borderWidth:"1px",borderStyle:"solid"},e!==a.Sx.SharePoint&&{borderRadius:x?"3px":"4px"},e===a.Sx.SharePoint&&{backgroundColor:r.z.SharepointBackgroundColor()},e===a.Sx.SharePoint&&{backgroundColor:r.z.SharepointAddTaskButtonBackgroundColor()}],W=[{boxSizing:"border-box",minHeight:"20px",margin:"".concat((0,u.vb)((0,u.jz)(f)/2)," 0px ").concat(f," 0px"),wordWrap:"break-word","> .descriptionHeader":[(0,d.gS)(),{height:"30px",alignItems:"center",".descriptionTitle":[(0,d.GD)(),(0,d.q0)("ellipsis"),S(e),{float:"left",width:"auto",paddingTop:"0px",wordWrap:"break-word"}]}],"> .description-hyperlinks":U,"> .edit":[{"> textarea":[e===a.Sx.SharePoint&&{color:r.z.SharepointTitleFontColor()}]}]}],K={margin:"0px -".concat(y," -").concat(g," -").concat(y),padding:"0px ".concat(y," ").concat(g," ").concat(y),ul:{margin:"0",padding:"0"},li:{listStyleType:"none"}},G={color:(0,d.Qt)(e)},q={color:m},V={root:I,messageBanner:{marginBottom:"10px",marginTop:"5px"},planTitle:A,completeIcon:P,taskTitle:R,lastModifiedSection:L,assignedToUsers:N,dropdowns:M,dropdownsItems:O,checklist:B,setPreviewCheckbox:z,setMandatoryChecklistToggle:H,mandatoryCheckListToggleInfo:[{marginLeft:"5px"}],mandatoryChecklistInfoTooltip:j,mandatoryCalloutContent:F,description:W,commentsSection:K,fileSuggestionsSection:{borderTop:"solid ".concat(r.z.NeutralLighter," 1px"),paddingTop:"16px","> .file-suggestions-intersection-anchor":{minHeight:"1px"}},labelPickerArea:[(0,d.gS)("row","nowrap"),{alignItems:"center","> .plannerIcon":[(0,d.$Z)(),{paddingRight:"5px",cursor:"default",lineHeight:"32px"}],".labelPicker":[(0,d.GD)()]}],incompleteTaskRequiredChecklistHeaderItem:G,completeTaskRequiredChecklistHeaderItem:q};return(0,l.TW)(V,s)})),D=(0,s.J9)((e=>({subComponentStyles:{addAttachmentButton:{rootHovered:[(0,d.Mi)(e),(0,c.cP)()],rootFocused:[(0,d.Mi)(e),(0,c.cP)()],rootPressed:[(0,d.Mi)(e),(0,c.cP)()]},attachmentLabel:{root:S(e)}},emptyAttachmentsSection:S(e)}))),x=(0,s.J9)((e=>t=>{const{readOnly:n}=t,i=[(0,c.kE)(),{fontSize:o.s.size14,paddingTop:"6px",paddingLeft:"8px",paddingRight:"12px"}],s=[(0,d.nK)(e),(0,d.aS)(e),(0,d.MJ)(e),{minHeight:"146px",marginRight:"-10px !important","div *:not(.child):not(.ribbon):not(.ms-Button):not(.ms-Button *)":{backgroundColor:"transparent !important"}}],l=[{backgroundColor:"transparent !important",minHeight:"136px"},n&&{color:"inherit !important"},{ul:{padding:"revert"}},{li:{listStyleType:"initial"}},!n&&{"._EId_WATERMARK_WRAPPER":[e!==a.Sx.TeamsContrast&&{color:"inherit !important"},e===a.Sx.TeamsContrast&&{color:r.z.TeamsContrastPlaceHolderOrDisabledColor+"!important"}]}];return{root:i,expandNotesButton:[(e===a.Sx.TeamsLight||e===a.Sx.TeamsDark)&&{color:r.z.TeamsAppBrand00},e===a.Sx.TeamsContrast&&{color:r.z.TeamsContrastHyperlinkColor}],editorWrapper:s,notesEditor:l}})),T=(0,s.J9)((e=>{let t=r.z.ThemeTertiary;switch(e){case a.Sx.Light:t=r.z.ThemeTertiary;break;case a.Sx.Dark:t=r.z.ThemePrimary;break;case a.Sx.TeamsLight:t=r.z.TeamsDarkPurple;break;case a.Sx.TeamsDark:t=r.z.TeamsPurple;break;case a.Sx.TeamsContrast:t=r.z.TeamsContrastHyperlinkColor;break;case a.Sx.SharePoint:t=r.z.SharepointBackgroundColor()}return{color:t}})),E=(0,s.J9)((e=>({root:[{"a.ms-Link":{":link, :visited, :hover, :active":T(e)}},(e===a.Sx.Light||e===a.Sx.TeamsLight||e===a.Sx.Dark||e===a.Sx.TeamsDark)&&{backgroundColor:r.z.NeutralLighter,color:r.z.NeutralPrimary},e===a.Sx.TeamsContrast&&{backgroundColor:r.z.Black,color:r.z.White,border:"1px solid ".concat(r.z.White)},e===a.Sx.SharePoint&&{backgroundColor:r.z.SharepointTitleFontColor(),color:r.z.SharepointBackgroundColor()}],icon:[(e===a.Sx.Light||e===a.Sx.TeamsLight||e===a.Sx.Dark||e===a.Sx.TeamsDark)&&{color:r.z.NeutralPrimary},e===a.Sx.TeamsContrast&&{color:r.z.White},e===a.Sx.SharePoint&&{color:r.z.SharepointBackgroundColor()}]}))),w=(0,s.J9)((e=>({root:(0,l.Zq)("taskEditor",e.root),messageBanner:(0,l.Zq)("messageBanner",e.messageBanner),planTitle:(0,l.Zq)("planTitle",e.planTitle),taskTitle:(0,l.Zq)("title",e.taskTitle),lastModifiedSection:(0,l.Zq)("lastModifiedSection",e.lastModifiedSection),assignedToUsers:(0,l.Zq)("assignedToUsers",e.assignedToUsers),dropdowns:(0,l.Zq)("dropdowns",e.dropdowns),dropdownsItems:(0,l.Zq)("dropdownsItems",e.dropdownsItems),checklist:(0,l.Zq)("checklist",e.checklist),setPreviewCheckbox:(0,l.Zq)("setPreviewCheckbox",e.setPreviewCheckbox),mandatoryCheckListToggleInfo:(0,l.Zq)("mandatoryCheckListToggleInfo",e.mandatoryCheckListToggleInfo),setMandatoryChecklistToggle:(0,l.Zq)("setMandatoryChecklistToggle",e.setMandatoryChecklistToggle),description:(0,l.Zq)("description",e.description),commentsSection:(0,l.Zq)("commentsSection",e.commentsSection),fileSuggestionsSection:(0,l.Zq)("fileSuggestionsSection",e.fileSuggestionsSection),labelPickerArea:(0,l.Zq)("labelPickerArea",e.labelPickerArea),mandatoryChecklistInfoTooltip:(0,l.Zq)("mandatoryChecklistInfoTooltip",e.mandatoryChecklistInfoTooltip),mandatoryCalloutContent:(0,l.Zq)("mandatoryCalloutContent",e.mandatoryCalloutContent),completeIcon:(0,l.Zq)("completeIcon",e.completeIcon),incompleteTaskRequiredChecklistHeaderItem:(0,l.Zq)("incompleteTaskRequiredChecklistHeaderItem",e.incompleteTaskRequiredChecklistHeaderItem),completeTaskRequiredChecklistHeaderItem:(0,l.Zq)("completeTaskRequiredChecklistHeaderItem",e.completeTaskRequiredChecklistHeaderItem)})))},26316:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LoopAppDialog:()=>ym});var o={};n.r(o),n.d(o,{callout:()=>ga});var i={};n.r(i),n.d(i,{suggestionsContainer:()=>va});var r={};n.r(r),n.d(r,{actionButton:()=>ka,buttonSelected:()=>Da,itemButton:()=>Ea,root:()=>Sa,screenReaderOnly:()=>wa,suggestionsSpinner:()=>Ta,suggestionsTitle:()=>xa});var a,s,l=n(937),c=n(65043),d=n(16112),u=n(52342),p=n(40520),h=n(50724),m=n(77508),g=n(31537),f=n(9442),v=n(54845),b=n(63485),y=n(11638),C=n(20751),S=n(62530),k=n(6326),D=n(23820),x=n(32824),T=n(52787),E=n(17046),w=n(74258),_=n(42403),I=n(4648),P=n(27480),A=n(73095),R=n(44359),L=n(78233),N=n(72799),M=n(44388),O=n(94969),B=n(24718),F=n(17066),j=n(38152),H=n(64930),z=n(50840),U=n(6017),W=n(23830),K=n(33516),G=n(66783),q=(0,G.J9)((function(e){var t,n=e.semanticColors;return{backgroundColor:n.disabledBackground,color:n.disabledText,cursor:"default",selectors:(t={":after":{borderColor:n.disabledBackground}},t[K.up]={color:"GrayText",selectors:{":after":{borderColor:"GrayText"}}},t)}})),V={selectors:(a={},a[K.up]=(0,k.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,K.Qg)()),a)},Z={selectors:(s={},s[K.up]=(0,k.__assign)({color:"WindowText",backgroundColor:"Window"},(0,K.Qg)()),s)},Y=(0,G.J9)((function(e,t,n,o,i,r){var a,s=e.palette,l=e.semanticColors,c={textHoveredColor:l.menuItemTextHovered,textSelectedColor:s.neutralDark,textDisabledColor:l.disabledText,backgroundHoveredColor:l.menuItemBackgroundHovered,backgroundPressedColor:l.menuItemBackgroundPressed},d={root:[e.fonts.medium,{backgroundColor:o?c.backgroundHoveredColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:i?"none":"block",width:"100%",height:"auto",minHeight:36,lineHeight:"20px",padding:"0 8px",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:"transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",selectors:(0,k.__assign)((0,k.__assign)((a={},a[K.up]={border:"none",borderColor:"Background"},a),!i&&{"&.ms-Checkbox":{display:"flex",alignItems:"center"}}),{"&.ms-Button--command:hover:active":{backgroundColor:c.backgroundPressedColor},".ms-Checkbox-label":{width:"100%"}})},r?[{backgroundColor:"transparent",color:c.textSelectedColor,selectors:{":hover":[{backgroundColor:c.backgroundHoveredColor},V]}},(0,K.gm)(e,{inset:-1,isFocusedOnly:!1}),V]:[]],rootHovered:{backgroundColor:c.backgroundHoveredColor,color:c.textHoveredColor},rootFocused:{backgroundColor:c.backgroundHoveredColor},rootDisabled:{color:c.textDisabledColor,cursor:"default"},optionText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:"0px",maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",display:"inline-block"},optionTextWrapper:{maxWidth:"100%",display:"flex",alignItems:"center"}};return(0,K.TW)(d,t,n)})),X=(0,G.J9)((function(e,t){var n,o,i=e.semanticColors,r=e.fonts,a={buttonTextColor:i.bodySubtext,buttonTextHoveredCheckedColor:i.buttonTextChecked,buttonBackgroundHoveredColor:i.listItemBackgroundHovered,buttonBackgroundCheckedColor:i.listItemBackgroundChecked,buttonBackgroundCheckedHoveredColor:i.listItemBackgroundCheckedHovered},s={selectors:(n={},n[K.up]=(0,k.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,K.Qg)()),n)},l={root:{color:a.buttonTextColor,fontSize:r.small.fontSize,position:"absolute",top:0,height:"100%",lineHeight:30,width:32,textAlign:"center",cursor:"default",selectors:(o={},o[K.up]=(0,k.__assign)({backgroundColor:"ButtonFace",borderColor:"ButtonText",color:"ButtonText"},(0,K.Qg)()),o)},icon:{fontSize:r.small.fontSize},rootHovered:[{backgroundColor:a.buttonBackgroundHoveredColor,color:a.buttonTextHoveredCheckedColor,cursor:"pointer"},s],rootPressed:[{backgroundColor:a.buttonBackgroundCheckedColor,color:a.buttonTextHoveredCheckedColor},s],rootChecked:[{backgroundColor:a.buttonBackgroundCheckedColor,color:a.buttonTextHoveredCheckedColor},s],rootCheckedHovered:[{backgroundColor:a.buttonBackgroundCheckedHoveredColor,color:a.buttonTextHoveredCheckedColor},s],rootDisabled:[q(e),{position:"absolute"}]};return(0,K.TW)(l,t)})),$=(0,G.J9)((function(e,t,n){var o,i,r,a,s,l,c=e.semanticColors,d=e.fonts,u=e.effects,p={textColor:c.inputText,borderColor:c.inputBorder,borderHoveredColor:c.inputBorderHovered,borderPressedColor:c.inputFocusBorderAlt,borderFocusedColor:c.inputFocusBorderAlt,backgroundColor:c.inputBackground,erroredColor:c.errorText},h={headerTextColor:c.menuHeader,dividerBorderColor:c.bodyDivider},m={selectors:(o={},o[K.up]={color:"GrayText"},o)},g=[{color:c.inputPlaceholderText},m],f=[{color:c.inputTextHovered},m],v=[{color:c.disabledText},m],b=(0,k.__assign)((0,k.__assign)({color:"HighlightText",backgroundColor:"Window"},(0,K.Qg)()),{selectors:{":after":{borderColor:"Highlight"}}}),y=(0,K.Sq)(p.borderPressedColor,u.roundedCorner2,"border",0),C={container:{},label:{},labelDisabled:{},root:[e.fonts.medium,{boxShadow:"none",marginLeft:"0",paddingRight:32,paddingLeft:9,color:p.textColor,position:"relative",outline:"0",userSelect:"none",backgroundColor:p.backgroundColor,cursor:"text",display:"block",height:32,whiteSpace:"nowrap",textOverflow:"ellipsis",boxSizing:"border-box",selectors:{".ms-Label":{display:"inline-block",marginBottom:"8px"},"&.is-open":{selectors:(i={},i[K.up]=b,i)},":after":{pointerEvents:"none",content:"''",position:"absolute",left:0,top:0,bottom:0,right:0,borderWidth:"1px",borderStyle:"solid",borderColor:p.borderColor,borderRadius:u.roundedCorner2}}}],rootHovered:{selectors:(r={":after":{borderColor:p.borderHoveredColor},".ms-ComboBox-Input":[{color:c.inputTextHovered},(0,K.CX)(f),Z]},r[K.up]=(0,k.__assign)((0,k.__assign)({color:"HighlightText",backgroundColor:"Window"},(0,K.Qg)()),{selectors:{":after":{borderColor:"Highlight"}}}),r)},rootPressed:[{position:"relative",selectors:(a={},a[K.up]=b,a)}],rootFocused:[{selectors:(s={".ms-ComboBox-Input":[{color:c.inputTextHovered},Z]},s[K.up]=b,s)},y],rootDisabled:q(e),rootError:{selectors:{":after":{borderColor:p.erroredColor},":hover:after":{borderColor:c.inputBorderHovered}}},rootDisallowFreeForm:{},input:[(0,K.CX)(g),{backgroundColor:p.backgroundColor,color:p.textColor,boxSizing:"border-box",width:"100%",height:"100%",borderStyle:"none",outline:"none",font:"inherit",textOverflow:"ellipsis",padding:"0",selectors:{"::-ms-clear":{display:"none"}}},Z],inputDisabled:[q(e),(0,K.CX)(v)],errorMessage:[e.fonts.small,{color:p.erroredColor,marginTop:"5px"}],callout:{boxShadow:u.elevation8},optionsContainerWrapper:{width:n},optionsContainer:{display:"block"},screenReaderText:K.dX,header:[d.medium,{fontWeight:K.BO.semibold,color:h.headerTextColor,backgroundColor:"none",borderStyle:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(l={},l[K.up]=(0,k.__assign)({color:"GrayText"},(0,K.Qg)()),l)}],divider:{height:1,backgroundColor:h.dividerBorderColor}};return(0,K.TW)(C,t)})),J=(0,G.J9)((function(e,t,n,o,i,r,a,s){return{container:(0,K.Zq)("ms-ComboBox-container",t,e.container),label:(0,K.Zq)(e.label,o&&e.labelDisabled),root:(0,K.Zq)("ms-ComboBox",s?e.rootError:n&&"is-open",i&&"is-required",e.root,!a&&e.rootDisallowFreeForm,s&&!r?e.rootError:!o&&r&&e.rootFocused,!o&&{selectors:{":hover":s?e.rootError:!n&&!r&&e.rootHovered,":active":s?e.rootError:e.rootPressed,":focus":s?e.rootError:e.rootFocused}},o&&["is-disabled",e.rootDisabled]),input:(0,K.Zq)("ms-ComboBox-Input",e.input,o&&e.inputDisabled),errorMessage:(0,K.Zq)(e.errorMessage),callout:(0,K.Zq)("ms-ComboBox-callout",e.callout),optionsContainerWrapper:(0,K.Zq)("ms-ComboBox-optionsContainerWrapper",e.optionsContainerWrapper),optionsContainer:(0,K.Zq)("ms-ComboBox-optionsContainer",e.optionsContainer),header:(0,K.Zq)("ms-ComboBox-header",e.header),divider:(0,K.Zq)("ms-ComboBox-divider",e.divider),screenReaderText:(0,K.Zq)(e.screenReaderText)}})),Q=(0,G.J9)((function(e){return{optionText:(0,K.Zq)("ms-ComboBox-optionText",e.optionText),root:(0,K.Zq)("ms-ComboBox-option",e.root,{selectors:{":hover":e.rootHovered,":focus":e.rootFocused,":active":e.rootPressed}}),optionTextWrapper:(0,K.Zq)(e.optionTextWrapper)}})),ee=n(50199),te=n(34644),ne=n(13706),oe=n(87633),ie=n(56420),re=n(51605);var ae,se,le=n(82014),ce=n(19487);!function(e){e[e.backward=-1]="backward",e[e.none=0]="none",e[e.forward=1]="forward"}(ae||(ae={})),function(e){e[e.clearAll=-2]="clearAll",e[e.default=-1]="default"}(se||(se={}));var de=c.memo((function(e){return(0,e.render)()}),(function(e,t){e.render;var n=(0,k.__rest)(e,["render"]),o=(t.render,(0,k.__rest)(t,["render"]));return(0,x.ab)(n,o)})),ue="ComboBox",pe={options:[],allowFreeform:!1,autoComplete:"on",buttonIconProps:{iconName:"ChevronDown"}};function he(e){var t=e.options,n=e.defaultSelectedKey,o=e.selectedKey,i=c.useState((function(){return ve(t,function(e,t){var n=be(e);if(n.length)return n;return be(t)}(n,o))})),r=i[0],a=i[1],s=c.useState(t),l=s[0],d=s[1],u=c.useState(),p=u[0],h=u[1];return c.useEffect((function(){if(void 0!==o){var e=be(o),n=ve(t,e);a(n)}d(t)}),[t,o]),c.useEffect((function(){null===o&&h(void 0)}),[o]),[r,a,l,d,p,h]}var me=c.forwardRef((function(e,t){var n=(0,T.N)(pe,e),o=(n.ref,(0,k.__rest)(n,["ref"])),i=c.useRef(null),r=(0,ie.a)(i,t),a=he(o),s=a[0],l=a[1],d=a[2],u=a[3],p=a[4],h=a[5];return c.createElement(fe,(0,k.__assign)({},o,{hoisted:{mergedRootRef:r,rootRef:i,selectedIndices:s,setSelectedIndices:l,currentOptions:d,setCurrentOptions:u,suggestedDisplayValue:p,setSuggestedDisplayValue:h}}))}));function ge(e,t){for(var n=function(e,t){void 0===t&&(t=!0);var n=[];if(e){for(var o=0;o<e.children.length;o++)n.push(e.children.item(o));t&&(0,re.q)(e)&&n.push.apply(n,e._virtual.children)}return n}(e),o=0;o<n.length;o++){var i=n[o];if(t(i))return i;var r=ge(i,t);if(r)return r}return null}me.displayName=ue;var fe=function(e){function t(t){var n=e.call(this,t)||this;return n._autofill=c.createRef(),n._comboBoxWrapper=c.createRef(),n._comboBoxMenu=c.createRef(),n._selectedElement=c.createRef(),n._overrideScrollDismiss=!1,n.focus=function(e,t){n.props.disabled||(n._autofill.current&&(t?(0,E.lo)(n._autofill.current):n._autofill.current.focus(),e&&n.setState({isOpen:!0})),n._hasFocus()||n.setState({focusState:"focused"}))},n.dismissMenu=function(){n.state.isOpen&&n.setState({isOpen:!1})},n._onUpdateValueInAutofillWillReceiveProps=function(){var e=n._autofill.current;return e?null===e.value||void 0===e.value?null:ye(n._currentVisibleValue):null},n._renderComboBoxWrapper=function(e,t){var o=n.props,i=o.label,r=o.disabled,a=o.ariaLabel,s=o.ariaDescribedBy,l=void 0===s?n.props["aria-describedby"]:s,d=o.required,u=o.errorMessage,p=o.buttonIconProps,h=o.isButtonAriaHidden,m=o.title,g=o.placeholder,f=o.tabIndex,v=o.autofill,b=o.iconButtonProps,y=o.hoisted.suggestedDisplayValue,C=n.state,S=C.ariaActiveDescendantValue,x=C.isOpen,T=n._hasFocus()&&n.props.multiSelect&&e?e:g,E=[n.props["aria-labelledby"],i&&n._id+"-label"].join(" ").trim(),_={"aria-labelledby":E||void 0,"aria-label":a&&!i?a:void 0};return c.createElement("div",{"data-ktp-target":!0,ref:n._comboBoxWrapper,id:n._id+"wrapper",className:n._classNames.root,"aria-owns":x?n._id+"-list":void 0},c.createElement(D.r,(0,k.__assign)({"data-ktp-execute-target":!0,"data-is-interactable":!r,componentRef:n._autofill,id:n._id+"-input",className:n._classNames.input,type:"text",onFocus:n._onFocus,onBlur:n._onBlur,onKeyDown:n._onInputKeyDown,onKeyUp:n._onInputKeyUp,onClick:n._onAutofillClick,onTouchStart:n._onTouchStart,onInputValueChange:n._onInputChange,"aria-expanded":x,"aria-autocomplete":n._getAriaAutoCompleteValue(),role:"combobox",readOnly:r},_,{"aria-describedby":void 0!==u?(0,w._)(l,t):l,"aria-activedescendant":S,"aria-required":d,"aria-disabled":r,"aria-controls":x?n._id+"-list":void 0,spellCheck:!1,defaultVisibleValue:n._currentVisibleValue,suggestedDisplayValue:y,updateValueInWillReceiveProps:n._onUpdateValueInAutofillWillReceiveProps,shouldSelectFullInputValueInComponentDidUpdate:n._onShouldSelectFullInputValueInAutofillComponentDidUpdate,title:m,preventValueSelection:!n._hasFocus(),placeholder:T,tabIndex:r?-1:f},v)),c.createElement(ne.K,(0,k.__assign)({className:"ms-ComboBox-CaretDown-button",styles:n._getCaretButtonStyles(),role:h?"presentation":void 0,"aria-hidden":h},h?void 0:_,{"data-is-focusable":!1,tabIndex:-1,onClick:n._onComboBoxClick,onBlur:n._onBlur,iconProps:p,disabled:r,checked:x},b)))},n._onShouldSelectFullInputValueInAutofillComponentDidUpdate=function(){return n._currentVisibleValue===n.props.hoisted.suggestedDisplayValue},n._getVisibleValue=function(){var e=n.props,t=e.text,o=e.allowFreeform,i=e.allowFreeInput,r=e.autoComplete,a=e.hoisted,s=a.suggestedDisplayValue,l=a.selectedIndices,c=a.currentOptions,d=n.state,u=d.currentPendingValueValidIndex,p=d.currentPendingValue,h=d.isOpen,m=Ce(c,u);if((!h||!m)&&(t||""===t)&&(null===p||void 0===p))return t;if(n.props.multiSelect){if(n._hasFocus()){var g=-1;return"on"===r&&m&&(g=u),n._getPendingString(p,c,g)}return n._getMultiselectDisplayString(l,c,s)}g=n._getFirstSelectedIndex();return o||i?("on"===r&&m&&(g=u),n._getPendingString(p,c,g)):m&&"on"===r?(g=u,ye(p)):!n.state.isOpen&&p?Ce(c,g)?p:ye(s):Ce(c,g)?De(c[g]):ye(s)},n._onInputChange=function(e){n.props.disabled?n._handleInputWhenDisabled(null):(n.props.onInputValueChange&&n.props.onInputValueChange(e),n.props.allowFreeform||n.props.allowFreeInput?n._processInputChangeWithFreeform(e):n._processInputChangeWithoutFreeform(e))},n._onFocus=function(){var e,t;null===(t=null===(e=n._autofill.current)||void 0===e?void 0:e.inputElement)||void 0===t||t.select(),n._hasFocus()||n.setState({focusState:"focusing"})},n._onResolveOptions=function(){if(n.props.onResolveOptions){var e=n.props.onResolveOptions((0,k.__spreadArray)([],n.props.hoisted.currentOptions,!0));Array.isArray(e)?n.props.hoisted.setCurrentOptions(e):e&&e.then&&(n._currentPromise=e,e.then((function(t){e===n._currentPromise&&n.props.hoisted.setCurrentOptions(t)})))}},n._onBlur=function(e){var t,o,i=(0,ce.LW)(n.context),r=e.relatedTarget;if(null===e.relatedTarget&&(r=null===i||void 0===i?void 0:i.activeElement),r){var a=null===(t=n.props.hoisted.rootRef.current)||void 0===t?void 0:t.contains(r),s=null===(o=n._comboBoxMenu.current)||void 0===o?void 0:o.contains(r),l=n._comboBoxMenu.current&&(0,_.w)(n._comboBoxMenu.current,(function(e){return e===r}),i);if(a||s||l)return l&&n._hasFocus()&&(!n.props.multiSelect||n.props.allowFreeform)&&n._submitPendingValue(e),e.preventDefault(),void e.stopPropagation()}n._hasFocus()&&(n.setState({focusState:"none"}),n.props.multiSelect&&!n.props.allowFreeform||n._submitPendingValue(e))},n._onRenderContainer=function(e,t){var o=e.onRenderList,i=e.calloutProps,r=e.dropdownWidth,a=e.dropdownMaxWidth,s=e.onRenderUpperContent,l=void 0===s?n._onRenderUpperContent:s,d=e.onRenderLowerContent,u=void 0===d?n._onRenderLowerContent:d,p=e.useComboBoxAsMenuWidth,h=e.persistMenu,m=e.shouldRestoreFocus,g=void 0===m||m,f=n.state.isOpen,v=n._id,b=p&&n._comboBoxWrapper.current?n._comboBoxWrapper.current.clientWidth+2:void 0;return c.createElement(z.P,(0,k.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHint:U.A.bottomLeftEdge,directionalHintFixed:!1},i,{onLayerMounted:n._onLayerMounted,className:(0,I.A)(n._classNames.callout,null===i||void 0===i?void 0:i.className),target:n._comboBoxWrapper.current,onDismiss:n._onDismiss,onMouseDown:n._onCalloutMouseDown,onScroll:n._onScroll,setInitialFocus:!1,calloutWidth:p&&n._comboBoxWrapper.current?b&&b:r,calloutMaxWidth:a||b,hidden:h?!f:void 0,shouldRestoreFocus:g,preventDismissOnEvent:function(e){return n._preventDismissOnScrollOrResize(e)}}),l(n.props,n._onRenderUpperContent),c.createElement("div",{className:n._classNames.optionsContainerWrapper,ref:n._comboBoxMenu},null===o||void 0===o?void 0:o((0,k.__assign)((0,k.__assign)({},e),{id:v}),n._onRenderList)),u(n.props,n._onRenderLowerContent))},n._onLayerMounted=function(){n._onCalloutLayerMounted(),n._async.setTimeout((function(){n._scrollIntoView()}),0),n.props.calloutProps&&n.props.calloutProps.onLayerMounted&&n.props.calloutProps.onLayerMounted()},n._onRenderLabel=function(e){var t=e.props,o=t.label,i=t.disabled,r=t.required;return o?c.createElement(g.J,{id:n._id+"-label",disabled:i,required:r,className:n._classNames.label},o,e.multiselectAccessibleText&&c.createElement("span",{className:n._classNames.screenReaderText},e.multiselectAccessibleText)):null},n._onRenderList=function(e){var t=e.onRenderItem,o=void 0===t?n._onRenderItem:t,i=e.label,r=e.ariaLabel,a=e.multiSelect,s={items:[]},l=[],d=function(){var e=s.id?[c.createElement("div",{role:"group",key:s.id,"aria-labelledby":s.id},s.items)]:s.items;l=(0,k.__spreadArray)((0,k.__spreadArray)([],l,!0),e,!0),s={items:[]}};e.options.forEach((function(e,t){!function(e,t){switch(e.itemType){case ee.W.Header:s.items.length>0&&d();var i=n._id+e.key;s.items.push(o((0,k.__assign)((0,k.__assign)({id:i},e),{index:t}),n._onRenderItem)),s.id=i;break;case ee.W.Divider:t>0&&s.items.push(o((0,k.__assign)((0,k.__assign)({},e),{index:t}),n._onRenderItem)),s.items.length>0&&d();break;default:s.items.push(o((0,k.__assign)((0,k.__assign)({},e),{index:t}),n._onRenderItem))}}(e,t)})),s.items.length>0&&d();var u=n._id;return c.createElement("div",{id:u+"-list",className:n._classNames.optionsContainer,"aria-labelledby":i&&u+"-label","aria-label":r&&!i?r:void 0,"aria-multiselectable":a?"true":void 0,role:"listbox"},l)},n._onRenderItem=function(e){switch(e.itemType){case ee.W.Divider:return n._renderSeparator(e);case ee.W.Header:return n._renderHeader(e);default:return n._renderOption(e)}},n._onRenderLowerContent=function(){return null},n._onRenderUpperContent=function(){return null},n._renderOption=function(e){var t,o=n.props.onRenderOption,i=void 0===o?n._onRenderOptionContent:o,r=null!==(t=e.id)&&void 0!==t?t:n._id+"-list"+e.index,a=n._isOptionSelected(e.index),s=n._isOptionChecked(e.index),l=n._isOptionIndeterminate(e.index),d=n._getCurrentOptionStyles(e),u=Q(n._getCurrentOptionStyles(e)),p=e.title;return c.createElement(de,{key:e.key,index:e.index,disabled:e.disabled,isSelected:a,isChecked:s,isIndeterminate:l,text:e.text,render:function(){return n.props.multiSelect?c.createElement(W.S,{id:r,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:r+"-label",key:e.key,styles:d,className:"ms-ComboBox-option",onChange:n._onItemClick(e),label:e.text,checked:s,indeterminate:l,title:p,disabled:e.disabled,onRenderLabel:n._renderCheckboxLabel.bind(n,(0,k.__assign)((0,k.__assign)({},e),{id:r+"-label"})),inputProps:(0,k.__assign)({"aria-selected":s?"true":"false",role:"option"},{"data-index":e.index,"data-is-focusable":!0})}):c.createElement(oe.c,{id:r,key:e.key,"data-index":e.index,styles:d,checked:a,className:"ms-ComboBox-option",onClick:n._onItemClick(e),onMouseEnter:n._onOptionMouseEnter.bind(n,e.index),onMouseMove:n._onOptionMouseMove.bind(n,e.index),onMouseLeave:n._onOptionMouseLeave,role:"option","aria-selected":a?"true":"false",ariaLabel:e.ariaLabel,disabled:e.disabled,title:p},c.createElement("span",{className:u.optionTextWrapper,ref:a?n._selectedElement:void 0},i(e,n._onRenderOptionContent)))},data:e.data})},n._onCalloutMouseDown=function(e){e.preventDefault()},n._onScroll=function(){var e;n._isScrollIdle||void 0===n._scrollIdleTimeoutId?n._isScrollIdle=!1:(n._async.clearTimeout(n._scrollIdleTimeoutId),n._scrollIdleTimeoutId=void 0),(null===(e=n.props.calloutProps)||void 0===e?void 0:e.onScroll)&&n.props.calloutProps.onScroll(),n._scrollIdleTimeoutId=n._async.setTimeout((function(){n._isScrollIdle=!0}),250)},n._onRenderOptionContent=function(e){var t=Q(n._getCurrentOptionStyles(e));return c.createElement("span",{className:t.optionText},e.text)},n._onRenderMultiselectOptionContent=function(e){var t=Q(n._getCurrentOptionStyles(e));return c.createElement("span",{id:e.id,"aria-hidden":"true",className:t.optionText},e.text)},n._onDismiss=function(){var e=n.props.onMenuDismiss;e&&e(),n.props.persistMenu&&n._onCalloutLayerMounted(),n._setOpenStateAndFocusOnClose(!1,!1),n._resetSelectedIndex()},n._onAfterClearPendingInfo=function(){n._processingClearPendingInfo=!1},n._onInputKeyDown=function(e){var t=n.props,o=t.disabled,i=t.allowFreeform,r=t.allowFreeInput,a=t.autoComplete,s=t.hoisted.currentOptions,l=n.state,c=l.isOpen,d=l.currentPendingValueValidIndexOnHover;if(n._lastKeyDownWasAltOrMeta=xe(e),o)n._handleInputWhenDisabled(e);else{var u=n._getPendingSelectedIndex(!1);switch(e.which){case P.c.enter:n._autofill.current&&n._autofill.current.inputElement&&n._autofill.current.inputElement.select(),n._submitPendingValue(e),n.props.multiSelect&&c?n.setState({currentPendingValueValidIndex:u}):(c||(!i||void 0===n.state.currentPendingValue||null===n.state.currentPendingValue||n.state.currentPendingValue.length<=0)&&n.state.currentPendingValueValidIndex<0)&&n.setState({isOpen:!c});break;case P.c.tab:return n.props.multiSelect||n._submitPendingValue(e),void(c&&n._setOpenStateAndFocusOnClose(!c,!1));case P.c.escape:if(n._resetSelectedIndex(),!c)return;n.setState({isOpen:!1});break;case P.c.up:if(d===se.clearAll&&(u=n.props.hoisted.currentOptions.length),e.altKey||e.metaKey){if(c){n._setOpenStateAndFocusOnClose(!c,!0);break}return}e.preventDefault(),n._setPendingInfoFromIndexAndDirection(u,ae.backward);break;case P.c.down:e.altKey||e.metaKey?n._setOpenStateAndFocusOnClose(!0,!0):(d===se.clearAll&&(u=-1),e.preventDefault(),n._setPendingInfoFromIndexAndDirection(u,ae.forward));break;case P.c.home:case P.c.end:if(i||r)return;u=-1;var p=ae.forward;e.which===P.c.end&&(u=s.length,p=ae.backward),n._setPendingInfoFromIndexAndDirection(u,p);break;case P.c.space:if(!i&&!r&&"off"===a)break;default:if(e.which>=112&&e.which<=123)return;if(e.keyCode===P.c.alt||"Meta"===e.key)return;if(!i&&!r&&"on"===a){n._onInputChange(e.key);break}return}e.stopPropagation(),e.preventDefault()}},n._onInputKeyUp=function(e){var t=n.props,o=t.disabled,i=t.allowFreeform,r=t.allowFreeInput,a=t.autoComplete,s=n.state.isOpen,l=n._lastKeyDownWasAltOrMeta&&xe(e);n._lastKeyDownWasAltOrMeta=!1;var c=l&&!((0,A.c)()||(0,R.u)());o?n._handleInputWhenDisabled(e):e.which!==P.c.space?c&&s?n._setOpenStateAndFocusOnClose(!s,!0):("focusing"===n.state.focusState&&n.props.openOnKeyboardFocus&&n.setState({isOpen:!0}),"focused"!==n.state.focusState&&n.setState({focusState:"focused"})):i||r||"off"!==a||n._setOpenStateAndFocusOnClose(!s,!!s)},n._onOptionMouseLeave=function(){n._shouldIgnoreMouseEvent()||n.props.persistMenu&&!n.state.isOpen||n.setState({currentPendingValueValidIndexOnHover:se.clearAll})},n._onComboBoxClick=function(){var e=n.props.disabled,t=n.state.isOpen;e||(n._setOpenStateAndFocusOnClose(!t,!1),n.setState({focusState:"focused"}))},n._onAutofillClick=function(){var e=n.props,t=e.disabled;e.allowFreeform&&!t?n.focus(n.state.isOpen||n._processingTouch):n._onComboBoxClick()},n._onTouchStart=function(){n._comboBoxWrapper.current&&!("onpointerdown"in n._comboBoxWrapper)&&n._handleTouchAndPointerEvent()},n._onPointerDown=function(e){"touch"===e.pointerType&&(n._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},(0,L.f)(n),n._async=new N.j(n),n._events=new M.g(n),(0,O.Y)(ue,t,{defaultSelectedKey:"selectedKey",text:"defaultSelectedKey",selectedKey:"value",dropdownWidth:"useComboBoxAsMenuWidth",ariaLabel:"label"}),n._id=t.id||(0,B.O)("ComboBox"),n._isScrollIdle=!0,n._processingTouch=!1,n._gotMouseMove=!1,n._processingClearPendingInfo=!1,n.state={isOpen:!1,focusState:"none",currentPendingValueValidIndex:-1,currentPendingValue:void 0,currentPendingValueValidIndexOnHover:se.default},n}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props.hoisted,t=e.currentOptions,n=e.selectedIndices;return(0,te.D)(t,n)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._comboBoxWrapper.current&&!this.props.disabled&&(this._events.on(this._comboBoxWrapper.current,"focus",this._onResolveOptions,!0),"onpointerdown"in this._comboBoxWrapper.current&&this._events.on(this._comboBoxWrapper.current,"pointerdown",this._onPointerDown,!0))},t.prototype.componentDidUpdate=function(e,t){var n,o,i,r=this,a=this.props,s=a.allowFreeform,l=a.allowFreeInput,c=a.text,d=a.onMenuOpen,u=a.onMenuDismissed,p=a.hoisted,h=p.currentOptions,m=p.selectedIndices,g=this.state,f=g.currentPendingValue,v=g.currentPendingValueValidIndex,b=g.isOpen;!b||t.isOpen&&t.currentPendingValueValidIndex===v||this._async.setTimeout((function(){return r._scrollIntoView()}),0);var y=(0,ce.LW)(this.context);this._hasFocus()&&(b||t.isOpen&&!b&&this._focusInputAfterClose&&this._autofill.current&&(null===y||void 0===y?void 0:y.activeElement)!==this._autofill.current.inputElement)&&this.focus(void 0,!0),this._focusInputAfterClose&&(t.isOpen&&!b||this._hasFocus()&&(!b&&!this.props.multiSelect&&e.hoisted.selectedIndices&&m&&e.hoisted.selectedIndices[0]!==m[0]||!s&&!l||c!==e.text))&&this._onFocus(),this._notifyPendingValueChanged(t),b&&!t.isOpen&&(this._overrideScrollDismiss=!0,this._async.clearTimeout(this._overrideScrollDimissTimeout),this._overrideScrollDimissTimeout=this._async.setTimeout((function(){r._overrideScrollDismiss=!1}),100),null===d||void 0===d||d()),!b&&t.isOpen&&u&&u();var C=v,S=h.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})}));!(0,x.ab)(e.hoisted.currentOptions,h)&&f&&(C=this.props.allowFreeform||this.props.allowFreeInput?this._processInputChangeWithFreeform(f):this._updateAutocompleteIndexWithoutFreeform(f));var D=void 0;b&&this._hasFocus()&&-1!==C?D=null!==(n=S[C].id)&&void 0!==n?n:this._id+"-list"+C:b&&m.length&&(D=null!==(i=null===(o=S[m[0]])||void 0===o?void 0:o.id)&&void 0!==i?i:this._id+"-list"+m[0]),D!==this.state.ariaActiveDescendantValue&&this.setState({ariaActiveDescendantValue:D})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this._id+"-error",t=this.props,n=t.className,o=t.disabled,i=t.required,r=t.errorMessage,a=t.onRenderContainer,s=void 0===a?this._onRenderContainer:a,l=t.onRenderLabel,d=void 0===l?this._onRenderLabel:l,u=t.onRenderList,p=void 0===u?this._onRenderList:u,h=t.onRenderItem,m=void 0===h?this._onRenderItem:h,g=t.onRenderOption,f=void 0===g?this._onRenderOptionContent:g,v=t.allowFreeform,b=t.styles,y=t.theme,C=t.persistMenu,S=t.multiSelect,D=t.hoisted,x=D.suggestedDisplayValue,T=D.selectedIndices,E=D.currentOptions,w=this.state.isOpen;this._currentVisibleValue=this._getVisibleValue();var _=S?this._getMultiselectDisplayString(T,E,x):void 0,I=(0,F.G1)(this.props,F.JM,["onChange","value","aria-describedby","aria-labelledby"]),P=!!(r&&r.length>0);this._classNames=this.props.getClassNames?this.props.getClassNames(y,!!w,!!o,!!i,!!this._hasFocus(),!!v,!!P,n):J($(y,b),n,!!w,!!o,!!i,!!this._hasFocus(),!!v,!!P);var A=this._renderComboBoxWrapper(_,e);return c.createElement("div",(0,k.__assign)({},I,{ref:this.props.hoisted.mergedRootRef,className:this._classNames.container}),d({props:this.props,multiselectAccessibleText:_},this._onRenderLabel),A,(C||w)&&s((0,k.__assign)((0,k.__assign)({},this.props),{onRenderList:p,onRenderItem:m,onRenderOption:f,options:E.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})})),onDismiss:this._onDismiss}),this._onRenderContainer),P&&c.createElement("div",{role:"alert",id:e,className:this._classNames.errorMessage},r))},t.prototype._getPendingString=function(e,t,n){return null!==e&&void 0!==e?e:Ce(t,n)?De(t[n]):""},t.prototype._getMultiselectDisplayString=function(e,t,n){for(var o=[],i=0;e&&i<e.length;i++){var r=e[i];t[r].itemType!==ee.W.SelectAll&&o.push(Ce(t,r)?t[r].text:ye(n))}var a=this.props.multiSelectDelimiter,s=void 0===a?", ":a;return o.join(s)},t.prototype._preventDismissOnScrollOrResize=function(e){var t=this.props.calloutProps;return(null===t||void 0===t?void 0:t.preventDismissOnEvent)?t.preventDismissOnEvent(e):!(!this._overrideScrollDismiss||"scroll"!==e.type&&"resize"!==e.type)},t.prototype._processInputChangeWithFreeform=function(e){var t=this.props.hoisted.currentOptions,n=-1;if(""===e)return 1===(i=t.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})})).filter((function(t){return Se(t)&&!t.disabled&&De(t)===e}))).length&&(n=i[0].index),this._setPendingInfo(e,n,e),n;var o=e;e=e.toLocaleLowerCase();var i,r="";if("on"===this.props.autoComplete){if((i=t.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})})).filter((function(t){return Se(t)&&!t.disabled&&0===De(t).toLocaleLowerCase().indexOf(e)}))).length>0){var a=De(i[0]);r=a.toLocaleLowerCase()!==e?a:"",n=i[0].index}}else 1===(i=t.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})})).filter((function(t){return Se(t)&&!t.disabled&&De(t).toLocaleLowerCase()===e}))).length&&(n=i[0].index);return this._setPendingInfo(o,n,r),n},t.prototype._processInputChangeWithoutFreeform=function(e){var t=this,n=this.state,o=n.currentPendingValue,i=n.currentPendingValueValidIndex;if("on"===this.props.autoComplete&&""!==e){this._autoCompleteTimeout&&(this._async.clearTimeout(this._autoCompleteTimeout),this._autoCompleteTimeout=void 0,e=ye(o)+e);var r=this._updateAutocompleteIndexWithoutFreeform(e);return this._autoCompleteTimeout=this._async.setTimeout((function(){t._autoCompleteTimeout=void 0}),1e3),r}var a=i>=0?i:this._getFirstSelectedIndex();return this._setPendingInfoFromIndex(a),a},t.prototype._updateAutocompleteIndexWithoutFreeform=function(e){var t=this.props.hoisted.currentOptions,n=e;e=e.toLocaleLowerCase();var o=t.map((function(e,t){return(0,k.__assign)((0,k.__assign)({},e),{index:t})})).filter((function(t){return Se(t)&&!t.disabled&&0===t.text.toLocaleLowerCase().indexOf(e)}));return o.length>0?(this._setPendingInfo(n,o[0].index,De(o[0])),o[0].index):-1},t.prototype._getFirstSelectedIndex=function(){var e=this.props.hoisted.selectedIndices;return(null===e||void 0===e?void 0:e.length)?e[0]:-1},t.prototype._getNextSelectableIndex=function(e,t){var n=this.props.hoisted.currentOptions,o=e+t;if(!Ce(n,o=Math.max(0,Math.min(n.length-1,o))))return-1;var i=n[o];if(!ke(i)||!0===i.hidden){if(t===ae.none||!(o>0&&t<ae.none||o>=0&&o<n.length&&t>ae.none))return e;o=this._getNextSelectableIndex(o,t)}return o},t.prototype._setSelectedIndex=function(e,t,n){void 0===n&&(n=ae.none);var o=this.props,i=o.onChange,r=o.onPendingValueChanged,a=o.hoisted,s=a.selectedIndices,l=a.currentOptions,c=s?s.slice():[],d=l.slice();if(Ce(l,e=this._getNextSelectableIndex(e,n))){if(this.props.multiSelect||c.length<1||1===c.length&&c[0]!==e){var u=(0,k.__assign)({},l[e]);if(!u||u.disabled)return;if(this.props.multiSelect)if(u.selected=void 0!==u.selected?!u.selected:c.indexOf(e)<0,u.itemType===ee.W.SelectAll)c=[],u.selected?l.forEach((function(e,t){!e.disabled&&ke(e)&&(c.push(t),d[t]=(0,k.__assign)((0,k.__assign)({},e),{selected:!0}))})):d=l.map((function(e){return(0,k.__assign)((0,k.__assign)({},e),{selected:!1})}));else{u.selected&&c.indexOf(e)<0?c.push(e):!u.selected&&c.indexOf(e)>=0&&(c=c.filter((function(t){return t!==e}))),d[e]=u;var p=d.filter((function(e){return e.itemType===ee.W.SelectAll}))[0];if(p){var h=this._isSelectAllChecked(c),m=d.indexOf(p);h?(c.push(m),d[m]=(0,k.__assign)((0,k.__assign)({},p),{selected:!0})):(c=c.filter((function(e){return e!==m})),d[m]=(0,k.__assign)((0,k.__assign)({},p),{selected:!1}))}}else c[0]=e;t.persist(),this.props.selectedKey||null===this.props.selectedKey||(this.props.hoisted.setSelectedIndices(c),this.props.hoisted.setCurrentOptions(d)),this._hasPendingValue&&r&&(r(),this._hasPendingValue=!1),i&&i(t,u,e,De(u))}this.props.multiSelect&&this.state.isOpen||this._clearPendingInfo()}},t.prototype._submitPendingValue=function(e){var t,n=this.props,o=n.onChange,i=n.allowFreeform,r=n.autoComplete,a=n.multiSelect,s=n.hoisted,l=s.currentOptions,c=this.state,d=c.currentPendingValue,u=c.currentPendingValueValidIndex,p=c.currentPendingValueValidIndexOnHover,h=this.props.hoisted.selectedIndices;if(!this._processingClearPendingInfo){if(i){if(null===d||void 0===d)return void(p>=0&&(this._setSelectedIndex(p,e),this._clearPendingInfo()));if(Ce(l,u)){var m=De(l[u]).toLocaleLowerCase(),g=this._autofill.current;if(d.toLocaleLowerCase()===m||r&&0===m.indexOf(d.toLocaleLowerCase())&&(null===g||void 0===g?void 0:g.isValueSelected)&&d.length+(g.selectionEnd-g.selectionStart)===m.length||(null===(t=null===g||void 0===g?void 0:g.inputElement)||void 0===t?void 0:t.value.toLocaleLowerCase())===m){if(this._setSelectedIndex(u,e),a&&this.state.isOpen)return;return void this._clearPendingInfo()}}if(o)o&&o(e,void 0,void 0,d);else{var f={key:d||(0,B.O)(),text:ye(d)};a&&(f.selected=!0);var v=l.concat([f]);h&&(a||(h=[]),h.push(v.length-1)),s.setCurrentOptions(v),s.setSelectedIndices(h)}}else u>=0?this._setSelectedIndex(u,e):p>=0&&this._setSelectedIndex(p,e);this._clearPendingInfo()}},t.prototype._onCalloutLayerMounted=function(){this._gotMouseMove=!1},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key;return t&&t>0?c.createElement("div",{role:"presentation",key:n,className:this._classNames.divider}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOptionContent:t;return c.createElement("div",{id:e.id,key:e.key,className:this._classNames.header},n(e,this._onRenderOptionContent))},t.prototype._renderCheckboxLabel=function(e){var t=this.props.onRenderOption;return(void 0===t?this._onRenderMultiselectOptionContent:t)(e,this._onRenderMultiselectOptionContent)},t.prototype._isOptionHighlighted=function(e){var t=this.state.currentPendingValueValidIndexOnHover;return t!==se.clearAll&&(t>=0?t===e:this._isOptionSelected(e))},t.prototype._isOptionSelected=function(e){return this._getPendingSelectedIndex(!0)===e},t.prototype._isOptionChecked=function(e){if(this.props.multiSelect&&void 0!==e&&this.props.hoisted.selectedIndices){return this.props.hoisted.selectedIndices.indexOf(e)>=0}return!1},t.prototype._isOptionIndeterminate=function(e){var t=this.props,n=t.multiSelect,o=t.hoisted;if(n&&void 0!==e&&o.selectedIndices&&o.currentOptions){var i=o.currentOptions[e];if(i&&i.itemType===ee.W.SelectAll)return o.selectedIndices.length>0&&!this._isSelectAllChecked()}return!1},t.prototype._isSelectAllChecked=function(e){var t=this.props,n=t.multiSelect,o=t.hoisted,i=o.currentOptions.find((function(e){return e.itemType===ee.W.SelectAll})),r=e||o.selectedIndices;if(!n||!r||!i)return!1;var a=o.currentOptions.indexOf(i),s=r.filter((function(e){return e!==a})),l=o.currentOptions.filter((function(e){return!e.disabled&&e.itemType!==ee.W.SelectAll&&ke(e)}));return s.length===l.length},t.prototype._getPendingSelectedIndex=function(e){var t=this.state,n=t.currentPendingValueValidIndex,o=t.currentPendingValue;return n>=0||e&&null!==o&&void 0!==o?n:this.props.multiSelect?-1:this._getFirstSelectedIndex()},t.prototype._scrollIntoView=function(){var e=this.props,t=e.onScrollToItem,n=e.scrollSelectedToTop,o=this._getPendingSelectedIndex(!0);if(t)t(o>=0?o:this._getFirstSelectedIndex());else{var i=this._selectedElement.current;if(this.props.multiSelect&&this._comboBoxMenu.current&&(i=ge(this._comboBoxMenu.current,(function(e){var t;return(null===(t=e.dataset)||void 0===t?void 0:t.index)===o.toString()}))),i&&i.offsetParent){var r=!0;if(this._comboBoxMenu.current&&this._comboBoxMenu.current.offsetParent){var a=this._comboBoxMenu.current.offsetParent,s=i.offsetParent,l=s.offsetHeight,c=s.offsetTop,d=a,u=d.offsetHeight,p=d.scrollTop,h=c+l>p+u;c<p||n?(r=!1,a.scrollTo(0,c)):h&&a.scrollTo(0,c-u+l)}else i.offsetParent.scrollIntoView(r)}}},t.prototype._onItemClick=function(e){var t=this,n=this.props.onItemClick,o=e.index;return function(i){t.props.multiSelect||(t._autofill.current&&t._autofill.current.focus(),t.setState({isOpen:!1})),n&&n(i,e,o),t._setSelectedIndex(o,i)}},t.prototype._resetSelectedIndex=function(){var e=this.props.hoisted.currentOptions;this._clearPendingInfo();var t=this._getFirstSelectedIndex();t>0&&t<e.length?this.props.hoisted.setSuggestedDisplayValue(e[t].text):this.props.text&&this.props.hoisted.setSuggestedDisplayValue(this.props.text)},t.prototype._clearPendingInfo=function(){this._processingClearPendingInfo=!0,this.props.hoisted.setSuggestedDisplayValue(void 0),this.setState({currentPendingValue:void 0,currentPendingValueValidIndex:-1,currentPendingValueValidIndexOnHover:se.default},this._onAfterClearPendingInfo)},t.prototype._setPendingInfo=function(e,t,n){void 0===t&&(t=-1),this._processingClearPendingInfo||(this.props.hoisted.setSuggestedDisplayValue(n),this.setState({currentPendingValue:ye(e),currentPendingValueValidIndex:t,currentPendingValueValidIndexOnHover:se.default}))},t.prototype._setPendingInfoFromIndex=function(e){var t=this.props.hoisted.currentOptions;if(e>=0&&e<t.length){var n=t[e];this._setPendingInfo(De(n),e,De(n))}else this._clearPendingInfo()},t.prototype._setPendingInfoFromIndexAndDirection=function(e,t){var n=this.props.hoisted.currentOptions;t===ae.forward&&e>=n.length-1?e=-1:t===ae.backward&&e<=0&&(e=n.length);var o=this._getNextSelectableIndex(e,t);e===o?t===ae.forward?e=this._getNextSelectableIndex(-1,t):t===ae.backward&&(e=this._getNextSelectableIndex(n.length,t)):e=o,Ce(n,e)&&this._setPendingInfoFromIndex(e)},t.prototype._notifyPendingValueChanged=function(e){var t=this.props.onPendingValueChanged;if(t){var n=this.props.hoisted.currentOptions,o=this.state,i=o.currentPendingValue,r=o.currentPendingValueValidIndex,a=o.currentPendingValueValidIndexOnHover,s=void 0,l=void 0;a!==e.currentPendingValueValidIndexOnHover&&Ce(n,a)?s=a:r!==e.currentPendingValueValidIndex&&Ce(n,r)?s=r:i!==e.currentPendingValue&&(l=i),(void 0!==s||void 0!==l||this._hasPendingValue)&&(t(void 0!==s?n[s]:void 0,s,l),this._hasPendingValue=void 0!==s||void 0!==l)}},t.prototype._setOpenStateAndFocusOnClose=function(e,t){this._focusInputAfterClose=t,this.setState({isOpen:e})},t.prototype._onOptionMouseEnter=function(e){this._shouldIgnoreMouseEvent()||this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._onOptionMouseMove=function(e){this._gotMouseMove=!0,this._isScrollIdle&&this.state.currentPendingValueValidIndexOnHover!==e&&this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._handleInputWhenDisabled=function(e){this.props.disabled&&(this.state.isOpen&&this.setState({isOpen:!1}),null!==e&&e.which!==P.c.tab&&e.which!==P.c.escape&&(e.which<112||e.which>123)&&(e.stopPropagation(),e.preventDefault()))},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0}),500)},t.prototype._getCaretButtonStyles=function(){var e=this.props.caretDownButtonStyles;return X(this.props.theme,e)},t.prototype._getCurrentOptionStyles=function(e){var t=this.props.comboBoxOptionStyles,n=e.styles;return Y(this.props.theme,t,n,this._isPendingOption(e),e.hidden,this._isOptionHighlighted(e.index))},t.prototype._getAriaAutoCompleteValue=function(){return!this.props.disabled&&"on"===this.props.autoComplete?this.props.allowFreeform?"inline":"both":"list"},t.prototype._isPendingOption=function(e){return e&&e.index===this.state.currentPendingValueValidIndex},t.prototype._hasFocus=function(){return"none"!==this.state.focusState},t.contextType=le._0,t=(0,k.__decorate)([(0,j.T)("ComboBox",["theme","styles"],!0)],t)}(c.Component);function ve(e,t){if(!e||!t)return[];var n={};e.forEach((function(e,t){e.selected&&(n[t]=!0)}));for(var o=function(t){var o=(0,H.SL)(e,(function(e){return e.key===t}));o>-1&&(n[o]=!0)},i=0,r=t;i<r.length;i++){o(r[i])}return Object.keys(n).map(Number).sort()}function be(e){return void 0===e?[]:e instanceof Array?e:[e]}function ye(e){return e||""}function Ce(e,t){return!!e&&t>=0&&t<e.length}function Se(e){return e.itemType!==ee.W.Header&&e.itemType!==ee.W.Divider&&e.itemType!==ee.W.SelectAll}function ke(e){return e.itemType!==ee.W.Header&&e.itemType!==ee.W.Divider}function De(e){return e.useAriaLabelAsText&&e.ariaLabel?e.ariaLabel:e.text}function xe(e){return e.which===P.c.alt||"Meta"===e.key}var Te=n(56415),Ee=n(93),we=n(66151),_e=n(72943);const Ie=(0,G.J9)(((e,t)=>{const n={root:[(0,we.NX)(e),(0,we.aS)(e),{":hover":[(0,we.Mi)(e),(0,_e.cP)()]}],rootHovered:[(0,we.Mi)(e),(0,we.aS)(e),{":hover":[(0,we.Mi)(e),(0,_e.cP)()]}],rootChecked:[(0,we.aS)(e),(0,we.Mi)(e),{":hover":(0,we.Mi)(e)}]};return(0,K.TW)(n,t)})),Pe=(0,G.J9)(((e,t)=>{const n={optionsContainerWrapper:{maxHeight:"400px"},rootHovered:[{".ms-ComboBox-Input":(0,we.aS)(e)}],rootFocused:[{".ms-ComboBox-Input":(0,we.aS)(e)}],header:[(0,we.NX)(e),(0,we.aS)(e),{textAlign:"left"}],label:(0,we.Ml)(e),input:[(0,we.aS)(e),{borderRadius:Ae(e),paddingTop:Re(e),backgroundColor:"transparent"}],root:[(0,we.aS)(e),e===m.Sx.TeamsContrast&&{borderColor:Te.z.White},{border:"none","> *":{backgroundColor:"transparent"},".ms-Button":[(0,we.Ml)(e),(0,we.wA)(e),{paddingRight:"10px",paddingTop:Re(e),backgroundColor:"transparent",":focus, :hover":{backgroundColor:"transparent",color:Le(e)},".ms-Button-icon":(0,_e.M8)()}],":focus, :active, :focus-within":[(0,we.oO)(e),(0,_e.lX)({borderColor:Ee.B.WindowText})],":hover":(0,_e.lX)({borderColor:Ee.B.WindowText}),"::after":{border:"none"},".is-open":(0,we.oO)(e)},(0,we.nK)(e)]};return(0,K.TW)(n,t)}));function Ae(e){switch(e){case m.Sx.TeamsContrast:case m.Sx.TeamsDark:case m.Sx.TeamsLight:return"3px";default:return""}}function Re(e){switch(e){case m.Sx.TeamsContrast:case m.Sx.TeamsDark:case m.Sx.TeamsLight:return"1px";default:return""}}function Le(e){switch(e){case m.Sx.Light:case m.Sx.TeamsLight:return Te.z.NeutralDark;case m.Sx.Dark:case m.Sx.TeamsDark:return Te.z.NeutralLight;case m.Sx.TeamsContrast:return Te.z.TeamsContrastHyperlinkColor;default:return""}}var Ne=n(74527);class Me extends d.${name(){return"ComboBox"}renderComponent(){var e;const{children:t,...n}={...this.props,buttonIconProps:Ne.Ju,comboBoxOptionStyles:Ie(this.props.appTheme,this.props.comboBoxOptionStyles),styles:Pe(this.props.appTheme,this.props.styles),calloutProps:{...this.props.calloutProps,className:(0,I.A)("plannerAppCallout",null===(e=this.props.calloutProps)||void 0===e?void 0:e.className)}};return c.createElement(me,n,t)}constructor(e,t){super(e,t)}}var Oe=n(8201),Be=n(46646),Fe=n(11034),je=n(65818),He=n(25588),ze=n(36060),Ue=n(8736),We=n(75472);const Ke="24px",Ge="8px",qe="10px",Ve="24px",Ze=(0,G.J9)((e=>({root:[{".comboBoxOption":[(0,we.gS)("row"),(0,we.GD)(),{alignItem:"center","> .icon":[(0,we.gS)(),(0,we.$Z)(Ve),we.cc,{marginRight:"8px",fontSize:K.s.small,color:Te.z.White,borderRadius:"2px"}],"> .icon.initialsWrapper":{width:Ve,height:Ve},"> .comboBoxText":[(0,we.GD)(),(0,we.q0)("ellipsis")]}],"&.is-checked":[(0,we.aS)(e),(0,we.Mi)(e)]}]}))),Ye=(0,G.J9)(((e,t)=>{const n={".copyButton, .cancelButton":{height:Ue.B.ButtonHeight,border:"none",":hover":{border:"none"}}},o={".ms-Label":[(0,we.Ml)(e),{fontSize:K.s.small}],"> .ms-ComboBox-container":{paddingBottom:Ke,"> .ms-ComboBox":{marginBottom:"0px"}},"> .ms-Dropdown-container":{paddingBottom:Ke}},i={margin:"".concat(Ge," 0px ").concat(Ge," ").concat((0,We.vb)(1.5*(0,We.jz)(Ge)))},r=[(0,we.GD)(),{fontSize:K.s.small,padding:qe,marginRight:Ke,"> .generalWarningMessage":{textOverflow:"ellipsis",overflow:"hidden","> a":{textDecoration:"none",":hover":{textDecoration:"underline"}}}}],a=[we.xK,{right:"0px",position:"absolute",margin:(0,We.vb)(1.5*(0,We.jz)(Ge)),fontSize:qe,":hover":{cursor:"pointer"}}],s=[(0,we.GD)(),{marginLeft:"36px",fontSize:K.s.small,display:"block",width:"100%","> ul > li":{listStyleType:"disc",marginLeft:(0,We.vb)(3*(0,We.jz)("5px")),"> span":{marginLeft:"-".concat("5px")}}}],l=[(0,we.gS)(),(0,we.wA)(e),{marginBottom:Ke,"> .infoIcon":i,"> .warningContent":r,"> .expandButton":a,"> .warningMessageDetails":s}],c={paddingBottom:Ke},d=[(0,we.aS)(e),{paddingBottom:"8px"}],u=[(0,we.Ml)(e),{paddingBottom:"16px",fontSize:K.s.small,"> a":{textDecoration:"none",":hover":{textDecoration:"underline"}}}],p={paddingTop:"2px",paddingBottom:"2px"},h=[{fontWeight:K.BO.semibold,fontSize:"10px"},(e===m.Sx.Light||e===m.Sx.TeamsLight||e===m.Sx.SharePoint)&&{color:Te.z.LightRed},(e===m.Sx.Dark||e===m.Sx.TeamsDark||e===m.Sx.TeamsContrast)&&{color:Te.z.DarkRed}],g={dialog:n,form:o,warningMessageBar:l,newTaskNameContainer:c,includeText:d,includeTextContent:u,checklistOptions:{fontSize:K.s.medium,paddingBottom:"20px","> .ms-Checkbox":p,"> .includeErrorContent":h}};return(0,K.TW)(g,t)})),Xe=(0,G.J9)((e=>({dialog:(0,K.Zq)("taskCopyAndMoveDialog",e.dialog),form:(0,K.Zq)("taskCopyAndMoveForm",e.form),warningMessageBar:(0,K.Zq)("warningMessageBar",e.warningMessageBar),newTaskNameContainer:(0,K.Zq)("newTaskName-Container",e.newTaskNameContainer),includeText:(0,K.Zq)("includeText",e.includeText),includeTextContent:(0,K.Zq)("includeTextContent",e.includeTextContent),checklistOptions:(0,K.Zq)("checklistOptions",e.checklistOptions)})));var $e,Je=n(55491),Qe=n.n(Je),et=n(98990),tt=n.n(et),nt=n(32520),ot=n.n(nt),it=n(33411),rt=n.n(it),at=n(54320),st=n.n(at),lt=n(19853),ct=n.n(lt),dt=n(21382),ut=n(44535),pt=n(27678),ht=n(86053),mt=n(28730);!function(e){e[e.Copy=0]="Copy",e[e.Move=1]="Move"}($e||($e={}));class gt extends d.${name(){return"TaskCopyAndMoveCustomizer"}componentDidMount(){null!==this._copyTaskElement&&this._copyTaskElement.getElementsByTagName("input")[0].select(),this.props.operationModeProps.fetchAllPlans()}componentDidUpdate(e,t){const{getBuckets:n,plan:o}=this.props.operationModeProps,i=o.id===this.state.options.plan.id,r=o.container.externalId===this.state.options.plan.container.externalId;let a={};if(null==t.options.bucketId&&null==this.state.options.bucketId||t.options.bucketId===this.fallbackBucketKey&&this.state.options.bucketId===this.fallbackBucketKey){const e=n(this.state.options.plan.id);null!==e&&void 0!==e&&e[0]&&(a={...a,bucketId:e[0].id})}t.options.copyLabels&&!i&&(a={...a,copyLabels:!1}),!t.options.copyAssignments&&!t.options.copyReferences||r||(a={...a,copyAssignments:!1,copyReferences:!1}),st()(a)||this.setState((e=>({...e,options:{...e.options,...a}})))}renderComponent(){const e=this.getComboBoxDestinationPlans(),t=this.props.operationModeProps.getBuckets(this.state.options.plan.id),n=[],o=this.getClassNames();return t&&t.forEach(((e,t)=>{n.push({index:t,selected:e.id===this.state.options.bucketId,key:e.id,text:e.title})})),0===n.length&&n.push({index:0,selected:this.state.options.bucketId===this.fallbackBucketKey,key:this.fallbackBucketKey,text:ht.p.Strings.SharedComponents_DefaultBucketName}),c.createElement("div",{className:o.dialog,ref:e=>this._copyTaskElement=e},c.createElement("form",{className:o.form,onSubmit:this.onActionButtonClick.bind(this),autoComplete:"off"},this.props.mode===$e.Copy&&this.renderTaskTitle(),this.props.mode===$e.Move&&this.renderWarningMessage(),c.createElement(Me,{className:"planTitle",label:ht.p.Strings.TaskCopyAndMoveCustomizer_CopyTaskPlanName,options:e,allowFreeform:!0,appTheme:this.props.theme,autoComplete:"on",useComboBoxAsMenuWidth:!0,onChange:(e,t)=>{this.onSelectedPlanChanged(t)},onRenderOption:this.props.mode===$e.Move?this.onRenderOption:void 0,selectedKey:this.state.options.plan.id,errorMessage:this.state.enteredInvalidPlan?ht.p.Strings.TaskCopyAndMoveCustomizer_InvalidPlanSelect:void 0,comboBoxOptionStyles:Ze(this.props.theme)}),c.createElement(Oe.m,{className:"bucketTitle",label:ht.p.Strings.TaskCopyAndMoveCustomizer_CopyTaskBucketName,options:n,onChange:(e,t)=>{this.onSelectedBucketChanged(t)},selectedKey:null==this.state.options.bucketId?this.fallbackBucketKey:this.state.options.bucketId,appTheme:this.props.theme}),this.props.mode===$e.Copy&&c.createElement(g.J,{className:o.includeText},ht.p.Strings.TaskCopyAndMoveCustomizer_CopyTaskIncludeLabel),c.createElement("div",{className:o.includeTextContent},this.props.mode===$e.Copy?ht.p.Strings.TaskCopyAndMoveCustomizer_IncludeSectionCopyText:ht.p.Strings.TaskCopyAndMoveCustomizer_IncludeSectionMoveText," ",c.createElement(f.N,{href:m.$j.copyAndMoveTasks,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.TaskCopyAndMoveCustomizer_IncludeSectionLearnMore)),this.props.mode===$e.Copy&&this.renderChecklist(),c.createElement(v.E,null,c.createElement(b.j,{className:"copyButton",onClick:this.onActionButtonClick.bind(this),disabled:""===this.state.options.title.trim()},this.props.mode===$e.Copy?ht.p.Strings.TaskCopyAndMoveCustomizer_CopyButtonText:ht.p.Strings.TaskCopyAndMoveCustomizer_MoveButtonText),c.createElement(y.Y,{className:"cancelButton",onClick:this.props.operationModeProps.onDismiss.bind(this)},ht.p.Strings.TaskCopyAndMoveCustomizer_CancelButtonText))))}onSelectedBucketChanged(e){this.setState((t=>({options:{...t.options,bucketId:e.key}})))}onSelectedPlanChanged(e){if(!e)return void this.setState({enteredInvalidPlan:!0});const t=this.props.operationModeProps.getBuckets(e.key);let n=null;this.props.operationModeProps.availablePlans.forEach((t=>{t.id===e.key&&(n=t)}));const o=!ct()(this.props.operationModeProps.plan.container.externalId,n.container.externalId);n?(this.props.operationModeProps.onPlanSelect(e.key),this.setState((e=>({options:{...e.options,bucketId:null==t||0===t.length?this.fallbackBucketKey:t[0].id,plan:n,moveToDifferentContainer:o},enteredInvalidPlan:!1})))):this.setState({enteredInvalidPlan:!0})}renderTaskTitle(){const e=this.getClassNames();return c.createElement("div",{className:e.newTaskNameContainer},c.createElement(g.J,{className:"newTaskName"},ht.p.Strings.TaskCopyAndMoveCustomizer_CopyTaskNewName),c.createElement(Be.A,{className:"taskTitle",placeholder:ht.p.Strings.TaskCopyAndMoveCustomizer_TaskNamePlaceholder,value:this.state.options.title,onChange:(e,t)=>{this.onTitleChanged(t)},styleType:Fe.u.Dialog,autoFocus:!0,appTheme:this.props.theme}))}renderWarningMessage(){const e=this.props.operationModeProps;let t="";const n=[],o=!ct()(e.plan.container.externalId,this.state.options.plan.container.externalId),i=!!e.hasComments&&o,r=e.plan.container.containerType===je.K.Roster&&o&&null!=this.getMeetingNoteContextLink(),a=e.task.numberOfReferences>0&&e.plan.container.containerType===je.K.Group&&o,s=!!o&&this.getNoAccessAssigneeList().length>0;if(!(e.isBulkMove||i||r||a||s))return null;if(t=e.isBulkMove?ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_BulkMoveWarning:ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_MoveWarning,e.isBulkMove||i){const t=e.isBulkMove?ht.p.Strings.TaskCopyAndMoveCustomizer_BulkMoveWarningMessage_Comments_Text:ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_Comments_Text;n.push(t)}if(e.isBulkMove||r){const t=e.isBulkMove?ht.p.Strings.TaskCopyAndMoveCustomizer_BulkMoveWarningMessage_Context_Text:dt.G(ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_Context_Text,ht.p.Strings.PlanContextLinking_MeetingNotes);n.push(t)}if(e.isBulkMove||s){let t="";const o=this.getNoAccessAssigneeList();for(let n=0;n<o.length;n++){const i=e.getUser(o[n]);null!==i&&void 0!==i&&i.displayName&&(n>0&&(t+=", "),t+=i.displayName)}const i=t||ht.p.Strings.TaskCopyAndMoveCustomizer_AssigneeNameFallbackText,r=e.isBulkMove?ht.p.Strings.TaskCopyAndMoveCustomizer_BulkMoveWarningMessage_Assignee_Text:dt.G(ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_Assignee_Text,i);n.push(r)}(e.isBulkMove||a)&&n.push(ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_Attachments_Text);const l=rt()(n,((e,t)=>c.createElement("li",{key:t.toString()},c.createElement("span",null,e)))),d=this.getClassNames();return c.createElement("div",{className:d.warningMessageBar},c.createElement("span",{className:"infoIcon"},c.createElement(C.I,Ne.UU)),c.createElement("div",{className:"warningContent"},c.createElement("div",{className:"generalWarningMessage"},t+" ",c.createElement(f.N,{href:m.$j.copyAndMoveTasks,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.TaskCopyAndMoveCustomizer_IncludeSectionLearnMore)),this.state.showExpandedWarningMessage&&c.createElement("div",{className:"warningMessageDetails"},c.createElement("br",null),c.createElement("ul",null,l))),c.createElement("button",{className:"expandButton","aria-label":ht.p.Strings.TaskCopyAndMoveCustomizer_WarningMessage_ShowMoreLabel,onKeyDown:this.onKeyDown,onClick:this.toggleMessageBar,"aria-expanded":this.state.showExpandedWarningMessage},c.createElement(C.I,this.state.showExpandedWarningMessage?Ne.jU:Ne.Ju)))}getNoAccessAssigneeList(){const e=this.props.operationModeProps,t=[],n=e.task.getAssigneeIds(),o=e.getContainerMembers(this.state.options.plan.container.externalId);return Qe()(n,(e=>{ot()(o,(t=>t.id===e))<0&&t.push(e)})),t}getMeetingNoteContextLink(){var e;const t=this.props.operationModeProps,n=t.plan,o=t.planDetails;if(st()(n.contexts)||!o)return null;const i=Object.keys(t.plan.contexts),r=ot()(i,(e=>{const t=o.contextDetails[e];return null!=t&&t.displayAs===He.s.MeetingNotes}));if(-1===r)return null;const a=i[r];return null!==(e=o.contextDetails[a].url)&&void 0!==e?e:null}renderChecklist(){var e,t;const{plan:n}=this.props.operationModeProps,o=n.id===this.state.options.plan.id,i=n.container.externalId===this.state.options.plan.container.externalId,r=this.getClassNames();return c.createElement("div",{className:r.checklistOptions},c.createElement(S.S,{checked:this.state.options.copyAssignments,label:ht.p.Strings.Task_AssignmentFieldText,onChange:this.onAssignmentsOptionChanged.bind(this),disabled:!i,appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyProgress,label:ht.p.Strings.Task_ProgressFieldText,onChange:this.onProgressOptionChanged.bind(this),appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyDates,label:ht.p.Strings.Task_DatesFieldText,onChange:this.onDatesOptionChanged.bind(this),appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyRecurrence,label:ht.p.Strings.Task_RecurrenceFieldText,onChange:this.onRecurrenceOptionChanged.bind(this),disabled:!(null!==(e=this.props.operationModeProps.task.recurrence)&&void 0!==e&&e.schedule&&this.state.options.copyDates),appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyDescription,label:ht.p.Strings.Task_DescriptionFieldText,onChange:this.onDescriptionOptionChanged.bind(this),appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyChecklist,label:ht.p.Strings.Task_ChecklistFieldText,onChange:this.onChecklistOptionChanged.bind(this),appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyReferences,label:ht.p.Strings.Task_AttachmentsFieldText,onChange:this.onAttachmentsOptionChanged.bind(this),disabled:!i,appTheme:this.props.theme}),c.createElement(S.S,{checked:this.state.options.copyLabels,label:ht.p.Strings.Task_LabelsFieldText,onChange:this.onLabelsOptionChanged.bind(this),disabled:!o,appTheme:this.props.theme}),(null===(t=this.props.operationModeProps.task.recurrence)||void 0===t?void 0:t.schedule)&&!this.state.options.copyDates&&c.createElement("div",{className:"includeErrorContent"},ht.p.Strings.TaskCopyAndMoveCustomizer_IncludeSectionCopyRecurrenceErrorLabel))}onActionButtonClick(e){e.preventDefault();const{plan:t}=this.props.operationModeProps,n={assignment:this.state.options.copyAssignments.toString(),progress:this.state.options.copyProgress.toString(),dates:this.state.options.copyDates.toString(),recurrence:this.state.options.copyRecurrence.toString(),description:this.state.options.copyDescription.toString(),checklist:this.state.options.copyChecklist.toString(),attachments:this.state.options.copyReferences.toString(),labels:this.state.options.copyLabels.toString(),planId:t.id,destinationPlanId:this.state.options.plan.id,copiedToOtherBoard:(t.id!==this.state.options.plan.id).toString(),bucketId:this.state.options.bucketId||"null",containerId:t.container.externalId,containerType:t.container.containerType.toString(),destinationContainerId:this.state.options.plan.container.externalId,destinationContainerType:this.state.options.plan.container.containerType.toString()};switch(this.props.mode){case $e.Copy:this.logUsage("copyTask",n),this.props.operationModeProps.onCopyTask(this.state.options),this.props.operationModeProps.onDismiss();break;case $e.Move:this.logUsage("moveTask",n),this.props.operationModeProps.onMoveTask(this.state.options),this.props.operationModeProps.onDismiss()}}onAssignmentsOptionChanged(){const e=this.state.options.copyAssignments;this.setState((t=>({...t,options:{...t.options,copyAssignments:!e}})))}onProgressOptionChanged(){const e=this.state.options.copyProgress;let t=this.state.options.copyRecurrence;e||100!==this.props.operationModeProps.task.percentComplete||(t=!1),this.setState((n=>({...n,options:{...n.options,copyProgress:!e,copyRecurrence:t}})))}onDatesOptionChanged(){const e=this.state.options.copyDates;let t=this.state.options.copyRecurrence;e&&(t=!1),this.setState((n=>({...n,options:{...n.options,copyDates:!e,copyRecurrence:t}})))}onRecurrenceOptionChanged(){const e=this.state.options.copyRecurrence;let t=this.state.options.copyProgress;!e&&t&&100===this.props.operationModeProps.task.percentComplete&&(t=!1),this.setState((n=>({...n,options:{...n.options,copyRecurrence:!e,copyProgress:t}})))}onDescriptionOptionChanged(){const e=this.state.options.copyDescription;this.setState((t=>({...t,options:{...t.options,copyDescription:!e}})))}onChecklistOptionChanged(){const e=this.state.options.copyChecklist;this.setState((t=>({...t,options:{...t.options,copyChecklist:!e}})))}onAttachmentsOptionChanged(){const e=this.state.options.copyReferences;this.setState((t=>({...t,options:{...t.options,copyReferences:!e}})))}onLabelsOptionChanged(){const e=this.state.options.copyLabels;this.setState((t=>({...t,options:{...t.options,copyLabels:!e}})))}onTitleChanged(e){switch(this.props.mode){case $e.Copy:case $e.Move:this.setState((t=>({options:{...t.options,title:e}})))}}validateProps(){const{operationModeProps:e}=this.props;if(null==e.fetchAllPlans)throw new Error("ArgumentNullException: Props.fetchAllPlans")}getComboBoxDestinationPlans(){const{operationModeProps:e}=this.props,t=[];let n=0;const o={};return e.favoritePlans.length>0&&(t.push({text:ht.p.Strings.TaskCopyAndMoveCustomizer_PinnedHeaderText,itemType:ee.W.Header,key:"favorites"}),e.favoritePlans.forEach((e=>{t.push({key:e.id,text:e.title,selected:e.id===this.state.options.plan.id,index:n++}),o[e.id]=e.title}))),e.recentPlans.length>0&&(t.push({text:ht.p.Strings.TaskCopyAndMoveCustomizer_RecentsHeaderText,itemType:ee.W.Header,key:"recents"}),e.recentPlans.forEach((e=>{null==o[e.id]&&(t.push({key:e.id,text:e.title,selected:e.id===this.state.options.plan.id,index:n++}),o[e.id]=e.title)}))),t.push({text:ht.p.Strings.TaskCopyAndMoveCustomizer_AllHeaderText,itemType:ee.W.Header,key:"all"}),e.availablePlans.sort(((e,t)=>mt.l.compareStringForDisplay(e.title,t.title))),e.availablePlans.forEach((e=>{null==o[e.id]&&(t.push({key:e.id,text:e.title,selected:e.id===this.state.options.plan.id,index:n++}),o[e.id]=e.title)})),t}getClassNames(){const{theme:e,styles:t}=this.props;return Xe(Ye(e,t))}constructor(e,t){super(e,t),this.fallbackBucketKey="todo",this.onRenderOption=e=>{const t=e.key,n=this.props.operationModeProps.getPlanImage(t);let o;if(n)o=c.createElement("img",{src:n,className:"icon",alt:""});else{var i;const e=tt()(this.props.operationModeProps.availablePlans,(e=>e.id===t)),n=null!==(i=null===e||void 0===e?void 0:e.title)&&void 0!==i?i:"",r=ut.$.parseInitialsFromName(n),a=(0,ze.K)((0,pt.wV)(n));o=c.createElement("span",{className:"icon initialsWrapper "+a},r)}return c.createElement("div",{className:"comboBoxOption"},o,c.createElement("span",{className:"comboBoxText"},e.text))},this.toggleMessageBar=e=>{e.preventDefault(),e.stopPropagation(),this.logUsage("Interacted with warning message expand button"),this.setState((e=>({...e,showExpandedWarningMessage:!e.showExpandedWarningMessage})))},this.onKeyDown=e=>{e.keyCode!==h.D.TAB&&e.keyCode!==h.D.ESCAPE&&(e.preventDefault(),e.stopPropagation()),e.keyCode!==h.D.SPACE&&e.keyCode!==h.D.ENTER||(this.logUsage("Interacted with warning message expand button"),this.setState((e=>({...e,showExpandedWarningMessage:!e.showExpandedWarningMessage}))))},this.validateProps();const{getBuckets:n,task:o,plan:i}=e.operationModeProps;let r=o.bucketId;if(null==r){const e=n(i.id);e&&e.length>0&&(r=e[0].id)}this.state={options:{title:o.title,copyAssignments:!!this.props.operationModeProps.enforceAssignmentsCopy&&this.props.operationModeProps.enforceAssignmentsCopy,copyProgress:!1,copyDates:!1,copyRecurrence:!1,copyDescription:!0,copyChecklist:!0,copyReferences:!0,copyLabels:!0,bucketId:r,plan:i,moveToDifferentContainer:!1},enteredInvalidPlan:!1,showExpandedWarningMessage:!1}}}var ft=n(75104);const vt=(0,G.J9)((e=>{const t={main:{maxWidth:Ue.B.MaxSecondaryDialogWidth,width:Ue.B.SecondaryDialogWidth,"@media (min-width: 480px)":{maxWidth:Ue.B.MaxSecondaryDialogWidth,width:Ue.B.SecondaryDialogWidth}}};return(0,ft.S9)(e,t)})),bt=(0,G.J9)((e=>{const t={title:{fontSize:K.s.large,fontWeight:K.BO.semibold}};return(0,ft.XK)(e,t)}));class yt extends d.${name(){return"CopyAndMoveTaskDialog"}renderComponent(){let e="";this.props.copyAndMoveTaskCustomizerProps.mode===$e.Copy?e=ht.p.Strings.TaskCopyAndMoveCustomizer_CopyTaskLabel:this.props.copyAndMoveTaskCustomizerProps.mode===$e.Move&&(e=ht.p.Strings.TaskCopyAndMoveCustomizer_MoveTaskLabel);const t=vt(this.props.copyAndMoveTaskCustomizerProps.theme),n=bt(this.props.copyAndMoveTaskCustomizerProps.theme);return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss.bind(this),dialogContentProps:{type:p.h.close,className:this.props.dialogContentClassName,title:e,styles:n},styles:t,modalProps:{className:this.props.dialogClassName,containerClassName:(0,I.A)(this.props.dialogContainerClassName,"taskCopyAndMoveDialogContainer"),isBlocking:!1,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps}},c.createElement(gt,this.props.copyAndMoveTaskCustomizerProps))}constructor(e,t){super(e,t)}}var Ct,St=n(45630);!function(e){e.mainDialogMaxWidth="800px",e.mainDialogMinWidth="300px",e.mainDialogWidth="70%",e.maxSecondaryDialogWidth="560px",e.secondaryDialogWidth="35%",e.templateModalHorizontalMargin=60,e.templateModalBackButtonMargin=25,e.templateModalCloseButtonMargin=25,e.templateModalVerticalMargin=33,e.templateModalHeight=575}(Ct||(Ct={}));var kt=n(53815);const Dt=(0,G.J9)(((e,t)=>{const n={taskChoice:[{".ms-ChoiceField-field.is-checked, .ms-ChoiceField-field.is-checked:before, .ms-ChoiceField-field.is-checked:after":[(0,we.T4)(e)],".ms-ChoiceFieldLabel":[(0,we.aS)(e),{fontSize:kt.s.medium}]}]};return(0,K.TW)(n,t)})),xt=(0,G.J9)(((e,t)=>{const n=Dt(e,t);return{taskChoice:(0,K.Zq)("deleteTaskChoice",n.taskChoice)}})),Tt=(0,G.J9)((e=>{const t={main:{maxWidth:Ct.maxSecondaryDialogWidth,width:Ct.secondaryDialogWidth,"@media (min-width: 480px)":{maxWidth:Ct.maxSecondaryDialogWidth,width:Ct.secondaryDialogWidth}}};return(0,ft.S9)(e,t)})),Et=(0,G.J9)((e=>{const t={title:{fontSize:kt.s.large,fontWeight:kt.BO.semibold}};return(0,ft.XK)(e,t)}));var wt;!function(e){e.Task="task",e.Series="series"}(wt||(wt={}));class _t extends d.${name(){return"DeleteRecurringTaskDialog"}renderComponent(){const e=this.getClassNames(),t=Tt(this.props.theme),n=Et(this.props.theme);return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss.bind(this),dialogContentProps:{type:p.h.close,className:this.props.dialogContentClassName,title:ht.p.Strings.DeleteRecurringTaskDialog_DeleteTaskTitle,styles:n},styles:t,modalProps:{className:(0,I.A)(this.props.dialogClassName,"deleteRecurringTaskDialog"),containerClassName:(0,I.A)(this.props.dialogContainerClassName,"taskDeleteDialogContainer"),isBlocking:!1,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps}},c.createElement("div",null,c.createElement(St.n,{className:e.taskChoice,selectedKey:this.state.deleteOption,options:this.deleteOptionList,onChange:this.onDeleteOptionChange}),c.createElement(v.E,null,c.createElement(b.j,{className:"deleteTaskButton",onClick:this.deleteTask.bind(this)},ht.p.Strings.DeleteRecurringTaskDialog_DeleteTaskDone),c.createElement(y.Y,{className:"cancelDelete",onClick:this.props.onDismiss.bind(this)},ht.p.Strings.DeleteRecurringTaskDialog_DeleteTaskCancel))))}deleteTask(){switch(this.state.deleteOption){case wt.Task:this.props.deleteTask();break;case wt.Series:this.props.deleteTaskSeries()}}getClassNames(){return xt(this.props.theme,this.props.contentStyles)}constructor(e,t){super(e,t),this.onDeleteOptionChange=(e,t)=>{this.setState({deleteOption:t.key})},this.state={deleteOption:wt.Task},this.deleteOptionList=[{key:wt.Task,className:wt.Task,text:ht.p.Strings.DeleteRecurringTaskDialog_DeleteTaskOptionForTask},{key:wt.Series,className:wt.Series,text:ht.p.Strings.DeleteRecurringTaskDialog_DeleteTaskOptionForSeries}]}}var It=n(19664),Pt=n(40729);const At=(0,G.J9)((e=>{const t=(0,we.aS)(e);return{content:[{".message":{fontSize:K.s.medium},".okButton":(0,we.jU)(e),".cancelButton":(0,we.i9)(e),ul:{margin:"0",padding:"0"},li:{listStyleType:"none"}}],title:t,button:{":hover":{backgroundColor:"inherit"}}}})),Rt=(0,G.J9)((e=>{const t=Pt.d.isLoopTheme(e);return{main:[(0,we.aS)(e),(0,we.dg)(e),{width:Ct.mainDialogWidth,maxWidth:Ct.maxSecondaryDialogWidth,minWidth:Ct.mainDialogMinWidth,"@media (min-width: 480px)":{maxWidth:"700px",width:"50%",minWidth:"300px"}},e===m.Sx.TeamsContrast&&{borderWidth:"1px",borderColor:Te.z.White,borderStyle:"solid"}],root:[t&&{position:"absolute"}]}}));var Lt=n(74719);class Nt extends d.${name(){return"ShareFileWarningDialog"}renderComponent(){var e;const{sharedWithContainers:t,getDriveItem:n,getDriveItemStatus:o,theme:i}=this.props,r=(0,Lt.qg)({sharedWithContainers:t,getDriveItemStatus:o,getDriveItem:n},i,this.context.traceLogger),a=null!==(e=null===r||void 0===r?void 0:r.sharedContainerItems)&&void 0!==e?e:[],s=c.createElement("ul",null,a.map(((e,t)=>c.createElement("li",{key:t},c.createElement(It.S,e)))));return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{showCloseButton:!0,className:this.props.dialogContentClassName,title:ht.p.Strings.ShareFileWarningDialog_ShareFileAndAssignTaskWarningTitle,styles:At(this.props.theme)},modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1,elementToFocusOnDismiss:this.props.elementToFocusOnDismiss,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps},styles:Rt(this.props.theme)},s,c.createElement("div",{className:"message"},ht.p.Strings.ShareFileWarningDialog_ShareFileAndAssignTaskWarningMessage),c.createElement(v.E,null,c.createElement(b.j,{className:"okButton",onClick:this.onClick},ht.p.Strings.ShareFileWarningDialog_ShareFileAndAssignTaskOK),c.createElement(y.Y,{className:"cancelButton",onClick:this.props.onDismiss},ht.p.Strings.ShareFileWarningDialog_ShareFileAndAssignTaskCancel)))}constructor(e,t){super(e,t),this.onClick=()=>{const{sharedWithContainers:e,onOK:t}=this.props;t(e.length>0?e[0].externalId:"")}}}var Mt=n(96891);class Ot extends d.${name(){return Mt.M.ErrorDialog}renderComponent(){return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,title:this.props.errorHeader,type:p.h.normal,styles:(0,ft.XK)(this.props.theme)},styles:(0,ft.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps}},c.createElement("div",null,this.props.errorMessage),st()(this.props.correlationId)?null:c.createElement("div",null," ",dt.G(ht.p.Strings.ErrorDialog_CorrelationIdText,this.props.correlationId)," "),c.createElement(v.E,null,c.createElement(b.j,{onClick:this.props.onDismiss},ht.p.Strings.ErrorDialog_OkButtonText)))}constructor(e,t){super(e,t)}}class Bt extends d.${name(){return"InfoDialog"}renderComponent(){return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,title:this.props.headerText,type:p.h.normal,styles:(0,ft.XK)(this.props.theme)},styles:(0,ft.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:(0,I.A)("infoDialog",this.props.dialogContainerClassName),isBlocking:!1,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps}},this.props.message,c.createElement(v.E,null,c.createElement(b.j,{onClick:this.props.onButtonClick||this.props.onDismiss},this.props.buttonText||ht.p.Strings.InfoDialog_OkButtonText)))}constructor(e,t){super(e,t)}}var Ft=n(42870),jt=n(70149);const Ht=()=>(0,jt.L)((()=>n.e(75990).then(n.bind(n,19456)))).then((e=>({default:e.FormRequirementIframeDialog}))),zt=(0,c.lazy)(Ht);class Ut extends Ft.M{async fetchCriticalData(e,t){}fetchNonCriticalData(e,t){}checkForCriticalDataReady(){return!0}name(){return Mt.M.FormsRequirementsIframeDialog}renderComponent(){const{onDismiss:e,dialogContainerClassName:t,theme:n,urlFormId:o,planNameforTask:i}=this.props;return c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(zt,{formTokenProvider:this.props.formsTokenProvider,onFormResponseIdReceived:e=>{this.props.onFormResponseIdReceived(e)},urlFormId:o,onDismiss:e,dialogContentClassName:t,dialogContainerClassName:t,theme:n,planNameforTask:i}))}}var Wt=n(96481),Kt=n(38752),Gt=n(64327),qt=n(45795),Vt=n(64226),Zt=n(5099),Yt=n(15018),Xt=n(15987),$t=n(54276),Jt=n(11910),Qt=n(50204),en=n(72721),tn=n(9011),nn=n(40488),on=n(57433),rn=n(40787);const an="10px",sn=(0,We.vb)((0,We.jz)(Ue.B.userBubbleDiameter)+(0,We.jz)(an)),ln=(0,G.J9)(((e,t)=>{const n={root:[(0,we.gS)(),{padding:"20px 0px"}],body:[(0,we.GD)(),(0,we.gS)("column")],header:[(0,we.$Z)(),(0,we.gS)()],commenterIcon:[(0,we.$Z)(),{height:Ue.B.userBubbleDiameter}],commenterName:[(0,we.GD)(),(0,we.Ml)(e),(0,we.q0)(),{padding:"0px ".concat(an),alignSelf:"center",fontSize:K.s.small}],timestamp:[(0,we.$Z)(),(0,we.Ml)(e),(0,we.q0)(),{alignSelf:"center",fontSize:K.s.small,textAlign:"right"}],content:[(0,we.$Z)(),(0,we.aS)(e),{fontSize:K.s.medium,padding:"0px ".concat(sn),wordWrap:"break-word",'> .htmlContent [id$="hideInPlanner"]':{display:"none"}}]};return(0,K.TW)(n,t)})),cn=(0,G.J9)((e=>({root:(0,K.Zq)("commentCard",e.root),body:(0,K.Zq)("body",e.body),header:(0,K.Zq)("header",e.header),commenterIcon:(0,K.Zq)("commenterIcon",e.commenterIcon),commenterName:(0,K.Zq)("commenterName",e.commenterName),timestamp:(0,K.Zq)("timestamp",e.timestamp),content:(0,K.Zq)("content",e.content)})));var dn=n(34167);class un extends d.${name(){return"CommentCard"}renderComponent(){var e,t;const{comment:n,commenter:o,commentType:i}=this.props,r=this.getClassNames(),a=null!==(e=null===o||void 0===o?void 0:o.displayName)&&void 0!==e?e:ht.p.Strings.CommentThreadView_UnknownUserLabel,s=null!==(t=null===o||void 0===o?void 0:o.formattedDisplayName)&&void 0!==t?t:ht.p.Strings.CommentThreadView_UnknownUserLabel;return c.createElement("div",{className:r.root,"data-is-focusable":!0},c.createElement("div",{className:r.body},c.createElement("div",{className:r.header},c.createElement("div",{className:r.commenterIcon,tabIndex:-1},this.renderCommenterPersona(a,s)),c.createElement("div",{className:r.commenterName},s),this.renderTimeStampOrSpinner(r)),this.renderCommentContent(r,n,i)))}renderCommenterPersona(e,t){const{commenter:n,commentId:o,commenterPhoto:i,onRenderPersona:r}=this.props,a={text:t,imageUrl:null!==i&&void 0!==i?i:void 0,imageShouldFadeIn:!0,hidePersonaDetails:!0,size:en.WH.extraSmall};return c.createElement(rn.f,{user:n,onLoad:r,containerId:"userContainer-commentCard-".concat(o,"-").concat(null===n||void 0===n?void 0:n.id)},c.createElement(tn.F,a))}renderCommentContent(e,t,n){switch(n){case $t.c.Text:return c.createElement("div",{className:e.content},t);case $t.c.HTML:const n=this.sanitizeHtmlContent(t);return c.createElement("div",{className:e.content},c.createElement("div",{className:"htmlContent",dangerouslySetInnerHTML:{__html:n}}));default:return null}}sanitizeHtmlContent(e){const t=new dn.tR;return t.inputString=e,dn.xC.sanitize(t).replace(/(&nbsp;)/g," ")}renderTimeStampOrSpinner(e){const{commentTime:t}=this.props;return null!=t?c.createElement("div",{className:e.timestamp},t.format("LLL")):c.createElement("div",{className:e.timestamp},c.createElement(nn.y,{size:on.H.xSmall}))}getClassNames(){const{theme:e,styles:t}=this.props;return cn(ln(e,t))}constructor(e,t){super(e,t)}}var pn=n(4705);const hn=(0,G.J9)(((e,t)=>{const n={root:[(0,we.gS)("column"),{paddingTop:"20px",paddingBottom:"5px","> *":(0,we.$Z)()},e===m.Sx.SharePoint&&{backgroundColor:Te.z.SharepointBackgroundColor()}],threadViewLabel:(0,pn.oQ)(e),newCommentSection:[(0,we.gS)("column"),{"> *":(0,we.$Z)(),"> .commentLoadError":[(0,we.Ml)(e),{fontSize:K.s.small}]}],commentBox:[(0,_e.kE)(),{"> textarea":[e===m.Sx.SharePoint&&{color:Te.z.SharepointTitleFontColor()}]}],sendCommentButton:[(0,we.$Z)(),(0,we.DC)(e),{alignSelf:"flex-end",margin:"12px 0px 15px",fontSize:K.s.small,fontWeight:K.BO.semibold},e===m.Sx.SharePoint&&[{color:Te.z.SharepointTitleFontColor(),backgroundColor:Te.z.SharepointAddTaskButtonBackgroundColor(),":enabled":{backgroundColor:Te.z.SharepointLightBackgroundColor(),borderColor:Te.z.NeutralLight,boxShadow:Ue.B.ButtonShadow,":focus, :hover":{color:Te.z.SharepointTitleFontColor(),backgroundColor:Te.z.SharepointBackgroundColor()}}}]],expandCommentsSection:[(0,we.q0)(),{marginTop:"20px",padding:"10px 0px",textAlign:"center",color:Te.z.ThemeSecondary,borderTop:"1px solid",cursor:"pointer"},e===m.Sx.Light&&{borderColor:Te.z.NeutralSecondary},e===m.Sx.Dark&&{borderColor:Te.z.NeutralLighterAlt}]};return(0,K.TW)(n,t)})),mn=(0,G.J9)((e=>({root:(0,K.Zq)("commentThreadView",e.root),threadViewLabel:(0,K.Zq)("threadViewLabel",e.threadViewLabel),newCommentSection:(0,K.Zq)("newCommentSection",e.newCommentSection),commentBox:(0,K.Zq)("commentBox",e.commentBox),sendCommentButton:(0,K.Zq)("sendCommentButton",e.sendCommentButton),expandCommentsSection:(0,K.Zq)("expandCommentsSection",e.expandCommentsSection)})));var gn=n(39829),fn=n.n(gn),vn=n(88880);class bn extends d.${name(){return"CommentThreadView"}renderComponent(){const e=this.getClassNames(),t=this.getRenderableCommentThread(),n=this.renderNewCommentSection(e);return c.createElement("div",{className:e.root,ref:this.resolveRef(this,"commentThreadViewElement")},c.createElement(g.J,{className:e.threadViewLabel},ht.p.Strings.CommentThreadView_ThreadViewLabel),n,c.createElement("ul",null,rt()(t,(e=>{let t=this.getCommenter(e.fromField.emailAddress.address);const n=null!=t?this.props.commentViewCallbacks.getUserPhoto(t.id):m.S1.Photo;if(null==t&&e.fromField.emailAddress.name&&e.fromField.emailAddress.address&&(t=Qt.K.builder.withPropertyBag({displayName:e.fromField.emailAddress.name,id:e.fromField.emailAddress.address}).build()),null!=e.body){let o=e.body.content;e.body.contentType===$t.c.HTML&&(o=vn.i.getPlainTextFromHTMLContent(o));const i=null!=e.sender?dt.G(ht.p.Strings.CommentThreadView_CommentCardCreatedByAriaLabelPart,e.sender.emailAddress.name):"",r=null!=e.createdDateTime?dt.G(ht.p.Strings.CommentThreadView_CommentCardCreatedDateAriaLabelPart,e.createdDateTime.format("LLL")):"",a=dt.G(ht.p.Strings.CommentThreadView_CommentCardAriaLabel,i,r,o);return c.createElement("li",{key:e.id,"aria-label":a},c.createElement(un,{comment:e.body.content,commentId:e.id,commenter:t,commenterPhoto:null!==n&&void 0!==n?n:null,commentTime:e.createdDateTime,commentType:e.body.contentType,onRenderPersona:this.props.commentViewCallbacks.onRenderPersona,theme:this.props.theme}))}return null}))),this.renderExpandCommentsSection(e))}renderNewCommentSection(e){const t=c.createElement(g.J,{className:"commentLoadError"},ht.p.Strings.CommentThreadView_CommentsLoadError),n=this.props.showLoadingError?t:null,o=0===fn()(this.state.typedComment).length||this.props.disabled;return c.createElement("div",{className:e.newCommentSection},c.createElement(Be.A,{autoAdjustHeight:!0,className:e.commentBox,multiline:!0,value:this.state.typedComment,placeholder:ht.p.Strings.CommentThreadView_CommentBoxPlaceholder,resizable:!1,onChange:(e,t)=>{this.onCommentChanged(t)},styleType:Fe.u.Dialog,ariaLabel:ht.p.Strings.CommentThreadView_CommentBoxAriaLabel,disabled:this.props.disabled,title:this.props.disabled?ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:void 0,appTheme:this.props.theme}),n,c.createElement("button",{"aria-label":ht.p.Strings.CommentThreadView_SendCommentButtonLabel,className:e.sendCommentButton,disabled:o,title:this.props.disabled?ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:void 0,onClick:this.onSendComment_Click.bind(this)},ht.p.Strings.CommentThreadView_SendCommentButtonLabel))}renderExpandCommentsSection(e){return this.state.isCollapsed?c.createElement("div",{className:e.expandCommentsSection,onClick:this.toggleThreadView,"aria-label":dt.G(ht.p.Strings.CommentThreadView_ExpandCommentsSectionTextAriaLabel,this.props.commentThread.length.toString()),role:"button",tabIndex:0},dt.G(ht.p.Strings.CommentThreadView_ExpandCommentsSectionText,this.props.commentThread.length.toString())):null}getCommenter(e){return st()(e)?null:this.props.commentViewCallbacks.getUserByEmail(e)}getRenderableCommentThread(){let e;const t=this.props.commentThread.slice().reverse();return e=this.state.isCollapsed?t.slice(0,this.props.collapseThreshold):t,e}onCommentChanged(e){this.setState((t=>({...t,typedComment:e})))}onSendComment_Click(){const e=vn.i.escapeCommentText(this.state.typedComment)+(null==this.props.task.conversationThreadId?vn.i.getFirstCommentEmailContent(this.props.taskLink,this.props.planLink,this.props.planTitle):vn.i.getCommentReplyEmailContent(this.props.taskLink,this.props.task.title,this.props.planLink,this.props.planTitle)),t=Jt.L.generatePostBody(e),n=Jt.L.builder.withPropertyBag({body:t,conversationId:void 0,conversationThreadId:void 0,hasAttachments:!1,fromField:{emailAddress:{address:this.props.currentUser.mail,name:this.props.currentUser.displayName}}}).withLocallyUniqueId().build();this.onCommentChanged("");const o=this.commentThreadViewElement.getElementsByTagName("textarea");st()(o)||o[0].focus(),this.props.commentViewCallbacks.postComment(n)}getClassNames(){const{theme:e,styles:t}=this.props;return mn(hn(e,t))}constructor(e,t){super(e,t),this.toggleThreadView=()=>{this.setState((e=>({...e,isCollapsed:!e.isCollapsed})))},this.state={isCollapsed:this.props.commentThread.length>this.props.collapseThreshold,typedComment:""}}}var yn=n(77181),Cn=n(65804),Sn=n(89379);function kn(e,t,n){void 0===n&&(n=10);var o=Math.pow(n,t);return Math.round(e*o)/o}var Dn,xn=n(21979),Tn=(0,G.J9)((function(e){var t,n=e.semanticColors,o=n.disabledText,i=n.disabledBackground;return{backgroundColor:i,pointerEvents:"none",cursor:"default",color:o,selectors:(t={":after":{borderColor:i}},t[K.up]={color:"GrayText"},t)}})),En=(0,G.J9)((function(e,t,n){var o,i,r,a=e.palette,s=e.semanticColors,l=e.effects,c=a.neutralSecondary,d=s.buttonText,u=s.buttonText,p=s.buttonBackgroundHovered,h=s.buttonBackgroundPressed,m={root:{outline:"none",display:"block",height:"50%",width:23,padding:0,backgroundColor:"transparent",textAlign:"center",cursor:"default",color:c,selectors:{"&.ms-DownButton":{borderRadius:"0 0 ".concat(l.roundedCorner2," 0")},"&.ms-UpButton":{borderRadius:"0 ".concat(l.roundedCorner2," 0 0")}}},rootHovered:{backgroundColor:p,color:d},rootChecked:{backgroundColor:h,color:u,selectors:(o={},o[K.up]={backgroundColor:"Highlight",color:"HighlightText"},o)},rootPressed:{backgroundColor:h,color:u,selectors:(i={},i[K.up]={backgroundColor:"Highlight",color:"HighlightText"},i)},rootDisabled:{opacity:.5,selectors:(r={},r[K.up]={color:"GrayText",opacity:1},r)},icon:{fontSize:8,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0}};return(0,K.TW)(m,{},n)}));!function(e){e[e.down=-1]="down",e[e.notSpinning=0]="notSpinning",e[e.up=1]="up"}(Dn||(Dn={}));var wn=n(15199),_n=n(2196),In=n(40440),Pn=n(58847),An=(0,Sn.Z)(),Rn={disabled:!1,label:"",step:1,labelPosition:xn.y.start,incrementButtonIcon:{iconName:"ChevronUpSmall"},decrementButtonIcon:{iconName:"ChevronDownSmall"}},Ln=function(){},Nn=function(e,t){var n=t.min,o=t.max;return"number"===typeof o&&(e=Math.min(e,o)),"number"===typeof n&&(e=Math.max(e,n)),e},Mn=c.forwardRef((function(e,t){var n=(0,T.N)(Rn,e),o=n.disabled,i=n.label,r=n.min,a=n.max,s=n.step,l=n.defaultValue,d=n.value,u=n.precision,p=n.labelPosition,h=n.iconProps,m=n.incrementButtonIcon,f=n.incrementButtonAriaLabel,v=n.decrementButtonIcon,b=n.decrementButtonAriaLabel,y=n.ariaLabel,S=n.ariaDescribedBy,D=n.upArrowButtonStyles,x=n.downArrowButtonStyles,E=n.theme,w=n.ariaPositionInSet,_=n.ariaSetSize,I=n.ariaValueNow,A=n.ariaValueText,R=n.className,L=n.inputProps,N=n.onDecrement,M=n.onIncrement,O=n.iconButtonProps,B=n.onValidate,j=n.onChange,H=n.styles,z=c.useRef(null),U=(0,wn.B)("input"),W=(0,wn.B)("Label"),K=c.useState(!1),G=K[0],q=K[1],V=c.useState(Dn.notSpinning),Z=V[0],Y=V[1],X=(0,_n.Y)(),$=c.useMemo((function(){return null!==u&&void 0!==u?u:Math.max(function(e){var t=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return t?t[1]?-t[1].length:t[2]?t[2].length:0:0}(s),0)}),[u,s]),J=(0,In.k)(d,null!==l&&void 0!==l?l:String(r||0),j),Q=J[0],ee=J[1],te=c.useState(),oe=te[0],ie=te[1],re=c.useRef({stepTimeoutHandle:-1,latestValue:void 0,latestIntermediateValue:void 0}).current;re.latestValue=Q,re.latestIntermediateValue=oe;var ae=(0,Pn.Z)(d);c.useEffect((function(){d!==ae&&void 0!==oe&&ie(void 0)}),[d,ae,oe]);var se=An(H,{theme:E,disabled:o,isFocused:G,keyboardSpinDirection:Z,labelPosition:p,className:R}),le=(0,F.G1)(n,F.JM,["onBlur","onFocus","className","onChange"]),ce=c.useCallback((function(e){var t=re.latestIntermediateValue;if(void 0!==t&&t!==re.latestValue){var n=void 0;B?n=B(t,e):t&&t.trim().length&&!isNaN(Number(t))&&(n=String(Nn(Number(t),{min:r,max:a}))),void 0!==n&&n!==re.latestValue&&ee(n,e)}ie(void 0)}),[re,a,r,B,ee]),de=c.useCallback((function(){re.stepTimeoutHandle>=0&&(X.clearTimeout(re.stepTimeoutHandle),re.stepTimeoutHandle=-1),(re.spinningByMouse||Z!==Dn.notSpinning)&&(re.spinningByMouse=!1,Y(Dn.notSpinning))}),[re,Z,X]),ue=c.useCallback((function(e,t){if(t.persist(),void 0!==re.latestIntermediateValue)return"keydown"!==t.type&&"mousedown"!==t.type||ce(t),void X.requestAnimationFrame((function(){ue(e,t)}));var n=e(re.latestValue||"",t);void 0!==n&&n!==re.latestValue&&ee(n,t);var o=re.spinningByMouse;re.spinningByMouse="mousedown"===t.type,re.spinningByMouse&&(re.stepTimeoutHandle=X.setTimeout((function(){ue(e,t)}),o?75:400))}),[re,X,ce,ee]),pe=c.useCallback((function(e){if(M)return M(e);var t=Nn(Number(e)+Number(s),{max:a});return t=kn(t,$),String(t)}),[$,a,M,s]),he=c.useCallback((function(e){if(N)return N(e);var t=Nn(Number(e)-Number(s),{min:r});return t=kn(t,$),String(t)}),[$,r,N,s]),me=c.useCallback((function(e){(o||e.which===P.c.up||e.which===P.c.down)&&de()}),[o,de]),ge=c.useCallback((function(e){ue(pe,e)}),[pe,ue]),fe=c.useCallback((function(e){ue(he,e)}),[he,ue]);!function(e,t,n){c.useImperativeHandle(e.componentRef,(function(){return{get value(){return n},focus:function(){t.current&&t.current.focus()}}}),[t,n])}(n,z,Q),On(n);var ve=!!Q&&!isNaN(Number(Q)),be=(h||i)&&c.createElement("div",{className:se.labelWrapper},h&&c.createElement(C.I,(0,k.__assign)({},h,{className:se.icon,"aria-hidden":"true"})),i&&c.createElement(g.J,{id:W,htmlFor:U,className:se.label,disabled:o},i));return c.createElement("div",{className:se.root,ref:t},p!==xn.y.bottom&&be,c.createElement("div",(0,k.__assign)({},le,{className:se.spinButtonWrapper,"aria-label":y&&y,"aria-posinset":w,"aria-setsize":_,"data-ktp-target":!0}),c.createElement("input",(0,k.__assign)({value:null!==oe&&void 0!==oe?oe:Q,id:U,onChange:Ln,onInput:function(e){ie(e.target.value)},className:se.input,type:"text",autoComplete:"off",role:"spinbutton","aria-labelledby":i&&W,"aria-valuenow":null!==I&&void 0!==I?I:ve?Number(Q):void 0,"aria-valuetext":null!==A&&void 0!==A?A:ve?void 0:Q,"aria-valuemin":r,"aria-valuemax":a,"aria-describedby":S,onBlur:function(e){var t;ce(e),q(!1),null===(t=n.onBlur)||void 0===t||t.call(n,e)},ref:z,onFocus:function(e){var t;z.current&&((re.spinningByMouse||Z!==Dn.notSpinning)&&de(),z.current.select(),q(!0),null===(t=n.onFocus)||void 0===t||t.call(n,e))},onKeyDown:function(e){if(e.which!==P.c.up&&e.which!==P.c.down&&e.which!==P.c.enter||(e.preventDefault(),e.stopPropagation()),o)de();else{var t=Dn.notSpinning;switch(e.which){case P.c.up:t=Dn.up,ue(pe,e);break;case P.c.down:t=Dn.down,ue(he,e);break;case P.c.enter:ce(e);break;case P.c.escape:ie(void 0)}Z!==t&&Y(t)}},onKeyUp:me,disabled:o,"aria-disabled":o,"data-lpignore":!0,"data-ktp-execute-target":!0},L)),c.createElement("span",{className:se.arrowButtonsContainer},c.createElement(ne.K,(0,k.__assign)({styles:En(E,!0,D),className:"ms-UpButton",checked:Z===Dn.up,disabled:o,iconProps:m,onMouseDown:ge,onMouseLeave:de,onMouseUp:de,tabIndex:-1,ariaLabel:f,"data-is-focusable":!1},O)),c.createElement(ne.K,(0,k.__assign)({styles:En(E,!1,x),className:"ms-DownButton",checked:Z===Dn.down,disabled:o,iconProps:v,onMouseDown:fe,onMouseLeave:de,onMouseUp:de,tabIndex:-1,ariaLabel:b,"data-is-focusable":!1},O)))),p===xn.y.bottom&&be)}));Mn.displayName="SpinButton";var On=function(e){0},Bn=(0,Cn.I)(Mn,(function(e){var t,n,o,i,r=e.theme,a=e.className,s=e.labelPosition,l=e.disabled,c=e.isFocused,d=r.palette,u=r.semanticColors,p=r.effects,h=r.fonts,m=u.inputBorder,g=u.inputBackground,f=u.inputBorderHovered,v=u.inputFocusBorderAlt,b=u.inputText,y=d.white,C=u.inputBackgroundChecked,S=u.disabledText;return{root:[h.medium,{outline:"none",width:"100%",minWidth:86},a],labelWrapper:[{display:"inline-flex",alignItems:"center"},s===xn.y.start&&{height:32,float:"left",marginRight:10},s===xn.y.end&&{height:32,float:"right",marginLeft:10},s===xn.y.top&&{marginBottom:-1}],icon:[{padding:"0 5px",fontSize:K.fF.large},l&&{color:S}],label:{pointerEvents:"none",lineHeight:K.fF.large},spinButtonWrapper:[(0,k.__assign)((0,k.__assign)({display:"flex",position:"relative",boxSizing:"border-box",height:32,minWidth:86},(0,K.Sq)(m,p.roundedCorner2,"border",0)),{":after":(t={borderWidth:"1px"},t[K.up]={borderColor:"GrayText"},t)}),(s===xn.y.top||s===xn.y.bottom)&&{width:"100%"},!l&&[{":hover:after":(n={borderColor:f},n[K.up]={borderColor:"Highlight"},n)},c&&{":hover:after, :after":(o={borderColor:v,borderWidth:"2px"},o[K.up]={borderColor:"Highlight"},o)}],l&&Tn(r)],input:["ms-spinButton-input",{boxSizing:"border-box",boxShadow:"none",borderStyle:"none",flex:1,margin:0,fontSize:h.medium.fontSize,fontFamily:"inherit",color:b,backgroundColor:g,height:"100%",padding:"0 8px 0 9px",outline:0,display:"block",minWidth:61,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",cursor:"text",userSelect:"text",borderRadius:"".concat(p.roundedCorner2," 0 0 ").concat(p.roundedCorner2)},!l&&{selectors:{"::selection":{backgroundColor:C,color:y,selectors:(i={},i[K.up]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},i)}}},l&&Tn(r)],arrowButtonsContainer:[{display:"block",height:"100%",cursor:"default"},l&&Tn(r)]}}),void 0,{scope:"SpinButton"}),Fn=n(72953),jn=n(86178),Hn=n.n(jn),zn=n(48709);const Un=(0,G.J9)(((e,t,n)=>{let o=Te.z.Black,i=Te.z.Black,r=Te.z.PlannerPrimary,a=zn.kd.gray80;switch(e){case m.Sx.Light:o=Te.z.PlannerDarker,r=Te.z.PlannerPrimary;break;case m.Sx.Dark:o=Te.z.White,r=Te.z.PlannerPrimary;break;case m.Sx.TeamsLight:o=Te.z.TeamsAppBrand00,r=Te.z.TeamsAppBrand00;break;case m.Sx.TeamsDark:o=Te.z.White,r=Te.z.TeamsAppBrand00;break;case m.Sx.TeamsContrast:o=Te.z.White,i=Te.z.Black,r=Te.z.TeamsContrastSelectedColor,a=Te.z.TeamsContrastHyperlinkColor;break;case m.Sx.SharePoint:o=Te.z.Black,r=Te.z.SharepointButtonHoverColor()}const s={root:[(0,we.gS)("row")],weekdayButton:[we.xK,(0,we.$Z)(),(0,we.Ml)(e),{height:"40px",width:"40px",fontSize:"14px",textAlign:"center",position:"relative",marginRight:"5px",":before":{content:"''",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",backgroundColor:"transparent",borderRadius:"50%",zIndex:"0"},"&.selected":[(0,_e.cP)({backgroundColor:"inherit",borderRadius:"50%"}),{color:o,":before":[(0,_e.cP)({borderRadius:"50%",opacity:1}),{backgroundColor:r,opacity:"0.4"}]},(0,_e.cP)()],span:{zIndex:"1",position:"relative"}},!n&&{cursor:"pointer","&.selected:hover:before":{opacity:"0.5"},":not(&.selected):hover":[(0,_e.c3)(),{color:i,":before":[(0,_e._Z)({borderWidth:"1px",borderStyle:"solid"}),{backgroundColor:a,opacity:"1"}]}]}]};return(0,K.TW)(s,t)})),Wn=(0,G.J9)((e=>({root:(0,K.Zq)("weekdayPicker",e.root),weekdayButton:(0,K.Zq)("weekdayButton",e.weekdayButton)})));var Kn=n(80347);class Gn extends d.${name(){return"WeekdayPicker"}renderComponent(){const e=this.getClassNames(),t=Kn.W0.getDaysOfWeekByStartDay(Hn().localeData().firstDayOfWeek()),n=rt()(t,(e=>this.renderWeekdayButton(e)));return c.createElement("div",{className:e.root,"aria-label":ht.p.Strings.WeekdayPicker_WeekdayPickerAriaLabel},n)}renderWeekdayButton(e){const t=this.getClassNames(),n=this.props.selectedDaysOfWeek.indexOf(e)>-1,o=(0,I.A)(t.weekdayButton,{selected:n});return c.createElement("button",{className:o,onClick:()=>this.props.onClickWeekday(e,!n),"aria-label":Hn().weekdays(Kn.W0.getMomentDayIndexFromDayOfWeek(e)),key:Kn.W0.getMomentDayIndexFromDayOfWeek(e),role:"checkbox","aria-checked":n,type:"button"},c.createElement("span",null,this.getWeekdayButtonString(e)))}getWeekdayButtonString(e){switch(e){case Kn.ob.Sunday:return ht.p.Strings.WeekdayPicker_SundayAbbreviation;case Kn.ob.Monday:return ht.p.Strings.WeekdayPicker_MondayAbbreviation;case Kn.ob.Tuesday:return ht.p.Strings.WeekdayPicker_TuesdayAbbreviation;case Kn.ob.Wednesday:return ht.p.Strings.WeekdayPicker_WednesdayAbbreviation;case Kn.ob.Thursday:return ht.p.Strings.WeekdayPicker_ThursdayAbbreviation;case Kn.ob.Friday:return ht.p.Strings.WeekdayPicker_FridayAbbreviation;case Kn.ob.Saturday:default:return ht.p.Strings.WeekdayPicker_SaturdayAbbreviation}}getClassNames(){return Wn(Un(this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.state={}}}var qn=n(65185),Vn=n(26566),Zn=n(62721),Yn=n(41975);const Xn=(0,G.J9)(((e,t)=>{const n=[(0,we.Ml)(e),{textAlign:"end",width:"80px",paddingRight:"16px",fontSize:"14px",lineHeight:"30px"}],o={dialogContainer:[(0,we.aS)(e),(0,we.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{maxWidth:"475px",minWidth:"405px"}},e===m.Sx.TeamsContrast&&{border:"1px solid "+Te.z.White}],dialogTitle:[(0,we.aS)(e)],dialogTopButton:{".ms-Dialog-button":[(0,we.aS)(e),{":hover":[(0,we.aS)(e),{backgroundColor:"transparent"}]}]},dialogFooterButtons:{":hover":{backgroundColor:"transparent"},":disabled":[(0,we.A9)(e)],"&.ms-Button--primary":[(0,we.jU)(e)],"&.ms-Button--default":[(0,we.i9)(e)]},body:[(0,we.gS)("column")],repeatSection:[(0,we.$Z)(),(0,we.gS)("column"),{".repeatLabel":n,".spinButton":{marginRight:"8px",width:"66px"},".dropdown":{minWidth:"90px"},".repeatPattern":[(0,we.$Z)(),(0,we.gS)("row"),{paddingBottom:"20px",alignItems:"center"}]}],weekdayPickerSection:[(0,we.$Z)(),(0,we.gS)("column"),{paddingBottom:"20px",".weekdayPickerRow":[(0,we.gS)("row"),{alignItems:"center"}],".weekdayPickerLabel":n,".errorMessage":{paddingTop:"16px"}}],monthAndYearlyPickerSection:[(0,we.$Z)(),(0,we.gS)("column"),{paddingBottom:"20px",".absoluteRow, .relativeRow":[(0,we.$Z)(),(0,we.gS)("row","nowrap"),{marginLeft:"96px"}],".absoluteRowElements, .relativeRowElements":[(0,we.GD)(),(0,we.gS)("row","wrap"),{" > *":[(0,we.$Z)(),{marginRight:"8px",marginBottom:"10px"}]}],".weekIndexDropdown":{minWidth:"92px"},".monthDropdown":{minWidth:"110px"},".dayOfWeekDropdown":{minWidth:"120px"},".rowText":[(0,we.Ml)(e),{fontSize:"14px",height:"30px",lineHeight:"30px"}],".errorMessage":{marginLeft:"30px",paddingBottom:"16px"}}],summaryText:[(0,we.$Z)(),{fontSize:"12px",height:"32px",maxWidth:"fit-content",paddingTop:"4px",".patternText":{fontWeight:"600"}}],errorMessage:[(0,we.$Z)(),{color:(0,we.Qt)(e),paddingLeft:"95px",fontSize:"10px",height:"16px"}]};return(0,K.TW)(o,t)})),$n=(0,G.J9)((e=>({title:e.dialogTitle,topButton:e.dialogTopButton}))),Jn=(0,G.J9)(((e,t)=>({root:[(0,we.nK)(e),{minWidth:"66px",":hover .ms-Button--icon":{opacity:"1"},":focus-within":(0,we.oO)(e),":disabled":(0,we.nK)(e),":hover .ms-Button--icon:disabled":{opacity:"0",pointerEvents:"none",color:"transparent"}}],spinButtonWrapper:{minWidth:"66px","::after":{border:"none",display:"none"}},input:[(0,we.aS)(e),{backgroundColor:(0,we.CS)(e),borderRadius:"2px",textAlign:"center",fontColor:"red"},t&&[(0,we.$4)(e),{backgroundColor:(0,we.CS)(e)}]],arrowButtonsContainer:{right:"0px",position:"absolute",backgroundColor:"transparent",width:"20px"}}))),Qn=(0,G.J9)(((e,t)=>{let n=zn.kd.gray190;e===m.Sx.Dark||e===m.Sx.TeamsDark?n=zn.kd.gray30:e===m.Sx.TeamsContrast&&(n=Te.z.TeamsContrastHyperlinkColor);const o={backgroundColor:"transparent",color:n},i={opacity:"0",pointerEvents:"none",color:"transparent"};return{root:[(0,we.Ml)(e),{opacity:"0",width:"20px",backgroundColor:"transparent",cursor:"pointer"},t&&i],rootHovered:o,rootPressed:o,rootChecked:[o,t&&i],rootCheckedPressed:o,rootDisabled:i}})),eo=(0,G.J9)(((e,t)=>{let n=zn.kd.gray190;e===m.Sx.Dark||e===m.Sx.TeamsDark?n=zn.kd.gray30:e===m.Sx.TeamsContrast&&(n=Te.z.TeamsContrastHyperlinkColor);return{root:[(0,we.nK)(e),{borderBottom:"1px"},!t&&{":focus-within":[(0,we.oO)(e)]}],dropdown:[{"&:focus:after":{border:"none",position:"inherit"}},!t&&{"&:hover .ms-Dropdown-title, &:focus .ms-Dropdown-title, &:active .ms-Dropdown-title":[(0,we.aS)(e),{borderColor:"transparent"}],"&:hover .ms-Dropdown-caretDown, &:focus .ms-Dropdown-caretDown, &:active .ms-Dropdown-caretDown":{color:n}}],title:[(0,we.aS)(e),t&&(0,we.$4)(e),{backgroundColor:"transparent",border:"0px solid transparent",borderRadius:"3px",paddingTop:"1px"}],caretDown:[(0,we.Ml)(e),t&&(0,we.$4)(e),{paddingTop:"1px"}]}})),to=(0,G.J9)(((e,t)=>{var n,o;return{root:[(0,we.$Z)(),(0,we.gS)(),{margin:"0",height:"30px",width:"30px"}],choiceFieldWrapper:[(0,we.GD)(),(0,we.gS)()],field:[(0,we.pH)(null!==(n=e.checked)&&void 0!==n&&n,null!==(o=e.disabled)&&void 0!==o&&o,t),{height:"30px",lineHeight:"30px","::before,:hover::before":{width:"14px",height:"14px",top:"8px",left:"8px"},"::after,:hover::after":{left:"11px",top:"11px",borderWidth:"4px",width:"8px",height:"8px"}}]}})),no=(0,G.J9)((e=>({root:(0,K.Zq)("customRecurrenceDialog",e.root),dialogContainer:(0,K.Zq)("customRecurrenceDialogContainer",e.dialogContainer),dialogContent:(0,K.Zq)("customRecurrenceDialogContent",e.dialogContent),dialogFooterButtons:(0,K.Zq)(e.dialogFooterButtons),body:(0,K.Zq)("customRecurrenceBody",e.body),repeatSection:(0,K.Zq)("repeatSection",e.repeatSection),weekdayPickerSection:(0,K.Zq)("weekdayPickerSection",e.weekdayPickerSection),monthAndYearlyPickerSection:(0,K.Zq)("monthAndYearlyPickerSection",e.monthAndYearlyPickerSection),summaryText:(0,K.Zq)("summaryText",e.summaryText),errorMessage:(0,K.Zq)("errorMessage",e.errorMessage),dialogTitle:(0,K.Zq)("dialogTitle",e.dialogTitle),dialogTopButton:(0,K.Zq)("dialogTopButton",e.dialogTopButton)})));var oo=n(91004),io=n(41740),ro=n.n(io);class ao extends d.${name(){return"CustomRecurrenceDialog"}renderComponent(){const e=this.getClassNames();return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:(0,I.A)(this.props.dialogContentClassName,e.dialogContent),title:ht.p.Strings.CustomRecurrenceDialog_CustomRecurrenceDialogTitle,type:p.h.close,styles:$n(Xn(this.props.theme,this.props.contentStyles))},modalProps:{className:this.props.dialogClassName,containerClassName:(0,I.A)(this.props.dialogContainerClassName,e.dialogContainer),isBlocking:!1}},c.createElement("div",{className:e.root},c.createElement("div",{className:e.body},this.renderRepeatSection(),this.renderRecurrenceSummaryText()),c.createElement(v.E,null,c.createElement(b.j,{className:(0,I.A)("saveButton",e.dialogFooterButtons),onClick:this.onClickSaveButton,disabled:!this.validateRecurrenceParametersState()},ht.p.Strings.SharedComponents_SaveButtonText),c.createElement(y.Y,{className:(0,I.A)("cancelButton",e.dialogFooterButtons),onClick:this.props.onDismiss},ht.p.Strings.SharedComponents_CancelButtonText))))}renderRepeatSection(){const{daysOfWeek:e,interval:t,recurrenceDropdownType:n}=this.state,o=this.getClassNames(),i=oo.h.getRecurrenceIntervalLimits(n),r=n===Zn.c.Weekly&&e.length>1,a=r||t===i,s=r||t===yn.v.MinRecurrenceInterval;return c.createElement("div",{className:o.repeatSection},c.createElement("div",{className:"repeatPattern"},c.createElement("span",{className:"repeatLabel",key:"repeatLabel"},ht.p.Strings.CustomRecurrenceDialog_RepeatLabel),c.createElement(Bn,{className:"spinButton",value:t.toString(),min:yn.v.MinRecurrenceInterval,max:i,styles:Jn(this.props.theme,r),onIncrement:this.onIncrementIntervalSpinButton,onDecrement:this.onDecrementIntervalSpinButton,onValidate:this.onValidateIntervalSpinButton,disabled:r,upArrowButtonStyles:Qn(this.props.theme,a),downArrowButtonStyles:Qn(this.props.theme,s),inputProps:{"aria-label":ht.p.Strings.CustomRecurrenceDialog_IntervalInputAriaLabel},incrementButtonAriaLabel:ht.p.Strings.CustomRecurrenceDialog_IncrementIntervalButtonAriaLabel,decrementButtonAriaLabel:ht.p.Strings.CustomRecurrenceDialog_DecrementIntervalButtonAriaLabel}),c.createElement(Oe.m,{className:"dropdown",key:"recurrenceDropdown",options:this.recurrenceDropdownTypeOptions,onChange:this.onChangeRepeatDropdown,selectedKey:n,ariaLabel:ht.p.Strings.CustomRecurrenceDialog_RepeatPatternDropdownAriaLabel,styles:eo(this.props.theme,!1),appTheme:this.props.theme})),this.renderWeekPicker(),this.renderRelativeAndAbsolutePickers())}renderWeekPicker(){const{daysOfWeek:e,recurrenceDropdownType:t}=this.state;if(t!==Zn.c.Weekly)return null;const n=this.getClassNames(),o=this.validateRecurrenceParametersState()?null:ht.p.Strings.CustomRecurrenceDialog_WeekdayErrorMessage;return c.createElement("div",{className:n.weekdayPickerSection},c.createElement("div",{className:"weekdayPickerRow"},c.createElement("span",{className:"weekdayPickerLabel",key:"weekdayPickerLabel"},ht.p.Strings.CustomRecurrenceDialog_WeekdayPickerLabel),c.createElement(Gn,{theme:this.props.theme,selectedDaysOfWeek:e,onClickWeekday:this.setDayOfWeekPattern})),this.renderErrorMessage(o))}renderRelativeAndAbsolutePickers(){const{recurrenceDropdownType:e}=this.state;if(e!==Zn.c.Monthly&&e!==Zn.c.Yearly)return null;const t=this.getClassNames();return c.createElement("div",{className:t.monthAndYearlyPickerSection,role:"radiogroup"},this.renderAbsoluteRow(),this.renderRelativeRow())}renderAbsoluteRow(){const{dayOfMonth:e,isAbsolute:t,month:n,recurrenceDropdownType:o}=this.state,i=o===Zn.c.Monthly,r=o===Zn.c.Yearly,a=!t||!this.validateRecurrenceParametersState(),s=a,l=c.createElement(Bn,{className:"spinButton",key:"dayOfMonthSpinButton",value:e.toString(),styles:Jn(this.props.theme,s),onIncrement:this.onIncrementDayOfMonthSpinButton,onDecrement:this.onDecrementDayOfMonthSpinButton,onValidate:this.onValidateDayOfMonthSpinButton,disabled:s,inputProps:{"aria-label":ht.p.Strings.CustomRecurrenceDialog_DayOfMonthInputAriaLabel},incrementButtonAriaLabel:ht.p.Strings.CustomRecurrenceDialog_IncrementDayOfMonthButtonAriaLabel,decrementButtonAriaLabel:ht.p.Strings.CustomRecurrenceDialog_DecrementDayOfMonthButtonAriaLabel,min:yn.v.MinDayOfMonth,max:yn.v.MaxDayOfMonth,upArrowButtonStyles:Qn(this.props.theme,s||e===yn.v.MaxDayOfMonth),downArrowButtonStyles:Qn(this.props.theme,s||e===yn.v.MinDayOfMonth)}),d=c.createElement(Oe.m,{className:"monthDropdown",key:"absoluteMonthDropdown",options:this.monthDropdownOptions,styles:eo(this.props.theme,a),selectedKey:n,onChange:this.onChangeMonthDropdown,disabled:a,ariaLabel:ht.p.Strings.CustomRecurrenceDialog_MonthDropdownAriaLabel,appTheme:this.props.theme}),u=[];let p=[],h="";return i?(p=[ht.p.Strings.CustomRecurrenceDialog_AbsoluteMonthlyPickerRow],p=this.insertElementOrStringIntoTextArray(p,"{0}",l),h=dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteMonthlyPickerRow,e.toString())):r&&(p=[ht.p.Strings.CustomRecurrenceDialog_AbsoluteYearlyPickerRow],p=this.insertElementOrStringIntoTextArray(p,"{0}",d),p=this.insertElementOrStringIntoTextArray(p,"{1}",l),h=dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteYearlyPickerRow,Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(n)),e.toString())),p.forEach(((e,t)=>{if("string"===typeof e){const n=e.trim();""!==n&&u.push(c.createElement("span",{className:"rowText",key:"absoluteRowText-"+t.toString()},n))}else u.push(e)})),c.createElement("div",{className:"absoluteRow"},c.createElement(Fn.Y,{className:"inputButton",itemKey:"absolute",key:"absolute",id:"absolute",name:"repeatChoiceGroup",text:"",styles:this.getChoiceGroupOptionStylesWithTheme,checked:t,onChange:this.setAbsolutePatternTypeFromRadioButton,tabIndex:0,"data-is-focusable":!0,ariaLabel:h,disabled:!this.validateRecurrenceParametersState()}),c.createElement("div",{className:"absoluteRowElements"},u))}renderRelativeRow(){const{daysOfWeek:e,isAbsolute:t,month:n,recurrenceDropdownType:o,weekIndex:i}=this.state,r=o===Zn.c.Monthly,a=o===Zn.c.Yearly,s=t||!this.validateRecurrenceParametersState(),l=c.createElement(Oe.m,{className:"weekIndexDropdown",key:"weekIndexDropdown",options:this.weekIndexDropdownOptions,styles:eo(this.props.theme,s),selectedKey:i,onChange:this.onChangeWeekIndexDropdown,disabled:s,ariaLabel:ht.p.Strings.CustomRecurrenceDialog_WeekIndexDropdownAriaLabel,appTheme:this.props.theme}),d=c.createElement(Oe.m,{className:"dayOfWeekDropdown",key:"dayOfWeekDropdown",options:this.daysOfWeekDropdownOptions,styles:eo(this.props.theme,s),selectedKey:e,onChange:this.onChangeDayOfWeekDropdown,disabled:s,ariaLabel:ht.p.Strings.CustomRecurrenceDialog_DayOfWeekDropdownAriaLabel,appTheme:this.props.theme}),u=c.createElement(Oe.m,{className:"monthDropdown",key:"relativeMonthDropdown",options:this.monthDropdownOptions,styles:eo(this.props.theme,s),selectedKey:n,onChange:this.onChangeMonthDropdown,disabled:s,ariaLabel:ht.p.Strings.CustomRecurrenceDialog_MonthDropdownAriaLabel,appTheme:this.props.theme}),p=[];let h=[],m="";const g=e[0];return r?(h=[ht.p.Strings.CustomRecurrenceDialog_RelativeMonthlyPickerRow],h=this.insertElementOrStringIntoTextArray(h,"{0}",l),h=this.insertElementOrStringIntoTextArray(h,"{1}",d),m=dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeMonthlyPickerRow,this.getOrdinalNumberText(i),Hn().weekdays(Kn.W0.getMomentDayIndexFromDayOfWeek(g)))):a&&(h=[ht.p.Strings.CustomRecurrenceDialog_RelativeYearlyPickerRow],h=this.insertElementOrStringIntoTextArray(h,"{0}",l),h=this.insertElementOrStringIntoTextArray(h,"{1}",d),h=this.insertElementOrStringIntoTextArray(h,"{2}",u),m=dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeYearlyPickerRow,this.getOrdinalNumberText(i),Hn().weekdays(Kn.W0.getMomentDayIndexFromDayOfWeek(g)),Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(n)))),h.forEach(((e,t)=>{if("string"===typeof e){const n=e.trim();""!==n&&p.push(c.createElement("span",{className:"rowText",key:"relativeRowText-"+t.toString()},n))}else p.push(e)})),c.createElement("div",{className:"relativeRow"},c.createElement(Fn.Y,{className:"inputButton",itemKey:"relative",key:"relative",id:"relative",name:"repeatChoiceGroup",text:"",styles:this.getChoiceGroupOptionStylesWithTheme,checked:!t,onChange:this.setRelativePatternTypeFromRadioButton,tabIndex:0,"data-is-focusable":!0,ariaLabel:m,disabled:!this.validateRecurrenceParametersState()}),c.createElement("div",{className:"relativeRowElements"},p))}renderRecurrenceSummaryText(){if(!this.validateRecurrenceParametersState())return null;const e=this.getClassNames();return c.createElement("div",{className:e.summaryText},this.generateRecurrenceSummaryText())}generateRecurrenceSummaryText(){const{dayOfMonth:e,interval:t,isAbsolute:n,month:o,recurrenceDropdownType:i,weekIndex:r}=this.state;let a="";switch(i){case Zn.c.Daily:a=1===t?ht.p.Strings.CustomRecurrenceDialog_DailyPatternTextSingular:dt.G(ht.p.Strings.CustomRecurrenceDialog_DailyPatternTextPlural,t.toString());break;case Zn.c.Weekly:a=1===t?dt.G(ht.p.Strings.CustomRecurrenceDialog_WeeklyPatternTextSingular,this.generateDaysOfWeekText()):dt.G(ht.p.Strings.CustomRecurrenceDialog_WeeklyPatternTextPlural,t.toString(),this.generateDaysOfWeekText());break;case Zn.c.Monthly:a=n?1===t?dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteMonthlyPatternTextSingular,e.toString()):dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteMonthlyPatternTextPlural,t.toString(),e.toString()):1===t?dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeMonthlyPatternTextSingular,this.getOrdinalNumberText(r),this.generateDaysOfWeekText()):dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeMonthlyPatternTextPlural,t.toString(),this.getOrdinalNumberText(r),this.generateDaysOfWeekText());break;case Zn.c.Yearly:a=n?1===t?dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteYearlyPatternTextSingular,e.toString(),Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(o))):dt.G(ht.p.Strings.CustomRecurrenceDialog_AbsoluteYearlyPatternTextPlural,t.toString(),e.toString(),Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(o))):1===t?dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeYearlyPatternTextSingular,this.getOrdinalNumberText(r),this.generateDaysOfWeekText(),Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(o))):dt.G(ht.p.Strings.CustomRecurrenceDialog_RelativeYearlyPatternTextPlural,t.toString(),this.getOrdinalNumberText(r),this.generateDaysOfWeekText(),Hn().months(oo.h.getMomentMonthIndexFromRecurrenceMonth(o)))}return dt.G(ht.p.Strings.CustomRecurrenceDialog_RecurrenceSummaryText,a)}generateDaysOfWeekText(){const{daysOfWeek:e}=this.state;let t="";const n=e.map((e=>Kn.W0.getMomentDayIndexFromDayOfWeek(e))).sort();return 1===n.length?t=Hn().weekdays(n[0]):2===n.length?t=dt.G(ht.p.Strings.CustomRecurrenceDialog_WeekdaySpecifierForTwoValues,Hn().weekdays(n[0]),Hn().weekdays(n[1])):n.length>2&&Qe()(n,((e,o)=>{t+=Hn().weekdays(e),o!==n.length-1&&(t+=ht.p.Strings.CustomRecurrenceDialog_WeekdaySpecifierListSeparator)})),t}renderErrorMessage(e){if(null==e)return null;const t=this.getClassNames();return c.createElement("div",{className:t.errorMessage},e)}getClassNames(){return no(Xn(this.props.theme,this.props.contentStyles))}setTaskRecurrenceDayOfMonth(e){isNaN(e)||(e>yn.v.MaxDayOfMonth&&(e=yn.v.MaxDayOfMonth),e<yn.v.MinDayOfMonth&&(e=yn.v.MinDayOfMonth),this.setState({dayOfMonth:e}))}fillFieldsForDialog(e){switch(e){case Zn.c.Weekly:this.fillWeeklyRequiredFields();break;case Zn.c.Monthly:this.fillMonthlyRequiredFields();break;case Zn.c.Yearly:this.fillYearlyRequiredFields();break;case Zn.c.Daily:default:this.setState({recurrenceDropdownType:Zn.c.Daily})}}fillWeeklyRequiredFields(){const{interval:e}=this.state,t=e>0&&e<=oo.h.getRecurrenceIntervalLimits(Zn.c.Weekly)?e:1;this.setState({interval:t,recurrenceDropdownType:Zn.c.Weekly})}fillMonthlyRequiredFields(){const{interval:e}=this.state,t=e>0&&e<=oo.h.getRecurrenceIntervalLimits(Zn.c.Monthly)?e:1;this.setState((e=>({interval:t,daysOfWeek:1!==e.daysOfWeek.length?[this.defaultDayOfWeek]:e.daysOfWeek,isAbsolute:!0,recurrenceDropdownType:Zn.c.Monthly})))}fillYearlyRequiredFields(){const{interval:e}=this.state,t=e>0&&e<=oo.h.getRecurrenceIntervalLimits(Zn.c.Yearly)?e:1;this.setState((e=>({interval:t,daysOfWeek:1!==e.daysOfWeek.length?[this.defaultDayOfWeek]:e.daysOfWeek,isAbsolute:!0,recurrenceDropdownType:Zn.c.Yearly})))}validateRecurrenceParametersState(){const{dayOfMonth:e,daysOfWeek:t,interval:n,isAbsolute:o,month:i,recurrenceDropdownType:r}=this.state;let a=!0;switch(r){case Zn.c.Yearly:a=o?this.validateDayOfMonth(e)&&this.validateMonth(i):this.validateDaysOfWeekAsRelative(t)&&this.validateMonth(i);break;case Zn.c.Monthly:a=o?this.validateDayOfMonth(e):this.validateDaysOfWeekAsRelative(t);break;case Zn.c.Weekly:a=this.validateDaysOfWeekAsWeekly(t,n);case Zn.c.Daily:}return a}validateDaysOfWeekAsWeekly(e,t){return!st()(e)&&(1===e.length||1===t)}validateDaysOfWeekAsRelative(e){return!st()(e)&&1===e.length}validateMonth(e){return e>=yn.v.MinMonth&&e<=yn.v.MaxMonth}validateDayOfMonth(e){return e>=yn.v.MinDayOfMonth&&e<=yn.v.MaxDayOfMonth}getOrdinalNumberText(e){switch(e){case Kn.v_.First:return ht.p.Strings.CustomRecurrenceDialog_FirstWeekOrdinalNumberText;case Kn.v_.Second:return ht.p.Strings.CustomRecurrenceDialog_SecondWeekOrdinalNumberText;case Kn.v_.Third:return ht.p.Strings.CustomRecurrenceDialog_ThirdWeekOrdinalNumberText;case Kn.v_.Fourth:return ht.p.Strings.CustomRecurrenceDialog_FourthWeekOrdinalNumberText;case Kn.v_.Last:default:return ht.p.Strings.CustomRecurrenceDialog_LastWeekOrdinalNumberText}}insertElementOrStringIntoTextArray(e,t,n){const o=ro()(e);return e.forEach(((e,i)=>{if("string"===typeof e){const r=e.split(t);2===r.length&&o.splice(i,1,r[0],n,r[1])}})),o}constructor(e,t){var n,o,i,r,a,s,l,c;super(e,t),this.setTaskRecurrenceInterval=e=>{if(isNaN(e))return;const t=oo.h.getRecurrenceIntervalLimits(this.state.recurrenceDropdownType);e>t&&(e=t),e<yn.v.MinRecurrenceInterval&&(e=yn.v.MinRecurrenceInterval),this.setState({interval:e})},this.setDayOfWeekPattern=(e,t)=>{this.setState((()=>{const n=ro()(this.state.daysOfWeek),o=n.indexOf(e);let i=this.state.interval;return o>-1&&!t?n.splice(o,1):o<0&&t&&n.push(e),this.state.recurrenceDropdownType===Zn.c.Weekly&&n.length>1&&i>1&&(i=1),{daysOfWeek:n,interval:i}}))},this.onClickSaveButton=()=>{var e;const{dayOfMonth:t,daysOfWeek:n,interval:o,isAbsolute:i,month:r,recurrenceDropdownType:a,weekIndex:s}=this.state,{onDismiss:l,onUpdateTask:c,task:d}=this.props;if(!this.validateRecurrenceParametersState())return;let u,p;switch(this.logUsage(Mt.M.RecurrenceOptionSelected),a){case Zn.c.Weekly:u=qn.j.builder.withWeekly(n,o).build();break;case Zn.c.Monthly:u=i?qn.j.builder.withAbsoluteMonthly(t,o).build():qn.j.builder.withRelativeMonthly(n[0],s,o).build();break;case Zn.c.Yearly:u=i?qn.j.builder.withAbsoluteYearly(t,r,o).build():qn.j.builder.withRelativeYearly(n[0],r,s,o).build();break;case Zn.c.Daily:default:u=qn.j.builder.withDaily(o).build()}p=null==(null===(e=d.recurrence)||void 0===e?void 0:e.schedule)?Vn.s.builder.withRecurrencePattern(u).build():d.recurrence.schedule.setRecurrencePattern(u);const h=d.setRecurrenceSchedule(p);c(d,h),l()},this.onIncrementIntervalSpinButton=()=>{this.setTaskRecurrenceInterval(this.state.interval+1)},this.onDecrementIntervalSpinButton=()=>{this.setTaskRecurrenceInterval(this.state.interval-1)},this.onValidateIntervalSpinButton=e=>{this.setTaskRecurrenceInterval(parseInt(e,10))},this.onIncrementDayOfMonthSpinButton=()=>{this.setTaskRecurrenceDayOfMonth(this.state.dayOfMonth+1)},this.onDecrementDayOfMonthSpinButton=()=>{this.setTaskRecurrenceDayOfMonth(this.state.dayOfMonth-1)},this.onValidateDayOfMonthSpinButton=e=>{this.setTaskRecurrenceDayOfMonth(parseInt(e,10))},this.onChangeRepeatDropdown=(e,t)=>{this.setRecurrenceDropdownType(t.key)},this.setRecurrenceDropdownType=e=>{e!==this.state.recurrenceDropdownType&&this.fillFieldsForDialog(e)},this.getRepeatPatternDropdownKey=e=>{switch(e){case Yn.n.Weekly:return Zn.c.Weekly;case Yn.n.AbsoluteMonthly:case Yn.n.RelativeMonthly:return Zn.c.Monthly;case Yn.n.AbsoluteYearly:case Yn.n.RelativeYearly:return Zn.c.Yearly;case Yn.n.Daily:default:return Zn.c.Daily}},this.onChangeWeekIndexDropdown=(e,t)=>{const n=t.key;this.setState({weekIndex:n})},this.onChangeDayOfWeekDropdown=(e,t)=>{const n=t.key;this.setState({daysOfWeek:[n]})},this.onChangeMonthDropdown=(e,t)=>{const n=t.key;this.setState({month:n})},this.setAbsolutePatternTypeFromRadioButton=()=>{this.setState({isAbsolute:!0})},this.setRelativePatternTypeFromRadioButton=()=>{this.setState({isAbsolute:!1})},this.getChoiceGroupOptionStylesWithTheme=e=>to(e,this.props.theme);const d=null!==(n=null===(o=this.props.task.recurrence)||void 0===o||null===(o=o.schedule)||void 0===o?void 0:o.pattern)&&void 0!==n?n:qn.j.builder.build(),u=d.recurrencePatternType!==Yn.n.RelativeMonthly&&d.recurrencePatternType!==Yn.n.RelativeYearly,p=null!==(i=null!==(r=this.props.task.dueDate)&&void 0!==r?r:this.props.task.startDate)&&void 0!==i?i:Kn.lz.ToUTC10am(Hn()());this.defaultDayOfMonth=p.date(),this.defaultDayOfWeek=Kn.W0.getDayOfWeekFromMomentIndex(p.day()),this.defaultWeekIndex=Kn.Xp.getWeekIndexFromMoment(p),this.defaultMonth=oo.h.getRecurrenceMonthIndexFromMoment(p),this.state={dayOfMonth:null!==(a=d.dayOfMonth)&&void 0!==a?a:this.defaultDayOfMonth,daysOfWeek:null!==(s=d.daysOfWeek)&&void 0!==s?s:[this.defaultDayOfWeek],interval:d.interval,isAbsolute:u,month:null!==(l=d.month)&&void 0!==l?l:this.defaultMonth,recurrenceDropdownType:this.getRepeatPatternDropdownKey(d.recurrencePatternType),weekIndex:null!==(c=d.weekIndex)&&void 0!==c?c:this.defaultWeekIndex},this.monthDropdownOptions=[];for(let m=1;m<13;m++)this.monthDropdownOptions.push({key:m,text:Hn().months(m-1)});this.weekIndexDropdownOptions=[{key:Kn.v_.First,text:ht.p.Strings.CustomRecurrenceDialog_FirstWeekDropdownOptionText},{key:Kn.v_.Second,text:ht.p.Strings.CustomRecurrenceDialog_SecondWeekDropdownOptionText},{key:Kn.v_.Third,text:ht.p.Strings.CustomRecurrenceDialog_ThirdWeekDropdownOptionText},{key:Kn.v_.Fourth,text:ht.p.Strings.CustomRecurrenceDialog_FourthWeekDropdownOptionText},{key:Kn.v_.Last,text:ht.p.Strings.CustomRecurrenceDialog_LastWeekDropdownOptionText}];const h=Kn.W0.getDaysOfWeekByStartDay(Hn().localeData().firstDayOfWeek());this.daysOfWeekDropdownOptions=rt()(h,(e=>({key:e,text:Hn().weekdays(Kn.W0.getMomentDayIndexFromDayOfWeek(e))}))),this.recurrenceDropdownTypeOptions=[{key:Zn.c.Daily,text:ht.p.Strings.CustomRecurrenceDialog_DayRepeatOptionText},{key:Zn.c.Weekly,text:ht.p.Strings.CustomRecurrenceDialog_WeekRepeatOptionText},{key:Zn.c.Monthly,text:ht.p.Strings.CustomRecurrenceDialog_MonthRepeatOptionText},{key:Zn.c.Yearly,text:ht.p.Strings.CustomRecurrenceDialog_YearRepeatOptionText}]}}const so=(0,G.J9)(((e,t)=>{const n={dialog:[(0,we.aS)(e),{".ms-Dialog-main":{borderRadius:"10px"}}],dialogButtons:{borderRadius:"5px","&.ms-Button--primary":[(0,we.jU)(e)],"&.ms-Button--default":[(0,we.i9)(e)]}};return(0,K.TW)(n,t)})),lo=(0,G.J9)((e=>({title:[(0,we.aS)(e),(0,we.NX)(e)],topButton:{".ms-Dialog-button":[(0,we.aS)(e),(0,we.NX)(e),{":hover":[(0,we.aS)(e),{backgroundColor:"transparent"}]}]},inner:[(0,we.aS)(e),(0,we.NX)(e)]}))),co=(0,G.J9)((e=>({dialog:(0,K.Zq)("dialog",e.dialog),dialogButtons:(0,K.Zq)("dialogButtons",e.dialogButtons)})));class uo extends d.${name(){return"CheckUnsavedApprovalDialog"}renderComponent(){const e=this.getClassNames(),t={type:p.h.normal,title:ht.p.Strings.AddApprover_CheckUnsavedApprovalDialog_CheckUnsavedApprovalDialog_Title,closeButtonAriaLabel:ht.p.Strings.AddApprover_CheckUnsavedApprovalDialog_CheckUnsavedApprovalDialog_Close,subText:ht.p.Strings.AddApprover_CheckUnsavedApprovalDialog_CheckUnsavedApprovalDialog_Text,styles:lo(this.props.theme)},n={isBlocking:!0,className:e.dialog};return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onCloseDialog,dialogContentProps:t,modalProps:n,minWidth:this.dialogWidth},c.createElement(v.E,null,c.createElement(b.j,{onClick:this.props.onSendRequest,text:ht.p.Strings.AddApprover_CheckUnsavedApprovalDialog_CheckUnsavedApprovalDialog_SendRequest,className:e.dialogButtons}),c.createElement(y.Y,{onClick:this.props.onDiscard,text:ht.p.Strings.AddApprover_CheckUnsavedApprovalDialog_CheckUnsavedApprovalDialog_Discard,className:e.dialogButtons})))}getClassNames(){return co(so(this.props.theme))}constructor(e,t){super(e,t),this.dialogWidth="600px"}}var po,ho,mo,go,fo,vo,bo={main:[{width:"35%",selectors:(po={},po["@media (min-width: "+K.O7+"px)"]={width:"auto",maxWidth:"560px",minWidth:"35%"},po)}]},yo=(0,G.J9)((function(e){return function(t){return(0,K.pB)(t,bo,e)}})),Co=n(51948),So=n(50605);!function(e){e[e.disabled=0]="disabled",e[e.clickable=1]="clickable",e[e.hasDropdown=2]="hasDropdown"}(ho||(ho={})),function(e){e[e.unconstrained=0]="unconstrained",e[e.horizontalConstrained=1]="horizontalConstrained"}(mo||(mo={})),function(e){e[e.outside=0]="outside",e[e.surface=1]="surface",e[e.header=2]="header"}(go||(go={})),function(e){e[e.fixedColumns=0]="fixedColumns",e[e.justified=1]="justified"}(fo||(fo={})),function(e){e[e.onHover=0]="onHover",e[e.always=1]="always",e[e.hidden=2]="hidden"}(vo||(vo={}));var ko,Do=n(65337),xo=n(94850),To=n(72955),Eo=n(35363),wo=function(e){var t=e.count,n=e.indentWidth,o=void 0===n?36:n,i=e.role,r=void 0===i?"presentation":i,a=t*o;return t>0?c.createElement("span",{className:"ms-GroupSpacer",style:{display:"inline-block",width:a},role:r}):null};!function(e){e[e.hidden=0]="hidden",e[e.visible=1]="visible"}(ko||(ko={}));var _o=n(15304),Io=n(22090),Po=(0,Sn.Z)(),Ao=c.forwardRef((function(e,t){var n=e.checked,o=void 0!==n&&n,i=e.className,r=e.theme,a=e.styles,s=e.useFastIcons,l=void 0===s||s,d=Po(a,{theme:r,className:i,checked:o}),u=l?To.l8:C.I;return c.createElement("div",{className:d.root,ref:t},c.createElement(u,{iconName:"CircleRing",className:d.circle}),c.createElement(u,{iconName:"StatusCircleCheckmark",className:d.check}))}));Ao.displayName="CheckBase";var Ro={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check",checkHost:"ms-Check-checkHost"},Lo=(0,Cn.I)(Ao,(function(e){var t,n,o,i,r,a=e.height,s=void 0===a?e.checkBoxHeight||"18px":a,l=e.checked,c=e.className,d=e.theme,u=d.palette,p=d.semanticColors,h=d.fonts,m=(0,So.jI)(d),g=(0,K.Km)(Ro,d),f={fontSize:s,position:"absolute",left:0,top:0,width:s,height:s,textAlign:"center",display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle"};return{root:[g.root,h.medium,{lineHeight:"1",width:s,height:s,verticalAlign:"top",position:"relative",userSelect:"none",selectors:(t={":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:p.bodyBackground}},t[".".concat(g.checkHost,":hover &, .").concat(g.checkHost,":focus &, &:hover, &:focus")]={opacity:1},t)},l&&["is-checked",{selectors:{":before":{background:u.themePrimary,opacity:1,selectors:(n={},n[K.up]={background:"Window"},n)}}}],c],circle:[g.circle,f,{color:u.neutralSecondary,selectors:(o={},o[K.up]={color:"WindowText"},o)},l&&{color:u.white}],check:[g.check,f,{opacity:0,color:u.neutralSecondary,fontSize:K.fF.medium,left:m?"-0.5px":".5px",top:"-1px",selectors:(i={":hover":{opacity:1}},i[K.up]=(0,k.__assign)({},(0,K.Qg)()),i)},l&&{opacity:1,color:u.white,fontWeight:900,selectors:(r={},r[K.up]={border:"none",color:"WindowText"},r)}],checkHost:g.checkHost}}),void 0,{scope:"Check"},!0),No=n(42815),Mo=n(97758),Oo={root:"ms-DetailsRow",compact:"ms-DetailsList--Compact",cell:"ms-DetailsRow-cell",cellAnimation:"ms-DetailsRow-cellAnimation",cellCheck:"ms-DetailsRow-cellCheck",check:"ms-DetailsRow-check",cellMeasurer:"ms-DetailsRow-cellMeasurer",listCellFirstChild:"ms-List-cell:first-child",isContentUnselectable:"is-contentUnselectable",isSelected:"is-selected",isCheckVisible:"is-check-visible",isRowHeader:"is-row-header",fields:"ms-DetailsRow-fields"},Bo={cellLeftPadding:12,cellRightPadding:8,cellExtraRightPadding:24},Fo={rowHeight:42,compactRowHeight:32},jo=(0,k.__assign)((0,k.__assign)({},Fo),{rowVerticalPadding:11,compactRowVerticalPadding:6}),Ho={tooltipHost:"ms-TooltipHost",root:"ms-DetailsHeader",cell:"ms-DetailsHeader-cell",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintCaretStyle:"ms-DetailsHeader-dropHintCaretStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVertical:"ms-DetailsColumn-gripperBarVertical",checkTooltip:"ms-DetailsHeader-checkTooltip",check:"ms-DetailsHeader-check"},zo=function(e){var t=e.theme,n=e.cellStyleProps,o=void 0===n?Bo:n,i=t.semanticColors;return[(0,K.Km)(Ho,t).cell,(0,K.gm)(t),{color:i.bodyText,position:"relative",display:"inline-block",boxSizing:"border-box",padding:"0 ".concat(o.cellRightPadding,"px 0 ").concat(o.cellLeftPadding,"px"),lineHeight:"inherit",margin:"0",height:42,verticalAlign:"top",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left"}]},Uo={root:"ms-DetailsRow-check",isDisabled:"ms-DetailsRow-check--isDisabled",isHeader:"ms-DetailsRow-check--isHeader"},Wo=n(3683),Ko=(0,Sn.Z)(),Go=c.memo((function(e){return c.createElement(Lo,{theme:e.theme,checked:e.checked,className:e.className,useFastIcons:!0})}));function qo(e){return c.createElement(Lo,{checked:e.checked})}function Vo(e){return c.createElement(Go,{theme:e.theme,checked:e.checked})}var Zo,Yo=(0,Cn.I)((function(e){var t=e.isVisible,n=void 0!==t&&t,o=e.canSelect,i=void 0!==o&&o,r=e.anySelected,a=void 0!==r&&r,s=e.selected,l=void 0!==s&&s,d=e.selectionMode,u=e.isHeader,p=void 0!==u&&u,h=e.className,m=(e.checkClassName,e.styles),g=e.theme,f=e.compact,v=e.onRenderDetailsCheckbox,b=e.useFastIcons,y=void 0===b||b,C=(0,k.__rest)(e,["isVisible","canSelect","anySelected","selected","selectionMode","isHeader","className","checkClassName","styles","theme","compact","onRenderDetailsCheckbox","useFastIcons"]),S=y?Vo:qo,D=v?(0,_o.j)(v,S):S,x=Ko(m,{theme:g,canSelect:i,selected:l,anySelected:a,className:h,isHeader:p,isVisible:n,compact:f}),T={checked:l,theme:g},E=(0,Io._)("div",C,["aria-label","aria-labelledby","aria-describedby"]),w=d===Wo.Qc.single?"radio":"checkbox";return i?c.createElement("div",(0,k.__assign)({},C,{role:w,className:(0,I.A)(x.root,x.check),"aria-checked":l,"data-selection-toggle":!0,"data-automationid":"DetailsRowCheck",tabIndex:-1}),D(T)):c.createElement("div",(0,k.__assign)({},E,{className:(0,I.A)(x.root,x.check)}))}),(function(e){var t=e.theme,n=e.className,o=e.isHeader,i=e.selected,r=e.anySelected,a=e.canSelect,s=e.compact,l=e.isVisible,c=(0,K.Km)(Uo,t),d=o?42:s?Fo.compactRowHeight:Fo.rowHeight,u=l||i||r;return{root:[c.root,n],check:[!a&&c.isDisabled,o&&c.isHeader,(0,K.gm)(t),t.fonts.small,Ro.checkHost,{display:"flex",alignItems:"center",justifyContent:"center",cursor:"default",boxSizing:"border-box",verticalAlign:"top",background:"none",backgroundColor:"transparent",border:"none",opacity:u?1:0,height:d,width:48,padding:0,margin:0}],isDisabled:[]}}),void 0,{scope:"DetailsRowCheck"},!0),Xo=n(48717),$o=function(){function e(e){this._selection=e.selection,this._dragEnterCounts={},this._activeTargets={},this._lastId=0,this._initialized=!1}return e.prototype.dispose=function(){this._events&&this._events.dispose()},e.prototype.subscribe=function(e,t,n){var o=this;if(!this._initialized){this._events=new M.g(this);var i=(0,Xo.Y)();i&&(this._events.on(i.body,"mouseup",this._onMouseUp.bind(this),!0),this._events.on(i,"mouseup",this._onDocumentMouseUp.bind(this),!0)),this._initialized=!0}var r,a,s,l,c,d,u,p,h,m,g=n.key,f=void 0===g?"".concat(++this._lastId):g,v=[];if(n&&e){var b=n.eventMap,y=n.context,C=n.updateDropState,S={root:e,options:n,key:f};if(p=this._isDraggable(S),h=this._isDroppable(S),(p||h)&&b)for(var k=0,D=b;k<D.length;k++){var x=D[k],T={callback:x.callback.bind(null,y),eventName:x.eventName};v.push(T),this._events.on(e,T.eventName,T.callback)}h&&(a=function(e){e.isHandled||(e.isHandled=!0,o._dragEnterCounts[f]--,0===o._dragEnterCounts[f]&&C(!1,e))},s=function(e){e.preventDefault(),e.isHandled||(e.isHandled=!0,o._dragEnterCounts[f]++,1===o._dragEnterCounts[f]&&C(!0,e))},l=function(e){o._dragEnterCounts[f]=0,C(!1,e)},c=function(e){o._dragEnterCounts[f]=0,C(!1,e),n.onDrop&&n.onDrop(n.context.data,e)},d=function(e){e.preventDefault(),n.onDragOver&&n.onDragOver(n.context.data,e)},this._dragEnterCounts[f]=0,t.on(e,"dragenter",s),t.on(e,"dragleave",a),t.on(e,"dragend",l),t.on(e,"drop",c),t.on(e,"dragover",d)),p&&(u=this._onMouseDown.bind(this,S),l=this._onDragEnd.bind(this,S),r=function(t){var i=n;i&&i.onDragStart&&i.onDragStart(i.context.data,i.context.index,o._selection.getSelection(),t),o._isDragging=!0,t.dataTransfer&&t.dataTransfer.setData("id",e.id)},t.on(e,"dragstart",r),t.on(e,"mousedown",u),t.on(e,"dragend",l)),m={target:S,dispose:function(){if(o._activeTargets[f]===m&&delete o._activeTargets[f],e){for(var n=0,i=v;n<i.length;n++){var g=i[n];o._events.off(e,g.eventName,g.callback)}h&&(t.off(e,"dragenter",s),t.off(e,"dragleave",a),t.off(e,"dragend",l),t.off(e,"dragover",d),t.off(e,"drop",c)),p&&(t.off(e,"dragstart",r),t.off(e,"mousedown",u),t.off(e,"dragend",l))}}},this._activeTargets[f]=m}return{key:f,dispose:function(){m&&m.dispose()}}},e.prototype.unsubscribe=function(e,t){var n=this._activeTargets[t];n&&n.dispose()},e.prototype._onDragEnd=function(e,t){var n=e.options;n.onDragEnd&&n.onDragEnd(n.context.data,t)},e.prototype._onMouseUp=function(e){if(this._isDragging=!1,this._dragData){for(var t=0,n=Object.keys(this._activeTargets);t<n.length;t++){var o=n[t],i=this._activeTargets[o];i.target.root&&(this._events.off(i.target.root,"mousemove"),this._events.off(i.target.root,"mouseleave"))}this._dragData.dropTarget&&(M.g.raise(this._dragData.dropTarget.root,"dragleave"),M.g.raise(this._dragData.dropTarget.root,"drop"))}this._dragData=null},e.prototype._onDocumentMouseUp=function(e){var t=(0,Xo.Y)();t&&e.target===t.documentElement&&this._onMouseUp(e)},e.prototype._onMouseMove=function(e,t){var n=t.buttons,o=void 0===n?1:n;if(this._dragData&&1!==o)this._onMouseUp(t);else{var i=e.root,r=e.key;this._isDragging&&this._isDroppable(e)&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key!==r&&!this._isChild(i,this._dragData.dropTarget.root)&&this._dragEnterCounts[this._dragData.dropTarget.key]>0&&(M.g.raise(this._dragData.dropTarget.root,"dragleave"),M.g.raise(i,"dragenter"),this._dragData.dropTarget=e)}},e.prototype._onMouseLeave=function(e,t){this._isDragging&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key===e.key&&(M.g.raise(e.root,"dragleave"),this._dragData.dropTarget=void 0)},e.prototype._onMouseDown=function(e,t){if(0===t.button)if(this._isDraggable(e)){this._dragData={clientX:t.clientX,clientY:t.clientY,eventTarget:t.target,dragTarget:e};for(var n=0,o=Object.keys(this._activeTargets);n<o.length;n++){var i=o[n],r=this._activeTargets[i];r.target.root&&(this._events.on(r.target.root,"mousemove",this._onMouseMove.bind(this,r.target)),this._events.on(r.target.root,"mouseleave",this._onMouseLeave.bind(this,r.target)))}}else this._dragData=null},e.prototype._isChild=function(e,t){for(;t&&t.parentElement;){if(t.parentElement===e)return!0;t=t.parentElement}return!1},e.prototype._isDraggable=function(e){var t=e.options;return!(!t.canDrag||!t.canDrag(t.context.data))},e.prototype._isDroppable=function(e){var t=e.options,n=this._dragData&&this._dragData.dragTarget?this._dragData.dragTarget.options.context:void 0;return!(!t.canDrop||!t.canDrop(t.context,n))},e}(),Jo=(0,Sn.Z)(),Qo=function(e){return function(t){return t?t.column.isIconOnly?c.createElement("span",{className:e.accessibleLabel},t.column.name):c.createElement(c.Fragment,null,t.column.name):null}},ei=function(e){function t(t){var n=e.call(this,t)||this;return n._root=c.createRef(),n._tooltipRef=c.createRef(),n._onRenderFilterIcon=function(e){return function(e){var t=e.columnProps,n=(0,k.__rest)(e,["columnProps"]),o=(null===t||void 0===t?void 0:t.useFastIcons)?To.l8:C.I;return c.createElement(o,(0,k.__assign)({},n))}},n._onRenderColumnHeaderTooltip=function(e){return c.createElement("span",{className:e.hostClassName},e.children)},n._onColumnClick=function(e){var t=n.props,o=t.onColumnClick,i=t.column;i.columnActionsMode!==ho.disabled&&(i.onColumnClick&&i.onColumnClick(e,i),o&&o(e,i))},n._onColumnBlur=function(){n._tooltipRef.current&&n._tooltipRef.current.dismiss()},n._onColumnFocus=function(){n._tooltipRef.current&&n._tooltipRef.current.show()},n._onDragStart=function(e,t,o,i){var r=n._classNames;t&&(n._updateHeaderDragInfo(t),n._root.current.classList.add(r.borderWhileDragging),n._async.setTimeout((function(){n._root.current&&n._root.current.classList.add(r.noBorderWhileDragging)}),20))},n._onDragEnd=function(e,t){var o=n._classNames;t&&n._updateHeaderDragInfo(-1,t),n._root.current.classList.remove(o.borderWhileDragging),n._root.current.classList.remove(o.noBorderWhileDragging)},n._updateHeaderDragInfo=function(e,t){n.props.setDraggedItemIndex&&n.props.setDraggedItemIndex(e),n.props.updateDragInfo&&n.props.updateDragInfo({itemIndex:e},t)},n._onColumnContextMenu=function(e){var t=n.props,o=t.onColumnContextMenu,i=t.column;i.onColumnContextMenu&&(i.onColumnContextMenu(i,e),e.preventDefault()),o&&(o(i,e),e.preventDefault())},n._onRootMouseDown=function(e){n.props.isDraggable&&0===e.button&&e.stopPropagation()},(0,L.f)(n),n._async=new N.j(n),n._events=new M.g(n),n}return(0,k.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.column,n=e.parentId,o=e.isDraggable,i=e.styles,r=e.theme,a=e.cellStyleProps,s=void 0===a?Bo:a,l=e.useFastIcons,d=void 0===l||l,u=this.props.onRenderColumnHeaderTooltip,p=void 0===u?this._onRenderColumnHeaderTooltip:u;this._classNames=Jo(i,{theme:r,headerClassName:t.headerClassName,iconClassName:t.iconClassName,isActionable:t.columnActionsMode!==ho.disabled,isEmpty:!t.name,isIconVisible:t.isSorted||t.isGrouped||t.isFiltered,isPadded:t.isPadded,isIconOnly:t.isIconOnly,cellStyleProps:s,transitionDurationDrag:200,transitionDurationDrop:1500});var h=this._classNames,m=d?To.l8:C.I,g=t.onRenderFilterIcon?(0,_o.j)(t.onRenderFilterIcon,this._onRenderFilterIcon(this._classNames)):this._onRenderFilterIcon(this._classNames),f=t.onRenderHeader?(0,_o.j)(t.onRenderHeader,Qo(this._classNames)):Qo(this._classNames),v=t.columnActionsMode!==ho.disabled&&(void 0!==t.onColumnClick||void 0!==this.props.onColumnClick),b=this.props.onRenderColumnHeaderTooltip?!t.ariaLabel:this._hasAccessibleDescription(),y={"aria-label":t.ariaLabel?t.ariaLabel:t.isIconOnly?t.name:void 0,"aria-labelledby":t.ariaLabel||t.isIconOnly?void 0:"".concat(n,"-").concat(t.key,"-name"),"aria-describedby":b?"".concat(n,"-").concat(t.key,"-tooltip"):void 0};return c.createElement(c.Fragment,null,c.createElement("div",(0,k.__assign)({key:t.key,ref:this._root,role:"columnheader"},!v&&y,{"aria-sort":t.isSorted?t.isSortedDescending?"descending":"ascending":"none","data-is-focusable":v||t.columnActionsMode===ho.disabled?void 0:"true",className:h.root,"data-is-draggable":o,draggable:o,style:{width:(t.calculatedWidth||0)+s.cellLeftPadding+s.cellRightPadding+(t.isPadded?s.cellExtraRightPadding:0)},"data-automationid":"ColumnsHeaderColumn","data-item-key":t.key,onBlur:this._onColumnBlur,onFocus:this._onColumnFocus}),o&&c.createElement(m,{iconName:"GripperBarVertical",className:h.gripperBarVerticalStyle}),p({hostClassName:h.cellTooltip,id:"".concat(n,"-").concat(t.key,"-tooltip"),setAriaDescribedBy:!1,column:t,componentRef:this._tooltipRef,content:t.columnActionsMode!==ho.disabled?t.ariaLabel:"",children:c.createElement("span",(0,k.__assign)({id:"".concat(n,"-").concat(t.key),className:h.cellTitle,"data-is-focusable":v&&t.columnActionsMode!==ho.disabled?"true":void 0,role:v?"button":void 0},v&&y,{onContextMenu:this._onColumnContextMenu,onClick:this._onColumnClick,"aria-haspopup":t.columnActionsMode===ho.hasDropdown?"menu":void 0,"aria-expanded":t.columnActionsMode===ho.hasDropdown?!!t.isMenuOpen:void 0}),c.createElement("span",{id:"".concat(n,"-").concat(t.key,"-name"),className:h.cellName},(t.iconName||t.iconClassName)&&c.createElement(m,{className:h.iconClassName,iconName:t.iconName}),f(this.props)),t.isFiltered&&c.createElement(m,{className:h.nearIcon,iconName:"Filter"}),(t.isSorted||t.showSortIconWhenUnsorted)&&c.createElement(m,{className:h.sortIcon,iconName:t.isSorted?t.isSortedDescending?"SortDown":"SortUp":"Sort"}),t.isGrouped&&c.createElement(m,{className:h.nearIcon,iconName:"GroupedDescending"}),t.columnActionsMode===ho.hasDropdown&&!t.isIconOnly&&g({"aria-hidden":!0,columnProps:this.props,className:h.filterChevron,iconName:"ChevronDown"}))},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:this._renderAccessibleDescription())},t.prototype.componentDidMount=function(){var e=this;this.props.dragDropHelper&&this.props.isDraggable&&this._addDragDropHandling();var t=this._classNames;this.props.isDropped&&(this._root.current&&(this._root.current.classList.add(t.borderAfterDropping),this._async.setTimeout((function(){e._root.current&&e._root.current.classList.add(t.noBorderAfterDropping)}),20)),this._async.setTimeout((function(){e._root.current&&(e._root.current.classList.remove(t.borderAfterDropping),e._root.current.classList.remove(t.noBorderAfterDropping))}),1520))},t.prototype.componentWillUnmount=function(){this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this._async.dispose(),this._events.dispose()},t.prototype.componentDidUpdate=function(){!this._dragDropSubscription&&this.props.dragDropHelper&&this.props.isDraggable&&this._addDragDropHandling(),this._dragDropSubscription&&!this.props.isDraggable&&(this._dragDropSubscription.dispose(),this._events.off(this._root.current,"mousedown"),delete this._dragDropSubscription)},t.prototype._getColumnDragDropOptions=function(){var e=this,t=this.props.columnIndex;return{selectionIndex:t,context:{data:t,index:t},canDrag:function(){return e.props.isDraggable},canDrop:function(){return!1},onDragStart:this._onDragStart,updateDropState:function(){},onDrop:function(){},onDragEnd:this._onDragEnd}},t.prototype._hasAccessibleDescription=function(){var e=this.props.column;return!!(e.filterAriaLabel||e.sortAscendingAriaLabel||e.sortDescendingAriaLabel||e.groupAriaLabel||e.sortableAriaLabel)},t.prototype._renderAccessibleDescription=function(){var e=this.props,t=e.column,n=e.parentId,o=this._classNames;return this._hasAccessibleDescription()&&!this.props.onRenderColumnHeaderTooltip?c.createElement("label",{key:"".concat(t.key,"_label"),id:"".concat(n,"-").concat(t.key,"-tooltip"),className:o.accessibleLabel,hidden:!0},t.isFiltered&&t.filterAriaLabel||null,(t.isSorted||t.showSortIconWhenUnsorted)&&(t.isSorted?t.isSortedDescending?t.sortDescendingAriaLabel:t.sortAscendingAriaLabel:t.sortableAriaLabel)||null,t.isGrouped&&t.groupAriaLabel||null):null},t.prototype._addDragDropHandling=function(){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getColumnDragDropOptions()),this._events.on(this._root.current,"mousedown",this._onRootMouseDown)},t}(c.Component),ti={isActionable:"is-actionable",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",isEmpty:"is-empty",isIconVisible:"is-icon-visible",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVerticalStyle:"ms-DetailsColumn-gripperBar",nearIcon:"ms-DetailsColumn-nearIcon"},ni=(0,Cn.I)(ei,(function(e){var t,n=e.theme,o=e.headerClassName,i=e.iconClassName,r=e.isActionable,a=e.isEmpty,s=e.isIconVisible,l=e.isPadded,c=e.isIconOnly,d=e.cellStyleProps,u=void 0===d?Bo:d,p=e.transitionDurationDrag,h=e.transitionDurationDrop,m=n.semanticColors,g=n.palette,f=n.fonts,v=(0,K.Km)(ti,n),b={iconForegroundColor:m.bodySubtext,headerForegroundColor:m.bodyText,headerBackgroundColor:m.bodyBackground,dropdownChevronForegroundColor:g.neutralSecondary,resizerColor:g.neutralTertiaryAlt},y={color:b.iconForegroundColor,opacity:1,paddingLeft:8},C={outline:"1px solid ".concat(g.themePrimary)},S={outlineColor:"transparent"};return{root:[zo(e),f.small,r&&[v.isActionable,{selectors:{":hover":{color:m.bodyText,background:m.listHeaderBackgroundHovered},":active":{background:m.listHeaderBackgroundPressed}}}],a&&[v.isEmpty,{textOverflow:"clip"}],s&&v.isIconVisible,l&&{paddingRight:u.cellExtraRightPadding+u.cellRightPadding},{selectors:{':hover i[data-icon-name="GripperBarVertical"]':{display:"block"}}},o],gripperBarVerticalStyle:{display:"none",position:"absolute",textAlign:"left",color:g.neutralTertiary,left:1},nearIcon:[v.nearIcon,y],sortIcon:[y,{paddingLeft:4,position:"relative",top:1}],iconClassName:[{color:b.iconForegroundColor,opacity:1},i],filterChevron:[v.filterChevron,{color:b.dropdownChevronForegroundColor,paddingLeft:6,verticalAlign:"middle",fontSize:f.small.fontSize}],cellTitle:[v.cellTitle,(0,K.gm)(n),(0,k.__assign)({display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",boxSizing:"border-box",overflow:"hidden",padding:"0 ".concat(u.cellRightPadding,"px 0 ").concat(u.cellLeftPadding,"px")},c?{alignContent:"flex-end",maxHeight:"100%",flexWrap:"wrap-reverse"}:{})],cellName:[v.cellName,{flex:"0 1 auto",overflow:"hidden",textOverflow:"ellipsis",fontWeight:K.BO.semibold,fontSize:f.medium.fontSize},c&&{selectors:(t={},t[".".concat(v.nearIcon)]={paddingLeft:0},t)}],cellTooltip:{display:"block",position:"absolute",top:0,left:0,bottom:0,right:0},accessibleLabel:K.dX,borderWhileDragging:C,noBorderWhileDragging:[S,{transition:"outline ".concat(p,"ms ease")}],borderAfterDropping:C,noBorderAfterDropping:[S,{transition:"outline  ".concat(h,"ms ease")}]}}),void 0,{scope:"DetailsColumn"});!function(e){e[e.none=0]="none",e[e.hidden=1]="hidden",e[e.visible=2]="visible"}(Zo||(Zo={}));var oi=(0,Sn.Z)(),ii=[],ri=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=c.createRef(),n._rootComponent=c.createRef(),n._draggedColumnIndex=-1,n._dropHintDetails={},n._updateDroppingState=function(e,t){n._draggedColumnIndex>=0&&"drop"!==t.type&&!e&&n._resetDropHints()},n._onDragOver=function(e,t){n._draggedColumnIndex>=0&&(t.stopPropagation(),n._computeDropHintToBeShown(t.clientX))},n._onDrop=function(e,t){var o=n._getColumnReorderProps();if(n._draggedColumnIndex>=0&&t){var i=n._draggedColumnIndex>n._currentDropHintIndex?n._currentDropHintIndex:n._currentDropHintIndex-1,r=n._isValidCurrentDropHintIndex();if(t.stopPropagation(),r)if(n._onDropIndexInfo.sourceIndex=n._draggedColumnIndex,n._onDropIndexInfo.targetIndex=i,o.onColumnDrop){var a={draggedIndex:n._draggedColumnIndex,targetIndex:i};o.onColumnDrop(a)}else o.handleColumnReorder&&o.handleColumnReorder(n._draggedColumnIndex,i)}n._resetDropHints(),n._dropHintDetails={},n._draggedColumnIndex=-1},n._computeColumnIndexOffset=function(e){var t=1;return e&&(t+=1),n.props.groupNestingDepth&&n.props.groupNestingDepth>0&&(t+=1),t},n._updateDragInfo=function(e,t){var o=n._getColumnReorderProps(),i=e.itemIndex;if(i>=0)n._draggedColumnIndex=i-n._computeColumnIndexOffset(!n._isCheckboxColumnHidden()),n._getDropHintPositions(),o.onColumnDragStart&&o.onColumnDragStart(!0);else if(t&&n._draggedColumnIndex>=0&&(n._resetDropHints(),n._draggedColumnIndex=-1,n._dropHintDetails={},o.onColumnDragEnd)){var r=n._isEventOnHeader(t);o.onColumnDragEnd({dropLocation:r},t)}},n._getDropHintPositions=function(){for(var e,t=n.props.columns,o=void 0===t?ii:t,i=n._getColumnReorderProps(),r=0,a=0,s=i.frozenColumnCountFromStart||0,l=i.frozenColumnCountFromEnd||0,c=s;c<o.length-l+1;c++)if(n._rootElement.current){var d=n._rootElement.current.querySelectorAll("#columnDropHint_"+c)[0];if(d)if(c===s)r=d.offsetLeft,a=d.offsetLeft,e=d;else{var u=(d.offsetLeft+r)/2;n._dropHintDetails[c-1]={originX:r,startX:a,endX:u,dropHintElementRef:e},a=u,e=d,r=d.offsetLeft,c===o.length-l&&(n._dropHintDetails[c]={originX:r,startX:a,endX:d.offsetLeft,dropHintElementRef:e})}}},n._computeDropHintToBeShown=function(e){var t=(0,So.jI)(n.props.theme);if(n._rootElement.current){var o=e-n._rootElement.current.getBoundingClientRect().left,i=n._currentDropHintIndex;if(n._isValidCurrentDropHintIndex()&&ai(t,o,n._dropHintDetails[i].startX,n._dropHintDetails[i].endX))return;var r=n.props.columns,a=void 0===r?ii:r,s=n._getColumnReorderProps(),l=s.frozenColumnCountFromStart||0,c=s.frozenColumnCountFromEnd||0,d=l,u=a.length-c,p=-1;if(si(t,o,n._dropHintDetails[d].endX)?p=d:li(t,o,n._dropHintDetails[u].startX)?p=u:n._isValidCurrentDropHintIndex()&&(n._dropHintDetails[i+1]&&ai(t,o,n._dropHintDetails[i+1].startX,n._dropHintDetails[i+1].endX)?p=i+1:n._dropHintDetails[i-1]&&ai(t,o,n._dropHintDetails[i-1].startX,n._dropHintDetails[i-1].endX)&&(p=i-1)),-1===p)for(var h=l,m=u;h<m;){var g=Math.ceil((m+h)/2);if(ai(t,o,n._dropHintDetails[g].startX,n._dropHintDetails[g].endX)){p=g;break}si(t,o,n._dropHintDetails[g].originX)?m=g:li(t,o,n._dropHintDetails[g].originX)&&(h=g)}p===n._draggedColumnIndex||p===n._draggedColumnIndex+1?n._isValidCurrentDropHintIndex()&&n._resetDropHints():i!==p&&p>=0&&(n._resetDropHints(),n._updateDropHintElement(n._dropHintDetails[p].dropHintElementRef,"inline-block"),n._currentDropHintIndex=p)}},n._renderColumnSizer=function(e){var t,o=e.columnIndex,i=n.props.columns,r=void 0===i?ii:i,a=r[o],s=n.state.columnResizeDetails,l=n._classNames;return a.isResizable?c.createElement("div",{key:"".concat(a.key,"_sizer"),"aria-hidden":!0,role:"button","data-is-focusable":!1,onClick:ci,"data-sizer-index":o,onBlur:n._onSizerBlur,className:(0,I.A)(l.cellSizer,o<r.length-1?l.cellSizerStart:l.cellSizerEnd,(t={},t[l.cellIsResizing]=s&&s.columnIndex===o,t)),onDoubleClick:n._onSizerDoubleClick.bind(n,o)}):null},n._onRenderColumnHeaderTooltip=function(e){return c.createElement("span",{className:e.hostClassName},e.children)},n._onSelectAllClicked=function(){var e=n.props.selection;e&&e.toggleAllSelected()},n._onRootMouseDown=function(e){var t=e.target.getAttribute("data-sizer-index"),o=Number(t),i=n.props.columns,r=void 0===i?ii:i;null!==t&&0===e.button&&(n.setState({columnResizeDetails:{columnIndex:o,columnMinWidth:r[o].calculatedWidth,originX:e.clientX}}),e.preventDefault(),e.stopPropagation())},n._onRootMouseMove=function(e){var t=n.state,o=t.columnResizeDetails,i=t.isSizing;o&&!i&&e.clientX!==o.originX&&n.setState({isSizing:!0})},n._onRootKeyDown=function(e){var t=n.state,o=t.columnResizeDetails,i=t.isSizing,r=n.props,a=r.columns,s=void 0===a?ii:a,l=r.onColumnResized,c=e.target.getAttribute("data-sizer-index");if(c&&!i){var d=Number(c);if(o){var u=void 0;e.which===P.c.enter?(n.setState({columnResizeDetails:void 0}),e.preventDefault(),e.stopPropagation()):e.which===P.c.left?u=(0,So.jI)(n.props.theme)?1:-1:e.which===P.c.right&&(u=(0,So.jI)(n.props.theme)?-1:1),u&&(e.shiftKey||(u*=10),n.setState({columnResizeDetails:(0,k.__assign)((0,k.__assign)({},o),{columnMinWidth:o.columnMinWidth+u})}),l&&l(s[d],o.columnMinWidth+u,d),e.preventDefault(),e.stopPropagation())}else e.which===P.c.enter&&(n.setState({columnResizeDetails:{columnIndex:d,columnMinWidth:s[d].calculatedWidth}}),e.preventDefault(),e.stopPropagation())}},n._onSizerMouseMove=function(e){var t=e.buttons,o=n.props,i=o.onColumnIsSizingChanged,r=o.onColumnResized,a=o.columns,s=void 0===a?ii:a,l=n.state.columnResizeDetails;if(void 0===t||1===t){if(e.clientX!==l.originX&&i&&i(s[l.columnIndex],!0),r){var c=e.clientX-l.originX;(0,So.jI)(n.props.theme)&&(c=-c),r(s[l.columnIndex],l.columnMinWidth+c,l.columnIndex)}}else n._onSizerMouseUp(e)},n._onSizerBlur=function(e){n.state.columnResizeDetails&&n.setState({columnResizeDetails:void 0,isSizing:!1})},n._onSizerMouseUp=function(e){var t=n.props,o=t.columns,i=void 0===o?ii:o,r=t.onColumnIsSizingChanged,a=n.state.columnResizeDetails;n.setState({columnResizeDetails:void 0,isSizing:!1}),r&&r(i[a.columnIndex],!1)},n._onToggleCollapseAll=function(){var e=n.props.onToggleCollapseAll,t=!n.state.isAllCollapsed;n.setState({isAllCollapsed:t}),e&&e(t)},(0,L.f)(n),n._events=new M.g(n),n.state={columnResizeDetails:void 0,isAllCollapsed:n.props.isAllCollapsed,isAllSelected:!!n.props.selection&&n.props.selection.isAllSelected()},n._onDropIndexInfo={sourceIndex:-1,targetIndex:-1},n._id=(0,B.O)("header"),n._currentDropHintIndex=-1,n._dragDropHelper=new $o({selection:{getSelection:function(){}},minimumPixelsForDrag:n.props.minimumPixelsForDrag}),n}return(0,k.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.selection;this._events.on(e,Wo.ij,this._onSelectionChanged),this._rootElement.current&&(this._events.on(this._rootElement.current,"mousedown",this._onRootMouseDown),this._events.on(this._rootElement.current,"keydown",this._onRootKeyDown),this._getColumnReorderProps()&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement.current,this._events,this._getHeaderDragDropOptions())))},t.prototype.componentDidUpdate=function(e){if(this._getColumnReorderProps()?!this._subscriptionObject&&this._rootElement.current&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement.current,this._events,this._getHeaderDragDropOptions())):this._subscriptionObject&&(this._subscriptionObject.dispose(),delete this._subscriptionObject),this.props!==e&&this._onDropIndexInfo.sourceIndex>=0&&this._onDropIndexInfo.targetIndex>=0){var t=e.columns,n=void 0===t?ii:t,o=this.props.columns,i=void 0===o?ii:o;n[this._onDropIndexInfo.sourceIndex].key===i[this._onDropIndexInfo.targetIndex].key&&(this._onDropIndexInfo={sourceIndex:-1,targetIndex:-1})}this.props.isAllCollapsed!==e.isAllCollapsed&&this.setState({isAllCollapsed:this.props.isAllCollapsed})},t.prototype.componentWillUnmount=function(){this._subscriptionObject&&(this._subscriptionObject.dispose(),delete this._subscriptionObject),this._dragDropHelper.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this,t=this.props,n=t.columns,o=void 0===n?ii:n,i=t.ariaLabel,r=t.ariaLabelForToggleAllGroupsButton,a=t.ariaLabelForSelectAllCheckbox,s=t.selectAllVisibility,l=t.ariaLabelForSelectionColumn,d=t.indentWidth,u=t.onColumnClick,p=t.onColumnContextMenu,h=t.onRenderColumnHeaderTooltip,m=void 0===h?this._onRenderColumnHeaderTooltip:h,g=t.styles,f=t.selectionMode,v=t.theme,b=t.onRenderDetailsCheckbox,y=t.groupNestingDepth,S=t.useFastIcons,k=t.checkboxVisibility,D=t.className,x=this.state,T=x.isAllSelected,E=x.columnResizeDetails,w=x.isSizing,_=x.isAllCollapsed,I=s!==Zo.none,P=s===Zo.hidden,A=k===vo.always,R=this._getColumnReorderProps(),L=R&&R.frozenColumnCountFromStart?R.frozenColumnCountFromStart:0,N=R&&R.frozenColumnCountFromEnd?R.frozenColumnCountFromEnd:0;this._classNames=oi(g,{theme:v,isAllSelected:T,isSelectAllHidden:s===Zo.hidden,isResizingColumn:!!E&&w,isSizing:w,isAllCollapsed:_,isCheckboxHidden:P,className:D});var M=this._classNames,O=S?To.l8:C.I,B=y>0,F=B&&this.props.collapseAllVisibility===ko.visible,j=this._computeColumnIndexOffset(I),H=(0,So.jI)(v);return c.createElement(Do.R,{role:"row","aria-label":i,className:M.root,componentRef:this._rootComponent,elementRef:this._rootElement,onMouseMove:this._onRootMouseMove,"data-automationid":"DetailsHeader",direction:xo.E.horizontal},I?[c.createElement("div",{key:"__checkbox",className:M.cellIsCheck,"aria-labelledby":"".concat(this._id,"-checkTooltip"),onClick:P?void 0:this._onSelectAllClicked,role:"columnheader"},m({hostClassName:M.checkTooltip,id:"".concat(this._id,"-checkTooltip"),setAriaDescribedBy:!1,content:a,children:c.createElement(Yo,{id:"".concat(this._id,"-check"),"aria-label":f===Wo.Qc.multiple?a:l,"data-is-focusable":!P||void 0,isHeader:!0,selected:T,anySelected:!1,canSelect:!P,className:M.check,onRenderDetailsCheckbox:b,useFastIcons:S,isVisible:A})},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:a&&!P?c.createElement("label",{key:"__checkboxLabel",id:"".concat(this._id,"-checkTooltip"),className:M.accessibleLabel,"aria-hidden":!0},a):l&&P?c.createElement("label",{key:"__checkboxLabel",id:"".concat(this._id,"-checkTooltip"),className:M.accessibleLabel,"aria-hidden":!0},l):null]:null,F?c.createElement("div",{className:M.cellIsGroupExpander,onClick:this._onToggleCollapseAll,"data-is-focusable":!0,"aria-label":r,"aria-expanded":!_,role:"columnheader"},c.createElement(O,{className:M.collapseButton,iconName:H?"ChevronLeftMed":"ChevronRightMed"}),c.createElement("span",{className:M.accessibleLabel},r)):B?c.createElement("div",{className:M.cellIsGroupExpander,"data-is-focusable":!1,role:"columnheader"}):null,c.createElement(wo,{indentWidth:d,role:"gridcell",count:y-1}),o.map((function(t,n){var i=!!R&&(n>=L&&n<o.length-N);return[R&&(i||n===o.length-N)&&e._renderDropHint(n),c.createElement(ni,{column:t,styles:t.styles,key:t.key,columnIndex:j+n,parentId:e._id,isDraggable:i,updateDragInfo:e._updateDragInfo,dragDropHelper:e._dragDropHelper,onColumnClick:u,onColumnContextMenu:p,onRenderColumnHeaderTooltip:e.props.onRenderColumnHeaderTooltip,isDropped:e._onDropIndexInfo.targetIndex===n,cellStyleProps:e.props.cellStyleProps,useFastIcons:S}),e._renderColumnDivider(n)]})),R&&0===N&&this._renderDropHint(o.length),w&&c.createElement(Eo.W,null,c.createElement("div",{className:M.sizingOverlay,onMouseMove:this._onSizerMouseMove,onMouseUp:this._onSizerMouseUp})))},t.prototype.focus=function(){var e;return!!(null===(e=this._rootComponent.current)||void 0===e?void 0:e.focus())},t.prototype._getColumnReorderProps=function(){var e=this.props,t=e.columnReorderOptions;return e.columnReorderProps||t&&(0,k.__assign)((0,k.__assign)({},t),{onColumnDragEnd:void 0})},t.prototype._getHeaderDragDropOptions=function(){return{selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver}},t.prototype._isValidCurrentDropHintIndex=function(){return this._currentDropHintIndex>=0},t.prototype._isCheckboxColumnHidden=function(){var e=this.props,t=e.selectionMode,n=e.checkboxVisibility;return t===Wo.Qc.none||n===vo.hidden},t.prototype._resetDropHints=function(){this._currentDropHintIndex>=0&&(this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"none"),this._currentDropHintIndex=-1)},t.prototype._updateDropHintElement=function(e,t){e.childNodes[1].style.display=t,e.childNodes[0].style.display=t},t.prototype._isEventOnHeader=function(e){if(this._rootElement.current){var t=this._rootElement.current.getBoundingClientRect();if(e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom)return go.header}},t.prototype._renderColumnDivider=function(e){var t=this.props.columns,n=(void 0===t?ii:t)[e],o=n.onRenderDivider;return o?o({column:n,columnIndex:e},this._renderColumnSizer):this._renderColumnSizer({column:n,columnIndex:e})},t.prototype._renderDropHint=function(e){var t=this._classNames,n=this.props.useFastIcons?To.l8:C.I;return c.createElement("div",{key:"dropHintKey",className:t.dropHintStyle,id:"columnDropHint_".concat(e)},c.createElement("div",{role:"presentation",key:"dropHintCircleKey",className:t.dropHintCaretStyle,"data-is-focusable":!1,"data-sizer-index":e,"aria-hidden":!0},c.createElement(n,{iconName:"CircleShapeSolid"})),c.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":e,className:t.dropHintLineStyle}))},t.prototype._onSizerDoubleClick=function(e,t){var n=this.props,o=n.onColumnAutoResized,i=n.columns;o&&o((void 0===i?ii:i)[e],e)},t.prototype._onSelectionChanged=function(){var e=!!this.props.selection&&this.props.selection.isAllSelected();this.state.isAllSelected!==e&&this.setState({isAllSelected:e})},t.defaultProps={selectAllVisibility:Zo.visible,collapseAllVisibility:ko.visible,useFastIcons:!0},t}(c.Component);function ai(e,t,n,o){return e?t<=n&&t>=o:t>=n&&t<=o}function si(e,t,n){return e?t>=n:t<=n}function li(e,t,n){return e?t<=n:t>=n}function ci(e){e.stopPropagation()}var di=(0,Cn.I)(ri,(function(e){var t,n,o,i,r=e.theme,a=e.className,s=e.isAllSelected,l=e.isResizingColumn,c=e.isSizing,d=e.isAllCollapsed,u=e.cellStyleProps,p=void 0===u?Bo:u,h=r.semanticColors,m=r.palette,g=r.fonts,f=(0,K.Km)(Ho,r),v={iconForegroundColor:h.bodySubtext,headerForegroundColor:h.bodyText,headerBackgroundColor:h.bodyBackground,resizerColor:m.neutralTertiaryAlt},b={opacity:1,transition:"opacity 0.3s linear"},y=zo(e);return{root:[f.root,g.small,{display:"inline-block",background:v.headerBackgroundColor,position:"relative",minWidth:"100%",verticalAlign:"top",height:42,lineHeight:42,whiteSpace:"nowrap",boxSizing:"content-box",paddingBottom:"1px",paddingTop:"16px",borderBottom:"1px solid ".concat(h.bodyDivider),cursor:"default",userSelect:"none",selectors:(t={},t["&:hover .".concat(f.check)]={opacity:1},t["& .".concat(f.tooltipHost," .").concat(f.checkTooltip)]={display:"block"},t)},s&&f.isAllSelected,l&&f.isResizingColumn,a],check:[f.check,{height:42},{selectors:(n={},n[".".concat(No.Y2," &:focus")]={opacity:1},n)}],cellWrapperPadded:{paddingRight:p.cellExtraRightPadding+p.cellRightPadding},cellIsCheck:[y,f.cellIsCheck,{position:"relative",padding:0,margin:0,display:"inline-flex",alignItems:"center",border:"none"},s&&{opacity:1}],cellIsGroupExpander:[y,{display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:g.small.fontSize,padding:0,border:"none",width:36,color:m.neutralSecondary,selectors:{":hover":{backgroundColor:m.neutralLighter},":active":{backgroundColor:m.neutralLight}}}],cellIsActionable:{selectors:{":hover":{color:h.bodyText,background:h.listHeaderBackgroundHovered},":active":{background:h.listHeaderBackgroundPressed}}},cellIsEmpty:{textOverflow:"clip"},cellSizer:[f.cellSizer,(0,K.QN)(),{display:"inline-block",position:"relative",cursor:"ew-resize",bottom:0,top:0,overflow:"hidden",height:"inherit",background:"transparent",zIndex:1,width:16,selectors:(o={":after":{content:'""',position:"absolute",top:0,bottom:0,width:1,background:v.resizerColor,opacity:0,left:"50%"},":focus:after":b,":hover:after":b},o["&.".concat(f.isResizing,":after")]=[b,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)"}],o)}],cellIsResizing:f.isResizing,cellSizerStart:{margin:"0 -8px"},cellSizerEnd:{margin:0,marginLeft:-16},collapseButton:[f.collapseButton,{transformOrigin:"50% 50%",transition:"transform .1s linear"},d?[f.isCollapsed,{transform:"rotate(0deg)"}]:{transform:(0,So.jI)(r)?"rotate(-90deg)":"rotate(90deg)"}],checkTooltip:f.checkTooltip,sizingOverlay:c&&{position:"absolute",left:0,top:0,right:0,bottom:0,cursor:"ew-resize",background:"rgba(255, 255, 255, 0)",selectors:(i={},i[K.up]=(0,k.__assign)({background:"transparent"},(0,K.Qg)()),i)},accessibleLabel:K.dX,dropHintCircleStyle:[f.dropHintCircleStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,height:9,width:9,borderRadius:"50%",marginLeft:-5,top:34,overflow:"visible",zIndex:10,border:"1px solid ".concat(m.themePrimary),background:m.white}],dropHintCaretStyle:[f.dropHintCaretStyle,{display:"none",position:"absolute",top:-28,left:-6.5,fontSize:g.medium.fontSize,color:m.themePrimary,overflow:"visible",zIndex:10}],dropHintLineStyle:[f.dropHintLineStyle,{display:"none",position:"absolute",bottom:0,top:0,overflow:"hidden",height:42,width:1,background:m.themePrimary,zIndex:10}],dropHintStyle:{display:"inline-block",position:"absolute"}}}),void 0,{scope:"DetailsHeader"}),ui=n(50452),pi=function(e){var t=e.columns,n=e.rowClassNames,o=e.cellStyleProps,i=void 0===o?Bo:o,r=e.item,a=e.itemIndex,s=e.isSelected,l=e.onRenderItemColumn,d=e.getCellValueKey,u=e.onRenderField,p=e.cellsByColumn,h=e.enableUpdateAnimations,m=e.rowHeaderId,g=c.useRef(),f=g.current||(g.current={}),v=c.useCallback((function(e){var t=e.column,o=e.cellValueKey,r=e.className,a=e.onRender,s=e.item,l=e.itemIndex,d="undefined"===typeof t.calculatedWidth?"auto":t.calculatedWidth+i.cellLeftPadding+i.cellRightPadding+(t.isPadded?i.cellExtraRightPadding:0),u="".concat(t.key).concat(void 0!==o?"-".concat(o):"");return c.createElement("div",{key:u,id:t.isRowHeader?m:void 0,role:t.isRowHeader?"rowheader":"gridcell",className:(0,I.A)(t.className,t.isMultiline&&n.isMultiline,t.isRowHeader&&n.isRowHeader,n.cell,t.isPadded?n.cellPadded:n.cellUnpadded,r),style:{width:d},"data-automationid":"DetailsRowCell","data-automation-key":t.key},a(s,l,t))}),[n,i,m]);return c.createElement("div",{className:n.fields,"data-automationid":"DetailsRowFields",role:"presentation"},t.map((function(e){var t=e.getValueKey,o=void 0===t?d:t,i=p&&e.key in p&&function(){return p[e.key]}||e.onRender||l||hi,c=v;e.onRenderField&&(c=(0,_o.j)(e.onRenderField,c)),u&&(c=(0,_o.j)(u,c));var m=f[e.key],g=h&&o?o(r,a,e):void 0,b=!1;return void 0!==g&&void 0!==m&&g!==m&&(b=!0),f[e.key]=g,c({item:r,itemIndex:a,isSelected:s,column:e,cellValueKey:g,className:b?n.cellAnimation:void 0,onRender:i})})))};function hi(e,t,n){return e&&n?function(e,t){var n=e&&t&&t.fieldName?e[t.fieldName]:"";return null!==n&&void 0!==n||(n=""),"boolean"===typeof n?n.toString():n}(e,n):null}var mi=(0,Sn.Z)(),gi=[],fi=function(e){function t(t){var n=e.call(this,t)||this;return n._root=c.createRef(),n._cellMeasurer=c.createRef(),n._focusZone=c.createRef(),n._onSelectionChanged=function(){var e=vi(n.props);(0,x.ab)(e,n.state.selectionState)||n.setState({selectionState:e})},n._updateDroppingState=function(e,t){var o=n.state.isDropping,i=n.props,r=i.dragDropEvents,a=i.item;e?r.onDragEnter&&(n._droppingClassNames=r.onDragEnter(a,t)):r.onDragLeave&&r.onDragLeave(a,t),o!==e&&n.setState({isDropping:e})},(0,L.f)(n),n._events=new M.g(n),n.state={selectionState:vi(t),columnMeasureInfo:void 0,isDropping:!1},n._droppingClassNames="",n}return(0,k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return(0,k.__assign)((0,k.__assign)({},t),{selectionState:vi(e)})},t.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,n=e.selection,o=e.item,i=e.onDidMount;t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getRowDragDropOptions())),n&&this._events.on(n,Wo.ij,this._onSelectionChanged),i&&o&&(this._onDidMountCalled=!0,i(this))},t.prototype.componentDidUpdate=function(e){var t=this.state,n=this.props,o=n.item,i=n.onDidMount,r=t.columnMeasureInfo;if(this.props.itemIndex===e.itemIndex&&this.props.item===e.item&&this.props.dragDropHelper===e.dragDropHelper||(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getRowDragDropOptions()))),r&&r.index>=0&&this._cellMeasurer.current){var a=this._cellMeasurer.current.getBoundingClientRect().width;r.onMeasureDone(a),this.setState({columnMeasureInfo:void 0})}o&&i&&!this._onDidMountCalled&&(this._onDidMountCalled=!0,i(this))},t.prototype.componentWillUnmount=function(){var e=this.props,t=e.item,n=e.onWillUnmount;n&&t&&n(this),this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this._events.dispose()},t.prototype.shouldComponentUpdate=function(e,t){if(this.props.useReducedRowRenderer){var n=vi(e);return this.state.selectionState.isSelected!==n.isSelected||!(0,x.ab)(this.props,e)}return!0},t.prototype.render=function(){var e,t=this.props,n=t.className,o=t.columns,i=void 0===o?gi:o,r=t.dragDropEvents,a=t.item,s=t.itemIndex,l=t.id,d=t.flatIndexOffset,u=void 0===d?2:d,p=t.onRenderCheck,h=void 0===p?this._onRenderCheck:p,m=t.onRenderDetailsCheckbox,g=t.onRenderItemColumn,f=t.onRenderField,v=t.getCellValueKey,b=t.selectionMode,y=t.checkboxVisibility,C=t.getRowAriaLabel,S=t.getRowAriaDescription,D=t.getRowAriaDescribedBy,T=t.isGridRow,E=t.checkButtonAriaLabel,w=t.checkboxCellClassName,_=t.rowFieldsAs,P=t.selection,A=t.indentWidth,R=t.enableUpdateAnimations,L=t.compact,N=t.theme,M=t.styles,O=t.cellsByColumn,j=t.groupNestingDepth,H=t.useFastIcons,z=void 0===H||H,U=t.cellStyleProps,W=t.group,K=t.focusZoneProps,G=t.disabled,q=void 0!==G&&G,V=this.state,Z=V.columnMeasureInfo,Y=V.isDropping,X=this.state.selectionState,$=X.isSelected,J=void 0!==$&&$,Q=X.isSelectionModal,ee=void 0!==Q&&Q,te=r?!(!r.canDrag||!r.canDrag(a)):void 0,ne=Y?this._droppingClassNames||"is-dropping":"",oe=C?C(a):void 0,ie=S?S(a):void 0,re=D?D(a):void 0,ae=!!P&&P.canSelectItem(a,s)&&!q,se=b===Wo.Qc.multiple,le=b!==Wo.Qc.none&&y!==vo.hidden,ce=b===Wo.Qc.none?void 0:J,de=W?s-W.startIndex+1:void 0,ue=W?W.count:void 0,pe=K?K.direction:xo.E.horizontal;this._classNames=(0,k.__assign)((0,k.__assign)({},this._classNames),mi(M,{theme:N,isSelected:J,canSelect:!se,anySelected:ee,checkboxCellClassName:w,droppingClassName:ne,className:n,compact:L,enableUpdateAnimations:R,cellStyleProps:U,disabled:q}));var he={isMultiline:this._classNames.isMultiline,isRowHeader:this._classNames.isRowHeader,cell:this._classNames.cell,cellAnimation:this._classNames.cellAnimation,cellPadded:this._classNames.cellPadded,cellUnpadded:this._classNames.cellUnpadded,fields:this._classNames.fields};(0,x.ab)(this._rowClassNames||{},he)||(this._rowClassNames=he);var me=_?(0,ui.C)(_,pi):pi,ge=c.createElement(me,{rowClassNames:this._rowClassNames,rowHeaderId:"".concat(l,"-header"),cellsByColumn:O,columns:i,item:a,itemIndex:s,isSelected:J,columnStartIndex:(le?1:0)+(j?1:0),onRenderItemColumn:g,onRenderField:f,getCellValueKey:v,enableUpdateAnimations:R,cellStyleProps:U}),fe=this.props.role?this.props.role:"row";this._ariaRowDescriptionId=(0,B.O)("DetailsRow-description");var ve=i.some((function(e){return!!e.isRowHeader})),be="".concat(l,"-checkbox")+(ve?" ".concat(l,"-header"):""),ye=T?{}:{"aria-level":j&&j+1||void 0,"aria-posinset":de,"aria-setsize":ue};return c.createElement(Do.R,(0,k.__assign)({"data-is-focusable":!0},(0,F.G1)(this.props,F.JM),"boolean"===typeof te?{"data-is-draggable":te,draggable:te}:{},K,ye,{direction:pe,elementRef:this._root,componentRef:this._focusZone,role:fe,"aria-label":oe,"aria-disabled":q||void 0,"aria-describedby":ie?this._ariaRowDescriptionId:re,className:this._classNames.root,"data-selection-index":s,"data-selection-touch-invoke":!0,"data-selection-disabled":null!==(e=this.props["data-selection-disabled"])&&void 0!==e?e:q||void 0,"data-item-index":s,"aria-rowindex":void 0===de?s+u:void 0,"data-automationid":"DetailsRow","aria-selected":ce,allowFocusRoot:!0}),ie?c.createElement("span",{key:"description",role:"presentation",hidden:!0,id:this._ariaRowDescriptionId},ie):null,le&&c.createElement("div",{role:"gridcell","data-selection-toggle":!0,className:this._classNames.checkCell},h({id:l?"".concat(l,"-checkbox"):void 0,selected:J,selectionMode:b,anySelected:ee,"aria-label":E,"aria-labelledby":l?be:void 0,canSelect:ae,compact:L,className:this._classNames.check,theme:N,isVisible:y===vo.always,onRenderDetailsCheckbox:m,useFastIcons:z})),c.createElement(wo,{indentWidth:A,role:"gridcell",count:0===j?-1:j}),a&&ge,Z&&c.createElement("span",{role:"presentation",className:(0,I.A)(this._classNames.cellMeasurer,this._classNames.cell),ref:this._cellMeasurer},c.createElement(me,{rowClassNames:this._rowClassNames,rowHeaderId:"".concat(l,"-header"),columns:[Z.column],item:a,itemIndex:s,columnStartIndex:(le?1:0)+(j?1:0)+i.length,onRenderItemColumn:g,getCellValueKey:v})))},t.prototype.measureCell=function(e,t){var n=this.props.columns,o=void 0===n?gi:n,i=(0,k.__assign)({},o[e]);i.minWidth=0,i.maxWidth=999999,delete i.calculatedWidth,this.setState({columnMeasureInfo:{index:e,column:i,onMeasureDone:t}})},t.prototype.focus=function(e){var t;return void 0===e&&(e=!1),!!(null===(t=this._focusZone.current)||void 0===t?void 0:t.focus(e))},t.prototype._onRenderCheck=function(e){return c.createElement(Yo,(0,k.__assign)({},e))},t.prototype._getRowDragDropOptions=function(){var e=this.props,t=e.item,n=e.itemIndex,o=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:n,context:{data:t,index:n},canDrag:o.canDrag,canDrop:o.canDrop,onDragStart:o.onDragStart,updateDropState:this._updateDroppingState,onDrop:o.onDrop,onDragEnd:o.onDragEnd,onDragOver:o.onDragOver}},t}(c.Component);function vi(e){var t,n=e.itemIndex,o=e.selection;return{isSelected:!!(null===o||void 0===o?void 0:o.isIndexSelected(n)),isSelectionModal:!!(null===(t=null===o||void 0===o?void 0:o.isModal)||void 0===t?void 0:t.call(o))}}var bi=(0,Cn.I)(fi,(function(e){var t,n,o,i,r,a,s,l,c,d,u,p,h,m,g=e.theme,f=e.isSelected,v=e.canSelect,b=e.droppingClassName,y=e.isCheckVisible,C=e.checkboxCellClassName,S=e.compact,D=e.className,x=e.cellStyleProps,T=void 0===x?Bo:x,E=e.enableUpdateAnimations,w=e.disabled,_=g.palette,I=g.fonts,P=_.neutralPrimary,A=_.white,R=_.neutralSecondary,L=_.neutralLighter,N=_.neutralLight,M=_.neutralDark,O=_.neutralQuaternaryAlt,B=g.semanticColors,F=B.focusBorder,j=B.linkHovered,H=(0,K.Km)(Oo,g),z={defaultHeaderText:P,defaultMetaText:R,defaultBackground:A,defaultHoverHeaderText:M,defaultHoverMetaText:P,defaultHoverBackground:L,selectedHeaderText:M,selectedMetaText:P,selectedBackground:N,selectedHoverHeaderText:M,selectedHoverMetaText:P,selectedHoverBackground:O,focusHeaderText:M,focusMetaText:P,focusBackground:N,focusHoverBackground:O},U=[(0,K.gm)(g,{inset:-1,borderColor:F,outlineColor:A,highContrastStyle:{top:2,right:2,bottom:2,left:2},pointerEvents:"none"}),H.isSelected,{color:z.selectedMetaText,background:z.selectedBackground,borderBottom:"1px solid ".concat(A),selectors:(t={"&:before":{position:"absolute",display:"block",top:-1,height:1,bottom:0,left:0,right:0,content:"",borderTop:"1px solid ".concat(A)}},t[".".concat(H.cell," > .").concat(Mo.e.root)]={color:j,selectors:(n={},n[K.up]={color:"HighlightText"},n)},t["&:hover"]={background:z.selectedHoverBackground,color:z.selectedHoverMetaText,selectors:(o={},o[K.up]={background:"Highlight",selectors:(i={},i[".".concat(H.cell)]={color:"HighlightText"},i[".".concat(H.cell," > .").concat(Mo.e.root)]={forcedColorAdjust:"none",color:"HighlightText"},i)},o[".".concat(H.isRowHeader)]={color:z.selectedHoverHeaderText,selectors:(r={},r[K.up]={color:"HighlightText"},r)},o)},t["&:focus"]={background:z.focusBackground,selectors:(a={},a[".".concat(H.cell)]={color:z.focusMetaText,selectors:(s={},s[K.up]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},s)},a[".".concat(H.isRowHeader)]={color:z.focusHeaderText,selectors:(l={},l[K.up]={color:"HighlightText"},l)},a[K.up]={background:"Highlight"},a)},t[K.up]=(0,k.__assign)((0,k.__assign)({background:"Highlight",color:"HighlightText"},(0,K.Qg)()),{selectors:{a:{color:"HighlightText"}}}),t["&:focus:hover"]={background:z.focusHoverBackground},t)}],W=[H.isContentUnselectable,{userSelect:"none",cursor:"default"}],G={minHeight:jo.compactRowHeight,border:0},q={minHeight:jo.compactRowHeight,paddingTop:jo.compactRowVerticalPadding,paddingBottom:jo.compactRowVerticalPadding,paddingLeft:"".concat(T.cellLeftPadding,"px")},V=[(0,K.gm)(g,{inset:-1}),H.cell,{display:"inline-block",position:"relative",boxSizing:"border-box",minHeight:jo.rowHeight,verticalAlign:"top",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingTop:jo.rowVerticalPadding,paddingBottom:jo.rowVerticalPadding,paddingLeft:"".concat(T.cellLeftPadding,"px"),selectors:(c={"& > button":{maxWidth:"100%"}},c["[data-is-focusable='true']"]=(0,K.gm)(g,{inset:-1,borderColor:R,outlineColor:A}),c)},f&&{selectors:(d={},d[K.up]=(0,k.__assign)({background:"Highlight",color:"HighlightText"},(0,K.Qg)()),d)},S&&q,w&&{opacity:.5}];return{root:[H.root,K.lw.fadeIn400,b,g.fonts.small,y&&H.isCheckVisible,(0,K.gm)(g,{borderColor:F,outlineColor:A}),{borderBottom:"1px solid ".concat(L),background:z.defaultBackground,color:z.defaultMetaText,display:"inline-flex",minWidth:"100%",minHeight:jo.rowHeight,whiteSpace:"nowrap",padding:0,boxSizing:"border-box",verticalAlign:"top",textAlign:"left",selectors:(u={},u[".".concat(H.listCellFirstChild," &:before")]={display:"none"},u["&:hover"]={background:z.defaultHoverBackground,color:z.defaultHoverMetaText,selectors:(p={},p[".".concat(H.isRowHeader)]={color:z.defaultHoverHeaderText},p[".".concat(H.cell," > .").concat(Mo.e.root)]={color:j},p)},u["&:hover .".concat(H.check)]={opacity:1},u[".".concat(No.Y2," &:focus .").concat(H.check)]={opacity:1},u[".ms-GroupSpacer"]={flexShrink:0,flexGrow:0},u)},f&&U,!v&&W,S&&G,D],cellUnpadded:{paddingRight:"".concat(T.cellRightPadding,"px")},cellPadded:{paddingRight:"".concat(T.cellExtraRightPadding+T.cellRightPadding,"px"),selectors:(h={},h["&.".concat(H.cellCheck)]={paddingRight:0},h)},cell:V,cellAnimation:E&&K.Dm.slideLeftIn40,cellMeasurer:[H.cellMeasurer,{overflow:"visible",whiteSpace:"nowrap"}],checkCell:[V,H.cellCheck,C,{padding:0,paddingTop:1,marginTop:-1,flexShrink:0}],fields:[H.fields,{display:"flex",alignItems:"stretch"}],isRowHeader:[H.isRowHeader,{color:z.defaultHeaderText,fontSize:I.medium.fontSize},f&&{color:z.selectedHeaderText,fontWeight:K.BO.semibold,selectors:(m={},m[K.up]={color:"HighlightText"},m)}],isMultiline:[V,{whiteSpace:"normal",wordBreak:"break-word",textOverflow:"clip"}],check:[H.check]}}),void 0,{scope:"DetailsRow"}),yi=n(53356),Ci=n(15535),Si=n(97943),ki=n(17938),Di=n(75224),xi={root:"ms-GroupedList",compact:"ms-GroupedList--Compact",group:"ms-GroupedList-group",link:"ms-Link",listCell:"ms-List-cell"},Ti="cubic-bezier(0.445, 0.050, 0.550, 0.950)",Ei={root:"ms-GroupHeader",compact:"ms-GroupHeader--compact",check:"ms-GroupHeader-check",dropIcon:"ms-GroupHeader-dropIcon",expand:"ms-GroupHeader-expand",isCollapsed:"is-collapsed",title:"ms-GroupHeader-title",isSelected:"is-selected",iconTag:"ms-Icon--Tag",group:"ms-GroupedList-group",isDropping:"is-dropping"},wi="cubic-bezier(0.075, 0.820, 0.165, 1.000)",_i="cubic-bezier(0.390, 0.575, 0.565, 1.000)",Ii="cubic-bezier(0.600, -0.280, 0.735, 0.045)",Pi=(0,Sn.Z)(),Ai=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleCollapse=function(){var e=n.props,t=e.group,o=e.onToggleCollapse,i=e.isGroupLoading,r=!n.state.isCollapsed,a=!r&&i&&i(t);n.setState({isCollapsed:r,isLoadingVisible:a}),o&&o(t)},n._onKeyUp=function(e){var t=n.props,o=t.group,i=t.onGroupHeaderKeyUp;if(i&&i(e,o),!e.defaultPrevented){var r=n.state.isCollapsed&&e.which===(0,So.SM)(P.c.right,n.props.theme);(!n.state.isCollapsed&&e.which===(0,So.SM)(P.c.left,n.props.theme)||r)&&(n._toggleCollapse(),e.stopPropagation(),e.preventDefault())}},n._onToggleClick=function(e){n._toggleCollapse(),e.stopPropagation(),e.preventDefault()},n._onHeaderClick=function(){var e=n.props,t=e.group,o=e.onGroupHeaderClick;o&&o(t)},n._onRenderTitle=function(e){if(!e.group)return null;var t=e.onRenderName?(0,_o.j)(e.onRenderName,n._onRenderName):n._onRenderName;return c.createElement("div",{className:n._classNames.title,id:n._id,onClick:n._onHeaderClick,role:"gridcell","aria-colspan":n.props.ariaColSpan,"data-selection-invoke":!0},t(e))},n._onRenderName=function(e){var t=e.group;return t?c.createElement(c.Fragment,null,c.createElement("span",null,t.name),c.createElement("span",{className:n._classNames.headerCount},"(",t.count,t.hasMoreData&&"+",")")):null},n._id=(0,B.O)("GroupHeader"),n.state={isCollapsed:n.props.group&&n.props.group.isCollapsed,isLoadingVisible:!1},n}return(0,k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.group){var n=e.group.isCollapsed,o=e.isGroupLoading,i=!n&&o&&o(e.group);return(0,k.__assign)((0,k.__assign)({},t),{isCollapsed:n||!1,isLoadingVisible:i||!1})}return t},t.prototype.render=function(){var e=this.props,t=e.group,n=e.groupLevel,o=void 0===n?0:n,i=e.viewport,r=e.selectionMode,a=e.loadingText,s=e.isSelected,l=void 0!==s&&s,d=e.selected,u=void 0!==d&&d,p=e.indentWidth,h=e.onRenderGroupHeaderCheckbox,m=e.isCollapsedGroupSelectVisible,g=void 0===m||m,f=e.expandButtonProps,v=e.expandButtonIcon,b=e.selectAllButtonProps,y=e.theme,S=e.styles,D=e.className,x=e.compact,T=e.ariaLevel,E=e.ariaPosInSet,w=e.ariaSetSize,_=e.ariaRowIndex,I=e.useFastIcons,P=this.props.onRenderTitle?(0,_o.j)(this.props.onRenderTitle,this._onRenderTitle):this._onRenderTitle,A=I?this._fastDefaultCheckboxRender:this._defaultCheckboxRender,R=h?(0,_o.j)(h,A):A,L=this.state,N=L.isCollapsed,M=L.isLoadingVisible,O=r===Wo.Qc.multiple,B=O&&(g||!(t&&t.isCollapsed)),F=u||l,j=(0,So.jI)(y);return this._classNames=Pi(S,{theme:y,className:D,selected:F,isCollapsed:N,compact:x}),t?c.createElement("div",{className:this._classNames.root,style:i?{minWidth:i.width}:{},role:"row","aria-level":T,"aria-setsize":w,"aria-posinset":E,"aria-rowindex":_,"data-is-focusable":!0,onKeyUp:this._onKeyUp,"aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabel?void 0:this._id,"aria-expanded":!this.state.isCollapsed,"aria-selected":O?F:void 0,"data-selection-index":t.startIndex,"data-selection-span":t.count},c.createElement("div",{className:this._classNames.groupHeaderContainer,role:"presentation"},B?c.createElement("div",{role:"gridcell"},c.createElement("button",(0,k.__assign)({"data-is-focusable":!1,type:"button",className:this._classNames.check,role:"checkbox",id:"".concat(this._id,"-check"),"aria-checked":F,"aria-labelledby":"".concat(this._id,"-check ").concat(this._id),"data-selection-toggle":!0},b),R({checked:F,theme:y},R))):r!==Wo.Qc.none&&c.createElement(wo,{indentWidth:48,count:1}),c.createElement(wo,{indentWidth:p,count:o}),c.createElement("div",{className:this._classNames.dropIcon,role:"presentation"},c.createElement(C.I,{iconName:"Tag"})),c.createElement("div",{role:"gridcell"},c.createElement("button",(0,k.__assign)({"data-is-focusable":!1,"data-selection-disabled":!0,type:"button",className:this._classNames.expand,onClick:this._onToggleClick,"aria-expanded":!this.state.isCollapsed},f),c.createElement(C.I,{className:this._classNames.expandIsCollapsed,iconName:v||(j?"ChevronLeftMed":"ChevronRightMed")}))),P(this.props),M&&c.createElement(nn.y,{label:a}))):null},t.prototype._defaultCheckboxRender=function(e){return c.createElement(Lo,{checked:e.checked})},t.prototype._fastDefaultCheckboxRender=function(e){return c.createElement(Ri,{theme:e.theme,checked:e.checked})},t.defaultProps={expandButtonProps:{"aria-label":"expand collapse group"}},t}(c.Component),Ri=c.memo((function(e){return c.createElement(Lo,{theme:e.theme,checked:e.checked,className:e.className,useFastIcons:!0})})),Li=(0,Cn.I)(Ai,(function(e){var t,n,o,i,r,a=e.theme,s=e.className,l=e.selected,c=e.isCollapsed,d=e.compact,u=Bo.cellLeftPadding,p=d?40:48,h=a.semanticColors,m=a.palette,g=a.fonts,f=(0,K.Km)(Ei,a),v=[(0,K.gm)(a),{cursor:"default",background:"none",backgroundColor:"transparent",border:"none",padding:0}];return{root:[f.root,(0,K.gm)(a),a.fonts.medium,{borderBottom:"1px solid ".concat(h.listBackground),cursor:"default",userSelect:"none",selectors:(t={":hover":{background:h.listItemBackgroundHovered,color:h.actionLinkHovered}},t["&:hover .".concat(f.check)]={opacity:1},t[".".concat(No.Y2," &:focus .").concat(f.check)]={opacity:1},t[":global(.".concat(f.group,".").concat(f.isDropping,")")]={selectors:(n={},n["& > .".concat(f.root," .").concat(f.dropIcon)]={transition:"transform ".concat(K.cs.durationValue4," ").concat(wi," ")+"opacity ".concat(K.cs.durationValue1," ").concat(_i),transitionDelay:K.cs.durationValue3,opacity:1,transform:"rotate(0.2deg) scale(1);"},n[".".concat(f.check)]={opacity:0},n)},t)},l&&[f.isSelected,{background:h.listItemBackgroundChecked,selectors:(o={":hover":{background:h.listItemBackgroundCheckedHovered}},o["".concat(f.check)]={opacity:1},o)}],d&&[f.compact,{border:"none"}],s],groupHeaderContainer:[{display:"flex",alignItems:"center",height:p}],headerCount:[{padding:"0px 4px"}],check:[f.check,v,{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:1,marginTop:-1,opacity:0,width:48,height:p,selectors:(i={},i[".".concat(No.Y2," &:focus")]={opacity:1},i)}],expand:[f.expand,v,{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",fontSize:g.small.fontSize,width:36,height:p,color:l?m.neutralPrimary:m.neutralSecondary,selectors:{":hover":{backgroundColor:l?m.neutralQuaternary:m.neutralLight},":active":{backgroundColor:l?m.neutralTertiaryAlt:m.neutralQuaternaryAlt}}}],expandIsCollapsed:[c?[f.isCollapsed,{transform:"rotate(0deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}]:{transform:(0,So.jI)(a)?"rotate(-90deg)":"rotate(90deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}],title:[f.title,{paddingLeft:u,fontSize:d?g.medium.fontSize:g.mediumPlus.fontSize,fontWeight:c?K.BO.regular:K.BO.semibold,cursor:"pointer",outline:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}],dropIcon:[f.dropIcon,{position:"absolute",left:-26,fontSize:K.fF.large,color:m.neutralSecondary,transition:"transform ".concat(K.cs.durationValue2," ").concat(Ii,", ")+"opacity ".concat(K.cs.durationValue4," ").concat(_i),opacity:0,transform:"rotate(0.2deg) scale(0.65)",transformOrigin:"10px 10px",selectors:(r={},r[":global(.".concat(f.iconTag,")")]={position:"absolute"},r)}]}}),void 0,{scope:"GroupHeader"}),Ni={root:"ms-GroupShowAll",link:"ms-Link"},Mi=(0,Sn.Z)(),Oi=(0,Cn.I)((function(e){var t=e.group,n=e.groupLevel,o=e.showAllLinkText,i=void 0===o?"Show All":o,r=e.styles,a=e.theme,s=e.onToggleSummarize,l=Mi(r,{theme:a}),d=(0,c.useCallback)((function(e){s(t),e.stopPropagation(),e.preventDefault()}),[s,t]);return t?c.createElement("div",{className:l.root},c.createElement(wo,{count:n}),c.createElement(f.N,{onClick:d},i)):null}),(function(e){var t,n=e.theme,o=n.fonts,i=(0,K.Km)(Ni,n);return{root:[i.root,{position:"relative",padding:"10px 84px",cursor:"pointer",selectors:(t={},t[".".concat(i.link)]={fontSize:o.small.fontSize},t)}]}}),void 0,{scope:"GroupShowAll"}),Bi={root:"ms-groupFooter"},Fi=(0,Sn.Z)(),ji=(0,Cn.I)((function(e){var t=e.group,n=e.groupLevel,o=e.footerText,i=e.indentWidth,r=e.styles,a=e.theme,s=Fi(r,{theme:a});return t&&o?c.createElement("div",{className:s.root},c.createElement(wo,{indentWidth:i,count:n}),o):null}),(function(e){var t=e.theme,n=e.className,o=(0,K.Km)(Bi,t);return{root:[t.fonts.medium,o.root,{position:"relative",padding:"5px 38px"},n]}}),void 0,{scope:"GroupFooter"}),Hi=n(73895),zi=n(96318),Ui=n(63903),Wi=n(44828),Ki=0,Gi=1,qi=2,Vi=3,Zi=function(e){if(void 0===e)return 0;var t=0;return"scrollTop"in e?t=e.scrollTop:"scrollY"in e&&(t=e.scrollY),Math.ceil(t)},Yi=function(e,t){"scrollTop"in e?e.scrollTop=t:"scrollY"in e&&e.scrollTo(e.scrollX,t)},Xi="spacer-",$i={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},Ji=function(e){return e.getBoundingClientRect()},Qi=Ji,er=Ji,tr=function(e){function t(t){var n=e.call(this,t)||this;return n._root=c.createRef(),n._surface=c.createRef(),n._pageRefs={},n._getDerivedStateFromProps=function(e,t){return e.items!==n.props.items||e.renderCount!==n.props.renderCount||e.startIndex!==n.props.startIndex||e.version!==n.props.version||!t.hasMounted&&n.props.renderEarly&&(0,Hi.S)()?(n._resetRequiredWindows(),n._requiredRect=null,n._measureVersion++,n._invalidatePageCache(),n._updatePages(e,t)):t},n._onRenderRoot=function(e){var t=e.rootRef,n=e.surfaceElement,o=e.divProps;return c.createElement("div",(0,k.__assign)({ref:t},o),n)},n._onRenderSurface=function(e){var t=e.surfaceRef,n=e.pageElements,o=e.divProps;return c.createElement("div",(0,k.__assign)({ref:t},o),n)},n._onRenderPage=function(e,t){for(var o,i=n.props,r=i.onRenderCell,a=i.onRenderCellConditional,s=i.role,l=e.page,d=l.items,u=void 0===d?[]:d,p=l.startIndex,h=(0,k.__rest)(e,["page"]),m=void 0===s?"listitem":"presentation",g=[],f=0;f<u.length;f++){var v=p+f,b=u[f],y=n.props.getKey?n.props.getKey(b,v):b&&b.key;null!==y&&void 0!==y||(y=v);var C=null!==a&&void 0!==a?a:r,S=null!==(o=null===C||void 0===C?void 0:C(b,v,n.props.ignoreScrollingState?void 0:n.state.isScrolling))&&void 0!==o?o:null;a&&!S||g.push(c.createElement("div",{role:m,className:"ms-List-cell",key:y,"data-list-index":v,"data-automationid":"ListCell"},S))}return c.createElement("div",(0,k.__assign)({},h),g)},(0,L.f)(n),n.state={pages:[],isScrolling:!1,getDerivedStateFromProps:n._getDerivedStateFromProps,hasMounted:!1},n._estimatedPageHeight=0,n._totalEstimates=0,n._requiredWindowsAhead=0,n._requiredWindowsBehind=0,n._measureVersion=0,n._cachedPageHeights={},n._estimatedPageHeight=0,n._focusedIndex=-1,n._pageCache={},n}return(0,k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.getDerivedStateFromProps(e,t)},Object.defineProperty(t.prototype,"pageRefs",{get:function(){return this._pageRefs},enumerable:!1,configurable:!0}),t.prototype.scrollToIndex=function(e,t,n){void 0===n&&(n=Ki);for(var o=this.props.startIndex,i=o+this._getRenderCount(),r=this._allowedRect,a=0,s=1,l=o;l<i;l+=s){var c=this._getPageSpecification(this.props,l,r),d=c.height;if(s=c.itemCount,l<=e&&l+s>e){if(t&&this._scrollElement){for(var u=er(this._scrollElement),p=Zi(this._scrollElement),h={top:p,bottom:p+u.height},m=e-l,g=0;g<m;++g)a+=t(l+g);var f=a+t(e);switch(n){case Gi:return void Yi(this._scrollElement,a);case qi:return void Yi(this._scrollElement,f-u.height);case Vi:return void Yi(this._scrollElement,(a+f-u.height)/2)}if(a>=h.top&&f<=h.bottom)return;a<h.top||f>h.bottom&&(a=f-u.height)}return void(this._scrollElement&&Yi(this._scrollElement,a))}a+=d}},t.prototype.getStartItemIndexInView=function(e){for(var t=0,n=this.state.pages||[];t<n.length;t++){var o=n[t];if(!o.isSpacer&&(this._scrollTop||0)>=o.top&&(this._scrollTop||0)<=o.top+o.height){if(!e){var i=Math.floor(o.height/o.itemCount);return o.startIndex+Math.floor((this._scrollTop-o.top)/i)}for(var r=0,a=o.startIndex;a<o.startIndex+o.itemCount;a++){i=e(a);if(o.top+r<=this._scrollTop&&this._scrollTop<o.top+r+i)return a;r+=i}}}return 0},t.prototype.componentDidMount=function(){this._async=new N.j(this),this._events=new M.g(this),this._onAsyncScrollDebounced=this._async.debounce(this._onAsyncScroll,100,{leading:!1,maxWait:500}),this._onAsyncIdleDebounced=this._async.debounce(this._onAsyncIdle,200,{leading:!1}),this._onAsyncResizeDebounced=this._async.debounce(this._onAsyncResize,16,{leading:!1}),this._onScrollingDoneDebounced=this._async.debounce(this._onScrollingDone,500,{leading:!1}),this._scrollElement=(0,zi.Hc)(this._root.current),this._scrollTop=0,this.setState((0,k.__assign)((0,k.__assign)({},this._updatePages(this.props,this.state)),{hasMounted:!0})),this._measureVersion++;var e=(0,ce.k_)(this.context);this._events.on(e,"resize",this._onAsyncResizeDebounced),this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0),this._scrollElement&&(this._events.on(this._scrollElement,"scroll",this._onScroll),this._events.on(this._scrollElement,"scroll",this._onAsyncScrollDebounced))},t.prototype.componentDidUpdate=function(e,t){var n=this.props,o=this.state;if(this.state.pagesVersion!==t.pagesVersion){if(n.getPageHeight)this._onAsyncIdleDebounced();else this._updatePageMeasurements(o.pages)?(this._materializedRect=null,this._hasCompletedFirstRender?this._onAsyncScrollDebounced():(this._hasCompletedFirstRender=!0,this.setState(this._updatePages(n,o)))):this._onAsyncIdleDebounced();n.onPagesUpdated&&n.onPagesUpdated(o.pages)}},t.prototype.componentWillUnmount=function(){var e,t;null===(e=this._async)||void 0===e||e.dispose(),null===(t=this._events)||void 0===t||t.dispose(),delete this._scrollElement},t.prototype.shouldComponentUpdate=function(e,t){var n=this.state.pages,o=t.pages,i=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.version!==this.props.version)return!0;if(e.className!==this.props.className)return!0;if(e.items===this.props.items&&n.length===o.length)for(var r=0;r<n.length;r++){var a=n[r],s=o[r];if(a.key!==s.key||a.itemCount!==s.itemCount){i=!0;break}}else i=!0;return i},t.prototype.forceUpdate=function(){this._invalidatePageCache(),this._updateRenderRects(this.props,this.state,!0),this.setState(this._updatePages(this.props,this.state)),this._measureVersion++,e.prototype.forceUpdate.call(this)},t.prototype.getTotalListHeight=function(){return this._surfaceRect.height},t.prototype.render=function(){for(var e=this.props,t=e.className,n=e.role,o=void 0===n?"list":n,i=e.onRenderSurface,r=e.onRenderRoot,a=this.state.pages,s=void 0===a?[]:a,l=[],c=(0,F.G1)(this.props,F.JM),d=0,u=s;d<u.length;d++){var p=u[d];l.push(this._renderPage(p))}var h=i?(0,_o.j)(i,this._onRenderSurface):this._onRenderSurface;return(r?(0,_o.j)(r,this._onRenderRoot):this._onRenderRoot)({rootRef:this._root,pages:s,surfaceElement:h({surfaceRef:this._surface,pages:s,pageElements:l,divProps:{role:"presentation",className:"ms-List-surface"}}),divProps:(0,k.__assign)((0,k.__assign)({},c),{className:(0,I.A)("ms-List",t),role:l.length>0?o:void 0,"aria-label":l.length>0?c["aria-label"]:void 0})})},t.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)},t.prototype._invalidatePageCache=function(){this._pageCache={}},t.prototype._renderPage=function(e){var t,n=this,o=this.props.usePageCache;if(o&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var i=this._getPageStyle(e),r=this.props.onRenderPage,a=(void 0===r?this._onRenderPage:r)({page:e,className:"ms-List-page",key:e.key,ref:function(t){n._pageRefs[e.key]=t},style:i,role:"presentation"},this._onRenderPage);return o&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:a}),a},t.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return(0,k.__assign)((0,k.__assign)({},t?t(e):{}),e.items?{}:{height:e.height})},t.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var n=t.getAttribute("data-list-index");if(n){this._focusedIndex=Number(n);break}t=(0,Ui.P)(t)}},t.prototype._onScroll=function(){this.state.isScrolling||this.props.ignoreScrollingState||this.setState({isScrolling:!0}),this._resetRequiredWindows(),this._onScrollingDoneDebounced()},t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0,this._requiredWindowsBehind=0},t.prototype._onAsyncScroll=function(){var e,t;this._updateRenderRects(this.props,this.state),this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this.setState(this._updatePages(this.props,this.state))},t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,n=e.renderedWindowsBehind,o=this._requiredWindowsAhead,i=this._requiredWindowsBehind,r=Math.min(t,o+1),a=Math.min(n,i+1);r===o&&a===i||(this._requiredWindowsAhead=r,this._requiredWindowsBehind=a,this._updateRenderRects(this.props,this.state),this.setState(this._updatePages(this.props,this.state))),(t>r||n>a)&&this._onAsyncIdleDebounced()},t.prototype._onScrollingDone=function(){this.props.ignoreScrollingState||this.setState({isScrolling:!1})},t.prototype._onAsyncResize=function(){this.forceUpdate()},t.prototype._updatePages=function(e,t){this._requiredRect||this._updateRenderRects(e,t);var n=this._buildPages(e,t),o=t.pages;return this._notifyPageChanges(o,n.pages,this.props),(0,k.__assign)((0,k.__assign)((0,k.__assign)({},t),n),{pagesVersion:{}})},t.prototype._notifyPageChanges=function(e,t,n){var o=n.onPageAdded,i=n.onPageRemoved;if(o||i){for(var r={},a=0,s=e;a<s.length;a++){(d=s[a]).items&&(r[d.startIndex]=d)}for(var l=0,c=t;l<c.length;l++){var d;(d=c[l]).items&&(r[d.startIndex]?delete r[d.startIndex]:this._onPageAdded(d))}for(var u in r)r.hasOwnProperty(u)&&this._onPageRemoved(r[u])}},t.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var n=0;n<e.length;n++){var o=e[n];o.items&&(t=this._measurePage(o)||t)}return t},t.prototype._measurePage=function(e){var t=!1,n=this._pageRefs[e.key],o=this._cachedPageHeights[e.startIndex];if(n&&this._shouldVirtualize()&&(!o||o.measureVersion!==this._measureVersion)){var i={width:n.clientWidth,height:n.clientHeight};(i.height||i.width)&&(t=e.height!==i.height,e.height=i.height,this._cachedPageHeights[e.startIndex]={height:i.height,measureVersion:this._measureVersion},this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+i.height)/(this._totalEstimates+1)),this._totalEstimates++)}return t},t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)},t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)},t.prototype._buildPages=function(e,t){var n=e.renderCount,o=e.items,i=e.startIndex,r=e.getPageHeight;n=this._getRenderCount(e);for(var a=(0,k.__assign)({},$i),s=[],l=1,c=0,d=null,u=this._focusedIndex,p=i+n,h=this._shouldVirtualize(e),m=0===this._estimatedPageHeight&&!r,g=this._allowedRect,f=function(n){var r=v._getPageSpecification(e,n,g),f=r.height,b=r.data,y=r.key;l=r.itemCount;var C,S,k=c+f-1,D=(0,H.SL)(t.pages,(function(e){return!!e.items&&e.startIndex===n}))>-1,x=!g||k>=g.top&&c<=g.bottom,T=!v._requiredRect||k>=v._requiredRect.top&&c<=v._requiredRect.bottom;if(!m&&(T||x&&D)||!h||u>=n&&u<n+l||n===i){d&&(s.push(d),d=null);var E=Math.min(l,p-n),w=v._createPage(y,o.slice(n,n+E),n,void 0,void 0,b);w.top=c,w.height=f,v._visibleRect&&v._visibleRect.bottom&&(w.isVisible=k>=v._visibleRect.top&&c<=v._visibleRect.bottom),s.push(w),T&&v._allowedRect&&(C=a,S={top:c,bottom:k,height:f,left:g.left,right:g.right,width:g.width},C.top=S.top<C.top||-1===C.top?S.top:C.top,C.left=S.left<C.left||-1===C.left?S.left:C.left,C.bottom=S.bottom>C.bottom||-1===C.bottom?S.bottom:C.bottom,C.right=S.right>C.right||-1===C.right?S.right:C.right,C.width=C.right-C.left+1,C.height=C.bottom-C.top+1)}else d||(d=v._createPage(Xi+n,void 0,n,0,void 0,b,!0)),d.height=(d.height||0)+(k-c)+1,d.itemCount+=l;if(c+=k-c+1,m&&h)return"break"},v=this,b=i;b<p;b+=l){if("break"===f(b))break}return d&&(d.key=Xi+"end",s.push(d)),this._materializedRect=a,(0,k.__assign)((0,k.__assign)({},t),{pages:s,measureVersion:this._measureVersion})},t.prototype._getPageSpecification=function(e,t,n){var o=e.getPageSpecification;if(o){var i=o(t,n,e.items),r=i.itemCount,a=void 0===r?this._getItemCountForPage(t,n):r,s=i.height;return{itemCount:a,height:void 0===s?this._getPageHeight(t,n,a):s,data:i.data,key:i.key}}return{itemCount:a=this._getItemCountForPage(t,n),height:this._getPageHeight(t,n,a)}},t.prototype._getPageHeight=function(e,t,n){if(this.props.getPageHeight)return this.props.getPageHeight(e,t,n,this.props.items);var o=this._cachedPageHeights[e];return o?o.height:this._estimatedPageHeight||30},t.prototype._getItemCountForPage=function(e,t){var n=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return n||10},t.prototype._createPage=function(e,t,n,o,i,r,a){void 0===n&&(n=-1),void 0===o&&(o=t?t.length:0),void 0===i&&(i={}),e=e||"page-"+n;var s=this._pageCache[e];return s&&s.page?s.page:{key:e,startIndex:n,itemCount:o,items:t,style:i,top:0,height:0,data:r,isSpacer:a||!1}},t.prototype._getRenderCount=function(e){var t=e||this.props,n=t.items,o=t.startIndex,i=t.renderCount;return void 0===i?n?n.length-o:0:i},t.prototype._updateRenderRects=function(e,t,n){var o=e.renderedWindowsAhead,i=e.renderedWindowsBehind,r=t.pages;if(this._shouldVirtualize(e)){var a=this._surfaceRect||(0,k.__assign)({},$i),s=function(e){if(void 0===e)return 0;var t=0;return"scrollHeight"in e?t=e.scrollHeight:"document"in e&&(t=e.document.documentElement.scrollHeight),t}(this._scrollElement),l=Zi(this._scrollElement);this._surface.current&&(n||!r||!this._surfaceRect||!s||s!==this._scrollHeight||Math.abs(this._scrollTop-l)>this._estimatedPageHeight/3)&&(a=this._surfaceRect=Qi(this._surface.current),this._scrollTop=l),!n&&s&&s===this._scrollHeight||this._measureVersion++,this._scrollHeight=s||0;var c=Math.max(0,-a.top),d=(0,Wi.z)(this._root.current),u={top:c,left:a.left,bottom:c+d.innerHeight,right:a.right,width:a.width,height:d.innerHeight};this._requiredRect=nr(u,this._requiredWindowsBehind,this._requiredWindowsAhead),this._allowedRect=nr(u,i,o),this._visibleRect=u}},t.defaultProps={startIndex:0,onRenderCell:function(e,t,n){return c.createElement(c.Fragment,null,e&&e.name||"")},onRenderCellConditional:void 0,renderedWindowsAhead:2,renderedWindowsBehind:2},t.contextType=le._0,t}(c.Component);function nr(e,t,n){var o=e.top-t*e.height,i=e.height+(t+n)*e.height;return{top:o,bottom:o+i,height:i,left:e.left,right:e.right,width:e.width}}var or=function(e){function t(n){var o=e.call(this,n)||this;o._root=c.createRef(),o._list=c.createRef(),o._subGroupRefs={},o._droppingClassName="",o._onRenderGroupHeader=function(e){return c.createElement(Li,(0,k.__assign)({},e))},o._onRenderGroupShowAll=function(e){return c.createElement(Oi,(0,k.__assign)({},e))},o._onRenderGroupFooter=function(e){return c.createElement(ji,(0,k.__assign)({},e))},o._renderSubGroup=function(e,n){var i=o.props,r=i.dragDropEvents,a=i.dragDropHelper,s=i.eventsToRegister,l=i.getGroupItemLimit,d=i.groupNestingDepth,u=i.groupProps,p=i.items,h=i.headerProps,m=i.showAllProps,g=i.footerProps,f=i.listProps,v=i.onRenderCell,b=i.selection,y=i.selectionMode,C=i.viewport,S=i.onRenderGroupHeader,k=i.onRenderGroupShowAll,D=i.onRenderGroupFooter,x=i.onShouldVirtualize,T=i.group,E=i.compact,w=e.level?e.level+1:d;return!e||e.count>0||u&&u.showEmptyGroups?c.createElement(t,{ref:function(e){return o._subGroupRefs["subGroup_"+n]=e},key:o._getGroupKey(e,n),dragDropEvents:r,dragDropHelper:a,eventsToRegister:s,footerProps:g,getGroupItemLimit:l,group:e,groupIndex:n,groupNestingDepth:w,groupProps:u,headerProps:h,items:p,listProps:f,onRenderCell:v,selection:b,selectionMode:y,showAllProps:m,viewport:C,onRenderGroupHeader:S,onRenderGroupShowAll:k,onRenderGroupFooter:D,onShouldVirtualize:x,groups:T?T.children:[],compact:E}):null},o._getGroupDragDropOptions=function(){var e=o.props,t=e.group,n=e.groupIndex,i=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:-1,context:{data:t,index:n,isGroup:!0},updateDropState:o._updateDroppingState,canDrag:i.canDrag,canDrop:i.canDrop,onDrop:i.onDrop,onDragStart:i.onDragStart,onDragEnter:i.onDragEnter,onDragLeave:i.onDragLeave,onDragEnd:i.onDragEnd,onDragOver:i.onDragOver}},o._updateDroppingState=function(e,t){var n=o.state.isDropping,i=o.props,r=i.dragDropEvents,a=i.group;n!==e&&(n?r&&r.onDragLeave&&r.onDragLeave(a,t):r&&r.onDragEnter&&(o._droppingClassName=r.onDragEnter(a,t)),o.setState({isDropping:e}))};var i=n.selection,r=n.group;return(0,L.f)(o),o._id=(0,B.O)("GroupedListSection"),o.state={isDropping:!1,isSelected:!(!i||!r)&&i.isRangeSelected(r.startIndex,r.count)},o._events=new M.g(o),o}return(0,k.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,n=e.selection;t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())),n&&this._events.on(n,Wo.ij,this._onSelectionChange)},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._dragDropSubscription&&this._dragDropSubscription.dispose()},t.prototype.componentDidUpdate=function(e){this.props.group===e.group&&this.props.groupIndex===e.groupIndex&&this.props.dragDropHelper===e.dragDropHelper||(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())))},t.prototype.render=function(){var e=this.props,t=e.getGroupItemLimit,n=e.group,o=e.groupIndex,i=e.headerProps,r=e.showAllProps,a=e.footerProps,s=e.viewport,l=e.selectionMode,d=e.onRenderGroupHeader,u=void 0===d?this._onRenderGroupHeader:d,p=e.onRenderGroupShowAll,h=void 0===p?this._onRenderGroupShowAll:p,m=e.onRenderGroupFooter,g=void 0===m?this._onRenderGroupFooter:m,f=e.onShouldVirtualize,v=e.groupedListClassNames,b=e.groups,y=e.compact,C=e.listProps,S=void 0===C?{}:C,D=this.state.isSelected,x=n&&t?t(n):1/0,T=n&&!n.children&&!n.isCollapsed&&!n.isShowingAll&&(n.count>x||n.hasMoreData),E=n&&n.children&&n.children.length>0,w=S.version,_={group:n,groupIndex:o,groupLevel:n?n.level:0,isSelected:D,selected:D,viewport:s,selectionMode:l,groups:b,compact:y},P={groupedListId:this._id,ariaLevel:(null===n||void 0===n?void 0:n.level)?n.level+1:1,ariaSetSize:b?b.length:void 0,ariaPosInSet:void 0!==o?o+1:void 0},A=(0,k.__assign)((0,k.__assign)((0,k.__assign)({},i),_),P),R=(0,k.__assign)((0,k.__assign)({},r),_),L=(0,k.__assign)((0,k.__assign)({},a),_),N=!!this.props.dragDropHelper&&this._getGroupDragDropOptions().canDrag(n)&&!!this.props.dragDropEvents.canDragGroups;return c.createElement("div",(0,k.__assign)({ref:this._root},N&&{draggable:!0},{className:(0,I.A)(v&&v.group,this._getDroppingClassName()),role:"presentation"}),u(A,this._onRenderGroupHeader),n&&n.isCollapsed?null:E?c.createElement(tr,{role:"presentation",ref:this._list,items:n?n.children:[],onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:f,version:w,id:this._id}):this._onRenderGroup(x),n&&n.isCollapsed?null:T&&h(R,this._onRenderGroupShowAll),g(L,this._onRenderGroupFooter))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this.forceListUpdate()},t.prototype.forceListUpdate=function(){var e=this.props.group;if(this._list.current){if(this._list.current.forceUpdate(),e&&e.children&&e.children.length>0)for(var t=e.children.length,n=0;n<t;n++){var o;(o=this._list.current.pageRefs["subGroup_"+String(n)])&&o.forceListUpdate()}}else(o=this._subGroupRefs["subGroup_"+String(0)])&&o.forceListUpdate()},t.prototype._onSelectionChange=function(){var e=this.props,t=e.group,n=e.selection;if(n&&t){var o=n.isRangeSelected(t.startIndex,t.count);o!==this.state.isSelected&&this.setState({isSelected:o})}},t.prototype._onRenderGroupCell=function(e,t,n){return function(o,i){return e(t,o,i,n)}},t.prototype._onRenderGroup=function(e){var t=this.props,n=t.group,o=t.items,i=t.onRenderCell,r=t.listProps,a=t.groupNestingDepth,s=t.onShouldVirtualize,l=t.groupProps,d=n&&!n.isShowingAll?n.count:o.length,u=n?n.startIndex:0;return c.createElement(tr,(0,k.__assign)({role:l&&l.role?l.role:"rowgroup","aria-label":null===n||void 0===n?void 0:n.name,items:o,onRenderCell:this._onRenderGroupCell(i,a,n),ref:this._list,renderCount:Math.min(d,e),startIndex:u,onShouldVirtualize:s,id:this._id},r))},t.prototype._returnOne=function(){return 1},t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(e.level)+String(t))},t.prototype._getDroppingClassName=function(){var e=this.state.isDropping,t=this.props,n=t.group,o=t.groupedListClassNames;return e=!(!n||!e),(0,I.A)(e&&this._droppingClassName,e&&"is-dropping",e&&o&&o.groupIsDropping)},t}(c.Component),ir=(0,Sn.Z)(),rr=Fo.rowHeight,ar=Fo.compactRowHeight,sr=function(e){function t(t){var n=e.call(this,t)||this;n._list=c.createRef(),n._renderGroup=function(e,t){var o=n.props,i=o.dragDropEvents,r=o.dragDropHelper,a=o.eventsToRegister,s=o.groupProps,l=o.items,d=o.listProps,u=o.onRenderCell,p=o.selectionMode,h=o.selection,m=o.viewport,g=o.onShouldVirtualize,f=o.groups,v=o.compact,b={onToggleSelectGroup:n._onToggleSelectGroup,onToggleCollapse:n._onToggleCollapse,onToggleSummarize:n._onToggleSummarize},y=(0,k.__assign)((0,k.__assign)({},s.headerProps),b),C=(0,k.__assign)((0,k.__assign)({},s.showAllProps),b),S=(0,k.__assign)((0,k.__assign)({},s.footerProps),b),D=n._getGroupNestingDepth();if(!s.showEmptyGroups&&e&&0===e.count)return null;var x=(0,k.__assign)((0,k.__assign)({},d||{}),{version:n.state.version});return c.createElement(or,{key:n._getGroupKey(e,t),dragDropEvents:i,dragDropHelper:r,eventsToRegister:a,footerProps:S,getGroupItemLimit:s&&s.getGroupItemLimit,group:e,groupIndex:t,groupNestingDepth:D,groupProps:s,headerProps:y,listProps:x,items:l,onRenderCell:u,onRenderGroupHeader:s.onRenderHeader,onRenderGroupShowAll:s.onRenderShowAll,onRenderGroupFooter:s.onRenderFooter,selectionMode:p,selection:h,showAllProps:C,viewport:m,onShouldVirtualize:g,groupedListClassNames:n._classNames,groups:f,compact:v})},n._getDefaultGroupItemLimit=function(e){return e.children&&e.children.length>0?e.children.length:e.count},n._getGroupItemLimit=function(e){var t=n.props.groupProps;return(t&&t.getGroupItemLimit?t.getGroupItemLimit:n._getDefaultGroupItemLimit)(e)},n._getGroupHeight=function(e){var t=n.props.compact?ar:rr;return t+(e.isCollapsed?0:t*n._getGroupItemLimit(e))},n._getPageHeight=function(e){var t=n.state.groups,o=n.props.getGroupHeight,i=void 0===o?n._getGroupHeight:o,r=t&&t[e];return r?i(r,e):0},n._onToggleCollapse=function(e){var t=n.props.groupProps,o=t&&t.headerProps&&t.headerProps.onToggleCollapse;e&&(o&&o(e),e.isCollapsed=!e.isCollapsed,n._updateIsSomeGroupExpanded(),n.forceUpdate())},n._onToggleSelectGroup=function(e){var t=n.props,o=t.selection,i=t.selectionMode;e&&o&&i===Wo.Qc.multiple&&o.toggleRangeSelected(e.startIndex,e.count)},n._isInnerZoneKeystroke=function(e){return e.which===(0,So.SM)(P.c.right)},n._onToggleSummarize=function(e){var t=n.props.groupProps,o=t&&t.showAllProps&&t.showAllProps.onToggleSummarize;o?o(e):(e&&(e.isShowingAll=!e.isShowingAll),n.forceUpdate())},n._getPageSpecification=function(e){var t=n.state.groups,o=t&&t[e];return{key:o&&o.key}},(0,L.f)(n),n._isSomeGroupExpanded=n._computeIsSomeGroupExpanded(t.groups);var o=t.listProps,i=(void 0===o?{}:o).version,r=void 0===i?{}:i;return n.state={groups:t.groups,items:t.items,listProps:t.listProps,version:r},n}return(0,k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.groups,o=e.selectionMode,i=e.compact,r=e.items,a=e.listProps,s=a&&a.version,l=(0,k.__assign)((0,k.__assign)({},t),{selectionMode:o,compact:i,groups:n,listProps:a,items:r}),c=!1;return s===(t.listProps&&t.listProps.version)&&r===t.items&&n===t.groups&&o===t.selectionMode&&i===t.compact||(c=!0),c&&(l=(0,k.__assign)((0,k.__assign)({},l),{version:{}})),l},t.prototype.scrollToIndex=function(e,t,n){this._list.current&&this._list.current.scrollToIndex(e,t,n)},t.prototype.getStartItemIndexInView=function(){return this._list.current.getStartItemIndexInView()||0},t.prototype.componentDidMount=function(){var e=this.props,t=e.groupProps,n=e.groups,o=void 0===n?[]:n;t&&t.isAllGroupsCollapsed&&this._setGroupsCollapsedState(o,t.isAllGroupsCollapsed)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.usePageCache,o=e.onShouldVirtualize,i=e.theme,r=e.role,a=void 0===r?"treegrid":r,s=e.styles,l=e.compact,d=e.focusZoneProps,u=void 0===d?{}:d,p=e.rootListProps,h=void 0===p?{}:p,m=this.state,g=m.groups,f=m.version;this._classNames=ir(s,{theme:i,className:t,compact:l});var v=u.shouldEnterInnerZone,b=void 0===v?this._isInnerZoneKeystroke:v;return c.createElement(Do.R,(0,k.__assign)({direction:xo.E.vertical,"data-automationid":"GroupedList","data-is-scrollable":"false",role:"presentation"},u,{shouldEnterInnerZone:b,className:(0,I.A)(this._classNames.root,u.className)}),c.createElement(Ci.MO,null),g?c.createElement(tr,(0,k.__assign)({ref:this._list,role:a,items:g,onRenderCell:this._renderGroup,getItemCountForPage:this._returnOne,getPageHeight:this._getPageHeight,getPageSpecification:this._getPageSpecification,usePageCache:n,onShouldVirtualize:o,version:f},h)):this._renderGroup(void 0,0))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this._forceListUpdates()},t.prototype.toggleCollapseAll=function(e){var t=this.state.groups,n=void 0===t?[]:t,o=this.props.groupProps,i=o&&o.onToggleCollapseAll;n.length>0&&(i&&i(e),this._setGroupsCollapsedState(n,e),this._updateIsSomeGroupExpanded(),this.forceUpdate())},t.prototype._setGroupsCollapsedState=function(e,t){for(var n=0;n<e.length;n++)e[n].isCollapsed=t},t.prototype._returnOne=function(){return 1},t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(t))},t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.state.groups;t&&t.length>0;)e++,t=t[0].children;return e},t.prototype._forceListUpdates=function(e){this.setState({version:{}})},t.prototype._computeIsSomeGroupExpanded=function(e){var t=this;return!(!e||!e.some((function(e){return e.children?t._computeIsSomeGroupExpanded(e.children):!e.isCollapsed})))},t.prototype._updateIsSomeGroupExpanded=function(){var e=this.state.groups,t=this.props.onGroupExpandStateChanged,n=this._computeIsSomeGroupExpanded(e);this._isSomeGroupExpanded!==n&&(t&&t(n),this._isSomeGroupExpanded=n)},t.defaultProps={selectionMode:Wo.Qc.multiple,isHeaderVisible:!0,groupProps:{},compact:!1},t}(c.Component),lr=(0,Cn.I)(sr,(function(e){var t,n,o=e.theme,i=e.className,r=e.compact,a=o.palette,s=(0,K.Km)(xi,o);return{root:[s.root,o.fonts.small,{position:"relative",selectors:(t={},t[".".concat(s.listCell)]={minHeight:38},t)},r&&[s.compact,{selectors:(n={},n[".".concat(s.listCell)]={minHeight:32},n)}],i],group:[s.group,{transition:"background-color ".concat(K.cs.durationValue2," ").concat(Ti)}],groupIsDropping:{backgroundColor:a.neutralLight}}}),void 0,{scope:"GroupedList"}),cr=n(20911);function dr(e,t){var n,o=(null!==t&&void 0!==t?t:!e||e&&e.hasOwnProperty("devicePixelRatio"))?(0,Wi.z)():(0,Wi.z)(e);return e&&(e===o?n={left:0,top:0,width:o.innerWidth,height:o.innerHeight,right:o.innerWidth,bottom:o.innerHeight}:e.getBoundingClientRect&&(n=e.getBoundingClientRect())),n}function ur(e){return function(t){function n(e){var n=t.call(this,e)||this;return n._root=c.createRef(),n._registerResizeObserver=function(){var e=(0,Wi.z)(n._root.current);n._viewportResizeObserver=new e.ResizeObserver(n._onAsyncResize),n._viewportResizeObserver.observe(n._root.current)},n._unregisterResizeObserver=function(){n._viewportResizeObserver&&(n._viewportResizeObserver.disconnect(),delete n._viewportResizeObserver)},n._updateViewport=function(e){var t=n.state.viewport,o=n._root.current,i=(0,Wi.z)(o),r=dr((0,zi.Hc)(o),i),a=dr(o,i);((a&&a.width)!==t.width||(r&&r.height)!==t.height)&&n._resizeAttempts<3&&a&&r?(n._resizeAttempts++,n.setState({viewport:{width:a.width,height:r.height}},(function(){n._updateViewport(e)}))):(n._resizeAttempts=0,e&&n._composedComponentInstance&&n._composedComponentInstance.forceUpdate())},n._async=new N.j(n),n._events=new M.g(n),n._resizeAttempts=0,n.state={viewport:{width:0,height:0}},n}return(0,k.__extends)(n,t),n.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.delayFirstMeasure,o=t.disableResizeObserver,i=t.skipViewportMeasures,r=(0,Wi.z)(this._root.current);this._onAsyncResize=this._async.debounce(this._onAsyncResize,500,{leading:!1}),i||(!o&&this._isResizeObserverAvailable()?this._registerResizeObserver():this._events.on(r,"resize",this._onAsyncResize),n?this._async.setTimeout((function(){e._updateViewport()}),500):this._updateViewport())},n.prototype.componentDidUpdate=function(e){var t=e.skipViewportMeasures,n=this.props,o=n.disableResizeObserver,i=n.skipViewportMeasures,r=(0,Wi.z)(this._root.current);i!==t&&(i?(this._unregisterResizeObserver(),this._events.off(r,"resize",this._onAsyncResize)):(!o&&this._isResizeObserverAvailable()?this._viewportResizeObserver||this._registerResizeObserver():this._events.on(r,"resize",this._onAsyncResize),this._updateViewport()))},n.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose(),this._unregisterResizeObserver()},n.prototype.render=function(){var t=this.state.viewport,n=t.width>0&&t.height>0?t:void 0;return c.createElement("div",{className:"ms-Viewport",ref:this._root,style:{minWidth:1,minHeight:1}},c.createElement(e,(0,k.__assign)({ref:this._updateComposedComponentRef,viewport:n},this.props)))},n.prototype.forceUpdate=function(){this._updateViewport(!0)},n.prototype._onAsyncResize=function(){this._updateViewport()},n.prototype._isResizeObserverAvailable=function(){var e=(0,Wi.z)(this._root.current);return e&&e.ResizeObserver},n}(cr.f)}var pr=n(57987),hr=(0,Sn.Z)(),mr=100,gr={tabIndex:0},fr={},vr=function(e){var t=e.selection,n=e.ariaLabelForListHeader,o=e.ariaLabelForSelectAllCheckbox,i=e.ariaLabelForSelectionColumn,r=e.className,a=e.checkboxVisibility,s=e.compact,l=e.constrainMode,d=e.dragDropEvents,u=e.groups,p=e.groupProps,h=e.indentWidth,m=e.items,g=e.isPlaceholderData,f=e.isHeaderVisible,v=e.layoutMode,b=e.onItemInvoked,y=e.onItemContextMenu,C=e.onColumnHeaderClick,S=e.onColumnHeaderContextMenu,D=e.selectionMode,x=void 0===D?t.mode:D,T=e.selectionPreservedOnEmptyClick,E=e.selectionZoneProps,w=e.ariaLabel,_=e.ariaLabelForGrid,A=e.rowElementEventMap,R=e.shouldApplyApplicationRole,L=void 0!==R&&R,N=e.getKey,M=e.listProps,O=e.usePageCache,F=e.onShouldVirtualize,j=e.viewport,H=e.minimumPixelsForDrag,z=e.getGroupHeight,U=e.styles,W=e.theme,K=e.cellStyleProps,q=void 0===K?Bo:K,V=e.onRenderCheckbox,Z=e.useFastIcons,Y=e.dragDropHelper,X=e.adjustedColumns,$=e.isCollapsed,J=e.isSizing,Q=e.isSomeGroupExpanded,ee=e.version,te=e.rootRef,ne=e.listRef,oe=e.focusZoneRef,ie=e.columnReorderOptions,re=e.groupedListRef,ae=e.headerRef,se=e.onGroupExpandStateChanged,le=e.onColumnIsSizingChanged,ce=e.onRowDidMount,de=e.onRowWillUnmount,ue=e.disableSelectionZone,pe=e.isSelectedOnFocus,he=void 0===pe||pe,me=e.onColumnResized,ge=e.onColumnAutoResized,fe=e.onToggleCollapse,ve=e.onActiveRowChanged,be=e.onBlur,ye=e.rowElementEventMap,Ce=e.onRenderMissingItem,Se=e.onRenderItemColumn,ke=e.onRenderField,De=e.getCellValueKey,xe=e.getRowAriaLabel,Te=e.getRowAriaDescribedBy,Ee=e.checkButtonAriaLabel,we=e.checkButtonGroupAriaLabel,_e=e.checkboxCellClassName,Ie=e.useReducedRowRenderer,Pe=e.enableUpdateAnimations,Ae=e.enterModalSelectionOnTouch,Re=e.onRenderDefaultRow,Le=e.selectionZoneRef,Ne=e.focusZoneProps,Me="grid",Oe=e.role?e.role:Me,Be=(0,B.O)("row"),Fe=function(e){var t=0,n=e;for(;n&&n.length>0;)t++,n=n[0].children;return t}(u),je=function(e){return c.useMemo((function(){var t={};if(e)for(var n=1,o=1,i=0,r=e;i<r.length;i++){var a=r[i];t[a.key]={numOfGroupHeadersBeforeItem:o,totalRowCount:n},o++,n+=a.count+1}return t}),[e])}(u),He=c.useMemo((function(){return(0,k.__assign)({renderedWindowsAhead:J?0:2,renderedWindowsBehind:J?0:2,getKey:N,version:ee},M)}),[J,N,ee,M]),ze=Zo.none;if(x===Wo.Qc.single&&(ze=Zo.hidden),x===Wo.Qc.multiple){var Ue=p&&p.headerProps&&p.headerProps.isCollapsedGroupSelectVisible;void 0===Ue&&(Ue=!0),ze=Ue||!u||Q?Zo.visible:Zo.hidden}a===vo.hidden&&(ze=Zo.none);var We=c.useCallback((function(e){return c.createElement(di,(0,k.__assign)({},e))}),[]),Ke=c.useCallback((function(){return null}),[]),Ge=e.onRenderDetailsHeader,qe=c.useMemo((function(){return Ge?(0,_o.j)(Ge,We):We}),[Ge,We]),Ve=e.onRenderDetailsFooter,Ze=c.useMemo((function(){return Ve?(0,_o.j)(Ve,Ke):Ke}),[Ve,Ke]),Ye=c.useMemo((function(){return{columns:X,groupNestingDepth:Fe,selection:t,selectionMode:x,viewport:j,checkboxVisibility:a,indentWidth:h,cellStyleProps:q}}),[X,Fe,t,x,j,a,h,q]),Xe=ie&&ie.onDragEnd,$e=c.useCallback((function(e,t){var n=e.dropLocation,o=go.outside;if(Xe){if(n&&n!==go.header)o=n;else if(te.current){var i=te.current.getBoundingClientRect();t.clientX>i.left&&t.clientX<i.right&&t.clientY>i.top&&t.clientY<i.bottom&&(o=go.surface)}Xe(o)}}),[Xe,te]),Je=c.useMemo((function(){if(ie)return(0,k.__assign)((0,k.__assign)({},ie),{onColumnDragEnd:$e})}),[ie,$e]),Qe=(f?1:0)+(e.onRenderDetailsFooter?1:0)+function(e){var t=0;if(e)for(var n=(0,k.__spreadArray)([],e,!0),o=void 0;n&&n.length>0;)++t,(o=n.pop())&&o.children&&n.push.apply(n,o.children);return t}(u)+(m?m.length:0),et=(ze!==Zo.none?1:0)+(X?X.length:0)+(u?1:0),tt=c.useMemo((function(){return hr(U,{theme:W,compact:s,isFixed:v===fo.fixedColumns,isHorizontalConstrained:l===mo.horizontalConstrained,className:r})}),[U,W,s,v,l,r]),nt=p&&p.onRenderFooter,ot=c.useMemo((function(){return nt?function(e,n){return nt((0,k.__assign)((0,k.__assign)({},e),{columns:X,groupNestingDepth:Fe,indentWidth:h,selection:t,selectionMode:x,viewport:j,checkboxVisibility:a,cellStyleProps:q}),n)}:void 0}),[nt,X,Fe,h,t,x,j,a,q]),it=p&&p.onRenderHeader,rt=c.useMemo((function(){return it?function(e,n){var o,i,r=e.groupIndex,s=void 0!==r?null===(i=null===(o=e.groups)||void 0===o?void 0:o[r])||void 0===i?void 0:i.key:void 0,l=void 0!==s&&je[s]?je[s].totalRowCount:0;return it((0,k.__assign)((0,k.__assign)({},e),{columns:X,groupNestingDepth:Fe,indentWidth:h,selection:t,selectionMode:a!==vo.hidden?x:Wo.Qc.none,viewport:j,checkboxVisibility:a,cellStyleProps:q,ariaColSpan:X.length,ariaLevel:void 0,ariaPosInSet:void 0,ariaSetSize:void 0,ariaRowCount:void 0,ariaRowIndex:void 0!==r?l+(f?1:0):void 0}),n)}:function(e,t){var n,o,i=e.groupIndex,r=void 0!==i?null===(o=null===(n=e.groups)||void 0===n?void 0:n[i])||void 0===o?void 0:o.key:void 0,a=void 0!==r&&je[r]?je[r].totalRowCount:0;return t((0,k.__assign)((0,k.__assign)({},e),{ariaColSpan:X.length,ariaLevel:void 0,ariaPosInSet:void 0,ariaSetSize:void 0,ariaRowCount:void 0,ariaRowIndex:void 0!==i?a+(f?1:0):void 0}))}}),[it,X,Fe,h,f,t,x,j,a,q,je]),at=c.useMemo((function(){var e;return(0,k.__assign)((0,k.__assign)({},p),{role:Oe===Me?"rowgroup":"presentation",onRenderFooter:ot,onRenderHeader:rt,headerProps:(0,k.__assign)((0,k.__assign)({},null===p||void 0===p?void 0:p.headerProps),{selectAllButtonProps:(0,k.__assign)({"aria-label":we},null===(e=null===p||void 0===p?void 0:p.headerProps)||void 0===e?void 0:e.selectAllButtonProps)})})}),[p,ot,rt,we,Oe]),st=(0,pr.d)((function(){return(0,G.J9)((function(e){var t=0;return e.forEach((function(e){return t+=e.calculatedWidth||e.minWidth})),t}))})),lt=p&&p.collapseAllVisibility,ct=c.useMemo((function(){return st(X)}),[X,st]),dt=c.useCallback((function(n,o,i,r){var l=e.onRenderRow?(0,_o.j)(e.onRenderRow,Re):Re,c=r?r.key:void 0,u=c&&je[c]?je[c].numOfGroupHeadersBeforeItem:0,p=Oe===Me?void 0:"presentation",m=i>0?fr:gr,g={item:o,itemIndex:i,flatIndexOffset:(f?2:1)+u,compact:s,columns:X,groupNestingDepth:n,id:"".concat(Be,"-").concat(i),selectionMode:x,selection:t,onDidMount:ce,onWillUnmount:de,onRenderItemColumn:Se,onRenderField:ke,getCellValueKey:De,eventsToRegister:ye,dragDropEvents:d,dragDropHelper:Y,viewport:j,checkboxVisibility:a,collapseAllVisibility:lt,getRowAriaLabel:xe,getRowAriaDescribedBy:Te,checkButtonAriaLabel:Ee,checkboxCellClassName:_e,useReducedRowRenderer:Ie,indentWidth:h,cellStyleProps:q,onRenderDetailsCheckbox:V,enableUpdateAnimations:Pe,rowWidth:ct,useFastIcons:Z,role:p,isGridRow:!0,focusZoneProps:m};return o?l(g):Ce?Ce(i,g):null}),[s,X,x,t,Be,ce,de,Se,ke,De,ye,d,Y,j,a,lt,xe,Te,f,Ee,_e,Ie,h,q,V,Pe,Z,Re,Ce,e.onRenderRow,ct,Oe,je]),ut=c.useCallback((function(e){return function(t,n){return dt(e,t,n)}}),[dt]),pt=c.useCallback((function(e){return e.which===(0,So.SM)(P.c.right,W)}),[W]),ht=(0,k.__assign)((0,k.__assign)({},Ne),{componentRef:Ne&&Ne.componentRef?Ne.componentRef:oe,className:Ne&&Ne.className?(0,I.A)(tt.focusZone,Ne.className):tt.focusZone,direction:Ne?Ne.direction:xo.E.vertical,shouldEnterInnerZone:Ne&&Ne.shouldEnterInnerZone?Ne.shouldEnterInnerZone:pt,onActiveElementChanged:Ne&&Ne.onActiveElementChanged?Ne.onActiveElementChanged:ve,shouldRaiseClicksOnEnter:!1,onBlur:Ne&&Ne.onBlur?Ne.onBlur:be}),mt=u&&(null===p||void 0===p?void 0:p.groupedListAs)?(0,ui.C)(p.groupedListAs,lr):lr,gt=u?c.createElement(mt,{focusZoneProps:ht,componentRef:re,groups:u,groupProps:at,items:m,onRenderCell:dt,role:"presentation",selection:t,selectionMode:a!==vo.hidden?x:Wo.Qc.none,dragDropEvents:d,dragDropHelper:Y,eventsToRegister:A,listProps:He,onGroupExpandStateChanged:se,usePageCache:O,onShouldVirtualize:F,getGroupHeight:z,compact:s}):c.createElement(Do.R,(0,k.__assign)({},ht),c.createElement(tr,(0,k.__assign)({ref:ne,role:"presentation",items:m,onRenderCell:ut(0),usePageCache:O,onShouldVirtualize:F},He))),ft=c.useCallback((function(e){e.which===P.c.down&&oe.current&&oe.current.focus()&&(he&&0===t.getSelectedIndices().length&&t.setIndexSelected(0,!0,!1),e.preventDefault(),e.stopPropagation())}),[t,oe,he]),vt=c.useCallback((function(e){e.which!==P.c.up||e.altKey||ae.current&&ae.current.focus()&&(e.preventDefault(),e.stopPropagation())}),[ae]);return c.createElement("div",(0,k.__assign)({ref:te,className:tt.root,"data-automationid":"DetailsList","data-is-scrollable":"false"},L?{role:"application"}:{}),c.createElement(Ci.MO,null),c.createElement("div",{role:Oe,"aria-label":_||w,"aria-rowcount":g?0:Qe,"aria-colcount":et,"aria-busy":g},c.createElement("div",{onKeyDown:ft,role:"presentation",className:tt.headerWrapper},f&&qe({componentRef:ae,selectionMode:x,layoutMode:v,selection:t,columns:X,onColumnClick:C,onColumnContextMenu:S,onColumnResized:me,onColumnIsSizingChanged:le,onColumnAutoResized:ge,groupNestingDepth:Fe,isAllCollapsed:$,onToggleCollapseAll:fe,ariaLabel:n,ariaLabelForSelectAllCheckbox:o,ariaLabelForSelectionColumn:i,selectAllVisibility:ze,collapseAllVisibility:p&&p.collapseAllVisibility,viewport:j,columnReorderProps:Je,minimumPixelsForDrag:H,cellStyleProps:q,checkboxVisibility:a,indentWidth:h,onRenderDetailsCheckbox:V,rowWidth:st(X),useFastIcons:Z},qe)),c.createElement("div",{onKeyDown:vt,role:"presentation",className:tt.contentWrapper},ue?gt:c.createElement(ki.Z,(0,k.__assign)({ref:Le,selection:t,selectionPreservedOnEmptyClick:T,selectionMode:x,isSelectedOnFocus:he,selectionClearedOnEscapePress:he,toggleWithoutModifierPressed:!he,onItemInvoked:b,onItemContextMenu:y,enterModalOnTouch:Ae},E||{}),gt)),Ze((0,k.__assign)({},Ye))))},br=function(e){function t(t){var n=e.call(this,t)||this;return n._root=c.createRef(),n._header=c.createRef(),n._groupedList=c.createRef(),n._list=c.createRef(),n._focusZone=c.createRef(),n._selectionZone=c.createRef(),n._onRenderRow=function(e,t){return c.createElement(bi,(0,k.__assign)({},e))},n._getDerivedStateFromProps=function(e,t){var o=n.props,i=o.checkboxVisibility,r=o.items,a=o.setKey,s=o.selectionMode,l=void 0===s?n._selection.mode:s,c=o.columns,d=o.viewport,u=o.compact,p=o.dragDropEvents,h=(n.props.groupProps||{}).isAllGroupsCollapsed,m=void 0===h?void 0:h,g=e.viewport&&e.viewport.width||0,f=d&&d.width||0,v=e.setKey!==a||void 0===e.setKey,b=!1;e.layoutMode!==n.props.layoutMode&&(b=!0);var y=t;return v&&(n._initialFocusedIndex=e.initialFocusedIndex,y=(0,k.__assign)((0,k.__assign)({},y),{focusedItemIndex:void 0!==n._initialFocusedIndex?n._initialFocusedIndex:-1})),n.props.disableSelectionZone||e.items===r||n._selection.setItems(e.items,v),e.checkboxVisibility===i&&e.columns===c&&g===f&&e.compact===u||(b=!0),y=(0,k.__assign)((0,k.__assign)({},y),n._adjustColumns(e,y,!0)),e.selectionMode!==l&&(b=!0),void 0===m&&e.groupProps&&void 0!==e.groupProps.isAllGroupsCollapsed&&(y=(0,k.__assign)((0,k.__assign)({},y),{isCollapsed:e.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:!e.groupProps.isAllGroupsCollapsed})),e.dragDropEvents!==p&&(n._dragDropHelper&&n._dragDropHelper.dispose(),n._dragDropHelper=e.dragDropEvents?new $o({selection:n._selection,minimumPixelsForDrag:e.minimumPixelsForDrag}):void 0,b=!0),b&&(y=(0,k.__assign)((0,k.__assign)({},y),{version:{}})),y},n._onGroupExpandStateChanged=function(e){n.setState({isSomeGroupExpanded:e})},n._onColumnIsSizingChanged=function(e,t){n.setState({isSizing:t})},n._onRowDidMount=function(e){var t=e.props,o=t.item,i=t.itemIndex,r=n._getItemKey(o,i);n._activeRows[r]=e,n._setFocusToRowIfPending(e);var a=n.props.onRowDidMount;a&&a(o,i)},n._onRowWillUnmount=function(e){var t=n.props.onRowWillUnmount,o=e.props,i=o.item,r=o.itemIndex,a=n._getItemKey(i,r);delete n._activeRows[a],t&&t(i,r)},n._onToggleCollapse=function(e){n.setState({isCollapsed:e}),n._groupedList.current&&n._groupedList.current.toggleCollapseAll(e)},n._onColumnResized=function(e,t,o){var i=Math.max(e.minWidth||mr,t);n.props.onColumnResize&&n.props.onColumnResize(e,i,o),n._rememberCalculatedWidth(e,i),n.setState((0,k.__assign)((0,k.__assign)({},n._adjustColumns(n.props,n.state,!0,o)),{version:{}}))},n._onColumnAutoResized=function(e,t){var o=0,i=0,r=Object.keys(n._activeRows).length;for(var a in n._activeRows){if(n._activeRows.hasOwnProperty(a))n._activeRows[a].measureCell(t,(function(a){o=Math.max(o,a),++i===r&&n._onColumnResized(e,o,t)}))}},n._onActiveRowChanged=function(e,t){var o=n.props,i=o.items,r=o.onActiveItemChanged;if(e&&e.getAttribute("data-item-index")){var a=Number(e.getAttribute("data-item-index"));a>=0&&(r&&r(i[a],a,t),n.setState({focusedItemIndex:a}))}},n._onBlur=function(e){n.setState({focusedItemIndex:-1})},(0,L.f)(n),n._async=new N.j(n),n._activeRows={},n._columnOverrides={},n.state={focusedItemIndex:-1,lastWidth:0,adjustedColumns:n._getAdjustedColumns(t,void 0),isSizing:!1,isCollapsed:t.groupProps&&t.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:t.groupProps&&!t.groupProps.isAllGroupsCollapsed,version:{},getDerivedStateFromProps:n._getDerivedStateFromProps},(0,O.Y)("DetailsList",t,{selection:"getKey"}),n._selection=t.selection||new Di.L({onSelectionChanged:void 0,getKey:t.getKey,selectionMode:t.selectionMode}),n.props.disableSelectionZone||n._selection.setItems(t.items,!1),n._dragDropHelper=t.dragDropEvents?new $o({selection:n._selection,minimumPixelsForDrag:t.minimumPixelsForDrag}):void 0,n._initialFocusedIndex=t.initialFocusedIndex,n}return(0,k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.getDerivedStateFromProps(e,t)},t.prototype.scrollToIndex=function(e,t,n){this._list.current&&this._list.current.scrollToIndex(e,t,n),this._groupedList.current&&this._groupedList.current.scrollToIndex(e,t,n)},t.prototype.focusIndex=function(e,t,n,o){void 0===t&&(t=!1);var i=this.props.items[e];if(i){this.scrollToIndex(e,n,o);var r=this._getItemKey(i,e),a=this._activeRows[r];a&&this._setFocusToRow(a,t)}},t.prototype.getStartItemIndexInView=function(){return this._list&&this._list.current?this._list.current.getStartItemIndexInView():this._groupedList&&this._groupedList.current?this._groupedList.current.getStartItemIndexInView():0},t.prototype.updateColumn=function(e,t){var n,o,i=this.props,r=i.columns,a=void 0===r?[]:r,s=i.selectionMode,l=i.checkboxVisibility,c=i.columnReorderOptions,d=t.width,u=t.newColumnIndex,p=a.findIndex((function(t){return t.key===e.key}));if(d&&this._onColumnResized(e,d,p),void 0!==u&&c){var h=s===Wo.Qc.none||l===vo.hidden,m=(l!==vo.hidden?2:1)+p,g=h?m-1:m-2,f=h?u-1:u-2,v=null!==(n=c.frozenColumnCountFromStart)&&void 0!==n?n:0,b=null!==(o=c.frozenColumnCountFromEnd)&&void 0!==o?o:0;if(f>=v&&f<a.length-b)if(c.onColumnDrop){var y={draggedIndex:g,targetIndex:f};c.onColumnDrop(y)}else c.handleColumnReorder&&c.handleColumnReorder(g,f)}},t.prototype.componentWillUnmount=function(){this._dragDropHelper&&this._dragDropHelper.dispose(),this._async.dispose()},t.prototype.componentDidUpdate=function(e,t){this._notifyColumnsResized();var n=(0,ce.LW)(this.context);if(void 0!==this._initialFocusedIndex&&(a=this.props.items[this._initialFocusedIndex])){var o=this._getItemKey(a,this._initialFocusedIndex);(i=this._activeRows[o])&&this._setFocusToRowIfPending(i)}if(this.props.items!==e.items&&this.props.items.length>0&&-1!==this.state.focusedItemIndex&&!(0,Si.s)(this._root.current,null===n||void 0===n?void 0:n.activeElement,!1)){var i,r=this.state.focusedItemIndex<this.props.items.length?this.state.focusedItemIndex:this.props.items.length-1,a=this.props.items[r];o=this._getItemKey(a,this.state.focusedItemIndex);(i=this._activeRows[o])?this._setFocusToRow(i):this._initialFocusedIndex=r}this.props.onDidUpdate&&this.props.onDidUpdate(this)},t.prototype.render=function(){return c.createElement(vr,(0,k.__assign)({},this.props,this.state,{selection:this._selection,dragDropHelper:this._dragDropHelper,rootRef:this._root,listRef:this._list,groupedListRef:this._groupedList,focusZoneRef:this._focusZone,headerRef:this._header,selectionZoneRef:this._selectionZone,onGroupExpandStateChanged:this._onGroupExpandStateChanged,onColumnIsSizingChanged:this._onColumnIsSizingChanged,onRowDidMount:this._onRowDidMount,onRowWillUnmount:this._onRowWillUnmount,onColumnResized:this._onColumnResized,onColumnAutoResized:this._onColumnAutoResized,onToggleCollapse:this._onToggleCollapse,onActiveRowChanged:this._onActiveRowChanged,onBlur:this._onBlur,onRenderDefaultRow:this._onRenderRow}))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this._forceListUpdates()},t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.props.groups;t&&t.length>0;)e++,t=t[0].children;return e},t.prototype._setFocusToRowIfPending=function(e){var t=e.props.itemIndex;void 0!==this._initialFocusedIndex&&t===this._initialFocusedIndex&&(this._setFocusToRow(e),delete this._initialFocusedIndex)},t.prototype._setFocusToRow=function(e,t){void 0===t&&(t=!1),this._selectionZone.current&&this._selectionZone.current.ignoreNextFocus(),this._async.setTimeout((function(){e.focus(t)}),0)},t.prototype._forceListUpdates=function(){this._groupedList.current&&this._groupedList.current.forceUpdate(),this._list.current&&this._list.current.forceUpdate()},t.prototype._notifyColumnsResized=function(){this.state.adjustedColumns.forEach((function(e){e.onColumnResize&&e.onColumnResize(e.currentWidth)}))},t.prototype._adjustColumns=function(e,t,n,o){var i=this._getAdjustedColumns(e,t,n,o),r=this.props.viewport,a=r&&r.width?r.width:0;return(0,k.__assign)((0,k.__assign)({},t),{adjustedColumns:i,lastWidth:a})},t.prototype._getAdjustedColumns=function(e,t,n,o){var i,r=this,a=e.items,s=e.layoutMode,l=e.selectionMode,c=e.viewport,d=c&&c.width?c.width:0,u=e.columns,p=this.props?this.props.columns:[],h=t?t.lastWidth:-1,m=t?t.lastSelectionMode:void 0;return n||h!==d||m!==l||p&&u!==p?(u=u||yr(a,!0),s===fo.fixedColumns?(i=this._getFixedColumns(u,d,e)).forEach((function(e){r._rememberCalculatedWidth(e,e.calculatedWidth)})):(i=this._getJustifiedColumns(u,d,e)).forEach((function(e){r._getColumnOverride(e.key).currentWidth=e.calculatedWidth})),i):u||[]},t.prototype._getFixedColumns=function(e,t,n){var o=this,i=this.props,r=i.selectionMode,a=void 0===r?this._selection.mode:r,s=i.checkboxVisibility,l=i.flexMargin,c=i.skipViewportMeasures,d=t-(l||0),u=0;e.forEach((function(e){c||!e.flexGrow?d-=e.maxWidth||e.minWidth||mr:(d-=e.minWidth||mr,u+=e.flexGrow),d-=Cr(e,n,!0)}));var p=a!==Wo.Qc.none&&s!==vo.hidden?48:0,h=36*this._getGroupNestingDepth(),m=(d-=p+h)/u;return c||e.forEach((function(e){var t=(0,k.__assign)((0,k.__assign)({},e),o._columnOverrides[e.key]);if(t.flexGrow&&t.maxWidth){var n=t.flexGrow*m+t.minWidth,i=n-t.maxWidth;i>0&&(d+=i,u-=i/(n-t.minWidth)*t.flexGrow)}})),m=d>0?d/u:0,e.map((function(e){var n=(0,k.__assign)((0,k.__assign)({},e),o._columnOverrides[e.key]);return!c&&n.flexGrow&&d<=0&&0===t||n.calculatedWidth||(!c&&n.flexGrow?(n.calculatedWidth=n.minWidth+n.flexGrow*m,n.calculatedWidth=Math.min(n.calculatedWidth,n.maxWidth||Number.MAX_VALUE)):n.calculatedWidth=n.maxWidth||n.minWidth||mr),n}))},t.prototype._getJustifiedColumns=function(e,t,n){var o=this,i=n.selectionMode,r=void 0===i?this._selection.mode:i,a=n.checkboxVisibility,s=n.skipViewportMeasures,l=r!==Wo.Qc.none&&a!==vo.hidden?48:0,c=36*this._getGroupNestingDepth(),d=0,u=0,p=t-(l+c),h=e.map((function(e,t){var i=(0,k.__assign)((0,k.__assign)({},e),{calculatedWidth:e.minWidth||mr}),r=(0,k.__assign)((0,k.__assign)({},i),o._columnOverrides[e.key]);return i.isCollapsible||i.isCollapsable||(u+=Cr(i,n)),d+=Cr(r,n),r}));if(s)return h;for(var m=h.length-1;m>=0&&d>p;){var g=(y=h[m]).minWidth||mr,f=d-p;if(y.calculatedWidth-g>=f||!y.isCollapsible&&!y.isCollapsable){var v=y.calculatedWidth;u<p&&(y.calculatedWidth=Math.max(y.calculatedWidth-f,g)),d-=v-y.calculatedWidth}else d-=Cr(y,n),h.splice(m,1);m--}for(var b=0;b<h.length&&d<p;b++){var y=h[b],C=b===h.length-1,S=this._columnOverrides[y.key];if(!S||!S.calculatedWidth||C){var D=p-d,x=void 0;if(C)x=D;else{var T=y.maxWidth;g=y.minWidth||T||mr;x=T?Math.min(D,T-g):D}y.calculatedWidth=y.calculatedWidth+x,d+=x}}return h},t.prototype._rememberCalculatedWidth=function(e,t){var n=this._getColumnOverride(e.key);n.calculatedWidth=t,n.currentWidth=t},t.prototype._getColumnOverride=function(e){return this._columnOverrides[e]=this._columnOverrides[e]||{}},t.prototype._getItemKey=function(e,t){var n=this.props.getKey,o=void 0;return e&&(o=e.key),n&&(o=n(e,t)),o||(o=t),o},t.defaultProps={layoutMode:fo.justified,selectionMode:Wo.Qc.multiple,constrainMode:mo.horizontalConstrained,checkboxVisibility:vo.onHover,isHeaderVisible:!0,compact:!1,useFastIcons:!0},t.contextType=le._0,t=(0,k.__decorate)([ur],t)}(c.Component);function yr(e,t,n,o,i,r,a,s){var l=[];if(e&&e.length){var c=e[0];for(var d in c)c.hasOwnProperty(d)&&l.push({key:d,name:d,fieldName:d,minWidth:mr,maxWidth:300,isCollapsible:!!l.length,isMultiline:void 0!==a&&a,isSorted:o===d,isSortedDescending:!!i,isRowHeader:!1,columnActionsMode:null!==s&&void 0!==s?s:ho.clickable,isResizable:t,onColumnClick:n,isGrouped:r===d})}return l}function Cr(e,t,n){var o=t.cellStyleProps,i=void 0===o?Bo:o;return(n?0:e.calculatedWidth)+i.cellLeftPadding+i.cellRightPadding+(e.isPadded?i.cellExtraRightPadding:0)}var Sr={root:"ms-DetailsList",compact:"ms-DetailsList--Compact",contentWrapper:"ms-DetailsList-contentWrapper",headerWrapper:"ms-DetailsList-headerWrapper",isFixed:"is-fixed",isHorizontalConstrained:"is-horizontalConstrained",listCell:"ms-List-cell"},kr=(0,Cn.I)(br,(function(e){var t,n,o=e.theme,i=e.className,r=e.isHorizontalConstrained,a=e.compact,s=e.isFixed,l=o.semanticColors,c=(0,K.Km)(Sr,o);return{root:[c.root,o.fonts.small,{position:"relative",color:l.listText,selectors:(t={},t["& .".concat(c.listCell)]={minHeight:38,wordBreak:"break-word"},t)},s&&c.isFixed,a&&[c.compact,{selectors:(n={},n[".".concat(c.listCell)]={minHeight:32},n)}],r&&[c.isHorizontalConstrained,{overflowX:"auto",overflowY:"visible",WebkitOverflowScrolling:"touch"}],i],focusZone:[{display:"inline-block",minWidth:"100%",minHeight:1}],headerWrapper:c.headerWrapper,contentWrapper:c.contentWrapper}}),void 0,{scope:"DetailsList"}),Dr=n(14983),xr=n(24700),Tr=n(13735),Er=function(e){return isNaN(e)?"0px":e+"px"},wr=function(e){return parseFloat(e)};var _r="380px",Ir="100px",Pr={"@media screen and (min-height: 960px)":{height:_r},"@media screen and (max-height: 959px)":{height:Er(wr(_r)-80)},"@media screen and (max-height: 734px)":{height:Er(wr(_r)-160)},"@media screen and (max-height: 494px)":{height:Er(wr(_r)-240)}},Ar=(0,G.J9)((function(e){var t=[(0,Tr.gS)(),{paddingBottom:"10px"}],n={root:{fontSize:K.s.large,fontWeight:K.BO.semibold,color:xr.W7}},o=[Pr,{paddingBottom:"10px",overflowY:"auto",overflowX:"hidden"}],i={root:{backgroundColor:xr.c,color:xr.W7,overflow:"hidden"}},r={root:{backgroundColor:xr.c,"> .ms-DetailsHeader-cell":{color:xr.W7,i:{color:xr.W7},":focus-within, :hover":{backgroundColor:xr.SC},":active":{backgroundColor:xr.XG}}}},a={root:{backgroundColor:xr.c,color:xr.W7,i:{color:xr.W7},":focus-within, :hover":{backgroundColor:xr.SC,".ms-DetailsRow-cell":{color:xr.W7}},"&.is-selected, :active":{backgroundColor:xr.XG}}},s=[(0,Tr.$Z)("auto"),(0,Tr.gS)(),Tr.cc,Pr,{textAlign:"center",wordWrap:"break-word",overflow:"hidden"}],l=[(0,Tr.$Z)("auto"),(0,Tr.gS)("column"),Tr.cc],c={root:{fontSize:K.s.xLarge,fontWeight:K.BO.semibold,color:xr.W7}},d={root:{fontSize:K.s.large,fontWeight:K.BO.semilight,color:xr.W7,paddingBottom:"20px"}},u={root:{fontSize:Ir,color:xr.W7}},p=[(0,Tr.$Z)("auto"),(0,Tr.gS)(),Tr.cc,Pr,{textAlign:"center",wordWrap:"break-word",overflow:"hidden"}],h=[(0,Tr.$Z)("auto"),(0,Tr.gS)("column"),Tr.cc],m={root:{fontSize:K.s.large,fontWeight:K.BO.semilight,color:xr.W7}},g={root:{fontSize:Ir,color:xr.W7}},f={root:{fontSize:K.s.small,fontWeight:K.BO.regular,color:xr.Yl,height:"32px",padding:"8px 0"}},v={root:{".previewIcon":{padding:0,paddingTop:"2.5px",":hover":{backgroundColor:"transparent !important"}},".folderItemText:hover":{textDecoration:"underline",cursor:"pointer"},".itemText":{cursor:"default"}},dialogHeader:t,listContainer:o,errorContainer:s,errorFolder:l,emptyContainer:p,emptyFolder:h,subComponentStyles:{dialogHeaderText:n,breadcrumb:{root:{margin:"5px 0px"},list:{button:{color:xr.W7,":focus, :hover":{backgroundColor:xr.SC},":active":{backgroundColor:xr.XG}}},overflowButton:{padding:"3px 8px"},itemLink:{fontSize:K.s.large,fontWeight:K.BO.semilight},chevron:{color:xr.EW,fontSize:"11px",margin:"6px 0"}},listDetails:i,listDetailsHeader:r,listDetailsRow:a,errorFolderIcon:u,loadErrorTitle:c,loadErrorMessage:d,emptyFolderIcon:g,emptyFolderText:m,attachmentError:f,dialogFooter:{actions:{margin:"0px"}}}};return(0,K.TW)(v,e)})),Rr=(0,G.J9)((function(e){return{root:(0,K.Zq)("oneDrivePicker",e.root),dialogHeader:(0,K.Zq)("dialogHeader",e.dialogHeader),listContainer:(0,K.Zq)("listContainer",e.listContainer),errorContainer:(0,K.Zq)("errorContainer",e.errorContainer),errorFolder:(0,K.Zq)("errorFolder",e.errorFolder),emptyContainer:(0,K.Zq)("emptyContainer",e.emptyContainer),emptyFolder:(0,K.Zq)("emptyFolder",e.emptyFolder)}})),Lr=n(50723),Nr=n.n(Lr),Mr=n(74255),Or=n.n(Mr),Br=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fr=function(){return Fr=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fr.apply(this,arguments)},jr="root",Hr=function(e){function t(n,o){var i,r=e.call(this,n,o)||this;return r.onItemSelection=function(e){var t,n=r.props,o=n.alertUserAddAttachmentError,i=n.isDriveItemAnAttachment,a=e.childCount>-1?null:e;null!=a&&i(a)&&a!==r.state.alertAddedForAttachment&&(o(),t=a),r.setState({selectedDriveItem:a,alertAddedForAttachment:t||null})},r.getFolderKey=function(){var e=r.state.breadcrumbItems;return null==e||0===e.length?jr:e[e.length-1].key},r.rollUpFolder=function(e,t){var n,o=r.props.groupDriveItemsByFolder;null!=o&&(n=o[t.key]);var i=ot()(r.state.breadcrumbItems,(function(e){return e.key===t.key}));r.setState((function(e){return{columns:r.buildColumnsFromDriveItems(n),breadcrumbItems:0===i?[]:Or()(e.breadcrumbItems,0,i+1),selectedDriveItem:null}}))},r.addDriveItemAsAttachment=function(){var e=r.props,t=e.addDriveItemAsAttachment,n=e.isDriveItemAnAttachment,o=e.onDismiss,i=r.state.selectedDriveItem;i&&(n(i)||(t(i),o()))},r.onColumnClick=function(e,t){var n=r.props.groupDriveItemsByFolder;if(t){var o,i=r.state.columns;null!=n&&(o=n[r.getFolderKey()]),i=r.buildColumnsFromDriveItems(o);var a=t.isSortedDescending;t.isSorted&&(a=!a),r.setState((function(e){return{columns:i&&i.map((function(e){return e.isSorted=e.key===t.key,e.isSorted&&(e.isSortedDescending=a),e}))}}))}},r.onRenderDetailsHeader=function(e){var t=r.getStyles();return c.createElement(di,Fr({},e,{styles:t.subComponentStyles.listDetailsHeader}))},r.onRenderRow=function(e){var t=r.getStyles();return c.createElement("div",{onKeyUp:function(t){t.keyCode===h.D.ENTER&&(e.item.childCount>-1?r.drillDownFolder(e.item):r.addDriveItemAsAttachment())}},c.createElement(bi,Fr({},e,{styles:t.subComponentStyles.listDetailsRow})))},r.renderItemColumn=function(e,n,o){var i=o.fieldName&&e[o.fieldName];switch(o.key){case t.columnName:return e.childCount>-1?c.createElement("span",{className:"folderItemText",onClick:function(){return r.drillDownFolder(e)}},i):c.createElement("span",{className:"itemText"},i);case t.columnModifiedDate:return c.createElement("span",{className:"itemText"},e.modifiedDate.format("LL"));case t.columnFileType:return c.createElement(ne.K,{className:"previewIcon",iconProps:r.getIconPropsForDriveItem(e),ariaLabel:r.getIconAriaLabel(e)});default:return c.createElement("span",{className:"itemText"},i)}},r.drillDownFolder=function(e){var t=r.props,n=t.groupDriveItemsByFolder,o=t.oneDrivePickerStrings,i=t.onFolderDrillDown,a=r.state.breadcrumbItems;i(e.id);var s=n[e.id],l=a||[];0===l.length&&l.push({text:o.documents,key:jr,onClick:r.rollUpFolder}),l.push({text:e.name,key:e.id,onClick:r.rollUpFolder}),r.setState((function(e){return{columns:r.buildColumnsFromDriveItems(s),breadcrumbItems:l}}))},r.getKey=function(e){return e.id},r.onDetailsListUpdated=function(e){r.prevFolderKey!==r.getFolderKey()&&(r.prevFolderKey=r.getFolderKey(),e&&e.focusIndex(0))},null!=r.props.groupDriveItemsByFolder&&(i=r.props.groupDriveItemsByFolder[jr]),r.state={columns:r.buildColumnsFromDriveItems(i),selectedDriveItem:null,alertAddedForAttachment:null,breadcrumbItems:[],initialFocusedIndex:void 0},r}return Br(t,e),t.prototype.name=function(){return"OneDrivePicker"},t.prototype.renderComponent=function(){var e=this.props,n=e.isDriveItemAnAttachment,o=e.onDismiss,i=e.oneDrivePickerStrings,r=e.showErrorLoadingFiles,a=this.state,s=a.breadcrumbItems,l=a.selectedDriveItem,d=this.getClassNames(),u=this.getStyles(),p=null==s||0===s.length?i.documents:null,h=null;return null!=l&&(h=n(l)?i.existingFileError:null),c.createElement("div",{className:d.root},p&&c.createElement("div",{className:d.dialogHeader},c.createElement(g.J,{styles:u.subComponentStyles.dialogHeaderText},p)),c.createElement(yi.Q,{styles:u.subComponentStyles.breadcrumb,items:s||[],maxDisplayedItems:t.maxDisplayedFolderItems}),r?this.renderLoadingError():this.renderDriveItems(),c.createElement(g.J,{styles:u.subComponentStyles.attachmentError},h),c.createElement(v.E,{styles:u.subComponentStyles.dialogFooter},c.createElement(b.j,{className:"saveButton",onClick:this.addDriveItemAsAttachment,disabled:null==l||null!=h||r},i.save),c.createElement(y.Y,{className:"cancel",onClick:o},i.cancel)))},t.prototype.renderDriveItems=function(){var e,t,n=this.props,o=n.detailsListProps,i=n.groupDriveItemsByFolder,r=n.oneDrivePickerStrings,a=this.getClassNames(),s=this.getStyles();null!=i&&(t=i[this.getFolderKey()]);var l=this.state.columns||this.buildColumnsFromDriveItems(t);return t?0===t.length?c.createElement("div",{className:a.emptyContainer},c.createElement("div",{className:a.emptyFolder},c.createElement(C.I,Fr({styles:s.subComponentStyles.emptyFolderIcon,iconName:"FabricOpenFolderHorizontal"},null===(e=this.props.icons)||void 0===e?void 0:e.openFolder)),c.createElement(g.J,{styles:s.subComponentStyles.emptyFolderText,role:"alert"},r.emptyFolder))):(t=this.sortFolderContentsByColumnCriteria(t,l),c.createElement("div",{className:a.listContainer,"data-is-scrollable":"true"},c.createElement(kr,Fr({},o,{ariaLabel:r.sharePointFileListLabel,checkboxVisibility:vo.hidden,columns:l,initialFocusedIndex:this.state.initialFocusedIndex,items:t,selectionMode:Wo.Qc.single,getKey:this.getKey,onActiveItemChanged:this.onItemSelection,onDidUpdate:this.onDetailsListUpdated,onColumnHeaderClick:this.onColumnClick,onRenderItemColumn:this.renderItemColumn,onRenderRow:this.onRenderRow,onRenderDetailsHeader:this.onRenderDetailsHeader,styles:s.subComponentStyles.listDetails})))):c.createElement("div",{className:a.emptyContainer},c.createElement(nn.y,{ariaLabel:r.loadingFolderAriaLabel,ariaLive:"assertive",label:r.loadingFolderLabel,size:on.H.large}))},t.prototype.sortFolderContentsByColumnCriteria=function(e,n){if(null==e)return null;var o=e,i="",r=!1;return n&&n.forEach((function(e){e.isSorted&&(i=e.key,r=!!e.isSortedDescending)})),""!==i&&(r?o.sort(t.columnComparatorDescending(i)):o.sort(t.columnComparatorAscending(i))),o},t.prototype.renderLoadingError=function(){var e,t=this.getClassNames(),n=this.getStyles(),o=this.props,i=o.oneDrivePickerStrings,r=o.onRetry,a=o.showRetryOnError;return c.createElement("div",{className:t.errorContainer},c.createElement("div",{className:t.errorFolder},c.createElement(C.I,Fr({styles:n.subComponentStyles.errorFolderIcon,iconName:"FabricOpenFolderHorizontal"},null===(e=this.props.icons)||void 0===e?void 0:e.openFolder)),c.createElement(g.J,{styles:n.subComponentStyles.loadErrorTitle,role:"alert"},i.loadingErrorTitle),c.createElement(g.J,{styles:n.subComponentStyles.loadErrorMessage,role:"alert"},i.loadingErrorMessage),a&&r&&c.createElement(y.Y,{className:"retry",onClick:r},i.retry)))},t.prototype.buildColumnsFromDriveItems=function(e){var n=this.props.oneDrivePickerStrings;if(null!=e&&!st()(e)){var o=yr(e),i=Nr()(o,(function(e){return e.name===t.columnName||e.name===t.columnModifiedDate}));Qe()(i,(function(e){switch(e.className="itemText",e.name){case t.columnName:e.name=n.columnName,e.ariaLabel=dt.G(n.columnHeaderAriaLabel,n.columnName),e.sortAscendingAriaLabel=n.columnSortAscendingAriaLabel,e.sortDescendingAriaLabel=n.columnSortDescendingAriaLabel;break;case t.columnModifiedDate:e.name=n.columnModifiedDate,e.ariaLabel=dt.G(n.columnHeaderAriaLabel,n.columnModifiedDate),e.sortAscendingAriaLabel=n.columnSortAscendingAriaLabel,e.sortDescendingAriaLabel=n.columnSortDescendingAriaLabel}}));var r={key:"fileType",ariaLabel:dt.G(n.columnHeaderAriaLabel,n.columnFileType),sortAscendingAriaLabel:n.columnSortAscendingAriaLabel,sortDescendingAriaLabel:n.columnSortDescendingAriaLabel,className:"previewIcon",fieldName:"fileType",iconName:"Page",isIconOnly:!0,isCollapsible:!0,isGrouped:!1,isMultiline:!1,isRowHeader:!1,isSorted:!1,isSortedDescending:!1,maxWidth:t.driveItemIconSize,minWidth:100,name:n.columnFileType};return i.unshift(r),i}},t.prototype.getIconAriaLabel=function(e){if(e.childCount>-1)return Co.F.Folder;switch(e.fileType){case Dr.Er.Excel:return this.getAriaLabelForIcon(Co.F.ExcelLogo,4);case Dr.Er.OneNote:return this.getAriaLabelForIcon(Co.F.OneNoteLogo,4);case Dr.Er.Pdf:return this.getAriaLabelForIcon(Co.F.PDF,0);case Dr.Er.PowerPoint:return this.getAriaLabelForIcon(Co.F.PowerPointLogo,4);case Dr.Er.Project:return this.getAriaLabelForIcon(Co.F.ProjectLogo,6);case Dr.Er.Visio:return this.getAriaLabelForIcon(Co.F.VisioLogo,4);case Dr.Er.Word:return this.getAriaLabelForIcon(Co.F.WordLogo,4);case Dr.Er.Other:return this.props.oneDrivePickerStrings.image;default:return Co.F.Document}},t.prototype.getIconPropsForDriveItem=function(e){var t,n,o,i,r,a,s,l,c,d,u=this.props.icons;if(e.childCount>-1)return null!==(t=null===u||void 0===u?void 0:u.folder)&&void 0!==t?t:{iconName:Co.F.Folder};switch(e.fileType){case Dr.Er.Excel:return null!==(n=null===u||void 0===u?void 0:u.excel)&&void 0!==n?n:{iconName:Co.F.ExcelLogo};case Dr.Er.OneNote:return null!==(o=null===u||void 0===u?void 0:u.onenote)&&void 0!==o?o:{iconName:Co.F.OneNoteLogo};case Dr.Er.Pdf:return null!==(i=null===u||void 0===u?void 0:u.pdf)&&void 0!==i?i:{iconName:Co.F.PDF};case Dr.Er.PowerPoint:return null!==(r=null===u||void 0===u?void 0:u.powerpoint)&&void 0!==r?r:{iconName:Co.F.PowerPointLogo};case Dr.Er.Project:return null!==(a=null===u||void 0===u?void 0:u.project)&&void 0!==a?a:{iconName:Co.F.ProjectLogo};case Dr.Er.Visio:return null!==(s=null===u||void 0===u?void 0:u.visio)&&void 0!==s?s:{iconName:Co.F.VisioLogo};case Dr.Er.Word:return null!==(l=null===u||void 0===u?void 0:u.word)&&void 0!==l?l:{iconName:Co.F.WordLogo};case Dr.Er.Other:return null!==(c=null===u||void 0===u?void 0:u.photo)&&void 0!==c?c:{iconName:Co.F.Photo};default:return null!==(d=null===u||void 0===u?void 0:u.document)&&void 0!==d?d:{iconName:Co.F.Document}}},t.prototype.getAriaLabelForIcon=function(e,t){return dt.G(this.props.oneDrivePickerStrings.fileName,e.substring(0,e.length-t))},t.prototype.getClassNames=function(){return Rr(this.getStyles())},t.prototype.getStyles=function(){var e=this.props.styles;return Ar(e)},t.driveItemIconSize=20,t.maxDisplayedFolderItems=5,t.columnName="name",t.columnModifiedDate="modifiedDate",t.columnFileType="fileType",t.columnComparatorDescending=function(e){return function(t,n){return t[e]===n[e]?0:t[e]>n[e]?-1:1}},t.columnComparatorAscending=function(e){return function(t,n){return t[e]===n[e]?0:t[e]<n[e]?-1:1}},t}(d.$),zr=function(){return zr=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zr.apply(this,arguments)},Ur=function(e){return c.createElement(u.l,{hidden:!1,dialogContentProps:{className:e.dialogContentClassName,type:p.h.close,styles:e.dialogContentStyles},modalProps:{className:e.dialogClassName,containerClassName:e.dialogContainerClassName,isBlocking:!1,styles:e.modalStyles,layerProps:e.layerProps,focusTrapZoneProps:e.focusTrapZoneProps},styles:yo(e.styles),onDismiss:e.oneDrivePickerProps.onDismiss},c.createElement(Hr,zr({},e.oneDrivePickerProps)))};const Wr=(0,G.J9)((e=>{const t={root:(0,we.aS)(e)},n=[(0,we.aS)(e),{":focus, :hover":[(0,we.aS)(e),(0,we.Mi)(e)],":active":[(0,we.aS)(e),(0,we.D1)(e)]}];return{subComponentStyles:{dialogHeaderText:t,breadcrumb:{list:{button:n},chevron:(0,we.aS)(e),listItem:{":last-child .ms-Breadcrumb-itemLink":n},itemLink:n},listDetails:{root:[(0,we.dg)(e),(0,we.aS)(e)]},listDetailsHeader:{root:[(0,we.dg)(e),{"> .ms-DetailsHeader-cell":[(0,we.aS)(e),{i:(0,we.aS)(e)},{":focus-within, :hover":[(0,we.aS)(e),(0,we.Mi)(e),e===m.Sx.TeamsContrast&&{i:{color:Te.z.Black}}],":active":[(0,we.D1)(e),e===m.Sx.TeamsContrast&&{i:{color:Te.z.Black}}]}]}]},listDetailsRow:{root:[(0,we.dg)(e),(0,we.aS)(e),{i:[(0,we.aS)(e)]},{":focus-within, :hover":[(0,we.Mi)(e),{".ms-DetailsRow-cell":[(0,we.aS)(e),e===m.Sx.TeamsContrast&&{"> span, i":{color:Te.z.Black}}]}],"&.is-selected, :active, &.is-selected:focus:hover":[(0,we.D1)(e),e===m.Sx.TeamsContrast&&{"span, i":{color:Te.z.Black}},e===m.Sx.SharePoint&&{backgroundColor:Te.z.SharepointAddTaskButtonBackgroundColor}],".plannerWordLogo svg, .plannerExcelLogo svg, .plannerOneNoteLogo svg, .plannerPowerPointLogo svg, .plannerProjectLogo svg, .plannerVisioLogo svg":{height:"16px",width:"16px"}}]},errorFolderIcon:{root:(0,we.aS)(e)},loadErrorMessage:{root:(0,we.aS)(e)},loadErrorTitle:{root:(0,we.aS)(e)},emptyFolderIcon:{root:[(0,we.aS)(e),{"> svg":{width:"100px",height:"100px"}}]},emptyFolderText:{root:(0,we.aS)(e)},attachmentError:{root:[e===m.Sx.TeamsContrast&&{color:Te.z.White}]}}}})),Kr={word:Ne.ln,excel:Ne._O,powerpoint:Ne.ov,onenote:Ne.Zw,project:Ne.eJ,visio:Ne.NJ,photo:Ne.TE,pdf:Ne.qt,folder:Ne.r$,openFolder:Ne.Pj,document:Ne.Gn};var Gr;!function(e){e.getOneDrivePickerStrings=function(){return{documents:ht.p.Strings.OneDrivePickerForAttachments_Documents,existingFileError:ht.p.Strings.OneDrivePickerForAttachments_ExistingFileError,save:ht.p.Strings.OneDrivePickerForAttachments_Save,cancel:ht.p.Strings.OneDrivePickerForAttachments_Cancel,fileName:ht.p.Strings.OneDrivePickerForAttachments_FileName,image:ht.p.Strings.OneDrivePickerForAttachments_Image,sharePointFileListLabel:ht.p.Strings.OneDrivePickerForAttachments_SharePointFileListLabel,columnHeaderAriaLabel:ht.p.Strings.OneDrivePickerForAttachments_ColumnHeaderAriaLabel,columnFileType:ht.p.Strings.OneDrivePickerForAttachments_ColumnFileType,columnName:ht.p.Strings.OneDrivePickerForAttachments_ColumnName,columnModifiedDate:ht.p.Strings.OneDrivePickerForAttachments_ColumnModifiedDate,emptyFolder:ht.p.Strings.OneDrivePickerForAttachments_EmptyFolder,columnSortAscendingAriaLabel:ht.p.Strings.OneDrivePickerForAttachments_SortAscendingLabel,columnSortDescendingAriaLabel:ht.p.Strings.OneDrivePickerForAttachments_SortDescendingLabel,loadingFolderAriaLabel:ht.p.Strings.OneDrivePickerForAttachments_LoadingFolderAriaLabel,loadingErrorTitle:ht.p.Strings.OneDrivePickerForAttachments_FileLoadErrorTitle,retry:ht.p.Strings.OneDrivePickerForAttachments_Retry,loadingErrorMessage:ht.p.Strings.OneDrivePickerForAttachments_FileLoadErrorGenericMessage}}}(Gr||(Gr={}));const qr=e=>{const{theme:t,oneDrivePickerProps:n,...o}=e,i=(0,ft.S9)(t),r=(0,ft.XK)(t),a=Wr(t);return c.createElement(Ur,{dialogContainerClassName:m.bI,dialogContentClassName:(0,I.A)(m.vt,"oneDrivePickerDialog"),styles:i,dialogContentStyles:r,...o,oneDrivePickerProps:{...n,styles:a,icons:Kr}})};var Vr,Zr=n(46441),Yr=n(98571);!function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.Hidden=2]="Hidden"}(Vr||(Vr={}));const Xr=n.p+"static/media/project-compact.59bcd799f39ec525b0ae788e56986656.svg";var $r=function(){function e(e){var t=this;this._isSuggestionModel=function(e){return void 0!==e.item},this._ensureSuggestionModel=function(e){return t._isSuggestionModel(e)?e:{item:e,selected:!1,ariaLabel:void 0!==t.getAriaLabel?t.getAriaLabel(e):e.name||e.text||e.primaryText}},this.suggestions=[],this.getAriaLabel=e&&e.getAriaLabel}return e.prototype.updateSuggestions=function(e){e&&e.length>0?this.suggestions=this.convertSuggestionsToSuggestionItems(e):this.suggestions=[]},e.prototype.getSuggestions=function(){return this.suggestions},e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]},e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)},e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]},e}(),Jr=(0,G.J9)((function(e){return(0,K.pB)(void 0,Qr,e)})),Qr=function(){return{root:[Tr.dg,{padding:"8px",width:"176px",opacity:1}],editLabel:{marginBottom:"8px"},subComponentStyles:{callout:{calloutMain:[Tr.aS,{background:"inherit",overflow:"hidden"}]},textField:{}}}},ea=(0,G.J9)((function(e){return{root:(0,K.Zq)("labelEditorCallout",e.root),editLabel:(0,K.Zq)("editLabel",e.editLabel)}})),ta=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),na=function(){return na=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},na.apply(this,arguments)},oa=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.submitTextChange=function(){var e=o.props,t=e.currentLabelText,n=e.onChange,i=o.state.newLabelText;i!==t&&n(i)},o.onCalloutDismiss=function(){o.currentKeyCode!==h.D.ESCAPE&&o.submitTextChange(),o.props.onDismiss()},o.onCalloutKeyDown=function(e){o.currentKeyCode=e.keyCode},o.onTextFieldKeyDown=function(e){o.currentKeyCode=e.keyCode},o.onTextFieldKeyUp=function(e){e.keyCode===h.D.ENTER&&o.currentKeyCode===e.keyCode&&o.props.onDismiss(),o.currentKeyCode=null},o.onTextFieldChange=function(e,t){return o.setState({newLabelText:t})},o.state={newLabelText:t.currentLabelText||""},o.currentKeyCode=null,o}return ta(t,e),t.prototype.name=function(){return"LabelEditor"},t.prototype.renderComponent=function(){var e=this.getClassNames(),n=this.getStyles();return c.createElement(z.P,na({className:e.root,coverTarget:!1,directionalHint:this.props.directionalHint,doNotLayer:!1,isBeakVisible:!1,setInitialFocus:!0,target:this.props.target,onDismiss:this.onCalloutDismiss,onKeyDown:this.onCalloutKeyDown,styles:n.subComponentStyles.callout},this.props.calloutProps),c.createElement("div",{className:e.editLabel},this.props.labelEditorStrings.editLabel),c.createElement(Fe.A,{className:"labelEditorTextField","aria-label":this.props.labelEditorStrings.editLabelNameAriaLabel,autoFocus:!0,maxLength:t.LabelMaxLength,placeholder:this.props.placeholderText,value:this.state.newLabelText,onBlurCapture:this.submitTextChange,onChange:this.onTextFieldChange,onKeyDown:this.onTextFieldKeyDown,onKeyUp:this.onTextFieldKeyUp,disabled:this.props.isReadOnly,styleType:Fe.u.Dialog,styles:n.subComponentStyles.textField}))},t.prototype.getClassNames=function(){return ea(this.getStyles())},t.prototype.getStyles=function(){return Jr(this.props.styles)},t.LabelMaxLength=100,t}(d.$),ia=n(90838),ra=n(94031),aa="24px",sa="22px;",la=(0,G.J9)((function(e,t){return(0,K.pB)(e,ca,t)})),ca=function(e){var t=e.showEditButton,n=e.isCollapsed;return{root:[(0,Tr.GD)(),{cursor:"pointer",flex:"0 1 auto",".ms-layer":{position:"absolute",display:"none"}},t&&[{margin:"-5px",padding:"5px",paddingLeft:"13px",":hover":[Tr.wA,ra.lZ]}]],editableLabelWrapperInner:[(0,Tr.gS)(),{height:aa,justifyContent:"space-between"}],editableLabel:[(0,Tr.$Z)(),{borderWidth:"1px",borderRadius:n?"4px":ia.Z6,borderStyle:"solid",flex:"0 1 auto",padding:n?"0px 4px":"0px",overflow:"hidden"},(0,ra.lX)({backgroundColor:"inherit !important",borderColor:"inherit !important",color:"inherit !important"})],editableLabelInner:[(0,Tr.gS)(),{height:sa,"> .removeButton":{borderRadius:"0px",color:"inherit",height:sa,padding:"6px 5px",width:"24.5px",i:[Tr.JB,{paddingLeft:"1px",margin:"0px",color:"inherit"}]}}],editableLabelText:[(0,Tr.$Z)(),Tr.$u,(0,Tr.q0)("ellipsis"),{background:"transparent",border:"none",color:"inherit",cursor:t?"pointer":"text",flex:"0 1 auto",lineHeight:"20px",margin:0,padding:"1px 8px 3px"}],editLabelButton:[{cursor:"pointer",lineHeight:aa,padding:"0px 8px",verticalAlign:"middle",i:{color:xr.W7},":hover":{backgroundColor:zn.kd.gray40,borderRadius:ia.Z6,i:{backgroundColor:zn.kd.gray40}}}]}},da=(0,G.J9)((function(e){return{root:(0,K.Zq)("editableLabelWrapper",e.root),editableLabelWrapperInner:(0,K.Zq)("editableLabelWrapperInner",e.editableLabelWrapperInner),editableLabel:(0,K.Zq)("editableLabel",e.editableLabel),editableLabelInner:(0,K.Zq)("editableLabelInner",e.editableLabelInner),editableLabelText:(0,K.Zq)("editableLabelText",e.editableLabelText),editLabelButton:(0,K.Zq)("editLabelButton",e.editLabelButton)}})),ua=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),pa=function(){return pa=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pa.apply(this,arguments)},ha=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.labelWrapper=c.createRef(),o.labelbutton=c.createRef(),o.onClickRemoveButton=function(e){var t,n;e.stopPropagation(),null===(n=(t=o.props).onRemoveLabel)||void 0===n||n.call(t,o.props.item.index)},o.toggleEdit=function(){var e,t;o.props.isEditing?(null===(t=null===(e=o.labelbutton)||void 0===e?void 0:e.current)||void 0===t||t.focus(),o.props.onCloseEditor()):o.props.onOpenEditor(o.props.item)},o.onChangeLabelText=function(e){var t,n;null===(n=(t=o.props).onChangeText)||void 0===n||n.call(t,o.props.item.index,e),o.setState({newLabelText:e})},o.onBlurLabel=function(){return o.setState({isLabelFocused:!1})},o.onBlurRemoveButton=function(){return o.setState({isRemoveButtonFocused:!1})},o.onFocusLabel=function(){return o.setState({isLabelFocused:!0})},o.onFocusRemoveButton=function(){return o.setState({isRemoveButtonFocused:!0})},o.onMouseLeaveLabel=function(){return o.setState({isMouseOverLabel:!1})},o.onMouseEnterLabel=function(){return o.setState({isMouseOverLabel:!0})},o.onMouseLeaveRemoveButton=function(){return o.setState({isMouseOverRemoveButton:!1})},o.onMouseEnterRemoveButton=function(){return o.setState({isMouseOverRemoveButton:!0})},o.toggleEditAndStopPropagation=function(e){e.stopPropagation(),o.toggleEdit()},o.stopPropagation=function(e){e.stopPropagation(),e.preventDefault()},o.getStyleProps=(0,G.J9)((function(e,t){return{showEditButton:e,isCollapsed:t}})),o.state={isLabelFocused:!1,isMouseOverLabel:!1,isMouseOverRemoveButton:!1,isRemoveButtonFocused:!1,newLabelText:null},o}return ua(t,e),t.prototype.name=function(){return"EditableLabel"},t.prototype.componentDidUpdate=function(e){e.item.name!==this.props.item.name&&this.setState({newLabelText:null})},t.prototype.renderComponent=function(){var e,t,n=this.props,o=n.item,i=n.showEditButton,r=n.editableLabelStrings,a=n.isReadOnly,s=n.isEditing,l=n.icons,d=this.state.newLabelText,u=this.props.item,p=u.index,h=u.name||o.placeholderText;null!==d&&(h=st()(d)?o.placeholderText:d);var m={background:o.labelFormatting.BackgroundColor,color:o.labelFormatting.TextColor,borderColor:this.props.isCollapsed||this.state.isMouseOverLabel||this.state.isLabelFocused||this.state.isRemoveButtonFocused?o.labelFormatting.HoverBorderColor:"transparent"},g={backgroundColor:o.labelFormatting.HoverBackgroundColor},f=dt.G(r.addLabelTooltip,h),v=(0,So.jI)(),b=v?U.A.bottomRightEdge:U.A.bottomLeftEdge;s&&i&&(b=v?U.A.leftCenter:U.A.rightTopEdge);var y=this.props.isCollapsed?"":h,S=this.getClassNames(),k=c.createElement("div",{className:(0,I.A)(S.editableLabel,"label"+p),style:m,onBlur:this.onBlurLabel,onFocus:this.onFocusLabel},!this.props.isCollapsed&&c.createElement("div",{className:S.editableLabelInner},this.renderLabel(y,S),this.props.onRemoveLabel&&c.createElement(ne.K,{className:"removeButton",iconProps:pa({iconName:"Cancel"},null===l||void 0===l?void 0:l.cancel),ariaLabel:dt.G(r.removeButtonAriaLabel,h),title:dt.G(r.removeButtonAriaLabel,h),onBlur:this.onBlurRemoveButton,onClick:this.onClickRemoveButton,onFocus:this.onFocusRemoveButton,onMouseEnter:this.onMouseEnterRemoveButton,onMouseLeave:this.onMouseLeaveRemoveButton,style:this.state.isMouseOverRemoveButton||this.state.isRemoveButtonFocused?g:void 0,disabled:a})));return c.createElement("div",{className:S.root,onMouseEnter:this.onMouseEnterLabel,onMouseLeave:this.onMouseLeaveLabel,ref:this.labelWrapper,title:i?f:void 0},c.createElement("div",{className:S.editableLabelWrapperInner},k,i&&c.createElement("div",{className:S.editLabelButton,"aria-label":r.editButtonAriaLabel,onClickCapture:this.toggleEditAndStopPropagation,onMouseDown:this.stopPropagation,onMouseUpCapture:this.stopPropagation,role:"button",title:r.editButtonAriaLabel},c.createElement(C.I,pa({iconName:"Edit"},null===l||void 0===l?void 0:l.edit))),s&&c.createElement(oa,{currentLabelText:null!==h&&void 0!==h?h:"",directionalHint:b,placeholderText:null!==(e=this.props.placeholder)&&void 0!==e?e:"",target:null!==(t=this.labelWrapper.current)&&void 0!==t?t:"",labelEditorStrings:this.props.labelEditorStrings,onChange:this.onChangeLabelText,onDismiss:this.toggleEdit,isReadOnly:this.props.isReadOnly,styles:this.props.labelEditorStyles})))},t.prototype.renderLabel=function(e,t){var n=this.props,o=n.showEditButton,i=n.editableLabelStrings;return c.createElement("button",{className:t.editableLabelText,"aria-label":dt.G(i.editLabelButtonAriaLabel,e),title:dt.G(i.editLabelTooltip,e),onClick:o?void 0:this.toggleEditAndStopPropagation,onKeyUp:o?void 0:this.stopPropagation,ref:this.labelbutton},e)},t.prototype.getStyles=function(){var e=this.props,t=e.showEditButton,n=e.isCollapsed,o=e.styles,i=this.getStyleProps(t,null!==n&&void 0!==n&&n);return la(i,o)},t.prototype.getClassNames=function(){return da(this.getStyles())},t.LabelMaxLength=100,t}(d.$),ma=n(25255);(0,ma.hN)([{rawString:".callout_ad5629e1 .ms-Suggestions-itemButton{padding:0;border:none}.callout_ad5629e1 .ms-Suggestions{min-width:300px}"}]);var ga="callout_ad5629e1",fa=n(72829);(0,ma.hN)([{rawString:".suggestionsContainer_44c59fda{overflow-y:auto;overflow-x:hidden;max-height:300px}.suggestionsContainer_44c59fda .ms-Suggestion-item:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";cursor:pointer}.suggestionsContainer_44c59fda .is-suggested{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.suggestionsContainer_44c59fda .is-suggested:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";cursor:pointer}"}]);var va="suggestionsContainer_44c59fda",ba=i,ya=function(e){function t(t){var n=e.call(this,t)||this;return n._selectedElement=c.createRef(),n.SuggestionsItemOfProperType=fa.B,n._onClickTypedSuggestionsItem=function(e,t){return function(o){n.props.onSuggestionClick(o,e,t)}},n._onRemoveTypedSuggestionsItem=function(e,t){return function(o){(0,n.props.onSuggestionRemove)(o,e,t),o.stopPropagation()}},(0,L.f)(n),n.currentIndex=-1,n}return(0,k.__extends)(t,e),t.prototype.nextSuggestion=function(){var e=this.props.suggestions;if(e&&e.length>0){if(-1===this.currentIndex)return this.setSelectedSuggestion(0),!0;if(this.currentIndex<e.length-1)return this.setSelectedSuggestion(this.currentIndex+1),!0;if(this.props.shouldLoopSelection&&this.currentIndex===e.length-1)return this.setSelectedSuggestion(0),!0}return!1},t.prototype.previousSuggestion=function(){var e=this.props.suggestions;if(e&&e.length>0){if(-1===this.currentIndex)return this.setSelectedSuggestion(e.length-1),!0;if(this.currentIndex>0)return this.setSelectedSuggestion(this.currentIndex-1),!0;if(this.props.shouldLoopSelection&&0===this.currentIndex)return this.setSelectedSuggestion(e.length-1),!0}return!1},Object.defineProperty(t.prototype,"selectedElement",{get:function(){return this._selectedElement.current||void 0},enumerable:!1,configurable:!0}),t.prototype.getCurrentItem=function(){return this.props.suggestions[this.currentIndex]},t.prototype.getSuggestionAtIndex=function(e){return this.props.suggestions[e]},t.prototype.hasSuggestionSelected=function(){return-1!==this.currentIndex&&this.currentIndex<this.props.suggestions.length},t.prototype.removeSuggestion=function(e){this.props.suggestions.splice(e,1)},t.prototype.deselectAllSuggestions=function(){this.currentIndex>-1&&this.props.suggestions[this.currentIndex]&&(this.props.suggestions[this.currentIndex].selected=!1,this.currentIndex=-1,this.forceUpdate())},t.prototype.setSelectedSuggestion=function(e){var t=this.props.suggestions;e>t.length-1||e<0?(this.currentIndex=0,this.currentSuggestion.selected=!1,this.currentSuggestion=t[0],this.currentSuggestion.selected=!0):(this.currentIndex>-1&&t[this.currentIndex]&&(t[this.currentIndex].selected=!1),t[e].selected=!0,this.currentIndex=e,this.currentSuggestion=t[e]),this.forceUpdate()},t.prototype.componentDidUpdate=function(){this.scrollSelected()},t.prototype.render=function(){var e=this,t=this.props,n=t.onRenderSuggestion,o=t.suggestionsItemClassName,i=t.resultsMaximumNumber,r=t.showRemoveButtons,a=t.suggestionsContainerAriaLabel,s=this.SuggestionsItemOfProperType,l=this.props.suggestions;return i&&(l=l.slice(0,i)),c.createElement("div",{className:(0,I.A)("ms-Suggestions-container",ba.suggestionsContainer),id:"suggestion-list",role:"listbox","aria-label":a},l.map((function(t,i){return c.createElement("div",{ref:t.selected||i===e.currentIndex?e._selectedElement:void 0,key:t.item.key?t.item.key:i,id:"sug-"+i},c.createElement(s,{id:"sug-item"+i,suggestionModel:t,RenderSuggestion:n,onClick:e._onClickTypedSuggestionsItem(t.item,i),className:o,showRemoveButton:r,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,i),isSelectedOverride:i===e.currentIndex}))})))},t.prototype.scrollSelected=function(){var e;void 0!==(null===(e=this._selectedElement.current)||void 0===e?void 0:e.scrollIntoView)&&this._selectedElement.current.scrollIntoView(!1)},t}(c.Component);(0,ma.hN)([{rawString:".root_ade399af{min-width:260px}.actionButton_ade399af{background:0 0;background-color:transparent;border:0;cursor:pointer;margin:0;padding:0;position:relative;width:100%;font-size:12px}html[dir=ltr] .actionButton_ade399af{text-align:left}html[dir=rtl] .actionButton_ade399af{text-align:right}.actionButton_ade399af:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";cursor:pointer}.actionButton_ade399af:active,.actionButton_ade399af:focus{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_ade399af .ms-Button-icon{font-size:16px;width:25px}.actionButton_ade399af .ms-Button-label{margin:0 4px 0 9px}html[dir=rtl] .actionButton_ade399af .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_ade399af{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.buttonSelected_ade399af:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";cursor:pointer}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.buttonSelected_ade399af:hover{background-color:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.buttonSelected_ade399af{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsTitle_ade399af{font-size:12px}.suggestionsSpinner_ade399af{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir=ltr] .suggestionsSpinner_ade399af{padding-left:14px}html[dir=rtl] .suggestionsSpinner_ade399af{padding-right:14px}html[dir=ltr] .suggestionsSpinner_ade399af{text-align:left}html[dir=rtl] .suggestionsSpinner_ade399af{text-align:right}.suggestionsSpinner_ade399af .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_ade399af .ms-Spinner-label{display:inline-block;margin:0 10px 0 16px;vertical-align:middle}html[dir=rtl] .suggestionsSpinner_ade399af .ms-Spinner-label{margin:0 16px 0 10px}.itemButton_ade399af{height:100%;width:100%;padding:7px 12px}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.itemButton_ade399af{color:WindowText}}.screenReaderOnly_ade399af{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var Ca,Sa="root_ade399af",ka="actionButton_ade399af",Da="buttonSelected_ade399af",xa="suggestionsTitle_ade399af",Ta="suggestionsSpinner_ade399af",Ea="itemButton_ade399af",wa="screenReaderOnly_ade399af",_a=r;!function(e){e[e.header=0]="header",e[e.suggestion=1]="suggestion",e[e.footer=2]="footer"}(Ca||(Ca={}));var Ia=function(e){function t(t){var n=e.call(this,t)||this;return(0,L.f)(n),n}return(0,k.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.renderItem,o=t.onExecute,i=t.isSelected,r=t.id,a=t.className;return o?c.createElement("div",{id:r,onClick:o,className:(0,I.A)("ms-Suggestions-sectionButton",a,_a.actionButton,(e={},e["is-selected "+_a.buttonSelected]=i,e))},n()):c.createElement("div",{id:r,className:(0,I.A)("ms-Suggestions-section",a,_a.suggestionsTitle)},n())},t}(c.Component),Pa=function(e){function t(t){var n=e.call(this,t)||this;return n._selectedElement=c.createRef(),n._suggestions=c.createRef(),n.SuggestionsOfProperType=ya,(0,L.f)(n),n.state={selectedHeaderIndex:-1,selectedFooterIndex:-1,suggestions:t.suggestions},n}return(0,k.__extends)(t,e),t.prototype.componentDidMount=function(){this.resetSelectedItem()},t.prototype.componentDidUpdate=function(e){var t=this;this.scrollSelected(),e.suggestions&&e.suggestions!==this.props.suggestions&&this.setState({suggestions:this.props.suggestions},(function(){t.resetSelectedItem()}))},t.prototype.componentWillUnmount=function(){var e;null===(e=this._suggestions.current)||void 0===e||e.deselectAllSuggestions()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.headerItemsProps,o=e.footerItemsProps,i=e.suggestionsAvailableAlertText,r=(0,K.Zq)(K.dX),a=this.state.suggestions&&this.state.suggestions.length>0&&i;return c.createElement("div",{className:(0,I.A)("ms-Suggestions",t||"",_a.root)},n&&this.renderHeaderItems(),this._renderSuggestions(),o&&this.renderFooterItems(),a?c.createElement("span",{role:"alert","aria-live":"polite",className:r},i):null)},Object.defineProperty(t.prototype,"currentSuggestion",{get:function(){var e;return(null===(e=this._suggestions.current)||void 0===e?void 0:e.getCurrentItem())||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentSuggestionIndex",{get:function(){return this._suggestions.current?this._suggestions.current.currentIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedElement",{get:function(){var e;return this._selectedElement.current?this._selectedElement.current:null===(e=this._suggestions.current)||void 0===e?void 0:e.selectedElement},enumerable:!1,configurable:!0}),t.prototype.hasSuggestionSelected=function(){var e;return(null===(e=this._suggestions.current)||void 0===e?void 0:e.hasSuggestionSelected())||!1},t.prototype.hasSelection=function(){var e=this.state,t=e.selectedHeaderIndex,n=e.selectedFooterIndex;return-1!==t||this.hasSuggestionSelected()||-1!==n},t.prototype.executeSelectedAction=function(){var e,t=this.props,n=t.headerItemsProps,o=t.footerItemsProps,i=this.state,r=i.selectedHeaderIndex,a=i.selectedFooterIndex;if(n&&-1!==r&&r<n.length){var s=n[r];s.onExecute&&s.onExecute()}else if(null===(e=this._suggestions.current)||void 0===e?void 0:e.hasSuggestionSelected())this.props.completeSuggestion();else if(o&&-1!==a&&a<o.length){var l=o[a];l.onExecute&&l.onExecute()}},t.prototype.removeSuggestion=function(e){var t,n;null===(t=this._suggestions.current)||void 0===t||t.removeSuggestion(e||(null===(n=this._suggestions.current)||void 0===n?void 0:n.currentIndex))},t.prototype.handleKeyDown=function(e){var t,n,o,i,r=this.state,a=r.selectedHeaderIndex,s=r.selectedFooterIndex,l=!1;return e===P.c.down?-1!==a||(null===(t=this._suggestions.current)||void 0===t?void 0:t.hasSuggestionSelected())||-1!==s?-1!==a?(this.selectNextItem(Ca.header),l=!0):(null===(n=this._suggestions.current)||void 0===n?void 0:n.hasSuggestionSelected())?(this.selectNextItem(Ca.suggestion),l=!0):-1!==s&&(this.selectNextItem(Ca.footer),l=!0):this.selectFirstItem():e===P.c.up?-1!==a||(null===(o=this._suggestions.current)||void 0===o?void 0:o.hasSuggestionSelected())||-1!==s?-1!==a?(this.selectPreviousItem(Ca.header),l=!0):(null===(i=this._suggestions.current)||void 0===i?void 0:i.hasSuggestionSelected())?(this.selectPreviousItem(Ca.suggestion),l=!0):-1!==s&&(this.selectPreviousItem(Ca.footer),l=!0):this.selectLastItem():e!==P.c.enter&&e!==P.c.tab||this.hasSelection()&&(this.executeSelectedAction(),l=!0),l},t.prototype.scrollSelected=function(){this._selectedElement.current&&this._selectedElement.current.scrollIntoView(!1)},t.prototype.renderHeaderItems=function(){var e=this,t=this.props,n=t.headerItemsProps,o=t.suggestionsHeaderContainerAriaLabel,i=this.state.selectedHeaderIndex;return n?c.createElement("div",{className:(0,I.A)("ms-Suggestions-headerContainer",_a.suggestionsContainer),id:"suggestionHeader-list",role:"list","aria-label":o},n.map((function(t,n){var o=-1!==i&&i===n;return t.shouldShow()?c.createElement("div",{ref:o?e._selectedElement:void 0,id:"sug-header"+n,key:"sug-header"+n,role:"listitem","aria-label":t.ariaLabel},c.createElement(Ia,{id:"sug-header-item"+n,isSelected:o,renderItem:t.renderItem,onExecute:t.onExecute,className:t.className})):null}))):null},t.prototype.renderFooterItems=function(){var e=this,t=this.props,n=t.footerItemsProps,o=t.suggestionsFooterContainerAriaLabel,i=this.state.selectedFooterIndex;return n?c.createElement("div",{className:(0,I.A)("ms-Suggestions-footerContainer",_a.suggestionsContainer),id:"suggestionFooter-list",role:"list","aria-label":o},n.map((function(t,n){var o=-1!==i&&i===n;return t.shouldShow()?c.createElement("div",{ref:o?e._selectedElement:void 0,id:"sug-footer"+n,key:"sug-footer"+n,role:"listitem","aria-label":t.ariaLabel},c.createElement(Ia,{id:"sug-footer-item"+n,isSelected:o,renderItem:t.renderItem,onExecute:t.onExecute,className:t.className})):null}))):null},t.prototype._renderSuggestions=function(){var e=this.SuggestionsOfProperType;return c.createElement(e,(0,k.__assign)({ref:this._suggestions},this.props,{suggestions:this.state.suggestions}))},t.prototype.selectNextItem=function(e,t){if(e!==t){var n=void 0!==t?t:e;this._selectNextItemOfItemType(e,n===e?this._getCurrentIndexForType(e):void 0)||this.selectNextItem(this._getNextItemSectionType(e),n)}else this._selectNextItemOfItemType(e)},t.prototype.selectPreviousItem=function(e,t){if(e!==t){var n=void 0!==t?t:e;this._selectPreviousItemOfItemType(e,n===e?this._getCurrentIndexForType(e):void 0)||this.selectPreviousItem(this._getPreviousItemSectionType(e),n)}else this._selectPreviousItemOfItemType(e)},t.prototype.resetSelectedItem=function(){var e;this.setState({selectedHeaderIndex:-1,selectedFooterIndex:-1}),null===(e=this._suggestions.current)||void 0===e||e.deselectAllSuggestions(),(void 0===this.props.shouldSelectFirstItem||this.props.shouldSelectFirstItem())&&this.selectFirstItem()},t.prototype.selectFirstItem=function(){this._selectNextItemOfItemType(Ca.header)||this._selectNextItemOfItemType(Ca.suggestion)||this._selectNextItemOfItemType(Ca.footer)},t.prototype.selectLastItem=function(){this._selectPreviousItemOfItemType(Ca.footer)||this._selectPreviousItemOfItemType(Ca.suggestion)||this._selectPreviousItemOfItemType(Ca.header)},t.prototype._selectNextItemOfItemType=function(e,t){var n,o;if(void 0===t&&(t=-1),e===Ca.suggestion){if(this.state.suggestions.length>t+1)return null===(n=this._suggestions.current)||void 0===n||n.setSelectedSuggestion(t+1),this.setState({selectedHeaderIndex:-1,selectedFooterIndex:-1}),!0}else{var i=e===Ca.header,r=i?this.props.headerItemsProps:this.props.footerItemsProps;if(r&&r.length>t+1)for(var a=t+1;a<r.length;a++){var s=r[a];if(s.onExecute&&s.shouldShow())return this.setState({selectedHeaderIndex:i?a:-1}),this.setState({selectedFooterIndex:i?-1:a}),null===(o=this._suggestions.current)||void 0===o||o.deselectAllSuggestions(),!0}}return!1},t.prototype._selectPreviousItemOfItemType=function(e,t){var n,o;if(e===Ca.suggestion){if((i=void 0!==t?t:this.state.suggestions.length)>0)return null===(n=this._suggestions.current)||void 0===n||n.setSelectedSuggestion(i-1),this.setState({selectedHeaderIndex:-1,selectedFooterIndex:-1}),!0}else{var i,r=e===Ca.header,a=r?this.props.headerItemsProps:this.props.footerItemsProps;if(a)if((i=void 0!==t?t:a.length)>0)for(var s=i-1;s>=0;s--){var l=a[s];if(l.onExecute&&l.shouldShow())return this.setState({selectedHeaderIndex:r?s:-1}),this.setState({selectedFooterIndex:r?-1:s}),null===(o=this._suggestions.current)||void 0===o||o.deselectAllSuggestions(),!0}}return!1},t.prototype._getCurrentIndexForType=function(e){switch(e){case Ca.header:return this.state.selectedHeaderIndex;case Ca.suggestion:return this._suggestions.current.currentIndex;case Ca.footer:return this.state.selectedFooterIndex}},t.prototype._getNextItemSectionType=function(e){switch(e){case Ca.header:return Ca.suggestion;case Ca.suggestion:return Ca.footer;case Ca.footer:return Ca.header}},t.prototype._getPreviousItemSectionType=function(e){switch(e){case Ca.header:return Ca.footer;case Ca.suggestion:return Ca.header;case Ca.footer:return Ca.suggestion}},t}(c.Component),Aa=o,Ra=function(e){function t(t){var n=e.call(this,t)||this;return n.root=c.createRef(),n.suggestionsControl=c.createRef(),n.SuggestionsControlOfProperType=Pa,n.isComponentMounted=!1,n.onQueryStringChanged=function(e){e!==n.state.queryString&&(n.setState({queryString:e}),n.props.onInputChanged&&n.props.onInputChanged(e),n.updateValue(e))},n.hidePicker=function(){var e=n.isSuggestionsShown;n.setState({suggestionsVisible:!1}),n.props.onSuggestionsHidden&&e&&n.props.onSuggestionsHidden()},n.showPicker=function(e){void 0===e&&(e=!1);var t=n.isSuggestionsShown;n.setState({suggestionsVisible:!0});var o=n.props.inputElement?n.props.inputElement.value:"";e&&n.updateValue(o),n.props.onSuggestionsShown&&!t&&n.props.onSuggestionsShown()},n.completeSuggestion=function(){n.suggestionsControl.current&&n.suggestionsControl.current.hasSuggestionSelected()&&n.onChange(n.suggestionsControl.current.currentSuggestion.item)},n.onSuggestionClick=function(e,t,o){n.onChange(t),n._updateSuggestionsVisible(!1)},n.onSuggestionRemove=function(e,t,o){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(t),n.suggestionsControl.current&&n.suggestionsControl.current.removeSuggestion(o)},n.onKeyDown=function(e){if(n.state.suggestionsVisible&&(!n.props.inputElement||n.props.inputElement.contains(e.target))){var t=e.which;switch(t){case P.c.escape:n.hidePicker(),e.preventDefault(),e.stopPropagation();break;case P.c.tab:case P.c.enter:!e.shiftKey&&!e.ctrlKey&&n.suggestionsControl.current&&n.suggestionsControl.current.handleKeyDown(t)?(e.preventDefault(),e.stopPropagation()):n._onValidateInput();break;case P.c.del:n.props.onRemoveSuggestion&&n.suggestionsControl.current&&n.suggestionsControl.current.hasSuggestionSelected()&&n.suggestionsControl.current.currentSuggestion&&e.shiftKey&&(n.props.onRemoveSuggestion(n.suggestionsControl.current.currentSuggestion.item),n.suggestionsControl.current.removeSuggestion(),n.forceUpdate(),e.stopPropagation());break;case P.c.up:case P.c.down:n.suggestionsControl.current&&n.suggestionsControl.current.handleKeyDown(t)&&(e.preventDefault(),e.stopPropagation(),n._updateActiveDescendant())}}},n._onValidateInput=function(){if(n.state.queryString&&n.props.onValidateInput&&n.props.createGenericItem){var e=n.props.createGenericItem(n.state.queryString,n.props.onValidateInput(n.state.queryString)),t=n.suggestionStore.convertSuggestionsToSuggestionItems([e]);n.onChange(t[0].item)}},n._async=new N.j(n),(0,L.f)(n),n.suggestionStore=t.suggestionsStore,n.state={queryString:"",didBind:!1},n}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"inputText",{get:function(){return this.state.queryString},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestions",{get:function(){return this.suggestionStore.suggestions},enumerable:!1,configurable:!0}),t.prototype.forceResolveSuggestion=function(){this.suggestionsControl.current&&this.suggestionsControl.current.hasSuggestionSelected()?this.completeSuggestion():this._onValidateInput()},Object.defineProperty(t.prototype,"currentSelectedSuggestionIndex",{get:function(){return this.suggestionsControl.current?this.suggestionsControl.current.currentSuggestionIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSuggestionsShown",{get:function(){return void 0!==this.state.suggestionsVisible&&this.state.suggestionsVisible},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._bindToInputElement(),this.isComponentMounted=!0,this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)},t.prototype.componentDidUpdate=function(){this._bindToInputElement()},t.prototype.componentWillUnmount=function(){this._unbindFromInputElement(),this.isComponentMounted=!1},t.prototype.updateSuggestions=function(e,t){void 0===t&&(t=!1),this.suggestionStore.updateSuggestions(e),t&&this.forceUpdate()},t.prototype.render=function(){var e=this.props.className;return c.createElement("div",{ref:this.root,className:(0,I.A)("ms-BasePicker ms-BaseFloatingPicker",e||"")},this.renderSuggestions())},t.prototype.renderSuggestions=function(){var e=this.SuggestionsControlOfProperType;return this.props.suggestionItems&&this.suggestionStore.updateSuggestions(this.props.suggestionItems),this.state.suggestionsVisible?c.createElement(z.P,(0,k.__assign)({className:Aa.callout,isBeakVisible:!1,gapSpace:5,target:this.props.inputElement,onDismiss:this.hidePicker,directionalHint:U.A.bottomLeftEdge,directionalHintForRTL:U.A.bottomRightEdge,calloutWidth:this.props.calloutWidth?this.props.calloutWidth:0},this.props.pickerCalloutProps),c.createElement(e,(0,k.__assign)({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionsControl,completeSuggestion:this.completeSuggestion,shouldLoopSelection:!1},this.props.pickerSuggestionsProps))):null},t.prototype.onSelectionChange=function(){this.forceUpdate()},t.prototype.updateValue=function(e){""===e?this.updateSuggestionWithZeroState():this._onResolveSuggestions(e)},t.prototype.updateSuggestionWithZeroState=function(){if(this.props.onZeroQuerySuggestion){var e=(0,this.props.onZeroQuerySuggestion)(this.props.selectedItems);this.updateSuggestionsList(e)}else this.hidePicker()},t.prototype.updateSuggestionsList=function(e){var t=this;Array.isArray(e)?this.updateSuggestions(e,!0):e&&e.then&&(this.currentPromise=e,e.then((function(n){e===t.currentPromise&&t.isComponentMounted&&t.updateSuggestions(n,!0)})))},t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)},t.prototype._updateActiveDescendant=function(){if(this.props.inputElement&&this.suggestionsControl.current&&this.suggestionsControl.current.selectedElement){var e=this.suggestionsControl.current.selectedElement.getAttribute("id");e&&this.props.inputElement.setAttribute("aria-activedescendant",e)}},t.prototype._onResolveSuggestions=function(e){var t=this.props.onResolveSuggestions(e,this.props.selectedItems);this._updateSuggestionsVisible(!0),null!==t&&this.updateSuggestionsList(t)},t.prototype._updateSuggestionsVisible=function(e){e?this.showPicker():this.hidePicker()},t.prototype._bindToInputElement=function(){this.props.inputElement&&!this.state.didBind&&(this.props.inputElement.addEventListener("keydown",this.onKeyDown),this.setState({didBind:!0}))},t.prototype._unbindFromInputElement=function(){this.props.inputElement&&this.state.didBind&&(this.props.inputElement.removeEventListener("keydown",this.onKeyDown),this.setState({didBind:!1}))},t}(c.Component),La=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Na=(0,Sn.Z)(),Ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return La(t,e),t.prototype.render=function(){var e,t=this.props,n=t.suggestionModel,o=t.RenderSuggestion,i=t.onClick,r=t.className,a=t.isSelectedOverride,s=t.styles,l=t.theme,d=s?Na(s,{theme:l,className:r,suggested:n.selected||a}):{root:(0,I.A)("ms-Suggestions-item","suggestionsItem",(e={},e["is-suggested suggestionsItemIsSuggested"]=n.selected||a,e),r),itemButton:(0,I.A)("ms-Suggestions-itemButton","itemButton"),closeButton:(0,I.A)("ms-Suggestions-closeButton","closeButton")};return c.createElement("div",{className:d.root},c.createElement("div",{onClick:i,className:d.itemButton,role:"button"},o(n.item,this.props)))},t}(fa.B),Oa=function(){function e(){}return e.create=function(){return new N.j(void 0,(function(e){throw e}))},e}(),Ba=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fa=function(e){function t(t){var n=e.call(this,t)||this;return n._selectedSuggestion=c.createRef(),n.async=Oa.create(),n.SuggestionsItemOfAppropriateType=Ma,n.scrollToSuggestedItem=function(){var e,t;if(null!=n._selectedSuggestion.current){null===(t=(e=n._selectedSuggestion.current).scrollIntoView)||void 0===t||t.call(e,{behavior:"smooth",block:"center"})}},n._selectedElement=c.createRef(),n}return Ba(t,e),Object.defineProperty(t.prototype,"selectedElement",{get:function(){var e;return null!==(e=this._selectedSuggestion.current)&&void 0!==e?e:void 0},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.onRenderSuggestion,o=t.suggestionsItemClassName,i=t.resultsMaximumNumber,r=t.showRemoveButtons,a=t.suggestionsContainerAriaLabel,s=this.SuggestionsItemOfAppropriateType,l=this.props.suggestions;return i&&(l=l.slice(0,i)),this.async.setTimeout(this.scrollToSuggestedItem,0),c.createElement("div",{className:"ms-Suggestions-container",id:"suggestion-list",role:"listbox","aria-label":a},l.map((function(t,i){return c.createElement("div",{ref:t.selected||i===e.currentIndex?e._selectedSuggestion:void 0,key:t.item.key?t.item.key:i,id:"sug-"+i,role:"option","aria-label":t.ariaLabel},c.createElement(s,{id:"sug-item"+i,suggestionModel:t,RenderSuggestion:n,onClick:e._onClickTypedSuggestionsItem(t.item,i),className:o,showRemoveButton:r,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,i),isSelectedOverride:i===e.currentIndex}))})))},t}(ya),ja=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ha=function(e){function t(t){var n=e.call(this,t)||this;return n.SuggestionsOfAppropriateType=Fa,n.SuggestionsOfProperType=n.SuggestionsOfAppropriateType,n}return ja(t,e),t}(Pa),za=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ua=function(e){function t(t){var n=e.call(this,t)||this;return n.SuggestionsControlOfAppropriateType=Ha,n.hidePicker=function(){var e,t=n.isSuggestionsShown;n.setState({suggestionsVisible:!1}),n.props.onSuggestionsHidden&&t&&n.props.onSuggestionsHidden(),null===(e=n.props.inputElement)||void 0===e||e.setAttribute("aria-activedescendant","")},n.onKeyDown=function(e){var t,o,i,r;if(n.state.suggestionsVisible&&(!n.props.inputElement||n.props.inputElement.contains(e.target))){null===(o=(t=n.props).onKeyDown)||void 0===o||o.call(t,e,null===(r=null===(i=n.suggestionsControl.current)||void 0===i?void 0:i.currentSuggestion)||void 0===r?void 0:r.item);var a=e.which;switch(a){case P.c.escape:n.hidePicker(),e.preventDefault(),e.stopPropagation();break;case P.c.tab:case P.c.enter:!e.shiftKey&&!e.ctrlKey&&n.suggestionsControl.current&&n.suggestionsControl.current.handleKeyDown(a)?(e.preventDefault(),e.stopPropagation()):n._onValidateInput();break;case P.c.del:n.props.onRemoveSuggestion&&n.suggestionsControl.current&&n.suggestionsControl.current.hasSuggestionSelected&&n.suggestionsControl.current.currentSuggestion&&e.shiftKey&&(n.props.onRemoveSuggestion(n.suggestionsControl.current.currentSuggestion.item),n.suggestionsControl.current.removeSuggestion(),n.forceUpdate(),e.stopPropagation());break;case P.c.up:case P.c.down:n.suggestionsControl.current&&n.suggestionsControl.current.handleKeyDown(a)&&(e.preventDefault(),e.stopPropagation()),n.updateActiveDescendant();break;default:n.updateActiveDescendant()}}},n.SuggestionsControlOfProperType=n.SuggestionsControlOfAppropriateType,n}return za(t,e),t.prototype.updateActiveDescendant=function(){var e,t,n;if(this.props.inputElement&&this.suggestionsControl.current){var o=null!==(t=null===(e=this.suggestionsControl.current.selectedElement)||void 0===e?void 0:e.getAttribute("id"))&&void 0!==t?t:"";o!==(null!==(n=this.props.inputElement.getAttribute("aria-activedescendant"))&&void 0!==n?n:"")&&this.props.inputElement.setAttribute("aria-activedescendant",o)}},t}(Ra),Wa=(0,G.J9)((function(e){var t={root:[(0,Tr.GD)(),{cursor:"pointer",flex:"0 1 auto"}],overflowLabelWrapperInner:[(0,Tr.gS)(),{height:aa,justifyContent:"space-between"}],overflowLabel:[(0,Tr.$Z)(),{borderWidth:"1px",borderRadius:ia.Z6,borderStyle:"solid",flex:"0 1 auto",padding:"0px",overflow:"hidden",width:"26px"},(0,ra.lX)({backgroundColor:"inherit !important",borderColor:"inherit !important",color:"inherit !important"})],overflowLabelInner:[(0,Tr.gS)(),{height:sa}],overflowText:[(0,Tr.$Z)(),Tr.$u,{background:"transparent",border:"none",color:"inherit",cursor:"text",flex:"0 1 auto",lineHeight:"20px",margin:"0",padding:"1px 4px 3px",fontSize:"12px",textAlign:"center"}]};return(0,K.pB)(void 0,t,e)})),Ka=(0,G.J9)((function(e){return{root:(0,K.Zq)("overflowLabelWrapper",e.root),overflowLabelWrapperInner:(0,K.Zq)("overflowLabelWrapperInner",e.overflowLabelWrapperInner),overflowLabel:(0,K.Zq)("overflowLabel",e.overflowLabel),overflowLabelInner:(0,K.Zq)("overflowLabelInner",e.overflowLabelInner),overflowText:(0,K.Zq)("overflowText",e.overflowText)}})),Ga=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qa=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.labelWrapper=c.createRef(),o.onFocusLabel=function(){return o.setState({isLabelFocused:!0})},o.onBlurLabel=function(){return o.setState({isLabelFocused:!1})},o.onMouseLeaveLabel=function(){return o.setState({isMouseOverLabel:!1})},o.onMouseEnterLabel=function(){return o.setState({isMouseOverLabel:!0})},o.state={isLabelFocused:!1,isMouseOverLabel:!1},o}return Ga(t,e),t.prototype.name=function(){return"OverflowLabel"},t.prototype.renderComponent=function(){var e,t=this.props.item,n=null!==(e=t.name)&&void 0!==e?e:"",o={background:t.labelFormatting.BackgroundColor,color:t.labelFormatting.TextColor,borderColor:this.state.isMouseOverLabel||this.state.isLabelFocused?t.labelFormatting.HoverBorderColor:"transparent"},i=this.getClassNames(),r=c.createElement("div",{className:i.overflowLabel,style:o,onBlur:this.onBlurLabel,onFocus:this.onFocusLabel},c.createElement("div",{className:i.overflowLabelInner},this.renderLabelText(n,i)));return c.createElement("div",{className:i.root,onMouseEnter:this.onMouseEnterLabel,onMouseLeave:this.onMouseLeaveLabel,ref:this.labelWrapper},c.createElement("div",{className:i.overflowLabelWrapperInner},r))},t.prototype.renderLabelText=function(e,t){return c.createElement("button",{className:t.overflowText,"aria-label":this.props.labelTooltip,title:this.props.labelTooltip},e)},t.prototype.getClassNames=function(){return Ka(Wa(this.props.styles))},t}(d.$),Va=n(46136),Za="4px 3px 2px",Ya="30px",Xa="44px",$a=(0,G.J9)((function(e,t){return(0,K.pB)(e,Ja,t)})),Ja=function(e){var t=e.isActive,n=e.isReadOnly;return{root:[(0,Tr.GD)()],labelPicker:[Tr.nK,{cursor:"pointer",":hover":Tr.wA},t?Tr.oO:{backgroundColor:"transparent",borderColor:"transparent"},n&&{cursor:"default"}],labelPickerInner:[(0,Tr.gS)("row","wrap"),{minHeight:Ya,padding:"0px 1px","> .editableLabelWrapper":{margin:Za},"> .overflowLabelWrapper":{margin:Za}}],searchBoxWrapper:[(0,Tr.GD)(),(0,Tr.gS)(),{background:"transparent",height:Ya,margin:"0px -1px",minWidth:"150px","> input":[Tr.Oj,Tr.Ib,{background:"transparent",border:"none",height:"24px",outline:"none",padding:"4px 4px 2px"}]},!t&&{opacity:0,height:"0px",margin:"-3px 0px"}],addLabel:[Tr.Ib,{lineHeight:Ya,padding:"0px 8px"}],labelPickerSuggestions:{minWidth:"auto !important",maxHeight:"297px",overflowY:"auto",width:"200px",lineHeight:"normal",".ms-Suggestions-container":{paddingBottom:"8px",paddingTop:"8px",":empty":{padding:0}},".ms-Suggestions-item":{padding:"5px"},".ms-Suggestions-item.is-suggested":[Tr.zK,(0,ra.zI)({backgroundColor:Va.Px}),{outline:"auto"}]},labelSuggestionsFooter:{fontSize:K.s.medium,height:Xa,lineHeight:Xa,padding:"0px 11px"},subComponentStyles:{editableLabel:{},overflowLabel:{}}}},Qa=(0,G.J9)((function(e){return{root:(0,K.Zq)("labelPickerWrapper",e.root),labelPicker:(0,K.Zq)("labelPicker",e.labelPicker),labelPickerInner:(0,K.Zq)("labelPickerInner",e.labelPickerInner),searchBoxWrapper:(0,K.Zq)("searchBoxWrapper",e.searchBoxWrapper),addLabel:(0,K.Zq)("addLabel",e.addLabel),labelPickerSuggestions:(0,K.Zq)("labelPickerSuggestions",e.labelPickerSuggestions),labelSuggestionsFooter:(0,K.Zq)("labelSuggestionsFooter",e.labelSuggestionsFooter)}})),es=n(88458),ts=n.n(es),ns=n(20781),os=function(){function e(){}return e.compareStringForDisplay=function(e,t){return null==e&&null==t?0:null==e?-1:null==t?1:e.localeCompare(t)},e.compareNumbers=function(e,t){return e-t},e}(),is=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rs=function(){return rs=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},rs.apply(this,arguments)},as=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o},ss=function(e){function t(n,o){var i,r=e.call(this,n,o)||this;return r.searchBoxRef=c.createRef(),r.pickerRef=c.createRef(),r.shouldShowSuggestionsFooter=function(){var e;return 0===(null===(e=r.pickerRef.current)||void 0===e?void 0:e.suggestions.length)},r.onBlur=function(e){var t,n=e.relatedTarget||document.activeElement;r.labelPickerWrapper&&(0,Si.s)(r.labelPickerWrapper,n)||((null===(t=r.pickerRef.current)||void 0===t?void 0:t.isSuggestionsShown)&&r.pickerRef.current.hidePicker(),r.setState({isFocused:!1,isSuggestionsShown:!1,editingLabelId:null}))},r.onFocus=function(){r.setState({isFocused:!0})},r.onSearchChange=function(e){var t,n=e.currentTarget.value;n!==r.state.searchValue&&(null===(t=r.pickerRef.current)||void 0===t||t.onQueryStringChanged(n)),r.setState({searchValue:n})},r.onSearchFocus=function(){if(null!=r.pickerRef.current){var e=r.pickerRef.current;e.isSuggestionsShown||(e.showPicker(),e.onQueryStringChanged(r.state.searchValue+" "))}},r.onChange=function(e){var t,n,o;if(null==r.state.editingLabelId){null===(t=r.pickerRef.current)||void 0===t||t.hidePicker(),null===(n=r.pickerRef.current)||void 0===n||n.onQueryStringChanged("");var i=as(r.props.appliedLabels,[e.index]);r.props.onChangeSelection(i),null===(o=r.searchBoxRef.current)||void 0===o||o.focus(),r.setState({searchValue:""},(function(){var e,t;null===(e=r.pickerRef.current)||void 0===e||e.showPicker(),null===(t=r.pickerRef.current)||void 0===t||t.onQueryStringChanged(" ")}))}},r.onChangeLabelName=function(e,t){var n=r.props.labels.sort(ns.H.compareLabelsByIndex).map((function(e){return e.name}));if(n[e]=""===t?null:t,r.props.onChangeLabelName(n),null!=r.pickerRef.current){var o=r.pickerRef.current,i=o.isSuggestionsShown;o.onQueryStringChanged(""),i&&o.showPicker()}},r.shouldSelectFirstItem=function(){!st()(r.state.searchValue)||r.props.forceEditorToOpen},r.onRemoveLabel=function(e){var t,n=r.props.appliedLabels.filter((function(t){return t!==e}));r.props.onChangeSelection(n),null===(t=r.pickerRef.current)||void 0===t||t.onQueryStringChanged("")},r.getLabelTextWidth=function(e){if(e){var t=r.props.isCollapsed?"":e.name||e.placeholderText;if(r.props.overflowProps&&r.props.overflowProps.canvasContext)return r.props.overflowProps.canvasContext.measureText(t).width}return 0},r.generateOverflowLabelTooltip=function(e){var t="";e.forEach((function(e){var n=e.name||e.placeholderText;t+=n+", "})),t=t.slice(0,t.length-2),r.overflowLabelTooltip=t},r.onLabelPickerClick=function(){var e;null===(e=r.searchBoxRef.current)||void 0===e||e.focus()},r.onRenderItem=function(e){var n=e.item.id===t.overflowLabelId,o=r.props.editableLabelStrings,i=r.getStyles();return n?c.createElement(qa,rs({},e,{labelTooltip:r.overflowLabelTooltip,styles:i.subComponentStyles.overflowLabel})):c.createElement(ha,rs({},e,{editableLabelStrings:o,labelEditorStrings:r.props.labelEditorStrings,showEditButton:!1,onChangeText:r.onChangeLabelName,onCloseEditor:r.onCloseEditor,onOpenEditor:r.onOpenEditor,onRemoveLabel:r.onRemoveLabel,isCollapsed:!!r.props.isCollapsed,isReadOnly:!!r.props.isReadOnly,isEditing:null!=r.state.editingLabelId&&r.state.editingLabelId===e.item.id,styles:i.subComponentStyles.editableLabel,labelEditorStyles:r.props.labelEditorStyles,icons:r.props.editableLabelIcons}))},r.onRenderSuggestionsItem=function(e){var t=r.getStyles();return c.createElement(ha,{editableLabelStrings:r.props.editableLabelStrings,item:e,index:0,labelEditorStrings:r.props.labelEditorStrings,showEditButton:!0,onChangeText:r.onChangeLabelName,onCloseEditor:r.onCloseSuggestionEditor,onOpenEditor:r.onOpenEditor,isEditing:null!=r.state.editingLabelId&&r.state.editingLabelId===e.id,styles:t.subComponentStyles.editableLabel,labelEditorStyles:r.props.labelEditorStyles,icons:r.props.editableLabelIcons})},r.onOpenEditor=function(e){var t;return r.setState({editingLabelId:null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:null})},r.onFloatingPickerKeyDown=function(e,t){var n=(0,So.jI)();(!n&&e.which===P.c.right||n&&e.which===P.c.left)&&(r.onOpenEditor(t),e.preventDefault(),e.stopPropagation())},r.onSuggestionsShown=function(){return r.setState({isSuggestionsShown:!0})},r.onCloseEditor=function(){return r.setState({editingLabelId:null})},r.onSuggestionsHidden=function(){return r.setState({isSuggestionsShown:!1})},r.onCloseSuggestionEditor=function(){r.onCloseEditor(),r.async.setTimeout((function(){var e;null===(e=r.searchBoxRef.current)||void 0===e||e.focus()}),0)},r.onResolveSuggestions=function(e,t){var n=r.props.labels.sort(ns.H.compareLabelsByIndex).map((function(e){return rs(rs({},e),{name:ns.H.getLabelPlaceholder(e)})}));n=ns.H.sortLabelsByUsageAndIndex(n);var o=e.trim().toLocaleLowerCase();return n.filter((function(e){return t&&void 0!==tt()(t,(function(t){return t.index===e.index}))?null:""===o||e.name&&e.name.toLocaleLowerCase().indexOf(o)>-1?e:null}))},r.isActive=function(){var e=r.state,t=e.editingLabelId,n=e.isFocused,o=e.isSuggestionsShown,i=r.props,a=i.isReadOnly,s=i.forceEditorToOpen;return(null!=t||n||o||!!s)&&!a},r.getStyleProps=(0,G.J9)((function(e,t){return{isActive:e,isReadOnly:t}})),r.state={isFocused:!1,isSuggestionsShown:!1,searchValue:null!==(i=n.searchValue)&&void 0!==i?i:"",editingLabelId:null},r.suggestionsStore=new $r,r}return is(t,e),t.prototype.name=function(){return"LabelPicker"},t.prototype.componentDidUpdate=function(e){var t,n=this;if(this.state.isFocused&&!document.activeElement&&(null===(t=this.searchBoxRef.current)||void 0===t||t.focus()),ts()(e.appliedLabels,this.props.appliedLabels).length>0||ts()(e.labels,this.props.labels).length>0){var o=this.props.labels.filter((function(e){return!n.props.appliedLabels.includes(e.index)})).sort(ns.H.compareLabelsByIndex);this.suggestionsStore.updateSuggestions(o)}},t.prototype.componentDidMount=function(){var e,t=this;if(this.props.forceEditorToOpen){var n=this.props.labels.filter((function(e){return!t.props.appliedLabels.includes(e.index)})).sort(ns.H.compareLabelsByIndex);this.onFocus(),null===(e=this.searchBoxRef.current)||void 0===e||e.focus(),this.onSearchFocus(),this.suggestionsStore.updateSuggestions(n)}},t.prototype.renderComponent=function(){var e=this.state.isSuggestionsShown,t=this.props,n=t.labelPickerStrings,o=t.noFlexWrap,i=t.hideSearchBox,r=t.isReadOnly,a=this.isActive(),s=i||r,l=this.getClassNames(),d=this.props.labels.sort(ns.H.compareLabelsByIndex),u=this.props.appliedLabels.sort(os.compareNumbers).map((function(e){return d[e]})),p=d.length===u.length,h={className:l.labelPickerSuggestions,footerItemsProps:[{renderItem:function(){return c.createElement("div",{className:l.labelSuggestionsFooter},p?n.allLabelsAdded:n.noResultsFound)},shouldShow:this.shouldShowSuggestionsFooter}],shouldSelectFirstItem:this.shouldSelectFirstItem},m=o?"nowrap":"wrap";return c.createElement("div",{className:l.root,ref:this.resolveRef(this,"labelPickerWrapper"),onBlurCapture:this.onBlur,onFocusCapture:this.onFocus},c.createElement(Do.R,{className:l.labelPicker,shouldResetActiveElementWhenTabFromZone:!0},c.createElement("div",{className:l.labelPickerInner,onClick:this.onLabelPickerClick,style:{flexWrap:m,backgroundColor:this.props.backgroundColor}},this.renderItems(u,a),!s&&c.createElement("div",{className:l.searchBoxWrapper},c.createElement("input",{ref:this.searchBoxRef,placeholder:a?n.searchForLabel:void 0,"aria-controls":e?"suggestion-list":void 0,"aria-expanded":e,"aria-haspopup":"true","aria-label":n.searchForLabelAriaLabel,role:"combobox",value:this.state.searchValue,onChange:this.onSearchChange,onClick:this.onSearchFocus,onFocus:this.onSearchFocus})),!s&&c.createElement(Ua,{componentRef:this.pickerRef,inputElement:this.searchBoxRef.current,selectedItems:u,suggestionsStore:this.suggestionsStore,getTextFromItem:ns.H.getLabelPlaceholder,onChange:this.onChange,onResolveSuggestions:this.onResolveSuggestions,onRenderSuggestionsItem:this.onRenderSuggestionsItem,onSuggestionsHidden:this.onSuggestionsHidden,onSuggestionsShown:this.onSuggestionsShown,pickerSuggestionsProps:h,onKeyDown:this.onFloatingPickerKeyDown}))))},t.prototype.renderItems=function(e,t){var n=this;if(0===e.length&&!t){var o=this.getClassNames();return c.createElement("div",{className:o.addLabel},this.props.labelPickerStrings.addLabel)}this.props.overflowProps&&(e=this.handleOverflow(e));var i=e.map((function(e){return n.onRenderItem({key:e.index,index:e.index,item:e})}));return c.createElement(c.Fragment,null,i)},t.prototype.handleOverflow=function(e){var n;if(!e||!this.props.overflowProps)return[];for(var o=0,i=[],r=[],a=this.props.overflowProps.width,s=t.calculateLabelWidth(null!==(n=this.props.isCollapsed)&&void 0!==n&&n),l=0;l<e.length;l++){var c=this.getLabelTextWidth(e[l]);for(o+=(null!==c&&void 0!==c?c:0)+s,i.push(e[l]);a<o+t.calculateOverflowLabelWidth()&&i.length>0;){(p=i.pop())&&r.push(p);var d=this.getLabelTextWidth(p);o-=(null!==d&&void 0!==d?d:0)+s}}if(i.length!==e.length){var u={BackgroundColor:t.overflowLabelBackgroundColor,TextColor:t.overflowLabelTextColor,HoverBorderColor:t.overflowLabelHoverBorderColor,HoverBackgroundColor:t.overflowLabelHoverBackgroundColor},p={id:t.overflowLabelId,index:-1,name:"+"+(e.length-i.length),usageCount:-1,labelFormatting:u,placeholderText:""};i.push(p),this.generateOverflowLabelTooltip(r)}return i},t.calculateLabelWidth=function(e){return e?2*t.labelInTitleHiddenModePaddingSide+2*t.labelBorderWidth+2*t.labelMarginSide:2*t.labelPaddingSide+2*t.labelBorderWidth+2*t.labelMarginSide+2*t.labelPickerPaddingSide+t.removeButtonWidth},t.calculateOverflowLabelWidth=function(){return t.overflowLabelWidth+t.overflowBuffer+2*t.labelBorderWidth+2*t.labelMarginSide},t.prototype.getStyles=function(){var e=this.props,t=e.isReadOnly,n=e.styles,o=this.getStyleProps(this.isActive(),null!==t&&void 0!==t&&t);return $a(o,n)},t.prototype.getClassNames=function(){return Qa(this.getStyles())},t.labelBorderWidth=1,t.labelMarginSide=3,t.labelPaddingSide=8,t.removeButtonWidth=24.5,t.labelInTitleHiddenModePaddingSide=4,t.labelPickerPaddingSide=1,t.overflowLabelId="overflowLabelId",t.overflowLabelWidth=26,t.overflowBuffer=2,t.overflowLabelBackgroundColor="#edebe9",t.overflowLabelTextColor="#000000",t.overflowLabelHoverBorderColor="#edebe9",t.overflowLabelHoverBackgroundColor="#edebe9",t}(d.$),ls=n(42463),cs=n(67048),ds=function(e){return c.createElement(z.P,(0,k.__assign)({},e),c.createElement(cs.Y,(0,k.__assign)({disabled:e.hidden},e.focusTrapProps),e.children))},us=n(94299),ps=(0,Sn.Z)(),hs="Toggle",ms=c.forwardRef((function(e,t){var n=e.as,o=void 0===n?"div":n,i=e.ariaLabel,r=e.checked,a=e.className,s=e.defaultChecked,l=void 0!==s&&s,d=e.disabled,u=e.inlineLabel,p=e.label,h=e.offAriaLabel,m=e.offText,f=e.onAriaLabel,v=e.onChange,b=e.onChanged,y=e.onClick,C=e.onText,S=e.role,D=e.styles,x=e.theme,T=(0,In.k)(r,l,c.useCallback((function(e,t){null===v||void 0===v||v(e,t),null===b||void 0===b||b(t)}),[v,b])),E=T[0],w=T[1],_=ps(D,{theme:x,className:a,disabled:d,checked:E,inlineLabel:u,onOffMissing:!C&&!m}),I=E?f:h,P=(0,wn.B)(hs,e.id),A="".concat(P,"-label"),R="".concat(P,"-stateText"),L=E?C:m,N=(0,F.G1)(e,F.QQ,["defaultChecked"]),M=void 0;i||I||(p&&(M=A),L&&!M&&(M=R));var O=c.useRef(null);(0,Ci.vk)(O),gs(e,E,O);var B={root:{className:_.root,hidden:N.hidden},label:{children:p,className:_.label,htmlFor:P,id:A},container:{className:_.container},pill:(0,k.__assign)((0,k.__assign)({},N),{"aria-disabled":d,"aria-checked":E,"aria-label":i||I,"aria-labelledby":M,className:_.pill,"data-is-focusable":!0,"data-ktp-target":!0,disabled:d,id:P,onClick:function(e){d||(w(!E,e),y&&y(e))},ref:O,role:S||"switch",type:"button"}),thumb:{className:_.thumb},stateText:{children:L,className:_.text,htmlFor:P,id:R}};return c.createElement(o,(0,k.__assign)({ref:t},B.root),p&&c.createElement(g.J,(0,k.__assign)({},B.label)),c.createElement("div",(0,k.__assign)({},B.container),c.createElement("button",(0,k.__assign)({},B.pill),c.createElement("span",(0,k.__assign)({},B.thumb))),(E&&C||m)&&c.createElement(g.J,(0,k.__assign)({},B.stateText))))}));ms.displayName=hs+"Base";var gs=function(e,t,n){c.useImperativeHandle(e.componentRef,(function(){return{get checked(){return!!t},focus:function(){n.current&&n.current.focus()}}}),[t,n])},fs=(0,Cn.I)(ms,(function(e){var t,n,o,i,r,a,s,l=e.theme,c=e.className,d=e.disabled,u=e.checked,p=e.inlineLabel,h=e.onOffMissing,m=l.semanticColors,g=l.palette,f=m.bodyBackground,v=m.inputBackgroundChecked,b=m.inputBackgroundCheckedHovered,y=g.neutralDark,C=m.disabledBodySubtext,S=m.smallInputBorder,D=m.inputForegroundChecked,x=m.disabledBodySubtext,T=m.disabledBackground,E=m.smallInputBorder,w=m.inputBorderHovered,_=m.disabledBodySubtext,I=m.disabledText;return{root:["ms-Toggle",u&&"is-checked",!d&&"is-enabled",d&&"is-disabled",l.fonts.medium,{marginBottom:"8px"},p&&{display:"flex",alignItems:"center"},c],label:["ms-Toggle-label",{display:"inline-block"},d&&{color:I,selectors:(t={},t[K.up]={color:"GrayText"},t)},p&&!h&&{marginRight:16},h&&p&&{order:1,marginLeft:16},p&&{wordBreak:"break-word"}],container:["ms-Toggle-innerContainer",{display:"flex",position:"relative"}],pill:["ms-Toggle-background",(0,K.gm)(l,{inset:-3}),{fontSize:"20px",boxSizing:"border-box",width:40,height:20,borderRadius:10,transition:"all 0.1s ease",border:"1px solid ".concat(E),background:f,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 3px",overflow:"visible"},!d&&[!u&&{selectors:{":hover":[{borderColor:w}],":hover .ms-Toggle-thumb":[{backgroundColor:y,selectors:(n={},n[K.up]={borderColor:"Highlight"},n)}]}},u&&[{background:v,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(o={":hover":[{backgroundColor:b,borderColor:"transparent",selectors:(i={},i[K.up]={backgroundColor:"Highlight"},i)}]},o[K.up]=(0,k.__assign)({backgroundColor:"Highlight"},(0,K.Qg)()),o)}]],d&&[{cursor:"default"},!u&&[{borderColor:_}],u&&[{backgroundColor:C,borderColor:"transparent",justifyContent:"flex-end"}]],!d&&{selectors:{"&:hover":{selectors:(r={},r[K.up]={borderColor:"Highlight"},r)}}}],thumb:["ms-Toggle-thumb",{display:"block",width:12,height:12,borderRadius:"50%",transition:"all 0.1s ease",backgroundColor:S,borderColor:"transparent",borderWidth:6,borderStyle:"solid",boxSizing:"border-box"},!d&&u&&[{backgroundColor:D,selectors:(a={},a[K.up]={backgroundColor:"Window",borderColor:"Window"},a)}],d&&[!u&&[{backgroundColor:x}],u&&[{backgroundColor:T}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none",fontWeight:K.BO.regular}}},d&&{selectors:{"&&":{color:I,selectors:(s={},s[K.up]={color:"GrayText"},s)}}}]}}),void 0,{scope:"Toggle"}),vs=n(22317),bs=n(45078);const ys=(0,G.J9)((e=>{const t={root:{marginTop:"32px",":first-child":{marginTop:"0px"}},expandSectionButton:[{fontSize:K.s.medium,fontWeight:K.BO.semibold,background:"transparent",border:"none",cursor:"pointer",paddingLeft:"0px",paddingTop:"0px","> i":[we.JB,{marginRight:"8px",verticalAlign:"middle"}],":hover":[(0,_e.hw)(),_e.tU]},_e.M8]};return(0,K.pB)(void 0,t,e)})),Cs=(0,G.J9)((e=>({root:(0,K.Zq)("collapsibleSection",e.root),expandSectionButton:(0,K.Zq)("expandSectionButton",e.expandSectionButton)}))),Ss=e=>{const t=Cs(ys(e.styles)),[n,o]=c.useState(!0),i=e.collapsibleSectionHideAriaLabel,r=e.collapsibleSectionShowAriaLabel,a=(0,dt.G)(n?i:r,e.label);return c.createElement("div",{className:t.root},c.createElement("button",{className:t.expandSectionButton,onClick:()=>{o(!n)},"aria-label":a},c.createElement(C.I,{iconName:n?"ChevronDown":"ChevronUp"}),e.label),n&&e.children)};var ks=n(34525),Ds=n(94778),xs=n(3176);const Ts="16px",Es=(0,G.J9)((e=>{const t={root:{margin:"".concat(Ts," 0px")},emptyAttachmentsSection:{marginBottom:Ts,fontSize:K.s.medium,fontWeight:K.BO.semibold},hiddenFileInput:{display:"none"},addAttachmentButtonWrapper:we.$u,subComponentStyles:{list:{root:{"> ul":[(0,we.GD)(),{padding:"0px","> li":{height:"48px",marginBottom:"8px"}}]}},collapsibleSection:{root:{marginBottom:Ts}},addAttachmentButton:{root:[we.$u,{height:"35px",pointerEvents:"auto"}],rootDisabled:{cursor:"default",opacity:"0.5"},rootHovered:[_e.lZ,(0,_e.hw)()],rootFocused:[_e.lZ,{"::after":{border:"none",backgroundColor:"transparent"}}]}}};return(0,K.pB)(void 0,t,e)})),ws=(0,G.J9)((e=>({root:(0,K.Zq)("taskAttachments",e.root),emptyAttachmentsSection:(0,K.Zq)("emptyAttachmentsSection",e.emptyAttachmentsSection),hiddenFileInput:(0,K.Zq)("hiddenFileInput",e.hiddenFileInput),addAttachmentButtonWrapper:(0,K.Zq)("addAttachmentButtonWrapper",e.addAttachmentButtonWrapper)})));var _s=n(40840),Is=n.n(_s);class Ps extends d.${name(){return"TaskDetailsAttachment"}renderComponent(){const e=this.getClassNames(),t=this.getStyles(),{taskAttachmentSectionStrings:n,renderCollapsibleAttachments:o}=this.props,i=0===this.props.taskAttachmentRowItems.length?c.createElement("div",{className:e.emptyAttachmentsSection},n.taskAttachmentsLabel):o?c.createElement(Ss,{label:n.taskAttachmentsLabel,collapsibleSectionHideAriaLabel:n.collapsibleSectionHideAriaLabel,collapsibleSectionShowAriaLabel:n.collapsibleSectionShowAriaLabel,styles:t.subComponentStyles.collapsibleSection},this.renderTaskAttachments()):c.createElement("div",null,c.createElement(g.J,{styles:t.subComponentStyles.attachmentLabel},n.taskAttachmentsLabel)," ",this.renderTaskAttachments());return c.createElement("div",{className:e.root},c.createElement("input",{className:e.hiddenFileInput,type:"file",onChange:this.uploadFile,ref:this.resolveRef(this,"fileInputElement")}),i,this.renderAddAttachmentsButton(),this.renderAddAttachmentContextMenuToOpen())}renderAddAttachmentsButton(){const{taskAttachmentSectionStrings:e,config:t,maximumAttachmentsPerTask:n,taskAttachmentRowItems:o}=this.props;if(t.addAttachmentButtonOption===Vr.Hidden)return null;const i=this.getClassNames(),r=this.getStyles(),a=(0,We.Xc)(r.subComponentStyles.addAttachmentButton),s=o.length>=n,l=s||t.addAttachmentButtonOption===Vr.Disabled,d=t.addAttachmentButtonOption===Vr.Disabled?e.noEditPermissionHoverText:s?e.maximumTaskAttachmentsAddedHoverText:"";return c.createElement("div",{className:i.addAttachmentButtonWrapper,ref:this.resolveRef(this,"addAttachmentContextMenuTarget")},c.createElement(y.Y,{styles:a,disabled:l,onClick:this.toggleAddAttachmentDropdown,title:d,"aria-label":e.addTaskAttachmentButtonText,componentRef:e=>this._addAttachmentButton=e},e.addTaskAttachmentButtonText))}renderAddAttachmentContextMenuToOpen(){const e=this.getStyles();if(this.state.isAddAttachmentContextMenuOpen){const t=[],{config:n}=this.props,o=n.fileUploadOption===Vr.Disabled;n.fileUploadOption!==Vr.Hidden&&t.push({key:"File",name:this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionTextFileUpload,onClick:this.openFilePicker,disabled:o,title:o?this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionFileUploadDisabledTooltip:"",ariaLabel:o?this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionFileUploadDisabledTooltip:""});const i=n.sharepointOption===Vr.Disabled;return n.sharepointOption!==Vr.Hidden&&t.push({key:"Sharepoint",name:this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionTextSharePoint,onClick:this.props.callbacks.onOpenOneDrivePicker,disabled:i,title:i?this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionSharePointDisabledTooltip:"",ariaLabel:i?this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionSharePointDisabledTooltip:""}),t.push({key:"Link",name:this.props.taskAttachmentSectionStrings.addTaskAttachmentMenuOptionTextLink,onClick:()=>this.openAddLinkDialog(this._addAttachmentButton)}),c.createElement(Yr.l,{shouldFocusOnMount:!0,target:this.addAttachmentContextMenuTarget,onDismiss:this.closeAddAttachmentDropdown,directionalHint:U.A.bottomLeftEdge,items:t,styles:e.subComponentStyles.contextualMenu,appTheme:this.props.theme})}return null}renderTaskAttachments(){const e=this.getStyles(),{callbacks:t,config:n,taskAttachmentRowItems:o,taskAttachmentSectionStrings:i,taskAttachmentToEdit:r,taskAttachmentRowIcons:a,documentPreviewIcons:s}=this.props;if(0===o.length)return null;const l=this.getAttachmentsSortedByAlias();let d=-1,u=!1;if(null!=r){const e=r.url;u=!0,d=ot()(l,(t=>t.url===e))}const p={onDeleteTaskAttachment:t.onDeleteTaskAttachment,onEditTaskAttachment:t.onOpenTaskAttachmentEditorDialog,onSelectDeselectShowOnCard:t.onSelectDeselectShowOnCard,onOpenLink:t.onOpenLink,onCopyLink:t.onOpenLink},h={hideOpenInNewWindow:n.hideOpenInNewWindow,hideShowOnCardButton:n.hideShowOnCardButton,disableEdit:n.disableEditAttachment,disableRemove:n.disableRemoveAttachment,disableCopyLink:n.disableCopyLink,disableActionButton:n.disableActionButton,hideMoreButton:n.hideMoreButton};return c.createElement(ks.h,{altFocusableElement:this._addAttachmentButton,taskAttachmentRowItems:l,isTaskAttachmentBeingEdited:u,taskAttachmentToEditIndex:d,callbacks:p,rowConfig:h,taskAttachmentRowStrings:i.taskAttachmentRowStrings,styles:e.subComponentStyles.list,taskAttachmentRowIcons:a,documentPreviewIcons:s,theme:this.props.theme})}getAttachmentsSortedByAlias(){const{taskAttachmentRowItems:e}=this.props,t=[];return Is()(e,((e,n)=>{t.push(e)})),t.sort(((e,t)=>xs.m.aliasCompare(e,t))),t}getClassNames(){return ws(this.getStyles())}getStyles(){const{styles:e}=this.props;return Es(e)}constructor(e,t){super(e,t),this.toggleAddAttachmentDropdown=e=>{this.setState((e=>({isAddAttachmentContextMenuOpen:!e.isAddAttachmentContextMenuOpen})))},this.closeAddAttachmentDropdown=()=>{this.setState((e=>({isAddAttachmentContextMenuOpen:!1})))},this.uploadFile=e=>{const{taskAttachmentSectionStrings:t,callbacks:n,maximumSizeForTaskAttachment:o}=this.props;null!=this._addAttachmentButton&&this._addAttachmentButton.focus(),this.setState((e=>({isAddAttachmentContextMenuOpen:!1})));const i=e.target;if(i.files&&i.files.length>0){const e=i.files[0];if(!e)return;if(0===e.size)return void n.onSelectEmptyFile(e.name.substring(0,Ds.R.AliasMaxLength));if(e.size>o)return void n.onOpenErrorDialog(t.fileTooBigErrorMessage);n.onUploadFileAsTaskAttachment(e)}i.value=null},this.openAddLinkDialog=e=>{this.props.callbacks.onOpenAddLinkDialog(e)},this.openFilePicker=()=>{this.fileInputElement.click(),this.fileInputElement.focus(),document.body.onfocus=()=>this.onCloseFilePicker()},this.onCloseFilePicker=()=>{document.body.onfocus=null,null!=this._addAttachmentButton&&this._addAttachmentButton.focus(),this.setState((e=>({isAddAttachmentContextMenuOpen:!1})))},this.state={isAddAttachmentContextMenuOpen:!1}}}var As=n(86634),Rs=n(4548);const Ls=(0,G.J9)(((e,t)=>{const n={subComponentStyles:{contextualMenu:(0,As.Zo)(e),attachmentLabel:Ns(e),list:Os(e),addAttachmentButton:(0,we.cK)(e)}};return(0,K.TW)(n,t)})),Ns=(0,G.J9)((e=>({root:(0,we.Ml)(e)}))),Ms=(0,G.J9)((e=>{const t=t=>{const n=t.checked&&!t.disabled,o={"> .ms-Checkbox-label":[n&&{"> .ms-Checkbox-checkbox":[e===m.Sx.TeamsContrast&&{borderColor:Te.z.Black,backgroundColor:Te.z.TeamsContrastHyperlinkColor,"> .ms-Checkbox-checkmark":{color:Te.z.Black}},e===m.Sx.SharePoint&&{backgroundColor:Te.z.SharepointCheckboxCheckedColor()}]},e===m.Sx.SharePoint&&{"> .ms-Checkbox-text":{color:t.disabled?Te.z.SharepointPlaceholderFontColor():Te.z.SharepointNeutralTextFontColor()}}]};return{checkbox:[e===m.Sx.SharePoint&&[n&&{backgroundColor:Te.z.SharepointCheckboxCheckedColor()}]],root:[o,{":hover, :active, :focus":o}],checkmark:[e===m.Sx.TeamsContrast&&{color:Te.z.White}]}},n=(0,Rs.z)(e);return e=>(0,K.pB)(e,n,t)})),Os=(0,G.J9)((e=>({subComponentStyles:{row:{content:[e===m.Sx.TeamsContrast&&{color:Te.z.White}],leftContent:[(()=>{switch(e){case m.Sx.TeamsDark:case m.Sx.Dark:case m.Sx.LoopDark:return{border:"none"};case m.Sx.TeamsContrast:return{":hover":{borderColor:Te.z.TeamsContrastHyperlinkColor}};case m.Sx.SharePoint:return{backgroundColor:Te.z.SharepointBackgroundColor(),border:"none",boxShadow:"none",":hover":{backgroundColor:Te.z.SharepointAddTaskButtonBackgroundColor()}};default:return{}}})(),(0,_e.kE)()],attachmentChicklet:(()=>{switch(e){case m.Sx.TeamsContrast:return{borderColor:Te.z.White,backgroundColor:Te.z.Black,":hover":{backgroundColor:Te.z.TeamsContrastHyperlinkColor,borderColor:Te.z.TeamsContrastHyperlinkColor,color:Te.z.Black}};case m.Sx.Dark:case m.Sx.TeamsDark:return{backgroundColor:zn.kd.gray150,":hover":{backgroundColor:zn.kd.gray140}};case m.Sx.LoopDark:return{backgroundColor:Te.z.NeutralDarkGrey24,":hover":{backgroundColor:Te.z.NeutralDarkGrey12}};default:return{}}})(),previewListImage:[e===m.Sx.SharePoint&&{backgroundColor:Te.z.SharepointAddTaskButtonBackgroundColor()}],fallbackPreviewIcon:[e===m.Sx.TeamsContrast&&{color:"inherit"}],itemListTitleText:(()=>{switch(e){case m.Sx.TeamsContrast:case m.Sx.SharePoint:return{color:"inherit"};case m.Sx.Dark:case m.Sx.TeamsDark:case m.Sx.LoopDark:return{color:Te.z.White};default:return{}}})(),itemListUrlText:(()=>{switch(e){case m.Sx.TeamsContrast:case m.Sx.SharePoint:return{color:"inherit"};case m.Sx.Dark:case m.Sx.TeamsDark:return{color:zn.kd.gray60};case m.Sx.LoopDark:return{color:Te.z.NeutralDarkGrey84};default:return{}}})(),subComponentStyles:{showOnCard:Ms(e),contextualMenu:(0,As.Zo)(e)}}}})));var Bs=n(55228);const Fs=e=>{const t={moreOptionsAriaLabel:ht.p.Strings.AttachmentsSection_MoreOptionsAriaLabel,showOnCardAriaLabel:e=>dt.G(ht.p.Strings.AttachmentsSection_ShowOnCardAriaLabel,e),showOnCardLabel:ht.p.Strings.AttachmentsSection_ShowOnCardLabel,openInNewWindowMenuOption:ht.p.Strings.AttachmentsSection_OpenInNewWindowMenuOption,editMenuOption:ht.p.Strings.AttachmentsSection_EditOption,removeMenuOption:ht.p.Strings.AttachmentsSection_RemoveOption,invalidLinkError:ht.p.Strings.AttachmentsSection_InvalidLinkError,copyLinkOption:"",actionButtonLabel:""},n={taskAttachmentsLabel:ht.p.Strings.AttachmentsSection_AttachmentsLabel,fileTooBigErrorMessage:dt.G(ht.p.Strings.AttachmentsSection_FileTooBigErrorMessage,bs.S$.MaxUploadFileSize/1e6),maximumTaskAttachmentsAddedHoverText:ht.p.Strings.AttachmentsSection_MaximumAttachmentsAdded,noEditPermissionHoverText:ht.p.Strings.AttachmentsSection_NoEditPermissions,addTaskAttachmentButtonText:ht.p.Strings.AttachmentsSection_AddAttachmentButtonText,addTaskAttachmentMenuOptionTextFileUpload:ht.p.Strings.AttachmentsSection_BrowseComputerMenuOption,addTaskAttachmentMenuOptionTextSharePoint:ht.p.Strings.AttachmentsSection_BrowseTeamSharePointMenuOption,addTaskAttachmentMenuOptionTextLink:ht.p.Strings.AttachmentsSection_LinkMenuOption,addTaskAttachmentMenuOptionFileUploadDisabledTooltip:ht.p.Strings.AttachmentsSection_FileUploadDisabledTooltip,addTaskAttachmentMenuOptionSharePointDisabledTooltip:ht.p.Strings.AttachmentsSection_BrowseSharePointDisabledTooltip,taskAttachmentRowStrings:t,collapsibleSectionHideAriaLabel:"",collapsibleSectionShowAriaLabel:""},o=Ls(e.theme,e.styles),i={alert:Ne.sM,remove:Ne.pJ,edit:Ne.qz,more:Ne.XP,copy:Ne.RC};return c.createElement(Ps,{callbacks:e.attachmentSectionCallbacks,config:e.attachmentSectionConfig,taskAttachmentSectionStrings:n,taskAttachmentRowItems:e.attachmentRowItems,maximumAttachmentsPerTask:e.maximumAttachmentsPerTask,maximumSizeForTaskAttachment:bs.S$.MaxUploadFileSize,taskAttachmentToEdit:e.attachmentToEdit,renderCollapsibleAttachments:!1,styles:o,taskAttachmentRowIcons:i,documentPreviewIcons:Bs.b,theme:e.theme})};var js,Hs=n(62948),zs=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Us=function(){return Us=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Us.apply(this,arguments)},Ws=function(e){function t(t,n){return e.call(this,t,n)||this}return zs(t,e),t.prototype.itemSource=function(){return{beginDrag:function(e){return{entity:e.listItem,index:e.index}}}},t.prototype.itemCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}},t.prototype.renderComponent=function(){var e=this.props,t=e.connectDragSource,n=e.connectDragPreview,o=e.isReorderDisabled,i=e.index,r=e.errorMsg,a=e.gripperIconProps,s=c.createElement("li",Us({},this.getLiProps(),{"data-index":i}),c.createElement("div",{className:(0,I.A)("dndListItem",{reorderDisabled:o})},c.createElement(C.I,Us({iconName:"GripperDotsVertical"},a)),this.renderListItem()),r&&c.createElement("div",{className:"errorMessage"},r)),l=t&&!o?t(s):s;return n?n(l):l},t}(d.$),Ks=n(67239),Gs=n(51129),qs=n(47649),Vs=n(49560),Zs=n(75886),Ys=n(13378);!function(e){e[e.None=0]="None",e[e.ListItem=1]="ListItem",e[e.Title=2]="Title",e[e.Buttons=3]="Buttons"}(js||(js={}));class Xs extends Ws{name(){return"ChecklistItem"}getLiProps(){const{itemTypeString:e,listItem:t,isDragging:n,index:o}=this.props,{focusState:i}=this.state,r=this.getClassNames();return{className:(0,I.A)(r.root,n?"dragging":""),role:"checkbox",onFocus:this.onChecklistItemFocus,onBlur:this.onChecklistItemBlur,key:t.id,tabIndex:0,ref:this.checklistItemElement,onKeyDown:this.preventDefaultAndStopPropagation,onKeyUp:this.onKeyUp,"data-dnd-role":i===js.Title?void 0:e,"aria-checked":t.isChecked,"data-index":o,draggable:i!==js.Title}}renderListItem(){const{permissions:e,listItem:t,ariaLabel:n,plannerTheme:o}=this.props,{editedTitle:i,focusState:r}=this.state,a=(0,Zs.c)(e,Zs.j.DisableEditTitle);let s=this.getClassNames(a),l=c.createElement("span",{className:s.checklistItemTitle,onClick:a?void 0:this.startChecklistItemTitleEdit,title:a?ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:t.title},t.title);r===js.Title&&(l=c.createElement("form",{onSubmit:this.onFormSubmit,autoComplete:"off"},c.createElement(Be.A,{className:"checklistTextField",placeholder:t.title,onChange:(e,t)=>{this.checklistEditTitleChanged(t)},value:i,onBlur:this.onEditTitleBlur,autoFocus:!0,styleType:Fe.u.Text,maxLength:Ys.e.TitleMaxLength,onKeyDown:this.onEditTitleKeyDown,disabled:a,appTheme:o})));const d=r!==js.None?"forceShow":"",u=(0,Zs.c)(e,Zs.j.DisableCheckedStateToggling),p=(0,Zs.c)(e,Zs.j.DisablePromote),h=(0,Zs.c)(e,Zs.j.DisableDelete),m=h&&u&&a&&p;m!==a&&(s=this.getClassNames(m));const g=r===js.Title?0:-1;return c.createElement("div",{draggable:r!==js.Title,className:s.listItemContents},c.createElement(S.S,{title:u?ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:ht.p.Strings.Checklist_MarkCompleteCommandTitle,onChange:this.onCheckboxChange,checked:t.isChecked,inputProps:{tabIndex:-1},ariaLabel:n,disabled:u,appTheme:o}),l,(!p||!h)&&c.createElement("div",{className:"".concat(s.checklistItemCommands," ").concat(d)},!p&&c.createElement(Ks.K,{className:"checklistItem-promoteButton",iconProps:Ne.Tn,ariaLabel:ht.p.Strings.Checklist_PromoteItemCommandTitle,title:ht.p.Strings.Checklist_PromoteItemCommandTitle,tabIndex:g,onClick:this.onPromoteKeyUp,onKeyUp:this.onPromoteKeyUp,onFocus:this.onPromoteFocus,onBlur:this.onCommandButtonBlur,elementRef:this.promoteButtonRef,plannerTheme:o}),!h&&c.createElement(Ks.K,{className:"checklistItem-deleteButton",iconProps:Ne.pJ,ariaLabel:ht.p.Strings.Checklist_RemoveItemCommandTitle,title:ht.p.Strings.Checklist_RemoveItemCommandTitle,tabIndex:g,onClick:this.onDeleteKeyUp,onKeyUp:this.onDeleteKeyUp,onFocus:this.onDeleteFocus,onBlur:this.onCommandButtonBlur,elementRef:this.deleteButtonRef,plannerTheme:o})))}componentDidUpdate(e,t){this.props.setFocusOnInit&&this.checklistItemElement.current&&(this.checklistItemElement.current.focus(),this.props.clearFocusedChecklistItemId())}getClassNames(e){return(0,Gs.Zz)((0,Gs.$f)(this.props.plannerTheme,this.props.styles,e,this.props.listItem.isChecked))}constructor(e,t){super(e,t),this.checklistItemElement=c.createRef(),this.promoteButtonRef=c.createRef(),this.deleteButtonRef=c.createRef(),this.isFormSubmitted=!1,this.onCheckboxChange=e=>{this.props.onCheckboxClick(this.props.listItem.id)},this.onChecklistItemFocus=e=>{this.state.focusState===js.None&&this.setState({focusState:js.ListItem})},this.onChecklistItemBlur=e=>{this.state.focusState===js.ListItem&&this.setState({focusState:js.None})},this.onFormSubmit=e=>{e.preventDefault();const{listItem:t,onRename:n}=this.props,{editedTitle:o}=this.state;var i;(""!==o&&n(t.id,o),"submit"===e.type)&&(this.isFormSubmitted=!0,null===(i=this.checklistItemElement.current)||void 0===i||i.focus())},this.onEditTitleBlur=e=>{const{listItem:t,onRename:n}=this.props,{editedTitle:o}=this.state;""===o||this.isFormSubmitted||n(t.id,o);const i=e.relatedTarget;i===this.promoteButtonRef.current||i===this.deleteButtonRef.current?this.setState({focusState:js.Buttons}):i===this.checklistItemElement.current?this.setState({focusState:js.ListItem}):this.setState({focusState:js.None})},this.checklistEditTitleChanged=e=>{this.setState({editedTitle:e})},this.startChecklistItemTitleEdit=()=>{this.setState({focusState:js.Title,editedTitle:this.props.listItem.title})},this.onEditTitleKeyDown=e=>{Vs.a.getKey(e)===h.D.SPACE&&e.stopPropagation()},this.onKeyUp=e=>{e.preventDefault();const{permissions:t,listItem:n,onCheckboxClick:o,onDelete:i,onMove:r}=this.props,{focusState:a}=this.state,s=e.target,l=e,c=Vs.a.getKey(l);if(s.className.indexOf("Upload")>-1&&!l.shiftKey)return;const d=(0,Zs.c)(t,Zs.j.DisableDelete),u=(0,Zs.c)(t,Zs.j.DisableCheckedStateToggling),p=(0,Zs.c)(t,Zs.j.DisableEditTitle),m=(0,Zs.c)(t,Zs.j.DisableReorder);c!==h.D.ENTER||a!==js.ListItem||p?c!==h.D.DELETE||"INPUT"===s.tagName||d?c===h.D.RIGHT_ARROW&&"LI"===s.tagName?this.focusFirstCommandButton():c!==h.D.SPACE||"INPUT"===s.tagName||u?c===h.D.UP_ARROW&&l.ctrlKey&&"INPUT"!==s.tagName&&!m?r(n,-1):c===h.D.DOWN_ARROW&&l.ctrlKey&&"INPUT"!==s.tagName&&!m&&r(n,1):o(n.id):i(n.id):this.isFormSubmitted?this.isFormSubmitted=!1:qs.v.create().setImmediate((()=>{this.startChecklistItemTitleEdit()}))},this.onDeleteFocus=e=>{this.setState({focusState:js.Buttons})},this.onPromoteFocus=e=>{this.setState({focusState:js.Buttons})},this.onCommandButtonBlur=()=>{this.setState({focusState:js.None})},this.onPromoteKeyUp=e=>{const{onPromote:t,listItem:n}=this.props;e.preventDefault(),Vs.a.isButtonPress(e)&&t(n.id);var o;Vs.a.getKey(e)===h.D.RIGHT_ARROW&&(null===(o=this.deleteButtonRef.current)||void 0===o||o.focus())},this.onDeleteKeyUp=e=>{const{onDelete:t,listItem:n}=this.props;e.preventDefault(),e.stopPropagation(),Vs.a.isButtonPress(e)&&t(n.id);var o;Vs.a.getKey(e)===h.D.LEFT_ARROW&&(null===(o=this.promoteButtonRef.current)||void 0===o||o.focus())},this.focusFirstCommandButton=()=>{const{permissions:e}=this.props,t=(0,Zs.c)(e,Zs.j.DisablePromote),n=(0,Zs.c)(e,Zs.j.DisableDelete);var o;if(t){if(!n){var i;null===(i=this.deleteButtonRef.current)||void 0===i||i.focus()}}else null===(o=this.promoteButtonRef.current)||void 0===o||o.focus()},this.preventDefaultAndStopPropagation=e=>{Vs.a.getKey(e)===h.D.SPACE&&(e.preventDefault(),e.stopPropagation())},this.state={editedTitle:"",focusState:js.None}}}const $s=(0,Hs.I)((e=>e.itemTypeString),Xs.prototype.itemSource(),Xs.prototype.itemCollect)(Xs);var Js=n(79889),Qs=n.n(Js),el=n(79966),tl=(0,G.J9)((function(e){var t=[(0,Tr.gS)(),{color:xr.EW,alignItems:"center",listStyleType:"none",cursor:"pointer","> i":{opacity:0},":not(.reorderDisabled)":{":hover, :focus":{"> i":{opacity:1}}}}],n=[Tr.JB,{padding:"5px 5px 5px 15px",color:xr.Yl}],o={root:[Tr.$u,{overflowY:"auto",paddingLeft:0,listStyleType:"none",li:{margin:"10px 0px 10px 0px","> .dndListItem":t,"> .errorMessage":n}}]};return(0,K.TW)(o,e)})),nl=(0,G.J9)((function(e){var t=tl(e);return{root:(0,K.Zq)("dndList",t.root)}})),ol=n(62523),il=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rl=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o},al=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.state={draggedEntity:null,draggedEntityIndex:null,placeholderIndex:null},o._previousPointerYPosition=null,o}return il(t,e),t.prototype.name=function(){return"DndList"},t.prototype.componentDidUpdate=function(e){this.props.isOver!==e.isOver&&!1===this.props.isOver&&this.setState({draggedEntity:null,placeholderIndex:null})},t.prototype.renderComponent=function(){var e=this.props,n=e.listItems,o=e.isReorderDisabled,i=e.onRenderItem,r=e.ariaLabel,a=e.itemType,s=e.connectDropTarget,l=rl(n),d=this.getClassNames();null!=this.state.placeholderIndex&&null!=this.state.draggedEntityIndex&&l.splice(this.state.draggedEntityIndex,1);var u=rt()(l,(function(e,t){return i(e,t,a,l,o)}));null!=this.state.placeholderIndex&&u.splice(this.state.placeholderIndex,0,c.createElement("li",{className:"listItem placeholder",key:t.placeholderRole,"data-dnd-role":t.placeholderRole},c.createElement("div",null)));var p=c.createElement("ul",{className:d.root,"aria-label":r},u);return o||!s?p:s(p)},t.prototype.itemTarget=function(){return{drop:this.onDrop.bind(this),hover:Qs()(this.hover.bind(this),50)}},t.prototype.itemTargetCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.onDrop=function(e,t,n){var o,i;if(t&&t.getItemType()===e.itemType){var r=t.getItem().index;if(n&&null!=r&&!(r<0)){var a=e.listItems[r];if(a){var s=n.state.placeholderIndex;t.getItemType()===e.itemType&&null!=s&&s!==r&&(e.onReorder(a,s-r),(null!==(i=null===(o=n.context)||void 0===o?void 0:o.usageLogger)&&void 0!==i?i:ol.K).logData(this.name(),"List item reordered")),n.setState({draggedEntity:null,draggedEntityIndex:null,placeholderIndex:null})}}}},t.prototype.hover=function(e,n,o){if(n&&n.getItemType()===e.itemType&&o){var i=o,r=n.getClientOffset();if(null!=r){var a=null==i._previousPointerYPosition?0:r.y-i._previousPointerYPosition;i._previousPointerYPosition=r.y;var s=document.elementFromPoint(r.x,r.y);if((s=i.findTarget(s))&&s.getAttribute(t.dataDndRoleAttribute)===e.itemType){var l=r.y-(s.getBoundingClientRect().top+s.getBoundingClientRect().bottom)/2<=0,c=s.getAttribute(t.dataIndexAttribute);if(!c)return;var d=parseInt(c,10);if((null==i.state.placeholderIndex||Math.abs(d-i.state.placeholderIndex)>1)&&!l&&(d+=1),i.state.placeholderIndex===d&&(d+=1),null!=i.state.placeholderIndex&&(a<0&&d===i.state.placeholderIndex+1||a>0&&d===i.state.placeholderIndex-1||0===a))return;i.setPlaceholder(d,n.getItem())}}}},t.prototype.findTarget=function(e){if(null==e)return null;var n=e.getAttribute(t.dataDndRoleAttribute);return n===t.placeholderRole?null:(n===this.props.itemType||null==n&&(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({draggedEntity:t.entity,draggedEntityIndex:t.index,placeholderIndex:e})},t.prototype.getClassNames=function(){return nl(this.props.styles)},t.placeholderRole="placeholder",t.dataDndRoleAttribute="data-dnd-role",t.dataIndexAttribute="data-index",t}(d.$);const sl=(0,el.T)((function(e){return e.itemType}),al.prototype.itemTarget(),al.prototype.itemTargetCollect)(al);var ll=n(94772),cl=n(34717),dl=n(67967),ul=n(74065),pl=n.n(ul),hl=n(61086),ml=n.n(hl),gl=n(98424),fl=n(91246),vl=n(67271);class bl extends d.${name(){return"Checklist"}renderComponent(){const{checklistItems:e,permissions:t,showMandatoryChecklistTooltip:n,updateCompletionRequirementsInfoCallout:o}=this.props,i=Ys.e.getSortedChecklistItems(e),r=this.getChecklistContainerClassNames(),a=n?o:void 0;return c.createElement("div",{className:r.root,onClick:a},c.createElement(sl,{listItems:i,onRenderItem:this.renderChecklistItem,isReorderDisabled:(0,Zs.c)(t,Zs.j.DisableReorder),onReorder:this.moveItem,itemType:"checklistItem",ariaLabel:this.getChecklistArialabel()}),this.renderNewItem())}getChecklistArialabel(){const{permissions:e}=this.props,t=(0,Zs.c)(e,Zs.j.DisableCheckedStateToggling),n=(0,Zs.c)(e,Zs.j.DisableEditTitle),o=(0,Zs.c)(e,Zs.j.DisablePromote),i=(0,Zs.c)(e,Zs.j.DisableDelete),r=(0,Zs.c)(e,Zs.j.DisableReorder),a=[];return t||a.push(ht.p.Strings.Checklist_ChecklistCheckInstructions),n||a.push(ht.p.Strings.Checklist_ChecklistEditNameInstructions),i||a.push(ht.p.Strings.Checklist_ChecklistDeleteInstructions),i&&o||a.push(ht.p.Strings.Checklist_ChecklistDeleteOrPromoteInstructions),r||a.push(ht.p.Strings.Checklist_ChecklistReorderInstructions),a.join(ht.p.Strings.Checklist_ChecklistInstructionsListDelimiter)}componentDidUpdate(e,t){"addItem"===this.state.focusedChecklistItemId&&this.checklistAddItemElement.current&&(this.checklistAddItemElement.current.getElementsByTagName("input")[0].focus(),this.clearFocusedChecklistItemId())}checklistNewItemTitleChanged(e){this.setState({newChecklistItemTitle:e})}cloneChecklist(){return Ys.e.cloneChecklist(this.props.checklistItems)}generateChecklistItemUniqueId(){var e;let t="";const n=null!==(e=this.props.checklistItems)&&void 0!==e?e:[];do{t=ml()(1e4,99999,!1).toString()}while(null!=n[t]);return t}getChecklistContainerClassNames(){return(0,dl.Zz)((0,dl.$f)(this.props.theme,this.props.containerStyles))}getChecklistItemClassNames(){return(0,Gs.Zz)((0,Gs.$f)(this.props.theme,this.props.checklistItemStyles,(0,Zs.c)(this.props.permissions,Zs.j.DisableCreate)))}constructor(e,t){super(e,t),this.checklistAddItemElement=c.createRef(),this.onCheckboxClick=e=>{const{checklistItems:t,updateChecklist:n,showMandatoryChecklistTooltip:o}=this.props,i=t[e];if(null!==i&&!o){n(Ys.e.setChecklistProperty(t,e,"isChecked",!i.isChecked)),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,i.isChecked?Mt.M.TaskDetailsChecklistItemCompleted:"ChecklistItemMarkedIncomplete")}},this.updateItemTitle=(e,t)=>{const{checklistItems:n,updateChecklist:o}=this.props;if(!st()(fn()(t))){o(Ys.e.setChecklistProperty(n,e,"title",t)),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,"Checklist item title updated")}},this.addNewItem=e=>{e.preventDefault();const{updateChecklist:t,permissions:n}=this.props,{newChecklistItemTitle:o}=this.state,i=!(0,Zs.c)(n,Zs.j.DisableCreate);if(!st()(fn()(o))&&i){const e=this.generateChecklistItemUniqueId(),n=this.cloneChecklist(),i=pl()(Ys.e.getSortedChecklistItems(n)),r=gl.O.generateOrderHintBetween(null,i?i.orderHint:null),a=new Ys.e(e,!1,r,o);n[e]=a,t(n),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,Mt.M.TaskDetailsChecklistItemAdded),this.checklistNewItemTitleChanged("")}},this.deleteItem=e=>{if(""===e)throw new Error("InvalidArgumentException: deletedId");const t=this.cloneChecklist();if(delete t[e],st()(t))this.setState({focusedChecklistItemId:"addItem"});else{const t=Ys.e.getSortedChecklistItems(this.props.checklistItems);let n=ot()(t,(t=>t.id===e))+1;n>t.length-1&&(n=t.length-2),this.setState({focusedChecklistItemId:t[n].id})}this.props.updateChecklist(t),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,"Checklist item deleted")},this.promoteItem=e=>{if(""===e)throw new Error("InvalidArgumentException: itemId");const t=this.props.checklistItems[e];if(null==t)return;const n=cl.Y.builder.withPropertyBag({id:fl.o.generate(),title:t.title,planId:this.props.planId,bucketId:this.props.bucketId,percentComplete:(0,vl.BK)(ll.$.NotStarted)}).build();this.props.createTask(n),this.deleteItem(e),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,"Checklist item promoted")},this.renderChecklistItem=(e,t,n,o,i)=>{const{taskId:r,permissions:a,theme:s}=this.props;return c.createElement($s,{key:"checklistItem-".concat(r,"-").concat(e.id,"-").concat(t),listItem:e,itemTypeString:n,index:t,isReorderDisabled:i,permissions:a,onPromote:this.promoteItem,onMove:this.moveItem,onDelete:this.deleteItem,onRename:this.updateItemTitle,onCheckboxClick:this.onCheckboxClick,setFocusOnInit:this.state.focusedChecklistItemId===e.id,clearFocusedChecklistItemId:this.clearFocusedChecklistItemId,plannerTheme:s,gripperIconProps:Ne.bQ})},this.renderNewItem=()=>{const{permissions:e,checklistItems:t,maxChecklistItemsPerTask:n,theme:o}=this.props,i=(0,Zs.c)(e,Zs.j.DisableCreate),r=this.getChecklistItemClassNames();return Object.keys(t).length>=n?null:c.createElement("div",{className:"".concat(r.root," new"),key:"checklistNewItem"},c.createElement("div",{className:r.listItemContents},c.createElement(S.S,{className:"checkbox",title:ht.p.Strings.Checklist_ChecklistCheckboxTitle,checked:!1,inputProps:{tabIndex:-1},disabled:i,appTheme:o}),c.createElement("form",{onSubmit:this.addNewItem,autoComplete:"off",ref:this.checklistAddItemElement},c.createElement(Be.A,{className:"checklistTextField",title:i?ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:void 0,tabIndex:0,placeholder:ht.p.Strings.Checklist_NewChecklistItem,onChange:(e,t)=>{this.checklistNewItemTitleChanged(t)},value:this.state.newChecklistItemTitle,onBlur:this.addNewItem.bind(this),styleType:Fe.u.Text,maxLength:Ys.e.TitleMaxLength,ariaLabel:ht.p.Strings.Checklist_NewChecklistItemAriaLabel,disabled:i,appTheme:this.props.theme}))))},this.moveItem=(e,t)=>{const n=Ys.e.getSortedChecklistItems(this.props.checklistItems),o=ot()(n,(t=>t.id===e.id));if(t<0&&o<=0)return;if(t>0&&o>=n.length-1)return;n.splice(o,1);const i=o+t,r=n[i]?n[i].orderHint:null,a=n[i-1]?n[i-1].orderHint:null,s=gl.O.generateOrderHintBetween(r,a),l=e.setProperty("orderHint",s),c=this.cloneChecklist();c[l.id]=l,this.setState({focusedChecklistItemId:l.id}),this.props.updateChecklist(c),this.context.usageLogger.logData(Mt.M.TaskDetailsChecklist,"Checklist item moved")},this.clearFocusedChecklistItemId=()=>{this.setState({focusedChecklistItemId:null})},this.state={editedTitle:"",itemBeingEdited:"",newChecklistItemTitle:"",placeholderIndex:null,focusedChecklistItemId:null}}}var yl=n(71231);const Cl=(0,G.J9)(((e,t,n,o)=>{const i={root:[{position:"relative",left:"-6px",":after":[Il(1,e),Al,{content:"''",position:"absolute",borderRadius:"50%"}]},t&&[{":after":{animation:"inherit",animationTimingFunction:"ease-out",animationDuration:yl.T$}},n&&[{":after":{animationName:Pl(e)}}]]]};return(0,K.TW)(i,o)})),Sl=(0,G.J9)(((e,t,n,o)=>{const i=Cl(e,t,n,o);return{root:(0,K.Zq)("checklistProgressBarConfetti",i.root)}})),kl=.5,Dl=[.70710678,1,.70710678],xl=[-.70710678,0,.70710678],Tl=[Te.z.ConfettiMagenta,Te.z.ConfettiBlue,Te.z.ConfettiOrange],El=[Te.z.TeamsAppBrand12,Te.z.TeamsAppBrand00,Te.z.TeamsAppBrand12],wl=[Te.z.TeamsAppBrand12,Te.z.TeamsDarkThemeConfettiDarkPurple,Te.z.TeamsAppBrand12],_l=[Te.z.White,Te.z.White,Te.z.White],Il=(e,t)=>{let n;switch(t){case m.Sx.TeamsLight:n=El;break;case m.Sx.TeamsDark:n=wl;break;case m.Sx.TeamsContrast:n=_l;break;default:n=Tl}return(0,yl.t_)(e,.6,kl,3,Dl,xl,n)},Pl=(0,G.J9)((e=>(0,K.i7)({"0%, 20%":{opacity:0},"25%":{opacity:1,...Il(0,e)}}))),Al={margin:0,marginTop:"".concat(.2,"rem"),width:"".concat(kl,"rem"),height:"".concat(kl,"rem")};class Rl extends d.${componentDidUpdate(e,t){e.isLastChecklistItemMarkedComplete!==this.props.isLastChecklistItemMarkedComplete&&this.props.isLastChecklistItemMarkedComplete!==this.state.isLastChecklistitemMarkedComplete&&this.playCssAnimation(null)}name(){return"ChecklistProgressBarConfetti"}renderComponent(){const e=this.getClassNames();return c.createElement("div",{className:e.root})}playCssAnimation(e){const t=this.state.isLastChecklistitemMarkedComplete?this.UNCOMPLETE_ANIMATION_DURATION:this.COMPLETE_ANIMATION_DURATION;this.async.setTimeout((()=>{this.setState({animate:!0})}),this.COMPLETE_ANIMATION_DURATION),null===e||void 0===e||e.stopPropagation(),this.setState({isLastChecklistitemMarkedComplete:!this.state.isLastChecklistitemMarkedComplete}),this.async.setTimeout((()=>{this.setState({animate:!1})}),t)}getClassNames(){const{theme:e,styles:t}=this.props,{isLastChecklistitemMarkedComplete:n,animate:o}=this.state;return Sl(e,n,o,t)}constructor(e,t){super(e,t),this.COMPLETE_ANIMATION_DURATION=1200,this.UNCOMPLETE_ANIMATION_DURATION=100,this.state={isLastChecklistitemMarkedComplete:this.props.isLastChecklistItemMarkedComplete,animate:!0}}}var Ll=n(9479),Nl=n(3751),Ml=n(50289),Ol=n(52463),Bl=n(94028),Fl=n(7500),jl=(0,k.__assign)((0,k.__assign)({},Fl.yZ),{prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker",isRequiredErrorMessage:"Field is required",invalidInputErrorMessage:"Invalid date format",isResetStatusMessage:'Invalid entry "{0}", date reset to "{1}"'}),Hl=(0,Sn.Z)(),zl={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){e.match(/^\d{4}(-\d{2}){2}$/)&&(e+="T12:00");var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:Ml.ob.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:jl,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:Ml.zX.FirstDay,showGoToToday:!0,showCloseButton:!1,underlined:!1,allFocusable:!1};var Ul=c.forwardRef((function(e,t){var n,o,i=(0,T.N)(zl,e),r=i.firstDayOfWeek,a=i.strings,s=i.label,l=i.theme,d=i.className,u=i.styles,p=i.initialPickerDate,h=i.isRequired,m=i.disabled,g=i.ariaLabel,f=i.pickerAriaLabel,v=i.placeholder,b=i.allowTextInput,y=i.borderless,C=i.minDate,S=i.maxDate,D=i.showCloseButton,x=i.calendarProps,E=i.calloutProps,w=i.textField,_=i.underlined,A=i.allFocusable,R=i.calendarAs,L=void 0===R?Nl.V:R,N=i.tabIndex,M=i.disableAutoFocus,O=void 0===M||M,B=(0,wn.B)("DatePicker",i.id),j=(0,wn.B)("DatePicker-Callout"),H=c.useRef(null),W=c.useRef(null),G=function(){var e=c.useRef(null),t=c.useRef(!1);return[e,function(){var t,n;null===(n=null===(t=e.current)||void 0===t?void 0:t.focus)||void 0===n||n.call(t)},t,function(){t.current=!0}]}(),q=G[0],V=G[1],Z=G[2],Y=G[3],X=function(e,t){var n=e.allowTextInput,o=e.onAfterMenuDismiss,i=c.useState(!1),r=i[0],a=i[1],s=c.useRef(!1),l=(0,_n.Y)();return c.useEffect((function(){s.current&&!r&&(n&&l.requestAnimationFrame(t),null===o||void 0===o||o()),s.current=!0}),[r]),[r,a]}(i,V),$=X[0],J=X[1],Q=function(e){var t=e.formatDate,n=e.value,o=e.onSelectDate,i=(0,In.k)(n,void 0,(function(e,t){return null===o||void 0===o?void 0:o(t)})),r=i[0],a=i[1],s=c.useState((function(){return n&&t?t(n):""})),l=s[0],d=s[1];return c.useEffect((function(){d(n&&t?t(n):"")}),[t,n]),[r,l,function(e){a(e),d(e&&t?t(e):"")},d]}(i),ee=Q[0],te=Q[1],ne=Q[2],oe=Q[3],ie=function(e,t,n,o,i){var r,a=e.isRequired,s=e.allowTextInput,l=e.strings,d=e.parseDateFromString,u=e.onSelectDate,p=e.formatDate,h=e.minDate,m=e.maxDate,g=e.textField,f=c.useState(),v=f[0],b=f[1],y=c.useState(),C=y[0],S=y[1],k=c.useRef(!0),D=null===(r=null===g||void 0===g?void 0:g.validateOnLoad)||void 0===r||r;return c.useEffect((function(){k.current&&(k.current=!1,!D)||(a&&!t?b(l.isRequiredErrorMessage||" "):t&&Wl(t,h,m)?b(l.isOutOfBoundsErrorMessage||" "):b(void 0))}),[h&&(0,Ol.vk)(h),m&&(0,Ol.vk)(m),t&&(0,Ol.vk)(t),a,D]),[i?void 0:v,function(e){if(void 0===e&&(e=null),s)if(o||e){if(t&&!v&&p&&p(null!==e&&void 0!==e?e:t)===o)return;if(!(e=e||d(o))||isNaN(e.getTime())){n(t);var i=p?p(t):"",r=l.isResetStatusMessage?(0,dt.G)(l.isResetStatusMessage,o,i):l.invalidInputErrorMessage||"";S(r)}else Wl(e,h,m)?b(l.isOutOfBoundsErrorMessage||" "):(n(e),b(void 0),S(void 0))}else b(a?l.isRequiredErrorMessage||" ":void 0),null===u||void 0===u||u(e);else a&&!o?b(l.isRequiredErrorMessage||" "):(b(void 0),S(void 0))},b,i?void 0:C,S]}(i,ee,ne,te,$),re=ie[0],ae=ie[1],se=ie[2],le=ie[3],ce=ie[4],de=c.useCallback((function(){$||(Y(),J(!0))}),[$,Y,J]);c.useImperativeHandle(i.componentRef,(function(){return{focus:V,reset:function(){J(!1),ne(void 0),se(void 0),ce(void 0)},showDatePickerPopup:de}}),[V,se,J,ne,ce,de]);var ue=function(e){$&&(J(!1),ae(e),!b&&e&&ne(e))},pe=function(e){Y(),ue(e)},he=function(e){$&&(e.stopPropagation(),pe())},me=Hl(u,{theme:l,className:d,disabled:m,underlined:_,label:!!s,isDatePickerShown:$}),ge=(0,F.G1)(i,F.JM,["value"]),fe=w&&w.iconProps,ve=w&&w.id&&w.id!==B?w.id:B+"-label",be=!b&&!m,ye=null===(o=null!==(n=null===w||void 0===w?void 0:w["data-is-focusable"])&&void 0!==n?n:i["data-is-focusable"])||void 0===o||o,Ce=b?{role:"button","aria-expanded":$,"aria-label":null!==g&&void 0!==g?g:s,"aria-labelledby":w&&w["aria-labelledby"]}:{};return c.createElement("div",(0,k.__assign)({},ge,{className:me.root,ref:t}),c.createElement("div",{ref:W,"aria-owns":$?j:void 0,className:me.wrapper},c.createElement(Bl.A,(0,k.__assign)({role:"combobox",label:s,"aria-expanded":$,ariaLabel:g,"aria-haspopup":"dialog","aria-controls":$?j:void 0,required:h,disabled:m,errorMessage:re,placeholder:v,borderless:y,value:te,componentRef:q,underlined:_,tabIndex:N,readOnly:!b},w,{"data-is-focusable":ye,id:ve,className:(0,I.A)(me.textField,w&&w.className),iconProps:(0,k.__assign)((0,k.__assign)((0,k.__assign)({iconName:"Calendar"},Ce),fe),{className:(0,I.A)(me.icon,fe&&fe.className),onClick:function(e){e.stopPropagation(),$||i.disabled?i.allowTextInput&&ue():de()}}),onRenderDescription:function(e,t){return c.createElement(c.Fragment,null,e.description||e.onRenderDescription?t(e):null,c.createElement("div",{"aria-live":"assertive",className:me.statusMessage},le))},onKeyDown:function(e){switch(e.which){case P.c.enter:e.preventDefault(),e.stopPropagation(),$?i.allowTextInput&&ue():(ae(),de());break;case P.c.escape:he(e);break;case P.c.down:e.altKey&&!$&&de()}},onFocus:function(){O||b||(Z.current||de(),Z.current=!1)},onBlur:function(e){ae()},onClick:function(e){!(i.openOnClick||!i.disableAutoFocus)||$||i.disabled?i.allowTextInput&&ue():de()},onChange:function(e,t){var n,o=i.textField;b&&($&&ue(),oe(t)),null===(n=null===o||void 0===o?void 0:o.onChange)||void 0===n||n.call(o,e,t)},onRenderInput:be?function(e){var t=(0,F.G1)(e,F.JM),n=(0,K.Zq)(t.className,me.readOnlyTextField);return c.createElement("div",(0,k.__assign)({},t,{className:n,tabIndex:N||0}),te||c.createElement("span",{className:me.readOnlyPlaceholder},v))}:void 0}))),$&&c.createElement(z.P,(0,k.__assign)({id:j,role:"dialog",ariaLabel:f,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:W.current,directionalHint:U.A.bottomLeftEdge},E,{className:(0,I.A)(me.callout,E&&E.className),onDismiss:function(e){pe()},onPositioned:function(){var e=!0;i.calloutProps&&void 0!==i.calloutProps.setInitialFocus&&(e=i.calloutProps.setInitialFocus),H.current&&e&&H.current.focus()}}),c.createElement(cs.Y,{isClickableOutsideFocusTrap:!0,disableFirstFocus:O},c.createElement(L,(0,k.__assign)({},x,{onSelectDate:function(e){i.calendarProps&&i.calendarProps.onSelectDate&&i.calendarProps.onSelectDate(e),pe(e)},onDismiss:function(e){pe()},isMonthPickerVisible:i.isMonthPickerVisible,showMonthPickerAsOverlay:i.showMonthPickerAsOverlay,today:i.today,value:ee||p,firstDayOfWeek:r,strings:a,highlightCurrentMonth:i.highlightCurrentMonth,highlightSelectedMonth:i.highlightSelectedMonth,showWeekNumbers:i.showWeekNumbers,firstWeekOfYear:i.firstWeekOfYear,showGoToToday:i.showGoToToday,dateTimeFormatter:i.dateTimeFormatter,minDate:C,maxDate:S,componentRef:H,showCloseButton:D,allFocusable:A})))))}));function Wl(e,t,n){return!!t&&(0,Ol.F4)(t,e)>0||!!n&&(0,Ol.F4)(n,e)<0}Ul.displayName="DatePickerBase";var Kl={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "},Gl=(0,Cn.I)(Ul,(function(e){var t,n=e.className,o=e.theme,i=e.disabled,r=e.underlined,a=e.label,s=e.isDatePickerShown,l=o.palette,c=o.semanticColors,d=o.fonts,u=(0,K.Km)(Kl,o),p={color:l.neutralSecondary,fontSize:K.s.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"4px",padding:"5px"};return{root:[u.root,o.fonts.large,s&&"is-open",K.S8,n],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},i&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[u.callout],icon:[p,a?u.withLabel:u.withoutLabel,{paddingTop:"7px"},!i&&[u.disabled,{pointerEvents:"initial",cursor:"pointer"}],i&&{color:c.disabledText,cursor:"default"}],statusMessage:[d.small,{color:c.errorText,marginTop:5}],readOnlyTextField:[{cursor:"pointer",height:32,lineHeight:30,overflow:"hidden",textOverflow:"ellipsis"},r&&{lineHeight:34}],readOnlyPlaceholder:(t={color:c.inputPlaceholderText},t[K.up]={color:"GrayText"},t)}}),void 0,{scope:"DatePicker"}),ql=n(22344),Vl=n(5958),Zl=n(34962);class Yl extends d.${name(){return"DatePicker"}renderComponent(){var e;const t=this.context.traceLogger,{children:n,...o}={...this.props,styles:(0,Vl.j)(this.props.appTheme),calendarProps:{styles:(0,Zl.Ti)(this.props.appTheme,t),calendarDayProps:{styles:(0,Zl.h9)(this.props.appTheme,t),navigationIcons:ql.m},calendarMonthProps:{styles:(0,Zl.Vf)(this.props.appTheme,t),navigationIcons:ql.m}},calloutProps:{...this.props.calloutProps,className:(0,I.A)("plannerAppCallout",null===(e=this.props.calloutProps)||void 0===e?void 0:e.className)},textField:{...this.props.textField,iconProps:Ne.cx,styles:(0,Vl.K)(this.props.appTheme,t,this.props.disabled)}};return c.createElement(Gl,o,n)}constructor(e,t){super(e,t)}}var Xl,$l,Jl=n(42283),Ql=n(40135),ec=n(78769),tc=n(91675),nc=n(71484);!function(e){e[e.docset=1]="docset",e[e.folder=2]="folder",e[e.genericFile=3]="genericFile",e[e.listItem=4]="listItem",e[e.sharedFolder=5]="sharedFolder",e[e.multiple=6]="multiple",e[e.stream=7]="stream",e[e.news=8]="news",e[e.desktopFolder=9]="desktopFolder",e[e.documentsFolder=10]="documentsFolder",e[e.picturesFolder=11]="picturesFolder",e[e.linkedFolder=12]="linkedFolder",e[e.list=13]="list",e[e.form=14]="form",e[e.sway=15]="sway",e[e.playlist=16]="playlist"}(Xl||(Xl={}));var oc="genericfile",ic="folder",rc="sharedfolder",ac="docset",sc="listitem",lc="splist",cc="multiple",dc="sponews",uc="video",pc="desktopfolder",hc="documentsfolder",mc="picturesfolder",gc="linkedfolder",fc="form",vc="sway",bc="playlist";function yc(e){var t,n=e.extension,o=e.type,i=e.size,r=e.imageFileType;t=function(e,t){var n;if(e){if(!$l)for(var o in $l={},nc.K)if(nc.K.hasOwnProperty(o)){var i=nc.K[o].extensions;if(i)for(var r=0;r<i.length;r++)$l[i[r]]=o}return e=e.replace(".","").toLowerCase(),$l[e]||oc}if(t)switch(t){case Xl.docset:n=ac;break;case Xl.folder:n=ic;break;case Xl.listItem:n=sc;break;case Xl.sharedFolder:n=rc;break;case Xl.stream:n=uc;break;case Xl.multiple:n=cc;break;case Xl.news:n=dc;break;case Xl.desktopFolder:n=pc;break;case Xl.documentsFolder:n=hc;break;case Xl.picturesFolder:n=mc;break;case Xl.linkedFolder:n=gc;break;case Xl.list:n=lc;break;case Xl.form:n=fc;break;case Xl.sway:n=vc;break;case Xl.playlist:n=bc}return n||oc}(n,o);var a=function(e,t){void 0===t&&(t="svg");var n=window.devicePixelRatio,o="";"svg"===t&&n>1&&n<=1.5?20!==e&&(o="_1.5x"):"png"===t&&(n>1&&n<=1.5?o=20===e?"_2x":"_1.5x":n>1.5&&n<=2?o="_2x":n>2&&n<=3?o="_3x":n>3&&(o="_4x"));return e+o+"_"+t}(i||16,r);return{iconName:t+a,"aria-label":n}}var Cc=n(50861),Sc=n(27663);const kc="22px",Dc=(0,G.J9)(((e,t,n)=>{const o={root:[(0,we.gS)(),(0,we.aS)(e),(0,we.NX)(e),{width:kc,height:kc,justifyContent:"center",alignItems:"center",cursor:"pointer","&:hover":(0,we.Mi)(e)},!t&&{"&:not(:focus)":{opacity:"0"}}],contextMenu:{".contextmenuFileIcon":[(0,we.gS)(),{height:"100%",width:"16px",alignItems:"center",margin:"0px 4px","> *":{maxWidth:"100%",maxHeight:"100%","> img":{maxWidth:"100%",maxHeight:"100%"}}}]}};return(0,K.TW)(o,n)})),xc=(0,G.J9)((e=>({root:(0,K.Zq)("fileSuggestionsContextMenuButton",e.root),contextMenu:(0,K.Zq)("fileSuggestionsContextMenu",e.contextMenu)})));var Tc=n(80493);class Ec extends d.${name(){return"FileSuggestionsContextMenu"}renderComponent(){const e=this.getClassNames();return c.createElement("div",{className:e.root,onClick:this.toggleContextMenu,title:ht.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-label":ht.p.Strings.TaskContextMenu_MoreButtonTooltipText,onKeyDown:this.onContextMenuButtonKeyDown,ref:this.props.contextMenuButtonRef,role:"button",tabIndex:0,"data-is-focusable":!0},c.createElement(C.I,Ne.XP),this.renderMoreContextMenu(this.props.fileSuggestion))}renderMoreContextMenu(e){if(!this.state.isContextMenuOpen)return null;const t=e=>({...e,className:(0,I.A)("defaultIconColor",e.className)}),n=[];n.push({key:"OpenInBrowser",name:ht.p.Strings.FileSuggestionsContextMenu_OpenInBrowser,iconProps:t(Ne.M8),onRenderIcon:this.props.onRenderFileIcon,onClick:()=>{this.openInBrowser(e)}}),n.push({key:"OpenInDesktopApp",name:ht.p.Strings.FileSuggestionsContextMenu_OpenInDesktopApp,iconProps:t(Ne.M8),onRenderIcon:this.props.onRenderFileIcon,onClick:()=>{this.openInDesktopApp(e)}}),n.push({key:"CopyLink",name:ht.p.Strings.FileSuggestionsContextMenu_CopyLink,iconProps:t(Ne.M8),onClick:()=>{this.logUsage("copyLinkToSuggestion",{entityId:this.props.entityId}),this.props.copyLinkToSuggestion(e)}});const o=this.getClassNames();return c.createElement(Yr.l,{className:o.contextMenu,shouldFocusOnMount:!0,items:n,directionalHint:U.A.bottomAutoEdge,target:this.props.contextMenuButtonRef,onDismiss:this.closeContextMenu,appTheme:this.props.theme})}openInDesktopApp(e){this.logUsage("openInDesktopApp",{entityId:this.props.entityId}),Tc.b.safelyOpenExternalUrl(e.url,"_blank")}openInBrowser(e){this.logUsage("openInBrowser",{entityId:this.props.entityId}),Tc.b.safelyOpenExternalUrl(e.webUrl,"_blank")}getClassNames(){const{theme:e,styles:t}=this.props;return xc(Dc(e,this.state.isContextMenuOpen,t))}constructor(e,t){super(e,t),this.toggleContextMenu=()=>{this.state.isContextMenuOpen||(this.logUsage("openContextMenu",{entityId:this.props.entityId}),this.props.onOpenContextMenu(this.props.fileSuggestion)),this.setState((e=>({...e,isContextMenuOpen:!e.isContextMenuOpen})))},this.closeContextMenu=()=>{this.setState({isContextMenuOpen:!1},(()=>{var e;null===(e=this.props.contextMenuButtonRef.current)||void 0===e||e.focus()}))},this.onContextMenuButtonKeyDown=e=>{const t=Vs.a.getKey(e);t!==h.D.ENTER&&t!==h.D.SPACE||(e.stopPropagation(),e.preventDefault(),this.toggleContextMenu())},this.state={isContextMenuOpen:!1}}}var wc=n(23918);const _c="12px",Ic="24px",Pc="48px",Ac="88px",Rc=(0,G.J9)((e=>({root:[(0,we.i9)(e),{fontSize:K.s.small,boxShadow:"none",borderRadius:Ue.B.PlannerBorderRadius,width:Pc,minWidth:Pc,height:"24px",cursor:"pointer",padding:"0px","&.add-rec":{marginRight:"4px",color:"green"},"&.dismiss-rec":{color:"red"}},(e===m.Sx.Light||e===m.Sx.TeamsLight)&&{border:"1px solid #dddddd"}],rootFocused:(0,we.i9)(e),rootHovered:(0,we.i9)(e),rootDisabled:(0,we.i9)(e)}))),Lc=(0,G.J9)(((e,t)=>{const n={root:[(0,we.GD)(),{marginRight:_c,borderRadius:Ue.B.PlannerBorderRadius,padding:"16px",marginBottom:_c,maxWidth:"calc((100% - 12px) / 2)",minWidth:"310px",overflow:"hidden",wordBreak:"break-word",position:"relative",height:Ac,maxHeight:Ac,boxSizing:"border-box",boxShadow:"0px 0px 4px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(201, 201, 201, 0.4)","&:nth-child(even)":{marginRight:"0"},"&:hover .file-info-container-zone .add-button-container .fileSuggestionsContextMenuButton:not(.showContextMenuButton):not(:focus)":{opacity:"1"}},e===m.Sx.TeamsContrast&&{borderColor:Te.z.White}],zone:{height:"100%"},fileContainer:[(0,we.gS)(),{height:"100%",maxHeight:"100%"}],iconContainer:{marginRight:"12px",".file-icon":{fontSize:"24px"},".file-image>img":{height:Ic,width:Ic,maxHeight:Ic,maxWidth:Ic}},contentContainer:[(0,we.GD)(),{".file-name":[(0,we.q0)("ellipsis"),{fontSize:K.s.medium,fontWeight:K.BO.semibold,cursor:"default"}],".file-usage":{fontSize:K.s.xSmall,cursor:"default"}}],addButtonContainer:[(0,we.gS)("column"),{marginLeft:"8px",justifyContent:"space-between",alignItems:"flex-end"}]};return(0,K.TW)(n,t)})),Nc=(0,G.J9)((e=>({root:(0,K.Zq)("file-info-container",e.root),zone:(0,K.Zq)("file-info-container-zone",e.zone),fileContainer:(0,K.Zq)("file-container",e.fileContainer),iconContainer:(0,K.Zq)("file-icon-container",e.iconContainer),contentContainer:(0,K.Zq)("file-content-container",e.contentContainer),addButtonContainer:(0,K.Zq)("add-button-container",e.addButtonContainer)})));var Mc=n(79537),Oc=n(74844),Bc=n(33268),Fc=n(6505);class jc extends d.${name(){return"FileSuggestionsCard"}componentDidMount(){var e;this.props.focusOnRender&&(null===(e=this.fileSuggestionCardRef.current)||void 0===e||e.focus())}renderComponent(){const{fileSuggestion:e,entityId:t}=this.props,n=this.removeExtensionFromFileName(e.fileName),o=this.getClassNames();return c.createElement("div",{className:o.root,tabIndex:0,"aria-label":e.fileName+ht.p.Strings.FileSuggestionsCard_FileSuggestionsCardAriaLabel,"data-is-focusable":!0,onFocus:this.onFocus,onBlur:this.onBlur,onKeyUp:this.onKeyUp,ref:this.fileSuggestionCardRef},c.createElement(Do.R,{className:o.zone,direction:xo.E.domOrder,isCircularNavigation:!1,disabled:!this.state.enableFocusZone},c.createElement("div",{className:o.fileContainer},c.createElement("div",{className:o.iconContainer},this.renderFileImage(e)),c.createElement("div",{className:o.contentContainer},c.createElement("div",{className:"file-name",title:n},n),c.createElement("div",{className:"file-usage"},this.generateFileUsageBlurb(e))),c.createElement("div",{className:o.addButtonContainer},c.createElement(Ec,{entityId:t,fileSuggestion:e,contextMenuButtonRef:this.contextMenuButtonRef,onRenderFileIcon:()=>c.createElement("div",{className:"contextmenuFileIcon"},this.renderFileImage(e)),onOpenContextMenu:this.props.onOpenContextMenu,copyLinkToSuggestion:this.props.copyLinkToSuggestion,theme:this.props.theme}),c.createElement(b.j,{className:"add-button",onClick:()=>this.props.onAdd(e),"aria-label":ht.p.Strings.FileSuggestionsCard_AddAttachmentAriaLabel,styles:Rc(this.props.theme)},ht.p.Strings.FileSuggestionsCard_AddAsAttachment)))))}removeExtensionFromFileName(e){const t=e.split(".");if(1===t.length)return e;const n=t[t.length-1],o=[];for(const i in tc.t)o.push(...tc.t[i]);return-1!==o.indexOf(n)?t.slice(0,-1).join("."):e}generateFileUsageBlurb(e){var t,n;let o,i;if(e.lastModified)o=e.lastModified,i=ht.p.Strings.FileSuggestionsCard_LastModified;else if(e.created)o=e.created,i=ht.p.Strings.FileSuggestionsCard_Created;else{if(!e.lastShared)return"";o=e.lastShared,i=ht.p.Strings.FileSuggestionsCard_LastShared}if(!o.name&&!o.email&&!o.dateTime)return"";const r=dt.G(ht.p.Strings.FileSuggestionsCard_FileUsageText,i,null!==(t=null!==(n=o.name)&&void 0!==n?n:o.email)&&void 0!==t?t:ht.p.Strings.FileSuggestionsCard_UnknownUser,o.dateTime?Hn()(o.dateTime).format("L"):ht.p.Strings.FileSuggestionsCard_UnknownDate);return r.length>50?r.slice(0,47)+"...":r}renderFileImage(e){const t=this.getFileRecommendationFileType(e);if(t===Dr.Er.Other&&this.state.fileLoadingState!==Cc.P6.error)return c.createElement(Sc._,{className:"file-image",shouldFadeIn:!0,imageFit:Cc.N_.none,src:Bc.wS.getFavIconUrl(e.url),onLoadingStateChange:e=>this.onPhotoLoadingStateChange(e),alt:""});const n=this.getFileExtensionForFileType(t);return n?c.createElement(C.I,yc({extension:n,size:24,imageFileType:"svg"})):c.createElement(C.I,{className:(0,I.A)("file-icon documentPreviewIcon",(0,Fc.Hp)(t)),iconName:(0,Fc.Od)(t),title:e.fileName})}getFileExtensionForFileType(e){if(e===Dr.Er.Other)return null;switch(e){case Dr.Er.Excel:return"xlsx";case Dr.Er.OneNote:return"one";case Dr.Er.Pdf:return"pdf";case Dr.Er.PowerPoint:return"pptx";case Dr.Er.Project:return"mpp";case Dr.Er.Visio:return"vsdx";case Dr.Er.Word:return"docx";case Dr.Er.Loop:return"loop";default:return Mc.f.unreachableCase(e,(e=>{this.context.traceLogger.logTrace(507877020,Oc.k.Warning,e)})),null}}onPhotoLoadingStateChange(e){this.setState({fileLoadingState:e})}getFileRecommendationFileType(e){if(e.fileProduct)switch(e.fileProduct.toLowerCase()){case"word":return Dr.Er.Word;case"excel":return Dr.Er.Excel;case"powerpoint":return Dr.Er.PowerPoint;case"onenote":return Dr.Er.OneNote}let t=null;for(const n of jc.fileTypeFields){const o=e[n];if(o&&(t=wc.Y.GetFileType(o),t!==Dr.Er.Other))return t}return Dr.Er.Other}getClassNames(){const{theme:e,styles:t}=this.props;return Nc(Lc(e,t))}constructor(e,t){super(e,t),this.contextMenuButtonRef=c.createRef(),this.fileSuggestionCardRef=c.createRef(),this.blurTimeout=null,this.onKeyUp=e=>{if(this.state.enableFocusZone)return;const t=Vs.a.getKey(e);((0,So.jI)()?t===h.D.LEFT_ARROW:t===h.D.RIGHT_ARROW)&&this.setState({enableFocusZone:!0},(()=>{var e;null===(e=this.contextMenuButtonRef.current)||void 0===e||e.focus()}))},this.onFocus=()=>{null!=this.blurTimeout&&this.async.clearImmediate(this.blurTimeout)},this.onBlur=()=>{null!=this.blurTimeout&&this.async.clearImmediate(this.blurTimeout),this.blurTimeout=this.async.setImmediate((()=>{this.setState({enableFocusZone:!1})}))},this.state={fileLoadingState:Cc.P6.notLoaded,enableFocusZone:!1}}}jc.fileTypeFields=["fileName","url","webUrl"];const Hc="140px",zc=(0,G.J9)(((e,t)=>{const n={emptyView:[(0,we.gS)(),{marginTop:"16px",height:"390px",justifyContent:"center",alignItems:"center",".no-results-container":{textAlign:"center",".no-suggestions-img":{height:Hc,width:Hc},".no-suggestions-text":[(0,we.Ml)(e),{marginTop:"32px"}]}}],header:{fontSize:K.s.medium,fontWeight:K.BO.semibold,marginBottom:"8px"},wrapper:[(0,we.gS)("row","wrap"),{marginTop:"24px"}],shimmer:{"&:last-child":{marginBottom:"44px"}},shimmerHeader:{marginBottom:"4px"},shimmerSubHeader:{marginTop:"4px"},resultsToggleContainer:[(0,we.gS)(),{justifyContent:"flex-end"}],resultsToggle:[(0,we.gS)(),(0,we.Ml)(e),{alignItems:"center",background:"transparent",border:"none",boxShadow:"none","&:hover":(0,we.Mi)(e),".toggle-string":{marginRight:"4px"}}]};return(0,K.TW)(n,t)})),Uc=(0,G.J9)((e=>({emptyView:(0,K.Zq)("file-suggestions-empty-view",e.emptyView),header:(0,K.Zq)("suggestions-header",e.header),wrapper:(0,K.Zq)("files-wrapper",e.wrapper),shimmer:(0,K.Zq)("shimmer",e.shimmer),shimmerHeader:(0,K.Zq)("shimmerHeader",e.shimmerHeader),shimmerSubHeader:(0,K.Zq)("shimmerSubheader",e.shimmerSubHeader),resultsToggleContainer:(0,K.Zq)("results-toggle-container",e.resultsToggleContainer),resultsToggle:(0,K.Zq)("results-toggle",e.resultsToggle)})));const Wc=n.p+"static/media/file-no-results.6ec61f36c38a3a40a2e3f8e4d0a783be.svg";var Kc=n(22514);class Gc extends d.${name(){return"FileSuggestions"}componentDidMount(){this.logFileSuggestionFloodgateActivity()}componentDidUpdate(e){this.logFileSuggestionFloodgateActivity(e),null==this.props.recommendedFiles&&this.state.showAllRecommendations&&this.setState({showAllRecommendations:!1})}renderComponent(){if(null!=this.props.recommendedFiles&&0===this.props.recommendedFiles.length)return this.renderEmptyView();const e=this.getClassNames();return c.createElement("div",{className:"suggestions-file-container"},c.createElement("div",{className:"suggestions-header-container"},c.createElement("span",{className:e.header},ht.p.Strings.FileSuggestions_Header)),c.createElement("div",{className:"suggestions-subheader"},ht.p.Strings.FileSuggestions_Subheader),c.createElement("div",{className:e.wrapper},this.renderFileSection()),this.renderShowMore())}logFileSuggestionFloodgateActivity(e){e||st()(this.props.recommendedFiles)?e&&st()(e.recommendedFiles)&&!st()(this.props.recommendedFiles)&&Kc.q.logFloodgateActivity(Mt.M.FileSuggestionsActivity,this.context.traceLogger):Kc.q.logFloodgateActivity(Mt.M.FileSuggestionsActivity,this.context.traceLogger)}renderFileSection(){if(null==this.props.recommendedFiles){const e=this.getClassNames(),t=this.getCardClassNames(),n=[];for(let o=0;o<Gc.defaultNumResults;o++)n.push(c.createElement("div",{key:"fileRecPlaceholder".concat(o),className:(0,I.A)(t.root,e.shimmer)},c.createElement(Ql.W,{className:e.shimmerHeader,shimmerElements:[{type:ec.w.circle,height:24},{type:ec.w.gap,width:10},{type:ec.w.line,height:18,width:"100%"}]}),c.createElement("div",null,c.createElement(Ql.W,{className:e.shimmerSubHeader,shimmerElements:[{type:ec.w.line,height:10}]}),c.createElement(Ql.W,{className:e.shimmerSubHeader,shimmerElements:[{type:ec.w.line,height:10}]}))));return c.createElement(c.Fragment,null,n)}const e=this.state.showAllRecommendations?this.props.recommendedFiles.slice(0,this.props.maxFileSuggestions):this.props.recommendedFiles.slice(0,Gc.defaultNumResults);return c.createElement(c.Fragment,null,e.map(((e,t)=>this.renderFileCard(e,t))))}renderShowMore(){if(null==this.props.recommendedFiles||this.props.recommendedFiles.length<=Gc.defaultNumResults)return null;const e=this.state.showAllRecommendations?ht.p.Strings.FileSuggestions_SeeLessAriaLabel:ht.p.Strings.FileSuggestions_SeeMoreAriaLabel,t=this.getClassNames();return c.createElement("div",{className:t.resultsToggleContainer},c.createElement(y.Y,{className:t.resultsToggle,onClick:this.onSeeMoreLessClick,title:e,ariaLabel:e},c.createElement("span",{className:"toggle-string"},this.state.showAllRecommendations?ht.p.Strings.FileSuggestions_SeeLess:ht.p.Strings.FileSuggestions_SeeMore),c.createElement(C.I,this.state.showAllRecommendations?Ne.jU:Ne.Ju)))}renderFileCard(e,t){return c.createElement(jc,{key:"fileSuggestion".concat(e.uniqueId),entityId:this.props.entityId,fileSuggestion:e,onAdd:this.props.onAdd,copyLinkToSuggestion:this.props.copyLinkToSuggestion,onOpenContextMenu:this.props.onOpenContextMenu,focusOnRender:this.state.showAllRecommendations&&t===Gc.defaultNumResults,theme:this.props.theme})}renderEmptyView(){const e=this.getClassNames();return c.createElement("div",{className:e.emptyView},c.createElement("div",{className:"no-results-container"},c.createElement("img",{className:"no-suggestions-img",src:Wc,title:ht.p.Strings.FileSuggestions_NoSuggestedFiles}),c.createElement("div",{className:"no-suggestions-text"},ht.p.Strings.FileSuggestions_NoSuggestedFiles)))}getClassNames(){const{theme:e,styles:t}=this.props;return Uc(zc(e,t))}getCardClassNames(){const{theme:e}=this.props;return Nc(Lc(e))}constructor(e,t){super(e,t),this.onSeeMoreLessClick=()=>{this.setState((e=>({...e,showAllRecommendations:!e.showAllRecommendations})))},this.state={showAllRecommendations:!1}}}Gc.defaultNumResults=6;var qc=n(69412),Vc=n(2880),Zc=n(96980);const Yc=()=>(0,jt.L)((()=>n.e(62672).then(n.bind(n,37374)))).then((e=>({default:e.RequirementsSection}))),Xc=(0,c.lazy)(Yc);var $c,Jc,Qc,ed,td,nd,od,id,rd,ad,sd,ld,cd,dd,ud,pd,hd,md,gd,fd,vd,bd,yd,Cd,Sd,kd,Dd,xd,Td,Ed,wd,_d,Id,Pd,Ad,Rd,Ld,Nd=n(59479),Md=(n(84056),n(9577));!function(e){e[e.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",e[e.AnnounceListItemBullet=2]="AnnounceListItemBullet",e[e.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"}($c||($c={})),function(e){e.AutoUrlDetect="AutoUrlDetect",e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(Jc||(Jc={})),function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(Qc||(Qc={})),function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL_LEFT=17]="CTRL_LEFT",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGEUP=33]="PAGEUP",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.DELETE=46]="DELETE",e[e.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",e[e.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.COMMA=188]="COMMA",e[e.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_TILDE=192]="GRAVE_TILDE",e[e.CONTENTCHANGED=257]="CONTENTCHANGED",e[e.RANGE=258]="RANGE",e[e.Ctrl=4096]="Ctrl",e[e.Meta=8192]="Meta",e[e.Shift=16384]="Shift"}(ed||(ed={})),function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(td||(td={})),function(e){e.Text="text/",e.Image="image/"}(nd||(nd={})),function(e){e.PlainText="text/plain",e.HTML="text/html"}(od||(od={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(id||(id={})),function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop",e.InsertEntity="InsertEntity",e.SwitchToDarkMode="SwitchToDarkMode",e.SwitchToLightMode="SwitchToLightMode",e.ListChain="ListChain",e.Keyboard="Keyboard"}(rd||(rd={})),function(e){e[e.LightToDark=0]="LightToDark",e[e.DarkToLight=1]="DarkToLight"}(ad||(ad={})),function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.DomEnd=2]="DomEnd",e[e.SelectionStart=3]="SelectionStart",e[e.Outside=4]="Outside",e[e.Range=5]="Range"}(sd||(sd={})),function(e){e.OriginalStyleColor="ogsc",e.OriginalStyleBackgroundColor="ogsb",e.OriginalAttributeColor="ogac",e.OriginalAttributeBackgroundColor="ogab"}(ld||(ld={})),function(e){e.DELIMITER_BEFORE="entityDelimiterBefore",e.DELIMITER_AFTER="entityDelimiterAfter"}(cd||(cd={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(dd||(dd={})),function(e){e.ENTITY_INFO_NAME="_Entity",e.ENTITY_TYPE_PREFIX="_EType_",e.ENTITY_ID_PREFIX="_EId_",e.ENTITY_READONLY_PREFIX="_EReadonly_"}(ud||(ud={})),function(e){e[e.NewEntity=0]="NewEntity",e[e.Click=1]="Click",e[e.ContextMenu=2]="ContextMenu",e[e.Escape=3]="Escape",e[e.RemoveFromStart=4]="RemoveFromStart",e[e.RemoveFromEnd=5]="RemoveFromEnd",e[e.Overwrite=6]="Overwrite",e[e.PartialOverwrite=7]="PartialOverwrite",e[e.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",e[e.AddShadowRoot=9]="AddShadowRoot",e[e.RemoveShadowRoot=10]="RemoveShadowRoot",e[e.UpdateEntityState=11]="UpdateEntityState"}(pd||(pd={})),function(e){e.NewIndentation="NewIndentation",e.NewBullet="NewBullet",e.NewNumbering="NewNumbering",e.ListChain="ListChain",e.MergePastedLine="MergePastedLine",e.SingleDirectionResize="SingleDirectionResize",e.PasteWithLinkPreview="PasteWithLinkPreview",e.ImageRotate="ImageRotate",e.ImageCrop="ImageCrop",e.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",e.ConvertSingleImageBody="ConvertSingleImageBody",e.TableAlignment="TableAlignment",e.AdaptiveHandlesResizer="AdaptiveHandlesResizer",e.AutoHyphen="AutoHyphen",e.PendingStyleBasedFormat="PendingStyleBasedFormat",e.NormalizeList="NormalizeList",e.ImageSelection="ImageSelection",e.VariableBasedDarkColor="VariableBasedDarkColor",e.ListItemAlignment="ListItemAlignment",e.DefaultFormatInSpan="DefaultFormatInSpan",e.DefaultFormatOnContainer="DefaultFormatOnContainer",e.ReusableContentModel="ReusableContentModel",e.EditWithContentModel="EditWithContentModel",e.AutoFormatList="AutoFormatList",e.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",e.ContentModelPaste="ContentModelPaste",e.TabKeyTextFeatures="TabKeyTextFeatures",e.ReuseAllAncestorListElements="ReuseAllAncestorListElements",e.DeleteTableWithBackspace="DeleteTableWithBackspace",e.DisableListChain="DisableListChain"}(hd||(hd={})),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(md||(md={})),function(e){e[e.CleanHTML=0]="CleanHTML",e[e.RawHTMLOnly=1]="RawHTMLOnly",e[e.RawHTMLWithSelection=2]="RawHTMLWithSelection",e[e.PlainText=3]="PlainText",e[e.PlainTextFast=4]="PlainTextFast"}(gd||(gd={})),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(fd||(fd={})),function(e){e.Sentence="sentence",e.Lowercase="lowercase",e.Uppercase="uppercase",e.CapitalizeEachWord="capitalize"}(vd||(vd={})),function(e){e[e.None=0]="None",e[e.Ordered=1]="Ordered",e[e.Unordered=2]="Unordered"}(bd||(bd={})),function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(yd||(yd={})),function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(Cd||(Cd={})),function(e){e[e.Table=0]="Table"}(Sd||(Sd={})),function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.MergeCells=11]="MergeCells",e[e.SplitHorizontally=12]="SplitHorizontally",e[e.SplitVertically=13]="SplitVertically",e[e.AlignCenter=14]="AlignCenter",e[e.AlignLeft=15]="AlignLeft",e[e.AlignRight=16]="AlignRight",e[e.AlignCellLeft=17]="AlignCellLeft",e[e.AlignCellCenter=18]="AlignCellCenter",e[e.AlignCellRight=19]="AlignCellRight",e[e.AlignCellTop=20]="AlignCellTop",e[e.AlignCellMiddle=21]="AlignCellMiddle",e[e.AlignCellBottom=22]="AlignCellBottom"}(kd||(kd={})),function(e){e[e.None=0]="None",e[e.CornerResize=1]="CornerResize",e[e.SideResize=2]="SideResize",e[e.Resize=3]="Resize",e[e.Rotate=4]="Rotate",e[e.ResizeAndRotate=7]="ResizeAndRotate",e[e.Crop=8]="Crop",e[e.All=15]="All"}(Dd||(Dd={})),function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block",e[e.AutoDetect=2]="AutoDetect"}(xd||(xd={})),function(e){e[e.None=0]="None",e[e.EmptyLine=1]="EmptyLine",e[e.BlockquoteWrapper=2]="BlockquoteWrapper",e[e.CopyPasteTempDiv=3]="CopyPasteTempDiv",e[e.BlockListItem=4]="BlockListItem",e[e.ContextMenuWrapper=5]="ContextMenuWrapper",e[e.ImageEditWrapper=6]="ImageEditWrapper",e[e.TableHorizontalResizer=7]="TableHorizontalResizer",e[e.TableVerticalResizer=8]="TableVerticalResizer",e[e.TableResizerLTR=9]="TableResizerLTR",e[e.TableResizerRTL=10]="TableResizerRTL",e[e.TableSelector=11]="TableSelector",e[e.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"}(Td||(Td={})),function(e){e[e.WordDesktop=0]="WordDesktop",e[e.ExcelDesktop=1]="ExcelDesktop",e[e.ExcelOnline=2]="ExcelOnline",e[e.PowerPointDesktop=3]="PowerPointDesktop",e[e.GoogleSheets=4]="GoogleSheets",e[e.WacComponents=5]="WacComponents",e[e.Default=6]="Default",e[e.SingleImage=7]="SingleImage"}(Ed||(Ed={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",e[e.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",e[e.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",e[e.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",e[e.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",e[e.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",e[e.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",e[e.CLEAR=8]="CLEAR"}(wd||(wd={})),function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.Input=3]="Input",e[e.CompositionEnd=4]="CompositionEnd",e[e.MouseDown=5]="MouseDown",e[e.MouseUp=6]="MouseUp",e[e.ContentChanged=7]="ContentChanged",e[e.ExtractContentWithDom=8]="ExtractContentWithDom",e[e.BeforeCutCopy=9]="BeforeCutCopy",e[e.BeforePaste=10]="BeforePaste",e[e.EditorReady=11]="EditorReady",e[e.BeforeDispose=12]="BeforeDispose",e[e.PendingFormatStateChanged=13]="PendingFormatStateChanged",e[e.Scroll=14]="Scroll",e[e.EntityOperation=15]="EntityOperation",e[e.ContextMenu=16]="ContextMenu",e[e.EnteredShadowEdit=17]="EnteredShadowEdit",e[e.LeavingShadowEdit=18]="LeavingShadowEdit",e[e.EditImage=19]="EditImage",e[e.BeforeSetContent=20]="BeforeSetContent",e[e.ZoomChanged=21]="ZoomChanged",e[e.SelectionChanged=22]="SelectionChanged",e[e.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"}(_d||(_d={})),function(e){e[e.Normal=0]="Normal",e[e.TableSelection=1]="TableSelection",e[e.ImageSelection=2]="ImageSelection"}(Id||(Id={})),function(e){e[e.Min=1]="Min",e[e.Decimal=1]="Decimal",e[e.DecimalDash=2]="DecimalDash",e[e.DecimalParenthesis=3]="DecimalParenthesis",e[e.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",e[e.LowerAlpha=5]="LowerAlpha",e[e.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",e[e.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",e[e.LowerAlphaDash=8]="LowerAlphaDash",e[e.UpperAlpha=9]="UpperAlpha",e[e.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",e[e.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",e[e.UpperAlphaDash=12]="UpperAlphaDash",e[e.LowerRoman=13]="LowerRoman",e[e.LowerRomanParenthesis=14]="LowerRomanParenthesis",e[e.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",e[e.LowerRomanDash=16]="LowerRomanDash",e[e.UpperRoman=17]="UpperRoman",e[e.UpperRomanParenthesis=18]="UpperRomanParenthesis",e[e.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",e[e.UpperRomanDash=20]="UpperRomanDash",e[e.Max=20]="Max"}(Pd||(Pd={})),function(e){e[e.Min=1]="Min",e[e.Disc=1]="Disc",e[e.Dash=2]="Dash",e[e.Square=3]="Square",e[e.ShortArrow=4]="ShortArrow",e[e.LongArrow=5]="LongArrow",e[e.UnfilledArrow=6]="UnfilledArrow",e[e.Hyphen=7]="Hyphen",e[e.DoubleLongArrow=8]="DoubleLongArrow",e[e.Circle=9]="Circle",e[e.Max=9]="Max"}(Ad||(Ad={})),function(e){e[e.Boolean=0]="Boolean",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Array=3]="Array",e[e.Object=4]="Object",e[e.Customize=5]="Customize"}(Rd||(Rd={})),function(e){e[e.Normal=0]="Normal",e[e.AsPlainText=1]="AsPlainText",e[e.MergeFormat=2]="MergeFormat",e[e.AsImage=3]="AsImage"}(Ld||(Ld={}));n(49140);var Od=n(38831),Bd=(n(59935),n(81637)),Fd=n(70768);const jd=()=>(0,jt.L)((()=>n.e(10135).then(n.bind(n,76124)))).then((e=>({default:e.RichTextEditorRibbon}))),Hd=(0,c.lazy)(jd),zd="#107c41",Ud=(0,G.J9)(((e,t)=>{const{readOnly:n,preview:o,isFocused:i,moreContent:r}=e,a={margin:"0 0 24px 0"},s={fontSize:K.s.medium,fontWeight:K.BO.semibold,marginTop:"4px",padding:"0",border:"none",backgroundColor:"transparent",color:zd,cursor:"pointer"},l=[{height:"44px",maxWidth:"100%",visibility:"visible"}],c={root:a,editorWrapper:[{marginLeft:"-".concat("7px"),marginRight:"-".concat("6px"),boxSizing:"border-box",border:"1px solid transparent"},n&&[{color:Te.z.NeutralTertiary,backgroundColor:Te.z.NeutralLighter},_e.E1],o&&{maxHeight:"105px",overflow:"hidden"},r&&{position:"relative","::before":{content:"''",position:"absolute",left:0,bottom:0,right:0,height:"32px",backgroundImage:"linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 1))",pointerEvents:"none"}},!n&&[!i&&{":hover":{border:"1px solid ".concat(Te.z.NeutralTertiary)}},{"._EId_WATERMARK_WRAPPER":[{"@media not screen and (-ms-high-contrast)":{color:"".concat(zd," !important")}},(0,_e.Ur)({color:"".concat(Te.z.ConfettiGreen," !important")})]},i&&[{border:"1px solid ".concat(zd),":hover":{border:"1px solid ".concat(zd)}},_e.hw]]],expandNotesButton:s,notesEditor:[{padding:"".concat("5px"," ").concat("6px"," ").concat("5px"," ").concat("7px"),outline:"none",overflow:"hidden",overflowX:"auto",maxWidth:"100%",wordWrap:"break-word",color:"inherit !important",backgroundColor:"inherit !important"},n&&{color:"inherit !important",backgroundColor:"inherit !important",cursor:"default","> .div":{color:"inherit !important",backgroundColor:"inherit !important"}}],ribbonContainer:l};return(0,K.pB)(e,c,t)})),Wd=(0,G.J9)((e=>({root:(0,K.Zq)("editor-container",e.root),editorWrapper:(0,K.Zq)("editor-wrapper",e.editorWrapper),expandNotesButton:(0,K.Zq)("expandNotesButton",e.expandNotesButton),notesEditor:(0,K.Zq)("notes-editor",e.notesEditor),ribbonContainer:(0,K.Zq)("ribbon-container",e.ribbonContainer)})));class Kd{getEditorRef(){return this.editorRef}getName(){return"RoosterGetEditorRefPlugin"}initialize(e){this.editorRef=e}dispose(){this.editorRef=null}onPluginEvent(e){}constructor(){this.editorRef=null}}class Gd{getName(){return"RoosterBlockImagePastePlugin"}initialize(e){}dispose(){}onPluginEvent(e){e.eventType===_d.BeforePaste&&(e.clipboardData.image=null,this.searchAndRemoveImages(e.fragment),e.clipboardData.html&&(e.clipboardData.html=e.clipboardData.html.replace(/<img[^>]*>/g,"")))}searchAndRemoveImages(e){const t=e.childNodes;for(let n=0;n<t.length;n++)this.isChildNodeAnImage(t[n])?e.removeChild(t[n]):this.searchAndRemoveImages(t[n])}isChildNodeAnImage(e){return null!=e&&null!=e.nodeName&&"img"===e.nodeName.toLowerCase()}}class qd{getName(){return"RoosterBlockDnDPlugin"}initialize(e){e.addDomEventHandler("drop",(e=>{e.preventDefault()}))}dispose(){}onPluginEvent(e){}}class Vd{setMaxLength(e){this.maxLength=e}getName(){return"RoosterContentLimitPlugin"}initialize(e){this.editorRef=e}dispose(){this.editorRef=null,this.maxLength=null}onPluginEvent(e){switch(e.eventType){case _d.BeforePaste:this.handleBeforePasteEvent(e);break;case _d.KeyPress:this.handleKeyPressEvent(e)}}handleBeforePasteEvent(e){if(null==this.maxLength||null==this.editorRef)return;const t=this.editorRef.getContent().length||0;let n=0;if(e.clipboardData.html?n=e.clipboardData.html.length:e.clipboardData.text&&(n=e.clipboardData.text.length),n+t>this.maxLength)for(;null!==(o=e.fragment)&&void 0!==o&&o.firstChild;){var o;e.fragment.removeChild(e.fragment.firstChild)}}handleKeyPressEvent(e){var t;if(null==this.maxLength||null==this.editorRef)return;((null===(t=this.editorRef)||void 0===t||null===(t=t.getContent())||void 0===t?void 0:t.length)||0)>=this.maxLength&&e.rawEvent.preventDefault()}constructor(e){this.editorRef=null,this.maxLength=null,this.maxLength=e}}class Zd extends d.${name(){return"RichTextEditor"}componentDidUpdate(e){const t=this.getEditorRefPlugin.getEditorRef();if(t&&this.props.autoFocus&&t.focus(),e.value!==this.props.value){if(this.state.isEditorExpanded&&!this.props.disableCollapseExpanBehavior&&this.setState({isEditorExpanded:!1}),t&&!this.props.lockContent){this.ignoreNextNotesContentChangedEvent=!0;const e=t.getSelectionRange(),i=null===e||void 0===e?void 0:e.startOffset;if(t.setContent(Od.Jp.sanitizeHtml(this.props.value||Zd.LineBreak)),this.state.isFocusOnEditor)try{var n;const t=null===e||void 0===e||null===(n=e.startContainer)||void 0===n||null===(n=n.firstChild)||void 0===n?void 0:n.firstChild;t&&null!=i&&e&&e.setStart(t,this.getUpdatedCursorPosition(t,i))}catch(o){this.logError("error updating notes cursor position",o)}}if(this.notesEditorWrapperRef.current){const e=this.isEditorContentOverflownVertically();this.state.contentExceedsPreview!==e&&this.setState({contentExceedsPreview:e})}}}componentDidMount(){setTimeout((()=>{this.isEditorContentOverflownVertically()&&this.setState({contentExceedsPreview:!0})}),0);const e=this.getEditorRefPlugin.getEditorRef();e&&this.props.autoFocus&&e.focus()}renderComponent(){const{ariaLabelContent:e,isReadOnly:t,enableContentSanitization:n,value:o,darkTheme:i}=this.props,r=this.getClassNames();return c.createElement("div",{className:r.root},c.createElement(Fd.E,null,c.createElement("label",{id:"notes-label"},e)),c.createElement("div",{className:r.editorWrapper,ref:this.notesEditorWrapperRef},this.props.isReadOnly?c.createElement("div",{"aria-labelledby":"notes-label",className:(0,I.A)(r.notesEditor,"read-only"),dangerouslySetInnerHTML:{__html:o?this.sanitizeContent(o).replace(/href/g,'target="_blank" href'):this.props.placeholder}}):c.createElement(c.Fragment,null,c.createElement(Bd.pl,{"aria-labelledby":"notes-label",className:r.notesEditor,dir:(0,So.jI)()?"rtl":"ltr",contentEditable:!t,plugins:this.roosterPlugins,initialContent:n?o&&this.sanitizeContent(o):o,onFocus:this.onNotesFocus,onBlur:this.onNotesBlur.bind(this),inDarkMode:i,getDarkColor:Md.a}),this.renderRibbonButtons())),this.renderNotesShowButton())}initializeRichTextEditorPlugins(){const{initializeUpdateContentPlugin:e,initializeWatermarkPlugin:t,initializeBlockImagePastePlugin:n,initializeBlockDnDPlugin:o,initializeContentLimitPlugin:i,initializeEmojiPlugin:r,initializeHyperLinkPlugin:a,initializeContentEditPlugin:s,initializePasteContentPlugin:l,initializeRibbonPlugin:c}=this.props;c&&(this.ribbonPlugin=(0,Bd.uD)(),this.roosterPlugins.push(this.ribbonPlugin)),r&&this.roosterPlugins.push((0,Bd.Ag)()),e&&this.roosterPlugins.push((0,Bd.Qi)(Bd.nu.OnDispose,(e=>{this.ignoreNextNotesContentChangedEvent?this.ignoreNextNotesContentChangedEvent=!1:this.props.onChange(e)}))),l&&this.roosterPlugins.push(new Nd.mk),t&&this.roosterPlugins.push(new Nd.nz(this.props.placeholder)),a&&this.roosterPlugins.push(new Nd.pK(void 0,"_blank",this.onLinkClick)),s&&this.roosterPlugins.push(new Nd.KH),n&&this.roosterPlugins.push(new Gd),o&&this.roosterPlugins.push(new qd),i&&this.roosterPlugins.push(new Vd(this.props.maxLength)),this.getEditorRefPlugin=new Kd,this.roosterPlugins.push(this.getEditorRefPlugin)}sanitizeContent(e){const t=new dn.tR;return t.inputString=e,dn.xC.sanitize(t)}getStyles(){const{isReadOnly:e,styles:t}=this.props,n=!this.state.isFocusOnEditor&&!this.state.isEditorExpanded&&!this.props.disableCollapseExpanBehavior,o=!this.state.isFocusOnEditor&&!this.state.isEditorExpanded&&this.state.contentExceedsPreview&&!this.props.disableCollapseExpanBehavior,i=this.state.isFocusOnEditor,r=null!==e&&void 0!==e&&e,a=this.getStyleProps(r,n,o,i);return Ud(a,t)}getClassNames(){return Wd(this.getStyles())}constructor(e,t){super(e,t),this.roosterPlugins=[],this.ignoreNextNotesContentChangedEvent=!1,this.notesEditorWrapperRef=c.createRef(),this.noteEditorRibbonRef=c.createRef(),this.getUpdatedCursorPosition=(e,t)=>{var n;return t>(null===e||void 0===e||null===(n=e.textContent)||void 0===n?void 0:n.length)&&(t=e.textContent.length),t},this.isEditorContentOverflownVertically=()=>{var e,t;const n=this.props.previewMaxHeight?Number(this.props.previewMaxHeight):Zd.PreviewMaxHeightPx;return!!((null!==(e=null===(t=this.notesEditorWrapperRef)||void 0===t||null===(t=t.current)||void 0===t||null===(t=t.firstElementChild)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:-1)>n)},this.renderNotesShowButton=()=>{if(this.state.isFocusOnEditor||!this.state.contentExceedsPreview||this.props.disableCollapseExpanBehavior)return null;const e=this.getClassNames();return c.createElement("button",{className:e.expandNotesButton,onClick:this.onNotesViewChange},this.state.isEditorExpanded?this.props.showLessString:this.props.showMoreString)},this.renderRibbonButtons=()=>{if(!this.props.initializeRibbonPlugin)return null;const e=this.getClassNames();return c.createElement("div",{ref:this.noteEditorRibbonRef,className:e.ribbonContainer},this.state.showRibbon&&c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(Hd,{plugin:this.ribbonPlugin,plannerTheme:this.props.theme})))},this.onLinkClick=(e,t)=>{let n;if((n=function(e){try{return e?e.href:null}catch{return null}}(e))&&0===t.button){t.preventDefault();try{return Tc.b.safelyOpenExternalUrl(n,"_blank"),!0}catch{return!1}}return!1},this.onNotesViewChange=e=>{this.props.onMiscUserAction(),this.props.disableCollapseExpanBehavior||this.setState({isEditorExpanded:!this.state.isEditorExpanded})},this.onNotesFocus=e=>{var t,n;null===(t=(n=this.props).onFocus)||void 0===t||t.call(n,e),this.setState({isFocusOnEditor:!0,showRibbon:!0})},this.onNotesBlur=e=>{var t,n,o,i;const r=this.getEditorRefPlugin.getEditorRef();let a="";var s;r&&(a=r.getContent(),0===(null===(s=r.getContent())||void 0===s||null===(s=s.trim())||void 0===s?void 0:s.length)&&(a=Zd.LineBreak));const l=r?a:Zd.LineBreak;null===(t=(n=this.props).onBlur)||void 0===t||t.call(n,e,l),null!==(o=this.noteEditorRibbonRef.current)&&void 0!==o&&o.contains(e.relatedTarget)||this.setState({showRibbon:!1}),null!==(i=this.notesEditorWrapperRef)&&void 0!==i&&null!==(i=i.current)&&void 0!==i&&i.firstElementChild&&this.setState({isFocusOnEditor:!1,contentExceedsPreview:this.isEditorContentOverflownVertically()})},this.getStyleProps=(0,G.J9)(((e,t,n,o)=>({readOnly:e,preview:t,moreContent:n,isFocused:o}))),this.state={isFocusOnEditor:!1,isEditorExpanded:!1,contentExceedsPreview:!1,showRibbon:!1},this.initializeRichTextEditorPlugins()}}Zd.PreviewMaxHeightPx=100,Zd.LineBreak="<br>";var Yd=n(8480),Xd=n(12211);const $d="24px",Jd=(0,G.J9)(((e,t)=>{const n={root:[we.xK,(0,we.gS)(),{alignItems:"center",marginBottom:"32px"}],externalContextIcon:[(0,we.$Z)(),{height:$d,width:$d}],externalContextLinkLabel:[(0,we.Ib)(e),(0,we.$Z)(),{marginLeft:"15px",cursor:"pointer",":hover":{textDecoration:"underline"}}]};return(0,K.TW)(n,t)})),Qd=(0,G.J9)((e=>({root:(0,K.Zq)("openExternalLinkedContextSection",e.root),externalContextIcon:(0,K.Zq)("externalContextIcon",e.externalContextIcon),externalContextLinkLabel:(0,K.Zq)("linkLabel",e.externalContextLinkLabel)})));var eu=n(87424),tu=n.n(eu),nu=n(81877);class ou extends d.${name(){return"ExternalContextLink"}renderComponent(){const{plan:e,planDetails:t}=this.props,n=this.getExternalContextKey(e,He.s.MeetingNotes),o=this.getExternalContextKey(e,He.s.LoopPage);if(!n&&!o)return null;let i,r;if(n)i=e.contexts[n],r=t.contextDetails[n];else{if(!o)return null;i=e.contexts[o],r=t.contextDetails[o]}const a=this.getExternalContextLinkProperties(i,r.displayAs);if(!a)return null;const s=this.getClassNames(),l=c.createElement("img",{src:a.svg,className:s.externalContextIcon,alt:ht.p.Strings.TaskEditor_ExternalContextIconTitle,title:ht.p.Strings.TaskEditor_ExternalContextIconTitle}),d=c.createElement("span",{className:s.externalContextLinkLabel},a.linkLabel);return c.createElement("button",{className:s.root,"aria-label":a.ariaLabel,onClick:e=>this.openExternalContextLink(e,a.webUrl),onKeyUp:e=>this.openExternalContextLink(e,a.webUrl)},l,d)}getExternalContextLinkProperties(e,t){var n,o;let i,r,a;switch(t){case He.s.MeetingNotes:a=Xd.A,i=ht.p.Strings.PlanContextLinking_MeetingNotes,r=dt.G(ht.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,ht.p.Strings.PlanContextLinking_MeetingNotes,ht.p.Strings.PlanContextLinking_MicrosoftLoop);break;case He.s.LoopPage:a=Xd.A,i=ht.p.Strings.PlanContextLinking_MicrosoftLoop,r=dt.G(ht.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,(0,nu.C)(e,null!==(n=null===(o=this.props.planContainer)||void 0===o?void 0:o.displayName)&&void 0!==n?n:""),ht.p.Strings.PlanContextLinking_MicrosoftLoop);break;default:return null}return{linkLabel:i,ariaLabel:r,svg:a,webUrl:this.getExternalContextLinkUrl(this.props.plan,t)}}getExternalContextLinkUrl(e,t){var n;const{planDetails:o}=this.props,i=this.getExternalContextKey(e,t);return i&&null!==(n=o.contextDetails[i].url)&&void 0!==n?n:null}getExternalContextKey(e,t){const{planDetails:n}=this.props;if(st()(e.contexts)||!n)return null;const o=Object.keys(e.contexts),i=tu()(o,[t=>e.contexts[t].createdDate],[t=>e.contexts[t].ownerAppId]),r=ot()(i,(e=>{const o=n.contextDetails[e];return null!=o&&o.displayAs===t}));return-1===r?null:i[r]}getClassNames(){return Qd(Jd(this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.openExternalContextLink=(e,t)=>{t&&Vs.a.isButtonPress(e)&&(this.context.usageLogger.logData(this.name(),Mt.M.TaskDetailsExternalContextLinkClicked),e.preventDefault(),Tc.b.safelyOpenExternalUrl(t,"_blank"))}}}var iu=n(89654),ru=n(8453),au=n(46530),su=n(51904),lu=n(3831);const cu="24px",du="externalUrl",uu=(0,G.J9)(((e,t,n)=>{const o=Pt.d.isLoopTheme(t),i=Pt.d.getTeamsMessageColor(t,e),r=Pt.d.getLoopColor(t,e),a=Pt.d.getMeetingNotesColor(t,e),s=Pt.d.getWordColor(t,e),l=Pt.d.getExcelColor(t,e),c=Pt.d.getPowerPointColor(t,e),d=Pt.d.getProjectColor(t,e);let u="center";switch(t){case m.Sx.LoopLight:case m.Sx.LoopDark:u="flex-start"}const p={root:[(0,we.gS)(),{alignItems:u,["> .".concat(du,".teamsColor")]:{color:i},["> .".concat(du,".loopColor")]:{color:r},["> .".concat(du,".meetingNotesColor")]:{color:a},["> .".concat(du,".wordColor")]:{color:s},["> .".concat(du,".excelColor")]:{color:l},["> .".concat(du,".powerPointColor")]:{color:c},["> .".concat(du,".projectColor")]:{color:d}}],externalSourceContentLeft:[(0,we.GD)("auto")],externalSourceHeader:[(0,we.gS)(),{alignItems:"center",fontSize:kt.s.medium,marginBottom:"8px"}],externalSourceSubHeader:[(0,we.Ml)(t)],externalSourceIcon:{marginRight:"8px",height:cu,width:cu},externalUrl:[(0,we.gS)(),{fontSize:kt.s.medium,fontWeight:kt.BO.semibold,alignItems:"center",textDecoration:"none","> i":{marginLeft:"8px"},"&:hover":[o&&(0,_e.cP)(),{textDecoration:"none"}]},o&&[(0,we.i9)(t),(0,_e.lX)({border:"1px solid !important"}),{"> i":{display:"none"},borderRadius:"4px",padding:"2px 12px",fontWeight:kt.BO.regular}]]};return(0,K.TW)(p,n)})),pu=(0,G.J9)((e=>({root:(0,K.Zq)("externalSourceContainer",e.root),externalSourceContentLeft:(0,K.Zq)("externalSourceContentLeft",e.externalSourceContentLeft),externalSourceHeader:(0,K.Zq)("externalSourceHeader",e.externalSourceHeader),externalSourceSubHeader:(0,K.Zq)("externalSourceSubHeader",e.externalSourceSubHeader),externalSourceIcon:(0,K.Zq)("externalSourceIcon",e.externalSourceIcon),externalUrl:(0,K.Zq)(du,e.externalUrl)})));class hu extends d.${name(){return"ExternalSourceView"}renderComponent(){var e;const{task:t,getUserById:n}=this.props,o=t.creationSource.external;if(null==t.creationSource.document&&(null==o||o.displayAs===iu.c.None))return null;let i=null;null!=t.creationSource.document?i=this.getDocumentTaskExternalSourceViewProperties():null!=o&&(i=this.getTaskExternalSourceViewProperties(o,t.isProjectTask()));const r=(null!==(e=n(t.createdBy))&&void 0!==e?e:au._.getUnknownUser(t.createdBy)).formattedDisplayName,a=i&&dt.G(ht.p.Strings.ExternalSourceView_TaskInfoSubtitle,r,t.createdDate.format("L")),s=this.getClassNames();return i&&c.createElement("div",{className:s.root},c.createElement("div",{className:s.externalSourceContentLeft},c.createElement("div",{className:s.externalSourceHeader},c.createElement("img",{src:i.svg,className:s.externalSourceIcon,alt:""}),i.titleString),c.createElement("div",{className:s.externalSourceSubHeader},a)),!t.isProjectTask()&&i.webUrl&&c.createElement(f.N,{className:(0,I.A)(s.externalUrl,i.linkColorClass),href:i.webUrl,target:"_blank","aria-label":ht.p.Strings.ExternalSourceView_LinkAriaLabel,rel:"noopener noreferrer",onClick:this.onClickTaskDeepLink},i.buttonText,c.createElement(C.I,Ne.XL)))}getDocumentTaskExternalSourceViewProperties(){if(!this.props.plan)return null;const e=this.props.plan.title,t=wc.Y.GetFileType(e);return{titleString:e,svg:(0,Fc.fP)(t),buttonText:ht.p.Strings.ExternalSourceView_Navigate,linkColorClass:(0,pt.Wo)(t),webUrl:"https://www.office.com"}}getTaskExternalSourceViewProperties(e,t){const{plan:n}=this.props;let o=e.getSyncContextDisplayText();const i=t?ht.p.Strings.ExternalSourceView_GoToTask:ht.p.Strings.ExternalSourceView_Navigate;let r,a;switch(e.contextScenarioId){case ru.z.meetingNotes:case ru.z.loop:r=Xd.A,a="loopColor";break;case ru.z.teamsMessage:r=su.A,a="teamsColor";break;case ru.z.project:if(null===n||void 0===n||!n.title)return null;o=n.title,r=Xr,a="projectColor";break;default:r=lu.A,a=""}return{titleString:o,svg:r,buttonText:i,linkColorClass:a,webUrl:null===e||void 0===e?void 0:e.webUrl}}getClassNames(){return pu(uu(this.context.traceLogger,this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.onClickTaskDeepLink=()=>{this.logUsage(Mt.M.TaskDeepLinkClicked,{taskCreationSourceType:this.props.task.taskCreationSourceType})}}}var mu,gu=n(13862),fu=n(23312),vu=n(27805),bu=n(11079);!function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableMandatoryToggle=1]="DisableMandatoryToggle",e[e.HideMandatoryToggle=2]="HideMandatoryToggle"}(mu||(mu={}));var yu=n(40468),Cu=n(34648),Su=n(24723),ku=n(67868),Du=n(68501),xu=n(62687),Tu=n(37535),Eu=n(95237),wu=n(98352);const _u=(0,G.J9)((e=>()=>({root:(0,we.dg)(e),subComponentStyles:{callout:{calloutMain:(0,we.aS)(e)},textField:(0,wu.pS)(e,Fe.u.Dialog)}}))),Iu="15px",Pu=(0,G.J9)((e=>t=>{const{isActive:n}=t;return{labelPicker:[(0,we.nK)(e),e!==m.Sx.TeamsContrast&&{borderColor:"transparent"},{":hover":(0,we.wA)(e)},n?(0,we.oO)(e):{backgroundColor:"transparent",borderColor:"transparent"}],searchBoxWrapper:{"> input":[(0,we.Oj)(e),(0,we.Ib)(e)]},addLabel:(0,we.Ib)(e),labelPickerSuggestions:[(0,we.NX)(e),(0,we.Ss)(e),{".ms-Suggestions-item.is-suggested":[(0,we.zK)(e),e===m.Sx.TeamsContrast&&{backgroundColor:Te.z.HighContrastYellow}]}],subComponentStyles:{editableLabel:Au(e)}}})),Au=e=>t=>{const{showEditButton:n}=t,o=Pt.d.isLoopTheme(e);return{root:n&&{":hover":[(0,we.wA)(e),e===m.Sx.TeamsLight&&{backgroundColor:Te.z.TeamsHoverBackgroundColor},(0,_e.lX)({svg:{color:Ee.B.Window}})],".is-suggested &":[(0,_e.lX)({svg:{color:Ee.B.Window}})]},editableLabel:[e===m.Sx.TeamsContrast&&{backgroundColor:"".concat(Te.z.Black," !important"),borderColor:"".concat(Te.z.White," !important"),":hover":{borderColor:"".concat(Te.z.HighContrastYellow," !important")}},o&&{borderRadius:Iu},(0,_e.lX)({backgroundColor:"".concat(Ee.B.Window," !important"),color:Ee.B.WindowText})],editableLabelInner:{"> .removeButton":e===m.Sx.TeamsContrast&&{backgroundColor:"".concat(Te.z.Black," !important"),i:{color:"".concat(Te.z.White," !important")},":hover":{backgroundColor:"".concat(Te.z.HighContrastYellow," !important"),i:{color:"".concat(Te.z.Black," !important")}}}},editableLabelText:e===m.Sx.TeamsContrast&&{color:Te.z.White},editLabelButton:[(0,we.gS)(),we.cc,{i:[(0,we.aS)(e),{width:"16px"}],":hover":[(0,we.zK)(e),{i:(0,we.zK)(e)}]},e===m.Sx.TeamsContrast&&{".is-suggested &":{i:{color:Te.z.Black}}},o&&{":hover":{borderRadius:Iu}}]}};var Ru=n(2908),Lu=n(14740),Nu=n.n(Lu),Mu=n(69108),Ou=n.n(Mu),Bu=n(35640),Fu=n.n(Bu),ju=n(26727),Hu=n.n(ju),zu=n(75314),Uu=n(86780),Wu=n(71683),Ku=n(30210),Gu=n(38780),qu=n(70995);var Vu,Zu;!function(e){e[e.Checklist=0]="Checklist",e[e.Description=1]="Description",e[e.Attachment=2]="Attachment"}(Vu||(Vu={})),function(e){e[e.None=0]="None",e[e.ChecklistCompleted=1]="ChecklistCompleted",e[e.ChecklistNotCompleted=2]="ChecklistNotCompleted",e[e.ChecklistDisabled=3]="ChecklistDisabled"}(Zu||(Zu={}));class Yu extends d.${componentDidMount(){const{plan:e,planDetails:t}=this.props;e&&t&&this.logUserAccessEditorOpen(e,t)}componentDidUpdate(e){var t,n;const{plan:o,planDetails:i,taskDetails:r,config:a,task:s}=this.props;if(null==i||null==o)return;(null==e.plan||null==e.planDetails||null!=e.plan&&null!=o&&e.plan.id!==o.id)&&this.logUserAccessEditorOpen(o,i),e.task.title!==this.props.task.title&&this.setState((e=>({updatedTitle:this.props.task.title})));const l=a.enableRichTextEditor?(null===(t=e.taskDetails)||void 0===t?void 0:t.notes)!==(null===r||void 0===r?void 0:r.notes):(null===(n=e.taskDetails)||void 0===n?void 0:n.description)!==(null===r||void 0===r?void 0:r.description);if(null!=r&&l&&!this.state.showDescEditMode&&this.setState((()=>{var e;return{updatedNotesContent:null===(e=r.notes)||void 0===e?void 0:e.content,updatedDescription:r.description,descriptionWithHyperlinks:r.description?(0,Wu.o)(r.description):null}})),r&&(0,zu.o4)(s,r)){const t=!!e.taskDetails&&(0,zu.iE)(e.task,e.taskDetails),n=!!r&&(0,zu.iE)(s,r);n&&t!==n&&this.setState({isCompletionRequirementsInfoCalloutVisible:!0})}}showStartDate(e,t){return t!==Su.YC.SharedConsumer&&(e.enableExtraFieldsForPersonalTasks||t!==Su.YC.Personal)}showProgress(e,t){return e===Su.YC.Shared||t.enableExtraFieldsForPersonalTasks&&e===Su.YC.Personal}name(){return"TaskEditor"}renderComponent(){const{task:e,plan:t,callbacks:n,config:o}=this.props,i=this.getClassNames();return c.createElement("div",{className:i.root,onKeyDown:this.stopPropagation},c.createElement("div",{className:"removeMargin"},this.renderPlanLink(t,i),this.renderTaskTitleRow(e,i),this.renderLastModifiedSection(e,i),this.renderOpenExternalLinkedContextSection(t,i),this.renderExternalSourceSection(),this.renderMessageBanner(e,i),this.renderAssignmentSection(i),this.renderLabelPicker(i),this.renderFieldDropDownsSection(i),o.enableRichTextEditor?this.renderRichTextEditor(i):this.renderDescriptionSection(i),this.renderChecklistSection(i),this.renderMissingFieldsMessageBar(e),this.renderFunctionalityWarnings(),this.renderAttachments(),this.renderRequirementsSection(),this.renderCommentsSection(i),this.renderFileSuggestionsSection(i),n.renderOnedrivePicker(),n.renderCustomRecurrenceDialog(),n.renderAddFormRequirementDialog(),n.renderRemoveFormConfirmationDialog(),n.renderFormResponseViewDialog(),n.renderEditFormDialog(),n.renderCheckUnsavedApprovalDialog()))}renderMissingFieldsMessageBar(e){return e.kind===Su.YC.Personal&&this.props.config.enableMissingFieldsMessageForPersonalTasks?c.createElement("div",{className:"messageBarWrapper",role:"status"},c.createElement(Vc.n,{role:"none"},dt.G(ht.p.Strings.TaskEditor_PersonalTasksMissingFieldsMessageText,ht.p.Strings.SharedComponents_ToDoAppTitle),c.createElement(f.N,{href:m.$j.missingFields},"Learn more."))):null}renderFieldDropDownsSection(e){const{task:t,bucket:n,callbacks:o}=this.props,{permissions:i}=this.props.config,r=o.convertPercentCompleteToProgressState(t.percentComplete),a=o.convertPriorityToPriorityName(t.priority),s={months:Hn().months(),shortMonths:Hn().monthsShort(),days:Hn().weekdays(),shortDays:Hn().weekdaysShort(),goToToday:ht.p.Strings.SharedComponents_CalendarPickerTodayLabel,prevMonthAriaLabel:ht.p.Strings.SharedComponents_PrevMonthAriaLabel,nextMonthAriaLabel:ht.p.Strings.SharedComponents_NextMonthAriaLabel,prevYearAriaLabel:ht.p.Strings.SharedComponents_PrevYearAriaLabel,nextYearAriaLabel:ht.p.Strings.SharedComponents_NextYearAriaLabel,invalidInputErrorMessage:ht.p.Strings.SharedComponents_InvalidDateErrorMessage,prevYearRangeAriaLabel:ht.p.Strings.SharedComponents_PrevYearRangeAriaLabel,nextYearRangeAriaLabel:ht.p.Strings.SharedComponents_NextYearRangeAriaLabel};let l;return n&&(l=n.title),c.createElement("div",{className:e.dropdowns},c.createElement("div",{className:"removeMargin"},(t.kind!==Su.YC.Personal||this.props.config.enableExtraFieldsForPersonalTasks)&&t.kind!==Su.YC.SharedConsumer&&c.createElement("div",{className:"dropdownTuple",title:l},c.createElement(Jl.t,{className:"taskBucket",title:i.canUpdateBucket?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,label:ht.p.Strings.TaskEditor_TaskBucketLabel,options:this.getBucketList(),onChange:(e,t)=>{this.onBucketChanged(t)},selectedKey:t.bucketId||"",onRenderOption:n=>c.createElement("div",{className:(0,I.A)("taskEditor_taskBucketItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"textValue"},n.text),c.createElement("div",{className:"indicator"},n.key===t.bucketId||""===n.key&&null==t.bucketId?c.createElement(C.I,Ne.r8):null))),disabled:!i.canEdit||!i.canUpdateBucket,debounceInterval:Yu.debounceDropdownTaskUpdateInterval,appTheme:this.props.theme})),this.showProgress(t.kind,this.props.config)&&c.createElement("div",{className:"dropdownTuple",title:o.convertPercentCompleteToProgressText(t.percentComplete)},c.createElement(Jl.t,{className:"taskProgress",label:ht.p.Strings.TaskEditor_TaskProgressLabel,title:i.canUpdateProgress?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,options:this.getProgressList(t),onChange:(e,t)=>{this.onProgressChanged(t)},selectedKey:r,onRenderTitle:t=>{const n=t[0],o=(0,Fc.Nu)(this.context.traceLogger,this.props.theme,ll.$[n.key]);return c.createElement("div",{className:(0,I.A)("taskEditor_taskProgressItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"icon"},c.createElement(C.I,o)),c.createElement("div",{className:"textValue"},n.text)))},onRenderOption:t=>{const n=(0,Fc.Nu)(this.context.traceLogger,this.props.theme,ll.$[t.key]);return c.createElement("div",{className:(0,I.A)("taskEditor_taskProgressItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"icon"},c.createElement(C.I,n)),c.createElement("div",{className:"textValue"},t.text),c.createElement("div",{className:"indicator"},t.key===r?c.createElement(C.I,Ne.r8):null)))},disabled:!i.canUpdateProgress,debounceInterval:Yu.debounceDropdownTaskUpdateInterval,appTheme:this.props.theme})),c.createElement("div",{className:"dropdownTuple",title:o.convertPriorityToPriorityText(t.priority)},c.createElement(Jl.t,{className:"taskPriority",title:i.canUpdatePriority?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,label:ht.p.Strings.Task_PriorityFieldText,options:this.getPriorityList(t),onChange:(e,t)=>{this.onPriorityChanged(t)},selectedKey:a,onRenderTitle:t=>{const n=t[0],o=this.getPriorityIconProps(Su.gy[n.key]);return c.createElement("div",{className:(0,I.A)("taskEditor_taskPriorityItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"icon"},c.createElement(C.I,o)),c.createElement("div",{className:"textValue"},n.text)))},onRenderOption:t=>{const n=this.getPriorityIconProps(Su.gy[t.key]);return c.createElement("div",{className:(0,I.A)("taskEditor_taskPriorityItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"icon"},c.createElement(C.I,n)),c.createElement("div",{className:"textValue"},t.text),c.createElement("div",{className:"indicator"},t.key===a?c.createElement(C.I,Ne.r8):null)))},disabled:!i.canEdit||!i.canUpdatePriority,debounceInterval:Yu.debounceDropdownTaskUpdateInterval,appTheme:this.props.theme})),this.showStartDate(this.props.config,t.kind)&&c.createElement("div",{className:"dropdownTuple",title:null==t.startDate?ht.p.Strings.TaskEditor_TaskStartDatePlaceholder:void 0},c.createElement(Yl,{calloutProps:{ariaLabel:ht.p.Strings.TaskEditor_SelectStartDateAriaLabel},label:ht.p.Strings.TaskEditor_TaskStartDateLabel,title:i.canUpdateStartDate?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,isMonthPickerVisible:!0,onSelectDate:this.onStartDateChanged,placeholder:null==t.startDate?ht.p.Strings.TaskEditor_TaskStartDatePlaceholder:"",strings:s,value:null==t.startDate?void 0:t.startDate.toDate(),formatDate:Kn.lz.FormatJSDateLongForm,parseDateFromString:Kn.lz.ParseDateFromString,ariaLabel:null==t.startDate?ht.p.Strings.TaskEditor_TaskStartDateLabel:void 0,allowTextInput:!0,borderless:!0,today:new Date,firstDayOfWeek:Hn().localeData().firstDayOfWeek(),disabled:!i.canEdit||!i.canUpdateStartDate,appTheme:this.props.theme})),c.createElement("div",{className:"dropdownTuple",title:null==t.dueDate?ht.p.Strings.TaskEditor_TaskEndDatePlaceholder:void 0},c.createElement(Yl,{calloutProps:{ariaLabel:ht.p.Strings.TaskEditor_SelectEndDateAriaLabel},label:ht.p.Strings.TaskEditor_TaskEndDateLabel,title:i.canUpdateDueDate?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,isMonthPickerVisible:!0,onSelectDate:this.onEndDateChanged,placeholder:null==t.dueDate?ht.p.Strings.TaskEditor_TaskEndDatePlaceholder:"",strings:s,value:null==t.dueDate?void 0:t.dueDate.toDate(),formatDate:Kn.lz.FormatJSDateLongForm,parseDateFromString:Kn.lz.ParseDateFromString,ariaLabel:null==t.dueDate?ht.p.Strings.TaskEditor_TaskEndDateLabel:void 0,allowTextInput:!0,borderless:!0,today:new Date,firstDayOfWeek:Hn().localeData().firstDayOfWeek(),disabled:!i.canEdit||!i.canUpdateDueDate,appTheme:this.props.theme})),t.kind!==Su.YC.Personal&&t.kind!==Su.YC.SharedConsumer&&!(t.kind===Su.YC.Shared&&this.props.config.enableRecurringTasks)&&c.createElement("div",{className:"dropdownTuple"}),t.kind===Su.YC.Template&&c.createElement("div",{className:"dropdownTuple"}),this.renderTaskRecurrenceDropdown(e)))}renderAssignmentSection(e){const{task:t,callbacks:n,config:o}=this.props;if(t.kind!==Su.YC.Shared&&t.kind!==Su.YC.SharedConsumer)return null;const i=n.renderAssignmentControl(o.permissions,o.containerPermissions);return c.createElement("div",{className:(0,I.A)(e.assignedToUsers,"passiveAlt_0"),ref:this.resolveRef(this,"assignedToUsers")},i)}renderExternalSourceSection(){return c.createElement(hu,{task:this.props.task,plan:this.props.plan,theme:this.props.theme,getUserById:this.props.callbacks.getUserById})}renderOpenExternalLinkedContextSection(e,t){const{planDetails:n,task:o,theme:i,container:r}=this.props;return(0,Ku.Z)(e,n)&&st()(o.creationSource.external)&&e&&n&&!o.isProjectTask()?c.createElement(ou,{plan:e,planDetails:n,theme:i,planContainer:r}):null}renderLabelPicker(e){const{planDetails:t,planLabelCounts:n,task:o,config:i,theme:r}=this.props;return null!==t&&void 0!==t&&t.categories?o.kind===Su.YC.Personal||o.kind===Su.YC.SharedConsumer?null:c.createElement("div",{className:e.labelPickerArea},c.createElement(C.I,{...Ne.Oi,title:ht.p.Strings.TaskEditor_LabelTooltip}),c.createElement(ss,{appliedLabels:o.appliedCategories,editableLabelStrings:{addLabelTooltip:ht.p.Strings.EditableLabel_AddLabelTooltip,editButtonAriaLabel:ht.p.Strings.EditableLabel_EditButtonAriaLabel,editLabelButtonAriaLabel:ht.p.Strings.EditableLabel_EditLabelButtonAriaLabel,editLabelTooltip:ht.p.Strings.EditableLabel_EditLabelTooltipText,removeButtonAriaLabel:ht.p.Strings.EditableLabel_RemoveButtonAriaLabel},labelEditorStrings:{editLabel:ht.p.Strings.LabelEditor_EditLabel,editLabelNameAriaLabel:ht.p.Strings.LabelEditor_EditLabelNameAriaLabel},labelPickerStrings:{addLabel:ht.p.Strings.LabelPicker_AddLabel,allLabelsAdded:ht.p.Strings.LabelPicker_AllLabelsAdded,noResultsFound:ht.p.Strings.LabelPicker_NoResultsFound,searchForLabel:ht.p.Strings.LabelPicker_SearchForLabel,searchForLabelAriaLabel:ht.p.Strings.LabelPicker_SearchForLabelAriaLabel},labels:Gu.U.getILabelArray(t.categories,n),onChangeLabelName:this.onChangeLabelName,onChangeSelection:this.onChangeCategorySelection,isReadOnly:!i.permissions.canUpdateAppliedLabels,styles:Pu(r),labelEditorStyles:_u(r),editableLabelIcons:{edit:Ne.qz,cancel:Ne.s5}})):null}renderCommentsSection(e){const{task:t,config:n}=this.props;if(!n.enableComments)return null;if(t.kind!==Su.YC.Shared)return null;const o=this.props.callbacks.renderCommentThreadViewControl(n.permissions,5);return c.createElement("div",{className:e.commentsSection},o)}renderFunctionalityWarnings(){const{plan:e}=this.props;return null==e?null:e.container.containerType===je.K.Roster?c.createElement("div",{className:"functionalityWarning"},c.createElement(Vc.n,{messageBarType:ls.H.info,isMultiline:!0,styles:(0,pn.qw)(this.props.theme)},ht.p.Strings.TaskEditor_FunctionalityWarning,c.createElement(f.N,{href:m.$j.lightWeightPlans,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.SharedComponents_LearnMoreLink))):null}renderFileSuggestionsSection(e){const{callbacks:t,config:n,fileSuggestions:o,fileSuggestionsContainerRef:i,task:r}=this.props;return!n.enableFileSuggestions||(0,bu.L)(n.permissions.attachmentPermissions,bu.I.DisableUpdateAttachments)||r.kind!==Su.YC.Shared?null:c.createElement("div",{ref:i,className:e.fileSuggestionsSection},!st()(o)&&c.createElement(vs.pL,{onChange:this.onFileSuggestionIntersection,triggerOnce:!0},c.createElement("div",{className:"file-suggestions-intersection-anchor"})),c.createElement(Gc,{entityId:r.id,recommendedFiles:o,maxFileSuggestions:n.limits.maxFileSuggestions,onAdd:t.onAddSuggestionAsAttachment,copyLinkToSuggestion:t.copyLinkToSuggestion,onOpenContextMenu:t.onOpenFileSuggestionContextMenu,theme:this.props.theme}))}renderTaskTitleRow(e,t){const{limits:n,permissions:o}=this.props.config,i=(0,I.A)(t.taskTitle,{completed:e.isComplete()});return c.createElement("div",{className:i,id:"taskDetailsTitleSectionId"},this.renderCompleteButton(e.isComplete(),t),c.createElement(Be.A,{autoFocus:!1,title:o.canEditTitle?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,className:"edit",placeholder:ht.p.Strings.TaskEditor_TaskNamePlaceholder,maxLength:n.maxTitleLength,value:this.state.updatedTitle,onChange:(e,t)=>{this.onTitleChanged(t)},onKeyUp:this.taskTitleKeyPress,onBlur:this.taskTitleUpdate,tabIndex:0,styleType:Fe.u.Title,ariaLabel:ht.p.Strings.TaskEditor_TaskNameAriaLabel,disabled:!o.canEdit||!o.canEditTitle,appTheme:this.props.theme}))}renderCompletionRequirementsInfoCallout(e){if(!this.state.isCompletionRequirementsInfoCalloutVisible)return null;const{task:t}=this.props;let n=null,o="";return t.isComplete()?(n=this.checklistAsteriskRef,o=ht.p.Strings.TaskEditor_ShowMandatoryChecklistIncompleteLabel):0===t.numberOfActiveChecklistItems?(n=this.completionRequirementCalloutRef,o=ht.p.Strings.TaskEditor_ShowCanCompleteTaskWithRequirementsInfoLabel):(n=this.completionRequirementCalloutRef,o=ht.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel),c.createElement(ds,{isBeakVisible:!0,calloutMinWidth:Ue.B.TooltipMinWidth,gapSpace:0,focusTrapProps:{isClickableOutsideFocusTrap:!0},doNotLayer:!0,target:n,setInitialFocus:!0,className:e.mandatoryChecklistInfoTooltip,onDismiss:this.toggleCompletionRequirementsInfoCallout,styles:(0,Ru.df)(this.props.theme)},c.createElement(Zc.K,{description:o}))}renderCompleteButton(e,t){const{config:n,task:o,theme:i,taskDetails:r}=this.props,a=n.enableMandatoryCheckList&&(0,zu.cl)(o),s=n.enableFormsRequirement&&(0,zu.lj)(o,r),l=n.enableApprovalsRequirement&&(0,zu.Zw)(o,r);return c.createElement("div",{ref:this.completionRequirementCalloutRef,className:t.completeIcon,id:"taskCompleteButtonId"},a||s||l?c.createElement("img",{onClick:this.toggleCompletionRequirementsInfoCallout,className:"completion-requirements-info-icon",src:qu.A,title:ht.p.Strings.TaskEditor_ShowMandatoryChecklistIncompleteLabel}):c.createElement(Ll.N,{id:"completeButton"+o.id,isTaskCompleted:e,isFocusZoneEnabled:!0,isDisabled:!n.permissions.canUpdateProgress,completeTaskButtonTabIndex:0,onButtonClick:this.onTaskCompleteClick,theme:i}))}getPriorityIconProps(e){return(0,Fc.m4)(this.context.traceLogger,this.props.theme,e)}getProgressList(e){const t=this.props.callbacks.convertPercentCompleteToProgressState(e.percentComplete),n=[];let o;return o={index:0,selected:t===ll.$.NotStarted,key:ll.$.NotStarted,text:ht.p.Strings.TaskEditor_TaskProgressState_NotStarted},n.push(o),o={index:1,selected:t===ll.$.InProgress,key:ll.$.InProgress,text:ht.p.Strings.TaskEditor_TaskProgressState_InProgress},n.push(o),e.canComplete()&&(o={index:2,selected:t===ll.$.Complete,key:ll.$.Complete,text:ht.p.Strings.TaskEditor_TaskProgressState_Completed},n.push(o)),n}getBucketList(){const{task:e,planBuckets:t}=this.props,n=[];return null==t?[]:(t.sort(((e,t)=>gl.O.compareOrderHints(t.orderHint,e.orderHint))),t.forEach(((t,o)=>{const i={index:o,selected:e.bucketId===t.id,key:t.id,text:t.title};n.push(i)})),n)}getPriorityList(e){const{callbacks:t}=this.props,{permissions:n}=this.props.config,o=t.convertPriorityToPriorityName(e.priority),i=[];let r;return e.kind!==Su.YC.Personal&&e.kind!==Su.YC.SharedConsumer?(r={index:0,disabled:!n.canUpdatePriorityToUrgent,selected:o===Su.gy.Urgent,key:Su.gy.Urgent,text:ht.p.Strings.Task_PriorityUrgentText},i.push(r),r={index:1,selected:o===Su.gy.Important,key:Su.gy.Important,text:ht.p.Strings.Task_PriorityImportantText},i.push(r),r={index:2,selected:o===Su.gy.Medium,key:Su.gy.Medium,text:ht.p.Strings.Task_PriorityMediumText},i.push(r),r={index:3,selected:o===Su.gy.Low,key:Su.gy.Low,text:ht.p.Strings.Task_PriorityLowText},i.push(r)):(r={index:0,selected:o===Su.gy.Important,key:Su.gy.Important,text:ht.p.Strings.Task_PriorityImportantText},i.push(r),r={index:1,selected:o===Su.gy.Medium,key:Su.gy.Medium,text:ht.p.Strings.Task_PriorityMediumText},i.push(r)),i}getTaskExternalSourceViewProperties(e){var t;const{plan:n}=this.props;return{titleString:null!==(t=null===n||void 0===n?void 0:n.title)&&void 0!==t?t:"",svg:Xr,buttonText:ht.p.Strings.ExternalSourceView_Navigate,linkColorClass:"projectColor",webUrl:null===e||void 0===e?void 0:e.webUrl}}renderMessageBanner(e,t){const{config:n}=this.props;if(n.enableProjectTasksForPlannerWeb&&e.isProjectTask()){var o;const n=e.creationSource.external?this.getTaskExternalSourceViewProperties(e.creationSource.external):null,i=null===n||void 0===n?void 0:n.webUrl,r=null===(o=(0,we._D)(this.props.theme))||void 0===o?void 0:o.color;return c.createElement("div",{className:t.messageBanner},c.createElement(Vc.n,{isMultiline:!0,messageBarType:ls.H.info,className:"msgBar"},ht.p.Strings.TaskEditor_ProjectTaskBannerInfo,i&&c.createElement(f.N,{href:i,target:"_blank","aria-label":ht.p.Strings.ExternalSourceView_LinkAriaLabel,rel:"noopener noreferrer",style:{color:r}},ht.p.Strings.ExternalSourceView_LinkText)))}return null}renderPlanLink(e,t){const{enablePlanTitleNavLink:n}=this.props.config,{onNavigateToPlan:o}=this.props.callbacks;return null==e?null:n&&null!=o?c.createElement("div",{className:(0,I.A)(t.planTitle,"link"),tabIndex:0,role:"link",onClick:o,onKeyDown:e=>{Vs.a.getKey(e)===h.D.ENTER&&(o(),e.preventDefault())}},e.title):c.createElement("div",{className:t.planTitle},e.title)}renderRichTextEditor(e){var t,n;const{task:o,taskDetails:i,config:r,theme:a}=this.props,{permissions:s}=this.props.config;if(null==i)return null;const l=o.kind===Su.YC.Shared&&(null===(t=i.notes)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.length)&&(null===(n=i.notes)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.length)>0,d=a===m.Sx.Dark||a===m.Sx.TeamsDark||a===m.Sx.TeamsContrast||a===m.Sx.LoopDark||a===m.Sx.LoopWorkspaceDark,u=this.state.updatedNotesContent;return c.createElement("div",{className:e.description},c.createElement("div",{className:"descriptionHeader"},c.createElement(g.J,{className:"descriptionTitle"},ht.p.Strings.TaskEditor_NotesLabel),l&&this.renderShowOnCardCheckbox(Vu.Description,i,e)),c.createElement(Zd,{darkTheme:d,enableContentSanitization:!1,value:null!==u&&void 0!==u?u:void 0,keyId:"notes",placeholder:ht.p.Strings.TaskEditor_NotesPlaceholder,ariaLabelContent:ht.p.Strings.TaskEditor_NotesLabel,maxLength:r.limits.maxDescriptionLength,autoFocus:!1,isReadOnly:!s.canEdit||!s.canEditDescription,lockContent:!1,onMiscUserAction:()=>{},onChange:this.onRichTextNotesChanged,onFocus:this.onTaskDescriptionFocus,onBlur:this.onTaskNotesBlur,showLessString:ht.p.Strings.TaskEditor_NotesShowLess,showMoreString:ht.p.Strings.TaskEditor_NotesShowMore,initializeBlockDnDPlugin:!0,initializeHyperLinkPlugin:!0,initializeContentEditPlugin:!0,initializeBlockImagePastePlugin:!0,initializeEmojiPlugin:!0,initializeContentLimitPlugin:!0,initializeUpdateContentPlugin:!0,initializeWatermarkPlugin:!0,initializePasteContentPlugin:!0,previewMaxHeight:"146",styles:(0,pn.uI)(this.props.theme),initializeRibbonPlugin:this.props.config.enableRibbon,disableCollapseExpanBehavior:this.props.config.disableNotesCollapsingBehavior,theme:this.props.theme}))}renderDescriptionSection(e){var t;const{task:n,taskDetails:o,config:i}=this.props,{descriptionWithHyperlinks:r}=this.state,{permissions:a}=this.props.config;if(null==o)return null;const s=n.kind===Su.YC.Shared&&o&&o.description&&o.description.length>0,l=dt.G(ht.p.Strings.TaskEditor_NotesAriaLabel,ht.p.Strings.TaskEditor_NotesLabel,ht.p.Strings.TaskEditor_NotesPlaceholder);return c.createElement("div",{className:e.description},c.createElement("div",{className:"descriptionHeader"},c.createElement(g.J,{className:"descriptionTitle"},ht.p.Strings.TaskEditor_NotesLabel),s&&this.renderShowOnCardCheckbox(Vu.Description,o,e)),this.state.showDescEditMode||!r?c.createElement(Be.A,{autoAdjustHeight:!0,title:a.canEditDescription?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,className:"edit",multiline:!0,placeholder:ht.p.Strings.TaskEditor_NotesPlaceholder,value:null!==(t=this.state.updatedDescription)&&void 0!==t?t:void 0,resizable:!0,onChange:(e,t)=>{this.onDescriptionChanged(t)},onKeyDown:this.taskDescriptionKeyPress,onFocus:this.onTaskDescriptionFocus,onBlur:this.onTaskDescriptionBlur,styleType:Fe.u.Dialog,maxLength:i.limits.maxDescriptionLength,ariaLabel:l,disabled:!a.canEdit||!a.canEditDescription,componentRef:e=>{this.descriptionTextField=e},appTheme:this.props.theme}):c.createElement("div",{onFocus:this.onTaskDescriptionFocus,tabIndex:0,className:"description-hyperlinks"},r))}renderRequirementsSection(){var e,t;const{callbacks:n,config:o,task:i,theme:r,createdFormId:a,taskDetails:s,taskApprovalDetails:l,currentUser:d}=this.props;if(!o.enableFormsRequirement&&!o.enableApprovalsRequirement)return null;const u=Kt.B.clientSettings.ECSSettings.ClientLimits.MaxRequiredFormsOnTask,p=Kt.B.clientSettings.ECSSettings.ClientLimits.MaxRequiredApprovalsOnTask,h=[];var m,g;o.enableFormsRequirement&&h.push({key:"requiredForm",text:ht.p.Strings.TaskEditor_AddRequirementButtonFormOption,onClick:()=>{n.onOpenAddFormRequirementDialog()},disabled:!(null===s||void 0===s||null===(m=s.completionRequirements)||void 0===m||!m.formsRequirement)&&s.completionRequirements.formsRequirement.requiredForms.length>=u});o.enableApprovalsRequirement&&h.push({key:"requiredApproval",text:ht.p.Strings.TaskEditor_AddRequirementButtonApprovalOption,onClick:()=>{this.updateApprovalRequirement(!0)},disabled:null===s||void 0===s||null===(g=s.completionRequirements)||void 0===g||null===(g=g.approvalRequirement)||void 0===g?void 0:g.isApprovalRequired});const f={onDeleteTaskAttachment:this.onDeleteFormAttachment,onEditTaskAttachment:this.onEditFormAttachment,onSelectDeselectShowOnCard:this.onToggleShowOnCard,onOpenLink:this.onOpenFormAttachment,onCopyLink:this.onCopyFormAttachmentLink},v=!o.permissions.canEdit||(0,gu.M)(o.formPermissions,gu.J.DisableUpdateFormRequirement)||null!=(null===(e=i.creationSource.publication)||void 0===e?void 0:e.id),b={callbacks:f,rowConfig:{disableCopyLink:!1,disableActionButton:!1,hideOpenInNewWindow:!0,hideShowOnCardButton:!0,disableEdit:v,disableRemove:v,hideMoreButton:v},taskAttachmentRowItems:this.getFormAttachmentRowItems(),theme:r,isTaskAttachmentBeingEdited:!1},y=null===s||void 0===s||null===(t=s.completionRequirements)||void 0===t||null===(t=t.approvalRequirement)||void 0===t?void 0:t.isApprovalRequired,C=null===s||void 0===s?void 0:s.approval,S=null!==s&&void 0!==s&&s.forms?Object.values(s.forms):null;return c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(Xc,{addRequirementButtonMenuItems:h,formAttachmentsListProps:b,theme:this.props.theme,createdFormId:a,enableApprovalsRequirement:o.enableApprovalsRequirement,enableFormsRequirement:o.enableFormsRequirement,isApprovalRequired:!!y,onDeleteApprovalRequirement:()=>this.updateApprovalRequirement(!1),approvalInfo:C,getAssigneePoolForApproval:n.getAssigneePoolForApproval,getUserPhoto:n.getUserPhoto,currentUserId:d.id,onCancelApproval:n.onCancelApproval,onClearApproval:n.onClearApproval,onUpdateApproval:n.onUpdateApproval,onSendApprovalRequest:n.onSendApprovalRequest,selectedApprover:this.props.selectedApprover,isApprovalDataLoading:this.props.isApprovalDataLoading,onSelectApprover:n.onSelectApprover,approvalDetailInfo:l,isTaskCompleted:i.isComplete(),forms:S,formPermissions:o.formPermissions,approvalPermissions:o.approvalPermissions,maxRequiredForms:u,maxRequiredApprovals:p}))}renderChecklistSection(e){const{task:t,taskDetails:n,callbacks:o,config:i,theme:r}=this.props,{permissions:a,limits:s}=i,l=n?n.checklist:{},d=t.specifiedCompletionRequirements&Eu.v.ChecklistItemsCompletion,u=!(!d||!t.isComplete()),p=!a.canEdit||d&&t.isComplete()?Zs.j.DisableAll:a.checklistPermissions;return t.isProjectTask()?null:c.createElement("div",{className:e.checklist},this.renderCompletionRequirementsInfoCallout(e),this.renderChecklistPreviewHeader(e),c.createElement(bl,{taskId:t.id,checklistItems:l,updateChecklist:this.updateChecklist,planId:t.planId,bucketId:t.bucketId,createTask:o.onCreateTask,permissions:p,maxChecklistItemsPerTask:s.maxChecklistItemsPerTask,theme:r,updateCompletionRequirementsInfoCallout:this.toggleCompletionRequirementsInfoCallout,showMandatoryChecklistTooltip:u}))}renderMandatoryChecklistControl(e){const{taskDetails:t}=this.props;return c.createElement(c.Fragment,null,this.renderMandatoryChecklistToggle(t,e),this.renderMandatoryChecklistInfoSection(e))}renderChecklistPreviewHeader(e){const{taskDetails:t,theme:n,config:o,task:i}=this.props,r=(null===t||void 0===t?void 0:t.checklist)||{},a=null!=tt()(r,(e=>null!=e)),s=this.getItemStats(r),l=o.enableMandatoryCheckList&&!!(i.specifiedCompletionRequirements&Eu.v.ChecklistItemsCompletion);let d="";o.enableMandatoryCheckList&&l&&(d=0===i.numberOfActiveChecklistItems?e.completeTaskRequiredChecklistHeaderItem:e.incompleteTaskRequiredChecklistHeaderItem);const u=dt.G(ht.p.Strings.TaskEditor_ChecklistFraction,s.numCompletedItems,s.numItems),p=s.numCompletedItems/s.numItems;return c.createElement("div",{className:"checklistInfo",tabIndex:0===s.numCompletedItems?-1:0,"aria-label":dt.G(ht.p.Strings.TaskEditor_ChecklistStatus,s.numCompletedItems,s.numItems)},c.createElement("div",null,c.createElement("label",{className:"checklistDetails","aria-label":ht.p.Strings.TaskEditor_ChecklistLabel},c.createElement("span",null,ht.p.Strings.TaskEditor_ChecklistLabel,l&&c.createElement("text",{ref:this.checklistAsteriskRef,className:e.incompleteTaskRequiredChecklistHeaderItem},"*")),l&&0!==i.numberOfActiveChecklistItems&&c.createElement(qc.l,{index:1,isCollapsed:!1,title:ht.p.Strings.TaskEditor_ShowMandatoryChecklistToggleLabel,showBorder:!1,theme:this.props.theme}),a&&c.createElement("span",{className:l?(0,I.A)(d,"checklistFraction"):"checklistFraction"},u))),c.createElement(us.Z,{className:(0,I.A)("checklistCompletionBar",1===p?"checklistCompleted":""),percentComplete:p,barHeight:3,styles:{progressBar:{transitionDelay:"0s",transitionDuration:"0.2s",transitionProperty:"width",transitionTimingFunction:"ease-in-out",backgroundImage:"linear-gradient(270deg, #00AB54 0%, #094624 100%)"}},ariaLabel:dt.G(ht.p.Strings.TaskEditor_ChecklistStatus,s.numCompletedItems,s.numItems),progressHidden:0===s.numCompletedItems}),c.createElement(Rl,{isLastChecklistItemMarkedComplete:!!this.state.prevCheckListStats&&(this.state.prevCheckListStats.numCompletedItems+1===this.state.prevCheckListStats.numItems&&s.numCompletedItems===s.numItems),theme:n}),this.renderMandatoryChecklistControl(e),a&&this.renderShowOnCardCheckbox(Vu.Checklist,t,e))}renderMandatoryChecklistInfoSection(e){const{config:t,task:n}=this.props;return t.mandatoryChecklistTogglePermissions!==mu.HideMandatoryToggle&&n.kind!==Su.YC.Personal&&n.kind!==Su.YC.SharedConsumer?c.createElement("div",{className:e.mandatoryCheckListToggleInfo},c.createElement(Yd.S,{plannerTheme:this.props.theme,directionalHint:U.A.bottomCenter,content:ht.p.Strings.TaskEditor_ShowMandatoryChecklistToggleInfoDescriptionLabel},c.createElement(C.I,{...Ne.h_,tabIndex:0}))):null}renderMandatoryChecklistToggle(e,t){const{task:n,config:o}=this.props,i=o.mandatoryChecklistTogglePermissions!==mu.HideMandatoryToggle,r=o.mandatoryChecklistTogglePermissions===mu.DisableMandatoryToggle;return i&&n.kind!==Su.YC.Personal&&n.kind!==Su.YC.SharedConsumer&&e?c.createElement("div",{className:t.setMandatoryChecklistToggle},c.createElement(fs,{className:this.state.isChecklistMandatory?(0,I.A)("ghostTasksToggle","toggleOn"):(0,I.A)("ghostTasksToggle","toggleOff"),checked:this.state.isChecklistMandatory,label:ht.p.Strings.TaskEditor_ShowMandatoryChecklistToggleLabel,onChange:this.onMandatoryChecklistToggleChange,ariaLabel:ht.p.Strings.TaskEditor_ShowMandatoryChecklistToggleLabel,disabled:r})):null}renderShowOnCardCheckbox(e,t,n){const{task:o,config:i,theme:r}=this.props;if(o.kind!==Su.YC.Shared)return null;if(null==t)return null;let a=!1,s=ht.p.Strings.TaskEditor_ShowOnCardLabel;return e===Vu.Checklist?(a=t.previewType===Cu.X.CheckList,s=dt.G(ht.p.Strings.TaskEditor_ShowOnCardAriaLabel,ht.p.Strings.TaskEditor_ChecklistLabel)):e===Vu.Description&&(a=t.previewType===Cu.X.Description,s=dt.G(ht.p.Strings.TaskEditor_ShowOnCardAriaLabel,ht.p.Strings.TaskEditor_NotesLabel)),c.createElement("div",{className:n.setPreviewCheckbox},c.createElement(S.S,{checked:a,label:ht.p.Strings.TaskEditor_ShowOnCardLabel,onChange:this.onPreviewTypeChanged.bind(this,e),ariaLabel:s,disabled:!i.permissions.canUpdatePreviewType,appTheme:r}))}onPreviewTypeChanged(e,t,n){const{taskDetails:o,callbacks:i}=this.props;if(null==o)return;let r;n?e===Vu.Checklist?r=o.setProperty("previewType",Cu.X.CheckList):e===Vu.Description&&(r=o.setProperty("previewType",Cu.X.Description)):r=o.setProperty("previewType",Cu.X.NoPreview),r&&i.onUpdateTaskDetails(o,r)}renderLastModifiedSection(e,t){const{callbacks:n,config:o,currentUser:i}=this.props;if(!o.enableLastModifiedBy)return null;if(e.isComplete()&&null!=e.completedBy&&null!=e.completedDate){const o=n.getUserById(e.completedBy);if(null==o)return null;const r=o.formattedDisplayName,a=o.id===i.id?ht.p.Strings.TaskEditor_CompletedByOnDateByYou:ht.p.Strings.TaskEditor_CompletedByOnDate,s=this.getElapsedTimeApproximation(e.completedDate),l=o.id===i.id?dt.G(a,s):dt.G(a,s,r);return c.createElement("div",{className:(0,I.A)(t.lastModifiedSection,"completed")},l)}if(null!=e.userContentLastModifiedBy&&null!=e.userContentLastModifiedDate){const o=n.getUserById(e.userContentLastModifiedBy);if(null==o)return null;const r=o.formattedDisplayName,a=o.id===i.id?ht.p.Strings.TaskEditor_ModifiedByOnDateByYou:ht.p.Strings.TaskEditor_ModifiedByOnDate,s=this.getElapsedTimeApproximation(e.userContentLastModifiedDate),l=o.id===i.id?dt.G(a,s):dt.G(a,s,r);return c.createElement("div",{className:t.lastModifiedSection},l)}return null}getItemStats(e){const t=Nu()(Hu()(e));return{numItems:t.length,numCompletedItems:t.filter((e=>e.isChecked)).length}}renderAttachments(){var e,t;const{attachmentToEdit:n,callbacks:o,config:i,container:r,task:a}=this.props,s=this.getAttachmentRowItems();if(a.kind===Su.YC.SharedConsumer||a.kind===Su.YC.Personal&&!((null===s||void 0===s?void 0:s.length)>0))return null;let l;if((null===r||void 0===r?void 0:r.containerType)===je.K.Group){var d;l=null===(d=r.unifiedGroupDetails)||void 0===d?void 0:d.getWorkloadUrl(Tu.P[Tu.P.Documents])}const u={fileUploadOption:i.enableFileUpload&&r&&l?Vr.Default:Vr.Hidden,sharepointOption:r&&l?Vr.Default:Vr.Hidden,hideOpenInNewWindow:!i.enableOpenInNewWindow,hideShowOnCardButton:a.kind!==Su.YC.Shared,disableEditAttachment:!i.permissions.canEdit||(0,bu.L)(i.permissions.attachmentPermissions,bu.I.DisableUpdateAttachments)||null!=(null===(e=a.creationSource.publication)||void 0===e?void 0:e.id),disableRemoveAttachment:!i.permissions.canEdit||(0,bu.L)(i.permissions.attachmentPermissions,bu.I.DisableUpdateAttachments)||null!=(null===(t=a.creationSource.publication)||void 0===t?void 0:t.id),addAttachmentButtonOption:this.getAddAttachmentButtonOption(i.permissions,a.kind),disableCopyLink:!0,disableActionButton:!0,hideMoreButton:!1},p={onDeleteTaskAttachment:this.deleteAttachment,onOpenAddLinkDialog:this.openAddLinkDialog,onOpenTaskAttachmentEditorDialog:this.onOpenAttachmentEditorDialog,onOpenOneDrivePicker:o.onOpenOnedrivePicker,onOpenErrorDialog:o.onOpenErrorDialog,onUploadFileAsTaskAttachment:this.onUploadFileAsAttachment,onSelectDeselectShowOnCard:this.onToggleShowOnCard,onOpenLink:this.onOpenLink,onSelectEmptyFile:o.onSelectEmptyFile,onCopyLink:()=>{}};let h;if(n){const e=o.getAttachmentPreviewThumbnail(n.url),t=this.getAttachmentSelectedForPreviewUrl();h=xs.m.builder.fromTaskAttachment(n,e||"").withPropertyBag({isShownInTaskCard:t===n.url}).build()}const m=(0,pn.EJ)(this.props.theme);return c.createElement(Fs,{attachmentSectionConfig:u,maximumAttachmentsPerTask:i.limits.maximumAttachments,attachmentRowItems:s,attachmentSectionCallbacks:p,attachmentToEdit:h,theme:this.props.theme,styles:m})}getAttachmentRowItems(){const{taskDetails:e,callbacks:t}=this.props;if(null==e||null==e.references)return[];const n=e.getAttachmentsSortedByAlias(),o=[],i=this.getAttachmentSelectedForPreviewUrl();return Qe()(n,(e=>{if(fl.o.isPlexTempId(e.url)){const n=t.getDocumentUploadSession(e.url);n&&o.push(xs.m.builder.fromDriveItemUploadSession(n).build())}else{const n=t.getAttachmentPreviewThumbnail(e.url);o.push(xs.m.builder.fromTaskAttachment(e,n||"").withPropertyBag({isShownInTaskCard:i===e.url}).build())}})),o}getFormAttachmentRowItems(){const{taskDetails:e,config:t}=this.props;if(null==e||null==e.forms)return[];const n=e.getFormsSortedByAlias(),o=[],i=(0,gu.M)(t.formPermissions,gu.J.DisableUpdateFormRequirement)?(0,gu.M)(t.formPermissions,gu.J.DisableViewAllFormResponses)?vu.u.CollectResponses:vu.u.ViewResponses:vu.u.EditForm;return Qe()(n,(e=>{o.push(xs.m.builder.fromForm(e,i).build())})),o}getAttachmentSelectedForPreviewUrl(){const{taskDetails:e}=this.props;if(!e)return"";const t=e.getReferenceWithLowestPriority();return((e.previewType===Cu.X.Reference||e.previewType===Cu.X.Automatic)&&t?t.url:void 0)||""}getAttachmentFromTaskAttachmentRowItem(e){var t;const n=null===(t=this.props.taskDetails)||void 0===t?void 0:t.getAttachmentsSortedByAlias();return tt()(n,(t=>t.url===e.url))}getFormAttachmentFromTaskAttachmentRowItem(e){return fu.o.builder.withPropertyBag({alias:e.alias,url:e.url}).build()}getFormFromTaskAttachmentRowItem(e){var t;const n=null===(t=this.props.taskDetails)||void 0===t?void 0:t.getFormsSortedByAlias();return tt()(n,(t=>t.formId===e.id))}onTitleChanged(e){this.setState((t=>({updatedTitle:e})))}onDescriptionChanged(e){this.throttledTaskDescriptionUpdate(e),this.setState((t=>({updatedDescription:e,descriptionWithHyperlinks:(0,Wu.o)(e)})))}taskDescriptionUpdate(e){const{taskDetails:t,callbacks:n,config:o}=this.props;if(null==t)return;const i=o.enableRichTextEditor?t.setProperty("notes",{content:e.trim(),contentType:$t.c.HTML}):t.setProperty("description",e.trim());n.onUpdateTaskDetails(t,i)}alertUserDescriptionUpdated(){const{callbacks:e}=this.props;e.onAlertUserDescriptionUpdated(),this.descriptionSinceLastUpdateAlert=this.props.config.enableRichTextEditor?this.state.updatedNotesContent:this.state.updatedDescription}onBucketChanged(e){const{task:t,callbacks:n}=this.props,o=e.key.toString();if(null==t)return;const i=t.setProperty("bucketId",""!==o?o:null);n.onUpdateTask(t,i),n.fetchFileSuggestions(i,this.props.taskDetails)}onProgressChanged(e){const{task:t,callbacks:n}=this.props,o=ll.$[e.key];if(null==t)return;this.context.usageLogger.logData(this.name(),Mt.M.TaskProgressOptionClicked);const i=t.setProperty("percentComplete",this.props.callbacks.convertProgressStateToPercentComplete(o));n.onUpdateTask(t,i)}onPriorityChanged(e){const{task:t,callbacks:n}=this.props,o=Su.gy[e.key];if(null==t)return;const i=t.setProperty("priority",this.props.callbacks.convertPriorityNameToPriority(o));n.onUpdateTask(t,i)}getElapsedTimeApproximation(e){const t=Hn()(),n=Hn().duration(t.diff(e));return Kn.lz.InLastMinute(e)?ht.p.Strings.TaskEditor_LastModifiedMomentsAgo:Kn.lz.InPastFewMinutes(e)?dt.G(ht.p.Strings.TaskEditor_LastModifiedMinutesAgo,n.minutes()):Kn.lz.InPastHour(e)?ht.p.Strings.TaskEditor_LastModifiedHourAgo:Kn.lz.InPastFewHours(e)?dt.G(ht.p.Strings.TaskEditor_LastModifiedHoursAgo,n.hours()):Kn.lz.IsToday(e)?ht.p.Strings.TaskEditor_LastModifiedToday:Kn.lz.IsYesterday(e)?ht.p.Strings.TaskEditor_LastModifiedYesterday:Kn.lz.InPastFewDays(e)?dt.G(ht.p.Strings.TaskEditor_LastModifiedDaysAgo,n.days()):e.format("L")}logUserAccessEditorOpen(e,t){if(this.props.taskAccessContext===xu.t.User){const n=yu.T.getFirstDisplayableContextString(e,t);this.logUsage("MyTasksOpenTaskDetails",{displayAs:n})}this.logFloodgateActivity()}logFloodgateActivity(){this.props.config.enableRecurringTasks&&Kt.B.clientType!==qt.s.SharepointApp&&Kt.B.clientType!==qt.s.Webpart&&Kc.q.logFloodgateActivity(Mt.M.RecurringTaskDropdown,this.context.traceLogger)}renderTaskRecurrenceDropdown(e){var t;if(!this.props.config.enableRecurringTasks)return null;const{permissions:n}=this.props.config;return c.createElement("div",{className:"dropdownTuple"},c.createElement(Jl.t,{className:"taskRecurrence",title:n.canUpdateRecurrence?void 0:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,label:ht.p.Strings.TaskRecurrence_TaskRecurrenceLabel,options:this.recurrenceOptionList,onChange:this.onRecurrenceChanged,selectedKey:this.getRecurrenceDropdownType(),onRenderTitle:t=>{const n=t[0];return c.createElement("div",{className:(0,I.A)("taskEditor_taskRecurrenceItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"icon"},c.createElement(C.I,Ne.SO)),c.createElement("div",{className:"textValue"},n.text)))},onRenderOption:t=>c.createElement("div",{className:(0,I.A)("taskEditor_taskRecurrenceItem",e.dropdownsItems)},c.createElement("div",null,c.createElement("div",{className:"textValue"},t.text),c.createElement("div",{className:"indicator"},this.getRecurrenceDropdownType()===t.key?c.createElement(C.I,Ne.r8):null))),disabled:!n.canEdit||!n.canUpdateRecurrence||(null===(t=this.props.task.recurrence)||void 0===t?void 0:t.isReadonly())||this.props.task.isComplete(),debounceInterval:Yu.debounceDropdownTaskUpdateInterval,appTheme:this.props.theme}))}getRecurrenceDropdownType(){var e;const t=null===(e=this.props.task.recurrence)||void 0===e||null===(e=e.schedule)||void 0===e?void 0:e.pattern;if(null==t)return Zn.c.NotRepeat;if(t.interval>1)return Zn.c.Custom;switch(t.recurrencePatternType){case Yn.n.Daily:return Zn.c.Daily;case Yn.n.Weekly:const e=t.daysOfWeek;return 5===e.length&&e.indexOf(Kn.ob.Saturday)<0&&e.indexOf(Kn.ob.Sunday)<0?Zn.c.Weekdays:Zn.c.Weekly;case Yn.n.AbsoluteMonthly:case Yn.n.RelativeMonthly:return Zn.c.Monthly;case Yn.n.AbsoluteYearly:case Yn.n.RelativeYearly:return Zn.c.Yearly;default:return Zn.c.NotRepeat}}getClassNames(){const{theme:e,config:t,task:n}=this.props;return(0,pn.Zz)((0,pn.$f)(e,t.permissions,n.isComplete(),this.props.styles))}constructor(e,t){var n,o;super(e,t),this.completionRequirementCalloutRef=c.createRef(),this.checklistAsteriskRef=c.createRef(),this.onChangeLabelName=e=>{if(null==this.props.planDetails)return;const t=this.props.planDetails.setProperty("categories",e);this.props.callbacks.onUpdatePlanDetails(this.props.planDetails,t)},this.onChangeCategorySelection=e=>{const t=this.props.task.setProperty("appliedCategories",e);this.props.callbacks.onUpdateTask(this.props.task,t)},this.onFileSuggestionIntersection=e=>{const t=this.props.task.id,n=this.props.task.numberOfReferences;this.logUsage("FileSuggestionsSeen",{entityId:t,hasAttachments:String(n>0)}),this.props.callbacks.onFileSuggestionsSeenStateChange(t,e)},this.onTaskCompleteClick=e=>{const{task:t}=this.props,{onUpdateTask:n}=this.props.callbacks;var o,i;(qs.v.create().setImmediate((()=>{if(null!=t){const e=t.toggleCompletionState();n(t,e)}})),t.isComplete())?this.context.usageLogger.logData(this.name(),Mt.M.TaskReactivateButtonClicked,{taskCreationSourceType:null!==(o=t.taskCreationSourceType)&&void 0!==o?o:""}):this.context.usageLogger.logData(this.name(),Mt.M.TaskCompleteButtonClicked,{taskCreationSourceType:null!==(i=t.taskCreationSourceType)&&void 0!==i?i:""})},this.updateApprovalRequirement=e=>{var t;const{taskDetails:n,callbacks:o}=this.props;if(null==n)return;if((null===(t=n.completionRequirements)||void 0===t||null===(t=t.approvalRequirement)||void 0===t?void 0:t.isApprovalRequired)!==e){const t=n.updateApprovalRequirement(e);o.onUpdateTaskDetails(n,t)}},this.onMandatoryChecklistToggleChange=Qs()(((e,t)=>{const{taskDetails:n,callbacks:o}=this.props,i=Object.keys((null===n||void 0===n?void 0:n.checklist)||{});if(null==n)return;let r;if(n.completionRequirements)if(t&&0!==i.length){const e=new ku.u(i),t=n.completionRequirements.setProperty("checklistRequirement",e);r=n.setProperty("completionRequirements",t)}else{const e=n.completionRequirements.setProperty("checklistRequirement",null);r=n.setProperty("completionRequirements",e)}else{const e=new ku.u(i),t=Du.h.builder.withChecklistRequirement(e).build();r=n.setProperty("completionRequirements",t)}this.setState((e=>({isChecklistMandatory:!e.isChecklistMandatory}))),o.onUpdateTaskDetails(n,r)}),500),this.getAddAttachmentButtonOption=(e,t)=>(0,bu.L)(e.attachmentPermissions,bu.I.DisableAddAttachment)&&t===Su.YC.Personal?Vr.Hidden:!e.canEdit||(0,bu.L)(e.attachmentPermissions,bu.I.DisableUpdateAttachments)||(0,bu.L)(e.attachmentPermissions,bu.I.DisableAddAttachment)?Vr.Disabled:Vr.Default,this.setAttachmentPreviewStatus=(e,t)=>{const{taskDetails:n,callbacks:o}=this.props;if(null==n)return;let i;const r=n.getReferenceWithLowestPriority();if(null!=r&&r.url!==e.url||n.previewType!==Cu.X.Reference){i=n.setProperty("previewType",Cu.X.Reference);const t=e.setProperty("previewPriority",gl.O.generateOrderHintBetween(null,null==r?null:r.previewPriority));i=i.replaceAttachment(e,t)}else n.previewType===Cu.X.Reference&&(i=n.setProperty("previewType",Cu.X.NoPreview));i&&o.onUpdateTaskDetails(n,i)},this.onUploadFileAsAttachment=e=>{const{taskDetails:t,callbacks:n,container:o}=this.props;if(null==t)return;if(null==o||o.containerType!==je.K.Group)return;let i=null;if(Fu()(t.references)>0){const e=t.getReferenceWithHighestPriority();i=e?e.previewPriority:null}const r=gl.O.generateOrderHintBetween(i,null);n.onUploadFileAsAttachment(e,t,o,r)},this.openAddLinkDialog=e=>{this.props.callbacks.onOpenAttachmentEditorDialog(null,e)},this.deleteAttachment=e=>{const{taskDetails:t,callbacks:n}=this.props;if(null==t)return;const o=t.getReferenceWithLowestPriority();if(null==o)return;let i=t.removeAttachment(e.url);this.logUsage(Mt.M.DeleteAttachment,{entityId:t.id});const r=Ou()([Cu.X.Reference,Cu.X.Automatic],t.previewType)>=0?o.url:null;e.url===r&&(i=i.setProperty("previewType",Cu.X.NoPreview)),n.onUpdateTaskDetails(t,i)},this.onOpenAttachmentEditorDialog=e=>{const t=this.getAttachmentFromTaskAttachmentRowItem(e);t&&this.props.callbacks.onOpenAttachmentEditorDialog(t)},this.onToggleShowOnCard=(e,t)=>{const n=this.getAttachmentFromTaskAttachmentRowItem(e);n&&this.setAttachmentPreviewStatus(n,t)},this.onOpenLink=e=>{if(!e.isBeingUploaded){const t=this.getAttachmentFromTaskAttachmentRowItem(e);t&&this.props.callbacks.onOpenLink(t)}},this.onOpenFormAttachment=e=>{const{callbacks:t,config:n}=this.props;if(!e.isBeingUploaded)if((0,gu.M)(n.formPermissions,gu.J.DisableUpdateFormRequirement)&&(0,gu.M)(n.formPermissions,gu.J.DisableViewAllFormResponses)){const n=this.getFormFromTaskAttachmentRowItem(e);if(!n)return;n.formResponse?t.onOpenFormResponseViewDialog(n):t.onOpenIframeFormRequirementDialog(n)}else{const n=this.getFormAttachmentFromTaskAttachmentRowItem(e);n&&t.onOpenLink(n)}},this.onEditFormAttachment=e=>{const{callbacks:t}=this.props,n=this.getFormFromTaskAttachmentRowItem(e);n&&t.onOpenEditFormDialog(n)},this.onDeleteFormAttachment=e=>{const{callbacks:t}=this.props,n=this.getFormFromTaskAttachmentRowItem(e);n&&t.onOpenRemoveFormConfirmationDialog(n)},this.onCopyFormAttachmentLink=e=>{if(!e.isBeingUploaded){const t=this.getFormAttachmentFromTaskAttachmentRowItem(e);t&&this.props.callbacks.onCopyAttachmentLink(t)}},this.toggleCompletionRequirementsInfoCallout=()=>{this.setState((e=>({isCompletionRequirementsInfoCalloutVisible:!e.isCompletionRequirementsInfoCalloutVisible})))},this.updateChecklist=e=>{const{taskDetails:t,callbacks:n,config:o}=this.props;if(null==t)return;let i=t.setProperty("checklist",e);const r=Nu()(Hu()(t.checklist)),a=Nu()(Hu()(e)),s=o.mandatoryChecklistTogglePermissions===mu.DisableNone;if(0===r.length&&1===a.length&&t.previewType===Cu.X.Automatic?i=i.setProperty("previewType",Cu.X.CheckList):0===a.length&&t.previewType===Cu.X.CheckList&&(i=i.setProperty("previewType",Cu.X.NoPreview)),this.setState((e=>({prevCheckListStats:this.getItemStats(t.checklist)}))),s&&this.state.isChecklistMandatory){const t=Object.keys(e);if(0===t.length&&i.completionRequirements){const e=i.completionRequirements.setProperty("checklistRequirement",null);i=i.setProperty("completionRequirements",e),this.setState({isChecklistMandatory:!1})}else{const e=new ku.u(t);let n;n=i.completionRequirements?i.completionRequirements.setProperty("checklistRequirement",e):Du.h.builder.withChecklistRequirement(e).build(),i=i.setProperty("completionRequirements",n)}}n.onUpdateTaskDetails(t,i)},this.taskTitleKeyPress=e=>{const t=Vs.a.getKey(e);t!==h.D.ESCAPE&&t!==h.D.ENTER||(this.taskTitleUpdate(e),e.preventDefault())},this.taskTitleUpdate=e=>{const{task:t,callbacks:n}=this.props;if(null==t)return;if(""===e.target.value.trim())return void this.setState((e=>({updatedTitle:t.title})));const o=e.target.value;if(o===t.title)return;const i=t.setProperty("title",o);n.onUpdateTask(t,i),n.fetchFileSuggestions(i,this.props.taskDetails)},this.onRichTextNotesChanged=e=>{this.throttledTaskDescriptionUpdate(e),this.setState((t=>({updatedNotesContent:e})))},this.taskDescriptionKeyPress=e=>{if(Vs.a.getKey(e)===h.D.ESCAPE){const t=e.target;this.taskDescriptionUpdate(t.value);this.state.updatedDescription!==this.descriptionSinceLastUpdateAlert&&this.alertUserDescriptionUpdated(),e.preventDefault()}},this.onTaskDescriptionFocus=e=>{this.state.showDescEditMode||this.setState({showDescEditMode:!0},(()=>{var e;null===(e=this.descriptionTextField)||void 0===e||e.focus()}))},this.onTaskNotesBlur=(e,t)=>{this.throttledTaskDescriptionUpdate.cancel(),this.taskDescriptionOnBlurUpdate(t)},this.onTaskDescriptionBlur=e=>{this.throttledTaskDescriptionUpdate.cancel();const t=e.target;this.taskDescriptionOnBlurUpdate(t.value)},this.taskDescriptionOnBlurUpdate=e=>{this.taskDescriptionUpdate(e);if((this.props.config.enableRichTextEditor?this.state.updatedNotesContent!==this.notesContentSinceLastUpdateAlert:this.state.updatedDescription!==this.descriptionSinceLastUpdateAlert)&&this.alertUserDescriptionUpdated(),this.state.showDescEditMode&&this.setState({showDescEditMode:!1}),this.props.taskDetails){const t=this.props.config.enableRichTextEditor?this.props.taskDetails.setProperty("notes",{content:e.trim(),contentType:$t.c.HTML}):this.props.taskDetails.setProperty("description",e.trim());this.props.callbacks.fetchFileSuggestions(this.props.task,t)}},this.onStartDateChanged=e=>{const{task:t,callbacks:n}=this.props;if(null==t)return;const o=t.setStartDate(null==e?null:Hn()(e));n.onUpdateTask(t,o)},this.onEndDateChanged=e=>{var t;const{task:n,callbacks:o}=this.props;if(null==n)return;null==e&&null!==(t=n.recurrence)&&void 0!==t&&t.isActive()&&this.logUsage(Mt.M.RecurrenceCanceledDueDate);const i=n.setDueDate(null==e?null:Hn()(e));o.onUpdateTask(n,i)},this.onRecurrenceChanged=(e,t)=>{var n,o;const{task:i,callbacks:r}=this.props,a=t.key;if(a!==Zn.c.Custom&&this.getRecurrenceDropdownType()===a)return;if(a===Zn.c.Custom)return void r.onOpenCustomRecurrenceDialog();const s=null!==(n=null!==(o=i.dueDate)&&void 0!==o?o:i.startDate)&&void 0!==n?n:Kn.lz.ToUTC10am(Hn()());this.logUsage(Mt.M.RecurrenceOptionSelected);let l=null;switch(a){case Zn.c.NotRepeat:break;case Zn.c.Daily:l=qn.j.builder.withDaily().build();break;case Zn.c.Weekdays:l=qn.j.builder.withWeekly([Kn.ob.Monday,Kn.ob.Tuesday,Kn.ob.Wednesday,Kn.ob.Thursday,Kn.ob.Friday]).build();break;case Zn.c.Weekly:l=qn.j.builder.withWeekly([Kn.W0.getDayOfWeekFromMomentIndex(s.day())]).build();break;case Zn.c.Monthly:l=qn.j.builder.withAbsoluteMonthly(s.date()).build();break;case Zn.c.Yearly:l=qn.j.builder.withAbsoluteYearly(s.date(),oo.h.getRecurrenceMonthIndexFromMoment(s)).build();break;default:Mc.f.unreachableCase(a,(e=>{this.context.traceLogger.logTrace(507914385,Oc.k.Warning,e)}))}let c=null;var d;null!=l&&(c=null==(null===(d=i.recurrence)||void 0===d?void 0:d.schedule)?Vn.s.builder.withRecurrencePattern(l).build():i.recurrence.schedule.setRecurrencePattern(l));const u=i.setRecurrenceSchedule(c);r.onUpdateTask(i,u)},this.stopPropagation=e=>{Vs.a.getKey(e)!==h.D.ESCAPE&&e.stopPropagation()};const i=e.task,r=e.taskDetails,a=null!=r?r.description:null,s=this.props.config.enableRichTextEditor?null===r||void 0===r||null===(n=r.notes)||void 0===n?void 0:n.content:a;this.descriptionSinceLastUpdateAlert=null!=r?a:null,this.notesContentSinceLastUpdateAlert=null!=r?s:null,this.state={isAddFormDialogVisible:!1,isCompletionRequirementsInfoCalloutVisible:!1,isChecklistMandatory:null!==(o=e.config.mandatoryChecklistTogglePermissions!==mu.HideMandatoryToggle&&(!!(0,zu.cl)(i)||(null===r||void 0===r?void 0:r.hasMandatoryChecklist())))&&void 0!==o&&o,updatedTitle:i?i.title:"",updatedDescription:null!=r?a:null,updatedNotesContent:null!=r?s:null,showDescEditMode:!1,descriptionWithHyperlinks:null!==r&&void 0!==r&&r.description?(0,Wu.o)(r.description):null,prevCheckListStats:null},this.throttledTaskDescriptionUpdate=Qs()(this.taskDescriptionUpdate,5e3,{leading:!1}),this.recurrenceOptionList=[{key:Zn.c.NotRepeat,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_DoesNotRepeat},{key:Zn.c.Daily,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Daily},{key:Zn.c.Weekdays,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Weekdays},{key:Zn.c.Weekly,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Weekly},{key:Zn.c.Monthly,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Monthly},{key:Zn.c.Yearly,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Yearly},{key:Zn.c.Custom,text:ht.p.Strings.TaskRecurrence_TaskRecurrenceState_Custom}]}}Yu.debounceDropdownTaskUpdateInterval=200;const Xu=(0,Uu.y)(Yu),$u=(0,G.J9)(((e,t)=>{const n=Pt.d.isLoopTheme(e),o={root:[n&&{position:"absolute"},{".ms-Overlay":[(e===m.Sx.TeamsLight||e===m.Sx.TeamsDark||e===m.Sx.TeamsContrast)&&{backgroundColor:"transparent"}]}],container:[(0,we.aS)(e),(0,we.dg)(e),(0,_e.kE)(),{overflow:"hidden",alignItems:"center",width:Ue.B.MainDialogWidth,maxWidth:Ue.B.MainDialogMaxWidth,minWidth:Ue.B.MainDialogMinWidth,borderRadius:Ue.B.PlannerBorderRadius,boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px"},e===m.Sx.TeamsContrast&&{backgroundColor:Te.z.Black,borderColor:Te.z.White,borderWidth:"1px",borderStyle:"solid"},n&&{maxHeight:"calc(100% - 80px)",borderRadius:Ue.B.LoopBorderRadius,boxShadow:"inset 1px 0px 0px ".concat(e===m.Sx.LoopLight?Te.z.NeutralLightGrey92:Te.z.NeutralDarkGrey12)}],scrollable:[{maxHeight:"calc(100vh - 32px)"},n&&{maxHeight:"600px"}],header:{position:"relative",width:"100%",boxSizing:"border-box"},title:{visibility:"collapse",margin:"0",fontSize:K.s.xLarge,padding:"32px 36px 20px 28px"},topButtonContainer:[(0,we.gS)(),{position:"absolute",top:"0",padding:"12px 12px 0 0",right:"0","> *":(0,we.$Z)(),"> .ms-Button":[(0,we.aS)(e),{":hover":{backgroundColor:"transparent"}}]}],content:{padding:"0 28px 20px"},suggestionsFloatingButton:[(0,we.jU)(e),{position:"absolute",zIndex:"1",bottom:"32px",right:"24px",fontSize:"13px",height:"36px",".suggestionsButtonText":{marginLeft:"8px"}}]};return(0,K.TW)(o,t)})),Ju=(0,G.J9)((e=>({root:(0,K.Zq)("taskEditor-dialog",e.root),container:(0,K.Zq)("taskEditor-dialog-container",e.container),scrollable:(0,K.Zq)("taskEditor-dialog-scrollable",e.scrollable),header:(0,K.Zq)("taskEditor-dialog-header",e.header),title:(0,K.Zq)("taskEditor-dialog-title",e.title),topButtonContainer:(0,K.Zq)("taskEditor-dialog-topButton",e.topButtonContainer),content:(0,K.Zq)("taskEditor-dialog-content",e.content),suggestionsFloatingButton:(0,K.Zq)("suggestionsFloatingButton",e.suggestionsFloatingButton)})));var Qu,ep=n(71060);!function(e){e[e.Default=0]="Default",e[e.MoreOptionsButton=1]="MoreOptionsButton"}(Qu||(Qu={}));class tp extends d.${name(){return"TaskEditorDialog"}componentDidUpdate(e,t){const{focusOverride:n}=this.props;n!==e.focusOverride&&n===Qu.MoreOptionsButton&&setTimeout((()=>{this.moreOptionsButton&&this.moreOptionsButton.focus()}),0)}renderComponent(){const{callbacks:e}=this.props.editorProps;return c.createElement("div",{className:"taskEditorDialog"},this.renderDialog(),e.renderDeleteRecurringTaskDialog())}renderFileSuggestionsFloatingButton(){if(!this.props.editorProps.config.enableFileSuggestions)return null;if(null==this.props.fileSuggestionsSeen||!0===this.props.fileSuggestionsSeen)return null;const e=this.getClassNames();return c.createElement(b.j,{className:e.suggestionsFloatingButton,ariaLabel:ht.p.Strings.TaskEditor_SuggestionsTemporalButtonText,onClick:this.onFileSuggestionsFloatingButtonClick},c.createElement(C.I,Ne._9),c.createElement("span",{className:"suggestionsButtonText"},ht.p.Strings.TaskEditor_SuggestionsTemporalButtonText))}renderDialog(){const{layerProps:e,modalProps:t}=this.props,{dialogClassName:n,dialogContainerClassName:o,dialogContentClassName:i}=this.props,r="taskEditorDialog",a=ht.p.Strings.TaskEditorDialog_CloseButtonAriaLabel,s=this.getClassNames();return c.createElement(Zr.a,{allowTouchBodyScroll:!0,className:(0,I.A)(s.root,"plannerAppDialog",n),containerClassName:(0,I.A)(s.container,o),isOpen:!0,layerProps:{...e,eventBubblingEnabled:!0},onDismiss:this.onDismiss.bind(this),scrollableContentClassName:s.scrollable,subtitleAriaId:r+"-subText",titleAriaId:r+"-title",firstFocusableSelector:ep.ex,focusTrapZoneProps:this.props.focusTrapZoneProps,...t},this.renderFileSuggestionsFloatingButton(),c.createElement("div",{className:s.header},c.createElement("p",{className:s.title,id:r+"-title",title:dt.G(ht.p.Strings.TaskEditorDialog_DialogAriaLabel,this.props.editorProps.task.title)}),c.createElement("div",{className:s.topButtonContainer},c.createElement(Ks.K,{key:"more",className:"moreButton",iconProps:Ne.XP,ariaLabel:ht.p.Strings.SharedComponents_MoreButtonTooltipText,onClick:this.onTaskDialogMoreButtonClicked.bind(this),title:ht.p.Strings.SharedComponents_MoreButtonTooltipText,componentRef:this.resolveRef(this,"moreOptionsButton"),plannerTheme:this.props.theme}),this.renderMoreOptionsContextMenu(),c.createElement(Ks.K,{key:"dismiss",className:"ms-Dialog-button ms-Dialog-button--close",iconProps:Ne.s5,ariaLabel:a,title:a,onClick:this.onDismiss.bind(this),plannerTheme:this.props.theme}))),c.createElement("div",{className:(0,I.A)(s.content,i)},c.createElement(Xu,this.props.editorProps)))}onDismiss(e){const{task:t}=this.props.editorProps;null!=t&&(e&&e.stopPropagation(),this.props.onDismiss(t.id))}onTaskDialogMoreButtonClicked(e){var t;const{task:n}=this.props.editorProps;this.context.usageLogger.logData(this.name(),Mt.M.TaskDetailsContextMenuClicked,{taskCreationSourceType:null!==(t=n.taskCreationSourceType)&&void 0!==t?t:""}),this.setState((e=>({isDialogContextMenuOpen:!e.isDialogContextMenuOpen})))}renderMoreOptionsContextMenu(){var e,t;const{config:n,callbacks:o,task:i}=this.props.editorProps;if(!this.state.isDialogContextMenuOpen)return null;const r=e=>({...e,className:(0,I.A)("defaultIconColor",e.className)}),a=[];return n.permissions.canEdit&&i.kind!==Su.YC.SharedConsumer&&a.push({key:"copyTask",name:ht.p.Strings.TaskEditorDialog_CopyTaskText,title:ht.p.Strings.TaskEditorDialog_CopyTaskHelpText,iconProps:r(Ne.RC),onClick:o.onOpenCopyTaskDialog,disabled:!n.enableCopyTask}),n.permissions.canEdit&&i.kind!==Su.YC.SharedConsumer&&a.push({key:"moveTask",name:ht.p.Strings.SharedComponents_MoveTaskText,title:ht.p.Strings.SharedComponents_MoveTaskHelpText,iconProps:r(Ne.Nk),onClick:o.openMoveTaskDialog.bind(this),disabled:!n.enableMoveTask}),n.enableCopyLinkToTask&&a.push({key:"copyLinkToTask",name:ht.p.Strings.TaskEditorDialog_CopyLinkToTaskText,title:ht.p.Strings.TaskEditorDialog_CopyLinkToTaskHelpText,iconProps:r(Ne.M8),onClick:o.onCopyLinkToTask}),n.permissions.canEdit&&n.permissions.canDelete&&a.push({key:"deleteTask",name:ht.p.Strings.TaskEditorDialog_DeleteTaskText,title:ht.p.Strings.TaskEditorDialog_DeleteTaskHelpText,iconProps:r(Ne.pJ),onClick:this.handleDelete(i)}),c.createElement(Yr.l,{shouldFocusOnMount:!0,target:null!==(e=this.props.layerProps)&&void 0!==e&&e.hostId?"#".concat(null===(t=this.props.layerProps)||void 0===t?void 0:t.hostId," .taskEditor-dialog-topButton .moreButton"):".taskEditor-dialog-topButton .moreButton",onDismiss:this.onMoreContextMenuDismiss.bind(this),directionalHint:(0,So.jI)()?U.A.bottomLeftEdge:U.A.bottomRightEdge,items:a,appTheme:this.props.theme})}onMoreContextMenuDismiss(){this.setState({isDialogContextMenuOpen:!1})}getClassNames(){const{theme:e,contentStyles:t}=this.props;return Ju($u(e,t))}constructor(e,t){super(e,t),this.onFileSuggestionsFloatingButtonClick=e=>{var t;e.stopPropagation(),null===(t=this.props.editorProps.fileSuggestionsContainerRef.current)||void 0===t||t.scrollIntoView()},this.handleDelete=e=>{var t;return null!==(t=e.recurrence)&&void 0!==t&&t.isActive()?this.props.editorProps.callbacks.openDeleteRecurringTaskDialog:this.props.editorProps.callbacks.onDeleteTask},this.state={isDialogContextMenuOpen:!1}}}const np=()=>(0,jt.L)((()=>n.e(6363).then(n.bind(n,67354)))).then((e=>({default:e.AddFormRequirementDialog}))),op=(0,c.lazy)(np),ip=()=>(0,jt.L)((()=>n.e(67910).then(n.bind(n,14844)))).then((e=>({default:e.RemoveFormConfirmationDialog}))),rp=(0,c.lazy)(ip),ap=()=>(0,jt.L)((()=>n.e(42067).then(n.bind(n,29610)))).then((e=>({default:e.FormResponseViewDialog}))),sp=(0,c.lazy)(ap),lp=()=>(0,jt.L)((()=>n.e(25253).then(n.bind(n,82527)))).then((e=>({default:e.EditFormDialog}))),cp=(0,c.lazy)(lp);var dp=n(73141),up=n(219),pp=n(31408),hp=n(26260),mp=n(59889),gp=n(56128),fp=n(32561),vp=n(80708),bp=n(39946),yp=n(82229);const Cp=(0,G.J9)(((e,t)=>({root:[(0,we.GD)(),(0,we.gS)(),{width:"100%"}],assigneeRow:[{".assignLabel":[(0,we.Ib)(e),{padding:"0px 5px"}],"> .ms-Facepile":{margin:"7px 0px"},"> .ms-Facepile-addButton i":{margin:"2px 5px 0px -2px",...t&&{color:Te.z.NeutralTertiary}}},!t&&{":hover .addFriendIcon":(0,we.zK)(e)}],addFriendIcon:[(0,we.gS)(),{justifyContent:"center",alignItems:"center",width:"32px",minWidth:"32px",height:"32px",marginRight:"2px",marginLeft:"0px"}],assignDiv:{marginLeft:"-8px"}})));var Sp=n(96213);const kp=["align","alt","bgcolor","border","charset","cite","colspan","color","datetime","dir","headers","height","href","hreflang","lang","maxlength","media","rel","rowspan","scope","span","src","start","style","title","type","value","width","high","low","max","min","open","optimum","reversed","spellcheck"],Dp=["a","abbr","address","b","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","font","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","li","ol","p","pre","q","s","samp","small","span","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","tt","u","ul","var","section","nav","article","aside","main","figure","figcaption","data","time","mark","ruby","rt","rp","bdi","bdo","wbr","progress","meter","details","summary","html","head","body"],xp=["align-content","align-items","align-self","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","image-rendering","justify-content","left","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","mask","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","perspective","perspective-origin","pointer-events","quotes","right","row-gap","tab-size","table-layout","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-indent","text-justify","text-orientation","text-overflow","text-shadow","text-transform","text-underline-position","top","unicode-bidi","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","writing-mode","z-index"];function Tp(e){const t=function(){const e=function(){const e={},t=new RegExp("-([a-z])","g");return xp.forEach((n=>{const o=n.replace(t,(function(e){return e[1].toUpperCase()}));e[o]=n})),e}();function t(t,n){for(const o in n)"string"===typeof n[o]&&n[o]&&e[o]&&t.push(e[o]+":"+n[o]+";")}function n(e,n){for(let o=n.length-1;o>=0;o--){const i=n[o];1===i.type&&i.selectorText&&(e.push(i.selectorText+"{"),i.style&&t(e,i.style),e.push("}"))}}Sp.addHook("uponSanitizeElement",(function(e,t){if("style"===t.tagName){const t=[];n(t,e.sheet.cssRules),e.textContent=t.join("\n")}})),Sp.addHook("afterSanitizeAttributes",(function(e){if(!e.ownerDocument.baseURI){const t=document.createElement("base");t.href=document.baseURI,e.ownerDocument.head.appendChild(t)}if(e.hasAttribute("style")){const n=[];t(n,e.style),n.length?e.setAttribute("style",n.join("")):e.removeAttribute("style")}}));const o={ALLOWED_TAGS:Dp,ALLOWED_ATTR:kp,ALLOW_DATA_ATTR:!1,ALLOW_ARIA_ATTR:!1};return Sp.setConfig(o),Sp}();return t.sanitize(e)}var Ep=n(56953);class wp extends Ft.M{name(){return Mt.M.TaskEditorWrapper}logUsage(e,t,n){this.props.loggers.usageLogger.logData(this.name(),e,t,n)}logError(e,t,n){Ep.v.logError(e,t,n,this.props.loggers.logHandler)}async fetchCriticalData(e,t){var n;const{task:o,planStore:i,actionCreatorProviders:r}=this.props,a=await r.taskActionCreator();a.fetchTaskEntityGroup(o.id),this.areApprovalDetailsNeeded()&&a.fetchApprovalDetailsForTask(o.id);const s=i.getPlan(o.planId);if(null==i.getPlanDetails(o.planId)){(await r.planActionCreator()).fetchPlan(o.planId)}if(null!=s&&s.container.containerType===je.K.Group){const e=await r.unifiedGroupActionCreator();e.fetchGroup(s.container.externalId,!0),null!=o.conversationThreadId&&e.fetchConversationThreadInGroup(s.container.externalId,o.conversationThreadId)}if(null!=(null===(n=o.creationSource)||void 0===n?void 0:n.publication)||o.isProjectTask()){(await r.containerActionCreator()).fetchPermissionsWithTaskContext(o)}}fetchNonCriticalData(e,t){}componentDidMount(){super.componentDidMount();const{hostClient:e,task:t,taskStore:n,appContextStore:o}=this.props;this.isFileRecommendationsEnabled()&&this.logUsage("FileRecsOpenTaskEditor",{taskId:t.id,hasAttachments:String(t.numberOfReferences>0)}),e!==qt.s.Plex&&e!==qt.s.Teams||Kc.q.logFloodgateActivity(Mt.M.OpenTaskEditor,this.props.loggers.traceLogger),this.fetchFileSuggestions(t,n.getTaskDetails(t.id)),this.logUsage("TaskEditor Opened",{taskId:t.id,taskCreationSourceType:t.taskCreationSourceType}),o.getFlights().EnablePalauCoachmark&&t.isProjectTask()&&Kc.q.logFloodgateActivity(Mt.M.ProjectTaskDetails,this.props.loggers.traceLogger)}renderComponent(){var e,t;const{task:n,hostClient:o,dialogClassName:i,taskAccessContext:r,aggregatesStore:a,appContextStore:s,bucketStore:l,groupDocumentsStore:d,intelligenceStore:u,planStore:p,taskStore:h,containerStore:g,permissionsStore:f,userStore:v,actionCreatorProviders:b}=this.props,{currentTaskEditorFocus:y}=this.state,C=s.getFlights(),S=v.getCurrentUser(),k=h.getTaskDetails(n.id),D=h.getTaskApprovalDetails(n.id),x=p.getPlan(n.planId),T=x?x.container.externalId:null,E=null!=T?g.getContainer(T):null,w=(null===E||void 0===E?void 0:E.containerType)===je.K.Group?E:null,_=null!==(e=null===w||void 0===w?void 0:w.unifiedGroupDetails)&&void 0!==e?e:null,I=o===qt.s.Plex&&r===xu.t.User,P=(0,ft.S9)(this.props.appContextStore.getCurrentTheme()),A=(0,ft.XK)(this.props.appContextStore.getCurrentTheme()),R={maximumAssignees:Kt.B.clientSettings.MaxTaskAssignees,maximumAttachments:Kt.B.clientSettings.ECSSettings.ClientLimits.MaxAttachmentsOnTask||10,maxCategoryNameLength:mp.y.MaxCategoryNameLength,maxDescriptionLength:fp.U.DescriptionMaxLength,maxChecklistItemsPerTask:fp.U.MaxChecklistItemsPerTask,maxTitleLength:Yt.i.TitleMaxLength,maxFileSuggestions:Kt.B.clientSettings.maxFileSuggestions||20},L={convertPercentCompleteToProgressState:vl.Fk,convertProgressStateToPercentComplete:vl.BK,convertPercentCompleteToProgressText:cl.Y.getProgressTitle,convertPriorityToPriorityName:vl.aV,convertPriorityNameToPriority:vl._d,convertPriorityToPriorityText:cl.Y.getPriorityText,getAttachmentPreviewThumbnail:d.getDriveItemThumbnail.bind(d,T),getDocumentUploadSession:d.getDocumentUploadSession.bind(d),getUserById:v.getUserById.bind(v),onOpenErrorDialog:this.onOpenErrorDialog,onAlertUserDescriptionUpdated:async()=>{(await b.notificationActionCreator()).enqueueHiddenToast("SharedComponents_TaskDescriptionSavedToastTitle")},onUpdatePlanDetails:this.onUpdatePlanDetails,onCreateTask:this.onCreateTask,onUpdateTask:this.onUpdateTask,onUpdateTaskDetails:this.onUpdateTaskDetails,onUploadFileAsAttachment:async(e,t,o,i)=>{this.logUsage(Mt.M.AddAttachment,{type:"File",entityId:n.id});(await b.groupDocumentsActionCreator()).uploadFileAsAttachment(e,t,o.externalId,i)},onSelectEmptyFile:async e=>{(await b.notificationActionCreator()).enqueueToast(new hp.R("Toasts_CantAttachEmptyFile",[e]))},onCopyLinkToTask:this.onCopyLinkToTask,onOpenOnedrivePicker:this.onOpenOnedrivePicker.bind(this,T),onOpenCopyTaskDialog:this.openCopyTaskDialog,openMoveTaskDialog:this.openMoveTaskDialog,openDeleteRecurringTaskDialog:this.openDeleteRecurringTaskDialog,onDeleteTask:this.onDeleteTask,onOpenAttachmentEditorDialog:this.openAttachmentEditorDialog,onOpenCustomRecurrenceDialog:this.onOpenCustomRecurrenceDialog,onNavigateToPlan:I?this.onNavigateToPlan:void 0,onOpenLink:this.context.openLinkCallback.bind(this),onAddSuggestionAsAttachment:this.convertSuggestionToAttachment,onFileSuggestionsSeenStateChange:this.onFileSuggestionsSeen,renderAssignmentControl:this.renderAssignmentControl,renderCommentThreadViewControl:this.renderCommentThreadViewControl,renderDeleteRecurringTaskDialog:this.renderDeleteRecurringTaskDialog.bind(this,x),renderOnedrivePicker:this.renderOnedrivePicker.bind(this,k,_),renderCustomRecurrenceDialog:this.renderCustomRecurrenceDialog,copyLinkToSuggestion:this.copyLinkToSuggestion,onOpenFileSuggestionContextMenu:this.onOpenFileSuggestionContextMenu,fetchFileSuggestions:this.fetchFileSuggestions,onOpenAddFormRequirementDialog:this.onOpenAddFormRequirementDialog,renderAddFormRequirementDialog:this.renderAddFormRequirementDialog,onOpenRemoveFormConfirmationDialog:this.onOpenRemoveFormConfirmationDialog,renderRemoveFormConfirmationDialog:this.renderRemoveFormConfirmationDialog,onCopyAttachmentLink:this.onCopyAttachmentLink,getAssigneePoolForApproval:this.getAssigneePoolForGroup,getUserPhoto:this.getUserPhoto,onCancelApproval:this.onCancelApproval,onClearApproval:this.onClearApproval,onUpdateApproval:this.onUpdateApproval,onSendApprovalRequest:this.onSendApprovalRequest,onSelectApprover:this.onSelectApprover,renderCheckUnsavedApprovalDialog:this.renderCheckUnsavedApprovalDialog,onOpenFormResponseViewDialog:this.onOpenFormResponseViewDialog,renderFormResponseViewDialog:this.renderFormResponseViewDialog,onOpenEditFormDialog:this.onOpenEditFormDialog,renderEditFormDialog:this.renderEditFormDialog,onOpenIframeFormRequirementDialog:this.onOpenIframeFormRequirementDialog},N=f.getTaskPermissions(n,x),M=E?f.getContainerPermissions(E):f.getDefaultContainerPermissions(null===x||void 0===x?void 0:x.container),O=o===qt.s.Loop,B=o===qt.s.SharepointApp||o===qt.s.Webpart,F=this.isFileRecommendationsEnabled()&&!(0,bu.L)(N.attachmentPermissions,bu.I.DisableUpdateAttachments),j=r===xu.t.User&&!(s.getClientFlavor()===Gt.g.TeamsHeaderlessAppFrame||s.getClientFlavor()===Gt.g.TeamsHeaderlessTabFrame),H={config:{enableComments:N.canComment,enableFileUpload:!B&&N.canUploadFiles,enableLastModifiedBy:C.ShowLastModifiedOnTaskDetails,limits:R,enableCopyTask:N.canCopy,enableCopyLinkToTask:!0,enableMoveTask:N.canMove,permissions:N,containerPermissions:M,enableOpenInNewWindow:null!==(t=this.context.openLinkInNewWindow)&&void 0!==t&&t,enableFileSuggestions:F,enableRecurringTasks:!O,enableRichTextEditor:C.TeamsTasksECS_richTextEditorEnabled,mandatoryChecklistTogglePermissions:mu.HideMandatoryToggle,formPermissions:gu.J.DisableUpdateFormRequirement|gu.J.DisableViewAllFormResponses,approvalPermissions:yp.u.DisableUpdateApprovalRequirement,enablePlanTitleNavLink:j,enableProjectTasksForPlannerWeb:C.EnableProjectTasksForPlannerWeb,enableMandatoryCheckList:C.TeamsTasksECS_enableMandatoryChecklist,enableExtraFieldsForPersonalTasks:!1,enableRibbon:!1,disableNotesCollapsingBehavior:!0,enableFormsRequirement:C.TeamsTasksECS_enableMandatoryForms,enableApprovalsRequirement:C.TeamsTasksECS_enableMandatoryApprovals,enableMissingFieldsMessageForPersonalTasks:!1},callbacks:L,container:E,currentUser:S,plan:x,planDetails:p.getPlanDetails(n.planId),planLabelCounts:a.getLabelUsageCountsForPlan(n.planId),planBuckets:x?l.getBucketsForPlan(x.id):[],bucket:null!=n.bucketId?l.getBucket(n.bucketId):null,task:n,taskDetails:k,taskApprovalDetails:D,attachmentToEdit:this.state.attachmentToEdit,fileSuggestions:this.getDedupedFileSuggestions(n),fileSuggestionsContainerRef:this.fileSuggestionsContainerRef,taskAccessContext:r,theme:s.getCurrentTheme(),createdFormId:this.state.createdFormId,selectedApprover:this.state.selectedApprover,isApprovalDataLoading:h.isTaskApprovalOperationInProgress(n.id)};return c.createElement(tp,{focusOverride:y,dialogClassName:i,dialogContainerClassName:m.bI,dialogContentClassName:m.vt,styles:P,dialogContentStyles:A,editorProps:H,fileSuggestionsSeen:u.getFileSuggestionsSeenState(n.id),onDismiss:this.onDismissTaskEditorDialog,theme:s.getCurrentTheme(),layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps})}checkForCriticalDataReady(){return null!=this.props.taskStore.getTaskDetails(this.props.task.id)}getDedupedFileSuggestions(e){const t=this.props.intelligenceStore.getFileSuggestions(e.id);if(null==t)return null;const n=this.props.taskStore.getTaskDetails(e.id);return null==n?t:t.filter((e=>null==n.references[e.url]&&null==n.references[e.webUrl]))}addCreationActivityFeedPost(e){const{task:t,activityFeedProvider:n}=this.props,o=[n.generateFakeCreationPost(t)];return null==e?o:o.concat(e)}renderDeleteRecurringTaskDialog(e){if(!this.state.isDeleteRecurringTaskDialogOpen)return null;if(null==e)return null;const t=(0,ft.S9)(this.props.appContextStore.getCurrentTheme()),n=(0,ft.XK)(this.props.appContextStore.getCurrentTheme());return c.createElement(_t,{dialogClassName:"plannerAppDialog",dialogContainerClassName:m.bI,dialogContentClassName:m.vt,styles:t,dialogContentStyles:n,onDismiss:this.closeDeleteRecurringTaskDialog,deleteTask:this.onDeleteTask,deleteTaskSeries:this.onDeleteTaskSeries,theme:this.props.appContextStore.getCurrentTheme(),layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps})}renderOnedrivePicker(e,t){const{actionCreatorProviders:n,groupDocumentsStore:o}=this.props;if(this.state.isChildOnedrivePickerOpen){if(null==e)return null;if(null==t)return null;const i=o.getDriveItemsForGroup(t.id);if(null==t.getWorkloadUrl(Tu.P[Tu.P.Documents]))return null;const r=o.getDriveItemsForGroupFailureResult(t.id);let a=!1,s=Gr.getOneDrivePickerStrings();if(null==i&&null!=r){let e;e=403===r?ht.p.Strings.OneDrivePickerForAttachments_FileLoadErrorAccessDeniedMessage:ht.p.Strings.OneDrivePickerForAttachments_FileLoadErrorGenericMessage,a=!0,s={...s,loadingErrorMessage:e}}const l={addDriveItemAsAttachment:this.onAddDriveItemAsAttachment,isDriveItemAnAttachment:this.isDriveItemAnAttachment,groupDriveItemsByFolder:null!==i&&void 0!==i?i:{},onDismiss:this.onEditorChildDialogDismiss,onFolderDrillDown:async e=>{(await n.groupDocumentsActionCreator()).getGroupDocumentsInFolder(t.id,e)},alertUserAddAttachmentError:async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_TaskAddAttachmentErrorToastTitle")},showErrorLoadingFiles:a,showRetryOnError:!0,onRetry:async()=>{this.logUsage("RetryLoadOdspPicker",{groupId:t.id});(await n.groupDocumentsActionCreator()).getGroupDocumentsInFolder(t.id,null)},oneDrivePickerStrings:s};return c.createElement(qr,{theme:this.props.appContextStore.getCurrentTheme(),layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps,oneDrivePickerProps:l})}return null}async onUpsertAttachment(e,t){const{task:n,actionCreatorProviders:o,taskStore:i}=this.props,r=i.getTaskDetails(n.id);if(null==r)return;let a;const s=r.getReferenceWithLowestPriority();let l;l=null!=s?gl.O.generateOrderHintBetween(null,s.previewPriority):gl.O.generateOrderHintBetween(null,null),null==e?(t=t.setProperty("previewPriority",l),a=r.addAttachment(t),a.previewType===Cu.X.Automatic&&(a=a.setProperty("previewType",Cu.X.Reference))):(e.url!==t.url&&(t=t.setProperty("previewPriority",l)),a=r.replaceAttachment(e,t),this.logUsage(Mt.M.EditAttachment,{entityId:r.id}));const c=await o.taskActionCreator();c.updateTaskDetails(r,a),c.ensureTaskReferencePreviewThumbnail(a,t),this.onEditorChildDialogDismiss()}async sendFileRecommendationFeedback(e,t,n,o){const i=this.props.intelligenceStore.getFileSuggestionsMetadata(e);if(null==i)return void this.props.loggers.traceLogger.logTrace(508077507,Oc.k.Warning,"User interacted with a file recommendation but no metadata found in store [EntityId=".concat(e,"]"));if(!t.referenceId)return void this.props.loggers.traceLogger.logTrace(508077506,Oc.k.Warning,"User submitted feedback for file recommendation but referenceId was falsey. [cv=".concat(i.cv,"][traceId=").concat(i.traceId,"][logicalId=").concat(i.logicalId,"]"));(await this.props.actionCreatorProviders.intelligenceActionCreator()).sendFileRecommendationFeedback(i.cv,i.traceId,t.referenceId,i.logicalId,n,o)}async onUpsertForm(e,t){const{task:n,actionCreatorProviders:o,taskStore:i}=this.props,r=i.getTaskDetails(n.id);if(null==r)return;let a;a=null==e?r.addForm(t):r.replaceForm(e,t);(await o.taskActionCreator()).updateTaskDetails(r,a)}areApprovalDetailsNeeded(){var e,t;const{task:n,appContextStore:o,taskStore:i}=this.props;if(!o.getFlights().TeamsTasksECS_enableMandatoryApprovals)return!1;const r=i.getTaskDetails(n.id),a=null!==(e=null===r||void 0===r||null===(t=r.completionRequirements)||void 0===t||null===(t=t.approvalRequirement)||void 0===t?void 0:t.isApprovalRequired)&&void 0!==e&&e,s=!(null===r||void 0===r||!r.approval);return a&&s}isFileRecommendationsEnabled(){const e=this.props.appContextStore.getFlights();return this.props.hostClient===qt.s.Plex&&e.EnableFileIntelligence&&!e.DisableFileRecommendations}sanitizeTaskDetailsNoteContent(e){var t;const n=null===(t=e.notes)||void 0===t?void 0:t.content,o=n?Tp(n):null;return o?e.setProperty("notes",{content:o,contentType:$t.c.HTML}):e}constructor(e){super(e),this.fileSuggestionsContainerRef=c.createRef(),this.renderCommentThreadViewControl=(e,t)=>{var n;const{task:o,planStore:i,transactionStore:r,containerStore:a,userStore:s,appContextStore:l,actionCreatorProviders:d}=this.props,u=i.getPlan(o.planId);if(!u||u.container.containerType!==je.K.Group)return null;const p=a.getContainer(u.container.externalId);if(!p)return null;const h=null!==(n=p.unifiedGroupDetails)&&void 0!==n?n:null;if(null==h||h.isYammerGroup())return null;const m=o.conversationThreadId?a.getContainerConversationThread(u.container.externalId,o.conversationThreadId):[],g=!!o.conversationThreadId&&a.isThreadNotFound(u.container.externalId,o.conversationThreadId);let f=!1;const v=o.conversationThreadId?r.getTransaction(o.conversationThreadId):null;if((null===v||void 0===v?void 0:v.status)===up.x.Pending)return null;null!=m&&(null===v||void 0===v?void 0:v.status)===up.x.Failed&&(f=!0);const b=s.getCurrentUser(),y=null!=m?this.addCreationActivityFeedPost(m):[],C=vn.i.getTaskCommentEmailSubject(o.title),S={getUserPhoto:s.getUserPhotoById.bind(s),getUserByEmail:s.getUserByEmail.bind(s),postComment:async e=>{this.logUsage("PostComment",{newConversation:String(null==o.conversationThreadId),conversation404:String(g)});const t=await d.unifiedGroupActionCreator();null==o.conversationThreadId||g?t.createTaskConversationThread(u.container.externalId,fl.o.generate(),e,o,C):t.postReplyInGroupConversationThread(u.container.externalId,o.conversationThreadId,e,o,C)},onRenderPersona:this.onRenderPersona},k=new Date,D=Bc.wS.generateEntityLink(o,Vt._n.Comment,Vt.rl.GroupMailbox,k),x=u?Bc.wS.generateEntityLink(u,Vt._n.Comment,Vt.rl.GroupMailbox,k):"";return c.createElement(bn,{commentThread:y,commentViewCallbacks:S,collapseThreshold:t,currentUser:b,showLoadingError:f,taskLink:D,task:o,planLink:x,planTitle:u?u.title:"",disabled:!e.canEdit,theme:l.getCurrentTheme()})},this.renderAssignmentControl=(e,t)=>{const{appContextStore:n,permissionsStore:o,task:i,planStore:r,userStore:a}=this.props,s=i.getAssigneeIds(),l=rt()(s,(e=>{let t=a.getUserById(e);return t||(t=au._.getUnknownUser(e)),t})),d=r.getPlan(i.planId),u=null!=d&&(o.canAccessPlanViaSharedContainers(d.sharedWithContainers)&&!o.canAccessPlanViaHostContainer(d)),p=t.canAddMembers&&e.canEdit&&e.canAssign||u;return c.createElement(Xt.UI,{layout:Xt.Yn.Compact,assignees:l,currentUserId:n.getCurrentUserId(),canEditAssignments:e.canAssign,canEditAccessPermissions:t.canAddMembers,canGiveAccessToGuests:o.getUserPermissions().canAddGuests,canAssignToResourcesWithoutAccess:t.canAddMembers,canAccessPlanViaSharedContainerOnly:u,minQueryTermLength:m.c9.MinCharsNeededToSearch,maxDisplayablePersonas:m.eg.MaxDisplayablePersonasTaskDetails,maxAssignees:Kt.B.clientSettings.MaxTaskAssignees,addIconPlacement:Xt.aq.BeforeAssignees,strings:{assignControlLauncherText:ht.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:ht.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:ht.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:ht.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:ht.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:ht.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:ht.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:ht.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:ht.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:ht.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:ht.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:ht.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:ht.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:ht.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:ht.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:ht.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:ht.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:ht.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:ht.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:ht.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:ht.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:ht.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:ht.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:this.onRenderPersona,getUsersWithPlanAccess:this.getAssigneePoolForGroup,getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserPlanAccess,onOpenAssignCallout:this.onOpenAssignCallout,getSearchQueryResults:p?async e=>(await this.props.actionCreatorProviders.userActionCreator()).fetchUsersWithKeyword(e):void 0,getUserPhoto:this.getUserPhoto,showAssigneeLimitError:this.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,styles:Cp(n.getCurrentTheme(),!e.canAssign),theme:n.getCurrentTheme()})},this.onOpenErrorDialog=async(e,t,n)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openErrorDialog(e,t,n)},this.showAssigneeLimitError=async()=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openAssigneeLimitErrorDialog(this.props.task.id)},this.onOpenAssignCallout=async()=>{const{planStore:e,userStore:t,task:n,actionCreatorProviders:o,groupDocumentsStore:i}=this.props,r=e.getPlan(n.planId);if(null!=r){if(null==t.getContainerUsers(r.container.externalId)){(await o.userActionCreator()).fetchUsersForContainer(r.container)}if(null!=r.sharedWithContainers)for(const e of r.sharedWithContainers)if(e.containerType===je.K.DriveItem&&null==i.getDriveItem(e.externalId)){(await o.groupDocumentsActionCreator()).fetchDriveItem(e.externalId)}}},this.onRenderPersona=async e=>{const{userStore:t}=this.props,n=t.getUserPhotoById(e.id);if(!n||n===m.S1.Photo){(await this.props.actionCreatorProviders.userActionCreator()).fetchUserPhoto(e)}},this.onAssignUser=async(e,t,n)=>{const{task:o,actionCreatorProviders:i,appContextStore:r,taskStore:a}=this.props;if(-1===o.getAssigneeIds().indexOf(e)){const s=o.getClone();s.assignments[e]=new gp.I(r.getCurrentUserId(),new Date);(await i.taskActionCreator()).assignTask({userId:e,originalTask:o,updatedTask:s,elementToFocusOnDismiss:t,onAssignSuccess:n}),this.fetchFileSuggestions(s,a.getTaskDetails(o.id))}},this.onUnassignUser=async e=>{const{task:t,actionCreatorProviders:n,taskStore:o}=this.props;if(-1!==t.getAssigneeIds().indexOf(e)){const i=t.getClone();delete i.assignments[e];(await n.taskActionCreator()).updateTask(vp.F.builder.withTask(t).build(),vp.F.builder.withTask(i).build()),this.fetchFileSuggestions(i,o.getTaskDetails(t.id))}},this.getAssigneePoolForGroup=()=>{const{planStore:e,task:t,userStore:n}=this.props,o=e.getPlan(t.planId),i=o?o.container.externalId:null;return i&&n.getContainerUsers(i)||[]},this.openCopyTaskDialog=async()=>{this.logUsage("CopyTaskDialogOpened");(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyTaskDialog(this.props.task.id,(()=>{}))},this.openMoveTaskDialog=async()=>{this.logUsage("MoveTaskDialogOpened");(await this.props.actionCreatorProviders.dialogActionCreator()).openMoveTaskDialog(this.props.task.id,(()=>{}))},this.openDeleteRecurringTaskDialog=()=>{this.logUsage("DeleteRecurringTaskDialogOpened"),this.setState({isDeleteRecurringTaskDialogOpen:!0})},this.closeDeleteRecurringTaskDialog=()=>{this.logUsage("DeleteRecurringTaskDialogClosed"),this.setState({isDeleteRecurringTaskDialogOpen:!1,currentTaskEditorFocus:Qu.MoreOptionsButton})},this.onDeleteTask=async()=>{const{task:e,appContextStore:t,actionCreatorProviders:n}=this.props,o=t.getCurrentDialogData().onDismiss;(await n.dialogActionCreator()).close();(await n.taskActionCreator()).deleteTask(e.id,e.itemVersion),setTimeout((()=>{o(e.id)}),0)},this.onDeleteTaskSeries=async()=>{const{task:e,appContextStore:t,actionCreatorProviders:n}=this.props,o=t.getCurrentDialogData().onDismiss;(await n.dialogActionCreator()).close();(await n.taskActionCreator()).deleteTaskSeries(e.id),setTimeout((()=>{o(e.id)}),0)},this.onAddDriveItemAsAttachment=e=>{var t;const{task:n,planStore:o,containerStore:i}=this.props,r=o.getPlan(n.planId);if(!r||r.container.containerType!==je.K.Group)return;const a=i.getContainer(r.container.externalId);if(!a)return;const s=null!==(t=a.unifiedGroupDetails)&&void 0!==t?t:null,l=null===s||void 0===s?void 0:s.getWorkloadUrl(Tu.P[Tu.P.Documents]);if(l){const t=fu.o.builder.attachmentFromDriveItem(l,e).build();this.onUpsertAttachment(null,t),this.logUsage(Mt.M.AddAttachment,{type:"SharePoint",entityId:n.id})}},this.isDriveItemAnAttachment=e=>{var t;const{task:n,taskStore:o,planStore:i,containerStore:r}=this.props,a=i.getPlan(n.planId);if(!a||a.container.containerType!==je.K.Group)return!1;const s=r.getContainer(a.container.externalId);if(!s)return!1;const l=null!==(t=s.unifiedGroupDetails)&&void 0!==t?t:null,c=null===l||void 0===l?void 0:l.getWorkloadUrl(Tu.P[Tu.P.Documents]),d=o.getTaskDetails(n.id);if(d&&c){const t=fu.o.builder.attachmentFromDriveItem(c,e).build();return d.attachmentExists(t)}return!1},this.onOpenOnedrivePicker=async e=>{if(null==e)return;(await this.props.actionCreatorProviders.groupDocumentsActionCreator()).getGroupDocumentsInFolder(e,null),this.setState({isChildOnedrivePickerOpen:!0})},this.openAttachmentEditorDialog=async(e,t)=>{const{task:n,actionCreatorProviders:o}=this.props;(await o.dialogActionCreator()).openTaskAttachmentDetails(n.id,e,t),this.setState({attachmentToEdit:e})},this.onEditorChildDialogDismiss=()=>{this.setState({isChildOnedrivePickerOpen:!1,isChildCustomRecurrenceDialogOpen:!1,attachmentToEdit:null,isAddFormRequirementDialogOpen:!1,isRemoveFormConfirmationDialogOpen:!1,isFormResponseViewDialogOpen:!1,formToRemove:null,isEditFormDialogOpen:!1,formToEdit:null,isIframeFormRequirementDialogOpen:!1,formToOpen:null})},this.convertSuggestionToAttachment=async e=>{this.logUsage(Mt.M.AddAttachment,{type:"FileSuggestion",entityId:this.props.task.id});(await this.props.actionCreatorProviders.taskActionCreator()).convertSuggestionToAttachment(this.props.task.id,e),this.submitFileRecommendationFeedback(e,!0)},this.copyLinkToSuggestion=async e=>{(await this.props.actionCreatorProviders.linksActionCreator()).copyLinkToFileSuggestion(e)},this.onFileSuggestionsSeen=async(e,t)=>{(await this.props.actionCreatorProviders.intelligenceActionCreator()).setEntityFileSuggestionsSeen(e,t)},this.onCopyLinkToTask=async()=>{const{task:e}=this.props;if(null==e)return;const t={taskId:e.id};this.logUsage("copyTaskLinkTaskDetails",t);(await this.props.actionCreatorProviders.taskActionCreator()).copyLinkToTask(e.id)},this.onUpdateTask=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(vp.F.builder.withTask(e).build(),vp.F.builder.withTask(t).build())},this.submitFileRecommendationFeedback=(e,t)=>{this.sendFileRecommendationFeedback(this.props.task.id,e,dp.EE.Feedback,t?dp.MK.Yes:dp.MK.No)},this.onOpenFileSuggestionContextMenu=e=>{this.sendFileRecommendationFeedback(this.props.task.id,e,dp.EE.EntityAction,dp.aC.EntityClicked)},this.onUpdateTaskDetails=async(e,t)=>{const n=this.props.appContextStore.getFlights(),o=await this.props.actionCreatorProviders.taskActionCreator();if(n.TeamsTasksECS_richTextEditorEnabled){const n=this.sanitizeTaskDetailsNoteContent(t);o.updateTaskDetails(e,n)}else o.updateTaskDetails(e,t)},this.onCreateTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).createTask(vp.F.builder.withTask(e).build())},this.onUpdatePlanDetails=async(e,t)=>{(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(e,t)},this.fetchFileSuggestions=async(e,t)=>{if(this.isFileRecommendationsEnabled()){const n=vp.F.builder.withTask(e).withDetails(null!==t&&void 0!==t?t:void 0).build();(await this.props.actionCreatorProviders.intelligenceActionCreator()).fetchFileRecommendations(n)}},this.onOpenCustomRecurrenceDialog=()=>{this.setState({isChildCustomRecurrenceDialogOpen:!0})},this.renderCustomRecurrenceDialog=()=>this.state.isChildCustomRecurrenceDialogOpen?c.createElement(ao,{onDismiss:this.onEditorChildDialogDismiss,onUpdateTask:this.onUpdateTask,task:this.props.task,theme:this.props.appContextStore.getCurrentTheme()}):null,this.onOpenFormResponseViewDialog=async e=>{const{task:t}=this.props;(await this.props.actionCreatorProviders.taskActionCreator()).fetchFormResponseForTask(t.id,e.formId),this.setState({isFormResponseViewDialogOpen:!0,formToOpen:e})},this.renderFormResponseViewDialog=()=>{var e;if(!this.state.isFormResponseViewDialogOpen||!this.state.formToOpen)return null;const{groupDocumentsStore:t,task:n}=this.props,o=(null===(e=this.getCurrentGroupContainer())||void 0===e?void 0:e.unifiedGroup.id)||"",i=t.getGroupFormResponse(n.id,this.state.formToOpen.formId);return c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(sp,{onSubmitAnotherResponseClick:this.onOpenIframeFormRequirementDialog.bind(this,this.state.formToOpen),dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:this.onEditorChildDialogDismiss,theme:this.props.appContextStore.getCurrentTheme(),formWithQA:i,getThumbnail:t.getDriveItemThumbnail.bind(t,o)}))},this.renderCheckUnsavedApprovalDialog=()=>{const{task:e}=this.props;return this.state.isCheckApprovalDialogOpen?c.createElement(uo,{theme:this.props.appContextStore.getCurrentTheme(),onSendRequest:()=>{this.setState({isCheckApprovalDialogOpen:!1}),this.closeTaskEditorDialog(e.id),this.onSendApprovalRequest()},onDiscard:()=>{this.setState({isCheckApprovalDialogOpen:!1,selectedApprover:null}),this.closeTaskEditorDialog(e.id)},onCloseDialog:()=>{this.setState({isCheckApprovalDialogOpen:!1})}}):null},this.renderEditFormDialog=()=>{var e,t;return this.state.isEditFormDialogOpen&&this.state.formToEdit?c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(cp,{dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:this.onEditorChildDialogDismiss,theme:this.props.appContextStore.getCurrentTheme(),onSave:this.onUpdateForm,currentDisplayName:null!==(e=null===(t=this.state.formToEdit)||void 0===t?void 0:t.displayName)&&void 0!==e?e:""})):null},this.onOpenEditFormDialog=e=>{this.setState({isEditFormDialogOpen:!0,formToEdit:e})},this.onUpdateForm=async e=>{const{taskStore:t,task:n,actionCreatorProviders:o}=this.props,i=t.getTaskDetails(n.id),r=null===i||void 0===i?void 0:i.forms;if(null==i||!r||!this.state.formToEdit)return;const a=this.state.formToEdit.setProperty("displayName",e),s=i.replaceForm(this.state.formToEdit,a);(await o.taskActionCreator()).updateTaskDetails(i,s),this.onEditorChildDialogDismiss()},this.renderRemoveFormConfirmationDialog=()=>this.state.isRemoveFormConfirmationDialogOpen?c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(rp,{dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:this.onEditorChildDialogDismiss,theme:this.props.appContextStore.getCurrentTheme(),onRemoveForm:this.onRemoveForm})):null,this.onOpenRemoveFormConfirmationDialog=e=>{this.setState({isRemoveFormConfirmationDialogOpen:!0,formToRemove:e})},this.onRemoveForm=async()=>{const{taskStore:e,task:t,actionCreatorProviders:n}=this.props,o=e.getTaskDetails(t.id),i=null===o||void 0===o?void 0:o.forms;if(null==o||!i||!this.state.formToRemove)return;const r=o.removeForm(this.state.formToRemove);(await n.taskActionCreator()).updateTaskDetails(o,r),this.onEditorChildDialogDismiss()},this.onOpenAddFormRequirementDialog=()=>{this.setState({isAddFormRequirementDialogOpen:!0})},this.closeFormResponseViewDialog=()=>{this.setState({isFormResponseViewDialogOpen:!1})},this.onOpenIframeFormRequirementDialog=async e=>{var t;const{task:n}=this.props;if(null===(t=this.getCurrentGroupContainer())||void 0===t?void 0:t.unifiedGroupDetails){this.logUsage(Mt.M.FormsRequirementsIframeDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openFormsIframeDialog(e.formId,e.urlFormId,n.id,this.closeFormResponseViewDialog,!0)}},this.renderAddFormRequirementDialog=()=>{var e;const{appContextStore:t}=this.props,n=t.getFlights();if(!this.state.isAddFormRequirementDialogOpen||!n.TeamsTasksECS_enableMandatoryForms)return null;const o=this.props.containerMembershipStore.getJoinedContainerIds(je.K.Group),i=this.props.containerStore.getContainers(o).map((e=>e.unifiedGroup));return c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(op,{dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:this.onEditorChildDialogDismiss,theme:t.getCurrentTheme(),groups:i,getFormsInGroup:()=>null,fetchFormsInGroup:()=>{},onCreateForm:()=>Promise.resolve(),currentGroup:null===(e=this.getCurrentGroupContainer())||void 0===e?void 0:e.unifiedGroup,onAddExistingForm:this.onAddExistingForm}))},this.getCurrentGroupContainer=()=>{const{planStore:e,task:t,containerStore:n}=this.props,o=e.getPlan(t.planId),i=o?o.container.externalId:null,r=null!=i?n.getContainer(i):null;return(null===r||void 0===r?void 0:r.containerType)===je.K.Group?r:null},this.onAddExistingForm=async e=>{var t,n;const{taskStore:o,task:i}=this.props,r=null!==(t=null===(n=o.getTaskDetails(i.id))||void 0===n?void 0:n.forms)&&void 0!==t?t:{},a=bp.l.generateFormUniqueId(r),s=bp.l.builder.fromOfficeForm(e,a).build();this.onUpsertForm(null,s)},this.getUserPhoto=e=>this.props.userStore.getUserPhotoById(e),this.onCancelApproval=async()=>{const{task:e,actionCreatorProviders:t}=this.props;(await t.taskActionCreator()).cancelApproval(e.id)},this.onClearApproval=async()=>{const{task:e,actionCreatorProviders:t,taskStore:n}=this.props,o=n.getTaskDetails(e.id);if(null==o)return;const i=o.setProperty("approval",null);(await t.taskActionCreator()).updateTaskDetails(o,i)},this.onUpdateApproval=async e=>{const{task:t,actionCreatorProviders:n}=this.props;(await n.taskActionCreator()).updateApprovalStatus(t.id,e,"")},this.onSendApprovalRequest=async()=>{if(this.state.selectedApprover){const{task:e,actionCreatorProviders:t}=this.props,n=await t.taskActionCreator(),o=[this.state.selectedApprover.id];this.setState({selectedApprover:null}),n.createApproval(e.id,o)}},this.onSelectApprover=e=>{this.setState({selectedApprover:e})},this.getZeroTermQueryAssignmentResults=()=>{var e;const{task:t}=this.props,n=null===(e=this.props.assigneeSuggestionStore)||void 0===e?void 0:e.getAssigneeSuggestions(t.planId,this.props.taskStore.getSimilarTasks(t));if(null!=n){const e=[];for(const t of n){const n=this.props.userStore.getUserById(t.userId);null!=n&&e.push(new pp.D(n,t.context,t.weight))}return e}return[]},this.tenantSearchAlertUser=async e=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserPlanAccess=async e=>{const t=this.props.planStore.getPlan(this.props.task.planId);if(null!=(null===t||void 0===t?void 0:t.container)){(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.container)}},this.onNavigateToPlan=()=>{const{task:e,taskAccessContext:t,onNavigateToPlan:n}=this.props;if(!n)return void this.props.loggers.traceLogger.logTrace(508077505,Oc.k.Warning,"onNavigateToPlan called without callback specification unexpectedly.");const o=t===xu.t.User?Zt.jf.MyTasks:Zt.jf.Other;n(e.planId,o)},this.closeTaskEditorDialog=async e=>{const{appContextStore:t,actionCreatorProviders:n}=this.props;if(t.getCurrentDialogData().onDismiss(e),Kt.B.clientType!==qt.s.Loop){(await n.walkthroughActionCreator()).dismissTeachingCallout(m.Ox.TaskDetails)}(await n.dialogActionCreator()).close()},this.onDismissTaskEditorDialog=async e=>{this.state.selectedApprover?this.setState({isCheckApprovalDialogOpen:!0}):this.closeTaskEditorDialog(e)},this.onCopyAttachmentLink=async e=>{(await this.props.actionCreatorProviders.linksActionCreator()).copyLinkToAttachment(e)},this.state={currentTaskEditorFocus:Qu.Default,attachmentToEdit:null,isChildOnedrivePickerOpen:!1,isDeleteRecurringTaskDialogOpen:!1,isChildCustomRecurrenceDialogOpen:!1,isAddFormRequirementDialogOpen:!1,isRemoveFormConfirmationDialogOpen:!1,isFormResponseViewDialogOpen:!1,isEditFormDialogOpen:!1,createdFormId:"",formToRemove:null,formToEdit:null,isIframeFormRequirementDialogOpen:!1,formToOpen:null,selectedApprover:null,isCheckApprovalDialogOpen:!1}}}wp.contextType=Wt.Do;var _p=(0,G.J9)((function(e){var t={paddingBottom:"16px","> .ms-Label":{color:xr.EW,fontSize:K.s.small,paddingBottom:"6px"}},n={root:{fontSize:K.s.small,".hidden":{display:"none"}},addressContainer:t,displayTextContainer:t};return(0,K.TW)(n,e)})),Ip=(0,G.J9)((function(e){var t=_p(e);return{root:(0,K.Zq)("linkDetailsEditor",t.root),addressContainer:(0,K.Zq)("addressContainer",t.addressContainer),displayTextContainer:(0,K.Zq)("displayTextContainer",t.displayTextContainer)}})),Pp=n(60601),Ap=n(85855),Rp=n.n(Ap),Lp=function(){function e(){}return e.formatUrlWithHttpUrlScheme=function(t){return e.getUrlScheme(t).toLowerCase()===e.httpScheme?e.ensureUrlScheme(t,e.httpScheme):e.ensureUrlScheme(t,e.httpsScheme)},e.ensureUrlScheme=function(t,n){return(n&&Rp()(n.split("://")))+"://"+e.removeUrlScheme(t)},e.removeUrlScheme=function(e){var t=new RegExp("(http(s)?(:)?(//)?)*(.*)","i").exec(e)||[];return pl()(t)||""},e.getUrlScheme=function(e){var t=new RegExp("(.*)://.*","i").exec(e)||[];return pl()(t)||""},e.tryRoundtripEncodeUrl=function(e){try{return encodeURI(decodeURIComponent(e))}catch(a){return}},e.getFavIconUrl=function(t){return"https://"+e.extractHostname(t)+"/favicon.ico"},e.getValidUrl=function(t){var n=e.formatUrlWithHttpUrlScheme(t);return e.tryRoundtripEncodeUrl(n)},e.isValidURL=function(t){var n=e.formatUrlWithHttpUrlScheme(t);try{return new URL(n),!0}catch(o){return!1}},e.extractHostname=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0].split("#")[0]},e.httpScheme="http",e.httpsScheme="https",e}(),Np=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Mp="https://",Op=function(e){function t(t,n){var o=e.call(this,t,n)||this;o.saveLinkDetails=function(){var e,t=o.props,n=t.displayTextMaxLength,i=t.linkDetails,r=t.onLinkExists,a=t.onSaveLinkDetails,s=t.isUrlValidationEnabled,l=o.state,c=l.linkAlias,d=l.linkUrl,u=Lp.getValidUrl(d);if(s){var p=Lp.isValidURL(d);if(!u||!p)return void o.setState({isLinkUrlValid:!1})}else if(!u)return void o.setState({isLinkUrlValid:!1});var h=c||u;n&&n>0&&(h=h.substring(0,n));var m={url:u,alias:h};(null===(e=null===i||void 0===i?void 0:i.url)||void 0===e?void 0:e.toLocaleLowerCase())!==u.toLocaleLowerCase()&&r(u)?o.setState({linkExists:!0}):a(m)},o.onCancelClicked=function(){o.props.onDismiss()},o.onKeyPress=function(e){e.stopPropagation(),Pp.$.getKey(e)===h.D.ENTER&&o.saveLinkDetails()};var i=(t.linkDetails&&t.linkDetails.url||"").substring(0,t.linkTextMaxLength&&t.linkTextMaxLength>0?t.linkTextMaxLength:void 0),r=(t.linkDetails&&t.linkDetails.alias||"").substring(0,t.displayTextMaxLength&&t.displayTextMaxLength>0?t.displayTextMaxLength:void 0);return o.state={linkUrl:Lp.removeUrlScheme(i),linkAlias:r,linkExists:!1,isLinkUrlValid:!0},o}return Np(t,e),t.prototype.name=function(){return"LinkDetailsEditor"},t.prototype.renderComponent=function(){var e,t=this,n=this.props,o=n.linkDetailsEditorStrings,i=n.textFieldStyles,r=this.getClassNames();return this.state.linkExists?e=o.existingLinkError:this.state.isLinkUrlValid||(e=o.invalidLinkUrl),c.createElement("div",{className:r.root},c.createElement("div",{className:r.addressContainer},c.createElement(g.J,null,o.addressLabel),c.createElement(Fe.A,{ariaLabel:o.addressLabel,autoFocus:!0,className:"text address",contentEditable:!0,errorMessage:e,maxLength:this.getLinkTextInputMaxLength(),placeholder:o.addressPlaceholder,prefix:Mp,styleType:Fe.u.Dialog,value:this.state.linkUrl,onChange:function(e,n){t.onLinkUrlChanged(n)},onKeyPress:this.onKeyPress,styles:i})),c.createElement("div",{className:r.displayTextContainer},c.createElement(g.J,null,o.displayTextLabel),c.createElement(Fe.A,{ariaLabel:o.displayTextLabel,className:"text displayText",contentEditable:!0,maxLength:this.getDisplayTextInputMaxLength(),placeholder:o.displayTextPlaceholder,styleType:Fe.u.Dialog,value:this.state.linkAlias,onChange:function(e,n){t.onLinkDisplayTextChanged(n)},onKeyPress:this.onKeyPress,styles:i})),c.createElement(v.E,null,c.createElement(b.j,{className:"saveButton",onClick:this.saveLinkDetails,disabled:st()(this.state.linkUrl)||this.state.linkExists||!this.state.isLinkUrlValid},o.saveButton),c.createElement(y.Y,{className:"cancel",onClick:this.onCancelClicked},o.cancelButton)))},t.prototype.getLinkTextInputMaxLength=function(){var e=this.props.linkTextMaxLength;if(e&&e>0)return Math.max(e-8,0)||void 0},t.prototype.getDisplayTextInputMaxLength=function(){var e=this.props.displayTextMaxLength;return e&&e>0?e:void 0},t.prototype.onLinkDisplayTextChanged=function(e){this.setState({linkAlias:e})},t.prototype.onLinkUrlChanged=function(e){this.setState({linkUrl:e,linkExists:!1,isLinkUrlValid:!0})},t.prototype.getClassNames=function(){return Ip(this.props.styles)},t}(d.$),Bp={content:{borderStyle:"solid",borderColor:xr.c}},Fp=(0,G.J9)((function(e){return function(t){return(0,K.pB)(t,Bp,e)}})),jp=function(){return jp=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},jp.apply(this,arguments)},Hp=function(e){return c.createElement(u.l,{hidden:!1,dialogContentProps:{className:(0,I.A)("linkDetailsEditorContent",e.dialogContentClassName),title:e.dialogTitle,type:p.h.close,styles:Fp(e.dialogContentStyles)},modalProps:{className:(0,I.A)("linkDetailsEditorDialog",e.dialogClassName),containerClassName:(0,I.A)("linkDetailsEditorDialogContainer",e.dialogContainerClassName),isBlocking:!1,styles:e.modalStyles,elementToFocusOnDismiss:e.elementToFocusOnDismiss,layerProps:e.layerProps,focusTrapZoneProps:e.focusTrapZoneProps},styles:yo(e.styles),onDismiss:e.linkDetailsEditorProps.onDismiss},c.createElement(Op,jp({},e.linkDetailsEditorProps)))};const zp=(0,G.J9)((e=>{const t={"> .ms-Label":(0,we.Ml)(e)};return{addressContainer:t,displayTextContainer:t}})),Up=(0,G.J9)((e=>{const t={content:[(e===m.Sx.TeamsDark||e===m.Sx.Dark||e===m.Sx.SharePoint)&&{border:"none"},e===m.Sx.SharePoint&&{width:"100%"}],title:{fontSize:K.s.mediumPlus}};return(0,ft.XK)(e,t)})),Wp=(0,G.J9)((e=>{const t={main:{maxWidth:Ue.B.MaxSecondaryDialogWidth,width:Ue.B.SecondaryDialogWidth,"@media (min-width: 480px)":{maxWidth:Ue.B.MaxSecondaryDialogWidth,width:Ue.B.SecondaryDialogWidth}}};return(0,ft.S9)(e,t)})),Kp=e=>{const t=e.attachment?{url:e.attachment.url,alias:e.attachment.alias}:void 0,n={addressLabel:ht.p.Strings.TaskAttachmentDetailsEditor_Address,addressPlaceholder:ht.p.Strings.TaskAttachmentDetailsEditor_AddYourLinkHere,displayTextLabel:ht.p.Strings.TaskAttachmentDetailsEditor_TextToDisplay,displayTextPlaceholder:ht.p.Strings.TaskAttachmentDetailsEditor_GiveYourLinkNameHere,existingLinkError:ht.p.Strings.TaskAttachmentDetailsEditor_ExistingLinkError,invalidLinkUrl:ht.p.Strings.TaskAttachmentDetailsEditor_InvalidAttachmentUrlText,cancelButton:ht.p.Strings.TaskAttachmentDetailsEditor_Cancel,saveButton:t?ht.p.Strings.TaskAttachmentDetailsEditor_Save:ht.p.Strings.TaskAttachmentDetailsEditor_Add},o={...e.linkDetailsEditorProps,linkDetails:t,linkDetailsEditorStrings:n,displayTextMaxLength:fu.o.AliasMaxLength,linkTextMaxLength:fu.o.UrlMaxLength,onSaveLinkDetails:t=>e.onSaveAttachment(fu.o.builder.withPropertyBag({...e.attachment,...t}).build()),styles:zp(e.theme),textFieldStyles:(0,wu.pS)(e.theme,Fe.u.Dialog)},i=Wp(e.theme),r=Up(e.theme);return c.createElement(Hp,{dialogContainerClassName:(0,I.A)(m.bI,"attachmentDetailsEditorDialogContainer"),dialogContentClassName:m.vt,styles:i,dialogContentStyles:r,dialogTitle:t?ht.p.Strings.TaskAttachmentDetailsEditor_EditAttachmentText:ht.p.Strings.TaskAttachmentDetailsEditor_AddLinkText,linkDetailsEditorProps:o,elementToFocusOnDismiss:e.elementToFocusOnDismiss,layerProps:e.layerProps,focusTrapZoneProps:e.focusTrapZoneProps})},Gp=(0,G.J9)(((e,t)=>{const n=[(0,we.aS)(e)],o={content:[{".message":{fontSize:K.s.small,marginBottom:"17px"},".okButton":(0,we.jU)(e),".cancelButton":(0,we.i9)(e)}],title:n};return(0,K.TW)(o,t)})),qp=(0,G.J9)((e=>{const t=Pt.d.isLoopTheme(e);return{main:[(0,we.aS)(e),(0,we.dg)(e),{width:"50%",maxWidth:"700px",minWidth:"300px","@media (min-width: 480px)":{maxWidth:"700px",width:"50%",minWidth:"300px"}},e===m.Sx.TeamsContrast&&{borderWidth:"1px",borderColor:Te.z.White,borderStyle:"solid"}],root:[t&&{position:"absolute"}]}}));class Vp extends d.${name(){return"AssignTaskWarningDialog"}renderComponent(){return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{showCloseButton:!0,className:this.props.dialogContentClassName,title:this.props.titleText,styles:Gp(this.props.theme,this.props.dialogContentStyles)},modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1,elementToFocusOnDismiss:this.props.elementToFocusOnDismiss,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps},styles:qp(this.props.theme)},c.createElement("div",{className:"AssignTaskWarningDialog"},c.createElement("div",{className:"message"},this.props.messageText),c.createElement(v.E,null,c.createElement(b.j,{className:"okButton",onClick:this.props.onOK},this.props.okButtonText),c.createElement(y.Y,{className:"cancelButton",onClick:this.props.onDismiss},ht.p.Strings.AssignTaskWarningDialog_AddNonMemberCancel))))}constructor(e,t){super(e,t)}}var Zp=n(97498),Yp=n(35375),Xp=n(87797),$p=n(69128),Jp=n(70776),Qp=n(49728);const eh={root:{fontSize:K.s.small,marginBottom:"17px"}},th=(0,G.J9)((e=>({root:(0,we.DC)(e)})));class nh extends d.${name(){return"LeavePlanDialog"}renderComponent(){return c.createElement(u.l,{hidden:!1,onDismiss:this.props.onDismiss.bind(this),dialogContentProps:{className:this.props.dialogContentClassName,title:this.props.dialogTitle,type:p.h.close,styles:(0,ft.XK)(this.props.theme)},styles:(0,ft.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1,layerProps:this.props.layerProps,focusTrapZoneProps:this.props.focusTrapZoneProps}},c.createElement("div",{className:"leavePlanDialog"},c.createElement(S.S,{className:"leavePlanConfirmationCheckbox",label:this.props.leaveConfirmationCheckboxLabel,defaultChecked:!1,styles:eh,onChange:this.leaveConfirmationChanged,appTheme:this.props.theme}),c.createElement(v.E,null,c.createElement(b.j,{className:"leavePlanButton",onClick:this.closeLeavePlanDialog.bind(this),disabled:!this.state.leaveConfirmationEnabled,styles:th(this.props.theme)},ht.p.Strings.LeavePlanDialog_LeavePlanSave),c.createElement(y.Y,{className:"cancelLeave",onClick:this.props.onDismiss},ht.p.Strings.LeavePlanDialog_LeavePlanCancel))))}closeLeavePlanDialog(e){null!=e&&e.preventDefault(),this.props.leavePlan(),this.props.onDismiss(e)}constructor(e,t){super(e,t),this.leaveConfirmationChanged=(e,t)=>{this.setState((e=>({...e,leaveConfirmationEnabled:t})))},this.state={leaveConfirmationEnabled:!1}}}var oh=n(44433),ih=n(22953),rh=n(17557),ah=n(17090),sh=n(44430);const lh="24px",ch="11px",dh="17px",uh="2px",ph="2px",hh=(0,G.J9)((e=>{const t={root:[(0,we.GD)(),(0,we.gS)("column"),{paddingBottom:"25px",overflow:"hidden","> .settingsPane":[(0,we.GD)(),{paddingLeft:lh}],"> .settingsPane.planSettings":{paddingLeft:(0,We.vb)((0,We.jz)(lh)-(0,We.jz)(uh)-(0,We.jz)(ph))}}],settingsNavigation:[(0,we.$Z)(),(0,we.gS)("row"),{paddingLeft:"23px",paddingRight:"16px",paddingBottom:"12px",button:[(0,we.$Z)(),{margin:"0px",padding:"0px",i:{margin:"0px"}}]}],settingsTitle:[(0,we.GD)(),{fontSize:K.s.size18,fontWeight:K.BO.semibold}],pivotSection:[(0,we.$Z)(),(0,we.gS)("row","wrap"),{padding:"0 ".concat(lh," ").concat("10px"),"> .pivotLink":[we.xK,(0,we.$Z)(),{marginLeft:"21px",lineHeight:"22px",cursor:"pointer",paddingBottom:"2px",":nth-child(1)":{marginLeft:"0px"}}],"> .pivotLink.selected":{fontWeight:K.BO.semibold,borderBottom:"".concat("2px"," solid ").concat(Te.z.ThemeSecondary),borderRadius:"0px",paddingBottom:"0px"}}]};return(0,K.TW)(t,e)})),mh=(0,G.J9)((e=>{const t=hh(e);return{root:(0,K.Zq)("planSettingsPanelContent",t.root),settingsNavigation:(0,K.Zq)("settingsNavigation",t.settingsNavigation),settingsTitle:(0,K.Zq)("settingsTitle",t.settingsTitle),pivotSection:(0,K.Zq)("pivotSection",t.pivotSection)}})),gh={main:{zIndex:"3",animation:"none"},contentInner:{overflowY:"visible"},scrollableContent:[(0,we.GD)(),(0,we.gS)("column")],content:[(0,we.GD)("auto"),{padding:"21px 0px 0px 0px",width:"100%","> .landmark":[(0,we.gS)("column"),(0,we.GD)("auto"),{height:"100%"}]}]},fh="7px",vh=(0,G.J9)(((e,t)=>{const n=(0,we.gS)(),o=[(0,we.GD)(),(0,we.gS)("column","nowrap"),{fontSize:K.s.medium,overflow:"hidden"}],i={fontSize:K.s.small,fontWeight:K.BO.semibold,paddingBottom:fh},r={fontSize:K.s.small,padding:"".concat(fh," 0px"),button:[(0,we._D)(e),{fontSize:K.s.small,fontWeight:K.BO.semibold,cursor:"pointer",border:"none",backgroundColor:"transparent",padding:"0px"}]},a=[(0,we.Ml)(e),{fontSize:K.s.small,paddingLeft:"24px",padding:"".concat(fh," 0px"),"> .groupEmailText":{paddingBottom:"7px"},a:{fontSize:K.s.small,fontWeight:K.BO.semibold,textDecoration:"none"}}],s={root:n,form:o,notificationSettingsContent:[(0,we.GD)(),{overflowX:"hidden",overflowY:"auto","> .groupEmailSection, > .userNotificationSection":[{marginTop:ch,marginBottom:ch,paddingRight:"22px","> .header":i,"> .subHeader":r,"> .ms-Checkbox.checkbox":{padding:"".concat(fh," 0px"),"> .ms-Checkbox-label > .ms-Checkbox-text":[(0,_e.M8)(),{fontSize:K.s.medium,lineHeight:"16px",margin:"2px 4px"}]},"> .ms-Checkbox.checkbox .is-enabled > .ms-Checkbox-label > .ms-Checkbox-text":(0,we.aS)(e),"> .textSection":a}]}],notificationSettingsFooter:[(0,we.$Z)(),{paddingRight:lh,marginTop:dh,button:(0,_e.ji)()}]};return(0,K.TW)(s,t)})),bh=(0,G.J9)(((e,t)=>{const n=vh(e,t);return{root:(0,K.Zq)("notificationSettings",n.root),form:(0,K.Zq)("form",n.form),notificationSettingsContent:(0,K.Zq)("notificationSettingsContent",n.notificationSettingsContent),notificationSettingsFooter:(0,K.Zq)("notificationSettingsFooter",n.notificationSettingsFooter)}}));class yh extends d.${name(){return"NotificationSettings"}renderComponent(){const e=this.getClassNames();return c.createElement("div",{className:(0,I.A)(e.root,"settingsPane")},c.createElement("form",{className:e.form,onSubmit:this.onSubmit,autoComplete:"off"},c.createElement("div",{className:e.notificationSettingsContent},this.renderGroupEmailSettings(),this.renderUserNotifications()),c.createElement("div",{className:e.notificationSettingsFooter},this.renderFooter())))}getDefaultState(){var e,t;const{planDetails:n,userDetails:o,isAssignedToNotificationsEditable:i,isDueDateNotificationsEditable:r}=this.props;return{groupEmailNotificationsEnabled:n.notifyWhen!==ah.b.None,shouldSendOnAssign:null!==(e=o.notificationSettings.shouldSendOnAssign)&&void 0!==e?e:i,shouldSendDueDate:null!==(t=o.notificationSettings.shouldSendDueDate)&&void 0!==t?t:r}}renderGroupEmailSettings(){if(this.props.container.containerType!==je.K.Group)return null;const e=this.props.container;if(null==e.unifiedGroup)return null;const t=!!e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup===sh.N.Owner,n=Bc.wS.generateOWAGroupEmailSettingsLink(Kt.B.clientSettings.owaHostName,e.unifiedGroup.mail,this.context.traceLogger),o=ht.p.Strings.NotificationSettings_FollowGroupSettingsHelperText.split("{0}"),i=this.props.isGuestUser||st()(n)?null:c.createElement("div",{className:"groupEmailText"},o[0],c.createElement("a",{tabIndex:0,target:"_blank",href:n,rel:"noopener noreferrer"},ht.p.Strings.NotificationSettings_GroupSettingsText),o[1]);return c.createElement("div",{className:"groupEmailSection"},c.createElement("div",{className:"header"},ht.p.Strings.NotificationSettings_GroupEmailSettingsLabel),c.createElement("div",{className:"subHeader"},ht.p.Strings.NotificationSettings_GroupEmailSettingsHelperText),c.createElement(S.S,{className:"checkbox",label:ht.p.Strings.NotificationSettings_SendMailToGroupSettingsText,ariaLabel:ht.p.Strings.NotificationSettings_SendMailToGroupSettingsArialabel,defaultChecked:this.state.groupEmailNotificationsEnabled,onChange:this.groupEmailSettingChanged,disabled:!t,appTheme:this.props.theme}),c.createElement("div",{className:"textSection"},c.createElement("div",{className:"groupEmailText"},ht.p.Strings.NotificationSettings_SendMailToGroupSettingsHelperText),i))}renderUserNotifications(){return c.createElement("div",{className:"userNotificationSection"},c.createElement("div",{className:"header"},ht.p.Strings.NotificationSettings_UserNotificationsDescription),c.createElement(S.S,{className:"checkbox",label:ht.p.Strings.Notifications_SendOnAssignCheckbox,defaultChecked:this.state.shouldSendOnAssign,onChange:this.onAssignedToEnabledChanged,disabled:!this.props.isAssignedToNotificationsEditable,appTheme:this.props.theme}),c.createElement(S.S,{className:"checkbox",label:ht.p.Strings.NotificationSettings_ShouldSendDueDate,defaultChecked:this.state.shouldSendDueDate,onChange:this.onDueDateEnabledChanged,disabled:!this.props.isDueDateNotificationsEditable,appTheme:this.props.theme}),c.createElement("div",{className:"textSection"},c.createElement("div",null,c.createElement("a",{href:m.$j.emailAndNotifications,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.SharedComponents_LearnMoreLink))))}renderFooter(){const e=this.getDefaultState(),t=e.groupEmailNotificationsEnabled===this.state.groupEmailNotificationsEnabled&&e.shouldSendOnAssign===this.state.shouldSendOnAssign&&e.shouldSendDueDate===this.state.shouldSendDueDate;return c.createElement("div",{className:"footerSection"},c.createElement(b.j,{className:"saveButton",disabled:t,type:"submit"},ht.p.Strings.SharedComponents_SaveButtonText))}updatePlan(){const e=this.props.plan,t=this.props.planDetails;this.logUsage(Mt.M.PlanNotificationUpdate,{groupEmailNotificationsEnabled:String(this.state.groupEmailNotificationsEnabled)});const n=t.setProperty("notifyWhen",this.state.groupEmailNotificationsEnabled?ah.b.All:ah.b.None),o=yu.T.builder.withPlan(e).withDetails(n).build();this.props.onUpdatePlanEntitySet(o)}updateUserDetails(){let e=this.props.userDetails;this.props.userDetails.notificationSettings.shouldSendOnAssign!==this.state.shouldSendOnAssign&&(this.logUsage(Mt.M.PlanNotificationUpdate,{shouldSendOnAssign:String(this.state.shouldSendOnAssign)}),e=e.setUserNotificationProperty("shouldSendOnAssign",this.state.shouldSendOnAssign)),this.props.userDetails.notificationSettings.shouldSendDueDate!==this.state.shouldSendDueDate&&(this.logUsage(Mt.M.PlanNotificationUpdate,{shouldSendDueDate:String(this.state.shouldSendDueDate)}),e=e.setUserNotificationProperty("shouldSendDueDate",this.state.shouldSendDueDate)),this.props.onUpdateUserDetails(this.props.userDetails,e)}getClassNames(){const{theme:e,styles:t}=this.props;return bh(e,t)}constructor(e,t){super(e,t),this.onSubmit=e=>{null!=e&&e.preventDefault(),this.updatePlan(),this.updateUserDetails()},this.groupEmailSettingChanged=(e,t)=>{this.setState({groupEmailNotificationsEnabled:t})},this.onAssignedToEnabledChanged=(e,t)=>{this.setState({shouldSendOnAssign:t})},this.onDueDateEnabledChanged=(e,t)=>{this.setState({shouldSendDueDate:t})},this.state=this.getDefaultState()}}var Ch=n(61513);const Sh="17px",kh="16px",Dh={root:{fontSize:K.s.small,marginBottom:Sh}},xh={root:{marginBottom:"-4px",height:kh,width:kh,"> .ms-Image > .ms-Image-image":{maxWidth:kh,maxHeight:kh}}},Th=(0,G.J9)((e=>({root:(0,we.DC)(e)}))),Eh=(0,G.J9)(((e,t)=>{const n={message:{fontSize:K.s.small,marginBottom:Sh,li:{marginLeft:"50px",listStyleType:"disc"}},syncWarning:{marginBottom:"24px"},showAllContextsButton:[(0,we._D)(e),{fontSize:K.s.small,border:"none",background:"transparent",padding:"0","&:hover":{cursor:"pointer"}}],syncContextContainer:{marginLeft:"4px",a:[(0,we.aS)(e),{textDecoration:"underline"}]}};return(0,K.TW)(n,t)})),wh=(0,G.J9)(((e,t)=>{const n=Eh(e,t);return{message:(0,K.Zq)("message",n.message),syncWarning:(0,K.Zq)("syncWarning",n.syncWarning),showAllContextsButton:(0,K.Zq)("showAllContextsButton",n.showAllContextsButton),syncContextContainer:(0,K.Zq)("syncContextContainer",n.syncContextContainer)}}));class _h extends d.${name(){return"DeletePlanDialog"}renderComponent(){const e=this.getClassNames();return c.createElement(u.l,{hidden:!this.props.deletePlanDialogOpen,onDismiss:this.props.onDismiss.bind(this),dialogContentProps:{className:this.props.dialogContentClassName,title:ht.p.Strings.DeletePlanDialog_DeletePlanTitle,styles:(0,ft.XK)(this.props.theme)},styles:(0,ft.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1}},c.createElement("div",{className:"deletePlanDialog"},c.createElement("div",{className:e.message},ht.p.Strings.DeletePlanDialog_DeletePlanMessage,c.createElement("br",null)),this.renderSyncWarning(e),c.createElement(S.S,{className:"deletePlanConfirmationCheckbox",label:ht.p.Strings.DeletePlanDialog_DeletePlanConfirmationCheckbox,defaultChecked:this.state.deleteConfirmationEnabled,styles:Dh,onChange:this.deleteConfirmationChanged.bind(this),appTheme:this.props.theme}),c.createElement(v.E,null,c.createElement(b.j,{className:"deletePlanButton",onClick:this.props.deletePlan.bind(this),disabled:!this.state.deleteConfirmationEnabled,styles:Th(this.props.theme)},ht.p.Strings.DeletePlanDialog_DeletePlanSave),c.createElement(y.Y,{className:"cancelDelete",onClick:this.props.onDismiss.bind(this)},ht.p.Strings.DeletePlanDialog_DeletePlanCancel))))}renderSyncWarning(e){const t=yu.T.getSortedDisplayableContexts(this.props.plan,this.props.planDetails);if(0===t.length)return null;const n=t.length>1;return c.createElement("div",{className:e.syncWarning},c.createElement(Vc.n,{messageBarType:ls.H.info,isMultiline:!0},c.createElement("div",null,ht.p.Strings.DeletePlanDialog_PlanSyncWarningInfo,this.state.showAllContexts?t.map(((n,o)=>c.createElement("span",{key:n.contextKey},this.getSyncContextDisplays(n.contextKey,e),o!==t.length-1?c.createElement("span",null,","):c.createElement(c.Fragment,null)))):this.getSyncContextDisplays(t[0].contextKey,e),!this.state.showAllContexts&&n&&c.createElement("button",{className:e.showAllContextsButton,onClick:this.onShowAllContextsClick},dt.G(ht.p.Strings.DeletePlanDialog_AndNMoreButtonText,t.length-1)),". ",ht.p.Strings.DeletePlanDialog_PlanSyncWarning,c.createElement(f.N,{href:m.$j.linkedPlans,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.SharedComponents_LearnMoreLink))))}getSyncContextDisplays(e,t){var n;const o=this.props.plan.contexts[e],i=this.props.planDetails.contextDetails[e],r=i.displayAs&&(0,Fc.qz)(i.displayAs,this.context.traceLogger);let a,s,l;const d=i.displayAs,u=this.props.planContainer.displayName;switch(d){case He.s.MeetingNotes:l=ht.p.Strings.PlanContextLinking_MeetingNotes,s=dt.G(ht.p.Strings.DeletePlanDialog_LinkAriaLabelTemplate,ht.p.Strings.PlanContextLinking_MeetingNotes,ht.p.Strings.PlanContextLinking_MicrosoftLoop),a=ht.p.Strings.PlanContextLinking_MicrosoftLoop;break;case He.s.LoopPage:l=(0,nu.C)(o,u),s=dt.G(ht.p.Strings.DeletePlanDialog_LinkAriaLabelTemplate,l,ht.p.Strings.PlanContextLinking_MicrosoftLoop),a=ht.p.Strings.PlanContextLinking_MicrosoftLoop;break;case He.s.SharePointPage:l=(0,nu.C)(o,u),s=dt.G(ht.p.Strings.DeletePlanDialog_LinkAriaLabelTemplate,l,ht.p.Strings.PlanContextLinking_SharePoint),a=ht.p.Strings.PlanContextLinking_SharePoint;break;case He.s.TeamsTab:l=(0,nu.C)(o,u),s=dt.G(ht.p.Strings.DeletePlanDialog_LinkAriaLabelTemplate,l,ht.p.Strings.PlanContextLinking_Teams),a=ht.p.Strings.PlanContextLinking_Teams;break;case He.s.Other:l=null!==(n=i.customLinkText)&&void 0!==n?n:ht.p.Strings.PlanContextLinking_LinkedContent,s=dt.G(ht.p.Strings.DeletePlanDialog_LinkAriaLabelTemplate,l,ht.p.Strings.PlanContextLinking_LinkedContent),a=ht.p.Strings.PlanContextLinking_LinkedContent;break;default:return null}return c.createElement("span",{className:t.syncContextContainer},c.createElement(C.I,{ariaLabel:a,className:"contextIcon",styles:xh,imageProps:{src:r}}),c.createElement(f.N,{"aria-label":s,href:i.url,target:"_blank",rel:"noopener noreferrer"},l))}deleteConfirmationChanged(e,t){this.setState((e=>({...e,deleteConfirmationEnabled:t})))}getClassNames(){return wh(this.props.theme,this.props.contentStyles)}constructor(e,t){super(e,t),this.onShowAllContextsClick=()=>{this.setState({showAllContexts:!0})},this.state={deleteConfirmationEnabled:!1,showAllContexts:!1}}}var Ih=n(83708),Ph=n(95810),Ah=n(46851);const Rh="89px",Lh="160px",Nh="16px",Mh="337px",Oh=(0,We.vb)((0,We.jz)(uh)+(0,We.jz)(ph)),Bh=(0,G.J9)(((e,t)=>{const n=[(0,we.gS)("column","nowrap"),{fontSize:K.s.medium,overflow:"hidden"}],o=[(0,we.GD)(),(0,we.gS)("column","nowrap"),{overflowX:"hidden",overflowY:"auto"}],i={fontSize:K.s.small,fontWeight:K.BO.semibold,marginBottom:"9px"},r=[(0,we.$Z)(),{paddingRight:lh,paddingLeft:Oh,margin:"".concat(ch," 0"),maxWidth:Mh,"> .planTitleHeader":i}],a=[(0,we.$Z)(),{fontSize:K.s.small,fontWeight:K.BO.semibold,paddingRight:lh,paddingLeft:Oh,paddingBottom:"9px"}],s={fontSize:K.s.small,marginTop:"14px"},l={paddingRight:lh,marginTop:"38px",textAlign:"center",".loading-text":s,".ms-Spinner-circle":(0,we.Z_)(e)},c={paddingRight:lh,marginTop:"20px",textAlign:"center",".error-text":s},d=[(0,we.$Z)(),(0,we.gS)("row","wrap"),{"> *:nth-child(odd)":{marginRight:(0,We.vb)((0,We.jz)(Nh)-2*(0,We.jz)(uh)-2*(0,We.jz)(ph)-1)}}],u=[(0,we.T4)(e),{borderWidth:uh,borderStyle:"solid",borderRadius:"7px",padding:"0"}],p=[(0,we.$Z)(),{marginBottom:(0,We.vb)((0,We.jz)(Nh)-2*(0,We.jz)(uh)-2*(0,We.jz)(ph)),padding:uh,"&.selected":u,"> .background":{boxShadow:Ah.f.depth4,position:"relative",cursor:"pointer",borderRadius:Ue.B.PlannerBorderRadius,margin:ph,width:Lh,height:Rh,overflow:"hidden",":hover":{boxShadow:Ah.f.depth8},"> .thumbnail":{display:"block",width:Lh,minHeight:Rh,borderRadius:Ue.B.PlannerBorderRadius,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"> svg":{width:Lh,height:Rh,position:"absolute",top:"0",left:"0",opacity:"0.89"}},"> .background.default > svg > rect":{opacity:"1",fill:"#efefef"}}],h=[(0,we.Ml)(e),{paddingRight:lh,textAlign:"right",fontSize:K.s.small,maxWidth:Mh}],m=[(0,we.$Z)(),(0,we.gS)("column"),{margin:"".concat(ch," 0"),"> .backgroundTitleHeader":a,"> .imageRecommendationsLoading":l,"> .imageRecommendationsError":c,"> .imageRecommendations":d,"> .designerBranding":h}],g=[(0,we.$Z)(),we.xK,{fontSize:K.s.small,cursor:"pointer",padding:"0px",marginTop:dh,".icon":{paddingRight:"7px",color:Te.z.DarkRed,display:"inline-block"}}],f={root:n,content:o,titleSection:r,backgroundWrapper:p,suggestionSection:m,footer:[(0,we.$Z)(),(0,we.gS)("column","nowrap"),{paddingRight:lh,paddingLeft:Oh,"> .deletePlan":g}]};return(0,K.TW)(f,t)})),Fh=(0,G.J9)(((e,t)=>{const n=Bh(e,t);return{root:(0,K.Zq)("planSettings",n.root),content:(0,K.Zq)("planSettingsContent",n.content),titleSection:(0,K.Zq)("planTitleSection",n.titleSection),backgroundWrapper:(0,K.Zq)("backgroundWrapper",n.backgroundWrapper),suggestionSection:(0,K.Zq)("backgroundSuggestionSection",n.suggestionSection),footer:(0,K.Zq)("planSettingsFooter",n.footer)}}));const jh=n.p+"static/media/image-no-results.c64672fe0472250b12c2380c0688396e.svg";var Hh=n(93950),zh=n.n(Hh);class Uh extends d.${name(){return"PlanSettings"}componentDidMount(){this.props.fetchImageSuggestions(this.props.plan.id,this.props.plan.title),null!=this.props.planImageSuggestions&&this.logSeenImages(this.props.planImageSuggestions.length)}componentDidUpdate(e,t){e.plan.title!==this.props.plan.title&&(this.debouncedFetchImageSuggestions.cancel(),this.initialPlanBackgroundUrl=this.props.planDetails.background.overlayImage,this.props.fetchImageSuggestions(this.props.plan.id,this.props.plan.title)),t.planTitle!==this.state.planTitle&&this.debouncedFetchImageSuggestions(this.props.plan.id,this.state.planTitle),e.planImageSuggestions!==this.props.planImageSuggestions&&null!=this.props.planImageSuggestions&&(this.logSeenImages(this.props.planImageSuggestions.length),this.updateImageSuggestionFeedback())}renderComponent(){var e;let t=!1;if(Kt.B.clientType===qt.s.Loop)t=!1;else if(this.props.container.containerType===je.K.User)t=!0;else if(this.props.container.containerType===je.K.Group){const e=this.props.container;t=!!e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup===sh.N.Owner}else this.props.container.containerType===je.K.Roster&&(t=!0);const n=(null===(e=this.props.plan.creationProcessInfo)||void 0===e?void 0:e.processType)===Ih.m.PublishTarget,o=c.createElement(_h,{dialogClassName:this.props.dialogClassName,dialogContainerClassName:m.bI,dialogContentClassName:m.vt,plan:this.props.plan,planDetails:this.props.planDetails,onDismiss:this.closeDeletePlanDialog,deletePlanDialogOpen:this.state.deletePlanDialogOpen,deletePlan:this.deletePlan,theme:this.props.theme,planContainer:this.props.container}),i=c.createElement("button",{className:"deletePlan",onClick:this.openDeletePlanDialog,type:"button"},c.createElement("span",{className:"icon"},c.createElement(C.I,Ne.Aw)),ht.p.Strings.PlanSettings_DeletePlan),r=this.getClassNames();return c.createElement("div",{className:(0,I.A)(r.root,"settingsPane"),onBlur:this.onPlanSettingsBlur,ref:this.resolveRef(this,"planSettingsElement")},c.createElement("div",{className:r.content},this.renderPlanTitle(r),this.renderBackgroundSuggestionsSection(r)),c.createElement("div",{className:r.footer},!n&&t?i:null),this.state.deletePlanDialogOpen?o:null)}renderPlanTitle(e){return c.createElement("div",{className:e.titleSection},c.createElement("div",{className:"planTitleHeader"},ht.p.Strings.PlanSettings_PlanNameLabel),c.createElement(Be.A,{className:"name",maxLength:Ph.c.NameMaxLength,ariaLabel:ht.p.Strings.PlanSettings_PlanNameLabel,placeholder:ht.p.Strings.PlanSettings_PlanNamePlaceholder,value:this.state.planTitle,onGetErrorMessage:this.getNameErrorMessage,onChange:this.planTitleChanged,autoFocus:!0,styleType:Fe.u.Dialog,onKeyUp:this.planTitleKeyPress,onBlur:this.updatePlanTitle,appTheme:this.props.theme,componentRef:this.props.planTitleRef}))}renderBackgroundSuggestionsSection(e){var t;if(!this.props.isBackgroundSuggestionsEnabled)return null;let n,o=null;if(null==this.props.planImageSuggestions)n=c.createElement("div",{className:"imageRecommendationsLoading"},c.createElement(nn.y,{size:on.H.large}),c.createElement("div",{className:"loading-text"},ht.p.Strings.PlanSettings_LoadingText));else if(0===(null===(t=this.props.planImageSuggestions)||void 0===t?void 0:t.length))n=c.createElement(c.Fragment,null,c.createElement("div",{className:"imageRecommendations",role:"listbox","aria-label":ht.p.Strings.PlanSettings_SuggestedBackgroundsLabel},this.renderDefaultThumbnail(e),this.renderInitialBackgroundThumbnail(e)),c.createElement("div",{className:"imageRecommendationsError"},c.createElement("img",{className:"imageRecommendationsErrorSvg",src:jh}),c.createElement("div",{className:"error-text"},ht.p.Strings.PlanSettings_ImageErrorText)));else{var i;let t;const r=null===(i=this.props.planImageSuggestions)||void 0===i?void 0:i.sort(this.descendingImageSortComparator).filter((e=>e.fullUrl!==this.initialPlanBackgroundUrl||(t=e.altText,!1)));let a=rt()(r,((t,n)=>this.renderImageThumbnail(t,n+1,e)));const s=this.renderInitialBackgroundThumbnail(e,t);null!=s&&a.unshift(s),a=a.slice(0,m.eg.MaxPlanImageBackgroundThumbnails),n=c.createElement("div",{className:"imageRecommendations",role:"listbox","aria-label":ht.p.Strings.PlanSettings_SuggestedBackgroundsLabel},this.renderDefaultThumbnail(e),a),o=c.createElement("div",{className:"designerBranding"},ht.p.Strings.PlanSettings_DesignerText)}return c.createElement("div",{className:e.suggestionSection},c.createElement("span",{className:"backgroundTitleHeader"},ht.p.Strings.PlanSettings_SuggestedBackgroundsLabel),n,o)}renderImageThumbnail(e,t,n){const o=dt.G(ht.p.Strings.PlanSettings_SuggestedBackgroundAriaLabel,t),i=this.props.planDetails.background.overlayImage===e.fullUrl,r=(0,I.A)(n.backgroundWrapper,{selected:i});return c.createElement("div",{className:r,key:e.id+t.toString(),tabIndex:-1},c.createElement("div",{className:"background image",tabIndex:0,role:"option","aria-label":o,key:e.id+t.toString(),"aria-selected":i,onClick:()=>{this.onSelectImageSuggestion(e)},onKeyDown:t=>{const n=Vs.a.getKey(t);n!==h.D.ENTER&&n!==h.D.SPACE||this.onSelectImageSuggestion(e)}},c.createElement("img",{className:"thumbnail",src:e.thumbnailUrl,alt:e.altText}),this.renderBackgroundOverlay()))}renderDefaultThumbnail(e){const t=null===this.props.planDetails.background.overlayImage,n=(0,I.A)(e.backgroundWrapper,{selected:t});return c.createElement("div",{className:n,key:"defaultBackground",tabIndex:-1},c.createElement("div",{className:"background default",tabIndex:0,role:"option","aria-label":ht.p.Strings.PlanSettings_NoBackgroundAriaLabel,"aria-selected":t,onClick:()=>this.updatePlanBackground(null),onKeyDown:e=>{const t=Vs.a.getKey(e);t!==h.D.ENTER&&t!==h.D.SPACE||this.updatePlanBackground(null)}},c.createElement("div",{className:"thumbnail"}),this.renderBackgroundOverlay()))}renderInitialBackgroundThumbnail(e,t){if(null==this.initialPlanBackgroundUrl)return null;const n=this.props.planDetails.background.overlayImage===this.initialPlanBackgroundUrl,o=(0,I.A)(e.backgroundWrapper,{selected:n});return c.createElement("div",{className:o,key:"initialBackground",tabIndex:-1},c.createElement("div",{className:"background initial",tabIndex:0,role:"option","aria-label":n?ht.p.Strings.PlanSettings_CurrentBackgroundAriaLabel:ht.p.Strings.PlanSettings_PreviousBackgroundAriaLabel,"aria-selected":n,onClick:()=>this.updatePlanBackground(this.initialPlanBackgroundUrl),onKeyDown:e=>{const t=Vs.a.getKey(e);t!==h.D.ENTER&&t!==h.D.SPACE||this.updatePlanBackground(this.initialPlanBackgroundUrl)}},c.createElement("img",{className:"thumbnail",src:this.initialPlanBackgroundUrl,alt:null!==t&&void 0!==t?t:""}),this.renderBackgroundOverlay()))}renderBackgroundOverlay(){return c.createElement("svg",{width:"244",height:"137",viewBox:"0 0 244 137",fill:"none",xmlns:"https://www.w3.org/2000/svg",focusable:"false"},c.createElement("rect",{x:"37.8457",y:"23.8584",width:"33.7318",height:"9.05",rx:"3",fill:"white"}),c.createElement("rect",{x:"37.8457",y:"41.9585",width:"33.7318",height:"31.2636",rx:"3",fill:"white"}),c.createElement("rect",{x:"37.8457",y:"82.272",width:"33.7318",height:"31.2636",rx:"3",fill:"white"}),c.createElement("rect",{x:"82.2729",y:"23.8584",width:"33.7318",height:"9.05",rx:"3",fill:"white"}),c.createElement("rect",{x:"82.2729",y:"41.9585",width:"33.7318",height:"18.9227",rx:"3",fill:"white"}),c.createElement("rect",{x:"82.2729",y:"66.6401",width:"33.7318",height:"46.8954",rx:"3",fill:"white"}),c.createElement("rect",{x:"126.7",y:"23.8584",width:"33.7318",height:"9.05",rx:"3",fill:"white"}),c.createElement("rect",{x:"126.7",y:"41.9585",width:"33.7318",height:"31.2636",rx:"3",fill:"white"}),c.createElement("rect",{x:"126.7",y:"82.272",width:"33.7318",height:"31.2636",rx:"3",fill:"white"}),c.createElement("rect",{x:"171.127",y:"23.8584",width:"33.7318",height:"9.05",rx:"3",fill:"white"}),c.createElement("rect",{x:"171.127",y:"41.9585",width:"33.7318",height:"18.9227",rx:"3",fill:"white"}),c.createElement("rect",{x:"171.127",y:"66.6401",width:"33.7318",height:"46.8954",rx:"3",fill:"white"}))}logTriedAndKeptImages(){if(0!==this.triedImageCount){let t;var e;if(null==this.lastTriedBackground)t="default";else t=this.lastTriedBackground===(null===(e=this.lastTriedImageSuggestion)||void 0===e?void 0:e.fullUrl)?String(this.lastTriedImageSuggestion.category):"initial";this.context.usageLogger.logData(Mt.M.PlanSettings,"Background image interaction",{interaction:"kept",category:t}),this.context.usageLogger.logData(Mt.M.PlanSettings,"Background image interaction",{interaction:"tried",count:String(this.triedImageCount)}),this.lastTriedBackground=null,this.lastTriedImageSuggestion=null,this.triedImageCount=0}}logSeenImages(e){const t=null==this.initialPlanBackgroundUrl?m.eg.MaxPlanImageBackgroundThumbnails:m.eg.MaxPlanImageBackgroundThumbnails-1,n=e>t?t:e;this.context.usageLogger.logData(Mt.M.PlanSettings,"Background image interaction",{interaction:"seen",count:String(n)})}updateImageSuggestionFeedback(){null!=this.lastTriedImageSuggestion?this.lastTriedBackground===this.lastTriedImageSuggestion.fullUrl?this.props.queueImageRecommendationFeedback(this.lastTriedImageSuggestion,Ch.r.Kept):this.props.queueImageRecommendationFeedback(this.lastTriedImageSuggestion,Ch.r.Tried):null!=this.props.planImageSuggestions&&this.props.planImageSuggestions.length>0&&this.props.queueImageRecommendationFeedback(this.props.planImageSuggestions[0],Ch.r.Seen)}getClassNames(){return Fh(this.props.theme,this.props.styles)}constructor(e,t){super(e,t),this.getNameErrorMessage=()=>this.state.isNameEmpty?ht.p.Strings.PlanSettings_NameError_Empty:"",this.openDeletePlanDialog=()=>{this.setState({deletePlanDialogOpen:!0})},this.closeDeletePlanDialog=()=>{this.setState({deletePlanDialogOpen:!1})},this.deletePlan=()=>{this.props.onDismiss(),this.props.onDeletePlan(),this.props.onNavigateToHub()},this.planTitleChanged=(e,t)=>{this.setState({isNameEmpty:st()(fn()(t)),planTitle:t})},this.planTitleKeyPress=e=>{const t=Vs.a.getKey(e);t!==h.D.ESCAPE&&t!==h.D.ENTER||(this.updatePlanTitle(),e.preventDefault())},this.updatePlanTitle=()=>{if(this.state.isNameEmpty||this.state.planTitle===this.props.plan.title)return;this.logUsage("PlanTitleUpdated");const e=this.props.plan.setProperty("title",this.state.planTitle),t=yu.T.builder.withPlan(e).withDetails(this.props.planDetails).build();this.props.onUpdatePlanEntitySet(t)},this.updatePlanBackground=e=>{if(e===this.props.planDetails.background.overlayImage)return;this.logUsage("PlanBackgroundUpdated");const t=this.props.planDetails,n=t.background.setProperty("overlayImage",e),o=t.setProperty("background",n),i=yu.T.builder.withPlan(this.props.plan.getClone()).withDetails(o).build();this.props.onUpdatePlanEntitySet(i),this.lastTriedBackground=e,this.triedImageCount=this.triedImageCount+1},this.onSelectImageSuggestion=e=>{this.lastTriedImageSuggestion=e,this.updatePlanBackground(e.fullUrl)},this.descendingImageSortComparator=(e,t)=>{var n,o;return(null!==(n=t.score)&&void 0!==n?n:0)-(null!==(o=e.score)&&void 0!==o?o:0)},this.onPlanSettingsBlur=e=>{const t=e.relatedTarget||document.activeElement;(0,Si.s)(this.planSettingsElement,t)||(this.updateImageSuggestionFeedback(),this.logTriedAndKeptImages())},this.state={planTitle:this.props.plan.title,deletePlanDialogOpen:!1,isNameEmpty:!1},this.lastTriedBackground=null,this.lastTriedImageSuggestion=null,this.triedImageCount=0,this.initialPlanBackgroundUrl=this.props.planDetails.background.overlayImage,this.debouncedFetchImageSuggestions=zh()(((e,t)=>{this.props.fetchImageSuggestions(e,t)}),Uh.imageSuggestionFetchDebounceInterval)}}Uh.imageSuggestionFetchDebounceInterval=500;const Wh=(0,G.J9)(((e,t)=>{const n={root:{height:"32px",background:Te.z.NeutralLighter,border:"none",width:"100%",textAlign:"left"},buttonText:{display:"inline-block",width:"94%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},buttonIcon:[(0,we.aS)(e),{float:"right",lineHeight:"22px"}]};return(0,K.TW)(n,t)})),Kh=(0,G.J9)((e=>({root:(0,K.Zq)("sensitivityMenuButton",e.root),buttonText:(0,K.Zq)("sensitivityMenuButtonText",e.buttonText),buttonIcon:(0,K.Zq)("sensitivityMenuButtonCaret",e.buttonIcon)})));class Gh extends d.${name(){return"SensitivityMenuButton"}renderComponent(){const e=this.props.sensitivityLabelTitle?this.props.sensitivityLabelTitle:ht.p.Strings.SensitivityMenuButton_DefaultText,t=this.getClassNames();return c.createElement("button",{title:e,className:t.root,onClick:e=>this.props.onClick(e),ref:e=>this.props.setRef(e),"aria-label":e},c.createElement("span",{className:t.buttonText},e),c.createElement("span",{className:t.buttonIcon},c.createElement(C.I,Ne.Ju)))}getClassNames(){return Kh(this.getStyles())}getStyles(){const{theme:e,styles:t}=this.props;return Wh(e,t)}constructor(e,t){super(e,t)}}var qh;!function(e){e.Standard="standard",e.Privileged="privileged",e.Auto="auto",e.UnknownFutureValue="unknownFutureValue"}(qh||(qh={}));var Vh=n(77265),Zh=n(94283);const Yh=(0,G.J9)(((e,t)=>{const n={root:[(0,we.gS)(),{padding:"24px"}],form:[(0,we.GD)(),(0,we.gS)("column","nowrap"),{overflow:"hidden"}],rosterSecuritySettingsContent:[(0,we.GD)(),{overflowX:"hidden",overflowY:"auto",fontSize:K.s.smallPlus," .privacySection":{marginTop:"30px",".header":{fontWeight:K.BO.semibold,marginBottom:"10px"}}}],sensitivitySection:[{marginTop:"40px",fontSize:K.s.smallPlus,".sensitivityTitle":{fontWeight:K.BO.semibold},".sensitivityLearnMore":{marginLeft:"6px"},".sensitivityMenuButton":{marginTop:"6px",borderRadius:"3px"},".sensitivityDescription":{marginTop:"10px"}}],footer:[{marginTop:"17px",borderRadius:"3px"}]};return(0,K.TW)(n,t)})),Xh=(0,G.J9)((e=>({root:(0,K.Zq)("rosterSecuritySettings settingsPane",e.root),form:(0,K.Zq)("form",e.form),rosterSecuritySettingsContent:(0,K.Zq)("rosterSecuritySettingContent",e.rosterSecuritySettingsContent),sensitivitySection:(0,K.Zq)("sensitivitySection",e.sensitivitySection),footer:(0,K.Zq)("rosterSecuritySettingsFooter",e.footer)})));class $h extends d.${name(){return"RosterSecuritySettings"}renderComponent(){const{hasSharedContainers:e}=this.props,t=this.getClassNames(),n=c.createElement("div",{className:"infoSection"},ht.p.Strings.RosterSecuritySettings_RosterSecuritySettingsInfoSectionString),o=c.createElement("div",{className:"privacySection"},c.createElement("div",{className:"header"},ht.p.Strings.GroupSettings_VisibilityLabel),e?ht.p.Strings.Plan_Group_PrivacyText_WithSharedContainers:ht.p.Strings.GroupSettings_VisibilityMode_Private);return c.createElement("div",{className:t.root},c.createElement("form",{className:t.form,autoComplete:"off",onSubmit:this.onSubmit},c.createElement("div",{className:t.rosterSecuritySettingsContent},n,o,this.renderSensitivity(t)),c.createElement("div",{className:t.footer},this.renderFooter(t))))}renderSensitivity(e){var t,n;if(!this.props.enableMIPLabels||st()(this.props.userAccessibleTenantSensitivityLabels))return null;if(!this.props.canChangeSensitivity)return c.createElement("div",{className:e.sensitivitySection},c.createElement("div",{className:"sensitivityTitle"},c.createElement("span",null,ht.p.Strings.GroupSettings_SensitivitySectionTitle)),c.createElement("div",{className:"sensitivityDescription"},ht.p.Strings.GroupSettings_SensitivityCannotEditMessage));let o=null;if(this.state.isSensitivityMenuOpen){const e=[];for(const t of this.props.userAccessibleTenantSensitivityLabels){const n=[];if(!st()(t.sublabels))for(const e of t.sublabels)n.push({key:e.id,text:e.displayName,ariaLabel:e.displayName,title:e.toolTip,onClick:()=>this.onSensitivitySelected(e)});e.push({key:t.id,text:t.displayName,ariaLabel:t.displayName,title:t.toolTip,onClick:()=>this.onSensitivitySelected(t),subMenuProps:st()(n)?void 0:{items:n}})}o=c.createElement(Yr.l,{shouldFocusOnMount:!0,items:e,target:this.sensitivityMenuButton,onDismiss:this.onSensitivityMenuDismiss,appTheme:this.props.theme})}return c.createElement("div",{className:e.sensitivitySection},c.createElement("div",{className:"sensitivityTitle"},c.createElement("span",null,ht.p.Strings.GroupSettings_SensitivitySectionTitle),c.createElement("a",{"aria-label":ht.p.Strings.GroupSettings_SensitivityLearnMoreLabelText,className:"sensitivityLearnMore",href:m.$j.sensitivityLabels,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.GroupSettings_SensitivityLearnMoreLabelText)),c.createElement(Gh,{sensitivityLabelTitle:Zh.k.getFullSensitivityTitle(null!==(t=null===(n=this.state.currentSensitivity)||void 0===n?void 0:n.id)&&void 0!==t?t:"",this.props.userAccessibleTenantSensitivityLabels),onClick:this.toggleSensitivityMenu,setRef:e=>this.sensitivityMenuButton=e,theme:this.props.theme}),o)}onSensitivitySelected(e){this.setState({isSensitivityMenuOpen:!1,currentSensitivity:e})}renderFooter(e){var t;const{enableMIPLabels:n,sensitivityPolicySettings:o,rosterContainer:i,userAccessibleTenantSensitivityLabels:r}=this.props;let a=!1;var s,l;null==this.state.currentSensitivity?a=!st()(null===(s=i.assignedSensitivityLabel)||void 0===s?void 0:s.sensitivityLabelId):a=this.state.currentSensitivity.id!==(null===(l=i.assignedSensitivityLabel)||void 0===l?void 0:l.sensitivityLabelId);const d=!a||n&&(null===(t=null===o||void 0===o?void 0:o.isMandatory)||void 0===t||t)&&!st()(r)&&a&&st()(this.state.currentSensitivity);return c.createElement("div",{className:e.footer},c.createElement(b.j,{className:"saveButton",disabled:d,type:"submit"},ht.p.Strings.SharedComponents_SaveButtonText))}updateRosterContainerSensitivityLabel(){var e,t;const n=this.props.rosterContainer,o={assignmentMethod:qh.Privileged,sensitivityLabelId:(null===(e=this.state.currentSensitivity)||void 0===e?void 0:e.id)||""};(null===(t=n.assignedSensitivityLabel)||void 0===t?void 0:t.sensitivityLabelId)!==o.sensitivityLabelId&&this.context.traceLogger.logTrace(507877014,Oc.k.Verbose,"Roster sensitivity label changed");const i=new Vh.j(n.externalId,o,n.itemVersion);this.props.onUpdateRosterSensitivityLabel(i)}getClassNames(){return Xh(Yh(this.props.theme))}constructor(e,t){super(e,t),this.toggleSensitivityMenu=e=>{e.preventDefault(),this.setState((e=>({isSensitivityMenuOpen:!e.isSensitivityMenuOpen})))},this.onSensitivityMenuDismiss=()=>{this.setState({isSensitivityMenuOpen:!1})},this.onSubmit=e=>{e.preventDefault(),this.updateRosterContainerSensitivityLabel()},this.state={isSensitivityMenuOpen:!1,currentSensitivity:this.props.rosterContainer.assignedSensitivityLabel&&Zh.k.getSensitivityLabel(this.props.rosterContainer.assignedSensitivityLabel.sensitivityLabelId,this.props.userAccessibleTenantSensitivityLabels)}}}var Jh,Qh=n(39068);!function(e){e[e.PlanSettings=0]="PlanSettings",e[e.ContainerSettings=1]="ContainerSettings",e[e.RosterSecuritySettings=2]="RosterSecuritySettings",e[e.NotificationSettings=3]="NotificationSettings"}(Jh||(Jh={}));class em extends d.${name(){return"PlanSettingsPanel"}renderComponent(){const e=(0,I.A)("planSettingsPanel",this.props.panelClassName);return c.createElement(ih.Z,{className:e,headerClassName:Qh.Z,hidden:!1,onDismiss:this.props.onDismiss,isOpen:!0,headerText:ht.p.Strings.PlanSettingsPanel_PlanSettingsPanelTitle,closeButtonAriaLabel:ht.p.Strings.PlannerApp_CloseDialogAriaLabel,isBlocking:!1,layerProps:{hostId:this.props.targetElementId,eventBubblingEnabled:!0},styles:gh,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,firstFocusableTarget:this.setFirstFocusTarget},onRenderNavigation:()=>null,type:rh.H.custom,customWidth:"400px",onKeyDown:this.stopPropagation,elementToFocusOnDismiss:this.props.elementToFocusOnDismiss},c.createElement(oh.H,{className:"landmark","aria-label":ht.p.Strings.PlanSettingsPanel_PlanSettingsPanelTitle,role:"region"},this.renderPanelContent()))}renderPanelContent(){const e=this.getClassNames(),t=(0,I.A)(e.root,this.props.panelContentClassName),n={plan:this.props.plan,planDetails:this.props.planDetails,planImageSuggestions:this.props.planImageSuggestions,container:this.props.container,dialogClassName:this.props.dialogClassName,isBackgroundSuggestionsEnabled:this.props.isBackgroundSuggestionsEnabled,theme:this.props.theme,planTitleRef:this.planTitleRef,onDismiss:this.props.onDismiss,onUpdatePlanEntitySet:this.props.onUpdatePlanEntitySet,onDeletePlan:this.props.onDeletePlan,onNavigateToHub:this.props.onNavigateToHub,fetchImageSuggestions:this.props.fetchImageSuggestions,queueImageRecommendationFeedback:this.props.queueImageRecommendationFeedback},o={enableMIPLabels:this.props.enableMIPLabels,sensitivityPolicySettings:this.props.sensitivityPolicySettings,theme:this.props.theme,userAccessibleTenantSensitivityLabels:this.props.sensitivityLabels,rosterContainer:this.props.container,hasSharedContainers:this.props.plan.sharedWithContainers.length>0,canChangeSensitivity:this.props.containerPermissions.canChangeSensitivity,onUpdateRosterSensitivityLabel:this.props.onUpdateRosterSensitivityLabel},i={plan:this.props.plan,planDetails:this.props.planDetails,container:this.props.container,userDetails:this.props.userDetails,isGuestUser:this.props.isGuestUser,isAssignedToNotificationsEditable:this.props.isAssignedToNotificationsEditable,isDueDateNotificationsEditable:this.props.isDueDateNotificationsEditable,theme:this.props.theme,onUpdatePlanEntitySet:this.props.onUpdatePlanEntitySet,onUpdateUserDetails:this.props.onUpdateUserDetails};return c.createElement("div",{className:t},this.renderNavigation(e),this.renderPivots(e),this.state.selectedPivot===Jh.PlanSettings&&c.createElement(Uh,n),this.state.selectedPivot===Jh.ContainerSettings&&this.props.containerSettings,this.state.selectedPivot===Jh.RosterSecuritySettings&&c.createElement($h,o),this.state.selectedPivot===Jh.NotificationSettings&&c.createElement(yh,i))}renderNavigation(e){return c.createElement("div",{className:e.settingsNavigation},c.createElement("div",{className:e.settingsTitle},ht.p.Strings.PlanSettingsPanel_PlanSettingsPanelTitle),c.createElement(Ks.K,{key:"close",className:"close-button",iconProps:Ne.s5,ariaLabel:ht.p.Strings.PlannerApp_CloseDialogAriaLabel,onClick:this.props.onDismiss,title:ht.p.Strings.PlannerApp_CloseDialogAriaLabel,plannerTheme:this.props.theme}))}renderPivots(e){const t=c.createElement("button",{className:(0,I.A)("pivotLink",{selected:this.state.selectedPivot===Jh.PlanSettings}),onClick:()=>{this.onClickPivot(Jh.PlanSettings)},tabIndex:0,role:"tab","aria-selected":this.state.selectedPivot===Jh.PlanSettings},ht.p.Strings.PlanSettingsPanel_PlanSettingsPivotTitle);let n=null;if(this.props.container.containerType===je.K.Group){const e=this.props.container;!!e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup===sh.N.Owner&&(n=c.createElement("button",{className:(0,I.A)("pivotLink",{selected:this.state.selectedPivot===Jh.ContainerSettings}),onClick:()=>{this.onClickPivot(Jh.ContainerSettings)},tabIndex:0,role:"tab","aria-selected":this.state.selectedPivot===Jh.ContainerSettings},ht.p.Strings.PlanSettingsPanel_GroupSettingsPivotTitle))}let o=null;this.props.container.containerType===je.K.Roster&&this.props.isRosterSecurityTabEnabled&&(o=c.createElement("button",{className:(0,I.A)("pivotLink",{selected:this.state.selectedPivot===Jh.RosterSecuritySettings}),onClick:()=>{this.onClickPivot(Jh.RosterSecuritySettings)},tabIndex:0,role:"tab","aria-selected":this.state.selectedPivot===Jh.RosterSecuritySettings},ht.p.Strings.PlanSettingsPanel_RosterSecurityPivotTitle));const i=c.createElement("button",{className:(0,I.A)("pivotLink",{selected:this.state.selectedPivot===Jh.NotificationSettings}),onClick:()=>{this.onClickPivot(Jh.NotificationSettings)},tabIndex:0,role:"tab","aria-selected":this.state.selectedPivot===Jh.NotificationSettings},ht.p.Strings.PlanSettingsPanel_NotificationSettingsPivotTitle);return c.createElement("div",{className:e.pivotSection,role:"tablist"},t,n,o,i)}onClickPivot(e){this.state.selectedPivot!==e&&this.setState({selectedPivot:e})}getClassNames(){return mh(this.props.styles)}constructor(e,t){super(e,t),this.planTitleRef=c.createRef(),this.stopPropagation=e=>{Vs.a.getKey(e)!==h.D.ESCAPE&&e.stopPropagation()},this.setFirstFocusTarget=()=>this.planTitleRef.current,this.state={selectedPivot:Jh.PlanSettings}}}var tm=n(78332),nm=n(7811);const om="17px",im={root:{fontSize:K.s.small,marginBottom:om},label:[(0,we.gS)(),{alignItems:"center"}]},rm=(0,G.J9)((e=>({root:(0,we.DC)(e)}))),am=(0,G.J9)((e=>{const t={message:{fontSize:K.s.small,marginBottom:om,li:{marginLeft:"50px",listStyleType:"disc"}}};return(0,K.TW)(t,e)})),sm=(0,G.J9)((e=>{const t=am(e);return{message:(0,K.Zq)("message",t.message)}}));class lm extends d.${name(){return"DeleteGroupDialog"}renderComponent(){const e=this.getClassNames();return c.createElement(u.l,{hidden:!this.props.deleteGroupDialogOpen,onDismiss:this.props.onDismiss.bind(this),dialogContentProps:{className:this.props.dialogContentClassName,title:ht.p.Strings.DeleteGroupDialog_DeleteGroupTitle,styles:(0,ft.XK)(this.props.theme)},styles:(0,ft.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1}},c.createElement("div",{className:"deleteGroupDialog"},c.createElement("div",{className:e.message},ht.p.Strings.DeleteGroupDialog_DeleteGroupMessage,c.createElement("br",null),c.createElement("br",null),ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessage,c.createElement("br",null),c.createElement("ul",null,c.createElement("li",null,ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessageOption1),c.createElement("li",null,ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessageOption2),c.createElement("li",null,ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessageOption3),c.createElement("li",null,ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessageOption4),c.createElement("li",null,ht.p.Strings.DeleteGroupDialog_DeleteGroupSubMessageOption5))),c.createElement(S.S,{className:"deleteGroupConfirmationCheckbox",label:ht.p.Strings.DeleteGroupDialog_DeleteGroupConfirmationCheckbox,defaultChecked:this.state.deleteConfirmationEnabled,styles:im,onChange:this.deleteConfirmationChanged.bind(this),appTheme:this.props.theme}),c.createElement(v.E,null,c.createElement(b.j,{className:"deleteGroupButton",onClick:this.props.deleteGroup.bind(this),disabled:!this.state.deleteConfirmationEnabled,styles:rm(this.props.theme)},ht.p.Strings.DeleteGroupDialog_DeleteGroupSave),c.createElement(y.Y,{className:"cancelDelete",onClick:this.props.onDismiss.bind(this)},ht.p.Strings.DeleteGroupDialog_DeleteGroupCancel))))}deleteConfirmationChanged(e,t){this.setState((e=>({...e,deleteConfirmationEnabled:t})))}getClassNames(){return sm(this.props.contentStyles)}constructor(e,t){super(e,t),this.state={deleteConfirmationEnabled:!1}}}var cm,dm=n(76241);!function(e){e.Private="VisibilityMode_Private",e.Public="VisibilityMode_Public"}(cm||(cm={}));var um=n(92970);const pm="9px",hm=(0,G.J9)(((e,t)=>{const n=(0,we.gS)(),o=[(0,we.GD)(),(0,we.gS)("column","nowrap"),{fontSize:K.s.medium,overflow:"hidden"}],i=[(0,we.GD)(),(0,we.gS)("column","nowrap"),{paddingRight:lh,overflowX:"hidden",overflowY:"auto","> .groupTitleSection, > .groupDescriptionSection, > .groupPrivacySection, > .groupClassificationSection":[(0,we.$Z)(),{margin:"".concat(ch," 0px"),"> .header":[(0,we.gS)(),{fontSize:K.s.small,fontWeight:K.BO.semibold,alignItems:"center",marginBottom:pm}]}],"> .groupPrivacySection":{".ms-ChoiceField-field.is-checked":[(0,we.T4)(e),{"::before, ::after":[e===m.Sx.TeamsContrast?{borderColor:Te.z.TeamsContrastSelectedColor}:(0,we.T4)(e)]}],".ms-ChoiceFieldLabel":[(0,we.aS)(e),{fontSize:K.s.small}]}}],r={marginBottom:pm,"> .sensitivityTitle":{fontSize:K.s.small,fontWeight:K.BO.semibold,marginBottom:pm,"> .sensitivityLearnMore":{marginLeft:"5px"}}},a={"> .header > .infoIcon":{display:"inline-block",verticalAlign:"middle",padding:"0px ".concat("3px")},a:{fontSize:K.s.small,padding:"5px 0px",textDecoration:"none"}},s=[(0,we.$Z)(),we.xK,{fontSize:K.s.small,cursor:"pointer",padding:"0px"," .icon":{paddingRight:"7px",color:Te.z.DarkRed,display:"inline-block"}}],l={root:n,form:o,groupSettingContent:i,groupSensitivitySection:r,groupClassificationSection:a,groupSettingsFooter:[(0,we.$Z)(),(0,we.gS)(),{paddingRight:ch,marginTop:dh,"> .buttonSection":(0,we.GD)(),"> .deleteGroup":s}]};return(0,K.TW)(l,t)})),mm=(0,G.J9)(((e,t)=>{const n=hm(e,t);return{root:(0,K.Zq)("groupSettings",n.root),form:(0,K.Zq)("form",n.form),groupSettingContent:(0,K.Zq)("groupSettingContent",n.groupSettingContent),groupSensitivitySection:(0,K.Zq)("groupSensitivitySection",n.groupSensitivitySection),groupClassificationSection:(0,K.Zq)("groupClassificationSection",n.groupClassificationSection),groupSettingsFooter:(0,K.Zq)("groupSettingsFooter",n.groupSettingsFooter)}}));class gm extends d.${name(){return"GroupSettings"}renderComponent(){const e=this.getClassNames();return c.createElement("div",{className:(0,I.A)(e.root,"settingsPane")},c.createElement("form",{className:e.form,onSubmit:this.onSubmit.bind(this),autoComplete:"off"},c.createElement("div",{className:e.groupSettingContent},this.renderGroupTitle(),this.renderGroupDescription(),this.renderPrivacy(),this.renderClassification(e),this.renderSensitivity(e)),this.renderFooter(e)),this.renderDeleteGroupDialog())}renderGroupTitle(){let e=nm.Lg.OK;if(this.checkValidationResult){const t=this.props.getTransaction(this.props.groupContainer.unifiedGroup.id+tm.Ek.ValidateGroupName);t&&t.status===up.x.Succeeded&&t.additionalData&&(e=t.additionalData.errorCode),this.checkValidationResult=!1}return c.createElement("div",{className:"groupTitleSection"},c.createElement("div",{className:"header"},ht.p.Strings.GroupSettings_GroupNameLabel),c.createElement(Be.A,{className:"name",maxLength:Ph.c.NameMaxLength,ariaLabel:ht.p.Strings.GroupSettings_GroupNameLabel,placeholder:ht.p.Strings.GroupSettings_GroupNamePlaceholder,value:this.state.groupTitle,required:!0,onChange:(e,t)=>{this.groupTitleChanged(t)},onGetErrorMessage:Qs()(this.getNameErrorMessage.bind(this,e),500),autoFocus:!0,styleType:Fe.u.Dialog,appTheme:this.props.theme}))}renderGroupDescription(){return c.createElement("div",{className:"groupDescriptionSection"},c.createElement("div",{className:"header"},ht.p.Strings.GroupSettings_GroupDescriptionLabel),c.createElement(Be.A,{multiline:!0,autoAdjustHeight:!0,className:"edit",ariaLabel:ht.p.Strings.GroupSettings_GroupDescriptionLabel,placeholder:ht.p.Strings.GroupSettings_GroupDescriptionPlaceholder,value:this.state.groupDescription,onChange:(e,t)=>{this.groupDescriptionChanged(t)},styleType:Fe.u.Dialog,maxLength:um.E.DescriptionMaxLength,appTheme:this.props.theme}))}renderPrivacy(){let e=!1;return!this.state.currentSensitivity||this.state.currentSensitivity.groupPrivacy!==m.$S.Public&&this.state.currentSensitivity.groupPrivacy!==m.$S.Private||(e=!0),c.createElement("div",{className:"groupPrivacySection"},c.createElement("div",{className:"header"},ht.p.Strings.GroupSettings_VisibilityLabel),c.createElement(St.n,{className:"visibilityMode",options:[{key:cm.Public,text:ht.p.Strings.GroupSettings_VisibilityMode_Public,disabled:e},{key:cm.Private,text:ht.p.Strings.GroupSettings_VisibilityMode_Private,disabled:e}],selectedKey:this.state.isPublic?cm.Public:cm.Private,onChange:this.groupPrivacyChanged,disabled:this.props.groupContainer.unifiedGroup.visibility===dm.X.HiddenMembership}))}renderClassification(e){if(!this.props.tenantGroupSettings||0===this.props.tenantGroupSettings.classificationList.length||this.props.tenantGroupSettings.enableMIPLabels)return null;const t=!st()(this.props.tenantGroupSettings.usageGuidelinesUrl),n=this.getClassificationDropdownOptions(),o=this.getClassificationDescription();let i;return i=st()(this.props.groupContainer.unifiedGroup.classification)?this.state.currentClassificationIndex>=0?this.props.tenantGroupSettings.classificationList[this.state.currentClassificationIndex]:ht.p.Strings.GroupSettings_ClassificationDropdownDefaultPlaceholder:this.props.groupContainer.unifiedGroup.classification,c.createElement("div",{className:e.groupClassificationSection},c.createElement("div",{className:"header"},ht.p.Strings.GroupSettings_ClassificationLabel,c.createElement("span",{className:"infoIcon"},c.createElement(C.I,{...Ne.h_,ariaLabel:o,title:o}))),c.createElement(Oe.m,{className:"classificationDropdown",onChange:this.groupClassificationChanged,options:n,placeholder:i,selectedKey:this.state.currentClassificationIndex,ariaLabel:ht.p.Strings.GroupSettings_ClassificationLabel,appTheme:this.props.theme}),t?c.createElement("a",{"aria-label":ht.p.Strings.GroupSettings_ClassificationUsageGuidelinesURL,className:"classificationUsageGuidelinesURL",href:this.props.tenantGroupSettings.usageGuidelinesUrl,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.GroupSettings_ClassificationUsageGuidelinesURL):null)}renderSensitivity(e){var t,n,o;if(null===(t=this.props.tenantGroupSettings)||void 0===t||!t.enableMIPLabels||st()(this.props.sensitivityLabels)||Kt.B.clientType===qt.s.Loop)return null;let i=null;if(this.state.isSensitivityMenuOpen){const e=[];for(const t of this.props.sensitivityLabels){const n=[];if(!st()(t.sublabels))for(const e of t.sublabels)n.push({key:e.id,text:e.displayName,ariaLabel:e.displayName,title:e.toolTip,onClick:()=>this.onSensitivitySelected(e)});e.push({key:t.id,text:t.displayName,ariaLabel:t.displayName,title:t.toolTip,onClick:()=>this.onSensitivitySelected(t),subMenuProps:st()(n)?void 0:{items:n}})}i=c.createElement(Yr.l,{shouldFocusOnMount:!0,items:e,target:this.sensitivityMenuButton,onDismiss:this.onSensitivityMenuDismiss.bind(this),appTheme:this.props.theme})}return c.createElement("div",{className:e.groupSensitivitySection},c.createElement("div",{className:"sensitivityTitle"},c.createElement("span",null,ht.p.Strings.GroupSettings_SensitivitySectionTitle),c.createElement("a",{"aria-label":ht.p.Strings.GroupSettings_SensitivityLearnMoreLabelText,className:"sensitivityLearnMore",href:m.$j.sensitivityLabels,target:"_blank",rel:"noopener noreferrer"},ht.p.Strings.GroupSettings_SensitivityLearnMoreLabelText)),c.createElement(Gh,{sensitivityLabelTitle:Zh.k.getFullSensitivityTitle(null!==(n=null===(o=this.state.currentSensitivity)||void 0===o?void 0:o.id)&&void 0!==n?n:"",this.props.sensitivityLabels),onClick:e=>this.toggleSensitivityMenu(e),setRef:e=>this.sensitivityMenuButton=e,theme:this.props.theme}),i)}renderFooter(e){var t,n,o,i;let r=!1;r=null==this.state.currentSensitivity?!st()(this.props.groupContainer.unifiedGroup.assignedSensitivityLabelId):this.state.currentSensitivity.id!==this.props.groupContainer.unifiedGroup.assignedSensitivityLabelId;const a=this.props.groupContainer.unifiedGroup.displayName===this.state.groupTitle&&this.props.groupContainer.unifiedGroup.description===this.state.groupDescription&&(this.props.groupContainer.unifiedGroup.visibility===dm.X.Public||null==this.props.groupContainer.unifiedGroup.visibility)===this.state.isPublic&&this.classificationIndexBeforeChange===this.state.currentClassificationIndex&&!r||null!==(t=null===(n=this.props.tenantGroupSettings)||void 0===n?void 0:n.enableMIPLabels)&&void 0!==t&&t&&(null===(o=null===(i=this.props.sensitivityPolicySettings)||void 0===i?void 0:i.isMandatory)||void 0===o||o)&&!st()(this.props.sensitivityLabels)&&r&&st()(this.state.currentSensitivity)||this.state.isNameEmpty||this.state.nameContainsBlockedWord;return c.createElement("div",{className:e.groupSettingsFooter},c.createElement("div",{className:"buttonSection"},c.createElement(b.j,{className:"saveButton",disabled:a,type:"submit"},ht.p.Strings.SharedComponents_SaveButtonText)),c.createElement("button",{className:"deleteGroup",onClick:this.openDeleteGroupDialog,type:"button"},c.createElement("span",{className:"icon"},c.createElement(C.I,Ne.Aw)),ht.p.Strings.GroupSettings_DeleteGroup))}renderDeleteGroupDialog(){return c.createElement(lm,{dialogContainerClassName:m.bI,dialogContentClassName:m.vt,dialogClassName:this.props.dialogClassName,onDismiss:this.closeDeleteGroupDialog,deleteGroupDialogOpen:this.state.isDeleteGroupDialogOpen,deleteGroup:this.deleteGroup,theme:this.props.theme})}updateGroup(){var e,t;const n=this.props.groupContainer.unifiedGroup;let o=n.setProperty("displayName",this.state.groupTitle);n.displayName!==this.state.groupTitle&&this.logUsage("ChangeGroupName"),o=o.setProperty("description",this.state.groupDescription),n.description!==this.state.groupDescription&&this.logUsage("ChangeGroupDescription"),this.props.groupContainer.unifiedGroup.visibility!==dm.X.HiddenMembership&&(o=o.setProperty("visibility",this.state.isPublic?dm.X.Public:dm.X.Private),n.visibility!==(this.state.isPublic?dm.X.Public:dm.X.Private)&&this.logUsage("ChangeGroupPrivacy")),this.state.currentClassificationIndex>=0&&null!=(null===(e=this.props.tenantGroupSettings)||void 0===e?void 0:e.classificationList)&&(o=o.setProperty("classification",this.props.tenantGroupSettings.classificationList[this.state.currentClassificationIndex]),n.classification!==this.props.tenantGroupSettings.classificationList[this.state.currentClassificationIndex]&&this.logUsage("ChangeGroupSensitivity")),o=o.setProperty("assignedSensitivityLabelId",(null===(t=this.state.currentSensitivity)||void 0===t?void 0:t.id)||"");const i={...this.props.groupContainer,unifiedGroup:o};this.props.onUpdateGroup(this.props.groupContainer,i),this.checkValidationResult=!0,this.classificationIndexBeforeChange=this.state.currentClassificationIndex}getNameErrorMessage(e,t){let n="",o=!1;var i;(this.state.isNameEmpty&&(n=ht.p.Strings.GroupSettings_NameError_Empty),st()(t))||(this.props.isTenantAdmin?o=!1:null!==(i=this.props.tenantGroupSettings)&&void 0!==i&&i.containsBlockedWord(t)&&(o=!0,n=ht.p.Strings.GroupSettings_NameError_Blocked));switch(e){case nm.Lg.MissingPrefixSuffix:const e=this.props.tenantGroupSettings?this.props.tenantGroupSettings.DisplayNamePrefix:"",t=this.props.tenantGroupSettings?this.props.tenantGroupSettings.DisplayNameSuffix:"";n=dt.G(ht.p.Strings.GroupSettings_NameError_MissingPrefixSuffix,e,t);break;case nm.Lg.ContainsCustomBlockedWords:case nm.Lg.ContainsMSStandardBlockedWords:case nm.Lg.ContainsDefaultReservedWords:n=ht.p.Strings.GroupSettings_NameError_Blocked;break;case nm.Lg.Unknown:n=ht.p.Strings.GroupSettings_NameError_Unknown}return this.state.nameContainsBlockedWord!==o&&this.setState({nameContainsBlockedWord:o}),n}getClassificationDropdownOptions(){var e;const t=[];return null===(e=this.props.tenantGroupSettings)||void 0===e||e.classificationList.forEach(((e,n)=>{const o={index:n,key:n,text:e};t.push(o)})),t}getClassificationDescription(){var e;let t=ht.p.Strings.GroupSettings_ClassificationDescriptionHeader;return null!=(null===(e=this.props.tenantGroupSettings)||void 0===e?void 0:e.classificationDescriptions)&&this.props.tenantGroupSettings.classificationDescriptions.length>0&&this.props.tenantGroupSettings.classificationDescriptions.forEach((e=>{t+="\n\n"+e})),t}toggleSensitivityMenu(e){e.preventDefault(),this.setState((e=>({isSensitivityMenuOpen:!e.isSensitivityMenuOpen})))}onSensitivityMenuDismiss(){this.setState({isSensitivityMenuOpen:!1})}onSensitivitySelected(e){let t=this.state.isPublic;switch(e.groupPrivacy){case m.$S.Public:t=!0;break;case m.$S.Private:t=!1;case m.$S.Unspecified:}this.setState({isSensitivityMenuOpen:!1,currentSensitivity:e,isPublic:t})}getClassNames(){const{theme:e,styles:t}=this.props;return mm(e,t)}constructor(e,t){var n;super(e,t),this.classificationIndexBeforeChange=-1,this.groupTitleChanged=e=>{const t=st()(fn()(e));this.setState({isNameEmpty:t,groupTitle:e})},this.groupDescriptionChanged=e=>{this.setState({groupDescription:e})},this.onSubmit=e=>{null!=e&&e.preventDefault(),this.state.isNameEmpty||this.state.nameContainsBlockedWord||this.updateGroup()},this.openDeleteGroupDialog=e=>{null!=e&&e.preventDefault(),this.setState({isDeleteGroupDialogOpen:!0})},this.closeDeleteGroupDialog=e=>{null!=e&&e.preventDefault(),this.setState({isDeleteGroupDialogOpen:!1})},this.deleteGroup=()=>{this.props.onDismiss(),this.props.onDeleteGroup(this.props.groupContainer),this.props.onNavigateToHub()},this.groupPrivacyChanged=(e,t)=>{this.setState({isPublic:t.key===cm.Public})},this.groupClassificationChanged=(e,t)=>{null!=t&&this.setState({currentClassificationIndex:t.key})},this.checkValidationResult=!1,null!=(null===(n=e.tenantGroupSettings)||void 0===n?void 0:n.classificationList)&&e.tenantGroupSettings.classificationList.length>0&&(st()(e.groupContainer.unifiedGroup.classification)?1===e.tenantGroupSettings.classificationList.length?this.classificationIndexBeforeChange=0:st()(e.tenantGroupSettings.defaultClassification)||(this.classificationIndexBeforeChange=e.tenantGroupSettings.classificationList.indexOf(e.tenantGroupSettings.defaultClassification)):this.classificationIndexBeforeChange=e.tenantGroupSettings.classificationList.indexOf(e.groupContainer.unifiedGroup.classification)),this.state={groupTitle:this.props.groupContainer.unifiedGroup.displayName,groupDescription:this.props.groupContainer.unifiedGroup.description,isNameEmpty:!1,nameContainsBlockedWord:!1,isDeleteGroupDialogOpen:!1,isPublic:this.props.groupContainer.unifiedGroup.visibility===dm.X.Public||null==this.props.groupContainer.unifiedGroup.visibility,currentClassificationIndex:this.classificationIndexBeforeChange,isSensitivityMenuOpen:!1,currentSensitivity:Zh.k.getSensitivityLabel(e.groupContainer.unifiedGroup.assignedSensitivityLabelId,e.sensitivityLabels)}}}var fm=n(19864);class vm extends l.F{renderComponent(){const{appContextStore:e}=this.props,t=e?e.getCurrentDialogDataLayers():[{dialogType:Zp.h.None}];return c.createElement(c.Fragment,null,rt()(t,(e=>this.renderBaseAppDialog(e))))}renderBaseAppDialog(e){var t,n,o,i,r,a,s;const{aggregatesStore:l,appContextStore:d,assigneeSuggestionStore:u,bucketStore:p,containerMembershipStore:h,groupDocumentsStore:g,intelligenceStore:f,permissionsStore:v,planStore:b,routeStore:y,taskStore:C,tenantStore:S,transactionStore:k,userStore:D,dispatcherEventManagement:x,containerStore:T,activityFeedProvider:E,experimentAssignments:w,onNavigateToPlan:_,actionCreatorProviders:P,formsTokenProvider:A}=this.props,R=d.getCurrentTheme(),L=Pt.d.parseThemeClassname(R),N=this.getLayerProps(),M=this.getFocusTrapZoneProps();switch(e.dialogType){case Zp.h.FormsIframe:const B=async t=>{this.logUsage(Mt.M.FormsRequirementsIframeDialog,{formResponseId:t});const n=await this.props.actionCreatorProviders.taskActionCreator();n.addFormResponseToTask(e.taskId,t,e.formId),n.fetchFormResponseForTask(e.taskId,e.formId)},F=async()=>{e.isOpenFromFormResponseView&&setTimeout(e.onDismiss,0);(await this.props.actionCreatorProviders.dialogActionCreator()).close()};return c.createElement(Ut,{onFormResponseIdReceived:B,urlFormId:e.urlFormId,onDismiss:F,dialogContentClassName:m.vt,dialogContainerClassName:m.bI,theme:R,formsTokenProvider:A,dispatcherEventManagement:x,planNameforTask:this.getPlanNameforTask(e.taskId)});case Zp.h.TaskDetails:const j=e.taskId,H=C.getTask(j);return null==H?null:c.createElement(wp,{dispatcherEventManagement:x,hostClient:Kt.B.clientType,task:H,dialogClassName:L,actionCreatorProviders:this.props.actionCreatorProviders,experimentAssignments:w,taskAccessContext:e.taskAccessContext,aggregatesStore:l,appContextStore:d,assigneeSuggestionStore:u,bucketStore:p,containerMembershipStore:h,groupDocumentsStore:g,intelligenceStore:f,permissionsStore:v,planStore:b,taskStore:C,transactionStore:k,containerStore:T,userStore:D,activityFeedProvider:E,onNavigateToPlan:_,layerProps:N,focusTrapZoneProps:M,loggers:this.context});case Zp.h.TaskAttachmentDetails:const z=e.attachment,U=e.taskId,W=C.getTaskDetails(U);return null==W?null:c.createElement(Kp,{attachment:z,linkDetailsEditorProps:{onDismiss:this.closeDialog,onLinkExists:e=>W.doesUrlExistAsAttachment(e)},onSaveAttachment:e=>{this.onUpsertAttachment(U,z,e),z||this.logUsage(Mt.M.AddAttachment,{type:"Link",entityId:U})},elementToFocusOnDismiss:e.elementToFocusOnDismiss,theme:R,layerProps:N,focusTrapZoneProps:M});case Zp.h.Error:return c.createElement(Ot,{dialogClassName:L,dialogContainerClassName:m.bI,dialogContentClassName:m.vt,errorHeader:e.errorHeader,errorMessage:e.errorMessage,correlationId:e.correlationId,onDismiss:this.closeDialog,theme:R,layerProps:N,focusTrapZoneProps:M});case Zp.h.Info:return c.createElement(Bt,{dialogClassName:L,dialogContainerClassName:m.bI,dialogContentClassName:m.vt,headerText:e.headerText,message:e.message,buttonText:e.buttonText,onButtonClick:e.onButtonClick?()=>{var t;null===(t=e.onButtonClick)||void 0===t||t.call(e)}:void 0,onDismiss:this.closeDialog,theme:R,layerProps:N,focusTrapZoneProps:M});case Zp.h.CopyTask:this.logUsage("CopyTaskDialogOpened");const G=e.taskId,q=C.getTask(G);if(null==q)return null;const V=b.getPlan(q.planId);if(null==V)return null;const Z=[],Y=h.getPlanIds(Kt.B.currentUserId);Y&&Y.forEach((e=>{const t=b.getPlan(e);t&&v.getPlanPermissions(t).canAcceptTasks&&Z.push(t)}));const X=D.getUserDetailsById(Kt.B.currentUserId),$=[];for(const e in null===X||void 0===X?void 0:X.recentPlans.references){const t=b.getPlan(e);t&&v.getPlanPermissions(t).canAcceptTasks&&$.push(t)}const J=[];for(const e in null===X||void 0===X?void 0:X.favoritePlans.references){const t=b.getPlan(e);t&&v.getPlanPermissions(t).canAcceptTasks&&J.push(t)}const Q=async()=>{this.closeDialog(),this.handleDismiss((()=>e.onDismiss()))},ee={mode:$e.Copy,operationModeProps:{task:q,enforceAssignmentsCopy:(0,$p.s)(y.getCurrentPage()),onCopyTask:e=>{this.onCopyTask(G,e)},onDismiss:Q,plan:V,availablePlans:Z,recentPlans:$,favoritePlans:J,onPlanSelect:async e=>{(await this.props.actionCreatorProviders.bucketActionCreator()).fetchBucketsForPlan(e)},getBuckets:e=>{const t=p.getBucketsForPlan(e);return t&&t.length>0&&t.sort(Jp.k),t},getPlanImage:this.getPlanImage,fetchAllPlans:async()=>{(await this.props.actionCreatorProviders.userPlansRetrievalActionCreator()).fetchAllPlans();const e=await this.props.actionCreatorProviders.unifiedGroupActionCreator();e.fetchFavoritePlansForCurrentUserAsync(!1),e.fetchRecentPlansForCurrentUserAsync()}},theme:R};return c.createElement(yt,{dialogClassName:"plannerAppDialog",dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:Q,copyAndMoveTaskCustomizerProps:ee,layerProps:N,focusTrapZoneProps:M});case Zp.h.MoveTask:const te=d.getCurrentUserId(),ne=e.taskId,oe=C.getTask(ne);if(null==oe)return null;const ie=b.getPlan(oe.planId);if(null==ie)return null;const re=ie.container.containerType!==je.K.User,ae=[],se=h.getPlanIds(te);se&&se.forEach((e=>{const t=b.getPlan(e);!t||re&&t.container.containerType===je.K.User||!v.getPlanPermissions(t).canAcceptTasks||ae.push(t)}));const le=D.getCurrentUserDetails(),ce=[],de=[];for(const e in le.recentPlans.references){const t=b.getPlan(e);!t||re&&t.container.containerType===je.K.User||!v.getPlanPermissions(t).canAcceptTasks||ce.push(t)}ce.sort(((e,t)=>Xp.S.CompareByDateAndAlpha(le.recentPlans.references[e.id],le.recentPlans.references[t.id])));for(const e in null===le||void 0===le?void 0:le.favoritePlans.references){const t=b.getPlan(e);!t||re&&t.container.containerType===je.K.User||!v.getPlanPermissions(t).canAcceptTasks||de.push(t)}de.sort(((e,t)=>Yp.j.CompareByAlpha(le.favoritePlans.references[e.id],le.favoritePlans.references[t.id])));const ue=()=>{this.closeDialog(),this.handleDismiss((()=>e.onDismiss()))},pe=!!oe.conversationThreadId&&null!=T.getContainerConversationThread(ie.container.externalId,oe.conversationThreadId),he={mode:$e.Move,operationModeProps:{hasComments:pe,task:oe,onMoveTask:e=>{this.onMoveTask(ne,e)},onDismiss:ue,plan:ie,planDetails:b.getPlanDetails(ie.id),availablePlans:ae,favoritePlans:de,recentPlans:ce,onPlanSelect:async e=>{(await this.props.actionCreatorProviders.bucketActionCreator()).fetchBucketsForPlan(e);const t=b.getPlan(e);if(t){(await this.props.actionCreatorProviders.userActionCreator()).fetchUsersForContainer(t.container)}},getBuckets:e=>{const t=p.getBucketsForPlan(e);return t&&t.length>0&&t.sort(Jp.k),t},getContainerMembers:this.getContainerMembers,getPlanImage:this.getPlanImage,getUser:this.getUser,fetchAllPlans:async()=>{(await this.props.actionCreatorProviders.userPlansRetrievalActionCreator()).fetchAllPlans();const e=await this.props.actionCreatorProviders.unifiedGroupActionCreator();e.fetchFavoritePlansForCurrentUserAsync(!1),e.fetchRecentPlansForCurrentUserAsync()}},theme:R};return c.createElement(yt,{dialogClassName:"plannerAppDialog",dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:ue,copyAndMoveTaskCustomizerProps:he,layerProps:N,focusTrapZoneProps:M});case Zp.h.DeleteRecurringTask:const me=()=>{this.closeDialog(),this.handleDismiss((()=>e.onDismiss()))},ge=async()=>{const t=e.taskId,n=C.getTask(t);this.closeDialog();(await this.props.actionCreatorProviders.taskActionCreator()).deleteTask(n.id,n.itemVersion),this.handleDismiss((()=>e.onDismiss()))},fe=async()=>{const t=e.taskId;this.closeDialog();(await this.props.actionCreatorProviders.taskActionCreator()).deleteTaskSeries(t),this.handleDismiss((()=>e.onDismiss()))};return c.createElement(_t,{dialogClassName:"plannerAppDialog",dialogContainerClassName:m.bI,dialogContentClassName:m.vt,onDismiss:me,deleteTask:ge,deleteTaskSeries:fe,theme:R,layerProps:N,focusTrapZoneProps:M});case Zp.h.AssignTaskWarning:const ve=d.getClientFlavor()===Gt.g.TeamsTab,be=()=>{this.closeDialog()},ye=async()=>{const t=e.taskId,n=e.onAssignSuccess;let o=C.getTask(t);null==o&&(o=(0,Qp.YO)(t,e.planId));const i=o.getClone(),r=e.userId;i.assignments[r]=new gp.I(d.getCurrentUserId(),new Date);(await this.props.actionCreatorProviders.taskActionCreator()).assignTask({userId:r,originalTask:o,updatedTask:i,addNewMember:!0,onAssignSuccess:n}),be()};let Ce,Se,ke,De,xe;if(!ve&&Kt.B.isUnoContext){var O;const t=b.getContainerIdForPlan(e.planId),n=t?T.getContainer(t):null,o=(null===n||void 0===n?void 0:n.containerType)===je.K.Group?n:null,i=null!==(O=null===o||void 0===o?void 0:o.unifiedGroup)&&void 0!==O?O:null,r=async()=>{be();(await this.props.actionCreatorProviders.dialogActionCreator()).openSharePlanDialog(e.planId,[e.userId])};Ce=async()=>{i?await ye():await r()},Se=i?ht.p.Strings.AssignTaskWarningDialog_AddNonMemberWarningTitle:ht.p.Strings.AssignTaskWarningDialog_UnsharedPlanTitle,ke=i?ht.p.Strings.AssignTaskWarningDialog_HostContainerAccessOnlyMessage:ht.p.Strings.AssignTaskWarningDialog_UnsharedPlanText,De=i?ht.p.Strings.AssignTaskWarningDialog_AddNonMemberOK:ht.p.Strings.AssignTaskWarningDialog_CreateGroupOKText,xe={content:{".message":{fontSize:K.s.medium}}}}else Ce=ye,Se=ht.p.Strings.AssignTaskWarningDialog_AddNonMemberWarningTitle,ke=e.assignerHasSharedContainerAccess?ht.p.Strings.AssignTaskWarningDialog_HostAndSharedContainerAccessMessage:ht.p.Strings.AssignTaskWarningDialog_HostContainerAccessOnlyMessage,De=ht.p.Strings.AssignTaskWarningDialog_AddNonMemberOK;return c.createElement(Vp,{theme:R,dialogClassName:m.y$,elementToFocusOnDismiss:e.elementToFocusOnDismiss,onDismiss:be,onOK:Ce,layerProps:N,focusTrapZoneProps:M,titleText:Se,messageText:ke,okButtonText:De,dialogContentStyles:xe});case Zp.h.ShareFileWarning:const Te=null!==(t=b.getPlan(e.planId))&&void 0!==t?t:void 0,Ee=()=>{this.closeDialog()},we=async t=>{const n=e.taskId,o=e.onAssignSuccess;let i=C.getTask(n);null==i&&(i=(0,Qp.YO)(n,e.planId));const r=i.getClone(),a=e.userId;r.assignments[a]=new gp.I(d.getCurrentUserId(),new Date);(await this.props.actionCreatorProviders.taskActionCreator()).assignTask({userId:a,originalTask:i,updatedTask:r,shareFile:!0,vroomId:t,onAssignSuccess:o}),Ee()};return c.createElement(Nt,{sharedWithContainers:null!==(n=null===Te||void 0===Te?void 0:Te.sharedWithContainers)&&void 0!==n?n:[],theme:R,dialogClassName:m.y$,elementToFocusOnDismiss:e.elementToFocusOnDismiss,onDismiss:Ee,onOK:we,getDriveItemStatus:e=>g.getDriveItemStatus(e),getDriveItem:e=>g.getDriveItem(e),layerProps:N,focusTrapZoneProps:M});case Zp.h.EditPlan:const _e=e.planId,Ie=b.getPlan(_e);if(null==Ie)return this.context.traceLogger.logTrace(508077504,Oc.k.Error,"EditPlan Dialog - current plan is null, [PlanId=".concat(_e,"]")),null;const Pe=b.getPlanDetails(_e);if(null==Pe)return this.context.traceLogger.logTrace(508077475,Oc.k.Error,"EditPlan Dialog - current plan details is null, [PlanId=".concat(_e,"]")),null;const Ae=Ie.container.containerType===je.K.Roster&&(0,Lt.NL)({sharedWithContainers:Ie.sharedWithContainers,getDriveItemStatus:e=>g.getDriveItemStatus(e)}),Re=null!=Ie?T.getContainer(Ie.container.externalId):null,Le=null!==Re&&void 0!==Re?Re:Ae?new Vh.j(Ie.container.externalId,null,""):null;if(null==Le)return this.context.traceLogger.logTrace(508077474,Oc.k.Error,"EditPlan Dialog - current container is null, [PlanId=".concat(_e,"]")),null;const Ne=D.getUserDetailsById(Kt.B.currentUserId);if(null==Ne)return this.context.traceLogger.logTrace(508077473,Oc.k.Error,"EditPlan Dialog - current user details is null"),null;let Me=null;if(Le.containerType===je.K.Group){const e=Le;Me=c.createElement(gm,{groupContainer:e,tenantGroupSettings:S.getCurrentTenantGroupSettings(),sensitivityLabels:S.getCurrentSensitivityLabels(),sensitivityPolicySettings:S.getCurrentSensitivityPolicySettings(),isTenantAdmin:d.isCurrentUserTenantAdmin(),dialogClassName:L,onDeleteGroup:this.onDeletePlanContainer,onDismiss:this.closeDialog,onUpdateGroup:this.onUpdatePlanContainer,getTransaction:k.getTransaction.bind(k),onNavigateToHub:()=>this.navigateToPage(Zt.EC.PlanHub,{}),theme:R})}const Oe=Le?v.getContainerPermissions(Le):v.getDefaultContainerPermissions(Ie.container),Be=this.getPanelClassNames();return c.createElement(em,{panelClassName:(0,I.A)(Be.root,L),panelContentClassName:"plannerAppPanelContents",container:Le,onDismiss:this.onDismissPlanSettingsPanel,plan:Ie,planDetails:Pe,userDetails:Ne,isGuestUser:Kt.B.isGuestUser,isAssignedToNotificationsEditable:Kt.B.clientSettings.Notifications_AssignedToEnabled,isDueDateNotificationsEditable:Kt.B.clientSettings.Notifications_DueDateEnabled,containerSettings:Me,enableMIPLabels:null!==(o=null===(i=S.getCurrentTenantGroupSettings())||void 0===i?void 0:i.enableMIPLabels)&&void 0!==o&&o,sensitivityLabels:S.getCurrentSensitivityLabels(),sensitivityPolicySettings:S.getCurrentSensitivityPolicySettings(),planImageSuggestions:null!==(r=null===(a=this.props.intelligenceStore.getImageSuggestions(_e))||void 0===a?void 0:a.results)&&void 0!==r?r:null,onUpdatePlanEntitySet:async e=>{(await P.planActionCreator()).updatePlanEntitySet(yu.T.builder.withPlan(Ie).withDetails(Pe).build(),e)},onUpdateRosterSensitivityLabel:async e=>{(await P.containerActionCreator()).updateContainer(e)},onUpdateUserDetails:async(e,t)=>{(await P.userActionCreator()).updateUserDetails(e,t)},onDeletePlan:async()=>{var e,t;(await P.planActionCreator()).deletePlan(_e,Ie.itemVersion,Ie.container),null===(e=(t=this.props).planDeleteCallback)||void 0===e||e.call(t,_e)},onNavigateToHub:()=>this.navigateToPage(Zt.EC.PlanHub,{}),dialogClassName:L,isBackgroundSuggestionsEnabled:Kt.B.clientType===qt.s.Plex&&d.getFlights().EnableImageRecommendations,isRosterSecurityTabEnabled:d.getFlights().EnableRosterSecurityTab,containerPermissions:Oe,fetchImageSuggestions:this.getPlanImageRecommendations,queueImageRecommendationFeedback:async(e,t)=>{(await P.intelligenceActionCreator()).queueImageRecommendationFeedback(e,t)},targetElementId:(0,fm.cL)(d.getAppInstanceId()),theme:d.getCurrentTheme(),elementToFocusOnDismiss:e.elementToFocusOnDismiss});case Zp.h.LeavePlan:const Fe=e.planId,He=b.getPlan(Fe),ze=null!=He?T.getContainer(He.container.externalId):null,Ue=(null===ze||void 0===ze?void 0:ze.containerType)===je.K.Group&&null!==(s=ze.unifiedGroup)&&void 0!==s?s:null;if(!He||He.container.containerType===je.K.Group&&null==Ue)return this.context.traceLogger.logTrace(508077472,Oc.k.Error,"EditPlan Dialog - current group is null, [PlanId=".concat(Fe,"]")),null;const We=()=>{this.onLeavePlan(Fe)};return c.createElement(nh,{dialogContainerClassName:m.bI,dialogContentClassName:m.vt,dialogClassName:"leavePlan",dialogTitle:He.container.containerType===je.K.Group?ht.p.Strings.LeavePlanDialog_LeavePlanAndGroupTitle:ht.p.Strings.LeavePlanDialog_LeavePlanTitle,leaveConfirmationCheckboxLabel:He.container.containerType===je.K.Group?ht.p.Strings.LeavePlanDialog_LeavePlanAndGroupConfirmationCheckbox:ht.p.Strings.LeavePlanDialog_LeavePlanConfirmationCheckbox,leavePlan:We,onDismiss:this.closeDialog,theme:d.getCurrentTheme(),layerProps:N,focusTrapZoneProps:M});default:return null}}getPanelClassNames(){return(0,ft.G3)(this.props.appContextStore.getCurrentTheme())}handleDismiss(e){setTimeout(e,0)}async onUpsertAttachment(e,t,n){const{actionCreatorProviders:o,taskStore:i}=this.props,r=i.getTaskDetails(e);if(null==r)return;let a;const s=r.getReferenceWithLowestPriority();let l;l=null!=s?gl.O.generateOrderHintBetween(null,s.previewPriority):gl.O.generateOrderHintBetween(null,null),null==t?(n=n.setProperty("previewPriority",l),a=r.addAttachment(n),a.previewType===Cu.X.Automatic&&(a=a.setProperty("previewType",Cu.X.Reference))):(t.url!==n.url&&(n=n.setProperty("previewPriority",l)),a=r.replaceAttachment(t,n),this.logUsage(Mt.M.EditAttachment,{entityId:r.id}));const c=await o.taskActionCreator();c.updateTaskDetails(r,a),c.ensureTaskReferencePreviewThumbnail(a,n),this.closeDialog()}getPlanNameforTask(e){var t;const n=this.props.taskStore.getTask(e);if(null==n)return"";const o=this.props.planStore.getPlan(n.planId);if(null==(null===o||void 0===o?void 0:o.contexts))return"";const i=(0,Ku.g)(o.contexts,qt.s.Teams),r=null!==i?i:"",a=this.props.containerStore.getContainer(o.container.externalId);if((null===a||void 0===a?void 0:a.containerType)!==je.K.DriveItem&&st()(r))return"";const s=null!==(t=null===a||void 0===a?void 0:a.displayName)&&void 0!==t?t:"",l=o.contexts[r],c=(0,nu.e)(l,s);return c&&c.length>0?c[0]:""}getLayerProps(){}getFocusTrapZoneProps(){}constructor(e,t){super(e,t),this.getPlanImageRecommendations=async(e,t)=>{if(Kt.B.clientType!==qt.s.Plex||!this.props.appContextStore.getFlights().EnableImageRecommendations)return;const n=this.props.intelligenceStore.getImageSuggestions(e);if(null==n||n.query!==t){(await this.props.actionCreatorProviders.intelligenceActionCreator()).fetchImageRecommendations(e,t)}},this.onUpdatePlanContainer=async(e,t)=>{if(e.containerType===je.K.Group){const n=e,o=t;(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).validateNamesBeforeUpdate(n.unifiedGroup,o.unifiedGroup)}},this.onDeletePlanContainer=async e=>{if(e.containerType===je.K.Group){(await this.props.actionCreatorProviders.containerActionCreator()).deleteContainer(e.id)}},this.onDismissPlanSettingsPanel=async()=>{(await this.props.actionCreatorProviders.intelligenceActionCreator()).commitPendingTextToImageTraces(),this.closeDialog()},this.onLeavePlan=async e=>{var t;const{containerStore:n,planStore:o,actionCreatorProviders:i}=this.props,r=o.getPlan(e);if(null==r)return;const a=n.getContainer(r.container.externalId),s=(null===a||void 0===a?void 0:a.containerType)===je.K.Group&&null!==(t=a.unifiedGroup)&&void 0!==t?t:null;if(r.container.containerType===je.K.Group&&null!=s){(await i.unifiedGroupActionCreator()).leaveGroup(s.id);(await i.notificationActionCreator()).showInfo(Vt.fc.NonMemberInfo)}else{(await i.userActionCreator()).removeUserFromContainer(Kt.B.currentUserId,r.container)}},this.closeDialog=async()=>{(await this.props.actionCreatorProviders.dialogActionCreator()).close()},this.navigateToPage=async(e,t)=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(e,t)},this.getPlanImage=e=>{const t=this.props.planStore.getPlan(e),n=this.props.planStore.getPlanDetails(e);return t&&(0,Fc.R6)(t,n,(e=>this.props.containerStore.getContainerPhotoById(e)))},this.getContainerMembers=e=>this.props.userStore.getContainerUsers(e),this.getUser=e=>this.props.userStore.getUserById(e),this.onCopyTask=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).copyTask(e,t)},this.onMoveTask=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).moveTask(e,t)},this.state={}}}var bm=n(17942);class ym extends vm{name(){return"LoopAppDialog"}getLayerProps(){return{hostId:this.props.targetContainerElementId,styles:bm.V}}getFocusTrapZoneProps(){return{forceFocusInsideTrap:!1}}constructor(e,t){super(e,t)}}},77265:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var o=n(65818),i=n(64836);class r extends i.m{constructor(e,t,n){super({externalId:e,containerType:o.K.Roster}),this.assignedSensitivityLabel=t,this.itemVersion=n}}},82229:(e,t,n)=>{"use strict";var o;function i(e,t){return 0!==(e&t)}n.d(t,{P:()=>i,u:()=>o}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableUpdateApprovalRequirement=1]="DisableUpdateApprovalRequirement",e[e.DisableUpdateApprovalRequest=2]="DisableUpdateApprovalRequest",e[e.DisableAll=3]="DisableAll"}(o||(o={}))},13862:(e,t,n)=>{"use strict";var o;function i(e,t){return 0!==(e&t)}n.d(t,{J:()=>o,M:()=>i}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableUpdateFormRequirement=1]="DisableUpdateFormRequirement",e[e.DisableViewAllFormResponses=2]="DisableViewAllFormResponses",e[e.DisableSubmitForm=4]="DisableSubmitForm",e[e.DisableAll=7]="DisableAll"}(o||(o={}))},49728:(e,t,n)=>{"use strict";n.d(t,{$p:()=>g,YO:()=>h,bN:()=>d,iG:()=>c,l5:()=>p,qj:()=>u,rA:()=>m});var o=n(16701),i=n(34717),r=n(50723),a=n.n(r),s=n(54320),l=n.n(s);function c(e,t){const n=e.reduce(((e,t)=>(t.appliedCategories.forEach((t=>{e[t]=!0})),e)),{});return t.forEach(((e,t)=>{null!==e&&e.length>0&&(n[t]=!0)})),n}function d(e){return e.reduce(((e,t)=>(t.getAssigneeIds().forEach((t=>{e[t]=!0})),e)),{})}function u(e){const t={},n=[];for(const o of e){const e=o.planId;o.isProjectTask()&&!t[e]&&(t[e]=o,n.push(o))}return n}function p(e,t){return a()(e,(e=>{var n,o;return!l()(null===(n=t.checklist[e.id])||void 0===n?void 0:n.orderHint)&&(null===(o=t.checklist[e.id])||void 0===o?void 0:o.orderHint)!==e.orderHint})).length>0}function h(e,t){return i.Y.builder.withPropertyBag({id:e,title:"tempTask",planId:t}).build()}function m(e,t,n){const i=d(t);return e.filter((e=>i[e.id]||n.doesFilterValueExist(o.Gx.Assignment,e.id)))}function g(e,t,n){let i=e.map(((e,t)=>({categoryNumber:t,categoryName:e})));if(null!=t){const r=c(t,e);i=i.filter((e=>{let{categoryNumber:t}=e;return r[t]||n.doesFilterValueExist(o.Gx.Label,t)}))}return i}},141:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var o=n(28730);function i(e,t){return o.l.compareStringForDisplay(null!==e&&void 0!==e&&e.displayName?e.displayName.toUpperCase():null,null!==t&&void 0!==t&&t.displayName?t.displayName.toUpperCase():null)}},63532:(e,t,n)=>{var o=n(85884),i={};for(var r in o)o.hasOwnProperty(r)&&(i[o[r]]=r);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var s in a)if(a.hasOwnProperty(s)){if(!("channels"in a[s]))throw new Error("missing channels property: "+s);if(!("labels"in a[s]))throw new Error("missing channel labels property: "+s);if(a[s].labels.length!==a[s].channels)throw new Error("channel and label counts mismatch: "+s);var l=a[s].channels,c=a[s].labels;delete a[s].channels,delete a[s].labels,Object.defineProperty(a[s],"channels",{value:l}),Object.defineProperty(a[s],"labels",{value:c})}a.rgb.hsl=function(e){var t,n,o=e[0]/255,i=e[1]/255,r=e[2]/255,a=Math.min(o,i,r),s=Math.max(o,i,r),l=s-a;return s===a?t=0:o===s?t=(i-r)/l:i===s?t=2+(r-o)/l:r===s&&(t=4+(o-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+s)/2,[t,100*(s===a?0:n<=.5?l/(s+a):l/(2-s-a)),100*n]},a.rgb.hsv=function(e){var t,n,o,i,r,a=e[0]/255,s=e[1]/255,l=e[2]/255,c=Math.max(a,s,l),d=c-Math.min(a,s,l),u=function(e){return(c-e)/6/d+.5};return 0===d?i=r=0:(r=d/c,t=u(a),n=u(s),o=u(l),a===c?i=o-n:s===c?i=1/3+t-o:l===c&&(i=2/3+n-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*r,100*c]},a.rgb.hwb=function(e){var t=e[0],n=e[1],o=e[2];return[a.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,o))),100*(o=1-1/255*Math.max(t,Math.max(n,o)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,o=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-o,1-i)))/(1-t)||0),100*((1-o-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=i[e];if(t)return t;var n,r,a,s=1/0;for(var l in o)if(o.hasOwnProperty(l)){var c=o[l],d=(r=e,a=c,Math.pow(r[0]-a[0],2)+Math.pow(r[1]-a[1],2)+Math.pow(r[2]-a[2],2));d<s&&(s=d,n=l)}return n},a.keyword.rgb=function(e){return o[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,o=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)),100*(.2126*t+.7152*n+.0722*o),100*(.0193*t+.1192*n+.9505*o)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],o=t[1],i=t[2];return o/=100,i/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116)-16,500*(n-o),200*(o-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},a.hsl.rgb=function(e){var t,n,o,i,r,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0===s)return[r=255*l,r,r];t=2*l-(n=l<.5?l*(1+s):l+s-l*s),i=[0,0,0];for(var c=0;c<3;c++)(o=a+1/3*-(c-1))<0&&o++,o>1&&o--,r=6*o<1?t+6*(n-t)*o:2*o<1?n:3*o<2?t+(n-t)*(2/3-o)*6:t,i[c]=255*r;return i},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,o=e[2]/100,i=n,r=Math.max(o,.01);return n*=(o*=2)<=1?o:2-o,i*=r<=1?r:2-r,[t,100*(0===o?2*i/(r+i):2*n/(o+n)),100*((o+n)/2)]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,o=e[2]/100,i=Math.floor(t)%6,r=t-Math.floor(t),a=255*o*(1-n),s=255*o*(1-n*r),l=255*o*(1-n*(1-r));switch(o*=255,i){case 0:return[o,l,a];case 1:return[s,o,a];case 2:return[a,o,l];case 3:return[a,s,o];case 4:return[l,a,o];case 5:return[o,a,s]}},a.hsv.hsl=function(e){var t,n,o,i=e[0],r=e[1]/100,a=e[2]/100,s=Math.max(a,.01);return o=(2-r)*a,n=r*s,[i,100*(n=(n/=(t=(2-r)*s)<=1?t:2-t)||0),100*(o/=2)]},a.hwb.rgb=function(e){var t,n,o,i,r,a,s,l=e[0]/360,c=e[1]/100,d=e[2]/100,u=c+d;switch(u>1&&(c/=u,d/=u),o=6*l-(t=Math.floor(6*l)),0!==(1&t)&&(o=1-o),i=c+o*((n=1-d)-c),t){default:case 6:case 0:r=n,a=i,s=c;break;case 1:r=i,a=n,s=c;break;case 2:r=c,a=n,s=i;break;case 3:r=c,a=i,s=n;break;case 4:r=i,a=c,s=n;break;case 5:r=n,a=c,s=i}return[255*r,255*a,255*s]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,o=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,o*(1-i)+i))]},a.xyz.rgb=function(e){var t,n,o,i=e[0]/100,r=e[1]/100,a=e[2]/100;return n=-.9689*i+1.8758*r+.0415*a,o=.0557*i+-.204*r+1.057*a,t=(t=3.2406*i+-1.5372*r+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:12.92*o,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(o=Math.min(Math.max(0,o),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],o=e[2];return n/=100,o/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},a.lab.xyz=function(e){var t,n,o,i=e[0];t=e[1]/500+(n=(i+16)/116),o=n-e[2]/200;var r=Math.pow(n,3),a=Math.pow(t,3),s=Math.pow(o,3);return n=r>.008856?r:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,o=s>.008856?s:(o-16/116)/7.787,[t*=95.047,n*=100,o*=108.883]},a.lab.lch=function(e){var t,n=e[0],o=e[1],i=e[2];return(t=360*Math.atan2(i,o)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(o*o+i*i),t]},a.lch.lab=function(e){var t,n=e[0],o=e[1];return t=e[2]/360*2*Math.PI,[n,o*Math.cos(t),o*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],o=e[2],i=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(i=Math.round(i/50)))return 30;var r=30+(Math.round(o/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===i&&(r+=60),r},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],o=e[2];return t===n&&n===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(o/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var o=parseInt(n,16);return[o>>16&255,o>>8&255,255&o]},a.rgb.hcg=function(e){var t,n=e[0]/255,o=e[1]/255,i=e[2]/255,r=Math.max(Math.max(n,o),i),a=Math.min(Math.min(n,o),i),s=r-a;return t=s<=0?0:r===n?(o-i)/s%6:r===o?2+(i-n)/s:4+(n-o)/s+4,t/=6,[360*(t%=1),100*s,100*(s<1?a/(1-s):0)]},a.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,o=1,i=0;return(o=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*o)/(1-o)),[e[0],100*o,100*i]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,o=t*n,i=0;return o<1&&(i=(n-o)/(1-o)),[e[0],100*o,100*i]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,o=e[2]/100;if(0===n)return[255*o,255*o,255*o];var i,r=[0,0,0],a=t%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=l,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=l,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=l}return i=(1-n)*o,[255*(n*r[0]+i),255*(n*r[1]+i),255*(n*r[2]+i)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),o=0;return n>0&&(o=t/n),[e[0],100*o,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,o=0;return n>0&&n<.5?o=t/(2*n):n>=.5&&n<1&&(o=t/(2*(1-n))),[e[0],100*o,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,o=n-t,i=0;return o<1&&(i=(n-o)/(1-o)),[e[0],100*o,100*i]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},90053:(e,t,n)=>{var o=n(63532),i=n(60444),r={};Object.keys(o).forEach((function(e){r[e]={},Object.defineProperty(r[e],"channels",{value:o[e].channels}),Object.defineProperty(r[e],"labels",{value:o[e].labels});var t=i(e);Object.keys(t).forEach((function(n){var o=t[n];r[e][n]=function(e){var t=function(t){if(void 0===t||null===t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"===typeof n)for(var o=n.length,i=0;i<o;i++)n[i]=Math.round(n[i]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(o),r[e][n].raw=function(e){var t=function(t){return void 0===t||null===t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(o)}))})),e.exports=r},85884:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},60444:(e,t,n)=>{var o=n(63532);function i(e){var t=function(){for(var e={},t=Object.keys(o),n=t.length,i=0;i<n;i++)e[t[i]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var i=n.pop(),r=Object.keys(o[i]),a=r.length,s=0;s<a;s++){var l=r[s],c=t[l];-1===c.distance&&(c.distance=t[i].distance+1,c.parent=i,n.unshift(l))}return t}function r(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],i=o[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),i=r(o[t[a].parent][a],i),a=t[a].parent;return i.conversion=n,i}e.exports=function(e){for(var t=i(e),n={},o=Object.keys(t),r=o.length,s=0;s<r;s++){var l=o[s];null!==t[l].parent&&(n[l]=a(l,t))}return n}},38301:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},21139:(e,t,n)=>{var o=n(38301),i=n(69849),r=Object.hasOwnProperty,a=Object.create(null);for(var s in o)r.call(o,s)&&(a[o[s]]=s);var l=e.exports={to:{},get:{}};function c(e,t,n){return Math.min(Math.max(t,e),n)}function d(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),n="hsl";break;case"hwb":t=l.get.hwb(e),n="hwb";break;default:t=l.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,n,i,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],n=0;n<3;n++){var s=2*n;a[n]=parseInt(t.slice(s,s+2),16)}i&&(a[3]=parseInt(i,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],n=0;n<3;n++)a[n]=parseInt(t[n]+t[n],16);i&&(a[3]=parseInt(i+i,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)a[n]=parseInt(t[n+1],0);t[4]&&(t[5]?a[3]=.01*parseFloat(t[4]):a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:r.call(o,t[1])?((a=o[t[1]])[3]=1,a):null:null;for(n=0;n<3;n++)a[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(t[5]?a[3]=.01*parseFloat(t[4]):a[3]=parseFloat(t[4]))}for(n=0;n<3;n++)a[n]=c(a[n],0,255);return a[3]=c(a[3],0,1),a},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var e=i(arguments);return"#"+d(e[0])+d(e[1])+d(e[2])+(e[3]<1?d(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=i(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=i(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),o=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+o+"%)":"rgba("+t+"%, "+n+"%, "+o+"%, "+e[3]+")"},l.to.hsl=function(){var e=i(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=i(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return a[e.slice(0,3)]}},42995:(e,t,n)=>{"use strict";var o=n(21139),i=n(90053),r=[].slice,a=["keyword","gray","hex"],s={};Object.keys(i).forEach((function(e){s[r.call(i[e].labels).sort().join("")]=e}));var l={};function c(e,t){if(!(this instanceof c))return new c(e,t);if(t&&t in a&&(t=null),t&&!(t in i))throw new Error("Unknown model: "+t);var n,d;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof c)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"===typeof e){var u=o.get(e);if(null===u)throw new Error("Unable to parse color from string: "+e);this.model=u.model,d=i[this.model].channels,this.color=u.value.slice(0,d),this.valpha="number"===typeof u.value[d]?u.value[d]:1}else if(e.length){this.model=t||"rgb",d=i[this.model].channels;var h=r.call(e,0,d);this.color=p(h,d),this.valpha="number"===typeof e[d]?e[d]:1}else if("number"===typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var m=Object.keys(e);"alpha"in e&&(m.splice(m.indexOf("alpha"),1),this.valpha="number"===typeof e.alpha?e.alpha:0);var g=m.sort().join("");if(!(g in s))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=s[g];var f=i[this.model].labels,v=[];for(n=0;n<f.length;n++)v.push(e[f[n]]);this.color=p(v)}if(l[this.model])for(d=i[this.model].channels,n=0;n<d;n++){var b=l[this.model][n];b&&(this.color[n]=b(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function d(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(l[e]||(l[e]=[]))[t]=n})),e=e[0],function(o){var i;return arguments.length?(n&&(o=n(o)),(i=this[e]()).color[t]=o,i):(i=this[e]().color[t],n&&(i=n(i)),i)}}function u(e){return function(t){return Math.max(0,Math.min(e,t))}}function p(e,t){for(var n=0;n<t;n++)"number"!==typeof e[n]&&(e[n]=0);return e}c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in o.to?this:this.rgb(),n=1===(t=t.round("number"===typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return o.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"===typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return o.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=i[this.model].channels,n=i[this.model].labels,o=0;o<t;o++)e[n[o]]=this.color[o];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new c(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:d("rgb",0,u(255)),green:d("rgb",1,u(255)),blue:d("rgb",2,u(255)),hue:d(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:d("hsl",1,u(100)),lightness:d("hsl",2,u(100)),saturationv:d("hsv",1,u(100)),value:d("hsv",2,u(100)),chroma:d("hcg",1,u(100)),gray:d("hcg",2,u(100)),white:d("hwb",1,u(100)),wblack:d("hwb",2,u(100)),cyan:d("cmyk",0,u(100)),magenta:d("cmyk",1,u(100)),yellow:d("cmyk",2,u(100)),black:d("cmyk",3,u(100)),x:d("xyz",0,u(100)),y:d("xyz",1,u(100)),z:d("xyz",2,u(100)),l:d("lab",0,u(100)),a:d("lab",1),b:d("lab",2),keyword:function(e){return arguments.length?new c(e):i[this.model].keyword(this.color)},hex:function(e){return arguments.length?new c(e):o.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var o=e[n]/255;t[n]=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return c.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),o=this.rgb(),i=void 0===t?.5:t,r=2*i-1,a=n.alpha()-o.alpha(),s=((r*a===-1?r:(r+a)/(1+r*a))+1)/2,l=1-s;return c.rgb(s*n.red()+l*o.red(),s*n.green()+l*o.green(),s*n.blue()+l*o.blue(),n.alpha()*i+o.alpha()*(1-i))}},Object.keys(i).forEach((function(e){if(-1===a.indexOf(e)){var t=i[e].channels;c.prototype[e]=function(){if(this.model===e)return new c(this);if(arguments.length)return new c(arguments,e);var n,o="number"===typeof arguments[t]?t:this.valpha;return new c((n=i[this.model][e].raw(this.color),Array.isArray(n)?n:[n]).concat(o),e)},c[e]=function(n){return"number"===typeof n&&(n=p(r.call(arguments),t)),new c(n,e)}}})),e.exports=c},96213:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:o,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:a,create:s}=Object,{apply:l,construct:c}="undefined"!==typeof Reflect&&Reflect;r||(r=function(e){return e}),a||(a=function(e){return e}),l||(l=function(e,t,n){return e.apply(t,n)}),c||(c=function(e,t){return new e(...t)});const d=k(Array.prototype.forEach),u=k(Array.prototype.pop),p=k(Array.prototype.push),h=k(String.prototype.toLowerCase),m=k(String.prototype.toString),g=k(String.prototype.match),f=k(String.prototype.replace),v=k(String.prototype.indexOf),b=k(String.prototype.trim),y=k(Object.prototype.hasOwnProperty),C=k(RegExp.prototype.test),S=D(TypeError);function k(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return l(e,t,o)}}function D(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return c(e,n)}}function x(e,o){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;t&&t(e,null);let r=o.length;for(;r--;){let t=o[r];if("string"===typeof t){const e=i(t);e!==t&&(n(o)||(o[r]=e),t=e)}e[t]=!0}return e}function T(e){for(let t=0;t<e.length;t++)y(e,t)||(e[t]=null);return e}function E(t){const n=s(null);for(const[o,i]of e(t))y(t,o)&&(Array.isArray(i)?n[o]=T(i):i&&"object"===typeof i&&i.constructor===Object?n[o]=E(i):n[o]=i);return n}function w(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return k(n.get);if("function"===typeof n.value)return k(n.value)}e=o(e)}function n(){return null}return n}const _=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N=r(["#text"]),M=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),O=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),F=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=a(/<%[\w\W]*|[\w\W]*%>/gm),z=a(/\${[\w\W]*}/gm),U=a(/^data-[\-\w.\u00B7-\uFFFF]/),W=a(/^aria-[\-\w]+$/),K=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=a(/^(?:\w+script|data):/i),q=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),V=a(/^html$/i),Z=a(/^[a-z][.\w]*(-[.\w]+)+$/i);var Y=Object.freeze({__proto__:null,MUSTACHE_EXPR:j,ERB_EXPR:H,TMPLIT_EXPR:z,DATA_ATTR:U,ARIA_ATTR:W,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:q,DOCTYPE_NAME:V,CUSTOM_ELEMENT:Z});const X=function(){return"undefined"===typeof window?null:window},$=function(e,t){if("object"!==typeof e||"function"!==typeof e.createPolicy)return null;let n=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(n=t.getAttribute(o));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(r){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function J(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X();const n=e=>J(e);if(n.version="3.1.0",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;let{document:o}=t;const i=o,a=i.currentScript,{DocumentFragment:l,HTMLTemplateElement:c,Node:k,Element:D,NodeFilter:T,NamedNodeMap:j=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:H,DOMParser:z,trustedTypes:U}=t,W=D.prototype,G=w(W,"cloneNode"),q=w(W,"nextSibling"),Z=w(W,"childNodes"),Q=w(W,"parentNode");if("function"===typeof c){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let ee,te="";const{implementation:ne,createNodeIterator:oe,createDocumentFragment:ie,getElementsByTagName:re}=o,{importNode:ae}=i;let se={};n.isSupported="function"===typeof e&&"function"===typeof Q&&ne&&void 0!==ne.createHTMLDocument;const{MUSTACHE_EXPR:le,ERB_EXPR:ce,TMPLIT_EXPR:de,DATA_ATTR:ue,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:he,ATTR_WHITESPACE:me,CUSTOM_ELEMENT:ge}=Y;let{IS_ALLOWED_URI:fe}=Y,ve=null;const be=x({},[..._,...I,...P,...R,...N]);let ye=null;const Ce=x({},[...M,...O,...B,...F]);let Se=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,De=null,xe=!0,Te=!0,Ee=!1,we=!0,_e=!1,Ie=!0,Pe=!1,Ae=!1,Re=!1,Le=!1,Ne=!1,Me=!1,Oe=!0,Be=!1;const Fe="user-content-";let je=!0,He=!1,ze={},Ue=null;const We=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const Ge=x({},["audio","video","img","source","image","track"]);let qe=null;const Ve=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ze="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml";let $e=Xe,Je=!1,Qe=null;const et=x({},[Ze,Ye,Xe],m);let tt=null;const nt=["application/xhtml+xml","text/html"],ot="text/html";let it=null,rt=null;const at=o.createElement("form"),st=function(e){return e instanceof RegExp||e instanceof Function},lt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!rt||rt!==e){if(e&&"object"===typeof e||(e={}),e=E(e),tt=-1===nt.indexOf(e.PARSER_MEDIA_TYPE)?ot:e.PARSER_MEDIA_TYPE,it="application/xhtml+xml"===tt?m:h,ve=y(e,"ALLOWED_TAGS")?x({},e.ALLOWED_TAGS,it):be,ye=y(e,"ALLOWED_ATTR")?x({},e.ALLOWED_ATTR,it):Ce,Qe=y(e,"ALLOWED_NAMESPACES")?x({},e.ALLOWED_NAMESPACES,m):et,qe=y(e,"ADD_URI_SAFE_ATTR")?x(E(Ve),e.ADD_URI_SAFE_ATTR,it):Ve,Ke=y(e,"ADD_DATA_URI_TAGS")?x(E(Ge),e.ADD_DATA_URI_TAGS,it):Ge,Ue=y(e,"FORBID_CONTENTS")?x({},e.FORBID_CONTENTS,it):We,ke=y(e,"FORBID_TAGS")?x({},e.FORBID_TAGS,it):{},De=y(e,"FORBID_ATTR")?x({},e.FORBID_ATTR,it):{},ze=!!y(e,"USE_PROFILES")&&e.USE_PROFILES,xe=!1!==e.ALLOW_ARIA_ATTR,Te=!1!==e.ALLOW_DATA_ATTR,Ee=e.ALLOW_UNKNOWN_PROTOCOLS||!1,we=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,_e=e.SAFE_FOR_TEMPLATES||!1,Ie=!1!==e.SAFE_FOR_XML,Pe=e.WHOLE_DOCUMENT||!1,Le=e.RETURN_DOM||!1,Ne=e.RETURN_DOM_FRAGMENT||!1,Me=e.RETURN_TRUSTED_TYPE||!1,Re=e.FORCE_BODY||!1,Oe=!1!==e.SANITIZE_DOM,Be=e.SANITIZE_NAMED_PROPS||!1,je=!1!==e.KEEP_CONTENT,He=e.IN_PLACE||!1,fe=e.ALLOWED_URI_REGEXP||K,$e=e.NAMESPACE||Xe,Se=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Se.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Se.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Se.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(Te=!1),Ne&&(Le=!0),ze&&(ve=x({},N),ye=[],!0===ze.html&&(x(ve,_),x(ye,M)),!0===ze.svg&&(x(ve,I),x(ye,O),x(ye,F)),!0===ze.svgFilters&&(x(ve,P),x(ye,O),x(ye,F)),!0===ze.mathMl&&(x(ve,R),x(ye,B),x(ye,F))),e.ADD_TAGS&&(ve===be&&(ve=E(ve)),x(ve,e.ADD_TAGS,it)),e.ADD_ATTR&&(ye===Ce&&(ye=E(ye)),x(ye,e.ADD_ATTR,it)),e.ADD_URI_SAFE_ATTR&&x(qe,e.ADD_URI_SAFE_ATTR,it),e.FORBID_CONTENTS&&(Ue===We&&(Ue=E(Ue)),x(Ue,e.FORBID_CONTENTS,it)),je&&(ve["#text"]=!0),Pe&&x(ve,["html","head","body"]),ve.table&&(x(ve,["tbody"]),delete ke.tbody),e.TRUSTED_TYPES_POLICY){if("function"!==typeof e.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!==typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ee=e.TRUSTED_TYPES_POLICY,te=ee.createHTML("")}else void 0===ee&&(ee=$(U,a)),null!==ee&&"string"===typeof te&&(te=ee.createHTML(""));r&&r(e),rt=e}},ct=x({},["mi","mo","mn","ms","mtext"]),dt=x({},["foreignobject","desc","title","annotation-xml"]),ut=x({},["title","style","font","a","script"]),pt=x({},[...I,...P,...A]),ht=x({},[...R,...L]),mt=function(e){let t=Q(e);t&&t.tagName||(t={namespaceURI:$e,tagName:"template"});const n=h(e.tagName),o=h(t.tagName);return!!Qe[e.namespaceURI]&&(e.namespaceURI===Ye?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ze?"svg"===n&&("annotation-xml"===o||ct[o]):Boolean(pt[n]):e.namespaceURI===Ze?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Ye?"math"===n&&dt[o]:Boolean(ht[n]):e.namespaceURI===Xe?!(t.namespaceURI===Ye&&!dt[o])&&!(t.namespaceURI===Ze&&!ct[o])&&!ht[n]&&(ut[n]||!pt[n]):!("application/xhtml+xml"!==tt||!Qe[e.namespaceURI]))},gt=function(e){p(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},ft=function(e,t){try{p(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(o){p(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ye[e])if(Le||Ne)try{gt(t)}catch(o){}else try{t.setAttribute(e,"")}catch(o){}},vt=function(e){let t=null,n=null;if(Re)e="<remove></remove>"+e;else{const t=g(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===tt&&$e===Xe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=ee?ee.createHTML(e):e;if($e===Xe)try{t=(new z).parseFromString(i,tt)}catch(a){}if(!t||!t.documentElement){t=ne.createDocument($e,"template",null);try{t.documentElement.innerHTML=Je?te:i}catch(a){}}const r=t.body||t.documentElement;return e&&n&&r.insertBefore(o.createTextNode(n),r.childNodes[0]||null),$e===Xe?re.call(t,Pe?"html":"body")[0]:Pe?t.documentElement:r},bt=function(e){return oe.call(e.ownerDocument||e,e,T.SHOW_ELEMENT|T.SHOW_COMMENT|T.SHOW_TEXT|T.SHOW_PROCESSING_INSTRUCTION|T.SHOW_CDATA_SECTION,null)},yt=function(e){return e instanceof H&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof j)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},Ct=function(e){return"function"===typeof k&&e instanceof k},St=function(e,t,o){se[e]&&d(se[e],(e=>{e.call(n,t,o,rt)}))},kt=function(e){let t=null;if(St("beforeSanitizeElements",e,null),yt(e))return gt(e),!0;const o=it(e.nodeName);if(St("uponSanitizeElement",e,{tagName:o,allowedTags:ve}),e.hasChildNodes()&&!Ct(e.firstElementChild)&&C(/<[/\w]/g,e.innerHTML)&&C(/<[/\w]/g,e.textContent))return gt(e),!0;if(7===e.nodeType)return gt(e),!0;if(Ie&&8===e.nodeType&&C(/<[/\w]/g,e.data))return gt(e),!0;if(!ve[o]||ke[o]){if(!ke[o]&&xt(o)){if(Se.tagNameCheck instanceof RegExp&&C(Se.tagNameCheck,o))return!1;if(Se.tagNameCheck instanceof Function&&Se.tagNameCheck(o))return!1}if(je&&!Ue[o]){const t=Q(e)||e.parentNode,n=Z(e)||e.childNodes;if(n&&t)for(let o=n.length-1;o>=0;--o)t.insertBefore(G(n[o],!0),q(e))}return gt(e),!0}return e instanceof D&&!mt(e)?(gt(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!C(/<\/no(script|embed|frames)/i,e.innerHTML)?(_e&&3===e.nodeType&&(t=e.textContent,d([le,ce,de],(e=>{t=f(t,e," ")})),e.textContent!==t&&(p(n.removed,{element:e.cloneNode()}),e.textContent=t)),St("afterSanitizeElements",e,null),!1):(gt(e),!0)},Dt=function(e,t,n){if(Oe&&("id"===t||"name"===t)&&(n in o||n in at))return!1;if(Te&&!De[t]&&C(ue,t));else if(xe&&C(pe,t));else if(!ye[t]||De[t]){if(!(xt(e)&&(Se.tagNameCheck instanceof RegExp&&C(Se.tagNameCheck,e)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(e))&&(Se.attributeNameCheck instanceof RegExp&&C(Se.attributeNameCheck,t)||Se.attributeNameCheck instanceof Function&&Se.attributeNameCheck(t))||"is"===t&&Se.allowCustomizedBuiltInElements&&(Se.tagNameCheck instanceof RegExp&&C(Se.tagNameCheck,n)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(n))))return!1}else if(qe[t]);else if(C(fe,f(n,me,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==v(n,"data:")||!Ke[e])if(Ee&&!C(he,f(n,me,"")));else if(n)return!1;return!0},xt=function(e){return"annotation-xml"!==e&&g(e,ge)},Tt=function(e){St("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};let i=t.length;for(;i--;){const a=t[i],{name:s,namespaceURI:l,value:c}=a,p=it(s);let h="value"===s?c:b(c);if(o.attrName=p,o.attrValue=h,o.keepAttr=!0,o.forceKeepAttr=void 0,St("uponSanitizeAttribute",e,o),h=o.attrValue,o.forceKeepAttr)continue;if(ft(s,e),!o.keepAttr)continue;if(!we&&C(/\/>/i,h)){ft(s,e);continue}_e&&d([le,ce,de],(e=>{h=f(h,e," ")}));const m=it(e.nodeName);if(Dt(m,p,h)){if(!Be||"id"!==p&&"name"!==p||(ft(s,e),h=Fe+h),ee&&"object"===typeof U&&"function"===typeof U.getAttributeType)if(l);else switch(U.getAttributeType(m,p)){case"TrustedHTML":h=ee.createHTML(h);break;case"TrustedScriptURL":h=ee.createScriptURL(h)}try{l?e.setAttributeNS(l,s,h):e.setAttribute(s,h),u(n.removed)}catch(r){}}}St("afterSanitizeAttributes",e,null)},Et=function e(t){let n=null;const o=bt(t);for(St("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)St("uponSanitizeShadowNode",n,null),kt(n)||(n.content instanceof l&&e(n.content),Tt(n));St("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,r=null,a=null,s=null;if(Je=!e,Je&&(e="\x3c!--\x3e"),"string"!==typeof e&&!Ct(e)){if("function"!==typeof e.toString)throw S("toString is not a function");if("string"!==typeof(e=e.toString()))throw S("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Ae||lt(t),n.removed=[],"string"===typeof e&&(He=!1),He){if(e.nodeName){const t=it(e.nodeName);if(!ve[t]||ke[t])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof k)o=vt("\x3c!----\x3e"),r=o.ownerDocument.importNode(e,!0),1===r.nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?o=r:o.appendChild(r);else{if(!Le&&!_e&&!Pe&&-1===e.indexOf("<"))return ee&&Me?ee.createHTML(e):e;if(o=vt(e),!o)return Le?null:Me?te:""}o&&Re&&gt(o.firstChild);const c=bt(He?e:o);for(;a=c.nextNode();)kt(a)||(a.content instanceof l&&Et(a.content),Tt(a));if(He)return e;if(Le){if(Ne)for(s=ie.call(o.ownerDocument);o.firstChild;)s.appendChild(o.firstChild);else s=o;return(ye.shadowroot||ye.shadowrootmode)&&(s=ae.call(i,s,!0)),s}let u=Pe?o.outerHTML:o.innerHTML;return Pe&&ve["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&C(V,o.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+u),_e&&d([le,ce,de],(e=>{u=f(u,e," ")})),ee&&Me?ee.createHTML(u):u},n.setConfig=function(){lt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ae=!0},n.clearConfig=function(){rt=null,Ae=!1},n.isValidAttribute=function(e,t,n){rt||lt({});const o=it(e),i=it(t);return Dt(o,i,n)},n.addHook=function(e,t){"function"===typeof t&&(se[e]=se[e]||[],p(se[e],t))},n.removeHook=function(e){if(se[e])return u(se[e])},n.removeHooks=function(e){se[e]&&(se[e]=[])},n.removeAllHooks=function(){se={}},n}return J()}()},74255:(e,t,n)=>{var o=n(53871),i=n(60929),r=n(99140);e.exports=function(e,t,n){var a=null==e?0:e.length;return a?(n&&"number"!=typeof n&&i(e,t,n)?(t=0,n=a):(t=null==t?0:r(t),n=void 0===n?a:r(n)),o(e,t,n)):[]}},9577:(e,t,n)=>{"use strict";t.a=void 0;var o=n(54468);Object.defineProperty(t,"a",{enumerable:!0,get:function(){return o.default}})},54468:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(42995);t.default=function(e,t){void 0===t&&(t=21.247);try{var n=o(e||void 0),i=n.lab().array(),r=(100-i[0])*((100-t)/100)+t;e=o.lab(r,i[1],i[2]).rgb().alpha(n.alpha()).toString()}catch(a){}return e}},59935:(e,t,n)=>{"use strict";function o(e,t,n){e.addUndoSnapshot(t,"Format",void 0,n&&""!=n?{formatApiName:n}:void 0)}n.d(t,{$N:()=>a,Lq:()=>De,Hd:()=>h,xE:()=>c,Px:()=>N,Ct:()=>p,d:()=>F,To:()=>Z,B2:()=>z,FN:()=>W,V4:()=>K,aU:()=>q,vL:()=>X,vQ:()=>$,oX:()=>Q,Mo:()=>g,oP:()=>te,$T:()=>f,XS:()=>v,zc:()=>ke,OM:()=>ne,Q2:()=>oe,TM:()=>de,vY:()=>b,A4:()=>me,s:()=>y,jZ:()=>le,xy:()=>be,Rk:()=>C,Ry:()=>se,SA:()=>ce,mO:()=>ye,YI:()=>Ce,XQ:()=>Se,Ty:()=>S});var i=n(38831);function r(e,t,n){e.focus();var r=e.getSelectionRangeEx(),a=function(e,n){return e.isContentEditable&&t(e,n)};if(r&&r.areAllCollapsed){var s=r.ranges[0].startContainer;"SPAN"==(0,i.e)(s)&&(!s.firstChild||"BR"==(0,i.e)(s.firstChild)&&!s.firstChild.nextSibling)?(e.addUndoSnapshot(),a(s)):(e.triggerPluginEvent(13,{formatState:{},formatCallback:t}),e.triggerContentChangedEvent("Format"))}else o(e,(function(){var t,n;r.ranges.forEach((function(o){var i=e.getSelectionTraverser(o);if(i)for(var r=i&&i.currentInlineElement;r;){var s=i.getNextInlineElement();r.applyStyle((function(e,o){a(e,o),t=t||e,n=e})),r=s}})),t&&n&&0==r.type&&e.select(t,-2,n,-3)}),n)}var a=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],s=1,l=1e3;function c(e,t,n){void 0===n&&(n=a);var o=0==t?1:-1;r(e,(function(e){var t=parseFloat((0,i.L9)(e,"font-size")||e.style.fontSize);e.style.fontSize=function(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var o=n[n.length-1];if(e<=n[0])e=Math.max(e+t,s);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),l);else if(1==t){for(var i=0;i<n.length;i++)if(e<n[i]){e=n[i];break}}else for(i=n.length-1;i>=0;i--)if(e>n[i]){e=n[i];break}return e}(t,o,n)+"pt";var r=(0,i.L9)(e,"line-height");r&&"normal"!=r&&(e.style.lineHeight="normal")}),"changeFontSize")}var d=n(6326);function u(e,t,n,o){var a=[];r(e,(function(t,o){n(t,o);var i=e.getElementAtCursor("LI",t);i&&-1===a.indexOf(i)&&a.push(i)}),o),function(e,t){e.forEach((function(e){(0,i.CP)(e,"HTMLLIElement")&&(0,i.dW)(e,t)}))}(a,[t])}function p(e,t){if((null===t||void 0===t?void 0:t.length)>0){var n=e.getSelectionRange(),o=n&&i.yX.getStart(n),r=n&&i.yX.getEnd(n),a=e.isFeatureEnabled("ReuseAllAncestorListElements"),s=e.isFeatureEnabled("DisableListChain");t.forEach((function(e){return e.commit(a,s)})),o&&r&&e.select(o,r)}}function h(e,t,n,r){e.focus();var a=e.getSelectionRangeEx();o(e,(function(o,r){if(!n||n()){var s=e.getSelectedRegions();if(s.length>0){var l=i.qR.createListChains(s,null===o||void 0===o?void 0:o.node);s.forEach((function(e){return t(e,o,r,l)})),p(e,l)}}0==a.type&&o&&r?e.select(o,r):e.select(a)}),r)}function m(e,t,n){e.focus();var r=function(){return e.getDocument().execCommand(t,!1,void 0)},a=e.getSelectionRangeEx();if(a&&a.areAllCollapsed){e.addUndoSnapshot();var s=e.getPendableFormatState(!1);r();var l=(0,i.Co)(i.qT).filter((function(e){return i.qT[e]==t}))[0];l&&(s[l]=!s[l],e.triggerPluginEvent(13,{formatState:s}))}else o(e,(function(){var t=0!=a.type;a.ranges.forEach((function(n){t&&e.select(n),r()})),t&&e.select(a)}),n)}function g(e,t){r(e,(function(n,o){(0,i.wW)(n,o?"":t,!0,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setBackgroundColor")}function f(e,t){u(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}),"setFontName")}function v(e,t){u(e,"font-size",(function(e,n){e.style.fontSize=n?"":t;var o=(0,i.L9)(e,"line-height");o&&"normal"!=o&&(e.style.lineHeight="normal")}),"setFontSize")}function b(e,t,n){u(e,"color",(function(o,r){n&&!n(o)||(0,i.wW)(o,r?"":t,!1,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setTextColor")}function y(e){m(e,"bold","toggleBold")}function C(e){m(e,"italic","toggleItalic")}function S(e){m(e,"underline","toggleUnderline")}var k=["font","text-decoration","color","background"],D="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),x=["href","src","cellpadding","cellspacing"],T=["TD","TH","TR","TABLE","TBODY","THEAD"];function E(e){var t=(0,i.$r)(e.childNodes).map(E).every((function(e){return e})),n=(0,i.mt)(e),o=(0,i.e)(e);return o&&(D.indexOf(o)>=0||t&&!(0,i.Gv)(e)&&T.indexOf(o)<0?(n&&!t&&(0,i.LV)(e),(0,i.oA)(e)):function(e){var t,n,o=(0,i.CP)(e,"HTMLTableCellElement"),r=(0,i.CP)(e,"HTMLTableElement");try{for(var a=(0,d.__values)((0,i.$r)(e.attributes)),s=a.next();!s.done;s=a.next()){var l=s.value;o&&"style"==l.name?_(e):r&&"style"==l.name?I(e):x.indexOf(l.name.toLowerCase())<0&&0!=l.name.indexOf("data-")&&e.removeAttribute(l.name)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)),n}function w(e,t){var n=(0,i.$f)(e),o={};return(0,i.Co)(n).forEach((function(e){return t(e,n,o)})),(0,i.hS)(e,n),o}function _(e){return w(e,(function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])}))}function I(e){return w(e,(function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}))}function P(e){var t=function(e){var t=e.getSelectionTraverser();return!!(null===t||void 0===t?void 0:t.currentBlockElement)&&!!(null===t||void 0===t?void 0:t.getNextBlockElement())}(e);if(!t){var n=e.getSelectionTraverser(),o=null===n||void 0===n?void 0:n.currentInlineElement,r=o instanceof i.r$||o instanceof i.QJ&&!function(e,t){for(var n,o=e,r=function(){if(o.nextSibling||o.previousSibling){if((0,i.CP)(o,"HTMLLIElement"))return{value:!0};var e=!0;return null===(n=o.parentNode)||void 0===n||n.childNodes.forEach((function(t){var n;t!=o&&(null===(n=t.textContent)||void 0===n?void 0:n.length)&&(e=!1)})),{value:e}}o=o.parentNode};o&&t.contains(o.parentNode);){var a=r();if("object"===typeof a)return a.value}return!0}(o.getContainerNode(),e);if(r)return void N(e)}A(e)}function A(e){o(e,(function(){h(e,(function(t){var n=(0,i.RE)(t),o=(0,i.uO)(t,n);if(e.contains(t.rootNode)){var r=_(t.rootNode);if((0,i.Co)(r).length>0){var a=(0,i.LV)((0,i.$r)(t.rootNode.childNodes));(0,i.hS)(a,r)}}for(;o.length>0&&o[0].parentNode&&(0,i.mN)(t,o[0].parentNode);){var s=(0,i.KC)(o);o=s?[s]:[]}o.forEach(E)})),R(e)}),"clearBlockFormat")}function R(e){var t=e.getDefaultFormat(),n=0===(0,i.Co)(t).length;if(e.queryElements("[style]",2,(function(e){var t=(0,i.e)(e);-1==T.indexOf(t)?L(t,e,n):e.childNodes.forEach((function(e){e.childNodes.forEach((function(e){var t=(0,i.e)(e);(0,i.CP)(e,"HTMLElement")&&L(t,e,n)}))}))})),!n){if(t.fontFamily&&f(e,t.fontFamily),t.fontSize&&v(e,t.fontSize),t.textColor){var o=e.queryElements("a *, a",1),r=o.length>0?function(e){return-1==o.indexOf(e)}:void 0;t.textColors?b(e,t.textColors,r):b(e,t.textColor,r)}t.backgroundColor&&(t.backgroundColors?g(e,t.backgroundColors):g(e,t.backgroundColor)),t.bold?y(e):function(e,t){void 0===t&&(t="400"),u(e,"font-weight",(function(e){return e.style.fontWeight=t}),"setDefaultFontWeight")}(e),t.italic&&C(e),t.underline&&S(e)}}function L(e,t,n){-1==T.indexOf(e)&&(k.forEach((function(e){return t.style.removeProperty(e)})),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}function N(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){return m(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")})),R(e),"clearInlineFormat"}),"Format")}(e);break;case 1:A(e);break;default:P(e)}}var M=/^[a-zA-Z]+:/i,O=/^[\w.%+-]+@/i,B=/^ftp\./i;function F(e,t,n,o,r){e.focus();var a=(function(e){var t=new i.Jp,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(a){var s=(0,i.aN)(a),l=s?s.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(M)<0&&(t=0==e.search(O)?"mailto:":0==e.search(B)?"ftp://":"http://"),t+e}(a),c=s?s.originalUrl:a;e.addUndoSnapshot((function(){var t=e.getSelectionRangeEx(),a=null;if(0===t.type){var s=t.ranges[0];if(s&&s.collapsed)(a=j(e))?(a.href=l,H(a,o)):((a=e.getDocument().createElement("A")).textContent=o||c,a.href=l,e.insertNode(a));else{e.getDocument().execCommand("createLink",!1,l);for(var d=e.getSelectionTraverser(),u=null===d||void 0===d?void 0:d.getNextInlineElement(),p=[];u;)p.push(u.getContainerNode()),u=null===d||void 0===d?void 0:d.getNextInlineElement();p.forEach((function(t){return e.deleteNode(t)})),H(a=j(e),o)}}else 2===t.type&&((a=(0,i.LV)(t.image,"A")).href=l);return n&&a&&(a.title=n),a&&function(e,t){t?e.target=t:!t&&e.getAttribute("target")&&e.removeAttribute("target")}(a,r),a}),"CreateLink")}}function j(e){return e.queryElements("a[href]",1)[0]}function H(e,t){t&&e.textContent!=t&&(e.textContent=t)}function z(e,t){return(0,d.__assign)((0,d.__assign)((0,d.__assign)((0,d.__assign)((0,d.__assign)({},e.getPendableFormatState(!1)),function(e,t){var n=(0,i.e)(e.getElementAtCursor("OL,UL",void 0,t)),o=e.getSelectionRange(),r=!1;if(o&&!o.collapsed){var a=e.getBlockElementAtNode(o.startContainer),s=e.getBlockElementAtNode(o.endContainer);r=!(!s||!a)&&!s.equals(a)}var l=(0,i.e)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",void 0,t)),c=e.queryElements("table",1)[0],d=c?(0,i.YG)(c):void 0,u=(null===c||void 0===c?void 0:c.rows[0])?(0,i.$r)(c.rows[0].cells).every((function(e){return"TH"==(0,i.e)(e)})):void 0,p=l&&parseInt(l[1])||0;return{isBullet:"UL"==n,isNumbering:"OL"==n,isMultilineSelection:r,headingLevel:p,headerLevel:p,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isCodeInline:!!e.queryElements("code",1)[0],isCodeBlock:!!e.queryElements("pre>code",1)[0],isInTable:!!c,tableFormat:d||{},tableHasHeader:u,canMergeTableCell:U(e)}}(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})}var U=function(e){var t=e.getSelectionRangeEx();if(t&&1===t.type&&t.coordinates){var n=t.coordinates,o=n.firstCell,i=n.lastCell;return o.x!==i.x||o.y!==i.y}return!1};function W(e,t,n,o,r,a,s,l){var c,d=(0,i.LV)(n,o?"div":"span");if(!o&&r&&(d.style.display="inline-block"),(0,i.T8)(d,t,r),!e.contains(d)){var u=null,h=void 0;if("number"==typeof a)h=a;else if(a){u=e.getSelectionRange();var m=a.normalize().node,g=m&&e.getElementAtCursor((0,i.hm)(),m);g&&(a=new i.yX(g,-3)),e.select(a),h=3}else e.focus(),h=3;var f=s&&e.getSelectedRegions(),v=f&&i.qR.createListChains(f);e.insertNode(d,{updateCursor:!1,insertOnNewLine:o,replaceSelection:!0,position:h,insertToRegionRoot:s}),v&&p(e,v),3==h&&(u?e.select(u):o||e.select(d,-3))}var b=(0,i.qe)(d);if(o){var y=(0,i.n)(1,e.getDocument());if(null===(c=d.parentNode)||void 0===c||c.insertBefore(y,d.nextSibling),y&&(0,i.Wc)(y,e.getDefaultFormat(),e.isDarkMode(),e.getDarkColorHandler()),l){var C=null===y||void 0===y?void 0:y.querySelector("br"),S=C&&new i.yX(C,-2);S&&e.select(S)}}else r&&((0,i.u$)(b.wrapper),b.wrapper.nextElementSibling&&e.hasFocus()&&e.select(new i.yX(b.wrapper.nextElementSibling,-3)));return e.triggerContentChangedEvent("InsertEntity",b),b}function K(e,t,n){"string"==typeof t?G(e,t,n):(0,i.TA)(t,(function(t){t&&!e.isDisposed()&&G(e,t,n)}))}function G(e,t,n){o(e,(function(){var o=e.getDocument().createElement("img");o.src=t,n&&(0,i.Co)(n).forEach((function(e){return o.setAttribute(e,n[e])})),e.insertNode(o)}),"insertImage")}function q(e,t,n,r){var a=e.getDocument(),s=a.createElement("table");s.cellSpacing="0",s.cellPadding="1";for(var l=0;l<n;l++){var c=a.createElement("tr");s.appendChild(c);for(var d=0;d<t;d++){var u=a.createElement("td");c.appendChild(u),u.appendChild(a.createElement("br")),u.style.width=V(t)}}e.focus(),o(e,(function(){var t=e.getElementAtCursor();(null===t||void 0===t?void 0:t.style.backgroundColor)&&g(e,"transparent");var n=new i.ZX(s);r=r||{verticalAlign:"top"},n.applyFormat(r||{}),n.writeBack(),e.insertNode(s),e.runAsync((function(e){return e.select(new i.yX(s,0).normalize())}))}),"insertTable")}function V(e){return e<=4?"120px":e<=6?"100px":"70px"}function Z(e,t){var n=e.getElementAtCursor("TD,TH");n&&o(e,(function(){var o=new i.ZX(n);if(function(e,t){var n,o=e.getSelectionRangeEx();o&&1===o.type&&(t.selection=null!==(n=o.coordinates)&&void 0!==n?n:null)}(e,o),o.edit(t),o.writeBack(!1,e.getDarkColorHandler()),e.transformToDarkColor(o.table),e.focus(),!Y(o.row)&&!Y(o.col)){var r=function(e,t,n){var o=t,i=n;switch(e){case 0:i=0;break;case 1:o+=1,i=0;break;case 2:o=0;break;case 3:o=0,i+=1}return{newRow:o,newCol:i}}(t,o.row,o.col),a=r.newCol,s=r.newRow,l=o.getCell(s,a).td;l&&e.select(l,0)}}),"editTable")}function Y(e){return void 0==e}function X(e){e.focus(),o(e,(function(t,n){e.queryElements("a[href]",1,i.oA),t&&n&&e.select(t,n)}),"removeLink")}function $(e,t,n,o,i){var r,a,s;if(!t||!n)return!1;if(s="string"==typeof t?null!==(a=null===(i=null!==(r=i||e.getContentSearcherOfCursor())&&void 0!==r?r:void 0)||void 0===i?void 0:i.getRangeFromText(t,o))&&void 0!==a?a:null:t){var l=e.getSelectionRange();return(null===l||void 0===l?void 0:l.collapsed)&&s.endContainer==l.startContainer&&s.endOffset==l.startOffset&&(o=!0),e.insertNode(n,{position:5,updateCursor:o,replaceSelection:!0,insertOnNewLine:!1,range:s}),!0}return!1}function J(e,t){if((0,i.CP)(e,"HTMLElement")){var n=e.style.textAlign,o=(0,i.W9)(e,void 0,"blockquote");if(!o)return;var r=(a=e,"rtl"==(0,i.L9)(a,"direction")||"rtl"==a.getAttribute("dir"));if(t){if(t.indexOf(o)>-1)return;t.push(o)}for(;o;)"center"==n?r?(o.style.removeProperty("marginInlineEnd"),o.style.marginInlineStart="auto"):(o.style.removeProperty("marginInlineStart"),o.style.marginInlineEnd="auto"):(o.style.removeProperty("marginInlineEnd"),o.style.removeProperty("marginInlineStart")),o=(0,i.W9)(o.parentElement,void 0,"blockquote")}var a}function Q(e,t){o(e,(function(){var n,o=e.getSelectionRangeEx(),r=o&&1===o.type,a=e.getElementAtCursor();r&&o.coordinates&&(0,i.Tj)(new i.ZX(o.table),o.coordinates)?function(e,t){var n=e.table;1==t?(n.style.marginLeft="auto",n.style.marginRight="auto"):2==t?(n.style.marginLeft="auto",n.style.marginRight=""):(n.style.marginLeft="",n.style.marginRight="auto")}(o,t):a&&(n=a,(0,i.W9)(n,void 0,"LI"))?function(e,t){h(e,(function(e,n,o){var r=(0,i.RE)(e)[0].getStartNode(),a=(0,i.hu)(e,!0,r);n&&o&&(null===a||void 0===a||a.setAlignment(n,o,t))}),void 0,"alignList")}(e,t):function(e,t){var n="left",o="justifyLeft";1==t?(o="justifyCenter",n="center"):2==t&&(o="justifyRight",n="right");m(e,o);var i=e.queryElements("[align]",1,(function(e){e.style.textAlign=n,J(e)}));if(0==i.length){var r=e.getElementAtCursor();r&&J(r)}}(e,t)}),"setAlignment")}function ee(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf((0,i.e)(t.parentNode))>=0}function te(e,t){e.focus(),o(e,(function(n,o){!function(e,t){var n=e.getSelectionTraverser();if(n){for(var o=n.currentBlockElement,i=[];o;)ee(o)||i.push(o),o=n.getNextBlockElement();i.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}}(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),n&&o&&e.select(n,o)}),"setDirection")}function ne(e,t){e.focus(),o(e,(function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"setImageAltText")}function oe(e,t){var n=0==t?function(e,t){var n=(0,i.uO)(e,t);(0,i.LV)(n,2);var o=[];n.forEach((function(e){return J(e,o)}))}:ie;h(e,(function(o,r,a){for(var s=(0,i.RE)(o,!0),l=[[]],c=0;c<s.length;c++){var d=s[c].getStartNode(),u=(0,i.hu)(o,!0,d);if(u){for(;s[c+1]&&u.contains(s[c+1].getStartNode());)c++;var p=e.isFeatureEnabled("TabKeyTextFeatures");if(p&&re(u,d)&&ae(t,e,d)){var h=e.getBlockElementAtNode(u.rootList);h&&l.push([h])}else r&&a&&(1==t?u.setIndentation(r,a,t,!1,p):u.setIndentation(r,a,t),u.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")),l.push([]))}else l[l.length-1].push(s[c])}l.forEach((function(e){return n(o,e)}))}),(function(){var n=e.getSelectionRangeEx();if(1==n.type&&n.coordinates&&(0,i.Tj)(new i.ZX(n.table),n.coordinates)){if(1==t){var o=e.getElementAtCursor("blockquote",n.table);o&&(0,i.oA)(o)}else 0==t&&(0,i.LV)(n.table,2);return!1}return!0}),"setIndentation")}function ie(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),o=(0,i.W9)(n,e.rootNode,"blockquote");if(o){for(n==o&&(n=(0,i.LV)((0,i.$r)(n.childNodes)));n&&(0,i.mN)(e,n)&&"BLOCKQUOTE"!=(0,i.e)(n);)n=(0,i.KC)(n);n&&(0,i.mN)(e,n)&&(0,i.oA)(n)}}))}function re(e,t){var n;return(null===(n=e.items[0])||void 0===n?void 0:n.getNode())==t&&e.getListItemIndex(t)==(e.getStart()||1)}function ae(e,t,n){return 0==e||t.getElementAtCursor("blockquote",n)}function se(e,t,n,o,r,a,s){void 0===n&&(n=0),void 0===o&&(o=!0),h(e,(function(s,l,c,d){var u,p,h=n>0&&d.filter((function(e){return e.canAppendAtCursor(n)}))[0],m=null===(p=(0,i.jv)(s.rootNode,null!==(u=null===l||void 0===l?void 0:l.node)&&void 0!==u?u:null))||void 0===p?void 0:p.collapseToSingleElement();if(m){var g=h&&c&&(null===l||void 0===l?void 0:l.equalTo(c))?h.createVListAtBlock(m,n):(0,i.hu)(s,1!==n&&o);g&&l&&c&&(g.changeListType(l,c,t),g.setListStyleType(r,a),function(e){var t=null===e||void 0===e?void 0:e.rootList;if(t)return 0===t.childElementCount;return!1}(g)&&g.removeMargins(),g.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")))}}),void 0,s||"toggleListType")}function le(e,t,n){se(e,2,void 0,!1,void 0,t,n)}function ce(e,t,n,o){se(e,1,t,void 0,n,void 0,o)}function de(e,t,n){void 0===n&&(n=1),o(e,(function(){e.focus();var o=e.getSelectedRegions();if(o[0]){var r=(0,i.hu)(o[0],!1,t);r&&(r.split(t,n),r.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")))}}),"setOrderedListNumbering")}function ue(e,t,n,o){h(e,(function(e){var n=(0,i.RE)(e,!0),o=(0,i.uO)(e,n);if(o.length>0){if(1==o.length){var r=(0,i.e)(o[0]);"BR"==r?o=[(0,i.LV)(o[0])]:"LI"!=r&&"TD"!=r||(o=(0,i.$r)(o[0].childNodes))}for(;o[0]&&o[0].parentNode&&(0,i.mN)(e,o[0].parentNode)&&o.some((function(e){return"LI"==(0,i.e)(e)}));){var a=(0,i.KC)(o);o=a?[a]:[]}t(o)}}),n,o)}var pe="blockquote",he=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};function me(e,t){ue(e,(function(e){var n=(0,i.LV)(e,pe);(t||he)(n)}),(function(){return 0==e.queryElements("blockquote",1,i.oA).length}),"toggleBlockQuote")}var ge="pre",fe="code",ve=ge+">"+fe;function be(e,t){ue(e,(function(e){var n=(0,i.LV)(e,fe),o=(0,i.LV)(n,ge);null===t||void 0===t||t(o)}),(function(){return 0==e.queryElements(ve,1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;(0,i.oA)(e),t&&(0,i.oA)(t)}})).length}),"toggleCodeBlock")}function ye(e){m(e,"strikeThrough","toggleStrikethrough")}function Ce(e){m(e,"subscript","toggleSubscript")}function Se(e){m(e,"superscript","toggleSuperscript")}function ke(e,t){t=Math.min(Math.max(Math.round(t),0),6),o(e,(function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var o=e.getDocument().createElement("div");(0,i.nu)(o,t),e.replaceNode(t,o)})),t>0){for(var o=e.getSelectionTraverser(),r=null===o||void 0===o?void 0:o.currentBlockElement,a=new i.Jp({cssStyleCallbacks:{"font-size":function(){return!1}}});r;){var s=r.collapseToSingleElement();a.sanitize(s),r=null===o||void 0===o?void 0:o.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"toggleHeader")}function De(e,t){e.focus(),o(e,(function(){e.getSelectedRegions().forEach((function(n){if((0,i.CP)(n.rootNode,"HTMLTableCellElement")){(0,i.wW)(n.rootNode,t,!0,e.isDarkMode(),!0,e.getDarkColorHandler());var o=(0,i.GY)(n.rootNode);(0,i.B_)(n.rootNode,(0,d.__assign)((0,d.__assign)({},o),{bgColorOverride:!0}))}}))}),"applyCellShading")}},84056:(e,t,n)=>{"use strict";n.d(t,{KE:()=>Te});var o=n(6326),i=n(38831),r=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){var n,o=null;if(t.editor){var r=t.editor;(0,i.uI)(e,(function(e){r&&!r.isDisposed()&&r.paste(e)}),{allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){var e;return o=null!==(e=r.getSelectionRange())&&void 0!==e?e:null,t.getTempDiv(r)},removeTempDiv:function(e){o&&t.cleanUpAndRestoreSelection(e,o,!1)}},null!==(n=t.editor.getSelectionRange())&&void 0!==n?n:void 0)}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this;if(this.editor){var o=this.editor.getSelectionRangeEx();if(o&&!o.areAllCollapsed){var r=this.editor.getContent(2),a=this.getTempDiv(this.editor,!0),s=(0,i.Dy)(a,r,this.editor.getTrustedHTMLHandler()),l=null;if(1===o.type&&o.coordinates){var c=a.querySelector("#"+o.table.id);l=this.createTableRange(c,o.coordinates),t&&this.deleteTableContent(this.editor,o.table,o.coordinates)}else if(2===o.type){var d=a.querySelector("#"+o.image.id);d&&(l=(0,i.Sd)(d),t&&this.deleteImage(this.editor,o.image.id))}else l=0===(null===s||void 0===s?void 0:s.type)?(0,i.Sd)(a,s.start,s.end):null;if(l)this.editor.triggerPluginEvent(9,{clonedRoot:a,range:l,rawEvent:e,isCut:t}).range&&(0,i.kK)(l),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,o,!t),t&&e.addUndoSnapshot((function(){var t=e.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}}},e.prototype.getTempDiv=function(e,t){var n=e.getCustomData("CopyPasteTempDiv",(function(){var t=(0,i.n)(3,e.getDocument());return e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t,n){var o,r,a;if((null===(o=t)||void 0===o?void 0:o.type)||0==t.type){var s=t;switch(s.type){case 1:case 2:null===(r=this.editor)||void 0===r||r.select(s);break;case 0:var l=null===(a=s.ranges)||void 0===a?void 0:a[0];this.restoreRange(l,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,i.nu)(e)},e.prototype.restoreRange=function(e,t){e&&this.editor&&(t&&i.Pw.isAndroid&&e.collapse(),this.editor.select(e))},e.prototype.createTableRange=function(e,t){var n=new i.ZX(e);return n.selection=t,function(e){if(e.selection){if((0,i.Tj)(e,e.selection))return;e.table.style.removeProperty("width"),e.table.style.removeProperty("height");var t=e.selection,n=t.firstCell,o=t.lastCell,r=[],a=n.x,s=n.y,l=o.x,c=o.y;e.cells&&(e.cells.forEach((function(e,t){(e=e.filter((function(e,n){return t>=s&&t<=c&&n>=a&&n<=l}))).length>0&&r.push(e)})),e.cells=r)}}(n),n.writeBack(),(0,i.Sd)(n.table)},e.prototype.deleteTableContent=function(e,t,n){var o=new i.ZX(t);o.selection=n,function(e,t){var n;if(e.selection)for(var o=e.selection,i=o.lastCell,r=o.firstCell,a=r.y;a<=i.y;a++)for(var s=r.x;s<=i.x;s++)e.cells&&(null===(n=e.cells[a][s])||void 0===n?void 0:n.td)&&t(e.cells[a][s])}(o,(function(t){(null===t||void 0===t?void 0:t.td)&&(t.td.innerHTML=e.getTrustedHTMLHandler()("<br>"))}));var r=(0,i.Tj)(o,n),a=t.rows.length-1===n.lastCell.y&&0===n.firstCell.y;r?(o.edit(4),o.writeBack()):a&&(o.edit(5),o.writeBack()),(r||a)&&(t.style.removeProperty("width"),t.style.removeProperty("height"))},e.prototype.deleteImage=function(e,t){e.queryElements("#"+t,(function(t){e.deleteNode(t)}))},e}();const a=r;var s=function(){function e(e,t){var n,o=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t,n=e,i=null===(t=o.editor)||void 0===t?void 0:t.getElementAtCursor("*",n.target);i&&!i.isContentEditable&&n.preventDefault()},this.onDrop=function(){var e;null===(e=o.editor)||void 0===e||e.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){var e,t,n;if(!o.state.skipReselectOnFocus){var r=o.state.tableSelectionRange||{},a=r.table,s=r.coordinates,l=(o.state.imageSelectionRange||{}).image;a&&s?null===(e=o.editor)||void 0===e||e.select(a,s):l?null===(t=o.editor)||void 0===t||t.select(l):o.state.selectionRange&&(null===(n=o.editor)||void 0===n||n.select(o.state.selectionRange))}i.Pw.isSafari||(o.state.selectionRange=null)},this.onSelectionChangeSafari=function(){var e;(null===(e=o.editor)||void 0===e?void 0:e.hasFocus())&&!o.editor.isInShadowEdit()&&(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.cacheSelection=function(){!o.state.selectionRange&&o.editor&&(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){var t;null===(t=o.editor)||void 0===t||t.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){((0,i.XJ)(e)||e.which>=33&&e.which<=40)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t,n,r=[],a=null===(t=o.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(),s=null===a||void 0===a?void 0:a.getInlineElementBefore(),l=e.target;2!=e.button&&s&&(l=s.getContainerNode()),o.state.contextMenuProviders.forEach((function(e){var t,n=null!==(t=e.getContextMenuItems(l))&&void 0!==t?t:[];(null===n||void 0===n?void 0:n.length)>0&&(r.length>0&&r.push(null),(0,i.u5)(r,n))})),null===(n=o.editor)||void 0===n||n.triggerPluginEvent(16,{rawEvent:e,items:r})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(c))||[],tableSelectionRange:null,imageSelectionRange:null}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,o,r=this;this.editor=e;var a=this.editor.getDocument(),s=((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return r.state.isInIME=!0},compositionend:function(t){r.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},dragstart:this.onDragStart,drop:this.onDrop,focus:this.onFocus})[i.Pw.isIE?"textinput":"input"]=this.getEventHandler(3),t);i.Pw.isSafari?a.addEventListener("selectionchange",this.onSelectionChangeSafari):i.Pw.isIEOrEdge?s.beforedeactivate=this.cacheSelection:s.blur=this.cacheSelection,this.disposer=e.addDomEventHandler(s),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(n=a.defaultView)||void 0===n||n.addEventListener("scroll",this.onScroll),null===(o=a.defaultView)||void 0===o||o.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,o,r=null===(e=this.editor)||void 0===e?void 0:e.getDocument();r&&i.Pw.isSafari&&r.removeEventListener("selectionchange",this.onSelectionChangeSafari),null===(t=null===r||void 0===r?void 0:r.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(n=null===r||void 0===r?void 0:r.defaultView)||void 0===n||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){var t=this;return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:function(n){return 3==e?t.onInputEvent(n):t.onKeyboardEvent(n)}}:e},e}();const l=s;function c(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}var d=function(){function e(){this.editor=null,this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,o=null,r=!1,a=0==e.eventType;if(a){var s=e.rawEvent,l=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n=(r=(0,i.tD)(s))||s.altKey,o=this.state.features[s.which]||l&&!l.collapsed&&this.state.features[258]}else 7==e.eventType&&(o=this.state.features[257]);for(var c=0;o&&c<(null===o||void 0===o?void 0:o.length);c++){var d=o[c];if((d.allowFunctionKeys||!n)&&this.editor&&d.shouldHandleEvent(e,this.editor,r)){d.handleEvent(e,this.editor),a&&(e.handledByEditFeature=!0);break}}},e}();const u=d;var p=".entityDelimiterAfter,.entityDelimiterBefore",h="\u200b",m="span"+(0,i.hm)();function g(e,t){switch(e.eventType){case 7:"SetContent"===e.source&&v(t);break;case 11:v(t);break;case 10:var n=e.fragment,o=e.sanitizingOption;b(n.querySelectorAll(m)),o.additionalAllowedCssClasses&&(0,i.u5)(o.additionalAllowedCssClasses,["entityDelimiterAfter","entityDelimiterBefore"]);break;case 8:case 9:e.clonedRoot.querySelectorAll(p).forEach((function(e){(0,i.Ub)(e)?C(e):S(e)}));break;case 0:!function(e,t){var n,o,r=e.getSelectionRangeEx(),a=t.rawEvent;if(0!=r.type)return;if(r.areAllCollapsed&&((0,i.XJ)(a)||13===a.which)){var s=null===(n=e.getFocusedPosition())||void 0===n?void 0:n.normalize();if(!s)return;var l=s.element,c=l==s.node?l.childNodes.item(s.offset):l,d=e.getElementAtCursor(p,c);if(!d)return;13===a.which?function(e,t){var n=t.classList.contains("entityDelimiterAfter"),o=n?t.previousSibling:t.nextSibling,r=function(e,t){var n;if(!t)return;var o=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();for(;o&&!(0,i.mt)(o);)o=e.contains(o.parentElement)?o.parentElement:void 0;return o}(e,t);e.runAsync((function(){if(r){var e=n?r.nextSibling:r.previousSibling;if(e&&(0,i.CP)(e,"HTMLElement")){var t=e.querySelectorAll(p);S(t.item(n?0:t.length-1))}if(y(o))[o.nextElementSibling,o.previousElementSibling].forEach((function(e){e&&(0,i.B5)(e,p)&&!(0,i.Ub)(e)&&S(e,!1)})),(0,i.u$)(o)}}))}(e,d):3==(null===(o=d.firstChild)||void 0===o?void 0:o.nodeType)&&e.runAsync((function(){return f(d)}))}else if(!r.areAllCollapsed&&!a.shiftKey&&16!=a.which){var u=r.ranges[0];if(!u)return;!function(e,t,n){var o=t.startContainer,r=t.endContainer,a=t.startOffset,s=t.endOffset,l=e.getElementAtCursor(p,o),c=e.getElementAtCursor(p,r),d=k(l),u=k(c);(d||u)&&e.select(null!==d&&void 0!==d?d:new i.yX(o,a),null!==u&&void 0!==u?u:new i.yX(r,s));e.runAsync((function(e){var t=e.getElementAtCursor(p);t&&(f(t),13===n.which&&S(t))}))}(e,u,a)}}(t,e)}}function f(e){var t,n,o,r;e.normalize();var a,s=e.firstChild,l=null!==(n=null===(t=s.nodeValue)||void 0===t?void 0:t.indexOf(h))&&void 0!==n?n:-1;if(l>=0&&((0,i.ai)(s,0==l?1:l,!1),e.childNodes.forEach((function(e){e.nodeValue!==h&&(a=e)})),a)){null===(o=e.parentElement)||void 0===o||o.insertBefore(a,"entityDelimiterBefore"==e.className?e:e.nextSibling);var c=null===(r=a.ownerDocument)||void 0===r?void 0:r.getSelection();c&&c.setPosition(a,new i.yX(a,-1).offset)}}function v(e){e.queryElements(p).forEach((function(e){if((0,i.Ub)(e)){var t=e.classList.contains("entityDelimiterBefore")?e.nextElementSibling:e.previousElementSibling;(0,i.CP)(t,"HTMLElement")&&(0,i.qe)(t)||C(e)}else S(e)})),b(e.queryElements(m))}function b(e){e.forEach((function(e){y(e)&&(0,i.u$)(e)}))}function y(e){return!!(e&&(0,i.CP)(e,"HTMLElement")&&(t=(0,i.qe)(e),(null===t||void 0===t?void 0:t.isReadonly)&&!(0,i.mt)(t.wrapper)&&(0,i.CP)(t.wrapper,"HTMLElement")));var t}function C(e){var t;null===(t=null===e||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(e)}function S(e,t){if(void 0===t&&(t=!0),e){var n=e.classList.contains("entityDelimiterAfter")?e.previousElementSibling:e.nextElementSibling;t&&n&&y(n)||(e.classList.remove("entityDelimiterAfter","entityDelimiterBefore"),e.normalize(),e.childNodes.forEach((function(e){var t,n,o,r=null!==(n=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(h))&&void 0!==n?n:-1;r>=0&&(null===(o=(0,i.Sd)(e,r,e,r+1))||void 0===o||o.deleteContents())})))}}var k=function(e){if(e&&(0,i.Ub)(e)){var t=e.classList.contains("entityDelimiterAfter");return new i.yX(e,t?-3:-2)}};var D=/_(\d{1,8})$/,x=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],T=[6,7,4,5],E=function(){function e(){var e=this;this.editor=null,this.handleCutEvent=function(t){var n,o=null===(n=e.editor)||void 0===n?void 0:n.getSelectionRange();o&&!o.collapsed&&e.checkRemoveEntityForRange(t)},this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 15:this.handleEntityOperationEvent(e)}this.editor&&g(e,this.editor)},e.prototype.handleContextMenuEvent=function(e){var t,n=e.target,o=n&&(null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor((0,i.hm)(),n));o&&(e.preventDefault(),this.triggerEvent(o,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,o=e.isClicking,r=n.target;this.editor&&o&&r&&(t=this.editor.getElementAtCursor((0,i.hm)(),r))&&(this.triggerEvent(t,1,n),_(this.editor))},e.prototype.handleKeyDownEvent=function(e){var t;if((0,i.XJ)(e)||8==e.which||46==e.which||13==e.which){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(null),e.additionalAllowedCssClasses&&(0,i.u5)(e.additionalAllowedCssClasses,x)},e.prototype.handleContentChangedEvent=function(e){var t=this,n=!1;(0,i.Co)(this.state.entityMap).forEach((function(e){var o=t.state.entityMap[e],r=o.element;!t.editor||o.isDeleted||t.editor.contains(r)||(o.isDeleted=!0,t.triggerEvent(r,6),n||r.isContentEditable||(0,i.mt)(r)||(n=!0))})),("InsertEntity"==(null===e||void 0===e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var n=t.state.entityMap[e.id];return!n||n.element!=e.wrapper||n.isDeleted}))).forEach((function(e){var n=e.wrapper,o=e.type,r=e.id,a=e.isReadonly;e.id=t.ensureUniqueId(o,r,n),(0,i.T8)(n,o,a,e.id),t.handleNewEntity(e)})),n&&this.editor&&v(this.editor)},e.prototype.handleEntityOperationEvent=function(e){if(this.editor&&T.indexOf(e.operation)>=0){var t=this.state.entityMap[e.entity.id];t&&(t.isDeleted=!0)}},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,i.$r)(e.querySelectorAll((0,i.hm)())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t,n=this,o=[],r=(0,i.hm)();if(null===(t=this.editor)||void 0===t||t.queryElements(r,1,(function(t){t.isContentEditable?o.push(t):n.triggerEvent(t,6,e)})),this.editor&&o.length>0){var a=this.editor.queryElements(r,2);o.forEach((function(t){var o=a.indexOf(t)>=0;n.triggerEvent(t,o?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,n){var o,r=e&&(0,i.qe)(e);return r?null===(o=this.editor)||void 0===o?void 0:o.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:r}):null},e.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.triggerEvent(t,0),o={element:e.wrapper};(null===n||void 0===n?void 0:n.shouldPersist)&&(o.canPersist=!0),this.state.entityMap[e.id]=o},e.prototype.getExistingEntities=function(){var e,t;return null!==(t=null===(e=this.editor)||void 0===e?void 0:e.queryElements((0,i.hm)()).map(i.qe).filter((function(e){return!!e})))&&void 0!==t?t:[]},e.prototype.ensureUniqueId=function(e,t,n){for(var o=D.exec(t),i=(o?t.substr(0,t.length-o[0].length):t)||e,r="",a=o&&parseInt(o[1])||0;;a++){r=a>0?i+"_"+a:i;var s=this.state.entityMap[r];if(!s||s.element==n)break}return r},e}();const w=E;var _=i.Pw.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=(0,i.n)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",(0,i.kK)((0,i.Sd)(t,0))}))}:function(){},I=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ImageSelection"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.select(null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n;if(this.editor)switch(e.eventType){case 6:var o=e.rawEvent.target;(0,i.CP)(o,"HTMLImageElement")&&o.isContentEditable&&1!=e.rawEvent.button&&e.isClicking&&this.editor.select(o);break;case 5:var r=e.rawEvent.target,a=this.editor.getSelectionRangeEx();a&&2===a.type&&a.image!==r&&this.editor.select(null);break;case 0:var s=e.rawEvent,l=s.key,c=this.editor.getSelectionRangeEx();if(!s.ctrlKey&&!s.altKey&&!s.shiftKey&&!s.metaKey&&2===c.type){var d=null===(t=c.image)||void 0===t?void 0:t.parentNode;"Escape"===l&&d?(this.editor.select(c.image,-2),null===(n=this.editor.getSelectionRange())||void 0===n||n.collapse(),e.rawEvent.stopPropagation()):"Delete"===l?(this.editor.deleteNode(c.image),e.rawEvent.preventDefault()):d&&this.editor.select(c.image,-2)}break;case 16:var u=e.rawEvent.target,p=this.editor.getSelectionRangeEx();!(0,i.CP)(u,"HTMLImageElement")||2===p.type&&p.image===u||this.editor.select(u)}},e}();const P=I;var A="contenteditable",R={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},L={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},N=function(){function e(e,t){var n,r,a=this;this.editor=null,this.initializer=null,this.disposer=null,this.initialContent=e.initialContent||t.innerHTML||"",null===t.getAttribute(A)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(A)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e,n=L,o=R,r=a.state.isDarkMode,s=null===(e=a.editor)||void 0===e?void 0:e.getDarkColorHandler();(0,i.wW)(t,n,!1,r,!1,s),(0,i.wW)(t,o,!0,r,!1,s)};var s=null!==(n=e.getDarkColor)&&void 0!==n?n:function(e){return e},l=e.defaultFormat?(0,o.__assign)({},e.defaultFormat):null;l&&(l.textColor&&!l.textColors&&(l.textColors={lightModeColor:l.textColor,darkModeColor:s(l.textColor)},delete l.textColor),l.backgroundColor&&!l.backgroundColors&&(l.backgroundColors={lightModeColor:l.backgroundColor,darkModeColor:s(l.backgroundColor)},delete l.backgroundColor)),this.state={customData:{},defaultFormat:l,isDarkMode:!!e.inDarkMode,getDarkColor:s,onExternalContentTransform:null!==(r=e.onExternalContentTransform)&&void 0!==r?r:null,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditEntities:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null,shadowEditImageSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e,t=this;null===(e=this.editor)||void 0===e||e.triggerPluginEvent(12,{},!0),(0,i.Co)(this.state.customData).forEach((function(e){var n=t.state.customData[e];n&&n.disposer&&n.disposer(n.value),delete t.state.customData[e]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.adjustColor())},e}();const M=N;const O=function(){function e(){var e=this;this.editor=null,this.mouseUpEventListerAdded=!1,this.mouseDownX=null,this.mouseDownY=null,this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&5==e.eventType&&!this.mouseUpEventListerAdded&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();var B=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.editor&&this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,i.$r)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent);break;case 8:t=e.clonedRoot,(0,i.$r)(t.querySelectorAll("li")).forEach((function(e){var t=e.previousSibling;"block"==e.style.display&&(0,i.CP)(t,"HTMLLIElement")&&(e.style.removeProperty("display"),t.appendChild((0,i.fV)(e,"div")))}))}var t},e.prototype.normalizeTableFromEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("table",e.target);n&&this.normalizeTables([n])},e.prototype.normalizeTables=function(e){if(this.editor&&e.length>0){var t=this.editor.getSelectionRangeEx(),n=0==(null===t||void 0===t?void 0:t.type)&&t.ranges[0]||{},o=n.startContainer,r=n.endContainer,a=n.startOffset,s=n.endOffset,l=function(e){var t=!1;return e.forEach((function(e){for(var n,o=null,r=e.firstChild;r;r=r.nextSibling){switch((0,i.e)(r)){case"TR":o||(o=e.ownerDocument.createElement("tbody"),e.insertBefore(o,r)),o.appendChild(r),r=o,t=!0;break;case"TBODY":o?((0,i.nu)(o,r,!0),null===(n=r.parentNode)||void 0===n||n.removeChild(r),r=o,t=!0):o=r;break;default:o=null}}var a=e.querySelectorAll("colgroup"),s=e.querySelector("thead");s&&a.forEach((function(e){s.contains(e)||s.appendChild(e)}))})),t}(e);l&&(o&&r&&"number"===typeof a&&"number"===typeof s?this.editor.select(o,a,r,s):1==(null===t||void 0===t?void 0:t.type)&&t.coordinates&&this.editor.select(t.table,t.coordinates))}},e}();const F=B;var j=function(){function e(){this.editor=null,this.state={pendableFormatPosition:null,pendableFormatState:null,pendableFormatSpan:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:e.formatState?(this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState,this.state.pendableFormatSpan=e.formatCallback?this.createPendingFormatSpan(e.formatCallback):null):this.clear();break;case 0:case 5:case 7:var t=null;this.editor&&0==e.eventType&&(0,i.XJ)(e.rawEvent)&&this.state.pendableFormatSpan?(this.state.pendableFormatSpan.removeAttribute("contentEditable"),this.editor.insertNode(this.state.pendableFormatSpan),this.editor.select(this.state.pendableFormatSpan,0,this.state.pendableFormatSpan,-1),this.clear()):(0==e.eventType&&e.rawEvent.which>=33&&e.rawEvent.which<=40||this.state.pendableFormatPosition&&(t=this.getCurrentPosition())&&!this.state.pendableFormatPosition.equalTo(t)||7==e.eventType&&("SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source))&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null,this.state.pendableFormatSpan=null},e.prototype.getCurrentPosition=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getSelectionRange();return null!==(t=n&&i.yX.getStart(n).normalize())&&void 0!==t?t:null},e.prototype.createPendingFormatSpan=function(e){var t,n,o=this.state.pendableFormatSpan;if(!o&&this.editor){var r=this.editor.getStyleBasedFormatState(),a=this.editor.getDocument(),s=this.editor.isDarkMode();(o=a.createElement("span")).contentEditable="true",o.appendChild(a.createTextNode("\u200b")),o.style.setProperty("font-family",null!==(t=r.fontName)&&void 0!==t?t:null),o.style.setProperty("font-size",null!==(n=r.fontSize)&&void 0!==n?n:null);var l=this.editor.getDarkColorHandler();(r.textColors||r.textColor)&&(0,i.wW)(o,r.textColors||r.textColor,!1,s,!1,l),(r.backgroundColors||r.backgroundColor)&&(0,i.wW)(o,r.backgroundColors||r.backgroundColor,!0,s,!1,l)}return o&&e(o),o},e}();const H=j;var z=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.isRangeEmpty=function(e){return!(!e.collapsed||e.startContainer.nodeType!==Node.ELEMENT_NODE||"DIV"!=(0,i.e)(e.startContainer)||e.startContainer.firstChild)},e.prototype.onPluginEvent=function(e){var t,n=this;if(1==e.eventType&&this.editor&&(!e.rawEvent||!(0,i.tD)(e.rawEvent))){var o=this.editor.getSelectionRange(),r=o&&(0,i.W9)(o.startContainer,void 0,"[style]");if(!o||!this.isRangeEmpty(o)&&this.editor.contains(r))return;if(o.collapsed)this.editor.ensureTypeInContainer(i.yX.getStart(o),e.rawEvent);else{var a=function(){var t,o,i=null===(t=n.editor)||void 0===t?void 0:t.getFocusedPosition();i&&(null===(o=n.editor)||void 0===o||o.ensureTypeInContainer(i,e.rawEvent))};i.Pw.isMobileOrTablet?null===(t=this.editor.getDocument().defaultView)||void 0===t||t.setTimeout(a,100):this.editor.runAsync(a)}}},e}();const U=z;var W=function(){function e(e){this.editor=null,this.lastKeyPress=null,this.state={snapshotsService:e.undoMetadataSnapshotService||q(e.undoSnapshotService)||G(),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.onContentChanged(e);break;case 23:this.onBeforeKeyboardEditing(e.rawEvent)}},e.prototype.onKeyDown=function(e){var t,n;if(8==e.which&&!e.altKey||46==e.which){if(8==e.which&&!e.ctrlKey&&this.canUndoAutoComplete())e.preventDefault(),null===(t=this.editor)||void 0===t||t.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else if(!e.defaultPrevented){var o=null===(n=this.editor)||void 0===n?void 0:n.getSelectionRange();!o||o.collapsed&&this.lastKeyPress==e.which&&!(0,i.tD)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}}else e.which>=33&&e.which<=40?(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0):8!=this.lastKeyPress&&46!=this.lastKeyPress||this.state.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e){var t;if(!e.metaKey){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.onBeforeKeyboardEditing=function(e){e.which!=this.lastKeyPress&&this.addUndoSnapshot(),this.lastKeyPress=e.which,this.state.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||"Keyboard"==e.source||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getFocusedPosition();return this.state.snapshotsService.canUndoAutoComplete()&&!!n&&!!(null===(t=this.state.autoCompletePosition)||void 0===t?void 0:t.equalTo(n))},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();const K=W;function G(){var e=(0,i.QA)(1e7);return{canMove:function(t){return(0,i.t)(e,t)},move:function(t){return(0,i.o7)(e,t)},addSnapshot:function(t,n){return(0,i.iu)(e,t,n)},clearRedo:function(){return(0,i.xs)(e)},canUndoAutoComplete:function(){return(0,i.rm)(e)}}}function q(e){var t;return e?{canMove:function(t){return e.canMove(t)},move:function(n){return(t=e.move(n))?{html:t,metadata:null,knownColors:[]}:null},addSnapshot:function(t,n){return e.addSnapshot(t.html+(t.metadata?"\x3c!--"+JSON.stringify(t.metadata)+"--\x3e":""),n)},clearRedo:function(){return e.clearRedo()},canUndoAutoComplete:function(){return e.canUndoAutoComplete()}}:void 0}var V,Z,Y,X=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/;!function(e){e[e.CssColor=0]="CssColor",e[e.HtmlColor=1]="HtmlColor"}(Y||(Y={}));var $=[(V={},V[0]="color",V[1]="color",V),(Z={},Z[0]="background-color",Z[1]="bgcolor",Z)],J=function(){function e(e,t){this.contentDiv=e,this.getDarkColor=t,this.knownColors={}}return e.prototype.getKnownColorsCopy=function(){return Object.values(this.knownColors)},e.prototype.registerColor=function(e,t,n){var o,i=this.parseColorValue(e);return i&&(e=i.lightModeColor,n=i.darkModeColor||n,o=i.key),t&&e?(o=o||"--darkColor_"+e.replace(/[^\d\w]/g,"_"),this.knownColors[o]||(n=n||this.getDarkColor(e),this.knownColors[o]={lightModeColor:e,darkModeColor:n},this.contentDiv.style.setProperty(o,n)),"var("+o+", "+e+")"):e},e.prototype.reset=function(){var e=this;(0,i.Co)(this.knownColors).forEach((function(t){return e.contentDiv.style.removeProperty(t)})),this.knownColors={}},e.prototype.parseColorValue=function(e,t){var n,o,i,r="";if(e){var a=e.startsWith("var(")?X.exec(e):null;a?a[2]?(o=a[1],r=a[2],i=null===(n=this.knownColors[o])||void 0===n?void 0:n.darkModeColor):r="":t?(r=this.findLightColorFromDarkColor(e)||"")&&(i=e):r=e}return{key:o,lightModeColor:r,darkModeColor:i}},e.prototype.findLightColorFromDarkColor=function(e){var t=this,n=(0,i.H0)(e);if(n){var o=(0,i.Co)(this.knownColors).find((function(e){var o=(0,i.H0)(t.knownColors[e].darkModeColor);return o&&o[0]==n[0]&&o[1]==n[1]&&o[2]==n[2]}));if(o)return this.knownColors[o].lightModeColor}return null},e.prototype.transformElementColor=function(e,t,n){var o=this;$.forEach((function(r,a){var s=o.parseColorValue(e.style.getPropertyValue(r[0])||e.getAttribute(r[1]),!!t).lightModeColor;e.style.setProperty(r[0],null),e.removeAttribute(r[1]),s&&"inherit"!=s&&(0,i.wW)(e,s,0!=a,n,!1,o)}))},e}();const Q=J;function ee(e,t,n){var r;if(!e.lifecycle.shadowEditFragment){var a=e.api.getSelectionRangeEx(e),s=e.lifecycle.isDarkMode,l=function(e,t,n){switch(null===t||void 0===t?void 0:t.type){case 1:return(0,o.__assign)({type:1,tableId:t.table.id,isDarkMode:!!n},t.coordinates);case 2:return{type:2,imageId:t.image.id,isDarkMode:!!n};case 0:return(0,o.__assign)({type:0,isDarkMode:!!n,start:[],end:[]},(0,i.cp)(e,t.ranges[0])||{})}}(e.contentDiv,a,s)||null;e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:l,knownColors:(null===(r=e.darkColorHandler)||void 0===r?void 0:r.getKnownColorsCopy())||[],entityStates:n},t),e.undo.hasNewContent=!1}}var te={isBold:function(e,t){return"B"==e||"STRONG"==e||"H1"==e||"H2"==e||"H3"==e||"H4"==e||"H5"==e||"H6"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},ne={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}};function oe(e){return{type:0,ranges:e,areAllCollapsed:ie(e)}}function ie(e){return e.filter((function(e){return null===e||void 0===e?void 0:e.collapsed})).length==e.length}var re=function(e){var t=e.contentDiv.ownerDocument.activeElement;return!(!t||!(0,i.gR)(e.contentDiv,t,!0))};function ae(e,t){var n=e.ownerDocument;e.id?n.querySelectorAll("#"+e.id).length>1&&(e.removeAttribute("id"),se(e,t,n)):se(e,t,n)}function se(e,t,n){for(var o=0,i=function(){return n.getElementById(t+o)},r=i();r;)o++,r=i();e.id=t+o}var le="imageStyle",ce=function(e,t){(0,i.oF)(t,["border","margin"]);var n=de(e,t.id);(0,i.Ju)(e.contentDiv.ownerDocument,n,le+e.contentDiv.id)},de=function(e,t){return"#"+e.contentDiv.id+" #"+t+" {outline-style: auto!important;outline-color: "+(e.imageSelectionBorderColor||"#DB626C")+"!important;caret-color: transparent!important;}"},ue=function(e){var t=e.contentDiv.ownerDocument;(0,i.Z7)(t,le+e.contentDiv.id)};var pe="tableStyle",he="{background-color: rgb(198,198,198) !important; caret-color: transparent}",me=9e3;var ge=function(e){var t=e.contentDiv.ownerDocument;(0,i.Z7)(t,pe+e.contentDiv.id)};function fe(e,t,n,o,i,r){return e+" #"+t+n+" tr:nth-child("+o+")>"+i+":nth-child("+r+")"}function ve(e){e&&(0,i.oF)(e,["background-color","background"])}function be(e){return(!!e||0==e)&&e>-1}function ye(e,t,n){n&&Ce(e)&&t(e);for(var o=e.firstChild;o;o=o.nextSibling)Ce(o)&&t(o),ye(o,t)}function Ce(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}var Se=[11,12,8,21];var ke={attachDomEvent:function(e,t){var n=(0,i.Co)(t||{}).map((function(n){var o=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"===typeof e?t.pluginEventType=e:"function"===typeof e?t.beforeDispatch=e:"object"===typeof e&&(t=e);return t}(t[n]),i=o.pluginEventType,r=o.beforeDispatch,a=n,s=function(t){r&&r(t),null!=i&&e.api.triggerEvent(e,{eventType:i,rawEvent:t},!1)};return e.contentDiv.addEventListener(a,s),function(){e.contentDiv.removeEventListener(a,s)}}));return function(){return n.forEach((function(e){return e()}))}},addUndoSnapshot:function(e,t,n,o,r){var a,s,l,c=e.undo,d=c.isNested;d||(c.isNested=!0,!e.undo.hasNewContent&&(null===r||void 0===r?void 0:r.getEntityState)&&t||ee(e,o,null===(a=null===r||void 0===r?void 0:r.getEntityState)||void 0===a?void 0:a.call(r)));try{var u;if(t)if(l=t((u=e.api.getSelectionRange(e,!0))&&i.yX.getStart(u).normalize(),u&&i.yX.getEnd(u).normalize()),!d)ee(e,!1,null===(s=null===r||void 0===r?void 0:r.getEntityState)||void 0===s?void 0:s.call(r))}finally{d||(c.isNested=!1)}if(t&&n){var p={eventType:7,source:n,data:l,additionalData:r};e.api.triggerEvent(e,p,!0)}o&&((u=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=i.yX.getStart(u)))},createPasteFragment:function(e,t,n,o,r,a){if(void 0===a&&(a=!1),!t)return null;var s=function(e,t,n){var o=(0,i.w5)();return o.cssStyleCallbacks["caret-color"]=function(){return!1},{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:o,htmlBefore:"",htmlAfter:"",htmlAttributes:{},pasteType:n}}(e,t,(0,i.M0)(o,r,a));return function(e,t,n,o,r,a,s){var l=s.fragment,c=t.rawHtml,d=t.text,u=t.imageDataUri,p=c?(new DOMParser).parseFromString(e.trustedHTMLHandler(c),"text/html"):void 0;if((0,i.GP)(p,s,e.trustedHTMLHandler),a&&u||!o&&!d&&u)(0,i.bC)(u,l);else if(!o&&c&&p&&p.body){if((0,i.nu)(l,null===p||void 0===p?void 0:p.body),r&&n){var h=function(e,t){var n=e.api.getPendableFormatState(e,!0),o=e.api.getStyleBasedFormatState(e,t);return{fontFamily:o.fontName,fontSize:o.fontSize,textColor:o.textColor,backgroundColor:o.backgroundColor,textColors:o.textColors,backgroundColors:o.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);(0,i.NQ)(l,(function(e){return(0,i.Wc)(e,h)}))}}else d&&(0,i.jA)(d,n,l);1!==s.pasteType&&e.api.triggerEvent(e,s,!0);return(0,i.ar)(s,n),l}(e,t,n,o,r,a,s)},ensureTypeInContainer:function(e,t,n){var o,r=(0,i.W9)(t.node,e.contentDiv,"table");r&&(o=r.querySelector("td,th"))&&(t=new i.yX(o,0)),t=t.normalize();var a,s=(0,i.jv)(e.contentDiv,t.node);if(s){if(a=s.collapseToSingleElement(),(0,i.Op)(a,!1,!0)){var l=a.ownerDocument.createElement("br");a.append(l)}var c=(0,i.Op)(a)||n&&function(e,t){return(0,i.CP)(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,a);a=a&&c?a:null}else a=(0,i.n)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,a,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new i.yX(a,0);a&&e.lifecycle.defaultFormat&&(0,i.Wc)(a,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode,e.darkColorHandler),n&&e.api.selectRange(e,(0,i.Sd)(new i.yX(t)))},focus:function(e){if(!e.lifecycle.shadowEditFragment){if((!e.api.hasFocus(e)||!e.api.getSelectionRange(e,!1))&&(!e.domEvent.selectionRange||!e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=(0,i.Fb)(e.contentDiv)||e.contentDiv;e.api.selectRange(e,(0,i.Sd)(t,0),!0)}i.Pw.isSafari||(e.domEvent.selectionRange=null),e.api.hasFocus(e)||e.contentDiv.focus()}},getContent:function(e,t){var n="",o=0==t,r=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;if(4==t)n=a.textContent;else if(3==t)n=(0,i.rf)(a);else{var s=function(e){var t;(0,i.CP)(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(a);s.normalize();var l=e.api.getSelectionRange(e,!0),c=r?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:l?(0,i.cp)(e.contentDiv,l):null:null,d=c&&(0,i.Sd)(s,c.start,c.end);e.api.transformColor(e,s,!1,null,1,!0,e.lifecycle.isDarkMode),o?(e.api.triggerEvent(e,{eventType:8,clonedRoot:s},!0),n=s.innerHTML):n=d?(0,i.b2)(s,d):s.innerHTML}return null!==n&&void 0!==n?n:""},getSelectionRange:function(e,t){var n,o=null;if(e.lifecycle.shadowEditFragment)return o=e.lifecycle.shadowEditSelectionPath&&(0,i.Sd)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var r=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(r&&r.rangeCount>0){var a=r.getRangeAt(0);(0,i.gR)(e.contentDiv,a)&&(o=a)}}return!o&&t&&(o=e.domEvent.selectionRange),o},getSelectionRangeEx:function(e){var t,n,o;if(e.lifecycle.shadowEditFragment){var r,a=e.lifecycle,s=a.shadowEditTableSelectionPath,l=a.shadowEditSelectionPath,c=a.shadowEditImageSelectionPath;if(((null===s||void 0===s?void 0:s.length)||0)>0)return{type:1,ranges:r=e.lifecycle.shadowEditTableSelectionPath.map((function(t){return(0,i.Sd)(e.contentDiv,t.start,t.end)})),areAllCollapsed:ie(r),table:(0,i.W9)(r[0].startContainer,e.contentDiv,"table"),coordinates:void 0};if(((null===c||void 0===c?void 0:c.length)||0)>0)return{type:2,ranges:r=e.lifecycle.shadowEditImageSelectionPath.map((function(t){return(0,i.Sd)(e.contentDiv,t.start,t.end)})),areAllCollapsed:ie(r),image:(0,i.W9)(r[0].startContainer,e.contentDiv,"img"),imageId:void 0};var d=l&&(0,i.Sd)(e.contentDiv,l.start,l.end);return oe(d?[d]:[])}if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;if(e.domEvent.imageSelectionRange)return e.domEvent.imageSelectionRange;var u=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(u&&u.rangeCount>0){var p=u.getRangeAt(0);if((0,i.gR)(e.contentDiv,p))return oe([p])}}return null!==(o=null!==(n=e.domEvent.tableSelectionRange)&&void 0!==n?n:e.domEvent.imageSelectionRange)&&void 0!==o?o:oe(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])},getStyleBasedFormatState:function(e,t){if(!t)return{};var n=[],o=e.pendingFormatState.pendableFormatSpan;o&&(n=[o.style.fontFamily,o.style.fontSize,o.style.color,o.style.backgroundColor]);for(var r,a,s=t?(0,i.qt)(t,["font-family","font-size","color","background-color","line-height","margin-top","margin-bottom","text-align","direction","font-weight"]):[],l=e.contentDiv,c=e.darkColorHandler;t&&(0,i.gR)(l,t,!0)&&(!r||!a);){if(1==t.nodeType){var d=t;r=r||d.style.getPropertyValue("color"),a=a||d.style.getPropertyValue("background-color")}t=t.parentNode}e.lifecycle.isDarkMode||t!=e.contentDiv||(r=r||s[2],a=a||s[3]);var u=c.parseColorValue(n[2]||r),p=c.parseColorValue(n[3]||a);return{fontName:n[0]||s[0],fontSize:n[1]||s[1],textColor:u.lightModeColor,backgroundColor:p.lightModeColor,textColors:u.darkModeColor?{lightModeColor:u.lightModeColor,darkModeColor:u.darkModeColor}:void 0,backgroundColors:p.darkModeColor?{lightModeColor:p.lightModeColor,darkModeColor:p.darkModeColor}:void 0,lineHeight:s[4],marginTop:s[5],marginBottom:s[6],textAlign:s[7],direction:s[8],fontWeight:s[9]}},getPendableFormatState:function(e,t){var n,o=e.api.getSelectionRange(e,!0),r=e.pendingFormatState.pendableFormatState,a=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),s=o&&i.yX.getStart(o).normalize(),l=s&&a&&o.collapsed&&s.equalTo(a);return o&&r&&l&&!t?r:s?function(e,t){var n=t.node,o={},r=[],a=function(){var e=(0,i.e)(n),t=1==n.nodeType&&n.style;e&&t&&(0,i.Co)(te).forEach((function(n){r.indexOf(n)>=0||(o[n]=o[n]||te[n](e,t),ne[n](t)&&r.push(n))})),n=n.parentNode};for(;n&&(0,i.gR)(e.contentDiv,n);)a();return o}(e,s):{}},hasFocus:re,insertNode:function(e,t,n){var o;n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0,insertToRegionRoot:!1};var r=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(null===(o=r.parentNode)||void 0===o||o.insertBefore(t,r.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){var o,a;if(n)switch(n.position){case 0:case 1:var s,l=0==n.position,c=(0,i.uK)(r,l);if(c){var d=l?c.getStartNode():c.getEndNode();n.insertOnNewLine||3==d.nodeType||(0,i.Gv)(d)?(0,i.CP)(t,"DocumentFragment")?(s=(0,i.$r)(t.childNodes),null===(o=d.parentNode)||void 0===o||o.insertBefore(t,l?d:d.nextSibling)):s=null===(a=d.parentNode)||void 0===a?void 0:a.insertBefore(t,l?d:d.nextSibling):s=d.insertBefore(t,l?d.firstChild:null)}else s=r.appendChild(t);if(s&&n.insertOnNewLine){var u=Array.isArray(s)?s:[s];(0,i.mt)(u[0])&&(0,i.mt)(u[u.length-1])||(0,i.LV)(u)}break;case 2:var p=r.appendChild(t);p&&n.insertOnNewLine&&!(0,i.mt)(p)&&(0,i.LV)(p);break;case 5:case 3:var h=function(e,t){var n=e.api.getSelectionRange(e,!0),o=null;return 5==t.position?(o=n,n=t.range):n&&(o=n.cloneRange()),{range:n,rangeToRestore:o}}(e,n),m=h.range,g=h.rangeToRestore;if(!m)return;n.replaceSelection&&!m.collapsed&&m.deleteContents();var f=i.yX.getStart(m),v=void 0;f=n.insertOnNewLine&&n.insertToRegionRoot?function(e,t,n){var o=(0,i.Fo)(e.contentDiv,t,0)[0],r=n.node;if(o){if(3!=r.nodeType||n.isAtEnd||(r=(0,i.ai)(r,n.offset,!0)),r!=o.rootNode)for(;r&&r.parentNode!=o.rootNode;)(0,i.R5)(r,!1),r=r.parentNode;r&&(n=new i.yX(r,-3))}return n}(e,m,f):n.insertOnNewLine&&(v=(0,i.jv)(r,f.normalize().node))?function(e,t,n){var o=new i.yX(e.getEndNode(),-3);if((0,i.CP)(o.node,"HTMLTableRowElement")){var r=t.contentDiv.ownerDocument.createElement("div");(0,i.Sd)(n).insertNode(r),o=new i.yX(r,0)}return o}(v,e,f):(0,i.iI)(r,t,f,m);var b=11==t.nodeType?t.lastChild:t;(m=(0,i.Sd)(f)).insertNode(t),n.updateCursor&&b&&(g=(0,i.Sd)(new i.yX(b,-3).normalize())),g&&e.api.selectRange(e,g)}}),0),!0)},restoreUndoSnapshot:function(e,t){var n,o;e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var r=e.undo.snapshotsService.move(t);if(r&&null!=r.html)try{e.undo.isRestoring=!0,e.api.setContent(e,r.html,!0,null!==(n=r.metadata)&&void 0!==n?n:void 0);var a=e.darkColorHandler,s=e.lifecycle.isDarkMode;r.knownColors.forEach((function(e){a.registerColor(e.lightModeColor,s,e.darkModeColor)})),null===(o=r.entityStates)||void 0===o||o.forEach((function(t){var n=t.type,o=t.id,r=t.state,a=(0,i.a5)(e.contentDiv,(0,i.hm)(n,o))[0],s=a&&(0,i.qe)(a);s&&e.api.triggerEvent(e,{eventType:15,operation:11,entity:s,state:r},!1)}))}finally{e.undo.isRestoring=!1}},select:function(e,t,n,o,r){var a=function(e,t,n,o,r){var a=null;if(function(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.type&&Array.isArray(t.ranges)}(t))a=t;else if((0,i.CP)(t,"HTMLTableElement")&&function(e){var t=e;return null===t||t&&"object"==typeof t&&"object"==typeof t.firstCell&&"object"==typeof t.lastCell}(n))a={type:1,ranges:[],areAllCollapsed:!1,table:t,coordinates:null!==n&&void 0!==n?n:void 0};else if((0,i.CP)(t,"HTMLImageElement")&&"undefined"==typeof n)a={type:2,ranges:[],areAllCollapsed:!1,image:t};else{var s=t?(0,i.CP)(t,"Range")?t:function(e){var t=e;return t&&"object"==typeof t&&Array.isArray(t.start)&&Array.isArray(t.end)}(t)?(0,i.Sd)(e.contentDiv,t.start,t.end):function(e){var t=e;return t&&"object"==typeof t&&"object"==typeof t.node&&"number"==typeof t.offset}(t)||(0,i.CP)(t,"Node")?(0,i.Sd)(t,n,o,r):null:null;a=s?{type:0,ranges:[s],areAllCollapsed:s.collapsed}:null}return a}(e,t,n,o,r);if(a){var s=e.domEvent.skipReselectOnFocus;e.domEvent.skipReselectOnFocus=!0;try{!function(e,t){switch(null===t||void 0===t?void 0:t.type){case 1:(0,i.gR)(e.contentDiv,t.table)&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,null),e.domEvent.tableSelectionRange=e.api.selectTable(e,t.table,t.coordinates),t=e.domEvent.tableSelectionRange);break;case 2:(0,i.gR)(e.contentDiv,t.image)&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,t.image),t=e.domEvent.imageSelectionRange);break;case 0:e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null),(0,i.gR)(e.contentDiv,t.ranges[0])?e.api.selectRange(e,t.ranges[0]):t=null}e.api.triggerEvent(e,{eventType:22,selectionRangeEx:t},!0)}(e,a)}finally{e.domEvent.skipReselectOnFocus=s}}else e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null);return!!a},selectRange:function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,i.gR)(e.contentDiv,t))&&((0,i.kK)(t,n),re(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,o=e.api.getSelectionRange;if(n.pendableFormatState){var r=t.ownerDocument,a=(0,i.Gp)(r);(0,i.Co)(i.qT).forEach((function(e){var t;!!(null===(t=n.pendableFormatState)||void 0===t?void 0:t[e])!=a[e]&&r.execCommand(i.qT[e],!1,void 0)}));var s=o(e,!0),l=s&&i.yX.getStart(s);l&&(n.pendableFormatPosition=l)}}(e),!0)},setContent:function(e,t,n,o){var r,a,s=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var l=e.entity.entityMap,c=t||"",d=(new DOMParser).parseFromString(null!==(a=null===(r=e.trustedHTMLHandler)||void 0===r?void 0:r.call(e,c))&&void 0!==a?a:c,"text/html").body;(0,i.gw)(d,e.contentDiv,l);var u=(0,i.SF)(e.contentDiv);(function(e,t){if(!e.lifecycle.shadowEditSelectionPath&&t)switch(e.domEvent.tableSelectionRange=null,e.domEvent.imageSelectionRange=null,e.domEvent.selectionRange=null,t.type){case 0:e.api.selectTable(e,null),e.api.selectImage(e,null);var n=(0,i.Sd)(e.contentDiv,t.start,t.end);e.api.selectRange(e,n);break;case 1:var o=(0,i.a5)(e.contentDiv,"#"+t.tableId)[0];o&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,o,t));break;case 2:var r=(0,i.a5)(e.contentDiv,"#"+t.imageId)[0];r&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,r))}})(e,o=o||u),s=!0}var p=e.lifecycle.isDarkMode;(!o&&p||o&&!!o.isDarkMode!=!!p)&&(e.api.transformColor(e,e.contentDiv,!1,null,p?0:1,!0,null===o||void 0===o?void 0:o.isDarkMode),s=!0),n&&s&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)},switchShadowEdit:function(e,t){var n=e.lifecycle,o=e.contentDiv,r=n.shadowEditEntities,a=n.shadowEditFragment,s=n.shadowEditSelectionPath,l=n.shadowEditTableSelectionPath,c=n.shadowEditImageSelectionPath,d=!!a,u=function(e,t){return(null===t||void 0===t?void 0:t.type)==e&&t.ranges.map((function(e){return(0,i.cp)(o,e)})).map((function(e){return e}))||null};if(t){if(!d){var p=e.api.getSelectionRangeEx(e),h=e.api.getSelectionRange(e,!0);s=h&&(0,i.cp)(o,h),l=u(1,p),c=u(2,p),r={},a=(0,i.s$)(o,r),e.api.triggerEvent(e,{eventType:17,fragment:a,selectionPath:s},!1),n.shadowEditFragment=a,n.shadowEditSelectionPath=s,n.shadowEditTableSelectionPath=l,n.shadowEditImageSelectionPath=c,n.shadowEditEntities=r}n.shadowEditFragment&&(0,i.gw)(n.shadowEditFragment,o,n.shadowEditEntities,!0)}else n.shadowEditFragment=null,n.shadowEditSelectionPath=null,n.shadowEditEntities=null,d&&(e.api.triggerEvent(e,{eventType:18},!1),a&&(0,i.gw)(a,o,r),s&&(e.domEvent.selectionRange=(0,i.Sd)(o,s.start,s.end)))},transformColor:function(e,t,n,o,i,r,a){void 0===a&&(a=!1);var s=e.darkColorHandler,l=e.lifecycle.onExternalContentTransform,c=0==i;t&&(r||e.lifecycle.isDarkMode)&&ye(t,l?function(e){l(e,a,c,s)}:function(e){s.transformElementColor(e,a,c)},n);null===o||void 0===o||o()},triggerEvent:function(e,t,n){e.lifecycle.shadowEditFragment&&!(Se.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))},selectTable:function(e,t,n){var o;if(ge(e),function(e){if(e){var t=e||{},n=t.firstCell,o=t.lastCell;if(n&&o){var i=function(e){return be(e.x)&&be(e.y)};return i(n)&&i(o)}}return!1}(n)&&t){ae(t,"tableSelected"),ae(e.contentDiv,"contentDiv_");var r=function(e,t,n){var o="#"+e.contentDiv.id,r=function(e,t,n){var o,r=[],a=[],s=new i.ZX(e),l=(0,i.Tj)(s,t);l?function(e,t,n,o){var i=t.table,r=e+" #"+i.id;n.push(r,r+" *");var a=new Range;a.selectNode(i),o.push(a)}(n,s,a,r):function(e,t,n,o,r){var a,s=e.firstCell.y,l=e.firstCell.x,c=e.lastCell.y,d=e.lastCell.x,u=t.table,p=null,h=null,m=(0,i.$r)(u.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,i.e)(e))>-1})),g=0,f=m.map((function(e){var t={el:(0,i.e)(e),start:g,end:e.childNodes.length+g};return g=t.end,t}));null===(a=t.cells)||void 0===a||a.forEach((function(e,t){var a=0;p=null,h=null;for(var m=f.filter((function(e){return e.start<=t&&e.end>t}))[0],g=m?">"+m.el+">":">",v=m&&t+1>=m.start?t+1-m.start:t+1,b=0;b<e.length;b++){var y=e[b].td;if(y&&(a++,t>=s&&t<=c&&b>=l&&b<=d)){ve(y);var C=fe(n,u.id,g,v,(0,i.e)(y),a),S=C+" *";o.push(C,S),p=p||u.querySelector(C),h=u.querySelector(C)}}if(p&&h){var k=new Range;k.setStartBefore(p),k.setEndAfter(h),r.push(k)}}))}(t,s,n,a,r);var c=[],d="";for(;a.length>0;)((d+=(d.length>0?",":"")+a.shift()||"").length+((null===(o=a[0])||void 0===o?void 0:o.length)||0)>me||0==a.length)&&(c.push(d+" "+he),d="");return{cssRules:c,ranges:r,isWholeTableSelected:l}}(t,n,o),a=r.cssRules,s=r.ranges,l=r.isWholeTableSelected;return a.forEach((function(t){return(0,i.Ju)(e.contentDiv.ownerDocument,t,pe+e.contentDiv.id)})),{ranges:s,isWholeTableSelected:l}}(e,t,n),a=r.ranges,s=r.isWholeTableSelected;if(!function(e,t){var n,o=t.firstCell;return!(e.rows.item(o.y)&&(null===(n=e.rows.item(o.y))||void 0===n?void 0:n.cells.item(o.x)))}(t,n)){var l=null===(o=t.rows.item(n.firstCell.y))||void 0===o?void 0:o.cells.item(n.firstCell.x);l&&e.api.selectRange(e,(0,i.Sd)(new i.yX(l,0)))}return{type:1,ranges:a,table:t,areAllCollapsed:a.filter((function(e){return null===e||void 0===e?void 0:e.collapsed})).length==a.length,coordinates:n,isWholeTableSelected:s}}return null},selectImage:function(e,t){ue(e);var n=null;if(t){var o=(0,i.Sd)(t);ae(t,"imageSelected"),ae(e.contentDiv,"contentDiv_"),e.api.selectRange(e,(0,i.Sd)(new i.yX(t,-3))),ce(e,t),n={type:2,ranges:[o],image:t,areAllCollapsed:o.collapsed}}return n}},De=function(e,t){var n,r=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new U,edit:n.edit||new u,pendingFormatState:n.pendingFormatState||new H,_placeholder:null,typeAfterLink:null,undo:n.undo||new K(t),domEvent:n.domEvent||new l(t,e),mouseUp:n.mouseUp||new O,copyPaste:n.copyPaste||new a(t),entity:n.entity||new w,imageSelection:n.imageSelection||new P,normalizeTable:n.normalizeTable||new F,lifecycle:n.lifecycle||new M(t,e)}}(e,t),s=[];(0,i.Co)(r).forEach((function(e){"_placeholder"==e?t.plugins&&(0,i.u5)(s,t.plugins):s.push(r[e])}));var c=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}(r),d=(null!==(n=t.zoomScale)&&void 0!==n?n:-1)>0?t.zoomScale:1,p=t.getVisibleViewport||function(){var e=c.domEvent.scrollContainer;return(0,i.XQ)(e==h.contentDiv?[e]:[e,h.contentDiv])},h=(0,o.__assign)((0,o.__assign)({contentDiv:e,api:(0,o.__assign)((0,o.__assign)({},ke),t.coreApiOverride||{}),originalApi:ke,plugins:s.filter((function(e){return!!e}))},c),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:d,sizeTransformer:t.sizeTransformer||function(e){return e/d},getVisibleViewport:p,imageSelectionBorderColor:t.imageSelectionBorderColor,darkColorHandler:new Q(e,c.lifecycle.getDarkColor),disposeErrorHandler:t.disposeErrorHandler});return h};var xe=function(){function e(e,t,n){var o=this;if(this.core=null,"DIV"!=(0,i.e)(e))throw new Error("contentDiv must be an HTML DIV element");this.core=n(e,t),this.core.plugins.forEach((function(e){return e.initialize(o)})),this.ensureTypeInContainer(new i.yX(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){for(var e,t=this.getCore(),n=t.plugins.length-1;n>=0;n--){var o=t.plugins[n];try{o.dispose()}catch(i){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,o,i)}}t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getCore();return!!e&&n.api.insertNode(n,e,null!==t&&void 0!==t?t:null)},e.prototype.deleteNode=function(e){return!!(e&&this.contains(e)&&e.parentNode)&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){var o=this.getCore();return!(!this.contains(e)||!t)&&(o.api.transformColor(o,n?t:null,!0,(function(){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return(0,i.jv)(this.getCore().contentDiv,e)},e.prototype.contains=function(e){return!!e&&(0,i.gR)(this.getCore().contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=this.getCore(),a=[],s=t instanceof Function?0:t;n=t instanceof Function?t:n;var l=0==s?null:this.getSelectionRangeEx();return l?(l.ranges.forEach((function(t){a.push.apply(a,(0,o.__spreadArray)([],(0,o.__read)((0,i.a5)(r.contentDiv,e,n,s,t)),!1))})),a):(0,i.a5)(r.contentDiv,e,n,s,void 0)},e.prototype.collapseNodes=function(e,t,n){return(0,i.bO)(this.getCore().contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return(0,i.Op)(this.getCore().contentDiv,e)},e.prototype.getContent=function(e){void 0===e&&(e=0);var t=this.getCore();return t.api.getContent(t,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.getCore();n.api.setContent(n,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var o=this.getDocument(),r=null===(n=(new DOMParser).parseFromString(this.getCore().trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,a=(null===r||void 0===r?void 0:r.childNodes)?(0,i.$r)(r.childNodes):[];t&&t.insertOnNewLine&&a.length>1&&(a=[(0,i.LV)(a)]);var s=o.createDocumentFragment();a.forEach((function(e){return s.appendChild(e)})),this.insertNode(s,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed?(0,i.IN)(this.getCore().contentDiv,e):null},e.prototype.paste=function(e,t,n,o){var r=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===o&&(o=!1);var a=this.getCore();if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var s=this.getSelectionRange(),l=s&&i.yX.getStart(s),c=a.api.createPasteFragment(a,e,l,t,n,o);c&&this.addUndoSnapshot((function(){return r.insertNode(c),e}),"Paste")}},e.prototype.getSelectionRange=function(e){void 0===e&&(e=!0);var t=this.getCore();return t.api.getSelectionRange(t,e)},e.prototype.getSelectionRangeEx=function(){var e=this.getCore();return e.api.getSelectionRangeEx(e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,i.cp)(this.getCore().contentDiv,e)},e.prototype.hasFocus=function(){var e=this.getCore();return e.api.hasFocus(e)},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.select=function(e,t,n,o){var i=this.getCore();return i.api.select(i,e,t,n,o)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if((null===t||void 0===t?void 0:t.focusNode)&&this.contains(t.focusNode))return new i.yX(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?i.yX.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var o,r=this;return n=t?void 0:n,null!==(o=(0,i.$F)(null!==n&&void 0!==n?n:null,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=r.getFocusedPosition();t=null===n||void 0===n?void 0:n.node}return t&&(0,i.W9)(t,r.getCore().contentDiv,e)})))&&void 0!==o?o:null},e.prototype.isPositionAtBeginning=function(e){return(0,i.r_)(e,this.getCore().contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRangeEx(),n=[],r=this.getCore().contentDiv;return t.ranges.forEach((function(t){n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(t?(0,i.Fo)(r,t,e):[]),!1))})),n.filter((function(e,t,n){return n.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var n,o="string"==typeof e?((n={})[e]=t,n):e,i=this.getCore();return i.api.attachDomEvent(i,o)},e.prototype.triggerPluginEvent=function(e,t,n){void 0===n&&(n=!1);var i=this.getCore(),r=(0,o.__assign)({eventType:e},t);return i.api.triggerEvent(i,r,n),r},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,-1)},e.prototype.redo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,1)},e.prototype.addUndoSnapshot=function(e,t,n,o){var i=this.getCore();i.api.addUndoSnapshot(i,null!==e&&void 0!==e?e:null,null!==t&&void 0!==t?t:null,null!==n&&void 0!==n&&n,o)},e.prototype.getUndoState=function(){var e=this.getCore().undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.getCore().contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){var o=this.getCore();return(o.lifecycle.customData[e]=o.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.getCore().domEvent.isInIME},e.prototype.getDefaultFormat=function(){var e;return null!==(e=this.getCore().lifecycle.defaultFormat)&&void 0!==e?e:{}},e.prototype.getBodyTraverser=function(e){return i.wI.createBodyTraverser(this.getCore().contentDiv,e)},e.prototype.getSelectionTraverser=function(e){var t;return(e=null!==(t=null!==e&&void 0!==e?e:this.getSelectionRange())&&void 0!==t?t:void 0)?i.wI.createSelectionTraverser(this.getCore().contentDiv,e):null},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t?i.wI.createBlockTraverser(this.getCore().contentDiv,t,e):null},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,i.$F)(null!==e&&void 0!==e?e:null,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new i.ug(t.getCore().contentDiv,i.yX.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.getCore().contentDiv.ownerDocument.defaultView||window,o=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(o)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.getCore().contentDiv.removeAttribute(e):this.getCore().contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.getCore().contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.getCore().contentDiv,o=n.getBoundingClientRect(),i=e.getBoundingClientRect();if(o&&i){var r=i.left-(null===o||void 0===o?void 0:o.left),a=i.top-(null===o||void 0===o?void 0:o.top);return t&&(r+=n.scrollLeft,a+=n.scrollTop),[r,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this.getCore();null===e||void 0===e||e.keys.forEach((function(n){var o=t.edit.features[n]||[];o.push(e),t.edit.features[n]=o}))},e.prototype.removeContentEditFeature=function(e){var t=this.getCore();null===e||void 0===e||e.keys.forEach((function(n){var o,i=t.edit.features[n],r=null!==(o=null===i||void 0===i?void 0:i.indexOf(e))&&void 0!==o?o:-1;r>=0&&(t.edit.features[n].splice(r,1),t.edit.features[n].length<1&&delete t.edit.features[n])}))},e.prototype.getStyleBasedFormatState=function(e){var t;if(!e){var n=this.getSelectionRange();e=null!==(t=n&&i.yX.getStart(n).normalize().node)&&void 0!==t?t:void 0}var o=this.getCore();return o.api.getStyleBasedFormatState(o,null!==e&&void 0!==e?e:null)},e.prototype.getPendableFormatState=function(e){void 0===e&&(e=!1);var t=this.getCore();return t.api.getPendableFormatState(t,e)},e.prototype.ensureTypeInContainer=function(e,t){var n=this.getCore();n.api.ensureTypeInContainer(n,e,t)},e.prototype.setDarkModeState=function(e){var t=this.isDarkMode();if(t!=!!e){var n=this.getCore();n.api.transformColor(n,n.contentDiv,!1,null,e?0:1,!0,t),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode")}},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e,t){void 0===t&&(t=0);var n=this.getCore();n.api.transformColor(n,e,!0,null,t)},e.prototype.getDarkColorHandler=function(){return this.getCore().darkColorHandler},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return function(e,t){return(e||[]).indexOf(t)>=0}(this.getCore().lifecycle.experimentalFeatures,e)},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.getCore().sizeTransformer},e.prototype.getZoomScale=function(){return this.getCore().zoomScale},e.prototype.setZoomScale=function(e){var t=this.getCore();if(e>0&&e<=10){var n=t.zoomScale;t.zoomScale=e,n!=e&&this.triggerPluginEvent(21,{oldZoomScale:n,newZoomScale:e},!0)}},e.prototype.getVisibleViewport=function(){return this.getCore().getVisibleViewport()},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();const Te=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n,De)||this}return(0,o.__extends)(t,e),t}(xe)},38831:(e,t,n)=>{"use strict";function o(e,t){var n;if("Range"==t)return"[object Range]"==Object.prototype.toString.apply(e)&&!!(null===(n=e)||void 0===n?void 0:n.commonAncestorContainer);var o=function(e){var t=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return t&&(t.defaultView||window)}(e),i=o&&o[t],r=window,a=r&&r[t];return a&&e instanceof a||i&&e instanceof i}function i(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(o(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}function r(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}function a(e,t){var n;if(!e||!e.parentNode)return null;var o=e.parentNode,i=o.cloneNode(!1);if(i.removeAttribute("id"),t)for(;o.firstChild&&o.firstChild!=e;)i.appendChild(o.firstChild);else for(;e.nextSibling;)i.appendChild(e.nextSibling);return i.firstChild&&""!=i.innerHTML?null===(n=o.parentNode)||void 0===n||n.insertBefore(i,t?o:o.nextSibling):i=null,i}function s(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,o=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(o){if(r(t,n)){var i=n;n=t,t=i}a(t,!0),a(n,!1)}return o}function l(e){return[].slice.call(e)}function c(e,t,n,o){var r;if(!i(e,t)||!i(e,n))return[];if(i(t=d(e,t,n,!0,o),n=d(e,n,t,!1,o),!0))return[t];if(i(n,t))return[n];if(t.parentNode==n.parentNode){var a=t.parentNode?l(null===(r=t.parentNode)||void 0===r?void 0:r.childNodes):[],s=a.indexOf(t),c=a.indexOf(n);return a.slice(s,c+1)}return[t,n]}function d(e,t,n,o,r){for(;t.parentNode!=e&&!i(t.parentNode,n);){if(o&&t.previousSibling||!o&&t.nextSibling){if(!r)break;a(t,o)}if(!t.parentNode)break;t=t.parentNode}return t}function u(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}n.d(t,{Pw:()=>R,wI:()=>ge,Jp:()=>rt,wF:()=>ne,QJ:()=>ee,r$:()=>de,qT:()=>kt,yX:()=>S,ug:()=>ve,x8:()=>jn,qR:()=>eo,ZX:()=>un,u$:()=>ke,kK:()=>wo,iu:()=>Ao,iI:()=>ci,Wc:()=>St,NQ:()=>J,u5:()=>Xn,$F:()=>Zo,t:()=>_o,rm:()=>Oo,OD:()=>Fo,fV:()=>Ke,gn:()=>Yo,xs:()=>Po,bO:()=>c,uO:()=>ao,T8:()=>Ho,gR:()=>i,R9:()=>kn,oO:()=>En,w5:()=>Bo,n:()=>N,b$:()=>jt,iv:()=>Ut,Sd:()=>x,QA:()=>Mo,hu:()=>Zn,IN:()=>ui,uI:()=>Ae,SF:()=>Eo,W9:()=>C,jv:()=>F,L9:()=>W,qt:()=>U,Ub:()=>ye,qe:()=>zo,hm:()=>Uo,uK:()=>H,Fb:()=>re,b2:()=>ho,XQ:()=>Ft,yb:()=>Gt,ec:()=>Y,Co:()=>I,ZZ:()=>yi,M0:()=>st,Gp:()=>Dt,oe:()=>so,Q$:()=>X,Fo:()=>io,RE:()=>Gn,cp:()=>uo,$f:()=>Ve,GY:()=>Xt,YG:()=>ln,e:()=>u,rf:()=>hi,bC:()=>Re,jA:()=>Oe,mt:()=>m,XJ:()=>ei,tD:()=>ni,VL:()=>Qo,Op:()=>wt,mN:()=>qn,r_:()=>lo,Gv:()=>b,Tj:()=>gn,aN:()=>Lt,B5:()=>y,nu:()=>We,s$:()=>Wo,o7:()=>No,YI:()=>Bt,H0:()=>pt,a5:()=>Nt,TA:()=>Te,Z7:()=>ri,oF:()=>oi,Ij:()=>Vt,gw:()=>Ko,GP:()=>je,CP:()=>o,ar:()=>at,B_:()=>$t,wW:()=>Ct,Ju:()=>ii,Dy:()=>To,dW:()=>Cn,kq:()=>qt,hS:()=>Ze,KC:()=>s,R5:()=>a,ai:()=>z,$r:()=>l,oA:()=>Ot,LV:()=>M});var p="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),h=["block","list-item","table-cell"];function m(e){var t=u(e);return!(!t||!(h.indexOf(e.style.display)>=0||p.indexOf(t)>=0))}var g=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return r(this.element,e.getEndNode())},e.prototype.contains=function(e){return i(this.element,e,!0)},e.prototype.getTextContent=function(){var e;return(null===(e=this.element)||void 0===e?void 0:e.textContent)||""},e}();const f=g;var v="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");function b(e){return!!e&&v.indexOf(u(e))>=0}function y(e,t){return o(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}function C(e,t,n){var o=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(o&&n)if(o.closest)o=o.closest(n);else for(;o&&o!=t&&!y(o,n);)o=o.parentElement;return!t||i(t,o)?o:null}const S=function(){function e(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=k(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=k(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=D(this.node),this.isAtEnd=!0;break;default:var o=D(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=C(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var o=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!o)break;t=o,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:r(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function k(e){for(var t=0;e=(null===e||void 0===e?void 0:e.previousSibling)||null;)t++;return t}function D(e){var t;return 3==e.nodeType?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:1==e.nodeType||11==e.nodeType?e.childNodes.length:1}function x(e,t,n,i){var r,a=null,s=null;if(E(e)?(a=e,s=E(t)?t:null):o(e,"Node")&&(Array.isArray(t)?(a=w(e,t),s=Array.isArray(n)?w(e,n):null):"number"==typeof t?(a=new S(e,t),s=o(n,"Node")?new S(n,i):null):!o(t,"Node")&&t||(a=new S(e,-2),s=new S(t||e,-3))),null===(r=null===a||void 0===a?void 0:a.node)||void 0===r?void 0:r.ownerDocument){var l=a.node.ownerDocument.createRange();return a=T(a),s=T(s||a),l.setStart(a.node,a.offset),l.setEnd(s.node,s.offset),l}return null}function T(e){return 1==e.node.nodeType&&b(e.node)?new S(e.node,e.isAtEnd?-3:-2):e}function E(e){return e&&e.node}function w(e,t){if(!e||!t)return null;for(var n=0,o=0;o<t.length&&(n=t[o],o<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);o++)e=e.childNodes[n];return new S(e,n)}var _=n(6326);function I(e){return Object.keys(e)}var P=/android/i;var A,R="undefined"!==typeof window&&window?function(e,t,n){var o,i=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||i,a=!1,s=!1,l=!1,c=!1,d=-1!=e.indexOf("WebKit"),u=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(o=e||n||"")||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(u=!0),r||(a=-1!=e.indexOf("Chrome"),s=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(l=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(c=-1!=e.indexOf("Edge"))&&(d=a=s=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:d,isIE:r,isIE11OrGreater:i,isSafari:l,isChrome:a,isFirefox:s,isEdge:c,isIEOrEdge:r||c,isAndroid:P.test(e),isMobileOrTablet:u}}(window.navigator.userAgent,window.navigator.appVersion,window.navigator.vendor):{},L=((A={})[0]={tag:""},A[1]=R.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},A[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},A[3]={tag:"div",style:"width: 600px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},A[4]={tag:"li",style:"display:block"},A[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},A[6]={tag:"span",style:"max-width:100%;position:relative",children:[{tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"}]},A[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},A[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},A[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},A[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},A[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},A[12]={tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]},A);function N(e,t){if("number"==typeof e&&(e=L[e]),!e||!e.tag)return null;var n=e.tag,i=e.namespace,r=e.className,a=e.style,s=e.dataset,l=e.attributes,c=e.children,d=i?t.createElementNS(i,n):t.createElement(n);return a&&d.setAttribute("style",a),r&&(d.className=r),s&&o(d,"HTMLElement")&&I(s).forEach((function(e){d.dataset[e]=s[e]})),l&&I(l).forEach((function(e){d.setAttribute(e,l[e])})),c&&c.forEach((function(e){if("string"===typeof e)d.appendChild(t.createTextNode(e));else if(e){var n=N(e,t);n&&d.appendChild(n)}})),d}function M(e,t){var n,i;if(0==(e=e?o(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;if(t||(t="div"),!o(t,"HTMLElement")){var r=e[0].ownerDocument;t="string"===typeof t?/^\w+$/.test(t)?r.createElement(t):function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,l(n.childNodes)}(t,r)[0]:N(t,r)}var a=e[0].parentNode;a&&a.insertBefore(t,e[0]);try{for(var s=(0,_.__values)(e),c=s.next();!c.done;c=s.next()){var d=c.value;t.appendChild(d)}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return t}var O=["TD","TH","LI","BLOCKQUOTE"];const B=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(var t=e;t&&!m(t);)t=t.parentNode;return t},e.prototype.collapseToSingleElement=function(){for(var t=e.getBlockContext(this.startNode),n=t?c(t,this.startNode,this.endNode,!0):[],o=e.getBlockContext(this.startNode);n[0]&&n[0]!=o&&n[0].parentNode!=this.rootNode&&O.indexOf(u(n[0].parentNode))<0;){var i=s(n);if(!i)break;n=[i]}return 1==n.length&&m(n[0])?n[0]:M(n)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return r(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return i(this.startNode,e,!0)||i(this.endNode,e,!0)||r(e,this.startNode)&&r(this.endNode,e)},e.prototype.getTextContent=function(){var e=x(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();function F(e,t){if(!i(e,t))return null;var n=B.getBlockContext(t);if(!n)return null;if(n==t)return new f(n);var o=j(t,n,!1),r=j(t,n,!0);if(!o||!r)return null;var a=c(e,o,r,!1);if(0===a.length)return null;if(o=a[0],r=a[a.length-1],o.parentNode!=r.parentNode)return new B(e,o,r);for(;!o.previousSibling&&!r.nextSibling;){var s=o.parentNode;if(s==n){n!=e&&(o=r=s);break}if(!s||s==e)break;o=r=s}return o==r&&m(o)?new f(o):new B(e,o,r)}function j(e,t,n){var o=e;if("BR"==u(o)&&n)return o;for(;o;){for(var i=e;e.parentNode&&!(i=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return o;for(;i;){if(m(i))return o;if("BR"==u(i))return n?i:o;e=i,i=n?e.firstChild:e.lastChild}o=e}return o}function H(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&F(e,n)||null}function z(e,t,n){var o,i,r,a=(null===(o=e.nodeValue)||void 0===o?void 0:o.substring(0,t))||"",s=(null===(i=e.nodeValue)||void 0===i?void 0:i.substring(t))||"",l=e.ownerDocument.createTextNode(n?a:s);return e.nodeValue=n?s:a,null===(r=e.parentNode)||void 0===r||r.insertBefore(l,n?e:e.nextSibling),l}function U(e,t){var n,o;void 0===t&&(t=["font-family","font-size","color","background-color"]);var i=C(e),r=[];if(t=Array.isArray(t)?t:[t],i){var a=(i.ownerDocument.defaultView||window).getComputedStyle(i);if(a)try{for(var s=(0,_.__values)(t),l=s.next();!l.done;l=s.next()){var c=l.value,d=a.getPropertyValue(c)||"";d="font-family"!=c?d.toLowerCase():d,d="font-size"==c?K(d):d,r.push(d)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}return r}function W(e,t){return U(e,t)[0]||""}function K(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}var G=/^[\r\n]+$/g,q=/[\t\r\n\u0020\u200B]/gm;function V(e,t){if(3==e.nodeType)return!(e.nodeValue&&""!=e.textContent&&!G.test(e.nodeValue))||!(!t||""!=e.nodeValue.replace(q,""));if(1==e.nodeType){if("none"==W(e,"display"))return!0;var n=u(e);if("DIV"==n||"SPAN"==n){for(var o=e.firstChild;o;o=o.nextSibling)if(!V(o,t))return!1;return!0}return!1}return!0}function Z(e,t,n,o,r){var a=null,s=n?function(e){return(null===e||void 0===e?void 0:e.nextSibling)||null}:function(e){return(null===e||void 0===e?void 0:e.previousSibling)||null},l=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(i(e,t))for(var c=t,d=!0;d;){var p=(null===c||void 0===c?void 0:c.parentNode)||null;for(c=s(c);!c&&p!=e;)c=s(p),p=(null===p||void 0===p?void 0:p.parentNode)||null;for(;c&&(!o||o.indexOf(u(c))<0)&&l(c);)c=l(c);if(!(d=!!c&&V(c,r))){a=c;break}}return a}function Y(e,t,n){return Z(e,t,!0,n)}function X(e,t,n){return Z(e,t,!1,n)}var $="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL,SUP,SUB".split(",");function J(e,t,n,i){void 0===n&&(n=new S(e,0).normalize()),void 0===i&&(i=new S(e,-1).normalize());for(var r=[],a=n,l=i;a&&l&&l.isAfter(a);){var c=a.node,d=u(c.parentNode),p=Y(e,c);3==c.nodeType&&["TR","TABLE"].indexOf(d)<0&&(c!=l.node||l.isAtEnd||(c=z(c,l.offset,!0)),a.offset>0&&(c=z(c,a.offset,!1)),r.push(c)),a=p&&new S(p,0)}if(r.length>0){if(r.every((function(e){return e.parentNode==r[0].parentNode}))){var h=r.shift();r.forEach((function(e){var t,n=(h.nodeValue||"")+(e.nodeValue||"");h.nodeValue=n,null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),r=[h]}r.forEach((function(e){for(var n=e;n&&"SPAN"!=u(n)&&$.indexOf(u(n.parentNode))>=0;)Q(n,t),n=s(n);n&&"SPAN"!=u(n)&&(Q(n,t),n=M(n,"SPAN")),o(n,"HTMLElement")&&t(n)}))}}function Q(e,t){e&&1==e.nodeType&&t(e,!0)}const ee=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new S(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new S(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&r(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){J(this.containerNode,e)},e}();const te=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,_.__extends)(t,e),t}(ee);const ne=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,_.__extends)(t,e),t}(ee);function oe(e,t){var n=o(e,"Node")?F(e,t):e;return t&&n&&function(e,t){for(var n,o=[e],i=e.parentNode;i&&t.contains(i);i=i.parentNode)o.push(i);for(var r=o.length-1;r>=0&&!n;r--){var a=o[r],s=u(a);"A"==s?n=new ne(a,t):"IMG"==s&&(n=new te(a,t))}return n||new ee(e,t)}(t,n)}function ie(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},o=n(e);o&&n(o);)o=n(o);return o&&V(o)&&(o=Z(e,o,t)),o}function re(e){return ie(e,!0)}function ae(e){var t=re(e);return t?oe(e,t):null}function se(e){var t=function(e){return ie(e,!1)}(e);return t?oe(e,t):null}const le=function(){function e(e,t){this.rootNode=e,this.startNode=i(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?F(this.rootNode,this.startNode):H(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?oe(this.rootNode,this.startNode):ae(this.rootNode)},e.prototype.isBlockInScope=function(e){return i(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();const ce=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();const de=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return x(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end?new e(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start?new e(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var i=Y(o,t.node);t=i?new S(i,0):null}if(0==n.offset){var r=X(o,n.node);n=r?new S(r,-1):null}J(o,e,t||void 0,n||void 0)},e}();function ue(e,t){return pe(e,t,!0)}function pe(e,t,n){if(!e||!t||!t.node)return null;var o=(t=t.normalize()).offset,i=t.isAtEnd,r=t.node,a=!1;!n&&0==o&&!i||n&&i?r=Z(e,r,n):3==r.nodeType&&(!n&&!i||n&&o>0)&&(a=!0),r&&V(r)&&(r=Z(e,r,n));var s=oe(e,r);return s&&(a||s.contains(t))&&(s=n?new de(s,t,void 0):new de(s,void 0,t)),s}const he=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,o(t,"Range")&&(t=S.getStart(t)),this.position=t.normalize(),this.block=F(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof f){var n=e.getStartNode();return t?ae(n):se(n)}return oe(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=ue(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new ce(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();const me=function(){function e(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=S.getStart(t).normalize(),this.end=S.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=F(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(ue(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=!!n&&n.equals(e);else{var o=F(this.rootNode,this.end.node);t=!!n&&!!o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var o=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,o=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:o||i?new de(e,o?t:void 0,i?n:void 0):e},e}();const ge=function(){function e(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}return e.createBodyTraverser=function(t,n,o){return new e(new le(t,n))},e.createSelectionTraverser=function(t,n,o){return new e(new me(t,n),o)},e.createBlockTraverser=function(t,n,o,i){return void 0===o&&(o=3),new e(new he(t,n,o))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=Z(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),o=n?F(this.scoper.rootNode,n):null;return o&&this.scoper.isBlockInScope(o)&&(e&&o.isAfter(t)||!e&&t.isAfter(o))?(this.currentBlock=o,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof ce?null:this.currentInline},enumerable:!1,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof ce?(t=pe(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):(t=function(e,t,n){if(!t)return null;if(t instanceof de){var o=n?t.nextInlineElement:t.previousInlineElement;if(o)return o}var i=t.getContainerNode();return i=Z(e,i,n),oe(e,i)}(this.scoper.rootNode,n,e),t=t&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null),t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();var fe=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;const ve=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word||""},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=ge.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n=null,o=null,i=e.length-1;return this.forEachTextInlineElement((function(r){for(var a=r.getTextContent()||"",s=a.length-1;s>=0&&i>=0;s--)if(e.charCodeAt(i)==a.charCodeAt(s))i--,o||(o=r.getStartPosition().move(s+1));else if(t||o)return!0;return-1==i&&(n=r.getStartPosition().move(s+1),!0)})),n&&o&&x(n,o)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||ge.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=fe.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();var be="\u200b";function ye(e){return e&&o(e,"HTMLSpanElement")&&(e.classList.contains("entityDelimiterAfter")||e.classList.contains("entityDelimiterBefore"))&&e.textContent===be?e:null}var Ce,Se="\u200b";function ke(e){var t=(0,_.__read)(function(e){var t=[],n=e.nextElementSibling,o=e.previousElementSibling;return t.push(De(n,"entityDelimiterAfter"),De(o,"entityDelimiterBefore")),t}(e),2),n=t[0],o=t[1];return n||(n=xe(e,"entityDelimiterAfter")),o||(o=function(e){return xe(e,"entityDelimiterBefore")}(e)),[n,o]}function De(e,t){return e&&ye(e)&&e.classList.contains(t)?e:void 0}function xe(e,t){var n=N({tag:"span",className:t,children:[Se]},e.ownerDocument);if(n){var o="entityDelimiterAfter"==t?"afterend":"beforebegin";e.insertAdjacentElement(o,n)}return n}function Te(e,t){if(e){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}var Ee=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,we="text/*",_e="link-preview",Ie=((Ce={})["text/html"]=function(e,t){return e.rawHtml=R.isEdge?function(e){var t=Ee.exec(e);if(3==(null===t||void 0===t?void 0:t.length)){var n=parseInt(t[1]),o=parseInt(t[2]);n>0&&o>n&&(e=e.substring(n,o))}return e}(t):t},Ce["text/plain"]=function(e,t){return e.text=t},Ce[we]=function(e,t,n){return!!n&&(e.customValues[n]=t)},Ce["text/"+_e]=function(e,t){try{e.customValues[_e]=t,e.linkPreview=JSON.parse(t)}catch(A){}},Ce);function Pe(e,t,n){var o={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:n};return Promise.all((e||[]).map((function(e){var n=e.type;if(0!=n.indexOf("image/")||o.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var i=e.getAsFile();i&&(o.types.push(n),o.files.push(i)),t()}));var i=function(e,t){var n=0==e.indexOf("text/")?e.substring(5):null,o=t&&n?t.indexOf(n):-1;return n&&o>=0?n:void 0}(n,null===t||void 0===t?void 0:t.allowedCustomPasteType),r=Ie[n]||(i?Ie[we]:null);return new Promise((function(t){return r?e.getAsString((function(e){o.types.push(n),r(o,e,i),t()})):t()}))}return o.types.push(n),o.image=e.getAsFile(),new Promise((function(e){o.image?Te(o.image,(function(t){o.imageDataUri=t,e()})):e()}))}))).then((function(){return o}))}function Ae(e,t,n,o){var i,r=e.clipboardData||(null===(i=e.target.ownerDocument)||void 0===i?void 0:i.defaultView).clipboardData;r.items?(e.preventDefault(),Pe(l(r.items),n,!0).then((function(e){var n;n=o,R.isAndroid&&n&&n.deleteContents(),t(e)}))):function(e,t,n){for(var o,i,r,a={types:e.types?l(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0},s=0;s<(e.files?e.files.length:0);s++){var c=e.files.item(s);if(0==(null===(o=null===c||void 0===c?void 0:c.type)||void 0===o?void 0:o.indexOf("image/"))){a.image=c;break}}var d=function(){a.image?Te(a.image,(function(e){a.imageDataUri=e,t(a)})):t(a)};if((null===n||void 0===n?void 0:n.getTempDiv)&&(null===n||void 0===n?void 0:n.removeTempDiv)){var u=n.getTempDiv();u.contentEditable="true",u.innerHTML="",u.focus(),null===(r=null===(i=u.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===r||r.setTimeout((function(){var e;a.rawHtml=u.innerHTML,null===(e=n.removeTempDiv)||void 0===e||e.call(n,u),d()}),0)}else a.rawHtml=void 0,d()}(r,t,n)}function Re(e,t){var n=t.ownerDocument.createElement("img");n.style.maxWidth="100%",n.src=e,t.appendChild(n)}var Le="\xa0",Ne="\u2002",Me=6;function Oe(e,t,n){var o=n.ownerDocument;e.split("\n").forEach((function(e,i,r){(e=e.replace(/^ /g,Le).replace(/\r/g,"").replace(/ {2}/g," "+Le)).includes("\t")&&(e=function(e,t){void 0===t&&(t=0);var n,o=e;for(;-1!=(n=o.indexOf("\t"));){var i=o.slice(0,n),r=o.slice(n+1),a=Me-(i.length+t)%Me;o=i+Array(a).fill(Ne).join("")+r}return o}(e,0===i?null===t||void 0===t?void 0:t.offset:0));var a=o.createTextNode(e);2==r.length&&0==i?(n.appendChild(a),n.appendChild(o.createElement("br"))):i>0&&i<r.length-1?n.appendChild(M(""==e?o.createElement("br"):a)):n.appendChild(a)}))}var Be="\x3c!--StartFragment--\x3e",Fe="\x3c!--EndFragment--\x3e";function je(e,t,n){var o,i,r=t.clipboardData,a=t.sanitizingOption,s=r.rawHtml;if(s&&(null===e||void 0===e?void 0:e.body)){var c=null===(o=e.querySelector("html"))||void 0===o?void 0:o.attributes;(c?l(c):[]).reduce((function(e,t){return e[t.name]=t.value,e}),t.htmlAttributes),l(e.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),t.htmlAttributes),r.htmlFirstLevelChildTags=[],null===e||void 0===e||e.body.normalize();for(var d=0;d<(null===e||void 0===e?void 0:e.body.childNodes.length);d++){var p=null===e||void 0===e?void 0:e.body.childNodes.item(d);if(p.nodeType==Node.TEXT_NODE)if(!(null===(i=p.nodeValue)||void 0===i?void 0:i.replace(/(\r\n|\r|\n)/gm,"").trim()))continue;var h=u(p);p.nodeType!=Node.COMMENT_NODE&&r.htmlFirstLevelChildTags.push(h)}He(e,(function(t){null===e||void 0===e||e.head.appendChild(t),a.additionalGlobalStyleNodes.push(t)}));var m=s.indexOf(Be),g=s.lastIndexOf(Fe);m>=0&&g>=m+Be.length&&(t.htmlBefore=s.substr(0,m),t.htmlAfter=s.substr(g+Fe.length),r.html=s.substring(m+Be.length,g),e.body.innerHTML=n(r.html),He(e.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}}function He(e,t){l(e.querySelectorAll("style")).forEach(t)}var ze="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");function Ue(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),o={};return ze.forEach((function(e){return o[e]=n&&n.getPropertyValue(e)||""})),o}function We(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null===t||void 0===t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}function Ke(e,t){var n;if(!e||!t)return null;var o=u(e);if(o==t.toUpperCase())return e;for(var i=e.ownerDocument.createElement(t),r=0;r<e.attributes.length;r++){var a=e.attributes[r];i.setAttribute(a.name,a.value)}return We(i,e),"P"!=o&&"P"!=u(i)||(n=(0,_.__read)(U(e,["margin-top","margin-bottom"]),2),i.style.marginTop=n[0],i.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(i,e),i}var Ge={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};function qe(e,t){var n=u(e);return Ge[n]||(t||{})[n]}function Ve(e){var t={};return((null===e||void 0===e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),o=e.slice(0,n),i=e.slice(n+1);o&&i&&(t[o.trim()]=i.trim())})),t}function Ze(e,t){if(e){var n=I(t||{}).map((function(e){var n=t[e],o=e?e.trim():null,i=n?n.trim():null;return o&&i?o+":"+i:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}var Ye=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n,o,i=t||{};if(e)try{for(var r=(0,_.__values)(I(e)),a=r.next();!a.done;a=r.next()){var s=a.value;i[s]=e[s]}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return i};function Xe(e,t){return Ye(e,t)}var $e=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/;var Je={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},Qe="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap,bgColor".split(","),et={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},tt=[];function nt(){return null}function ot(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}var it=function(){function e(e){e=e||{},this.elementCallbacks=Xe(e.elementCallbacks),this.styleCallbacks=function(e){var t=Xe(e);return t.position=t.position||nt,t.width=t.width||ot,t}(e.cssStyleCallbacks),this.attributeCallbacks=Xe(e.attributeCallbacks),this.tagReplacements=function(e){var t=(0,_.__assign)({},Je),n=e||{};return I(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t}(e.additionalTagReplacements),this.allowedAttributes=function(e){return(t=Qe.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t}(e.additionalAllowedAttributes),this.allowedCssClassesRegex=function(e){var t=tt.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null}(e.additionalAllowedCssClasses),this.defaultStyleValues=function(e){var t=Xe(et);return e&&Object.keys(e).forEach((function(n){var o=e[n];null!==o&&void 0!==o?t[n]=o:delete t[n]})),t}(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var i=new e(n=n||{}),r=o(n.currentElementOrStyle,"HTMLElement")?Ue(n.currentElementOrStyle):n.currentElementOrStyle;return i.exec(t,n.convertCssOnly,r)},e.prototype.exec=function(e,t,n){var o=(new DOMParser).parseFromString(e||"","text/html");return o&&o.body&&o.body.firstChild&&(this.convertGlobalCssToInlineCss(o),t||this.sanitize(o.body,n)),o&&o.body&&o.body.innerHTML||""},e.prototype.splitSelectors=function(e){return e.split(/(?![^(]*\)),/).map((function(e){return e.trim()}))},e.prototype.sanitize=function(e,t){if(!e)return"";t=Xe(t,Ue(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){var t,n,o=l(e.querySelectorAll("style")),i=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(o.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));try{for(var r=(0,_.__values)(i),a=r.next();!a.done;a=r.next())for(var s=a.value,c=function(t){var n,o,i=s.cssRules[t],r=i&&i.style?i.style.cssText:null;if(i.type!=CSSRule.STYLE_RULE||!r||!i.selectorText)return"continue";try{for(var a=(n=void 0,(0,_.__values)(d.splitSelectors(i.selectorText))),c=a.next();!c.done;c=a.next()){var u=c.value;if(u&&u.trim())l(e.querySelectorAll(u)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}}catch(p){n={error:p}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}},d=this,u=s.cssRules.length-1;u>=0;u--)c(u)}catch(p){t={error:p}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}o.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var o,i=e.nodeType,r=1==i,a=3==i,s=11==i,l=8==i,c=!1;if(r){var d=u(e),p=this.elementCallbacks[d],h=this.tagReplacements[d.toLowerCase()];void 0===h&&(h=this.unknownTagReplacement),p?c=p(e,n):d.indexOf(":")>0||d==h||"*"==h?c=!0:h&&/^[a-zA-Z][\w\-]*$/.test(h)&&(e=Ke(e,h),c=!0)}else if(a){var m=t["white-space"];c="pre"==m||"pre-line"==m||"pre-wrap"==m||!/^[\r\n]*$/g.test(e.nodeValue||"")}else c=!!s||!!l&&this.preserveHtmlComments;if(c)if(!a||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(r||s){var g=Xe(t),f=e;r&&(this.processAttributes(f,n),this.preprocessCss(f,g),this.processCss(f,g,n));for(var v=f.firstChild,b=void 0;v;v=b)b=v.nextSibling,this.processNode(v,g,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm,"\xa0").replace(/ {2}/g," \xa0");else null===(o=e.parentNode)||void 0===o||o.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=qe(e,this.additionalPredefinedCssForElement);n&&I(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var o=this,i=Ve(e);I(i).forEach((function(r){var a=i[r],s=o.styleCallbacks[r],l=void 0!=t[r],c=!0;c&&s&&(c=s(a,e,t,n)),c&&function(e){return 0==e.indexOf("var(")}(a)&&(c=!!(a=function(e){var t=$e.exec(e);return(null===t||void 0===t?void 0:t[2])||""}(a))),(c=c&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=r.substr(0,1)&&o.defaultStyleValues[r]!=a&&(l&&a!=t[r]||!l&&"initial"!=a&&"normal"!=a))&&l&&(t[r]=a),c?i[r]=a:delete i[r]})),Ze(e,i)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var o=e.attributes[n],i=o.name.toLowerCase().trim(),r=o.value,a=this.attributeCallbacks[i],s=a?a(r,e,t):this.allowedAttributes.indexOf(i)>=0||0==i.indexOf("data-")?r:null;"class"==i&&this.allowedCssClassesRegex&&(s=this.processCssClass(r,s)),null===s||void 0===s||s.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(i):o.value=s}},e.prototype.processCssClass=function(e,t){var n=this,o=e?e.split(" "):[],i=t?t.split(" "):[];return o.forEach((function(e){var t;(null===(t=n.allowedCssClassesRegex)||void 0===t?void 0:t.test(e))&&i.indexOf(e)<0&&i.push(e)})),(null===i||void 0===i?void 0:i.length)>0?i.join(" "):null},e}();const rt=it;function at(e,t){var n=e.fragment,o=new rt(e.sanitizingOption);o.convertGlobalCssToInlineCss(n),o.sanitize(n,t?Ue(t.element):void 0)}function st(e,t,n){return e?1:t?2:n?3:0}var lt=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,ct=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,dt=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,ut=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;function pt(e){var t;return(t=(e=(e||"").trim()).match(lt))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(ct))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(dt)||e.match(ut))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}var ht,mt="#ffffff",gt="#333333",ft="#000000",vt="transparent";!function(e){e[e.BRIGHT=0]="BRIGHT",e[e.DARK=1]="DARK",e[e.NONE=2]="NONE"}(ht||(ht={}));var bt=20,yt=80;function Ct(e,t,n,o,i,r){var a="string"===typeof t?t.trim():"",s="string"===typeof t?null:t,l=n?"background-color":"color";if(a||s){if(r){var c=r.registerColor((null===s||void 0===s?void 0:s.lightModeColor)||a,!!o,null===s||void 0===s?void 0:s.darkModeColor);e.style.setProperty(l,c)}n&&i&&function(e,t,n,o){if(!t||t===vt)return;switch(function(e){var t=function(e){var t=pt(e);if(t){var n=t[0]/255,o=t[1]/255,i=t[2]/255;return 50*(Math.max(n,o,i)+Math.min(n,o,i))}return 255}(e);if(t<bt)return 1;if(t>yt)return 0;return 2}(t)){case 1:Ct(e,{lightModeColor:mt,darkModeColor:gt},!1,n,!1,o);break;case 0:Ct(e,{lightModeColor:ft,darkModeColor:mt},!1,n,!1,o)}}(e,(null===s||void 0===s?void 0:s.lightModeColor)||a,o,r)}}function St(e,t,n,o){if(t){var i=e.style,r=t.fontFamily,a=t.fontSize,s=t.textColor,l=t.textColors,c=t.backgroundColor,d=t.backgroundColors,u=t.bold,p=t.italic,h=t.underline;r&&(i.fontFamily=r),a&&(i.fontSize=a),l?Ct(e,l,!1,n,!1,o):s&&Ct(e,s,!1,n,!1,o),d?Ct(e,d,!0,n,!1,o):c&&Ct(e,c,!0,n,!1,o),u&&(i.fontWeight="bold"),p&&(i.fontStyle="italic"),h&&(i.textDecoration="underline")}}var kt={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"};function Dt(e){return I(kt).reduce((function(t,n){return t[n]=e.queryCommandState(kt[n]),t}),{})}var xt=["IMG"],Tt=["TABLE","IMG","LI"].join(","),Et=/\u200b/g;function wt(e,t,n){if(!e)return!1;if(3==e.nodeType)return""==_t(e.nodeValue||"",t);if(1==e.nodeType){var o=e,i=_t(o.textContent||"",t),r=n?Tt+",BR":Tt;if(""!=i||xt.indexOf(u(o))>=0||o.querySelectorAll(r)[0])return!1}return!0}function _t(e,t){return e=e.replace(Et,""),t?e.trim():e}var It=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,Pt="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",At="(?:"+Pt+"\\.)*"+Pt+"(?:\\:[0-9]+)?"+"(?:[\\/\\?]\\S*)?",Rt={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+At+"|www\\."+At,"i"),except:It,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+At,"i"),except:It},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+At+"|ftp\\."+At,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+At,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+At,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+At,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+At,"i")}};function Lt(e){var t,n;if(e)try{for(var o=(0,_.__values)(I(Rt)),i=o.next();!i.done;i=o.next()){var r=i.value,a=Rt[r],s=e.match(a.match);if(s&&s[0]==e&&(!a.except||!a.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:a.normalizeUrl?a.normalizeUrl(e):e}}}catch(l){t={error:l}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null}function Nt(e,t,n,o,i){if(void 0===o&&(o=0),!e||!t)return[];var r=l(e.querySelectorAll(t));if(0!=o&&i){var a=i.startOffset,s=i.endOffset,c=i.startContainer,d=i.endContainer;if(1==c.nodeType&&c.firstChild){var u=c.childNodes[a];c=u||c.lastChild}d=1==d.nodeType&&d.firstChild&&s>0?d.childNodes[s-1]:d,r=r.filter((function(e){return function(e,t,n,o){var i=e.compareDocumentPosition(t),r=e.compareDocumentPosition(n),a=[0,8];o||a.push(16);return Mt(i,a)||Mt(r,a)||Mt(i,[2])&&Mt(r,[4])&&!Mt(r,[16])}(e,c,d,2==o)}))}return n&&r.forEach(n),r}function Mt(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}function Ot(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}function Bt(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,o=t.right,i=t.top,r=t.bottom;return 0===n&&0===o&&0===i&&0===r?null:{left:Math.round(n),right:Math.round(o),top:Math.round(i),bottom:Math.round(r)}}function Ft(e,t){void 0===t&&(t=[]);var n=e.map((function(e){return Bt(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),o={top:Math.max.apply(Math,(0,_.__spreadArray)([],(0,_.__read)(n.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,_.__spreadArray)([],(0,_.__read)(n.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,_.__spreadArray)([],(0,_.__read)(n.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,_.__spreadArray)([],(0,_.__read)(n.map((function(e){return e.right}))),!1))};return o.top<o.bottom&&o.left<o.right?o:null}function jt(e,t,n,o,i){return{type:1,isOptional:e,value:t,maxValue:o,minValue:n,allowNull:i}}function Ht(e,t,n){return{type:0,isOptional:e,value:t,allowNull:n}}function zt(e,t,n){return{type:2,isOptional:e,value:t,allowNull:n}}function Ut(e,t,n){return{type:4,isOptional:t,propertyDef:e,allowNull:n}}function Wt(e,t){var n,o,i=!1;if(t.isOptional&&"undefined"===typeof e||t.allowNull&&null===e)i=!0;else{if(!t.isOptional&&"undefined"===typeof e||!t.allowNull&&null===e)return!1;switch(t.type){case 2:i="string"===typeof e&&("undefined"===typeof t.value||e===t.value);break;case 1:i="number"===typeof e&&("undefined"===typeof t.value||(n=t.value,o=e,Math.abs(n-o)<.001))&&("undefined"===typeof t.minValue||e>=t.minValue)&&("undefined"===typeof t.maxValue||e<=t.maxValue);break;case 0:i="boolean"===typeof e&&("undefined"===typeof t.value||e===t.value);break;case 3:i=Array.isArray(e)&&("undefined"===typeof t.minLength||e.length>=t.minLength)&&("undefined"===typeof t.maxLength||e.length<=t.maxLength)&&e.every((function(e){return Wt(e,t.itemDef)}));break;case 4:i="object"===typeof e&&I(t.propertyDef).every((function(n){return Wt(e[n],t.propertyDef[n])}));break;case 5:i=t.validator(e)}}return i}var Kt="editingInfo";function Gt(e,t,n){var o,i=e.dataset[Kt];try{o=i?JSON.parse(i):null}catch(A){}if("undefined"!==typeof o){if(!t)return o;if(Wt(o,t))return o}return n||null}function qt(e,t,n){return!(n&&!Wt(t,n))&&(e.dataset[Kt]=JSON.stringify(t),!0)}function Vt(e,t){if(t){var n=Gt(e);n&&(delete n[t],e.dataset[Kt]=JSON.stringify(n))}else delete e.dataset[Kt]}var Zt=Ht(!0,void 0,!0),Yt=Ut({bgColorOverride:Zt,vAlignOverride:Zt,borderOverride:Zt},!1,!0);function Xt(e){return Gt(e,Yt)}function $t(e,t){e&&t&&qt(e,t,Yt)}var Jt="transparent",Qt="TD",en="TH";function tn(e,t,n,o){n&&(e.style.borderCollapse="collapse",function(e,t){e.forEach((function(n,o){n.forEach((function(i,r){i.td&&!function(e){var t;if(!e.td)return!1;return!!(null===(t=Xt(e.td))||void 0===t?void 0:t.borderOverride)}(i)&&function(e,t,n,o,i,r){switch(function(e,t){e.style.borderTop=on(t.topBorderColor),e.style.borderLeft=on(t.verticalBorderColor),e.style.borderRight=on(t.verticalBorderColor),e.style.borderBottom=on(t.bottomBorderColor)}(t,e),e.tableBorderFormat){case 0:return;case 1:i||(t.style.borderLeftColor=Jt),r||(t.style.borderRightColor=Jt);break;case 4:n||(t.style.borderTopColor=Jt),o||n||(t.style.borderBottomColor=Jt),i||(t.style.borderLeftColor=Jt),r||i||(t.style.borderRightColor=Jt),i&&n&&(t.style.borderRightColor=Jt);break;case 2:n&&(t.style.borderTopColor=Jt,t.style.borderRightColor=Jt,t.style.borderLeftColor=Jt),i&&(t.style.borderLeftColor=Jt),r&&(t.style.borderRightColor=Jt);break;case 3:i&&(t.style.borderLeftColor=Jt),r&&(t.style.borderRightColor=Jt);break;case 5:n&&(t.style.borderRightColor=Jt,t.style.borderLeftColor=Jt),i&&(t.style.borderBottomColor=Jt,t.style.borderTopColor=Jt),n&&i&&(t.style.borderLeftColor=e.verticalBorderColor||Jt,t.style.borderBottomColor=e.bottomBorderColor||Jt,t.style.borderTopColor=e.topBorderColor||Jt);break;case 6:n&&(t.style.borderRightColor=Jt,t.style.borderLeftColor=Jt),i&&(t.style.borderBottomColor=Jt,t.style.borderTopColor=Jt),n&&i&&(t.style.borderLeftColor=e.verticalBorderColor||Jt,t.style.borderBottomColor=e.bottomBorderColor||Jt,t.style.borderTopColor=e.topBorderColor||Jt),n||i||(t.style.borderLeftColor=Jt,t.style.borderBottomColor=Jt,t.style.borderTopColor=Jt,t.style.borderRightColor=Jt);break;case 7:n&&(t.style.borderLeftColor=Jt,t.style.borderTopColor=Jt,t.style.borderRightColor=Jt),i&&(t.style.borderLeftColor=Jt,t.style.borderTopColor=Jt,t.style.borderBottomColor=Jt),n||i||(t.style.borderLeftColor=Jt,t.style.borderBottomColor=Jt,t.style.borderTopColor=Jt,t.style.borderRightColor=Jt),n&&i&&(t.style.borderBottomColor=e.bottomBorderColor||Jt)}}(t,i.td,0===o,o===e.length-1,0===r,r===n.length-1)}))}))}(t,n),function(e,t,n){var o=function(e){return e%2===0?t.bgColorEven:t.bgColorOdd},i=t.hasBandedRows,r=t.hasBandedColumns,a=t.bgColorOdd,s=t.bgColorEven,l=!i&&a===s;e.forEach((function(e,r){e.forEach((function(e){if(e.td){if(!nn(e))if(i){var a=o(r);Ct(e.td,a||Jt,!0,void 0,!0,n)}else Ct(e.td,l&&t.bgColorOdd||Jt,!0,void 0,!0,n);t.verticalAlign&&!function(e){var t;if(!e.td)return!1;return!!(null===(t=Xt(e.td))||void 0===t?void 0:t.vAlignOverride)}(e)&&(e.td.style.verticalAlign=t.verticalAlign)}}))})),r&&e.forEach((function(e){e.forEach((function(e,t){var i=o(t);e.td&&i&&!nn(e)&&Ct(e.td,i,!0,void 0,!0,n)}))}))}(t,n,o),function(e,t){if(!t.hasFirstColumn)return void e.forEach((function(e){e.forEach((function(e,t){e.td&&0===t&&(e.td=Ke(e.td,Qt),e.td.scope="")}))}));e.forEach((function(t,n){t.forEach((function(t,o){t.td&&0===o&&(0===n||nn(t)||(t.td.style.borderTopColor=Jt,Ct(t.td,Jt,!0,void 0,!0)),n!==e.length-1&&0!==n&&(t.td.style.borderBottomColor=Jt),t.td=Ke(t.td,en),t.td.scope="col")}))}))}(t,n),function(e,t,n){var o,i;if(!t.hasHeaderRow)return void(null===(o=e[0])||void 0===o||o.forEach((function(e){e.td&&(e.td=Ke(e.td,Qt),e.td.scope="")})));null===(i=e[0])||void 0===i||i.forEach((function(e){e.td&&t.headerRowColor&&(nn(e)||Ct(e.td,t.headerRowColor,!0,void 0,!0,n),e.td.style.borderRightColor=t.headerRowColor,e.td.style.borderLeftColor=t.headerRowColor,e.td.style.borderTopColor=t.headerRowColor,e.td=Ke(e.td,en),e.td.scope="row")}))}(t,n,o))}function nn(e){var t;return!!e.td&&!!(null===(t=Xt(e.td))||void 0===t?void 0:t.bgColorOverride)}function on(e){return"solid 1px "+(e||"transparent")}var rn=zt(!1,void 0,!0),an=Ht(!1),sn=Ut({topBorderColor:rn,bottomBorderColor:rn,verticalBorderColor:rn,hasHeaderRow:an,headerRowColor:rn,hasFirstColumn:an,hasBandedColumns:an,hasBandedRows:an,bgColorEven:rn,bgColorOdd:rn,tableBorderFormat:jt(!1,void 0,0,8),keepCellShade:Ht(!0),verticalAlign:rn},!1,!0);function ln(e){return Gt(e,sn)}var cn={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1,verticalAlign:null},dn=function(){function e(e,t,n){var i=this;if(this.cells=null,this.formatInfo=null,this.trs=[],this.tableSelection=null,this.table=o(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var r=o(e,"HTMLTableElement")?null:e,a=l(this.table.rows);this.cells=a.map((function(e){return[]})),a.forEach((function(e,t){var n;i.trs[t%2]=e;for(var o=0,a=0;o<e.cells.length;o++){for(;i.cells[t][a];a++);var s=e.cells[o];s==r&&(i.col=a,i.row=t);for(var l=0;l<s.colSpan;l++,a++)for(var c=0;c<s.rowSpan;c++){var d=l+c==0,u=s.getBoundingClientRect();(null===(n=i.cells)||void 0===n?void 0:n[t+c])&&(i.cells[t+c][a]={td:d?s:null,spanLeft:l>0,spanAbove:c>0,width:d?u.width:void 0,height:d?u.height:void 0})}}for(var p=0;p<i.cells[t].length;p++)i.cells[t][p]||(i.cells[t][p]={td:null,spanLeft:!1,spanAbove:!1,width:void 0,height:void 0})})),this.formatInfo=ln(this.table),t&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n)}}return Object.defineProperty(e.prototype,"selection",{get:function(){return this.tableSelection||null},set:function(e){if(e){var t=e.firstCell;this.row=null===t||void 0===t?void 0:t.y,this.col=null===t||void 0===t?void 0:t.x}this.tableSelection=e},enumerable:!1,configurable:!0}),e.prototype.writeBack=function(e,t){var n,o,i,r=this;this.cells?(We(this.table),this.cells.forEach((function(e,t){var n=mn(r.trs[t%2]||r.trs[0]);n&&(r.table.appendChild(n),e.forEach((function(e,o){e.td&&(r.recalculateSpans(t,o),r.recalculateCellHeight(e.td),n.appendChild(e.td))})))})),this.formatInfo&&!e&&(o=this.table,i=this.formatInfo,o&&i&&qt(o,i,sn),tn(this.table,this.cells,this.formatInfo,t))):this.table&&(null===(n=this.table.parentNode)||void 0===n||n.removeChild(this.table))},e.prototype.recalculateCellHeight=function(e){if(this.isEmptyCell(e)&&e.rowSpan>1)for(var t=1;t<e.rowSpan;t++){var n=document.createElement("br");e.appendChild(n)}},e.prototype.applyFormat=function(e){this.table&&(this.formatInfo=(0,_.__assign)((0,_.__assign)((0,_.__assign)({},cn),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},e.prototype.deleteCellShadeDataset=function(e){null===e||void 0===e||e.forEach((function(e){e.forEach((function(e){e.td&&Vt(e.td,"bgColorOverride")}))}))},e.prototype.edit=function(e){var t,n,o=this;if(this.table&&this.cells&&void 0!==this.row&&void 0!=this.col){var i=this.cells[this.row],r=i[this.col],a=this.selection?this.selection.firstCell.y:this.row,s=this.selection?this.selection.lastCell.y:this.row,l=this.selection?this.selection.firstCell.x:this.col,c=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var d=a;d<=s;d++)this.cells.splice(a,0,i.map(hn));break;case 1:var u=function(e){var t=s+p.countSpanAbove(s,p.col);p.cells.splice(t,0,p.cells[t-1].map((function(e,n){var i=o.getCell(t,n);if(i.spanAbove)return hn(i);if(e.spanLeft){var r=hn(e);return r.spanAbove=!1,r}return{td:mn(o.getTd(o.row,n))}})))},p=this;for(d=a;d<=s;d++)u();break;case 2:var h=function(e){m.forEachCellOfCurrentColumn((function(t,n){n.splice(e,0,hn(t))}))},m=this;for(d=l;d<=c;d++)h(d);break;case 3:var g=function(e){var t=c+f.countSpanLeft(f.row,c);f.forEachCellOfColumn(t-1,(function(e,n,i){var r,a=o.getCell(i,t);a.spanLeft?r=hn(a):e.spanAbove?(r=hn(e)).spanLeft=!1:r={td:mn(o.getTd(i,o.col))},n.splice(t,0,r)}))},f=this;for(d=l;d<=c;d++)g();break;case 6:for(var v=function(e){b.forEachCellOfRow(e,(function(t,n){var i=o.getCell(e+1,n);t.td&&t.td.rowSpan>1&&i.spanAbove&&(i.td=t.td)}))},b=this,y=a;y<=s;y++)v(y);var C=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(a,C+1),0===this.cells.length&&(this.cells=null);break;case 5:for(var S=0,k=function(e){D.forEachCellOfColumn(e,(function(t,n,i){var r=o.getCell(i,e+1);t.td&&t.td.colSpan>1&&r.spanLeft&&(r.td=t.td);var a=o.selection?e-S:o.col;n.splice(a,1)})),S++},D=this,x=l;x<=c;x++)k(x);(0===(null===(t=this.cells)||void 0===t?void 0:t.length)||(null===(n=this.cells)||void 0===n?void 0:n.every((function(e){return 0===e.length}))))&&(this.cells=null);break;case 7:case 8:var T=7==e?-1:1;for(y=this.row+T;y>=0&&y<this.cells.length;y+=T){if((A=this.getCell(y,this.col)).td&&!A.spanAbove){var E=y<this.row?A:r,w=y<this.row?r:A;this.mergeCells(E,w);break}}break;case 9:case 10:var _=9==e?-1:1;for(x=this.col+_;x>=0&&x<this.cells[this.row].length;x+=_){if((A=this.getCell(this.row,x)).td&&!A.spanLeft){var I=x<this.col?A:r,P=x<this.col?r:A;this.mergeCells(I,P,!0);break}}break;case 11:for(x=l;x<=c;x++)for(y=a+1;y<=s;y++){var A=this.getCell(a,x),R=this.getCell(y,x);this.mergeCells(A,R)}for(x=l+1;x<=c;x++){A=this.getCell(a,l);var L=this.getCell(a,x);this.mergeCells(A,L,!0)}break;case 4:this.cells=null;break;case 13:if(r.td&&r.td.rowSpan>1)this.getCell(this.row+1,this.col).td=mn(r.td);else{var N=i.map((function(e){return{td:e==r?mn(e.td):null,spanAbove:e!=r,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,N)}break;case 12:r.td&&r.td.colSpan>1?this.getCell(this.row,this.col+1).td=mn(r.td):this.forEachCellOfCurrentColumn((function(e,t){t.splice(o.col+1,0,{td:t==i?mn(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=i})}));break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(a,s,l,c,"center");break;case 17:this.setAlignmentToSelectedCells(a,s,l,c,"left");break;case 19:this.setAlignmentToSelectedCells(a,s,l,c,"right");break;case 20:this.setAlignmentToSelectedCells(a,s,l,c,"top",!0);break;case 21:this.setAlignmentToSelectedCells(a,s,l,c,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(a,s,l,c,"bottom",!0)}}},e.prototype.setAlignmentToSelectedCells=function(e,t,n,o,i,r){for(var a,s,l=e;l<=t;l++)for(var c=n;c<=o;c++)if(this.cells){var d=this.cells[l][c].td;if(r&&d){null===(a=d.style)||void 0===a||a.setProperty("vertical-align",i);var u=Xt(d);$t(d,(0,_.__assign)((0,_.__assign)({},u),{vAlignOverride:!0}))}else d&&(null===(s=d.style)||void 0===s||s.setProperty("text-align",i))}},e.prototype.mergeCells=function(e,t,n){var o,i,r,a,s=n?(null===(o=e.td)||void 0===o?void 0:o.rowSpan)===(null===(i=t.td)||void 0===i?void 0:i.rowSpan)&&!e.spanLeft:(null===(r=e.td)||void 0===r?void 0:r.colSpan)===(null===(a=t.td)||void 0===a?void 0:a.colSpan)&&!e.spanAbove;e.td&&t.td&&s&&(this.mergeCellContents(e.td,t.td),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},e.prototype.isEmptyCell=function(e){return 1===e.childElementCount&&"BR"===u(e.firstChild)},e.prototype.mergeCellContents=function(e,t){if(this.isEmptyCell(t))We(e,t,!1);else{var n=document.createElement("br");e.appendChild(n),We(e,t,!0)}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],o=0;this.cells&&o<this.cells.length;o++)for(var i=0;i<this.cells[o].length;i++){var r=this.getCell(o,i);if(r.td){var a=Bt(r.td.getBoundingClientRect());if(a){var s=!1;if(t){if(a.right==e)s=!0,n.push(r.td);else if(s)break}else if(a.left==e)s=!0,n.push(r.td);else if(s)break}}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,o=t+1;this.cells&&o<this.cells[e].length;o++){var i=this.getCell(e,o);if(i.td||!i.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,o=e+1;this.cells&&o<this.cells.length;o++){var i=this.getCell(o,t);if(i.td||!i.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,o=void 0;o=t.cells[n];n++)o&&(o.innerHTML&&o.innerHTML.trim()||o.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(t=0;this.cells&&t<this.cells.length;t++)for(var o=0;o<this.cells[t].length;o++){var i=this.cells[t][o];if(i){var r="number"==typeof e?function(t){return t/e}:e,a=i.width||0,s=i.height||0;pn(i.td,(null===r||void 0===r?void 0:r(a))||a,(null===r||void 0===r?void 0:r(s))||s)}}},e.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();pn(this.table,(null===e||void 0===e?void 0:e(t.width))||t.width,(null===e||void 0===e?void 0:e(t.height))||t.height)},e}();const un=dn;function pn(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function hn(e){return{td:mn(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function mn(e){var t=e?e.cloneNode(!1):null;return o(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function gn(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,o=t.lastCell,i=e.cells.length-1,r=e.cells[i];if(!r)return!1;var a=r.length-1,s=n.x,l=n.y,c=o.x,d=o.y;return 0==s&&0==l&&c==a&&d==i}function fn(e){switch(u(e)){case"OL":return 1;case"UL":return 2;default:return 0}}function vn(e){return 0!=fn(e)}var bn;var yn=((bn={})[1]="disc",bn[3]="\u220e ",bn[2]="- ",bn[5]="\u2794 ",bn[8]="\u2794 ",bn[4]="\u27a2 ",bn[6]="\u27aa ",bn[7]="\u2014 ",bn);function Cn(e,t,n){void 0===n&&(n=!0);var i=function(e,t,n){var i,r,a=[],s=ge.createBodyTraverser(e),l=null,c=function(){var c=(null===(l=s.currentInlineElement)||void 0===l?void 0:l.getContainerNode())||null,d=null;c=c?C(c):null;for(var u=function(){var e=c;t.forEach((function(t){var o=n?e.style.getPropertyValue(t):e.getAttribute(t);d||(d={}),o&&!d[t]&&(d[t]=o)})),c=1===(null===(r=null===c||void 0===c?void 0:c.parentNode)||void 0===r?void 0:r.childNodes.length)?c.parentNode:null};c&&c!==e&&o(c,"HTMLElement")&&(0==a.length||((null===(i=c.textContent)||void 0===i?void 0:i.trim().length)||0)>0);)u();d&&a.push(d),s.getNextInlineElement()};for(;s.currentInlineElement!=l;)c();return a}(e,t,n);t.forEach((function(t){var o=i.map((function(e){return void 0!==e[t]?e[t]:""}));o&&(1==o.length||1==new Set(o).size)&&o[0]&&(n?e.style.setProperty(t,o[0]):e.setAttribute(t,o[0]))}))}var Sn={0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",10:"K",11:"L",12:"M",13:"N",14:"O",15:"P",16:"Q",17:"R",18:"S",19:"T",20:"U",21:"V",22:"W",23:"X",24:"Y",25:"Z"};function kn(e,t){for(var n="";e>=0;)n=Sn[e%26]+n,e=Math.floor(e/26)-1;return t?n.toLowerCase():n}var Dn,xn,Tn={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function En(e,t){var n,o,i="";try{for(var r=(0,_.__values)(I(Tn)),a=r.next();!a.done;a=r.next()){var s=a.value,l=Math.floor(e/Tn[s]);e-=l*Tn[s],i+=s.repeat(l)}}catch(c){n={error:c}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return t?i.toLocaleLowerCase():i}!function(e){e[e.Decimal=0]="Decimal",e[e.Roman=1]="Roman",e[e.Alpha=2]="Alpha"}(xn||(xn={}));var wn=((Dn={})[1]={markerType:xn.Decimal,markerSeparator:". "},Dn[2]={markerType:xn.Decimal,markerSeparator:"- "},Dn[3]={markerType:xn.Decimal,markerSeparator:") "},Dn[4]={markerType:xn.Decimal,markerSeparator:") ",markerSecondSeparator:"("},Dn[5]={markerType:xn.Alpha,markerSeparator:". ",lowerCase:!0},Dn[8]={markerType:xn.Alpha,markerSeparator:"- ",lowerCase:!0},Dn[6]={markerType:xn.Alpha,markerSeparator:") ",lowerCase:!0},Dn[7]={markerType:xn.Alpha,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},Dn[9]={markerType:xn.Alpha,markerSeparator:". "},Dn[12]={markerType:xn.Alpha,markerSeparator:"- "},Dn[10]={markerType:xn.Alpha,markerSeparator:") "},Dn[11]={markerType:xn.Alpha,markerSeparator:") ",markerSecondSeparator:"("},Dn[13]={markerType:xn.Roman,markerSeparator:". ",lowerCase:!0},Dn[16]={markerType:xn.Roman,markerSeparator:"- ",lowerCase:!0},Dn[14]={markerType:xn.Roman,markerSeparator:") ",lowerCase:!0},Dn[15]={markerType:xn.Roman,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},Dn[17]={markerType:xn.Roman,markerSeparator:". "},Dn[20]={markerType:xn.Roman,markerSeparator:"- "},Dn[18]={markerType:xn.Roman,markerSeparator:") "},Dn[19]={markerType:xn.Roman,markerSeparator:") ",markerSecondSeparator:"("},Dn),_n=[null,"lower-alpha","lower-roman"],In=["disc","circle","square"],Pn="-.25in",An=["font-size","font-family","color"],Rn=["data-ogsc","data-ogsb","data-ogac","data-ogab"],Ln=Ut({orderedStyleType:jt(!0,void 0,1,20),unorderedStyleType:jt(!0,void 0,1,9)},!0,!0),Nn=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=o(e,"HTMLLIElement")?e:M(e,4);var i=this.node.style.display;this.dummy="list-item"!=i&&""!=i,this.listTypes=(0,_.__spreadArray)([0],(0,_.__read)(t),!1)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return i(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null===e||void 0===e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;Bn((null===e||void 0===e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){if(this.node.style.marginLeft==Pn)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(e){void 0===e&&(e=!1);var t=e?2:1;this.listTypes.length>t&&this.listTypes.pop()},e.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft=Pn},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.applyListStyle=function(e,t){var n=Gt(e,Ln),o=this.listTypes.length<3;n&&(o&&2===this.listTypes[1]&&n.unorderedStyleType?function(e,t){var n=yn[t],o=1===t;e.style.listStyleType=o?n:'"'+n+'"'}(this.node,n.unorderedStyleType):o&&1===this.listTypes[1]&&n.orderedStyleType?function(e,t,n){var o=wn[t],i=o.markerSeparator,r=o.markerSecondSeparator,a=o.markerType,s=o.lowerCase,l=n.toString();a===xn.Roman?l=En(n,s):a===xn.Alpha&&(l=kn(n-1,s));var c=r?r+l+i:l+i;e.style.listStyleType='"'+c+'"'}(this.node,n.orderedStyleType,t):this.node.style.removeProperty("list-style-type"))},e.prototype.writeBack=function(e,t,n){var i,r=this;void 0===n&&(n=!1);var a=1;if(n){e.length>this.listTypes.length&&e.splice(this.listTypes.length);var s=e.length-1;s===this.listTypes.length-1&&fn(e[s])!==this.listTypes[s]&&e.splice(s),a=e.length}else for(;a<e.length;a++)if(fn(e[a])!==this.listTypes[a]){e.splice(a);break}for(;a<this.listTypes.length;a++){var c=e.length-1,d=On(e[0],this.listTypes[a],a,t);if(e[c].appendChild(d),e.push(d),this.getDeepChildIndex(t)==c){var p=null===(i=this.node.parentElement)||void 0===i?void 0:i.style.listStyleType;p&&u(this.node.parentElement)===u(d)&&(d.style.listStyleType=p)}}if(e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),this.listTypes.length>1&&(Cn(this.node,An,!0),Cn(this.node,Rn,!1)),this.listTypes.length<=1){var h="LI"==u(this.node),m=h?{"font-family":this.node.style.fontFamily,"font-size":this.node.style.fontSize,color:this.node.style.color}:void 0,g=h?function(e){var t=l(e.childNodes);return Ot(e),t}(this.node):[this.node];if(m)for(var f=function(e){o(g[e],"Text")&&(g[e]=M(g[e],"span"));var t=g[e];if(o(t,"HTMLElement")){var n=(0,_.__assign)((0,_.__assign)({},m),Ve(t));Ze(t,n),Rn.forEach((function(e){var n=r.node.getAttribute(e);n&&t.setAttribute(e,n)}))}},v=0;v<g.length;v++)f(v);Bn(g,!0,!0)}},e.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null===t||void 0===t?void 0:t.parentElement)||null;return n}return-1},e}();const Mn=Nn;function On(e,t,n,o){var r,a=e.ownerDocument;if(1==n&&o&&t==fn(o)?i(e,o)?(r=o.cloneNode(!1)).removeAttribute("id"):(We(o),r=o):r=a.createElement(1==t?"ol":"ul"),"0px"==(null===o||void 0===o?void 0:o.style.marginTop)&&"0px"==(null===o||void 0===o?void 0:o.style.marginBottom)&&(r.style.marginTop="0px",r.style.marginBottom="0px"),o&&1==n&&t!=fn(o)){var s=Gt(o,Ln);s&&qt(r,s,Ln)}return 1==t&&n>1&&r.style.setProperty("list-style-type",_n[(n-1)%_n.length]),2==t&&n>1&&r.style.setProperty("list-style-type",In[(n-1)%In.length]),r}function Bn(e,t,n){return!(e.length>0)||t&&m(e[0])||n&&m(e[e.length])||(e=[M(e)]),e}var Fn=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");Hn(this.rootList),Nt(this.rootList,"ol,ul",Hn),Nt(this.rootList,"li",zn),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(e,t){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var i,r=this.rootList.ownerDocument,a=[r.createDocumentFragment()],s=r.createTextNode(""),l=this.getStart()||1;this.rootList.parentNode.replaceChild(s,this.rootList),this.items.forEach((function(r){var s=r.getNewListStart();s&&s!=l&&(a.splice(1,a.length-1),l=s),r.writeBack(a,n.rootList,e);var c=a[1];r.applyListStyle(n.rootList,l),o(c,"HTMLOListElement")&&(i!=c&&(1==l?c.removeAttribute("start"):c.start=l),1!=r.getLevel()||r.isDummy()||t||l++),i=c})),s.parentNode.replaceChild(a[0],s)},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,o,i){var r=this;void 0===i&&(i=!1);var a=!1;if(this.findListItems(e,t,(function(e){a=a||0==r.items.indexOf(e),1==n?o&&!e.isDummy()?e.setIsDummy(!0):e.outdent(i):e.indent()})),a&&i)for(var s=0;s<this.items.length;s++)this.items[s].addNegativeMargins()},e.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,(function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t}))},e.prototype.removeMargins=function(){this.rootList.style.marginTop||this.rootList.style.marginBottom||(this.rootList.style.marginTop="0px",this.rootList.style.marginBottom="0px")},e.prototype.changeListType=function(e,t,n){var o=!1;this.findListItems(e,t,(function(e){o=o||e.getListType()!=n})),this.findListItems(e,t,(function(e){return o?e.changeListType(n):e.outdent()}))},e.prototype.setListStyleType=function(e,t){var n=function(e,t,n){return{orderedStyleType:Un(t,null===e||void 0===e?void 0:e.orderedStyleType,1),unorderedStyleType:Un(n,null===e||void 0===e?void 0:e.unorderedStyleType,1)}}(Gt(this.rootList,Ln),e,t);qt(this.rootList,n,Ln)},e.prototype.appendItem=function(e,t){var n=u(e);"DIV"==n?e=Ke(e,"LI"):"LI"!=n&&(e=M(e,"LI")),this.items.push(0==t?new Mn(e):new Mn(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var o=this.items[n];if(1!=o.getLevel()||o.isDummy()||t++,o.getNode()==e)return t}return-1},e.prototype.getStart=function(){return o(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var o=new S(this.items[0].getNode(),0),i=new S(this.items[this.items.length-1].getNode(),-1),r=o.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(i)?1:0);this.items.forEach((function(n,o){r=n.contains(e.node)?o:r,a=n.contains(t.node)?o:a})),r=a<this.items.length?Math.max(0,r):r,a=r>=0?Math.min(this.items.length-1,a):a;var s=r<=a?this.items.slice(r,a+1):[];return n&&s.forEach(n),s},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var o=fn(e);l(e.childNodes).forEach((function(e){var i=(0,_.__spreadArray)((0,_.__spreadArray)([],(0,_.__read)(t),!1),[o],!1);vn(e)?n.populateItems(e,i):3==e.nodeType&&""==(e.nodeValue||"").trim()||n.items.push(new(Mn.bind.apply(Mn,(0,_.__spreadArray)([void 0,e],(0,_.__read)(i),!1))))}))},e}();const jn=Fn;function Hn(e){var t=null;l(e.childNodes).forEach((function(e){"LI"==u(e)?t=e:vn(e)?t=null:t&&!wt(e,!0)&&t.appendChild(m(e)?e:M(e))}))}function zn(e){for(;!vn(e.parentNode);){a(e,!0);var t=l(e.parentNode.childNodes).slice(1);t.length>0&&(m(t[0])||(t=[M(t)]),t.forEach((function(t){return e.appendChild(t)}))),Ot(e.parentNode)}}function Un(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return void 0!==e}))[0]}function Wn(e,t,n){var o=e&&C(n,e.rootNode,t);if(o)for(var i=void 0;i=C(o.parentNode,e.rootNode,t);)o=i;return o}function Kn(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,o=e.rootNode,i=e.skipTags,r=t?Y(e.rootNode,t,e.skipTags):o.firstChild,a=n?X(o,n,i):o.lastChild,s=r&&a&&x(r,a);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return s;if(s){var l=S.getStart(s).normalize(),c=S.getEnd(s).normalize(),d=e.fullSelectionEnd,u=e.fullSelectionStart;if(!u.isAfter(c)&&!l.isAfter(d))return x(u.isAfter(l)?u:l,d.isAfter(c)?c:d)}return null}function Gn(e,t,n){var o=Kn(e),i=[];if(o){for(var r=e.rootNode,a=e.skipTags,s=ge.createSelectionTraverser(r,o,a),l=null===s||void 0===s?void 0:s.currentBlockElement;l;l=s.getNextBlockElement())i.push(l);i=i.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!V(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==i.length&&e&&!e.rootNode.firstChild&&t){var c=N(1,e.rootNode.ownerDocument);e.rootNode.appendChild(c),(l=F(e.rootNode,c))&&i.push(l)}return i}function qn(e,t){return!(!e||!i(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}var Vn="ol,ul";function Zn(e,t,n){if(!e)return null;var i=[];if(n){var r=Wn(e,Vn,n);r&&i.push(r)}else{if(Gn(e,void 0).forEach((function(n){var r=Wn(e,Vn,n.getStartNode());r?(i[i.length-1]!=r&&i.push(r),1==i.length&&o(r,"HTMLOListElement")&&r.start>1&&(t=!1)):i.push(n.collapseToSingleElement())})),0==i.length&&!e.rootNode.firstChild){var a=N(1,e.rootNode.ownerDocument);e.rootNode.appendChild(a),i.push(a),e.fullSelectionStart=new S(a,0),e.fullSelectionEnd=new S(a,-1)}t&&(Yn(e,i,!1),Yn(e,i,!0)),i=i.filter((function(e){return!V(e,!0)}))}var s=null;if(i.length>0){var c=i.shift()||null;(s=vn(c)?new jn(c):c?function(e){var t=l(e.childNodes),n=1==t.length?t[0]:M(t,"SPAN"),o=e.ownerDocument.createElement("ol");e.appendChild(o);var i=new jn(o);return i.appendItem(n,0),i}(c):null)&&i.forEach((function(e){vn(e)?s.mergeVList(new jn(e)):s.appendItem(e,0)}))}return s}function Yn(e,t,n){var i=t[n?t.length-1:0];i=Z(e.rootNode,i,n,e.skipTags,!0),qn(e,i=Wn(e,Vn,i))&&vn(i)&&(n?o(i,"HTMLOListElement")&&1!=i.start||t.push(i):t.unshift(i))}function Xn(e,t){Array.prototype.push.apply(e,t)}var $n="listchain",Jn="listchainafter",Qn=0;const eo=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,o){var i=Array.isArray(t)?t:t?[t]:[],a=[];return i.forEach((function(t){var i,s=[];Nt(t.rootNode,"ol",(function(a){var l=Wn(t,"ol",a);if(i!=l){var c=s.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(o||to)()),d=s.indexOf(c),u=!!n&&r(l,n);u?d<0&&s.push(c):(d>=0&&s.splice(d,1),s.unshift(c)),c.append(l,u),i=l}})),Xn(a,s)})),a},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e&&e.parentNode){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var o=new jn(n);return o.appendItem(e,0),o}return null},e.prototype.commit=function(e,t){for(var n=this.getLists(),o=0,i=0;i<n.length;i++){var r=n[i];t||(r.start>1?r.start=r.start===o?o+1:r.start:r.start=o+1);var a=new jn(r);o=a.getLastItemNumber()||0,delete r.dataset[$n],delete r.dataset[Jn],a.writeBack(e)}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new jn(e).getLastItemNumber()||0,t?e.dataset[Jn]="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset[$n]=this.name},e.prototype.getLists=function(){var e=this;return Nt(this.region.rootNode,"ol[data-"+$n+"="+this.name+"]").filter((function(t){return qn(e.region,t)}))},e}();function to(){return"__List_Chain_"+Qn++}var no,oo=((no={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},no);function io(e,t,n){var o=[];if(e&&t){var r=oo[n],a=r.innerSelector,s=r.skipTags,l=function(e,t,n){var o=[{innerNode:e,children:[]}],r=oo[n],a=r.outerSelector,s=r.innerSelector,l=Nt(e,a,null,2,t);return Nt(e,s,(function(t){var n=C(t,e,a);if(n&&l.indexOf(n)<0){for(var r={innerNode:t,children:[]},s=o.length-1;s>=0;s--){var c=o[s],d=c.innerNode,u=c.children;if(i(d,n)){var p=u.filter((function(e){return e.outerNode==n}))[0];p||(p={outerNode:n,boundaries:[]},u.push(p)),p.boundaries.push(r);break}}o.push(r)}}),1,t),o[0]}(e,t,n),c=C(t.startContainer,e,a)||e,d=C(t.endContainer,e,a)||e,u=function(e,t){var n=S.getStart(e).normalize(),o=S.getEnd(e).normalize();return function(e,r,a){return function(e,t,n,o){if(e){var r=t&&Y(e,t,o),a=n&&X(e,n,o),s=!t||i(e,t)&&i(e,r),l=!n||i(e,n)&&i(e,a),c=!t||!n||!i(t,n,!0)&&!i(t,a,!0)&&!i(n,t,!0)&&!i(n,r,!0);return s&&l&&c}return!1}(e,r,a,t)?{rootNode:e,nodeBefore:r,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:o}:null}}(t,s);o=(0,_.__read)(ro(u,l,c,d),1)[0]}return o.filter((function(e){return!!e}))}function ro(e,t,n,o,i){var r;i=i||t.innerNode==n;var a=!1,s=t.children,l=t.innerNode,c=[];if(0==s.length)(u=e(l))&&c.push(u);else for(var d=0;d<=s.length&&!a;d++){var u,p=s[d]||{},h=p.outerNode,m=p.boundaries,g=null===(r=s[d-1])||void 0===r?void 0:r.outerNode;if(i)(u=e(l,g,h))&&c.push(u);null===m||void 0===m||m.forEach((function(t){var r,s;s=(r=(0,_.__read)(ro(e,t,n,o,i),3))[0],i=r[1],a=r[2],c=c.concat(s)}))}return[c,i,a||l==o]}function ao(e,t){if(!t||0==t.length)return[];var n=o(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],i=(n=n&&n.filter((function(t){return qn(e,t)})))[0],r=n[n.length-1];return qn(e,i)&&qn(e,r)?c(e.rootNode,i,r,!0):[]}function so(e){var t;if(!e)return null;var n=x(e),o=n.getBoundingClientRect&&Bt(n.getBoundingClientRect());if(o)return o;e=e.normalize();var i=n.getClientRects&&n.getClientRects();if(o=i&&1==i.length?Bt(i[0]):null)return o;if(3==e.node.nodeType&&e.node.ownerDocument){var r=N({tag:"span",children:["\u200b"]},e.node.ownerDocument);if((n=x(e)).insertNode(r),o=r.getBoundingClientRect&&Bt(r.getBoundingClientRect()),null===(t=r.parentNode)||void 0===t||t.removeChild(r),o)return o}var a=e.element;return a&&a.getBoundingClientRect&&(o=Bt(a.getBoundingClientRect()))?o:null}function lo(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&i(t,n)&&co(n);)n=(null===n||void 0===n?void 0:n.parentNode)||null;return n==t}}return!1}function co(e){for(;e.previousSibling;)if("BR"==u(e=e.previousSibling)||!wt(e))return!1;return!0}function uo(e,t){return t?{start:po(S.getStart(t),e),end:po(S.getEnd(t),e)}:null}function po(e,t){var n,o;if(!e||!t)return[];var r,a=e.node,s=e.offset,l=[];if(!i(t,a,!0))return[];if(3==a.nodeType){for(r=a.parentNode;a.previousSibling&&3==a.previousSibling.nodeType;)s+=(null===(n=a.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,a=a.previousSibling;l.unshift(s)}else r=a,a=a.childNodes[s];do{s=0;for(var c=!1,d=(null===r||void 0===r?void 0:r.firstChild)||null;d&&d!=a;d=d.nextSibling){if(3==d.nodeType){if(0===(null===(o=d.nodeValue)||void 0===o?void 0:o.length)||c)continue;c=!0}else c=!1;s++}l.unshift(s),a=r,r=(null===r||void 0===r?void 0:r.parentNode)||null}while(a&&a!=t);return l}function ho(e,t){if(!e)return"";var n=function(e){if(o(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}(e),i=t&&uo(e,t);return i?n+"\x3c!--"+JSON.stringify(i)+"--\x3e":n}var mo,go,fo,vo,bo,yo=(mo=jt(),{type:3,isOptional:go,itemDef:mo,minLength:fo,maxLength:vo,allowNull:bo}),Co=Ut({x:jt(),y:jt()}),So=Ht(!0),ko=Ut({type:jt(!0,0),isDarkMode:So,start:yo,end:yo}),Do=Ut({type:jt(!1,1),isDarkMode:So,tableId:zt(),firstCell:Co,lastCell:Co}),xo=Ut({type:jt(!1,2),isDarkMode:So,imageId:zt()});function To(e,t,n){if(e)return t=t||"",e.innerHTML=(null===n||void 0===n?void 0:n(t))||t,Eo(e)}function Eo(e){var t=e.lastChild;if(o(t,"Comment"))try{var n=JSON.parse(t.nodeValue||"");if(Wt(n,ko)||Wt(n,Do)||Wt(n,xo))return e.removeChild(t),n.type="undefined"===typeof n.type?0:n.type,n.isDarkMode=n.isDarkMode||!1,n}catch(A){}}function wo(e,t){var n,o,i,r=null===(i=null===(o=null===(n=null===e||void 0===e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===i?void 0:i.getSelection();if(r){var a=!0;if(r.rangeCount>0)try{var s=null;(t||R.isEdge)&&(s=1==r.rangeCount?r.getRangeAt(0):null)&&s.startContainer==e.startContainer&&s.startOffset==e.startOffset&&s.endContainer==e.endContainer&&s.endOffset==e.endOffset?a=!1:r.removeAllRanges()}catch(l){}a&&r.addRange(e)}}function _o(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}function Io(e,t){if(t=t||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},_o(e,1)){for(var n=0,o=e.currentIndex+1;o<e.snapshots.length;o++)n+=t(e.snapshots[o]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}function Po(e){Io(e,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}))}function Ao(e,t,n){!function(e,t,n,o,i){o=o||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},i=i||Lo;var r=e.snapshots[e.currentIndex],a=r&&i(r,t);if(e.currentIndex<0||!r||!a){Io(e,o),e.snapshots.push(t),e.currentIndex++,e.totalSize+=o(t);for(var s=0;s<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=o(e.snapshots[s]),s++;s>0&&(e.snapshots.splice(0,s),e.currentIndex-=s,e.autoCompleteIndex-=s),n&&(e.autoCompleteIndex=e.currentIndex)}else a&&e.snapshots.splice(e.currentIndex,1,t)}(e,t,n,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}),Ro)}function Ro(e,t){return e.html==t.html&&!e.entityStates&&!t.entityStates}function Lo(e,t){return e==t}function No(e,t){return _o(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}function Mo(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}function Oo(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}function Bo(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}}function Fo(e,t,n){if(e[t]){var o=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.apply(void 0,(0,_.__spreadArray)([],(0,_.__read)(e),!1)),n.apply(void 0,(0,_.__spreadArray)([],(0,_.__read)(e),!1))}}else e[t]=n}var jo="contenteditable";function Ho(e,t,n,o){e&&(e.className="_Entity _EType_"+t+" "+(o?"_EId_"+o+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute(jo)&&e.removeAttribute(jo))}function zo(e){var t,n=!1,o="",i="",r=!1;return null===(t=null===e||void 0===e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?o=e.substr(7):0==e.indexOf("_EId_")?i=e.substr(5):0==e.indexOf("_EReadonly_")&&(r="1"==e.substr(11))})),n?{wrapper:e,id:i,type:o,isReadonly:r}:null}function Uo(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}function Wo(e,t){for(var n=Uo(),i=e.ownerDocument.createDocumentFragment(),r=null,a=function(e){var a,s=e;r=e.nextSibling,o(e,"HTMLElement")&&((a=zo(e))?s=Vo(a,t):e.querySelectorAll(n).forEach((function(e){var n;if(a=zo(e)){var o=Vo(a,t);null===(n=e.parentNode)||void 0===n||n.replaceChild(o,e)}}))),i.appendChild(s)},s=e.firstChild;s;s=r)a(s);return i.normalize(),i}function Ko(e,t,n,i){for(var r=t.firstChild,a=Uo(),s=e.firstChild;s;){var l=s.nextSibling,c=qo(n,s);if(c)(r=Go(r,c))?r=r.nextSibling:t.appendChild(c);else{var d=i?s.cloneNode(!0):s;t.insertBefore(d,r),o(d,"HTMLElement")&&d.querySelectorAll(a).forEach((function(e){var t,o=qo(n,e);o&&(null===(t=e.parentNode)||void 0===t||t.replaceChild(o,e))}))}s=l}Go(r)}function Go(e,t){for(var n;e&&(!t||e!=t);){var o=e;e=e.nextSibling,null===(n=o.parentNode)||void 0===n||n.removeChild(o)}return e}function qo(e,t){var n,i=o(t,"HTMLElement")&&t.classList.contains("_Entity")&&(null===(n=zo(t))||void 0===n?void 0:n.id),r=i?null===e||void 0===e?void 0:e[i]:null;return r?o(r,"HTMLElement")?r:(null===r||void 0===r?void 0:r.canPersist)?r.element:null:null}function Vo(e,t){return t[e.id]=e.wrapper,e.wrapper.cloneNode(!0)}function Zo(e,t,n){var o=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=o),o}function Yo(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}var Xo="Control",$o="Alt",Jo="Meta";function Qo(e){var t=e.ctrlKey||e.key===Xo,n=e.altKey||e.key===$o,o=e.metaKey||e.key===Jo;return t||n||o}function ei(e){return!Qo(e)&&!!e.key&&1==e.key.length}var ti=R.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};function ni(e){return ti(e)}function oi(e,t){var n=Ve(e),o=0;t.forEach((function(e){var t;if((null===(t=n[e])||void 0===t?void 0:t.indexOf("!important"))>-1){var i=n[e].indexOf("!");n[e]=n[e].substring(0,i),o++}})),o>0&&Ze(e,n)}function ii(e,t,n){var o;if(t){var i=e.getElementById(n);i||((i=e.createElement("style")).id=n,e.head.appendChild(i)),null===(o=i.sheet)||void 0===o||o.insertRule(t)}}function ri(e,t){var n,o=e.getElementById(t);o&&(null===(n=o.parentNode)||void 0===n||n.removeChild(o))}function ai(e,t){var n=t.getAttribute("style");if(n){e.setAttribute("style",n);var o=Xt(t);o&&$t(e,(0,_.__assign)({},o))}}var si="[contenteditable=false]",li=[function(e,t,n,o){var r,a,l=F(e,n.node);if(l){var c=Nt(e,"a[href]",null,1,x(n)).filter((function(e){return l.contains(e)}))[0];if(c&&wt(c)&&(n=new S(c,-2),di(c),c=null),c&&(null===(r=t)||void 0===r?void 0:r.querySelector)&&(null===(a=t)||void 0===a?void 0:a.querySelector("a[href]"))){var d=n.normalize(),u=d.node.parentNode,p=3==d.node.nodeType?z(d.node,d.offset,!1):d.isAtEnd?d.node.nextSibling:d.node,h=e.ownerDocument.createTextNode("");for(u.insertBefore(h,p);h&&i(c,h);)h=s(h);h&&(n=new S(h,-2),di(h))}}return n},function(e,t,n,o){var i=t,r=!1;if(11==i.nodeType){r=!0;var a=l(i.childNodes).filter((function(e){return"BR"!=u(e)}));i=1==a.length?a[0]:null}var s=u(i),c=s&&i&&"BR"==u(i.nextSibling),d=C(n.node,e,"LI"),p=d&&C(d,e,"OL,UL"),h=C(n.node,e,"TD,TH");"LI"==s&&(i=M(i,s=p?u(p):"UL"));if(("OL"==s||"UL"==s)&&i&&"LI"==u(i.firstChild)){var m=!i.firstChild.nextSibling&&!c;c&&i.parentNode&&di(i.nextSibling),m?(Ot(i.firstChild),Ot(i)):u(p)==s&&(Ot(i),n=new S(d,lo(n,d)?-2:-3))}r&&"TABLE"==s&&h&&(!function(e,t,n,o){var i,r,a,s,l=new un(t),c=new un(e),d=c.row,u=c.col,p=null!==(r=d+(null===(i=l.cells)||void 0===i?void 0:i.length))&&void 0!==r?r:0,h=null!==(s=u+(null===(a=l.cells)||void 0===a?void 0:a[0].length))&&void 0!==s?s:0;for(c.row=c.cells.length-1;c.cells.length<p;)c.edit(1);for(c.col=c.cells[0].length-1;c.cells[0].length<h;)c.edit(3);for(var m=d;m<p;m++)for(var g=u;g<h;g++){var f=c.getCell(m,g),v=l.getTd(m-d,g-u);f.td&&v?(We(f.td,v),ai(f.td,v)):f.td=document.createElement("td")}c.writeBack()}(h,i),n=new S(i,0),We(t));return n},function(e,t,n,o){if("P"==u(n.node)){var i=n.normalize(),r=Ke(n.node,"div");i.node!=r&&(n=i)}return n},function(e,t,n,o){b(n.node)&&(n=new S(n.node,n.isAtEnd?-3:-2));return n},function(e,t,n,o){if(o&&o.collapsed){var i=new ve(e,S.getStart(o)),r=i.getInlineElementBefore(),a=i.getInlineElementAfter();r instanceof ne?n=new S(r.getContainerNode(),-3):a instanceof ne&&(n=new S(a.getContainerNode(),-2))}return n},function e(t,n,o,i){var r;if(!(null===(r=o.element)||void 0===r?void 0:r.isContentEditable)){for(var a=void 0,s=C(o.node,t,si);s;)s=(null===(a=s)||void 0===a?void 0:a.parentElement)?C(a.parentElement,t,si):null;if(a)return o=new S(a,-3),e(t,n,o,i)}return o},function(e,t,n,o){if(1==t.childNodes.length&&"TABLE"==u(t.childNodes[0])||"TABLE"==u(t)){var i=n.element,r=x(new S(i,-2),n),a=ge.createSelectionTraverser(e,r),s=a&&a.currentBlockElement;if(s){for(var l=s;!l;)(l=a.getNextBlockElement())&&(s=l);var c=null===s||void 0===s?void 0:s.getEndNode();if(c&&C(c,e,"TABLE")){var d=x(n);d.collapse(!1);var p=e.ownerDocument.createElement("br");d.insertNode(p),d=x(p),n=S.getEnd(d)}}}return n}];function ci(e,t,n,o){return li.forEach((function(i){n=i(e,t,n,o)})),n}function di(e){var t;null===(t=null===e||void 0===e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}function ui(e,t){var n=null,r=Nt(e,"table,tr",null,2,t),a=io(e,t,0).map((function(e){var t=Kn(e);if(!t)return null;var i=t.startContainer,a=t.endContainer,s=t.startOffset,l=t.endOffset,c=t.commonAncestorContainer;if(o(c,"HTMLElement")&&!c.isContentEditable)return null;var d=(0,_.__read)(pi(a,l,!1),2),u=d[0],p=d[1],h=(0,_.__read)(pi(i,s,!0),2),m=h[0],g=h[1];n=n||m;var f=ao(e,[g,u]);return Xn(r,f),{region:e,beforeStart:m,afterEnd:p}})).filter((function(e){return!!e}));return r.forEach((function(e){var t;return(null===(t=e.parentElement)||void 0===t?void 0:t.isContentEditable)&&e.parentElement.removeChild(e)})),a.forEach((function(e){e&&function(e,t,n){var r,a,s,l;if(qn(e,t)&&qn(e,n)&&(l=F(e.rootNode,n))&&!l.contains(t)){for(var c=l.collapseToSingleElement(),u=d(e.rootNode,c,t,!1,!0),p=c;i(u,p);){var h=p.parentNode;o(h,"HTMLElement")&&Ze(c,(0,_.__assign)((0,_.__assign)((0,_.__assign)({},qe(h)||{}),Ve(h)),Ve(c))),p=h}var m=null,g=1==c.childNodes.length&&0==c.attributes.length?c.firstChild:Ke(c,"SPAN");for(p=g;i(u,p)&&1==(null===(r=p.parentNode)||void 0===r?void 0:r.childNodes.length);p=p.parentNode)m=p.parentNode;null===(a=t.parentNode)||void 0===a||a.insertBefore(g,t.nextSibling),null===(s=null===m||void 0===m?void 0:m.parentNode)||void 0===s||s.removeChild(m)}}(e.region,e.beforeStart,e.afterEnd)})),n&&new S(n,-1)}function pi(e,t,n){var i,r;if(o(e,"Text")){var a=z(e,t,n);return n?[a,e]:[e,a]}var s=e.childNodes[t-1],l=e.childNodes[t];if(s||l||(n?s=(l=e).previousSibling:l=(s=e).nextSibling),(s||l)&&(!s||!l)){var c=e.ownerDocument.createTextNode("");null===(r=null===(i=s||l)||void 0===i?void 0:i.parentNode)||void 0===r||r.insertBefore(c,l),s?l=c:s=c}return[s,l]}function hi(e){for(var t=ge.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}var mi='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,'+["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return'table div[class^="'+e+'"]'})).join(",");var gi="ProgId",fi="xmlns:x";const vi=function(e){var t,n=e.shouldConvertSingleImage,o=e.clipboardData;return n&&1==(null===(t=o.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==o.htmlFirstLevelChildTags[0]};var bi=new Map([[0,function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[gi]}],[1,function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[fi]}],[2,function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[gi]&&void 0==t[fi]}],[3,function(e){return"PowerPoint.Slide"==e.htmlAttributes[gi]}],[5,function(e){return!!e.fragment.querySelector(mi)}],[4,function(e){return!!e.fragment.querySelector("google-sheets-html-origin")}],[7,vi]]);function yi(e,t){var n=e.htmlAttributes,o=e.clipboardData,i=e.fragment,r=null,a={htmlAttributes:n,fragment:i,shouldConvertSingleImage:t,clipboardData:o};return bi.forEach((function(e,t){!r&&e(a)&&(r=t)})),null!==r&&void 0!==r?r:6}},59479:(e,t,n)=>{"use strict";n.d(t,{KH:()=>tt,tz:()=>ot,pK:()=>st,mk:()=>fo,nz:()=>ri,KS:()=>yt,a1:()=>un,Ny:()=>hn,sL:()=>pn});var o=n(6326),i=n(59935),r=n(38831),a=/[.+=\s:;"',>]+$/i,s=5;function l(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?(0,r.$F)(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data||null,o=(0,r.aN)(((null===n||void 0===n?void 0:n.text)||"").trim()),i=t.getContentSearcherOfCursor(e);if(o&&(null===i||void 0===i?void 0:i.getRangeFromText(o.originalUrl,!1)))return o;var l=i&&i.getWordBefore();if(l&&l.length>s){var c=(l.match(a)||[])[0]||"",d=l.substring(0,l.length-c.length);return["()","{}","[]"].forEach((function(e){d[d.length-1]==e[1]&&d.indexOf(e[0])<0&&(d=d.substr(0,d.length-1))})),(0,r.aN)(d)}return null})):null}var c={autoLink:{keys:[13,32,257],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t);if(!n)return;var o=t.getDocument().createElement("a"),a=t.getContentSearcherOfCursor();o.textContent=n.originalUrl,o.href=n.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return(0,i.vQ)(t,n.originalUrl,o,!1,null!==a&&void 0!==a?a:void 0),(0,r.gn)(e),o}),"AutoLink",!0)}))}},unlinkWhenBackspaceAfterLink:{keys:[8],shouldHandleEvent:function(e,t){var n=t.getContentSearcherOfCursor(e);return(null===n||void 0===n?void 0:n.getInlineElementBefore())instanceof r.wF},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,i.vL)(t)},defaultDisabled:!0}};function d(e,t){return(0,r.$F)(e,"CODE_CHILD",(function(){var e,n=null!==(e=t.getElementAtCursor("code"))&&void 0!==e?e:t.queryElements("code",1)[0];if(n){var o=t.getFocusedPosition(),i=o&&t.getBlockElementAtNode(o.normalize().node);if(i){var a=i.getStartNode()==n.parentNode?i.getStartNode():i.collapseToSingleElement();return(0,r.Op)(a)?a:null}}return null}))}function u(e,t){var n=d(e,t);if((0,r.CP)(n,"HTMLElement")){var o=n.querySelector("code");if(o)(0,r.oA)(o);else{var i=(0,r.KC)(n);if(i&&(0,r.oA)(i),(0,r.CP)(n.parentElement,"HTMLPreElement")){var a=(0,r.KC)(n);a&&(0,r.oA)(a)}}t.select(n,0)}}var p={removeCodeWhenEnterOnEmptyLine:{keys:[13],shouldHandleEvent:function(e,t){var n=d(e,t);return n&&(0,r.Op)(n)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){u(e,t)}),void 0,!0)}},removeCodeWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){var n=d(e,t);return n&&(0,r.Op)(n)&&!n.previousSibling},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){return u(e,t)}))}}},h={noCycleCursorMove:{keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var o,i=null;if(!n||!(i=t.getSelectionRange())||!i.collapsed||!(o=r.yX.getStart(i))||!t.isPositionAtBeginning(o))return!1;var a="rtl"==(0,r.L9)(o.element,"direction"),s=e.rawEvent;return!a&&37==s.which||a&&39==s.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Pw.isChrome}};function m(e,t,n){var o=(0,r.$F)(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,o=n&&t.getElementAtCursor((0,r.hm)(),n);return o&&!o.isContentEditable?o:null}));if(o&&void 0!==n){var i=(0,r.qe)(o);i&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:i})}return o}var g={keys:[13],shouldHandleEvent:function(e,t){return f(e,t,!0,!1)},handleEvent:function(e,t){var n,o,i;e.rawEvent.preventDefault();var a=t.getSelectionRange();if(a){var s=r.yX.getEnd(a).normalize().node,l=t.getDocument().createElement("BR");null===(n=s.parentNode)||void 0===n||n.insertBefore(l,s.nextSibling);var c,d=t.getBlockElementAtNode(s);d&&(c=d.collapseToSingleElement(),null===(o=l.parentNode)||void 0===o||o.removeChild(l)),null===(i=t.getSelectionRange())||void 0===i||i.deleteContents(),(null===c||void 0===c?void 0:c.nextSibling)&&t.select(c.nextSibling,0)}}};function f(e,t,n,o,i){var a=(0,r.$F)(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+o,(function(){var e,i=t.getSelectionRange();if(!i||o&&!i.collapsed)return null;var a=null===(e=t.getSelectedRegions()[0])||void 0===e?void 0:e.rootNode;i.commonAncestorContainer.normalize();var s=r.yX.getEnd(i).normalize(),l=null;if((0==s.offset||s.isAtEnd)&&a){var c=r.wI.createBodyTraverser(a,s.node),d=n?0==s.offset?c.currentInlineElement:c.getNextInlineElement():s.isAtEnd?c.currentInlineElement:c.getPreviousInlineElement(),u=d&&d.getContainerNode();if(!o){var p=t.getBlockElementAtNode(s.node);(!p||u&&!p.contains(u))&&(u=null)}l=u&&t.getElementAtCursor((0,r.hm)(),u)}return l}));if(a&&void 0!==i){var s=(0,r.qe)(a);s&&k(s,t,i,e)}return a}var v={keys:[39,37],allowFunctionKeys:!0,shouldHandleEvent:function(e,t){if(e.rawEvent.altKey)return!1;var n=t.getElementAtCursor();return!!n&&b(e,t,"rtl"===(0,r.L9)(n,"direction")==(37===e.rawEvent.which))},handleEvent:function(e,t){var n=D(e),o=C(e,n);if(o){var i=x(o,n,t),a=i.delimiterPair,s=i.entity;a&&s&&(0,r.B5)(s,(0,r.hm)())&&(e.rawEvent.preventDefault(),t.runAsync((function(){var o=n?e.rawEvent.shiftKey?-3:-1:-2,i=new r.yX(a,o);if(e.rawEvent.shiftKey){var s=a.ownerDocument.getSelection();null===s||void 0===s||s.extend(i.node,i.offset)}else t.select(i)})))}}};function b(e,t,n){var o,i=null===(o=t.getFocusedPosition())||void 0===o?void 0:o.normalize();if(D(e,n),!i)return!1;var r=3==i.node.nodeType?i.node:i.node==i.element?i.element.childNodes.item(i.offset):i.element,a=n?{class:"entityDelimiterBefore",pairClass:"entityDelimiterAfter",isAtEndOrBeginning:i.isAtEnd}:{class:"entityDelimiterAfter",pairClass:"entityDelimiterBefore",isAtEndOrBeginning:0==i.offset},s=function(e,t,n){var o=y(e,t);if(!o)return;var i=function(e){return n?e.getNextInlineElement():e.getPreviousInlineElement()},r=o.currentInlineElement;for(;r&&r.getContainerNode()===t;)r=i(o);return null===r||void 0===r?void 0:r.getContainerNode()}(t,r,n);if(a.isAtEndOrBeginning&&s){var l=t.getElementAtCursor("."+a.class,s);if(l&&c(l))return!0}return!!c(r&&t.getElementAtCursor("."+a.class,r));function c(o){if(!o)return!1;var i=x(o,n,t).delimiterPair;return i&&(i.className||"").indexOf(a.pairClass)>-1&&C(e,n,o)}}function y(e,t){var n;if(t){var o=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();if(o&&(0,r.mt)(o))return r.wI.createBodyTraverser(o,t)}}function C(e,t,n){return(0,r.$F)(e,"delimiter_cache_key_"+t,(function(){return n}))}function S(e,t,n,o,i){var a=(0,r.$F)(e,"entity_delimiter_cache_key_"+n,(function(){return o&&t.getElementAtCursor((0,r.hm)(),o)}));if(a&&void 0!==i){var s=(0,r.qe)(a);s&&k(s,t,i,e)}return a}function k(e,t,n,i){var a=e.wrapper,s=a.nextElementSibling,l=a.previousElementSibling;t.triggerPluginEvent(15,{operation:n,rawEvent:i.rawEvent,entity:e}),e.isReadonly&&!(0,r.mt)(e.wrapper)&&(i.rawEvent.defaultPrevented?t.runAsync((function(){if(t.contains(e.wrapper)){var n=(0,o.__read)((0,r.u$)(e.wrapper),1)[0];n&&t.select(n,-3)}else!function(e,t){[e,t].forEach((function(e){var t;(0,r.Ub)(e)&&(null===(t=null===e||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(e))}))}(s,l)})):(0,r.Ub)(s)&&(0,r.Ub)(l)&&t.select((0,r.Sd)(l,s)))}function D(e,t){return!!(0,r.$F)(e,"Check_Before",(function(){return t}))}function x(e,t,n){var o=null,i=null,a=y(n,e);if(!a)return{delimiterPair:i,entity:o};for(var s,l="."+(t?"entityDelimiterAfter":"entityDelimiterBefore"),c=function(e,t){var o,i=null===e||void 0===e?void 0:e.getContainerNode();return null!==(o=i&&n.getElementAtCursor(t,i))&&void 0!==o?o:null},d=(0,r.hm)(),u=a.currentInlineElement;u&&(!o||!i);){if(o=o||c(u,d),i=i||c(u,l),o){if(!i&&!c(u,d)){i=null;break}i&&!i.isContentEditable&&(i=null)}s=a,u=t?s.getNextInlineElement():s.getPreviousInlineElement()}return{entity:o,delimiterPair:i}}var T={clickOnEntity:{keys:[13],shouldHandleEvent:function(e,t){return m(e,t)},handleEvent:function(e,t){m(e,t,1)}},escapeFromEntity:{keys:[27],shouldHandleEvent:function(e,t){return m(e,t)},handleEvent:function(e,t){m(e,t,3)}},enterBeforeReadonlyEntity:g,backspaceAfterEntity:{keys:[8],shouldHandleEvent:function(e,t){return f(e,t,!1,!0)},handleEvent:function(e,t){f(e,t,!1,!0,5)}},deleteBeforeEntity:{keys:[46],shouldHandleEvent:function(e,t){return f(e,t,!0,!0)},handleEvent:function(e,t){f(e,t,!0,!0,4)}},moveBetweenDelimitersFeature:v,removeEntityBetweenDelimiters:{keys:[8,46],shouldHandleEvent:function(e,t){var n=t.getSelectionRange();if(!(null===n||void 0===n?void 0:n.collapsed))return!1;var o=46===e.rawEvent.which;if(b(e,t,o)){var i=C(e,o);return!!S(e,t,o,o?null===i||void 0===i?void 0:i.nextElementSibling:null===i||void 0===i?void 0:i.previousElementSibling)}return!1},handleEvent:function(e,t){var n=46===e.rawEvent.which;S(e,t,n,null,n?4:5)}}};function E(e,t){if((0,r.CP)(t,"HTMLLIElement")){if(t&&(0,r.CP)(e,"HTMLOListElement")){var n=new r.x8(e).getListItemIndex(t),o=-1==n?"":n.toString();switch(e.style.listStyleType){case"lower-alpha":case"lower-latin":case"upper-alpha":case"upper-latin":o=(0,r.R9)(n-1);break;case"lower-roman":case"upper-roman":o=(0,r.oO)(n)}return{defaultStrings:1,formatStrings:[o]}}return(0,r.CP)(e,"HTMLUListElement")?{defaultStrings:2}:void 0}}var w,_,I,P,A,R,L,N,M={"*":1,"-":2,"--":3,"->":5,"--\x3e":8,"=>":6,">":4,"\u2014":7};function O(e){var t=e.trim();return M[t]||null}!function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(L||(L={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(N||(N={}));var B={".":1,"-":2,")":3},F=[13,16,15,14],j=[17,20,19,18],H=["1","a","A","I","i"],z=["i","v","x","l","c","d","m"],U=["I","V","X","L","C","D","M"],W=((w={})[1]=function(e){return Z[e]||null},w[2]=function(e){return V[e]||null},w[3]=function(e){return q[e]||null},w[4]=function(e){return G[e]||null},w[5]=function(e){return K[e]||null},w),K=((_={})[1]=17,_[2]=20,_[3]=18,_[4]=19,_),G=((I={})[1]=13,I[2]=16,I[3]=14,I[4]=15,I),q=((P={})[1]=9,P[2]=12,P[3]=10,P[4]=11,P),V=((A={})[1]=5,A[2]=8,A[3]=6,A[4]=7,A),Z=((R={})[1]=1,R[2]=2,R[3]=3,R[4]=4,R),Y=function(e,t,n){var o=t?4:B[e[e.length-1]];if(o){var i=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(void 0!=t&&F.indexOf(t)>-1&&z.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(void 0!=t&&j.indexOf(t)>-1&&U.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),n);return i?W[i](o):null}return null};function X(e,t,n){var o,i=e.trim(),r="("===i[0]&&")"===i[i.length-1],a=r?i.slice(1,-1):i.slice(0,-1),s=parseInt(a),l=isNaN(s)?function(e){var t=e.toLocaleLowerCase();if(t){var n=t.length-1;return 26*n+t.charCodeAt(n)-96}return null}(a):s;if(!l||l<1)return null;if(t&&l>1&&(t.length<1&&H.indexOf(a)<0||(null===t||void 0===t?void 0:t.length)>0&&!(null===(o=t[t.length-1])||void 0===o?void 0:o.canAppendAtCursor(l))))return null;var c=function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?Y(i,r,n):null;return c}var $="previousBlock",J="nextBlock",Q=(0,r.iv)({orderedStyleType:(0,r.b$)(!0,void 0,1,20),unorderedStyleType:(0,r.b$)(!0,void 0,1,9)},!0,!0),ee=function(e){return function(t,n){var o=t.rawEvent,i=o.keyCode,r=o.altKey,a=o.shiftKey,s=o.ctrlKey,l=o.metaKey;return!s&&!l&&(9===i?!r&&a===!e:a&&r&&i===(e?39:37))&&be(t,n)}},te=function(e){return function(t,n){var o=null,a=9!==t.rawEvent.keyCode&&(o=n.getElementAtCursor())&&"rtl"==(0,r.L9)(o,"direction");n.addUndoSnapshot((function(){(0,i.Q2)(n,a==e?1:0)}),"Format",!1,{getAnnounceData:function(){return E(n.getElementAtCursor("OL,UL"),n.getElementAtCursor("LI"))}}),t.rawEvent.preventDefault()}},ne={keys:[9],shouldHandleEvent:ee(!0),handleEvent:te(!0)},oe={keys:[9],shouldHandleEvent:ee(!1),handleEvent:te(!1),allowFunctionKeys:!0},ie={keys:[39],shouldHandleEvent:ee(!0),handleEvent:te(!0),allowFunctionKeys:!0,defaultDisabled:r.Pw.isMac},re={keys:[37],shouldHandleEvent:ee(!1),handleEvent:te(!1),allowFunctionKeys:!0,defaultDisabled:r.Pw.isMac},ae={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),o=t.getSelectionRange();return n&&(null===o||void 0===o?void 0:o.collapsed)&&(0,r.r_)(r.yX.getStart(o),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);(null===n||void 0===n?void 0:n.previousSibling)?(0,i.Hd)(t,(function(o,i,a){var s=(0,r.hu)(o,!1,null!==n&&void 0!==n?n:void 0);s&&i&&a&&(s.setIndentation(i,a,1,!0),s.writeBack(t.isFeatureEnabled("ReuseAllAncestorListElements"),t.isFeatureEnabled("DisableListChain")),e.rawEvent.preventDefault())})):ve(e,t)},defaultDisabled:!0},se={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return n&&(0,r.Op)(n)&&!n.previousSibling&&!n.getElementsByTagName("blockquote").length},handleEvent:ve},le={keys:[46],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),o=t.getSelectionRange();if(n||!o)return!1;var i=r.yX.getEnd(o).isAtEnd?function(e,t){var n=(0,r.$F)(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),o=n&&r.yX.getEnd(n).normalize(),i=o&&t.getBodyTraverser(o.node);return null===(e=null===i||void 0===i?void 0:i.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}));return n}(e,t):void 0;return t.getElementAtCursor("LI",i,e)},handleEvent:function(e,t){var n=ge(t);t.runAsync((function(e){return(0,i.Ct)(e,n)}))}},ce={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return!e.rawEvent.shiftKey&&n&&(0,r.Op)(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return ve(e,t,!1)}),void 0,!0)},defaultDisabled:!r.Pw.isIE&&!r.Pw.isChrome},de={keys:[32],shouldHandleEvent:function(e,t){return!be(e,t)&&ye(e,t,O,2)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n=t.getContentSearcherOfCursor();if(n){var o=n.getSubStringBefore(5),r=n.getRangeFromText(o,!0),a=O(o);r&&(fe(t,r),(0,i.jZ)(t,null!==a&&void 0!==a?a:void 0,"autoToggleList")),null===(e=n.getRangeFromText(o,!0))||void 0===e||e.deleteContents()}}),void 0,!0)}},ue={keys:[32],shouldHandleEvent:function(e,t){return!be(e,t)&&ye(e,t,X,1)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,o=t.getContentSearcherOfCursor();if(o){var r=o.getSubStringBefore(5),a=o.getRangeFromText(r,!0);if(a){var s=me(r)?1:parseInt(r),l=pe(t,a),c=null!==(e=X(r))&&void 0!==e?e:void 0;fe(t,a),(0,i.SA)(t,l&&1!==s?void 0:s,c,"autoToggleList")}null===(n=o.getRangeFromText(r,!0))||void 0===n||n.deleteContents()}}),void 0,!0)}},pe=function(e,t){var n,o=e.getBodyTraverser(null===t||void 0===t?void 0:t.startContainer).getPreviousBlockElement(),i=null!==(n=null===o||void 0===o?void 0:o.getEndNode())&&void 0!==n?n:null;return"LI"===(0,r.e)(i)?i:void 0},he=function(e,t,n){var o=1===n?"orderedStyleType":"unorderedStyleType",i=pe(e,t),a=i?(0,r.W9)(i,void 0,1===n?"ol":"ul"):null,s=a?(0,r.yb)(a,Q):null;return s?s[o]:null},me=function(e){var t=parseInt(e);if(t&&1===t)return 1;var n=e.replace(/\(|\)|\-|\./g,"").trim();return 1===n.length&&["i","a","I","A"].indexOf(n)>-1?1:void 0};function ge(e){return r.qR.createListChains(e.getSelectedRegions())}function fe(e,t){var n,o=e.getBlockElementAtNode(t.startContainer),i=null===o||void 0===o?void 0:o.getEndNode();if(i&&"BR"!=(0,r.e)(i)){var a=e.getDocument().createElement("BR");(0,r.mt)(i)?i.appendChild(a):null===(n=i.parentNode)||void 0===n||n.insertBefore(a,i.nextSibling),e.select(t.startContainer,t.startOffset)}}function ve(e,t,n){void 0===n&&(n=!0);var o=be(e,t);if(o){var a=o[0],s=(0,r.e)(a);"UL"!=s&&"OL"!=s||(0,i.Ry)(t,"UL"==s?2:1,void 0,n),t.focus(),e.rawEvent.preventDefault()}}function be(e,t){var n=t.getElementAtCursor("LI,TABLE",void 0,e),o=n&&"LI"==(0,r.e)(n)&&t.getElementAtCursor("UL,OL",n);return o?[o,n]:null}function ye(e,t,n,o){var i=t.getContentSearcherOfCursor(e);if(!i)return!1;var r=i.getSubStringBefore(4),a=t.getBlockTraverser(),s=a&&a.currentBlockElement?a.currentBlockElement.getTextContent().slice(0,r.length):null,l=s&&s===r,c=ge(t),d=i.getRangeFromText(r,!0),u=d&&he(t,d,o),p=me(r),h=n(r,c,null!==u&&void 0!==u?u:void 0),m=p||!u||u===h||2===o;return l&&!i.getNearestNonTextInlineElement()&&h&&m}var Ce={keys:[8],shouldHandleEvent:function(e,t){var n,o,i=t.getElementAtCursor();if(i){var a=null===(n=t.getBlockElementAtNode(i))||void 0===n?void 0:n.getStartNode(),s=null!==(o=null===a||void 0===a?void 0:a.previousElementSibling)&&void 0!==o?o:null;if(ke(s)){var l=t.getSelectionRange(),c=t.getContentSearcherOfCursor(e),d=null===c||void 0===c?void 0:c.getSubStringBefore(4),u=null===c||void 0===c?void 0:c.getNearestNonTextInlineElement();if(l&&l.collapsed&&""===d&&!u){var p=null===a||void 0===a?void 0:a.nextElementSibling,h=ke(p)?p:null===p||void 0===p?void 0:p.firstChild;if(ke(h)&&(0,r.e)(s)==(0,r.e)(h)){var m=(0,r.$F)(e,$,(function(){return s})),g=(0,r.$F)(e,J,(function(){return h}));return!!m&&!!g}}}}return!1},handleEvent:function(e,t){t.runAsync((function(t){var n=(0,r.$F)(e,$,(function(){return null})),o=(0,r.$F)(e,J,(function(){return null})),i=t.getSelectionRange();if(n&&o&&i){var a=new r.x8(n);a.mergeVList(new r.x8(o));var s=t.getDocument().createElement("span");s.id="restoreRange",i.insertNode(s),a.writeBack(),(s=t.queryElements("#restoreRange")[0]).parentElement&&(t.select(new r.yX(s,-3)),s.parentElement.removeChild(s))}}))}},Se={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){},defaultDisabled:!0},indentWhenTab:ne,outdentWhenShiftTab:oe,outdentWhenBackspaceOnEmptyFirstLine:se,outdentWhenEnterOnEmptyLine:ce,mergeInNewLineWhenBackspaceOnFirstChar:ae,maintainListChain:{keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).filter((function(e){return!e.getElementsByTagName("blockquote").length})).length>0},handleEvent:function(e,t){var n=ge(t);t.runAsync((function(e){return(0,i.Ct)(e,n)}))}},maintainListChainWhenDelete:le,autoNumberingList:ue,autoBulletList:de,mergeListOnBackspaceAfterList:Ce,outdentWhenAltShiftLeft:re,indentWhenAltShiftRight:ie};function ke(e){return!!e&&((0,r.CP)(e,"HTMLOListElement")||(0,r.CP)(e,"HTMLUListElement"))}var De="\u200b";function xe(e,t,n,o){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===o&&!!Te(e,n,t)},handleEvent:function(e,o){o.runAsync((function(o){!function(e,t,n,o){t.addUndoSnapshot((function(){var i=Te(e,t,n);if(i){var a=new r.yX(i.endContainer,-1),s=i.endOffset+1<=a.offset;if(i&&s){var l=i.cloneRange();l.setStart(l.startContainer,l.startOffset+1);var c=l.extractContents().textContent,d=t.getDocument().createTextNode(null!==c&&void 0!==c?c:""),u=(0,r.LV)(d,o);i.setEnd(i.endContainer,i.endOffset+1),i.deleteContents();var p=t.getDocument().createTextNode(De);i.insertNode(p),i.insertNode(u),t.select(p,-1)}}}),"Format",!0)}(e,o,t,n)}))}}}function Te(e,t,n){return(0,r.$F)(e,"MARKDOWN_RANGE",(function(){var o=t.getContentSearcherOfCursor(e),i=null,a=null;return null===o||void 0===o||o.forEachTextInlineElement((function(e){if(a&&i)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;var o=e.getParentBlock().getTextContent();if(o[o.length-1].trim()===n)return!1;if(a||(a=e.getStartPosition().move(t.length)),t[0]==n)i=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(i)return!0;if(t[r]==n&&0==t[r-1].trim().length)return i=e.getStartPosition().move(r),!0}})),i&&a&&(0,r.Sd)(i,a)}))}var Ee={markdownBold:xe(56,"*","b",!0),markdownItalic:xe(189,"_","i",!0),markdownStrikethru:xe(192,"~","s",!0),markdownInlineCode:xe(192,"`","code",!1)},we="BLOCKQUOTE",_e=[we,"LI","TD","TH"].join(",");function Ie(e,t){return(0,r.$F)(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(_e);if(e&&(0,r.e)(e)==we){var n=t.getFocusedPosition(),o=n&&t.getBlockElementAtNode(n.normalize().node);if(o){var i=o.getStartNode()==e?o.getStartNode():o.collapseToSingleElement();return(0,r.Op)(i)?i:null}}return null}))}function Pe(e,t){t.addUndoSnapshot((function(){var n=Ie(e,t);if(n){(0,r.e)(n)==we&&(n=(0,r.LV)((0,r.$r)(n.childNodes)));var o=(0,r.KC)(n),a=!!o&&Ae(o),s=o&&(0,r.oA)(o);t.select(n,0),a&&((0,r.CP)(s,"HTMLLIElement")&&s.style.removeProperty("color"),(0,i.Px)(t))}})),e.rawEvent.preventDefault()}var Ae=function(e){return!!(e&&(0,r.CP)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)},Re={unquoteWhenBackspaceOnEmptyFirstLine:{keys:[8],shouldHandleEvent:function(e,t){var n=Ie(e,t);return n&&(0,r.Op)(n)&&!n.previousSibling},handleEvent:Pe},unquoteWhenEnterOnEmptyLine:{keys:[13],shouldHandleEvent:function(e,t){var n=Ie(e,t);return!e.rawEvent.shiftKey&&n&&(0,r.Op)(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return Pe(e,t)}),void 0,!0)}}};function Le(e,t,n,o){return void 0===o&&(o=!1),o?null:{winKey:e,macKey:t,action:n}}var Ne=[Le(4162,8258,i.s),Le(4169,8265,i.Rk),Le(4181,8277,i.Ty),Le(4128,8224,i.Px),Le(4186,8282,(function(e){return e.undo()})),Le(26,26,(function(e){return e.undo()}),r.Pw.isMac),Le(4185,24666,(function(e){return e.redo()})),Le(4286,8382,i.jZ),Le(4287,8383,i.SA),Le(20670,24766,(function(e){return(0,i.xE)(e,0)})),Le(20668,24764,(function(e){return(0,i.xE)(e,1)}))].filter((function(e){return!!e}));function Me(e){return(0,r.$F)(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.getModifierState("AltGraph")?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096)|(t.altKey&&18);return n&&Ne.filter((function(e){return(r.Pw.isMac?e.macKey:e.winKey)==n}))[0]}))}var Oe={defaultShortcut:{allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191,32,8],shouldHandleEvent:Me,handleEvent:function(e,t){var n=Me(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}},Be={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},Fe=(0,r.Co)(Be).join(","),je={keys:[13],shouldHandleEvent:He,handleEvent:function(e,t){var n=He(e,t),o=(0,r.n)(1,t.getDocument());t.addUndoSnapshot((function(){var e;null===(e=null===n||void 0===n?void 0:n.parentNode)||void 0===e||e.insertBefore(o,n),"TABLE"==(0,r.e)(n)&&t.select(new r.yX(o,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function He(e,t){return(0,r.$F)(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(Fe);if(n){var o=t.getSelectionRange();if(o&&o.collapsed&&(0,r.r_)(r.yX.getStart(o),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(Be[(0,r.e)(n)])}return null}))}var ze={insertLineBeforeStructuredNodeFeature:je},Ue={keys:[9],shouldHandleEvent:function(e,t){return Ke(e,t)&&!Ge(e,t)},handleEvent:function(e,t){var n,o,a,s=e.rawEvent.shiftKey,l=Ke(e,t);if(l){for(var c=qe(e,l),d=s?-1:1,u=null!==(n=c.row)&&void 0!==n?n:0,p=(null!==(o=c.col)&&void 0!==o?o:0)+d;;p+=d){var h=null!==(a=c.cells)&&void 0!==a?a:[];if(p<0||p>=h[u].length){if((u+=d)<0){t.select(c.table,-2);break}if(u>=h.length){(0,i.To)(t,1);break}p=s?h[u].length-1:0}var m=c.getCell(u,p);if(m.td){var g=new r.yX(m.td,0).normalize();t.select(g);break}}e.rawEvent.preventDefault()}}},We={keys:[38,40],shouldHandleEvent:function(e,t){return Ke(e,t)&&!Ge(e,t)},handleEvent:function(e,t){var n,o,i,a=Ke(e,t);if(a){var s=new r.ZX(a),l=38==e.rawEvent.which,c=l?-1:1,d=e.rawEvent.shiftKey,u=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),p=null;if(u){for(var h=u.anchorNode,m=u.anchorOffset,g=null!==(o=s.row)&&void 0!==o?o:0;g>=0&&s.cells&&g<s.cells.length;g+=c){var f=s.getCell(g,null!==(i=s.col)&&void 0!==i?i:0);if(f.td&&f.td!=a){p=f.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if((0,r.gR)(s.table,n)&&!(0,r.gR)(a,n,!0)){var o=p?new r.yX(p,0):new r.yX(s.table,l?-2:-3);if(d){o=1==o.node.nodeType&&(0,r.Gv)(o.node)?new r.yX(o.node,o.isAtEnd?-3:-2):o;var i=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();h&&(null===i||void 0===i||i.setBaseAndExtent(h,m,o.node,o.offset))}else e.select(o.normalize())}}))}}}};function Ke(e,t){return(0,r.$F)(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==(0,r.e)(n)?null:n)}))}function Ge(e,t){return(0,r.$F)(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=Ke(e,t);if(!n)return!1;var o=qe(e,n),i=t.getSelectionRangeEx();return 1==i.type&&i.coordinates&&(0,r.Tj)(o,i.coordinates)}))}function qe(e,t){return(0,r.$F)(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new r.ZX(t)}))}var Ve={tabInTable:Ue,upDownInTable:We,indentTableOnTab:{keys:[9],shouldHandleEvent:function(e,t){return Ke(e,t)&&Ge(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,o=t.getSelectionRangeEx(),r=Ke(e,t);if(r){var a=qe(e,r);n&&t.getElementAtCursor("blockquote",a.table,e)?(0,i.Q2)(t,1):n||(0,i.Q2)(t,0),o.coordinates&&t.select(o.table,o.coordinates)}}))}},deleteTableWithBackspace:{keys:[8],shouldHandleEvent:function(e,t){return t.isFeatureEnabled("DeleteTableWithBackspace")&&Ge(e,t)},handleEvent:function(e,t){var n=Ke(e,t);if(n){var o=new r.ZX(n);o.edit(4),o.writeBack()}}}},Ze={indentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){if(t.isFeatureEnabled("TabKeyTextFeatures")&&!e.rawEvent.shiftKey){var n=t.getDocument().activeElement,o=t.getElementAtCursor("LI,TABLE",void 0,e),i=t.getElementAtCursor((0,r.hm)(),void 0,e);return!o&&(i?i.isContentEditable:n.isContentEditable)}return!1},handleEvent:function(e,t){var n=t.getSelectionRangeEx();0==n.type&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)$e(t,e);else{var o=n.ranges,a=o[0];if(Ye(t,a))(0,i.Q2)(t,0);else{var s=(0,r.Sd)(a.startContainer,a.startOffset);o.forEach((function(e){return e.deleteContents()})),t.select(s),$e(t,e)}}})),e.rawEvent.preventDefault())}},outdentWhenTabText:{keys:[9],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled("TabKeyTextFeatures")){var n=t.getSelectionRangeEx();return 0==n.type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",void 0,e)&&!t.getElementAtCursor("LI,TABLE",void 0,e)&&Ye(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return(0,i.Q2)(t,1)})),e.rawEvent.preventDefault()}},autoHyphen:{keys:[],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){return!1},defaultDisabled:!0}};function Ye(e,t){var n=!1,o=r.yX.getStart(t),i=r.yX.getEnd(t),a=e.getBlockElementAtNode(o.node),s=e.getBlockElementAtNode(i.node);if(!a||!s)return!1;if(a.equals(s)){var l=new r.yX(a.getStartNode(),0),c=new r.yX(a.getEndNode(),-1),d=(0,r.Sd)(l,r.yX.getStart(t)),u=(0,r.Sd)(r.yX.getEnd(t),c);return!n&&Xe(d)&&Xe(u)&&(n=!0),n}return!0}function Xe(e){return""==e.toString()&&0==(0,r.a5)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function $e(e,t){var n=e.getDocument().createElement("span"),o=e.getContentSearcherOfCursor(t);if(o){for(var i=6-o.getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,a=null,s="",l=0;l<i;l++)s+="&ensp;";e.insertNode(n),n.nextElementSibling&&"A"==(0,r.e)(n.nextElementSibling)&&((a=e.getDocument().createElement("span")).textContent=" ",e.insertNode(a),e.select((0,r.Sd)(a,-2))),e.insertContent(s,{position:5,range:(0,r.Sd)(n,0),updateCursor:!1}),e.select((0,r.Sd)(n,-3)),a&&e.deleteNode(a)}}var Je=(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({},Se),Re),Ve),ze),c),Oe),h),Ee),T),Ze),p);function Qe(){return Je}var et=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t,this.editor=void 0,this.features=[]}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e;var n=Qe();(0,r.Co)(n).forEach((function(e){var o,i=n[e],r=t.settingsOverride&&void 0!==t.settingsOverride[e];(r&&(null===(o=t.settingsOverride)||void 0===o?void 0:o[e])||!r&&!i.defaultDisabled)&&t.features.push(i)})),this.features=this.features.concat(this.additionalFeatures||[]),this.features.forEach((function(e){var n;return null===(n=t.editor)||void 0===n?void 0:n.addContentEditFeature(e)}))},e.prototype.disposeFeatures=function(){var e=this;this.editor&&this.features.forEach((function(t){return e.editor.removeContentEditFeature(t)})),this.features=[]},e.prototype.dispose=function(){this.disposeFeatures(),this.editor=void 0},e}();const tt=et;var nt=function(){function e(e){var t=this;this.options=e,this.container=null,this.editor=null,this.isMenuShowing=!1,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;this.onDismiss(),(null===(e=this.container)||void 0===e?void 0:e.parentNode)&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(16==e.eventType&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY)&&(this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0)}},e.prototype.initContainer=function(e,t){var n,o;return!this.container&&this.editor&&(this.container=(0,r.n)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),null===(n=this.container)||void 0===n||n.style.setProperty("left",e+"px"),null===(o=this.container)||void 0===o||o.style.setProperty("top",t+"px"),!!this.container},e}();const ot=nt;var it=function(e,t,n,o){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:o}},rt=[it(":)","\ud83d\ude42",!0),it(";)","\ud83d\ude09",!0),it(":O","\ud83d\ude32",!0),it(":o","\ud83d\ude2f",!0),it("<3","\u2764\ufe0f",!0)];!function(){function e(e){void 0===e&&(e=rt),this.longestReplacementLength=null,this.editor=null,this.replacements=null,this.replacementEndCharacters=null,this.updateReplacements(e)}e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){var t,n,i=new Set;try{for(var r=(0,o.__values)(e),a=r.next();!a.done;a=r.next()){var s=a.value,l=s.sourceString;if(0!=l.length){var c=l[l.length-1];s.matchSourceCaseSensitive?i.add(c):(i.add(c.toLocaleLowerCase()),i.add(c.toLocaleUpperCase()))}}}catch(d){t={error:d}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t,n=this;if(3==e.eventType&&this.editor&&!this.editor.isInIME()&&e.rawEvent.data&&(null===(t=this.replacementEndCharacters)||void 0===t?void 0:t.has(e.rawEvent.data))){var o=this.editor.getContentSearcherOfCursor(e);if(o&&null!=this.longestReplacementLength){var i=o.getSubStringBefore(this.longestReplacementLength),r=this.getMatchingReplacement(i);if(r&&(!r.shouldReplace||!o||r.shouldReplace(r,o.getWordBefore(),this.editor))){var a=o.getSubStringBefore(r.sourceString.length),s=o.getRangeFromText(a,!0),l=this.editor.getDocument().createElement("span");l.innerHTML=this.editor.getTrustedHTMLHandler()(r.replacementHTML);var c=1==l.childNodes.length?l.childNodes[0]:l;s&&this.editor.addUndoSnapshot((function(){var e;s.deleteContents(),s.insertNode(c),null===(e=n.editor)||void 0===e||e.select(c,-1)}),void 0,!0)}}}},e.prototype.getMatchingReplacement=function(e){var t,n;if(0==e.length||!this.replacements)return null;var i=e.replace(/\s/g," "),r=i.toLocaleLowerCase();try{for(var a=(0,o.__values)(this.replacements),s=a.next();!s.done;s=a.next()){var l=s.value,c=(0,o.__read)(l.matchSourceCaseSensitive?[i,l.sourceString]:[r,l.sourceString.toLocaleLowerCase()],2),d=c[0],u=c[1];if(d.substring(d.length-u.length)==u)return l}}catch(p){t={error:p}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}}();!function(){function e(){var e=this;this.chains=null,this.expectedChangeSource=null,this.editor=null,this.disposer=null,this.onDrop=function(){e.cacheListChains("Drop")}}e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:this.chains&&this.chains.length>0&&this.expectedChangeSource==e.source&&this.editor&&((0,i.Ct)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectedRegions();n&&(this.chains=r.qR.createListChains(n),this.expectedChangeSource=e)}}();var at=function(){function e(e,t,n){var o=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.originalHref=null,this.trackedLink=null,this.editor=null,this.disposer=null,this.onMouse=function(e){var t,n,i=null===(t=o.editor)||void 0===t?void 0:t.getElementAtCursor("a[href]",e.target),r=i&&o.tryGetHref(i);r&&(null===(n=o.editor)||void 0===n||n.setEditorDomAttribute("title","mouseover"==e.type?o.getTooltipCallback(r,i):null))},this.onBlur=function(e){o.trackedLink&&o.updateLinkHrefIfShouldUpdate(),o.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n,o;if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var i,a=(i=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("A[href]",void 0,e))&&i!==this.trackedLink||2==e.eventType||7==e.eventType;7==e.eventType&&"Keyboard"==e.source&&this.trackedLink!=i&&i&&(this.trackedLink=i),this.trackedLink&&(a||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(a&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&i&&this.doesLinkDisplayMatchHref(i)&&(this.trackedLink=i,this.originalHref=this.tryGetHref(i))}if(6==e.eventType&&(i=null===(n=this.editor)||void 0===n?void 0:n.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(i,e.rawEvent))return;var s;if((s=this.tryGetHref(i))&&(0,r.tD)(e.rawEvent)&&0===e.rawEvent.button){e.rawEvent.preventDefault();try{var l=this.target||"_blank",c=null===(o=this.editor)||void 0===o?void 0:o.getDocument().defaultView;null===c||void 0===c||c.open(s,l)}catch(P){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(w){return null}},e.prototype.isContentEditValue=function(e){return(0,r.XJ)(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.trackedLink&&!this.doesLinkDisplayMatchHref(this.trackedLink)&&this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),o=this.tryGetHref(e);if(null!==o)return n.test(o)}return!1},e.prototype.updateLinkHref=function(){var e,t=this;if(this.trackedLink){var n=(0,r.aN)(this.trackedLink.innerText.trim());null!==n&&(null===(e=this.editor)||void 0===e||e.addUndoSnapshot((function(){t.trackedLink.href=n.normalizedUrl})))}},e}();const st=at;var lt,ct=["angleRad"],dt=["leftPercent","rightPercent","topPercent","bottomPercent"],ut=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(ct),!1),(0,o.__read)(dt),!1),pt=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(ut),!1),(0,o.__read)(["widthPx","heightPx"]),!1);function ht(e,t){return e&&e.src&&!pt.some((function(t){return!("number"===typeof e[t])}))?!ut.every((function(t){return mt(e[t],0)}))||e.flippedHorizontal||e.flippedVertical||t&&(!t||e.angleRad!==t.angleRad)?t&&ct.every((function(t){return mt(e[t],0)}))&&ct.every((function(e){return mt(t[e],0)}))&&dt.every((function(n){return mt(e[n],t[n])}))&&t.flippedHorizontal===e.flippedHorizontal&&t.flippedVertical===e.flippedVertical?2:3:1:0}function mt(e,t){return Math.abs(e-t)<.001}function gt(e,t){var n=e.widthPx,o=e.heightPx,i=e.angleRad,r=n/(1-e.leftPercent-e.rightPercent),a=o/(1-e.topPercent-e.bottomPercent),s=t?r:n,l=t?a:o;return{targetWidth:Math.abs(s*Math.cos(i))+Math.abs(l*Math.sin(i)),targetHeight:Math.abs(s*Math.sin(i))+Math.abs(l*Math.cos(i)),originalWidth:r,originalHeight:a,visibleWidth:s,visibleHeight:l}}function ft(e){e&&(0,r.Ij)(e)}function vt(e){var t=(0,r.yb)(e);return t&&0!=ht(t)?t:function(e){return{src:e.getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e)}function bt(e,t,n,o,i,a,s){var l="",c=ht(n,vt(null!==a&&void 0!==a?a:t));switch(c){case 1:l=n.src;break;case 2:l=o;break;case 3:l=function(e,t){var n=t.angleRad,o=t.widthPx,i=t.heightPx,r=t.bottomPercent,a=t.leftPercent,s=t.rightPercent,l=t.topPercent,c=t.naturalWidth,d=t.naturalHeight,u=c*(1-a-s),p=d*(1-l-r),h=window.devicePixelRatio||1,m=document.createElement("canvas"),g=gt(t),f=g.targetWidth,v=g.targetHeight;m.width=f*h,m.height=v*h;var b=m.getContext("2d");return b&&(b.scale(h,h),b.translate(f/2,v/2),b.rotate(n),b.scale(t.flippedHorizontal?-1:1,t.flippedVertical?-1:1),b.drawImage(e,c*a,d*l,u,p,-o/2,-i/2,o,i)),m.toDataURL("image/png",1)}(null!==a&&void 0!==a?a:t,n)}l!=o?l=e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:o,newSrc:l}).newSrc:s&&e.triggerPluginEvent(7,{source:"ImageResize"});l==n.src?ft(t):function(e,t){e&&(0,r.kq)(e,t)}(t,n);var d=gt(n),u=d.targetWidth,p=d.targetHeight;t.src=l,(i||3==c)&&(t.width=u,t.height=p,t.style.removeProperty("width"),t.style.removeProperty("height"),t.style.removeProperty("max-width"),t.style.removeProperty("max-height"))}function yt(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return!!n&&(n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0)}catch(w){return!1}}!function(e){e[e.Invalid=0]="Invalid",e[e.ResizeOnly=1]="ResizeOnly",e[e.SameWithLast=2]="SameWithLast",e[e.FullyChanged=3]="FullyChanged"}(lt||(lt={}));var Ct={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:kt},St={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:Dt};function kt(e){return[e.pageX,e.pageY]}function Dt(e){var t=0,n=0;if(e.targetTouches&&e.targetTouches.length>0){var o=e.targetTouches[0];t=o.pageX,n=o.pageY}return[t,n]}var xt=function(){function e(e,t,n,i,a,s){var l=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=i,this.zoomScale=a,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,n,i;e.preventDefault(),e.stopPropagation(),l.addDocumentEvents(),t=(0,o.__read)(l.dndMouse.getPageXY(e),2),l.initX=t[0],l.initY=t[1],l.initValue=null===(i=(n=l.handler).onDragStart)||void 0===i?void 0:i.call(n,l.context,e)},this.onMouseMove=function(e){var t,n,i;e.preventDefault();var r=(0,o.__read)(l.dndMouse.getPageXY(e),2),a=r[0],s=r[1],c=(a-l.initX)/l.zoomScale,d=(s-l.initY)/l.zoomScale;l.initValue&&(null===(n=(t=l.handler).onDragging)||void 0===n?void 0:n.call(t,l.context,e,l.initValue,c,d))&&(null===(i=l.onSubmit)||void 0===i||i.call(l,l.context,l.trigger))},this.onMouseUp=function(e){var t,n,o;e.preventDefault(),l.removeDocumentEvents(),(null===(n=(t=l.handler).onDragEnd)||void 0===n?void 0:n.call(t,l.context,e,l.initValue))&&(null===(o=l.onSubmit)||void 0===o||o.call(l,l.context,l.trigger))},this.dndMouse=s||r.Pw.isMobileOrTablet?St:Ct,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==St?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}();const Tt=xt;var Et,wt=32,_t=180/Math.PI,It=8,Pt={sw:0,nw:90,ne:180,se:270},At=["w","","e"],Rt=["s","","n"],Lt=22,Nt=7,Mt=["w","e"],Ot=["s","n"];!function(e){e[e.SquareHandles=0]="SquareHandles",e[e.CircularHandlesCorner=1]="CircularHandlesCorner"}(Et||(Et={}));var Bt={onDragStart:function(e){var t=e.editInfo;return(0,o.__assign)({},t)},onDragging:function(e,t,n,i,r){var a,s=e.x,l=e.y,c=e.editInfo,d=e.options,u=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;if(i=(a=(0,o.__read)(Ft(i,r,c.angleRad),2))[0],r=a[1],void 0!==d.minWidth&&void 0!==d.minHeight){var p=""==s,h=""==l,m=!(p||h)&&(d.preserveRatio||t.shiftKey),g=p?n.widthPx:Math.max(n.widthPx+i*("w"==s?-1:1),d.minWidth),f=h?n.heightPx:Math.max(n.heightPx+r*("n"==l?-1:1),d.minHeight);return m&&u>0&&(u>1?(g=f*u)<d.minWidth&&(f=(g=d.minWidth)/u):(f=g/u)<d.minHeight&&(g=(f=d.minHeight)*u)),c.widthPx=g,c.heightPx=f,!0}return!1}};function Ft(e,t,n){if(0==e&&0==t)return[0,0];var o=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[o*Math.cos(n),o*Math.sin(n)]}function jt(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}}function Ht(e,t,n,o){var i="w"==e?"left":"right",r="n"==t?"top":"bottom",a=t+e;return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+i+":"+(""==e?"50%":"0px")+";"+r+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:zt[o](a,r,i,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}var zt={0:function(e,t,n,o){return"position:relative;width:10px;height:10px;background-color: "+o+";cursor:"+e+"-resize;"+n+":-6px;"+t+":-6px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-6px;"+t+":-6px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}},Ut={onDragStart:function(e){var t=e.editInfo;return(0,o.__assign)({},t)},onDragging:function(e,t,n,i,r){var a,s=e.editInfo,l=e.x,c=e.y,d=e.options;i=(a=(0,o.__read)(Ft(i,r,s.angleRad),2))[0],r=a[1];var u=s.widthPx,p=s.heightPx,h=s.leftPercent,m=s.rightPercent,g=s.topPercent,f=s.bottomPercent,v=d.minWidth,b=d.minHeight,y=1-h-m,C=1-g-f;if(y>0&&C>0&&void 0!==v&&void 0!==b){var S=u/y,k=p/C,D="e"!=l?Wt(n.leftPercent,i,S,m,v):h,x="w"!=l?Wt(n.rightPercent,-i,S,h,v):m,T="s"!=c?Wt(n.topPercent,r,k,f,b):g,E="n"!=c?Wt(n.bottomPercent,-r,k,g,b):f;return s.leftPercent=D,s.rightPercent=x,s.topPercent=T,s.bottomPercent=E,s.widthPx=S*(1-D-x),s.heightPx=k*(1-T-E),!0}return!1}};function Wt(e,t,n,o,i){var r=n*(1-o)-i,a=n*e+t;return Math.max(Math.min(a,r),0)/n}function Kt(){var e=[];return[0,1].forEach((function(t){return[0,1].forEach((function(n){e.push(function(e,t){var n=0==t?"right:"+e+"px;height:"+(Nt-2*e)+"px;":"top:"+e+"px;width:"+(Nt-2*e)+"px;",o=0==e?"white":"black";return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+n+";background-color:"+o}}(t,n))}))})),e}var Gt,qt={onDragStart:function(e){var t=e.editInfo;return(0,o.__assign)({},t)},onDragging:function(e,t,n,o,i){var r=e.editInfo,a=e.options,s=r.heightPx/2+31,l=s*Math.sin(n.angleRad)+o,c=s*Math.cos(n.angleRad)-i,d=Math.atan2(l,c);if(!t.altKey&&a&&void 0!==a.minRotateDeg){var u=d*_t;d=Math.round(u/a.minRotateDeg)*a.minRotateDeg/_t}return r.angleRad!=d&&(r.angleRad=d,!0)}};function Vt(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: "+It+"px "+It+"px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}var Zt=Math.PI,Yt=8,Xt=2*Zt/Yt,$t=["nw","n","ne","e","se","s","sw","w"],Jt={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:"",disableCrop:!1,disableRotate:!1,disableSideResize:!1,onSelectState:7,applyChangesOnMouseUp:!1},Qt=((Gt={})[1]=function(e,t){var n=e.borderColor,o=[];return At.forEach((function(e){return Rt.forEach((function(i){var r=""==e==(""==i)?Ht(e,i,n,1):null;t&&r&&t(r,e,i),r&&o.push(r)}))})),o},Gt[2]=function(e,t){var n=e.borderColor,o=[];return At.forEach((function(e){return Rt.forEach((function(i){var r=""==e!=(""==i)?Ht(e,i,n,1):null;t&&r&&t(r,e,i),r&&o.push(r)}))})),o},Gt[4]=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t+";top:"+"-21px;height:15px;margin-left:"+"-1px;",children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:"+"32px;height:"+"32px;left:-17px;cursor:move;top:"+"-32px;line-height: 0px;",children:[Vt(t)]}]}]},Gt[8]=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return t&&Mt.forEach((function(e){return Ot.forEach((function(n){var o;return null===(o=t.children)||void 0===o?void 0:o.push(function(e,t){var n="w"==e?"left":"right",o="n"==t?"top":"bottom",i=Pt[t+e];return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+n+":0;"+o+":0;width:"+Lt+"px;height:"+Lt+"px;transform:rotate("+i+"deg)",dataset:{x:e,y:t},children:Kt()}}(e,n))}))})),[t,e,e,e,e]},Gt),en=function(){function e(e,t){var n=this;this.onShowResizeHandle=t,this.editor=null,this.disposer=null,this.image=null,this.clonedImage=null,this.wrapper=null,this.editInfo=null,this.lastSrc=null,this.dndHelpers=[],this.wasResized=!1,this.shadowSpan=null,this.isCropping=!1,this.onBlur=function(){n.setEditingImage(null,!1)},this.removeWrapper=function(){var e;n.shadowSpan&&(0,r.oA)(n.shadowSpan),n.options.applyChangesOnMouseUp&&(null===(e=n.wrapper)||void 0===e||e.removeEventListener("mouseup",n.changesWhenMouseUp,!0)),n.wrapper=null,n.shadowSpan=null},this.changesWhenMouseUp=function(){n.editor&&n.image&&n.editInfo&&n.lastSrc&&n.clonedImage&&bt(n.editor,n.image,n.editInfo,n.lastSrc,n.wasResized,n.clonedImage,n.options.applyChangesOnMouseUp)},this.updateWrapper=function(e){var t,o,i,a=n.wrapper;if(a&&n.editInfo&&n.image&&n.clonedImage&&n.options&&(null===(t=n.shadowSpan)||void 0===t?void 0:t.parentElement)){var s=on(a,"r_cropC"),l=on(a,"r_cropO"),c=on(a,"r_resizeH"),d=on(a,"r_rotateC")[0],u=on(a,"r_rotateH")[0],p=on(a,"r_cropH");n.isCropping=1==s.length&&4==l.length;var h=n.editInfo,m=h.angleRad,g=h.bottomPercent,f=h.leftPercent,v=h.rightPercent,b=h.topPercent,y=h.flippedHorizontal,C=h.flippedVertical,S=gt(n.editInfo,n.isCropping),k=S.targetWidth,D=S.targetHeight,x=S.originalWidth,T=S.originalHeight,E=S.visibleWidth,w=S.visibleHeight,_=(k-E)/2,I=(D-w)/2,P=x*f,A=x*v,R=T*b,L=T*g;if(a.style.margin=I+"px "+_+"px",a.style.transform="rotate("+m+"rad)",function(e,t,n,o){if(t.style.borderStyle){var i=t.style.borderWidth?2*parseInt(t.style.borderWidth):2;return e.style.width=nn(n+i),void(e.style.height=nn(o+i))}e.style.width=nn(n),e.style.height=nn(o)}(a,n.image,E,w),a.style.textAlign=(i=n.shadowSpan.parentElement,(0,r.CP)(i,"HTMLElement")&&"rtl"==(0,r.L9)(i,"direction")?"right":"left"),n.clonedImage.style.width=nn(x),n.clonedImage.style.height=nn(T),function(e,t,n){e&&(e.style.transform="scale("+(t?-1:1)+", "+(n?-1:1)+")")}(n.clonedImage.parentElement,y,C),n.isCropping)tn(s[0],P,R,A,L,void 0,void 0),tn(l[0],0,0,A,void 0,void 0,R),tn(l[1],void 0,0,0,L,A,void 0),tn(l[2],P,void 0,0,0,void 0,L),tn(l[3],0,R,void 0,0,P,void 0),an(p,m);else{if(n.clonedImage.style.margin=-R+"px 0 0 "+-P+"px","r_resizeH"==(null===e||void 0===e?void 0:e.elementClass)){var N=a.clientWidth,M=a.clientHeight;n.wasResized=!0,function(e,t,n,o){var i=e.widthPx,r=e.heightPx,a=r>0?i/r:0;n=Math.floor(n),o=Math.floor(o),i=Math.floor(i),r=Math.floor(r),e.widthPx=n,e.heightPx=o,t&&a>0&&(i!==n||r!==o)&&(n<i?e.heightPx=n/a:e.widthPx=o*a)}(n.editInfo,n.options.preserveRatio||!1,N,M),n.updateWrapper()}var O=null===(o=n.editor)||void 0===o?void 0:o.getVisibleViewport(),B=ln(k,D);u&&d&&O&&function(e,t,n,o,i,r){if(r)return o.style.display="none",void(i.style.display="none");o.style.display="",i.style.display="";var a=o.getBoundingClientRect(),s=n.getBoundingClientRect();if(a&&s){var l=Number.MAX_SAFE_INTEGER,c=t*_t;if(c<45&&c>-45&&s.top-e.top<53)l=a.top-e.top;else if(c<=-80&&c>=-100&&s.left-e.left<53)l=a.left-e.left;else if(c>=80&&c<=100&&e.right-s.right<53){var d=a.right-e.right;l=Math.min(e.right-s.right,d)}else if((c<=-160||c>=160)&&e.bottom-s.bottom<53){var u=a.bottom-e.bottom;l=Math.min(e.bottom-s.bottom,u)}var p=Math.max(Math.min(15,l),0),h=Math.max(Math.min(wt,l-p),0);o.style.top=-p-6+"px",o.style.height=p+"px",i.style.top=-h+"px"}}(O,m,a,d,u,B),function(e,t){e.forEach((function(e){var n=e.dataset,o=n.y,i=n.x,r=["n","s","e","w"].indexOf((null!==o&&void 0!==o?o:"")+(null!==i&&void 0!==i?i:""))>-1;e.style.display=r&&t?"none":""}))}(c,B),an(c,m)}}},this.options=(0,o.__assign)((0,o.__assign)({},Jt),e||{}),this.allowedOperations=1|(this.options.disableCrop?0:8)|(this.options.disableRotate?0:4)|(this.options.disableSideResize?0:2)}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler({blur:function(){return t.onBlur()},dragstart:function(e){t.image&&e.preventDefault()}})},e.prototype.dispose=function(){var e;this.clearDndHelpers(),null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 22:e.selectionRangeEx&&2===e.selectionRangeEx.type&&this.options&&void 0!==this.options.onSelectState&&this.setEditingImage(e.selectionRangeEx.image,this.options.onSelectState);break;case 5:var n=e.rawEvent.target,o=e.rawEvent.button;(this.shadowSpan!==n||this.shadowSpan===n&&0!==o||this.isCropping)&&this.setEditingImage(null);break;case 6:this.editor&&this.image&&this.shadowSpan&&this.editor.select(this.image);break;case 0:this.setEditingImage(null);break;case 7:case 12:this.removeWrapper();break;case 8:(null===(t=this.options)||void 0===t?void 0:t.imageSelector)&&(0,r.$r)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){ft(e)}))}},e.prototype.isOperationAllowed=function(e){return!!(this.allowedOperations&e)},e.prototype.setEditingImage=function(e,t){var n=this,i="number"===typeof t?t:0,r="number"!==typeof t&&!!t;!e&&this.image&&this.editor&&this.editInfo&&this.lastSrc&&this.clonedImage&&(this.clearDndHelpers(),bt(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized||this.isCropping,this.clonedImage),this.removeWrapper(),this.editor.addUndoSnapshot((function(){return n.image}),"ImageResize"),r&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null,this.clonedImage=null,this.isCropping=!1),!this.image&&(null===e||void 0===e?void 0:e.isContentEditable)&&this.editor&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=vt(e),this.wasResized=function(e){var t=e.width,n=e.height,o=e.style;return!(""!==o.maxWidth&&"initial"!==o.maxWidth&&"auto"!==o.maxWidth||!(sn(o.height)||sn(o.width)||sn(t)||sn(n)))}(this.image),i=(yt(e)?i:3)&this.allowedOperations,this.createWrapper(i),this.updateWrapper(),this.dndHelpers=(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(this.createDndHelpers("r_resizeH",Bt)),!1),(0,o.__read)(this.createDndHelpers("r_rotateH",qt)),!1),(0,o.__read)(this.createDndHelpers("r_cropH",Ut)),!1),(0,o.__read)(this.createDndHelpers("r_cropC",Ut)),!1),this.editor.select(this.image))},e.prototype.flipImage=function(e,t){var n;this.image=e,this.editInfo=vt(e);var o=this.editInfo.angleRad;o>=Math.PI/2&&o<3*Math.PI/4||o<=-Math.PI/2&&o>-3*Math.PI/4?"horizontal"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal:"vertical"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.rotateImage=function(e,t){var n;this.image=e,this.editInfo=vt(e),this.editInfo.angleRad=this.editInfo.angleRad+t,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.createWrapper=function(e){var t,n,o=this;if(this.image&&this.editor&&this.options&&this.editInfo){this.clonedImage=this.image.cloneNode(!0),this.clonedImage.removeAttribute("id"),this.clonedImage.style.removeProperty("max-width"),this.clonedImage.style.removeProperty("max-height"),this.clonedImage.style.width=this.editInfo.widthPx+"px",this.clonedImage.style.height=this.editInfo.heightPx+"px",this.wrapper=(0,r.n)(6,this.image.ownerDocument),null===(n=null===(t=this.wrapper)||void 0===t?void 0:t.firstChild)||void 0===n||n.appendChild(this.clonedImage),this.wrapper.style.display=r.Pw.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.clonedImage&&(this.clonedImage.src=this.editInfo.src,this.clonedImage.style.position="absolute");var i={borderColor:cn(this.options.borderColor,this.editor.isDarkMode()),rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:ln(this.editInfo.widthPx,this.editInfo.heightPx)},a=[jt(i)];(0,r.Co)(Qt).forEach((function(t){var n=Qt[t](i,o.onShowResizeHandle);(e&t)==t&&n&&(0,r.u5)(a,n)})),a.forEach((function(e){var t=(0,r.n)(e,o.image.ownerDocument);t&&o.wrapper&&o.wrapper.appendChild(t)})),this.insertImageWrapper(this.wrapper)}},e.prototype.insertImageWrapper=function(e){if(this.image&&(this.shadowSpan=(0,r.LV)(this.image,"span"),this.shadowSpan)){var t=this.shadowSpan.attachShadow({mode:"open"});this.shadowSpan.style.verticalAlign="bottom",e.style.fontSize="24px",this.options.applyChangesOnMouseUp&&e.addEventListener("mouseup",this.changesWhenMouseUp,!0),t.appendChild(e)}},e.prototype.createDndHelpers=function(e,t){var n=this,o=this.wrapper;return o&&this.editInfo?on(o,e).map((function(o){return new Tt(o,{editInfo:n.editInfo,options:n.options,elementClass:e,x:o.dataset.x,y:o.dataset.y},n.updateWrapper,t,n.editor?n.editor.getZoomScale():1)})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=[]},e}();function tn(e,t,n,o,i,r,a){e.style.left=void 0!==t?nn(t):e.style.left,e.style.top=void 0!==n?nn(n):e.style.top,e.style.right=void 0!==o?nn(o):e.style.right,e.style.bottom=void 0!==i?nn(i):e.style.bottom,e.style.width=void 0!==r?nn(r):e.style.width,e.style.height=void 0!==a?nn(a):e.style.height}function nn(e){return e+"px"}function on(e,t){return(0,r.$r)(e.querySelectorAll("."+t))}function rn(e,t,n){void 0===t&&(t=""),void 0===n&&(n="");var o=function(e){var t=Math.round(e/Xt)%Yt;return t<0?t+Yt:t}(e),i=t+n,r=$t.indexOf(i),a=r>=0&&r+o;return a?$t[a%Yt]:""}function an(e,t){e.forEach((function(e){var n=e.dataset,o=n.y,i=n.x;e.style.cursor=rn(t,o,i)+"-resize"}))}function sn(e){var t="string"===typeof e?parseInt(e):e;return!isNaN(t)}function ln(e,t){return!!(e&&t&&(e<42||t<42))}function cn(e,t){return"string"===typeof e?e.trim():t?e.darkModeColor.trim():e.lightModeColor.trim()}function dn(e,t){var n=e.naturalWidth,o=e.naturalHeight,i=e.leftPercent,r=e.topPercent;return{width:n*(1-i-e.rightPercent)*t,height:o*(1-r-e.bottomPercent)*t}}function un(e,t,n){void 0===n&&(n=1);var o=vt(e),i=o.heightPx||e.height,r=o.widthPx||e.width;if(o){var a=dn(o,t),s=a.width,l=a.height;return Math.abs(s-r)<n&&Math.abs(l-i)<n}return!1}function pn(e,t,n,o,i){var r,a,s,l=vt(t);un(t,n)||(r=t,a=t.src,s=function(){if(!e.isDisposed()&&e.contains(t)&&l){var r=t.getAttribute("src"),a=dn(l,n),s=a.width,c=a.height;l.widthPx=Math.max(s,o),l.heightPx=Math.max(c,i),e.addUndoSnapshot((function(){bt(e,t,l,r||"",!0)}),"ImageResize"),e.select(t)}},r.onload=function(){r.onload=null,r.onerror=null,s()},r.onerror=function(){r.onload=null,r.onerror=null,s()},r.src=a)}function hn(e,t){e.addUndoSnapshot((function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),ft(t)}),"ImageResize")}!function(e){function t(t,n,o,i,r){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===o&&(o="#DB626C"),void 0===i&&(i=!1),void 0===r&&(r="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:o,preserveRatio:i,imageSelector:r})||this}(0,o.__extends)(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)}}(en);function mn(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,r.e)(e))<0){var t=!1;if((0,r.$r)(e.childNodes).every((function(e){var n;return!(!(0,r.CP)(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==(0,r.e)(e)&&(t=!0,!0)}))&&t)return!0}return!1}var gn=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,fn=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,vn=/<tr[^>]*>[^<]*/i,bn=/<table[^>]*>[^<]*/i;function yn(e,t){var n=e.fragment,o=e.sanitizingOption,i=e.htmlBefore,a=e.clipboardData,s=a.html?function(e,t){if(e.match(gn)){var n=t.match(vn);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(fn)){var o=t.match(bn);e=(o?o[0]:"<TABLE>")+e+"</TABLE>"}return e}(a.html,i):void 0;if(s&&a.html!=s){var l=(new DOMParser).parseFromString(t(s),"text/html");(0,r.nu)(n,null===l||void 0===l?void 0:l.body)}var c=n.firstChild;c&&c.childNodes.length>0&&"DIV"==(0,r.e)(c)&&(Array.from(c.childNodes).every((function(e){return"META"==(0,r.e)(e)||"TABLE"==(0,r.e)(e)&&e==c.lastChild}))&&c.lastChild&&e.fragment.replaceChildren(c.lastChild));(0,r.OD)(o.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))}function Cn(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}var Sn='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img',kn="ListContainerWrapper",Dn="WACImageContainer",xn=["111","9643","9830"];function Tn(e){!function(e){var t=(0,r.$r)(e.querySelectorAll(Sn));t.forEach((function(e){var t=new RegExp("\\b"+kn+"\\b","g");if(e.previousSibling){var n=(0,r.R5)(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var o=(0,r.R5)(e,!1);o.className=o.className.replace(t,"")}}))}(e);var t=function(e){for(var t=e.querySelectorAll("."+kn),n=[],o=null,i=0;i<t.length;i++){var a=t[i];if(o){var s=o.listItemContainers,l=s[s.length-1];a==l.nextSibling||l.parentNode&&(0,r.Fb)(a)==(0,r.ec)(l.parentNode,l)?(s.push(a),o.endElement=a):(o.endElement=l,n.push(o),o=Cn(a))}else o=Cn(a)}o&&o.listItemContainers.length>0&&n.push(o);return n}(e);t.forEach((function(t){var n,o,i;!function(e,t){if(t.startElement&&t.endElement){(0,r.bO)(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==(0,r.e)(e.firstChild)&&(0,r.oA)(e)}))}}(e,t),t.insertPositionNode=null!==(o=null===(n=t.endElement)||void 0===n?void 0:n.nextSibling)&&void 0!==o?o:null;var a=void 0,s=e.ownerDocument;t.listItemContainers.forEach((function(n){var o=function(e){var t=(0,r.e)(e.firstChild);return"UL"==t||"OL"==t?t:null}(n);o&&(a||(a=En(n,s,o)),(0,r.$r)(n.querySelectorAll("li")).forEach((function(i){var l,c=parseInt(null!==(l=i.getAttribute("data-aria-level"))&&void 0!==l?l:"");a&&(0,r.e)(a)!=o&&1==c&&o&&(wn(a,e,t),a=En(n,s,o)),a&&o&&function(e,t,n,o){var i;if(!n)return;var a=parseInt(null!==(i=t.getAttribute("data-aria-level"))&&void 0!==i?i:""),s=t.getAttribute("data-leveltext");"UL"==n&&s&&xn.indexOf(s.charCodeAt(0).toString())>-1&&(t.style.listStyleType='"'+s+'  "');var l=e;for(;a>1;){if(l.firstChild){var c=l.lastElementChild,d=(0,r.e)(c);!c||"UL"!=d&&"OL"!=d?(l.appendChild(o.createElement(n)),l.lastElementChild&&(l=l.lastElementChild)):l=c}else l.appendChild(o.createElement(n)),l.firstElementChild&&(l=l.firstElementChild);a--}l.appendChild(t)}(a,i,o,s)})))})),a&&wn(a,e,t);var l=null===(i=t.startElement)||void 0===i?void 0:i.parentNode;l&&t.listItemContainers.forEach((function(e){l.removeChild(e)}))}));var n=function(e){return e.querySelectorAll("."+Dn)}(e);n.forEach((function(e){(0,r.CP)(e,"HTMLSpanElement")&&e.childNodes.forEach((function(e){var t;"IMG"!=(0,r.e)(e)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e))}))}))}function En(e,t,n){var o,i=t.createElement(n),r=null===(o=e.firstElementChild)||void 0===o?void 0:o.getAttribute("start");return r&&i.setAttribute("start",r),i}function wn(e,t,n){var o;if(e){var i,r=n.insertPositionNode;if(r)(i=r.parentNode)&&i.insertBefore(e,r);else(i=null===(o=n.startElement)||void 0===o?void 0:o.parentNode)?i.appendChild(e):t.appendChild(e)}}var _n=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return"."+e})).join(",");function In(e,t){e.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer').forEach((function(e){var t=e;t.style.removeProperty("display"),t.style.removeProperty("margin")})),function(e){return!(!e||!e.querySelector(Sn))}(e)&&Tn(e),(0,r.OD)(t.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),e.querySelectorAll(_n).forEach((function(e){var t;return null===(t=e.parentElement)||void 0===t?void 0:t.removeChild(e)}))}var Pn="mso-comment-parent",An="mso-comment-reference",Rn="mso-comment-date",Ln=/#_msocom_/,Nn="mso-special-character",Mn="comment",On="mso-comment-continuation",Bn="mso-element",Fn="comment-list",jn="mso-comment-done";var Hn="NodeId";function zn(e,t,n,o){if(1==t.nodeType){var i=Wn(e,t);""!=i&&(e.dict[i]||(e.dict[i]={}),e.dict[i][n]=o)}}function Un(e,t,n){if(1==t.nodeType){var o=Wn(e,t);if(""!=o)return e.dict[o]&&e.dict[o][n]}return null}function Wn(e,t){var n=t.getAttribute(Hn);return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute(Hn,n)),n}var Kn=5,Gn="UniqueListId",qn="mso-list",Vn=/[\n|\r]/gi;function Zn(e,t,n,o){var i,a=Yn(t,n.level,o),s=Un(e.wordCustomData,a,Gn);if(s&&s!=n.uniqueListId||!s&&a.firstChild){var l=t.ownerDocument.createElement(o.tagName);null===(i=a.parentNode)||void 0===i||i.insertBefore(l,a.nextSibling),a=l}return zn(e.wordCustomData,a,Gn,n.uniqueListId),function(e,t,n){var o,i,a;if(n.tagName!=(0,r.e)(t)){var s=null===(o=t.ownerDocument)||void 0===o?void 0:o.createElement(n.tagName);s&&(zn(e.wordCustomData,s,Gn,Un(e.wordCustomData,t,Gn)),(0,r.nu)(s,t),null===(i=t.parentNode)||void 0===i||i.insertBefore(s,t),null===(a=t.parentNode)||void 0===a||a.removeChild(t),t=s)}return t}(e,a,o)}function Yn(e,t,n){var o,i,a=null,s=null;if(1==t?s=to(e):(a=Yn(e,t-1,null)).lastChild&&(s=a.lastChild),s&&1==s.nodeType){var l=(0,r.e)(s);if("UL"==l||"OL"==l)return s}var c=null===(o=e.ownerDocument)||void 0===o?void 0:o.createElement(n?n.tagName:"UL");return 1==t?null===(i=e.parentNode)||void 0===i||i.insertBefore(c,e):null===a||void 0===a||a.appendChild(c),c}function Xn(e,t){for(var n=[],o=e.firstChild;o;o=o.nextSibling)o&&(o&&1==o.nodeType&&t>1&&Xn(o,t-1),(io(o=eo(o,!0))||oo(o))&&n.push(o));n.forEach((function(t){return e.removeChild(t)}))}function $n(e){if(1==e.nodeType){var t=ro(e,qn);if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr(5)),wordListId:t,originalNode:e,uniqueListId:0}}catch(o){}}return null}function Jn(e){return["o","\xb7","\xa7","-"].indexOf(e)>=0}function Qn(e,t){for(var n,o,i="",r=e.firstChild;!i&&r;)oo(r=eo(r,!0))?0==(i=null!==(o=null===(n=r.textContent)||void 0===n?void 0:n.trim())&&void 0!==o?o:"").length&&(i="o"):1==r.nodeType&&t>1&&(i=Qn(r,t-1)),r=r.nextSibling;return i}function eo(e,t){var n,o,i,r;if(8==e.nodeType){var a=e.data;if(a&&"[if !supportlists]"==a.trim().toLowerCase()){for(var s=e,l=null,c=0;c<4&&(s=no(s));c++)if(8==s.nodeType&&(a=s.data)&&"[endif]"==a.trim().toLowerCase()){l=s;break}if(l){var d=null===(n=e.ownerDocument)||void 0===n?void 0:n.createElement("span");for(null===d||void 0===d||d.setAttribute("style","mso-list: ignore"),s=no(e);s!=l;)(s=null===s||void 0===s?void 0:s.nextSibling).previousSibling&&(null===d||void 0===d||d.appendChild(s.previousSibling));d&&(null===(o=l.parentNode)||void 0===o||o.insertBefore(d,l)),t&&(null===(i=e.parentNode)||void 0===i||i.removeChild(e),null===(r=l.parentNode)||void 0===r||r.removeChild(l)),d&&(e=d)}}}return e}function to(e){var t=e;do{t=t.previousSibling}while(t&&ao(t));return t}function no(e){var t=e;do{t=t.nextSibling}while(t&&ao(t));return t}function oo(e){if(1==e.nodeType){var t=ro(e,qn);if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function io(e){return"SPAN"==(0,r.e)(e)&&!e.firstChild}function ro(e,t){return(0,r.$f)(e)[t]||null}function ao(e){var t;if(!e)return!0;if(3==e.nodeType){var n=e.nodeValue;return 0==(null===(n=null!==(t=null===n||void 0===n?void 0:n.replace(Vn,""))&&void 0!==t?t:"")||void 0===n?void 0:n.trim().length)}var o=(0,r.e)(e);return!(!e.firstChild||e.firstChild!=e.lastChild||"SPAN"!=o&&"FONT"!=o)&&ao(e.firstChild)}function so(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}var lo=/%/;function co(e){var t=e.sanitizingOption,n=e.fragment;(0,r.OD)(t.elementCallbacks,"O:P",(function(e){return(0,r.nu)(e),e.appendChild(e.ownerDocument.createTextNode("\xa0")),!0}));var o,i,a={nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:{dict:{},nextNodeId:1}},s=n.querySelectorAll("p,h1,h2,h3,h4,h5,h6");s.length>0&&(a.wordConverterArgs={nodes:s,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[{listsMetadata:{},currentUniqueListId:-1}],lastProcessedItem:null},function(e){var t,n,o=e.wordConverterArgs;if(!o)return!1;for(;o.currentIndex<o.nodes.length;){var i=o.nodes.item(o.currentIndex),a=$n(i);if(a){var s=o.currentListIdsByLevels[a.level-1]||{listsMetadata:{},currentUniqueListId:-1};o.currentListIdsByLevels[a.level-1]=s,o.lastProcessedItem&&to(i)!=o.lastProcessedItem&&so(o);var l=s.listsMetadata[a.wordListId];if(l){if(!l.ignore&&1==l.numberOfItems){var c=Qn(i,Kn);l.tagName=l.firstFakeBullet==c?"UL":"OL"}}else{var d=Qn(i,Kn);l={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:d,ignore:!d||0==d.length,tagName:(n=d,Jn(n)?"UL":"OL")},s.listsMetadata[a.wordListId]=l,o.lists[l.uniqueListId.toString()]=l}a.uniqueListId=l.uniqueListId,l.ignore||"OL"==l.tagName&&l.numberOfItems>0&&s.currentUniqueListId!=a.uniqueListId?(l.ignore=!0,o.currentListIdsByLevels[0].currentUniqueListId=-1,o.currentListIdsByLevels=o.currentListIdsByLevels.slice(0,1)):(o.currentListIdsByLevels.length>a.level&&(o.currentListIdsByLevels=o.currentListIdsByLevels.slice(0,a.level)),s.currentUniqueListId=a.uniqueListId,o.listItems.push(a),l.numberOfItems++),o.lastProcessedItem=i}else{var u=o.lastProcessedItem;u&&to(i)==u&&i.tagName==u.tagName&&i.className==u.className&&(u.appendChild(u.ownerDocument.createElement("br")),u.appendChild(u.ownerDocument.createElement("br")),(0,r.nu)(u,i,!0),null===(t=i.parentNode)||void 0===t||t.removeChild(i))}o.currentIndex++}return o.listItems.length>0}(a)&&function(e){var t,n=e.wordConverterArgs;if(n)for(n.currentIndex=0;n.currentIndex<n.listItems.length;){var o=n.listItems[n.currentIndex],i=o.originalNode,a=n.lists[o.uniqueListId.toString()];if(!a.ignore){var s=Zn(e,i,o,a);if(s){Xn(i,Kn);var l=i.ownerDocument.createElement("LI");if((0,r.e)(i).startsWith("H")){var c=i.cloneNode(!0);c.style.textIndent="",c.style.marginLeft="",c.style.marginRight="",l.appendChild(c)}else(0,r.nu)(l,i);s.appendChild(l),null===(t=i.parentNode)||void 0===t||t.removeChild(i),"UL"==a.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}n.currentIndex++}e.numBulletsConverted>0||e.numNumberedConverted}(a)),["OL","UL"].forEach((function(e){(0,r.OD)(t.elementCallbacks,e,(function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0}))})),(0,r.OD)(t.cssStyleCallbacks,"line-height",(function(e){var t;return!(lo.test(e)&&!isNaN(t=parseInt(e))&&t<120)})),o=t.elementCallbacks,i=t.cssStyleCallbacks,(0,r.OD)(o,"SPAN",(function(e){var t;return(0,r.$f)(e)[Nn]==Mn&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.OD)(o,"A",(function(e){var t;return(0,r.CP)(e,"HTMLAnchorElement")&&Ln.test(e.href)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.OD)(o,"DIV",(function(e){return(0,r.$f)(e)[Bn]==Fn&&(0,r.nu)(e),!0})),[An,Rn,Pn,On,jn].forEach((function(e){return(0,r.OD)(i,e,(function(){return!1}))}))}function uo(e){var t,n,o,i=e.start,a=e.end;if(i==a&&"DIV"==(0,r.e)(i)){var s=(0,r.fV)(i,"SPAN");e.start=s,e.end=s,s&&s.lastChild&&"BR"==(0,r.e)(s.lastChild)&&s.removeChild(s.lastChild)}else if("BR"==(0,r.e)(a)){(s=null===(t=a.ownerDocument)||void 0===t?void 0:t.createTextNode(""))&&(null===(n=a.parentNode)||void 0===n||n.insertBefore(s,a),e.end=s,null===(o=a.parentNode)||void 0===o||o.removeChild(a))}}function po(e,t,n,o){var i,a,s,l,c=(0,r.jv)(e,t.start),d=n?(0,r.ec)(e,t.end):(0,r.Q$)(e,t.start);if(d)if(null===c||void 0===c?void 0:c.contains(d))(u=null===(i=t.start.ownerDocument)||void 0===i?void 0:i.createElement("br"))&&(null===(a=(n?t.end:t.start).parentNode)||void 0===a||a.insertBefore(u,n?t.end.nextSibling:t.start));else if(o&&o.end==o.start&&"SPAN"==(0,r.e)(o.end)){var u,p=(0,r.Q$)(e,t.start);if(o.end.contains(p)&&!(0,r.W9)(t.start,e,"li"))(u=null===(s=t.start.ownerDocument)||void 0===s?void 0:s.createElement("br"))&&(null===(l=t.start.parentNode)||void 0===l||l.insertBefore(u,t.start))}}var ho=["activeborder","activecaption","appworkspace","background","buttonhighlight","buttonshadow","captiontext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","window","windowframe","windowtext"];var mo=["http:","https:","notes:","mailto:","onenote:"];function go(e){(0,r.OD)(e.attributeCallbacks,"href",(function(e,t){return function(e,t){var n;try{n=new URL(e)}catch(w){n=void 0}if(n&&mo.indexOf(n.protocol)>-1)return e;return t.removeAttribute("href"),""}(e,t)}))}const fo=function(){function e(e,t){void 0===e&&(e="SPAN"),void 0===t&&(t=!1),this.unknownTagReplacement=e,this.convertSingleImageBody=t,this.editor=null}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e.fragment,n=e.sanitizingOption,o=this.editor.getTrustedHTMLHandler();switch((0,r.ZZ)(e,this.convertSingleImageBody)){case 0:co(e);break;case 1:case 2:0!==e.pasteType&&2!==e.pasteType||yn(e,o);break;case 3:!function(e,t){var n=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var i=(new DOMParser).parseFromString(t(o.html),"text/html");(0,r.nu)(n,null===i||void 0===i?void 0:i.body)}}(e,o);break;case 5:In(t,n);break;case 4:n.additionalTagReplacements["google-sheets-html-origin"]="*";break;case 7:!function(e,t){var n=e.fragment,o=e.clipboardData,i=o.html,a=o.image;if(i&&a){var s=(new DOMParser).parseFromString(t(i),"text/html");(0,r.nu)(n,null===s||void 0===s?void 0:s.body)}}(e,o);break;case 6:!function(e){mn(e)?(0,r.LV)((0,r.$r)(e.childNodes),"UL"):(0,r.CP)(e.firstChild,"HTMLElement")&&mn(e.firstChild)&&(0,r.fV)(e.firstChild,"UL")}(t),function(e){for(var t=r.wI.createBodyTraverser(e),n=[],o=null===t||void 0===t?void 0:t.currentBlockElement;o;o=t.getNextBlockElement())n.push({start:o.getStartNode(),end:o.getEndNode()});if(n.length>0){var i=n.length-1;uo(n[0]),uo(n[i]),po(e,n[0],!0),po(e,n[i],!1,n[0])}}(t)}go(n),function(e){["color","background-color"].forEach((function(t){(0,r.OD)(e.cssStyleCallbacks,t,(function(e){return ho.indexOf(e)<0}))}))}(n),function(e){(0,r.OD)(e.cssStyleCallbacks,"display",(function(e){return"flex"!=e}))}(n),n.unknownTagReplacement=this.unknownTagReplacement}},e}();var vo="Backspace",bo=r.Pw.isIE?"Esc":"Escape",yo=r.Pw.isIE?"Left":"ArrowLeft",Co=r.Pw.isIE?"Up":"ArrowUp",So=r.Pw.isIE?"Right":"ArrowRight",ko=r.Pw.isIE?"Down":"ArrowDown",Do=r.Pw.isIE?"Del":"Delete",xo=[0,229];!function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.editor=null,this.eventHandledOnKeyDown=!1,this.blockSuggestions=!1,this.isSuggesting=!1,this.lastKnownRange=null,this.isPendingInputEventHandling=!1,this.currentInputLength=0,this.newInputLength=0}e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){if(t.editor){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){var o;n&&t.editor?(0,i.vQ)(t.editor,n,e,!0):null===(o=t.editor)||void 0===o||o.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.isSuggesting=!1,this.blockSuggestions=!1,this.eventHandledOnKeyDown=!1,this.lastKnownRange=null,this.isPendingInputEventHandling=!1,this.currentInputLength=0,this.newInputLength=0,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var n=[];null===(t=this.editor)||void 0===t||t.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&n.push(e.id)})),this.dataProvider.onContentChanged(n)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){if((0,r.CP)(e,"HTMLElement")){var t=e.attributes.getNamedItem("id");return t?t.value:null}return null},e.prototype.getWordBeforeCursor=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e);return n?n.getWordBefore():null},e.prototype.replaceNode=function(e,t){var n,o=this;null===(n=this.editor)||void 0===n||n.addUndoSnapshot((function(){var n,i;e&&(null===(n=o.editor)||void 0===n||n.deleteNode(e)),t&&(null===(i=o.editor)||void 0===i||i.insertNode(t))}),"Keyboard")},e.prototype.getRangeUntilAt=function(e){var t,n,o,i=this,a=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e),s=void 0,l=void 0;return null===a||void 0===a||a.forEachTextInlineElement((function(e){for(var t=!1,n=e.getTextContent(),o=n?n.length:-1;o>=0;){if(n[o]==i.pickerOptions.triggerCharacter){s=e.getStartPosition().move(o),t=!0;break}o--}return t&&(l=e.getEndPosition()),t})),s?(0,r.Sd)(s,l):null!==(o=null===(n=this.editor)||void 0===n?void 0:n.getDocument().createRange())&&void 0!==o?o:null},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,r.XJ)(e.rawEvent)||this.isSuggesting&&!(0,r.VL)(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){var t,n,o,i,r;if(this.editor)if(this.isSuggesting){if(null!==(s=this.getWord(e))){var a=(l=s.substring(1)).trim();s==this.pickerOptions.triggerCharacter||a&&a.length>0&&a.split(" ").length<=4?(this.dataProvider.queryStringUpdated(a,l==a),this.setLastKnownRange(null!==(t=this.editor.getSelectionRange())&&void 0!==t?t:null)):this.setIsSuggesting(!1)}}else{var s=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=s&&s[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=s&&s.split(" ").length<=4&&(s[0]==this.pickerOptions.triggerCharacter||"("==s[0]&&s[1]==this.pickerOptions.triggerCharacter)){this.setIsSuggesting(!0);var l;a=(l=s.substring(1)).trim();if(this.dataProvider.queryStringUpdated(a,l==a),this.setLastKnownRange(null!==(n=this.editor.getSelectionRange())&&void 0!==n?n:null),this.dataProvider.setCursorPoint){var c=this.editor.getContentSearcherOfCursor(e),d=this.editor.getDocument().createRange();if(d){var u=null!==(i=null===(o=null===c||void 0===c?void 0:c.getInlineElementBefore())||void 0===o?void 0:o.getContainerNode())&&void 0!==i?i:null;if(!this.setRangeStart(d,u,s)){var p=null!==(r=null===u||void 0===u?void 0:u.previousSibling)&&void 0!==r?r:null;this.setRangeStart(d,p,this.pickerOptions.triggerCharacter)}var h=d.getBoundingClientRect();if(0==h.left&&0==h.bottom&&0==h.top&&(h=d.getClientRects()[0]),h){d.detach();var m={x:h.left,y:(h.bottom+h.top)/2},g=(h.bottom-h.top)/2;this.dataProvider.setCursorPoint(m,g)}}}}}},e.prototype.onKeyDownEvent=function(e){var t,n=e.rawEvent;if(this.isSuggesting)if(n.key==bo)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if(n.key==vo){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?n.key==yo||n.key==So:n.key==Co||n.key==ko)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?n.key==So:n.key==ko),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=n.key&&"Tab"!=n.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if(n.key==vo)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(n.key==Do){var o=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e);if(o){var i=o.getInlineElementAfter(),r=i?i.getContainerNode():null,a=(r=this.getParentNodeIfTextNode(r))?this.getIdValue(r):null;if(a&&0==a.indexOf(this.pickerOptions.elementIdPrefix)&&r){var s=this.dataProvider.onRemove(r,!1);this.replaceNode(r,s),this.cancelDefaultKeyDownEvent(e)}}}},e.prototype.getParentNodeIfTextNode=function(e){return(0,r.CP)(e,"Text")&&(e=e.parentNode),e},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){if(!this.editor)return!1;var t=this.editor.getContentSearcherOfCursor(e);if(!t)return!1;var n=t.getInlineElementBefore(),o=n?n.getContainerNode():null,i=(o=this.getParentNodeIfTextNode(o))?this.getIdValue(o):null,a=t.getInlineElementAfter();if(o&&i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)&&(null==a||!(a instanceof r.r$))){var s=this.dataProvider.onRemove(o,!0);return s?(this.replaceNode(o,s),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(s,-3)})):this.editor.select(s,-3),!0):(this.editor.select(o),!1)}return!1},e.prototype.getWord=function(e){var t,n,o=null!==(n=null===(t=this.getRangeUntilAt(e))||void 0===t?void 0:t.toString())&&void 0!==n?n:"",i=this.getWordBeforeCursor(e);return o==this.pickerOptions.triggerCharacter&&o!=i?i:o},e.prototype.setRangeStart=function(e,t,n){var o=(null===t||void 0===t?void 0:t.textContent)?t.textContent.lastIndexOf(n):-1;return!!(t&&o>-1)&&(e.setStart(t,o),!0)},e.prototype.setAriaOwns=function(e){var t;null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){var t;null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e),o=n?n.getInlineElementBefore():null;return o?o.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||void 0==e.rawEvent.key&&xo.indexOf(e.rawEvent.charCode)>-1}}();var To=4,Eo=30;function wo(e,t,n,o,i,a,s,l){var c=e.ownerDocument,d={tag:"div",style:"position: fixed; cursor: "+(o?"row":"col")+"-resize; user-select: none"};null===s||void 0===s||s(d,"CellResizer",e);var u=(0,r.n)(d,c);(l||c.body).appendChild(u);var p={td:e,isRTL:n,zoomScale:t,onStart:i},h=o?Ro:Lo;return h(p,u),{node:e,div:u,featureHandler:new Tt(u,p,h,{onDragStart:_o,onDragging:o?Io:Po,onDragEnd:a},t)}}function _o(e,t){var n=e.td,o=e.isRTL,i=e.zoomScale,a=e.onStart,s=new r.ZX(n,!0,i),l=(0,r.YI)(n.getBoundingClientRect());if(l){a();var c=s.getCellsWithBorder(o?l.left:l.right,!o),d=s.getCellsWithBorder(o?l.left:l.right,o);return{vTable:s,currentCells:c,nextCells:d,initialX:t.pageX}}return{vTable:s,currentCells:[],nextCells:[],initialX:0}}function Io(e,t,n,o,i){var r=e.td,a=e.zoomScale,s=n.vTable;return s.table.removeAttribute("height"),s.table.style.setProperty("height",null),s.forEachCellOfCurrentRow((function(e){var t;e.td&&e.td.style.setProperty("height",e.td==r?(null!==(t=e.height)&&void 0!==t?t:0)/a+i+"px":null)})),s.writeBack(!0),!0}function Po(e,t,n,o){var i=e.isRTL,a=e.zoomScale,s=n.vTable,l=n.nextCells,c=n.currentCells,d=n.initialX;if(!function(e,t,n,o,i){for(var a=0;a<t.length;a++){var s=t[a];if(l=(0,r.YI)(s.getBoundingClientRect()))if((c=Ao(l,e,!o)/i)<Eo)return!1}for(a=0;a<n.length;a++){s=n[a];var l,c=Number.MAX_SAFE_INTEGER;if(s)(l=(0,r.YI)(s.getBoundingClientRect()))&&(c=Ao(l,e,o)/i);if(c<Eo)return!1}return!0}(t.pageX,c,l,i,a))return!1;var u=0==l.length,p=t.shiftKey;(u||p)&&s.table.style.setProperty("width",null);var h=new Map;return c.forEach((function(e){var n=(0,r.YI)(e.getBoundingClientRect());if(n){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box";var o=Ao(n,t.pageX,!i)/a;h.set(e,o)}})),h.forEach((function(e,t){t.style.width=e+"px"})),p||l.forEach((function(e){var t=e.rowSpan>1?0:e.getBoundingClientRect().right-d;e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=e.rowSpan>1?"":t/a-o+"px"})),s.writeBack(!0),!0}function Ao(e,t,n){return n?t-e.left:e.right-t}function Ro(e,t){var n=e.td,o=(0,r.YI)(n.getBoundingClientRect());o&&(t.style.top=o.bottom-To+"px",t.style.left=o.left+"px",t.style.width=o.right-o.left+"px",t.style.height=To+"px")}function Lo(e,t){var n=e.td,o=e.isRTL,i=(0,r.YI)(n.getBoundingClientRect());i&&(t.style.top=i.top+"px",t.style.left=(o?i.left:i.right)-To+1+"px",t.style.width=To+"px",t.style.height=i.bottom-i.top+"px")}var No="#4A4A4A",Mo="white",Oo=12,Bo=1;function Fo(e,t,n,o,i,a,s,l){var c=e.getElementAtCursor("table",t),d=(0,r.YI)(t.getBoundingClientRect()),u=e.getVisibleViewport(),p=c&&u?(0,r.XQ)([c],[u]):null;if(d&&p){var h=t.ownerDocument,m=function(e,t,n,o){var i=t?Mo:No,r=n?"right":"left",a={tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+o+";"+(e?r+": 12px; top: 5px; height: 3px; border-top: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-right: 1px solid "+i+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+i+"; border-right: 1px solid "+i+"; border-bottom: 1px solid "+i+"; border-top: 0px;")};return{tag:"div",style:"position: fixed; width: "+Oo+"px; height: "+Oo+"px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid "+Bo+"px "+i+"; border-radius: 50%; background-color: "+o,children:[a,"+"]}}(o,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white");null===s||void 0===s||s(m,"TableInserter",t);var g=(0,r.n)(m,h);return o?(g.style.left=(n?p.right:p.left-(Oo-1+2*Bo))+"px",g.style.top=d.bottom-8+"px",g.firstChild.style.width=p.right-p.left+"px"):(g.style.left=(n?d.left-8:d.right-8)+"px",g.style.top=p.top-(Oo-1+2*Bo)+"px",g.firstChild.style.height=p.bottom-p.top+"px"),(l||h.body).appendChild(g),{div:g,featureHandler:new jo(g,t,o,e,i,a),node:t}}return null}var jo=function(){function e(e,t,n,o,i,a){var s=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=o,this.onInsert=i,this.insertTd=function(){var e=new r.ZX(s.td);if(s.isHorizontal||(e.normalizeTableCellSize(s.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.setProperty("width",null)),e.edit(s.isHorizontal?1:3),e.writeBack(),s.onInsert(e.table),void 0!=e.row&&void 0!=e.col&&e.cells){var t=s.isHorizontal?{firstCell:{x:0,y:e.row+1},lastCell:{x:e.cells[e.row].length-1,y:e.row+1}}:{firstCell:{x:e.col+1,y:0},lastCell:{x:e.col+1,y:e.cells.length-1}};s.editor.select(e.table,t)}},this.div.addEventListener("click",this.insertTd),this.onMouseOutEvent=a(e),this.div.addEventListener("mouseout",this.onMouseOutEvent)}return e.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.onMouseOutEvent&&this.div.removeEventListener("mouseout",this.onMouseOutEvent),this.onMouseOutEvent=null},e}();var Ho=12,zo=30,Uo=20;function Wo(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new r.ZX(e.table,!0,e.zoomScale)}}function Ko(e,t,n,o,i){var r,a,s=e.isRTL,l=e.zoomScale,c=n.originalRect,d=n.vTable,u=1+o/c.width*l*(s?-1:1),p=1+i/c.height*l,h=Math.abs(u-1)>.001,m=Math.abs(p-1)>.001;if(d.cells&&(h||m)){for(var g=0;g<d.cells.length;g++)for(var f=0;f<d.cells[g].length;f++){var v=d.cells[g][f];if(v.td){if(h){d.table.style.setProperty("width",null);var b=(null!==(r=v.width)&&void 0!==r?r:0)*u/l;v.td.style.boxSizing="border-box",b>=zo&&(v.td.style.wordBreak="break-word",v.td.style.whiteSpace="normal",v.td.style.width=b+"px")}if(m)if(d.table.style.setProperty("height",null),0==f){var y=(null!==(a=v.height)&&void 0!==a?a:0)*p/l;y>=Uo&&(v.td.style.height=y+"px")}else v.td.style.setProperty("height",null)}}return d.writeBack(!0),!0}return!1}function Go(e,t,n){return Zo(e.editor,(0,r.YI)(e.table.getBoundingClientRect()),e.contentDiv)&&(e.div.style.visibility="visible",qo(e,e.div)),e.onEnd(),!1}function qo(e,t){var n=e.table,o=e.isRTL,i=(0,r.YI)(n.getBoundingClientRect());i&&(t.style.top=i.bottom+"px",t.style.left=o?i.left-Ho-2+"px":i.right+"px")}function Vo(e,t){t.style.visibility="hidden"}function Zo(e,t,n){var o=e.getVisibleViewport();if(n&&(0,r.CP)(n,"HTMLElement")&&o&&t){var i=(0,r.YI)(n.getBoundingClientRect());return!!i&&i.bottom>=t.bottom&&o.bottom>=t.bottom}return!0}var Yo=12;function Xo(e,t,n,o,i,a,s){var l=(0,r.YI)(e.getBoundingClientRect());if(!function(e,t,n){var o=e.getVisibleViewport();if(n&&(0,r.CP)(n,"HTMLElement")&&o&&t){var i=(0,r.YI)(n.getBoundingClientRect());return!!i&&i.top<=t.top&&o.top<=t.top}return!0}(t,l,a))return null;var c=t.getZoomScale(),d=e.ownerDocument,u={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"};null===i||void 0===i||i(u,"TableSelector",e);var p=(0,r.n)(u,d);p.id="_Table_Selector",p.style.width=Yo+"px",p.style.height=Yo+"px",(s||d.body).appendChild(p);var h={table:e,zoomScale:c,rect:l,isRTL:"rtl"==(0,r.L9)(e,"direction")};Jo(h,p);var m=new $o(p,h,Jo,{onDragEnd:function(e,t){return t.target==p&&n(e.table),!1}},h.zoomScale,o);return{div:p,featureHandler:m,node:e}}var $o=function(e){function t(t,n,o,i,r,a,s,l){var c=e.call(this,t,n,o,i,r,s)||this;return c.div=t,c.onMouseOut=a(t),t.addEventListener("mouseout",c.onMouseOut),c}return(0,o.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onMouseOut&&this.div.removeEventListener("mouseout",this.onMouseOut),this.onMouseOut=null},t}(Tt);function Jo(e,t){var n=e.rect;n&&(t.style.top=n.top-Yo+"px",t.style.left=n.left-Yo-2+"px")}function Qo(e){var t,n,o;e&&(null===(n=null===(t=e.div)||void 0===t?void 0:t.parentNode)||void 0===n||n.removeChild(e.div),e.div=null,null===(o=e.featureHandler)||void 0===o||o.dispose(),e.featureHandler=null)}var ei;!function(e){e[e.top=0]="top",e[e.side=1]="side"}(ei||(ei={}));var ti=function(){function e(e,t,n,o,i,a){var s=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=o,this.anchorContainer=i,this.contentDiv=a,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableSelector=null,this.start=null,this.end=null,this.onFinishEditing=function(){return s.editor.focus(),s.start&&s.end&&s.editor.select(s.start,s.end),s.editor.addUndoSnapshot((function(){}),"Format"),s.onChanged(),s.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){s.isCurrentlyEditing=!0,s.onStartResize()},this.onStartCellResize=function(){s.isCurrentlyEditing=!0,s.disposeTableResizer(),s.onStartResize()},this.onInserted=function(e){s.editor.transformToDarkColor(e),s.disposeTableResizer(),s.onFinishEditing()},this.onSelect=function(e){if(s.editor.focus(),e){var t=new r.ZX(e);if(t.cells){var n=t.cells.length-1,o=0;t.cells[n].forEach((function(e,t){o=t}));var i={firstCell:{x:0,y:0},lastCell:{y:n,x:o}};s.editor.select(e,i)}}},this.getOnMouseOut=function(e){return function(t){e&&t.relatedTarget!=e&&(0,r.CP)(s.contentDiv,"HTMLElement")&&(0,r.CP)(t.relatedTarget,"HTMLElement")&&!(0,r.gR)(s.contentDiv,t.relatedTarget,!0)&&s.dispose()}},this.isRTL="rtl"==(0,r.L9)(t,"direction"),this.setEditorFeatures(),this.isCurrentlyEditing=!1}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},e.prototype.isEditing=function(){return this.isCurrentlyEditing},e.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableSelector,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter((function(e){return!!(null===e||void 0===e?void 0:e.div)})).some((function(t){return(0,r.gR)(null===t||void 0===t?void 0:t.div,e,!0)}))},e.prototype.onMouseMove=function(e,t){var n,o=(0,r.YI)(this.table.getBoundingClientRect());if(o){for(var i=t<=o.top+6?0:this.isRTL?e>=o.right-6?1:void 0:e<=o.left+6?1:void 0,a=i?1:0,s=0;s<this.table.rows.length;s++){for(var l=this.table.rows[s],c=0;c<l.cells.length;c++){var d=l.cells[c],u=(0,r.YI)(d.getBoundingClientRect());if(u&&o){var p=t<=u.bottom,h=this.isRTL?e<=u.right+6*a:e<=u.right,m=this.isRTL?e>=u.left:e>=u.left-6*a;if(p&&h&&m){if(0===s&&0==i){var g=(u.left+u.right)/2,f=this.isRTL?e<g:e>g;this.setInserterTd(f?d:l.cells[c-1],!1)}else if(0===c&&1==i){var v=null===(n=this.table.rows[s-1])||void 0===n?void 0:n.cells[0],b=v?(0,r.YI)(v.getBoundingClientRect()):null,y=b?this.isRTL?b.right===u.right:b.left===u.left:null;this.setInserterTd(t<(u.top+u.bottom)/2&&y?v:d,!0)}else this.setInserterTd(null);this.setResizingTd(d);break}}}if(c<l.cells.length)break}this.setEditorFeatures()}},e.prototype.setEditorFeatures=function(){this.tableSelector||(this.tableSelector=Xo(this.table,this.editor,this.onSelect,this.getOnMouseOut,this.onShowHelperElement,this.contentDiv,this.anchorContainer)),this.tableResizer||(this.tableResizer=function(e,t,n,o,i,a,s){if(!Zo(t,(0,r.YI)(e.getBoundingClientRect()),a))return null;var l=e.ownerDocument,c="rtl"==(0,r.L9)(e,"direction"),d=t.getZoomScale(),u={tag:"div",style:"position: fixed; cursor: "+(c?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"};null===i||void 0===i||i(u,"TableResizer",e);var p=(0,r.n)(u,l);p.style.width=Ho+"px",p.style.height=Ho+"px",(s||l.body).appendChild(p);var h={isRTL:c,table:e,zoomScale:d,onStart:n,onEnd:o,div:p,editor:t,contentDiv:a};return qo(h,p),{node:e,div:p,featureHandler:new Tt(p,h,Vo,{onDragStart:Wo,onDragging:Ko,onDragEnd:Go},d)}}(this.table,this.editor,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement,this.contentDiv,this.anchorContainer))},e.prototype.setResizingTd=function(e){if(this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e){var t=this.editor.getZoomScale();this.horizontalResizer=wo(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement,this.anchorContainer),this.verticalResizer=wo(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement,this.anchorContainer)}},e.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;if((null===e||n&&n.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var o=Fo(this.editor,e,this.isRTL,!!t,this.onInserted,this.getOnMouseOut,this.onShowHelperElement,this.anchorContainer);t?this.horizontalInserter=o:this.verticalInserter=o}},e.prototype.disposeTableResizer=function(){this.tableResizer&&(Qo(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&(Qo(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&(Qo(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&(Qo(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&(Qo(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableSelector=function(){this.tableSelector&&(Qo(this.tableSelector),this.tableSelector=null)},e.prototype.onStartResize=function(){this.isCurrentlyEditing=!0;var e=this.editor.getSelectionRange();e&&(this.start=r.yX.getStart(e),this.end=r.yX.getEnd(e)),this.editor.addUndoSnapshot()},e}();const ni=ti;!function(){function e(e,t){var n=this;this.onShowHelperElement=e,this.anchorContainerSelector=t,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(e){var t=e.relatedTarget,o=e.currentTarget;(0,r.CP)(t,"HTMLElement")&&(0,r.CP)(o,"HTMLElement")&&n.tableEditor&&!n.tableEditor.isOwnedElement(t)&&!(0,r.gR)(o,t)&&n.setTableEditor(null)},this.onMouseMove=function(e){var t,o=e;if(!(o.buttons>0)&&n.editor){n.ensureTableRects();var i=n.editor.getDocument().defaultView||window,r=o.pageX-i.scrollX,a=o.pageY-i.scrollY,s=null;if(n.tableRectMap)for(var l=n.tableRectMap.length-1;l>=0;l--){var c=n.tableRectMap[l],d=c.table,u=c.rect;if(r>=u.left-12&&r<=u.right+12&&a>=u.top-12&&a<=u.bottom+12){s=d;break}}n.setTableEditor(s,o),null===(t=n.tableEditor)||void 0===t||t.onMouseMove(r,a)}},this.invalidateTableRects=function(){n.tableRectMap=null}}e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove}),this.editor.getScrollContainer().addEventListener("mouseout",this.onMouseOut)},e.prototype.dispose=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getScrollContainer();null===n||void 0===n||n.removeEventListener("mouseout",this.onMouseOut),null===(t=this.onMouseMoveDisposer)||void 0===t||t.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:case 21:this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e,t){if(this.tableEditor&&!this.tableEditor.isEditing()&&e!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.rows.length>0){var n=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new ni(this.editor,e,this.invalidateTableRects,this.onShowHelperElement,(0,r.CP)(n,"HTMLElement")?n:void 0,null===t||void 0===t?void 0:t.currentTarget)}},e.prototype.disposeTableEditor=function(){var e;null===(e=this.tableEditor)||void 0===e||e.dispose(),this.tableEditor=null},e.prototype.ensureTableRects=function(){var e=this;!this.tableRectMap&&this.editor&&(this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=(0,r.YI)(t.getBoundingClientRect());n&&e.tableRectMap&&e.tableRectMap.push({table:t,rect:n})}})))}}();var oi="WATERMARK_WRAPPER",ii=function(){function e(e,t,n){var o=this;this.watermark=e,this.customClass=n,this.editor=null,this.disposer=null,this.showHideWatermark=function(){if(o.editor){var e=o.editor.hasFocus(),t=o.editor.queryElements((0,r.hm)(oi)),n=t.length>0;if(e&&n)t.forEach(o.removeWatermark),o.editor.focus();else if(!e&&!n&&o.editor.isEmpty()){var a=(0,i.FN)(o.editor,oi,o.editor.getDocument().createTextNode(o.watermark),!1,!1,0);o.customClass&&a.wrapper.classList.add(o.customClass)}}},this.removeWatermark=function(e){var t,n=e.parentNode;null===n||void 0===n||n.removeChild(e),n&&(null===(t=o.editor)||void 0===t?void 0:t.contains(n))&&"DIV"==(0,r.e)(n)&&!n.firstChild&&n.appendChild(o.editor.getDocument().createElement("BR"))},this.format=t||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}return e.prototype.updateWatermark=function(e){(this.watermark=e,this.editor)&&(this.editor.queryElements((0,r.hm)(oi)).length>0&&(this.editor.queryElements((0,r.hm)(oi)).forEach(this.removeWatermark),this.showHideWatermark()))},e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(11==e.eventType||7==e.eventType&&(null===(t=e.data)||void 0===t?void 0:t.type)!=oi)this.showHideWatermark();else if(15==e.eventType&&e.entity.type==oi&&this.editor){var n=e.operation,o=e.entity.wrapper;8==n?this.removeWatermark(o):0==e.operation&&((0,r.Wc)(o,this.format,this.editor.isDarkMode(),this.editor.getDarkColorHandler()),o.spellcheck=!1)}},e}();const ri=ii;function ai(e,t){var n;null===t||void 0===t||t.select(null),e&&(e.vTable=null,e.firstTarget=null,e.lastTarget=null,e.tableSelection=!1,e.firstTable=null,e.targetTable=null,null===(n=e.mouseMoveDisposer)||void 0===n||n.call(e),e.mouseMoveDisposer=null)}var si="td,th",li={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){var n=t.getSelectionRangeEx();1==n.type&&t.addUndoSnapshot((function(){n.isWholeTableSelected?n.table.querySelectorAll(si).forEach((function(e){return ci(e,t)})):t.getSelectedRegions().forEach((function(e){return ci(e.rootNode,t)}))}))}};function ci(e,t){if((0,r.CP)(e,"HTMLTableCellElement")){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}}function di(e,t){return e&&e.getElementAtCursor(si,null!==t&&void 0!==t?t:void 0)||t}function ui(e,t){var n;if(null===e||void 0===e?void 0:e.cells)for(var o=0;o<e.cells.length;o++)for(var i=0;i<e.cells[o].length;i++)t==e.cells[o][i].td&&(n={x:i,y:o});return n}function pi(e,t){var n,o,i,a;if(e&&t){if(t.contains(e)){var s=null===(o=(n=e).getBoundingClientRect)||void 0===o?void 0:o.call(n),l=null===(a=(i=t).getBoundingClientRect)||void 0===a?void 0:a.call(i);if(s&&l)return s.top>l.top&&s.bottom<l.bottom}return new r.yX(e,-1).isAfter(new r.yX(t,-1))}return!1}function hi(e,t){return e?e.getElementAtCursor("table",t):null}function mi(e,t){var n,o,i,a;if(e.firstTable&&e.targetTable){var s=e.lastTarget!=e.firstTarget&&(null===(n=e.firstTable)||void 0===n?void 0:n.contains((0,r.W9)(e.targetTable,e.firstTable,si)));if(s&&e.tableSelection)for(;s;)e.lastTarget=(0,r.W9)(e.targetTable,e.firstTable,si),e.targetTable=hi(t,e.lastTarget),s=e.lastTarget!=e.firstTarget&&(null===(o=e.firstTable)||void 0===o?void 0:o.contains((0,r.W9)(e.targetTable,e.firstTable,si)));var l=e.lastTarget!=e.firstTarget&&(null===(i=e.targetTable)||void 0===i?void 0:i.contains((0,r.W9)(e.firstTable,e.targetTable,si)));if(l&&e.tableSelection&&e.targetTable)for(;l;){if(e.firstTarget=(0,r.W9)(e.firstTable,e.targetTable,si),!e.firstTarget)return;e.firstTable=hi(t,e.firstTarget),l=e.lastTarget!=e.firstTarget&&(null===(a=e.targetTable)||void 0===a?void 0:a.contains((0,r.W9)(e.firstTable,e.targetTable,si)))}}}function gi(e){var t=(null===e||void 0===e?void 0:e.selection)||{},n=t.firstCell,o=t.lastCell;if(!(null===e||void 0===e?void 0:e.cells)||!e.selection||!n||!o)return null;var i=e.cells,r={x:Math.min(n.x,o.x),y:Math.min(n.y,o.y)},a={x:Math.max(n.x,o.x),y:Math.max(n.y,o.y)},s=function(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=i.length&&(e.y=i.length-1);var t=i[e.y].length;e.x>=t&&(e.x=t-1)};return s(r),s(a),{firstCell:r,lastCell:a}}function fi(e,t){e&&t.vTable&&(null===e||void 0===e||e.select(t.vTable.table,gi(t.vTable)))}function vi(e,t,n){var o=n.getFocusedPosition();o&&(t.firstTarget=t.firstTarget||di(n,o.node),t.firstTarget.nodeType==Node.TEXT_NODE&&(t.firstTarget=n.getElementAtCursor(si,t.firstTarget)),!n.contains(t.firstTarget)&&t.lastTarget&&(t.firstTarget=t.lastTarget)),t.firstTable=hi(n,t.firstTarget),t.lastTarget=di(n,e),t.targetTable=hi(n,t.lastTarget)}function bi(e,t,n,o,i){var r,a=null===(r=e.getDocument().defaultView)||void 0===r?void 0:r.getSelection();a&&(o=o||t,i=i||n,a.setBaseAndExtent(t,n,o,i))}function yi(e,t,n){var o=e.rawEvent,i=o.shiftKey,a=o.ctrlKey,s=o.metaKey,l=o.which,c=o.defaultPrevented;if(i&&(a||s)||16==l||c)t.preventKeyUp=c;else{var d=n.getSelectionRangeEx();if(i){if(!t.firstTarget){var u=n.getFocusedPosition(),p=u&&di(n,u.node);t.firstTarget=p}if(!(0,r.CP)(t.firstTarget,"HTMLTableCellElement"))return;n.runAsync((function(n){var o=n.getFocusedPosition(),i=t.tableSelection?t.lastTarget:null===o||void 0===o?void 0:o.node;if(i&&vi(i,t,n),t.firstTable==t.targetTable){if(!function(e,t){if(!e.firstTable||!t)return!1;var n=t.getSelectedRegions();if(1==n.length)return!1;var o=!0;return n.forEach((function(t){(0,r.gR)(e.firstTable,t.rootNode)||(o=!1)})),o}(t,n)&&!t.tableSelection)return;!function(e,t,n){var o,i;t.firstTarget=di(n,t.firstTarget),t.lastTarget=di(n,t.lastTarget),bi(n,t.firstTarget,0),t.vTable=t.vTable||new r.ZX(t.firstTable);var a=ui(t.vTable,t.firstTarget),s=function(e,t,n){var o;if(n.lastTarget=n.lastTarget&&t.getElementAtCursor(si,n.lastTarget),(0,r.CP)(n.lastTarget,"HTMLTableCellElement")&&(null===(o=n.vTable)||void 0===o?void 0:o.cells)){var i=ui(n.vTable,n.lastTarget);if(n.tableSelection&&i)switch(e.rawEvent.which){case 39:i.x+=n.lastTarget.colSpan,null==n.vTable.cells[i.y][i.x]&&(i.x=n.vTable.cells[i.y].length-1,i.y++);break;case 37:0==i.x?i.y--:i.x--;break;case 38:i.y--;break;case 40:i.y++}return i&&i.y>=0&&i.x>=0&&(n.lastTarget=n.vTable.getTd(i.y,i.x)),i}return}(e,n,t);if(!a||!s)return;t.vTable.selection={firstCell:a,lastCell:s};var l=t.vTable.selection;if(!l.lastCell||t.vTable.cells&&l.lastCell.y>t.vTable.cells.length-1||-1==l.lastCell.y)if(t.lastTarget=n.getElementAtCursor(si+",div",null!==(o=t.firstTable)&&void 0!==o?o:void 0),(0,r.CP)(t.lastTarget,"HTMLTableCellElement"))mi(t,n);else{var c=t.targetTable&&new r.yX(t.targetTable,null==l.lastCell.y||-1==l.lastCell.y?-2:-3),d=null===(i=n.getDocument().defaultView)||void 0===i?void 0:i.getSelection(),u=d||{},p=u.anchorNode,h=u.anchorOffset;if(d&&p&&void 0!=h&&null!=h&&c)return n.select(d.getRangeAt(0)),d.setBaseAndExtent(p,h,c.node,c.offset),t.lastTarget=c.node,void e.rawEvent.preventDefault()}fi(n,t);var m=pi(t.firstTarget,t.lastTarget);if(t.lastTarget){var g=new r.yX(t.lastTarget,m?0:-1);bi(n,g.node,g.offset)}t.tableSelection=!0,e.rawEvent.preventDefault()}(e,t,n)}else t.tableSelection&&(t.firstTable&&n.select(t.firstTable,null),t.tableSelection=!1)}))}else if(1==(null===d||void 0===d?void 0:d.type)&&(!(0,r.tD)(e.rawEvent)||36==l||35==l)){var h=d.ranges[0],m=h.startContainer.childNodes[h.startOffset].childNodes,g=(0,r.Sd)(m[0],m[m.length-1]);n.select(g)}}}var Ci=[16,18,91,17,44];function Si(e,t){if(e.lastTarget&&e.firstTarget){e.firstTable&&t.select(e.firstTable,null),e.tableSelection=!1;var n=pi(e.firstTarget,e.lastTarget),o=new r.yX(e.lastTarget,n?-1:0),i=new Range;e.firstTarget&&i.selectNodeContents(e.firstTarget),bi(t,e.firstTarget,n?r.yX.getEnd(i).offset:r.yX.getStart(i).offset,o.element,o.offset)}}function ki(e,t,n){var o,i=e.rawEvent,a=i.which,s=i.shiftKey,l=i.target,c=i.detail,d=n.getElementAtCursor("table",l,e),u=c>=3;if(!d||d.isContentEditable){var p=n.getElementAtCursor(si);if(3==a&&t.tableSelection&&t.vTable&&p){var h=ui(t.vTable,p);if(h){var m=gi(t.vTable)||{},g=m.firstCell,f=m.lastCell;if(g&&f&&h.y>=g.y&&h.y<=f.y&&h.x>=g.x&&h.x<=f.x){if(t.firstTarget=t.vTable.getCell(g.y,g.x).td,t.lastTarget=t.vTable.getCell(f.y,f.x).td,t.firstTarget&&t.lastTarget){var v=null===(o=n.getDocument().defaultView)||void 0===o?void 0:o.getSelection();null===v||void 0===v||v.setBaseAndExtent(t.firstTarget,0,t.lastTarget,0),fi(n,t)}return}}}if(1==a){if(!s&&!u&&(ai(t,n),hi(n,e.rawEvent.target))){var b=n.getDocument()||document,y=function(e){return function(){!function(e){var t;e.startedSelection&&(e.startedSelection=!1,null===(t=e.mouseMoveDisposer)||void 0===t||t.call(e))}(e)}}(t),C=function(e,t){return function(n){if(t.contains(n.target)){if(e.tableSelection&&e.firstTarget&&(0,r.gR)(e.lastTarget,n.target,!0))return bi(t,e.firstTarget,0),void n.preventDefault();if("TABLE"!=(0,r.e)(n.target)){if(vi(n.target,e,t),!e.firstTarget||e.firstTable)if(!e.lastTarget||(e.lastTarget.lastChild!=e.lastTarget.firstChild||"TABLE"!=(0,r.e)(e.lastTarget.lastChild)||"DIV"!=(0,r.e)(e.lastTarget))&&t.contains(e.lastTarget)){mi(e,t);var o=!!(0,r.CP)(e.lastTarget,"HTMLTableCellElement")&&(0,r.gR)(e.lastTarget,e.firstTable);e.firstTable&&e.firstTable==e.targetTable||o?function(e,t,n){var o;if(t.firstTarget&&t.firstTable&&t.lastTarget!=t.firstTarget&&t.lastTarget){if(bi(n,t.firstTarget,0),t.firstTable!=t.targetTable&&(null===(o=t.targetTable)||void 0===o?void 0:o.contains(t.firstTable))&&(t.firstTarget=n.getElementAtCursor(si,t.lastTarget)),t.firstTable&&t.firstTarget){t.tableSelection=!0,t.vTable=t.vTable||new r.ZX(t.firstTable);var i=ui(t.vTable,t.firstTarget),a=ui(t.vTable,t.lastTarget);if(!i||!a)return;t.vTable.selection={firstCell:i,lastCell:a},fi(n,t)}e.preventDefault()}else if(t.lastTarget==t.firstTarget&&t.tableSelection&&t.firstTable&&t.firstTarget){t.vTable=new r.ZX(t.firstTable);var s=ui(t.vTable,t.firstTarget);s&&(t.vTable.selection={firstCell:s,lastCell:s}),fi(n,t)}}(n,e,t):e.tableSelection&&Si(e,t),e.tableSelection&&e.firstTarget&&(bi(t,e.firstTarget,0),n.preventDefault())}else n.preventDefault()}else n.preventDefault()}}}(t,n);b.addEventListener("mouseup",y,!0),b.addEventListener("mousemove",C,!0),t.mouseMoveDisposer=function(){b.removeEventListener("mouseup",y,!0),b.removeEventListener("mousemove",C,!0)},t.startedSelection=!0}(s||u)&&n.runAsync((function(e){var n,o=null===(n=e.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),i=di(e,null===o||void 0===o?void 0:o.anchorNode),a=u?i:di(e,null===o||void 0===o?void 0:o.focusNode),s=hi(e,i);if(s&&(0,r.CP)(i,"HTMLTableCellElement")&&(0,r.CP)(a,"HTMLTableCellElement")){t.vTable=new r.ZX(i);var l=ui(t.vTable,i),c=ui(t.vTable,a);if(!l||!c)return;t.vTable.selection={firstCell:l,lastCell:c},t.firstTarget=i,t.lastTarget=a,fi(e,t),t.tableSelection=!0,t.firstTable=s,t.targetTable=s,bi(e,i,0)}}))}}}!function(){function e(){this.editor=null,this.state={firstTable:null,lastTarget:null,firstTarget:null,preventKeyUp:!1,startedSelection:!1,tableSelection:!1,targetTable:null,vTable:null,mouseMoveDisposer:null}}e.prototype.getName=function(){return"TableCellSelection"},e.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(li)},e.prototype.dispose=function(){ai(this.state,this.editor),this.state=null,this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&this.state)switch(e.eventType){case 5:this.state.startedSelection||ki(e,this.state,this.editor);break;case 0:this.state.startedSelection?e.rawEvent.preventDefault():yi(e,this.state,this.editor);break;case 2:this.state.startedSelection?e.rawEvent.preventDefault():function(e,t,n){var o=e.rawEvent,i=o.shiftKey,a=o.which,s=o.ctrlKey;i||s||!t.firstTarget||t.preventKeyUp||-1!=Ci.indexOf(a)||((0,r.XJ)(e.rawEvent)&&n.addUndoSnapshot(),ai(t,n)),t.preventKeyUp=!1}(e,this.state,this.editor);break;case 14:this.state.startedSelection&&function(e,t){var n,o=t.getElementAtCursor();if(o)if(vi(o,e,t),e.firstTable==e.targetTable&&e.firstTarget&&(null===(n=e.vTable)||void 0===n?void 0:n.selection)&&e.lastTarget&&e.tableSelection){var i=ui(e.vTable,e.lastTarget);i&&(e.vTable.selection.lastCell=i,fi(t,e),bi(t,e.firstTarget,0))}else e.tableSelection&&Si(e,t)}(this.state,this.editor);break;case 20:this.state.firstTable=null,this.state.tableSelection=!1,this.editor.select(null)}}}();var Di=/[`!@#$%^&*()_+\=\[\]{};':"\\|,.<>\/?~]/;!function(){function e(){this.editor=null,this.lastKeyTyped=null}e.prototype.getName=function(){return"AutoFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.lastKeyTyped=null},e.prototype.onPluginEvent=function(e){var t=this;if(this.editor&&(7!==e.eventType&&5!==e.eventType&&6!==e.eventType||(this.lastKeyTyped=""),1===e.eventType)){var n=e.rawEvent.key;if(n&&n.length>1&&(this.lastKeyTyped=""),"-"!==this.lastKeyTyped||Di.test(n)||"-"===n)this.lastKeyTyped=n;else{var o=this.editor.getContentSearcherOfCursor(e),i=null===o||void 0===o?void 0:o.getSubStringBefore(3),r=null===o||void 0===o?void 0:o.getSubStringBefore(2);if("-"===(null===i||void 0===i?void 0:i[0])||(" --"==i&&" "!==n||" --"!==i&&" "===n)||"string"===typeof i&&Di.test(i[0])||"--"!==r)return;var a=null===o||void 0===o?void 0:o.getRangeFromText(r,!0),s=" --"===i&&" "===n?document.createTextNode("\u2013"):document.createTextNode("\u2014");this.editor.addUndoSnapshot((function(){a&&(a.deleteContents(),a.insertNode(s),t.editor.select(s,-1))}),"Format",!0,{formatApiName:"autoHyphen"}),this.lastKeyTyped=null}}}}();var xi="td,th",Ti={announceNewListItem:{keys:[13],shouldHandle:function(e){var t=e.getElementAtCursor("LI"),n=e.getElementAtCursor("OL,UL");return!(!n||!t)&&E(n,t)||!1}},announceWarningOnLastTableCell:{shouldHandle:function(e,t){var n=e.getSelectionRangeEx();return 0==(null===n||void 0===n?void 0:n.type)&&n.areAllCollapsed&&1===n.ranges.length&&!(0,r.gR)(t,n.ranges[0].startContainer,!0)&&function(){var t=e.getElementAtCursor("table");if((0,r.CP)(t,"HTMLTableElement")){var n=t.querySelectorAll(xi);return e.getElementAtCursor(xi)==n.item(n.length-1)}return!1}()&&{defaultStrings:3}},keys:[9,38,40,37,39]}};!function(){function e(e,t,n){void 0===t&&(t=[]),this.stringsMapOrGetter=e,this.lastFocusedElement=null,this.features=(0,r.Co)(Ti).map((function(e){if(-1==t.indexOf(e))return Ti[e]})).filter((function(e){return!!e})).concat(n||[])}e.prototype.getName=function(){return"Announce"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e,t;for(null===(t=null===(e=this.ariaLiveElement)||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(this.ariaLiveElement),this.ariaLiveElement=void 0,this.stringsMapOrGetter=void 0,this.lastFocusedElement=null;this.features.length>0;)this.features.pop();this.editor=void 0},e.prototype.onPluginEvent=function(e){var t;if(this.editor&&7==e.eventType&&(null===(t=e.additionalData)||void 0===t?void 0:t.getAnnounceData)){var n=e.additionalData.getAnnounceData();n&&this.announce(n,this.editor)}0==e.eventType&&this.editor&&this.handleFeatures(e,this.editor)},e.prototype.handleFeatures=function(e,t){var n=this;t.runAsync((function(t){n.features.filter((function(t){return t.keys.indexOf(e.rawEvent.which)>-1})).some((function(e){var o=e.shouldHandle(t,n.lastFocusedElement);return o&&n.announce(o,t),!!o})),n.lastFocusedElement=t.getElementAtCursor()}))},e.prototype.announce=function(e,t){var n,o,i,a=e.text,s=e.defaultStrings,l=e.formatStrings,c=void 0===l?[]:l,d=function(e,t){if(void 0==e)return e;return t.forEach((function(t,n){e=null===e||void 0===e?void 0:e.replace("{"+n+"}",t)})),e}(this.getString(s)||a,c);d&&(this.ariaLiveElement&&d!=(null===(n=this.ariaLiveElement)||void 0===n?void 0:n.textContent)||(null===(i=null===(o=this.ariaLiveElement)||void 0===o?void 0:o.parentElement)||void 0===i||i.removeChild(this.ariaLiveElement),this.ariaLiveElement=function(e){var t=(0,r.n)({tag:"div",style:"clip: rect(0px, 0px, 0px, 0px); clip-path: inset(100%); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px;",attributes:{"aria-live":"assertive"}},e);return e.body.appendChild(t),t}(t.getDocument())),this.ariaLiveElement&&(this.ariaLiveElement.textContent=d))},e.prototype.getString=function(e){if(void 0!=this.stringsMapOrGetter&&void 0!=e)return"function"===typeof this.stringsMapOrGetter?this.stringsMapOrGetter(e):this.stringsMapOrGetter.get(e)},e.prototype.getAriaLiveElement=function(){return this.ariaLiveElement}}()},10480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},16398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleAlignment=void 0,function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.CompatibleAlignment||(t.CompatibleAlignment={}))},56495:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleBulletListType=void 0,function(e){e[e.Min=1]="Min",e[e.Disc=1]="Disc",e[e.Dash=2]="Dash",e[e.Square=3]="Square",e[e.ShortArrow=4]="ShortArrow",e[e.LongArrow=5]="LongArrow",e[e.UnfilledArrow=6]="UnfilledArrow",e[e.Hyphen=7]="Hyphen",e[e.DoubleLongArrow=8]="DoubleLongArrow",e[e.Circle=9]="Circle",e[e.Max=9]="Max"}(t.CompatibleBulletListType||(t.CompatibleBulletListType={}))},56887:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleCapitalization=void 0,function(e){e.Sentence="sentence",e.Lowercase="lowercase",e.Uppercase="uppercase",e.CapitalizeEachWord="capitalize"}(t.CompatibleCapitalization||(t.CompatibleCapitalization={}))},35846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleChangeSource=void 0,function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop",e.InsertEntity="InsertEntity",e.SwitchToDarkMode="SwitchToDarkMode",e.SwitchToLightMode="SwitchToLightMode",e.ListChain="ListChain",e.Keyboard="Keyboard"}(t.CompatibleChangeSource||(t.CompatibleChangeSource={}))},52858:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleClearFormatMode=void 0,function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block",e[e.AutoDetect=2]="AutoDetect"}(t.CompatibleClearFormatMode||(t.CompatibleClearFormatMode={}))},96337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleColorTransformDirection=void 0,function(e){e[e.LightToDark=0]="LightToDark",e[e.DarkToLight=1]="DarkToLight"}(t.CompatibleColorTransformDirection||(t.CompatibleColorTransformDirection={}))},28477:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentPosition=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.DomEnd=2]="DomEnd",e[e.SelectionStart=3]="SelectionStart",e[e.Outside=4]="Outside",e[e.Range=5]="Range"}(t.CompatibleContentPosition||(t.CompatibleContentPosition={}))},71438:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentType=t.CompatibleContentTypePrefix=void 0,function(e){e.Text="text/",e.Image="image/"}(t.CompatibleContentTypePrefix||(t.CompatibleContentTypePrefix={})),function(e){e.PlainText="text/plain",e.HTML="text/html"}(t.CompatibleContentType||(t.CompatibleContentType={}))},67580:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDarkModeDatasetNames=void 0,function(e){e.OriginalStyleColor="ogsc",e.OriginalStyleBackgroundColor="ogsb",e.OriginalAttributeColor="ogac",e.OriginalAttributeBackgroundColor="ogab"}(t.CompatibleDarkModeDatasetNames||(t.CompatibleDarkModeDatasetNames={}))},28994:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDefinitionType=void 0,function(e){e[e.Boolean=0]="Boolean",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Array=3]="Array",e[e.Object=4]="Object",e[e.Customize=5]="Customize"}(t.CompatibleDefinitionType||(t.CompatibleDefinitionType={}))},61048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDelimiterClasses=void 0,function(e){e.DELIMITER_BEFORE="entityDelimiterBefore",e.DELIMITER_AFTER="entityDelimiterAfter"}(t.CompatibleDelimiterClasses||(t.CompatibleDelimiterClasses={}))},8066:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDirection=void 0,function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(t.CompatibleDirection||(t.CompatibleDirection={}))},40337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentCommand=void 0,function(e){e.AutoUrlDetect="AutoUrlDetect",e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(t.CompatibleDocumentCommand||(t.CompatibleDocumentCommand={}))},76617:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentPosition=void 0,function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(t.CompatibleDocumentPosition||(t.CompatibleDocumentPosition={}))},33898:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityClasses=void 0,function(e){e.ENTITY_INFO_NAME="_Entity",e.ENTITY_TYPE_PREFIX="_EType_",e.ENTITY_ID_PREFIX="_EId_",e.ENTITY_READONLY_PREFIX="_EReadonly_"}(t.CompatibleEntityClasses||(t.CompatibleEntityClasses={}))},85887:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityOperation=void 0,function(e){e[e.NewEntity=0]="NewEntity",e[e.Click=1]="Click",e[e.ContextMenu=2]="ContextMenu",e[e.Escape=3]="Escape",e[e.RemoveFromStart=4]="RemoveFromStart",e[e.RemoveFromEnd=5]="RemoveFromEnd",e[e.Overwrite=6]="Overwrite",e[e.PartialOverwrite=7]="PartialOverwrite",e[e.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",e[e.AddShadowRoot=9]="AddShadowRoot",e[e.RemoveShadowRoot=10]="RemoveShadowRoot",e[e.UpdateEntityState=11]="UpdateEntityState"}(t.CompatibleEntityOperation||(t.CompatibleEntityOperation={}))},64610:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleExperimentalFeatures=void 0,function(e){e.NewIndentation="NewIndentation",e.NewBullet="NewBullet",e.NewNumbering="NewNumbering",e.ListChain="ListChain",e.MergePastedLine="MergePastedLine",e.SingleDirectionResize="SingleDirectionResize",e.PasteWithLinkPreview="PasteWithLinkPreview",e.ImageRotate="ImageRotate",e.ImageCrop="ImageCrop",e.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",e.ConvertSingleImageBody="ConvertSingleImageBody",e.TableAlignment="TableAlignment",e.AdaptiveHandlesResizer="AdaptiveHandlesResizer",e.AutoHyphen="AutoHyphen",e.PendingStyleBasedFormat="PendingStyleBasedFormat",e.NormalizeList="NormalizeList",e.ImageSelection="ImageSelection",e.VariableBasedDarkColor="VariableBasedDarkColor",e.ListItemAlignment="ListItemAlignment",e.DefaultFormatInSpan="DefaultFormatInSpan",e.DefaultFormatOnContainer="DefaultFormatOnContainer",e.ReusableContentModel="ReusableContentModel",e.EditWithContentModel="EditWithContentModel",e.AutoFormatList="AutoFormatList",e.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",e.ContentModelPaste="ContentModelPaste",e.TabKeyTextFeatures="TabKeyTextFeatures",e.ReuseAllAncestorListElements="ReuseAllAncestorListElements",e.DeleteTableWithBackspace="DeleteTableWithBackspace",e.DisableListChain="DisableListChain"}(t.CompatibleExperimentalFeatures||(t.CompatibleExperimentalFeatures={}))},90819:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleFontSizeChange=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.CompatibleFontSizeChange||(t.CompatibleFontSizeChange={}))},44049:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleGetContentMode=void 0,function(e){e[e.CleanHTML=0]="CleanHTML",e[e.RawHTMLOnly=1]="RawHTMLOnly",e[e.RawHTMLWithSelection=2]="RawHTMLWithSelection",e[e.PlainText=3]="PlainText",e[e.PlainTextFast=4]="PlainTextFast"}(t.CompatibleGetContentMode||(t.CompatibleGetContentMode={}))},34285:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleImageEditOperation=void 0,function(e){e[e.None=0]="None",e[e.CornerResize=1]="CornerResize",e[e.SideResize=2]="SideResize",e[e.Resize=3]="Resize",e[e.Rotate=4]="Rotate",e[e.ResizeAndRotate=7]="ResizeAndRotate",e[e.Crop=8]="Crop",e[e.All=15]="All"}(t.CompatibleImageEditOperation||(t.CompatibleImageEditOperation={}))},87492:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleIndentation=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.CompatibleIndentation||(t.CompatibleIndentation={}))},22203:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKeys=void 0,function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL_LEFT=17]="CTRL_LEFT",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGEUP=33]="PAGEUP",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.DELETE=46]="DELETE",e[e.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",e[e.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.COMMA=188]="COMMA",e[e.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_TILDE=192]="GRAVE_TILDE",e[e.CONTENTCHANGED=257]="CONTENTCHANGED",e[e.RANGE=258]="RANGE",e[e.Ctrl=4096]="Ctrl",e[e.Meta=8192]="Meta",e[e.Shift=16384]="Shift"}(t.CompatibleKeys||(t.CompatibleKeys={}))},78073:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownAnnounceStrings=void 0,function(e){e[e.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",e[e.AnnounceListItemBullet=2]="AnnounceListItemBullet",e[e.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"}(t.CompatibleKnownAnnounceStrings||(t.CompatibleKnownAnnounceStrings={}))},42716:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownCreateElementDataIndex=void 0,function(e){e[e.None=0]="None",e[e.EmptyLine=1]="EmptyLine",e[e.BlockquoteWrapper=2]="BlockquoteWrapper",e[e.CopyPasteTempDiv=3]="CopyPasteTempDiv",e[e.BlockListItem=4]="BlockListItem",e[e.ContextMenuWrapper=5]="ContextMenuWrapper",e[e.ImageEditWrapper=6]="ImageEditWrapper",e[e.TableHorizontalResizer=7]="TableHorizontalResizer",e[e.TableVerticalResizer=8]="TableVerticalResizer",e[e.TableResizerLTR=9]="TableResizerLTR",e[e.TableResizerRTL=10]="TableResizerRTL",e[e.TableSelector=11]="TableSelector",e[e.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"}(t.CompatibleKnownCreateElementDataIndex||(t.CompatibleKnownCreateElementDataIndex={}))},1516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownPasteSourceType=void 0,function(e){e[e.WordDesktop=0]="WordDesktop",e[e.ExcelDesktop=1]="ExcelDesktop",e[e.ExcelOnline=2]="ExcelOnline",e[e.PowerPointDesktop=3]="PowerPointDesktop",e[e.GoogleSheets=4]="GoogleSheets",e[e.WacComponents=5]="WacComponents",e[e.Default=6]="Default",e[e.SingleImage=7]="SingleImage"}(t.CompatibleKnownPasteSourceType||(t.CompatibleKnownPasteSourceType={}))},83463:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleListType=void 0,function(e){e[e.None=0]="None",e[e.Ordered=1]="Ordered",e[e.Unordered=2]="Unordered"}(t.CompatibleListType||(t.CompatibleListType={}))},22419:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNodeType=void 0,function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(t.CompatibleNodeType||(t.CompatibleNodeType={}))},444:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNumberingListType=void 0,function(e){e[e.Min=1]="Min",e[e.Decimal=1]="Decimal",e[e.DecimalDash=2]="DecimalDash",e[e.DecimalParenthesis=3]="DecimalParenthesis",e[e.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",e[e.LowerAlpha=5]="LowerAlpha",e[e.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",e[e.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",e[e.LowerAlphaDash=8]="LowerAlphaDash",e[e.UpperAlpha=9]="UpperAlpha",e[e.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",e[e.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",e[e.UpperAlphaDash=12]="UpperAlphaDash",e[e.LowerRoman=13]="LowerRoman",e[e.LowerRomanParenthesis=14]="LowerRomanParenthesis",e[e.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",e[e.LowerRomanDash=16]="LowerRomanDash",e[e.UpperRoman=17]="UpperRoman",e[e.UpperRomanParenthesis=18]="UpperRomanParenthesis",e[e.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",e[e.UpperRomanDash=20]="UpperRomanDash",e[e.Max=20]="Max"}(t.CompatibleNumberingListType||(t.CompatibleNumberingListType={}))},31768:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePasteType=void 0,function(e){e[e.Normal=0]="Normal",e[e.AsPlainText=1]="AsPlainText",e[e.MergeFormat=2]="MergeFormat",e[e.AsImage=3]="AsImage"}(t.CompatiblePasteType||(t.CompatiblePasteType={}))},50442:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePluginEventType=void 0,function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.Input=3]="Input",e[e.CompositionEnd=4]="CompositionEnd",e[e.MouseDown=5]="MouseDown",e[e.MouseUp=6]="MouseUp",e[e.ContentChanged=7]="ContentChanged",e[e.ExtractContentWithDom=8]="ExtractContentWithDom",e[e.BeforeCutCopy=9]="BeforeCutCopy",e[e.BeforePaste=10]="BeforePaste",e[e.EditorReady=11]="EditorReady",e[e.BeforeDispose=12]="BeforeDispose",e[e.PendingFormatStateChanged=13]="PendingFormatStateChanged",e[e.Scroll=14]="Scroll",e[e.EntityOperation=15]="EntityOperation",e[e.ContextMenu=16]="ContextMenu",e[e.EnteredShadowEdit=17]="EnteredShadowEdit",e[e.LeavingShadowEdit=18]="LeavingShadowEdit",e[e.EditImage=19]="EditImage",e[e.BeforeSetContent=20]="BeforeSetContent",e[e.ZoomChanged=21]="ZoomChanged",e[e.SelectionChanged=22]="SelectionChanged",e[e.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"}(t.CompatiblePluginEventType||(t.CompatiblePluginEventType={}))},11912:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePositionType=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(t.CompatiblePositionType||(t.CompatiblePositionType={}))},4871:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleQueryScope=void 0,function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(t.CompatibleQueryScope||(t.CompatibleQueryScope={}))},37739:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleRegionType=void 0,function(e){e[e.Table=0]="Table"}(t.CompatibleRegionType||(t.CompatibleRegionType={}))},73367:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleSelectionRangeTypes=void 0,function(e){e[e.Normal=0]="Normal",e[e.TableSelection=1]="TableSelection",e[e.ImageSelection=2]="ImageSelection"}(t.CompatibleSelectionRangeTypes||(t.CompatibleSelectionRangeTypes={}))},24274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableBorderFormat=void 0,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",e[e.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",e[e.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",e[e.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",e[e.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",e[e.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",e[e.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",e[e.CLEAR=8]="CLEAR"}(t.CompatibleTableBorderFormat||(t.CompatibleTableBorderFormat={}))},48310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=void 0,function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.MergeCells=11]="MergeCells",e[e.SplitHorizontally=12]="SplitHorizontally",e[e.SplitVertically=13]="SplitVertically",e[e.AlignCenter=14]="AlignCenter",e[e.AlignLeft=15]="AlignLeft",e[e.AlignRight=16]="AlignRight",e[e.AlignCellLeft=17]="AlignCellLeft",e[e.AlignCellCenter=18]="AlignCellCenter",e[e.AlignCellRight=19]="AlignCellRight",e[e.AlignCellTop=20]="AlignCellTop",e[e.AlignCellMiddle=21]="AlignCellMiddle",e[e.AlignCellBottom=22]="AlignCellBottom"}(t.CompatibleTableOperation||(t.CompatibleTableOperation={}))},13368:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=t.CompatibleTableBorderFormat=t.CompatibleSelectionRangeTypes=t.CompatibleRegionType=t.CompatibleQueryScope=t.CompatiblePositionType=t.CompatiblePluginEventType=t.CompatiblePasteType=t.CompatibleNumberingListType=t.CompatibleNodeType=t.CompatibleListType=t.CompatibleKnownPasteSourceType=t.CompatibleKnownCreateElementDataIndex=t.CompatibleKnownAnnounceStrings=t.CompatibleKeys=t.CompatibleIndentation=t.CompatibleImageEditOperation=t.CompatibleGetContentMode=t.CompatibleFontSizeChange=t.CompatibleExperimentalFeatures=t.CompatibleEntityOperation=t.CompatibleEntityClasses=t.CompatibleDocumentPosition=t.CompatibleDocumentCommand=t.CompatibleDirection=t.CompatibleDelimiterClasses=t.CompatibleDefinitionType=t.CompatibleDarkModeDatasetNames=t.CompatibleContentType=t.CompatibleContentTypePrefix=t.CompatibleContentPosition=t.CompatibleColorTransformDirection=t.CompatibleClearFormatMode=t.CompatibleChangeSource=t.CompatibleCapitalization=t.CompatibleBulletListType=t.CompatibleAlignment=void 0;var o=n(16398);Object.defineProperty(t,"CompatibleAlignment",{enumerable:!0,get:function(){return o.CompatibleAlignment}});var i=n(56495);Object.defineProperty(t,"CompatibleBulletListType",{enumerable:!0,get:function(){return i.CompatibleBulletListType}});var r=n(56887);Object.defineProperty(t,"CompatibleCapitalization",{enumerable:!0,get:function(){return r.CompatibleCapitalization}});var a=n(35846);Object.defineProperty(t,"CompatibleChangeSource",{enumerable:!0,get:function(){return a.CompatibleChangeSource}});var s=n(52858);Object.defineProperty(t,"CompatibleClearFormatMode",{enumerable:!0,get:function(){return s.CompatibleClearFormatMode}});var l=n(96337);Object.defineProperty(t,"CompatibleColorTransformDirection",{enumerable:!0,get:function(){return l.CompatibleColorTransformDirection}});var c=n(28477);Object.defineProperty(t,"CompatibleContentPosition",{enumerable:!0,get:function(){return c.CompatibleContentPosition}});var d=n(71438);Object.defineProperty(t,"CompatibleContentTypePrefix",{enumerable:!0,get:function(){return d.CompatibleContentTypePrefix}}),Object.defineProperty(t,"CompatibleContentType",{enumerable:!0,get:function(){return d.CompatibleContentType}});var u=n(67580);Object.defineProperty(t,"CompatibleDarkModeDatasetNames",{enumerable:!0,get:function(){return u.CompatibleDarkModeDatasetNames}});var p=n(28994);Object.defineProperty(t,"CompatibleDefinitionType",{enumerable:!0,get:function(){return p.CompatibleDefinitionType}});var h=n(61048);Object.defineProperty(t,"CompatibleDelimiterClasses",{enumerable:!0,get:function(){return h.CompatibleDelimiterClasses}});var m=n(8066);Object.defineProperty(t,"CompatibleDirection",{enumerable:!0,get:function(){return m.CompatibleDirection}});var g=n(40337);Object.defineProperty(t,"CompatibleDocumentCommand",{enumerable:!0,get:function(){return g.CompatibleDocumentCommand}});var f=n(76617);Object.defineProperty(t,"CompatibleDocumentPosition",{enumerable:!0,get:function(){return f.CompatibleDocumentPosition}});var v=n(33898);Object.defineProperty(t,"CompatibleEntityClasses",{enumerable:!0,get:function(){return v.CompatibleEntityClasses}});var b=n(85887);Object.defineProperty(t,"CompatibleEntityOperation",{enumerable:!0,get:function(){return b.CompatibleEntityOperation}});var y=n(64610);Object.defineProperty(t,"CompatibleExperimentalFeatures",{enumerable:!0,get:function(){return y.CompatibleExperimentalFeatures}});var C=n(90819);Object.defineProperty(t,"CompatibleFontSizeChange",{enumerable:!0,get:function(){return C.CompatibleFontSizeChange}});var S=n(44049);Object.defineProperty(t,"CompatibleGetContentMode",{enumerable:!0,get:function(){return S.CompatibleGetContentMode}});var k=n(34285);Object.defineProperty(t,"CompatibleImageEditOperation",{enumerable:!0,get:function(){return k.CompatibleImageEditOperation}});var D=n(87492);Object.defineProperty(t,"CompatibleIndentation",{enumerable:!0,get:function(){return D.CompatibleIndentation}});var x=n(22203);Object.defineProperty(t,"CompatibleKeys",{enumerable:!0,get:function(){return x.CompatibleKeys}});var T=n(78073);Object.defineProperty(t,"CompatibleKnownAnnounceStrings",{enumerable:!0,get:function(){return T.CompatibleKnownAnnounceStrings}});var E=n(42716);Object.defineProperty(t,"CompatibleKnownCreateElementDataIndex",{enumerable:!0,get:function(){return E.CompatibleKnownCreateElementDataIndex}});var w=n(1516);Object.defineProperty(t,"CompatibleKnownPasteSourceType",{enumerable:!0,get:function(){return w.CompatibleKnownPasteSourceType}});var _=n(83463);Object.defineProperty(t,"CompatibleListType",{enumerable:!0,get:function(){return _.CompatibleListType}});var I=n(22419);Object.defineProperty(t,"CompatibleNodeType",{enumerable:!0,get:function(){return I.CompatibleNodeType}});var P=n(444);Object.defineProperty(t,"CompatibleNumberingListType",{enumerable:!0,get:function(){return P.CompatibleNumberingListType}});var A=n(31768);Object.defineProperty(t,"CompatiblePasteType",{enumerable:!0,get:function(){return A.CompatiblePasteType}});var R=n(50442);Object.defineProperty(t,"CompatiblePluginEventType",{enumerable:!0,get:function(){return R.CompatiblePluginEventType}});var L=n(11912);Object.defineProperty(t,"CompatiblePositionType",{enumerable:!0,get:function(){return L.CompatiblePositionType}});var N=n(4871);Object.defineProperty(t,"CompatibleQueryScope",{enumerable:!0,get:function(){return N.CompatibleQueryScope}});var M=n(37739);Object.defineProperty(t,"CompatibleRegionType",{enumerable:!0,get:function(){return M.CompatibleRegionType}});var O=n(73367);Object.defineProperty(t,"CompatibleSelectionRangeTypes",{enumerable:!0,get:function(){return O.CompatibleSelectionRangeTypes}});var B=n(24274);Object.defineProperty(t,"CompatibleTableBorderFormat",{enumerable:!0,get:function(){return B.CompatibleTableBorderFormat}});var F=n(48310);Object.defineProperty(t,"CompatibleTableOperation",{enumerable:!0,get:function(){return F.CompatibleTableOperation}})},49140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6326);(0,o.__exportStar)(n(10480),t),(0,o.__exportStar)(n(94673),t),(0,o.__exportStar)(n(13368),t),(0,o.__exportStar)(n(75200),t),(0,o.__exportStar)(n(56831),t),(0,o.__exportStar)(n(98976),t)},94673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},75200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},56831:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},98976:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},81637:(e,t,n)=>{"use strict";n.d(t,{bs:()=>f,fH:()=>Q,pl:()=>m,nu:()=>o,Ag:()=>mn,uD:()=>pt,Qi:()=>b,Y7:()=>dt});var o,i=n(65043),r=n(97950),a=n(38831),s=n(98656),l=n(82014);function c(e,t,n){var o=null===e||void 0===e?void 0:e[t];return"function"==typeof o?o():"string"==typeof o?o:n}!function(e){e[e.Force=0]="Force",e[e.OnInitialize=1]="OnInitialize",e[e.OnDispose=2]="OnDispose",e[e.OnUserInput=4]="OnUserInput",e[e.OnContentChangedEvent=8]="OnContentChangedEvent",e[e.OnBlur=16]="OnBlur"}(o||(o={}));var d=n(6326),u=n(17066),p=n(84056),h=n(49634);function m(e){var t=i.useRef(null),n=i.useRef(null),o=(0,h.D)(),c=e.focusOnInit,p=e.editorCreator,m=e.zoomScale,f=e.inDarkMode,v=e.plugins;i.useEffect((function(){if(v&&t.current){var e=function(e,t){return{renderComponent:function(n){var o=e.ownerDocument,a=o.createElement("div");return o.body.appendChild(a),r.render(i.createElement(l.IF,{window:o.defaultView},i.createElement(s.N,{theme:t},n)),a),function(){r.unmountComponentAtNode(a),o.body.removeChild(a)}},isRightToLeft:function(){return"rtl"==(e&&(0,a.qt)(e,"direction")[0])}}}(t.current,o);v.forEach((function(t){(function(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.setUIUtilities)})(t)&&t.setUIUtilities(e)}))}}),[o,p]),i.useEffect((function(){var o;return t.current&&(n.current=(p||g)(t.current,e)),c&&(null===(o=n.current)||void 0===o||o.focus()),function(){n.current&&(n.current.dispose(),n.current=null)}}),[p]),i.useEffect((function(){var e;null===(e=n.current)||void 0===e||e.setDarkModeState(!!f)}),[f]),i.useEffect((function(){var e;m&&(null===(e=n.current)||void 0===e||e.setZoomScale(m))}),[m]);var b=(0,u.G1)(e,u.JM);return i.createElement("div",(0,d.__assign)({ref:t,tabIndex:0},b||{}))}function g(e,t){return new p.KE(e,t)}var f,v=function(){function e(e,t){var n=this;this.updateMode=e,this.onUpdate=t,this.editor=null,this.disposer=null,this.onBlur=function(){n.update(o.OnBlur)}}return e.prototype.getName=function(){return"UpdateContent"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("blur",this.onBlur)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:this.update(o.OnInitialize);break;case 12:this.update(o.OnDispose);break;case 7:this.update(o.OnContentChangedEvent);break;case 3:this.update(o.OnUserInput)}},e.prototype.forceUpdate=function(){this.update(o.Force)},e.prototype.update=function(e){if(this.editor&&(e==o.Force||((this.updateMode||0)&e)==e)&&this.onUpdate){var t=this.editor.getContent();this.onUpdate(t,e)}},e}();function b(e,t){return new v(e,t)}!function(e){e[e.Bold=0]="Bold",e[e.Italic=1]="Italic",e[e.Underline=2]="Underline",e[e.Font=3]="Font",e[e.FontSize=4]="FontSize",e[e.IncreaseFontSize=5]="IncreaseFontSize",e[e.DecreaseFontSize=6]="DecreaseFontSize",e[e.TextColor=7]="TextColor",e[e.BackgroundColor=8]="BackgroundColor",e[e.BulletedList=9]="BulletedList",e[e.NumberedList=10]="NumberedList",e[e.DecreaseIndent=11]="DecreaseIndent",e[e.IncreaseIndent=12]="IncreaseIndent",e[e.Quote=13]="Quote",e[e.AlignLeft=14]="AlignLeft",e[e.AlignCenter=15]="AlignCenter",e[e.AlignRight=16]="AlignRight",e[e.InsertLink=17]="InsertLink",e[e.RemoveLink=18]="RemoveLink",e[e.InsertTable=19]="InsertTable",e[e.InsertImage=20]="InsertImage",e[e.Superscript=21]="Superscript",e[e.Subscript=22]="Subscript",e[e.Strikethrough=23]="Strikethrough",e[e.Heading=24]="Heading",e[e.Code=25]="Code",e[e.Ltr=26]="Ltr",e[e.Rtl=27]="Rtl",e[e.Undo=28]="Undo",e[e.Redo=29]="Redo",e[e.ClearFormat=30]="ClearFormat",e[e.Header=31]="Header"}(f||(f={}));var y=n(65804),C=n(89379),S=n(4648),k=n(47507),D=n(50452),x=n(78233),T=n(56420),E=n(17046),w=n(97943),_=n(3266),I=n(58847),P=n(57987),A=function(e,t,n){for(var o=0,i=e;o<i.length;o++){var r=i[o];n[t.register(r,!0)]=r}},R=function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var i=o[n];e.unregister(t[i],i,!0),delete t[i]}},L=function(e){var t=_._.getInstance(),n=e.className,o=e.overflowItems,r=e.keytipSequences,a=e.itemSubMenuProvider,s=e.onRenderOverflowButton,l=(0,P.d)({}),c=i.useCallback((function(e){return a?a(e):e.subMenuProps?e.subMenuProps.items:void 0}),[a]),u=i.useMemo((function(){var e=[],n=[];return r?null===o||void 0===o||o.forEach((function(o){var i,a=o.keytipProps;if(a){var s={content:a.content,keySequences:a.keySequences,disabled:a.disabled||!(!o.disabled&&!o.isDisabled),hasDynamicChildren:a.hasDynamicChildren,hasMenu:a.hasMenu};a.hasDynamicChildren||c(o)?(s.onExecute=t.menuExecute.bind(t,r,null===(i=null===o||void 0===o?void 0:o.keytipProps)||void 0===i?void 0:i.keySequences),s.hasOverflowSubMenu=!0):s.onExecute=a.onExecute,e.push(s);var l=(0,d.__assign)((0,d.__assign)({},o),{keytipProps:(0,d.__assign)((0,d.__assign)({},a),{overflowSetSequence:r})});null===n||void 0===n||n.push(l)}else null===n||void 0===n||n.push(o)})):n=o,{modifiedOverflowItems:n,keytipsToRegister:e}}),[o,c,t,r]),p=u.modifiedOverflowItems;return function(e,t,n){var o=(0,I.Z)(e);i.useEffect((function(){o&&(R(n,o),A(t,n,e))})),i.useEffect((function(){return A(t,n,e),function(){R(n,e)}}),[])}(l,u.keytipsToRegister,t),i.createElement("div",{className:n},s(p))},N=n(19487),M=(0,C.Z)(),O=i.forwardRef((function(e,t){var n=i.useRef(null),o=(0,T.a)(n,t);!function(e,t){var n=(0,N.CQ)();i.useImperativeHandle(e.componentRef,(function(){return{focus:function(e,n){var o=!1;return t.current&&(o=(0,E.vO)(t.current,n)),o},focusElement:function(e){var o=!1;return!!e&&(t.current&&(0,w.s)(t.current,e)&&(e.focus(),o=(null===n||void 0===n?void 0:n.activeElement)===e),o)}}}),[t,n])}(e,n);var r=e.items,a=e.overflowItems,s=e.className,l=e.styles,c=e.vertical,p=e.role,h=e.overflowSide,m=void 0===h?"end":h,g=e.onRenderItem,f=M(l,{className:s,vertical:c}),v=!!a&&a.length>0;return i.createElement("div",(0,d.__assign)({},(0,u.G1)(e,u.JM),{role:p||"group","aria-orientation":"menubar"===p?!0===c?"vertical":"horizontal":void 0,className:f.root,ref:o}),"start"===m&&v&&i.createElement(L,(0,d.__assign)({},e,{className:f.overflowButton})),r&&r.map((function(e,t){return i.createElement("div",{className:f.item,key:e.key,role:"none"},g(e))})),"end"===m&&v&&i.createElement(L,(0,d.__assign)({},e,{className:f.overflowButton})))}));O.displayName="OverflowSet";var B={flexShrink:0,display:"inherit"},F=(0,y.I)(O,(function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",B],overflowButton:["ms-OverflowSet-overflowButton",B]}}),void 0,{scope:"OverflowSet"}),j=n(9586),H=n(65337),z=n(94850),U=n(55563),W=n(11660),K=n(66783),G=(0,K.J9)((function(e){var t={height:"100%"},n={whiteSpace:"nowrap"},o=e||{},i=o.root,r=o.label,a=(0,d.__rest)(o,["root","label"]);return(0,d.__assign)((0,d.__assign)({},a),{root:i?[t,i]:t,label:r?[n,r]:n})})),q=(0,C.Z)(),V=function(e){function t(t){var n=e.call(this,t)||this;return n._overflowSet=i.createRef(),n._resizeGroup=i.createRef(),n._onRenderData=function(e){var t=n.props,o=t.ariaLabel,r=t.primaryGroupAriaLabel,a=t.farItemsGroupAriaLabel,s=e.farItems&&e.farItems.length>0;return i.createElement(H.R,{className:(0,S.A)(n._classNames.root),direction:z.E.horizontal,role:"menubar","aria-label":o},i.createElement(F,{role:s?"group":"none","aria-label":s?r:void 0,componentRef:n._overflowSet,className:(0,S.A)(n._classNames.primarySet),items:e.primaryItems,overflowItems:e.overflowItems.length?e.overflowItems:void 0,onRenderItem:n._onRenderItem,onRenderOverflowButton:n._onRenderOverflowButton}),s&&i.createElement(F,{role:"group","aria-label":a,className:(0,S.A)(n._classNames.secondarySet),items:e.farItems,onRenderItem:n._onRenderItem,onRenderOverflowButton:k.K}))},n._onRenderItem=function(e){if(e.onRender)return e.onRender(e,(function(){}));var t=e.text||e.name,o=(0,d.__assign)((0,d.__assign)({allowDisabledFocus:!0,role:"menuitem"},e),{styles:G(e.buttonStyles),className:(0,S.A)("ms-CommandBarItem-link",e.className),text:e.iconOnly?void 0:t,menuProps:e.subMenuProps,onClick:n._onButtonClick(e)});return e.iconOnly&&(void 0!==t||e.tooltipHostProps)?i.createElement(W.S,(0,d.__assign)({role:"none",content:t,setAriaDescribedBy:!1},e.tooltipHostProps),n._commandButton(e,o)):n._commandButton(e,o)},n._commandButton=function(e,t){var o=n.props.buttonAs,r=e.commandBarButtonAs,a=U.z;return r&&(a=(0,D.C)(r,a)),o&&(a=(0,D.C)(o,a)),i.createElement(a,(0,d.__assign)({},t))},n._onRenderOverflowButton=function(e){var t=n.props.overflowButtonProps,o=void 0===t?{}:t,r=(0,d.__spreadArray)((0,d.__spreadArray)([],o.menuProps?o.menuProps.items:[],!0),e,!0),a=(0,d.__assign)((0,d.__assign)({role:"menuitem"},o),{styles:(0,d.__assign)({menuIcon:{fontSize:"17px"}},o.styles),className:(0,S.A)("ms-CommandBar-overflowButton",o.className),menuProps:(0,d.__assign)((0,d.__assign)({},o.menuProps),{items:r}),menuIconProps:(0,d.__assign)({iconName:"More"},o.menuIconProps)}),s=n.props.overflowButtonAs?(0,D.C)(n.props.overflowButtonAs,U.z):U.z;return i.createElement(s,(0,d.__assign)({},a))},n._onReduceData=function(e){var t=n.props,o=t.shiftOnReduce,i=t.onDataReduced,r=e.primaryItems,a=e.overflowItems,s=e.cacheKey,l=e.farItems,c=r[o?0:r.length-1];if(void 0!==c){c.renderedInOverflow=!0,a=(0,d.__spreadArray)([c],a,!0),r=o?r.slice(1):r.slice(0,-1);var u=(0,d.__assign)((0,d.__assign)({},e),{primaryItems:r,overflowItems:a});return s=n._computeCacheKey({primaryItems:r,overflow:a.length>0,farItems:l}),i&&i(c),u.cacheKey=s,u}},n._onGrowData=function(e){var t=n.props,o=t.shiftOnReduce,i=t.onDataGrown,r=e.minimumOverflowItems,a=e.primaryItems,s=e.overflowItems,l=e.cacheKey,c=e.farItems,u=s[0];if(void 0!==u&&s.length>r){u.renderedInOverflow=!1,s=s.slice(1),a=o?(0,d.__spreadArray)([u],a,!0):(0,d.__spreadArray)((0,d.__spreadArray)([],a,!0),[u],!1);var p=(0,d.__assign)((0,d.__assign)({},e),{primaryItems:a,overflowItems:s});return l=n._computeCacheKey({primaryItems:a,overflow:s.length>0,farItems:c}),i&&i(u),p.cacheKey=l,p}},(0,x.f)(n),n}return(0,d.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.items,n=e.overflowItems,o=e.farItems,r=e.styles,a=e.theme,s=e.dataDidRender,l=e.onReduceData,c=void 0===l?this._onReduceData:l,p=e.onGrowData,h=void 0===p?this._onGrowData:p,m=e.resizeGroupAs,g=void 0===m?j.A:m,f={primaryItems:(0,d.__spreadArray)([],t,!0),overflowItems:(0,d.__spreadArray)([],n,!0),minimumOverflowItems:(0,d.__spreadArray)([],n,!0).length,farItems:o,cacheKey:this._computeCacheKey({primaryItems:(0,d.__spreadArray)([],t,!0),overflow:n&&n.length>0,farItems:o})};this._classNames=q(r,{theme:a});var v=(0,u.G1)(this.props,u.JM);return i.createElement(g,(0,d.__assign)({},v,{componentRef:this._resizeGroup,data:f,onReduceData:c,onGrowData:h,onRenderData:this._onRenderData,dataDidRender:s}))},t.prototype.focus=function(){var e=this._overflowSet.current;e&&e.focus()},t.prototype.remeasure=function(){this._resizeGroup.current&&this._resizeGroup.current.remeasure()},t.prototype._onButtonClick=function(e){return function(t){e.inactive||e.onClick&&e.onClick(t,e)}},t.prototype._computeCacheKey=function(e){var t=e.primaryItems,n=e.overflow,o=e.farItems,i=function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)};return[t&&t.reduce(i,""),n?"overflow":"",o&&o.reduce(i,"")].join("")},t.defaultProps={items:[],overflowItems:[]},t}(i.Component),Z=(0,y.I)(V,(function(e){var t=e.className,n=e.theme,o=n.semanticColors;return{root:[n.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:o.bodyBackground,padding:"0 14px 0 24px",height:44},t],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:"1",display:"flex",alignItems:"stretch"}],secondarySet:["ms-CommandBar-secondaryCommand",{flexShrink:"0",display:"flex",alignItems:"stretch"}]}}),void 0,{scope:"CommandBar"}),Y=n(33516),X={key:"buttonNameMoreCommands",unlocalizedText:"More commands",iconName:"MoreCommands",onClick:function(e){return!0}},$=(0,Y.Zq)({"& .ms-CommandBar":{padding:"0px"}}),J=(0,Y.Zq)({transform:"scaleX(-1)"});function Q(e){var t=e.plugin,n=e.buttons,o=e.strings,r=e.dir,s=(0,d.__read)(i.useState(null),2),l=s[0],u=s[1],p="rtl"==r,h=i.useCallback((function(e,n){n&&(null===t||void 0===t||t.onButtonClick(n.data,n.key,o))}),[t,o]),m=i.useCallback((function(e,n){t.startLivePreview(e,n,o)}),[t,o]),g=i.useCallback((function(){t.stopLivePreview()}),[t]),f=i.useCallback((function(e,t){return t?i.createElement("span",{className:J},t(e)):null}),[]),v=i.useMemo((function(){return n.map((function(e){var t,n,r,s,u=l&&(null===(n=null===(t=e.dropDownMenu)||void 0===t?void 0:t.getSelectedItemKey)||void 0===n?void 0:n.call(t,l)),v=e.dropDownMenu,b=(0,d.__assign)({key:e.key,data:e,iconProps:{iconName:e.iconName},onRenderIcon:p&&e.flipWhenRtl?f:void 0,iconOnly:!0,text:c(o,e.key,e.unlocalizedText),ariaLabel:c(o,e.key,e.unlocalizedText),canCheck:!0,checked:l&&(null===(r=e.isChecked)||void 0===r?void 0:r.call(e,l))||!1,disabled:l&&(null===(s=e.isDisabled)||void 0===s?void 0:s.call(e,l))||!1},e.commandBarProperties||{});return v?b.subMenuProps=(0,d.__assign)({shouldFocusOnMount:!0,focusZoneProps:{direction:z.E.bidirectional},onMenuDismissed:g,onItemClick:h,onRenderContextualMenuItem:v.allowLivePreview?function(t,n){return t&&n?i.createElement("div",{onMouseOver:function(n){return m(e,t.key)}},n(t)):null}:void 0,items:(0,a.Co)(v.items).map((function(t){return{key:t,text:c(o,t,v.items[t]),data:e,canCheck:!!v.getSelectedItemKey,checked:u==t||!1,className:v.itemClassName,onRender:v.itemRender?function(e){return v.itemRender(e,h)}:void 0}}))},v.commandBarSubMenuProperties||{}):b.onClick=h,b}))}),[n,l,p,o,h,g,m]);i.useEffect((function(){var e=null===t||void 0===t?void 0:t.registerFormatChangedCallback(u);return function(){null===e||void 0===e||e()}}),[t]);var b=X;return i.createElement(Z,(0,d.__assign)({items:v},e,{className:$+" "+((null===e||void 0===e?void 0:e.className)||""),overflowButtonProps:(0,d.__assign)({ariaLabel:c(o,b.key,b.unlocalizedText)},null===e||void 0===e?void 0:e.overflowButtonProps)}))}var ee=n(59935),te={key:"buttonNameAlignCenter",unlocalizedText:"Align center",iconName:"AlignCenter",onClick:function(e){(0,ee.oX)(e,1)}},ne={key:"buttonNameAlignLeft",unlocalizedText:"Align left",iconName:"AlignLeft",onClick:function(e){(0,ee.oX)(e,0)}},oe={key:"buttonNameAlignRight",unlocalizedText:"Align right",iconName:"AlignRight",onClick:function(e){(0,ee.oX)(e,2)}},ie=(0,Y.l8)({colorSquare:{width:"20px",height:"20px",margin:"4px",borderStyle:"solid",borderWidth:"2px","&:hover":{borderColor:"red"}},colorSquareBorder:{borderColor:"transparent"},colorSquareBorderWhite:{borderColor:"#bebebe"}});function re(e,t,n){var o=e.key,r=t[o].lightModeColor;return i.createElement("button",{onClick:function(t){return n(t,e)},title:e.text},i.createElement("div",{className:ie.colorSquare+" "+("textColorWhite"==o||"backgroundColorWhite"==o?ie.colorSquareBorderWhite:ie.colorSquareBorder),style:{backgroundColor:r}}))}var ae=(0,Y.l8)({colorPickerContainer:{width:"192px",padding:"8px",overflow:"hidden","& ul":{width:"192px",overflow:"hidden"}},colorMenuItem:{display:"inline-block",width:"32px",height:"32px","& button":{padding:"0px",minWidth:"0px",background:"transparent",border:"none"}}});function se(){return ae.colorPickerContainer}function le(){return ae.colorMenuItem}var ce={backgroundColorCyan:{lightModeColor:"#00ffff",darkModeColor:"#005357"},backgroundColorGreen:{lightModeColor:"#00ff00",darkModeColor:"#005e00"},backgroundColorYellow:{lightModeColor:"#ffff00",darkModeColor:"#383e00"},backgroundColorOrange:{lightModeColor:"#ff8000",darkModeColor:"#bf4c00"},backgroundColorRed:{lightModeColor:"#ff0000",darkModeColor:"#ff2711"},backgroundColorMagenta:{lightModeColor:"#ff00ff",darkModeColor:"#e700e8"},backgroundColorLightCyan:{lightModeColor:"#80ffff",darkModeColor:"#004c4f"},backgroundColorLightGreen:{lightModeColor:"#80ff80",darkModeColor:"#005400"},backgroundColorLightYellow:{lightModeColor:"#ffff80",darkModeColor:"#343c00"},backgroundColorLightOrange:{lightModeColor:"#ffc080",darkModeColor:"#77480b"},backgroundColorLightRed:{lightModeColor:"#ff8080",darkModeColor:"#bc454a"},backgroundColorLightMagenta:{lightModeColor:"#ff80ff",darkModeColor:"#aa2bad"},backgroundColorWhite:{lightModeColor:"#ffffff",darkModeColor:"#333333"},backgroundColorLightGray:{lightModeColor:"#cccccc",darkModeColor:"#535353"},backgroundColorGray:{lightModeColor:"#999999",darkModeColor:"#777777"},backgroundColorDarkGray:{lightModeColor:"#666666",darkModeColor:"#a0a0a0"},backgroundColorDarkerGray:{lightModeColor:"#333333",darkModeColor:"#cfcfcf"},backgroundColorBlack:{lightModeColor:"#000000",darkModeColor:"#ffffff"}},de={backgroundColorCyan:"Cyan",backgroundColorGreen:"Green",backgroundColorYellow:"Yellow",backgroundColorOrange:"Orange",backgroundColorRed:"Red",backgroundColorMagenta:"Magenta",backgroundColorLightCyan:"Light cyan",backgroundColorLightGreen:"Light green",backgroundColorLightYellow:"Light yellow",backgroundColorLightOrange:"Light orange",backgroundColorLightRed:"Light red",backgroundColorLightMagenta:"Light magenta",backgroundColorWhite:"White",backgroundColorLightGray:"Light gray",backgroundColorGray:"Gray",backgroundColorDarkGray:"Dark gray",backgroundColorDarkerGray:"Darker gray",backgroundColorBlack:"Black"};var ue="buttonNameBackgroundColor",pe={dropDownMenu:{items:de,itemClassName:le(),allowLivePreview:!0,itemRender:function(e,t){return re(e,ce,t)},commandBarSubMenuProperties:{className:se()}},key:ue,unlocalizedText:"Background color",iconName:"FabricTextHighlight",onClick:function(e,t){t!=ue&&(0,ee.Mo)(e,function(e){return ce[e]}(t))}},he={key:"buttonNameBold",unlocalizedText:"Bold",iconName:"Bold",isChecked:function(e){return!!e.isBold},onClick:function(e){return(0,ee.s)(e),!0}},me={key:"buttonNameBulletedList",unlocalizedText:"Bulleted list",iconName:"BulletedList",isChecked:function(e){return!!e.isBullet},onClick:function(e){return(0,ee.jZ)(e),!0}},ge={key:"buttonNameClearFormat",unlocalizedText:"Clear format",iconName:"ClearFormatting",onClick:function(e){(0,ee.Px)(e,2)}},fe={key:"buttonNameCode",unlocalizedText:"Code",iconName:"Code",isChecked:function(e){return!!e.isCodeBlock},onClick:function(e){(0,ee.xy)(e)}},ve={key:"buttonNameDecreaseFontSize",unlocalizedText:"Decrease font size",iconName:"FontDecrease",onClick:function(e){(0,ee.xE)(e,1)}},be={key:"buttonNameDecreaseIndent",unlocalizedText:"Decrease indent",iconName:"DecreaseIndentLegacy",flipWhenRtl:!0,onClick:function(e){(0,ee.Q2)(e,1)}},ye=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI', 'Segoe UI Web (West European)', 'Helvetica Neue', sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"FontDivider0"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','\u5fae\u8f6f\u96c5\u9ed1',STHeiti,sans-serif",localizedName:"\u5fae\u8f6f\u96c5\u9ed1"},{name:"SimHei",family:"SimHei,'\u9ed1\u4f53',STHeiti,sans-serif",localizedName:"\u9ed1\u4f53"},{name:"NSimSun",family:"NSimSun,'\u65b0\u5b8b\u4f53',SimSun,'\u5b8b\u4f53',SimSun-ExtB,'\u5b8b\u4f53-ExtB',STSong,serif",localizedName:"\u65b0\u5b8b\u4f53"},{name:"FangSong",family:"FangSong,'\u4eff\u5b8b',STFangsong,serif",localizedName:"\u4eff\u5b8b"},{name:"SimLi",family:"SimLi,'\u96b6\u4e66','Baoli SC',serif",localizedName:"\u96b6\u4e66"},{name:"KaiTi",family:"KaiTi,'\u6977\u4f53',STKaiti,serif",localizedName:"\u6977\u4f53"},{name:"-",family:"FontDivider1"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','\u5fae\u8edf\u6b63\u9ed1\u9ad4','Apple LiGothic',sans-serif",localizedName:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{name:"PMingLiU",family:"PMingLiU,'\u65b0\u7d30\u660e\u9ad4',PMingLiU-ExtB,'\u65b0\u7d30\u660e\u9ad4-ExtB','Apple LiSung',serif",localizedName:"\u65b0\u7d30\u660e\u9ad4"},{name:"DFKai-SB",family:"DFKai-SB,'\u6a19\u6977\u9ad4','BiauKai',serif",localizedName:"\u6a19\u6977\u9ad4"},{name:"-",family:"FontDivider2"},{name:"Meiryo",family:"Meiryo,'\u30e1\u30a4\u30ea\u30aa','Hiragino Sans',sans-serif",localizedName:"\u30e1\u30a4\u30ea\u30aa"},{name:"MS PGothic",family:"'MS PGothic','\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af','MS Gothic','\uff2d\uff33 \u30b4\u30b7\u30c3\u30af','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{name:"MS PMincho",family:"'MS PMincho','\uff2d\uff33 \uff30\u660e\u671d','MS Mincho','\uff2d\uff33 \u660e\u671d','Hiragino Mincho ProN',serif",localizedName:"\uff2d\uff33 \uff30\u660e\u671d"},{name:"Yu Gothic",family:"'Yu Gothic','\u6e38\u30b4\u30b7\u30c3\u30af','YuGothic',sans-serif",localizedName:"\u6e38\u30b4\u30b7\u30c3\u30af"},{name:"Yu Mincho",family:"'Yu Mincho','\u6e38\u660e\u671d','YuMincho',serif",localizedName:"\u6e38\u660e\u671d"},{name:"-",family:"FontDivider3"},{name:"Malgun Gothic",family:"'Malgun Gothic','\ub9d1\uc740 \uace0\ub515',AppleGothic,sans-serif",localizedName:"\ub9d1\uc740 \uace0\ub515"},{name:"Gulim",family:"Gulim,'\uad74\ub9bc','Nanum Gothic',sans-serif",localizedName:"\uad74\ub9bc"},{name:"Dotum",family:"Dotum,'\ub3cb\uc6c0',AppleGothic,sans-serif",localizedName:"\ub3cb\uc6c0"},{name:"Batang",family:"Batang,'\ubc14\ud0d5',AppleMyungjo,serif",localizedName:"\ubc14\ud0d5"},{name:"BatangChe",family:"BatangChe,'\ubc14\ud0d5\uccb4',AppleMyungjo,serif",localizedName:"\ubc14\ud0d5\uccb4"},{name:"Gungsuh",family:"Gungsuh,'\uad81\uc11c',GungSeo,serif",localizedName:"\uad81\uc11c"},{name:"-",family:"FontDivider4"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"FontDivider5"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"FontDivider6"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}],Ce=ye.reduce((function(e,t){return e[t.family]=t.localizedName||t.name,e}),{}),Se=ye.reduce((function(e,t){return e[t.name.toLowerCase()]=t.family,e}),{}),ke=/^['"]?([^'",]+)/i,De={key:"buttonNameFont",unlocalizedText:"Font",iconName:"Font",dropDownMenu:{items:Ce,getSelectedItemKey:function(e){var t,n,o=null===(t=e.fontName)||void 0===t?void 0:t.match(ke),i=null===(n=null===o||void 0===o?void 0:o[1])||void 0===n?void 0:n.toLowerCase();return i&&Se[i]||""},allowLivePreview:!0},onClick:function(e,t){(0,ee.$T)(e,t)}},xe={key:"buttonNameFontSize",unlocalizedText:"Font size",iconName:"FontSize",dropDownMenu:{items:ee.$N.reduce((function(e,t){return e[t+"pt"]=t.toString(),e}),{}),getSelectedItemKey:function(e){var t;return null!==(t=e.fontSize)&&void 0!==t?t:null},allowLivePreview:!0},onClick:function(e,t){(0,ee.XS)(e,t)}},Te={buttonNameHeading1:"Heading 1",buttonNameHeading2:"Heading 2",buttonNameHeading3:"Heading 3",buttonNameHeading4:"Heading 4",buttonNameHeading5:"Heading 5",buttonNameHeading6:"Heading 6","-":"-",buttonNameNoHeading:"No heading"},Ee={key:"buttonNameHeading",unlocalizedText:"Heading",iconName:"Header1",dropDownMenu:{items:Te,getSelectedItemKey:function(e){var t;return(null!==(t=e.headingLevel)&&void 0!==t?t:0)>0?"heading"+e.headingLevel:"noHeading"}},onClick:function(e,t){var n=(0,a.Co)(Te).indexOf(t)+1;n>6?(0,ee.zc)(e,0):n>0&&(0,ee.zc)(e,n)}},we={key:"buttonNameIncreaseFontSize",unlocalizedText:"Increase font size",iconName:"FontIncrease",onClick:function(e){(0,ee.xE)(e,0)}},_e={key:"buttonNameIncreaseIndent",unlocalizedText:"Increase indent",iconName:"IncreaseIndentLegacy",flipWhenRtl:!0,onClick:function(e){(0,ee.Q2)(e,0)}},Ie={tag:"input",attributes:{type:"file",accept:"image/*",display:"none"}},Pe={key:"buttonNameInsertImage",unlocalizedText:"Insert image",iconName:"Photo2",onClick:function(e){var t=e.getDocument(),n=(0,a.n)(Ie,t);t.body.appendChild(n),n.addEventListener("change",(function(){if(n.files)for(var t=0;t<n.files.length;t++)(0,ee.V4)(e,n.files[t])}));try{n.click()}finally{t.body.removeChild(n)}}},Ae=n(94028),Re=(0,Y.l8)({inputBox:{width:"100%",minWidth:"250px",height:"32px",margin:"5px 0 16px",borderRadius:"2px"}});function Le(e){var t=e.itemName,n=e.strings,o=e.items,r=e.currentValues,a=e.onChanged,s=e.onEnterKey,l=o[t],d=l.labelKey,u=l.unlocalizedLabel,p=l.autoFocus,h=r[t],m=i.useCallback((function(e,n){a(t,n)}),[t,a]),g=i.useCallback((function(e){13==e.which&&s()}),[s]);return i.createElement("div",null,d?i.createElement("div",null,c(n,d,u)):null,i.createElement("div",null,i.createElement(Ae.A,{role:"textbox",type:"text",className:Re.inputBox,value:h,onChange:m,onKeyPress:g,autoFocus:p})))}var Ne=n(63485),Me=n(11638),Oe=n(40520),Be=n(52342),Fe=n(54845);function je(e){var t=e.items,n=e.strings,o=e.dialogTitleKey,r=e.unlocalizedTitle,s=e.onOk,l=e.onCancel,u=e.onChange,p=i.useMemo((function(){return{type:Oe.h.normal,title:c(n,o,r)}}),[n,o,r]),h=(0,d.__read)(i.useState((0,a.Co)(t).reduce((function(e,n){return e[n]=t[n].initValue,e}),{})),2),m=h[0],g=h[1],f=i.useCallback((function(){null===s||void 0===s||s(m)}),[s,m]),v=i.useCallback((function(e,n){var o;if(e in t){var i=(null===u||void 0===u?void 0:u(e,n,(0,d.__assign)({},m)))||(0,d.__assign)((0,d.__assign)({},m),((o={})[e]=n,o));g(i)}}),[g,m,t]);return i.createElement(Be.l,{dialogContentProps:p,hidden:!1,onDismiss:l},i.createElement("div",null,(0,a.Co)(t).map((function(e){return i.createElement(Le,{key:e,itemName:e,items:t,strings:n,currentValues:m,onEnterKey:f,onChanged:v})}))),i.createElement(Fe.E,null,i.createElement(Ne.j,{text:c(n,"buttonNameOK","OK"),onClick:f}),i.createElement(Me.Y,{text:c(n,"buttonNameCancel","Cancel"),onClick:l})))}function He(e,t){if(e)return e.renderComponent(t);throw new Error("UIUtilities is required but not provided. Please call ReactEditorPlugin.setUIUtilities() to set a valid uiUtilities object")}function ze(e,t,n,o,r,a){return new Promise((function(s){var l=null,c=i.createElement(je,{dialogTitleKey:t,unlocalizedTitle:n,items:o,strings:r,onOk:function(e){null===l||void 0===l||l(),s(e)},onCancel:function(){null===l||void 0===l||l(),s(null)},onChange:a});l=He(e,c)}))}var Ue={key:"buttonNameInsertLink",unlocalizedText:"Insert link",iconName:"Link",isDisabled:function(e){return!!e.isMultilineSelection},onClick:function(e,t,n,o){var i,r=e.queryElements("a[href]",1)[0],a=(null===r||void 0===r?void 0:r.href)||"",s=(null===r||void 0===r?void 0:r.textContent)||(null===(i=e.getSelectionRange())||void 0===i?void 0:i.toString())||"";ze(o,"insertLinkTitle","Insert link",{url:{autoFocus:!0,labelKey:"insertLinkDialogUrl",unlocalizedLabel:"Web address (URL)",initValue:a},displayText:{labelKey:"insertLinkDialogDisplayAs",unlocalizedLabel:"Display as",initValue:s}},n,(function(e,t,n){return"url"==e&&n.displayText==n.url?(n.displayText=t,n.url=t,n):null})).then((function(t){e.focus(),t&&t.displayText&&t.url&&(t.displayText!=s||t.url!=a)&&(0,ee.d)(e,t.url,t.url,t.displayText)}))}},We=(0,Y.l8)({tableButton:{width:"15px",height:"15px",margin:"1px 1px 0 0",border:"solid 1px #a19f9d",display:"inline-block",cursor:"pointer",backgroundColor:"transparent"},hovered:{border:"solid 1px #DB626C"},tablePane:{width:"160px",minWidth:"auto",padding:"4px",boxSizing:"content-box"},tablePaneInner:{lineHeight:"12px"},title:{margin:"5px 0"}}),Ke={key:"buttonNameInsertTable",unlocalizedText:"Insert table",iconName:"Table",onClick:function(e,t){var n=function(e){var t=(0,d.__read)(e.split(","),2),n=t[0],o=t[1];return{row:parseInt(n),col:parseInt(o)}}(t),o=n.row,i=n.col;(0,ee.aU)(e,i,o)},dropDownMenu:{items:{insertTablePane:"{0} x {1} table"},itemRender:function(e,t){return i.createElement(Ge,{item:e,onClick:t})},commandBarSubMenuProperties:{className:We.tablePane}}};function Ge(e){var t,n=e.item,o=e.onClick,r=(0,d.__read)(i.useState(1),2),s=r[0],l=r[1],c=(0,d.__read)(i.useState(1),2),u=c[0],p=c[1],h=i.useCallback((function(e){var t,n;if((0,a.CP)(e,"HTMLElement")){var o=parseInt(null!==(t=e.dataset.col)&&void 0!==t?t:"-1"),i=parseInt(null!==(n=e.dataset.row)&&void 0!==n?n:"-1");o>0&&o<=10&&i>0&&i<=10&&(l(o),p(i))}}),[l,p]),m=i.useCallback((function(e){h(e.target)}),[h]),g=i.useCallback((function(e){o(e,(0,d.__assign)((0,d.__assign)({},n),{key:Ve(u,s)}))}),[u,s,o]),f=i.useMemo((function(){for(var e,t=[],o=1;o<=10;o++){for(var i=[],r=1;r<=10;r++)i[r]=qe(null!==(e=n.text)&&void 0!==e?e:"",o,r);t[o]=i}return t}),[n.text]),v=i.useMemo((function(){for(var e=[],t=1;t<=10;t++)for(var n=1;n<=10;n++){var o="cell_"+t+"_"+n,r=n<=s&&t<=u;e.push(i.createElement("button",{className:We.tableButton+" "+(r?We.hovered:""),onClick:g,key:o,id:o,"data-col":n,"data-row":t,"data-is-focusable":!0,onMouseEnter:m,"aria-label":f[t][n]}))}return e}),[s,u]),b=qe(null!==(t=n.text)&&void 0!==t?t:"",u,s);return i.createElement("div",{className:We.tablePaneInner},i.createElement("div",{className:We.title},b),i.createElement(H.R,{defaultActiveElement:"cell_1_1",direction:z.E.bidirectional,onActiveElementChanged:h},v))}function qe(e,t,n){return e.replace("{0}",n.toString()).replace("{1}",t.toString())}function Ve(e,t){return e+","+t}var Ze={key:"buttonNameItalic",unlocalizedText:"Italic",iconName:"Italic",isChecked:function(e){return!!e.isItalic},onClick:function(e){return(0,ee.Rk)(e),!0}},Ye={key:"buttonNameLtr",unlocalizedText:"Left to right",iconName:"BidiLtr",onClick:function(e){(0,ee.oP)(e,0)}},Xe={key:"buttonNameNumberedList",unlocalizedText:"Numbered list",iconName:"NumberedList",isChecked:function(e){return!!e.isNumbering},onClick:function(e){return(0,ee.SA)(e),!0}},$e={key:"buttonNameQuote",unlocalizedText:"Quote",iconName:"RightDoubleQuote",isChecked:function(e){return!!e.isBlockQuote},onClick:function(e){return(0,ee.A4)(e),!0}},Je={key:"buttonNameRemoveLink",unlocalizedText:"Remove link",iconName:"RemoveLink",isDisabled:function(e){return!e.canUnlink},onClick:function(e){(0,ee.vL)(e)}},Qe={key:"buttonNameRtl",unlocalizedText:"Right to left",iconName:"BidiRtl",onClick:function(e){(0,ee.oP)(e,1)}},et={key:"buttonNameStrikethrough",unlocalizedText:"Strikethrough",iconName:"Strikethrough",isChecked:function(e){return!!e.isStrikeThrough},onClick:function(e){return(0,ee.mO)(e),!0}},tt={key:"buttonNameSubscript",unlocalizedText:"Subscript",iconName:"Subscript",isChecked:function(e){return!!e.isSubscript},onClick:function(e){return(0,ee.YI)(e),!0}},nt={key:"buttonNameSuperscript",unlocalizedText:"Superscript",iconName:"Superscript",isChecked:function(e){return!!e.isSuperscript},onClick:function(e){return(0,ee.XQ)(e),!0}},ot={textColorLightBlue:{lightModeColor:"#51a7f9",darkModeColor:"#0075c2"},textColorLightGreen:{lightModeColor:"#6fc040",darkModeColor:"#207a00"},textColorLightYellow:{lightModeColor:"#f5d427",darkModeColor:"#5d4d00"},textColorLightOrange:{lightModeColor:"#f3901d",darkModeColor:"#ab5500"},textColorLightRed:{lightModeColor:"#ed5c57",darkModeColor:"#df504d"},textColorLightPurple:{lightModeColor:"#b36ae2",darkModeColor:"#ab63da"},textColorBlue:{lightModeColor:"#0c64c0",darkModeColor:"#6da0ff"},textColorGreen:{lightModeColor:"#0c882a",darkModeColor:"#3da848"},textColorYellow:{lightModeColor:"#dcbe22",darkModeColor:"#6d5c00"},textColorOrange:{lightModeColor:"#de6a19",darkModeColor:"#d3610c"},textColorRed:{lightModeColor:"#c82613",darkModeColor:"#ff6847"},textColorPurple:{lightModeColor:"#763e9b",darkModeColor:"#d394f9"},textColorDarkBlue:{lightModeColor:"#174e86",darkModeColor:"#93b8f9"},textColorDarkGreen:{lightModeColor:"#0f5c1a",darkModeColor:"#7fc57b"},textColorDarkYellow:{lightModeColor:"#c3971d",darkModeColor:"#946f00"},textColorDarkOrange:{lightModeColor:"#be5b17",darkModeColor:"#de7633"},textColorDarkRed:{lightModeColor:"#861106",darkModeColor:"#ff9b7c"},textColorDarkPurple:{lightModeColor:"#5e327c",darkModeColor:"#dea9fd"},textColorDarkerBlue:{lightModeColor:"#002451",darkModeColor:"#cedbff"},textColorDarkerGreen:{lightModeColor:"#06400c",darkModeColor:"#a3da9b"},textColorDarkerYellow:{lightModeColor:"#a37519",darkModeColor:"#b5852a"},textColorDarkerOrange:{lightModeColor:"#934511",darkModeColor:"#ef935c"},textColorDarkerRed:{lightModeColor:"#570606",darkModeColor:"#ffc0b1"},textColorDarkerPurple:{lightModeColor:"#3b204d",darkModeColor:"#eecaff"},textColorWhite:{lightModeColor:"#ffffff",darkModeColor:"#333333"},textColorLightGray:{lightModeColor:"#cccccc",darkModeColor:"#535353"},textColorGray:{lightModeColor:"#999999",darkModeColor:"#777777"},textColorDarkGray:{lightModeColor:"#666666",darkModeColor:"#a0a0a0"},textColorDarkerGray:{lightModeColor:"#333333",darkModeColor:"#cfcfcf"},textColorBlack:{lightModeColor:"#000000",darkModeColor:"#ffffff"}};var it,rt="buttonNameTextColor",at={dropDownMenu:{items:{textColorLightBlue:"Light blue",textColorLightGreen:"Light green",textColorLightYellow:"Light yellow",textColorLightOrange:"Light orange",textColorLightRed:"Light red",textColorLightPurple:"Light purple",textColorBlue:"Blue",textColorGreen:"Green",textColorYellow:"Yellow",textColorOrange:"Orange",textColorRed:"Red",textColorPurple:"Purple",textColorDarkBlue:"Dark blue",textColorDarkGreen:"Dark green",textColorDarkYellow:"Dark yellow",textColorDarkOrange:"Dark orange",textColorDarkRed:"Dark red",textColorDarkPurple:"Dark purple",textColorDarkerBlue:"Darker blue",textColorDarkerGreen:"Darker green",textColorDarkerYellow:"Darker yellow",textColorDarkerOrange:"Darker orange",textColorDarkerRed:"Darker red",textColorDarkerPurple:"Darker purple",textColorWhite:"White",textColorLightGray:"Light gray",textColorGray:"Gray",textColorDarkGray:"Dark gray",textColorDarkerGray:"Darker gray",textColorBlack:"Black"},itemClassName:le(),allowLivePreview:!0,itemRender:function(e,t){return re(e,ot,t)},commandBarSubMenuProperties:{className:se()}},key:rt,unlocalizedText:"Text color",iconName:"FontColor",onClick:function(e,t){t!=rt&&(0,ee.vY)(e,function(e){return ot[e]}(t))}},st={key:"buttonNameUnderline",unlocalizedText:"Underline",iconName:"Underline",isChecked:function(e){return!!e.isUnderline},onClick:function(e){return(0,ee.Ty)(e),!0}},lt=((it={})[f.Bold]=he,it[f.Italic]=Ze,it[f.Underline]=st,it[f.Font]=De,it[f.FontSize]=xe,it[f.IncreaseFontSize]=we,it[f.DecreaseFontSize]=ve,it[f.TextColor]=at,it[f.BackgroundColor]=pe,it[f.BulletedList]=me,it[f.NumberedList]=Xe,it[f.DecreaseIndent]=be,it[f.IncreaseIndent]=_e,it[f.Quote]=$e,it[f.AlignLeft]=ne,it[f.AlignCenter]=te,it[f.AlignRight]=oe,it[f.InsertLink]=Ue,it[f.RemoveLink]=Je,it[f.InsertTable]=Ke,it[f.InsertImage]=Pe,it[f.Superscript]=nt,it[f.Subscript]=tt,it[f.Strikethrough]=et,it[f.Header]=Ee,it[f.Heading]=Ee,it[f.Code]=fe,it[f.Ltr]=Ye,it[f.Rtl]=Qe,it[f.Undo]={key:"buttonNameUndo",unlocalizedText:"Undo",iconName:"undo",isDisabled:function(e){return!e.canUndo},onClick:function(e){return e.undo(),!0}},it[f.Redo]={key:"buttonNameRedo",unlocalizedText:"Redo",iconName:"Redo",isDisabled:function(e){return!e.canRedo},onClick:function(e){return e.redo(),!0}},it[f.ClearFormat]=ge,it),ct=[f.Bold,f.Italic,f.Underline,f.Font,f.FontSize,f.IncreaseFontSize,f.DecreaseFontSize,f.TextColor,f.BackgroundColor,f.BulletedList,f.NumberedList,f.DecreaseIndent,f.IncreaseIndent,f.Quote,f.AlignLeft,f.AlignCenter,f.AlignRight,f.InsertLink,f.RemoveLink,f.InsertTable,f.InsertImage,f.Superscript,f.Subscript,f.Strikethrough,f.Heading,f.Code,f.Ltr,f.Rtl,f.Undo,f.Redo,f.ClearFormat];function dt(e){return void 0===e&&(e=ct),e.map((function(e){return"number"==typeof e?lt[e]:e}))}var ut=function(){function e(e,t){void 0===e&&(e=200),this.delayUpdateTime=e,this.editor=null,this.onFormatChanged=null,this.timer=0,this.formatState=null,this.uiUtilities=null,this.options=t}return e.prototype.getName=function(){return"Ribbon"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 11:case 7:case 21:this.updateFormat();break;case 0:"k"==e.rawEvent.key&&(0,a.tD)(e.rawEvent)&&!e.rawEvent.altKey&&(null===(t=this.options)||void 0===t?void 0:t.allowInsertLinkHotKey)&&(this.handleButtonClick(Ue,"insertLinkTitle",void 0),e.rawEvent.preventDefault());break;case 6:this.delayUpdate()}},e.prototype.setUIUtilities=function(e){this.uiUtilities=e},e.prototype.registerFormatChangedCallback=function(e){var t=this;return this.onFormatChanged=e,function(){t.onFormatChanged=null}},e.prototype.onButtonClick=function(e,t,n){this.handleButtonClick(e,t,n)},e.prototype.handleButtonClick=function(e,t,n){var o;this.editor&&this.uiUtilities&&(this.editor.stopShadowEdit(),e.onClick(this.editor,t,n,this.uiUtilities),(e.isChecked||e.isDisabled||(null===(o=e.dropDownMenu)||void 0===o?void 0:o.getSelectedItemKey))&&this.updateFormat())},e.prototype.startLivePreview=function(e,t,n){if(this.editor&&this.uiUtilities){var o=this.editor.isInShadowEdit(),i=!o&&this.editor.getSelectionRangeEx();(o||i&&!i.areAllCollapsed)&&(this.editor.startShadowEdit(),e.onClick(this.editor,t,n,this.uiUtilities))}},e.prototype.stopLivePreview=function(){var e;null===(e=this.editor)||void 0===e||e.stopShadowEdit()},e.prototype.delayUpdate=function(){var e,t=this,n=null===(e=this.editor)||void 0===e?void 0:e.getDocument().defaultView;n&&(this.timer&&n.clearTimeout(this.timer),this.timer=n.setTimeout((function(){var e;t.timer=0,null===(e=t.updateFormat)||void 0===e||e.call(t)}),this.delayUpdateTime))},e.prototype.updateFormat=function(){var e=this;if(this.editor&&this.onFormatChanged){var t=(0,ee.B2)(this.editor);this.formatState&&!(0,a.Co)(t).some((function(n){var o;return t[n]!=(null===(o=e.formatState)||void 0===o?void 0:o[n])}))||(this.formatState=t,this.onFormatChanged(t))}},e}();function pt(e,t){return new ut(e,t)}var ht=n(59479),mt=n(62672);!function(e){function t(){var t=e.call(this,{render:function(e,n,o){var r=function(e){var t=0;return e.map((function(e){return e||{name:"-",key:"divider_"+(t++).toString()}}))}(n);r.length>0&&(t.disposer=He(t.uiUtilities,i.createElement(mt.l,{target:e,onDismiss:o,items:r})))},dismiss:function(e){var n;null===(n=t.disposer)||void 0===n||n.call(t),t.disposer=null}})||this;return t.uiUtilities=null,t.disposer=null,t}(0,d.__extends)(t,e),t.prototype.setUIUtilities=function(e){this.uiUtilities=e}}(ht.tz);!function(){function e(e,t,n,o,i){this.menuName=e,this.items=t,this.strings=n,this.shouldAddMenuItems=o,this.context=i,this.editor=null,this.targetNode=null,this.uiUtilities=null}e.prototype.getName=function(){return this.menuName},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getContextMenuItems=function(e){var t,n=this;return this.targetNode=e,this.editor&&(null===(t=this.shouldAddMenuItems)||void 0===t?void 0:t.call(this,this.editor,e))?this.items.filter((function(t){return!t.shouldShow||t.shouldShow(n.editor,e,n.context)})).map((function(t){return n.convertMenuItems(t,e)})):[]},e.prototype.setUIUtilities=function(e){this.uiUtilities=e},e.prototype.convertMenuItems=function(e,t){var n,o=this,i=null===(n=e.getSelectedId)||void 0===n?void 0:n.call(e,this.editor,t);return{key:e.key,data:e,text:c(this.strings,e.key,e.unlocalizedText),ariaLabel:c(this.strings,e.key,e.unlocalizedText),onClick:function(){return o.onClick(e,e.key)},iconProps:e.iconProps,subMenuProps:e.subItems?(0,d.__assign)({onItemClick:function(t,n){return n&&o.onClick(e,n.data)},items:(0,a.Co)(e.subItems).map((function(t){var n;return{key:t,data:t,text:c(o.strings,t,null===(n=e.subItems)||void 0===n?void 0:n[t]),className:e.itemClassName,onRender:e.itemRender?function(n){var i;return null===(i=e.itemRender)||void 0===i?void 0:i.call(e,n,(function(){return o.onClick(e,t)}))}:void 0,iconProps:t==i?{iconName:"Checkmark"}:void 0}}))},e.commandBarSubMenuProperties||{}):void 0}},e.prototype.onClick=function(e,t){this.editor&&this.targetNode&&this.uiUtilities&&e.onClick(t,this.editor,this.targetNode,this.strings,this.uiUtilities,this.context)}}();var gt=(0,d.__assign)((0,d.__assign)({},ce),{menuNameTableCellShade:null});le(),se();var ft={pasteOptionPasteAsIs:{unlocalizedText:"Paste as is",shortcut:"P",icon:"Paste"},pasteOptionPasteText:{unlocalizedText:"Paste text",shortcut:"T",icon:"PasteAsText"},pasteOptionMergeFormat:{unlocalizedText:"Paste text and merge format",shortcut:"M",icon:"ClipboardList"},pasteOptionPasteAsImage:{unlocalizedText:"Paste as image",shortcut:"I",icon:"PictureFill"}},vt=Object.keys(ft),bt=n(50840),yt=n(6017),Ct=n(20751),St=n(13706),kt=(0,K.J9)((function(e){var t=e.palette;return(0,Y.l8)({pastePane:{paddingLeft:"4px",minWidth:"72px"},optionPane:{textAlign:"center",padding:"4px"},icon:{fontSize:"14px"},buttonsContainer:{justifyContent:"center",display:"flex"},button:{width:"32px",height:"32px",margin:"0 4px 4px 0",borderRadius:"2px",flex:"0 0 auto","&:hover":{backgroundColor:t.themeLighter}},isChecked:{backgroundColor:t.themeLight,"&:hover":{backgroundColor:t.themeLighter}}})}));function Dt(e){var t=e.buttonName,n=e.paste,o=e.strings,r=e.className,a=ft[t],s=i.useCallback((function(){n(t)}),[n,t]);return i.createElement(St.K,{className:r,onClick:s,title:c(o,t,a.unlocalizedText)+(a.shortcut?" ("+a.shortcut+")":""),iconProps:{iconName:a.icon}})}var xt=i.forwardRef((function(e,t){var n=e.strings,o=e.position,r=e.paste,s=e.dismiss,l=e.isRtl,u=(0,h.D)(),p=kt(u),m=(0,d.__read)(i.useState(null),2),g=m[0],f=m[1],v=o&&(0,a.oe)(o),b=v&&{x:e.isRtl?v.left:v.right,y:v.bottom};i.useImperativeHandle(t,(function(){return{dismiss:s,setSelectedKey:f,getSelectedKey:function(){return g}}}),[s,r,l,g,f]);var y=i.useRef(null),C=i.useCallback((function(e){var t=e instanceof FocusEvent&&e.relatedTarget instanceof Node?e.relatedTarget:null;t&&y.current&&(y.current==t||y.current.contains(t))||s()}),[s]),S=i.useCallback((function(e){f(vt[0]),e.preventDefault(),e.stopPropagation()}),[f]);return i.createElement(bt.P,{gapSpace:10,isBeakVisible:!1,target:b,directionalHint:l?yt.A.bottomRightEdge:yt.A.bottomLeftEdge,directionalHintForRTL:yt.A.bottomRightEdge,preventDismissOnScroll:!0,onDismiss:C},i.createElement("div",{ref:y,className:p.pastePane},i.createElement("div",{onClick:S,className:p.optionPane},i.createElement(Ct.I,{iconName:"Paste",className:p.icon}),c(n,"pasteOptionPaneText","(Ctrl)")),g&&i.createElement("div",{className:p.buttonsContainer},(0,a.Co)(ft).map((function(e){return i.createElement(Dt,{key:e,strings:n,paste:r,buttonName:e,className:p.button+" "+(g==e?p.isChecked:"")})})))))}));var Tt,Et;!function(){function e(e){var t=this;this.strings=e,this.clipboardData=null,this.editor=null,this.uiUtilities=null,this.pasteOptionRef=i.createRef(),this.onPaste=function(e){var n;if(t.clipboardData&&t.editor){switch(t.editor.focus(),e){case"pasteOptionPasteAsIs":t.editor.paste(t.clipboardData);break;case"pasteOptionPasteText":t.editor.paste(t.clipboardData,!0);break;case"pasteOptionMergeFormat":t.editor.paste(t.clipboardData,!1,!0);break;case"pasteOptionPasteAsImage":t.editor.paste(t.clipboardData,!1,!1,!0)}null===(n=t.pasteOptionRef.current)||void 0===n||n.setSelectedKey(e)}}}e.prototype.getName=function(){return"PasteOption"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.pasteOptionRef.current)||void 0===e||e.dismiss(),this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(14==e.eventType)this.pasteOptionRef.current&&this.showPasteOptionPane();else if(this.pasteOptionRef.current)this.handlePasteOptionPaneEvent(e);else if(7==e.eventType&&"Paste"==e.source){var n=e.data;(null===n||void 0===n?void 0:n.text)&&(null===(t=n.types)||void 0===t?void 0:t.indexOf("text/html"))>=0&&(this.clipboardData=n,this.showPasteOptionPane())}},e.prototype.setUIUtilities=function(e){this.uiUtilities=e},e.prototype.handlePasteOptionPaneEvent=function(e){var t;if(0==e.eventType&&this.pasteOptionRef.current){var n=this.pasteOptionRef.current.getSelectedKey();if(n){var o=e.rawEvent;if(17!=o.which&&o.ctrlKey)return void this.pasteOptionRef.current.dismiss();for(var i=0;i<vt.length;i++){var r=vt[i];if(ft[r].shortcut==String.fromCharCode(o.which))return this.onPaste(r),void wt(o)}switch(o.which){case 27:this.pasteOptionRef.current.dismiss();break;case 37:case 39:var a=vt.length,s=39==o.which==(null===(t=this.uiUtilities)||void 0===t?void 0:t.isRightToLeft())?-1:1;this.pasteOptionRef.current.setSelectedKey(vt[(vt.indexOf(n)+s+a)%a]);break;case 13:this.onPaste(n);break;case 17:break;default:return void this.pasteOptionRef.current.dismiss()}wt(o)}else switch(e.rawEvent.which){case 17:this.pasteOptionRef.current.setSelectedKey(vt[0]),wt(e.rawEvent);break;case 27:this.pasteOptionRef.current.dismiss(),wt(e.rawEvent);break;default:this.pasteOptionRef.current.dismiss()}}},e.prototype.showPasteOptionPane=function(){var e,t;null===(e=this.pasteOptionRef.current)||void 0===e||e.dismiss();var n=null===(t=this.editor)||void 0===t?void 0:t.getFocusedPosition();n&&this.uiUtilities&&function(e,t,n,o,r){var a=null;a=He(e,i.createElement(xt,{ref:o,position:t,strings:r,isRtl:e.isRightToLeft(),dismiss:function(){null===a||void 0===a||a(),a=null},paste:n}))}(this.uiUtilities,n,this.onPaste,this.pasteOptionRef,this.strings)}}();function wt(e){e.preventDefault(),e.stopPropagation()}function _t(e){var t,n=e.emoji,o=e.onClick,r=e.isSelected,a=e.onMouseOver,s=e.onFocus,l=e.strings,c=e.id,u=e.classNames,p=n.description&&l[n.description];return i.createElement("button",(0,d.__assign)({id:c,role:"option",className:(0,S.A)(u.emoji,(t={},t[u.emojiSelected]=r,t)),onClick:o,onMouseOver:a,onFocus:s,"data-is-focusable":!0,"aria-label":p,"aria-selected":r},function(e){return function(e,t){if(!e)return e;return Object.keys(e).reduce((function(n,o){return t(o)&&(n[o]=e[o]),n}),{})}(e||{},(function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")}))}(e)),n.codePoint||"\u2026")}var It,Pt=zt("1f60a",":) :-)"),At=zt("1f609",";) ;-)"),Rt=zt("02764","<3"),Lt=zt("1f61e",":( :-("),Nt=zt("1f603",":D :-D"),Mt={key:"more",description:"emjDMore",codePoint:""},Ot=[Pt,At,Rt,Lt,Nt,Mt];!function(e){e.People="People",e.Nature="Nature",e.Activities="Activities",e.Food="Food",e.Travel="Travel",e.Symbols="Symbols",e.Objects="Objects"}(It||(It={}));var Bt=((Tt={}).People=[zt("1f601"),zt("1f602"),Nt,zt("1f604"),zt("1f605"),zt("1f606"),zt("1f607"),At,Pt,zt("1f642"),zt("1f60b"),zt("1f60c"),zt("1f60d"),zt("1f618"),zt("1f61a"),zt("1f61c"),zt("1f61d",":p :P :-p :-P"),zt("1f60e","B) B-)"),zt("1f60f"),zt("1f636"),zt("1f610",":| :-|"),zt("1f612"),zt("1f633"),Lt,zt("1f620"),zt("1f621"),zt("1f614"),zt("1f623"),zt("1f616"),zt("1f62b"),zt("1f629"),zt("1f624"),zt("1f631"),zt("1f628"),zt("1f630"),zt("1f625"),zt("1f622"),zt("1f62a"),zt("1f613"),zt("1f62d"),zt("1f635"),zt("1f632",":o :O :-o :-O"),zt("1f637"),zt("1f4a4"),Ut("1f608"),zt("1f47f"),Ut("1f479"),Ut("1f47a"),zt("1f480"),zt("1f47b"),zt("1f47d"),zt("1f63a"),zt("1f638"),zt("1f639"),zt("1f63b"),zt("1f63c"),zt("1f63d"),Ut("1f640"),zt("1f63f"),zt("1f63e"),zt("1f64c"),zt("1f44f"),zt("1f44b"),zt("1f44d"),zt("1f44e"),zt("1f44a"),zt("0270a"),zt("0270b"),zt("0270c"),zt("1f44c"),Ut("1f450"),Ut("1f596"),zt("1f4aa"),zt("1f64f"),zt("1f446"),zt("1f447"),zt("1f448"),zt("1f449"),zt("1f485"),zt("1f444"),zt("1f445"),zt("1f442"),zt("1f443"),zt("1f440"),Ut("1f464"),zt("1f476"),zt("1f466"),zt("1f467"),zt("1f468"),zt("1f469"),zt("1f471"),zt("1f474"),zt("1f475"),Ut("1f472"),Ut("1f473"),zt("1f46e"),zt("1f477"),zt("1f482"),zt("1f385"),zt("1f47c"),zt("1f478"),zt("1f470"),zt("1f6b6"),zt("1f3c3"),zt("1f483"),zt("1f46f"),zt("1f46b"),Ut("1f647"),zt("1f481"),zt("1f645"),zt("1f646"),zt("1f64b"),zt("1f64e"),zt("1f64d"),zt("1f487"),zt("1f486"),zt("1f491"),zt("1f48f"),zt("1f46a"),zt("1f45a"),zt("1f455"),zt("1f456"),zt("1f454"),zt("1f457"),zt("1f459"),zt("1f458"),zt("1f484"),zt("1f48b"),zt("1f463"),Ut("1f460"),zt("1f461"),zt("1f462"),zt("1f45e"),zt("1f45f"),zt("1f452"),zt("1f3a9"),zt("1f393"),zt("1f451"),zt("1f392"),zt("1f45d"),zt("1f45b"),zt("1f45c"),zt("1f4bc"),zt("1f453"),zt("1f48d"),zt("1f302")],Tt.Nature=[zt("1f436"),zt("1f431"),zt("1f42d"),zt("1f439"),zt("1f430"),zt("1f43b"),zt("1f43c"),Ut("1f428"),zt("1f42f"),zt("1f42e"),zt("1f437"),zt("1f43d"),zt("1f438"),zt("1f419"),zt("1f435"),zt("1f648"),zt("1f649"),zt("1f64a"),zt("1f412"),zt("1f427"),zt("1f426"),Ut("1f424"),zt("1f423"),zt("1f425"),zt("1f43a"),zt("1f417"),zt("1f434"),zt("1f41d"),zt("1f41b"),zt("1f40c"),zt("1f41e"),zt("1f41c"),zt("1f40d"),zt("1f422"),zt("1f420"),zt("1f41f"),zt("1f421"),zt("1f42c"),zt("1f433"),zt("1f414"),zt("1f42b"),zt("1f418"),zt("1f411"),zt("1f40e"),zt("1f429"),zt("1f43e"),zt("1f432"),zt("1f335"),zt("1f384"),zt("1f334"),zt("1f331"),zt("1f33f"),zt("1f340"),Ut("1f38d"),Ut("1f38b"),zt("1f343"),zt("1f342"),zt("1f341"),zt("1f33e"),zt("1f33a"),zt("1f33b"),zt("1f339"),zt("1f33c"),zt("1f337"),zt("1f338"),zt("1f344"),zt("1f490"),zt("1f330"),zt("1f383"),zt("1f41a"),Ut("1f30f"),zt("1f315"),zt("1f311"),zt("1f313"),zt("1f314"),zt("1f31b"),zt("1f319"),zt("02b50"),zt("1f31f"),Ut("1f4ab"),zt("02728"),Ut("02600"),Ut("026c5"),zt("02601"),zt("026a1"),zt("1f525"),zt("1f4a5"),zt("02744"),zt("026c4"),zt("1f4a8"),zt("02614"),Ut("1f4a7"),Ut("1f4a6"),zt("1f30a")],Tt.Activities=[zt("026bd"),zt("1f3c0"),zt("1f3c8"),zt("026be"),zt("1f3be"),zt("1f3b1"),zt("026f3"),zt("1f3bf"),zt("1f3c2"),zt("1f3a3"),zt("1f3ca"),zt("1f3c4"),zt("1f3c6"),zt("1f3bd"),zt("1f3ab"),zt("1f3ad"),zt("1f3a8"),zt("1f3aa"),zt("1f3a4"),zt("1f3a7"),zt("1f3bc"),zt("1f3b9"),zt("1f3b7"),zt("1f3ba"),zt("1f3b8"),zt("1f3bb"),zt("1f3ac"),zt("1f3ae"),zt("1f47e"),zt("1f3af"),zt("1f3b2"),zt("1f3b0"),zt("1f3b3")],Tt.Food=[zt("1f34f"),zt("1f34e"),zt("1f34a"),zt("1f34c"),zt("1f349"),zt("1f347"),zt("1f353"),zt("1f348"),zt("1f352"),zt("1f351"),zt("1f34d"),zt("1f345"),zt("1f346"),zt("1f33d"),zt("1f360"),zt("1f35e"),zt("1f357"),zt("1f356"),zt("1f364"),zt("1f373"),zt("1f354"),zt("1f35f"),zt("1f355"),zt("1f35d"),zt("1f35c"),zt("1f372"),zt("1f365"),zt("1f363"),zt("1f371"),zt("1f35b"),zt("1f359"),zt("1f35a"),zt("1f358"),zt("1f362"),zt("1f361"),Ut("1f367"),zt("1f368"),zt("1f366"),zt("1f370"),zt("1f36f"),zt("1f382"),zt("1f36e"),zt("1f36c"),zt("1f36d"),zt("1f36b"),zt("1f369"),zt("1f36a"),zt("1f37a"),zt("1f37b"),zt("1f377"),zt("1f378"),zt("1f379"),zt("1f376"),zt("1f375"),zt("02615"),zt("1f374")],Tt.Travel=[zt("1f697"),zt("1f695"),zt("1f687"),Ut("1f699"),zt("1f68c"),zt("1f693"),zt("1f69a"),Ut("1f691"),zt("1f692"),zt("1f6b2"),zt("1f6a8"),zt("1f683"),zt("1f684"),Ut("1f685"),zt("1f689"),zt("02708"),zt("026f5"),Ut("1f6a4"),zt("1f680"),zt("1f4ba"),zt("02693"),zt("1f6a7"),zt("026fd"),zt("1f68f"),zt("1f6a5"),zt("1f3c1"),zt("1f6a2"),zt("1f3a1"),zt("1f3a2"),zt("1f3a0"),zt("1f301"),Ut("1f5fc"),zt("1f3ed"),zt("026f2"),Ut("1f391"),Ut("1f5fb"),Ut("1f30b"),Ut("1f5fe"),zt("1f305"),zt("1f304"),zt("1f307"),zt("1f306"),zt("1f303"),zt("1f309"),zt("1f30c"),zt("1f387"),zt("1f386"),zt("1f308"),zt("1f3f0"),Ut("1f3ef"),zt("1f5fd"),zt("1f3e0"),zt("1f3e1"),zt("1f3e2"),zt("1f3ec"),zt("026fa"),Ut("1f3e3"),Ut("1f3e5"),zt("1f3e6"),zt("1f3e8"),zt("1f3ea"),zt("1f3eb"),Ut("1f3e9"),zt("1f492"),zt("026ea"),zt("1f320")],Tt.Symbols=[Rt,zt("1f49b"),zt("1f49a"),zt("1f499"),zt("1f494"),zt("1f49c"),zt("1f495"),zt("1f493"),zt("1f49e"),zt("1f497"),zt("1f498"),zt("1f496"),zt("1f49d"),zt("1f49f"),Ut("1f52f"),Ut("026ce"),zt("02648"),zt("02649"),zt("0264a"),zt("0264b"),zt("0264c"),zt("0264d"),zt("0264e"),zt("0264f"),zt("02650"),zt("02651"),zt("02652"),zt("02653"),Ut("1f194"),Ut("1f4f4"),Ut("1f4f3"),Ut("1f19a"),Ut("1f4ae"),Ut("1f18e"),Ut("1f191"),Ut("1f198"),Ut("026d4"),zt("1f4db"),zt("1f6ab"),Ut("0274c"),Ut("02b55"),Ut("1f4a2"),zt("02668"),Ut("1f51e"),Ut("02757"),Ut("02755"),Ut("02753"),Ut("02754"),Ut("02049"),Ut("1f4af"),zt("1f531"),Ut("0303d"),zt("026a0"),Ut("1f530"),Ut("1f22f"),Ut("1f4b9"),zt("02733"),Ut("0274e"),Ut("02705"),Ut("1f4a0"),zt("1f300"),zt("1f3e7"),zt("0267f"),zt("1f6ad"),Ut("1f6be"),zt("02734"),zt("1f17f"),zt("1f6b9"),zt("1f6ba"),Ut("1f6bc"),zt("1f6bb"),zt("1f3a6"),zt("1f4f6"),Ut("1f201"),Ut("1f196"),Ut("0267b"),Ut("1f197"),Ut("1f192"),zt("02747"),Ut("1f195"),Ut("1f193"),Ut("1f51f"),Ut("1f522"),Ut("023ea"),Ut("023e9"),Ut("1f53c"),Ut("1f53d"),Ut("023eb"),Ut("023ec"),Ut("1f199"),Ut("02139"),Ut("1f524"),Ut("1f521"),Ut("1f520"),Ut("1f523"),zt("1f3b5"),zt("1f3b6"),Ut("03030"),Ut("027bf"),Ut("02714"),zt("1f503"),Ut("02795"),Ut("02796"),Ut("02797"),Ut("02716"),Ut("027b0"),Ut("1f4b2"),Ut("1f4b1"),Ut("1f51a"),Ut("1f519"),Ut("1f51b"),Ut("1f51d"),Ut("1f51c"),Ut("02611"),Ut("1f518"),Ut("026ab"),Ut("1f534"),Ut("1f535"),Ut("1f539"),Ut("1f538"),Ut("1f536"),Ut("1f537"),Ut("1f53a"),Ut("1f53b"),Ut("02b1b"),Ut("02b1c"),Ut("1f532"),Ut("1f533"),Ut("1f50a"),zt("1f4e3"),Ut("1f4e2"),zt("1f514"),Ut("1f004"),zt("1f0cf"),Ut("1f3b4"),Ut("1f4ac"),zt("1f550"),zt("1f551"),zt("1f552"),zt("1f553"),zt("1f554"),zt("1f555"),zt("1f556"),zt("1f557"),zt("1f558"),zt("1f559"),zt("1f55a"),zt("1f55b"),Ut("1f236"),Ut("1f250"),Ut("1f239"),Ut("1f21a"),Ut("1f232"),Ut("1f251"),Ut("1f234"),Ut("1f233"),Ut("1f23a"),Ut("1f235")],Tt.Objects=[Ut("0231a"),zt("1f4f1"),Ut("1f4f2"),zt("1f4bb"),Ut("1f4bd"),zt("1f4be"),zt("1f4bf"),zt("1f4c0"),zt("1f4fc"),zt("1f4f7"),zt("1f4f9"),zt("1f3a5"),zt("1f4de"),Ut("0260e"),zt("1f4df"),zt("1f4e0"),zt("1f4fa"),zt("1f4fb"),Ut("023f0"),Ut("0231b"),Ut("023f3"),zt("1f4e1"),zt("1f50b"),zt("1f50c"),zt("1f4a1"),zt("1f526"),Ut("1f4b8"),zt("1f4b5"),zt("1f4b4"),zt("1f4b0"),zt("1f4b3"),zt("1f48e"),zt("1f527"),zt("1f528"),zt("1f529"),Ut("1f52b"),zt("1f4a3"),zt("1f52a"),zt("1f6ac"),zt("1f52e"),zt("1f488"),zt("1f48a"),zt("1f489"),zt("1f516"),zt("1f6bd"),zt("1f6c0"),zt("1f511"),zt("1f6aa"),Ut("1f5ff"),zt("1f388"),Ut("1f38f"),zt("1f380"),zt("1f381"),zt("1f38a"),zt("1f389"),Ut("1f38e"),zt("1f390"),Ut("1f38c"),Ut("1f3ee"),zt("02709"),zt("1f4e9"),zt("1f4e8"),zt("1f48c"),zt("1f4e7"),zt("1f4ee"),zt("1f4ea"),zt("1f4eb"),zt("1f4e6"),Ut("1f4e5"),Ut("1f4e4"),Ut("1f4dc"),Ut("1f4c3"),Ut("1f4d1"),zt("1f4ca"),zt("1f4c8"),zt("1f4c9"),Ut("1f4c4"),zt("1f4c5"),Ut("1f4c6"),Ut("1f4c7"),zt("1f4cb"),zt("1f4c1"),Ut("1f4c2"),zt("1f4f0"),zt("1f4d3"),Ut("1f4d5"),Ut("1f4d7"),Ut("1f4d8"),Ut("1f4d9"),Ut("1f4d4"),zt("1f4d2"),zt("1f4da"),Ut("1f4d6"),Ut("1f517"),zt("1f4ce"),zt("02702"),Ut("1f4d0"),zt("1f4cf"),zt("1f4cc"),zt("1f4cd"),Ut("1f6a9"),zt("1f510"),zt("1f512"),zt("1f513"),zt("1f50f"),Ut("02712"),zt("1f4dd"),zt("0270f"),zt("1f50d"),Ut("1f50e")],Tt),Ft=((Et={}).Activities="Soccer",Et.Food="EatDrink",Et.Nature="FangBody",Et.Objects="Lightbulb",Et.People="Emoji2",Et.Symbols="Heart",Et.Travel="Car",Et);function jt(e){!function(e){var t,n,o=(0,a.Co)(Bt);try{for(var i=(0,d.__values)(o),r=i.next();!r.done;r=i.next()){var s=r.value;if(!e(Bt[s],s))break}}catch(l){t={error:l}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}((function(t){var n,o;try{for(var i=(0,d.__values)(t),r=i.next();!r.done;r=i.next()){var a=r.value;if(!e(a))return!1}}catch(s){n={error:s}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!0}))}function Ht(e){var t,n=parseInt(e,16);if(isNaN(n))return null;n>=126976&&n<=128768?t=[Math.floor((n-65536)/1024)+55296,(n-65536)%1024+56320]:n>=35&&n<=16384&&(t=[n]);return String.fromCharCode.apply(String,(0,d.__spreadArray)([],(0,d.__read)(t),!1))}function zt(e,t){var n;return{key:e,description:"emjD"+e,keywords:"emjK"+e,shortcut:t,codePoint:null!==(n=Ht(e))&&void 0!==n?n:void 0}}function Ut(e){var t;return{key:e,description:"emjD"+e,codePoint:null!==(t=Ht(e))&&void 0!==t?t:void 0}}function Wt(e){var t=e.currentSelected,n=e.getTabId,o=e.strings,r=void 0===o?{}:o,s=e.classNames,l=(0,a.Co)(Bt),c=function(t){e.onClick&&e.onClick(t)};return i.createElement("div",{className:s.navBar,role:"tablist"},i.createElement(H.R,{direction:z.E.horizontal},l.map((function(e,o){var a,d=e===t,u=r[e];return i.createElement(W.S,{hostClassName:s.navBarTooltip,content:u,key:e},i.createElement("button",{className:(0,S.A)(s.navBarButton,(a={},a[s.selected]=d,a)),key:e,onClick:c.bind(onclick,e),id:null===n||void 0===n?void 0:n(e),role:"tab","aria-selected":d,"aria-label":u,"data-is-focusable":"true","aria-posinset":o+1,tabIndex:0,"aria-setsize":l.length},i.createElement(Ct.I,{iconName:Ft[e]})))}))))}var Kt=n(75215);function Gt(e){var t=e.emoji,n=e.strings,o=e.hasResult,r=e.classNames;if(!o){var a=n.emjDNoSuggetions;return i.createElement("div",{className:r.statusBar},i.createElement("div",{style:{display:"none"},"aria-live":"polite"},a),i.createElement("div",{className:r.statusBarNoResultDetailsContainer},i.createElement(W.S,{content:a,overflowMode:Kt.$.Parent},i.createElement("span",{role:"alert"},a))))}var s=t?t.codePoint:"",l=(null===t||void 0===t?void 0:t.description)?n[t.description]:"";return i.createElement("div",{className:r.statusBar},i.createElement("i",{className:r.statusBarIcon,role:"presentation","aria-hidden":"true"},s),i.createElement("div",{className:r.statusBarDetailsContainer},i.createElement("div",{className:r.statusBarDetails},i.createElement(W.S,{content:l,overflowMode:Kt.$.Parent},l))))}var qt=n(27480);function Vt(e,t){var n=function(e){var t=null;return e=" "+e+" ",jt((function(n){return!(n.shortcut&&(" "+n.shortcut+" ").indexOf(e)>=0)||(t=n,!1)})),t}(e);e=e.toLowerCase();var o=n?[n]:[],i=[],r=" "+(":"==e[0]?e.substr(1):e);return jt((function(e){var n=e.keywords&&t[e.keywords]||"",a=e.keywords?" "+n.toLowerCase()+" ":"",s=a.indexOf(r);return s>=0&&(" "==a[s+r.length]?o:i).push(e),!0})),o.concat(i)}var Zt,Yt,Xt=[qt.c.up,qt.c.down],$t=[qt.c.left,qt.c.right,qt.c.up,qt.c.down,qt.c.home,qt.c.end],Jt={isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:yt.A.bottomCenter};!function(e){e[e.Quick=0]="Quick",e[e.Partial=1]="Partial",e[e.Full=2]="Full"}(Zt||(Zt={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(Yt||(Yt={}));var Qt="aria-activedescendant",en="aria-autocomplete",tn="aria-expanded",nn="aria-haspopup",on="aria-owns",rn=i.forwardRef((function(e,t){var n,o,r,a=(0,d.__read)(i.useState(0),2),s=a[0],l=a[1],u=(0,d.__read)(i.useState(0),2),p=u[0],m=u[1],g=(0,d.__read)(i.useState(Ot),2),f=g[0],v=g[1],b=(0,d.__read)(i.useState("People"),2),y=b[0],C=b[1],k=(0,d.__read)(i.useState(":"),2),D=k[0],x=k[1],T=(0,d.__read)(i.useState(""),2),E=T[0],w=T[1],_=(0,h.D)(),I=sn(_),P="EmojiPane"+e.baseId,A=i.useCallback((function(e,t){t||(t=0),1===t&&-1!==s&&(e*=7);var n=s+e,o=f.length;return n>=0&&n<o?(l(n),n):-1}),[s]),R=i.useCallback((function(e,t){return null==e?"":(t&&(e=e.substr(1)),e.trim())}),[]),L=i.useCallback((function(e){var t=f[e];return t?F(t):null}),[f]),N=i.useCallback((function(){return f[s]}),[f,s]),M=i.useCallback((function(e){var t=R(e,!0),n=0===t.length?2:1;l(2===n?-1:0),m(n),v(B(t,n)),x(e),w(t)}),[p]),O=i.useCallback((function(e){var t=R(e,!1);l(0),v(B(t,p)),x(e)}),[s,D,f]),B=i.useCallback((function(t,n){var o=0===n;if(!t)return o?f:Bt[y];var i=Vt(t,e.strings);return o?i.slice(0,5).concat([Mt]):i}),[p,y,f]),F=i.useCallback((function(e){return e?P+"-"+e.key:""}),[P]);i.useImperativeHandle(t,(function(){return{navigate:A,getEmojiElementIdByIndex:L,showFullPicker:M,getSearchResult:B,setSearch:O,getSelectedEmoji:N,normalizeSearchText:R,getEmojiIconId:F}}),[A,L,M,B,O,F,N,R]);var j=function(e){r=e.target},z=function(e){e&&e.which===qt.c.enter&&s>=0&&f&&f.length>0&&J(e,f[s])},U=function(e){if(e&&!($t.indexOf(e.which)<0)){if(e.preventDefault(),e.stopPropagation(),e.which===qt.c.home)return l(0),void(o.scrollTop=0);if(e.which===qt.c.end)return l(f.length-1),void(o.scrollTop=o.scrollHeight);var t=Xt.indexOf(e.which)<0?0:1,n=A(e.which===qt.c.left||e.which===qt.c.up?-1:1,t);if(n>-1){var i=2===p?5:6,r=Math.floor(n/7),a=o.scrollTop,s=40*r;if(a<=s&&a+40*i>=s+40)return;o.scrollTop=40*r}}},W=function(t,n){var o=e.strings;return n.map((function(e,r){return i.createElement(_t,{strings:o,id:F(e),key:e.key,onMouseOver:function(){return l(r)},onFocus:function(){return l(r)},emoji:e,classNames:I,isSelected:t===r,onClick:function(t){return J(t,e)},"aria-posinset":t+1,"aria-setsize":n.length})}))},K=function(e,t,n){var o=e.strings,r=e.hideStatusBar,a=e.statusBarProps,s=n&&n.length>0;return i.createElement("div",null,i.createElement("div",{className:I.partialList,"data-is-scrollable":!0,tabIndex:-1,ref:q},i.createElement(H.R,{id:P,role:"listbox",className:I.fullListContent,ref:X},W(t,n))),!r&&i.createElement(Gt,(0,d.__assign)({classNames:I,strings:o},a,{hasResult:s,emoji:N()})))},G=function(e,t,n,o){var r=e.strings,a=e.hideStatusBar,s=e.navBarProps,l=e.statusBarProps,c=o&&o.length>0;return i.createElement("div",{className:I.fullList},i.createElement("div",{className:I.fullListBody,"data-is-scrollable":!0,tabIndex:-1,ref:q},i.createElement(Wt,(0,d.__assign)({strings:r},s,{onClick:V,currentSelected:n,getTabId:Z,classNames:I})),i.createElement("div",{role:"tabpanel","aria-labelledby":Z(n)},i.createElement("div",null,i.createElement(H.R,{id:P,role:"listbox",className:I.fullListContent,ref:X},W(t,o))))),!a&&i.createElement(Gt,(0,d.__assign)({classNames:I,strings:r},l,{hasResult:c,emoji:N()})))},q=function(e){o=e},V=function(e){var t=e;v(Bt[t]),C(t)},Z=function(t){return"family_"+t+"_"+e.baseId},Y=function(e){e&&(null===(n=e)||void 0===n?void 0:n.value)&&(n.focus(),n.setSelectionStart(n.value.length))},X=function(t){if(e.searchDisabled&&t&&t.focus(),r){r.removeAttribute(Qt);var n=F(N());n&&setTimeout((function(){return r.setAttribute(Qt,n)}),0)}},$=function(e,t){if("string"===typeof t){var n=R(t,!1),o=0===n.length?2:1;l(2===o?-1:0),v(B(n,p)),w(t),m(o)}},J=function(t,n){t.stopPropagation(),t.preventDefault(),e.onSelect&&e.onSelect(n,D)};return i.createElement(i.Fragment,null,function(e,t,n,o,r){return 0===p?function(e,t,n){var o=e.strings,r=N(),a=r?"#"+F(r):void 0,s=(null===r||void 0===r?void 0:r.description)?o[r.description]:void 0,l=W(t,n);return i.createElement("div",{id:P,role:"listbox"},l,i.createElement("div",{id:P,role:"listbox",className:(0,S.A)(I.quickPicker,I.roosterEmojiPane)},i.createElement(bt.P,(0,d.__assign)({},Jt,{role:"tooltip",target:a,hidden:!s||!l,className:I.tooltip}),s)))}(e,t,r):function(e,t,n,o,r){var a,s=e.searchDisabled,l=e.searchBoxString,u=F(N()),h=((a={})[en]="list",a[tn]="true",a[nn]="listbox",a[on]=P,a);return u&&(h[Qt]=u),i.createElement("div",{className:I.roosterEmojiPane},!s&&i.createElement(Ae.A,(0,d.__assign)({role:"combobox",componentRef:function(e){return Y(e)},value:n,onChange:$,inputClassName:I.emojiTextInput,onKeyPress:z,onKeyDown:U,onFocus:j,placeholder:c(l,"emojiSearchPlaceholder","Search..."),ariaLabel:c(l,"emojiSearchInputAriaLabel","Search...")},h)),2===p?G(e,t,o,r):K(e,t,r))}(e,t,n,o,r)}(e,s,E,y,f))}));var an=function(){return 245..toString()+"px"},sn=(0,K.J9)((function(e){var t=e.palette;return(0,Y.l8)({quickPicker:{overflowY:"hidden",":after":{content:"",position:"absolute",left:"0px",top:"0px",bottom:"0px",right:"0px",zIndex:1,borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(255, 255, 255)",borderImage:"initial",outline:"rgb(102, 102, 102) solid 1px"}},tooltip:{padding:"8px"},emojiTextInput:{padding:"6px"},partialList:{maxHeight:an(),overflow:"hidden",overflowY:"scroll"},fullListContent:{width:282..toString()+"px"},fullListBody:{maxHeight:an(),overflow:"hidden",overflowY:"scroll",height:an()},fullList:{position:"relative"},roosterEmojiPane:{padding:"1px",background:t.white},emoji:{fontSize:"18px",width:"40px",height:"40px",border:"0",position:"relative",background:t.white,transition:"backgorund 0.5s ease-in-out"},emojiSelected:{background:t.neutralLight},navBar:{top:"-1px",zIndex:10,position:"sticky"},navBarTooltip:{display:"inline-block"},navBarButton:{height:"40px",width:"40px",border:"0",borderBottom:"solid 1px",padding:0,marginBottom:0,display:"inline-block",color:t.themeDark,background:t.white,"&:hover":{cursor:"default"}},selected:{borderBottom:"2px solid",borderBottomColor:t.themeDark},statusBar:{borderTop:"solid 1px",height:"50px",overflow:"hidden",position:"relative",background:t.white},statusBarIcon:{padding:"4px",fontSize:"25px",display:"inline-block",fontStyle:"normal",fontWeight:"normal",lineHeight:"40px"},statusBarDetailsContainer:{padding:"0 4px",lineHeight:"50px",position:"absolute",display:"inline-block",left:"40px",right:"0",top:"0"},statusBarDetails:{fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},statusBarNoResultDetailsContainer:{lineHeight:"50px",position:"absolute",display:"inline-block",top:"0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",left:"0",padding:"0 8px"}})})),ln=i.forwardRef((function(e,t){var n=e.cursorRect,o=e.strings,r=e.onSelectFromPane,a=e.onHideCallout,s=e.searchBoxString,l=e.dismiss,c=e.paneRef,u=e.baseId,p=(0,d.__read)(i.useState(!0),2),h=p[0],m=p[1];i.useImperativeHandle(t,(function(){return{dismiss:l}}),[l]);var g={x:n.left,y:(n.top+n.bottom)/2},f=(n.bottom-n.top)/2+5;h||a();var v=i.useCallback((function(){m(!1),l()}),[l]);return i.createElement(i.Fragment,null,h&&i.createElement(bt.P,{target:g,directionalHint:yt.A.bottomAutoEdge,isBeakVisible:!1,gapSpace:f,onDismiss:v},function(e,t,n,o,r){return i.createElement(rn,{ref:n,baseId:o,searchBoxString:r,strings:t,onSelect:e})}(r,o,c,u,s)))}));var cn={emjDMore:"More",emjDNoSuggetions:"No suggestions found",emjD0270a:"Raised fist",emjD0270b:"Raised hand",emjD0270c:"Victory hand",emjD02764:"Red heart",emjD1f440:"Eyes",emjD1f442:"Ear",emjD1f443:"Nose",emjD1f444:"Mouth",emjD1f445:"Tongue",emjD1f446:"Up-pointing backhand index finger",emjD1f447:"Down-pointing backhand index finger",emjD1f448:"Left-pointing backhand index finger",emjD1f449:"Right-pointing backhand index finger",emjD1f44a:"Fist bump",emjD1f44b:"Waving hand",emjD1f44c:"OK hand",emjD1f44d:"Thumbs up",emjD1f44e:"Thumbs down",emjD1f44f:"Clapping hands",emjD1f450:"Open hands",emjD1f590:"Raised hand with fingers splayed",emjD1f595:"Middle finger",emjD1f596:"Raised hand with part between middle and ring fingers",emjD1f464:"Bust in silhouette",emjD1f466:"Boy",emjD1f467:"Girl",emjD1f468:"Man",emjD1f469:"Woman",emjD1f46a:"Family",emjD1f46b:"Man and woman holding hands",emjD1f46e:"Police officer",emjD1f46f:"Woman with bunny ears",emjD1f470:"Bride with veil",emjD1f471:"Person with blond hair",emjD1f472:"Man with gua pi mao",emjD1f473:"Man with turban",emjD1f474:"Older man",emjD1f475:"Older woman",emjD1f476:"Baby",emjD1f477:"Construction worker",emjD1f481:"Information desk person",emjD1f482:"Guardsman",emjD1f48b:"Kiss mark",emjD1f493:"Beating heart",emjD1f494:"Broken heart",emjD1f495:"Two hearts",emjD1f496:"Sparkling heart",emjD1f497:"Growing heart",emjD1f498:"Heart with arrow",emjD1f499:"Blue heart",emjD1f49a:"Green heart",emjD1f49b:"Yellow heart",emjD1f49c:"Purple heart",emjD1f49d:"Heart with ribbon",emjD1f49e:"Revolving hearts",emjD1f49f:"Heart decoration",emjD1f601:"Grinning face with smiling eyes",emjD1f602:"Face with tears of joy",emjD1f603:"Smiling face with open mouth",emjD1f604:"Smiling face with open mouth and smiling eyes",emjD1f605:"Smiling face with open mouth and cold sweat",emjD1f606:"Smiling face with open mouth and tightly closed eyes",emjD1f607:"Smiling face with halo",emjD1f608:"Smiling face with horns",emjD1f609:"Winking face",emjD1f60a:"Smiling face with smiling eyes",emjD1f60b:"Face savoring delicious food",emjD1f60c:"Relieved face",emjD1f60d:"Smiling face with heart-shaped eyes",emjD1f60e:"Smiling face with sunglasses",emjD1f60f:"Smirking face",emjD1f610:"Neutral face",emjD1f612:"Unamused face",emjD1f613:"Face with cold sweat",emjD1f614:"Pensive face",emjD1f616:"Confounded face",emjD1f618:"Face throwing a kiss",emjD1f61a:"Kissing face with closed eyes",emjD1f61c:"Face with stuck-out tongue and winking eye",emjD1f61d:"Face with stuck-out tongue and tightly closed eyes",emjD1f61e:"Disappointed face",emjD1f620:"Angry face",emjD1f621:"Pouting face",emjD1f622:"Crying face",emjD1f623:"Persevering face",emjD1f624:"Face with look of triumph",emjD1f625:"Disappointed but relieved face",emjD1f628:"Fearful face",emjD1f629:"Weary face",emjD1f62a:"Sleepy face",emjD1f62b:"Tired face",emjD1f62d:"Loudly crying face",emjD1f630:"Face with open mouth and cold sweat",emjD1f631:"Face screaming in fear",emjD1f632:"Astonished face",emjD1f633:"Flushed face",emjD1f635:"Dizzy face",emjD1f636:"Face without mouth",emjD1f637:"Face with medical mask",emjD1f645:"Face with No Good gesture",emjD1f646:"Face with OK gesture",emjD1f647:"Person bowing deeply",emjD1f648:"See-no-evil monkey",emjD1f649:"Hear-no-evil monkey",emjD1f641:"Slightly frowning face",emjD1f642:"Slightly smiling face",emjD1f64a:"Speak-no-evil monkey",emjD1f64b:"Happy person raising one hand",emjD1f64c:"Person raising both hands in celebration",emjD1f64d:"Person frowning",emjD1f64e:"Person with pouting face",emjD1f64f:"Person with folded hands",emjD02600:"Sun with rays",emjD02601:"Cloud",emjD02614:"Umbrella with rain drops",emjD0267b:"Recycling symbol",emjD026c4:"Snowman without snow",emjD026c5:"Sun behind cloud",emjD02728:"Sparkles",emjD02733:"Eight-spoked asterisk",emjD02734:"Eight-pointed star",emjD02744:"Snowflake",emjD02747:"Sparkle",emjD02b50:"White medium star",emjD1f300:"Cyclone",emjD1f301:"Foggy",emjD1f302:"Closed umbrella",emjD1f303:"Night with stars",emjD1f304:"Sunrise over mountains",emjD1f305:"Sunrise",emjD1f306:"Cityscape at dusk",emjD1f307:"Sunset over buildings",emjD1f308:"Rainbow",emjD1f309:"Bridge at night",emjD1f30a:"Water wave",emjD1f30b:"Volcano",emjD1f30c:"Milky Way",emjD1f311:"New moon",emjD1f313:"First quarter moon",emjD1f314:"Waxing gibbous moon",emjD1f315:"Full moon",emjD1f319:"Crescent moon",emjD1f31b:"First quarter moon with face",emjD1f31f:"Glowing star",emjD1f320:"Shooting star",emjD1f330:"Chestnut",emjD1f331:"Seedling",emjD1f334:"Palm tree",emjD1f335:"Cactus",emjD1f337:"Tulip",emjD1f338:"Cherry blossom",emjD1f339:"Rose",emjD1f33a:"Hibiscus",emjD1f33b:"Sunflower",emjD1f33c:"Blossom",emjD1f33d:"Ear of corn",emjD1f33e:"Ear of rice",emjD1f33f:"Herb",emjD1f340:"Four leaf clover",emjD1f341:"Maple leaf",emjD1f342:"Fallen leaf",emjD1f343:"Leaf fluttering in wind",emjD1f344:"Mushroom",emjD1f40c:"Snail",emjD1f40d:"Snake",emjD1f40e:"Horse",emjD1f411:"Sheep",emjD1f412:"Monkey",emjD1f414:"Chicken",emjD1f417:"Boar",emjD1f418:"Elephant",emjD1f419:"Octopus",emjD1f41a:"Spiral shell",emjD1f41b:"Bug",emjD1f41c:"Ant",emjD1f41d:"Honeybee",emjD1f41e:"Ladybug",emjD1f41f:"Fish",emjD1f420:"Tropical fish",emjD1f421:"Blowfish",emjD1f422:"Turtle",emjD1f423:"Hatching chick",emjD1f424:"Baby chick",emjD1f425:"Front-facing baby chick",emjD1f426:"Bird",emjD1f427:"Penguin",emjD1f428:"Koala",emjD1f429:"Poodle",emjD1f42b:"Bactrian camel",emjD1f42c:"Dolphin",emjD1f42d:"Mouse face",emjD1f42e:"Cow face",emjD1f42f:"Tiger face",emjD1f430:"Rabbit face",emjD1f431:"Cat face",emjD1f432:"Dragon face",emjD1f433:"Spouting whale",emjD1f434:"Horse face",emjD1f435:"Monkey face",emjD1f436:"Dog face",emjD1f437:"Pig face",emjD1f438:"Frog face",emjD1f439:"Hamster face",emjD1f43a:"Wolf face",emjD1f43b:"Bear face",emjD1f43c:"Panda face",emjD1f43d:"Pig nose",emjD1f43e:"Paw prints",emjD1f638:"Grinning cat face with smiling eyes",emjD1f639:"Cat face with tears of joy",emjD1f63a:"Smiling cat face with open mouth",emjD1f63b:"Smiling cat face with heart-shaped eyes",emjD1f63c:"Cat face with wry smile",emjD1f63d:"Kissing cat face with closed eyes",emjD1f63e:"Pouting cat face",emjD1f63f:"Crying cat face",emjD1f640:"Weary cat face",emjD0260e:"Telephone",emjD026bd:"Soccer ball",emjD026be:"Baseball",emjD1f004:"Mahjong tile red dragon",emjD1f380:"Ribbon",emjD1f381:"Wrapped present",emjD1f382:"Birthday cake",emjD1f383:"Jack-o-lantern",emjD1f384:"Christmas tree",emjD1f385:"Father Christmas",emjD1f386:"Fireworks",emjD1f387:"Firework sparkler",emjD1f388:"Balloon",emjD1f389:"Party popper",emjD1f38a:"Confetti ball",emjD1f38b:"Tanabata tree",emjD1f38c:"Crossed flags",emjD1f38d:"Pine decoration",emjD1f38e:"Japanese dolls",emjD1f38f:"Carp streamer",emjD1f390:"Wind chime",emjD1f391:"Moon-viewing ceremony",emjD1f392:"School backpack",emjD1f393:"Graduation cap",emjD1f3a0:"Carousel horse",emjD1f3a1:"Ferris wheel",emjD1f3a2:"Roller coaster",emjD1f3a3:"Fishing pole and fish",emjD1f3a4:"Microphone",emjD1f3a5:"Movie camera",emjD1f3a6:"Cinema",emjD1f3a7:"Headphones",emjD1f3a8:"Artist palette",emjD1f3a9:"Top hat",emjD1f3aa:"Circus tent",emjD1f3ab:"Ticket",emjD1f3ac:"Clapper board",emjD1f3ad:"Performing arts",emjD1f3ae:"Video game",emjD1f3af:"Direct hit",emjD1f3b0:"Slot machine",emjD1f3b1:"Billiards",emjD1f3b2:"Game die",emjD1f3b3:"Bowling",emjD1f3b4:"Flower playing cards",emjD1f3b5:"Musical note",emjD1f3b6:"Multiple musical notes",emjD1f3b7:"Saxophone",emjD1f3b8:"Guitar",emjD1f3b9:"Musical keyboard",emjD1f3ba:"Trumpet",emjD1f3bb:"Violin",emjD1f3bc:"Musical score",emjD1f3bd:"Running shirt with sash",emjD1f3be:"Tennis racquet and ball",emjD1f3bf:"Ski and ski boot",emjD1f3c0:"Basketball and hoop",emjD1f3c1:"Checkered flag",emjD1f3c2:"Snowboarder",emjD1f3c3:"Runner",emjD1f3c4:"Surfer",emjD1f3c6:"Trophy",emjD1f3c8:"American football",emjD1f3ca:"Swimmer",emjD1f478:"Princess",emjD1f479:"Japanese ogre",emjD1f47a:"Japanese goblin",emjD1f47b:"Ghost",emjD1f47c:"Baby angel",emjD1f47d:"Extraterrestrial alien",emjD1f47e:"Alien monster",emjD1f47f:"Imp",emjD1f480:"Skull",emjD1f483:"Dancer",emjD1f484:"Lipstick",emjD1f485:"Nail polish",emjD1f486:"Face massage",emjD1f487:"Haircut",emjD1f488:"Barber pole",emjD1f489:"Syringe",emjD1f48a:"Pill",emjD1f48c:"Love letter",emjD1f48d:"Ring",emjD1f48e:"Gemstone",emjD1f48f:"Kiss",emjD1f490:"Bouquet",emjD1f491:"Couple with heart",emjD1f492:"Wedding",emjD1f4f7:"Camera",emjD1f4f9:"Video camera",emjD1f4fa:"Television",emjD1f4fb:"Radio",emjD1f4fc:"Videocassette",emjD02615:"Hot beverage",emjD02702:"Scissors",emjD02709:"Envelope",emjD0270f:"Pencil",emjD02712:"Nib",emjD1f345:"Tomato",emjD1f346:"Eggplant",emjD1f347:"Grapes",emjD1f348:"Melon",emjD1f349:"Watermelon",emjD1f34a:"Tangerine",emjD1f34c:"Banana",emjD1f34d:"Pineapple",emjD1f34e:"Red apple",emjD1f34f:"Green apple",emjD1f351:"Peach",emjD1f352:"Cherries",emjD1f353:"Strawberry",emjD1f354:"Hamburger",emjD1f355:"Slice of pizza",emjD1f356:"Meat on bone",emjD1f357:"Poultry leg",emjD1f358:"Rice cracker",emjD1f359:"Rice ball",emjD1f35a:"Cooked rice",emjD1f35b:"Curry and rice",emjD1f35c:"Steaming bowl",emjD1f35d:"Spaghetti",emjD1f35e:"Bread",emjD1f35f:"French fries",emjD1f360:"Roasted sweet potato",emjD1f361:"Dango",emjD1f362:"Oden",emjD1f363:"Sushi",emjD1f364:"Fried shrimp",emjD1f365:"Fish cake with swirl design",emjD1f366:"Soft ice cream",emjD1f367:"Shaved ice",emjD1f368:"Ice cream",emjD1f369:"Doughnut",emjD1f36a:"Cookie",emjD1f36b:"Chocolate bar",emjD1f36c:"Candy",emjD1f36d:"Lollipop",emjD1f36e:"Custard",emjD1f36f:"Honey pot",emjD1f370:"Shortcake",emjD1f371:"Bento box",emjD1f372:"Pot of food",emjD1f373:"Cooking",emjD1f374:"Fork and knife",emjD1f375:"Teacup without handle",emjD1f376:"Sake bottle and cup",emjD1f377:"Wine glass",emjD1f378:"Cocktail glass",emjD1f379:"Tropical drink",emjD1f37a:"Beer mug",emjD1f37b:"Clinking beer mugs",emjD1f451:"Crown",emjD1f452:"Woman's hat",emjD1f453:"Eyeglasses",emjD1f454:"Necktie",emjD1f455:"T-shirt",emjD1f456:"Jeans",emjD1f457:"Dress",emjD1f458:"Kimono",emjD1f459:"Bikini",emjD1f45a:"Woman's clothes",emjD1f45b:"Purse",emjD1f45c:"Handbag",emjD1f45d:"Pouch",emjD1f45e:"Man's shoe",emjD1f45f:"Athletic shoe",emjD1f460:"High-heeled shoe",emjD1f461:"Woman's sandal",emjD1f462:"Woman's boots",emjD1f463:"Footprints",emjD1f4ba:"Seat",emjD1f4bb:"Personal computer",emjD1f4bc:"Briefcase",emjD1f4bd:"Minidisc",emjD1f4be:"Floppy disk",emjD1f4bf:"Optical disc",emjD1f4c0:"DVD",emjD1f4c1:"File folder",emjD1f4c2:"Open file folder",emjD1f4c3:"Page with curl",emjD1f4c4:"Page facing up",emjD1f4c5:"Calendar",emjD1f4c6:"Tear-off calendar",emjD1f4c7:"Card index",emjD1f4c8:"Chart with upward trend",emjD1f4c9:"Chart with downward trend",emjD1f4ca:"Bar chart",emjD1f4cb:"Clipboard",emjD1f4cc:"Pushpin",emjD1f4cd:"Round pushpin",emjD1f4ce:"Paper clip",emjD1f4cf:"Straight ruler",emjD1f4d0:"Triangular ruler",emjD1f4d1:"Bookmark tabs",emjD1f4d2:"Ledger",emjD1f4d3:"Notebook",emjD1f4d4:"Notebook with decorative cover",emjD1f4d5:"Closed book",emjD1f4d6:"Open book",emjD1f4d7:"Green book",emjD1f4d8:"Blue book",emjD1f4d9:"Orange book",emjD1f4da:"Books",emjD1f4db:"Name badge",emjD1f4dc:"Scroll",emjD1f4dd:"Memo",emjD1f4de:"Telephone receiver",emjD1f4df:"Pager",emjD1f4e0:"Fax machine",emjD1f4e1:"Satellite antenna",emjD1f4e2:"Public address loudspeaker",emjD1f4e3:"Cheering megaphone",emjD1f4e4:"Outbox tray",emjD1f4e5:"Inbox tray",emjD1f4e6:"Package",emjD1f4e7:"Email",emjD1f4e8:"Incoming envelope",emjD1f4e9:"Envelope with downward-facing arrow above",emjD1f4ea:"Closed mailbox with lowered flag",emjD1f4eb:"Closed mailbox with raised flag",emjD1f4ee:"Postbox",emjD1f4f0:"Newspaper",emjD1f4f1:"Mobile phone",emjD1f4f2:"Mobile phone with right-facing arrow at left",emjD1f4f3:"Vibration mode",emjD1f4f4:"Mobile phone off",emjD1f4f6:"Antenna with bars",emjD1f525:"Fire",emjD1f526:"Flashlight",emjD1f527:"Wrench",emjD1f528:"Hammer",emjD1f529:"Nut and bolt",emjD1f52a:"Hocho",emjD1f52b:"Pistol",emjD1f52e:"Crystal ball",emjD1f52f:"Six-pointed star with middle dot",emjD1f531:"Trident emblem",emjD1f550:"Clock face one o'clock",emjD1f551:"Clock face two o'clock",emjD1f552:"Clock face three o'clock",emjD1f553:"Clock face four o'clock",emjD1f554:"Clock face five o'clock",emjD1f555:"Clock face six o'clock",emjD1f556:"Clock face seven o'clock",emjD1f557:"Clock face eight o'clock",emjD1f558:"Clock face nine o'clock",emjD1f559:"Clock face ten o'clock",emjD1f55a:"Clock face eleven o'clock",emjD1f55b:"Clock face twelve o'clock",emjD02668:"Hot springs",emjD0267f:"Wheelchair",emjD02693:"Anchor",emjD026a0:"Warning",emjD026a1:"High Voltage",emjD026d4:"No Entry",emjD026ea:"Church",emjD026f2:"Fountain",emjD026f3:"Flag in hole",emjD026f5:"Sailboat",emjD026fa:"Tent",emjD026fd:"Fuel pump",emjD02708:"Airplane",emjD1f17f:"Squared Latin capital letter P",emjD1f3e0:"House building",emjD1f3e1:"House with garden",emjD1f3e2:"Office building",emjD1f3e3:"Japanese post office",emjD1f3e5:"Hospital",emjD1f3e6:"Bank",emjD1f3e7:"Automated teller machine",emjD1f3e8:"Hotel",emjD1f3e9:"Love hotel",emjD1f3ea:"Convenience store",emjD1f3eb:"School",emjD1f3ec:"Department store",emjD1f3ed:"Factory",emjD1f3ee:"Izakaya lantern",emjD1f3ef:"Japanese castle",emjD1f3f0:"European castle",emjD1f530:"Japanese symbol for beginner",emjD1f680:"Rocket",emjD1f683:"Railway car",emjD1f684:"High-speed train",emjD1f685:"High-speed train with bullet nose",emjD1f687:"Metro",emjD1f689:"Station",emjD1f68c:"Bus",emjD1f68f:"Bus stop",emjD1f691:"Ambulance",emjD1f692:"Fire engine",emjD1f693:"Police car",emjD1f695:"Taxi",emjD1f697:"Automobile",emjD1f699:"Recreational vehicle",emjD1f69a:"Delivery truck",emjD1f6a2:"Ship",emjD1f6a4:"Speedboat",emjD1f6a5:"Horizontal traffic light",emjD1f6a7:"Construction",emjD1f6a8:"Police car's revolving light",emjD1f6a9:"Triangular flag on post",emjD1f6aa:"Door",emjD1f6ab:"No entry",emjD1f6ac:"Smoking symbol",emjD1f6ad:"No smoking symbol",emjD1f6b2:"Bicycle",emjD1f6b6:"Pedestrian",emjD1f6b9:"Men's symbol",emjD1f6ba:"Women's symbol",emjD1f6bb:"Restroom",emjD1f6bc:"Baby symbol",emjD1f6bd:"Toilet",emjD1f6be:"Water closet",emjD1f6c0:"Bath",emjD02049:"Exclamation question mark",emjD02139:"Information source",emjD021a9:"Left-facing arrow with hook",emjD021aa:"Right-facing arrow with hook",emjD0231a:"Watch",emjD0231b:"Hourglass",emjD023e9:"Right-pointing double triangle",emjD023ea:"Left-pointing double triangle",emjD023eb:"Up-pointing double triangle",emjD023ec:"Down-pointing double triangle",emjD023f0:"Alarm clock",emjD023f3:"Hourglass with flowing sand",emjD024c2:"Circled Latin capital letter M",emjD025b6:"Black right-pointing triangle",emjD025c0:"Black left-pointing triangle",emjD025fb:"White medium square",emjD025fc:"Black medium square",emjD026ce:"Ophiuchus",emjD02611:"Ballot box with check",emjD0261d:"White up-pointing index",emjD02648:"Aries",emjD02649:"Taurus",emjD0264a:"Gemini",emjD0264b:"Cancer",emjD0264c:"Leo",emjD0264d:"Virgo",emjD0264e:"Libra",emjD0264f:"Scorpio",emjD02650:"Sagittarius",emjD02651:"Capricorn",emjD02652:"Aquarius",emjD02653:"Pisces",emjD026aa:"Medium white circle",emjD026ab:"Medium black circle",emjD02705:"White heavy check mark",emjD02714:"Heavy check mark",emjD02716:"Heavy multiplication x",emjD0274c:"Cross mark",emjD0274e:"Squared cross mark",emjD02753:"question mark ornament",emjD02754:"White question mark ornament",emjD02755:"White exclamation mark ornament",emjD02757:"Heavy exclamation mark",emjD02795:"Heavy plus sign",emjD02796:"Heavy minus sign",emjD02797:"Heavy division sign",emjD027a1:"Black right-facing arrow",emjD027b0:"Curly loop",emjD027bf:"Double curly loop",emjD02934:"Arrow pointing right then curving upward",emjD02935:"Arrow pointing right then curving downward",emjD02b05:"Black arrow pointing left",emjD02b06:"Black arrow pointing right",emjD02b07:"Downwards black arrow",emjD02b1b:"Black large square",emjD02b1c:"White large square",emjD02b55:"Heavy large circle",emjD03030:"Wavy dash",emjD0303d:"Part alternation mark",emjD03297:"Circled Ideograph congratulation",emjD03299:"Circled Ideograph secret",emjD1f0cf:"Playing card Joker",emjD1f170:"Squared Latin capital letter A",emjD1f171:"Squared Latin capital letter B",emjD1f17e:"Squared Latin capital letter O",emjD1f18e:"Squared AB",emjD1f191:"Squared CL",emjD1f192:"Squared COOL",emjD1f193:"Squared FREE",emjD1f194:"Squared ID",emjD1f195:"Squared NEW",emjD1f196:"Squared NG",emjD1f197:"Squared OK",emjD1f198:"Squared SOS",emjD1f199:"Squared UP!",emjD1f19a:"Squared VS",emjD1f201:"Squared Katakana Koko",emjD1f202:"Squared Katakana Sa",emjD1f21a:"Squared CJK Unified Ideograph-7121",emjD1f22f:"Squared CJK Unified Ideograph-6307",emjD1f232:"Squared CJK Unified Ideograph-7981",emjD1f233:"Squared CJK Unified Ideograph-7a7a",emjD1f234:"Squared CJK Unified Ideograph-5408",emjD1f235:"Squared CJK Unified Ideograph-6e80",emjD1f236:"Squared CJK Unified Ideograph-6709",emjD1f237:"Squared CJK Unified Ideograph-6708",emjD1f238:"Squared CJK Unified Ideograph-7533",emjD1f239:"Squared CJK Unified Ideograph-5272",emjD1f23a:"Squared CJK Unified Ideograph-55b6",emjD1f250:"Circled Ideograph advantage",emjD1f251:"Circled Ideograph accept",emjD1f30f:"Earth globe Asia-Australia",emjD1f4a0:"Diamond shape with a dot inside",emjD1f4a1:"Electric light bulb",emjD1f4a2:"Anger",emjD1f4a3:"Bomb",emjD1f4a4:"Sleeping",emjD1f4a5:"Collision",emjD1f4a6:"Splashing sweat",emjD1f4a7:"Droplet",emjD1f4a8:"Dash",emjD1f4a9:"Pile of poo",emjD1f4aa:"Flexed biceps",emjD1f4ab:"Dizzy",emjD1f4ac:"Speech balloon",emjD1f4ae:"White flower",emjD1f4af:"Hundred points",emjD1f4b0:"Money bag",emjD1f4b1:"Currency exchange",emjD1f4b2:"Heavy dollar sign",emjD1f4b3:"Credit card",emjD1f4b4:"Banknote with yen sign",emjD1f4b5:"Banknote with dollar sign",emjD1f4b8:"Money with wings",emjD1f4b9:"Chart with upwards trend and yen sign",emjD1f503:"Clockwise downward and upward open circle arrows",emjD1f50a:"Speaker with three sound waves",emjD1f50b:"Battery",emjD1f50c:"Electric plug",emjD1f50d:"Left-leaning magnifying glass",emjD1f50e:"Right-leaning magnifying glass",emjD1f50f:"Lock with ink pen",emjD1f510:"Closed lock with key",emjD1f511:"Key",emjD1f512:"Lock",emjD1f513:"Open lock",emjD1f514:"Bell",emjD1f516:"Bookmark",emjD1f517:"Link",emjD1f518:"Radio button",emjD1f519:"Back with left-facing arrow above",emjD1f51a:"End with left-facing arrow above",emjD1f51b:"On with exclamation mark with left right arrow above",emjD1f51c:"Soon with right-facing arrow above",emjD1f51d:"Top with upward arrow above",emjD1f51e:"No one under eighteen",emjD1f51f:"Keycap ten",emjD1f520:"Input Latin uppercase",emjD1f521:"Input Latin lowercase",emjD1f522:"Input numbers",emjD1f523:"Input symbols",emjD1f524:"Input Latin letters",emjD1f532:"Black square button",emjD1f533:"White square button",emjD1f534:"Large red circle",emjD1f535:"Large blue circle",emjD1f536:"Large orange diamond",emjD1f537:"Large blue diamond",emjD1f538:"Small orange diamond",emjD1f539:"Small blue diamond",emjD1f53a:"Up-pointing red triangle",emjD1f53b:"Down-pointing red triangle",emjD1f53c:"Up-pointing small red triangle",emjD1f53d:"Down-pointing small red triangle",emjD1f5fb:"Mount Fuji",emjD1f5fc:"Tokyo Tower",emjD1f5fd:"Statue of Liberty",emjD1f5fe:"Silhouette of Japan",emjD1f5ff:"Moyai"},dn={emjK1f607:"saint angel innocent",emjK1f47c:"cherub angel",emjK1f34e:"apple",emjK1f34f:"apple",emjK1f477:"construction",emjK1f6a7:"construction detour",emjK1f491:"couple engaged married marry marriage",emjK1f46b:"couple engaged",emjK1f622:"crying sad",emjK1f62d:"crying sad",emjK1f525:"fire",emjK1f692:"fire truck fire engine",emjK1f386:"fireworks sparkler july 4th",emjK1f387:"fireworks sparkler july 4th",emjK1f44a:"punch fist pump chuck norris bam",emjK0270a:"fist pump punch",emjK1f498:"heart love cupid",emjK1f496:"heart love",emjK1f497:"love heart",emjK1f493:"heart love heartbeat",emjK1f368:"ice cream dessert treat sundae sweets",emjK1f366:"ice cream dessert treat sweets",emjK1f48b:"kiss xoxo love kisses kissing mwah",emjK1f444:"kiss mouth",emjK1f618:"kiss love kisses kissing",emjK1f61a:"kiss love kisses kissing smooch",emjK1f48f:"kiss love",emjK1f435:"monkey",emjK1f64a:"monkey speak no evil",emjK1f649:"monkey hear no evil",emjK1f648:"monkey see no evil",emjK1f3b6:"music melody song singing tune jingle",emjK1f3b5:"music musical note melody musical",emjK1f44c:"ok okay perfect",emjK1f646:"ok awesome",emjK1f621:"pouting sad pout",emjK1f64e:"pouting sad depressed",emjK1f60c:"relieved phew whew relief",emjK1f630:"relieved phew whew",emjK1f605:"relieved phew whew sheesh",emjK1f380:"ribbon",emjK1f381:"gift present presents ribbon",emjK1f613:"scared yikes scary uh oh",emjK1f631:"scared yikes fear whoa",emjK1f629:"scared anxious uncertain unsure",emjK1f628:"scared fearful",emjK1f45e:"shoe shoes",emjK1f45f:"shoe shoes",emjK1f60a:"smile happy smiling yay",emjK1f642:"smile happy smiling",emjK1f603:"smiling happy excited woo woohoo woot",emjK1f604:"smiling happy grin excited",emjK1f6bd:"toilet bathroom potty restroom washroom",emjK1f6ba:"toilet bathroom",emjK1f6b9:"toilet bathroom",emjK1f684:"train light rail monorail",emjK1f683:"train caboose",emjK1f446:"up click",emjK0261d:"up",emjK1f64b:"wave hi bye hey aloha",emjK1f44b:"wave hi bye waving high five",emjK1f601:"happy grin lol funny grinning hehe",emjK1f602:"happy lol funny joy lmao rofl",emjK1f606:"lol haha laughing lmao",emjK1f609:"haha winking wink winky",emjK1f60f:"haha winking wink smirking smirk heh",emjK1f645:"bad",emjK1f44e:"bad thumbs down wrong boo",emjK1f60d:"love love you loving love u",emjK1f495:"love hearts",emjK1f44d:"ok thumbs up",emjK1f610:"ok umm",emjK1f620:"mad angry grrr",emjK1f612:"mad angry unamused not funny amused bleh blah",emjK1f47b:"scared halloween ghost boo",emjK1f480:"scared skull danger die death poison",emjK1f47e:"scared monster",emjK1f365:"rice ball fish cake",emjK1f61e:"disappointed sad",emjK1f64d:"disappointed sad frown",emjK1f494:"heartbroken sorrow sad broken heart brokenhearted",emjK1f625:"relieved phew",emjK1f62b:"sleepy tired yawn",emjK1f4a4:"sleepy tired sleep zzz",emjK1f62a:"sleepy tired",emjK1f632:"wow astonished",emjK1f633:"wow flushed",emjK1f3c4:"wave surf surfer surfers surfs surfing",emjK1f44f:"yay clapping applause clap",emjK1f64c:"yay celebrate",emjK1f48d:"ring marry fiance engaged engage engagement ring engagement diamond ring bling",emjK1f483:"party dancer dance dancing",emjK1f389:"party fun congratulations celebrate congrats",emjK1f388:"party fun balloon",emjK1f38a:"party confetti surprise",emjK1f383:"happy halloween trick treat halloween pumpkin",emjK1f385:"merry christmas santa claus father xmas",emjK1f384:"merry christmas tree happy holidays",emjK1f3eb:"school college study teacher learn studying",emjK1f392:"backpack school bag back pack",emjK1f41f:"fish goldfish",emjK1f3a3:"fish fishing fishing pole",emjK1f3a5:"video camera film movie movie camera",emjK1f4f9:"video camera",emjK1f3a6:"theatre theater cinema",emjK1f3ad:"performing arts drama shakespeare theatre theater play actor actress",emjK1f3bc:"treble clef sheet music music musical score",emjK1f3b9:"music piano",emjK1f3a7:"music headphones headphone",emjK1f3b7:"music saxophone sax",emjK1f3ba:"music trumpet",emjK1f3b8:"music guitar",emjK1f3bb:"music violin",emjK1f3ac:"film action movie",emjK1f48e:"diamond stone gem",emjK1f3be:"wimbledon tennis raquet tennis sports racquet",emjK1f3c8:"football superbowl sports nfl",emjK1f3bf:"sports winter ski skiing skis",emjK1f3c2:"sports winter snowboard snowboarder snowboarding snowboards",emjK026c4:"winter snow snowman",emjK02744:"winter snow snowflake snowing snowed christmas xmas blizzard",emjK1f3c1:"race finish nascar",emjK1f3c3:"race run marathon runner sprinting running late",emjK1f375:"tea coffee",emjK02615:"coffee tea",emjK1f377:"alcohol wine",emjK1f378:"alcohol cocktail drinks martini happy hour",emjK1f379:"alcohol tropical drink",emjK1f68c:"bus transit",emjK1f687:"bus transit metro",emjK1f43b:"bear teddy",emjK1f43c:"bear panda",emjK1f340:"luck lucky st. patrick's day shamrock",emjK1f320:"luck shooting star wish comet asteroid meteor meteroid",emjK1f303:"skyline starry stars night",emjK1f307:"skyline sunset",emjK1f31f:"star twinkle",emjK02747:"star sparkle glitter",emjK1f4b0:"cash loot",emjK1f4b5:"cash money dollar",emjK1f4b4:"yen money",emjK1f4b3:"money credit debt debit credit card",emjK1f60b:"dinner hungry lunch food yummy yum delicious tasty mmmmm",emjK1f60e:"cool",emjK1f614:"alas thinking sigh",emjK1f616:"confused confounded huh",emjK1f61c:"goofy wassup nyah kidding",emjK1f61d:"gross yuck eww blech",emjK1f623:"persevering",emjK1f624:"triumph congratulations grats congrats yahoo ftw woot wahoo",emjK1f635:"dizzy drunk confused",emjK1f636:"unsure",emjK1f637:"sick flu",emjK1f440:"eyes snoop",emjK1f442:"ear listen",emjK1f443:"nose smell",emjK1f445:"tongue lick taste drool",emjK1f447:"down",emjK1f448:"left",emjK1f449:"right",emjK1f64f:"pray praying prayer",emjK0270b:"hand",emjK0270c:"peace victory",emjK1f466:"boy",emjK1f467:"girl",emjK1f468:"man",emjK1f469:"woman",emjK1f46a:"family",emjK1f46e:"police officer cop",emjK1f46f:"bunny ears costume",emjK1f470:"bride marriage bridezilla",emjK1f471:"blond",emjK1f474:"grandpa old man gramps grandfather",emjK1f475:"grandma old lady old woman grandmother",emjK1f476:"baby kid toddler newborn infant",emjK1f382:"birthday cake happy cake",emjK1f390:"chime",emjK1f393:"graduation college high school graduated graduating graduate grad",emjK1f0cf:"cards card joker blackjack poker",emjK1f3a0:"carousel carnival",emjK1f3a1:"ferris wheel amusement park",emjK1f3a2:"roller coaster",emjK1f3a4:"microphone sing karaoke singing",emjK1f3a8:"paint artist palette artist",emjK1f3a9:"top hat black tie",emjK1f3aa:"circus",emjK1f3ab:"ticket stub ticket stub admission",emjK1f3ae:"xbox video game video games controller",emjK1f3af:"bullseye archery darts arrow",emjK1f3b0:"slot slots machine casino gamble gambling",emjK1f3b1:"pool billiards",emjK1f3b2:"die dice game craps gambling casino gamble",emjK1f3b3:"bowling bowl",emjK1f4f7:"camera picture photo",emjK1f4fa:"tv television",emjK1f4fb:"radio",emjK1f4fc:"videotape videocassette cassette vcr",emjK1f478:"princess",emjK1f47d:"alien ufo",emjK1f47f:"imp pixie loki leprechaun",emjK1f484:"lipstick makeup",emjK1f485:"nail polish manicure",emjK1f486:"massage",emjK1f487:"haircut",emjK1f488:"barber barbershop",emjK1f489:"syringe shot needle",emjK1f48a:"pill pills drug drugs",emjK1f48c:"love letter",emjK1f490:"flowers bouquet love",emjK1f492:"wedding marry church",emjK1f3c0:"basketball bball hoops",emjK1f3c6:"win trophy champions champion",emjK1f3ca:"swim swimmer swimming swims",emjK026bd:"soccer ball",emjK026be:"baseball",emjK1f451:"crown king queen",emjK1f453:"glasses hipster",emjK1f454:"tie",emjK1f455:"tshirt tshirts",emjK1f456:"jeans pants",emjK1f457:"dress",emjK1f459:"bikini bathing suit swimsuit swim",emjK1f45b:"purse",emjK1f45c:"handbag purse",emjK1f45d:"pouch clutch",emjK1f461:"sandal heels heel shoe shoes sandals pumps",emjK1f462:"boots boot",emjK1f463:"footprints barefoot",emjK1f4dd:"memo note",emjK1f4de:"telephone call phone",emjK1f4df:"pager",emjK1f4e0:"fax machine",emjK1f4e1:"satellite antenna",emjK1f4e3:"megaphone cheering",emjK1f4e6:"present package parcel",emjK1f4e7:"email mail",emjK1f4ee:"mail post",emjK1f4f0:"newspaper news",emjK1f4f1:"phone cell call",emjK1f4f6:"wifi signal",emjK1f526:"flashlight",emjK1f527:"wrench",emjK1f528:"hammer hammers",emjK1f529:"nuts bolts",emjK1f52a:"knife",emjK1f52e:"crystal ball clairvoyance clairvoyant psychic mystic",emjK1f531:"trident",emjK1f354:"hamburger fast burger hamburgers burgers food hungry",emjK1f355:"pizza fast food hungry dinner lunch",emjK1f356:"meat dinner lunch hungry food",emjK1f357:"chicken leg turkey leg meat chicken turkey hungry dinner lunch food drumstick",emjK1f35a:"rice dinner hungry lunch food",emjK1f35c:"noodles ramen food dinner lunch",emjK1f35d:"spaghetti dinner noodles food hungry",emjK1f35e:"bread food",emjK1f35f:"fries fast food french fries food",emjK1f360:"potato potatoes vegetable food",emjK1f363:"sushi food maki",emjK1f364:"fried shrimp shrimp seafood food tempura",emjK1f369:"doughnut doughnuts donut donuts food sweets",emjK1f36a:"cookie cookies food sweets",emjK1f36b:"chocolate chocolates candy bar chocolate bar sweets",emjK1f36c:"candy sweet sweets treat",emjK1f36d:"lollipop candy treat sucker",emjK1f36e:"custard",emjK1f36f:"honey pot",emjK1f370:"pie food hungry cake dessert cheesecake shortcake sweets",emjK1f371:"bento box",emjK1f372:"soup pot of food stew",emjK1f374:"food dinner fork knife eat hungry meal restaurant",emjK1f376:"sake alcohol",emjK1f37a:"beer alcohol",emjK1f37b:"cheers beers alcohol",emjK1f345:"food vegetable fruit tomato",emjK1f346:"eggplant food vegetable",emjK1f347:"grapes fruit food",emjK1f348:"melon honeydew food fruit",emjK1f349:"watermelon melon food fruit",emjK1f34a:"tangerine fruit food orange mandarin clementine slice slices",emjK1f34c:"banana fruit food",emjK1f34d:"pineapple fruit food",emjK1f351:"peach peaches fruit food",emjK1f352:"cherry cherries fruit food",emjK1f353:"strawberries stawberry fruit food berry berries",emjK1f4ba:"seat",emjK1f4bb:"pc computer laptop tablet",emjK1f4bc:"briefcase brief case",emjK1f4be:"floppy disk diskette",emjK1f4bf:"cd compact disc",emjK1f4c0:"dvd",emjK1f4c1:"file folder",emjK1f4c5:"calendar",emjK1f4cb:"clipboard",emjK1f4cc:"pushpin",emjK1f4cd:"drawing pin",emjK1f4ce:"paperclip clippy",emjK1f4cf:"ruler measure",emjK1f4d2:"ledger",emjK1f4d3:"notebook",emjK1f4da:"book books",emjK1f4db:"name badge",emjK02702:"scissors cut",emjK02709:"envelope mail",emjK0270f:"pencil",emjK1f3e0:"house home",emjK1f3e1:"garden greenhouse",emjK1f3e2:"office work",emjK1f3e6:"bank",emjK1f3e7:"atm",emjK1f3e8:"hotel motel bed sleep",emjK1f3ea:"convenience store",emjK1f3ec:"department store shopping",emjK1f3ed:"factory",emjK1f3f0:"castle",emjK02668:"hot springs",emjK02693:"anchor",emjK026ea:"church temple",emjK026f2:"fountain",emjK026f3:"golf",emjK026f5:"sailboat sailing sail",emjK026fd:"gas fuel gasoline pump",emjK1f6aa:"door",emjK1f6ac:"smoke smoking",emjK1f6ad:"no smoking",emjK1f6b2:"bike bicycle biking",emjK1f6b6:"walking pedestrian",emjK1f6c0:"bath bathing bathtub tub",emjK0267f:"accessible accessibility wheelchair",emjK026a0:"warning attention caution hazzard",emjK026a1:"high voltage zap lightning",emjK1f680:"rocket spaceship space",emjK1f68f:"bus stop",emjK1f693:"cop police",emjK1f695:"taxi cab",emjK1f697:"car vehicle automobile",emjK1f6a2:"ship cruise ferry yacht cruise travel vacation",emjK02708:"airplane flight airline plane travel vacation",emjK1f42d:"mouse eek mice squeak",emjK1f42e:"cow moo",emjK1f42f:"tiger roar rawr",emjK1f430:"rabbit bunny easter",emjK1f431:"cat kitty kitten meow",emjK1f432:"dragon roar smaug",emjK1f433:"whale moby dick",emjK1f434:"horse",emjK1f436:"dog woof puppy bark doggy",emjK1f437:"pig oink piggy piglet",emjK1f438:"frog croak ribbit",emjK1f439:"hamster guinea pig",emjK1f43a:"wolf howl",emjK1f341:"maple leaf",emjK1f344:"mushroom shroom",emjK1f308:"rainbow love",emjK02601:"cloud gloomy cloudy",emjK02614:"drops raining rain rainy raindrops umbrella",emjK02728:"sparkles twinkle twinkling glitter shiny sparkly glittery",emjK1f4a9:"poop turd shit",emjK1f4aa:"strong work out muscles biceps",emjK02648:"aries zodiac",emjK02649:"taurus zodiac",emjK0264a:"gemini zodiac",emjK0264b:"cancer zodiac",emjK0264c:"leo zodiac",emjK0264d:"virgo zodiac",emjK0264e:"libra zodiac",emjK0264f:"scorpio zodiac",emjK02650:"sagittarius zodiac",emjK02651:"capricorn zodiac",emjK02652:"aquarius zodiac",emjK02653:"pisces zodiac",emjK1f411:"bah sheep",emjK1f300:"cyclone typhoon hurricane",emjK1f301:"foggy",emjK1f302:"umbrella",emjK1f304:"sunrise",emjK1f305:"sunrise",emjK1f306:"dusk",emjK1f309:"bridge night",emjK1f30a:"wave tsunami",emjK1f30c:"milky way night sky galaxy universe",emjK1f311:"moon",emjK1f313:"moon",emjK1f314:"moon",emjK1f315:"moon full",emjK1f319:"moon crescent",emjK1f31b:"moon",emjK1f330:"chestnut",emjK1f331:"seed seedling planting",emjK1f334:"palm tree vacation",emjK1f335:"cactus hot desert",emjK1f337:"tulip flower",emjK1f338:"cherry blossom sakura flower",emjK1f339:"rose love romance flower",emjK1f33a:"hibiscus flower",emjK1f33b:"sunflower",emjK1f33c:"blossom daisy flower",emjK1f33d:"maize corn",emjK1f33e:"rice",emjK1f33f:"herb herbs",emjK1f342:"leaf autumn",emjK1f343:"leaf windy",emjK1f358:"onigiri",emjK1f359:"onigiri",emjK1f35b:"curry katsu",emjK1f361:"dango",emjK1f362:"oden",emjK1f373:"frying cooking",emjK1f3bd:"exercise exercising",emjK1f417:"boar",emjK1f418:"elephant",emjK1f419:"octopus",emjK1f41a:"seashell shell",emjK1f41b:"bug insect centipede millipede",emjK1f41c:"ant ants insect bug",emjK1f41d:"bee bees honeybee honeybees",emjK1f41e:"ladybug ladybugs",emjK1f420:"fish",emjK1f421:"blowfish fish",emjK1f422:"turtle",emjK1f423:"chick easter",emjK1f425:"chick easter",emjK1f40c:"snail slow",emjK1f40d:"snake",emjK1f40e:"horse horsey pony",emjK1f412:"monkey",emjK1f414:"chicken bawk rooster",emjK1f429:"poodle dog",emjK1f42b:"camel desert",emjK1f426:"bird",emjK1f427:"penguin",emjK1f42c:"dolphin",emjK1f43d:"pig pig noise smelly",emjK1f43e:"paw prints paws",emjK1f452:"hat sunday best",emjK1f458:"kimono",emjK1f45a:"clothes",emjK1f481:"information desk support desk",emjK1f482:"guardsman",emjK1f499:"heart",emjK1f49a:"heart",emjK1f49b:"heart",emjK1f49c:"heart",emjK1f49d:"heart love",emjK1f49e:"heart",emjK1f49f:"heart",emjK1f4a5:"collision bang traffic accident crash",emjK1f4a3:"bomb",emjK1f4a1:"light bulb idea",emjK1f4a8:"dash gotta go gotta run",emjK1f503:"reload refresh loading",emjK1f50c:"plug plugged in",emjK1f50b:"battery charged",emjK1f50d:"search searching",emjK1f510:"secure secret",emjK1f50f:"privacy",emjK1f511:"key",emjK1f512:"lock locked",emjK1f513:"unlock unlocked",emjK1f516:"bookmark",emjK1f514:"bell alarm",emjK1f550:"1pm 1am early afternoon",emjK1f551:"2pm 2am afternoon",emjK1f552:"3pm 3am",emjK1f553:"4pm 4am",emjK1f554:"5pm 5am late afternoon",emjK1f555:"6pm 6am",emjK1f556:"7pm 7am dinnertime",emjK1f557:"8pm 8am morning",emjK1f558:"9pm 9am",emjK1f559:"10pm 10am bedtime",emjK1f55a:"11pm 11am nighttime",emjK1f55b:"12pm 12am midnight noon lunchtime",emjK1f5fd:"statue liberty nyc new york city",emjK1f638:"cat grin happy",emjK1f639:"cat rofl lol tears laughter tears joy funny",emjK1f63a:"cat smile",emjK1f63b:"cat love",emjK1f63c:"cat heh",emjK1f63d:"cat kiss kisses",emjK1f63e:"cat pout pouting sad",emjK1f63f:"cat cry cries sad",emjK1f4e8:"incoming message mail email letter",emjK1f4e9:"mail email letter sending send",emjK1f4eb:"mail",emjK1f4ea:"empty mailbox",emjK1f6bb:"restroom toilet washroom bathroom",emjK1f6a5:"traffic traffic light",emjK1f6ab:"no entry no admittance",emjK1f689:"station",emjK1f69a:"delivery truck",emjK026fa:"tent camp camping",emjK1f6a8:"police siren emergency",emjK1f17f:"parking parking spot",emjK02733:"star asterisk",emjK02734:"star",emjK02b50:"star",emjK1f4c8:"chart graph record profits trending up upwards skyrocketed",emjK1f4c9:"chart graph record losses trending down downwards",emjK1f4ca:"chart graph",emjK02764:"love heart"},un={People:"People",Nature:"Nature",Activities:"Activities",Food:"Food",Travel:"Travel",Symbols:"Symbols",Objects:"Objects"},pn=/([\u0023-\u0039][\u20e3]|[\ud800-\udbff][\udc00-\udfff]|[\u00a9-\u00ae]|[\u2122-\u3299])*([:;][^:]*)/,hn=function(){function e(e){var t=this;this.searchBoxStrings=e,this.editor=null,this.eventHandledOnKeyDown=!1,this.canUndoEmoji=!1,this.isSuggesting=!1,this.paneRef=i.createRef(),this.timer=null,this.uiUtilities=null,this.emojiCalloutRef=i.createRef(),this.baseId=0,this.onHideCallout=function(){return t.setIsSuggesting(!1)},this.onSelectFromPane=function(e,n){var o;e!==Mt?t.insertEmoji(e,n):null===(o=t.paneRef.current)||void 0===o||o.showFullPicker(n)},this.strings=(0,d.__assign)((0,d.__assign)((0,d.__assign)({},cn),dn),un)}return e.prototype.setUIUtilities=function(e){this.uiUtilities=e},e.prototype.getName=function(){return"Emoji"},e.prototype.dispose=function(){var e;this.setIsSuggesting(!1),null===(e=this.emojiCalloutRef.current)||void 0===e||e.dismiss(),this.editor=null,this.baseId=0},e.prototype.initialize=function(e){this.editor=e},e.prototype.onPluginEvent=function(e){0===e.eventType?(this.eventHandledOnKeyDown=!1,this.isSuggesting?this.onKeyDownSuggestingDomEvent(e):e.rawEvent.which===qt.c.backspace&&this.canUndoEmoji&&(this.editor.undo(),this.handleEventOnKeyDown(e),this.canUndoEmoji=!1)):2!==e.eventType||(0,a.VL)(e.rawEvent)?6===e.eventType&&(this.canUndoEmoji=!1,this.setIsSuggesting(!1)):this.isSuggesting?this.onKeyUpSuggestingDomEvent(e):this.onKeyUpDomEvent(e)},e.prototype.onKeyDownSuggestingDomEvent=function(e){var t,n,o=this.getWordBeforeCursor(e);switch(e.rawEvent.which){case qt.c.enter:var i=null===(t=this.paneRef.current)||void 0===t?void 0:t.getSelectedEmoji();if(!i||!o||this.tryShowFullPicker(e,i,o))break;this.insertEmoji(i,o),this.handleEventOnKeyDown(e);break;case qt.c.left:case qt.c.right:null===(n=this.paneRef.current)||void 0===n||n.navigate(e.rawEvent.which===qt.c.left?-1:1),this.handleEventOnKeyDown(e);break;case qt.c.escape:this.setIsSuggesting(!1),this.handleEventOnKeyDown(e)}},e.prototype.tryShowFullPicker=function(e,t,n){var o;return t===Mt&&(this.handleEventOnKeyDown(e),null===(o=this.paneRef.current)||void 0===o||o.showFullPicker(n),!0)},e.prototype.onKeyUpSuggestingDomEvent=function(e){var t,n,o,i;if(!this.eventHandledOnKeyDown){this.timer&&(1===e.rawEvent.key.length&&e.rawEvent.which!==qt.c.space||e.rawEvent.which===qt.c.backspace)&&(null===(n=null===(t=this.editor)||void 0===t?void 0:t.getDocument().defaultView)||void 0===n||n.clearTimeout(this.timer),this.timer=null,null===(o=this.emojiCalloutRef.current)||void 0===o||o.dismiss());var r=this.getWordBeforeCursor(e);r&&this.paneRef?null===(i=this.paneRef.current)||void 0===i||i.setSearch(r):this.setIsSuggesting(!1)}},e.prototype.onKeyUpDomEvent=function(e){if(!this.eventHandledOnKeyDown){var t=this.getWordBeforeCursor(e);186!==e.rawEvent.which&&59!==e.rawEvent.which||":"!==t||this.setIsSuggesting(!0)}},e.prototype.getCallout=function(){var e,t=null===(e=this.editor)||void 0===e?void 0:e.getElementAtCursor(),n=null===t||void 0===t?void 0:t.getBoundingClientRect();this.uiUtilities&&n&&(this.baseId++,function(e,t,n,o,r,a,s,l,c){var d=null;d=He(e,i.createElement(ln,{ref:a,cursorRect:t,strings:n,onSelectFromPane:o,paneRef:r,onHideCallout:s,searchBoxString:c,baseId:l,dismiss:function(){null===d||void 0===d||d(),d=null}}))}(this.uiUtilities,n,this.strings,this.onSelectFromPane,this.paneRef,this.emojiCalloutRef,this.onHideCallout,this.baseId,this.searchBoxStrings))},e.prototype.setIsSuggesting=function(e){var t;this.isSuggesting!==e&&(this.isSuggesting=e,this.isSuggesting?this.getCallout():this.emojiCalloutRef&&(null===(t=this.emojiCalloutRef.current)||void 0===t||t.dismiss()))},e.prototype.insertEmoji=function(e,t){var n,o=this;if(t&&this.editor&&e.codePoint){var i=this.editor.getDocument().createElement("span");i.innerText=e.codePoint,this.editor.addUndoSnapshot((function(){o.editor&&((0,ee.vQ)(o.editor,t,i,!0),o.editor.select(i,-3))}),void 0,!0),null===(n=this.emojiCalloutRef.current)||void 0===n||n.dismiss()}},e.prototype.getWordBeforeCursor=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e),o=n?n.getWordBefore():null,i=o?pn.exec(o):null;return i&&i.length>2&&i[0]===o?i[2]:null},e.prototype.handleEventOnKeyDown=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e}();function mn(e){return new hn(e)}},69849:(e,t,n)=>{"use strict";var o=n(67199),i=Array.prototype.concat,r=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var s=e[n];o(s)?t=i.call(t,r.call(s)):t.push(s)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},67199:e=>{e.exports=function(e){return!(!e||"string"===typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}}}]);
//# sourceMappingURL=loopappdialogs.0f75aa56.chunk.js.map