"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[8010],{64805:(e,s,t)=>{t.d(s,{J:()=>r});class i{get clientSettings(){return this.clientSettingsProvider()}constructor(e,s,t){this.dispatcher=e,this.clientSettingsProvider=s,this.loggers=t}}class r extends i{getCurrentViewIds(){const e=this.stores.appContextStore.getCurrentViewId();return e?[e]:void 0}constructor(e,s,t,i,r){super(e,i,r),this.webApiProviders=s,this.stores=t}}},38664:(e,s,t)=>{t.r(s),t.d(s,{PermissionsModule:()=>g});var i=t(58355),r=t(81576),n=t(69632),o=t(64805),a=t(54320),c=t.n(a),l=t(74844),u=t(98502),d=t(82841);class g extends o.J{get name(){return"PermissionsModule"}async fetchContainerPermissionsAsync(e){var s;this.loggers.traceLogger.logTrace(507897048,l.k.Verbose,"Batch Fetch Container Permissions [permissionsToFetch=".concat(e,"]"));const t=await this.webApiProviders.taskService(),r=[];for(const i of e){const{containerId:e,publicationId:s}=i;this.stores.permissionsStore.arePermissionsMissingOrExpired(e,s)&&r.push(t.getContainerPermissionsAsync({containerId:e,publicationId:s}))}if(0===r.length)return Promise.resolve([]);const n=await Promise.allSettled(r),o=[];let a;if(n.forEach((e=>{if("fulfilled"===e.status&&null!=e.value)o.push({containerId:e.value.containerId,publicationId:e.value.publicationId,containerPermissions:e.value.containerPermissions,expiry:e.value.expiry});else if("rejected"===e.status){var s,t,i,r;a=e;const n=null!==(s=null===(t=a.reason)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.status)&&void 0!==s?s:0,o=null!==(i=null===(r=a.reason)||void 0===r||null===(r=r.response)||void 0===r?void 0:r.statusText)&&void 0!==i?i:"";this.loggers.traceLogger.logTrace(507897047,l.k.Warning,"Fetch Container Permissions Failed [statusCode=".concat(n,"][statusText=").concat(o,"]"))}})),!c()(o))return this.dispatcher.dispatchAction(new i.D(o)),this.loggers.traceLogger.logTrace(507897046,l.k.Verbose,"Batch Fetch Container Permissions Success [permissionsToFetch=".concat(e,"]")),o;const g=(null===(s=a)||void 0===s?void 0:s.reason)||u.g.generateAjaxClientError(null);return this.loggers.traceLogger.logTrace(507897045,l.k.Warning,"Batch Fetch Container Permissions Failed ".concat((0,d.s8)(g))),Promise.reject(g)}async fetchTaskPermissionsAsync(e){this.loggers.traceLogger.logTrace(507897044,l.k.Verbose,"Batch Fetch Task Permissions [equivalenceSetIds=".concat(e,"]"));const s=await this.webApiProviders.taskService(),t=[],i=[];for(const r of e)this.stores.permissionsStore.areTaskPermissionsMissingOrExpired(r)&&(t.push(s.getTaskPermissionsAsync({equivalenceSetId:r})),i.push(r));if(0===t.length)return[];const o=await Promise.allSettled(t),a=[],c=[];let g;if(o.forEach(((e,s)=>{if("fulfilled"===e.status&&null!=e.value)a.push({equivalenceSetId:e.value.equivalenceSetId,taskPermissions:e.value.taskPermissions,expiry:e.value.expiry});else if("rejected"===e.status){var t,r,n,o;c.push(i[s]),g=e;const a=null!==(t=null===(r=g.reason)||void 0===r||null===(r=r.response)||void 0===r?void 0:r.status)&&void 0!==t?t:0,u=null!==(n=null===(o=g.reason)||void 0===o||null===(o=o.response)||void 0===o?void 0:o.statusText)&&void 0!==n?n:"";this.loggers.traceLogger.logTrace(507897043,l.k.Warning,"Fetch Task Permissions Failed [statusCode=".concat(a,"][statusText=").concat(u,"]"))}})),c.length>0&&this.dispatcher.dispatchAction(new r.R(c)),a.length>0&&this.dispatcher.dispatchAction(new n.f(a)),null==g)return this.loggers.traceLogger.logTrace(507897042,l.k.Verbose,"Batch Fetch Task Permissions Success [equivalenceSetIds=".concat(e,"]")),a;{const e=g.reason||u.g.generateAjaxClientError(null);return this.loggers.traceLogger.logTrace(507897041,l.k.Warning,"Batch Fetch Task Permissions Failed: ".concat((0,d.s8)(e))),Promise.reject(e)}}}}}]);
//# sourceMappingURL=permissionmodule.39efc0cf.chunk.js.map