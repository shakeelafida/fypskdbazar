"use strict";(()=>{var RCe=Object.create;var YT=Object.defineProperty;var ACe=Object.getOwnPropertyDescriptor;var kCe=Object.getOwnPropertyNames;var DCe=Object.getPrototypeOf,wCe=Object.prototype.hasOwnProperty;var f=(e,t)=>()=>(e&&(t=e(e=0)),t);var Re=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_y=(e,t)=>{for(var r in t)YT(e,r,{get:t[r],enumerable:!0})},X3=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(var o=kCe(t),a=0,d=o.length,c;a<d;a++)c=o[a],!wCe.call(e,c)&&c!==r&&YT(e,c,{get:(u=>t[u]).bind(null,c),enumerable:!(n=ACe(t,c))||n.enumerable});return e};var I=(e,t,r)=>(r=e!=null?RCe(DCe(e)):{},X3(t||!e||!e.__esModule?YT(r,"default",{value:e,enumerable:!0}):r,e)),Hk=e=>X3(YT({},"__esModule",{value:!0}),e);var J3=Re((exports,module)=>{s();if(exports.__platformBundles!==void 0)for(platformBundles=exports.__platformBundles.concat(),Reflect.deleteProperty(exports,"__platformBundles"),i=0;i<platformBundles.length;++i)console.log("PB start "+(i+1)+"/"+platformBundles.length),eval(platformBundles[i]),console.log("PB done  "+(i+1)+"/"+platformBundles.length);var platformBundles,i});var global,s=f(()=>{global=new Function("return this;")();J3()});var Z3=f(()=>{"use strict";s()});var Wn,Ry=f(()=>{"use strict";s();Wn=!1});var Pt,Ay,Kl,Bk=f(()=>{"use strict";s();Ry();Pt=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Wn&&console.log.apply(console,t)},Ay=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Wn&&console.error.apply(console,t)},Kl=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Wn&&console.warn.apply(console,t)}});var e4=f(()=>{"use strict";s();Bk()});function ky(e,t){return e.length===t.length&&e.every(function(r,n){return r===t[n]})}var t4=f(()=>{"use strict";s()});function X(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Uk(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function je(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Gt(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}function gt(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function qe(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function j(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,a=[],d;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(c){d={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(d)throw d.error}}return a}function w(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function qt(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Uk,m,k=f(()=>{"use strict";s();Uk=function(t,r){return Uk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])},Uk(t,r)};m=function(){return m=Object.assign||function(r){for(var n,o=1,a=arguments.length;o<a;o++){n=arguments[o];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(r[d]=n[d])}return r},m.apply(this,arguments)}});var r4=f(()=>{"use strict";s();t4()});var $T,n4=f(()=>{"use strict";s();$T=function(){function e(){this.valueStruct={hasValue:!1},this.callbacks=[]}return e.prototype.set=function(t){this.valueStruct={value:t,hasValue:!0},this.callbacks.forEach(function(r){r(t)}),this.callbacks=[]},e.prototype.getValue=function(t){var r=this;if(this.valueStruct.hasValue)try{return Promise.resolve(t(this.valueStruct.value))}catch(n){return Promise.reject(n)}return new Promise(function(n,o){r.callbacks.push(function(a){try{n(t(a))}catch(d){o(d)}})})},e}()});function vu(e,t,r,n,o){var a=r(),d,c=function l(){var p=t(a);p?(a=p,d=setTimeout(l,n)):(a=r(),d=void 0)},u=function(p){a=e(a,p),!d&&!o&&(d=setTimeout(c,0)),d||(d=setTimeout(c,o||n))};return u.reset=function(){d!==void 0&&(clearTimeout(d),a=r(),d=void 0)},u}var o4=f(()=>{"use strict";s()});var QT,i4=f(()=>{"use strict";s();QT=function(){function e(){var t=this;this.promise=new Promise(function(r,n){t.onResolve=r,t.onReject=n})}return Object.defineProperty(e.prototype,"resolve",{get:function(){return this.onResolve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reject",{get:function(){return this.onReject},enumerable:!1,configurable:!0}),e}()});var a4=f(()=>{"use strict";s();n4();o4();i4()});var sm,s4=f(()=>{"use strict";s();k();sm=function(){function e(t){var r=this;this.internalHandler=t,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!r._isProcessingEvents){r.eventQueue.push(n);return}r.internalHandler.apply(r,w([],j(n),!1))}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var t,r;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=qe(this.eventQueue),o=n.next();!o.done;o=n.next()){var a=o.value;this.handler.apply(this,w([],j(a),!1))}}catch(d){t={error:d}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.eventQueue=[]}},e}()});var d4=f(()=>{"use strict";s();s4()});function Dy(e,t){var r=e.filter(t);return r.length===e.length?e:r}var c4=f(()=>{"use strict";s()});function wy(e){return e.reduce(function(t,r){return Array.isArray(r)?t.push.apply(t,w([],j(wy(r)),!1)):t.push(r),t},[])}var u4=f(()=>{"use strict";s();k()});var XT,l4=f(()=>{"use strict";s();k();XT=function(t){var r,n,o={};try{for(var a=qe(t),d=a.next();!d.done;d=a.next()){var c=j(d.value,2),u=c[0],l=c[1];o[u]=l}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}});var JT,f4=f(()=>{"use strict";s();JT=Boolean});var p4=f(()=>{"use strict";s();c4();u4();l4();f4()});var ZT,m4=f(()=>{"use strict";s();ZT=function(){var t=[],r={},n=[];return function(o,a,d){if(d===void 0&&(d=function(l,p,g){return g[p]}),o===t&&a===r)return n;var c=o.map(function(u,l){return u===t[l]&&u.every(function(p){return d(u[0],p,a)===d(u[0],p,r)})?n[l]:u.map(function(p){return d(u[0],p,a)})});return t=o,r=a,n=c,c}}});function g4(e){return e??OCe}function xu(e,t,r){t===void 0&&(t=100);var n=new Map,o=0;return function(){for(var a,d,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];if(c.length===0){var l=e.apply(void 0,w([],j(c),!1));return l}o>t&&(n.clear(),o=0,r==null||r());var p=g4(c[0]),g=(a=n.get(p))!==null&&a!==void 0?a:{nextArgMap:new Map};n.has(p)||n.set(p,g);for(var h=1;h<c.length;h++){var x=g4(c[h]),y=(d=g.nextArgMap.get(x))!==null&&d!==void 0?d:{nextArgMap:new Map};g.nextArgMap.has(y)||g.nextArgMap.set(x,y),g=y}return g.value!==void 0||(o++,g.value={storedResult:e.apply(void 0,w([],j(c),!1))}),g.value.storedResult}}var OCe,h4=f(()=>{"use strict";s();k();OCe="9FA40DC1-775B-46F7-B124-3E10E131B835"});function et(e){var t,r=[{}];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return r.every(function(a,d){return a===n[d]})||(r=n,t=e.apply(void 0,w([],j(n),!1))),t}}function En(e,t){var r=et(e);return function(){return r.apply(void 0,w([],j(t()),!1))}}function eb(e,t,r){var n=et(t);return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n.apply(void 0,w(w([],j(o),!1),j(r()),!1))}}var y4=f(()=>{"use strict";s();k()});function zn(e){var t=e;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t&&t.apply(void 0,w([],j(r),!1)),t=void 0}}var C4=f(()=>{"use strict";s();k()});var v4=f(()=>{"use strict";s();m4();h4();y4();C4()});var T4=Re((DHe,Wk)=>{s();var x4=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);x4?(Vk=new Uint8Array(16),Wk.exports=function(){return x4(Vk),Vk}):(jk=new Array(16),Wk.exports=function(){for(var t=0,r;t<16;t++)t&3||(r=Math.random()*4294967296),jk[t]=r>>>((t&3)<<3)&255;return jk});var Vk,jk});var I4=Re((FHe,S4)=>{s();var b4=[];for(Fy=0;Fy<256;++Fy)b4[Fy]=(Fy+256).toString(16).substr(1);var Fy;function NCe(e,t){var r=t||0,n=b4;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}S4.exports=NCe});var P4=Re((NHe,E4)=>{s();var MCe=T4(),LCe=I4();function HCe(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||MCe)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t)for(var a=0;a<16;++a)t[n+a]=o[a];return t||LCe(o)}E4.exports=HCe});var _4,ao,tb,R4=f(()=>{"use strict";s();_4=I(P4()),ao=_4.default,tb="00000000-0000-0000-0000-000000000000"});var A4=f(()=>{"use strict";s();R4()});function rb(e){return e}var k4=f(()=>{"use strict";s()});function Mt(e){var t=j(e,1),r=t[0];return r}var D4=f(()=>{"use strict";s();k()});var w4=f(()=>{"use strict";s();k4();D4()});var rt=f(()=>{"use strict";s();r4();a4();d4();p4();v4();A4();w4()});function Oy(e,t){if(F4){var r=window==null?void 0:window.performance;if(!(!r||typeof r.measure!="function"||typeof r.mark!="function"))return new F4(e,t,r)}}var Yl,F4,O4=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"})(Yl||(Yl={}))});function nb(e,t){return t===void 0&&(t=0),e?e.split("\n").slice(1+t,Wn?void 0:2+t).join("\n"):"<unable to get stack>"}function $l(){try{throw new Error}catch(e){return e instanceof Error?nb(e.stack,1):""}}var zk=f(()=>{"use strict";s();Ry()});function Tu(e,t,r,n){return[Ie.enableMessageLogging&&r?r:void 0,"Tag: ".concat(e),Ie.enableStackLogging?t:void 0,n?"----------\nInner exception: ".concat(so(n)):void 0].filter(JT).join("\n")}var ob=f(()=>{"use strict";s();rt();Gk()});function N4(e,t,r){return new Error(Tu(t,new Error().stack,e,r))}var M4=f(()=>{"use strict";s();ob()});function Ny(e,t){return!!(e&&(e instanceof Ie||e.isStructuredError!==void 0)&&(!t||e.name===t))}function so(e){if(Ny(e))return e.stringify();if(e instanceof Error){var t=Ie.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(Ie.enableStackLogging?nb(e.stack):"")}return Ie.enableUnknownMessageLogging&&typeof e=="string"?e:"Unknown error"}var Ie,Gk=f(()=>{"use strict";s();Ry();zk();ob();M4();Ie=function e(t,r,n){var o=N4(t,r,n);return o.name="StructuredError",o.innerException=n,o.tag=r,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};Ie.enableStackLogging=Wn;Ie.enableMessageLogging=Wn;Ie.enableUnknownMessageLogging=Wn;Ie.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return Tu(this.tag,this.stack,void 0,this.innerException)},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}});Object.setPrototypeOf?Object.setPrototypeOf(Ie,Error):Ie.__proto__=Error});var qk=f(()=>{"use strict";s();Gk();ob()});var Kk,C,L4=f(()=>{"use strict";s();rt();Kk=0,C={reserve:function(){return Kk},reserveTag:rb}});function Ne(e){throw new Error("Unreachable throw hit! Passed in value is ".concat(e,"."))}var H4=f(()=>{"use strict";s()});function Gn(e,t,r){if(!e)throw new Ie(t,r)}var B4=f(()=>{"use strict";s();qk()});var te=f(()=>{"use strict";s();Z3();e4();Bk();O4();Ry();zk();qk();L4();H4();B4()});var Ql,U4=f(()=>{"use strict";s();k();te();Ql=function(){function e(t,r){var n=this;this.apiName=t,this.DefaultCtor=r,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(this.instance)throw new Ie("'".concat(this.apiName,"' singleton is already initialized"),C.reserveTag(538035215));if(!this.DefaultCtor)throw new Ie("'".concat(this.apiName,"' not initialized but no default constructor exists"),C.reserveTag(538035216));return this.ctorStack=$l(),this.instance=new((t=this.DefaultCtor).bind.apply(t,w([void 0],r,!1)))},e.prototype.getInstanceOrThrow=function(){var t=this.instance;if(!t)throw new Ie("'".concat(this.apiName,"' singleton has not been initialized"),C.reserveTag(538035217));return t},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(t){if(this.getInstance())throw new Ie("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),C.reserveTag(538035218));this.DefaultCtor=t},e.prototype.injectInstance=function(t){if(this.getInstance())throw new Ie("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),C.reserveTag(538035219));this.injectionStack=$l(),this.instance=t},e.prototype.getInjectOrInitializeStack=function(){var t,r;return(r=(t=this.ctorStack)!==null&&t!==void 0?t:this.injectionStack)!==null&&r!==void 0?r:"Callstack Not Retrieved"},e}()});var ib=f(()=>{"use strict";s();U4()});var _t=Re((f3e,V4)=>{s();V4.exports=OfficePlatformGlobal.Reka});var ab,BCe,j4,W4=f(()=>{"use strict";s();ab=I(_t());ab.CustomTypeRegistry.registerTypeInfos({"SDX::Docs::FeatureGate::JS::GateValue":{gate:"$string",value:"$boolean"}});BCe={FeatureGateModule:["SDX::Docs::FeatureGate::JS::FeatureGateModule",{Values:["Constant",["$array","SDX::Docs::FeatureGate::JS::GateValue"]]}]},j4={FeatureGateModule:ab.RekaServiceRegistry.getNativeService(BCe.FeatureGateModule)}});var z4,G4=f(()=>{"use strict";s();W4();z4=function(){function e(){this.gateValues=new Map((j4.FeatureGateModule.Values||[]).map(function(t){return[t.gate,t.value]}))}return e.prototype.isGateEnabled=function(t,r){var n=this.gateValues.get(t);return n??r},e.prototype.isFeatureEnabled=function(t){return this.isGateEnabled(t,!1)},e.prototype.isChangeGateEnabled=function(t,r){return this.isGateEnabled(t,!0)},e}()});var My,q4=f(()=>{"use strict";s();ib();G4();My=new Ql("FeatureGate",z4)});var Yk=f(()=>{"use strict";s();q4()});var K4=f(()=>{"use strict";s()});var Y4=f(()=>{"use strict";s()});var $4=f(()=>{"use strict";s();K4();Y4()});function $k(e){return My.getAndInitialize(e)}function Ly(){return My.getInstanceOrThrow()}var Q4=f(()=>{"use strict";s();Yk()});var Xl=f(()=>{"use strict";s();Yk();$4();Q4()});var X4=f(()=>{"use strict";s()});var co,Qk=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess",e[e.AggregateSubtree=3]="AggregateSubtree",e[e.NotSet=999]="NotSet"})(co||(co={}))});var qn,Xk=f(()=>{"use strict";s();(function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent"})(qn||(qn={}))});var Jl,Jk=f(()=>{"use strict";s();(function(e){e[e.EventExportability_NotSet=0]="EventExportability_NotSet",e[e.EventExportability_NotExported=1]="EventExportability_NotExported"})(Jl||(Jl={}))});var Zl,Zk=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact"})(Zl||(Zl={}))});var ht,eD=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.ProductServiceUsage=2]="ProductServiceUsage"})(ht||(ht={}))});var wi,tD=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"})(wi||(wi={}))});var St,J4=f(()=>{"use strict";s();(function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose",e[e.Spam=5]="Spam"})(St||(St={}))});var N,rD=f(()=>{"use strict";s();(function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"})(N||(N={}))});var Z4=f(()=>{"use strict";s();Qk();Xk();Jk();Zk();eD();tD();J4();rD()});function Ct(e,t){return{visit:function(){}}}var ft,nD=f(()=>{"use strict";s();(function(e){e[e.GlobalAPI=1]="GlobalAPI",e[e.ReviewedAsNotNecessary=2]="ReviewedAsNotNecessary",e[e.Test=3]="Test",e[e.Todo=4]="Todo"})(ft||(ft={}))});function Gr(e,t,r){return{key:e,value:t,dataClassification:r}}var eU=f(()=>{"use strict";s()});var ko,tU=f(()=>{"use strict";s();(function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"})(ko||(ko={}))});var rU=f(()=>{"use strict";s();eU();tU()});var A4e,k4e,nU,D4e,w4e,oU,Hy,iU,F4e,aU,sU,O4e,N4e,M4e,L4e,oD=f(()=>{"use strict";s();te();A4e=C.reserveTag(590899029),k4e=C.reserveTag(590899030),nU=C.reserveTag(590899031),D4e=C.reserveTag(590899032),w4e=C.reserveTag(590899033),oU=C.reserveTag(578937436),Hy=C.reserveTag(578937437),iU=C.reserveTag(578937438),F4e=C.reserveTag(576717443),aU=C.reserveTag(576717444),sU=C.reserveTag(576717445),O4e=C.reserveTag(523891986),N4e=C.reserveTag(523891987),M4e=C.reserveTag(523629772),L4e=C.reserveTag(523629773)});function be(){return{aggregationMode:co.None,diagnosticLevel:qn.NecessaryServiceDataEvent,dataCategories:ht.ProductServiceUsage,samplingPolicy:Zl.NotSet,exportability:Jl.EventExportability_NotExported}}var db=f(()=>{"use strict";s();Qk();Xk();Jk();Zk();eD()});function ub(e){var t,r,n;return m(m({},cb),{aggregationMode:(t=e.aggregationMode)!==null&&t!==void 0?t:cb.aggregationMode,diagnosticLevel:(r=e.diagnosticLevel)!==null&&r!==void 0?r:cb.diagnosticLevel,dataCategories:(n=e.dataCategories)!==null&&n!==void 0?n:cb.dataCategories})}var cb,iD=f(()=>{"use strict";s();k();db();cb=be()});var jCe,dU,cU=f(()=>{"use strict";s();te();oD();iD();jCe=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(t){var r=this,n;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=t,this.isInitialized=!0,this.deferredInitializationCallbacks.map(function(o){return o(r)}),this.deferredInitializationCallbacks=[],this.logDiagnosticTrace=(n=this.hostAPI.logDiagnosticTrace)===null||n===void 0?void 0:n.bind(this.hostAPI))},e.prototype.hasBeenInitialized=function(){return this.isInitialized},e.prototype.onInitialized=function(t){this.isInitialized?t(this):this.deferredInitializationCallbacks.push(t)},e.prototype.createActivityObject=function(t,r,n,o){this.checkIsInitialized(),Gn(t[0]>="A"&&t[0]<="Z","Activity name should start with a capital letter.",oU),Gn(this.hostAPI,"Host API must be defined",Hy);var a=ub(n);return this.hostAPI.createActivityObject(t,r,a,o)},e.prototype.assertCondition=function(t,r){this.checkIsInitialized(),this.assertConditionTag(t,r,nU)},e.prototype.assertConditionTag=function(t,r,n){this.checkIsInitialized(),t||(Kl("*ASSERT* 0x".concat(n.toString(16)," : ").concat(r)),Gn(this.hostAPI,"Host API must be defined",Hy),this.hostAPI.logErrorData(n,r))},e.prototype.getMetadata=function(){return Gn(this.hostAPI,"Host API must be defined",Hy),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new Ie("ClientTelemetryAPI is not initialized",iU)},e.prototype.logFloodgateActivity=function(t){this.checkIsInitialized(),Gn(this.hostAPI,"Host API must be defined",Hy),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(t)},e}(),dU=jCe});function uU(e){return e.testOnly===!0}function lU(e){if(dm){if(uU(dm)){uU(e)&&(dm=e);return}throw lb?new Ie(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",lb].join("\n"),aU):new Ie("ClientTelemetryAPI cannot be re-initialized.\nFirst initialized from ".concat(aD),sU)}aD||(aD=$l()),dm=e}function v(){if(lb||(lb=$l()),!dm){var e=new dU;return lU(e),e}return dm}var dm,lb,aD,fb=f(()=>{"use strict";s();te();oD();cU();dm=void 0});function fU(){return WCe}var WCe,pU=f(()=>{"use strict";s();WCe={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"}});var mU,gU=f(()=>{"use strict";s();pU();mU=function(){function e(t,r){r===void 0&&(r=fU()),this.sdxMetadata=t,this.hostTelemetrySupport=r,this.logDiagnosticTrace=void 0}return e.prototype.getMetadata=function(){var t=this.hostTelemetrySupport,r=t.appName,n=t.appVersion,o=t.dataCenter,a=t.releaseAudience,d=t.releaseAudienceGroup,c=t.releaseChannel,u=t.ring,l=t.sessionId,p=t.sovereignEnvironmentName;return{appName:r,appVersion:n,dataCenter:o,releaseAudience:a,releaseAudienceGroup:d,releaseChannel:c,ring:u,sessionId:l,sovereignEnvironmentName:p}},e}()});var hU,yU=f(()=>{"use strict";s();te();hU=function(){function e(t){this._visitor=t,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Ay("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(t){this.failTag(0,t)},e.prototype.isEnded=function(){return this._ended},e}()});var pb,zCe,cm,sD=f(()=>{"use strict";s();pb=I(_t());pb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::TelemetryMetadata":{appName:"$string",appVersion:"$string",releaseAudience:"$string",releaseChannel:"$string",releaseAudienceGroup:["opt-field","$string"],sessionId:"$string"}});zCe={TelemetryModule:["Mso::Document::Comments::JS::TelemetryModule",{logActivity:["FireAndForgetMethod",["Mso::Document::Comments::JS::ActivityData","Mso::Document::Comments::JS::ActivityDataFields"]],logErrorData:["FireAndForgetMethod",["$number","$string"]],logDiagnosticTrace:["FireAndForgetMethod",["$number","$number","$number","$string",["$array","Mso::Document::Comments::JS::HostClassifiedDataField"]]],telemetryMetadata:["Constant","Mso::Document::Comments::JS::TelemetryMetadata"]}]},cm={TelemetryModule:pb.RekaServiceRegistry.getNativeService(zCe.TelemetryModule)}});function CU(e,t,r){return new GCe(e,t,r)}var GCe,vU=f(()=>{"use strict";s();k();rD();tD();fb();yU();sD();GCe=function(e){X(t,e);function t(r,n,o,a){var d=e.call(this,n)||this;return d._startTime=0,d._activityData={name:r,timeElapsed:0,result:0,endTag:0,aggregationMode:o.aggregationMode,diagnosticLevel:o.diagnosticLevel,dataCategories:o.dataCategories,samplingPolicy:o.samplingPolicy,activityExportability:o.exportability,apiContext:void 0,documentMetadata:wi.None},d._dataFields={},d._startTime=t.now(),d}return t.prototype.successTag=function(r){this.finalize()&&(this._activityData.result=0,this._activityData.endTag=r,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.failTag=function(r,n){this.finalize()&&(this._activityData.result=n,this._activityData.endTag=r,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.addDataField=function(r,n,o,a){if(this.isEnded()){v().assertConditionTag(!1,"Activity object has already been ended. Field: '".concat(r,"'"),595644948);return}if(this._dataFields[r]!==void 0){v().assertConditionTag(!1,"ActivityObject already contains data for given field: '".concat(r,"'"),595644949);return}if(o&&o!==N.SystemMetadata){v().assertConditionTag(!1,"PII data fields are not yet supported. Field: '".concat(r,"'"),595644950);return}this._dataFields[r]=n},t.prototype.addDocumentMetadata=function(r){this._activityData.documentMetadata=r},t.prototype.attachContext=function(r){this._activityData.apiContext=r},t.logActivity=function(r,n){var o={string:[],number:[],boolean:[]};Object.keys(n).forEach(function(a){var d=n[a];typeof d=="boolean"?o.boolean.push({key:a,value:d}):typeof d=="number"?o.number.push({key:a,value:d}):o.string.push({key:a,value:d})}),cm.TelemetryModule.logActivity(r,o)},t.now=function(){var r=1e3;if(typeof performance<"u"&&performance.now){var n=performance.now();return Math.floor(n*r)}return Date.now()*r},t}(hU)});function qCe(e){switch(typeof e){case"boolean":return{type:"boolean",boolVal:e};case"string":return{type:"string",strVal:e};case"number":return{type:"number",numVal:e};default:Ne(e)}}function xU(e){return{key:e.key,dataClassification:e.dataClassification,value:qCe(e.value)}}var TU=f(()=>{"use strict";s();te()});var By,bU=f(()=>{"use strict";s();k();nD();db();gU();vU();TU();sD();By=function(e){X(t,e);function t(r,n){n===void 0&&(n=cm.TelemetryModule.telemetryMetadata);var o=e.call(this,r,n)||this;return o.sdxMetadata=r,o.logDiagnosticTrace=function(a,d,c,u,l){for(var p=[],g=5;g<arguments.length;g++)p[g-5]=arguments[g];var h=w([],p,!0);l.visit({addDataField:function(y,T,b,S){h.push({key:y,value:T,dataClassification:b})},addDocumentMetadata:function(y){},attachContext:function(y){}}),cm.TelemetryModule.logDiagnosticTrace(d,c,u,a,h.map(xU))},o}return t.prototype.createActivityObject=function(r,n,o){return CU(r,n,o)},t.prototype.logErrorData=function(r,n){var o=this.createActivityObject("LogError",Ct(ft.ReviewedAsNotNecessary),be());o.failTag(r,-2130957533),cm.TelemetryModule.logErrorData(r,n)},t}(mU)});var SU=f(()=>{"use strict";s();bU()});var IU=f(()=>{"use strict";s();SU()});var EU=f(()=>{"use strict";s();IU()});function Uy(e,t){v().init(new By(e,t))}var PU=f(()=>{"use strict";s();EU();fb()});var RU=f(()=>{"use strict";s();fb();PU()});var AU=f(()=>{"use strict";s()});var kU=f(()=>{"use strict";s();X4();Z4();nD();rU();RU();db();iD();AU()});var Z=f(()=>{"use strict";s();kU()});function bu(e){return!!e&&e.focus!==void 0&&e.blur!==void 0}var dD=f(()=>{"use strict";s()});var DU=f(()=>{"use strict";s()});var L=Re((y5e,wU)=>{s();wU.exports=OfficePlatformGlobal.React});function mb(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&bu(e)}var FU,um,Aa,gb=f(()=>{"use strict";s();FU=I(L());dD();um=FU.createContext(void 0);(function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"})(Aa||(Aa={}))});var OU=f(()=>{"use strict";s();dD();DU();gb()});var we,NU=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"})(we||(we={}))});var ge,Vy=f(()=>{"use strict";s();(function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"})(ge||(ge={}))});var ne,MU=f(()=>{"use strict";s();(function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.Alt="Alt",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.End="End",e.Enter="Enter",e.Escape="Escape",e.Home="Home",e.Meta="Meta",e.Shift="Shift",e.Space=" ",e.Tab="Tab",e.F6="F6",e.F12="F12"})(ne||(ne={}))});var hb,LU=f(()=>{"use strict";s();(function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"})(hb||(hb={}))});var lm=f(()=>{"use strict";s();NU();Vy();MU();LU()});function fm(e,t){if(!t)return e;switch(e){case ne.ArrowLeft:return ne.ArrowRight;case ne.ArrowRight:return ne.ArrowLeft;default:return e}}function Cc(e){switch(e){case"Down":return ne.ArrowDown;case"Up":return ne.ArrowUp;case"Left":return ne.ArrowLeft;case"Right":return ne.ArrowRight;case"OS":return ne.Meta;case"Del":return ne.Delete;case"Spacebar":return" ";case"Esc":return ne.Escape;case"Ctrl":case"Ctl":return ne.Control;case"F6":return ne.F6;case"F12":return ne.F12;default:return e}}var HU=f(()=>{"use strict";s();lm()});function mm(e){return e.useJSTabLoop?e.handleKeysDuringBubbling?[{key:ne.Tab,eventPhase:we.Bubbling},{key:ne.Tab,shiftKey:!0,eventPhase:we.Bubbling}]:[{key:ne.Tab,eventPhase:we.Capturing},{key:ne.Tab,shiftKey:!0,eventPhase:we.Capturing}]:[]}var jy,Cs,pm,BU=f(()=>{"use strict";s();k();lm();jy=[{key:ne.Tab,eventPhase:we.AtTarget},{key:ne.Tab,eventPhase:we.AtTarget,shiftKey:!0}],Cs=function(t,r){return t&&t.map(function(n){return m(m({},n),{eventPhase:r})})},pm=function(t,r){var n=t.filter(function(o){return o.eventPhase!==we.None});return r&&(n=n.concat(jy)),Cs(n,we.AtTarget)}});function uo(e){return e.isFocusOn?ge.FocusOn:e.isFocusWithin?ge.FocusWithin:ge.Unfocused}var cD=f(()=>{"use strict";s();Vy()});function $Ce(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!ud)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return ud(function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e.apply(void 0,w(w([],n,!1),t,!1))},t)}function QCe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!ud)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return ud(function(){return e.apply(void 0,t)},t)}function UU(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(ud)throw new Error("Recursive calls of hooks is not supported!");ud=e;var n=$Ce.apply(void 0,t);return ud=void 0,n}}function yb(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(ud)throw new Error("Recursive calls of hooks is not supported!");ud=e;var n=QCe.apply(void 0,t);return ud=void 0,n}}var ud,VU=f(()=>{"use strict";s();k()});var Su,XCe,uD,lD,fD,jU=f(()=>{"use strict";s();Su=I(L());VU();XCe=yb(Su.useMemo),uD=yb(Su.useEffect),lD=yb(Su.useLayoutEffect),fD=UU(Su.useCallback)});var Cb=f(()=>{"use strict";s();jU()});function vb(e,t,r,n,o,a){var d=Wy.useRef(new JCe(e,t,r,n,{isFocusOn:o,isFocusWithin:a}));return uD(function(c,u,l,p,g,h){h.current.onEffect(c,u,l,{isFocusOn:p,isFocusWithin:g})},t,r,n,o,a,d),d}var Wy,JCe,WU=f(()=>{"use strict";s();k();Cb();Wy=I(L());Vy();cD();JCe=function(){function e(t,r,n,o,a){this.nodeId=t,this.nodeData=r,this.tabbable=n,this.onFocusStateChange=o,this.focusState=a,this.registrationRef=Wy.createRef(),this.innerComponentRef=Wy.createRef()}return e.prototype.onEffect=function(t,r,n,o){this.nodeData=t,this.tabbable=r,this.onFocusStateChange=n;var a=this.focusState;this.focusState=o,uo(a)!==uo(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return gt(this,function(t){switch(t.label){case 0:return[4,this];case 1:return t.sent(),[2]}})},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return uo(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===ge.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var t;(t=this.innerComponentRef.current)===null||t===void 0||t.focus()},e.prototype.blur=function(){var t;(t=this.innerComponentRef.current)===null||t===void 0||t.blur()},e}()});var zU=f(()=>{"use strict";s();HU();BU();cD();WU()});function mD(e){GU=e}function zy(){return GU}var GU,gD=f(()=>{"use strict";s();GU={logFocusDebugInfo:function(){}}});function qU(e,t){if(e){var r=e.getNextTabTarget(t,!1);return r||(zy().logFocusDebugInfo("No next focus found - restarting loop"),r=e.getNextTabTarget(t,!0)),r?(zy().logFocusDebugInfo("Next focus target: ".concat(r.getId())),r.focus()):zy().logFocusDebugInfo("No next focus found"),r}}function hD(e,t,r){var n=e.getFocusState();if(!(n===ge.FocusOn&&!r&&t===Aa.Reverse)){if((n===ge.Unfocused||r)&&t===Aa.Forward&&e.isTabbable())return e;var o=e.getChildNodes();t===Aa.Reverse&&o.reverse();for(var a=t===Aa.Forward&&n===ge.FocusOn||r?0:o.findIndex(function(u){return u.getFocusState()!==ge.Unfocused}),d=a>=0?a:0;d<o.length;++d){var c=o[d].getNextTabTarget(t,r);if(c)return c}if(t===Aa.Reverse&&e.isTabbable())return e}}function yD(e,t){if(t.nativeEvent.key!==ne.Tab)return{wasHandled:!1};var r=t.nativeEvent.shiftKey?Aa.Reverse:Aa.Forward;return{wasHandled:!0,newTabTarget:qU(e.getRoot(),r)}}var KU=f(()=>{"use strict";s();lm();gb();gD()});var CD,vD=f(()=>{"use strict";s();CD=function(){function e(){var t=this;this.root=null,this.getRoot=function(){return t.root},this.setRoot=function(r){t.root=r}}return e}()});var xb,YU=f(()=>{"use strict";s();k();vD();xb=function(){function e(t){var r=this;this.viewTreeMap=new Map,t&&t.viewTreeMap.forEach(function(n,o){return r.viewTreeMap.set(o,n)})}return e.prototype.updateIdForViewTree=function(t,r){var n=this.viewTreeMap.get(t);return n?(this.viewTreeMap.set(r,n),this.viewTreeMap.delete(t),!0):!1},e.prototype.getOrCreateViewTreeById=function(t){var r=this.viewTreeMap.get(t);return r||(r=new CD,this.viewTreeMap.set(t,r)),r},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(t){var r,n,o;try{for(var a=qe(this.viewTreeMap.values()),d=a.next();!d.done;d=a.next()){var c=d.value,u=(o=c.getRoot())===null||o===void 0?void 0:o.getDescendantById(t);if(u)return u}}catch(l){r={error:l}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}()});function xD(e){function t(){var r,n,o,a,d,c,u,l;return gt(this,function(p){switch(p.label){case 0:return[4,e];case 1:p.sent(),p.label=2;case 2:p.trys.push([2,8,9,10]),r=qe(e.getChildNodes()),n=r.next(),p.label=3;case 3:if(n.done)return[3,7];o=n.value,a=o.getIterator(),d=void 0,p.label=4;case 4:return(d=a.next()).done?[3,6]:[4,d.value];case 5:return p.sent(),[3,4];case 6:return n=r.next(),[3,3];case 7:return[3,10];case 8:return c=p.sent(),u={error:c},[3,10];case 9:try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(u)throw u.error}return[7];case 10:return[2]}})}return t()}var $U=f(()=>{"use strict";s();k()});var QU,tf,XU=f(()=>{"use strict";s();QU=I(L());lm();tf=function(){function e(){var t=this;this.ref=QU.createRef(),this.focus=function(){t.ref&&t.ref.current&&t.ref.current.focus()},this.blur=function(){t.ref&&t.ref.current&&t.ref.current.blur()},this.getFocusState=function(){return t.ref&&t.ref.current?t.ref.current.getFocusState():ge.Unfocused},this.getNextTabTarget=function(r,n){if(t.ref&&t.ref.current)return t.ref.current.getNextTabTarget(r,n)},this.isTabbable=function(){return t.ref&&t.ref.current?t.ref.current.isTabbable():!1},this.getChildNodes=function(){return t.ref&&t.ref.current?t.ref.current.getChildNodes():[]},this.addChildNode=function(r,n){if(t.ref&&t.ref.current)return t.ref.current.addChildNode(r,n)},this.getId=function(){return t.ref&&t.ref.current?t.ref.current.getId():""},this.getData=function(){if(t.ref&&t.ref.current)return t.ref.current.getData()},this.getDescendantById=function(r){if(t.ref&&t.ref.current)return t.ref.current.getDescendantById(r)},this.getIterator=function(){return t.ref&&t.ref.current?t.ref.current.getIterator():{next:function(){return{done:!0,value:t}}}}}return Object.defineProperty(e.prototype,"disabled",{get:function(){return!!(this.ref.current&&this.ref.current.disabled)},enumerable:!1,configurable:!0}),e}()});var ld,ZCe,vc,JU=f(()=>{"use strict";s();k();ld=I(L());gb();ZCe=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.registrationToken=void 0,r.onFocusStateChange=function(n){r.registrationToken&&r.registrationToken.onFocusStateChange(n)},r}return t.prototype.componentDidMount=function(){var r=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,function(){return r.props.position}))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return ld.Children.only(this.props.children)},t}(ld.PureComponent),vc=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.registrationHelperRef=ld.createRef(),r.onFocusStateChange=function(n){r.registrationHelperRef.current&&r.registrationHelperRef.current.onFocusStateChange(n)},r}return t.prototype.render=function(){var r=this;return ld.createElement(um.Consumer,null,function(n){return ld.createElement(ZCe,{parentNode:n,node:r.props.node,ref:r.registrationHelperRef,position:r.props.position},r.props.children)})},t}(ld.PureComponent)});var Lt=f(()=>{"use strict";s();OU();lm();zU();KU();YU();vD();$U();XU();JU();gD()});var dn=Re((JVe,ZU)=>{s();ZU.exports=OfficePlatformGlobal.Polyester.Components});var t5=Re((e6e,e5)=>{s();e5.exports=OfficePlatformGlobal.ReactNativeReka});var ee=Re((r6e,r5)=>{s();r5.exports=OfficePlatformGlobal.ReactNative.Components});function Fi(e){return Ny(e,n5)}var n5,eve,he,tr=f(()=>{"use strict";s();k();te();n5="CommentError",eve=function(t){var r=4294967295;if(t>r||t<-4294967296)return"dword_out_of_range(".concat(t,")");var n=t<0?r+t+1:t;return"0x".concat(n.toString(16))},he=function(e){X(t,e);function t(r,n,o){var a=e.call(this,r,n)||this;return a.tag=n,a.errorCode=o,a.name=n5,a}return t.prototype.stringify=function(){return Tu(this.tag,this.stack,"Error ".concat(eve(this.errorCode)),this.innerException)},t}(Ie)});var o5,i5,a5,s5,d5,c5,u5,l5,f5,fd,gm,p5,m5,vs=f(()=>{"use strict";s();o5="Duplicate instance registration",i5="Selected comment not found",a5="Selected thread index out of bounds",s5="Invalid number of posts for display more replies string",d5="Method not implemented",c5="Not enough replacement strings given",u5="LocalizationModule NativeModule not valid",l5="Maximum of 100 replacements",f5="Store state unexpected",fd="Invalid arguments",gm="Comment ID value is invalid in the current operation",p5="Attempting to perform an operation on an inactive draft",m5="CommentModel not found in a thread of RenderableItems"});var He,pd=f(()=>{"use strict";s();(function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"})(He||(He={}))});function tve(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(t.length>100)throw new he(l5,C.reserveTag(589103707),-2130957555);if(typeof e!="string")throw new he("Expected string but got ".concat(typeof e),C.reserveTag(589103708),-2130957537);return e.replace(C5(),function(n,o){if(o==="|")return"|";var a=parseInt(o,10);if(a>=t.length)throw new he(c5,C.reserveTag(589103709),-2130957553);return t[a]})}function Tb(e){return e.replace(C5(),function(t,r){return r==="|"?"|":"{".concat(r,"}")})}var C5,v5,TD=f(()=>{"use strict";s();k();te();Z();tr();vs();C5=function(){return/\|(\||\d+)/g};v5=function(){function e(t){if(this.constants=t,!t)throw new he("LocalizationConstants unavailable",C.reserveTag(589103710),-2130957557);this.localizedStrings=new Map(t.localizedStrings.map(function(r){var n=r.id,o=r.str;return[n,o]}))}return e.prototype.getLocaleInfo=function(){return this.constants.localeInfo},e.prototype.getString=function(t){var r=this.localizedStrings.get(t);return v().assertConditionTag(r!==void 0,"Missing string ".concat(t),589103711),r||""},e.prototype.getStringOrUndefined=function(t){return this.localizedStrings.get(t)},e.prototype.getStringWithStandardPlaceholders=function(t){return Tb(this.getString(t))},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(t){var r=this.getStringOrUndefined(t);if(r!==void 0)return Tb(r)},e.prototype.formatString=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.getString(t);try{return tve.apply(void 0,w([o],j(r),!1))}catch(a){return Fi(a)?v().assertConditionTag(!1,"Comment error in format string with stringId ".concat(t,": ").concat(a.message),589103712):v().assertConditionTag(!1,"Unknown Error in formatString with stringId ".concat(t),589103713),""}},e}()});var bb,rve,x5,T5=f(()=>{"use strict";s();bb=I(_t());bb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::Localization::LocalizedString":{id:"$number",str:"$string"}});rve={LocalizationConstants:["Mso::Document::Comments::Localization::LocalizationConstants",{localizedStrings:["Constant",["$array","Mso::Document::Comments::Localization::LocalizedString"]],localeInfo:["Constant","Mso::Document::Comments::Localization::LocalizationDetails"]}]},x5={LocalizationConstants:bb.RekaServiceRegistry.getNativeService(rve.LocalizationConstants)}});function Sb(){if(!hm)throw new he(u5,C.reserveTag(589103745),-2130957552);return hm}function b5(){if(v().assertConditionTag(hm===void 0,"LocalizationAPI has already been initialized",589103746),hm===void 0){var e=x5.LocalizationConstants;hm=new v5(e)}return hm}var hm,Ib=f(()=>{"use strict";s();te();Z();tr();vs();TD();T5();hm=void 0});function Y(){return nve[S5.Platform.OS]}var S5,nve,Ir=f(()=>{"use strict";s();S5=I(ee()),nve={android:"android",web:"web",windows:"win32",win32:"win32",macos:"macos",ios:"ios"}});var Eb,ove,Pe,ym=f(()=>{"use strict";s();k();Eb={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},ove={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",REST_RESOLVED_BODY:Eb.GRAY_20,RESOLVED_CARD_TEXT:Eb.GRAY_130,ACTIVE_COMMENT_TEXT:Eb.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},Pe=m(m({},Eb),ove)});function Rb(e){SD=e}function si(e,t){if(!SD){v().assertConditionTag(!1,"announceToScreenReader not registered",595632534);return}SD.announceToScreenReader(e,t)}var SD,sve,ID,ED=f(()=>{"use strict";s();Z();sve=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(t){t&&Rb(t)},e}(),ID=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new sve),this.screenReaderNotifierManagerInstance},e}()});var A5,k5=f(()=>{"use strict";s();ED();A5=new ID});var D5=f(()=>{"use strict";s();k5()});var Cm=f(()=>{"use strict";s();D5();ED()});var vm=Re((b8e,w5)=>{s();w5.exports=OfficePlatformGlobal.RNWin32.Components});function xs(){if(!PD)try{PD=Ly()}catch(e){throw new he("FeatureGateAPI not initialized",C.reserveTag(589103629),-2130957531)}return PD}var PD,_D=f(()=>{"use strict";s();te();Xl();tr()});var RD,F5=f(()=>{"use strict";s();RD={LivePersonaPicker:{webSettingName:"LivePersonaPicker",hardcodedPlatforms:{enabled:["win32","android"]}},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton",hardcodedPlatforms:{enabled:["win32"]}},DiscreteHostedComments:{hardcodedPlatforms:{enabled:["web"],disabled:["android"]}},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks",hardcodedPlatforms:{disabled:["android"]}},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},ExtendedDrafting:{webSettingName:"ExtendedDrafting",hardcodedPlatforms:{disabled:["android"]}},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",hardcodedPlatforms:{enabled:["win32","android"]}},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions"},CommentReactions:{webSettingName:"CommentReactions"},LinkToComment:{webSettingName:"LinkToComment"},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText"},CtrlEnterTip:{webSettingName:"CtrlEnterTip",hardcodedPlatforms:{enabled:["win32"],disabled:["android"]}},FluentSVRefreshWin32:{},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage"},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb"},MapBasedStore:{webSettingName:"MapBasedStore"},ContentFiltering:{},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]},DraftSessionRehydration:{webSettingName:"DraftSessionRehydration"},ConsumerEmailLPPEnabled:{webSettingName:"ConsumerEmailLPPEnabled"},ListsInWebComments:{webSettingName:"ListsInWebComments",dependencies:["RichContentEditIntegrationInWeb"]}}});function Qr(e,t){var r,n,o;t===void 0&&(t=new Set);var a=RD[e].hardcodedPlatforms;if(a){var d=Y();if(!((r=a.enabled)===null||r===void 0)&&r.includes(d))return!0;if(!((n=a.disabled)===null||n===void 0)&&n.includes(d))return!1}if(!xs().isFeatureEnabled(e))return!1;t.add(e);var c=(o=RD[e].dependencies)!==null&&o!==void 0?o:[];return c.every(function(u){var l=t.has(u)||Qr(u,t);return v().assertConditionTag(l,"Gate ".concat(e," enabled without dependency gate ").concat(u),544482649),l})}var O5=f(()=>{"use strict";s();Z();Ir();_D();F5()});function le(){return Y()!=="android"}function Pn(){return Y()!=="android"}function rf(){return Y()==="win32"}function md(){return Qr("LivePersonaPicker")}function ka(){return Qr("PersonaFeature")}function Iu(){return Qr("NewCommentButton")}function Kt(){return Qr("DiscreteHostedComments")}function N5(){return Qr("RenderDHCInPane")}function at(){return Qr("CommentTasks")}function xm(){return Qr("TaskPaneWithNewInfrastructure")}function gd(){return Qr("CommentTasksFromReply")}function Oi(){return Qr("HeadlessBoot")}function M5(){return Qr("AtMentionFloodgateSurvey")}function L5(){return Qr("ExtendedDrafting")}function H5(){return Qr("LogDraftCommentIdPair")}function nt(){return Qr("NewSelectionInteractions")}function lo(){return Qr("CommentReactions")}function qy(){return Qr("LinkToComment")}function Ab(){return Qr("CtrlEnterTip")}function qo(){return Qr("FluentSVRefreshWin32")}function ir(){return Qr("MapBasedStore")}function Tm(){return Qr("CommentTasksMultiAssignCreation")}function nf(){return Qr("DraftSessionRehydration")}function kb(){return Qr("ConsumerEmailLPPEnabled")}function hd(){return!1}function bm(){return xs().isChangeGateEnabled("DraftWarningGrantAccessA11yFix",8597870)}function ar(){return xs().isChangeGateEnabled("RibbonFilteringSupportMiddlewareV2",8558157)}function Db(){return xs().isChangeGateEnabled("SelectedCommentIsRenderable",8705077)}function yd(){return xs().isChangeGateEnabled("FilterCountAnnouncement",8646901)}function Ky(){return xs().isChangeGateEnabled("UpdateNewCommentButtonIconColor",8755115)}function Tc(){return xs().isChangeGateEnabled("RemoveFocusableFilterByText",8734148)}function Da(){return xs().isChangeGateEnabled("FocusManagerFilterAware",8819082)}function wa(){return yd()&&xs().isChangeGateEnabled("FixContentFilterHooksState",8900653)}var ue=f(()=>{"use strict";s();Xl();Ir();_D();O5()});var G8e,mn,U5,q8e,bc=f(()=>{"use strict";s();G8e=process.env.TEST_PAGE==="sharedcommentsdemo",mn=!1,U5=process.env.JEST_WORKER_ID!==void 0,q8e=process.env.JEST_WORKER_ID!==void 0?"JEST_TEST_ID":void 0});var Xr,DD=f(()=>{"use strict";s();(function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"})(Xr||(Xr={}))});var wb=f(()=>{"use strict";s();DD()});var V5=f(()=>{"use strict";s()});var gn,wD=f(()=>{"use strict";s();(function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"})(gn||(gn={}))});var wt,FD=f(()=>{"use strict";s();(function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread",e[e.TrackedChange=2]="TrackedChange"})(wt||(wt={}))});var Ht,j5=f(()=>{"use strict";s();(function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"})(Ht||(Ht={}))});var se,OD=f(()=>{"use strict";s();(function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated",e[e.TaskPane=2]="TaskPane",e[e.TaskPaneItem=3]="TaskPaneItem"})(se||(se={}))});var W5=f(()=>{"use strict";s();OD()});function Yy(e){return e===gn.Enabled_Default||e===gn.Enabled_ForcePrimary}var z5=f(()=>{"use strict";s();wD()});var G5=f(()=>{"use strict";s();z5()});var Ts=f(()=>{"use strict";s();V5();wD();FD();j5();OD();W5();G5()});var q5,K5=f(()=>{"use strict";s();k();te();q5=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(t){var r;return this.store.forEach(function(n,o){if(n.has(t)){if(r)throw new Ie("Double registration across instances for an extension key.",C.reserveTag(589103766));r=o}}),r},e.prototype.insertExtension=function(t,r){var n=r.instanceId;this.store.has(n)||this.store.set(n,new Map);var o=this.store.get(n);if(o.has(t.extensionKey))throw new Ie("Duplicate Registration in same instance.",C.reserveTag(589103767));this.store.forEach(function(a,d){if(d!==n&&a.has(t.extensionKey))throw new Ie("Duplicate Registration in different instance.",C.reserveTag(589103768))}),o.set(t.extensionKey,r)},e.prototype.updateExtension=function(t,r){var n=this.getInstanceIdForExtensionKey(t);if(n){var o=this.store.get(n);if(o){var a=o.get(t);if(a)return a=m(m({},a),r),o.set(t,a),a}}},e.prototype.removeExtension=function(t){var r=this.getInstanceIdForExtensionKey(t);if(r){var n=this.store.get(r);if(n){var o=n.get(t);return n.delete(t),o}}},e.prototype.getExtension=function(t){var r=this.getInstanceIdForExtensionKey(t);if(r){var n=this.store.get(r);if(n)return n.get(t)}},e.prototype.getExtensionsByInstance=function(t){return this.store.get(t)},e}()});var Y5,$5,Q5=f(()=>{"use strict";s();rt();Y5=I(_t());Ts();wb();K5();$5=function(){function e(){this.onExtensionUpdated=new Y5.EventImpl(function(){}),this.extensionStore=new q5}return e.prototype.triggerExtensionUpdated=function(t,r){this.onExtensionUpdated.trigger({extension:t,updateType:r})},e.prototype.registerExtension=function(t,r,n){var o,a=ao(),d=(o=n.priority)!==null&&o!==void 0?o:Ht.Primary,c={extensionKey:a},u=n.renderMode===se.Isolated?{componentKey:r,contentType:t,priority:d,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:r,contentType:t,priority:d,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(c,u);var l={id:a,state:u};return this.triggerExtensionUpdated(l,Xr.Add),l},e.prototype.unregisterExtension=function(t){var r=this.extensionStore.removeExtension(t);r&&this.triggerExtensionUpdated({id:t,state:r},Xr.Remove)},e.prototype.updateExtension=function(t,r){var n=this,o=function(d,c){d&&n.triggerExtensionUpdated({id:t,state:d},c)};if(!r){o(this.extensionStore.getExtension(t),Xr.ReQuery);return}o(this.extensionStore.updateExtension(t,r),Xr.Modify)},e.prototype.getExtensions=function(t,r){var n=this.extensionStore.getExtensionsByInstance(r);if(!n)return[];var o=[];return n.forEach(function(a,d){a.contentType===t&&o.push({state:a,id:d})}),o},e.prototype.getExtension=function(t){var r=this.extensionStore.getExtension(t);if(r!==void 0)return{id:t,state:r}},e}()});var X5,ND,Fb,MD=f(()=>{"use strict";s();X5=I(_t()),ND={ContentExtensionHostModule:["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}]},Fb={ContentExtensionHostModule:X5.RekaServiceRegistry.getNativeService(ND.ContentExtensionHostModule)}});var Ob,LD=f(()=>{"use strict";s();MD();Ob=function(){function e(){if(!Fb.ContentExtensionHostModule)throw new Error("NativeService not available for ContentExtensionHostModule")}return e.prototype.initializeExtensionModule=function(){Fb.ContentExtensionHostModule.initializeExtensionModule()},e.prototype.onExtensionUpdate=function(t){Fb.ContentExtensionHostModule.onExtensionUpdate(t)},e}()});function pve(e,t){switch(e){case Ht.Primary:case Ht.Secondary:switch(t){case gn.Invalid:case gn.Disabled:return Ht.Disabled;case gn.Enabled_Default:return e;case gn.Enabled_ForcePrimary:return Ht.Primary}case Ht.Disabled:return e}}function Sm(e,t){var r=e.isContentAvailable(t),n=pve(e.priority,r),o=r!==gn.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:n,contentId:t,isContentIdValid:o,type:"Isolated"}}var HD=f(()=>{"use strict";s();Ts()});var J5,Z5=f(()=>{"use strict";s();J5={ContentExtensionHostService:["SDX::ContentExtension::ContentExtensionHostService",{getExtensions:["ReturnsPromiseMethod",["$array","SDX::ContentExtension::ExtensionDescriptor"],["$number","$string"]],getExtensionState:["ReturnsPromiseMethod",["$optional",["$union",["SDX::ContentExtension::IntegratedExtensionSimple","SDX::ContentExtension::IsolatedExtensionSimple","SDX::ContentExtension::TaskPaneExtensionSimple","SDX::ContentExtension::TaskPaneItemExtensionSimple"]]],["SDX::ContentExtension::ExtensionDescriptor","$string"]],unregisterExtensionEventsForContentId:["FireAndForgetMethod",["$string","$string"]]}]}});var eV,tV,rV=f(()=>{"use strict";s();te();Z();eV=I(_t());Ts();Nb();wb();HD();LD();Z5();tV=function(){function e(t){var r=this;this.contentExtensionHostNativeModule=new Ob,this.trackedIsolatedExtensions=new Map,this.triggerIsolatedContentEnablementUpdate=function(n,o){var a=r.trackedIsolatedExtensions.get(n);a&&a.forEach(function(d,c){var u=Sm(o,c),l=u.priority!==d.priority||u.isContentIdValid!==d.isContentIdValid;l&&(r.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:n,extension:u}),u.isContentIdValid||a.delete(c))})},this.onExtensionUpdate=this.onExtensionUpdate.bind(this),t.onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.getInstance=function(){return this.instance},e.register=function(t){var r=this;this.instance||(this.instance=new e(t),eV.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return r.instance}}))},e.prototype.onExtensionUpdate=function(t){switch(t.updateType){case Xr.Add:{var r={contentType:t.extension.state.contentType,extensionKey:t.extension.id,instanceId:t.extension.state.instanceId,renderMode:t.extension.state.renderMode};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionAdded",descriptor:r});break}case Xr.Modify:switch(t.extension.state.renderMode){case se.Integrated:{var n={contentType:t.extension.state.contentType,renderMode:t.extension.state.renderMode,instanceId:t.extension.state.instanceId,componentKey:t.extension.state.componentKey,priority:t.extension.state.priority,componentDimensions:t.extension.state.componentDimensions,type:"Integrated"};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:t.extension.id,extension:n})}break;case se.Isolated:this.triggerIsolatedContentEnablementUpdate(t.extension.id,t.extension.state);break;case se.TaskPane:throw new Ie("Taskpane extension is not supported on this platform",C.reserveTag(573384474))}break;case Xr.ReQuery:{t.extension.state.renderMode===se.Isolated&&this.triggerIsolatedContentEnablementUpdate(t.extension.id,t.extension.state);break}case Xr.Remove:{this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionRemoved",extensionKey:t.extension.id,instanceId:t.extension.state.instanceId});break}default:Ne(t.updateType)}},e.prototype.getExtensions=function(t,r){var n=hr().getExtensions(t,r);return Promise.resolve(n.map(function(o){return{instanceId:r,contentType:o.state.contentType,extensionKey:o.id,renderMode:o.state.renderMode}}))},e.prototype.getExtensionState=function(t,r){var n,o=hr().getExtension(t.extensionKey);if(o===void 0)return Promise.resolve(void 0);var a;switch(o.state.renderMode){case se.Integrated:{var d={type:"Integrated",componentKey:o.state.componentKey,priority:o.state.priority,contentType:o.state.contentType,renderMode:o.state.renderMode,instanceId:o.state.instanceId,componentDimensions:o.state.componentDimensions};a=d;break}case se.Isolated:{if(r===void 0)return v().assertConditionTag(!1,"No content ID provided for isolated extension state.",593081312),Promise.resolve(void 0);var c=Sm(o.state,r);this.trackedIsolatedExtensions.has(o.id)||this.trackedIsolatedExtensions.set(o.id,new Map),(n=this.trackedIsolatedExtensions.get(o.id))===null||n===void 0||n.set(r,c),a=c;break}case se.TaskPane:return Promise.reject(new Error("Taskpane RenderMode is not supported on this platform, for descriptor with extensionKey ".concat(t.extensionKey)));default:return Promise.reject(new Error("Unexpected RenderMode on ExtensionData for descriptor with extensionKey ".concat(t.extensionKey)))}return Promise.resolve(a)},e.prototype.unregisterExtensionEventsForContentId=function(t,r){var n,o;v().assertConditionTag(!!(!((n=this.trackedIsolatedExtensions.get(t))===null||n===void 0)&&n.get(r)),"Unregistering for events for a content ID that is not cached.",593081313),(o=this.trackedIsolatedExtensions.get(t))===null||o===void 0||o.delete(r)},e.ServiceInfo=J5.ContentExtensionHostService,e}()});var nV,oV=f(()=>{"use strict";s();k();Q5();LD();rV();nV=function(e){X(t,e);function t(){var r=e.call(this)||this;return r.contentExtensionHostModule=new Ob,r.contentExtensionHostModule.initializeExtensionModule(),r}return t.prototype.initialize=function(){tV.register(this)},t}($5)});function hr(){if(BD===void 0){var e=new nV;e.initialize(),BD=e}return BD}var BD,Nb=f(()=>{"use strict";s();oV()});var iV,aV=f(()=>{"use strict";s();MD();iV=function(){function e(){}return e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(t){},e.ServiceInfo=ND.ContentExtensionHostModule,e}()});var sV=f(()=>{"use strict";s();aV()});var Eu=f(()=>{"use strict";s();wb();Nb();sV()});var dV,cV=f(()=>{"use strict";s();Z();Eu();Ts();dV=function(){function e(t,r){this.extensionKey=t,this.scope=r}return e.prototype.getExtension=function(){var t=hr().getExtension(this.extensionKey);if(!t||t.state.renderMode!==se.Integrated)throw v().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592316051),v().assertConditionTag((t==null?void 0:t.state.renderMode)===se.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:t.state.contentType,renderMode:t.state.renderMode,instanceId:t.state.instanceId,componentKey:t.state.componentKey,priority:t.state.priority,componentDimensions:t.state.componentDimensions,type:"Integrated"}},e}()});var uV,lV,fV=f(()=>{"use strict";s();k();Z();uV=I(_t());Eu();HD();Ts();lV=function(){function e(t,r){var n=this;this.extensionKey=t,this.scope=r,this.cachedExtensions={},this.onExtensionUpdate=function(o){if(o.updateType===Xr.Remove){n.teardown();return}o.extension.id===n.extensionKey&&n.updateCachedExtensions()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=hr().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(t){var r=this,n=this.cachedExtensions[t];if(n)return n.extension;var o=hr().getExtension(this.extensionKey);if(!o||o.state.renderMode!==se.Isolated)throw v().assertConditionTag(!!o,"No extension data in provider. Querying a removed extension.",592316053),v().assertConditionTag((o==null?void 0:o.state.renderMode)===se.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var a=Sm(o.state,t),d=m(m({},a),{onUpdated:new uV.EventImpl(function(c){var u=r.cachedExtensions[t];u&&(c?u.hasListener=!0:delete r.cachedExtensions[t])})});return this.cachedExtensions[t]={extension:d,hasListener:!1},d},e.prototype.updateCachedExtensions=function(){var t=this,r=hr().getExtension(this.extensionKey);if(!r||r.state.renderMode!==se.Isolated){v().assertConditionTag(!!r,"No extension data in provider. Querying a removed extension.",592314635),v().assertConditionTag((r==null?void 0:r.state.renderMode)===se.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);return}var n=r.state;Object.keys(this.cachedExtensions).forEach(function(o){var a=t.cachedExtensions[o],d=a==null?void 0:a.extension;if(!d||!a){v().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983);return}var c=Sm(n,o),u=d.priority!==c.priority||d.isContentIdValid!==c.isContentIdValid;u&&(d.priority=c.priority,d.isContentIdValid=c.isContentIdValid,d.onUpdated.trigger({})),!a.hasListener&&!c.isContentIdValid&&delete t.cachedExtensions[o]})},e}()});var pV,mV=f(()=>{"use strict";s();k();te();Z();Eu();Ts();pV=function(){function e(t,r){this.extensionKey=t,this.scope=r}return e.prototype.getExtension=function(){var t=hr().getExtension(this.extensionKey);if(!t||t.state.renderMode!==se.TaskPane)throw v().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",573384475),v().assertConditionTag(!t||t.state.renderMode===se.TaskPane,"Extension data is not for the TaskPane Render Mode.",573384476),new Ie("Unable to query extension data within provider.",C.reserveTag(573384477));return m(m({},t.state),{type:"TaskPane"})},e}()});var gV,hV=f(()=>{"use strict";s();k();te();Z();Eu();Ts();gV=function(){function e(t,r){this.extensionKey=t,this.scope=r}return e.prototype.getExtension=function(){var t=hr().getExtension(this.extensionKey);if(!t||t.state.renderMode!==se.TaskPaneItem)throw v().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",546174347),v().assertConditionTag(!t||t.state.renderMode===se.TaskPaneItem,"Extension data is not for the TaskPaneItem Render Mode.",546174348),new Ie("Unable to query extension data within provider.",C.reserveTag(546174349));return m(m({},t.state),{type:"TaskPaneItem"})},e}()});var yV,CV=f(()=>{"use strict";s();te();Z();Eu();Ts();cV();fV();mV();hV();yV=function(){function e(t){this._detached=!1,this._id=t.id;var r={contentType:t.state.contentType,renderMode:t.state.renderMode,instanceId:t.state.instanceId};switch(t.state.renderMode){case se.TaskPane:this._extensionProvider=new pV(this._id,r);break;case se.TaskPaneItem:this._extensionProvider=new gV(this._id,r);break;case se.Isolated:this._extensionProvider=new lV(this._id,r);break;case se.Integrated:this._extensionProvider=new dV(this._id,r);break}}return e.prototype.triggerUpdate=function(){hr().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,hr().unregisterExtension(this._id)},e.prototype.updateState=function(t){var r=hr().getExtension(this._id);if(r===void 0)throw v().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));var n=Object.keys(t).length===1&&t.priority!==void 0;if(n&&r.state.priority===t.priority){this.triggerUpdate();return}hr().updateExtension(this._id,t)},Object.defineProperty(e.prototype,"priority",{get:function(){var r=hr().getExtension(this._id);if(r===void 0)throw v().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new Ie("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"),C.reserveTag(589103770));return r.state.priority},set:function(r){this._detached||this.updateState({priority:r})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var r=hr().getExtension(this._id);if(r===void 0)throw v().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));return r.state.componentDimensions},set:function(r){this._detached||this.updateState({componentDimensions:r})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!1,configurable:!0}),e}()});var vV,xV,TV=f(()=>{"use strict";s();vV=I(_t());Eu();Ts();xV=function(){function e(t,r){var n=this;this.contentTypes=t,this.host=r,this.onUpdated=new vV.EventImpl(function(){}),hr().onExtensionUpdated.subscribe(function(o){t.find(function(a){return a===o.extension.state.contentType})&&o.updateType!==Xr.ReQuery&&n.onUpdated.trigger({})})}return Object.defineProperty(e.prototype,"providers",{get:function(){var r=[],n=function(c){var u=o.host.extensions[c];u.priority!==Ht.Disabled&&o.contentTypes.find(function(l){return l===u.provider.scope.contentType})&&r.push(u.provider)},o=this;for(var a in this.host.extensions)n(a);return r},enumerable:!1,configurable:!0}),e}()});var bV,gve,SV,IV=f(()=>{"use strict";s();k();te();bV=I(_t());Eu();DD();FD();CV();TV();gve=function(e){X(t,e);function t(r,n){var o=e.call(this,r)||this;return o.onAfterSubscribe=n,o}return t.prototype.subscribe=function(r){var n=e.prototype.subscribe.call(this,r);return this.onAfterSubscribe(r,n),n},t}(bV.EventImpl),SV=function(){function e(){var t=this;this.contentTypeRegistrationInfo=new Map,this.extensions={},this.onAfterSubscribe=function(r,n){t.contentTypeRegistrationInfo.forEach(function(o,a){a!==wt.Empty&&Object.keys(o).forEach(function(d){o[d]&&r({instanceId:d,contentType:a},n)})})},this.onExtensionFirstRequested=new gve(function(){},this.onAfterSubscribe),hr().onExtensionUpdated.subscribe(function(r){switch(r.updateType){case Xr.ReQuery:break;case Xr.Remove:{delete t.extensions[r.extension.id];break}case Xr.Add:case Xr.Modify:{t.ensureExtensionCached(r.extension.id,r.extension.state);break}default:Ne(r.updateType)}})}return e.prototype.registerExtension=function(t,r,n){var o=hr().registerExtension(t,r,n);return this.ensureExtensionCached(o.id,o.state),Promise.resolve(this.extensions[o.id])},e.prototype.getExtensions=function(t,r){var n=this,o=new xV(t,this);return t.forEach(function(a){var d,c=hr().getExtensions(a,r);c.forEach(function(l){n.ensureExtensionCached(l.id,l.state)});var u=n.contentTypeRegistrationInfo.get(a);if(u!==void 0){if(u[r])return;u[r]=!0}else n.contentTypeRegistrationInfo.set(a,(d={},d[r]=!0,d));n.onExtensionFirstRequested.trigger({contentType:a,instanceId:r})}),o},e.prototype.ensureExtensionCached=function(t,r){this.extensions[t]===void 0&&(this.extensions[t]=new yV({id:t,state:r}))},e}()});function Mb(){return UD===void 0&&(UD=new SV),UD}var UD,VD=f(()=>{"use strict";s();IV()});var EV=f(()=>{"use strict";s();VD()});var Do=f(()=>{"use strict";s();VD();Nb();EV();Ts()});var _V=Re((F7e,PV)=>{"use strict";s();var hve="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";PV.exports=hve});var DV=Re((N7e,kV)=>{"use strict";s();var yve=_V();function RV(){}function AV(){}AV.resetWarningCache=RV;kV.exports=function(){function e(n,o,a,d,c,u){if(u!==yve){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:AV,resetWarningCache:RV};return r.PropTypes=r,r}});var FV=Re((L7e,wV)=>{s();wV.exports=DV()()});var OV,Fa,Pu=f(()=>{"use strict";s();OV=I(L()),Fa=OV.default.createContext(null)});function Cve(e){e()}var NV,MV,LV,jD=f(()=>{"use strict";s();NV=Cve,MV=function(t){return NV=t},LV=function(){return NV}});function vve(){var e=LV(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var o=t;o;)o.callback(),o=o.next})},get:function(){for(var o=[],a=t;a;)o.push(a),a=a.next;return o},subscribe:function(o){var a=!0,d=r={callback:o,next:null,prev:r};return d.prev?d.prev.next=d:t=d,function(){!a||t===null||(a=!1,d.next?d.next.prev=d.prev:r=d.prev,d.prev?d.prev.next=d.next:t=d.next)}}}}function Im(e,t){var r,n=HV;function o(g){return u(),n.subscribe(g)}function a(){n.notify()}function d(){p.onStateChange&&p.onStateChange()}function c(){return!!r}function u(){r||(r=t?t.addNestedSub(d):e.subscribe(d),n=vve())}function l(){r&&(r(),r=void 0,n.clear(),n=HV)}var p={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:d,isSubscribed:c,trySubscribe:u,tryUnsubscribe:l,getListeners:function(){return n}};return p}var HV,Lb=f(()=>{"use strict";s();jD();HV={notify:function(){},get:function(){return[]}}});var BV,of,Hb=f(()=>{"use strict";s();BV=I(L()),of=BV.useLayoutEffect});function xve(e){var t=e.store,r=e.context,n=e.children,o=(0,$y.useMemo)(function(){var c=Im(t);return{store:t,subscription:c}},[t]),a=(0,$y.useMemo)(function(){return t.getState()},[t]);of(function(){var c=o.subscription;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),a!==t.getState()&&c.notifyNestedSubs(),function(){c.tryUnsubscribe(),c.onStateChange=null}},[o,a]);var d=r||Fa;return $y.default.createElement(d.Provider,{value:o},n)}var $y,af,UV=f(()=>{"use strict";s();$y=I(L());Pu();Lb();Hb();af=xve});function Oa(){return Oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oa.apply(this,arguments)}var Bb=f(()=>{"use strict";s()});function _u(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,a;for(a=0;a<n.length;a++)o=n[a],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}var Ub=f(()=>{"use strict";s()});var jV=Re(rr=>{"use strict";s();var WD=Symbol.for("react.element"),zD=Symbol.for("react.portal"),Vb=Symbol.for("react.fragment"),jb=Symbol.for("react.strict_mode"),Wb=Symbol.for("react.profiler"),zb=Symbol.for("react.provider"),Gb=Symbol.for("react.context"),Tve=Symbol.for("react.server_context"),qb=Symbol.for("react.forward_ref"),Kb=Symbol.for("react.suspense"),Yb=Symbol.for("react.suspense_list"),$b=Symbol.for("react.memo"),Qb=Symbol.for("react.lazy"),bve=Symbol.for("react.offscreen"),VV;VV=Symbol.for("react.module.reference");function Na(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case WD:switch(e=e.type,e){case Vb:case Wb:case jb:case Kb:case Yb:return e;default:switch(e=e&&e.$$typeof,e){case Tve:case Gb:case qb:case Qb:case $b:case zb:return e;default:return t}}case zD:return t}}}rr.ContextConsumer=Gb;rr.ContextProvider=zb;rr.Element=WD;rr.ForwardRef=qb;rr.Fragment=Vb;rr.Lazy=Qb;rr.Memo=$b;rr.Portal=zD;rr.Profiler=Wb;rr.StrictMode=jb;rr.Suspense=Kb;rr.SuspenseList=Yb;rr.isAsyncMode=function(){return!1};rr.isConcurrentMode=function(){return!1};rr.isContextConsumer=function(e){return Na(e)===Gb};rr.isContextProvider=function(e){return Na(e)===zb};rr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===WD};rr.isForwardRef=function(e){return Na(e)===qb};rr.isFragment=function(e){return Na(e)===Vb};rr.isLazy=function(e){return Na(e)===Qb};rr.isMemo=function(e){return Na(e)===$b};rr.isPortal=function(e){return Na(e)===zD};rr.isProfiler=function(e){return Na(e)===Wb};rr.isStrictMode=function(e){return Na(e)===jb};rr.isSuspense=function(e){return Na(e)===Kb};rr.isSuspenseList=function(e){return Na(e)===Yb};rr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Vb||e===Wb||e===jb||e===Kb||e===Yb||e===bve||typeof e=="object"&&e!==null&&(e.$$typeof===Qb||e.$$typeof===$b||e.$$typeof===zb||e.$$typeof===Gb||e.$$typeof===qb||e.$$typeof===VV||e.getModuleId!==void 0)};rr.typeOf=Na});var Xb=Re((ize,WV)=>{"use strict";s();WV.exports=jV()});var QV=Re((sze,$V)=>{"use strict";s();var GD=Xb(),Sve={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ive={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Eve={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},KV={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qD={};qD[GD.ForwardRef]=Eve;qD[GD.Memo]=KV;function zV(e){return GD.isMemo(e)?KV:qD[e.$$typeof]||Sve}var Pve=Object.defineProperty,_ve=Object.getOwnPropertyNames,GV=Object.getOwnPropertySymbols,Rve=Object.getOwnPropertyDescriptor,Ave=Object.getPrototypeOf,qV=Object.prototype;function YV(e,t,r){if(typeof t!="string"){if(qV){var n=Ave(t);n&&n!==qV&&YV(e,n,r)}var o=_ve(t);GV&&(o=o.concat(GV(t)));for(var a=zV(e),d=zV(t),c=0;c<o.length;++c){var u=o[c];if(!Ive[u]&&!(r&&r[u])&&!(d&&d[u])&&!(a&&a[u])){var l=Rve(t,u);try{Pve(e,u,l)}catch(p){}}}}return e}$V.exports=YV});function Ove(e,t){var r=e[1];return[t.payload,r+1]}function XV(e,t,r){of(function(){return e.apply(void 0,t)},r)}function Nve(e,t,r,n,o,a,d){e.current=n,t.current=o,r.current=!1,a.current&&(a.current=null,d())}function Mve(e,t,r,n,o,a,d,c,u,l){if(e){var p=!1,g=null,h=function(){if(!p){var T=t.getState(),b,S;try{b=n(T,o.current)}catch(E){S=E,g=E}S||(g=null),b===a.current?d.current||u():(a.current=b,c.current=b,d.current=!0,l({type:"STORE_UPDATED",payload:{error:S}}))}};r.onStateChange=h,r.trySubscribe(),h();var x=function(){if(p=!0,r.tryUnsubscribe(),r.onStateChange=null,g)throw g};return x}}function Jb(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,o=n===void 0?function(D){return"ConnectAdvanced("+D+")"}:n,a=r.methodName,d=a===void 0?"connectAdvanced":a,c=r.renderCountProp,u=c===void 0?void 0:c,l=r.shouldHandleStateChanges,p=l===void 0?!0:l,g=r.storeKey,h=g===void 0?"store":g,x=r.withRef,y=x===void 0?!1:x,T=r.forwardRef,b=T===void 0?!1:T,S=r.context,E=S===void 0?Fa:S,P=_u(r,kve),_=E;return function(O){var H=O.displayName||O.name||"Component",V=o(H),M=Oa({},P,{getDisplayName:o,methodName:d,renderCountProp:u,shouldHandleStateChanges:p,storeKey:h,displayName:V,wrappedComponentName:H,WrappedComponent:O}),G=P.pure;function K(ae){return e(ae.dispatch,M)}var z=G?Or.useMemo:function(ae){return ae()};function $(ae){var ie=(0,Or.useMemo)(function(){var yc=ae.reactReduxForwardedRef,am=_u(ae,Dve);return[ae.context,yc,am]},[ae]),Te=ie[0],Oe=ie[1],ke=ie[2],it=(0,Or.useMemo)(function(){return Te&&Te.Consumer&&(0,JV.isContextConsumer)(Or.default.createElement(Te.Consumer,null))?Te:_},[Te,_]),_e=(0,Or.useContext)(it),ct=!!ae.store&&!!ae.store.getState&&!!ae.store.dispatch,Ge=!!_e&&!!_e.store,Nt=ct?ae.store:_e.store,Vt=(0,Or.useMemo)(function(){return K(Nt)},[Nt]),yt=(0,Or.useMemo)(function(){if(!p)return Fve;var yc=Im(Nt,ct?null:_e.subscription),am=yc.notifyNestedSubs.bind(yc);return[yc,am]},[Nt,ct,_e]),zt=yt[0],Fr=yt[1],In=(0,Or.useMemo)(function(){return ct?_e:Oa({},_e,{subscription:zt})},[ct,_e,zt]),jn=(0,Or.useReducer)(Ove,wve,Lve),io=jn[0],ut=io[0],pn=jn[1];if(ut&&ut.error)throw ut.error;var ql=(0,Or.useRef)(),Sr=(0,Or.useRef)(ke),$r=(0,Or.useRef)(),ys=(0,Or.useRef)(!1),cd=z(function(){return $r.current&&ke===Sr.current?$r.current:Vt(Nt.getState(),ke)},[Nt,ut,ke]);XV(Nve,[Sr,ql,ys,ke,cd,$r,Fr]),XV(Mve,[p,Nt,zt,Vt,Sr,ql,ys,$r,Fr,pn],[Nt,zt,Vt]);var im=(0,Or.useMemo)(function(){return Or.default.createElement(O,Oa({},cd,{ref:Oe}))},[Oe,O,cd]),Mk=(0,Or.useMemo)(function(){return p?Or.default.createElement(it.Provider,{value:In},im):im},[it,im,In]);return Mk}var q=G?Or.default.memo($):$;if(q.WrappedComponent=O,q.displayName=$.displayName=V,b){var re=Or.default.forwardRef(function(ie,Te){return Or.default.createElement(q,Oa({},ie,{reactReduxForwardedRef:Te}))});return re.displayName=V,re.WrappedComponent=O,(0,KD.default)(re,O)}return(0,KD.default)(q,O)}}var KD,Or,JV,kve,Dve,wve,Fve,Lve,YD=f(()=>{"use strict";s();Bb();Ub();KD=I(QV()),Or=I(L()),JV=I(Xb());Lb();Hb();Pu();kve=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],Dve=["reactReduxForwardedRef"],wve=[],Fve=[null,null];Lve=function(){return[null,0]}});function ZV(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Em(e,t){if(ZV(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!Object.prototype.hasOwnProperty.call(t,r[o])||!ZV(e[r[o]],t[r[o]]))return!1;return!0}var $D=f(()=>{"use strict";s()});function QD(e,t){var r={},n=function(d){var c=e[d];typeof c=="function"&&(r[d]=function(){return t(c.apply(void 0,arguments))})};for(var o in e)n(o);return r}var e6=f(()=>{"use strict";s()});var t6=f(()=>{"use strict";s()});var XD=f(()=>{"use strict";s()});var JD=f(()=>{"use strict";s();t6();XD()});function Qy(e){return function(r,n){var o=e(r,n);function a(){return o}return a.dependsOnOwnProps=!1,a}}function r6(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Zb(e,t){return function(n,o){var a=o.displayName,d=function(u,l){return d.dependsOnOwnProps?d.mapToProps(u,l):d.mapToProps(u)};return d.dependsOnOwnProps=!0,d.mapToProps=function(u,l){d.mapToProps=e,d.dependsOnOwnProps=r6(e);var p=d(u,l);return typeof p=="function"&&(d.mapToProps=p,d.dependsOnOwnProps=r6(p),p=d(u,l)),p},d}}var ZD=f(()=>{"use strict";s();JD()});function Bve(e){return typeof e=="function"?Zb(e,"mapDispatchToProps"):void 0}function Uve(e){return e?void 0:Qy(function(t){return{dispatch:t}})}function Vve(e){return e&&typeof e=="object"?Qy(function(t){return QD(e,t)}):void 0}var n6,o6=f(()=>{"use strict";s();e6();ZD();n6=[Bve,Uve,Vve]});function jve(e){return typeof e=="function"?Zb(e,"mapStateToProps"):void 0}function Wve(e){return e?void 0:Qy(function(){return{}})}var i6,a6=f(()=>{"use strict";s();ZD();i6=[jve,Wve]});function zve(e,t,r){return Oa({},r,e,t)}function Gve(e){return function(r,n){var o=n.displayName,a=n.pure,d=n.areMergedPropsEqual,c=!1,u;return function(p,g,h){var x=e(p,g,h);return c?(!a||!d(x,u))&&(u=x):(c=!0,u=x),u}}}function qve(e){return typeof e=="function"?Gve(e):void 0}function Kve(e){return e?void 0:function(){return zve}}var s6,d6=f(()=>{"use strict";s();Bb();JD();s6=[qve,Kve]});var c6=f(()=>{"use strict";s();XD()});function $ve(e,t,r,n){return function(a,d){return r(e(a,d),t(n,d),d)}}function Qve(e,t,r,n,o){var a=o.areStatesEqual,d=o.areOwnPropsEqual,c=o.areStatePropsEqual,u=!1,l,p,g,h,x;function y(P,_){return l=P,p=_,g=e(l,p),h=t(n,p),x=r(g,h,p),u=!0,x}function T(){return g=e(l,p),t.dependsOnOwnProps&&(h=t(n,p)),x=r(g,h,p),x}function b(){return e.dependsOnOwnProps&&(g=e(l,p)),t.dependsOnOwnProps&&(h=t(n,p)),x=r(g,h,p),x}function S(){var P=e(l,p),_=!c(P,g);return g=P,_&&(x=r(g,h,p)),x}function E(P,_){var D=!d(_,p),O=!a(P,l,_,p);return l=P,p=_,D&&O?T():D?b():O?S():x}return function(_,D){return u?E(_,D):y(_,D)}}function ew(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,a=_u(t,Yve),d=r(e,a),c=n(e,a),u=o(e,a),l=a.pure?Qve:$ve;return l(d,c,u,e,a)}var Yve,u6=f(()=>{"use strict";s();Ub();c6();Yve=["initMapStateToProps","initMapDispatchToProps","initMergeProps"]});function tw(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(a,d){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+d.wrappedComponentName+".")}}function Jve(e,t){return e===t}function Zve(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?Jb:r,o=t.mapStateToPropsFactories,a=o===void 0?i6:o,d=t.mapDispatchToPropsFactories,c=d===void 0?n6:d,u=t.mergePropsFactories,l=u===void 0?s6:u,p=t.selectorFactory,g=p===void 0?ew:p;return function(x,y,T,b){b===void 0&&(b={});var S=b,E=S.pure,P=E===void 0?!0:E,_=S.areStatesEqual,D=_===void 0?Jve:_,O=S.areOwnPropsEqual,H=O===void 0?Em:O,V=S.areStatePropsEqual,M=V===void 0?Em:V,G=S.areMergedPropsEqual,K=G===void 0?Em:G,z=_u(S,Xve),$=tw(x,a,"mapStateToProps"),q=tw(y,c,"mapDispatchToProps"),re=tw(T,l,"mergeProps");return n(g,Oa({methodName:"connect",getDisplayName:function(ie){return"Connect("+ie+")"},shouldHandleStateChanges:!!x,initMapStateToProps:$,initMapDispatchToProps:q,initMergeProps:re,pure:P,areStatesEqual:D,areOwnPropsEqual:H,areStatePropsEqual:M,areMergedPropsEqual:K},z))}}var Xve,na,l6=f(()=>{"use strict";s();Bb();Ub();YD();$D();o6();a6();d6();u6();Xve=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];na=Zve()});function rw(){var e=(0,f6.useContext)(Fa);return e}var f6,nw=f(()=>{"use strict";s();f6=I(L());Pu()});var exe,ow=f(()=>{"use strict";s();exe=I(L());Pu();nw()});var p6=f(()=>{"use strict";s();Pu();ow()});function oxe(e,t,r,n){var o=(0,oa.useReducer)(function(y){return y+1},0),a=o[1],d=(0,oa.useMemo)(function(){return Im(r,n)},[r,n]),c=(0,oa.useRef)(),u=(0,oa.useRef)(),l=(0,oa.useRef)(),p=(0,oa.useRef)(),g=r.getState(),h;try{if(e!==u.current||g!==l.current||c.current){var x=e(g);p.current===void 0||!t(x,p.current)?h=x:h=p.current}else h=p.current}catch(y){throw c.current&&(y.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),y}return of(function(){u.current=e,l.current=g,p.current=h,c.current=void 0}),of(function(){function y(){try{var T=r.getState();if(T===l.current)return;var b=u.current(T);if(t(b,p.current))return;p.current=b,l.current=T}catch(S){c.current=S}a()}return d.onStateChange=y,d.trySubscribe(),y(),function(){return d.tryUnsubscribe()}},[r,d]),h}function m6(e){e===void 0&&(e=Fa);var t=e===Fa?rw:function(){return(0,oa.useContext)(e)};return function(n,o){o===void 0&&(o=nxe);var a=t(),d=a.store,c=a.subscription,u=oxe(n,o,d,c);return(0,oa.useDebugValue)(u),u}}var oa,nxe,iw,g6=f(()=>{"use strict";s();oa=I(L());nw();Lb();Hb();Pu();nxe=function(t,r){return t===r};iw=m6()});var h6=f(()=>{"use strict";s();UV();YD();Pu();l6();p6();g6();ow();$D()});var aw,y6=f(()=>{"use strict";s();aw=I(ee())});var bs=f(()=>{"use strict";s();h6();y6();jD();MV(aw.unstable_batchedUpdates)});var Cd,sw=f(()=>{"use strict";s();Cd="Default_7210d794-9f0f-4d0a-805c-964303b2676b"});function dw(e,t){return e===t}function vd(e,t){return function(r){if(dw(r.apiContext||Cd,e)){var n=r;t(n)}}}var C6=f(()=>{"use strict";s();sw()});var v6=f(()=>{"use strict";s();C6()});var x6=f(()=>{"use strict";s();sw()});var Ru=f(()=>{"use strict";s();v6();x6()});var Sc,cn,Ma=f(()=>{"use strict";s();(function(e){e.HalfPane="half-pane",e.FullPane="full-pane"})(Sc||(Sc={}));cn=Sc});function yr(e){return e.parentId===""?e:void 0}function $e(e){return e.parentId||e.commentId}var di=f(()=>{"use strict";s()});function dxe(e){var t;return{get:function(n){return t&&e(t.key,n)?t.value:gS},put:function(n,o){t={key:n,value:o}},getEntries:function(){return t?[t]:[]},clear:function(){t=void 0}}}function cxe(e,t){var r=[];function n(c){var u=r.findIndex(function(p){return t(c,p.key)});if(u>-1){var l=r[u];return u>0&&(r.splice(u,1),r.unshift(l)),l.value}return gS}function o(c,u){n(c)===gS&&(r.unshift({key:c,value:u}),r.length>e&&r.pop())}function a(){return r}function d(){r=[]}return{get:n,put:o,getEntries:a,clear:d}}function uxe(e){return function(r,n){if(r===null||n===null||r.length!==n.length)return!1;for(var o=r.length,a=0;a<o;a++)if(!e(r[a],n[a]))return!1;return!0}}function hS(e,t){var r=typeof t=="object"?t:{equalityCheck:t},n=r.equalityCheck,o=n===void 0?P6:n,a=r.maxSize,d=a===void 0?1:a,c=r.resultEqualityCheck,u=uxe(o),l=d===1?dxe(u):cxe(d,u);function p(){var g=l.get(arguments);if(g===gS){if(g=e.apply(null,arguments),c){var h=l.getEntries(),x=h.find(function(y){return c(y.value,g)});x&&(g=x.value)}l.put(arguments,g)}return g}return p.clearCache=function(){return l.clear()},p}var gS,P6,_6=f(()=>{"use strict";s();gS="NOT_FOUND";P6=function(t,r){return t===r}});function lxe(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(n){return typeof n=="function"})){var r=t.map(function(n){return typeof n=="function"?"function "+(n.name||"unnamed")+"()":typeof n}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+r+"]")}return t}function cw(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=function(){for(var d=arguments.length,c=new Array(d),u=0;u<d;u++)c[u]=arguments[u];var l=0,p,g={memoizeOptions:void 0},h=c.pop();if(typeof h=="object"&&(g=h,h=c.pop()),typeof h!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof h+"]");var x=g,y=x.memoizeOptions,T=y===void 0?r:y,b=Array.isArray(T)?T:[T],S=lxe(c),E=e.apply(void 0,[function(){return l++,h.apply(null,arguments)}].concat(b)),P=e(function(){for(var D=[],O=S.length,H=0;H<O;H++)D.push(S[H].apply(null,arguments));return p=E.apply(null,D),p});return Object.assign(P,{resultFunc:h,memoizedResultFunc:E,dependencies:S,lastResult:function(){return p},recomputations:function(){return l},resetRecomputations:function(){return l=0}}),P};return o}var _n,Pm=f(()=>{"use strict";s();_6();_n=cw(hS)});var ci,Jy=f(()=>{"use strict";s();(function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"})(ci||(ci={}))});var Rt,uw=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"})(Rt||(Rt={}))});function Zy(e){switch(e){case"ins":return tt.Insert;case"mod":return tt.Modify;case"del":return tt.Delete;case"load":return tt.Load;default:return tt.Unknown}}var tt,ia,sf=f(()=>{"use strict";s();(function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"})(tt||(tt={}));ia=tt});var eC,R6=f(()=>{"use strict";s();(function(e){e[e.FailedToCommit=1]="FailedToCommit"})(eC||(eC={}))});var De,ui=f(()=>{"use strict";s();(function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated"})(De||(De={}))});var Fe,Ic=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted",e[e.ReactionRestricted=128]="ReactionRestricted"})(Fe||(Fe={}))});var fo,aa,Ko,Ec,xd=f(()=>{"use strict";s();fo="CREATE",aa="EDIT",Ko="REPLY",Ec="METADATA"});var Yt,_m=f(()=>{"use strict";s();(function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"})(Yt||(Yt={}))});var jt,Pc=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"})(jt||(jt={}))});var Ni,yS=f(()=>{"use strict";s();(function(e){e[e.Like=1]="Like"})(Ni||(Ni={}))});var Au=f(()=>{"use strict";s();Jy();uw();sf();R6();ui();Ic();xd();_m();pd();Pc();yS()});var sr,lw=f(()=>{"use strict";s();(function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"})(sr||(sr={}))});var Td,A6=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"})(Td||(Td={}))});var La,k6=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"})(La||(La={}))});var D6=f(()=>{"use strict";s();k6()});function tC(e){return!!e&&e.Id!==void 0&&e.Name!==void 0&&e.UserPrincipalName!==void 0&&e.EmailAddresses!==void 0&&e.SuggestionType!==void 0&&e.SuggestionSubtype!==void 0&&e.HostAppSuggestion!==void 0&&e.Source!==void 0&&e.SuggestionOrigin!==void 0}function ku(e){return!!e&&e.UserId!==void 0&&e.Provider!==void 0}var w6=f(()=>{"use strict";s()});var F6=f(()=>{"use strict";s();w6()});var df,O6=f(()=>{"use strict";s();(function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"})(df||(df={}))});var N6=f(()=>{"use strict";s();O6()});var bd=f(()=>{"use strict";s();A6();D6();F6();N6()});function M6(e,t){return!e||!t?!1:e.UserId===t.UserId&&e.Provider===t.Provider}function Du(e){return e?tC(e)?e.Name:e.DisplayName:""}function Ss(e){if(!e)return"";if(!tC(e))return v().assertConditionTag(!md()||Y()==="android","LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return v().assertConditionTag(Y()==="win32","UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new he("UserPrincipalName and EmailAddresses, both not available",C.reserveTag(589103706),-2130957499)}function CS(e){if(!e)return"";if(ku(e)){var t=e.Email||e.UserId;return v().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return Ss(e)}function fw(e){return e.UserId?e.UserId:Nr(e)}function Nr(e){return e.DisplayName!==void 0?e.DisplayName:(v().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function L6(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function pw(e){return Object.keys(e).length===0&&v().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function vS(e,t){t.forEach(function(r){if(r.UserId&&e[r.UserId]){delete e[r.UserId];return}r.Email&&e[r.Email]&&delete e[r.Email]})}function H6(e,t){return t.forEach(function(r){e[CS(r)]={assignee:r}}),e}function mw(e,t){Object.keys(t).forEach(function(r){e[r]={assignee:t[r].mentionee}})}function B6(e,t){var r=CS(t);e[r]?delete e[r]:e[r]={assignee:t}}function U6(e){var t={};for(var r in e)e[r].stillInDraft&&(t[r]=e[r]);return t}function xS(e){return e.some(function(t){return t.IsCurrentUser})}var hn=f(()=>{"use strict";s();te();bd();Z();Ir();tr();ue()});function wu(e){return e===ci.CheckEnabled}function Fu(e){return e===ci.CheckToggled}function Ha(e){return e===ci.Execute}var dr,rC=f(()=>{"use strict";s();Jy();(function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"})(dr||(dr={}))});function nC(e){switch(e){case"load":case"ins":case"mod":case"del":return!0;default:return!1}}var gw=f(()=>{"use strict";s()});function Is(e){return e.numberOfComments!==void 0&&e.numberOfThreads!==void 0}function _c(e){return e.comments!==void 0||e.threads!==void 0}function oC(e){return e.threads!==void 0&&e.comments===void 0}function Rc(e){return e.comments!==void 0||e.commentIds!==void 0}function Ac(e){return e.commentIds!==void 0}function kc(e){return e.changes!==void 0}function iC(e){return e.commentId!==void 0}function aC(e){return e.commentId!==void 0}function sC(e){return e.contextDetails!==void 0}function dC(e){return e.modelCapabilityFlags!==void 0}function cC(e){return e.errorType!==void 0}function uC(e){return e.draftId!==void 0}function uf(e){return e.draftId!==void 0}function lC(e){return e.commentId!==void 0&&e.smartReplies!==void 0}var cf,Es=f(()=>{"use strict";s();(function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"})(cf||(cf={}))});var j6=f(()=>{"use strict";s()});function fC(e){return e.sessionType===fo}function lf(e){return e.sessionType===Ko&&e.threadId!==void 0}function Ba(e){return e.sessionType===aa&&e.commentId!==void 0}var TS=f(()=>{"use strict";s();xd()});var hw,pC,mC,gC,W6=f(()=>{"use strict";s();hw=function(){function e(){}return e.none="none",e.disc="disc",e.decimalParenthesis="decimal-parenthesis",e.decimalPeriod="decimal-period",e.lowerAlphaParenthesis="lower-alpha-parenthesis",e.lowerAlphaPeriod="lower-alpha-period",e.upperAlphaParenthesis="upper-alpha-parenthesis",e.upperAlphaPeriod="upper-alpha-period",e.lowerRomanParenthesis="lower-roman-parenthesis",e.lowerRomanPeriod="lower-roman-period",e.upperRomanParenthesis="upper-roman-parenthesis",e.upperRomanPeriod="upper-roman-period",e}();(function(e){e[e.None=0]="None",e[e.Bullet=1]="Bullet",e[e.NumberArabic=2]="NumberArabic",e[e.AlphabetLowerCase=3]="AlphabetLowerCase",e[e.AlphabetUpperCase=4]="AlphabetUpperCase",e[e.NumberRomanLowerCase=5]="NumberRomanLowerCase",e[e.NumberRomanUpperCase=6]="NumberRomanUpperCase"})(pC||(pC={}));(function(e){e[e.Parenthesis=0]="Parenthesis",e[e.Period=1]="Period",e[e.Plain=2]="Plain",e[e.Minus=3]="Minus"})(mC||(mC={}));(function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify"})(gC||(gC={}))});var yw=f(()=>{"use strict";s();lw()});var Cw=f(()=>{"use strict";s();rC();gw();Es();di();j6();TS();W6();yw()});var Ps=f(()=>{"use strict";s();Cw();Au()});var Sd,vw=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"})(Sd||(Sd={}))});var K6=f(()=>{"use strict";s()});var _s,xw=f(()=>{"use strict";s();(function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"})(_s||(_s={}))});var Y6=f(()=>{"use strict";s();xw()});function Ou(e){return e.containerType===cn.HalfPane}var bS=f(()=>{"use strict";s();Ma()});var $6=f(()=>{"use strict";s()});function Nu(e){if(!e)return!1;var t=e;return t.displayMode!==void 0&&typeof t.displayMode=="string"}function ff(e,t){return e.displayMode!==t.displayMode?!1:e.displayMode===po.Variable?e.desiredHeight===t.desiredHeight:!0}var po,Mu=f(()=>{"use strict";s();(function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"})(po||(po={}))});var li,SS=f(()=>{"use strict";s();(function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"})(li||(li={}))});var Q6=f(()=>{"use strict";s();Mu();SS();Ma()});var X6=f(()=>{"use strict";s();Y6();bS();$6();Q6()});var Dc=f(()=>{"use strict";s();Ps();K6();X6()});function It(e,t){return m(m({},e),{trackback:t})}function B(e,t,r){return{type:e,payload:t,actionDetail:r}}var de=f(()=>{"use strict";s();k()});function IS(e,t){return B("ACTIVE_FILTER_UPDATED",t,e)}var J6=f(()=>{"use strict";s();de()});function ES(e,t){return B("ADD_CONTENT_EXTENSION",{extension:t},e)}var Tw=f(()=>{"use strict";s();de()});function PS(e,t){return B("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}var Z6=f(()=>{"use strict";s();de()});function Am(e,t){return B("APPLY_COMMENT_CHANGES",{changes:t},e)}var e8=f(()=>{"use strict";s();de()});function _S(e,t,r){return B("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:r},e)}var bw=f(()=>{"use strict";s();de()});function RS(e,t,r,n){return B("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:r,rehydratedDraftParams:n},e)}var Sw=f(()=>{"use strict";s();de()});function AS(e){return B("BEGIN_PROCESSING_COMMIT",{},e)}var Iw=f(()=>{"use strict";s();de()});function kS(e){return B("BEGIN_PROCESSING_DISCARD",{},e)}var Ew=f(()=>{"use strict";s();de()});function DS(e){return B("BEGIN_VIEW_INIT",{},e)}var Pw=f(()=>{"use strict";s();de()});function wS(e,t){return B("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}var t8=f(()=>{"use strict";s();de()});function hC(e,t,r){return B("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:r},e)}var r8=f(()=>{"use strict";s();de()});function FS(e,t,r){return B("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:r},e)}var n8=f(()=>{"use strict";s();de()});function OS(e){return B("CANCEL_DISCARD",{},e)}var _w=f(()=>{"use strict";s();de()});function Lu(e,t,r){return B("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:r},e)}var Rw=f(()=>{"use strict";s();de()});function km(e){return B("CLEAR_COMMENT_SELECTION",{},e)}var Aw=f(()=>{"use strict";s();de()});function NS(e){return B("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}var o8=f(()=>{"use strict";s();de()});function MS(e,t){return B("CLEAR_POST_ERROR_STATE",{commentId:t},e)}var i8=f(()=>{"use strict";s();de()});function Dm(e,t){return B("COLLAPSE_CARD",{cardId:t},e)}var a8=f(()=>{"use strict";s();de()});function LS(e,t){return B("COMMENT_CONTEXT_CHANGED",t,e)}var s8=f(()=>{"use strict";s();de()});function wm(e,t){return B("COMMIT_DRAFT",t,e)}function HS(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}var kw=f(()=>{"use strict";s();de()});function pf(e,t){return B("COMMIT_FAILURE",{commitText:t},e)}var Dw=f(()=>{"use strict";s();de()});function BS(e,t){return B("DISPATCH_LOAD_THREADS",t,e)}var d8=f(()=>{"use strict";s();de()});function Ua(e,t){return B("DISPLAY_DRAFT_WARNING",e,t)}var US=f(()=>{"use strict";s();de()});function VS(e,t,r){return B("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:r},e)}var c8=f(()=>{"use strict";s();de()});var ww,A,Be=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"})(ww||(ww={}));A=ww});function Fw(e){return B("",{},e)}var Kn,Fm=f(()=>{"use strict";s();te();Z();Be();de();Kn=Fw({renderContextType:A.None,telemetryVisitor:Ct(ft.ReviewedAsNotNecessary),trackback:C.reserveTag(595735680)})});function yC(e){return B("END_VIEW_INIT",{},e)}var Ow=f(()=>{"use strict";s();de()});function wc(e,t,r){return B("HIGHLIGHT_COMMENT",{commentId:t,actionSource:r},e)}var Nw=f(()=>{"use strict";s();de()});function jS(e,t,r){return B("LOAD_COMMENT",{commentData:t,tasks:r},e)}var Mw=f(()=>{"use strict";s();de()});function WS(e,t){return B("LOAD_DEFAULT_FILTER",t,e)}var u8=f(()=>{"use strict";s();de()});function mf(e,t){return B("LOAD_FILTER",t,e)}var l8=f(()=>{"use strict";s();de()});function CC(e,t){return B("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}var Lw=f(()=>{"use strict";s();de()});function zS(e,t){return B("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}var Hw=f(()=>{"use strict";s();de()});function GS(e,t){return B("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}var f8=f(()=>{"use strict";s();de()});function qS(e,t){return B("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}var p8=f(()=>{"use strict";s();de()});function KS(e,t){return B("ON_INITIAL_RENDER",t,e)}var m8=f(()=>{"use strict";s();de()});function YS(e,t){return B("POPULATE_SMART_REPLY",t,e)}var g8=f(()=>{"use strict";s();de()});function $S(e,t){return B("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}var h8=f(()=>{"use strict";s();de()});function vC(e,t){return B("QUEUE_LOAD_THREADS",t,e)}var y8=f(()=>{"use strict";s();de()});function QS(e){return B("READY_TO_RENDER",{},e)}var C8=f(()=>{"use strict";s();de()});function Om(e,t){return B("RELOAD_COMMENTS",t,e)}var Bw=f(()=>{"use strict";s();de()});function XS(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return B("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}var v8=f(()=>{"use strict";s();de()});function Hu(e){return B("REQUEST_CLOSE_PANE",{},e)}var x8=f(()=>{"use strict";s();de()});function JS(e,t){return B("REQUEST_DELETE_POST",{commentId:t},e)}var T8=f(()=>{"use strict";s();de()});function Nm(e,t,r){return B("REQUEST_DELETE_THREAD",{commentId:t,isTask:r},e)}var b8=f(()=>{"use strict";s();de()});function ZS(e,t,r,n){return B("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:r,displayStrings:n},e)}var S8=f(()=>{"use strict";s();de()});function eI(e,t,r){return B("REQUEST_REOPEN_THREAD",{commentId:t,isTask:r},e)}var I8=f(()=>{"use strict";s();de()});function tI(e){return B("REQUEST_SHOW_PANE",{},e)}var E8=f(()=>{"use strict";s();de()});function rI(e,t,r){return B("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:r},e)}var P8=f(()=>{"use strict";s();de()});function xC(e,t){return B("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}var Uw=f(()=>{"use strict";s();de()});function Mm(e,t){return B("SAVE_DRAFT",t,e)}var Vw=f(()=>{"use strict";s();de()});function Lm(e){switch(e){case Ee.SelectCard:case Ee.Polite:return!1;case Ee.ExpandCard:case Ee.SelectPost:return!0}}function yn(e,t,r,n,o){return B("SELECT_COMMENT",{selectedCard:t,selectedPost:r,selectType:n,source:o},e)}var Ee,Fc=f(()=>{"use strict";s();de();(function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"})(Ee||(Ee={}))});function nI(e,t,r,n,o,a,d){return B("SELECT_CONTENT",{selectDirection:t,from:a,reason:d,iterableContentTypes:r,restrictToCurrentContext:n,preventLooping:o},e)}var _8=f(()=>{"use strict";s();de()});function oI(e){return B("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}var R8=f(()=>{"use strict";s();de()});function iI(e){return B("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var A8=f(()=>{"use strict";s();de()});function aI(e,t,r){return B("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:r},e)}var jw=f(()=>{"use strict";s();de()});function sI(e,t){return B("SET_COLLABORATORS",t,e)}var k8=f(()=>{"use strict";s();de()});function dI(e,t){return B("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}var D8=f(()=>{"use strict";s();de()});function cI(e,t){return B("SET_FILTERING_CAPABILITIES",t,e)}var w8=f(()=>{"use strict";s();de()});function Bu(e,t,r){return B("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:r},e)}var Ww=f(()=>{"use strict";s();de()});function uI(e,t){return B("SHOW_POST_ERROR_STATE",{commentId:t},e)}var F8=f(()=>{"use strict";s();de()});function lI(e){return B("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}var O8=f(()=>{"use strict";s();de()});function fI(e,t){return B("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}var zw=f(()=>{"use strict";s();de()});function pI(e,t){return B("UPDATE_COLLABORATORS",t,e)}var N8=f(()=>{"use strict";s();de()});function mI(e,t){return B("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}var Gw=f(()=>{"use strict";s();de()});function TC(e,t,r){return B("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:r},e)}var M8=f(()=>{"use strict";s();de()});function gI(e,t){return B("UPDATE_DRAFT_THREAD",t,e)}var L8=f(()=>{"use strict";s();de()});function hI(e,t){return B("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}var H8=f(()=>{"use strict";s();de()});function gf(e,t){return B("UPDATE_FILTER_RANGE",t,e)}var B8=f(()=>{"use strict";s();de()});function yI(e,t){return B("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}var U8=f(()=>{"use strict";s();de()});function CI(e,t,r){return B("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:r},e)}var V8=f(()=>{"use strict";s();de()});function vI(e,t){return B("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}var j8=f(()=>{"use strict";s();de()});function xI(e,t){return B("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var W8=f(()=>{"use strict";s();de()});function Hm(e,t){return B("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}var qw=f(()=>{"use strict";s();de()});function TI(e,t){return B("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}var z8=f(()=>{"use strict";s();de()});function bI(e,t){return B("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}var G8=f(()=>{"use strict";s();de()});function SI(e,t){return B("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}var q8=f(()=>{"use strict";s();de()});var Id={};_y(Id,{EMPTY_ACTION:()=>Kn,SelectActionType:()=>Ee,activeFilterUpdated:()=>IS,addContentExtension:()=>ES,addToCurrentMentionees:()=>PS,applyCommentChanges:()=>Am,beginDraftingFailure:()=>_S,beginDraftingSuccess:()=>RS,beginProcessingCommit:()=>AS,beginProcessingDiscard:()=>kS,beginViewInitialization:()=>DS,cancelCommentCreateThread:()=>wS,cancelCommentPostEdit:()=>hC,cancelCommentReply:()=>FS,cancelDiscard:()=>OS,chainActionDetails:()=>It,clearCommentHighlight:()=>Lu,clearCommentSelection:()=>km,clearLowFidelityWarning:()=>NS,clearPostErrorUI:()=>MS,collapseCard:()=>Dm,commentContextChanged:()=>LS,commitDraft:()=>wm,commitFailure:()=>pf,createAction:()=>B,dispatchLoadThreads:()=>BS,displayDraftWarning:()=>Ua,draftEmptinessChanged:()=>VS,emptyAction:()=>Fw,endViewInitialization:()=>yC,getCommitDraftSessionType:()=>HS,highlightComment:()=>wc,loadComment:()=>jS,loadDefaultFilter_deprecated:()=>WS,loadFilter:()=>mf,loadPersonaIconProperties:()=>CC,loadVirtualizedComments:()=>zS,moveFocusToCanvas:()=>GS,nextPopulatedContextDetailsUpdated:()=>qS,onInitialRender:()=>KS,populateSmartReply:()=>YS,queueLoadThreads:()=>vC,readyToRender:()=>QS,reloadComments:()=>Om,removeContentExtensions:()=>XS,requestClosePane:()=>Hu,requestDeletePost:()=>JS,requestDeleteThread:()=>Nm,requestModalConfirmation:()=>ZS,requestPresentLinkToComment:()=>$S,requestReopenThread:()=>eI,requestShowPane:()=>tI,requestThreadResolve:()=>rI,resolveAtMentionCapability:()=>xC,saveDraft:()=>Mm,selectComment:()=>yn,selectContent:()=>nI,selectFirstThreadInNextCommentContext:()=>oI,selectLastThreadInPreviousCommentContext:()=>iI,sessionRequestStartedAndLockSelection:()=>aI,setCollaborators:()=>sI,setContentNavigationEnablement:()=>dI,setFilteringCapabilities:()=>cI,shouldSelectActionExpandCard:()=>Lm,showLowFidelityWarning:()=>Bu,showPostErrorUI:()=>uI,toggleTaskAssigner:()=>lI,topVisibleThreadChanged:()=>fI,updateCollaborators:()=>pI,updateContextState:()=>mI,updateDraftRenderContext:()=>TC,updateDraftThread:()=>gI,updateExtensionPriority:()=>hI,updateFilterRange:()=>gf,updateMentioneesStillInDraft:()=>yI,updateModelCapabilities:()=>CI,updateSelectedTaskAssignee:()=>vI,updateSelectedTaskAssignees:()=>xI,updateSuggestionsDetails:()=>Hm,viewContainerChanged:()=>TI,viewContainerFoldableLayoutStateChanged:()=>bI,viewContainerVisibilityChanged:()=>SI});var Cr=f(()=>{"use strict";s();de();J6();Tw();Z6();e8();bw();Sw();Iw();Ew();Pw();t8();r8();n8();_w();Rw();Aw();o8();i8();a8();s8();kw();Dw();d8();US();c8();Fm();Ow();Nw();Mw();u8();l8();Lw();Hw();f8();p8();m8();g8();h8();y8();C8();Bw();v8();x8();T8();b8();S8();I8();E8();P8();Uw();Vw();Fc();_8();R8();A8();jw();k8();D8();w8();Ww();F8();O8();zw();N8();Gw();M8();L8();H8();B8();U8();V8();j8();W8();qw();z8();G8();q8()});var Kw,ce,un=f(()=>{"use strict";s();(function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"})(Kw||(Kw={}));ce=Kw});function hf(e){return e!==void 0&&(e.commentFlags&Fe.Resolved)!==0}function K8(e){return e!==ce.Canvas}function Y8(e){return Lm(e)}function II(e,t){e.addDataField("IsCommentResolved",t,N.SystemMetadata)}var Yw=f(()=>{"use strict";s();Z();Dc();Cr();un()});function EI(e){return ir()}function fi(e){return ir()}function nr(e){return ir()||e.length===0||typeof e[0]=="string"}function Jr(e){return ir()}function Oc(e){return Jr(e)?e.postData:e.commentData}function Mr(e,t){return fi(e)?e[t]:e.find(function(r){return r.commentId===t})}var mo=f(()=>{"use strict";s();ue()});var PI,Uu,_I=f(()=>{"use strict";s();Yw();mo();Au();PI=function(){function e(t,r,n){this.threadIds=t,this.commentData=r,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,t.length))}return e.prototype.next=function(){var t=this.pointer,r=this.threadIds.length-1;if(this.pointer<r)do++this.pointer;while(this.pointer<=r&&hf(Mr(this.commentData,this.threadIds[this.pointer])));return this.pointer<r||this.pointer===r&&t<r?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var t=this.pointer;if(this.pointer>0)do--this.pointer;while(this.pointer>=0&&hf(Mr(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Uu=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.model=t,this.startThreadIndex=r,this.pointer=0,this.ignoreResolvedThreads=!1,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var t=this.pointer;if(this.pointer<this.model.length-1)do++this.pointer;while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&Fe.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer;if(this.pointer>0)do--this.pointer;while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&Fe.Resolved));return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()});var go,bC=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"})(go||(go={}))});function RI(e){return e.sessionType===fo}function Nc(e){return e.sessionType===Ko&&e.threadId!==void 0}function Va(e){return e.sessionType===aa&&e.commentId!==void 0}function Q8(e){return RI(e)?go.InitCreateCommentSession:Nc(e)?go.InitReplyCommentSession:Va(e)?go.InitEditCommentSession:go.Unknown}var Bm,$8,yf=f(()=>{"use strict";s();bC();sf();xd();Bm={CREATE:0,REPLY:1,EDIT:2,METADATA:3},$8={CREATE:tt.Insert,REPLY:tt.Insert,EDIT:tt.Modify,METADATA:tt.Modify}});function Cf(){return AI||(AI=new pxe,AI)}var AI,pxe,kI=f(()=>{"use strict";s();pxe=function(){function e(){}return e.prototype.getItem=function(t){return null},e.prototype.setItem=function(t,r){},e.prototype.removeItem=function(t){},e.prototype.storeEditorContentFromDraftSave=function(t,r){},e}()});var vt,Mi=f(()=>{"use strict";s();(function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"})(vt||(vt={}))});var Lr,Vu=f(()=>{"use strict";s();(function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"})(Lr||(Lr={}))});var Ed,J8=f(()=>{"use strict";s();(function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"})(Ed||(Ed={}))});var vf,Pd,Z8=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"})(vf||(vf={}));(function(e){e[e.Unknown=0]="Unknown",e[e.RuntimeTeardown=1]="RuntimeTeardown",e[e.RangeObsolete=2]="RangeObsolete"})(Pd||(Pd={}))});var Qe,ej=f(()=>{"use strict";s();(function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"})(Qe||(Qe={}))});var tj=f(()=>{"use strict";s();ej()});var $w=f(()=>{"use strict";s();J8();Z8();tj()});var rj,mxe,Li,nj=f(()=>{"use strict";s();rj=I(_t()),mxe={ContentFilteredRangeModule:["SDX::ContentFilteredRange::ContentFilteredRangeModule",{getFilteredRange:["ReturnsPromiseMethod","SDX::ContentFilteredRange::GetFilteredRangeResult",["$string","SDX::ContentFilteredRange::GetFilteredRangeArgs"]],teardownFilteredRange:["FireAndForgetMethod",["$string","$string"]],updateFilterForFilteredRangeId:["ReturnsPromiseMethod","$any",["$string","$string","SDX::ContentFilteredRange::HostFilter"]],getExistingFilteredRange:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::GetFilteredRangeResult"],["$string","$string"]],setActiveFilteredRange:["ReturnsPromiseMethod","$any",["$string",["$optional","$string"]]],getActiveFilteredRangeId:["ReturnsPromiseMethod",["$optional","$string"],["$string"]],getFilterUsers:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::IUser"],["$string"]],getCapabilities:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::CapabilitiesResult"],["$string"]],getHostSpecificLabels:["ReturnsPromiseMethod","SDX::ContentFilteredRange::HostLabelsResult",["$string"]],onFilteredRangeUpdated:["Event","SDX::ContentFilteredRange::ModuleFilteredRangeUpdatedArgs"],onUserFilterManagerEvent:["Event","SDX::ContentFilteredRange::ModuleUserFilterManagerEventArgs"],onActiveFilterUpdated:["Event","SDX::ContentFilteredRange::ModuleActiveFilterUpdatedEventArgs"]}]},Li={ContentFilteredRangeModule:rj.RekaServiceRegistry.getNativeService(mxe.ContentFilteredRangeModule)}});var DI,SC,oj=f(()=>{"use strict";s();te();Z();DI=I(_t());nj();SC=function(){function e(t){var r=this;if(this.apiContext=t,this.onFilteredRangeUpdated=new DI.EventImpl(function(){}),this.onActiveFilterUpdated=new DI.EventImpl(function(){}),this.onUserFilterManagerEvent=new DI.EventImpl(function(){}),this.onModuleFilteredRangeEventReceived=function(n){n.apiContext===r.apiContext&&r.onFilteredRangeUpdated.trigger(n)},this.onModuleUserFilterManagerEventReceived=function(n){n.apiContext===r.apiContext&&r.onUserFilterManagerEvent.trigger(n.payload)},this.onModuleActiveFilterUpdatedReceived=function(n){n.apiContext===r.apiContext&&r.onActiveFilterUpdated.trigger(n.payload)},!Li.ContentFilteredRangeModule)throw new Error("NativeService not available for ContentFilteredRangeHostAPI");Li.ContentFilteredRangeModule.onFilteredRangeUpdated.subscribe(this.onModuleFilteredRangeEventReceived),Li.ContentFilteredRangeModule.onActiveFilterUpdated.subscribe(this.onModuleActiveFilterUpdatedReceived),Li.ContentFilteredRangeModule.onUserFilterManagerEvent.subscribe(this.onModuleUserFilterManagerEventReceived)}return e.prototype.getFilteredRange=function(t){return Li.ContentFilteredRangeModule.getFilteredRange(this.apiContext,t)},e.prototype.teardownFilteredRange=function(t){Li.ContentFilteredRangeModule.teardownFilteredRange(this.apiContext,t)},e.prototype.getExistingFilteredRange=function(t){return Li.ContentFilteredRangeModule.getExistingFilteredRange(this.apiContext,t)},e.prototype.updateFilterForFilteredRangeId=function(t,r){Li.ContentFilteredRangeModule.updateFilterForFilteredRangeId(this.apiContext,t,r).catch(function(n){return v().assertConditionTag(!1,"Native module call failed with error ".concat(so(n)),537743712)})},e.prototype.setActiveFilteredRange=function(t){Li.ContentFilteredRangeModule.setActiveFilteredRange(this.apiContext,t).catch(function(r){return v().assertConditionTag(!1,"Native module call failed with error ".concat(so(r)),537743713)})},e.prototype.getActiveFilteredRangeId=function(){return Li.ContentFilteredRangeModule.getActiveFilteredRangeId(this.apiContext)},e.prototype.getCapabilities=function(){return Li.ContentFilteredRangeModule.getCapabilities(this.apiContext)},e.prototype.getHostSpecificLabels=function(){return Li.ContentFilteredRangeModule.getHostSpecificLabels(this.apiContext)},e.prototype.getFilterUsers=function(){return Li.ContentFilteredRangeModule.getFilterUsers(this.apiContext)},e}()});var ij=f(()=>{"use strict";s();oj()});var aj=f(()=>{"use strict";s();$w();ij()});var sj,Qw,dj=f(()=>{"use strict";s();k();Z();sj=I(_t());$w();Qw=function(){function e(t,r,n,o,a,d){this.id=t,this.filter=r,this.order=n,this.hostAPI=o,this.supportsUpdates=a,this.onTeardown=d,this.active=!0,this.onRangeUpdated=new sj.EventImpl(function(){})}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(t){return this.supportsUpdates?(this.filter=t,this.hostAPI.updateFilterForFilteredRangeId(this.id,m({},t)),!0):!1},e.prototype.onChangeEventReceived=function(t){if(this.active){for(var r=0,n=t.changes;r<n.length;r++){var o=n[r];if(this.active)switch(o.type){case"FilterUpdate":{this.filter=o.updatedFilter;break}case"Insert":this.order=w(w(w([],this.order.slice(0,o.index),!0),[o.content],!1),this.order.slice(o.index),!0);break;case"Remove":this.order=w(w([],this.order.slice(0,o.index),!0),this.order.slice(o.index+1),!0);break;case"Reload":{this.order=o.fullContent,v().assertConditionTag(o.reason===vf.DivergentChange,"Received a full reload for an error reason.",537743690);break}case"Teardown":{this.active=!1;break}}}this.onRangeUpdated.trigger(t)}},e}()});var cj,uj=f(()=>{"use strict";s();k();te();cj=function(){function e(t){var r=this;this.hostApi=t,this.getFilterUsers=function(){return r.cachedUsers!==void 0?Promise.resolve(r.cachedUsers):r.hostApi.getFilterUsers().then(function(n){return r.cachedUsers=n,n})},this.onUserFilterManagerEventReceived=function(n){if(r.cachedUsers){var o=n.payload.type;switch(o){case"UserAdded":r.cachedUsers=w(w([],r.cachedUsers,!0),[n.payload.user],!1);break;case"UserRemoved":r.cachedUsers=r.cachedUsers.filter(function(a){return a.Provider!==n.payload.user.Provider||a.UserId!==n.payload.user.UserId});break;default:Ne(o)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)}return e}()});var lj,fj=f(()=>{"use strict";s();dj();uj();lj=function(){function e(t){var r=this;this.contentFilteredRangeHostAPI=t,this.filteredRanges=new Map,this.createFilteredRange=function(n){return r.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:n.contentTypes,hostFilter:n.filters,supportsFilterUpdates:n.supportsFilterUpdates}).then(function(o){var a=o.filterId,d=new Qw(a,o.filter,o.content,r.contentFilteredRangeHostAPI,o.supportsFilterUpdates,function(){return r.onFilterTearDown(a)});return r.filteredRanges.set(a,d),d})},this.getFilteredRange=function(n){return r.filteredRanges.has(n)?Promise.resolve(r.filteredRanges.get(n)):r.contentFilteredRangeHostAPI.getExistingFilteredRange(n).then(function(o){if(o){var a=new Qw(o.filterId,o.filter,o.content,r.contentFilteredRangeHostAPI,o.supportsFilterUpdates,function(){return r.onFilterTearDown(n)});return r.filteredRanges.has(n)||r.filteredRanges.set(n,a),a}})},this.setActiveFilteredRange=function(n){r.contentFilteredRangeHostAPI.setActiveFilteredRange(n)},this.getActiveFilteredRangeId=function(){return r.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(n){var o=r.filteredRanges.get(n.filterId);o&&o.onChangeEventReceived(n.payload)},this.onFilterTearDown=function(n){r.filteredRanges.delete(n)},this.getCapabilities=function(){return r.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return r.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return r.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new cj(t)}return e}()});function pj(){return!1}var mj=f(()=>{"use strict";s()});function IC(e,t){v().assertConditionTag(!pj()||e===Cd,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var r=wI.get(e);r||(r=new Ql("ContentFilteredRange"),wI.set(e,r)),r.injectInstance(new lj(t))}function FI(e){var t=wI.get(e);if(!t)throw new Ie("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),C.reserveTag(538035221));return t.getInstanceOrThrow()}function Um(e){var t;return((t=wI.get(e))===null||t===void 0?void 0:t.getInstance())!==void 0}var wI,gj=f(()=>{"use strict";s();Ru();te();ib();Z();fj();mj();wI=new Map});var hj=f(()=>{"use strict";s();gj()});var OI,yj,Cj=f(()=>{"use strict";s();te();OI=I(_t()),yj=function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new Ie("Method not implemented.",C.reserveTag(537421141))},this.getExistingFilteredRange=function(t){throw new Ie("Method not implemented.",C.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(t,r){throw new Ie("Method not implemented.",C.reserveTag(537421143))},this.setActiveFilteredRange=function(t){throw new Ie("Method not implemented.",C.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new Ie("Method not implemented.",C.reserveTag(537421145))},this.onFilteredRangeUpdated=new OI.EventImpl(function(){}),this.onUserFilterManagerEvent=new OI.EventImpl(function(){}),this.onActiveFilterUpdated=new OI.EventImpl(function(){})}return e.prototype.getFilteredRange=function(t){throw new Ie("Method not implemented.",C.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(t){throw new Ie("Method not implemented.",C.reserveTag(537421139))},e.prototype.getOrder=function(t){throw new Ie("Method not implemented.",C.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new Ie("Method not implemented.",C.reserveTag(537421146))},e}()});var vj=f(()=>{"use strict";s();Cj()});var _d=f(()=>{"use strict";s();aj();hj();vj()});var Hr,xf=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"})(Hr||(Hr={}))});function Tf(e){return e.selectionDetails.lowFidelityWarningType===Bt.Edit}function Vm(e){return e.selectionDetails.lowFidelityWarningType===Bt.DeleteReply}function EC(e){return e.selectionDetails.lowFidelityWarningType===Bt.DeleteThread}function Xw(e){return Vm(e)||EC(e)}function jm(e){return!!e&&(Tf(e)||Vm(e))}function Rs(e){return!!e&&(Xw(e)||Tf(e))}function Xe(e){return e.selectedPostId!==void 0}function pi(e){return Xe(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function Jw(e,t){return!!t&&Xe(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&Rs(t)}var Bt,ho=f(()=>{"use strict";s();(function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"})(Bt||(Bt={}))});var Zw,xe,bf=f(()=>{"use strict";s();(function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"})(Zw||(Zw={}));xe=Zw});var cr,Rd=f(()=>{"use strict";s();(function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"})(cr||(cr={}))});var eF,ur,Wm=f(()=>{"use strict";s();(function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"})(eF||(eF={}));ur=eF});var xj=f(()=>{"use strict";s()});function Tj(e,t,r){var n=le(),o=r&&n?t-1:t-2;if(o<1)throw new he(s5,C.reserveTag(589103692),-2130957559);return o===1?n?e.getString(106):e.getString(9):n?e.formatString(107,String(o)):e.formatString(10,String(o))}function bj(e,t){switch(t){case jt.AtFinishNextCommentIsFirst:return e.getString(8);case jt.AtStartNextCommentIsFirst:return e.getString(6);case jt.MoreCommentsUpcoming:case jt.DocumentHasComments:return e.getString(7);case jt.OnlyCommentsInCurrent:case jt.NoComments:case jt.Unknown:return"";default:Ne(t)}}function Sj(e,t,r){if(t===jt.NoComments)return e.getString(13);if(r===A.HalfPane)return e.getString(228)}function Ij(e,t,r,n){return r?t?e.getString(16):e.getString(17):Pn()&&n!==void 0&&n!==cr.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function NI(e,t){switch(t){case Hr.ReturnToDraft:return e.getString(110);case Hr.GrantAccessFailedSilently:return e.getString(134);case Hr.GrantAccessCanceled:return e.getString(234);case Hr.CommitFailed:return e.getString(135);case Hr.None:return v().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function Ej(e,t){return t===void 0&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function Pj(e,t){return t?Tf(t)?e.getString(35):Vm(t)?e.getString(36):"":""}function _j(e,t){var r=!!t&&tF();try{if(r){var n={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,n)}return v().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(tF(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(o){return v().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(o instanceof Error?o.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(tF(),", Date: ").concat(e.toString()),595953050),""}}function Rj(e,t){switch(t){case ur.DeleteThread:return hxe(e);case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:case ur.ClosePaneDraft:return yxe(e)}}function hxe(e){return{title:e.getString(75),confirmButton:e.getString(77),cancelButton:e.getString(78)}}function yxe(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function Aj(e,t){var r={loading:t.loading||e.getString(94),error:t.error||e.getString(95),limitedResults:t.limitedResults||e.getString(96),emptyResults:t.emptyResults||e.getString(93),allResults:t.allResults||e.getString(253),atMentionsModePlaceholderText:t.atMentionsModePlaceholderText||"",pickerModePlaceholderText:t.pickerModePlaceholderText||"",suggestionsAnnouncement:t.suggestionsAnnouncement||e.getString(97),useThisAddress:t.useThisAddress||"",selectedSuggestionAccessibilityLabel:t.selectedSuggestionAccessibilityLabel||e.getStringOrUndefined(198)||"",selectedSuggestionNumberAccessibilityLabel:t.selectedSuggestionNumberAccessibilityLabel||e.getStringOrUndefined(199)||"",suggestionsAvailableAnnouncement:t.suggestionsAvailableAnnouncement||""};return r}function kj(e){return e.getString(122)}function Cxe(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Nr(e))}function Dj(e,t){return e.length===0?rF(t):e.length===1?Cxe(e[0],t):xS(e)?t.getString(250):t.getString(251)}function wj(e,t,r){if(e.length===0)return nF(t,r);var n=e.map(function(o){return Nr(o)}).join(", ");return t?r.formatString(130,n):r.formatString(129,n)}function rF(e){return e.formatString(111,e.getString(133))}function nF(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function Fj(e,t,r,n){var o,a=t===xe.Draft||t===xe.DraftPreCommitPending;return(o=LI(e,r,n))!==null&&o!==void 0?o:a?e.getString(173):e.getString(174)}function MI(e,t,r){var n="";switch(r.length){case 0:{n=e.getString(133);break}case 1:{n=r[0];break}case 2:{n=e.formatString(242,r[0],r[1]);break}case 3:{n=e.formatString(243,r[0],r[1],r[2]);break}default:{n=e.formatString(244,r[0],(r.length-1).toString());break}}var o=t?114:252;return e.formatString(o,n)}function LI(e,t,r){var n=Du(r);if(n)return e.formatString(t?179:178,n)}function Oj(e,t){return e?t.getString(176):t.getString(126)}function Nj(e,t){return e.length===0?t.getString(181):t.formatString(114,e.map(function(r){return Nr(r)}).join(", "))}function Mj(e,t){switch(t){case Qe.ActiveOnly:return e.getString(247);case Qe.ResolvedOnly:return e.getString(246);case Qe.All:return e.getString(245);default:Ne(t)}}function HI(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}function Lj(e,t){switch(t){case 0:return e.getString(254);default:return e.formatString(267,t.toString())}}function Hj(e){return e>0?"".concat(e):void 0}var tF,mi=f(()=>{"use strict";s();_d();te();rt();Z();Pc();hn();tr();vs();ue();xf();ho();bf();Rd();Wm();Be();xj();tF=et(function(){try{new Date().toLocaleDateString("i")}catch(e){return e instanceof Error&&e.name==="RangeError"}return!1})});var Bj,Uj,Vj,jj,Wj,zj,Gj,BI,qj=f(()=>{"use strict";s();Bj="SharedComments_Pane_ThreadAnnotation_Id:(.*)_Context:(.*)",Uj="SharedComments_Pane_DraftThreadAnnotation_Id:(.*)_Context:(.*)",Vj="SharedComments_DHCIsolated_ThreadAnnotation_Id:(.*)_Context:(.*)",jj="SharedComments_DHCIsolated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",Wj="SharedComments_DHCIntegrated_ThreadAnnotation_Id:(.*)_Context:(.*)",zj="SharedComments_DHCIntegrated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",Gj="unk://SharedCommentsCanvas/(.*)",BI="(.*)"});function Zr(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function UI(e){return"cardEditor".concat(Zr(e))}function VI(e){return"postEditor".concat(Zr(e))}function jI(e){return"postRoot".concat(Zr(e))}function If(e,t){return t?"draftCardRoot".concat(Zr(e)):"cardRoot".concat(Zr(e))}function PC(){return"GhostCard"}function Kj(e){return"sendReplyButton".concat(Zr(e))}function Yj(e){return"cancelReplyButton".concat(Zr(e))}function $j(e){return"cardContextMenu".concat(Zr(e))}function Qj(e){return"cardRootEditButton".concat(Zr(e))}function oF(e){return"postContextMenu".concat(Zr(e))}function iF(e){return"postEditButton".concat(Zr(e))}function Xj(e){return"renderableItemList".concat(Zr(e))}function Jj(e,t){return"actionBarButton_".concat(t).concat(Zr(e))}function _C(e){return"editorFocusContainer_".concat(e)}function WI(e){return"draftCancelButton".concat(Zr(e))}function Zj(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function eW(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function tW(e){return"viewMoreReply".concat(Zr(e))}function zI(e){return"postTimeStamp".concat(Zr(e))}function GI(e,t){return"".concat(t.replace(/\s/g,"")).concat(Zr(e))}function RC(){return"CommentsListScrollView"}function rW(){return"CommentsList"}function nW(){return"CardListWrapper"}function oW(){return"CardList"}function zm(){return"EmptyCreatedCommentLie"}function iW(){return"NewCommentButton"}function Gm(e){return"draftWarning".concat(Zr(e))}function qm(e){return"postingTip".concat(Zr(e),";")}function aW(){return"confirm-low-fidelity"}function sW(){return"cancel-low-fidelity"}function dW(){return"next-thread-button"}function cW(){return"previous-thread-button"}function uW(e){return"loadingPlaceholder".concat(Zr(e))}function Km(e){return"persona".concat(Zr(e))}function lW(e){return"DiscreteHostedCommentRoot".concat(Zr(e))}function fW(){return"CommentPaneE026E6C3-C737-4F07-86EA-711651051DBC"}function pW(e,t,r,n){var o;switch(e){case A.DiscreteIntegrated:o=n?zj:Wj;break;case A.DiscreteIsolated:o=n?jj:Vj;break;case A.FullPane:case A.HalfPane:o=n?Uj:Bj;break;case A.None:return v().assertConditionTag(!1,"Unexpected render context type: ".concat(e),590995920),"";default:Ne(e)}return o.replace(BI,r).replace(BI,t)}function mW(e){return Gj.replace(BI,e)}function qI(){return"ReopenThread"}function gW(){return"8342575e-c7c7-4a18-825e-c7ab2c78a0c3"}function hW(){return"lppSuggestionListId"}function yW(e){return"reactionButtonUserList_".concat(e)}function CW(e,t){return"".concat(e,"_").concat(t)}function vW(e){return"commentReactionButton".concat(Zr(e))}function Ef(){return"AtMentionMeFilter"}function xW(){return"ActiveStatusFilter"}function TW(){return"ResolvedStatusFilter"}function bW(){return"commentPaneFilterButtonId"}function KI(){return"commentPaneFilterCountId"}var Er=f(()=>{"use strict";s();te();Z();qj();Be()});function ju(e){var t=JSON.parse(e);return vxe(t)}function vxe(e){return e.ops?e.ops.map(function(t){return t.insert}).join(""):""}var aF,SW,kC=f(()=>{"use strict";s();te();tr();aF=function(){function e(){this.ops=[]}return e.prototype.insert=function(t,r,n){return this.ops.push({insert:t,attributes:r,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(SW||(SW={}))});function IW(e){return e===xxe||e===Ad}var Ad,xxe,DC=f(()=>{"use strict";s();kC();Ad=new aF().insert("").toJSON(),xxe=new aF().toJSON()});function $t(e){return e===A.FullPane||e===A.HalfPane}function YI(e){return e===A.DiscreteIntegrated||e===A.DiscreteIsolated}function EW(e,t){return e===t?!1:$t(e)&&$t(t)}var gi=f(()=>{"use strict";s();Be()});var pt,Wu=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"})(pt||(pt={}))});function sF(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function wC(e){return Object.keys(e.drafts)}function zu(e){var t=0;for(var r in e.drafts)e.drafts.hasOwnProperty(r)&&++t;return t}function Ym(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function Yo(e){return zu(e)>0}function lr(e){return Yo(e)||dF(e)}function As(e){return nt()?!1:lr(e)}function dF(e){return e.pendingDraft!==void 0}function cF(e,t){var r,n;try{for(var o=qe(wC(e)),a=o.next();!a.done;a=o.next()){var d=a.value;if(e.drafts[d].pendingState===t)return!0}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}function $o(e){return cF(e,Hi.None)}function hi(e){return cF(e,Hi.Commit)}function FC(e){return cF(e,Hi.Discard)}function $I(e,t){return FC(e)&&$o(t)}var Hi,Rn=f(()=>{"use strict";s();k();ue();(function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"})(Hi||(Hi={}))});var st,Pf=f(()=>{"use strict";s();(function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"})(st||(st={}))});function PW(e){return e.pending!==void 0||e.displayingErrorUI!==void 0}var qr,$m=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"})(qr||(qr={}))});function ja(e,t,r,n,o){if(r!==-1&&zu(t)<zu(e)){var a=v().createActivityObject("SilentDraftDiscard",Ct(ft.GlobalAPI),be());a.addDataField("DiscardReason",r??0,N.SystemMetadata),a.addDataField("Source",n,N.SystemMetadata),a.successTag(o)}}function _W(e){if(H5()){var t=v().createActivityObject("MarkCommentCreation",e,be());t.addDocumentMetadata(wi.Basic),t.successTag(591152859)}}var OC=f(()=>{"use strict";s();Z();ue();Rn()});function Gu(e,t,r){return e?!t||r||e.numberOfLoadedComments===0?!1:e.selectedThreadIndex===void 0?!0:e.selectedThreadIndex<e.numberOfLoadedThreads:!0}var NC=f(()=>{"use strict";s()});function uF(e){return e===""||e===null?void 0:e}function Wa(e,t){if(!e[t])return e;var r=m({},e);return delete r[t],r}function lF(e,t,r){var n=r!==void 0&&e[r]===t?r:-1;if(n<0&&(n=e.findIndex(function(a){return a===t})),n<0)return e;var o=w([],j(e),!1);return o.splice(n,1),o}function qu(e){return e.state===st.Placeholder||e.state===st.Loading}function Qm(e,t,r){var n,o;return fi(e)?(o=(n=t[r])===null||n===void 0?void 0:n.map(function(a){return e[a]}))!==null&&o!==void 0?o:[]:e.filter(function(a){return $e(a)===r})}function QI(e){return{commentId:e,commentBody:Ad,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function Xm(e,t,r,n){if(r<0)return-1;for(var o=0,a=-1,d=0;d<e.length;d++){if(e[d]===n){a=d;continue}if(o===r)return d;if(o>r)return a===d-1?d-2:d-1;o+=t[e[d]].length}return o===r?e.length:-1}function bxe(e,t){var r=t?Jr(t)?{commentThreadIds:w([],j(t.commentThreadIds),!1),cardPostIds:m({},t.cardPostIds),postData:m({},t.postData)}:{commentData:w(w([],j(t.commentData),!1),j(e),!1)}:ir()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!EI(r))return r;var n=void 0;return e.forEach(function(o){if(yr(o))r.commentThreadIds.push(o.commentId),r.cardPostIds[o.commentId]=[o.commentId],n=o.commentId;else if(n===o.parentId)r.cardPostIds[o.parentId].push(o.commentId);else if(r.cardPostIds[o.parentId])r.cardPostIds[o.parentId]=w(w([],j(r.cardPostIds[o.parentId]),!1),[o.commentId],!1),n=o.parentId;else{v().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);return}r.postData[o.commentId]=o}),r}function MC(e,t,r){for(var n={},o=0;o<e.length;++o)n[e[o].commentId]=za(!ir()&&t.includes($e(e[o]))?ks(e[o].date,e[o].displayDate,r.dataCulture):e[o].displayDate);return n}function za(e){return{displayDate:e,displayingErrorUI:!1,pending:qr.None}}function RW(e){return{displayDate:e}}function ks(e,t,r){return t||(!e||isNaN(e.getDate())?"":_j(e,r))}function fF(e,t,r,n){for(var o,a=void 0,d=!1,c=0;c<r.length;c++){if($e(r[c])!==e){if(d)break;continue}d=!0,v().assertConditionTag(!!t[r[c].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=(o=t[r[c].commentId])!==null&&o!==void 0?o:za(void 0);u.displayDate||(a||(a=m({},t)),a[r[c].commentId]=m(m({},u),{displayDate:ks(r[c].date,r[c].displayDate,n.dataCulture)}))}return a}function AW(e,t,r,n){var o=void 0;return e.forEach(function(a){var d;if(r[a]){v().assertConditionTag(!!t[a],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var c=(d=t[a])!==null&&d!==void 0?d:za(void 0);c.displayDate||(o||(o=m({},t)),o[a]=m(m({},c),{displayDate:ks(r[a].date,r[a].displayDate,n.dataCulture)}))}}),o}function kW(e,t){for(var r={},n=0;n<e.length;++n)e[n].parentId===""&&(r[e[n].commentId]=Ds(void 0,t));return r}function Ds(e,t){var r=t===st.Loading||t===st.Placeholder?{state:t,initialItemCount:1}:{state:t??st.Loaded};return LC(e,r)}function DW(e){var t,r,n={};try{for(var o=qe(e),a=o.next();!a.done;a=o.next()){var d=a.value;n[d.threadId]=LC(void 0,{state:st.Placeholder,initialItemCount:d.itemCount})}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}function LC(e,t){return{loadState:t??{state:st.Loaded},pending:pt.None,alternateId:e}}function pF(e){var t={};return t[e]={pending:qr.Post,displayDate:void 0,displayingErrorUI:!1},t}function mF(e){var t={};return t[e]={pending:pt.Card,loadState:{state:st.Loaded},alternateId:e},t}function Ga(e,t,r){var n=sa(e,t,r),o=We(r);if(nf()){var a=o==null?void 0:o.commentDraft.sessionConfiguration;(a==null?void 0:a.sessionType)==="EDIT"&&o&&!n.some(function(d){return d===o.threadId})&&n.push(o.threadId)}return!t||n.includes(t.selectedCardId)?n:o&&o.threadId===t.selectedCardId?[o.threadId]:o&&n.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function Ku(e,t,r,n){if(!t.includes(e))return t;var o=We(r);return o&&o.threadId===e?t:n&&Xe(n.selectionDetails)?(v().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function sa(e,t,r){var n=We(r);return Dy(e,function(o){return o===(t==null?void 0:t.selectedCardId)||o===(n==null?void 0:n.threadId)})}function HC(e,t,r){var n=We(r);return Dy(e,function(o){return t[o]||o===(n==null?void 0:n.threadId)})}function An(e){return{selectedCardId:e,selectionDetails:BC()}}function BC(){return{lowFidelityWarningType:void 0}}function gF(e,t){var r,n=e.draftState.postIdToDraftIdMap[t];if(!n)return e.selectedComment;var o=e.draftState.drafts[n];if(!o.isInCurrentContext)return((r=e.selectedComment)===null||r===void 0?void 0:r.selectedCardId)===o.threadId?void 0:e.selectedComment;var a=Mr(Oc(e),t);if(!a)throw new he(i5,C.reserveTag(589103587),-2130957563);return An($e(a))}function Sxe(e,t){var r=Mr(e,t);if(r)return wW($e(r),t);throw new he(gm,C.reserveTag(589103616),-2130957556)}function wW(e,t){var r={selectedPostId:t,lowFidelityWarningType:void 0};return{selectedCardId:e,selectionDetails:r}}function Ixe(e,t){var r=Mr(e,t);if(r&&r.parentId==="")return An(t);throw new he(gm,C.reserveTag(589103617),-2130957556)}function hF(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return An(t.sessionConfiguration.draftId);case"EDIT":return Sxe(e,t.sessionConfiguration.commentId);case"REPLY":return Ixe(e,t.sessionConfiguration.threadId);default:throw new he(fd,C.reserveTag(589103618),-2130957532)}}function FW(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return An(e.threadId);case"EDIT":return wW(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new he(fd,C.reserveTag(577610274),-2130957532)}}function OW(e,t,r){return(t==null?void 0:t.selectedCardId)===e&&Xe(t.selectionDetails)&&!As(r)?An(e):t}function NW(e,t){var r=t.payload;return{selectedCardId:r.selectedCard,selectionDetails:Exe(e,r)}}function Exe(e,t){if(t.selectType===Ee.SelectPost)return e&&Xe(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0};var r=e&&!Xe(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0;return{lowFidelityWarningType:r}}function MW(e,t,r){var n,o=t.payload.params;return Nc(o)?An(r):Va(o)?{selectedCardId:r,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:An((n=e==null?void 0:e.selectedCardId)!==null&&n!==void 0?n:r)}function yF(e,t,r){if(r.type==="CLEAR_COMMENT_SELECTION")return!!t&&!As(e);if(!t)return!0;if(As(e))return r.payload.selectedCard===t.selectedCardId&&!Xe(t.selectionDetails)&&r.payload.selectType===Ee.ExpandCard;if(r.payload.selectedCard===t.selectedCardId)switch(r.payload.selectType){case Ee.SelectCard:return Xe(t.selectionDetails);case Ee.Polite:return!1;case Ee.SelectPost:case Ee.ExpandCard:return!0;default:Ne(r.payload)}return!0}function LW(e){var t={};return e.commentId&&(t[e.commentId]={pending:pt.None,loadState:{state:st.Loaded},alternateId:e.commentId}),t}function HW(e){var t={};return e.commentId&&(t[e.commentId]={pending:qr.None,displayDate:void 0,displayingErrorUI:!1}),t}function BW(e,t){return e&&e.selectedCardId===t.payload.commentId?An(t.payload.commentId):e}function Je(e,t,r){if(e.pendingDraft&&e.pendingDraft.sessionType==="CREATE")return zm();if(e.committedLieId)return e.committedLieId;var n=We(e);if(!(!n||n.commentDraft.sessionConfiguration.sessionType!=="CREATE")&&!(t&&!n.isInCurrentContext)&&!(r&&n.renderContextType!==r&&n.renderContextType!==A.None))return n.commentDraft.sessionConfiguration.draftId}function UW(e,t,r,n){var o=lF(e,r);if(o.length<e.length){var a=Xm(o,t,n.flatIndex);a>=0&&o.splice(a,0,r)}return o}function VW(e,t,r,n){if(!Je(n,!0))return e;var o=Je(n);if(!(!e||!o||!r[o]||r[o].pending!==pt.None)){var a=m({},e),d=t.length;if(a.flatIndex>=d)a.flatIndex=d;else if(a.flatIndex>=0&&t[a.flatIndex].parentId){var c=new Uu(t,a.flatIndex),u=c.next();u.done?a.flatIndex=d:a.flatIndex=c.currentIndex()}return a}}function jW(e,t,r){if(!t)return-1;var n=r?t.selectedCardId:pi(t);return e.findIndex(function(o){return o.commentId===n})}function WW(e,t){return nr(e)?t?e.findIndex(function(r){return r===t.selectedCardId}):-1:jW(e,t,!0)}function zW(e,t,r){if(fi(e)){if(!r||!t[r.selectedCardId])return-1;var n=pi(r);return t[r.selectedCardId].findIndex(function(o){return o===n})}return jW(e,r,!1)}function kd(e){if(!Yo(e))return Lr.NoDraft;if(!Pxe(e))return Lr.CannotAutoDiscard;var t=We(e);return t&&fC(t.commentDraft.sessionConfiguration)?Lr.CannotAutoDiscard:Lr.CanAutoDiscard}function Pxe(e){var t=qa(e),r=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(r!=null&&r.isDraftEmpty)}function GW(e,t){if(t===void 0)return v().assertConditionTag(Object.keys(e).length===0,"Invalid number of drafts.",593762516),e;var r=t.sessionConfiguration.draftId;return v().assertConditionTag(Object.keys(e).length===1,"Invalid number of drafts.",593762517),v().assertConditionTag(!!e[r],"Draft is not in map",593762518),nf()&&r&&Cf().removeItem(r),Wa(e,r)}function CF(e){return kd(e)===Lr.CanAutoDiscard?Ym():e}function vF(e,t,r,n,o,a){var d,c;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(d=e.pendingDraft.threadId,!t[d])return e;break;case"EDIT":if(c=e.pendingDraft.commentId,!n[c])return e;break;default:return e}else{var u=We(e);if(!u||!u.isInCurrentContext)return e;switch(u.commentDraft.sessionConfiguration.sessionType){case"REPLY":d=u.threadId;break;case"EDIT":c=u.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(d&&!r[d]){var l=Yu(e,d);return ja(e,l,3,a,C.reserveTag(539297118)),l}if(c&&!o[c]){var l=Jm(e,c);return ja(e,l,2,a,C.reserveTag(539297119)),l}return e}function XI(e,t){var r=m({},e.drafts),n=!1;return Object.keys(r).forEach(function(o){var a=t(o);a!==r[o].renderContextType&&(r[o]=m(m({},r[o]),{renderContextType:a}),n=!0)}),n?m(m({},e),{drafts:r}):e}function qW(e,t){if(t===vt.Closed){if($t(e))return A.None}else if(e===A.DiscreteIntegrated)return A.FullPane;return e}function Dd(e){var t=We(e);return t?t.commentDraft:void 0}function xF(e){var t=Object.keys(e);if(t.length>1)throw v().assertConditionTag(!1,"Invalid number of drafts.",593762519),new he("Only a single draft is supported at this time.",C.reserveTag(589103619),-2130957551);if(t.length!==0)return t[0]}function qa(e){return xF(e.cardIdToDraftIdMap)}function ws(e){return xF(e.postIdToDraftIdMap)}function We(e){var t=e.drafts,r=xF(t);return r?t[r]:void 0}function TF(e){var t,r,n=e.drafts,o=Object.keys(n).filter(function(l){var p;return(p=n[l])===null||p===void 0?void 0:p.isInCurrentContext}).map(function(l){return n[l]});if(o.length===0)return e;var a=m({},e);try{for(var d=qe(o),c=d.next();!c.done;c=d.next()){var u=c.value;switch(u.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":v().assertConditionTag(u.commentDraft.sessionConfiguration.sessionType!=="METADATA","Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),a=Yu(a,u.threadId);break;case"EDIT":a=Jm(a,u.commentDraft.sessionConfiguration.commentId);break;default:Ne(u.commentDraft.sessionConfiguration)}}}catch(l){t={error:l}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}return a}function Yu(e,t){var r,n=e.pendingDraft&&Nc(e.pendingDraft)&&e.pendingDraft.threadId===t,o=e.cardIdToDraftIdMap[t];return o?m(m({},e),{drafts:GW(e.drafts,(r=e.drafts[o])===null||r===void 0?void 0:r.commentDraft),cardIdToDraftIdMap:Wa(e.cardIdToDraftIdMap,t),pendingDraft:n?void 0:e.pendingDraft}):n?m(m({},e),{pendingDraft:void 0}):e}function Jm(e,t){var r,n=e.pendingDraft&&Va(e.pendingDraft)&&e.pendingDraft.commentId===t,o=e.postIdToDraftIdMap[t];return o?m(m({},e),{drafts:GW(e.drafts,(r=e.drafts[o])===null||r===void 0?void 0:r.commentDraft),postIdToDraftIdMap:Wa(e.postIdToDraftIdMap,t),pendingDraft:n?void 0:e.pendingDraft}):n?m(m({},e),{pendingDraft:void 0}):e}function bF(e,t,r){var n=Yu(e,t),o=ws(n);if(o){var a=n.postIdToDraftIdMap[o],d=n.drafts[a];d&&d.threadId===t&&(n=Jm(n,o))}if(n.pendingDraft&&Va(n.pendingDraft)){var c=n.pendingDraft.commentId,u=r.find(function(l){return l.commentId===c});u&&$e(u)===t&&(n=m(m({},n),{pendingDraft:void 0}))}return n}function Zm(e){if(Y()==="web"||Y()==="win32"){if(e.tasks===Sd.Unknown){if(Y()==="win32")return at();v().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===Sd.Enabled&&at()}return at()}function _xe(e,t){return!!(t&&t.draftWarningState&&(!e||!e.draftWarningState||t.commentDraft.sessionConfiguration.draftId!==e.commentDraft.sessionConfiguration.draftId||t.draftWarningState.warningCounter!==e.draftWarningState.warningCounter))}function KW(e,t){return _xe(We(e),We(t))}function SF(e,t,r,n){var o,a=e.pendingCommentLoad,d=void 0,c=e.expandedComments,u=bxe(t,e);if(a){var l=a.numberOfLoadedComments+t.length,p=a.numberOfLoadedThreads+t.filter(yr).length;l>=a.numberOfTotalComments?(v().assertConditionTag(l===a.numberOfTotalComments,"Loaded more comments than expected",525693528),a=void 0):a=m(m({},a),{numberOfLoadedComments:l,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var g=e.pendingCommentLoad.selectedThreadIndex,h=g!==void 0&&Gu(a,r,n);if(EI(u)&&e.createdCommentLie){var x=Je(e.draftState,!0);if(x&&(!u.cardPostIds[x]||h)){var y=Xm(u.commentThreadIds,u.cardPostIds,e.createdCommentLie.flatIndex);u.cardPostIds[x]||(y<0&&!a&&(v().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),y=u.commentThreadIds.length),y>=0&&(u.commentThreadIds.splice(y,0,x),u.cardPostIds[x]=[x])),y>=0&&g!==void 0&&y<=g&&(g+=1)}}if(g!==void 0&&h){var T=EI(u)?u.commentThreadIds:u.commentData.filter(yr);if(g>=0&&g<T.length){var b=nr(T)?T[g]:T[g].commentId;d=An(b),c=Ga(c,d,e.draftState)}else throw Pt("selectedThreadIndex out of bounds"),new he(a5,C.reserveTag(589103620),-2130957565)}}if(e.selectedComment)if(nt()){var S=We(e.draftState),E=(o=S==null?void 0:S.threadId)!==null&&o!==void 0?o:Je(e.draftState);E===e.selectedComment.selectedCardId&&(d=e.selectedComment,c=e.expandedComments)}else lr(e.draftState)&&(d=e.selectedComment,c=e.expandedComments);return m(m({},u),{pendingCommentLoad:a,selectedComment:d,expandedComments:c})}function eg(e,t){var r=Mr(e,t);return r!=null&&r.author.DisplayName&&(r!=null&&r.date)?{valid:!0,matchesCurrentUser:!!(r!=null&&r.author.IsCurrentUser),timeElapsed:r!=null&&r.date?Date.now()-r.date.getTime():0}:{valid:!1}}function UC(e,t,r){return nr(e)?r?fi(t)?e.some(function(n){return!(t[n].commentFlags&Fe.Resolved)}):t.some(function(n){return n.parentId===""&&!(n.commentFlags&Fe.Resolved)&&e.find(function(o){return o===n.parentId})}):e.length>0:fi(t)?(Gn(!1,"ThreadData and CommentData must align if Map-Based",C.reserveTag(526402327)),!1):r?t.filter(function(n){return n.parentId===""&&!(n.commentFlags&Fe.Resolved)}).length>0:t.length>0}function YW(){var e={atMention:Rt.Unknown,newThread:!1,resolve:!1,richTextCapabilities:Rxe,tasks:Sd.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1};return e}function $W(e,t){var r,n=e.cardIdToDraftIdMap[t.commentId],o=n?e.drafts[n].commentDraft:void 0;if(o===void 0)return v().assertConditionTag(Object.keys(e.drafts).length===0,"Could not find draft for adding smart replies",590202465),e;var a=t.smartReplies,d=o.sessionConfiguration.sessionType,c=a.length,u=c<=Txe&&c>0;return d==="REPLY"&&u?m(m({},e),{drafts:m(m({},e.drafts),(r={},r[n]=m(m({},e.drafts[n]),{smartReplies:a}),r))}):e}var Txe,Rxe,xt=f(()=>{"use strict";s();k();te();rt();Z();Ps();Ic();vw();_I();yf();di();kI();Mi();Vu();Be();mi();Er();DC();Ir();gi();tr();vs();ue();Fc();Wu();Rn();Pf();$m();ho();mo();OC();NC();Txe=3;Rxe=0});function Pr(e){return!!e&&!!e.commentModel}function QW(e){return!!e&&!!e.historyItem}var _f=f(()=>{"use strict";s()});function Axe(e,t,r){for(var n=t;n<e.length;++n)if(e[n].commentId===r.commentId)return n;return-1}function XW(e,t,r,n,o,a){for(var d=[],c=t,u=o;c<=r&&u<=a;){var l=e[c].date;v().assertConditionTag(!!l,"commentDate should not be undefined",595719177),!l||l<=n.history[u].records[0].time?(v().assertConditionTag(e[c].parentId===n.commentId,"comments must belong to the same thread",595719173),d.push({commentModel:e[c]}),++c):(v().assertConditionTag(!n.history[u].commentId,"Unanchored history item should not have commentId",595719178),d.push({historyItem:n.history[u],parentThreadId:n.commentId}),++u)}for(;c<=r;++c)d.push({commentModel:e[c]});for(;u<=a;++u)v().assertConditionTag(!n.history[u].commentId,"Unanchored history item should not have commentId",595719179),d.push({historyItem:n.history[u],parentThreadId:n.commentId});return d}function $u(e,t){if(!at()||!t||t.history.length===0)return e.map(function(u){return{commentModel:u}});var r=!0;if(!gd()&&t.commentId!==t.history[0].commentId&&(v().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),r=!1),e[0].commentId!==t.commentId&&(v().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),r=!1),!r)return e.map(function(u){return{commentModel:u}});var n=[];gd()||n.push({commentModel:e[0],historyItem:t.history[0]});for(var o=gd()?0:1,a=gd()?0:1,d=gd()?0:1;o<e.length&&d<t.history.length;){var c=Axe(e,o,t.history[d]);c>=0&&(n.push.apply(n,w([],j(XW(e,o,c-1,t,a,d-1)),!1)),v().assertConditionTag(c===0||e[c].parentId===t.commentId,"comments must belong to the same thread",595719175),n.push({commentModel:e[c],historyItem:t.history[d]}),o=c+1,a=d+1),++d}return n.push.apply(n,w([],j(XW(e,o,e.length-1,t,a,t.history.length-1)),!1)),n}function JW(e,t,r,n){var o=[];if(fi(r))nr(e)?e.forEach(function(c){o.push.apply(o,w([],j($u(Qm(r,t,c),n[c])),!1))}):v().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var a=0,d=1;d<=r.length;d++)(d===r.length||yr(r[d]))&&(o.push.apply(o,w([],j($u(r.slice(a,d),n[r[a].commentId])),!1)),a=d);return o}function ZW(e,t,r,n,o,a){var d=[];if(e.length===0)return d;if(fi(r))e.forEach(function(h){d.push.apply(d,w([],j($u(Qm(r,t,h.contentId),n[h.contentId])),!1))});else for(var c=0,u=0,l=function(x,y,T,b){return x<y.length&&!!yr(y[x])&&T===-1&&y[x].commentId===b};c<e.length&&!(o!=null&&o.newComment_deprecated&&e[c].contentId===Je(a,!0)&&(d.push({commentModel:o.newComment_deprecated}),c++,c>=e.length));){for(var p=-1,g=0;g<=r.length;g++){if(l(g,r,p,e[c].contentId)){p=g;continue}if(p!==-1&&(g===r.length||yr(r[g]))){if(d.push.apply(d,w([],j($u(r.slice(p,g),n[r[p].commentId])),!1)),c++,c>=e.length)break;p=-1,l(g,r,p,e[c].contentId)&&(p=g)}}u===c&&c++,u=c}return d}function Ka(e,t){var r=e.find(function(n){return Pr(n)&&n.commentModel.commentId===t});if(Pr(r))return r.commentModel}function wo(e){var t=e[0];if(Pr(t))return t.commentModel;throw new he(m5,C.reserveTag(589103627),2130957505)}function VC(e){return Pr(e)?e.commentModel.parentId:e.parentThreadId}function Qu(e,t){return"".concat(e,"__").concat(t)}function yo(e){return Pr(e)?e.commentModel.commentId:Qu(e.historyItem.taskId,e.historyItem.records[0].recordId)}function Fo(e){return Pr(e)?$e(e.commentModel):e.parentThreadId}function IF(e,t){var r=[],n=e.records[0];switch(n.type){case sr.Create:case sr.UnassignAll:{for(var o=[],a=1;a<e.records.length;a++){var d=e.records[a];d.type===sr.Assign&&o.push(Nr(d.assignee))}r.push({icon:13,description:MI(t,!0,o)});break}case sr.Assign:case sr.Unassign:{for(var o=[],c=[],a=0;a<e.records.length;a++){var d=e.records[a];if(d.type!==sr.Assign&&d.type!==sr.Unassign)return v().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];d.type===sr.Assign?o.push(Nr(d.assignee)):c.push(Nr(d.assignee))}o.length>0&&r.push({icon:13,description:MI(t,!0,o)}),c.length>0&&r.push({icon:13,description:MI(t,!1,c)});break}case sr.Progress:return n.completion===100?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case sr.Schedule:return[{icon:17,description:t.getString(118)}];default:return v().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return r.length===0&&r.push({icon:0,description:t.getString(119)}),r}function Rf(e,t){return e.findIndex(function(r){return r.length>0&&Fo(r[0])===t})}function jC(e,t){return e.some(function(r){return Pr(r)&&!!(r.commentModel.commentFlags&Fe.LowFidelity)&&(t===void 0||t===$e(r.commentModel))})}function WC(e,t,r,n,o){for(var a=[],d=!ir()&&!o&&r!==void 0,c=-1,u=-1,l=0;l<e.length;l+=1){var p=e[l],g=Pr(p)?p:void 0;if(!g||t[g.commentModel.commentId]===void 0){for(v().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(d),593085888),Pr(p)&&++u;!(l+1>=e.length||VC(e[l+1])==="");)++l,Pr(e[l])&&++u;continue}if(t[g.commentModel.commentId].pending===pt.Delete&&n){for(Pr(p)&&++u;!(l+1>=e.length||VC(e[l+1])==="");)++l,Pr(e[l])&&++u;continue}++u,a.push([g]),d&&u===(r==null?void 0:r.flatIndex)&&(c=a.length-1);for(var h=l+1;h<e.length;h+=1){if(p=e[h],Pr(p)){var x=VC(p);if(x!==g.commentModel.commentId){v().assertConditionTag(!x,"Orphaned reply",593085889);break}a[a.length-1].push(p),++u}else a[a.length-1].push(p);++l}}return d&&r&&(c!==-1?a.splice(c,0,[{commentModel:r.newComment_deprecated}]):(v().assertConditionTag(r.flatIndex>u,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),r.flatIndex===u+1&&a.push([{commentModel:r.newComment_deprecated}]))),a}var Qo=f(()=>{"use strict";s();k();te();Z();Au();di();lw();hn();tr();vs();ue();xt();Wu();mo();_f();mi()});var Bi,Xu,t7,Ju,e7,Af,r7,or,zC,ZI,n7,Ui=f(()=>{"use strict";s();Bi=function(t){return t.filterState.activeFilterId},Xu=function(t){return t.filterState.defaultFilterId_deprecated},t7=function(t){var r,n=t.filterState.activeFilterId;if(n)return(r=t.filterState.filteredRanges[n])===null||r===void 0?void 0:r.filter},Ju=function(t,r){return t.filterState.filteredRanges[r]},e7=[],Af=function(t){var r,n,o=t.filterState.activeFilterId;return o&&(n=(r=t.filterState.filteredRanges[o])===null||r===void 0?void 0:r.order)!==null&&n!==void 0?n:e7},r7=function(t){return Af(t).length},or=function(t){return t.filterState.filteringCapabilities},zC=function(t){return t.filterState.requestDefaultFilter_deprecated},ZI=function(t){return t.filterState.ensureActiveFilter},n7=function(t){return t.filterState.collaborators}});var kxe,Xo,eE,el=f(()=>{"use strict";s();ue();kxe={},Xo=function(t){return at()?t.commentState.tasks:kxe},eE=function(t){return t.commentState.historyRecordViewState}});var tE,o7,tg,Vi,rE,Ft,kn,yi,Dxe,Yn,i7,a7,nE,fe,Dn,ve,da,ji,tl,wd,GC,Co,oE,Br,iE,aE,sE,Et=f(()=>{"use strict";s();Do();Pm();Qo();xt();mo();Ui();el();tE=function(t){return t.commentState.contextState.isReadOnly},o7=function(t){return t.commentState.topVisibleThreadId},tg=function(t){return t.commentState.personaIconPropertiesMap},Vi=function(t){return t.commentState.cardViewState},rE=function(t){return t.commentState.highlightedCommentId},Ft=function(t){return Jr(t.commentState)?t.commentState.postData:t.commentState.commentData},kn=function(t){return Jr(t.commentState)?t.commentState.commentThreadIds:t.commentState.commentData},yi=function(t){var r=or(t);if(r){if(Bi(t)){var n=Af(t);return r.supportedContentTypes!==wt.CommentThread&&(n=n.filter(function(o){return o.contentType===wt.CommentThread})),n.map(function(o){return o.contentId})}return[]}return kn(t)},Dxe={},Yn=function(t){return Jr(t.commentState)?t.commentState.cardPostIds:Dxe},i7=function(t){return kn(t).length>0},a7=function(t){return yi(t).length>0},nE=function(t){return t.commentState.postViewState},fe=function(t){return t.commentState.draftState},Dn=function(t){return We(fe(t))},ve=function(t){return t.commentState.selectedComment},da=function(t){return t.commentState.expandedComments},ji=function(t){return t.commentState.pendingCommentLoad},tl=function(t){return t.commentState.selectedThreadIdBeforeCommentSession},wd=function(t){return t.commentState.contextState},GC=function(t,r,n){return Je(fe(t),r,n)},Co=function(t,r,n){return t.commentState.createdCommentLie&&GC(t,r,n)?t.commentState.createdCommentLie:void 0},oE=function(){return _n([kn,Af,Yn,Ft,Co,fe,Xo,or],function(t,r,n,o,a,d,c,u){return u?ZW(r,n,o,c,a,d):JW(t,n,o,c)})},Br=function(t){return t.commentState.modelCapabilities},iE=function(t){return t.commentState.suggestionsDetails},aE=function(t,r){return r?Mr(Ft(t),r):void 0},sE=function(){return _n([Af,ve,or],function(t,r,n){return!n||!r||t.some(function(o){return o.contentType===wt.CommentThread&&r.selectedCardId===o.contentId})?r:void 0})}});var Ci,Oo,ca,Fs,$n,dE,vo=f(()=>{"use strict";s();Pm();Mi();gi();xt();Et();Ui();Ci=function(t){return t.paneState.visibilityState===vt.Visible},Oo=function(t){return t.paneState.visibilityState!==vt.Closed},ca=function(t){return t.paneState.visibilityState},Fs=function(t){return t.paneState.componentTree},$n=function(t){return t.paneState.viewContainer},dE=function(t){return _n([t,or,fe],function(r,n,o){var a;if(!n&&r&&Je(o)===r.selectedCardId){var d=(a=o.drafts[r.selectedCardId])===null||a===void 0?void 0:a.renderContextType;if(d!==void 0&&!$t(d))return}return r})}});var pe,Cn=f(()=>{"use strict";s();te();Z();tr();pe=function(t){return function(r){Fi(r)?v().assertConditionTag(!1,r.message,t):v().assertConditionTag(!1,"Unknown error ".concat(so(r)),t)}}});function Os(e){switch(e){case cn.HalfPane:return A.HalfPane;case cn.FullPane:return A.FullPane;default:Ne(e)}}var rg=f(()=>{"use strict";s();te();Ma();Be()});function s7(){return Promise.resolve(void 0)}var d7=f(()=>{"use strict";s()});function ng(e){return typeof e=="object"&&typeof e.message<"u"&&typeof e.SDXHostAPIErrorCode<"u"}var cE=f(()=>{"use strict";s()});function ln(e,t){return Fi(e)?e.errorCode:ng(e)?e.SDXHostAPIErrorCode:t===void 0?-2147467259:t}var Mc=f(()=>{"use strict";s();tr();cE()});function wxe(e,t,r){var n=Dn(e),o=ve(e);if(!n)return o&&Xe(o.selectionDetails)&&Rs(o)?{cancelAction:hC(It(r,C.reserveTag(593278744)),o.selectionDetails.selectedPostId,t),sessionType:aa}:-2130957522;var a=n.commentDraft.sessionConfiguration.sessionType;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:wS(It(r,C.reserveTag(593278745)),t),sessionType:a};case"REPLY":return{cancelAction:FS(It(r,C.reserveTag(593278746)),n.commentDraft.sessionConfiguration.threadId,t),sessionType:a};case"EDIT":return{cancelAction:hC(It(r,C.reserveTag(593278747)),n.commentDraft.sessionConfiguration.commentId,t),sessionType:a};default:return v().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}function og(e,t,r,n){return function(o,a){var d=a(),c=v().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,be()),u=fe(d),l=ve(d),p=hi(u);c.addDataField("Trackback",e.trackback,N.SystemMetadata),c.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),c.addDataField("CommitPendingAttemptedCancel",p,N.SystemMetadata),c.addDataField("ActionSource",t,N.SystemMetadata);var g=wxe(d,r,e);if(typeof g=="number")return c.failTag(C.reserveTag(593278749),g),Promise.resolve(He.Handled);var h=g.sessionType,x=g.cancelAction;return c.addDataField("ActiveSessionType",h,N.SystemMetadata),!p&&($o(u)||jm(l))?(c.addDataField("DiscardUnnecessary",!1,N.SystemMetadata),o(kS(It(e,C.reserveTag(593278750)))),n?n(function(){return o(x),c.addDataField("CancelledByUser",!1,N.SystemMetadata),c.successTag(593278751),He.Handled},function(){return c.addDataField("CancelledByUser",!0,N.SystemMetadata),c.successTag(593278752),o(OS(It(e,C.reserveTag(593278753)))),He.Canceled}):(o(x),c.successTag(593278754),Promise.resolve(He.Handled))):(c.addDataField("DiscardUnnecessary",!0,N.SystemMetadata),c.successTag(593278755),Promise.resolve(He.Unhandled))}}var uE=f(()=>{"use strict";s();te();Z();Cr();xd();pd();Rn();ho();Et();de();Ew();_w()});function Df(e,t,r){return function(n,o){var a=o(),d=fe(a),c=v().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,be()),u=hi(d);c.addDataField("Trackback",e.trackback,N.SystemMetadata),c.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),c.addDataField("CommitPendingAttemptedCancel",u,N.SystemMetadata),c.addDataField("ActionSource",t,N.SystemMetadata);var l=kd(d);return c.addDataField("DraftDiscardBehavior",l,N.SystemMetadata),l===Lr.CanAutoDiscard?n(og(e,t,!1)).then(function(p){return c.successTag(539754957),{draftDiscardResult:p,draftDiscardBehavior:l}}):(r!==void 0&&l===Lr.CannotAutoDiscard&&(c.addDataField("DraftWarningReason",r,N.SystemMetadata),n(Ua({draftWarningType:Hr.ReturnToDraft,draftWarningReason:r},It(e,C.reserveTag(591728722))))),c.successTag(539754958),Promise.resolve({draftDiscardResult:He.Canceled,draftDiscardBehavior:l}))}}var lE=f(()=>{"use strict";s();te();Z();pd();Vu();xt();Rn();xf();Et();de();US();uE()});function c7(e,t,r,n){var o,a=e.map(function(u){return u.author}),d=(o=t==null?void 0:t.map(function(u){return u.history.map(function(l){return l.records[0].user})}))!==null&&o!==void 0?o:[],c=wy([a,d,n??[]]);return Fxe(c,r)}function Fxe(e,t){var r={};return e.filter(function(n){var o=fw(n);return!o||r[o]||qC(t,n)?!1:r[o]=!0})}function EF(e){return e.reduce(function(t,r){var n=Oxe(r);return n&&(t[n]=r),t},{})}function u7(e){var t=[];return e.forEach(function(r){t.push({authorName:r.DisplayName||"",authorID:r.UserId,authorColor:Pe.COMMENTS_PURPLE,authorImageURL:""})}),t}function Oxe(e){if(!(!e.authorID&&!e.authorName))return e.authorID||e.authorName}function qC(e,t){var r=fw(t);if(r){var n=e[r];if(n!==void 0)return n;if(t.DisplayName&&e[t.DisplayName])return e[t.DisplayName]}}var PF=f(()=>{"use strict";s();rt();hn();ym()});function rl(e,t,r,n,o){return function(a,d){var c=c7(t,r,tg(d()),o);if(c.length===0)return Promise.resolve();if(n.getPersonaIconPropertiesArray)n.getPersonaIconPropertiesArray(c).then(function(l){a(CC(e,EF(l)))}).catch(pe(C.reserveTag(595645964)));else{var u=u7(c);a(CC(e,EF(u)))}return Promise.resolve()}}var KC=f(()=>{"use strict";s();te();Cn();PF();Et();Lw()});function Ns(e,t,r,n,o,a){return function(d,c){var u=c(),l=v().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,be()),p=Bm[r.sessionType];return l.addDataField("SessionType",p,N.SystemMetadata),l.addDataField("Trackback",e.trackback,N.SystemMetadata),l.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),l.addDataField("PaneVisibilityState",ca(u),N.SystemMetadata),!at()&&r.sessionType===Ec?(l.failTag(591397599,-2130957513),Promise.resolve(d(Kn))):(Br(u).atMention===Rt.Enabled&&s7().catch(pe(C.reserveTag(591397600))),d(Df(e,ce.SharedComments,Q8(r))).catch(function(g){return pe(C.reserveTag(591397602))(g),{draftDiscardResult:He.Unhandled,draftDiscardBehavior:Lr.CannotAutoDiscard}}).then(function(g){var h,x;l.addDataField("DraftDiscardBehavior",g.draftDiscardBehavior,N.SystemMetadata);var y=c(),T=fe(y);if(lr(T)||!ir()&&Co(y)&&RI(r))return l.addDataField("SessionAlreadyRequested",!0,N.SystemMetadata),l.addDataField("DraftRenderContextType",(x=(h=We(T))===null||h===void 0?void 0:h.renderContextType)!==null&&x!==void 0?x:A.None,N.SystemMetadata),l.successTag(591397633),Promise.resolve(d(Kn));l.addDataField("SessionAlreadyRequested",!1,N.SystemMetadata),a||d(aI(It(e,C.reserveTag(591397634)),r,n));var b=t.beginDraftingAsync(r);return b.then(function(S){if(S.sessionConfiguration===void 0)throw new he(fd,C.reserveTag(589103630),-2130957532);RI(r)&&ka()&&d(rl(It(e,C.reserveTag(591397635)),[],[],o,S.author));var E=c(),P=Nxe(e.renderContextType,ca(E),$n(E).containerType);return l.addDataField("DraftRenderContextType",P,N.SystemMetadata),v().assertConditionTag(P===e.renderContextType||e.renderContextType===A.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(P," based on pane state"),554714642),l.successTag(591397640),d(RS(It(e,C.reserveTag(591397641)),S,P,a))}).catch(function(S){var E=S.message||S;return E.includes("LegacyConvertDialog")?l.successTag(591397643):l.failTag(591397642,ln(S)),d(_S(It(e,C.reserveTag(591397644)),r,S))})}))}}function Nxe(e,t,r){return t!==vt.Closed&&e!==A.DiscreteIsolated?Os(r):$t(e)?t===vt.Closed?A.None:Os(r):e}var YC=f(()=>{"use strict";s();te();Z();Ps();xd();yf();Mi();Vu();Be();rg();gi();d7();Cn();tr();Mc();vs();ue();xt();Rn();Et();vo();de();un();bw();Sw();Fm();jw();lE();KC()});var wn,$C=f(()=>{"use strict";s();_d();wn={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:Qe.All},TrackedChange:{stubField:""},contentOrder:Ed.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0}});function Mxe(e){var t=Bi(e);if(!t||!ar()&&t===Xu(e))return!1;var r=Ju(e,t);return!!r&&r.canUpdateFilter}function l7(e){if(Mxe(e))return Bi(e)}function wf(e,t){if(!or(e))return!0;var r=Af(e);return r.find(function(n){return n.contentId===t})!==void 0}function QC(e,t){var r;return(!t.supportsMentionToMeFilter||e.mentionsToCurrentUser===wn.mentionsToCurrentUser)&&((r=e.CommentThread)===null||r===void 0?void 0:r.resolutionStatus)===wn.CommentThread.resolutionStatus&&(!t.supportsFilterByUser||e.userFilter===void 0||e.userFilter.length===0)}function ig(e,t){if(t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,N.SystemMetadata),ar()){var r=!1,n=Bi(e);if(n){var o=e.filterState.filteredRanges[n],a=e.filterState.filteringCapabilities;o&&a&&(r=!QC(o.filter,a))}t.addDataField("IsFilterApplied",r,N.SystemMetadata)}else t.addDataField("IsFilterApplied",!!e.filterState.activeFilterId&&e.filterState.activeFilterId!==Xu(e),N.SystemMetadata)}var _F,Fd=f(()=>{"use strict";s();_d();Z();ue();$C();Ui();_F=[Qe.ActiveOnly,Qe.ResolvedOnly]});function f7(e,t,r,n,o){return function(a,d){var c=v().createActivityObject("CommentReaction",e.telemetryVisitor,be());c.addDataField("UserReactionAction",o,N.SystemMetadata);var u=d();if(r.sessionType===Ec){var l=eg(Ft(u),r.threadId);l.valid&&(c.addDataField("MatchesCommentAuthor",l.matchesCurrentUser,N.SystemMetadata),c.addDataField("ThreadCreationDeltaMs",l.timeElapsed,N.SystemMetadata))}ig(u,c);var p=t.beginDraftingAsync(r);p.then(function(g){g.updateProperties("Reaction",{type:"Reaction",reactionType:n,isActive:o}),g.commit(),g.endDrafting(),c.successTag(587317280)}).catch(function(g){c.failTag(587317281,ln(g))})}}var p7=f(()=>{"use strict";s();Z();xd();Mc();Fd();xt();Et()});var RF,At,Od=f(()=>{"use strict";s();(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(RF||(RF={}));At=RF});function ua(e,t,r){return r===A.HalfPane||t.includes(e)?At.Expanded:At.Collapsed}var Ff=f(()=>{"use strict";s();Od();Be()});function pE(e){return e===fE}function m7(e,t){var r=m({},t);vS(r,e);var n=[];Object.keys(r).forEach(function(a){var d=r[a].assignee;ku(d)||n.push(d)});var o=t?e.filter(function(a){return t[CS(a)]===void 0}):w([],j(e),!1);if(!(n.length===0&&o.length===0))return{assigneesToAdd:n,assigneesToRemove:o}}var fE,XC=f(()=>{"use strict";s();k();bd();hn();fE=100});var mE,AF=f(()=>{"use strict";s();mE="O365"});var h7,y7=f(()=>{"use strict";s();AF();h7=function(){function e(t,r){r===void 0&&(r=!0),this.rawDelta=t,this.onlyNewMentions=r,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var t=this,r,n;this._deserializedDelta=JSON.parse(this.rawDelta),(n=(r=this._deserializedDelta)===null||r===void 0?void 0:r.ops)===null||n===void 0||n.forEach(function(o){var a,d;if(o!=null&&o.attributes){o.attributes.link&&(t._NumHyperlinks+=1);var c=o.attributes.atmention,u=o.optional;c&&(!t.onlyNewMentions||((a=u==null?void 0:u.atmention)===null||a===void 0?void 0:a.contentId)===void 0)&&((d=t._users)===null||d===void 0||d.push({UserId:c.email,Provider:mE})),(o.attributes.weight||o.attributes.italic||o.attributes.underline)&&(t._hasRichTextFormatting=!0)}})},e}()});var kF,xi,gE=f(()=>{"use strict";s();(function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"})(kF||(kF={}));xi=kF});function v7(e,t,r,n,o,a){return function(d,c){var u,l,p=v().createActivityObject("CommitComment",e.telemetryVisitor,be());p.addDocumentMetadata(wi.Basic);var g=Bm[o.type],h=c(),x=Xo(h),y=Dn(h);if(y===void 0||y.commentDraft.sessionConfiguration.sessionType!==o.type)return p.failTag(593278784,-2130957522),Promise.resolve(xi.CommitFailed);var T="",b=!1;switch(o.type){case aa:T=o.commentId;break;case Ko:T=o.parentId,b=!0;break;case fo:y&&(T=y.commentDraft.sessionConfiguration.draftId||"");break}var S=da(h),E=!b||ua(T,S,e.renderContextType)===At.Expanded;p.addDataField("IsCardExpanded",E,N.SystemMetadata);var P=Lxe(x[T],y);if(P!=null&&P.Task&&!Zm(h.commentState.modelCapabilities)&&(v().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),P.Task=void 0),(at()&&o.type===fo||gd()&&o.type===Ko)&&(p.addDataField("IsPreExistingTask",!!x[T],N.SystemMetadata,ko.Critical),p.addDataField("AffectingTaskMetadata",!!(P!=null&&P.Task),N.SystemMetadata,ko.Critical)),p.addDataField("SessionType",g,N.SystemMetadata),o.type!==fo){var _=eg(Ft(h),T);_.valid&&(p.addDataField("MatchesCommentAuthor",_.matchesCurrentUser,N.SystemMetadata),p.addDataField("ThreadCreationDeltaMs",_.timeElapsed,N.SystemMetadata))}p.addDataField("AtMentionsEnabled",r,N.SystemMetadata),p.addDataField("Trackback",e.trackback,N.SystemMetadata),p.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),p.addDataField("CommitSource",a,N.SystemMetadata);var D=fe(h);return hi(D)?((l=(u=v()).logDiagnosticTrace)===null||l===void 0||l.call(u,Mt(C7||(C7=qt(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),C.reserveTag(556827598),St.Info,ht.ProductServiceUsage,e.telemetryVisitor),Promise.resolve(xi.CommitPending)):(d(AS(It(e,C.reserveTag(593278785)))),n().then(function(O){if(!r){var H=DF(d,o,O,0,p,C.reserveTag(593278786),C.reserveTag(593278787),e,P);return Promise.resolve(H)}var V=new h7(O),M=V.Mentions,G=v();if(M5()&&M.length>0&&G.logFloodgateActivity&&G.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),p.addDataField("CreateCommentWithRichFormatting",V.HasRichTextFormatting,N.SystemMetadata),!M.length){var H=DF(d,o,O,0,p,C.reserveTag(593278788),C.reserveTag(593278789),e,P);return Promise.resolve(H)}return t.grantUsersAccess(M).then(function(K){var z=Hxe(K),$=Bxe(K);if(p.addDataField("AllUsersGrantedAccess",z,N.SystemMetadata),p.addDataField("ShareDialogCanceled",$,N.SystemMetadata),K.OperationResult===df.FailedSilently)return Pt("Check Access Phase failed - share dialog not shown"),p.failTag(593278790,-2130957561),hE(d,O,Hr.GrantAccessFailedSilently,C.reserveTag(593278791),C.reserveTag(593278792),e),Promise.resolve(xi.ShareFailed);if($)return Pt("Share dialog was canceled by user"),p.successTag(593278793),hE(d,O,Hr.GrantAccessCanceled,C.reserveTag(593278794),C.reserveTag(554801174),e),Promise.resolve(xi.ShareFailed);if(!z)return Pt("Not all users have been granted access - going back to initial state"),p.successTag(593278795),hE(d,O,Hr.GrantAccessCanceled,C.reserveTag(593278796),C.reserveTag(554784648),e),Promise.resolve(xi.ShareFailed);var q=DF(d,o,O,M.length,p,C.reserveTag(593278797),C.reserveTag(593278798),e,P);return Promise.resolve(q)},function(K){return p.failTag(593278799,-2130957561),Pt("Grant Users Access has failed",so(K)),hE(d,O,Hr.GrantAccessFailedSilently,C.reserveTag(593278800),C.reserveTag(554784393),e),Promise.resolve(xi.ShareFailed)})},function(O){return p.failTag(593278801,-2130957539),d(pf(It(e,C.reserveTag(593278802)),void 0)),Pt("getCommentBody failed",so(O)),Pn()&&d(Ua({draftWarningReason:go.CommitFailure,draftWarningType:Hr.CommitFailed},It(e,C.reserveTag(593278803)))),Promise.resolve(xi.CommitFailed)}))}}function Lxe(e,t){var r;if(!(!t||Ba(t.commentDraft.sessionConfiguration)||!at())){var n=void 0,o=Tm()?m7((r=e==null?void 0:e.currentState.assignees)!==null&&r!==void 0?r:[],t.selectedTaskAssignees):void 0;if(o)n={Task:{type:"Task",assigneeUpdate:o}};else{var a=t.selectedTaskAssignee;n=a?{Task:{type:"Task",assignee:a}}:void 0}return n}}function Hxe(e){var t=e.OperationResult;return typeof t=="boolean"?t:t===df.Success}function Bxe(e){return!!e.Details&&e.Details.Canceled}function hE(e,t,r,n,o,a){e(pf(It(a,n),t)),e(Ua({draftWarningType:r,draftWarningReason:go.GrantUsersAccessFailure},It(a,o)))}function DF(e,t,r,n,o,a,d,c,u){var l=Uxe(e,t,r,c,u);return l?(o.failTag(d,l),xi.CommitFailed):n?(t.type===fo?(o.addDataField("CreateThreadWithMentions",!0,N.SystemMetadata,ko.Critical),u&&u.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,N.SystemMetadata,ko.Critical)):t.type===Ko&&(o.addDataField("CreateReplyWithMentions",!0,N.SystemMetadata,ko.Critical),u&&u.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,N.SystemMetadata,ko.Critical)),o.successTag(a),xi.Success):(o.successTag(a),xi.Success)}function Uxe(e,t,r,n,o){try{switch(t.type){case"CREATE":e(wm(It(n,C.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:r},metadataUpdates:o}));break;case"EDIT":e(wm(It(n,C.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:r,commentId:t.commentId}}));break;case"REPLY":e(wm(It(n,C.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:r,parentId:t.parentId},metadataUpdates:o}));break;default:return v().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e(pf(It(n,C.reserveTag(593278808)),r)),-2130957532}}catch(a){if(!Fi(a)&&!ng(a))throw a;return e(pf(It(n,C.reserveTag(593278809)),r)),Pn()&&e(Ua({draftWarningReason:go.CommitFailure,draftWarningType:Hr.CommitFailed},It(n,C.reserveTag(593278810)))),ln(a)}}var C7,x7=f(()=>{"use strict";s();k();te();rt();bd();Z();Cr();xd();yf();TS();Od();Ff();XC();y7();tr();Mc();cE();ue();gE();xt();Rn();bC();xf();Et();el();Iw();Dw();US()});var wF,Ms,ag=f(()=>{"use strict";s();(function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"})(wF||(wF={}));Ms=wF});function T7(e,t){return B("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}var b7=f(()=>{"use strict";s();de()});function Of(e,t){return function(r,n){var o=$n(n());return Ou(o)&&Nu(t)?o.setDisplayConfiguration(t).then(function(a){return r(T7(e,a)),Promise.resolve(a)}).catch(function(a){return Vxe(a)}):Promise.reject(new he("Not half pane or half pane configuration",C.reserveTag(577610273),-2130957557))}}function Vxe(e){return pe(C.reserveTag(578426816))(e),Promise.resolve(void 0)}var yE=f(()=>{"use strict";s();te();Mu();bS();Cn();tr();vo();b7()});function S7(e,t,r,n,o){return function(a){return a(DS({renderContextType:e,trackback:C.reserveTag(595899542),telemetryVisitor:o})),t===Ms.NewThread?(e===A.HalfPane&&a(Of({renderContextType:e,trackback:C.reserveTag(595899543),telemetryVisitor:o},{displayMode:po.Variable,desiredHeight:0})).catch(pe(C.reserveTag(595645966))),a(Ns({renderContextType:e,trackback:C.reserveTag(595898586),telemetryVisitor:o},r,{sessionType:"CREATE"},!1,n)).then(function(){a(yC({renderContextType:e,trackback:C.reserveTag(595899545),telemetryVisitor:o}))})):a(yC({renderContextType:e,trackback:C.reserveTag(595899546),telemetryVisitor:o}))}}var I7=f(()=>{"use strict";s();te();Mu();ag();Be();Cn();Pw();Ow();YC();yE()});function E7(e,t,r){return function(n,o){var a,d=o();((a=ve(d))===null||a===void 0?void 0:a.selectedCardId)!==t&&n(yn(e,t,void 0,Ee.ExpandCard,ce.SharedComments)),n(Bu(e,t,r))}}var P7=f(()=>{"use strict";s();Et();un();Fc();Ww()});function jxe(e){return e===Q.CardEditor||e===Q.PostEditor||e===Q.Card||e===Q.Post||e===Q.DraftCard||e===Q.DiscreteHostedCommentRoot||e===Q.ReopenThreadButton}function _7(e){return e===Q.ClosePaneButton||e===Q.NextCommentButton||e===Q.PreviousCommentButton||e===Q.GhostCard||e===Q.NewCommentButton||e===Q.PaneRoot||e===Q.CommentsList||e===Q.FilterButton}function Nd(e){return jxe(e.componentType)}function R7(e){switch(e){case Q.CardEditor:case Q.Card:case Q.DraftCard:case Q.DiscreteHostedCommentRoot:case Q.ReopenThreadButton:return!0;case Q.PostEditor:case Q.Post:return!1}}function A7(e,t){return Nd(e)&&Nd(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}var Q,Ti=f(()=>{"use strict";s();(function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList",e[e.FilterButton=15]="FilterButton"})(Q||(Q={}))});function nl(e){var t="";return _7(e.componentType)?t=Qn(e.componentType):Nd(e)&&(t=$a(e)),t}function Qn(e){switch(e){case Q.ClosePaneButton:return eW();case Q.NextCommentButton:return dW();case Q.PreviousCommentButton:return cW();case Q.GhostCard:return PC();case Q.NewCommentButton:return iW();case Q.PaneRoot:return Zj();case Q.CommentsList:return rW();case Q.FilterButton:return bW()}}function $a(e){switch(e.componentType){case Q.Card:return If(e,!1);case Q.DraftCard:return If(e,!0);case Q.PostEditor:return _C(VI(e));case Q.CardEditor:return _C(UI(e));case Q.Post:return jI(e);case Q.DiscreteHostedCommentRoot:return lW(e);case Q.ReopenThreadButton:return GI(e,qI())}}function Nf(e){return e?Q.DraftCard:Q.Card}function Lc(e,t){return Nf(Je(t)===e)}function FF(e){var t,r;if(mb(e)&&e.getId())return e.getId();var n=e.props?(r=(t=e.props.testId)!==null&&t!==void 0?t:e.props.nodeId)!==null&&r!==void 0?r:e.props.accessibilityLabel:void 0;return e.constructor.name+(n?"#".concat(n):"")}var Qa=f(()=>{"use strict";s();Lt();xt();Er();Ti()});function CE(e,t,r,n){return function(o,a){o(B("SELECT_COMMENT",r,t));var d=a(),c=ve(d);return n&&c&&c.selectedCardId===r.selectedCard&&(r.selectType!==Ee.SelectPost||Xe(c.selectionDetails)&&c.selectionDetails.selectedPostId===r.selectedPost)?e?new Promise(function(u){return setTimeout(function(){var l;if(Xe(c.selectionDetails))l={componentType:Q.Post,id:c.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var p=fe(d).drafts[c.selectedCardId],g=!!p&&p.commentDraft.sessionConfiguration.sessionType==="CREATE";l={componentType:Nf(g),id:c.selectedCardId,renderContextType:t.renderContextType}}var h=e.getComponentById(l);h?(mn&&Pt("Focusing comment ".concat(l.id," with render context type ").concat(l.renderContextType," after selection.")),h.focus()):v().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(l)),590104655),u()})}):(v().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function sg(e,t,r){return m({selectedCard:e,source:t},r)}var vE=f(()=>{"use strict";s();k();te();Z();Qa();Ti();bc();ho();Et();de();Fc()});function k7(e,t){return{requestDeleteComment:function(n,o){e(JS(n,o))},requestDeleteThread:function(n,o,a){e(Nm(n,o,a))},requestReopenThread:function(n,o,a){e(eI(n,o,a))},requestResolveThread:function(n,o,a){e(rI(n,o,a))},requestEditCommentSession:function(n,o,a){e(Ns(n,t.commentAPI,{sessionType:"EDIT",commentId:o,rootCommentId:nf()?a:void 0},!1,t.peopleAPI)).catch(pe(C.reserveTag(574362624)))},requestReplyCommentSession:function(n,o){e(Ns(n,t.commentAPI,{sessionType:"REPLY",threadId:o},!1,t.peopleAPI)).catch(pe(C.reserveTag(574362625)))},commitCommentAndFocus:function(n,o,a,d,c,u,l){return e(v7(n,t.peopleAPI,d,o,a,l)).then(function(p){return p===xi.Success&&t.focusManager.focusCommentCardCommand(c,u),p})},discardDraftAsync:function(n,o,a,d){return e(og(n,o,a,d))},discardDraftIfEmpty:function(n,o,a){return e(Df(n,o,a))},showLowFidelityWarning:function(n,o,a){e(Bu(n,o,a))},clearLowFidelityWarning:function(n){e(NS(n))},saveDraft:function(n,o,a){e(Mm(n,{draftId:o,draftContent:a}))},clearCommentHighlight:function(n,o){e(Lu(n,ce.SharedComments,o))},checkUserAccess:function(n){return t.peopleAPI.checkUserAccess(n)},updateMentioneesStillInDraft:function(n,o){e(yI(n,o))},addToCurrentMentionees:function(n,o){e(PS(n,o))},updateSelectedTaskAssignee:function(n,o){e(vI(n,o))},updateSelectedTaskAssignees:function(n,o){e(xI(n,o))},toggleTaskAssigner:function(n){e(lI(n))},displayDraftWarning:function(n,o,a){e(Ua({draftWarningType:o,draftWarningReason:a},n))},showPostErrorUI:function(n,o){e(uI(n,o))},clearPostErrorUI:function(n,o){e(MS(n,o))},selectCommentCardAndShowLowFidelityWarning:function(n,o,a){e(E7(n,o,a))},draftEmptinessChanged:function(n,o,a){e(VS(n,a,o))},selectComment:function(n,o,a,d){return e(CE(n,o,a,d))},collapseCard:function(n,o){e(Dm(n,o))},requestUpdateCommentReactions:function(n,o,a,d){e(f7(n,t.commentAPI,{sessionType:"METADATA",threadId:o},a,d))},requestPresentLinkToComment:function(n,o){e($S(n,o))},onClickableTextClicked:function(n){var o,a;(a=(o=t.commentAPI).onClickableTextClicked)===null||a===void 0||a.call(o,n)}}}function ol(e,t){return m(m({},k7(e,t)),{highlightComment:function(n,o){e(wc(n,o,ce.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Ns(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(pe(C.reserveTag(592314377)))},queueLoadThreads:function(n,o){e(vC(n,{threadIds:o}))},requestClosePane:function(n){e(Hu(n))},requestDisplayConfiguration:function(n,o){return e(Of(n,o))},readyToRender:function(n){e(QS(n))},requestModalConfirmation:function(n,o,a,d){e(ZS(n,o,a,d))},initializeView:function(n){e(S7(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(n,o){e(TC(n,o))}})}function xE(e,t){return m(m({},k7(e,t)),{updateRenderLockForDraft:function(n,o,a){e(TC(n,o,a))},highlightComment:function(n){e(wc(n,t.resource.id,ce.SharedComments))},requestDisplayConfiguration:function(n,o){return t.componentTree.componentTreeId.renderContextType!==A.HalfPane?Promise.resolve(void 0):e(Of(n,o))},queueLoadThread:function(n){return e(vC(n,{threadIds:[t.resource.id]}))}})}var JC=f(()=>{"use strict";s();k();te();Cn();ue();Cr();un();YC();p7();x7();lE();uE();I7();yE();P7();vE();gE();Be()});var il,D7=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"})(il||(il={}))});var la,w7=f(()=>{"use strict";s();(function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"})(la||(la={}))});var Qt,F7=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"})(Qt||(Qt={}))});var O7=f(()=>{"use strict";s();D7();w7();F7()});var N7,Wxe,M7,L7=f(()=>{"use strict";s();N7=I(_t()),Wxe={ContentNavigationModule:["SDX::ContentExtension::Navigation::ContentNavigationModule",{selectNextOrPreviousContent:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::SelectNextOrPreviousContentArgs"]],moveFocus:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::MoveFocusArgs"]],bringContentIntoView:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::BringContentIntoViewArgs"]]}]},M7={ContentNavigationModule:N7.RekaServiceRegistry.getNativeService(Wxe.ContentNavigationModule)}});var H7,Gxe,B7,U7=f(()=>{"use strict";s();H7=I(_t()),Gxe={ContentNavigationModuleConstants:["SDX::ContentExtension::Navigation::ContentNavigationModuleConstants",{isHostImplementationEnabled:["Constant","$boolean"]}]},B7={ContentNavigationModuleConstants:H7.RekaServiceRegistry.getNativeService(Gxe.ContentNavigationModuleConstants)}});var dg,V7=f(()=>{"use strict";s();L7();U7();dg=function(){function e(t){this.apiContext=t}return e.prototype.selectNextOrPreviousContent=function(t){this.getModule().selectNextOrPreviousContent(this.apiContext,t)},e.prototype.moveFocus=function(t){this.getModule().moveFocus(this.apiContext,t)},e.prototype.bringContentIntoView=function(t){this.getModule().bringContentIntoView(this.apiContext,t)},e.prototype.getModule=function(){return M7.ContentNavigationModule},e.prototype.isAPIEnabled=function(){return B7.ContentNavigationModuleConstants.isHostImplementationEnabled},e}()});function j7(){return TE||(TE=Ly(),TE)}var TE,W7=f(()=>{"use strict";s();Xl()});function ZC(){return j7().isChangeGateEnabled("SingletonAPISupport",8522442)}var z7=f(()=>{"use strict";s();Xl();W7()});function Mf(e,t){if(!ZC()){bE.set(t,e);return}var r=ev.get(t);r||(r=new Ql("ContentNavigation"),ev.set(t,r)),r.injectInstance(e)}function cg(e){if(!ZC()){var t=bE.get(e);if(!t)throw new Ie("ContentNavigationAPI not set for this APIContext",C.reserveTag(589103765));return t}var r=ev.get(e);if(!r)throw new Ie("ContentNavigationAPI not initialized for current apiContext ".concat(e,"."),C.reserveTag(507773646));return r.getInstanceOrThrow()}function al(e){var t;return ZC()?((t=ev.get(e))===null||t===void 0?void 0:t.getInstance())!==void 0:bE.has(e)}function Lf(e){var t;if(!ZC()){bE.delete(e);return}(t=ev.get(e))===null||t===void 0||t.reset()}var bE,ev,G7=f(()=>{"use strict";s();te();ib();z7();bE=new Map,ev=new Map});var q7=f(()=>{"use strict";s();V7();G7()});var K7=f(()=>{"use strict";s();O7();q7()});var Y7=f(()=>{"use strict";s();K7()});var $7,Q7=f(()=>{"use strict";s();$7=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(t){},e.prototype.moveFocus=function(t){},e.prototype.bringContentIntoView=function(t){},e}()});var X7=f(()=>{"use strict";s();Q7()});var Md=f(()=>{"use strict";s();Y7();X7()});var OF,Xn,Hf=f(()=>{"use strict";s();(function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(OF||(OF={}));Xn=OF});function Yxe(e){return Object.values(Xt).includes(e)}function J7(e){return Yxe(e)?e:Xt.None}var Xt,Ld=f(()=>{"use strict";s();(function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"})(Xt||(Xt={}))});var NF,vn,ug=f(()=>{"use strict";s();(function(e){e[e.Editing=0]="Editing",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"})(NF||(NF={}));vn=NF});var SE,$xe,Z7,ez=f(()=>{"use strict";s();k();rt();Z();SE=I(L()),$xe=function(t,r,n){if(n.details.componentInstanceId===t){if(n.details.componentKey!==r){v().assertConditionTag(!1,"componentInstanceId and componentName are out of sync",589951873);return}switch(n.command){case"UpdateComponentDataProps":return{resource:n.updatedComponentDataProps.resource?m({},n.updatedComponentDataProps.resource):void 0,maximumDimensions:m({},n.updatedComponentDataProps.maximumDimensions),isVirtualized:n.updatedComponentDataProps.isVirtualized,accessibilityMetadata:n.updatedComponentDataProps.accessibilityMetadata};case"Focus":return}}},Z7=function(e){X(t,e);function t(r){var n,o=e.call(this,r)||this;return o.handleComponentCommand=function(a){var d=$xe(o.componentInstanceId,o.props.componentName,a);d&&o.setState(d)},o.componentInstanceId=(n=o.props.componentInstanceId)!==null&&n!==void 0?n:ao(),o.state={resource:o.props.resource,maximumDimensions:o.props.maximumDimensions,isVirtualized:o.props.isVirtualized,accessibilityMetadata:o.props.accessibilityMetadata},o}return t.prototype.componentDidMount=function(){var r=this;this.registrationToken=this.props.onComponentCommand.subscribe(function(n){r.handleComponentCommand(n)})},t.prototype.componentWillUnmount=function(){var r;(r=this.registrationToken)===null||r===void 0||r.unsubscribe()},t.prototype.render=function(){var r=this.props.InnerHostableComponent;return SE.createElement(r,m({},this.state,{componentRef:this.props.componentRef,componentInstanceId:this.componentInstanceId}))},t}(SE.PureComponent)});var MF,tz,rz=f(()=>{"use strict";s();MF=I(dn()),tz=MF.AppRegistry.registerComponent.bind(MF.AppRegistry)});var Bf,LF=f(()=>{"use strict";s();(function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"})(Bf||(Bf={}))});var nz,oz,iz=f(()=>{"use strict";s();nz=I(_t()),oz=function(){function e(t,r){var n=this;this.componentName=t,this._registryInstance=r,this.onComponentCommand=new nz.EventImpl(function(){}),this._registryInstance.onComponentCommand.subscribe(function(o){o.details.componentKey===n.componentName&&n.onComponentCommand.trigger(o)})}return e.prototype.unregister=function(){this.onComponentCommand.unsubscribeAll(),this._registryInstance.unregisterComponent(this.componentName)},e}()});var az,sz,dz=f(()=>{"use strict";s();az=I(_t()),sz=function(){function e(t,r){var n=this;this._componentName=t,this._registryInstance=r,this.onStateChanged=new az.EventImpl(function(){}),this._registryInstance.onComponentStateChanged.subscribe(function(o){o.componentName===n._componentName&&n.onStateChanged.trigger(o.state)})}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}()});var HF,cz,uz=f(()=>{"use strict";s();k();HF=I(_t());LF();iz();dz();cz=function(){function e(){this.componentMap={},this.onComponentStateChanged=new HF.EventImpl(function(){}),this.onComponentCommand=new HF.EventImpl(function(){})}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(t,r){return this.componentMap[t]=r,this.onComponentStateChanged.trigger({componentName:t,state:Bf.Registered}),new oz(t,this)},e.prototype.unregisterComponent=function(t){delete this.componentMap[t],this.onComponentStateChanged.trigger({componentName:t,state:Bf.Unregistered})},e.prototype.getComponent=function(t){return Gt(this,void 0,void 0,function(){return gt(this,function(r){return[2,new sz(t,this)]})})},e}()});var lz,fz=f(()=>{"use strict";s();lz={ComponentRegistryHostService:["SDX::ComponentRegistry::ComponentRegistryHostService",{dispatchComponentCommand:["FireAndForgetMethod",[["$union",["SDX::ComponentRegistry::FocusCommandArgs","SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs"]]]]}]}});var pz,mz=f(()=>{"use strict";s();pz=I(_t());pz.CustomTypeRegistry.registerTypeInfos({"SDX::ComponentRegistry::SharedComponentCommandDetails":{componentKey:"$string",componentInstanceId:"$string"},"SDX::ComponentRegistry::FocusCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails"},"SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails",updatedComponentDataProps:"SDX::ComponentRegistry::HostableComponentDataProps"}})});var gz,hz,yz=f(()=>{"use strict";s();gz=I(_t());fz();mz();hz=function(){function e(t){this._parentServiceProvider=t}return e.getInstance=function(){return this.instance},e.register=function(t){var r=this;this.instance||(this.instance=new e(t),gz.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return r.instance}}))},e.prototype.dispatchComponentCommand=function(t){this._parentServiceProvider.onComponentCommand.trigger(t)},e.ServiceInfo=lz.ComponentRegistryHostService,e}()});var IE,Cz,vz=f(()=>{"use strict";s();k();IE=I(L());ez();rz();uz();yz();Cz=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initialize=function(){hz.register(this)},t.prototype.registerComponent=function(r,n){var o=this,a=IE.forwardRef(function(d,c){return IE.createElement(Z7,m({},d,{componentRef:d.componentRef||c,InnerHostableComponent:n,componentName:r,onComponentCommand:o.onComponentCommand}))});return tz(r,function(){return a}),e.prototype.registerComponent.call(this,r,a)},t}(cz)});function tv(){if(BF===void 0){var e=new Cz;e.initialize(),BF=e}return BF}var BF,xz=f(()=>{"use strict";s();vz()});var Tz=f(()=>{"use strict";s();xz()});var lg,bz=f(()=>{"use strict";s();(function(e){e[e.Unspecified=0]="Unspecified",e[e.Trap=1]="Trap",e[e.DoNotTrap=2]="DoNotTrap"})(lg||(lg={}))});var Sz=f(()=>{"use strict";s();bz();LF()});var UF=f(()=>{"use strict";s();Tz();Sz()});var Uf,VF=f(()=>{"use strict";s();(function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"})(Uf||(Uf={}))});var Ez=Re((cct,Iz)=>{s();Iz.exports={SharedCommentsVersion:"3.74.4"}});var Xxe,Jxe,EE,jF=f(()=>{"use strict";s();Xxe=Ez(),Jxe=Xxe.SharedCommentsVersion,EE=Jxe});function Zxe(){this.__data__=[],this.size=0}var Pz,_z=f(()=>{"use strict";s();Pz=Zxe});function eTe(e,t){return e===t||e!==e&&t!==t}var fg,PE=f(()=>{"use strict";s();fg=eTe});function tTe(e,t){for(var r=e.length;r--;)if(fg(e[r][0],t))return r;return-1}var sl,rv=f(()=>{"use strict";s();PE();sl=tTe});function oTe(e){var t=this.__data__,r=sl(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():nTe.call(t,r,1),--this.size,!0}var rTe,nTe,Rz,Az=f(()=>{"use strict";s();rv();rTe=Array.prototype,nTe=rTe.splice;Rz=oTe});function iTe(e){var t=this.__data__,r=sl(t,e);return r<0?void 0:t[r][1]}var kz,Dz=f(()=>{"use strict";s();rv();kz=iTe});function aTe(e){return sl(this.__data__,e)>-1}var wz,Fz=f(()=>{"use strict";s();rv();wz=aTe});function sTe(e,t){var r=this.__data__,n=sl(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Oz,Nz=f(()=>{"use strict";s();rv();Oz=sTe});function pg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var dl,nv=f(()=>{"use strict";s();_z();Az();Dz();Fz();Nz();pg.prototype.clear=Pz;pg.prototype.delete=Rz;pg.prototype.get=kz;pg.prototype.has=wz;pg.prototype.set=Oz;dl=pg});function dTe(){this.__data__=new dl,this.size=0}var Mz,Lz=f(()=>{"use strict";s();nv();Mz=dTe});function cTe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Hz,Bz=f(()=>{"use strict";s();Hz=cTe});function uTe(e){return this.__data__.get(e)}var Uz,Vz=f(()=>{"use strict";s();Uz=uTe});function lTe(e){return this.__data__.has(e)}var jz,Wz=f(()=>{"use strict";s();jz=lTe});var fTe,_E,WF=f(()=>{"use strict";s();fTe=typeof global=="object"&&global&&global.Object===Object&&global,_E=fTe});var pTe,mTe,xo,Hd=f(()=>{"use strict";s();WF();pTe=typeof self=="object"&&self&&self.Object===Object&&self,mTe=_E||pTe||Function("return this")(),xo=mTe});var gTe,bi,mg=f(()=>{"use strict";s();Hd();gTe=xo.Symbol,bi=gTe});function CTe(e){var t=hTe.call(e,ov),r=e[ov];try{e[ov]=void 0;var n=!0}catch(a){}var o=yTe.call(e);return t?e[ov]=r:delete e[ov],o}var zz,hTe,yTe,ov,Gz,qz=f(()=>{"use strict";s();mg();zz=Object.prototype,hTe=zz.hasOwnProperty,yTe=zz.toString,ov=bi?bi.toStringTag:void 0;Gz=CTe});function TTe(e){return xTe.call(e)}var vTe,xTe,Kz,Yz=f(()=>{"use strict";s();vTe=Object.prototype,xTe=vTe.toString;Kz=TTe});function ITe(e){return e==null?e===void 0?STe:bTe:$z&&$z in Object(e)?Gz(e):Kz(e)}var bTe,STe,$z,Ls,gg=f(()=>{"use strict";s();mg();qz();Yz();bTe="[object Null]",STe="[object Undefined]",$z=bi?bi.toStringTag:void 0;Ls=ITe});function ETe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Hs,hg=f(()=>{"use strict";s();Hs=ETe});function kTe(e){if(!Hs(e))return!1;var t=Ls(e);return t==_Te||t==RTe||t==PTe||t==ATe}var PTe,_Te,RTe,ATe,RE,zF=f(()=>{"use strict";s();gg();hg();PTe="[object AsyncFunction]",_Te="[object Function]",RTe="[object GeneratorFunction]",ATe="[object Proxy]";RE=kTe});var DTe,AE,Qz=f(()=>{"use strict";s();Hd();DTe=xo["__core-js_shared__"],AE=DTe});function wTe(e){return!!Xz&&Xz in e}var Xz,Jz,Zz=f(()=>{"use strict";s();Qz();Xz=function(){var e=/[^.]+$/.exec(AE&&AE.keys&&AE.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();Jz=wTe});function NTe(e){if(e!=null){try{return OTe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var FTe,OTe,Hc,GF=f(()=>{"use strict";s();FTe=Function.prototype,OTe=FTe.toString;Hc=NTe});function WTe(e){if(!Hs(e)||Jz(e))return!1;var t=RE(e)?jTe:LTe;return t.test(Hc(e))}var MTe,LTe,HTe,BTe,UTe,VTe,jTe,e9,t9=f(()=>{"use strict";s();zF();Zz();hg();GF();MTe=/[\\^$.*+?()[\]{}|]/g,LTe=/^\[object .+?Constructor\]$/,HTe=Function.prototype,BTe=Object.prototype,UTe=HTe.toString,VTe=BTe.hasOwnProperty,jTe=RegExp("^"+UTe.call(VTe).replace(MTe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e9=WTe});function zTe(e,t){return e==null?void 0:e[t]}var r9,n9=f(()=>{"use strict";s();r9=zTe});function GTe(e,t){var r=r9(e,t);return e9(r)?r:void 0}var Wi,cl=f(()=>{"use strict";s();t9();n9();Wi=GTe});var qTe,ul,kE=f(()=>{"use strict";s();cl();Hd();qTe=Wi(xo,"Map"),ul=qTe});var KTe,Bc,iv=f(()=>{"use strict";s();cl();KTe=Wi(Object,"create"),Bc=KTe});function YTe(){this.__data__=Bc?Bc(null):{},this.size=0}var o9,i9=f(()=>{"use strict";s();iv();o9=YTe});function $Te(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var a9,s9=f(()=>{"use strict";s();a9=$Te});function ZTe(e){var t=this.__data__;if(Bc){var r=t[e];return r===QTe?void 0:r}return JTe.call(t,e)?t[e]:void 0}var QTe,XTe,JTe,d9,c9=f(()=>{"use strict";s();iv();QTe="__lodash_hash_undefined__",XTe=Object.prototype,JTe=XTe.hasOwnProperty;d9=ZTe});function rbe(e){var t=this.__data__;return Bc?t[e]!==void 0:tbe.call(t,e)}var ebe,tbe,u9,l9=f(()=>{"use strict";s();iv();ebe=Object.prototype,tbe=ebe.hasOwnProperty;u9=rbe});function obe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Bc&&t===void 0?nbe:t,this}var nbe,f9,p9=f(()=>{"use strict";s();iv();nbe="__lodash_hash_undefined__";f9=obe});function yg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var qF,m9=f(()=>{"use strict";s();i9();s9();c9();l9();p9();yg.prototype.clear=o9;yg.prototype.delete=a9;yg.prototype.get=d9;yg.prototype.has=u9;yg.prototype.set=f9;qF=yg});function ibe(){this.size=0,this.__data__={hash:new qF,map:new(ul||dl),string:new qF}}var g9,h9=f(()=>{"use strict";s();m9();nv();kE();g9=ibe});function abe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var y9,C9=f(()=>{"use strict";s();y9=abe});function sbe(e,t){var r=e.__data__;return y9(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ll,av=f(()=>{"use strict";s();C9();ll=sbe});function dbe(e){var t=ll(this,e).delete(e);return this.size-=t?1:0,t}var v9,x9=f(()=>{"use strict";s();av();v9=dbe});function cbe(e){return ll(this,e).get(e)}var T9,b9=f(()=>{"use strict";s();av();T9=cbe});function ube(e){return ll(this,e).has(e)}var S9,I9=f(()=>{"use strict";s();av();S9=ube});function lbe(e,t){var r=ll(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var E9,P9=f(()=>{"use strict";s();av();E9=lbe});function Cg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var Vf,DE=f(()=>{"use strict";s();h9();x9();b9();I9();P9();Cg.prototype.clear=g9;Cg.prototype.delete=v9;Cg.prototype.get=T9;Cg.prototype.has=S9;Cg.prototype.set=E9;Vf=Cg});function fbe(e,t){var r=this.__data__;if(r instanceof dl){var n=r.__data__;if(!ul||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Vf(n)}return r.set(e,t),this.size=r.size,this}var _9,R9=f(()=>{"use strict";s();nv();kE();DE();_9=fbe});function vg(e){var t=this.__data__=new dl(e);this.size=t.size}var xg,KF=f(()=>{"use strict";s();nv();Lz();Bz();Vz();Wz();R9();vg.prototype.clear=Mz;vg.prototype.delete=Hz;vg.prototype.get=Uz;vg.prototype.has=jz;vg.prototype.set=_9;xg=vg});function mbe(e){return this.__data__.set(e,pbe),this}var pbe,A9,k9=f(()=>{"use strict";s();pbe="__lodash_hash_undefined__";A9=mbe});function gbe(e){return this.__data__.has(e)}var D9,w9=f(()=>{"use strict";s();D9=gbe});function wE(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Vf;++t<r;)this.add(e[t])}var FE,YF=f(()=>{"use strict";s();DE();k9();w9();wE.prototype.add=wE.prototype.push=A9;wE.prototype.has=D9;FE=wE});function hbe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var F9,O9=f(()=>{"use strict";s();F9=hbe});function ybe(e,t){return e.has(t)}var OE,$F=f(()=>{"use strict";s();OE=ybe});function xbe(e,t,r,n,o,a){var d=r&Cbe,c=e.length,u=t.length;if(c!=u&&!(d&&u>c))return!1;var l=a.get(e),p=a.get(t);if(l&&p)return l==t&&p==e;var g=-1,h=!0,x=r&vbe?new FE:void 0;for(a.set(e,t),a.set(t,e);++g<c;){var y=e[g],T=t[g];if(n)var b=d?n(T,y,g,t,e,a):n(y,T,g,e,t,a);if(b!==void 0){if(b)continue;h=!1;break}if(x){if(!F9(t,function(S,E){if(!OE(x,E)&&(y===S||o(y,S,r,n,a)))return x.push(E)})){h=!1;break}}else if(!(y===T||o(y,T,r,n,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var Cbe,vbe,NE,QF=f(()=>{"use strict";s();YF();O9();$F();Cbe=1,vbe=2;NE=xbe});var Tbe,XF,N9=f(()=>{"use strict";s();Hd();Tbe=xo.Uint8Array,XF=Tbe});function bbe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var M9,L9=f(()=>{"use strict";s();M9=bbe});function Sbe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Tg,ME=f(()=>{"use strict";s();Tg=Sbe});function Lbe(e,t,r,n,o,a,d){switch(r){case Mbe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Nbe:return!(e.byteLength!=t.byteLength||!a(new XF(e),new XF(t)));case Pbe:case _be:case kbe:return fg(+e,+t);case Rbe:return e.name==t.name&&e.message==t.message;case Dbe:case Fbe:return e==t+"";case Abe:var c=M9;case wbe:var u=n&Ibe;if(c||(c=Tg),e.size!=t.size&&!u)return!1;var l=d.get(e);if(l)return l==t;n|=Ebe,d.set(e,t);var p=NE(c(e),c(t),n,o,a,d);return d.delete(e),p;case Obe:if(JF)return JF.call(e)==JF.call(t)}return!1}var Ibe,Ebe,Pbe,_be,Rbe,Abe,kbe,Dbe,wbe,Fbe,Obe,Nbe,Mbe,H9,JF,B9,U9=f(()=>{"use strict";s();mg();N9();PE();QF();L9();ME();Ibe=1,Ebe=2,Pbe="[object Boolean]",_be="[object Date]",Rbe="[object Error]",Abe="[object Map]",kbe="[object Number]",Dbe="[object RegExp]",wbe="[object Set]",Fbe="[object String]",Obe="[object Symbol]",Nbe="[object ArrayBuffer]",Mbe="[object DataView]",H9=bi?bi.prototype:void 0,JF=H9?H9.valueOf:void 0;B9=Lbe});function Hbe(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var bg,LE=f(()=>{"use strict";s();bg=Hbe});var Bbe,en,Xa=f(()=>{"use strict";s();Bbe=Array.isArray,en=Bbe});function Ube(e,t,r){var n=t(e);return en(e)?n:bg(n,r(e))}var HE,ZF=f(()=>{"use strict";s();LE();Xa();HE=Ube});function Vbe(e,t){for(var r=-1,n=e==null?0:e.length,o=0,a=[];++r<n;){var d=e[r];t(d,r,e)&&(a[o++]=d)}return a}var V9,j9=f(()=>{"use strict";s();V9=Vbe});function jbe(){return[]}var BE,e1=f(()=>{"use strict";s();BE=jbe});var Wbe,zbe,W9,Gbe,UE,t1=f(()=>{"use strict";s();j9();e1();Wbe=Object.prototype,zbe=Wbe.propertyIsEnumerable,W9=Object.getOwnPropertySymbols,Gbe=W9?function(e){return e==null?[]:(e=Object(e),V9(W9(e),function(t){return zbe.call(e,t)}))}:BE,UE=Gbe});function qbe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var z9,G9=f(()=>{"use strict";s();z9=qbe});function Kbe(e){return e!=null&&typeof e=="object"}var Bs,Sg=f(()=>{"use strict";s();Bs=Kbe});function $be(e){return Bs(e)&&Ls(e)==Ybe}var Ybe,r1,q9=f(()=>{"use strict";s();gg();Sg();Ybe="[object Arguments]";r1=$be});var K9,Qbe,Xbe,Jbe,Ig,VE=f(()=>{"use strict";s();q9();Sg();K9=Object.prototype,Qbe=K9.hasOwnProperty,Xbe=K9.propertyIsEnumerable,Jbe=r1(function(){return arguments}())?r1:function(e){return Bs(e)&&Qbe.call(e,"callee")&&!Xbe.call(e,"callee")},Ig=Jbe});function Zbe(){return!1}var Y9,$9=f(()=>{"use strict";s();Y9=Zbe});var J9,Q9,eSe,X9,tSe,rSe,sv,n1=f(()=>{"use strict";s();Hd();$9();J9=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Q9=J9&&typeof module=="object"&&module&&!module.nodeType&&module,eSe=Q9&&Q9.exports===J9,X9=eSe?xo.Buffer:void 0,tSe=X9?X9.isBuffer:void 0,rSe=tSe||Y9,sv=rSe});function iSe(e,t){var r=typeof e;return t=t??nSe,!!t&&(r=="number"||r!="symbol"&&oSe.test(e))&&e>-1&&e%1==0&&e<t}var nSe,oSe,Eg,jE=f(()=>{"use strict";s();nSe=9007199254740991,oSe=/^(?:0|[1-9]\d*)$/;Eg=iSe});function sSe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=aSe}var aSe,Pg,WE=f(()=>{"use strict";s();aSe=9007199254740991;Pg=sSe});function wSe(e){return Bs(e)&&Pg(e.length)&&!!Ur[Ls(e)]}var dSe,cSe,uSe,lSe,fSe,pSe,mSe,gSe,hSe,ySe,CSe,vSe,xSe,TSe,bSe,SSe,ISe,ESe,PSe,_Se,RSe,ASe,kSe,DSe,Ur,Z9,eG=f(()=>{"use strict";s();gg();WE();Sg();dSe="[object Arguments]",cSe="[object Array]",uSe="[object Boolean]",lSe="[object Date]",fSe="[object Error]",pSe="[object Function]",mSe="[object Map]",gSe="[object Number]",hSe="[object Object]",ySe="[object RegExp]",CSe="[object Set]",vSe="[object String]",xSe="[object WeakMap]",TSe="[object ArrayBuffer]",bSe="[object DataView]",SSe="[object Float32Array]",ISe="[object Float64Array]",ESe="[object Int8Array]",PSe="[object Int16Array]",_Se="[object Int32Array]",RSe="[object Uint8Array]",ASe="[object Uint8ClampedArray]",kSe="[object Uint16Array]",DSe="[object Uint32Array]",Ur={};Ur[SSe]=Ur[ISe]=Ur[ESe]=Ur[PSe]=Ur[_Se]=Ur[RSe]=Ur[ASe]=Ur[kSe]=Ur[DSe]=!0;Ur[dSe]=Ur[cSe]=Ur[TSe]=Ur[uSe]=Ur[bSe]=Ur[lSe]=Ur[fSe]=Ur[pSe]=Ur[mSe]=Ur[gSe]=Ur[hSe]=Ur[ySe]=Ur[CSe]=Ur[vSe]=Ur[xSe]=!1;Z9=wSe});function FSe(e){return function(t){return e(t)}}var tG,rG=f(()=>{"use strict";s();tG=FSe});var nG,dv,OSe,o1,NSe,i1,oG=f(()=>{"use strict";s();WF();nG=typeof exports=="object"&&exports&&!exports.nodeType&&exports,dv=nG&&typeof module=="object"&&module&&!module.nodeType&&module,OSe=dv&&dv.exports===nG,o1=OSe&&_E.process,NSe=function(){try{var e=dv&&dv.require&&dv.require("util").types;return e||o1&&o1.binding&&o1.binding("util")}catch(t){}}(),i1=NSe});var iG,MSe,zE,a1=f(()=>{"use strict";s();eG();rG();oG();iG=i1&&i1.isTypedArray,MSe=iG?tG(iG):Z9,zE=MSe});function BSe(e,t){var r=en(e),n=!r&&Ig(e),o=!r&&!n&&sv(e),a=!r&&!n&&!o&&zE(e),d=r||n||o||a,c=d?z9(e.length,String):[],u=c.length;for(var l in e)(t||HSe.call(e,l))&&!(d&&(l=="length"||o&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Eg(l,u)))&&c.push(l);return c}var LSe,HSe,GE,s1=f(()=>{"use strict";s();G9();VE();Xa();n1();jE();a1();LSe=Object.prototype,HSe=LSe.hasOwnProperty;GE=BSe});function VSe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||USe;return e===r}var USe,qE,d1=f(()=>{"use strict";s();USe=Object.prototype;qE=VSe});function jSe(e,t){return function(r){return e(t(r))}}var KE,c1=f(()=>{"use strict";s();KE=jSe});var WSe,aG,sG=f(()=>{"use strict";s();c1();WSe=KE(Object.keys,Object),aG=WSe});function qSe(e){if(!qE(e))return aG(e);var t=[];for(var r in Object(e))GSe.call(e,r)&&r!="constructor"&&t.push(r);return t}var zSe,GSe,dG,cG=f(()=>{"use strict";s();d1();sG();zSe=Object.prototype,GSe=zSe.hasOwnProperty;dG=qSe});function KSe(e){return e!=null&&Pg(e.length)&&!RE(e)}var fl,cv=f(()=>{"use strict";s();zF();WE();fl=KSe});function YSe(e){return fl(e)?GE(e):dG(e)}var Uc,uv=f(()=>{"use strict";s();s1();cG();cv();Uc=YSe});function $Se(e){return HE(e,Uc,UE)}var u1,uG=f(()=>{"use strict";s();ZF();t1();uv();u1=$Se});function ZSe(e,t,r,n,o,a){var d=r&QSe,c=u1(e),u=c.length,l=u1(t),p=l.length;if(u!=p&&!d)return!1;for(var g=u;g--;){var h=c[g];if(!(d?h in t:JSe.call(t,h)))return!1}var x=a.get(e),y=a.get(t);if(x&&y)return x==t&&y==e;var T=!0;a.set(e,t),a.set(t,e);for(var b=d;++g<u;){h=c[g];var S=e[h],E=t[h];if(n)var P=d?n(E,S,h,t,e,a):n(S,E,h,e,t,a);if(!(P===void 0?S===E||o(S,E,r,n,a):P)){T=!1;break}b||(b=h=="constructor")}if(T&&!b){var _=e.constructor,D=t.constructor;_!=D&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof D=="function"&&D instanceof D)&&(T=!1)}return a.delete(e),a.delete(t),T}var QSe,XSe,JSe,lG,fG=f(()=>{"use strict";s();uG();QSe=1,XSe=Object.prototype,JSe=XSe.hasOwnProperty;lG=ZSe});var eIe,YE,pG=f(()=>{"use strict";s();cl();Hd();eIe=Wi(xo,"DataView"),YE=eIe});var tIe,$E,mG=f(()=>{"use strict";s();cl();Hd();tIe=Wi(xo,"Promise"),$E=tIe});var rIe,pl,l1=f(()=>{"use strict";s();cl();Hd();rIe=Wi(xo,"Set"),pl=rIe});var nIe,QE,gG=f(()=>{"use strict";s();cl();Hd();nIe=Wi(xo,"WeakMap"),QE=nIe});var hG,oIe,yG,CG,vG,xG,iIe,aIe,sIe,dIe,cIe,jf,f1,TG=f(()=>{"use strict";s();pG();kE();mG();l1();gG();gg();GF();hG="[object Map]",oIe="[object Object]",yG="[object Promise]",CG="[object Set]",vG="[object WeakMap]",xG="[object DataView]",iIe=Hc(YE),aIe=Hc(ul),sIe=Hc($E),dIe=Hc(pl),cIe=Hc(QE),jf=Ls;(YE&&jf(new YE(new ArrayBuffer(1)))!=xG||ul&&jf(new ul)!=hG||$E&&jf($E.resolve())!=yG||pl&&jf(new pl)!=CG||QE&&jf(new QE)!=vG)&&(jf=function(t){var r=Ls(t),n=r==oIe?t.constructor:void 0,o=n?Hc(n):"";if(o)switch(o){case iIe:return xG;case aIe:return hG;case sIe:return yG;case dIe:return CG;case cIe:return vG}return r});f1=jf});function fIe(e,t,r,n,o,a){var d=en(e),c=en(t),u=d?SG:f1(e),l=c?SG:f1(t);u=u==bG?XE:u,l=l==bG?XE:l;var p=u==XE,g=l==XE,h=u==l;if(h&&sv(e)){if(!sv(t))return!1;d=!0,p=!1}if(h&&!p)return a||(a=new xg),d||zE(e)?NE(e,t,r,n,o,a):B9(e,t,u,r,n,o,a);if(!(r&uIe)){var x=p&&IG.call(e,"__wrapped__"),y=g&&IG.call(t,"__wrapped__");if(x||y){var T=x?e.value():e,b=y?t.value():t;return a||(a=new xg),o(T,b,r,n,a)}}return h?(a||(a=new xg),lG(e,t,r,n,o,a)):!1}var uIe,bG,SG,XE,lIe,IG,EG,PG=f(()=>{"use strict";s();KF();QF();U9();fG();TG();Xa();n1();a1();uIe=1,bG="[object Arguments]",SG="[object Array]",XE="[object Object]",lIe=Object.prototype,IG=lIe.hasOwnProperty;EG=fIe});function _G(e,t,r,n,o){return e===t?!0:e==null||t==null||!Bs(e)&&!Bs(t)?e!==e&&t!==t:EG(e,t,r,n,_G,o)}var _g,JE=f(()=>{"use strict";s();PG();Sg();_g=_G});function pIe(e,t){return _g(e,t)}var Vc,p1=f(()=>{"use strict";s();JE();Vc=pIe});function Wf(e,t,r){var n=We(r);if(n)return n.threadId!==e?cr.InOtherCard:Kt()&&n.renderContextType!==t?cr.InOtherContextOfThisCard:n.commentDraft.sessionConfiguration.sessionType==="EDIT"?cr.InChildPost:cr.InCard}var ZE=f(()=>{"use strict";s();ue();xt();Rd()});function e0(e,t,r){var n;if(nr(t))return t.find(function(u){var l;return u===e||((l=r[u])===null||l===void 0?void 0:l.alternateId)===e});for(var o=new Uu(t,-1),a;!(a=o.next()).done;){var d=a.value.commentId,c=r[d];if((c==null?void 0:c.alternateId)===e||d===e)break}return(n=a.value)===null||n===void 0?void 0:n.commentId}function AG(e,t,r){var n=Mr(t,e);return n?Qm(t,r,$e(n)):[]}function t0(e,t,r,n,o,a,d){var c,u;if(!ir()){if(o&&d===e)return{thread:[o.newComment_deprecated],isDraftThread:!0,draftThreadState:a};v().assertConditionTag(!a||!a.isInCurrentContext||a.commentDraft.sessionConfiguration.sessionType!=="CREATE","Bad Store State, missing lie for new draft requested.",579372370)}var l=n||e,p=Qm(t,r,l);p.length>0&&yr(p[0])===void 0&&((u=(c=v()).logDiagnosticTrace)===null||u===void 0||u.call(c,Mt(RG||(RG=qt(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),C.reserveTag(540575834),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary)),p=[]);var g=ir()&&d===l;return{thread:p,isDraftThread:g,draftThreadState:g?a:void 0}}function r0(e,t,r,n,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===A.None||t.draftThreadState.renderContextType===n?gn.Enabled_ForcePrimary:gn.Disabled;if(t.isDraftThread||t.thread.length>0)return o===cr.InCard||o===cr.InChildPost?gn.Enabled_ForcePrimary:gn.Enabled_Default;if(dF(r))return gn.Disabled;var a=We(r);return a&&a.threadId===e?gn.Disabled:gn.Invalid}var RG,n0=f(()=>{"use strict";s();k();te();rt();Z();Do();_I();di();ue();xt();Rn();mo();Rd();Be()});function o0(){return m1||(m1=cw(hS,Vc)),m1}var m1,Bd,kG,DG,wG,FG,i0,a0,s0,d0,OG,NG,MG,LG,HG,BG,UG,g1=f(()=>{"use strict";s();Do();p1();Pm();ZE();n0();Qo();Qo();Et();el();m1=void 0,Bd=function(t,r){var n,o;return(o=(n=r.resource)===null||n===void 0?void 0:n.id)!==null&&o!==void 0?o:""},kG=function(t,r){return r.componentTree.componentTreeId.renderContextType},DG=function(){return _n([Bd,Vi],function(t,r){return r[t]})},wG=function(){return _n([Bd,rE],function(t,r){return r===t})},FG=function(){return o0()([Bd,ve],function(t,r){return(r==null?void 0:r.selectedCardId)===t?r:void 0})},i0=function(){return _n([Bd,kG,fe],function(t,r,n){return Wf(t,r,n)})},a0=function(){return _n([Bd,kn,Vi],function(t,r,n){return e0(t,r,n)})},s0=function(){return _n([Bd,fe],function(t,r){return r.drafts[t]})},d0=function(t,r,n,o){return _n([Bd,Ft,Yn,o,t,n,r],function(a,d,c,u,l,p,g){return t0(a,d,c,u,l,p,g)})},OG=function(t){return o0()([t,nE],function(r,n){return r.thread.reduce(function(o,a){return o[a.commentId]=n[a.commentId],o},{})})},NG=function(t){return o0()([t,eE],function(r,n){var o={};return r&&r.history.forEach(function(a){a.records.forEach(function(d){var c=Qu(r.id,d.recordId);o[c]=n[c]})}),o})},MG=function(t,r){return _n([Bd,t,fe,kG,r],function(n,o,a,d,c){return r0(n,o,a,d,c)})},LG=function(t){return _n([t],function(r){return Yy(r)})},HG=function(){return _n([Bd,Xo],function(t,r){return r[t]})},BG=function(t,r){return o0()([t,r],function(n,o){return $u(n.thread,o)})},UG=function(){return _n([Bd,fe],function(t,r){return r.cardIdToDraftIdMap[t]===t})}});var Jn,lv=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.MetadataOnly=1]="MetadataOnly",e[e.Any=2]="Any"})(Jn||(Jn={}))});var zi,Gi,fv=f(()=>{"use strict";s();(function(e){e[e.AllCardsTabbable=0]="AllCardsTabbable",e[e.ExpandedCardTabbable=1]="ExpandedCardTabbable",e[e.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",e[e.SelectedCardTabbable=3]="SelectedCardTabbable"})(zi||(zi={}));(function(e){e[e.AllPostsTabbable=0]="AllPostsTabbable",e[e.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",e[e.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",e[e.SelectedPostTabbable=3]="SelectedPostTabbable"})(Gi||(Gi={}))});function h1(e,t,r,n,o){if(!nt()){var a=v().createActivityObject("SelectionAttemptWhileDrafting",r,be());a.addDataField("Trackback",n,N.SystemMetadata),a.addDataField("RenderContextType",o,N.SystemMetadata),a.addDataField("SelectionAttemptType",e,N.SystemMetadata),a.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,N.SystemMetadata),a.successTag(590206682)}}var jG=f(()=>{"use strict";s();Z();ue()});var y1,WG,zG=f(()=>{"use strict";s();(function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"})(y1||(y1={}));WG=y1});var Fn,c0=f(()=>{"use strict";s();(function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"})(Fn||(Fn={}))});function pv(e,t){var r=We(e);if(!r)return v().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),$t(t)?ur.ClosePaneDraft:ur.CancelNewDraft;switch(r.commentDraft.sessionConfiguration.sessionType){case"CREATE":return ur.CancelNewDraft;case"EDIT":return ur.CancelPostEdit;case"REPLY":return ur.CancelReplyDraft;case"METADATA":return v().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),ur.CancelNewDraft}}var C1=f(()=>{"use strict";s();Z();xt();Wm();gi()});var Us,v1,mv=f(()=>{"use strict";s();xt();Vu();Be();C1();Us=function(t,r,n,o,a){return t&&r===A.HalfPane&&a===void 0&&(!o||o.selectedCardId===Je(n,!0,r))},v1=function(t,r,n,o){if(n&&kd(t)===Lr.CannotAutoDiscard){var a=o??pv(t,r.componentTreeId.renderContextType);return function(d,c){return n(a,d,c)}}}});var GG=f(()=>{"use strict";s()});function gv(e){var t=e.comment,r=e.threads,n=e.selectedComment,o=e.warningType,a=!t.parentId,d=!!(t.commentFlags&Fe.LowFidelity);if(!n)return a&&o===Bt.DeleteThread&&(d||jC(r,t.commentId))?!0:le()&&d&&a;var c=d||a&&(o===Bt.DeleteReply||o===Bt.DeleteThread)&&jC(r,t.commentId),u=Xe(n.selectionDetails)?n.selectionDetails.selectedPostId:n.selectedCardId;return!!(c&&(u!==t.commentId||n.selectionDetails.lowFidelityWarningType!==o))}function qG(e){var t=e.result,r=e.localizationAPI;t===xi.Success&&si(r.getString(67))}function mIe(e){var t=e.componentTree,r=e.focusManager,n=e.lieIndex,o=e.cardId,a=e.isReplyDraft,d=e.discardCallback,c=function(l,p){if(d){var g=function(){return r.onUserAction(t,{userAction:Fn.CancelNewThreadDraft,threadIndex:n}),l?l():He.Unhandled};return d(g,p)}return l?(a?r.onUserAction(t,{userAction:Fn.CancelReplyDraft,cardId:o}):r.onUserAction(t,{userAction:Fn.CancelNewThreadDraft,threadIndex:n}),Promise.resolve(l())):Promise.resolve(He.Unhandled)};return c}function Rg(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.renderContextType,d=e.actionDispatchers,c=e.telemetryVisitor,u=e.localizationAPI,l=Ka(n,r);if(!l){v().assertConditionTag(!1,"Comment not found",593826117);return}if(gv({comment:l,threads:n,selectedComment:o,warningType:Bt.DeleteReply})){d.showLowFidelityWarning({renderContextType:a,telemetryVisitor:c,trackback:C.reserveTag(593826118)},r,Bt.DeleteReply);return}si(u.getString(65)),d.requestDeleteComment({renderContextType:a,telemetryVisitor:c,trackback:t},r)}function u0(e){var t=e.trackback,r=e.id,n=e.data,o=e.renderContextType,a=e.actionDispatchers,d=e.telemetryVisitor,c=Ka(n,r);if(!c){v().assertConditionTag(!1,"Comment not found",593875075);return}a.showPostErrorUI({renderContextType:o,telemetryVisitor:d,trackback:t},c.commentId)}function l0(e){var t=e.trackback,r=e.id,n=e.data,o=e.renderContextType,a=e.actionDispatchers,d=e.telemetryVisitor,c=Ka(n,r);if(!c){v().assertConditionTag(!1,"Comment not found",593875076);return}a.clearPostErrorUI({renderContextType:o,telemetryVisitor:d,trackback:t},c.commentId)}function Ag(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.renderContextType,d=e.actionDispatchers,c=e.telemetryVisitor,u=Ka(n,r);if(!u){v().assertConditionTag(!1,"Comment not found",593826119);return}if(gv({comment:u,threads:n,selectedComment:o,warningType:Bt.Edit})){d.showLowFidelityWarning({renderContextType:a,telemetryVisitor:c,trackback:C.reserveTag(593826120)},r,Bt.Edit);return}d.requestEditCommentSession({renderContextType:a,telemetryVisitor:c,trackback:t},r,u.parentId||u.commentId)}function kg(e){var t=e.trackback,r=e.id,n=e.data,o=e.draftState,a=e.contentPromise,d=e.atMentionsEnabled,c=e.componentTree,u=e.actionDispatchers,l=e.telemetryVisitor,p=e.localizationAPI,g=e.commitSource;if(hi(o))return Promise.resolve();if(!o.postIdToDraftIdMap[r])return v().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new he("Post draft to commit not found",C.reserveTag(587850403),-2130957492));var h=Ka(n,r);return h?u.commitCommentAndFocus({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:l,trackback:t},function(){return a},{commentId:r,type:"EDIT",previousCommentBody:h.commentBody},d,c,$e(h),g).then(function(x){qG({result:x,localizationAPI:p})}).catch(pe(C.reserveTag(593826122))):(v().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new he("Comment not found in model",C.reserveTag(587850432),2130957505)))}function Dg(e){var t=e.trackback,r=e.renderableItem,n=e.selectedComment,o=e.cardCollapsedState,a=e.dispatchProps,d=e.telemetryVisitor,c=e.componentTree,u=e.draftState_deprecated,l=e.shouldFocusAfter,p=Fo(r),g=yo(r);return a.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:d,trackback:C.reserveTag(593237586)},ce.SharedComments,void 0).then(function(h){if(!nt()&&h.draftDiscardBehavior===Lr.CannotAutoDiscard&&(!n||!Xe(n.selectionDetails)||n.selectionDetails.selectedPostId!==g)){var x=We(u);x&&h1(2,x,d,C.reserveTag(590206683),c.componentTreeId.renderContextType)}else{var y=o===At.Collapsed;a.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:d,trackback:t},sg(p,ce.SharedComments,y?{selectType:Ee.ExpandCard}:{selectType:Ee.SelectPost,selectedPost:g}),l||y).catch(pe(C.reserveTag(590104649)))}},pe(C.reserveTag(593032901)))}function zf(e){var t=e.trackback,r=e.commentId,n=e.setContents,o=e.data,a=e.draftState,d=e.shouldClosePaneAfterDiscardDraft,c=e.onWillDiscardCallback,u=e.renderContextType,l=e.dispatchProps,p=e.telemetryVisitor,g=e.localizationAPI,h=Ka(o,r);if(!a.postIdToDraftIdMap[r]||!h){v().assertConditionTag(!1,"Cannot find comment post to cancel",593826126);return}si(g.getString(66)),l.discardDraftAsync({renderContextType:u,telemetryVisitor:p,trackback:t},ce.SharedComments,d,c).then(function(x){x===He.Handled&&h&&n&&n(h.commentBody)}).catch(pe(C.reserveTag(593826127)))}function f0(e){var t=e.cardProps,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentCardMounted(r,t)})}function p0(e){var t=e.cardId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentCardEditorMounted(r,t)})}function m0(e){var t=e.postId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentPostMounted(r,t)})}function g0(e){var t=e.postId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentPostEditorMounted(r,t)})}function wg(e){var t=e.trackback,r=e.threadId,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:n,telemetryVisitor:a,trackback:t},r)}function h0(e){var t=e.trackback,r=e.commentCardRef,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.collapseCard({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId())}function y0(e){var t=e.trackback,r=e.commentCardRef,n=e.dispatchProps,o=e.telemetryVisitor,a=e.componentTree,d=e.options,c=e.focusManager,u=e.isDraftThread,l={componentType:Nf(u),id:r.getId(),renderContextType:a.componentTreeId.renderContextType},p=function(){mn&&Pt("Handling card focus with polite selection on ".concat(r.getId())),a.isFocusOnOrWithin(l)&&Gf({trackback:t,commentCardRef:r,dispatchProps:n,telemetryVisitor:o,componentTree:a,options:d})};c.postOnComponentFocusedRequest(l,p)}function Gf(e){var t=e.trackback,r=e.commentCardRef,n=e.dispatchProps,o=e.telemetryVisitor,a=e.componentTree,d=e.options,c=!1,u,l=d.selectActionType;switch(l){case Ee.ExpandCard:var p=d,g=p.selectRootPost&&(nt()||!p.relativeDraftingState);c=p.shouldFocusAfter,u=g?{selectType:Ee.SelectPost,selectedPost:r.getId()}:{selectType:Ee.ExpandCard};break;case Ee.SelectCard:case Ee.Polite:u={selectType:l};break;default:Ne(l)}var h=sg(r.getId(),ce.SharedComments,u);d.selectActionType===Ee.ExpandCard&&n.discardDraftIfEmpty({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:o,trackback:C.reserveTag(571281760)},ce.SharedComments,void 0).then(function(x){if(!nt()&&x.draftDiscardBehavior===Lr.CannotAutoDiscard&&d.relativeDraftingState===cr.InOtherCard){var y=We(d.draftState);y&&h1(1,y,o,C.reserveTag(571281761),a.componentTreeId.renderContextType)}}).catch(pe(C.reserveTag(571281762))),n.selectComment(a,{renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:o,trackback:t},h,c).catch(pe(C.reserveTag(571340118)))}function C0(e){var t=e.trackback,r=e.commentCardRef,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,d=e.shouldHighlightCard;d?o.highlightComment({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId()):o.clearCommentHighlight({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId())}function v0(e){var t=e.trackback,r=e.focusManager,n=e.componentTree,o=e.cardId,a=e.isCardLie,d=e.newHeight,c=e.renderContextType,u=e.selectedComment,l=e.dispatchProps,p=e.telemetryVisitor;if(c===A.HalfPane){if(typeof d>"u")return v().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);var g=a&&u&&u.selectedCardId===o;g&&l.requestDisplayConfiguration({renderContextType:c,telemetryVisitor:p,trackback:t},{displayMode:po.Variable,desiredHeight:d}).then(function(){r.focusCommentPaneCommand(n)}).catch(pe(C.reserveTag(593826130)))}}function x0(e){var t=e.trackback,r=e.id,n=e.draftState,o=e.renderContextType,a=e.dispatchProps,d=e.telemetryVisitor;if(Y()==="android"){var c=n.drafts[n.cardIdToDraftIdMap[r]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===Ko&&a.discardDraftAsync({renderContextType:o,telemetryVisitor:d,trackback:t},ce.SharedComments,!1)}}function ml(e){var t,r=e.trackback,n=e.showDiscardDialog,o=e.invokeModalDialog,a=e.componentTree,d=e.dispatchProps,c=e.closeOnDiscard,u=e.cardId,l=e.draftState,p=e.telemetryVisitor,g=e.localizationAPI,h=e.focusManager,x=e.lieIndex,y=l.cardIdToDraftIdMap[u];if(!y){v().assertConditionTag(!1,"Card draft to cancel not found",588853382);return}var T=void 0;n&&(T=v1(l,a,o));var b=((t=l.drafts[y])===null||t===void 0?void 0:t.commentDraft.sessionConfiguration.sessionType)===Ko,S=mIe({componentTree:a,focusManager:h,lieIndex:x,cardId:u,isReplyDraft:b,discardCallback:T});si(g.getString(b?64:103)),d.discardDraftAsync({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:p,trackback:r},ce.SharedComments,c,S).then(function(E){E===He.Handled&&(b?h.onUserAction(a,{userAction:Fn.CancelReplyDraft,cardId:u}):h.onUserAction(a,{userAction:Fn.CancelNewThreadDraft,threadIndex:x}))},pe(C.reserveTag(592840735)))}function Fg(e){var t=e.trackback,r=e.commentCardRef,n=e.draftState,o=e.areMentionsEnabled,a=e.session,d=e.componentTree,c=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,p=e.commitSource;if(hi(n))return Promise.resolve();var g=r.getId();return n.cardIdToDraftIdMap[g]?c.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:d.componentTreeId.renderContextType},r.getContentsAsync,a,o,d,g,p).then(function(h){qG({result:h,localizationAPI:l})}).catch(pe(C.reserveTag(593826134))):(v().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new he("Card draft to commit not found",C.reserveTag(587850433),-2130957492)))}function Og(e){var t=e.trackback,r=e.id,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,d=e.localizationAPI,c=e.isTask;si(d.getString(125)),o.requestReopenThread({renderContextType:n,telemetryVisitor:a,trackback:t},r,c)}function qf(e){var t=e.componentTree,r=e.focusManager,n=e.trackback,o=e.id,a=e.renderContextType,d=e.dispatchProps,c=e.telemetryVisitor,u=e.localizationAPI,l=e.isTask;si(u.getString(124)),r.onUserAction(t,{userAction:Fn.ResolveThread,cardId:o}),d.requestResolveThread({renderContextType:a,telemetryVisitor:c,trackback:n},o,l)}function Ng(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.componentTree,d=e.invokeModalDialog,c=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,p=e.focusManager,g=e.isTask,h=e.threadIndex,x=e.shouldCheckForLowFidelity;if(x){var y=Ka(n,r);if(!y){v().assertConditionTag(!1,"Comment not found",593605342);return}if(gv({comment:y,threads:n,selectedComment:o,warningType:Bt.DeleteThread})){c.selectCommentCardAndShowLowFidelityWarning({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:C.reserveTag(593605343)},y.commentId,Bt.DeleteThread);return}}if(a.componentTreeId.renderContextType===A.HalfPane&&d){var T=function(){return hIe({dispatchProps:c,componentTree:a,selectedComment:o,telemetryVisitor:u})};d(ur.DeleteThread,T,function(){return He.Canceled}).then(function(b){b===He.Handled&&p.onUserAction(a,{userAction:Fn.DeleteThread,threadIndex:h})}).catch(pe(C.reserveTag(595632546)));return}si(l.getString(63)),p.onUserAction(a,{userAction:Fn.DeleteThread,threadIndex:h}),YI(a.componentTreeId.renderContextType)?setTimeout(function(){c.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:t},r,g)},100):c.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:t},r,g)}function T0(e){var t=e.componentTree,r=e.focusManager,n=e.trackback,o=e.id,a=e.renderContextType,d=e.dispatchProps,c=e.telemetryVisitor,u=e.localizationAPI;qf({componentTree:t,focusManager:r,trackback:n,id:o,renderContextType:a,dispatchProps:d,telemetryVisitor:c,localizationAPI:u,isTask:!0})}function b0(e){var t=e.failTag,r=e.successTag,n=e.person,o=e.dispatchProps,a=e.telemetryVisitor,d=e.renderContextType,c=e.trackback,u=v().createActivityObject("CheckUserAccess",a,be()),l={UserId:Ss(n),Provider:mE,DisplayName:Du(n),Email:Ss(n)};o.checkUserAccess(l).then(function(p){var g;u.addDataField("UserCanWrite",p.UserCanWrite,N.SystemMetadata),u.addDataField("UserCanReview",(g=p==null?void 0:p.UserCanReview)!==null&&g!==void 0?g:!1,N.SystemMetadata),u.successTag(r)},function(p){u.failTag(t,-2130957562)}),o.addToCurrentMentionees({telemetryVisitor:a,trackback:c,renderContextType:d},n)}function Mg(e){var t=e.trackback,r=e.contentId,n=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,d=e.actionDispatchers,c=e.telemetryVisitor,u=a[r];u&&d.draftEmptinessChanged({renderContextType:o,telemetryVisitor:c,trackback:t},u,n)}function Lg(e){var t=e.trackback,r=e.id,n=e.editor,o=e.renderContextType,a=e.draftIdMap,d=e.draftMap,c=e.actionDispatchers,u=e.telemetryVisitor,l=a[r];if(l){var p=d[l];Gn(p,"Draft should be defined if draftId exists!",C.reserveTag(587850434)),p.pendingState===Hi.None&&c.saveDraft({renderContextType:o,telemetryVisitor:u,trackback:t},l,{editorContent:n.getContentsAsync(),editorCursorPosition:n.getCursorPositionAsync()})}}function S0(e){var t=e.trackback,r=e.emailsStillInDraft,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:n,telemetryVisitor:a,trackback:t},r)}function I0(e){var t=e.trackback,r=e.renderContextType,n=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;n.updateSelectedTaskAssignee({renderContextType:r,telemetryVisitor:o,trackback:t},a)}function E0(e){var t=e.selectedState,r=e.renderContextType,n=e.dispatchProps,o=e.telemetryVisitor;if(!t||!Rs(t)){v().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658);return}n.clearLowFidelityWarning({renderContextType:r,telemetryVisitor:o,trackback:C.reserveTag(573612046)})}function P0(e){var t=e.selectedState,r=e.onCardDelete,n=e.onPostDelete,o=e.onPostEdit;if(!t){v().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661);return}if(!Xe(t.selectionDetails)||EC(t)){if(Xw(t)){var a=t.selectedCardId;r(a);return}if(Tf(t)){v().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662);return}}else{var a=t.selectionDetails.selectedPostId;if(Vm(t)){n(a);return}if(Tf(t)){o(a);return}}}function hv(e){var t=e.ownProps,r=e.dispatchProps,n=e.componentTree,o=e.draftState,a=e.invokeModalDialog;if(n.componentTreeId.renderContextType!==A.HalfPane&&$o(o)&&!Kt()){var d=function(u){u===He.Canceled?void 0:u===He.Unhandled&&v().assertConditionTag(u!==He.Unhandled,"Unhandled request to discard on close pane",592840769)};r.discardDraftAsync({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:C.reserveTag(592840770)},ce.SharedComments,!0,v1(o,n,a,ur.ClosePaneDraft)).then(d).catch(pe(C.reserveTag(592840771)))}else gIe({dispatchProps:r,componentTree:n,telemetryVisitor:t.telemetryVisitor})}function gIe(e){var t=e.dispatchProps,r=e.componentTree,n=e.telemetryVisitor,o=v().createActivityObject("ClosePane",n,be());o.addDataField("PaneCloseResult",WG.NoDialog,N.SystemMetadata),o.successTag(592840773),t.requestClosePane({renderContextType:r.componentTreeId.renderContextType,telemetryVisitor:n,trackback:C.reserveTag(592840774)})}function hIe(e){var t=e.dispatchProps,r=e.componentTree,n=e.selectedComment,o=e.telemetryVisitor;return n?(t.requestDeleteThread({renderContextType:r.componentTreeId.renderContextType,telemetryVisitor:o,trackback:C.reserveTag(592840775)},n.selectedCardId),He.Handled):(v().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),He.Unhandled)}function _0(e,t,r,n,o){r.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:n,trackback:e},Fo(t))}function R0(e,t,r,n){if(!(lr(n)&&!nt()&&Y()!=="win32")){var o=Fo(e);r.focusCommentCardCommand(t,o)}}function A0(e,t,r,n,o,a,d){o.requestUpdateCommentReactions({renderContextType:n,telemetryVisitor:a,trackback:e},t,d,r)}function k0(e,t,r,n,o){n.requestPresentLinkToComment({renderContextType:r,telemetryVisitor:o,trackback:e},t)}var yv=f(()=>{"use strict";s();te();Z();Cm();Dc();Ic();pd();di();hn();Mu();bc();Cn();tr();ue();jG();Cr();un();vE();gE();xt();Rn();ho();Od();Rd();zG();Vu();Wm();Be();Qa();c0();AF();mv();GG();Ir();gi();Qo()});var T1,Ue,gl=f(()=>{"use strict";s();(function(e){e[e.New_nonFluent=0]="New_nonFluent",e[e.Normal=1]="Normal",e[e.Editing=2]="Editing",e[e.PendingDraft=3]="PendingDraft",e[e.PendingEdit=4]="PendingEdit",e[e.EditPreCommitPending=5]="EditPreCommitPending",e[e.Resolved=6]="Resolved",e[e.LowFidelityWarningEdit=7]="LowFidelityWarningEdit",e[e.LowFidelityWarningDelete=8]="LowFidelityWarningDelete",e[e.Error=9]="Error"})(T1||(T1={}));Ue=T1});var b1,Kf,S1=f(()=>{"use strict";s();(function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"})(b1||(b1={}));Kf=b1});function I1(e,t){return e[t]=e[t]||{}}function yIe(e,t){if(t==null)return I1(e,"empty");if(typeof t=="object"||typeof t=="function"){var r=e.obj=e.obj||new WeakMap;return r.get(t)||r.set(t,{}).get(t)}var n=t+"",o=I1(e,"str");return o[n]=o[n]||{}}function E1(e,t){return t&&t.length>0?t.reduce(function(r,n){return yIe(r,n)},e):I1(e,"noargs")}var KG=f(()=>{"use strict";s()});function YG(e,t,r){var n=E1(e,r);return n.hasOwnProperty("value")||(n.value=typeof t=="function"?t():t),[n.value,function(o,a){return YG(n,o,a)}]}function No(e){var t=e?E1(CIe,[e]):{};return function(r,n){return YG(t,r,n)}}var CIe,P1=f(()=>{"use strict";s();KG();CIe={}});function Jt(e){var t=No(),r=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return t(function(){return e.apply(void 0,o)},o)[0]};return r}var $G=f(()=>{"use strict";s();P1()});var jc=f(()=>{"use strict";s();P1();$G()});function xIe(e){return typeof e=="boolean"?[{object:e},e]:typeof e=="number"?[{object:e>=0?e:!0},e!==0]:[e,!0]}function QG(e){return typeof e=="object"?Array.isArray(e)?"array":"object":typeof e}function TIe(e){return typeof e=="function"?e:typeof e=="string"?vIe[e]:void 0}function bIe(e){return e.array?{array:e.array}:{}}function SIe(e,t){return typeof e=="boolean"?e?m({object:e},t):t:typeof e=="number"?e===0?t:m({object:e-1},t):e}function IIe(e,t,r){var n=void 0,o=e[t]!==void 0?e[t]:e[r]!==void 0?e[r]:void 0;return o!==void 0&&(n=TIe(o),n===void 0&&r==="object"&&(n=SIe(o,bIe(e)))),n}function _1(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=r.filter(function(x){return x&&QG(x)==="object"&&Object.getOwnPropertyNames(x).length>0}),a=xIe(e),d=a[0],c=a[1],u=t&&o.length===1;if(o.length>1||u&&o.length===1){var l=u?void 0:Object.assign.apply(Object,w([{}],o,!1)),p=l||o[0],g=function(y){if(p.hasOwnProperty(y)){if(c){var T=p[y],b=QG(T),S=IIe(d,y,b);if(S!==void 0){var E=o.map(function(_){return _[y]}).filter(function(_){return _!==void 0}),P=typeof S=="function"?S.apply(void 0,E):_1.apply(void 0,w([S,t],E,!1));P!==T&&(l=l||Object.assign.apply(Object,w([{}],o,!1)),l[y]=P)}}!u&&l[y]===void 0&&delete l[y]}};for(var h in p)g(h);return l||p}return o.length>0?o[0]:void 0}function fa(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _1.apply(void 0,w([!0,!1],e,!1))}function Vs(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return _1.apply(void 0,w([e,!1],t,!1))}var vIe,XG=f(()=>{"use strict";s();k();vIe={appendArray:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return[].concat.apply([],t)}}});var js=f(()=>{"use strict";s();XG()});function JG(e){return Array.isArray(e)?fa.apply(void 0,e.map(function(t){return JG(t)})):e||{}}function PIe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fa.apply(void 0,e.map(function(r){return JG(r)}))}function Si(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.filter(function(n){return typeof n=="object"});return r.length>1||r.length===1&&Array.isArray(r[0])?_Ie(function(){return PIe.apply(void 0,w([void 0],r,!1))},r)[0]:r[0]||{}}var _Ie,R1=f(()=>{"use strict";s();k();js();jc();_Ie=No()});function AIe(e){return e.filter(function(t){return typeof t=="object"})}function dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vs.apply(void 0,w([RIe],AIe(e),!1))}var RIe,ZG=f(()=>{"use strict";s();k();js();R1();RIe={className:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.filter(function(n){return n&&typeof n=="string"}).join(" ")},style:Si}});var Hg=f(()=>{"use strict";s();R1();ZG()});var Jo,To,bo,eq,A1=f(()=>{"use strict";s();k();Jo=function(t){return t.colors},To=[{source:"color",lookup:Jo}],bo=[{source:"backgroundColor",lookup:Jo}],eq=w(w([],To,!0),bo,!0)});function hl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=function(o){var a={};return e.filter(function(d){return o[d]!==void 0}).forEach(function(d){a[d]=o[d]}),a};return{from:r,keys:e}}var Cv=f(()=>{"use strict";s()});var Zn,Zo,tq=f(()=>{"use strict";s();A1();Cv();Zn=[{source:"borderColor",lookup:Jo},{source:"borderWidth"},{source:"borderRadius"},{source:"borderStyle"}],Zo=hl("borderColor","borderRadius","borderStyle","borderWidth")});function fr(e,t){return e._keys=t,e}var k1=f(()=>{"use strict";s()});function kIe(e,t){return{style:tn.from(e,t)}}var tn,Ja,rq=f(()=>{"use strict";s();k1();tn={from:function(t,r){var n,o,a,d,c,u,l,p,g,h,x,y,T,b,S,E,P,_,D=t.fontDynamicTypeRamp,O=t.fontFamily,H=t.fontLetterSpacing,V=t.fontLineHeight,M=t.fontMaximumSize,G=t.fontSize,K=t.fontStyle,z=t.fontWeight,$=t.textDecorationLine,q=t.variant,re=r.typography,ae=re.families,ie=re.sizes,Te=re.weights,Oe=re.variants;return D!==void 0||O!==void 0||H!==void 0||V!==void 0||M!==void 0||G!==void 0||z!==void 0||q!==void 0?{fontFamily:(d=(o=(n=ae[O])!==null&&n!==void 0?n:O)!==null&&o!==void 0?o:ae[(a=Oe[q])===null||a===void 0?void 0:a.face])!==null&&d!==void 0?d:(c=Oe[q])===null||c===void 0?void 0:c.face,fontSize:(g=(l=(u=ie[G])!==null&&u!==void 0?u:G)!==null&&l!==void 0?l:ie[(p=Oe[q])===null||p===void 0?void 0:p.size])!==null&&g!==void 0?g:(h=Oe[q])===null||h===void 0?void 0:h.size,fontStyle:K,fontWeight:(b=(y=(x=Te[z])!==null&&x!==void 0?x:z)!==null&&y!==void 0?y:Te[(T=Oe[q])===null||T===void 0?void 0:T.weight])!==null&&b!==void 0?b:(S=Oe[q])===null||S===void 0?void 0:S.weight,lineHeight:V??((E=Oe[q])===null||E===void 0?void 0:E.lineHeight),letterSpacing:H??((P=Oe[q])===null||P===void 0?void 0:P.letterSpacing),dynamicTypeRamp:D??((_=Oe[q])===null||_===void 0?void 0:_.dynamicTypeRamp),maximumFontSize:M,textDecorationLine:$}:{}},keys:["fontDynamicTypeRamp","fontFamily","fontLineHeight","fontLetterSpacing","fontMaximumSize","fontSize","fontStyle","fontWeight","variant","textDecorationLine"]};Ja=fr(kIe,tn.keys)});var Mo,nq=f(()=>{"use strict";s();Cv();Mo=hl("width","height","minWidth","maxWidth","minHeight","maxHeight","padding","paddingHorizontal","paddingVertical","paddingStart","paddingEnd")});var oq,iq=f(()=>{"use strict";s();Cv();oq=hl("shadowColor","shadowOffset","shadowOpacity","shadowRadius")});var On=f(()=>{"use strict";s();tq();A1();rq();nq();iq();Cv();k1()});function D0(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return typeof e=="function"&&e._canCompose?e.apply(void 0,w([t],r,!1)):D1.createElement.apply(D1,w([e,t],r,!1))}var D1,w1=f(()=>{"use strict";s();k();D1=I(L())});function FIe(e){return Array.isArray(e)?e:[e]}function Nn(e,t){var r=function(a){var d=a.children,c=je(a,["children"]);return e(c)({},FIe(d))},n=t?aq.memo(r):r;return Object.assign(n,{_staged:e}),n}var aq,sq=f(()=>{"use strict";s();k();aq=I(L())});function OIe(e){return typeof e=="function"&&e._staged||void 0}function Za(e,t,r){var n=OIe(e),o=vv.useMemo(function(){var c={},u=function(p){for(var g=[],h=1;h<arguments.length;h++)g[h-1]=arguments[h];var x=c.result,y=typeof x=="function"?p:dt(x,p),T=r?Object.keys(y).filter(function(b){return!r(b)}):void 0;return(T==null?void 0:T.length)>0&&(y=dt(y,Object.assign.apply(Object,w([{}],T.map(function(b){var S;return S={},S[b]=void 0,S}),!1)))),typeof x=="function"?x.apply(void 0,w([y],g,!1)):vv.createElement.apply(vv,w([e,y],g,!1))};return u._canCompose=!0,[u,c]},[e,r]),a=o[0],d=o[1];return d.result=n?n(t):t,a}var vv,dq=f(()=>{"use strict";s();k();vv=I(L());Hg()});function Ae(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return D0.apply(void 0,w([e,t],r,!1))}var cq=f(()=>{"use strict";s();k();w1()});var xv=f(()=>{"use strict";s();w1();sq();dq();cq()});function w0(e){var t=e.slots,r=e.filters,n=r===void 0?{}:r,o=e.useStyling;return function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];var c=typeof o=="function"?o.apply(void 0,a):o||{},u={};return Object.keys(t).forEach(function(l){u[l]=Za(t[l],c[l],n[l])}),u}}var uq=f(()=>{"use strict";s();xv()});var F1=f(()=>{"use strict";s();uq()});var F0,Zt,Wc,lq=f(()=>{"use strict";s();F0=I(L()),Zt=F0.createContext(void 0),Wc=function(){return F0.useContext(Zt)}});var Yf=f(()=>{"use strict";s();lq()});function Tv(e,t,r,n){for(var o=function(l){var p,g=e[l],h=g===t[l]?void 0:g;p=r(function(){var x;return h===void 0?t:m(m({},t),(x={},x[l]=h,x))},[h]),t=p[0],r=p[1]},a=0,d=n;a<d.length;a++){var c=d[a];o(c)}return[t,r]}var fq=f(()=>{"use strict";s();k()});function yl(e,t,r,n){var o={tokens:e,subCache:r};return t&&t.length>0&&(o=t.filter(function(a){return n(a)}).reduce(function(a,d){var c=a.tokens[d],u=a.subCache(function(){return c&&typeof c=="object"?fa(a.tokens,c):a.tokens},[c]),l=u[0],p=u[1];return{tokens:l,subCache:p}},o)),[o.tokens,o.subCache]}var pq=f(()=>{"use strict";s();js()});function NIe(e,t,r){return typeof e=="string"&&(e=r&&r(t,e)||{}),typeof e=="function"&&(e=e(t)),e}function Bg(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=No(),o=function(d){return n(function(){return fa.apply(void 0,t.map(function(c){return NIe(c,d,e)}))},[d])};return o.customize=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];var c=w(w([],t,!0),a,!0);return Bg.apply(void 0,w([e],c,!1))},o}var mq=f(()=>{"use strict";s();k();js();jc()});var gq=f(()=>{"use strict";s()});function $f(e,t,r){for(var n=Object.keys(r).filter(function(u){return r[u]!==void 0}).sort(),o=function(l){var p;p=t(function(){var g;return m(m({},e),(g={},g[l]=r[l],g))},[l,r[l]]),e=p[0],t=p[1]},a=0,d=n;a<d.length;a++){var c=d[a];o(c)}return[e,t]}var hq=f(()=>{"use strict";s();k()});var bv=f(()=>{"use strict";s();fq();pq();mq();gq();hq()});function Cq(e,t){return function(r,n,o){return o(function(){return e(r,n)},(t||[]).map(function(a){return r[a]}))[0]}}function MIe(e,t){return typeof t=="object"&&Array.isArray(t)?e.filter(function(r){return t.findIndex(function(n){return n===r})!==-1}):t?e:[]}function O1(e,t){var r=Cq(e,t);return r.refine=t&&t.length>0?function(n){return Cq(e,MIe(t,n))}:void 0,r}function N1(e,t){var r={};return Object.keys(e).forEach(function(n){var o=typeof e[n]=="function"&&e[n].refine;r[n]=o?o(t):e[n]}),r}var M1=f(()=>{"use strict";s()});function LIe(e,t,r,n){var o={};return Object.keys(e).forEach(function(a){var d=e[a];o[a]=typeof d=="function"?d(t,r,n(null,[a])[1]):d}),o}function O0(e,t){var r=t.useTheme,n=t.getComponentInfo,o=e.tokens,a=e.tokensThatAreAlsoProps,d=N1(e.slotProps||{},a),c=Bg.apply(void 0,w([n],o,!1));return function(u,l){var p,g,h=r(),x=c(h),y=x[0],T=x[1];return e.states&&(p=yl(y,e.states,T,l||function(b){return u[b]}),y=p[0],T=p[1]),typeof a=="object"&&Array.isArray(a)?(g=Tv(u,y,T,a),y=g[0],T=g[1]):a==="all"&&(y=m(m({},y),u)),LIe(d,y,h,T)}}var vq=f(()=>{"use strict";s();k();bv();M1()});var L1=f(()=>{"use strict";s();vq();M1();bv()});function Sv(e,t,r){var n=r==null?void 0:r.__options;e=n?Vs(H1,n,e):B1({},e),e.useStyling=e.slotProps||e.tokens?O0(e,t):function(){return{}};var o=w0(e),a=Nn(function(d){return e.useRender(d,o)});return a.displayName=e.displayName,a.__options=e,a.customize=function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return Sv(Vs(H1,e,{tokens:d}),t)},a.compose=function(d){return Sv(Vs(H1,e,d),t)},e.statics&&Object.assign(a,e.statics),a}var B1,H1,xq=f(()=>{"use strict";s();js();xv();F1();L1();B1=function(){return B1=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},B1.apply(this,arguments)},H1={tokens:"appendArray",object:!0}});var Tq=f(()=>{"use strict";s();xq()});var Sq=Re((lvt,bq)=>{s();bq.exports={color:{anchor:{primary:"#394146",shade10:"#333a3f",shade20:"#2b3135",shade30:"#202427",shade40:"#111315",shade50:"#090a0b",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"},beige:{primary:"#7a7574",shade10:"#6e6968",shade20:"#5d5958",shade30:"#444241",shade40:"#252323",shade50:"#141313",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},berry:{primary:"#c239b3",shade10:"#af33a1",shade20:"#932b88",shade30:"#6d2064",shade40:"#3a1136",shade50:"#1f091d",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},black:"#000000",blackAlpha10:"#0000001a",blackAlpha20:"#00000033",blackAlpha30:"#0000004d",blackAlpha40:"#00000066",blackAlpha5:"#0000000d",blackAlpha50:"#00000080",blackAlpha60:"#00000099",blackAlpha70:"#000000b3",blackAlpha80:"#000000cc",blackAlpha90:"#000000e6",blue:{primary:"#0078d4",shade10:"#006cbf",shade20:"#005ba1",shade30:"#004377",shade40:"#002440",shade50:"#001322",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},brand:{10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc",primary:"#185abd",shade10:"#1651aa",shade20:"#13458f",shade30:"#0e336a",shade40:"#004578",shade50:"#043862",shade60:"#092c47",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4",tint50:"#deecf9",tint60:"#eff6fc"},brandShadowAmbient:"#0000004d",brandShadowKey:"#00000040",brass:{primary:"#986f0b",shade10:"#89640a",shade20:"#745408",shade30:"#553e06",shade40:"#2e2103",shade50:"#181202",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},bronze:{primary:"#a74109",shade10:"#963a08",shade20:"#7f3107",shade30:"#5e2405",shade40:"#321303",shade50:"#1b0a01",tint10:"#b2521e",tint20:"#bc6535",tint30:"#ca8057",tint40:"#e5bba4",tint50:"#f1d9cc",tint60:"#fbf5f2"},brown:{primary:"#8e562e",shade10:"#804d29",shade20:"#6c4123",shade30:"#50301a",shade40:"#2b1a0e",shade50:"#170e07",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},burgundy:{primary:"#a4262c",shade10:"#942228",shade20:"#7d1d21",shade30:"#5c1519",shade40:"#310b0d",shade50:"#1a0607",tint10:"#af393e",tint20:"#ba4d52",tint30:"#c86c70",tint40:"#e4afb2",tint50:"#f0d3d4",tint60:"#fbf4f4"},charcoal:{primary:"#393939",shade10:"#333333",shade20:"#2b2b2b",shade30:"#202020",shade40:"#111111",shade50:"#090909",tint10:"#515151",tint20:"#686868",tint30:"#888888",tint40:"#c4c4c4",tint50:"#dfdfdf",tint60:"#f7f7f7"},cornflower:{primary:"#4f6bed",shade10:"#4760d5",shade20:"#3c51b4",shade30:"#2c3c85",shade40:"#182047",shade50:"#0d1126",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},cranberry:{primary:"#c50f1f",shade10:"#b10e1c",shade20:"#960b18",shade30:"#6e0811",shade40:"#3b0509",shade50:"#200205",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},cyan:{primary:"#0099bc",shade10:"#008aa9",shade20:"#00748f",shade30:"#005669",shade40:"#002e38",shade50:"#00181e",tint10:"#18a4c4",tint20:"#31afcc",tint30:"#56bfd7",tint40:"#a4deeb",tint50:"#cdedf4",tint60:"#f2fafc"},darkBlue:{primary:"#003966",shade10:"#00335c",shade20:"#002b4e",shade30:"#002039",shade40:"#00111f",shade50:"#000910",tint10:"#0e4a78",tint20:"#215c8b",tint30:"#4178a3",tint40:"#92b5d1",tint50:"#c2d6e7",tint60:"#eff4f9"},darkBrown:{primary:"#4d291c",shade10:"#452519",shade20:"#3a1f15",shade30:"#2b1710",shade40:"#170c08",shade50:"#0c0704",tint10:"#623a2b",tint20:"#784d3e",tint30:"#946b5c",tint40:"#caada3",tint50:"#e3d2cb",tint60:"#f8f3f2"},darkGreen:{primary:"#0b6a0b",shade10:"#0a5f0a",shade20:"#085108",shade30:"#063b06",shade40:"#032003",shade50:"#021102",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},darkOrange:{primary:"#da3b01",shade10:"#c43501",shade20:"#a62d01",shade30:"#7a2101",shade40:"#411200",shade50:"#230900",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},darkPurple:{primary:"#401b6c",shade10:"#3a1861",shade20:"#311552",shade30:"#240f3c",shade40:"#130820",shade50:"#0a0411",tint10:"#512b7e",tint20:"#633e8f",tint30:"#7e5ca7",tint40:"#b9a3d3",tint50:"#d8cce7",tint60:"#f5f2f9"},darkRed:{primary:"#750b1c",shade10:"#690a19",shade20:"#590815",shade30:"#420610",shade40:"#230308",shade50:"#130204",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},darkTeal:{primary:"#006666",shade10:"#005c5c",shade20:"#004e4e",shade30:"#003939",shade40:"#001f1f",shade50:"#001010",tint10:"#0e7878",tint20:"#218b8b",tint30:"#41a3a3",tint40:"#92d1d1",tint50:"#c2e7e7",tint60:"#eff9f9"},excel:{primary:"#107c41",shade10:"#0f703b",shade20:"#0c5f32",shade30:"#094624",shade40:"#094624",shade50:"#052912",shade60:"#03160a",tint10:"#218d51",tint20:"#55b17e",tint30:"#a0d8b9",tint40:"#caead8",tint50:"#a0d8b9",tint60:"#caead8"},forest:{primary:"#498205",shade10:"#427505",shade20:"#376304",shade30:"#294903",shade40:"#162702",shade50:"#0c1501",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},gold:{primary:"#c19c00",shade10:"#ae8c00",shade20:"#937700",shade30:"#6c5700",shade40:"#3a2f00",shade50:"#1f1900",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},grape:{primary:"#881798",shade10:"#7a1589",shade20:"#671174",shade30:"#4c0d55",shade40:"#29072e",shade50:"#160418",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},green:{primary:"#107c10",shade10:"#0e700e",shade20:"#0c5e0c",shade30:"#094509",shade40:"#052505",shade50:"#031403",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},grey10:"#1a1a1a",grey10Alpha10:"#1a1a1a1a",grey10Alpha20:"#1a1a1a33",grey10Alpha30:"#1a1a1a4d",grey10Alpha40:"#1a1a1a66",grey10Alpha5:"#1a1a1a0d",grey10Alpha50:"#1a1a1a80",grey10Alpha60:"#1a1a1a99",grey10Alpha70:"#1a1a1ab3",grey10Alpha80:"#1a1a1acc",grey10Alpha90:"#1a1a1ae6",grey12:"#1f1f1f",grey12Alpha10:"#1f1f1f1a",grey12Alpha20:"#1f1f1f33",grey12Alpha30:"#1f1f1f4d",grey12Alpha40:"#1f1f1f66",grey12Alpha5:"#1f1f1f0d",grey12Alpha50:"#1f1f1f80",grey12Alpha60:"#1f1f1f99",grey12Alpha70:"#1f1f1fb3",grey12Alpha80:"#1f1f1fcc",grey12Alpha90:"#1f1f1fe6",grey14:"#242424",grey14Alpha10:"#2424241a",grey14Alpha20:"#24242433",grey14Alpha30:"#2424244d",grey14Alpha40:"#24242466",grey14Alpha5:"#2424240d",grey14Alpha50:"#24242480",grey14Alpha60:"#24242499",grey14Alpha70:"#242424b3",grey14Alpha80:"#242424cc",grey14Alpha90:"#242424e6",grey16:"#292929",grey18:"#2e2e2e",grey2:"#050505",grey20:"#333333",grey22:"#383838",grey24:"#3d3d3d",grey26:"#424242",grey28:"#474747",grey30:"#4d4d4d",grey32:"#525252",grey34:"#575757",grey36:"#5c5c5c",grey38:"#616161",grey4:"#0a0a0a",grey40:"#666666",grey42:"#6b6b6b",grey44:"#707070",grey46:"#757575",grey48:"#7a7a7a",grey50:"#808080",grey52:"#858585",grey54:"#8a8a8a",grey56:"#8f8f8f",grey58:"#949494",grey6:"#0f0f0f",grey60:"#999999",grey62:"#9e9e9e",grey64:"#a3a3a3",grey66:"#a8a8a8",grey68:"#adadad",grey70:"#b3b3b3",grey72:"#b8b8b8",grey74:"#bdbdbd",grey76:"#c2c2c2",grey78:"#c7c7c7",grey8:"#141414",grey80:"#cccccc",grey82:"#d1d1d1",grey84:"#d6d6d6",grey86:"#dbdbdb",grey88:"#e0e0e0",grey90:"#e6e6e6",grey92:"#ebebeb",grey94:"#f0f0f0",grey96:"#f5f5f5",grey98:"#fafafa",hotPink:{primary:"#e3008c",shade10:"#cc007e",shade20:"#ad006a",shade30:"#7f004e",shade40:"#44002a",shade50:"#240016",tint10:"#e61c99",tint20:"#ea38a6",tint30:"#ee5fb7",tint40:"#f7adda",tint50:"#fbd2eb",tint60:"#fef4fa"},lavender:{primary:"#7160e8",shade10:"#6656d1",shade20:"#5649b0",shade30:"#3f3682",shade40:"#221d46",shade50:"#120f25",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},lightBlue:{primary:"#3a96dd",shade10:"#3487c7",shade20:"#2c72a8",shade30:"#20547c",shade40:"#112d42",shade50:"#091823",tint10:"#4fa1e1",tint20:"#65ade5",tint30:"#83bdeb",tint40:"#bfddf5",tint50:"#dcedfa",tint60:"#f6fafe"},lightGreen:{primary:"#13a10e",shade10:"#11910d",shade20:"#0e7a0b",shade30:"#0b5a08",shade40:"#063004",shade50:"#031a02",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},lightTeal:{primary:"#00b7c3",shade10:"#00a5af",shade20:"#008b94",shade30:"#00666d",shade40:"#00373a",shade50:"#001d1f",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},lilac:{primary:"#b146c2",shade10:"#9f3faf",shade20:"#863593",shade30:"#63276d",shade40:"#35153a",shade50:"#1c0b1f",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},lime:{primary:"#73aa24",shade10:"#689920",shade20:"#57811b",shade30:"#405f14",shade40:"#23330b",shade50:"#121b06",tint10:"#81b437",tint20:"#90be4c",tint30:"#a4cc6c",tint40:"#cfe5af",tint50:"#e5f1d3",tint60:"#f8fcf4"},magenta:{primary:"#bf0077",shade10:"#ac006b",shade20:"#91005a",shade30:"#6b0043",shade40:"#390024",shade50:"#1f0013",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},marigold:{primary:"#eaa300",shade10:"#d39300",shade20:"#b27c00",shade30:"#835b00",shade40:"#463100",shade50:"#251a00",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},mink:{primary:"#5d5a58",shade10:"#54514f",shade20:"#474443",shade30:"#343231",shade40:"#1c1b1a",shade50:"#0f0e0e",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},navy:{primary:"#0027b4",shade10:"#0023a2",shade20:"#001e89",shade30:"#001665",shade40:"#000c36",shade50:"#00061d",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},neutralShadowAmbient:"#0000001f",neutralShadowAmbientDarker:"#00000033",neutralShadowAmbientLighter:"#0000000f",neutralShadowKey:"#00000024",neutralShadowKeyDarker:"#0000003d",neutralShadowKeyLighter:"#00000012",office:{primary:"#d83b01",shade10:"#c33400",shade20:"#a52c00",shade30:"#792000",shade40:"#792000",shade50:"#4d2415",shade60:"#29130b",tint10:"#dd4f1b",tint20:"#e8825d",tint30:"#f4beaa",tint40:"#f9dcd1",tint50:"#f4beaa",tint60:"#f9dcd1"},oneNote:{primary:"#80397b",shade10:"#6c2f68",shade20:"#52254f",shade30:"#3c1a3a",shade40:"#430e60",shade50:"#430e60",shade60:"#430e60",tint10:"#9e5499",tint20:"#d4a9d1",tint30:"#e0bfde",tint40:"#f0daee",tint50:"#e6d1f2",tint60:"#e6d1f2"},orange:{primary:"#f7630c",shade10:"#de590b",shade20:"#bc4b09",shade30:"#8a3707",shade40:"#4a1e04",shade50:"#271002",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},orchid:{primary:"#8764b8",shade10:"#795aa6",shade20:"#674c8c",shade30:"#4c3867",shade40:"#281e37",shade50:"#16101d",tint10:"#9373c0",tint20:"#a083c9",tint30:"#b29ad4",tint40:"#d7caea",tint50:"#e9e2f4",tint60:"#f9f8fc"},outlook:{primary:"#0078d4",shade10:"#106ebe",shade20:"#1664a7",shade30:"#135995",shade40:"#004578",shade50:"#043862",shade60:"#092c47",tint10:"#2488d8",tint20:"#69afe5",tint30:"#b3d6f2",tint40:"#cce3f5",tint50:"#deecf9",tint60:"#eff6fc"},peach:{primary:"#ff8c00",shade10:"#e67e00",shade20:"#c26a00",shade30:"#8f4e00",shade40:"#4d2a00",shade50:"#291600",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},pink:{primary:"#e43ba6",shade10:"#cd3595",shade20:"#ad2d7e",shade30:"#80215d",shade40:"#441232",shade50:"#24091b",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},platinum:{primary:"#69797e",shade10:"#5f6d71",shade20:"#505c60",shade30:"#3b4447",shade40:"#1f2426",shade50:"#111314",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},plum:{primary:"#77004d",shade10:"#6b0045",shade20:"#5a003b",shade30:"#43002b",shade40:"#240017",shade50:"#13000c",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},powerPoint:{primary:"#c43e1c",shade10:"#b13719",shade20:"#952f15",shade30:"#6e220f",shade40:"#6e220f",shade50:"#3c1805",shade60:"#200d03",tint10:"#cb5031",tint20:"#dc816a",tint30:"#edbcb0",tint40:"#f6dbd4",tint50:"#edbcb0",tint60:"#f6dbd4"},pumpkin:{primary:"#ca5010",shade10:"#b6480e",shade20:"#9a3d0c",shade30:"#712d09",shade40:"#3d1805",shade50:"#200d03",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},purple:{primary:"#5c2e91",shade10:"#532982",shade20:"#46236e",shade30:"#341a51",shade40:"#1c0e2b",shade50:"#0f0717",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},red:{primary:"#d13438",shade10:"#bc2f32",shade20:"#9f282b",shade30:"#751d1f",shade40:"#3f1011",shade50:"#210809",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},royalBlue:{primary:"#004e8c",shade10:"#00467e",shade20:"#003b6a",shade30:"#002c4e",shade40:"#00172a",shade50:"#000c16",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},seafoam:{primary:"#00cc6a",shade10:"#00b85f",shade20:"#009b51",shade30:"#00723b",shade40:"#003d20",shade50:"#002111",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},silver:{primary:"#859599",shade10:"#78868a",shade20:"#657174",shade30:"#4a5356",shade40:"#282d2e",shade50:"#151818",tint10:"#92a1a5",tint20:"#a0aeb1",tint30:"#b3bfc2",tint40:"#d8dfe0",tint50:"#eaeeef",tint60:"#fafbfb"},steel:{primary:"#005b70",shade10:"#005265",shade20:"#004555",shade30:"#00333f",shade40:"#001b22",shade50:"#000f12",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},teal:{primary:"#038387",shade10:"#037679",shade20:"#026467",shade30:"#02494c",shade40:"#012728",shade50:"#001516",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},white:"#ffffff",whiteAlpha10:"#ffffff1a",whiteAlpha20:"#ffffff33",whiteAlpha30:"#ffffff4d",whiteAlpha40:"#ffffff66",whiteAlpha5:"#ffffff0d",whiteAlpha50:"#ffffff80",whiteAlpha60:"#ffffff99",whiteAlpha70:"#ffffffb3",whiteAlpha80:"#ffffffcc",whiteAlpha90:"#ffffffe6",word:{primary:"#185abd",shade10:"#1651aa",shade20:"#13458f",shade30:"#0e336a",shade40:"#0e336a",shade50:"#0c2145",shade60:"#071225",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4",tint50:"#aec6eb",tint60:"#d2e0f4"},yellow:{primary:"#fde300",shade10:"#e4cc00",shade20:"#c0ad00",shade30:"#817400",shade40:"#4c4400",shade50:"#282400",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},hcButtonFace:"PlatformColor(ButtonFace)",hcButtonText:"PlatformColor(ButtonText)",hcCanvas:"PlatformColor(Window)",hcCanvasText:"PlatformColor(WindowText)",hcDisabled:"PlatformColor(GrayText)",hcHighlight:"PlatformColor(Highlight)",hcHighlightText:"PlatformColor(HighlightText)",hcHyperlink:"PlatformColor(Hotlight)"},corner:{radius120:12,radius20:2,radius40:4,radius60:6,radius80:8,radiusCircular:9999,radiusNone:0},font:{family:{base:"Segoe UI",monospace:"Consolas",numeric:"Bahnschrift"},lineHeight100:14,lineHeight1000:92,lineHeight200:16,lineHeight300:20,lineHeight400:22,lineHeight500:26,lineHeight600:32,lineHeight700:36,lineHeight800:40,lineHeight900:52,size100:10,size1000:68,size200:12,size300:14,size400:16,size500:20,size600:24,size700:28,size800:32,size900:40,weight:{bold:"700",medium:"500",regular:"400",semibold:"600"}},size100:10,size120:12,size1200:120,size160:16,size20:2,size200:20,size240:24,size280:28,size320:32,size360:36,size40:4,size400:40,size480:48,size560:56,size60:6,size640:64,size720:72,size80:8,size800:80,sizeNone:0,stroke:{width05:.5,width10:1,width15:1.5,width20:2,width30:3,width40:4,width60:6,widthNone:0}}});var Iq,F,Eq=f(()=>{"use strict";s();Iq=I(Sq()),F=Iq.default});var U1=Re((gvt,Pq)=>{s();Pq.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var Rq=Re((yvt,_q)=>{s();_q.exports={brandBackground:{rest:"#1651aa",hover:"#185abd",pressed:"#004578",selected:"#13458f"},brandBackground2:{rest:"#004578"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#6794d7"},brandForeground2:{rest:"#aec6eb"},brandForegroundLink:{rest:"#2e6ac5",hover:"#aec6eb",pressed:"#6794d7",selected:"#2e6ac5"},brandStroke1:{rest:"#2e6ac5"},brandStroke2:{rest:"#0e336a"},compoundBrandBackground1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},compoundBrandForeground1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},compoundBrandStroke1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},neutralBackground1:{rest:"#292929",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},neutralBackground2:{rest:"#1f1f1f",hover:"#333333",pressed:"#141414",selected:"#2e2e2e"},neutralBackground3:{rest:"#141414",hover:"#292929",pressed:"#0a0a0a",selected:"#242424"},neutralBackground4:{rest:"#0a0a0a",hover:"#1f1f1f",pressed:"#000000",selected:"#1a1a1a"},neutralBackground5:{rest:"#000000",hover:"#141414",pressed:"#050505",selected:"#0f0f0f"},neutralBackground6:{rest:"#333333"},neutralBackgroundDisabled:{rest:"#141414"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#d6d6d6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#6794d7",brandPressed:"#2e6ac5",brandSelected:"#6794d7",selected:"#ffffff"},neutralForeground3:{rest:"#adadad",hover:"#d6d6d6",pressed:"#d6d6d6",brandHover:"#6794d7",brandPressed:"#2e6ac5",brandSelected:"#6794d7",selected:"#d6d6d6"},neutralForeground4:{rest:"#999999"},neutralForegroundDisabled:{rest:"#5c5c5c"},neutralForegroundInverted:{rest:"#242424"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#333333"},neutralStencil2:{rest:"#575757"},neutralStroke1:{rest:"#666666",hover:"#757575",pressed:"#6b6b6b",selected:"#707070"},neutralStroke2:{rest:"#525252"},neutralStroke3:{rest:"#3d3d3d"},neutralStrokeAccessible:{rest:"#adadad",hover:"#bdbdbd",pressed:"#b3b3b3",selected:"#6794d7"},neutralStrokeDisabled:{rest:"#424242"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtleBackground:{rest:"#00000000",hover:"#383838",pressed:"#2e2e2e",selected:"#333333"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var kq=Re((vvt,Aq)=>{s();Aq.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var wq=Re((Tvt,Dq)=>{s();Dq.exports={brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#004578",selected:"#13458f"},brandBackground2:{rest:"#eff6fc"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#185abd"},brandForeground2:{rest:"#1651aa"},brandForegroundLink:{rest:"#1651aa",hover:"#13458f",pressed:"#004578",selected:"#1651aa"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#d2e0f4"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},compoundBrandForeground1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},dangerBackground1:{rest:"#fdf6f6"},dangerBackground2:{rest:"#f1bbbc"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#f1bbbc"},dangerBorder2:{rest:"#d13438"},dangerBorderActive:{rest:"#d13438"},dangerForeground1:{rest:"#bc2f32"},dangerForeground2:{rest:"#751d1f"},dangerForeground3:{rest:"#d13438"},dangerForegroundInverted:{rest:"#dc5e62"},neutralBackground1:{rest:"#ffffff",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},neutralBackground2:{rest:"#fafafa",hover:"#f0f0f0",pressed:"#dbdbdb",selected:"#e6e6e6"},neutralBackground3:{rest:"#f5f5f5",hover:"#ebebeb",pressed:"#d6d6d6",selected:"#e0e0e0"},neutralBackground4:{rest:"#f0f0f0",hover:"#fafafa",pressed:"#f5f5f5",selected:"#ffffff"},neutralBackground5:{rest:"#ebebeb",hover:"#f5f5f5",pressed:"#f0f0f0",selected:"#fafafa"},neutralBackground6:{rest:"#e6e6e6"},neutralBackgroundDisabled:{rest:"#f0f0f0"},neutralBackgroundInverted:{rest:"#616161"},neutralForeground1:{rest:"#242424",hover:"#242424",pressed:"#242424",selected:"#242424"},neutralForeground2:{rest:"#424242",hover:"#242424",pressed:"#242424",brandHover:"#185abd",brandPressed:"#1651aa",brandSelected:"#185abd",selected:"#242424"},neutralForeground3:{rest:"#616161",hover:"#424242",pressed:"#424242",brandHover:"#185abd",brandPressed:"#1651aa",brandSelected:"#185abd",selected:"#424242"},neutralForeground4:{rest:"#707070"},neutralForegroundDisabled:{rest:"#bdbdbd"},neutralForegroundInverted:{rest:"#ffffff"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#e6e6e6"},neutralStencil2:{rest:"#fafafa"},neutralStroke1:{rest:"#d1d1d1",hover:"#c7c7c7",pressed:"#b3b3b3",selected:"#bdbdbd"},neutralStroke2:{rest:"#e0e0e0"},neutralStroke3:{rest:"#f0f0f0"},neutralStrokeAccessible:{rest:"#616161",hover:"#575757",pressed:"#4d4d4d",selected:"#185abd"},neutralStrokeDisabled:{rest:"#e0e0e0"},outofofficeBackground1:{rest:"#fdf5fc"},outofofficeBackground2:{rest:"#edbbe7"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#edbbe7"},outofofficeBorder2:{rest:"#c239b3"},outofofficeBorderActive:{rest:"#c239b3"},outofofficeForeground1:{rest:"#af33a1"},outofofficeForeground2:{rest:"#6d2064"},outofofficeForeground3:{rest:"#c239b3"},severeBackground1:{rest:"#fdf6f3"},severeBackground2:{rest:"#f4bfab"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#f4bfab"},severeBorder2:{rest:"#da3b01"},severeBorderActive:{rest:"#da3b01"},severeForeground1:{rest:"#c43501"},severeForeground2:{rest:"#7a2101"},severeForeground3:{rest:"#da3b01"},strokeFocus1:{rest:"#ffffff"},strokeFocus2:{rest:"#000000"},subtleBackground:{rest:"#00000000",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},successBackground1:{rest:"#f1faf1"},successBackground2:{rest:"#9fd89f"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#9fd89f"},successBorder2:{rest:"#107c10"},successBorderActive:{rest:"#107c10"},successForeground1:{rest:"#0e700e"},successForeground2:{rest:"#094509"},successForeground3:{rest:"#107c10"},successForegroundInverted:{rest:"#359b35"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#fffef5"},warningBackground2:{rest:"#fef7b2"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fef7b2"},warningBorder2:{rest:"#fde300"},warningBorderActive:{rest:"#fde300"},warningForeground1:{rest:"#817400"},warningForeground2:{rest:"#817400"},warningForeground3:{rest:"#fde300"},warningForegroundInverted:{rest:"#fef7b2"}}});var Oq=Re((Svt,Fq)=>{s();Fq.exports={shadow16:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:8,blur:16}],shadow2:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:1,blur:2}],shadow28:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:14,blur:28}],shadow4:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:2,blur:4}],shadow64:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:32,blur:64}],shadow8:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var M0=Re(N0=>{"use strict";s();Object.defineProperty(N0,"__esModule",{value:!0});function Nq(e,t){if(t)return e;throw new Error("Unhandled discriminated union member: "+JSON.stringify(e))}N0.assertNever=Nq;N0.default=Nq});var V1=Re((_vt,Mq)=>{s();Mq.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"PlatformColor(ButtonFace)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},brandBackground2:{rest:"PlatformColor(ButtonFace)"},brandBackgroundStatic:{rest:"PlatformColor(Window)"},brandForeground1:{rest:"PlatformColor(WindowText)"},brandForeground2:{rest:"PlatformColor(ButtonText)"},brandForegroundLink:{rest:"PlatformColor(Hotlight)",hover:"PlatformColor(Hotlight)",pressed:"PlatformColor(Hotlight)",selected:"PlatformColor(Hotlight)"},brandStroke1:{rest:"PlatformColor(WindowText)"},brandStroke2:{rest:"PlatformColor(Window)"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},compoundBrandForeground1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},compoundBrandStroke1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},dangerBackground1:{rest:"PlatformColor(Window)"},dangerBackground2:{rest:"PlatformColor(Window)"},dangerBackground3:{rest:"PlatformColor(WindowText)"},dangerBorder1:{rest:"PlatformColor(WindowText)"},dangerBorder2:{rest:"PlatformColor(WindowText)"},dangerBorderActive:{rest:"PlatformColor(Highlight)"},dangerForeground1:{rest:"PlatformColor(WindowText)"},dangerForeground2:{rest:"PlatformColor(WindowText)"},dangerForeground3:{rest:"PlatformColor(WindowText)"},dangerForegroundInverted:{rest:"PlatformColor(WindowText)"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground2:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground3:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground4:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground5:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground6:{rest:"PlatformColor(Window)"},neutralBackgroundDisabled:{rest:"PlatformColor(Window)"},neutralBackgroundInverted:{rest:"PlatformColor(WindowText)"},neutralForeground1:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground2:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",brandHover:"PlatformColor(HighlightText)",brandPressed:"PlatformColor(HighlightText)",brandSelected:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground3:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",brandHover:"PlatformColor(HighlightText)",brandPressed:"PlatformColor(HighlightText)",brandSelected:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground4:{rest:"PlatformColor(WindowText)"},neutralForegroundDisabled:{rest:"PlatformColor(GrayText)"},neutralForegroundInverted:{rest:"PlatformColor(Window)"},neutralForegroundInvertedLink:{rest:"PlatformColor(Hotlight)",hover:"PlatformColor(Hotlight)",pressed:"PlatformColor(Hotlight)",selected:"PlatformColor(Hotlight)"},neutralForegroundOnBrand:{rest:"PlatformColor(ButtonText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralStencil1:{rest:"#141414"},neutralStencil2:{rest:"#858585"},neutralStroke1:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralStroke2:{rest:"PlatformColor(WindowText)"},neutralStroke3:{rest:"PlatformColor(WindowText)"},neutralStrokeAccessible:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralStrokeDisabled:{rest:"PlatformColor(GrayText)"},outofofficeBackground1:{rest:"PlatformColor(Window)"},outofofficeBackground2:{rest:"PlatformColor(Window)"},outofofficeBackground3:{rest:"PlatformColor(WindowText)"},outofofficeBorder1:{rest:"PlatformColor(WindowText)"},outofofficeBorder2:{rest:"PlatformColor(WindowText)"},outofofficeBorderActive:{rest:"PlatformColor(Highlight)"},outofofficeForeground1:{rest:"PlatformColor(WindowText)"},outofofficeForeground2:{rest:"PlatformColor(WindowText)"},outofofficeForeground3:{rest:"PlatformColor(WindowText)"},severeBackground1:{rest:"PlatformColor(Window)"},severeBackground2:{rest:"PlatformColor(Window)"},severeBackground3:{rest:"PlatformColor(WindowText)"},severeBorder1:{rest:"PlatformColor(WindowText)"},severeBorder2:{rest:"PlatformColor(WindowText)"},severeBorderActive:{rest:"PlatformColor(Highlight)"},severeForeground1:{rest:"PlatformColor(WindowText)"},severeForeground2:{rest:"PlatformColor(WindowText)"},severeForeground3:{rest:"PlatformColor(WindowText)"},strokeFocus1:{rest:"PlatformColor(Window)"},strokeFocus2:{rest:"PlatformColor(Highlight)"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},successBackground1:{rest:"PlatformColor(Window)"},successBackground2:{rest:"PlatformColor(Window)"},successBackground3:{rest:"PlatformColor(WindowText)"},successBorder1:{rest:"PlatformColor(WindowText)"},successBorder2:{rest:"PlatformColor(WindowText)"},successBorderActive:{rest:"PlatformColor(Highlight)"},successForeground1:{rest:"PlatformColor(WindowText)"},successForeground2:{rest:"PlatformColor(WindowText)"},successForeground3:{rest:"PlatformColor(WindowText)"},successForegroundInverted:{rest:"PlatformColor(WindowText)"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",disabled:"PlatformColor(GrayText)"},warningBackground1:{rest:"PlatformColor(Window)"},warningBackground2:{rest:"PlatformColor(Window)"},warningBackground3:{rest:"PlatformColor(WindowText)"},warningBorder1:{rest:"PlatformColor(WindowText)"},warningBorder2:{rest:"PlatformColor(WindowText)"},warningBorderActive:{rest:"PlatformColor(Highlight)"},warningForeground1:{rest:"PlatformColor(WindowText)"},warningForeground2:{rest:"PlatformColor(WindowText)"},warningForeground3:{rest:"PlatformColor(WindowText)"},warningForegroundInverted:{rest:"PlatformColor(WindowText)"}}});function HIe(e){for(var t in e)for(var r in e[t]){var n=e[t][r];if(typeof n=="string"&&n.includes("PlatformColor")){var o=n.substring(14,n.length-1);e[t][r]=(0,Lq.PlatformColor)(o)}}return e}var Lq,Hq,Bq,Uq=f(()=>{"use strict";s();Lq=I(ee()),Hq=I(V1()),Bq=HIe(Hq.default)});function W1(e){return e==="light"?j1.default:e==="dark"||e==="darkElevated"?jq.default:e==="highContrast"?Bq:((0,Gq.assertNever)(e),j1.default)}function z1(e){return e==="light"?zq.default:e==="dark"?Wq.default:Vq.default}var Vq,jq,Wq,j1,zq,Gq,qq=f(()=>{"use strict";s();Vq=I(U1()),jq=I(Rq()),Wq=I(kq()),j1=I(wq()),zq=I(Oq()),Gq=I(M0());Uq()});var Ii=f(()=>{"use strict";s();Eq();qq()});function q1(e,t){return e===void 0?t:e==="dynamic"?G1.Appearance&&G1.Appearance.getColorScheme()||t:e}var G1,Kq=f(()=>{"use strict";s();G1=I(ee())});function Wt(e){return e?e.name==="HighContrast":!1}var Yq=f(()=>{"use strict";s()});function Iv(e){return{neutralForeground1:e.neutralForeground1.rest,neutralForeground1Hover:e.neutralForeground1.hover,neutralForeground1Pressed:e.neutralForeground1.pressed,neutralForeground1Selected:e.neutralForeground1.selected,neutralForeground2:e.neutralForeground2.rest,neutralForeground2Hover:e.neutralForeground2.hover,neutralForeground2Pressed:e.neutralForeground2.pressed,neutralForeground2Selected:e.neutralForeground2.selected,neutralForeground2BrandHover:e.neutralForeground2.brandHover,neutralForeground2BrandPressed:e.neutralForeground2.brandPressed,neutralForeground2BrandSelected:e.neutralForeground2.brandSelected,neutralForeground3:e.neutralForeground3.rest,neutralForeground3Hover:e.neutralForeground3.hover,neutralForeground3Pressed:e.neutralForeground3.pressed,neutralForeground3Selected:e.neutralForeground3.selected,neutralForeground3BrandHover:e.neutralForeground3.brandHover,neutralForeground3BrandPressed:e.neutralForeground3.brandPressed,neutralForeground3BrandSelected:e.neutralForeground3.brandSelected,neutralForeground4:e.neutralForeground4.rest,neutralForegroundDisabled:e.neutralForegroundDisabled.rest,brandForegroundLink:e.brandForegroundLink.rest,brandForegroundLinkHover:e.brandForegroundLink.hover,brandForegroundLinkPressed:e.brandForegroundLink.pressed,brandForegroundLinkSelected:e.brandForegroundLink.selected,compoundBrandForeground1:e.compoundBrandForeground1.rest,compoundBrandForeground1Hover:e.compoundBrandForeground1.hover,compoundBrandForeground1Pressed:e.compoundBrandForeground1.pressed,brandForeground1:e.brandForeground1.rest,brandForeground1Disabled:e.brandForeground1.disabled,brandForeground1Pressed:e.brandForeground1.pressed,brandForeground2:e.brandForeground2.rest,neutralForegroundInverted:e.neutralForegroundInverted.rest,neutralForegroundOnBrand:e.neutralForegroundOnBrand.rest,neutralForegroundOnBrandHover:e.neutralForegroundOnBrand.hover,neutralForegroundOnBrandPressed:e.neutralForegroundOnBrand.pressed,neutralForegroundOnBrandSelected:e.neutralForegroundOnBrand.selected,neutralForegroundInvertedLink:e.neutralForegroundInvertedLink.rest,neutralForegroundInvertedLinkHover:e.neutralForegroundInvertedLink.hover,neutralForegroundInvertedLinkPressed:e.neutralForegroundInvertedLink.pressed,neutralForegroundInvertedLinkSelected:e.neutralForegroundInvertedLink.selected,neutralBackground1:e.neutralBackground1.rest,neutralBackground1Hover:e.neutralBackground1.hover,neutralBackground1Pressed:e.neutralBackground1.pressed,neutralBackground1Selected:e.neutralBackground1.selected,neutralBackground2:e.neutralBackground2.rest,neutralBackground2Hover:e.neutralBackground2.hover,neutralBackground2Pressed:e.neutralBackground2.pressed,neutralBackground2Selected:e.neutralBackground2.selected,neutralBackground3:e.neutralBackground3.rest,neutralBackground3Hover:e.neutralBackground3.hover,neutralBackground3Pressed:e.neutralBackground3.pressed,neutralBackground3Selected:e.neutralBackground3.selected,neutralBackground4:e.neutralBackground4.rest,neutralBackground4Hover:e.neutralBackground4.hover,neutralBackground4Pressed:e.neutralBackground4.pressed,neutralBackground4Selected:e.neutralBackground4.selected,neutralBackground5:e.neutralBackground5.rest,neutralBackground5Hover:e.neutralBackground5.hover,neutralBackground5Pressed:e.neutralBackground5.pressed,neutralBackground5Selected:e.neutralBackground5.selected,neutralBackground6:e.neutralBackground6.rest,neutralBackgroundInverted:e.neutralBackgroundInverted.rest,subtleBackground:e.subtleBackground.rest,subtleBackgroundHover:e.subtleBackground.hover,subtleBackgroundPressed:e.subtleBackground.pressed,subtleBackgroundSelected:e.subtleBackground.selected,transparentBackground:e.transparentBackground.rest,transparentBackgroundHover:e.transparentBackground.hover,transparentBackgroundPressed:e.transparentBackground.pressed,transparentBackgroundSelected:e.transparentBackground.selected,neutralBackgroundDisabled:e.neutralBackgroundDisabled.rest,neutralStencil1:e.neutralStencil1.rest,neutralStencil2:e.neutralStencil2.rest,brandBackground:e.brandBackground.rest,brandBackgroundHover:e.brandBackground.hover,brandBackgroundPressed:e.brandBackground.pressed,brandBackgroundDisabled:e.brandBackground.disabled,brandBackgroundSelected:e.brandBackground.selected,compoundBrandBackground1:e.compoundBrandBackground1.rest,compoundBrandBackground1Hover:e.compoundBrandBackground1.hover,compoundBrandBackground1Pressed:e.compoundBrandBackground1.pressed,brandBackgroundStatic:e.brandBackgroundStatic.rest,brandBackground2:e.brandBackground2.rest,neutralStrokeAccessible:e.neutralStrokeAccessible.rest,neutralStrokeAccessibleHover:e.neutralStrokeAccessible.hover,neutralStrokeAccessiblePressed:e.neutralStrokeAccessible.pressed,neutralStrokeAccessibleSelected:e.neutralStrokeAccessible.selected,neutralStroke1:e.neutralStroke1.rest,neutralStroke1Hover:e.neutralStroke1.hover,neutralStroke1Pressed:e.neutralStroke1.pressed,neutralStroke1Selected:e.neutralStroke1.selected,neutralStroke2:e.neutralStroke2.rest,neutralStroke3:e.neutralStroke3.rest,brandStroke1:e.brandStroke1.rest,brandStroke2:e.brandStroke2.rest,compoundBrandStroke1:e.compoundBrandStroke1.rest,compoundBrandStroke1Hover:e.compoundBrandStroke1.hover,compoundBrandStroke1Pressed:e.compoundBrandStroke1.pressed,neutralStrokeDisabled:e.neutralStrokeDisabled.rest,transparentStroke:e.transparentStroke.rest,transparentStrokeInteractive:e.transparentStroke.hover,transparentStrokeDisabled:e.transparentStroke.disabled,strokeFocus1:e.strokeFocus1.rest,strokeFocus2:e.strokeFocus2.rest,dangerBackground1:e.dangerBackground1.rest,dangerBackground2:e.dangerBackground2.rest,dangerBackground3:e.dangerBackground3.rest,dangerForeground1:e.dangerForeground1.rest,dangerForeground2:e.dangerForeground2.rest,dangerForeground3:e.dangerForeground3.rest,dangerForegroundInverted:e.dangerForegroundInverted.rest,dangerBorderActive:e.dangerBorderActive.rest,dangerBorder1:e.dangerBorder1.rest,dangerBorder2:e.dangerBorder2.rest,successBackground1:e.successBackground1.rest,successBackground2:e.successBackground2.rest,successBackground3:e.successBackground3.rest,successForeground1:e.successForeground1.rest,successForeground2:e.successForeground2.rest,successForeground3:e.successForeground3.rest,successForegroundInverted:e.successForegroundInverted.rest,successBorderActive:e.successBorderActive.rest,successBorder1:e.successBorder1.rest,successBorder2:e.successBorder2.rest,warningBackground1:e.warningBackground1.rest,warningBackground2:e.warningBackground2.rest,warningBackground3:e.warningBackground3.rest,warningForeground1:e.warningForeground1.rest,warningForeground2:e.warningForeground2.rest,warningForeground3:e.warningForeground3.rest,warningForegroundInverted:e.warningForegroundInverted.rest,warningBorderActive:e.warningBorderActive.rest,warningBorder1:e.warningBorder1.rest,warningBorder2:e.warningBorder2.rest,severeBackground1:e.severeBackground1.rest,severeBackground2:e.severeBackground2.rest,severeBackground3:e.severeBackground3.rest,severeForeground1:e.severeForeground1.rest,severeForeground2:e.severeForeground2.rest,severeForeground3:e.severeForeground3.rest,severeBorderActive:e.severeBorderActive.rest,severeBorder1:e.severeBorder1.rest,severeBorder2:e.severeBorder2.rest,outofofficeBackground1:e.outofofficeBackground1.rest,outofofficeBackground2:e.outofofficeBackground2.rest,outofofficeBackground3:e.outofofficeBackground3.rest,outofofficeForeground1:e.outofofficeForeground1.rest,outofofficeForeground2:e.outofofficeForeground2.rest,outofofficeForeground3:e.outofofficeForeground3.rest,outofofficeBorderActive:e.outofofficeBorderActive.rest,outofofficeBorder1:e.outofofficeBorder1.rest,outofofficeBorder2:e.outofofficeBorder2.rest}}function K1(e){return{caption1:pa(e.caption1),body1:pa(e.body1),body1Strong:pa(e.body1Strong),body2:pa(e.body2),body2Strong:pa(e.body2Strong),subtitle1:pa(e.subtitle1),subtitle1Strong:pa(e.subtitle1Strong),subtitle2:pa(e.subtitle2),subtitle2Strong:pa(e.subtitle2Strong),title1:pa(e.title1),title1Strong:pa(e.title1Strong),largeTitle:pa(e.largeTitle),display:pa(e.display)}}function pa(e){return{face:"primary",size:e.fontSize,weight:e.fontWeight}}var $q=f(()=>{"use strict";s()});function Ev(e){return{shadow2:{ambient:e.shadow2[0],key:e.shadow2[1]},shadow4:{ambient:e.shadow4[0],key:e.shadow4[1]},shadow8:{ambient:e.shadow8[0],key:e.shadow8[1]},shadow16:{ambient:e.shadow16[0],key:e.shadow16[1]},shadow28:{ambient:e.shadow28[0],key:e.shadow28[1]},shadow64:{ambient:e.shadow64[0],key:e.shadow64[1]},shadow2brand:{ambient:e.shadowBrand2[0],key:e.shadowBrand2[1]},shadow4brand:{ambient:e.shadowBrand4[0],key:e.shadowBrand4[1]},shadow8brand:{ambient:e.shadowBrand8[0],key:e.shadowBrand8[1]},shadow16brand:{ambient:e.shadowBrand16[0],key:e.shadowBrand16[1]},shadow28brand:{ambient:e.shadowBrand28[0],key:e.shadowBrand28[1]},shadow64brand:{ambient:e.shadowBrand64[0],key:e.shadowBrand64[1]}}}var Qq=f(()=>{"use strict";s()});var zc=f(()=>{"use strict";s();Kq();Yq();$q();Qq()});function BIe(e){var t=W1(e);return Iv(t)}function UIe(e){var t=z1(e);return Ev(t)}var Ug,L0,Pv=f(()=>{"use strict";s();jc();Ii();zc();Ug=Jt(BIe);L0=Jt(UIe)});function $1(e,t){return{background:e.white,bodyStandoutBackground:e.neutralLighterAlt,bodyFrameBackground:e.white,bodyFrameDivider:e.neutralLight,bodyText:e.neutralPrimary,bodyTextChecked:e.black,subText:e.neutralSecondary,bodyDivider:e.neutralLight,disabledBackground:t?e.neutralQuaternaryAlt:e.neutralLighter,disabledText:e.neutralTertiary,disabledBodyText:e.neutralTertiary,focusBorder:e.neutralSecondary,variantBorder:e.neutralLight,errorText:t?"#ff5f5f":e.redDark,inputBorder:e.neutralTertiary,inputBackground:e.white,inputFocusBorderAlt:e.themePrimary,inputText:e.neutralPrimary,inputPlaceholderText:e.neutralSecondary,buttonBackground:e.neutralLighter,buttonBackgroundChecked:e.neutralTertiaryAlt,buttonBackgroundHovered:e.neutralLight,buttonBackgroundPressed:e.neutralLight,buttonBackgroundDisabled:e.neutralLighter,buttonBorder:e.neutralSecondaryAlt,buttonText:t?e.black:e.neutralPrimary,buttonTextHovered:t?e.neutralPrimary:e.neutralDark,buttonTextChecked:e.neutralDark,buttonTextPressed:e.neutralDark,buttonTextDisabled:e.neutralTertiary,buttonBorderDisabled:e.neutralLighter,buttonBorderFocused:e.neutralSecondaryAlt,primaryButtonBackground:e.themePrimary,primaryButtonBackgroundHovered:e.themeDarkAlt,primaryButtonBackgroundPressed:e.themeDark,primaryButtonBackgroundDisabled:e.neutralLighter,primaryButtonBorder:"transparent",primaryButtonBorderFocused:"transparent",primaryButtonText:e.white,primaryButtonTextHovered:e.white,primaryButtonTextPressed:e.white,primaryButtonTextDisabled:e.neutralQuaternary,accentButtonBackground:e.accent,menuBackground:t?e.neutralLighter:e.white,menuDivider:e.neutralTertiaryAlt,menuIcon:t?e.themeDarkAlt:e.themePrimary,menuItemBackgroundHovered:t?e.neutralQuaternaryAlt:e.neutralLighter,menuItemBackgroundPressed:t?e.neutralQuaternary:e.neutralLight,menuItemText:e.neutralPrimary,menuItemTextHovered:e.neutralDark,listHeaderBackgroundHovered:e.neutralLighter,listHeaderBackgroundPressed:e.neutralLight,actionLink:e.neutralPrimary,link:e.themePrimary,linkHovered:e.themeDarker,linkPressed:e.themeDark,defaultBackground:e.neutralLighter,defaultBorder:e.neutralSecondaryAlt,defaultContent:t?e.black:e.neutralPrimary,defaultIcon:t?e.black:e.neutralPrimary,defaultHoveredBackground:e.neutralLight,defaultHoveredBorder:e.neutralSecondaryAlt,defaultHoveredContent:t?e.neutralPrimary:e.neutralDark,defaultHoveredIcon:t?e.neutralPrimary:e.neutralDark,defaultFocusedBackground:e.neutralLight,defaultFocusedBorder:e.neutralSecondaryAlt,defaultFocusedContent:t?e.neutralPrimary:e.neutralDark,defaultFocusedIcon:t?e.neutralPrimary:e.neutralDark,defaultPressedBackground:e.neutralLight,defaultPressedBorder:e.neutralSecondaryAlt,defaultPressedContent:e.neutralDark,defaultPressedIcon:e.neutralDark,defaultDisabledBackground:e.neutralLighter,defaultDisabledBorder:e.neutralLighter,defaultDisabledContent:e.neutralTertiary,defaultDisabledIcon:e.neutralTertiary,ghostBackground:e.white,ghostBorder:e.white,ghostContent:e.neutralPrimary,ghostIcon:e.neutralPrimary,ghostHoveredBackground:e.neutralLighter,ghostHoveredBorder:e.neutralLighter,ghostHoveredContent:e.neutralDark,ghostHoveredIcon:e.neutralDark,ghostFocusedBackground:e.neutralLighter,ghostFocusedBorder:e.neutralSecondaryAlt,ghostFocusedContent:e.neutralDark,ghostFocusedIcon:e.neutralDark,ghostPressedBackground:e.neutralLight,ghostPressedBorder:e.neutralLight,ghostPressedContent:e.neutralDark,ghostPressedIcon:e.neutralDark,ghostDisabledBackground:e.white,ghostDisabledBorder:e.white,ghostDisabledContent:e.neutralTertiary,ghostDisabledIcon:e.neutralTertiary,brandedBackground:e.themePrimary,brandedDisabledBorder:e.neutralLighter,defaultCheckedBackground:e.neutralTertiaryAlt,defaultCheckedContent:e.neutralDark,defaultCheckedHoveredBackground:e.neutralLight,defaultCheckedHoveredContent:t?e.neutralPrimary:e.neutralDark,ghostCheckedBackground:e.neutralLight,ghostCheckedContent:e.black,ghostCheckedHoveredBackground:e.neutralLighter,ghostCheckedHoveredContent:e.neutralDark,ghostCheckedHoveredBorder:e.neutralDark,ghostSecondaryContent:e.neutralSecondary,ghostFocusedSecondaryContent:e.neutralSecondary,ghostHoveredSecondaryContent:e.neutralSecondary,ghostPressedSecondaryContent:e.neutralSecondary,brandedSecondaryContent:e.neutralLighterAlt,brandedFocusedSecondaryContent:e.neutralLighterAlt,brandedHoveredSecondaryContent:e.neutralLighterAlt,brandedPressedSecondaryContent:e.neutralLighterAlt,defaultHoveredSecondaryContent:e.neutralTertiary,defaultPressedSecondaryContent:e.neutralTertiary,checkmarkColor:e.white,checkboxBackground:e.themePrimary,checkboxBackgroundDisabled:e.neutralLighter,checkboxBorderColor:e.neutralSecondaryAlt,personaActivityRing:e.white,personaActivityGlow:e.themePrimary}}function Xq(){return Y1({background:"#000000",bodyStandoutBackground:"#000000",bodyFrameBackground:"#000000",bodyFrameDivider:"#000000",bodyText:"#ffffff",bodyTextChecked:"#000000",subText:"#ffffff",bodyDivider:"#ffffff",disabledBackground:"#000000",disabledText:"#3ff23f",disabledBodyText:"#3ff23f",focusBorder:"#ffffff",variantBorder:"#ffffff",errorText:"#ffffff",inputBorder:"#ffffff",inputBackground:"#000000",inputFocusBorderAlt:"#ffffff",inputText:"#ffffff",inputPlaceholderText:"#ffffff",buttonBackground:"#000000",buttonBackgroundChecked:"#1aebff",buttonBackgroundHovered:"#1aebff",buttonBackgroundPressed:"#1aebff",buttonBackgroundDisabled:"#000000",buttonBorder:"#ffffff",buttonText:"#ffffff",buttonTextHovered:"#000000",buttonTextChecked:"#000000",buttonTextPressed:"#000000",buttonTextDisabled:"#3ff23f",buttonBorderDisabled:"#3ff23f",buttonBorderFocused:"#ffffff",primaryButtonBackground:"#000000",primaryButtonBackgroundHovered:"#1aebff",primaryButtonBackgroundPressed:"#1aebff",primaryButtonBackgroundDisabled:"#000000",primaryButtonBorder:"#ffffff",primaryButtonBorderFocused:"#ffffff",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#000000",primaryButtonTextPressed:"#000000",primaryButtonTextDisabled:"#3ff23f",accentButtonBackground:"#000000",menuBackground:"#000000",menuDivider:"#ffffff",menuIcon:"#ffffff",menuItemBackgroundHovered:"#1aebff",menuItemBackgroundPressed:"#1aebff",menuItemText:"#ffffff",menuItemTextHovered:"#000000",listHeaderBackgroundHovered:"#1aebff",listHeaderBackgroundPressed:"#1aebff",actionLink:"#ffff00",link:"#ffff00",linkHovered:"#ffffff",linkPressed:"#ffffff",defaultBackground:"#000000",defaultBorder:"#ffffff",defaultContent:"#ffffff",defaultIcon:"#ffffff",defaultHoveredBackground:"#1aebff",defaultHoveredBorder:"#1aebff",defaultHoveredContent:"#000000",defaultHoveredIcon:"#000000",defaultFocusedBackground:"#000000",defaultFocusedBorder:"#ffffff",defaultFocusedContent:"#ffffff",defaultFocusedIcon:"#ffffff",defaultPressedBackground:"#1aebff",defaultPressedBorder:"#1aebff",defaultPressedContent:"#000000",defaultPressedIcon:"#000000",defaultDisabledBackground:"#000000",defaultDisabledBorder:"#3ff23f",defaultDisabledContent:"#3ff23f",defaultDisabledIcon:"#3ff23f",ghostBackground:"#000000",ghostBorder:"#000000",ghostContent:"#ffffff",ghostIcon:"#ffffff",ghostHoveredBackground:"#1aebff",ghostHoveredBorder:"#1aebff",ghostHoveredContent:"#000000",ghostHoveredIcon:"#000000",ghostFocusedBackground:"#000000",ghostFocusedBorder:"#ffffff",ghostFocusedContent:"#ffffff",ghostFocusedIcon:"#ffffff",ghostPressedBackground:"#1aebff",ghostPressedBorder:"#1aebff",ghostPressedContent:"#000000",ghostPressedIcon:"#000000",ghostDisabledBackground:"#000000",ghostDisabledBorder:"#000000",ghostDisabledContent:"#3ff23f",ghostDisabledIcon:"#3ff23f",brandedBackground:"#000000",brandedDisabledBorder:"#3ff23f",defaultCheckedBackground:"#1aebff",defaultCheckedContent:"#000000",defaultCheckedHoveredBackground:"#1aebff",defaultCheckedHoveredContent:"#000000",ghostCheckedBackground:"#1aebff",ghostCheckedContent:"#000000",ghostCheckedHoveredBackground:"#1aebff",ghostCheckedHoveredContent:"#000000",ghostCheckedHoveredBorder:"#000000",ghostSecondaryContent:"#ffffff",ghostFocusedSecondaryContent:"#ffffff",ghostHoveredSecondaryContent:"#000000",ghostPressedSecondaryContent:"#000000",brandedSecondaryContent:"#ffffff",brandedFocusedSecondaryContent:"#ffffff",brandedHoveredSecondaryContent:"#000000",brandedPressedSecondaryContent:"#000000",defaultHoveredSecondaryContent:"#000000",defaultPressedSecondaryContent:"#000000",checkmarkColor:"#ffffff",checkboxBackground:"#000000",checkboxBackgroundDisabled:"#000000",checkboxBorderColor:"#ffffff",personaActivityRing:"#ffffff",personaActivityGlow:"transparent"},Ug("highContrast"))}var Y1,Q1=f(()=>{"use strict";s();Pv();Y1=function(){return Y1=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Y1.apply(this,arguments)}});function Jq(){return Vg(Vg({},$1({black:F.color.black,neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",white:F.color.white,red:F.color.red.primary,redDark:F.color.burgundy.primary,themeDarker:F.color.brand.shade40,themeDark:F.color.brand.shade20,themeDarkAlt:F.color.brand.shade10,themePrimary:F.color.brand.primary,themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:F.color.brand.tint40,themeLighter:F.color.brand.tint50,themeLighterAlt:F.color.brand.tint60,accent:F.color.brand.primary,blackTranslucent40:"rgba(0,0,0,.4)"})),Ug("light"))}function Zq(){return Vg(Vg({},$1({themeDarker:"#82c7ff",themeDark:F.color.brand.tint30,themeDarkAlt:F.color.brand.tint20,themePrimary:F.color.brand.tint10,themeSecondary:F.color.brand.primary,themeTertiary:"#235a85",themeLight:F.color.brand.shade30,themeLighter:F.color.brand.shade50,themeLighterAlt:F.color.brand.shade60,black:F.color.white,neutralDark:"#faf9f8",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralSecondary:"#a19f9d",neutralSecondaryAlt:"#979693",neutralTertiary:"#797775",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralQuaternaryAlt:"#323130",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",white:"#1b1a19",red:F.color.red.primary,accent:F.color.brand.primary,redDark:"#f1707b",blackTranslucent40:"rgba(0,0,0,.4)"},!0)),Ug("dark"))}var Vg,eK=f(()=>{"use strict";s();Ii();Pv();Q1();Vg=function(){return Vg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Vg.apply(this,arguments)}});function VIe(){var e={sizes:{caption:F.font.size100,secondary:F.font.size200,body:F.font.size300,subheader:F.font.size400,header:F.font.size500,hero:F.font.size700,heroLarge:F.font.size900},weights:{regular:F.font.weight.regular,semiBold:F.font.weight.semibold},families:{primary:"Segoe UI",secondary:"Segoe UI",cursive:"System",monospace:"System",numeric:"System",sansSerif:"System",serif:"System"},variants:{captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"primary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"primary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"primary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"primary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"primary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"primary",size:"heroLarge",weight:"semiBold"},caption1:{face:"primary",size:"caption",weight:"regular"},caption1Strong:{face:"primary",size:"caption",weight:"semiBold"},body1:{face:"primary",size:"secondary",weight:"regular"},body1Strong:{face:"primary",size:"secondary",weight:"semiBold"},body2:{face:"primary",size:"body",weight:"regular"},body2Strong:{face:"primary",size:"body",weight:"semiBold"},subtitle1:{face:"primary",size:"header",weight:"regular"},subtitle1Strong:{face:"primary",size:"header",weight:"semiBold"},subtitle2:{face:"primary",size:"subheader",weight:"regular"},subtitle2Strong:{face:"primary",size:"subheader",weight:"semiBold"},title1:{face:"primary",size:"hero",weight:"regular"},title1Strong:{face:"primary",size:"hero",weight:"semiBold"},largeTitle:{face:"primary",size:"heroLarge",weight:"regular"},display:{face:"primary",size:"heroLarge",weight:"semiBold"}}};return e}function jIe(){return{s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"}}var fxt,ei,jg,tK,X1=f(()=>{"use strict";s();fxt=I(ee());Ii();Pv();Q1();eK();ei={colors:Jq(),typography:VIe(),spacing:jIe(),shadows:L0("light"),components:{},host:{appearance:"light"}},jg={colors:Zq(),typography:ei.typography,shadows:L0("dark"),spacing:ei.spacing,components:{},host:{appearance:"dark"}},tK={colors:Xq(),typography:ei.typography,shadows:L0("highContrast"),spacing:ei.spacing,components:{},host:{appearance:"highContrast"}}});var Wg,J1,rK=f(()=>{"use strict";s();Wg=I(L());Yf();J1=function(t){var r=t.theme,n=t.children,o=Wg.useState(function(){return r.theme}),a=o[0],d=o[1];return Wg.useEffect(function(){d(r.theme);var c=function(){d(r.theme)};return r.addOnThemeChanged(c),function(){r.removeOnThemeChanged(c)}},[r,d]),Wg.createElement(Zt.Provider,{value:a},n)}});function nK(e,t){return fa(e,t)}var oK=f(()=>{"use strict";s();js()});var Qf,iK=f(()=>{"use strict";s();oK();Qf=function(){function e(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this;if(this.themeData=void 0,this.listeners=[],this.parentRef=void 0,this.listeners=[],this.recipes=r,this.parentRef=t instanceof e?t:void 0,this.parentRef){var a=function(){o.invalidate()};this.parentRef.addOnThemeChanged(a)}this.getParent=function(){return o.parentRef?o.parentRef.theme:t}}return Object.defineProperty(e.prototype,"theme",{get:function(){if(!this.themeData){for(var r=this.getParent(),n=0,o=this.recipes;n<o.length;n++){var a=o[n];r=nK(r,typeof a=="function"?a(r):a)}this.themeData=r}return this.themeData},enumerable:!1,configurable:!0}),e.prototype.addOnThemeChanged=function(t){this.listeners.push(t)},e.prototype.removeOnThemeChanged=function(t){this.listeners=this.listeners.filter(function(r){return r!==t})},e.prototype.invalidate=function(){this.themeData=void 0;for(var t=0,r=this.listeners;t<r.length;t++){var n=r[t];n()}},e.prototype.update=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.recipes=t,this.invalidate()},e}()});var _v=f(()=>{"use strict";s();rK();iK()});function eO(e){e===void 0&&(e={});var t=new Qf({},function(){var r=q1(e.appearance,e.defaultAppearance||"light");switch(r){case"light":return ei;case"dark":return jg;case"darkElevated":return jg;case"highContrast":return tK;default:(0,aK.default)(r)}});return Z1.Appearance&&e.appearance==="dynamic"&&Z1.Appearance.addChangeListener(function(){t.invalidate()}),t}var Z1,aK,sK=f(()=>{"use strict";s();Z1=I(ee());_v();zc();aK=I(M0());X1()});var zg=f(()=>{"use strict";s();X1();sK();Pv()});function ma(){return Wc()||ei}var tO=f(()=>{"use strict";s();zg();Yf()});var Rv,H0=f(()=>{"use strict";s();tO();Rv={useTheme:function(){return ma()},getComponentInfo:function(t,r){var n=t.components||{};return n[r]}}});function rn(e,t){return Sv(e,Rv,t)}var dK=f(()=>{"use strict";s();Tq();H0()});function Cl(e,t){var r=function(a){return e(a,t)},n=Nn(r);return n.customize=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var d=t.customize.apply(t,o);return Cl(e,d)},n}var cK=f(()=>{"use strict";s();xv()});function lt(e,t){return O1(e,t)}var uK=f(()=>{"use strict";s();L1();H0()});function Xf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bg.apply(void 0,w([Rv.getComponentInfo],e,!1))}var lK=f(()=>{"use strict";s();k();bv();H0();bv()});var Me=f(()=>{"use strict";s();jc();Hg();On();xv();F1();js();Yf();dK();cK();tO();uK();lK()});var rO,eo,vl=f(()=>{"use strict";s();(function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"})(rO||(rO={}));eo=rO});var ti,B0=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Editing=1]="Editing",e[e.Pending=2]="Pending"})(ti||(ti={}))});var Ud,Av=f(()=>{"use strict";s();(function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"})(Ud||(Ud={}))});function fK(e){nO=e}function xl(){return nO}function pK(){return nO===Xt.LargeDisplay}function Kr(e){return{renderContextType:e,displayClass:xl(),platform:Y(),isFluentEnabled:le()}}function Vd(e){return e===A.FullPane||YI(e)}function mK(e,t,r){return e&&(!r||t)}var nO,fn=f(()=>{"use strict";s();ue();Ld();Be();Ir();gi();nO=Xt.None});function Ce(e){return oO.StyleSheet.create({style:e}).style}function Gg(e,t,r,n,o){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=0);var a=oO.StyleSheet.flatten(e),d={padding:a.padding,paddingTop:a.paddingTop,paddingRight:a.paddingRight,paddingBottom:a.paddingBottom,paddingLeft:a.paddingLeft,paddingHorizontal:a.paddingHorizontal,paddingVertical:a.paddingVertical},c={};Object.keys(d).forEach(function(p){return c[p]=typeof d[p]=="string"?0:d[p]});var u=function(){for(var g=[],h=0;h<arguments.length;h++)g[h]=arguments[h];return g.find(function(x){return x!==void 0},g)},l={};return t&&(l.paddingTop=(u(c.paddingTop,c.paddingVertical,c.padding)||0)+t),r&&(l.paddingRight=(u(c.paddingRight,c.paddingHorizontal,c.padding)||0)+r),n&&(l.paddingBottom=(u(c.paddingBottom,c.paddingVertical,c.padding)||0)+n),o&&(l.paddingLeft=(u(c.paddingLeft,c.paddingVertical,c.padding)||0)+o),[e,l]}function Jf(e,t){return t.length!==2?(v().assertConditionTag(!1,"Invalid alpha value provided",578348938),e):!e.startsWith("#")||!(e.length===7||e.length===9)?(v().assertConditionTag(!1,"setAlpha only supports colors in #RRGGBB or #RRGGBBAA format",578348939),e):e.length===7?e+t:e.substr(0,7)+t}function gK(e,t){return e.renderWithSettings(Kr(t),{})}function ot(e,t,r){return e.renderWithSettings(Kr(r),t)}function Tl(e,t,r){return e.renderWithSettings(Kr(r),t)}var oO,vr,U0,V0,jd,ze=f(()=>{"use strict";s();Z();oO=I(ee());fn();vr=Ce({flex:1}),U0=Ce({flex:0}),V0=Ce({overflow:"hidden"}),jd=1e3});var hK,yK,R,kt,_r=f(()=>{"use strict";s();k();hK=I(dn());ze();yK=function(){function e(t){this.rules=[],this.storedStyles=new Map,this.rules=t}return e.prototype.render=function(t){return this.renderInternal(t,e.DEFAULT_SETTINGS)},e.prototype.renderWithSettings=function(t,r){return this.renderInternal(t,r)},e.prototype.renderInternal=function(t,r){var n=this.serializeRulesResults(t),o=this.storedStyles.get(r);o||(o=new Map,this.storedStyles.set(r,o));var a=o.get(n);if(a===void 0){var d=this.computeStyle(t,r);return a=this.registerStyle(d),o.set(n,a),a}return a},e.prototype.computeStyle=function(t,r){var n=this;return this.flattenStyle(this.rules.filter(function(o){return n.testCondition(o.condition,t)}).map(function(o){var a=o.style;if(typeof a=="function"){if(r===R.DEFAULT_SETTINGS)throw new Error("Functional rule def encountered with unset settings object");return a(r)}return a}))},e.prototype.testCondition=function(t,r){return typeof t=="function"?t(r):Object.keys(t).every(function(n){return t[n]===r[n]})},e.prototype.serializeRulesResults=function(t){var r=this;return this.rules.map(function(n){return r.testCondition(n.condition,t)?"1":"0"}).join("")},e.prototype.flattenStyle=function(t){return Object.assign.apply(Object,w([{}],j(t),!1))},e.DEFAULT_SETTINGS=Symbol(),e}(),R=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.registerStyle=function(r){return Ce(r)},t.rule=function(r,n){return{condition:r,style:n}},t.always=function(r){return{condition:{},style:r}},t}(yK),kt=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.registerStyle=function(r){return hK.StyleSheet.createViewStyle(r)},t.rule=function(r,n){return{condition:r,style:n}},t.always=function(r){return{condition:{},style:r}},t}(yK)});var qg,Rr,Wd,Kg,W0,WIe,CK,vK,z0,Yg,zIe,G0,GIe,q0,kv,K0,$g,Y0,$0,Q0,Qg,X0,J0,Z0,So=f(()=>{"use strict";s();Be();_r();qg=8,Rr=12,Wd=36,Kg=32,W0=19,WIe=1,CK=10,vK=4,z0=2,Yg=8,zIe=1,G0=1,GIe=4,q0=[R.rule({isFluentEnabled:!0},{paddingLeft:GIe,paddingBottom:3,borderColor:"transparent",borderWidth:zIe,marginLeft:5,marginRight:5,marginBottom:G0,borderRadius:2}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:24})],kv=[R.rule({isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardReplyBackground}}),R.rule({renderContextType:A.HalfPane,isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardReplyBackground_HalfPane}})],K0=new R([R.always({flex:1,flexDirection:"row",alignItems:"center",paddingBottom:2})]),$g=new kt([kt.always(function(e){return{opacity:e.themeId!==7?.65:1}})]),Y0=new R([R.always(function(e){return{borderWidth:WIe,paddingLeft:CK,paddingRight:CK,paddingTop:vK,paddingBottom:vK,borderColor:e.palette.CardDraftBoxBorder,borderRadius:2,backgroundColor:e.palette.CardDraftBoxBackground}})]),$0=new R([R.always({borderWidth:2,paddingLeft:9,paddingRight:9,paddingTop:3,paddingBottom:3})]),Q0=new R([R.rule({platform:"win32"},{flexShrink:0}),R.rule({platform:"android"},{marginLeft:2,marginRight:-10,width:40,height:40})]),Qg=new R([R.always({flex:0,borderWidth:0,minHeight:24,minWidth:28})]),X0=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground}})]),J0=new R([R.always(function(e){return{backgroundColor:e.palette.ResolvedCardBackground}})]),Z0=new R([R.always(function(e){return{backgroundColor:e.palette.CardHoveredBackground}})])});function Dv(e,t){return e===ge.FocusOn?iO:t?TK:es}function VK(e){return{marginRight:e,marginLeft:e,marginBottom:e}}function jK(e){return new R([R.always(function(t){return{flex:0,flexDirection:"row",padding:12-e,paddingTop:11,borderTopWidth:1,borderColor:t.palette.CardBorder}})])}var es,qIe,qc,xK,iO,TK,bK,SK,IK,aO,EK,PK,_K,RK,AK,kK,DK,wK,FK,OK,NK,MK,LK,HK,BK,UK,WK,zK,Kc=f(()=>{"use strict";s();Lt();ue();Be();So();fn();_r();ze();es=1,qIe=2,qc=12,xK=4,iO=3,TK=2,bK=22,SK=10,IK=300,aO=40,EK=[R.rule({isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardHeroBarBackground}}),R.rule({renderContextType:A.HalfPane,isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardHeroBarBackground_HalfPane}})],PK=new R([R.always({flex:1,overflow:"hidden"}),R.rule({platform:"win32",isFluentEnabled:!0},{flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start"})]),_K=new R([R.always({flex:1,flexDirection:"column"}),R.rule(function(e){var t=e.renderContextType,r=e.isFluentEnabled;return Vd(t)&&!r},function(e){return{borderWidth:es,borderColor:e.palette.CardAccent}}),R.rule({isFluentEnabled:!0},{paddingLeft:qc}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:0}),R.rule({renderContextType:A.HalfPane},{alignItems:"stretch"}),R.rule({renderContextType:A.HalfPane},function(e){return{backgroundColor:e.palette.CardBackground}})]),RK=Ce({flex:1,flexDirection:"column"}),AK=Ce({justifyContent:"flex-end"}),kK=new R([R.always({position:"absolute",backgroundColor:"transparent",flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%",left:qc,paddingBottom:es,paddingRight:es,paddingLeft:es}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{left:0})]),DK=new R([R.always({position:"relative",borderRadius:2,flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%"}),R.rule({isFluentEnabled:!0},{borderRadius:xK,borderWidth:iO,borderColor:"transparent"})]),wK=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground,borderRadius:xK,flex:1,borderWidth:es,borderColor:e.palette.CardBorder,borderStyle:e.themeId===7?"dashed":void 0,position:"absolute",left:Rr,justifyContent:"center",right:0,height:"100%"}}),R.rule(function(e){var t=e.renderContextType;return t===A.DiscreteIsolated},{left:0})]),FK=new R([R.always(function(e){return{backgroundColor:e.palette.ResolvedCardBackground}})]),OK=new R([R.always(function(e){return{borderColor:e.palette.CardBorderEmphasis,borderStyle:e.themeId===7?"solid":void 0}}),R.rule(function(){return!qo()},function(e){return{backgroundColor:e.palette.CardHoveredBackground}})]),NK=new R([R.always({borderWidth:iO})]),MK=new R([R.always(function(e){return{borderColor:e.palette.CardBorderEmphasis,borderWidth:TK,borderStyle:e.themeId===7?"solid":void 0}})]),LK=new R([R.always({position:"absolute",height:"100%",width:qIe}),R.rule({isFluentEnabled:!0},{marginLeft:qc})]),HK=new R([R.always(function(e){return{backgroundColor:e.palette.CardSelectionColor}})]),BK=Ce({flex:1,justifyContent:"center"}),UK=Ce({paddingBottom:qg});WK=Ce({height:16,width:16,marginTop:1,marginRight:8}),zK=Ce({flexDirection:"column",flex:1})});var qK,J,bl=f(()=>{"use strict";s();qK=I(vm()),J=qK.ViewWin32});var pr=f(()=>{"use strict";s();bl()});function Xg(e){if(!U5){var t=(0,wv.findNodeHandle)(e);typeof t=="number"?(mn&&Pt("Comments programmatic keyboard focus set via UIManager: ".concat(FF(e))),wv.UIManager.dispatchViewManagerCommand(t,wv.UIManager.getViewManagerConfig("RCTView").Commands.focus,[])):bu(e)?(mn&&Pt("Comments programmatic keyboard focus set: ".concat(FF(e))),e.focus()):mn&&Kl("Comments programmatic keyboard focus skipped - ref not focusable")}}function YK(e){var t;(t=e.current)!==null&&t!==void 0||KK.FocusManager.focus(e.current,!1)}var KK,wv,Fv=f(()=>{"use strict";s();te();Lt();KK=I(vm()),wv=I(ee());bc();Qa()});function Ws(e){var t;return t=function(r){X(n,r);function n(o){var a,d=r.call(this,o)||this;return d.nodes=[],d.registrationRef=Io.createRef(),d.innerRef=(a=d.getComponentRef())!==null&&a!==void 0?a:Io.createRef(),d.onFocusWithinChange=function(){var c=d.nodes.some(function(u){return u.node.getFocusState()!==ge.Unfocused});d.setState({isFocusWithin:c})},d.onFocus=d.onFocus.bind(d),d.onBlur=d.onBlur.bind(d),d.state={isFocusWithin:!1,isFocusOn:!1},d}return n.prototype.componentDidUpdate=function(o,a){var d=uo(this.state),c=uo(a);d!==c&&(mn&&Pt("".concat(this.getId(),": ").concat(ge[d])),this.props.onFocusStateChange&&this.props.onFocusStateChange(d),(c===ge.Unfocused||d===ge.Unfocused)&&this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(d))},n.prototype.getInnerRef=function(){return this.innerRef},n.prototype.focus=function(){this.innerRef&&this.innerRef.current&&Xg(this.innerRef.current)},n.prototype.blur=function(){var o;Y()!=="win32"&&this.innerRef&&bu(this.innerRef.current)&&((o=this.innerRef.current)===null||o===void 0||o.blur())},n.prototype.getFocusState=function(){return uo(this.state)},n.prototype.getNextTabTarget=function(o,a){return hD(this,o,a)},n.prototype.isTabbable=function(){return!!this.props.isTabbable},n.prototype.getChildNodes=function(){return this.nodes.slice().sort(function(o,a){return o.getSortKey()-a.getSortKey()}).map(function(o){return o.node})},n.prototype.getComponentRef=function(){return this.props.componentRef},n.prototype.getIterator=function(){return xD(this)},n.prototype.addChildNode=function(o,a){var d=this,c={unregister:function(){return d.unregister(o)},onFocusStateChange:this.onFocusWithinChange};return this.nodes.push({node:o,getSortKey:a}),c},n.prototype.getData=function(){return this.props.nodeData?this.props.nodeData():this},n.prototype.getId=function(){return this.props.nodeId||""},n.prototype.getDescendantById=function(o){for(var a=this.getIterator(),d;!(d=a.next()).done;)if(d.value.getId()===o)return d.value},n.prototype.unregister=function(o){var a=this.nodes.findIndex(function(d){return d.node===o});a>=0&&(this.nodes.splice(a,1),this.state.isFocusWithin&&this.onFocusWithinChange())},n.prototype.onFocus=function(o){Y()!=="android"&&Y()!=="win32"||((!o||o.target===o.currentTarget)&&this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus(o))},n.prototype.onBlur=function(o){Y()!=="android"&&Y()!=="win32"||((!o||o.target===o.currentTarget)&&this.setState({isFocusOn:!1}),this.props.onBlur&&this.props.onBlur(o))},n.prototype.renderInnerComponent=function(){var o=this,a=this.props,d=a.onFocusStateChange,c=a.onFocus,u=a.onBlur,l=a.keyDownEvents,p=a.preventDefaultKeyDownBehavior,g=je(a,["onFocusStateChange","onFocus","onBlur","keyDownEvents","preventDefaultKeyDownBehavior"]),h;if(Io.Children.count(this.props.children)===1){var x=Io.Children.toArray(this.props.children);typeof x[0]=="string"&&(h=x[0])}return h||(h=Io.createElement(um.Provider,{value:this},Io.Children.map(this.props.children,function(y,T){return Io.createElement(Sl.Provider,{value:T},y)}))),Io.createElement(Sl.Consumer,null,function(y){return Io.createElement(vc,{node:o,ref:o.registrationRef,position:y},Io.createElement(e,m({testID:o.props.nodeId,focusable:!0},g,o.state,{ref:o.getComponentRef()?void 0:o.innerRef,componentRef:o.getComponentRef(),onFocus:o.onFocus,onBlur:o.onBlur,keyDownEvents:sO(l,p)}),h))})},n.prototype.renderInnerComponentDebug=function(){var o={};return this.state.isFocusOn?o={borderColor:"red",borderWidth:3}:this.state.isFocusWithin&&(o={borderColor:"yellow",borderWidth:3}),Io.createElement(J,{style:[o,vr]},this.renderInnerComponent())},n.prototype.render=function(){return this.renderInnerComponent()},n}(Io.PureComponent),t.displayName="FocusAware".concat(e.displayName),t}var Io,Sl,sO,Yc=f(()=>{"use strict";s();k();te();Lt();Io=I(L());bc();pr();Ir();ze();Fv();Sl=Io.createContext(0),sO=function(t,r){var n=[];return t&&n.push.apply(n,w([],j(t),!1)),r&&n.push.apply(n,w([],j(r),!1)),n}});var $K,Yr,Pbt,zs=f(()=>{"use strict";s();$K=I(ee());pr();Yc();Yr=Ws(J),Pbt=Ws($K.TouchableOpacity)});function Ye(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[];if(!t.length)return e();var o=t.reduceRight(function(a,d,c){return function(){return QK.createElement(d.Consumer,null,function(u){return n[c]=u,a===null?e.apply(void 0,w([],j(n),!1)):a()})}},null);return o?o():(v().assertConditionTag(!1,"Contexts failed to wrap, default to raw render.",575479898),e())}var QK,Vr=f(()=>{"use strict";s();k();Z();QK=I(L())});function zd(){return eP.useContext(nn)}var eP,KIe,nn,Lo=f(()=>{"use strict";s();eP=I(L()),KIe="ComponentTreeIdContext undefined. Did you forget to render a ComponentTreeIdContext context provider?",nn=eP.createContext(new Proxy({},{get:function(){throw new Error(KIe)}}))});function Jg(){return tP.useContext(Ze)}var tP,Ze,xr=f(()=>{"use strict";s();tP=I(L()),Ze=tP.createContext(new Proxy({},{get:function(){throw new Error("Theme undefined. Did you forget to render a theme context provider?")}}))});var XK,JK,ZK=f(()=>{"use strict";s();Be();Kc();_r();XK=new R([R.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",paddingTop:2,marginLeft:qc,paddingLeft:6,paddingRight:3,minHeight:31}),R.rule({renderContextType:A.DiscreteIsolated},{marginLeft:0})]),JK=new R([R.always(function(e){return{borderBottomWidth:1,borderColor:e.palette.CardBorder}})])});var Gs,eY,tY=f(()=>{"use strict";s();k();Gs=I(L());Be();Kc();zs();Vr();Lo();ze();xr();pr();ZK();eY=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.renderWithContexts=function(n,o){var a=o.renderContextType,d=r.props.margin?r.props.margin:1,c=a!==A.DiscreteIsolated,u=[r.renderStyle(JK,n,a),{marginRight:d,marginLeft:d+(c?qc:0)}];return Gs.createElement(Yr,{isTabbable:!1,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior},Gs.createElement(J,{style:r.renderStyle(XK,n,a),animationClass:r.props.animationClass},Gs.createElement(Gs.Fragment,{key:"left"},r.props.leftElement),Gs.createElement(Gs.Fragment,{key:"right"},r.props.rightElement)),Gs.createElement(J,{style:u}))},r.render=function(){return Ye(r.renderWithContexts,Ze,nn)},r}return t.prototype.renderStyle=function(r,n,o){return ot(r,n,o)},t}(Gs.PureComponent)});function rY(e){var t,r,n,o,a,d,c,u,l,p,g,h;return{buttonBackground:"transparent",buttonHoveredBackground:"transparent",expandButtonTextColor:(r=(t=e.host.palette)===null||t===void 0?void 0:t.TextEmphasis)!==null&&r!==void 0?r:"bodyText",selectedText:(o=(n=e.host.palette)===null||n===void 0?void 0:n.Text)!==null&&o!==void 0?o:"bodyText",subTextColor:(d=(a=e.host.palette)===null||a===void 0?void 0:a.TextSecondary)!==null&&d!==void 0?d:"subText",text:(u=(c=e.host.palette)===null||c===void 0?void 0:c.Text)!==null&&u!==void 0?u:"bodyText",warningTextColor:(p=(l=e.host.palette)===null||l===void 0?void 0:l.TextError)!==null&&p!==void 0?p:"bodyText",warningDraftboxColor:(h=(g=e.host.palette)===null||g===void 0?void 0:g.TextError)!==null&&h!==void 0?h:"bodyText"}}function dO(e){var t,r,n,o,a,d,c;return m(m({},rY(e)),{assignedToYouBackground:(r=(t=e.host.colors)===null||t===void 0?void 0:t.App1)!==null&&r!==void 0?r:"background",assignedToYouText:(o=(n=e.host.colors)===null||n===void 0?void 0:n.App6)!==null&&o!==void 0?o:"bodyText",completedCheckColor:Pe.WHITE,completedSquareCheckboxColor:Pe.GRAY_140,expandButtonTextHoverColor:(c=qo()?(a=e.host.colors)===null||a===void 0?void 0:a.AppShade10:(d=e.host.colors)===null||d===void 0?void 0:d.App8)!==null&&c!==void 0?c:"bodyText",roundCheckboxBorderColor:Pe.BLACK,squareCheckboxBorderColor:Pe.BLACK})}function cO(e){var t,r,n,o,a,d,c;return m(m({},rY(e)),{assignedToYouBackground:(r=(t=e.host.colors)===null||t===void 0?void 0:t.App2)!==null&&r!==void 0?r:"background",assignedToYouText:(o=(n=e.host.colors)===null||n===void 0?void 0:n.App7)!==null&&o!==void 0?o:"bodyText",checkHoverColor:Pe.GRAY_70,completedCheckColor:Pe.GRAY_180,completedSquareCheckboxColor:Pe.GRAY_30,expandButtonTextHoverColor:(c=qo()?(a=e.host.colors)===null||a===void 0?void 0:a.AppTint40:(d=e.host.colors)===null||d===void 0?void 0:d.App1)!==null&&c!==void 0?c:"bodyText",menuFocus:Pe.GRAY_130,roundCheckboxBorderColor:Pe.WHITE,squareCheckboxBorderColor:Pe.GRAY_100})}var nY=f(()=>{"use strict";s();k();ue();ym()});function oY(e){return e.assignedToYouBackground!==void 0&&e.assignedToYouText!==void 0&&e.buttonBackground!==void 0&&e.buttonHoveredBackground!==void 0&&e.checkHoverColor!==void 0&&e.completedCheckColor!==void 0&&e.completedSquareCheckboxColor!==void 0&&e.expandButtonTextColor!==void 0&&e.expandButtonTextHoverColor!==void 0&&e.menuFocus!==void 0&&e.roundCheckboxBorderColor!==void 0&&e.selectedText!==void 0&&e.squareCheckboxBorderColor!==void 0&&e.subTextColor!==void 0&&e.text!==void 0&&e.warningDraftboxColor!==void 0&&e.warningTextColor!==void 0}var iY=f(()=>{"use strict";s()});function mr(e){var t=e.colors;return oY(t)?t:(v().assertConditionTag(!1,"Comments fluent theme is not being provided",588910614),sY(e).colors)}function sY(e){return{colors:m(m({},dO(e)),{checkHoverColor:Pe.GRAY_130,menuFocus:Pe.GRAY_40})}}function $Ie(e){return{colors:m(m({},dO(e)),{checkHoverColor:Pe.GRAY_140,menuFocus:Pe.GRAY_50})}}function QIe(e){return{colors:cO(e)}}function XIe(e){return{colors:cO(e)}}function JIe(){return{colors:{assignedToYouBackground:(0,Eo.PlatformColor)("Highlight"),assignedToYouText:(0,Eo.PlatformColor)("HighlightText"),buttonBackground:(0,Eo.PlatformColor)("ButtonFace"),buttonHoveredBackground:(0,Eo.PlatformColor)("Highlight"),checkHoverColor:(0,Eo.PlatformColor)("Highlight"),completedCheckColor:(0,Eo.PlatformColor)("ButtonText"),completedSquareCheckboxColor:(0,Eo.PlatformColor)("ButtonFace"),expandButtonTextColor:(0,Eo.PlatformColor)("ButtonText"),expandButtonTextHoverColor:(0,Eo.PlatformColor)("HighlightText"),menuFocus:(0,Eo.PlatformColor)("Highlight"),roundCheckboxBorderColor:(0,Eo.PlatformColor)("ButtonText"),selectedText:(0,Eo.PlatformColor)("HighlightText"),squareCheckboxBorderColor:(0,Eo.PlatformColor)("ButtonText"),subTextColor:(0,Eo.PlatformColor)("WindowText"),text:(0,Eo.PlatformColor)("WindowText"),warningDraftboxColor:(0,Eo.PlatformColor)("ButtonText"),warningTextColor:(0,Eo.PlatformColor)("WindowText")}}}var Eo,aY,ri=f(()=>{"use strict";s();k();Z();Eo=I(ee());ym();nY();iY();aY=function(t){switch(t.name){case"Colorful":return sY(t);case"White":return $Ie(t);case"Black":return QIe(t);case"DarkGray":return XIe(t);case"HighContrast":return JIe();default:return{}}}});function dY(e,t,r){var n=function(d,c){var u=e+o.length,l;return c!==void 0?l=t(c,u):l=r?r(d,u):d,l&&o.push(l),""},o=[];return e.replace(ZIe,n),o}function cY(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=function(a,d){try{return t[+d]}catch(c){return""}};return e.replace(eEe,n)}var ZIe,eEe,uO=f(()=>{"use strict";s();ZIe=/{([^{}]+)}|[^{}]+/g,eEe=/{([^{}]+)}/g});function Gd(e){return tEe[e]}function lO(e){return rEe[e]}function rP(e){return nEe[e]}var tEe,rEe,nEe,uY=f(()=>{"use strict";s();tEe={children:!0,accessibilityAccessKey:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityDescription:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLevel:!0,accessibilityLiveRegion:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,animationClass:!0,collapsable:!0,cursor:!0,enableFocusRing:!0,focusable:!0,hasTVPreferredFocus:!1,hitSlop:!0,id:!0,importantForAccessibility:!0,isTVSelectable:!1,keyDownEvents:!0,keyUpEvents:!0,nativeID:!0,needsOffscreenAlphaCompositing:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onLayout:!0,onMagicTap:!1,onMouseEnter:!0,onMouseLeave:!0,onMoveShouldSetResponder:!0,onMoveShouldSetResponderCapture:!0,onPointerCancel:!0,onPointerCancelCapture:!0,onPointerDown:!0,onPointerDownCapture:!0,onPointerEnter:!0,onPointerEnterCapture:!0,onPointerLeave:!0,onPointerLeaveCapture:!0,onPointerMove:!0,onPointerMoveCapture:!0,onPointerUp:!0,onPointerUpCapture:!0,onResponderEnd:!0,onResponderGrant:!0,onResponderMove:!0,onResponderReject:!0,onResponderRelease:!0,onResponderStart:!0,onResponderTerminate:!0,onResponderTerminationRequest:!0,onStartShouldSetResponder:!0,onStartShouldSetResponderCapture:!0,onTouchCancel:!0,onTouchEnd:!0,onTouchEndCapture:!0,onTouchMove:!0,onTouchStart:!0,pointerEvents:!0,removeClippedSubviews:!0,renderToHardwareTextureAndroid:!0,role:!0,shouldRasterizeIOS:!0,style:!0,tabIndex:!0,testID:!0,tooltip:!0,tvParallaxMagnification:!1,tvParallaxProperties:!1,tvParallaxShiftDistanceX:!1,tvParallaxShiftDistanceY:!1,tvParallaxTiltAngle:!1,"aria-busy":!0,"aria-checked":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-live":!0,"aria-modal":!0,"aria-multiselectable":!0,"aria-required":!0,"aria-selected":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0},rEe={children:!0,accessibilityAccessKey:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityDescription:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLevel:!0,accessibilityLiveRegion:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,adjustsFontSizeToFit:!1,allowFontScaling:!0,android_hyphenationFrequency:!1,dataDetectorType:!1,disabled:!0,dynamicTypeRamp:!1,ellipsizeMode:!0,focusable:!0,id:!0,importantForAccessibility:!0,keyDownEvents:!0,keyUpEvents:!0,lineBreakMode:!0,lineBreakStrategyIOS:!0,maxFontSizeMultiplier:!0,minimumFontScale:!0,nativeID:!0,numberOfLines:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onLayout:!0,onLongPress:!0,onMagicTap:!1,onPress:!0,onPressIn:!0,onPressOut:!0,onTextLayout:!0,role:!0,selectable:!0,selectionColor:!0,style:!0,suppressHighlighting:!0,testID:!0,textBreakStrategy:!0,textStyle:!0,tooltip:!0,"aria-busy":!0,"aria-checked":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-live":!0,"aria-modal":!0,"aria-selected":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0},nEe={children:!0,accessibilityActions:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLiveRegion:!0,accessibilityRole:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,alt:!0,blurRadius:!0,borderBottomLeftRadius:!0,borderBottomRightRadius:!0,borderRadius:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,capInsets:!0,crossOrigin:!0,defaultSource:!0,fadeDuration:!0,height:!0,id:!0,importantForAccessibility:!0,loadingIndicatorSource:!0,nativeID:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onError:!0,onLayout:!0,onLoad:!0,onLoadEnd:!0,onLoadStart:!0,onMagicTap:!0,onPartialLoad:!0,onProgress:!0,progressiveRenderingEnabled:!0,referrerPolicy:!0,resizeMethod:!0,resizeMode:!0,role:!0,source:!0,src:!0,srcSet:!0,style:!0,testID:!0,tintColor:!0,width:!0,"aria-busy":!0,"aria-checked":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-live":!0,"aria-modal":!0,"aria-selected":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0}});var Ov=f(()=>{"use strict";s();uY()});var nP,Zg,lY=f(()=>{"use strict";s();nP=function(t){return"pageX"in t.nativeEvent},Zg=function(t){return"key"in t.nativeEvent}});var fO=Re((xSt,fY)=>{"use strict";s();var oEe=function(t,r,n,o,a,d,c,u){if(!t){var l;if(r===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var p=[n,o,a,d,c,u],g=0;l=new Error(r.replace(/%s/g,function(){return p[g++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}};fY.exports=oEe});function mY(){return pY}var bSt,pY,gY=f(()=>{"use strict";s();bSt=I(ee()),pY=!1;pY=!0});function Nv(e){return typeof e=="number"?{bottom:e,left:e,right:e,top:e}:e}var pO=f(()=>{"use strict";s()});function Mv(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=0),Math.max(t,e??r)}var xY,TY,iEe,hY,yY,CY,aEe,sEe,dEe,oP,vY,bY,SY=f(()=>{"use strict";s();k();xY=I(ee()),TY=I(fO());gY();pO();iEe={NOT_RESPONDER:{DELAY:"ERROR",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"ERROR",RESPONDER_TERMINATED:"ERROR",ENTER_PRESS_RECT:"ERROR",LEAVE_PRESS_RECT:"ERROR",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_IN:{DELAY:"RESPONDER_ACTIVE_PRESS_IN",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_OUT:{DELAY:"RESPONDER_ACTIVE_PRESS_OUT",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_LONG_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_LONG_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},ERROR:{DELAY:"NOT_RESPONDER",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"NOT_RESPONDER",LEAVE_PRESS_RECT:"NOT_RESPONDER",LONG_PRESS_DETECTED:"NOT_RESPONDER"}},hY=function(t){return t==="RESPONDER_ACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_LONG_PRESS_IN"},yY=function(t){return t==="RESPONDER_ACTIVE_PRESS_OUT"||t==="RESPONDER_ACTIVE_PRESS_IN"},CY=function(t){return t==="RESPONDER_INACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_LONG_PRESS_IN"},aEe=function(t){return t==="RESPONDER_TERMINATED"||t==="RESPONDER_RELEASE"},sEe=370,dEe=130,oP={bottom:30,left:20,right:20,top:20};vY=function(t){var r=t.nativeEvent,n=r.changedTouches,o=r.touches;return o!=null&&o.length>0?o[0]:n!=null&&n.length>0?n[0]:t.nativeEvent},bY=function(){function e(t){var r=this;this._eventHandlers=null,this._hoverInDelayTimeout=null,this._hoverOutDelayTimeout=null,this._isHovered=!1,this._longPressDelayTimeout=null,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._responderID=null,this._responderRegion=null,this._touchState="NOT_RESPONDER",this._measureCallback=function(n,o,a,d,c,u){!n&&!o&&!a&&!d&&!c&&!u||(r._responderRegion={bottom:u+d,left:c,right:c+a,top:u})},this.configure(t)}return e.prototype.configure=function(t){this._config=t},e.prototype.reset=function(){this._cancelHoverInDelayTimeout(),this._cancelHoverOutDelayTimeout(),this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()},e.prototype.getEventHandlers=function(){return this._eventHandlers==null&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers},e.prototype._createEventHandlers=function(){var t=this,r={onBlur:function(d){var c=t._config.onBlur;c!=null&&c(d)},onFocus:function(d){var c=t._config.onFocus;c!=null&&c(d)}},n={onStartShouldSetResponder:function(){var d=t._config.disabled;return d==null?!0:!d},onResponderGrant:function(d){d.persist(),t._cancelPressOutDelayTimeout(),t._responderID=d.currentTarget,t._touchState="NOT_RESPONDER",t._receiveSignal("RESPONDER_GRANT",d);var c=Mv(t._config.delayPressIn,0,dEe);c>0?t._pressDelayTimeout=setTimeout(function(){t._receiveSignal("DELAY",d)},c):t._receiveSignal("DELAY",d);var u=Mv(t._config.delayLongPress,10,sEe);t._longPressDelayTimeout=setTimeout(function(){t._handleLongPress(d)},u+c)},onResponderMove:function(d){t._config.onPressMove!=null&&t._config.onPressMove(d);var c=t._responderRegion;if(c!=null){var u=vY(d);if(u==null){t._cancelLongPressDelayTimeout(),t._receiveSignal("LEAVE_PRESS_RECT",d);return}if(t._touchActivatePosition!=null){var l=t._touchActivatePosition.pageX-u.pageX,p=t._touchActivatePosition.pageY-u.pageY;Math.hypot(l,p)>10&&t._cancelLongPressDelayTimeout()}t._isTouchWithinResponderRegion(u,c)?t._receiveSignal("ENTER_PRESS_RECT",d):(t._cancelLongPressDelayTimeout(),t._receiveSignal("LEAVE_PRESS_RECT",d))}},onResponderRelease:function(d){t._receiveSignal("RESPONDER_RELEASE",d)},onResponderTerminate:function(d){t._receiveSignal("RESPONDER_TERMINATED",d)},onResponderTerminationRequest:function(){var d=t._config.cancelable;return d||!0},onClick:function(d){var c=t._config.onPress;c!=null&&c(d)}},o={onMouseEnter:function(d){if(mY()){t._isHovered=!0,t._cancelHoverOutDelayTimeout();var c=t._config.onHoverIn;if(c!=null){var u=Mv(t._config.delayHoverIn);u>0?t._hoverInDelayTimeout=setTimeout(function(){c(d)},u):c(d)}}},onMouseLeave:function(d){if(t._isHovered){t._isHovered=!1,t._cancelHoverInDelayTimeout();var c=t._config.onHoverOut;if(c!=null){var u=Mv(t._config.delayHoverOut);u>0?t._hoverInDelayTimeout=setTimeout(function(){c(d)},u):c(d)}}}};return m(m(m({},r),n),o)},e.prototype._receiveSignal=function(t,r){var n=this._touchState,o=iEe[n][t];this._responderID==null&&t==="RESPONDER_RELEASE"||((0,TY.default)(o!=null&&o!=="ERROR","Pressability: Invalid signal `%s` for state `%s` on responder: %s",t,n,typeof this._responderID=="number"?this._responderID:"<<host component>>"),n!==o&&(this._performTransitionSideEffects(n,o,t,r),this._touchState=o))},e.prototype._performTransitionSideEffects=function(t,r,n,o){aEe(n)&&(this._touchActivatePosition=null,this._cancelLongPressDelayTimeout());var a=t==="NOT_RESPONDER"&&r==="RESPONDER_INACTIVE_PRESS_IN",d=!yY(t)&&yY(r);if((a||d)&&this._measureResponderRegion(),CY(t)&&n==="LONG_PRESS_DETECTED"){var c=this._config.onLongPress;c!=null&&c(o)}var u=hY(t),l=hY(r);if(!u&&l?this._activate(o):u&&!l&&this._deactivate(o),CY(t)&&n==="RESPONDER_RELEASE"){var p=this._config,c=p.onLongPress,g=p.onPress;if(g!=null){var h=c!=null&&t==="RESPONDER_ACTIVE_LONG_PRESS_IN"&&this._shouldLongPressCancelPress();h||(!l&&!u&&(this._activate(o),this._deactivate(o)),g(o))}}this._cancelPressDelayTimeout()},e.prototype._activate=function(t){var r=this._config.onPressIn,n=vY(t);this._touchActivatePosition={pageX:n.pageX,pageY:n.pageY},r!=null&&r(t)},e.prototype._deactivate=function(t){var r=this._config.onPressOut;if(r!=null){var n=Mv(this._config.delayPressOut);n>0?this._pressOutDelayTimeout=setTimeout(function(){r(t)},n):r(t)}},e.prototype._measureResponderRegion=function(){var t,r;if(this._responderID!=null)if(typeof this._responderID=="number")xY.UIManager.measure(this._responderID,this._measureCallback);else{var n=(t=this===null||this===void 0?void 0:this._responderID)===null||t===void 0?void 0:t.measure;typeof n=="function"&&this._measureCallback&&((r=this===null||this===void 0?void 0:this._responderID)===null||r===void 0||r.measure(this._measureCallback))}},e.prototype._isTouchWithinResponderRegion=function(t,r){var n,o,a,d,c=Nv(this._config.hitSlop),u=Nv(this._config.pressRectOffset),l=r.bottom,p=r.left,g=r.right,h=r.top;return c!=null&&(c.bottom!=null&&(l+=c.bottom),c.left!=null&&(p-=c.left),c.right!=null&&(g+=c.right),c.top!=null&&(h-=c.top)),l+=(n=u==null?void 0:u.bottom)!==null&&n!==void 0?n:oP.bottom,p-=(o=u==null?void 0:u.left)!==null&&o!==void 0?o:oP.left,g+=(a=u==null?void 0:u.right)!==null&&a!==void 0?a:oP.right,h-=(d=u==null?void 0:u.top)!==null&&d!==void 0?d:oP.top,t.pageX>p&&t.pageX<g&&t.pageY>h&&t.pageY<l},e.prototype._handleLongPress=function(t){(this._touchState==="RESPONDER_ACTIVE_PRESS_IN"||this._touchState==="RESPONDER_ACTIVE_LONG_PRESS_IN")&&this._receiveSignal("LONG_PRESS_DETECTED",t)},e.prototype._shouldLongPressCancelPress=function(){return!0},e.prototype._cancelHoverInDelayTimeout=function(){this._hoverInDelayTimeout!=null&&(clearTimeout(this._hoverInDelayTimeout),this._hoverInDelayTimeout=null)},e.prototype._cancelHoverOutDelayTimeout=function(){this._hoverOutDelayTimeout!=null&&(clearTimeout(this._hoverOutDelayTimeout),this._hoverOutDelayTimeout=null)},e.prototype._cancelLongPressDelayTimeout=function(){this._longPressDelayTimeout!=null&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)},e.prototype._cancelPressDelayTimeout=function(){this._pressDelayTimeout!=null&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)},e.prototype._cancelPressOutDelayTimeout=function(){this._pressOutDelayTimeout!=null&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)},e}()});function iP(e){var t=(0,Lv.useRef)(null);t.current==null&&(t.current=new bY(e));var r=t.current;return(0,Lv.useEffect)(function(){r.configure(e)},[e,r]),(0,Lv.useEffect)(function(){return function(){r.reset()}},[r]),r.getEventHandlers()}var Lv,mO=f(()=>{"use strict";s();Lv=I(L());SY()});function cEe(e){var t=qs.useState({hovered:!1}),r=t[0],n=t[1],o=qs.useCallback(function(d){n({hovered:!0}),e.onHoverIn&&e.onHoverIn(d)},[n,e.onHoverIn]),a=qs.useCallback(function(d){n({hovered:!1}),e.onHoverOut&&e.onHoverOut(d)},[n,e.onHoverOut]);return[{onHoverIn:o,onHoverOut:a},r]}function uEe(e){var t=qs.useState({focused:!1}),r=t[0],n=t[1],o=qs.useCallback(function(d){n({focused:!0}),e.onFocus&&e.onFocus(d)},[n,e.onFocus]),a=qs.useCallback(function(d){n({focused:!1}),e.onBlur&&e.onBlur(d)},[n,e.onBlur]);return[{onFocus:o,onBlur:a},r]}function lEe(e){var t=qs.useState({pressed:!1}),r=t[0],n=t[1],o=qs.useCallback(function(d){n({pressed:!0}),e.onPressIn&&e.onPressIn(d)},[n,e.onPressIn]),a=qs.useCallback(function(d){n({pressed:!1}),e.onPressOut&&e.onPressOut(d)},[n,e.onPressOut]);return[{onPressIn:o,onPressOut:a},r]}function qi(e){var t=cEe(e),r=t[0],n=t[1],o=uEe(e),a=o[0],d=o[1],c=lEe(e),u=c[0],l=c[1],p=iP(m(m(m(m({},e),r),a),u));return{props:m(m({},e),p),state:m(m(m({},n),d),l)}}var qs,IY=f(()=>{"use strict";s();k();qs=I(L());mO()});function fEe(e){var t=Ks.useState({hovered:!1}),r=t[0],n=t[1],o=e.onHoverIn,a=e.onHoverOut,d=Ks.useCallback(function(u){n({hovered:!0}),o==null||o(u)},[n,o]),c=Ks.useCallback(function(u){n({hovered:!1}),a==null||a(u)},[n,a]);return[{onHoverIn:d,onHoverOut:c},r]}function pEe(e){var t=Ks.useState({focused:!1}),r=t[0],n=t[1],o=e.onFocus,a=e.onBlur,d=Ks.useCallback(function(u){n({focused:!0}),o==null||o(u)},[n,o]),c=Ks.useCallback(function(u){n({focused:!1}),a==null||a(u)},[n,a]);return[{onFocus:d,onBlur:c},r]}function mEe(e){var t=Ks.useState({pressed:!1}),r=t[0],n=t[1],o=e.onPressIn,a=e.onPressOut,d=Ks.useCallback(function(u){n({pressed:!0}),o==null||o(u)},[n,o]),c=Ks.useCallback(function(u){n({pressed:!1}),a==null||a(u)},[n,a]);return[{onPressIn:d,onPressOut:c},r]}function qd(e){var t=e.onPressIn,r=e.onPressOut,n=e.onHoverIn,o=e.onHoverOut,a=e.onFocus,d=e.onBlur,c=je(e,["onPressIn","onPressOut","onHoverIn","onHoverOut","onFocus","onBlur"]),u=fEe({onHoverIn:n,onHoverOut:o}),l=u[0],p=u[1],g=pEe({onFocus:a,onBlur:d}),h=g[0],x=g[1],y=mEe({onPressIn:t,onPressOut:r}),T=y[0],b=y[1];return{props:m(m(m(m({},l),h),T),c),state:m(m(m({},p),x),b)}}var Ks,EY=f(()=>{"use strict";s();k();Ks=I(L())});function PY(e){var t=e.getForwardedRef,r=e.setLocalRef;return function(o){var a=t();r(o),typeof a=="function"?a(o):typeof a=="object"&&a!=null&&(a.current=o)}}var _Y=f(()=>{"use strict";s()});function Ar(e){var t=RY.useRef(),r=PY({getForwardedRef:function(){return e},setLocalRef:function(o){t.current=o,o&&(o.focus=function(){Hv.UIManager.dispatchViewManagerCommand((0,Hv.findNodeHandle)(o),Hv.UIManager.getViewManagerConfig("RCTView").Commands.focus,null)})}});return r}var RY,Hv,AY=f(()=>{"use strict";s();RY=I(L()),Hv=I(ee());_Y()});function Il(e,t){var r=aP.useState(e),n=r[0],o=r[1],a=aP.useCallback(function(d){o(d),t&&t(d)},[o,t]);return{onKeySelect:a,selectedKey:n}}var aP,kY=f(()=>{"use strict";s();aP=I(L())});function dP(e,t,r){var n=sP.useState(e??t),o=n[0],a=n[1],d=sP.useCallback(function(){r&&r(!o),a(!o)},[o,a]);return[t??o,d]}var sP,DY=f(()=>{"use strict";s();sP=I(L())});var wY,FY=f(()=>{"use strict";s();wY=I(L())});var gEe,OY=f(()=>{"use strict";s();gEe=I(L())});var gO,NY=f(()=>{"use strict";s();gO=I(L());OY()});function MY(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=function(a){e!==void 0&&!yEe(a.nativeEvent)&&t.includes(a.nativeEvent.key)&&(e(a),a.stopPropagation())};return n}function CEe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={onKeyUp:MY.apply(void 0,w([e],t,!1)),keyUpEvents:t.map(function(o){return{key:o}})};return n}function vEe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={onKeyDown:MY.apply(void 0,w([e],t,!1)),keyDownEvents:t.map(function(o){return{key:o}})};return n}var hEe,dIt,yEe,hO,Kd,ni,LY=f(()=>{"use strict";s();k();hEe=I(L()),dIt=I(ee());jc();yEe=function(t){return t&&(t.alt||t.altKey||t.meta||t.metaKey)};hO=Jt(CEe),Kd=Jt(vEe),ni=hO});function ts(e,t){var r=HY.useCallback(function(n){var o,a=["windows","win32","macos"].includes("win32"),d=["windows","win32"].includes("win32");a&&d&&((o=e==null?void 0:e.current)===null||o===void 0||o.focus()),t==null||t(n)},[t,e]);return r}var HY,pIt,BY=f(()=>{"use strict";s();HY=I(L()),pIt=I(ee())});function xEe(e,t){return t?m({disabled:e},t):{disabled:e}}var cP,UY=f(()=>{"use strict";s();k();Me();cP=Jt(xEe)});var Mn=f(()=>{"use strict";s();lY();IY();EY();mO();AY();kY();DY();FY();NY();pO();LY();BY();UY()});var eh,uP=f(()=>{"use strict";s();eh="Text"});var VY,jY=f(()=>{"use strict";s();Me();uP();VY=Xf(function(e){return{variant:"secondaryStandard",color:e.colors.bodyText}},eh)});var yO,lP,Yd,_Ee,REe,WY,Tr,CO=f(()=>{"use strict";s();yO=I(L()),lP=I(ee());Me();Mn();Ii();uP();jY();Yd=function(){return Yd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Yd.apply(this,arguments)},_Ee=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},REe=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},WY={},Tr=Cl(function(e,t){var r;e===void 0&&(e=WY);var n=e.align,o=n===void 0?void 0:n,a=e.block,d=e.color,c=e.font,u=e.italic,l=e.numberOfLines,p=e.onAccessibilityTap,g=e.onKeyUp,h=e.onKeyDown,x=e.keyUpEvents,y=e.keyDownEvents,T=e.onPress,b=e.size,S=e.strikethrough,E=e.style,P=e.truncate,_=P===void 0?!1:P,D=e.underline,O=e.variant,H=e.weight,V=e.wrap,M=V===void 0?!0:V,G=_Ee(e,["align","block","color","font","italic","numberOfLines","onAccessibilityTap","onKeyUp","onKeyDown","keyUpEvents","keyDownEvents","onPress","size","strikethrough","style","truncate","underline","variant","weight","wrap"]),K=ma(),z=t(K),$=z[0],q=z[1],re=lP.I18nManager.isRTL?o==="start"?"right":o==="end"?"left":o:o==="start"?"left":o==="end"?"right":o,ae=yO.default.useCallback(function(Ge){T&&T(Ge),Ge.stopPropagation()},[T]),ie=ni(ae," ","Enter"),Te=yO.default.useCallback(function(Ge){p?p():T(Ge)},[T,p]);r=$f($,q,{color:d,variant:O,fontFamily:c=="base"?"primary":c,fontMaximumSize:$.maximumFontSize,fontSize:F.font["size"+b],fontWeight:F.font.weight[H],fontStyle:u?"italic":void 0,textAlign:re,textDecorationLine:D&&S?"underline line-through":D?"underline":S?"line-through":void 0}),$=r[0],q=r[1];var Oe=q(function(){return Yd({margin:0,color:$.color,fontStyle:$.fontStyle,textAlign:$.textAlign,textDecorationLine:$.textDecorationLine},tn.from($,K))},REe(["color","fontStyle","textAlign","textDecorationLine"],tn.keys,!0))[0],ke=void 0,it=WY,_e=!0,ct={onKeyUp:g,keyUpEvents:x,validKeysUp:void 0,onKeyDown:h,keyDownEvents:y,validKeysDown:void 0,onAccessibilityTap:Te};return function(Ge,Nt){var Vt=Yd(Yd(Yd(Yd(Yd(Yd({},G),ie),ct),Ge),it),{onPress:T,numberOfLines:l??(_||!M)?1:0,style:Si(Oe,e.style,Ge==null?void 0:Ge.style)});return delete Vt.style.dynamicTypeRamp,delete Vt.style.maximumFontSize,Ae(lP.Text,Yd({ellipsizeMode:!M&&!_?"clip":"tail"},Vt),Nt)}},VY);Tr.displayName=eh});var AEe,kEe,DEe,wEe,FEe,OEe,NEe,MEe,LEe,HEe,BEe,UEe,VEe,zY=f(()=>{"use strict";s();CO();AEe=Tr.customize({variant:"caption1"}),kEe=Tr.customize({variant:"body1"}),DEe=Tr.customize({variant:"body1Strong"}),wEe=Tr.customize({variant:"body2"}),FEe=Tr.customize({variant:"body2Strong"}),OEe=Tr.customize({variant:"subtitle1"}),NEe=Tr.customize({variant:"subtitle1Strong"}),MEe=Tr.customize({variant:"subtitle2"}),LEe=Tr.customize({variant:"subtitle2Strong"}),HEe=Tr.customize({variant:"title1"}),BEe=Tr.customize({variant:"title1Strong"}),UEe=Tr.customize({variant:"largeTitle"}),VEe=Tr.customize({variant:"display"})});var th,fP=f(()=>{"use strict";s();th="RNFText"});function Dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vs.apply(void 0,jEe([WEe],e,!1))}function pP(e,t){var r=typeof t=="function"?t:function(n){return t[n]};return e&&e._precedence&&e._precedence.filter(function(n){return r(n)})||[]}function vO(e,t){var r=e,n=e._overrides,o=e._precedence;if(t&&n&&o)for(var a=pP(e,t),d=0,c=a;d<c.length;d++){var u=c[d];r=Dt(r,r._overrides[u])}return r}var jEe,WEe,GY=f(()=>{"use strict";s();js();Hg();jEe=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},WEe={tokens:0,object:dt,get _overrides(){return{object:this}}}});var Po=f(()=>{"use strict";s();GY()});function KY(e,t,r){var n=dt(e,t);if(r&&n){var o={};Object.getOwnPropertyNames(n).forEach(function(a){r(a)||(o[a]=void 0)}),n=dt(n,o)}return n}function YY(e){return e._canCompose=!0,e}function $Y(e,t){var r={composable:e,slotInfo:t},n=e&&e.slots;if(n){var o=r.Slots={},a=r.childInfo={};Object.getOwnPropertyNames(n).forEach(function(d){var c=n[d],u=c.slotType,l=c.filter,p=typeof u!="string"&&u.__composable||void 0,g=a[d]=$Y(p,n[d]);p?o[d]=YY(function(h){for(var x=[],y=1;y<arguments.length;y++)x[y-1]=arguments[y];var T=g.renderData,b=g.Slots;if(l||h){var S={root:KY(T.slotProps.root,h,l)};T.slotProps=Dt(T.slotProps,S)}return p.render.apply(p,qY([b,T],x,!1))}):o[d]=YY(function(h){for(var x=[],y=1;y<arguments.length;y++)x[y-1]=arguments[y];var T=KY(g.renderData.slotProps.root,h,l);return Bv.createElement.apply(Bv,qY([u,T],x,!1))})})}return r}function QY(e,t){if(t.composable){var r=t.composable,n=r.usePrepareProps,o=r.useStyling;t.renderData=n(e,o)||{}}else t.renderData={slotProps:{root:e}};var a=t.childInfo;if(a){var d=t.renderData.slotProps||{};Object.getOwnPropertyNames(a).forEach(function(c){QY(d[c],a[c])})}return{renderData:t.renderData,Slots:t.Slots}}function XY(e,t){var r=Bv.useMemo(function(){return $Y(t)},[]);return QY(e,r)}var Bv,qY,JY=f(()=>{"use strict";s();Bv=I(L());Po();Hg();qY=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});function mP(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return typeof e=="function"&&e._canCompose?e.apply(void 0,xO([t],r,!1)):TO.createElement.apply(TO,xO([e,t],r,!1))}function Se(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return mP.apply(void 0,xO([e,t],r,!1))}var TO,xO,bO=f(()=>{"use strict";s();TO=I(L()),xO=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});function ZY(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return mP.apply(void 0,qEe([e.root,void 0],r,!1))}function e$(e,t){var r=Dt(t(e),{root:e});return{slotProps:r}}function KEe(e){var t=e.slots&&Object.getOwnPropertyNames(e.slots).length||0;if(t){if(t>1&&!e.render)throw"A composable component with multiple slots cannot use the default render implementation"}else throw"A composable component must have at least one slot specified";for(var r in e.slots){var n=e.slots[r];n&&(typeof n!="object"||!n.slotType)&&(e.slots[r]={slotType:n})}return e.useStyling||(e.useStyling=function(){return{}}),e.render=e.render||ZY,e.usePrepareProps=e.usePrepareProps||e$,e}function $c(e){var t=KEe(e),r=function(o){var a=o,d=a.children,c=GEe(a,["children"]),u=XY(c,t),l=u.renderData,p=u.Slots;return t.render(p,l,d)};return r.displayName=t.displayName,r.__composable=t,r}var GEe,qEe,t$=f(()=>{"use strict";s();JY();bO();Po();GEe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},qEe=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});var Ki=f(()=>{"use strict";s();t$();bO()});function r$(e,t,r){return e?Dt.apply(void 0,e.map(function(n){return typeof n=="string"?r&&r(t,n)||void 0:typeof n=="function"?n(t):n})):void 0}function SO(e,t,r,n,o){var a,d=r(function(){return r$(e,t,o)},[t]),c=d[0],u=d[1],l=pP(c,n);return l.length>0&&(a=u(function(){return vO(c,n)},l),c=a[0],u=a[1]),{settings:c,getMemoValue:u}}var n$=f(()=>{"use strict";s();Po()});var o$=f(()=>{"use strict";s();n$()});function IO(e){if(e){var t=e._overrides,r=e._precedence,n=YEe(e,["_overrides","_precedence"]);return n}return e}function EO(e,t){return e.components&&e.components[t]||void 0}var YEe,i$=f(()=>{"use strict";s();YEe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}});var a$=f(()=>{"use strict";s();Po();js()});var s$=f(()=>{"use strict";s();i$();a$();Yf()});function $Ee(e,t,r){var n=PO({},t),o={};for(var a in r)e[a]!==void 0&&e[a]!==n[a]&&(o[a]=n[a]=e[a]);return{tokens:n,deltas:o,tokenKeys:r}}function _O(e,t,r,n,o){r=r||{};var a=r.tokens||{},d=n.handlers,c=n.tokenKeys,u=$Ee(e,a,c),l={tokens:u.tokens||{}};return Object.getOwnPropertyNames(d).forEach(function(p){var g=d[p];l[p]=g(r[p]||{},u,t,p,o)}),l}var PO,d$=f(()=>{"use strict";s();PO=function(){return PO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},PO.apply(this,arguments)}});function XEe(e,t,r,n){e[t]!==void 0&&(n[r||t]=e[t])}function JEe(e,t,r,n){var o=r.source,a=r.lookup;if(e[o]!==void 0){var d=a&&a(t),c=e[o];typeof c=="string"&&d&&d[c]!==void 0&&(c=d[c]),n[r.target||o]=c}}function ZEe(e,t,r){var n={};if(r.toStyle.length>0){for(var o={},a=0,d=r.toStyle;a<d.length;a++){var c=d[a];JEe(e,t,c,o)}Object.keys(o).length>0&&(n.style=o)}for(var u=0,l=r.toTokens;u<l.length;u++){var c=l[u];XEe(e,c.source,c.target,n)}return n}function e0e(e,t,r){if(e&&e.length>0)return dt.apply(void 0,e.map(function(n){return n(t,r)}))}function t0e(e,t,r,n,o,a,d,c){var u=t.tokens,l=t.tokenKeys,p=t.deltas;return o(function(){var g=dt(e,n==="root"?l:void 0,ZEe(u,r,d),e0e(d.functions,u,r));return c&&(g=c(g,n)),g},QEe([n],a.map(function(g){return p[g]!==void 0?p[g]:""}),!0))[0]}function RO(e,t){var r={},n={};return Object.getOwnPropertyNames(e).forEach(function(o){var a=e[o],d={toStyle:[],toTokens:[],functions:[]},c=d.toStyle,u=d.toTokens,l=d.functions,p={};if(a)for(var g=Array.isArray(a)?a:[a],h=0,x=g;h<x.length;h++){var y=x[h];if(typeof y=="function")l.push(y),y._keys.forEach(function(_){p[_]=void 0});else for(var T=Array.isArray(y)?y:[y],b=0,S=T;b<S.length;b++){var E=S[b];p[E.source]=void 0;var P=E.target||E.source;t&&t(o,P)?u.push(E):c.push(E)}}Object.assign(r,p),n[o]=function(_,D,O,H,V){var M=Object.getOwnPropertyNames(p);return t0e(_,D,O,H,V,M,d)}}),{tokenKeys:r,handlers:n}}var QEe,c$=f(()=>{"use strict";s();Hg();QEe=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});var rs=f(()=>{"use strict";s();d$();c$();On()});function AO(e){var t=e&&typeof e;return(t==="object"||t==="function")&&e.__composable||void 0}function r0e(e,t){return EO(e,t)}function n0e(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r],o=typeof n!="object"?n:n.slotType,a=AO(o);t[r]=a&&a.resolvedTokens&&a.resolvedTokens.tokenKeys||void 0}),function(r,n){return t[r]&&t[r].hasOwnProperty(n)}}function o0e(e,t,r,n){var o=Wc()||ei;n=n||e;var a=SO(t.settings,o,r,n,r0e),d=a.settings,c=a.getMemoValue;return IO(_O(e,o,d,t.resolvedTokens,c))}function kO(e){var t=e.styles,r=e.slots;e.resolvedTokens=RO(t,n0e(r));var n=No(e);return function(o,a){return o0e(o,e,n,a)}}var DO=f(()=>{"use strict";s();o$();s$();rs();Yf();zg();jc()});function i0e(e,t){if(t){var r={settings:[].concat(t.settings||[],e.settings||[]).filter(function(n){return n})};return fa(t,e,r)}return e}function jr(e,t){var r=i0e(e,t&&AO(t));r.useStyling=kO(r);var n=$c(r);return n.displayName=r.displayName,Object.assign(n,r.statics),n.customize=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return jr({settings:o},n)},n.compose=function(o){return jr(o,n)},n}var u$=f(()=>{"use strict";s();Ki();DO();js()});var ns=f(()=>{"use strict";s();u$();DO()});var l$,f$=f(()=>{"use strict";s();fP();l$=[{tokens:{variant:"secondaryStandard",color:"bodyText"},root:{style:{margin:0}},_overrides:{disabled:{tokens:{color:"disabledText"}}},_precedence:["disabled"]},th]});var p$,on,m$=f(()=>{"use strict";s();p$=I(ee());Ov();On();ns();f$();fP();on=jr({displayName:th,settings:l$,slots:{root:{slotType:p$.Text,filter:lO}},styles:{root:[Ja,To]}})});var ga=f(()=>{"use strict";s();CO();uP();zY();fP();m$()});var Zf=Re((U0t,g$)=>{s();g$.exports=OfficePlatformGlobal.SVG});function a0e(e){var t=e.width,r=e.height,n=e.color,o=Si(e.style,y$({width:t,height:r,tintColor:n},[t,r,n])[0]);return ep.createElement(Uv.Image,{source:e.rasterImageSource.src,style:o,accessible:e.accessible,accessibilityRole:"image",accessibilityLabel:e.accessibilityLabel})}function s0e(e,t){return t}function c0e(e){var t=e.fontSource,r=d0e({fontSrcFile:t.fontSrcFile,fontFamily:t.fontSrcFile!=null?s0e(t.fontSrcFile,t.fontFamily):t.fontFamily,fontSize:t.fontSize,color:e.color},[e.color,t.fontSrcFile,t.fontFamily,t.fontSize])[0],n=String.fromCharCode(t.codepoint);return ep.createElement(on,{accessible:e.accessible,style:r},n)}function u0e(e){var t=e.svgSource,r=e.accessible,n=e.accessibilityLabel,o=e.width,a=e.height,d=e.color,c=Si(e.style,y$({width:o,height:a},[o,a])[0]),u={width:o,height:a,color:d};return t.viewBox&&(u.viewBox=t.viewBox),t.src?ep.createElement(Uv.View,{style:c,accessible:r,accessibilityRole:"image",accessibilityLabel:n},ep.createElement(t.src,gP({},u))):t.uri?ep.createElement(Uv.View,{style:c,accessible:r,accessibilityRole:"image",accessibilityLabel:n},ep.createElement(h$.SvgUri,gP({uri:t.uri},u))):null}var ep,Uv,h$,gP,y$,d0e,El,C$=f(()=>{"use strict";s();ep=I(L()),Uv=I(ee());Me();Me();ga();h$=I(Zf()),gP=function(){return gP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},gP.apply(this,arguments)},y$=No();d0e=No();El=Nn(function(e){var t=ma();return function(r){var n,o=e.color||t.colors.buttonText,a=(n=e.accessible)!==null&&n!==void 0?n:!0,d={color:o,accessible:a},c=dt(d,e,r);return c.svgSource?u0e(c):c.fontSource?c0e(c):c.rasterImageSource?a0e(c):null}})});function Pl(e){if(e===void 0)return null;if(typeof e=="number"){var t={src:e},r=v$.Image.resolveAssetSource(+e);return{rasterImageSource:t,width:r.width,height:r.height}}else if(typeof e=="string"){var t={src:{uri:e}};return{rasterImageSource:t}}else return e}var v$,x$=f(()=>{"use strict";s();v$=I(ee())});var wO,FO=f(()=>{"use strict";s();wO="FontIcon"});var OO,NO=f(()=>{"use strict";s();OO="SvgIcon"});function f0e(e,t){return t}var ePt,MO,l0e,T$,p0e,b$=f(()=>{"use strict";s();ePt=I(ee());Me();MO=function(){return MO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},MO.apply(this,arguments)},l0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},T$=function(t){var r=t.accessible,n=t.color,o=t.fontSrcFile,a=t.fontFamily,d=t.fontSize,c=t.style,u=l0e(t,["accessible","color","fontSrcFile","fontFamily","fontSize","style"]),l=p0e({fontFamily:o!=null?f0e(o,a):a,fontSize:d,color:n},[n,d,a])[0],p=Si(l,c);return MO({accessible:r??!0,style:p},u)};p0e=No()});var S$,I$,LO,m0e,hP,HO=f(()=>{"use strict";s();S$=I(L()),I$=I(ee());Me();FO();b$();LO=function(){return LO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},LO.apply(this,arguments)},m0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},hP=Nn(function(e){var t=T$(e);return function(r){var n=dt(t,r),o=n.codepoint,a=m0e(n,["codepoint"]),d=String.fromCharCode(o);return S$.createElement(I$.Text,LO({},a),d)}});hP.displayName=wO});var BO,g0e,h0e,E$,P$=f(()=>{"use strict";s();Me();BO=function(){return BO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},BO.apply(this,arguments)},g0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},h0e=No(),E$=function(t){var r=t.accessible,n=t.style,o=t.height,a=t.width,d=g0e(t,["accessible","style","height","width"]);return BO({accessible:r??!0,height:o,style:Si(n,h0e({width:a,height:o},[a,o])[0]),width:a},d)}});var yP,_$,R$,UO,y0e,CP,VO=f(()=>{"use strict";s();yP=I(L()),_$=I(ee());Me();R$=I(Zf());NO();P$();UO=function(){return UO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},UO.apply(this,arguments)},y0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},CP=Nn(function(e){var t=E$(e);return function(r){var n=dt(t,r),o=n.style,a=n.height,d=n.width,c=n.src,u=n.uri,l=n.viewBox,p=n.color,g=y0e(n,["style","height","width","src","uri","viewBox","color"]),h=!0;return c||u?yP.createElement(_$.View,UO({style:o,accessibilityRole:"image"},g),c?yP.createElement(t.src,{viewBox:l,width:d,height:a,color:p}):yP.createElement(R$.SvgUri,{uri:u,viewBox:l,width:d,height:a,color:p})):null}});CP.displayName=OO});var jO,vP,tp,A$=f(()=>{"use strict";s();jO=I(L());HO();VO();vP=function(){return vP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},vP.apply(this,arguments)},tp=function(t){return t.svgSource?jO.createElement(CP,vP({color:t.color,height:t.size,width:t.size},t.svgSource)):t.fontSource?jO.createElement(hP,vP({color:t.color,fontSize:t.size},t.fontSource)):null}});var rp=f(()=>{"use strict";s();C$();x$();FO();NO();A$();HO();VO()});var Vv,WO=f(()=>{"use strict";s();Vv="Button"});var jv,zO=f(()=>{"use strict";s();jv="ActivityIndicator"});function C0e(e){if(typeof e>"u")return e;switch(e){case"xSmall":return"small";case"small":return"small";case"medium":return"small";case"large":return"large";case"xLarge":return"large";default:(0,D$.default)(e)}}var k$,D$,GO,xP,BPt,w$,F$=f(()=>{"use strict";s();k$=I(ee());Me();D$=I(M0());zO();GO=function(){return GO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},GO.apply(this,arguments)},xP={xSmall:12,small:16,medium:24,large:32,xLarge:36};BPt={tokens:[function(){return{activityIndicatorColor:k$.Appearance.getColorScheme()==="light"?"#BDBDBD":"#666666",lineThickness:"medium",size:"medium"}},jv],tokensThatAreAlsoProps:"all",slotProps:{root:lt(function(e){return{activityIndicatorColor:e.activityIndicatorColor,size:e.size,lineThickness:e.lineThickness!="medium"?e.lineThickness:e.size,accessibilityLabel:"progressbar",accessible:!0,style:{width:xP[e.size],height:xP[e.size]}}},["activityIndicatorColor","lineThickness","size"]),svg:lt(function(e){return{width:xP[e.size],height:xP[e.size]}},["size"])}},w$={tokens:[function(){return{size:"small"}},jv],tokensThatAreAlsoProps:"all",slotProps:{root:lt(function(e){return GO({color:e.activityIndicatorColor},e.size&&{size:C0e(e.size)})},["activityIndicatorColor","size"])}}});var O$,TP,Wv,qO=f(()=>{"use strict";s();O$=I(ee());Me();F$();zO();TP=function(){return TP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},TP.apply(this,arguments)},Wv=rn(TP(TP({displayName:jv},w$),{slots:{root:O$.ActivityIndicator},useRender:function(t,r){var n=r(t);return function(){return Ae(n.root,null)}}}))});var N$=f(()=>{"use strict";s();qO();qO()});var M$=f(()=>{"use strict";s();N$()});function bP(){return v0e}var v0e,L$=f(()=>{"use strict";s();v0e={marginTop:-1,marginBottom:1,marginStart:0,marginEnd:-2}});var H$=f(()=>{"use strict";s();L$()});var _o,B$,x0e,U$=f(()=>{"use strict";s();_o=I(ee());zc();B$=function(t){return Wt(t)?x0e:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForeground1,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1,disabled:{backgroundColor:t.colors.neutralBackgroundDisabled,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.neutralStrokeDisabled,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1Hover},pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1Pressed},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1Hover},primary:{backgroundColor:t.colors.brandBackground,color:t.colors.neutralForegroundOnBrand,borderColor:t.colors.brandStroke1,iconColor:t.colors.neutralForegroundOnBrand,disabled:{backgroundColor:t.colors.neutralBackgroundDisabled,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.neutralStrokeDisabled,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.brandBackgroundHover,color:t.colors.neutralForegroundOnBrandHover,borderColor:t.colors.brandBackgroundHover,iconColor:t.colors.neutralForegroundOnBrandHover},pressed:{backgroundColor:t.colors.brandBackgroundPressed,color:t.colors.neutralForegroundOnBrandPressed,borderColor:t.colors.brandBackgroundPressed,iconColor:t.colors.neutralForegroundOnBrandPressed},focused:{backgroundColor:t.colors.brandBackgroundHover,color:t.colors.neutralForegroundOnBrandHover,borderColor:t.colors.strokeFocus2,borderInnerColor:t.colors.strokeFocus1,iconColor:t.colors.neutralForegroundOnBrandHover}},subtle:{backgroundColor:t.colors.subtleBackground,color:t.colors.neutralForeground1,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1,disabled:{backgroundColor:t.colors.subtleBackground,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.subtleBackgroundHover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.subtleBackgroundHover,iconColor:t.colors.neutralForeground1Hover},pressed:{backgroundColor:t.colors.subtleBackgroundPressed,color:t.colors.neutralForeground1Pressed,borderColor:t.colors.subtleBackgroundPressed,iconColor:t.colors.neutralForeground1Pressed},focused:{backgroundColor:t.colors.subtleBackgroundHover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1Hover}}}},x0e={backgroundColor:(0,_o.PlatformColor)("ButtonFace"),borderColor:(0,_o.PlatformColor)("ButtonText"),color:(0,_o.PlatformColor)("ButtonText"),iconColor:(0,_o.PlatformColor)("ButtonText"),disabled:{backgroundColor:(0,_o.PlatformColor)("ButtonFace"),borderColor:(0,_o.PlatformColor)("GrayText"),color:(0,_o.PlatformColor)("GrayText"),iconColor:(0,_o.PlatformColor)("GrayText")},hovered:{backgroundColor:(0,_o.PlatformColor)("Highlight"),color:(0,_o.PlatformColor)("HighlightText"),iconColor:(0,_o.PlatformColor)("HighlightText")},pressed:{backgroundColor:(0,_o.PlatformColor)("Highlight"),color:(0,_o.PlatformColor)("HighlightText"),iconColor:(0,_o.PlatformColor)("HighlightText")},focused:{backgroundColor:(0,_o.PlatformColor)("Highlight"),color:(0,_o.PlatformColor)("HighlightText"),iconColor:(0,_o.PlatformColor)("HighlightText")}}});var V$,j$=f(()=>{"use strict";s();Ii();V$=function(t){return{medium:{hasContent:{fontFamily:t.typography.families.secondary,fontSize:F.font.size300,fontWeight:F.font.weight.semibold}},small:{hasContent:{fontFamily:t.typography.families.primary,fontSize:F.font.size200,fontWeight:F.font.weight.regular}},large:{hasContent:{fontFamily:t.typography.families.secondary,fontSize:F.font.size400,fontWeight:F.font.weight.semibold}}}}});var W$,z$=f(()=>{"use strict";s();Ii();zc();W$=function(t){return{borderWidth:F.stroke.width10,borderInnerWidth:F.stroke.width10,block:{width:"100%"},medium:{padding:F.size80-F.stroke.width10,iconSize:16,focused:{borderWidth:0,padding:F.size80},primary:!Wt(t)&&{focused:{borderWidth:F.stroke.width20,padding:F.size80-F.stroke.width20},square:{focused:{borderWidth:F.stroke.width10,padding:F.size80-F.stroke.width10}}},hasContent:{minWidth:96,padding:F.size60-F.stroke.width10,paddingHorizontal:F.size120-F.stroke.width10,hasIconAfter:{spacingIconContentAfter:F.size80},hasIconBefore:{spacingIconContentBefore:F.size80},focused:{padding:F.size60,paddingHorizontal:F.size120},primary:!Wt(t)&&{focused:{padding:F.size60-F.stroke.width20,paddingHorizontal:F.size120-F.stroke.width20},square:{focused:{padding:F.size60-F.stroke.width10,paddingHorizontal:F.size120-F.stroke.width10}}}}},small:{padding:F.size40-F.stroke.width10,iconSize:16,focused:{borderWidth:0,padding:F.size40},primary:!Wt(t)&&{focused:{borderWidth:F.stroke.width20,padding:F.size40-F.stroke.width20},square:{focused:{borderWidth:F.stroke.width10,padding:F.size40-F.stroke.width10}}},hasContent:{minWidth:64,minHeight:24,paddingHorizontal:F.size80-F.stroke.width10,hasIconAfter:{spacingIconContentAfter:F.size40},hasIconBefore:{spacingIconContentBefore:F.size40},focused:{paddingHorizontal:F.size80},primary:!Wt(t)&&{focused:{paddingHorizontal:F.size80-F.stroke.width20},square:{focused:{paddingHorizontal:F.size80-F.stroke.width10}}}}},large:{padding:F.size100-F.stroke.width10,iconSize:20,focused:{borderWidth:0,padding:F.size100},primary:!Wt(t)&&{focused:{borderWidth:F.stroke.width20,padding:F.size100-F.stroke.width20},square:{focused:{borderWidth:F.stroke.width10,padding:F.size100-F.stroke.width10}}},hasContent:{minWidth:96,minHeight:40,padding:F.size80-F.stroke.width10,paddingHorizontal:F.size160-F.stroke.width10,hasIconAfter:{spacingIconContentAfter:F.size60},hasIconBefore:{spacingIconContentBefore:F.size60},focused:{padding:F.size80,paddingHorizontal:F.size160},primary:!Wt(t)&&{focused:{padding:F.size80-F.stroke.width20,paddingHorizontal:F.size160-F.stroke.width20},square:{focused:{padding:F.size80-F.stroke.width10,paddingHorizontal:F.size160-F.stroke.width10}}}}},rounded:{borderRadius:F.corner.radius40,borderInnerRadius:F.corner.radius40-1},circular:{borderRadius:F.corner.radiusCircular,borderInnerRadius:F.corner.radiusCircular-1},square:{borderRadius:F.corner.radiusNone,borderInnerRadius:F.corner.radiusNone}}}});var g_t,Ys,KO,T0e,G$,q$,K$,b0e,Y$=f(()=>{"use strict";s();g_t=I(ee());Me();H$();On();WO();U$();j$();z$();Ys=function(){return Ys=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ys.apply(this,arguments)},KO=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},T0e=["block","small","medium","large","hasContent","hasIconAfter","hasIconBefore","primary","subtle","outline","rounded","circular","square","hovered","focused","pressed","disabled"],G$={tokens:[W$,V$,B$,Vv],states:T0e,slotProps:Ys(Ys({},!1),{root:lt(function(e,t){return{style:Ys(Ys({display:"flex",alignItems:"center",flexDirection:"row",alignSelf:"flex-start",justifyContent:"center",width:e.width,backgroundColor:e.backgroundColor},Zo.from(e,t)),Mo.from(e,t)),android_ripple:{color:e.rippleColor}}},KO(KO(["backgroundColor","width","rippleColor"],Zo.keys,!0),Mo.keys,!0)),content:lt(function(e,t){return{style:Ys({},b0e(e,t,e.color,e))}},KO(["color","spacingIconContentAfter","spacingIconContentBefore"],tn.keys,!0)),icon:lt(function(e){return{color:e.iconColor,height:e.iconSize,width:e.iconSize}},["iconColor","iconSize"]),focusInnerBorder:lt(function(e){return{style:{position:"absolute",borderWidth:e.borderInnerWidth,borderColor:e.borderInnerColor,borderRadius:e.borderInnerRadius}}},["borderInnerWidth","borderInnerColor","borderInnerRadius"])})},q$=function(){return"small"},K$=function(t){var r=!0;switch(t){case"accent":return"primary";case"primary":case"subtle":case"outline":return t;default:return null}},b0e=function(t,r,n,o){var a=bP(),d=t.spacingIconContentBefore?{marginStart:a.marginStart+t.spacingIconContentBefore}:{},c=t.spacingIconContentAfter?{marginEnd:a.marginEnd+t.spacingIconContentAfter}:{};return Ys(Ys(Ys(Ys({color:n},bP()),d),c),tn.from(o,r))}});var $d,P_t,$s,S0e,SP,YO,$$=f(()=>{"use strict";s();$d=I(L()),P_t=I(ee());Me();Mn();zc();$s=function(){return $s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$s.apply(this,arguments)},S0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},SP=!1,YO=function(t){var r=$d.useRef(null),n=t.accessible,o=t.accessibilityRole,a=t.componentRef,d=a===void 0?r:a,c=t.disabled,u=t.onBlur,l=t.onClick,p=t.onLayout,g=t.loading,h=t.enableFocusRing,x=t.focusable,y=S0e(t,["accessible","accessibilityRole","componentRef","disabled","onBlur","onClick","onLayout","loading","enableFocusRing","focusable"]),T=!!c||!!g,b=T?null:d,S=ts(b,l),E=$d.useCallback(function(ie){SP=!1,u==null||u(ie)},[u]),P=qd($s($s({},y),{onPress:S,onBlur:E})),_=$d.useCallback(function(ie){!c&&(ie.nativeEvent.key==="Enter"||ie.nativeEvent.key===" ")&&(SP=!0)},[c]),D=$d.useCallback(function(ie){SP&&(l==null||l(ie),SP=!1)},[l]),O=ni(D," ","Enter"),H=t.accessibilityActions&&!!t.accessibilityActions.find(function(ie){return ie.name==="Toggle"}),V=ma(),M=t.appearance==="primary"&&!Wt(V),G=$d.useState(void 0),K=G[0],z=G[1],$=$d.useState(void 0),q=$[0],re=$[1],ae=$d.useCallback(function(ie){M&&(z(ie.nativeEvent.layout.height),re(ie.nativeEvent.layout.width)),p&&p(ie)},[p,z,re,M]);return{props:$s($s($s($s($s({},O),{onKeyDown:_}),P.props),T!==void 0&&{disabled:T}),{accessible:n??!0,accessibilityRole:o||"button",onAccessibilityTap:t.onAccessibilityTap||(H?void 0:t.onClick),accessibilityLabel:t.accessibilityLabel,enableFocusRing:h??!M,focusable:x??!T,ref:Ar(d),iconPosition:t.iconPosition||"before",loading:g,onLayout:ae}),state:$s($s({},P.state),{pressed:P.state.pressed,measuredWidth:q,measuredHeight:K,shouldUseTwoToneFocusBorder:M})}}});var zv,IP,np,I0e,E0e,op,P0e,_0e,Q$=f(()=>{"use strict";s();zv=I(L()),IP=I(ee());M$();Me();rp();ga();Y$();WO();$$();np=function(){return np=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},np.apply(this,arguments)},I0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},E0e=function(t,r,n){return r[t]||n[t]||t===K$(n.appearance)||t===n.size||!n.size&&t===q$()||t===n.shape||!n.shape&&t==="rounded"||t==="hovered"&&r[t]&&!n.loading||t==="hasContent"&&!n.iconOnly||t==="hasIconAfter"&&(n.icon||n.loading)&&n.iconPosition==="after"||t==="hasIconBefore"&&(n.icon||n.loading)&&(!n.iconPosition||n.iconPosition==="before")},op=rn(np(np({displayName:Vv},G$),{slots:{root:IP.Pressable,rippleContainer:!1,focusInnerBorder:IP.View,icon:El,content:Tr},useRender:function(t,r){var n=YO(t),o=Pl(t.icon),a=r(t,function(d){return E0e(d,n.state,t)});return function(d){for(var c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=dt(n.props,d),p=l.icon,g=l.iconOnly,h=l.iconPosition,x=l.loading,y=l.accessibilityLabel,T=I0e(l,["icon","iconOnly","iconPosition","loading","accessibilityLabel"]),b=!x&&p,S="";y===void 0&&zv.Children.forEach(c,function(D){typeof D=="string"&&(S=D)});var E=y??S,P=Ae(zv.Fragment,null,x&&Ae(Wv,null),b&&h==="before"&&Ae(a.icon,np({},o,{accessible:!1})),zv.Children.map(c,function(D){return typeof D=="string"?Ae(a.content,{accessible:!1,key:"content"},D):D}),b&&h==="after"&&Ae(a.icon,np({},o,{accessible:!1}))),_=!1;return Ae(a.root,np({},T,{accessibilityLabel:E}),P,n.state.focused&&n.state.measuredHeight&&n.state.measuredWidth&&n.state.shouldUseTwoToneFocusBorder&&Ae(a.focusInnerBorder,{style:_0e(n.state.measuredHeight,n.state.measuredWidth),accessible:!1,focusable:!1}))}}})),P0e=function(t,r){var n=2;return{height:t-n,width:r-n}},_0e=Jt(P0e)});var $O=f(()=>{"use strict";s();Q$()});var rh,EP=f(()=>{"use strict";s();rh="Callout"});function ip(e){return QO[e]||(QO[e]=(0,X$.requireNativeComponent)(e)),QO[e]}var X$,QO,J$=f(()=>{"use strict";s();X$=I(ee()),QO={}});var PP=f(()=>{"use strict";s();J$()});var Z$,eQ=f(()=>{"use strict";s();EP();Z$=[{tokens:{backgroundColor:"bodyStandoutBackground",beakWidth:20,borderColor:"bodyFrameBackground",borderWidth:1,directionalHint:"bottonLeftEdge",gapSpace:0,minPadding:0}},rh]});var RP,tQ,_P,R0e,A0e,Yi,rQ=f(()=>{"use strict";s();RP=I(L()),tQ=I(ee());PP();Mn();On();ns();Po();eQ();EP();_P=function(){return _P=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},_P.apply(this,arguments)},R0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},A0e=ip("RCTCallout"),Yi=jr({displayName:rh,usePrepareProps:function(t,r){var n=t.componentRef,o=t.target,a=R0e(t,["componentRef","target"]),d=Ar(n),c=RP.useState(null),u=c[0],l=c[1];RP.useLayoutEffect(function(){typeof o=="string"?l(o):o!=null&&o.current?l((0,tQ.findNodeHandle)(o.current)):l(null)},[o]);var p=Dt(r(t),{root:_P(_P({ref:d},u&&{target:u}),a)});return{slotProps:p}},settings:Z$,slots:{root:A0e},styles:{root:[bo,Zn]}})});var Gv=f(()=>{"use strict";s();EP();rQ()});var qv,XO=f(()=>{"use strict";s();qv="Checkbox"});var nQ,oQ,iQ=f(()=>{"use strict";s();XO();nQ="Toggle the Checkbox",oQ=[{tokens:{borderColor:"menuItemText",color:"menuItemText",backgroundColor:"menuBackground",textBorderColor:"transparent"},root:{style:{display:"flex",alignItems:"center",flexDirection:"row",minHeight:14,marginTop:0,position:"relative"}},checkbox:{style:{borderStyle:"solid",borderWidth:1,minHeight:14,minWidth:14,marginEnd:4}},checkmark:{style:{aspectRatio:1,position:"relative",opacity:0,fontSize:10,textAlign:"center",textAlignVertical:"center",top:-1}},content:{variant:"bodyStandard",style:{borderStyle:"solid",borderWidth:2,marginTop:3}},_precedence:["disabled","boxAtEnd","hovered","focused","pressed","checked"],_overrides:{focused:{tokens:{backgroundColor:"menuItemBackgroundHovered",textBorderColor:"focusBorder",checkmarkColor:"menuItemTextHovered"}},checked:{checkmark:{style:{opacity:1}}},hovered:{tokens:{backgroundColor:"menuItemBackgroundHovered",checkmarkColor:"menuItemTextHovered"}},disabled:{tokens:{borderColor:"buttonBorderDisabled",color:"disabledBodyText",backgroundColor:"background"}},boxAtEnd:{checkbox:{style:{marginStart:4,marginEnd:0}}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed"}}}},qv]});var AP,JO,_l,k0e,nh,aQ=f(()=>{"use strict";s();AP=I(L()),JO=I(ee());Ov();Mn();ga();On();On();Ki();ns();Po();iQ();XO();_l=function(){return _l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},_l.apply(this,arguments)},k0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},nh=jr({displayName:qv,usePrepareProps:function(t,r){var n=AP.useRef(null),o=t.accessible,a=t.accessibilityLabel,d=t.accessibilityRole,c=t.ariaLabel,u=t.checked,l=t.defaultChecked,p=t.boxSide,g=t.label,h=t.onChange,x=t.componentRef,y=x===void 0?n:x,T=t.focusable,b=k0e(t,["accessible","accessibilityLabel","accessibilityRole","ariaLabel","checked","defaultChecked","boxSide","label","onChange","componentRef","focusable"]);l!=null&&u!=null&&console.warn("defaultChecked and checked are mutually exclusive to one another. Use one or the other.");var S=dP(l,u,h),E=S[0],P=S[1],_=ts(y,P),D=qi(_l({onPress:_},b)),O=Ar(y),H=ni(P," "),V=_l(_l({},D.state),{disabled:!!t.disabled,checked:E,boxAtEnd:!(p==null||p=="start")}),M=r(t,function(z){return V[z]||t[z]}),G=AP.useCallback(function(z){switch(z.nativeEvent.actionName){case"Toggle":P();break}},[P,t,V,D.props]),K=Dt(M,{root:_l(_l(_l({rest:b,ref:O},D.props),{accessible:o??!0,accessibilityRole:d??"checkbox",accessibilityLabel:a??g,accessibilityState:{disabled:V.disabled,checked:V.checked},accessibilityActions:[{name:"Toggle",label:nQ}],focusable:T??!V.disabled,onAccessibilityAction:G,enableFocusRing:!1}),H),checkmark:{children:"\u2713"},content:{children:g}});return{slotProps:K,state:V}},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Se(t.root,null,(r==null?void 0:r.state.boxAtEnd)&&Se(t.content,null),Se(t.checkbox,null,Se(t.checkmark,null)),!(r!=null&&r.state.boxAtEnd)&&Se(t.content,null),n)},settings:oQ,slots:{root:JO.View,checkbox:{slotType:JO.View,filter:Gd},checkmark:on,content:on},styles:{root:[],checkbox:[bo,Zn,[{source:"checkboxBackgroundColor",lookup:Jo,target:"backgroundColor"},{source:"checkboxBorderColor",lookup:Jo,target:"borderColor"}]],checkmark:[To,[{source:"checkmarkColor",lookup:Jo,target:"color"},{source:"checkmarkVisibility",target:"opacity"}]],content:[To,Ja,[{source:"textBorderColor",lookup:Jo,target:"borderColor"}]]}})});var sQ=f(()=>{"use strict";s();aQ()});var oh,kP=f(()=>{"use strict";s();oh="ContextualMenu"});var dQ=f(()=>{"use strict";s()});var wP,cQ,DP,D0e,w0e,F0e,os,uQ=f(()=>{"use strict";s();wP=I(L()),cQ=I(ee());PP();Mn();Ki();Po();DP=function(){return DP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},DP.apply(this,arguments)},D0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},w0e=ip("RCTFocusZone"),F0e=function(t){return t!=="componentRef"},os=$c({usePrepareProps:function(t,r){var n=t.componentRef,o=t.defaultTabbableElement,a=t.isCircularNavigation,d=D0e(t,["componentRef","defaultTabbableElement","isCircularNavigation"]),c=Ar(n),u=wP.useState(void 0),l=u[0],p=u[1];return wP.useLayoutEffect(function(){o!=null&&o.current?p((0,cQ.findNodeHandle)(o.current)):p(void 0)},[o]),{slotProps:Dt(r(t),{root:DP(DP({navigateAtEnd:a?"NavigateWrap":"NavigateStopAtEnds"},d),{defaultTabbableElement:l,ref:c})})}},slots:{root:{slotType:w0e,filter:F0e}}})});var ap=f(()=>{"use strict";s();dQ();uQ()});var lQ,fQ=f(()=>{"use strict";s();kP();lQ=[{tokens:{backgroundColor:"menuBackground",beakWidth:20,borderColor:"buttonBorder",borderWidth:1,directionalHint:"bottonLeftEdge",gapSpace:0,minPadding:0},container:{style:{padding:1,minWidth:180,flex:1}}},oh]});var Qs,FP,ZO,N0e,Qd,OP,Kv=f(()=>{"use strict";s();Qs=I(L()),FP=I(ee());Gv();ap();Mn();On();Ki();ns();Po();fQ();kP();ZO=function(){return ZO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ZO.apply(this,arguments)},N0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},Qd=Qs.createContext({selectedKey:null,onItemClick:function(){},onDismissMenu:function(){}}),OP=jr({displayName:oh,usePrepareProps:function(t,r){var n=t.setShowMenu,o=t.maxHeight,a=t.maxWidth,d=t.shouldFocusOnMount,c=d===void 0?!0:d,u=t.shouldFocusOnContainer,l=u===void 0?!1:u,p=N0e(t,["setShowMenu","maxHeight","maxWidth","shouldFocusOnMount","shouldFocusOnContainer"]),g=Qs.useRef(null);Qs.useLayoutEffect(function(){},[c]);var h=Il(null,t.onItemClick),x=Qs.useCallback(function(){t.onDismiss(),n==null||n(!1)},[n,t.onDismiss]),y=Qs.useState(!0),T=y[0],b=y[1],S=Qs.useCallback(function(){b(!1)},[b]),E={context:{selectedKey:h.selectedKey,onItemClick:h.onKeySelect,onDismissMenu:x}},P=r(t,function(D){return E[D]||t[D]}),_=Dt(P,{root:ZO({accessibilityRole:"menu",setInitialFocus:c},p),container:{accessible:l,focusable:l&&T,onBlur:S,style:{maxHeight:o,maxWidth:a}},scrollView:{contentContainerStyle:{flexDirection:"column",flexGrow:1},showsVerticalScrollIndicator:o!=null,showsHorizontalScrollIndicator:a!=null},focusZone:{enableFocusRing:!1,componentRef:g,defaultTabbableElement:g,focusZoneDirection:"vertical"}});return{slotProps:_,state:E}},settings:lQ,slots:{root:Yi,container:FP.View,scrollView:FP.ScrollView,focusZone:os},styles:{root:[bo,Zn],container:[]},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return r.state==null?null:Se(Qd.Provider,{value:r.state.context},Se(t.root,null,Se(t.container,null,Se(t.scrollView,null,n))))}})});var ih,NP=f(()=>{"use strict";s();ih="ContextualMenuItem"});var pQ,mQ=f(()=>{"use strict";s();NP();pQ=[{tokens:{backgroundColor:"menuBackground",color:"menuItemText",borderColor:"transparent",borderWidth:2},root:{style:{display:"flex",alignItems:"flex-start",flexDirection:"row",alignSelf:"flex-start",width:"100%"}},icon:{style:{marginEnd:5}},stack:{style:{display:"flex",paddingStart:7,paddingEnd:7,alignItems:"center",flexDirection:"row",alignSelf:"flex-start",minHeight:32,minWidth:80,justifyContent:"flex-start"}},_precedence:["focused","hovered","pressed","disabled"],_overrides:{disabled:{tokens:{backgroundColor:"menuBackground",color:"disabledText"}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed",color:"menuItemTextHovered"}},hovered:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered"}},focused:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered",borderColor:"focusBorder"},_overrides:{hovered:{tokens:{borderColor:"transparent"}}}}}},ih]});var Rl,eN,ha,gQ,Yv,hQ=f(()=>{"use strict";s();Rl=I(L()),eN=I(ee());rp();Mn();ga();On();Ki();ns();Po();Kv();mQ();NP();ha=function(){return ha=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ha.apply(this,arguments)},gQ=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},Yv=jr({displayName:ih,usePrepareProps:function(t,r){var n,o=Rl.useRef(null),a=t.disabled,d=t.itemKey,c=t.icon,u=t.text,l=t.accessibilityLabel,p=l===void 0?t.text:l,g=t.onAccessibilityTap,h=t.onClick,x=t.testID,y=t.componentRef,T=y===void 0?o:y,b=gQ(t,["disabled","itemKey","icon","text","accessibilityLabel","onAccessibilityTap","onClick","testID","componentRef"]),S=Rl.useContext(Qd),E=Rl.useCallback(function(ie){a||(S==null||S.onDismissMenu(),h&&h(),S!=null&&S.onItemClick&&S.onItemClick(d),ie.stopPropagation())},[S,a,d,h]),P=Ar(T),_=Rl.useCallback(function(){a||(T.current.focus(),S!=null&&S.isSubmenuOpen&&S!=null&&S.dismissSubmenu&&S.dismissSubmenu())},[T,a,S]),D=qi(ha(ha({},b),{onPress:E,onHoverIn:_})),O=ni(E," ","Enter"),H=ha(ha({},D.state),{selected:S.selectedKey===t.itemKey,disabled:t.disabled,content:!!u,icon:!!c}),V=D.props,M=V.onBlur,G=V.onMouseLeave,K=gQ(V,["onBlur","onMouseLeave"]),z=Rl.useCallback(function(ie){M(ie),G&&G(ie)},[M,G]),$=ha({onBlur:M,onMouseLeave:z},K),q=g??E,re=r(t,function(ie){return H[ie]||t[ie]}),ae=Dt(re,{root:ha(ha(ha(ha({ref:P},$),O),{accessible:!0,accessibilityLabel:p,accessibilityRole:"menuitem",accessibilityState:{disabled:(n=H.disabled)!==null&&n!==void 0?n:!1,selected:H.selected},accessibilityValue:{text:d},onAccessibilityTap:q,disabled:a,focusable:!a,testID:x}),b),content:{accessible:!1,children:u},icon:ha(ha({},Pl(c)),{accessible:!1})});return{slotProps:ae,state:H}},settings:pQ,render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Se(t.root,null,Se(t.stack,null,r.state.icon&&Se(t.icon,null),r.state.content&&Se(t.content,null),n))},slots:{root:eN.View,stack:{slotType:eN.View},icon:{slotType:El},content:on},styles:{root:[bo,Zn],stack:[],icon:[{source:"iconColor",lookup:Jo,target:"color"}],content:[Ja,To]}})});var ah,MP=f(()=>{"use strict";s();ah="Submenu"});var yQ,CQ=f(()=>{"use strict";s();MP();yQ=[{tokens:{backgroundColor:"menuBackground",beakWidth:20,borderColor:"buttonBorder",borderWidth:1,gapSpace:0,minPadding:0},root:{accessibilityRole:"menu",directionalHint:"rightTopEdge"},container:{style:{padding:1,minWidth:180,flex:1}}},ah]});var $i,dh,sh,M0e,LP,vQ=f(()=>{"use strict";s();$i=I(L()),dh=I(ee());Gv();ap();Mn();On();Ki();ns();Po();Kv();CQ();MP();sh=function(){return sh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},sh.apply(this,arguments)},M0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},LP=jr({displayName:ah,usePrepareProps:function(t,r){var n=t.setShowMenu,o=t.maxWidth,a=t.maxHeight,d=t.shouldFocusOnMount,c=d===void 0?!0:d,u=t.shouldFocusOnContainer,l=u===void 0?!0:u,p=M0e(t,["setShowMenu","maxWidth","maxHeight","shouldFocusOnMount","shouldFocusOnContainer"]),g=$i.useRef(null);$i.useLayoutEffect(function(){},[]);var h=$i.useContext(Qd),x=Il(null,t.onItemClick),y=$i.useCallback(function(){t!=null&&t.onShow&&t.onShow(),h.isSubmenuOpen=!0},[h]),T=$i.useCallback(function(){t==null||t.onDismiss(),n(!1),h.isSubmenuOpen=!1},[h,n]),b=$i.useCallback(function(){T(),h==null||h.onDismissMenu()},[T,h]);h.dismissSubmenu=T;var S=$i.useState(!0),E=S[0],P=S[1],_=$i.useCallback(function(){P(!1)},[P]),D={context:{selectedKey:x.selectedKey,onItemClick:x.onKeySelect,onDismissMenu:b}},O=r(t,function(G){return D[G]||t[G]}),H=$i.useCallback(function(G){var K=dh.I18nManager.isRTL?"ArrowRight":"ArrowLeft";G.nativeEvent.key===K&&T()},[T]),V=Kd(H,"ArrowLeft","ArrowRight"),M=Dt(O,{root:sh(sh({},p),{onShow:y,onDismiss:T,setInitialFocus:c}),container:sh(sh({},V),{accessible:l,focusable:l&&E,onBlur:_,style:{maxHeight:a,maxWidth:o}}),scrollView:{contentContainerStyle:{flexDirection:"column",flexGrow:1},showsVerticalScrollIndicator:a!=null,showsHorizontalScrollIndicator:o!=null},focusZone:{componentRef:g,focusZoneDirection:"vertical"}});return{slotProps:M,state:D}},settings:yQ,slots:{root:Yi,container:dh.View,scrollView:dh.ScrollView,focusZone:os},styles:{root:[bo,Zn],container:[]},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return r.state==null?null:Se(Qd.Provider,{value:r.state.context},Se(t.root,null,Se(t.container,null,Se(t.scrollView,null,n))))}})});var ch,HP=f(()=>{"use strict";s();ch="SubmenuItem"});var xQ,TQ=f(()=>{"use strict";s();HP();xQ=[{tokens:{backgroundColor:"menuBackground",color:"menuItemText",borderColor:"transparent",borderWidth:2},root:{style:{display:"flex",flex:1,flexDirection:"row",alignSelf:"flex-start",width:"100%",justifyContent:"space-between"}},icon:{style:{marginEnd:5,color:"menuIcon"}},startstack:{style:{display:"flex",flexGrow:1,paddingStart:5,alignItems:"center",flexDirection:"row",alignSelf:"flex-start",minHeight:32,justifyContent:"flex-start"}},endstack:{style:{display:"flex",paddingEnd:5,alignItems:"center",flexDirection:"row",minHeight:32,width:12,justifyContent:"flex-end"}},_precedence:["focused","hovered","pressed","disabled"],_overrides:{disabled:{tokens:{backgroundColor:"menuBackground",color:"disabledText"}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed",color:"menuItemTextHovered"}},focused:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered",borderColor:"focusBorder"},_overrides:{hovered:{tokens:{borderColor:"transparent"}}}}}},ch]});var Xs,sp,uh,Ei,bQ,BP,SQ=f(()=>{"use strict";s();Xs=I(L()),sp=I(ee());rp();Mn();ga();On();Ki();ns();Po();uh=I(Zf());Kv();TQ();HP();Ei=function(){return Ei=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ei.apply(this,arguments)},bQ=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},BP=jr({displayName:ch,usePrepareProps:function(t,r){var n,o=Xs.useRef(null),a=t.disabled,d=t.itemKey,c=t.icon,u=t.text,l=t.accessibilityLabel,p=l===void 0?t.text:l,g=t.onAccessibilityTap,h=t.onClick,x=t.componentRef,y=x===void 0?o:x,T=bQ(t,["disabled","itemKey","icon","text","accessibilityLabel","onAccessibilityTap","onClick","componentRef"]),b=Xs.useContext(Qd),S=Ar(y),E=Xs.useCallback(function(ct){y.current.focus(),t.onHoverIn&&t.onHoverIn(ct)},[]),P=500,_=Xs.useCallback(function(ct){b!=null&&b.dismissSubmenu&&b.dismissSubmenu(),t.onHoverOut&&t.onHoverOut(ct)},[]),D=Xs.useCallback(function(){a||(h&&h(),b!=null&&b.onItemClick&&b.onItemClick(d))},[b,a,d,h]),O=qi(Ei(Ei({},T),{onPress:D,onHoverIn:E,delayHoverIn:P,onHoverOut:_})),H=O.props,V=H.onBlur,M=H.onMouseEnter,G=H.onMouseLeave,K=bQ(H,["onBlur","onMouseEnter","onMouseLeave"]),z=Xs.useCallback(function(ct){y.current.focus(),M&&M(ct)},[y,M]),$=Xs.useCallback(function(ct){V(ct),G&&G(ct)},[V,G]),q=Ei({onBlur:V,onMouseEnter:z,onMouseLeave:$},K),re=Ei(Ei({},O.state),{selected:b.selectedKey===t.itemKey,disabled:t.disabled,content:!!u,icon:!!c}),ae=Xs.useCallback(function(ct){var Ge=sp.I18nManager.isRTL?"ArrowLeft":"ArrowRight";(ct.nativeEvent.key===Ge||ct.nativeEvent.key===" "||ct.nativeEvent.key==="Enter")&&E(ct)},[E]),ie=function(Ge){return Se(uh.Svg,{width:Ge.width,height:Ge.height,viewBox:"0 0 2048 2048",color:Ge.color},Se(uh.G,{transform:sp.I18nManager.isRTL?"translate(2048, 0) scale(-1, 1)":""},Se(uh.Path,{fill:"currentColor",d:"M 743 1767 l -121 -121 l 708 -707 l -708 -708 l 121 -121 l 828 829 z"})))},Te={src:ie},Oe=Kd(ae," ","Enter","ArrowLeft","ArrowRight"),ke=g??D,it=r(t,function(ct){return re[ct]||t[ct]}),_e=Dt(it,{root:Ei(Ei(Ei(Ei({ref:S},q),Oe),{accessible:!0,accessibilityLabel:p,accessibilityRole:"menuitem",accessibilityState:{disabled:(n=re.disabled)!==null&&n!==void 0?n:!1,selected:re.selected},accessibilityValue:{text:d},disabled:a,focusable:!a,onAccessibilityTap:ke}),T),content:{accessible:!1,children:u},icon:Ei(Ei({},Pl(c)),{accessible:!1}),chevron:Ei(Ei({},Pl({svgSource:Te,width:12,height:12})),{accessible:!1})});return{slotProps:_e,state:re}},settings:xQ,render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Se(t.root,null,Se(t.startstack,null,r.state.icon&&Se(t.icon,null),r.state.content&&Se(t.content,null),n),Se(t.endstack,null,Se(t.chevron,null)))},slots:{root:sp.View,startstack:sp.View,icon:El,content:on,endstack:sp.View,chevron:El},styles:{root:[bo,Zn],startstack:[],icon:[{source:"iconColor",lookup:Jo,target:"color"}],content:[Ja,To],endstack:[],chevron:[{source:"chevronColor",lookup:Jo,target:"color"}]}})});var tN=f(()=>{"use strict";s();kP();Kv();NP();hQ();MP();vQ();HP();SQ()});function rN(e){return e!=="componentRef"}var UP,L0e,IQ,EQ=f(()=>{"use strict";s();PP();Mn();Ki();Po();UP=function(){return UP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},UP.apply(this,arguments)},L0e=ip("RCTFocusTrapZone");IQ=$c({usePrepareProps:function(t,r){var n=Ar(t.componentRef);return{slotProps:Dt(r(t),{root:UP(UP({},t),{ref:n})})}},slots:{root:{slotType:L0e,filter:rN}}})});var PQ=f(()=>{"use strict";s();EQ()});var lh,VP=f(()=>{"use strict";s();lh="Link"});var jP,nN=f(()=>{"use strict";s();jP=function(t){return{color:t.colors.brandForegroundLink,alignSelf:"flex-start",variant:"body1",textDecorationLine:"underline",disabled:{color:t.colors.neutralForegroundDisabled,textDecorationLine:"none",focused:{borderColor:t.colors.strokeFocus2}},hovered:{color:t.colors.brandForegroundLinkHover},pressed:{color:t.colors.brandForegroundLinkPressed},visited:{color:t.colors.brandForegroundLink},focused:{color:t.colors.brandForegroundLink,borderColor:t.colors.strokeFocus2},subtle:{color:t.colors.neutralForeground2,hovered:{color:t.colors.neutralForeground2Hover},pressed:{color:t.colors.neutralForeground2Pressed},visited:{color:t.colors.neutralForeground2},focused:{color:t.colors.neutralForeground2,borderColor:t.colors.strokeFocus2}},brand:{color:t.colors.neutralForegroundInvertedLink,hovered:{color:t.colors.neutralForegroundInvertedLinkHover},pressed:{color:t.colors.neutralForegroundInvertedLinkPressed},visited:{color:t.colors.neutralForegroundInvertedLink},focused:{color:t.colors.neutralForegroundInvertedLink,borderColor:t.colors.strokeFocus2}}}}});var oN,WP,iN=f(()=>{"use strict";s();k();Me();On();VP();nN();oN=["inline","subtle","hovered","focused","pressed","disabled"],WP={tokens:[jP,lh],states:oN,slotProps:{root:lt(function(e){return{style:{alignSelf:e.alignSelf}}},["alignSelf"]),content:lt(function(e,t){return{style:m(m({alignSelf:e.alignSelf,textDecorationLine:e.textDecorationLine,color:e.color,fontStyle:e.fontStyle,textAlign:e.textAlign,variant:e.variant},tn.from(e,t)),Zo.from(e,t))}},w(w(["alignSelf","color","textDecorationLine","textAlign"],tn.keys,!0),Zo.keys,!0))}}});var dp,_Q,H0e,zP,aN=f(()=>{"use strict";s();k();dp=I(L()),_Q=I(ee());Mn();H0e={},zP=function(t){var r,n=dp.useRef(null),o=t.accessible,a=o===void 0?!0:o,d=t.accessibilityRole,c=t.onKeyUp,u=t.onKeyDown,l=t.keyUpEvents,p=t.keyDownEvents,g=t.onPress,h=t.onAccessibilityTap,x=t.tooltip,y=t.url,T=t.accessibilityState,b=t.componentRef,S=b===void 0?n:b,E=t.disabled,P=t.enableFocusRing,_=t.focusable,D=_===void 0?!0:_,O=je(t,["accessible","accessibilityRole","onKeyUp","onKeyDown","keyUpEvents","keyDownEvents","onPress","onAccessibilityTap","tooltip","url","accessibilityState","componentRef","disabled","enableFocusRing","focusable"]),H=!!E,V=dp.useState(!1),M=V[0],G=V[1],K=dp.useCallback(function(it){G(!0),y?_Q.Linking.openURL(y):g&&g(it),it.stopPropagation()},[G,y,g]),z=H||!D?null:S,$=ts(z,K),q=qi(m(m({},O),{disabled:H,onPress:$})),re=ni(K," ","Enter"),ae=m(m({},q.state),{visited:M}),ie=dp.useCallback(function(it){h?h():K(it)},[K,h]),Te=(r=x??y)!==null&&r!==void 0?r:void 0,Oe=t.inline,ke=!1;return Oe&&(Oe=!1),{props:m(m(m(m(m(m({},O),re),q.props),{onAccessibilityTap:ie}),H0e),{accessible:a,accessibilityRole:"link",accessibilityState:cP(H,T),enableFocusRing:P??!0,focusable:D&&!H,cursor:H?"not-allowed":"pointer",ref:Ar(S),tooltip:Te,inline:Oe}),state:ae}}});var RQ,sN,AQ,kQ=f(()=>{"use strict";s();k();RQ=I(ee());Me();ga();iN();VP();aN();sN=function(t,r,n){return r[t]||n[t]||t===n.appearance},AQ=rn(m(m({displayName:lh},WP),{slots:{root:RQ.View,content:Tr},useRender:function(t,r){var n=zP(t),o=r(t,function(a){return sN(a,n.state,t)});return function(a){for(var d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];var u=dt(n.props,a),l=u.inline,p=je(u,["inline"]),g=!0;return l||p.selectable?Ae(o.content,m({},p),d):Ae(o.root,m({},p),Ae(o.content,{focusable:!1},d))}}}))});var fh,GP=f(()=>{"use strict";s();fh="RNFLink"});var DQ,wQ=f(()=>{"use strict";s();k();GP();DQ=[{tokens:{variant:"secondaryStandard",color:"link",borderColor:"transparent",borderStyle:"solid",borderWidth:2,borderRadius:4,textDecorationLine:"underline"},root:m(m({accessible:!0,focusable:!0},{cursor:"pointer"}),{accessibilityRole:"link",style:{display:"flex",alignItems:"flex-start"}}),content:{style:{textDecorationLine:"underline",textAlign:"center"}},_precedence:["visited","hovered","focused","pressed","disabled"],_overrides:{disabled:{tokens:{color:"link"}},hovered:{tokens:{color:"linkHovered"}},pressed:{tokens:{color:"linkPressed"}},visited:{tokens:{color:"link"}},focused:{tokens:{borderColor:"focusBorder"}}}},fh]});function dN(e,t){var r=e.url,n=e.onPress,o=je(e,["url","onPress"]),a=ph.useState({visited:!1}),d=a[0],c=a[1],u=ph.useCallback(function(y){c({visited:!0}),r?qP.Linking.openURL(r):n&&n(y)},[c,r,n]),l=ts(t,u),p=qi(m({onPress:l},o)),g=ni(u," ","Enter"),h=m(m({},p.state),d),x=m(m(m({},e),p.props),g);return[x,h]}var ph,qP,FQ,OQ=f(()=>{"use strict";s();k();ph=I(L()),qP=I(ee());Mn();ga();On();Ki();ns();Po();wQ();GP();FQ=jr({displayName:fh,settings:DQ,usePrepareProps:function(t,r){var n=ph.useRef(null),o=t.content,a=t.onAccessibilityTap,d=t.componentRef,c=d===void 0?n:d,u=je(t,["content","onAccessibilityTap","componentRef"]),l=dN(u,c),p=l[0],g=l[1],h=a||p.onPress,x={content:!!o},y=Ar(c),T=r(t,function(S){return g[S]||t[S]}),b=Dt(T,{root:m(m({},p),{ref:y,onAccessibilityTap:h}),content:{children:o}});return{slotProps:b,state:m(m({},g),x)}},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=r.state&&r.state.content;return n.length&&n.length===1&&n[0]!==void 0?Se(t.root,null,a&&Se(t.content,null),n):Se(t.root,null,a&&Se(t.content,null))},slots:{root:qP.View,content:on},styles:{root:[],content:[To,Ja,Zn]}})});var NQ=f(()=>{"use strict";s();VP();nN();iN();aN();kQ();GP();OQ()});function HQ(e,t){return t?B0e[e]:LQ[e]}function BQ(e){return U0e[e]}function KP(e){return V0e[e]}function ya(e){var t=e.size,r=e.coinSize,n=e.iconSize,o=e.iconStrokeWidth,a=e.initialsSize;if(t)return MQ[t];var d=MQ.size40,c=d.physicalSize,u=d.iconSize,l=d.iconStrokeWidth,p=d.initialsSize;return{physicalSize:r||c,iconSize:n||u,iconStrokeWidth:o||l,initialsSize:a||p}}function cp(e){switch(e){case"xSmall":return 1;case"small":return 1;case"medium":return 2;case"large":return 2;case"xlarge":return 2;case"xxlarge":return 4;default:return e<0?4:e}}var LQ,B0e,MQ,U0e,V0e,Qc=f(()=>{"use strict";s();Ii();LQ={none:{uri:""},offline:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAANlBMVEUAAACoxM+oxM+oxM+oxM+oxM+oxM+oxM+oxM////+oxM/W5OmzzNX5+/z3+vvu9Pbt8/Xj7PAAKKEtAAAACXRSTlMA6bWcZQpiXgXWfJCWAAAAeElEQVQoz52RSQ7EIAwEx0AWymT7/2dHYpgoPvQldeySsGl/XjOVZGCpTDFfjIEtj3jN0Pzc99Mb5PUWGbwOHPI/n+GqNxfMY67h9YFjvw0KrQYapYuER+GkLowjigPrArYoNpBCPiWHy3XlB1UlqkRZuziUPO1bvszLC8V87ko/AAAAAElFTkSuQmCC"},online:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAWlBMVEUAAABusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAX////N4bi61517tivn8d3e7NL3+vTE3Kux0o6nzH6GvEWFZ26xAAAAEnRSTlMA8eNrEQj6syHTeXrKshzZ19JHa6QpAAAApUlEQVQoz4WS6w7CIAyFBwwGbE5th87b+7+mCDXcIp4/NN9J2tJ2+KdRTFyx0yTGAkvLgMRmmbg2kMnoL185FOIr5Vmg0hKzWWhkQz+sNdinN1Eg9wyP8MYh5xvewjt5gxcct9iYN1SIXvsj46C8EWvfEZ0jTsYxRJcrYuLAqTg5xKm4AHL2xEH8/GBvJIM819xIWkc9dt1ZFEnO+WrbY1CcjqGnN0xiGcyuKFtcAAAAAElFTkSuQmCC"},away:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAP1BMVEUAAAD6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT////6zCP95pH95Yv++OL84Hn822T72FT71EUen9LHAAAAC3RSTlMA6rVlCuWgmGJeBd4LCPMAAAB8SURBVCjPnZFLDoAgDERtQUUH/97/rCYNJUITTXjLeYu2064Z75gAYufLfOqR6KdXPI94Mc5ZDCgYNA8piHGBENJcqgV5EQ61gBPBVrAIsoJEwArUYi0EIbFlQ+VwHGpY11XOGDdZVw/MXPstB2olFeGnRFv796Psa1t5ANwFDZEW8B8sAAAAAElFTkSuQmCC"},dnd:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAQlBMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABv////wfYT86errJjiR9OLxAAAAEXRSTlMA4/CzeQj602seEhEk89jKakfnNfsAAACKSURBVCjPhZFbDoQgDEWBQkHBR2d0/1udEppR0cbzeU9SSq95I69gcZphzZc4eEeC8+HIh0gn4vDPLV2wYsJCHUub5umGr/no7sKNLBI9kFjAkwAWbaX9K+xtMRZIle0jbFRBFpMmZmWU8ri+rv5B/SQmxD6PUknpz16MUJSi9GqZnMAiWkjZvPADxcoYalVfnOMAAAAASUVORK5CYII="},blocked:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAe1BMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABv////pABv83uHqCiTsJz7rGjP7zNHvRVj/+vv+8vP6x83sIzv2mqXsKD/7zNL5v8b3oqz2maTuP1P82Nz819vtKUDrGjLrGTK2dyGvAAAAEXRSTlMA8dSzeQj64mseEhHkJMpq5T3coEAAAADSSURBVCjPhdHZFoIgFAVQGQRLGzhQiaLNw/9/YZRk4IvncZ+17uJys7mUGyYFoWxTJpxzghDC878vKFBftLX6UgN0MXqF/qRCTg5VaPI1ro36Re+MWQ/TOPrEXw7840uCNvb9oQVZ+qJAnbpSNQpfMHQTVx2YLyT0xJWG9IWAnbiyEL4gaCKPCopb7P9RDOeJqzNYeG7i3+eGBVMPC2Yczpn9cfTmAT58IoV5Rn4FDSdZbY1rxzk9qpXHofkcqtO2uXfhUHOn9SkLJoWQrCizmbwBa5IbuX8ugpIAAAAASUVORK5CYII="},busy:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAANlBMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvsgIdoAAAAEXRSTlMA8eLUEQj6s2sheXrlyrJqHBqb3nMAAAB/SURBVCjPhZFRDsQgCEQFEdS223L/yy7JummtGN/nvASUCSvoFGSIclIXpwragC3deYn6IJZ/fqF24NXmHPri+E2rOlCDQTAKIBNZHbKJjyfEBHoCTbAn2ATMRPRHzZfPn+t/cH4SIw3rY2p17H2+l0VRRtr8ag3KgswomcKCL1NmGBp9lqsZAAAAAElFTkSuQmCC"}},B0e=LQ;MQ={size8:{physicalSize:8,iconSize:0,iconStrokeWidth:0,initialsSize:4},size24:{physicalSize:24,iconSize:8,iconStrokeWidth:2,initialsSize:10},size32:{physicalSize:32,iconSize:8,iconStrokeWidth:2,initialsSize:12},size40:{physicalSize:40,iconSize:12,iconStrokeWidth:2,initialsSize:14},size48:{physicalSize:48,iconSize:12,iconStrokeWidth:2,initialsSize:16},size56:{physicalSize:56,iconSize:16,iconStrokeWidth:3,initialsSize:18},size72:{physicalSize:72,iconSize:20,iconStrokeWidth:3,initialsSize:20},size100:{physicalSize:100,iconSize:28,iconStrokeWidth:4,initialsSize:36},size120:{physicalSize:120,iconSize:32,iconStrokeWidth:4,initialsSize:40}},U0e={lightBlue:F.color.cornflower.primary,blue:F.color.blue.primary,darkBlue:F.color.royalBlue.primary,teal:F.color.teal.primary,green:F.color.forest.primary,darkGreen:F.color.darkGreen.primary,lightPink:F.color.berry.primary,pink:F.color.hotPink.primary,magenta:F.color.grape.primary,purple:F.color.purple.primary,orange:F.color.pumpkin.primary,lightRed:F.color.red.primary,darkRed:F.color.burgundy.primary,violet:F.color.orchid.primary,gold:F.color.brass.primary,burgundy:F.color.darkRed.primary,warmGray:F.color.beige.primary,cyan:F.color.steel.primary,rust:F.color.brown.primary,coolGray:F.color.platinum.primary};V0e={cornflower:F.color.cornflower.primary,blue:F.color.blue.primary,royalBlue:F.color.royalBlue.primary,teal:F.color.teal.primary,forest:F.color.forest.primary,darkGreen:F.color.darkGreen.primary,berry:F.color.berry.primary,hotPink:F.color.hotPink.primary,grape:F.color.grape.primary,purple:F.color.purple.primary,pumpkin:F.color.pumpkin.primary,red:F.color.red.primary,burgundy:F.color.burgundy.primary,orchid:F.color.orchid.primary,brass:F.color.brass.primary,darkRed:F.color.darkRed.primary,beige:F.color.beige.primary,platinum:F.color.platinum.primary,steel:F.color.steel.primary,brown:F.color.brown.primary}});var mh,YP=f(()=>{"use strict";s();mh="RNFPersonaCoin"});var UQ,VQ=f(()=>{"use strict";s();Qc();YP();UQ=[{tokens:{horizontalIconAlignment:"end",verticalIconAlignment:"end",color:"white",iconStrokeColor:"white",backgroundColor:KP("cornflower")}},mh]});function W0e(e,t){var r=ya(e),n=r.iconSize,o=r.iconStrokeWidth,a=n+o*2,d=e.iconStrokeColor||t.colors.background;return{source:{},style:{position:"absolute",width:a,height:a,bottom:-o,end:-o,borderRadius:a/2,borderWidth:o,borderColor:d}}}var j0e,jQ,WQ=f(()=>{"use strict";s();rs();Qc();j0e=["iconSize","size","coinSize"];jQ=fr(W0e,j0e)});function G0e(e){var t=ya(e).initialsSize;return{style:{fontSize:t}}}var z0e,zQ,GQ=f(()=>{"use strict";s();rs();Qc();z0e=["coinSize","initialsSize","size"];zQ=fr(G0e,z0e)});function K0e(e){var t=ya(e).physicalSize,r=e.backgroundColor,n=e.coinColor,o=e.coinColorFluent,a=r;return o?a=KP(o):n&&(a=BQ(n)),{style:{borderRadius:t/2,width:t,height:t,flexGrow:1,alignSelf:"stretch",justifyContent:"center",alignItems:"center",backgroundColor:a}}}var q0e,qQ,KQ=f(()=>{"use strict";s();rs();Qc();q0e=["coinSize","size","coinColor","coinColorFluent","backgroundColor"];qQ=fr(K0e,q0e)});function $0e(e){var t=ya(e).physicalSize;return{source:{},style:{borderRadius:t/2,width:t,height:t},resizeMode:"cover"}}var Y0e,YQ,$Q=f(()=>{"use strict";s();rs();Qc();Y0e=["coinSize","size"];YQ=fr($0e,Y0e)});function Q0e(e,t){var r=ya(e).physicalSize,n=e.ring;if(!n)return{};var o=n.innerGap!=null?cp(n.innerGap):cp(n.ringThickness||"xxlarge"),a=2*cp(n.ringThickness||"xxlarge")+o,d=r+2*a,c=n.ringBackgroundColor||t.colors.personaActivityRing;return{style:{borderStyle:"solid",borderColor:c,borderWidth:a,borderRadius:d/2,width:d,height:d,position:"absolute",top:-a,left:-a}}}function X0e(e,t){var r=ya(e).physicalSize,n=e.ring;if(!n)return{};var o=n.innerGap!=null?cp(n.innerGap):cp(n.ringThickness||"xxlarge"),a=cp(n.ringThickness||"xxlarge")+o,d=r+2*a,c=n.accent?t.colors.accentButtonBackground:n.ringColor||t.colors.personaActivityGlow;return{style:{borderStyle:"solid",borderColor:c,borderWidth:a-o,borderRadius:d/2,width:d,height:d,position:"absolute",top:-a,left:-a}}}var QQ,XQ,JQ,ZQ=f(()=>{"use strict";s();rs();Qc();QQ=["coinSize","size","ring"];XQ=fr(Q0e,QQ),JQ=fr(X0e,QQ)});function Z0e(e){var t={flexDirection:"row"},r=ya(e).physicalSize;t.width=r,t.height=r;var n=e.horizontalIconAlignment,o=e.verticalIconAlignment;return t.justifyContent=eX[n||"end"],t.alignItems=eX[o||"end"],{style:t}}var eX,J0e,gh,cN=f(()=>{"use strict";s();rs();Qc();eX={start:"flex-start",center:"center",end:"flex-end"},J0e=["coinSize","size","horizontalIconAlignment","verticalIconAlignment"];gh=fr(Z0e,J0e)});function tPe(e,t){var r=e.imageUrl,n=e.imageDescription,o=e.initials,a=e.presence,d=e.isOutOfOffice,c=e.ring,u=ePe(e,["imageUrl","imageDescription","initials","presence","isOutOfOffice","ring"]),l=r===void 0?void 0:{uri:r},p=a===void 0?void 0:HQ(a,d||!1),g=!!c,h=!!(c!=null&&c.transparent);return{slotProps:Dt(t(e),{root:uN({},u),initials:{children:o},photo:{accessibilityLabel:n}}),state:{iconSource:p,personaPhotoSource:l,showRing:g,transparentRing:h}}}var Xd,uN,ePe,rPe,$P,tX=f(()=>{"use strict";s();Xd=I(ee());Ov();On();Ki();ns();Po();Qc();VQ();WQ();GQ();KQ();$Q();ZQ();cN();YP();uN=function(){return uN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},uN.apply(this,arguments)},ePe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};rPe=function(t,r){if(!r.state)return null;var n=r.state,o=n.personaPhotoSource,a=n.iconSource,d=n.showRing,c=n.transparentRing;return Se(t.root,null,o?Se(t.photo,{source:o}):Se(t.initialsBackground,null,Se(t.initials,null)),d&&!c&&Se(t.ring,null),d&&Se(t.glow,null),!!a&&!!a.uri&&Se(t.icon,{source:a}))},$P=jr({displayName:mh,usePrepareProps:tPe,settings:UQ,slots:{root:{slotType:Xd.View,filter:Gd},photo:{slotType:Xd.Image,filter:rP},initials:Xd.Text,initialsBackground:{slotType:Xd.View,filter:Gd},icon:{slotType:Xd.Image,filter:rP},ring:{slotType:Xd.View,filter:Gd},glow:{slotType:Xd.View,filter:Gd}},render:rPe,styles:{root:[gh],initials:[To,zQ],initialsBackground:[qQ],photo:[YQ],icon:[jQ],ring:[XQ],glow:[JQ]}})});var QP=f(()=>{"use strict";s();tX();YP();cN()});var hh,XP=f(()=>{"use strict";s();hh="RNFPersona"});var rX,nX=f(()=>{"use strict";s();XP();rX=[{tokens:{verticalGap:4}},hh]});function iPe(e,t){var r=e.coinBackgroundColor,n=nPe(e,["coinBackgroundColor"]),o=JP(JP({},n),{backgroundColor:r});return gh(o,t)}var JP,nPe,oPe,oX,iX=f(()=>{"use strict";s();QP();rs();JP=function(){return JP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},JP.apply(this,arguments)},nPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},oPe=["coinSize","size","horizontalIconAlignment","verticalIconAlignment","coinBackgroundColor"];oX=fr(iPe,oPe)});function sPe(e){var t={flexDirection:"row",alignItems:"center"},r=e.coinSize;return r&&r>0&&(t.height=r,t.minWidth=r),{style:t}}var aPe,aX,sX=f(()=>{"use strict";s();rs();aPe=["coinSize","size"];aX=fr(sPe,aPe)});function dX(e){return dPe[e]}function cX(e){return cPe[e]}function uX(e){return uPe[e]}function lX(e){return lPe[e]}function fX(e){return fPe[e||"size40"]}var dPe,cPe,uPe,lPe,fPe,lN=f(()=>{"use strict";s();dPe={size8:{fontSize:"caption"},size24:{fontSize:"secondary"},size32:{fontSize:"secondary"},size40:{fontSize:"secondary"},size48:{fontSize:"secondary"},size56:{fontSize:"subheader"},size72:{fontSize:"subheader"},size100:{fontSize:"subheader"},size120:{fontSize:"subheader"}},cPe={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:"caption"},size48:{fontSize:"caption"},size56:{fontSize:"secondary"},size72:{fontSize:"secondary"},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}},uPe={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:0},size48:{fontSize:0},size56:{fontSize:0},size72:{fontSize:"secondary"},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}},lPe={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:0},size48:{fontSize:0},size56:{fontSize:0},size72:{fontSize:0},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}};fPe={size8:17,size24:8,size32:8,size40:12,size48:12,size56:16,size72:16,size100:16,size120:16}});function mPe(e){var t=e.size,r=e.horizontalGap,n={flexDirection:"column",justifyContent:"space-around",paddingLeft:r||fX(t)};return{style:n}}var pPe,pX,mX=f(()=>{"use strict";s();rs();lN();pPe=["size","horizontalGap"];pX=fr(mPe,pPe)});function ZP(e,t,r,n,o){var a={};e!==void 0&&(a.marginBottom=e);var d=n||r(t||"size40"),c=d.fontFamily,u=d.fontSize,l=d.fontWeight;return a.fontFamily=c&&(o.typography.families[c]||c),a.fontSize=u&&(typeof u=="string"?o.typography.sizes[u]:u),a.fontWeight=l&&(o.typography.weights[l]||l),a.fontSize===0&&(a.display="none",a.fontSize=void 0),a}function gPe(e,t){var r=e.verticalGap,n=e.textFont,o=e.size;return{style:ZP(r,o,dX,n,t)}}function hPe(e,t){var r=e.verticalGap,n=e.secondaryFont,o=e.size;return{style:ZP(r,o,cX,n,t)}}function yPe(e,t){var r=e.verticalGap,n=e.tertiaryFont,o=e.size;return{style:ZP(r,o,uX,n,t)}}function CPe(e,t){var r=e.optionalFont,n=e.size;return{style:ZP(void 0,n,lX,r,t)}}var gX,hX,yX,CX,vX=f(()=>{"use strict";s();rs();lN();gX=fr(gPe,["size","textFont","verticalGap"]),hX=fr(hPe,["size","secondaryFont","verticalGap"]),yX=fr(yPe,["size","tertiaryFont","verticalGap"]),CX=fr(CPe,["size","optionalFont"])});function xPe(e,t){var r=e.text,n=e.secondaryText,o=e.tertiaryText,a=e.optionalText,d=e.size,c=e.coinColor,u=e.imageUrl,l=e.imageDescription,p=e.initials,g=e.presence,h=e.isOutOfOffice,x=vPe(e,["text","secondaryText","tertiaryText","optionalText","size","coinColor","imageUrl","imageDescription","initials","presence","isOutOfOffice"]),y=Dt(t(e),{root:fN({},x),coin:{size:d,coinColor:c,imageUrl:u,imageDescription:l,initials:p,presence:g,isOutOfOffice:h}});return{slotProps:y,state:{text:r,secondaryText:n,tertiaryText:o,optionalText:a}}}var Al,fN,vPe,TPe,xX,TX=f(()=>{"use strict";s();Al=I(ee());Ov();QP();On();Ki();ns();Po();nX();iX();sX();mX();vX();XP();fN=function(){return fN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},fN.apply(this,arguments)},vPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};TPe=function(t,r){if(!r.state)return null;var n=r.state,o=n.text,a=n.secondaryText,d=n.tertiaryText,c=n.optionalText;return Se(t.root,null,Se(t.coin,null),Se(t.stack,null,!!o&&Se(t.text,null,o),!!a&&Se(t.secondary,null,a),!!d&&Se(t.tertiary,null,d),!!c&&Se(t.optional,null,c)))},xX=jr({displayName:hh,settings:rX,render:TPe,usePrepareProps:xPe,slots:{root:{slotType:Al.View,filter:Gd},coin:$P,stack:Al.View,text:Al.Text,secondary:Al.Text,tertiary:Al.Text,optional:Al.Text},styles:{root:[aX],coin:[To,{source:"coinBackgroundColor",target:"backgroundColor"},oX],text:[gX],secondary:[hX],tertiary:[yX],optional:[CX],stack:[pX]}})});var bX=f(()=>{"use strict";s();TX();XP()});var SX,bPe,IX,EX=f(()=>{"use strict";s();SX=I(ee());Mn();Ki();Po();bPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},IX=$c({slots:{root:SX.View},usePrepareProps:function(t,r){var n=t.renderStyle,o=bPe(t,["renderStyle"]),a=qi(o),d=a.props,c=a.state,u=r(d);return n&&(d.style=n(c)),{slotProps:Dt(u,{root:d}),state:{state:c}}}})});var PX=f(()=>{"use strict";s();EX()});var yh,e_=f(()=>{"use strict";s();yh="Separator"});var _X,RX=f(()=>{"use strict";s();Ii();_X=function(){return{separatorWidth:F.stroke.width10}}});var EFt,$v,SPe,IPe,AX,kX=f(()=>{"use strict";s();EFt=I(ee());Me();e_();RX();$v=function(){return $v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$v.apply(this,arguments)},SPe=!1,IPe=["vertical","insetSpacing"],AX={tokens:[_X,yh],tokensThatAreAlsoProps:IPe,slotProps:{root:lt(function(e){return{style:$v($v($v({},e.vertical?{borderLeftWidth:e.separatorWidth}:{borderTopWidth:e.separatorWidth}),e.color&&{borderColor:e.color}),SPe)}},["color","vertical","separatorWidth","insetSpacing"])}}});var DX,Qv,EPe,wX,FX=f(()=>{"use strict";s();DX=I(ee());Me();kX();e_();Qv=function(){return Qv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Qv.apply(this,arguments)},EPe={vertical:void 0},wX=rn(Qv(Qv({displayName:yh},AX),{slots:{root:DX.View},useRender:function(t,r){var n=r(t).root;return function(o,a){return Ae(n,Qv({},dt(t,o,EPe)),a)}}}))});var OX=f(()=>{"use strict";s();e_();FX()});var t_,pN=f(()=>{"use strict";s();t_="MenuButton"});var NX,MX,LX=f(()=>{"use strict";s();NX="#616161",MX="#ffffff"});var Qi,HX,Jd,mN,BX,PPe,UX=f(()=>{"use strict";s();Qi=I(L());$O();tN();On();Ki();ns();Po();HX=I(Zf());LX();pN();Jd=function(){return Jd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Jd.apply(this,arguments)},mN=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},BX=jr({displayName:t_,usePrepareProps:function(t,r){var n=t.menuItems,o=t.content,a=t.startIcon,d=t.endIcon,c=t.disabled,u=t.onItemClick,l=t.contextualMenu,p=t.primary,g=mN(t,["menuItems","content","startIcon","endIcon","disabled","onItemClick","contextualMenu","primary"]),h=(0,Qi.useRef)(null),x=(0,Qi.useState)(!1),y=x[0],T=x[1],b=(0,Qi.useCallback)(function(){T(!1)},[T]),S=(0,Qi.useCallback)(function(){T(!y)},[y,T]),E={context:{showContextualMenu:!!y,primary:!!p}},P=r(t,function(O){return E[O]||t[O]}),_=Jd({disabled:c,content:o,icon:a??d,iconPosition:a!=null?"before":"after",componentRef:h,onClick:S,iconOnly:o==null},g),D=Dt(P,{root:{},button:_,primaryButton:Jd({appearance:"primary"},_),contextualMenu:Jd({onItemClick:u,target:h,onDismiss:b,setShowMenu:S},l),contextualMenuItems:{menuItems:n}});return{slotProps:D,state:E}},slots:{root:Qi.default.Fragment,button:{slotType:op},primaryButton:{slotType:op},contextualMenu:{slotType:OP},contextualMenuItems:Qi.default.Fragment,chevronSvg:HX.SvgXml},styles:{contextualMenu:[bo,Zn],button:[bo,Zn]},render:function(t,r){if(!(r.state&&r.slotProps))return null;var n=r.state.context,o=r.slotProps.contextualMenuItems?r.slotProps.contextualMenuItems.menuItems:[],a=n.primary?MX:NX,d='\n    <svg width="12" height="16" viewBox="0 0 11 6" color='.concat(a,">\n      <path fill='currentColor' d='M0.646447 0.646447C0.841709 0.451184 1.15829 0.451184 1.35355 0.646447L5.5 4.79289L9.64645 0.646447C9.84171 0.451185 10.1583 0.451185 10.3536 0.646447C10.5488 0.841709 10.5488 1.15829 10.3536 1.35355L5.85355 5.85355C5.65829 6.04882 5.34171 6.04882 5.14645 5.85355L0.646447 1.35355C0.451184 1.15829 0.451184 0.841709 0.646447 0.646447Z' />\n    </svg>");return Se(t.root,null,n.primary?Se(t.primaryButton,null,r.slotProps.primaryButton.content,Se(t.chevronSvg,{xml:d})):Se(t.button,null,r.slotProps.button.content,Se(t.chevronSvg,{xml:d})),n.showContextualMenu&&Se(t.contextualMenu,null,o.map(function(c){return c.hasSubmenu&&c.submenuItems?Se(t.contextualMenuItems,null,Se(PPe,Jd({},c))):Se(Yv,Jd({key:c.itemKey},c))})))}}),PPe=function(t){var r=Qi.default.useState(!1),n=r[0],o=r[1],a=Qi.default.useCallback(function(){o(!n)},[n,o]),d=Qi.default.useCallback(function(){o(!1)},[o]),c=t.showSubmenu,u=c===void 0?n:c,l=t.submenuProps,p=t.componentRef,g=t.submenuItems,h=t.onHoverIn,x=h===void 0?a:h,y=mN(t,["showSubmenu","submenuProps","componentRef","submenuItems","onHoverIn"]),T=l.onDismiss,b=T===void 0?d:T,S=l.setShowMenu,E=S===void 0?a:S,P=mN(l,["onDismiss","setShowMenu"]);return Se(Qi.default.Fragment,null,Se(BP,Jd({componentRef:p,onHoverIn:x},y)),u&&Se(LP,Jd({target:p,onDismiss:b,setShowMenu:E},P),g==null?void 0:g.map(function(_){return Se(Yv,Jd({key:_.itemKey},_))})))}});var VX=f(()=>{"use strict";s();pN();UX()});var Ch,r_=f(()=>{"use strict";s();Ch="Tab"});var kl,d1t,jX,WX=f(()=>{"use strict";s();k();kl=I(L()),d1t=I(ee());Me();jX=function(t,r,n,o){var a=o.canShowAnimatedIndicator,d=o.selectedKey,c=o.vertical,u=kl.default.useMemo(function(){return{style:m(m({display:"flex",alignItems:"center",flexDirection:r.flexDirection,alignSelf:"flex-start",justifyContent:"center",padding:1,backgroundColor:r.backgroundColor},c?{}:{height:"100%"}),Zo.from(r,n))}},[r,n,c]),l=kl.default.useMemo(function(){return{style:{flexDirection:"row",paddingStart:r.contentMarginStart,paddingEnd:r.contentMarginEnd}}},[r.contentMarginStart,r.contentMarginEnd]),p=kl.default.useMemo(function(){return{style:m({color:r.color},tn.from(r,n))}},[r,n]),g=kl.default.useMemo(function(){return t.icon?m(m({},t.icon),{color:r.iconColor,size:r.iconSize}):{}},[t.icon,r.iconColor,r.iconSize]),h=kl.default.useMemo(function(){return{style:{display:"flex",alignItems:"center",flexDirection:"row",flex:c?0:1,alignSelf:"flex-start",justifyContent:"center",marginHorizontal:r.stackMarginHorizontal,marginVertical:r.stackMarginVertical}}},[c,r.stackMarginHorizontal,r.stackMarginVertical]),x=kl.default.useMemo(function(){return{style:m({backgroundColor:n.colors.transparentBackground},c?{height:"100%",width:r.indicatorThickness,paddingVertical:r.indicatorMargin}:{width:"100%",height:r.indicatorThickness,paddingHorizontal:r.indicatorMargin})}},[c,r.indicatorThickness,r.indicatorMargin,n]),y=kl.default.useMemo(function(){var T=t.tabKey===d&&a;return{style:{flex:1,borderRadius:r.indicatorRadius,backgroundColor:T?n.colors.transparentBackground:r.indicatorColor}}},[a,t.tabKey,d,r.indicatorColor,r.indicatorRadius,n]);return{root:u,contentContainer:l,content:p,icon:g,stack:h,indicatorContainer:x,indicator:y}}});var zX,GX=f(()=>{"use strict";s();zc();zX=function(t){return{borderColor:t.colors.transparentBackground,color:t.colors.neutralForeground2,iconColor:t.colors.neutralForeground2,indicatorColor:t.colors.transparentBackground,transparent:{backgroundColor:t.colors.transparentBackground},subtle:{backgroundColor:t.colors.subtleBackground},selected:{color:t.colors.neutralForeground1,iconColor:t.colors.compoundBrandForeground1,indicatorColor:t.colors.compoundBrandStroke1,pressed:{color:Wt(t)?t.colors.neutralForeground2:t.colors.neutralForeground1Pressed,iconColor:Wt(t)?t.colors.neutralForeground2:t.colors.compoundBrandForeground1Pressed,indicatorColor:t.colors.compoundBrandStroke1Pressed}},disabled:{color:Wt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,iconColor:Wt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,selected:{color:Wt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,iconColor:Wt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,indicatorColor:Wt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled}},hovered:{color:Wt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Hover,iconColor:Wt(t)?t.colors.compoundBrandForeground1Hover:t.colors.neutralForeground2Hover,indicatorColor:Wt(t)?t.colors.compoundBrandStroke1Hover:t.colors.neutralStroke1Hover,selected:{color:Wt(t)?t.colors.neutralForeground2:t.colors.neutralForeground1Hover,iconColor:Wt(t)?t.colors.neutralForeground2:t.colors.compoundBrandForeground1Hover,indicatorColor:t.colors.compoundBrandStroke1Hover,subtle:{indicatorColor:Wt(t)?t.colors.neutralStroke1:t.colors.compoundBrandStroke1Hover}},disabled:{indicatorColor:t.colors.transparentBackground},transparent:{backgroundColor:t.colors.transparentBackgroundHover},subtle:{backgroundColor:t.colors.subtleBackgroundHover,indicatorColor:Wt(t)?t.colors.neutralStroke1:t.colors.neutralStroke1Hover}},pressed:{color:Wt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Pressed,iconColor:Wt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Pressed,indicatorColor:Wt(t)?t.colors.compoundBrandBackground1Pressed:t.colors.neutralStroke1Pressed,transparent:{backgroundColor:t.colors.transparentBackgroundPressed},subtle:{backgroundColor:t.colors.subtleBackgroundPressed}},focused:{borderColor:Wt(t)?t.colors.compoundBrandStroke1:t.colors.neutralForeground1}}}});var qX,_Pe,KX,YX=f(()=>{"use strict";s();Me();r_();GX();qX=["small","medium","large","vertical","hovered","disabled","selected","focused","pressed","transparent","subtle","hasIcon"],_Pe={indicatorOrientation:"horizontal",indicatorThickness:2,borderWidth:2,borderRadius:4,contentMarginStart:2,contentMarginEnd:2,flexDirection:"column",indicatorRadius:99,small:{iconSize:20,iconMargin:2,indicatorMargin:8,stackMarginHorizontal:6,stackMarginVertical:8,variant:"body1",selected:{variant:"body1Strong"}},medium:{iconSize:20,iconMargin:6,indicatorMargin:12,stackMarginHorizontal:10,stackMarginVertical:12,variant:"body1",selected:{variant:"body1Strong"}},large:{iconSize:24,iconMargin:6,indicatorMargin:12,stackMarginHorizontal:10,stackMarginVertical:16,variant:"body2",selected:{variant:"subtitle2"}},vertical:{flexDirection:"row-reverse",indicatorOrientation:"vertical",small:{indicatorMargin:4,stackMarginHorizontal:6,stackMarginVertical:2},medium:{indicatorMargin:8,stackMarginHorizontal:10,stackMarginVertical:6},large:{indicatorMargin:10,stackMarginHorizontal:10,stackMarginVertical:8}},hasIcon:{contentMarginStart:8}},KX=Xf(_Pe,zX,Ch)});var $X,vh,up,Xv=f(()=>{"use strict";s();$X=I(L()),vh=function(){return null},up=$X.createContext({addTabKey:vh,appearance:"transparent",canShowAnimatedIndicator:!1,disabled:!1,onTabSelect:vh,removeTabKey:vh,selectedKey:"",setFocusedTabRef:vh,size:"small",tabKeys:[],vertical:!1,updateDisabledTabs:vh,updateTabRef:vh})});function APe(e,t,r){return r?m({disabled:e,selected:t},r):{disabled:e,selected:t}}var Pi,QX,XX,RPe,JX=f(()=>{"use strict";s();k();Pi=I(L());Me();Mn();Xv();QX=[{name:"Select"}],XX=function(t){var r,n=Pi.useRef(null),o=t.accessibilityActions,a=t.accessibilityPositionInSet,d=t.accessibilitySetSize,c=t.accessibilityState,u=t.accessible,l=t.componentRef,p=l===void 0?n:l,g=t.disabled,h=t.icon,x=t.onAccessibilityAction,y=t.tabKey,T=je(t,["accessibilityActions","accessibilityPositionInSet","accessibilitySetSize","accessibilityState","accessible","componentRef","disabled","icon","onAccessibilityAction","tabKey"]),b=Pi.useContext(up),S=b.addTabKey,E=b.invoked,P=b.onTabSelect,_=b.removeTabKey,D=b.setInvoked,O=b.setFocusedTabRef,H=b.selectedKey,V=b.tabKeys,M=b.vertical,G=b.updateDisabledTabs,K=b.updateTabRef,z=je(b,["addTabKey","invoked","onTabSelect","removeTabKey","setInvoked","setFocusedTabRef","selectedKey","tabKeys","vertical","updateDisabledTabs","updateTabRef"]),$=g||z.disabled,q=Pi.useCallback(function(){P(y),p&&O(p)},[p,O,P,y]),re=Pi.useCallback(function(){q(),D(!0)},[q,D]),ae=qd(m(m({},T),{onPress:re})),ie=ni(q," ","Enter");Pi.useEffect(function(){return S(y),H===y&&p&&O(p),function(){return _(y)}},[]),Pi.useEffect(function(){K(y,p)},[y,p]),Pi.useEffect(function(){G(y,g)},[y,g]),Pi.useEffect(function(){var ke;E&&D&&y===H&&!$&&(p&&O(p),(ke=p==null?void 0:p.current)===null||ke===void 0||ke.focus(),D(!1))},[E,D]);var Te=Pi.useCallback(function(ke){if(!$){switch(ke.nativeEvent.actionName){case"Select":q();break}x&&x(ke)}},[q,$,x]),Oe=Pi.useMemo(function(){return o?w(w([],QX,!0),o,!0):QX},[o]);return{props:m(m(m(m({},t),ae.props),{accessible:u??!0,accessibilityRole:"tab",accessibilityActions:Oe,accessibilityPositionInSet:a??V.findIndex(function(ke){return ke===y})+1,accessibilityState:RPe($,H===y,c),accessibilitySetSize:d??V.length,disabled:$,focusable:(r=!$)!==null&&r!==void 0?r:!0,icon:h,onAccessibilityAction:Te,ref:Ar(p),tabKey:y}),ie),state:m(m({},ae.state),{selected:y===H})}},RPe=Jt(APe)});function eJ(e,t,r,n){var o=t.addTabLayout,a=t.selectedKey,d=t.layout,c=t.updateAnimatedIndicatorStyles,u=t.vertical,l=e.tabKey;n_.default.useEffect(function(){l===a&&c&&c({backgroundColor:r.indicatorColor,borderRadius:r.indicatorRadius})},[l,a,r.indicatorColor,r.indicatorRadius]);var p=n_.default.useCallback(function(g){if(g.nativeEvent.layout&&!1||d!=null&&d.tablist&&d.tablist.width>0&&g.nativeEvent.layout.height<=d.tablist.height&&g.nativeEvent.layout.height<kPe){var h=g.nativeEvent.layout,x=h.width,y=h.height,T=h.x,b=h.y,S=void 0,E=void 0,P=void 0,_=void 0,D=1,O=r.indicatorMargin+r.borderWidth+D;u?(S=r.indicatorThickness,E=y-O*2,_=b+O,ZX.I18nManager.isRTL?P=T+x-(r.borderWidth+D+S):P=T+r.borderWidth+D):(S=x-O*2,E=r.indicatorThickness,P=T+O,_=y+b-E-r.borderWidth-D),o(l,{x:P,y:_,width:S,height:E})}},[o,d,l,r.borderWidth,r.indicatorMargin,r.indicatorThickness,u]);return n_.default.useMemo(function(){return m(m({},n),{onLayout:p})},[n,p])}var n_,ZX,kPe,tJ=f(()=>{"use strict";s();k();n_=I(L()),ZX=I(ee()),kPe=2e4});var o_,lp,DPe,gN,rJ=f(()=>{"use strict";s();k();o_=I(L()),lp=I(ee());Me();rp();ga();WX();r_();YX();JX();tJ();Xv();DPe=function(t,r,n,o){return r[t]||n[t]||o[t]||t===o.appearance||t===o.size||t==="hasIcon"&&n.icon},gN=Cl(function(e,t){var r,n=o_.default.useContext(up),o=XX(e),a=ma(),d=t(a),c=d[0],u=d[1];r=yl(c,qX,u,function(E){return DPe(E,o.state,o.props,n)}),c=r[0],u=r[1];var l=jX(o.props,c,a,n),p=eJ(e,n,c,l.root),g=Za(lp.Pressable,p),h=Za(lp.View,l.stack),x=Za(lp.View,l.indicatorContainer),y=Za(lp.View,l.indicator),T=Za(lp.View,l.contentContainer),b=Za(on,l.content),S=Za(tp,l.icon);return function(E){for(var P=[],_=1;_<arguments.length;_++)P[_-1]=arguments[_];if(!o.state)return null;var D="",O=!1;o_.default.Children.forEach(P,function(K){K!==null&&(O=!0,typeof K=="string"&&(D=K))});var H=dt(o.props,E,{accessibilityLabel:o.props.accessibilityLabel||E.accessibilityLabel||D}),V=H.icon,M=H.tabKey,G=je(H,["icon","tabKey"]);return Ae(g,m({},G),Ae(h,null,V&&Ae(S,m({},V)),O&&Ae(T,null,o_.default.Children.map(P,function(K,z){return typeof K=="string"?Ae(b,{accessible:!1,key:z},K):K}))),Ae(x,null,Ae(y,null)))}},KX);gN.displayName=Ch});var xh,i_=f(()=>{"use strict";s();xh="TabList"});var nJ,oJ=f(()=>{"use strict";s();nJ=function(){return{direction:"row",vertical:{direction:"column"}}}});var iJ,aJ=f(()=>{"use strict";s();k();Me();i_();oJ();iJ={tokens:[nJ,xh],states:["vertical"],slotProps:{stack:lt(function(e){return{style:{display:"flex",flexDirection:e.direction,flex:0}}},["direction"]),root:lt(function(e,t){return{style:m({display:"flex",alignItems:"flex-start"},Mo.from(e,t))}},Mo.keys)}}});function FPe(e,t){return t?m({disabled:e},t):{disabled:e}}var an,sJ,wPe,dJ=f(()=>{"use strict";s();k();an=I(L());Me();Mn();sJ=function(t){var r=an.useRef(null),n=t.accessible,o=t.appearance,a=o===void 0?"transparent":o,d=t.accessibilityState,c=t.componentRef,u=c===void 0?r:c,l=t.defaultSelectedKey,p=t.disabled,g=p===void 0?!1:p,h=t.isCircularNavigation,x=t.onTabSelect,y=t.selectedKey,T=t.size,b=T===void 0?"medium":T,S=t.vertical,E=S===void 0?!1:S,P=Il(y||l||null,x),_=y??P.selectedKey,D=an.useState(an.useRef(null)),O=D[0],H=D[1],V=an.useState(!1),M=V[0],G=V[1],K=an.useState([]),z=K[0],$=K[1],q=an.useState(!1),re=q[0],ae=q[1],ie=an.useRef({}).current,Te=an.useRef({}).current,Oe=an.useCallback(function(Sr,$r){return ie[Sr]=$r},[ie]),ke=an.useCallback(function(Sr,$r){Te[Sr]=$r,re&&!$r&&ae(!1)},[re,Te]),it=an.useCallback(function(Sr){$(function($r){return w(w([],$r,!0),[Sr],!1)})},[z,$]),_e=an.useCallback(function(Sr){$(function($r){return $r.filter(function(ys){return ys!==Sr})})},[$]),ct=an.useState({}),Ge=ct[0],Nt=ct[1],Vt=an.useState(),yt=Vt[0],zt=Vt[1],Fr=an.useState({}),In=Fr[0],jn=Fr[1],io=an.useCallback(function(Sr,$r){Nt(function(ys){var cd;return m(m({},ys),(cd={},cd[Sr]=$r,cd))})},[Nt]),ut=an.useCallback(function(Sr){jn(function($r){return Si($r,Sr)})},[jn]),pn=an.useCallback(function(Sr){Sr.nativeEvent.layout&&zt(Sr.nativeEvent.layout)},[zt]),ql=Te[_];return an.useEffect(function(){if(ql){for(var Sr=z.indexOf(_),$r=0;$r<z.length&&(Sr=(Sr+1)%z.length,!!Te[z[Sr]]);$r++);if(z[Sr]===_)ae(!0);else{var ys=ie[z[Sr]];H(ys)}}},[ql]),{props:m(m({},t),{accessible:n??!0,accessibilityState:wPe(g||re,d),accessibilityRole:"tablist",appearance:a,componentRef:u,defaultTabbableElement:O,isCircularNavigation:h??!1,onLayout:pn,size:b,vertical:E}),state:{addTabKey:it,addTabLayout:io,animatedIndicatorStyles:In,appearance:a,canShowAnimatedIndicator:!!(In&&Ge&&Ge[_]),disabled:g||re,invoked:M,layout:{tablist:yt,tabs:Ge},onTabSelect:P.onKeySelect,removeTabKey:_e,selectedKey:_,setFocusedTabRef:H,setInvoked:G,size:b,tabKeys:z,vertical:E,updateAnimatedIndicatorStyles:ut,updateDisabledTabs:ke,updateTabRef:Oe}}},wPe=Jt(FPe)});var cJ,uJ=f(()=>{"use strict";s();cJ="TabListAnimatedIndicator"});function lJ(e){var t=e.animatedIndicatorStyles,r=e.selectedKey,n=e.tabLayout,o=hN.default.useMemo(function(){return r?n[r]:null},[r,n]),a=hN.default.useMemo(function(){if(!o)return null;var d=o.x,c=o.y,u=o.width,l=o.height,p=m(m({},t),{position:"absolute",width:u,height:l,left:d,top:c});return p},[o,t]);return a}var hN,fJ=f(()=>{"use strict";s();k();hN=I(L())});function NPe(e,t){return{animationClass:e,style:t}}var pJ,mJ,OPe,gJ,hJ,yJ=f(()=>{"use strict";s();k();pJ=I(L()),mJ=I(ee());Me();uJ();fJ();OPe=Jt(NPe);gJ=Nn(function(e){var t=lJ(e);return function(){var r=OPe("Ribbon_TabUnderline",t);return pJ.default.createElement(mJ.View,m({},r))}});gJ.displayName=cJ;hJ=gJ});var yN,CJ,vJ=f(()=>{"use strict";s();k();yN=I(ee());ap();Me();aJ();i_();Xv();dJ();yJ();CJ=rn(m(m({displayName:xh},iJ),{slots:{container:os,stack:yN.View,root:yN.View},useRender:function(t,r){var n=sJ(t),o=r(t);return function(a){for(var d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];if(!n.state)return null;var u=dt(n.props,a),l=u.disabled,p=u.defaultTabbableElement,g=u.isCircularNavigation,h=u.vertical,x=je(u,["disabled","defaultTabbableElement","isCircularNavigation","vertical"]),y=n.state,T=y.animatedIndicatorStyles,b=y.canShowAnimatedIndicator,S=y.disabled,E=y.layout,P=y.selectedKey;return Ae(up.Provider,{value:n.state},Ae(o.root,m({},x),Ae(o.container,{disabled:l||S,defaultTabbableElement:p,focusZoneDirection:h?"vertical":"horizontal",isCircularNavigation:g},Ae(o.stack,null,d),b&&Ae(hJ,{animatedIndicatorStyles:T,selectedKey:P,tabLayout:E.tabs,vertical:h}))))}}}))});var xJ=f(()=>{"use strict";s();r_();rJ();i_();vJ();Xv()});var Js=f(()=>{"use strict";s();$O();Gv();sQ();tN();PQ();ap();NQ();bX();QP();PX();OX();ga();Mn();VX();xJ()});function MPe(e,t,r){e.target===e.currentTarget&&(t(!0),r==null||r(e))}function LPe(e,t,r){e.target===e.currentTarget&&(t(!1),r==null||r(e))}function a_(e){return function(t){var r=t.nodeId,n=t.isTabbable,o=t.onFocusStateChange,a=t.onFocus,d=t.onBlur,c=t.nodeData,u=t.keyDownEvents,l=t.preventDefaultKeyDownBehavior,p=t.focusable,g=t.children,h=je(t,["nodeId","isTabbable","onFocusStateChange","onFocus","onBlur","nodeData","keyDownEvents","preventDefaultKeyDownBehavior","focusable","children"]),x=j(Xc.useState(!1),2),y=x[0],T=x[1],b=vb(r,c,n,o,y,!1),S=Xc.useCallback(function(D){return MPe(D,T,a)},[T,a]),E=Xc.useCallback(function(D){return LPe(D,T,d)},[T,d]),P=e,_=h;return Xc.createElement(Sl.Consumer,null,function(D){return Xc.createElement(vc,{node:b.current,position:D,ref:b.current.registrationRef},Xc.createElement(P,m({},_,{componentRef:b.current.innerComponentRef,onFocus:S,onBlur:E,keyDownEvents:sO(u,l)})))})}}var Xc,CN=f(()=>{"use strict";s();k();Lt();Xc=I(L());Yc()});var TJ,bJ=f(()=>{"use strict";s();Js();CN();ri();TJ=function(t,r){var n=mr(r),o=a_(nh.customize({root:{style:{flex:0,borderRadius:4,borderWidth:1,padding:1,justifyContent:"center",alignItems:"center",paddingRight:4,paddingLeft:4,paddingTop:4,paddingBottom:4,borderColor:"transparent"}},checkbox:{style:{flex:0,marginEnd:0,marginTop:0,height:16,width:16,alignItems:"center",alignContent:"center"}},checkmark:{accessible:!1,style:{top:void 0}},content:{style:{display:"none"}},tokens:{borderRadius:8,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.roundCheckboxBorderColor},_overrides:{pressed:{checkmark:{style:{fontWeight:"bold"}},tokens:{checkboxBackgroundColor:n.expandButtonTextColor,checkboxBorderColor:n.expandButtonTextColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:t.palette.FocusBorderColor,borderStyle:"solid",padding:0}}}}}));return o.displayName="RoundCheckbox",o}});var SJ,Ve,xn=f(()=>{"use strict";s();k();Js();SJ=I(L()),Ve=function(t){var r=t.textStylePolyester,n=t.variantFluent,o=t.colorFluent,a=je(t,["textStylePolyester","variantFluent","colorFluent"]);return SJ.createElement(on,m({variant:n,color:o},a))};Ve.displayName="TextWrapper"});var IJ,EJ,PJ=f(()=>{"use strict";s();ze();IJ=Ce({paddingTop:1,paddingLeft:3,flex:1}),EJ=Ce({paddingBottom:2,paddingRight:3,paddingLeft:5,borderRadius:2,flex:0})});function _J(e){return typeof e=="string"?oi.createElement(Ve,{variantFluent:"secondaryStandard",key:"text",accessible:!1},e):e}var oi,BPe,RJ,AJ=f(()=>{"use strict";s();rt();Cb();Me();oi=I(L());TD();hn();S1();mi();Vr();Lo();ri();uO();So();fn();xr();XC();bJ();bl();xn();PJ();BPe=oi.memo(function(t){var r=t.assignees.length>1?_J(t.localizationAPI.getString(251)):dY(Tb(t.text),function(){return oi.createElement(Ve,{variantFluent:"secondarySemibold",key:"name",accessible:!1},Nr(t.assignees[0]))}).map(_J);return oi.createElement(oi.Fragment,null,r)}),RJ=oi.memo(function(t){var r=t.localizationAPI.getString(111),n=xS(t.assignees),o=pE(t.completion),a,d;t.assignees.length>0?(a=Dj(t.assignees,t.localizationAPI),d=wj(t.assignees,o,t.localizationAPI)):(a=rF(t.localizationAPI),d=nF(o,t.localizationAPI));var c=t.id,u=t.onResolveTaskCheckboxPressed,l=oi.useCallback(function(){u&&u(c)},[u,c]),p=fD(et(TJ)),g=function(x,y,T){var b=p(x,y),S=mr(y),E=[IJ],P=S.text;return n&&(E.push(EJ,{backgroundColor:S.assignedToYouBackground}),P=S.assignedToYouText),oi.createElement(J,{key:"tasktopper",style:K0.render(Kr(T.renderContextType))},oi.createElement(b,{isTabbable:t.isTabbable,disabled:t.displayMode===Kf.ReadOnly||t.displayMode===Kf.Disabled,preventDefaultKeyDownBehavior:t.preventDefaultKeyDownBehavior,checked:o,onChange:l,accessibilityLabel:d,nodeId:"card-task-header",tooltip:Oj(!1,t.localizationAPI)}),oi.createElement(J,{style:E,tooltip:Nj(t.assignees,t.localizationAPI)},oi.createElement(Ve,{numberOfLines:1,variantFluent:"secondarySemibold",colorFluent:P,accessible:!1},t.assignees.length>0&&!n?oi.createElement(BPe,{text:r,assignees:t.assignees,localizationAPI:t.localizationAPI}):a)))};return Ye(g,Ze,Zt,nn)})});var vN,kJ=f(()=>{"use strict";s();ze();vN=Ce({marginLeft:5,marginBottom:3})});var Jv,fp,DJ=f(()=>{"use strict";s();Me();Jv=I(L());ue();Av();mi();Vr();ri();xn();kJ();fp=Jv.memo(function(t){var r=function(o){if(t.draftWarningState){var a=mr(o),d=NI(t.localizationAPI,t.draftWarningState.type);return Jv.createElement(Ve,{style:t.target===Ud.Card?vN:void 0,textStylePolyester:"Error",variantFluent:"secondaryStandard",colorFluent:a.warningTextColor,testID:t.id},d)}return Ab()&&t.defaultToPostingTip?Jv.createElement(Ve,{variantFluent:"secondaryStandard",colorFluent:"subText",key:"posting-tip",accessible:!0,style:vN},t.localizationAPI.getString(233)):null};return Ye(r,Zt)})});var s_=f(()=>{"use strict";s();DJ()});var xN,is,d_=f(()=>{"use strict";s();(function(e){e[e.RootPost=1]="RootPost",e[e.ReplyPost=2]="ReplyPost",e[e.ViewMoreRepliesButton=3]="ViewMoreRepliesButton"})(xN||(xN={}));is=xN});function jPe(e,t){switch(e){case is.RootPost:return 4+t*FJ;case is.ReplyPost:return 30+t*FJ;case is.ViewMoreRepliesButton:return 6;default:Ne(e)}}function WPe(e){switch(e){case is.RootPost:return 0;case is.ReplyPost:return-4;case is.ViewMoreRepliesButton:return 4;default:Ne(e)}}var wJ,VPe,FJ,OJ,NJ=f(()=>{"use strict";s();te();rt();d_();_r();wJ=8,VPe=1,FJ=20;OJ=et(function(e,t){return new R([R.always(function(r){return{backgroundColor:r.palette.UnreadDotColor,borderColor:r.palette.UnreadDotBorderColor,borderRadius:4,borderStyle:"solid",borderWidth:VPe,height:wJ,width:wJ,position:"absolute",top:jPe(e,t),left:WPe(e)}})])})});var Zv,MJ,ex,LJ=f(()=>{"use strict";s();Zv=I(L()),MJ=I(ee());ze();xr();NJ();ex=Zv.memo(function(t){var r=OJ(t.dotType,t.historyItemCount);return Zv.createElement(Ze.Consumer,null,function(n){return Zv.createElement(MJ.View,{style:ot(r,n,t.renderContextType)})})})});var TN=f(()=>{"use strict";s();LJ()});var HJ,BJ=f(()=>{"use strict";s();Lt();HJ=function(){function e(t){var r=t.nativeEvent,n=r.eventPhase,o=r.altKey,a=r.shiftKey,d=r.ctrlKey,c=r.metaKey;this.eventPhase=n,this.altKey=o,this.shiftKey=a,this.ctrlKey=d,this.metaKey=c,this.key=Cc(t.nativeEvent.key),this.target=t.target}return e.prototype.isEventTarget=function(t){return t===this.target},e.prototype.preventDefault=function(){},e.prototype.stopPropagation=function(){},e}()});function UJ(e){return new HJ(e)}function VJ(){return{nativeEvent:void 0,currentTarget:void 0,target:void 0,bubbles:!1,cancelable:!1,defaultPrevented:!1,eventPhase:0,isTrusted:!1,preventDefault:function(){},isDefaultPrevented:function(){return!1},stopPropagation:function(){},isPropagationStopped:function(){return!1},persist:function(){},timeStamp:Date.now(),type:""}}var bN=f(()=>{"use strict";s();BJ()});function c_(e){return e.map(function(t){return{name:t}})}var u_,tx=f(()=>{"use strict";s();u_=function(t,r){return t}});var jJ,l_,GPe,Wr,SN=f(()=>{"use strict";s();k();rt();Lt();jJ=I(vm()),l_=I(L());bN();Yc();tx();GPe=Ws(jJ.TouchableWin32),Wr=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.refManager=new tf,n.focus=n.refManager.focus,n.blur=n.refManager.blur,n.getFocusState=n.refManager.getFocusState,n.getChildNodes=n.refManager.getChildNodes,n.addChildNode=n.refManager.addChildNode,n.getDescendantById=n.refManager.getDescendantById,n.getId=n.refManager.getId,n.getData=n.refManager.getData,n.isTabbable=n.refManager.isTabbable,n.getNextTabTarget=n.refManager.getNextTabTarget,n.getIterator=n.refManager.getIterator,n.onFocusStateChange=function(o){n.setState({hasFocus:o!==ge.Unfocused}),n.props.onFocusStateChange&&n.props.onFocusStateChange(o)},n.getOnAccessibilityOrKeyPress=En(function(o,a){return o||a?function(d){if(!(d&&d.target!==d.currentTarget)){if(o){o();return}a&&a(d??VJ())}}:void 0},function(){return[n.props.onAccessibilityOrKeyPress,n.props.onPress]}),n.renderStyle=function(o){return o.isFocused?[n.props.style,n.props.focusedStyle]:o.isHovered?[n.props.style,n.props.hoveredStyle]:o.isPressed?[n.props.style,n.props.pressedStyle]:n.props.style},n.state={hasFocus:!1},n}return t.prototype.render=function(){var r=this.props,n=r.focusedStyle,o=r.hoveredStyle,a=r.pressedStyle,d=r.style,c=r.onAccessibilityOrKeyPress,u=r.onFocusStateChange,l=r.onPress,p=r.pointerEvents,g=r.accessibilityRole,h=je(r,["focusedStyle","hoveredStyle","pressedStyle","style","onAccessibilityOrKeyPress","onFocusStateChange","onPress","pointerEvents","accessibilityRole"]);return l_.createElement(GPe,m({},h,{renderStyle:this.renderStyle,touchableHandlePress:this.props.onPress,touchableHandleKeyPressDown:this.getOnAccessibilityOrKeyPress(),focusable:!this.props.disabled,ref:this.refManager.ref,accessibilityRole:u_(g)||"button",onFocusStateChange:this.onFocusStateChange,onAccessibilityTap:this.getOnAccessibilityOrKeyPress()}))},t}(l_.PureComponent)});var as=f(()=>{"use strict";s();SN()});var f_,p_,IN,EN,WJ,zJ,GJ,qJ=f(()=>{"use strict";s();Be();Kc();So();_r();f_=5,p_=17,IN=16,EN=p_+Rr+Yg,WJ=new R([R.always(function(e){return{justifyContent:"center",paddingRight:IN,paddingLeft:p_,paddingBottom:1,marginRight:f_,marginLeft:f_,minHeight:bK,borderWidth:1,borderColor:e.palette.ExpandButtonBackground,backgroundColor:e.palette.ExpandButtonBackground}}),R.rule({renderContextType:A.DiscreteIsolated},{paddingLeft:EN})]),zJ=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),GJ=new R([R.always(function(e){return{backgroundColor:e.palette.ExpandButtonHoverBackground,borderColor:e.palette.ExpandButtonHoverBackground}})])});function KPe(e){e(!0)}function YPe(e){e(!1)}function $Pe(e,t,r,n){return e&&t!==7?n.text:r?n.expandButtonTextHoverColor:n.expandButtonTextColor}function QPe(e,t){var r=e===A.DiscreteIsolated?EN:p_,n=f_-t;return{marginLeft:t,marginRight:t,paddingLeft:r+n,paddingRight:IN+n}}var Ca,m_,KJ=f(()=>{"use strict";s();k();Z();Me();Vy();Ca=I(L());d_();Be();Vr();ri();So();ze();xr();TN();as();pr();xn();qJ();m_=Ca.memo(function(e){var t=j(Ca.useState(!1),2),r=t[0],n=t[1],o=j(Ca.useState(ge.Unfocused),2),a=o[0],d=o[1],c=Ca.useCallback(function(){return KPe(n)},[n]),u=Ca.useCallback(function(){return YPe(n)},[n]);return Ye(function(l,p){var g=mr(p),h=[ot(WJ,l,e.renderContextType)];return r&&h.push(ot(GJ,l,e.renderContextType)),a===ge.FocusOn&&h.push(ot(zJ,l,e.renderContextType)),l.themeId===7&&(e.minimumMarginLeftRight?h.push(QPe(e.renderContextType,e.minimumMarginLeftRight)):v().assertConditionTag(!1,"minimumMarginLeftRight should be defined.",557949464)),Ca.createElement(Wr,{animationClass:e.animationClass,onPress:e.onPress,accessibilityLabel:e.innerText,nodeId:e.id,testID:e.id,isTabbable:!!e.isTabbable,accessible:!0,onMouseEnter:c,onMouseLeave:u,onFocusStateChange:d,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},Ca.createElement(J,{style:h},e.unreadPostHidden?Ca.createElement(ex,{dotType:is.ViewMoreRepliesButton,historyItemCount:0,renderContextType:e.renderContextType}):null,Ca.createElement(Ve,{textStylePolyester:"MediumApp",variantFluent:"secondarySemibold",colorFluent:$Pe(e.isCardResolved,l.themeId,r,g),style:e.isCardResolved?ot($g,l,e.renderContextType):void 0,accessible:!1},e.innerText)))},Ze,Zt)});m_.displayName="ExpandCardButton"});var YJ=f(()=>{"use strict";s();KJ()});function g_(e){return e.tooltipText||e.text}var PN=f(()=>{"use strict";s()});var h_,_N,RN,_i,Dl=f(()=>{"use strict";s();h_=I(L()),_N=h_.createContext({isControlled:!1,checked:[],defaultChecked:[],hasCheckmarks:!1,hasIcons:!1,hasTooltips:!1,isSubmenu:!1,open:!1,onCheckedChange:function(){return!1},setOpen:function(){return!1},shouldFocusOnContainer:void 0,triggerRef:null,hasMaxHeight:!1,hasMaxWidth:!1}),RN=_N.Provider,_i=function(){return h_.useContext(_N)}});var y_,$J,QJ,pp,rx=f(()=>{"use strict";s();y_=I(L()),$J=y_.createContext({isCheckedControlled:!1,checked:{},hasCheckmarks:!1,hasIcons:!1,hasTooltips:!1,onCheckedChange:function(){return!1},onArrowClose:function(){return!1},addRadioItem:function(){return!1},removeRadioItem:function(){return!1},trackMenuItem:function(){return!1},untrackMenuItem:function(){return!1}}),QJ=$J.Provider,pp=function(){return y_.useContext($J)}});var AN,XJ,JJ,ZJ,kN=f(()=>{"use strict";s();AN=I(L()),XJ=AN.default.createContext(!1),JJ=XJ.Provider,ZJ=function(){return AN.default.useContext(XJ)}});var DN=f(()=>{"use strict";s();Dl()});var wN,eZ,tZ=f(()=>{"use strict";s();wN="Menu";(function(e){e[e.Hidden=0]="Hidden",e[e.Animating=1]="Animating",e[e.Shown=2]="Shown"})(eZ||(eZ={}))});var rZ,nZ,oZ=f(()=>{"use strict";s();rZ=I(L());DN();nZ=function(t,r,n){var o=t[0],a=t[1];return rZ.default.createElement(RN,{value:r},o,n.open&&n.shouldFocusOnContainer!==void 0&&a)}});var mp,b2t,XPe,iZ,FN,JPe,ZPe,aZ=f(()=>{"use strict";s();k();mp=I(L()),b2t=I(ee());Mn();Dl();XPe=150,iZ=-1,FN=function(t){var r=mp.default.useRef(),n=_i(),o=n.triggerRef!==null,a=typeof t.open<"u",d=JPe(a,t,n.setOpen),c=d[0],u=d[1],l=d[2],p=ZPe(t),g=p[0],h=p[1],x=o,y=o?n.popoverHoverOutTimer:void 0;return m(m({openOnHover:x},t),{open:c,setOpen:l,shouldFocusOnContainer:u,checked:g,onCheckedChange:h,triggerRef:r,isSubmenu:o,isControlled:a,parentPopoverHoverOutTimer:y})},JPe=function(t,r,n){var o=r.defaultOpen,a=r.onOpenChange,d=r.open,c=typeof o<"u"?o:!!d,u=mp.default.useState(c),l=u[0],p=u[1],g=mp.default.useState(void 0),h=g[0],x=g[1],y=t?d:l,T=mp.default.useCallback(function(b,S,E){var P=y;!t&&(!S||iZ+XPe<=Date.now())&&p(S),S&&(nP(b)?x(!0):x(!1)),S||(x(void 0),iZ=Date.now()),a&&P!==S&&a(b,S),E&&n&&n(b,S,E)},[t,y,a,p,n]);return[y,h,T]},ZPe=function(t){var r,n=t.checked,o=t.defaultChecked,a=t.onCheckedChange,d=mp.default.useState((r=o??n)!==null&&r!==void 0?r:[]),c=d[0],u=d[1],l=typeof n<"u",p=l?n:c,g=mp.default.useCallback(function(h,x){l||u(x),a==null||a(h,x)},[l,u,a]);return[p,g]}});var ON,NN,sZ=f(()=>{"use strict";s();k();ON=I(L()),NN=function(t){var r=ON.default.useState(),n=r[0],o=r[1],a=ON.default.useState(),d=a[0],c=a[1];return m(m({},t),{popoverHoverOutTimer:d,triggerHoverOutTimer:n,setPopoverHoverOutTimer:c,setTriggerHoverOutTimer:o})}});var dZ,nx,cZ=f(()=>{"use strict";s();dZ=I(L());Me();tZ();oZ();aZ();sZ();nx=Nn(function(e){var t=FN(e),r=NN(t);return function(n,o){var a=dZ.default.Children.toArray(o);return nZ(a,r,t)}});nx.displayName=wN});var uZ=f(()=>{"use strict";s();cZ()});var MN,lZ=f(()=>{"use strict";s();MN="MenuTrigger"});function pZ(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=fZ.useCallback(function(n){r.current=n;for(var o=0,a=e;o<a.length;o++){var d=a[o];typeof d=="function"?d(n):d&&(d.current=n)}},w([],e,!0));return r}var fZ,mZ=f(()=>{"use strict";s();k();fZ=I(L())});var q2t,gZ,hZ=f(()=>{"use strict";s();q2t=I(ee()),gZ=500});var gp,X2t,yZ,e_e,t_e,LN,CZ=f(()=>{"use strict";s();k();gp=I(L()),X2t=I(ee());mZ();hZ();Dl();yZ=[{name:"Expand"},{name:"Collapse"}],e_e={expanded:!0},t_e={expanded:!1},LN=function(t){var r=_i(),n=r.hoverDelay,o=n===void 0?gZ:n,a=r.open,d=r.openOnHover,c=r.popoverHoverOutTimer,u=r.setOpen,l=r.setTriggerHoverOutTimer,p=r.triggerHoverOutTimer,g=r.triggerRef,h=t.accessibilityActions,x=t.accessibilityState,y=t.onAccessibilityAction,T=t.accessibilityPositionInSet,b=t.accessibilitySetSize,S=t.onClick,E=t.onHoverIn,P=t.onHoverOut,_=t.componentRef,D=gp.default.useMemo(function(){return h?w(w([],yZ,!0),h,!0):yZ},[h]),O=gp.default.useMemo(function(){var z=a?e_e:t_e;return x?m(m({},z),x):z},[x,a]),H=gp.default.useCallback(function(z){switch(z.nativeEvent.actionName){case"Expand":u(z,!0);break;case"Collapse":u(z,!1);break}y&&y(z)},[y,u]),V=gp.default.useCallback(function(z){d&&(clearTimeout(c),clearTimeout(p),z.persist(),setTimeout(function(){u(z,!0)},o)),E&&E(z)},[E,o,d,u,p,c]),M=gp.default.useCallback(function(z){if(d){z.persist();var $=setTimeout(function(){u(z,!1)},o);l($)}P&&P(z)},[P,o,d,u,l]),G=gp.default.useCallback(function(z){u(z,!a),S&&S(z)},[S,a,u]),K=pZ(g,_);return{props:{onClick:G,onHoverIn:V,onHoverOut:M,componentRef:K,accessibilityState:O,accessibilityActions:D,onAccessibilityAction:H,accessibilityPositionInSet:T??r.accessibilityPositionInSet,accessibilitySetSize:b??r.accessibilitySetSize},hasSubmenu:r.isSubmenu}}});var C_,ox,vZ=f(()=>{"use strict";s();k();C_=I(L());lZ();CZ();kN();ox=function(t){var r=LN(t.children.props),n=C_.cloneElement(t.children,m(m({},t.children.props.tooltip&&{alwaysShowToolTip:!0}),r.props));return C_.createElement(JJ,{value:r.hasSubmenu},n)};ox.displayName=MN});var xZ=f(()=>{"use strict";s();vZ()});var ix,HN=f(()=>{"use strict";s();ix="MenuPopover"});var TZ,bZ=f(()=>{"use strict";s();Me();HN();TZ=Xf(function(e){return{borderWidth:1,borderColor:e.colors.neutralStrokeAccessible}},ix)});var Jc,IZ,r_e,SZ,BN,n_e,EZ=f(()=>{"use strict";s();Jc=I(L()),IZ=I(ee());Dl();r_e=["preventDismissOnKeyDown","preventDismissOnClickOutside"],SZ=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End","Escape"],BN=function(t){var r,n=_i(),o=n.setOpen,a=n.triggerRef,d=n.isControlled,c=n.isSubmenu,u=n.openOnHover,l=n.parentPopoverHoverOutTimer,p=n.popoverHoverOutTimer,g=n.setPopoverHoverOutTimer,h=n.shouldFocusOnContainer,x=n.triggerHoverOutTimer,y=t.onKeyDown,T=t.onKeyUp,b=Jc.default.useCallback(function(){var q;(q=t.onDismiss)===null||q===void 0||q.call(t),o(void 0,!1)},[t.onDismiss,o]),S=d?r_e:void 0,E=n_e(c,IZ.I18nManager.isRTL),P=!0,_=(r=t.doNotTakePointerCapture)!==null&&r!==void 0?r:u,D="menu",O=Jc.default.useCallback(function(){clearTimeout(x),clearTimeout(p),clearTimeout(l)},[l,p,x]),H=Jc.default.useCallback(function(){if(u){var q=setTimeout(function(){o(void 0,!1)},500);g(q)}},[u,o,g]),V=Jc.default.useCallback(function(q){y&&y(q),SZ.includes(q.nativeEvent.key)&&q.stopPropagation()},[y]),M=Jc.default.useCallback(function(q){T&&T(q),SZ.includes(q.nativeEvent.key)&&q.stopPropagation()},[T]),G=Jc.default.useState(h),K=G[0],z=G[1],$=Jc.default.useCallback(function(){z(!1)},[z]);return Jc.default.useEffect(function(){return function(){clearTimeout(p)}}),{props:{accessibilityRole:D,target:a,onDismiss:b,onShow:t.onShow,directionalHint:E,dismissBehaviors:S,doNotTakePointerCapture:_,setInitialFocus:P},innerView:{onMouseEnter:O,onMouseLeave:H,onKeyDown:V,onKeyUp:M,accessible:h,focusable:K,onBlur:$}}},n_e=function(t,r){if(t)return r?"leftTopEdge":"rightTopEdge"}});var PZ,_Z=f(()=>{"use strict";s();PZ="MenuCallout"});var RZ,v_,AZ=f(()=>{"use strict";s();k();RZ=I(L());Gv();Me();Me();_Z();v_=Nn(function(e){return function(t,r){var n=dt(e,t);return RZ.default.createElement(Yi,m({},n),r)}});v_.displayName=PZ});var kZ=f(()=>{"use strict";s();AZ()});var UN,DZ,hp,wZ=f(()=>{"use strict";s();k();UN=I(L()),DZ=I(ee());Me();HN();bZ();EZ();DN();kZ();hp=Cl(function(e,t){var r,n=e.directionalHint,o=e.gapSpace,a=e.maxHeight,d=e.maxWidth,c=e.minWidth,u=e.minPadding,l=e.borderWidth,p=e.borderColor,g=e.backgroundColor,h=BN(e),x=ma(),y=_i(),T=t(x),b=T[0],S=T[1];return y.hasMaxHeight=a!=null,y.minWidth=c??y.minWidth,r=$f(b,S,{directionalHint:n,gapSpace:o,maxHeight:a,maxWidth:d,minWidth:c,minPadding:u,borderWidth:l,borderColor:p,backgroundColor:g}),b=r[0],S=r[1],function(E,P){var _=dt(b,h.props,E),D=m(m({},h.innerView),{style:{maxHeight:_.maxHeight}}),O=UN.default.createElement(DZ.View,D,P);return UN.default.createElement(v_,m({tokens:b},_),O)}},TZ);hp.displayName=ix});var FZ=f(()=>{"use strict";s();wZ()});var ax,VN=f(()=>{"use strict";s();ax="MenuItem"});var OZ,NZ=f(()=>{"use strict";s();Ii();OZ=function(t){return{backgroundColor:t.colors.neutralBackground1,borderRadius:F.corner.radiusNone,checkmarkSize:16,color:t.colors.neutralForeground1,fontFamily:t.typography.families.primary,fontSize:F.font.size200,fontWeight:F.font.weight.regular,gap:F.size40,iconColor:t.colors.neutralForeground1,iconSize:16,minHeight:24,minWidth:128,maxWidth:300,padding:F.size40,paddingHorizontal:F.size80,submenuIndicatorColor:t.colors.neutralForeground1,submenuIndicatorPadding:F.size20,submenuIndicatorSize:16,pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,iconColor:t.colors.neutralForeground1Pressed,submenuIndicatorColor:t.colors.neutralForeground1Pressed},disabled:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForegroundDisabled,iconColor:t.colors.neutralForegroundDisabled,submenuIndicatorColor:t.colors.neutralForegroundDisabled},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,iconColor:t.colors.neutralForeground1Hover,submenuIndicatorColor:t.colors.neutralForeground1Hover}}}});var ZLt,o_e,MZ,LZ=f(()=>{"use strict";s();k();ZLt=I(ee());Me();On();VN();NZ();o_e=["hovered","focused","pressed","disabled"],MZ={tokens:[OZ,ax],states:o_e,slotProps:{root:lt(function(e,t){return{style:m(m({alignItems:"center",backgroundColor:e.backgroundColor,display:"flex",flexDirection:"row"},Mo.from(e,t)),Zo.from(e,t))}},w(w(["backgroundColor"],Zo.keys,!0),Mo.keys,!0)),checkmark:lt(function(e){return{style:{height:e.checkmarkSize,width:e.checkmarkSize,marginEnd:e.gap}}},["checkmarkSize","gap"]),content:lt(function(e,t){return{color:e.color,style:m({flexGrow:1},tn.from(e,t))}},w(["color"],tn.keys,!0)),iconPlaceholder:lt(function(e){return{style:{minHeight:e.iconSize,minWidth:e.iconSize,alignItems:"center",justifyContent:"center",marginEnd:e.gap}}},["checkmarkSize","gap"]),imgIcon:lt(function(e){return{style:{tintColor:e.iconColor,height:e.iconSize,width:e.iconSize}}},["gap","iconColor","iconSize"]),fontOrSvgIcon:lt(function(e){return{color:e.iconColor,size:e.iconSize}},["gap","iconColor","iconSize"]),submenuIndicator:lt(function(e){return{color:e.submenuIndicatorColor,height:e.submenuIndicatorSize,width:e.submenuIndicatorSize,viewBox:"0 0 ".concat(e.submenuIndicatorSize," ").concat(e.submenuIndicatorSize)}},["submenuIndicatorColor","submenuIndicatorPadding","submenuIndicatorSize"])}}});var Xi,dHt,jN,i_e,a_e,s_e,d_e,WN,x_,T_=f(()=>{"use strict";s();k();Xi=I(L()),dHt=I(ee());Dl();rx();jN=[],i_e=function(t){jN.push(t)},a_e=function(t){jN.filter(function(r){return r!==t})},s_e=["ios","macos"],d_e=["Home","End"],WN=function(t){var r,n,o=_i(),a=o.defaultChecked,d=o.onCheckedChange,c=o.checked,u=o.isSubmenu,l=o.setOpen,p=o.triggerRef,g=Xi.default.useMemo(function(){var G={};if(!c)return G;for(var K=0,z=c;K<z.length;K++){var $=z[K];G[$]=!0}return G},[c]),h=Xi.default.useState(function(){if(g)return g;for(var G=a??[],K={},z=0,$=G;z<$.length;z++){var q=$[z];K[q]=!0}return K}),x=h[0],y=h[1],T=typeof c<"u",b=T?g:x,S=Xi.default.useCallback(function(G,K,z){var $=m({},b);z?$[K]=!0:delete $[K],T||y($),d&&d(G,Object.keys($))},[T,b,d,y]),E=Xi.default.useCallback(function(G,K){for(var z={},$=0,q=Object.keys(b);$<q.length;$++){var re=q[$];jN.includes(re)||(z[re]=b[re])}z[K]=!0,T||y(z),d&&d(G,Object.keys(z))},[T,d,y,b]),P=Xi.default.useCallback(function(G){var K;u&&(l(G,!1,!1),(K=p==null?void 0:p.current)===null||K===void 0||K.focus())},[u,l,p]),_=Xi.default.useMemo(function(){return[]},[]),D=Xi.default.useCallback(function(G){return _.push(G)},[_]),O=Xi.default.useCallback(function(G){return _.splice(_.findIndex(function(K){return K.ref===G.ref}),1)},[_]),H=function(K){var z,$=K.nativeEvent.key;if(d_e.includes($)){var q=void 0,re=void 0;for($==="Home"?(q=1,re=0):$==="End"&&(q=-1,re=_.length-1);s_e.includes("win32")&&_[re].disabled;)re+=q;(z=_[re].ref.current)===null||z===void 0||z.focus()}};Xi.default.useEffect(function(){return function(){clearTimeout(o.triggerHoverOutTimer)}});var V=Xi.default.useRef(),M=function(){var K;(K=V==null?void 0:V.current)===null||K===void 0||K.focus()};return Xi.default.useEffect(function(){M()},[]),{props:m(m({},o),{onMouseLeave:o.onMouseLeave,onKeyDown:H}),isCheckedControlled:T,checked:b,onArrowClose:P,onCheckedChange:S,selectRadio:E,addRadioItem:i_e,removeRadioItem:a_e,trackMenuItem:D,untrackMenuItem:O,hasMaxHeight:(r=o.hasMaxHeight)!==null&&r!==void 0?r:!1,hasMaxWidth:(n=o.hasMaxWidth)!==null&&n!==void 0?n:!1,focusZoneRef:V}},x_=function(t,r){var n=pp(),o=n.trackMenuItem,a=n.untrackMenuItem,d=Xi.default.useMemo(function(){return{ref:t,disabled:r}},[t,r]);Xi.default.useEffect(function(){return o(d),function(){return a(d)}},[])}});function u_e(e,t){return t?m({disabled:e},t):{disabled:e}}var Zd,HZ,b_,zN,GN,c_e,qN,KN=f(()=>{"use strict";s();k();Zd=I(L()),HZ=I(ee());Me();Mn();Dl();rx();kN();T_();b_=[" ","Enter"],zN=w(["ArrowLeft","ArrowRight"],b_,!0),GN=function(t){var r=Zd.useRef(null),n=t.accessible,o=t.onClick,a=t.accessibilityState,d=t.componentRef,c=d===void 0?r:d,u=t.disabled,l=u===void 0?!1:u,p=t.persistOnClick,g=je(t,["accessible","onClick","accessibilityState","componentRef","disabled","persistOnClick"]),h=_i(),x=h.isSubmenu,y=h.persistOnItemClick,T=h.setOpen,b=pp(),S=b.hasCheckmarks,E=b.hasIcons,P=b.hasTooltips,_=b.onArrowClose,D=ZJ(),O=p??y,H=x&&D,V=Zd.useCallback(function(Te){var Oe,ke=HZ.I18nManager.isRTL,it=Zg(Te)&&(Te.nativeEvent.key==="ArrowLeft"||Te.nativeEvent.key==="ArrowRight"),_e=H&&Zg(Te)&&(ke&&Te.nativeEvent.key==="ArrowLeft"||!ke&&Te.nativeEvent.key==="ArrowRight");!l&&(!it||_e)&&((Oe=c==null?void 0:c.current)===null||Oe===void 0||Oe.blur(),o==null||o(Te)),!H&&!it&&!O&&T(Te,!1,!0);var ct=Zg(Te)&&(ke&&Te.nativeEvent.key==="ArrowRight"||!ke&&Te.nativeEvent.key==="ArrowLeft");ct&&(_==null||_(Te))},[c,l,H,_,o,T,O]),M=qd(m(m({},g),{onPress:V})),G=Ar(c),K=l?[]:x?zN:b_,z=Kd.apply(void 0,w([V],K,!1));qN(M.state.hovered,c);var $=Zd.useState(!M.state.hovered),q=$[0],re=$[1],ae=Zd.useCallback(function(Te){M.props.onHoverIn(Te),M.state.focused||re(!1)},[M]),ie=Zd.useCallback(function(Te){M.props.onFocus(Te),M.state.focused||re(!0)},[M]);return x_(c,l),{props:m(m(m({},M.props),{onHoverIn:ae,onFocus:ie,accessible:n??!0,accessibilityRole:"menuitem",onAccessibilityTap:t.onAccessibilityTap||V,accessibilityState:c_e(l,a),disabled:l,enableFocusRing:q,focusable:!0,ref:G}),z),state:m(m({},M.state),{hasSubmenu:H,hasIcons:E,hasCheckmarks:S,hasTooltips:P})}},c_e=Jt(u_e);qN=function(t,r){Zd.useLayoutEffect(function(){var n,o;t?(n=r==null?void 0:r.current)===null||n===void 0||n.focus():(o=r==null?void 0:r.current)===null||o===void 0||o.blur()},[t,r])}});var Zc,BZ,Th,l_e,YN,f_e,$N,QN=f(()=>{"use strict";s();k();Zc=I(ee());Me();rp();ga();BZ=I(Zf());LZ();VN();KN();Th=rn(m(m({displayName:ax},MZ),{slots:{root:Zc.Pressable,checkmark:Zc.View,content:Tr,iconPlaceholder:Zc.View,imgIcon:Zc.Image,fontOrSvgIcon:tp,submenuIndicator:BZ.SvgXml},useRender:function(t,r){var n=GN(t),o=r(t,function(a){return n.state[a]||t[a]});return function(a,d){var c=dt(n.props,a),u=c.accessibilityLabel,l=c.icon,p=c.tooltip,g=je(c,["accessibilityLabel","icon","tooltip"]),h=Zc.I18nManager.isRTL?"\n          <svg>\n          <path fill='currentColor' d=\"M10.2603 3.20041C10.5639 3.48226 10.5814 3.95681 10.2996 4.26034L6.77348 8L10.2996 11.7397C10.5814 12.0432 10.5639 12.5177 10.2603 12.7996C9.9568 13.0815 9.48226 13.0639 9.2004 12.7603L5.2004 8.51034C4.9332 8.22258 4.9332 7.77743 5.2004 7.48966L9.20041 3.23966C9.48226 2.93613 9.95681 2.91856 10.2603 3.20041Z\"/>\n          </svg>":"\n          <svg>\n          <path fill='currentColor' d=\"M5.73966 3.20041C5.43613 3.48226 5.41856 3.95681 5.70041 4.26034L9.22652 8L5.70041 11.7397C5.41856 12.0432 5.43613 12.5177 5.73967 12.7996C6.0432 13.0815 6.51775 13.0639 6.7996 12.7603L10.7996 8.51034C11.0668 8.22258 11.0668 7.77743 10.7996 7.48966L6.7996 3.23966C6.51775 2.93613 6.0432 2.91856 5.73966 3.20041Z\"/>\n          </svg>",x=YN(u,d[0]),y=$N(p,n.state.hasTooltips,d[0]);return Ae(o.root,m({},g,{accessibilityLabel:x}),n.state.hasCheckmarks&&Ae(o.checkmark,{accessible:!1}),(l||n.state.hasIcons)&&Ae(o.iconPlaceholder,{accessible:!1},l&&l.source&&Ae(o.imgIcon,m({accessible:!1},l)),l&&(l.svgSource||l.fontSource)&&Ae(o.fontOrSvgIcon,m({accessible:!1},l))),d&&Ae(o.content,m({accessible:!1,tooltip:y},y&&{alwaysShowToolTip:!0}),d),n.state.hasSubmenu&&Ae(o.submenuIndicator,{accessible:!1,xml:h}))}}})),l_e=function(t,r){if(t!==void 0)return t;if(typeof r=="string")return r},YN=Jt(l_e),f_e=function(t,r,n){if(t!==void 0)return t;if(r&&typeof n=="string")return n},$N=Jt(f_e)});var UZ=f(()=>{"use strict";s();QN()});var sx,XN=f(()=>{"use strict";s();sx="MenuItemCheckbox"});var VZ,jZ=f(()=>{"use strict";s();Ii();VZ=function(t){return{backgroundColor:t.colors.neutralBackground1,borderRadius:F.corner.radiusNone,checkmarkPadding:F.size20,checkmarkSize:16,checkmarkVisibility:0,color:t.colors.neutralForeground1,fontFamily:t.typography.families.primary,fontSize:F.font.size200,fontWeight:F.font.weight.regular,gap:F.size40,iconColor:t.colors.neutralForeground1,iconSize:16,minHeight:24,minWidth:160,maxWidth:300,padding:F.size40,paddingHorizontal:F.size80,pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,iconColor:t.colors.neutralForeground1Pressed,checked:{checkmarkColor:t.colors.neutralForeground1Pressed,checkmarkVisibility:1}},disabled:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForegroundDisabled,iconColor:t.colors.neutralForegroundDisabled,checked:{checkmarkColor:t.colors.neutralForegroundDisabled,checkmarkVisibility:1}},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,iconColor:t.colors.neutralForeground1Hover,checked:{checkmarkColor:t.colors.neutralForeground1Hover,checkmarkVisibility:1}},checked:{checkmarkColor:t.colors.neutralForeground1,checkmarkVisibility:1}}}});var jHt,p_e,WZ,zZ=f(()=>{"use strict";s();k();jHt=I(ee());Me();On();XN();jZ();p_e=["hovered","focused","pressed","disabled","checked"],WZ={tokens:[VZ,sx],states:p_e,slotProps:m(m({root:lt(function(e,t){return{style:m(m({alignItems:"center",backgroundColor:e.backgroundColor,display:"flex",flexDirection:"row"},Mo.from(e,t)),Zo.from(e,t))}},w(w(["backgroundColor"],Zo.keys,!0),Mo.keys,!0))},!1),{checkmark:lt(function(e){var t;return m({opacity:e.checkmarkVisibility,color:(t=e.checkmarkColor)!==null&&t!==void 0?t:e.color,height:e.checkmarkSize,width:e.checkmarkSize,viewBox:"0 0 "+(e.checkmarkSize-e.checkmarkPadding*2)+" "+(e.checkmarkSize-e.checkmarkPadding*2)},{style:{marginEnd:e.gap}})},["checkmarkPadding","checkmarkSize","checkmarkVisibility","color","gap"]),content:lt(function(e,t){return{style:m(m({flexGrow:1,color:e.color},!1),tn.from(e,t))}},w(["color"],tn.keys,!0)),iconPlaceholder:lt(function(e){return{style:{minHeight:e.iconSize,minWidth:e.iconSize,alignItems:"center",justifyContent:"center",marginEnd:e.gap}}},["checkmarkSize","gap"]),imgIcon:lt(function(e){return{style:{tintColor:e.iconColor,height:e.iconSize,width:e.iconSize}}},["gap","iconColor","iconSize"]),fontOrSvgIcon:lt(function(e){return{color:e.iconColor,size:e.iconSize}},["gap","iconColor","iconSize"])})}});function g_e(e,t,r){return r?m({disabled:e,checked:t},r):{disabled:e,checked:t}}var ec,qZ,GZ,JN,m_e,KZ,YZ=f(()=>{"use strict";s();k();ec=I(L()),qZ=I(ee());Me();Mn();Dl();rx();KN();T_();GZ=[{name:"Toggle"}],JN=function(t){var r,n=t.disabled,o=n===void 0?!1:n,a=t.name,d=pp(),c=(r=d.checked)===null||r===void 0?void 0:r[a],u=d.onCheckedChange,l=ec.useCallback(function(p){o||u(p,a,!c)},[c,o,a,u]);return KZ(t,l)},m_e=Jt(g_e);KZ=function(t,r){var n=ec.useRef(null),o=t.accessibilityActions,a=t.accessibilityLabel,d=t.accessibilityState,c=t.accessible,u=t.componentRef,l=u===void 0?n:u,p=t.disabled,g=p===void 0?!1:p,h=t.name,x=t.onAccessibilityAction,y=je(t,["accessibilityActions","accessibilityLabel","accessibilityState","accessible","componentRef","disabled","name","onAccessibilityAction"]),T=_i().isSubmenu,b=pp(),S=b.checked,E=b.hasIcons,P=b.hasTooltips,_=b.onArrowClose,D=S==null?void 0:S[h],O=ts(l,r),H=qd(m(m({},y),{onPress:O})),V=Ar(l),M=ec.useCallback(function(ke){var it=ke.nativeEvent.key===" "||ke.nativeEvent.key==="Enter";if(!g&&it){r(ke);return}var _e=qZ.I18nManager.isRTL,ct=T&&(_e&&ke.nativeEvent.key==="ArrowRight"||!_e&&ke.nativeEvent.key==="ArrowLeft");ct&&(_==null||_(ke))},[g,T,_,r]),G=g?[]:T?zN:b_,K=Kd.apply(void 0,w([M],G,!1)),z=o?w(w([],GZ,!0),o,!0):GZ,$=ec.useCallback(function(ke){g||(ke.nativeEvent.actionName==="Toggle"&&r(ke),x&&x(ke))},[g,r,x]);qN(H.state.hovered,l);var q=ec.useState(!H.state.hovered),re=q[0],ae=q[1],ie=ec.useCallback(function(ke){H.props.onHoverIn(ke),H.state.focused||ae(!1)},[H]),Te=ec.useCallback(function(ke){H.props.onFocus(ke),H.state.focused||ae(!0)},[H]);x_(l,g);var Oe=m(m({},H.state),{checked:D,disabled:g,hasIcons:E,hasTooltips:P});return{props:m(m(m({},H.props),{onHoverIn:ie,onFocus:Te,accessible:c??!0,accessibilityActions:z,accessibilityLabel:a,accessibilityRole:"menuitem",accessibilityState:m_e(g,Oe.checked,d),disabled:g,enableFocusRing:re,focusable:!0,onAccessibilityAction:$,ref:V}),K),state:Oe}}});var bh,$Z,S_,h_e,QZ=f(()=>{"use strict";s();k();bh=I(ee());Me();rp();ga();$Z=I(Zf());zZ();XN();YZ();QN();S_=rn(m(m({displayName:sx},WZ),{slots:m(m({root:bh.Pressable},!1),{checkmark:$Z.SvgXml,content:Tr,iconPlaceholder:bh.View,imgIcon:bh.Image,fontOrSvgIcon:tp}),useRender:function(t,r){var n=JN(t),o=r(t,function(a){return n.state[a]||t[a]});return h_e(n,o)}})),h_e=function(t,r){return function(n,o){var a=dt(t.props,n),d=a.accessibilityLabel,c=a.icon,u=a.tooltip,l=je(a,["accessibilityLabel","icon","tooltip"]),p="\n    <svg>\n      <path fill='currentColor' d='M9.85355 3.14645C10.0488 3.34171 10.0488 3.65829 9.85355 3.85355L5.35355 8.35355C5.15829 8.54882 4.84171 8.54882 4.64645 8.35355L2.64645 6.35355C2.45118 6.15829 2.45118 5.84171 2.64645 5.64645C2.84171 5.45118 3.15829 5.45118 3.35355 5.64645L5 7.29289L9.14645 3.14645C9.34171 2.95118 9.65829 2.95118 9.85355 3.14645Z' />\n    </svg>",g="\n    <svg>\n      <path fill='currentColor' d='M9.76497 3.20474C10.0661 3.48915 10.0797 3.96383 9.79526 4.26497L5.54526 8.76497C5.40613 8.91228 5.21332 8.99703 5.01071 8.99993C4.8081 9.00282 4.61295 8.92361 4.46967 8.78033L2.21967 6.53033C1.92678 6.23744 1.92678 5.76257 2.21967 5.46967C2.51256 5.17678 2.98744 5.17678 3.28033 5.46967L4.98463 7.17397L8.70474 3.23503C8.98915 2.9339 9.46383 2.92033 9.76497 3.20474Z' />\n    </svg>",h=YN(d,o[0]),x=$N(u,t.state.hasTooltips,o[0]);return Ae(r.root,m({},l,{accessibilityLabel:h}),Ae(r.checkmark,{accessible:!1,xml:p}),(c||t.state.hasIcons)&&Ae(r.iconPlaceholder,{accessible:!1},c&&c.source&&Ae(r.imgIcon,m({accessible:!1},c)),c&&(c.svgSource||c.fontSource)&&Ae(r.fontOrSvgIcon,m({accessible:!1},c))),o&&Ae(r.content,m({accessible:!1,tooltip:x},x&&{alwaysShowToolTip:!0}),o))}}});var XZ=f(()=>{"use strict";s();QZ()});var dx,ZN=f(()=>{"use strict";s();dx="MenuList"});var JZ,ZZ=f(()=>{"use strict";s();Ii();JZ=function(t){return{paddingVertical:F.size40,minWidth:128,maxWidth:300,backgroundColor:t.colors.neutralBackground1,hasMaxHeight:{minWidth:140}}}});var PBt,y_e,eee,tee=f(()=>{"use strict";s();k();PBt=I(ee());Me();On();ZN();ZZ();y_e=["hasMaxHeight"],eee={tokens:[JZ,dx],states:y_e,slotProps:{root:lt(function(e,t){return{style:m(m({backgroundColor:e.backgroundColor,display:"flex"},Mo.from(e,t)),!1),gap:e.gap}},w(["backgroundColor","gap"],Mo.keys,!0))}}});var eM,ree=f(()=>{"use strict";s();k();eM=function(t){return m({hasCheckmarks:t.props.hasCheckmarks,hasIcons:t.props.hasIcons,hasTooltips:t.props.hasTooltips},t)}});var Zs,I_,iee,nee,oee,C_e,v_e,Sh,aee=f(()=>{"use strict";s();k();Zs=I(L()),I_=I(ee());ap();Me();tee();ZN();T_();ree();rx();iee=Nn(function(e){var t=e.gap,r=je(e,["gap"]);return function(n,o){return t&&t>0&&o&&(o=Zs.default.Children.map(o,function(a,d){return Zs.default.isValidElement(a)&&d>0?Zs.default.cloneElement(a,dt(a.props,{style:{marginTop:t}})):a})),Ae(I_.View,m({},dt(r,n)),o)}});iee.displayName="MenuStack";nee=["macos","win32"].includes("win32"),oee=!1,C_e=!0,v_e=function(t,r,n){return r[t]||n[t]||t==="hasMaxHeight"},Sh=rn(m(m({displayName:dx},eee),{slots:{root:iee,scrollView:I_.ScrollView,focusZone:nee?os:Zs.default.Fragment},useRender:function(t,r){var n=WN(t),o=eM(n),a=r(n.props,function(d){return v_e(d,n,t)});return function(d,c){var u=Zs.default.Children.toArray(c).filter(function(y){return Zs.default.isValidElement(y)&&y.type.displayName!=="MenuDivider"}).length,l=0,p=Zs.default.Children.toArray(c).map(function(y){var T,b;return Zs.default.isValidElement(y)?(y.type.displayName!=="MenuDivider"&&l++,Zs.default.cloneElement(y,m({accessibilityPositionInSet:(T=y.props.accessibilityPositionInSet)!==null&&T!==void 0?T:l,accessibilitySetSize:(b=y.props.accessibilitySetSize)!==null&&b!==void 0?b:u},y.props.tooltip&&{alwaysShowToolTip:!0}))):y}),g=n.hasMaxHeight||n.hasMaxWidth,h=g?a.scrollView:Zs.default.Fragment,x=Ae(a.root,null,Ae(h,m({},g&&{showsVerticalScrollIndicator:n.hasMaxHeight,showsHorizontalScrollIndicator:n.hasMaxWidth}),Ae(a.focusZone,m({},nee&&{componentRef:oee,focusZoneDirection:"vertical",defaultTabbableElement:oee,enableFocusRing:!1,isCircularNavigation:C_e,tabKeyNavigation:"Normal"}),p)));return Ae(QJ,{value:o},x)}}}))});var see=f(()=>{"use strict";s();aee()});var cx,tM=f(()=>{"use strict";s();cx="MenuDivider"});var dee,cee=f(()=>{"use strict";s();Ii();dee=function(t){return{backgroundColor:t.colors.neutralStroke1,height:F.stroke.width10,margin:F.size20}}});var n3t,uee,lee=f(()=>{"use strict";s();k();n3t=I(ee());Me();tM();cee();uee={tokens:[dee,cx],tokensThatAreAlsoProps:["insetSize"],slotProps:{root:lt(function(e){return{style:m({height:e.height,width:e.width,backgroundColor:e.backgroundColor,margin:e.margin,marginVertical:e.marginVertical,display:"flex"},!1)}},["backgroundColor","height","margin","marginVertical","width"])}}});var fee,Ih,pee=f(()=>{"use strict";s();k();fee=I(ee());Me();lee();tM();Ih=rn(m(m({displayName:cx},uee),{slots:{root:fee.View},useRender:function(t,r){var n=r(t);return function(o){return Ae(n.root,m({},o))}}}))});var mee=f(()=>{"use strict";s();pee()});var rM,gee=f(()=>{"use strict";s();rM="MenuGroup"});var yp,yee,hee,E_,Cee=f(()=>{"use strict";s();k();yp=I(L()),yee=I(ee());ap();Me();gee();hee=["win32"].includes("win32"),E_=rn({displayName:rM,slots:{root:yee.View,contentWrapper:hee?os:yp.default.Fragment},useRender:function(t,r){var n=r(t);return function(o,a){var d=je(dt(t,o),[]),c=0,u=yp.default.Children.toArray(a).map(function(l){var p,g;if(yp.default.isValidElement(l)){var h=yp.default.Children.toArray(a).filter(function(x){return yp.default.isValidElement(x)&&x.type.displayName!=="MenuGroupHeader"&&x.type.displayName!=="MenuDivider"}).length;return l.type.displayName!=="MenuGroupHeader"&&l.type.displayName!=="MenuDivider"&&c++,yp.default.cloneElement(l,{accessibilityPositionInSet:(p=l.props.accessibilityPositionInSet)!==null&&p!==void 0?p:c,accessibilitySetSize:(g=l.props.accessibilitySetSize)!==null&&g!==void 0?g:h})}return l});return Ae(n.root,m({},d),Ae(n.contentWrapper,m({},hee&&{focusZoneDirection:"vertical",enableFocusRing:!1,navigateAtEnd:"NavigateContinue"}),u))}}})});var vee=f(()=>{"use strict";s();Cee()});var ux,nM=f(()=>{"use strict";s();ux="MenuGroupHeader"});var xee,Tee=f(()=>{"use strict";s();Ii();xee=function(t){return{color:t.colors.neutralForeground2,fontFamily:t.typography.families.primary,fontSize:F.font.size300,fontWeight:F.font.weight.regular,gap:F.size40,padding:F.size60}}});var bee,See=f(()=>{"use strict";s();k();Me();Me();nM();Tee();bee={tokens:[xee,ux],slotProps:{root:lt(function(e,t){return{color:e.color,style:m({marginStart:e.gap},tn.from(e,t))}},["color"])}}});var P_,Iee=f(()=>{"use strict";s();k();Me();ga();See();nM();P_=rn(m(m({displayName:ux},bee),{slots:{root:Tr},useRender:function(t,r){var n=r(t);return function(o,a){var d=je(dt(t,o),[]);return Ae(n.root,m({accessible:t.accessible},d),a)}}}))});var Eee=f(()=>{"use strict";s();Iee()});var __=f(()=>{"use strict";s();uZ();xZ();FZ();UZ();XZ();see();mee();vee();Eee()});var wl,lx=f(()=>{"use strict";s();wl=function(){return!0}});var kr,Pee=f(()=>{"use strict";s();rt();Z();kr=function(){function e(t){var r=this;this.compile=et(function(){var n={};r.color&&(n.color="0xff".concat(r.color.substr(1))),r.isColorEnabled!==void 0&&(n.isColorEnabled=String(r.isColorEnabled));var o=Object.entries(n).map(function(a){return a.join("=")}).join("&");return{uri:"ms-namex-icon:".concat(r.namex).concat(o?"?".concat(o):""),width:r.width,height:r.height}}),typeof t=="string"?this.namex=t:(this.namex=t.namex,this.isColorEnabled=t.isColorEnabled,this.color=t.color,this.width=t.width,this.height=t.height)}return e.prototype.withSize=function(t,r){var n=new e(this);return n.width=t,n.height=r??t,n},e.prototype.withColorEnabled=function(t){var r=new e(this);return r.isColorEnabled=t,r},e.prototype.withColor=function(t){if(!/^#[0-9a-f]{6}$/i.test(t))return v().assertConditionTag(!1,"Invalid icon color provided: ".concat(t),579606091),this;var r=new e(this);return r.color=t,r},e}()});var _ee,Ree=f(()=>{"use strict";s();rt();ue();Pee();ym();_ee=et(function(){var e=new kr("Send").withSize(16),t=new kr("CancelCommentSession").withSize(16),r=new kr("MoreCommentThreadActions").withSize(16),n=new kr("TrashCan").withSize(16),o=new kr("EditGeneric").withSize(16),a=new kr("ReopenComment").withSize(16),d=new kr("Checkmark").withSize(10),c=d.withColor(Pe.WHITE),u=d.withSize(14),l=d.withSize(16),p=Ky()?new kr("NewComment").withSize(16).withColorEnabled(!0):new kr("NewComment").withSize(16),g=Ky()?new kr("NewCommentRTL").withSize(16).withColorEnabled(!0):new kr("NewCommentRTL").withSize(16),h=new kr("NewComment").withSize(16),x=new kr("NewCommentRTL").withSize(16),y=new kr("TaskAssign").withSize(16),T=y.withColor(Pe.WHITE),b=new kr("TaskReopen").withSize(16),S=b.withColor(Pe.WHITE),E=l.withColor(Pe.WHITE),P=new kr("CommentError").withSize(16),_=P.withColor(Pe.WHITE),D=new kr("CommentInfo").withSize(16),O=D.withColor(Pe.WHITE),H=new kr("TaskEdit").withSize(16),V=H.withColor(Pe.WHITE),M=new kr("TaskAssignDropdown").withSize(16),G=M.withColor(Pe.WHITE),K=new kr("CopyLinkToClipboard").withSize(16),z=new kr("CommentLikeSolid").withSize(16).withColorEnabled(!0),$=z.withColor(Pe.WHITE),q=new kr("CommentLikeEmpty").withSize(16),re=q.withColor(Pe.WHITE),ae=new kr("CommentFilter").withSize(16),ie=ae.withColor(Pe.WHITE),Te=new kr("CommentDeleteFilter").withSize(16).withColorEnabled(!0),Oe=Te.withColor(Pe.WHITE),ke=new kr("CommentDeleteFilter").withSize(16).withColor(Pe.GRAY_100),it=ke.withColor(Pe.GRAY_100);return{send:{standard:e.compile(),directional:!0},cancel:{standard:t.compile(),directional:!1},ellipses:{standard:r.compile(),directional:!1},leftChevron:{standard:0,directional:!0},rightChevron:{standard:0,directional:!0},closePaneLargeDisplay:{standard:t.compile(),directional:!1},closePaneSmallDisplay:{standard:t.compile(),directional:!1},deleteCommandBar:{standard:n.compile(),directional:!1},delete:{standard:n.compile(),directional:!1},edit:{standard:o.compile(),directional:!0},unlock:{standard:a.compile(),directional:!0},checkmarkTopper:{standard:d.compile(),dark:c.compile(),directional:!0},checkmark:{standard:d.compile(),directional:!0},cancelFluent:{standard:t.compile(),directional:!1},sendFluentForAppColor:{standard:e.compile(),directional:!0},sendFluentDisabledForAppColor:{standard:e.compile(),directional:!0},newComment:{standard:p.compile(),directional:!1},newCommentDisabled:{standard:h.compile(),directional:!1},newCommentRTL:{standard:g.compile(),directional:!1},newCommentRTLDisabled:{standard:x.compile(),directional:!1},taskAssign:{standard:y.compile(),dark:T.compile(),directional:!0},reopenThread:{standard:b.compile(),directional:!0},taskReopen:{standard:b.compile(),dark:S.compile(),directional:!0},taskComplete:{standard:l.compile(),dark:E.compile(),directional:!0},error:{standard:P.compile(),dark:_.compile(),directional:!1},taskEdit:{standard:H.compile(),dark:V.compile(),directional:!0},assignerDropdown:{standard:M.compile(),dark:G.compile(),directional:!1},save:{standard:u.compile(),directional:!0},info:{standard:D.compile(),dark:O.compile(),directional:!1},linkToComment:{standard:K.compile(),directional:!1},likeSolid:{standard:z.compile(),dark:$.compile(),directional:!1},likeEmpty:{standard:q.compile(),dark:re.compile(),directional:!1},filter:{standard:ae.compile(),dark:ie.compile(),directional:!1},deleteFilter:{standard:Te.compile(),dark:Oe.compile(),directional:!1},deleteFilterDefault:{standard:ke.compile(),dark:it.compile(),directional:!1}}})});function Aee(e,t){var r=_ee()[e],n=r[t],o;return n?o=n:r.dark&&x_e(t)?o=r.dark:o=r.standard,{source:o,directional:r.directional}}function x_e(e){return e===5||e===4}function T_e(e){return Aee("cancel",e)}function Eh(e){var t=va(e);return t||(v().assertConditionTag(!1,"Missing icon ".concat(e.icon),595646157),T_e(e.themeId))}function va(e){if(e.icon!==0){var t=S_e(e);if(t!==void 0)return Aee(t,e.themeId)}}function S_e(e){var t=le()?b_e:kee,r=t[e.icon];if(r!==void 0)return typeof r=="function"?r(e):r}function I_e(e){return e.disabled?"sendFluentDisabledForAppColor":"sendFluentForAppColor"}function E_e(e){return e.renderTarget==="Pane"?"deleteCommandBar":"delete"}function P_e(e){return Ky()&&e.disabled?oM.I18nManager.isRTL?"newCommentRTLDisabled":"newCommentDisabled":oM.I18nManager.isRTL?"newCommentRTL":"newComment"}var oM,tc,zr,kee,b_e,rc=f(()=>{"use strict";s();k();Z();oM=I(ee());ue();Ld();Ree();fn();kee=(tc={},tc[1]="cancel",tc[2]="send",tc[7]="ellipses",tc[10]="leftChevron",tc[11]="rightChevron",tc[9]=function(){return xl()===Xt.LargeDisplay?"closePaneLargeDisplay":"closePaneSmallDisplay"},tc[12]=P_e,tc[24]="send",tc),b_e=m(m({},kee),(zr={},zr[1]="cancelFluent",zr[2]=I_e,zr[3]=E_e,zr[4]="unlock",zr[5]="checkmark",zr[20]="checkmarkTopper",zr[6]="edit",zr[13]="taskAssign",zr[14]="taskAssign",zr[16]="reopenThread",zr[21]="taskReopen",zr[15]="taskComplete",zr[19]="error",zr[17]="taskEdit",zr[8]="assignerDropdown",zr[24]="save",zr[26]="info",zr[25]="linkToComment",zr[23]="likeSolid",zr[22]="likeEmpty",zr[27]="filter",zr[28]="deleteFilter",zr[29]="deleteFilterDefault",zr))});var k4t,Dee,wee,D4t,w4t,Fee,Oee=f(()=>{"use strict";s();_r();ze();k4t=Ce({alignItems:"center",justifyContent:"center"}),Dee=Ce({alignItems:"stretch"}),wee=Ce({transform:[{scaleX:-1}]}),D4t=new R([R.always(function(e){return{tintColor:e.palette.IconButtonDisabledTint}})]),w4t=new R([R.always(function(e){return{tintColor:e.palette.IconButtonFocusedTint}})]),Fee=Ce({opacity:0})});var Cp,Nee,Tn,R_e,A_e,R_=f(()=>{"use strict";s();k();Js();__();Lt();Cp=I(L()),Nee=I(ee());Yc();lx();Vr();rc();ze();xr();pr();Oee();Tn=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.refManager=new tf,r.focus=r.refManager.focus,r.blur=r.refManager.blur,r.getFocusState=r.refManager.getFocusState,r.getChildNodes=r.refManager.getChildNodes,r.addChildNode=r.refManager.addChildNode,r.getDescendantById=r.refManager.getDescendantById,r.getId=r.refManager.getId,r.getData=r.refManager.getData,r.isTabbable=r.refManager.isTabbable,r.getNextTabTarget=r.refManager.getNextTabTarget,r.getIterator=r.refManager.getIterator,r.renderWithTheme=function(n){var o=Eh({icon:r.props.icon,disabled:r.disabled,renderTarget:"Pane",themeId:n.themeId}),a=o.directional&&Nee.I18nManager.isRTL?wee:void 0,d=r.props.onClick,c=Cs(r.props.preventDefaultKeyDownBehavior,we.Capturing),u=r.props.visibility!=="hidden",l=!r.disabled&&u,p=Cp.createElement(A_e,{accessibilityLabel:r.props.accessibilityLabel,accessibilityHint:r.props.accessibilityHint,accessibilityActions:r.props.accessibilityActions,onAccessibilityAction:r.props.onAccessibilityAction,accessibilityState:r.props.accessibilityState,iconOnly:!r.props.text,icon:{rasterImageSource:{src:o.source}},disabled:r.disabled,tooltip:u?r.props.tooltipText:void 0,focusable:l,testID:r.props.testID,style:[r.props.text?U0:vr],onClick:typeof d=="function"&&u?d:void 0,onFocus:r.props.onFocus,onBlur:r.props.onBlur,onFocusStateChange:r.props.onFocusStateChange,nodeId:r.props.nodeId,nodeData:r.props.nodeData,isTabbable:r.props.isTabbable&&l,accessible:u,preventDefaultKeyDownBehavior:void 0,appearance:r.props.appearance,block:!0,componentRef:r.refManager.ref},r.props.text||null),g=r.props.menuProps&&u?Cp.createElement(nx,m({},r.props.menuProps.props),Cp.createElement(ox,null,p),r.props.menuProps.menu):p;return Cp.createElement(J,{style:[Dee,r.props.style,a,r.props.visibility==="hidden"?Fee:void 0],accessible:!1,focusable:!1,onMouseEnter:r.props.onMouseEnter,onMouseLeave:r.props.onMouseLeave,keyDownEvents:c,onStartShouldSetResponder:wl},g)},r.render=function(){return Ye(r.renderWithTheme,Ze)},r}return Object.defineProperty(t.prototype,"disabled",{get:function(){return!!this.props.disabled},enumerable:!1,configurable:!0}),t}(Cp.PureComponent),R_e=op.customize({small:{hasContent:{minHeight:void 0,minWidth:void 0,variant:"secondaryStandard"}}}),A_e=Ws(R_e)});var Ph=f(()=>{"use strict";s();R_()});var Mee,Lee=f(()=>{"use strict";s();_r();Mee=new R([R.always({flex:0,borderWidth:0,marginTop:1,height:28,width:28})])});var fx,iM,Hee=f(()=>{"use strict";s();fx=I(L());PN();fn();Ph();Lee();iM=fx.default.memo(function(t){var r=t.actions.map(function(n,o){return fx.default.createElement(Tn,{key:o,icon:n.icon,onClick:n.onClick,accessibilityLabel:n.accessibilityLabel,tooltipText:g_(n),disabled:n.disabled,testID:n.id,nodeId:n.id||"",isTabbable:n.isTabbable,text:"",appearance:"subtle",style:Mee.render(Kr(t.renderContextType)),preventDefaultKeyDownBehavior:t.preventDefaultKeyDownBehavior})});return fx.default.createElement(fx.default.Fragment,null,r)});iM.displayName="ResolvedCardButtons"});var Bee,Uee,Vee,jee=f(()=>{"use strict";s();Bee=I(dn());ze();Uee=Bee.StyleSheet.createViewStyle({marginLeft:10}),Vee=Ce({paddingLeft:9})});var _h,A_,aM,Wee=f(()=>{"use strict";s();_h=I(L()),A_=I(ee());rc();So();fn();xr();xn();jee();aM=_h.default.memo(function(t){return _h.default.createElement(Ze.Consumer,null,function(r){var n=va({icon:20,themeId:r.themeId,renderTarget:"Pane"});return _h.default.createElement(A_.View,{key:"text",style:[K0.render(Kr(t.renderContextType)),Vee]},n&&_h.default.createElement(A_.Image,{source:n.source}),_h.default.createElement(Ve,{style:Uee,numberOfLines:1,variantFluent:"secondarySemibold",accessible:!1},t.taskCompleter?t.localizationAPI.getStringOrUndefined(202):t.localizationAPI.getStringOrUndefined(197)))})});aM.displayName="ResolvedCardLabel"});function k_(e){return le()&&(e.postDisplayMode===Ue.Normal||e.postDisplayMode===Ue.Resolved)&&e.isNew}var sM=f(()=>{"use strict";s();ue();gl()});var ed,dM,zee,Gee,qee,Kee=f(()=>{"use strict";s();k();te();rt();Z();ed=I(L());hn();ue();Od();bf();Av();tY();AJ();s_();YJ();Hee();Wee();sM();mi();Er();dM=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.getNewCandidateTaskAssignees=et(function(a,d){var c=U6(a);return d&&vS(c,d),c}),o.onEditorFocus=function(){(o.isActiveDraft()||o.isActiveReply())&&!o.isSelectionWithinCard()&&(v().assertConditionTag(nt(),"Should have selection in card with draft if NewSelectionInteractions off",572844239),o.props.onCardSelect(o))},o.notifyRenderedOnce=zn(function(){o.props.onCardRendered&&o.props.onCardRendered(o.props)}),o.toggleExpansion=function(){o.props.cardCollapsedState===At.Collapsed?o.props.onCardSelectExpand(o,!0,!1):o.props.onCardCollapse(o)},o.renderExpandButton=function(a){var d=ed.Children.count(o.props.children),c=o.props.displayMode===xe.Resolved;if(!(o.props.cardCollapsedState===At.Expanded||d<=1||(!c||!le())&&d<=2)){var u=!1;if(le()&&o.props.children)for(var l=1;l<d;++l){var p=o.props.children[l];if(u||l===d-1&&!c)break;var g=p.props;u=!!p.props.postDisplayMode&&k_(g)}var h=o.props.componentTreeId.renderContextType;return ed.createElement(m_,m({id:tW({id:o.props.id,renderContextType:h}),innerText:Tj(o.props.localizationAPI,d,c)||"",isCardResolved:c,isTabbable:o.props.isTabbable,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,renderContextType:h,restrictControl_deprecated:!!o.props.restrictActionControls_deprecated,key:"expandButton",unreadPostHidden:u},a))}},o.logCardRenderedOnce=zn(function(){var a,d;(d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(zee||(zee=qt(["CommentCardRendered"],["CommentCardRendered"]))),C.reserveTag(524100999),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary),Gr("RenderContextType",o.props.componentTreeId.renderContextType,N.SystemMetadata),Gr("CardDisplayMode",o.props.displayMode,N.SystemMetadata))}),o.getId=o.getId.bind(o),o.onTaskAssigneeUpdated=o.onTaskAssigneeUpdated.bind(o),o.onCardFocus=o.onCardFocus.bind(o),o}return t.prototype.componentDidMount=function(){var r,n;this.props.onCardMounted(this.props),this.isActiveDraft()&&((n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call(r,Mt(Gee||(Gee=qt(["DraftCardMount"],["DraftCardMount"]))),C.reserveTag(556827602),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary),Gr("RenderContextType",this.props.componentTreeId.renderContextType,N.SystemMetadata),Gr("CardDisplayMode",this.props.displayMode,N.SystemMetadata)))},t.prototype.componentWillUnmount=function(){var r,n;this.isActiveDraft()&&((n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call(r,Mt(qee||(qee=qt(["DraftCardUnmount"],["DraftCardUnmount"]))),C.reserveTag(556827603),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary),Gr("RenderContextType",this.props.componentTreeId.renderContextType,N.SystemMetadata),Gr("CardDisplayMode",this.props.displayMode,N.SystemMetadata)))},t.prototype.getId=function(){return this.props.id},t.prototype.isActiveReply=function(){return this.props.displayMode===xe.Reply||this.props.displayMode===xe.ReplyPreCommitPending},t.prototype.isActiveDraft=function(){return this.props.displayMode===xe.Draft||this.props.displayMode===xe.DraftPreCommitPending},t.prototype.onTaskAssigneeUpdated=function(r){this.props.onSelectedTaskAssigneeUpdated(r)},t.prototype.getTaskAssignerProps=function(){var r;if(this.props.supportsTaskCreation){var n=this.isActiveReply()&&!this.props.taskTopperProps;if(!(n&&!gd())&&this.props.currentMentionees){var o=n||this.isActiveDraft(),a=Ej(this.props.localizationAPI,o),d=this.getNewCandidateTaskAssignees(this.props.currentMentionees,(r=this.props.taskTopperProps)===null||r===void 0?void 0:r.assignees),c=this.props.localizationAPI.getString(128);if(d&&Object.keys(d).length!==0)return{renderContextType:this.props.componentTreeId.renderContextType,id:this.props.id,label:a,candidateAssignees:d,isNewThread:this.isActiveDraft(),selectedAssignee:this.props.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:c,assignerTooltip:this.props.localizationAPI.getString(182),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,isTaskThread:!!this.props.taskTopperProps}}}},t.prototype.isSelectionWithinCard=function(){return this.props.selected||this.props.hasSelectedChild},t.prototype.renderDraftBoxMessage=function(r){if(!Pn())return null;var n=this.props.draftWarningState;return!n&&!r?null:ed.createElement(fp,{key:"draftBoxMessage",draftWarningState:n,localizationAPI:this.props.localizationAPI,target:Ud.Card,id:n?Gm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):qm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:r})},t.prototype.onCardSaveDraft=function(r){r&&this.props.draftId&&this.props.onSaveDraft(this.getId(),r)},t.prototype.renderResolvedOrTaskTopperHelper=function(r){var n=this.props.taskTopperProps,o=r.resolvedButtonsProps,a=r.preventDefaultKeyDownBehavior;if(!(!o&&!n)){var d=this.props.componentTreeId.renderContextType,c=o&&o.length>0?ed.createElement(iM,{actions:o,renderContextType:d,preventDefaultKeyDownBehavior:a}):void 0,u=n&&this.props.displayMode!==xe.Resolved?ed.createElement(RJ,m({},n,{taskTopperCheckboxRef:r.taskTopperCheckboxRef})):ed.createElement(aM,{localizationAPI:this.props.localizationAPI,renderContextType:d,taskCompleter:n!=null&&n.assignees&&n.assignees.length>0?n.assignees[0]:void 0});return ed.createElement(eY,m({leftElement:u,rightElement:c,preventDefaultKeyDownBehavior:r.preventDefaultKeyDownBehavior},r.cardTopperContainerProps))}},t.prototype.onCardFocus=function(r){this.props.onCardFocus(this)},t.prototype.logCardRendered=function(){this.props.displayMode!==xe.Loading&&this.logCardRenderedOnce()},t.DisplayName="CommentCard",t}(ed.PureComponent)});var Yee,$ee,Qee,Xee,Jee,Zee,ete,tte,rte,nte=f(()=>{"use strict";s();Ld();Be();So();_r();ze();Yee=1,$ee=new R([R.rule({isFluentEnabled:!0},{paddingTop:7,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start",paddingRight:Rr}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{marginLeft:Yg}),R.rule({platform:"android"},{top:-16,zIndex:99}),R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{paddingTop:Kg,paddingBottom:Kg,paddingLeft:Wd,paddingRight:Wd}),R.rule({isFluentEnabled:!1},{padding:Rr,position:"absolute",right:0,flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start"})]),Qee=new R([R.rule({platform:"android"},{marginTop:16,marginLeft:4}),R.rule({platform:"win32"},{alignSelf:"flex-start",marginTop:6,marginRight:4})]),Xee=new R([R.rule({platform:"android"},{marginTop:16,marginLeft:8})]),Jee=new kt([kt.always({marginLeft:2})]),Zee=new kt([kt.rule({isFluentEnabled:!0},{marginTop:4,marginLeft:Rr-4})]),ete=Ce({paddingTop:4}),tte=new R([R.always(function(e){return{borderBottomWidth:1,borderColor:e.palette.CardBorder}})]),rte=new R([R.rule({isFluentEnabled:!0},{flexDirection:"row",flex:1,justifyContent:"flex-start",alignItems:"flex-start"})])});var F_e,O_e,N_e,M_e,cM,D_,uM,Rh,ote,ite,ate,ste,dte,cte,ute,lte,w_,F_,O_,fte,N_,pte,mte,gte,px=f(()=>{"use strict";s();k();Ld();Be();So();_r();ze();F_e=56,O_e="rgba(0,0,0,0.1)",N_e=36,M_e=3,cM=64,D_=new R(w([R.always({alignItems:"flex-start",flex:-1,flexDirection:"row"}),R.rule({isFluentEnabled:!1},function(e){return{paddingLeft:Rr,paddingTop:Rr,paddingBottom:Rr,backgroundColor:e.palette.CardBackground}}),R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{paddingLeft:Wd,paddingTop:Kg,paddingBottom:Kg})],j(q0),!1)),uM=new R([R.always({flexDirection:"row",alignItems:"flex-start",alignSelf:"stretch",paddingRight:Rr-6,paddingBottom:1})]),Rh=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),ote=new R([R.rule({isFluentEnabled:!1},{marginRight:Rr,minHeight:W0,marginTop:z0}),R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{marginRight:Wd}),R.rule({isFluentEnabled:!0},{marginRight:Rr})]),ite=new R([R.always({marginRight:3,marginBottom:3})]),ate=Ce({overflow:"hidden"}),ste=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.CardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Jf(e.palette.CardBackground,"CC"),offset:0},{color:Jf(e.palette.CardBackground,"00"),offset:1}]}}})]),dte=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.CardHoveredBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardHoveredBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Jf(e.palette.CardHoveredBackground,"CC"),offset:0},{color:Jf(e.palette.CardHoveredBackground,"00"),offset:1}]}}})]),cte=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.ResolvedCardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.ResolvedCardBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Jf(e.palette.ResolvedCardBackground,"CC"),offset:0},{color:Jf(e.palette.ResolvedCardBackground,"00"),offset:1}]}}})]),ute=new R([R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{marginTop:32,marginBottom:32}),R.rule({platform:"win32"},{minHeight:N_e,alignItems:"flex-end"}),R.rule({platform:"android"},{flexWrap:"wrap"})]),lte=new R([R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{paddingLeft:32,paddingRight:32})]),w_=new kt([kt.rule({isFluentEnabled:!0},{flex:1,marginTop:3,marginRight:4}),kt.rule({isFluentEnabled:!1},{marginRight:Rr+F_e,alignSelf:"flex-start"})]),F_=new R(w(w([R.rule({isFluentEnabled:!1},function(e){return{borderTopWidth:1,borderColor:e.palette.CardReplyTopBorder}})],j(kv),!1),[R.rule({isFluentEnabled:!0},{marginTop:G0,marginBottom:G0+M_e,paddingTop:1})],!1)),O_=new R([R.always({flexDirection:"column",alignItems:"stretch",flex:1})]),fte=Ce({paddingBottom:0}),N_=new R([R.always({flex:1,flexDirection:"column",alignItems:"stretch"}),R.rule({isFluentEnabled:!1},{marginLeft:qg}),R.rule({isFluentEnabled:!0},{paddingLeft:9})]),pte=Ce({paddingRight:10}),mte=Ce({paddingLeft:13}),gte=new R([R.always({flex:1,alignItems:"center",justifyContent:"center",position:"absolute",backgroundColor:O_e,width:"100%",height:"100%"}),R.rule({platform:"android"},{zIndex:100})])});function hte(e,t){switch(e){case Ni.Like:return t?23:22}}function yte(e,t,r){switch(e){case Ni.Like:return t===1?r.getString(263):t>1?r.formatString(264,t.toString()):(v().assertConditionTag(t===0,"Negative reaction count recevied.",509747411),r.getString(231))}}function Cte(e,t){var r;switch(e){case Ni.Like:return!!(!((r=t.Like)===null||r===void 0)&&r.currentUserReacted)}}function vte(e,t){var r,n;switch(e){case Ni.Like:return(n=(r=t.Like)===null||r===void 0?void 0:r.count)!==null&&n!==void 0?n:0}}var xte=f(()=>{"use strict";s();Z();Dc();hn()});function Tte(){return M_.useContext(mx)}var M_,mx,L_=f(()=>{"use strict";s();M_=I(L()),mx=M_.createContext(new Proxy({},{get:function(){throw new Error("BaseCommentAPI undefined. Did you forget to configure comment api context?")}}))});var bte,Ste=f(()=>{"use strict";s();_r();bte=new R([R.always(function(e){return{borderWidth:1,borderColor:e.palette.CardBorder}})])});var fM=Re((e5t,Ite)=>{s();Ite.exports=OfficePlatformGlobal.Polyester.Components});var Ete,eu,td,pM=f(()=>{"use strict";s();k();Lt();Ete=I(fM()),eu=I(L());hn();Fv();lx();pr();td=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.personaRef=eu.createRef(),n.registrationRef=eu.createRef(),n.onFocus=function(){n.setState({isFocusOn:!0})},n.onBlur=function(){n.setState({isFocusOn:!1})},n.state={isFocusOn:!1,isFocusWithin:!1},n}return t.prototype.getIterator=function(){return gt(this,function(r){switch(r.label){case 0:return[4,this];case 1:return r.sent(),[2]}})},t.prototype.getId=function(){return this.props.nodeId||""},t.prototype.getData=function(){return this.props.nodeData},t.prototype.getFocusState=function(){return uo(this.state)},t.prototype.getNextTabTarget=function(){return this.getFocusState()===ge.Unfocused&&this.isTabbable()?this:void 0},t.prototype.isTabbable=function(){return!!this.props.isTabbable},t.prototype.getChildNodes=function(){return[]},t.prototype.addChildNode=function(){throw new Error("Method not implemented.")},t.prototype.getDescendantById=function(){},t.prototype.focus=function(){this.personaRef.current&&Xg(this.personaRef.current)},t.prototype.blur=function(){},t.prototype.componentDidUpdate=function(r,n){uo(this.state)!==uo(n)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},t.prototype.render=function(){var r=eu.createElement(Ete.PersonaProfile,{accessible:this.props.accessible,size:this.props.size,displayName:Nr(this.props.author),authorId:this.props.author.appAuthorId,emailAddress:this.props.author.Email,contextId:this.props.author.authorContextId,resolutionId:this.props.author.UserId,testID:this.props.nodeId,ref:this.personaRef,onFocus:this.onFocus,onBlur:this.onBlur});return eu.createElement(vc,{node:this,position:0,ref:this.registrationRef},eu.createElement(J,{style:this.props.style,keyDownEvents:Cs(this.props.preventDefaultKeyDownBehavior,we.Capturing),onStartShouldSetResponder:wl},r))},t}(eu.Component)});function B_(e){return{marginTop:5,marginLeft:5,width:B_e*e}}var H_e,B_e,U_e,H_,Pte,_te,Rte,Ate,mM=f(()=>{"use strict";s();rt();_r();ze();H_e=44,B_e=125,U_e=180,H_={borderColor:"transparent",borderWidth:2,flexDirection:"row",padding:5},Pte=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor}})]),_te=new R([R.always(function(e){return{backgroundColor:e.menuFocus}})]),Rte=Ce({margin:5});Ate=et(function(e,t){return{width:U_e*t,maxHeight:H_e*(Math.min(e,5)+1)*t}})});var Dte,xa,wte,V_e,j_e,Fte,Ote=f(()=>{"use strict";s();k();Js();Me();Lt();Dte=I(dn()),xa=I(L()),wte=I(ee());Vr();Lo();ri();ze();xr();pM();as();mM();V_e=[{key:ne.ArrowRight,eventPhase:we.Capturing},{key:ne.ArrowLeft,eventPhase:we.Capturing}],j_e=xa.default.memo(function(e){var t=e.focusRef,r=e.fontScale,n=e.isSelected,o=e.index,a=e.onClick,d=e.user,c=zd(),u=xa.default.useRef(null),l=xa.default.useRef(null),p=j(xa.default.useState(ge.Unfocused),2),g=p[0],h=p[1],x=xa.default.useCallback(function(S){h(S)},[]);xa.default.useEffect(function(){t==null||t(u)},[t]),xa.default.useEffect(function(){var S;n&&((S=u.current)===null||S===void 0||S.focus())},[n]);var y=xa.default.useCallback(function(S){a(o)},[a,o]),T=xa.default.useCallback(function(S){var E,P;if(g!==ge.Unfocused){var _=fm(S.nativeEvent.key,wte.I18nManager.isRTL);_===ne.ArrowRight?((E=l.current)===null||E===void 0||E.focus(),S.stopPropagation()):_===ne.ArrowLeft&&((P=u.current)===null||P===void 0||P.focus(),S.stopPropagation())}},[g]),b=function(E,P){var _=mr(P),D=[H_];return g===ge.FocusOn&&D.push(ot(Pte,E,c.renderContextType)),n&&D.push(Tl(_te,_,c.renderContextType)),xa.default.createElement(Wr,{style:[D],ref:u,onPress:y,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,tooltip:d.DisplayName,accessible:!0,accessibilityLabel:d.DisplayName,accessibilityPositionInSet:e.index+1,accessibilitySetSize:e.userSetSize,accessibilityRole:"listitem",focusable:!0,onFocusStateChange:x,onKeyDown:T,keyDownEvents:V_e},xa.default.createElement(td,{ref:l,author:d,accessible:!1,focusable:!0,size:Dte.PersonaImageSize.small,preventDefaultKeyDownBehavior:void 0}),xa.default.createElement(on,{numberOfLines:1,color:_.text,variant:"secondaryStandard",style:[B_(r)],accessible:!1,focusable:!1},d.DisplayName))};return Ye(b,Ze,Zt)}),Fte=j_e});var Nte,Ho,Ah,W_e,z_e,Mte,Lte=f(()=>{"use strict";s();k();Js();Me();Lt();Nte=I(vm()),Ho=I(L()),Ah=I(ee());Er();Vr();ri();rc();xr();as();Ote();mM();W_e=[{key:ne.ArrowDown,eventPhase:we.Capturing},{key:ne.ArrowUp,eventPhase:we.Capturing},{key:ne.ArrowLeft,eventPhase:we.Capturing},{key:ne.ArrowRight,eventPhase:we.Capturing},{key:ne.Tab,eventPhase:we.Capturing},{key:ne.Home,eventPhase:we.Capturing},{key:ne.End,eventPhase:we.Capturing}],z_e=Ho.default.memo(function(e){var t=e.focusRef,r=e.onCalloutFocusChange,n=j(Ho.default.useState(void 0),2),o=n[0],a=n[1],d=yW(e.reactionButtonId),c=Ho.default.useRef(null),u=j(Ho.default.useState(-1),2),l=u[0],p=u[1],g=(0,Ah.useWindowDimensions)().fontScale;Ho.default.useEffect(function(){t==null||t(c)},[t]);var h=Ho.default.useCallback(function(E){var P=E!==ge.Unfocused;r==null||r(P),P&&(l===-1?p(0):o&&o.current&&o.current.getFocusState()===ge.Unfocused&&o.current.focus())},[l,r,o]),x=Ho.default.useCallback(function(E){var P;E===l?(P=o==null?void 0:o.current)===null||P===void 0||P.focus():p(E)},[l,o]),y=Ho.default.useCallback(function(E){var P;l===-1?p(0):o&&((P=o.current)===null||P===void 0||P.focus())},[l,o]),T=Ho.default.useCallback(function(E){var P;if(E.nativeEvent.key===ne.ArrowDown)l===e.userList.length-1?p(0):p(l+1),E.stopPropagation();else if(E.nativeEvent.key===ne.ArrowUp){p(l===0?e.userList.length-1:l-1),E.stopPropagation();return}else if(E.nativeEvent.key===ne.ArrowRight||E.nativeEvent.key===ne.ArrowLeft){l>=0&&E.stopPropagation();return}else E.nativeEvent.key===ne.Tab?(P=e.dismiss)===null||P===void 0||P.call(e):E.nativeEvent.key===ne.Home?(p(0),E.stopPropagation()):E.nativeEvent.key===ne.End&&(p(e.userList.length-1),E.stopPropagation())},[l,e]),b=Ho.default.useCallback(function(E){a(E)},[]),S=function(P,_){var D=Eh({icon:23,disabled:!1,renderTarget:"Pane",themeId:P.themeId}),O=mr(_);return Ho.default.createElement(Wr,{ref:c,onPress:y,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,focusable:!0,accessible:!0,accessibilityLabel:e.reactionLabel,accessibilityRole:"list",onFocusStateChange:h,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:[Ate(e.userList.length,g)],onKeyDown:T,keyDownEvents:W_e,testID:d,nodeId:d},Ho.default.createElement(Nte.ViewWin32,{style:[H_],accessible:!1,focusable:!1},Ho.default.createElement(Ah.Image,{source:D.source,style:[Rte]}),Ho.default.createElement(on,{numberOfLines:1,color:O.text,variant:"secondaryStandard",style:[B_(g)]},e.reactionLabel)),Ho.default.createElement(Ah.ScrollView,null,e.userList.map(function(H,V){return Ho.default.createElement(Fte,{fontScale:g,key:CW(d,V),index:V,isSelected:l===V,onClick:x,focusRef:l===V?b:void 0,user:H,userSetSize:e.userList.length})})))};return Ye(S,Ze,Zt)}),Mte=z_e});function G_e(e,t,r,n){r.getCommentReactionData?r.getCommentReactionData(e,t).then(function(o){return n(o.map(function(a){return a.user}))}).catch(function(o){v().assertConditionTag(!1,"getCommentReactionData failure",523647194)}):v().assertConditionTag(!1,"getCommentReactionData should not be undefined when gate is enabled",523647195)}var er,q_e,Hte,K_e,Ri,U_,gM=f(()=>{"use strict";s();k();Z();Js();Lt();er=I(L());xte();Er();Vr();L_();So();ze();xr();R_();pr();tx();Ste();Lte();q_e=250,Hte=600,K_e=[{key:ne.ArrowDown,altKey:!0,eventPhase:we.Capturing},{key:ne.Escape,eventPhase:we.Capturing}];(function(e){e[e.Hidden=0]="Hidden",e[e.Mouse=1]="Mouse",e[e.Keyboard=2]="Keyboard",e[e.AccessibilityAction=3]="AccessibilityAction"})(Ri||(Ri={}));U_=er.memo(function(e){var t=e.commentId,r=e.isTabbable,n=e.localizationAPI,o=e.onReactionPressed,a=e.preventDefaultKeyDownBehavior,d=e.preventReacting,c=e.reactionType,u=e.renderContextType,l=e.renderHiddenIfNoReactions,p=e.userReactionSummary,g=er.useRef(null),h=j(er.useState(void 0),2),x=h[0],y=h[1],T=j(er.useState(void 0),2),b=T[0],S=T[1],E=j(er.useState(Ri.Hidden),2),P=E[0],_=E[1],D=j(er.useState(void 0),2),O=D[0],H=D[1],V=j(er.useState(!1),2),M=V[0],G=V[1],K=Tte(),z=er.useRef(vW({id:t,renderContextType:u})),$=vte(c,p),q=$>0||!l&&!d,re=P!==Ri.Hidden,ae=q&&$>0,ie=er.useCallback(function(){M||(G(!0),G_e(t,c,K,function(ut){S({reactionCount:$,users:ut}),G(!1)}))},[K,t,M,$,c,S]);re&&(ae?b&&$!==b.reactionCount&&ie():_(Ri.Hidden));var Te=er.useCallback(function(ut){ut.nativeEvent.key===ne.Escape&&re?(_(Ri.Hidden),ut.stopPropagation()):ut.nativeEvent.key===ne.ArrowDown&&ut.nativeEvent.altKey&&(re&&(x!=null&&x.current)?x.current.focus():(ie(),_(Ri.Keyboard)),ut.stopPropagation())},[x,ie,re]),Oe=er.useCallback(function(){O!==void 0&&(clearTimeout(O),H(void 0))},[O]),ke=er.useCallback(function(){Oe(),!(!ae||re)&&(ie(),H(setTimeout(function(){return _(Ri.Mouse)},q_e)))},[ae,ie,Oe,re]),it=er.useCallback(function(){Oe(),!(!ae||!re)&&H(setTimeout(function(){return _(Ri.Hidden)},Hte))},[ae,Oe,re]),_e=er.useCallback(function(){Oe(),!(!ae||!re)&&_(Ri.Hidden)},[ae,Oe,re]),ct=er.useCallback(function(ut){Oe(),ut===ge.Unfocused&&H(setTimeout(function(){return _(Ri.Hidden)},Hte))},[Oe]),Ge=er.useMemo(function(){return yte(c,$,n)},[n,$,c]),Nt=Cte(c,p),Vt=er.useCallback(function(){q&&!d&&o(t,!Nt,c)},[t,Nt,o,d,c,q]),yt=er.useCallback(function(ut){y(ut)},[]),zt=er.useCallback(function(ut){ut.nativeEvent.actionName==="Toggle"?Vt():ae&&ut.nativeEvent.actionName==="Expand"?_(Ri.AccessibilityAction):ut.nativeEvent.actionName==="Collapse"&&_(Ri.Hidden)},[ae,Vt]),Fr=er.useCallback(function(ut){ut?Oe():it()},[it,Oe]);if(!$&&d)return null;var In=function(pn){return b===void 0||b.users.length===0?null:er.createElement(Yi,{target:g,setInitialFocus:P===Ri.Keyboard||P===Ri.AccessibilityAction,doNotTakePointerCapture:!0,onDismiss:_e,style:ot(bte,pn,u)},er.createElement(Mte,{reactionButtonId:z.current,userList:b.users,reactionLabel:Ge,onMouseEnter:ke,onMouseLeave:it,focusRef:yt,dismiss:_e,onCalloutFocusChange:Fr}))},jn=function(){return Ye(In,Ze)},io=$>0?$.toString():"";return er.createElement(J,{onKeyDown:Te,keyDownEvents:K_e},er.createElement(Tn,{ref:g,accessibilityActions:c_(ae?["Expand","Collapse","Toggle"]:["Toggle"]),onAccessibilityAction:zt,accessibilityHint:n.getString(240),accessibilityLabel:Ge,accessibilityState:{checked:Nt,disabled:d,expanded:ae?re:void 0},isTabbable:r&&q,onClick:Vt,icon:hte(c,Nt),style:gK(Qg,u),visibility:q?"visible":"hidden",text:io,appearance:"subtle",tooltipText:q&&!re?Ge:void 0,onMouseEnter:ke,onMouseLeave:it,onFocusStateChange:ct,testID:z.current,nodeId:z.current,preventDefaultKeyDownBehavior:a}),re&&jn())})});function kh(e,t,r){var n=void 0,o=void 0,a=t.map(function(d,c){d.isDestructive&&(v().assertConditionTag(n===void 0,'There should only ever be a single "destructive" action at once',595137034),n=c),d.isCancelItem&&(v().assertConditionTag(o===void 0,'There should only ever be a single "cancel" action at once',595137035),o=c);var u=va({icon:d.icon,themeId:e,disabled:d.disabled,renderTarget:"ContextualMenu"});return{name:d.text,key:"ContextMenuItem-".concat(c),onClick:function(){return d.onClick(r)},icon:u?u.source:void 0}});return{items:a,destructiveButtonIndex:n,cancelButtonIndex:o}}var hM=f(()=>{"use strict";s();Z();rc()});function j_(e){return V_.default.createElement(hp,null,V_.default.createElement(Sh,null,e.map(function(t){return V_.default.createElement(Th,{key:t.key,onClick:t.onClick,icon:typeof t.icon=="object"?{source:t.icon}:void 0},t.name)})))}var V_,yM=f(()=>{"use strict";s();__();V_=I(L())});var gx=f(()=>{"use strict";s();pM()});var Bte,Bo,Y_e,Ute,Vte=f(()=>{"use strict";s();k();rt();Bte=I(dn()),Bo=I(L());hn();ue();Od();bf();Be();Kc();nte();px();R_();gM();hM();yM();gx();pr();xn();zs();Er();Vr();Lo();Ir();So();ze();xr();Y_e=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.getContextMenuItems=et(kh),r.getMenuPopover=et(j_),r.onEdit=function(){r.props.onEditRootPost(r.props.id)},r.renderWithContexts=function(n,o){var a,d=o.renderContextType,c=[],u=[r.renderStyle($ee,n,d)];le()&&r.props.isResolvedCard&&u.push(ete);var l=Gg(u,0,r.props.extraPaddingRight,0,r.props.extraPaddingLeft);if(le()){var p=[r.renderStyle(rte,n,d),{opacity:r.props.rootAuthorOpacity}];c.push(Bo.createElement(J,{animationClass:"CommentCard_CommentCardHeader",style:p,key:"rootAuthor"},Bo.createElement(td,{accessible:Y()==="win32",isTabbable:r.props.isTabbable&&Y()==="win32"&&r.props.rootAuthorOpacity>0,size:Bte.PersonaImageSize.extraSmall,author:r.props.author,style:r.renderStyle(Jee,n,d),preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,nodeId:Km({id:r.props.id,renderContextType:d})}),r.renderRootLabel(n,d)))}if(r.props.anchorText&&c.push(Bo.createElement(J,{key:"hint",style:r.renderStyle(Qee,n,d),accessible:!1},Bo.createElement(Ve,{textStylePolyester:"SmallStandard",variantFluent:"captionStandard"},r.props.anchorText))),r.addButtonsToHeaderContents(c,n,d),!le())return c.length?Bo.createElement(Yr,{key:"header",style:l},c):void 0;var g=(a=r.props.cardBorderWeight)!==null&&a!==void 0?a:Yee,h=d!==A.DiscreteIsolated||Y()!=="win32",x=[r.renderStyle(tte,n,d),{marginRight:g,marginLeft:g+(h?qc:0),opacity:1-r.props.rootAuthorOpacity}];return c.length?Bo.createElement(J,null,Bo.createElement(Yr,{isTabbable:!1,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,style:l},c),Bo.createElement(J,{animationClass:"CommentCard_CommentCardHeader",style:x})):void 0},r.render=function(){return Ye(r.renderWithContexts,Ze,nn)},r}return t.prototype.renderStyle=function(r,n,o){return ot(r,n,o)},t.prototype.isExpanded=function(r){return r===A.HalfPane||this.props.cardCollapsedState===At.Expanded},t.prototype.renderRootLabel=function(r,n){var o=Nr(this.props.author),a=[this.renderStyle(w_,r,n),this.renderStyle(Zee,r,n)];return le()&&this.props.isResolvedCard&&!this.isExpanded(n)&&a.push(this.renderStyle($g,r,n)),Bo.createElement(Ve,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",style:a,disabled:Y()!=="win32"&&this.props.isResolvedCard,numberOfLines:le()?void 0:1,key:"name",accessible:Y()==="win32"?!1:void 0},o)},t.prototype.addButtonsToHeaderContents=function(r,n,o){if((this.props.displayMode===xe.Draft||this.props.displayMode===xe.DraftPreCommitPending)&&o!==A.HalfPane){if(le())return;var a=WI({id:this.props.id,renderContextType:o}),d=this.props.localizationAPI.getStringOrUndefined(15);r.push(Bo.createElement(Tn,{onClick:this.props.onCancelDraft,accessibilityLabel:d,isTabbable:this.props.isTabbable,key:"cancel",tooltipText:d,style:[this.renderStyle(Xee,n,o)],icon:1,testID:a,nodeId:a,disabled:this.props.displayMode===xe.DraftPreCommitPending,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:""}));return}var c=this.props.rootAuthorOpacity>0;if(!lo()&&!this.props.hideActions&&c&&r.push(this.renderEditButton(n,o)),!this.props.hideActions&&this.props.menuItems.length>0){var u=$j({id:this.props.id,renderContextType:o}),l=this.getContextMenuItems(n.themeId,this.props.menuItems,this.props.id);r.push(Bo.createElement(Tn,{onClick:Y()==="win32"?void 0:l,accessibilityLabel:this.props.localizationAPI.getStringOrUndefined(45),isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,style:this.renderStyle(Q0,n,o),tooltipText:this.props.localizationAPI.getStringOrUndefined(45),testID:u,nodeId:u,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:"",appearance:"subtle",menuProps:Y()==="win32"?{menu:this.getMenuPopover(l.items)}:void 0}))}lo()&&!this.props.hideActions&&c&&r.push(this.renderEditButton(n,o)),c&&r.push(this.renderReactionButton(n,o))},t.prototype.renderEditButton=function(r,n){if(!rf()||!this.props.allowRootEditButton)return null;var o=Qj({id:this.props.id,renderContextType:n});return Bo.createElement(Tn,{onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),isTabbable:this.props.isTabbable,key:"cardEditButton",icon:6,style:this.renderStyle(Qg,r,n),tooltipText:this.props.localizationAPI.getString(120),nodeId:o,testID:o,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:"",appearance:"subtle"})},t.prototype.getReactionButtonContainerStyle=function(r,n){return le()&&this.props.isResolvedCard&&this.props.cardCollapsedState===At.Collapsed?this.renderStyle(J0,r,n):le()&&!qo()&&this.props.isCardHovered?this.renderStyle(Z0,r,n):this.renderStyle(X0,r,n)},t.prototype.renderReactionButton=function(r,n){return!lo()||this.props.reactionButtonProps===void 0||this.props.reactionButtonProps.reactionType===void 0||this.props.reactionButtonProps.userReactionSummary===void 0||this.props.reactionButtonProps.onReactionPressed===void 0?null:Bo.createElement(J,{style:this.getReactionButtonContainerStyle(r,n),key:"reaction-background"},Bo.createElement(U_,{commentId:this.props.id,isTabbable:!!this.props.isTabbable,onReactionPressed:this.props.reactionButtonProps.onReactionPressed,reactionType:this.props.reactionButtonProps.reactionType,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.reactionButtonProps.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,renderHiddenIfNoReactions:!1,renderContextType:n,key:"cardReactionButton"}))},t}(Bo.PureComponent),Ute=Y_e});var Wte=Re((OVt,jte)=>{s();jte.exports=OfficePlatformGlobal.RNWin32.UIAnchor});var zte,Dh,W_=f(()=>{"use strict";s();zte=I(_t());Ir();Dh=function(){function e(){var t=this;this._event=new zte.EventImpl(function(){}),this.isHovered=!1,this.hoverChangeEvent=this._event,this.onMouseEnter=function(){return t.debounce(function(){t.onHoverChange(!0)})},this.onMouseLeave=function(){return t.debounce(function(){t.onHoverChange(!1)})},this.viewProps=Y()==="win32"?{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}:{}}return e.prototype.debounce=function(t){var r=this;this.action?this.action=t:(this.action=t,setTimeout(function(){r.action&&r.action(),r.action=void 0},e.DebounceDelay))},e.prototype.onHoverChange=function(t){t!==this.isHovered&&(this.isHovered=t,this._event.trigger(t))},e.DebounceDelay=50,e}()});function nc(e,t,r){var n=function(a){X(d,a);function d(){var c=a.apply(this,w([],j(arguments),!1))||this;return c.allContextContents={},c.keys=Object.keys(t),c.renderFunction=c.keys.reduceRight(function(u,l){return function(p,g){var h=t[l];return tu.createElement(h.Consumer,null,function(x){return c.allContextContents[l]=x,u===null?tu.createElement(e,m({ref:p},g,c.allContextContents)):u(p,g)})}},null),c.render=function(){var u=c.props,l=u.forwardedRef,p=je(u,["forwardedRef"]),g=p;return c.renderFunction?c.renderFunction(l,g):(v().assertConditionTag(!1,"Contexts failed to wrap, default to null.",558724946),tu.createElement(e,m({},g,{ref:l},c.allContextContents)))},c}return d}(tu.Component),o=tu.forwardRef(function(a,d){return tu.createElement(n,m({key:$_e,forwardedRef:d},a))});return o.displayName=r,o}var tu,$_e,wh=f(()=>{"use strict";s();k();Z();tu=I(L()),$_e="ContextualizedWrapperComponent"});var z_,CM,Gte=f(()=>{"use strict";s();k();z_=I(L()),CM=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.state={showLoadingUI:!1},n}return t.prototype.setTimer=function(){var r=this;this.timeout||(this.timeout=setTimeout(function(){r.setState({showLoadingUI:!0}),r.timeout=void 0},this.props.delay))},t.prototype.clearTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)},t.prototype.componentDidMount=function(){this.props.isLoading&&this.setTimer()},t.prototype.componentWillUnmount=function(){this.clearTimer()},t.prototype.componentDidUpdate=function(r){!r.isLoading&&this.props.isLoading?this.setTimer():r.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))},t.prototype.render=function(){return this.state.showLoadingUI?this.props.loadingUI:z_.Children.only(this.props.children)},t}(z_.Component)});var qte=f(()=>{"use strict";s();Gte()});var Kte,Yte=f(()=>{"use strict";s();Js();CN();ri();Kte=function(t,r){var n=mr(r),o=a_(nh.customize({tokens:{borderRadius:2,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.squareCheckboxBorderColor},root:{style:{alignItems:"center",marginRight:0,height:26,width:26,paddingRight:3,paddingLeft:3,paddingTop:3,paddingBottom:3,borderRadius:4,borderWidth:1,borderColor:"transparent",marginBottom:2}},checkbox:{style:{marginTop:0,width:18,height:18,paddingLeft:1,justifyContent:"center",alignItems:"center"}},checkmark:{accessible:!1,style:{fontSize:12,fontWeight:"bold"}},content:{style:{display:"none"}},_overrides:{checked:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.squareCheckboxBorderColor,checkmarkColor:n.completedCheckColor}},pressed:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.completedSquareCheckboxColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:t.palette.FocusBorderColor,borderStyle:"solid",padding:0}}}}}));return o.displayName="SquareCheckbox",o}});var $te,Qte,Xte,Jte,Zte=f(()=>{"use strict";s();_r();$te=new R([R.always(function(e){return{width:200,flex:1,borderRadius:2,borderWidth:1,flexDirection:"column",backgroundColor:e.palette.CardBorder,borderColor:e.palette.CardBorder,padding:1}})]),Qte=new R([R.always(function(e){return{flex:1,flexDirection:"row",paddingLeft:9,paddingBottom:8,paddingTop:8,backgroundColor:e.palette.CardBackground}})]),Xte=new kt([kt.always({marginLeft:9,marginRight:15,flex:1,alignSelf:"center"})]),Jte=new R([R.always(function(e){return{backgroundColor:e.menuFocus}})])});function X_e(e,t,r,n){var o=t;switch(e.nativeEvent.key){case ne.ArrowUp:o--;break;case ne.ArrowDown:o++;break;case ne.Home:o=0;break;case ne.End:o=n-1;break;default:return}o<0?o=n-1:o>=n&&(o=0),r(o),e.stopPropagation()}function Z_e(e,t,r){var n;t.current!==r&&r&&((n=e.current)===null||n===void 0||n.focus()),t.current=r}function tRe(e,t,r){switch(e.nativeEvent.key){case ne.Tab:e.stopPropagation(),t(r);break}}var ere,bn,J_e,tre,eRe,rre,nre=f(()=>{"use strict";s();k();bd();Js();Me();Lt();ere=I(dn()),bn=I(L());hn();Vr();ri();fn();ze();xr();gx();as();pr();xn();Zte();J_e=[{key:ne.ArrowUp,eventPhase:we.Capturing},{key:ne.ArrowLeft,eventPhase:we.Capturing},{key:ne.ArrowDown,eventPhase:we.Capturing},{key:ne.ArrowRight,eventPhase:we.Capturing},{key:ne.Home,eventPhase:we.Capturing},{key:ne.End,eventPhase:we.Capturing}],tre=bn.memo(function(e){var t=j(bn.useState(0),2),r=t[0],n=t[1],o={};Object.keys(e.candidates).forEach(function(u){e.candidates[u].stillInDraft&&(o[u]=e.candidates[u])});var a=Object.keys(o).length,d=bn.useCallback(function(u){return X_e(u,r,n,a)},[r,n,a]),c=function(l){return bn.createElement(Yi,{target:e.anchorRef,onDismiss:e.onHide,setInitialFocus:!0},bn.createElement(J,{style:ot($te,l,e.renderContextType),onKeyDown:d,keyDownEvents:J_e},Object.keys(o).map(function(p,g){var h=o[p];return bn.createElement(rre,{key:ku(h.mentionee)?h.mentionee.UserId:h.mentionee.Id,candidate:h.mentionee,onClick:e.onCandidateChosen,renderContextType:e.renderContextType,selected:r===g,index:g,totalSuggestions:a})})))};return Ye(c,Ze)});eRe=[{key:ne.Tab,eventPhase:we.Capturing},{key:ne.Tab,eventPhase:we.Capturing,shiftKey:!0}];rre=bn.memo(function(e){var t=e.onClick,r=e.candidate,n=bn.useCallback(function(l){t(r)},[t,r]),o=Du(e.candidate),a=bn.useRef(null),d=bn.useRef(!1);bn.useEffect(function(){return Z_e(a,d,e.selected)},[a,d,e.selected]);var c=bn.useCallback(function(l){return tRe(l,e.onClick,e.candidate)},[e.onClick,e.candidate]),u=function(p,g){var h=mr(g);return bn.createElement(Wr,{style:ot(Qte,p,e.renderContextType),onPress:n,keyDownEvents:eRe,onKeyDown:c,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,ref:a,accessible:!0,tooltip:o,accessibilityPositionInSet:e.index+1,accessibilitySetSize:e.totalSuggestions,accessibilityLabel:o,focusedStyle:Tl(Jte,h,e.renderContextType),accessibilityRole:"listitem"},bn.createElement(td,{author:{DisplayName:o,Provider:"",Email:e.candidate.EmailAddresses[0],UserId:e.candidate.Id,IsCurrentUser:!1},accessible:!1,size:ere.PersonaImageSize.extraSmall,preventDefaultKeyDownBehavior:void 0}),bn.createElement(Ve,{numberOfLines:1,colorFluent:e.selected?h.selectedText:h.text,variantFluent:"secondaryStandard",style:Xte.render(Kr(e.renderContextType)),accessible:!1},e.candidate.Name))};return Ye(u,Ze,Zt)});rre.displayName="Suggestion"});var ore,ire,are,sre,dre,cre,ure,lre,fre=f(()=>{"use strict";s();_r();ze();ore=5,ire=new R([R.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",flex:1,borderWidth:0})]),are=new R([R.always({borderWidth:1,paddingRight:ore,paddingLeft:ore,alignSelf:"stretch",flexDirection:"row",borderColor:"transparent",borderRadius:2,flexGrow:0,flexShrink:1})]),sre=new R([R.always(function(e){return{borderStyle:"dashed",borderColor:e.palette.FocusBorderColor}})]),dre=new R([R.always({marginBottom:2,borderBottomWidth:1,flexDirection:"row",borderColor:"transparent",flexShrink:1})]),cre=new kt([kt.always({textAlignVertical:"center",paddingBottom:1,flexGrow:0,flexShrink:1})]),ure=new kt([kt.always({marginLeft:6})]),lre=Ce({flexShrink:1,alignSelf:"stretch"})});var Ji,pre,mre,gre=f(()=>{"use strict";s();k();rt();Me();Ji=I(L()),pre=I(ee());hn();mi();Vr();Lo();ri();uO();rc();ze();xr();Yte();as();bl();nre();xn();fre();mre=function(e){X(t,e);function t(r){var n,o=e.call(this,r)||this;return o.makeSquareCheckbox=et(function(a,d){return Kte(a,d)}),o.getCheckboxAccessibilityLabel=et(function(a){return cY(o.props.label,Du(a))}),o.onChange=function(){o.setState({isChecked:!o.state.isChecked})},o.onCalloutAnchorClick=function(){o.state.isPickerOpen||o.setState({isPickerOpen:!0})},o.onPickerHide=function(){o.setState({isPickerOpen:!1})},o.onCandidateChosen=function(a){o.setState({displayedAssignee:a,isPickerOpen:!1,isChecked:!0})},o.renderWithContexts=function(a,d,c){var u=c.renderContextType,l=o.makeSquareCheckbox(a,d);return Ji.createElement(J,{key:"task assigner",style:o.renderStyle(ire,a,u)},Ji.createElement(l,{checked:o.state.isChecked,onChange:o.onChange,accessibilityLabel:o.getCheckboxAccessibilityLabel(o.state.displayedAssignee),preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,isTabbable:o.props.isTabbable,nodeId:"task-assigner-checkbox",tooltip:o.state.isChecked?void 0:LI(o.props.localizationAPI,o.props.isTaskThread,o.state.displayedAssignee)}),o.renderAssignerText(a,d,u))},o.render=function(){return Ye(o.renderWithContexts,Ze,Zt,nn)},o.state={displayedAssignee:(n=r.selectedAssignee)!==null&&n!==void 0?n:pw(r.candidateAssignees),isPickerOpen:!1,isChecked:!!r.selectedAssignee},o.anchorRef=Ji.createRef(),o}return t.prototype.componentDidUpdate=function(r,n){n.isChecked!==this.state.isChecked?this.props.onSelectedTaskAssigneeUpdated(this.state.isChecked?this.state.displayedAssignee:void 0):this.state.isChecked&&this.state.displayedAssignee.AadObjectId!==n.displayedAssignee.AadObjectId&&this.props.onSelectedTaskAssigneeUpdated(this.state.displayedAssignee)},t.getDerivedStateFromProps=function(r,n){var o=n.displayedAssignee&&r.candidateAssignees[Ss(n.displayedAssignee)];return o?{}:{displayedAssignee:pw(r.candidateAssignees),isChecked:!1}},t.prototype.renderStyle=function(r,n,o){return ot(r,n,o)},t.prototype.renderAssignString=function(r,n){return Ji.createElement(Ve,{numberOfLines:1,variantFluent:"secondaryStandard",key:"task-assignment-string",accessible:!1,style:this.renderStyle(ure,r,n)},this.props.label)},t.prototype.renderAssigneeName=function(r,n){return Ji.createElement(Ve,{numberOfLines:1,variantFluent:"secondarySemibold",key:"name",accessible:!1,style:this.renderStyle(cre,r,n)},this.state.displayedAssignee.Name)},t.prototype.renderAssignerText=function(r,n,o){var a=void 0,d=mr(n);Object.keys(this.props.candidateAssignees).length>1&&(a=Eh({icon:8,renderTarget:"Pane",themeId:r.themeId}));var c=!!a,u=[this.renderStyle(dre,r,o)];c&&u.push({borderColor:d.squareCheckboxBorderColor});var l=LI(this.props.localizationAPI,this.props.isTaskThread,this.state.displayedAssignee);return Ji.createElement(J,{style:lre},this.renderAssignString(r,o),Ji.createElement(Wr,{style:this.renderStyle(are,r,o),focusedStyle:c?this.renderStyle(sre,r,o):void 0,onPress:c?this.onCalloutAnchorClick:void 0,isTabbable:this.props.isTabbable&&c?this.props.isTabbable:!1,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:"task-assigner-anchor",accessibilityLabel:l,accessibilityRole:c?"combobox":void 0,accessible:c,tooltip:l,ref:this.anchorRef},Ji.createElement(J,{style:u},this.renderAssigneeName(r,o),a&&Ji.createElement(pre.Image,{source:a.source,style:U0}))),this.state.isPickerOpen&&Ji.createElement(tre,{onHide:this.onPickerHide,candidates:this.props.candidateAssignees,onCandidateChosen:this.onCandidateChosen,anchorRef:this.anchorRef,renderContextType:o}))},t}(Ji.PureComponent)});var vM,hre,yre,xM,Cre,vre=f(()=>{"use strict";s();vM=I(dn());_r();hre=new R([R.always({flexDirection:"row",justifyContent:"flex-end",padding:0,paddingTop:6,paddingBottom:1}),R.rule({isFluentEnabled:!0},{alignItems:"center",paddingRight:3,paddingTop:3})]),yre=vM.StyleSheet.createViewStyle({paddingBottom:3}),xM=new R([R.always({flex:0,marginLeft:7,height:26,width:39})]),Cre=vM.StyleSheet.createViewStyle({justifyContent:"center"})});function oRe(e,t,r,n){return t.map(function(o,a){return oc.createElement(CM,{key:a,delay:jd,isLoading:!!o.showDelayedSpinner,loadingUI:oc.createElement(J,{style:[ot(xM,e,n),Cre]},oc.createElement(xre.Spinner,{size:"small"}))},oc.createElement(Tn,{onClick:o.onClick,accessibilityLabel:o.accessibilityLabel,isTabbable:!!o.isTabbable,style:ot(xM,e,n),tooltipText:g_(o),testID:o.id,nodeId:o.id||"",disabled:o.disabled,icon:o.icon,appearance:o.usePrimaryButtonStyling?"primary":void 0,preventDefaultKeyDownBehavior:r,text:""}))})}var xre,oc,hx,Tre=f(()=>{"use strict";s();k();xre=I(dn()),oc=I(L());zs();PN();Lo();fn();ze();xr();Ph();qte();pr();gre();vre();hx=oc.memo(function(t){var r=zd().renderContextType;return oc.createElement(Ze.Consumer,null,function(n){return oc.createElement(Yr,{key:"draft-button-container",style:[hre.render(Kr(r)),t.taskAssigner?yre:void 0],animationClass:t.animationClass,focusable:!1},t.taskAssigner&&oc.createElement(mre,m({},t.taskAssigner)),oRe(n,t.buttons,t.preventDefaultKeyDownBehavior,r))})})});var TM=f(()=>{"use strict";s();Tre()});function G_(e){var t=e;return t.onMentionCreated!==void 0&&t.onMentioneesStillInDraftUpdated!==void 0&&t.correlationId!==void 0}var bM=f(()=>{"use strict";s()});function Sre(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return q_.Children.toArray(t).reduce(function(n,o){if(!o)return n;if(bre.isElement(o))return o.props.children&&Kl("Warning: wrapper elements should not contain children"),q_.cloneElement(o,void 0,n);throw new Error("Expected element but got ".concat(o))},e)}var q_,bre,Ire=f(()=>{"use strict";s();te();q_=I(L()),bre=I(Xb())});var Ere,iRe,Fh,K_=f(()=>{"use strict";s();Ere=I(L()),iRe="LPPManagerContext undefined. Did you forget to render a LPPManagerContext context provider?",Fh=Ere.createContext(new Proxy({},{get:function(){throw new Error(iRe)}}))});function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}var SM=f(()=>{"use strict";s()});function IM(e,t){if(Fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pre=f(()=>{"use strict";s();SM()});function EM(e){var t=IM(e,"string");return Fl(t)=="symbol"?t:t+""}var _re=f(()=>{"use strict";s();SM();Pre()});function PM(e,t,r){return t=EM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Rre=f(()=>{"use strict";s();_re()});function Are(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Y_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Are(Object(r),!0).forEach(function(n){PM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Are(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var kre=f(()=>{"use strict";s();Rre()});var Fre={};_y(Fre,{__DO_NOT_USE__ActionTypes:()=>yx,applyMiddleware:()=>Cx,bindActionCreators:()=>cRe,combineReducers:()=>Oh,compose:()=>xp,createStore:()=>vp,legacy_createStore:()=>sRe});function Uo(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}function aRe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function vp(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Uo(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Uo(1));return r(vp)(e,t)}if(typeof e!="function")throw new Error(Uo(2));var o=e,a=t,d=[],c=d,u=!1;function l(){c===d&&(c=d.slice())}function p(){if(u)throw new Error(Uo(3));return a}function g(T){if(typeof T!="function")throw new Error(Uo(4));if(u)throw new Error(Uo(5));var b=!0;return l(),c.push(T),function(){if(b){if(u)throw new Error(Uo(6));b=!1,l();var E=c.indexOf(T);c.splice(E,1),d=null}}}function h(T){if(!aRe(T))throw new Error(Uo(7));if(typeof T.type>"u")throw new Error(Uo(8));if(u)throw new Error(Uo(9));try{u=!0,a=o(a,T)}finally{u=!1}for(var b=d=c,S=0;S<b.length;S++){var E=b[S];E()}return T}function x(T){if(typeof T!="function")throw new Error(Uo(10));o=T,h({type:yx.REPLACE})}function y(){var T,b=g;return T={subscribe:function(E){if(typeof E!="object"||E===null)throw new Error(Uo(11));function P(){E.next&&E.next(p())}P();var _=b(P);return{unsubscribe:_}}},T[Dre]=function(){return this},T}return h({type:yx.INIT}),n={dispatch:h,subscribe:g,getState:p,replaceReducer:x},n[Dre]=y,n}function dRe(e){Object.keys(e).forEach(function(t){var r=e[t],n=r(void 0,{type:yx.INIT});if(typeof n>"u")throw new Error(Uo(12));if(typeof r(void 0,{type:yx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Uo(13))})}function Oh(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];typeof e[o]=="function"&&(r[o]=e[o])}var a=Object.keys(r),d,c;try{dRe(r)}catch(u){c=u}return function(l,p){if(l===void 0&&(l={}),c)throw c;for(var g=!1,h={},x=0;x<a.length;x++){var y=a[x],T=r[y],b=l[y],S=T(b,p);if(typeof S>"u"){var E=p&&p.type;throw new Error(Uo(14))}h[y]=S,g=g||S!==b}return g=g||a.length!==Object.keys(l).length,g?h:l}}function wre(e,t){return function(){return t(e.apply(this,arguments))}}function cRe(e,t){if(typeof e=="function")return wre(e,t);if(typeof e!="object"||e===null)throw new Error(Uo(16));var r={};for(var n in e){var o=e[n];typeof o=="function"&&(r[n]=wre(o,t))}return r}function xp(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,o){return function(){return n(o.apply(void 0,arguments))}})}function Cx(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var o=n.apply(void 0,arguments),a=function(){throw new Error(Uo(15))},d={getState:o.getState,dispatch:function(){return a.apply(void 0,arguments)}},c=t.map(function(u){return u(d)});return a=xp.apply(void 0,c)(o.dispatch),Y_(Y_({},o),{},{dispatch:a})}}}var Dre,_M,yx,sRe,Ol=f(()=>{"use strict";s();kre();Dre=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),_M=function(){return Math.random().toString(36).substring(7).split("").join(".")},yx={INIT:"@@redux/INIT"+_M(),REPLACE:"@@redux/REPLACE"+_M(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+_M()}};sRe=vp});var Ore=Re((R8t,ru)=>{s();function RM(e,t){return ru.exports=RM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ru.exports.__esModule=!0,ru.exports.default=ru.exports,RM(e,t)}ru.exports=RM,ru.exports.__esModule=!0,ru.exports.default=ru.exports});var Nh=Re((k8t,vx)=>{s();var uRe=Ore();function lRe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,uRe(e,t)}vx.exports=lRe,vx.exports.__esModule=!0,vx.exports.default=vx.exports});var Nre,Mre=f(()=>{"use strict";s();Nre={exportCss:function(){}}});function Lre(e,t){console.error("Exception in ".concat(e)),console.error(t)}function AM(e){if(!e||!e.handleException)return{handleException:Lre};var t=!1;return{handleException:function(n,o){if(t)Lre(n,o);else{t=!0;try{e.handleException(n,o)}finally{t=!1}}}}}var Hre,Bre=f(()=>{"use strict";s();Hre=AM(void 0)});function fRe(e){return typeof e._singleton_index!="number"&&(e._singleton_index=Ure,Ure+=1),e._singleton_index}function Vre(e){return e._Name||e.name||"Unknown"}var jre,Ure,$_,kM,DM=f(()=>{"use strict";s();jre=I(FV());Mre();Bre();Ure=1;$_=function(){function e(t){this.singletonsByIndex={},this._exceptionHandler=Hre,this._cssExtractor=Nre,this.reduxStore=t&&t.reduxStore}return Object.defineProperty(e.prototype,"exceptionHandler",{get:function(){return this._exceptionHandler},set:function(r){this._exceptionHandler=AM(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssExtractor",{get:function(){return this._cssExtractor},set:function(r){this._cssExtractor=r},enumerable:!1,configurable:!0}),e.prototype.addSingleton=function(t){if(this.findSingleton(t.constructor))throw new Error("Singleton ".concat(Vre(t.constructor)," already exists."));var r=fRe(t.constructor);if(this.singletonsByIndex[r]!==void 0)throw new Error("Singleton with index ".concat(r," already exists."));this.singletonsByIndex[r]=t},e.prototype.getSingleton=function(t){var r=this.findSingleton(t);if(r===void 0)throw new Error("Singleton ".concat(Vre(t)," not found."));return r},e.prototype.findSingleton=function(t){if(typeof t._singleton_index=="number"){var r=this.singletonsByIndex[t._singleton_index];if(r&&r.constructor===t)return r}},e}(),kM={appContext:jre.instanceOf($_).isRequired}});var Tp,wM,Wre=f(()=>{"use strict";s();k();Tp=I(L());bs();DM();wM=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getChildContext=function(){return{appContext:this.props.context}},t.prototype.componentDidCatch=function(r,n){this.props.context.exceptionHandler.handleException("App.componentDidCatch:".concat(n.componentStack),r)},t.prototype.render=function(){return this.props.context.reduxStore?Tp.createElement(af,{store:this.props.context.reduxStore},this.props.children):Tp.createElement(Tp.Fragment,null,this.props.children)},t.childContextTypes=m({},kM),t}(Tp.Component)});function mRe(e,t){if(!e)return e;var r={},n=!1;return Object.keys(e).forEach(function(o){var a=e[o],d=t(o,a,e);r[o]=d,n=n||d!==a}),n?r:e}function gRe(e,t){if(!e)return e;var r={},n=!1;return Object.keys(e).forEach(function(o){var a=e[o];t(o,a,e)?r[o]=a:n=!0}),n?r:e}function hRe(e,t){if(e)return e[t]}function yRe(e,t,r){if(e&&e[t]===r)return e;var n=m({},e);return n[t]=r,n}function CRe(e,t,r){return zre(e,t,r,function(n){return n})}function zre(e,t,r,n){if(!t.length)return e;var o=m({},e),a=!1;return t.forEach(function(d,c){var u=n(d,c),l=r(d,c,u);o[l]!==u&&(o[l]=u,a=!0)}),a?o:e}function vRe(e,t){if(!e||!(t in e))return e;var r=m({},e);return delete r[t],r}function xRe(e,t,r){var n=e?m({},e):{};return n[t]=r(n[t]),n}function TRe(e,t,r){if(t.length){var n=m({},e);return t.forEach(function(o){n[o]=r(n[o],o)}),n}else return e}function bRe(e){return e?Object.keys(e):[]}function SRe(e){var t=[];return e&&Object.keys(e).forEach(function(r){var n=e[r];t.push(n)}),t}function IRe(e){var t=[];return e&&Object.keys(e).forEach(function(r){var n=e[r];t.push([r,n])}),t}var pRe,ic,FM=f(()=>{"use strict";s();k();pRe=function(t){var r={};if(t==null)return r;if(t instanceof Array)for(var n=0;n<t.length;n++){var o=t[n];r[o[0]]=o[1]}else Object.keys(t).forEach(function(a){r[a]=t[a]});return r};ic={create:pRe,map:mRe,filter:gRe,get:hRe,insert:yRe,insertArray:CRe,insertArrayWith:zre,remove:vRe,replace:xRe,replaceMany:TRe,keys:bRe,values:SRe,entries:IRe}});function OM(e,t){return m({isLoading:function(n){var o=t(n);return!!o&&o.isLoading&&(!o.hasLoadedPreviously||o.hasError)},isCallInProgress:function(n){var o=t(n);return!!o&&o.isLoading},hasError:function(n){var o=t(n);return!!o&&o.hasError},hasLoaded:function(n){var o=t(n);return!!o&&(o.hasLoadedPreviously||o.hasError)},hasLoadedPreviously:function(n){var o=t(n);return!!o&&o.hasLoadedPreviously},hasStartedPreviously:function(n){var o=t(n);return!!o&&(o.isLoading||o.hasLoadedPreviously||o.hasError)}},e)}var Gre=f(()=>{"use strict";s();k()});var NM,MM,LM,HM,ss,bp,qre=f(()=>{"use strict";s();HM=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r]},ss=typeof console<"u"?console:void 0,bp={trace:((NM=ss==null?void 0:ss.trace)!==null&&NM!==void 0?NM:HM).bind(ss),warn:((MM=ss==null?void 0:ss.warn)!==null&&MM!==void 0?MM:HM).bind(ss),table:((LM=ss==null?void 0:ss.table)!==null&&LM!==void 0?LM:HM).bind(ss)}});var Kre=f(()=>{"use strict";s();qre()});function PRe(e){return typeof e=="symbol"||Bs(e)&&Ls(e)==ERe}var ERe,Mh,Q_=f(()=>{"use strict";s();gg();Sg();ERe="[object Symbol]";Mh=PRe});function _Re(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var Lh,X_=f(()=>{"use strict";s();Lh=_Re});function Qre(e){if(typeof e=="string")return e;if(en(e))return Lh(e,Qre)+"";if(Mh(e))return $re?$re.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Yre,$re,Xre,Jre=f(()=>{"use strict";s();mg();X_();Xa();Q_();Yre=bi?bi.prototype:void 0,$re=Yre?Yre.toString:void 0;Xre=Qre});function RRe(e){return e}var Zre,ene=f(()=>{"use strict";s();Zre=RRe});function ARe(){}var tne,rne=f(()=>{"use strict";s();tne=ARe});var kRe,BM,nne=f(()=>{"use strict";s();cl();kRe=function(){try{var e=Wi(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),BM=kRe});function DRe(e,t,r,n){for(var o=e.length,a=r+(n?1:-1);n?a--:++a<o;)if(t(e[a],a,e))return a;return-1}var one,ine=f(()=>{"use strict";s();one=DRe});function wRe(e){return e!==e}var ane,sne=f(()=>{"use strict";s();ane=wRe});function FRe(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var dne,cne=f(()=>{"use strict";s();dne=FRe});function ORe(e,t,r){return t===t?dne(e,t,r):one(e,ane,r)}var une,lne=f(()=>{"use strict";s();ine();sne();cne();une=ORe});function NRe(e,t){var r=e==null?0:e.length;return!!r&&une(e,t,0)>-1}var fne,pne=f(()=>{"use strict";s();lne();fne=NRe});function MRe(e,t,r){t=="__proto__"&&BM?BM(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Nl,xx=f(()=>{"use strict";s();nne();Nl=MRe});function BRe(e,t,r){var n=e[t];(!(HRe.call(e,t)&&fg(n,r))||r===void 0&&!(t in e))&&Nl(e,t,r)}var LRe,HRe,mne,gne=f(()=>{"use strict";s();xx();PE();LRe=Object.prototype,HRe=LRe.hasOwnProperty;mne=BRe});function URe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var hne,yne=f(()=>{"use strict";s();hne=URe});function WRe(e){if(!Hs(e))return hne(e);var t=qE(e),r=[];for(var n in e)n=="constructor"&&(t||!jRe.call(e,n))||r.push(n);return r}var VRe,jRe,Cne,vne=f(()=>{"use strict";s();hg();d1();yne();VRe=Object.prototype,jRe=VRe.hasOwnProperty;Cne=WRe});function zRe(e){return fl(e)?GE(e,!0):Cne(e)}var xne,Tne=f(()=>{"use strict";s();s1();vne();cv();xne=zRe});function KRe(e,t){if(en(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Mh(e)?!0:qRe.test(e)||!GRe.test(e)||t!=null&&e in Object(t)}var GRe,qRe,Hh,J_=f(()=>{"use strict";s();Xa();Q_();GRe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qRe=/^\w*$/;Hh=KRe});function UM(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(YRe);var r=function n(){var o=arguments,a=t?t.apply(this,o):o[0],d=n.cache;if(d.has(a))return d.get(a);var c=e.apply(this,o);return n.cache=d.set(a,c)||d,c};return r.cache=new(UM.Cache||Vf),r}var YRe,bne,Sne=f(()=>{"use strict";s();DE();YRe="Expected a function";UM.Cache=Vf;bne=UM});function QRe(e){var t=bne(e,function(n){return r.size===$Re&&r.clear(),n}),r=t.cache;return t}var $Re,Ine,Ene=f(()=>{"use strict";s();Sne();$Re=500;Ine=QRe});var XRe,JRe,ZRe,Pne,_ne=f(()=>{"use strict";s();Ene();XRe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,JRe=/\\(\\)?/g,ZRe=Ine(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(XRe,function(r,n,o,a){t.push(o?a.replace(JRe,"$1"):n||r)}),t}),Pne=ZRe});function eAe(e){return e==null?"":Xre(e)}var Z_,VM=f(()=>{"use strict";s();Jre();Z_=eAe});function tAe(e,t){return en(e)?e:Hh(e,t)?[e]:Pne(Z_(e))}var Ml,Tx=f(()=>{"use strict";s();Xa();J_();_ne();VM();Ml=tAe});function rAe(e){if(typeof e=="string"||Mh(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var ac,Bh=f(()=>{"use strict";s();Q_();ac=rAe});function nAe(e,t){t=Ml(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[ac(t[r++])];return r&&r==n?e:void 0}var Uh,eR=f(()=>{"use strict";s();Tx();Bh();Uh=nAe});function oAe(e,t,r){var n=e==null?void 0:Uh(e,t);return n===void 0?r:n}var Rne,Ane=f(()=>{"use strict";s();eR();Rne=oAe});function iAe(e){return en(e)||Ig(e)||!!(kne&&e&&e[kne])}var kne,Dne,wne=f(()=>{"use strict";s();mg();VE();Xa();kne=bi?bi.isConcatSpreadable:void 0;Dne=iAe});function Fne(e,t,r,n,o){var a=-1,d=e.length;for(r||(r=Dne),o||(o=[]);++a<d;){var c=e[a];t>0&&r(c)?t>1?Fne(c,t-1,r,n,o):bg(o,c):n||(o[o.length]=c)}return o}var tR,jM=f(()=>{"use strict";s();LE();wne();tR=Fne});function aAe(e){var t=e==null?0:e.length;return t?tR(e,1):[]}var WM,One=f(()=>{"use strict";s();jM();WM=aAe});var sAe,Nne,Mne=f(()=>{"use strict";s();c1();sAe=KE(Object.getPrototypeOf,Object),Nne=sAe});function dAe(e){return function(t){return e==null?void 0:e[t]}}var Lne,Hne=f(()=>{"use strict";s();Lne=dAe});var cAe,uAe,Bne,Une=f(()=>{"use strict";s();Hne();cAe={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},uAe=Lne(cAe),Bne=uAe});function mAe(e){return e=Z_(e),e&&e.replace(lAe,Bne).replace(pAe,"")}var lAe,fAe,pAe,rR,Vne=f(()=>{"use strict";s();Une();VM();lAe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fAe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",pAe=RegExp(fAe,"g");rR=mAe});var gAe,hAe,jne,Wne=f(()=>{"use strict";s();LE();Mne();t1();e1();gAe=Object.getOwnPropertySymbols,hAe=gAe?function(e){for(var t=[];e;)bg(t,UE(e)),e=Nne(e);return t}:BE,jne=hAe});function yAe(e){return HE(e,xne,jne)}var zne,Gne=f(()=>{"use strict";s();ZF();Wne();Tne();zne=yAe});function CAe(e,t,r,n){var o=r.length,a=o,d=!n;if(e==null)return!a;for(e=Object(e);o--;){var c=r[o];if(d&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){c=r[o];var u=c[0],l=e[u],p=c[1];if(d&&c[2]){if(l===void 0&&!(u in e))return!1}else{var g=new xg;if(n)var h=n(l,p,u,e,t,g);if(!(h===void 0?_g(p,l,3,n,g):h))return!1}}return!0}var qne,Kne=f(()=>{"use strict";s();KF();JE();qne=CAe});function vAe(e){return e===e&&!Hs(e)}var nR,zM=f(()=>{"use strict";s();hg();nR=vAe});function xAe(e){for(var t=Uc(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,nR(o)]}return t}var Yne,$ne=f(()=>{"use strict";s();zM();uv();Yne=xAe});function TAe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var oR,GM=f(()=>{"use strict";s();oR=TAe});function bAe(e){var t=Yne(e);return t.length==1&&t[0][2]?oR(t[0][0],t[0][1]):function(r){return r===e||qne(r,e,t)}}var Qne,Xne=f(()=>{"use strict";s();Kne();$ne();GM();Qne=bAe});function SAe(e,t){return e!=null&&t in Object(e)}var Jne,Zne=f(()=>{"use strict";s();Jne=SAe});function IAe(e,t,r){t=Ml(t,e);for(var n=-1,o=t.length,a=!1;++n<o;){var d=ac(t[n]);if(!(a=e!=null&&r(e,d)))break;e=e[d]}return a||++n!=o?a:(o=e==null?0:e.length,!!o&&Pg(o)&&Eg(d,o)&&(en(e)||Ig(e)))}var eoe,toe=f(()=>{"use strict";s();Tx();VE();Xa();jE();WE();Bh();eoe=IAe});function EAe(e,t){return e!=null&&eoe(e,t,Jne)}var roe,noe=f(()=>{"use strict";s();Zne();toe();roe=EAe});function PAe(e,t){return Hh(e)&&nR(t)?oR(ac(e),t):function(r){var n=Rne(r,e);return n===void 0&&n===t?roe(r,e):_g(t,n,3)}}var ooe,ioe=f(()=>{"use strict";s();JE();Ane();noe();J_();zM();GM();Bh();ooe=PAe});function _Ae(e){return function(t){return t==null?void 0:t[e]}}var aoe,soe=f(()=>{"use strict";s();aoe=_Ae});function RAe(e){return function(t){return Uh(t,e)}}var doe,coe=f(()=>{"use strict";s();eR();doe=RAe});function AAe(e){return Hh(e)?aoe(ac(e)):doe(e)}var uoe,loe=f(()=>{"use strict";s();soe();coe();J_();Bh();uoe=AAe});function kAe(e){return typeof e=="function"?e:e==null?Zre:typeof e=="object"?en(e)?ooe(e[0],e[1]):Qne(e):uoe(e)}var ds,Sp=f(()=>{"use strict";s();Xne();ioe();ene();Xa();loe();ds=kAe});function DAe(e,t,r,n){for(var o=-1,a=e==null?0:e.length;++o<a;){var d=e[o];t(n,d,r(d),e)}return n}var foe,poe=f(()=>{"use strict";s();foe=DAe});function wAe(e){return function(t,r,n){for(var o=-1,a=Object(t),d=n(t),c=d.length;c--;){var u=d[e?c:++o];if(r(a[u],u,a)===!1)break}return t}}var moe,goe=f(()=>{"use strict";s();moe=wAe});var FAe,hoe,yoe=f(()=>{"use strict";s();goe();FAe=moe(),hoe=FAe});function OAe(e,t){return e&&hoe(e,t,Uc)}var iR,qM=f(()=>{"use strict";s();yoe();uv();iR=OAe});function NAe(e,t){return function(r,n){if(r==null)return r;if(!fl(r))return e(r,n);for(var o=r.length,a=t?o:-1,d=Object(r);(t?a--:++a<o)&&n(d[a],a,d)!==!1;);return r}}var Coe,voe=f(()=>{"use strict";s();cv();Coe=NAe});var MAe,aR,KM=f(()=>{"use strict";s();qM();voe();MAe=Coe(iR),aR=MAe});function LAe(e,t,r,n){return aR(e,function(o,a,d){t(n,o,r(o),d)}),n}var xoe,Toe=f(()=>{"use strict";s();KM();xoe=LAe});function HAe(e,t){return function(r,n){var o=en(r)?foe:xoe,a=t?t():{};return o(r,e,ds(n,2),a)}}var sR,YM=f(()=>{"use strict";s();poe();Toe();Sp();Xa();sR=HAe});function BAe(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var boe,Soe=f(()=>{"use strict";s();boe=BAe});function UAe(e,t){var r=-1,n=fl(e)?Array(e.length):[];return aR(e,function(o,a,d){n[++r]=t(o,a,d)}),n}var Ioe,Eoe=f(()=>{"use strict";s();KM();cv();Ioe=UAe});function VAe(e,t){var r=en(e)?Lh:Ioe;return r(e,ds(t,3))}var Poe,_oe=f(()=>{"use strict";s();X_();Sp();Eoe();Xa();Poe=VAe});function jAe(e,t){return tR(Poe(e,t),1)}var $M,Roe=f(()=>{"use strict";s();jM();_oe();$M=jAe});var WAe,zAe,GAe,QM,Aoe=f(()=>{"use strict";s();xx();YM();WAe=Object.prototype,zAe=WAe.hasOwnProperty,GAe=sR(function(e,t,r){zAe.call(e,r)?e[r].push(t):Nl(e,r,[t])}),QM=GAe});var qAe,bx,koe=f(()=>{"use strict";s();xx();YM();qAe=sR(function(e,t,r){Nl(e,r,t)}),bx=qAe});function KAe(e,t){var r={};return t=ds(t,3),iR(e,function(n,o,a){Nl(r,o,t(n,o,a))}),r}var XM,Doe=f(()=>{"use strict";s();xx();qM();Sp();XM=KAe});function $Ae(e){if(typeof e!="function")throw new TypeError(YAe);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var YAe,woe,Foe=f(()=>{"use strict";s();YAe="Expected a function";woe=$Ae});function QAe(e,t,r,n){if(!Hs(e))return e;t=Ml(t,e);for(var o=-1,a=t.length,d=a-1,c=e;c!=null&&++o<a;){var u=ac(t[o]),l=r;if(u==="__proto__"||u==="constructor"||u==="prototype")return e;if(o!=d){var p=c[u];l=n?n(p,u,c):void 0,l===void 0&&(l=Hs(p)?p:Eg(t[o+1])?[]:{})}mne(c,u,l),c=c[u]}return e}var Ooe,Noe=f(()=>{"use strict";s();gne();Tx();jE();hg();Bh();Ooe=QAe});function XAe(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var d=t[n],c=Uh(e,d);r(c,d)&&Ooe(a,Ml(d,e),c)}return a}var Moe,Loe=f(()=>{"use strict";s();eR();Noe();Tx();Moe=XAe});function JAe(e,t){if(e==null)return{};var r=Lh(zne(e),function(n){return[n]});return t=ds(t),Moe(e,r,function(n,o){return t(n,o[0])})}var Sx,JM=f(()=>{"use strict";s();X_();Sp();Loe();Gne();Sx=JAe});function ZAe(e,t){return Sx(e,woe(ds(t)))}var ZM,Hoe=f(()=>{"use strict";s();Sp();Foe();JM();ZM=ZAe});var eke,tke,Boe,Uoe=f(()=>{"use strict";s();l1();rne();ME();eke=1/0,tke=pl&&1/Tg(new pl([,-0]))[1]==eke?function(e){return new pl(e)}:tne,Boe=tke});function nke(e,t,r){var n=-1,o=fne,a=e.length,d=!0,c=[],u=c;if(r)d=!1,o=boe;else if(a>=rke){var l=t?null:Boe(e);if(l)return Tg(l);d=!1,o=OE,u=new FE}else u=t?[]:c;e:for(;++n<a;){var p=e[n],g=t?t(p):p;if(p=r||p!==0?p:0,d&&g===g){for(var h=u.length;h--;)if(u[h]===g)continue e;t&&u.push(g),c.push(p)}else o(u,g,r)||(u!==c&&u.push(g),c.push(p))}return c}var rke,Voe,joe=f(()=>{"use strict";s();YF();pne();Soe();$F();Uoe();ME();rke=200;Voe=nke});function oke(e,t){return e&&e.length?Voe(e,ds(t,2)):[]}var dR,Woe=f(()=>{"use strict";s();Sp();joe();dR=oke});var sc=f(()=>{"use strict";s();Vne();Roe();One();Aoe();p1();koe();uv();Doe();Hoe();JM();Woe();});function ake(e){if(e){if(typeof e=="object"||typeof e=="function")return e;r2[e]||(r2[e]={val:e})}else return ike;return r2[e]}function n2(){return{map:o2?new o2:null}}var e2,t2,ike,r2,o2,to,i2=f(()=>{"use strict";s();k();Kre();sc();e2=typeof __WHY_DID_YOU_RECOMPUTE__<"u"&&__WHY_DID_YOU_RECOMPUTE__||typeof globalThis<"u"&&globalThis.__WHY_DID_YOU_RECOMPUTE__,t2=0,ike={empty:!0},r2={},o2=typeof WeakMap>"u"?null:WeakMap,to=function(t,r){if(r===void 0&&(r=100),!o2)return t;var n=n2(),o=0,a=t2,d=e2?new Map:void 0,c=e2?new Error("Memoized function defined").stack:"";return function(){for(var l,p,g,h,x=[],y=0;y<arguments.length;y++)x[y]=arguments[y];var T=n;(a!==t2||r>0&&o>r)&&(n=n2(),o=0,a=t2,d==null||d.clear()),T=n;for(var b=function(P){var _=ake(x[P]);if(!(!((l=T.map)===null||l===void 0)&&l.has(_))&&((p=T.map)===null||p===void 0||p.set(_,n2()),e2&&d)){var D=(g=d.get(T))!==null&&g!==void 0?g:[],O=D.filter(function(G){return G!==_&&Vc(G,_)}),H=O[0];if(H){bp.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var V=new Error("Indentical argument passed").stack,M=function G(K,z){bp.table(K),Object.keys(K).forEach(function($){var q=K[$],re=z[$];q!==re&&Vc(q,re)&&(bp.warn("Duplication present in child prop '".concat($,"'")),G(q,re))})};M(H,_),bp.warn(V),bp.warn(c)}d.set(T,w(w([],j(D),!1),[_],!1))}T=(h=T.map)===null||h===void 0?void 0:h.get(_)},S=0;S<x.length;S++)b(S);return T.hasOwnProperty("value")||(T.value=t.apply(void 0,w([],j(x),!1)),o++),T.value}}});function cR(e){var t,r,n={};try{for(var o=qe(ske(e)),a=o.next();!a.done;a=o.next()){var d=a.value,c=e[d];if(typeof c=="function"){var u=c;n[d]=to(u.bind(n))}else n[d]=c}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}var ske,zoe=f(()=>{"use strict";s();k();i2();ske=Object.keys});var Goe=f(()=>{"use strict";s();i2()});function Ix(e){return typeof e=="string"?Object.keys(e.split("")):typeof e=="number"||typeof e=="boolean"?[]:Object.keys(e)}var a2=f(()=>{"use strict";s()});function dc(e,t){return t}var qoe=f(()=>{"use strict";s()});function d2(e){return dke(e,function(t){return t!=null&&t!==""&&(!(t instanceof Array)||t.length>0)})}function dke(e,t){if(e==null)return e;for(var r={},n=0,o=Ix(e);n<o.length;n++){var a=o[n];t(e[a])&&(r[a]=e[a])}return r}function rd(e,t){return Object.assign({},e,t)}function nu(e,t){return e.hasOwnProperty(t)}var Koe=f(()=>{"use strict";s();a2();qoe()});var Yoe=f(()=>{"use strict";s();zoe()});function uR(e,t){var r=Ix(e),n=r.sort(function(a,d){return t(a.toString()).localeCompare(t(d.toString()))}),o={};return n.forEach(function(a){o[a]=e[a]}),o}var $oe=f(()=>{"use strict";s();a2()});var Ta=f(()=>{"use strict";s();Goe();Koe();Yoe();$oe()});var c2,Qoe=f(()=>{"use strict";s();c2=function(e){return typeof e=="function"}});var lR,Xoe=f(()=>{"use strict";s();lR=function(e){return e}});var u2,Joe=f(()=>{"use strict";s();u2=function(e){return e===null}});function fR(e,t,r){t===void 0&&(t=lR),(0,Zoe.default)(c2(t)||u2(t),"Expected payloadCreator to be a function, undefined or null");var n=u2(t)||t===lR?lR:function(c){for(var u=arguments.length,l=new Array(u>1?u-1:0),p=1;p<u;p++)l[p-1]=arguments[p];return c instanceof Error?c:t.apply(void 0,[c].concat(l))},o=c2(r),a=e.toString(),d=function(){var u=n.apply(void 0,arguments),l={type:e};return u instanceof Error&&(l.error=!0),u!==void 0&&(l.payload=u),o&&(l.meta=r.apply(void 0,arguments)),l};return d.toString=function(){return a},d}var Zoe,eie=f(()=>{"use strict";s();Zoe=I(fO());Qoe();Xoe();Joe()});var tie=f(()=>{"use strict";s();eie()});function fke(e){if(!e)return[void 0,void 0];var t=e.logger,r=je(e,["logger"]);return[r,t]}function oie(e,t){nie[e]=t}function l2(e,t){return function(r){return function(n){return function(o){var a=o,d=nie[a.type],c=lke[a.type],u=t.eventNames&&t.eventNames[a.type],l=!!(d!==void 0||u);if(l){var p=d&&a.payload!==void 0?d(a.payload,t):void 0;if(p!==null){var g=fke(p),h=g[0],x=g[1],y=c&&a.meta&&a.meta.metaPayload?c(a.meta.metaPayload,t):{},T=m(m({},h),y);rie&&rie(T);var b=a.meta&&a.meta.featureName||"None",S=a.meta&&a.meta.exportOptions||void 0;(x||e).logTrace({eventId:u||a.type,featureName:b,exportOptions:S,properties:T})}}return n(o)}}}}var nie,lke,rie,f2=f(()=>{"use strict";s();k();nie={},lke={};rie=void 0});function ro(e,t){oie(e,t.getLogProperties||null);var r=fR(e,function(n){return n},function(){return{featureName:t.featureName,exportOptions:t.exportOptions||null}});return r}var pR=f(()=>{"use strict";s();tie();f2()});var p2,Ex,iie,aie=f(()=>{"use strict";s();pR();p2="selectors",Ex="stores",iie=ro("LOAD_STATE",{featureName:"NoLogging"})});function m2(e,t){var r,n;if(t&&t[Ex])throw new Error("The '".concat(Ex,"' key of the state tree is reserved for functional stores."));if(t&&t[p2])throw new Error("The '".concat(p2,"' key of the state tree is reserved for debug output from selectors."));var o=XM(QM(e,function(u){return u.name}),function(u){return u[0].reducer}),a=Oh(uR(o,function(u){return u})),d=Oh(m((r={},r[Ex]=a,r),t||{})),c=(n={},n[Ex]={},n);return function(u,l){return l.type===iie.toString()?l.payload:d(u||c,l)}}var sie=f(()=>{"use strict";s();k();Ta();sc();Ol();aie()});var g2,Lqt,die=f(()=>{"use strict";s();pR();g2="ReduxStateJanitorStartedAction",Lqt=ro(g2,{featureName:"NoLogging"})});function ou(){var e={},t={};return{handlePayload:function(n,o){var a=n.toString();if(e[a]||t[a])throw new Error("Already handling an action type named ".concat(a));return e[a]=o,this},handleAction:function(n,o){var a=n.toString();if(e[a]||t[a])throw new Error("Already handling an action type named ".concat(a));return t[a]=o,this},done:function(n,o){var a=m({},e),d=m({},t);return function(c,u){if(c===void 0&&(c=n),u.type===g2)return o?o(c):n;var l=a[u.type];if(l)c=l(c,u.payload);else{var p=d[u.type];p&&(c=p(c,u))}return c}}}}var cie=f(()=>{"use strict";s();k();die()});function Vh(e,t){if(e===t||uie(e)&&uie(t))return!0;if(!e||!t)return!1;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Vh(e[r],t[r]))return!1;return!0}else if(Array.isArray(e)||Array.isArray(t))return!1;if(Object.prototype.toString.call(e)==="[object Date]"&&Object.prototype.toString.call(t)==="[object Date]")return e.getTime()===t.getTime();if(typeof e=="object"&&typeof t=="object"){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(!Vh(e[a],t[a]))return!1}for(var d=0,c=Object.keys(t);d<c.length;d++){var a=c[d];if(!(a in e))return!1}return!0}return!1}var uie,lie=f(()=>{"use strict";s();uie=function(t){return t!==t}});function fie(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function h2(e,t){if(fie(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!pke.call(t,r[o])||!fie(e[r[o]],t[r[o]]))return!1;return!0}var pke,pie=f(()=>{"use strict";s();pke=Object.prototype.hasOwnProperty});function mie(e,t){var r=e.name;return _n(function(n){return ic.get(n.stores,r)||e.initialState},function(n){return cR(t(n))})}var gie=f(()=>{"use strict";s();Ta();Pm();FM()});function iu(e,t,r){var n=t(void 0,{type:void 0}),o=mie({name:e,initialState:n},r);return{name:e,initialState:n,reducer:t,getSelectors:o}}var hie=f(()=>{"use strict";s();gie()});var cs=f(()=>{"use strict";s();Wre();DM();FM();Gre();cie();lie();pie();pR();f2();hie();sie()});var yie,mR,gR,hR,yR=f(()=>{"use strict";s();cs();yie=ro("AdditionalSuggestionsRequestedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"AdditionalSuggestionsRequested"}}),mR=ro("QueryChangedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"QueryChange"},getLogProperties:function(t){return{queryLength:t.query.length.toString()}}}),gR=ro("QueryFinishedAction",{featureName:"NoLogging"}),hR=ro("PickerDismissedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"DismissPicker"},getLogProperties:function(t){return{dismissalReason:t.dismissalReason,queryLength:t.queryLength.toString(),suggestionsShown:t.suggestionsShown.toString()}}})});var mke,CR,y2=f(()=>{"use strict";s();cs();mke=ro("SuggestionListShownAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"SuggestionListShown"}}),CR=ro("SuggestionPressedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"PressPerson"},getLogProperties:function(t){return{suggestionSource:t.suggestionSource,suggestionOrigin:t.suggestionOrigin,queryLength:t.queryLength.toString(),suggestionsShown:t.suggestionsShown.toString(),pickedSuggestionIndex:t.pickedSuggestionIndex.toString()}}})});var C2=Re((IKt,Px)=>{s();function gke(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Px.exports=gke,Px.exports.__esModule=!0,Px.exports.default=Px.exports});var Cie=Re((PKt,_x)=>{s();var hke=C2();function yke(e){if(Array.isArray(e))return hke(e)}_x.exports=yke,_x.exports.__esModule=!0,_x.exports.default=_x.exports});var vie=Re((RKt,Rx)=>{s();function Cke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}Rx.exports=Cke,Rx.exports.__esModule=!0,Rx.exports.default=Rx.exports});var v2=Re((kKt,Ax)=>{s();var xie=C2();function vke(e,t){if(e){if(typeof e=="string")return xie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xie(e,t)}}Ax.exports=vke,Ax.exports.__esModule=!0,Ax.exports.default=Ax.exports});var Tie=Re((wKt,kx)=>{s();function xke(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}kx.exports=xke,kx.exports.__esModule=!0,kx.exports.default=kx.exports});var x2=Re((OKt,Dx)=>{s();var Tke=Cie(),bke=vie(),Ske=v2(),Ike=Tie();function Eke(e){return Tke(e)||bke(e)||Ske(e)||Ike()}Dx.exports=Eke,Dx.exports.__esModule=!0,Dx.exports.default=Dx.exports});function Pke(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(Math.random()*16);return e}function _ke(){var e=new Uint8Array(31);return window.crypto.getRandomValues(e),e}function T2(){return typeof window=="object"&&window.crypto&&_ke()||Pke()}var bie=f(()=>{"use strict";s()});function Vo(){for(var e=T2(),t=0,r="",n=0;n<36;n++)switch(n){case 8:case 13:case 18:case 23:{t+=1,r+="-";break}case 14:{t+=1,r+="4";break}case 19:{r+=(e[n-t]%4+8).toString(16);break}default:{r+=(e[n-t]%16).toString(16);break}}return r}var wx=f(()=>{"use strict";s();bie()});var Sie=f(()=>{"use strict";s()});var Iie=f(()=>{"use strict";s()});var Rke,zKt,Eie=f(()=>{"use strict";s();Rke=function(){function e(){}return e.prototype.flush=function(){return Promise.resolve()},e.prototype.success=function(t,r){},e.prototype.expectedFailure=function(t,r){},e.prototype.unexpectedFailure=function(t,r){},e}(),zKt=function(){function e(){}return e.prototype.startMonitor=function(t,r,n){return new Rke},e.prototype.logEvent=function(){},e.prototype.logUserInteractionEvent=function(){},e.prototype.logError=function(){},e.prototype.logTrace=function(){},e.prototype.logEUPL=function(){},e.prototype.flush=function(){return Promise.resolve()},e.prototype.setEventHub=function(){},e.prototype.getStaticProperties=function(){return function(){return{}}},e.prototype.setStaticProperties=function(){},e.prototype.registerErrors=function(){},e}()});var Pie=f(()=>{"use strict";s()});var Zi,b2=f(()=>{"use strict";s();Zi={clientScenario:"ClientScenario",feature:"Feature",dataLayerErrorPropName:"DataLayerError",statusCode:"StatusCode",requestId:"RequestId",retryAttemptedAfterAuthFailure:"RetryAttemptedAfterAuthFailure",retryLimitExceeded:"RetryLimitExceeded",personaType:"personaType",hintedPersonaType:"hintedPersonaType",personaId:"personaId",midgardError:"midgardError"}});function Dr(e){return typeof e=="object"&&!!e&&nu(e,"family")&&nu(e,"code")&&typeof e.family=="string"&&typeof e.code=="number"}var _ie=f(()=>{"use strict";s();Ta()});var cc=f(()=>{"use strict";s();_ie()});function S2(e){var t=vR();return{stop:function(){try{jh&&jh.measure&&jh.measure(e,t)}catch(n){}}}}function vR(){if(!jh||!jh.mark||!Math||!Math.random)return"";var e="Midgard Mark ".concat(Math.random());return jh.mark(e),e}var jh,I2=f(()=>{"use strict";s();jh=typeof window<"u"&&window.performance});var xR,Fx,E2,Ake,P2=f(()=>{"use strict";s();I2();xR=function(){function e(t,r){this.timestamp=t,this.markName=r,this.privateFieldToPreventCastFromJsPlainObjects=42,this.privateFieldToPreventCastFromJsPlainObjects}return e.create=function(){return new e(Date.now(),vR())},e.createStart=function(t){return new e(t,"start")},e.NullInstance=new e(-1,""),e}(),Fx=xR.NullInstance,E2=xR.create,Ake=xR.createStart});var _2=f(()=>{"use strict";s();P2();I2()});function Ip(e){var t,r,n=e.scenarioName,o=e.featureName,a=e.operation,d=e.monitorStarter,c=e.requestId,u=e.extraProps,l=e.extraLogPropsOnFinish,p=e.successAction,g=e.errorAction,h=e.treatAsSuccessCondition,x=e.treatAsExpectedError,y=e.skipTrace,T=m(m(m({},u),(t={},t[Zi.feature]=o,t)),c?(r={},r[Zi.requestId]=c,r):{}),b=y?void 0:S2("\u{1F680} data call : ".concat(n)),S=d.startMonitor(n,o,T),E=typeof l=="function"?{success:l,failure:l}:l,P=a();return P.then(function(_){return b==null||b.stop(),_}).then(function(_){return Rie({monitor:S,result:_,extraProps:m(m({},T),E==null?void 0:E.success(_)),successAction:p})},function(_){return kke({monitor:S,failure:_,extraProps:m(m({},T),E==null?void 0:E.failure(_)),successAction:p,errorAction:g,treatAsSuccessCondition:h,treatAsExpectedError:x})}).catch(function(_){S.unexpectedFailure("FailedDispatch",{Error:_.toString(),featureName:o})}),P}function Rie(e){var t=e.monitor,r=e.result,n=e.extraProps,o=e.successAction;t.success(void 0,n),o&&o(r,n)}function kke(e){var t,r,n,o,a=e.monitor,d=e.failure,c=e.extraProps,u=e.successAction,l=e.errorAction,p=e.treatAsSuccessCondition,g=e.treatAsExpectedError,h=m(m(m(m(m({},c),d&&d.statusCode?(t={},t[Zi.statusCode]=d.statusCode.toString(),t):{}),d&&Dr(d.midgardError)?(r={},r[Zi.midgardError]=d.midgardError,r):{}),d&&d.retryAttemptedAfterAuthFailure?(n={},n[Zi.retryAttemptedAfterAuthFailure]=d.retryAttemptedAfterAuthFailure.toString(),n):{}),d&&d.retryLimitExceeded?(o={},o[Zi.retryLimitExceeded]=d.retryLimitExceeded.toString(),o):{});if(p&&p(d)){Rie({monitor:a,result:void 0,extraProps:h,successAction:u});return}else d&&d.isExpected||g&&g(d)?a.expectedFailure(d.qosTagId,h):a.unexpectedFailure(d?d.qosTagId:"Unknown",h);l&&l(d)}var Aie=f(()=>{"use strict";s();k();cc();_2();b2()});var Wh=f(()=>{"use strict";s();Sie();Iie();Eie();Pie();b2();Aie()});function TR(e,t){return ro(e,{featureName:t,getLogProperties:function(n,o){return o.logDataScenarioActions?{}:null}})}function bR(e,t,r){return{success:function(o){return m(m(m({},e.success&&e.success(o)),e.fromParameters&&e.fromParameters(r)),e.fromOptions&&e.fromOptions(t))},failure:function(o){return m(m(m({},e.failure&&e.failure(o)),e.fromParameters&&e.fromParameters(r)),e.fromOptions&&e.fromOptions(t))}}}function R2(e,t,r,n){var o=this,a=function(c,u,l){return Gt(o,void 0,void 0,function(){var p,g,h,x,y,T,b,S;return gt(this,function(E){return p=c.monitorStarter,g=c.treatAsExpectedError,h=c.clientScenario,x=c.hostAppApp,y=u.requestId,T=u.storeKey,b=function(){return r(c,{requestId:y,storeKey:T,clientScenario:h,hostAppApp:x},l)},[2,Ip({scenarioName:t,featureName:e,requestId:y,monitorStarter:p,extraProps:h?(S={},S[Zi.clientScenario]=h,S):void 0,treatAsExpectedError:g,extraLogPropsOnFinish:n&&bR(n,c,l),operation:b})]})})};return SR(e,t,a)}function SR(e,t,r){var n=this,o=TR("".concat(t,"StartedAction"),"DataLoadStartAction"),a=TR("".concat(t,"SucceededAction"),e),d=TR("".concat(t,"FailedAction"),e),c=TR("".concat(t,"ResetAction"),e),u=function(p,g,h){return Gt(n,void 0,void 0,function(){var x,y,T,b,S,E,P,_,D;return gt(this,function(O){switch(O.label){case 0:x=p.dispatch,y=p.clientScenario,T=p.processResponse,b=p.hostAppApp,S=Vo(),x(o({storeKey:g,requestId:S,parameters:h,timestamp:Date.now()})),O.label=1;case 1:return O.trys.push([1,5,,6]),P=function(V){var M=function(K){var z={storeKey:g,requestId:S,parameters:h,response:K,timestamp:Date.now()};return x(a(z)),E={resolved:!0,value:z},E};return T?(E={resolved:!1,promise:T(V).then(function(G){return M(G).value})},E):M(V)},[4,r(p,{requestId:S,storeKey:g,clientScenario:y,hostAppApp:b},h,P)];case 2:return _=O.sent(),E||(E=P(_)),E.resolved?[3,4]:[4,E.promise];case 3:return[2,O.sent()];case 4:return[2,E.value];case 5:throw D=O.sent(),x(d({storeKey:g,requestId:S,parameters:h,error:Dke(D),timestamp:Date.now()})),D;case 6:return[2]}})})};return{fetch:u,startAction:o,successAction:a,errorAction:d,resetAction:c,scenarioName:t}}function Dke(e){var t,r,n,o,a;return e?typeof e=="string"?n=e:(typeof e.isExpected=="boolean"&&(t=e.isExpected),typeof e.qosTagId=="string"&&(r=e.qosTagId),typeof e.message=="string"&&(n=e.message),typeof e.statusCode=="number"&&(o=e.statusCode),typeof e.responseText=="string"&&(a=e.responseText)):n=e+"",{qosTagId:r,isExpected:t,message:n,statusCode:o,responseText:a}}function A2(e){var t=this,r=[],n=function(a,d,c){var u=JSON.stringify({storeKey:d,parameters:c}),l=r.find(function(x){return u===x.key&&h2(a,x.options)});if(l&&l.promise)return l.promise;var p=function(){return Gt(t,void 0,void 0,function(){var y;return gt(this,function(T){switch(T.label){case 0:return T.trys.push([0,,2,3]),[4,e.fetch(a,d,c)];case 1:return[2,T.sent()];case 2:return y=r.indexOf(h),r.splice(y,1),[7];case 3:return[2]}})})},g=p(),h={options:a,promise:g,key:u};return r.push(h),g};return m(m({},e),{fetch:n})}var kie=f(()=>{"use strict";s();k();wx();cs();Wh()});function wke(e,t){return Vh(e.response,t.response)?e.response:t.response}function zh(e,t,r){r===void 0&&(r=wke);var n=function(p){return function(g,h){var x=h.payload.storeKey.key,y=ic.get(g,x)||wie,T=p(y,h.payload);return(y.isCallInProgress!==T.isCallInProgress||y.response!==T.response||!Vh(y.error,T.error))&&(g=ic.insert(g,x,T)),g}},o=n(function(l,p){return m(m({},l),{isCallInProgress:!0,hasStarted:!0})}),a=n(function(l,p){return m(m({},l),{isCallInProgress:!1,error:m(m({},p.error),{requestId:p.requestId})})}),d=n(function(l,p){return m(m({},l),{isCallInProgress:!1,response:r(l,p),error:null,successTimestamp:p.timestamp})}),c=n(function(l,p){return m(m({},l),{isCallInProgress:!1,response:null,error:null})}),u=ou().handleAction(t.startAction,o).handleAction(t.errorAction,a).handleAction(t.successAction,d).handleAction(t.resetAction,c).done(null);return iu(e,u,Die)}var Die,wie,Fie=f(()=>{"use strict";s();k();cs();Die=function(t){return OM({getLatestSuccess:function(n){var o=ic.get(t,n.key);return o&&o.response||void 0},getLatestSuccessWithTimestamp:function(n){var o=ic.get(t,n.key);return{response:o&&o.response||void 0,timestamp:o&&o.successTimestamp||0}},getLatestError:function(n){var o=ic.get(t,n.key);return o&&o.error||void 0}},function(r){var n=ic.get(t,r.key);return{isLoading:!!(n!=null&&n.isCallInProgress),hasError:!!(n!=null&&n.error),hasLoadedPreviously:!!(n!=null&&n.response)}})},wie={hasStarted:!1,response:null,error:null,isCallInProgress:!1,successTimestamp:0}});var IR=f(()=>{"use strict";s();kie();Fie()});var Fke,Oke,k2,Ox,ER=f(()=>{"use strict";s();IR();Fke=function(t,r,n){return n.getHostAppSuggestions(n.query,n.options)},Oke={success:function(t){return{responseLength:t?t.length.toString():"0"}},fromParameters:function(t){var r,n;return{queryLength:((r=t.query)===null||r===void 0?void 0:r.length.toString())||"0",didSearchDirectory:((n=t.options)===null||n===void 0?void 0:n.searchDirectory)||"false"}}},k2=R2("PickerHostAppSuggestions","GetHostAppSuggestions",Fke,Oke),Ox=zh("HostAppSuggestionsStore",k2)});function _R(e){return Oie(e).then(Nie)}function Oie(e){var t=e.scenarioName,r=e.featureName,n=e.operation,o=e.monitorStarter,a=e.requestId,d=e.extraProps,c=e.extraLogPropsOnFinish,u=e.successAction,l=u===void 0?function(){}:u,p=e.errorAction,g=e.treatAsSuccessCondition,h=e.treatAsExpectedError,x=e.wrapWithLogging,y=typeof c=="function"?{success:c,failure:c}:c,T=function(){return n().then(Nke)},b=x?function(){return x(T)}:T;return Ip({operation:b,scenarioName:t,featureName:r,extraProps:d,monitorStarter:o,requestId:a,extraLogPropsOnFinish:{success:function(E){return m(m({},y&&y.success(E)),Lke(E))},failure:function(E){return m(m({},y&&y.failure(E)),Mie(E.headers))}},successAction:function(E,P){return l(E&&Nie(E),P)},errorAction:p,treatAsSuccessCondition:g,treatAsExpectedError:h})}function Nke(e){return Mke(e,e.Headers)}function Nie(e){return e.parsedResponse}function Mke(e,t){var r=t==null?void 0:t[PR];return m(m({},e),r?{debug:{traceId:r}}:{})}function Lke(e){var t=e.additionalRequestInformation?e.additionalRequestInformation.didMakeAuthTokenRequest:!1,r=e.additionalRequestInformation?e.additionalRequestInformation.durationWaitingOnAuthToken.toString():"0",n=e.additionalRequestInformation?e.additionalRequestInformation.didMakeConfigRequest:!1,o=e.RequestDurationFromEvents?"".concat(e.RequestDurationFromEvents):void 0;return m(m({},Mie(e.Headers)),{didMakeAuthTokenRequest:t,durationWaitingOnAuthToken:r,didMakeConfigRequest:n,eventDuration:o})}function Mie(e){if(!e)return{};var t="x-inboundduration",r="x-beserver",n="x-serverversion",o="x-datacenter",a="x-websocketcorrelationid",d="iswebsocketrequest",c="x-azure-ref",u={};if(e[t]&&(u[t]=e[t]),e[r]&&(u[r]=e[r]),e[n]&&(u[n]=e[n]),e[PR]&&(u[PR]=e[PR]),e[o]&&(u[o]=e[o]),u[d]=e[a]?"1":"0",e[c]){var l=Hke(e[c]);l&&(u[c]=e[c],u["".concat(c,"-EdgeLocation")]=l[0],u["".concat(c,"-EdgeRequestId")]=l[1])}return u}function Hke(e){if(!e||!e.trim())return null;try{var t=atob(e.substring(1)).substring(24);return/^([\dA-Za-z]+)\0([\d-A-Za-z]{36})$/.test(t)?t.split("\0"):null}catch(r){return null}}var PR,D2=f(()=>{"use strict";s();k();Wh();PR="x-correlationid"});function Bke(e,t,r){var n=bR(e,t,r);return{success:function(a){return n.success(a.parsedResponse)},failure:n.failure}}function w2(e,t,r){return Uke(e,t,_R,r)}function Uke(e,t,r,n){var o=this,a=n&&n.debounce||!1,d=n&&n.httpMethod||"Get",c=n&&n.logPropertyExtractors,u="".concat(d).concat(e),l=function(h,x,y){return Gt(o,void 0,void 0,function(){var T,b,S,E,P,_,D,O,H;return gt(this,function(V){return T=h.monitorStarter,b=h.lokiRestProvider,S=h.treatAsExpectedError,E=h.clientScenario,P=h.wrapWithLogging,_=x.requestId,D=x.hostAppApp,O=function(){return t(b,{requestId:_,clientScenario:E,hostAppApp:D},y)},[2,r({scenarioName:u,featureName:e,requestId:_,monitorStarter:T,treatAsExpectedError:S,extraProps:E?(H={},H[Zi.clientScenario]=E,H):void 0,extraLogPropsOnFinish:c&&Bke(c,x,y),operation:O,wrapWithLogging:P})]})})},p=SR(e,u,l);return a?A2(p):p}var Lie=f(()=>{"use strict";s();k();IR();Wh();D2()});var F2=Re((e$t,Nx)=>{s();function Hie(e,t,r,n,o,a,d){try{var c=e[a](d),u=c.value}catch(l){r(l);return}c.done?t(u):Promise.resolve(u).then(n,o)}function Vke(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function d(u){Hie(a,n,o,d,c,"next",u)}function c(u){Hie(a,n,o,d,c,"throw",u)}d(void 0)})}}Nx.exports=Vke,Nx.exports.__esModule=!0,Nx.exports.default=Nx.exports});var O2=f(()=>{"use strict";s()});var Uie=f(()=>{"use strict";s();O2()});function Ep(e){return{family:jke,code:e}}var jke,au,N2=f(()=>{"use strict";s();jke="caching-request";(function(e){e[e.CACHE_MISS=0]="CACHE_MISS",e[e.EXPIRED=1]="EXPIRED",e[e.VERSION_MISMATCH=2]="VERSION_MISMATCH",e[e.UNKNOWN_ERROR=3]="UNKNOWN_ERROR"})(au||(au={}))});var Vie=Re((c$t,Mx)=>{s();function Wke(e){if(Array.isArray(e))return e}Mx.exports=Wke,Mx.exports.__esModule=!0,Mx.exports.default=Mx.exports});var jie=Re((l$t,Lx)=>{s();function zke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,a,d,c=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(p){l=!0,o=p}finally{try{if(!u&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(l)throw o}}return c}}Lx.exports=zke,Lx.exports.__esModule=!0,Lx.exports.default=Lx.exports});var Wie=Re((p$t,Hx)=>{s();function Gke(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Hx.exports=Gke,Hx.exports.__esModule=!0,Hx.exports.default=Hx.exports});var RR=Re((g$t,Bx)=>{s();var qke=Vie(),Kke=jie(),Yke=v2(),$ke=Wie();function Qke(e,t){return qke(e)||Kke(e,t)||Yke(e,t)||$ke()}Bx.exports=Qke,Bx.exports.__esModule=!0,Bx.exports.default=Bx.exports});var Xke,M2,Jke,ba,zie=f(()=>{"use strict";s();Xke=ee(),M2=Xke.NativeModules,Jke=M2.PlatformLocalStorage||M2.RNC_AsyncSQLiteDBStorage||M2.RNCAsyncStorage,ba=Jke});function Gh(e,t){var r=arguments.length>1;if(typeof e!="string"&&console.warn("[AsyncStorage] Using ".concat(typeof e," type for key is not supported. This can lead to unexpected behavior/errors. Use string instead.\nKey passed: ").concat(e,"\n")),r&&typeof t!="string"){if(t==null)throw new Error("[AsyncStorage] Passing null/undefined as value is not supported. If you want to remove value, Use .remove method instead.\nPassed value: ".concat(t,"\nPassed key: ").concat(e,"\n"));console.warn('[AsyncStorage] The value for key "'.concat(e,'" is not a string. This can lead to unexpected behavior/errors. Consider stringifying it.\nPassed value: ').concat(t,"\nPassed key: ").concat(e,"\n"))}}function Pp(e){return!e||Array.isArray(e)&&e.length===0?null:(Array.isArray(e)?e:[e]).map(function(t){return B2(t)})}function B2(e){if(!e)return null;var t=new Error(e.message);return t.key=e.key,t}var L2,H2,U2,V2=f(()=>{"use strict";s();L2=I(RR());zie();if(!ba)throw new Error("[@RNC/AsyncStorage]: NativeModule: AsyncStorage is null.\n\nTo fix this issue try these steps:\n\n  \u2022 Run `react-native link @react-native-community/async-storage` in the project root.\n\n  \u2022 Rebuild and restart the app.\n\n  \u2022 Run the packager with `--reset-cache` flag.\n\n  \u2022 If you are using CocoaPods on iOS, run `pod install` in the `ios` directory and then rebuild and re-run the app.\n\n  \u2022 If this happens while testing with Jest, check out docs how to integrate AsyncStorage with it: https://react-native-community.github.io/async-storage/docs/advanced/jest\n\nIf none of these fix the issue, please open an issue on the Github repository: https://github.com/react-native-community/react-native-async-storage/issues \n");H2={_getRequests:[],_getKeys:[],_immediate:null,getItem:function(t,r){return new Promise(function(n,o){Gh(t),ba.multiGet([t],function(a,d){var c=d&&d[0]&&d[0][1]?d[0][1]:null,u=Pp(a);r&&r(u&&u[0],c),u?o(u[0]):n(c)})})},setItem:function(t,r,n){return new Promise(function(o,a){Gh(t,r),ba.multiSet([[t,r]],function(d){var c=Pp(d);n&&n(c&&c[0]),c?a(c[0]):o(null)})})},removeItem:function(t,r){return new Promise(function(n,o){Gh(t),ba.multiRemove([t],function(a){var d=Pp(a);r&&r(d&&d[0]),d?o(d[0]):n(null)})})},mergeItem:function(t,r,n){return new Promise(function(o,a){Gh(t,r),ba.multiMerge([[t,r]],function(d){var c=Pp(d);n&&n(c&&c[0]),c?a(c[0]):o(null)})})},clear:function(t){return new Promise(function(r,n){ba.clear(function(o){var a=B2(o);t&&t(a),a?n(a):r(null)})})},getAllKeys:function(t){return new Promise(function(r,n){ba.getAllKeys(function(o,a){var d=B2(o);t&&t(d,a),d?n(d):r(a)})})},flushGetRequests:function(){var t=this._getRequests,r=this._getKeys;this._getRequests=[],this._getKeys=[],ba.multiGet(r,function(n,o){var a={};o&&o.forEach(function(g){var h=(0,L2.default)(g,2),x=h[0],y=h[1];return a[x]=y,y});for(var d=t.length,c=0;c<d;c++){var u=t[c],l=u.keys,p=l.map(function(g){return[g,a[g]]});u.callback&&u.callback(null,p),u.resolve&&u.resolve(p)}})},multiGet:function(t,r){var n=this;this._immediate||(this._immediate=setImmediate(function(){n._immediate=null,n.flushGetRequests()}));var o={keys:t,callback:r,keyIndex:this._getKeys.length,resolve:null,reject:null},a=new Promise(function(d,c){o.resolve=d,o.reject=c});return this._getRequests.push(o),t.forEach(function(d){n._getKeys.indexOf(d)===-1&&n._getKeys.push(d)}),a},multiSet:function(t,r){return new Promise(function(n,o){t.forEach(function(a){var d=(0,L2.default)(a,2),c=d[0],u=d[1];Gh(c,u)}),ba.multiSet(t,function(a){var d=Pp(a);r&&r(d),d?o(d):n(null)})})},multiRemove:function(t,r){return new Promise(function(n,o){t.forEach(function(a){return Gh(a)}),ba.multiRemove(t,function(a){var d=Pp(a);r&&r(d),d?o(d):n(null)})})},multiMerge:function(t,r){return new Promise(function(n,o){ba.multiMerge(t,function(a){var d=Pp(a);r&&r(d),d?o(d):n(null)})})}};ba.multiMerge||(delete H2.mergeItem,delete H2.multiMerge);U2=H2});var Gie=f(()=>{"use strict";s();V2()});var j2,qie=f(()=>{"use strict";s();V2();Gie();j2=U2});function $ie(e,t,r){return Kie(this,void 0,void 0,function(){var n;return Yie(this,function(o){return n=Xie(e,r),[2,j2.setItem(n,t)]})})}function Qie(e,t){return Kie(this,void 0,void 0,function(){var r,n;return Yie(this,function(o){switch(o.label){case 0:return r=Xie(e,t),[4,j2.getItem(r)];case 1:return n=o.sent(),[2,Zke(n)]}})})}function Zke(e){return e===null?void 0:e}function Xie(e,t){return"".concat(t,"_").concat(e)}var Kie,Yie,Jie=f(()=>{"use strict";s();qie();Kie=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},Yie=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});function kR(e,t,r){var n=AR.get(r)||new Map;n.set(e,t),AR.set(r,n)}function DR(e,t){var r=AR.get(t);return r?r.get(e):void 0}function W2(e,t){var r=AR.get(t);r&&r.delete(e)}var AR,z2=f(()=>{"use strict";s();AR=new Map});function eae(e,t){try{window.sessionStorage&&window.sessionStorage.setItem(e,t)}catch(r){}}function tae(e){try{if(window.sessionStorage){var t=window.sessionStorage.getItem(e);return t===null?void 0:t}return}catch(r){return}}function rae(e){try{window.sessionStorage&&window.sessionStorage.removeItem(e)}catch(t){}}var nae=f(()=>{"use strict";s()});function wR(e,t,r){kR(e,t,r),eae(e,t)}function FR(e,t){var r=tae(e);return r!==void 0?r:DR(e,t)}function OR(e,t){W2(e,t),rae(e)}var oae=f(()=>{"use strict";s();z2();nae()});function iae(e,t){return oDe(this,void 0,void 0,function(){var r,n,o;return iDe(this,function(a){switch(a.label){case 0:return r=DR(t,e),r?[2,JSON.parse(r)]:[3,1];case 1:return a.trys.push([1,3,,4]),[4,Qie(t,e)];case 2:return n=a.sent(),n?[2,JSON.parse(n)]:[3,4];case 3:throw o=a.sent(),Dr(o)?o:sDe;case 4:throw aDe}})})}function aae(e,t,r,n){var o={version:r,data:n,dateAdded:Date.now()},a=JSON.stringify(o);kR(t,a,e),$ie(t,a,e)}var oDe,iDe,qh,aDe,sDe,sae=f(()=>{"use strict";s();cc();Jie();N2();z2();oDe=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},iDe=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},qh="TTLCacheUtils",aDe={isExpected:!0,qosTagId:qh,midgardError:Ep(au.CACHE_MISS)},sDe={isExpected:!1,qosTagId:qh,midgardError:Ep(au.UNKNOWN_ERROR)}});function dae(e,t,r,n){var o="pending_".concat(r,"_").concat(e,"_").concat(t),a=NR.get(o);return a||new Promise(function(d,c){var u=n();NR.set(o,u),u.then(function(l){NR.delete(o),d(l)}).catch(function(l){NR.delete(o),c(l)})})}function dDe(e,t){return G2(this,void 0,void 0,function(){var r;return q2(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return n.sent(),t.logEvent({eventId:"Cache TTR updated successfully"}),[3,3];case 2:return r=n.sent(),[3,3];case 3:return[2]}})})}function K2(e){return G2(this,void 0,void 0,function(){var t,r,n,o,a,d,c,u,l,p,g,h,x,y,T,b,S,E,P=this;return q2(this,function(_){switch(_.label){case 0:t=e.id,r=e.logger,n=e.cacheKey,o=e.version,a=e.ttlMs,d=e.fallbackCallback,c=e.rateLimiter,u=e.ttrMs,l=function(){return dae(t,n,"getItem",function(){return iae(t,n)})},p=function(){return dae(t,n,"fallback",function(){return G2(P,void 0,void 0,function(){var O,H;return q2(this,function(V){switch(V.label){case 0:return V.trys.push([0,5,,6]),O=void 0,c?[4,c.executeWithThrottling(d,"".concat(t,"_").concat(n))]:[3,2];case 1:return O=V.sent(),[3,4];case 2:return[4,d()];case 3:O=V.sent(),V.label=4;case 4:return aae(t,n,o,O),r.logEvent({eventId:"Fallback success and setting value"}),[2,O];case 5:throw H=V.sent(),r.logError({eventId:"Fallback failure, skipping cache update."}),H;case 6:return[2]}})})})},g=void 0,h=!1,_.label=1;case 1:return _.trys.push([1,3,,4]),r.logEvent({eventId:"Cache access start"}),[4,l()];case 2:return x=_.sent(),x.version===o?(y=Date.now(),y<=x.dateAdded+a?(u!==void 0&&y>=x.dateAdded+u&&dDe(p(),r),r.logEvent({eventId:"Obtained from cache"}),g=x.data):(h=!0,r.logEvent({eventId:"Cache has expired"}))):r.logEvent({eventId:"Cache has mismatching version"}),[3,4];case 3:return T=_.sent(),r.logEvent({eventId:"Cache miss or failure"}),[3,4];case 4:if(g)return[3,9];_.label=5;case 5:return _.trys.push([5,7,,8]),[4,p()];case 6:return b=_.sent(),[2,{value:b,fetchedFromCache:!1,fetchedFromFallback:!0}];case 7:throw S=_.sent(),Dr(S==null?void 0:S.midgardError)?S:(E={isExpected:!1,qosTagId:qh,midgardError:Ep(au.UNKNOWN_ERROR),cacheExpired:h,innerException:S},E);case 8:return[3,10];case 9:return[2,{value:g,fetchedFromCache:!0,fetchedFromFallback:!1}];case 10:return[2]}})})}var G2,q2,$$t,Q$t,NR,cae=f(()=>{"use strict";s();cc();N2();sae();G2=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},q2=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},$$t={isExpected:!0,qosTagId:qh,midgardError:Ep(au.VERSION_MISMATCH)},Q$t={isExpected:!0,qosTagId:qh,midgardError:Ep(au.EXPIRED)},NR=new Map});var Y2=f(()=>{"use strict";s();cae();oae()});function uae(e,t){window.setTimeout(function(){return e()},t)}var lae=f(()=>{"use strict";s()});var Ux,Vx,fae=f(()=>{"use strict";s();lae();Ux="Rate limit reached",Vx=function(){function e(t,r){this.rateLimit=t,this.slidingWindowDuration=r,this.currentRate=0,this.throttledRetryAfter=new Map}return e.prototype.updateRateLimit=function(){var t=this;this.currentRate++,uae(function(){return t.currentRate=Math.max(t.currentRate-1,0)},this.slidingWindowDuration)},e.prototype.execute=function(t){if(this.currentRate>=this.rateLimit)throw new Error(Ux);this.updateRateLimit(),t()},e.prototype.executeWithThrottling=function(t,r){var n=this,o=this.currentRate>=this.rateLimit,a;if(!o&&r&&(a=this.throttledRetryAfter.get(r),o=a&&a>Date.now()||!1),o)throw new Error(Ux);return this.updateRateLimit(),r?new Promise(function(d,c){var u=t();u.then(function(l){a!==void 0&&r&&n.throttledRetryAfter.delete(r),d(l)}).catch(function(l){var p,g="Retry-After";if(l.statusCode===429&&(!((p=l.headers)===null||p===void 0)&&p[g])){var h=Number(l.headers[g]);if(!Object.is(h,NaN)&&h>0){var x=Date.now()+h*1e3;n.throttledRetryAfter.set(r,x)}}c(l)})}):t()},e}()});var uc=f(()=>{"use strict";s();Ta();wx();fae()});function cDe(e){return function(t){return t in e}}function $2(e){return e.family===jx&&e.code in W?e.code:void 0}function oe(e){return{family:jx,code:e}}function Q2(e){e(jx,W)}var jx,W,pae,MR=f(()=>{"use strict";s();jx="auth-token";(function(e){e[e.AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE=0]="AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE",e[e.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS=1]="AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS",e[e.EXPECTED_ERROR=2]="EXPECTED_ERROR",e[e.EXPECTED_TOKEN_INVALIDATED_ERROR=3]="EXPECTED_TOKEN_INVALIDATED_ERROR",e[e.GET_AUTH_TOKEN_TIMEOUT=4]="GET_AUTH_TOKEN_TIMEOUT",e[e.INVALID_AUTH_TOKEN=5]="INVALID_AUTH_TOKEN",e[e.GENERIC_TOKEN_ERROR=6]="GENERIC_TOKEN_ERROR",e[e.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED=7]="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED",e[e.BAD_REFRESH_TOKEN=8]="BAD_REFRESH_TOKEN",e[e.CONDITIONAL_ACCESS_BLOCKED=9]="CONDITIONAL_ACCESS_BLOCKED",e[e.PRECONDITION_VIOLATED=10]="PRECONDITION_VIOLATED",e[e.POLICY_REQUIRED_ERROR=11]="POLICY_REQUIRED_ERROR",e[e.DEVICE_CONNECTION_IS_NOT_AVAILABLE=12]="DEVICE_CONNECTION_IS_NOT_AVAILABLE",e[e.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN=13]="BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN",e[e.TIMEOUT_FETCHING_TOKEN=14]="TIMEOUT_FETCHING_TOKEN",e[e.NO_RESPONSE_FROM_SERVICE=15]="NO_RESPONSE_FROM_SERVICE",e[e.TIMEOUT_ERROR=16]="TIMEOUT_ERROR",e[e.NO_NETWORK_AVAILABLE=17]="NO_NETWORK_AVAILABLE",e[e.AD_ERROR_CACHE_BAD_FORMAT=18]="AD_ERROR_CACHE_BAD_FORMAT",e[e.AD_ERROR_CACHE_MULTIPLE_USERS=19]="AD_ERROR_CACHE_MULTIPLE_USERS",e[e.AD_ERROR_CACHE_NO_REFRESH_TOKEN=20]="AD_ERROR_CACHE_NO_REFRESH_TOKEN",e[e.AD_ERROR_CACHE_VERSION_MISMATCH=21]="AD_ERROR_CACHE_VERSION_MISMATCH",e[e.AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT=22]="AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT",e[e.AD_ERROR_SERVER_AUTHORIZATION_CODE=23]="AD_ERROR_SERVER_AUTHORIZATION_CODE",e[e.AD_ERROR_SERVER_INVALID_ID_TOKEN=24]="AD_ERROR_SERVER_INVALID_ID_TOKEN",e[e.AD_ERROR_SERVER_INVALID_RESPONSE=25]="AD_ERROR_SERVER_INVALID_RESPONSE",e[e.AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER=26]="AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER",e[e.AD_ERROR_SERVER_NON_HTTPS_REDIRECT=27]="AD_ERROR_SERVER_NON_HTTPS_REDIRECT",e[e.AD_ERROR_SERVER_OAUTH=28]="AD_ERROR_SERVER_OAUTH",e[e.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED=29]="AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED",e[e.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED=30]="AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED",e[e.AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED=31]="AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED",e[e.AD_ERROR_SERVER_UNSUPPORTED_REQUEST=32]="AD_ERROR_SERVER_UNSUPPORTED_REQUEST",e[e.AD_ERROR_SERVER_USER_INPUT_NEEDED=33]="AD_ERROR_SERVER_USER_INPUT_NEEDED",e[e.AD_ERROR_SERVER_WPJ_REQUIRED=34]="AD_ERROR_SERVER_WPJ_REQUIRED",e[e.AD_ERROR_SERVER_WRONG_USER=35]="AD_ERROR_SERVER_WRONG_USER",e[e.AD_ERROR_TOKENBROKER_BAD_RESUME_STATE=36]="AD_ERROR_TOKENBROKER_BAD_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_DECRYPTION_FAILED=37]="AD_ERROR_TOKENBROKER_DECRYPTION_FAILED",e[e.AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY=38]="AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY",e[e.AD_ERROR_TOKENBROKER_HASH_MISSING=39]="AD_ERROR_TOKENBROKER_HASH_MISSING",e[e.AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI=40]="AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI",e[e.AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE=41]="AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NO_RESUME_STATE=42]="AD_ERROR_TOKENBROKER_NO_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE=43]="AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE",e[e.AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION=44]="AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION",e[e.AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH=45]="AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH",e[e.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED=46]="AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED",e[e.AD_ERROR_TOKENBROKER_UNKNOWN=47]="AD_ERROR_TOKENBROKER_UNKNOWN",e[e.AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER=48]="AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER",e[e.AD_ERROR_UI_NOT_ON_MAIN_THREAD=49]="AD_ERROR_UI_NOT_ON_MAIN_THREAD",e[e.AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION=50]="AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION",e[e.AD_ERROR_UI_USER_CANCEL=51]="AD_ERROR_UI_USER_CANCEL",e[e.AD_ERROR_UNEXPECTED=52]="AD_ERROR_UNEXPECTED",e[e.AD_ERROR_DEVELOPER_INVALID_ARGUMENT=53]="AD_ERROR_DEVELOPER_INVALID_ARGUMENT",e[e.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION=54]="AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION",e[e.kCFURLErrorTimedOut=55]="kCFURLErrorTimedOut",e[e.kCFURLErrorCannotFindHost=56]="kCFURLErrorCannotFindHost",e[e.kCFURLErrorCannotConnectToHost=57]="kCFURLErrorCannotConnectToHost",e[e.kCFURLErrorNetworkConnectionLost=58]="kCFURLErrorNetworkConnectionLost",e[e.kCFURLErrorNotConnectedToInternet=59]="kCFURLErrorNotConnectedToInternet",e[e.kCFURLErrorInternationalRoamingOff=60]="kCFURLErrorInternationalRoamingOff",e[e.kCFURLErrorCallIsActive=61]="kCFURLErrorCallIsActive",e[e.kCFURLErrorDataNotAllowed=62]="kCFURLErrorDataNotAllowed",e[e.kCFURLErrorSecureConnectionFailed=63]="kCFURLErrorSecureConnectionFailed",e[e.UNKNOWN_ERROR=64]="UNKNOWN_ERROR",e[e.UNKNOWN_200_ERROR=65]="UNKNOWN_200_ERROR",e[e.UNKNOWN_203_ERROR=66]="UNKNOWN_203_ERROR",e[e.UNKNOWN_STRING_ERROR=67]="UNKNOWN_STRING_ERROR",e[e.UNKNOWN_ERROR_CAUGHT_IN_PROMISE=68]="UNKNOWN_ERROR_CAUGHT_IN_PROMISE",e[e.BROKER_AUTHENTICATOR_NOT_RESPONDING=69]="BROKER_AUTHENTICATOR_NOT_RESPONDING",e[e.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION=70]="NO_NETWORK_CONNECTION_POWER_OPTIMIZATION",e[e.BROKER_AUTHENTICATOR_IO_EXCEPTION=71]="BROKER_AUTHENTICATOR_IO_EXCEPTION",e[e.IO_EXCEPTION=72]="IO_EXCEPTION",e[e.NO_ACCOUNTS_FOUND=73]="NO_ACCOUNTS_FOUND",e[e.DISALLOWED_MSA_ACCOUNT=74]="DISALLOWED_MSA_ACCOUNT",e[e.NO_M365_ACCOUNT=75]="NO_M365_ACCOUNT",e[e.NO_CREDENTIALS_FOUND=76]="NO_CREDENTIALS_FOUND",e[e.WIN32_UNKNOWN_ERROR=77]="WIN32_UNKNOWN_ERROR",e[e.WIN32_PERSONAJS_ERROR=78]="WIN32_PERSONAJS_ERROR",e[e.AUTH_RATE_LIMIT_EXCEEDED=79]="AUTH_RATE_LIMIT_EXCEEDED",e[e.INTERACTION_REQUIRED=80]="INTERACTION_REQUIRED",e[e.SERVER_DECLINED_SCOPES=81]="SERVER_DECLINED_SCOPES",e[e.USER_CANCELED=82]="USER_CANCELED",e[e.WORKPLACE_JOIN_REQUIRED=83]="WORKPLACE_JOIN_REQUIRED"})(W||(W={}));pae=cDe(W)});function J2(e,t){var r,n=FR(LR(t??""),e||"")||"",o=(r=FR(X2(t??""),e||""))!==null&&r!==void 0?r:"",a=parseInt(o,10),d=isFinite(a)?a:void 0;return{value:n,expiration:d}}function Z2(e,t,r,n){t&&(wR(LR(n??""),t,e||""),r&&wR(X2(n??""),r.toString(),e||""))}function eL(e,t){OR(LR(t??""),e||""),OR(X2(t??""),e||"")}function xae(e){return!!(e&&(typeof e=="string"||Object.keys(d2(e)).length))}function _p(e){return!!(Dr(e)&&$2(e)&&pDe[e.code])}function Wx(e){return!!(Dr(e)&&$2(e)&&(_p(e)||mDe[e.code]||gDe[e.code]))}function Tae(e,t,r){var n=void 0;if(t&&(t!=null&&t.userInfo.correlationId)?n={authRequestCorrelationId:t==null?void 0:t.userInfo.correlationId}:r&&(n={authRequestCorrelationId:r}),e&&typeof e=="object"){var o=parseInt(e.statusCode||"",10),a=parseInt(e.statusCode||"",10),d=parseInt(e.statusCode||"",10);n=m(m(m(m(m({},n),!isNaN(o)&&{statusCode:e.statusCode}||{}),!isNaN(a)&&{errorCode:e.errorCode}||{}),!isNaN(d)&&{protocolCode:e.protocolCode}||{}),e.headers&&e.headers["x-msedge-ref"]&&{traceId:hDe(e)}||{})}else t&&typeof t=="object"&&(n=m(m({},n),{errorCode:t.code}));return n}function hDe(e){var t,r=(t=e.headers)===null||t===void 0?void 0:t["x-msedge-ref"];return r&&r.substring(7,r.indexOf(" Ref B:"))}function mae(e,t,r){if(e)switch(e){case"100":return oe(W.AD_ERROR_DEVELOPER_INVALID_ARGUMENT);case"101":return oe(W.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION);case"203":return r==="interaction_required"&&t==="200"?oe(W.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED):oe(W.UNKNOWN_203_ERROR);case"200":return t==="200"?oe(W.AD_ERROR_SERVER_USER_INPUT_NEEDED):oe(W.UNKNOWN_200_ERROR);case"201":return oe(W.AD_ERROR_SERVER_WPJ_REQUIRED);case"202":return oe(W.AD_ERROR_SERVER_OAUTH);case"204":return oe(W.AD_ERROR_SERVER_WRONG_USER);case"205":return oe(W.AD_ERROR_SERVER_NON_HTTPS_REDIRECT);case"206":return oe(W.AD_ERROR_SERVER_INVALID_ID_TOKEN);case"207":return oe(W.AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER);case"208":return oe(W.AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT);case"209":return oe(W.AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED);case"210":return oe(W.AD_ERROR_SERVER_UNSUPPORTED_REQUEST);case"211":return oe(W.AD_ERROR_SERVER_AUTHORIZATION_CODE);case"212":return oe(W.AD_ERROR_SERVER_INVALID_RESPONSE);case"213":return oe(W.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED);case"300":return oe(W.AD_ERROR_CACHE_MULTIPLE_USERS);case"301":return oe(W.AD_ERROR_CACHE_VERSION_MISMATCH);case"302":return oe(W.AD_ERROR_CACHE_BAD_FORMAT);case"303":case"400":return oe(W.AD_ERROR_CACHE_NO_REFRESH_TOKEN);case"401":return oe(W.AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER);case"402":return oe(W.AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION);case"403":return oe(W.AD_ERROR_UI_USER_CANCEL);case"404":return oe(W.AD_ERROR_UI_NOT_ON_MAIN_THREAD);case"500":return oe(W.AD_ERROR_TOKENBROKER_UNKNOWN);case"501":return oe(W.AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI);case"502":return oe(W.AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH);case"503":return oe(W.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED);case"504":return oe(W.AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY);case"505":return oe(W.AD_ERROR_TOKENBROKER_DECRYPTION_FAILED);case"507":return oe(W.AD_ERROR_TOKENBROKER_NO_RESUME_STATE);case"508":return oe(W.AD_ERROR_TOKENBROKER_BAD_RESUME_STATE);case"509":return oe(W.AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE);case"510":return oe(W.AD_ERROR_TOKENBROKER_HASH_MISSING);case"511":return oe(W.AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION);case"PersonaJsError":case"RichApi.Error":return t==="InstanceNotFound"?oe(W.EXPECTED_ERROR):oe(W.WIN32_PERSONAJS_ERROR);case"SafePersonaJsError":return oe(W.WIN32_PERSONAJS_ERROR);case"UnknownWin32Error":return oe(W.WIN32_UNKNOWN_ERROR);case"Timeout: getting the token timed out":return oe(W.TIMEOUT_FETCHING_TOKEN);case"10001":return oe(W.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED);case"10013":return oe(W.AD_ERROR_SERVER_USER_INPUT_NEEDED);case"-1":return oe(W.AD_ERROR_UNEXPECTED);case"-1001":return oe(W.kCFURLErrorTimedOut);case"-1003":return oe(W.kCFURLErrorCannotFindHost);case"-1004":return oe(W.kCFURLErrorCannotConnectToHost);case"-1005":return oe(W.kCFURLErrorNetworkConnectionLost);case"-1009":return oe(W.kCFURLErrorNotConnectedToInternet);case"-1018":return oe(W.kCFURLErrorInternationalRoamingOff);case"-1019":return oe(W.kCFURLErrorCallIsActive);case"-1020":return oe(W.kCFURLErrorDataNotAllowed);case"-1200":return oe(W.kCFURLErrorSecureConnectionFailed);default:if(pae(e))return oe(W[e]);var n=parseInt(e,10);return!isNaN(n)&&{family:jx,code:1e4+n}||void 0}}function bae(e){var t,r;return typeof e=="string"?e.indexOf("AuthTokenInternetConnectionNotAvailable")>=0?oe(W.DEVICE_CONNECTION_IS_NOT_AVAILABLE):e.indexOf("AuthTokenDisabledConditionalAccess")>=0?oe(W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS):e==="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED"?oe(W.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED):e==="BAD_REFRESH_TOKEN"?oe(W.BAD_REFRESH_TOKEN):e==="CONDITIONAL_ACCESS_BLOCKED"?oe(W.CONDITIONAL_ACCESS_BLOCKED):e==="NO_RESPONSE_FROM_SERVICE"?oe(W.NO_RESPONSE_FROM_SERVICE):e==="PRECONDITION_VIOLATED"?oe(W.PRECONDITION_VIOLATED):oe(W.UNKNOWN_STRING_ERROR):(r=(t=mae(e.errorCode,e.statusCode,e.protocolCode))!==null&&t!==void 0?t:mae(e.protocolCode,e.statusCode,e.errorCode))!==null&&r!==void 0?r:oe(W.UNKNOWN_ERROR)}function Sae(e){switch(e.code){case"Unknown":return oe(W.UNKNOWN_ERROR);case"BadRefreshToken":return oe(W.BAD_REFRESH_TOKEN);case"ConditionalAccessBlocked":return oe(W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS);case"InteractionRequired":return oe(W.INTERACTION_REQUIRED);case"NoResponse":return oe(W.NO_RESPONSE_FROM_SERVICE);case"PreconditionViolated":return oe(W.PRECONDITION_VIOLATED);case"ServerDeclinedScopes":return oe(W.SERVER_DECLINED_SCOPES);case"ServerProtectionPoliciesRequired":return oe(W.POLICY_REQUIRED_ERROR);case"Timeout":return oe(W.TIMEOUT_FETCHING_TOKEN);case"UserCanceled":return oe(W.USER_CANCELED);case"WorkplaceJoinRequired":return oe(W.WORKPLACE_JOIN_REQUIRED);default:return oe(W.UNKNOWN_ERROR)}}function tL(){return new Vx(uDe,lDe)}var nd,gr,Ro,gae,hae,yae,uDe,lDe,Cae,vae,fDe,LR,X2,pDe,mDe,gDe,Kh=f(()=>{"use strict";s();k();Y2();Ta();uc();cc();MR();gae=12e4,hae=24e4,yae=3e4,uDe=10,lDe=3e5,Cae="relatedRootCorrelationId",vae="isForced",fDe="LokiAuthToken",LR=function(t){return"".concat(fDe).concat(t)},X2=function(t){return"EXP".concat(LR(t))};pDe=(nd={},nd[W.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED]=1,nd[W.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED]=1,nd[W.AD_ERROR_SERVER_USER_INPUT_NEEDED]=1,nd[W.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED]=1,nd[W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS]=1,nd[W.CONDITIONAL_ACCESS_BLOCKED]=1,nd[W.BAD_REFRESH_TOKEN]=1,nd[W.POLICY_REQUIRED_ERROR]=1,nd[W.PRECONDITION_VIOLATED]=1,nd),mDe=(gr={},gr[W.AD_ERROR_SERVER_INVALID_RESPONSE]=1,gr[W.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE]=1,gr[W.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN]=1,gr[W.BROKER_AUTHENTICATOR_IO_EXCEPTION]=1,gr[W.BROKER_AUTHENTICATOR_NOT_RESPONDING]=1,gr[W.DEVICE_CONNECTION_IS_NOT_AVAILABLE]=1,gr[W.GENERIC_TOKEN_ERROR]=1,gr[W.INTERACTION_REQUIRED]=1,gr[W.IO_EXCEPTION]=1,gr[W.kCFURLErrorCallIsActive]=1,gr[W.kCFURLErrorCannotConnectToHost]=1,gr[W.kCFURLErrorCannotFindHost]=1,gr[W.kCFURLErrorDataNotAllowed]=1,gr[W.kCFURLErrorInternationalRoamingOff]=1,gr[W.kCFURLErrorNetworkConnectionLost]=1,gr[W.kCFURLErrorNotConnectedToInternet]=1,gr[W.kCFURLErrorSecureConnectionFailed]=1,gr[W.kCFURLErrorTimedOut]=1,gr[W.NO_NETWORK_AVAILABLE]=1,gr[W.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION]=1,gr[W.NO_RESPONSE_FROM_SERVICE]=1,gr[W.SERVER_DECLINED_SCOPES]=1,gr[W.TIMEOUT_ERROR]=1,gr[W.TIMEOUT_FETCHING_TOKEN]=1,gr[W.USER_CANCELED]=1,gr[W.WORKPLACE_JOIN_REQUIRED]=1,gr),gDe=(Ro={},Ro[W.AD_ERROR_CACHE_NO_REFRESH_TOKEN]=1,Ro[W.AD_ERROR_SERVER_AUTHORIZATION_CODE]=1,Ro[W.AD_ERROR_SERVER_OAUTH]=1,Ro[W.AD_ERROR_SERVER_WPJ_REQUIRED]=1,Ro[W.AD_ERROR_SERVER_WRONG_USER]=1,Ro[W.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED]=1,Ro[W.AD_ERROR_TOKENBROKER_UNKNOWN]=1,Ro[W.AD_ERROR_UI_USER_CANCEL]=1,Ro[W.AD_ERROR_UNEXPECTED]=1,Ro[W.EXPECTED_ERROR]=1,Ro[W.EXPECTED_TOKEN_INVALIDATED_ERROR]=1,Ro[W.GET_AUTH_TOKEN_TIMEOUT]=1,Ro[W.AD_ERROR_CACHE_VERSION_MISMATCH]=1,Ro[W.AD_ERROR_CACHE_BAD_FORMAT]=1,Ro[W.AD_ERROR_DEVELOPER_INVALID_ARGUMENT]=1,Ro[W.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION]=1,Ro)});var Iae,Eae=f(()=>{"use strict";s();Iae=function(t){return!1}});var us,Pae,_ae=f(()=>{"use strict";s();us="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pae={encode:function(t){var r=[],n,o,a="",d,c,u,l="",p=0;do n=t.charCodeAt(p++),o=t.charCodeAt(p++),a=t.charCodeAt(p++),d=n>>2,c=(n&3)<<4|o>>4,u=(o&15)<<2|a>>6,l=a&63,isNaN(o)?u=l=64:isNaN(a)&&(l=64),r.push(us.charAt(d)+us.charAt(c)+us.charAt(u)+us.charAt(l)),n=o=a="",d=c=u=l="";while(p<t.length);return r.join("")},encodeFromByteArray:function(t){var r=[],n,o,a="",d,c,u,l="",p=0;do n=t[p++],o=t[p++],a=t[p++],d=n>>2,c=(n&3)<<4|o>>4,u=(o&15)<<2|a>>6,l=a&63,isNaN(o)?u=l=64:isNaN(a)&&(l=64),r.push(us.charAt(d)+us.charAt(c)+us.charAt(u)+us.charAt(l)),n=o=a="",d=c=u=l="";while(p<t.length);return r.join("")},decode:function(t){var r="",n,o,a="",d,c,u,l="",p=0,g=/[^A-Za-z0-9\+\/\=]/g;if(g.exec(t))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=us.indexOf(t.charAt(p++)),c=us.indexOf(t.charAt(p++)),u=us.indexOf(t.charAt(p++)),l=us.indexOf(t.charAt(p++)),n=d<<2|c>>4,o=(c&15)<<4|u>>2,a=(u&3)<<6|l,r=r+String.fromCharCode(n),u!=64&&(r=r+String.fromCharCode(o)),l!=64&&(r=r+String.fromCharCode(a)),n=o=a="",d=c=u=l="";while(p<t.length);return r}}});function rL(e){var t=e.length%4;return Pae.decode(t===3?e+"=":t===2?e+"==":e)}var Rae=f(()=>{"use strict";s();_ae()});var Aae=f(()=>{"use strict";s();Rae()});function kae(e){if(e)try{var t=e.split("."),r=t[1],n=rL(r),o=JSON.parse(n).exp;return o?o*1e3:void 0}catch(a){return}}var Dae=f(()=>{"use strict";s();Aae()});var yDe,zx,nL=f(()=>{"use strict";s();Kh();Eae();Dae();yDe=Number.MAX_SAFE_INTEGER-1,zx=function(){function e(t,r,n,o,a){this.value=t,this.featureName=r,this.logger=n;var d=function(){var l;return(l=kae(t))!==null&&l!==void 0?l:yDe},c=a?this.getExperimentalDefaultExpiryTimeEpoch():d();this.expirationTimeEpoch=o??c}return e.prototype.getExperimentalDefaultExpiryTimeEpoch=function(){return Date.now()+36e5},e.prototype.isApproachingExpiration=function(){return this.isValid()?Date.now()>this.expirationTimeEpoch-hae:!1},e.prototype.isValid=function(){return this.value?Iae(this.expirationTimeEpoch)?(this.logger&&this.logger.logError({eventId:"InvalidTokenExpirationValue",featureName:this.featureName,properties:{expiryTime:this.expirationTimeEpoch}}),!1):!(Date.now()>this.expirationTimeEpoch-gae):!1},e.prototype.getValue=function(){return this.value},e.prototype.getExpirationTimeEpoch=function(){return this.expirationTimeEpoch},e}()});var wae,Fae,Oae=f(()=>{"use strict";s();k();wae=function(t){return clearTimeout(t)},Fae=function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return setTimeout.apply(void 0,w([t,r],n,!1))}});function Nae(e){return e==="Df"?"Df":e==="Msit"?"Msit":e==="Prod"?"Prod":e==="Blackforest"?"Blackforest":e==="GccModerate"?"GccModerate":e==="GccHigh"?"GccHigh":e==="DoD"?"DoD":e==="Gallatin"?"Gallatin":e==="AG08"?"AG08":e==="AG09"?"AG09":"Unknown"}var Mae,Lae,Hae,oL=f(()=>{"use strict";s();Mae="LokiGetAuthToken",Lae="LokiGetAuthTokenFailed",Hae="LokiAuthTokenReceivedAfterTimeout"});var iL,Bae=f(()=>{"use strict";s();k();Ta();uc();Oae();cc();oL();nL();Kh();MR();iL=function(){function e(t){this.authTokenProviderState="Initial";var r=t.getAppId,n=t.refreshAuthToken,o=t.logger,a=t.runWithLogMonitor,d=t.authTokenType,c=t.featureName,u=t.storageKeySuffix,l=t.rateLimiter,p=l===void 0?tL():l,g=t.logUnknownErrorsForDogfoodUserOnlyFlightEnabled,h=t.dontStoreTokenInSessionStorage,x=t.isUseForceRefreshLokiTokenEnabled,y=t.retryConditionalAccessThresholdSeconds,T=t.onError;o&&Q2(o.registerErrors),this.getAppId=r,this.refreshAuthToken=n,this.logger=o,this.runWithLogMonitor=a,this.authTokenType=d||zx,this.featureName=c||"RESTAuthToken",this.storageKeySuffix=u,this.rateLimiter=p,this.logUnknownErrorsForDogfoodUserOnlyFlightEnabled=g,this.dontStoreTokenInSessionStorage=h,this.isUseForceRefreshLokiTokenEnabled=x,this.retryConditionalAccessThresholdSeconds=y,this.onError=T;var b=J2(this.getAppId(),this.storageKeySuffix);b!=null&&b.value&&(b!=null&&b.expiration)&&(this.authToken=new this.authTokenType(b.value,this.featureName,this.logger,b.expiration,this.isUseForceRefreshLokiTokenEnabled)),this.getAuthToken(void 0).catch(function(S){})}return e.prototype.getAuthToken=function(t){return Gt(this,void 0,void 0,function(){var r,n,o;return gt(this,function(a){switch(a.label){case 0:return this.isUseForceRefreshLokiTokenEnabled?this.authToken&&this.authToken.isValid()?this.authToken.isApproachingExpiration()?[4,this.forceRefreshAuthToken(t)]:[3,2]:[3,3]:[3,4];case 1:a.sent(),a.label=2;case 2:return[2,{token:this.authToken,request:{fromCache:!0,duration:0}}];case 3:return[3,5];case 4:if(r=this.checkAndGetAuthTokenIfValid(),r)return[2,{token:r,request:{fromCache:!0,duration:0}}];a.label=5;case 5:if(this.authTokenProviderState==="DisabledConditionalAccess"&&(n=!1,this.timestampOfLastConditionalAccessError&&this.retryConditionalAccessThresholdSeconds&&this.retryConditionalAccessThresholdSeconds>0&&(o=(Date.now()-this.timestampOfLastConditionalAccessError)/1e3,o>=this.retryConditionalAccessThresholdSeconds&&(this.invalidateAuthToken(),n=!0)),!n))throw{midgardError:oe(W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return[4,this.getAuthTokenPromise({relatedRootCorrelationId:t,isForced:!1})];case 6:return[2,a.sent()]}})})},e.prototype.invalidateAuthToken=function(){this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=void 0,this.timestampOfLastConditionalAccessError=void 0,eL(this.getAppId(),this.storageKeySuffix)},e.prototype.hasAuthToken=function(){return!!this.authToken},e.prototype.isTokenInvalidated=function(t){return t!==this.authPromise},e.prototype.forceRefreshAuthToken=function(t){return Gt(this,void 0,void 0,function(){var r,n;return gt(this,function(o){switch(o.label){case 0:if(this.authTokenProviderState==="DisabledConditionalAccess")throw{midgardError:oe(W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};o.label=1;case 1:return o.trys.push([1,4,,5]),this.authTokenProviderState==="RequestPending"?[3,3]:(r=this.authToken&&rd(this.authToken,{}),this.authToken=void 0,[4,this.getAuthTokenPromise({relatedRootCorrelationId:t,isForced:!0,existingToken:r})]);case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:return n=o.sent(),[3,5];case 5:return[2]}})})},e.prototype.updateAuthTokenTtl=function(t){this.authToken&&(this.authToken=new this.authTokenType(this.authToken.getValue(),this.featureName,this.logger,Date.now()+t*1e3,this.isUseForceRefreshLokiTokenEnabled),this.updateTokenCacheWithCurrentToken())},e.prototype.checkAndGetAuthTokenIfValid=function(){var t=this.authToken;if(t&&t.isValid())return t.isApproachingExpiration()&&this.getAuthTokenPromise({relatedRootCorrelationId:void 0,isForced:!1}).catch(function(){}),t},e.prototype.requestNewAuthToken=function(t){var r=this;return new Promise(function(n,o){var a=void 0,d=Fae(function(){a=Date.now(),o({midgardError:oe(W.GET_AUTH_TOKEN_TIMEOUT)})},yae);r.refreshAuthToken(function(c,u,l,p,g,h){var x,y,T,b,S=Tae(u,h,l);u?(x=r.onError)===null||x===void 0||x.call(r,u):h&&((y=r.onError)===null||y===void 0||y.call(r,h));var E=h?Sae(h):u&&xae(u)?bae(u):void 0;if(a){(T=r.logger)===null||T===void 0||T.logTrace({eventId:Hae,featureName:r.featureName,properties:m({hasToken:!!(c||g!=null&&g.accessToken),msAfterTimeout:Date.now()-a,midgardError:E},E?{error:JSON.stringify(m({midgardError:E,authTokenDisabled:r.authTokenProviderState==="DisabledConditionalAccess"},S))}:{})});return}if(wae(d),E)_p(E)?o({midgardError:E,extraLogProps:m(m({},S),{authTokenDisabledForThisSession:"true"})}):o({midgardError:E,extraLogProps:S});else if(!c&&!(g!=null&&g.accessToken))o({midgardError:oe(W.EXPECTED_ERROR),extraLogProps:S});else{var P=(g==null?void 0:g.expirationTime)&&(g==null?void 0:g.expirationTime)>0&&g.expirationTime*1e3||void 0,_=p&&Date.now()+p*1e3||P;_===void 0&&t&&((b=t.getValue)===null||b===void 0?void 0:b.call(t))===c&&(_=t.getExpirationTimeEpoch());var D=new r.authTokenType(g?g.accessToken:c,r.featureName,r.logger,_,r.isUseForceRefreshLokiTokenEnabled);n(D)}})})},e.prototype.getAuthTokenPromise=function(t){return Gt(this,void 0,void 0,function(){var r,n,o,a,d,c,u,l=this;return gt(this,function(p){switch(p.label){case 0:if(r=t.existingToken,n=t.isForced,o=t.relatedRootCorrelationId,this.authTokenProviderState==="DisabledConditionalAccess")throw{midgardError:oe(W.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return a=new Date().valueOf(),(!this.authPromise||this.authTokenProviderState!=="RequestPending")&&(this.authTokenProviderState="RequestPending",d=new Promise(function(g,h){var x=function(){var T;if(l.runWithLogMonitor){var b=void 0;o&&(b=(T={},T[Cae]=o,T[vae]=n.toString(),T)),l.runWithLogMonitor({scenarioName:Mae,featureName:l.featureName,operation:function(){return l.requestNewAuthToken(r)},extraLogPropsOnFinish:{success:function(){return{}},failure:function(E){var P=E.extraLogProps;return P||{}}},successAction:function(E){l.isTokenInvalidated(d)&&h({midgardError:oe(W.EXPECTED_TOKEN_INVALIDATED_ERROR)}),E?g({token:E,request:{fromCache:!1,duration:0}}):h({midgardError:oe(W.INVALID_AUTH_TOKEN)})},errorAction:function(E){return h(E)},treatAsExpectedError:function(E){var P=E.midgardError;return Wx(P)||!!navigator&&navigator.onLine===!1},extraProps:b})}else l.requestNewAuthToken(r).then(function(S){l.isTokenInvalidated(d)&&h({midgardError:oe(W.EXPECTED_TOKEN_INVALIDATED_ERROR)}),g({token:S,request:{fromCache:!1,duration:0}})}).catch(function(S){return h(S)})};try{l.rateLimiter.execute(x)}catch(y){y instanceof Error&&y.message===Ux?h({midgardError:oe(W.AUTH_RATE_LIMIT_EXCEEDED)}):h(y)}}).then(function(g){return l.onRefreshAuthTokenSuccess(g),g}).catch(function(g){if(l.logUnknownErrorsForDogfoodUserOnlyFlightEnabled&&typeof g=="object"&&g){var h=void 0,x=JSON.stringify(g,function(y,T){if(T instanceof Error){var b={};return Object.getOwnPropertyNames(T).forEach(function(S){b[S]=T[S]}),b}return T}).substring(0,50);nu(g,"extraLogProps")?h=m(m({},g.extraLogProps),{unknownErrorForDogfoodUserOnly:x}):h={unknownErrorForDogfoodUserOnly:x},g.extraLogProps=h}throw l.onRefreshAuthTokenError(typeof g=="object"&&g&&nu(g,"midgardError")&&Dr(g.midgardError)?g.midgardError:oe(W.UNKNOWN_ERROR_CAUGHT_IN_PROMISE),typeof g=="object"&&g&&nu(g,"extraLogProps")?g.extraLogProps:void 0),g}),this.authPromise=d),[4,this.authPromise];case 1:return c=p.sent(),u=Date.now(),[2,rd(c,{request:rd(c.request,{duration:u-a})})]}})})},e.prototype.updateTokenCacheWithCurrentToken=function(){this.authToken&&!this.dontStoreTokenInSessionStorage&&Z2(this.getAppId(),this.authToken.getValue()||"",this.authToken.getExpirationTimeEpoch(),this.storageKeySuffix)},e.prototype.onRefreshAuthTokenSuccess=function(t){this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=t.token,this.updateTokenCacheWithCurrentToken()},e.prototype.onRefreshAuthTokenError=function(t,r){var n;this.authTokenProviderState=_p(t)?"DisabledConditionalAccess":"Initial",this.authPromise=void 0,this.retryConditionalAccessThresholdSeconds&&this.retryConditionalAccessThresholdSeconds>0&&(this.timestampOfLastConditionalAccessError=Date.now());var o=JSON.stringify(m({midgardError:t,authTokenDisabled:this.authTokenProviderState==="DisabledConditionalAccess"},r)).replace(/\\n/g,"(LF)").replace(/\\r/g,"(CR)");(n=this.logger)===null||n===void 0||n.logError({eventId:Lae,featureName:this.featureName,properties:{midgardError:t,error:o}})},e}()});var aL=f(()=>{"use strict";s();Uie();O2();nL();Bae();Kh();MR()});var Uae=f(()=>{"use strict";s();aL()});var sL,Vae=f(()=>{"use strict";s();sL=!0});var jae=f(()=>{"use strict";s()});function HR(e){return{family:CDe,code:e}}var Yh,CDe,Wae=f(()=>{"use strict";s();(function(e){e[e.TIMEOUT=0]="TIMEOUT",e[e.CANCELLED=1]="CANCELLED",e[e.FAILED=2]="FAILED"})(Yh||(Yh={}));CDe="xml-http-request-executor"});function zae(e,t){if(!(!e||!t||t===0))return Math.ceil(t-e)}var Gae=f(()=>{"use strict";s()});function qae(){try{if(typeof CustomEvent=="function")return new CustomEvent("Event").timeStamp;if(typeof document<"u")return document.createEvent("Event").timeStamp}catch(e){}}var Kae=f(()=>{"use strict";s()});function Yae(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_".concat(t),statusCode:e.status,responseText:e.responseType!=="blob"?e.responseText:void 0,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:$ae(e.getAllResponseHeaders()),midgardError:HR(Yh.FAILED)}}function $ae(e){if(e){var t={},r=e.split("\r\n");return r.forEach(function(n){var o=n.indexOf(": ");t[n.substr(0,o).toLowerCase()]=n.substr(o+2)}),t}else return{}}var vDe,xDe,dL,Qae=f(()=>{"use strict";s();Wae();Gae();Kae();vDe=/\?/,xDe="ConvertGetPost";dL=function(){function e(t,r,n,o,a,d,c){if(c===void 0&&(c="text"),this.url=t,this.verb=r,this.timeout=n,this.body=a,this.withCredentials=d,this.responseType=c,this.isConvertGetPostRequest=!1,this.headers={},o&&this.verb==="GET"){this.isConvertGetPostRequest=!0,this.verb="POST";var u=vDe.test(this.url);this.url="".concat(this.url).concat(u?"&":"?").concat(xDe,"=true")}}return e.prototype.setHeader=function(t,r){this.headers[t]=r},e.prototype.setTimeout=function(t){this.timeout=t},e.prototype.go=function(t){var r=this;t===void 0&&(t="REST");var n;return new Promise(function(o,a){var d=new XMLHttpRequest;if(d.open(r.verb,r.url),d.timeout=r.timeout,d.withCredentials=r.withCredentials||!1,r.responseType&&(d.responseType=r.responseType),r.isConvertGetPostRequest)r.body=JSON.stringify(r.headers);else for(var c in r.headers)r.headers.hasOwnProperty(c)&&d.setRequestHeader(c,r.headers[c]);d.onload=function(u){if(d.status>=200&&d.status<300){var l=zae(n,u.timeStamp);o(r.getResponseObjectFromRequest(d,l))}else a(Yae(d,t))},d.onerror=function(){a(Yae(d,t))},d.ontimeout=function(){a({statusCode:d.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:HR(Yh.TIMEOUT)})},d.onabort=function(){a({statusCode:d.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:HR(Yh.CANCELLED)})},n=qae(),d.send(r.body)})},e.prototype.getResponseObjectFromRequest=function(t,r){var n=t.responseType==="blob"?t.response:t.responseText;return{Body:n,StatusCode:t.status,Headers:$ae(t.getAllResponseHeaders()),ResponseUrl:t.responseURL,RequestDurationFromEvents:r}},e}()});var Xae=f(()=>{"use strict";s();jae();Qae()});function Jae(e){var t={isLinkedInEnabledInHostApp:e.hostAppConfiguration.options.isLinkedInEnabledInHostApp,isLokiContactDataDisabled:e.hostAppConfiguration.options.isLokiContactDataDisabled};return t}function Zae(e,t){var r=Object.keys(t);if(r.length<=0)return e;var n=r.filter(function(o){return t[o]!==void 0&&t[o]!==null}).map(function(o){if(Array.isArray(t[o])){var a=t[o];return a.map(function(d){return"".concat(o,"=").concat(d)}).join("&")}return"".concat(o,"=").concat(encodeURIComponent(t[o]))}).join("&");return"".concat(e,"?").concat(n)}function BR(e){return e===null?null:e===void 0?void 0:typeof e=="number"||typeof e=="string"||typeof e=="boolean"?e:Array.isArray(e)?e.map(BR):Object.keys(e).reduce(function(t,r){var n="".concat(r[0].toUpperCase()).concat(r.slice(1));return typeof e[r]=="object"?t[n]=BR(e[r]):t[n]=e[r],t},{})}function ese(e){return e.statusCode===403&&cL(e)}function cL(e){var t=["get_configuration","get_livepersonacardconfiguration","get_livepersonapickerconfiguration","get_officefeedconfiguration","get_searchconfiguration","get_groupsmanagementconfiguration"];return!!(e&&e.qosTagId&&t.indexOf(e.qosTagId)>-1)}var Gx,tse,uL=f(()=>{"use strict";s();k();Gx=function(t){return t},tse=function(t){return m(m({},t),{retryAttemptedAfterAuthFailure:!0})}});function Rp(e){return{family:rse,code:e}}function nse(e){e(rse,ls)}var rse,ls,ose=f(()=>{"use strict";s();rse="loki-rest-utils";(function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.INVALID_RESPONSE=1]="INVALID_RESPONSE",e[e.REQUEST_FAILED=2]="REQUEST_FAILED",e[e.CONFIG_FAILED=3]="CONFIG_FAILED",e[e.AUTH_TOKEN_FAILED=4]="AUTH_TOKEN_FAILED",e[e.GCC_USER=5]="GCC_USER",e[e.REQUEST_FACTORY_UNDEFINED=6]="REQUEST_FACTORY_UNDEFINED",e[e.MISSING_REQUIRED_PARAMETER=7]="MISSING_REQUIRED_PARAMETER",e[e.FEATURE_DISABLED=8]="FEATURE_DISABLED"})(ls||(ls={}))});var TDe,UR,lL=f(()=>{"use strict";s();k();Kh();Vae();cc();Xae();uL();ose();TDe=4e4,UR=function(){function e(t,r){this.config=t,this.getDomain=r,this.isFeatureDisabledError=function(n){var o;if(!n||typeof n!="object"||!("responseText"in n)||typeof n.responseText!="string")return!1;try{var a=JSON.parse(n.responseText);if(((o=a==null?void 0:a.Error)===null||o===void 0?void 0:o.Code)==="FeatureDisabled")return!0}catch(d){return!1}return!1},this.initialize(),nse(this.config.logger.registerErrors)}return e.prototype.initialize=function(){return Gt(this,void 0,void 0,function(){return gt(this,function(t){return[2]})})},e.prototype.request=function(t,r,n,o,a,d,c,u,l){return l===void 0&&(l={convertPropertiesToPascalCase:!0,defaultResponseObject:!0}),Gt(this,void 0,void 0,function(){var p,g,h,x,y,T,b,S,E,P,_=this;return gt(this,function(D){switch(D.label){case 0:return this.config.settings.isOfflineMode?[2,Promise.reject({message:"OFFLINE_MODE",isExpected:!0})]:[4,this.getDomainOrLogErrorAndThrow(t)];case 1:p=D.sent(),g=c.requestId,h=c.timeoutOverride,x=c.clientScenario,y=c.hostAppApp,T=function(){return Gt(_,void 0,void 0,function(){var H,V,M,G,K;return gt(this,function(z){switch(z.label){case 0:return[4,this.doRequest({method:r,domain:p.domain,path:n,body:o,headers:a,queryParameters:d,requestId:g,timeoutOverride:h,clientScenario:x,hostAppApp:y,domainRequiredRequest:p.domainRequiredRequest})];case 1:return H=z.sent(),V=H.Headers?Number(H.Headers["x-tokenttl"]):NaN,!isNaN(V)&&this.config.updateAuthTokenTtl(V),M=H.Body===""||H.Body.toLowerCase()==="null",H.Body=M&&l.defaultResponseObject?"{}":H.Body,G=l.convertPropertiesToPascalCase?BR:function($){return $},K=u(!M||l.defaultResponseObject?G(JSON.parse(H.Body)):H.Body),[2,m({parsedResponse:K},H)]}})})},D.label=2;case 2:return D.trys.push([2,4,,11]),[4,T()];case 3:return[2,D.sent()];case 4:if(b=D.sent(),S=b,!(S&&S.statusCode===401))return[3,9];this.config.forceRefreshAuthToken(c.requestId),D.label=5;case 5:return D.trys.push([5,7,,8]),[4,T()];case 6:return[2,D.sent()];case 7:throw E=D.sent(),P=E,tse({qosTagId:t,statusCode:P==null?void 0:P.statusCode,isExpected:(P==null?void 0:P.isExpected)||!1,headers:P==null?void 0:P.headers,midgardError:P&&Dr(P.midgardError)?P.midgardError:Rp(ls.REQUEST_FAILED)});case 8:return[3,10];case 9:throw S&&S.statusCode===403&&this.isFeatureDisabledError(S)?Gx({qosTagId:t,statusCode:S==null?void 0:S.statusCode,isExpected:(S==null?void 0:S.isExpected)||!1,headers:S==null?void 0:S.headers,midgardError:Rp(ls.FEATURE_DISABLED)}):Gx({qosTagId:t,statusCode:S==null?void 0:S.statusCode,isExpected:(S==null?void 0:S.isExpected)||!1,headers:S==null?void 0:S.headers,midgardError:S&&Dr(S.midgardError)?S.midgardError:Rp(ls.REQUEST_FAILED)});case 10:return[3,11];case 11:return[2]}})})},e.prototype.configuration=function(){return this.config},e.prototype.getDomainOrLogErrorAndThrow=function(t){return Gt(this,void 0,void 0,function(){var r,n,o,a,d,c;return gt(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.getDomain()];case 1:return[2,u.sent()];case 2:throw r=u.sent(),n=r,o=n&&ese(n),a=cL(n),d=a?ls.CONFIG_FAILED:o?ls.GCC_USER:ls.UNKNOWN_ERROR,c=void 0,a?c=Rp(d):n&&Dr(n.midgardError)?c=n.midgardError:c=Rp(d),d===ls.UNKNOWN_ERROR&&this.config.logger.logError({eventId:"GetDomainFailure",featureName:"LokiRestProvider"}),Gx({qosTagId:t,statusCode:n==null?void 0:n.statusCode,isExpected:a,headers:void 0,midgardError:c});case 3:return[2]}})})},e.prototype.doRequest=function(t){var r=t.method,n=t.domain,o=t.path,a=t.body,d=t.headers,c=t.queryParameters,u=t.requestId,l=t.timeoutOverride,p=t.clientScenario,g=t.hostAppApp,h=t.domainRequiredRequest;return Gt(this,void 0,void 0,function(){var x,y,T,b,S,E,P,_,D,O,H;return gt(this,function(V){switch(V.label){case 0:return[4,this.initialize()];case 1:return V.sent(),[4,this.getAuthTokenWithRequestInformation(u)];case 2:return x=V.sent(),y=sL||this.config.settings.isGetPostConversionDisabled,T=m(m(m({},y?{"X-RootCorrelationId":u,"X-CorrelationId":u,"X-ClientCorrelationId":this.config.hostAppConfiguration.consumerCorrelationId}:{}),{"X-ClientType":this.config.hostAppConfiguration.source,"X-ClientFeature":this.config.clientFeature,"X-ClientArchitectureVersion":this.config.clientArchitectureVersion,"X-ClientScenario":p,"X-HostAppApp":g,"X-HostAppPlatform":this.config.hostAppConfiguration.platform,"X-LPCVersion":this.config.BUILD_VERSION,authorization:"Bearer ".concat(x.token.getValue()),"X-HostAppRing":this.config.hostAppConfiguration.options.hostAppRing,"X-HostAppVersion":this.config.hostAppConfiguration.options.hostAppVersion,"X-MailboxContextAadObjectId":this.config.settings.isSharedMailboxEnabled?this.config.hostAppConfiguration.options.sharedMailboxAadObjectId:void 0,"X-HostAppCapabilities":JSON.stringify(Jae(this.config))}),this.config.msSearchComponent&&p==="getSearchConfiguration"&&{"X-MSSearchComponent":this.config.msSearchComponent}),b=m({},y?{}:{RootCorrelationId:u,CorrelationId:u,ClientCorrelationId:this.config.hostAppConfiguration.consumerCorrelationId}),S=n.substring(n.length-1)==="/"&&o.substring(0,1)==="/"?"".concat(n).concat(o.substring(1)):"".concat(n).concat(o),E=Zae(S,m(m({},c),b)),P=!sL&&!this.config.settings.isGetPostConversionDisabled,_=l||TDe,D=a instanceof Blob,O=this.getRequestExecutor(E,r,a&&!D?JSON.stringify(a):a,_,P,D),Object.keys(d).forEach(function(M){var G=d[M];G!==void 0&&O.setHeader(M,G)}),Object.keys(T).forEach(function(M){var G=T[M];G!==void 0&&O.setHeader(M,G)}),H=[{additionalRequestInformation:{didMakeAuthTokenRequest:!x.request.fromCache,durationWaitingOnAuthToken:x.request.duration,didMakeConfigRequest:!!h}}],[4,O.go()];case 3:return[2,m.apply(void 0,H.concat([V.sent()]))]}})})},e.prototype.getAuthTokenWithRequestInformation=function(t){return Gt(this,void 0,void 0,function(){var r,n;return gt(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.config.getAuthToken(t)];case 1:return[2,o.sent()];case 2:throw r=o.sent(),n=r,Gx({qosTagId:"getAuthTokenPromise",statusCode:void 0,isExpected:n&&Dr(n.midgardError)?Wx(n.midgardError):!1,headers:void 0,midgardError:n&&Dr(n.midgardError)?n.midgardError:Rp(ls.AUTH_TOKEN_FAILED)});case 3:return[2]}})})},e.prototype.getRequestExecutor=function(t,r,n,o,a,d){return new dL(t,r,o,a,n)},e}()});function ise(e,t,r,n,o){var a;return _R({monitorStarter:e.providerConfig.logger,scenarioName:r,featureName:"RestActionCreators",requestId:t,operation:n,extraProps:o?(a={},a[Zi.clientScenario]=o,a):void 0,treatAsExpectedError:function(c){return c&&Dr(c.midgardError)?_p(c.midgardError):!1}})}function ase(e,t){return Gt(this,void 0,void 0,function(){var r,n,o=this;return gt(this,function(a){return r="".concat(IDe).concat(e.providerConfig.clientFeature).concat(e.providerConfig.hostAppConfiguration.source),n={logEvent:function(c){return e.providerConfig.logger.logEvent({featureName:"TTLCacheUtils",eventId:c.eventId})},logError:function(c){return e.providerConfig.logger.logError({featureName:"TTLCacheUtils",eventId:c.eventId})}},[2,K2({id:e.id,logger:n,cacheKey:r,version:e.version,ttlMs:RDe(e.bypassCache,e.bypassTTL),fallbackCallback:e.bypassFallback?function(){return Promise.reject("fallback failing because bypassFallback is true")}:function(){var d=new UR(e.providerConfig,function(){return Gt(o,void 0,void 0,function(){var u,l;return gt(this,function(p){switch(p.label){case 0:return l={},u=e.lokiUrlOverride,u?[3,2]:[4,e.getLokiDomain()];case 1:u=p.sent(),p.label=2;case 2:return[2,(l.domain=u,l.domainRequiredRequest=!1,l)]}})})}),c=Vo();return t(e,c,d)},ttrMs:e.bypassCache?void 0:SDe,rateLimiter:_De})]})})}function RDe(e,t){if(e&&t)throw new Error("bypassCache and bypassTTL must not both be true at the same time");return e?0:t?Number.MAX_VALUE:bDe}var bDe,SDe,IDe,EDe,PDe,_De,sse=f(()=>{"use strict";s();k();Kh();Y2();uc();cc();Wh();lL();D2();bDe=6048e5,SDe=9e7,IDe="LokiConfig_",EDe=20,PDe=1e4,_De=new Vx(EDe,PDe)});var dse=f(()=>{"use strict";s()});var fL=f(()=>{"use strict";s();Uae();sse();lL();dse();uL()});function ADe(e){return e.UserAadObjectId!==void 0&&e.UserAadObjectId!==null&&e.UserAadObjectId,e.TenantAadObjectId!==void 0&&e.TenantAadObjectId!==null&&e.TenantAadObjectId,e.ClientTelemetryCollectorUrls!==void 0&&e.ClientTelemetryCollectorUrls!==null&&e.ClientTelemetryCollectorUrls,e}function kDe(e){return e}function DDe(e){return e.Value!==void 0&&e.Value!==null&&e.Value.forEach(kDe),e}function wDe(e,t,r){return pL.apply(this,arguments)}function pL(){return pL=(0,gL.default)(function*(e,t,r){var n="/api/v1/personasuggestions",o,a={},d={};return d.Accept="text/plain, application/json, text/json",r.scenarioName!==void 0&&(a.scenarioName=r.scenarioName),r.query!==void 0&&(a.query=r.query),r.top!==void 0&&(a.top=r.top),r.searchDirectory!==void 0&&(a.searchDirectory=r.searchDirectory),r.informationBarrierSegments!==void 0&&(a.informationBarrierSegments=r.informationBarrierSegments),e.request("get_personasuggestions","GET",n,o,d,a,t,DDe)}),pL.apply(this,arguments)}function FDe(e,t,r){return mL.apply(this,arguments)}function mL(){return mL=(0,gL.default)(function*(e,t,r){var n="/api/v1/livepersonapicker/configuration",o,a={},d={};return d.Accept="text/plain, application/json, text/json",e.request("get_livepersonapickerconfiguration","GET",n,o,d,a,t,ADe)}),mL.apply(this,arguments)}var gL,cse,VR,hL=f(()=>{"use strict";s();gL=I(F2());cse=wDe;VR=FDe});function lse(e){return yL.apply(this,arguments)}function yL(){return yL=(0,use.default)(function*(e){return ase(e,NDe)}),yL.apply(this,arguments)}var use,ODe,NDe,fse=f(()=>{"use strict";s();use=I(F2());fL();hL();ODe="getLPPConfiguration",NDe=function(t,r,n){return ise(t,r,"GetLivePersonaPickerConfiguration",function(){return VR(n,{requestId:r,clientScenario:ODe},{})})}});var CL=f(()=>{"use strict";s();hL();fse()});var MDe,pse,LDe,vL,qx,jR=f(()=>{"use strict";s();IR();Lie();CL();MDe=w2("PickerConfiguration",VR),pse=zh("ConfigurationStore",MDe),LDe={success:function(t){return{responseLength:t.Value?t.Value.length.toString():"0"}},fromParameters:function(t){return{queryLength:t.query?t.query.length.toString():"0",didSearchDirectory:t.searchDirectory}}},vL=w2("PickerSuggestions",cse,{logPropertyExtractors:LDe}),qx=zh("SuggestionsStore",vL)});var HDe,mse,gse,hse,xL=f(()=>{"use strict";s();HDe=/<([^>]*)>/,mse=function(t){var r=t.indexOf("@");return r>0&&r<t.length-1},gse=function(t){return t.startsWith("@")?t.slice(1):t},hse=function(t){var r=t.split(";"),n=r.map(function(o){var a=HDe.exec(o);return a&&a.length>1&&a[1]&&(o=a[1]),o.trim()}).filter(function(o){return o});return n}});var Kx,yse,WR=f(()=>{"use strict";s();Kx=30,yse=3});function zR(e,t){var r=e.EmailAddresses,n=e.Id,o=e.Name,a=e.UserPrincipalName,d=e.PersonaType,c=e.PersonaSubtype,u=e.AadObjectId;return{Id:n||"",Name:o||"",UserPrincipalName:a||"",EmailAddresses:r||[],SuggestionType:d||"",SuggestionSubtype:c||"",HostAppSuggestion:{},Source:"Loki",SuggestionOrigin:t?"ZeroTerm":"Search",AadObjectId:u||void 0}}function GR(e){return e.UserPrincipalName||(e.EmailAddresses&&e.EmailAddresses.length?e.EmailAddresses[0]:"")}function Cse(e){return{Id:e,Name:e,UserPrincipalName:"",HostAppSuggestion:{},SuggestionType:"",SuggestionSubtype:"",EmailAddresses:[e],Source:"UserTypedSuggestion",SuggestionOrigin:"UserTyped"}}var $h=f(()=>{"use strict";s()});function vse(e,t){var r=function(u){return!(!u.Id||!u.EmailAddresses||u.EmailAddresses.length===0)},n=bx(t,function(c){return c.Id}),o={};t&&(o=bx(t.filter(function(c){return c.AadObjectId}),function(c){return c.AadObjectId}));var a=bx(t,function(c){return c.UserPrincipalName}),d=e.filter(r).filter(function(c){return TL(n,c.Id)}).filter(function(c){return TL(o,c.AadObjectId)}).filter(function(c){return TL(a,c.UserPrincipalName)});return d}function xse(e,t){var r=rR(e).toLowerCase(),n=t.filter(function(o){return o.Name&&rR(o.Name.toLowerCase()).indexOf(r)===0});return n}function Tse(e){var t=hse(e),r=t&&t[0],n=[Cse(r)];return n}function bse(e){return e.length===0?"Empty":e.length%Kx===0?"Limited":"Full"}var TL,Sse=f(()=>{"use strict";s();sc();WR();xL();$h();TL=function(t,r){return!r||!t||t[r]===void 0}});function Ise(e,t){var r=new Set;t.forEach(function(o){o.EmailAddresses.forEach(function(a){return r.add(a.toLowerCase())})});var n=e.filter(function(o){var a=!0;return o.EmailAddresses.forEach(function(d){r.has(d.toLowerCase())&&(a=!1)}),a});return n}var Ese=f(()=>{"use strict";s()});var Yx,bL=f(()=>{"use strict";s();cs();Yx=ro("PhotoUrisProvidedAction",{featureName:"NoLogging"})});function jDe(e,t){return{photoUris:Object.assign(Object.assign({},e.photoUris),t.photoUris)}}var BDe,UDe,VDe,qR,SL=f(()=>{"use strict";s();cs();bL();BDe="PhotoUriStore",UDe={photoUris:{}},VDe=ou().handlePayload(Yx,jDe).done(UDe),qR=iu(BDe,VDe,function(e){return{get photoUris(){return e.photoUris}}})});function Pse(e){var t=qR.getSelectors(e);return t.photoUris}var _se=f(()=>{"use strict";s();SL()});var EL=Re((nZt,su)=>{s();function IL(e){"@babel/helpers - typeof";return su.exports=IL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su.exports.__esModule=!0,su.exports.default=su.exports,IL(e)}su.exports=IL,su.exports.__esModule=!0,su.exports.default=su.exports});var Ase=Re((iZt,$x)=>{s();var Rse=EL().default;function WDe(e,t){if(Rse(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rse(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}$x.exports=WDe,$x.exports.__esModule=!0,$x.exports.default=$x.exports});var PL=Re((sZt,Qx)=>{s();var zDe=EL().default,GDe=Ase();function qDe(e){var t=GDe(e,"string");return zDe(t)=="symbol"?t:t+""}Qx.exports=qDe,Qx.exports.__esModule=!0,Qx.exports.default=Qx.exports});var kse=Re((cZt,Xx)=>{s();var KDe=PL();function YDe(e,t,r){return t=KDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Xx.exports=YDe,Xx.exports.__esModule=!0,Xx.exports.default=Xx.exports});function JDe(e,t){var r=t.payload;return{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),(0,Qh.default)({},r.query,"InProgress")),currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Qh.default)({},r.inputId,r.query))}}function ZDe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),(0,Qh.default)({},r.query,"Finished"))})}function ewe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Qh.default)({},r.inputId,void 0))})}function twe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Qh.default)({},r.inputId,void 0))})}var Qh,$De,QDe,XDe,Jx,_L=f(()=>{"use strict";s();Qh=I(kse());cs();yR();y2();$De="QueryStore",QDe={queryStatuses:{},currentQueries:{}},XDe=ou().handleAction(mR,JDe).handleAction(gR,ZDe).handleAction(CR,ewe).handleAction(hR,twe).done(QDe);Jx=iu($De,XDe,function(e){return{getCurrentQuery:function(r){return e.currentQueries[r]||""},getQueryStatus:function(r){return e.queryStatuses[r]||"Finished"}}})});function KR(e,t){var r=Jx.getSelectors(e);return r.getCurrentQuery(t)}function RL(e,t){var r=Jx.getSelectors(e);return r.getQueryStatus(t)}var YR=f(()=>{"use strict";s();_L()});var $R,AL=f(()=>{"use strict";s();cs();$R=ro("LivePersonaPickerInitializedAction",{featureName:"AppLoadedAction",getLogProperties:function(t){var r,n;return{infoBarrierSegmentsCount:(n=(r=t.informationBarrierSegments)===null||r===void 0?void 0:r.length)===null||n===void 0?void 0:n.toString(),offline:t.offline.toString()}}})});var kL,wse,Xh,Dse,QR,XR,Fse,Ose,Nse=f(()=>{"use strict";s();WR();kL={queryType:"loki",top:Kx,searchDirectory:!0},wse=Object.assign(Object.assign({},kL),{searchDirectory:!1}),Xh={queryType:"host",top:Kx,searchDirectory:!0},Dse=Object.assign(Object.assign({},Xh),{searchDirectory:!1}),QR={startupQueries:new Set([wse,Xh]),queries:new Set([kL,Xh])},XR={startupQueries:new Set,queries:new Set([Xh])},Fse={startupQueries:new Set([Dse]),queries:new Set([Xh,Dse])},Ose={startupQueries:new Set([wse]),queries:new Set([kL]),fallbackQueries:new Set([Xh])}});function iwe(e,t){var r=t.informationBarrierSegments,n=t.offline,o=t.clientType,a=Object.assign(Object.assign({},e.settings),{informationBarrierSegments:r});if(t.settings){var d=t.settings;a=Object.assign(Object.assign({},e.settings),d)}switch(o){case"ShareDialog":a=Object.assign(Object.assign({},a),{clearInputOnSuggestionPressed:!0,detectEmailAddresses:!0,dismissPickerAfterWordBreakLimitIsReached:!1,queryConfig:n?XR:Ose});break;case"UWPStellarCalendar":a=Object.assign(Object.assign({},a),{loadMoreSuggestionsOnScroll:!0,queryConfig:Fse,suggestUseEmailAddress:!0,triggerStringMode:"ZeroTerm"});break;case"OneNoteUWP":a=Object.assign(Object.assign({},a),{triggerStringMode:"ZeroTerm"});break;case"OfficeAndroid":case"OfficeiOS":case"MobileTestApp":case"OfficeWin32":a=Object.assign(Object.assign({},a),{triggerStringMode:"AtMention",queryConfig:n?XR:QR});break;case"OfficeWebApps":case"Outlook_Monarch_HUB":case"Outlook_Web_HUB":case"Outlook_Win32_HUB":case"Teams_HUB":case"OrgExplorerTestpage_Web":case"ToDo_UWP":case"ToDo_Android":case"ToDo_iOS":case"MetaOSFeed":case"MetaOSFeed_Edge":case"MetaOSFeed_OfficeCom":case"VivaOnboarding":case"VivaPulse":case"Neon":case"Neon_Windows":a=Object.assign(Object.assign({},a),{queryConfig:n?XR:QR});break;default:}return{settings:a}}var rwe,nwe,owe,Zx,DL=f(()=>{"use strict";s();cs();AL();Nse();rwe="SettingStore",nwe={settings:{clearInputOnSuggestionPressed:!1,detectEmailAddresses:!1,dismissPickerAfterWordBreakLimitIsReached:!0,informationBarrierSegments:void 0,loadMoreSuggestionsOnScroll:!1,queryConfig:QR,suggestUseEmailAddress:!1,triggerStringMode:"OneLetter"}},owe=ou().handlePayload($R,iwe).done(nwe),Zx=iu(rwe,owe,function(e){return{get settings(){return e.settings}}})});function Mse(e){var t=Zx.getSelectors(e);return t.settings}var Lse=f(()=>{"use strict";s();DL()});function awe(e){return e||[]}function swe(e){return awe(e==null?void 0:e.Value)}function FL(e,t){var r=e.length===0?JR:{key:e},n=qx.getSelectors(t);return swe(n.getLatestSuccess(r)).map(function(o){return zR(o,e.length===0)})}function OL(e,t){var r=e.length===0?JR:{key:e},n=Ox.getSelectors(t);return n.getLatestSuccess(r)||[]}function dwe(e,t){var r=e.length===0?JR:{key:e},n=qx.getSelectors(t);return n.hasError(r)}function cwe(e,t){var r=e.length===0?JR:{key:e},n=Ox.getSelectors(t);return n.hasError(r)}function ZR(e,t,r){var n="",o=Hse(n,e,r);if(t===n){var a=Bse(e,o),d=dR(a,function(h){return h.Id});return d.length!==a.length&&console.error("Suggestions coming from the host app do not have unique IDs!"),Use(t,e,d)}var c=xse(t,o),u=Hse(t,e,r),l=dR([].concat((0,wL.default)(c),(0,wL.default)(u)),function(h){return h.Id}),p=uwe(t,e,l),g=Bse(e,p);return Use(t,e,g)}function Hse(e,t,r){var n=FL(e,t),o=OL(e,t),a=Ise(o,n),d=(n||[]).concat(a),c=vse(d,r);return c}function uwe(e,t,r){var n=Mse(t),o=RL(t,e),a=gse(e);if(n.suggestUseEmailAddress&&o==="Finished"&&r.length===0&&mse(a)){var d=Tse(a);return d}return r}function Bse(e,t){var r=Pse(e);return t.map(function(n){return n.ImageSource=n.ImageSource||r[n.Id],n})}function Use(e,t,r){var n=RL(t,e),o=dwe(e,t)||cwe(e,t),a=bse(r);return{query:e,queryStatus:n,suggestions:r,completeness:a,hasErrors:o}}var wL,JR,eT=f(()=>{"use strict";s();wL=I(x2());sc();jR();ER();xL();Sse();Ese();$h();_se();YR();Lse();JR={key:""}});function Vse(e,t,r){if(!e.getHostAppSuggestions)return Promise.resolve([]);var n={key:t},o=e.getStoreState();if(o){var a=OL(t,o);if(a.length>0)return Promise.resolve(a)}return k2.fetch({monitorStarter:e.logger,dispatch:e.dispatch,timeoutOverride:lwe},n,{getHostAppSuggestions:e.getHostAppSuggestions,query:t,options:r}).then(function(d){return d.response.map(function(c){return c.Source="HostApp"}),d.response}).catch(function(){return[]})}var lwe,jse=f(()=>{"use strict";s();ER();eT();lwe=1e4});function Wse(e,t,r){var n={key:t},o=e.getStoreState();if(o){var a=FL(t,o);if(a.length>0)return Promise.resolve(a)}var d=e.settings.informationBarrierSegments;return vL.fetch({monitorStarter:e.logger,lokiRestProvider:e.getLokiRestProvider(),dispatch:e.dispatch,timeoutOverride:fwe,clientScenario:pwe,hostAppApp:e.hostAppName},n,{scenarioName:"people",query:t||void 0,top:r.top,searchDirectory:r.searchDirectory,informationBarrierSegments:d}).then(function(c){var u=c.response.Value;return(u||[]).map(function(l){return zR(l,t.length===0)})}).catch(function(){return[]})}var fwe,pwe,zse=f(()=>{"use strict";s();jR();eT();$h();fwe=1e4,pwe="getPersonaSuggestions"});function NL(e,t){return gwe(e,t.getPhotoUri).then(function(r){t.dispatch(Yx({photoUris:r}))}).catch(function(){t.dispatch(Yx({photoUris:{}}))}),Promise.resolve(e)}function gwe(e,t){return Promise.all(e.map(function(r){return hwe(r,t)})).then(function(r){var n=function(a,d,c){return a[e[c].Id]=d,a};return r.reduce(n,{})})}function hwe(e,t){return t?t(mwe,GR(e),e.AadObjectId):Promise.resolve(void 0)}var mwe,Gse=f(()=>{"use strict";s();bL();$h();mwe="api/v2/personaphoto?smtp="});function LL(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=e.settings.queryConfig,o=n.queries||qse,a=n.fallbackQueries||qse;return ML(e,t,o,r).then(function(d){return d.length>0?Promise.resolve(d):ML(e,t,a,r)}).then(function(d){return e.dispatch(gR({query:t})),Promise.resolve(d)}).then(function(d){return NL(d,e)})}function Yse(e){var t=e.settings.queryConfig,r=t.startupQueries;return ML(e,"",r).then(function(n){return NL(n,e)})}function ML(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return Promise.all((0,Kse.default)(r).map(function(o){return ywe(e,t,Object.assign(Object.assign({},o),{top:o.top*n}))})).then(WM)}function ywe(e,t,r){var n=r.queryType;switch(n){case"loki":return Wse(e,t,r);case"host":return Vse(e,t,r);default:return n}}var Kse,qse,HL=f(()=>{"use strict";s();Kse=I(x2());sc();yR();jse();zse();Gse();qse=new Set});function $se(e,t,r){t.length>=200||(e.dispatch(mR({query:t,inputId:r})),LL(e,t))}function Qse(e,t,r,n){LL(e,t,n),e.dispatch(yie({query:t,inputId:r}))}function Xse(e,t,r,n,o,a){e.dispatch(CR({suggestionSource:t.Source,suggestionOrigin:t.SuggestionOrigin,inputId:r,queryLength:n,suggestionsShown:o,pickedSuggestionIndex:a}))}function eA(e,t,r,n,o){e.dispatch(hR({dismissalReason:t,inputId:r,queryLength:n,suggestionsShown:o}))}var BL=f(()=>{"use strict";s();yR();y2();HL()});var U,Jse=f(()=>{"use strict";s();U="#ff00ff"});var tA,UL=f(()=>{"use strict";s();Jse();tA={labelColor:U,labelColorPressed:U,labelColorHover:U,secondaryLabelColor:U,tertiaryLabelColor:U,quaternaryLabelColor:U,linkColor:U,linkColorPressed:U,linkColorHover:U,placeholderTextColor:U,windowFrameTextColor:U,selectedMenuItemTextColor:U,headerTextColor:U,gridColor:U,selectedGridColor:U,secondaryGridColor:U,refreshSpinnerColor:U,refreshSpinnerBackgroundColor:U,windowBackgroundColor:U,underPageBackgroundColor:U,controlBackgroundColor:U,controlHoveredBackgroundColor:U,controlPressedBackgroundColor:U,cardBackgroundColor:U,cardBackgroundSelectedColor:U,cardHeaderColor:U,cardBorderColor:U,cardHeaderIconBackgroundColor:U,cardSecondaryBackgroundColor:U,windowBackgroundLightColor:U,titleColor:U,textColor:U,textBackgroundColor:U,textSecondaryBackgroundColor:U,selectedTextColor:U,selectedTextBackgroundColor:U,textErrorColor:U,background1:U,background2:U,background3:U,background4:U,background5:U,backgroundCanvas:U,backgroundDarkStatic:U,backgroundStencil1:U,controlsSegmentBackground2:U,controlsSegmentForeground2:U,foreground1:U,foreground2:U,foreground3:U,foregroundLightStatic:U,foregroundOnColor:U,stroke1:U,stroke2:U,brandStrokeAccessible:U,brandStrokeTint:U,brandStrokeTintPressed:U,brandBackgroundTint:U,brandBackground1:U,brandForeground1:U,statusPresenceAvailable:U,statusPresenceDnD:U,controlColor:U,controlTextColor:U,controlHoveredTextColor:U,controlPressedTextColor:U,controlSecondaryTextColor:U,controlSecondaryHoveredTextColor:U,controlSecondaryPressedTextColor:U,selectedControlColor:U,selectedControlTextColor:U,hoveredControlColor:U,hoveredSelectedControlColor:U,secondaryHoveredControlColor:U,pressedControlColor:U,secondaryPressedControlColor:U,controlBorderColor:U,controlFocusedBorderColor:U,controlButtonBorderColor:U,controlBorderLightColor:U,controlPillBackgroundColor:U,controlPillHoverTextColor:U,controlPillSecondaryHoverTextColor:U,controlPillHoverBackgroundColor:U,controlPillSecondaryHoverBackgroundColor:U,controlPillTertiaryHoverBackgroundColor:U,controlPillPressedBackgroundColor:U,controlPillColor:U,controlPillSecondaryTextColor:U,controlPillPressedTextColor:U,controlPillBorderColor:U,controlPillHoverBorderColor:U,controlPillSecondaryHoverBorderColor:U,controlPillPressedBorderColor:U,calloutSecondaryBackgroundColor:U,disabledControlTextColor:U,keyboardFocusIndicatorColor:U,listViewBackgroundColor:U,listViewItemBackgroundColor:U,sectionListViewBackgroundColor:U,sectionListViewItemBackgroundColor:U,badgePrimaryBackgroundColor:U,badgePrimaryBorderColor:U,badgePrimaryTextColor:U,badgeSecondaryBackgroundColor:U,badgeSecondaryBorderColor:U,badgeSecondaryTextColor:U,folderBadgePrimaryBorderColor:U,primaryButtonBackground:U,primaryButtonBackgroundHovered:U,primaryButtonBackgroundPressed:U,primaryButtonBackgroundDisabled:U,primaryButtonBorder:U,primaryButtonBorderFocused:U,primaryButtonText:U,primaryButtonTextHovered:U,primaryButtonTextPressed:U,primaryButtonTextDisabled:U,buttonBackground:U,buttonBackgroundHovered:U,buttonBackgroundPressed:U,buttonBackgroundDisabled:U,buttonBorder:U,buttonBorderFocused:U,buttonBorderDisabled:U,systemRedColor:"#e63237",systemGreenColor:"#107c10",systemBlueColor:"#0078d7",systemOrangeColor:"#d83b01",systemYellowColor:"#ffb900",systemBrownColor:"#a2845e",systemPinkColor:"#ff2d55",systemPurpleColor:"#5c2d91",systemGrayColor:"#999999",highlightColor:U,shadowColor:U,outlookAlabaster:"#f8f8f8",outlookBlack:"#212121",outlookBlueHighlighted:"#cbe3f5",outlookBlueSelected:"#005b9e",outlookGray:"#8e8e93",outlookLightGray:"#a8a8ac",outlookMercury:"#e1e1e1",outlookRed:"#e63237",outlookSeashell:"#f1f1f1",flaggedNormalBackgroundColor:"rgba(253, 247, 232, 1.0)",flaggedSelectedBackgroundColor:"rgba(253, 245, 224, 1.0)",iconTintColor:U,feedMenuTintColor:U,notificationBackgroundColor:"#c7e0f4",notificationTextColor:"#0078d7",activityIndicatorColor:"#0078d7",dividerColor:U,dividerColorBottomSheet:"#e0e0e0",secondaryDividerColor:U,accentColor:U,secondaryBackgroundColor:U,tertiaryBackgroundColor:U,quaternaryBackgroundColor:U,placeholderBackgroundColor:U,menuBackground:U,menuItemBackgroundHovered:U,menuItemBackgroundChecked:U,menuItemBackgroundPressed:U,menuItemTextHovered:U,buttonTextHovered:U,buttonText:U,buttonTextPressed:U,buttonTextDisabled:U,menuItemText:U,menuItemTextChecked:U,buttonTextChecked:U,menuDivider:U,superAnnotation:U,teamsColor:U,teamsOofMessageColor:U,buttonIconTintColor:U,buttonIconDisableColor:U}});function du(){var e=Wc(),t={alternateHero:24};return Zse.useMemo(function(){var r=e.name,n=e.host,o=e.colors,a=n.palette,d=n.colors;if(!n||!a||!d)throw new Error("Host theme is not fully defined.");return{themeName:r,semanticColors:m(m(m(m({},tA),{controlHoveredBackgroundColor:o.menuItemBackgroundHovered,controlPressedBackgroundColor:o.menuItemBackgroundPressed,controlBackgroundColor:"#00000000",controlBorderColor:o.buttonBorder,controlBorderLightColor:a.AccentLight,controlFocusedBorderColor:o.focusBorder,keyboardFocusIndicatorColor:a.AccentOutline,highlightColor:d.App6,controlTextColor:o.buttonText,controlHoveredTextColor:o.buttonTextHovered,controlPressedTextColor:o.buttonTextPressed,titleColor:o.bodyText,textColor:o.bodyText,textSecondaryBackgroundColor:a.Text,labelColor:o.subText,secondaryLabelColor:a.TextSecondary,controlSecondaryTextColor:a.TextSecondary,tertiaryLabelColor:a.TextCtlEmphasis,controlSecondaryHoveredTextColor:a.TextSecondaryHover,controlSecondaryPressedTextColor:a.TextSecondaryPressed,controlButtonBorderColor:a.TextSecondaryHover,windowBackgroundColor:a.Bkg,windowBackgroundLightColor:a.BkgCtlSubtleDisabled,linkColor:a.TextHyperlink,linkColorHover:a.BkgCtlEmphasisHover,hoveredControlColor:a.BkgCtlEmphasisHover,calloutSecondaryBackgroundColor:a.BkgCtlEmphasis,textErrorColor:a.TextError,controlPillColor:a.TextEmphasisHover,controlPillSecondaryTextColor:a.TextEmphasisHover,controlPillBorderColor:a.BkgCtlSubtleHover,controlPillBackgroundColor:a.BkgCtlSubtleHover,controlPillHoverTextColor:a.TextEmphasisHover,controlPillHoverBorderColor:a.BkgCtlSubtlePressed,controlPillHoverBackgroundColor:a.BkgCtlSubtlePressed,controlPillSecondaryHoverTextColor:a.TextEmphasisHover,controlPillSecondaryHoverBorderColor:a.BkgCtlSubtlePressed,controlPillSecondaryHoverBackgroundColor:a.BkgCtlSubtlePressed,controlPillTertiaryHoverBackgroundColor:a.BkgCtlPressed,controlPillPressedTextColor:a.TextCtlEmphasis,controlPillPressedBorderColor:a.BkgCtlEmphasis,controlPillPressedBackgroundColor:a.BkgCtlEmphasis,menuBackground:o.menuBackground,menuItemBackgroundHovered:o.menuItemBackgroundHovered,menuItemBackgroundChecked:o.menuItemBackgroundChecked,menuItemTextHovered:o.menuItemTextHovered,buttonTextHovered:o.buttonTextHovered,buttonText:o.buttonText,buttonTextPressed:o.buttonTextPressed,buttonTextDisabled:o.buttonTextDisabled,menuItemText:o.menuItemText,menuItemTextChecked:o.menuItemTextChecked,buttonTextChecked:o.buttonTextChecked,menuItemBackgroundPressed:o.menuItemBackgroundPressed,menuDivider:o.menuDivider,teamsColor:o.subText,teamsOofMessageColor:o.subText,primaryButtonBackground:o.primaryButtonBackground,primaryButtonBackgroundHovered:o.primaryButtonBackgroundHovered,primaryButtonBackgroundPressed:o.primaryButtonBackgroundPressed,primaryButtonBackgroundDisabled:o.primaryButtonBackgroundDisabled,primaryButtonBorder:o.primaryButtonBorder,primaryButtonBorderFocused:o.primaryButtonBorderFocused,primaryButtonText:o.primaryButtonText,primaryButtonTextHovered:o.primaryButtonTextHovered,primaryButtonTextPressed:o.primaryButtonTextPressed,primaryButtonTextDisabled:o.primaryButtonTextDisabled,buttonBackground:o.buttonBackground,buttonBackgroundHovered:o.buttonBackgroundHovered,buttonBackgroundPressed:o.buttonBackgroundPressed,buttonBackgroundDisabled:o.buttonBackgroundDisabled,buttonBorder:o.buttonBorder,buttonBorderFocused:o.buttonBorderFocused,buttonBorderDisabled:o.buttonBorderDisabled}),Cwe(r,a)),vwe(r)),typography:{sizes:{xxxSmall:e.typography.sizes.secondary,xxSmall:e.typography.sizes.secondary,xSmall:e.typography.sizes.secondary,small:e.typography.sizes.secondary,medium:e.typography.sizes.secondary,large:e.typography.sizes.body,xLarge:e.typography.sizes.subheader,xxLarge:e.typography.sizes.subheader,xxxLarge:t.alternateHero},families:e.typography.families,weights:{light:e.typography.weights.regular,semiLight:e.typography.weights.regular,medium:e.typography.weights.regular,semiBold:e.typography.weights.semiBold,bold:e.typography.weights.semiBold}},icons:{},brandIcons:{},illustrations:{}}},[e])}function Cwe(e,t){switch(e){case"Colorful":case"DarkGray":case"Black":case"White":return{};case"HighContrast":return{controlPillColor:t.TextCtlSubtle,controlPillSecondaryTextColor:t.TextHyperlink,controlPillBorderColor:t.TextCtlSubtle,controlPillBackgroundColor:t.BkgCtl,controlPillHoverTextColor:t.TextCtlSubtleHover,controlPillHoverBorderColor:t.BkgCtlHover,controlPillHoverBackgroundColor:t.BkgCtlHover,controlPillSecondaryHoverTextColor:t.TextCtlSubtle,controlPillSecondaryHoverBorderColor:t.BkgCtlHover,controlPillSecondaryHoverBackgroundColor:t.BkgCtl,controlPillTertiaryHoverBackgroundColor:t.BkgCtlHover,controlPillPressedTextColor:t.TextCtlSubtleHover,controlPillPressedBorderColor:t.BkgCtlHover,controlPillPressedBackgroundColor:t.BkgCtlHover,textErrorColor:t.TextHyperlink,hoveredControlColor:t.StrokeCtlPressed,tertiaryLabelColor:t.BkgCtl,calloutSecondaryBackgroundColor:t.BkgCtlHover};default:return dc(e,{})}}function vwe(e){switch(e){case"DarkGray":return{textSecondaryBackgroundColor:"#ffffff"};case"HighContrast":return{};case"Colorful":case"White":return xwe();case"Black":return Twe();default:return dc(e,{})}}function xwe(){var e=ei.colors;return m({controlPillColor:e.primaryButtonBackgroundPressed,controlPillSecondaryTextColor:e.primaryButtonBackgroundPressed,controlPillHoverTextColor:e.primaryButtonBackgroundPressed,controlPillSecondaryHoverTextColor:e.primaryButtonBackgroundPressed,controlButtonBorderColor:e.primaryButtonTextDisabled,controlPillBorderColor:"#eff6fc",controlPillBackgroundColor:"#eff6fc",controlPillHoverBorderColor:"#deecf9",controlPillHoverBackgroundColor:"#deecf9",controlPillSecondaryHoverBorderColor:"#deecf9",controlPillSecondaryHoverBackgroundColor:"#deecf9",controlPillTertiaryHoverBackgroundColor:"#c7e0f4",teamsColor:"#6264a7",teamsOofMessageColor:"#b4009e"},ede(e))}function Twe(){var e=jg.colors;return m({controlButtonBorderColor:e.bodyDivider,teamsColor:"#7a7fea",teamsOofMessageColor:"#e959d9"},ede(e))}function ede(e){return{textColor:e.bodyText,labelColor:e.subText,secondaryLabelColor:e.buttonTextHovered,controlTextColor:e.buttonText,controlHoveredTextColor:e.buttonTextHovered,controlPressedTextColor:e.buttonTextPressed,controlSecondaryTextColor:e.subText,controlSecondaryHoveredTextColor:e.subText,controlSecondaryPressedTextColor:e.subText,controlBorderColor:e.bodyDivider,controlBorderLightColor:e.bodyDivider,controlFocusedBorderColor:e.focusBorder,controlButtonBorderColor:e.primaryButtonTextDisabled,controlHoveredBackgroundColor:e.buttonBackgroundHovered,controlPressedBackgroundColor:e.buttonBackgroundPressed,hoveredControlColor:e.themePrimary,linkColor:e.link,linkColorHover:e.linkHovered,calloutSecondaryBackgroundColor:e.primaryButtonBackgroundHovered,keyboardFocusIndicatorColor:e.bodyText,textErrorColor:e.errorText,notificationTextColor:e.neutralPrimaryAlt,textSecondaryBackgroundColor:"#ffffff"}}var Zse,tT=f(()=>{"use strict";s();k();Ta();zg();Yf();Zse=I(L());UL()});var tde,rde=f(()=>{"use strict";s();UL();tde=Object.assign({},tA)});var Jh,cu,rT,nde,ode=f(()=>{"use strict";s();Jh="Times New Roman",cu=0,rT="900",nde={families:{primary:Jh,secondary:Jh,cursive:Jh,monospace:Jh,sansSerif:Jh,serif:Jh},sizes:{xxxSmall:cu,xxSmall:cu,xSmall:cu,small:cu,medium:cu,large:cu,xLarge:cu,xxLarge:cu,xxxLarge:cu},weights:{light:rT,semiLight:rT,medium:rT,semiBold:rT,bold:rT}}});var ide,ade=f(()=>{"use strict";s();rde();ode();ide={semanticColors:tde,typography:nde,icons:{},brandIcons:{},illustrations:{}}});var sde,bwe,dde,cde=f(()=>{"use strict";s();sde=I(L());ade();bwe=ide,dde=(0,sde.createContext)(bwe)});function VL(){return(0,ude.useContext)(dde)}var ude,lde=f(()=>{"use strict";s();ude=I(L());cde()});var fde=f(()=>{"use strict";s();lde()});var pde,mde,gde=f(()=>{"use strict";s();pde=I(ee()),mde=pde.Image});var jL,hde,yde=f(()=>{"use strict";s();k();Ta();jL=I(ee()),hde=to(function(e,t){var r=e.semanticColors;return jL.StyleSheet.create({container:m({alignItems:"center",flexDirection:"row",overflow:"hidden"},t.specifyContainerBorder?{borderWidth:jL.StyleSheet.hairlineWidth,borderColor:"transparent"}:{}),textBoy:{flex:1,color:t.useWhiteTextBoy?"#ffffff":r.sectionListViewItemBackgroundColor,textAlign:"center",textAlignVertical:"center"},userPhoto:{position:"absolute",left:0,top:0,overflow:"hidden",justifyContent:"center"},presenceIcon:{position:"absolute",right:0,bottom:0,overflow:"hidden",width:24,height:24,justifyContent:"center"}})})});function WL(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}var Cde=f(()=>{"use strict";s()});var vde=f(()=>{"use strict";s();Cde()});var xde=f(()=>{"use strict";s();vde()});var Tde,Swe,Iwe,Ewe,Pwe,_we,bde,zL,atr,str,rA,dtr,ctr,utr,GL=f(()=>{"use strict";s();Tde="#eaeaea",Swe=100,Iwe=400,Ewe=300,Pwe=500,_we=600,bde=14,zL=12,atr=Swe.toString(),str=Ewe.toString(),rA="normal",dtr=Iwe.toString(),ctr=Pwe.toString(),utr=_we.toString()});function qL(e,t,r){if(!e&&!t&&!r)return Tde;var n=(e||"")+(t||"")+(r||""),o=Math.abs(WL(n));return Ide[o%Ide.length]}var Ide,Ede=f(()=>{"use strict";s();xde();GL();Ide=["#3298db","#50bbc4","#32c270","#f07e21","#e6463c","#f0ce0e","#f069b1","#9e75db","#ac735f","#a5a5ab"]});function KL(e){var t="";if(!e)return t;e=e.replace(Rwe,""),e=e.replace(Awe,""),e=e.replace(kwe," "),e=e.trim();var r=e.split(" ");return r.length>=2?(t+=r[0].charAt(0).toUpperCase(),t+=r[r.length-1].charAt(0).toUpperCase()):r.length!==0&&(t+=r[0].charAt(0).toUpperCase()),t}var Rwe,Awe,kwe,Pde=f(()=>{"use strict";s();Rwe=/\(([^)]*)\)/gi,Awe=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,kwe=/\s+/gi});var _de,Rde=f(()=>{"use strict";s();_de=/\([^)]*\)|[\0-\u001F\!-\"$-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g});function YL(e,t){var r="";if(e&&e.length>0){var n=e.split(" ");n.forEach(function(o){var a=o.trim();if(!(a.length<1)){var d=a.substr(0,1),c=d.length>0&&d.search(_de)===-1;c&&r.length<2&&(r+=d)}})}else t&&t.length>0&&(r=t.substr(0,1));return r.length===0&&(r="#"),r.toUpperCase()}var Ade=f(()=>{"use strict";s();Rde()});function kde(e){var t,r=e.accessibilityLabel,n=e.accessible,o=e.email,a=e.aadObjectId,d=e.imageSource,c=e.name,u=e.onError,l=e.onLoad,p=e.overrideUserColor,g=e.overrideUserInitials,h=e.placeholderImageSource,x=e.showPlaceholderImage,y=e.showTextBoy,T=e.size,b=e.style,S=e.focusable,E=e.imageOverflowWorkaround,P=e.textOverflowWorkaround,_=e.specifyContainerBorder,D=e.useWhiteTextBoy,O=e.forceImageComponent,H=e.useOutlookMobileInitials,V=e.presenceIcon,M=e.presenceIconToolTip,G=e.profilePhotoTooltip,K=VL(),z=fs.useMemo(function(){return{specifyContainerBorder:_,useWhiteTextBoy:D}},[_,D]),$=hde(K,z),q=y?p||qL(c,o,a):"transparent",re=T/2,ae={width:T,height:T},ie=x&&h,Te={resizeMode:"cover",style:[$.userPhoto,ae,E]},Oe=(t=d==null?void 0:d.uri)===null||t===void 0?void 0:t.startsWith("https://"),ke=O||Oe?od.Image:mde,it=fs.useMemo(function(){return g||(H?YL(c,o):KL(c,o))},[g,H,c,o,a]),_e=od.StyleSheet.flatten($.presenceIcon);return fs.createElement(od.View,null,fs.createElement(od.View,{style:[$.container,ae,{borderRadius:re},{backgroundColor:q},b],accessible:n,accessibilityLabel:r,focusable:S,tooltip:G},y&&fs.createElement(od.Text,{style:[$.textBoy,{fontSize:Math.round(T*.4)},P],allowFontScaling:!1},it),ie&&fs.createElement(od.Image,m({},Te,{source:ie,accessibilityIgnoresInvertColors:!0})),d&&fs.createElement(ke,m({},Te,{key:d.uri,source:d,onLoad:l,onError:u,accessibilityIgnoresInvertColors:!0}))),V&&fs.createElement(od.View,m({tooltip:M},{style:[$.presenceIcon,E],accessibilityIgnoresInvertColors:!0,testID:"persona_image_presence_coin"}),fs.cloneElement(V,{width:_e.width,height:_e.height})))}var fs,od,Dde=f(()=>{"use strict";s();k();fs=I(L()),od=I(ee());fde();gde();yde();Ede();Pde();Ade()});function Fde(e){var t=e.accessible&&void 0;e.hasOwnProperty("acceptsKeyboardFocus")&&(t=e.acceptsKeyboardFocus);var r=e.size/2,n={borderRadius:r},o=void 0,a=!0,d=void 0;return wde.createElement(kde,m({},e,{focusable:t,imageOverflowWorkaround:n,textOverflowWorkaround:o,useWhiteTextBoy:a,specifyContainerBorder:d}))}var wde,Ode=f(()=>{"use strict";s();k();wde=I(L());Dde()});function wwe(e){switch(e){default:case"SmallStandard":return{fontFamily:$L,fontSize:zL,fontWeight:rA};case"SmallSecondary":return{fontFamily:$L,fontSize:zL,fontWeight:rA};case"MediumBold":return{fontFamily:$L,fontSize:bde,fontWeight:rA}}}var Nde,$L,Mde,Lde=f(()=>{"use strict";s();uc();GL();Nde=I(ee()),$L="SegoeUI",Mde=to(function(e){return Nde.StyleSheet.create({text:wwe(e)})})});var Fwe,Hde=f(()=>{"use strict";s();Fwe=I(ee())});function Ap(e){var t=e.children,r=e.style,n=e.textStyle,o=Owe(e,["children","style","textStyle"]),a=Mde(n);return nT.createElement(oT.Text,Object.assign({},o,{style:[a.text,r]}),t)}function Bde(){var e=du();return nT.createElement(oT.ActivityIndicator,{color:e.semanticColors.activityIndicatorColor})}function Ude(e){return nT.createElement(Yi,Object.assign({},e,{dismissBehaviors:["preventDismissOnKeyDown"]}))}var nT,oT,Ll,Owe,Vde,jde,Hl=f(()=>{"use strict";s();Ode();tT();Js();nT=I(L()),oT=I(ee());Lde();Ll=I(ee());Hde();Owe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};Vde={small:40},jde=function(t){return nT.createElement(Fde,{accessibilityLabel:"",accessible:!1,acceptsKeyboardFocus:void 0,email:t.email,imageSource:t.source,name:t.displayName,showTextBoy:!0,size:t.size})}});var Wde,zde,Gde=f(()=>{"use strict";s();tT();Wde=I(L());Hl();zde=function(t){var r=t.onDismiss,n=t.children,o=t.calloutPositioningTarget,a=t.maxHeight,d=du();return o?Wde.createElement(Ude,{onDismiss:r,target:o,maxHeight:a,borderColor:d==null?void 0:d.semanticColors.menuDivider,borderWidth:1,backgroundColor:d==null?void 0:d.semanticColors.menuBackground},n):null}});var uu,qde,Kde=f(()=>{"use strict";s();k();Ta();_2();uu=I(L()),qde=function(e){X(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stats=void 0,r}return t.prototype.componentDidMount=function(){this.addRenderToStats()},t.prototype.componentDidUpdate=function(){this.addRenderToStats()},t.prototype.componentWillUnmount=function(){this.logStats()},t.prototype.render=function(){switch(uu.Children.count(this.props.children)){case 0:return null;case 1:return uu.Children.only(this.props.children);default:return uu.createElement(uu.Fragment,null,this.props.children)}},t.prototype.shouldAddMeasure=function(){var r=!!this.stats&&this.stats.finishedLoading,n=!r&&!!this.props.finishedLoading;return n&&!!this.props.navigationStartCheckpoint.markName},t.prototype.addRenderToStats=function(){var r=Date.now(),n=this.props.navigationStartCheckpoint;if(this.stats&&this.stats.navigationStartCheckpoint!==n&&this.logStats(),this.shouldAddMeasure())try{performance.measure("\u23F3 EUPL : ".concat(this.props.componentName),this.props.navigationStartCheckpoint.markName)}catch(o){}this.stats?this.stats.finishedLoading?this.stats=rd(this.stats,{extraRenderCount:this.stats.extraRenderCount+1}):this.stats=rd(this.stats,{lastRenderTime:r,renderCount:this.stats.renderCount+1,finishedLoading:!!this.props.finishedLoading}):this.stats={navigationStartCheckpoint:n,firstRenderTime:r,lastRenderTime:r,renderCount:1,finishedLoading:!!this.props.finishedLoading,extraRenderCount:0}},t.prototype.logStats=function(){if(this.stats){var r=this.stats.navigationStartCheckpoint!==Fx,n=r?this.stats.lastRenderTime-this.stats.navigationStartCheckpoint.timestamp:0,o=r?m(m({},this.props.logProperties||{}),{componentName:this.props.componentName,navigationStartTime:this.stats.navigationStartCheckpoint.timestamp.toString(),firstRenderTime:this.stats.firstRenderTime.toString(),lastRenderTime:this.stats.lastRenderTime.toString(),renderCount:this.stats.renderCount.toString(),finishedLoading:this.stats.finishedLoading?"true":"false",extraRenderCount:this.stats.extraRenderCount.toString()}):m(m({},this.props.logProperties||{}),{componentName:this.props.componentName});this.props.logResult("EUPL_".concat(this.props.componentName),this.props.featureName,n,o),this.stats=void 0}},t}(uu.Component)});var jo,QL=f(()=>{"use strict";s();(function(e){e[e.ESCAPE=0]="ESCAPE",e[e.ENTER=1]="ENTER",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN",e[e.TAB=4]="TAB"})(jo||(jo={}))});var Yde,iT,nA,XL=f(()=>{"use strict";s();Yde=I(Nh());P2();Kde();sc();iT=I(L());BL();WR();QL();nA=function(t){return function(r){(0,Yde.default)(n,r);function n(a){var d;return d=r.call(this,a)||this,d.onQueryChanged=function(c){var u=d.props,l=u.inputId,p=u.lppAppContext,g=u.shouldSkipFirstSuggestionFocus;$se(p,c,l);var h=g?-1:0;d.resetSelectedSuggestionIndex(h);var x=E2();d.setState({navigationStartCheckpoint:x,loadSuggestionsAmountMultiplier:1})},d.onCustomKeyPressed=function(c){var u=d.props.isOpen;if(u)switch(c){case jo.DOWN:case jo.UP:d.onSelectedSuggestionIndexChanged(c);break;case jo.ESCAPE:d.onDismissed("userDismissed");break;case jo.TAB:case jo.ENTER:d.onSelectSuggestionKeyPressed();break;default:break}},d.onSelectSuggestionKeyPressed=function(){var c=d.props.suggestionsSet.suggestions,u=d.state.selectedSuggestionIndex;if(!(c.length===0||u<0||u>=c.length)){var l=c[u];d.onSuggestionSelected(l)}},d.onSuggestionSelected=function(c){var u=d.props,l=u.currentQuery,p=u.inputId,g=u.lppAppContext,h=u.onSuggestionSelected,x=u.suggestionsSet,y=x.suggestions.map(function(T){return c.Id===T.Id}).indexOf(!0);Xse(g,c,p,l.length,x.suggestions.length,y),h&&h(c),d.onDismissed("suggestionSelected"),d.resetSelectedSuggestionIndex()},d.onDismissed=function(c){var u=d.props,l=u.currentQuery,p=u.inputId,g=u.lppAppContext,h=u.onDismiss,x=u.suggestionsSet;h&&h(),eA(g,c,p,l.length,x.suggestions.length),d.resetSelectedSuggestionIndex()},d.onScrollEndApproaching=function(){var c=d.props,u=c.currentQuery,l=c.lppAppContext,p=d.state.loadSuggestionsAmountMultiplier;if(l.settings.loadMoreSuggestionsOnScroll&&p<yse){var g=p+1,h=d.props.inputId;Qse(l,u,h,g),d.setState(Object.assign(Object.assign({},d.state),{loadSuggestionsAmountMultiplier:g}))}},d.onSelectedSuggestionIndexChanged=function(c){var u=d.props.suggestionsSet.suggestions,l=d.state.selectedSuggestionIndex,p=-1;c===jo.DOWN?p=Math.min(l+1,u.length-1):p=Math.max(l-1,0),d.resetSelectedSuggestionIndex(p)},d.resetSelectedSuggestionIndex=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;d.setState({selectedSuggestionIndex:c})},d.state={loadSuggestionsAmountMultiplier:1,navigationStartCheckpoint:Fx,selectedSuggestionIndex:-1},d}var o=n.prototype;return o.shouldComponentUpdate=function(d,c){var u=this.props.lppAppContext;return this.props.isOpen&&!d.isOpen&&u.generateNewSuggestionListCorrelationId(),!Vc(this.props,d)||!Vc(this.state,c)},o.componentDidMount=function(){var d=this.props.componentRef;d&&d(this)},o.componentWillUnmount=function(){var d=this.props.componentRef;d&&d(null)},o.render=function(){var d=this.props,c=d.suggestionsSet,u=d.lppAppContext,l=this.state,p=l.navigationStartCheckpoint,g=l.selectedSuggestionIndex,h=Object.assign(Object.assign({},this.props),{selectedSuggestionIndex:g}),x=h;return iT.createElement(qde,{componentName:"SuggestionListCallout",featureName:"Performance",navigationStartCheckpoint:p,finishedLoading:c.suggestions.length>0||c.queryStatus==="Finished",logResult:u.createEUPLLogFunction()},iT.createElement(t,Object.assign({},x,{onSuggestionSelected:this.onSuggestionSelected,onScrollEndApproaching:this.onScrollEndApproaching})))},n}(iT.Component)}});var lu,oA,$de,aT=f(()=>{"use strict";s();lu=52,oA=208,$de=300});function Qde(){return Nwe(this,void 0,void 0,function*(){return Promise.resolve(!1)})}var Nwe,Xde=f(()=>{"use strict";s();Nwe=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}});var iA,Jde,Zde,ece=f(()=>{"use strict";s();iA=I(L()),Jde=I(ee());Hl();Zde=function(t){return iA.createElement(Ll.View,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}},iA.createElement(Bde,null),iA.createElement(Ap,{style:Jde.StyleSheet.flatten([{paddingLeft:6},t.textStyle]),textStyle:"SmallSecondary"},t.text))}});var tce,rce=f(()=>{"use strict";s();Ta();tce=function(t){var r=t.strings;if(t.suggestionsSetHasErrors)return r.error;switch(t.suggestionsSetCompleteness){case"Empty":return r.emptyResults;case"Limited":return r.limitedResults;case"Full":return r.allResults;default:return dc(t.suggestionsSetCompleteness,"")}}});var nce,oce=f(()=>{"use strict";s();nce={centeredText:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}}});var ice,ace,sce=f(()=>{"use strict";s();uc();ice=I(ee());oce();ace=to(function(e){return ice.StyleSheet.create({centeredText:nce.centeredText,secondaryLabelColor:{color:e==null?void 0:e.semanticColors.labelColor}})})});var aA,dce,cce,Mwe,uce=f(()=>{"use strict";s();aA=I(L()),dce=I(ee());Hl();ece();rce();sce();cce=function(t){var r=ace(t.theme);switch(t.queryStatus){case"InProgress":return aA.createElement(Zde,{text:t.strings.loading,textStyle:r.secondaryLabelColor});case"Finished":return Mwe(t,r);default:return null}},Mwe=function(t,r){var n=tce(t);return aA.createElement(dce.View,{style:r.centeredText},aA.createElement(Ap,{style:r.secondaryLabelColor,textStyle:"SmallSecondary"},n))}});function lce(e){return e.source==="UserTypedSuggestion"}var fce=f(()=>{"use strict";s()});var sA,pce=f(()=>{"use strict";s();sA={suggestionInfoContainer:{flexDirection:"row",alignItems:"center"},contentContainer:{overflow:"hidden",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},image:{alignSelf:"center",marginVertical:12},descriptionContainer:{alignItems:"center",flex:1,flexDirection:"row",justifyContent:"space-between",paddingRight:12,paddingVertical:12}}});var mce,gce,hce,yce,JL,Cce=f(()=>{"use strict";s();uc();mce=I(ee());aT();pce();gce=to(function(e,t,r){var n=e.semanticColors;return t?{backgroundColor:r?n.menuItemBackgroundHovered:n.menuItemBackgroundPressed,borderWidth:1,borderColor:n.controlFocusedBorderColor,borderStyle:"solid"}:{backgroundColor:r?n.menuItemBackgroundHovered:n.menuBackground,borderWidth:1,borderColor:"transparent",borderStyle:"solid"}}),hce=to(function(e,t,r){var n=e.semanticColors;return t?{color:r?n.menuItemTextHovered:n.buttonTextPressed}:{color:r?n.menuItemTextHovered:n.buttonText}}),yce=to(function(e,t,r){var n=e.semanticColors;return t?{color:r?n.menuItemTextHovered:n.buttonTextPressed}:{color:r?n.menuItemTextHovered:n.menuItemText}}),JL=to(function(e){var t=e.semanticColors;return mce.StyleSheet.create({contentContainer:Object.assign(Object.assign({},sA.contentContainer),{backgroundColor:t.menuBackground,paddingHorizontal:16,minHeight:lu}),image:sA.image,descriptionContainer:Object.assign(Object.assign({},sA.descriptionContainer),{marginLeft:16})})})});function Tce(e){var t=ii.useState(!1),r=(0,vce.default)(t,2),n=r[0],o=r[1],a=du(),d=e.onSuggestionPressed,c=e.isSelected;return ii.createElement(xce.TouchableHighlight,{onPress:d,accessibilityLabel:"".concat(e.name," ").concat(e.email),accessibilityActions:[{name:"Select"}],accessibilityState:{selected:c},accessibilityRole:"listitem"},ii.createElement(Ll.View,{style:[JL(a).contentContainer,gce(a,c,n)],onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},accessibilityState:{selected:c},accessibilityActions:[{name:"Select"}]},ii.createElement(Lwe,Object.assign({},e,{isHovered:n,isSelected:c}))))}function Lwe(e){var t=e.email,r=e.name,n=e.imageSource,o=e.isSelected,a=e.onSuggestionInFocus,d=e.itemPosition,c=e.totalCount,u=e.strings,l=e.isHovered,p=l===void 0?!1:l,g=du(),h=JL(g),x=lce(e)?u.useThisAddress:t;return ii.useEffect(function(){o&&a&&a("".concat(r," ").concat(t," ")+"".concat(u.selectedSuggestionAccessibilityLabel," ")+"".concat(d," ")+"".concat(u.selectedSuggestionNumberAccessibilityLabel," ")+"".concat(c,"."))},[o]),ii.createElement(ii.Fragment,null,ii.createElement(jde,{accessibilityLabel:t,displayName:r,email:t,size:Vde.small,source:n}),ii.createElement(Ll.View,{style:h.descriptionContainer},ii.createElement(Ll.View,null,ii.createElement(Ap,{style:yce(g,o,p),textStyle:"MediumBold",numberOfLines:1},r),ii.createElement(Ap,{style:hce(g,o,p),textStyle:"SmallStandard",numberOfLines:1},x))))}var vce,ii,xce,bce=f(()=>{"use strict";s();vce=I(RR());tT();ii=I(L()),xce=I(ee());Hl();fce();Cce()});var Sce,Ice,Ece,ZL,Pce=f(()=>{"use strict";s();Sce=I(Nh()),Ice=I(L()),Ece=I(ee()),ZL=function(e){(0,Sce.default)(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;return r.componentDidMount=function(){this.props.suggestionCount!=null&&this.accessAnnouncement()},r.componentDidUpdate=function(o){this.props.suggestionCount!=null&&this.props.queryStatus==="Finished"&&o.queryStatus!=="Finished"&&this.accessAnnouncement()},r.accessAnnouncement=function(){Ece.AccessibilityInfo.announceForAccessibility(this.props.suggestionCount===0?this.props.strings.emptyResults:this.props.strings.suggestionsAnnouncement+String(this.props.suggestionCount))},r.render=function(){return null},t}(Ice.Component)});var _ce=f(()=>{"use strict";s();Pce()});function Ace(e){var t=e.data,r=e.renderItem,n=e.onEndReached,o=e.onEndReachedThreshold,a=e.ListFooterComponent,d=e.listItemHeight,c=e.listRef,u=e.keyboardShouldPersistTaps,l=e.scrollListStyle,p=e.onContentSizeChange,g=48,h=function(y){var T=y.nativeEvent.contentSize.height,b=y.nativeEvent.contentOffset.y;b>=T-d*o-y.nativeEvent.layoutMeasurement.height&&n()};return eH.createElement(Rce.ScrollView,{scrollEventThrottle:g,ref:c,style:l,onScroll:h,keyboardShouldPersistTaps:u,onContentSizeChange:p,accessibilityRole:"list"},t.map(r),eH.createElement(a,null))}var eH,Rce,kce=f(()=>{"use strict";s();eH=I(L()),Rce=I(ee());Hl()});var Dce,wce,Fce,Oce=f(()=>{"use strict";s();uc();Dce=I(ee());aT();Hl();wce=to(function(e,t,r){return Object.assign({width:e},{height:Math.min(t,oA)})}),Fce=to(function(e){return Dce.StyleSheet.create({container:{flex:0,alignItems:"stretch",flexDirection:"column",minHeight:lu},informationMessage:{paddingVertical:12,height:lu},content:{backgroundColor:e==null?void 0:e.semanticColors.menuBackground}})})});var Nce,tH,Mce=f(()=>{"use strict";s();Nce=I(ee());aT();tH=function(t,r,n,o){if(t&&t.current)try{var a=n*o,d=a+n,c=d-Math.min(r,oA);Nce.InteractionManager.runAfterInteractions(function(){var u;(u=t==null?void 0:t.current)===null||u===void 0||u.scrollTo({x:0,y:c,animated:!0})})}catch(u){}}});function Lce(e){var t=no.useRef(null),r=no.useRef(null),n=e.maxHeight,o=e.maxWidth,a=e.onSuggestionInFocus,d=e.onSuggestionPressed,c=e.suggestionsSet,u=e.selectedSuggestionIndex,l=e.strings,p=e.theme,g=function(){return{width:o||$de}},h=no.useState(g()),x=(0,rH.default)(h,2),y=x[0],T=x[1],b=no.useState(lu),S=(0,rH.default)(b,2),E=S[0],P=S[1],_=y.width,D=Math.min(o||_,_),O=c.completeness,H=c.hasErrors,V=c.queryStatus,M=c.suggestions,G=M.length,K=du(),z=Fce(K),$=function(){var ae=e.onScrollEndApproaching;ae&&ae()};no.useEffect(function(){},[]);var q=function(ae,ie){var Te=(ie-lu)/G;P(Te)};return no.useEffect(function(){var re;M&&M.length&&tH(t,n,E,Math.max(0,u)),(re=e.accessibilityRef)===null||re===void 0||re.call(e,t)},[]),no.useEffect(function(){M&&u>-1&&u<M.length&&tH(t,n,E,u)},[u]),no.useEffect(function(){M&&M.length===0&&a&&a("")},[M&&M.length>0]),no.useEffect(function(){Qde().then(function(re){re&&(r.current,void 0)})}),no.createElement(dA.SafeAreaView,{style:[wce(D,n,G),z.container]},no.createElement(ZL,{queryStatus:c.queryStatus,suggestionCount:G,strings:l}),no.createElement(Ace,{listRef:t,scrollListStyle:z.content,listItemHeight:Math.max(lu,E),keyboardShouldPersistTaps:"always",onEndReached:$,onEndReachedThreshold:.5,onContentSizeChange:q,ListFooterComponent:function(){return no.createElement(dA.View,{style:z.informationMessage},no.createElement(cce,{key:"information",queryStatus:V,suggestionsSetHasErrors:H,suggestionsSetCompleteness:O,strings:l,theme:p}))},data:M,renderItem:function(ae,ie){return no.createElement(Tce,{id:"SuggestionInfo_"+ae.Id,suggestionRef:ie===u?r:void 0,key:ae.Id,theme:K,email:GR(ae),isSelected:ie===u,name:ae.Name,onSuggestionInFocus:a,onSuggestionPressed:function(){return d(ae)},imageSource:ae.ImageSource,source:ae.Source,itemPosition:ie+1,totalCount:G,strings:l})}}))}var rH,no,dA,Hce=f(()=>{"use strict";s();rH=I(RR());tT();no=I(L()),dA=I(ee());aT();Xde();$h();uce();Hl();bce();_ce();kce();Oce();Mce()});var Bce,cA,uA,Hwe,Bwe,nH=f(()=>{"use strict";s();Bce=I(Nh()),cA=I(L());bs();YR();eT();Hce();XL();uA=function(e){(0,Bce.default)(t,e);function t(){var n;return n=e.apply(this,arguments)||this,n.id=void 0,n}var r=t.prototype;return r.componentDidMount=function(){var o=this.props,a=o.isOpen,d=o.onShow;a&&d&&d();var c=this.props.lppAppContext,u=c.clientType;(u==="OfficeiOS"||u==="OfficeAndroid"||u==="OfficeWin32")&&(this.id=setInterval(function(){return null},500))},r.componentWillUnmount=function(){this.id&&clearInterval(this.id)},r.render=function(){var o=this.props.isOpen;if(!o)return null;var a=this.props,d=a.maxHeight,c=a.maxWidth,u=a.suggestionHeight,l=a.selectedSuggestionIndex,p=a.onSuggestionInFocus,g=a.strings,h=a.suggestionsSet,x=a.onSuggestionSelected,y=a.onScrollEndApproaching,T=a.theme,b=a.onSuggestionHighlighted,S=a.suggestionListId,E=a.accessibilitySelectionRef;return cA.createElement(Lce,{maxHeight:d,maxWidth:c,suggestionHeight:u,selectedSuggestionIndex:l,onSuggestionPressed:x,onSuggestionInFocus:p,suggestionsSet:h,strings:g,onScrollEndApproaching:y,theme:T,suggestionListId:S,onSuggestionHighlighted:b,accessibilityRef:E})},t}(cA.Component),Hwe=function(t,r){var n=r.selectedSuggestions,o=r.inputId,a=KR(t,o),d=ZR(t,a,n);return Object.assign(Object.assign({},r),{currentQuery:a,suggestionsSet:d})},Bwe=na(Hwe)(nA(uA))});var Uce,sT,Uwe,Vwe,Vce,jce=f(()=>{"use strict";s();Uce=I(Nh()),sT=I(L());bs();BL();YR();eT();Gde();XL();nH();Uwe=function(e){(0,Uce.default)(t,e);function t(){var n;return n=e.apply(this,arguments)||this,n.onCalloutDismissed=function(){var o=n.props,a=o.currentQuery,d=o.inputId,c=o.lppAppContext,u=o.onDismiss,l=o.suggestionsSet;u&&u(),eA(c,"userDismissed",d,a.length,l.suggestions.length)},n}var r=t.prototype;return r.render=function(){var o=this.props.isOpen;if(!o)return null;var a=this.props,d=a.currentQuery,c=a.maxHeight,u=a.maxWidth,l=a.suggestionHeight,p=a.strings,g=a.calloutPositioningTarget,h=a.inputId,x=a.onShow,y=a.onDismiss,T=a.calloutAnchorRectangle,b=a.onSuggestionInFocus,S=a.onSuggestionSelected,E=a.selectedSuggestions,P=a.lppAppContext,_=a.suggestionsSet,D=a.selectedSuggestionIndex,O=a.onScrollEndApproaching,H=a.theme,V=a.onSuggestionHighlighted,M=a.suggestionListId,G=a.preventDismissOnScroll,K=a.accessibilitySelectionRef;return sT.createElement(zde,{maxHeight:c,maxWidth:u,suggestionHeight:l,onDismiss:this.onCalloutDismissed,calloutAnchorRectangle:T,calloutPositioningTarget:g,inputId:h,preventDismissOnScroll:G},sT.createElement(uA,{currentQuery:d,isOpen:o,inputId:h,maxHeight:c,maxWidth:u,suggestionHeight:l,onScrollEndApproaching:O,onSuggestionInFocus:b,onSuggestionSelected:S,onShow:x,onDismiss:y,selectedSuggestions:E,strings:p,lppAppContext:P,suggestionsSet:_,selectedSuggestionIndex:D,theme:H,suggestionListId:M,onSuggestionHighlighted:V,accessibilitySelectionRef:K}))},t}(sT.Component),Vwe=function(t,r){var n=r.selectedSuggestions,o=r.inputId,a=KR(t,o),d=ZR(t,a,n);return Object.assign(Object.assign({},r),{currentQuery:a,suggestionsSet:d})},Vce=na(Vwe)(nA(Uwe))});var zce=Re((znr,dT)=>{s();var jwe=PL();function Wce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jwe(n.key),n)}}function Wwe(e,t,r){return t&&Wce(e.prototype,t),r&&Wce(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}dT.exports=Wwe,dT.exports.__esModule=!0,dT.exports.default=dT.exports});var lc,Ln,Sa,oH=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"})(lc||(lc={}));(function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.RequiredDiagnosticData=10]="RequiredDiagnosticData",e[e.OptionalDiagnosticData=100]="OptionalDiagnosticData",e[e.RequiredServiceData=110]="RequiredServiceData",e[e.AlwaysOnRequiredServiceData=120]="AlwaysOnRequiredServiceData"})(Ln||(Ln={}));(function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"})(Sa||(Sa={}))});function Gce(e,t){return t===void 0&&(t=[]),function(r){var n=e(r.event,r.additionalProperties,r.eventNameOverride);if(n){var o;Array.isArray(n)?o=n.map(function(d){return{awtEventData:d,dataCategories:lc.NotSet,diagnosticLevel:Ln.OptionalDiagnosticData}}):o=[{awtEventData:n,dataCategories:lc.NotSet,diagnosticLevel:Ln.OptionalDiagnosticData}];var a=o;return t.forEach(function(d){a=$M(a,function(c){return d(r.event,c)})}),a}}}var cT=f(()=>{"use strict";s();sc();oH()});function uT(e){return"exportOptions"in e&&!!(e.exportOptions&&e.exportOptions.exportType==="UserInteraction")}var iH=f(()=>{"use strict";s()});var zwe,Gwe,aH,qce=f(()=>{"use strict";s();cT();iH();zwe=console.log,Gwe=function(){function e(t,r,n,o,a,d){r===void 0&&(r="NO_USER"),n===void 0&&(n="NO_USER"),o===void 0&&(o="NO_TENANT"),a===void 0&&(a="NO_REGION"),d===void 0&&(d=zwe),this.eventMapper=t,this._userAadObjectId=r,this._userPuid=n,this._tenantAadObjectId=o,this._lokiRegion=a,this.consoleLog=d}return e.prototype.getCommonProperties=function(t){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:uT(t),isConsoleLogger:!0}},e.prototype.canConsumeEvent=function(t){return!0},e.prototype.consume=function(t){var r=this;if(t){var n=this.getCommonProperties(t),o=this.eventMapper({event:t,additionalProperties:n});if(!o){this.consoleLog(JSON.parse(JSON.stringify(t)));return}Array.isArray(o)||(o=[o]),o.forEach(function(a){var d,c=(d=a.awtEventData.properties)===null||d===void 0?void 0:d.eventId;try{var u=a.awtEventData.properties.properties&&JSON.parse(a.awtEventData.properties.properties);u&&(a.awtEventData.properties.properties=u)}catch(l){}r.consoleLog("%cLog: ".concat(a.awtEventData.name||a.awtEventData.Name," ").concat(c?"| ".concat(c):""," | Level: ").concat(Ln[a.diagnosticLevel]," | Category: ").concat(lc[a.dataCategories]||a.dataCategories,"\n"),"font-weight: bold",a)})}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},e}(),aH=Gwe});var kp,lA=f(()=>{"use strict";s();kp={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}});var qwe,Kwe,Ywe,lT,Kce=f(()=>{"use strict";s();wx();lA();qwe=32,Kwe=100,Ywe=function(){function e(t,r,n,o){this._source=t,this._version=r,this._properties=o||{},this._clientCorrelationId=n&&n.trim()||"",(this._clientCorrelationId.length<qwe||this._clientCorrelationId.length>Kwe)&&(this._clientCorrelationId=Vo(),n&&(this._properties[kp.SOURCE_CORRELATION_ID]=n))}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientCorrelationId",{get:function(){return this._clientCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),e}(),lT=Ywe});var $we,fT,Yce=f(()=>{"use strict";s();$we=function(){function e(t){this.consumers=t||[]}return e.prototype.broadcastEvent=function(t){t&&this.consumers.forEach(function(r){r.canConsumeEvent(t)&&r.consume(t)})},e.prototype.broadcastFlush=function(){return Promise.all(this.consumers.map(function(t){return t.flush()})).then()},e.prototype.broadcastDestroy=function(){this.consumers.forEach(function(t){t.destroy()})},e.prototype.registerConsumer=function(t){this.consumers.push(t)},e}(),fT=$we});var Zh,sH=f(()=>{"use strict";s();Zh="Unknown"});var fu,dH=f(()=>{"use strict";s();fu={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}});function pT(e){return Qwe.indexOf(e)>-1}function mT(e){return Xwe.indexOf(e)===-1}var Qwe,Xwe,cH=f(()=>{"use strict";s();Qwe=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],Xwe=["Stikkontakt","DataLoadStartAction","NoLogging","None"]});var Jwe,$ce,Qce=f(()=>{"use strict";s();k();wx();cc();sH();lA();dH();cH();Jwe=function(){function e(t,r,n,o,a,d,c){this.eventHubPromise=t,this.monitoringData=r,this.scenarioName=n,this.featureName=o,this.staticProperties=a,this.lookupError=d,this.isVerboseLoggingEnabled=c,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=fu.MONITOR_IN_INVALID_STATE,this.transactionId=Vo(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(t){return t.broadcastFlush()})},e.prototype.success=function(t,r){this.endEvent(t,fu.SUCCESS,r)},e.prototype.expectedFailure=function(t,r){this.endEvent(t,fu.EXPECTED_FAILURE,r)},e.prototype.unexpectedFailure=function(t,r){this.endEvent(t,fu.UNEXPECTED_FAILURE,r)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,fu.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=new Date().getTime()},e.prototype.endEvent=function(t,r,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=new Date().getTime()-this.startTime,this.lastScenarioState=r):this.lastScenarioState=fu.MONITOR_IN_INVALID_STATE,this.lastTag=t,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(t,r,n){return Gt(this,void 0,void 0,function(){var o,a,d,c,u,l;return gt(this,function(p){switch(p.label){case 0:return!mT(this.featureName)||pT(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(o=t?"".concat(this.scenarioName,"_").concat(r,"_").concat(t):"".concat(this.scenarioName,"_").concat(r),[4,this.eventHubPromise]):[3,5];case 1:return a=p.sent(),c=(d=a).broadcastEvent,l={eventId:o,version:this.monitoringData.version?this.monitoringData.version:Zh,type:"QoS"},n&&Dr(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=p.sent(),[3,4];case 3:u=void 0,p.label=4;case 4:c.apply(d,[(l.midgardError=u,l.source=this.monitoringData.source,l.featureName=this.featureName,l.clientCorrelationid=this.monitoringData.clientCorrelationId,l.qosScenarioName=this.scenarioName,l.qosEventType=r,l.qosTagId=t===null?void 0:t,l.duration=this.duration,l.properties=this.getProperties(n),l)]),p.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(t){var r;return m(m(m(m({},t),(r={},r[kp.CLIENT_TIMESTAMP]=new Date().getTime().toString(),r[kp.TRANSACTION_ID]=this.transactionId,r)),this.monitoringData.properties),this.staticProperties())},e}(),$ce=Jwe});var Zwe,gT,Xce=f(()=>{"use strict";s();k();cc();sH();lA();dH();Qce();cH();Zwe=function(){function e(t,r,n,o){var a=this;this.eventHubPromise=t,this.monitoringData=r,this.logVerbose=n,this.staticProperties=o,this.errorMap={},this.registerErrors=function(d,c){a.errorMap[d]=m({},c)},this.logEUPL=function(d,c,u,l){var p=fu.SUCCESS,g="".concat(d,"_").concat(p);a.eventHubPromise.then(function(h){return h.broadcastEvent({eventId:g,version:a.monitoringData.version?a.monitoringData.version:Zh,type:"EUPL",source:a.monitoringData.source,featureName:c,clientCorrelationid:a.monitoringData.clientCorrelationId,qosScenarioName:d,qosEventType:p,qosTagId:void 0,duration:u,properties:a.getProperties(l)})})},this.logQoS=function(d,c,u,l,p,g,h,x){if(!(!mT(l)||pT(l)&&!a.logVerbose())){var y=g?"".concat(d,"_").concat(c,"_").concat(g):"".concat(d,"_").concat(c);a.eventHubPromise.then(function(T){return T.broadcastEvent({eventId:y,version:a.monitoringData.version?a.monitoringData.version:Zh,type:"QoS",midgardError:x&&Dr(x.midgardError)?a.lookupError(x.midgardError):void 0,source:a.monitoringData.source,featureName:l,clientCorrelationid:a.monitoringData.clientCorrelationId,qosScenarioName:d,qosEventType:c,qosTagId:g===null?void 0:g,duration:p,properties:a.getProperties(m(m({},x),{result:u,RequestId:h}))})})}}}return e.prototype.startMonitor=function(t,r){var n=this;return new $ce(this.eventHubPromise,this.monitoringData,t,r,function(){return n.staticProperties()},function(o){return Promise.resolve(n.lookupError(o))},this.logVerbose())},e.prototype.logEvent=function(t){this.log(t,"Event")},e.prototype.logUserInteractionEvent=function(t){var r={exportType:"UserInteraction",exportName:t.eventId};t=m(m({},t),{exportOptions:r}),this.log(t,"Event")},e.prototype.logError=function(t){this.log(t,"Error")},e.prototype.logTrace=function(t){this.log(t,"Trace")},e.prototype.flush=function(){return this.eventHubPromise.then(function(t){return t.broadcastFlush()})},e.prototype.destroy=function(){return this.eventHubPromise.then(function(t){return t.broadcastDestroy()})},e.prototype.setEventHub=function(t){this.eventHubPromise=Promise.resolve(t)},e.prototype.getEventHub=function(){return this.eventHubPromise},e.prototype.getStaticProperties=function(){return this.staticProperties},e.prototype.setStaticProperties=function(t){this.staticProperties=t},e.prototype.lookupError=function(t){if(!Dr(t))return"Invalid midgardError";var r=this.errorMap[t.family];if(!r)return"Unknown family ".concat(t.family,": ").concat(t.code);var n=r[t.code];return n?"".concat(t.family,": ").concat(n):"Unknown code: ".concat(t.family,": ").concat(t.code)},e.prototype.log=function(t,r){mT(t.featureName)&&(!pT(t.featureName)||this.logVerbose())&&this.broadcastEvent(t.eventId,t.featureName,r,t.exportOptions,t.properties,t.diagnosticLevel)},e.prototype.broadcastEvent=function(t,r,n,o,a,d){if(t&&this.monitoringData.source&&this.monitoringData.clientCorrelationId){var c={eventId:t,version:this.monitoringData.version?this.monitoringData.version:Zh,type:n,midgardError:a&&Dr(a.midgardError)?this.lookupError(a.midgardError):void 0,source:this.monitoringData.source,featureName:r,clientCorrelationid:this.monitoringData.clientCorrelationId,qosScenarioName:void 0,qosEventType:void 0,qosTagId:void 0,duration:void 0,exportOptions:o,properties:this.getProperties(a)},u=d?m(m({},c),{diagnosticLevel:d}):c;this.eventHubPromise.then(function(l){return l.broadcastEvent(u)})}},e.prototype.getProperties=function(t){var r;return m(m(m((r={},r[kp.CLIENT_TIMESTAMP]=new Date().getTime().toString(),r),this.monitoringData.properties),this.staticProperties()),t)},e}(),gT=Zwe});function Jce(){return new eFe}var eFe,Zce=f(()=>{"use strict";s();eFe=function(){function e(){}return e.prototype.flush=function(){return Promise.resolve()},e.prototype.success=function(t,r){},e.prototype.expectedFailure=function(t,r){},e.prototype.unexpectedFailure=function(t,r){},e}()});var Uor,eue=f(()=>{"use strict";s();Zce();Uor=function(){function e(){}return e.prototype.startMonitor=function(t,r,n){return Jce()},e.prototype.logEvent=function(){},e.prototype.logUserInteractionEvent=function(){},e.prototype.logError=function(){},e.prototype.logQoS=function(){},e.prototype.logTrace=function(){},e.prototype.logEUPL=function(){},e.prototype.log=function(){},e.prototype.flush=function(){return Promise.resolve()},e.prototype.setEventHub=function(){},e.prototype.getStaticProperties=function(){return function(){return{}}},e.prototype.setStaticProperties=function(){},e.prototype.registerErrors=function(){},e}()});var tue=Re(ey=>{"use strict";s();Object.defineProperty(ey,"__esModule",{value:!0});var tFe;(function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"})(tFe=ey.AWTUserIdType||(ey.AWTUserIdType={}));var rFe;(function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"})(rFe=ey.AWTSessionState||(ey.AWTSessionState={}))});var fA,rue=f(()=>{"use strict";s();fA=I(tue())});var hT=f(()=>{"use strict";s();qce();Kce();Yce();Xce();Wh();eue()});var Ia,nue=f(()=>{"use strict";s();(function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"})(Ia||(Ia={}))});function uH(e){switch(e){case"Df":return Ia.Dogfood;case"Msit":return Ia.MSIT;case"Blackforest":return Ia.Blackforest;case"GccModerate":return Ia.GccModerate;case"GccHigh":return Ia.GccHigh;case"DoD":return Ia.DOD;case"Gallatin":return Ia.Gallatin;case"Prod":return Ia.TopLevel;case"AG08":return Ia.AG08;case"AG09":return Ia.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}var oue=f(()=>{"use strict";s();nue()});var iue=f(()=>{"use strict";s();oue()});var sue=Re(pA=>{"use strict";s();var aue=(Ol(),Hk(Fre)).compose;pA.__esModule=!0;pA.composeWithDevTools=function(){if(arguments.length!==0)return typeof arguments[0]=="object"?aue:aue.apply(null,arguments)};pA.devToolsEnhancer=function(){return function(e){return e}}});var ye,due,lH,cue=f(()=>{"use strict";s();ye={Generic:"",GDPR:""},due={Prod:{Generic:"33d70a864599496b982a39f036f71122-2064703e-3a9d-4d90-8362-eec08dffe8e8-7176",GDPR:""},Dev:{Generic:"ceb930c7c5d041e899b6de945bc4c6ee-e9ee0db4-0fa5-437b-966d-e8b2950f8d7d-7290",GDPR:""},Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},lH={LivePeopleCards:{Prod:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-9277d376-40b1-48ec-92f5-b2ee3f44345b-7212",GDPR:"f615f561ec88437db01f752caf151695-7cf4617b-dcbd-4b5b-a5eb-0079c1ba008a-6975"},Dev:ye,Blackforest:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-eb71f759-e748-47d9-922a-96d2522430e4-7094",GDPR:"f615f561ec88437db01f752caf151695-18332f16-126d-42b9-a2f4-2dd55a1ec030-6918"},GccHigh:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-5bace7e6-5357-46f3-88e0-449f4eaacb40-7215",GDPR:"f615f561ec88437db01f752caf151695-d48bf8b4-e399-433b-bb04-f0d344722fe4-7383"},DoD:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-7e485978-0dca-4684-abdd-5bcebedd8f2f-7631",GDPR:"f615f561ec88437db01f752caf151695-e653e3c7-d1be-444c-832d-d3707d03bbcd-6862"},Gallatin:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-99d02291-5114-42b3-aa94-ddd964108c06-7145",GDPR:"f615f561ec88437db01f752caf151695-9728472d-c6e2-4067-a597-f0a9e261a858-6852"},AG08:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-e74e132e-f357-44eb-a0b7-941458772fc3-6908",GDPR:"f615f561ec88437db01f752caf151695-c0a58d75-92c7-4136-ac9f-a689166bf700-6735"},AG09:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-17844c21-72d2-418f-b188-8088d55ab78e-7408",GDPR:"f615f561ec88437db01f752caf151695-2bb48ba5-f1c5-459d-978e-4cc61a974ec3-6762"},EU:ye},LivePersonaPicker:{Prod:{Generic:"67199ce661b3472494bbec0bf2e06c27-c34071ab-96bc-40d9-9162-7a83b521b4dd-7282",GDPR:"30b97846c6c640ed90e3b4e06d98a986-b6251ed6-9d7f-4e24-8ace-044e9613d08b-7662"},Dev:ye,Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},OfficeFeed:{Prod:{Generic:"60dd0301e6c846e9b0699cbbe259efb6-c35f87eb-1000-4625-8cab-d2dd316a0ea6-7539",GDPR:"dc2f4eb67f454d4187656e6aa9063e83-ed148abb-5cbb-42bd-9cfc-298b1dd8c444-7942"},Dev:ye,Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},LivePersonaEditor:{Prod:{Generic:"77af0c0ae9af49e684693d42352c0cf7-9d604ea0-ea41-4c75-8897-d7dbb0c7f7e9-7006",GDPR:"d2aac9418005423daf110f7008485383-d48b2953-983d-4b8b-857a-9f724d685b97-7218"},Dev:ye,Blackforest:{Generic:"77af0c0ae9af49e684693d42352c0cf7-2c4a13e2-2fef-4ba6-a12a-a369ed907ff9-7140",GDPR:"d2aac9418005423daf110f7008485383-b85d1253-d229-42c8-9cf6-b8ae20c4b61b-7439"},GccHigh:{Generic:"77af0c0ae9af49e684693d42352c0cf7-8b12b5b0-234b-4f96-a57b-dcf09a10401e-7221",GDPR:"d2aac9418005423daf110f7008485383-ee34f80b-d66c-4c0a-9a75-bd32d151a28d-7184"},DoD:{Generic:"77af0c0ae9af49e684693d42352c0cf7-48932264-dbbc-45fe-9173-0ace4b216b7a-7229",GDPR:"d2aac9418005423daf110f7008485383-5cb0db99-dc8f-4b1e-9076-43821ee4622f-7316"},Gallatin:{Generic:"77af0c0ae9af49e684693d42352c0cf7-531738b2-25b2-424a-b4a8-20fbdae1eed8-7390",GDPR:"d2aac9418005423daf110f7008485383-583a5fc4-1880-4f24-afe4-96ebcba895d1-7235"},AG08:ye,AG09:ye,EU:ye},MicrosoftSearch:due,MicrosoftSearch3S:due,OrgExplorer:{Prod:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""},Dev:ye,Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""}},NamePronunciation:{Prod:{Generic:"cdba0d01d3c24f188e55845778e5505d-a9c8b79c-ea70-49e9-9352-507b2a8df76f-6790",GDPR:""},Dev:{Generic:"c47a2f5cb4e24f409e35cef5e23ac962-73b83934-404c-41d4-b3f1-2296bb746aa1-7252",GDPR:""},Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},CortexTopics:{Prod:{Generic:"8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552",GDPR:""},Dev:ye,Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},EmbeddedOrgChart:{Prod:{Generic:"c1ad6239a4cd4efbb5427a8c14cc89fc-cf33fa48-963e-411b-b007-829fc329adea-7223",GDPR:"6ba9d88a8df4434c89bac4e8f9e31e7e-ca849317-67e5-434a-a207-2b270c0715e6-7054"},Dev:ye,Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},GraphLoop:{Prod:{Generic:"0b9ecc7b7e834bf187902769b46094a5-91edd6e2-c1c7-4a32-970b-ee3285ab394c-6877",GDPR:""},Dev:{Generic:"4a67ed1bd82e40c9af5fed95d457c2b7-d0bad78c-babb-44d1-9b31-5e32c2cc3d98-7303",GDPR:""},Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye},CardLoop:{Prod:{Generic:"78a9315a99bf4c5285101c1864da2e87-546eda6a-798d-4dd6-bea4-ca5713e12d63-6907",GDPR:""},Dev:{Generic:"4176a80892374dd0acaa8eb943c5dd33-6b278dd4-fa10-4100-a804-9dfc2322f668-7573",GDPR:""},Blackforest:ye,GccHigh:ye,DoD:ye,Gallatin:ye,AG08:ye,AG09:ye,EU:ye}}});var nFe,uue,lue=f(()=>{"use strict";s();k();iH();nFe=function(){function e(t,r,n,o,a,d){var c=this;this.sendTelemetryEvent=t,this.eventMapper=r,this.getEventName=n,this.makeDoubleDataField=o,this.makeStringDataField=a,this.makeBooleanDataField=d,this._userAadObjectId="NO_USER",this._userPuid="NO_USER",this._tenantAadObjectId="NO_TENANT",this._lokiRegion="NO_REGION",this.getEventDataFields=function(u){for(var l=[],p=u.properties||{},g=0,h=Object.keys(p);g<h.length;g++){var x=h[g];if(x){var y=p[x];switch(typeof y){case"number":l.push(c.makeDoubleDataField(x,y));break;case"string":l.push(c.makeStringDataField(x,y));break;case"boolean":l.push(c.makeBooleanDataField(x,y));break;case"function":case"object":case"symbol":case"undefined":case"bigint":break;default:""+typeof y}}}return l}}return e.prototype.canConsumeEvent=function(t){return!!t},e.prototype.consume=function(t){var r,n=this.getCommonProperties(t),o=uT(t);if(o){var a=this.eventMapper({event:t,additionalProperties:n,eventNameOverride:(r=t.exportOptions)===null||r===void 0?void 0:r.exportName});this.log(a,!0)}var d=this.eventMapper({event:t,additionalProperties:n});this.log(d,!1)},e.prototype.log=function(t,r){var n=this;if(t)if(Array.isArray(t))t.forEach(function(d){var c=d.awtEventData,u=je(d,["awtEventData"]);n.sendTelemetryEvent(n.getEventName(c,r),n.getEventDataFields(c),u)});else{var o=t.awtEventData,a=je(t,["awtEventData"]);this.sendTelemetryEvent(this.getEventName(o,r),this.getEventDataFields(o),a)}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"userAadObjectId",{set:function(r){r&&(this._userAadObjectId=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userPuid",{set:function(r){r&&(this._userPuid=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenantAadObjectId",{set:function(r){r&&(this._tenantAadObjectId=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lokiRegion",{set:function(r){r&&(this._lokiRegion=r)},enumerable:!1,configurable:!0}),e.prototype.getCommonProperties=function(t){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:uT(t)}},e}(),uue=nFe});function iFe(e,t,r){return!!t&&!!e&&!!r}function fue(e,t,r){return iFe(e,t,r)?{userAadObjectId:e||"",tenantAadObjectId:t||"",userPuid:r||""}:oFe}function pue(e){switch(e){case"https://df.loki.delve.office.com/":return"df";case"https://msit.loki.delve.office.com/":return"msit";case"NO_REGION":return"NO_RING";default:return"prod"}}var oFe,fH=f(()=>{"use strict";s();oFe={userAadObjectId:"",tenantAadObjectId:"",userPuid:""}});var pH=Re((vir,mue)=>{s();mue.exports=OfficePlatformGlobal.Telemetry.OTel});function gue(e){switch(e){case Ln.RequiredDiagnosticData:return Ai.DiagnosticLevel.BasicEvent;case Ln.OptionalDiagnosticData:return Ai.DiagnosticLevel.FullEvent;case Ln.RequiredServiceData:return Ai.DiagnosticLevel.NecessaryServiceDataEvent;case Ln.AlwaysOnRequiredServiceData:return Ai.DiagnosticLevel.AlwaysOnNecessaryServiceDataEvent;case Ln.ReservedDoNotUse:throw new Error("Reserved Diagnostic Level not expected. Please change level immediately.");default:return dc(e,Ai.DiagnosticLevel.FullEvent)}}function hue(e){switch(e){case Sa.NotSet:return Ai.SamplingPolicy.NotSet;case Sa.Measure:return Ai.SamplingPolicy.Measure;case Sa.Diagnostics:return Ai.SamplingPolicy.Diagnostics;case Sa.CriticalBusinessImpact:return Ai.SamplingPolicy.CriticalBusinessImpact;case Sa.CriticalCensus:return Ai.SamplingPolicy.CriticalCensus;case Sa.CriticalExperimentation:return Ai.SamplingPolicy.CriticalExperimentation;case Sa.CriticalUsage:return Ai.SamplingPolicy.CriticalUsage;default:return dc(e,Ai.SamplingPolicy.NotSet)}}var Ai,yue=f(()=>{"use strict";s();Ta();oH();Ai=I(pH())});var vue=Re((Eir,Cue)=>{s();Cue.exports=OfficePlatformGlobal.Telemetry.OTelSDX});function xue(e){return e===aFe}function Tue(e){var t=e.appName,r=e.tenantAadObjectId,n=e.userPuid,o=e.userAadObjectId;return{"UserInfo.Id":xue(r)?n:o,"UserInfo.MsaId":n,"UserInfo.IdType":xue(r)?fA.AWTUserIdType.MSAPUID:fA.AWTUserIdType.UserObjectId,"UserInfo.OMSTenantId":r,"AppInfo.Name":t}}function wr(e,t){var r=e[t];return Array.isArray(r)||typeof r=="object"?JSON.stringify(r):r===!1||r===0?r:r||""}function bue(e){e.properties=ZM(e.properties,function(t){return t==null||t===""})}var aFe,mH=f(()=>{"use strict";s();sc();rue();aFe="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"});function Sue(e){var t={name:"Event"};return e&&(t.properties={eventId:e}),t}function Iue(e){var t=e.event,r=e.properties;return{name:"QoSEvent",properties:{rootCorrelationId:wr(r,"RequestId"),qosScenarioName:t.qosScenarioName||"",qosEventType:t.qosEventType||"",qosTagId:t.qosTagId||"",duration:t.duration!==void 0&&t.duration!==null?t.duration.toString():"",statusCode:wr(r,"StatusCode"),midgardError:t.midgardError||"",retryAttemptedAfterAuthFailure:wr(r,"RetryAttemptedAfterAuthFailure"),lokiVersion:wr(r,"x-serverversion"),serverInboundDuration:wr(r,"x-inboundduration"),serverCorrelationId:wr(r,"x-correlationid"),serverDatacenter:wr(r,"x-datacenter"),hostAppRing:wr(r,"hostAppRing"),isWebSocketRequest:wr(r,"iswebsocketrequest")}}}var Eue=f(()=>{"use strict";s();mH()});function Pue(e){var t={};return Uc(e.requiredEvents).forEach(function(r){var n=e.requiredEvents[r];t[r]=new Set(e.requiredEvents[r].properties||[])}),function(r,n){var o=n.awtEventData.name;if(!o)return[n];if(n.diagnosticLevel!==Ln.RequiredDiagnosticData||!n.awtEventData.properties)return[n];var a=Sx(n.awtEventData.properties,function(d,c){var u=t[o].has(c);return u});return[m(m({},n),{awtEventData:m(m({},n.awtEventData),{properties:a})})]}}var _ue=f(()=>{"use strict";s();k();sc();cT()});function Rue(e){return function(t,r){var n=r.awtEventData.name;return n?e.requiredEvents[n]?[m(m({},r),{diagnosticLevel:Ln.RequiredDiagnosticData})]:e.rsdEvents[n]?[m(m({},r),{diagnosticLevel:Ln.RequiredServiceData})]:[m(m({},r),{diagnosticLevel:Ln.OptionalDiagnosticData})]:[m(m({},r),{diagnosticLevel:Ln.OptionalDiagnosticData})]}}var Aue=f(()=>{"use strict";s();k();cT()});var mA={};_y(mA,{requiredEvents:()=>lFe,rsdEvents:()=>fFe});var pu,sFe,dFe,cFe,uFe,lFe,fFe,kue=f(()=>{"use strict";s();pu=["AppInfo.Name","clientCorrelationId","ClientTimeStamp","clientType","eventId","eventType","exportName","exportType","hostAppName","hostAppPlatform","region","ring","suggestionListCorrelationId","UserInfo.Id","UserInfo.IdType","UserInfo.MsaId","UserInfo.OMSTenantId","version"],sFe=["Feature","QoSTransactionId","RequestId","duration","qosEventType","qosScenarioName","rootCorrelationId"],dFe=["duration","componentName"],cFe=["didSearchDirectory","queryLength","responseLength"],uFe=["RequestId","didMakeAuthTokenRequest","didMakeConfigRequest","durationWaitingOnAuthToken","isWebSocketRequest","iswebsocketrequest","lokiVersion","rootCorrelationId:","serverCorrelationId:","serverDatacenter:","serverInboundDuration:","x-beserver","x-correlationid","x-datacenter","x-inboundduration","x-serverversion"],lFe={ConfigurationSetAction:{properties:pu},QueryChangedAction:{properties:pu},PickerDismissedAction:{properties:pu},SuggestionPressedAction:{properties:pu},InitializationSuccessful:{properties:pu},InitializationFailed:{properties:pu},AdditionalSuggestionsRequestedAction:{properties:pu}},fFe={QoSEvent:{properties:Object.assign(Object.assign(Object.assign(Object.assign({},pu),sFe),cFe),uFe)},EUPLEvent:{properties:Object.assign(Object.assign({},pu),dFe)}}});function mFe(e){Object.keys(e).forEach(function(t){pFe.test(t)||delete e[t]})}function gFe(e,t,r){var n=t.userAadObjectId,o=t.userPuid,a=t.tenantAadObjectId,d=t.lokiRegion,c=Object.assign({},e.properties),u="",l="";if(e.exportOptions&&(u=e.exportOptions.exportType,l=e.exportOptions.exportName),e.featureName!=="TTLCacheUtils"){var p={event:e,exportType:u,exportName:l,lokiRegion:d},g,h=vFe(e);switch(h){case"QoSEvent":g=Iue(Object.assign(Object.assign({},p),{properties:c}));break;case"PerceivedLatency":g=TFe(p.event,c);break;case"Generic":g=Sue(e.eventId);break;default:}r&&(g.name=r);var x=Object.assign(Object.assign({},xFe(p)),Tue({appName:"Live Persona Picker",tenantAadObjectId:a,userAadObjectId:n,userPuid:o})),y=JSON.parse(JSON.stringify(e.properties));return h==="QoSEvent"&&mFe(y),g.properties=rd(g.properties||{},y),g.properties=rd(g.properties||{},Object.assign({},x)),bue(g),g}}function CFe(e){return lc.ProductServiceUsage|lc.ProductServicePerformance}function vFe(e){return e.type==="EUPL"?"PerceivedLatency":e.type==="QoS"?"QoSEvent":"Generic"}function xFe(e){var t=e.event,r=e.exportType,n=e.exportName,o=e.lokiRegion,a=t.properties;return{clientCorrelationId:t.clientCorrelationid,suggestionListCorrelationId:a&&wr(a,"suggestionListCorrelationId").toString()||"",clientType:t.source,version:t.version,eventId:t.eventId,hostAppVersion:a&&wr(a,"hostAppVersion").toString()||"",hostAppRing:a&&wr(a,"hostAppRing").toString()||"",hostAppName:a&&wr(a,"hostAppName").toString()||"",hostAppPlatform:a&&wr(a,"hostAppPlatform").toString()||"",complianceEnvironment:a&&wr(a,"complianceEnvironment").toString()||"",hostAppCorrelationId:a&&wr(a,"SourceCorrelationId").toString()||"",queryLength:a&&wr(a,"queryLength").toString()||"",responseLength:a&&wr(a,"responseLength").toString()||"",didSearchDirectory:a&&wr(a,"didSearchDirectory").toString()||"",infoBarrierSegmentsCount:a&&wr(a,"infoBarrierSegmentsCount").toString()||"",exportType:r,exportName:n,eventType:t.type,region:o,ring:pue(o),clientTelemetryCollectorUrl:""}}function TFe(e,t){return{name:"PerceivedLatency",properties:{componentName:wr(t,"componentName"),duration:e.duration!==void 0?e.duration.toString():"",renderCount:wr(t,"renderCount"),finishedLoading:wr(t,"finishedLoading"),sourceCorrelationId:wr(t,"SourceCorrelationId")}}}var pFe,hFe,yFe,gH,Due=f(()=>{"use strict";s();Ta();Eue();cT();_ue();Aue();mH();fH();kue();pFe=/^[a-zA-Z0-9_\.]*$/;hFe=function(t,r){return[Object.assign(Object.assign({},r),{dataCategories:CFe(t)})]},yFe=function(t,r){return[Object.assign(Object.assign({},r),{samplingPolicy:Sa.Measure})]};gH=Gce(gFe,[Rue(mA),hFe,yFe,Pue(mA)])});function Fue(){var e=new Ea.TelemetryLogger;return e.addSink((0,wue.createOTelSink)()),e.setTenantTokens({Office:{LivePersonaPicker:{ariaTenantToken:lH.LivePersonaPicker.Prod.Generic,nexusTenantToken:bFe,UserActions:{ariaTenantToken:lH.LivePersonaPicker.Prod.GDPR,nexusTenantToken:SFe}}}}),e}var Ea,wue,yT,bFe,SFe,gA,CT,IFe,EFe,Oue=f(()=>{"use strict";s();hT();cue();lue();fH();yue();Ea=I(pH()),wue=I(vue());Due();yT=void 0,bFe=1791,SFe=1792,gA=function(){yT=yT||Fue()},CT=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r)return new aH(gH);var n=new uue(IFe,gH,EFe,Ea.makeDoubleDataField,Ea.makeStringDataField,Ea.makeBooleanDataField);if(t){var o=t.UserAadObjectId,a=t.TenantAadObjectId,d=t.UserPuid,c=t.LokiUrl,u=fue(o==null?void 0:o.Value,a==null?void 0:a.Value,d);n.userAadObjectId=u.userAadObjectId,n.userPuid=u.userPuid,n.tenantAadObjectId=u.tenantAadObjectId,c&&(n.lokiRegion=c)}return n};IFe=function e(t,r,n){yT||(yT=Fue(),console.error("".concat(gA.name," call required before ").concat(e.name," calls"))),yT.sendTelemetryEvent({eventName:t,dataFields:r,eventFlags:{diagnosticLevel:gue(n.diagnosticLevel),samplingPolicy:n.samplingPolicy?hue(n.samplingPolicy):Ea.SamplingPolicy.NotSet,dataCategories:Ea.DataCategories.ProductServiceUsage|Ea.DataCategories.ProductServicePerformance}})},EFe=function(t,r){var n;return r?"Office.LivePersonaPicker.UserActions.".concat(((n=t.properties)===null||n===void 0?void 0:n.exportName)||"UserActionsExported"):t.name?"Office.LivePersonaPicker.".concat(t.name.replace(/_/g,".")):"Office.LivePersonaPicker.Events"}});var hH=f(()=>{"use strict";s();Oue()});function Nue(e){return"".concat(Wo,"-").concat(e)}var Wo,hA=f(()=>{"use strict";s();Wo="LivePersonaPicker"});var Dp,yA=f(()=>{"use strict";s();Dp="1.20240227.9.0"});function Mue(){return!0}var Lue=f(()=>{"use strict";s()});function yH(e,t,r){return CA(this,void 0,void 0,function*(){return yield lse({providerConfig:t,id:Nue(e),version:Dp,getLokiDomain:r})})}function Hue(e,t,r,n,o,a){return{logger:t,getAuthToken:function(){return e.getAuthToken(r)},forceRefreshAuthToken:function(){return e.forceRefreshAuthToken(r)},updateAuthTokenTtl:function(c){return e.updateAuthTokenTtl(c)},settings:{isSharedMailboxEnabled:!1,useLocalLokiOnCloudService:!1,isOfflineMode:!1,isGetPostConversionDisabled:Mue()},clientFeature:Wo,hostAppConfiguration:{consumerCorrelationId:r,contextType:"",source:n,options:{hostAppRing:o,hostAppVersion:a}},BUILD_VERSION:Dp}}function CH(e,t,r){return CA(this,void 0,void 0,function*(){var n=yield yH(e,t,r),o=n.fetchedFromFallback,a=n.value;return{domain:a.LokiUrl||"",domainRequiredRequest:o}})}function Bue(e,t,r,n,o){var a=this,d=function(p){return Ip(Object.assign(Object.assign({},p),{monitorStarter:t,requestId:Vo()}))},c=function(p){return CA(a,void 0,void 0,function*(){try{return r(p)}catch(g){throw t.logError({eventId:"HostAppTokenCallbackFailure",featureName:Wo}),g}})},u=function(p){return CA(a,void 0,void 0,function*(){try{var g=yield c(e);p(g,void 0,void 0,void 0)}catch(h){p(void 0,h,void 0,void 0)}})};return new iL({getAppId:function(){return n},refreshAuthToken:u,logger:t,authTokenType:zx,runWithLogMonitor:d,storageKeySuffix:"LivePeoplePicker",dontStoreTokenInSessionStorage:o})}var CA,Uue=f(()=>{"use strict";s();aL();hT();uc();CL();yA();hA();Lue();CA=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}});var vA,vH,Vue,PFe,jue,Wue=f(()=>{"use strict";s();vA=I(ee()),Vue=function(t){return new Promise(function(r,n){var o;return(o=vA.NativeModules.LPPHostAppData)===null||o===void 0?void 0:o.refreshAuthToken(t,function(a,d,c,u){return d?r(d):n(c)})})},PFe=function(t,r){return new Promise(function(n){var o;return(o=vA.NativeModules.LPPHostAppData)===null||o===void 0?void 0:o.getHostAppSuggestions(t,r==null?void 0:r.searchDirectory,r==null?void 0:r.top,function(a){return n(a)})})},jue=!((vH=vA.NativeModules.LPPHostAppData)===null||vH===void 0)&&vH.getHostAppSuggestions?PFe:void 0});var Gue=Re((Rar,zue)=>{"use strict";s();zue.exports=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var Yue=Re(xH=>{"use strict";s();var _Fe=Object.prototype.hasOwnProperty,RFe;function que(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function Kue(e){try{return encodeURIComponent(e)}catch(t){return null}}function AFe(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var o=que(n[1]),a=que(n[2]);o===null||a===null||o in r||(r[o]=a)}return r}function kFe(e,t){t=t||"";var r=[],n,o;typeof t!="string"&&(t="?");for(o in e)if(_Fe.call(e,o)){if(n=e[o],!n&&(n===null||n===RFe||isNaN(n))&&(n=""),o=Kue(o),n=Kue(n),o===null||n===null)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""}xH.stringify=kFe;xH.parse=AFe});var rle=Re((war,tle)=>{"use strict";s();var Que=Gue(),xA=Yue(),DFe=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Xue=/[\n\r\t]/g,wFe=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Jue=/:\d+$/,FFe=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,OFe=/^[a-zA-Z]:/;function bH(e){return(e||"").toString().replace(DFe,"")}var TH=[["#","hash"],["?","query"],function(t,r){return fc(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],$ue={hash:1,query:1};function Zue(e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},o=typeof e,a;if(e.protocol==="blob:")n=new pc(unescape(e.pathname),{});else if(o==="string"){n=new pc(e,{});for(a in $ue)delete n[a]}else if(o==="object"){for(a in e)a in $ue||(n[a]=e[a]);n.slashes===void 0&&(n.slashes=wFe.test(e.href))}return n}function fc(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function ele(e,t){e=bH(e),e=e.replace(Xue,""),t=t||{};var r=FFe.exec(e),n=r[1]?r[1].toLowerCase():"",o=!!r[2],a=!!r[3],d=0,c;return o?a?(c=r[2]+r[3]+r[4],d=r[2].length+r[3].length):(c=r[2]+r[4],d=r[2].length):a?(c=r[3]+r[4],d=r[3].length):c=r[4],n==="file:"?d>=2&&(c=c.slice(2)):fc(n)?c=r[4]:n?o&&(c=c.slice(2)):d>=2&&fc(t.protocol)&&(c=r[4]),{protocol:n,slashes:o||fc(n),slashesCount:d,rest:c}}function NFe(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],a=!1,d=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),d++):d&&(n===0&&(a=!0),r.splice(n,1),d--);return a&&r.unshift(""),(o==="."||o==="..")&&r.push(""),r.join("/")}function pc(e,t,r){if(e=bH(e),e=e.replace(Xue,""),!(this instanceof pc))return new pc(e,t,r);var n,o,a,d,c,u,l=TH.slice(),p=typeof t,g=this,h=0;for(p!=="object"&&p!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=xA.parse),t=Zue(t),o=ele(e||"",t),n=!o.protocol&&!o.slashes,g.slashes=o.slashes||n&&t.slashes,g.protocol=o.protocol||t.protocol||"",e=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||OFe.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!fc(g.protocol)))&&(l[3]=[/(.*)/,"pathname"]);h<l.length;h++){if(d=l[h],typeof d=="function"){e=d(e,g);continue}a=d[0],u=d[1],a!==a?g[u]=e:typeof a=="string"?(c=a==="@"?e.lastIndexOf(a):e.indexOf(a),~c&&(typeof d[2]=="number"?(g[u]=e.slice(0,c),e=e.slice(c+d[2])):(g[u]=e.slice(c),e=e.slice(0,c)))):(c=a.exec(e))&&(g[u]=c[1],e=e.slice(0,c.index)),g[u]=g[u]||n&&d[3]&&t[u]||"",d[4]&&(g[u]=g[u].toLowerCase())}r&&(g.query=r(g.query)),n&&t.slashes&&g.pathname.charAt(0)!=="/"&&(g.pathname!==""||t.pathname!=="")&&(g.pathname=NFe(g.pathname,t.pathname)),g.pathname.charAt(0)!=="/"&&fc(g.protocol)&&(g.pathname="/"+g.pathname),Que(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(c=g.auth.indexOf(":"),~c?(g.username=g.auth.slice(0,c),g.username=encodeURIComponent(decodeURIComponent(g.username)),g.password=g.auth.slice(c+1),g.password=encodeURIComponent(decodeURIComponent(g.password))):g.username=encodeURIComponent(decodeURIComponent(g.auth)),g.auth=g.password?g.username+":"+g.password:g.username),g.origin=g.protocol!=="file:"&&fc(g.protocol)&&g.host?g.protocol+"//"+g.host:"null",g.href=g.toString()}function MFe(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||xA.parse)(t)),n[e]=t;break;case"port":n[e]=t,Que(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,Jue.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var a=t.indexOf(":");~a?(n.username=t.slice(0,a),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(a+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var d=0;d<TH.length;d++){var c=TH[d];c[4]&&(n[c[1]]=n[c[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&fc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function LFe(e){(!e||typeof e!="function")&&(e=xA.stringify);var t,r=this,n=r.host,o=r.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var a=o+(r.protocol&&r.slashes||fc(r.protocol)?"//":"");return r.username?(a+=r.username,r.password&&(a+=":"+r.password),a+="@"):r.password?(a+=":"+r.password,a+="@"):r.protocol!=="file:"&&fc(r.protocol)&&!n&&r.pathname!=="/"&&(a+="@"),(n[n.length-1]===":"||Jue.test(r.hostname)&&!r.port)&&(n+=":"),a+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(a+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(a+=r.hash),a}pc.prototype={set:MFe,toString:LFe};pc.extractProtocol=ele;pc.location=Zue;pc.trimLeft=bH;pc.qs=xA;tle.exports=pc});function SH(e){return(0,nle.default)(e)}var nle,ole=f(()=>{"use strict";s();nle=I(rle())});function ile(e){var t=SH(e),r=t==null?void 0:t.protocol;return r}function ale(e){var t=SH(e),r=t==null?void 0:t.hostname;return r}var sle=f(()=>{"use strict";s();ole()});function ule(e,t,r){var n,o=t.clientCorrelationId,a=t.clientType,d=t.hostAppName,c=t.hostAppPlatform,u=t.hostAppRing,l=t.hostAppSupportsLogging,p=t.hostAppVersion,g=t.complianceEnvironment,h=t.clientTelemetryCollectorUrl,x=o||Vo();l&&gA();var y=new gT(Promise.resolve(lle()),new lT(a||"",Dp,x,{hostAppVersion:p||"",hostAppRing:u||"",hostAppName:d||"",hostAppPlatform:c||"",complianceEnvironment:g||"",clientTelemetryCollectorUrl:(h==null?void 0:h.Aria)||""}),function(){return!0},function(){return(n==null?void 0:n.getLoggableProps())||{}}),T=(0,cle.composeWithDevTools)(Cx(l2(y,{logDataScenarioActions:!1}))),b=T(vp),S=m2(HFe),E=b(S),P=new $_({reduxStore:E}),_=function(){return setTimeout(r,0)};return n=new bA(P,E.dispatch,e,y,t.refreshAuthToken||Vue,t,_),P.addSingleton(n),P}function TA(e){return e.getSingleton(bA)}function lle(e){var t=new fT;return t.registerConsumer(CT(e,!1)),t}function BFe(e,t,r){return IH(this,void 0,void 0,function*(){if(t!==void 0){var n=yield UFe(t);return Promise.resolve(n)}else if(e!==void 0){var o=uH(e||"Unknown");return Promise.resolve(o)}return r.logEvent({eventId:"Neither GetLokiEndpoint callback nor Compliance environment passed from the hostapp",featureName:"LivePersonaPicker"}),Promise.reject("Neither compliance environment nor Loki URL from the hostapp is set")})}function UFe(e){return IH(this,void 0,void 0,function*(){var t="",r=yield e(),n=ile(r),o=ale(r);return n!==void 0&&o!==void 0?t="".concat(n,"//").concat(o):t="",t})}var dle,cle,IH,HFe,bA,EH=f(()=>{"use strict";s();dle=I(zce());hT();iue();fL();uc();cs();Ol();cle=I(sue());AL();jR();ER();hH();SL();_L();DL();hA();Uue();Wue();sle();yA();IH=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},HFe=[pse,qx,Ox,Jx,Zx,qR];bA=function(){function e(r,n,o,a,d,c,u){var l=this;this.appContext=r,this.dispatch=n,this.accountUpn=o,this.logger=a,this.refreshLokiToken=d,this.options=c,this.onInit=u,this.initializedInOnlineMode=!1,this.createEUPLLogFunction=function(){var S=l.suggestionListCorrelationId;return function(E,P,_,D){var O=Object.assign(Object.assign({},D),{suggestionListCorrelationId:S});l.logger.logEUPL(E,P,_,O)}},this.reInitializeWithOnlineMode=function(){l.initializeContextWithLoki(l.refreshLokiToken,l.options)},this.debugReInitializeWithOfflineMode=function(){l.initializedInOnlineMode=!1,l.initializeContextWithoutLoki()};var p=c.clientType,g=c.hostAppName,h=c.hostAppPlatform,x=c.settings,y=c.informationBarrierSegments,T=c.offline,b=c.enableVerboseLogging;if(!p)throw a.logEvent({eventId:"ClientTypeUndefined",featureName:Wo}),console.error("LivePersonaPicker client type not defined"),"Client type not defined";this.hostAppName=g,this.clientType=p,this.correlationId=Vo(),this.getHostAppSuggestions=c.getHostAppSuggestions||jue,this.hostAppPlatform=h,this.settingsOverride=x,this.informationBarrierSegments=y,this.offline=!!T,this.suggestionListCorrelationId=Vo(),this.getLokiRestProvider=function(){throw a.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:Wo}),new Error("LokiRestProvider not available in offline mode")},T?this.initializeContextWithoutLoki():this.initializeContextWithLoki(d,c),this.enableVerboseLogging=b}var t=e.prototype;return t.generateNewSuggestionListCorrelationId=function(){this.suggestionListCorrelationId=Vo()},t.getLoggableProps=function(){return{suggestionListCorrelationId:this.suggestionListCorrelationId||""}},t.getStoreState=function(){if(this.appContext.reduxStore)return this.appContext.reduxStore.getState();throw this.logger.logEvent({eventId:"Cannot get store state, Redux Store undefined",featureName:Wo}),new Error("Redux store is not defined.")},t.initializeContextWithLoki=function(n,o){var a=this,d=o.getPhotoUri,c=o.hostAppRing,u=o.hostAppVersion,l=o.complianceEnvironment,p=o.getLokiEndpoint;this.offline=!1;var g=function(){return BFe(l,p,a.logger)},h=Bue(this.accountUpn,this.logger,n,this.id,o.dontStoreTokenInSessionStorage),x=Hue(h,this.logger,Vo(),this.clientType,c,u);this.getPhotoUri=d||function(T,b){return a.getPhotoUriInternal(x,T,b,g)};var y;this.getLokiRestProvider=function(){return y||(y=new UR(x,function(){return CH(a.accountUpn,x,g)})),y},yH(this.accountUpn,x,g).then(function(T){return a.onInitialized("OnlineInitializationSuccessful",T.value)}).catch(function(){return a.onInitialized("OnlineInitializationFailed")})},t.initializeContextWithoutLoki=function(){var n=this;this.offline=!0,this.getLokiRestProvider=function(){throw n.logger.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:Wo}),new Error("LokiRestProvider not available in offline mode")},this.onInitialized("OfflineInitializationSuccessful")},t.getPhotoUriInternal=function(n,o,a,d){return IH(this,void 0,void 0,function*(){var c=(yield n.getAuthToken(this.correlationId)).token.getValue(),u="".concat(o).concat(a),l=function(h){return"".concat(h,"/").concat(u)},p=u.lastIndexOf("https:",0)===0?u:l((yield CH(this.accountUpn,n,d)).domain);return{uri:p,headers:{"X-ClientType":this.clientType,Authorization:"Bearer ".concat(c)}}})},t.onInitialized=function(n,o){this.initializedInOnlineMode||(this.logger.setEventHub(lle(o)),this.logger.logEvent({eventId:n,featureName:Wo}),this.dispatch($R({clientType:this.clientType,offline:this.offline,informationBarrierSegments:this.informationBarrierSegments,settings:this.settingsOverride})),this.offline||(this.initializedInOnlineMode=!0),this.onInit())},(0,dle.default)(e,[{key:"settings",get:function(){if(!this.appContext.reduxStore)throw this.logger.logEvent({eventId:"Cannot get settings,Redux Store undefined",featureName:Wo}),new Error("Can't get settings: Redux store is not defined.");return Zx.getSelectors(this.appContext.reduxStore.getState()).settings}},{key:"id",get:function(){return this.accountUpn?"".concat(Wo,"_").concat(this.accountUpn):this.correlationId?this.correlationId:(this.logger.logEvent({eventId:"LivePersonaPickerContext.id is null",featureName:Wo}),"_")}}]),e}()});function fle(e){return function(t){return function(r){(0,PH.default)(n,r);function n(){return r.apply(this,arguments)||this}var o=n.prototype;return o.render=function(){return wp.createElement(wM,{context:e(this.props)},wp.createElement(t,Object.assign({},this.props)))},n}(wp.Component)}}function ple(e){return function(t){return function(r){(0,PH.default)(n,r);function n(){return r.apply(this,arguments)||this}var o=n.prototype;return o.render=function(){return wp.createElement(t,Object.assign({},e(this.props)))},n}(wp.Component)}}var PH,wp,mle=f(()=>{"use strict";s();PH=I(Nh());cs();wp=I(L())});function VFe(){return!1}function jFe(){var e=new fT;return e.registerConsumer(CT(void 0,VFe())),e}var SA,gle=f(()=>{"use strict";s();hT();hH();yA();SA=new gT(Promise.resolve(jFe()),new lT("",Dp),function(){return!0},function(){return{}})});var _H,RH=f(()=>{"use strict";s();HL();EH();hA();gle();_H=function(){function e(){this._applicationContextMap={}}var t=e.prototype;return t.getApplicationContext=function(n){var o=this._applicationContextMap[n];if(!o)throw SA.logEvent({eventId:"Undefined AppContext",featureName:Wo}),"Undefined app context, should call start for ".concat(n);return o},t.start=function(n,o){if(n in this._applicationContextMap){SA.logEvent({eventId:"UPN already in applicationContextMap",featureName:Wo});return}var a=ule(n,o,function(){var d=TA(a);Yse(d)});this._applicationContextMap[n]=a},t.switchToOnlineMode=function(n){var o=this._applicationContextMap[n];if(!o)throw SA.logEvent({eventId:"Uninitialized AppContext for the UPN",featureName:Wo}),"App context not initialized for ".concat(n);o.getSingleton(bA).reInitializeWithOnlineMode()},e}()});var Fp,WFe,AH,hle=f(()=>{"use strict";s();Ol();jce();nH();EH();mle();RH();QL();Fp=new _H,WFe=function(t,r){return xp(ple(function(n){var o=t.getApplicationContext(r),a=TA(o);return Object.assign(Object.assign({},n),{lppAppContext:a})}),fle(function(n){return t.getApplicationContext(r)}))(Vce)},AH=function(t,r){return WFe(t,r)}});var kH=f(()=>{"use strict";s();hle();RH()});var vT,DH,wH=f(()=>{"use strict";s();k();Lt();vT=I(L());Er();bl();kH();DH=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.lppRef=null,n.lppContainer=void 0,n.setLPPRef=function(o){n.lppRef=o},n.state={calloutAnchor:void 0},n}return t.prototype.handleKeyDown=function(r){var n,o,a,d,c,u,l;switch(r){case ne.ArrowDown:return(n=this.lppRef)===null||n===void 0||n.onCustomKeyPressed(jo.DOWN),!0;case ne.ArrowUp:return(o=this.lppRef)===null||o===void 0||o.onCustomKeyPressed(jo.UP),!0;case ne.Enter:return(a=this.lppRef)===null||a===void 0||a.onCustomKeyPressed(jo.ENTER),!0;case ne.Escape:return(d=this.lppRef)===null||d===void 0||d.onCustomKeyPressed(jo.ESCAPE),(u=(c=this.props).onDismiss)===null||u===void 0||u.call(c),!0;case ne.Tab:return(l=this.lppRef)===null||l===void 0||l.onCustomKeyPressed(jo.TAB),!0}return!1},t.prototype.hidePicker=function(){this.setState({calloutAnchor:void 0})},t.prototype.showPicker=function(r,n){r&&(this.setState({calloutAnchor:r}),this.updatePicker(n??""))},t.prototype.updatePicker=function(r){var n;r!==void 0&&((n=this.lppRef)===null||n===void 0||n.onQueryChanged(r))},t.prototype.getLPPContainer=function(){if(this.state.calloutAnchor&&!this.lppContainer){this.props.lppManager.refreshLPPController();var r=this.props.lppManager.getLPPController();this.lppContainer=r&&AH(r,this.props.lppManager.getAccountID())}return this.lppContainer},t.prototype.render=function(){var r=this.getLPPContainer();return vT.createElement(J,null,r?vT.createElement(r,{calloutPositioningTarget:this.state.calloutAnchor,maxHeight:this.props.maxHeight,maxWidth:this.props.maxWidth,strings:this.props.strings,inputId:this.props.inputId,componentRef:this.setLPPRef,isOpen:!!this.state.calloutAnchor,onDismiss:this.props.onDismiss,onSuggestionSelected:this.props.onSuggestionSelected,selectedSuggestions:this.props.selectedSuggestions,suggestionListId:hW(),accessibilitySelectionRef:this.props.accessibilitySelectionRef}):null)},t}(vT.PureComponent)});var ty,IA,mu,zFe,GFe,qFe,KFe,FH,yle=f(()=>{"use strict";s();k();te();rt();Z();Cm();Lt();ty=I(dn()),IA=I(fM()),mu=I(L());hn();ue();ug();bM();Fv();mi();Ire();Vr();K_();DC();wH();bl();zFe=400,GFe=300,qFe=[{key:ne.ArrowDown,eventPhase:ty.EventPhase.Capturing},{key:ne.ArrowUp,eventPhase:ty.EventPhase.Capturing},{key:ne.Enter,eventPhase:ty.EventPhase.Capturing},{key:ne.Escape,eventPhase:ty.EventPhase.Capturing},{key:ne.Tab,eventPhase:ty.EventPhase.Capturing}],KFe=function(){function e(){var t=this;this.hasBeenFulfilled=!1,this.promise=new Promise(function(r){t.resolve=r})}return e.prototype.fulfill=function(t){!this.hasBeenFulfilled&&this.resolve&&(this.resolve(t),this.hasBeenFulfilled=!0)},e}(),FH=function(e){X(t,e);function t(r){var n,o=e.call(this,r)||this;return o.rteRef=null,o.lppRef=null,o.isFocused=!1,o.haveChangedText=!1,o.receivedFinalContentForUnmount=!1,o.supportsDeferredPromises=!0,o.lastKnownCursorPosition=void 0,o.tryFulfillDeferredContentsPromise=function(){o.deferredContentsPromise&&(o.deferredContentsPromise.fulfill(o.lastKnownContentsDelta),o.deferredContentsPromise=void 0)},o.setLPPRef=function(a){o.lppRef=a},o.setAccessibilitySelectionRef=function(a){o.setState({accessibilitySelectionRef:a})},o.onFocus=function(){var a=o.isFocused;o.isFocused=!0,a||o.props.onFocus()},o.onBlur=function(){var a=o.isFocused;o.isFocused=!1,a&&o.props.onBlur()},o.onKeyDown=function(a){var d;o.state.caretAnchorUID&&!((d=o.lppRef)===null||d===void 0)&&d.handleKeyDown(a.nativeEvent.key)&&a.stopPropagation()},o.previousMentions=[],o.onMentioneesChanged=function(a){if(!(!o.props.onMentionCreated||!o.props.onMentioneesStillInDraftUpdated||!a)){var d=a.nativeEvent.atMentions,c=o.props.onMentionCreated;d.forEach(function(u){if(o.previousMentions.find(function(p){return p.id===u.id})===void 0){v().assertConditionTag(!at()||u.directoryId!==void 0,"Mentionees should have directoryId when tasks is enabled",591155840);var l=o.getLPPSuggestion(u);c(l)}}),o.previousMentions=d,o.props.onMentioneesStillInDraftUpdated(new Set(d.map(function(u){return u.email})))}},o.emptyLPPStringOverride={},o.getMemoizedLPPStrings=En(Aj,function(){return[o.props.localizationAPI,o.emptyLPPStringOverride]}),o.getLPPSuggestion=function(a){return{Id:a.id,Name:a.fullName,EmailAddresses:[a.email],UserPrincipalName:"",SuggestionType:"Person",SuggestionOrigin:"UserTyped",SuggestionSubtype:"OrganizationUser",HostAppSuggestion:{},Source:"HostApp",AadObjectId:a.directoryId}},o.onEditorWillUnmount=function(a){o.lastKnownContentsDelta=t.sanitizeAndStringifyDelta(a==null?void 0:a.nativeEvent.formattedText,C.reserveTag(574980951)),o.receivedFinalContentForUnmount=!0,o.tryFulfillDeferredContentsPromise()},o.onPickerVisibilityChanged=function(a){var d,c;a&&((c=(d=o.props).onPickerVisibilityChanged)===null||c===void 0||c.call(d,a.nativeEvent.isVisible))},o.onPickerTelemetryEvent=function(a){var d,c;a&&((c=(d=o.props).onPickerTelemetryEvent)===null||c===void 0||c.call(d,a.nativeEvent))},o.onSelectionChange=function(a){a&&(o.lastKnownCursorPosition=a.nativeEvent.selection.start)},o.hidePicker=function(){var a;o.setState({accessibilitySelectionRef:void 0,caretAnchorUID:void 0}),(a=o.lppRef)===null||a===void 0||a.hidePicker()},o.onCustomPickerEvent=function(a){if(o.lppRef&&a)switch(a.nativeEvent.PickerEvent){case"StartPicker":o.setState({caretAnchorUID:a.nativeEvent.caretAnchorUID}),o.lppRef.showPicker(a.nativeEvent.caretAnchorUID,a.nativeEvent.searchString);return;case"StopPicker":o.hidePicker();return;case"UpdatePicker":o.lppRef.updatePicker(a.nativeEvent.searchString);return}},o.onDismissPicker=function(){var a;o.hidePicker(),(a=o.rteRef)===null||a===void 0||a.endCustomPickerExperience(null)},o.onSuggestionSelected=function(a){var d,c,u=o.getAtMentionSuggestion(a);(d=o.rteRef)===null||d===void 0||d.endCustomPickerExperience(u),o.setState({caretAnchorUID:void 0}),(c=o.lppRef)===null||c===void 0||c.hidePicker(),si(u.fullName)},o.renderWithContexts=function(a){var d,c=o.props.defaultValue?JSON.parse(o.props.defaultValue):void 0,u=o.props.displayMode===vn.ReadOnly;return Sre(mu.createElement(mu.Fragment,null,mu.createElement(IA.AtMentionTextInput,{ref:o.setRTERef,initialFormattedText:c,editable:!u,onFocus:o.onFocus,onBlur:o.onBlur,onContentSizeChange:o.props.onContentSizeChange,style:o.props.style,onPress:o.props.onPress,onChangeText:o.onChangeText,onIsEmpty:o.onIsEmpty,placeholderTextColor:o.props.placeholderTextColor,placeholder:o.props.placeholder,scrollEnabled:!u,onMentioneesChanged:o.onMentioneesChanged,isAtMentionsEnabled:G_(o.props),acceptsKeyboardFocus:o.props.acceptsKeyboardFocus,hyperlinksOpenBrowser:!0,hyperlinksRequireControlKey:!0,testID:o.props.testID,maximumNumberOfLines:o.props.maxLines,supportedFormatting:o.props.richTextCapabilities,accessibilityLabel:o.props.accessibilityLabel,accessible:o.props.accessible,onComponentWillUnmount:o.onEditorWillUnmount,onPickerVisibilityChanged:o.onPickerVisibilityChanged,documentUrl:(d=o.props.suggestionsDetails)===null||d===void 0?void 0:d.hostResourceUrl,onPickerTelemetryEvent:o.onPickerTelemetryEvent,onSelectionChange:o.onSelectionChange,onCustomPickerEvent:md()?o.onCustomPickerEvent:void 0,accessibilityControls:o.state.accessibilitySelectionRef,isPickerEmailAtMentionsEnabled:kb()}),md()&&mu.createElement(DH,{ref:o.setLPPRef,lppManager:a,calloutPositioningTarget:o.state.caretAnchorUID,maxHeight:zFe,maxWidth:GFe,strings:o.getMemoizedLPPStrings(),inputId:o.props.correlationId||"LPP_INPUT_ID",isOpen:!!o.state.caretAnchorUID,onDismiss:o.onDismissPicker,onSuggestionSelected:o.onSuggestionSelected,accessibilitySelectionRef:o.setAccessibilitySelectionRef})),md()&&mu.createElement(J,{keyDownEvents:o.state.caretAnchorUID?qFe:void 0,onKeyDown:o.onKeyDown}))},o.setRTERef=o.setRTERef.bind(o),o.onChangeText=o.onChangeText.bind(o),o.onIsEmpty=o.onIsEmpty.bind(o),o.onMentionCreated=o.onMentionCreated.bind(o),o.lastKnownContentsDelta=(n=r.defaultValue)!==null&&n!==void 0?n:Ad,o.state={caretAnchorUID:void 0,accessibilitySelectionRef:void 0},o}return t.prototype.clear=function(){this.rteRef&&this.rteRef.clear()},t.prototype.isEmpty=function(){return!0},t.prototype.getCaretRect=function(){return this.rteRef?this.rteRef.getCaretRect():Promise.reject()},t.prototype.getFormattedText=function(){return Gt(this,void 0,void 0,function(){var r,n,o,a;return gt(this,function(d){switch(d.label){case 0:if(!this.rteRef||this.receivedFinalContentForUnmount)return v().assertConditionTag(this.receivedFinalContentForUnmount,"RichTextEdit ref not set, but no contents persisted from unmount",574984778),[2,Promise.resolve(this.lastKnownContentsDelta)];d.label=1;case 1:return d.trys.push([1,3,,4]),o=(n=t).sanitizeAndStringifyDelta,[4,this.rteRef.getFormattedText()];case 2:return r=o.apply(n,[d.sent(),C.reserveTag(574984779)]),[3,4];case 3:return a=d.sent(),this.supportsDeferredPromises?(v().assertConditionTag(!1,"RichTextEditWrapper failed to get editor content beginning to unmount",527558788),this.deferredContentsPromise=new KFe,[2,this.deferredContentsPromise.promise]):[2,Promise.resolve(this.lastKnownContentsDelta)];case 4:return!this.haveChangedText&&IW(r)?[2,Promise.resolve(this.lastKnownContentsDelta)]:(this.lastKnownContentsDelta=r,[2,Promise.resolve(r)])}})})},t.prototype.componentDidUpdate=function(r){this.props.displayMode!==vn.Editing&&r.displayMode===vn.Editing&&(this.previousMentions=[])},t.prototype.componentWillUnmount=function(){this.tryFulfillDeferredContentsPromise(),this.supportsDeferredPromises=!1},t.prototype.setFormattedText=function(r){this.rteRef&&(this.lastKnownContentsDelta=r,this.rteRef.setFormattedText(JSON.parse(r)))},t.prototype.setCursorPosition=function(r){this.rteRef&&(this.lastKnownCursorPosition=r,this.rteRef.setTextSelection(r,r))},t.prototype.getCursorPositionAsync=function(){return this.lastKnownCursorPosition!==void 0?Promise.resolve(this.lastKnownCursorPosition):this.rteRef?this.rteRef.getSelectionStart():Promise.resolve(void 0)},t.prototype.setRTERef=function(r){this.rteRef=r},t.prototype.focus=function(){this.rteRef&&Xg(this.rteRef)},t.prototype.blur=function(){this.rteRef&&this.rteRef.blur()},t.prototype.onChangeText=function(r){this.props.onChangeText(r.nativeEvent.text),this.haveChangedText=!0,this.receivedFinalContentForUnmount=!1,this.deferredContentsPromise=void 0},t.prototype.onIsEmpty=function(r){r&&this.props.onIsEmpty(r.nativeEvent.isEmpty)},t.prototype.onMentionCreated=function(r){this.props.onMentionCreated&&this.props.onMentionCreated({Email:r.email,DisplayName:r.fullName,Id:r.id,AadObjectId:r.directoryId})},t.prototype.getAtMentionSuggestion=function(r){var n;return{email:Ss(r),fullName:r.Name,directoryId:(n=r.AadObjectId)!==null&&n!==void 0?n:"",resolveState:IA.AtMentionResolvedState.Resolved}},t.prototype.render=function(){return Ye(this.renderWithContexts,Fh)},t.sanitizeAndStringifyDelta=function(r,n){if((r==null?void 0:r.ops)===void 0)return v().assertConditionTag(!1,"Delta ops not set",n),Ad;var o={ops:r.ops.filter(function(a){return a.insert!==void 0})};return JSON.stringify(o)},t}(mu.PureComponent)});var Cle=f(()=>{"use strict";s();yle()});var OH,YFe,EA,NH=f(()=>{"use strict";s();OH=I(L()),YFe="ScrollListenerContext undefined. Did you forget to render a ScrollListenerContext context provider?",EA=OH.createContext(new Proxy({},{get:function(){throw new Error(YFe)}}))});var Op,MH=f(()=>{"use strict";s();Op={get:function(t){return{width:100,height:100,scale:1,fontScale:1}}}});function ry(e,t){t.addDataField("PickerSession",e.pickerSessionId,N.SystemMetadata)}function vle(e,t){var r=v().createActivityObject("PickerInvoked",e,be());ry(t,r),r.successTag(590443476)}function $Fe(e,t){var r=v().createActivityObject("PickerDisplayed",e,be());ry(t,r),r.successTag(590443477)}function QFe(e,t,r,n,o){var a=v().createActivityObject("ResultsDisplayed",e,be());ry(t,a),a.addDataField("SearchDurationMS",r,N.SystemMetadata),a.addDataField("QueryLength",o,N.SystemMetadata),a.addDataField("NumberOfResults",n,N.SystemMetadata),a.successTag(590443478)}function XFe(e,t,r){var n=v().createActivityObject("SearchStart",e,be());ry(t,n),n.addDataField("QueryLength",r,N.SystemMetadata),n.successTag(590443479)}function JFe(e,t,r,n,o,a){var d=n===0,c=v().createActivityObject("SearchEnd",e,be());ry(t,c),c.addDataField("SearchDurationMS",r,N.SystemMetadata),c.addDataField("Succeeded",d,N.SystemMetadata),c.addDataField("StatusCode",n,N.SystemMetadata),c.addDataField("NumberOfResults",o,N.SystemMetadata),c.addDataField("QueryLength",a,N.SystemMetadata),d?c.successTag(590443480):c.failTag(590443481,-2147467259)}function ZFe(e,t,r,n,o){var a=v().createActivityObject("SessionEnded",e,be());ry(t,a),a.addDataField("WasSelectionMade",r,N.SystemMetadata),a.addDataField("SelectedIndex",n,N.SystemMetadata),a.addDataField("QueryLength",o,N.SystemMetadata),a.successTag(590443482)}function e1e(e,t,r,n){switch(n.type){case"SearchStart":if(n.isNewSession||!r){var o=xle(t);return vle(e,o),$Fe(e,o),o}break;case"SearchComplete":if(!r){var o=xle(t);return vle(e,o),o}break}return r}function xle(e){return{draftTelemetryId:e||tb,pickerSessionId:ao()}}var Tle,ble=f(()=>{"use strict";s();rt();Z();Tle=function(){function e(){}return e.prototype.onPickerTelemetryEvent=function(t,r,n){if(!this.pickerSession&&(n.type==="SearchStart"||n.type==="SearchComplete")&&(this.pickerSession=e1e(t,r,this.pickerSession,n)),!this.pickerSession){v().assertConditionTag(!1,"Never started picker session",589615891);return}switch(n.type){case"SearchStart":XFe(t,this.pickerSession,n.searchStringLength);break;case"SearchComplete":JFe(t,this.pickerSession,n.sinceSearchStartMs,n.resultCode,n.totalResults,n.searchStringLength);break;case"ResultsDisplayed":QFe(t,this.pickerSession,n.sinceSearchStartMs,n.numResults,n.searchStringLength);break;case"SessionEnded":ZFe(t,this.pickerSession,n.wasSelectionMade,n.selectedIndex,n.searchStringLength),this.pickerSession=void 0;break}},e}()});function PA(e){return{dataFieldVisitor:e}}var Sle,t1e,ny,_A=f(()=>{"use strict";s();Z();Sle=I(L()),t1e={dataFieldVisitor:Ct(ft.GlobalAPI)};ny=Sle.createContext(t1e)});var Ile,Ele,Ple,_le=f(()=>{"use strict";s();Ile=I(dn());fn();_r();Ele=Ile.StyleSheet.createViewStyle({margin:0}),Ple=new R([R.rule(function(e){var t=e.renderContextType,r=e.platform;return Vd(t)&&r!=="win32"},{flex:1})])});var gu,n1e,o1e,i1e,a1e,RA,Rle,Ale,LH=f(()=>{"use strict";s();k();te();rt();Z();Lt();gu=I(L());Cn();vl();ug();Be();bM();pr();Cle();lx();Vr();Lo();NH();DC();MH();Ir();gi();So();fn();ze();ble();_A();wh();_le();n1e={key:ne.Enter,ctrlKey:!0,eventPhase:we.Capturing},o1e={key:ne.Escape,eventPhase:we.Capturing},i1e=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.viewRef=gu.createRef(),o.rteRef=null,o.isRestoringDraftToRte=!1,o.registrationRef=gu.createRef(),o.mentionsTelemetry=new Tle,o.onKeyDown=function(a){var d,c;if(a.nativeEvent.key===ne.ArrowLeft||a.nativeEvent.key===ne.ArrowRight||a.nativeEvent.key===ne.ArrowDown||a.nativeEvent.key===ne.ArrowUp){a.stopPropagation();return}if(o.props.displayMode===vn.Editing){if(a.nativeEvent.key===ne.Tab&&!a.nativeEvent.shiftKey){a.stopPropagation();return}if(a.nativeEvent.key===ne.Enter&&a.nativeEvent.ctrlKey){o.props.onCommitRequested&&o.props.onCommitRequested(eo.KeyboardShortcut);return}if(a.nativeEvent.key===ne.Escape&&!o.state.isPickerVisible){o.props.onEscapeRequested&&o.props.onEscapeRequested();return}(c=(d=o.props).focusManagerKeyDownHandler)===null||c===void 0||c.call(d,a)}},o.onPickerVisibilityChanged=function(a){o.setState({isPickerVisible:a})},o.createOnPickerTelemetryEventHandler=et(function(a,d){return function(c){var u;o.mentionsTelemetry.onPickerTelemetryEvent((u=a==null?void 0:a.dataFieldVisitor)!==null&&u!==void 0?u:Ct(ft.GlobalAPI),d,c)}}),o.renderWithContext=function(a){var d=o.props,c=d.paddingTop,u=c===void 0?0:c,l=d.paddingBottom,p=l===void 0?0:l,g=d.maxHeight,h=d.minHeight,x={paddingTop:u,paddingBottom:p,paddingLeft:0,paddingRight:0},y=[Ele,{maxHeight:o.scaleFontAccordingToSystemFontSettings(g),minHeight:o.scaleFontAccordingToSystemFontSettings(h)||o.getDefaultEditorMinHeight()},x];Y()==="win32"&&y.push(vr);var T=void 0;G_(o.props)&&(T={onMentionCreated:o.props.onMentionCreated,correlationId:o.props.correlationId,peoplePickerPosition:o.props.peoplePickerPosition,onMentioneesStillInDraftUpdated:o.props.onMentioneesStillInDraftUpdated});var b=[n1e];return o.state.isPickerVisible||b.push(o1e),o.props.displayMode===vn.Editing?b.push({key:ne.Tab,shiftKey:!0,eventPhase:we.Capturing}):b.push.apply(b,w([],j(Cs(jy,we.Capturing)||[]),!1)),gu.createElement(vc,{node:o,position:0,ref:o.registrationRef},gu.createElement(J,{ref:o.viewRef,testID:Y()!=="win32"?o.props.id:void 0,style:[o.renderStyle(Ple),o.props.containerStyle],keyDownEvents:b,onKeyDown:o.onKeyDown,onStartShouldSetResponder:wl},gu.createElement(FH,m({},T||{},{localizationAPI:o.props.localizationAPI,ref:o.setRTERef,placeholder:o.props.placeholder,defaultValue:o.props.defaultValue,displayMode:o.props.displayMode,onFocus:o.onFocus,onBlur:o.onBlur,onContentSizeChange:o.onContentSizeChange,style:y,onPress:o.props.onPress,onChangeText:o.onChangeText,onIsEmpty:o.onIsEmpty,placeholderTextColor:o.props.placeholderTextColor,acceptsKeyboardFocus:o.props.focusable,testID:Y()==="win32"?o.props.id:void 0,maxLines:o.props.maxLines,richTextCapabilities:o.props.richTextCapabilities,accessibilityLabel:o.props.accessibilityLabel,accessible:o.props.accessible===void 0?!0:o.props.accessible,onPickerVisibilityChanged:o.onPickerVisibilityChanged,suggestionsDetails:o.props.suggestionsDetails,scrollEnabled:o.shouldEnableRichTextScroll(),onPickerTelemetryEvent:o.createOnPickerTelemetryEventHandler(a,o.props.telemetryId)}))))},o.onContentSizeChange=o.onContentSizeChange.bind(o),o.onChangeText=o.onChangeText.bind(o),o.onIsEmpty=o.onIsEmpty.bind(o),o.setRTERef=o.setRTERef.bind(o),o.onBlur=o.onBlur.bind(o),o.onFocus=o.onFocus.bind(o),o.state={isFocusOn:!1,isFocusWithin:!1,isPickerVisible:!1},o}return t.prototype.componentWillUnmount=function(){var r,n;(n=(r=this.props).onUnmount)===null||n===void 0||n.call(r,this)},t.prototype.componentDidMount=function(){var r,n;(n=(r=this.props).onMount)===null||n===void 0||n.call(r),this.restoreDraftIfExists()},t.prototype.restoreDraftIfExists=function(){var r=this,n=this.props.savedDraftContent;n&&(this.isRestoringDraftToRte=!0,n.editorContent.then(function(o){var a;r.isRestoringDraftToRte=!1,o&&(r.setContents(o),(a=n.editorCursorPosition)===null||a===void 0||a.then(function(d){return r.setCursorPosition(d??-1)}).catch(function(d){r.setCursorPosition(-1)}))}).catch(function(o){r.isRestoringDraftToRte=!1,pe(C.reserveTag(588805470))(o)}))},t.prototype.clear=function(){this.rteRef&&this.rteRef.clear()},t.prototype.isEditorEmpty=function(){return v().assertConditionTag(this.props.isDraftEmpty!==void 0,"Called isEditorEmpty on an editor without a draft",588805472),this.props.isDraftEmpty!==!1},t.prototype.getContentsAsync=function(){var r,n,o,a,d,c;return Gt(this,void 0,void 0,function(){return gt(this,function(u){return this.isRestoringDraftToRte&&((n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call(r,Mt(Rle||(Rle=qt(["GetEditorContentsMidRestore"],["GetEditorContentsMidRestore"]))),C.reserveTag(540021260),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary),Gr("RichTextEditorExists",!!this.rteRef,N.SystemMetadata)),this.props.savedDraftContent)?[2,this.props.savedDraftContent.editorContent]:this.rteRef?[2,this.rteRef.getFormattedText()]:((a=(o=v()).logDiagnosticTrace)===null||a===void 0||a.call(o,Mt(Ale||(Ale=qt(["GetEditorContentsFallback"],["GetEditorContentsFallback"]))),C.reserveTag(540018914),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary)),[2,(c=(d=this.props.savedDraftContent)===null||d===void 0?void 0:d.editorContent)!==null&&c!==void 0?c:Ad])})})},t.prototype.getCursorPositionAsync=function(){return this.rteRef?this.rteRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.setCursorPosition=function(r){var n=this;this.rteRef&&r!==void 0&&setTimeout(function(){var o;(o=n.rteRef)===null||o===void 0||o.setCursorPosition(r)})},t.prototype.setContents=function(r){this.rteRef&&this.rteRef.setFormattedText(r)},t.prototype.getDisplayMode=function(){return this.props.displayMode},t.prototype.componentDidUpdate=function(r,n){this.props.displayMode===vn.ReadOnly&&r.displayMode!==vn.ReadOnly&&this.blur(),(Y()==="win32"?!r.savedDraftContent&&(!this.rteRef||this.rteRef.isEmpty()):this.props.savedDraftContent!==r.savedDraftContent)&&this.restoreDraftIfExists(),uo(this.state)!==uo(n)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},t.prototype.setSelection=function(r){},t.prototype.getScrollListener=function(){return $t(this.props.componentTreeId.renderContextType)?this.props.scrollListener:null},t.prototype.onContentSizeChange=function(r){if(r){var n=Math.max(W0,r.nativeEvent.contentSize.height);this.props.onContentSizeChange&&this.props.onContentSizeChange(n)}},t.prototype.setRTERef=function(r){this.rteRef=r},t.prototype.onChangeText=function(r){if(this.props.displayMode===vn.Editing){var n=this.getScrollListener();n&&n.clearStickyScrollState&&n.clearStickyScrollState()}},t.prototype.onIsEmpty=function(r){var n,o;this.props.isDraftEmpty===r||this.props.displayMode!==vn.Editing||(o=(n=this.props).onDraftEmptinessChanged)===null||o===void 0||o.call(n,r)},t.prototype.onFocus=function(){if(this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus(),Y()==="win32"){var r=this.getScrollListener();r&&r.clearStickyScrollState&&r.clearStickyScrollState()}},t.prototype.onBlur=function(){if(this.setState({isFocusOn:!1}),this.props.isDraftEmpty===void 0){v().assertConditionTag(this.props.displayMode!==vn.Editing,"isEditorEmpty undefined when in Editing mode in onBlur",588805475);return}this.props.onEditorBlur&&this.props.onEditorBlur()},t.prototype.focus=function(){this.rteRef&&this.rteRef.focus()},t.prototype.blur=function(){this.rteRef&&this.rteRef.blur()},t.prototype.getFocusState=function(){return uo(this.state)},t.prototype.getId=function(){return this.props.nodeId||""},t.prototype.getData=function(){return this},t.prototype.getChildNodes=function(){return[]},t.prototype.addChildNode=function(r){throw new Error("Method not implemented.")},t.prototype.getDescendantById=function(r){},t.prototype.isTabbable=function(){return!!this.props.isTabbable},t.prototype.getNextTabTarget=function(){return this.getFocusState()===ge.Unfocused&&this.isTabbable()?this:void 0},t.prototype.getIterator=function(){return gt(this,function(r){switch(r.label){case 0:return[4,this];case 1:return r.sent(),[2]}})},t.prototype.renderStyle=function(r){return r.render(Kr(this.props.componentTreeId.renderContextType))},t.prototype.getDefaultEditorMinHeight=function(){if(Y()==="android")return 1},t.prototype.scaleFontAccordingToSystemFontSettings=function(r){if(r!==void 0)return Math.round(r*Op.get("window").fontScale)},t.prototype.shouldEnableRichTextScroll=function(){return this.props.componentTreeId.renderContextType===A.HalfPane&&this.props.maxHeight===void 0?!1:this.props.displayMode!==vn.ReadOnly},t.prototype.render=function(){return Ye(this.renderWithContext,ny)},t}(gu.PureComponent),a1e=nc(i1e,{componentTreeId:nn,scrollListener:EA},"CommentEditor"),RA=a1e});function Np(e){return!!e&&e.setContents!==void 0&&e.getContentsAsync!==void 0&&e.isEditorEmpty!==void 0&&e.clear!==void 0&&e.blur!==void 0&&e.focus!==void 0&&e.setSelection!==void 0&&e.getDisplayMode!==void 0}var AA=f(()=>{"use strict";s()});var Mp,wle,kle,Dle,Fle=f(()=>{"use strict";s();k();te();rt();Z();Lt();Mp=I(L());tr();ue();vl();ug();Be();B0();LH();Er();ze();AA();wle=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.editorRef=Mp.createRef(),o.onDraftEmptinessChanged=function(a){o.props.isDraftEmpty!==a&&o.props.onDraftEmptinessChanged(a)},o.onEditorCommitRequested=function(){var a,d;o.props.isDraftEmpty===!1&&((d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(kle||(kle=qt(["EditorCommitRequested"],["EditorCommitRequested"]))),C.reserveTag(556827600),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary)),o.props.onPost(eo.KeyboardShortcut))},o.onCommitButtonClick=function(){var a,d;(d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(Dle||(Dle=qt(["SendButtonClicked"],["SendButtonClicked"]))),C.reserveTag(556827601),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary)),o.props.onPost(eo.CommitButton)},o.onEditorUnmount=function(a){o.props.onUnmount(a)},o.onInputSizeChange=o.onInputSizeChange.bind(o),o.onLayout=o.onLayout.bind(o),o.onFocusStateChange=o.onFocusStateChange.bind(o),o.state={focusState:ge.Unfocused,draftBoxHeight:0,viewRef:Mp.createRef()},o}return t.prototype.componentDidUpdate=function(r){this.props.editMode===ti.None&&r.editMode!==ti.None&&this.onInputSizeChange(this.getMinimumInputHeight())},t.prototype.renderStyle=function(r,n){return ot(r,n,this.props.componentTreeId.renderContextType)},t.prototype.onInputSizeChange=function(r){var n=Math.max(r,this.getMinimumInputHeight());this.props.maxDraftHeight&&(n=Math.min(n,this.props.maxDraftHeight)),this.props.componentTreeId.renderContextType===A.HalfPane?this.props.onInputSizeChange(this.getHeight(n)):this.props.onInputSizeChange(void 0)},t.prototype.getPickerPosition=function(){if(!(!this.state.viewRef.current||!this.props.peoplePickerWidth)){var r=this.props.availableScreenHeight||0;return this.props.componentTreeId.renderContextType===A.HalfPane&&(r=Math.max(r-this.state.draftBoxHeight,0)),{target:this.state.viewRef.current,left:0,top:0,width:this.props.peoplePickerWidth,height:r}}},t.prototype.clear=function(){if(this.editorRef&&this.editorRef.current){var r=this.editorRef.current.getData();Np(r)&&r.clear(),this.onDraftEmptinessChanged(!0)}},t.prototype.focus=function(){this.editorRef&&this.editorRef.current&&this.editorRef.current.focus()},t.prototype.blur=function(){this.editorRef&&this.editorRef.current&&this.editorRef.current.blur()},t.prototype.getContentsAsync=function(){if(this.editorRef&&this.editorRef.current){var r=this.editorRef.current.getData();if(Np(r))return r.getContentsAsync()}return Promise.reject(new he("Editor ref unset",C.reserveTag(589103714),-2130957550))},t.prototype.renderCommentEditor=function(r,n){var o=this.props.editMode===ti.Editing?vn.Editing:vn.ReadOnly,a=r.palette.CardPlaceholderColor;return Mp.createElement(RA,m({nodeId:_C(this.props.id),id:this.props.id,onPress:this.props.onPress,onFocus:this.props.onFocus,placeholder:this.props.placeholder,ref:this.editorRef,displayMode:o,onContentSizeChange:this.onInputSizeChange,onMount:this.props.onEditorMount,onUnmount:this.onEditorUnmount,onDraftEmptinessChanged:this.onDraftEmptinessChanged,accessibilityLabel:this.props.placeholder,savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.props.shouldRestoreDraftOnMount},this.props.mentionEditorProps,{peoplePickerPosition:this.getPickerPosition(),placeholderTextColor:a,focusable:this.props.isEditorFocusable,isTabbable:this.props.isEditorFocusable&&this.props.editMode===ti.Editing&&(!nt()||this.props.isTabbable),onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.props.onEscapePressed,key:"editor",preventDefaultKeyDownBehavior:void 0,focusManagerKeyDownHandler:this.props.focusManagerKeyDownHandler,telemetryId:this.props.telemetryId,localizationAPI:this.props.localizationAPI},this.getExtraCommentEditorProps(r,n)))},t.prototype.onLayout=function(r){this.setState({draftBoxHeight:r.nativeEvent.layout.height})},t.prototype.onFocusStateChange=function(r){this.setState({focusState:r})},t.prototype.isEditingOrPending=function(){return this.props.editMode===ti.Editing||this.props.editMode===ti.Pending},t}(Mp.Component)});var Ole,Nle,Mle,Lle,Hle,Ble,kA,HH=f(()=>{"use strict";s();_r();ze();Ole=new kt([kt.always({flexDirection:"column",alignItems:"stretch",borderWidth:0,paddingTop:4,paddingLeft:8,paddingRight:9,paddingBottom:9})]),Nle=Ce({paddingBottom:4}),Mle=new R([R.always({paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderColor:"transparent",borderWidth:1,marginLeft:1})]),Lle=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderRadius:2,borderStyle:"dashed"}})]),Hle=new R([R.always(function(e){return{backgroundColor:e.palette.CardDraftBoxBackgroundHovered}})]),Ble=new R([R.always(function(e){return{borderColor:e.palette.CardDraftBoxBorderHovered}})]),kA=new R([R.always(function(e){return{borderColor:e.warningDraftboxColor}})])});var oy,Ule,BH,Vle,d1e,jle,UH=f(()=>{"use strict";s();k();Me();Lt();oy=I(L()),Ule=I(Wte());ue();B0();Av();W_();Er();Vr();Lo();ri();So();ze();xr();wh();TM();s_();as();pr();Fle();HH();BH=55,Vle=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.hoverManager=new Dh,o.onHoverChange=function(a){o.setState({isDraftBoxHovered:a})},o.renderWithTheme=function(a,d){var c=Gg(o.renderStyle(Ole,a),0,o.props.extraPaddingRight,0,o.props.extraPaddingLeft),u=c;o.props.taskAssigner&&(u=[c,Nle]);var l=o.renderCommentEditor(a,d),p=o.isEditingOrPending()&&o.renderButtons(),g=[],h=o.getStyles(a);return g.push(oy.createElement(Wr,m({accessible:!o.isEditingOrPending(),accessibilityLabel:o.props.placeholder,isTabbable:o.props.isTabbable&&!o.isEditingOrPending(),onPress:o.props.onPress,key:"editor",style:h,pointerEvents:o.isEditingOrPending()?"box-none":"auto",ref:o.state.viewRef,nodeId:"card-draft-box",preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,testID:o.props.id,onFocusStateChange:o.onFocusStateChange},o.hoverManager.viewProps),l)),g.push(o.renderDraftBoxMessage()),g.push(p),oy.createElement(J,{style:u,animationClass:o.props.animationClass},oy.createElement(Ule.UIAnchor,{uid:o.isEditingOrPending()?gW():""},g))},o.render=function(){return Ye(o.renderWithTheme,Ze,Zt)},o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return t.prototype.componentWillUnmount=function(){var r;this.hoverChangeEventSubscription&&((r=this.hoverChangeEventSubscription)===null||r===void 0||r.unsubscribe())},t.prototype.getHeight=function(r){return 0},t.prototype.getMinimumInputHeight=function(){return 0},t.prototype.getExtraCommentEditorProps=function(r,n){var o,a=480,d=64;return{onEditorBlur:this.props.onBlur,maxHeight:Math.max((o=this.props.maxDraftHeight)!==null&&o!==void 0?o:a,d),accessibilityLabel:this.props.placeholder,accessible:this.isEditingOrPending(),containerStyle:this.getContainerStyle(r,n)}},t.prototype.getContainerStyle=function(r,n){var o=[this.renderStyle(Y0,r)];if(!qo()&&this.props.isCardHovered&&o.push(this.renderStyle(Hle,r)),this.state.isDraftBoxHovered&&o.push(this.renderStyle(Ble,r)),this.isEditingOrPending()&&this.state.focusState!==ge.Unfocused&&o.push(this.renderStyle($0,r)),this.props.draftWarningState){var a=mr(n);o.push(Tl(kA,a,this.props.componentTreeId.renderContextType))}return o},t.prototype.getStyles=function(r){var n=[this.renderStyle(Mle,r)];return this.state.focusState===ge.FocusOn&&n.push(this.renderStyle(Lle,r)),n},t.prototype.renderButtons=function(){var r={onClick:this.onCommitButtonClick,accessibilityLabel:this.props.sendLabel,isTabbable:this.props.isTabbable,icon:2,text:this.props.sendLabel,disabled:this.props.isDraftEmpty!==!1,showDelayedSpinner:this.props.editMode===ti.Pending,id:this.props.sendTestID,usePrimaryButtonStyling:!0},n=this.props.showCancel?{onClick:this.props.onCancel,accessibilityLabel:this.props.cancelLabel,isTabbable:this.props.isTabbable,icon:1,text:this.props.cancelLabel||"",disabled:this.props.editMode===ti.Pending,id:this.props.cancelTestID,usePrimaryButtonStyling:!1}:void 0,o=[r];return n&&o.push(n),oy.createElement(hx,{key:"commitbar",buttons:o,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,taskAssigner:this.props.taskAssigner})},t.prototype.renderDraftBoxMessage=function(){var r=this.props.draftWarningState,n=Ab()&&this.isEditingOrPending();if(!(!r&&!n))return oy.createElement(fp,{key:"draftBoxMessage",draftWarningState:r,localizationAPI:this.props.localizationAPI,target:Ud.Card,id:r?Gm({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}):qm({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:n})},t.prototype.getEditorWrapperRefHandle=function(){},t}(wle),d1e=nc(Vle,{componentTreeId:nn},"CardDraftBox"),jle=d1e});function jH(){return c1e}var Lp,VH,c1e,WH=f(()=>{"use strict";s();Lp=1,VH=void 0,c1e={PostHeight:50,ExpandButtonHeight:22,ReplyDraftHeight:44,TaskTopper:0}});function Bl(e){var t=e.itemCount,r=e.readOnly,n=e.isTask,o=jH(),a=o.PostHeight;return t>1&&(a+=o.PostHeight+Lp),t>2&&(a+=o.ExpandButtonHeight+Lp),r||(a+=o.ReplyDraftHeight+Lp),n&&(a+=o.TaskTopper),a}var Wle=f(()=>{"use strict";s();WH()});var xT=f(()=>{"use strict";s();WH();Wle()});var zle,Gle,qle,Kle,Yle,$le,Qle=f(()=>{"use strict";s();k();zle=I(dn());Kc();xT();_r();ze();Gle=new R([R.rule({isFluentEnabled:!1},function(e){return{flex:1,borderColor:e.palette.ButtonBorder,borderLeftWidth:1,alignItems:"stretch"}})]),qle=Ce({borderLeftWidth:0}),Kle=new R([R.rule({isFluentEnabled:!1},{justifyContent:"center",height:48})]),Yle=zle.StyleSheet.createViewStyle({textAlign:"center"}),$le=new R(w([R.always({flex:0,flexDirection:"row"}),R.rule({isFluentEnabled:!1},function(e){return{borderColor:e.palette.CommandBarBorder,borderTopWidth:Lp}}),R.rule({isFluentEnabled:!0},{justifyContent:"flex-end",paddingBottom:10,paddingRight:10})],j(EK),!1))});var Hp,Xle,l1e,zH,Jle=f(()=>{"use strict";s();k();Z();Hp=I(L()),Xle=I(ee());ue();Vr();Lo();ze();xr();wh();as();pr();xn();Qle();l1e=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.renderWithTheme=function(a){var d=o.props.actions.map(function(c,u){return Hp.createElement(J,{style:[o.renderStyle(Gle,a),u?void 0:qle],key:u},Hp.createElement(Wr,{style:o.renderStyle(Kle,a),accessibilityLabel:c.accessibilityLabel,onPress:c.onClick,disabled:c.disabled,accessibilityRole:"button",isTabbable:!0,testID:c.id,nodeId:c.id||"",preventDefaultKeyDownBehavior:void 0},Hp.createElement(Ve,{style:Yle,textStylePolyester:"MediumSecondary"},c.text)))});return Hp.createElement(Xle.SafeAreaView,{style:o.renderStyle($le,a)},d)},o.render=function(){return Ye(o.renderWithTheme,Ze)},v().assertConditionTag(!le(),"CommandBar is not supported in the Fluent UI",544875781),o}return t.prototype.renderStyle=function(r,n){return ot(r,n,this.props.componentTreeId.renderContextType)},t}(Hp.PureComponent),zH=nc(l1e,{componentTreeId:nn},"CommandBar")});var Zle=f(()=>{"use strict";s();Jle()});var DA,GH,efe=f(()=>{"use strict";s();k();DA=I(L());zs();GH=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return DA.createElement(Yr,m({},this.props,{nodeId:"safe-area-observer",isTabbable:!1,focusable:!1}))},t}(DA.Component)});var tfe=f(()=>{"use strict";s();efe()});function rfe(e){var t=function(n){return n.shouldRenderView?wA.createElement(e,m({},n)):wA.Children.only(n.children)};return t.displayName="Conditional".concat(e.displayName||e.name),t}var wA,FA,nfe,OA=f(()=>{"use strict";s();k();wA=I(L());bl();tfe();FA=rfe(J),nfe=rfe(GH)});var f1e,ofe,ife,afe,sfe,dfe,cfe,ufe=f(()=>{"use strict";s();_r();ze();f1e=50,ofe=16,ife=Ce({elevation:2}),afe=new R([R.always(function(e){return{alignItems:"stretch",backgroundColor:e.palette.NavigationBarBackground,borderColor:e.palette.NavigationBarBorder,borderBottomWidth:1,borderTopWidth:1,flexDirection:"row",height:f1e,justifyContent:"space-between",paddingLeft:ofe,paddingRight:ofe}})]),sfe=Ce({width:"25%",flexDirection:"row",justifyContent:"flex-start"}),dfe=Ce({width:"50%",flexDirection:"row",justifyContent:"center"}),cfe=Ce({width:"25%",flexDirection:"row",justifyContent:"flex-end"})});var Bp,qH,iy,lfe=f(()=>{"use strict";s();k();Bp=I(L()),qH=I(ee());Be();Vr();ze();xr();pr();ufe();iy=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.renderWithTheme=function(n){var o=[r.renderStyle(afe,n),r.props.backgroundColor&&{backgroundColor:r.props.backgroundColor},r.props.showShadow&&ife,typeof r.props.outerSpacing=="number"&&{paddingLeft:r.props.outerSpacing,paddingRight:r.props.outerSpacing}];return Bp.createElement(J,{style:o,accessibilityRole:"header"},Bp.createElement(qH.SafeAreaView,{style:sfe},r.props.leftChild),Bp.createElement(J,{style:dfe},r.props.centerChild),Bp.createElement(qH.SafeAreaView,{style:cfe},r.props.rightChild))},r.render=function(){return Ye(r.renderWithTheme,Ze)},r}return t.prototype.renderStyle=function(r,n){return ot(r,n,A.HalfPane)},t}(Bp.PureComponent)});var ffe,ay,KH=f(()=>{"use strict";s();ze();ffe=17,ay=Ce({alignSelf:"stretch",justifyContent:"center",marginLeft:-17,paddingLeft:ffe,marginRight:-17,paddingRight:ffe,zIndex:1})});var TT,NA,YH=f(()=>{"use strict";s();k();TT=I(L());as();xn();KH();NA=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r;return this.props.accessibilityLabel?r=this.props.accessibilityLabel:r=this.props.text,TT.createElement(Wr,{onPress:this.props.onClick,accessibilityLabel:r,accessibilityRole:"button",style:ay,tooltip:this.props.tooltipText,isTabbable:!0,preventDefaultKeyDownBehavior:void 0,nextFocusLeft:this.props.nextFocusLeft,nextFocusRight:this.props.nextFocusRight},TT.createElement(Ve,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},this.props.text))},t}(TT.PureComponent)});var $H=f(()=>{"use strict";s();lfe();YH()});var Up,bT,mfe=f(()=>{"use strict";s();k();Up=I(L());Ld();So();fn();ze();$H();YH();pr();bT=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r=xl()===Xt.LargeDisplay?Wd:Rr;return Up.createElement(J,{style:vr},Up.createElement(iy,{leftChild:this.props.leftButton?Up.createElement(NA,{text:this.props.leftButton.buttonTitle,onClick:this.props.leftButton.buttonPress,icon:0,nextFocusLeft:this.props.leftButton.nextFocusLeft,nextFocusRight:this.props.leftButton.nextFocusRight}):void 0,rightChild:this.props.rightButton?Up.createElement(NA,{text:this.props.rightButton.buttonTitle,onClick:this.props.rightButton.buttonPress,icon:0,nextFocusLeft:this.props.rightButton.nextFocusLeft,nextFocusRight:this.props.rightButton.nextFocusRight}):void 0,showShadow:!!this.props.showShadow,outerSpacing:r}),this.props.children)},t}(Up.PureComponent)});var QH=f(()=>{"use strict";s();mfe()});function MA(e,t,r,n){return e?{typeID:"Comment",author:Nr(t),dateTime:r,target:mW(n)}:void 0}var XH=f(()=>{"use strict";s();hn();Er()});var id,ea,gfe,ST,hfe,yfe,LA=f(()=>{"use strict";s();k();rt();id=I(L());ue();pr();_f();Vr();ze();(function(e){e[e.None=0]="None",e[e.CardExpanding=1]="CardExpanding",e[e.CardCollapsing=2]="CardCollapsing"})(ea||(ea={}));gfe=id.createContext({collapsingCards:[],expandingCards:[]}),ST=id.createContext(ea.None),hfe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.timeoutCookie=void 0,n.state={previousExpandedComments:r.expandedComments,collapsingCards:[],expandingCards:[]},n}return t.getDerivedStateFromProps=function(r,n){if(!le())return{};var o=r.expandedComments.filter(function(d){return!n.previousExpandedComments.includes(d)}),a=n.previousExpandedComments.filter(function(d){return!r.expandedComments.includes(d)});return{previousExpandedComments:r.expandedComments,collapsingCards:a,expandingCards:o}},t.prototype.componentDidUpdate=function(r,n){var o=this,a=!ky(this.state.expandingCards,n.expandingCards)||!ky(this.state.collapsingCards,n.collapsingCards);a&&(this.timeoutCookie!==void 0&&cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=requestAnimationFrame(function(){return o.setState({expandingCards:[],collapsingCards:[]})}))},t.prototype.componentWillUnmount=function(){this.timeoutCookie!==void 0&&(cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=void 0)},t.prototype.render=function(){return id.createElement(gfe.Provider,{value:this.state},id.Children.only(this.props.children))},t}(id.PureComponent),yfe=function(t){var r=function(o){var a,d,c=o.collapsingCards||o.expandingCards?"CommentCard_Container":void 0,u=ea.None;if(t.item.length>0){var l=t.item[0],p=Pr(l)&&l.commentModel.commentId;p&&(!((a=o.expandingCards)===null||a===void 0)&&a.includes(p))?u=ea.CardExpanding:p&&(!((d=o.collapsingCards)===null||d===void 0)&&d.includes(p))&&(u=ea.CardCollapsing)}var g={onFocusCapture:t.onFocusCapture,onLayout:t.onLayout};return id.createElement(J,m({style:vr,animationClass:c},g),id.createElement(ST.Provider,{value:u},t.children))};return Ye(r,gfe)}});var sy,m1e,Vp,HA=f(()=>{"use strict";s();k();sy=I(L()),m1e=function(t){var r=t.delay,n=j(sy.useState(!1),2),o=n[0],a=n[1];return sy.useEffect(function(){var d=setTimeout(function(){a(!0)},r);return function(){clearTimeout(d)}},[r]),o?sy.Children.only(t.children):null},Vp=m1e});function BA(e,t,r,n,o){for(var a=[],d=5;d<arguments.length;d++)a[d-5]=arguments[d];var c=a.reduce(function(l,p){return p>l.max?{min:l.min,max:Math.min(l.min+t,p)}:p<l.min?{min:Math.max(l.max-t,p),max:l.max}:l},{min:o,max:o}),u;return e?c.max>=n+t?u=c.max-t:c.min<n?u=c.min:u=n:u=c.min,JH(u,t,r)}function JH(e,t,r){var n=Math.max(r-t,0);return Math.min(n,Math.max(e,0))}function ZH(e,t){var r=void 0;return e&&(r=t.findIndex(function(n){return wo(n).commentId===e.selectedCardId}),r===-1&&(r=void 0)),r}var UA=f(()=>{"use strict";s();Qo()});function IT(e){if(e!==ea.None)return"CommentCard"}function y1e(e){if(e!==ea.None)return"CommentCard_OverflowRepliesContainer"}function VA(e){if(e!==ea.None)return"CommentCard_Reply"}function C1e(e){if(e!==ea.None)return"CommentCard_ExpandButton"}function v1e(e){if(e!==ea.None)return"CommentCard_AllRepliesContainer"}var vfe,Tt,ET,g1e,h1e,x1e,xfe,Cfe,Tfe=f(()=>{"use strict";s();k();te();rt();Z();Me();Lt();vfe=I(dn()),Tt=I(L()),ET=I(ee());Dc();yS();ue();vl();Od();bf();Rd();Be();B0();Kee();Kc();Vte();UH();Zle();OA();QH();as();pr();tx();xn();zs();W_();XH();LA();mi();Er();Vr();Lo();HA();DC();ri();Ir();UA();xT();rc();fn();ze();xr();wh();g1e=2,h1e=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o._postScrollView=null,o.cardDraftBoxRef=Tt.createRef(),o.cardRootRef=Tt.createRef(),o.hoverManager=new Dh,o.cardHeight=0,o.cardLayoutInProgress=!1,o.scrollableContentLayoutInProgress=!1,o.onHoverChange=function(a){o.props.onCardHighlightChange(o,a)},o.onFocusStateChange=function(a){o.setState({focusState:a})},o.onExpandButtonPress=function(){o.onExpand(!0)},o.resizeAfterCardSizeChanges=function(a){if(o.scrollableContentLayoutInProgress||o.props.displayMode===xe.ReplyPreCommitPending||o.props.displayMode===xe.ReplyPostCommitPending||a!==o.cardHeight)return o.cardHeight;o.cardLayoutInProgress=!1,o.updateScrollViewBoundHeight()},o.resizeAfterPostDataChanges=function(a){if(!o._postScrollView){o.scrollableContentLayoutInProgress=!1;return}if(a.postContentHeight!==o._postListSizes.postContentHeight)return o._postListSizes;o.scrollableContentLayoutInProgress=!1,o.updateScrollViewBoundHeight()},o.onEditorMount=function(){o.props.onCardEditorMounted(o.props.id)},o.onDraftEmptinessChanged=function(a){o.props.onDraftEmptinessChanged(o,a)},o.createMemoizedReactionButtonProps=et(function(a,d,c,u,l,p,g,h,x){if(lo())return{commentId:a,renderContextType:d,isTabbable:c,onReactionPressed:u,reactionType:l,localizationAPI:p,preventDefaultKeyDownBehavior:g,preventReacting:h,userReactionSummary:x}}),o.onLayout=function(a){o.setState({cardWidth:a.nativeEvent.layout.width})},o.onScroll=function(a){var d=a.nativeEvent.contentOffset.y>SK;o.setState({isInnerContentSufficientlyScrolled:d})},o.renderCardBackground=function(a,d){if(le()){var c=[o.renderStyle(wK,a),o.isSelectionWithinCard()&&o.renderStyle(MK,a),o.state.focusState===ge.FocusOn&&o.renderStyle(NK,a),o.props.highlightCard&&o.renderStyle(OK,a),o.props.displayMode===xe.Resolved&&o.props.cardCollapsedState===At.Collapsed&&o.renderStyle(FK,a)];return Tt.createElement(J,{style:c,animationClass:IT(d)})}},o.logDraftCardRendered=zn(function(){var a,d;o.isActiveDraft()&&((d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(Cfe||(Cfe=qt(["DraftCardRendered"],["DraftCardRendered"]))),C.reserveTag(556827599),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary),Gr("RenderContextType",o.props.componentTreeId.renderContextType,N.SystemMetadata),Gr("CardDisplayMode",o.props.displayMode,N.SystemMetadata)))}),o.onCardLayout=function(a){var d,c;o.logDraftCardRendered(),o.cardHeight=a.nativeEvent.layout.height,!o.cardLayoutInProgress&&o.isMaxHeightDefined()&&(o.cardLayoutInProgress=!0,o._resizeAfterCardSizeChangesDebouncer(o.cardHeight)),(c=(d=o.props).onCardLayout)===null||c===void 0||c.call(d,o.props.id,a)},o.getCardAnnotationId=et(function(a,d,c,u){return pW(a,d,c,u)}),o.onPress=function(){o.onExpand(!1)},o.onKeyDown=function(a){a.nativeEvent.key===ne.Enter&&a.nativeEvent.ctrlKey&&!o.props.isDraftEmpty&&(o.isActiveReply()||o.isActiveDraft())&&(o.props.onPost(o,eo.KeyboardShortcut),a.stopPropagation(),a.preventDefault())},o.renderWithContexts=function(a,d,c){var u,l,p,g,h=o.renderStyle(PK,d);o.props.displayMode===xe.Loading?(g=[RK],g.push({height:Bl({itemCount:(u=o.props.itemCount)!==null&&u!==void 0?u:1,readOnly:!1,isTask:!!o.props.taskTopperProps})})):g=[o.renderStyle(_K,d)],!le()&&o.props.contentBackgroundColor&&g.push({backgroundColor:d.palette[o.props.contentBackgroundColor]}),o.props.isNewThread&&o.props.foldableLayoutState===_s.DoublePortrait&&g.push(AK);var x=o.props.componentTreeId.renderContextType,y=o.props.componentTreeId.contextIdentifier,T=x===A.HalfPane&&o.isActiveReply(),b=o.props.displayMode===xe.CardPostCommitPending||o.props.displayMode===xe.ReplyPostCommitPending,S=If({id:o.props.id,renderContextType:x},o.props.isNewThread);return o.logCardRendered(),Tt.createElement(Wr,m({onFocus:o.onCardFocus,style:[h,o.props.style],accessibilityElementsHidden:!o.isSelectionWithinCard()&&x===A.HalfPane,nodeId:S,nodeData:o.getComponentDelegate,ref:o.cardRootRef,accessible:!0,accessibilityLabel:o.props.accessibilityLabel,accessibilityDescription:o.props.accessibilityDescription,accessibilityRole:Y()==="win32"?"treeitem":void 0,accessibilityPositionInSet:o.props.accessibilityPositionInSet,accessibilitySetSize:o.props.accessibilitySetSize,accessibilityLevel:(l=o.props.accessibilityLevel)!==null&&l!==void 0?l:1,accessibilityState:{expanded:o.props.cardCollapsedState===At.Expanded,selected:o.props.selected},accessibilityActions:c_(["Expand","Collapse"]),onAccessibilityAction:o.onAccessibilityAction,testID:S,onFocusStateChange:o.onFocusStateChange,onPress:o.onPress,onKeyDown:Y()==="win32"?o.onKeyDown:void 0,isTabbable:o.props.isTabbable,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,animationClass:IT(a),onLayout:o.onCardLayout,accessibilityAnnotation:MA(!!o.props.isUIAAnnotationPatternEnabled,o.props.author,o.props.timestamp,y),nativeID:o.getCardAnnotationId(x,y,o.props.id,o.props.isNewThread),onAccessibilityOrKeyPress:o.toggleExpansion},o.hoverManager.viewProps),o.renderCardBackground(d,a),o.renderResolvedOrTaskTopper(a),le()&&o.renderCardHeader(),Tt.createElement(Yr,{style:g,onLayout:o.onLayout,animationClass:IT(a)},T?Tt.createElement(bT,{leftButton:{buttonTitle:o.props.localizationAPI.getString(15),buttonPress:o.onAttemptDiscardDraft,nextFocusRight:(p=o.cardDraftBoxRef.current)===null||p===void 0?void 0:p.getEditorWrapperRefHandle()}},Tt.createElement(J,{style:vr},o.getCommentCardInnerContent(a,d,c))):o.props.displayMode===xe.Loading?o.renderLoadingUI(jd):[o.getCommentCardInnerContent(a,d,c),b&&o.renderPendingUI(d)]),o.renderFocusBar(d,a))},o.render=function(){return Ye(o.renderWithContexts,ST,Ze,Zt)},o.state={cardWidth:0,focusState:ge.Unfocused,innerContentBoundHeight:o.isMaxHeightDefined()?aO:void 0,isInnerContentSufficientlyScrolled:!1},o._postListSizes={postListHeight:0,postContentHeight:0},o.onAttemptDiscardDraft=o.onAttemptDiscardDraft.bind(o),o.onExpand=o.onExpand.bind(o),o.onPost=o.onPost.bind(o),o.onEditorPress=o.onEditorPress.bind(o),o.onDraftingInputSizeChange=o.onDraftingInputSizeChange.bind(o),o.setPostScrollView=o.setPostScrollView.bind(o),o.onLayout=o.onLayout.bind(o),o.onPostScrollViewLayout=o.onPostScrollViewLayout.bind(o),o.onPostScrollViewContentSizeChange=o.onPostScrollViewContentSizeChange.bind(o),o.getContentsAsync=o.getContentsAsync.bind(o),o.getCursorPositionAsync=o.getCursorPositionAsync.bind(o),o.getComponentDelegate=o.getComponentDelegate.bind(o),o.onEditorBlur=o.onEditorBlur.bind(o),o.onEditorEscapeRequested=o.onEditorEscapeRequested.bind(o),o.onAccessibilityAction=o.onAccessibilityAction.bind(o),o.onCardSaveDraft=o.onCardSaveDraft.bind(o),o.focus=o.focus.bind(o),o.blur=o.blur.bind(o),o._scrollAfterNewPostDebouncer=vu(function(a,d){return d},o.scrollToEndAfterNewPost.bind(o),function(){return o._postListSizes},250,1e3),o._resizeAfterPostDataChangesDebouncer=vu(function(a,d){return d},o.resizeAfterPostDataChanges,function(){return o._postListSizes},Wn?75:10),o._resizeAfterCardSizeChangesDebouncer=vu(function(a,d){return d},o.resizeAfterCardSizeChanges,function(){return o.cardHeight},Wn?75:10,Wn?250:50),o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return t.prototype.isSessionActiveOrPending=function(r){return r===xe.Draft||r===xe.Reply||r===xe.DraftPreCommitPending||r===xe.ReplyPreCommitPending},t.prototype.componentDidUpdate=function(r){var n;this.isSessionActiveOrPending(r.displayMode)&&!this.isSessionActiveOrPending(this.props.displayMode)&&((n=this.cardDraftBoxRef.current)===null||n===void 0||n.clear());var o=this.props.componentTreeId.renderContextType;o===A.HalfPane&&(this.props.displayMode===xe.Reply||this.props.displayMode===xe.ReplyPreCommitPending)&&!(r.displayMode===xe.Reply||r.displayMode===xe.ReplyPreCommitPending)&&this._postScrollView&&this._postScrollView.scrollTo({x:0,y:0,animated:!1}),o===A.HalfPane&&this.props.displayMode===xe.Normal&&r.displayMode===xe.ReplyPostCommitPending&&this._scrollAfterNewPostDebouncer(this._postListSizes)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()},t.prototype.focus=function(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.focus()},t.prototype.blur=function(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.blur()},t.prototype.onEditorBlur=function(){this.props.onEditorBlur&&this.props.onEditorBlur(this)},t.prototype.onEditorEscapeRequested=function(){(nt()||Y()==="win32")&&this.focus()},t.prototype.getContentsAsync=function(){return this.cardDraftBoxRef.current?this.cardDraftBoxRef.current.getContentsAsync():(v().assertConditionTag(!1,"Draft input box not set",593799008),Promise.resolve(Ad))},t.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},t.prototype.setPostScrollView=function(r){this._postScrollView=r},t.prototype.onPostScrollViewLayout=function(r){this._postListSizes.postListHeight=r.nativeEvent.layout.height},t.prototype.onPostScrollViewContentSizeChange=function(r,n){this._postListSizes.postContentHeight=n,this.isMaxHeightDefined()&&(this.scrollableContentLayoutInProgress||(this.scrollableContentLayoutInProgress=!0,this._resizeAfterPostDataChangesDebouncer(this._postListSizes)))},t.prototype.getCardHeightExcludingInnerContent=function(){if(!(!this.isMaxHeightDefined()||this.state.innerContentBoundHeight===void 0))return this.cardHeight-this.state.innerContentBoundHeight},t.prototype.getCardMaxHeight=function(){var r;return((r=this.props.maximumDimensions)===null||r===void 0?void 0:r.height)!==void 0?Math.max(this.props.maximumDimensions.height,IK):void 0},t.prototype.isMaxHeightDefined=function(){var r;return((r=this.props.maximumDimensions)===null||r===void 0?void 0:r.height)!==void 0},t.prototype.calculateInnerContentBoundHeight=function(){var r=this.getCardMaxHeight(),n=this.getCardHeightExcludingInnerContent();if(!(r===void 0||n===void 0)){var o;o=Math.max(Math.min(r-n,this._postListSizes.postContentHeight+g1e),aO);var a=4-o%4;return a<4&&(o+=a),o}},t.prototype.updateScrollViewBoundHeight=function(){this.scrollableContentLayoutInProgress||this.cardLayoutInProgress||this.setState({innerContentBoundHeight:this.calculateInnerContentBoundHeight()})},t.prototype.onPost=function(r){this.props.onPost(this,r)},t.prototype.onExpand=function(r){this.props.onCardSelectExpand(this,r,Y()==="win32"&&(this.state.focusState===ge.Unfocused||!r&&this.props.selected&&this.state.focusState===ge.FocusWithin))},t.prototype.scrollToEndAfterNewPost=function(r){if(!(this.props.displayMode!==xe.Normal||this.props.componentTreeId.renderContextType!==A.HalfPane||!this.isSelectionWithinCard())){if(r.postContentHeight!==this._postListSizes.postContentHeight||r.postListHeight!==this._postListSizes.postListHeight)return this._postListSizes;this._postScrollView&&this._postScrollView.scrollTo({x:0,y:BA(!0,r.postListHeight,r.postContentHeight,0,r.postContentHeight),animated:!1})}},t.prototype.renderRootPost=function(r){if(r.length!==0)return r[0]},t.prototype.renderFooterReply=function(r){var n=r.length-1;if(!(n<=1))return r[n]},t.prototype.renderOverflowReplies=function(r,n){if(!(n.length<=1)){var o=n.length>2;if(!(o&&this.props.cardCollapsedState===At.Collapsed)){var a=1,d;return n.length===2?d=n.length:d=n.length-1,Tt.createElement(FA,{style:[vr,V0],key:"overflow-posts",animationClass:y1e(r),shouldRenderView:n.length>2},Tt.createElement(Tt.Fragment,null,n.slice(a,d)))}}},t.prototype.getWrappedContent=function(r,n){var o=Tt.Children.toArray(this.props.children),a=this.renderRootPost(o);if(!a)return null;var d=[a];if(this.props.cardCollapsedState===At.Collapsed){var c=this.renderExpandButton({animationClass:C1e(n),minimumMarginLeftRight:Dv(this.state.focusState,this.isSelectionWithinCard()),onPress:this.onExpandButtonPress});d.push(c)}if(!le()||this.props.displayMode!==xe.Resolved||this.props.cardCollapsedState===At.Expanded){var u=this.renderOverflowReplies(n,o),l=this.renderFooterReply(o),p=u||l?Tt.createElement(J,{style:[vr,V0],key:"all-replies",animationClass:v1e(n)},u,l):void 0;d.push(p)}if(le()||d.push(this.renderCardHeader()),this.props.componentTreeId.renderContextType===A.HalfPane&&!this.props.disableScroll)return Tt.createElement(J,{style:vr,key:"content",testID:nW()},Tt.createElement(ET.ScrollView,{keyboardShouldPersistTaps:"always",ref:this.setPostScrollView,scrollEnabled:this.props.isTabbable,onLayout:this.onPostScrollViewLayout,onContentSizeChange:this.onPostScrollViewContentSizeChange,testID:oW()},d));var g=[vr,V0];le()&&r&&g.push(UK);var h=this.isMaxHeightDefined(),x=d;return h&&(x=Tt.createElement(ET.ScrollView,{ref:this.setPostScrollView,onContentSizeChange:this.onPostScrollViewContentSizeChange,onScroll:this.onScroll,style:{height:this.state.innerContentBoundHeight}},d)),Tt.createElement(Yr,{style:g,key:"content",animationClass:IT(n)},x)},t.prototype.getCommentCardInnerContent=function(r,n,o){this.notifyRenderedOnce();var a=this.props.hideDraftBox||this.props.isReadOnly||this.props.displayMode===xe.Resolved,d=this.getWrappedContent(a,r),c;!le()&&this.props.displayMode===xe.Resolved?c=this.renderCommandBar(r):a||(c=this.renderCardDraftBox(r));var u=!le()&&this.renderDraftBoxMessage(!1),l=this.props.hasLowFidelityChild&&this.renderLowFidelityFooter(r,n,o);return[d,c,u,l]},t.prototype.onEditorPress=function(){this.isActiveReply()||this.isActiveDraft()||this.props.onEditorPress(this)},t.prototype.onAttemptDiscardDraft=function(){this.props.onCancel(this)},t.prototype.renderStyle=function(r,n){return ot(r,n,this.props.componentTreeId.renderContextType)},t.prototype.getCommandBarItems=function(){var r=this;return this.props.menuItems.map(function(n){var o;return{id:GI({id:r.props.id,renderContextType:r.props.componentTreeId.renderContextType},(o=n.id)!==null&&o!==void 0?o:n.text),text:n.text,onClick:function(){n.onClick(r.props.id)},accessibilityLabel:Y()==="win32"?n.text:void 0,icon:n.icon,isTabbable:r.props.isTabbable}})},t.prototype.renderCommandBar=function(r){var n=this.getCommandBarItems();if(n.length!==0)return Tt.createElement(zH,{actions:n,key:"heroBar",preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:VA(r)})},t.prototype.getDraftBoxMaxHeight=function(){var r=this.getCardMaxHeight();if(r){var n=Math.round(r/4);return this.props.maxDraftHeight===void 0?n:Math.min(n,this.props.maxDraftHeight)}return this.props.maxDraftHeight},t.prototype.renderCardDraftBox=function(r){var n=this.isActiveDraft(),o=this.isActiveReply(),a=this.props.componentTreeId.renderContextType,d;le()?d=o||n:d=Vd(a)&&o||a===A.HalfPane&&n;var c=this.props.displayMode===xe.Reply||this.props.displayMode===xe.Draft,u=this.props.displayMode===xe.ReplyPreCommitPending||this.props.displayMode===xe.DraftPreCommitPending,l=Ij(this.props.localizationAPI,this.props.supportsAtMentions,n,this.props.cardRelativeDraftingState),p=ti.None;c?p=ti.Editing:u&&(p=ti.Pending);var g=Fj(this.props.localizationAPI,this.props.displayMode,!!this.props.taskTopperProps,this.props.selectedTaskAssignee);return Tt.createElement(jle,{draftWarningState:this.props.draftWarningState,availableScreenHeight:this.props.availableScreenHeight,cancelLabel:n||o?this.props.localizationAPI.getStringOrUndefined(15):void 0,sendLabel:g,id:UI({id:this.props.id,renderContextType:a}),parentId:this.props.id,editMode:p,isNewComment:n,isTabbable:this.props.isTabbable,maxDraftHeight:this.getDraftBoxMaxHeight(),richTextCapabilities:this.props.richTextCapabilities,mentionEditorProps:this.props.mentionEditorProps,onCancel:this.onAttemptDiscardDraft,onInputSizeChange:this.onDraftingInputSizeChange,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onEditorMount:this.onEditorMount,onUnmount:this.onCardSaveDraft,onPost:this.onPost,onPress:this.onEditorPress,onFocus:this.onEditorFocus,onBlur:this.onEditorBlur,onEscapePressed:this.onEditorEscapeRequested,placeholder:l,shouldRestoreDraftOnMount:this.isSessionActiveOrPending(this.props.displayMode),showCancel:d,peoplePickerWidth:this.state.cardWidth,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,sendTestID:Kj({id:this.props.id,renderContextType:a}),cancelTestID:n&&le()?WI({id:this.props.id,renderContextType:a}):Yj({id:this.props.id,renderContextType:a}),savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,ref:this.cardDraftBoxRef,key:"draftBox",isEditorFocusable:!this.props.cardRelativeDraftingState||this.props.cardRelativeDraftingState===cr.InCard,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:VA(r),taskAssigner:this.getTaskAssignerProps(),isCardHovered:this.props.highlightCard,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,telemetryId:this.props.draftId,localizationAPI:this.props.localizationAPI})},t.prototype.shouldHideActions=function(){return this.props.displayMode===xe.Resolved||this.props.displayMode===xe.CardPostCommitPending},t.prototype.renderResolvedOrTaskTopper=function(r){if(le()){var n={cardTopperContainerProps:{animationClass:VA(r),margin:Dv(this.state.focusState,this.isSelectionWithinCard())},preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,resolvedButtonsProps:this.props.displayMode===xe.Resolved?this.getCommandBarItems():void 0};return this.renderResolvedOrTaskTopperHelper(n)}},t.prototype.renderCardHeader=function(){if(!this.props.hideHeader&&!(le()&&this.props.displayMode===xe.Loading))return Tt.createElement(Ute,{key:"header",id:this.props.id,author:this.props.author,isResolvedCard:this.props.displayMode===xe.Resolved,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,cardCollapsedState:this.props.cardCollapsedState,onCancelDraft:this.onAttemptDiscardDraft,menuItems:this.props.menuItems,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,rootAuthorOpacity:this.state.isInnerContentSufficientlyScrolled?0:1,hideActions:this.shouldHideActions(),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,anchorText:this.props.anchorText,isTabbable:this.props.isTabbable,cardBorderWeight:Dv(this.state.focusState,this.isSelectionWithinCard()),allowRootEditButton:this.props.allowRootEditButton,onEditRootPost:this.props.onEditRootPost,isCardHovered:this.props.highlightCard,reactionButtonProps:this.props.userReactionSummary?this.createMemoizedReactionButtonProps(this.props.id,this.props.componentTreeId.renderContextType,this.props.isTabbable,this.props.onReactionUpdated,Ni.Like,this.props.localizationAPI,this.props.preventDefaultKeyDownBehavior,this.props.preventReacting,this.props.userReactionSummary):void 0})},t.prototype.renderFocusBar=function(r,n){if(Vd(this.props.componentTreeId.renderContextType)&&!le()){var o=[this.renderStyle(LK,r)];return(this.isSelectionWithinCard()||this.props.highlightCard||this.state.focusState===ge.FocusOn)&&o.push(this.renderStyle(HK,r)),Tt.createElement(J,{style:o,key:"focusBar",animationClass:IT(n)})}},t.prototype.onDraftingInputSizeChange=function(r){this.props.onDraftingInputSizeChange(this,r)},t.prototype.renderLoadingUI=function(r){var n={id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType};return Tt.createElement(J,{testID:uW(n),style:BK},Tt.createElement(Vp,{delay:r},Tt.createElement(vfe.Spinner,{size:"large"})))},t.prototype.renderPendingUI=function(r){var n=le()?jd:void 0,o=le()?void 0:jd,a;le()?r.themeId===7?a=r.palette.CardReplyBackground:a=!qo()&&this.props.highlightCard?"".concat(r.palette.CardHoveredBackground,"7F"):"".concat(r.palette.CardReplyBackground,"7F"):a=r.themeId===7?r.palette.CardReplyBackground:"".concat(r.palette.CardReplyBackground,"7F");var d=[this.renderStyle(DK,r),{backgroundColor:a}];return Tt.createElement(Vp,{delay:n,key:"spinner"},Tt.createElement(J,{style:this.renderStyle(kK,r)},Tt.createElement(J,{style:d},this.renderLoadingUI(o))))},t.prototype.renderLowFidelityFooter=function(r,n,o){if(Y()==="win32"){var a=mr(o),d=va({icon:26,themeId:n.themeId,renderTarget:"Pane"}),c=this.props.localizationAPI.getString(237),u=this.props.localizationAPI.getString(238),l=Dv(this.state.focusState,this.isSelectionWithinCard());return Tt.createElement(J,{style:VK(l),animationClass:VA(r)},Tt.createElement(J,{style:this.renderStyle(jK(l),n)},d&&Tt.createElement(ET.Image,{source:d.source,style:WK}),Tt.createElement(J,{style:zK},Tt.createElement(Ve,{textStylePolyester:"MediumBold",variantFluent:"secondarySemibold",colorFluent:a.subTextColor},c),Tt.createElement(Ve,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:a.subTextColor},u))))}},t.prototype.getComponentDelegate=function(){return this},t.prototype.onAccessibilityAction=function(r){if(r)switch(r.nativeEvent.actionName){case"Expand":this.props.cardCollapsedState!==At.Expanded&&this.onExpand(!1);return;case"Collapse":this.props.cardCollapsedState!==At.Collapsed&&this.props.onCardCollapse(this)}},t}(dM);x1e=nc(h1e,{componentTreeId:nn},dM.DisplayName),xfe=x1e});var bfe,Sfe,Ife,Efe,Pfe=f(()=>{"use strict";s();bfe=I(dn());_r();ze();Sfe=new kt([kt.always({flexDirection:"row",marginBottom:4,alignItems:"center"})]),Ife=bfe.StyleSheet.createViewStyle({marginLeft:5,flex:1}),Efe=Ce({height:12,width:12,flex:0,marginTop:2})});var jp,_fe,b1e,jA,eB=f(()=>{"use strict";s();jp=I(L()),_fe=I(ee());Lo();rc();fn();ze();xr();pr();xn();Pfe();b1e=jp.memo(function(t){var r=Jg(),n=zd().renderContextType,o=va({icon:t.icon,themeId:r.themeId,renderTarget:"Pane"});return jp.createElement(J,{style:Sfe.render(Kr(n))},o&&jp.createElement(J,{style:Efe},jp.createElement(_fe.Image,{source:o.source,style:vr})),jp.createElement(Ve,{numberOfLines:1,style:Ife,accessible:!1,tooltip:t.description},t.description))}),jA=b1e});var Rfe,Afe=f(()=>{"use strict";s();So();_r();Rfe=new kt([kt.rule({isFluentEnabled:!1},{marginTop:z0}),kt.rule({isFluentEnabled:!0},{marginTop:3})])});var WA,dy,kfe=f(()=>{"use strict";s();Me();WA=I(L());ue();Vr();ri();Ir();fn();xn();Afe();dy=WA.memo(function(t){var r=function(o){var a=mr(o);return WA.createElement(Ve,{style:Rfe.render(Kr(t.renderContextType)),textStylePolyester:le()?"SmallSecondary":"SmallStandard",colorFluent:a.subTextColor,variantFluent:"captionStandard",accessible:Y()==="win32"?!1:void 0},t.timestamp)};return Ye(r,Zt)});dy.displayName="RenderableItemTimestamp"});var tB=f(()=>{"use strict";s();kfe()});var cy,I1e,rB,Dfe=f(()=>{"use strict";s();k();cy=I(L());ue();gl();Av();s_();eB();tB();Er();I1e=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.onFocusParent=function(){return r.props.onFocusParent(r)},r.saveDraftIfEditing=function(n){var o=r.isEditingOrPending(r.props.postDisplayMode);o&&r.props.onSaveDraft(r.getId(),n)},r}return Object.defineProperty(t.prototype,"textEditorRef",{get:function(){return this._textEditorRef},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.props.onPostMounted(this.props.id)},t.prototype.componentWillUnmount=function(){this.textEditorRef&&this.saveDraftIfEditing(this.textEditorRef)},t.prototype.setContents=function(r){this.textEditorRef&&this.textEditorRef.setContents(r)},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.getId=function(){return this.props.id},t.prototype.isEditingOrPending=function(r){return r===Ue.Editing||r===Ue.EditPreCommitPending},t.prototype.renderTimestamp=function(){if(!(this.props.collapsed||this.props.postDisplayMode===Ue.New_nonFluent||this.isEditingOrPending(this.props.postDisplayMode))){var r=this.props.componentTreeId.renderContextType;return cy.createElement(dy,{timestamp:this.props.timestamp,id:zI({id:this.props.id,renderContextType:r}),renderContextType:r,resolved:this.props.postDisplayMode===Ue.Resolved})}},t.prototype.getActionBarItemsAsButtonProps=function(r){var n=this;return r.actionBarItems.map(function(o,a){var d=o.id,c=o.onClick,u=je(o,["id","onClick"]);return m(m({},u),{id:Jj({id:r.id,renderContextType:n.props.componentTreeId.renderContextType},a),onClick:function(){return o.onClick(n)},onKeyDown:function(p){var g;return(g=o.onKeyDown)===null||g===void 0?void 0:g.call(o,p,n)},isTabbable:r.isTabbable})})},t.prototype.getNumberOfHistoryItemsToRender=function(){return!at()||this.props.collapsed?0:this.props.taskHistoryProps.length},t.prototype.renderHistoryItemContent=function(){if(this.props.taskHistoryProps.length!==0&&this.getNumberOfHistoryItemsToRender()!==0)return this.props.taskHistoryProps.map(function(r,n){return cy.createElement(jA,m({},r,{key:r.description}))})},t.prototype.renderDraftBoxMessage=function(r){if(!Pn())return null;var n=this.props.draftWarningState;return!n&&!r?null:cy.createElement(fp,{key:"draftBoxMessage",draftWarningState:n,localizationAPI:this.props.localizationAPI,target:Ud.Post,id:n?Gm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):qm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:r})},t.DisplayName="CommentPost",t}(cy.PureComponent),rB=I1e});var zA,nB,wfe=f(()=>{"use strict";s();k();zA=I(L());TM();nB=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return zA.createElement(hx,{buttons:this.props.actions,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})},t}(zA.PureComponent)});var Ffe=f(()=>{"use strict";s();wfe()});function Ofe(e){var t=e;return typeof t.renderContextType<"u"&&typeof t.warningLabel=="string"&&typeof t.confirmLabel=="string"}var Nfe=f(()=>{"use strict";s()});var Mfe,PT,E1e,oB,Lfe=f(()=>{"use strict";s();k();Lt();Mfe=I(dn()),PT=I(L());Yc();pr();E1e=Ws(Mfe.HyperlinkButton),oB=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.refManager=new tf,r.focus=r.refManager.focus,r.blur=r.refManager.blur,r.getFocusState=r.refManager.getFocusState,r.getChildNodes=r.refManager.getChildNodes,r.addChildNode=r.refManager.addChildNode,r.getDescendantById=r.refManager.getDescendantById,r.getId=r.refManager.getId,r.getData=r.refManager.getData,r.isTabbable=r.refManager.isTabbable,r.getNextTabTarget=r.refManager.getNextTabTarget,r.getIterator=r.refManager.getIterator,r}return t.prototype.render=function(){var r=this.props,n=r.preventDefaultKeyDownBehavior,o=r.onMouseEnter,a=r.onMouseLeave,d=je(r,["preventDefaultKeyDownBehavior","onMouseEnter","onMouseLeave"]),c=Cs(this.props.preventDefaultKeyDownBehavior,we.Capturing);return PT.createElement(J,{accessible:!1,focusable:!1,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,keyDownEvents:c},PT.createElement(E1e,m({},d,{ref:this.refManager.ref,isTabbable:this.props.isTabbable&&!this.props.disabled,preventDefaultKeyDownBehavior:void 0})))},t}(PT.Component)});var Hfe,P1e,lpr,fpr,ppr,Bfe,mpr,gpr,hpr,ypr,Ufe,Vfe=f(()=>{"use strict";s();k();Hfe=I(dn());Ld();Be();Kc();So();_r();ze();P1e="rgba(255,255,255,0.65)",lpr=Ce({flex:1}),fpr=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground}}),R.rule({displayClass:Xt.LargeDisplay,renderContextType:A.HalfPane},{maxWidth:278}),R.rule({displayClass:Xt.LargeDisplay},function(e){return{borderWidth:es,borderColor:e.palette.CardAccent}}),R.rule({displayClass:Xt.SmallPhone},{flex:1})]),ppr=new R([R.always({position:"absolute",alignItems:"center",justifyContent:"center",paddingLeft:16,paddingRight:16,backgroundColor:P1e,height:"100%",width:"100%"}),R.rule({platform:"android"},{zIndex:100})]),Bfe=new R(w(w([R.always({flex:0,padding:16,justifyContent:"center"}),R.rule({renderContextType:A.HalfPane,displayClass:Xt.SmallPhone},{flex:1})],j(q0),!1),[R.rule({platform:"win32"},{flexDirection:"row",paddingLeft:16,paddingBottom:16}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:16+Rr+Yg})],!1)),mpr=new R([R.always(function(e){return{flexDirection:"row",flex:0,borderTopColor:e.palette.CardAccent,borderTopWidth:1,alignItems:"stretch"}})]),gpr=new R([R.always({flex:1,alignContent:"center",justifyContent:"center",height:48}),R.rule({renderContextType:A.FullPane},{height:32}),R.rule({displayClass:Xt.LargeDisplay},function(e){return{backgroundColor:e.palette.CardReplyBackground}})]),hpr=new R([R.always(function(e){return{borderLeftColor:e.palette.ButtonBorder,borderLeftWidth:1}})]),ypr=Hfe.StyleSheet.createViewStyle({textAlign:"center"}),Ufe=Ce({flexDirection:"column",flex:1})});var jfe,Wfe,zfe,Gfe,iB,qfe=f(()=>{"use strict";s();ze();jfe=Ce({width:32,paddingTop:4}),Wfe=Ce({paddingRight:16,height:16,width:16}),zfe=Ce({marginRight:14}),Gfe=Ce({flexDirection:"row",paddingTop:10}),iB=Ce({marginRight:10})});var ai,Kfe,_T,Yfe=f(()=>{"use strict";s();k();Me();Lt();ai=I(L()),Kfe=I(ee());Nfe();px();zs();lx();Er();Vr();ri();rc();ze();xr();Lfe();pr();xn();Vfe();qfe();_T=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.setFocusState=function(o){return n.setState({focusState:o})},n.renderWithTheme=function(o,a){if(!Ofe(n.props))return ai.createElement(ai.Fragment,null,ai.Children.only(n.props.children));var d=mr(a),c=n.state.focusState,u=va({icon:19,themeId:o.themeId,renderTarget:"Pane"});return ai.createElement(Yr,{style:[n.renderStyle(Bfe,n.props,o),c===ge.FocusOn&&n.renderStyle(Rh,n.props,o)],accessibilityLabel:n.props.warningLabel,isTabbable:!0,accessible:!0,focusable:!0,onFocusStateChange:n.setFocusState,onStartShouldSetResponder:wl,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:n.props.nodeId},u&&ai.createElement(J,{style:jfe},ai.createElement(Kfe.Image,{source:u.source,style:Wfe})),ai.createElement(J,{style:Ufe},ai.createElement(Ve,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:d.subTextColor,style:zfe},n.props.warningLabel),ai.createElement(J,{style:Gfe},ai.createElement(oB,{onClick:n.props.onConfirm,isTabbable:!0,text:n.props.confirmLabel,style:iB,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:aW()}),ai.createElement(oB,{onClick:n.props.onCancel,isTabbable:!0,text:n.props.cancelLabel,style:iB,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:sW()}))))},n.render=function(){return Ye(n.renderWithTheme,Ze,Zt)},n.state={focusState:ge.Unfocused},n}return t.prototype.renderStyle=function(r,n,o){return ot(r,o,n.renderContextType)},t}(ai.PureComponent)});var aB=f(()=>{"use strict";s();Yfe()});function GA(e,t,r,n){var o,a;return e===Bt.Edit?(o=37,a=35):(o=2,a=36),{renderContextType:r,cancelLabel:n.getString(15),confirmLabel:n.getString(o),warningLabel:n.getString(a),onCancel:t.onCancel,onConfirm:t.onConfirm}}var sB=f(()=>{"use strict";s();ho()});var A1e,$fe,Qfe=f(()=>{"use strict";s();k();zs();A1e=Yr,$fe=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.getNextTabTarget=function(n,o){var a=e.prototype.getNextTabTarget.call(r,n,o);return a||r.props.disabled?a:e.prototype.getNextTabTarget.call(r,n,!0)},r}return t}(A1e)});function RT(e){return e===Ue.LowFidelityWarningDelete||e===Ue.LowFidelityWarningEdit}var dB=f(()=>{"use strict";s();gl()});function D1e(e,t,r){return!!(Y()!=="win32"&&e!==Ue.Editing&&e!==Ue.EditPreCommitPending&&!t&&r.items.length)}function w1e(e,t,r,n,o,a,d,c,u){var l=o!==Ue.New_nonFluent;if(l){if(e&&D1e(o,a,e))return function(){return Wp.ContextualMenu.showContextualMenu(e,u.current)};var p=a||!d&&Y()==="win32",g=!t&&Y()==="win32"&&r===ge.Unfocused;if(g||p)return function(){return n(c,g)}}}var Wp,Ot,Xfe,k1e,F1e,Jfe,Zfe=f(()=>{"use strict";s();k();rt();Z();Me();Lt();Wp=I(dn()),Ot=I(L()),Xfe=I(ee());yS();hn();ue();vl();ho();d_();ug();gl();Be();Dfe();px();TN();HH();Ffe();Ph();gM();OA();hM();yM();LH();aB();sB();QH();gx();SN();pr();xn();Qa();zs();Qfe();W_();Ti();XH();LA();sM();mi();Er();Vr();Lo();HA();ri();Ir();dB();So();fn();ze();xr();wh();AA();kC();k1e=function(e){X(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o._postContainerRef=Ot.createRef(),o.hoverManager=new Dh,o.fullPanePickerTarget=Ot.createRef(),o.rteRef=Ot.createRef(),o.getMenuPopover=et(j_),o.onHoverChange=function(a){o.setState({isHovered:a})},o.onFocusStateChange=function(a){o.setState({focusState:a})},o.onDraftEmptinessChanged=function(a){o.props.onDraftEmptinessChanged(o,a)},o.onEditorHeightChange=function(a){o.setState({editorHeight:a})},o.onEditorMount=function(){o.props.onPostEditorMounted(o.props.id)},o.onEditorFocusChange=function(a){o.setState({editorFocusState:a})},o.onEdit=function(){o.props.onEdit(o.props.id)},o.createOnPressHandler=eb({},w1e,function(){return[o.state.focusState,o.props.onSelect,o.props.postDisplayMode,o.props.collapsed,!!o.props.selected,o,o._postContainerRef]}),o.createMemoizedContextualMenuProps=et(function(a,d,c){if(Y()!=="win32")return kh(a,d,c)}),o.getFullDescriptionForBody=En(function(a,d,c){if(a===0)return ju(c);var u=d.reduce(function(l,p){return"".concat(l).concat(p.description," ")},"");return"".concat(u).concat(ju(c))},function(){return[o.getNumberOfHistoryItemsToRender(),o.props.taskHistoryProps,o.props.commentBody]}),o.setEditorWrapperRef=function(a){o.setState({editorWrapperRef:a})},o.onActionMenuOpened=function(){!o.props.selected&&Y()==="win32"&&o.props.onSelect(o,!1)},o.renderPostHeader=function(a,d){if(!(o.props.parent&&le())){var c=Ot.createElement(Ve,{style:o.renderStyle(w_,a),variantFluent:"bodySemibold",textStylePolyester:"MediumBold",disabled:Y()!=="win32"&&d.isResolved,numberOfLines:le()?void 0:1,accessible:Y()==="win32"?!1:void 0},Nr(o.props.author));if(!le())return c;var u=d.shouldShowUpperRightActions?"visible":"hidden",l=o.renderEditButton(a,u),p=o.renderActionMenu(a,u),g=o.renderReactionButton(d.shouldShowUpperRightActions);return lo()?Ot.createElement(Yr,{style:o.renderStyle(uM,a)},c,p,l,g):Ot.createElement(Yr,{style:o.renderStyle(uM,a)},c,l,p)}},o.onCollapseParent=function(){return o.props.onCollapseParent(o)},o.renderWithContexts=function(a,d,c){var u=le()&&RT(o.props.postDisplayMode),l=o.props.postDisplayMode===Ue.Resolved,p=o.props.componentTreeId.renderContextType,g,h;le()?(g=!u&&o.isInEdit()&&Vd(p),h=!o.props.collapsed&&(o.props.selected||o.state.isHovered)&&!o.isInEdit()):(g=!u&&o.isInEdit()&&Vd(p),h=!1);var x=[o.renderStyle(D_,d)],y=p===A.HalfPane&&o.isEditingOrPending(o.props.postDisplayMode);!y&&o.isReply()&&x.push(o.renderStyle(F_,d)),g&&x.push(fte),Y()==="win32"&&o.state.focusState===ge.FocusOn&&x.push(o.renderStyle(Rh,d)),le()&&o.props.collapsed&&o.props.postDisplayMode===Ue.Resolved?x.push(o.renderStyle(J0,d)):le()&&!qo()&&o.props.isCardHovered?x.push(o.renderStyle(Z0,d)):x.push(o.renderStyle(X0,d));var T=Gg(x,0,o.props.extraPaddingRight,0,o.props.extraPaddingLeft),b=[o.renderStyle(N_,d)];le()&&o.isInEdit()&&b.push(pte);var S=o.props.parent&&le();S&&b.push(mte);var E=[];if(u)E=[o.renderLowFidelityWarning()];else{var P=o.createMemoizedContextualMenuProps(d.themeId,o.props.actionBarItems,o.props.id);E=[Ot.createElement(Wr,{key:"contents",ref:o._postContainerRef,accessibilityLabel:o.props.accessibilityLabel,accessibilityRole:Y()==="win32"?"treeitem":"button",isTabbable:o.props.isTabbable&&(!o.isInEdit()||Y()==="win32"),nodeId:$a({componentType:Q.Post,id:o.props.id,renderContextType:p}),accessibilityState:o.props.selected?t.selectedAccessibilityState:void 0,testID:jI({id:o.props.id,renderContextType:p}),onFocusStateChange:o.onFocusStateChange,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,onPress:o.createOnPressHandler(P,!1),accessibilityPositionInSet:o.props.accessibilityPositionInSet,accessibilitySetSize:o.props.accessibilitySetSize,accessibilityLevel:o.props.accessibilityLevel,accessible:!0,onAccessibilityOrKeyPress:!o.props.collapsed&&o.props.parent?o.onCollapseParent:void 0,accessibilityDescription:Y()==="win32"?o.getFullDescriptionForBody():void 0,accessibilityAnnotation:o.isReply()?MA(!!o.props.isUIAAnnotationPatternEnabled,o.props.author,o.props.timestamp,o.props.componentTreeId.contextIdentifier):void 0},Ot.createElement(J,{style:T},Ot.createElement(Ot.Fragment,null,!S&&Ot.createElement(td,{accessible:Y()==="win32",isTabbable:o.props.isTabbable&&Y()==="win32",disabled:!le()&&l,nodeId:Km({id:o.props.id,renderContextType:p}),size:le()?Wp.PersonaImageSize.extraSmall:Wp.PersonaImageSize.small,author:o.props.author,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior}),Ot.createElement($fe,{nodeId:"post-ftz",style:Y()==="win32"?b:vr,focusable:Y()==="win32"?!1:void 0,pointerEvents:Y()==="win32"?"box-none":void 0,disabled:!o.isInEdit()||nt()},Ot.createElement(FA,{shouldRenderView:Y()!=="win32",style:b},Ot.createElement(Ot.Fragment,null,o.renderPostHeader(d,{isResolved:l,shouldShowUpperRightActions:h}),k_(o.props)&&Ot.createElement(ex,{dotType:o.props.parent?is.RootPost:is.ReplyPost,historyItemCount:o.getNumberOfHistoryItemsToRender(),renderContextType:p}),o.renderHistoryItemContent(),o.props.postDisplayMode!==Ue.New_nonFluent&&o.renderTextViewOrEditor(d,c,P),o.renderTimestamp(),le()&&o.renderDraftBoxMessage(!1),g&&Ot.createElement(nB,{actions:o.getActionBarItemsAsButtonProps(o.props),barContainerStyle:o.renderStyle(ute,d),buttonStyle:o.renderStyle(lte,d),preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior}),!le()&&o.renderDraftBoxMessage(!1))))))),!le()&&o.props.postDisplayMode===Ue.EditPreCommitPending&&Ot.createElement(J,{style:o.renderStyle(gte,d),key:"Spinner"},Ot.createElement(Vp,{delay:jd},Ot.createElement(Wp.Spinner,{size:"large"})))]}return Ot.createElement(J,m({style:o.renderStyle(O_,d),onLayout:o.onLayout,animationClass:a!==ea.None?"CommentCard_Reply":void 0,ref:o.fullPanePickerTarget},o.hoverManager.viewProps),o.isInEdit()&&p===A.HalfPane?Ot.createElement(bT,{leftButton:{buttonTitle:o.props.localizationAPI.getString(15),buttonPress:o.onCancel},rightButton:{buttonTitle:o.props.localizationAPI.getString(14),buttonPress:o.onCommitButtonClick},showShadow:!0},Ot.createElement(Xfe.ScrollView,{keyboardShouldPersistTaps:"always"},E)):E)},o.render=function(){return Ye(o.renderWithContexts,ST,Ze,Zt)},o.onCommit=o.onCommit.bind(o),o.onCommitButtonClick=o.onCommitButtonClick.bind(o),o.onCancel=o.onCancel.bind(o),o.onLayout=o.onLayout.bind(o),o.state={postWidth:void 0,isHovered:!1,focusState:ge.Unfocused,editorFocusState:ge.Unfocused,editorHeight:void 0,editorWrapperRef:null,preEditText:r.commentBody,isTransitioningToEdit:!1},o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return Object.defineProperty(t.prototype,"textEditorRef",{get:function(){if(this.rteRef.current){var n=this.rteRef.current.getData();return Np(n)?n:void 0}},enumerable:!1,configurable:!0}),t.getDerivedStateFromProps=function(r,n){return r.postDisplayMode===Ue.Editing&&!n.isTransitioningToEdit?{isTransitioningToEdit:!0,preEditText:r.commentBody}:r.postDisplayMode!==Ue.Editing&&n.isTransitioningToEdit?{isTransitioningToEdit:!1}:{}},t.prototype.componentDidUpdate=function(r){this.props.commentBody!==r.commentBody&&this.textEditorRef&&!this.isEditingOrPending(this.props.postDisplayMode)&&this.textEditorRef.setContents(this.props.commentBody),!this.isEditingOrPending(this.props.postDisplayMode)&&this.isEditingOrPending(r.postDisplayMode)&&this.props.postDisplayMode!==Ue.PendingEdit&&this.textEditorRef&&this.textEditorRef.setContents(this.props.commentBody),v().assertConditionTag(this.props.draftId===void 0||this.isEditingOrPending(this.props.postDisplayMode),"post has draft state and is not in editing mode",593802706)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()},t.prototype.isInEdit=function(){return this.isEditingOrPending(this.props.postDisplayMode)},t.prototype.isReply=function(){return!this.props.parent},t.prototype.onCommit=function(r){this.props.onCommit(this,r)},t.prototype.onCommitButtonClick=function(){this.onCommit(eo.CommitButton)},t.prototype.onCancel=function(){this.props.onCancel(this)},t.prototype.renderStyle=function(r,n){return ot(r,n,this.props.componentTreeId.renderContextType)},t.prototype.onLayout=function(r){this.setState({postWidth:r.nativeEvent.layout.width})},t.prototype.getPickerPosition=function(){var r=this.props.componentTreeId.renderContextType===A.FullPane?this.fullPanePickerTarget.current:this.state.editorWrapperRef;if(!(!r||!this.state.postWidth))return{target:r,left:0,top:0,width:this.state.postWidth,height:this.props.availableScreenHeight||0}},t.prototype.renderLowFidelityWarning=function(){var r=this.props.componentTreeId.renderContextType;return Ot.createElement(_T,m({},GA(this.props.postDisplayMode===Ue.LowFidelityWarningEdit?Bt.Edit:Bt.DeleteReply,{onCancel:this.props.onLowFidelityWarningCancel,onConfirm:this.props.onLowFidelityWarningConfirm},r,this.props.localizationAPI),{preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,key:"lowFidelityWarning",nodeId:$a({componentType:Q.Post,id:this.props.id,renderContextType:r})}))},t.prototype.renderTextViewOrEditor=function(r,n,o){var a=this.props.postDisplayMode===Ue.Editing,d=a?vn.Editing:vn.ReadOnly,c=a?this.props.savedDraftContent:void 0,u=[this.renderStyle(ote,r)],l=this.props.postDisplayMode===Ue.Resolved,p=this.props.componentTreeId.renderContextType,g=!1,h=void 0;if(le()){if(l&&this.props.collapsed&&u.push(this.renderStyle($g,r)),this.isEditingOrPending(this.props.postDisplayMode)){if(u.push(this.renderStyle(Y0,r),this.renderStyle(ite,r)),this.state.editorFocusState!==ge.Unfocused&&u.push(this.renderStyle($0,r)),Pn()&&this.props.draftWarningState){var x=mr(n);u.push(Tl(kA,x,p))}}else this.props.collapsed&&(u.push(ate),g=!!(this.state.editorHeight&&this.state.editorHeight>=cM));g&&(h=this.renderStyle(this.props.collapsed&&l?cte:!qo()&&this.props.isCardHovered?dte:ste,r))}var y=this.props.isTabbable&&!g;return Ot.createElement(J,{style:u,ref:this.setEditorWrapperRef,collapsable:!1},Ot.createElement(RA,m({nodeId:$a({id:this.props.id,renderContextType:p,componentType:Q.PostEditor}),id:VI({id:this.props.id,renderContextType:p}),ref:this.rteRef,defaultValue:this.isEditingOrPending(this.props.postDisplayMode)?this.state.preEditText:this.props.commentBody,displayMode:d,savedDraftContent:c,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.isEditingOrPending(this.props.postDisplayMode),onPress:this.createOnPressHandler(o,!0),peoplePickerPosition:this.getPickerPosition(),isTabbable:y,focusable:!this.props.collapsed||y,onContentSizeChange:this.onEditorHeightChange,onCommitRequested:this.onCommit,onEscapeRequested:this.onFocusParent,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onMount:this.onEditorMount,onUnmount:this.saveDraftIfEditing,onFocusStateChange:Y()==="win32"?this.onEditorFocusChange:void 0,maxHeight:this.props.collapsed?cM:void 0,accessibilityLabel:Y()==="win32"?kj(this.props.localizationAPI):void 0,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,localizationAPI:this.props.localizationAPI},this.props.mentionableEditorProps)),g&&Ot.createElement(J,{style:h}))},t.prototype.renderActionMenu=function(r,n){if(this.props.actionBarItems.length===0)return null;var o=this.props.componentTreeId.renderContextType;return this.isReply()&&Ot.createElement(Tn,{onClick:Y()==="win32"?void 0:kh(r.themeId,this.props.actionBarItems,this.props.id),accessibilityLabel:this.props.localizationAPI.getString(123),style:this.renderStyle(Q0,r),text:"",appearance:"subtle",isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,tooltipText:this.props.localizationAPI.getString(123),nodeId:oF({id:this.props.id,renderContextType:o}),testID:oF({id:this.props.id,renderContextType:o}),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,visibility:n,menuProps:Y()==="win32"?{menu:this.getMenuPopover(kh(r.themeId,this.props.actionBarItems,this.props.id).items),props:{onOpenChange:this.onActionMenuOpened}}:void 0})},t.prototype.renderEditButton=function(r,n){if(!rf()||!this.props.isEditable)return null;var o=this.props.componentTreeId.renderContextType;return Ot.createElement(Tn,{icon:6,onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),text:"",appearance:"subtle",isTabbable:this.props.isTabbable,key:"postEditButton",tooltipText:this.props.localizationAPI.getString(120),nodeId:iF({id:this.props.id,renderContextType:o}),testID:iF({id:this.props.id,renderContextType:o}),visibility:n,style:this.renderStyle(Qg,r),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})},t.prototype.renderReactionButton=function(r){return!lo()||this.props.userReactionSummary===void 0?null:Ot.createElement(U_,{commentId:this.props.id,isTabbable:this.props.isTabbable,onReactionPressed:this.props.onReactionUpdated,reactionType:Ni.Like,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,renderHiddenIfNoReactions:!r,renderContextType:this.props.componentTreeId.renderContextType,key:"cardReactionButton"})},t.selectedAccessibilityState={selected:!0},t}(rB);F1e=nc(k1e,{componentTreeId:nn},rB.DisplayName),Jfe=F1e});function epe(e,t,r,n,o,a,d,c,u,l,p){if(t===xe.Draft||t===xe.DraftPreCommitPending)return n?e.formatString(224,n):e.getString(223);if(t===xe.Loading)return e.getString(225);var g=[],h=a?pE(a.completion):t===xe.Resolved;if(a){var x=a==null?void 0:a.assignees[0];x?g.push(e.formatString(h?215:214,Nr(x))):g.push(e.getString(h?217:216)),g.push(e.formatString(p?266:212,r))}else g.push(e.formatString(h?213:p?265:211,r));return n&&g.push(e.formatString(218,n)),(t===xe.Reply||d===cr.InChildPost)&&g.push(e.getString(222)),o===1?g.push(e.getString(219)):o>1&&g.push(e.formatString(220,String(o))),(t===xe.CardPostCommitPending||t===xe.ReplyPostCommitPending)&&g.push(e.getString(221)),c&&(g.push(e.getString(237)),g.push(e.getString(238))),g.join(e.getString(226))}var tpe=f(()=>{"use strict";s();hn();bf();Rd();XC()});var uy,cB=f(()=>{"use strict";s();Z();gl();tpe();uy={getCardA11yLabel:epe,getPostA11yLabel:function(t,r,n,o,a){var d=a.isUnread,c=a.author,u=a.timestamp;return o.formatString(r===Ue.PendingDraft||r===Ue.PendingEdit?210:d?209:208,c,u)},getTaskHistoryItemA11yLabel:function(t,r,n){return r&&n?t.formatString(232,r,n):(v().assertConditionTag(!1,"Task History Item accessibility label not resolving properly",557352448),t.getString(119))},getTaskHistoryA11yDescription:function(t){if(t.length>0)return t.map(function(r){return r.description}).join(", ");v().assertConditionTag(!1,"Task History Item accessibility description not resolving properly",527765771)}}});function npe(e,t){var r=e.id,n=e.timestamp,o=e.historyItemContent,a=zd(),d=hu.useCallback(function(){return r},[r]),c=hu.useCallback(function(){return hu.createElement(dy,{timestamp:n,id:zI({id:r,renderContextType:a.renderContextType}),renderContextType:a.renderContextType})},[r,n,a]),u=hu.useCallback(function(){return o.map(function(p){return hu.createElement(jA,{icon:p.icon,description:p.description,key:p.description})})},[o]),l=hu.useMemo(function(){return{getId:d}},[d]);return(0,rpe.useImperativeHandle)(t,function(){return l},[l]),{getId:d,renderTimestamp:c,renderHistoryItemContent:u,componentTreeId:a,imperativeHandle:l}}var hu,rpe,ope=f(()=>{"use strict";s();hu=I(L()),rpe=I(L());Er();Lo();eB();tB()});var ipe,ape=f(()=>{"use strict";s();ze();ipe=Ce({minHeight:24,flexDirection:"row",alignItems:"center"})});function qA(e,t,r){return ot(e,t,r)}var spe,Hn,O1e,dpe,cpe=f(()=>{"use strict";s();k();Lt();spe=I(dn()),Hn=I(L());px();Qa();Ti();cB();Er();fn();ze();xr();gx();as();pr();xn();ope();ape();O1e={selected:!0};dpe=Hn.memo(Hn.forwardRef(function(e,t){var r=e.id,n=e.collapsed,o=e.onSelect,a=e.author,d=e.preventDefaultKeyDownBehavior,c=Jg(),u=npe(e,t),l=u.componentTreeId,p=u.renderHistoryItemContent,g=u.renderTimestamp,h=u.imperativeHandle,x=l.renderContextType,y=j(Hn.useState(ge.Unfocused),2),T=y[0],b=y[1],S=Hn.useMemo(function(){var O=[qA(D_,c,x),qA(F_,c,x)];return T===ge.FocusOn&&O.push(qA(Rh,c,x)),O},[c,x,T]),E=Hn.useCallback(function(O){b(O)},[b]),P=Hn.useCallback(function(){var O=T===ge.Unfocused;o(h,O)},[o,T,h]),_=Hn.useCallback(function(){return Hn.createElement(td,{nodeId:Km({id:r,renderContextType:x}),size:spe.PersonaImageSize.extraSmall,author:a,preventDefaultKeyDownBehavior:d})},[r,a,d,x]),D=Hn.useCallback(function(){return Hn.createElement(J,{style:ipe},Hn.createElement(Ve,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",key:"name",accessible:!1},a.DisplayName||""))},[a]);return Hn.createElement(Wr,{isTabbable:e.selected&&!e.collapsed,preventDefaultKeyDownBehavior:d,style:qA(O_,c,x),key:r,focusable:!0,nodeId:$a({componentType:Q.Post,id:r,renderContextType:x}),onPress:P,accessible:!0,accessibilityLabel:e.accessibilityLabel,accessibilityState:e.selected?O1e:void 0,accessibilityRole:"treeitem",accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityDescription:uy.getTaskHistoryA11yDescription(e.historyItemContent),onFocusStateChange:E},Hn.createElement(J,{style:S},_(),Hn.createElement(J,{style:N_.render(Kr(x))},D(),p(),!n&&g())))}))});function upe(e,t){return e===t?!0:e.length!==t.length?!1:e.every(function(r,n){return yo(r[0])===yo(t[n][0])})}function lB(e,t){return!!t&&t.selectedCardId===e&&!Xe(t.selectionDetails)}function lpe(e,t){return!!t&&t.selectedCardId===e&&Xe(t.selectionDetails)}function uB(e,t){return!!t&&Xe(t.selectionDetails)&&t.selectionDetails.selectedPostId===e}function KA(e,t,r,n,o){switch(e){case zi.AllCardsTabbable:return!0;case zi.ExpandedCardOrFirstCardTabbable:{if(o){var a=lB(t,o),d=lpe(t,o);return a||n===At.Expanded&&d}return r}case zi.ExpandedCardTabbable:return o?n===At.Expanded:!1;case zi.SelectedCardTabbable:return!!o&&o.selectedCardId===t}}function N1e(e,t,r,n,o,a){if(n===Ue.PendingEdit||n===Ue.PendingDraft)return uB(t,a);switch(e){case Gi.AllPostsTabbable:return!0;case Gi.ExpandedCardPostsTabbable:return o===At.Expanded;case Gi.ExpandedCardRootPostTabbable:{var d=uB(t,a),c=lB(r||t,a);return n!==Ue.New_nonFluent&&(d||c&&o===At.Expanded&&!r)}case Gi.SelectedPostTabbable:return uB(t,a)}}function M1e(e,t,r){return At.Collapsed===e?!0:!(r===void 0||r===cr.InChildPost&&t)}function L1e(e,t,r,n,o,a,d,c,u,l,p,g,h,x,y,T,b){var S=e.localizationAPI,E=e.selectedState,P=e.isDraftThread,_=e.isCommentsContextReadOnly,D=e.draftState,O=e.cardCollapsedState,H=!1;E&&Xe(E.selectionDetails)&&(H=E.selectionDetails.selectedPostId===t.commentId);var V=j1e(t,r,D,E,n,u,P),M=!!(t.commentFlags&Fe.ReadOnly||_),G=r.displayDate||"",K=D.postIdToDraftIdMap[t.commentId],z=K?D.drafts[K]:void 0,$=!!z&&z.renderContextType!==e.renderContextType,q=u&&z?m({draftId:K},sF(z)):{};return zp.createElement(Jfe,m({},e.postCallbacks,q,{postDisplayMode:V,isReadOnly:M,id:t.commentId,author:t.author,authorColor:a==null?void 0:a.authorColor,authorImageURL:a==null?void 0:a.authorImageURL,timestamp:G,commentBody:t.commentBody,parent:t.parentId==="",lowFidelityWarningString:H?Pj(S,E):"",selected:H,isTabbable:N1e(o,t.commentId,t.parentId,V,O,E),supportsAtMentions:e.isAtMentionEnabled,localizationAPI:S,actionBarItems:e.getActionBarItems(V,E==null?void 0:E.selectionDetails.lowFidelityWarningType,y,t.parentId==="",M,t.commentFlags,qy()),accessibilityLabel:uy.getPostA11yLabel(t.parentId.length===0,V,M,S,{author:Nr(t.author),timestamp:G,repliesCount:d,commentBody:t.commentBody,isReplyPending:c,isUnread:le()&&!!(t.commentFlags&Fe.IsNew),anchorHintText:t.anchorHintText}),key:t.commentId,mentionableEditorProps:e.mentionableEditorProps,taskHistoryProps:p,accessibilityPositionInSet:l.accessibilityPositionInSet,accessibilitySetSize:l.accessibilitySetSize,accessibilityLevel:l.accessibilityLevel,isNew:!!(t.commentFlags&Fe.IsNew),scrollingContainerId:g,isCardHovered:e.isCardHighlighted,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,collapsed:h,restrictActionControls_deprecated:x,preventReacting:M||y===Jn.None||!!(t.commentFlags&Fe.ReactionRestricted)||V===Ue.Resolved,richTextCapabilities:e.richTextCapabilities,usersByReactionType:lo()?t.usersByReactionType:void 0,userReactionSummary:lo()?t.userReactionSummary:void 0,dulledAtMentions:T,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,isEditable:!(t.commentFlags&Fe.EditRestricted)&&!(t.commentFlags&Fe.ReadOnly)&&V!==Ue.Resolved&&y===Jn.Any,cardSelected:b,hasDraftInOtherRenderContext:$}))}function H1e(e,t,r,n,o,a,d,c,u,l,p){var g=IF(t,e),h=Qu(t.taskId,t.records[0].recordId),x=!1;a&&Xe(a.selectionDetails)&&(x=a.selectionDetails.selectedPostId===h);var y=p.displayDate;return zp.createElement(dpe,{historyItemContent:g,onSelect:r.onSelect,id:h,key:h,author:t.records[0].user,timestamp:y,selected:x,authorColor:n==null?void 0:n.authorColor,authorImageURL:n==null?void 0:n.authorImageURL,resolved:o,collapsed:d,restrictActionControls_deprecated:c,accessibilitySetSize:u.accessibilitySetSize,accessibilityPositionInSet:u.accessibilityPositionInSet,accessibilityLabel:uy.getTaskHistoryItemA11yLabel(e,t.records[0].user.DisplayName,y),preventDefaultKeyDownBehavior:l})}function B1e(e,t,r,n,o,a,d,c,u,l,p,g,h,x){var y=e.cardState,T=e.cardCallbacks,b=e.localizationAPI,S=e.selectedState,E=e.isAtMentionEnabled,P=e.isTaskCreationEnabled,_=e.draftState,D=e.cardCollapsedState,O=e.cardRelativeDraftingState,H=e.maximumDimensions,V=e.isolationEdit,M=e.richTextCapabilities,G=e.thread,K=qu(y.loadState)?y.loadState.initialItemCount:n.length,z=_.cardIdToDraftIdMap[t.commentId],$=z?_.drafts[z]:void 0,q=O===cr.InCard,re=q&&$?m({draftId:z},sF($)):{};return zp.createElement(xfe,m({},T,re,{cardCollapsedState:D,selected:u,isReadOnly:g,hasSelectedChild:l,hasLowFidelityChild:p,displayMode:o,id:t.commentId,supportsAtMentions:E,isTabbable:e.isCardTabbable,localizationAPI:b,accessibilityLabel:uy.getCardA11yLabel(b,o,Nr(t.author),t.anchorHintText,K-1,r,O,p&&Y()==="win32",c,t.commentBody,x),accessibilityDescription:Y()==="win32"?ju(wo(G).commentBody):void 0,anchorText:t.anchorHintText,author:t.author,authorColor:a?a.authorColor:"",authorImageURL:a?a.authorImageURL:"",cardRelativeDraftingState:O,supportsTaskCreation:P,taskTopperProps:r,isNewThread:e.isDraftThread,foldableLayoutState:e.foldableLayoutState,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityLevel:e.accessibilityLevel,maximumDimensions:H,scrollingContainerId:d,itemCount:K,menuItems:e.getCardContextualMenuItems(t.commentFlags,e.allowedDraftingSession,e.isResolveSupported,Jw(t,S),!!e.taskState,qy()),allowRootEditButton:!(t.commentFlags&Fe.EditRestricted||t.commentFlags&Fe.ReadOnly||Jw(t,S))&&e.allowedDraftingSession===Jn.Any,mentionEditorProps:e.mentionEditorProps,onCardLayout:e.onCardLayout,timestamp:c,restrictActionControls_deprecated:e.restrictActionControls_deprecated,preventReacting:g||e.allowedDraftingSession===Jn.None||!!(t.commentFlags&Fe.ReactionRestricted)||o===xe.Resolved,contentBackgroundColor:e.contentBackgroundColor,maxDraftHeight:e.maxDraftHeight,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,highlightCard:e.isCardHighlighted,hideDraftBox:V||e.isCommentsContextReadOnly,hideHeader:V,disableScroll:V,style:e.cardStyle,richTextCapabilities:M,usersByReactionType:lo()?t.usersByReactionType:void 0,userReactionSummary:lo()?t.userReactionSummary:void 0,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,tabFocusTrapBehavior:h}),n)}function U1e(e){var t,r=e.thread,n=e.renderContextType,o=e.cardState,a=e.postOrHistoryRecordStates,d=e.postCallbacks,c=e.cardCallbacks,u=e.localizationAPI,l=e.selectedState,p=e.isolationEdit,g=e.isDraftThread,h=e.isCommentsContextReadOnly,x=e.keyboardingOptions,y=e.personaIconPropertiesMap,T=e.draftState,b=e.cardCollapsedState,S=e.cardRelativeDraftingState,E=e.maximumDimensions,P=e.preventDefaultKeyDownBehavior,_=e.restrictActionControls_deprecated,D=e.allowedDraftingSession,O=e.taskState,H=e.isCardTabbable,V=e.tabFocusTrapBehavior,M=wo(r),G=M.commentId,K=S===cr.InChildPost,z=!!(M.commentFlags&Fe.Resolved),$=a[0].displayDate||"",q=[],re=W1e(M,o,T,l,S===cr.InCard,g),ae=lB(M.commentId,l),ie=h||!!(M.commentFlags&Fe.ReadOnly),Te=lpe(M.commentId,l),Oe=mK(re===xe.Resolved,b===At.Collapsed,ae||Te),ke=r.length-1,it=!1,_e=!qu(o.loadState),ct=n!==A.HalfPane&&!le(),Ge=!1;if(_e&&(!g||ct))for(var Nt=0;Nt<r.length;Nt++){var Vt=r[Nt],yt=a[Nt];if(Pr(Vt)){Vt.commentModel.commentFlags&Fe.LowFidelity&&(it=!0);var zt=Vt.commentModel.commentId,Fr=ws(T)===zt,In=!!T.postIdToDraftIdMap[zt];if(Ge=Ge||!!(Vt.commentModel.commentFlags&Fe.IsNew),!yt)throw new he("Post Or History Record state undefined for comment ".concat(zt),C.reserveTag(589103624),-2130957493);if((!p||!K||In)&&PW(yt)&&yt.pending!==qr.Delete){var jn=QW(Vt)?IF(Vt.historyItem,u):[],io=M1e(b,Fr,S);q.push(L1e(e,Vt.commentModel,yt,z,x.postTabbingMode,ka()?qC(y,Vt.commentModel.author):void 0,ke,o.pending===pt.Editor,K||g,{accessibilitySetSize:r.length,accessibilityPositionInSet:Nt+1,accessibilityLevel:((t=e.accessibilityLevel)!==null&&t!==void 0?t:1)+1},jn,E&&E.height?Xj({id:G,renderContextType:n}):$t(n)?RC():void 0,b===At.Collapsed,io,D,Oe,ae))}}else at()&&q.push(H1e(u,Vt.historyItem,d,ka()?qC(y,Vt.historyItem.records[0].user):void 0,z,l,b===At.Collapsed,_,{accessibilitySetSize:r.length,accessibilityPositionInSet:Nt+1},P,yt))}var ut=D===Jn.None||!e.isResolveSupported,pn=O?z1e(G,O,u,!!(M.commentFlags&Fe.Resolved),ie?Kf.ReadOnly:ut?Kf.Disabled:Kf.Default,c.onTaskTopperCheckboxPressed,P,H&&!ut):void 0;return B1e(e,M,pn,q,re,ka()?qC(y,M.author):void 0,$t(n)?RC():void 0,$,ae,Te,it,ie,V,Ge)}function YA(e){return zp.createElement(V1e,m({},e))}function j1e(e,t,r,n,o,a,d){if(t.pending!==qr.None)return v().assertConditionTag(t.pending!==qr.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595153811),d?Ue.PendingDraft:Ue.PendingEdit;if(a){if(d)return v().assertConditionTag(!le(),"New post should not be rendered while drafting in fluent.",574755652),Ue.New_nonFluent;if(r.postIdToDraftIdMap[e.commentId])return hi(r)?Ue.EditPreCommitPending:Ue.Editing}if(n&&pi(n)===e.commentId)switch(n.selectionDetails.lowFidelityWarningType){case void 0:break;case Bt.DeleteReply:return Ue.LowFidelityWarningDelete;case Bt.Edit:return Ue.LowFidelityWarningEdit;case Bt.DeleteThread:return le()?Ue.LowFidelityWarningDelete:Ue.Normal;default:Ne(n.selectionDetails)}return t.displayingErrorUI?Ue.Error:o?Ue.Resolved:Ue.Normal}function W1e(e,t,r,n,o,a){if(qu(t.loadState))return xe.Loading;switch(t.pending){case pt.Card:case pt.Delete:return xe.CardPostCommitPending;case pt.Editor:return xe.ReplyPostCommitPending;case pt.None:break;default:Ne(t.pending)}if(a)return hi(r)?xe.DraftPreCommitPending:xe.Draft;if(n&&n.selectedCardId===e.commentId&&EC(n)&&!le())return xe.LowFidelityWarningOnDeleteThread;if(o){if(r.cardIdToDraftIdMap[e.commentId])return hi(r)?xe.ReplyPreCommitPending:xe.Reply;if(r.pendingDraft&&r.pendingDraft.sessionType==="REPLY"&&r.pendingDraft.threadId===e.commentId)return xe.ReplySessionRequestPending}return e.commentFlags&Fe.Resolved?xe.Resolved:xe.Normal}function fB(e,t,r,n){if(e&&!(!r[e.selectedCardId]||r[e.selectedCardId].pending===pt.Delete)){var o=Je(t);return o!==e.selectedCardId||!t.pendingDraft&&(!t.drafts[o]||t.drafts[o].isInCurrentContext&&t.drafts[o].renderContextType===n)?e.selectedCardId:void 0}}function z1e(e,t,r,n,o,a,d,c){if(at()){var u=t.completion,l=u===fE;return n!==l&&(v().assertConditionTag(!1,"Comment and task resolve state don't match",570826896),u=n?fE:0),{id:e,title:t.title,assignees:t.assignees,completion:u,onResolveTaskCheckboxPressed:a,localizationAPI:r,displayMode:o,preventDefaultKeyDownBehavior:d,isTabbable:c}}}function fpe(e,t,r){return e.map(function(n){var o=yo(n);return t[o]||r&&r[o]})}var zp,V1e,$A=f(()=>{"use strict";s();k();te();Z();zp=I(L());Ic();hn();tr();ue();PF();xt();Wu();Rn();$m();ho();lv();Od();bf();Rd();gl();Be();S1();Tfe();Zfe();cpe();fv();_f();kC();cB();mi();Er();Ir();gi();Qo();fn();XC();V1e=zp.memo(U1e)});function mpe(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;var r=Object.keys(e),n=Object.keys(t);return r.length!==n.length?!1:r.every(function(o){return e[o]===t[o]})}var gpe=f(()=>{"use strict";s()});function XA(e,t,r,n,o,a,d){var c=[];if(d&&c.push(e.linkToComment),r===Jn.None||t&Fe.ReadOnly)return c;var u=(t&Fe.Resolved)>0,l=a?e.resolveTask:e.resolveThread,p=a?e.deleteTask:e.deleteThread;return v().assertConditionTag(n||!u,"Card cannot be resolved when resolved is not supported",593764383),u&&n?(c.push(e.reopenThread),t&Fe.DeleteRestricted||c.push(p),c):(r===Jn.Any&&le()&&!rf()&&!(t&Fe.EditRestricted)&&!o&&c.push(e.editRootPost),d&&n&&c.push(l),t&Fe.DeleteRestricted||c.push(p),!d&&n&&c.push(l),c)}function JA(e,t){var r={text:e.getString(5),icon:3,onClick:t.onDeleteThread,isDestructive:!0,tooltipText:e.getString(5)},n={text:e.getString(3),icon:5,onClick:t.onResolveThread},o=e.getString(4),a={id:qI(),text:o,icon:le()?16:4,onClick:t.onReopenThread,tooltipText:o},d={text:e.getString(120),onClick:t.onEditRootPost,icon:6,accessibilityLabel:e.getString(120)},c={text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25,tooltipText:e.getString(207)},u=m(m({},r),{text:e.getString(206),tooltipText:e.getString(206)}),l={text:e.getString(126),icon:5,onClick:t.onResolveThread};return{deleteThread:r,resolveThread:n,reopenThread:a,editRootPost:d,linkToComment:c,deleteTask:u,resolveTask:l}}function ZA(e,t){var r=le(),n=e.getString(15),o=e.getString(121),a={text:e.getString(184),onClick:t.onClearError,icon:19,accessibilityLabel:e.getStringOrUndefined(184)},d={text:e.getString(5),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(5),isDestructive:!0},c=r?o:e.getString(2),u={text:c,onClick:t.onDelete,icon:3,accessibilityLabel:c,isDestructive:!0},l=r?e.getString(120):e.getString(1),p={text:l,onClick:t.onEdit,icon:6,accessibilityLabel:l},g={text:n,icon:1,onClick:t.onCancel,onKeyDown:function(D,O){if(!O){v().assertConditionTag(!1,"CommentPostInterface ref is undefined for cancelEditItem.",544477844);return}Cc(D.key)===ne.Enter&&t.onCancel(O)},accessibilityLabel:n,isCancelItem:!0,usePrimaryButtonStyling:!1,tooltipText:n},h={text:e.getString(14),icon:24,onClick:function(D){return t.onCommit(D,eo.CommitButton)},onKeyDown:function(D,O){if(!O){v().assertConditionTag(!1,"CommentPostInterface ref is undefined for saveItem.",544477845);return}Cc(D.key)===ne.Enter&&t.onCommit(O,eo.CommitButton)},accessibilityLabel:e.getString(173),usePrimaryButtonStyling:!0,tooltipText:e.getString(173)},x=m(m({},h),{showDelayedSpinner:!0}),y=r?o:e.getString(2),T={text:y,onClick:t.onLowFidelityWarningConfirm,icon:3,accessibilityLabel:y,isDestructive:!0},b={text:n,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:n,icon:0,isCancelItem:!0},S={text:e.getString(37),onClick:t.onLowFidelityWarningConfirm,accessibilityLabel:e.getStringOrUndefined(42),icon:0},E={text:n,icon:1,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:n,isCancelItem:!0,tooltipText:n},P={text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25};return{retry:a,deleteRootItem:d,cancelEditItem:g,cancelLowFidelityWarningDeleteItem:b,cancelLowFidelityWarningEditItem:E,deleteItem:u,deleteItemForLowFidelityWarningDelete:T,editItem:p,proceedItemForLowFidelityWarningEdit:S,saveItem:h,saveItemPending:x,linkToCommentMenuItem:P}}var QA,pB=f(()=>{"use strict";s();k();Z();Lt();Ic();ue();vl();ho();lv();gl();Er();dB();QA=function(t,r,n,o,a,d,c,u){if(RT(r)&&n===Bt.Edit)return[t.proceedItemForLowFidelityWarningEdit,t.cancelLowFidelityWarningEditItem];if(RT(r)&&n===Bt.DeleteReply)return[t.deleteItemForLowFidelityWarningDelete,t.cancelLowFidelityWarningDeleteItem];if(r===Ue.Error)return[t.retry,a?t.deleteRootItem:t.deleteItem];if(r===Ue.Resolved)return[];if(le()&&r===Ue.EditPreCommitPending)return d?[]:[t.saveItemPending,t.cancelEditItem];if(r===Ue.Editing||r===Ue.EditPreCommitPending)return d?[]:[t.saveItem,t.cancelEditItem];var l=[];return u&&l.push(t.linkToCommentMenuItem),d||o===Jn.None||(o===Jn.Any&&!rf()&&!(c&Fe.EditRestricted)&&l.push(t.editItem),!(c&Fe.DeleteRestricted)&&!a&&l.push(t.deleteItem)),l}});var ly,ype,Cpe,vpe=f(()=>{"use strict";s();k();te();rt();bd();Z();ly=I(L());Ps();Cn();ue();Cr();un();xt();lv();Rd();Be();fv();yv();$A();L_();Lo();K_();gpe();Qo();pB();_f();ype=20,Cpe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.memoGetActionBarItems=xu(QA,ype,function(){v().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875360)}),n.memoGetCardContextualMenuItems=xu(XA,ype,function(){v().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875361)}),n.getMentionableCommentEditorProps=et(function(o,a){if(o===Rt.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,getAuthToken:n.getAuthToken,correlationId:n.props.correlationId,suggestionsDetails:a}}),n.getRenderableItemActionBarItems=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!n.renderableItemActionBarItems||n.memoGetActionBarItems===void 0)throw new Ie("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601689));return n.memoGetActionBarItems.apply(n,w([n.renderableItemActionBarItems],j(o),!1))},n.getCardContextualMenuItems=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!n.cardContextMenuItems||n.memoGetCardContextualMenuItems===void 0)throw new Ie("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601690));return n.memoGetCardContextualMenuItems.apply(n,w([n.cardContextMenuItems],j(o),!1))},n.onPostDelete=function(o){Rg({trackback:C.reserveTag(593826139),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(o){Ag({trackback:C.reserveTag(593801875),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCommit=function(o,a){kg({trackback:C.reserveTag(593826141),id:o.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:o.getContentsAsync(),atMentionsEnabled:n.props.modelCapabilities.atMention===Rt.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,commitSource:a,localizationAPI:n.props.localizationAPI}).catch(pe(C.reserveTag(593826142)))},n.onPostDraftEmptinessChanged=function(o,a){Mg({trackback:C.reserveTag(592041679),contentId:o.getId(),isEmpty:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(o,a){Lg({trackback:C.reserveTag(592720402),id:o,editor:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCancel=function(o){zf({trackback:C.reserveTag(593826145),commentId:o.getId(),setContents:o.setContents.bind(o),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:!1,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onLowFidelityWarningCancel=function(){E0({selectedState:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){P0({selectedState:n.props.selectedState,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.onPostReactionUpdated=function(o,a,d){A0(C.reserveTag(587994052),o,a,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,d)},n.onPresentLinkToComment=function(o){k0(C.reserveTag(578852485),o,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(o,a){var d=n.getRenderableItemFromRef(o);if(!d){v().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",593826146);return}Dg({trackback:C.reserveTag(593826147),renderableItem:d,selectedComment:n.props.selectedState,cardCollapsedState:n.props.cardCollapsedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:a,draftState_deprecated:n.props.draftState}).catch(pe(C.reserveTag(590123736)))},n.onPostCollapse=function(o){var a=n.getRenderableItemFromRef(o);if(!a){v().assertConditionTag(!1,"Collapse from an unknown post?",589940441);return}_0(C.reserveTag(589940442),a,n.props,n.props.telemetryVisitor,n.props.componentTree)},n.onPostFocusParent=function(o){var a=n.getRenderableItemFromRef(o);if(!a){v().assertConditionTag(!1,"Focus parent from unknown post?",545867680);return}R0(a,n.props.componentTree,n.props.focusManager,n.props.draftState)},n.cardOnResolveThread=function(o){qf({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826176),id:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnReopenThread=function(o){Og({trackback:C.reserveTag(593826177),id:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnDelete=function(o){v().assertConditionTag(n.props.componentTree.componentTreeId.renderContextType!==A.HalfPane,"Discard not yet fully supported for HalfPane in DHC",593826178),Ng({trackback:C.reserveTag(592840777),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,componentTree:n.props.componentTree,invokeModalDialog:void 0,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.threadTaskState,threadIndex:0,shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnPost=function(o,a){var d=n.props.isDraftThread?{type:"CREATE"}:{type:"REPLY",parentId:o.getId()};Fg({trackback:C.reserveTag(593622431),commentCardRef:o,draftState:n.props.draftState,areMentionsEnabled:n.props.modelCapabilities.atMention===Rt.Enabled,session:d,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:a}).catch(pe(C.reserveTag(593622432)))},n.cardOnCollapseCallback=function(o){h0({trackback:C.reserveTag(562918285),commentCardRef:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(o){Gf({trackback:C.reserveTag(571281792),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.SelectCard}})},n.cardOnSelectExpandCallback=function(o,a,d){Gf({trackback:C.reserveTag(571281763),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.ExpandCard,relativeDraftingState:n.props.cardRelativeDraftingState,draftState:n.props.draftState,shouldFocusAfter:d,selectRootPost:a}})},n.cardOnFocusCallback=function(o){y0({trackback:C.reserveTag(571340120),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.Polite},focusManager:n.props.focusManager,isDraftThread:n.props.isDraftThread})},n.cardOnBeginReplyCallback=function(o){wg({trackback:C.reserveTag(593826189),threadId:o.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnHighlight=function(o,a){C0({trackback:C.reserveTag(593826190),commentCardRef:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:a})},n.cardOnDraftingInputSizeChange=function(o,a){v0({trackback:C.reserveTag(593826191),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:o.getId(),isCardLie:n.props.isDraftThread,newHeight:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(o,a){Mg({trackback:C.reserveTag(592213847),contentId:o.getId(),isEmpty:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(o){x0({trackback:C.reserveTag(592065734),id:o.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnTaskTopperCheckboxPressed=function(){if(!n.props.threadTaskState){v().assertConditionTag(!1,"props.threadTaskState is undefined",593826193);return}T0({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826194),id:n.props.threadId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.cardOnSaveDraft=function(o,a){Lg({trackback:C.reserveTag(592720403),id:o,editor:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnCancel=function(o){v().assertConditionTag(n.props.isDraftThread||n.props.cardRelativeDraftingState===cr.InCard,"Mismatch between selectedComment state and cancel reply callback.",593826196),ml({trackback:C.reserveTag(592840778),showDiscardDialog:!1,invokeModalDialog:void 0,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:!1,cardId:n.props.threadId,draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:0})},n.commentEditorOnKeyDown=function(o){n.commentEditorKeyDownHandler.onKeyDown(o)},n.onPostError=function(o){u0({trackback:C.reserveTag(593764370),id:o.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(o){l0({trackback:C.reserveTag(593764371),id:o.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardMounted=function(o){f0({cardProps:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(o){p0({cardId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(o){m0({postId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(o){g0({postId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardRendered=zn(function(o){n.props.onInitialRender({commentId:o.id,renderContextType:n.props.componentTree.componentTreeId.renderContextType})}),n.onSelectedTaskAssigneeUpdated=function(o){I0({trackback:C.reserveTag(593826204),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:o})},n.getPostOrHistoryRecordStates=En(fpe,function(){return[n.props.dataItems,n.props.threadPostStates,n.props.historyRecordViewStates]}),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.getAuthToken=n.getAuthToken.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapse,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment,onClickableTextClicked:n.props.onClickableTextClicked},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.cardOnCancel,onPost:n.cardOnPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.onCardRendered,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onTaskTopperCheckboxPressed:n.cardOnTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.contextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=ZA(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=JA(n.props.localizationAPI,n.contextualMenuCallbackProps),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown(function(){return n.props.componentTree},at()?function(){return n.props.dataItems}:void 0),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown(function(){return n.props.componentTree}),n}return t.prototype.focus=function(){this.props.focusManager.focusCommentCardCommand(this.props.componentTree,this.props.threadId),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590205772),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:this.props.threadId,selectType:Ee.ExpandCard,source:ce.Canvas},!1).catch(pe(C.reserveTag(590104656)))},t.prototype.getInstanceId=function(){return this.props.componentInstanceId},t.prototype.shouldComponentUpdate=function(r,n){return t.havePropsMeaningfullyChanged(r,this.props)},t.prototype.updateDraftRenderLockIfApplicable=function(r){var n=We(this.props.draftState);!n||n.threadId!==this.props.threadId||this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826137),telemetryVisitor:this.props.telemetryVisitor},r,n.commentDraft.sessionConfiguration.draftId)},t.prototype.componentDidMount=function(){var r,n,o,a;(n=(r=this.props).componentRef)===null||n===void 0||n.call(r,this),(a=(o=this.props).setComponentRef)===null||a===void 0||a.call(o,this.props.componentInstanceId,this),this.updateDraftRenderLockIfApplicable(!0)},t.prototype.componentWillUnmount=function(){var r,n;(n=(r=this.props).setComponentRef)===null||n===void 0||n.call(r,this.props.componentInstanceId,null)},t.prototype.componentDidUpdate=function(r,n){if(this.props.draftState!==r.draftState){var o=We(r.draftState),a=We(this.props.draftState);a&&a.renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(o===void 0||o.renderContextType!==a.renderContextType)&&this.updateDraftRenderLockIfApplicable(!0)}this.props.focusManager.discreteCommentCardPropsUpdated(this.props.componentTree,r,this.props)},t.havePropsMeaningfullyChanged=function(r,n){var o=Object.keys(r),a=Object.keys(n);return o.length!==a.length?!0:o.some(function(d){if(n[d]===r[d])return!1;if(d==="dataItems"){if(n.dataItems.length!==r.dataItems.length)return!0;for(var c=0;c<n.dataItems.length;c++){var u=n.dataItems[c],l=r.dataItems[c];if(Pr(u)&&Pr(l)&&u.commentModel!==l.commentModel||!!u.historyItem!=!!l.historyItem)return!0}return!1}return typeof n[d]=="object"?!mpe(n[d],r[d]):!0})},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(Td.Loki)},t.prototype.getRenderableItemFromRef=function(r){var n=r.getId();return this.props.dataItems.find(function(o){return yo(o)===n})},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:zi.ExpandedCardOrFirstCardTabbable,postTabbingMode:Gi.ExpandedCardRootPostTabbable}},t.prototype.onMentionCreated=function(r){b0({failTag:C.reserveTag(593826199),successTag:C.reserveTag(593826200),person:r,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826201)})},t.prototype.onMentioneesStillInDraftUpdated=function(r){S0({trackback:C.reserveTag(593826203),emailsStillInDraft:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.renderThread=function(r){return r},t.prototype.onQueueLoadThread=function(){this.props.modelCapabilities.virtualized&&!this.props.isDraftThread&&this.props.queueLoadThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(573145492)})},t.prototype.render=function(){var r,n;this.onQueueLoadThread();var o=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),a=this.props.cardRelativeDraftingState!==void 0,d=a||this.props.readOnly?Jn.None:Jn.Any,c=this.props.dataItems.length>1,u=YA({thread:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardState,postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:o,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:this.props.selectedState,isolationEdit:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,isAtMentionEnabled:this.props.modelCapabilities.atMention===Rt.Enabled,isTaskCreationEnabled:Zm(this.props.modelCapabilities),isDraftThread:this.props.isDraftThread,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:this.props.cardCollapsedState,cardRelativeDraftingState:this.props.cardRelativeDraftingState,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilityLevel:this.props.accessibilityLevel,maximumDimensions:this.props.maximumDimensions,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:o,restrictActionControls_deprecated:a,allowedDraftingSession:d,availableScreenHeight:void 0,contentBackgroundColor:c?"CardReplyBackground":"CardBackground",extraPaddingLeft:void 0,extraPaddingRight:void 0,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:this.props.isHighlighted,maxDraftHeight:void 0,taskState:this.props.threadTaskState,cardStyle:void 0,onCardLayout:void 0,isCardTabbable:KA(this.getKeyboardingOptions().cardTabbingMode,this.props.threadId,!1,this.props.cardCollapsedState,this.props.selectedState),postOrHistoryRecordStates:this.getPostOrHistoryRecordStates(),richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:(n=(r=this.props)===null||r===void 0?void 0:r.accessibilityMetadata)===null||n===void 0?void 0:n.tabFocusTrapBehavior});return ly.createElement(Fh.Provider,{value:this.props.lppManager},ly.createElement(nn.Provider,{value:this.props.componentTree.componentTreeId},ly.createElement(mx.Provider,{value:this.props.commentAPI},this.renderThread(u))))},t}(ly.Component)});var xpe,Tpe=f(()=>{"use strict";s();ze();xpe=function(t){return Ce({width:t==null?void 0:t.width})}});var bpe,G1e,Spe,Ipe=f(()=>{"use strict";s();k();rt();Lt();bpe=I(L());vpe();Tpe();Qa();zs();Ti();Ir();G1e=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.setViewTreeRoot=function(o){if(n.props.componentTree.setViewTreeRootHelper(o,n.props.resource.id),o){var a=o.getInnerRef();a.current&&n.props.focusManager.discreteCommentCardRootRefMounted(a)}},n.onRootViewKeyDown=function(o){Y()==="win32"&&(n.props.componentTree.onKeyDownTabHandlerHelper(n.props.resource.id,o).wasHandled||n.commentContentsKeyDownHandler.onKeyDown(o))},n.getContentsPreventDefaultKeyDownBehavior=En(pm,function(){return[n.commentContentsKeyDownHandler.getKeyDownEvents(),!0]}),n.getRootViewKeyDownEvents=et(function(){return mm({useJSTabLoop:!0,handleKeysDuringBubbling:!0})}),n.getMemoizedDiscreteCommentCardStyle=En(xpe,function(){return[n.props.maximumDimensions]}),n.componentTree=n.props.componentTree,n}return t.prototype.componentDidUpdate=function(r,n){this.props.resource.id!==r.resource.id&&this.props.componentTree.updateIdForViewTree(r.resource.id,this.props.resource.id),e.prototype.componentDidUpdate.call(this,r,n)},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!0},t.prototype.renderThread=function(r){return bpe.createElement(Yr,{nodeId:$a({componentType:Q.DiscreteHostedCommentRoot,id:this.props.resource.id,renderContextType:this.props.componentTree.componentTreeId.renderContextType}),style:this.getMemoizedDiscreteCommentCardStyle(),ref:this.setViewTreeRoot,onKeyDown:this.onRootViewKeyDown,keyDownEvents:this.getRootViewKeyDownEvents()},r)},t}(Cpe),Spe=G1e});var q1e,ek,mB=f(()=>{"use strict";s();bs();Et();g1();Ipe();Ff();JC();q1e=function(){var t,r=s0(),n=a0(),o=d0(function(y){return Co(y,!0)},function(y){return GC(y,!0)},r,n),a=OG(o),d=FG(),c=wG(),u=DG(),l=i0(),p=HG(),g=BG(o,p),h=NG(p),x=function(T,b){if(b.isVirtualized&&t)return t;var S=o(T,b),E=p(T,b),P=S.thread[0].commentId;return t={threadId:P,dataItems:g(T,b),threadTaskState:E&&E.currentState,threadPostStates:a(T,b),historyRecordViewStates:h(T,b),selectedState:d(T,b),cardCollapsedState:ua(P,da(T),b.componentTree.componentTreeId.renderContextType),readOnly:tE(T),cardState:u(T,b),isHighlighted:c(T,b),personaIconPropertiesMap:tg(T),isDraftThread:S.isDraftThread,draftState:fe(T),cardRelativeDraftingState:l(T,b),modelCapabilities:Br(T),suggestionsDetails:iE(T)},t};return x},ek=na(q1e,xE)(Spe)});function fy(e,t){var r=We(e);return r!==void 0&&r.renderContextType!==t&&r.commentDraft.sessionConfiguration.sessionType===fo}var gB=f(()=>{"use strict";s();xd();xt()});function tk(e){if(!(!e.topVisibleThread||e.componentTree.componentTreeId.renderContextType===A.HalfPane||e.selectedComment))return e.topVisibleThread.cardId}var py,Epe,K1e,Gp,hB=f(()=>{"use strict";s();k();te();rt();Z();UF();Md();py=I(L());Ps();_m();VF();pd();Pc();rC();Cn();ue();jF();Cr();un();NC();xt();$C();Rn();bC();mB();lv();Hf();Vu();Be();Ff();ZE();yv();C1();gB();$A();Er();mv();Lo();K_();Ir();Qo();pB();Epe=20,K1e=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;n.memoGetActionBarItems=xu(QA,Epe,function(){v().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875362)}),n.memoGetCardContextualMenuItems=xu(XA,Epe,function(){v().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875363)}),n.initialAtMentionCapability=new $T,n.onCommentInterruptableCommand=function(a){switch(a.type){case"DiscardDraft":{var d=void 0;if(a.mode===Uf.Dialog){var c=pv(n.props.draftState,n.props.componentTree.componentTreeId.renderContextType);d=n.getOnWillDiscardCallback(c);var u=Us(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);return n.props.discardDraftAsync({renderContextType:n.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:n.props.telemetryVisitor,trackback:C.reserveTag(587605836)},ce.Canvas,u,d)}return Promise.resolve(He.Unhandled)}case"BringThreadIntoView":return n.props.componentTree.componentTreeId.renderContextType!==A.FullPane?Promise.resolve(He.Unhandled):n.scrollToThreadById(a.threadId)?Promise.resolve(He.Handled):Promise.resolve(He.Failed);default:return v().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",593826210),Promise.resolve(He.Unhandled)}},n.onCardPost=function(a,d){var c=a.getId(),u=t.getPaneSingleCreateDraftId(n.props)===a.getId()?{type:"CREATE"}:{type:"REPLY",parentId:c};Fg({trackback:C.reserveTag(593622435),commentCardRef:a,draftState:n.props.draftState,areMentionsEnabled:n.props.modelCapabilities.atMention===Rt.Enabled,session:u,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:d}).catch(pe(C.reserveTag(593622464)))},n.cardOnCollapseCallback=function(a){h0({trackback:C.reserveTag(562918286),commentCardRef:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(a){Gf({trackback:C.reserveTag(571281794),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.SelectCard}})},n.cardOnSelectExpandCallback=function(a,d,c){var u=Wf(a.getId(),n.props.componentTree.componentTreeId.renderContextType,n.props.draftState);Gf({trackback:C.reserveTag(571281793),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.ExpandCard,relativeDraftingState:u,draftState:n.props.draftState,shouldFocusAfter:c,selectRootPost:d}})},n.cardOnFocusCallback=function(a){y0({trackback:C.reserveTag(571340119),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ee.Polite},focusManager:n.props.focusManager,isDraftThread:t.getPaneSingleCreateDraftId(n.props)===a.getId()})},n.cardOnBeginReplyCallback=function(a){wg({trackback:C.reserveTag(593826249),threadId:a.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnResolveThread=function(a){qf({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826250),id:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.tasks[a]})},n.cardOnReopenThread=function(a){Og({trackback:C.reserveTag(593826251),id:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.tasks[a]})},n.cardOnDelete=function(a){Ng({trackback:C.reserveTag(593826252),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,componentTree:n.props.componentTree,invokeModalDialog:n.invokeModalDialog,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.tasks[a],threadIndex:Rf(n.state.allRenderableItemThreads,a),shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnDraftingInputSizeChange=function(a,d){var c=t.getPaneSingleCreateDraftId(n.props);v0({trackback:C.reserveTag(593826253),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:a.getId(),isCardLie:a.getId()===c,newHeight:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedComment,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(a,d){Mg({trackback:C.reserveTag(592213848),contentId:a.getId(),isEmpty:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(a){x0({trackback:C.reserveTag(592065735),id:a.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSaveDraft=function(a,d){Lg({trackback:C.reserveTag(593826255),id:a,editor:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardCancel=function(a){var d=Us(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);ml({trackback:C.reserveTag(592840780),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:d,cardId:a.getId(),draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:Rf(n.state.allRenderableItemThreads,a.getId())})},n.onTaskTopperCheckboxPressed=function(a){var d=n.props.tasks[a];d&&T0({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826258),id:d.commentId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.cardOnHighlight=function(a,d){C0({trackback:C.reserveTag(593826259),commentCardRef:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:d})},n.onPostDelete=function(a){Rg({trackback:C.reserveTag(593826312),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(a){Ag({trackback:C.reserveTag(593826316),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostReactionUpdated=function(a,d,c){A0(C.reserveTag(587994051),a,d,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,c)},n.onPostCommit=function(a,d){kg({trackback:C.reserveTag(593826260),id:a.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:a.getContentsAsync(),atMentionsEnabled:n.props.modelCapabilities.atMention===Rt.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:d}).catch(pe(C.reserveTag(593826261)))},n.onPostCancel=function(a){var d=Us(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);zf({trackback:C.reserveTag(593826263),commentId:a.getId(),setContents:a.setContents.bind(a),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostDraftEmptinessChanged=function(a,d){Mg({trackback:C.reserveTag(592041678),contentId:a.getId(),isEmpty:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(a,d){Lg({trackback:C.reserveTag(592720405),id:a,editor:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPresentLinkToComment=function(a){k0(C.reserveTag(578852484),a,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(a,d){var c=n.getRenderableItemFromRef(a);if(!c){v().assertConditionTag(!1,"Selection coming from an unknown post?",593826265);return}Dg({trackback:C.reserveTag(593826266),renderableItem:c,selectedComment:n.props.selectedComment,cardCollapsedState:ua(Fo(c),n.props.expandedComments,n.props.componentTree.componentTreeId.renderContextType),dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:d,draftState_deprecated:n.props.draftState}).catch(pe(C.reserveTag(590123737)))},n.onPostCollapseParent=function(a){var d=n.getRenderableItemFromRef(a);if(!d){v().assertConditionTag(!1,"Collapse from an unknown post?",589940444);return}_0(C.reserveTag(589940445),d,n.props,n.props.telemetryVisitor,n.props.componentTree)},n.onPostFocusParent=function(a){var d=n.getRenderableItemFromRef(a);if(!d){v().assertConditionTag(!1,"Focus parent from unknown post?",545867681);return}R0(d,n.props.componentTree,n.props.focusManager,n.props.draftState)},n.getContentFilterProps=function(){var a;return{currentFilter:(a=n.props.currentFilter)!==null&&a!==void 0?a:wn,createOrUpdateFilter:n.props.createOrUpdateFilter,preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior(),personaIconPropertiesMap:n.props.personaIconPropertiesMap,localizationAPI:n.props.localizationAPI,filterItemCount:yd()?n.props.filterItemCount:void 0,collaborators:n.props.collaborators}},n.getThreadedRenderableIds=En(function(a){return a.map(function(d){return d.map(yo)})},function(){return[n.state.allRenderableItemThreads]}),n.getThreadPostOrHistoryRecordStates=function(){var a=ZT();return function(){return a(n.getThreadedRenderableIds(),m(m({},n.props.postViewStates),n.props.historyRecordViewStates))}}(),n.getListItemKey=function(a){var d=wo(a).commentId,c=n.props.cardViewStates[d];return c&&c.alternateId||d},n.getHostableComponentInstanceId=function(a,d,c){return"cardInPane_".concat(If({id:a,renderContextType:d},c))},n.onSelectedTaskAssigneeUpdated=function(a){I0({trackback:C.reserveTag(593826304),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:a})},n.getRenderableItemActionBarItems=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];if(!n.renderableItemActionBarItems||n.memoGetActionBarItems===void 0)throw new Ie("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601691));return n.memoGetActionBarItems.apply(n,w([n.renderableItemActionBarItems],j(a),!1))},n.getCardContextualMenuItems=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];if(!n.cardContextMenuItems||n.memoGetCardContextualMenuItems===void 0)throw new Ie("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601692));return n.memoGetCardContextualMenuItems.apply(n,w([n.cardContextMenuItems],j(a),!1))},n.onCardMounted=function(a){f0({cardProps:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(a){p0({cardId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(a){m0({postId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(a){g0({postId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.notifyRenderedOnce=zn(function(){n.props.onInitialRender({renderContextType:n.props.componentTree.componentTreeId.renderContextType})}),n.onPostError=function(a){u0({trackback:C.reserveTag(593764372),id:a.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(a){l0({trackback:C.reserveTag(593764373),id:a.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningCancel=function(){E0({selectedState:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){P0({selectedState:n.props.selectedComment,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.commentEditorOnKeyDown=function(a){n.commentEditorKeyDownHandler.onKeyDown(a)},n.startNewCommentSession=function(){n.props.discardDraftAndStartNewCommentSession({renderContextType:n.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826323),telemetryVisitor:n.props.telemetryVisitor})},n.closePane=n.closePane.bind(n),n.onCommentUIAction=n.onCommentUIAction.bind(n),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.renderCommentThread=n.renderCommentThread.bind(n),n.onGhostCommentClicked=n.onGhostCommentClicked.bind(n),n.invokeModalDialog=n.invokeModalDialog.bind(n),n.deleteThreadConfirmCallback=n.deleteThreadConfirmCallback.bind(n),n.getOnWillDiscardCallback=n.getOnWillDiscardCallback.bind(n),n.isReadyToRender=n.isReadyToRender.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapseParent,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment,onClickableTextClicked:n.props.onClickableTextClicked},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.onCardCancel,onPost:n.onCardPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.notifyRenderedOnce,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onTaskTopperCheckboxPressed:n.onTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.cardContextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=ZA(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=JA(n.props.localizationAPI,n.cardContextualMenuCallbackProps),n.paneContainerKeyDownHandler=n.props.focusManager.paneContainerKeyDown(function(){return n.props.componentTree}),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown(function(){return n.props.componentTree},function(){return n.props.dataItems}),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown(function(){return n.props.componentTree});var o=v().createActivityObject("BaseCommentPaneConstruction",n.props.telemetryVisitor,be());return o.addDataField("PaneCorrelationId",n.props.correlationId,N.SystemMetadata),Wn||o.addDataField("SharedCommentsVersion",EE,N.SystemMetadata),o.addDataField("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,N.SystemMetadata),o.successTag(593826206),n}return t.prototype.onCommentUIAction=function(r){return r.actionType===Yt.BackKeyPressed?(v().assertConditionTag(Ha(r.actionBehavior),"This action type does not support toggled/enabled status",593826207),Ha(r.actionBehavior)&&this.onBackKeyPressed(),dr.Success):dr.NotHandled},t.prototype.getOnWillDiscardCallback=function(r){var n=this;return kd(this.props.draftState)===Lr.CannotAutoDiscard?function(o,a){return n.invokeModalDialog(r,o,a)}:void 0},t.prototype.updateDraftRenderLocks=function(r){zu(this.props.draftState)!==0&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826211),telemetryVisitor:this.props.telemetryVisitor},r)},t.prototype.componentDidMount=function(){var r,n;(n=(r=this.props).componentRef)===null||n===void 0||n.call(r,this),this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommand),this.props.modelCapabilities.atMention!==Rt.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0),Oi()&&this.props.lastContextChangeIncrement>0&&this.onContextChanged()},t.prototype.componentWillUnmount=function(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommand)},t.prototype.componentDidUpdate=function(r,n){var o,a;if(this.props.lastContextChangeIncrement!==r.lastContextChangeIncrement&&this.onContextChanged(),this.props.modelCapabilities.atMention!==r.modelCapabilities.atMention&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(r),this.props.draftState!==r.draftState)try{for(var d=qe(wC(this.props.draftState)),c=d.next();!c.done;c=d.next()){var u=c.value;if(this.props.draftState.drafts[u].renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(r.draftState.drafts[u]===void 0||r.draftState.drafts[u].renderContextType!==this.props.draftState.drafts[u].renderContextType)){this.updateDraftRenderLocks(!0);break}}}catch(l){o={error:l}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}this.props.focusManager.commentPanePropsUpdated(this.props.componentTree,r,this.props)},t.prototype.focus=function(){this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.getInstanceId=function(){var r;return(r=this.props.componentInstanceId)!==null&&r!==void 0?r:"CommentPane"},t.prototype.getRenderableItemFromRef=function(r){var n=r.getId();return ir()?this.props.dataItems.find(function(o){return yo(o)===n}):n===t.getPaneSingleCreateDraftId(this.props)?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment_deprecated}:this.props.dataItems.find(function(o){return yo(o)===n})},t.prototype.closePane=function(){hv({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.renderCommentThread=function(r,n,o){var a,d;o===void 0&&(o=YA);var c=wo(n),u=c.commentId===t.getPaneSingleCreateDraftId(this.props);if(N5())return py.createElement(ek,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:c.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:r+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,onInitialRender:this.props.onInitialRender,correlationId:this.props.correlationId,lppManager:this.props.lppManager,componentInstanceId:this.getHostableComponentInstanceId(c.commentId,this.props.componentTree.componentTreeId.renderContextType,u)});var l=nt()?this.state.allRenderableItemThreads.length>0&&wo(this.state.allRenderableItemThreads[0]).commentId===c.commentId:this.props.dataItems.length===0||wo(this.props.dataItems).commentId===c.commentId,p=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),g=c.commentId,h=lr(this.props.draftState),x=h||this.props.readOnly?Jn.None:Jn.Any,y=(a=this.props.tasks[g])===null||a===void 0?void 0:a.currentState,T=this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!!ws(this.props.draftState),b=this.props.highlightedCommentId||tk(this.props),S=this.getPinnedCardIndex_deprecated(),E=this.getThreadPostOrHistoryRecordStates()[S&&!hd()?S:r],P=((d=this.props.selectedComment)===null||d===void 0?void 0:d.selectedCardId)===g?this.props.selectedComment:void 0,_=ua(c.commentId,this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType);return o({thread:n,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardViewStates[g],postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:p,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:P,isolationEdit:T,isAtMentionEnabled:!!p,isTaskCreationEnabled:Zm(this.props.modelCapabilities),isDraftThread:u,foldableLayoutState:this.props.foldableLayoutState,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:_,cardRelativeDraftingState:Wf(c.commentId,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState),accessibilityPositionInSet:r+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,maximumDimensions:void 0,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:p,availableScreenHeight:this.getAvailableScreenHeight(),extraPaddingLeft:this.getContentExtraPaddingLeft(),extraPaddingRight:this.getContentExtraPaddingRight(),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:b===g,contentBackgroundColor:this.getContentBackgroundColor(n.length>1,T),maxDraftHeight:this.getMaxDraftHeight(),restrictActionControls_deprecated:h,allowedDraftingSession:x,taskState:y,cardStyle:this.getCommentCardStyle(),onCardLayout:this.onCardLayout,isCardTabbable:KA(this.getKeyboardingOptions().cardTabbingMode,g,l,_,Db()?this.props.renderableSelectedComment:this.props.selectedComment),postOrHistoryRecordStates:E,richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:lg.Unspecified})},t.prototype.onMentionCreated=function(r){b0({failTag:C.reserveTag(593826271),successTag:C.reserveTag(593826272),person:r,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826273)})},t.prototype.onMentioneesStillInDraftUpdated=function(r){S0({trackback:C.reserveTag(593826275),emailsStillInDraft:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.onBackKeyPressed=function(){if(Yo(this.props.draftState)){var r=pv(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),n=Us(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession),o=qa(this.props.draftState),a=ws(this.props.draftState);if(o){var d=kd(this.props.draftState),c=d===Lr.CannotAutoDiscard;ml({trackback:C.reserveTag(592840781),showDiscardDialog:c,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:n,cardId:o,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:Rf(this.state.allRenderableItemThreads,o)})}else a&&zf({trackback:C.reserveTag(592487364),commentId:a,setContents:void 0,data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:n,onWillDiscardCallback:this.getOnWillDiscardCallback(r),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})}else this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&hv({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.sendReadyToRenderNotification=function(r){this.props.initializationStatus===Xn.Initialized&&(this.props.componentTree.componentTreeId.renderContextType===r.componentTree.componentTreeId.renderContextType&&this.props.initializationStatus===r.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826313)}))},t.prototype.deleteThreadConfirmCallback=function(){return this.props.selectedComment?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826314)},this.props.selectedComment.selectedCardId),He.Handled):(v().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",593826315),He.Unhandled)},t.prototype.processAtMentionCapabilityState=function(){var r=this.props.modelCapabilities.atMention;r!==Rt.Unknown&&this.initialAtMentionCapability.set(r)},t.getPaneSingleCreateDraftId=function(r){return Je(r.draftState,!0,r.componentTree.componentTreeId.renderContextType)},t.prototype.getUpdatedItemThreads=function(r){if(!this.isReadyToRenderWithProps(r))return[];var n=!!this.props.currentFilter||fy(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),o=!!r.currentFilter||fy(r.draftState,r.componentTree.componentTreeId.renderContextType);return this.props.dataItems!==r.dataItems||this.props.cardViewStates!==r.cardViewStates||this.props.componentTree.componentTreeId.renderContextType!==r.componentTree.componentTreeId.renderContextType||this.props.personaIconPropertiesMap!==r.personaIconPropertiesMap||!ir()&&(this.props.createdCommentLie!==r.createdCommentLie||n!==o)?WC(r.dataItems,r.cardViewStates,r.createdCommentLie,r.componentTree.componentTreeId.renderContextType!==A.HalfPane,o):this.state.allRenderableItemThreads},t.prototype.getInitialState=function(r){var n=!!r.currentFilter||fy(r.draftState,r.componentTree.componentTreeId.renderContextType);return{allRenderableItemThreads:this.isReadyToRenderWithProps(r)?WC(r.dataItems,r.cardViewStates,r.createdCommentLie,r.componentTree.componentTreeId.renderContextType!==A.HalfPane,n):[],atMentionState:void 0}},t.prototype.onRequestLoadThreads=function(r){this.props.modelCapabilities.virtualized?this.props.queueLoadThreads({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826320)},r):v().assertConditionTag(!1,"onRequestLoadThreads called for non-virtualized store",593826321)},t.prototype.shouldShowGhostComment=function(){return this.props.componentTree.componentTreeId.renderContextType===A.FullPane&&this.props.nextPopulatedContextDetails!==jt.Unknown&&this.props.nextPopulatedContextDetails!==jt.NoComments&&this.props.nextPopulatedContextDetails!==jt.OnlyCommentsInCurrent},t.prototype.onGhostCommentClicked=function(){var r=this,n=L5(),o=n&&!nt()||!n&&Y()!=="web";this.props.discardDraftIfEmpty({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(590955266)},ce.SharedComments,o?go.GhostCard:void 0).then(function(a){(!o||a.draftDiscardBehavior===Lr.NoDraft||a.draftDiscardResult===He.Handled)&&r.props.selectionManager.selectAcrossContexts(Qt.Next,r.props.componentTree.componentTreeId.renderContextType)}).catch(pe(C.reserveTag(590955267)))},t.prototype.isReadyToRender=function(){return this.isReadyToRenderWithProps(this.props)},t.prototype.isReadyToRenderWithProps=function(r){return Gu(r.pendingCommentLoad,r.modelCapabilities.virtualized,r.DoNotUse_isFilteringEnabled)},t.prototype.canCardDelete=function(r){return!0},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.render=function(){return py.createElement(Fh.Provider,{value:this.props.lppManager},py.createElement(nn.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner()))},t}(py.Component),Gp=K1e});var Ppe,yB,CB,Y1e,AT,rk,$1e,_pe,Rpe,Ape,kpe,Dpe,wpe,Fpe,vB,xB,Ope,my,Q1e,Npe,Mpe,Lpe,Hpe,Bpe,Upe,Vpe,gy=f(()=>{"use strict";s();k();Ppe=I(ee());Ld();Be();_r();ze();yB=16,CB=16,Y1e=12,AT=12,rk=Ppe.StyleSheet.hairlineWidth,$1e=function(t){return{shadowColor:t.palette.CardShadowColor,shadowOffset:{height:1,width:0},shadowRadius:2,shadowOpacity:.1}},_pe=new R([R.always({minWidth:64}),R.rule({displayClass:Xt.LargeDisplay},{width:100})]),Rpe=new kt([kt.always({minWidth:96,textAlign:"center"}),kt.rule({displayClass:Xt.LargeDisplay},{width:120})]),Ape=new R([R.always(function(e){return{flex:1,flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch",backgroundColor:e.palette.PaneBackground}}),R.rule({renderContextType:A.HalfPane},function(e){return{backgroundColor:e.palette.PaneBackground_HalfPane}})]),kpe=new R([R.always({position:"absolute",bottom:0,left:0,right:0}),R.rule({platform:"android"},{zIndex:100})]),Dpe=Ce({marginBottom:AT}),wpe=new R([R.always(function(e){return m({marginBottom:AT},$1e(e))}),R.rule({platform:"android"},function(e){return{marginLeft:yB,marginRight:CB,elevation:2,backgroundColor:e.palette.CardBackground}})]),Fpe=new R([R.always(function(e){return{flex:1,flexDirection:"column",borderRightWidth:rk,borderRightColor:e.palette.CardAccent,borderLeftWidth:rk,borderLeftColor:e.palette.CardAccent}})]),vB=new R([R.always(function(e){return{flex:1,alignSelf:"stretch",borderRightWidth:rk,borderRightColor:e.palette.CardAccent,borderLeftWidth:rk,borderLeftColor:e.palette.CardAccent}})]),xB=Ce({flexDirection:"row",alignItems:"center"}),Ope=Ce({flex:1,justifyContent:"center"}),my=24,Q1e=67,Npe=new R([R.always({minHeight:my,minWidth:Q1e,marginBottom:12,alignSelf:"flex-end"})]),Mpe=new R([R.rule({platform:"win32"},{marginRight:28})]),Lpe=new R([R.rule({platform:"win32"},{paddingRight:Y1e})]),Hpe=Ce({borderWidth:0}),Bpe=new R([R.rule({platform:"win32"},{borderColor:"transparent",borderWidth:2})]),Upe=new R([R.rule({platform:"win32"},function(e){return{borderColor:e.palette.FocusBorderColor}})]),Vpe=function(t){return new R([R.always({flexDirection:"row"}),R.rule(function(){return t},{justifyContent:"space-between"})])}});var jpe=f(()=>{"use strict";s();UH()});function zpe(e,t,r,n,o,a){if(e&&e.selectedCardId===a.threadId&&e.selectionDetails.lowFidelityWarningType){var d=e.selectionDetails.lowFidelityWarningType,c=GA(d,o,a.renderContextType,n),u=2;return(a.renderContextType===A.HalfPane&&pK()||a.renderContextType!==A.HalfPane&&r)&&(u=1),m(m(m({},a),c),{renderMode:u,hasLowFidelityContent:!0})}return m(m({},a),{renderMode:0,hasLowFidelityContent:jC(t,void 0)})}function X1e(e,t,r,n){t(e,r,n)}function J1e(e,t){return function(){return e(t)}}function Gpe(e){lD(J1e,e.onWillUnmount,e.threadId);var t=hy.useCallback(function(n){return X1e(n,e.onLayout,e.index,e.threadId)},[e.onLayout,e.index,e.threadId]),r=function(o){if(le())return e.children;var a;return e.renderContextType===A.HalfPane?a=[Wpe(Fpe,e.renderContextType,o),{width:e.halfPaneWidth}]:a=[Wpe(wpe,e.renderContextType,o)],hy.createElement(J,{style:a,onLayout:t},hy.createElement(_T,m({},Z1e(e),{preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior})))};return hy.createElement(Sl.Provider,{value:e.index},Ye(r,Ze))}function Wpe(e,t,r){return ot(e,r,t)}function Z1e(e){return e.renderMode===0?{children:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}:{renderContextType:e.renderContextType,cancelLabel:e.cancelLabel,confirmLabel:e.confirmLabel,warningLabel:e.warningLabel,onCancel:e.onCancel,onConfirm:e.onConfirm,children:e.renderMode===2?void 0:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}}var hy,qpe=f(()=>{"use strict";s();k();Cb();hy=I(L());ue();Be();gy();Yc();Vr();Qo();fn();ze();xr();aB();sB();bl()});function bB(){return nk.useContext(kT)}var nk,kT,ok=f(()=>{"use strict";s();nk=I(L()),kT=nk.createContext(void 0)});function Kpe(e){var t=e.currentFilter,r=e.createOrUpdateFilter,n=ar(),o=bB();v().assertConditionTag(!!o,"FilterCapabilities should be defined in order for ContentFilter to render. Falling back to default.",527443842);var a=ki.useMemo(function(){return o??{supportedContentTypes:wt.CommentThread}},[o]),d=ki.useCallback(function(){return a.supportsMentionToMeFilter?t.mentionsToCurrentUser:void 0},[t,a]),c=ki.useCallback(function(){var D,O;return(O=(D=t.CommentThread)===null||D===void 0?void 0:D.resolutionStatus)!==null&&O!==void 0?O:Qe.All},[t]),u=ki.useCallback(function(){var D;return a.contentOrderSupport?(D=t.contentOrder)!==null&&D!==void 0?D:Ed.HostDefaultOrder:void 0},[t,a]),l=ki.useCallback(function(){var D;return t.mentionsToCurrentUser===wn.mentionsToCurrentUser&&((D=t.CommentThread)===null||D===void 0?void 0:D.resolutionStatus)===wn.CommentThread.resolutionStatus},[t]),p=j(ki.useState(d()),2),g=p[0],h=p[1],x=j(ki.useState(c()),2),y=x[0],T=x[1],b=j(ki.useState(n?QC(t,a):l()),2),S=b[0],E=b[1],P=function(){S||(h(wn.mentionsToCurrentUser),T(wn.CommentThread.resolutionStatus))},_=function(){var O;if(S)return 0;var H=0;return t.mentionsToCurrentUser!==wn.mentionsToCurrentUser&&H++,((O=t.CommentThread)===null||O===void 0?void 0:O.resolutionStatus)!==void 0&&t.CommentThread.resolutionStatus!==wn.CommentThread.resolutionStatus&&H++,H};return ki.useEffect(function(){wa()||(h(d()),T(c()),E(n?QC(t,a):l()))},[l,d,u,c,t,a,n]),ki.useEffect(function(){wa()||r({mentionsToCurrentUser:!!g,CommentThread:{resolutionStatus:y}})},[g,r,y]),{filterCapabilities:a,atMentionToMe:g,setAtMentionToMe:h,resolutionStatus:y,setResolutionStatus:T,areAllFiltersReset:S,resetAll:P,getNumberOfFiltersApplied:_}}function Ype(e){var t,r,n=e.currentFilter,o=e.createOrUpdateFilter,a=e.collaborators,d=bB();v().assertConditionTag(!!d,"FilterCapabilities should be defined in order for ContentFilter to render. Falling back to default.",507258371);var c=ki.useMemo(function(){return d??{supportedContentTypes:wt.CommentThread}},[d]),u=c.supportsMentionToMeFilter?n.mentionsToCurrentUser:void 0,l=(r=(t=n.CommentThread)===null||t===void 0?void 0:t.resolutionStatus)!==null&&r!==void 0?r:Qe.All,p=QC(n,c),g=function(P){o(m(m({},n),{CommentThread:{resolutionStatus:P}}))},h=function(P){o(m(m({},n),{mentionsToCurrentUser:P}))},x=function(){o(m(m({},n),{userFilter:[]}))},y=function(P){n.userFilter!==void 0&&!n.userFilter.includes(P)&&o(m(m({},n),{userFilter:w(w([],j(n.userFilter),!1),[P],!1)}))},T=function(P){if(n.userFilter!==void 0&&n.userFilter.includes(P)){var _=n.userFilter.filter(function(D){return D.UserId!==P.UserId});o(m(m({},n),{userFilter:_}))}},b=function(){o({mentionsToCurrentUser:wn.mentionsToCurrentUser,CommentThread:{resolutionStatus:wn.CommentThread.resolutionStatus},userFilter:c.supportsFilterByUser?[]:void 0})},S=function(){var P;if(p)return 0;var _=0;return n.mentionsToCurrentUser!==wn.mentionsToCurrentUser&&_++,((P=n.CommentThread)===null||P===void 0?void 0:P.resolutionStatus)!==void 0&&n.CommentThread.resolutionStatus!==wn.CommentThread.resolutionStatus&&_++,a!==void 0&&n.userFilter!==void 0&&n.userFilter.length&&_++,_};return{filterCapabilities:c,atMentionToMe:u,setAtMentionToMe:h,resolutionStatus:l,setResolutionStatus:g,resetCollaboratorFilter:x,collaboratorFilter:n.userFilter,addCollaboratorToFilter:y,removeCollaboratorFromFilter:T,areAllFiltersReset:p,resetAll:b,getNumberOfFiltersApplied:S}}var ki,$pe=f(()=>{"use strict";s();k();_d();Z();Do();ki=I(L());ue();Fd();$C();ok()});var Qpe,FCr,Xpe,Jpe=f(()=>{"use strict";s();gy();_r();Qpe=new R([R.always({minHeight:my,minWidth:my,marginBottom:12,alignSelf:"flex-start",marginLeft:0,marginRight:2})]),FCr=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground,borderWidth:1,borderColor:e.palette.CardAccent,borderRadius:2}})]),Xpe={height:24,justifyContent:"center"}});function Zpe(){var e=v().createActivityObject("ContentFilterMenuDisplayed",Ct(ft.ReviewedAsNotNecessary),be());e.addDataField("ContentFilterMenuDisplayed",!0,N.SystemMetadata),e.successTag(C.reserveTag(508061576))}function qp(e,t){var r=v().createActivityObject("ContentFilterChanged",Ct(ft.Todo,8268978),be());e!==void 0&&r.addDataField("ResolutionState",e,N.SystemMetadata),t!==void 0&&r.addDataField("AtMentionsMe",t,N.SystemMetadata),r.successTag(C.reserveTag(508151255))}var eme=f(()=>{"use strict";s();te();Z()});var bt,tme,eOe,rme,tOe,SB,rOe,IB,nme=f(()=>{"use strict";s();_d();te();__();Cm();bt=I(L());ue();Fd();Qa();Ti();mi();Er();Lo();rc();ze();xr();Ph();pr();$pe();Jpe();eme();tme=Th.customize({paddingVertical:8}),eOe=P_.customize({fontSize:12,fontWeight:"semiBold",gap:5}),rme=S_.customize({paddingVertical:8}),tOe=2,SB=tOe+_F.length,rOe=function(t){switch(t){case Qe.ActiveOnly:return xW();case Qe.ResolvedOnly:return TW();case Qe.All:throw new Error("Unexpected: No corresponding UI component for CommentResolutionStatus.All");default:Ne(t)}},IB=bt.memo(function(e){var t=e.filterItemCount,r=e.localizationAPI,n=e.preventDefaultKeyDownBehavior,o=Kpe(e),a=o.atMentionToMe,d=o.setAtMentionToMe,c=o.resolutionStatus,u=o.setResolutionStatus,l=o.areAllFiltersReset,p=o.resetAll,g=o.getNumberOfFiltersApplied,h=Ype(e),x=h.atMentionToMe,y=h.setAtMentionToMe,T=h.resolutionStatus,b=h.setResolutionStatus,S=h.areAllFiltersReset,E=h.resetAll,P=h.getNumberOfFiltersApplied,_=wa()?x:a,D=wa()?y:d,O=wa()?T:c,H=wa()?b:u,V=wa()?S:l,M=wa()?E:p,G=wa()?P:g,K=Jg(),z=zd(),$=bt.useRef(!1);bt.useEffect(function(){if(yd()&&$.current){var yt=HI(r,t);yt&&(si(yt,{nativeId:KI()}),$.current=!1)}},[t,r]);var q=bt.useRef(null),re=va({icon:V?29:28,themeId:K.themeId,renderTarget:"Pane"}),ae=bt.useMemo(function(){var yt=bt.createElement(tme,{key:"resetAllKey",disabled:V,icon:re,accessibilityLabel:r.getString(262),onClick:M,accessibilitySetSize:Tc()?SB:void 0,accessibilityPositionInSet:Tc()?1:void 0},r.getString(262));return[yt]},[V,r,M,re]),ie=bt.useMemo(function(){if(_===void 0)return[];var yt=[],zt=r.getString(249),Fr=r.getString(261);return Tc()||yt.push(bt.createElement(tme,{key:Fr},Fr)),yt.push(bt.createElement(rme,{key:Ef(),name:Ef(),accessibilitySetSize:Tc()?SB:void 0,accessibilityPositionInSet:Tc()?2:void 0},zt)),yt},[_,r]),Te=bt.useMemo(function(){return _F.map(function(yt,zt){var Fr=3+zt;return bt.createElement(rme,{key:rOe(yt),name:yt.toString(),accessibilitySetSize:Tc()?SB:void 0,accessibilityPositionInSet:Tc()?Fr:void 0},Mj(r,yt))})},[r]);bt.useEffect(function(){yd()||qp(void 0,_)},[_]),bt.useEffect(function(){yd()||qp(O,void 0)},[O]);var Oe=bt.useCallback(function(yt,zt){D(zt.includes(Ef()));var Fr=zt.includes(Qe.ActiveOnly.toString()),In=zt.includes(Qe.ResolvedOnly.toString());u(function(jn){if(Fr&&In){if(jn===Qe.ActiveOnly)return Qe.ResolvedOnly;if(jn===Qe.ResolvedOnly)return Qe.ActiveOnly}else{if(Fr)return Qe.ActiveOnly;if(In)return Qe.ResolvedOnly}return Qe.All})},[D,u]),ke=bt.useCallback(function(yt,zt){$.current=!0;var Fr=zt.includes(Qe.ActiveOnly.toString()),In=zt.includes(Qe.ResolvedOnly.toString());if(wa()){var jn=zt.includes(Ef());_!==jn&&(D(jn),qp(void 0,jn));var io=Qe.All;Fr&&In?O===Qe.ActiveOnly?io=Qe.ResolvedOnly:O===Qe.ResolvedOnly&&(io=Qe.ActiveOnly):Fr?io=Qe.ActiveOnly:In&&(io=Qe.ResolvedOnly),O!==io&&(H(io),qp(io,void 0))}else d(function(ut){var pn=zt.includes(Ef());return ut!==pn&&qp(void 0,pn),pn}),u(function(ut){var pn=Qe.All;return Fr&&In?ut===Qe.ActiveOnly?pn=Qe.ResolvedOnly:ut===Qe.ResolvedOnly&&(pn=Qe.ActiveOnly):Fr?pn=Qe.ActiveOnly:In&&(pn=Qe.ResolvedOnly),ut!==pn&&qp(pn,void 0),pn})},[_,O,D,H,d,u]),it=bt.useMemo(function(){var yt=r.getString(261);return bt.createElement(hp,null,bt.createElement(Sh,null,ae,bt.createElement(Ih,{key:"divider1"}),Tc()?bt.createElement(E_,null,bt.createElement(J,{style:Xpe},bt.createElement(eOe,{key:yt,align:"center"},yt)),ie,bt.createElement(Ih,{key:"divider2"}),Te):bt.createElement(bt.Fragment,null,ie,bt.createElement(Ih,{key:"divider2"}),Te)))},[ie,r,ae,Te]),_e=bt.useCallback(function(yt,zt){zt&&Zpe()},[]),ct=bt.useMemo(function(){return function(yt){return{menu:it,props:{onCheckedChange:yd()?ke:Oe,checked:yt,onOpenChange:_e}}}},[it,ke,Oe,_e]),Ge=G(),Nt=Hj(Ge),Vt=O!==Qe.All?[O.toString()]:[];return _&&Vt.push(Ef()),bt.createElement(Tn,{onClick:void 0,accessibilityLabel:Lj(r,Ge),isTabbable:!0,key:"filterMenu",icon:27,text:Nt??"",ref:q,style:ot(Qpe,K,z.renderContextType),preventDefaultKeyDownBehavior:n,menuProps:ct(Vt),testID:Da()?Qn(Q.FilterButton):void 0,nodeId:Da()?Qn(Q.FilterButton):void 0})})});var ome=f(()=>{"use strict";s();nme()});var ime,ame=f(()=>{"use strict";s();gy();ime={marginTop:4,height:my}});var EB,PB,sme=f(()=>{"use strict";s();Js();EB=I(L());Ib();ue();mi();Er();ame();PB=EB.default.memo(function(e){var t=Sb();return EB.default.createElement(on,{nativeID:yd()?KI():void 0,style:ime},HI(t,e.itemCount))})});var dme=f(()=>{"use strict";s();sme()});var cme,oOe,iOe,ik,ume,lme,fme,pme,mme,gme,hme,yme,_B,RB=f(()=>{"use strict";s();k();cme=I(dn());Kc();gy();So();_r();ze();oOe=86,iOe=15,ik=new R([R.always({justifyContent:"flex-end",height:oOe,paddingLeft:yB,paddingRight:CB,borderWidth:1,borderColor:"transparent"}),R.rule({platform:"win32"},{marginLeft:13,marginRight:1,marginBottom:1,paddingLeft:0,paddingRight:0})]),ume=new R([R.rule({platform:"win32"},function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),lme=cme.StyleSheet.createViewStyle({marginBottom:Rr,flex:0,textAlign:"center"}),fme=new R([R.always(function(e){return{height:52,backgroundColor:e.palette.CardBackground,flexDirection:"row",alignItems:"stretch",elevation:2,flex:0,borderLeftWidth:es,borderTopWidth:es,borderRightWidth:es,borderColor:e.palette.CardAccent}})]),pme=Ce({width:Rr+30+qg,flex:0}),mme=new R(w(w([R.always({width:30,height:30,borderRadius:iOe,position:"absolute",left:Rr,marginTop:12})],j(kv),!1),[R.rule({platform:"win32"},function(e){return{backgroundColor:e.palette.CardAccent}})],!1)),gme=Ce({flex:1,alignItems:"stretch"}),hme=Ce({paddingRight:70,marginTop:12,alignItems:"stretch"}),yme=Ce({paddingRight:12,marginTop:6,alignItems:"stretch"}),_B=new R(w(w([R.always({height:11,borderRadius:5.5})],j(kv),!1),[R.rule({platform:"win32"},function(e){return{backgroundColor:e.palette.CardAccent}})],!1))});var Pa,AB,vme=f(()=>{"use strict";s();k();Lt();Pa=I(L());Be();Er();Vr();ze();xr();as();pr();xn();RB();AB=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.onFocusStateChange=function(n){var o,a;n===ge.FocusOn&&((a=(o=r.props).onFocus)===null||a===void 0||a.call(o))},r.renderWithTheme=function(n){return Pa.createElement(Wr,{onPress:r.props.onClick,accessibilityRole:"button",accessibilityLabel:r.props.accessibilityLabel,accessible:!0,style:r.renderStyle(ik,n),isTabbable:!0,nodeId:PC(),testID:PC(),onFocusStateChange:r.onFocusStateChange,focusedStyle:r.renderStyle(ume,n),preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior},Pa.createElement(Ve,{style:lme,textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},r.props.ghostCommentString),Pa.createElement(J,{style:r.renderStyle(fme,n)},Pa.createElement(J,{style:pme},Pa.createElement(J,{style:r.renderStyle(mme,n)})),Pa.createElement(J,{style:gme},Pa.createElement(J,{style:hme},Pa.createElement(J,{style:r.renderStyle(_B,n)})),Pa.createElement(J,{style:yme},Pa.createElement(J,{style:r.renderStyle(_B,n)})))))},r.render=function(){return Ye(r.renderWithTheme,Ze)},r}return t.prototype.renderStyle=function(r,n){return ot(r,n,A.FullPane)},t}(Pa.PureComponent)});var xme=f(()=>{"use strict";s();vme()});var Tme,kB,bme=f(()=>{"use strict";s();k();Tme=I(L()),kB=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return null},t}(Tme.Component)});var Sme=f(()=>{"use strict";s();bme()});var Ime,Eme,Pme,_me=f(()=>{"use strict";s();Ime=I(dn());Be();_r();Eme=new R([R.rule({renderContextType:A.HalfPane},{flex:1,alignSelf:"stretch",justifyContent:"center"}),R.rule({renderContextType:A.FullPane},{margin:12})]),Pme=Ime.StyleSheet.createViewStyle({textAlign:"center"})});var DT,Rme,Ame=f(()=>{"use strict";s();DT=I(L());pr();xn();_me();fn();Rme=DT.memo(function(t){var r=[Eme.render(Kr(t.renderContextType)),t.containerWidth?{width:t.containerWidth}:void 0];return DT.createElement(J,{style:r},DT.createElement(Ve,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard",style:Pme},t.message))})});var yy,sOe,kme,Dme=f(()=>{"use strict";s();k();yy=I(L());Yc();sOe=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return yy.createElement(yy.Fragment,null,this.props.children)},t.displayName="Fragment",t}(yy.PureComponent),kme=Ws(sOe)});var wme,dOe,DB,Fme=f(()=>{"use strict";s();Z();wme=function(t){return t&-t},dOe=function(){function e(t,r){var n=this,o=r??t.length;this.tree=[];for(var a=0;a<o;a++)this.tree.push(0);t.forEach(function(d,c){return c<n.tree.length&&n.add(d,c)})}return e.prototype.getSum=function(t){if(t<0||t>=this.tree.length){var r="getSum index out of bounds: ".concat(t,", length ").concat(this.tree.length);throw v().assertConditionTag(!1,r,595857548),new Error(r)}for(var n=0,o=t+1;o>0;o-=wme(o))n+=this.tree[o-1];return n},e.prototype.add=function(t,r){if(r<0||r>=this.tree.length){var n="getSum index out of bounds: ".concat(r,", length ").concat(this.tree.length);throw v().assertConditionTag(!1,n,595857549),new Error(n)}for(var o=r+1;o<=this.tree.length;o+=wme(o))this.tree[o-1]+=t},e.prototype.set=function(t,r){this.add(t-this.getValue(r),r)},e.prototype.getValue=function(t){return this.getSum(t)-(t&&this.getSum(t-1))},e.prototype.getCapacity=function(){return this.tree.length},e}(),DB=dOe});var zo,cOe,uOe,Ome,wB=f(()=>{"use strict";s();te();Z();(function(e){e[e.None=0]="None",e[e.NewScroll=1]="NewScroll",e[e.ReasonUnknown=2]="ReasonUnknown",e[e.CoauthChange=3]="CoauthChange",e[e.UserInteraction=4]="UserInteraction",e[e.UserScroll=5]="UserScroll",e[e.DirectionChange=6]="DirectionChange"})(zo||(zo={}));cOe=-1,uOe=function(){function e(t){this.dataFieldVisitor=t}return e.prototype.startStickyScroll=function(t){var r;this.session&&this.end(zo.NewScroll,C.reserveTag(595138519));var n=v().createActivityObject("StickyScrollPerf",this.dataFieldVisitor,be());this.session={activity:n,activityStart:e.now(),numRescrolls:0},n.addDataField("ScrollOffset",t.scrollOffset,N.SystemMetadata),n.addDataField("ContentHeight",(r=t.contentHeight)!==null&&r!==void 0?r:cOe,N.SystemMetadata),n.addDataField("IsHorizontal",t.isHorizontal,N.SystemMetadata)},e.prototype.end=function(t,r){var n;this.session&&(this.session.activity.addDataField("Duration",((n=this.session.lastRescrollTime)!==null&&n!==void 0?n:this.session.activityStart)-this.session.activityStart,N.SystemMetadata),this.session.activity.addDataField("NumberOfRescrolls",this.session.numRescrolls,N.SystemMetadata),this.session.activity.addDataField("EndReason",t,N.SystemMetadata),this.session.activity.successTag(r),this.session=void 0)},e.prototype.onRescroll=function(){this.session&&(this.session.lastRescrollTime=e.now(),this.session.numRescrolls++)},e.now=function(){var t=1e3;if(typeof performance<"u"&&performance.now){var r=performance.now();return Math.floor(r*t)}return Date.now()*t},e}(),Ome=uOe});var Bn,oo,lOe,Nme,Mme=f(()=>{"use strict";s();k();te();Z();Cn();Ir();UA();wB();(function(e){e[e.None=0]="None",e[e.ScrollOffset=1]="ScrollOffset",e[e.ContentHeight=2]="ContentHeight",e[e.ContentWidth=4]="ContentWidth",e[e.OuterHeight=8]="OuterHeight",e[e.OuterWidth=16]="OuterWidth",e[e.ProgrammaticScrollEnd=32]="ProgrammaticScrollEnd"})(Bn||(Bn={}));(function(e){e[e.Refresh=0]="Refresh",e[e.Start=1]="Start",e[e.End=2]="End",e[e.Index=3]="Index",e[e.Offset=4]="Offset"})(oo||(oo={}));lOe=function(){function e(){this.isCurrentlyAnimating=!1}return e.prototype.setTargetOffset=function(t,r,n){this.targetScrollToOffset=t,this.prevScrollToOffset=r,this.isCurrentlyAnimating=n},e.prototype.getTargetOffset=function(){return this.targetScrollToOffset},e.prototype.getPreviousScrollToOffset=function(){return this.prevScrollToOffset},e.prototype.isAnimating=function(){return this.isCurrentlyAnimating},e}(),Nme=function(){function e(t,r,n){var o=this;this.scrollOffset=0,this.contentHeight=void 0,this.contentWidth=void 0,this.outerHeight=0,this.outerWidth=0,this.listRef=null,this.userIsScrolling=!1,this.targetScrollToOffset=new lOe,this.changeListeners=[],this.onUserScrollEndListeners=[],this.PROGRAMMATIC_END_OFFSET_THRESHOLD=3,this.shouldFireProgrammaticEndOnScroll=function(){if(o.userIsScrolling)return!1;var a=o.targetScrollToOffset.getTargetOffset();if(a===void 0){var d=o.getOuterLength(),c=o.targetScrollToOffset.getPreviousScrollToOffset();return c||(c=0),d===void 0?(v().assertConditionTag(!o.isHorizontal,"Half pane needs better info since it can't handle multiple end events for the same position",590717702),Math.floor(o.scrollOffset)!==Math.floor(c)):Math.abs(o.scrollOffset-c)>d-o.PROGRAMMATIC_END_OFFSET_THRESHOLD}return Math.floor(a)===Math.floor(o.scrollOffset)},this.onContentSizeChange=this.onContentSizeChange.bind(this),this.onListLayout=this.onListLayout.bind(this),this.onMomentumScrollBegin=this.onMomentumScrollBegin.bind(this),this.onMomentumScrollEnd=this.onMomentumScrollEnd.bind(this),this.onScroll=this.onScroll.bind(this),this.onScrollBeginDrag=this.onScrollBeginDrag.bind(this),this.onScrollEndDrag=this.onScrollEndDrag.bind(this),this.scrollToQueuedTarget=this.scrollToQueuedTarget.bind(this),this.setListRef=this.setListRef.bind(this),this.getItemLayout=t,this.isHorizontal=r,this.stickyScrollTracker=new Ome(n)}return e.prototype.getOuterViewProps=function(){return{onLayout:this.onListLayout}},e.prototype.getScrollProps=function(){return{onContentSizeChange:this.onContentSizeChange,onMomentumScrollBegin:this.onMomentumScrollBegin,onMomentumScrollEnd:this.onMomentumScrollEnd,onScroll:this.onScroll,onScrollBeginDrag:this.onScrollBeginDrag,onScrollEndDrag:this.onScrollEndDrag,ref:this.setListRef}},e.prototype.getScrollOffset=function(){return this.scrollOffset},e.prototype.getContentHeight=function(){return this.contentHeight},e.prototype.getContentWidth=function(){return this.contentWidth},e.prototype.getOuterHeight=function(){return this.outerHeight},e.prototype.getOuterWidth=function(){return this.outerWidth},e.prototype.getListRef=function(){return this.listRef},e.prototype.onContentSizeChange=function(t,r){this.onContentSizeChangeImpl(t,r)},e.prototype.onContentSizeChangeImpl=function(t,r){var n=Bn.None;t!==this.contentWidth&&(n|=Bn.ContentWidth),r!==this.contentHeight&&(n|=Bn.ContentHeight);var o=this.scrollOffset,a=this.getContentLength(),d=this.isHorizontal?t:r;a!==void 0&&d<a&&(o=JH(this.scrollOffset,this.getOuterLength(),d)),o!==this.scrollOffset&&(n|=Bn.ScrollOffset,this.scrollOffset=o),this.contentHeight=r,this.contentWidth=t,this.fireChangeListenerNotification(n),this.scrollToStickyTarget(C.reserveTag(595940952))},e.prototype.onScroll=function(t){t&&(t.nativeEvent.isUserTriggered&&this.clearStickyState(zo.UserScroll,C.reserveTag(595138520)),this.scrollOffset=this.isHorizontal?t.nativeEvent.contentOffset.x:t.nativeEvent.contentOffset.y,this.shouldFireProgrammaticEndOnScroll()?(this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1),this.fireChangeListenerNotification(Bn.ScrollOffset|Bn.ProgrammaticScrollEnd)):this.fireChangeListenerNotification(Bn.ScrollOffset))},e.prototype.onScrollBeginDrag=function(t){this.clearStickyState(zo.UserScroll,C.reserveTag(595138521)),this.userIsScrolling=!0},e.prototype.onScrollEndDrag=function(t){},e.prototype.onMomentumScrollBegin=function(t){this.userIsScrolling=!0},e.prototype.onMomentumScrollEnd=function(t){this.userIsScrolling&&this.onUserScrollEndListeners.forEach(function(r){return r()}),this.userIsScrolling=!1,this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1)},e.prototype.setListRef=function(t){this.listRef=t},e.prototype.onListLayout=function(t){var r=t.nativeEvent.layout.height,n=t.nativeEvent.layout.width,o=Bn.None;this.outerHeight!==r&&(o|=Bn.OuterHeight,this.outerHeight=r),this.outerWidth!==n&&(o|=Bn.OuterWidth,this.outerWidth=n),this.fireChangeListenerNotification(o)},e.prototype.scrollToIndex=function(t,r,n,o){n===void 0&&(n=!1),o===void 0&&(o=!1),this.clearStickyState(zo.NewScroll,C.reserveTag(595138522)),n&&(this.stickyState={type:oo.Index,index:t,lazy:o},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:oo.Index,lazy:o,animate:r,index:t,origin:C.reserveTag(595940959),isStickyRescroll:!1})},e.prototype.scrollToOffsets=function(t,r,n){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];this.clearStickyState(zo.NewScroll,C.reserveTag(595138523)),this.queueScrollTarget({type:oo.Offset,lazy:r,animate:t,offset:n,additionalOffsets:o,origin:C.reserveTag(595940960)})},e.prototype.scrollToStart=function(t){this.clearStickyState(zo.NewScroll,C.reserveTag(595138524)),this.queueScrollTarget({type:oo.Start,animate:t,origin:C.reserveTag(595940961)})},e.prototype.scrollToEnd=function(t,r){r===void 0&&(r=!1),this.clearStickyState(zo.NewScroll,C.reserveTag(595138525)),r&&(this.stickyState={type:oo.End},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:oo.End,animate:t,origin:C.reserveTag(595940962),isStickyRescroll:!1})},e.prototype.registerChangeListener=function(t){this.changeListeners.push(t)},e.prototype.unregisterChangeListener=function(t){var r=this.changeListeners.indexOf(t);return r<0?!1:(this.changeListeners.splice(r,1),!0)},e.prototype.registerUserScrollEndListener=function(t){this.onUserScrollEndListeners.push(t)},e.prototype.unregisterUserScrollEndListener=function(t){var r=this.onUserScrollEndListeners.indexOf(t);return r<0?!1:(this.onUserScrollEndListeners.splice(r,1),!0)},e.prototype.clearStickyState=function(t,r){this.stickyState=void 0,this.queuedScrollTarget&&this.queuedScrollTarget.type===oo.Index&&this.queuedScrollTarget.isStickyRescroll&&(this.queuedScrollTarget=void 0),this.stickyScrollTracker.end(t,r)},e.prototype.onItemLayoutChange=function(){this.scrollToStickyTarget(C.reserveTag(595940963))},e.prototype.setIsHorizontal=function(t){var r=this.isHorizontal;this.isHorizontal=t,this.isHorizontal!==r&&(this.scrollOffset=0,this.clearStickyState(zo.DirectionChange,C.reserveTag(595138526)))},e.prototype.currentOffsetInvalidated=function(){this.scrollOffset=0,this.clearStickyState(zo.NewScroll,C.reserveTag(556323672))},e.prototype.getIsHorizontal=function(){return this.isHorizontal},e.prototype.fireChangeListenerNotification=function(t){t!==Bn.None&&this.changeListeners.forEach(function(r){return r(t)})},e.prototype.queueScrollTarget=function(t){var r=this.queuedScrollTarget;if(r){if(t.type===oo.Refresh)return;this.queuedScrollTarget=t}else this.queuedScrollTarget=t,setTimeout(this.scrollToQueuedTarget,this.getScrollTimeout())},e.prototype.getScrollTimeout=function(){return Y()==="win32"?250:0},e.prototype.scrollToStickyTarget=function(t){this.stickyState&&this.queueScrollTarget(m(m({},this.stickyState),{animate:!1,isStickyRescroll:!0,origin:t}))},e.prototype.scrollToQueuedTarget=function(){try{var t=this.queuedScrollTarget;if(this.listRef&&t){var r=void 0,n=!0,o=[],a=t.type;switch(t.type){case oo.Start:r=0;break;case oo.End:r=this.getContentLength()||0;break;case oo.Index:t.isStickyRescroll&&this.stickyScrollTracker.onRescroll();var d=this.getItemLayout(t.index);d?(r=d.offset,o=[d.offset+d.length],n=t.lazy):(r=this.scrollOffset,a=oo.Refresh);break;case oo.Offset:r=t.offset,n=t.lazy,o=t.additionalOffsets;break;case oo.Refresh:r=this.scrollOffset,a=oo.Refresh;break;default:Ne(t)}var c=t.type===oo.Refresh?!1:t.animate,u=BA.apply(void 0,w([n,this.getOuterLength(),this.getContentLength()||0,this.scrollOffset,r],j(o),!1)),l=void 0;(u!==this.scrollOffset||a===oo.Refresh||Y()!=="win32")&&(this.listRef.scrollToOffset({animated:c,offset:u}),u!==this.scrollOffset?this.targetScrollToOffset.setTargetOffset(u,this.targetScrollToOffset.getTargetOffset()?this.targetScrollToOffset.getTargetOffset():0,c):this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1))}}catch(p){pe(C.reserveTag(574433048))(p)}finally{this.queuedScrollTarget=void 0}},e.prototype.getContentLength=function(){return this.isHorizontal?this.contentWidth:this.contentHeight},e.prototype.getOuterLength=function(){return this.isHorizontal?this.outerWidth:this.outerHeight},e}()});var Kp,mt,ad,yu,ta,Ul,fOe,pOe,mOe,gOe,hOe,yOe,COe,Lme,Hme=f(()=>{"use strict";s();k();te();rt();Z();Md();Lt();Kp=I(dn()),mt=I(L()),ad=I(ee());Dc();Ps();Pc();Cn();ue();Cr();un();xt();Rn();ho();ag();Hf();Ld();ug();Be();hB();gy();jpe();Ph();qpe();OA();ome();dme();xme();RB();$H();KH();Sme();pr();tx();xn();Ame();Qa();Dme();Yc();zs();Ti();fv();LA();mi();$A();Er();Vr();L_();ok();NH();HA();MH();Fme();Mme();Ir();Qo();UA();xT();wB();So();fn();ze();xr();AA();(function(e){e[e.None=0]="None",e[e.HalfPaneContextChangePlaceholder=1]="HalfPaneContextChangePlaceholder"})(yu||(yu={}));(function(e){e[e.None=0]="None",e[e.FullPaneGhostCard=1]="FullPaneGhostCard",e[e.FullPaneGhostCardPlaceholder=2]="FullPaneGhostCardPlaceholder",e[e.HalfPaneContextChangePlaceholder=3]="HalfPaneContextChangePlaceholder"})(ta||(ta={}));(function(e){e[e.InList=0]="InList",e[e.BelowList=1]="BelowList"})(Ul||(Ul={}));fOe=.54,pOe=.4,mOe=.4,gOe=235,hOe={cardTabbingMode:zi.ExpandedCardOrFirstCardTabbable,postTabbingMode:Gi.ExpandedCardRootPostTabbable},yOe={cardTabbingMode:zi.AllCardsTabbable,postTabbingMode:Gi.AllPostsTabbable},COe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;n.forceScroll=!1,n.forceScrollAfterReadyToRender=!1,n.onListItemWillUnmount=function(d){if(n.props.componentTree.isFocusOnOrWithin({renderContextType:n.props.componentTree.componentTreeId.renderContextType,componentType:Q.Card,id:d})){var c=n.props.componentTree.getComponent(Q.CommentsList);c&&c.focus()}},n.onListItemLayout=function(d,c,u){n.setFullPaneListItemHeight(c,u,d.nativeEvent.layout.height)},n.onGhostCommentFocused=function(){n.state.ghostCommentLocation===Ul.InList&&setTimeout(function(){return n.scrollManager.scrollToEnd(!1,!0)})},n.updateContentSizeState=function(){var d=n.scrollManager.getContentHeight();d!==void 0&&n.setState({isContentLargerThanList:d>n.scrollManager.getOuterHeight()})},n.getMentionableCommentEditorProps=et(function(d,c){if(d===Rt.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,correlationId:n.props.correlationId,suggestionsDetails:c}}),n.clearStickyScrollStateFromChild=function(){n.scrollManager.clearStickyState(zo.ReasonUnknown,C.reserveTag(595138528))},n.assertStaleHeightData=zn(function(){v().assertConditionTag(!1,"commentThreadHeights size: ".concat(n.commentThreadHeights.size,", num threads: ").concat(n.state.allRenderableItemThreads.length),595961856)}),n.getItemLayoutForFlatlist=function(d,c){return n.getItemLayout(d,c,!0)},n.ViewabilityConfig={minimumViewTime:150,viewAreaCoveragePercentThreshold:0,waitForInteraction:!1},n.onSafeAreaInsetsChange=function(d){n.setState({paneContentSafeAreaInsets:d})},n.onFocusedNodeChanged=function(){n.props.componentTree.componentTreeId.renderContextType===A.FullPane&&Y()!=="win32"&&n.scrollManager.clearStickyState(zo.UserInteraction,C.reserveTag(595138529))},n.onRootViewKeyDown=function(d){Y()==="win32"&&(n.scrollManager.clearStickyState(zo.UserInteraction,C.reserveTag(595138530)),n.props.selectedComment&&n.isTabIntoCard(d)&&!n.props.componentTree.getComponentById({componentType:Lc(n.props.selectedComment.selectedCardId,n.props.draftState),id:n.props.selectedComment.selectedCardId,renderContextType:n.props.componentTree.componentTreeId.renderContextType})?(n.scrollToCurrentIndex(!1,!1,!1),d.persist(),setTimeout(function(){return n.props.componentTree.onKeyDownTabHandlerHelper(n.getResourceId(),d)},300)):n.props.componentTree.onKeyDownTabHandlerHelper(n.getResourceId(),d))},n.onListViewKeyDown=function(d){Y()==="win32"&&n.commentContentsKeyDownHandler.onKeyDown(d)},n.getRootViewKeyDownEvents=et(function(){return mm({useJSTabLoop:!0,handleKeysDuringBubbling:!0})}),n.setViewTreeRoot=function(d){n.props.componentTree.setViewTreeRootHelper(d,n.getResourceId())},n.getContentsPreventDefaultKeyDownBehavior=En(pm,function(){return[n.commentContentsKeyDownHandler.getKeyDownEvents(),!0]}),n.getThreadIdToListIndexMap=En(function(d){return new Map(d.map(function(c,u){return[wo(c).commentId,u]}))},function(){return[n.state.allRenderableItemThreads]}),n.onCardLayout=function(d,c){var u=n.getThreadIdToListIndexMap().get(d);if(u===void 0){v().assertConditionTag(!1,"Unexpected threadId",592570563);return}n.setFullPaneListItemHeight(u,d,c.nativeEvent.layout.height)},n.onListFocusStateChange=function(d){n.setState({listFocusState:d})},n.memoGetHeaderButtonStyles=et(Vpe),n.renderWithTheme=function(d,c){if(n.props.initializationStatus!==Xn.Initialized&&n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&n.props.initializationReason===Ms.NewThread)return mt.createElement(J,null);var u=[n.renderStyle(Ape,d)],l=Yo(n.props.draftState),p=n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!l,g=!p&&n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&l&&!!Gp.getPaneSingleCreateDraftId(n.props)&&n.props.foldableLayoutState===_s.DoublePortrait,h=Iu()&&n.props.componentTree.componentTreeId.renderContextType===A.FullPane,x=t.shouldShowLoadingUI({length:n.state.allRenderableItemThreads.length,isReadyToRender:n.isReadyToRender(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedComment,listViewWidthForHalfPane:n.state.listViewWidthForHalfPane,initializationStatus:n.props.initializationStatus,createdCommentLie_deprecated:n.props.createdCommentLie});!x&&n.props.dataItems.length===0&&n.notifyRenderedOnce();var y=n.scrollManager.getOuterViewProps(),T=n.memoGetHeaderButtonStyles(!!c),b=mt.createElement(Yr,{style:u,onLayout:n.onPaneViewLayout,focusable:!1,nodeId:Qn(Q.PaneRoot),nativeID:bm()?Qn(Q.PaneRoot):void 0,accessibilityLabel:n.props.localizationAPI.getString(31),accessible:!0,ref:n.setViewTreeRoot,preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior(),onFocus:n.onFocusedNodeChanged,onKeyDown:n.onRootViewKeyDown,keyDownEvents:n.getRootViewKeyDownEvents()},p&&n.renderNavigationBarForExistingComments(d),g&&n.renderNavigationBarForNewComment(d),n.renderPaneHeader(),mt.createElement(J,{style:n.renderStyle(T,d)},h&&n.renderNewCommentButton(d,n.isNewCommentButtonDisabled()),c?mt.createElement(mt.Fragment,null,mt.createElement(PB,{itemCount:n.props.filterItemCount}),mt.createElement(IB,m({},n.getContentFilterProps()))):void 0),mt.createElement(nfe,{shouldRenderView:Y()!=="win32",onLayout:y.onLayout,style:vr,onSafeAreaInsetsChange:n.onSafeAreaInsetsChange},mt.createElement(kme,{preventDefaultKeyDownBehavior:void 0},x?mt.createElement(J,{style:Ope},mt.createElement(Vp,{delay:jd},mt.createElement(Kp.Spinner,{size:"large"}))):[mt.createElement(Yr,{key:"list",onFocusStateChange:n.onListFocusStateChange,accessible:!0,accessibilityLabel:n.props.localizationAPI.getString(32),focusable:!0,onKeyDown:n.onListViewKeyDown,style:[vr,n.renderStyle(Bpe,d),n.state.listFocusState===ge.FocusOn&&n.renderStyle(Upe,d)],nodeId:Qn(Q.CommentsList),accessibilityRole:u_("tree",void 0),preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior()},mt.createElement(ad.FlatList,m({onLayout:Y()==="win32"?y.onLayout:void 0},n.getListProps(d)))),n.shouldShowGhostComment()&&n.state.ghostCommentLocation===Ul.BelowList&&n.renderGhostCardOverlay(d)]))),S=b;return le()&&(S=mt.createElement(hfe,{expandedComments:n.props.expandedComments},b)),S},n.keyboardDidHide=n.keyboardDidHide.bind(n),n.keyboardDidShow=n.keyboardDidShow.bind(n),n.onUserScrollEnd=n.onUserScrollEnd.bind(n),n.onNextThread=n.onNextThread.bind(n),n.onPaneViewLayout=n.onPaneViewLayout.bind(n),n.onPreviousThread=n.onPreviousThread.bind(n),n.renderListItem=n.renderListItem.bind(n),n.invokeModalDialog=n.invokeModalDialog.bind(n),n.handleScrollToCommand=n.handleScrollToCommand.bind(n),n.onSafeAreaInsetsChange=n.onSafeAreaInsetsChange.bind(n),n.onScrollManagerChange=n.onScrollManagerChange.bind(n),n.getItemLayoutForScrollManager=n.getItemLayoutForScrollManager.bind(n);var o=n.getInitialState(r);n.commentThreadHeights=new Map;var a={listViewWidthForHalfPane:0,currThreadIndex:ZH(n.props.selectedComment,o.allRenderableItemThreads),ghostCommentLocation:Ul.InList,maxDraftHeight:n.calculateMaxDraftHeight(0),displayLossyWarningAsOverlay:!1,availableScreenHeight:Op.get("window").height,paneContentSafeAreaInsets:{top:0,right:0,bottom:0,left:0},commentThreadHeightSums:n.getRenderableItemThreadHeightSums(r,o.allRenderableItemThreads),isContentLargerThanList:!1,listFocusState:ge.Unfocused};return n.state=m(m({},o),a),n.scrollListener={invokeScrollToCommand:n.handleScrollToCommand,clearStickyScrollState:n.clearStickyScrollStateFromChild},n.scrollManager=new Nme(n.getItemLayoutForScrollManager,n.props.componentTree.componentTreeId.renderContextType===A.HalfPane,n.props.telemetryVisitor),n.scrollManager.registerChangeListener(n.onScrollManagerChange),n.scrollManager.registerUserScrollEndListener(n.onUserScrollEnd),n}return t.prototype.UNSAFE_componentWillMount=function(){this.keyboardDidHideListener=ad.Keyboard.addListener("keyboardDidHide",this.keyboardDidHide),this.keyboardDidShowListener=ad.Keyboard.addListener("keyboardDidShow",this.keyboardDidShow)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.keyboardDidHideListener&&this.keyboardDidHideListener.remove(),this.keyboardDidHideListener=void 0,this.keyboardDidShowListener&&this.keyboardDidShowListener.remove(),this.keyboardDidShowListener=void 0},t.prototype.UNSAFE_componentWillReceiveProps=function(r){var n,o=this.getUpdatedItemThreads(r),a=this.state.displayLossyWarningAsOverlay;if((this.props.dataItems!==r.dataItems||this.props.selectedComment!==r.selectedComment)&&r.selectedComment){var d=((n=this.props.selectedComment)===null||n===void 0?void 0:n.selectionDetails.lowFidelityWarningType)!==r.selectedComment.selectionDetails.lowFidelityWarningType;if(r.componentTree.componentTreeId.renderContextType===A.FullPane&&d&&Rs(r.selectedComment)){var c=this.commentThreadHeights.get(r.selectedComment.selectedCardId);a=!!c&&c>=gOe}}if(this.props.lastContextChangeIncrement!==r.lastContextChangeIncrement&&this.commentThreadHeights.clear(),this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var u=this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset());this.forceScroll=u===-1||u===this.state.allRenderableItemThreads.length}this.setState({allRenderableItemThreads:o,currThreadIndex:ZH(r.selectedComment,o),displayLossyWarningAsOverlay:a,commentThreadHeightSums:this.getRenderableItemThreadHeightSums(r,o)})},t.prototype.getRenderableItemThreadHeightSums=function(r,n){var o=this,a;return r.componentTree.componentTreeId.renderContextType===A.FullPane&&(!this.state||!upe(n,this.state.allRenderableItemThreads)||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane)?new DB(n.map(function(d,c){return o.getFullPaneListItemHeight(n[c],r,!1)})):((a=this.state)===null||a===void 0?void 0:a.commentThreadHeightSums)||new DB([])},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.selectedComment&&(this.forceScrollAfterReadyToRender=!0)},t.prototype.componentDidUpdate=function(r,n){var o,a=!Gp.getPaneSingleCreateDraftId(r)&&!!Gp.getPaneSingleCreateDraftId(this.props),d=tk(this.props),c=d!==tk(r),u=c&&d,l=r.componentTree.componentTreeId.renderContextType!==A.HalfPane&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,p=fB(r.selectedComment,r.draftState,r.cardViewStates,r.componentTree.componentTreeId.renderContextType),g=fB(this.props.selectedComment,this.props.draftState,this.props.cardViewStates,this.props.componentTree.componentTreeId.renderContextType),h=lr(r.draftState),x=lr(this.props.draftState),y=p!==g;this.scrollManager.setIsHorizontal(hd()?this.props.componentTree.componentTreeId.renderContextType===A.HalfPane:r.componentTree.componentTreeId.renderContextType===A.HalfPane);var T=!!(!((o=We(this.props.draftState))===null||o===void 0)&&o.isInCurrentContext),b=T&&KW(r.draftState,this.props.draftState),S=$I(r.draftState,this.props.draftState);if(r.lastContextChangeIncrement!==this.props.lastContextChangeIncrement&&(this.forceScrollAfterReadyToRender=T),this.isReadyToRender()&&(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane||a||u||y||b||S||this.forceScroll||this.forceScrollAfterReadyToRender)){var E=!this.state.allRenderableItemThreads.length,P=r.dataItems!==this.props.dataItems,_=x!==h,D=this.state.listViewWidthForHalfPane!==n.listViewWidthForHalfPane;if((y||c)&&this.scrollManager.clearStickyState(zo.UserInteraction,C.reserveTag(595138527)),E)this.scrollToEmptyView();else if((P||y||_||l||D||c||b||S||this.forceScroll||this.forceScrollAfterReadyToRender)&&(g||c)){var O=r.componentTree.componentTreeId.renderContextType===A.HalfPane,H=this.isSelectedCardPinned(r),V=this.state.currThreadIndex!==void 0&&Math.abs(this.state.currThreadIndex-this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))<=1,M=y&&O&&!P&&!_&&!l&&!D&&!H&&!!p&&V||c&&!a,G=!u&&!O&&(!hd()||!l),K=!!(a||u||x||y||b||this.forceScroll||this.forceScrollAfterReadyToRender)||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane;this.scrollToCurrentIndex(M,K,G)}this.forceScrollAfterReadyToRender=!1}this.forceScroll=!1,l&&!g&&this.props.dataItems.length&&this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590206685),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:wo(this.props.dataItems).commentId,selectType:Ee.ExpandCard,source:ce.SharedComments},!1).catch(pe(C.reserveTag(590104653))),r.initializationStatus!==Xn.Initialized&&this.props.initializationStatus===Xn.Initialized&&Y()!=="win32"&&this.props.focusManager.focusCommentPaneCommand(this.props.componentTree),e.prototype.componentDidUpdate.call(this,r,n)},t.prototype.onContextChanged=function(){this.props.initializationStatus===Xn.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)},t.prototype.getCreateCommentInitialHeight=function(){return BH},t.prototype.getKeyboardingOptions=function(){return Y()==="win32"?hOe:yOe},t.prototype.renderStyle=function(r,n){return ot(r,n,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.calculateMaxDraftHeight=function(r){var n=Op.get("window"),o=n.width,a=n.height,d=o>a,c;return d?c=fOe:xl()===Xt.LargeDisplay?c=mOe:c=pOe,(a-r)*c},t.prototype.keyboardDidShow=function(r){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(r.endCoordinates.height),availableScreenHeight:Op.get("window").height-r.endCoordinates.height})},t.prototype.keyboardDidHide=function(r){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(0),availableScreenHeight:Op.get("window").height})},t.prototype.renderListItem=function(r){var n=wo(r.item);if(this.props.modelCapabilities.virtualized){var o=[n.commentId];this.onRequestLoadThreads(o)}var a=r.item,d=r.index,c=n.commentId,u=this.renderCommentThread(d,a);return mt.createElement(Gpe,m({},zpe(this.props.selectedComment,a,this.state.displayLossyWarningAsOverlay,this.props.localizationAPI,{onConfirm:this.onLowFidelityWarningConfirm,onCancel:this.onLowFidelityWarningCancel},{halfPaneWidth:this.state.listViewWidthForHalfPane,index:d,renderContextType:this.props.componentTree.componentTreeId.renderContextType,threadId:c,onWillUnmount:this.onListItemWillUnmount,onLayout:this.onListItemLayout,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})),u)},t.prototype.getListHeaderMode=function(){return!this.isSelectedCardPinned()&&this.shouldShowHalfPaneContextChangePlaceholder()?yu.HalfPaneContextChangePlaceholder:yu.None},t.prototype.renderListHeader=function(r){switch(this.getListHeaderMode()){case yu.HalfPaneContextChangePlaceholder:return mt.createElement(J,{style:[this.renderStyle(vB,r),{width:this.state.listViewWidthForHalfPane}]});case yu.None:return}},t.prototype.getListFooterMode=function(){return this.isSelectedCardPinned()?ta.None:this.shouldShowHalfPaneContextChangePlaceholder()?ta.HalfPaneContextChangePlaceholder:this.shouldShowGhostComment()?this.state.ghostCommentLocation===Ul.InList?ta.FullPaneGhostCard:ta.FullPaneGhostCardPlaceholder:ta.None},t.prototype.shouldShowHalfPaneContextChangePlaceholder=function(){return this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!(this.props.nextPopulatedContextDetails===jt.OnlyCommentsInCurrent&&this.state.allRenderableItemThreads.length===1)&&this.props.nextPopulatedContextDetails!==jt.NoComments},t.prototype.renderListFooter=function(r){var n=this.getListFooterMode();switch(n){case ta.HalfPaneContextChangePlaceholder:return mt.createElement(J,{style:[this.renderStyle(vB,r),{width:this.state.listViewWidthForHalfPane}]});case ta.FullPaneGhostCard:return mt.createElement(Sl.Provider,{value:this.state.allRenderableItemThreads.length},this.renderGhostCard());case ta.FullPaneGhostCardPlaceholder:return this.renderGhostPlaceholder(r);case ta.None:return;default:Ne(n)}},t.prototype.renderGhostCardOverlay=function(r){return mt.createElement(J,{style:this.renderStyle(kpe,r),key:"ghostOverlay"},this.renderGhostCard())},t.prototype.renderGhostPlaceholder=function(r){return mt.createElement(J,{style:this.renderStyle(ik,r),key:"ghostPlaceholder"})},t.prototype.renderGhostCard=function(){var r=bj(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return mt.createElement(AB,{onClick:this.onGhostCommentClicked,onFocus:this.onGhostCommentFocused,ghostCommentString:r,accessibilityLabel:r,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),key:"ghost"})},t.prototype.onScrollManagerChange=function(r){this.props.componentTree.componentTreeId.renderContextType!==A.HalfPane&&r&(Bn.ContentHeight|Bn.OuterHeight)&&(this.updateGhostCommentLocation(),setTimeout(this.updateContentSizeState));var n=this.scrollManager.getScrollOffset();hd()&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&r&Bn.ContentWidth&&this.getThreadIndexFromScrollPosition(n)!==this.state.currThreadIndex&&this.scrollToCurrentIndex(!1,!1,!1),r&Bn.ScrollOffset&&((!hd()||r&Bn.ProgrammaticScrollEnd)&&this.clearReadOnlyEditorFocusOnScroll_android(),this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&r&Bn.ProgrammaticScrollEnd&&(!hd()||n>0)&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(n)))},t.prototype.clearReadOnlyEditorFocusOnScroll_android=function(){if(Y()==="android"){var r=this.props.componentTree.getCurrentlyFocused();r.forEach(function(n){Np(n)&&n.getDisplayMode()!==vn.Editing&&n.blur()})}},t.prototype.updateGhostCommentLocation=function(){var r=this.scrollManager.getContentHeight();if(r!==void 0){var n=r<this.scrollManager.getOuterHeight()?Ul.BelowList:Ul.InList;n!==this.state.ghostCommentLocation&&this.setState({ghostCommentLocation:n})}},t.prototype.renderEmptyListContent=function(){if(!this.state.allRenderableItemThreads.length&&!(!ir()&&this.props.createdCommentLie)){var r=Sj(this.props.localizationAPI,this.props.nextPopulatedContextDetails,this.props.componentTree.componentTreeId.renderContextType);if(r)return mt.createElement(Rme,{message:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,containerWidth:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane?this.state.listViewWidthForHalfPane:void 0})}},t.prototype.onPaneViewLayout=function(r){this.setState({listViewWidthForHalfPane:r.nativeEvent.layout.width})},t.prototype.getThreadPositionText=function(){var r,n;if(this.props.commentThreadCountsContextDetails){var o=void 0,a=void 0,d=(r=this.state.currThreadIndex)!==null&&r!==void 0?r:0;if(this.props.pendingCommentLoad)o=this.isReadyToRender()?d:(n=this.props.pendingCommentLoad.selectedThreadIndex)!==null&&n!==void 0?n:0,a=this.props.pendingCommentLoad.numberOfTotalThreads;else if(this.state.allRenderableItemThreads.length)o=d,a=this.state.allRenderableItemThreads.length;else return;var c=this.props.commentThreadCountsContextDetails.numInPrevious+o+1,u=this.props.commentThreadCountsContextDetails.numInPrevious+a+this.props.commentThreadCountsContextDetails.numInNext;return this.props.localizationAPI.formatString(53,c.toString(),u.toString())}},t.prototype.getOuterSpacingForNavigationBar=function(){return xl()===Xt.LargeDisplay?Wd:Rr},t.prototype.renderNavigationBarTextWrapper=function(r,n){return r?mt.createElement(Ve,{style:this.renderStyle(Rpe,n),textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},r):mt.createElement(J,{style:this.renderStyle(_pe,n)})},t.prototype.renderNavigationBarForExistingComments=function(r){var n=this.getOuterSpacingForNavigationBar();return mt.createElement(iy,{leftChild:void 0,centerChild:mt.createElement(J,{style:xB},mt.createElement(Tn,{onClick:this.onPreviousThread,text:"",accessibilityLabel:this.props.localizationAPI.getString(52),isTabbable:!0,icon:10,style:ay,tooltipText:this.props.localizationAPI.getString(52),testID:Qn(Q.PreviousCommentButton),nodeId:Qn(Q.PreviousCommentButton),preventDefaultKeyDownBehavior:void 0}),this.renderNavigationBarTextWrapper(this.getThreadPositionText(),r),mt.createElement(Tn,{onClick:this.onNextThread,accessibilityLabel:this.props.localizationAPI.getString(51),isTabbable:!0,icon:11,style:ay,tooltipText:this.props.localizationAPI.getString(51),testID:Qn(Q.NextCommentButton),nodeId:Qn(Q.NextCommentButton),text:"",preventDefaultKeyDownBehavior:void 0})),rightChild:mt.createElement(Tn,{text:"",tooltipText:this.props.localizationAPI.getString(20),onClick:this.closePane,accessibilityLabel:this.props.localizationAPI.getString(20),isTabbable:!0,icon:9,style:[ay],nodeId:Qn(Q.ClosePaneButton),preventDefaultKeyDownBehavior:void 0}),showShadow:!1,outerSpacing:n})},t.prototype.renderNavigationBarForNewComment=function(r){var n=this.props.localizationAPI.getString(205),o=this.getOuterSpacingForNavigationBar();return mt.createElement(iy,{leftChild:void 0,centerChild:mt.createElement(J,{style:xB},this.renderNavigationBarTextWrapper(n,r)),rightChild:void 0,showShadow:!1,outerSpacing:o})},t.prototype.getThreadIndexFromScrollPosition=function(r){var n=this.state.allRenderableItemThreads.length;return ad.I18nManager.isRTL&&Y()==="android"?n-1-(Math.round(r/this.state.listViewWidthForHalfPane)-(this.getListFooterMode()===ta.HalfPaneContextChangePlaceholder?1:0)):Math.round(r/this.state.listViewWidthForHalfPane)-(this.getListHeaderMode()===yu.HalfPaneContextChangePlaceholder?1:0)},t.prototype.onUserScrollEnd=function(){this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))},t.prototype.updateCurrentThreadIndex=function(r){var n=this.state.allRenderableItemThreads.length,o=n===0?1:n,a=-1,d=v().createActivityObject("CommentSwipe",this.props.telemetryVisitor,be());if(r===a)return d.addDataField("SwipeDirection",Qt.Previous,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!0,N.SystemMetadata),this.props.selectionManager.selectAcrossContexts(Qt.Previous,this.props.componentTree.componentTreeId.renderContextType);if(r===o)return d.addDataField("SwipeDirection",Qt.Next,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!0,N.SystemMetadata),this.props.selectionManager.selectAcrossContexts(Qt.Next,this.props.componentTree.componentTreeId.renderContextType);r!==this.state.currThreadIndex&&r<n&&(this.state.currThreadIndex!==void 0&&(r<this.state.currThreadIndex?d.addDataField("SwipeDirection",Qt.Previous,N.SystemMetadata):d.addDataField("SwipeDirection",Qt.Next,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!1,N.SystemMetadata)),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590206686),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:wo(this.state.allRenderableItemThreads[r]).commentId,selectType:Ee.ExpandCard,source:ce.SharedComments},!1).catch(pe(C.reserveTag(590104654)))),d.successTag(595944269)},t.prototype.onNextThread=function(){var r=v().createActivityObject("NextButtonPressed",this.props.telemetryVisitor,{aggregationMode:co.OnSuccess});r.successTag(595944270),this.props.selectionManager.selectNextOrPreviousThread({direction:Qt.Next,source:ce.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.onPreviousThread=function(){var r=v().createActivityObject("PreviousButtonPressed",this.props.telemetryVisitor,{aggregationMode:co.OnSuccess});r.successTag(595944271),this.props.selectionManager.selectNextOrPreviousThread({direction:Qt.Previous,source:ce.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.scrollToCurrentIndex=function(r,n,o){var a;if(!hd()&&this.isSelectedCardPinned())a=0;else if(this.state.currThreadIndex!==void 0)a=this.state.currThreadIndex;else if(this.props.topVisibleThread)a=this.props.topVisibleThread.index;else return;if(a>=this.state.allRenderableItemThreads.length){v().assertConditionTag(!1,"Current index out of bounds",595961817);return}this.scrollManager.scrollToIndex(a,r,n,o)},t.prototype.scrollToEmptyView=function(){this.scrollManager.scrollToIndex(0,!1,!0,!1)},t.prototype.handleScrollToCommand=function(r){var n=this,o=this.scrollManager.getListRef();if(!(!o||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane)){var a=(0,ad.findNodeHandle)(o);typeof a=="number"&&r.target.measureLayout(a,function(d,c,u,l){n.scrollManager.scrollToOffsets(!1,!0,c+r.offsetY,c+r.offsetY+r.height)},function(){})}},t.prototype.getFullPaneListItemOffset=function(r){this.commentThreadHeights.size>=this.state.allRenderableItemThreads.length+100&&this.assertStaleHeightData();var n=AT;return r<=0?0:this.state.commentThreadHeightSums.getSum(r-1)+r*n},t.prototype.getFullPaneListItemHeight=function(r,n,o){var a=o?AT:0,d=wo(r).commentId,c=this.commentThreadHeights.get(d);if(c!==void 0)return c+a;var u=n.cardViewStates[d],l=u&&qu(u.loadState)?u.loadState.initialItemCount:r.length;return c=Bl({itemCount:l,readOnly:n.readOnly,isTask:!!this.props.tasks[d]}),c+a},t.prototype.setFullPaneListItemHeight=function(r,n,o){this.commentThreadHeights.set(n,o),this.props.componentTree.componentTreeId.renderContextType!==A.HalfPane&&(this.state.commentThreadHeightSums.set(o,r),this.scrollManager.onItemLayoutChange())},t.prototype.getItemLayout=function(r,n,o){if(!r)return v().assertConditionTag(!1,"Trying to get layout of non-existent element.",577066526),{index:n,length:0,offset:this.getFullPaneListItemOffset(n)};if(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var a=void 0;if(ad.I18nManager.isRTL&&Y()==="android"){var d=this.getListFooterMode()===ta.HalfPaneContextChangePlaceholder;a=(this.state.allRenderableItemThreads.length-1-n+(d?1:0))*this.state.listViewWidthForHalfPane}else{var c=this.getListHeaderMode()===yu.HalfPaneContextChangePlaceholder;a=(n+(c?1:0))*this.state.listViewWidthForHalfPane}return{length:this.state.listViewWidthForHalfPane,offset:a,index:n}}return{length:this.getFullPaneListItemHeight(r[n],this.props,o),offset:this.getFullPaneListItemOffset(n),index:n}},t.prototype.getItemLayoutForScrollManager=function(r){if(r===this.state.allRenderableItemThreads.length&&this.state.allRenderableItemThreads.length===0&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var n=0,o=ad.I18nManager.isRTL&&Y()==="android";return(o&&this.getListFooterMode()===ta.HalfPaneContextChangePlaceholder||!o&&this.getListHeaderMode()===yu.HalfPaneContextChangePlaceholder)&&(n=this.state.listViewWidthForHalfPane),{length:this.state.listViewWidthForHalfPane,offset:n,index:r}}if(!(r>=this.state.allRenderableItemThreads.length))return this.getItemLayout(this.state.allRenderableItemThreads,r,!1)},t.prototype.isSelectedCardPinned=function(r){return r===void 0&&(r=this.props),r.componentTree.componentTreeId.renderContextType===A.HalfPane&&r.selectedComment&&As(r.draftState)},t.prototype.renderPaneHeader=function(){return mt.createElement(kB,{closeLabel:this.props.localizationAPI.getString(20),onClose:this.closePane,paneTitle:this.props.localizationAPI.getString(18)})},t.prototype.isNewCommentButtonDisabled=function(){return!this.props.modelCapabilities.newThread},t.prototype.renderNewCommentButton=function(r,n){var o=[this.renderStyle(Npe,r)];return this.state.isContentLargerThanList&&o.push(this.renderStyle(Mpe,r)),mt.createElement(Tn,{onClick:this.startNewCommentSession,accessibilityLabel:this.props.localizationAPI.getString(92),tooltipText:this.props.localizationAPI.getString(92),disabled:n,isTabbable:!0,icon:12,text:this.props.localizationAPI.getString(91),style:o,testID:Qn(Q.NewCommentButton),nodeId:Qn(Q.NewCommentButton),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})},t.prototype.getVirtualizationParameters=function(){var r=4,n=Bl({itemCount:1,readOnly:this.props.readOnly,isTask:!1}),o=this.scrollManager.getOuterHeight(),a=o&&Math.ceil(o/n)||r,d=Y()==="android"?a*2+1:3,c=Y()==="android"?a+1:void 0;return{maxToRenderPerBatch:a,windowSize:d,updateCellsBatchingPeriod:150,viewabilityConfig:this.ViewabilityConfig,initialNumToRender:c}},t.prototype.getPinnedCardIndex_deprecated=function(){return this.isSelectedCardPinned()?this.state.currThreadIndex:void 0},t.prototype.getListProps=function(r){var n=this.getPinnedCardIndex_deprecated(),o=n!==void 0&&!hd()?[this.state.allRenderableItemThreads[n]]:this.state.allRenderableItemThreads,a=le()?{CellRendererComponent:yfe}:{};return m(m(m({data:o,directionalLockEnabled:!0,extraData:[this.props.cardViewStates,this.props.postViewStates,this.props.selectedComment],getItemLayout:this.getItemLayoutForFlatlist,horizontal:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,keyboardShouldPersistTaps:"always",keyExtractor:this.getListItemKey,ListEmptyComponent:this.renderEmptyListContent(),ListFooterComponent:this.renderListFooter(r),ListHeaderComponent:this.renderListHeader(r),pagingEnabled:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,renderItem:this.renderListItem,removeClippedSubviews:this.shouldRemoveClippedSubviews(),contentContainerStyle:this.state.isContentLargerThanList?this.renderStyle(Lpe,r):void 0,scrollEnabled:!this.isSelectedCardPinned()&&(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane||this.state.allRenderableItemThreads.length>0),showsHorizontalScrollIndicator:!1,testID:RC(),accessible:!1,style:Hpe},this.scrollManager.getScrollProps()),this.getVirtualizationParameters()),a)},t.prototype.scrollToThreadById=function(r){var n=this.state.allRenderableItemThreads.findIndex(function(o){return wo(o).commentId===r});return n<0?(v().assertConditionTag(!1,"Thread not found",589054428),!1):(this.scrollManager.scrollToIndex(n,!1,!0,!0),!0)},t.prototype.canCardDelete=function(r){var n=Ka(this.props.dataItems,r);return n?!0:(v().assertConditionTag(!1,"Comment not found",595961857),!1)},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!0},t.prototype.shouldRemoveClippedSubviews=function(){if(Y()==="android"&&lr(this.props.draftState))return!1},t.prototype.invokeModalDialog=function(r,n,o){var a=this,d=new Promise(function(c){var u=Rj(a.props.localizationAPI,r),l={title:u.confirmButton,style:Kp.AlertButtonStyle.destructive,onClick:function(){return c(n())}},p={title:u.cancelButton,style:Kp.AlertButtonStyle.cancel,onClick:function(){return c(o())}};Kp.Alert.alert(u.title,u.body,l,p)});return d},t.prototype.isTabIntoCard=function(r){return r.nativeEvent.key!==ne.Tab||this.props.dataItems.length===0?!1:this.props.componentTree.isFocusOn({componentType:Q.NewCommentButton})?!r.nativeEvent.shiftKey||!this.shouldShowGhostComment():r.nativeEvent.shiftKey&&this.props.componentTree.isFocusOn({componentType:Q.GhostCard})},t.shouldShowLoadingUI=function(r){var n=!r.length;return!r.isReadyToRender||r.renderContextType===A.HalfPane&&(!r.selectedComment&&!n||!r.listViewWidthForHalfPane)||r.initializationStatus!==Xn.Initialized||!ir()&&!!r.createdCommentLie_deprecated&&n},t.prototype.getResourceId=function(){var r,n;return(n=(r=this.props.resource)===null||r===void 0?void 0:r.id)!==null&&n!==void 0?n:fW()},t.prototype.getContentExtraPaddingLeft=function(){return this.state.paneContentSafeAreaInsets.left},t.prototype.getContentExtraPaddingRight=function(){return this.state.paneContentSafeAreaInsets.right},t.prototype.getAvailableScreenHeight=function(){return this.state.availableScreenHeight},t.prototype.getMaxDraftHeight=function(){return this.props.componentTree.componentTreeId.renderContextType===A.HalfPane?this.state.maxDraftHeight:void 0},t.prototype.getCommentCardStyle=function(){return Y()==="win32"?Dpe:void 0},t.prototype.getContentBackgroundColor=function(r,n){return le()?void 0:r&&!n?"CardReplyBackground":"CardBackground"},t.prototype.renderInner=function(){return mt.createElement(EA.Provider,{value:this.scrollListener},mt.createElement(mx.Provider,{value:this.props.commentAPI},Ye(this.renderWithTheme,Ze,kT)))},t}(Gp),Lme=COe});function FB(){var e=oE(),t=sE(),r=Da()?dE(t):t;return function(n){var o=wd(n),a=Fs(n),d={cardViewStates:Vi(n),dataItems:e(n),tasks:Xo(n),personaIconPropertiesMap:tg(n),createdCommentLie:Co(n,!0,a.componentTreeId.renderContextType),nextPopulatedContextDetails:o.nextPopulatedContextDetails,pendingCommentLoad:ji(n),postViewStates:nE(n),historyRecordViewStates:eE(n),componentTree:a,commentThreadCountsContextDetails:o.commentThreadCounts,selectedThreadIdBeforeCommentSession:tl(n),readOnly:tE(n),highlightedCommentId:rE(n),lastContextChangeIncrement:o.lastContextChangeIncrement,initializationStatus:n.paneState.initializationStatus,draftState:fe(n),modelCapabilities:Br(n),selectedComment:ve(n),expandedComments:da(n),suggestionsDetails:iE(n),foldableLayoutState:$n(n).foldableLayoutState,displayConfigurationState:n.paneState.viewContainerDisplayConfiguration,currentFilter:t7(n),filterItemCount:r7(n),collaborators:n7(n),DoNotUse_isFilteringEnabled:!!or(n),renderableSelectedComment:Db()?r(n):void 0},c=o7(n);if(c){var u=yi(n),l=nr(u)?u.findIndex(function(p){return p===c}):u.filter(yr).findIndex(function(p){return p.commentId===c});l>-1&&(d.topVisibleThread={cardId:c,index:l})}return d}}var vOe,OB,Bme,ak=f(()=>{"use strict";s();bs();di();ue();Et();Ui();vo();el();mo();JC();Hme();vOe=na(FB,ol,void 0,{forwardRef:!0}),OB=vOe(Lme),Bme=OB});var sk,Ume=f(()=>{"use strict";s();bs();sk=iw});var Yp,Vme,jme,Cy,$p=f(()=>{"use strict";s();te();Do();Yp=function(t){return t.contentExtensions.extensions},Vme=function(t,r){var n=Yp(t)[r];return n!==void 0&&n.priority!==Ht.Disabled},jme=function(t,r){if(!r)return!1;switch(r.renderMode){case se.Integrated:case se.TaskPaneItem:{var n=Yp(t)[r.renderMode];return n!==void 0&&n.priority!==Ht.Disabled}case se.Isolated:{var n=Yp(t)[r.renderMode];return n!==void 0&&n.controller.provider.getExtension(r.threadId).priority!==Ht.Disabled}default:Ne(r)}},Cy=function(t){return t.contentExtensions.contentNavigationSupported}});function Wme(e,t){return t?{}:{neutralForeground1:e.Text,neutralForeground1Hover:e.TextHover,neutralForeground1Pressed:e.TextPressed,neutralForeground1Selected:e.TextSelected,neutralForeground2:e.TextSecondary,neutralForeground2Hover:e.TextSecondaryHover,neutralForeground2Pressed:e.TextSecondaryPressed,neutralForeground2Selected:e.TextSecondarySelected,neutralForeground4:e.TextCtlSubtlePlaceholder,neutralForegroundDisabled:e.TextDisabled,compoundBrandForeground1:e.TextEmphasis,compoundBrandForeground1Hover:e.TextEmphasisHover,compoundBrandForeground1Pressed:e.TextEmphasisPressed,neutralForegroundInverted:e.TextCtlSubtleSelectionHighlight,neutralForegroundOnBrand:e.TextCtlEmphasis,neutralForegroundOnBrandHover:e.TextCtlEmphasisHover,neutralForegroundOnBrandPressed:e.TextCtlEmphasisPressed,neutralForegroundInvertedLink:e.BkgToggleSwitchOff,neutralForegroundInvertedLinkHover:e.BkgToggleSwitchOffHover,neutralForegroundInvertedLinkPressed:e.BkgToggleSwitchOffPressed,neutralBackground1:e.Bkg,neutralBackground1Hover:e.BkgHover,neutralBackground1Pressed:e.BkgPressed,neutralBackground1Selected:e.BkgSelected,neutralBackground2:e.BkgHeader,neutralBackground2Hover:e.BkgSubtle,neutralBackground3:e.BkgSubtle,neutralBackgroundInverted:e.BkgSelectionHighlight,neutralBackgroundDisabled:e.BkgCtlDisabled,neutralStencil1:e.SliderBuffer,brandBackground:e.BkgCtlEmphasis,brandBackgroundHover:e.BkgCtlEmphasisHover,brandBackgroundPressed:e.BkgCtlEmphasisPressed,compoundBrandBackground1:e.BkgToggleSwitchOn,compoundBrandBackground1Hover:e.BkgToggleSwitchOnHover,compoundBrandBackground1Pressed:e.BkgToggleSwitchOnPressed,neutralStrokeAccessible:e.StrokeOnlySelected,neutralStrokeAccessibleHover:e.StrokeOnlyHover,neutralStrokeAccessiblePressed:e.StrokeOnlyPressed,neutralStroke1:e.StrokeCtl,neutralStroke1Hover:e.StrokeSelectedHover,neutralStroke1Pressed:e.StrokeOverPressed,neutralStroke2:e.SliderBuffer,brandStroke1:e.AccentEmphasis,compoundBrandStroke1:e.StrokeToggleSwitchOn,compoundBrandStroke1Hover:e.StrokeToggleSwitchOnHover,compoundBrandStroke1Pressed:e.StrokeToggleSwitchOnPressed,neutralStrokeDisabled:e.StrokeCtlDisabled,strokeFocus2:e.StrokeKeyboard}}var zme=f(()=>{"use strict";s()});function NB(e,t){return e==="HighContrast"||!t.host.colors?{}:{colors:Gme(e,t.host.colors.AppPrimary)}}function Gme(e,t){var r=xOe(t),n=e==="White"||e==="Colorful";return{neutralForeground2BrandHover:n?r.shade10:r.tint40,neutralForeground2BrandPressed:n?r.shade30:r.tint10,neutralForeground2BrandSelected:n?r.shade20:r.tint40,neutralForeground3BrandHover:n?r.shade10:r.tint40,neutralForeground3BrandPressed:n?r.shade30:r.tint10,neutralForeground3BrandSelected:n?r.shade20:r.tint40,brandForegroundLink:n?r.primary:r.tint30,brandForegroundLinkHover:n?r.shade10:r.tint40,brandForegroundLinkPressed:n?r.shade30:r.tint10,brandForegroundLinkSelected:n?r.shade20:r.tint40,compoundBrandForeground1:n?r.primary:r.tint30,compoundBrandForeground1Hover:n?r.shade10:r.tint40,compoundBrandForeground1Pressed:n?r.shade30:r.tint10,brandForeground1:n?r.primary:r.tint30,brandForeground2:n?r.shade10:r.tint40,brandBackground:r.primary,brandBackgroundHover:r.shade10,brandBackgroundPressed:r.shade30,brandBackgroundSelected:r.shade20,compoundBrandBackground1:r.primary,compoundBrandBackground1Hover:r.shade10,compoundBrandBackground1Pressed:r.shade20,brandBackgroundStatic:r.primary,brandBackground2:r.tint40,neutralStrokeAccessibleSelected:r.primary,brandStroke1:r.primary,brandStroke2:r.tint40,compoundBrandStroke1:r.primary,compoundBrandStroke1Hover:r.shade10,compoundBrandStroke1Pressed:r.shade20}}function xOe(e){if(typeof e=="string"){if(e.toLowerCase()==="#185abd")return F.color.word;if(e.toLowerCase()==="#107c41")return F.color.excel;if(e.toLowerCase()==="#d83b01")return F.color.office;if(e.toLowerCase()==="#80397b"||e.toLowerCase()==="#7719aa")return F.color.oneNote;if(e.toLowerCase()==="#0078d4")return F.color.outlook;if(e.toLowerCase()==="#c43e1c")return F.color.powerPoint}return F.color.brand}var MB=f(()=>{"use strict";s();Ii()});var Kme=Re((zTr,qme)=>{s();qme.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#aec6eb"},brandForeground2:{rest:"#d2e0f4"},brandForegroundLink:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5",selected:"#d2e0f4"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#292929",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},neutralBackground2:{rest:"#1f1f1f",hover:"#333333",pressed:"#141414",selected:"#2e2e2e"},neutralBackground3:{rest:"#141414",hover:"#292929",pressed:"#0a0a0a",selected:"#242424"},neutralBackground4:{rest:"#0a0a0a",hover:"#1f1f1f",pressed:"#000000",selected:"#1a1a1a"},neutralBackground5:{rest:"#000000",hover:"#141414",pressed:"#050505",selected:"#0f0f0f"},neutralBackground6:{rest:"#333333"},neutralBackgroundDisabled:{rest:"#141414"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#d6d6d6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#ffffff"},neutralForeground3:{rest:"#adadad",hover:"#d6d6d6",pressed:"#d6d6d6",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#d6d6d6"},neutralForeground4:{rest:"#999999"},neutralForegroundDisabled:{rest:"#5c5c5c"},neutralForegroundInverted:{rest:"#000000"},neutralForegroundInvertedLink:{rest:"#292929",hover:"#292929",pressed:"#292929",selected:"#292929"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#333333"},neutralStencil2:{rest:"#575757"},neutralStroke1:{rest:"#666666",hover:"#757575",pressed:"#6b6b6b",selected:"#707070"},neutralStroke2:{rest:"#525252"},neutralStroke3:{rest:"#3d3d3d"},neutralStrokeAccessible:{rest:"#adadad",hover:"#bdbdbd",pressed:"#b3b3b3",selected:"#185abd"},neutralStrokeDisabled:{rest:"#424242"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var $me=Re((qTr,Yme)=>{s();Yme.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var Xme=Re((YTr,Qme)=>{s();Qme.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#185abd"},brandForeground2:{rest:"#1651aa"},brandForegroundLink:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#fdf6f6"},dangerBackground2:{rest:"#f1bbbc"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#f1bbbc"},dangerBorder2:{rest:"#d13438"},dangerBorderActive:{rest:"#d13438"},dangerForeground1:{rest:"#bc2f32"},dangerForeground2:{rest:"#751d1f"},dangerForeground3:{rest:"#d13438"},dangerForegroundInverted:{rest:"#dc5e62"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#ffffff",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},neutralBackground2:{rest:"#fafafa",hover:"#f0f0f0",pressed:"#dbdbdb",selected:"#e6e6e6"},neutralBackground3:{rest:"#f5f5f5",hover:"#ebebeb",pressed:"#d6d6d6",selected:"#e0e0e0"},neutralBackground4:{rest:"#f0f0f0",hover:"#fafafa",pressed:"#f5f5f5",selected:"#ffffff"},neutralBackground5:{rest:"#ebebeb",hover:"#f5f5f5",pressed:"#f0f0f0",selected:"#fafafa"},neutralBackground6:{rest:"#e6e6e6"},neutralBackgroundDisabled:{rest:"#f0f0f0"},neutralBackgroundInverted:{rest:"#616161"},neutralForeground1:{rest:"#242424",hover:"#242424",pressed:"#242424",selected:"#242424"},neutralForeground2:{rest:"#424242",hover:"#242424",pressed:"#242424",brandHover:"#1651aa",brandPressed:"#0e336a",brandSelected:"#13458f",selected:"#242424"},neutralForeground3:{rest:"#616161",hover:"#424242",pressed:"#424242",brandHover:"#1651aa",brandPressed:"#0e336a",brandSelected:"#13458f",selected:"#424242"},neutralForeground4:{rest:"#707070"},neutralForegroundDisabled:{rest:"#bdbdbd"},neutralForegroundInverted:{rest:"#ffffff"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#e6e6e6"},neutralStencil2:{rest:"#fafafa"},neutralStroke1:{rest:"#d1d1d1",hover:"#c7c7c7",pressed:"#b3b3b3",selected:"#bdbdbd"},neutralStroke2:{rest:"#e0e0e0"},neutralStroke3:{rest:"#f0f0f0"},neutralStrokeAccessible:{rest:"#616161",hover:"#575757",pressed:"#4d4d4d",selected:"#185abd"},neutralStrokeDisabled:{rest:"#e0e0e0"},outofofficeBackground1:{rest:"#fdf5fc"},outofofficeBackground2:{rest:"#edbbe7"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#edbbe7"},outofofficeBorder2:{rest:"#c239b3"},outofofficeBorderActive:{rest:"#c239b3"},outofofficeForeground1:{rest:"#af33a1"},outofofficeForeground2:{rest:"#6d2064"},outofofficeForeground3:{rest:"#c239b3"},severeBackground1:{rest:"#fdf6f3"},severeBackground2:{rest:"#f4bfab"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#f4bfab"},severeBorder2:{rest:"#da3b01"},severeBorderActive:{rest:"#da3b01"},severeForeground1:{rest:"#c43501"},severeForeground2:{rest:"#7a2101"},severeForeground3:{rest:"#da3b01"},strokeFocus1:{rest:"#ffffff"},strokeFocus2:{rest:"#000000"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},successBackground1:{rest:"#f1faf1"},successBackground2:{rest:"#9fd89f"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#9fd89f"},successBorder2:{rest:"#107c10"},successBorderActive:{rest:"#107c10"},successForeground1:{rest:"#0e700e"},successForeground2:{rest:"#094509"},successForeground3:{rest:"#107c10"},successForegroundInverted:{rest:"#359b35"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#fffef5"},warningBackground2:{rest:"#fef7b2"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fef7b2"},warningBorder2:{rest:"#fde300"},warningBorderActive:{rest:"#fde300"},warningForeground1:{rest:"#817400"},warningForeground2:{rest:"#817400"},warningForeground3:{rest:"#fde300"},warningForegroundInverted:{rest:"#fef7b2"}}});var Zme=Re((QTr,Jme)=>{s();Jme.exports={shadow16:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:8,blur:16}],shadow2:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:1,blur:2}],shadow28:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:14,blur:28}],shadow4:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:2,blur:4}],shadow64:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:32,blur:64}],shadow8:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var tge=Re((JTr,ege)=>{s();ege.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#aec6eb"},brandForeground2:{rest:"#d2e0f4"},brandForegroundLink:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5",selected:"#d2e0f4"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#4d4d4d",hover:"#5c5c5c",pressed:"#424242",selected:"#575757"},neutralBackground2:{rest:"#424242",hover:"#525252",pressed:"#383838",selected:"#4d4d4d"},neutralBackground3:{rest:"#383838",hover:"#474747",pressed:"#2e2e2e",selected:"#424242"},neutralBackground4:{rest:"#2e2e2e",hover:"#3d3d3d",pressed:"#242424",selected:"#383838"},neutralBackground5:{rest:"#242424",hover:"#333333",pressed:"#1a1a1a",selected:"#2e2e2e"},neutralBackground6:{rest:"#1a1a1a"},neutralBackgroundDisabled:{rest:"#383838"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#e6e6e6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#ffffff"},neutralForeground3:{rest:"#cccccc",hover:"#e6e6e6",pressed:"#e6e6e6",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#e6e6e6"},neutralForeground4:{rest:"#c2c2c2"},neutralForegroundDisabled:{rest:"#666666"},neutralForegroundInverted:{rest:"#000000"},neutralForegroundInvertedLink:{rest:"#4d4d4d",hover:"#4d4d4d",pressed:"#4d4d4d",selected:"#4d4d4d"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#1a1a1a"},neutralStencil2:{rest:"#424242"},neutralStroke1:{rest:"#8a8a8a",hover:"#999999",pressed:"#8f8f8f",selected:"#949494"},neutralStroke2:{rest:"#757575"},neutralStroke3:{rest:"#616161"},neutralStrokeAccessible:{rest:"#a8a8a8",hover:"#b8b8b8",pressed:"#adadad",selected:"#185abd"},neutralStrokeDisabled:{rest:"#474747"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#5c5c5c",pressed:"#424242",selected:"#575757"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var nge=Re((ebr,rge)=>{s();rge.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});function TOe(e){for(var t in e)for(var r in e[t]){var n=e[t][r];if(typeof n=="string"&&n.includes("PlatformColor")){var o=n.substring(14,n.length-1);e[t][r]=(0,oge.PlatformColor)(o)}}return e}var oge,ige,age,sge=f(()=>{"use strict";s();oge=I(ee()),ige=I(V1()),age=TOe(ige.default)});function ck(e){return e==="White"||e==="Colorful"?dk.default:e==="DarkGray"?lge.default:e==="Black"?dge.default:e==="HighContrast"?age:dk.default}function mge(e){return e==="White"||e==="Colorful"?uge.default:e==="DarkGray"?fge.default:e==="Black"?cge.default:e==="HighContrast"?pge.default:dk.default}var dge,cge,dk,uge,lge,fge,pge,LB=f(()=>{"use strict";s();dge=I(Kme()),cge=I($me()),dk=I(Xme()),uge=I(Zme()),lge=I(tge()),fge=I(nge()),pge=I(U1());sge()});function bOe(e){var t=ck(e);return Iv(t)}function SOe(e){var t=mge(e);return Ev(t)}var HB,gge,BB=f(()=>{"use strict";s();jc();zc();LB();HB=Jt(bOe);gge=Jt(SOe)});function UB(e){return{background:e.Bkg,bodyStandoutBackground:e.Bkg,bodyFrameBackground:e.Bkg,bodyFrameDivider:e.AccentLight,bodyText:e.Text,bodyTextChecked:e.TextSelected,subText:e.TextSecondary,bodyDivider:e.AccentLight,disabledBackground:e.BkgCtlSubtleDisabled,disabledText:e.TextCtlSubtleDisabled,disabledBodyText:e.TextDisabled,disabledSubtext:e.TextCtlSubtleDisabled,disabledBodySubtext:e.TextDisabled,focusBorder:e.StrokeKeyboard,variantBorder:e.AccentOutline,variantBorderHovered:e.AccentOutline,defaultStateBackground:e.Bkg,errorText:e.TextError,warningText:e.Text,errorBackground:e.Bkg,blockingBackground:e.Bkg,warningBackground:e.Bkg,warningHighlight:e.TextError,successBackground:e.TextEmphasis,inputBorder:e.StrokeCtlSubtle,inputBorderHovered:e.StrokeCtlSubtleHover,inputBackground:e.BkgCtlSubtle,inputBackgroundChecked:e.BkgCtlSubtle,inputBackgroundCheckedHovered:e.BkgCtlSubtleHover,inputForegroundChecked:e.TextCtlSubtle,inputFocusBorderAlt:e.StrokeCtlSubtleKeyboard,smallInputBorder:e.StrokeCtlSubtle,inputText:e.TextCtlSubtle,inputTextHovered:e.TextCtlSubtleHover,inputPlaceholderText:e.TextCtlSubtlePlaceholder,buttonBackground:e.BkgCtl,buttonBackgroundChecked:e.BkgCtlSelected,buttonBackgroundHovered:e.BkgCtlHover,buttonBackgroundCheckedHovered:e.BkgCtlSelected,buttonBackgroundPressed:e.BkgCtlPressed,buttonBackgroundDisabled:e.BkgCtlDisabled,buttonBorder:e.StrokeCtl,buttonText:e.TextCtl,buttonTextHovered:e.TextCtlHover,buttonTextChecked:e.TextCtlSelected,buttonTextCheckedHovered:e.TextCtlSelected,buttonTextPressed:e.TextCtlPressed,buttonTextDisabled:e.TextCtlDisabled,buttonBorderDisabled:e.StrokeCtlDisabled,buttonBorderFocused:e.StrokeCtlKeyboard,primaryButtonBackground:e.BkgCtlEmphasis,primaryButtonBackgroundHovered:e.BkgCtlEmphasisHover,primaryButtonBackgroundPressed:e.BkgCtlEmphasisPressed,primaryButtonBackgroundDisabled:e.BkgCtlEmphasisDisabled,primaryButtonBorder:e.StrokeCtlEmphasis,primaryButtonBorderFocused:e.StrokeCtlEmphasisKeyboard,primaryButtonText:e.TextCtlEmphasis,primaryButtonTextHovered:e.TextCtlEmphasisHover,primaryButtonTextPressed:e.TextCtlEmphasisPressed,primaryButtonTextDisabled:e.TextCtlEmphasisDisabled,accentButtonBackground:e.BkgCtlEmphasis,accentButtonText:e.TextCtlEmphasis,menuBackground:e.Bkg,menuDivider:e.AccentLight,menuIcon:e.Text,menuHeader:e.Text,menuItemBackgroundHovered:e.BkgHover,menuItemBackgroundPressed:e.BkgPressed,menuItemText:e.Text,menuItemTextHovered:e.TextHover,listBackground:e.Bkg,listText:e.Text,listItemBackgroundHovered:e.BkgHover,listItemBackgroundChecked:e.BkgSelected,listItemBackgroundCheckedHovered:e.BkgSelected,listHeaderBackgroundHovered:e.BkgHover,listHeaderBackgroundPressed:e.BkgPressed,actionLink:e.TextActive,actionLinkHovered:e.TextActiveHover,link:e.TextHyperlink,linkHovered:e.TextHyperlinkHover,linkPressed:e.TextHyperlinkPressed,defaultBackground:e.BkgCtl,defaultBorder:e.StrokeCtl,defaultContent:e.TextCtl,defaultIcon:e.TextCtl,defaultHoveredBackground:e.BkgCtlHover,defaultHoveredBorder:e.StrokeCtlHover,defaultHoveredContent:e.TextCtlHover,defaultHoveredIcon:e.TextCtlHover,defaultFocusedBackground:e.BkgCtlHover,defaultFocusedBorder:e.StrokeCtlKeyboard,defaultFocusedContent:e.TextCtlHover,defaultFocusedIcon:e.TextCtlHover,defaultPressedBackground:e.BkgCtlPressed,defaultPressedBorder:e.StrokeCtlPressed,defaultPressedContent:e.TextCtlPressed,defaultPressedIcon:e.TextCtlPressed,defaultDisabledBackground:e.BkgCtlDisabled,defaultDisabledBorder:e.StrokeCtlDisabled,defaultDisabledContent:e.TextCtlDisabled,defaultDisabledIcon:e.TextCtlDisabled,ghostBackground:e.Bkg,ghostBorder:e.Bkg,ghostContent:e.Text,ghostIcon:e.Text,ghostHoveredBackground:e.BkgHover,ghostHoveredBorder:e.BkgHover,ghostHoveredContent:e.TextHover,ghostHoveredIcon:e.TextHover,ghostFocusedBackground:e.BkgHover,ghostFocusedBorder:e.StrokeKeyboard,ghostFocusedContent:e.TextHover,ghostFocusedIcon:e.TextHover,ghostPressedBackground:e.BkgPressed,ghostPressedBorder:e.BkgPressed,ghostPressedContent:e.TextPressed,ghostPressedIcon:e.TextPressed,ghostDisabledBackground:e.Bkg,ghostDisabledBorder:e.Bkg,ghostDisabledContent:e.TextDisabled,ghostDisabledIcon:e.TextDisabled,brandedBackground:e.BkgCtlEmphasis,brandedBorder:e.StrokeCtlEmphasis,brandedContent:e.TextCtlEmphasis,brandedIcon:e.TextCtlEmphasis,brandedHoveredBackground:e.BkgCtlEmphasisHover,brandedHoveredBorder:e.StrokeCtlEmphasisHover,brandedHoveredContent:e.TextCtlEmphasisHover,brandedHoveredIcon:e.TextCtlEmphasisHover,brandedFocusedBackground:e.BkgCtlEmphasisHover,brandedFocusedBorder:e.StrokeCtlEmphasisKeyboard,brandedFocusedContent:e.TextCtlEmphasisHover,brandedFocusedIcon:e.TextCtlEmphasisHover,brandedPressedBackground:e.BkgCtlEmphasisPressed,brandedPressedBorder:e.StrokeCtlEmphasisPressed,brandedPressedContent:e.TextCtlEmphasisPressed,brandedPressedIcon:e.TextCtlEmphasisPressed,brandedDisabledBackground:e.BkgCtlEmphasisDisabled,brandedDisabledBorder:e.StrokeCtlEmphasisDisabled,brandedDisabledContent:e.TextCtlEmphasisDisabled,brandedDisabledIcon:e.TextCtlEmphasisDisabled,defaultCheckedBackground:e.BkgCtlSelected,defaultCheckedContent:e.TextCtlSelected,defaultCheckedHoveredBackground:e.BkgCtlHover,defaultCheckedHoveredContent:e.TextCtlHover,ghostCheckedBackground:e.BkgSelected,ghostCheckedContent:e.TextSelected,ghostCheckedHoveredBackground:e.BkgHover,ghostCheckedHoveredContent:e.TextHover,ghostCheckedHoveredBorder:e.StrokeSelectedHover,ghostSecondaryContent:e.TextSecondary,ghostFocusedSecondaryContent:e.TextSecondaryHover,ghostHoveredSecondaryContent:e.TextSecondaryHover,ghostPressedSecondaryContent:e.TextSecondaryPressed}}var VB=f(()=>{"use strict";s()});function jB(e,t,r){return m({colors:m({},r&&UB(r)),typography:e.fluentTypography,host:{palette:r||{},colors:IOe(e)}},t?{name:t}:void 0)}var IOe,WB=f(()=>{"use strict";s();k();VB();IOe=function(t){return Object.keys(t.ramps).reduce(function(r,n){return Object.assign.apply(Object,w([r],t.rampNames[n].map(function(o,a){var d;return d={},d[o]=t.ramps[n][a],d}),!1))},{})}});function EOe(){var e=ck("Colorful");return K1(e)}var zB,GB=f(()=>{"use strict";s();jc();zc();LB();zB=Jt(EOe)});function FT(){var e={sizes:ei.typography.sizes,weights:ei.typography.weights,families:{primary:"Segoe UI",secondary:"Segoe UI Semibold",cursive:"System",monospace:"Consolas",sansSerif:"System",serif:"System",numeric:"Bahnschrift"},variants:m({captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"primary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"primary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"primary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"primary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"primary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"primary",size:"heroLarge",weight:"semiBold"}},zB())};return e}var qB=f(()=>{"use strict";s();k();zg();GB()});function uk(e){return e==="TaskPane"?m(m({},hge),{Bkg:"antiquewhite"}):hge}var hge,KB,YB=f(()=>{"use strict";s();k();hge={Bkg:"#FFFFFF",BkgHover:"#D2D2D2",BkgPressed:"#B1B1B1",BkgSelected:"#C6C6C6",BkgSubtle:"#F3F3F3",BkgSelectionHighlight:"#737373",Text:"#262626",TextRest:"#262626",TextHover:"#262626",TextPressed:"#262626",TextSelected:"#262626",TextDisabled:"#B1B1B1",TextSelectionHighlight:"#FFFFFF",TextSecondary:"#666666",TextSecondaryRest:"#666666",TextSecondaryHover:"#505050",TextSecondaryPressed:"#666666",TextSecondarySelected:"#666666",TextEmphasis:"#D83B01",TextEmphasisRest:"#D83B01",TextEmphasisHover:"#EA6115",TextEmphasisPressed:"#A22C01",TextEmphasisSelected:"#D83B01",StrokeSelectedHover:"#969696",StrokeKeyboard:"#969696",StrokeOverRest:"#00000000",StrokeOverHover:"#00000000",StrokeOverPressed:"#00000000",StrokeOverSelectedRest:"#00000000",StrokeOverSelectedHover:"#969696",StrokeOverSelectedPressed:"#00000000",BkgCtl:"#E6E6E6",BkgCtlHover:"#FFF7F0",BkgCtlPressed:"#FBDFD0",BkgCtlSelected:"#E6E6E6",BkgCtlDisabled:"#E6E6E6",TextCtl:"#262626",TextCtlHover:"#262626",TextCtlPressed:"#262626",TextCtlSelected:"#262626",TextCtlDisabled:"#B1B1B1",StrokeCtl:"#969696",StrokeCtlHover:"#FBDFD0",StrokeCtlPressed:"#EA6115",StrokeCtlSelected:"#969696",StrokeCtlDisabled:"#D2D2D2",StrokeCtlKeyboard:"#FBDFD0",BkgCtlEmphasis:"#D83B01",BkgCtlEmphasisHover:"#F29F71",BkgCtlEmphasisPressed:"#A22C01",BkgCtlEmphasisDisabled:"#E6E6E6",TextCtlEmphasis:"#FFFFFF",TextCtlEmphasisHover:"#FFFFFF",TextCtlEmphasisPressed:"#FFFFFF",TextCtlEmphasisDisabled:"#B1B1B1",StrokeCtlEmphasis:"#A22C01",StrokeCtlEmphasisHover:"#D83B01",StrokeCtlEmphasisPressed:"#A22C01",StrokeCtlEmphasisDisabled:"#D2D2D2",StrokeCtlEmphasisKeyboard:"#A22C01",BkgCtlSubtle:"#FFFFFF",BkgCtlSubtleHover:"#FFFFFF",BkgCtlSubtlePressed:"#FFFFFF",BkgCtlSubtleDisabled:"#F3F3F3",BkgCtlSubtleSelectionHighlight:"#7DA3C6",TextCtlSubtle:"#262626",TextCtlSubtlePlaceholder:"#666666",TextCtlSubtleHover:"#262626",TextCtlSubtlePressed:"#262626",TextCtlSubtleDisabled:"#B1B1B1",TextCtlSubtleSelectionHighlight:"#262626",StrokeCtlSubtle:"#C6C6C6",StrokeCtlSubtleHover:"#969696",StrokeCtlSubtlePressed:"#969696",StrokeCtlSubtleDisabled:"#C6C6C6",StrokeCtlSubtleKeyboard:"#969696",TextHyperlink:"#D83B01",TextHyperlinkHover:"#A22C01",TextHyperlinkPressed:"#6C1E01",TextActive:"#262626",TextActiveHover:"#EA6115",TextActivePressed:"#A22C01",TextActiveSelected:"#D83B01",StrokeOnlyHover:"#B1B1B1",StrokeOnlyPressed:"#737373",StrokeOnlySelected:"#969696",TextError:"#A50000",TextErrorHover:"#A50000",TextErrorPressed:"#A50000",TextErrorSelected:"#A50000",ThumbToggleSwitchOff:"#505050",ThumbToggleSwitchOffHover:"#505050",ThumbToggleSwitchOffPressed:"#505050",ThumbToggleSwitchOffDisabled:"#D2D2D2",ThumbToggleSwitchOn:"#FFFFFF",ThumbToggleSwitchOnHover:"#FFFFFF",ThumbToggleSwitchOnPressed:"#FFFFFF",ThumbToggleSwitchOnDisabled:"#FFFFFF",BkgToggleSwitchOff:"#FFFFFF",BkgToggleSwitchOffHover:"#D2D2D2",BkgToggleSwitchOffPressed:"#B1B1B1",BkgToggleSwitchOffDisabled:"#FFFFFF",BkgToggleSwitchOn:"#D83B01",BkgToggleSwitchOnHover:"#EA6115",BkgToggleSwitchOnPressed:"#A22C01",BkgToggleSwitchOnDisabled:"#D2D2D2",StrokeToggleSwitchOff:"#505050",StrokeToggleSwitchOffHover:"#505050",StrokeToggleSwitchOffPressed:"#505050",StrokeToggleSwitchOffDisabled:"#D2D2D2",StrokeToggleSwitchOn:"#D83B01",StrokeToggleSwitchOnHover:"#EA6115",StrokeToggleSwitchOnPressed:"#A22C01",StrokeToggleSwitchOnDisabled:"#D2D2D2",SliderPrimary:"#444444",SliderPrimaryHover:"#D2D2D2",SliderPrimaryPressed:"#262626",SliderPrimaryDisabled:"#969696",SliderSecondary:"#D2D2D2",SliderBuffer:"#262626",SliderKeyboard:"#444444",SliderToolTipBorder:"#C6C6C6",SliderToolTipLabel:"#262626",SliderToolTipBkg:"#FFFFFF",AccentDark:"#C6C6C6",AccentLight:"#E6E6E6",AccentEmphasis:"#D83B01",AccentOutline:"#000000",TextEmphasis2:"#D83B01",BkgCtlSubtleSelected:"#F3F3F3",TextCtlSubtleSelected:"#262626",BkgCtlEmphasisFocus:"#F3F3F3",BkgCtlSubtleFocus:"#F3F3F3",BkgCtlSubtleHoverDisabled:"#F3F3F3",BkgCtlSubtleSelectedDisabled:"#F3F3F3",BkgHeader:"#E6E6E6",TextHeader:"#262626"};KB={ramps:{App:["#F8F8F8","#EFF6FC","#BBDAF3","#55A4E2","#359EDD","#0078d7","#283E4A","#030C13"],FluentGrays:["#FAF9F8","#797775","#11100F"],ClassicGrays:["#FFFFFF","#737373","#000000"],Sepias:["#ECE6DE"]},getPalette:uk,typography:{},fluentTypography:{},rampNames:{App:["FakeApp1","App2","App3","App4","App5","App6","App7","App8"],FluentGrays:["FakeGray1","Gray2","Gray3"],ClassicGrays:["FakeGray4","Gray5","Gray6"],Sepias:["FakeSepia"]}}});var yge,Cge,lk,$B=f(()=>{"use strict";s();yge="",Cge=function(){return yge},lk=function(t){yge=t}});function POe(){var e=!1;return e}function QB(){var e=fk.TurboModuleRegistry.get("Theming");return e?(vge||(lk(e.initialHostThemeSetting),vge=!0),[POe()?m(m({},e),{getPalette:uk}):e,new fk.NativeEventEmitter(e)]):[KB,void 0]}var fk,vge,XB=f(()=>{"use strict";s();k();fk=I(ee());YB();$B();vge=!1});function _Oe(e){var t=e;return t&&t.message!==void 0?void 0:e}function JB(e){e===void 0&&(e={});var t=QB(),r=t[0],n=t[1],o={module:r,emitter:n,themeName:Cge()||""},a=e.paletteName,d=new Qf(eO(e),function(){var u=a||"WhiteColors",l=_Oe(o.module.getPalette(u));return jB(r,o.themeName,l)},function(){return!o.themeName||o.themeName===""?{}:{shadows:m({},gge(o.themeName)),typography:FT()}},function(){return!o.themeName||o.themeName===""?{}:{colors:m({},HB(o.themeName)),typography:FT()}},function(u){return NB(o.themeName,u)},function(u){return u.host.palette?m(m({},a!==void 0&&{colors:Wme(u.host.palette,o.themeName==="HighContrast")}),{typography:FT()}):{}}),c=function(l){o.themeName=l&&l.hostThemeSetting||o.themeName,lk(o.themeName),d.invalidate()};return n&&n.addListener("onPlatformDefaultsChanged",c),d}var xge=f(()=>{"use strict";s();k();zg();_v();zme();MB();BB();WB();qB();XB();$B()});var Tge=f(()=>{"use strict";s()});var bge=f(()=>{"use strict";s();YB();XB();Tge()});var Sge=f(()=>{"use strict";s();xge();WB();bge();VB();BB();GB();MB();qB()});var Ige,Ege=f(()=>{"use strict";s();rt();_v();Sge();ue();ri();Ige=et(function(){var e=JB({paletteName:qo()?"TaskPaneCard_FluentSV":"TaskPaneCard_VisualRefresh"});return new Qf(e,aY)})});var OT,vy,pk=f(()=>{"use strict";s();k();_v();OT=I(L());Ege();xr();vy=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.updateState=n.updateState.bind(n),r.api.registerForThemeChange(n.updateState),n.state=r.api.getTheme(),n}return t.prototype.componentWillUnmount=function(){this.props.api.unregisterForThemeChange(this.updateState)},t.prototype.updateState=function(){this.setState(this.props.api.getTheme())},t.prototype.render=function(){return OT.createElement(J1,{theme:Ige()},OT.createElement(Ze.Provider,{value:this.state},this.props.children))},t}(OT.Component)});var Pge={};_y(Pge,{ExtensionAwareCommentPane:()=>ZB});var xy,ZB,e3=f(()=>{"use strict";s();xy=I(L());Mi();Ume();$p();Ui();vo();ak();ok();pk();ZB=xy.memo(function(e){var t=sk(function(a){return Vme(a,e.extensionRenderMode)}),r=sk(ca)!==vt.Visible,n=sk(or);if(t||r)return null;var o=xy.createElement(vy,{api:e.themeAPI},xy.createElement(Bme,{commentAPI:e.commentAPI,peopleAPI:e.peopleAPI,localizationAPI:e.localizationAPI,focusManager:e.focusManager,selectionManager:e.selectionManager,initializationReason:e.initializationReason,registerComponentUIActionListener:e.registerComponentUIActionListener,unregisterComponentUIActionListener:e.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:e.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:e.unregisterComponentInterruptableCommandListener,resource:e.resource,telemetryVisitor:e.telemetryVisitor,correlationId:e.correlationId,onInitialRender:e.onInitialRender,lppManager:e.lppManager,createOrUpdateFilter:e.createOrUpdateFilter,componentRef:e.componentRef,componentInstanceId:e.componentInstanceId}));return n&&(o=xy.createElement(kT.Provider,{value:n},o)),o})});var uhe=Re(LT=>{"use strict";s();Object.defineProperty(LT,"__esModule",{value:!0});LT.CustomLinkAction=void 0;var yNe;(function(e){e[e.ACCOUNTDETAILS=0]="ACCOUNTDETAILS"})(yNe=LT.CustomLinkAction||(LT.CustomLinkAction={}))});var lhe=Re(br=>{"use strict";s();Object.defineProperty(br,"__esModule",{value:!0});br.CustomLinkAction=br.NativeServices=br.ServiceInfos=void 0;var Un=_t();Un.CustomTypeRegistry.registerTypeInfos({"Identity::MeControlProfileData":{CompanyName:"$string",Email:"$string",FirstName:"$string",FriendlyName:"$string",HostResolutionId:"$string",IsOrgId:"$boolean",IsMsaId:"$boolean",IsAdId:"$boolean",LastName:"$string",ProfileId:"$string",ProfilePicBase64:"$string",IsAccountInBadState:["opt-field","$boolean"],PhoneNumber:["opt-field","$string"]},"Identity::MeControlProfiles":{Profiles:["$array","Identity::MeControlProfileData"]},"Identity::MeControlSignInResult":{UserCanceled:"$boolean",ErrorCode:"$number"},"Identity::MeControlSignOutResult":{UserCanceled:"$boolean",IsProfileSignedOut:"$boolean"},"Identity::MeControlSwitchProfileResult":{IsProfileSwitched:"$boolean",IdentityErrorState:"$string"},"Identity::MeControlProfileEmailToSwitchTo":{ProfileEmailToSwitchTo:"$string"},"Identity::MeControlAddMailAccountResult":{UserCanceled:"$boolean",ErrorCode:"$number"},"Identity::MeControlSwitchMailAccountResult":{IsAccountSwitched:"$boolean",AccountErrorState:"$string"},"Identity::MeControlMailAccountEmailToSwitchTo":{AccountEmailToSwitchTo:"$string"},"Identity::MeControlProfileEmailToSignOut":{ProfileEmailToSignOut:"$string"},"Identity::MeControlCustomLinkId":{CustomLinkId:"$number"},"Identity::MeControlViewId":{ViewId:"$number"},"Identity::MeControlAccountImageSize":{ActiveAccountImageSize:"$number",SecondaryAccountImageSize:"$number"},"Identity::MeControlPrideColorGradientImages":{IsShowPridePreferenceEnabled:"$boolean",ActiveAccountGradientImage:"$string",SecondaryAccountGradientImage:"$string"},"Identity::UserInfo":{UserName:"$string",CorrelationId:"$string"},"Identity::ServiceInfo":{ServiceName:"$string"},"Identity::AuthData":{AuthToken:"$string",ErrorMessage:"$string",CorrelationId:"$string",OperationResult:"$boolean"},"Identity::AuthServerURLData":{ServiceName:"$string",AuthServerURL:"$string",ErrorMessage:"$string",OperationResult:"$boolean"},"Identity::MeControlFixAccountErrorResult":{DidShowFixAccountDialog:"$boolean"}});br.ServiceInfos={NativeGetMSGraphToken:["Identity::NativeGetMSGraphToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiToken:["Identity::NativeGetLokiToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiUrl:["Identity::NativeGetLokiUrl",{QueryLokiUrl:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetTenantId:["Identity::NativeGetTenantId",{QueryTenantId:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetServiceURL:["Identity::NativeGetServiceURL",{QueryAuthServerUrl:["ReturnsPromiseMethod","Identity::AuthServerURLData",["Identity::ServiceInfo"]]}],NativeGetMeControlProfiles:["Identity::NativeGetMeControlProfiles",{GetMeControlProfiles:["ReturnsPromiseMethod","Identity::MeControlProfiles",[]]}],NativeMeControlSignIn:["Identity::NativeMeControlSignIn",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",[]]}],NativeMeControlSignInWithViewId:["Identity::NativeMeControlSignInWithViewId",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",["Identity::MeControlViewId"]]}],NativeMeControlSwitchProfile:["Identity::NativeMeControlSwitchProfile",{MeControlSwitchProfile:["ReturnsPromiseMethod","Identity::MeControlSwitchProfileResult",["Identity::MeControlProfileEmailToSwitchTo"]]}],NativeMeControlSignOutProfile:["Identity::NativeMeControlSignOutProfile",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut"]]}],NativeMeControlSignOutProfileWithViewId:["Identity::NativeMeControlSignOutProfileWithViewId",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut","Identity::MeControlViewId"]]}],NativeMeControlAddMailAccount:["Identity::NativeMeControlAddMailAccount",{MeControlAddMailAccount:["ReturnsPromiseMethod","Identity::MeControlAddMailAccountResult",[]]}],NativeMeControlSwitchMailAccount:["Identity::NativeMeControlSwitchMailAccount",{MeControlSwitchMailAccount:["ReturnsPromiseMethod","Identity::MeControlSwitchMailAccountResult",["Identity::MeControlMailAccountEmailToSwitchTo"]]}],NativeMeControlCloseFlyout:["Identity::NativeMeControlCloseFlyout",{CloseFlyout:["ReturnsPromiseMethod","$boolean",[]]}],NativeMeControlCloseFlyoutWithViewId:["Identity::NativeMeControlCloseFlyoutWithViewId",{CloseFlyout:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlCustomLinkClickedWithViewId:["Identity::NativeMeControlCustomLinkClickedWithViewId",{CustomLinkClicked:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlCustomLinkClickedWithAction:["Identity::NativeMeControlCustomLinkClickedWithAction",{CustomLinkClicked:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId","$number"]]}],NativeMeControlGetPrideColorGradientImages:["Identity::NativeMeControlGetPrideColorGradientImages",{GetPrideColorGradientImages:["ReturnsPromiseMethod","Identity::MeControlPrideColorGradientImages",["Identity::MeControlAccountImageSize","Identity::MeControlViewId"]]}],NativeMeControlFixAccountError:["Identity::NativeMeControlFixAccountError",{MeControlFixAccountError:["ReturnsPromiseMethod","Identity::MeControlFixAccountErrorResult",[]]}]};br.NativeServices={NativeGetMSGraphToken:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetMSGraphToken),NativeGetLokiToken:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetLokiToken),NativeGetLokiUrl:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetLokiUrl),NativeGetTenantId:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetTenantId),NativeGetServiceURL:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetServiceURL),NativeGetMeControlProfiles:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeGetMeControlProfiles),NativeMeControlSignIn:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSignIn),NativeMeControlSignInWithViewId:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSignInWithViewId),NativeMeControlSwitchProfile:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSwitchProfile),NativeMeControlSignOutProfile:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSignOutProfile),NativeMeControlSignOutProfileWithViewId:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSignOutProfileWithViewId),NativeMeControlAddMailAccount:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlAddMailAccount),NativeMeControlSwitchMailAccount:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlSwitchMailAccount),NativeMeControlCloseFlyout:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlCloseFlyout),NativeMeControlCloseFlyoutWithViewId:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlCloseFlyoutWithViewId),NativeMeControlCustomLinkClickedWithViewId:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlCustomLinkClickedWithViewId),NativeMeControlCustomLinkClickedWithAction:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlCustomLinkClickedWithAction),NativeMeControlGetPrideColorGradientImages:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlGetPrideColorGradientImages),NativeMeControlFixAccountError:Un.RekaServiceRegistry.getNativeService(br.ServiceInfos.NativeMeControlFixAccountError)};var CNe=uhe();Object.defineProperty(br,"CustomLinkAction",{enumerable:!0,get:function(){return CNe.CustomLinkAction}})});var fhe=Re(jl=>{"use strict";s();Object.defineProperty(jl,"__esModule",{value:!0});jl.ServiceInfos=jl.NativeServices=jl.CustomLinkAction=void 0;var n3=lhe();Object.defineProperty(jl,"CustomLinkAction",{enumerable:!0,get:function(){return n3.CustomLinkAction}});Object.defineProperty(jl,"NativeServices",{enumerable:!0,get:function(){return n3.NativeServices}});Object.defineProperty(jl,"ServiceInfos",{enumerable:!0,get:function(){return n3.ServiceInfos}})});var rm,$ye,zye,Gye,qye,Kye,Yye,Qye=f(()=>{"use strict";s();k();te();rt();Z();rm=I(L());mB();xn();pk();_A();$ye=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.getDiagnosticDataFields=function(){return[Gr("IsResourceAvailable",n.props.isResourceAvailable,N.SystemMetadata),Gr("IsContentExtensionEnabled",n.props.isExtensionEnabled,N.SystemMetadata),Gr("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,N.SystemMetadata)]},n.getUpdatedResource=et(function(o,a){return m(m({},o),{id:a})}),n.createTelemetryContext=et(PA),n.getAccessibilitySetProperties=En(function(o){var a,d,c;return{accessibilityPositionInSet:(a=o==null?void 0:o.setItem)===null||a===void 0?void 0:a.positionInSet,accessibilitySetSize:(d=o==null?void 0:o.setItem)===null||d===void 0?void 0:d.setSize,accessibilityLevel:(c=o==null?void 0:o.setItem)===null||c===void 0?void 0:c.level}},function(){return[n.props.accessibilityMetadata]}),n.state={keyIter_deprecated:0},n}return t.prototype.componentDidUpdate=function(r){var n,o;r.isResourceAvailable!==this.props.isResourceAvailable&&((o=(n=v()).logDiagnosticTrace)===null||o===void 0||o.call.apply(o,w([n,Mt(zye||(zye=qt(["HostableComponentResourceAvailabilityUpdated"],["HostableComponentResourceAvailabilityUpdated"]))),C.reserveTag(554717322),St.Info,ht.ProductServiceUsage,this.props.telemetryVisitor],j(this.getDiagnosticDataFields()),!1)))},t.prototype.componentDidMount=function(){var r,n;(n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Mt(Gye||(Gye=qt(["HostableComponentMount"],["HostableComponentMount"]))),C.reserveTag(554717323),St.Info,ht.ProductServiceUsage,this.props.telemetryVisitor],j(this.getDiagnosticDataFields()),!1))},t.prototype.componentWillUnmount=function(){var r,n;(n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Mt(qye||(qye=qt(["HostableComponentUnmount"],["HostableComponentUnmount"]))),C.reserveTag(554717324),St.Info,ht.ProductServiceUsage,this.props.telemetryVisitor],j(this.getDiagnosticDataFields()),!1))},t.prototype.render=function(){var r,n,o,a;if(!this.props.isResourceAvailable||!this.props.resource||!this.props.threadId)return(n=(r=v()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Mt(Kye||(Kye=qt(["HostableComponentRenderFailed"],["HostableComponentRenderFailed"]))),C.reserveTag(524100997),St.Info,ht.ProductServiceUsage,this.props.telemetryVisitor],j(this.getDiagnosticDataFields()),!1)),null;if(!this.props.isExtensionEnabled)return Wn?rm.createElement(Ve,{textStylePolyester:"MediumBold"},"Debug Error: This comment card's extension is disabled."):((a=(o=v()).logDiagnosticTrace)===null||a===void 0||a.call.apply(a,w([o,Mt(Yye||(Yye=qt(["HostableComponentRenderFailedExtensionDisabled"],["HostableComponentRenderFailedExtensionDisabled"]))),C.reserveTag(524100998),St.Info,ht.ProductServiceUsage,this.props.telemetryVisitor],j(this.getDiagnosticDataFields()),!1)),null);var d=this.getUpdatedResource(this.props.resource,this.props.threadId),c=this.getAccessibilitySetProperties(),u=rm.createElement(vy,{api:this.props.themeAPI},rm.createElement(ek,m({commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:d,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions,onInitialRender:this.props.onInitialRender,setComponentRef:this.props.setComponentRef,isVirtualized:this.props.isVirtualized,componentInstanceId:this.props.componentInstanceId,correlationId:this.props.correlationId,lppManager:this.props.lppManager,accessibilityMetadata:this.props.accessibilityMetadata},c)));return rm.createElement(ny.Provider,{value:this.createTelemetryContext(this.props.telemetryVisitor)},u)},t}(rm.PureComponent)});var Jye={};_y(Jye,{HostableCommentCardRendererContainer:()=>uLe,makeMapStateToProps:()=>Xye});var Xye,uLe,Zye=f(()=>{"use strict";s();te();Z();Do();bs();Et();$p();g1();Be();Qye();Xye=function(){var t=s0(),r=a0(),n=d0(function(l){return Co(l,!0)},function(l){return GC(l,!0)},t,r),o=i0(),a=UG(),d=MG(n,o),c=LG(d),u=function(p,g){var h,x=n(p,g),y=x.thread.length?x.thread[0].commentId:(h=g.resource)===null||h===void 0?void 0:h.id,T=g.componentTree.componentTreeId.renderContextType,b=void 0;switch(T){case A.FullPane:b={renderMode:se.TaskPaneItem};break;case A.DiscreteIntegrated:b={renderMode:se.Integrated};break;case A.DiscreteIsolated:y&&(b={renderMode:se.Isolated,threadId:y});break;case A.HalfPane:case A.None:v().assertConditionTag(!1,"Invalid RenderContextType for HostableComponent received.",593822914);break;default:Ne(T)}var S=jme(p,b);return{isResourceAvailable:c(p,g),modelCapabilities:Br(p),isDraftThread:a(p,g),isExtensionEnabled:S,threadId:y}};return u},uLe=na(Xye)($ye)});s();te();Xl();Z();Lt();var ECe=I(dn()),PCe=I(t5()),$3=I(ee());s();te();rt();Z();var y5=I(_t());tr();vs();pd();s();var g5={CommentAPIServiceModule:["Mso::Document::Comments::JS::CommentAPIServiceModule",{dispatchInterruptableCommand:["ReturnsPromiseMethod","$number",["$string",["$union",["Mso::Document::Comments::JS::DiscardDraftCommand","Mso::Document::Comments::JS::CreateCommentCommand","Mso::Document::Comments::JS::EditCommentCommand","Mso::Document::Comments::JS::ReplyCommentCommand","Mso::Document::Comments::JS::BringThreadIntoViewCommand"]]]]}]};s();var h5=I(_t());h5.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::DiscardDraftCommand":{type:"$string",mode:"$number"},"Mso::Document::Comments::JS::CreateCommentCommand":{type:"$string"},"Mso::Document::Comments::JS::EditCommentCommand":{type:"$string",commentId:"$string"},"Mso::Document::Comments::JS::ReplyCommentCommand":{type:"$string",threadId:"$string"},"Mso::Document::Comments::JS::BringThreadIntoViewCommand":{type:"$string",threadId:"$string"}});var Gy=function(){function e(){this.commandCallbacks={},this.queuedInterruptableCommands={}}return e.getInstance=function(){return this.instance},e.register=function(){var t=this;if(this.instance)throw v().assertConditionTag(!1,"Already registered an instance of CommentAPIServiceModule",593000201),new he(o5,C.reserveTag(589103751),-2130957534);this.instance=new e,y5.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return t.instance}})},e.prototype.registerForInterruptableCommands=function(t,r){this.commandCallbacks[t]&&v().assertConditionTag(!1,"DuplicateHandlerRegistration for InterruptableCommands",593000202),this.commandCallbacks[t]=r;var n=this.queuedInterruptableCommands[t];n&&n.forEach(function(o){r(o.command).then(function(a){return o.promiseValue.resolve(a)},function(){v().assertConditionTag(!1,"Failed to run queued interruptable command",570991756),o.promiseValue.resolve(He.Failed)})}),delete this.queuedInterruptableCommands[t]},e.prototype.unregisterForInterruptableCommands=function(t,r){this.commandCallbacks[t]&&this.commandCallbacks[t]===r?delete this.commandCallbacks[t]:v().assertConditionTag(!1,"Cannot unregister for a command callback that wasn't already registered",593000203)},e.prototype.dispatchInterruptableCommand=function(t,r){var n=this.commandCallbacks[t];if(n)return n(r);this.queuedInterruptableCommands[t]||(this.queuedInterruptableCommands[t]=[]);var o=new QT;return this.queuedInterruptableCommands[t].push({command:r,promiseValue:o}),o.promise},e.ServiceInfo=g5.CommentAPIServiceModule,e}();Ib();s();s();k();rt();s();Z();Ir();s();ym();var I5={themeId:1,palette:{ButtonBorder:Pe.GRAY_D,CardAccent:Pe.GRAY_B,CardBackground:Pe.WHITE,CardHoveredBackground:Pe.GRAY_20,CardDraftBoxBackgroundHovered:Pe.WHITE,CardDraftBoxBorderHovered:Pe.GRAY_160,CardDraftBoxBorder:Pe.GRAY_110,CardDraftBoxBackground_HalfPane:Pe.WHITE,CardDraftBoxBackground:Pe.WHITE,CardExpandButtonBorder:Pe.GRAY_B,CardHeroBarBackground_HalfPane:Pe.WHITE,CardHeroBarBackground:Pe.GRAY_A,CardReplyBackground_HalfPane:Pe.GRAY_A,CardReplyBackground:Pe.GRAY_A,CardReplyTopBorder:Pe.GRAY_B,CardSelectionColor:Pe.COMMENTS_PURPLE,CardShadowColor:Pe.BLACK,CardBorder:Pe.GRAY_B,CardBorderEmphasis:Pe.COMMENTS_PURPLE,CommandBarBorder:Pe.GRAY_B,CommandBarTopBorder:Pe.GRAY_B,IconButtonDisabledTint:Pe.GRAY_C,IconButtonFocusedTint:Pe.GRAY_I,NavigationBarBackground:Pe.WHITE,NavigationBarBorder:Pe.GRAY_B,PaneBackground_HalfPane:Pe.WHITE,PaneBackground:"transparent",UnreadDotColor:Pe.DOT_BLUE,UnreadDotBorderColor:Pe.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:Pe.GRAY_150,CardPlaceholderColor:Pe.GRAY_130,ResolvedCardBackground:Pe.GRAY_20}};function E5(e){return{themeId:e.themeId,palette:new Proxy(I5.palette,{get:function(r,n){return e.palette[n]?e.palette[n]:(v().assertConditionTag(Y()==="android","Theme-aware platform using unthemed color ".concat(String(n)),595338514),r[n])}})}}s();var Pb=I(_t());Pb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::Swatch":{color:"$string",value:"$string"},"Mso::Document::Comments::JS::Palette":{values:["$array","Mso::Document::Comments::JS::Swatch"]},"Mso::Document::Comments::JS::ThemeInformation":{themeId:"$number",palette:"Mso::Document::Comments::JS::Palette"}});var ive={ThemeModule:["Mso::Document::Comments::JS::ThemeModule",{onThemeChange:["Event","Mso::Document::Comments::JS::ThemeInformation"],initialThemeInformation:["Constant","Mso::Document::Comments::JS::ThemeInformation"]}]},P5={ThemeModule:Pb.RekaServiceRegistry.getNativeService(ive.ThemeModule)};var ave=function(t){return XT(t.values.map(function(r){return[r.color,r.value]}))},_5=function(t){return E5({themeId:t.themeId,palette:ave(t.palette)})},R5=function(){function e(t){t===void 0&&(t=P5.ThemeModule),this.themeModule=t,this.listeners=new Set,this.onThemeChange=this.onThemeChange.bind(this),this.currentTheme=_5(this.themeModule.initialThemeInformation),this.themeModule.onThemeChange.subscribe(this.onThemeChange)}return e.prototype.getTheme=function(){return this.currentTheme},e.prototype.registerForThemeChange=function(t){this.listeners.add(t)},e.prototype.unregisterForThemeChange=function(t){this.listeners.delete(t)},e.prototype.onThemeChange=function(t){var r,n;this.currentTheme=_5(t);try{for(var o=qe(this.listeners),a=o.next();!a.done;a=o.next()){var d=a.value;d()}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},e}();var bD;function _b(){return bD||(bD=new R5),bD}s();Cm();var AD=I(vm()),kD=I(ee());ue();function B5(){Rb({announceToScreenReader:function(t,r){var n;t&&(bm()?r&&r.nativeId?AD.AccessibilityInfo.announceForAccessibilityWithOptions(t,{queue:(n=r.queue)!==null&&n!==void 0?n:void 0,nativeID:r.nativeId}):AD.AccessibilityInfo.announceForAccessibility(t):kD.AccessibilityInfo&&kD.AccessibilityInfo.announceForAccessibility(t))}})}Ir();bc();s();k();rt();Do();var Cu=I(L());bs();s();Ru();Z();var E6=I(_t());s();var Ke;(function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"})(Ke||(Ke={}));function T6(e){return e.actionType!==void 0}function eS(e){return e.actionType===Ke.CreateThread&&e.content!==void 0}function tS(e){return e.actionType===Ke.CancelCreateThread}function rS(e){return e.actionType===Ke.StartReplySession&&e.threadId!==void 0}function nS(e){return e.actionType===Ke.CancelReplySession&&e.threadId!==void 0}function oS(e){return e.actionType===Ke.PostReply&&e.threadId!==void 0&&e.content!==void 0}function iS(e){return e.actionType===Ke.DeleteComment&&e.commentId!==void 0}function aS(e){return e.actionType===Ke.DeleteThread&&e.threadId!==void 0}function sS(e){return e.actionType===Ke.ResolveThread&&e.threadId!==void 0}function dS(e){return e.actionType===Ke.ReopenThread&&e.threadId!==void 0}function cS(e){return e.actionType===Ke.StartEditSession&&e.commentId!==void 0}function uS(e){return e.actionType===Ke.CancelEditSession&&e.commentId!==void 0}function lS(e){return e.actionType===Ke.PostEdit&&e.commentId!==void 0&&e.content!==void 0}function fS(e){return e.actionType===Ke.SelectComment&&e.commentId!==void 0}function b6(e){return e.actionType===Ke.ClosePane}function pS(e){return e.actionType===Ke.ClickGhostCard}s();var mS=I(_t());mS.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::MockUIDriverEventPayload":{apiContext:"$string",payload:"$string"}});var axe={MockUIDriverModule:["Mso::Document::Comments::JS::MockUIDriverModule",{sendTrace:["FireAndForgetMethod",["$string","$string"]],onMockUIEvent:["Event","Mso::Document::Comments::JS::MockUIDriverEventPayload"]}]},I6={MockUIDriverModule:mS.RekaServiceRegistry.getNativeService(axe.MockUIDriverModule)};var sxe=function(){function e(t){this.onMockUIAction=new E6.EventImpl(function(){}),this.onMockUIEvent=this.onMockUIEvent.bind(this),I6.MockUIDriverModule.onMockUIEvent.subscribe(vd(t,this.onMockUIEvent))}return e.prototype.onMockUIEvent=function(t){var r=JSON.parse(t.payload).payload;T6(r)?this.onMockUIAction.trigger(r):v().assertConditionTag(!1,"Malformed event: ".concat(t.payload),593376714)},e}(),Xy=sxe;Ma();ak();ag();Ld();e3();fn();pk();_A();s();k();var mc=I(L()),Age=I(ee());pr();xn();ze();s();k();Ru();te();rt();Z();bs();pd();JC();ak();Hf();Wm();hB();fv();tr();ue();un();vl();xt();Rn();s();var ps=function(){function e(t,r){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),t&&(this.mockId=t),r&&(this.mockContents=r)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}();s();var Qp=function(){function e(t){this.mockContents="",this.mockId="",t&&(this.mockId=t)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(t){this.mockContents=t},e.prototype.getId=function(){return this.mockId},e}();s();var Le;(function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"})(Le||(Le={}));var ROe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return n.pendingActionReason=Le.None,n.pendingAction=void 0,n.onMockUIAction=new sm(function(o){if(!Kt()){if(n.pendingAction){v().assertConditionTag(!1,"Action is already pending",592229779);return}switch(o.actionType){case Ke.CancelCreateThread:tS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onCancel(new ps(n.getDraftCardId()))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229780);break;case Ke.CancelEditSession:uS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentPostCallbackProps.onCancel(new Qp(o.commentId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229781);break;case Ke.CancelReplySession:nS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onCancel(new ps(o.threadId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229782);break;case Ke.ClickGhostCard:pS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.onGhostCommentClicked()}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229783);break;case Ke.ClosePane:b6(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.closePane()}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229784);break;case Ke.CreateThread:eS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onPost(new ps(n.getDraftCardId(),o.content),eo.CommitButton)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229785);break;case Ke.DeleteComment:iS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentPostCallbackProps.onDelete(o.commentId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229786);break;case Ke.DeleteThread:aS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onDeleteThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229787);break;case Ke.PostEdit:if(lS(o)){var a=new Qp(o.commentId);a.setContents(o.content),n.runAction(o,Le.NeedDrafting,function(){return n.commentPostCallbackProps.onCommit(a,eo.CommitButton)})}else v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229788);break;case Ke.PostReply:oS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onPost(new ps(o.threadId,o.content),eo.CommitButton)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229789);break;case Ke.ReopenThread:dS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onReopenThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229790);break;case Ke.ResolveThread:sS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onResolveThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229791);break;case Ke.SelectComment:fS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.onRenderableItemSelect(new Qp(o.commentId),!1)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229792);break;case Ke.StartEditSession:cS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentPostCallbackProps.onEdit(o.commentId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229793);break;case Ke.StartReplySession:rS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentCardCallbackProps.onEditorPress(new ps(o.threadId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229794);break;default:Ne(o.actionType)}}}),n.onCardLayout=void 0,n.state=m({actionHistory:[]},n.getInitialState(r)),n}return t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.registrationToken=this.props.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),this.props.pendingCommentLoad===void 0&&this.onMockUIAction.startProcessing()},t.prototype.componentWillUnmount=function(){var r;e.prototype.componentWillUnmount.call(this),(r=this.registrationToken)===null||r===void 0||r.unsubscribe()},t.prototype.componentDidUpdate=function(r,n){e.prototype.componentDidUpdate.call(this,r,n),!this.onMockUIAction.isProcessingEvents&&!this.props.pendingCommentLoad&&this.onMockUIAction.startProcessing();var o=lr(this.props.draftState);!o&&this.pendingActionReason===Le.NeedNotDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=Le.None);var a=$o(this.props.draftState),d=$o(r.draftState);a&&!d&&this.pendingActionReason===Le.NeedDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=Le.None)},t.prototype.onDrafting=function(r){$o(this.props.draftState)?r():(this.pendingAction=r,this.pendingActionReason=Le.NeedDrafting)},t.prototype.onNotDrafting=function(r){lr(this.props.draftState)?(this.pendingAction=r,this.pendingActionReason=Le.NeedNotDrafting):r()},t.prototype.runAction=function(r,n,o){var a=this,d={action:r,pendingState:n};this.setState({actionHistory:w(w([],j(this.state.actionHistory),!1),[d],!1)},function(){var c=function(){o();var l=a.state.actionHistory.indexOf(d);if(l<0)v().assertConditionTag(!1,"Entry doesnt exist in history",592229778);else{var p=a.state.actionHistory.slice();p.splice(l,1,{action:p[l].action,pendingState:Le.None}),a.setState({actionHistory:p})}};switch(n){case Le.NeedDrafting:return a.onDrafting(c);case Le.NeedNotDrafting:return a.onNotDrafting(c);case Le.None:return o()}})},t.prototype.getDraftCardId=function(){var r=qa(this.props.draftState);if(!r)throw new he("Expected draft card",C.reserveTag(572846421),-2130957492);return r},t.prototype.render=function(){return this.renderInner()},t.prototype.getMentionableCommentEditorProps=function(r){},t.prototype.onContextChanged=function(){this.props.initializationStatus===Xn.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)},t.prototype.invokeModalDialog=function(r,n,o){var a={renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:Kk,telemetryVisitor:this.props.telemetryVisitor};switch(r){case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:return this.props.discardDraftAsync(a,ce.SharedComments,!1);case ur.DeleteThread:return this.props.selectedComment&&this.props.requestDeleteThread(a,this.props.selectedComment.selectedCardId),Promise.resolve(He.Handled);case ur.ClosePaneDraft:return this.closePane(),Promise.resolve(He.Handled);default:Ne(r)}},t.prototype.getCreateCommentInitialHeight=function(){return 0},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:zi.AllCardsTabbable,postTabbingMode:Gi.AllPostsTabbable}},t.prototype.showDiscardDialog=function(){return Promise.resolve(!1)},t.prototype.isNewCommentButtonDisabled=function(){return!1},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.getContentExtraPaddingLeft=function(){},t.prototype.getContentExtraPaddingRight=function(){},t.prototype.getAvailableScreenHeight=function(){},t.prototype.getMaxDraftHeight=function(){},t.prototype.getContentBackgroundColor=function(r,n){},t.prototype.getCommentCardStyle=function(){},t.prototype.getPinnedCardIndex_deprecated=function(){},t.prototype.scrollToThreadById=function(r){return!1},t}(Gp),_ge=ROe,t3={focus:function(){},blur:function(){}},AOe=function(t){return{isFocusOn:function(){return!1},isFocusWithin:function(){return!1},isFocusOnOrWithin:function(){return!1},isEventTarget:function(){return!1},isFocusWithinAny:function(){return!1},isFocusWithinPane:function(){return!1},getComponent:function(){return t3},getComponentById:function(){return t3},getCurrentlyFocused:function(){return[t3]},componentTreeId:{renderContextType:t,contextIdentifier:Cd}}};function kOe(){var e=FB();return function(t){var r=e(t);return r.componentTree=AOe(t.paneState.componentTree.componentTreeId.renderContextType),r}}var Rge=na(kOe,ol,void 0,{forwardRef:!0});var DOe=function(e){X(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.renderActionHistory=function(){return this.state.actionHistory.length===0?mc.createElement(Ve,null,"No Actions Received"):this.state.actionHistory.map(function(r,n){return mc.createElement(J,{key:n,style:vr},mc.createElement(Ve,null,"Action: ",r.action.actionType),mc.createElement(Ve,null,r.pendingState===Le.None?"Done":"Pending: ".concat(Le[r.pendingState])))})},t.prototype.renderInner=function(){return mc.createElement(J,{testID:"MockCommentPaneRoot",style:vr},mc.createElement(Ve,null,"MockCommentPane"),mc.createElement(Ve,null,"Items: ",this.props.dataItems.length),mc.createElement(Ve,null,"History"),mc.createElement(Age.ScrollView,{style:vr},this.renderActionHistory()))},t}(_ge),wOe=Rge(DOe),kge=wOe;ue();s();_d();te();Z();Md();s();s();var mk=I(_t());mk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::CodeMarkerPayload":{context:"$string",type:"$number",assertTag:"$number"},"Mso::Document::Comments::JS::StartEventPayload":{context:"$string",correlationId:"$string",useMockMode:"$boolean"},"Mso::Document::Comments::JS::StopEventPayload":{context:"$string"}});var FOe={APIContextEventService:["Mso::Document::Comments::JS::APIContextEventService",{sendCodeMarker:["FireAndForgetMethod",["Mso::Document::Comments::JS::CodeMarkerPayload"]],onStartEvent:["Event","Mso::Document::Comments::JS::StartEventPayload"],onStopEvent:["Event","Mso::Document::Comments::JS::StopEventPayload"]}]},Dge={APIContextEventService:mk.RekaServiceRegistry.getNativeService(FOe.APIContextEventService)};s();s();var Ty;(function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"})(Ty||(Ty={}));var NT=Dge.APIContextEventService;xw();Ma();ag();tr();ue();var OOe=function(){function e(t,r){var n=this;this.commentViewManager=t,this.correlationId=r,this.visit=function(o){o.attachContext(n.commentViewManager.apiContext),n.correlationId&&o.addDataField("InstanceCorrelationId",n.correlationId,N.SystemMetadata)}}return e}();function wge(e){return new OOe(Fge(e),e.correlationId)}var NOe=function(){throw new Error("ViewManagerFactory not set")},Fge=NOe;function Oge(e){Fge=e}var MOe=function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(t){var r=this;return this.instanceMap.get(t)||{visit:function(o){var a=r.instanceMap.get(t);if(!a){o.attachContext(t),o.addDataField("MissingInstanceTelemetry",!0,N.SystemMetadata);return}a.visit(o)}}},e.prototype.closeViewManager=function(t){var r=this.instanceMap.get(t);r&&(r.commentViewManager.teardown(),this.instanceMap.delete(t))},e.prototype.disposeViewManager=function(){var t=this;this.instanceMap.forEach(function(r,n){Lf(n),t.closeViewManager(n)})},e.prototype.doesViewManagerExist=function(t){return this.instanceMap.has(t)},e.prototype.ensureViewManager=function(t){var r=t.apiContext,n=t.displayMode,o=t.contentNavigationAPIMockSettings,a=t.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var d=this.instanceMap.get(r);return d?this.updateInstanceObject(d,n):(this.initializeContentNavigationAPI(r,o),this.initializeContentFilteredRangeAPI(r,a),d=wge(t),this.instanceMap.set(r,d)),d.commentViewManager},e.prototype.getCorrelationId=function(t){var r=this.instanceMap.get(t);return r&&r.correlationId},e.prototype.getStore=function(t){var r=this.instanceMap.get(t);if(!r)throw new he("Instance is not initialized",C.reserveTag(589103622),-2130957512);return r.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(t){var r=this.tryGetViewManager(t);if(!r)throw new he("Instance is not initialized",C.reserveTag(589103623),-2130957512);return r},e.prototype.tryGetViewManager=function(t){var r;return(r=this.instanceMap.get(t))===null||r===void 0?void 0:r.commentViewManager},e.prototype.ensureInitialized=function(){var t=this;Oi()&&NT.onStartEvent.subscribe(function(r){t.initializeContentNavigationAPI(r.context,void 0),t.initializeContentFilteredRangeAPI(r.context,void 0),t.initializeViewManager(r.context,r.correlationId,r.useMockMode)}),NT.onStopEvent.subscribe(function(r){t.closeViewManager(r.context),Lf(r.context)}),this.initialized=!0},e.prototype.initializeViewManager=function(t,r,n){var o=this.instanceMap.get(t);if(o)o.correlationId=r;else{var a=void 0;n&&Kt()&&(v().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(t),{diagnosticLevel:qn.FullEvent}).successTag(592511450),a=new Xy(t)),this.instanceMap.set(t,wge({apiContext:t,correlationId:r,initializationReason:Ms.PaneOpen,displayMode:cn.FullPane,foldableLayoutState:_s.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:a}))}},e.prototype.updateInstanceObject=function(t,r){var n=t.commentViewManager.viewProvider;n.getViewContainer().containerType!==r&&n.changeViewContainerType(r)},e.prototype.initializeContentNavigationAPI=function(t,r){if(!al(t)){if(r){r.useMock&&Mf(r.mock,t);return}var n=new dg(t);n.isAPIEnabled()&&Mf(n,t)}},e.prototype.initializeContentFilteredRangeAPI=function(t,r){if(!Um(t)){if(r){r.useMock&&IC(t,r.mock);return}IC(t,new SC(t))}},e}(),LOe=new MOe,Sn=LOe;var HOe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;n.createTelemetryContext=et(PA);var o=r.initializationReason||Ms.PaneOpen,a=Sn.tryGetViewManager(r.apiContext);if(!a){var d=r.useMockCommentPane&&Kt();a=Sn.ensureViewManager({apiContext:r.apiContext,displayMode:r.displayMode||cn.FullPane,foldableLayoutState:r.foldableLayoutState,initializationReason:o,correlationId:r.correlationId,paneVisible:o!==Ms.InitRuntime,initializeImmediately:!0,mockDriver:d?new Xy(r.apiContext):void 0})}return n._containerProps={commentAPI:a.commentAPI,peopleAPI:a.peopleAPI,localizationAPI:a.localizationAPI,focusManager:a.getFocusManager(),selectionManager:a.getSelectionManager(),initializationReason:a.getInitializationReason(),registerComponentUIActionListener:a.registerComponentUIActionListener,unregisterComponentUIActionListener:a.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:a.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:a.unregisterComponentInterruptableCommandListener,resource:{id:"CommentPane"},telemetryVisitor:Sn.getTelemetryVisitor(n.props.apiContext),correlationId:Sn.getCorrelationId(n.props.apiContext)||ao(),lppManager:a.lppManager,createOrUpdateFilter:a.createOrUpdateFilter,onInitialRender:zn(a.onInitialRender)},fK(J7(r.displayClass)),n.props.useMockCommentPane&&(n._mockUIDriver_deprecated=new Xy(n.props.apiContext)),n}return t.prototype.componentWillUnmount=function(){Oi()||Sn.closeViewManager(this.props.apiContext)},t.prototype.render=function(){var r=Sn.getStore(this.props.apiContext),n;!Kt()&&this._mockUIDriver_deprecated?n=Cu.createElement(kge,m({},this._containerProps,{mockUIDriver:this._mockUIDriver_deprecated})):Kt()?n=Cu.createElement(ZB,m({},this._containerProps,{extensionRenderMode:se.Integrated,themeAPI:Sn.getViewManager(this.props.apiContext).themeAPI})):n=Cu.createElement(OB,m({},this._containerProps));var o=n;return Kt()||(o=Cu.createElement(vy,{api:Sn.getViewManager(this.props.apiContext).themeAPI},n)),Cu.createElement(af,{store:r},Cu.createElement(ny.Provider,{value:this.createTelemetryContext(Sn.getTelemetryVisitor(this.props.apiContext))},o))},t}(Cu.Component),Nge=HOe;ue();s();jF();var Mge={name:"OfficeSharedComments",version:EE};s();_d();Md();s();k();te();rt();tr();ue();hn();s();k();te();tr();vs();ue();Au();Cw();var Lge=function(){function e(t,r,n,o,a){var d=this;this.hostCommentAPI=t,this.author=r,this._anchorHintText=n,this.sessionConfiguration=o,this._insertIndex=a,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(c){c.draftId===d.sessionConfiguration.draftId&&(c.anchorHintText&&(d._anchorHintText=c.anchorHintText),c.insertIndex!==void 0&&(d._insertIndex=c.insertIndex))},this.handleCommentEvents=function(c,u){c===De.CommentContextChanged&&Is(u)&&u.contextDrafts?u.contextDrafts.forEach(function(l){return d.updateDraft(l)}):c===De.UpdateDraftThread&&uf(u)&&d.updateDraft(u)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(t,r){this._propertiesToUpdate[t]=m({},r)},e.prototype.commit=function(t){if(!this.hostCommentAPI.commit)throw new he(d5,C.reserveTag(589103689),-2130957526);if(!this._active)throw new he(p5,C.reserveTag(589103690),-2130957525);var r=at()||lo(),n=r&&this.sessionConfiguration.sessionType===Ec;if(t===void 0&&!n||n&&t!==void 0)throw new he(fd,C.reserveTag(589103691),-2130957507);return r?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,t,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,t)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}();var gk=function(){function e(t){this.hostCommentAPI=t,this.loadThreads=t.loadThreads.bind(t),this.deleteComment=t.deleteComment.bind(t),this.selectComment=t.selectComment.bind(t),this.highlightComment=t.highlightComment.bind(t),this.setThreadResolvedState=t.setThreadResolvedState.bind(t),this.selectFirstThreadInNextCommentContext=t.selectFirstThreadInNextCommentContext.bind(t),this.selectLastThreadInPreviousCommentContext=t.selectLastThreadInPreviousCommentContext.bind(t),this.registerForCommentEvents=t.registerForCommentEvents.bind(t),this.unregisterForCommentEvents=t.unregisterForCommentEvents.bind(t),this.registerForAction=t.registerForAction.bind(t),this.unregisterForAction=t.unregisterForAction.bind(t),this.checkAtMentionCapability=t.checkAtMentionCapability.bind(t),t.getCommentReactionData&&(this.getCommentReactionData=t.getCommentReactionData.bind(t)),qy()&&(this.presentLinkToComment=t.presentLinkToComment.bind(t)),t.registerForInterruptableCommands&&(this.registerForInterruptableCommands=t.registerForInterruptableCommands.bind(t)),t.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=t.unregisterForInterruptableCommands.bind(t)),t.onClickableTextClicked&&(this.onClickableTextClicked=t.onClickableTextClicked.bind(t))}return e.prototype.beginDraftingAsync=function(t){var r=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new he("Drafting APIs are undefined on Host Comment API",C.reserveTag(589103700),-2130957527);var n=ao(),o=m(m({},t),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(o).then(function(a){var d=new Lge(r.hostCommentAPI,L6(a),a.anchorHintText,a.updatedDraftSessionConfiguration||o,a.insertIndex);return d})},e}();s();s();k();Ru();te();rt();Z();tr();s();function BOe(e){switch(e){case-2130958286:return"Missing CommentsModelContext";default:return""}}function Hge(e){if(typeof e=="string")try{var t=JSON.parse(e);if(!(t instanceof Array)||t.length!==1)return;var r=parseInt(t[0]);return isNaN(r)?void 0:{message:BOe(r),SDXHostAPIErrorCode:r,name:""}}catch(n){return}}ue();ui();s();var hk=I(_t());hk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::SetThreadResolvedStateArgs":{threadId:"$string",isResolved:"$boolean"},"Mso::Document::Comments::JS::InitializeResult":{modelCapabilityFlags:"$number",richTextCapabilityFlags:"$number"},"Mso::Document::Comments::JS::CommitDraftArgs":{draftId:"$string",commentBody:["$optional","$string"],propertyUpdates:["opt-field","Mso::Document::Tasks::JS::HostUpdatableProperties"]}});var UOe={CommentAPI:["Mso::Document::Comments::JS::CommentAPI",{initialize:["ReturnsPromiseMethod","Mso::Document::Comments::JS::InitializeResult",["$string"]],beginDraftingAsync:["ReturnsPromiseMethod","Mso::Document::Comments::JS::BeginDraftingHostResult",["$string",["$union",["Mso::Document::Comments::JS::CreateDraftSessionConfiguration","Mso::Document::Comments::JS::ReplyDraftSessionConfiguration","Mso::Document::Comments::JS::EditDraftSessionConfiguration","Mso::Document::Comments::JS::UpdateMetadataSessionConfiguration"]]]],commit:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::CommitDraftArgs"]],endCommentSession:["FireAndForgetMethod",["$string","$string"]],loadThreads:["FireAndForgetMethod",["$string",["$array","$string"]]],deleteComment:["FireAndForgetMethod",["$string","$string"]],selectComment:["FireAndForgetMethod",["$string","$string"]],highlightComment:["FireAndForgetMethod",["$string","$string"]],setThreadResolvedState:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::SetThreadResolvedStateArgs"]],selectFirstThreadInNextCommentContext:["FireAndForgetMethod",["$string"]],selectLastThreadInPreviousCommentContext:["FireAndForgetMethod",["$string"]],checkAtMentionCapability:["ReturnsPromiseMethod","$boolean",["$string"]],presentLinkToComment:["FireAndForgetMethod",["$string","$string"]],getCommentReactionData:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::CommentReactionData"],["$string","$string","$number"]],onNativeEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onUIAction:["Event","$number"],onModelEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onError:["Event","$number"]}]},Go={CommentAPI:hk.RekaServiceRegistry.getNativeService(UOe.CommentAPI)};function VOe(e){if(e){var t=e.Resolve,r=e.Task?{type:"Task",assignee:e.Task.assignee,updatedState:{title:e.Task.title,schedule:e.Task.schedule,priority:e.Task.priority,completion:e.Task.completion}}:void 0,n=e.Reaction?{type:"Reaction",reactionType:e.Reaction.reactionType,isActive:e.Reaction.isActive}:void 0;return{Resolve:t,Task:r,Reaction:n}}}var Uge=function(){function e(t,r){var n=this;if(this.observer=t,this.apiContext=r,!Go.CommentAPI)throw new he("CommentAPI unavailable",C.reserveTag(589103701),-2130957557);Go.CommentAPI.initialize(this.apiContext).then(function(o){var a,d,c={modelCapabilityFlags:o.modelCapabilityFlags,richTextCapabilityFlags:o.richTextCapabilityFlags};n.observer.onEvent.invoke(De.ModelCapabilitiesChanged,c),n.observer.enableEvents(),(d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(Bge||(Bge=qt(["CommentsInitialized"],["CommentsInitialized"]))),C.reserveTag(529105745),St.Info,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary))}).catch(function(o){if(Fi(o))v().assertConditionTag(!1,o.message,591209547);else{var a=Hge(o);if(a&&a.SDXHostAPIErrorCode===-2130958286)return;v().assertConditionTag(!1,"Unknown error in CommentAPIModuleImpl constructor ".concat(a),591209548)}})}return e.prototype.beginDraftingAsync=function(t){return Go.CommentAPI.beginDraftingAsync(this.apiContext,t)},e.prototype.commit=function(t,r,n){return Go.CommentAPI.commit(this.apiContext,{draftId:t,commentBody:r,propertyUpdates:at()||lo()?VOe(n):void 0}),t},e.prototype.endCommentSession=function(t){Go.CommentAPI.endCommentSession(this.apiContext,t)},e.prototype.loadThreads=function(t){Go.CommentAPI.loadThreads(this.apiContext,t)},e.prototype.deleteComment=function(t){Go.CommentAPI.deleteComment(this.apiContext,t)},e.prototype.selectComment=function(t){Go.CommentAPI.selectComment(this.apiContext,t)},e.prototype.highlightComment=function(t){Go.CommentAPI.highlightComment(this.apiContext,t)},e.prototype.setThreadResolvedState=function(t,r){Go.CommentAPI.setThreadResolvedState(this.apiContext,{threadId:t,isResolved:r})},e.prototype.selectFirstThreadInNextCommentContext=function(){Go.CommentAPI.selectFirstThreadInNextCommentContext(this.apiContext)},e.prototype.selectLastThreadInPreviousCommentContext=function(){Go.CommentAPI.selectLastThreadInPreviousCommentContext(this.apiContext)},e.prototype.checkAtMentionCapability=function(){return Go.CommentAPI.checkAtMentionCapability(this.apiContext)},e.prototype.presentLinkToComment=function(t){Go.CommentAPI.presentLinkToComment(this.apiContext,t)},e.prototype.onClickableTextClicked=function(t){v().assertConditionTag(!1,"onClickableTextClicked is not implemented for native",509658816)},e.prototype.getCommentReactionData=function(t,r){return Go.CommentAPI.getCommentReactionData(this.apiContext,t,r)},e.prototype.registerForCommentEvents=function(t){this.ensureEmitterRegistered(),this.observer.onEvent.add(t)},e.prototype.unregisterForCommentEvents=function(t){this.observer.onEvent.remove(t)},e.prototype.registerForAction=function(t,r){this.ensureEmitterRegistered(),this.observer.onAction.add(t,r)},e.prototype.unregisterForAction=function(t){this.observer.onAction.removeAll(t)},e.prototype.registerForInterruptableCommands=function(t){var r=Gy.getInstance();r?r.registerForInterruptableCommands(this.apiContext,t):v().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209549)},e.prototype.unregisterForInterruptableCommands=function(t){var r=Gy.getInstance();r?r.unregisterForInterruptableCommands(this.apiContext,t):v().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209550)},e.prototype.ensureEmitterRegistered=function(){this.eventSubscription===void 0&&(this.eventSubscription=Go.CommentAPI.onNativeEvent.subscribe(vd(this.apiContext,this.observer.processEvent)))},e}();var Bge;s();Z();s();s();k();var MT=function(){function e(){this._listeners=[]}return e.prototype.add=function(t){this._listeners.push(t)},e.prototype.remove=function(t){var r=this._listeners.indexOf(t);r>=-1&&this._listeners.splice(r,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var r=this;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];r._listeners.forEach(function(a){return a.apply(void 0,w([],j(n),!1))})}},enumerable:!1,configurable:!0}),e}();var Vge=MT;var jge=function(){function e(){this._listeners={}}return e.prototype.add=function(t,r){this.on(t).add(r)},e.prototype.removeAll=function(t){delete this._listeners[t]},e.prototype.on=function(t){return this._listeners[t]||(this._listeners[t]=new MT),this._listeners[t]},e}();ui();_m();s();function Wge(e){return e.type==="Event"}function zge(e){return e.type==="Action"}s();k();s();ui();Es();function jOe(e){var t="Event",r=De.CommentContextChanged,n=e;return Is(n)?{type:t,eventType:r,payload:{numberOfComments:n.numberOfComments,numberOfThreads:n.numberOfThreads,newNextPopulatedContextDetails:n.newNextPopulatedContextDetails,contextDetails:n.contextDetails,contextDrafts:n.contextDrafts,selectedThreadIndex:n.selectedThreadIndex}}:{type:t,eventType:r}}var Gge=jOe;s();k();te();Z();ue();ui();di();s();k();function Vl(e){var t=e.date;return m(m({},e),{date:t?new Date(t):void 0})}s();k();te();tr();s();var WOe=I(_t()),qge=function(){function e(t){this.time=t}return e.isInstanceOf=function(t){return typeof t=="object"&&typeof t.time=="number"},e}();yw();function by(e){return{id:e.id,commentId:e.commentId,currentState:e.currentState,history:GOe(e.id,e.history)}}function zOe(e){return qge.isInstanceOf(e)?new Date(e.time):e}function GOe(e,t){return t.map(function(r){return{commentId:r.commentId,taskId:e,records:r.records.map(function(n){return qOe(n)})}})}function qOe(e){var t={time:zOe(e.details.time),displayTime:e.details.displayTime,user:e.details.user,recordId:e.details.recordId,isLossy:e.details.isLossy};switch(e.type){case"Assign":return gc(e,m({type:sr.Assign,assignee:e.assignee},t));case"Create":return gc(e,m({type:sr.Create},t));case"Delete":return gc(e,m({type:sr.Delete},t));case"Priority":return gc(e,m({type:sr.Priority,priority:e.priority},t));case"Progress":return gc(e,m({type:sr.Progress,completion:e.completion},t));case"Restore":return gc(e,m({type:sr.Restore},t));case"Schedule":return gc(e,m({type:sr.Schedule,schedule:e.schedule},t));case"SetTitle":return gc(e,m({type:sr.SetTitle,title:e.title},t));case"Unassign":return gc(e,m({type:sr.Unassign,assignee:e.assignee},t));case"UnassignAll":return gc(e,m({type:sr.UnassignAll},t));case"Undo":throw new he("Should not receive undo history record type",C.reserveTag(589103697),-2130957497);case"Unknown":throw new he("Unknown history record type",C.reserveTag(589103698),-2130957498)}}function gc(e,t){return t}function Kge(e){return e.type==="CommentContextReload"}function Yge(e){return e.changes!==void 0}function KOe(e){var t="Event",r=De.CommentContextReload;if(!Kge(e))return{type:t,eventType:r};if(e.numberOfComments===void 0){v().assertConditionTag(Yge(e)&&e.changes.length===0,"transformCommentContextReload called with changes and without numberOfComments in the event payload",570728577);return}var n=[],o=[],a,d=function(){var l=[{type:t,eventType:r,payload:m({contextDetails:e.contextDetails,comments:n},at()?{tasks:o}:{})}];return a&&l.push({type:"Event",eventType:De.CommentSelected,payload:{commentId:a}}),l};if(!e.numberOfComments)return d();var c=function u(l){if(!Kge(l)){Gn(!1,"Non-context reload payload passed in!",C.reserveTag(576583251));return}return Yge(l)&&(at()?l.changes.forEach(function(p){p.tempId&&yr(p.model)&&(v().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677090),a=p.model.commentId),n.push(Vl(p.model)),p.task&&o.push(by(p.task))}):n.push.apply(n,w([],j(l.changes.map(function(p){return p.tempId&&yr(p.model)&&(v().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677091),a=p.model.commentId),Vl(p.model)})),!1))),n.length===e.numberOfComments?d():u};return c}var $ge=KOe;s();ui();function YOe(e){return e.type==="CommentHighlighted"}function $Oe(e){var t="Event";return YOe(e)?{type:t,eventType:De.CommentHighlighted,payload:{commentId:e.commentId}}:{type:t,eventType:De.CommentHighlighted}}var Qge=$Oe;s();ui();function QOe(e){return e.type==="CommentSelected"}function XOe(e){var t="Event";return QOe(e)?{type:t,eventType:De.CommentSelected,payload:{commentId:e.commentId,selectionReason:e.selectionReason}}:{type:t,eventType:De.CommentSelected}}var Xge=XOe;s();k();ue();sf();ui();gw();function JOe(e){return e.type==="CommentsChanged"}function ZOe(e){var t=Zy(e.type),r=e.tempId,n,o;return nC(t)&&(e.model&&(n=Vl(e.model)),at()&&e.task&&(o=by(e.task))),m(m(m({type:t,index:e.index},r?{tempId:r}:{}),n?{model:n}:{}),o?{task:o}:{})}function eNe(e){var t="Event",r=De.CommentsChanged;if(!JOe(e))return{type:t,eventType:r};var n=e.changes.map(ZOe);return{type:t,eventType:r,payload:{changes:n,contextDetails:e.contextDetails}}}var Jge=eNe;s();k();ue();ui();function tNe(e){return e.type==="CommentsLoaded"}function rNe(e){return!!e.threads}function nNe(e){var t="Event",r=De.LoadComments;if(!tNe(e))return{type:t,eventType:r};if(rNe(e)){var n=e.threads;return{type:t,eventType:r,payload:{threads:n}}}var o,a=[];return at()?(o=[],e.changes.forEach(function(d){o.push(Vl(d.model)),d.task&&a.push(by(d.task))})):o=e.changes.map(function(d){return Vl(d.model)}),{type:t,eventType:r,payload:m({comments:o},at()?{tasks:a}:{})}}var Zge=nNe;s();k();function oNe(e){return!!e.contextDetails}function iNe(e){if(!oNe(e))return e;var t={nextPopulatedContextDetails:e.contextDetails.nextPopulatedContextDetails,commentThreadCounts:e.contextDetails.commentThreadCounts,isReadOnly:!!e.contextDetails.isReadOnly,topVisibleThreadId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.topVisibleThreadId:void 0,selectedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.selectedCommentId:void 0,highlightedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.highlightedCommentId:void 0};return m(m({},e),{contextDetails:t})}var ehe=iNe;s();ui();function aNe(e){return e.type==="ModelCapabilitiesChanged"}function sNe(e){var t="Event";return aNe(e)?{type:t,eventType:De.ModelCapabilitiesChanged,payload:e}:{type:t,eventType:De.ModelCapabilitiesChanged}}var the=sNe;s();Au();function dNe(e){return e.type==="ReturnToDraftRequested"}function cNe(e){var t="Event";return dNe(e)?{type:t,eventType:De.ReturnToDraftRequested,payload:{draftId:e.draftId}}:{type:t,eventType:De.ReturnToDraftRequested}}var rhe=cNe;s();Jy();function uNe(e){return e.type==="UIAction"}function lNe(e){var t="Action";if(!uNe(e))return{type:t,actionType:void 0};var r=e.action;return{type:"Action",actionType:r,payload:{actionBehavior:ci.Execute,actionType:r}}}var nhe=lNe;s();Au();function fNe(e){return e.type==="UpdateDraftThread"}function pNe(e){var t="Event";return fNe(e)?{type:t,eventType:De.UpdateDraftThread,payload:{draftId:e.draftId,anchorHintText:e.anchorHintText,insertIndex:e.insertIndex}}:{type:t,eventType:De.UpdateDraftThread}}var ohe=pNe;function r3(e){return typeof e=="function"}function ihe(e){return typeof e!="function"}function mNe(e){var t,r,n={};try{for(var o=qe(Object.keys(e)),a=o.next();!a.done;a=o.next()){var d=a.value;n[d]=e[d]===null?void 0:e[d]}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}function ahe(e,t){var r=ehe(mNe(t));switch(e){case"CommentContextChanged":return Gge(r);case"CommentContextReload":return $ge(r);case"CommentsLoaded":return Zge(r);case"CommentsChanged":return Jge(r);case"CommentSelected":return Xge(r);case"CommentHighlighted":return Qge(r);case"ModelCapabilitiesChanged":return the(r);case"ReturnToDraftRequested":return rhe(r);case"UIAction":return nhe(r);case"UpdateDraftThread":return ohe(r);default:return}}var she=function(){function e(t){this.telemetryVisitor=t,this._commentListeners=new MT,this._actionListeners=new jge,this._aggregateEventCallbacks={},this.processEvent=this.processEvent.bind(this),this._eventQueue=[]}return Object.defineProperty(e.prototype,"onEvent",{get:function(){return this._commentListeners},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onAction",{get:function(){return this._actionListeners},enumerable:!1,configurable:!0}),e.prototype.invokeAction=function(t){t.payload!==void 0&&t.actionType!==void 0?this.onAction.on(t.actionType).invoke(t.payload):v().assertConditionTag(!1,"Invalid '".concat(t.actionType?Yt[t.actionType]:"unknown","' action payload"),591677120)},e.prototype.invokeEvent=function(t){v().assertConditionTag(t.payload!==void 0,"Invalid '".concat(De[t.eventType],"' event payload"),591677121),t.payload&&this.onEvent.invoke(t.eventType,t.payload)},e.prototype.dispatch=function(t){var r=this,n=t.constructor===Array?t:[t];return n.reduce(function(o,a){return Wge(a)?(r.invokeEvent(a),o):zge(a)?(r.invokeAction(a),o):!1},!0)},e.prototype.enableEvents=function(){if(this._eventQueue){var t=this._eventQueue;this._eventQueue=void 0,t.forEach(this.processEvent)}},e.prototype.processEvent=function(t){if(this._eventQueue){this._eventQueue.push(t);return}var r=v().createActivityObject("ProcessNativeEvent",this.telemetryVisitor,be()),n;try{n=JSON.parse(t.payload)}catch(a){a instanceof Error&&r.addDataField("ExceptionType",a.name,N.SystemMetadata),r.failTag(591677122,-2130957568);return}r.addDataField("EventType",n.type,N.SystemMetadata);var o=this._aggregateEventCallbacks[n.type];if(o?r3(o)?o=o(n):(v().assertConditionTag(r3(o),"invalid data in event aggregate",591677123),delete this._aggregateEventCallbacks[n.type],o=void 0):o=ahe(n.type,n),!o){r.failTag(591677124,-2130957567);return}if(ihe(o)){if(delete this._aggregateEventCallbacks[n.type],!this.dispatch(o)){r.failTag(591677125,-2130957566);return}}else this._aggregateEventCallbacks[n.type]=o;r.successTag(591677126)},e}();function dhe(e){var t=Sn.getTelemetryVisitor(e),r=new she(t),n=new Uge(r,e),o=new gk(n);return o}Ib();s();Ru();te();bd();s();var yk=I(_t());yk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::GrantUsersAccessResponse":{OperationResult:"$number"},"Mso::Document::Comments::JS::SuggestionsDetailsChange":{apiContext:"$string",suggestionsDetails:"Mso::Document::Comments::JS::SuggestionsDetails"}});var gNe={PeopleModule:["Mso::Document::Comments::JS::PeopleModule",{checkUserAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::UserPermissions",["$string","Mso::Document::Comments::JS::IUser"]],grantUsersAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::GrantUsersAccessResponse",["$string",["$array","Mso::Document::Comments::JS::IUser"]]],getCurrentUserId:["ReturnsPromiseMethod","$string",["$string"]],getSuggestionsDetails:["ReturnsPromiseMethod","Mso::Document::Comments::JS::SuggestionsDetails",["$string"]],onSuggestionsDetailsChange:["Event","Mso::Document::Comments::JS::SuggestionsDetailsChange"]}]},che={PeopleModule:yk.RekaServiceRegistry.getNativeService(gNe.PeopleModule)};Z();var HT=I(fhe());Cn();tr();Mc();var o3="Microsoft.Office.Docs.ModernComments",vNe=function(){function e(t){this.apiContext=t,this.suggestionsDetailsListeners=[],this.eventSubscription=void 0,this.capabilities=La.GetAuthToken|La.GetSuggestionsDetails,this.getPersonaIconPropertiesArray=void 0}return e.prototype.checkUserAccess=function(t){return this.getModule().checkUserAccess(this.apiContext,t)},e.prototype.grantUsersAccess=function(t){return this.getModule().grantUsersAccess(this.apiContext,t)},e.prototype.getContactsForMentions=function(t,r,n){return Promise.reject(new he("Not implemented on native",C.reserveTag(589103651),-2130957557))},e.prototype.getAuthToken=function(t){var r=this,n=v().createActivityObject("PeopleAPIGetAuthToken",Sn.getTelemetryVisitor(this.apiContext),be());return n.addDataField("ServiceId",t,N.SystemMetadata),this.getCurrentUserId().then(function(o){return r.getTokenForUserId(o,t,n)},function(o){return Fi(o)?(n.failTag(595957842,ln(o)),Promise.reject(o)):(Ay(o),n.failTag(592492748,-2130957547),Promise.reject(new he("Uncaught error",C.reserveTag(589103680),-2130957547)))})},e.prototype.getModule=function(){return che.PeopleModule},e.prototype.getCurrentUserId=function(){return this.getModule().getCurrentUserId(this.apiContext).catch(function(t){return Promise.reject(new he("getCurrentUserId() failed",C.reserveTag(589103681),-2130957547))})},e.sanitizeIdentityErrorMessage=function(t){switch(t){case"error config token":case"unexpected error":return t;default:return/^error\:\-?\d+$/.test(t)?t:"Unknown error"}},e.prototype.getTokenForUserId=function(t,r,n){var o={UserName:t,CorrelationId:o3},a;switch(r){case Td.Loki:a=HT.NativeServices.NativeGetLokiToken.QueryToken(o);break;case Td.MSGraph:a=HT.NativeServices.NativeGetMSGraphToken.QueryToken(o);break;default:return n.failTag(595952132,-2130957547),Promise.reject(new he("Unrecognized service",C.reserveTag(589103682),-2130957547))}return a.then(function(d){var c=d.AuthToken,u=d.ErrorMessage;return n.addDataField("AuthDataError",e.sanitizeIdentityErrorMessage(u),N.SystemMetadata),d.OperationResult?c?(n.successTag(592492751),Promise.resolve(c)):(n.failTag(592492750,-2130957546),Promise.reject(new he("Auth token empty",C.reserveTag(589103684),-2130957546))):(n.failTag(592492749,-2130957547),Promise.reject(new he("OperationResult false",C.reserveTag(589103683),-2130957547)))},function(d){return n.failTag(592492752,-2130957547),Promise.reject(new he("Identity QueryToken() failed",C.reserveTag(589103685),-2130957547))})},e.prototype.getSuggestionsDetails=function(){return this.getModule().getSuggestionsDetails(this.apiContext)},e.prototype.registerForSuggestionsDetailsChanges=function(t){var r=this;this.eventSubscription||(this.eventSubscription=this.getModule().onSuggestionsDetailsChange.subscribe(vd(this.apiContext,function(n){r.suggestionsDetailsListeners.forEach(function(o){return o(n.suggestionsDetails)})}))),this.suggestionsDetailsListeners.push(t)},e.prototype.unregisterForSuggestionsDetailsChanges=function(t){var r=this.suggestionsDetailsListeners.indexOf(t);r>-1&&this.suggestionsDetailsListeners.splice(r,1),this.suggestionsDetailsListeners.length===0&&this.eventSubscription&&(this.eventSubscription.unsubscribe(),this.eventSubscription=void 0)},e.prototype.getLokiUrl=function(){var t=this;return this.getCurrentUserId().then(function(r){return t.getLokiUrlCore(r)})},e.prototype.getLokiUrlCore=function(t){var r={UserName:t,CorrelationId:o3};return HT.NativeServices.NativeGetLokiUrl.QueryLokiUrl(r).catch(function(n){return pe(C.reserveTag(554783041))(n),Promise.reject(new he("Identity GetLokiUrl() failed",C.reserveTag(560214533),-2130957487))})},e.prototype.getTenantId=function(){var t=this;return this.getCurrentUserId().then(function(r){return t.getTenantIdCore(r)})},e.prototype.getTenantIdCore=function(t){var r={UserName:t,CorrelationId:o3};return HT.NativeServices.NativeGetTenantId.QueryTenantId(r).catch(function(n){return pe(C.reserveTag(554783042))(n),Promise.reject(new he("Identity GetTenantId() failed",C.reserveTag(560214534),-2130957486))})},e}();function phe(e){return new vNe(e)}s();s();k();te();SS();Ma();s();var mhe=function(){function e(){var t=this;this.changedEvent=new Vge,this.fireEvent=function(r){t.changedEvent.invoke(r)}}return e.prototype.registerForViewContainerEvents=function(t){this.changedEvent.add(t)},e.prototype.unregisterForViewContainerEvents=function(t){this.changedEvent.remove(t)},e}();s();var i3=function(){function e(t,r,n){this.viewContainerBase=t,this.containerType=t.containerType,this.onReadyToRender=t.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(t)),this.invokeModalConfirmationDialog=t.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(t)),this.setDisplayConfiguration=t.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(t)),this.closeView=t.closeView.bind(t),this.identifier=t.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}();s();k();Ma();s();Ma();var xNe=function(){function e(t){this._moduleAPI=t,this.containerType=cn.FullPane}return e.prototype.openView=function(){this._moduleAPI.showView()},e.prototype.closeView=function(){this._moduleAPI.closeView()},e.prototype.onReadyToRender=function(){this._moduleAPI.onReadyToRender()},e.prototype.moveFocusToCanvas_donotuse=function(){this._moduleAPI.moveFocusToCanvas_donotuse()},e}(),Ck=xNe;var TNe=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.containerType=cn.FullPane,r}return t}(Ck),ghe=TNe;s();k();Xl();Z();Mu();Ma();var bNe=function(){function e(t,r){this._moduleAPI=t,this._details=r,this._activity=void 0,this._promise=void 0}return e.prototype.run=function(){var t=this;return this._promise?this._promise:(this._activity=v().createActivityObject("SetHalfPaneDisplayMode",Ct(ft.Todo,3304490),be()),this._activity.addDataField("DisplayMode",this._details.displayMode,N.SystemMetadata),this._promise=this._moduleAPI.setHalfPaneDisplayMode(this._details).then(function(){if(t._activity)return t._activity.successTag(595932617),t._activity=void 0,t._details},function(){t._activity&&(t._activity.failTag(595932619,-2130957524),t._activity=void 0)}),this._promise)},e.prototype.markReplaced=function(){this._activity&&(this._activity.failTag(595932616,-2130957523),this._activity=void 0)},e.prototype.getDetails=function(){return this._details},e}(),SNe=function(e){X(t,e);function t(){var r=e.apply(this,w([],j(arguments),!1))||this;return r.containerType=cn.HalfPane,r._pendingDisplayConfigChange=void 0,r}return t.prototype.setDisplayConfiguration=function(r){var n=this;return this._pendingDisplayConfigChange&&!ff(this._pendingDisplayConfigChange.getDetails(),r)&&(this._pendingDisplayConfigChange.markReplaced(),this._pendingDisplayConfigChange=void 0),this._pendingDisplayConfigChange||(this._pendingDisplayConfigChange=new bNe(this._moduleAPI,r)),this._pendingDisplayConfigChange.run().then(function(){if(n._pendingDisplayConfigChange&&ff(n._pendingDisplayConfigChange.getDetails(),r)){var o=n._pendingDisplayConfigChange.getDetails();return n._pendingDisplayConfigChange=void 0,o}},function(){n._pendingDisplayConfigChange&&ff(n._pendingDisplayConfigChange.getDetails(),r)&&(n._pendingDisplayConfigChange=void 0)})},t}(Ck),hhe=SNe;s();Ru();ue();s();var yhe=I(_t());s();var Sy;(function(e){e[e.HalfPane=0]="HalfPane",e[e.FullPane=1]="FullPane"})(Sy||(Sy={}));yhe.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerNativeEventBase":{apiContext:"$string"},"Mso::Document::Comments::JS::ViewContainerChangedNativeEvent":{type:"$string",apiContext:"$string",newDisplayMode:"$number"},"Mso::Document::Comments::JS::FocusTriggeredNativeEvent":{type:"$string",apiContext:"$string",shouldFocus:"$boolean"},"Mso::Document::Comments::JS::VisibilityChangedNativeEvent":{type:"$string",apiContext:"$string",viewContainerVisibilityState:"$number"},"Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent":{type:"$string",apiContext:"$string",newFoldableLayoutState:"$number"}});s();var vk=I(_t());vk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerEventPayload":{apiContext:"$string",payload:"$string"}});var INe={ViewContainerModule:["Mso::Document::Comments::JS::ViewContainerModule",{setHalfPaneDisplayMode:["ReturnsPromiseMethod","$any",["$string","$string"]],closeView:["FireAndForgetMethod",["$string"]],showView:["FireAndForgetMethod",["$string"]],onReadyToRender:["FireAndForgetMethod",["$string"]],moveFocusToCanvas_donotuse:["FireAndForgetMethod",["$string"]],onEvent:["Event",["$union",["Mso::Document::Comments::JS::ViewContainerChangedNativeEvent","Mso::Document::Comments::JS::FocusTriggeredNativeEvent","Mso::Document::Comments::JS::VisibilityChangedNativeEvent","Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent"]]],onDisplayModeChange:["Event","Mso::Document::Comments::JS::ViewContainerEventPayload"]}]},Xp={ViewContainerModule:vk.RekaServiceRegistry.getNativeService(INe.ViewContainerModule)};var Che=function(){function e(t){this.apiContext=t}return e.prototype.setHalfPaneDisplayMode=function(t){return Xp.ViewContainerModule.setHalfPaneDisplayMode(this.apiContext,JSON.stringify([t]))},e.prototype.showView=function(){Oi()&&Xp.ViewContainerModule.showView(this.apiContext)},e.prototype.closeView=function(){Xp.ViewContainerModule.closeView(this.apiContext)},e.prototype.onReadyToRender=function(){Xp.ViewContainerModule.onReadyToRender(this.apiContext)},e.prototype.onEvent=function(t){Xp.ViewContainerModule.onEvent.subscribe(vd(this.apiContext,t))},e.prototype.moveFocusToCanvas_donotuse=function(){Xp.ViewContainerModule.moveFocusToCanvas_donotuse(this.apiContext)},e}();function ENe(e){switch(e){case Sy.FullPane:return cn.FullPane;case Sy.HalfPane:return cn.HalfPane;default:Ne(e)}}var PNe=function(e){X(t,e);function t(r,n,o,a){var d=e.call(this)||this;return d.processEvent=function(c){switch(c.type){case"ViewContainerChanged":{d.changeViewContainerType(ENe(c.newDisplayMode));break}case"FocusTriggered":{d.fireEvent({eventType:li.FocusTriggered});break}case"VisibilityChanged":{d.fireEvent({eventType:li.VisibilityChanged,viewContainerVisibilityState:c.viewContainerVisibilityState});break}case"FoldableLayoutStateChanged":{d.fireEvent({eventType:li.FoldableLayoutStateChanged,newFoldableLayoutState:c.newFoldableLayoutState});break}default:Ne(c)}},d._apiContext=r,d._moduleAPI=new Che(r),d._moduleAPI.onEvent(d.processEvent),d._foldableLayoutState=o,d.updateForNewViewContainerType(n),d}return t.prototype.getViewContainer=function(){return Gn(this._currentContainer,"Container must be set prior to querying it.",C.reserveTag(576583252)),this._currentContainer},t.prototype.changeViewContainerType=function(r){this.updateForNewViewContainerType(r),this.fireEvent({eventType:li.ViewContainerChanged,newViewContainer:this._currentContainer})},t.prototype.updateForNewViewContainerType=function(r){switch(r){case cn.FullPane:this._currentContainer=new i3(new ghe(this._moduleAPI),this._apiContext,this);break;case cn.HalfPane:this._currentContainer=new i3(new hhe(this._moduleAPI),this._apiContext,this),this._currentContainer.foldableLayoutState=this._foldableLayoutState;break}},t}(mhe),vhe=PNe;function xhe(e,t,r,n){return new vhe(e,t,r,n)}s();k();te();rt();Z();Do();Md();Lt();Mu();bc();tr();ue();Cr();un();Fd();NC();xt();Wu();Rn();ho();Et();Ui();vo();mo();Od();Rd();s();var Di;(function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"})(Di||(Di={}));Be();Ff();Ir();gi();s();s();var Ao;(function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"})(Ao||(Ao={}));function The(e){return e.type===Ao.DispatchAction&&e.action!==void 0}function sd(e,t){return{type:Ao.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}s();k();function xk(e){return e.type===Ao.FocusComponent&&e.component!==void 0}function sn(e,t,r){return r===void 0&&(r={priorityArgs:{priority:1}}),m({type:Ao.FocusComponent,component:t,causedBy:e},r)}s();te();bc();s();te();Z();bc();Ti();s();function a3(e,t,r){if(!t)return r;if(!r)return t;var n={type:Ao.Compound,priorityArgs:{priority:1},first:t,then:r,causedBy:e};return n}function bhe(e){return e.type===Ao.Compound&&e.first!==void 0&&e.then!==void 0}function _Ne(e){return e.priorityArgs.priority!==1&&e.priorityArgs.phase!==0}function RNe(e,t,r){return t?(mn&&Pt("Calling focus for componentType: ".concat(e.component.componentType)),r(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),Di.Handled):_Ne(e)?Di.ShouldRetry:Di.ComponentNotFound}function Wl(e,t,r,n){if(!e)return Di.NoCommand;var o=Di.Handled;if(xk(e)){var a=e.component;o=RNe(e,Nd(a)?t.getComponentById(a):t.getComponent(a.componentType),n)}else if(The(e))r.dispatch(e.action);else if(bhe(e)){var d=Wl(e.first,t,r,n),c=Wl(e.then,t,r,n);v().assertConditionTag(d!==Di.ShouldRetry&&c!==Di.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),o}var She=50;function Ihe(e,t){var r=function n(o,a,d,c,u){if(!t||!o||t.indexOf(o.type)===-1||o.priorityArgs.priority===3){o&&(t==null?void 0:t.indexOf(o.type))!==-1&&(mn&&(o==null?void 0:o.type)===Ao.FocusComponent&&Pt("Executing non-debounced focus command ".concat(JSON.stringify(o))),n.pendingCommand!==void 0&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),c(o,Wl(o,a,d,u));return}n.pendingCommand!==void 0&&clearTimeout(n.pendingCommand),mn&&o.type===Ao.FocusComponent&&Pt("Caching debounced command ".concat(JSON.stringify(o))),n.pendingCommand=setTimeout(function(){mn&&o.type===Ao.FocusComponent&&Pt("Executing debounced command ".concat(JSON.stringify(o))),c(o,Wl(o,a,d,u)),n.pendingCommand=void 0},e)};return r.pendingCommand=void 0,r}Qa();s();Ti();function s3(e,t){return!!(Nd(t)?e.getComponentById(t):e.getComponent(t.componentType))}s();Z();ue();Et();Ui();Be();Ir();gi();Ti();function kNe(e){return!(Y()==="win32"||Y()==="web"&&xm()||!$t(e))}function DNe(e,t){if(kNe(e.componentTreeId.renderContextType)){var r=e.getComponent(Q.ClosePaneButton);if(!r){v().assertConditionTag(!1,"cannot find close button on platform where we should be able to find it",579086371);return}return sn(void 0,{componentType:Q.ClosePaneButton},{priorityArgs:t})}}function wNe(e,t,r){if(!(!Iu()||e.componentTreeId.renderContextType!==A.FullPane)){var n=t.getState(),o=Br(n).newThread;if(o){var a=e.getComponent(Q.NewCommentButton);if(!a){v().assertConditionTag(!1,"cannot find new comment button, but its enabled",579086400);return}return sn(void 0,{componentType:Q.NewCommentButton},{priorityArgs:r})}}}function FNe(e,t,r){if(!(!Da()||e.componentTreeId.renderContextType!==A.FullPane)){var n=t.getState(),o=or(n);if(o){var a=e.getComponent(Q.FilterButton);if(!a){v().assertConditionTag(!1,"cannot find filter button in full pane with filtering enabled",507339343);return}return sn(void 0,{componentType:Q.FilterButton},{priorityArgs:r})}}}function ONe(e){if(Y()!=="web")return sn(void 0,{componentType:Q.CommentsList},{priorityArgs:e})}function Tk(e,t,r){var n,o,a;if(r===void 0&&(r={priority:1}),!$t(e.componentTreeId.renderContextType)){v().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157);return}var d=(a=(o=(n=wNe(e,t,r))!==null&&n!==void 0?n:FNe(e,t,r))!==null&&o!==void 0?o:DNe(e,r))!==null&&a!==void 0?a:ONe(r);if(d)return d;v().assertConditionTag(!1,"Couldn't find a focus target",576337158)}Fv();s();k();Lt();bN();function dd(e,t,r,n,o){var a=function(u){for(var l=[],p=1;p<arguments.length;p++)l[p-1]=arguments[p];return n.apply(void 0,w([u],j(l),!1))},d=function(u){for(var l=[],p=1;p<arguments.length;p++)l[p-1]=arguments[p];var g=a.apply(void 0,w([u],j(l),!1));o(g,u,e(),t,r)};return d.processCommand=a,d}function bk(e,t,r,n,o){var a=function(p,g){var h=j(g),x=h[0],y=h.slice(1),T=x();o(d.apply(void 0,w([UJ(p),T],j(y),!1)),T,e(),function(){},function(){})},d=function(p,g){for(var h=[],x=2;x<arguments.length;x++)h[x-2]=arguments[x];if(r(g)){var y=fm(Cc(p.key),t),T=n[ne[y]];if(T)return T.handler.apply(T,w([p,g],j(h),!1))}},c=Object.keys(n).map(function(l){return{key:l,eventPhase:n[l].phase}}),u=function(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];return{onKeyDown:function(x){return a(x,p)},getKeyDownEvents:function(){return c}}};return u.processEvent=d,u}Ti();c0();s();te();Z();Do();Md();Pc();s();Au();di();var d3=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.model=t,this.startPostIndex=r,this.pointer=0,this.ignoreResolvedThreads=!1,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(t){if(this.model[this.pointer]){var r=$e(this.model[this.pointer]);return t&&t.commentId===r?t:this.model.find(function(n){return n.commentId===r})}},e.prototype.next=function(){var t=this.pointer,r;if(this.pointer<this.model.length-1)if(!this.ignoreResolvedThreads)++this.pointer;else do++this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer<this.model.length&&r&&r.commentFlags&Fe.Resolved);return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer,r;if(this.pointer>0)if(!this.ignoreResolvedThreads)--this.pointer;else do--this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer>-1&&r&&r.commentFlags&Fe.Resolved);return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();_I();di();Mi();ue();Cr();un();Fd();xt();ho();Et();vo();mo();Od();Be();Ff();Qo();s();Ic();_f();Qo();var c3=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.items=t,this.startItemIndex=r,this.ignoreResolvedThreads=n,this.pointer=0,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r}return e.prototype.getRootCommentForCurrentElement=function(t){if(this.items[this.pointer]){var r=Fo(this.items[this.pointer]);if(t&&t.commentId===r)return t;for(var n=this.pointer;n>=0;--n){var o=this.items[n];if(Pr(o)&&o.commentModel.commentId===r)return o.commentModel}for(var n=this.pointer+1;n<this.items.length;++n){var o=this.items[n];if(Pr(o)&&o.commentModel.commentId===r)return o.commentModel}}},e.prototype.next=function(){var t=this.pointer,r;if(this.pointer<this.items.length-1)if(!this.ignoreResolvedThreads)++this.pointer;else do++this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer<this.items.length&&r&&r.commentFlags&Fe.Resolved);return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer,r;if(this.pointer>0)if(!this.ignoreResolvedThreads)--this.pointer;else do--this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer>-1&&r&&r.commentFlags&Fe.Resolved);return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();Ti();var Sk=function(){function e(t,r,n){this.commentStore=t,this.telemetryVisitor=r,this.useContentNavigationAPI=n}return e.prototype.selectThreadInCurrentContext=function(t,r,n,o,a){return sd(t,yn(r,n,void 0,o?Ee.ExpandCard:Ee.SelectCard,a))},e.prototype.collapseThreadInCurrentContext=function(t,r,n){return sd(t,Dm(r,n))},e.prototype.selectPost=function(t,r,n,o,a){return sd(t,yn(r,n,o,Ee.SelectPost,a))},e.prototype.selectFirstThreadInCurrentContext=function(t,r,n,o,a){if(!ir()&&nt()){var d=Co(this.commentStore.getState(),!0,o),c=Je(fe(this.commentStore.getState()),!0,o);if(c&&d&&d.flatIndex===0)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var u=void 0,l=a?kn(this.commentStore.getState()):yi(this.commentStore.getState());if(nr(l))u=a?new PI(l,Ft(this.commentStore.getState()),-1).next().value:l[0];else{var p=void 0;if(a){var g=new Uu(l,-1,a);p=g.next().value}else p=l[0];u=p==null?void 0:p.commentId}if(u)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},u,r,n)},e.prototype.selectLastThreadInCurrentContext=function(t,r,n,o,a){var d=Ft(this.commentStore.getState());if(!fi(d)&&nt()){var c=Co(this.commentStore.getState(),!0,o),u=Je(fe(this.commentStore.getState()),!0,o);if(u&&c&&c.flatIndex===d.length)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},u,!1,n)}var l=a?kn(this.commentStore.getState()):yi(this.commentStore.getState());if(UC(l,d,a)){var p=void 0;if(nr(l))p=a?new PI(l,d,l.length).previous().value:l[l.length-1];else{var g=new Uu(l,l.length,a),h=g.previous().value;p=h==null?void 0:h.commentId}if(!p){v().assertConditionTag(!1,"Unable to find last thread",593278812);return}return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},p,r,n)}},e.prototype.focusAndCollapseSelectedThread=function(t,r){var n=ve(this.commentStore.getState());if(n){if(nt()&&Je(fe(this.commentStore.getState()))===n.selectedCardId)return;var o=da(this.commentStore.getState());if(ua(n.selectedCardId,o,r)===At.Expanded)return a3(t,sn(t,{componentType:Q.Card,id:n.selectedCardId,renderContextType:r}),this.collapseThreadInCurrentContext(t,{renderContextType:r,trackback:C.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(t,r,n,o,a,d,c,u){var l,p=r.direction===Qt.Next?t.next():t.previous();if(nt()&&n&&o&&a.selectedCardId!==n){var g=r.direction===Qt.Next?d<o.flatIndex&&(p.done||t.currentIndex()>=o.flatIndex):d>=o.flatIndex&&(p.done||t.currentIndex()<o.flatIndex);if(g)return this.selectThreadInCurrentContext(c,{renderContextType:u,trackback:C.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,r.source)}return p.done||(l=p.value.commentId),l},e.prototype.selectNextOrPreviousThread=function(t,r,n,o,a){var d=this.commentStore.getState(),c=ve(d);if(this.useContentNavigationAPI&&(!c||o===A.DiscreteIntegrated||o===A.None&&ca(d)!==vt.Visible)){if(n!==void 0)return sd(t,nI({renderContextType:o,trackback:C.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},r.direction,r.iterableContentTypes,!!r.restrictToCurrentContext,!!r.restrictToCurrentContext,c?{contentId:c.selectedCardId,contentType:wt.CommentThread}:void 0,n));v().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var u=a?kn(this.commentStore.getState()):yi(this.commentStore.getState()),l=wd(d).nextPopulatedContextDetails,p=r.direction===Qt.Next,g=Co(d,!0,o);if(c!==void 0&&(a||wf(this.commentStore.getState(),c.selectedCardId))){var h=Je(fe(d),!0,o),x=void 0;!nr(u)&&nt()&&g&&c.selectedCardId===h?x=g.flatIndex+(p?-1:0):x=this.getSelectedThreadIndex(u);var y=void 0;if(nr(u))if(a){var T=new PI(u,Ft(d),x);y=p?T.next().value:T.previous().value}else y=u[x+(p?1:-1)];else{var T=new Uu(u,x,a),b=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(T,r,h,g,c,x,t,o);if(b&&typeof b!="string")return b;y=b}if(y)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},y,r.expandCard,r.source);if(!r.restrictToCurrentContext)return this.selectAcrossContexts(t,r,o,l,a)}else{if(UC(a?kn(this.commentStore.getState()):yi(this.commentStore.getState()),Ft(d),a)||!ir()&&nt()&&g)return this.selectFirstThreadInCurrentContext(t,r.expandCard,r.source,o,a);if(!r.restrictToCurrentContext&&l!==jt.NoComments)return this.selectAcrossContexts(t,r,o,l,a)}},e.prototype.selectAcrossContexts=function(t,r,n,o,a){return this.useContentNavigationAPI&&!Oo(this.commentStore.getState())&&v().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),r.direction===Qt.Next?o===jt.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(t,r.expandCard,r.source,n,a):sd(t,oI({renderContextType:n,trackback:C.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):o===jt.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(t,r.expandCard,r.source,n,a):sd(t,iI({renderContextType:n,trackback:C.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(t,r,n){var o=ve(this.commentStore.getState());if(o===void 0){v().assertConditionTag(!1,"Expected selectedComment",593278853);return}if(!at()){var a=Ft(this.commentStore.getState()),d=this.getSelectedIndex(),c=void 0,u=void 0;if(fi(a)){var h=Yn(this.commentStore.getState())[o.selectedCardId];h&&d<h.length-1&&(c=o.selectedCardId,u=h[d+1])}else{var l=new d3(a,d),p=l.next(),g=a[d];!p.done&&p.value.parentId&&p.value.parentId===$e(g)&&(c=p.value.parentId,u=p.value.commentId)}return c&&u?this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},c,u,ce.SharedComments):void 0}if(!n){v().assertConditionTag(!1,"renderableItems must not be undefined",593278855);return}var x=this.getSelectedIndexFromRenderableItems(n);if(x<0){v().assertConditionTag(!1,"Selection not found in renderableItems",571777352);return}var y=new c3(n,x),T=y.next(),b=n[x],S=Fo(b);if(!T.done&&Fo(T.value)===S)return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},Fo(T.value),yo(T.value),ce.SharedComments)},e.prototype.selectPreviousPostWithinCard=function(t,r,n){var o=ve(this.commentStore.getState());if(o===void 0){v().assertConditionTag(!1,"Expected selectedComment",593278857);return}if(!at()){var a=Ft(this.commentStore.getState()),d=this.getSelectedIndex(),c=void 0,u=void 0;if(fi(a)){var h=Yn(this.commentStore.getState())[o.selectedCardId];h&&d>0&&(c=o.selectedCardId,u=h[d-1])}else{var l=a[d];if(l.parentId){var p=new d3(a,d),g=p.previous();!g.done&&$e(g.value)===l.parentId&&(c=$e(g.value),u=g.value.commentId)}}return c&&u?this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},c,u,ce.SharedComments):void 0}if(!n){v().assertConditionTag(!1,"renderableItems must not be undefined",593278859);return}var x=this.getSelectedIndexFromRenderableItems(n);if(x<0){v().assertConditionTag(!1,"Selection not found in renderableItems",571777353);return}var y=n[x],T=VC(y);if(T){var p=new c3(n,x),g=p.previous();if(!g.done&&Fo(g.value)===T)return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},Fo(g.value),yo(g.value),ce.SharedComments)}},e.prototype.selectRootPostOfSelectedThread=function(t,r){var n=ve(this.commentStore.getState());if(n&&!Xe(n.selectionDetails))return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,ce.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(t,r){if(!(r<0)){var n=yi(this.commentStore.getState()),o=nr(n)?n:n.filter(function(c){return!c.parentId});if(o.length!==0&&!(r===0&&o.length===1)){var a;r>o.length?(v().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),a=o.length-1):r>=1?a=r-1:a=r+1;var d=nr(o)?o[a]:o[a].commentId;return a3(void 0,sn(void 0,{componentType:Q.Card,id:d,renderContextType:t}),sd(void 0,yn({renderContextType:t,trackback:C.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},d,void 0,Ee.SelectCard,ce.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var t=this.commentStore.getState();return zW(Ft(t),Yn(t),ve(t))},e.prototype.getSelectedThreadIndex=function(t){return WW(t,ve(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(t){var r=ve(this.commentStore.getState());if(!r)return-1;var n=pi(r);return t.findIndex(function(o){return yo(o)===n})},e}();var Ehe=15e3,NNe=500,_he=function(){function e(t,r){var n=this;this.isRTL=t,this.telemetryVisitor=r,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=Ihe(She,[Ao.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(o){var a=o?nl(o):"";n.pendingOnComponentFocusedRequest&&(a===""||a!==nl(n.pendingOnComponentFocusedRequest.targetedComponent))&&(mn&&Pt("Pending component focused request cleared."),clearTimeout(n.pendingOnComponentFocusedRequest.token),n.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(o){n.clearPendingOnComponentFocusedRequest(o)},this.commandExecuteCallback=function(o,a){!o||!xk(o)||(a===Di.ShouldRetry?n.focusToRetry={command:o,timestamp:Date.now()}:a===Di.Handled&&(n.focusToRetry=void 0))},this.commentContentsKeyDown=bk(function(){return n.commentStore},this.isRTL,function(o){var a=fe(n.commentStore.getState());if(nt()){var d=qa(a);if(d&&o.isFocusOnOrWithin({componentType:Q.CardEditor,id:d,renderContextType:a.drafts[a.cardIdToDraftIdMap[d]].renderContextType}))return!1;var c=ws(a);if(c&&o.isFocusOnOrWithin({componentType:Q.PostEditor,id:c,renderContextType:a.drafts[a.postIdToDraftIdMap[c]].renderContextType}))return!1}else if(Yo(a))return!1;return!o.isFocusOn({componentType:Q.GhostCard})},{ArrowDown:{handler:function(a,d,c){var u=n.onDownKey(a,d,c?c():void 0);return u&&(u.stopPropagation=!0,u.preventDefault=!0),u},phase:we.Bubbling},ArrowUp:{handler:function(a,d,c){var u=n.onUpKey(a,d,c?c():void 0);return u&&(u.stopPropagation=!0,u.preventDefault=!0),u},phase:we.Bubbling},ArrowRight:{handler:function(a,d){if(d.componentTreeId.renderContextType!==A.HalfPane){var c=n.onRightKey(a,d);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:we.Bubbling},ArrowLeft:{handler:function(a,d){if(d.componentTreeId.renderContextType!==A.HalfPane){var c=n.onLeftKey(a,d.componentTreeId.renderContextType);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:we.Bubbling},Home:{handler:function(a,d){if(d.componentTreeId.renderContextType===A.FullPane){var c=n.selectionCommandFactory.selectFirstThreadInCurrentContext(a,!0,ce.SharedComments,d.componentTreeId.renderContextType,!1);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:we.Capturing},End:{handler:function(a,d){if(d.componentTreeId.renderContextType===A.FullPane){var c=n.selectionCommandFactory.selectLastThreadInCurrentContext(a,!0,ce.SharedComments,d.componentTreeId.renderContextType,!1);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:we.Capturing},F12:{handler:function(a,d){var c=a.altKey?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:we.None},Escape:{handler:function(a,d){var c=Y()==="win32"?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:we.None}},this.commandExecutor),this.focusCommentCardCommand=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=fe(n.commentStore.getState()),c=We(d),u=void 0;return(u=n.checkForRetryOfEditorFocus(o,d))||!nt()&&(c==null?void 0:c.threadId)===a&&(u=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,d),u)?u:sn(void 0,{componentType:Lc(a,d),id:a,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:o.componentTreeId.renderContextType===A.DiscreteIntegrated})},this.commandExecutor),this.focusCommentPostCommand=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=fe(n.commentStore.getState());if(!nt()&&d.postIdToDraftIdMap[a]){var c=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,d);if(c)return c}return sn(void 0,{componentType:Q.Post,id:a,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})},this.commandExecutor),this.focusCommentPaneCommand=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o){if(!$t(o.componentTreeId.renderContextType)){v().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242);return}var a=fe(n.commentStore.getState()),d=void 0;if(d=n.checkForRetryOfEditorFocus(o,a))return d;if(!(o.isFocusWithinPane()&&!o.isFocusOn({componentType:Q.PaneRoot}))){if(!nt()&&(d=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,a)))return d;var c=Da()?dE(sE())(n.commentStore.getState()):ve(n.commentStore.getState());if(d=n.checkForCommentSelectionFocus(o.componentTreeId.renderContextType,c,a))return d;if(!Iu()&&!o.getComponent(Q.ClosePaneButton)){var u=yi(n.commentStore.getState());if(u.length>0)return n.focusCommentCardCommand.processCommand(o,nr(u)?u[0]:u[0].commentId);v().assertConditionTag(Y()==="win32","Shouldn't be reached on current config",575239243);return}return Tk(o,n.commentStore)}},this.commandExecutor),this.commentCardMounted=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=fe(n.commentStore.getState()),c={componentType:Lc(a.id,d),id:a.id,renderContextType:o.componentTreeId.renderContextType},u=void 0;if(u=n.handleFocusRetry(o,c,d,1))return u;if(a.selected&&!o.isFocusWithin(c)){var l=$t(o.componentTreeId.renderContextType);if(!(l&&!o.isFocusWithinPane())&&(l||o.isFocusWithinAny(Q.Card)||o.isFocusWithinAny(Q.DraftCard)))return n.focusCommentCardCommand.processCommand(o,a.id)}},this.commandExecutor),this.commentCardEditorMounted=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:Q.CardEditor,id:a,renderContextType:o.componentTreeId.renderContextType},fe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPostMounted=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:Q.Post,id:a,renderContextType:o.componentTreeId.renderContextType},fe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPostEditorMounted=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:Q.PostEditor,id:a,renderContextType:o.componentTreeId.renderContextType},fe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPanePropsUpdated=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a,d){var c=void 0;if(c=n.checkForRetryCommandOnPropsUpdated(o,d.draftState,!1))return c;var u=a.draftState,l=d.draftState,p=a.selectedComment,g=d.selectedComment;if((c=n.checkForDiscard(o,u,l,p,g))||(c=n.checkForHalfPaneFullTransition(o,a,d)))return c;if(o.isFocusWithinPane())return(c=n.checkForLowFidelityWarning(o,p,g))||(c=n.checkForSelectionChange(o,l,p,g))||(c=n.checkForCardPendingChange(o,a.cardViewStates,d.cardViewStates,l))||(c=n.checkForReplyFinished(o,g,a.draftState,d.draftState,g&&d.cardViewStates[g.selectedCardId]))?c:n.checkForLowFidelityWarning(o,p,g)},this.commandExecutor),this.discreteCommentCardRootRefMounted=function(o){YK(o)},this.discreteCommentCardPropsUpdated=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a,d){var c=void 0;if((c=n.checkForRetryCommandOnDiscreteCardPropsUpdated(o,d))||(c=n.checkForDiscard(o,a.draftState,d.draftState,a.selectedState,d.selectedState)))return c;if(o.isFocusWithinAny(Q.Card)||o.isFocusWithinAny(Q.DraftCard))return n.shouldFocusFromCardPendingStateChange(a.cardState,d.cardState)?sn(void 0,{renderContextType:o.componentTreeId.renderContextType,componentType:Nf(d.isDraftThread),id:d.threadId}):(c=n.checkForLowFidelityWarning(o,a.selectedState,d.selectedState))||(c=n.checkForSelectionChange(o,d.draftState,a.selectedState,d.selectedState))||(c=n.checkForReplyFinished(o,d.selectedState,a.draftState,d.draftState,d.cardState))?c:n.checkForLowFidelityWarning(o,a.selectedState,d.selectedState)},this.commandExecutor),this.paneContainerKeyDown=bk(function(){return n.commentStore},this.isRTL,function(o){return $t(o.componentTreeId.renderContextType)?!0:(v().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)},{Escape:{handler:function(a,d){return sd(a,Hu({renderContextType:d.componentTreeId.renderContextType,trackback:C.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:we.Capturing},Tab:{handler:function(a,d){return n.paneContainerTabHandling(a,d)},phase:we.None}},this.commandExecutor),this.commentEditorKeyDown=bk(function(){return n.commentStore},this.isRTL,function(){return!0},{F12:{handler:function(a,d){var c=a.altKey?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:we.None}},this.commandExecutor),this.onUserAction=dd(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d;switch(a.userAction){case Fn.RequestNewCommentFromHost:return $t(o.componentTreeId.renderContextType)?Tk(o,n.commentStore):void 0;case Fn.CancelReplyDraft:return sn(void 0,{componentType:Q.Card,id:a.cardId,renderContextType:o.componentTreeId.renderContextType});case Fn.DeleteThread:case Fn.CancelNewThreadDraft:return!$t(o.componentTreeId.renderContextType)||o.componentTreeId.renderContextType===A.HalfPane&&a.userAction===Fn.CancelNewThreadDraft?void 0:(d=Tk(o,n.commentStore,{priority:3,phase:0}))!==null&&d!==void 0?d:n.selectionCommandFactory.focusAndSelectSiblingThread(o.componentTreeId.renderContextType,a.threadIndex);case Fn.ResolveThread:return Y()!=="android"?void 0:sn(void 0,{componentType:Q.ReopenThreadButton,id:a.cardId,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Ne(a)}},this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(t,r){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(r,NNe);this.pendingOnComponentFocusedRequest={callback:r,token:n,targetedComponent:t},mn&&Pt("Pending component focused request added for ".concat(nl(t),"."))},e.prototype.initialize=function(t,r,n){if(this._commentStore)throw new he("FocusManager already initialized",C.reserveTag(575239239),-2130957489);this._commentStore=t,this.selectionCommandFactory=n??new Sk(t,this.telemetryVisitor,r)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new he("FocusManager not initialized",C.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(t){this.draftToFocus={draftId:t,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(t,r,n,o){var a=void 0;if(a=this.checkForRetryOfEditorFocus(t,n))return a;if(!(!this.focusToRetry||!r)){var d=this.focusToRetry.command.component,c=Date.now()-this.focusToRetry.timestamp;if(c>Ehe){v().assertConditionTag(!1,"Took too long to mount component type ".concat(d.componentType," for focus retry: ").concat(c," ms"),575239241),this.focusToRetry=void 0;return}if(this.shouldRetryFocusForPhase(this.focusToRetry,o)&&A7(d,r)){var u=this.focusToRetry.command;return this.focusToRetry=void 0,u}}},e.prototype.shouldArrowNavigatePosts=function(t,r,n){return ua(t.selectedCardId,r,n.componentTreeId.renderContextType)===At.Collapsed||t.selectedCardId===Je(fe(this.commentStore.getState()))?!1:n.isFocusWithinAny(Q.Post)},e.prototype.onDownKey=function(t,r,n){var o=Kt()&&!Oo(this.commentStore.getState()),a=ve(this.commentStore.getState()),d=da(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,d,r)){if(r.componentTreeId.renderContextType===A.DiscreteIsolated)return;var c={direction:Qt.Next,source:ce.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(t,c,la.Keyboarding,r.componentTreeId.renderContextType,o)}return this.selectionCommandFactory.selectNextPostWithinCard(t,r.componentTreeId.renderContextType,n)}if(r.componentTreeId.renderContextType===A.DiscreteIsolated){v().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249);return}return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,ce.SharedComments,r.componentTreeId.renderContextType,o)},e.prototype.onUpKey=function(t,r,n){var o=Kt()&&!Oo(this.commentStore.getState()),a=ve(this.commentStore.getState()),d=da(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,d,r)){if(r.componentTreeId.renderContextType===A.DiscreteIsolated)return;var c={direction:Qt.Previous,source:ce.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(t,c,la.Keyboarding,r.componentTreeId.renderContextType,o)}return this.selectionCommandFactory.selectPreviousPostWithinCard(t,r.componentTreeId.renderContextType,n)}if(r.componentTreeId.renderContextType===A.DiscreteIsolated){v().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250);return}return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,ce.SharedComments,r.componentTreeId.renderContextType,o)},e.prototype.onRightKey=function(t,r){var n=ve(this.commentStore.getState());if(!(nt()&&n&&n.selectedCardId===Je(fe(this.commentStore.getState())))){var o=this.selectionCommandFactory.selectRootPostOfSelectedThread(t,r.componentTreeId.renderContextType);if(o||(n&&Xe(n.selectionDetails)&&r.isFocusOn({componentType:Q.Card,id:n.selectedCardId,renderContextType:r.componentTreeId.renderContextType})&&(o=this.focusCommentPostCommand.processCommand(r,n.selectionDetails.selectedPostId)),o))return o}},e.prototype.onLeftKey=function(t,r){return this.selectionCommandFactory.focusAndCollapseSelectedThread(t,r)},e.prototype.onTabKeyInPane=function(t,r){var n=ve(this.commentStore.getState());if((n===void 0||!wf(this.commentStore.getState(),n.selectedCardId))&&a7(this.commentStore.getState()))return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,ce.SharedComments,r,!1);if(!nt())return this.checkForActiveEditorFocus(t,r,fe(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var t=Dn(this.commentStore.getState());return!!t&&!t.isInCurrentContext},e.prototype.logEditorRetryError=function(t,r,n,o){var a,d,c;(d=(a=v()).logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(Phe||(Phe=qt(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),o,St.Info,ht.ProductServiceUsage,this.telemetryVisitor,Gr("RenderContextType",r.componentTreeId.renderContextType,N.SystemMetadata),Gr("IsDraftInCurrentContext",!!t&&t.isInCurrentContext,N.SystemMetadata),Gr("DraftRenderContextType",(c=t==null?void 0:t.renderContextType)!==null&&c!==void 0?c:A.None,N.SystemMetadata),Gr("ComponentType",n??0,N.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(t,r){var n=this;if(this.draftToFocus!==void 0){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:Ao.PreserveFocus,priorityArgs:{priority:1}};var o=r.drafts[this.draftToFocus.draftId],a=Date.now()-this.draftToFocus.timestamp;if(a>Ehe){v().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(a," ms, expected draft still exists: ").concat(!!o),575239251),this.draftToFocus=void 0,this.logEditorRetryError(o,t,void 0,C.reserveTag(556607431));return}if(!o||o.renderContextType!==t.componentTreeId.renderContextType){this.logEditorRetryError(o,t,void 0,C.reserveTag(556794945));return}var d=this.checkForActiveEditorFocus(void 0,t.componentTreeId.renderContextType,r,{priority:2,phase:0});if(d&&s3(t,d.component))return this.draftToFocus=m(m({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout(function(){return n.draftToFocus=void 0}),this.clearPendingOnComponentFocusedRequest(),d;this.logEditorRetryError(o,t,d==null?void 0:d.component.componentType,C.reserveTag(556794947))}},e.prototype.checkForActiveEditorFocus=function(t,r,n,o){if(o===void 0&&(o={priority:1}),!this.isDraftInOtherContext()){var a=ws(n);if(a)return sn(t,{componentType:Q.PostEditor,id:a,renderContextType:r},{priorityArgs:o});var d=qa(n);if(d)return sn(t,{componentType:Q.CardEditor,id:d,renderContextType:r},{priorityArgs:o})}},e.prototype.handleMoveFocusEvent=function(t,r){var n=ve(this.commentStore.getState()),o=n?{contentId:n==null?void 0:n.selectedCardId,contentType:wt.CommentThread}:void 0;return sd(t,GS({renderContextType:r.componentTreeId.renderContextType,trackback:C.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},o))},e.prototype.checkForCommentSelectionFocus=function(t,r,n){if(!(!nt()&&this.isDraftInOtherContext())&&r&&r.selectedCardId)return sn(void 0,{componentType:Lc(r.selectedCardId,n),id:r.selectedCardId,renderContextType:t},{priorityArgs:{priority:2,phase:1}})},e.prototype.checkForDiscard=function(t,r,n,o,a){if(Y()!=="web"&&!(!o||!a)){var d=o.selectionDetails,c=a.selectionDetails;if(FC(r)&&!Yo(n))return this.focusCommentCardCommand.processCommand(t,a.selectedCardId);if(Xe(d)===Xe(c)&&o.selectedCardId===a.selectedCardId&&$I(r,n)){if(!Xe(d)||!Xe(c))return sn(void 0,{componentType:Q.CardEditor,id:a.selectedCardId,renderContextType:t.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(d.selectedPostId===c.selectedPostId)return sn(void 0,{componentType:Q.PostEditor,id:c.selectedPostId,renderContextType:t.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(t,r){if(Y()!=="win32"){var n=this.commentStore.getState(),o=Br(n).virtualized;if(!Gu(ji(n),o,!!or(n))){var a=sn(t,{componentType:Q.ClosePaneButton});return a.stopPropagation=!0,a.preventDefault=!0,a}var d=r.getComponent(Q.ClosePaneButton),c=r.getComponent(Q.NewCommentButton),u=Da()?r.getComponent(Q.FilterButton):void 0,l=Br(n).newThread,p=Da()?or(n):void 0,g=void 0;if(Da()?g=p&&u?u:l&&c?c:d:g=!l||!c?d:c,le()){var h=ve(n),x=fe(n),a=void 0;return!h||!wf(n,h.selectedCardId)?g&&t.isEventTarget(g)&&!t.shiftKey&&(a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType)):!nt()&&!r.isFocusWithin({componentType:Lc(h.selectedCardId,x),id:h.selectedCardId,renderContextType:r.componentTreeId.renderContextType})&&(a=this.checkForActiveEditorFocus(t,r.componentTreeId.renderContextType,x)),a&&(a.stopPropagation=!0,a.preventDefault=!0),a}if(d&&t.isEventTarget(d)&&t.shiftKey){var a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType);return a&&(a.preventDefault=!0,a.stopPropagation=!0),a}if(g&&t.isEventTarget(g)&&!t.shiftKey){var a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType);return a&&(a.preventDefault=!0,a.stopPropagation=!0),a}}},e.prototype.checkForSelectionChange=function(t,r,n,o){if(o){var a=!n||pi(n)!==pi(o)||Xe(n.selectionDetails)!==Xe(o.selectionDetails);if(a&&(this.clearPendingOnComponentFocusedRequest(),!(!nt()&&lr(r))&&!(t.isFocusOn({componentType:Q.NextCommentButton})||t.isFocusOn({componentType:Q.PreviousCommentButton})))){if(!Xe(o.selectionDetails))return t.isFocusOnOrWithin({componentType:o.selectedCardId!==(n==null?void 0:n.selectedCardId)?Lc(o.selectedCardId,r):Q.CardEditor,id:o.selectedCardId,renderContextType:t.componentTreeId.renderContextType},!0)?void 0:this.focusCommentCardCommand.processCommand(t,o.selectedCardId);if(!t.isFocusOnOrWithin({componentType:Q.Post,id:o.selectionDetails.selectedPostId,renderContextType:t.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(t,o.selectionDetails.selectedPostId)}}},e.prototype.checkForReplyFinished=function(t,r,n,o,a){var d=qa(n),c=qa(o);if(!(!a||a.pending===pt.Editor)&&d&&!c&&(r==null?void 0:r.selectedCardId)===d&&t.isFocusWithin({componentType:Q.Card,id:d,renderContextType:t.componentTreeId.renderContextType}))return this.focusCommentCardCommand.processCommand(t,d)},e.prototype.checkForHalfPaneFullTransition=function(t,r,n){if(!(t.componentTreeId.renderContextType!==A.HalfPane||!Nu(n.displayConfigurationState)||n.displayConfigurationState.displayMode!==po.Normal)&&!(Nu(r.displayConfigurationState)&&r.displayConfigurationState.displayMode!==po.Variable))return sn(void 0,{componentType:Q.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(t,r){return t?t.pending!==r.pending&&r.pending!==pt.Editor:!1},e.prototype.checkForCardPendingChange=function(t,r,n,o){var a=this,d=Object.entries(n).find(function(c){var u=r[c[0]];return a.shouldFocusFromCardPendingStateChange(u,c[1])});if(d)return sn(void 0,{renderContextType:t.componentTreeId.renderContextType,componentType:Lc(d[0],o),id:d[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(t,r,n){var o=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&s3(t,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(t,o,r,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(t,r){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Nd(this.focusToRetry.command.component)||!R7(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===r.threadId),o=this.draftToFocus&&(r.cardRelativeDraftingState===cr.InCard||r.cardRelativeDraftingState===cr.InChildPost);if(!(!n&&!o))return this.checkForRetryCommandOnPropsUpdated(t,r.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(t,r,n){if(n&&(le()?Rs(n):jm(n))){var o=r?pi(r):void 0,a=pi(n);if(a!==o||n.selectionDetails.lowFidelityWarningType!==(r==null?void 0:r.selectionDetails.lowFidelityWarningType))return sn(void 0,{componentType:Q.Post,renderContextType:t.componentTreeId.renderContextType,id:a})}},e.prototype.shouldRetryFocusForPhase=function(t,r){return t.command.priorityArgs.priority!==1&&(t.command.priorityArgs.phase&r)!==0},e}();var Phe;s();k();Ol();s();function Rhe(e){var t=function(n){var o=n.dispatch,a=n.getState;return function(d){return function(c){return typeof c=="function"?c(o,a,e):d(c)}}};return t}var Ahe=Rhe();Ahe.withExtraArgument=Rhe;var khe=Ahe;s();Ol();s();s();var MNe=ee(),Dhe=MNe.unstable_batchedUpdates;var whe=function(){return function(t){return function(r){return Dhe(function(){return t(r)})}}};s();te();var Fhe=function(){return function(t){return function(r){var n=typeof r.type=="string"?r.type:r.name||"Unknown Action",o=Oy(Yl.Redux,n),a=t(r);return o==null||o.end(),a}}};s();te();Ol();Fm();s();k();te();rt();Z();s();function ms(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(o){return"'"+o+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Zp(e){return!!e&&!!e[ra]}function em(e){var t;return!!e&&(function(r){if(!r||typeof r!="object")return!1;var n=Object.getPrototypeOf(r);if(n===null)return!0;var o=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return o===Object||typeof o=="function"&&Function.toString.call(o)===zNe}(e)||Array.isArray(e)||!!e[Vhe]||!!(!((t=e.constructor)===null||t===void 0)&&t[Vhe])||v3(e)||x3(e))}function jhe(e){return Zp(e)||ms(23,e),e[ra].t}function UT(e,t,r){r===void 0&&(r=!1),Iy(e)===0?(r?Object.keys:E3)(e).forEach(function(n){r&&typeof n=="symbol"||t(n,e[n],e)}):e.forEach(function(n,o){return t(o,n,e)})}function Iy(e){var t=e[ra];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:v3(e)?2:x3(e)?3:0}function m3(e,t){return Iy(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function LNe(e,t){return Iy(e)===2?e.get(t):e[t]}function Whe(e,t,r){var n=Iy(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function HNe(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function v3(e){return jNe&&e instanceof Map}function x3(e){return WNe&&e instanceof Set}function Jp(e){return e.o||e.t}function T3(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=GNe(e);delete t[ra];for(var r=E3(t),n=0;n<r.length;n++){var o=r[n],a=t[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function b3(e,t){return t===void 0&&(t=!1),S3(e)||Zp(e)||!em(e)||(Iy(e)>1&&(e.set=e.add=e.clear=e.delete=BNe),Object.freeze(e),t&&UT(e,function(r,n){return b3(n,!0)},!0)),e}function BNe(){ms(2)}function S3(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function hc(e){var t=qNe[e];return t||ms(18,e),t}function Ohe(){return VT}function u3(e,t){t&&(hc("Patches"),e.u=[],e.s=[],e.v=t)}function Ik(e){g3(e),e.p.forEach(UNe),e.p=null}function g3(e){e===VT&&(VT=e.l)}function Nhe(e){return VT={p:[],l:VT,h:e,m:!0,_:0}}function UNe(e){var t=e[ra];t.i===0||t.i===1?t.j():t.O=!0}function l3(e,t){t._=t.p.length;var r=t.p[0],n=e!==void 0&&e!==r;return t.h.g||hc("ES5").S(t,e,n),n?(r[ra].P&&(Ik(t),ms(4)),em(e)&&(e=Ek(t,e),t.l||Pk(t,e)),t.u&&hc("Patches").M(r[ra].t,e,t.u,t.s)):e=Ek(t,r,[]),Ik(t),t.u&&t.v(t.u,t.s),e!==zhe?e:void 0}function Ek(e,t,r){if(S3(t))return t;var n=t[ra];if(!n)return UT(t,function(c,u){return Mhe(e,n,t,c,u,r)},!0),t;if(n.A!==e)return t;if(!n.P)return Pk(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=n.i===4||n.i===5?n.o=T3(n.k):n.o,a=o,d=!1;n.i===3&&(a=new Set(o),o.clear(),d=!0),UT(a,function(c,u){return Mhe(e,n,o,c,u,r,d)}),Pk(e,o,!1),r&&e.u&&hc("Patches").N(n,r,e.u,e.s)}return n.o}function Mhe(e,t,r,n,o,a,d){if(Zp(o)){var c=Ek(e,o,a&&t&&t.i!==3&&!m3(t.R,n)?a.concat(n):void 0);if(Whe(r,n,c),!Zp(c))return;e.m=!1}else d&&r.add(o);if(em(o)&&!S3(o)){if(!e.h.D&&e._<1)return;Ek(e,o),t&&t.A.l||Pk(e,o)}}function Pk(e,t,r){r===void 0&&(r=!1),!e.l&&e.h.D&&e.m&&b3(t,r)}function f3(e,t){var r=e[ra];return(r?Jp(r):e)[t]}function Lhe(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function h3(e){e.P||(e.P=!0,e.l&&h3(e.l))}function p3(e){e.o||(e.o=T3(e.t))}function y3(e,t,r){var n=v3(t)?hc("MapSet").F(t,r):x3(t)?hc("MapSet").T(t,r):e.g?function(o,a){var d=Array.isArray(o),c={i:d?1:0,A:a?a.A:Ohe(),P:!1,I:!1,R:{},l:a,t:o,k:null,o:null,j:null,C:!1},u=c,l=C3;d&&(u=[c],l=BT);var p=Proxy.revocable(u,l),g=p.revoke,h=p.proxy;return c.k=h,c.j=g,h}(t,r):hc("ES5").J(t,r);return(r?r.A:Ohe()).p.push(n),n}function VNe(e){return Zp(e)||ms(22,e),function t(r){if(!em(r))return r;var n,o=r[ra],a=Iy(r);if(o){if(!o.P&&(o.i<4||!hc("ES5").K(o)))return o.t;o.I=!0,n=Hhe(r,a),o.I=!1}else n=Hhe(r,a);return UT(n,function(d,c){o&&LNe(o.t,d)===c||Whe(n,d,t(c))}),a===3?new Set(n):n}(e)}function Hhe(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return T3(e)}var Bhe,VT,I3=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",jNe=typeof Map<"u",WNe=typeof Set<"u",Uhe=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",zhe=I3?Symbol.for("immer-nothing"):((Bhe={})["immer-nothing"]=!0,Bhe),Vhe=I3?Symbol.for("immer-draftable"):"__$immer_draftable",ra=I3?Symbol.for("immer-state"):"__$immer_state";var zNe=""+Object.prototype.constructor,E3=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,GNe=Object.getOwnPropertyDescriptors||function(e){var t={};return E3(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},qNe={},C3={get:function(t,r){if(r===ra)return t;var n=Jp(t);if(!m3(n,r))return function(a,d,c){var u,l=Lhe(d,c);return l?"value"in l?l.value:(u=l.get)===null||u===void 0?void 0:u.call(a.k):void 0}(t,n,r);var o=n[r];return t.I||!em(o)?o:o===f3(t.t,r)?(p3(t),t.o[r]=y3(t.A.h,o,t)):o},has:function(t,r){return r in Jp(t)},ownKeys:function(t){return Reflect.ownKeys(Jp(t))},set:function(t,r,n){var o=Lhe(Jp(t),r);if(o!=null&&o.set)return o.set.call(t.k,n),!0;if(!t.P){var a=f3(Jp(t),r),d=a==null?void 0:a[ra];if(d&&d.t===n)return t.o[r]=n,t.R[r]=!1,!0;if(HNe(n,a)&&(n!==void 0||m3(t.t,r)))return!0;p3(t),h3(t)}return t.o[r]===n&&(n!==void 0||r in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[r])||(t.o[r]=n,t.R[r]=!0),!0},deleteProperty:function(t,r){return f3(t.t,r)!==void 0||r in t.t?(t.R[r]=!1,p3(t),h3(t)):delete t.R[r],t.o&&delete t.o[r],!0},getOwnPropertyDescriptor:function(t,r){var n=Jp(t),o=Reflect.getOwnPropertyDescriptor(n,r);return o&&{writable:!0,configurable:t.i!==1||r!=="length",enumerable:o.enumerable,value:n[r]}},defineProperty:function(){ms(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){ms(12)}},BT={};UT(C3,function(e,t){BT[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),BT.deleteProperty=function(e,t){return BT.set.call(this,e,t,void 0)},BT.set=function(e,t,r){return C3.set.call(this,e[0],t,r,e[0])};var KNe=function(){function e(r){var n=this;this.g=Uhe,this.D=!0,this.produce=function(o,a,d){if(typeof o=="function"&&typeof a!="function"){var c=a;a=o;var u=n;return function(T){var b=this;T===void 0&&(T=c);for(var S=arguments.length,E=Array(S>1?S-1:0),P=1;P<S;P++)E[P-1]=arguments[P];return u.produce(T,function(_){var D;return(D=a).call.apply(D,[b,_].concat(E))})}}var l;if(typeof a!="function"&&ms(6),d!==void 0&&typeof d!="function"&&ms(7),em(o)){var p=Nhe(n),g=y3(n,o,void 0),h=!0;try{l=a(g),h=!1}finally{h?Ik(p):g3(p)}return typeof Promise<"u"&&l instanceof Promise?l.then(function(T){return u3(p,d),l3(T,p)},function(T){throw Ik(p),T}):(u3(p,d),l3(l,p))}if(!o||typeof o!="object"){if((l=a(o))===void 0&&(l=o),l===zhe&&(l=void 0),n.D&&b3(l,!0),d){var x=[],y=[];hc("Patches").M(o,l,x,y),d(x,y)}return l}ms(21,o)},this.produceWithPatches=function(o,a){if(typeof o=="function")return function(l){for(var p=arguments.length,g=Array(p>1?p-1:0),h=1;h<p;h++)g[h-1]=arguments[h];return n.produceWithPatches(l,function(x){return o.apply(void 0,[x].concat(g))})};var d,c,u=n.produce(o,a,function(l,p){d=l,c=p});return typeof Promise<"u"&&u instanceof Promise?u.then(function(l){return[l,d,c]}):[u,d,c]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var t=e.prototype;return t.createDraft=function(r){em(r)||ms(8),Zp(r)&&(r=VNe(r));var n=Nhe(this),o=y3(this,r,void 0);return o[ra].C=!0,g3(n),o},t.finishDraft=function(r,n){var o=r&&r[ra],a=o.A;return u3(a,n),l3(void 0,a)},t.setAutoFreeze=function(r){this.D=r},t.setUseProxies=function(r){r&&!Uhe&&ms(20),this.g=r},t.applyPatches=function(r,n){var o;for(o=n.length-1;o>=0;o--){var a=n[o];if(a.path.length===0&&a.op==="replace"){r=a.value;break}}o>-1&&(n=n.slice(o+1));var d=hc("Patches").$;return Zp(r)?d(r,n):this.produce(r,function(c){return d(c,n)})},e}(),_a=new KNe,YNe=_a.produce,nkr=_a.produceWithPatches.bind(_a),okr=_a.setAutoFreeze.bind(_a),ikr=_a.setUseProxies.bind(_a),akr=_a.applyPatches.bind(_a),skr=_a.createDraft.bind(_a),dkr=_a.finishDraft.bind(_a),jT=YNe;Ps();sf();Ic();Pc();vw();yf();di();TS();s();var Ra;(function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=512]="ContentExtensionHostingDisabled"})(Ra||(Ra={}));hn();Mi();Be();Er();Ir();rg();gi();s();k();Es();xt();mo();function _k(e,t){for(var r=t==null?void 0:t(),n=[],o=0,a=void 0;o<e.length;){if(e[o].type===cf.Thread){var d=e[o].id;a=d,n.push(P3(d,void 0,r))}else n.push(P3(e[o].id,a,r));o++}return n}function Ghe(e){return e.map(function(t){return P3(t,void 0,void 0)})}function P3(e,t,r){var n=void 0;return r&&(n=Mr(Oc(r),e)),n||m(m({},QI(e)),{parentId:t??""})}kC();s();var qhe={isRightToLeft:!1,dataCulture:"",uiCulture:""};tr();vs();ue();Cr();Fm();s();k();te();rt();Z();di();Wu();Pf();$m();xt();s();te();Z();Ic();yf();di();Pf();ho();xt();OC();function gs(e,t){var r=jhe(e);if(!r){v().assertConditionTag(!1,"immerDraft does not have original state",t);return}return r}function Rk(e,t,r){var n=!1;if(yr(t)){var o=r===void 0;if(r){var a=$Ne(e.commentThreadIds,e.cardPostIds,r);n=!!a.beforeDraft,a.insertThreadIndex>=0?e.commentThreadIds.splice(a.insertThreadIndex,0,t.commentId):(v().assertConditionTag(!1,"Invalid thread insert flat index.",512508103),o=!0)}o&&e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId]}else if(e.cardPostIds[t.parentId])if(r){var d=QNe(t.parentId,e.commentThreadIds,e.cardPostIds,r.draftIdToSkip);n=!!d.beforeDraft;var c=r.insertFlatIndex-d.flatIndex;v().assertConditionTag(c>=1&&c<=e.cardPostIds[t.parentId].length,"Invalid insert post index.",520646683),c=Math.max(Math.min(c,e.cardPostIds[t.parentId].length),1),e.cardPostIds[t.parentId].splice(c,0,t.commentId)}else e.cardPostIds[t.parentId].push(t.commentId);else{v().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);return}e.postData[t.commentId]=t,r!=null&&r.draftIdToSkip&&e.createdCommentLie&&n&&e.createdCommentLie.flatIndex++}function $Ne(e,t,r){if(r.insertFlatIndex<0)return{insertThreadIndex:-1};for(var n=r!=null&&r.draftIdToSkip?!0:void 0,o=0,a=0;a<e.length;a++){if(o===r.insertFlatIndex)return{insertThreadIndex:a,beforeDraft:n};if(e[a]===r.draftIdToSkip){n=!1;continue}if(o+=t[e[a]].length,r.insertFlatIndex<=o)return{insertThreadIndex:a+1,beforeDraft:n}}return o===r.insertFlatIndex?{insertThreadIndex:e.length,beforeDraft:n}:{insertThreadIndex:-1}}function QNe(e,t,r,n){for(var o=n?!0:void 0,a=0,d=0;d<t.length;d++){if(t[d]===e)return{flatIndex:a,beforeDraft:o};if(t[d]===n){o=!1;continue}a+=r[t[d]].length}return{flatIndex:-1}}function _3(e,t){var r=gs(e,C.reserveTag(524031042));if(r){var n,o;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(n=e.draftState.pendingDraft.threadId,!r.cardViewState[n])return;break;case"EDIT":if(o=e.draftState.pendingDraft.commentId,!r.postViewState[o])return;break;default:return}else{var a=We(e.draftState);if(!a||!a.isInCurrentContext)return;switch(a.commentDraft.sessionConfiguration.sessionType){case"REPLY":n=a.threadId;break;case"EDIT":o=a.commentDraft.sessionConfiguration.commentId;break;default:return}}n&&!e.cardViewState[n]?(Khe(e.draftState,n),ja(r.draftState,e.draftState,3,t,C.reserveTag(526242828))):o&&!e.postViewState[o]&&(Yhe(e.draftState,o),ja(r.draftState,e.draftState,2,t,C.reserveTag(526242829)))}}function Ak(e,t,r,n){var o,a,d=gs(e,C.reserveTag(524031047));if(d&&JNe(t,r)&&(e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&(Xe(e.selectedComment.selectionDetails)||e.selectedComment.selectionDetails.lowFidelityWarningType!==void 0)&&(e.selectedComment.selectionDetails=BC()),t.commentId===((o=We(e.draftState))===null||o===void 0?void 0:o.threadId)&&(XNe(e.draftState,e.postData,t.commentId),ja(d.draftState,e.draftState,1,n,C.reserveTag(526242836))),((a=d.cardViewState[t.commentId])===null||a===void 0?void 0:a.loadState.state)===st.Loaded)){var c=Ku(t.commentId,e.expandedComments,e.draftState,e.selectedComment);c!==e.expandedComments&&(e.expandedComments=c)}}function Khe(e,t){e.pendingDraft&&Nc(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var r=e.cardIdToDraftIdMap[t];r&&($he(e,r),delete e.cardIdToDraftIdMap[t])}function Yhe(e,t){e.pendingDraft&&Va(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var r=e.postIdToDraftIdMap[t];r&&($he(e,r),delete e.postIdToDraftIdMap[t])}function XNe(e,t,r){Khe(e,r);var n=ws(e);if(n){var o=e.postIdToDraftIdMap[n],a=e.drafts[o];a&&a.threadId===r&&Yhe(e,n)}if(e.pendingDraft&&Va(e.pendingDraft)){var d=e.pendingDraft.commentId,c=t[d];c&&$e(c)===r&&(e.pendingDraft=void 0)}}function $he(e,t){if(!e.drafts[t]){v().assertConditionTag(Object.keys(e.drafts).length===0,"Invalid draftId",526131554);return}v().assertConditionTag(Object.keys(e.drafts).length===1,"Invalid number of drafts",526131555),delete e.drafts[t]}function JNe(e,t){return!!(e&&e.commentFlags&Fe.Resolved&&t&&!(t.commentFlags&Fe.Resolved))}function Xhe(e,t,r){var n,o,a=r,d=t.model.parentId;if(d&&(e.cardViewState[d]?e.cardViewState[d].pending=pt.None:(o=(n=v())===null||n===void 0?void 0:n.logDiagnosticTrace)===null||o===void 0||o.call(n,Mt(Qhe||(Qhe=qt(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),C.reserveTag(520646684),St.Warning,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary))),t.tempId){if(delete e.cardViewState[t.tempId],delete e.postViewState[t.tempId],e.draftState.committedLieId===t.tempId){var c=e.commentThreadIds.findIndex(function(l){return t.tempId===l});c<0?v().assertConditionTag(!1,"ThreadId to delete not found",520646688):(e.commentThreadIds.splice(c,1),delete e.cardPostIds[t.tempId]),delete e.postData[t.tempId],e.createdCommentLie=void 0,e.draftState.committedLieId=void 0,a=void 0}if(e.selectedComment&&e.selectedComment.selectedCardId===t.tempId)if(e.selectedComment=An($e(t.model)),!t.model.parentId)e.expandedComments=Ga(e.expandedComments,e.selectedComment,e.draftState);else{var u=e.expandedComments.findIndex(function(l){return t.tempId===l});u>=0&&(e.expandedComments=Ku(t.tempId,e.expandedComments,e.draftState,e.selectedComment))}}v().assertConditionTag(!e.postViewState[t.model.commentId],"Received insert for existing comment",522856031),d||(e.cardViewState[t.model.commentId]=Ds(t.tempId||void 0)),e.postViewState[t.model.commentId]=za(t.model.displayDate),Rk(e,t.model,{insertFlatIndex:t.index,draftIdToSkip:a})}function Jhe(e,t){var r=gs(e,C.reserveTag(522856032));if(r){var n=e.postData[t.model.commentId],o=r.modelCapabilities.virtualized;if(n){e.postData[t.model.commentId]=t.model;var a=$e(t.model),d=e.cardViewState[a];d?(e.cardViewState[a].pending=pt.None,(d.loadState.state===st.Loading||!o)&&(e.cardViewState[a].loadState={state:st.Loaded})):(v().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",522856033),e.cardViewState[a]=Ds(void 0,o?st.Placeholder:void 0)),e.postViewState[t.model.commentId]?(n.displayDate!==t.model.displayDate||n.date!==t.model.date)&&(e.postViewState[t.model.commentId].displayDate=ks(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.model.commentId].pending=qr.None):e.postViewState[t.model.commentId]=za(ks(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture)),Ak(e,e.postData[t.model.commentId],n,2)}else v().assertConditionTag(!1,"change commentId not found in postData",522856034),Pt("change commentId not found in postData ".concat(t.model.commentId))}}function Zhe(e,t,r){var n,o,a,d=e.postData[t.model.commentId];if(d){var c=-1,u=0;if(yr(d))c=e.commentThreadIds.findIndex(function(h){return d.commentId===h}),c<0?v().assertConditionTag(!1,"ThreadId to delete not found",520646687):e.commentThreadIds.splice(c,1),u=(o=(n=e.cardPostIds[d.commentId])===null||n===void 0?void 0:n.length)!==null&&o!==void 0?o:0,e.cardPostIds[d.commentId].forEach(function(h){delete e.postData[h]}),delete e.cardPostIds[d.commentId];else{if(v().assertConditionTag(e.cardPostIds[d.parentId]!==void 0,"Orphaned reply delete received",520646686),c=e.commentThreadIds.findIndex(function(h){return d.parentId===h}),e.cardPostIds[d.parentId]){var l=e.cardPostIds[d.parentId].findIndex(function(h){return d.commentId===h});l<0?v().assertConditionTag(!1,"PostID to delete not found",520646685):(u=1,e.cardPostIds[d.parentId].splice(l,1))}delete e.postData[t.model.commentId]}if(r&&((a=e.createdCommentLie)===null||a===void 0?void 0:a.flatIndex)!==void 0&&c>=0){var p=e.commentThreadIds.findIndex(function(h){return h===r});c<p&&(e.createdCommentLie.flatIndex-=u)}}if(e.highlightedCommentId===t.model.commentId&&(e.highlightedCommentId=void 0),e.topVisibleThreadId===t.model.commentId&&(e.topVisibleThreadId=void 0),delete e.cardViewState[t.model.commentId],delete e.postViewState[t.model.commentId],t.model.commentId===e.selectedThreadIdBeforeCommentSession&&d){var g=e.commentThreadIds.length;g?t.index>=e.commentThreadIds.length?e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[g-1]:e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[t.index]:e.selectedThreadIdBeforeCommentSession=void 0}}var Qhe;OC();s();k();te();Z();Wu();Pf();$m();xt();function eye(e,t){var r=gs(e,C.reserveTag(523604707));if(r){var n=r.cardViewState[t];v().assertConditionTag(!n||n.pending!==pt.Delete,"Card pending delete remained after a reload.",523604736);var o=r.modelCapabilities.virtualized?st.NeedsReload:st.Loaded;if(!n)v().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=Ds(void 0,o);else{var a=n.pending!==pt.None,d=(a||r.modelCapabilities.virtualized)&&n.loadState.state!==st.Placeholder&&n.loadState.state!==o;e.cardViewState[t]=a||d?m(m({},n),{pending:pt.None}):n,d&&(e.cardViewState[t].loadState=m(m({},e.cardViewState[t].loadState),{state:o}))}}}function tye(e,t){var r=gs(e,C.reserveTag(523604738));if(r){var n=r.postViewState[t];v().assertConditionTag(!n||n.pending!==qr.Delete,"Post pending delete remained after a reload.",523604739),n?e.postViewState[t]=n.pending!==qr.None?m(m({},n),{pending:qr.None}):n:(v().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=za(void 0))}}function rye(e){var t=gs(e,C.reserveTag(523604741));if(t!=null&&t.selectedThreadIdBeforeCommentSession){var r=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);r<0&&(v().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),r=0);var n=e.commentThreadIds.length-1;e.commentThreadIds.length?(r>=e.commentThreadIds.length&&(r=n),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[r]):e.selectedThreadIdBeforeCommentSession=void 0}}function nye(e){var t=gs(e,C.reserveTag(523604706));if(!(!t||!e.createdCommentLie)){var r=Je(e.draftState,!0);if(!r||!t.createdCommentLie||!t.cardViewState[r]||t.cardViewState[r].pending!==pt.None){e.createdCommentLie=void 0;return}var n=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>n&&(e.createdCommentLie.flatIndex=n);var o=Xm(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);o>=0?(e.commentThreadIds.splice(o,0,r),e.cardPostIds[r]=[r],e.postData[r]=t.postData[r],e.cardViewState[r]=t.cardViewState[r],e.postViewState[r]=t.postViewState[r]):v().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}}xt();s();k();Z();Ps();hn();Qo();ue();xt();function k3(e,t,r,n){var o,a,d,c,u;if(at()&&r.tasks){var l=!1,p={},g={},h=new Set,x=Object.keys(e);r.comments.forEach(function(_){_.parentId===""&&h.add(_.commentId)});try{for(var y=qe(x),T=y.next();!T.done;T=y.next()){var b=T.value;if(!h.has(b)){l=!0;break}}}catch(_){o={error:_}}finally{try{T&&!T.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}x.length!==((u=r.tasks)===null||u===void 0?void 0:u.length)&&(l=!0);try{for(var S=qe(r.tasks),E=S.next();!E.done;E=S.next()){var P=E.value;l=w3(t,g,P,n)||l,p[P.commentId]=F3(P)}}catch(_){d={error:_}}finally{try{E&&!E.done&&(c=S.return)&&c.call(S)}finally{if(d)throw d.error}}if(l)return{updatedTasks:p,updatedHistoryRecordViewState:g}}}function D3(e,t,r,n){if(at()){var o=m({},e),a=m({},t),d=!1;if(r.changes.forEach(function(c){if(c.type===tt.Unknown){v().assertConditionTag(!1,"Unknown change type",554836096);return}var u=c.model.commentId;switch(c.type){case tt.Delete:if(delete o[u],e[u]!==void 0){var l=Object.keys(e);l.includes(u)&&(A3(a,e[u],void 0),d=!0)}break;case tt.Load:case tt.Insert:case tt.Modify:v().assertConditionTag(c.type===tt.Modify||!o[u],"Task should not already be populated on initial load",554836097);var p=c.task;if(p)d=w3(t,a,p,n)||d||!o[u]||!tMe(o[u].currentState,p.currentState),o[u]=F3(p);else if(c.model.parentId===""&&o[u]){var g=o[u];A3(a,g,void 0),delete o[u],d=!0}break}}),!!d)return{updatedTasks:o,updatedHistoryRecordViewState:a}}}function oye(e,t){var r,n;if(!(!e||!at())){var o={},a={};try{for(var d=qe(e),c=d.next();!c.done;c=d.next()){var u=c.value;w3({},a,u,t),o[u.commentId]=F3(u)}}catch(l){r={error:l}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return{updatedTasks:o,updatedHistoryRecordViewState:a}}}function w3(e,t,r,n){var o,a,d,c;if(r.history.length===0)return!0;var u=!1,l=e&&Object.keys(e).length>0,p=l?new Set:void 0;try{for(var g=qe(r.history),h=g.next();!h.done;h=g.next()){var x=h.value;try{for(var y=(d=void 0,qe(x.records)),T=y.next();!T.done;T=y.next()){var b=T.value;p==null||p.add(b.recordId);var S=Qu(r.id,b.recordId);e[S]?t[S]=e[S]:(u=!0,t[S]=RW(ks(b.time,b.displayTime,n.dataCulture)))}}catch(P){d={error:P}}finally{try{T&&!T.done&&(c=y.return)&&c.call(y)}finally{if(d)throw d.error}}}}catch(P){o={error:P}}finally{try{h&&!h.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(l){var E=A3(t,r,p);u=u||E}return u}function A3(e,t,r){var n,o,a,d,c=!1;try{for(var u=qe(t.history),l=u.next();!l.done;l=u.next()){var p=l.value;try{for(var g=(a=void 0,qe(p.records)),h=g.next();!h.done;h=g.next()){var x=h.value;(!r||!r.has(x.recordId))&&(delete e[Qu(t.id,x.recordId)],c=!0)}}catch(y){a={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(a)throw a.error}}}}catch(y){n={error:y}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return c}function tMe(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var r=0;r<e.assignees.length;r++)if(!M6(e.assignees[r],t.assignees[r]))return!1;return!0}function F3(e){var t,r,n,o,a=m({},e),d=[];try{for(var c=qe(e.history),u=c.next();!u.done;u=c.next()){var l=u.value,p=m({},l);p.taskId||(p.taskId=e.id);var g=[];try{for(var h=(n=void 0,qe(l.records)),x=h.next();!x.done;x=h.next()){var y=x.value;g.push(m({},y))}}catch(T){n={error:T}}finally{try{x&&!x.done&&(o=h.return)&&o.call(h)}finally{if(n)throw n.error}}p.records=g,d.push(p)}}catch(T){t={error:T}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return a.history=d,a}Wu();s();function kk(e){if(e){var t={};if(e.isReadOnly!==void 0&&(t.isReadOnly=e.isReadOnly),e.nextPopulatedContextDetails!==void 0&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),e.commentThreadCounts!==void 0&&(t.commentThreadCounts=e.commentThreadCounts||void 0),!!Object.keys(t).length)return t}}Rn();Pf();$m();ho();mo();s();k();Pc();Mi();Hf();s();k();Lt();gi();Qa();Ti();var nMe=function(){function e(t,r,n){this.componentTreeId={renderContextType:t,contextIdentifier:r},n&&EW(n.componentTreeId.renderContextType,t)?this.viewForest=new xb(n.viewForest):this.viewForest=new xb}return e.prototype.getViewForest=function(){return this.viewForest},e.prototype.getViewTrees=function(){return this.viewForest.getViewTrees()},e.prototype.getComponent=function(t){return this.viewForest.getDescendantById(Qn(t))},e.prototype.getComponentById=function(t){return this.viewForest.getDescendantById($a(t))},e.prototype.isEventTarget=function(t,r){return!1},e.prototype.isFocusWithinPane=function(){return this.isFocusWithin({componentType:Q.PaneRoot})},e.prototype.isFocusWithinAny=function(t){var r=this.getCurrentlyFocused(),n=$a({componentType:t,id:"",renderContextType:this.componentTreeId.renderContextType});return r.some(function(o){return o.getId().startsWith(n)})},e.prototype.isFocusOn=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&r.getFocusState()===ge.FocusOn},e.prototype.isFocusWithin=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&r.getFocusState()===ge.FocusWithin},e.prototype.isFocusOnOrWithin=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&(r.getFocusState()===ge.FocusOn||r.getFocusState()===ge.FocusWithin)},e.prototype.getCurrentlyFocused=function(){var t,r,n=[];try{for(var o=qe(this.getViewTrees()),a=o.next();!a.done;a=o.next()){var d=a.value,c=d.getRoot();if(c)for(var u=c.getIterator(),l=void 0;!(l=u.next()).done;)l.value.getFocusState()!==ge.Unfocused&&n.push(l.value)}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.setViewTreeRootHelper=function(t,r){this.getViewForest().getOrCreateViewTreeById(r).setRoot(t)},e.prototype.updateIdForViewTree=function(t,r){this.getViewForest().updateIdForViewTree(t,r)},e.prototype.onKeyDownTabHandlerHelper=function(t,r){return yD(this.getViewForest().getOrCreateViewTreeById(t),r)},e}(),zl=nMe;rg();ue();xt();s();k();Z();Cr();function O3(){return{extensions:{},contentNavigationSupported:!1}}function iye(e,t){switch(e===void 0&&(e=O3()),t===void 0&&(t=Kn),t.type){case"ADD_CONTENT_EXTENSION":return oMe(e,t);case"REMOVE_CONTENT_EXTENSION":return iMe(e,t);case"UPDATE_EXTENSION_PRIORITY":return aMe(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return sMe(e,t);default:return e}}function oMe(e,t){var r;v().assertConditionTag(e[t.payload.extension.provider.scope.renderMode]===void 0,"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var n=t.payload.extension;return m(m({},e),{extensions:m(m({},e.extensions),(r={},r[t.payload.extension.provider.scope.renderMode]={controller:n,priority:n.priority},r))})}function iMe(e,t){var r,n,o=m({},e.extensions);try{for(var a=qe(t.payload.renderModes),d=a.next();!d.done;d=a.next()){var c=d.value;delete o[c]}}catch(u){r={error:u}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return m(m({},e),{extensions:o})}function aMe(e,t){var r=m({},e.extensions);for(var n in t.payload.updates)r[n]&&(r[n]=m(m({},r[n]),{priority:t.payload.updates[n]}));return m(m({},e),{extensions:r})}function sMe(e,t){return m(m({},e),{contentNavigationSupported:t.payload.isEnabled})}s();k();_d();Z();Mi();ue();Cr();function aye(e,t){return e===void 0&&(e=N3()),t===void 0&&(t=Kn),jT(e,function(r){switch(t.type){case"ACTIVE_FILTER_UPDATED":{ar()&&dMe(r,t);return}case"VIEW_CONTAINER_VISIBILITY_CHANGED":{cMe(r,t);return}case"LOAD_DEFAULT_FILTER":{uMe(r,t);return}case"LOAD_FILTER":{lMe(r,t);return}case"SET_FILTERING_CAPABILITIES":{fMe(r,t);return}case"UPDATE_FILTER_RANGE":{pMe(r,t);return}case"SET_COLLABORATORS":{mMe(r,t);return}case"UPDATE_COLLABORATORS":{gMe(r,t);return}default:return e}})}function N3(){return{filteredRanges:{},filteringCapabilities:void 0,requestDefaultFilter_deprecated:!1,ensureActiveFilter:!1,collaborators:void 0}}function dMe(e,t){t.payload.newActiveFilterId!==e.activeFilterId&&(e.activeFilterId=t.payload.newActiveFilterId,e.activeFilterId&&(e.ensureActiveFilter=!0))}function cMe(e,t){if(!ar()){e.defaultFilterId_deprecated===void 0&&t.payload.visibilityState!==vt.Closed&&(e.requestDefaultFilter_deprecated=!0);return}!e.activeFilterId&&t.payload.visibilityState!==vt.Closed&&(e.ensureActiveFilter=!0)}function uMe(e,t){sye(e,t.payload.filteredRange,!0)&&(e.defaultFilterId_deprecated=t.payload.filteredRange.id),e.requestDefaultFilter_deprecated=!1}function lMe(e,t){ar()||v().assertConditionTag(!!e.defaultFilterId_deprecated,"Default filter should be loaded before new filters are loaded",528779299),sye(e,t.payload.filteredRange,t.payload.shouldSetActive)}function sye(e,t,r){return e.filteredRanges[t.id]!==void 0?(v().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(r&&(e.activeFilterId=t.id,ar()&&(e.ensureActiveFilter=!1)),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:(ar()||e.defaultFilterId_deprecated!==t.id)&&t.canBeUpdated()},!0)}function fMe(e,t){e.filteringCapabilities=t.payload.capabilities}function pMe(e,t){if(v().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),!(t.payload.changes.length===0||!t.payload.filterId)){var r=e.filteredRanges[t.payload.filterId];if(!r){v().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);return}t.payload.changes.forEach(function(n){switch(n.type){case"FilterUpdate":{if(!ar()&&t.payload.filterId===e.defaultFilterId_deprecated){v().assertConditionTag(!1,"Should not attempt to update the default filter",528532106);break}v().assertConditionTag(r.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),r.filter=n.updatedFilter;break}case"Insert":{if(n.index<0||n.index>r.order.length){v().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}r.order=w(w(w([],j(r.order.slice(0,n.index)),!1),[n.content],!1),j(r.order.slice(n.index)),!1);break}case"Reload":{r.order=n.fullContent;break}case"Remove":{if(n.index<0||n.index>=r.order.length){v().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}r.order.splice(n.index,1);break}case"Teardown":{if(!ar()){t.payload.filterId===e.defaultFilterId_deprecated&&(v().assertConditionTag(!1,"Is tearing down default filter expected?",528779328),e.defaultFilterId_deprecated=void 0),t.payload.filterId===e.activeFilterId&&(v().assertConditionTag(!!e.defaultFilterId_deprecated,"Active was removed, but no default to fallback on",528779329),e.activeFilterId=e.defaultFilterId_deprecated),delete e.filteredRanges[t.payload.filterId];break}t.payload.filterId===e.activeFilterId&&(v().assertConditionTag(n.teardownReason!==Pd.Unknown,"Active filter was removed for unknown reason. Requesting a new filter to be set as active.",507794051),e.activeFilterId=void 0,e.ensureActiveFilter=n.teardownReason!==Pd.RuntimeTeardown),delete e.filteredRanges[t.payload.filterId];break}}})}}function mMe(e,t){e.collaborators=t.payload.collaborators}function gMe(e,t){var r,n;switch(t.payload.change.type){case"UserAdded":(r=e.collaborators)===null||r===void 0||r.push(t.payload.change.user);break;case"UserRemoved":e.collaborators=(n=e.collaborators)===null||n===void 0?void 0:n.filter(function(o){return o.UserId!==t.payload.change.user.UserId});break;default:break}}Rn();function hMe(e,t,r,n){return{paneState:{viewContainer:e,componentTree:new zl(Os(e.containerType),n),visibilityState:t?vt.Visible:vt.Closed,initializationStatus:Xn.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:O3(),commentState:M3(r),filterState:N3()}}function M3(e){return m(m({},ir()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:jt.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Ym(),modelCapabilities:YW(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function dye(e,t,r,n){return hMe(e,t,r,n)}var yMe=qhe;function uye(e,t){e===void 0&&(e=M3(yMe)),t===void 0&&(t=Kn);var r=CMe(e,t);return vMe(e,r)}function CMe(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return DMe(e,t);case"APPLY_COMMENT_CHANGES":return Jr(e)?jT(function(r){FMe(r,t)})(e):wMe(e,t);case"LOAD_COMMENT":return OMe(e,t);case"VIRTUALIZE_COMMENTS":return NMe(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return WMe(e,t);case"CANCEL_COMMENT_POST_EDIT":return VMe(e,t);case"CANCEL_COMMENT_REPLY":return jMe(e,t);case"COLLAPSE_CARD":return LMe(e,t);case"SELECT_COMMENT":return MMe(e,t);case"REQUEST_THREAD_RESOLVE":return HMe(e,t);case"RELOAD_COMMENTS":return Jr(e)?jT(function(r){UMe(r,t)})(e):BMe(e,t);case"REQUEST_REOPEN_THREAD":return qMe(e,t);case"REQUEST_DELETE_POST":return zMe(e,t);case"REQUEST_DELETE_THREAD":return GMe(e,t);case"DISPATCH_LOAD_THREADS":return KMe(e,t);case"BEGIN_DRAFTING_SUCCESS":return AMe(e,t);case"BEGIN_DRAFTING_FAILURE":return kMe(e,t);case"SESSION_REQUEST_STARTED":return a2e(e,t);case"COMMENT_CONTEXT_CHANGED":return YMe(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return $Me(e,t);case"SHOW_LOW_FIDELITY_WARNING":return QMe(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return XMe(e,t);case"CLEAR_COMMENT_SELECTION":return JMe(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return ZMe(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return e2e(e,t);case"UPDATE_CONTEXT_DETAILS":return t2e(e,t);case"BEGIN_PROCESSING_COMMIT":return r2e(e,t);case"COMMIT_FAILURE":return n2e(e,t);case"BEGIN_PROCESSING_DISCARD":return i2e(e);case"CANCEL_DISCARD":return o2e(e);case"LOAD_PERSONA_ICON_PROPERTIES":return s2e(e,t);case"COMMIT_DRAFT":return SMe(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return d2e(e,t);case"SAVE_DRAFT":return IMe(e,t);case"DRAFT_EMPTINESS_CHANGED":return EMe(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return PMe(e,t);case"VIEW_CONTAINER_CHANGED":return RMe(e,t);case"DISPLAY_DRAFT_WARNING":return c2e(e,t);case"UPDATE_MODEL_STATE":return u2e(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return f2e(e,t);case"ADD_TO_CURRENT_MENTIONEES":return l2e(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return g2e(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return p2e(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return m2e(e,t);case"POPULATE_SMART_REPLY":return x2e(e,t);case"SHOW_POST_ERROR_STATE":return y2e(e,t);case"CLEAR_POST_ERROR_STATE":return C2e(e,t);case"UPDATE_DRAFT_THREAD":return _Me(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return h2e(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return v2e(e,t);default:return e}}function vMe(e,t){var r,n,o=t,a=Y()==="android",d=(r=o.selectedComment)===null||r===void 0?void 0:r.selectedCardId,c=Je(o.draftState);if(Jr(o)){var u=a&&d&&!o.expandedComments.includes(d)?w(w([],j(o.expandedComments),!1),[d],!1):o.expandedComments,l=o.cardPostIds,p=o.postData,g=void 0;u.forEach(function(y){y!==c&&l[y]&&(g=AW(l[y],g??o.postViewState,p,o.localizationDetails))}),g&&(o=m(m({},o),{postViewState:g}))}else{if(d&&d!==c&&(a?d!==((n=e.selectedComment)===null||n===void 0?void 0:n.selectedCardId):o.expandedComments.includes(d)&&!e.expandedComments.includes(d))){var h=fF(d,o.postViewState,o.commentData,o.localizationDetails);h&&(o=m(m({},o),{postViewState:h}))}var x=Je(e.draftState);if(x&&x!==c&&(a||o.expandedComments.includes(x))){var h=fF(x,o.postViewState,o.commentData,o.localizationDetails);h&&(o=m(m({},o),{postViewState:h}))}}return o}function xMe(e,t){var r;if(!e.createdCommentLie)return e;var n=Je(e.draftState);if(!n)return e;var o=t.temporaryCommentId;if(!o)throw v().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new he(fd,C.reserveTag(589103637),-2130957545);var a=Jr(e)?e.postData[n]:e.createdCommentLie.newComment_deprecated;if(Jr(e)&&!a)return v().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var d=m(m({},a),{commentId:o,commentBody:t.commentBody}),c=m(m({},e.cardViewState),mF(o)),u=m(m({},e.postViewState),pF(o)),l=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},p=Yu(e.draftState,n);return m(m(m(m({},e),{selectedComment:l,expandedComments:Ga(e.expandedComments,l,p)}),Jr(e)?{postData:m(m({},e.postData),(r={},r[n]=d,r))}:{createdCommentLie:m(m({},e.createdCommentLie),{newComment_deprecated:d})}),{cardViewState:c,postViewState:u,selectedThreadIdBeforeCommentSession:void 0,draftState:m(m({},p),{committedLieId:o})})}function TMe(e,t){var r;if(!t.parentId)throw new he(gm,C.reserveTag(589103638),-2130957536);var n=m(m({},e.cardViewState),(r={},r[t.parentId]=m(m({},e.cardViewState[t.parentId]),{pending:pt.Editor,loadState:{state:st.Loaded}}),r)),o=An(t.parentId),a=Yu(e.draftState,t.parentId);return m(m({},e),{cardViewState:n,selectedComment:o,expandedComments:sa(e.expandedComments,o,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}function bMe(e,t){var r,n=gF(e,t.commentId),o=m(m({},e.postViewState[t.commentId]),{pending:qr.Post}),a=Jm(e.draftState,t.commentId);return m(m({},e),{postViewState:m(m({},e.postViewState),(r={},r[t.commentId]=o,r)),selectedComment:n,expandedComments:sa(e.expandedComments,n,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}function SMe(e,t){var r=Dd(e.draftState);if(r===void 0)return v().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(r.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return xMe(e,t.payload.data);case"REPLY":return TMe(e,t.payload.data);case"EDIT":return bMe(e,t.payload.data);default:throw new he("Unexpected session type for commit",C.reserveTag(589103639),-2130957532)}}function IMe(e,t){var r,n=e.draftState.drafts;if(n[t.payload.draftId]===void 0)return v().assertConditionTag(!Yo(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=m(m({},n),(r={},r[t.payload.draftId]=m(m({},n[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:o})})}function EMe(e,t){var r,n=e.draftState.drafts;if(n[t.payload.draftId]===void 0)return v().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=m(m({},n),(r={},r[t.payload.draftId]=m(m({},n[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:o})})}function PMe(e,t){var r=XI(e.draftState,function(n){var o=e.draftState.drafts[n];return t.payload.draftId!==void 0&&t.payload.draftId!==n?o.renderContextType:t.payload.isClaimingLock&&o.renderContextType===A.None?t.actionDetail.renderContextType:!t.payload.isClaimingLock&&o.renderContextType===t.actionDetail.renderContextType?A.None:o.renderContextType});return m(m({},e),{draftState:r})}function _Me(e,t){var r;if(!e.createdCommentLie)return e;if(Je(e.draftState)!==t.payload.draftId)return v().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(t.payload.anchorHintText===void 0&&t.payload.insertIndex===void 0)return e;var n=Jr(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if(Jr(e)&&!n)return v().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var o=e.createdCommentLie,a={};if(t.payload.insertIndex!==void 0&&t.payload.insertIndex!==o.flatIndex&&(o=m(m({},o),{flatIndex:t.payload.insertIndex}),Jr(e))){var d=UW(e.commentThreadIds,e.cardPostIds,t.payload.draftId,o);a=m(m({},a),{commentThreadIds:d})}if(t.payload.anchorHintText!==void 0&&t.payload.anchorHintText!==n.anchorHintText){var c=m(m({},n),{anchorHintText:t.payload.anchorHintText});if(Jr(e)){var u=m(m({},e.postData),(r={},r[t.payload.draftId]=c,r));a=m(m({},a),{postData:u})}else o=m(m({},o),{newComment_deprecated:c})}return m(m(m({},e),a),{createdCommentLie:o})}function RMe(e,t){var r=XI(e.draftState,function(n){var o=e.draftState.drafts[n];return $t(o.renderContextType)?Os(t.payload.viewContainer.containerType):o.renderContextType});return m(m({},e),{draftState:r})}function AMe(e,t){var r,n,o,a,d,c,u,l,p,g,h;if(Dd(e.draftState))throw new he("Draft already active!",C.reserveTag(589103640),-2130957551);var x=e.selectedThreadIdBeforeCommentSession,y=t.payload.draftDetails,T=(p=(l=t.payload.rehydratedDraftParams)===null||l===void 0?void 0:l.inCurrentContext)!==null&&p!==void 0?p:!0,b=(h=(g=t.payload.rehydratedDraftParams)===null||g===void 0?void 0:g.isDraftEmpty)!==null&&h!==void 0?h:!0;switch(y.sessionConfiguration.sessionType){case"CREATE":{var S=y.sessionConfiguration.draftId,E=m(m({},QI(S)),{author:y.author,anchorHintText:y.anchorHintText}),P=T?hF(Oc(e),y):e.selectedComment,_=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(r={},r[S]={commentDraft:y,isDraftEmpty:b,isInCurrentContext:T,pendingState:Hi.None,renderContextType:t.payload.draftRenderContextType,threadId:S},r)),cardIdToDraftIdMap:m(m({},e.draftState.cardIdToDraftIdMap),(n={},n[S]=S,n)),pendingDraft:void 0}),D={};if(Jr(e)){var O=Xm(e.commentThreadIds,e.cardPostIds,y.insertIndex),H=e.commentThreadIds,V=e.cardPostIds;O>=0&&(H=w(w(w([],j(H.slice(0,O)),!1),[S],!1),j(H.slice(O)),!1),V=m(m({},e.cardPostIds),(o={},o[S]=[S],o))),D={commentThreadIds:H,cardPostIds:V,postData:m(m({},e.postData),(a={},a[S]=E,a))}}return m(m(m({},e),D),{createdCommentLie:{flatIndex:y.insertIndex,newComment_deprecated:E},cardViewState:m(m({},e.cardViewState),LW(E)),postViewState:m(m({},e.postViewState),HW(E)),selectedComment:P,expandedComments:Ga(e.expandedComments,P,_),selectedThreadIdBeforeCommentSession:x,draftState:_})}case"EDIT":case"REPLY":if(!(Ba(y.sessionConfiguration)||lf(y.sessionConfiguration)))throw v().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new he(fd,C.reserveTag(589103642),-2130957532);var M=void 0,G=lf(y.sessionConfiguration)&&(!e.selectedComment||y.sessionConfiguration.threadId!==e.selectedComment.selectedCardId),K=Va(y.sessionConfiguration)&&(!e.selectedComment||!Xe(e.selectedComment.selectionDetails)||y.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId);T?!e.selectedComment||G||K?M=hF(Oc(e),y):M=m(m({},e.selectedComment),{selectionDetails:m(m({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):M=e.selectedComment;var z=e.draftState.cardIdToDraftIdMap,$=e.draftState.postIdToDraftIdMap,q="",re=!1,ae=!1;if(Nc(y.sessionConfiguration))z=m(m({},z),(d={},d[y.sessionConfiguration.threadId]=y.sessionConfiguration.draftId,d)),q=y.sessionConfiguration.threadId,ae=b;else if(Va(y.sessionConfiguration)){var ie=y.sessionConfiguration.commentId;if($=m(m({},$),(c={},c[ie]=y.sessionConfiguration.draftId,c)),re=!0,Jr(e)){var Te=e.postData[ie],Oe=ju(Te.commentBody);ae=Oe.length===0||Y()==="web"&&Oe==="\n",q=$e(Te)}else e.commentData.some(function(it){if(it.commentId===ie){var _e=ju(it.commentBody);return ae=_e.length===0||Y()==="web"&&_e==="\n",q=$e(it),!0}return!1});!q&&y.sessionConfiguration.rootCommentId&&(q=y.sessionConfiguration.rootCommentId)}else Ne(y.sessionConfiguration);var ke=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(u={},u[y.sessionConfiguration.draftId]={commentDraft:y,isDraftEmpty:ae,isInCurrentContext:T,pendingState:Hi.None,renderContextType:t.payload.draftRenderContextType,threadId:q},u)),cardIdToDraftIdMap:z,postIdToDraftIdMap:$,pendingDraft:void 0});return m(m({},e),{selectedComment:M,expandedComments:re?Ga(e.expandedComments,M,ke):sa(e.expandedComments,M,ke),selectedThreadIdBeforeCommentSession:x,draftState:ke,createdCommentLie:void 0});default:return e}}function kMe(e,t){if(e.selectedComment===void 0)return v().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var r=void 0;t.payload.beginDraftingParams.sessionType!=="CREATE"?r=m(m({},e.selectedComment),{selectionDetails:m(m({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(r={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var n=m(m({},e.draftState),{pendingDraft:void 0});return m(m({},e),{selectedComment:r,expandedComments:sa(e.expandedComments,r,n),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:n})}function DMe(e,t){var r=uF(t.payload.commentId);return r===e.highlightedCommentId?e:m(m({},e),{highlightedCommentId:r})}function wMe(e,t){var r,n,o,a,d,c,u;if(!t.payload.changes.length)return e;var l={commentData:w([],j(e.commentData),!1),cardViewState:m({},e.cardViewState),postViewState:m({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},p=e.createdCommentLie,g=!!Je(e.draftState,!0),h=p==null?void 0:p.flatIndex,x=e.modelCapabilities.virtualized,y;try{for(var T=qe(t.payload.changes),b=T.next();!b.done;b=T.next())if(y=b.value,y.type===ia.Load&&(l.postViewState[y.model.commentId]!==void 0?y=m(m({},y),{type:ia.Modify}):y=m(m({},y),{type:ia.Insert})),y.type===ia.Insert){var S=y.model.parentId;if(S&&(l.cardViewState[S]?l.cardViewState[S]=m(m({},l.cardViewState[S]),{pending:pt.None}):(d=(a=v())===null||a===void 0?void 0:a.logDiagnosticTrace)===null||d===void 0||d.call(a,Mt(cye||(cye=qt(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),C.reserveTag(526960065),St.Warning,ht.ProductServiceUsage,Ct(ft.ReviewedAsNotNecessary))),l.commentData.splice(y.index,0,y.model),y.tempId){if(!S){var E={};E[y.model.commentId]=Ds(y.tempId),l.cardViewState=m(m({},Wa(l.cardViewState,y.tempId)),E)}l.postViewState=m(m({},Wa(l.postViewState,y.tempId)),MC([y.model],l.expandedComments,e.localizationDetails)),l.draftState.committedLieId===y.tempId&&(l.draftState=m(m({},l.draftState),{committedLieId:void 0}),h=void 0),l.selectedComment&&l.selectedComment.selectedCardId===y.tempId&&(l.selectedComment=An($e(y.model)),y.model.parentId||(l.expandedComments=Ga(l.expandedComments,l.selectedComment,l.draftState)))}else{if(v().assertConditionTag(!l.postViewState[y.model.commentId],"Received insert for existing comment",594122589),!S){var E={};E[y.model.commentId]=Ds(void 0),l.cardViewState=m(m({},l.cardViewState),E)}l.postViewState=m(m({},l.postViewState),MC([y.model],l.expandedComments,e.localizationDetails))}g&&h!==void 0&&y.index<=h&&h++}else if(y.type===ia.Modify){var P=l.commentData[y.index];if(P.commentId===y.model.commentId){l.commentData[y.index]=y.model;var S=$e(y.model),_=l.cardViewState[S];_?l.cardViewState[S]=m(m({},_),{pending:pt.None,loadState:_.loadState.state===st.Loading||!x?{state:st.Loaded}:_.loadState}):(v().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",527962186),l.cardViewState[S]=Ds(void 0,x?st.Placeholder:void 0));var D=P.displayDate===y.model.displayDate&&P.date===y.model.date?l.postViewState[y.model.commentId].displayDate:ks(y.model.date,y.model.displayDate,e.localizationDetails.dataCulture);if(l.postViewState=m(m({},l.postViewState),(o={},o[y.model.commentId]=m(m({},l.postViewState[y.model.commentId]),{pending:qr.None,displayDate:D}),o)),y.model.commentFlags&Fe.Resolved&&!(P.commentFlags&Fe.Resolved)){var O=l.draftState;l.selectedComment&&l.selectedComment.selectedCardId===y.model.commentId&&(l.selectedComment=An(l.selectedComment.selectedCardId)),l.draftState=bF(l.draftState,y.model.commentId,l.commentData),ja(O,l.draftState,1,2,C.reserveTag(539297114)),(_==null?void 0:_.loadState.state)===st.Loaded&&(l.expandedComments=Ku(y.model.commentId,l.expandedComments,l.draftState,l.selectedComment))}}else v().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Pt("changeIndex did not match comment for ".concat(y.model.commentId))}else if(y.type===ia.Delete){var P=l.commentData[y.index];if(P.commentId===y.model.commentId&&l.commentData.splice(y.index,1),l.highlightedCommentId===y.model.commentId&&(l.highlightedCommentId=void 0),l.topVisibleThreadId===y.model.commentId&&(l.topVisibleThreadId=void 0),l.cardViewState=Wa(l.cardViewState,y.model.commentId),l.postViewState=Wa(l.postViewState,y.model.commentId),y.model.commentId===l.selectedThreadIdBeforeCommentSession){var H=y.index;l.commentData.length?(H>=l.commentData.length&&(H=l.commentData.length-1),l.selectedThreadIdBeforeCommentSession=$e(l.commentData[H])):l.selectedThreadIdBeforeCommentSession=void 0}g&&h!==void 0&&y.index<h&&h--}}catch(M){r={error:M}}finally{try{b&&!b.done&&(n=T.return)&&n.call(T)}finally{if(r)throw r.error}}g&&(h===void 0?p=void 0:p&&h!==p.flatIndex&&(p=m(m({},p),{flatIndex:h}))),l.draftState=vF(l.draftState,e.cardViewState,l.cardViewState,e.postViewState,l.postViewState,2),l.selectedComment&&!As(l.draftState)&&(l.cardViewState[l.selectedComment.selectedCardId]?Xe(l.selectedComment.selectionDetails)&&!l.postViewState[l.selectedComment.selectionDetails.selectedPostId]&&(l.selectedComment=An(l.selectedComment.selectedCardId)):l.selectedComment=void 0);var V=D3(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return m(m({},e),{createdCommentLie:p,draftState:l.draftState,selectedComment:l.selectedComment,expandedComments:HC(l.expandedComments,l.cardViewState,l.draftState),commentData:l.commentData,cardViewState:l.cardViewState,postViewState:l.postViewState,highlightedCommentId:l.highlightedCommentId,topVisibleThreadId:l.topVisibleThreadId,selectedThreadIdBeforeCommentSession:l.selectedThreadIdBeforeCommentSession,tasks:(c=V==null?void 0:V.updatedTasks)!==null&&c!==void 0?c:e.tasks,historyRecordViewState:(u=V==null?void 0:V.updatedHistoryRecordViewState)!==null&&u!==void 0?u:e.historyRecordViewState})}function FMe(e,t){var r,n;if(t.payload.changes.length){var o=Je(e.draftState,!0),a;try{for(var d=qe(t.payload.changes),c=d.next();!c.done;c=d.next())switch(a=c.value,a.type===ia.Load&&(e.postViewState[a.model.commentId]!==void 0?a=m(m({},a),{type:ia.Modify}):a=m(m({},a),{type:ia.Insert})),a.type){case ia.Insert:Xhe(e,a,o),e.createdCommentLie===void 0&&(o=void 0);break;case ia.Modify:Jhe(e,a);break;case ia.Delete:Zhe(e,a,o)}}catch(p){r={error:p}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}_3(e,2),e.selectedComment&&!As(e.draftState)&&(e.cardViewState[e.selectedComment.selectedCardId]?Xe(e.selectedComment.selectionDetails)&&!e.postViewState[e.selectedComment.selectionDetails.selectedPostId]&&(e.selectedComment=An(e.selectedComment.selectedCardId)):e.selectedComment=void 0),e.expandedComments=HC(e.expandedComments,e.cardViewState,e.draftState);var u=gs(e,C.reserveTag(520646682));if(u){var l=D3(u.tasks,u.historyRecordViewState,t.payload,u.localizationDetails);l!=null&&l.updatedTasks&&(e.tasks=l.updatedTasks),l!=null&&l.updatedHistoryRecordViewState&&(e.historyRecordViewState=l.updatedHistoryRecordViewState)}}}function OMe(e,t){var r,n,o=e.modelCapabilities.virtualized,a=SF(e,t.payload.commentData,o,!!t.payload.filteringEnabled),d={};d=kW(t.payload.commentData,o?st.Placeholder:st.Loaded);var c=oye(t.payload.tasks,e.localizationDetails);return m(m(m({},e),a),{cardViewState:m(m({},e.cardViewState),d),postViewState:m(m({},e.postViewState),MC(t.payload.commentData,a.expandedComments,e.localizationDetails)),tasks:(r=c==null?void 0:c.updatedTasks)!==null&&r!==void 0?r:e.tasks,historyRecordViewState:(n=c==null?void 0:c.updatedHistoryRecordViewState)!==null&&n!==void 0?n:e.historyRecordViewState})}function NMe(e,t){if(!e.modelCapabilities.virtualized)throw new he("virtualizeCommentsReducer requires virtualization",C.reserveTag(589103643),-2130957500);var r=Ghe(t.payload.threadInfo.map(function(o){return o.threadId})),n=SF(e,r,!0,!!t.payload.filteringEnabled);return m(m(m({},e),n),{cardViewState:m(m({},e.cardViewState),DW(t.payload.threadInfo)),postViewState:m(m({},e.postViewState),MC(r,n.expandedComments,e.localizationDetails))})}function MMe(e,t){var r=e.selectedComment;if(!yF(e.draftState,r,t))return e;if(!t.payload.selectedCard)throw new he(gm,C.reserveTag(589103644),-2130957536);var n=NW(e.selectedComment,t),o=Lm(t.payload.selectType)?Ga(e.expandedComments,n,e.draftState):sa(e.expandedComments,n,e.draftState);return m(m({},e),{selectedComment:n,expandedComments:o})}function LMe(e,t){var r=We(e.draftState);if((r==null?void 0:r.threadId)===t.payload.cardId)return e;var n=OW(t.payload.cardId,e.selectedComment,e.draftState);return m(m({},e),{selectedComment:n,expandedComments:Ku(t.payload.cardId,e.expandedComments,e.draftState,n)})}function HMe(e,t){var r;return m(m({},e),{cardViewState:m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:pt.Card,loadState:{state:st.Loaded}}),r)),selectedComment:BW(e.selectedComment,t)})}function BMe(e,t){var r,n,o,a={},d={},c=e.selectedComment,u=void 0,l=e.expandedComments,p=c&&Xe(c.selectionDetails),g=!1,h=!1,x=!1,y=e.selectedThreadIdBeforeCommentSession,T=e.draftState,b=e.modelCapabilities.virtualized,S=(r=We(T))===null||r===void 0?void 0:r.threadId,E={};e.commentData.forEach(function(M){E[M.commentId]=M});var P=!1,_=!1;t.payload.comments.forEach(function(M){if(M.commentId===e.highlightedCommentId&&(P=!0),M.commentId===e.topVisibleThreadId&&(_=!0),c&&(M.commentId===c.selectedCardId&&(h=!0),c.selectedCardId===$e(M)&&Xe(c.selectionDetails)&&c.selectionDetails.selectedPostId===M.commentId&&(g=!0)),M.commentId in E){if(M.parentId===""){e.cardViewState[M.commentId]&&v().assertConditionTag(e.cardViewState[M.commentId].pending!==pt.Delete,"Card pending delete remained after a reload.",593762527);var G=e.cardViewState[M.commentId];if(!G)v().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default.",527958879),d[M.commentId]=Ds(void 0,b?st.NeedsReload:st.Loaded);else if(G.pending!==pt.None||b){var K=G.loadState;d[M.commentId]=m(m({},G),{pending:pt.None,loadState:K.state===st.Placeholder?K:{state:b?st.NeedsReload:st.Loaded}})}else d[M.commentId]=G}if(v().assertConditionTag(!e.postViewState[M.commentId]||e.postViewState[M.commentId].pending!==qr.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[M.commentId]?e.postViewState[M.commentId].pending!==qr.None?a[M.commentId]=m(m({},e.postViewState[M.commentId]),{pending:qr.None}):a[M.commentId]=e.postViewState[M.commentId]:a[M.commentId]=za(void 0),M.commentFlags&Fe.Resolved&&(!E[M.commentId]||!(E[M.commentId].commentFlags&Fe.Resolved))){if(c&&c.selectedCardId===M.commentId&&(c=An(c.selectedCardId)),M.commentId===S){var z=T;T=bF(T,M.commentId,t.payload.comments),ja(z,T,1,1,C.reserveTag(539297115))}l=Ku(M.commentId,l,T,c)}y&&y===M.commentId&&(x=!0)}else{if(M.parentId===""){var $=M.commentId,q=b?{state:st.Placeholder,initialItemCount:1}:{state:st.Loaded};d[M.commentId]=LC($,q)}a[M.commentId]=za(l.includes($e(M))?ks(M.date,M.displayDate,e.localizationDetails.dataCulture):M.displayDate)}}),u=VW(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),T=m(m({},T),{committedLieId:void 0});var D=Je(T);if(D&&(c&&D===c.selectedCardId&&(h=!0),d[D]=e.cardViewState[D],a[D]=e.postViewState[D]),T=vF(T,e.cardViewState,d,e.postViewState,a,1),As(T)||(h?p&&!g&&c&&!b&&(c={selectedCardId:c.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):c=void 0),!x&&y){var O=e.commentData.findIndex(function(M){return M.commentId===y});if(O<0&&(v().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),O=0),t.payload.comments.length){O>=t.payload.comments.length&&(O=t.payload.comments.length-1);var H=t.payload.comments[O];y=$e(H)}else y=void 0}var V=k3(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return m(m({},e),{draftState:T,commentData:w([],j(t.payload.comments),!1),cardViewState:d,postViewState:a,selectedComment:c,expandedComments:HC(l,d,T),pendingCommentLoad:void 0,highlightedCommentId:P?e.highlightedCommentId:void 0,topVisibleThreadId:_?e.topVisibleThreadId:void 0,createdCommentLie:u,selectedThreadIdBeforeCommentSession:y,tasks:(n=V==null?void 0:V.updatedTasks)!==null&&n!==void 0?n:e.tasks,historyRecordViewState:(o=V==null?void 0:V.updatedHistoryRecordViewState)!==null&&o!==void 0?o:e.historyRecordViewState})}function UMe(e,t){var r=gs(e,C.reserveTag(524031011));if(r){var n=!1,o=!1,a=!1,d=!1,c=r.selectedComment&&Xe(r.selectedComment.selectionDetails),u=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach(function(h){if(h.commentId===r.highlightedCommentId&&(n=!0),h.commentId===r.topVisibleThreadId&&(o=!0),r.selectedComment&&(h.commentId===r.selectedComment.selectedCardId&&(a=!0),r.selectedComment.selectedCardId===$e(h)&&Xe(r.selectedComment.selectionDetails)&&r.selectedComment.selectionDetails.selectedPostId===h.commentId&&(d=!0)),h.commentId in r.postData)yr(h)&&eye(e,h.commentId),tye(e,h.commentId),Ak(e,h,r.postData[h.commentId],1),r.selectedThreadIdBeforeCommentSession&&r.selectedThreadIdBeforeCommentSession===h.commentId&&(u=!0);else{if(yr(h)){var x=h.commentId,y=r.modelCapabilities.virtualized?{state:st.Placeholder,initialItemCount:1}:{state:st.Loaded};e.cardViewState[h.commentId]=LC(x,y)}e.postViewState[h.commentId]=za(h.displayDate)}Rk(e,h)}),n||(e.highlightedCommentId=void 0),o||(e.topVisibleThreadId=void 0),!u&&r.selectedThreadIdBeforeCommentSession&&rye(e),nye(e),e.draftState.committedLieId=void 0;var l=Je(e.draftState);l&&e.selectedComment&&l===e.selectedComment.selectedCardId&&(a=!0),_3(e,1),As(e.draftState)||(a?c&&!d&&e.selectedComment&&!r.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=BC()):e.selectedComment=void 0),e.pendingCommentLoad=void 0;var p=k3(r.tasks,r.historyRecordViewState,t.payload,r.localizationDetails);p!=null&&p.updatedTasks&&(e.tasks=p.updatedTasks),p!=null&&p.updatedHistoryRecordViewState&&(e.historyRecordViewState=p.updatedHistoryRecordViewState);var g=HC(e.expandedComments,e.cardViewState,e.draftState);g!==e.expandedComments&&(e.expandedComments=g)}}function VMe(e,t){var r=gF(e,t.payload.commentId),n=Jm(e.draftState,t.payload.commentId);return m(m({},e),{selectedComment:r,expandedComments:sa(e.expandedComments,r,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}function jMe(e,t){var r=Yu(e.draftState,t.payload.commentId);return m(m({},e),{expandedComments:sa(e.expandedComments,e.selectedComment,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}function WMe(e,t){var r;if(!Yo(e.draftState))return e;var n=Je(e.draftState);if(!n)return e;var o,a=!1;((r=e.selectedComment)===null||r===void 0?void 0:r.selectedCardId)!==n?o=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(o={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},a=!0);var d=Yu(e.draftState,n);return m(m(m({},e),Jr(e)?{commentThreadIds:lF(e.commentThreadIds,n),cardPostIds:Wa(e.cardPostIds,n),postData:Wa(e.postData,n)}:{}),{createdCommentLie:void 0,selectedComment:o,expandedComments:o&&a?Ga(e.expandedComments,o,d):sa(e.expandedComments,o,d),cardViewState:Wa(e.cardViewState,n),postViewState:Wa(e.postViewState,n),selectedThreadIdBeforeCommentSession:void 0,draftState:d})}function zMe(e,t){var r,n=m(m({},e.postViewState),(r={},r[t.payload.commentId]=m(m({},e.postViewState[t.payload.commentId]),{pending:qr.Delete}),r));return m(m({},e),{postViewState:n})}function GMe(e,t){var r,n=m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:pt.Delete}),r));return m(m({},e),{cardViewState:n})}function qMe(e,t){var r,n=m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:pt.Card}),r));return m(m({},e),{cardViewState:n})}function KMe(e,t){var r=m({},e.cardViewState);return t.payload.threadIds.forEach(function(n){if(r[n]){var o=r[n].loadState;r[n]=m(m({},r[n]),{loadState:{state:st.Loading,initialItemCount:qu(o)?o.initialItemCount:1}})}else v().assertConditionTag(!1,"Loading an unexpected thread?",528021317)}),m(m({},e),{cardViewState:r})}function YMe(e,t){var r,n,o,a=Ym(),d={},c={},u=void 0,l=void 0,p=void 0,g=void 0,h=Je(e.draftState),x=!!e.createdCommentLie;t.payload.contextDetails?o=m(m({},kk(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):o={nextPopulatedContextDetails:jt.Unknown,isReadOnly:Iu()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var y=t.payload.contextDrafts;if(y){var T=CF(e.draftState);if(zu(T)>0){var b={},S=void 0,E=void 0,P=!nt();if(wC(T).forEach(function(M){var G,K,z=y.find(function($){return $.draftId===M});b[M]=m(m({},T.drafts[M]),{isInCurrentContext:!!z}),h===M&&(x=!!z,z&&(S=z.insertIndex,E=z.anchorHintText,((G=t.payload.contextDetails)===null||G===void 0?void 0:G.selectedCommentId)===h&&(u=An(h)))),!P&&!u&&z&&b[M].threadId===((K=e.selectedComment)===null||K===void 0?void 0:K.selectedCardId)&&(P=!0)}),a=m(m({},e.draftState),{drafts:b}),l=e.createdCommentLie,p=h?Jr(e)?e.postData[h]:l==null?void 0:l.newComment_deprecated:void 0,P&&(u=e.selectedComment),l&&h&&x){v().assertConditionTag(S!==void 0,"Index unknown for lie in latest context",587309136);var _=S??0;_!==l.flatIndex&&(l=m(m({},l),{flatIndex:_})),p&&E!==void 0&&E!==l.newComment_deprecated.anchorHintText&&(p=m(m({},p),{anchorHintText:E}),l=m(m({},l),{newComment_deprecated:p})),d=mF(h),c=pF(h),l.flatIndex>-1&&(d[h].pending=pt.None,c[h].pending=qr.None)}}else g=g??-1}else g=g??4;o.isReadOnly&&(x&&(l=void 0),a=TF(a),g=g??5),ja(e.draftState,a,g,4,C.reserveTag(539297116));var D;if(Jr(e)){var O=[],H={},V={};l&&h&&p&&(V=(r={},r[h]=p,r),x&&!l.flatIndex&&(O=[h],H=(n={},n[h]=[h],n))),D={commentThreadIds:O,cardPostIds:H,postData:V}}else D={commentData:[]};return m(m(m({},e),D),{cardViewState:d,postViewState:c,selectedComment:u,expandedComments:sa(e.expandedComments,u,a),pendingCommentLoad:t.payload.numberOfComments===0?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex!==void 0&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:o,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?uF(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:l,selectedThreadIdBeforeCommentSession:void 0,draftState:a,tasks:{},historyRecordViewState:{}})}function $Me(e,t){return m(m({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}function QMe(e,t){var r=t.payload,n=r.commentId,o=r.lowFidelityWarningType,a=Mr(Oc(e),n);if(!a)return v().assertConditionTag(!1,"Comment not found",593762530),e;if(lr(e.draftState))return v().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var d,c=e.expandedComments;return o===Bt.DeleteThread?d={selectedCardId:n,selectionDetails:{lowFidelityWarningType:o}}:(d={selectedCardId:$e(a),selectionDetails:{selectedPostId:n,lowFidelityWarningType:o}},c=Ga(c,d,e.draftState)),m(m({},e),{selectedComment:d,expandedComments:c})}function XMe(e,t){var r=e.selectedComment;return!r||r.selectionDetails.lowFidelityWarningType===void 0?e:m(m({},e),{selectedComment:m(m({},r),{selectionDetails:{lowFidelityWarningType:void 0}})})}function JMe(e,t){return yF(e.draftState,e.selectedComment,t)?m(m({},e),{selectedComment:void 0}):e}function ZMe(e,t){return t.payload.commentId!==void 0&&t.payload.commentId!==e.highlightedCommentId?e:m(m({},e),{highlightedCommentId:void 0})}function e2e(e,t){return m(m({},e),{topVisibleThreadId:t.payload.threadId})}function t2e(e,t){var r=!1,n=m({},e.contextState),o=e.createdCommentLie,a=e.draftState,d=void 0;return t.payload.contextState.commentThreadCounts!==void 0&&(r=!0,n.commentThreadCounts=t.payload.contextState.commentThreadCounts),t.payload.contextState.nextPopulatedContextDetails!==void 0&&(r=!0,n.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails),t.payload.contextState.isReadOnly!==void 0&&(r=!0,n.isReadOnly=t.payload.contextState.isReadOnly,n.isReadOnly&&(a=TF(e.draftState),d=d??5,Je(e.draftState,!0)&&(o=void 0))),r?(ja(e.draftState,a,d,5,C.reserveTag(539297117)),m(m({},e),{draftState:a,contextState:n,createdCommentLie:o})):e}function r2e(e,t){var r;if(!$o(e.draftState))return v().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var n=e.draftState,o=We(e.draftState);return o&&(n=m(m({},n),{drafts:m(m({},n.drafts),(r={},r[o.commentDraft.sessionConfiguration.draftId]=m(m({},o),{pendingState:Hi.Commit}),r))})),m(m({},e),{draftState:n})}function n2e(e,t){var r;if(!hi(e.draftState))return v().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var n=e.draftState,o=We(e.draftState);return o&&(n=m(m({},n),{drafts:m(m({},n.drafts),(r={},r[o.commentDraft.sessionConfiguration.draftId]=m(m({},o),{pendingState:Hi.None,savedDraftContent:t.payload.commitText!==void 0?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:o.savedDraftContent}),r))})),m(m({},e),{draftState:n})}function o2e(e){var t;if(!FC(e.draftState))return v().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var r=e.draftState,n=We(e.draftState);return n&&(r=m(m({},r),{drafts:m(m({},r.drafts),(t={},t[n.commentDraft.sessionConfiguration.draftId]=m(m({},n),{pendingState:Hi.None}),t))})),m(m({},e),{draftState:r})}function i2e(e){var t;if(!$o(e.draftState)&&!jm(e.selectedComment))return v().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var r=e.draftState,n=We(e.draftState);return n&&(r=m(m({},r),{drafts:m(m({},r.drafts),(t={},t[n.commentDraft.sessionConfiguration.draftId]=m(m({},n),{pendingState:Hi.Discard}),t))})),m(m({},e),{draftState:r})}function a2e(e,t){var r;if(e.createdCommentLie)return v().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(Nc(t.payload.params))r=t.payload.params.threadId;else if(Va(t.payload.params)){var n=t.payload.params.commentId,o=Mr(Oc(e),n);if(o)r=$e(o);else return v().assertConditionTag(!1,"Could not lock selection on missing comment",593764357),e}else r=zm();var a=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(a=e.selectedComment.selectedCardId);var d=m(m({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),c=MW(e.selectedComment,t,r),u=Xe(c.selectionDetails)?Ga(e.expandedComments,c,d):e.expandedComments;return m(m({},e),{selectedThreadIdBeforeCommentSession:a,selectedComment:c,expandedComments:u,draftState:d})}function s2e(e,t){if(Object.keys(t.payload.personaIconPropertiesMap).length===0)return e;var r=m(m({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return m(m({},e),{personaIconPropertiesMap:r})}function d2e(e,t){return m(m({},e),{modelCapabilities:m(m({},e.modelCapabilities),{atMention:t.payload.capability})})}function c2e(e,t){var r,n,o=Dd(e.draftState);if(o===void 0)return v().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var a=o.sessionConfiguration,d=a.draftId,c=e.draftState.drafts;if(!c[d])return v().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var u=c[d].draftWarningState,l=m(m({},c[d]),{draftWarningState:{warningCounter:u?u.warningCounter+1:0,type:t.payload.draftWarningType}}),p=m(m({},c),(r={},r[d]=l,r)),g=nt()&&(Ba(l.commentDraft.sessionConfiguration)||((n=e.selectedComment)===null||n===void 0?void 0:n.selectedCardId)!==l.threadId)?FW(l):e.selectedComment,h=m(m({},e.draftState),{drafts:p});return m(m({},e),{draftState:h,selectedComment:g,expandedComments:sa(e.expandedComments,g,h)})}function u2e(e,t){var r={atMention:t.payload.modelCapabilityFlags&Ra.AtMentionKnown?t.payload.modelCapabilityFlags&Ra.AtMentionEnabled?Rt.Enabled:Rt.Disabled:Rt.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Ra.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Ra.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Ra.Virtualized),tasks:t.payload.modelCapabilityFlags&Ra.TasksKnown?t.payload.modelCapabilityFlags&Ra.TasksEnabled?Sd.Enabled:Sd.Disabled:Sd.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Ra.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Ra.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&Ra.ContentExtensionHostingDisabled)};return m(m({},e),{modelCapabilities:r})}function l2e(e,t){var r,n,o=Dd(e.draftState);if(o===void 0)return v().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var a=o.sessionConfiguration;if(Ba(a))return e;var d=e.draftState.drafts[a.draftId];if(!d)return v().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var c=d.currentMentionees,u=Ss(t.payload.mentionee);if(c&&c[u])return e;var l={};for(var p in c)l[p]={mentionee:m({},c[p].mentionee),stillInDraft:c[p].stillInDraft};l[u]={mentionee:m({},t.payload.mentionee),stillInDraft:!0};var g=void 0;e.draftState.drafts[a.draftId].selectedTaskAssignees&&(g=m({},e.draftState.drafts[a.draftId].selectedTaskAssignees),mw(g,(r={},r[u]={mentionee:m({},t.payload.mentionee),stillInDraft:!0},r)));var h=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(n={},n[a.draftId]=m(m({},e.draftState.drafts[a.draftId]),{currentMentionees:l,selectedTaskAssignees:g}),n))});return m(m({},e),{draftState:h})}function f2e(e,t){var r,n=Dd(e.draftState);if(n===void 0)return v().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=n.sessionConfiguration;if(Ba(o))return e;var a=e.draftState.drafts[o.draftId];if(!a)return v().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var d=a.currentMentionees,c={};for(var u in d)c[u]={mentionee:m({},d[u].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(u)};var l=a.selectedTaskAssignee;if(l){var p=Ss(l);(!c[p]||!c[p].stillInDraft)&&(l=void 0)}var g=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(r={},r[o.draftId]=m(m({},e.draftState.drafts[o.draftId]),{currentMentionees:c,selectedTaskAssignee:l}),r))});return m(m({},e),{draftState:g})}function p2e(e,t){var r;if(Tm())return v().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var n=Dd(e.draftState);if(n===void 0)return v().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=n.sessionConfiguration;if(Ba(o))return e;var a=o.draftId,d=e.draftState.drafts;if(!d[a])return v().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=m(m({},d),(r={},r[a]=m(m({},d[a]),{selectedTaskAssignee:t.payload.selectedAssignee}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:c})})}function m2e(e,t){var r,n;if(!Tm())return v().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var o=Dd(e.draftState);if(o===void 0)return v().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var a=o.sessionConfiguration;if(Ba(a))return e;var d=a.draftId,c=e.draftState.drafts;if(!c[d])return v().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var u=(n=c[d].selectedTaskAssignees)!==null&&n!==void 0?n:{},l=m({},u);B6(l,t.payload.selectedAssignee);var p=m(m({},c),(r={},r[d]=m(m({},c[d]),{selectedTaskAssignees:l}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:p})})}function g2e(e){var t;if(!Tm())return v().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var r=We(e.draftState);if(r===void 0)return v().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var n=r.commentDraft,o=r.selectedTaskAssignees,a={};if(o===void 0){if(lf(n.sessionConfiguration)){var d=e.tasks[n.sessionConfiguration.threadId];v().assertConditionTag(!!d,"Task not found.",529143616),H6(a,d.currentState.assignees)}r.currentMentionees!==void 0&&mw(a,r.currentMentionees)}else a=void 0;var c=n.sessionConfiguration.draftId,u=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(t={},t[c]=m(m({},e.draftState.drafts[c]),{selectedTaskAssignees:a}),t))});return m(m({},e),{draftState:u})}function h2e(e,t){var r=e.draftState,n=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==vt.Visible&&!Kt()&&(r=CF(r),e.selectedComment&&Object.keys(r.drafts).length===0&&Object.keys(e.draftState.drafts).length>0)){var a=qa(e.draftState);a&&(n=An(a),o=sa(e.expandedComments,n,r))}return r=XI(r,function(d){var c=e.draftState.drafts[d];return qW(c.renderContextType,t.payload.visibilityState)}),m(m({},e),{selectedComment:n,expandedComments:o,draftState:r})}function y2e(e,t){var r=m(m({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),n=m({},e.postViewState);return n[t.payload.commentId]=r,m(m({},e),{postViewState:n})}function C2e(e,t){var r=m(m({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),n=m({},e.postViewState);return n[t.payload.commentId]=r,m(m({},e),{postViewState:n})}function v2e(e,t){return m(m({},e),{suggestionsDetails:t.payload.details})}function x2e(e,t){return m(m({},e),{draftState:$W(e.draftState,t.payload)})}var cye;s();k();Ru();Z();Mi();Ma();Hf();Be();rg();ue();Cr();function L3(){v().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function T2e(){return{viewContainer:{closeView:L3,openView:L3,containerType:cn.FullPane,moveFocusToCanvas_donotuse:L3},componentTree:new zl(A.FullPane,Cd),visibilityState:vt.Closed,initializationStatus:Xn.NotInitialized,viewContainerDisplayConfiguration:void 0}}function lye(e,t){switch(e===void 0&&(e=T2e()),t===void 0&&(t=Kn),t.type){case"VIEW_CONTAINER_CHANGED":return b2e(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return S2e(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return I2e(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return E2e(e,t);case"BEGIN_VIEW_INIT":return P2e(e);case"END_VIEW_INIT":return _2e(e);default:return e}}function b2e(e,t){var r=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return m(m({},e),{viewContainer:t.payload.viewContainer,componentTree:r?new zl(Os(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}function S2e(e,t){return t.payload.displayConfiguration===e.viewContainerDisplayConfiguration?e:m(m({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}function I2e(e,t){return m(m({},e),{initializationStatus:t.payload.visibilityState!==vt.Closed||Oi()?e.initializationStatus:Xn.NotInitialized,visibilityState:t.payload.visibilityState})}function E2e(e,t){var r=m(m({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return m(m({},e),{viewContainer:r})}function P2e(e){return m(m({},e),{initializationStatus:Xn.Initializing})}function _2e(e){return m(m({},e),{initializationStatus:Xn.Initialized})}var H3=void 0;function fye(e,t){t===void 0&&(t=Kn),H3||(H3=Oh({paneState:lye,contentExtensions:iye,commentState:uye,filterState:aye}));var r=H3(e,t);return r}s();te();Z();xd();Er();Cn();ue();un();s();k();te();rt();Be();Cr();Pf();Et();var R2e=500,A2e=20,k2e=function(){return{threadIdRequests:new Map,sequenceId:0}};function pye(e){return e&&(e.loadState.state===st.Placeholder||e.loadState.state===st.NeedsReload)}var D2e=function(t){return function(r,n){var o,a,d=Vi(t.getState());try{for(var c=qe(n),u=c.next();!u.done;u=c.next()){var l=u.value;pye(d[l])&&r.threadIdRequests.set(l,r.sequenceId++)}}catch(p){o={error:p}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return r}},w2e=function(t,r,n){return function(o){for(var a=Array.from(o.threadIdRequests.entries()).sort(function(g,h){var x=j(g,2),y=x[0],T=x[1],b=j(h,2),S=b[0],E=b[1];return T-E}),d=[],c=Vi(t.getState()),u=a.pop();u&&d.length<n;u=a.pop()){var l=j(u,1),p=l[0];o.threadIdRequests.delete(p),pye(c[p])&&d.push(p)}if(d.length&&t.dispatch(BS({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(594888212)},{threadIds:d})),o.threadIdRequests.size>0)return o}},mye=function(t,r,n){return n===void 0&&(n=A2e),vu(D2e(t),w2e(t,r,n),k2e,R2e)};Rn();Et();$p();el();var gye=function(t,r){return function(n){var o=mye(n,r);return function(a){return function(d){var c=n.getState();switch(d.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":o.reset();break;case"COMMIT_DRAFT":var u=Xo(c),l=Dn(c);if(l!==void 0){var p=l.commentDraft;if(d.payload.metadataUpdates&&d.payload.metadataUpdates.Task){var g=void 0;p.sessionConfiguration.sessionType!==fo&&p.sessionConfiguration.sessionType!==aa&&(g=u[p.sessionConfiguration.threadId]&&u[p.sessionConfiguration.threadId].id),d.payload.metadataUpdates.Task.taskId=g,p.updateProperties("Task",d.payload.metadataUpdates.Task)}d.payload.data.temporaryCommentId=p.commit(d.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":{if(!Br(c).virtualized){v().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);return}o(d.payload.threadIds);return}case"DISPATCH_LOAD_THREADS":{if(!Br(c).virtualized)return;t.loadThreads(d.payload.threadIds);break}case"HIGHLIGHT_COMMENT":d.payload.actionSource===ce.SharedComments&&t.highlightComment(d.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var h=fe(c);if(lr(h))return;t.deleteComment(d.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":{at()?t.beginDraftingAsync({sessionType:"METADATA",threadId:d.payload.commentId}).then(function(P){var _=Xo(c)[d.payload.commentId];_&&P.updateProperties("Task",{type:"Task",completion:100,taskId:_.id}),P.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),P.commit(),P.endDrafting()}).catch(pe(C.reserveTag(593768922))):t.setThreadResolvedState(d.payload.commentId,!0);break}case"REQUEST_REOPEN_THREAD":{at()?t.beginDraftingAsync({sessionType:"METADATA",threadId:d.payload.commentId}).then(function(P){var _=Xo(c)[d.payload.commentId];_&&P.updateProperties("Task",{type:"Task",completion:0,taskId:_.id}),P.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),P.commit(),P.endDrafting()}).catch(pe(C.reserveTag(593768924))):t.setThreadResolvedState(d.payload.commentId,!1);break}case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":t.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":t.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":t.presentLinkToComment(d.payload.commentId);break;default:break}var x=a(d),y=n.getState(),T=ve(c),b=ve(y),S=void 0;switch(d.type!=="LOAD_COMMENT"&&d.type!=="VIRTUALIZE_COMMENTS"&&(d.type!=="SELECT_COMMENT"||d.payload.source===ce.SharedComments)&&b&&b.selectedCardId!==(T==null?void 0:T.selectedCardId)&&b.selectedCardId!==zm()&&(S=b.selectedCardId),d.type){case"CLEAR_COMMENT_HIGHLIGHT":d.payload.actionSource===ce.SharedComments&&c.commentState.highlightedCommentId!==void 0&&y.commentState.highlightedCommentId===void 0&&t.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(Pn()&&!Cy(n.getState())){var E=Dn(y);E&&(S=E.threadId)}break;default:break}return S&&t.selectComment(S),x}}}};s();k();te();Do();Be();Cr();Et();$p();vo();function hye(e,t,r){var n=e.getState(),o=Yp(n)[se.Isolated];return o?(r(t),o.controller.triggerUpdate(),!0):!1}function B3(e,t,r,n){return n==="CREATE"?hye(e,t,r):!1}function Ey(e,t){return wd(t).lastContextChangeIncrement===0?Ht.Disabled:e===se.TaskPane||e===se.TaskPaneItem?Oo(t)?Ht.Primary:Ht.Disabled:ji(t)?Ht.Disabled:Ey(se.TaskPane,t)!==Ht.Primary?Ht.Primary:e===se.Integrated?Ht.Disabled:Ht.Secondary}function Dk(e,t){var r=Yp(e)[t];r&&(r.controller.priority=r.priority)}var yye=function(t){return function(r){return function(n){return function(o){var a,d,c;switch(o.type){case"ADD_CONTENT_EXTENSION":{o.payload.extension.priority=Ey(o.payload.extension.provider.scope.renderMode,r.getState());break}case"REMOVE_CONTENT_EXTENSION":{try{for(var u=qe(o.payload.renderModes),l=u.next();!l.done;l=u.next()){var p=l.value,g=Yp(r.getState())[p];g&&g.controller.unregisterExtension()}}catch(x){a={error:x}}finally{try{l&&!l.done&&(d=u.return)&&d.call(u)}finally{if(a)throw a.error}}break}case"UPDATE_EXTENSION_PRIORITY":{n(o),Dk(r.getState(),se.TaskPane),Dk(r.getState(),se.TaskPaneItem),Dk(r.getState(),se.Integrated),Dk(r.getState(),se.Isolated);break}case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(hye(r,o,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":{n(o),r.dispatch(hI({renderContextType:A.None,telemetryVisitor:t,trackback:C.reserveTag(594834319)},(c={},c[se.TaskPane]=Ey(se.TaskPane,r.getState()),c[se.TaskPaneItem]=Ey(se.TaskPaneItem,r.getState()),c[se.Integrated]=Ey(se.Integrated,r.getState()),c[se.Isolated]=Ey(se.Isolated,r.getState()),c)));return}case"BEGIN_DRAFTING_SUCCESS":{if(B3(r,o,n,o.payload.draftDetails.sessionConfiguration.sessionType))return;break}case"BEGIN_DRAFTING_FAILURE":{if(B3(r,o,n,o.payload.beginDraftingParams.sessionType))return;break}case"UPDATE_DRAFT_RENDER_CONTEXT":{if(o.payload.isClaimingLock||o.actionDetail.renderContextType===A.DiscreteIsolated)break;var h=Dn(r.getState());if(h&&B3(r,o,n,h.commentDraft.sessionConfiguration.sessionType))return;break}}return n(o)}}}};s();Do();Md();gi();ue();Cr();un();Et();$p();vo();var Cye=function(t){return function(r){return function(n){return function(o){var a;if(!t||!Cy(r.getState()))return n(o);var d=r.getState(),c=n(o),u=r.getState();switch(o.type){case"DISPLAY_DRAFT_WARNING":{var l=ve(d),p=ve(u),g=!p||p.selectedCardId===(l==null?void 0:l.selectedCardId);if(Pn()&&g){var h=Dn(u);h&&t.bringContentIntoView({contentIdentifier:{contentId:h.threadId,contentType:wt.CommentThread}})}break}case"SELECT_COMMENT":{var x=ve(u);o.payload.source===ce.SharedComments&&o.payload.selectType!==Ee.Polite&&$t(o.actionDetail.renderContextType)&&x&&t.bringContentIntoView({contentIdentifier:{contentId:x.selectedCardId,contentType:wt.CommentThread}});break}case"VIEW_CONTAINER_VISIBILITY_CHANGED":{if(Oo(u))break;var y=Dn(u),T=y&&y.isInCurrentContext&&((a=ve(u))===null||a===void 0?void 0:a.selectedCardId)===y.threadId?y.threadId:void 0;T&&t.bringContentIntoView({contentIdentifier:{contentId:T,contentType:wt.CommentThread}});break}case"SELECT_CONTENT":{t.selectNextOrPreviousContent(o.payload);break}case"MOVE_FOCUS_TO_CANVAS":{t.moveFocus({region:il.Canvas,resource:o.payload.resource});break}}return c}}}};s();Z();kI();ue();var vye=function(t){return function(r){return function(n){return function(o){var a=r.getState().commentState.draftState.drafts;n(o);var d=r.getState().commentState.draftState.drafts;if(Object.keys(a).forEach(function(u){if(d[u]===void 0){var l=v().createActivityObject("EndDraftingCalledOnAction",t,be());l.addDataField("ActionName",o.type,N.SystemMetadata),l.successTag(539313865),a[u].commentDraft.endDrafting()}}),nf()&&o.type==="SAVE_DRAFT"){var c=d[o.payload.draftId];c&&Cf().storeEditorContentFromDraftSave(o.payload,c.commentDraft.sessionConfiguration)}}}}};s();te();Z();tr();Mc();cE();s();Z();kw();var F2e="ApplyCommentChangesAction",O2e="BeginProcessingCommitAction",N2e="CancelCommentCreateThreadAction",M2e="CancelCommentPostEditAction",L2e="CancelCommentReplyAction",H2e="CollapseCardAction",B2e="CommitDraftAction",U2e="DeletePostAction",V2e="DeleteThreadAction",j2e="DisplayDraftWarningAction",W2e="LoadThreadsAction",z2e="PresentLinkToCommentAction",G2e="ReloadCommentsAction",q2e="ReopenThreadAction",K2e="ResolveThreadAction",Y2e="SelectCommentAction",$2e="SelectFirstThreadInNextCommentContextAction",Q2e="SelectLastThreadInPreviousCommentContextAction",X2e="SessionRequestStartedAndLockSelectionAction",J2e="ShowLowFidelityWarningAction",Z2e="ClearLowFidelityWarningAction",eLe="UpdateDraftRenderContext",Vn=be();function wk(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:F2e,activityConfig:{aggregationMode:co.OnSuccess}};case"BEGIN_PROCESSING_COMMIT":return{name:O2e,activityConfig:Vn};case"CANCEL_COMMENT_CREATE_THREAD":return{name:N2e,activityConfig:Vn};case"CANCEL_COMMENT_POST_EDIT":return{name:M2e,activityConfig:Vn};case"CANCEL_COMMENT_REPLY":return{name:L2e,activityConfig:Vn};case"COLLAPSE_CARD":return{name:H2e,activityConfig:Vn};case"COMMIT_DRAFT":return{name:B2e,activityConfig:Vn};case"DISPLAY_DRAFT_WARNING":return{name:j2e,activityConfig:Vn};case"RELOAD_COMMENTS":return{name:G2e,activityConfig:{aggregationMode:co.OnSuccess}};case"REQUEST_DELETE_POST":return{name:U2e,activityConfig:Vn};case"REQUEST_DELETE_THREAD":return{name:V2e,activityConfig:Vn,logDocumentMetadata:wi.Basic};case"DISPATCH_LOAD_THREADS":return{name:W2e,activityConfig:{aggregationMode:co.OnSuccess}};case"REQUEST_REOPEN_THREAD":return{name:q2e,activityConfig:Vn};case"REQUEST_THREAD_RESOLVE":return{name:K2e,activityConfig:Vn,logDocumentMetadata:wi.Basic};case"SELECT_COMMENT":return{name:Y2e,activityConfig:Vn};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:$2e,activityConfig:Vn};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:Q2e,activityConfig:Vn};case"SESSION_REQUEST_STARTED":return{name:X2e,activityConfig:Vn};case"SHOW_LOW_FIDELITY_WARNING":return{name:J2e,activityConfig:Vn};case"CLEAR_LOW_FIDELITY_WARNING":return{name:Z2e,activityConfig:Vn};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:eLe,activityConfig:Vn};case"PRESENT_LINK_TO_COMMENT":return{name:z2e,activityConfig:Vn};case"CLEAR_COMMENT_SELECTION":default:return}}function xye(e){if(e.type==="COMMIT_DRAFT")return{name:"CommitDraft".concat(HS(e.payload),"Action"),activityConfig:Vn}}var Tye=function(){return function(t){return function(r){try{var n=t(r);return n}catch(d){var o=wk(r);if(o===void 0){var a=v().createActivityObject("ExceptionMiddlewareCatch",r.actionDetail.telemetryVisitor,be());a.addDataField("OperationType",r.type,N.SystemMetadata),a.addDataField("Trackback",r.actionDetail.trackback,N.SystemMetadata),a.failTag(593278723,ln(d))}tLe(d)}}}};function tLe(e){if(ng(e))throw e;if(Fi(e))switch(e.errorCode){case-2130957565:throw e;case-2130957551:throw e;case-2130957536:return;default:v().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat(so(e)),e.tag);return}else throw v().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat(so(e)),593278724),e}s();k();_d();te();Z();Do();Be();Cn();ue();Cr();Ui();$C();s();Z();Fd();var hs;(function(e){e[e.None=1]="None",e[e.Error=2]="Error",e[e.RequestDefaultFilter_unused=3]="RequestDefaultFilter_unused",e[e.LoadDefaultFilter_unused=4]="LoadDefaultFilter_unused",e[e.LoadFilter=5]="LoadFilter",e[e.UpdateFilter=6]="UpdateFilter",e[e.LoadActiveFilter=7]="LoadActiveFilter"})(hs||(hs={}));var WT=function(t,r,n){if(t!==hs.None){var o=v().createActivityObject("FilterPerfScenario",r,be());return o.addDataField("FilterScenario",t,N.SystemMetadata),ig(n,o),o}},U3=function(t){switch(t){case"LOAD_DEFAULT_FILTER":return hs.LoadDefaultFilter_unused;case"LOAD_FILTER":return hs.LoadFilter;case"UPDATE_FILTER_RANGE":return hs.UpdateFilter;default:return hs.None}};var tm=!1,V3=!1,rLe=function(t,r,n,o,a,d){if(!a.get(n)){v().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330);return}r(gf({renderContextType:o,telemetryVisitor:t,trackback:C.reserveTag(528779331)},{filterId:n,changes:d.changes}))},bye=function(t,r){return function(n){var o=new Map;return function(a){return function(d){if(!or(n.getState()))return a(d);var c,u=WT(U3(d.type),r,n.getState()),l=Bi(n.getState());switch(d.type){case"LOAD_DEFAULT_FILTER":if(ar())break;case"LOAD_FILTER":{c=Ju(n.getState(),d.payload.filteredRange.id);break}case"UPDATE_FILTER_RANGE":{c=Ju(n.getState(),d.payload.filterId);break}case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":{d.payload.filteringEnabled=!0;break}}var p=a(d),g=function(x,y,T){var b=ar()?x:u;if(!b){v().assertConditionTag(!1,"Activity should not be undefined",y);var S=U3(T);b=WT(S!==hs.None?S:hs.Error,r,n.getState()),ar()||(u=b)}return Gn(b,"Perf activity not defined in error fallback case.",C.reserveTag(520168332)),b};switch(d.type){case"LOAD_DEFAULT_FILTER":{if(ar())break;tm&&!zC(n.getState())&&(tm=!1)}case"LOAD_FILTER":{nLe(t,r,n,d,o,g(u,C.reserveTag(520198025),d.type),c,l);break}case"UPDATE_FILTER_RANGE":{oLe(t,r,n,d,o,g(u,C.reserveTag(520198024),d.type),c,l);break}}return ar()&&ZI(n.getState())&&aLe(t,r,n,d.type,g),!ar()&&!tm&&zC(n.getState())&&(u=WT(hs.RequestDefaultFilter_unused,r,n.getState()),Sye(t,r,g(u,C.reserveTag(520168331),d.type),n),tm=!0),p}}}};function nLe(e,t,r,n,o,a,d,c){d===void 0&&Ju(r.getState(),n.payload.filteredRange.id)&&(o.set(n.payload.filteredRange.id,{filter:n.payload.filteredRange,changeToken:n.payload.filteredRange.onRangeUpdated.subscribe(function(u){rLe(t,r.dispatch,n.payload.filteredRange.id,n.actionDetail.renderContextType,o,u)})}),(n.type==="LOAD_DEFAULT_FILTER"||n.payload.shouldSetActive)&&Bi(r.getState())===n.payload.filteredRange.id&&((!ar()||Bi(r.getState())!==c)&&e.setActiveFilteredRange(n.payload.filteredRange.id),c&&c!==Bi(r.getState())&&(ar()||c!==Xu(r.getState()))&&r.dispatch(gf({renderContextType:n.actionDetail.renderContextType,telemetryVisitor:t,trackback:C.reserveTag(528779332)},{filterId:c,changes:[{type:"Teardown",teardownReason:Pd.RangeObsolete}]})))),a.successTag(C.reserveTag(520198023))}function oLe(e,t,r,n,o,a,d,c){Bi(r.getState())!==c&&e.setActiveFilteredRange(Bi(r.getState()));var u=Ju(r.getState(),n.payload.filterId);if(d&&u&&d.filter!==u.filter){var l=o.get(n.payload.filterId);!l||!l.filter.canBeUpdated()?j3(e,t,a,r,u.filter,!1,c===n.payload.filterId):l.filter.updateFilter(u.filter)?a.successTag(520198022):(v().assertConditionTag(!1,"The filter should have been able to update",528527826),j3(e,t,a,r,u.filter,!1,c===n.payload.filterId))}var p=function(){return n.payload.changes.findIndex(function(x){return x.type==="Teardown"})>=0};if(!Ju(r.getState(),n.payload.filterId)){v().assertConditionTag(p(),"Range should not be removed unless there was a Teardown",528749966);var g=o.get(n.payload.filterId);g&&(g.filter.teardown(),g.changeToken.unsubscribe(),o.delete(n.payload.filterId))}!ar()&&!tm&&!Xu(r.getState())&&(v().assertConditionTag(p(),"Default filter should not be removed unless there was a Teardown",528749967),Sye(e,t,a,r)),a.isEnded()||a.successTag(520198021)}var iLe=function(t,r,n){return t==null||t.failTag(r,-2147467259),pe(n)},j3=function(t,r,n,o,a,d,c){t.createFilteredRange({contentTypes:[wt.CommentThread],filters:a,supportsFilterUpdates:d}).then(function(u){o.dispatch(mf({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(528532107)},{filteredRange:u,shouldSetActive:c})),n.successTag(520198020)}).catch(ar()?function(u){n.failTag(C.reserveTag(507597955),-2147467259),pe(C.reserveTag(507597956))(u)}:iLe(n,C.reserveTag(520198019),C.reserveTag(528532108)))},aLe=function(t,r,n,o,a){if(!V3){V3=!0;var d=WT(hs.LoadActiveFilter,r,n.getState()),c=a(d,C.reserveTag(507794050),o);sLe(t,r,n,c).catch(function(u){v().assertConditionTag(!1,"Failed to load active filter. Error: ".concat(so(u)),507794049),c.failTag(C.reserveTag(507794048),-2147467259)}).finally(function(){V3=!1})}},sLe=function(t,r,n,o){return Gt(void 0,void 0,void 0,function(){var a,d,c,u,l,p,g;return gt(this,function(h){switch(h.label){case 0:return(p=Bi(n.getState()))!==null&&p!==void 0?(d=p,[3,3]):[3,1];case 1:return[4,t.getActiveFilteredRangeId()];case 2:d=h.sent(),h.label=3;case 3:return a=d,a?[4,t.getFilteredRange(a)]:[3,5];case 4:if(c=h.sent(),c)return n.dispatch(mf({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(507794018)},{filteredRange:c,shouldSetActive:!0})),o.successTag(507597954),[2];h.label=5;case 5:return u=wn,l=!!(!((g=or(n.getState()))===null||g===void 0)&&g.supportsFilterByUser),l&&(u=m(m({},wn),{userFilter:[]})),j3(t,r,o,n,u,!0,!0),[2]}})})},Sye=function(t,r,n,o){t.createFilteredRange({contentTypes:[wt.CommentThread],filters:wn,supportsFilterUpdates:!0}).then(function(a){o.dispatch(WS({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(528779333)},{filteredRange:a})),n.successTag(520198018),tm=!1}).catch(function(a){v().assertConditionTag(!1,"Error creating new filter: ".concat(so(a)),528779334),n.failTag(C.reserveTag(520198017),-2147467259),tm=!1})};s();xt();xf();Et();var Iye=function(t){return function(r){return function(n){return function(o){var a,d,c=r.getState(),u=n(o),l=r.getState();switch(o.type){case"BEGIN_DRAFTING_SUCCESS":{var p=fe(l),g=o.payload.draftDetails.sessionConfiguration.draftId,h=p.drafts[g];h&&t.setDeferredActiveEditorFocusCommand(g);break}case"DISPLAY_DRAFT_WARNING":{if(o.payload.draftWarningType===Hr.CommitFailed)break;var p=fe(l),h=Dd(p);h&&t.setDeferredActiveEditorFocusCommand(h.sessionConfiguration.draftId);break}}return(((a=ve(l))===null||a===void 0?void 0:a.selectedCardId)!==((d=ve(c))===null||d===void 0?void 0:d.selectedCardId)||fe(l)!==fe(c))&&t.clearPendingOnComponentFocusedRequest(),u}}}};s();Cm();Mi();Qa();Ti();mi();Ir();ue();vo();xf();var Eye=function(t){return function(r){return function(n){return function(o){switch(o.type){case"DISPLAY_DRAFT_WARNING":{if(!Pn())break;var a=NI(t,o.payload.draftWarningType),d=bm()&&Y()==="win32"&&(o.payload.draftWarningType===Hr.GrantAccessFailedSilently||o.payload.draftWarningType===Hr.GrantAccessCanceled)&&ca(r.getState())===vt.Visible;si(o.payload.draftWarningType===Hr.ReturnToDraft?t.formatString(230,a):a,d?{nativeId:Qn(Q.PaneRoot)}:void 0);break}}return n(o)}}}};s();k();te();rt();Z();Ps();sf();yf();Mi();Yw();Mc();Cr();un();s();OC();Fd();xt();Et();el();mo();s();te();Z();s();var Pye=1e3,_ye=5e3;var GT;(function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"})(GT||(GT={}));function zT(e){e.timerHandle&&clearTimeout(e.timerHandle)}var Rye=function(){function e(t){var r=this;this.telemetryVisitor=t,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(n,o,a){var d=r.performanceActivities[n];d&&(d.activity.failTag(o,a??-2130957541),zT(d),delete r.performanceActivities[n])},this.timeoutTracker=function(n,o,a){var d=r.performanceActivities[n];d&&(zT(d),d.activity.addDataField("Timeout",!0,N.SystemMetadata),o.failOnTimeout?d.activity.failTag(a,-2130957491):d.activity.successTag(a),delete r.performanceActivities[n])}}return e.prototype.beginTracking=function(t,r,n,o,a){var d=this;a===void 0&&(a={timeout:Pye,failOnTimeout:!0});var c=o||v().createActivityObject(this.trackerActivityName,this.telemetryVisitor,be());c.addDataField("OperationType",n,N.SystemMetadata),this.performanceActivities.hasOwnProperty(t)&&(v().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(t,C.reserveTag(595907678)));var u={activity:c,expectedChangeType:r};u.timerHandle=setTimeout(function(){return d.timeoutTracker(t,a,C.reserveTag(575484417))},a.timeout),this.performanceActivities[t]=u},e.prototype.updateTrackerId=function(t,r){if(t!==r){this.performanceActivities.hasOwnProperty(r)&&(v().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(r,C.reserveTag(595132705)));var n=this.performanceActivities[t];n&&(this.performanceActivities[r]=n,delete this.performanceActivities[t])}},e.prototype.failAllTrackers=function(t,r){var n=this;Object.keys(this.performanceActivities).forEach(function(o){var a=n.performanceActivities[o];zT(a),a.activity.failTag(t,r??-2130957541)}),this.performanceActivities={}},e.prototype.endTracker=function(t,r,n){var o=this.performanceActivities[t];o&&(zT(o),o.activity.addDataField("ExpectedChangeArrived",o.expectedChangeType===r?GT.Yes:GT.No,N.SystemMetadata),o.activity.successTag(n),delete this.performanceActivities[t])},e.prototype.endAllTrackers=function(t){for(var r in this.performanceActivities){var n=this.performanceActivities[r];zT(n),n.activity.addDataField("ExpectedChangeArrived",GT.Unknown,N.SystemMetadata),n.activity.successTag(t)}this.performanceActivities={}},e.prototype.getTracker=function(t,r){var n=this.performanceActivities[t];if(n&&n.expectedChangeType===r)return n},e}();s();Z();ho();var Aye=function(){function e(t){this.telemetryVisitor=t,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(t){var r=pi(t);this.activity&&r!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",N.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),!this.activity&&!this.selectedCommentId&&(this.activity=v().createActivityObject(this.trackerActivityName,this.telemetryVisitor,be()),this.selectedCommentId=r)},e.prototype.endTrackingIfWarningDismissed=function(t,r){var n=pi(r);!this.activity||n===this.selectedCommentId&&Rs(r)||(this.activity.addDataField("OperationType",t.type,N.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function kye(e,t){t?e.addDataField("AffectingTaskMetadata",!0,N.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,N.SystemMetadata)}function W3(e,t,r,n){var o=Mr(t,n);if(o){var a=$e(o),d;fi(t)?d=r[a].some(function(c){return(t[c].commentFlags&Fe.IsNew)!==0}):d=t.some(function(c){return(c.commentId===a||c.parentId===a)&&(c.commentFlags&Fe.IsNew)!==0}),d&&e.addDataField("HasNewComment",d,N.SystemMetadata)}}var Dye=function(t){var r=new Rye(t),n=new Aye(t),o="LoadCommentTracker",a=zn(function(d){var c=v().createActivityObject("PostButtonTeachingCallout",d.actionDetail.telemetryVisitor,be());c.successTag(573687565)});return function(d){return function(c){return function(u){var l,p,g=function(){var re,ae,ie,Te,Oe,ke,it=wk(u);if(!it)return v().assertConditionTag(!1,"Event name not defined for action type: ".concat(u.type),595616738),c(u);var _e=v().createActivityObject(it.name,u.actionDetail.telemetryVisitor,it.activityConfig);_e.addDataField("Trackback",u.actionDetail.trackback,N.SystemMetadata),_e.addDataField("RenderContextType",u.actionDetail.renderContextType,N.SystemMetadata),it.logDocumentMetadata&&_e.addDocumentMetadata(it.logDocumentMetadata);var ct=function(am,_Ce,Q3){var Lk=eg(am,Q3);Lk.valid&&(_e.addDataField("MatchesCommentAuthor",Lk.matchesCurrentUser,N.SystemMetadata),_e.addDataField("ThreadCreationDeltaMs",Lk.timeElapsed,N.SystemMetadata)),W3(_e,am,_Ce,Q3)},Ge=d.getState(),Nt=Xo(Ge);switch(ig(Ge,_e),u.type){case"COMMIT_DRAFT":var Vt=xye(u);if(!Vt)return v().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),c(u);var yt=v().createActivityObject(Vt.name,u.actionDetail.telemetryVisitor,be());yt.addDataField("RenderContextType",u.actionDetail.renderContextType,N.SystemMetadata),yt.successTag(595903074);var zt=Bm[u.payload.sessionType];_e.addDataField("SessionType",zt,N.SystemMetadata),u.payload.sessionType==="REPLY"&&W3(_e,Ft(Ge),Yn(Ge),u.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":_e.addDataField("DraftWarningType",u.payload.draftWarningType,N.SystemMetadata),_e.addDataField("DraftWarningReason",u.payload.draftWarningReason,N.SystemMetadata);var Fr=We(Ge.commentState.draftState);Fr&&_e.addDataField("IsDraftInCurrentContext",Fr.isInCurrentContext,N.SystemMetadata);break;case"UPDATE_DRAFT_RENDER_CONTEXT":_e.addDataField("IsClaimingDraftLock",u.payload.isClaimingLock,N.SystemMetadata),_e.addDataField("IsUpdatingAllDraftLocks",!u.payload.draftId,N.SystemMetadata);break;case"SELECT_COMMENT":_e.addDataField("SelectType",Ee[u.payload.selectType],N.SystemMetadata),_e.addDataField("ActionSource",ce[u.payload.source],N.SystemMetadata);var In=ve(Ge),jn=!!(In&&In.selectedCardId===u.payload.selectedCard);_e.addDataField("IsCurrentCard",jn,N.SystemMetadata),jn||W3(_e,Ft(Ge),Yn(Ge),u.payload.selectedCard),K8(u.payload.source)&&Y8(u.payload.selectType)&&II(_e,hf(aE(Ge,u.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":kye(_e,u.payload.isTask),ct(Ft(Ge),Yn(Ge),u.payload.commentId);var io=void 0;if(u.payload.isTask){io=u.type==="REQUEST_THREAD_RESOLVE"?"ResolveThreadWithTask":"ReopenThreadWithTask",_e.addDataField(io,!0,N.SystemMetadata,ko.Critical);var ut=(ie=(ae=(re=Nt[u.payload.commentId])===null||re===void 0?void 0:re.history[0])===null||ae===void 0?void 0:ae.records[0])===null||ie===void 0?void 0:ie.time;_e.addDataField("TaskCreationTimeDeltaMs",ut?Date.now()-ut.getTime():0,N.SystemMetadata,ko.Critical)}II(_e,hf(aE(Ge,u.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(kye(_e,u.payload.isTask),u.payload.isTask){_e.addDataField("DeleteThreadWithTask",!0,N.SystemMetadata,ko.Critical);var ut=(ke=(Oe=(Te=Nt[u.payload.commentId])===null||Te===void 0?void 0:Te.history[0])===null||Oe===void 0?void 0:Oe.records[0])===null||ke===void 0?void 0:ke.time;_e.addDataField("TaskCreationTimeDeltaMs",ut?Date.now()-ut.getTime():0,N.SystemMetadata,ko.Critical)}II(_e,hf(aE(Ge,u.payload.commentId))),ct(Ft(Ge),Yn(Ge),u.payload.commentId);break;case"REQUEST_DELETE_POST":ct(Ft(Ge),Yn(Ge),u.payload.commentId);break}try{var pn=d.getState(),ql=c(u),Sr=d.getState(),$r=fe(pn),ys=fe(Sr);switch(u.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var cd=u.payload.draftId?$r.drafts[u.payload.draftId]:We($r),im=u.payload.draftId?ys.drafts[u.payload.draftId]:We(ys),Mk=cd!==void 0&&im!==void 0&&cd.renderContextType!==im.renderContextType;_e.addDataField("DidDraftLockUpdate",Mk,N.SystemMetadata);break}return _e.successTag(595616739),ql}catch(yc){throw _e.failTag(595616768,ln(yc,-2130957541)),yc}};switch(u.type){case"BEGIN_PROCESSING_COMMIT":{var h=v().createActivityObject(r.trackerActivityName,u.actionDetail.telemetryVisitor,be());try{g()}catch(q){throw h.failTag(595687567,ln(q,-2130957541)),q}var x=Dn(d.getState());if(!x){h.failTag(595687569,-2130957541);break}var y=x.commentDraft.sessionConfiguration;r.beginTracking(y.draftId,$8[y.sessionType],y.sessionType,h);break}case"COMMIT_FAILURE":{var x=Dn(d.getState());v().assertConditionTag(!!x,"Draft should exist when failing a commit.",595132701),x&&r.failTracker(x.commentDraft.sessionConfiguration.draftId,C.reserveTag(595132702)),c(u);break}case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":r.beginTracking(u.payload.commentId,tt.Modify,u.type);try{g()}catch(q){throw r.failTracker(u.payload.commentId,C.reserveTag(595907670),ln(q,-2130957541)),q}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":r.beginTracking(u.payload.commentId,tt.Delete,u.type);try{g()}catch(q){throw r.failTracker(u.payload.commentId,C.reserveTag(595907671),ln(q,-2130957541)),q}break;case"COMMENT_CONTEXT_CHANGED":{try{c(u)}catch(q){throw r.failAllTrackers(C.reserveTag(595731294),ln(q,-2130957541)),q}break}case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":var T=u.type==="LOAD_COMMENT"?u.payload.commentData:u.payload.threadInfo,b=T.length>0;if(b&&!r.getTracker(o,tt.Load)){var h=v().createActivityObject(r.trackerActivityName,u.actionDetail.telemetryVisitor,be());r.beginTracking(o,tt.Load,u.type,h,{timeout:_ye,failOnTimeout:!1})}c(u);break;case"RELOAD_COMMENTS":try{g()}catch(q){throw r.failAllTrackers(C.reserveTag(595907672),ln(q,-2130957541)),q}r.endAllTrackers(C.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var S=r.getTracker(o,tt.Load);S&&(S.activity.addDataField("RenderContextType",u.payload.renderContextType,N.SystemMetadata),r.endTracker(o,tt.Load,C.reserveTag(595646476))),c(u);break;case"APPLY_COMMENT_CHANGES":try{g()}catch(q){throw r.failAllTrackers(C.reserveTag(595907674),ln(q,-2130957541)),q}try{for(var E=qe(u.payload.changes),P=E.next();!P.done;P=E.next()){var _=P.value;if(_.type===tt.Load||_.type===tt.Unknown)break;if(_.type===tt.Delete||_.type===tt.Modify){r.endTracker(_.model.commentId,_.type,C.reserveTag(595907675));continue}if(_.type===tt.Insert){_.tempId!==void 0&&_.model.parentId===""&&_W(u.actionDetail.telemetryVisitor);var D=_.tempId||_.model.parentId;D!==void 0&&r.endTracker(D,_.type,C.reserveTag(595857620))}}}catch(q){l={error:q}}finally{try{P&&!P.done&&(p=E.return)&&p.call(E)}finally{if(l)throw l.error}}break;case"COMMIT_DRAFT":{var x=Dn(d.getState());if(g(),u.payload.data.temporaryCommentId&&x){var O=void 0,y=x.commentDraft.sessionConfiguration;switch(y.sessionType){case"CREATE":{u.actionDetail.telemetryVisitor,O=u.payload.data.temporaryCommentId;break}case"REPLY":{O=u.payload.data.temporaryCommentId;break}case"EDIT":{O=y.commentId;break}case"METADATA":{O=y.threadId;break}default:Ne(y)}O&&r.updateTrackerId(y.draftId,O)}break}case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":g();break;case"SHOW_LOW_FIDELITY_WARNING":g();var H=ve(d.getState());H&&n.beginTracking(H);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":{var V="";switch(u.payload.visibilityState){case vt.Closed:V="ViewContainerClosed";break;case vt.Hidden:V="ViewContainerHidden";break;case vt.Visible:V="ViewContainerVisible";break;default:Ne(u.payload.visibilityState)}var M=v().createActivityObject(V,u.actionDetail.telemetryVisitor,{aggregationMode:co.Always});c(u),M.successTag(592241220);break}case"DRAFT_EMPTINESS_CHANGED":var G=fe(d.getState()),K=G.drafts[u.payload.draftId],z=K.commentDraft.sessionConfiguration.sessionType;(z===fo||z===Ko)&&a(u),c(u);break;case"CLEAR_COMMENT_SELECTION":default:c(u);break}var $=ve(d.getState());$&&n.endTrackingIfWarningDismissed(u,$)}}}};s();te();Z();uw();Mi();Mu();bS();Cn();ue();yE();xt();Rn();Et();$p();vo();var Fye=function(t,r){return function(n){return function(o){return function(a){switch(a.type){case"REQUEST_SHOW_PANE":{var d=$n(n.getState());d.openView();break}case"REQUEST_CLOSE_PANE":{var d=$n(n.getState());d.closeView();break}case"MOVE_FOCUS_TO_CANVAS":{if(!Cy(n.getState())){var d=$n(n.getState());d.moveFocusToCanvas_donotuse()}break}case"REQUEST_MODAL_CONFIRMATION":{var d=$n(n.getState());d.invokeModalConfirmationDialog?d.invokeModalConfirmationDialog(a.payload.onConfirm,a.payload.onCancel,a.payload.displayStrings):(v().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),d.closeView());break}case"READY_TO_RENDER":{var d=$n(n.getState());d.onReadyToRender&&d.onReadyToRender();break}case"RESOLVE_ATMENTION_CAPABILITY":{if(md()){var c=a.payload.capability===Rt.Enabled;r.initializeController(c)}break}case"BEGIN_DRAFTING_SUCCESS":{var d=$n(n.getState());Ou(d)&&a.payload.draftDetails.sessionConfiguration.sessionType==="CREATE"&&Fk(n.dispatch,a.actionDetail,{displayMode:po.Variable,desiredHeight:0}),wye(n.getState(),d);break}case"DISPLAY_DRAFT_WARNING":{wye(n.getState());break}case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":{if(a.payload.closeOnDiscard){var d=$n(n.getState());o(a),d.closeView();return}break}}var u=n.getState(),l=o(a),p=n.getState();return cLe(n.dispatch,a.actionDetail,u,p),l}}}};function dLe(e){var t=ca(e);return Oi()&&(Kt()?t===vt.Hidden:t!==vt.Visible)}function wye(e,t){if(dLe(e)){var r=t||$n(e);r.openView()}}function Fk(e,t,r){e(Of(t,r)).catch(pe(C.reserveTag(578426776)))}function cLe(e,t,r,n){var o=$n(n);if(Ou(o)){var a=fe(n),d=fe(r),c=Yo(a),u=Yo(d),l=!!Je(a),p=!!Je(d);if(c!==u||!Ou($n(r))||!l&&p){if(!c){if(l){Fk(e,t,{displayMode:po.Variable,desiredHeight:0});return}Fk(e,t,{displayMode:po.Normal});return}var g=ve(n);if(g&&g.selectedCardId===Je(a))return;Fk(e,t,{displayMode:po.FullScreen});return}}}function Oye(e,t,r,n,o,a,d,c,u){var l=u?[bye(u,n)]:[],p=xp(Cx.apply(void 0,w([Fhe,whe,khe,Tye,Dye(n),gye(e,n),vye(n),Iye(d),Fye(t,c),Eye(a),yye(n),Cye(o)],j(l),!1))),g=vp(fye,r,p);return d.initialize(g,!!o),g}ue();s();k();s();k();te();rt();bd();Z();UF();Do();Jy();ui();_m();pd();rC();Es();SS();Be();s();ue();un();Et();vo();var Nye=function(){function e(t,r,n){this.commentStore=t,this.commandFactory=new Sk(this.commentStore,r,n)}return e.prototype.selectNextOrPreviousThread=function(t,r,n){var o=Kt()&&!Oo(this.commentStore.getState()),a=Fs(this.commentStore.getState());return Wl(this.commandFactory.selectNextOrPreviousThread(void 0,t,r,n,o),a,this.commentStore,function(){})===Di.Handled},e.prototype.selectAcrossContexts=function(t,r){var n=Fs(this.commentStore.getState()),o=wd(this.commentStore.getState()),a=Kt()&&!Oo(this.commentStore.getState());Wl(this.commandFactory.selectAcrossContexts(void 0,{direction:t,source:ce.SharedComments,expandCard:!0,iterableContentTypes:void 0},r,o.nextPopulatedContextDetails,a),n,this.commentStore,function(){})},e}();ZE();n0();gi();xT();s();k();var Ok=I(L());function z3(e,t){var r=function(n){X(o,n);function o(){return n!==null&&n.apply(this,arguments)||this}return o.prototype.render=function(){var a=m(m({},t),this.props);return Ok.createElement(e,a)},o}(Ok.PureComponent);return r}s();k();var qT=I(L());bs();function G3(e,t){return function(r){X(n,r);function n(){return r!==null&&r.apply(this,arguments)||this}return n.prototype.render=function(){return qT.createElement(af,{store:t},qT.createElement(e,m({},this.props)))},n}(qT.PureComponent)}s();k();te();rt();Z();Do();Md();Pm();Dc();pd();JC();Wm();Be();Ff();yv();gB();mv();Qo();_f();Cn();Mc();ue();s();te();var OOr=C.reserveTag(595723983),NOr=C.reserveTag(595723984),Mye=C.reserveTag(574456150),Lye=C.reserveTag(574456151),Hye=C.reserveTag(574456152),Bye=C.reserveTag(574456153);un();vl();xt();Rn();Et();vo();el();mo();s();var Uye=function(){function e(t){this.mockContents="",this.mockId="",t&&(this.mockId=t)}return e.prototype.getId=function(){return this.mockId},e}();var Vye=function(){function e(t,r){var n=this;this.viewManager=t,this.mockUIDriver=r,this.pendingActionReason=Le.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(o){return Oo(o)?Fs(o):n.viewManager.getComponentTreeForRenderMode(se.Integrated)},this.makeGetRenderableItemThreads=function(o){return _n([fe,Co,Vi,o,n.getActiveComponentTree],function(a,d,c,u,l){return WC(u,c,d,l.componentTreeId.renderContextType!==A.HalfPane,fy(a,l.componentTreeId.renderContextType))})},this.getCompleteHostableCommentCardRendererOwnProps=function(o){return m(m({},n.viewManager.getHostableCommentCardRendererProps(se.Integrated)),{resource:{id:o},componentInstanceId:ao()})},this.getCompletePaneOwnProps=function(){return m(m({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(o){var a=void 0,d=n.commentStore.getState(),c=n.commentStore.dispatch;return Oo(d)?a=ol(c,n.getCompletePaneOwnProps()):a=xE(c,n.getCompleteHostableCommentCardRendererOwnProps(o)),a},this.getNewThreadDraftId=function(){return Je(fe(n.commentStore.getState()),!0)},this.getParentId=function(o){var a=n.commentStore.getState(),d=Ft(a),c=Mr(d,o);return c?$e(c):void 0},this.invokeModalDialog=function(o,a,d){var c=n.commentStore.getState(),u={renderContextType:n.getActiveComponentTree(c).componentTreeId.renderContextType,trackback:C.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},l=n.commentStore.dispatch,p=n.getCompletePaneOwnProps(),g=ol(l,p),h=ve(c);switch(o){case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:return g.discardDraftAsync(u,ce.SharedComments,!1);case ur.DeleteThread:return h&&g.requestDeleteThread(u,h.selectedCardId),Promise.resolve(He.Handled);case ur.ClosePaneDraft:return hv({ownProps:p,dispatchProps:g,componentTree:n.getActiveComponentTree(c),draftState:fe(c),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(He.Handled);default:Ne(o)}},this.updateEventProcessingState=function(o){var a=ji(n.previousStoreState),d=ji(o);!a&&d&&n.pauseProcessing(),a&&!d&&n.beginProcessing()},this.handleStoreUpdate=function(){var o=n.commentStore.getState(),a=fe(o),d=fe(n.previousStoreState),c=lr(a);!c&&n.pendingActionReason===Le.NeedNotDrafting&&n.pendingAction&&(v().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent}).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Le.None);var u=$o(a),l=$o(d);u&&!l&&n.pendingActionReason===Le.NeedDrafting&&n.pendingAction&&(v().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent}).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Le.None),n.updateEventProcessingState(o),n.previousStoreState=o},this.onDrafting=function(o){var a=v().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});$o(fe(n.commentStore.getState()))?(a.addDataField("ActionDeferred",!1,N.SystemMetadata),o(),a.successTag(592269460)):(a.addDataField("ActionDeferred",!0,N.SystemMetadata),n.pendingAction=o,n.pendingActionReason=Le.NeedDrafting,a.successTag(592269461))},this.onNotDrafting=function(o){var a=v().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});lr(fe(n.commentStore.getState()))?(a.addDataField("ActionDeferred",!0,N.SystemMetadata),n.pendingAction=o,n.pendingActionReason=Le.NeedNotDrafting,a.successTag(592269462)):(a.addDataField("ActionDeferred",!1,N.SystemMetadata),o(),a.successTag(592269463))},this.runAction=function(o,a){switch(o){case Le.NeedDrafting:return n.onDrafting(a);case Le.NeedNotDrafting:return n.onNotDrafting(a);case Le.None:return a()}},this.onMockUIAction=new sm(function(o){var a=v().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});a.addDataField("MockUIActionType",o.actionType,N.SystemMetadata);try{switch(o.actionType){case Ke.CreateThread:eS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCreateOrReply(new ps(n.getNewThreadDraftId(),o.content))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case Ke.CancelCreateThread:tS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelCreateThread(new ps(n.getNewThreadDraftId()))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case Ke.StartReplySession:rS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onStartReplySession(new ps(o.threadId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case Ke.CancelReplySession:nS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelReplySession(new ps(o.threadId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case Ke.PostReply:oS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCreateOrReply(new ps(o.threadId,o.content))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case Ke.DeleteComment:iS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onDeleteComment(o.commentId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case Ke.DeleteThread:aS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onDeleteThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case Ke.ResolveThread:sS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onResolveThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case Ke.ReopenThread:dS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onReopenThread(o.threadId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case Ke.StartEditSession:cS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onStartEditSession(o.commentId)}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case Ke.CancelEditSession:uS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelEditSession(new Qp(o.commentId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case Ke.PostEdit:if(lS(o)){var d=new Qp(o.commentId);d.setContents(o.content),n.runAction(Le.NeedDrafting,function(){return n.onPostEdit(d)})}else v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Ke.SelectComment:fS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onSelectComment(new Uye(o.commentId))}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case Ke.ClosePane:n.onClosePane();break;case Ke.ClickGhostCard:pS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onGhostCommentClicked()}):v().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Ne(o.actionType)}}catch(c){a.failTag(592269507,ln(c));return}a.successTag(592269508)}),this.onStartEditSession=function(o){var a=n.commentStore.getState();Ag({trackback:C.reserveTag(592269509),id:o,data:n.getFilteredRenderableItems(a),selectedComment:ve(a),renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(o),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(o,a){var d=n.commentStore.getState();qf({componentTree:n.getActiveComponentTree(d),focusManager:n.viewManager.getFocusManager(),trackback:C.reserveTag(592269510),id:o,renderContextType:n.getActiveComponentTree(d).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(o),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:a})},this.onClosePane=function(){var o=n.commentStore.getState();if(Ci(o)){var a=n.commentStore.dispatch,d=ol(a,n.getCompletePaneOwnProps());d.requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:A.None,trackback:C.reserveTag(592269511)})}else v().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(o){var a=o.getId(),d=n.commentStore.getState(),c=fe(d),u=We(c),l=u&&u.commentDraft.sessionConfiguration.sessionType==="CREATE"?{type:"CREATE"}:{type:"REPLY",parentId:a};Fg({trackback:C.reserveTag(592269513),commentCardRef:o,draftState:c,areMentionsEnabled:Br(d).atMention===Rt.Enabled,session:l,componentTree:n.getActiveComponentTree(d),dispatchProps:n.getDispatchProps(a),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:eo.Programmatic}).catch(pe(C.reserveTag(592269514)))},this.onCancelCreateThread=function(o){var a=o.getId(),d=n.getDispatchProps(a),c=n.commentStore.getState(),u=ve(c),l=fe(c),p=Ci(c),g=n.getActiveComponentTree(c).componentTreeId.renderContextType,h=tl(c),x=(u==null?void 0:u.selectedCardId)===o.getId()&&Us(p,g,l,u,h),y=Rf(n.getRenderableItemThreads(c),a);ml({trackback:C.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(c),dispatchProps:d,closeOnDiscard:x,cardId:a,draftState:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:y})},this.onGhostCommentClicked=function(){var o=n.commentStore.getState(),a=Ci(o);a||v().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(Qt.Next,n.getActiveComponentTree(o).componentTreeId.renderContextType)},this.onPostEdit=function(o){var a=n.commentStore.getState(),d=n.getParentId(o.getId());d&&kg({trackback:C.reserveTag(592269518),id:o.getId(),data:n.getFilteredRenderableItems(a),draftState:fe(a),contentPromise:o.getContentsAsync(),atMentionsEnabled:Br(a).atMention===Rt.Enabled,componentTree:n.getActiveComponentTree(a),actionDispatchers:n.getDispatchProps(d),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:eo.Programmatic}).catch(pe(C.reserveTag(592269519)))},this.onCancelEditSession=function(o){var a=n.commentStore.getState(),d=fe(a),c=ve(a),u=Ci(a),l=tl(a),p=Us(u,n.getActiveComponentTree(a).componentTreeId.renderContextType,d,c,l),g=n.getFilteredRenderableItems(a),h=n.getParentId(o.getId());if(h){var x=n.getDispatchProps(h);zf({trackback:C.reserveTag(592269521),commentId:o.getId(),setContents:o.setContents.bind(o),data:g,draftState:d,shouldClosePaneAfterDiscardDraft:p,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,dispatchProps:x,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(o){var a=n.commentStore.getState(),d=ve(a),c=fe(a),u=o.getId(),l=n.getDispatchProps(u),p=Ci(a),g=n.getActiveComponentTree(a).componentTreeId.renderContextType,h=tl(n.commentStore.getState()),x=(d==null?void 0:d.selectedCardId)===o.getId()&&Us(p,g,c,d,h);ml({trackback:C.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(a),dispatchProps:l,closeOnDiscard:x,cardId:o.getId(),draftState:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(o){var a=n.commentStore.getState(),d=ve(a),c=n.getDispatchProps(o);Ng({trackback:C.reserveTag(592269523),id:o,data:n.getFilteredRenderableItems(a),selectedComment:d,componentTree:n.getActiveComponentTree(a),invokeModalDialog:n.invokeModalDialog,dispatchProps:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!Xo(a)[o],threadIndex:Rf(n.getRenderableItemThreads(a),o),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(o){var a=n.commentStore.getState(),d=ve(a),c=n.getParentId(o);if(c){var u=n.getDispatchProps(c);Rg({trackback:C.reserveTag(592269524),id:o,data:n.getFilteredRenderableItems(a),selectedComment:d,renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,actionDispatchers:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(o){var a,d=n.commentStore.getState(),c=Co(d,!0),u=n.getNewThreadDraftId(),l=n.getFilteredRenderableItems(d),p=o.getId(),g=!ir()&&p===u?c&&{commentModel:c.newComment_deprecated}:l.find(function(E){return yo(E)===p});if(!g||!Pr(g)){v().assertConditionTag(!1,"Selection coming from an unknown post?",592269525);return}var h=g,x=n.getDispatchProps((a=h.commentModel.parentId)!==null&&a!==void 0?a:h.commentModel.commentId),y=ve(d),T=fe(d),b=n.getActiveComponentTree(d),S=ua(Fo(g),da(d),b.componentTreeId.renderContextType);Dg({trackback:C.reserveTag(592269526),renderableItem:g,selectedComment:y,cardCollapsedState:S,dispatchProps:x,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:b,draftState_deprecated:T}).catch(pe(C.reserveTag(590123734)))},this.onStartReplySession=function(o){wg({trackback:C.reserveTag(592269527),threadId:o.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(o.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=oE(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var t=v().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),t.successTag(Hye)},e.prototype.teardown=function(){var t,r=v().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});(t=this.registrationToken)===null||t===void 0||t.unsubscribe(),this.unsubscribeStoreListener(),r.successTag(Bye)},e.prototype.beginProcessing=function(){var t=this,r=v().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});this.startProcessingActionsPending=setTimeout(function(){t.onMockUIAction.startProcessing(),t.startProcessingActionsPending=void 0,r.successTag(Mye)},100)},e.prototype.pauseProcessing=function(){var t=v().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:qn.FullEvent});this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),t.successTag(Lye)},e.prototype.onReopenThread=function(t,r){Og({trackback:C.reserveTag(592269528),id:t,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(t),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:r})},e}();Cr();s();bd();Z();qw();function jye(e,t){return function(r){if(!(t.capabilities&La.GetSuggestionsDetails))return Promise.resolve();var n=v().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,{aggregationMode:co.OnSuccess});return t.getSuggestionsDetails?t.getSuggestionsDetails().then(function(o){n.successTag(592492760),r(Hm(e,o))},function(o){n.failTag(592492761,-2130957495)}):(n.failTag(592492759,-2130957494),Promise.resolve())}}s();Do();Tw();function KT(e,t,r,n){return function(o){return Mb().registerExtension(t,r,n).then(function(a){return o(ES(e,a)),a})}}s();Z();Ps();Mc();Uw();function Wye(e,t){return function(r){var n=v().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,be());return t.checkAtMentionCapability().then(function(o){n.addDataField("AtMentionsEnabled",o,N.SystemMetadata),n.successTag(595903522),r(xC(e,o?Rt.Enabled:Rt.Disabled))},function(o){n.failTag(595903523,ln(o,-2130957528)),r(xC(e,Rt.Disabled))})}}Fd();xt();Et();Ui();Ui();vo();s();te();function q3(e){switch(e){case"ExtensionAwareCommentPaneContainer":return Promise.resolve((e3(),Hk(Pge)));case"HostableCommentCardRendererContainer":return Promise.resolve((Zye(),Hk(Jye)));default:Ne(e)}}Cn();ue();s();var eCe="SharedCommentPane",tCe="TaskPaneItemCommentCard",rCe="DiscreteIntegratedCommentCard",nCe="DiscreteIsolatedCommentCard";function K3(e,t){return"".concat(e,"-").concat(t)}s();var oCe=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(t,r,n){this.hostableComponentRegistry.has(t)||this.hostableComponentRegistry.set(t,new Map);var o=this.hostableComponentRegistry.get(t);if(!n){o.delete(r);return}o.set(r,n)},e.prototype.getComponent=function(t,r){var n=this.hostableComponentRegistry.get(t);if(n)return n.get(r)},e}();var iCe=function(){function e(t){var r=t.apiContext,n=t.viewProvider,o=t.commentAPI,a=t.peopleAPI,d=t.localizationAPI,c=t.themeAPI,u=t.focusManager,l=t.lppManager,p=t.initializationReason,g=t.commentStore,h=t.viewStrategyFactory,x=t.mockUIDriver,y=t.contentFilteredRangeAPI,T=t.contentNavigationAPI,b=this;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(E){b.commentStore.dispatch(KS({renderContextType:A.None,trackback:C.reserveTag(595646478),telemetryVisitor:b.telemetryVisitor},{commentId:E.commentId,renderContextType:E.renderContextType})),$t(E.renderContextType)&&b.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=zn(function(){NT.sendCodeMarker({context:b.apiContext,type:Ty.DataReceived,assertTag:C.reserveTag(595731293)})}),this.getComponentTree=function(E){switch(E){case A.None:Gn(!1,"Unexpected render context type:".concat(E),C.reserveTag(589088338));case A.FullPane:case A.HalfPane:return b.getComponentTreeForRenderMode(se.TaskPaneItem);case A.DiscreteIntegrated:return b.getComponentTreeForRenderMode(se.Integrated);case A.DiscreteIsolated:return b.getComponentTreeForRenderMode(se.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:b.commentAPI,localizationAPI:b.localizationAPI,peopleAPI:b.peopleAPI,focusManager:b.focusManager,telemetryVisitor:b.telemetryVisitor,onInitialRender:b.onInitialRender,correlationId:b.correlationId,lppManager:b.lppManager}},this.setComponentRef=function(E,P,_){b.viewManagerRefRegistry.registerComponent(E,P,_)},this.onSuggestionsDetailsChange=function(E){b.commentStore.dispatch(Hm({renderContextType:A.None,trackback:C.reserveTag(592492758),telemetryVisitor:b.telemetryVisitor},E))},this.internalInterruptableCommandHandler=function(E){return b.activeViewStrategy.handleCommentInterruptableCommand(E,b.commentStore.dispatch,b.commentStore.getState)},this.createOrUpdateFilter=function(E){var P=b.contentFilteredRangeAPI;if(!P||!or(b.commentStore.getState())){v().assertConditionTag(!1,"Should not request new filter with gate off",528779338);return}if(ar()){if(ZI(b.commentStore.getState()))return}else{var _=zC(b.commentStore.getState());if(v().assertConditionTag(_||!!Xu(b.commentStore.getState()),"We should have a default filter already or a default filter request should be in flight.",528779339),_)return}var D=l7(b.commentStore.getState());D?b.updateFilter(D,E):(ar()&&v().assertConditionTag(!1,"In the UI layer, we should already have an active filter to update",507794013),b.createFilter(P,E))},this.updateFilter=function(E,P){b.commentStore.dispatch(gf({renderContextType:A.FullPane,telemetryVisitor:b.telemetryVisitor,trackback:C.reserveTag(528779344)},{filterId:E,changes:[{type:"FilterUpdate",updatedFilter:P}]}))},this.createFilter=function(E,P){E.createFilteredRange({contentTypes:[wt.CommentThread],filters:P,supportsFilterUpdates:!0}).then(function(_){b.commentStore.dispatch(mf({renderContextType:A.FullPane,telemetryVisitor:b.telemetryVisitor,trackback:C.reserveTag(528779340)},{filteredRange:_,shouldSetActive:!0}))}).catch(pe(C.reserveTag(528779341)))},this.apiContext=r,this.viewProvider=n,this.commentAPI=o,this.peopleAPI=a,this.localizationAPI=d,this.themeAPI=c,this.focusManager=u,this.contentFilteredRangeAPI=y,this.contentNavigationAPI=T,this.lastInitializationReason=p,this.viewStrategyFactory=h,this.mockUIDriver=x,this.telemetryVisitor=Sn.getTelemetryVisitor(this.apiContext),this.correlationId=Sn.getCorrelationId(this.apiContext)||ao(),this.lppManager=l,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new Nye(g,this.telemetryVisitor,!!this.contentNavigationAPI);var S=g.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(S.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=g,this.discreteIntegratedComponentTree=new zl(A.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new zl(A.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new oCe,this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new Vye(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var t=this.commentStore.dispatch;t(Wye({renderContextType:A.None,trackback:C.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},this.commentAPI)).catch(pe(C.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var t=this,r,n;this.initialized||(this.contentNavigationAPI&&(this.commentStore.dispatch(dI({renderContextType:A.None,trackback:C.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),(r=this.contentFilteredRangeAPI)===null||r===void 0||r.getCapabilities().then(function(o){var a;t.commentStore.dispatch(cI({renderContextType:A.None,trackback:C.reserveTag(537421135),telemetryVisitor:t.telemetryVisitor},{capabilities:o})),o!=null&&o.supportsFilterByUser&&(t.userFilterManager=(a=t.contentFilteredRangeAPI)===null||a===void 0?void 0:a.getUserFilterManager(),t.userFilterManager&&(t.userFilterManager.getFilterUsers().then(function(d){t.commentStore.dispatch(sI({renderContextType:A.None,trackback:C.reserveTag(507347608),telemetryVisitor:t.telemetryVisitor},{collaborators:d}))}).catch(pe(C.reserveTag(507347607))),t.userFilterManager.onUserFilterManagerEvent.subscribe(function(d){t.commentStore.dispatch(pI({renderContextType:A.None,trackback:C.reserveTag(507347606),telemetryVisitor:t.telemetryVisitor},{change:d.payload}))})))}).catch(pe(C.reserveTag(528779335))),ar()&&((n=this.contentFilteredRangeAPI)===null||n===void 0||n.onActiveFilterUpdated.subscribe(function(o){t.commentStore.dispatch(IS({renderContextType:A.None,trackback:C.reserveTag(507536257),telemetryVisitor:t.telemetryVisitor},{newActiveFilterId:o.newActiveFilterId}))}))),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),this.commentAPI.registerForInterruptableCommands!==void 0&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),Kt()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&La.GetSuggestionsDetails&&(this.commentStore.dispatch(jye({renderContextType:A.None,trackback:C.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},this.peopleAPI)).catch(pe(C.reserveTag(592492754))),v().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(t){!this.initialLoadComplete&&t&&ji(t)===void 0&&i7(t)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(t){var r=this,n,o=t.subscribe(function(){var a=t.getState(),d=ji(a);d!==n&&(n=d,r.onChange(a))});return o},e.prototype.onFirstLoadComplete=function(){var t=this;v().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach(function(r){t.onCommentUIAction(r)}),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Yt.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Yt.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yt.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yt.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Yt.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Yt.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(t){switch(t){case se.Integrated:return this.discreteIntegratedComponentTree;case se.Isolated:return this.discreteIsolatedComponentTree;case se.TaskPane:case se.TaskPaneItem:return Fs(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return m(m({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(t){var r=this;return m(m({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(t),setComponentRef:function(o,a){r.setComponentRef(t,o,a)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(t,r,n){var o=this,a=z3(n.HostableCommentCardRendererContainer,m({},this.getHostableCommentCardRendererProps(t))),d=G3(a,this.commentStore),c=K3(r,this.apiContext),u=tv().registerComponent(c,d);return u.onComponentCommand.subscribe(function(l){o.processHostableComponentCommand(l,t)}),{componentController:u,contextAwareName:c}},e.prototype.initializeContentExtensions=function(){var t=this;q3("ExtensionAwareCommentPaneContainer").then(function(r){var n=r;if(n!==void 0){var o=z3(n.ExtensionAwareCommentPane,m(m({},t.getPaneOwnProps()),{extensionRenderMode:se.Integrated,themeAPI:t.themeAPI})),a=G3(o,t.commentStore),d=K3(eCe,t.apiContext);t.commentPaneComponentController=tv().registerComponent(d,a),xm()&&t.commentStore.dispatch(KT({renderContextType:A.None,trackback:C.reserveTag(573384478),telemetryVisitor:t.telemetryVisitor},wt.CommentThread,d,{renderMode:se.TaskPane,priority:Ht.Disabled,instanceId:t.apiContext,componentDimensions:void 0})).catch(pe(C.reserveTag(573384479)))}var c;q3("HostableCommentCardRendererContainer").then(function(u){if(c=u,c!==void 0){var l=t.registerCommentCardHostableComponent(se.Integrated,rCe,c),p=l.componentController,g=l.contextAwareName;t.discreteIntegratedComponentController=p;var h=t.registerCommentCardHostableComponent(se.Isolated,nCe,c),x=h.componentController,y=h.contextAwareName;t.discreteIsolatedComponentController=x;var T=t.registerCommentCardHostableComponent(se.TaskPaneItem,tCe,c),b=T.componentController,S=T.contextAwareName;t.commentPaneItemComponentController=b,t.commentStore.dispatch(KT({renderContextType:A.None,trackback:C.reserveTag(574428426),telemetryVisitor:t.telemetryVisitor},wt.CommentThread,g,{renderMode:se.Integrated,priority:Ht.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch(pe(C.reserveTag(595645980))),t.commentStore.dispatch(KT({renderContextType:A.None,trackback:C.reserveTag(595616916),telemetryVisitor:t.telemetryVisitor},wt.CommentThread,y,{renderMode:se.Isolated,priority:Ht.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize(),isContentAvailable:function(P){var _=t.commentStore.getState(),D=e0(P,kn(_),Vi(_)),O=fe(_);return r0(P,t0(P,Ft(_),Yn(_),D,Co(_,!0),O.drafts[P],Je(O)),O,A.DiscreteIsolated,Wf(P,A.DiscreteIsolated,O))}})).catch(pe(C.reserveTag(595645982))),t.commentStore.dispatch(KT({renderContextType:A.None,trackback:C.reserveTag(546174344),telemetryVisitor:t.telemetryVisitor},wt.CommentThread,S,{renderMode:se.TaskPaneItem,priority:Ht.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch(pe(C.reserveTag(546174345)))}}).catch(pe(C.reserveTag(595645984)))}).catch(pe(C.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:VH,height:Bl({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(t,r){var n=this;switch(t.command){case"Focus":setTimeout(function(){var o;return(o=n.viewManagerRefRegistry.getComponent(r,t.details.componentInstanceId))===null||o===void 0?void 0:o.focus()});return;case"UpdateComponentDataProps":break;default:v().assertConditionTag(!1,"Unexpected command type",593786644);return}},e.prototype.teardownContentExtensions=function(){var t,r,n,o,a=[se.Integrated,se.Isolated,se.TaskPaneItem];xm()&&a.push(se.TaskPane),this.commentStore.dispatch(XS.apply(Id,w([{renderContextType:A.None,trackback:C.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],j(a),!1))),(t=this.commentPaneComponentController)===null||t===void 0||t.unregister(),(r=this.commentPaneItemComponentController)===null||r===void 0||r.unregister(),(n=this.discreteIntegratedComponentController)===null||n===void 0||n.unregister(),(o=this.discreteIsolatedComponentController)===null||o===void 0||o.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Yt.AddComment),this.commentAPI.unregisterForAction(Yt.NextThread),this.commentAPI.unregisterForAction(Yt.PreviousThread),this.commentAPI.unregisterForAction(Yt.DeleteThread),this.commentAPI.unregisterForAction(Yt.BackKeyPressed),this.commentAPI.unregisterForAction(Yt.ShowHideCommentPane),this.commentAPI.unregisterForInterruptableCommands!==void 0&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&La.GetSuggestionsDetails&&(v().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),Kt()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(t){this.commentUIActionListeners.push(t)},e.prototype.unregisterComponentUIActionListener=function(t){var r=this.commentUIActionListeners.indexOf(t);r>-1&&this.commentUIActionListeners.splice(r,1)},e.prototype.registerInterruptableCommandListener=function(t){this.commentInterruptableCommandListeners.push(t)},e.prototype.unregisterComponentInterruptableCommandListener=function(t){var r=this.commentInterruptableCommandListeners.indexOf(t);r>-1&&this.commentInterruptableCommandListeners.splice(r,1)},e.prototype.onCommentUIAction=function(t){var r,n;if(Kt()&&t.actionBehavior===ci.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(t),!0;try{for(var o=qe(this.commentUIActionListeners),a=o.next();!a.done;a=o.next()){var d=a.value,c=d(t);if(c!==dr.NotHandled)return c===dr.Success}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this.activeViewStrategy.processCommentUIAction(t,this.commentStore.dispatch,this.commentStore.getState)===dr.Success},e.prototype.onCommentEventReceived=function(t,r){var n=Oy(Yl.Comments,De[t]);this.activeViewStrategy.processCommentEvent(t,r,this.commentStore.dispatch,this.commentStore.getState),n==null||n.end(),Kt()&&!this.initialLoadComplete&&t===De.CommentContextChanged&&Is(r)&&r.numberOfComments===0&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(t){var r=Promise.resolve(He.Unhandled);return this.commentInterruptableCommandListeners.reduce(function(n,o){return n.then(function(a){return a!==He.Unhandled?Promise.resolve(a):o(t)})},r)},e.prototype.onViewContainerEvent=function(t){var r=this,n=this.commentStore.dispatch;switch(t.eventType){case li.VisibilityChanged:n(SI({renderContextType:A.None,trackback:C.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},t.viewContainerVisibilityState));return;case li.ViewContainerChanged:n(TI({renderContextType:A.None,trackback:C.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},t.newViewContainer)),this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(t.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor);return;case li.FocusTriggered:xm()?setTimeout(function(){r.focusManager.focusCommentPaneCommand(Fs(r.commentStore.getState()))}):this.focusManager.focusCommentPaneCommand(Fs(this.commentStore.getState()));return;case li.FoldableLayoutStateChanged:n(bI({renderContextType:A.None,trackback:C.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},t.newFoldableLayoutState))}},e}();var aCe=function(e){X(t,e);function t(r){var n=e.call(this,r)||this;return r.initializeImmediately&&n.beginInitialization(),n}return t.prototype.refreshAtMentionAuthToken=function(){},t}(iCe);s();k();rt();bd();Z();s();kH();s();wH();s();oL();s();var sCe="Prod";Ir();var nm,om,lLe=(nm={},nm.android="Android",nm.web="Web",nm.win32="Win32",nm.macos="Mac",nm.ios="iOS",nm),fLe=(om={},om.android="OfficeAndroid",om.web="OfficeWebApps",om.win32="OfficeWin32",om.macos=void 0,om.ios="OfficeiOS",om),dCe=function(t){var r=t.getMetadata();return{clientType:fLe[Y()],hostAppName:r.appName,hostAppPlatform:lLe[Y()],hostAppRing:r.releaseAudienceGroup||r.ring||r.releaseAudience,hostAppVersion:r.appVersion,complianceEnvironment:r.sovereignEnvironmentName?Nae(r.sovereignEnvironmentName):sCe}};s();var pLe={};function cCe(){return pLe}ue();var Nk;(function(e){e[e.Initialize=0]="Initialize",e[e.Refresh=1]="Refresh"})(Nk||(Nk={}));var uCe=function(){function e(t,r,n){var o=this;this.telemetryVisitor=r,this.online=!1,this.initialized=!1,this.refreshLPPAuthToken=function(){return o.peopleAPI.getAuthToken(Td.Loki)},this.peopleAPI=t,this.correlationId=n,this.accountId=ao()}return e.prototype.getAccountID=function(){return this.accountId},e.prototype.getLPPController=function(){if(this.isInitialized())return Fp},e.prototype.ensureLPPController=function(){return this.isInitialized()||this.initializeController(!1),Fp},e.prototype.initializeController=function(t){var r=t&&!this.online;this.isInitialized()||(this.online=t||this.online,this.initializeLPP(),this.initialized=!0,r=this.online),r&&(this.logLPPOnlineChange(Nk.Initialize),Fp.switchToOnlineMode(this.accountId),this.online=!0)},e.prototype.isInitialized=function(){return this.initialized},e.prototype.isOnline=function(){return this.online},e.prototype.refreshLPPController=function(){this.online||this.logLPPOnlineChange(Nk.Refresh),this.online=!0,this.initialized=!0,this.initializeLPP(),Fp.switchToOnlineMode(this.accountId)},e.prototype.initializeLPP=function(){var t,r=cCe();Fp.start(this.accountId,m(m(m({},dCe(v())),r),{complianceEnvironment:void 0,clientCorrelationId:this.correlationId,hostAppSupportsLogging:!0,refreshAuthToken:this.refreshLPPAuthToken,offline:!this.online,getLokiEndpoint:(t=this.peopleAPI.getLokiUrl)===null||t===void 0?void 0:t.bind(this.peopleAPI),settings:kb()?m(m({},r.settings),{suggestUseEmailAddress:!0}):r.settings}))},e.prototype.logLPPOnlineChange=function(t){var r=v().createActivityObject("LPPControllerOnlined",this.telemetryVisitor,be());r.addDataField("LPPOnlinedInRefresh",t,N.SystemMetadata),r.successTag(523618253)},e}();s();Ma();s();te();Z();Do();Md();Dc();ui();_m();VF();rC();Es();Mi();Vu();Be();yv();mv();n0();rg();Qo();Cr();un();YC();lE();uE();s();Z();s();function lCe(e){return e.draftContent!==void 0&&e.draftContent.content!==void 0&&e.draftingParams!==void 0&&e.draftingParams.sessionType!==void 0&&e.draftingParams.draftId!==void 0}kI();Et();Fm();Vw();YC();function fCe(e,t,r,n,o){return function(a,d){var c=Cf().getItem(t);if(!c)return v().assertConditionTag(!1,"no saved sessionStorage data for provided draft id",523510273),Promise.resolve(a(Kn));var u=JSON.parse(c);if(!lCe(u))return v().assertConditionTag(!1,"sessionStorage information is the wrong format",523510274),Promise.resolve(a(Kn));Cf().removeItem(t);var l=!!(r!=null&&r.some(function(g){return g.draftId===u.draftingParams.draftId})),p={inCurrentContext:l,isDraftEmpty:u.draftContent.content===""};return a(Ns(e,n,u.draftingParams,!1,o,p)).then(function(){var g=Dn(d());if(!g)return v().assertConditionTag(!1,"no active draft to save to session",520136543),a(Kn);var h={draftId:g.commentDraft.sessionConfiguration.draftId,draftContent:{editorContent:Promise.resolve(u.draftContent.content),editorCursorPosition:Promise.resolve(u.draftContent.cursorPosition)}};return a(Mm(e,h))})}}vE();xt();bC();xf();ho();Et();vo();mo();Cn();ue();s();Pc();xt();Rn();Et();vo();ue();function pCe(e){return Pn()?!0:!lr(e)&&!e.committedLieId}function mCe(e){return!!e.selectedComment&&gCe(e.draftState)}function Y3(e){return mLe(e)&&gCe(fe(e))}function mLe(e){var t=Kt()&&!Ci(e);return wd(e).nextPopulatedContextDetails!==jt.NoComments||UC(t?kn(e):yi(e),Ft(e),t)}function gCe(e){return Pn()||!lr(e)}var hCe=function(){function e(t,r,n,o,a){this.localizationAPI=t,this.peopleAPI=r,this.commentAPI=n,this.selectionManager=o,this.telemetryVisitor=a}return e.prototype.processCommentEvent=function(t,r,n,o){var a=this,d=o();switch(t){case De.CommentContextChanged:{if(Is(r))r.rehydrationDrafts&&r.rehydrationDrafts.forEach(function(l){n(fCe({renderContextType:A.None,trackback:C.reserveTag(595912089),telemetryVisitor:a.telemetryVisitor},l.draftId,r.contextDrafts,a.commentAPI,a.peopleAPI)).catch(pe(C.reserveTag(523362973)))}),n(LS({renderContextType:A.None,trackback:C.reserveTag(512361622),telemetryVisitor:this.telemetryVisitor},r));else{v().assertConditionTag(!1,"Invalid eventPayload",595912090);return}break}case De.CommentsChanged:{if(!kc(r)){v().assertConditionTag(!1,"Invalid eventPayload",595912091);return}break}case De.LoadComments:{if(!_c(r)){v().assertConditionTag(!1,"Invalid eventPayload",595912092);return}break}case De.CommentSelected:{if(iC(r))if(r.commentId){var c=void 0;if(Vi(d)[r.commentId]!==void 0)c=sg(r.commentId,ce.Canvas,{selectType:r.selectionReason&&r.selectionReason.type==="ContentNavigation"&&r.selectionReason.contentNavigationReason===la.Keyboarding?Ee.SelectCard:Ee.ExpandCard});else{var u=Mr(Ft(d),r.commentId);if(u===void 0)return;c=sg(u.parentId,ce.Canvas,{selectType:Ee.SelectPost,selectedPost:r.commentId})}n(CE(void 0,{renderContextType:A.None,trackback:C.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},c,!1)).catch(pe(C.reserveTag(579744150)))}else n(km({renderContextType:A.None,trackback:C.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));else{v().assertConditionTag(!1,"Invalid eventPayload",595912096);return}break}case De.CommentContextReload:{if(!Rc(r)){v().assertConditionTag(!1,"Invalid eventPayload",595912097);return}break}case De.CommentHighlighted:{if(aC(r))r.commentId?n(wc({renderContextType:A.None,trackback:C.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},r.commentId,ce.Canvas)):n(Lu({renderContextType:A.None,trackback:C.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},ce.Canvas,void 0));else{v().assertConditionTag(!1,"Invalid eventPayload",595912128);return}break}case De.NextPopulatedContextDetailsUpdated:{if(sC(r)&&r.contextDetails.nextPopulatedContextDetails)n(qS({renderContextType:A.None,trackback:C.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},r.contextDetails.nextPopulatedContextDetails));else{v().assertConditionTag(!1,"Invalid eventPayload",595912130);return}break}case De.ModelCapabilitiesChanged:{dC(r)?n(CI({renderContextType:A.None,trackback:C.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},r.modelCapabilityFlags,r.richTextCapabilityFlags)):v().assertConditionTag(!1,"Invalid eventPayload",595616784);break}case De.CommentError:{if(!cC(r)){v().assertConditionTag(!1,"Invalid eventPayload",595912131);return}break}case De.ReturnToDraftRequested:{uC(r)&&n(Ua({draftWarningType:Hr.ReturnToDraft,draftWarningReason:go.HostRequest},{renderContextType:A.None,trackback:C.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break}case De.UpdateDraftThread:{uf(r)?n(gI({renderContextType:A.None,trackback:C.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},r)):v().assertConditionTag(!1,"Invalid eventPayload",594023372);break}case De.SmartReplyPopulated:{if(lC(r))n(YS({renderContextType:A.None,trackback:C.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},r));else{v().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);return}break}default:{v().assertConditionTag(!1,"Deprecated event detected.",595912132);return}}},e.prototype.processCommentUIAction=function(t,r,n,o){var a=this,d=n();switch(t.actionType){case Yt.ShowHideCommentPane:return Fu(t.actionBehavior)?Ci(d)?dr.Success:dr.Fail:(Ha(t.actionBehavior)&&(Ci(d)?r(Hu({renderContextType:A.None,trackback:C.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):r(tI({renderContextType:A.None,trackback:C.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),dr.Success);case Yt.AddComment:{if(wu(t.actionBehavior)){if(!pCe(fe(d)))return dr.Fail}else if(Ha(t.actionBehavior)){var c={renderContextType:A.None,trackback:C.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return r(Ns(c,this.commentAPI,{sessionType:"CREATE"},!!(o&&o.retainSelectionOnAddComment),this.peopleAPI)).catch(pe(C.reserveTag(592314376))),dr.Success}return dr.Success}case Yt.NextThread:{if(v().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899713),Ha(t.actionBehavior))this.handleActionOrReturnToDraft(function(){return a.selectionManager.selectNextOrPreviousThread({direction:Qt.Next,source:ce.SharedComments,expandCard:!0,iterableContentTypes:[wt.CommentThread]},la.HostAction,A.None)},r,nt()?void 0:go.NextThread,C.reserveTag(591729749));else if(wu(t.actionBehavior))return Y3(d)?dr.Success:dr.Fail;return dr.Success}case Yt.PreviousThread:{if(v().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899714),Ha(t.actionBehavior))this.handleActionOrReturnToDraft(function(){return a.selectionManager.selectNextOrPreviousThread({direction:Qt.Previous,source:ce.SharedComments,expandCard:!0,iterableContentTypes:[wt.CommentThread]},la.HostAction,A.None)},r,nt()?void 0:go.PreviousThread,C.reserveTag(591729750));else if(wu(t.actionBehavior))return Y3(d)?dr.Success:dr.Fail;return dr.Success}case Yt.DeleteThread:{if(v().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899715),wu(t.actionBehavior)){if(!mCe(d.commentState))return dr.Fail}else Ha(t.actionBehavior)&&this.handleActionOrReturnToDraft(function(){var u=ve(d);u&&r(Nm({renderContextType:A.None,trackback:C.reserveTag(591738706),telemetryVisitor:a.telemetryVisitor},u.selectedCardId))},r,go.DeleteThread,C.reserveTag(591729751));return dr.Success}}return dr.NotHandled},e.prototype.beginDraftingHelper=function(t,r,n,o){return t(Ns({renderContextType:A.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,r,!1,this.peopleAPI)).catch(pe(o)).then(function(){return He.Handled})},e.prototype.handleCommentInterruptableCommand=function(t,r,n){switch(t.type){case"CreateComment":return this.beginDraftingHelper(r,{sessionType:"CREATE"},C.reserveTag(574371082),C.reserveTag(574371083));case"EditComment":{var o=n(),a=[],d=ve(o);a=$u(AG(t.commentId,Ft(o),Yn(o)),void 0);var c=Ka(a,t.commentId);return c?gv({comment:c,threads:a,selectedComment:d,warningType:Bt.Edit})?(r(Bu({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(593000206)},t.commentId,Bt.Edit)),Promise.resolve(He.Handled)):this.beginDraftingHelper(r,{sessionType:"EDIT",commentId:t.commentId},C.reserveTag(593000207),C.reserveTag(593000208)):(v().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(He.Handled))}case"ReplyComment":return this.beginDraftingHelper(r,{sessionType:"REPLY",threadId:t.threadId},C.reserveTag(593000209),C.reserveTag(593000210));case"DiscardDraft":{var u=n();if(t.mode===Uf.TryAutoDiscard)return r(Df({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(575411521)},ce.Canvas)).then(function(g){return g.draftDiscardResult});var d=ve(u);if(t.mode===Uf.Dialog&&kd(fe(u))===Lr.CannotAutoDiscard)return Oo(u)?Promise.resolve(He.Unhandled):Promise.resolve(He.Canceled);var l=Us(ca(u)===vt.Visible,Os($n(u).containerType),fe(u),d,tl(u));return r(og({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(575411522)},ce.Canvas,l,void 0))}default:return Promise.resolve(He.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(t,r,n,o){r(Df({renderContextType:A.None,trackback:o,telemetryVisitor:this.telemetryVisitor},ce.SharedComments,n)).then(function(a){(n===void 0||a.draftDiscardBehavior===Lr.NoDraft||a.draftDiscardResult===He.Handled)&&t()}).catch(pe(C.reserveTag(591738704)))},e}();s();te();Dc();ui();Es();Be();c0();Cr();s();te();ho();Et();mo();un();Rw();Aw();Nw();Fc();zw();Gw();function Gl(e,t,r,n){return function(o,a){var d=a();n&&o(n);var c=n?n.actionDetail.telemetryVisitor:t;if(r){if(r.topVisibleThreadId!==void 0&&o(fI({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953696)},r.topVisibleThreadId||void 0)),r.selectedCommentId!==void 0){var u=ve(d);if(r.selectedCommentId)if(u&&u.selectedCardId===r.selectedCommentId)if(Xe(u.selectionDetails)){var l=u.selectionDetails.selectedPostId,p=a();Mr(Ft(p),l)?o(yn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953698)},r.selectedCommentId,l,Ee.SelectPost,ce.Canvas)):o(yn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953699)},r.selectedCommentId,void 0,Ee.ExpandCard,ce.Canvas))}else o(yn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953697)},r.selectedCommentId,void 0,Ee.SelectCard,ce.Canvas));else o(yn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953728)},r.selectedCommentId,void 0,Ee.ExpandCard,ce.Canvas));else if(u){var g=fe(d),h=g.cardIdToDraftIdMap[u.selectedCardId];(!h||g.drafts[h].commentDraft.sessionConfiguration.sessionType!=="CREATE")&&o(km({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953729)}))}}r.highlightedCommentId!==void 0&&(r.highlightedCommentId?o(wc({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953730)},r.highlightedCommentId,ce.Canvas)):o(Lu({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(578586722)},ce.Canvas,void 0)));var x=kk(r);x&&o(mI({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953732)},x))}}}s();te();Z();Es();Cn();ue();Et();de();Cr();KC();function yCe(e,t,r,n){return function(o,a){var d=[];Ac(t)?(v().assertConditionTag(a?Br(a()).virtualized:!0,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),d=_k(t.commentIds,function(){return a().commentState})):d=t.comments;var c=Ac(t)?[]:t.tasks;o(Gl(e.renderContextType,n,t.contextDetails,Om(It(e,C.reserveTag(595953694)),{comments:d,tasks:c}))),ka()&&o(rl(It(e,C.reserveTag(595932895)),d,c,r)).catch(pe(C.reserveTag(595645974)))}}s();te();Es();ue();de();Mw();Hw();KC();function Py(e,t,r){return function(n){if(oC(t)){n(zS(It(e,C.reserveTag(595137280)),t.threads));return}ka()&&n(rl(It(e,C.reserveTag(595137282)),t.comments,t.tasks,r)),n(jS(It(e,C.reserveTag(595137283)),t.comments,t.tasks))}}vo();var CCe=function(){function e(t,r,n,o){this.commonViewStrategy=t,this.peopleAPI=r,this.focusManager=n,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(t,r,n,o){switch(t){case De.CommentsChanged:{kc(r)&&n(Gl(A.None,this.telemetryVisitor,r.contextDetails,Am({renderContextType:A.None,trackback:C.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},r.changes)));break}case De.LoadComments:{_c(r)&&n(Py({renderContextType:A.None,trackback:C.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI));break}case De.CommentContextReload:{Rc(r)&&n(yCe({renderContextType:A.None,trackback:C.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI,this.telemetryVisitor));break}}this.commonViewStrategy.processCommentEvent(t,r,n,o)},e.prototype.processCommentUIAction=function(t,r,n){if(t.actionType===Yt.AddComment&&t.actionBehavior!==ci.CheckEnabled){var o=n();Ci(o)&&this.focusManager.onUserAction(o.paneState.componentTree,{userAction:Fn.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(t,r,n)},e.prototype.handleCommentInterruptableCommand=function(t,r,n){return this.commonViewStrategy.handleCommentInterruptableCommand(t,r,n)},e}();s();te();ui();Es();ag();Hf();Be();s();k();te();Z();sf();di();Be();tr();vs();Et();Ui();mo();un();Fc();Cr();function vCe(e,t){return function(r,n){var o,a,d,c,u,l=n(),p=!1,g=e.contextDetails;if((g==null?void 0:g.selectedCommentId)===""&&(g=m(m({},g),{selectedCommentId:void 0})),r(Gl(A.None,t,g,Am({renderContextType:A.None,trackback:C.reserveTag(595953743),telemetryVisitor:t},e.changes))),!(e.contextDetails&&e.contextDetails.selectedCommentId)){var h=ve(l),x=h?h.selectedCardId:void 0,y=n(),T=ve(y);v().assertConditionTag(!or(l),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var b=kn(l),S=kn(y);if(!x)!b.length&&S.length&&(r(yn({renderContextType:A.None,trackback:C.reserveTag(595947723),telemetryVisitor:t},nr(S)?S[0]:S[0].commentId,void 0,Ee.ExpandCard,ce.SharedComments)),p=!0);else{var E=x&&e.changes.some(function(ie){return ie.type===tt.Delete&&ie.model.commentId===x});if(E){var P=void 0;if(nr(b)){var _=Yn(l),D=[],O=0;P=-1;for(var H=0;H<b.length;H++)D.push(O),O+=_[b[H]].length,b[H]===x&&(P=H);try{for(var V=qe(e.changes),M=V.next();!M.done;M=V.next()){var G=M.value;switch(G.type){case tt.Insert:var K=void 0;for(K=D.length-1;K>=0;K--){if(G.index<=D[K]){D[K]+=1;continue}break}yr(G.model)&&(K<P&&++P,D.splice(K+1,0,G.index));break;case tt.Delete:var z=void 0;for(z=D.length-1;z>=0;z--){if(G.index<D[z]){D[z]-=1;continue}G.index===D[z]&&(z<P&&--P,D.splice(z,1));break}break;case tt.Modify:case tt.Unknown:case tt.Load:break;default:Ne(G)}}}catch(ie){o={error:ie}}finally{try{M&&!M.done&&(a=V.return)&&a.call(V)}finally{if(o)throw o.error}}}else{P=b.findIndex(function(ie){return ie.commentId===x});try{for(var $=qe(e.changes),q=$.next();!q.done;q=$.next()){var G=q.value;switch(G.type){case tt.Insert:G.index<=P&&++P;break;case tt.Delete:G.index<P&&--P;break;case tt.Modify:case tt.Unknown:case tt.Load:break;default:Ne(G)}}}catch(ie){d={error:ie}}finally{try{q&&!q.done&&(c=$.return)&&c.call($)}finally{if(d)throw d.error}}}if(T)throw new he(f5,C.reserveTag(589103626),-2130957551);if(S.length){var re=P;re===S.length&&(re-=1);var ae=nr(S)?S[re]:$e(S[re]);r(yn({renderContextType:A.None,trackback:C.reserveTag(595953744),telemetryVisitor:t},ae,void 0,Ee.ExpandCard,ce.SharedComments)),p=!0}}}v().assertConditionTag(p||S.length===0||((u=e.contextDetails)===null||u===void 0?void 0:u.selectedCommentId)!=="","Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}}s();te();Z();Fd();NC();Et();Ui();mo();un();Fc();Cr();function xCe(e,t,r,n){return function(o,a){o(Py({renderContextType:e,trackback:C.reserveTag(595899530),telemetryVisitor:n},t,r));var d=a();v().assertConditionTag(or(d)===void 0,"Half pane specific logic should not run with filtering enabled.",523866629);var c=Br(d).virtualized,u=ve(d),l=yi(d);Gu(ji(d),c,!!or(a()))&&l.length&&(!u||!wf(d,u.selectedCardId))&&o(yn({renderContextType:e,trackback:C.reserveTag(595953680),telemetryVisitor:n},nr(l)?l[0]:l[0].commentId,void 0,Ee.ExpandCard,ce.SharedComments))}}s();k();te();Z();Es();di();Cn();ue();Et();Ui();mo();un();Bw();Fc();Cr();KC();function TCe(e,t,r,n){return function(o,a){var d,c,u=a(),l=!1,p=[];Ac(t)?(v().assertConditionTag(Br(u).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),p=_k(t.commentIds)):p=t.comments;var g=t.contextDetails;(g==null?void 0:g.selectedCommentId)===""&&(g=m(m({},g),{selectedCommentId:void 0}));var h=Ac(t)?[]:t.tasks;o(Gl(e,n,g,Om({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595953677)},{comments:p,tasks:h}))),ka()&&o(rl({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595162892)},p,h,r)).catch(pe(C.reserveTag(595645962))),v().assertConditionTag(!or(u),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var x=(d=ve(u))===null||d===void 0?void 0:d.selectedCardId,y=kn(u),T=a(),b=kn(T);if(!x)!y.length&&b.length&&(o(yn({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595947722)},nr(b)?b[0]:b[0].commentId,void 0,Ee.ExpandCard,ce.SharedComments)),l=!0);else{var S=!ve(T);if(S){var E=nr(y)?y.findIndex(function(D){return D===x}):y.findIndex(function(D){return D.commentId===x});if(E<0)return;if(b.length){var P=E;P===b.length&&(P-=1);var _=nr(b)?b[P]:$e(b[P]);o(yn({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595953678)},_,void 0,Ee.ExpandCard,ce.SharedComments)),l=!0}}}v().assertConditionTag(l||b.length===0||((c=t.contextDetails)===null||c===void 0?void 0:c.selectedCommentId)!=="","Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}vo();var bCe=function(){function e(t,r,n,o){this.commonViewStrategy=t,this.peopleAPI=r,this.lastInitializationReason=n,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(t,r,n,o){switch(t){case De.CommentsChanged:{kc(r)&&n(vCe(r,this.telemetryVisitor));break}case De.LoadComments:{_c(r)&&((o().paneState.initializationStatus===Xn.Initialized||this.lastInitializationReason!==Ms.NewThread)&&Ci(o())?n(xCe(A.HalfPane,r,this.peopleAPI,this.telemetryVisitor)):n(Py({renderContextType:A.None,trackback:C.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI)));break}case De.CommentContextReload:{Rc(r)&&n(TCe(A.HalfPane,r,this.peopleAPI,this.telemetryVisitor));break}}this.commonViewStrategy.processCommentEvent(t,r,n,o)},e.prototype.processCommentUIAction=function(t,r,n){return this.commonViewStrategy.processCommentUIAction(t,r,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(t,r,n){return this.commonViewStrategy.handleCommentInterruptableCommand(t,r,n)},e}();var SCe=function(){function e(){}return e.prototype.createViewStrategy=function(t,r,n,o,a,d,c,u){var l=new hCe(r,n,o,a,u);switch(t.containerType){case Sc.HalfPane:return new bCe(l,n,c,u);case Sc.FullPane:return new CCe(l,n,d,u)}},e}();function ICe(e){var t=e.apiContext,r=e.peopleAPI||phe(t),n=al(t)?cg(t):void 0,o=Um(t)?FI(t):void 0,a=e.viewContainerProvider||xhe(t,e.displayMode,e.foldableLayoutState),d=e.localizationAPI||Sb(),c=e.themeAPI||_b(),u;e.hostCommentAPI?u=new gk(e.hostCommentAPI):u=dhe(t);var l=Sn.getTelemetryVisitor(e.apiContext),p=new _he(d.getLocaleInfo().isRightToLeft,l),g=new uCe(r,l,e.correlationId||"");md()&&g.initializeController(!1);var h=Oye(u,a,dye(a.getViewContainer(),e.paneVisible,d.getLocaleInfo(),t),l,n,d,p,g,o);return new aCe({apiContext:t,viewProvider:a,commentAPI:u,peopleAPI:r,localizationAPI:d,themeAPI:c,focusManager:p,lppManager:g,initializationReason:e.initializationReason,commentStore:h,viewStrategyFactory:new SCe,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentFilteredRangeAPI:o,contentNavigationAPI:n})}Ie.enableStackLogging=!0;Ie.enableMessageLogging=!0;Y()==="win32"?$3.LogBox.ignoreAllLogs():Y()==="android"&&$3.LogBox.ignoreLogs(["Warning: Can only update a mounted or mounting component. This usually means you called setState, replaceState, or forceUpdate on an unmounted component. This is a no-op."]);Oge(ICe);(0,PCe.initReka)();$k();Uy(Mge);Oi()&&Sn.ensureInitialized();Gy.register();b5();mn&&mD({logFocusDebugInfo:Pt});ECe.AppRegistry.registerComponent("CommentHostNative",function(){return Nge});_b();B5();})();
//# sourceMappingURL=Comments.win32.bundle.map
